---
title: Opérations du presse-papiers
description: Une fenêtre doit utiliser le presse-papiers pour couper, copier ou coller des données. Une fenêtre place les données dans le presse-papiers pour les opérations couper et copier et récupère les données du presse-papiers pour les opérations de collage.
ms.assetid: 27f9142c-3154-4de5-aea6-3c53f7e940ec
keywords:
- Interface utilisateur Windows, presse-papiers
- presse-papiers, fenêtres
- presse-papiers, découper des données
- presse-papiers, copier des données
- presse-papiers, coller des données
- presse-papiers, fenêtre propriétaire
- presse-papiers, rendu différé
- presse-papiers, mémoire
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5cb2c3451cf562b35b976e137a974e19892acbb3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104316212"
---
# <a name="clipboard-operations"></a><span data-ttu-id="dd6a4-112">Opérations du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="dd6a4-112">Clipboard Operations</span></span>

<span data-ttu-id="dd6a4-113">Une fenêtre doit utiliser le presse-papiers pour couper, copier ou coller des données.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-113">A window should use the clipboard when cutting, copying, or pasting data.</span></span> <span data-ttu-id="dd6a4-114">Une fenêtre place les données dans le presse-papiers pour les opérations couper et copier et récupère les données du presse-papiers pour les opérations de collage.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-114">A window places data on the clipboard for cut and copy operations and retrieves data from the clipboard for paste operations.</span></span> <span data-ttu-id="dd6a4-115">Les sections suivantes décrivent ces opérations et les problèmes connexes.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-115">The following sections describe these operations and related issues.</span></span>

<span data-ttu-id="dd6a4-116">Pour placer des données dans le presse-papiers ou en extraire des données, une fenêtre doit d’abord ouvrir le presse-papiers à l’aide de la fonction [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-116">To place data on or retrieve data from the clipboard, a window must first open the clipboard by using the [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) function.</span></span> <span data-ttu-id="dd6a4-117">Le presse-papiers peut être ouvert à la fois dans une seule fenêtre.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-117">Only one window can have the clipboard open at a time.</span></span> <span data-ttu-id="dd6a4-118">Pour déterminer dans quelle fenêtre le presse-papiers est ouvert, appelez la fonction [**GetOpenClipboardWindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-118">To find out which window has the clipboard open, call the [**GetOpenClipboardWindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) function.</span></span> <span data-ttu-id="dd6a4-119">Une fois l’opération terminée, la fenêtre doit fermer le presse-papiers en appelant la fonction [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-119">When it has finished, the window must close the clipboard by calling the [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) function.</span></span>

<span data-ttu-id="dd6a4-120">Les rubriques suivantes sont présentées dans cette section.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-120">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="dd6a4-121">Opérations couper et copier</span><span class="sxs-lookup"><span data-stu-id="dd6a4-121">Cut and Copy Operations</span></span>](#cut-and-copy-operations)
-   [<span data-ttu-id="dd6a4-122">Opérations de collage</span><span class="sxs-lookup"><span data-stu-id="dd6a4-122">Paste Operations</span></span>](#paste-operations)
-   [<span data-ttu-id="dd6a4-123">Propriété du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="dd6a4-123">Clipboard Ownership</span></span>](#clipboard-ownership)
-   [<span data-ttu-id="dd6a4-124">Rendu différé</span><span class="sxs-lookup"><span data-stu-id="dd6a4-124">Delayed Rendering</span></span>](#delayed-rendering)
-   [<span data-ttu-id="dd6a4-125">Mémoire et presse-papiers</span><span class="sxs-lookup"><span data-stu-id="dd6a4-125">Memory and the Clipboard</span></span>](#memory-and-the-clipboard)

## <a name="cut-and-copy-operations"></a><span data-ttu-id="dd6a4-126">Opérations couper et copier</span><span class="sxs-lookup"><span data-stu-id="dd6a4-126">Cut and Copy Operations</span></span>

<span data-ttu-id="dd6a4-127">Pour placer des informations dans le presse-papiers, une fenêtre efface d’abord tout contenu du presse-papiers précédent à l’aide de la fonction [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-127">To place information on the clipboard, a window first clears any previous clipboard content by using the [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="dd6a4-128">Cette fonction envoie le message [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) au propriétaire du presse-papiers précédent, libère les ressources associées aux données dans le presse-papiers et assigne la propriété du presse-papiers à la fenêtre dans laquelle le presse-papiers est ouvert.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-128">This function sends the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message to the previous clipboard owner, frees resources associated with data on the clipboard, and assigns clipboard ownership to the window that has the clipboard open.</span></span> <span data-ttu-id="dd6a4-129">Pour savoir quelle fenêtre possède le presse-papiers, appelez la fonction [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-129">To find out which window owns the clipboard, call the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function.</span></span>

<span data-ttu-id="dd6a4-130">Une fois le presse-papiers vidé, la fenêtre place les données dans le presse-papiers dans autant de formats de presse-papiers que possible, classés du format du presse-papiers le plus descriptif au moins descriptif.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-130">After emptying the clipboard, the window places data on the clipboard in as many clipboard formats as possible, ordered from the most descriptive clipboard format to the least descriptive.</span></span> <span data-ttu-id="dd6a4-131">Pour chaque format, la fenêtre appelle la fonction [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) , en spécifiant l’identificateur de format et un handle de mémoire globale.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-131">For each format, the window calls the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function, specifying the format identifier and a global memory handle.</span></span> <span data-ttu-id="dd6a4-132">Le descripteur de mémoire peut être NULL, ce qui indique que la fenêtre restitue les données à la demande.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-132">The memory handle can be NULL, indicating that the window renders the data on request.</span></span> <span data-ttu-id="dd6a4-133">Pour plus d’informations, consultez [rendu retardé](#delayed-rendering).</span><span class="sxs-lookup"><span data-stu-id="dd6a4-133">For more information, see [Delayed Rendering](#delayed-rendering).</span></span>

## <a name="paste-operations"></a><span data-ttu-id="dd6a4-134">Opérations de collage</span><span class="sxs-lookup"><span data-stu-id="dd6a4-134">Paste Operations</span></span>

<span data-ttu-id="dd6a4-135">Pour récupérer les informations de collage à partir du presse-papiers, une fenêtre détermine d’abord le format du presse-papiers à récupérer.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-135">To retrieve paste information from the clipboard, a window first determines the clipboard format to retrieve.</span></span> <span data-ttu-id="dd6a4-136">En règle générale, une fenêtre énumère les formats de presse-papiers disponibles à l’aide de la fonction [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) et utilise le premier format reconnu.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-136">Typically, a window enumerates the available clipboard formats by using the [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) function and uses the first format it recognizes.</span></span> <span data-ttu-id="dd6a4-137">Cette méthode sélectionne le meilleur format disponible en fonction de la priorité définie lorsque les données ont été placées dans le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-137">This method selects the best available format according to the priority set when the data was placed on the clipboard.</span></span>

<span data-ttu-id="dd6a4-138">Une fenêtre peut également utiliser la fonction [**GetPriorityClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-138">Alternatively, a window can use the [**GetPriorityClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) function.</span></span> <span data-ttu-id="dd6a4-139">Cette fonction identifie le meilleur format de presse-papiers disponible en fonction d’une priorité spécifiée.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-139">This function identifies the best available clipboard format according to a specified priority.</span></span> <span data-ttu-id="dd6a4-140">Une fenêtre qui ne reconnaît qu’un seul format de presse-papiers peut simplement déterminer si ce format est disponible à l’aide de la fonction [**IsClipboardFormatAvailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-140">A window that recognizes only one clipboard format can simply determine whether that format is available by using the [**IsClipboardFormatAvailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) function.</span></span>

<span data-ttu-id="dd6a4-141">Une fois que vous avez déterminé le format du presse-papiers à utiliser, une fenêtre appelle la fonction [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-141">After determining the clipboard format to use, a window calls the [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) function.</span></span> <span data-ttu-id="dd6a4-142">Cette fonction retourne le descripteur d’un objet mémoire global contenant les données dans le format spécifié.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-142">This function returns the handle to a global memory object containing data in the specified format.</span></span> <span data-ttu-id="dd6a4-143">Une fenêtre peut rapidement verrouiller l’objet mémoire afin d’examiner ou de copier les données.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-143">A window can briefly lock the memory object in order to examine or copy the data.</span></span> <span data-ttu-id="dd6a4-144">Toutefois, une fenêtre ne doit pas libérer l’objet ou la garder verrouillée pendant une longue période de temps.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-144">However, a window should not free the object or leave it locked for a long period of time.</span></span>

## <a name="clipboard-ownership"></a><span data-ttu-id="dd6a4-145">Propriété du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="dd6a4-145">Clipboard Ownership</span></span>

<span data-ttu-id="dd6a4-146">Le *propriétaire du presse-papiers* est la fenêtre associée aux informations contenues dans le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-146">The *clipboard owner* is the window associated with the information on the clipboard.</span></span> <span data-ttu-id="dd6a4-147">Une fenêtre devient le propriétaire du presse-papiers lorsqu’elle place des données dans le presse-papiers, en particulier quand elle appelle la fonction [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-147">A window becomes the clipboard owner when it places data on the clipboard, specifically, when it calls the [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="dd6a4-148">La fenêtre reste le propriétaire du presse-papiers jusqu’à ce qu’elle soit fermée ou qu’une autre fenêtre vide le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-148">The window remains the clipboard owner until it is closed or another window empties the clipboard.</span></span>

<span data-ttu-id="dd6a4-149">Lorsque le presse-papiers est vidé, le propriétaire du presse-papiers reçoit un message [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-149">When the clipboard is emptied, the clipboard owner receives a [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="dd6a4-150">Voici les raisons pour lesquelles une fenêtre peut traiter ce message :</span><span class="sxs-lookup"><span data-stu-id="dd6a4-150">Following are some reasons why a window might process this message:</span></span>

-   <span data-ttu-id="dd6a4-151">La fenêtre a retardé le rendu d’un ou de plusieurs formats de presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-151">The window delayed rendering of one or more clipboard formats.</span></span> <span data-ttu-id="dd6a4-152">En réponse au message [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) , la fenêtre peut libérer des ressources allouées pour afficher les données à la demande.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-152">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had allocated in order to render data on request.</span></span> <span data-ttu-id="dd6a4-153">Pour plus d’informations sur le rendu des données, consultez [rendu retardé](#delayed-rendering).</span><span class="sxs-lookup"><span data-stu-id="dd6a4-153">For more information about the rendering of data, see [Delayed Rendering](#delayed-rendering).</span></span>
-   <span data-ttu-id="dd6a4-154">La fenêtre a placé des données dans le presse-papiers dans un format de presse-papiers privé.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-154">The window placed data on the clipboard in a private clipboard format.</span></span> <span data-ttu-id="dd6a4-155">Les données des formats de presse-papiers privés ne sont pas libérées par le système lorsque le presse-papiers est vidé.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-155">The data for private clipboard formats is not freed by the system when the clipboard is emptied.</span></span> <span data-ttu-id="dd6a4-156">Par conséquent, le propriétaire du presse-papiers doit libérer les données lors de la réception du message [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-156">Therefore, the clipboard owner should free the data upon receiving the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="dd6a4-157">Pour plus d’informations sur les formats de presse-papiers privés, consultez [formats de presse-papiers](clipboard-formats.md).</span><span class="sxs-lookup"><span data-stu-id="dd6a4-157">For more information about private clipboard formats, see [Clipboard Formats](clipboard-formats.md).</span></span>
-   <span data-ttu-id="dd6a4-158">La fenêtre a placé des données dans le presse-papiers à l’aide du format de presse-papiers **CF \_ OWNERDISPLAY** .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-158">The window placed data on the clipboard using the **CF\_OWNERDISPLAY** clipboard format.</span></span> <span data-ttu-id="dd6a4-159">En réponse au message [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) , la fenêtre peut libérer des ressources utilisées pour afficher des informations dans la fenêtre de la visionneuse du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-159">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had used to display information in the clipboard viewer window.</span></span> <span data-ttu-id="dd6a4-160">Pour plus d’informations sur cet autre format, consultez [format d’affichage du propriétaire](about-the-clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="dd6a4-160">For more information about this alternative format, see [Owner Display Format](about-the-clipboard.md).</span></span>

## <a name="delayed-rendering"></a><span data-ttu-id="dd6a4-161">Rendu différé</span><span class="sxs-lookup"><span data-stu-id="dd6a4-161">Delayed Rendering</span></span>

<span data-ttu-id="dd6a4-162">Quand vous placez un format de presse-papiers dans le presse-papiers, une fenêtre peut retarder le rendu des données dans ce format jusqu’à ce que les données soient nécessaires.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-162">When placing a clipboard format on the clipboard, a window can delay rendering the data in that format until the data is needed.</span></span> <span data-ttu-id="dd6a4-163">Pour ce faire, une application peut spécifier la **valeur null** pour le paramètre *hdata* de la fonction [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-163">To do so, an application can specify **NULL** for the *hData* parameter of the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function.</span></span> <span data-ttu-id="dd6a4-164">Cela est utile si l’application prend en charge plusieurs formats de presse-papiers, tout ou partie de ce qui prend du temps à être rendu.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-164">This is useful if the application supports several clipboard formats, some or all of which are time-consuming to render.</span></span> <span data-ttu-id="dd6a4-165">En passant un handle **null** , une fenêtre restitue des formats de presse-papiers complexes uniquement quand et si elles sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-165">By passing a **NULL** handle, a window renders complex clipboard formats only when and if they are needed.</span></span>

<span data-ttu-id="dd6a4-166">Si une fenêtre retarde le rendu d’un format de presse-papiers, elle doit être préparée pour afficher le format à la demande tant qu’il s’agit du propriétaire du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-166">If a window delays rendering a clipboard format, it must be prepared to render the format upon request for as long as it is the clipboard owner.</span></span> <span data-ttu-id="dd6a4-167">Le système envoie au propriétaire du presse-papiers un message [**WM \_ RENDERFORMAT**](wm-renderformat.md) lorsqu’une demande est reçue pour un format spécifique qui n’a pas été rendu.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-167">The system sends the clipboard owner a [**WM\_RENDERFORMAT**](wm-renderformat.md) message when a request is received for a specific format that has not been rendered.</span></span> <span data-ttu-id="dd6a4-168">À la réception de ce message, la fenêtre doit appeler la fonction [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) pour placer un handle de mémoire globale sur le presse-papiers dans le format demandé.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-168">Upon receiving this message, the window should call the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function to place a global memory handle on the clipboard in the requested format.</span></span>

<span data-ttu-id="dd6a4-169">Une application ne doit pas ouvrir le presse-papiers avant d’appeler [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) en réponse au message [**WM \_ RENDERFORMAT**](wm-renderformat.md) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-169">An application must not open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) in response to the [**WM\_RENDERFORMAT**](wm-renderformat.md) message.</span></span> <span data-ttu-id="dd6a4-170">L’ouverture du presse-papiers n’est pas nécessaire, et toute tentative de cette opération échoue car le presse-papiers est actuellement maintenu ouvert par l’application qui a demandé le rendu du format.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-170">Opening the clipboard is not necessary, and any attempt to do so will fail because the clipboard is currently being held open by the application that requested the format to be rendered.</span></span>

<span data-ttu-id="dd6a4-171">Si le propriétaire du presse-papiers va être détruit et qu’il a retardé le rendu de certains ou de tous les formats du presse-papiers, il reçoit le message [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-171">If the clipboard owner is about to be destroyed and has delayed rendering some or all clipboard formats, it receives the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message.</span></span> <span data-ttu-id="dd6a4-172">À la réception de ce message, la fenêtre doit ouvrir le presse-papiers, vérifier qu’il est toujours le propriétaire du presse-papiers avec la fonction [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) , puis placer les descripteurs de mémoire valides dans le presse-papiers pour tous les formats de presse-papiers qu’il fournit.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-172">Upon receiving this message, the window should open the clipboard, check that it is still the clipboard owner with the the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function, and then place valid memory handles on the clipboard for all clipboard formats that it provides.</span></span> <span data-ttu-id="dd6a4-173">Cela permet de s’assurer que ces formats restent disponibles une fois le propriétaire du presse-papiers détruit.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-173">This ensures that these formats remain available after the clipboard owner is destroyed.</span></span>

<span data-ttu-id="dd6a4-174">Contrairement à [**WM \_ RENDERFORMAT**](wm-renderformat.md), une application qui répond à [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) doit ouvrir le presse-papiers avant d’appeler [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) pour placer les descripteurs de mémoire globale sur le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-174">Unlike with [**WM\_RENDERFORMAT**](wm-renderformat.md), an application responding to [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) should open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) to place any global memory handles on the clipboard.</span></span>

<span data-ttu-id="dd6a4-175">Les formats de presse-papiers qui ne sont pas rendus en réponse au message [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) cessent d’être disponibles pour d’autres applications et ne sont plus énumérés par les fonctions du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-175">Any clipboard formats that are not rendered in response to the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message cease to be available to other applications and are no longer enumerated by the clipboard functions.</span></span>

## <a name="memory-and-the-clipboard"></a><span data-ttu-id="dd6a4-176">Mémoire et presse-papiers</span><span class="sxs-lookup"><span data-stu-id="dd6a4-176">Memory and the Clipboard</span></span>

<span data-ttu-id="dd6a4-177">Un objet mémoire qui doit être placé dans le presse-papiers doit être alloué à l’aide de la fonction [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) avec l’indicateur **GMEM \_ MoveOn** .</span><span class="sxs-lookup"><span data-stu-id="dd6a4-177">A memory object that is to be placed on the clipboard should be allocated by using the [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) function with the **GMEM\_MOVEABLE** flag.</span></span>

<span data-ttu-id="dd6a4-178">Une fois qu’un objet mémoire est placé dans le presse-papiers, la propriété de ce descripteur de mémoire est transférée au système.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-178">After a memory object is placed on the clipboard, ownership of that memory handle is transferred to the system.</span></span> <span data-ttu-id="dd6a4-179">Lorsque le presse-papiers est vidé et que l’objet mémoire a l’un des formats de presse-papiers suivants, le système libère l’objet mémoire en appelant la fonction spécifiée :</span><span class="sxs-lookup"><span data-stu-id="dd6a4-179">When the clipboard is emptied and the memory object has one of the following clipboard formats, the system frees the memory object by calling the specified function:</span></span>



| <span data-ttu-id="dd6a4-180">Fonction pour libérer l’objet</span><span class="sxs-lookup"><span data-stu-id="dd6a4-180">Function to free object</span></span>                             | <span data-ttu-id="dd6a4-181">Format du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="dd6a4-181">Clipboard format</span></span>                                                                                                                                               |
|-----------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="dd6a4-182">**DeleteMetaFile**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-182">**DeleteMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deletemetafile)<br/> | <span data-ttu-id="dd6a4-183">**CF \_ DSPENHMETAFILE**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-183">**CF\_DSPENHMETAFILE**</span></span><br/> <span data-ttu-id="dd6a4-184">**CF \_ DSPMETAFILEPICT**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-184">**CF\_DSPMETAFILEPICT**</span></span><br/> <span data-ttu-id="dd6a4-185">**CF \_ ENHMETAFILE**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-185">**CF\_ENHMETAFILE**</span></span><br/> <span data-ttu-id="dd6a4-186">**CF \_ MetaFilePict**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-186">**CF\_METAFILEPICT**</span></span><br/>                            |
| [<span data-ttu-id="dd6a4-187">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-187">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)<br/>     | <span data-ttu-id="dd6a4-188">**\_bitmap cf**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-188">**CF\_BITMAP**</span></span><br/> <span data-ttu-id="dd6a4-189">**CF \_ DSPBITMAP**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-189">**CF\_DSPBITMAP**</span></span><br/> <span data-ttu-id="dd6a4-190">**\_palette cf**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-190">**CF\_PALETTE**</span></span><br/>                                                                              |
| [<span data-ttu-id="dd6a4-191">**GlobalFree**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-191">**GlobalFree**</span></span>](/windows/desktop/api/winbase/nf-winbase-globalfree)<br/>        | <span data-ttu-id="dd6a4-192">**CF \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-192">**CF\_DIB**</span></span><br/> <span data-ttu-id="dd6a4-193">**CF \_ DIBV5**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-193">**CF\_DIBV5**</span></span><br/> <span data-ttu-id="dd6a4-194">**CF \_ DSPTEXT**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-194">**CF\_DSPTEXT**</span></span><br/> <span data-ttu-id="dd6a4-195">**CF \_ OEMTEXT**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-195">**CF\_OEMTEXT**</span></span><br/> <span data-ttu-id="dd6a4-196">**\_texte cf**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-196">**CF\_TEXT**</span></span><br/> <span data-ttu-id="dd6a4-197">**CF \_ UNICODETEXT**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-197">**CF\_UNICODETEXT**</span></span><br/>   |
| <span data-ttu-id="dd6a4-198">aucun</span><span class="sxs-lookup"><span data-stu-id="dd6a4-198">none</span></span><br/>                                     | <span data-ttu-id="dd6a4-199">**CF \_ OWNERDISPLAY**</span><span class="sxs-lookup"><span data-stu-id="dd6a4-199">**CF\_OWNERDISPLAY**</span></span><br/> <span data-ttu-id="dd6a4-200">Lorsque le presse-papiers est vidé d’un objet **CF \_ OWNERDISPLAY** , l’application elle-même doit libérer l’objet mémoire.</span><span class="sxs-lookup"><span data-stu-id="dd6a4-200">When the clipboard is emptied of a **CF\_OWNERDISPLAY** object, the application itself must free the memory object.</span></span><br/> |



 

 

