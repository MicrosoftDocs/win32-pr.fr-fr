---
title: Gestion des transactions (échange de données)
description: Cette rubrique explique comment un client peut envoyer des transactions pour obtenir des données et des services à partir du serveur.
ms.assetid: 2d08ffa3-cbd7-4806-b94f-979938322c38
keywords:
- Interface utilisateur Windows, échange dynamique de données (DDE)
- Échange dynamique de données (DDE), transactions
- DDE (échange dynamique de données), transactions
- échange de données, échange dynamique de données (DDE)
- Interface utilisateur Windows, bibliothèque de gestion des échange dynamique de données (DDEML)
- Bibliothèque de gestion des échange dynamique de données (DDEML), transactions
- DDEML (bibliothèque de gestion échange dynamique de données), transactions
- échange de données, bibliothèque de gestion des échange dynamique de données (DDEML)
- Échange dynamique de données (DDE), demandes de transactions
- DDE (échange dynamique de données), demandes de transactions
- Bibliothèque de gestion des échange dynamique de données (DDEML), demandes de transactions
- DDEML (bibliothèque de gestion échange dynamique de données), demandes de transactions
- Échange dynamique de données (DDE), écritures en avant
- DDE (échange dynamique de données), écritures en avant
- Bibliothèque de gestion des échange dynamique de données (DDEML), transactions d’en-in
- DDEML (bibliothèque de gestion échange dynamique de données), écritures de l’en-in
- Échange dynamique de données (DDE), notification des transactions
- DDE (échange dynamique de données), notification des transactions
- Bibliothèque de gestion des échange dynamique de données (DDEML), notification des transactions
- DDEML (bibliothèque de gestion échange dynamique de données), notification des transactions
- Échange dynamique de données (DDE), exécuter des transactions
- DDE (échange dynamique de données), exécuter des transactions
- Bibliothèque de gestion des échange dynamique de données (DDEML), exécution des transactions
- DDEML (bibliothèque de gestion échange dynamique de données), exécuter des transactions
- Échange dynamique de données (DDE), transactions synchrones
- DDE (échange dynamique de données), transactions synchrones
- Bibliothèque de gestion des échange dynamique de données (DDEML), transactions synchrones
- DDEML (bibliothèque de gestion échange dynamique de données), transactions synchrones
- Échange dynamique de données (DDE), transactions asynchrones
- ÉCHANGES de transactions asynchrones (échange dynamique de données)
- Bibliothèque de gestion des échange dynamique de données (DDEML), transactions asynchrones
- DDEML (bibliothèque de gestion échange dynamique de données), transactions asynchrones
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 570aa48b4dcdbb31855b3e1b15a091908feb2ba4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031381"
---
# <a name="transaction-management-data-exchange"></a><span data-ttu-id="fd775-135">Gestion des transactions (échange de données)</span><span class="sxs-lookup"><span data-stu-id="fd775-135">Transaction Management (Data Exchange)</span></span>

<span data-ttu-id="fd775-136">Après avoir établi une conversation avec un serveur, un client peut envoyer des transactions pour obtenir des données et des services à partir du serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-136">After establishing a conversation with a server, a client can send transactions to obtain data and services from the server.</span></span>

<span data-ttu-id="fd775-137">Les rubriques suivantes décrivent les types de transactions que les clients peuvent utiliser pour interagir avec un serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-137">The following topics describe the types of transactions that clients can use to interact with a server.</span></span>

-   [<span data-ttu-id="fd775-138">Transaction de demande</span><span class="sxs-lookup"><span data-stu-id="fd775-138">Request Transaction</span></span>](#request-transaction)
-   [<span data-ttu-id="fd775-139">Transaction de journalisation</span><span class="sxs-lookup"><span data-stu-id="fd775-139">Poke Transaction</span></span>](#poke-transaction)
-   [<span data-ttu-id="fd775-140">Transaction de notification</span><span class="sxs-lookup"><span data-stu-id="fd775-140">Advise Transaction</span></span>](#advise-transaction)
-   [<span data-ttu-id="fd775-141">Exécuter la transaction</span><span class="sxs-lookup"><span data-stu-id="fd775-141">Execute Transaction</span></span>](#execute-transaction)
-   [<span data-ttu-id="fd775-142">Transactions synchrones et asynchrones</span><span class="sxs-lookup"><span data-stu-id="fd775-142">Synchronous and Asynchronous Transactions</span></span>](#synchronous-and-asynchronous-transactions)
-   [<span data-ttu-id="fd775-143">Contrôle de transaction</span><span class="sxs-lookup"><span data-stu-id="fd775-143">Transaction Control</span></span>](#transaction-control)
-   [<span data-ttu-id="fd775-144">Classes de transaction</span><span class="sxs-lookup"><span data-stu-id="fd775-144">Transaction Classes</span></span>](#transaction-classes)
-   [<span data-ttu-id="fd775-145">Types de transactions</span><span class="sxs-lookup"><span data-stu-id="fd775-145">Transaction Types</span></span>](#transaction-types)

## <a name="request-transaction"></a><span data-ttu-id="fd775-146">Transaction de demande</span><span class="sxs-lookup"><span data-stu-id="fd775-146">Request Transaction</span></span>

<span data-ttu-id="fd775-147">Une application cliente peut utiliser la transaction de [**\_ demande XTYP**](xtyp-request.md) pour demander un élément de données à partir d’une application serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-147">A client application can use the [**XTYP\_REQUEST**](xtyp-request.md) transaction to request a data item from a server application.</span></span> <span data-ttu-id="fd775-148">Le client appelle la fonction [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) , en spécifiant la **\_ demande XTYP** comme type de transaction et en spécifiant l’élément de données dont l’application a besoin.</span><span class="sxs-lookup"><span data-stu-id="fd775-148">The client calls the [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) function, specifying **XTYP\_REQUEST** as the transaction type and specifying the data item the application needs.</span></span>

<span data-ttu-id="fd775-149">La bibliothèque de gestion des échange dynamique de données (DDEML) transmet la transaction de [**\_ demande XTYP**](xtyp-request.md) au serveur, en spécifiant le nom de la rubrique, le nom de l’élément et le format de données demandés par le client.</span><span class="sxs-lookup"><span data-stu-id="fd775-149">The Dynamic Data Exchange Management Library (DDEML) passes the [**XTYP\_REQUEST**](xtyp-request.md) transaction to the server, specifying the topic name, item name, and data format requested by the client.</span></span> <span data-ttu-id="fd775-150">Si le serveur prend en charge la rubrique, l’élément et le format demandés, le serveur doit retourner un handle de données qui identifie la valeur actuelle de l’élément.</span><span class="sxs-lookup"><span data-stu-id="fd775-150">If the server supports the requested topic, item, and format, the server should return a data handle that identifies the current value of the item.</span></span> <span data-ttu-id="fd775-151">Le DDEML transmet ce handle au client en tant que valeur de retour de [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-151">The DDEML passes this handle to the client as the return value from [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="fd775-152">Le serveur doit retourner la **valeur null** s’il ne prend pas en charge la rubrique, l’élément ou le format demandé.</span><span class="sxs-lookup"><span data-stu-id="fd775-152">The server should return **NULL** if it does not support the topic, item, or format requested.</span></span>

<span data-ttu-id="fd775-153">[**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) utilise le paramètre *lpdwResult* pour retourner un indicateur d’état de transaction au client.</span><span class="sxs-lookup"><span data-stu-id="fd775-153">[**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) uses the *lpdwResult* parameter to return a transaction-status flag to the client.</span></span> <span data-ttu-id="fd775-154">Si le serveur ne traite pas la transaction de [**\_ demande XTYP**](xtyp-request.md) , **DdeClientTransaction** retourne la **valeur null** et *LPDWRESULT* pointe vers l' \_ indicateur DDE FNOTPROCESSED ou DDE \_ FBUSY.</span><span class="sxs-lookup"><span data-stu-id="fd775-154">If the server does not process the [**XTYP\_REQUEST**](xtyp-request.md) transaction, **DdeClientTransaction** returns **NULL**, and *lpdwResult* points to the DDE\_FNOTPROCESSED or DDE\_FBUSY flag.</span></span> <span data-ttu-id="fd775-155">Si l' \_ indicateur DDE FNOTPROCESSED est retourné, le client ne peut pas déterminer la raison pour laquelle le serveur n’a pas traité la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-155">If the DDE\_FNOTPROCESSED flag is returned, the client cannot determine why the server did not process the transaction.</span></span>

<span data-ttu-id="fd775-156">Si un serveur ne prend pas en charge la transaction de [**\_ demande XTYP**](xtyp-request.md) , il doit spécifier l' \_ \_ indicateur de filtre de demandes CBF Fail dans la fonction [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="fd775-156">If a server does not support the [**XTYP\_REQUEST**](xtyp-request.md) transaction, it should specify the CBF\_FAIL\_REQUESTS filter flag in the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span> <span data-ttu-id="fd775-157">Cet indicateur empêche DDEML d’envoyer la transaction au serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-157">This flag prevents the DDEML from sending the transaction to the server.</span></span>

## <a name="poke-transaction"></a><span data-ttu-id="fd775-158">Transaction de journalisation</span><span class="sxs-lookup"><span data-stu-id="fd775-158">Poke Transaction</span></span>

<span data-ttu-id="fd775-159">Un client peut envoyer des données non sollicitées à un serveur à l’aide de [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) pour envoyer une transaction d’ajout de [**XTYP \_**](xtyp-poke.md) à la fonction de rappel d’un serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-159">A client can send unsolicited data to a server by using [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) to send an [**XTYP\_POKE**](xtyp-poke.md) transaction to a server's callback function.</span></span>

<span data-ttu-id="fd775-160">L’application cliente crée d’abord une mémoire tampon qui contient les données à envoyer au serveur, puis passe un pointeur vers la mémoire tampon en tant que paramètre de [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-160">The client application first creates a buffer that contains the data to send to the server and then passes a pointer to the buffer as a parameter to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="fd775-161">Le client peut également utiliser la fonction [**DdeCreateDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) pour obtenir un handle de données qui identifie les données, puis passer le descripteur à **DdeClientTransaction**.</span><span class="sxs-lookup"><span data-stu-id="fd775-161">Alternatively, the client can use the [**DdeCreateDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) function to obtain a data handle that identifies the data and then pass the handle to **DdeClientTransaction**.</span></span> <span data-ttu-id="fd775-162">Dans les deux cas, le client spécifie également le nom de la rubrique, le nom de l’élément et le format de données lorsqu’il appelle **DdeClientTransaction**.</span><span class="sxs-lookup"><span data-stu-id="fd775-162">In either case, the client also specifies the topic name, item name, and data format when it calls **DdeClientTransaction**.</span></span>

<span data-ttu-id="fd775-163">DDEML transmet la transaction d’extension [**XTYP \_**](xtyp-poke.md) au serveur, en spécifiant le nom de la rubrique, le nom de l’élément et le format de données que le client a demandé.</span><span class="sxs-lookup"><span data-stu-id="fd775-163">The DDEML passes the [**XTYP\_POKE**](xtyp-poke.md) transaction to the server, specifying the topic name, item name, and data format that the client requested.</span></span> <span data-ttu-id="fd775-164">Pour accepter l’élément et le format de données, le serveur doit retourner des \_ Fack DDE.</span><span class="sxs-lookup"><span data-stu-id="fd775-164">To accept the data item and format, the server should return DDE\_FACK.</span></span> <span data-ttu-id="fd775-165">Pour refuser les données, le serveur doit retourner des \_ FNOTPROCESSED DDE.</span><span class="sxs-lookup"><span data-stu-id="fd775-165">To reject the data, the server should return DDE\_FNOTPROCESSED.</span></span> <span data-ttu-id="fd775-166">Si le serveur est trop occupé pour accepter les données, le serveur doit renvoyer des \_ FBUSY DDE.</span><span class="sxs-lookup"><span data-stu-id="fd775-166">If the server is too busy to accept the data, the server should return DDE\_FBUSY.</span></span>

<span data-ttu-id="fd775-167">Quand [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) retourne, le client peut utiliser le paramètre *lpdwResult* pour accéder à l’indicateur d’état de transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-167">When [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) returns, the client can use the *lpdwResult* parameter to access the transaction-status flag.</span></span> <span data-ttu-id="fd775-168">Si l’indicateur est \_ FBUSY DDE, le client doit renvoyer la transaction ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="fd775-168">If the flag is DDE\_FBUSY, the client should send the transaction again later.</span></span>

<span data-ttu-id="fd775-169">Si un serveur ne prend pas en [**charge \_ la transaction XTYP**](xtyp-poke.md) , il doit spécifier l' \_ \_ indicateur de filtre d’échec de CBF dans [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea).</span><span class="sxs-lookup"><span data-stu-id="fd775-169">If a server does not support the [**XTYP\_POKE**](xtyp-poke.md) transaction, it should specify the CBF\_FAIL\_POKES filter flag in [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea).</span></span> <span data-ttu-id="fd775-170">Cet indicateur empêche DDEML d’envoyer cette transaction au serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-170">This flag prevents the DDEML from sending this transaction to the server.</span></span>

## <a name="advise-transaction"></a><span data-ttu-id="fd775-171">Transaction de notification</span><span class="sxs-lookup"><span data-stu-id="fd775-171">Advise Transaction</span></span>

<span data-ttu-id="fd775-172">Une application cliente peut utiliser DDEML pour établir un ou plusieurs liens vers les éléments d’une application serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-172">A client application can use the DDEML to establish one or more links to items in a server application.</span></span> <span data-ttu-id="fd775-173">Lorsqu’un tel lien a été établi, le serveur envoie des mises à jour périodiques sur l’élément lié au client (en général, chaque fois que la valeur de l’élément associé à l’application serveur est modifiée).</span><span class="sxs-lookup"><span data-stu-id="fd775-173">When such a link has been established, the server sends periodic updates about the linked item to the client (typically, whenever the value of the item associated with the server application changes).</span></span> <span data-ttu-id="fd775-174">La liaison établit une boucle de notification entre les deux applications qui reste en place jusqu’à ce que le client le termine.</span><span class="sxs-lookup"><span data-stu-id="fd775-174">Linking establishes an advise loop between the two applications that remains in place until the client ends it.</span></span>

<span data-ttu-id="fd775-175">Il existe deux types de boucles de notification : « chaude » et « chaude ».</span><span class="sxs-lookup"><span data-stu-id="fd775-175">There are two kinds of advise loops: "hot" and "warm."</span></span> <span data-ttu-id="fd775-176">Dans une boucle de notification à chaud, le serveur envoie immédiatement un handle de données qui identifie la valeur modifiée.</span><span class="sxs-lookup"><span data-stu-id="fd775-176">In a hot advise loop, the server immediately sends a data handle that identifies the changed value.</span></span> <span data-ttu-id="fd775-177">Dans une boucle de notification à chaud, le serveur notifie le client que la valeur de l’élément a changé, mais n’envoie pas le descripteur de données tant que le client ne l’a pas demandé.</span><span class="sxs-lookup"><span data-stu-id="fd775-177">In a warm advise loop, the server notifies the client that the value of the item has changed but does not send the data handle until the client requests it.</span></span>

<span data-ttu-id="fd775-178">Un client peut demander une boucle de notification à chaud avec un serveur en spécifiant le type de transaction [**XTYP \_ ADVSTART**](xtyp-advstart.md) dans un appel à [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-178">A client can request a hot advise loop with a server by specifying the [**XTYP\_ADVSTART**](xtyp-advstart.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="fd775-179">Pour demander une boucle de notification à chaud, le client doit combiner l' \_ indicateur NoData XTYPF avec le type de transaction **XTYP \_ ADVSTART** .</span><span class="sxs-lookup"><span data-stu-id="fd775-179">To request a warm advise loop, the client must combine the XTYPF\_NODATA flag with the **XTYP\_ADVSTART** transaction type.</span></span> <span data-ttu-id="fd775-180">Dans les deux cas, DDEML transmet la transaction **XTYP \_ ADVSTART** à la fonction de rappel échange dynamique de données (DDE) du serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-180">In either event, the DDEML passes the **XTYP\_ADVSTART** transaction to the server's Dynamic Data Exchange (DDE) callback function.</span></span> <span data-ttu-id="fd775-181">La fonction de rappel DDE du serveur doit examiner les paramètres qui accompagnent la transaction **XTYP \_ ADVSTART** (y compris le format demandé, le nom de la rubrique et le nom de l’élément), puis retourne **true** pour autoriser la boucle Advise ou **false** à la refuser.</span><span class="sxs-lookup"><span data-stu-id="fd775-181">The server's DDE callback function should examine the parameters that accompany the **XTYP\_ADVSTART** transaction (including the requested format, topic name, and item name) and then return **TRUE** to allow the advise loop or **FALSE** to deny it.</span></span>

<span data-ttu-id="fd775-182">Après l’établissement d’une boucle de notification, l’application serveur doit appeler la fonction [**DdePostAdvise**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) chaque fois que la valeur de l’élément associé au nom de l’élément demandé change.</span><span class="sxs-lookup"><span data-stu-id="fd775-182">After an advise loop has been established, the server application should call the [**DdePostAdvise**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) function whenever the value of the item associated with the requested item name changes.</span></span> <span data-ttu-id="fd775-183">Cet appel entraîne l’envoi d’une transaction [**XTYP \_ ADVREQ**](xtyp-advreq.md) à la fonction de rappel DDE du serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-183">This call results in an [**XTYP\_ADVREQ**](xtyp-advreq.md) transaction being sent to the server's own DDE callback function.</span></span> <span data-ttu-id="fd775-184">La fonction de rappel DDE du serveur doit retourner un handle de données qui identifie la nouvelle valeur de l’élément de données.</span><span class="sxs-lookup"><span data-stu-id="fd775-184">The server's DDE callback function should return a data handle that identifies the new value of the data item.</span></span> <span data-ttu-id="fd775-185">Le DDEML informe ensuite le client que l’élément spécifié a changé en envoyant la transaction [**XTYP \_ ADVDATA**](xtyp-advdata.md) à la fonction de rappel DDE du client.</span><span class="sxs-lookup"><span data-stu-id="fd775-185">The DDEML then notifies the client that the specified item has changed by sending the [**XTYP\_ADVDATA**](xtyp-advdata.md) transaction to the client's DDE callback function.</span></span>

<span data-ttu-id="fd775-186">Si le client a demandé une boucle de notification à chaud, le DDEML transmet le descripteur de données à l’élément modifié au client au cours de la transaction [**\_ ADVDATA XTYP**](xtyp-advdata.md) .</span><span class="sxs-lookup"><span data-stu-id="fd775-186">If the client requested a hot advise loop, the DDEML passes the data handle to the changed item to the client during the [**XTYP\_ADVDATA**](xtyp-advdata.md) transaction.</span></span> <span data-ttu-id="fd775-187">Dans le cas contraire, le client peut envoyer une transaction de [**\_ demande XTYP**](xtyp-request.md) pour obtenir le descripteur de données.</span><span class="sxs-lookup"><span data-stu-id="fd775-187">Otherwise, the client can send an [**XTYP\_REQUEST**](xtyp-request.md) transaction to obtain the data handle.</span></span>

<span data-ttu-id="fd775-188">Il est possible pour un serveur d’envoyer des mises à jour plus rapidement qu’un client ne peut traiter les nouvelles données.</span><span class="sxs-lookup"><span data-stu-id="fd775-188">It is possible for a server to send updates faster than a client can process the new data.</span></span> <span data-ttu-id="fd775-189">La vitesse des mises à jour peut être un problème pour un client qui doit effectuer des opérations de traitement longues sur les données.</span><span class="sxs-lookup"><span data-stu-id="fd775-189">The speed of updates can be a problem for a client that must perform lengthy processing operations on the data.</span></span> <span data-ttu-id="fd775-190">Dans ce cas, le client doit spécifier l' \_ indicateur XTYPF ACKREQ lorsqu’il demande une boucle de notification.</span><span class="sxs-lookup"><span data-stu-id="fd775-190">In this case, the client should specify the XTYPF\_ACKREQ flag when it requests an advise loop.</span></span> <span data-ttu-id="fd775-191">Cet indicateur force le serveur à attendre que le client confirme qu’il a reçu et traité un élément de données avant que le serveur n’envoie l’élément de données suivant.</span><span class="sxs-lookup"><span data-stu-id="fd775-191">This flag causes the server to wait for the client to acknowledge that it has received and processed a data item before the server sends the next data item.</span></span> <span data-ttu-id="fd775-192">Les boucles de notification établies avec l' \_ indicateur XTYPF ACKREQ sont plus robustes avec les serveurs rapides, mais peuvent parfois manquer de mises à jour.</span><span class="sxs-lookup"><span data-stu-id="fd775-192">Advise loops that are established with the XTYPF\_ACKREQ flag are more robust with fast servers but can occasionally miss updates.</span></span> <span data-ttu-id="fd775-193">Les boucles de notification établies sans l' \_ indicateur XTYPF ACKREQ sont assurées de ne pas manquer les mises à jour tant que le client continue de s’exécuter sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-193">Advise loops established without the XTYPF\_ACKREQ flag are guaranteed not to miss updates as long as the client keeps up with the server.</span></span>

<span data-ttu-id="fd775-194">Un client peut terminer une boucle de notification en spécifiant le type de transaction [**XTYP \_ ADVSTOP**](xtyp-advstop.md) dans un appel à [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-194">A client can end an advise loop by specifying the [**XTYP\_ADVSTOP**](xtyp-advstop.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>

<span data-ttu-id="fd775-195">Si un serveur ne prend pas en charge les boucles de notification, il doit spécifier l' \_ \_ indicateur de filtre de notifications d’échec CBF dans la fonction [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="fd775-195">If a server does not support advise loops, it should specify the CBF\_FAIL\_ADVISES filter flag in the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span> <span data-ttu-id="fd775-196">Cet indicateur empêche DDEML d’envoyer les transactions [**XTYP \_ ADVSTART**](xtyp-advstart.md) et [**XTYP \_ ADVSTOP**](xtyp-advstop.md) au serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-196">This flag prevents the DDEML from sending the [**XTYP\_ADVSTART**](xtyp-advstart.md) and [**XTYP\_ADVSTOP**](xtyp-advstop.md) transactions to the server.</span></span>

## <a name="execute-transaction"></a><span data-ttu-id="fd775-197">Exécuter la transaction</span><span class="sxs-lookup"><span data-stu-id="fd775-197">Execute Transaction</span></span>

<span data-ttu-id="fd775-198">Un client peut utiliser la transaction d' [**\_ exécution XTYP**](xtyp-execute.md) pour faire en sorte qu’un serveur exécute une commande ou une série de commandes.</span><span class="sxs-lookup"><span data-stu-id="fd775-198">A client can use the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction to cause a server to execute a command or a series of commands.</span></span>

<span data-ttu-id="fd775-199">Pour exécuter une commande de serveur, le client crée d’abord une mémoire tampon qui contient une chaîne de commande que le serveur doit exécuter, puis passe un pointeur vers la mémoire tampon ou un handle de données qui identifie la mémoire tampon lorsqu’elle appelle [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-199">To execute a server command, the client first creates a buffer that contains a command string for the server to execute and then passes either a pointer to the buffer or a data handle identifying the buffer when it calls [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="fd775-200">Les autres paramètres requis incluent le descripteur de conversation, le descripteur de chaîne de nom d’élément, la spécification de format et le type de transaction d' [**\_ exécution XTYP**](xtyp-execute.md) .</span><span class="sxs-lookup"><span data-stu-id="fd775-200">Other required parameters include the conversation handle, the item name string handle, the format specification, and the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction type.</span></span> <span data-ttu-id="fd775-201">Une application qui crée un descripteur de données pour transmettre des données d’exécution doit spécifier **null** pour le paramètre *hszItem* de la fonction [**DdeCreateDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) et zéro pour le paramètre *uFmt* .</span><span class="sxs-lookup"><span data-stu-id="fd775-201">An application that creates a data handle to passing execute data must specify **NULL** for the *hszItem* parameter of the [**DdeCreateDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) function and zero for the *uFmt* parameter.</span></span>

<span data-ttu-id="fd775-202">DDEML transmet la transaction [**d' \_ exécution XTYP**](xtyp-execute.md) à la fonction de rappel DDE du serveur et spécifie le nom de format, le descripteur de conversation, le nom de la rubrique et le descripteur de données identifiant la chaîne de commande.</span><span class="sxs-lookup"><span data-stu-id="fd775-202">The DDEML passes the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction to the server's DDE callback function and specifies the format name, conversation handle, topic name, and data handle identifying the command string.</span></span> <span data-ttu-id="fd775-203">Si le serveur prend en charge la commande, il doit utiliser la fonction [**DdeAccessData**](/windows/desktop/api/Ddeml/nf-ddeml-ddeaccessdata) pour obtenir un pointeur vers la chaîne de commande, exécuter la commande, puis retourner des \_ Fack DDE.</span><span class="sxs-lookup"><span data-stu-id="fd775-203">If the server supports the command, it should use the [**DdeAccessData**](/windows/desktop/api/Ddeml/nf-ddeml-ddeaccessdata) function to obtain a pointer to the command string, execute the command, and then return DDE\_FACK.</span></span> <span data-ttu-id="fd775-204">Si le serveur ne prend pas en charge la commande ou ne peut pas exécuter la transaction, il doit renvoyer des \_ FNOTPROCESSED DDE.</span><span class="sxs-lookup"><span data-stu-id="fd775-204">If the server does not support the command or cannot complete the transaction, it should return DDE\_FNOTPROCESSED.</span></span> <span data-ttu-id="fd775-205">Le serveur doit retourner le \_ FBUSY DDE s’il est trop occupé pour terminer la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-205">The server should return DDE\_FBUSY if it is too busy to complete the transaction.</span></span>

<span data-ttu-id="fd775-206">En général, la fonction de rappel d’un serveur doit traiter la transaction d' [**\_ exécution XTYP**](xtyp-execute.md) avant de retourner avec les exceptions suivantes :</span><span class="sxs-lookup"><span data-stu-id="fd775-206">In general, a server's callback function should process the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction before returning with the following exceptions:</span></span>

1.  <span data-ttu-id="fd775-207">Lorsque la commande transmise avec [**XTYP \_ Execute**](xtyp-execute.md) transaction demande au serveur de se terminer, le serveur ne doit pas se terminer tant que sa fonction de rappel n’est pas retournée du traitement de l' **\_ exécution de XTYP**.</span><span class="sxs-lookup"><span data-stu-id="fd775-207">When the command passed with the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction requests the server to terminate, the server should not terminate until its callback function returns from processing **XTYP\_EXECUTE**.</span></span>
2.  <span data-ttu-id="fd775-208">Si le serveur doit effectuer une opération, telle que le traitement d’une boîte de dialogue ou d’une transaction DDE qui peut provoquer des problèmes de récurrence de DDEML, le serveur doit retourner le \_ Code de retour du bloc CBR pour bloquer l’exécution de la transaction, effectuer l’opération, puis reprendre le traitement de la transaction d’exécution.</span><span class="sxs-lookup"><span data-stu-id="fd775-208">If the server must perform an operation, such as processing a dialog box or a DDE transaction that might cause DDEML recursion problems, the server should return the CBR\_BLOCK return code to block the execute transaction, perform the operation, and then resume processing the execute transaction.</span></span>

<span data-ttu-id="fd775-209">Quand [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) retourne, le client peut utiliser le paramètre *lpdwResult* pour accéder à l’indicateur d’état de la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-209">When [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) returns, the client can use the *lpdwResult* parameter to access the transaction status flag.</span></span> <span data-ttu-id="fd775-210">Si l’indicateur est \_ FBUSY DDE, le client doit renvoyer la transaction ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="fd775-210">If the flag is DDE\_FBUSY, the client should send the transaction again later.</span></span>

<span data-ttu-id="fd775-211">Si un serveur ne prend pas en charge la transaction d' [**\_ exécution XTYP**](xtyp-execute.md) , il doit spécifier l' \_ \_ indicateur de filtre CBF Fail executes dans la fonction [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="fd775-211">If a server does not support the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction, it should specify the CBF\_FAIL\_EXECUTES filter flag in the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span> <span data-ttu-id="fd775-212">Cela empêche le DDEML d’envoyer la transaction au serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-212">Doing so prevents the DDEML from sending the transaction to the server.</span></span>

## <a name="synchronous-and-asynchronous-transactions"></a><span data-ttu-id="fd775-213">Transactions synchrones et asynchrones</span><span class="sxs-lookup"><span data-stu-id="fd775-213">Synchronous and Asynchronous Transactions</span></span>

<span data-ttu-id="fd775-214">Un client peut envoyer des transactions synchrones ou asynchrones.</span><span class="sxs-lookup"><span data-stu-id="fd775-214">A client can send either synchronous or asynchronous transactions.</span></span> <span data-ttu-id="fd775-215">Dans une transaction synchrone, le client spécifie une valeur de délai d’attente qui indique la durée maximale pendant laquelle il attend que le serveur traite la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-215">In a synchronous transaction, the client specifies a time-out value that indicates the maximum amount of time it will wait for the server to process the transaction.</span></span> <span data-ttu-id="fd775-216">[**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) ne retourne pas de valeur tant que le serveur n’a pas traité la transaction, que la transaction échoue ou que la valeur de délai d’attente expire.</span><span class="sxs-lookup"><span data-stu-id="fd775-216">[**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) does not return until the server processes the transaction, the transaction fails, or the time-out value expires.</span></span> <span data-ttu-id="fd775-217">Le client spécifie la valeur du délai d’attente lors de l’appel de **DdeClientTransaction**.</span><span class="sxs-lookup"><span data-stu-id="fd775-217">The client specifies the time-out value when it calls **DdeClientTransaction**.</span></span>

<span data-ttu-id="fd775-218">Pendant une transaction synchrone, le client entre une boucle modale en attendant que la transaction soit traitée.</span><span class="sxs-lookup"><span data-stu-id="fd775-218">During a synchronous transaction, the client enters a modal loop while waiting for the transaction to be processed.</span></span> <span data-ttu-id="fd775-219">Le client peut toujours traiter l’entrée d’utilisateur, mais ne peut pas envoyer une autre transaction synchrone tant que [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) n’est pas retourné.</span><span class="sxs-lookup"><span data-stu-id="fd775-219">The client can still process user input but cannot send another synchronous transaction until [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) returns.</span></span>

<span data-ttu-id="fd775-220">Un client envoie une transaction asynchrone en spécifiant l' \_ indicateur Async Timeout dans [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-220">A client sends an asynchronous transaction by specifying the TIMEOUT\_ASYNC flag in [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span> <span data-ttu-id="fd775-221">La fonction retourne une fois que la transaction a commencé, en passant un identificateur de transaction au client.</span><span class="sxs-lookup"><span data-stu-id="fd775-221">The function returns after the transaction has begun, passing a transaction identifier to the client.</span></span> <span data-ttu-id="fd775-222">Une fois que le serveur a terminé le traitement de la transaction asynchrone, DDEML envoie une transaction [**XTYP \_ XACT \_ Complete**](xtyp-xact-complete.md) au client.</span><span class="sxs-lookup"><span data-stu-id="fd775-222">When the server finishes processing the asynchronous transaction, the DDEML sends an [**XTYP\_XACT\_COMPLETE**](xtyp-xact-complete.md) transaction to the client.</span></span> <span data-ttu-id="fd775-223">L’un des paramètres que le DDEML transmet au client pendant la transaction **XTYP \_ XACT \_ Complete** est l’identificateur de la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-223">One of the parameters that the DDEML passes to the client during the **XTYP\_XACT\_COMPLETE** transaction is the transaction identifier.</span></span> <span data-ttu-id="fd775-224">En comparant cet identificateur de transaction avec l’identificateur retourné par **DdeClientTransaction**, le client identifie la transaction asynchrone que le serveur a terminé de traiter.</span><span class="sxs-lookup"><span data-stu-id="fd775-224">By comparing this transaction identifier with the identifier returned by **DdeClientTransaction**, the client identifies which asynchronous transaction the server has finished processing.</span></span>

<span data-ttu-id="fd775-225">Un client peut utiliser la fonction [**DdeSetUserHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddesetuserhandle) comme aide pour le traitement d’une transaction asynchrone.</span><span class="sxs-lookup"><span data-stu-id="fd775-225">A client can use the [**DdeSetUserHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddesetuserhandle) function as an aid in processing an asynchronous transaction.</span></span> <span data-ttu-id="fd775-226">Cette fonction permet à un client d’associer une valeur définie par l’application à un descripteur de conversation et à un identificateur de transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-226">This function makes it possible for a client to associate an application-defined value with a conversation handle and a transaction identifier.</span></span> <span data-ttu-id="fd775-227">Le client peut utiliser la fonction [**DdeQueryConvInfo**](/windows/desktop/api/Ddeml/nf-ddeml-ddequeryconvinfo) pendant la transaction [**XTYP \_ XACT \_ Complete**](xtyp-xact-complete.md) pour obtenir la valeur définie par l’application.</span><span class="sxs-lookup"><span data-stu-id="fd775-227">The client can use the [**DdeQueryConvInfo**](/windows/desktop/api/Ddeml/nf-ddeml-ddequeryconvinfo) function during the [**XTYP\_XACT\_COMPLETE**](xtyp-xact-complete.md) transaction to obtain the application-defined value.</span></span> <span data-ttu-id="fd775-228">En raison de cette fonction, une application n’a pas besoin de conserver une liste d’identificateurs de transaction actifs.</span><span class="sxs-lookup"><span data-stu-id="fd775-228">Because of this function, an application need not maintain a list of active transaction identifiers.</span></span>

<span data-ttu-id="fd775-229">Lorsqu’un client effectue avec succès une demande de données à l’aide d’une transaction synchrone, le DDEML n’a aucun moyen de savoir à quel moment le client a terminé d’utiliser les données reçues.</span><span class="sxs-lookup"><span data-stu-id="fd775-229">When a client successfully completes a request for data using a synchronous transaction, the DDEML has no way to tell when the client has finished using the data received.</span></span> <span data-ttu-id="fd775-230">L’application cliente doit passer le descripteur de données reçu à la fonction [**DdeFreeDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreedatahandle) , en notifiant au Ddeml que le descripteur ne sera plus utilisé.</span><span class="sxs-lookup"><span data-stu-id="fd775-230">The client application must pass the data handle received to the [**DdeFreeDataHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreedatahandle) function, notifying the DDEML that the handle will no longer be used.</span></span> <span data-ttu-id="fd775-231">Les handles de données retournés par les transactions synchrones sont détenus par le client.</span><span class="sxs-lookup"><span data-stu-id="fd775-231">Data handles returned by synchronous transactions are effectively owned by the client.</span></span>

<span data-ttu-id="fd775-232">Si un serveur ne traite pas une transaction asynchrone en temps opportun, le client peut abandonner la transaction en appelant la fonction [**DdeAbandonTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeabandontransaction) .</span><span class="sxs-lookup"><span data-stu-id="fd775-232">If a server does not process an asynchronous transaction in a timely manner, the client can abandon the transaction by calling the [**DdeAbandonTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeabandontransaction) function.</span></span> <span data-ttu-id="fd775-233">Le DDEML libère toutes les ressources associées à la transaction et ignore les résultats de la transaction lorsque le serveur termine le traitement.</span><span class="sxs-lookup"><span data-stu-id="fd775-233">The DDEML releases all resources associated with the transaction and discards the results of the transaction when the server finishes processing it.</span></span> <span data-ttu-id="fd775-234">Un délai d’attente pendant une transaction synchrone annule effectivement la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-234">A time-out during a synchronous transaction effectively cancels the transaction.</span></span>

<span data-ttu-id="fd775-235">La méthode de transaction asynchrone est fournie pour les applications qui doivent envoyer un volume élevé de transactions DDE tout en effectuant simultanément une quantité importante de traitement, par exemple en effectuant des calculs.</span><span class="sxs-lookup"><span data-stu-id="fd775-235">The asynchronous transaction method is provided for applications that must send a high volume of DDE transactions while simultaneously performing a substantial amount of processing, such as performing calculations.</span></span> <span data-ttu-id="fd775-236">La méthode asynchrone est également utile dans les applications qui doivent cesser de traiter temporairement les transactions DDE afin de pouvoir effectuer d’autres tâches sans interruption.</span><span class="sxs-lookup"><span data-stu-id="fd775-236">The asynchronous method is also useful in applications that must stop processing DDE transactions temporarily so they can complete other tasks without interruption.</span></span> <span data-ttu-id="fd775-237">Dans la plupart des autres cas, une application doit utiliser la méthode synchrone.</span><span class="sxs-lookup"><span data-stu-id="fd775-237">In most other situations, an application should use the synchronous method.</span></span>

<span data-ttu-id="fd775-238">Les transactions synchrones sont plus simples à gérer et sont plus rapides que les transactions asynchrones.</span><span class="sxs-lookup"><span data-stu-id="fd775-238">Synchronous transactions are simpler to maintain and are faster than asynchronous transactions.</span></span> <span data-ttu-id="fd775-239">Toutefois, une seule transaction synchrone peut être exécutée à la fois, tandis que de nombreuses transactions asynchrones peuvent être exécutées simultanément.</span><span class="sxs-lookup"><span data-stu-id="fd775-239">However, only one synchronous transaction can be performed at a time, whereas many asynchronous transactions can be performed simultaneously.</span></span> <span data-ttu-id="fd775-240">Avec les transactions synchrones, un serveur lent peut faire en sorte qu’un client reste inactif pendant qu’il attend une réponse.</span><span class="sxs-lookup"><span data-stu-id="fd775-240">With synchronous transactions, a slow server can cause a client to remain idle while it is waiting for a response.</span></span> <span data-ttu-id="fd775-241">En outre, les transactions synchrones font en sorte que le client entre dans une boucle modale qui peut contourner le filtrage des messages dans la propre boucle de message de l’application.</span><span class="sxs-lookup"><span data-stu-id="fd775-241">Also, synchronous transactions cause the client to enter a modal loop that could bypass message filtering in the application's own message loop.</span></span>

<span data-ttu-id="fd775-242">Si le client a installé une procédure de Hook pour filtrer les messages (c’est-à-dire, spécifié le \_ type de hook BL msgfilter dans un appel à la fonction [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) ), une transaction synchrone n’entraîne pas le contournement de la procédure de hook par le système.</span><span class="sxs-lookup"><span data-stu-id="fd775-242">If the client has installed a hook procedure to filter messages (that is, specified the WH\_MSGFILTER hook type in a call to the [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) function), a synchronous transaction will not cause the system to bypass the hook procedure.</span></span> <span data-ttu-id="fd775-243">Lorsqu’un événement d’entrée se produit pendant que le client attend la fin d’une transaction synchrone, la procédure de raccordement reçoit un \_ Code de hook MSGF DDEMGR.</span><span class="sxs-lookup"><span data-stu-id="fd775-243">When an input event occurs while the client is waiting for a synchronous transaction to end, the hook procedure receives an MSGF\_DDEMGR hook code.</span></span> <span data-ttu-id="fd775-244">Le danger principal de l’utilisation d’une boucle modale de transaction synchrone est qu’une boucle modale créée par une boîte de dialogue peut interférer avec son fonctionnement.</span><span class="sxs-lookup"><span data-stu-id="fd775-244">The main danger of using a synchronous transaction modal loop is that a modal loop created by a dialog box can interfere with its operation.</span></span> <span data-ttu-id="fd775-245">Les transactions asynchrones doivent toujours être utilisées lorsque le DDEML est utilisé par une DLL.</span><span class="sxs-lookup"><span data-stu-id="fd775-245">Asynchronous transactions should always be used when the DDEML is being used by a DLL.</span></span>

## <a name="transaction-control"></a><span data-ttu-id="fd775-246">Contrôle de transaction</span><span class="sxs-lookup"><span data-stu-id="fd775-246">Transaction Control</span></span>

<span data-ttu-id="fd775-247">Une application peut suspendre des transactions à sa fonction de rappel DDE soit ces transactions associées à un descripteur de conversation spécifique, soit toutes les transactions, quel que soit le descripteur de conversation.</span><span class="sxs-lookup"><span data-stu-id="fd775-247">An application can suspend transactions to its DDE callback function   either those transactions associated with a specific conversation handle or all transactions regardless of the conversation handle.</span></span> <span data-ttu-id="fd775-248">Cette fonctionnalité est utile quand une application reçoit une transaction qui nécessite un traitement long.</span><span class="sxs-lookup"><span data-stu-id="fd775-248">This capability is useful when an application receives a transaction that requires lengthy processing.</span></span> <span data-ttu-id="fd775-249">Dans ce cas, l’application peut renvoyer le \_ Code de retour de bloc CBR pour suspendre les futures transactions associées au descripteur de conversation de la transaction, afin que l’application soit libre de traiter d’autres conversations.</span><span class="sxs-lookup"><span data-stu-id="fd775-249">In such a case, the application can return the CBR\_BLOCK return code to suspend future transactions associated with the transaction's conversation handle, so that the application is free to process other conversations.</span></span>

<span data-ttu-id="fd775-250">Une fois le traitement terminé, l’application appelle la fonction [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback) pour reprendre les transactions associées à la conversation suspendue.</span><span class="sxs-lookup"><span data-stu-id="fd775-250">When processing has been completed, the application calls the [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback) function to resume transactions associated with the suspended conversation.</span></span> <span data-ttu-id="fd775-251">L’appel de **DdeEnableCallback** amène le Ddeml à renvoyer la transaction qui a entraîné la suspension de la conversation par l’application.</span><span class="sxs-lookup"><span data-stu-id="fd775-251">Calling **DdeEnableCallback** causes the DDEML to resend the transaction that resulted in the application suspending the conversation.</span></span> <span data-ttu-id="fd775-252">Par conséquent, l’application doit stocker le résultat de la transaction de manière à ce qu’elle puisse obtenir et retourner le résultat sans retraiter la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-252">Therefore, the application should store the result of the transaction in such a way that it can obtain and return the result without reprocessing the transaction.</span></span>

<span data-ttu-id="fd775-253">Une application peut suspendre toutes les transactions associées à un handle de conversation spécifique en spécifiant le descripteur et l' \_ indicateur EC Disable dans un appel à [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback).</span><span class="sxs-lookup"><span data-stu-id="fd775-253">An application can suspend all transactions associated with a specific conversation handle by specifying the handle and the EC\_DISABLE flag in a call to [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback).</span></span> <span data-ttu-id="fd775-254">En spécifiant un descripteur **null** , une application peut suspendre toutes les transactions pour toutes les conversations.</span><span class="sxs-lookup"><span data-stu-id="fd775-254">By specifying a **NULL** handle, an application can suspend all transactions for all conversations.</span></span>

<span data-ttu-id="fd775-255">Lorsqu’une conversation a été interrompue, DDEML enregistre les transactions de la conversation dans une file d’attente de transactions.</span><span class="sxs-lookup"><span data-stu-id="fd775-255">When a conversation has been suspended, the DDEML saves transactions for the conversation in a transaction queue.</span></span> <span data-ttu-id="fd775-256">Lorsque l’application réactive la conversation, DDEML supprime les transactions enregistrées de la file d’attente et transmet chaque transaction à la fonction de rappel appropriée.</span><span class="sxs-lookup"><span data-stu-id="fd775-256">When the application reenables the conversation, the DDEML removes the saved transactions from the queue and passes each transaction to the appropriate callback function.</span></span> <span data-ttu-id="fd775-257">La capacité de la file d’attente des transactions est importante, mais une application doit réactiver une conversation suspendue dès que possible pour éviter de perdre des transactions.</span><span class="sxs-lookup"><span data-stu-id="fd775-257">The capacity of the transaction queue is large, but an application should reenable a suspended conversation as soon as possible to avoid losing transactions.</span></span>

<span data-ttu-id="fd775-258">Une application peut reprendre le traitement de transactions habituel en spécifiant l' \_ indicateur EC ENABLEALL dans [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback).</span><span class="sxs-lookup"><span data-stu-id="fd775-258">An application can resume usual transaction processing by specifying the EC\_ENABLEALL flag in [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback).</span></span> <span data-ttu-id="fd775-259">Pour une reprise plus contrôlée du traitement des transactions, l’application peut spécifier l' \_ indicateur EC ENABLEONE.</span><span class="sxs-lookup"><span data-stu-id="fd775-259">For a more controlled resumption of transaction processing, the application can specify the EC\_ENABLEONE flag.</span></span> <span data-ttu-id="fd775-260">Cet indicateur supprime une transaction de la file d’attente des transactions et la transmet à la fonction de rappel appropriée. une fois cette transaction traitée, toutes les conversations sont à nouveau désactivées.</span><span class="sxs-lookup"><span data-stu-id="fd775-260">This flag removes one transaction from the transaction queue and passes it to the appropriate callback function; after that transaction has been processed, any conversations are again disabled.</span></span>

<span data-ttu-id="fd775-261">Si l' \_ indicateur EC ENABLEONE et un descripteur de conversation sont spécifiés dans l’appel à [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback), seule cette conversation est bloquée après le traitement de la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-261">If the EC\_ENABLEONE flag and a conversation handle are specified in the call to [**DdeEnableCallback**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback), only that conversation is blocked after the transaction has been processed.</span></span> <span data-ttu-id="fd775-262">Si un descripteur de conversation **null** est spécifié, toutes les conversations sont bloquées après le traitement d’une transaction dans une conversation.</span><span class="sxs-lookup"><span data-stu-id="fd775-262">If a **NULL** conversation handle is specified, all conversations are blocked after a transaction has been processed in any conversation.</span></span>

## <a name="transaction-classes"></a><span data-ttu-id="fd775-263">Classes de transaction</span><span class="sxs-lookup"><span data-stu-id="fd775-263">Transaction Classes</span></span>

<span data-ttu-id="fd775-264">DDEML possède quatre classes de transactions.</span><span class="sxs-lookup"><span data-stu-id="fd775-264">The DDEML has four classes of transactions.</span></span> <span data-ttu-id="fd775-265">Chaque classe est identifiée par une constante qui commence par le \_ préfixe XCLASS.</span><span class="sxs-lookup"><span data-stu-id="fd775-265">Each class is identified by a constant that begins with the XCLASS\_ prefix.</span></span> <span data-ttu-id="fd775-266">Les classes sont définies dans le fichier d’en-tête DDEML.</span><span class="sxs-lookup"><span data-stu-id="fd775-266">The classes are defined in the DDEML header file.</span></span> <span data-ttu-id="fd775-267">La valeur de classe est associée à la valeur de type de transaction et est transmise à la fonction de rappel DDE de l’application réceptrice.</span><span class="sxs-lookup"><span data-stu-id="fd775-267">The class value is combined with the transaction-type value and is passed to the DDE callback function of the receiving application.</span></span>

<span data-ttu-id="fd775-268">La classe d’une transaction détermine la valeur de retour qu’une fonction de rappel est supposée retourner si elle traite la transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-268">A transaction's class determines the return value that a callback function is expected to return if it processes the transaction.</span></span> <span data-ttu-id="fd775-269">Les valeurs de retour et les types de transactions suivants sont associés à chacune des quatre classes de transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-269">The following return values and transaction types are associated with each of the four transaction classes.</span></span>



| <span data-ttu-id="fd775-270">Classe</span><span class="sxs-lookup"><span data-stu-id="fd775-270">Class</span></span>                | <span data-ttu-id="fd775-271">Valeur retournée</span><span class="sxs-lookup"><span data-stu-id="fd775-271">Return value</span></span>                                                     | <span data-ttu-id="fd775-272">Transaction</span><span class="sxs-lookup"><span data-stu-id="fd775-272">Transaction</span></span>                                                                                                                                                                                                                                                                                                                                                                                    |
|----------------------|------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="fd775-273">XCLASS \_ bool</span><span class="sxs-lookup"><span data-stu-id="fd775-273">XCLASS\_BOOL</span></span>         | <span data-ttu-id="fd775-274">**True** ou **false**</span><span class="sxs-lookup"><span data-stu-id="fd775-274">**TRUE** or **FALSE**</span></span>                                            | [<span data-ttu-id="fd775-275">**XTYP \_ ADVSTART**</span><span class="sxs-lookup"><span data-stu-id="fd775-275">**XTYP\_ADVSTART**</span></span>](xtyp-advstart.md)<br/> [<span data-ttu-id="fd775-276">**XTYP \_ Connect**</span><span class="sxs-lookup"><span data-stu-id="fd775-276">**XTYP\_CONNECT**</span></span>](xtyp-connect.md)<br/>                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="fd775-277">\_données XCLASS</span><span class="sxs-lookup"><span data-stu-id="fd775-277">XCLASS\_DATA</span></span>         | <span data-ttu-id="fd775-278">Un descripteur de données, le \_ Code de retour de bloc CBR ou **null**</span><span class="sxs-lookup"><span data-stu-id="fd775-278">A data handle, the CBR\_BLOCK return code, or **NULL**</span></span>           | [<span data-ttu-id="fd775-279">**XTYP \_ ADVREQ**</span><span class="sxs-lookup"><span data-stu-id="fd775-279">**XTYP\_ADVREQ**</span></span>](xtyp-advreq.md)<br/> [<span data-ttu-id="fd775-280">**\_demande XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-280">**XTYP\_REQUEST**</span></span>](xtyp-request.md)<br/> [<span data-ttu-id="fd775-281">**XTYP \_ WILDCONNECT**</span><span class="sxs-lookup"><span data-stu-id="fd775-281">**XTYP\_WILDCONNECT**</span></span>](xtyp-wildconnect.md)<br/>                                                                                                                                                                                                                                       |
| <span data-ttu-id="fd775-282">\_indicateurs XCLASS</span><span class="sxs-lookup"><span data-stu-id="fd775-282">XCLASS\_FLAGS</span></span>        | <span data-ttu-id="fd775-283">Indicateur de transaction : DDE \_ Fack, DDE \_ FBUSY ou DDE \_ FNOTPROCESSED</span><span class="sxs-lookup"><span data-stu-id="fd775-283">A transaction flag: DDE\_FACK, DDE\_FBUSY, or DDE\_FNOTPROCESSED</span></span> | [<span data-ttu-id="fd775-284">**XTYP \_ ADVDATA**</span><span class="sxs-lookup"><span data-stu-id="fd775-284">**XTYP\_ADVDATA**</span></span>](xtyp-advdata.md)<br/> [<span data-ttu-id="fd775-285">**exécution de XTYP \_**</span><span class="sxs-lookup"><span data-stu-id="fd775-285">**XTYP\_EXECUTE**</span></span>](xtyp-execute.md)<br/> [<span data-ttu-id="fd775-286">**XTYP \_**</span><span class="sxs-lookup"><span data-stu-id="fd775-286">**XTYP\_POKE**</span></span>](xtyp-poke.md)<br/>                                                                                                                                                                                                                                                   |
| <span data-ttu-id="fd775-287">\_notification XCLASS</span><span class="sxs-lookup"><span data-stu-id="fd775-287">XCLASS\_NOTIFICATION</span></span> | <span data-ttu-id="fd775-288">Aucun</span><span class="sxs-lookup"><span data-stu-id="fd775-288">None</span></span>                                                             | [<span data-ttu-id="fd775-289">**XTYP \_ ADVSTOP**</span><span class="sxs-lookup"><span data-stu-id="fd775-289">**XTYP\_ADVSTOP**</span></span>](xtyp-advstop.md)<br/> [<span data-ttu-id="fd775-290">**confirmer la XTYP \_ Connect \_**</span><span class="sxs-lookup"><span data-stu-id="fd775-290">**XTYP\_CONNECT\_CONFIRM**</span></span>](xtyp-connect-confirm.md)<br/> [<span data-ttu-id="fd775-291">**déconnexion XTYP \_**</span><span class="sxs-lookup"><span data-stu-id="fd775-291">**XTYP\_DISCONNECT**</span></span>](xtyp-disconnect.md)<br/> [<span data-ttu-id="fd775-292">**\_erreur XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-292">**XTYP\_ERROR**</span></span>](xtyp-error.md)<br/> [<span data-ttu-id="fd775-293">**\_Registre XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-293">**XTYP\_REGISTER**</span></span>](xtyp-register.md)<br/> [<span data-ttu-id="fd775-294">**\_désinscription XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-294">**XTYP\_UNREGISTER**</span></span>](xtyp-unregister.md)<br/> [<span data-ttu-id="fd775-295">**XTYP \_ XACT \_ terminé**</span><span class="sxs-lookup"><span data-stu-id="fd775-295">**XTYP\_XACT\_COMPLETE**</span></span>](xtyp-xact-complete.md)<br/> |



 

## <a name="transaction-types"></a><span data-ttu-id="fd775-296">Types de transactions</span><span class="sxs-lookup"><span data-stu-id="fd775-296">Transaction Types</span></span>

<span data-ttu-id="fd775-297">Chaque type de transaction DDE a un récepteur et une activité associée qui entraîne la génération par le DDEML de chaque type.</span><span class="sxs-lookup"><span data-stu-id="fd775-297">Each DDE transaction type has a receiver and an associated activity that causes the DDEML to generate each type.</span></span>



| <span data-ttu-id="fd775-298">Type de transaction</span><span class="sxs-lookup"><span data-stu-id="fd775-298">Transaction type</span></span>                                       | <span data-ttu-id="fd775-299">Destinataire</span><span class="sxs-lookup"><span data-stu-id="fd775-299">Receiver</span></span>                   | <span data-ttu-id="fd775-300">Cause</span><span class="sxs-lookup"><span data-stu-id="fd775-300">Cause</span></span>                                                                                                                                                                         |
|--------------------------------------------------------|----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="fd775-301">**XTYP \_ ADVDATA**</span><span class="sxs-lookup"><span data-stu-id="fd775-301">**XTYP\_ADVDATA**</span></span>](xtyp-advdata.md)                  | <span data-ttu-id="fd775-302">Client</span><span class="sxs-lookup"><span data-stu-id="fd775-302">Client</span></span>                     | <span data-ttu-id="fd775-303">Un serveur a répondu à une [**transaction \_ ADVREQ XTYP**](xtyp-advreq.md) en renvoyant un descripteur de données.</span><span class="sxs-lookup"><span data-stu-id="fd775-303">A server responded to an [**XTYP\_ADVREQ**](xtyp-advreq.md) transaction by returning a data handle.</span></span>                                                                          |
| [<span data-ttu-id="fd775-304">**XTYP \_ ADVREQ**</span><span class="sxs-lookup"><span data-stu-id="fd775-304">**XTYP\_ADVREQ**</span></span>](xtyp-advreq.md)                    | <span data-ttu-id="fd775-305">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-305">Server</span></span>                     | <span data-ttu-id="fd775-306">Un serveur a appelé la fonction [**DdePostAdvise**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) , indiquant que la valeur d’un élément de données dans une boucle de notification a changé.</span><span class="sxs-lookup"><span data-stu-id="fd775-306">A server called the [**DdePostAdvise**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) function, indicating that the value of a data item in an advise loop had changed.</span></span>                                  |
| [<span data-ttu-id="fd775-307">**XTYP \_ ADVSTART**</span><span class="sxs-lookup"><span data-stu-id="fd775-307">**XTYP\_ADVSTART**</span></span>](xtyp-advstart.md)                | <span data-ttu-id="fd775-308">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-308">Server</span></span>                     | <span data-ttu-id="fd775-309">Un client a spécifié le type de transaction [**XTYP \_ ADVSTART**](xtyp-advstart.md) dans un appel à la fonction [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) .</span><span class="sxs-lookup"><span data-stu-id="fd775-309">A client specified the [**XTYP\_ADVSTART**](xtyp-advstart.md) transaction type in a call to the [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) function.</span></span>               |
| [<span data-ttu-id="fd775-310">**XTYP \_ ADVSTOP**</span><span class="sxs-lookup"><span data-stu-id="fd775-310">**XTYP\_ADVSTOP**</span></span>](xtyp-advstop.md)                  | <span data-ttu-id="fd775-311">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-311">Server</span></span>                     | <span data-ttu-id="fd775-312">Un client a spécifié le type de transaction [**XTYP \_ ADVSTOP**](xtyp-advstop.md) dans un appel à [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-312">A client specified the [**XTYP\_ADVSTOP**](xtyp-advstop.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>                              |
| [<span data-ttu-id="fd775-313">**XTYP \_ Connect**</span><span class="sxs-lookup"><span data-stu-id="fd775-313">**XTYP\_CONNECT**</span></span>](xtyp-connect.md)                  | <span data-ttu-id="fd775-314">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-314">Server</span></span>                     | <span data-ttu-id="fd775-315">Un client a appelé la fonction [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) et a spécifié un nom de service et un nom de rubrique pris en charge par le serveur.</span><span class="sxs-lookup"><span data-stu-id="fd775-315">A client called the [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) function and specified a service name and topic name supported by the server.</span></span>                                            |
| [<span data-ttu-id="fd775-316">**confirmer la XTYP \_ Connect \_**</span><span class="sxs-lookup"><span data-stu-id="fd775-316">**XTYP\_CONNECT\_CONFIRM**</span></span>](xtyp-connect-confirm.md) | <span data-ttu-id="fd775-317">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-317">Server</span></span>                     | <span data-ttu-id="fd775-318">Le serveur a retourné la **valeur true** en réponse à une transaction [**XTYP \_ Connect**](xtyp-connect.md) ou [**XTYP \_ WILDCONNECT**](xtyp-wildconnect.md) .</span><span class="sxs-lookup"><span data-stu-id="fd775-318">The server returned **TRUE** in response to an [**XTYP\_CONNECT**](xtyp-connect.md) or [**XTYP\_WILDCONNECT**](xtyp-wildconnect.md) transaction.</span></span>                            |
| [<span data-ttu-id="fd775-319">**déconnexion XTYP \_**</span><span class="sxs-lookup"><span data-stu-id="fd775-319">**XTYP\_DISCONNECT**</span></span>](xtyp-disconnect.md)            | <span data-ttu-id="fd775-320">Client/serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-320">Client/Server</span></span>              | <span data-ttu-id="fd775-321">Un partenaire dans une conversation a appelé la fonction [**DdeDisconnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddedisconnect) , ce qui A pour effet que les deux partenaires reçoivent cette transaction.</span><span class="sxs-lookup"><span data-stu-id="fd775-321">A partner in a conversation called the [**DdeDisconnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddedisconnect) function, causing both partners to receive this transaction.</span></span>                                    |
| [<span data-ttu-id="fd775-322">**\_erreur XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-322">**XTYP\_ERROR**</span></span>](xtyp-error.md)                      | <span data-ttu-id="fd775-323">Client/serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-323">Client/Server</span></span>              | <span data-ttu-id="fd775-324">Une erreur critique s’est produite.</span><span class="sxs-lookup"><span data-stu-id="fd775-324">A critical error has occurred.</span></span> <span data-ttu-id="fd775-325">Le DDEML peut ne pas disposer de ressources suffisantes pour continuer.</span><span class="sxs-lookup"><span data-stu-id="fd775-325">The DDEML may not have sufficient resources to continue.</span></span>                                                                                       |
| [<span data-ttu-id="fd775-326">**exécution de XTYP \_**</span><span class="sxs-lookup"><span data-stu-id="fd775-326">**XTYP\_EXECUTE**</span></span>](xtyp-execute.md)                  | <span data-ttu-id="fd775-327">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-327">Server</span></span>                     | <span data-ttu-id="fd775-328">Un client a spécifié le type de transaction [**XTYP \_ Execute**](xtyp-execute.md) dans un appel à [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-328">A client specified the [**XTYP\_EXECUTE**](xtyp-execute.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>                              |
| [<span data-ttu-id="fd775-329">**\_moniteur XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-329">**XTYP\_MONITOR**</span></span>](xtyp-monitor.md)                  | <span data-ttu-id="fd775-330">Application de surveillance DDE</span><span class="sxs-lookup"><span data-stu-id="fd775-330">DDE monitoring application</span></span> | <span data-ttu-id="fd775-331">Un événement DDE s’est produit dans le système.</span><span class="sxs-lookup"><span data-stu-id="fd775-331">A DDE event occurred in the system.</span></span> <span data-ttu-id="fd775-332">Pour plus d’informations sur les applications d’analyse DDE, consultez [surveillance des applications](monitoring-applications.md).</span><span class="sxs-lookup"><span data-stu-id="fd775-332">For more information about DDE monitoring applications, see [Monitoring Applications](monitoring-applications.md).</span></span>                       |
| [<span data-ttu-id="fd775-333">**XTYP \_**</span><span class="sxs-lookup"><span data-stu-id="fd775-333">**XTYP\_POKE**</span></span>](xtyp-poke.md)                        | <span data-ttu-id="fd775-334">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-334">Server</span></span>                     | <span data-ttu-id="fd775-335">Un client a spécifié le type de transaction [**XTYPs \_**](xtyp-poke.md) dans un appel à [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-335">A client specified the [**XTYP\_POKE**](xtyp-poke.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>                                    |
| [<span data-ttu-id="fd775-336">**\_Registre XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-336">**XTYP\_REGISTER**</span></span>](xtyp-register.md)                | <span data-ttu-id="fd775-337">Client/serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-337">Client/Server</span></span>              | <span data-ttu-id="fd775-338">Une application serveur a utilisé la fonction [**DdeNameService**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) pour enregistrer un nom de service.</span><span class="sxs-lookup"><span data-stu-id="fd775-338">A server application used the [**DdeNameService**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) function to register a service name.</span></span>                                                                   |
| [<span data-ttu-id="fd775-339">**\_demande XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-339">**XTYP\_REQUEST**</span></span>](xtyp-request.md)                  | <span data-ttu-id="fd775-340">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-340">Server</span></span>                     | <span data-ttu-id="fd775-341">Un client a spécifié le type de transaction [**XTYP \_ Request**](xtyp-request.md) dans un appel à [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span><span class="sxs-lookup"><span data-stu-id="fd775-341">A client specified the [**XTYP\_REQUEST**](xtyp-request.md) transaction type in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).</span></span>                              |
| [<span data-ttu-id="fd775-342">**\_désinscription XTYP**</span><span class="sxs-lookup"><span data-stu-id="fd775-342">**XTYP\_UNREGISTER**</span></span>](xtyp-unregister.md)            | <span data-ttu-id="fd775-343">Client/serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-343">Client/Server</span></span>              | <span data-ttu-id="fd775-344">Une application serveur a utilisé [**DdeNameService**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) pour annuler l’inscription d’un nom de service.</span><span class="sxs-lookup"><span data-stu-id="fd775-344">A server application used [**DdeNameService**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) to unregister a service name.</span></span>                                                                              |
| [<span data-ttu-id="fd775-345">**XTYP \_ WILDCONNECT**</span><span class="sxs-lookup"><span data-stu-id="fd775-345">**XTYP\_WILDCONNECT**</span></span>](xtyp-wildconnect.md)          | <span data-ttu-id="fd775-346">Serveur</span><span class="sxs-lookup"><span data-stu-id="fd775-346">Server</span></span>                     | <span data-ttu-id="fd775-347">Un client A appelé la fonction [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) ou [**DdeConnectList**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnectlist) , en spécifiant la **valeur null** pour le nom du service, le nom de la rubrique, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="fd775-347">A client called the [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) or [**DdeConnectList**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnectlist) function, specifying **NULL** for the service name, the topic name, or both.</span></span> |
| [<span data-ttu-id="fd775-348">**XTYP \_ XACT \_ terminé**</span><span class="sxs-lookup"><span data-stu-id="fd775-348">**XTYP\_XACT\_COMPLETE**</span></span>](xtyp-xact-complete.md)     | <span data-ttu-id="fd775-349">Client</span><span class="sxs-lookup"><span data-stu-id="fd775-349">Client</span></span>                     | <span data-ttu-id="fd775-350">Une transaction asynchrone, envoyée lorsque le client a spécifié l' \_ indicateur Timeout Async dans un appel à [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction), s’est terminée.</span><span class="sxs-lookup"><span data-stu-id="fd775-350">An asynchronous transaction, sent when the client specified the TIMEOUT\_ASYNC flag in a call to [**DdeClientTransaction**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction), has concluded.</span></span>         |



 

 

