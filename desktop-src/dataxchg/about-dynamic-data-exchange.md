---
title: À propos de échange dynamique de données
description: Cette rubrique explique comment transférer des données entre des applications.
ms.assetid: 0bcd8de4-a6f0-4f2a-8b9d-0b1b638925fb
keywords:
- Échange dynamique de données (DDE), à propos de
- DDE (échange dynamique de données), à propos de
- échange de données, échange dynamique de données (DDE)
- Échange dynamique de données (DDE), liaison à des données en temps réel
- DDE (échange dynamique de données), liaison à des données en temps réel
- Échange dynamique de données (DDE), création de documents composés
- DDE (échange dynamique de données), création de documents composés
- Échange dynamique de données (DDE), requêtes de données
- DDE (échange dynamique de données), requêtes de données
- Échange dynamique de données (DDE), exemples
- DDE (échange dynamique de données), exemples
- Échange dynamique de données (DDE), emprunt d’identité
- DDE (échange dynamique de données), emprunt d’identité
- Échange dynamique de données (DDE), messages
- DDE (échange dynamique de données), messages
- Échange dynamique de données (DDE), atomes
- DDE (échange dynamique de données), atomes
- Échange dynamique de données (DDE), objets de mémoire partagée
- DDE (échange dynamique de données), objets de mémoire partagée
- Échange dynamique de données (DDE), fonctions de compression de paramètre
- DDE (échange dynamique de données), fonctions de compression des paramètres
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d38574e9182255e8f6761520aea60575d8affbc
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104382463"
---
# <a name="about-dynamic-data-exchange"></a><span data-ttu-id="98ae2-124">À propos de échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-124">About Dynamic Data Exchange</span></span>

<span data-ttu-id="98ae2-125">Windows fournit plusieurs méthodes pour transférer des données entre les applications.</span><span class="sxs-lookup"><span data-stu-id="98ae2-125">Windows provides several methods for transferring data between applications.</span></span> <span data-ttu-id="98ae2-126">Une méthode consiste à utiliser le protocole échange dynamique de données (DDE).</span><span class="sxs-lookup"><span data-stu-id="98ae2-126">One method is to use the Dynamic Data Exchange (DDE) protocol.</span></span> <span data-ttu-id="98ae2-127">Le protocole DDE est un ensemble de messages et d’instructions.</span><span class="sxs-lookup"><span data-stu-id="98ae2-127">The DDE protocol is a set of messages and guidelines.</span></span> <span data-ttu-id="98ae2-128">Elle envoie des messages entre les applications qui partagent des données et utilise la mémoire partagée pour échanger des données entre les applications.</span><span class="sxs-lookup"><span data-stu-id="98ae2-128">It sends messages between applications that share data and uses shared memory to exchange data between applications.</span></span> <span data-ttu-id="98ae2-129">Les applications peuvent utiliser le protocole DDE pour les transferts de données à usage unique et pour les échanges continus dans lesquels les applications envoient des mises à jour les unes aux autres au fur et à mesure que de nouvelles données deviennent disponibles.</span><span class="sxs-lookup"><span data-stu-id="98ae2-129">Applications can use the DDE protocol for one-time data transfers and for continuous exchanges in which applications send updates to one another as new data becomes available.</span></span>

<span data-ttu-id="98ae2-130">Windows prend également en charge la bibliothèque de gestion des échange dynamique de données (DDEML).</span><span class="sxs-lookup"><span data-stu-id="98ae2-130">Windows also supports the Dynamic Data Exchange Management Library (DDEML).</span></span> <span data-ttu-id="98ae2-131">DDEML est une bibliothèque de liens dynamiques (DLL) que les applications peuvent utiliser pour partager des données.</span><span class="sxs-lookup"><span data-stu-id="98ae2-131">The DDEML is a dynamic-link library (DLL) that applications can use to share data.</span></span> <span data-ttu-id="98ae2-132">DDEML fournit des fonctions et des messages qui simplifient la tâche d’ajout de la fonctionnalité DDE à une application.</span><span class="sxs-lookup"><span data-stu-id="98ae2-132">The DDEML provides functions and messages that simplify the task of adding DDE capability to an application.</span></span> <span data-ttu-id="98ae2-133">Au lieu d’envoyer, de publier et de traiter des messages DDE directement, une application utilise les fonctions DDEML pour gérer les conversations DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-133">Instead of sending, posting, and processing DDE messages directly, an application uses the DDEML functions to manage DDE conversations.</span></span> <span data-ttu-id="98ae2-134">(Une conversation DDE est l’interaction entre les applications client et serveur.)</span><span class="sxs-lookup"><span data-stu-id="98ae2-134">(A DDE conversation is the interaction between client and server applications.)</span></span>

<span data-ttu-id="98ae2-135">DDEML fournit également une fonctionnalité de gestion des chaînes et des données partagées par les applications DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-135">The DDEML also provides a facility for managing the strings and data that DDE applications share.</span></span> <span data-ttu-id="98ae2-136">Au lieu d’utiliser des atomes et des pointeurs vers des objets mémoire partagés, les applications DDE créent et échangent des handles de chaîne, qui identifient les chaînes et les handles de données qui identifient les objets mémoire.</span><span class="sxs-lookup"><span data-stu-id="98ae2-136">Instead of using atoms and pointers to shared memory objects, DDE applications create and exchange string handles, which identify strings, and data handles, which identify memory objects.</span></span> <span data-ttu-id="98ae2-137">Le DDEML permet également à une application serveur d’inscrire les noms de service qu’elle prend en charge.</span><span class="sxs-lookup"><span data-stu-id="98ae2-137">The DDEML also makes it possible for a server application to register the service names it supports.</span></span> <span data-ttu-id="98ae2-138">Les noms sont diffusés à d’autres applications dans le système, qui peuvent utiliser les noms pour se connecter au serveur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-138">The names are broadcast to other applications in the system, which can use the names to connect to the server.</span></span> <span data-ttu-id="98ae2-139">En outre, le DDEML garantit la compatibilité entre les applications DDE en les forçant à implémenter le protocole DDE de manière cohérente.</span><span class="sxs-lookup"><span data-stu-id="98ae2-139">Moreover, the DDEML ensures compatibility among DDE applications by forcing them to implement the DDE protocol in a consistent manner.</span></span>

<span data-ttu-id="98ae2-140">Les applications existantes qui utilisent le protocole DDE basé sur des messages sont entièrement compatibles avec celles qui utilisent DDEML.</span><span class="sxs-lookup"><span data-stu-id="98ae2-140">Existing applications that use the message-based DDE protocol are fully compatible with those that use the DDEML.</span></span> <span data-ttu-id="98ae2-141">Autrement dit, une application qui utilise une liaison DDE basée sur des messages peut établir des conversations et exécuter des transactions avec des applications qui utilisent DDEML.</span><span class="sxs-lookup"><span data-stu-id="98ae2-141">That is, an application that uses message-based DDE can establish conversations and perform transactions with applications that use the DDEML.</span></span> <span data-ttu-id="98ae2-142">En raison des nombreux avantages du DDEML, les nouvelles applications doivent l’utiliser plutôt que les messages DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-142">Because of the many advantages of the DDEML, new applications should use it rather than the DDE messages.</span></span> <span data-ttu-id="98ae2-143">Pour utiliser les éléments de l’API de DDEML, vous devez inclure le fichier d’en-tête DDEML dans vos fichiers sources, établir une liaison avec la bibliothèque DDEML et vérifier que la bibliothèque de liens dynamiques DDEML se trouve dans le chemin de recherche du système.</span><span class="sxs-lookup"><span data-stu-id="98ae2-143">To use the API elements of the DDEML, you must include the DDEML header file in your source files, link with the DDEML library, and ensure that the DDEML dynamic-link library is in the system's search path.</span></span>

<span data-ttu-id="98ae2-144">Les rubriques suivantes sont présentées dans cette section.</span><span class="sxs-lookup"><span data-stu-id="98ae2-144">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="98ae2-145">Protocole échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-145">Dynamic Data Exchange Protocol</span></span>](#dynamic-data-exchange-protocol)
-   [<span data-ttu-id="98ae2-146">Utilisations de Windows échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-146">Uses for Windows Dynamic Data Exchange</span></span>](#uses-for-windows-dynamic-data-exchange)
-   [<span data-ttu-id="98ae2-147">Échange dynamique de données du point de vue de l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="98ae2-147">Dynamic Data Exchange from the User's Point of View</span></span>](#dynamic-data-exchange-from-the-users-point-of-view)
-   [<span data-ttu-id="98ae2-148">Concepts de échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-148">Dynamic Data Exchange Concepts</span></span>](#dynamic-data-exchange-concepts)
    -   [<span data-ttu-id="98ae2-149">Client, serveur et conversation</span><span class="sxs-lookup"><span data-stu-id="98ae2-149">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
    -   [<span data-ttu-id="98ae2-150">Noms d’application, de rubrique et d’élément</span><span class="sxs-lookup"><span data-stu-id="98ae2-150">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
    -   [<span data-ttu-id="98ae2-151">Rubrique système</span><span class="sxs-lookup"><span data-stu-id="98ae2-151">The System Topic</span></span>](#the-system-topic)
    -   [<span data-ttu-id="98ae2-152">Liaisons de données permanentes</span><span class="sxs-lookup"><span data-stu-id="98ae2-152">Permanent Data Links</span></span>](#permanent-data-links)
    -   [<span data-ttu-id="98ae2-153">Atomes et objets de mémoire partagée</span><span class="sxs-lookup"><span data-stu-id="98ae2-153">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)
-   [<span data-ttu-id="98ae2-154">Présentation des messages échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-154">Dynamic Data Exchange Messages Overview</span></span>](#dynamic-data-exchange-messages-overview)
-   [<span data-ttu-id="98ae2-155">échange dynamique de données le workflow du message</span><span class="sxs-lookup"><span data-stu-id="98ae2-155">Dynamic Data Exchange Message Flow</span></span>](#dynamic-data-exchange-message-flow)
-   [<span data-ttu-id="98ae2-156">Fonctions de compression des paramètres</span><span class="sxs-lookup"><span data-stu-id="98ae2-156">Parameter Packing Functions</span></span>](#parameter-packing-functions)
-   [<span data-ttu-id="98ae2-157">échange dynamique de données et emprunt d’identité</span><span class="sxs-lookup"><span data-stu-id="98ae2-157">Dynamic Data Exchange and Impersonation</span></span>](#dynamic-data-exchange-and-impersonation)

## <a name="dynamic-data-exchange-protocol"></a><span data-ttu-id="98ae2-158">Protocole échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-158">Dynamic Data Exchange Protocol</span></span>

<span data-ttu-id="98ae2-159">Étant donné que Windows dispose d’une architecture basée sur les messages, le passage de messages est la méthode la plus appropriée pour transférer automatiquement les informations entre les applications.</span><span class="sxs-lookup"><span data-stu-id="98ae2-159">Because Windows has a message-based architecture, passing messages is the most appropriate method for automatically transferring information between applications.</span></span> <span data-ttu-id="98ae2-160">Toutefois, les messages contiennent uniquement deux paramètres (*wParam* et *lParam*) pour le passage de données.</span><span class="sxs-lookup"><span data-stu-id="98ae2-160">However, messages contain only two parameters (*wParam* and *lParam*) for passing data.</span></span> <span data-ttu-id="98ae2-161">Par conséquent, ces paramètres doivent faire référence indirectement à d’autres éléments de données lorsque plusieurs mots d’informations transitent entre les applications.</span><span class="sxs-lookup"><span data-stu-id="98ae2-161">As a result, these parameters must refer indirectly to other pieces of data when more than a few words of information pass between applications.</span></span> <span data-ttu-id="98ae2-162">Le protocole DDE définit exactement comment les applications doivent utiliser les paramètres *wParam* et *lParam* pour transmettre des éléments de données plus volumineux au moyen d’atomes globaux et de handles de mémoire partagée.</span><span class="sxs-lookup"><span data-stu-id="98ae2-162">The DDE protocol defines exactly how applications should use the *wParam* and *lParam* parameters to pass larger pieces of data by means of global atoms and shared memory handles.</span></span> <span data-ttu-id="98ae2-163">Le protocole DDE contient des règles spécifiques pour l’allocation et la suppression des atomes globaux et des objets de mémoire partagée.</span><span class="sxs-lookup"><span data-stu-id="98ae2-163">The DDE protocol has specific rules for allocating and deleting global atoms and shared memory objects.</span></span>

<span data-ttu-id="98ae2-164">Un atome global est une référence à une chaîne de caractères.</span><span class="sxs-lookup"><span data-stu-id="98ae2-164">A global atom is a reference to a character string.</span></span> <span data-ttu-id="98ae2-165">Dans le protocole DDE, les atomes identifient les applications qui échangent des données, la nature des données échangées et les éléments de données eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="98ae2-165">In the DDE protocol, atoms identify the applications exchanging data, the nature of the data being exchanged, and the data items themselves.</span></span> <span data-ttu-id="98ae2-166">Pour plus d’informations sur les atomes, consultez [à propos des atomes](about-atom-tables.md).</span><span class="sxs-lookup"><span data-stu-id="98ae2-166">For more information about atoms, see [About Atoms](about-atom-tables.md).</span></span>

## <a name="uses-for-windows-dynamic-data-exchange"></a><span data-ttu-id="98ae2-167">Utilisations de Windows échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-167">Uses for Windows Dynamic Data Exchange</span></span>

<span data-ttu-id="98ae2-168">DDE est plus approprié pour les échanges de données qui ne nécessitent pas d’intervention de l’utilisateur en cours.</span><span class="sxs-lookup"><span data-stu-id="98ae2-168">DDE is most appropriate for data exchanges that do not require ongoing user interaction.</span></span> <span data-ttu-id="98ae2-169">En règle générale, une application fournit une méthode permettant à l’utilisateur d’établir le lien entre les applications qui échangent des données.</span><span class="sxs-lookup"><span data-stu-id="98ae2-169">Usually, an application provides a method for the user to establish the link between the applications exchanging data.</span></span> <span data-ttu-id="98ae2-170">Toutefois, une fois que ce lien est établi, les applications échangent des données sans intervention supplémentaire de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-170">Once that link is established, however, the applications exchange data without further user involvement.</span></span>

<span data-ttu-id="98ae2-171">DDE peut être utilisé pour implémenter un large éventail de fonctionnalités d’application, par exemple :</span><span class="sxs-lookup"><span data-stu-id="98ae2-171">DDE can be used to implement a broad range of application features — for example:</span></span>

-   <span data-ttu-id="98ae2-172">Liaison à des données en temps réel, telles que la cotation des mises à jour du marché, les instruments scientifiques ou le contrôle de processus.</span><span class="sxs-lookup"><span data-stu-id="98ae2-172">Linking to real-time data, such as to stock market updates, scientific instruments, or process control.</span></span>
-   <span data-ttu-id="98ae2-173">Création de documents composés, tels qu’un document de traitement de texte qui comprend un graphique produit par une application graphique.</span><span class="sxs-lookup"><span data-stu-id="98ae2-173">Creating compound documents, such as a word processing document that includes a chart produced by a graphics application.</span></span> <span data-ttu-id="98ae2-174">À l’aide de DDE, le graphique change lorsque les données sources sont modifiées, tandis que le reste du document reste le même.</span><span class="sxs-lookup"><span data-stu-id="98ae2-174">Using DDE, the chart will change when the source data is changed, while the rest of the document remains the same.</span></span>
-   <span data-ttu-id="98ae2-175">Exécution de requêtes de données entre des applications, par exemple une feuille de calcul interrogeant une base de données pour les comptes en retard.</span><span class="sxs-lookup"><span data-stu-id="98ae2-175">Performing data queries between applications, such as a spreadsheet querying a database for accounts past due.</span></span>

## <a name="dynamic-data-exchange-from-the-users-point-of-view"></a><span data-ttu-id="98ae2-176">Échange dynamique de données du point de vue de l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="98ae2-176">Dynamic Data Exchange from the User's Point of View</span></span>

<span data-ttu-id="98ae2-177">L’exemple suivant illustre la façon dont deux applications DDE peuvent coopérer, comme le montre le point de vue de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-177">The following example illustrates how two DDE applications can cooperate, as seen from the user's point of view.</span></span>

<span data-ttu-id="98ae2-178">Un utilisateur de feuille de calcul souhaite utiliser Microsoft Excel pour suivre le prix d’une action spécifique sur la bourse de New York.</span><span class="sxs-lookup"><span data-stu-id="98ae2-178">A spreadsheet user wants to use Microsoft Excel to track the price of a particular stock on the New York Stock Exchange.</span></span> <span data-ttu-id="98ae2-179">L’utilisateur dispose d’une application appelée quote qui, à son tour, a accès aux données du NYSE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-179">The user has an application called Quote that in turn has access to NYSE data.</span></span> <span data-ttu-id="98ae2-180">La conversation DDE entre Excel et le devis s’effectue comme suit :</span><span class="sxs-lookup"><span data-stu-id="98ae2-180">The DDE conversation between Excel and Quote takes place as follows:</span></span>

-   <span data-ttu-id="98ae2-181">L’utilisateur lance la conversation en fournissant le nom de l’application (devis) qui fournira les données et la rubrique d’intérêt (NYSE) particulière.</span><span class="sxs-lookup"><span data-stu-id="98ae2-181">The user initiates the conversation by supplying the name of the application (Quote) that will supply the data and the particular topic of interest (NYSE).</span></span> <span data-ttu-id="98ae2-182">La conversation DDE qui en résulte est utilisée pour demander des devis sur des actions spécifiques.</span><span class="sxs-lookup"><span data-stu-id="98ae2-182">The resulting DDE conversation is used to request quotes on specific stocks.</span></span>
-   <span data-ttu-id="98ae2-183">Excel diffuse les noms d’application et de rubrique dans toutes les applications DDE en cours d’exécution dans le système.</span><span class="sxs-lookup"><span data-stu-id="98ae2-183">Excel broadcasts the application and topic names to all DDE applications currently running in the system.</span></span> <span data-ttu-id="98ae2-184">Quote répond, établissant une conversation avec Excel sur la rubrique NYSE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-184">Quote responds, establishing a conversation with Excel about the NYSE topic.</span></span>
-   <span data-ttu-id="98ae2-185">L’utilisateur peut ensuite créer une formule de feuille de calcul dans une cellule qui demande que la feuille de calcul soit automatiquement mise à jour à chaque fois qu’une cotation boursière particulière change.</span><span class="sxs-lookup"><span data-stu-id="98ae2-185">The user can then create a spreadsheet formula in a cell that requests that the spreadsheet be automatically updated whenever a particular stock quotation changes.</span></span> <span data-ttu-id="98ae2-186">Par exemple, l’utilisateur peut demander une mise à jour automatique chaque fois qu’une modification intervient dans le prix de vente de ZAXX stock en spécifiant la formule Excel suivante : = 'quote' \| 'NYSE' ! ZAXX</span><span class="sxs-lookup"><span data-stu-id="98ae2-186">For example, the user could request an automatic update whenever a change occurs in the selling price of ZAXX stock by specifying the following Excel formula: ='Quote'\|'NYSE'!ZAXX</span></span>
-   <span data-ttu-id="98ae2-187">L’utilisateur peut mettre fin à la mise à jour automatique de la cotation boursière ZAXX à tout moment.</span><span class="sxs-lookup"><span data-stu-id="98ae2-187">The user can terminate the automatic updating of the ZAXX stock quotation at any time.</span></span> <span data-ttu-id="98ae2-188">Les autres liaisons de données qui ont été établies séparément (par exemple, pour les devis d’autres stocks) resteront actives au cours de la même conversation NYSE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-188">Other data links that were established separately (such as for quotations for other stocks) still will remain active under the same NYSE conversation.</span></span>
-   <span data-ttu-id="98ae2-189">L’utilisateur peut également mettre fin à la conversation entière entre Excel et quote sur la rubrique NYSE, afin qu’aucun lien de données spécifique sur cette rubrique ne puisse être établi sans lancer de nouvelle conversation.</span><span class="sxs-lookup"><span data-stu-id="98ae2-189">The user can also terminate the entire conversation between Excel and Quote on the NYSE topic, so that no specific data links on that topic can be established without initiating a new conversation.</span></span>

## <a name="dynamic-data-exchange-concepts"></a><span data-ttu-id="98ae2-190">Concepts de échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-190">Dynamic Data Exchange Concepts</span></span>

<span data-ttu-id="98ae2-191">Les sections suivantes expliquent les concepts et la terminologie importants qui sont essentiels pour comprendre l’échange dynamique de données.</span><span class="sxs-lookup"><span data-stu-id="98ae2-191">The following sections explain the important concepts and terminology that are key to understanding dynamic data exchange.</span></span>

-   [<span data-ttu-id="98ae2-192">Client, serveur et conversation</span><span class="sxs-lookup"><span data-stu-id="98ae2-192">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
-   [<span data-ttu-id="98ae2-193">Noms d’application, de rubrique et d’élément</span><span class="sxs-lookup"><span data-stu-id="98ae2-193">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
-   [<span data-ttu-id="98ae2-194">Rubrique système</span><span class="sxs-lookup"><span data-stu-id="98ae2-194">The System Topic</span></span>](#the-system-topic)
-   [<span data-ttu-id="98ae2-195">Liaisons de données permanentes</span><span class="sxs-lookup"><span data-stu-id="98ae2-195">Permanent Data Links</span></span>](#permanent-data-links)
-   [<span data-ttu-id="98ae2-196">Atomes et objets de mémoire partagée</span><span class="sxs-lookup"><span data-stu-id="98ae2-196">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)

### <a name="client-server-and-conversation"></a><span data-ttu-id="98ae2-197">Client, serveur et conversation</span><span class="sxs-lookup"><span data-stu-id="98ae2-197">Client, Server, and Conversation</span></span>

<span data-ttu-id="98ae2-198">Deux applications qui participent à DDE sont dites engagées dans une conversation DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-198">Two applications participating in DDE are said to be engaged in a DDE conversation.</span></span> <span data-ttu-id="98ae2-199">L’application qui initie la conversation est l’application cliente DDE. l’application qui répond au client est l’application de serveur DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-199">The application that initiates the conversation is the DDE client application; the application that responds to the client is the DDE server application.</span></span> <span data-ttu-id="98ae2-200">Une application peut intervenir dans plusieurs conversations en même temps, en agissant en tant que client dans certains et en tant que serveur dans d’autres.</span><span class="sxs-lookup"><span data-stu-id="98ae2-200">An application can engage in several conversations at the same time, acting as the client in some and as the server in others.</span></span>

<span data-ttu-id="98ae2-201">Une conversation DDE est effectuée entre deux fenêtres, une pour chacune des applications participantes.</span><span class="sxs-lookup"><span data-stu-id="98ae2-201">A DDE conversation takes place between two windows, one for each of the participating applications.</span></span> <span data-ttu-id="98ae2-202">Une fenêtre peut être la fenêtre principale de l’application. fenêtre associée à un document spécifique, comme dans une application d’interface multidocument (MDI, multiple-document interface); ou une fenêtre masquée (invisible) dont l’objectif est de traiter les messages DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-202">A window may be the main window of the application; a window associated with a specific document, as in a multiple-document interface (MDI) application; or a hidden (invisible) window whose only purpose is to process DDE messages.</span></span>

<span data-ttu-id="98ae2-203">Étant donné qu’une conversation DDE est identifiée par la paire de handles de la Windows engagée dans la conversation, aucune fenêtre ne doit être engagée dans plusieurs conversations avec une autre fenêtre.</span><span class="sxs-lookup"><span data-stu-id="98ae2-203">Since a DDE conversation is identified by the pair of handles to the windows engaged in the conversation, no window should be engaged in more than one conversation with another window.</span></span> <span data-ttu-id="98ae2-204">L’application cliente ou l’application serveur doit fournir une fenêtre différente pour chacune de ses conversations avec un serveur ou une application cliente spécifique.</span><span class="sxs-lookup"><span data-stu-id="98ae2-204">Either the client application or the server application must provide a different window for each of its conversations with a particular server or client application.</span></span>

<span data-ttu-id="98ae2-205">Une application peut s’assurer qu’une paire de fenêtres client et serveur n’est jamais impliquée dans plusieurs conversations en créant une fenêtre cachée pour chaque conversation.</span><span class="sxs-lookup"><span data-stu-id="98ae2-205">An application can ensure a pair of client and server windows is never involved in more than one conversation by creating a hidden window for each conversation.</span></span> <span data-ttu-id="98ae2-206">Le seul objectif de cette fenêtre est de traiter les messages DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-206">The sole purpose of this window is to process DDE messages.</span></span>

### <a name="application-topic-and-item-names"></a><span data-ttu-id="98ae2-207">Noms d’application, de rubrique et d’élément</span><span class="sxs-lookup"><span data-stu-id="98ae2-207">Application, Topic, and Item Names</span></span>

<span data-ttu-id="98ae2-208">Le protocole DDE identifie les unités de données passées entre le client et le serveur avec une hiérarchie à trois niveaux de noms d’application, de rubrique et d’élément.</span><span class="sxs-lookup"><span data-stu-id="98ae2-208">The DDE protocol identifies the units of data passed between the client and server with a three-level hierarchy of application, topic, and item names.</span></span>

<span data-ttu-id="98ae2-209">Chaque conversation DDE est définie de façon unique par le nom et la rubrique de l’application.</span><span class="sxs-lookup"><span data-stu-id="98ae2-209">Each DDE conversation is uniquely defined by the application name and topic.</span></span> <span data-ttu-id="98ae2-210">Au début d’une conversation DDE, le client et le serveur déterminent le nom et la rubrique de l’application.</span><span class="sxs-lookup"><span data-stu-id="98ae2-210">At the beginning of a DDE conversation, the client and server determine the application name and topic.</span></span> <span data-ttu-id="98ae2-211">Le nom de l’application est généralement le nom de l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-211">The application name is usually the name of the server application.</span></span> <span data-ttu-id="98ae2-212">Par exemple, lorsqu’Excel agit en tant que serveur dans une conversation, le nom de l’application est Excel.</span><span class="sxs-lookup"><span data-stu-id="98ae2-212">For example, when Excel acts as the server in a conversation, the application name is Excel.</span></span>

<span data-ttu-id="98ae2-213">La rubrique DDE est une classification générale des données dans laquelle plusieurs éléments de données peuvent être « discutés » (échangés) au cours de la conversation.</span><span class="sxs-lookup"><span data-stu-id="98ae2-213">The DDE topic is a general classification of data within which multiple data items may be "discussed" (exchanged) during the conversation.</span></span> <span data-ttu-id="98ae2-214">Pour les applications qui opèrent sur des documents basés sur des fichiers, la rubrique est généralement un nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="98ae2-214">For applications that operate on file-based documents, the topic is usually a filename.</span></span> <span data-ttu-id="98ae2-215">Pour les autres applications, la rubrique est un nom propre à l’application.</span><span class="sxs-lookup"><span data-stu-id="98ae2-215">For other applications, the topic is an application-specific name.</span></span>

<span data-ttu-id="98ae2-216">Étant donné que les handles de fenêtre du client et du serveur identifient ensemble une conversation DDE, le nom et la rubrique de l’application qui définissent une conversation ne peuvent pas être modifiés au cours de la conversation.</span><span class="sxs-lookup"><span data-stu-id="98ae2-216">Because the client and server window handles together identify a DDE conversation, the application name and topic that define a conversation cannot be changed during the course of the conversation.</span></span>

<span data-ttu-id="98ae2-217">Un élément de données DDE est des informations relatives à la rubrique de conversation échangée entre les applications.</span><span class="sxs-lookup"><span data-stu-id="98ae2-217">A DDE data item is information related to the conversation topic exchanged between the applications.</span></span> <span data-ttu-id="98ae2-218">Les valeurs de l’élément de données peuvent être transmises du serveur au client ou du client au serveur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-218">Values for the data item can be passed from the server to the client, or from the client to the server.</span></span> <span data-ttu-id="98ae2-219">Les données peuvent être passées avec l’un des formats de presse-papiers standard ou avec un format de presse-papiers inscrit.</span><span class="sxs-lookup"><span data-stu-id="98ae2-219">Data can be passed with any of the standard clipboard formats or with a registered clipboard format.</span></span> <span data-ttu-id="98ae2-220">Un format spécial enregistré nommé Link identifie un élément dans une conversation DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-220">A special, registered format named Link identifies an item in a DDE conversation.</span></span> <span data-ttu-id="98ae2-221">Pour plus d’informations sur les formats de presse-papiers, consultez [presse-papiers](clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="98ae2-221">For more information about clipboard formats, see [Clipboard](clipboard.md).</span></span>

### <a name="the-system-topic"></a><span data-ttu-id="98ae2-222">Rubrique système</span><span class="sxs-lookup"><span data-stu-id="98ae2-222">The System Topic</span></span>

<span data-ttu-id="98ae2-223">Les applications doivent prendre en charge la rubrique système à tout moment.</span><span class="sxs-lookup"><span data-stu-id="98ae2-223">Applications should support the system topic at all times.</span></span> <span data-ttu-id="98ae2-224">Cette rubrique fournit un contexte pour les informations qui peuvent présenter un intérêt général pour une autre application.</span><span class="sxs-lookup"><span data-stu-id="98ae2-224">This topic provides a context for information that may be of general interest to another application.</span></span>

<span data-ttu-id="98ae2-225">Les valeurs des éléments de données doivent être rendues dans le format de presse-papiers de [**\_ texte CF**](standard-clipboard-formats.md) .</span><span class="sxs-lookup"><span data-stu-id="98ae2-225">Data-item values must be rendered in the [**CF\_TEXT**](standard-clipboard-formats.md) clipboard format.</span></span> <span data-ttu-id="98ae2-226">Les éléments individuels des valeurs d’éléments d’une rubrique système doivent être délimités par des caractères de tabulation.</span><span class="sxs-lookup"><span data-stu-id="98ae2-226">Individual elements of item values for a system topic must be delimited by tab characters.</span></span> <span data-ttu-id="98ae2-227">Le tableau suivant suggère quelques éléments pour la rubrique système.</span><span class="sxs-lookup"><span data-stu-id="98ae2-227">The following table suggests some items for the system topic.</span></span>



| <span data-ttu-id="98ae2-228">Élément</span><span class="sxs-lookup"><span data-stu-id="98ae2-228">Item</span></span>          | <span data-ttu-id="98ae2-229">Description</span><span class="sxs-lookup"><span data-stu-id="98ae2-229">Description</span></span>                                                                                                                                                                                                                                                                                             |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="98ae2-230">Formats</span><span class="sxs-lookup"><span data-stu-id="98ae2-230">Formats</span></span>       | <span data-ttu-id="98ae2-231">Liste de formats de presse-papiers, délimités par des tabulations, que l’application peut restituer.</span><span class="sxs-lookup"><span data-stu-id="98ae2-231">Tab-delimited list of clipboard formats the application can render.</span></span> <span data-ttu-id="98ae2-232">En règle générale, les formats **CF \_** sont répertoriés avec la partie «**CF \_**» des noms supprimés (par exemple, le **\_ texte CF** est répertorié comme «**texte**»).</span><span class="sxs-lookup"><span data-stu-id="98ae2-232">Typically, **CF\_** formats are listed with the "**CF\_**" portion of the names removed (for example, **CF\_TEXT** is listed as "**TEXT**").</span></span>                                                                                        |
| <span data-ttu-id="98ae2-233">Aide</span><span class="sxs-lookup"><span data-stu-id="98ae2-233">Help</span></span>          | <span data-ttu-id="98ae2-234">Texte qui explique brièvement comment utiliser le serveur DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-234">Text that briefly explains how to use the DDE server.</span></span>                                                                                                                                                                                                                                                   |
| <span data-ttu-id="98ae2-235">ReturnMessage</span><span class="sxs-lookup"><span data-stu-id="98ae2-235">ReturnMessage</span></span> | <span data-ttu-id="98ae2-236">Détails de la prise en charge du message d’accusé de réception [**\_ DDE DDE \_**](wm-dde-ack.md) récemment utilisé.</span><span class="sxs-lookup"><span data-stu-id="98ae2-236">Supporting detail for the most recently used [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span> <span data-ttu-id="98ae2-237">Cet élément est utile lorsque plus de huit bits de données de retour spécifiques à l’application sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="98ae2-237">This item is useful when more than eight bits of application-specific return data are required.</span></span>                                                                                                                |
| <span data-ttu-id="98ae2-238">Statut</span><span class="sxs-lookup"><span data-stu-id="98ae2-238">Status</span></span>        | <span data-ttu-id="98ae2-239">Indication de l’état actuel de l’application.</span><span class="sxs-lookup"><span data-stu-id="98ae2-239">Indication of the current status of the application.</span></span> <span data-ttu-id="98ae2-240">Lorsqu’un serveur reçoit un message de [**\_ \_ demande DDE WM**](wm-dde-request.md) pour cet élément de rubrique système, il doit répondre en publiant un message de [**données ( \_ DDE \_ ) WM**](wm-dde-data.md) avec une chaîne contenant soit Busy, soit Ready, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="98ae2-240">When a server receives a [**WM\_DDE\_REQUEST**](wm-dde-request.md) message for this system-topic item, it should respond by posting a [**WM\_DDE\_DATA**](wm-dde-data.md) message with a string containing either Busy or Ready, as appropriate.</span></span> |
| <span data-ttu-id="98ae2-241">SysItems</span><span class="sxs-lookup"><span data-stu-id="98ae2-241">SysItems</span></span>      | <span data-ttu-id="98ae2-242">Liste des éléments de rubrique système pris en charge par l’application.</span><span class="sxs-lookup"><span data-stu-id="98ae2-242">List of system-topic items the application supports.</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="98ae2-243">TopicItemList</span><span class="sxs-lookup"><span data-stu-id="98ae2-243">TopicItemList</span></span> | <span data-ttu-id="98ae2-244">Semblable à l’élément SysItems, à ceci près que TopicItemList doit être pris en charge pour chaque rubrique autre que la rubrique System.</span><span class="sxs-lookup"><span data-stu-id="98ae2-244">Similar to the SysItems item, except that TopicItemList should be supported for each topic other than the system topic.</span></span> <span data-ttu-id="98ae2-245">Cela permet de parcourir les éléments pris en charge sous n’importe quelle rubrique.</span><span class="sxs-lookup"><span data-stu-id="98ae2-245">This allows browsing of the items supported under any topic.</span></span> <span data-ttu-id="98ae2-246">Si les éléments ne peuvent pas être énumérés, cet élément doit contenir uniquement « TopicItemList ».</span><span class="sxs-lookup"><span data-stu-id="98ae2-246">If the items cannot be enumerated, this item should contain only "TopicItemList".</span></span>                                  |
| <span data-ttu-id="98ae2-247">Rubriques</span><span class="sxs-lookup"><span data-stu-id="98ae2-247">Topics</span></span>        | <span data-ttu-id="98ae2-248">Liste des rubriques prises en charge par l’application à l’heure actuelle ; Cette liste peut varier d’un moment à l’autres.</span><span class="sxs-lookup"><span data-stu-id="98ae2-248">List of topics the application supports at the current time; this list can vary from moment to moment.</span></span>                                                                                                                                                                                                  |



 

### <a name="permanent-data-links"></a><span data-ttu-id="98ae2-249">Liaisons de données permanentes</span><span class="sxs-lookup"><span data-stu-id="98ae2-249">Permanent Data Links</span></span>

<span data-ttu-id="98ae2-250">Une fois qu’une conversation DDE a commencé, le client peut établir une ou plusieurs liaisons de données permanentes avec le serveur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-250">Once a DDE conversation has begun, the client can establish one or more permanent data links with the server.</span></span> <span data-ttu-id="98ae2-251">Une liaison de données est un mécanisme de communication par lequel le serveur notifie le client chaque fois que la valeur d’un élément de données spécifié change.</span><span class="sxs-lookup"><span data-stu-id="98ae2-251">A data link is a communications mechanism by which the server notifies the client whenever the value of a specified data item changes.</span></span> <span data-ttu-id="98ae2-252">La liaison de données est permanente dans le sens où ce processus de notification se poursuit jusqu’à ce que la liaison de données ou la conversation DDE proprement dite soit terminée.</span><span class="sxs-lookup"><span data-stu-id="98ae2-252">The data link is permanent in the sense that this notification process continues until the data link or the DDE conversation itself is terminated.</span></span>

<span data-ttu-id="98ae2-253">Il existe deux types de liaisons de données DDE permanentes : chaud et chaud.</span><span class="sxs-lookup"><span data-stu-id="98ae2-253">There are two kinds of permanent DDE data links: warm and hot.</span></span> <span data-ttu-id="98ae2-254">Dans le cas d’une liaison de données à chaud, le serveur informe le client que la valeur de l’élément de données a changé, mais que le serveur n’envoie pas la valeur de données au client tant que le client ne l’a pas demandé.</span><span class="sxs-lookup"><span data-stu-id="98ae2-254">In a warm data link, the server notifies the client that the value of the data item has changed, but the server does not send the data value to the client until the client requests it.</span></span> <span data-ttu-id="98ae2-255">Dans un lien de données réactif, le serveur envoie immédiatement la valeur de données modifiée au client.</span><span class="sxs-lookup"><span data-stu-id="98ae2-255">In a hot data link, the server immediately sends the changed data value to the client.</span></span>

<span data-ttu-id="98ae2-256">Les applications qui prennent en charge les liaisons de données chaudes ou chaudes fournissent généralement une commande **copier** ou **coller le lien** dans le menu **Edition** pour permettre à l’utilisateur d’établir des liens entre les applications.</span><span class="sxs-lookup"><span data-stu-id="98ae2-256">Applications that support warm or hot data links typically provide a **Copy** or **Paste Link** command in their **Edit** menu to enable the user to establish links between applications.</span></span>

### <a name="atoms-and-shared-memory-objects"></a><span data-ttu-id="98ae2-257">Atomes et objets de mémoire partagée</span><span class="sxs-lookup"><span data-stu-id="98ae2-257">Atoms and Shared Memory Objects</span></span>

<span data-ttu-id="98ae2-258">Certains arguments des messages DDE sont des atomes globaux ou des objets de mémoire partagée.</span><span class="sxs-lookup"><span data-stu-id="98ae2-258">Certain arguments of DDE messages are global atoms or shared memory objects.</span></span> <span data-ttu-id="98ae2-259">Les applications qui utilisent ces arguments doivent suivre des règles explicites sur le moment où les allouer et les supprimer.</span><span class="sxs-lookup"><span data-stu-id="98ae2-259">Applications using these arguments must follow explicit rules about when to allocate and delete them.</span></span> <span data-ttu-id="98ae2-260">Dans tous les cas, l’expéditeur du message doit supprimer tout objet Atom ou mémoire partagée que le destinataire prévu ne recevra pas en raison d’une condition d’erreur, telle que l’échec de la fonction [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea) .</span><span class="sxs-lookup"><span data-stu-id="98ae2-260">In all cases, the message sender must delete any atom or shared memory object that the intended receiver will not receive because of an error condition, such as failure of the [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea) function.</span></span>

<span data-ttu-id="98ae2-261">DDE utilise les objets de mémoire partagée pour trois raisons :</span><span class="sxs-lookup"><span data-stu-id="98ae2-261">DDE uses shared memory objects for three purposes:</span></span>

-   <span data-ttu-id="98ae2-262">Pour transporter une valeur d’élément de données à échanger.</span><span class="sxs-lookup"><span data-stu-id="98ae2-262">To carry a data-item value to be exchanged.</span></span> <span data-ttu-id="98ae2-263">Il s’agit d’un élément référencé par le paramètre *hdata* dans les messages de données de l' [**échange de \_ \_ données (DDE) WM**](wm-dde-data.md) et de messages d’aide au protocole [**WM \_ DDE \_**](wm-dde-poke.md) .</span><span class="sxs-lookup"><span data-stu-id="98ae2-263">This is an item referenced by the *hData* parameter in the [**WM\_DDE\_DATA**](wm-dde-data.md) and [**WM\_DDE\_POKE**](wm-dde-poke.md) messages.</span></span>
-   <span data-ttu-id="98ae2-264">Pour transporter des options dans un message.</span><span class="sxs-lookup"><span data-stu-id="98ae2-264">To carry options in a message.</span></span> <span data-ttu-id="98ae2-265">Il s’agit d’un élément référencé par le paramètre *hOptions* dans un message d' [**\_ \_ avis DDE**](wm-dde-advise.md) .</span><span class="sxs-lookup"><span data-stu-id="98ae2-265">This is an item referenced by the *hOptions* parameter in a [**WM\_DDE\_ADVISE**](wm-dde-advise.md) message.</span></span>
-   <span data-ttu-id="98ae2-266">Pour transporter une chaîne d’exécution de commande.</span><span class="sxs-lookup"><span data-stu-id="98ae2-266">To carry a command execution string.</span></span> <span data-ttu-id="98ae2-267">Il s’agit d’un élément référencé par le paramètre *hCommands* dans le message d' [**\_ \_ exécution DDE de WM**](wm-dde-execute.md) et son message d' [**\_ \_ accusé**](wm-dde-ack.md) de réception DDE correspondant.</span><span class="sxs-lookup"><span data-stu-id="98ae2-267">This is an item referenced by the *hCommands* parameter in the [**WM\_DDE\_EXECUTE**](wm-dde-execute.md) message and its corresponding [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span>

<span data-ttu-id="98ae2-268">Une application qui reçoit un objet de mémoire partagée DDE doit la considérer comme étant en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="98ae2-268">An application that receives a DDE shared memory object must treat it as read only.</span></span> <span data-ttu-id="98ae2-269">L’application ne doit pas utiliser l’objet comme zone de lecture-écriture mutuelle pour l’échange de données gratuit.</span><span class="sxs-lookup"><span data-stu-id="98ae2-269">The application must not use the object as a mutual read-write area for the free exchange of data.</span></span>

<span data-ttu-id="98ae2-270">Comme c’est le cas avec un atome DDE, une application doit libérer un objet mémoire partagé pour gérer efficacement la mémoire.</span><span class="sxs-lookup"><span data-stu-id="98ae2-270">As it does with a DDE atom, an application should free a shared memory object to manage memory effectively.</span></span> <span data-ttu-id="98ae2-271">L’application doit également verrouiller et déverrouiller des objets mémoire.</span><span class="sxs-lookup"><span data-stu-id="98ae2-271">The application should also lock and unlock memory objects.</span></span>

## <a name="dynamic-data-exchange-messages-overview"></a><span data-ttu-id="98ae2-272">Présentation des messages échange dynamique de données</span><span class="sxs-lookup"><span data-stu-id="98ae2-272">Dynamic Data Exchange Messages Overview</span></span>

<span data-ttu-id="98ae2-273">Comme DDE est un protocole basé sur les messages, il n’utilise aucune fonction ou bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="98ae2-273">Because DDE is a message-based protocol, it employs no functions or libraries.</span></span> <span data-ttu-id="98ae2-274">Toutes les transactions DDE sont effectuées en passant certains messages DDE définis entre les fenêtres client et serveur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-274">All DDE transactions are conducted by passing certain defined DDE messages between the client and server windows.</span></span>

<span data-ttu-id="98ae2-275">Il y a neuf messages DDE ; les constantes symboliques pour ces messages sont définies dans le fichier d’en-tête DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-275">There are nine DDE messages; the symbolic constants for these messages are defined in the DDE header file.</span></span> <span data-ttu-id="98ae2-276">Certaines structures pour les différents messages DDE sont également définies dans ce fichier d’en-tête.</span><span class="sxs-lookup"><span data-stu-id="98ae2-276">Certain structures for the various DDE messages are also defined in this header file.</span></span>

<span data-ttu-id="98ae2-277">Le tableau suivant récapitule les messages DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-277">The following table summarizes the DDE messages.</span></span>



| <span data-ttu-id="98ae2-278">Message</span><span class="sxs-lookup"><span data-stu-id="98ae2-278">Message</span></span>                                        | <span data-ttu-id="98ae2-279">Description</span><span class="sxs-lookup"><span data-stu-id="98ae2-279">Description</span></span>                                                                                                                                      |
|------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="98ae2-280">**\_ACK DDE \_ ACK**</span><span class="sxs-lookup"><span data-stu-id="98ae2-280">**WM\_DDE\_ACK**</span></span>](wm-dde-ack.md)             | <span data-ttu-id="98ae2-281">Accuse réception ou non de réception d’un message.</span><span class="sxs-lookup"><span data-stu-id="98ae2-281">Acknowledges receiving or not receiving a message.</span></span>                                                                                               |
| [<span data-ttu-id="98ae2-282">**\_avis DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="98ae2-282">**WM\_DDE\_ADVISE**</span></span>](wm-dde-advise.md)       | <span data-ttu-id="98ae2-283">Demande à l’application serveur de fournir une mise à jour ou une notification pour un élément de données chaque fois qu’il change.</span><span class="sxs-lookup"><span data-stu-id="98ae2-283">Requests the server application to supply an update or notification for a data item whenever it changes.</span></span> <span data-ttu-id="98ae2-284">Cela établit une liaison de données permanente.</span><span class="sxs-lookup"><span data-stu-id="98ae2-284">This establishes a permanent data link.</span></span> |
| [<span data-ttu-id="98ae2-285">**\_données DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="98ae2-285">**WM\_DDE\_DATA**</span></span>](wm-dde-data.md)           | <span data-ttu-id="98ae2-286">Envoie une valeur d’élément de données à l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="98ae2-286">Sends a data-item value to the client application.</span></span>                                                                                               |
| [<span data-ttu-id="98ae2-287">**\_exécution DDE de WM \_**</span><span class="sxs-lookup"><span data-stu-id="98ae2-287">**WM\_DDE\_EXECUTE**</span></span>](wm-dde-execute.md)     | <span data-ttu-id="98ae2-288">Envoie une chaîne à l’application serveur, qui est censée traiter la chaîne sous la forme d’une série de commandes.</span><span class="sxs-lookup"><span data-stu-id="98ae2-288">Sends a string to the server application, which is expected to process the string as a series of commands.</span></span>                                       |
| [<span data-ttu-id="98ae2-289">**\_lancement de DDE de WM \_**</span><span class="sxs-lookup"><span data-stu-id="98ae2-289">**WM\_DDE\_INITIATE**</span></span>](wm-dde-initiate.md)   | <span data-ttu-id="98ae2-290">Initie une conversation entre les applications client et serveur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-290">Initiates a conversation between the client and server applications.</span></span>                                                                             |
| [<span data-ttu-id="98ae2-291">**en-dessous du protocole WM \_ DDE \_**</span><span class="sxs-lookup"><span data-stu-id="98ae2-291">**WM\_DDE\_POKE**</span></span>](wm-dde-poke.md)           | <span data-ttu-id="98ae2-292">Envoie une valeur d’élément de données à l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-292">Sends a data-item value to the server application.</span></span>                                                                                               |
| [<span data-ttu-id="98ae2-293">**\_requête DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="98ae2-293">**WM\_DDE\_REQUEST**</span></span>](wm-dde-request.md)     | <span data-ttu-id="98ae2-294">Demande à l’application serveur de fournir la valeur d’un élément de données.</span><span class="sxs-lookup"><span data-stu-id="98ae2-294">Requests the server application to provide the value of a data item.</span></span>                                                                             |
| [<span data-ttu-id="98ae2-295">**arrêt de l’échange de thread WM \_ \_**</span><span class="sxs-lookup"><span data-stu-id="98ae2-295">**WM\_DDE\_TERMINATE**</span></span>](wm-dde-terminate.md) | <span data-ttu-id="98ae2-296">Met fin à une conversation.</span><span class="sxs-lookup"><span data-stu-id="98ae2-296">Terminates a conversation.</span></span>                                                                                                                       |
| [<span data-ttu-id="98ae2-297">**informer de l' \_ échange de \_ notification**</span><span class="sxs-lookup"><span data-stu-id="98ae2-297">**WM\_DDE\_UNADVISE**</span></span>](wm-dde-unadvise.md)   | <span data-ttu-id="98ae2-298">Met fin à un lien de données permanent.</span><span class="sxs-lookup"><span data-stu-id="98ae2-298">Terminates a permanent data link.</span></span>                                                                                                                |



 

<span data-ttu-id="98ae2-299">Une application appelle [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) pour émettre le message de [**\_ \_ lancement DDE**](wm-dde-initiate.md) ou un message d’accusé de réception DDE avec un message d' [**\_ \_ accusé**](wm-dde-ack.md) de réception DDE envoyé en réponse à l' **\_ \_ initialisation** de l’échange de messages WM.</span><span class="sxs-lookup"><span data-stu-id="98ae2-299">An application calls [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) to issue the [**WM\_DDE\_INITIATE**](wm-dde-initiate.md) message or a [**WM\_DDE\_ACK**](wm-dde-ack.md) message sent in response to **WM\_DDE\_INITIATE**.</span></span> <span data-ttu-id="98ae2-300">Tous les autres messages sont envoyés par [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span><span class="sxs-lookup"><span data-stu-id="98ae2-300">All other messages are sent by [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span></span> <span data-ttu-id="98ae2-301">Le premier paramètre de ces appels est un handle de la fenêtre de réception ; le deuxième paramètre contient le message à envoyer ; le troisième paramètre identifie la fenêtre émettrice ; et le quatrième paramètre contient les arguments spécifiques au message.</span><span class="sxs-lookup"><span data-stu-id="98ae2-301">The first parameter of these calls is a handle to the receiving window; the second parameter contains the message to be sent; the third parameter identifies the sending window; and the fourth parameter contains the message-specific arguments.</span></span>

## <a name="dynamic-data-exchange-message-flow"></a><span data-ttu-id="98ae2-302">échange dynamique de données le workflow du message</span><span class="sxs-lookup"><span data-stu-id="98ae2-302">Dynamic Data Exchange Message Flow</span></span>

<span data-ttu-id="98ae2-303">Une conversation DDE classique est constituée des événements suivants :</span><span class="sxs-lookup"><span data-stu-id="98ae2-303">A typical DDE conversation consists of the following events:</span></span>

1.  <span data-ttu-id="98ae2-304">L’application cliente initie la conversation et l’application serveur répond.</span><span class="sxs-lookup"><span data-stu-id="98ae2-304">The client application initiates the conversation, and the server application responds.</span></span>
2.  <span data-ttu-id="98ae2-305">Les applications échangent des données par l’une ou l’ensemble des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="98ae2-305">The applications exchange data by any or all of the following methods:</span></span>
    -   -   <span data-ttu-id="98ae2-306">L’application serveur envoie des données au client à la demande du client.</span><span class="sxs-lookup"><span data-stu-id="98ae2-306">The server application sends data to the client at the client's request.</span></span>
        -   <span data-ttu-id="98ae2-307">L’application cliente envoie des données non sollicitées à l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="98ae2-307">The client application sends unsolicited data to the server application.</span></span>
        -   <span data-ttu-id="98ae2-308">L’application cliente demande à l’application serveur de notifier le client chaque fois qu’un élément de données change (lien de données à chaud).</span><span class="sxs-lookup"><span data-stu-id="98ae2-308">The client application requests the server application to notify the client whenever a data item changes (warm data link).</span></span>
        -   <span data-ttu-id="98ae2-309">L’application cliente demande à l’application serveur d’envoyer des données chaque fois que les données sont modifiées (liaison de données à chaud).</span><span class="sxs-lookup"><span data-stu-id="98ae2-309">The client application requests the server application to send data whenever the data changes (hot data link).</span></span>
        -   <span data-ttu-id="98ae2-310">L’application serveur exécute une commande à la demande du client.</span><span class="sxs-lookup"><span data-stu-id="98ae2-310">The server application carries out a command at the client's request.</span></span>

3.  <span data-ttu-id="98ae2-311">L’application cliente ou serveur met fin à la conversation.</span><span class="sxs-lookup"><span data-stu-id="98ae2-311">Either the client or server application terminates the conversation.</span></span>

<span data-ttu-id="98ae2-312">Une fenêtre d’application qui traite les demandes d’un client ou d’un serveur doit les traiter de manière stricte dans l’ordre dans lequel elles sont reçues.</span><span class="sxs-lookup"><span data-stu-id="98ae2-312">An application window that processes requests from a client or server must process them strictly in the order they are received.</span></span>

<span data-ttu-id="98ae2-313">Un client peut établir des conversations avec plusieurs serveurs ; un serveur peut avoir des conversations avec plusieurs clients.</span><span class="sxs-lookup"><span data-stu-id="98ae2-313">A client can establish conversations with more than one server; a server can have conversations with more than one client.</span></span> <span data-ttu-id="98ae2-314">Lors de la gestion des messages à partir de plusieurs sources, un client ou un serveur doit traiter les messages d’une conversation de façon synchrone, mais ils n’ont pas besoin de traiter tous les messages de façon synchrone.</span><span class="sxs-lookup"><span data-stu-id="98ae2-314">When handling messages from more than one source, a client or server must process the messages of a conversation synchronously, but need not process all messages synchronously.</span></span> <span data-ttu-id="98ae2-315">En d’autres termes, il peut passer d’une conversation à une autre en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="98ae2-315">In other words, it can shift from one conversation to another as needed.</span></span>

<span data-ttu-id="98ae2-316">Si une application ne parvient pas à traiter une demande entrante parce qu’elle attend une réponse DDE, elle doit empêcher tout interblocage en publiant un message d’accusé de réception [**\_ DDE \_ de WM**](wm-dde-ack.md) avec le membre **fBusy** de la structure [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) défini sur 1.</span><span class="sxs-lookup"><span data-stu-id="98ae2-316">If an application is unable to process an incoming request because it is waiting for a DDE response, it must prevent deadlock by posting a [**WM\_DDE\_ACK**](wm-dde-ack.md) message with the **fBusy** member of the [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) structure set to 1.</span></span> <span data-ttu-id="98ae2-317">Une application peut également envoyer un message **d' \_ \_ accusé** de réception DDE actif occupé si, pour une raison quelconque, elle ne peut pas traiter une demande entrante dans un laps de temps raisonnable.</span><span class="sxs-lookup"><span data-stu-id="98ae2-317">An application can also send a busy **WM\_DDE\_ACK** message if, for any reason, it cannot process an incoming request within a reasonable amount of time.</span></span>

<span data-ttu-id="98ae2-318">Une application doit être en mesure de gérer l’échec d’un client ou d’un serveur à répondre à un message dans un certain délai.</span><span class="sxs-lookup"><span data-stu-id="98ae2-318">An application should be able to handle the failure of a client or server to respond to a message within a certain time.</span></span> <span data-ttu-id="98ae2-319">Étant donné que l’intervalle de délai d’attente peut varier en fonction de la nature de l’application et de la configuration du système de l’utilisateur (notamment si elle est connectée à un réseau), l’application doit fournir à l’utilisateur un moyen de spécifier l’intervalle.</span><span class="sxs-lookup"><span data-stu-id="98ae2-319">Since the time-out interval may vary depending on the nature of the application and the configuration of the user's system (including whether it is connected to a network), the application should provide a way for the user to specify the interval.</span></span>

## <a name="parameter-packing-functions"></a><span data-ttu-id="98ae2-320">Fonctions de compression des paramètres</span><span class="sxs-lookup"><span data-stu-id="98ae2-320">Parameter Packing Functions</span></span>

<span data-ttu-id="98ae2-321">Le paramètre *lParam* d’un grand nombre de messages DDE contient deux éléments de données.</span><span class="sxs-lookup"><span data-stu-id="98ae2-321">The *lParam* parameter of many DDE messages contains two pieces of data.</span></span> <span data-ttu-id="98ae2-322">Par exemple, le *lParam* du message [**de \_ \_ données DDE WM**](wm-dde-data.md) contient un descripteur de données et un Atom.</span><span class="sxs-lookup"><span data-stu-id="98ae2-322">For example, the *lParam* of the [**WM\_DDE\_DATA**](wm-dde-data.md) message contains a data handle and an atom.</span></span> <span data-ttu-id="98ae2-323">Les applications doivent utiliser la fonction [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) pour empaqueter le handle et Atom dans un paramètre *lParam* , et la fonction [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) pour supprimer les valeurs.</span><span class="sxs-lookup"><span data-stu-id="98ae2-323">Applications must use the [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) function to pack the handle and atom into an *lParam* parameter, and the [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) function to remove the values.</span></span> <span data-ttu-id="98ae2-324">Les applications DDE doivent utiliser **PackDDElParam** et **UnpackDDElParam** pour tous les messages publiés au cours d’une conversation DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-324">DDE applications must use **PackDDElParam** and **UnpackDDElParam** for all messages posted during a DDE conversation.</span></span>

<span data-ttu-id="98ae2-325">Les applications peuvent également utiliser les fonctions [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) et [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) .</span><span class="sxs-lookup"><span data-stu-id="98ae2-325">Applications can also use the [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) and [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) functions.</span></span> <span data-ttu-id="98ae2-326">**ReuseDDElParam** permet à une application DDE de réutiliser un paramètre *lParam* condensé, ce qui contribue à réduire le nombre de réallocations de mémoire que l’application doit effectuer pendant une conversation.</span><span class="sxs-lookup"><span data-stu-id="98ae2-326">**ReuseDDElParam** allows a DDE application to reuse a packed *lParam* parameter, helping reduce the number of memory reallocations the application must perform during a conversation.</span></span> <span data-ttu-id="98ae2-327">Une application peut utiliser **FreeDDElParam** pour libérer la mémoire associée à un handle de données reçu au cours d’une conversation DDE.</span><span class="sxs-lookup"><span data-stu-id="98ae2-327">An application can use **FreeDDElParam** to free the memory associated with a data handle received during a DDE conversation.</span></span>

## <a name="dynamic-data-exchange-and-impersonation"></a><span data-ttu-id="98ae2-328">échange dynamique de données et emprunt d’identité</span><span class="sxs-lookup"><span data-stu-id="98ae2-328">Dynamic Data Exchange and Impersonation</span></span>

<span data-ttu-id="98ae2-329">Pour permettre à un serveur d’emprunter l’identité d’un client, le client appelle la fonction [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) .</span><span class="sxs-lookup"><span data-stu-id="98ae2-329">To allow a server to impersonate a client, the client calls the [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) function.</span></span> <span data-ttu-id="98ae2-330">La structure de [**\_ \_ niveau d’emprunt d’identité de sécurité**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) est utilisée pour contrôler le niveau d’emprunt d’identité que le serveur peut effectuer.</span><span class="sxs-lookup"><span data-stu-id="98ae2-330">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) structure is used to control the level of impersonation the server may perform.</span></span>

<span data-ttu-id="98ae2-331">Un serveur DDE peut emprunter l’identité d’un client DDE en appelant la fonction [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) .</span><span class="sxs-lookup"><span data-stu-id="98ae2-331">A DDE server can impersonate a DDE client by calling the [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) function.</span></span> <span data-ttu-id="98ae2-332">Un serveur DDEML doit utiliser la fonction [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) .</span><span class="sxs-lookup"><span data-stu-id="98ae2-332">A DDEML server should use the [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) function.</span></span>

 

 