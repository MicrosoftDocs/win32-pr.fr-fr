---
title: À propos du presse-papiers
description: Cette section décrit le presse-papiers.
ms.assetid: 14c91730-a668-495b-9ec6-b835234821a5
keywords:
- presse-papiers, à propos de
- presse-papiers, formats
- presse-papiers, commandes
- presse-papiers, fenêtres
- presse-papiers, numéros de séquence
- presse-papiers, visionneuses
- presse-papiers, fenêtres de visionneuse
- presse-papiers, formats d’affichage
- presse-papiers, formats d’affichage du propriétaire
- afficher les formats du presse-papiers
- propriétaire afficher les formats du presse-papiers
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b94757a95fb8c40152a0018d04cef64e8efae624
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104316103"
---
# <a name="about-the-clipboard"></a><span data-ttu-id="c1c93-114">À propos du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c1c93-114">About the Clipboard</span></span>

<span data-ttu-id="c1c93-115">Le *presse-papiers* est un ensemble de fonctions et de messages qui permettent aux applications de transférer des données.</span><span class="sxs-lookup"><span data-stu-id="c1c93-115">The *clipboard* is a set of functions and messages that enable applications to transfer data.</span></span> <span data-ttu-id="c1c93-116">Étant donné que toutes les applications ont accès au Presse-papiers, les données peuvent être facilement transférées entre les applications ou au sein d’une application.</span><span class="sxs-lookup"><span data-stu-id="c1c93-116">Because all applications have access to the clipboard, data can be easily transferred between applications or within an application.</span></span>

<span data-ttu-id="c1c93-117">Le presse-papiers est piloté par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c1c93-117">The clipboard is user-driven.</span></span> <span data-ttu-id="c1c93-118">Une fenêtre doit transférer les données vers ou à partir du presse-papiers uniquement en réponse à une commande de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c1c93-118">A window should transfer data to or from the clipboard only in response to a command from the user.</span></span> <span data-ttu-id="c1c93-119">Une fenêtre ne doit pas utiliser le presse-papiers pour transférer des données sans la connaissance de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c1c93-119">A window must not use the clipboard to transfer data without the user's knowledge.</span></span>

<span data-ttu-id="c1c93-120">Un objet mémoire sur le presse-papiers peut être dans n’importe quel format de données, appelé format presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-120">A memory object on the clipboard can be in any data format, called a clipboard format.</span></span> <span data-ttu-id="c1c93-121">Chaque format est identifié par une valeur entière non signée.</span><span class="sxs-lookup"><span data-stu-id="c1c93-121">Each format is identified by an unsigned integer value.</span></span> <span data-ttu-id="c1c93-122">Pour les formats de presse-papiers standard (prédéfinis), cette valeur est une constante définie dans winuser. h ; pour les formats de presse-papiers inscrits, il s’agit de la valeur de retour de la fonction [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) .</span><span class="sxs-lookup"><span data-stu-id="c1c93-122">For standard (predefined) clipboard formats, this value is a constant defined in Winuser.h; for registered clipboard formats, it is the return value of the [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) function.</span></span>

<span data-ttu-id="c1c93-123">À l’exception de l’inscription des formats de presse-papiers, les fenêtres individuelles effectuent la plupart des opérations de presse</span><span class="sxs-lookup"><span data-stu-id="c1c93-123">Except for registering clipboard formats, individual windows perform most clipboard operations.</span></span> <span data-ttu-id="c1c93-124">En règle générale, une procédure de fenêtre transfère les informations vers ou depuis le presse-papiers en réponse au message de [**\_ commande WM**](/windows/desktop/menurc/wm-command) .</span><span class="sxs-lookup"><span data-stu-id="c1c93-124">Typically, a window procedure transfers information to or from the clipboard in response to the [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span>

<span data-ttu-id="c1c93-125">Cette section aborde les points suivants :</span><span class="sxs-lookup"><span data-stu-id="c1c93-125">This section discusses the following:</span></span>

-   [<span data-ttu-id="c1c93-126">Commandes du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c1c93-126">Clipboard Commands</span></span>](#clipboard-commands)
-   [<span data-ttu-id="c1c93-127">Numéro de séquence du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c1c93-127">Clipboard Sequence Number</span></span>](#clipboard-sequence-number)
-   [<span data-ttu-id="c1c93-128">Visionneuses de presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c1c93-128">Clipboard Viewers</span></span>](#clipboard-viewers)
    -   [<span data-ttu-id="c1c93-129">Presse-papiers Windows</span><span class="sxs-lookup"><span data-stu-id="c1c93-129">Clipboard Viewer Windows</span></span>](#clipboard-viewer-windows)
    -   [<span data-ttu-id="c1c93-130">Formats d’affichage</span><span class="sxs-lookup"><span data-stu-id="c1c93-130">Display Formats</span></span>](#display-formats)
    -   [<span data-ttu-id="c1c93-131">Format d’affichage du propriétaire</span><span class="sxs-lookup"><span data-stu-id="c1c93-131">Owner Display Format</span></span>](#owner-display-format)
-   [<span data-ttu-id="c1c93-132">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c1c93-132">Related topics</span></span>](#related-topics)

## <a name="clipboard-commands"></a><span data-ttu-id="c1c93-133">Commandes du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c1c93-133">Clipboard Commands</span></span>

<span data-ttu-id="c1c93-134">Un utilisateur effectue généralement des opérations de presse-papiers en choisissant des commandes dans le menu **Edition** d’une application.</span><span class="sxs-lookup"><span data-stu-id="c1c93-134">A user typically carries out clipboard operations by choosing commands from an application's **Edit** menu.</span></span> <span data-ttu-id="c1c93-135">Vous trouverez ci-dessous une brève description des commandes standard du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-135">Following is a brief description of the standard clipboard commands.</span></span>



|            |                                                                                                                                                                                                                   |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c1c93-136">**Couper**</span><span class="sxs-lookup"><span data-stu-id="c1c93-136">**Cut**</span></span>    | <span data-ttu-id="c1c93-137">Place une copie de la sélection actuelle dans le presse-papiers et supprime la sélection du document.</span><span class="sxs-lookup"><span data-stu-id="c1c93-137">Places a copy of the current selection on the clipboard and deletes the selection from the document.</span></span> <span data-ttu-id="c1c93-138">Le contenu précédent du presse-papiers est détruit.</span><span class="sxs-lookup"><span data-stu-id="c1c93-138">The previous content of the clipboard is destroyed.</span></span>                                                          |
| <span data-ttu-id="c1c93-139">**Copier**</span><span class="sxs-lookup"><span data-stu-id="c1c93-139">**Copy**</span></span>   | <span data-ttu-id="c1c93-140">Place une copie de la sélection actuelle dans le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-140">Places a copy of the current selection on the clipboard.</span></span> <span data-ttu-id="c1c93-141">Le document reste inchangé.</span><span class="sxs-lookup"><span data-stu-id="c1c93-141">The document remains unchanged.</span></span> <span data-ttu-id="c1c93-142">Le contenu précédent du presse-papiers est détruit.</span><span class="sxs-lookup"><span data-stu-id="c1c93-142">The previous content of the clipboard is destroyed.</span></span>                                                                      |
| <span data-ttu-id="c1c93-143">**Coller**</span><span class="sxs-lookup"><span data-stu-id="c1c93-143">**Paste**</span></span>  | <span data-ttu-id="c1c93-144">Remplace la sélection actuelle par le contenu du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-144">Replaces the current selection with the content of the clipboard.</span></span> <span data-ttu-id="c1c93-145">Le contenu du presse-papiers n’est pas modifié.</span><span class="sxs-lookup"><span data-stu-id="c1c93-145">The content of the clipboard is not changed.</span></span>                                                                                                    |
| <span data-ttu-id="c1c93-146">**Supprimer**</span><span class="sxs-lookup"><span data-stu-id="c1c93-146">**Delete**</span></span> | <span data-ttu-id="c1c93-147">Supprime la sélection actuelle du document.</span><span class="sxs-lookup"><span data-stu-id="c1c93-147">Deletes the current selection from the document.</span></span> <span data-ttu-id="c1c93-148">Le contenu du presse-papiers n’est pas modifié.</span><span class="sxs-lookup"><span data-stu-id="c1c93-148">The content of the clipboard is not changed.</span></span> <span data-ttu-id="c1c93-149">Cette commande n’implique pas le presse-papiers, mais elle doit apparaître avec les commandes du presse-papiers dans le menu **Edition** .</span><span class="sxs-lookup"><span data-stu-id="c1c93-149">This command does not involve the clipboard, but it should appear with the clipboard commands on the **Edit** menu.</span></span> |



 

## <a name="clipboard-sequence-number"></a><span data-ttu-id="c1c93-150">Numéro de séquence du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c1c93-150">Clipboard Sequence Number</span></span>

<span data-ttu-id="c1c93-151">Le presse-papiers de chaque station Windows est associé à un numéro de séquence du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-151">The clipboard for each window station has an associated clipboard sequence number.</span></span> <span data-ttu-id="c1c93-152">Ce nombre est incrémenté chaque fois que le contenu du presse-papiers change.</span><span class="sxs-lookup"><span data-stu-id="c1c93-152">This number is incremented whenever the contents of the clipboard change.</span></span> <span data-ttu-id="c1c93-153">Pour obtenir le numéro de séquence du presse-papiers, appelez la fonction [**GetClipboardSequenceNumber**](/windows/desktop/api/Winuser/nf-winuser-getclipboardsequencenumber) .</span><span class="sxs-lookup"><span data-stu-id="c1c93-153">To obtain the clipboard sequence number, call the [**GetClipboardSequenceNumber**](/windows/desktop/api/Winuser/nf-winuser-getclipboardsequencenumber) function.</span></span>

## <a name="clipboard-viewers"></a><span data-ttu-id="c1c93-154">Visionneuses de presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c1c93-154">Clipboard Viewers</span></span>

<span data-ttu-id="c1c93-155">Une visionneuse du presse-papiers est une fenêtre qui affiche le contenu actuel du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-155">A clipboard viewer is a window that displays the current content of the clipboard.</span></span> <span data-ttu-id="c1c93-156">La fenêtre de la visionneuse du presse-papiers est un outil pratique pour l’utilisateur et n’affecte pas les fonctions de transaction de données du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-156">The clipboard viewer window is a convenience for the user and does not affect the data-transaction functions of the clipboard.</span></span>

<span data-ttu-id="c1c93-157">En règle générale, une fenêtre de la visionneuse du presse-papiers peut afficher au moins les trois formats les plus courants : **CF \_ Text**, **CF \_ bitmap** et **CF \_ MetaFilePict**.</span><span class="sxs-lookup"><span data-stu-id="c1c93-157">Typically, a clipboard viewer window can display at least the three most common formats: **CF\_TEXT**, **CF\_BITMAP**, and **CF\_METAFILEPICT**.</span></span> <span data-ttu-id="c1c93-158">Si une fenêtre ne rend pas les données disponibles dans l’un de ces trois formats, elle doit fournir des données dans un format d’affichage ou utiliser le format d’affichage du propriétaire.</span><span class="sxs-lookup"><span data-stu-id="c1c93-158">If a window does not make data available in any of these three formats, it should provide data in a display format or use the owner-display format.</span></span>

<span data-ttu-id="c1c93-159">Une *chaîne de visionneuse du presse-papiers* est le lien entre deux entités ou plus afin qu’elles soient dépendantes les unes des autres pour l’opération.</span><span class="sxs-lookup"><span data-stu-id="c1c93-159">A *clipboard viewer chain* is the linking together of two or more entities so that they are dependent upon one another for operation.</span></span> <span data-ttu-id="c1c93-160">Cette interdépendance (chaîne) permet à toutes les applications de visionneuse du presse-papiers en cours d’exécution de recevoir les messages envoyés au Presse-papiers actuel.</span><span class="sxs-lookup"><span data-stu-id="c1c93-160">This interdependency (chain) allows all running clipboard viewer applications to receive the messages sent to the current clipboard.</span></span>

<span data-ttu-id="c1c93-161">Les rubriques suivantes sont présentées dans cette section.</span><span class="sxs-lookup"><span data-stu-id="c1c93-161">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="c1c93-162">Presse-papiers Windows</span><span class="sxs-lookup"><span data-stu-id="c1c93-162">Clipboard Viewer Windows</span></span>](#clipboard-viewer-windows)
-   [<span data-ttu-id="c1c93-163">Formats d’affichage</span><span class="sxs-lookup"><span data-stu-id="c1c93-163">Display Formats</span></span>](#display-formats)
-   [<span data-ttu-id="c1c93-164">Format d’affichage du propriétaire</span><span class="sxs-lookup"><span data-stu-id="c1c93-164">Owner Display Format</span></span>](#owner-display-format)

### <a name="clipboard-viewer-windows"></a><span data-ttu-id="c1c93-165">Presse-papiers Windows</span><span class="sxs-lookup"><span data-stu-id="c1c93-165">Clipboard Viewer Windows</span></span>

<span data-ttu-id="c1c93-166">Une fenêtre s’ajoute à la chaîne de la visionneuse du presse-papiers en appelant la fonction [**SetClipboardViewer**](/windows/desktop/api/Winuser/nf-winuser-setclipboardviewer) .</span><span class="sxs-lookup"><span data-stu-id="c1c93-166">A window adds itself to the clipboard viewer chain by calling the [**SetClipboardViewer**](/windows/desktop/api/Winuser/nf-winuser-setclipboardviewer) function.</span></span> <span data-ttu-id="c1c93-167">La valeur de retour est le handle de la fenêtre suivante dans la chaîne.</span><span class="sxs-lookup"><span data-stu-id="c1c93-167">The return value is the handle to the next window in the chain.</span></span> <span data-ttu-id="c1c93-168">Pour récupérer le handle de la première fenêtre de la chaîne, appelez la fonction [**GetClipboardViewer**](/windows/desktop/api/Winuser/nf-winuser-getclipboardviewer) .</span><span class="sxs-lookup"><span data-stu-id="c1c93-168">To retrieve the handle to the first window in the chain, call the [**GetClipboardViewer**](/windows/desktop/api/Winuser/nf-winuser-getclipboardviewer) function.</span></span>

<span data-ttu-id="c1c93-169">Chaque fenêtre de la visionneuse du presse-papiers doit suivre la fenêtre suivante dans la chaîne du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-169">Each clipboard viewer window must keep track of the next window in the clipboard viewer chain.</span></span> <span data-ttu-id="c1c93-170">Lorsque le contenu du presse-papiers change, le système envoie un message [**WM \_ DRAWCLIPBOARD**](wm-drawclipboard.md) à la première fenêtre de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="c1c93-170">When the content of the clipboard changes, the system sends a [**WM\_DRAWCLIPBOARD**](wm-drawclipboard.md) message to the first window in the chain.</span></span> <span data-ttu-id="c1c93-171">Après la mise à jour de son affichage, chaque fenêtre de la visionneuse du presse-papiers doit passer ce message à la fenêtre suivante dans la chaîne.</span><span class="sxs-lookup"><span data-stu-id="c1c93-171">After updating its display, each clipboard viewer window must pass this message on to the next window in the chain.</span></span>

<span data-ttu-id="c1c93-172">Avant de fermer, une fenêtre de la visionneuse du presse-papiers doit se supprimer de la chaîne du presse-papiers en appelant la fonction [**ChangeClipboardChain**](/windows/desktop/api/Winuser/nf-winuser-changeclipboardchain) .</span><span class="sxs-lookup"><span data-stu-id="c1c93-172">Before closing, a clipboard viewer window must remove itself from the clipboard viewer chain by calling the [**ChangeClipboardChain**](/windows/desktop/api/Winuser/nf-winuser-changeclipboardchain) function.</span></span> <span data-ttu-id="c1c93-173">Le système envoie ensuite un message [**WM \_ CHANGECBCHAIN**](wm-changecbchain.md) à la première fenêtre de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="c1c93-173">The system then sends a [**WM\_CHANGECBCHAIN**](wm-changecbchain.md) message to the first window in the chain.</span></span>

<span data-ttu-id="c1c93-174">Pour plus d’informations sur le traitement des messages [**WM \_ DRAWCLIPBOARD**](wm-drawclipboard.md) et [**WM \_ CHANGECBCHAIN**](wm-changecbchain.md) , consultez [création d’une fenêtre de la visionneuse du presse-papiers](using-the-clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="c1c93-174">For more information about processing the [**WM\_DRAWCLIPBOARD**](wm-drawclipboard.md) and [**WM\_CHANGECBCHAIN**](wm-changecbchain.md) messages, see [Creating a Clipboard Viewer Window](using-the-clipboard.md).</span></span>

### <a name="display-formats"></a><span data-ttu-id="c1c93-175">Formats d'affichage</span><span class="sxs-lookup"><span data-stu-id="c1c93-175">Display Formats</span></span>

<span data-ttu-id="c1c93-176">Un format d’affichage est un format de presse-papiers utilisé pour afficher des informations dans une fenêtre de la visionneuse du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-176">A display format is a clipboard format used to display information in a clipboard viewer window.</span></span> <span data-ttu-id="c1c93-177">Un propriétaire de presse-papiers qui utilise un format de presse-papiers privé ou inscrit, et aucun des formats standard les plus courants, doit fournir des données dans un format d’affichage pour l’affichage dans une fenêtre de la visionneuse du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-177">A clipboard owner that uses a private or registered clipboard format, and none of the most common standard formats, must provide data in a display format for viewing in a clipboard viewer window.</span></span> <span data-ttu-id="c1c93-178">Les formats d’affichage sont uniquement destinés à l’affichage et ne doivent pas être collés dans un document.</span><span class="sxs-lookup"><span data-stu-id="c1c93-178">The display formats are intended for viewing only and must not be pasted into a document.</span></span>

<span data-ttu-id="c1c93-179">Les quatre formats d’affichage sont **: \_ CF DSPBITMAP**, **CF \_ DSPMETAFILEPICT**, **CF \_ DSPTEXT** et **CF \_ DSPENHMETAFILE**.</span><span class="sxs-lookup"><span data-stu-id="c1c93-179">The four display formats are: **CF\_DSPBITMAP**, **CF\_DSPMETAFILEPICT**, **CF\_DSPTEXT**, and **CF\_DSPENHMETAFILE**.</span></span> <span data-ttu-id="c1c93-180">Ces formats d’affichage sont rendus de la même façon que les formats standard, qui sont : **CF \_ bitmap**, **CF \_ Text**, **CF \_ MetaFilePict** et **CF \_ ENHMETAFILE**.</span><span class="sxs-lookup"><span data-stu-id="c1c93-180">These display formats are rendered in the same way as the standard formats, which are: **CF\_BITMAP**, **CF\_TEXT**, **CF\_METAFILEPICT**, and **CF\_ENHMETAFILE**.</span></span>

### <a name="owner-display-format"></a><span data-ttu-id="c1c93-181">Format d’affichage du propriétaire</span><span class="sxs-lookup"><span data-stu-id="c1c93-181">Owner Display Format</span></span>

<span data-ttu-id="c1c93-182">Pour un propriétaire de presse-papiers qui n’utilise aucun des formats de presse-papiers standard courants, une alternative à la fourniture d’un format d’affichage consiste à utiliser le format de presse-papiers (**CF \_ OWNERDISPLAY**) owner-Display.</span><span class="sxs-lookup"><span data-stu-id="c1c93-182">For a clipboard owner that does not use any of the common standard clipboard formats, an alternative to providing a display format is to use the owner-display (**CF\_OWNERDISPLAY**) clipboard format.</span></span>

<span data-ttu-id="c1c93-183">En utilisant le format d’affichage propriétaire, un propriétaire de presse-papiers peut éviter la surcharge liée au rendu des données dans un format supplémentaire en contrôlant directement la peinture de la fenêtre de la visionneuse du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c1c93-183">By using the owner-display format, a clipboard owner can avoid the overhead of rendering data in an additional format by taking direct control over painting the clipboard viewer window.</span></span> <span data-ttu-id="c1c93-184">La fenêtre de la visionneuse du presse-papiers envoie des messages au propriétaire du presse-papiers chaque fois qu’une partie de la fenêtre doit être redessinée ou que la fenêtre est défilée ou redimensionnée.</span><span class="sxs-lookup"><span data-stu-id="c1c93-184">The clipboard viewer window sends messages to the clipboard owner whenever a portion of the window must be repainted or when the window is scrolled or resized.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c1c93-185">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c1c93-185">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c1c93-186">Formats de presse-papiers standard</span><span class="sxs-lookup"><span data-stu-id="c1c93-186">Standard Clipboard Formats</span></span>](standard-clipboard-formats.md)
</dt> </dl>

 

 