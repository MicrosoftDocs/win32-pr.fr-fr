---
title: Concepts de base
description: Cette rubrique décrit les concepts clés relatifs à l’échange dynamique de données.
ms.assetid: 37826d83-4dcd-484f-b1aa-87bf309c5c09
keywords:
- Interface utilisateur Windows, échange dynamique de données (DDE)
- Interface utilisateur Windows, bibliothèque de gestion des échange dynamique de données (DDEML)
- Échange dynamique de données (DDE), interaction du serveur client
- DDE (échange dynamique de données), interaction du serveur client
- échange de données, échange dynamique de données (DDE)
- échange de données, bibliothèque de gestion des échange dynamique de données (DDEML)
- Échange dynamique de données (DDE), applications clientes
- DDE (échange dynamique de données), applications clientes
- Échange dynamique de données (DDE), applications serveur
- DDE (échange dynamique de données), applications serveur
- Échange dynamique de données (DDE), fonctions de rappel
- DDE (échange dynamique de données), fonctions de rappel
- Échange dynamique de données (DDE), transactions
- DDE (échange dynamique de données), transactions
- Échange dynamique de données (DDE), noms de service
- DDE (échange dynamique de données), noms de service
- Échange dynamique de données (DDE), noms d’éléments
- DDE (échange dynamique de données), noms d’éléments
- Échange dynamique de données (DDE), noms de rubriques
- DDE (échange dynamique de données), noms de rubriques
- Échange dynamique de données (DDE), rubrique système
- DDE (échange dynamique de données), rubrique système
- Bibliothèque de gestion des échange dynamique de données (DDEML), initialisation
- DDEML (bibliothèque de gestion échange dynamique de données), initialisation
- Bibliothèque de gestion des échange dynamique de données (DDEML), fonctions de rappel
- DDEML (bibliothèque de gestion échange dynamique de données), fonctions de rappel
- Bibliothèque de gestion des échange dynamique de données (DDEML), gestion des chaînes
- DDEML (bibliothèque de gestion échange dynamique de données), gestion des chaînes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0c564bffbcbb06ddc3a0e0fa4e0a9ed398d3ca55
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103727917"
---
# <a name="basic-concepts-dde"></a><span data-ttu-id="87d2d-131">Concepts de base (DDE)</span><span class="sxs-lookup"><span data-stu-id="87d2d-131">Basic Concepts (DDE)</span></span>

<span data-ttu-id="87d2d-132">Ces concepts sont essentiels pour comprendre échange dynamique de données (DDE) et la bibliothèque de gestion des échange dynamique de données (DDEML).</span><span class="sxs-lookup"><span data-stu-id="87d2d-132">These concepts are key to understanding Dynamic Data Exchange (DDE) and the Dynamic Data Exchange Management Library (DDEML).</span></span>

-   [<span data-ttu-id="87d2d-133">Interaction entre le client et le serveur</span><span class="sxs-lookup"><span data-stu-id="87d2d-133">Client and Server Interaction</span></span>](#client-and-server-interaction)
-   [<span data-ttu-id="87d2d-134">Transactions et fonction de rappel DDE</span><span class="sxs-lookup"><span data-stu-id="87d2d-134">Transactions and the DDE Callback Function</span></span>](#transactions-and-the-dde-callback-function)
-   [<span data-ttu-id="87d2d-135">Noms de service, noms de rubriques et noms d’éléments</span><span class="sxs-lookup"><span data-stu-id="87d2d-135">Service Names, Topic Names, and Item Names</span></span>](#service-names-topic-names-and-item-names)
-   [<span data-ttu-id="87d2d-136">Rubrique système</span><span class="sxs-lookup"><span data-stu-id="87d2d-136">System Topic</span></span>](#system-topic)
-   [<span data-ttu-id="87d2d-137">D’initialisation</span><span class="sxs-lookup"><span data-stu-id="87d2d-137">Initialization</span></span>](#initialization)
-   [<span data-ttu-id="87d2d-138">Fonction de rappel</span><span class="sxs-lookup"><span data-stu-id="87d2d-138">Callback Function</span></span>](#callback-function)
-   [<span data-ttu-id="87d2d-139">Gestion des chaînes</span><span class="sxs-lookup"><span data-stu-id="87d2d-139">String Management</span></span>](#string-management)
-   [<span data-ttu-id="87d2d-140">DDEML et threads</span><span class="sxs-lookup"><span data-stu-id="87d2d-140">DDEML and Threads</span></span>](#ddeml-and-threads)

## <a name="client-and-server-interaction"></a><span data-ttu-id="87d2d-141">Interaction entre le client et le serveur</span><span class="sxs-lookup"><span data-stu-id="87d2d-141">Client and Server Interaction</span></span>

<span data-ttu-id="87d2d-142">DDE se produit toujours entre une application cliente et une application serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-142">DDE always occurs between a client application and a server application.</span></span> <span data-ttu-id="87d2d-143">L' *application cliente DDE* initie l’échange en établissant une conversation avec le serveur pour envoyer des transactions au serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-143">The *DDE client application* initiates the exchange by establishing a conversation with the server to send transactions to the server.</span></span> <span data-ttu-id="87d2d-144">Une transaction est une demande de données ou de services.</span><span class="sxs-lookup"><span data-stu-id="87d2d-144">A transaction is a request for data or services.</span></span> <span data-ttu-id="87d2d-145">L' *application de serveur DDE* répond aux transactions en fournissant des données ou des services au client.</span><span class="sxs-lookup"><span data-stu-id="87d2d-145">The *DDE server application* responds to transactions by providing data or services to the client.</span></span> <span data-ttu-id="87d2d-146">Par exemple, une application graphique peut contenir un graphique à barres représentant les bénéfices trimestriels d’une entreprise, mais les données du graphique à barres peuvent être contenues dans une application de feuille de calcul.</span><span class="sxs-lookup"><span data-stu-id="87d2d-146">For example, a graphics application might contain a bar graph representing a corporation's quarterly profits, but the data for the bar graph might be contained in a spreadsheet application.</span></span> <span data-ttu-id="87d2d-147">Pour obtenir les derniers résultats, l’application Graphics (le client) peut établir une conversation avec l’application Spreadsheet (le serveur).</span><span class="sxs-lookup"><span data-stu-id="87d2d-147">To obtain the latest profit figures, the graphics application (the client) could establish a conversation with the spreadsheet application (the server).</span></span> <span data-ttu-id="87d2d-148">L’application Graphics peut ensuite envoyer une transaction à l’application de feuille de calcul, en demandant les derniers résultats.</span><span class="sxs-lookup"><span data-stu-id="87d2d-148">The graphics application could then send a transaction to the spreadsheet application, requesting the latest profit figures.</span></span>

<span data-ttu-id="87d2d-149">Un serveur peut avoir plusieurs clients en même temps et un client peut demander des données à partir de plusieurs serveurs.</span><span class="sxs-lookup"><span data-stu-id="87d2d-149">A server can have many clients at the same time, and a client can request data from multiple servers.</span></span> <span data-ttu-id="87d2d-150">Une application peut également être à la fois un client et un serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-150">An application can also be both a client and a server.</span></span> <span data-ttu-id="87d2d-151">Le client ou le serveur peut mettre fin à la conversation à tout moment.</span><span class="sxs-lookup"><span data-stu-id="87d2d-151">Either the client or the server can terminate the conversation at any time.</span></span>

## <a name="transactions-and-the-dde-callback-function"></a><span data-ttu-id="87d2d-152">Transactions et fonction de rappel DDE</span><span class="sxs-lookup"><span data-stu-id="87d2d-152">Transactions and the DDE Callback Function</span></span>

<span data-ttu-id="87d2d-153">Le DDEML informe une application de l’activité DDE qui affecte l’application en envoyant des transactions à la fonction de rappel DDE de l’application.</span><span class="sxs-lookup"><span data-stu-id="87d2d-153">The DDEML notifies an application about DDE activity that affects the application by sending transactions to the application's DDE callback function.</span></span> <span data-ttu-id="87d2d-154">Une *transaction DDE* est semblable à un message. il s’agit d’une constante nommée accompagnée d’autres paramètres qui contiennent des informations supplémentaires sur la transaction.</span><span class="sxs-lookup"><span data-stu-id="87d2d-154">A *DDE transaction* is similar to a message   it is a named constant accompanied by other parameters that contain additional information about the transaction.</span></span>

<span data-ttu-id="87d2d-155">Le DDEML transmet une transaction à une fonction de rappel DDE définie par l’application qui exécute une action appropriée pour le type de transaction.</span><span class="sxs-lookup"><span data-stu-id="87d2d-155">The DDEML passes a transaction to an application-defined DDE callback function that carries out an action appropriate to the type of transaction.</span></span> <span data-ttu-id="87d2d-156">Par exemple, lorsqu’une application cliente tente d’établir une conversation avec une application serveur, le client appelle la fonction [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) .</span><span class="sxs-lookup"><span data-stu-id="87d2d-156">For example, when a client application attempts to establish a conversation with a server application, the client calls the [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) function.</span></span> <span data-ttu-id="87d2d-157">Cette fonction force DDEML à envoyer une transaction [**XTYP \_ Connect**](xtyp-connect.md) à la fonction de rappel DDE du serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-157">This function causes the DDEML to send an [**XTYP\_CONNECT**](xtyp-connect.md) transaction to the server's DDE callback function.</span></span> <span data-ttu-id="87d2d-158">La fonction de rappel peut autoriser la conversation en retournant la **valeur true** à Ddeml, ou elle peut refuser la conversation en retournant **false**.</span><span class="sxs-lookup"><span data-stu-id="87d2d-158">The callback function can allow the conversation by returning **TRUE** to the DDEML, or it can deny the conversation by returning **FALSE**.</span></span> <span data-ttu-id="87d2d-159">Pour une présentation détaillée des transactions, consultez [gestion des transactions](transaction-management.md).</span><span class="sxs-lookup"><span data-stu-id="87d2d-159">For a detailed discussion of transactions, see [Transaction Management](transaction-management.md).</span></span>

## <a name="service-names-topic-names-and-item-names"></a><span data-ttu-id="87d2d-160">Noms de service, noms de rubriques et noms d’éléments</span><span class="sxs-lookup"><span data-stu-id="87d2d-160">Service Names, Topic Names, and Item Names</span></span>

<span data-ttu-id="87d2d-161">Un serveur DDE utilise un nom de service de hiérarchie à trois niveaux (appelé « nom de l’application » dans la documentation DDE précédente), un nom de rubrique et un nom d’élément pour identifier de manière unique une unité de données que le serveur peut échanger au cours d’une conversation.</span><span class="sxs-lookup"><span data-stu-id="87d2d-161">A DDE server uses a three-level hierarchy   service name (called "application name" in previous DDE documentation), topic name, and item name   to uniquely identify a unit of data the server can exchange during a conversation.</span></span>

<span data-ttu-id="87d2d-162">Un *nom de service* est une chaîne à laquelle une application serveur répond lorsqu’un client tente d’établir une conversation avec le serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-162">A *service name* is a string a server application responds to when a client attempts to establish a conversation with the server.</span></span> <span data-ttu-id="87d2d-163">Un client doit spécifier ce nom de service pour établir une conversation avec le serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-163">A client must specify this service name to establish a conversation with the server.</span></span> <span data-ttu-id="87d2d-164">Bien qu’un serveur puisse répondre à de nombreux noms de service, la plupart des serveurs répondent à un seul nom.</span><span class="sxs-lookup"><span data-stu-id="87d2d-164">Although a server can respond to many service names, most servers respond to only one name.</span></span>

<span data-ttu-id="87d2d-165">Un *nom de rubrique* est une chaîne qui identifie un contexte de données logique.</span><span class="sxs-lookup"><span data-stu-id="87d2d-165">A *topic name* is a string that identifies a logical data context.</span></span> <span data-ttu-id="87d2d-166">Pour les serveurs qui opèrent sur des documents basés sur des fichiers, les noms de rubriques sont généralement des noms de fichiers ; pour les autres serveurs, il s’agit d’autres chaînes propres à l’application.</span><span class="sxs-lookup"><span data-stu-id="87d2d-166">For servers that operate on file-based documents, topic names are typically filenames; for other servers, they are other application-specific strings.</span></span> <span data-ttu-id="87d2d-167">Un client doit spécifier un nom de rubrique avec le nom de service d’un serveur lorsqu’il tente d’établir une conversation avec un serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-167">A client must specify a topic name along with a server's service name when it attempts to establish a conversation with a server.</span></span>

<span data-ttu-id="87d2d-168">Un *nom d’élément* est une chaîne qui identifie une unité de données qu’un serveur peut passer à un client au cours d’une transaction.</span><span class="sxs-lookup"><span data-stu-id="87d2d-168">An *item name* is a string that identifies a unit of data a server can pass to a client during a transaction.</span></span> <span data-ttu-id="87d2d-169">Par exemple, un nom d’élément peut identifier un entier, une chaîne, plusieurs paragraphes de texte ou une image bitmap.</span><span class="sxs-lookup"><span data-stu-id="87d2d-169">For example, an item name might identify an integer, a string, several paragraphs of text, or a bitmap.</span></span>

<span data-ttu-id="87d2d-170">Les noms de service, de rubrique et d’élément permettent au client d’établir une conversation avec un serveur et de recevoir des données du serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-170">The service, topic, and item names enable the client to establish a conversation with a server and to receive data from the server.</span></span>

## <a name="system-topic"></a><span data-ttu-id="87d2d-171">Rubrique système</span><span class="sxs-lookup"><span data-stu-id="87d2d-171">System Topic</span></span>

<span data-ttu-id="87d2d-172">La rubrique système fournit un contexte pour les informations d’intérêt général pour un client DDE.</span><span class="sxs-lookup"><span data-stu-id="87d2d-172">The System topic provides a context for information of general interest to any DDE client.</span></span> <span data-ttu-id="87d2d-173">Il est recommandé que les applications serveur prennent en charge la rubrique système à tout moment.</span><span class="sxs-lookup"><span data-stu-id="87d2d-173">It is recommended that server applications support the System topic at all times.</span></span> <span data-ttu-id="87d2d-174">La rubrique système est définie dans DDEML. Fichier d’en-tête H comme \_ rubrique SZDDESYS.</span><span class="sxs-lookup"><span data-stu-id="87d2d-174">The System topic is defined in the DDEML.H header file as SZDDESYS\_TOPIC.</span></span>

<span data-ttu-id="87d2d-175">Pour déterminer les serveurs présents et les types d’informations qu’ils peuvent fournir, une application cliente peut demander une conversation sur la rubrique du système au démarrage, en affectant la **valeur null** au nom de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="87d2d-175">To determine which servers are present and the kinds of information they can provide, a client application can request a conversation on the System topic upon starting, setting the device name to **NULL**.</span></span> <span data-ttu-id="87d2d-176">Ces conversations par caractères génériques sont coûteuses en termes de performances du système. elles doivent donc être limitées au minimum.</span><span class="sxs-lookup"><span data-stu-id="87d2d-176">Such wildcard conversations are costly in terms of system performance, so they should be kept to a minimum.</span></span> <span data-ttu-id="87d2d-177">Pour plus d’informations sur l’initiation des conversations DDE, consultez [gestion](conversation-management.md)des conversations.</span><span class="sxs-lookup"><span data-stu-id="87d2d-177">For more information about initiating DDE conversations, see [Conversation Management](conversation-management.md).</span></span>

<span data-ttu-id="87d2d-178">Un serveur doit prendre en charge les noms d’éléments suivants dans la rubrique système et tout autre nom d’élément utile pour un client.</span><span class="sxs-lookup"><span data-stu-id="87d2d-178">A server must support the following item names within the System topic and any other item names that are useful to a client.</span></span>



| <span data-ttu-id="87d2d-179">Élément</span><span class="sxs-lookup"><span data-stu-id="87d2d-179">Item</span></span>                     | <span data-ttu-id="87d2d-180">Description</span><span class="sxs-lookup"><span data-stu-id="87d2d-180">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="87d2d-181">\_élément SZDDE \_ ITEMLIST</span><span class="sxs-lookup"><span data-stu-id="87d2d-181">SZDDE\_ITEM\_ITEMLIST</span></span>    | <span data-ttu-id="87d2d-182">Liste des éléments pris en charge dans une rubrique non-système.</span><span class="sxs-lookup"><span data-stu-id="87d2d-182">A list of the items supported under a non-System topic.</span></span> <span data-ttu-id="87d2d-183">(Cette liste peut varier d’un moment à l’autres et d’un sujet à un sujet.)</span><span class="sxs-lookup"><span data-stu-id="87d2d-183">(This list can vary from moment to moment and from topic to topic.)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="87d2d-184">\_formats d’élément SZDDESYS \_</span><span class="sxs-lookup"><span data-stu-id="87d2d-184">SZDDESYS\_ITEM\_FORMATS</span></span>  | <span data-ttu-id="87d2d-185">Liste de chaînes délimitées par des tabulations représentant tous les formats de presse-papiers potentiellement pris en charge par l’application de service.</span><span class="sxs-lookup"><span data-stu-id="87d2d-185">A tab-delimited list of strings representing all clipboard formats potentially supported by the service application.</span></span> <span data-ttu-id="87d2d-186">Les chaînes qui représentent des formats de presse-papiers prédéfinis sont équivalentes aux \_ valeurs CF avec le \_ préfixe « CF » supprimé.</span><span class="sxs-lookup"><span data-stu-id="87d2d-186">Strings that represent predefined clipboard formats are equivalent to the CF\_ values with the "CF\_" prefix removed.</span></span> <span data-ttu-id="87d2d-187">Par exemple, le \_ format de texte CF est représenté par la chaîne « Text ».</span><span class="sxs-lookup"><span data-stu-id="87d2d-187">For example, the CF\_TEXT format is represented by the string "TEXT".</span></span> <span data-ttu-id="87d2d-188">Ces chaînes doivent être en majuscules pour les identifier plus en tant que formats prédéfinis.</span><span class="sxs-lookup"><span data-stu-id="87d2d-188">These strings must be uppercase to further identify them as predefined formats.</span></span> <span data-ttu-id="87d2d-189">La liste des formats doit apparaître dans l’ordre de contenu le plus riche pour le contenu le moins riche.</span><span class="sxs-lookup"><span data-stu-id="87d2d-189">The list of formats must appear in the order of most rich in content to least rich in content.</span></span> <span data-ttu-id="87d2d-190">Pour plus d’informations sur les formats de presse-papiers et les données de rendu, consultez [presse-papiers](clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="87d2d-190">For more information about clipboard formats and rendering data, see [Clipboard](clipboard.md).</span></span><br/> |
| <span data-ttu-id="87d2d-191">\_ \_ aide sur l’élément SZDDESYS</span><span class="sxs-lookup"><span data-stu-id="87d2d-191">SZDDESYS\_ITEM\_HELP</span></span>     | <span data-ttu-id="87d2d-192">Informations explicites d’intérêt général.</span><span class="sxs-lookup"><span data-stu-id="87d2d-192">User-readable information of general interest.</span></span> <span data-ttu-id="87d2d-193">Cet élément doit contenir au minimum des informations sur l’utilisation des fonctionnalités DDE de l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-193">This item must contain, at a minimum, information on how to use the server application's DDE features.</span></span> <span data-ttu-id="87d2d-194">Ces informations peuvent inclure, sans s’y limiter, comment spécifier des éléments dans les rubriques, les chaînes d’exécution que le serveur peut exécuter, les transactions d’enchaînement autorisées et comment rechercher de l’aide sur d’autres éléments de rubrique système.</span><span class="sxs-lookup"><span data-stu-id="87d2d-194">This information can include, but is not limited to, how to specify items within topics, what execute strings the server can perform, what poke transactions are allowed, and how to find help on other System topic items.</span></span>                                                                                                                                                                                                                           |
| <span data-ttu-id="87d2d-195">\_élément SZDDESYS \_ RTNMSG</span><span class="sxs-lookup"><span data-stu-id="87d2d-195">SZDDESYS\_ITEM\_RTNMSG</span></span>   | <span data-ttu-id="87d2d-196">Détails de la prise en charge du message d’accusé de réception [**\_ DDE DDE \_**](wm-dde-ack.md) récemment utilisé.</span><span class="sxs-lookup"><span data-stu-id="87d2d-196">Supporting detail for the most recently used [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span> <span data-ttu-id="87d2d-197">Cet élément est utile lorsque plus de 8 bits de données de retour spécifiques à l’application sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="87d2d-197">This item is useful when more than 8 bits of application-specific return data are required.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="87d2d-198">État de l' \_ élément SZDDESYS \_</span><span class="sxs-lookup"><span data-stu-id="87d2d-198">SZDDESYS\_ITEM\_STATUS</span></span>   | <span data-ttu-id="87d2d-199">Indication de l’état actuel du serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-199">An indication of the current status of the server.</span></span> <span data-ttu-id="87d2d-200">En règle générale, cet élément prend en charge uniquement le \_ format de texte CF et contient la chaîne prête ou occupée.</span><span class="sxs-lookup"><span data-stu-id="87d2d-200">Typically, this item supports only the CF\_TEXT format and contains the Ready or Busy string.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="87d2d-201">\_élément SZDDESYS \_ SYSITEMS</span><span class="sxs-lookup"><span data-stu-id="87d2d-201">SZDDESYS\_ITEM\_SYSITEMS</span></span> | <span data-ttu-id="87d2d-202">Liste des éléments pris en charge dans la rubrique système par ce serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-202">A list of the items supported under the System topic by this server.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="87d2d-203">\_rubriques relatives aux éléments SZDDESYS \_</span><span class="sxs-lookup"><span data-stu-id="87d2d-203">SZDDESYS\_ITEM\_TOPICS</span></span>   | <span data-ttu-id="87d2d-204">Liste des rubriques prises en charge par le serveur à l’heure actuelle.</span><span class="sxs-lookup"><span data-stu-id="87d2d-204">A list of the topics supported by the server at the current time.</span></span> <span data-ttu-id="87d2d-205">(Cette liste peut varier d’un moment à l’autres).</span><span class="sxs-lookup"><span data-stu-id="87d2d-205">(This list can vary from moment to moment.)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

<span data-ttu-id="87d2d-206">Ces noms d’élément sont des valeurs définies dans DDEML. Fichier d’en-tête H.</span><span class="sxs-lookup"><span data-stu-id="87d2d-206">These item names are values defined in the DDEML.H header file.</span></span> <span data-ttu-id="87d2d-207">Pour obtenir des handles de chaîne pour ces chaînes, une application doit utiliser les fonctions de gestion de chaînes DDEML, tout comme pour toute autre chaîne dans une application DDEML.</span><span class="sxs-lookup"><span data-stu-id="87d2d-207">To obtain string handles to these strings, an application must use the DDEML string-management functions, just as it would for any other string in a DDEML application.</span></span> <span data-ttu-id="87d2d-208">Pour plus d’informations sur la gestion des chaînes, consultez [gestion](#string-management)des chaînes.</span><span class="sxs-lookup"><span data-stu-id="87d2d-208">For more information about managing strings, see [String Management](#string-management).</span></span>

## <a name="initialization"></a><span data-ttu-id="87d2d-209">Initialisation</span><span class="sxs-lookup"><span data-stu-id="87d2d-209">Initialization</span></span>

<span data-ttu-id="87d2d-210">Avant d’appeler toute autre fonction DDEML, une application doit appeler la fonction [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="87d2d-210">Before calling any other DDEML function, an application must call the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span> <span data-ttu-id="87d2d-211">**DdeInitialize** obtient un identificateur d’instance pour l’application, inscrit la fonction de rappel DDE de l’application auprès du DDE et spécifie les indicateurs de filtre de transaction pour la fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="87d2d-211">**DdeInitialize** obtains an instance identifier for the application, registers the application's DDE callback function with the DDE, and specifies the transaction filter flags for the callback function.</span></span>

<span data-ttu-id="87d2d-212">Chaque instance d’une application ou d’une DLL doit passer son identificateur d’instance en tant que paramètre *idInst* à toute autre fonction Ddeml qui l’exige.</span><span class="sxs-lookup"><span data-stu-id="87d2d-212">Each instance of an application or a DLL must pass its instance identifier as the *idInst* parameter to any other DDEML function that requires it.</span></span> <span data-ttu-id="87d2d-213">L’objectif de plusieurs instances DDEML consiste à prendre en charge les dll qui doivent utiliser le DDEML en même temps qu’une application l’utilise.</span><span class="sxs-lookup"><span data-stu-id="87d2d-213">The purpose of multiple DDEML instances is to support DLLs that must use the DDEML at the same time an application is using it.</span></span> <span data-ttu-id="87d2d-214">Une application ne doit pas utiliser plus d’une instance de DDEML.</span><span class="sxs-lookup"><span data-stu-id="87d2d-214">An application must not use more than one instance of the DDEML.</span></span>

<span data-ttu-id="87d2d-215">Les *filtres de transaction* optimisent les performances du système en empêchant le Ddeml de transmettre des transactions indésirables à la fonction de rappel DDE de l’application.</span><span class="sxs-lookup"><span data-stu-id="87d2d-215">*Transaction filters* optimize system performance by preventing the DDEML from passing unwanted transactions to the application's DDE callback function.</span></span> <span data-ttu-id="87d2d-216">Une application définit les filtres de transaction dans le paramètre [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) *ufCmd* .</span><span class="sxs-lookup"><span data-stu-id="87d2d-216">An application sets the transaction filters in the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) *ufCmd* parameter.</span></span> <span data-ttu-id="87d2d-217">Une application doit spécifier un indicateur de filtre de transaction pour chaque type de transaction qu’elle ne traite pas dans sa fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="87d2d-217">An application must specify a transaction filter flag for each type of transaction that it does not process in its callback function.</span></span> <span data-ttu-id="87d2d-218">Une application peut modifier ses filtres de transactions avec un appel ultérieur à **DdeInitialize**.</span><span class="sxs-lookup"><span data-stu-id="87d2d-218">An application can change its transaction filters with a subsequent call to **DdeInitialize**.</span></span> <span data-ttu-id="87d2d-219">Pour plus d’informations sur les transactions, consultez [gestion des transactions](transaction-management.md).</span><span class="sxs-lookup"><span data-stu-id="87d2d-219">For more information about transactions, see [Transaction Management](transaction-management.md).</span></span>

<span data-ttu-id="87d2d-220">L’exemple suivant montre comment initialiser une application pour utiliser le DDEML.</span><span class="sxs-lookup"><span data-stu-id="87d2d-220">The following example shows how to initialize an application to use the DDEML.</span></span>


```
DWORD idInst = 0; 
HINSTANCE hinst; 
 
DdeInitialize(&idInst,         // receives instance identifier 
    (PFNCALLBACK) DdeCallback, // pointer to callback function 
    CBF_FAIL_EXECUTES |        // filter XTYPE_EXECUTE 
    CBF_SKIP_ALLNOTIFICATIONS, // filter notifications 
    0); 
```



<span data-ttu-id="87d2d-221">Une application doit appeler la fonction [**DdeUninitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeuninitialize) lorsqu’elle n’utilise plus le Ddeml.</span><span class="sxs-lookup"><span data-stu-id="87d2d-221">An application must call the [**DdeUninitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeuninitialize) function when it is no longer going to use the DDEML.</span></span> <span data-ttu-id="87d2d-222">Cette fonction met fin à toutes les conversations actuellement ouvertes pour l’application et libère les ressources DDEML allouées par le système pour l’application.</span><span class="sxs-lookup"><span data-stu-id="87d2d-222">This function terminates any conversations currently open for the application and frees the DDEML resources the system allocated for the application.</span></span>

## <a name="callback-function"></a><span data-ttu-id="87d2d-223">Fonction de rappel</span><span class="sxs-lookup"><span data-stu-id="87d2d-223">Callback Function</span></span>

<span data-ttu-id="87d2d-224">Une application qui utilise DDEML doit fournir une fonction de rappel qui traite les événements DDE affectant l’application.</span><span class="sxs-lookup"><span data-stu-id="87d2d-224">An application that uses the DDEML must provide a callback function that processes the DDE events affecting the application.</span></span> <span data-ttu-id="87d2d-225">Le DDEML notifie une application de tels événements en envoyant des transactions à la fonction de rappel DDE de l’application.</span><span class="sxs-lookup"><span data-stu-id="87d2d-225">The DDEML notifies an application of such events by sending transactions to the application's DDE callback function.</span></span> <span data-ttu-id="87d2d-226">Les transactions qu’une fonction de rappel reçoit dépendent du filtre de rappel qui signale l’application spécifiée dans [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) et si l’application est un client, un serveur ou les deux.</span><span class="sxs-lookup"><span data-stu-id="87d2d-226">The transactions a callback function receives depend on which callback filter flags the application specified in [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) and whether the application is a client, a server, or both.</span></span> <span data-ttu-id="87d2d-227">Pour plus d’informations, consultez [**DdeCallback**](/windows/win32/api/ddeml/nc-ddeml-pfncallback).</span><span class="sxs-lookup"><span data-stu-id="87d2d-227">For more information, please see [**DdeCallback**](/windows/win32/api/ddeml/nc-ddeml-pfncallback).</span></span>

<span data-ttu-id="87d2d-228">L’exemple suivant illustre la structure générale d’une fonction de rappel pour une application cliente classique.</span><span class="sxs-lookup"><span data-stu-id="87d2d-228">The following example shows the general structure of a callback function for a typical client application.</span></span>


```
HDDEDATA CALLBACK DdeCallback(uType, uFmt, hconv, hsz1, 
    hsz2, hdata, dwData1, dwData2) 
UINT uType;       // transaction type 
UINT uFmt;        // clipboard data format 
HCONV hconv;      // handle to conversation 
HSZ hsz1;         // handle to string 
HSZ hsz2;         // handle to string 
HDDEDATA hdata;   // handle to global memory object 
DWORD dwData1;    // transaction-specific data 
DWORD dwData2;    // transaction-specific data 
{ 
    switch (uType) 
    { 
        case XTYP_REGISTER: 
        case XTYP_UNREGISTER: 
            . 
            . 
            . 
            return (HDDEDATA) NULL; 
 
        case XTYP_ADVDATA: 
            . 
            . 
            . 
            return (HDDEDATA) DDE_FACK; 
 
        case XTYP_XACT_COMPLETE: 
            
            // 
            
            return (HDDEDATA) NULL; 
 
        case XTYP_DISCONNECT: 
            
            // 
            
            return (HDDEDATA) NULL; 
 
        default: 
            return (HDDEDATA) NULL; 
    } 
} 
```



<span data-ttu-id="87d2d-229">Le paramètre *uType* spécifie le type de transaction envoyé à la fonction de rappel par le Ddeml.</span><span class="sxs-lookup"><span data-stu-id="87d2d-229">The *uType* parameter specifies the transaction type sent to the callback function by the DDEML.</span></span> <span data-ttu-id="87d2d-230">Les valeurs des autres paramètres dépendent du type de transaction.</span><span class="sxs-lookup"><span data-stu-id="87d2d-230">The values of the remaining parameters depend on the transaction type.</span></span> <span data-ttu-id="87d2d-231">Les types de transactions et les événements qui les génèrent sont décrits dans les rubriques suivantes.</span><span class="sxs-lookup"><span data-stu-id="87d2d-231">The transaction types and the events that generate them are described in the following topics.</span></span> <span data-ttu-id="87d2d-232">Pour plus d’informations sur chaque type de transaction, consultez [gestion des transactions](transaction-management.md).</span><span class="sxs-lookup"><span data-stu-id="87d2d-232">For detailed information about each transaction type, see [Transaction Management](transaction-management.md).</span></span>

## <a name="string-management"></a><span data-ttu-id="87d2d-233">Gestion des chaînes</span><span class="sxs-lookup"><span data-stu-id="87d2d-233">String Management</span></span>

<span data-ttu-id="87d2d-234">Pour effectuer une tâche DDE, de nombreuses fonctions DDEML requièrent l’accès aux chaînes.</span><span class="sxs-lookup"><span data-stu-id="87d2d-234">To carry out a DDE task, many DDEML functions require access to strings.</span></span> <span data-ttu-id="87d2d-235">Par exemple, un client doit spécifier un nom de service et un nom de rubrique lorsqu’il appelle la fonction [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) pour demander une conversation avec un serveur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-235">For example, a client must specify a service name and a topic name when it calls the [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) function to request a conversation with a server.</span></span> <span data-ttu-id="87d2d-236">Une application spécifie une chaîne en passant un handle de chaîne (HSZ) au lieu d’un pointeur dans une fonction DDEML.</span><span class="sxs-lookup"><span data-stu-id="87d2d-236">An application specifies a string by passing a string handle (HSZ) rather than a pointer in a DDEML function.</span></span> <span data-ttu-id="87d2d-237">Un *descripteur de chaîne* est une valeur **DWORD** , assignée par le système, qui identifie une chaîne.</span><span class="sxs-lookup"><span data-stu-id="87d2d-237">A *string handle* is a **DWORD** value, assigned by the system, that identifies a string.</span></span>

<span data-ttu-id="87d2d-238">Une application peut obtenir un descripteur de chaîne d’une chaîne particulière en appelant la fonction [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) .</span><span class="sxs-lookup"><span data-stu-id="87d2d-238">An application can obtain a string handle to a particular string by calling the [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) function.</span></span> <span data-ttu-id="87d2d-239">Cette fonction inscrit la chaîne auprès du système et retourne un handle de chaîne à l’application.</span><span class="sxs-lookup"><span data-stu-id="87d2d-239">This function registers the string with the system and returns a string handle to the application.</span></span> <span data-ttu-id="87d2d-240">L’application peut passer le descripteur aux fonctions DDEML qui doivent accéder à la chaîne.</span><span class="sxs-lookup"><span data-stu-id="87d2d-240">The application can pass the handle to DDEML functions that must access the string.</span></span> <span data-ttu-id="87d2d-241">L’exemple suivant obtient des handles de chaîne à la chaîne de rubrique système et à la chaîne de nom de service.</span><span class="sxs-lookup"><span data-stu-id="87d2d-241">The following example obtains string handles to the System topic string and the service name string.</span></span>


```
HSZ hszServName; 
HSZ hszSysTopic; 
hszServName = DdeCreateStringHandle( 
    idInst,         // instance identifier 
    "MyServer",     // string to register 
    CP_WINANSI);    // Windows ANSI code page 
 
hszSysTopic = DdeCreateStringHandle( 
    idInst,         // instance identifier 
    SZDDESYS_TOPIC, // System topic 
    CP_WINANSI);    // Windows ANSI code page 
    
```



<span data-ttu-id="87d2d-242">Le paramètre *idInst* dans l’exemple précédent spécifie l’identificateur d’instance obtenu par la fonction [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="87d2d-242">The *idInst* parameter in the preceding example specifies the instance identifier obtained by the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span>

<span data-ttu-id="87d2d-243">La fonction de rappel DDE d’une application reçoit un ou plusieurs descripteurs de chaîne au cours de la plupart des transactions DDE.</span><span class="sxs-lookup"><span data-stu-id="87d2d-243">An application's DDE callback function receives one or more string handles during most DDE transactions.</span></span> <span data-ttu-id="87d2d-244">Par exemple, un serveur reçoit deux descripteurs de chaîne lors de la transaction de [**\_ demande XTYP**](xtyp-request.md) : l’un identifie une chaîne spécifiant un nom de rubrique et l’autre identifie une chaîne spécifiant un nom d’élément.</span><span class="sxs-lookup"><span data-stu-id="87d2d-244">For example, a server receives two string handles during the [**XTYP\_REQUEST**](xtyp-request.md) transaction: one identifies a string specifying a topic name, and the other identifies a string specifying an item name.</span></span> <span data-ttu-id="87d2d-245">Une application peut obtenir la longueur de la chaîne qui correspond à un handle de chaîne et copier la chaîne dans une mémoire tampon définie par l’application en appelant la fonction [**DdeQueryString**](/windows/desktop/api/Ddeml/nf-ddeml-ddequerystringa) , comme illustré dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="87d2d-245">An application can obtain the length of the string that corresponds to a string handle and copy the string to an application-defined buffer by calling the [**DdeQueryString**](/windows/desktop/api/Ddeml/nf-ddeml-ddequerystringa) function, as shown in the following example.</span></span>


```
DWORD idInst; 
DWORD cb; 
HSZ hszServ; 
PSTR pszServName; 
cb = DdeQueryString(idInst, hszServ, (LPSTR) NULL, 0, 
    CP_WINANSI) + 1; 
pszServName = (PSTR) LocalAlloc(LPTR, (UINT) cb); 
DdeQueryString(idInst, hszServ, pszServName, cb, CP_WINANSI); 
```



<span data-ttu-id="87d2d-246">Un handle de chaîne spécifique à l’instance ne peut pas être mappé du descripteur de chaîne à la chaîne et revenir au handle de chaîne.</span><span class="sxs-lookup"><span data-stu-id="87d2d-246">An instance-specific string handle cannot be mapped from string handle to string and back to string handle.</span></span> <span data-ttu-id="87d2d-247">Par exemple, bien que [**DdeQueryString**](/windows/desktop/api/Ddeml/nf-ddeml-ddequerystringa) crée une chaîne à partir d’un handle de chaîne, puis [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) crée un handle de chaîne à partir de cette chaîne, les deux Handles ne sont pas les mêmes, comme illustré dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="87d2d-247">For instance, although [**DdeQueryString**](/windows/desktop/api/Ddeml/nf-ddeml-ddequerystringa) creates a string from a string handle and then [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) creates a string handle from that string, the two handles are not the same, as shown in the following example.</span></span>


```
DWORD idInst; 
DWORD cb; 
HSZ hszInst, hszNew; 
PSZ pszInst; 
DdeQueryString(idInst, hszInst, pszInst, cb, CP_WINANSI); 
hszNew = DdeCreateStringHandle(idInst, pszInst, CP_WINANSI); 
// hszNew != hszInst ! 
```



<span data-ttu-id="87d2d-248">Pour comparer les valeurs de deux descripteurs de chaîne, utilisez la fonction [**DdeCmpStringHandles**](/windows/desktop/api/Ddeml/nf-ddeml-ddecmpstringhandles) .</span><span class="sxs-lookup"><span data-stu-id="87d2d-248">To compare the values of two string handles, use the [**DdeCmpStringHandles**](/windows/desktop/api/Ddeml/nf-ddeml-ddecmpstringhandles) function.</span></span>

<span data-ttu-id="87d2d-249">Un descripteur de chaîne passé à la fonction de rappel DDE d’une application devient non valide lorsque la fonction de rappel retourne.</span><span class="sxs-lookup"><span data-stu-id="87d2d-249">A string handle passed to an application's DDE callback function becomes invalid when the callback function returns.</span></span> <span data-ttu-id="87d2d-250">Une application peut enregistrer un handle de chaîne pour une utilisation après le retour de la fonction de rappel à l’aide de la fonction [**DdeKeepStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddekeepstringhandle) .</span><span class="sxs-lookup"><span data-stu-id="87d2d-250">An application can save a string handle for use after the callback function returns by using the [**DdeKeepStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddekeepstringhandle) function.</span></span>

<span data-ttu-id="87d2d-251">Quand une application appelle [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea), le système entre la chaîne spécifiée dans une table de chaînes et génère un handle qu’elle utilise pour accéder à la chaîne.</span><span class="sxs-lookup"><span data-stu-id="87d2d-251">When an application calls [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea), the system enters the specified string into a string table and generates a handle that it uses to access the string.</span></span> <span data-ttu-id="87d2d-252">Le système gère également un nombre d’utilisations pour chaque chaîne dans la table de chaînes.</span><span class="sxs-lookup"><span data-stu-id="87d2d-252">The system also maintains a usage count for each string in the string table.</span></span>

<span data-ttu-id="87d2d-253">Quand une application appelle [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) et spécifie une chaîne qui existe déjà dans la table, le système incrémente le nombre d’utilisations plutôt que d’ajouter une autre occurrence de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="87d2d-253">When an application calls [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) and specifies a string that already exists in the table, the system increments the usage count rather than adding another occurrence of the string.</span></span> <span data-ttu-id="87d2d-254">(Une application peut également incrémenter le nombre d’utilisations à l’aide de [**DdeKeepStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddekeepstringhandle).) Quand une application appelle la fonction [**DdeFreeStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreestringhandle) , le système décrémente le nombre d’utilisations.</span><span class="sxs-lookup"><span data-stu-id="87d2d-254">(An application can also increment the usage count by using [**DdeKeepStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddekeepstringhandle).) When an application calls the [**DdeFreeStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreestringhandle) function, the system decrements the usage count.</span></span>

<span data-ttu-id="87d2d-255">Une chaîne est supprimée de la table lorsque son nombre d’utilisations est égal à zéro.</span><span class="sxs-lookup"><span data-stu-id="87d2d-255">A string is removed from the table when its usage count equals zero.</span></span> <span data-ttu-id="87d2d-256">Étant donné que plusieurs applications peuvent obtenir le descripteur d’une chaîne particulière, une application ne doit pas libérer un handle de chaîne plus de fois qu’il n’a créé ou conservé le descripteur.</span><span class="sxs-lookup"><span data-stu-id="87d2d-256">Because more than one application can obtain the handle to a particular string, an application must not free a string handle more times than it has created or retained the handle.</span></span> <span data-ttu-id="87d2d-257">Dans le cas contraire, l’application peut provoquer la suppression de la chaîne de la table, ce qui a pour effet de refuser à d’autres applications l’accès à la chaîne.</span><span class="sxs-lookup"><span data-stu-id="87d2d-257">Otherwise, the application can cause the string to be removed from the table, denying other applications access to the string.</span></span>

<span data-ttu-id="87d2d-258">Les fonctions de gestion de chaînes DDEML sont basées sur le gestionnaire Atom et sont soumises aux mêmes restrictions de taille que les atomes.</span><span class="sxs-lookup"><span data-stu-id="87d2d-258">The DDEML string-management functions are based on the atom manager and are subject to the same size restrictions as are atoms.</span></span>

## <a name="ddeml-and-threads"></a><span data-ttu-id="87d2d-259">DDEML et threads</span><span class="sxs-lookup"><span data-stu-id="87d2d-259">DDEML and Threads</span></span>

<span data-ttu-id="87d2d-260">La fonction [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) inscrit une application avec Ddeml, créant une instance Ddeml.</span><span class="sxs-lookup"><span data-stu-id="87d2d-260">The [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function registers an application with the DDEML, creating a DDEML instance.</span></span> <span data-ttu-id="87d2d-261">Une instance DDEML est basée sur un thread, associée au thread qui a appelé **DdeInitialize**.</span><span class="sxs-lookup"><span data-stu-id="87d2d-261">A DDEML instance is thread-based, associated with the thread that called **DdeInitialize**.</span></span>

<span data-ttu-id="87d2d-262">Tous les appels de fonction DDEML pour les objets appartenant à une instance DDEML doivent être effectués à partir du même thread que celui qui a appelé [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) pour créer l’instance.</span><span class="sxs-lookup"><span data-stu-id="87d2d-262">All DDEML function calls for objects belonging to a DDEML instance must be made from the same thread that called [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) to create the instance.</span></span> <span data-ttu-id="87d2d-263">Si vous appelez une fonction DDEML à partir d’un autre thread, la fonction échoue.</span><span class="sxs-lookup"><span data-stu-id="87d2d-263">If you call a DDEML function from a different thread, the function will fail.</span></span> <span data-ttu-id="87d2d-264">Vous ne pouvez pas accéder à une conversation DDEML à partir d’un thread autre que celui qui a alloué la conversation.</span><span class="sxs-lookup"><span data-stu-id="87d2d-264">You cannot access a DDEML conversation from a thread other than the one that allocated the conversation.</span></span>

 

