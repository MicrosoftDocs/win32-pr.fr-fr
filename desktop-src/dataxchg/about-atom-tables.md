---
title: À propos des tables Atom
description: Cette section traite des tables Atom.
ms.assetid: 12114a3e-99a4-480f-9d1a-57c1942b7382
keywords:
- atomes
- tables Atom
- noms Atom
- Échange dynamique de données (DDE), atomes
- DDE (échange dynamique de données), atomes
- tables Atom globales
- tables Atom locales
- atomes d’entiers
- atomes de chaînes
ms.topic: article
ms.date: 08/25/2020
ms.openlocfilehash: 92a8304e1e96c7385ddb11ba6391258acbe62a26
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/27/2021
ms.locfileid: "110549604"
---
# <a name="about-atom-tables"></a><span data-ttu-id="6a33e-112">À propos des tables Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-112">About Atom Tables</span></span>

<span data-ttu-id="6a33e-113">Une *table Atom* est une table définie par le système qui stocke des chaînes et des identificateurs correspondants.</span><span class="sxs-lookup"><span data-stu-id="6a33e-113">An *atom table* is a system-defined table that stores strings and corresponding identifiers.</span></span> <span data-ttu-id="6a33e-114">Une application place une chaîne dans une table Atom et reçoit un entier 16 bits, appelé *Atom*, qui peut être utilisé pour accéder à la chaîne.</span><span class="sxs-lookup"><span data-stu-id="6a33e-114">An application places a string in an atom table and receives a 16-bit integer, called an *atom*, that can be used to access the string.</span></span> <span data-ttu-id="6a33e-115">Une chaîne placée dans une table Atom est appelée un *nom Atom*.</span><span class="sxs-lookup"><span data-stu-id="6a33e-115">A string that has been placed in an atom table is called an *atom name*.</span></span>

<span data-ttu-id="6a33e-116">Le système fournit un certain nombre de tables Atom.</span><span class="sxs-lookup"><span data-stu-id="6a33e-116">The system provides a number of atom tables.</span></span> <span data-ttu-id="6a33e-117">Chaque table Atom remplit un rôle différent.</span><span class="sxs-lookup"><span data-stu-id="6a33e-117">Each atom table serves a different purpose.</span></span> <span data-ttu-id="6a33e-118">Par exemple, les applications échange dynamique de données (DDE) utilisent la [table Atom globale](#global-atom-table) pour partager des chaînes nom d’élément et nom de rubrique avec d’autres applications.</span><span class="sxs-lookup"><span data-stu-id="6a33e-118">For example, Dynamic Data Exchange (DDE) applications use the [global atom table](#global-atom-table) to share item-name and topic-name strings with other applications.</span></span> <span data-ttu-id="6a33e-119">Au lieu de passer des chaînes réelles, une application DDE transmet des atomes globaux à son application partenaire.</span><span class="sxs-lookup"><span data-stu-id="6a33e-119">Rather than passing actual strings, a DDE application passes global atoms to its partner application.</span></span> <span data-ttu-id="6a33e-120">Le partenaire utilise les atomes pour obtenir les chaînes de la table Atom.</span><span class="sxs-lookup"><span data-stu-id="6a33e-120">The partner uses the atoms to obtain the strings from the atom table.</span></span>

<span data-ttu-id="6a33e-121">Les applications peuvent utiliser des tables Atom locales pour stocker leurs propres associations nom-élément.</span><span class="sxs-lookup"><span data-stu-id="6a33e-121">Applications can use local atom tables to store their own item-name associations.</span></span>

<span data-ttu-id="6a33e-122">Le système utilise des tables Atom qui ne sont pas directement accessibles aux applications.</span><span class="sxs-lookup"><span data-stu-id="6a33e-122">The system uses atom tables that are not directly accessible to applications.</span></span> <span data-ttu-id="6a33e-123">Toutefois, l’application utilise ces atomes lors de l’appel d’une variété de fonctions.</span><span class="sxs-lookup"><span data-stu-id="6a33e-123">However, the application uses these atoms when calling a variety of functions.</span></span> <span data-ttu-id="6a33e-124">Par exemple, les formats de presse-papiers inscrits sont stockés dans une table Atom interne utilisée par le système.</span><span class="sxs-lookup"><span data-stu-id="6a33e-124">For example, registered clipboard formats are stored in an internal atom table used by the system.</span></span> <span data-ttu-id="6a33e-125">Une application ajoute des atomes à cette table Atom à l’aide de la fonction [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) .</span><span class="sxs-lookup"><span data-stu-id="6a33e-125">An application adds atoms to this atom table using the [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) function.</span></span> <span data-ttu-id="6a33e-126">En outre, les classes inscrites sont stockées dans une table Atom interne utilisée par le système.</span><span class="sxs-lookup"><span data-stu-id="6a33e-126">Also, registered classes are stored in an internal atom table used by the system.</span></span> <span data-ttu-id="6a33e-127">Une application ajoute des atomes à cette table Atom à l’aide de la fonction [**registerClass**](/windows/desktop/api/winuser/nf-winuser-registerclassa) ou [**RegisterClassEx**](/windows/desktop/api/winuser/nf-winuser-registerclassexa) .</span><span class="sxs-lookup"><span data-stu-id="6a33e-127">An application adds atoms to this atom table using the [**RegisterClass**](/windows/desktop/api/winuser/nf-winuser-registerclassa) or [**RegisterClassEx**](/windows/desktop/api/winuser/nf-winuser-registerclassexa) function.</span></span>

<span data-ttu-id="6a33e-128">Les rubriques suivantes sont présentées dans cette section.</span><span class="sxs-lookup"><span data-stu-id="6a33e-128">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="6a33e-129">Table Atom globale</span><span class="sxs-lookup"><span data-stu-id="6a33e-129">Global Atom Table</span></span>](#global-atom-table)
-   [<span data-ttu-id="6a33e-130">Table Atom utilisateur</span><span class="sxs-lookup"><span data-stu-id="6a33e-130">User Atom Table</span></span>](#user-atom-table)
-   [<span data-ttu-id="6a33e-131">Tables Atom locales</span><span class="sxs-lookup"><span data-stu-id="6a33e-131">Local Atom Tables</span></span>](#local-atom-tables)
-   [<span data-ttu-id="6a33e-132">Types Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-132">Atom Types</span></span>](#atom-types)
    -   [<span data-ttu-id="6a33e-133">Atomes de chaînes</span><span class="sxs-lookup"><span data-stu-id="6a33e-133">String Atoms</span></span>](#string-atoms)
    -   [<span data-ttu-id="6a33e-134">Atomes d’entiers</span><span class="sxs-lookup"><span data-stu-id="6a33e-134">Integer Atoms</span></span>](#integer-atoms)
-   [<span data-ttu-id="6a33e-135">Création et nombre d’utilisations Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-135">Atom Creation and Usage Count</span></span>](#atom-creation-and-usage-count)
-   [<span data-ttu-id="6a33e-136">Requêtes de table Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-136">Atom-Table Queries</span></span>](#atom-table-queries)
-   [<span data-ttu-id="6a33e-137">Formats de chaîne Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-137">Atom String Formats</span></span>](#atom-string-formats)

## <a name="global-atom-table"></a><span data-ttu-id="6a33e-138">Table Atom globale</span><span class="sxs-lookup"><span data-stu-id="6a33e-138">Global Atom Table</span></span>

<span data-ttu-id="6a33e-139">La table Atom globale est disponible pour toutes les applications.</span><span class="sxs-lookup"><span data-stu-id="6a33e-139">The global atom table is available to all applications.</span></span> <span data-ttu-id="6a33e-140">Quand une application place une chaîne dans la table Atom globale, le système génère un Atom qui est unique dans l’ensemble du système.</span><span class="sxs-lookup"><span data-stu-id="6a33e-140">When an application places a string in the global atom table, the system generates an atom that is unique throughout the system.</span></span> <span data-ttu-id="6a33e-141">Toute application qui a l’atome peut obtenir la chaîne qu’elle identifie en interrogeant la table Atom globale.</span><span class="sxs-lookup"><span data-stu-id="6a33e-141">Any application that has the atom can obtain the string it identifies by querying the global atom table.</span></span>

<span data-ttu-id="6a33e-142">Une application qui définit un format de données DDE privé pour le partage de données avec d’autres applications doit placer le nom de format dans la table Atom globale.</span><span class="sxs-lookup"><span data-stu-id="6a33e-142">An application that defines a private DDE-data format for sharing data with other applications should place the format name in the global atom table.</span></span> <span data-ttu-id="6a33e-143">Cette technique évite les conflits avec les noms de formats définis par le système ou par d’autres applications, et rend les identificateurs (atomes) des messages ou des formats disponibles pour les autres applications.</span><span class="sxs-lookup"><span data-stu-id="6a33e-143">This technique prevents conflicts with the names of formats defined by the system or by other applications, and makes the identifiers (atoms) for the messages or formats available to the other applications.</span></span>

## <a name="user-atom-table"></a><span data-ttu-id="6a33e-144">Table Atom utilisateur</span><span class="sxs-lookup"><span data-stu-id="6a33e-144">User Atom Table</span></span>

<span data-ttu-id="6a33e-145">En plus de la table Atom globale, la table Atom de l’utilisateur est une autre table d’Atoms système qui est également partagée entre tous les processus.</span><span class="sxs-lookup"><span data-stu-id="6a33e-145">In addition to the global atom table, the user atom table is another system atom table that is also shared across all processes.</span></span> <span data-ttu-id="6a33e-146">La table Atom utilisateur est utilisée pour un petit nombre de scénarios internes à Win32k ; par exemple, les noms de modules Windows, les chaînes connues dans Win32k, les formats OLE, etc. Bien que les applications n’interagissent pas directement avec la table Atom utilisateur, elles appellent plusieurs API, telles que [registerClass](/windows/win32/api/winuser/nf-winuser-registerclassexa), [RegisterWindowMessage](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea)et [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata), qui ajoutent des entrées à la table Atom de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6a33e-146">The user atom table is used for a small number of scenarios internal to win32k; for example, windows module names, well known strings in win32k, OLE formats, etc. Although applications do not interact with the user atom table directly, they call several APIs—such as [RegisterClass](/windows/win32/api/winuser/nf-winuser-registerclassexa), [RegisterWindowMessage](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea), and [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata)—that add entries to the user atom table.</span></span> <span data-ttu-id="6a33e-147">Les entrées ajoutées par `RegisterClass` peuvent être supprimées par `UnregisterClass` .</span><span class="sxs-lookup"><span data-stu-id="6a33e-147">The entries added by `RegisterClass` can be deleted by `UnregisterClass`.</span></span> <span data-ttu-id="6a33e-148">Toutefois, les entrées ajoutées par `RegisterWindowMessage` et `RegisterClipboardFormat` ne sont pas supprimées tant que la session n’est pas terminée.</span><span class="sxs-lookup"><span data-stu-id="6a33e-148">However, the entries added by `RegisterWindowMessage` and `RegisterClipboardFormat` do not get deleted until the session ends.</span></span> <span data-ttu-id="6a33e-149">Si la table Atom de l’utilisateur n’a plus d’espace et que la chaîne passée n’est pas déjà dans la table, l’appel échoue.</span><span class="sxs-lookup"><span data-stu-id="6a33e-149">If the user atom table has no more space and the string being passed in is not already in the table, the call will fail.</span></span> 

### <a name="atom-table-size"></a><span data-ttu-id="6a33e-150">Taille de la table Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-150">Atom Table Size</span></span>
 
<span data-ttu-id="6a33e-151">De nombreuses API critiques, y compris [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindowa), s’appuient sur les atomes utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6a33e-151">Many critical APIs, including [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindowa), rely on user atoms.</span></span> <span data-ttu-id="6a33e-152">Par conséquent, l’épuisement de l’espace dans la table Atom de l’utilisateur entraînera des problèmes graves. par exemple, le lancement de toutes les applications peut échouer.</span><span class="sxs-lookup"><span data-stu-id="6a33e-152">Therefore, space exhaustion in the user atom table will result in serious issues; for example, all applications may fail to launch.</span></span> <span data-ttu-id="6a33e-153">Voici quelques recommandations pour vous assurer que votre application utilise efficacement les tables Atom et préserve la fiabilité et les performances de l’application et du système :</span><span class="sxs-lookup"><span data-stu-id="6a33e-153">Here are some recommendations to ensure your application utilizes atom tables efficiently and preserves the reliability and performance of the application and system:</span></span>  

1. <span data-ttu-id="6a33e-154">Vous devez limiter l’utilisation de votre application par la table Atom utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6a33e-154">You should limit your app's usage of the user atom table.</span></span> <span data-ttu-id="6a33e-155">Le stockage de chaînes uniques à l’aide d’API telles que `RegisterClass` , `RegisterWindowMessage` ou `RegisterClipboardFormat` prend de l’espace dans la table Atom utilisateur, qui est utilisé globalement par d’autres applications pour inscrire des classes de fenêtre à l’aide de chaînes.</span><span class="sxs-lookup"><span data-stu-id="6a33e-155">Storing unique strings using APIs like `RegisterClass`, `RegisterWindowMessage`, or `RegisterClipboardFormat` takes space in the user atom table, which is used globally by other apps to register window classes using strings.</span></span> <span data-ttu-id="6a33e-156">Si possible, vous devez utiliser [AddAtom](/windows/desktop/api/Winbase/nf-winbase-addatomw) / [DeleteAtom](/windows/desktop/api/Winbase/nf-winbase-deleteatom) pour stocker des chaînes dans une table Atom locale, ou [GlobalAddAtom](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma) / [GlobalDeleteAtom](/windows/desktop/api/Winbase/nf-winbase-globaldeleteatom) si les atomes sont nécessaires entre processus.</span><span class="sxs-lookup"><span data-stu-id="6a33e-156">If at all possible, you should use [AddAtom](/windows/desktop/api/Winbase/nf-winbase-addatomw)/[DeleteAtom](/windows/desktop/api/Winbase/nf-winbase-deleteatom) to store strings in a local atom table, or  [GlobalAddAtom](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma)/[GlobalDeleteAtom](/windows/desktop/api/Winbase/nf-winbase-globaldeleteatom) if the atoms are needed cross-process.</span></span>

1. <span data-ttu-id="6a33e-157">En cas de problème au niveau de l’application provoquant des problèmes de table Atom utilisateur, vous pouvez examiner la cause racine en connectant le débogueur du noyau et en révisant le processus lors des appels à `UserAddAtomEx` ( `bae1 win32kbase!UserAddAtomEx /p <eprocess> "kc10;g"` ).</span><span class="sxs-lookup"><span data-stu-id="6a33e-157">If there is concern about the application causing user atom table issues, you can investigate the root cause by connecting the kernel debugger and breaking into the process on calls to `UserAddAtomEx` (`bae1 win32kbase!UserAddAtomEx /p <eprocess> "kc10;g"`).</span></span> <span data-ttu-id="6a33e-158">Recherchez `user32!` sur la pile des appels pour voir l’API appelée.</span><span class="sxs-lookup"><span data-stu-id="6a33e-158">Look for `user32!` on the callstack to see which API is being called.</span></span> <span data-ttu-id="6a33e-159">La méthodologie est similaire à la détection globale des problèmes liés aux tables Atom, décrite dans [identification des fuites de tables Atom globales](/archive/blogs/ntdebugging/identifying-global-atom-table-leaks).</span><span class="sxs-lookup"><span data-stu-id="6a33e-159">The methodology is similar to the global atom table issue detection explained in [Identifying Global Atom Table Leaks](/archive/blogs/ntdebugging/identifying-global-atom-table-leaks).</span></span> <span data-ttu-id="6a33e-160">Pour vider le contenu de la table Atom utilisateur, vous pouvez également appeler [GetClipboardFormatName](/windows/win32/api/winuser/nf-winuser-getclipboardformatnamea) sur la plage d’atomes possibles de 0XC000 à 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="6a33e-160">Another way to dump the contents of the user atom table is by calling [GetClipboardFormatName](/windows/win32/api/winuser/nf-winuser-getclipboardformatnamea) over the range of possible atoms from 0xC000 to 0xFFFF.</span></span> <span data-ttu-id="6a33e-161">Si le nombre total d’atomes augmente régulièrement pendant que l’application est en cours d’exécution ou ne retourne pas à la ligne de base lorsque l’application est fermée, il y a un problème.</span><span class="sxs-lookup"><span data-stu-id="6a33e-161">If the total atom count steadily goes up while the application is running or does not return to baseline when the app is closed, there is a problem.</span></span>

## <a name="local-atom-tables"></a><span data-ttu-id="6a33e-162">Tables Atom locales</span><span class="sxs-lookup"><span data-stu-id="6a33e-162">Local Atom Tables</span></span>

<span data-ttu-id="6a33e-163">Une application peut utiliser une table Atom locale pour gérer efficacement un grand nombre de chaînes utilisées uniquement dans l’application.</span><span class="sxs-lookup"><span data-stu-id="6a33e-163">An application can use a local atom table to efficiently manage a large number of strings used only within the application.</span></span> <span data-ttu-id="6a33e-164">Ces chaînes, ainsi que les atomes associés, sont uniquement disponibles pour l’application qui a créé la table.</span><span class="sxs-lookup"><span data-stu-id="6a33e-164">These strings, and the associated atoms, are available only to the application that created the table.</span></span>

<span data-ttu-id="6a33e-165">Une application nécessitant la même chaîne dans plusieurs structures peut réduire l’utilisation de la mémoire à l’aide d’une table Atom locale.</span><span class="sxs-lookup"><span data-stu-id="6a33e-165">An application requiring the same string in a number of structures can reduce memory usage by using a local atom table.</span></span> <span data-ttu-id="6a33e-166">Au lieu de copier la chaîne dans chaque structure, l’application peut placer la chaîne dans la table Atom et inclure l’atome résultant dans les structures.</span><span class="sxs-lookup"><span data-stu-id="6a33e-166">Rather than copying the string into each structure, the application can place the string in the atom table and include the resulting atom in the structures.</span></span> <span data-ttu-id="6a33e-167">De cette façon, une chaîne apparaît une seule fois en mémoire, mais peut être utilisée plusieurs fois dans l’application.</span><span class="sxs-lookup"><span data-stu-id="6a33e-167">In this way, a string appears only once in memory but can be used many times in the application.</span></span>

<span data-ttu-id="6a33e-168">Les applications peuvent également utiliser des tables Atom locales pour gagner du temps lors de la recherche d’une chaîne particulière.</span><span class="sxs-lookup"><span data-stu-id="6a33e-168">Applications can also use local atom tables to save time when searching for a particular string.</span></span> <span data-ttu-id="6a33e-169">Pour effectuer une recherche, une application doit uniquement placer la chaîne de recherche dans la table Atom et comparer l’atome résultant avec les atomes dans les structures pertinentes.</span><span class="sxs-lookup"><span data-stu-id="6a33e-169">To perform a search, an application need only place the search string in the atom table and compare the resulting atom with the atoms in the relevant structures.</span></span> <span data-ttu-id="6a33e-170">La comparaison des atomes est généralement plus rapide que la comparaison de chaînes.</span><span class="sxs-lookup"><span data-stu-id="6a33e-170">Comparing atoms is typically faster than comparing strings.</span></span>

<span data-ttu-id="6a33e-171">Les tables Atom sont implémentées en tant que tables de hachage.</span><span class="sxs-lookup"><span data-stu-id="6a33e-171">Atom tables are implemented as hash tables.</span></span> <span data-ttu-id="6a33e-172">Par défaut, une table Atom locale utilise des compartiments 37 pour sa table de hachage.</span><span class="sxs-lookup"><span data-stu-id="6a33e-172">By default, a local atom table uses 37 buckets for its hash table.</span></span> <span data-ttu-id="6a33e-173">Toutefois, vous pouvez modifier le nombre de compartiments utilisés en appelant la fonction [**InitAtomTable**](/windows/desktop/api/Winbase/nf-winbase-initatomtable) .</span><span class="sxs-lookup"><span data-stu-id="6a33e-173">However, you can change the number of buckets used by calling the [**InitAtomTable**](/windows/desktop/api/Winbase/nf-winbase-initatomtable) function.</span></span> <span data-ttu-id="6a33e-174">Toutefois, si l’application appelle **InitAtomTable**, elle doit le faire avant d’appeler d’autres fonctions de gestion Atom.</span><span class="sxs-lookup"><span data-stu-id="6a33e-174">If the application calls **InitAtomTable**, however, it must do so before calling any other atom-management functions.</span></span>

## <a name="atom-types"></a><span data-ttu-id="6a33e-175">Types Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-175">Atom Types</span></span>

<span data-ttu-id="6a33e-176">Les applications peuvent créer deux types d’atomes : les atomes de chaînes et les atomes d’entiers.</span><span class="sxs-lookup"><span data-stu-id="6a33e-176">Applications can create two types of atoms: string atoms and integer atoms.</span></span> <span data-ttu-id="6a33e-177">Les valeurs des atomes d’entiers et des atomes de chaînes ne se chevauchent pas. par conséquent, les deux types d’atomes peuvent être utilisés dans le même bloc de code.</span><span class="sxs-lookup"><span data-stu-id="6a33e-177">The values of integer atoms and string atoms do not overlap, so both types of atoms can be used in the same block of code.</span></span>

<span data-ttu-id="6a33e-178">Plusieurs fonctions acceptent des chaînes ou des atomes en tant que paramètres.</span><span class="sxs-lookup"><span data-stu-id="6a33e-178">Several functions accept either strings or atoms as parameters.</span></span> <span data-ttu-id="6a33e-179">Lors du passage d’un Atom à ces fonctions, une application peut utiliser la macro [**MAKEINTATOM**](/windows/desktop/api/Winbase/nf-winbase-makeintatom) pour convertir l’atome en un format qui peut être utilisé par la fonction.</span><span class="sxs-lookup"><span data-stu-id="6a33e-179">When passing an atom to these functions, an application can use the [**MAKEINTATOM**](/windows/desktop/api/Winbase/nf-winbase-makeintatom) macro to convert the atom into a form that can be used by the function.</span></span>

<span data-ttu-id="6a33e-180">Les sections suivantes décrivent les types Atom.</span><span class="sxs-lookup"><span data-stu-id="6a33e-180">The following sections describe atom types.</span></span>

-   [<span data-ttu-id="6a33e-181">Atomes de chaînes</span><span class="sxs-lookup"><span data-stu-id="6a33e-181">String Atoms</span></span>](#string-atoms)
-   [<span data-ttu-id="6a33e-182">Atomes d’entiers</span><span class="sxs-lookup"><span data-stu-id="6a33e-182">Integer Atoms</span></span>](#integer-atoms)

### <a name="string-atoms"></a><span data-ttu-id="6a33e-183">Atomes de chaînes</span><span class="sxs-lookup"><span data-stu-id="6a33e-183">String Atoms</span></span>

<span data-ttu-id="6a33e-184">Lorsque les applications passent des chaînes terminées par un caractère NULL aux fonctions [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma), [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw), [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma)et [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma) , elles reçoivent des *atomes de chaînes* (entiers 16 bits) en retour.</span><span class="sxs-lookup"><span data-stu-id="6a33e-184">When applications pass null-terminated strings to the [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma), [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw), [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma), and [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma) functions, they receive *string atoms* (16-bit integers) in return.</span></span> <span data-ttu-id="6a33e-185">Les atomes de chaînes ont les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="6a33e-185">String atoms have the following properties:</span></span>

-   <span data-ttu-id="6a33e-186">Les valeurs des atomes de chaînes se trouvent dans la plage 0xC000 (MAXINTATOM) à 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="6a33e-186">The values of string atoms are in the range 0xC000 (MAXINTATOM) through 0xFFFF.</span></span>
-   <span data-ttu-id="6a33e-187">La casse n’est pas significative dans les recherches d’un nom Atom dans une table Atom.</span><span class="sxs-lookup"><span data-stu-id="6a33e-187">Case is not significant in searches for an atom name in an atom table.</span></span> <span data-ttu-id="6a33e-188">En outre, l’ensemble de la chaîne doit correspondre dans une opération de recherche ; aucune correspondance de sous-chaîne n’est effectuée.</span><span class="sxs-lookup"><span data-stu-id="6a33e-188">Also, the entire string must match in a search operation; no substring matching is performed.</span></span>
-   <span data-ttu-id="6a33e-189">La taille de la chaîne associée à un Atom de chaîne ne peut pas dépasser 255 octets.</span><span class="sxs-lookup"><span data-stu-id="6a33e-189">The string associated with a string atom can be no more than 255 bytes in size.</span></span> <span data-ttu-id="6a33e-190">Cette limitation s’applique à toutes les fonctions Atom.</span><span class="sxs-lookup"><span data-stu-id="6a33e-190">This limitation applies to all atom functions.</span></span>
-   <span data-ttu-id="6a33e-191">Un *nombre de références* est associé à chaque nom Atom.</span><span class="sxs-lookup"><span data-stu-id="6a33e-191">A *reference count* is associated with each atom name.</span></span> <span data-ttu-id="6a33e-192">Le nombre est incrémenté chaque fois que le nom Atom est ajouté à la table et décrémenté chaque fois que le nom Atom est supprimé de celui-ci.</span><span class="sxs-lookup"><span data-stu-id="6a33e-192">The count is incremented each time the atom name is added to the table and decremented each time the atom name is deleted from it.</span></span> <span data-ttu-id="6a33e-193">Cela empêche que différents utilisateurs du même atome de chaîne détruisent les noms Atom de l’autre.</span><span class="sxs-lookup"><span data-stu-id="6a33e-193">This prevents different users of the same string atom from destroying each other's atom names.</span></span> <span data-ttu-id="6a33e-194">Lorsque le nombre de références pour un nom Atom est égal à zéro, le système supprime l’atome et le nom Atom de la table.</span><span class="sxs-lookup"><span data-stu-id="6a33e-194">When the reference count for an atom name equals zero, the system removes the atom and the atom name from the table.</span></span>

### <a name="integer-atoms"></a><span data-ttu-id="6a33e-195">Atomes d’entiers</span><span class="sxs-lookup"><span data-stu-id="6a33e-195">Integer Atoms</span></span>

<span data-ttu-id="6a33e-196">Les atomes d’entiers diffèrent des atomes de chaînes des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="6a33e-196">Integer atoms differ from string atoms in the following ways:</span></span>

-   <span data-ttu-id="6a33e-197">Les valeurs des atomes d’entiers se trouvent dans la plage 0x0001 à 0xBFFF (**MAXINTATOM**– 1).</span><span class="sxs-lookup"><span data-stu-id="6a33e-197">The values of integer atoms are in the range 0x0001 through 0xBFFF (**MAXINTATOM**– 1).</span></span>
-   <span data-ttu-id="6a33e-198">La représentation sous forme de chaîne d’un Atom entier est \# *dddd*, où les valeurs représentées par *dddd* sont des chiffres décimaux.</span><span class="sxs-lookup"><span data-stu-id="6a33e-198">The string representation of an integer atom is \#*dddd*, where the values represented by *dddd* are decimal digits.</span></span> <span data-ttu-id="6a33e-199">Les zéros non significatifs sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="6a33e-199">Leading zeros are ignored.</span></span>
-   <span data-ttu-id="6a33e-200">Aucun nombre de références ou surcharge de stockage n’est associé à un Atom entier.</span><span class="sxs-lookup"><span data-stu-id="6a33e-200">There is no reference count or storage overhead associated with an integer atom.</span></span>

## <a name="atom-creation-and-usage-count"></a><span data-ttu-id="6a33e-201">Création et nombre d’utilisations Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-201">Atom Creation and Usage Count</span></span>

<span data-ttu-id="6a33e-202">Une application crée un Atom local en appelant la fonction [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw) ; elle crée un atome global en appelant la fonction [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma) .</span><span class="sxs-lookup"><span data-stu-id="6a33e-202">An application creates a local atom by calling the [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw) function; it creates a global atom by calling the [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma) function.</span></span> <span data-ttu-id="6a33e-203">Les deux fonctions requièrent un pointeur vers une chaîne.</span><span class="sxs-lookup"><span data-stu-id="6a33e-203">Both functions require a pointer to a string.</span></span> <span data-ttu-id="6a33e-204">Le système recherche la chaîne dans la table Atom appropriée et retourne l’atome correspondant à l’application.</span><span class="sxs-lookup"><span data-stu-id="6a33e-204">The system searches the appropriate atom table for the string and returns the corresponding atom to the application.</span></span> <span data-ttu-id="6a33e-205">Dans le cas d’un Atom de chaîne, si la chaîne réside déjà dans la table Atom, le système incrémente le nombre de références pour la chaîne pendant ce processus.</span><span class="sxs-lookup"><span data-stu-id="6a33e-205">In the case of a string atom, if the string already resides in the atom table, the system increments the reference count for the string during this process.</span></span>

<span data-ttu-id="6a33e-206">Les appels répétés pour ajouter le même nom Atom retournent le même Atom.</span><span class="sxs-lookup"><span data-stu-id="6a33e-206">Repeated calls to add the same atom name return the same atom.</span></span> <span data-ttu-id="6a33e-207">Si le nom Atom n’existe pas dans la table quand [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw) est appelé, le nom Atom est ajouté à la table et un nouvel atome est retourné.</span><span class="sxs-lookup"><span data-stu-id="6a33e-207">If the atom name does not exist in the table when [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw) is called, the atom name is added to the table and a new atom is returned.</span></span> <span data-ttu-id="6a33e-208">S’il s’agit d’un Atom de chaîne, son décompte de références est également défini sur un.</span><span class="sxs-lookup"><span data-stu-id="6a33e-208">If it is a string atom, its reference count is also set to one.</span></span>

<span data-ttu-id="6a33e-209">Une application doit appeler la fonction [**DeleteAtom**](/windows/desktop/api/Winbase/nf-winbase-deleteatom) lorsqu’elle n’a plus besoin d’utiliser un Atom local ; elle doit appeler la fonction [**GlobalDeleteAtom**](/windows/desktop/api/Winbase/nf-winbase-globaldeleteatom) lorsqu’elle n’a plus besoin d’un atome global.</span><span class="sxs-lookup"><span data-stu-id="6a33e-209">An application should call the [**DeleteAtom**](/windows/desktop/api/Winbase/nf-winbase-deleteatom) function when it no longer needs to use a local atom; it should call the [**GlobalDeleteAtom**](/windows/desktop/api/Winbase/nf-winbase-globaldeleteatom) function when it no longer needs a global atom.</span></span> <span data-ttu-id="6a33e-210">Dans le cas d’un atome de chaîne, l’une de ces fonctions réduit d’une unité le décompte de références de l’atome correspondant.</span><span class="sxs-lookup"><span data-stu-id="6a33e-210">In the case of a string atom, either of these functions reduces the reference count of the corresponding atom by one.</span></span> <span data-ttu-id="6a33e-211">Lorsque le nombre de références atteint zéro, le système supprime le nom Atom de la table.</span><span class="sxs-lookup"><span data-stu-id="6a33e-211">When the reference count reaches zero, the system deletes the atom name from the table.</span></span>

<span data-ttu-id="6a33e-212">Le nom Atom d’un Atom de chaîne reste dans la table Atom globale tant que son décompte de références est supérieur à zéro, même après que l’application qui l’a placé dans la table se termine.</span><span class="sxs-lookup"><span data-stu-id="6a33e-212">The atom name of a string atom remains in the global atom table as long as its reference count is greater than zero, even after the application that placed it in the table terminates.</span></span> <span data-ttu-id="6a33e-213">Une table Atom locale est détruite lorsque l’application associée se termine, quel que soit le nombre de références des atomes de la table.</span><span class="sxs-lookup"><span data-stu-id="6a33e-213">A local atom table is destroyed when the associated application terminates, regardless of the reference counts of the atoms in the table.</span></span>

## <a name="atom-table-queries"></a><span data-ttu-id="6a33e-214">Requêtes Atom-Table</span><span class="sxs-lookup"><span data-stu-id="6a33e-214">Atom-Table Queries</span></span>

<span data-ttu-id="6a33e-215">Une application peut déterminer si une chaîne particulière figure déjà dans une table Atom à l’aide de la fonction [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma) ou [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma) .</span><span class="sxs-lookup"><span data-stu-id="6a33e-215">An application can determine whether a particular string is already in an atom table by using the [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma) or [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma) function.</span></span> <span data-ttu-id="6a33e-216">Ces fonctions recherchent dans une table Atom la chaîne spécifiée et, si la chaîne y figure, retournent l’atome correspondant.</span><span class="sxs-lookup"><span data-stu-id="6a33e-216">These functions search an atom table for the specified string and, if the string is there, return the corresponding atom.</span></span>

<span data-ttu-id="6a33e-217">Une application peut utiliser la fonction [**GetAtomName**](/windows/desktop/api/Winbase/nf-winbase-getatomnamea) ou [**GlobalGetAtomName**](/windows/desktop/api/Winbase/nf-winbase-globalgetatomnamea) pour extraire une chaîne de nom Atom d’une table Atom, à condition que l’atome corresponde à la chaîne recherchée.</span><span class="sxs-lookup"><span data-stu-id="6a33e-217">An application can use the [**GetAtomName**](/windows/desktop/api/Winbase/nf-winbase-getatomnamea) or [**GlobalGetAtomName**](/windows/desktop/api/Winbase/nf-winbase-globalgetatomnamea) function to retrieve an atom-name string from an atom table, provided the application has the atom corresponding to the string being sought.</span></span> <span data-ttu-id="6a33e-218">Les deux fonctions copient la chaîne Atom-Name de l’Atom spécifié dans une mémoire tampon et retournent la longueur de la chaîne qui a été copiée.</span><span class="sxs-lookup"><span data-stu-id="6a33e-218">Both functions copy the atom-name string of the specified atom to a buffer and return the length of the string that was copied.</span></span> <span data-ttu-id="6a33e-219">**GetAtomName** récupère une chaîne de nom Atom à partir d’une table Atom locale et **GlobalGetAtomName** récupère une chaîne de nom Atom à partir de la table Atom globale.</span><span class="sxs-lookup"><span data-stu-id="6a33e-219">**GetAtomName** retrieves an atom-name string from a local atom table, and **GlobalGetAtomName** retrieves an atom-name string from the global atom table.</span></span>

## <a name="atom-string-formats"></a><span data-ttu-id="6a33e-220">Formats de chaîne Atom</span><span class="sxs-lookup"><span data-stu-id="6a33e-220">Atom String Formats</span></span>

<span data-ttu-id="6a33e-221">Les fonctions [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw), [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma), [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma)et [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma) prennent un pointeur vers une chaîne terminée par le caractère null.</span><span class="sxs-lookup"><span data-stu-id="6a33e-221">The [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw), [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma), [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma), and [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma) functions take a pointer to a null-terminated string.</span></span> <span data-ttu-id="6a33e-222">Une application peut spécifier ce pointeur de l’une des manières suivantes.</span><span class="sxs-lookup"><span data-stu-id="6a33e-222">An application can specify this pointer in one of the following ways.</span></span>



|     <span data-ttu-id="6a33e-223">Format chaîne</span><span class="sxs-lookup"><span data-stu-id="6a33e-223">String format</span></span>               |    <span data-ttu-id="6a33e-224">Description</span><span class="sxs-lookup"><span data-stu-id="6a33e-224">Description</span></span>                                                                                                |
|--------------------|----------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6a33e-225">\#*jjjj*</span><span class="sxs-lookup"><span data-stu-id="6a33e-225">\#*dddd*</span></span>           | <span data-ttu-id="6a33e-226">Entier spécifié comme une chaîne décimale.</span><span class="sxs-lookup"><span data-stu-id="6a33e-226">An integer specified as a decimal string.</span></span> <span data-ttu-id="6a33e-227">Utilisé pour créer ou Rechercher un Atom entier.</span><span class="sxs-lookup"><span data-stu-id="6a33e-227">Used to create or find an integer atom.</span></span>                  |
| <span data-ttu-id="6a33e-228">*nom Atom de chaîne*</span><span class="sxs-lookup"><span data-stu-id="6a33e-228">*string atom name*</span></span> | <span data-ttu-id="6a33e-229">Nom Atom de chaîne.</span><span class="sxs-lookup"><span data-stu-id="6a33e-229">A string atom name.</span></span> <span data-ttu-id="6a33e-230">Permet d’ajouter un nom Atom de chaîne à une table Atom et de recevoir un Atom en retour.</span><span class="sxs-lookup"><span data-stu-id="6a33e-230">Used to add a string atom name to an atom table and receive an atom in return.</span></span> |



 

 

 
