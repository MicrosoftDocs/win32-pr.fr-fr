---
title: Vue d’ensemble de l’API serveur HTTP
description: Cette rubrique identifie une séquence typique d’opérations qui utilisent l’API du serveur HTTP.
ms.assetid: 1245fd98-8370-4f1b-8c86-de9be5e678bd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5c99af3e4914c5496c2adea10b3ac658f75f3018
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "106518004"
---
# <a name="http-server-api-overview"></a><span data-ttu-id="34759-103">Vue d’ensemble de l’API serveur HTTP</span><span class="sxs-lookup"><span data-stu-id="34759-103">HTTP Server API Overview</span></span>

<span data-ttu-id="34759-104">La liste suivante identifie une séquence typique d’opérations qui utilisent l’API du serveur HTTP :</span><span class="sxs-lookup"><span data-stu-id="34759-104">The following list identifies a typical sequence of operations that use the HTTP Server API:</span></span>

-   <span data-ttu-id="34759-105">Initialisez l’API du serveur HTTP à l’aide de la fonction [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) .</span><span class="sxs-lookup"><span data-stu-id="34759-105">Initialize the HTTP Server API by using the [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) function.</span></span>
-   <span data-ttu-id="34759-106">Créez une file d’attente de demandes à l’aide de la fonction [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle) .</span><span class="sxs-lookup"><span data-stu-id="34759-106">Create a request queue by using the [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle) function.</span></span>
-   <span data-ttu-id="34759-107">Inscrire une ou plusieurs URL à l’aide de la fonction [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) .</span><span class="sxs-lookup"><span data-stu-id="34759-107">Register one or more URLs by using the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span>
-   <span data-ttu-id="34759-108">Recevez les demandes entrantes dirigées vers les URL inscrites à l’aide de la fonction [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) et envoyez des réponses HTTP pour ces requêtes à l’aide de la fonction [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) .</span><span class="sxs-lookup"><span data-stu-id="34759-108">Receive incoming requests directed to registered URLs by using the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function, and send HTTP responses for these requests by using the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function.</span></span>
-   <span data-ttu-id="34759-109">Facultatif Lors de l’envoi d’une réponse, envoyez un corps d’entité supplémentaire à l’aide de la fonction [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="34759-109">(Optional) When sending a response, send an additional entity body by using the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span>
-   <span data-ttu-id="34759-110">Effectuez des opérations de nettoyage à l’aide des fonctions [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl), [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) et [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) .</span><span class="sxs-lookup"><span data-stu-id="34759-110">Perform clean-up operations by using the [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl), [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) and [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) functions.</span></span>

<span data-ttu-id="34759-111">Dans les opérations qui utilisent des URL, Notez qu’il s’agit de l’URL traitée contenue dans le membre **CookedUrl** de la structure de la [**\_ requête HTTP \_ v1**](/windows/desktop/api/Http/ns-http-http_request_v1) qui doit être utilisée.</span><span class="sxs-lookup"><span data-stu-id="34759-111">In operations that use URLs, note that it is the processed URL contained in the **CookedUrl** member of the [**HTTP\_REQUEST\_V1**](/windows/desktop/api/Http/ns-http-http_request_v1) structure that should be used.</span></span> <span data-ttu-id="34759-112">N’utilisez pas l’URL non traités dans le membre **pRawUrl** , qui est uniquement destiné au suivi et à des fins statistiques.</span><span class="sxs-lookup"><span data-stu-id="34759-112">Do not the unprocessed URL in the **pRawUrl** member, which is solely for tracking and statistical purposes.</span></span>

<span data-ttu-id="34759-113">Chaque application crée sa propre file d’attente de demandes.</span><span class="sxs-lookup"><span data-stu-id="34759-113">Each application creates its own request queue.</span></span> <span data-ttu-id="34759-114">Une application obtient son descripteur de file d’attente de requêtes à partir de [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span><span class="sxs-lookup"><span data-stu-id="34759-114">An application obtains its request queue handle from [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span></span> <span data-ttu-id="34759-115">Il transmet ce handle à la fonction [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) pour ajouter une URL à la file d’attente de demandes.</span><span class="sxs-lookup"><span data-stu-id="34759-115">It passes this handle to the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function to add a URL to the request queue.</span></span> <span data-ttu-id="34759-116">L’application reçoit la notification d’une demande entrante et la récupère à partir de la file d’attente des demandes en appelant la fonction [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) avec le descripteur de la file d’attente des demandes.</span><span class="sxs-lookup"><span data-stu-id="34759-116">The application receives notification of an incoming request, and retrieves it from the request queue by calling the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function with the request queue handle.</span></span> <span data-ttu-id="34759-117">Vous pouvez utiliser cette fonction pour recevoir les en-têtes de demande ou les en-têtes et le corps d’entité.</span><span class="sxs-lookup"><span data-stu-id="34759-117">You can use this function to receive either the request headers or both the headers and entity body.</span></span> <span data-ttu-id="34759-118">[**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) retourne également un identificateur de demande (RequestId) pour la demande reçue qui est unique pour le handle de demande.</span><span class="sxs-lookup"><span data-stu-id="34759-118">[**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) also returns a request identifier (RequestId) for the received request that is unique to the request handle.</span></span>

> [!Note]  
> <span data-ttu-id="34759-119">Il incombe à l’application d’examiner tous les en-têtes de requête pertinents, y compris les en-têtes Content-Negotiation s’ils sont utilisés, et de faire échouer les demandes en fonction du contenu d’en-tête.</span><span class="sxs-lookup"><span data-stu-id="34759-119">It is the application's responsibility to examine all relevant request headers, including content-negotiation headers if they are being used, and fail requests as appropriate based on header content.</span></span> <span data-ttu-id="34759-120">L’API du serveur HTTP garantit que chaque ligne d’en-tête est correctement terminée et ne contient pas de caractères non conformes.</span><span class="sxs-lookup"><span data-stu-id="34759-120">The HTTP Server API ensures only that each header line is properly terminated, and does not contain illegal characters.</span></span>

 

<span data-ttu-id="34759-121">Utilisez la fonction [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) avec le handle de la file d’attente des demandes pour récupérer les parties suivantes du corps d’entité d’une demande, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="34759-121">Use the [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) function with the request queue handle to retrieve subsequent portions of a request's entity body, if any.</span></span>

> [!Note]  
> <span data-ttu-id="34759-122">L’API du serveur HTTP décode les messages segmentés côté réception, mais n’effectue pas de codage mémorisé en bloc côté envoi.</span><span class="sxs-lookup"><span data-stu-id="34759-122">The HTTP Server API decodes chunked messages on the receive side, but does not perform chunked encoding on the send side.</span></span> <span data-ttu-id="34759-123">Si la segmentation est requise côté envoi, l’application doit l’implémenter.</span><span class="sxs-lookup"><span data-stu-id="34759-123">If chunking is required on the send side, the application must implement it.</span></span> <span data-ttu-id="34759-124">Pour plus d’informations sur l’encodage mémorisé en bloc, consultez [RFC 2616](https://www.ietf.org/rfc/rfc2616.txt).</span><span class="sxs-lookup"><span data-stu-id="34759-124">For more information about chunked encoding, see [RFC 2616](https://www.ietf.org/rfc/rfc2616.txt).</span></span>

 

<span data-ttu-id="34759-125">Utilisez la fonction [**HttpReceiveClientCertificate**](/windows/desktop/api/Http/nf-http-httpreceiveclientcertificate) avec des applications qui traitent des URL à l’aide d’un schéma sécurisé («**https**») pour récupérer éventuellement les informations de certificat du client.</span><span class="sxs-lookup"><span data-stu-id="34759-125">Use the [**HttpReceiveClientCertificate**](/windows/desktop/api/Http/nf-http-httpreceiveclientcertificate) function with applications that serve URLs by using a secure scheme ("**https**") to optionally retrieve the client's certificate information.</span></span>

<span data-ttu-id="34759-126">Les réponses sont envoyées avec la fonction [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) .</span><span class="sxs-lookup"><span data-stu-id="34759-126">Responses are sent with the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function.</span></span> <span data-ttu-id="34759-127">Cette fonction utilise l’ID de requête de la demande correspondante pour envoyer la réponse.</span><span class="sxs-lookup"><span data-stu-id="34759-127">This function uses the RequestId from the corresponding request to send the response.</span></span> <span data-ttu-id="34759-128">Une réponse peut être envoyée dans plusieurs appels d’API au fil du temps en appelant la fonction [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) avec RequestId à partir de la demande initialement reçue.</span><span class="sxs-lookup"><span data-stu-id="34759-128">A response can be sent in several API calls over time by calling the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function with the RequestId from the originally received request.</span></span>

> [!Note]  
> <span data-ttu-id="34759-129">Par défaut, [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) utilise « Microsoft-HTTPAPI/1.0 » comme en-tête « Server : ».</span><span class="sxs-lookup"><span data-stu-id="34759-129">By default, [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) uses "Microsoft-HTTPAPI/1.0" as the "Server:" header.</span></span> <span data-ttu-id="34759-130">Si une application spécifie un en-tête de serveur dans une réponse, cette valeur est placée en tant que première partie de l’en-tête de serveur, suivie d’un espace, puis de « Microsoft-HTTPAPI/1.0 ».</span><span class="sxs-lookup"><span data-stu-id="34759-130">If an application specifies a server header in a response, that value is placed as the first part of the server header, followed by a space and then "Microsoft-HTTPAPI/1.0".</span></span>

 

<span data-ttu-id="34759-131">En général, l’API du serveur HTTP masque les détails de la gestion des connexions et leur établissement et leur destruction à partir des applications.</span><span class="sxs-lookup"><span data-stu-id="34759-131">In general, the HTTP Server API hides details of connection management and their establishment and teardown from applications.</span></span> <span data-ttu-id="34759-132">Toutefois, une application peut éventuellement détecter l’arrêt d’une connexion en appelant [**HttpWaitForDisconnect**](/windows/desktop/api/Http/nf-http-httpwaitfordisconnect).</span><span class="sxs-lookup"><span data-stu-id="34759-132">However, an application can optionally detect termination of a connection by calling [**HttpWaitForDisconnect**](/windows/desktop/api/Http/nf-http-httpwaitfordisconnect).</span></span>

<span data-ttu-id="34759-133">Les applications doivent être nettoyées en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="34759-133">Applications must clean-up by using the following steps:</span></span>

-   <span data-ttu-id="34759-134">Lorsque l’application n’écoute pas ou ne répond pas à une URL, l’URL est supprimée à l’aide de la fonction [**HttpRemoveURL**](/windows/desktop/api/Http/nf-http-httpremoveurl) .</span><span class="sxs-lookup"><span data-stu-id="34759-134">When the application is not listening or responding to a URL, the URL is removed by using the [**HttpRemoveURL**](/windows/desktop/api/Http/nf-http-httpremoveurl) function.</span></span>
-   <span data-ttu-id="34759-135">Lorsque l’application a terminé d’utiliser la file d’attente des demandes, fermez le handle de la file d’attente des demandes à l’aide de la fonction [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="34759-135">When the application is finished using the request queue, close the request queue handle by using the [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) function.</span></span>
-   <span data-ttu-id="34759-136">Lorsque l’application a terminé d’utiliser l’API du serveur HTTP, appelez la fonction [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) .</span><span class="sxs-lookup"><span data-stu-id="34759-136">When the application is finished using the HTTP Server API, call the [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) function.</span></span>

 

 