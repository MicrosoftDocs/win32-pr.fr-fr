---
title: Authentification avec plusieurs en-têtes connus
description: La \_ structure http \_ avec plusieurs \_ en-têtes connus permet aux applications serveur d’envoyer plusieurs défis d’authentification au client.
ms.assetid: d517fd61-9547-4e1c-b0fd-1eb3d0098db2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8afbce3c2a41ea143003723acebc7eb83dc463d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "106510607"
---
# <a name="authentication-with-multiple-known-headers"></a><span data-ttu-id="dcae6-103">Authentification avec plusieurs en-têtes connus</span><span class="sxs-lookup"><span data-stu-id="dcae6-103">Authentication with Multiple Known Headers</span></span>

<span data-ttu-id="dcae6-104">La structure [**http avec \_ plusieurs \_ \_ en-têtes connus**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) permet aux applications serveur d’envoyer plusieurs défis d’authentification au client.</span><span class="sxs-lookup"><span data-stu-id="dcae6-104">The [**HTTP\_MULTIPLE\_KNOWN\_HEADERS**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) structure enables server applications to send multiple authentication challenges to the client.</span></span> <span data-ttu-id="dcae6-105">Les applications peuvent défier le client avec un seul schéma d’authentification en fournissant le type d’énumération **HttpHeaderWwwAuthenticate** dans le membre **KnownHeaders** de la structure des [**\_ \_ en-têtes de réponse http**](/windows/desktop/api/Http/ns-http-http_response_headers) contenue dans la [**\_ réponse http**](http-response.md).</span><span class="sxs-lookup"><span data-stu-id="dcae6-105">Applications can challenge the client with a single authentication scheme by supplying the **HttpHeaderWwwAuthenticate** enumeration type in the **KnownHeaders** member of the [**HTTP\_RESPONSE\_HEADERS**](/windows/desktop/api/Http/ns-http-http_response_headers) structure contained in [**HTTP\_RESPONSE**](http-response.md).</span></span> <span data-ttu-id="dcae6-106">Toutefois, lorsque le serveur rencontre plusieurs schémas d’authentification, l’application utilise la structure [**http de \_ plusieurs \_ \_ en-têtes connus**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) pour fournir les types d’authentification.</span><span class="sxs-lookup"><span data-stu-id="dcae6-106">However, when the server challenges with multiple authentication schemes, the application uses the [**HTTP\_MULTIPLE\_KNOWN\_HEADERS**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) structure to provide the authentication types.</span></span>

<span data-ttu-id="dcae6-107">Lorsque les **\_ indicateurs d' \_ informations \_ \_ \_ de réponse HTTP** sont présents, le protocole http envoie les en-têtes d’authentification dans l’ordre spécifié.</span><span class="sxs-lookup"><span data-stu-id="dcae6-107">When the **HTTP\_RESPONSE\_INFO\_FLAGS\_PRESERVE\_ORDER** flag is present, HTTP sends the authentication headers in the specified order.</span></span> <span data-ttu-id="dcae6-108">Si l’indicateur n’est pas présent, HTTP trie les schémas d’authentification de la plus forte à la plus faible, comme suit :</span><span class="sxs-lookup"><span data-stu-id="dcae6-108">If the flag is not present, HTTP orders the authentication schemes from strongest to weakest as follows:</span></span>

1.  <span data-ttu-id="dcae6-109">Negotiate</span><span class="sxs-lookup"><span data-stu-id="dcae6-109">Negotiate</span></span>
2.  <span data-ttu-id="dcae6-110">NTLM</span><span class="sxs-lookup"><span data-stu-id="dcae6-110">NTLM</span></span>
3.  <span data-ttu-id="dcae6-111">Digest</span><span class="sxs-lookup"><span data-stu-id="dcae6-111">Digest</span></span>
4.  <span data-ttu-id="dcae6-112">De base</span><span class="sxs-lookup"><span data-stu-id="dcae6-112">Basic</span></span>

<span data-ttu-id="dcae6-113">Si le schéma d’authentification n’est pas l’un de ces schémas, l’application doit spécifier l’indicateur de l' **ordre de conservation des indicateurs d' \_ informations de réponse \_ \_ \_ \_ http** .</span><span class="sxs-lookup"><span data-stu-id="dcae6-113">If the authentication scheme is not one of these schemes, the application must specify the **HTTP\_RESPONSE\_INFO\_FLAGS\_PRESERVE\_ORDER** flag.</span></span>

<span data-ttu-id="dcae6-114">Le membre **KnownHeader** de [**\_ plusieurs \_ \_ en-têtes connus http**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) pointe vers un tableau de structures d' [**\_ \_ en-tête connues http**](/windows/desktop/api/Http/ns-http-http_known_header) .</span><span class="sxs-lookup"><span data-stu-id="dcae6-114">The **KnownHeader** member of [**HTTP\_MULTIPLE\_KNOWN\_HEADERS**](/windows/desktop/api/Http/ns-http-http_multiple_known_headers) points to an array of [**HTTP\_KNOWN\_HEADER**](/windows/desktop/api/Http/ns-http-http_known_header) structures.</span></span> <span data-ttu-id="dcae6-115">Le membre **pRawValue** de la structure d' **\_ \_ en-tête connu http** doit pointer vers une chaîne qui spécifie le nom du schéma.</span><span class="sxs-lookup"><span data-stu-id="dcae6-115">The **pRawValue** member of the **HTTP\_KNOWN\_HEADER** structure must point to a string that specifies the scheme name.</span></span> <span data-ttu-id="dcae6-116">HTTP analyse la chaîne pour déterminer le schéma et effectue l’une des actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="dcae6-116">HTTP parses the string to determine the scheme and performs one of the following actions:</span></span>

-   <span data-ttu-id="dcae6-117">Si la chaîne contient un type d’authentification inconnu ou si le type d’authentification n’est pas activé sur le groupe de configuration (le groupe d’URL ou la session serveur) associé à la demande, l’API du serveur HTTP ajoute la chaîne dans **pRawValue** à l’en-tête WWW-Authenticate.</span><span class="sxs-lookup"><span data-stu-id="dcae6-117">If the string contains an unknown authentication type, or if the authentication type is not enabled on the configuration group (either the URL group or server session) associated with the request, the HTTP Server API appends the string in **pRawValue** to the WWW-Authenticate header.</span></span> <span data-ttu-id="dcae6-118">Par exemple, si l’application spécifie un schéma d’authentification non pris en charge et que **pRawValue** contient la chaîne « CustomAuthString », le texte suivant est ajouté à l’en-tête d’authentification :</span><span class="sxs-lookup"><span data-stu-id="dcae6-118">For example, if the application specifies an unsupported authentication scheme, and **pRawValue** contains the string "CustomAuthString", the following text is appended to the authentication header:</span></span>

    <span data-ttu-id="dcae6-119">WWW-Authenticate : CustomAuthSchemeCRLF</span><span class="sxs-lookup"><span data-stu-id="dcae6-119">WWW-Authenticate: CustomAuthSchemeCRLF</span></span>

    <span data-ttu-id="dcae6-120">Si l’authentification de base n’est pas activée pour l’application et que **pRawValue** contient la chaîne « Basic Realm = "BasicRealm »», l’en-tête d’authentification contient le texte suivant :</span><span class="sxs-lookup"><span data-stu-id="dcae6-120">If the application does not have Basic authentication enabled, and **pRawValue** contains the string "Basic realm="BasicRealm"", the authentication header contains the following text:</span></span>

    <span data-ttu-id="dcae6-121">WWW-Authenticate : Basic Realm = "BasicRealm"</span><span class="sxs-lookup"><span data-stu-id="dcae6-121">WWW-Authenticate: Basic realm="BasicRealm"</span></span>

-   <span data-ttu-id="dcae6-122">Si la chaîne contient un type d’authentification connu et qu’elle est présente dans le groupe de configuration (le groupe d’URL ou la session serveur) associé à la demande, l’API du serveur HTTP génère l’en-tête WWW-Authenticate.</span><span class="sxs-lookup"><span data-stu-id="dcae6-122">If the string contains a known authentication type and is present on the configuration group (either the URL group or the server session) associated with the request, the HTTP Server API generates the WWW-Authenticate header.</span></span> <span data-ttu-id="dcae6-123">Par exemple, si la chaîne spécifiée dans **pRawValue** est « Digest » et que Digest est activé sur la session serveur, l’API du serveur http ajoute le texte suivant à l’en-tête d’authentification :</span><span class="sxs-lookup"><span data-stu-id="dcae6-123">For example if the string specified in **pRawValue** is "Digest", and Digest is enabled on the server session, the HTTP Server API appends the following text to the authentication header:</span></span>

    <span data-ttu-id="dcae6-124">WWW-Authenticate : condensé Realm = " testrealm@host.com "</span><span class="sxs-lookup"><span data-stu-id="dcae6-124">WWW-Authenticate: Digest realm="testrealm@host.com"</span></span>

<span data-ttu-id="dcae6-125">Si le schéma dans le membre **pRawValue** de [**l' \_ \_ en-tête connu http**](/windows/desktop/api/Http/ns-http-http_known_header) est Negotiate ou NTLM, le nom du schéma d’authentification est suffisant.</span><span class="sxs-lookup"><span data-stu-id="dcae6-125">If the scheme in the **pRawValue** member of [**HTTP\_KNOWN\_HEADER**](/windows/desktop/api/Http/ns-http-http_known_header) is Negotiate or NTLM, the authentication scheme name is sufficient.</span></span> <span data-ttu-id="dcae6-126">Si le schéma spécifié est de base, le nom du domaine est ajouté au nom du schéma ; l’application n’a pas besoin de fournir le nom de domaine dans **pRawValue**.</span><span class="sxs-lookup"><span data-stu-id="dcae6-126">If the specified scheme is Basic, the realm name is appended to the scheme name; the application doesn't need to supply the realm name in **pRawValue**.</span></span> <span data-ttu-id="dcae6-127">Si le schéma spécifié est Digest, HTTP appelle [**AcceptSecurityContext**](../SecAuthN/acceptsecuritycontext--general.md) pour générer la stimulation qui est ajoutée au nom du schéma.</span><span class="sxs-lookup"><span data-stu-id="dcae6-127">If the specified scheme is Digest, HTTP calls [**AcceptSecurityContext**](../SecAuthN/acceptsecuritycontext--general.md) to generate the challenge that is appended to the scheme name.</span></span> <span data-ttu-id="dcae6-128">Les paramètres du schéma de base (domaine) et du schéma condensé (domaine et nom de domaine) sont obtenus à partir des informations d’authentification du groupe de configuration correspondantes.</span><span class="sxs-lookup"><span data-stu-id="dcae6-128">The parameters for Basic (realm) and Digest (realm and domain name) scheme are obtained from the corresponding configuration group authentication information.</span></span>

<span data-ttu-id="dcae6-129">Lorsque l’application envoie plusieurs défis d’authentification au client dans des en-têtes de demande inconnus, l’API du serveur HTTP les envoie au client sans intervention.</span><span class="sxs-lookup"><span data-stu-id="dcae6-129">When the application sends multiple authentication challenges to the client in Unknown request headers, the HTTP Server API sends these to the client without intervention.</span></span> <span data-ttu-id="dcae6-130">Toutefois, cette utilisation n’est pas recommandée.</span><span class="sxs-lookup"><span data-stu-id="dcae6-130">However this usage is not recommended.</span></span>

 

 




