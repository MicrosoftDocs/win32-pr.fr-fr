---
title: Exemple de délai d’expiration HTTP du scénario 1 utilisant le suivi ETW et les commandes netsh
description: Grâce au suivi ETW, le workflow des données via le composant API du serveur HTTP peut être inspecté pour diagnostiquer les problèmes.
ms.assetid: b6b24161-c3da-4972-b49f-c545da2fc81e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa50f438aca664651b24db822f2b9e3a30da4682
ms.sourcegitcommit: 37f276b5d887a3aad04b1ba86e390dea9d87e591
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/04/2021
ms.locfileid: "104561660"
---
# <a name="scenario-1-http-timeout-example-using-etw-tracing-and-netsh-commands"></a><span data-ttu-id="35c60-103">Scénario 1 : exemple de délai d’expiration HTTP utilisant le suivi ETW et les commandes netsh</span><span class="sxs-lookup"><span data-stu-id="35c60-103">Scenario 1: HTTP Timeout Example Using ETW Tracing and Netsh Commands</span></span>

<span data-ttu-id="35c60-104">Grâce au suivi ETW, le workflow des données via le composant API du serveur HTTP peut être inspecté pour diagnostiquer les problèmes.</span><span class="sxs-lookup"><span data-stu-id="35c60-104">Through ETW tracing, the flow of data through the HTTP Server API component can be inspected to diagnose problems.</span></span> <span data-ttu-id="35c60-105">Par exemple, les utilisateurs d’une application Web peuvent voir les messages d’erreur dans leur navigateur qu’une page Web ne peut pas s’afficher.</span><span class="sxs-lookup"><span data-stu-id="35c60-105">For example, users of a web application may see error messages in their browser that a web page cannot display.</span></span> <span data-ttu-id="35c60-106">Sur le serveur hébergeant l’application Web, le professionnel de l’informatique voit également une entrée de délai de connexion dans le journal des erreurs HTTP, comme illustré à la figure 1 ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="35c60-106">On the server hosting the web application, the IT professional also sees a connection timeout entry within the HTTP Error Log, as shown in Figure 1 below.</span></span> <span data-ttu-id="35c60-107">Le journal des erreurs HTTP se trouve dans le répertoire suivant :% windir% \\ system32 \\ LogFiles \\ HTTPERR \\ .</span><span class="sxs-lookup"><span data-stu-id="35c60-107">The HTTP Error Log can be found in the following directory: %windir%\\System32\\LogFiles\\HTTPERR\\.</span></span>

![Capture d’écran montrant la fenêtre de commande netsh H T T P affichant un journal des erreurs H T t P pour le délai d’expiration.](images/httperrorlog.png)

<span data-ttu-id="35c60-109">Figure 1 : journal des erreurs HTTP pour le délai d’expiration</span><span class="sxs-lookup"><span data-stu-id="35c60-109">Figure 1: HTTP Error Log for Timeout</span></span>

## <a name="generating-an-etw-trace-report"></a><span data-ttu-id="35c60-110">Génération d’un rapport de suivi ETW</span><span class="sxs-lookup"><span data-stu-id="35c60-110">Generating an ETW Trace Report</span></span>

<span data-ttu-id="35c60-111">Pour générer un rapport de suivi ETW pour le composant API du serveur HTTP, exécutez les étapes ci-dessous à partir de l’invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="35c60-111">To generate an ETW trace report for the HTTP Server API component, run the steps below from the command prompt.</span></span> <span data-ttu-id="35c60-112">Dans cet exemple, la trace est exécutée sur le serveur, car elle héberge l’application Web.</span><span class="sxs-lookup"><span data-stu-id="35c60-112">In this example, the trace is run on the server since it is hosting the web application.</span></span>

<span data-ttu-id="35c60-113">Les étapes ci-dessous génèrent une trace appelée Httptrace. etl, puis convertissent la trace en un fichier CSV appelé httptrace.csv.</span><span class="sxs-lookup"><span data-stu-id="35c60-113">The steps below generate a trace called httptrace.etl and then convert the trace into a CSV file called httptrace.csv.</span></span> <span data-ttu-id="35c60-114">Comme indiqué ci-dessous, le fournisseur ETW pour l’API du serveur HTTP est appelé Microsoft-Windows-HttpService.</span><span class="sxs-lookup"><span data-stu-id="35c60-114">As shown below, the ETW provider for the HTTP Server API is called Microsoft-Windows-HttpService.</span></span> <span data-ttu-id="35c60-115">L’option de ligne de commande 0xFFF indique que tous les événements ETW pour ce fournisseur doivent être capturés.</span><span class="sxs-lookup"><span data-stu-id="35c60-115">The 0xFFF command-line option indicates that all ETW events for this provider should be captured.</span></span>

<span data-ttu-id="35c60-116">**Générer un rapport de suivi ETW**</span><span class="sxs-lookup"><span data-stu-id="35c60-116">**Generate an ETW Trace Report**</span></span>

1.  <span data-ttu-id="35c60-117">Démarrer la trace ETW pour le composant de l’API serveur HTTP : l **ogman.exe Start Httptrace-p Microsoft-Windows-HTTPService 0xFFFF-o Httptrace. etl – ETS**</span><span class="sxs-lookup"><span data-stu-id="35c60-117">Start ETW trace for HTTP Server API component: l **ogman.exe start httptrace -p Microsoft-Windows-HttpService 0xFFFF -o httptrace.etl –ets**</span></span>
2.  <span data-ttu-id="35c60-118">Reproduisez le problème afin qu’il puisse être capturé dans la trace.</span><span class="sxs-lookup"><span data-stu-id="35c60-118">Reproduce the issue so that it can be captured in the trace.</span></span> <span data-ttu-id="35c60-119">Dans cet exemple, accédez à l’application Web à partir d’un ordinateur client, ce qui entraîne l’affichage du message «**Impossible d’afficher la page**» sur le client.</span><span class="sxs-lookup"><span data-stu-id="35c60-119">In this example, access the web application from a client machine, resulting in the "**page cannot be displayed**" message being shown on the client.</span></span>
3.  <span data-ttu-id="35c60-120">Maintenant que le problème a été reproduit, arrêtez la trace : **logman.exe Stop Httptrace – ETS**</span><span class="sxs-lookup"><span data-stu-id="35c60-120">Now that the issue has been reproduced, stop the trace: **logman.exe stop httptrace –ets**</span></span>
4.  <span data-ttu-id="35c60-121">Convertissez le rapport au format CSV : **tracerpt.exe Httptrace. etl-of CSV-o httptrace.csv**</span><span class="sxs-lookup"><span data-stu-id="35c60-121">Convert the report into CSV format: **tracerpt.exe httptrace.etl -of CSV -o httptrace.csv**</span></span>
5.  <span data-ttu-id="35c60-122">Affichez le rapport de suivi.</span><span class="sxs-lookup"><span data-stu-id="35c60-122">View the trace report.</span></span> <span data-ttu-id="35c60-123">Un extrait d’une trace de volume partagé de cluster est présenté ci-dessous dans le tableau 1.</span><span class="sxs-lookup"><span data-stu-id="35c60-123">An excerpt from a CSV trace is shown below in Table 1.</span></span>

## <a name="viewing-the-trace-and-diagnosing"></a><span data-ttu-id="35c60-124">Affichage du suivi et du diagnostic</span><span class="sxs-lookup"><span data-stu-id="35c60-124">Viewing the Trace and Diagnosing</span></span>

<span data-ttu-id="35c60-125">Le fichier CSV résultant pour les traces peut être affiché dans Excel ou tout outil qui prend en charge le format CSV.</span><span class="sxs-lookup"><span data-stu-id="35c60-125">The resulting CSV file for traces can be viewed in Excel or any tool that supports the CSV format.</span></span> <span data-ttu-id="35c60-126">Le tableau 1 ci-dessous présente des extraits d’un exemple de fichier de trace (httptrace.csv).</span><span class="sxs-lookup"><span data-stu-id="35c60-126">Table 1 below shows excerpts from a sample trace file (httptrace.csv).</span></span> <span data-ttu-id="35c60-127">Dans le rapport de suivi, la colonne « Level » affiche une entrée avec une valeur de « 3 », qui correspond à un avertissement dans ETW.</span><span class="sxs-lookup"><span data-stu-id="35c60-127">In the trace report, the "Level" column shows an entry with a value of "3", which corresponds to a warning in ETW.</span></span> <span data-ttu-id="35c60-128">Le composant de l’API du serveur HTTP suit les niveaux ETW définis dans l’article suivant : ( https://msdn2.microsoft.com/library/aa382793.aspx) .</span><span class="sxs-lookup"><span data-stu-id="35c60-128">The HTTP Server API component follows the ETW Levels defined in the following article: (https://msdn2.microsoft.com/library/aa382793.aspx).</span></span> <span data-ttu-id="35c60-129">Les niveaux ETW sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="35c60-129">The ETW levels include:</span></span>



| <span data-ttu-id="35c60-130">Level</span><span class="sxs-lookup"><span data-stu-id="35c60-130">Level</span></span> | <span data-ttu-id="35c60-131">Signification</span><span class="sxs-lookup"><span data-stu-id="35c60-131">Meaning</span></span>      |
|-------|--------------|
| <span data-ttu-id="35c60-132">1</span><span class="sxs-lookup"><span data-stu-id="35c60-132">1</span></span>     | <span data-ttu-id="35c60-133">Critique</span><span class="sxs-lookup"><span data-stu-id="35c60-133">Critical</span></span>     |
| <span data-ttu-id="35c60-134">2</span><span class="sxs-lookup"><span data-stu-id="35c60-134">2</span></span>     | <span data-ttu-id="35c60-135">Error</span><span class="sxs-lookup"><span data-stu-id="35c60-135">Error</span></span>        |
| <span data-ttu-id="35c60-136">3</span><span class="sxs-lookup"><span data-stu-id="35c60-136">3</span></span>     | <span data-ttu-id="35c60-137">Avertissement</span><span class="sxs-lookup"><span data-stu-id="35c60-137">Warning</span></span>      |
| <span data-ttu-id="35c60-138">4</span><span class="sxs-lookup"><span data-stu-id="35c60-138">4</span></span>     | <span data-ttu-id="35c60-139">Infomational</span><span class="sxs-lookup"><span data-stu-id="35c60-139">Infomational</span></span> |
| <span data-ttu-id="35c60-140">5</span><span class="sxs-lookup"><span data-stu-id="35c60-140">5</span></span>     | <span data-ttu-id="35c60-141">Commentaires</span><span class="sxs-lookup"><span data-stu-id="35c60-141">Verbose</span></span>      |



 

<span data-ttu-id="35c60-142">Avec cet avertissement, le type d’événement (colonne de type) indique « ConnTimedOut ».</span><span class="sxs-lookup"><span data-stu-id="35c60-142">With this warning, the event type (Type column) reports "ConnTimedOut".</span></span> <span data-ttu-id="35c60-143">Dans les colonnes suivantes de l’événement ConnTimeOut, le minuteur spécifique qui a expiré est signalé comme « minuteur \_ ConnectionIdle ».</span><span class="sxs-lookup"><span data-stu-id="35c60-143">In the subsequent columns for the ConnTimeOut event, the specific timer that expired is reported as "Timer\_ConnectionIdle".</span></span> <span data-ttu-id="35c60-144">Notez que la colonne avec l’entrée « Timer \_ ConnectionIdle » n’est pas incluse dans le tableau pour des raisons de concision et pour éviter l’extrait de colonnes non contiguës.</span><span class="sxs-lookup"><span data-stu-id="35c60-144">Note the column with the "Timer\_ConnectionIdle" entry is not included in the table for the sake brevity and to avoid excerpting noncontiguous columns.</span></span>



| <span data-ttu-id="35c60-145">Nom d'événement</span><span class="sxs-lookup"><span data-stu-id="35c60-145">Event name</span></span>                    | <span data-ttu-id="35c60-146">Type</span><span class="sxs-lookup"><span data-stu-id="35c60-146">Type</span></span>            | <span data-ttu-id="35c60-147">ID de l’événement</span><span class="sxs-lookup"><span data-stu-id="35c60-147">Event ID</span></span> | <span data-ttu-id="35c60-148">Version</span><span class="sxs-lookup"><span data-stu-id="35c60-148">Version</span></span> | <span data-ttu-id="35c60-149">Channel</span><span class="sxs-lookup"><span data-stu-id="35c60-149">Channel</span></span> | <span data-ttu-id="35c60-150">Level</span><span class="sxs-lookup"><span data-stu-id="35c60-150">Level</span></span> |
|-------------------------------|-----------------|----------|---------|---------|-------|
| <span data-ttu-id="35c60-151">EventTrace</span><span class="sxs-lookup"><span data-stu-id="35c60-151">EventTrace</span></span>                    | <span data-ttu-id="35c60-152">En-tête</span><span class="sxs-lookup"><span data-stu-id="35c60-152">Header</span></span>          | <span data-ttu-id="35c60-153">0</span><span class="sxs-lookup"><span data-stu-id="35c60-153">0</span></span>        | <span data-ttu-id="35c60-154">2</span><span class="sxs-lookup"><span data-stu-id="35c60-154">2</span></span>       | <span data-ttu-id="35c60-155">0</span><span class="sxs-lookup"><span data-stu-id="35c60-155">0</span></span>       | <span data-ttu-id="35c60-156">0</span><span class="sxs-lookup"><span data-stu-id="35c60-156">0</span></span>     |
| <span data-ttu-id="35c60-157">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-157">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-158">ChgUrlGrpProp</span><span class="sxs-lookup"><span data-stu-id="35c60-158">ChgUrlGrpProp</span></span>   | <span data-ttu-id="35c60-159">28</span><span class="sxs-lookup"><span data-stu-id="35c60-159">28</span></span>       | <span data-ttu-id="35c60-160">0</span><span class="sxs-lookup"><span data-stu-id="35c60-160">0</span></span>       | <span data-ttu-id="35c60-161">16</span><span class="sxs-lookup"><span data-stu-id="35c60-161">16</span></span>      | <span data-ttu-id="35c60-162">4</span><span class="sxs-lookup"><span data-stu-id="35c60-162">4</span></span>     |
| <span data-ttu-id="35c60-163">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-163">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-164">AddUrl</span><span class="sxs-lookup"><span data-stu-id="35c60-164">AddUrl</span></span>          | <span data-ttu-id="35c60-165">31</span><span class="sxs-lookup"><span data-stu-id="35c60-165">31</span></span>       | <span data-ttu-id="35c60-166">0</span><span class="sxs-lookup"><span data-stu-id="35c60-166">0</span></span>       | <span data-ttu-id="35c60-167">16</span><span class="sxs-lookup"><span data-stu-id="35c60-167">16</span></span>      | <span data-ttu-id="35c60-168">4</span><span class="sxs-lookup"><span data-stu-id="35c60-168">4</span></span>     |
| <span data-ttu-id="35c60-169">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-169">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-170">ChgReqQueueProp</span><span class="sxs-lookup"><span data-stu-id="35c60-170">ChgReqQueueProp</span></span> | <span data-ttu-id="35c60-171">30</span><span class="sxs-lookup"><span data-stu-id="35c60-171">30</span></span>       | <span data-ttu-id="35c60-172">0</span><span class="sxs-lookup"><span data-stu-id="35c60-172">0</span></span>       | <span data-ttu-id="35c60-173">16</span><span class="sxs-lookup"><span data-stu-id="35c60-173">16</span></span>      | <span data-ttu-id="35c60-174">4</span><span class="sxs-lookup"><span data-stu-id="35c60-174">4</span></span>     |
| <span data-ttu-id="35c60-175">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-175">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-176">ChgUrlGrpProp</span><span class="sxs-lookup"><span data-stu-id="35c60-176">ChgUrlGrpProp</span></span>   | <span data-ttu-id="35c60-177">28</span><span class="sxs-lookup"><span data-stu-id="35c60-177">28</span></span>       | <span data-ttu-id="35c60-178">0</span><span class="sxs-lookup"><span data-stu-id="35c60-178">0</span></span>       | <span data-ttu-id="35c60-179">16</span><span class="sxs-lookup"><span data-stu-id="35c60-179">16</span></span>      | <span data-ttu-id="35c60-180">4</span><span class="sxs-lookup"><span data-stu-id="35c60-180">4</span></span>     |
| <span data-ttu-id="35c60-181">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-181">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-182">ChgSrvSesProp</span><span class="sxs-lookup"><span data-stu-id="35c60-182">ChgSrvSesProp</span></span>   | <span data-ttu-id="35c60-183">29</span><span class="sxs-lookup"><span data-stu-id="35c60-183">29</span></span>       | <span data-ttu-id="35c60-184">0</span><span class="sxs-lookup"><span data-stu-id="35c60-184">0</span></span>       | <span data-ttu-id="35c60-185">16</span><span class="sxs-lookup"><span data-stu-id="35c60-185">16</span></span>      | <span data-ttu-id="35c60-186">4</span><span class="sxs-lookup"><span data-stu-id="35c60-186">4</span></span>     |
| <span data-ttu-id="35c60-187">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-187">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-188">ChgSrvSesProp</span><span class="sxs-lookup"><span data-stu-id="35c60-188">ChgSrvSesProp</span></span>   | <span data-ttu-id="35c60-189">29</span><span class="sxs-lookup"><span data-stu-id="35c60-189">29</span></span>       | <span data-ttu-id="35c60-190">0</span><span class="sxs-lookup"><span data-stu-id="35c60-190">0</span></span>       | <span data-ttu-id="35c60-191">16</span><span class="sxs-lookup"><span data-stu-id="35c60-191">16</span></span>      | <span data-ttu-id="35c60-192">4</span><span class="sxs-lookup"><span data-stu-id="35c60-192">4</span></span>     |
| <span data-ttu-id="35c60-193">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-193">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-194">ConnConnect</span><span class="sxs-lookup"><span data-stu-id="35c60-194">ConnConnect</span></span>     | <span data-ttu-id="35c60-195">21</span><span class="sxs-lookup"><span data-stu-id="35c60-195">21</span></span>       | <span data-ttu-id="35c60-196">0</span><span class="sxs-lookup"><span data-stu-id="35c60-196">0</span></span>       | <span data-ttu-id="35c60-197">16</span><span class="sxs-lookup"><span data-stu-id="35c60-197">16</span></span>      | <span data-ttu-id="35c60-198">4</span><span class="sxs-lookup"><span data-stu-id="35c60-198">4</span></span>     |
| <span data-ttu-id="35c60-199">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-199">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-200">ConnIdAssgn</span><span class="sxs-lookup"><span data-stu-id="35c60-200">ConnIdAssgn</span></span>     | <span data-ttu-id="35c60-201">22</span><span class="sxs-lookup"><span data-stu-id="35c60-201">22</span></span>       | <span data-ttu-id="35c60-202">0</span><span class="sxs-lookup"><span data-stu-id="35c60-202">0</span></span>       | <span data-ttu-id="35c60-203">16</span><span class="sxs-lookup"><span data-stu-id="35c60-203">16</span></span>      | <span data-ttu-id="35c60-204">4</span><span class="sxs-lookup"><span data-stu-id="35c60-204">4</span></span>     |
| <span data-ttu-id="35c60-205">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-205">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-206">RecvReq</span><span class="sxs-lookup"><span data-stu-id="35c60-206">RecvReq</span></span>         | <span data-ttu-id="35c60-207">1</span><span class="sxs-lookup"><span data-stu-id="35c60-207">1</span></span>        | <span data-ttu-id="35c60-208">0</span><span class="sxs-lookup"><span data-stu-id="35c60-208">0</span></span>       | <span data-ttu-id="35c60-209">16</span><span class="sxs-lookup"><span data-stu-id="35c60-209">16</span></span>      | <span data-ttu-id="35c60-210">4</span><span class="sxs-lookup"><span data-stu-id="35c60-210">4</span></span>     |
| <span data-ttu-id="35c60-211">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-211">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-212">Analyser</span><span class="sxs-lookup"><span data-stu-id="35c60-212">Parse</span></span>           | <span data-ttu-id="35c60-213">2</span><span class="sxs-lookup"><span data-stu-id="35c60-213">2</span></span>        | <span data-ttu-id="35c60-214">0</span><span class="sxs-lookup"><span data-stu-id="35c60-214">0</span></span>       | <span data-ttu-id="35c60-215">16</span><span class="sxs-lookup"><span data-stu-id="35c60-215">16</span></span>      | <span data-ttu-id="35c60-216">4</span><span class="sxs-lookup"><span data-stu-id="35c60-216">4</span></span>     |
| <span data-ttu-id="35c60-217">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-217">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-218">LogFileWrite</span><span class="sxs-lookup"><span data-stu-id="35c60-218">LogFileWrite</span></span>    | <span data-ttu-id="35c60-219">51</span><span class="sxs-lookup"><span data-stu-id="35c60-219">51</span></span>       | <span data-ttu-id="35c60-220">0</span><span class="sxs-lookup"><span data-stu-id="35c60-220">0</span></span>       | <span data-ttu-id="35c60-221">16</span><span class="sxs-lookup"><span data-stu-id="35c60-221">16</span></span>      | <span data-ttu-id="35c60-222">4</span><span class="sxs-lookup"><span data-stu-id="35c60-222">4</span></span>     |
| <span data-ttu-id="35c60-223">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-223">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-224">ConnCleanup</span><span class="sxs-lookup"><span data-stu-id="35c60-224">ConnCleanup</span></span>     | <span data-ttu-id="35c60-225">24</span><span class="sxs-lookup"><span data-stu-id="35c60-225">24</span></span>       | <span data-ttu-id="35c60-226">0</span><span class="sxs-lookup"><span data-stu-id="35c60-226">0</span></span>       | <span data-ttu-id="35c60-227">16</span><span class="sxs-lookup"><span data-stu-id="35c60-227">16</span></span>      | <span data-ttu-id="35c60-228">4</span><span class="sxs-lookup"><span data-stu-id="35c60-228">4</span></span>     |
| <span data-ttu-id="35c60-229">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="35c60-229">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="35c60-230">ConnTimedOut</span><span class="sxs-lookup"><span data-stu-id="35c60-230">ConnTimedOut</span></span>    | <span data-ttu-id="35c60-231">53</span><span class="sxs-lookup"><span data-stu-id="35c60-231">53</span></span>       | <span data-ttu-id="35c60-232">0</span><span class="sxs-lookup"><span data-stu-id="35c60-232">0</span></span>       | <span data-ttu-id="35c60-233">16</span><span class="sxs-lookup"><span data-stu-id="35c60-233">16</span></span>      | <span data-ttu-id="35c60-234">3</span><span class="sxs-lookup"><span data-stu-id="35c60-234">3</span></span>     |



 

<span data-ttu-id="35c60-235">Tableau 1 : extraits d’un exemple de rapport de suivi pour un problème de minuteur</span><span class="sxs-lookup"><span data-stu-id="35c60-235">Table 1: Excerpts from a Sample Trace Report for a Timer Issue</span></span>

<span data-ttu-id="35c60-236">Dans cet exemple, l’expiration (événement ConnTimeOut) du minuteur d’en-tête (Timer \_ ConnectionIdle) est la raison pour laquelle les utilisateurs finaux voient le message « Impossible d’afficher la page » dans leurs clients Web.</span><span class="sxs-lookup"><span data-stu-id="35c60-236">In this example, the expiration (ConnTimeOut event) of the header timer (Timer\_ConnectionIdle) is the reason end-users see the "page cannot be displayed" message in their web clients.</span></span> <span data-ttu-id="35c60-237">Une raison possible du délai d’attente peut être que les clients Web s’envoient lentement en raison de connexions lentes.</span><span class="sxs-lookup"><span data-stu-id="35c60-237">A potential reason for the timeout may be that Web clients are sending slowly due to slow connections.</span></span> <span data-ttu-id="35c60-238">Pour résoudre ce problème, la valeur du délai d’attente peut être ajustée par le biais des commandes netsh.</span><span class="sxs-lookup"><span data-stu-id="35c60-238">To address this issue, the timeout value can be adjusted through Netsh commands.</span></span>

## <a name="adjusting-timeout-through-netsh-and-verifying-the-solution"></a><span data-ttu-id="35c60-239">Ajustement du délai d’expiration via netsh et vérification de la solution</span><span class="sxs-lookup"><span data-stu-id="35c60-239">Adjusting Timeout through Netsh and Verifying the Solution</span></span>

<span data-ttu-id="35c60-240">Les commandes netsh pour HTTP listées ci-dessous permettent à un professionnel de l’informatique d’afficher et de configurer des valeurs de paramètres sur le composant de l’API du serveur HTTP.</span><span class="sxs-lookup"><span data-stu-id="35c60-240">The Netsh commands for HTTP listed below allow an IT professional to view and configure setting values on the HTTP Server API component.</span></span> <span data-ttu-id="35c60-241">Les modifications effectuées via les commandes netsh HTTP affectent toutes les applications serveur hébergées par le composant API du serveur HTTP pour cet ordinateur.</span><span class="sxs-lookup"><span data-stu-id="35c60-241">Changes through Netsh HTTP commands affect all server applications hosted by the HTTP Server API component for that machine.</span></span> <span data-ttu-id="35c60-242">Ces modifications sont conservées entre les redémarrages du composant et les redémarrages de la machine.</span><span class="sxs-lookup"><span data-stu-id="35c60-242">These changes persist across restarts of the component and reboots of the machine.</span></span> <span data-ttu-id="35c60-243">Les commandes netsh HTTP sont disponibles dans Windows Vista et Windows Server 2008 et remplacent l’outil HttpCfg.exe du kit de ressources techniques Windows Server 2003 lors de l’exécution sur Windows Vista et Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="35c60-243">The Netsh HTTP commands are available in Windows Vista and Windows Server 2008 and replace the Windows Server 2003 Resource Kit's HttpCfg.exe tool when running on Windows Vista and Windows Server 2008.</span></span> <span data-ttu-id="35c60-244">Dans ce scénario, nous allons ajuster une valeur de délai d’attente, puis vérifier la solution.</span><span class="sxs-lookup"><span data-stu-id="35c60-244">In this scenario, we will adjust a timeout value and then verify the solution.</span></span> <span data-ttu-id="35c60-245">Les minuteurs existent dans le composant de l’API du serveur HTTP pour garantir la disponibilité et la protection contre la surconsommation par un utilisateur mal configuré ou malveillant.</span><span class="sxs-lookup"><span data-stu-id="35c60-245">Timers exist in the HTTP Server API component to ensure availability and protect against overconsumption by a misconfigured or malicious user.</span></span> <span data-ttu-id="35c60-246">L’ajustement des minuteurs à partir des valeurs par défaut doit être soigneusement évalué par rapport à une attaque par déni de refus.</span><span class="sxs-lookup"><span data-stu-id="35c60-246">Adjusting timers from default values should be carefully evaluated against a potential DoS attack.</span></span>

<span data-ttu-id="35c60-247">Dans cet exemple, les clients Web se trouvent derrière une connexion réseau lente, entraînant l' \_ événement ETW ConnectionIdle du minuteur.</span><span class="sxs-lookup"><span data-stu-id="35c60-247">In this example, the web clients are behind a slow network connection, resulting in the Timer\_ConnectionIdle ETW event.</span></span> <span data-ttu-id="35c60-248">Après avoir pris en compte la cause des délais d’attente et l’équilibrage avec l’impact sur la charge du serveur, il est décidé d’augmenter les valeurs de délai d’attente à une valeur de 240 secondes.</span><span class="sxs-lookup"><span data-stu-id="35c60-248">After consideration of the cause of the timeouts and balancing with the impact on the server's load, the decision is made to increase the timeout values to a value of 240 seconds.</span></span> <span data-ttu-id="35c60-249">Vous pouvez afficher et configurer le minuteur à l’aide de la procédure suivante.</span><span class="sxs-lookup"><span data-stu-id="35c60-249">You can view and then configure the timer with the following procedure.</span></span>

<span data-ttu-id="35c60-250">**Configurer le minuteur de connexion inactive (minuteur \_ ConnectionIdle) avec netsh**</span><span class="sxs-lookup"><span data-stu-id="35c60-250">**Configure the idle connection timer (Timer\_ConnectionIdle) with Netsh**</span></span>

1.  <span data-ttu-id="35c60-251">Sur le serveur, ouvrez une fenêtre de commande avec élévation de privilèges et exécutez les étapes ci-dessous pour afficher et configurer la valeur du délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="35c60-251">On the server, open an elevated command window and run the steps below to view and configure the timeout value.</span></span> <span data-ttu-id="35c60-252">Une capture d’écran de la commande netsh HTTP est illustrée dans la figure 2 ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="35c60-252">A screenshot of the Netsh HTTP command is shown in Figure 2 below.</span></span>
2.  <span data-ttu-id="35c60-253">Afficher les valeurs de délai d’attente actuelles : **netsh http show Timeout**</span><span class="sxs-lookup"><span data-stu-id="35c60-253">Show the current timeout values: **Netsh http show timeout**</span></span>
3.  <span data-ttu-id="35c60-254">Configurez la \_ valeur du délai d’attente ConnectionIdle du minuteur.</span><span class="sxs-lookup"><span data-stu-id="35c60-254">Configure the Timer\_ConnectionIdle timeout value.</span></span> <span data-ttu-id="35c60-255">Dans cet exemple, la valeur est remplacée par 240 secondes : **netsh http Add Timeout timeouttype = idleconnectiontimeout, value = 240**</span><span class="sxs-lookup"><span data-stu-id="35c60-255">In this example, the value is changed to 240 seconds: **Netsh http add timeout timeouttype=idleconnectiontimeout value=240**</span></span>

![fenêtre commande netsh http](images/netshhttpcommand.png)

<span data-ttu-id="35c60-257">Figure 2 : fenêtre de commande netsh HTTP</span><span class="sxs-lookup"><span data-stu-id="35c60-257">Figure 2: Netsh HTTP command window</span></span>

<span data-ttu-id="35c60-258">Après avoir configuré la valeur du délai d’attente, réexécutez les étapes de diagnostic ETW.</span><span class="sxs-lookup"><span data-stu-id="35c60-258">After configuring the timeout value, rerun the ETW diagnosis steps.</span></span> <span data-ttu-id="35c60-259">Si la condition d’erreur est corrigée, la trace ETW ne doit plus afficher de délai d’expiration avec un niveau ETW de « 3 » pour le minuteur d’inactivité de la connexion.</span><span class="sxs-lookup"><span data-stu-id="35c60-259">If the error condition is corrected, the ETW trace should no longer show a timeout with an ETW level of "3" for the connection idle timer.</span></span>

 

 




