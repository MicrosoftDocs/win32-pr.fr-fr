---
title: Tâches du serveur HTTP
description: En règle générale, les tâches du serveur HTTP sont exécutées dans un ordre spécifique. autrement dit, une tâche doit être terminée et la sortie obtenue avant le début de la tâche suivante.
ms.assetid: 08f8e7e9-23b9-403f-b00c-8912919d65b1
keywords:
- Tâches du serveur HTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22455dbda21aca32b26f586eed6e51cef7509af2
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103675922"
---
# <a name="http-server-tasks"></a><span data-ttu-id="60d22-104">Tâches du serveur HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-104">HTTP Server Tasks</span></span>

<span data-ttu-id="60d22-105">En règle générale, les tâches du serveur HTTP sont exécutées dans un ordre spécifique. autrement dit, une tâche doit être terminée et la sortie obtenue avant le début de la tâche suivante.</span><span class="sxs-lookup"><span data-stu-id="60d22-105">Typically, HTTP server tasks are performed in a specific order; that is, one task must be completed and the output obtained before the next task begins.</span></span>

<span data-ttu-id="60d22-106">Une page de tâche est créée pour présenter un exemple de code sur les tâches spécifiques effectuées par une application serveur HTTP.</span><span class="sxs-lookup"><span data-stu-id="60d22-106">A task page is created to present sample code about specific tasks that an HTTP Server application performs.</span></span> <span data-ttu-id="60d22-107">Une page de tâches est un lien vers le fichier d’extension C de l’exemple de serveur HTTP.</span><span class="sxs-lookup"><span data-stu-id="60d22-107">A task page links to the C extension file of the HTTP server sample.</span></span> <span data-ttu-id="60d22-108">Quand vous installez le \\ Kit de développement logiciel (SDK) sur le lecteur c : d’un ordinateur local, l’exemple d’application de serveur complet est installé dans c : \\ Program Files \\ Microsoft SDK \\ Samples \\ netds \\ http \\ Server.</span><span class="sxs-lookup"><span data-stu-id="60d22-108">When you install the PSDK on drive C:\\ of a local computer, the complete server sample application is installed at C:\\Program Files\\Microsoft SDK\\Samples\\netds\\http\\server.</span></span>

<span data-ttu-id="60d22-109">La liste suivante identifie les tâches du serveur HTTP :</span><span class="sxs-lookup"><span data-stu-id="60d22-109">The following list identifies the HTTP Server tasks:</span></span>

-   [<span data-ttu-id="60d22-110">Initialiser le service HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-110">Initialize the HTTP Service</span></span>](#initialize-the-http-service)
-   [<span data-ttu-id="60d22-111">Inscrire les URL à écouter</span><span class="sxs-lookup"><span data-stu-id="60d22-111">Register the URLs to Listen On</span></span>](#register-the-urls-to-listen-on)
-   [<span data-ttu-id="60d22-112">Appeler la routine pour recevoir une demande</span><span class="sxs-lookup"><span data-stu-id="60d22-112">Call the Routine to Receive a Request</span></span>](#call-the-routine-to-receive-a-request)
-   [<span data-ttu-id="60d22-113">Recevoir la demande</span><span class="sxs-lookup"><span data-stu-id="60d22-113">Receive the Request</span></span>](#receive-the-request)
-   [<span data-ttu-id="60d22-114">Gérer la requête HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-114">Handle the HTTP Request</span></span>](#handle-the-http-request)
-   [<span data-ttu-id="60d22-115">Envoyer la réponse HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-115">Send the HTTP Response</span></span>](#send-the-http-response)
-   [<span data-ttu-id="60d22-116">Envoyer la réponse HTTP Après</span><span class="sxs-lookup"><span data-stu-id="60d22-116">Send the HTTP POST Response</span></span>](#send-the-http-post-response)
-   [<span data-ttu-id="60d22-117">Nettoyer l’API du serveur HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-117">Clean Up the HTTP Server API</span></span>](#clean-up-the-http-server-api)

## <a name="initialize-the-http-service"></a><span data-ttu-id="60d22-118">Initialiser le service HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-118">Initialize the HTTP Service</span></span>

<span data-ttu-id="60d22-119">Le service HTTP est initialisé à l’aide de la fonction [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) , et le descripteur de la file d’attente de demandes est créé à l’aide de [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span><span class="sxs-lookup"><span data-stu-id="60d22-119">The HTTP service is initialized by using the [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) function, and the handle to the request queue is created by using [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span></span> <span data-ttu-id="60d22-120">Le serveur doit être initialisé avant de pouvoir appeler d’autres fonctions serveur.</span><span class="sxs-lookup"><span data-stu-id="60d22-120">The server must be initialized before any other server functions can be called.</span></span> <span data-ttu-id="60d22-121">La file d’attente des demandes doit être créée pour que le service puisse inscrire des URL afin d’écouter les requêtes HTTP entrantes.</span><span class="sxs-lookup"><span data-stu-id="60d22-121">The request queue must be created before the service can register URLs to listen for incoming HTTP requests.</span></span>

<span data-ttu-id="60d22-122">Pour plus d’informations et pour obtenir un exemple de code, consultez [initialiser le service http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="60d22-122">For more information and a code example, see [Initialize the HTTP Service](http-server-sample-application.md).</span></span>

## <a name="register-the-urls-to-listen-on"></a><span data-ttu-id="60d22-123">Inscrire les URL à écouter</span><span class="sxs-lookup"><span data-stu-id="60d22-123">Register the URLs to Listen On</span></span>

<span data-ttu-id="60d22-124">Pour que l’API du serveur HTTP écoute les demandes entrantes, des URL spécifiques sont inscrites auprès de l’API en appelant la fonction [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) .</span><span class="sxs-lookup"><span data-stu-id="60d22-124">For the HTTP Server API to listen for incoming requests, specific URLs are registered with the API by calling the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="60d22-125">Les demandes entrantes qui correspondent à ces URL sont routées vers la file d’attente de demandes spécifiée dans cet appel.</span><span class="sxs-lookup"><span data-stu-id="60d22-125">Incoming requests that match these URLs are routed to the request queue specified in this call.</span></span>

<span data-ttu-id="60d22-126">Pour plus d’informations et pour obtenir un exemple de code, consultez [inscrire les URL à écouter](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="60d22-126">For more information and a code example, see [Register the URLs to Listen On](http-server-sample-application.md).</span></span>

## <a name="call-the-routine-to-receive-a-request"></a><span data-ttu-id="60d22-127">Appeler la routine pour recevoir une demande</span><span class="sxs-lookup"><span data-stu-id="60d22-127">Call the Routine to Receive a Request</span></span>

<span data-ttu-id="60d22-128">La fonction DoReceiveRequest alloue la mémoire tampon de la demande, initialise l’ID de la demande et démarre la boucle pour recevoir des demandes.</span><span class="sxs-lookup"><span data-stu-id="60d22-128">The DoReceiveRequest function allocates the request buffer, initializes the request ID, and starts the loop to receive requests.</span></span>

<span data-ttu-id="60d22-129">Pour plus d’informations et pour obtenir un exemple de code, consultez [appeler la routine pour recevoir une demande](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="60d22-129">For more information and a code example, see [Call the Routine to Receive a Request](http-server-sample-application.md).</span></span>

## <a name="receive-the-request"></a><span data-ttu-id="60d22-130">Recevoir la demande</span><span class="sxs-lookup"><span data-stu-id="60d22-130">Receive the Request</span></span>

<span data-ttu-id="60d22-131">L’API du serveur HTTP fournit une structure de demande pour stocker la demande entrante analysée.</span><span class="sxs-lookup"><span data-stu-id="60d22-131">The HTTP Server API supplies a request structure to store the parsed incoming request.</span></span> <span data-ttu-id="60d22-132">Cette structure est allouée par l’application et initialisée lors de la réception d’une demande entrante.</span><span class="sxs-lookup"><span data-stu-id="60d22-132">This structure is allocated by the application, and initialized when an incoming request is received.</span></span> <span data-ttu-id="60d22-133">L’application appelle la fonction [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) pour recevoir la demande.</span><span class="sxs-lookup"><span data-stu-id="60d22-133">The application calls the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function to receive the request.</span></span> <span data-ttu-id="60d22-134">Si le tampon de demande est trop petit pour recevoir la demande, l’application peut augmenter la taille de la mémoire tampon et appeler à nouveau **HttpReceiveHttpRequest** pour recevoir la demande entière.</span><span class="sxs-lookup"><span data-stu-id="60d22-134">If the request buffer is too small to receive the request, the application can increase the buffer size and call **HttpReceiveHttpRequest** again to receive the entire request.</span></span>

<span data-ttu-id="60d22-135">Pour plus d’informations et pour obtenir un exemple de code, consultez [receive a request](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="60d22-135">For more information and a code example, see [Receive a Request](http-server-sample-application.md).</span></span>

## <a name="handle-the-http-request"></a><span data-ttu-id="60d22-136">Gérer la requête HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-136">Handle the HTTP Request</span></span>

<span data-ttu-id="60d22-137">L’exemple d’application montre comment gérer les verbes HTTP d’obtention et de requête après.</span><span class="sxs-lookup"><span data-stu-id="60d22-137">The sample application shows how to handle the HTTP GET and POST request verbs.</span></span> <span data-ttu-id="60d22-138">L’application envoie une erreur 503 (**non \_ implémentée**) si les verbes sont présents dans la demande que l’application ne gère pas.</span><span class="sxs-lookup"><span data-stu-id="60d22-138">The application sends a 503 (**NOT\_IMPLEMENTED**) error if verbs are present in the request that the application does not handle.</span></span>

<span data-ttu-id="60d22-139">Notez que l’URL à utiliser pour la gestion des demandes est l’URL traitée contenue dans le membre **CookedUrl** de la structure de la [**\_ requête HTTP \_ v1**](/windows/desktop/api/Http/ns-http-http_request_v1) .</span><span class="sxs-lookup"><span data-stu-id="60d22-139">Note that the URL to be used in handling requests is the processed URL contained in the **CookedUrl** member of the [**HTTP\_REQUEST\_V1**](/windows/desktop/api/Http/ns-http-http_request_v1) structure.</span></span> <span data-ttu-id="60d22-140">N’utilisez pas l’URL non traités dans le membre **pRawUrl** , qui est uniquement destiné au suivi et à des fins statistiques.</span><span class="sxs-lookup"><span data-stu-id="60d22-140">Do not the unprocessed URL in the **pRawUrl** member, which is solely for tracking and statistical purposes.</span></span>

<span data-ttu-id="60d22-141">Pour plus d’informations et pour obtenir un exemple de code, consultez [gérer la requête http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="60d22-141">For more information and a code example, see [Handle the HTTP Request](http-server-sample-application.md).</span></span>

## <a name="send-the-http-response"></a><span data-ttu-id="60d22-142">Envoyer la réponse HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-142">Send the HTTP Response</span></span>

<span data-ttu-id="60d22-143">La structure de la réponse est allouée et initialisée avec le code d’État et une phrase de raison dans la macro INITIALiser la \_ \_ réponse http.</span><span class="sxs-lookup"><span data-stu-id="60d22-143">The response structure is allocated and initialized with the status code and a reason phrase in the INITIALIZE\_HTTP\_RESPONSE macro.</span></span> <span data-ttu-id="60d22-144">Un en-tête HTTP connu est ajouté à la structure de la réponse dans la \_ \_ macro ajouter un en-tête connu, et le corps d’entité est ajouté à la réponse à partir d’un bloc de données à partir de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="60d22-144">A known HTTP header is added into the response structure in the ADD\_KNOWN\_HEADER macro, and the entity body is added to the response from a data block from memory.</span></span> <span data-ttu-id="60d22-145">La fonction [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) est appelée pour envoyer la réponse.</span><span class="sxs-lookup"><span data-stu-id="60d22-145">The [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function is called to send the response.</span></span> <span data-ttu-id="60d22-146">Dans cet exemple, l’application envoie une réponse simple 200 OK à la requête d’extraction.</span><span class="sxs-lookup"><span data-stu-id="60d22-146">In this example, the application sends a simple 200 OK response to the GET request.</span></span>

<span data-ttu-id="60d22-147">Pour plus d’informations et pour obtenir un exemple de code, consultez [Envoyer une réponse http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="60d22-147">For more information and a code example, see [Send an HTTP Response](http-server-sample-application.md).</span></span>

## <a name="send-the-http-post-response"></a><span data-ttu-id="60d22-148">Envoyer la réponse HTTP Après</span><span class="sxs-lookup"><span data-stu-id="60d22-148">Send the HTTP POST Response</span></span>

<span data-ttu-id="60d22-149">La demande de publication requiert plus de traitement que la demande d’extraction.</span><span class="sxs-lookup"><span data-stu-id="60d22-149">The POST request requires more processing than the GET request.</span></span> <span data-ttu-id="60d22-150">Le corps de l’entité de requête est reçu en appelant la fonction [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) .</span><span class="sxs-lookup"><span data-stu-id="60d22-150">The request entity body is received by calling the [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) function.</span></span> <span data-ttu-id="60d22-151">L’application envoie la réponse et le corps de l’entité de réponse dans des appels distincts à l’API du serveur HTTP.</span><span class="sxs-lookup"><span data-stu-id="60d22-151">The application sends the response and the response entity body in separate calls to the HTTP Server API.</span></span> <span data-ttu-id="60d22-152">Les en-têtes de réponse sont envoyés avec le [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse).</span><span class="sxs-lookup"><span data-stu-id="60d22-152">The response headers are sent with the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse).</span></span> <span data-ttu-id="60d22-153">Le corps d’entité est envoyé dans un bloc de données à partir d’un descripteur de fichier avec la fonction [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="60d22-153">The entity body is sent in a data block from a file handle with the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span>

<span data-ttu-id="60d22-154">Pour plus d’informations et pour obtenir un exemple de code, consultez [Envoyer une réponse http après](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="60d22-154">For more information and a code example, see [Send an HTTP POST Response](http-server-sample-application.md).</span></span>

## <a name="clean-up-the-http-server-api"></a><span data-ttu-id="60d22-155">Nettoyer l’API du serveur HTTP</span><span class="sxs-lookup"><span data-stu-id="60d22-155">Clean Up the HTTP Server API</span></span>

<span data-ttu-id="60d22-156">Les opérations de nettoyage pour l’API du serveur HTTP sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="60d22-156">The cleanup operations for the HTTP Server API include:</span></span>

-   <span data-ttu-id="60d22-157">Suppression de toutes les URL inscrites.</span><span class="sxs-lookup"><span data-stu-id="60d22-157">Removing all registered URLs.</span></span>
-   <span data-ttu-id="60d22-158">Fermeture du handle vers la file d’attente des demandes.</span><span class="sxs-lookup"><span data-stu-id="60d22-158">Closing the handle to the request queue.</span></span>
-   <span data-ttu-id="60d22-159">Fin des ressources créées par l’API du serveur HTTP.</span><span class="sxs-lookup"><span data-stu-id="60d22-159">Terminating the resources created by the HTTP Server API.</span></span>

<span data-ttu-id="60d22-160">L’application appelle la fonction [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl) pour annuler l’inscription des URL inscrites par la fonction [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) initiale.</span><span class="sxs-lookup"><span data-stu-id="60d22-160">The application calls the [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl) function to deregister URLs registered by the initial [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="60d22-161">L’application appelle également [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) pour chaque appel à [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) avec les paramètres d’indicateur correspondants.</span><span class="sxs-lookup"><span data-stu-id="60d22-161">The application also calls [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) for each call to [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) with matching flag settings.</span></span> <span data-ttu-id="60d22-162">Cet appel met fin à toutes les ressources créées par l’appel à **HttpInitialize**.</span><span class="sxs-lookup"><span data-stu-id="60d22-162">This call terminates all resources created by the call to **HttpInitialize**.</span></span>

<span data-ttu-id="60d22-163">Pour plus d’informations et pour obtenir un exemple de code, consultez [nettoyer l’API du serveur http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="60d22-163">For more information and a code example, see [Cleanup the HTTP Server API](http-server-sample-application.md).</span></span>

 

 




