---
title: Activation des fonctionnalités Internet
description: Avant d’utiliser les fonctions WinINet, l’application doit tenter d’établir une connexion à Internet à l’aide de la fonction InternetAttemptConnect.
ms.assetid: 80747c0d-5a09-4ffa-a0ca-b051b82acbf8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: adb44fadaf0726b81618dde19105da7517673a00
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031723"
---
# <a name="enabling-internet-functionality"></a><span data-ttu-id="93e75-103">Activation des fonctionnalités Internet</span><span class="sxs-lookup"><span data-stu-id="93e75-103">Enabling Internet Functionality</span></span>

<span data-ttu-id="93e75-104">Avant d’utiliser les fonctions WinINet, l’application doit tenter d’établir une connexion à Internet à l’aide de la fonction [**InternetAttemptConnect**](/windows/desktop/api/Wininet/nf-wininet-internetattemptconnect) .</span><span class="sxs-lookup"><span data-stu-id="93e75-104">Before using the WinINet functions, the application should attempt to make a connection to the Internet by using the [**InternetAttemptConnect**](/windows/desktop/api/Wininet/nf-wininet-internetattemptconnect) function.</span></span> <span data-ttu-id="93e75-105">Cette fonction appelle la boîte de dialogue d’accès à distance pour établir une connexion à Internet ou vérifier si une connexion existe déjà.</span><span class="sxs-lookup"><span data-stu-id="93e75-105">This function calls the dial-up dialog box to initiate a connection to the Internet or check if a connection already exists.</span></span> <span data-ttu-id="93e75-106">Si cette fonction échoue, l’application peut passer en mode hors connexion, ce qui lui permet d’accéder aux informations mises en cache lors des connexions précédentes à Internet.</span><span class="sxs-lookup"><span data-stu-id="93e75-106">If this function fails, the application can enter offline mode, which allows it to access information that was cached during previous connections to the Internet.</span></span>

<span data-ttu-id="93e75-107">Utilisez la fonction [**InternetCheckConnection**](/windows/desktop/api/Wininet/nf-wininet-internetcheckconnectiona) pour vérifier la connexion à Internet.</span><span class="sxs-lookup"><span data-stu-id="93e75-107">Use the [**InternetCheckConnection**](/windows/desktop/api/Wininet/nf-wininet-internetcheckconnectiona) function to check the connection to the Internet.</span></span> <span data-ttu-id="93e75-108">Elle tente d’effectuer un test ping sur le serveur désigné par l’URL transmise à la fonction.</span><span class="sxs-lookup"><span data-stu-id="93e75-108">It attempts to ping the server designated by the URL that is passed to the function.</span></span> <span data-ttu-id="93e75-109">Si l’indicateur \_ de \_ connexion de force ICC \_ est défini et que l’URL est **null**, la fonction vérifie s’il existe une entrée dans la base de données du serveur pour le serveur le plus proche.</span><span class="sxs-lookup"><span data-stu-id="93e75-109">If the FLAG\_ICC\_FORCE\_CONNECTION flag is set and the URL is **NULL**, the function checks to see if there is an entry in the server database for the nearest server.</span></span> <span data-ttu-id="93e75-110">S’il en existe un, la fonction exécute une commande ping sur ce serveur.</span><span class="sxs-lookup"><span data-stu-id="93e75-110">If one exists, the function pings that server.</span></span>

<span data-ttu-id="93e75-111">Ensuite, utilisez la fonction [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) pour définir les caractéristiques de la connexion Internet que l’application cliente utilise.</span><span class="sxs-lookup"><span data-stu-id="93e75-111">Next, use the [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) function to establish the characteristics of the Internet connection the client application is using.</span></span> <span data-ttu-id="93e75-112">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) crée le descripteur [**HINTERNET**](appendix-a-hinternet-handles.md) racine qui est utilisé pour établir des sessions [http](http-sessions.md)[FTP](ftp-sessions.md) .</span><span class="sxs-lookup"><span data-stu-id="93e75-112">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) creates the root [**HINTERNET**](appendix-a-hinternet-handles.md) handle that is used to establish [http](http-sessions.md)[ftp](ftp-sessions.md) sessions.</span></span> <span data-ttu-id="93e75-113">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) ne teste pas la connexion à Internet pour vérifier que les caractéristiques transmises à la fonction sont correctes.</span><span class="sxs-lookup"><span data-stu-id="93e75-113">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) does not test the connection to the Internet to verify that the characteristics passed to the function are correct.</span></span>

<span data-ttu-id="93e75-114">Utilisez la fonction [**internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) pour créer une session spécifique.</span><span class="sxs-lookup"><span data-stu-id="93e75-114">Use the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function to create a specific session.</span></span> <span data-ttu-id="93e75-115">[**Internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) Initialise une session pour le site spécifié à l’aide des arguments qui lui sont passés et crée un handle [**HINTERNET**](appendix-a-hinternet-handles.md) qui est une branche du handle racine.</span><span class="sxs-lookup"><span data-stu-id="93e75-115">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) initializes a session for the specified site using the arguments passed to it and creates an [**HINTERNET**](appendix-a-hinternet-handles.md) handle that is a branch off the root handle.</span></span> <span data-ttu-id="93e75-116">[**Internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) n’essaie pas d’accéder ou d’établir une connexion au site spécifié, sauf dans le cas d’une session FTP.</span><span class="sxs-lookup"><span data-stu-id="93e75-116">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) does not attempt to access or establish a connection to the specified site, except in the case of an FTP session.</span></span> <span data-ttu-id="93e75-117">Les fonctions [**FtpFindFirstFile**](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea), [**FtpOpenFile**](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea)et [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta) utilisent le descripteur créé par [**internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) pour établir une connexion au site spécifié.</span><span class="sxs-lookup"><span data-stu-id="93e75-117">[**FtpFindFirstFile**](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea), [**FtpOpenFile**](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea), and [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta) functions use the handle created by [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) to establish a connection to the specified site.</span></span>

## <a name="using-internetopen"></a><span data-ttu-id="93e75-118">Utilisation de InternetOpen</span><span class="sxs-lookup"><span data-stu-id="93e75-118">Using InternetOpen</span></span>

<span data-ttu-id="93e75-119">Pour activer une connexion à Internet, vous devez créer un descripteur [**HINTERNET**](appendix-a-hinternet-handles.md) racine à l’aide de [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="93e75-119">To enable a connection to the Internet, a root [**HINTERNET**](appendix-a-hinternet-handles.md) handle must be created by using [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span> <span data-ttu-id="93e75-120">Informations sur l’agent utilisateur (l’application appelant les fonctions Internet), le type d’accès à Internet, les noms de proxy, les hôtes et les adresses qui contournent le proxy, et le comportement est passé à [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="93e75-120">Information about the user agent (the application calling the Internet functions), the type of access to the Internet, the proxy names, the hosts and addresses that bypass the proxy, and the behavior are passed to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span>

### <a name="setting-the-user-agent"></a><span data-ttu-id="93e75-121">Configuration de l’agent utilisateur</span><span class="sxs-lookup"><span data-stu-id="93e75-121">Setting the User Agent</span></span>

<span data-ttu-id="93e75-122">L’application appelante doit fournir une chaîne qui contient le nom de l’application ou de l’entité qui accède à Internet au paramètre *lpszAgent* de [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="93e75-122">The calling application should give a string that contains the name of the application or entity accessing the Internet to the *lpszAgent* parameter of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span> <span data-ttu-id="93e75-123">Cette chaîne est utilisée comme agent utilisateur dans le protocole HTTP.</span><span class="sxs-lookup"><span data-stu-id="93e75-123">This string is used as the user agent in the HTTP protocol.</span></span> <span data-ttu-id="93e75-124">Par exemple, Microsoft Internet Explorer utilise « Microsoft Internet Explorer ».</span><span class="sxs-lookup"><span data-stu-id="93e75-124">For example, Microsoft Internet Explorer uses "Microsoft Internet Explorer".</span></span>

### <a name="setting-access-types"></a><span data-ttu-id="93e75-125">Définition des types d’accès</span><span class="sxs-lookup"><span data-stu-id="93e75-125">Setting Access Types</span></span>

<span data-ttu-id="93e75-126">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) prend en charge trois types d’accès :</span><span class="sxs-lookup"><span data-stu-id="93e75-126">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) supports three access types:</span></span>

-   <span data-ttu-id="93e75-127">Utilisez \_ \_ le type Open Internet \_ direct si le système sur lequel l’application s’exécute utilise une connexion directe à Internet.</span><span class="sxs-lookup"><span data-stu-id="93e75-127">Use INTERNET\_OPEN\_TYPE\_DIRECT if the system on which the application is running uses a direct connection to the Internet.</span></span> <span data-ttu-id="93e75-128">Les paramètres *lpszProxyName* et *lpszProxyBypass* de [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) ne sont pas utilisés et doivent avoir la valeur **null**.</span><span class="sxs-lookup"><span data-stu-id="93e75-128">The *lpszProxyName* and *lpszProxyBypass* parameters of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) are not used and should be set to **NULL**.</span></span>
-   <span data-ttu-id="93e75-129">Utilisez \_ \_ le proxy de type Internet Open \_ si le système sur lequel l’application s’exécute utilise un ou plusieurs serveurs proxy pour accéder à Internet.</span><span class="sxs-lookup"><span data-stu-id="93e75-129">Use INTERNET\_OPEN\_TYPE\_PROXY if the system on which the application is running uses one or more proxy servers to access the Internet.</span></span> <span data-ttu-id="93e75-130">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) utilise les serveurs proxy indiqués par *lpszProxyName* et contourne le proxy pour tous les noms d’hôte ou adresses IP spécifiés par *lpszProxyBypass*.</span><span class="sxs-lookup"><span data-stu-id="93e75-130">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) uses the proxy servers indicated by *lpszProxyName* and bypasses the proxy for any host names or IP addresses specified by *lpszProxyBypass*.</span></span>
-   <span data-ttu-id="93e75-131">Utilisez \_ \_ \_ la préconfiguration du type ouvert sur Internet pour indiquer à votre application d’extraire la configuration du Registre.</span><span class="sxs-lookup"><span data-stu-id="93e75-131">Use INTERNET\_OPEN\_TYPE\_PRECONFIG to instruct your application to retrieve the configuration from the registry.</span></span> <span data-ttu-id="93e75-132">C’est généralement le meilleur choix, car la plupart des applications, y compris les navigateurs Web, utilisent cette option.</span><span class="sxs-lookup"><span data-stu-id="93e75-132">This is typically the best choice, as most applications including web browsers use this option.</span></span>

<span data-ttu-id="93e75-133">\_ \_ La préconfiguration de type ouvert Internet \_ examine les valeurs de Registre **ProxyEnable**, **ProxyServer** et **ProxyOverride**.</span><span class="sxs-lookup"><span data-stu-id="93e75-133">INTERNET\_OPEN\_TYPE\_PRECONFIG looks at the registry values **ProxyEnable**, **ProxyServer**, and **ProxyOverride**.</span></span> <span data-ttu-id="93e75-134">Ces valeurs se trouvent sous « HKEY \_ Current \_ User \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Internet Settings ».</span><span class="sxs-lookup"><span data-stu-id="93e75-134">These values are located under "HKEY\_CURRENT\_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings".</span></span>

<span data-ttu-id="93e75-135">Si **ProxyEnable** est égal à zéro, l’application utilise le \_ type Open Internet \_ \_ direct.</span><span class="sxs-lookup"><span data-stu-id="93e75-135">If **ProxyEnable** is zero, the application uses INTERNET\_OPEN\_TYPE\_DIRECT.</span></span> <span data-ttu-id="93e75-136">Dans le cas contraire, l’application utilise \_ \_ le proxy de type ouvert Internet \_ et utilise les informations **ProxyServer** et **ProxyOverride** .</span><span class="sxs-lookup"><span data-stu-id="93e75-136">Otherwise, the application uses INTERNET\_OPEN\_TYPE\_PROXY and uses the **ProxyServer** and **ProxyOverride** information.</span></span>

<span data-ttu-id="93e75-137">Les fonctions WinINet prennent en charge les proxys de type SOCKS uniquement si Internet Explorer est installé.</span><span class="sxs-lookup"><span data-stu-id="93e75-137">The WinINet functions provide support for SOCKS type proxies only if Internet Explorer is installed.</span></span> <span data-ttu-id="93e75-138">L’installation d’Internet Explorer comprend le fichier Wsock32n.dll, qui est nécessaire pour prendre en charge les proxys SOCKS.</span><span class="sxs-lookup"><span data-stu-id="93e75-138">The installation of Internet Explorer includes the Wsock32n.dll file, which is needed to support SOCKS proxies.</span></span> <span data-ttu-id="93e75-139">Wsock32n.dll n’est pas redistribuable.</span><span class="sxs-lookup"><span data-stu-id="93e75-139">Wsock32n.dll is not redistributable.</span></span>

### <a name="listing-proxy-servers"></a><span data-ttu-id="93e75-140">Liste des serveurs proxy</span><span class="sxs-lookup"><span data-stu-id="93e75-140">Listing Proxy Servers</span></span>

<span data-ttu-id="93e75-141">WinINet reconnaît deux types de proxies : les proxys de type CERN (HTTP uniquement) et les proxys FTP TIS (FTP uniquement).</span><span class="sxs-lookup"><span data-stu-id="93e75-141">WinINet recognizes two types of proxies: CERN type proxies (HTTP only) and TIS FTP proxies (FTP only).</span></span> <span data-ttu-id="93e75-142">Si Internet Explorer est installé, WinINet prend également en charge les proxys de type SOCKS.</span><span class="sxs-lookup"><span data-stu-id="93e75-142">If Internet Explorer is installed, WinINet also support SOCKS type proxies.</span></span> <span data-ttu-id="93e75-143">[**Internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) suppose, par défaut, que le proxy spécifié est un proxy CERN.</span><span class="sxs-lookup"><span data-stu-id="93e75-143">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) assumes, by default, that the specified proxy is a CERN proxy.</span></span> <span data-ttu-id="93e75-144">Si le type d’accès est défini sur INTERNET \_ Open \_ type direct ou sur la \_ \_ \_ \_ préconfiguration de type Open Internet, le paramètre *LpszProxyName* de [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) doit avoir la valeur **null**.</span><span class="sxs-lookup"><span data-stu-id="93e75-144">If the access type is set to INTERNET\_OPEN\_TYPE\_DIRECT or INTERNET\_OPEN\_TYPE\_PRECONFIG, the *lpszProxyName* parameter of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) should be set to **NULL**.</span></span> <span data-ttu-id="93e75-145">Dans le cas contraire, la valeur transmise à *lpszProxyName* doit contenir les proxies dans une chaîne délimitée par des espaces.</span><span class="sxs-lookup"><span data-stu-id="93e75-145">Otherwise, the value passed to *lpszProxyName* must contain the proxies in a space-delimited string.</span></span> <span data-ttu-id="93e75-146">Les listes de proxy peuvent contenir le numéro de port utilisé pour accéder au proxy.</span><span class="sxs-lookup"><span data-stu-id="93e75-146">The proxy listings can contain the port number that is used to access the proxy.</span></span>

<span data-ttu-id="93e75-147">Pour répertorier un proxy pour un protocole spécifique, la chaîne doit respecter le format « » <protocol> <protocol> ://<\_ nom du proxy> « ».</span><span class="sxs-lookup"><span data-stu-id="93e75-147">To list a proxy for a specific protocol, the string must follow the format ""<protocol><protocol>://<proxy\_name>"".</span></span> <span data-ttu-id="93e75-148">Les protocoles valides sont HTTP, HTTPs et FTP.</span><span class="sxs-lookup"><span data-stu-id="93e75-148">The valid protocols are HTTP, HTTPS and FTP.</span></span> <span data-ttu-id="93e75-149">Par exemple, pour répertorier un proxy FTP, une chaîne valide serait « » ftp = ftp://FTP \_ proxy \_ Name : 21 " », où FTP \_ proxy \_ Name est le nom du proxy FTP et 21 le numéro de port qui doit être utilisé pour accéder au proxy.</span><span class="sxs-lookup"><span data-stu-id="93e75-149">For example, to list an FTP proxy, a valid string would be ""ftp=ftp://ftp\_proxy\_name:21"", where ftp\_proxy\_name is the name of the FTP proxy and 21 is the port number that must be used to access the proxy.</span></span> <span data-ttu-id="93e75-150">Si le proxy utilise le numéro de port par défaut pour ce protocole, le numéro de port peut être omis.</span><span class="sxs-lookup"><span data-stu-id="93e75-150">If the proxy uses the default port number for that protocol, the port number can be omitted.</span></span> <span data-ttu-id="93e75-151">Si un nom de proxy est listé par lui-même, il est utilisé comme proxy par défaut pour tous les protocoles qui n’ont pas de proxy spécifique spécifié.</span><span class="sxs-lookup"><span data-stu-id="93e75-151">If a proxy name is listed by itself, it is used as the default proxy for any protocols that do not have a specific proxy specified.</span></span> <span data-ttu-id="93e75-152">Par exemple, « http = https://http\_proxy other » utilise \_ un proxy HTTP pour toutes les opérations http, tandis que tous les autres protocoles utiliseraient other.</span><span class="sxs-lookup"><span data-stu-id="93e75-152">For example, ""http=https://http\_proxy other"" would use http\_proxy for any HTTP operations, while all other protocols would use other.</span></span>

<span data-ttu-id="93e75-153">Par défaut, la fonction suppose que le proxy spécifié par *lpszProxyName* est un proxy CERN.</span><span class="sxs-lookup"><span data-stu-id="93e75-153">By default, the function assumes that the proxy specified by *lpszProxyName* is a CERN proxy.</span></span> <span data-ttu-id="93e75-154">Une application peut spécifier plusieurs proxys, y compris des proxies différents pour les différents protocoles.</span><span class="sxs-lookup"><span data-stu-id="93e75-154">An application can specify more than one proxy, including different proxies for the different protocols.</span></span> <span data-ttu-id="93e75-155">Par exemple, si vous spécifiez «"ftp = ftp://FTP-GW HTTP = https://jericho:99 proxy" ", les demandes FTP sont effectuées via le proxy FTP-GW, qui écoute le port 21, et les requêtes http sont effectuées via un proxy CERN appelé Jéricho, qui écoute le port 99.</span><span class="sxs-lookup"><span data-stu-id="93e75-155">For example, if you specify ""ftp=ftp://ftp-gw HTTP=https://jericho:99 proxy"", FTP requests are made through the ftp-gw proxy, which listens at port 21, and HTTP requests are made through a CERN proxy called jericho, which listens at port 99.</span></span> <span data-ttu-id="93e75-156">Sinon, les requêtes HTTP sont effectuées via le proxy CERN appelé proxy, qui écoute le port 80.</span><span class="sxs-lookup"><span data-stu-id="93e75-156">Otherwise, HTTP requests would be made through the CERN proxy called proxy, which listens at port 80.</span></span> <span data-ttu-id="93e75-157">Notez que si l’application utilise uniquement FTP, par exemple, elle n’a pas besoin de spécifier « » ftp = ftp://FTP-GW : 21 " ».</span><span class="sxs-lookup"><span data-stu-id="93e75-157">Note that if the application is only using FTP, for example, it would not need to specify ""ftp=ftp://ftp-gw:21"".</span></span> <span data-ttu-id="93e75-158">Il peut spécifier simplement «« FTP-GW »».</span><span class="sxs-lookup"><span data-stu-id="93e75-158">It could specify just ""ftp-gw"".</span></span> <span data-ttu-id="93e75-159">Une application est uniquement requise pour spécifier les noms de protocole si elle utilise plusieurs protocoles par handle renvoyé par [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="93e75-159">An application is only required to specify the protocol names if it is using more than one protocol per handle returned by [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span>

### <a name="listing-the-proxy-bypass"></a><span data-ttu-id="93e75-160">Affichage du contournement du proxy</span><span class="sxs-lookup"><span data-stu-id="93e75-160">Listing the Proxy Bypass</span></span>

<span data-ttu-id="93e75-161">Les noms d’hôtes ou adresses IP qui ne doivent pas être envoyés au proxy peuvent être répertoriés dans la liste de contournement du proxy.</span><span class="sxs-lookup"><span data-stu-id="93e75-161">Host names or IP addresses that should not be sent to the proxy can be listed in the proxy bypass list.</span></span> <span data-ttu-id="93e75-162">Cette liste peut contenir des caractères génériques, « \* », qui obligent l’application à contourner le serveur proxy pour les adresses qui correspondent au modèle spécifié.</span><span class="sxs-lookup"><span data-stu-id="93e75-162">This list can contain wildcards, "\*", which cause the application to bypass the proxy server for addresses that fit the specified pattern.</span></span> <span data-ttu-id="93e75-163">Pour répertorier plusieurs adresses et noms d’hôtes, séparez-les par des points-virgules dans la chaîne de contournement du proxy.</span><span class="sxs-lookup"><span data-stu-id="93e75-163">To list multiple addresses and host names, separate them with semicolons in the proxy bypass string.</span></span> <span data-ttu-id="93e75-164">Si la <local> macro «» est spécifiée, la fonction contourne le proxy pour tout nom d’hôte qui ne contient pas de point.</span><span class="sxs-lookup"><span data-stu-id="93e75-164">If the "<local>" macro is specified, the function bypasses the proxy for any host name that does not contain a period.</span></span>

<span data-ttu-id="93e75-165">Par défaut, WinINet contournera le proxy pour les demandes qui utilisent les noms d’hôte « localhost », « Loopback », « 127.0.0.1 » ou « \[ :: 1 \] ».</span><span class="sxs-lookup"><span data-stu-id="93e75-165">By default, WinINet will bypass the proxy for requests that use the host names "localhost", "loopback", "127.0.0.1", or "\[::1\]".</span></span> <span data-ttu-id="93e75-166">Ce comportement existe parce qu’un serveur proxy distant ne résout généralement pas correctement ces adresses.</span><span class="sxs-lookup"><span data-stu-id="93e75-166">This behavior exists because a remote proxy server typically will not resolve these addresses properly.</span></span>

<span data-ttu-id="93e75-167">**Internet Explorer 9 :** Vous pouvez supprimer l’ordinateur local de la liste de contournement du proxy à l’aide de la macro « <-loopback> ».</span><span class="sxs-lookup"><span data-stu-id="93e75-167">**Internet Explorer 9:** You can remove the local computer from the proxy bypass list using the "<-loopback>" macro.</span></span>

<span data-ttu-id="93e75-168">L’exemple suivant montre des exemples d’appels à [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) à l’aide de différentes chaînes de contournement du proxy.</span><span class="sxs-lookup"><span data-stu-id="93e75-168">The following example shows sample calls to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) using different proxy bypass strings.</span></span> <span data-ttu-id="93e75-169">Les commentaires au-dessus de chaque appel décrivent l’effet de la chaîne de contournement sur les noms d’hôte qui sont accessibles à partir du handle [**HINTERNET**](appendix-a-hinternet-handles.md) qu’elle crée.</span><span class="sxs-lookup"><span data-stu-id="93e75-169">The comments above each call describe what effect the bypass string has on the host names that are accessed from the [**HINTERNET**](appendix-a-hinternet-handles.md) handle it creates.</span></span>


```C++
HINTERNET hInternetRoot;

/* bypass the proxy for any host name that does not 
    contain a period */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("<local>"), 0);

/* bypass the proxy for any host name that starts with the 
    letters "ms" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("ms*"), 0);

/* bypass the proxy for any host name that contains "int", 
    such as "internet" and "painter" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("*int*"), 0);

/* bypass the proxy for the host name "example" and any 
    host name that contains "test" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("example *test*"), 0);

/* Disable the loopback proxy bypass for localhost */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("127.0.0.1:8888"),TEXT("<-loopback>"), 0);
```



## <a name="using-internetconnect"></a><span data-ttu-id="93e75-170">Utilisation de InternetConnect</span><span class="sxs-lookup"><span data-stu-id="93e75-170">Using InternetConnect</span></span>

<span data-ttu-id="93e75-171">Pour commencer une session, la fonction [**internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) doit créer un handle à partir du handle racine retourné par la fonction [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) .</span><span class="sxs-lookup"><span data-stu-id="93e75-171">To begin a session, the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function must create a handle off the root handle returned by the [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) function.</span></span> <span data-ttu-id="93e75-172">[**Internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) définit l’adresse du serveur, le numéro de port, le nom d’utilisateur, le mot de passe et le type de service.</span><span class="sxs-lookup"><span data-stu-id="93e75-172">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) sets the server address, port number, user name, password, and type of service.</span></span>

<span data-ttu-id="93e75-173">[**Internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) utilise le handle [**HINTERNET**](appendix-a-hinternet-handles.md) racine créé par [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) pour établir un handle de session.</span><span class="sxs-lookup"><span data-stu-id="93e75-173">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) uses the root [**HINTERNET**](appendix-a-hinternet-handles.md) handle created by [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) to establish a session handle.</span></span> <span data-ttu-id="93e75-174">Si l' [indicateur \_ \_ Async de l’indicateur Internet](api-flags.md) a été défini dans l’appel à [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), l’appel à [**internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) doit inclure une valeur de contexte différente de zéro.</span><span class="sxs-lookup"><span data-stu-id="93e75-174">If the [INTERNET\_FLAG\_ASYNC](api-flags.md) flag was set in the call to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), the call to [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) should include a nonzero context value.</span></span>

<span data-ttu-id="93e75-175">Le nom du serveur peut contenir soit le nom d’hôte (par exemple, « www.servername.com »), soit le numéro d’adresse IP du site au format décimal avec points ASCII (par exemple, « 10.0.1.45 »).</span><span class="sxs-lookup"><span data-stu-id="93e75-175">The server name can contain either the host name (for example, "www.servername.com") or IP number of the site in ASCII dotted-decimal format (for example, "10.0.1.45").</span></span>

<span data-ttu-id="93e75-176">Le port du serveur est le numéro de port TCP/IP (Transmission Control Protocol/Internet Protocol) auquel se connecter sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="93e75-176">The server port is the Transmission Control Protocol/Internet Protocol (TCP/IP) port number to connect to on the server.</span></span> <span data-ttu-id="93e75-177">[**Internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) utilise le port par défaut pour le type de service sélectionné si la \_ valeur de numéro de port Internet non valide \_ \_ est utilisée.</span><span class="sxs-lookup"><span data-stu-id="93e75-177">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) uses the default port for the selected service type if the INTERNET\_INVALID\_PORT\_NUMBER value is used.</span></span> <span data-ttu-id="93e75-178">Les tableaux suivants contiennent les valeurs par défaut du port du serveur pour WinINet.</span><span class="sxs-lookup"><span data-stu-id="93e75-178">The following tables contain the server port defaults for WinINet.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="93e75-179">Valeur</span><span class="sxs-lookup"><span data-stu-id="93e75-179">Value</span></span></th>
<th><span data-ttu-id="93e75-180">Signification</span><span class="sxs-lookup"><span data-stu-id="93e75-180">Meaning</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="93e75-181">INTERNET_DEFAULT_FTP_PORT</span><span class="sxs-lookup"><span data-stu-id="93e75-181">INTERNET_DEFAULT_FTP_PORT</span></span></td>
<td><span data-ttu-id="93e75-182">Utilisez le port par défaut pour les serveurs FTP (port 21).</span><span class="sxs-lookup"><span data-stu-id="93e75-182">Use the default port for ftp servers (port 21).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="93e75-183">INTERNET_DEFAULT_GOPHER_PORT</span><span class="sxs-lookup"><span data-stu-id="93e75-183">INTERNET_DEFAULT_GOPHER_PORT</span></span></td>
<td><span data-ttu-id="93e75-184">Utilisez le port par défaut pour les serveurs Gopher (port 70).</span><span class="sxs-lookup"><span data-stu-id="93e75-184">Use the default port for gopher servers (port 70).</span></span>
<blockquote>
[!Note]<br />
<span data-ttu-id="93e75-185">Windows XP et Windows Server 2003 R2 et versions antérieures uniquement.</span><span class="sxs-lookup"><span data-stu-id="93e75-185">Windows XP and Windows Server 2003 R2 and earlier only.</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="93e75-186">INTERNET_DEFAULT_HTTP_PORT</span><span class="sxs-lookup"><span data-stu-id="93e75-186">INTERNET_DEFAULT_HTTP_PORT</span></span></td>
<td><span data-ttu-id="93e75-187">Utilisez le port par défaut pour les serveurs http (port 80).</span><span class="sxs-lookup"><span data-stu-id="93e75-187">Use the default port for http servers (port 80).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="93e75-188">INTERNET_DEFAULT_HTTPS_PORT</span><span class="sxs-lookup"><span data-stu-id="93e75-188">INTERNET_DEFAULT_HTTPS_PORT</span></span></td>
<td><span data-ttu-id="93e75-189">Utilisez le port par défaut pour les serveurs HTTPS (port 443).</span><span class="sxs-lookup"><span data-stu-id="93e75-189">Use the default port for https servers (port 443).</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="93e75-190">INTERNET_DEFAULT_SOCKS_PORT</span><span class="sxs-lookup"><span data-stu-id="93e75-190">INTERNET_DEFAULT_SOCKS_PORT</span></span></td>
<td><span data-ttu-id="93e75-191">Utilisez le port par défaut pour les serveurs de pare-feu SOCKS (port 1080).</span><span class="sxs-lookup"><span data-stu-id="93e75-191">Use the default port for SOCKS firewall servers (port 1080).</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="defining-the-user-name-and-password"></a><span data-ttu-id="93e75-192">Définition du nom d’utilisateur et du mot de passe</span><span class="sxs-lookup"><span data-stu-id="93e75-192">Defining the User Name and Password</span></span>

<span data-ttu-id="93e75-193">La valeur de *lpszUsername* est l’adresse d’une chaîne terminée par le caractère **null** qui contient le nom de l’utilisateur qui se connecte.</span><span class="sxs-lookup"><span data-stu-id="93e75-193">The value of *lpszUsername* is the address of a **null**-terminated string that contains the name of the user who is logging on.</span></span> <span data-ttu-id="93e75-194">Si ce paramètre a la **valeur null**, la fonction utilise une valeur par défaut appropriée, à l’exception de http.</span><span class="sxs-lookup"><span data-stu-id="93e75-194">If this parameter is **NULL**, the function uses an appropriate default, except for HTTP.</span></span> <span data-ttu-id="93e75-195">Un paramètre **null** dans http entraîne le renvoi d’une erreur par le serveur.</span><span class="sxs-lookup"><span data-stu-id="93e75-195">A **NULL** parameter in HTTP causes the server to return an error.</span></span> <span data-ttu-id="93e75-196">Pour le protocole FTP, la valeur par défaut est Anonymous.</span><span class="sxs-lookup"><span data-stu-id="93e75-196">For the FTP protocol, the default is anonymous.</span></span>

<span data-ttu-id="93e75-197">La valeur de *lpszPassword* est l’adresse d’une chaîne terminée par le caractère **null** qui contient le mot de passe de connexion.</span><span class="sxs-lookup"><span data-stu-id="93e75-197">The value of *lpszPassword* is the address of a **null**-terminated string that contains the log-on password.</span></span> <span data-ttu-id="93e75-198">Si *lpszUsername* et *lpszPassword* ont tous les deux la **valeur null**, la fonction utilise le mot de passe anonyme par défaut.</span><span class="sxs-lookup"><span data-stu-id="93e75-198">If both *lpszUsername* and *lpszPassword* are **NULL**, the function uses the default anonymous password.</span></span> <span data-ttu-id="93e75-199">Dans le cas de FTP, le mot de passe anonyme par défaut est le nom de messagerie de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="93e75-199">In the case of FTP, the default anonymous password is the user's email name.</span></span> <span data-ttu-id="93e75-200">Si *lpszUsername* n’a pas la **valeur null** et que *lpszPassword* a la **valeur null**, la fonction utilise un mot de passe vide.</span><span class="sxs-lookup"><span data-stu-id="93e75-200">If *lpszUsername* is not **NULL** and *lpszPassword* is **NULL**, the function uses a blank password.</span></span> <span data-ttu-id="93e75-201">Il existe quatre paramètres possibles de *lpszUsername* et *lpszPassword*, qui produisent les comportements indiqués dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="93e75-201">There are four possible settings of *lpszUsername* and *lpszPassword*, which produce the behaviors shown in the following table.</span></span>



| <span data-ttu-id="93e75-202">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="93e75-202">*lpszUsername*</span></span>      | <span data-ttu-id="93e75-203">*lpszPassword*</span><span class="sxs-lookup"><span data-stu-id="93e75-203">*lpszPassword*</span></span>      | <span data-ttu-id="93e75-204">Nom d’utilisateur envoyé au serveur FTP</span><span class="sxs-lookup"><span data-stu-id="93e75-204">User name sent to FTP server</span></span> | <span data-ttu-id="93e75-205">Mot de passe envoyé au serveur FTP</span><span class="sxs-lookup"><span data-stu-id="93e75-205">Password sent to FTP server</span></span> |
|---------------------|---------------------|------------------------------|-----------------------------|
| <span data-ttu-id="93e75-206">**NULL**</span><span class="sxs-lookup"><span data-stu-id="93e75-206">**NULL**</span></span>            | <span data-ttu-id="93e75-207">**NULL**</span><span class="sxs-lookup"><span data-stu-id="93e75-207">**NULL**</span></span>            | <span data-ttu-id="93e75-208">façon</span><span class="sxs-lookup"><span data-stu-id="93e75-208">"anonymous"</span></span>                  | <span data-ttu-id="93e75-209">Nom de messagerie de l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="93e75-209">User's email name</span></span>           |
| <span data-ttu-id="93e75-210">Chaîne non **null**</span><span class="sxs-lookup"><span data-stu-id="93e75-210">Non-**NULL** string</span></span> | <span data-ttu-id="93e75-211">**NULL**</span><span class="sxs-lookup"><span data-stu-id="93e75-211">**NULL**</span></span>            | <span data-ttu-id="93e75-212">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="93e75-212">*lpszUsername*</span></span>               | <span data-ttu-id="93e75-213">""</span><span class="sxs-lookup"><span data-stu-id="93e75-213">""</span></span>                          |
| <span data-ttu-id="93e75-214">**NULL**</span><span class="sxs-lookup"><span data-stu-id="93e75-214">**NULL**</span></span>            | <span data-ttu-id="93e75-215">Chaîne non **null**</span><span class="sxs-lookup"><span data-stu-id="93e75-215">Non-**NULL** string</span></span> | <span data-ttu-id="93e75-216">ERROR</span><span class="sxs-lookup"><span data-stu-id="93e75-216">ERROR</span></span>                        | <span data-ttu-id="93e75-217">ERROR</span><span class="sxs-lookup"><span data-stu-id="93e75-217">ERROR</span></span>                       |
| <span data-ttu-id="93e75-218">Chaîne non **null**</span><span class="sxs-lookup"><span data-stu-id="93e75-218">Non-**NULL** string</span></span> | <span data-ttu-id="93e75-219">Chaîne non **null**</span><span class="sxs-lookup"><span data-stu-id="93e75-219">Non-**NULL** string</span></span> | <span data-ttu-id="93e75-220">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="93e75-220">*lpszUsername*</span></span>               | <span data-ttu-id="93e75-221">*lpszPassword*</span><span class="sxs-lookup"><span data-stu-id="93e75-221">*lpszPassword*</span></span>              |



 

<span data-ttu-id="93e75-222">Ces informations peuvent être modifiées à l’aide des fonctions [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) et [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) .</span><span class="sxs-lookup"><span data-stu-id="93e75-222">This information can be changed by using the [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) and [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) functions.</span></span> <span data-ttu-id="93e75-223">[**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) modifie les valeurs de nom d’utilisateur et de mot de passe, tandis que [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) affiche une boîte de dialogue qui demande le nom d’utilisateur et le mot de passe appropriés.</span><span class="sxs-lookup"><span data-stu-id="93e75-223">[**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) changes the user name and password values, while [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) displays a dialog box that requests the proper user name and password.</span></span>

### <a name="defining-the-session"></a><span data-ttu-id="93e75-224">Définition de la session</span><span class="sxs-lookup"><span data-stu-id="93e75-224">Defining the Session</span></span>

<span data-ttu-id="93e75-225">Pour définir la session en cours d’établissement, définissez le type de service, les indicateurs et la valeur de contexte pour [**internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta).</span><span class="sxs-lookup"><span data-stu-id="93e75-225">To define the session that is being established, set the service type, flags, and context value for [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta).</span></span>

<span data-ttu-id="93e75-226">Deux types de service sont disponibles pour [**internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta): Internet \_ service \_ FTP et Internet \_ service \_ http.</span><span class="sxs-lookup"><span data-stu-id="93e75-226">There are two service types available to [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta): INTERNET\_SERVICE\_FTP and INTERNET\_SERVICE\_HTTP.</span></span> <span data-ttu-id="93e75-227">Le \_ \_ protocole http du service Internet est utilisé pour les sessions HTTP et HTTPS.</span><span class="sxs-lookup"><span data-stu-id="93e75-227">INTERNET\_SERVICE\_HTTP is used for both HTTP and HTTPS sessions.</span></span>

<span data-ttu-id="93e75-228">[Internet \_ FLAG \_ passive](api-flags.md) est le seul indicateur spécifique au service utilisé par les fonctions WinInet.</span><span class="sxs-lookup"><span data-stu-id="93e75-228">[INTERNET\_FLAG\_PASSIVE](api-flags.md) is the only service-specific flag used by the WinINet functions.</span></span> <span data-ttu-id="93e75-229">Cet indicateur peut être défini lorsque le type de service est INTERNET \_ service \_ FTP afin d’utiliser la sémantique FTP passive.</span><span class="sxs-lookup"><span data-stu-id="93e75-229">This flag can be set when the service type is INTERNET\_SERVICE\_FTP in order to use passive FTP semantics.</span></span>

<span data-ttu-id="93e75-230">Pour toutes les opérations synchrones, la valeur de *dwContext* doit être définie sur zéro.</span><span class="sxs-lookup"><span data-stu-id="93e75-230">For all synchronous operations, the value of *dwContext* should be set to zero.</span></span> <span data-ttu-id="93e75-231">Si des opérations asynchrones ont été établies en définissant l’indicateur de l' [ \_ indicateur \_ Async Internet](api-flags.md) dans l’appel à [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), une valeur différente de zéro doit être fournie pour *dwContext*.</span><span class="sxs-lookup"><span data-stu-id="93e75-231">If asynchronous operations were established by setting the [INTERNET\_FLAG\_ASYNC](api-flags.md) flag in the call to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), a nonzero value should be supplied for *dwContext*.</span></span> <span data-ttu-id="93e75-232">Pour plus d’informations sur les opérations asynchrones, consultez [Configuration des opérations asynchrones](common-functions.md).</span><span class="sxs-lookup"><span data-stu-id="93e75-232">For more information on asynchronous operations, see [Setting Up Asynchronous Operations](common-functions.md).</span></span>

<span data-ttu-id="93e75-233">Pour les sessions FTP, [**internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) tente d’établir une connexion au serveur sur Internet.</span><span class="sxs-lookup"><span data-stu-id="93e75-233">For FTP sessions, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) tries to establish a connection to the server on the Internet.</span></span> <span data-ttu-id="93e75-234">Pour les sessions HTTP, [**internetconnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) n’établit pas de connexion tant qu’une autre fonction n’a pas tenté d’obtenir des informations à partir du serveur.</span><span class="sxs-lookup"><span data-stu-id="93e75-234">For HTTP sessions, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) does not establish a connection until another function attempts to get information from the server.</span></span>

> [!Note]  
> <span data-ttu-id="93e75-235">WinINet ne prend pas en charge les implémentations de serveur.</span><span class="sxs-lookup"><span data-stu-id="93e75-235">WinINet does not support server implementations.</span></span> <span data-ttu-id="93e75-236">En outre, il ne doit pas être utilisé à partir d’un service.</span><span class="sxs-lookup"><span data-stu-id="93e75-236">In addition, it should not be used from a service.</span></span> <span data-ttu-id="93e75-237">Pour les implémentations de serveur ou les services, utilisez les [services http Microsoft Windows (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span><span class="sxs-lookup"><span data-stu-id="93e75-237">For server implementations or services use [Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span></span>

 

 

