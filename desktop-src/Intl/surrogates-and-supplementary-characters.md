---
description: Substituts et caractères supplémentaires
ms.assetid: 0dea39e2-a2b4-47fc-b44a-56af8ba1e346
title: Substituts et caractères supplémentaires
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c8d6b738955c8b8de4f6cb0ae43c78f86752a928
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106513391"
---
# <a name="surrogates-and-supplementary-characters"></a><span data-ttu-id="3e42a-103">Substituts et caractères supplémentaires</span><span class="sxs-lookup"><span data-stu-id="3e42a-103">Surrogates and Supplementary Characters</span></span>

<span data-ttu-id="3e42a-104">Les applications Windows utilisent normalement UTF-16 pour représenter des données de caractères [Unicode](unicode.md) .</span><span class="sxs-lookup"><span data-stu-id="3e42a-104">Windows applications normally use UTF-16 to represent [Unicode](unicode.md) character data.</span></span> <span data-ttu-id="3e42a-105">L’utilisation de 16 bits permet la représentation directe de 65 536 caractères uniques, mais ce plan multilingue de base (BMP) n’est pas assez proche pour couvrir tous les symboles utilisés dans les langues humaines.</span><span class="sxs-lookup"><span data-stu-id="3e42a-105">The use of 16 bits allows direct representation of 65,536 unique characters, but this Basic Multilingual Plane (BMP) is not nearly enough to cover all the symbols used in human languages.</span></span> <span data-ttu-id="3e42a-106">La version Unicode 4,1 comprend plus de 97 000 caractères, avec plus de 70 000 caractères pour le chinois seul.</span><span class="sxs-lookup"><span data-stu-id="3e42a-106">Unicode version 4.1 includes over 97,000 characters, with over 70,000 characters for Chinese alone.</span></span>

<span data-ttu-id="3e42a-107">La norme Unicode a établi 16 « plans » supplémentaires de caractères, chacun ayant la même taille que le BMP.</span><span class="sxs-lookup"><span data-stu-id="3e42a-107">The Unicode standard has established 16 additional "planes" of characters, each the same size as the BMP.</span></span> <span data-ttu-id="3e42a-108">Naturellement, la plupart des points de code au-delà du BMP n’ont pas encore de caractères qui leur sont affectés, mais la définition des plans donne au Unicode le potentiel de définir 1 114 112 caractères (autrement dit, 2 ¹ ⁶ \* 17 caractères) dans la plage de points de code u + 0000 à u + 10FFFF.</span><span class="sxs-lookup"><span data-stu-id="3e42a-108">Naturally, most code points beyond the BMP do not yet have characters assigned to them, but definition of the planes gives Unicode the potential to define 1,114,112 characters (that is, 2¹⁶ \* 17 characters) within the code point range U+0000 to U+10FFFF.</span></span> <span data-ttu-id="3e42a-109">Pour qu’UTF-16 représente ce plus grand ensemble de caractères, la norme Unicode définit des « caractères supplémentaires ».</span><span class="sxs-lookup"><span data-stu-id="3e42a-109">For UTF-16 to represent this larger set of characters, the Unicode Standard defines "supplementary characters".</span></span>

## <a name="about-supplementary-characters"></a><span data-ttu-id="3e42a-110">À propos des caractères supplémentaires</span><span class="sxs-lookup"><span data-stu-id="3e42a-110">About Supplementary Characters</span></span>

<span data-ttu-id="3e42a-111">Un caractère supplémentaire est un caractère situé au-delà du BMP, et un « substitut » est une valeur de code UTF-16.</span><span class="sxs-lookup"><span data-stu-id="3e42a-111">A supplementary character is a character located beyond the BMP, and a "surrogate" is a UTF-16 code value.</span></span> <span data-ttu-id="3e42a-112">Pour le format UTF-16, une « paire de substitution » est requise pour représenter un caractère supplémentaire unique.</span><span class="sxs-lookup"><span data-stu-id="3e42a-112">For UTF-16, a "surrogate pair" is required to represent a single supplementary character.</span></span> <span data-ttu-id="3e42a-113">Le premier substitut (élevé) est une valeur de code de 16 bits comprise entre U + D800 et U + DBFF.</span><span class="sxs-lookup"><span data-stu-id="3e42a-113">The first (high) surrogate is a 16-bit code value in the range U+D800 to U+DBFF.</span></span> <span data-ttu-id="3e42a-114">Le deuxième substitut (faible) est une valeur de code de 16 bits dans la plage U + DC00 et à U + DFFF.</span><span class="sxs-lookup"><span data-stu-id="3e42a-114">The second (low) surrogate is a 16-bit code value in the range U+DC00 to U+DFFF.</span></span> <span data-ttu-id="3e42a-115">En utilisant le mécanisme de substitution, UTF-16 peut prendre en charge tous les 1 114 112 caractères Unicode potentiels.</span><span class="sxs-lookup"><span data-stu-id="3e42a-115">Using the surrogate mechanism, UTF-16 can support all 1,114,112 potential Unicode characters.</span></span> <span data-ttu-id="3e42a-116">Pour plus d’informations sur les caractères supplémentaires, les substituts et les paires de substitution, reportez-vous à [la norme Unicode](https://www.unicode.org/standard/standard.html).</span><span class="sxs-lookup"><span data-stu-id="3e42a-116">For more details about supplementary characters, surrogates, and surrogate pairs, refer to [The Unicode Standard](https://www.unicode.org/standard/standard.html).</span></span>

> [!Note]  
> <span data-ttu-id="3e42a-117">Windows 2000 introduit la prise en charge de l’entrée, de la sortie et du tri simple des caractères supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="3e42a-117">Windows 2000 introduces support for basic input, output, and simple sorting of supplementary characters.</span></span> <span data-ttu-id="3e42a-118">Toutefois, tous les composants système ne sont pas compatibles avec les caractères supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="3e42a-118">However, not all system components are compatible with supplementary characters.</span></span>

 

<span data-ttu-id="3e42a-119">Le système d’exploitation prend en charge les caractères supplémentaires des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="3e42a-119">The operating system supports supplementary characters in the following ways:</span></span>

-   <span data-ttu-id="3e42a-120">Le format 12 de la table CMAP de police OpenType prend directement en charge le code de caractère de 4 octets.</span><span class="sxs-lookup"><span data-stu-id="3e42a-120">Format 12 of the OpenType font cmap table directly supports the 4-byte character code.</span></span> <span data-ttu-id="3e42a-121">Pour plus d’informations, consultez [spécification de police OpenType](/typography/opentype/spec/).</span><span class="sxs-lookup"><span data-stu-id="3e42a-121">For more information, see the [OpenType font specification](/typography/opentype/spec/).</span></span>
-   <span data-ttu-id="3e42a-122">Windows prend en charge les [éditeurs de méthode d’entrée (IME)](../dxtecharts/installing-and-using-input-method-editors.md)activés pour la substitution.</span><span class="sxs-lookup"><span data-stu-id="3e42a-122">Windows supports surrogate-enabled [input method editors (IMEs)](../dxtecharts/installing-and-using-input-method-editors.md).</span></span>
-   <span data-ttu-id="3e42a-123">L’API [GDI Windows](../gdi/windows-gdi.md) prend en charge les tables de format 12 CMAP dans les polices afin que les substituts puissent être affichés correctement.</span><span class="sxs-lookup"><span data-stu-id="3e42a-123">The [Windows GDI](../gdi/windows-gdi.md) API supports format 12 cmap tables in fonts so that surrogates can be displayed correctly.</span></span>
-   <span data-ttu-id="3e42a-124">L’API [Uniscribe](uniscribe.md) prend en charge les caractères supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="3e42a-124">The [Uniscribe](uniscribe.md) API supports supplementary characters.</span></span>
-   <span data-ttu-id="3e42a-125">Les [contrôles Windows](../controls/window-controls.md), y compris les fonctionnalités de [modification](../controls/edit-controls.md) et de [modification enrichie](../controls/rich-edit-controls.md), prennent en charge les caractères supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="3e42a-125">[Windows controls](../controls/window-controls.md), including [Edit](../controls/edit-controls.md) and [Rich Edit](../controls/rich-edit-controls.md), support supplementary characters.</span></span>
-   <span data-ttu-id="3e42a-126">Le moteur HTML prend en charge les pages HTML qui incluent des caractères supplémentaires pour l’affichage, la modification (via Outlook Express) et l’envoi de formulaires.</span><span class="sxs-lookup"><span data-stu-id="3e42a-126">The HTML engine supports HTML pages that include supplementary characters for display, editing (through Outlook Express), and forms submission.</span></span>
-   <span data-ttu-id="3e42a-127">La table de tri du système d’exploitation prend en charge les caractères supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="3e42a-127">The operating system sorting table supports supplementary characters.</span></span>

## <a name="general-guidelines-for-software-development-using-supplementary-characters"></a><span data-ttu-id="3e42a-128">Instructions générales pour le développement de logiciels à l’aide de caractères supplémentaires</span><span class="sxs-lookup"><span data-stu-id="3e42a-128">General Guidelines for Software Development Using Supplementary Characters</span></span>

<span data-ttu-id="3e42a-129">UTF-16 gère les caractères supplémentaires comme des paires de substitution.</span><span class="sxs-lookup"><span data-stu-id="3e42a-129">UTF-16 handles supplementary characters as surrogate pairs.</span></span> <span data-ttu-id="3e42a-130">Le système d’exploitation traite une paire de substitution de la même manière qu’il traite les [marques sans espace](using-nonspacing-characters-and-diacritics.md).</span><span class="sxs-lookup"><span data-stu-id="3e42a-130">The operating system processes a surrogate pair similarly to the way it processes [nonspacing marks](using-nonspacing-characters-and-diacritics.md).</span></span> <span data-ttu-id="3e42a-131">Au moment de l’affichage, la paire de substitution s’affiche comme un glyphe au moyen de Uniscribe, comme stipulé par la norme Unicode.</span><span class="sxs-lookup"><span data-stu-id="3e42a-131">At display time, the surrogate pair displays as one glyph by means of Uniscribe, as prescribed by the Unicode Standard.</span></span>

<span data-ttu-id="3e42a-132">Windows Vista introduit trois nouvelles macros pour aider à identifier les substituts et les paires de substitution dans les chaînes UTF-16.</span><span class="sxs-lookup"><span data-stu-id="3e42a-132">Windows Vista introduces three new macros to help identify surrogates and surrogate pairs in UTF-16 strings.</span></span> <span data-ttu-id="3e42a-133">Il s' [**agit d’un \_ \_ substitut étendu**](/windows/win32/api/Winnls/nf-winnls-is_high_surrogate), d’un [**\_ \_ substitut faible**](/windows/win32/api/Winnls/nf-winnls-is_low_surrogate)et d’une [**\_ \_ paire de substitution**](/windows/win32/api/Winnls/nf-winnls-is_surrogate_pair).</span><span class="sxs-lookup"><span data-stu-id="3e42a-133">These are [**IS\_HIGH\_SURROGATE**](/windows/win32/api/Winnls/nf-winnls-is_high_surrogate), [**IS\_LOW\_SURROGATE**](/windows/win32/api/Winnls/nf-winnls-is_low_surrogate), and [**IS\_SURROGATE\_PAIR**](/windows/win32/api/Winnls/nf-winnls-is_surrogate_pair).</span></span>

<span data-ttu-id="3e42a-134">Les applications prennent automatiquement en charge les caractères supplémentaires s’ils prennent en charge Unicode et utilisent des contrôles système et des fonctions API standard, telles que [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta) et [**DrawText**](/windows/win32/api/winuser/nf-winuser-drawtext).</span><span class="sxs-lookup"><span data-stu-id="3e42a-134">Applications automatically support supplementary characters if they support Unicode and use system controls and standard API functions, such as [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta) and [**DrawText**](/windows/win32/api/winuser/nf-winuser-drawtext).</span></span> <span data-ttu-id="3e42a-135">Par conséquent, si votre application utilise des contrôles système standard ou utilise des appels de type [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta)généraux à afficher, les caractères supplémentaires doivent fonctionner sans code spécial.</span><span class="sxs-lookup"><span data-stu-id="3e42a-135">Thus, if your application uses standard system controls or uses general [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta)-type calls to display, supplementary characters should work without any special coding.</span></span>

<span data-ttu-id="3e42a-136">Les applications qui implémentent leur propre prise en charge de la modification en utilisant des positions de glyphes de manière personnalisée peuvent utiliser Uniscribe pour tout traitement de texte.</span><span class="sxs-lookup"><span data-stu-id="3e42a-136">Applications that implement their own editing support by working out glyph positions in a customized way can use Uniscribe for all text processing.</span></span> <span data-ttu-id="3e42a-137">Uniscribe a des fonctions distinctes pour gérer le traitement des scripts complexes, tels que l’affichage du texte, le test de positionnement et le déplacement du curseur.</span><span class="sxs-lookup"><span data-stu-id="3e42a-137">Uniscribe has separate functions to deal with complex script processing, such as text display, hit testing, and cursor movement.</span></span> <span data-ttu-id="3e42a-138">Une application doit appeler les fonctions Uniscribe spécifiquement pour bénéficier de ces fonctionnalités avancées.</span><span class="sxs-lookup"><span data-stu-id="3e42a-138">An application must call the Uniscribe functions specifically to get these advanced features.</span></span> <span data-ttu-id="3e42a-139">Notez que les applications qui utilisent les fonctions Uniscribe sont entièrement multilingues, mais cela impose une baisse des performances.</span><span class="sxs-lookup"><span data-stu-id="3e42a-139">Note that applications using the Uniscribe functions are fully multilingual, but this imposes a performance penalty.</span></span> <span data-ttu-id="3e42a-140">Par conséquent, certaines applications doivent effectuer leur propre traitement de caractères supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="3e42a-140">Thus some applications should do their own processing of supplementary characters.</span></span>

<span data-ttu-id="3e42a-141">Étant donné que le mécanisme de substitution pour représenter des caractères supplémentaires est bien défini, votre application peut inclure du code pour gérer le traitement du texte de substitution UTF-16.</span><span class="sxs-lookup"><span data-stu-id="3e42a-141">Because the surrogate mechanism to represent supplementary characters is well-defined, your application can include code to handle UTF-16 surrogate text processing.</span></span> <span data-ttu-id="3e42a-142">Lorsque l’application rencontre une valeur UTF-16 séparée de la plage de substitution réservée inférieure (un substitut faible) ou de la plage de substitution réservée supérieure (un substitut étendu), la valeur doit être une moitié d’une paire de substitution.</span><span class="sxs-lookup"><span data-stu-id="3e42a-142">When the application encounters a separated UTF-16 value from either the lower reserved surrogate range (a low surrogate) or the upper reserved surrogate range (a high surrogate), the value must be one half of a surrogate pair.</span></span> <span data-ttu-id="3e42a-143">Ainsi, l’application peut détecter une paire de substitution en procédant à une vérification de plage simple.</span><span class="sxs-lookup"><span data-stu-id="3e42a-143">Thus, the application can detect a surrogate pair by doing simple range checking.</span></span> <span data-ttu-id="3e42a-144">Si elle rencontre une valeur UTF-16 dans la plage inférieure ou supérieure, elle doit suivre la largeur 1 16 bits vers l’arrière ou vers l’avant pour obtenir le reste du caractère.</span><span class="sxs-lookup"><span data-stu-id="3e42a-144">If it encounters a UTF-16 value in the lower or upper range, it must track backward or forward one 16-bit width to get the rest of the character.</span></span> <span data-ttu-id="3e42a-145">Lors de l’écriture de votre application, gardez à l’esprit que [**CharNext**](/windows/win32/api/winuser/nf-winuser-charnexta) et [**CharPrev**](/windows/win32/api/winuser/nf-winuser-charpreva) se déplacent par des points de code 16 bits, et non par paires de substitution.</span><span class="sxs-lookup"><span data-stu-id="3e42a-145">When writing your application, keep in mind that [**CharNext**](/windows/win32/api/winuser/nf-winuser-charnexta) and [**CharPrev**](/windows/win32/api/winuser/nf-winuser-charpreva) move by 16-bit code points, not by surrogate pairs.</span></span>

> [!Note]  
> <span data-ttu-id="3e42a-146">Les points de code de substitution autonomes ont un substitut étendu sans substitut faible adjacent, ou vice versa.</span><span class="sxs-lookup"><span data-stu-id="3e42a-146">Standalone surrogate code points have either a high surrogate without an adjacent low surrogate, or vice versa.</span></span> <span data-ttu-id="3e42a-147">Ces points de code ne sont pas valides et ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="3e42a-147">These code points are invalid and are not supported.</span></span> <span data-ttu-id="3e42a-148">Leur comportement n’est pas défini.</span><span class="sxs-lookup"><span data-stu-id="3e42a-148">Their behavior is undefined.</span></span>

 

<span data-ttu-id="3e42a-149">Si vous développez une police ou un fournisseur IME, Notez que les systèmes d’exploitation antérieurs à Windows XP désactivent la prise en charge des caractères supplémentaires par défaut.</span><span class="sxs-lookup"><span data-stu-id="3e42a-149">If you are developing a font or IME provider, note that pre-Windows XP operating systems disable supplementary character support by default.</span></span> <span data-ttu-id="3e42a-150">Windows XP et versions ultérieures activent les caractères supplémentaires par défaut.</span><span class="sxs-lookup"><span data-stu-id="3e42a-150">Windows XP and later enable supplementary characters by default.</span></span> <span data-ttu-id="3e42a-151">Si vous fournissez une police et un package IME qui requièrent des caractères supplémentaires, votre application doit définir les valeurs de Registre suivantes :</span><span class="sxs-lookup"><span data-stu-id="3e42a-151">If you provide a font and IME package that requires supplementary characters, your application must set the following registry values:</span></span>


```C++
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\LanguagePack]
SURROGATE=(REG_DWORD)0x00000002

[HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\International\Scripts\42]
IEFixedFontName=[Surrogate Font Face Name]
IEPropFontName=[Surrogate Font Face Name]
```



## <a name="related-topics"></a><span data-ttu-id="3e42a-152">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="3e42a-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3e42a-153">Jeux de caractères</span><span class="sxs-lookup"><span data-stu-id="3e42a-153">Character Sets</span></span>](character-sets.md)
</dt> </dl>

 

 
