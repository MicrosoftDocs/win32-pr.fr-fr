---
description: Cette rubrique décrit les instructions de programmation pour localiser les chaînes de Registre redirigées. Pour plus d’informations, consultez Utilisation de la redirection de chaîne de registre.
ms.assetid: 03d1512f-35a6-4b3a-9a0e-97e17bd9b126
title: Recherche de chaînes redirigées
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f11600ad57c04de54d914c2c876b67967dfa1467
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106514249"
---
# <a name="locating-redirected-strings"></a><span data-ttu-id="ac10e-104">Recherche de chaînes redirigées</span><span class="sxs-lookup"><span data-stu-id="ac10e-104">Locating Redirected Strings</span></span>

<span data-ttu-id="ac10e-105">Cette rubrique décrit les instructions de programmation pour localiser les chaînes de Registre redirigées.</span><span class="sxs-lookup"><span data-stu-id="ac10e-105">This topic discusses programming instructions for locating redirected registry strings.</span></span> <span data-ttu-id="ac10e-106">Pour plus d’informations, consultez [utilisation de la redirection de chaîne de Registre](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ac10e-106">For more information, see [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

## <a name="load-a-language-neutral-registry-value"></a><span data-ttu-id="ac10e-107">Charger une valeur de Registre Language-Neutral</span><span class="sxs-lookup"><span data-stu-id="ac10e-107">Load a Language-Neutral Registry Value</span></span>

<span data-ttu-id="ac10e-108">Sur Windows Vista et versions ultérieures, l’application MUI utilise une valeur de Registre indépendante du langage pour autoriser l’accès aux chaînes spécifiques à la langue stockées dans une table de ressources de type chaîne.</span><span class="sxs-lookup"><span data-stu-id="ac10e-108">On Windows Vista and later, the MUI application uses a language-neutral registry value to allow access to language-specific strings stored in a string resource table.</span></span> <span data-ttu-id="ac10e-109">Pour plus d’informations, consultez créer une ressource Language-Neutral dans [utilisation de la redirection de chaînes de Registre](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ac10e-109">For more information, see Create a Language-Neutral Resource in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="ac10e-110">Le code d’application qui lit la valeur neutre dans le langage du registre doit charger les chaînes dans la langue d’interface utilisateur appropriée en appelant [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa).</span><span class="sxs-lookup"><span data-stu-id="ac10e-110">Application code that reads the language-neutral value from the registry should load the strings in the correct user interface language by calling [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa).</span></span> <span data-ttu-id="ac10e-111">Si vous utilisez cette fonction, votre application n’a pas à gérer explicitement le chargement des ressources.</span><span class="sxs-lookup"><span data-stu-id="ac10e-111">If using this function, your application does not have to deal explicitly with resource loading.</span></span>

<span data-ttu-id="ac10e-112">Si vous mettez à jour une application existante à l’aide de la langue indépendante du Registre, vous conservez généralement les valeurs de chaîne existantes, localisées en anglais ou dans une autre langue dans le registre, comme des secours et une compatibilité descendante.</span><span class="sxs-lookup"><span data-stu-id="ac10e-112">If you are updating an existing application to the language-neutral use of the registry, you will typically keep the existing string values, localized to English or to some other single language in the registry, as fallbacks and for backward compatibility.</span></span> <span data-ttu-id="ac10e-113">Le fait de conserver une chaîne littérale dans le registre permet à l’application de revenir à la chaîne littérale en cas d’échec d’un appel à [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa) .</span><span class="sxs-lookup"><span data-stu-id="ac10e-113">Keeping a literal string in the registry allows the application to fall back to the literal string if a call to [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa) fails.</span></span> <span data-ttu-id="ac10e-114">Vous devez décider comment implémenter ce type de secours, car MUI n’offre aucune prise en charge pour une telle implémentation.</span><span class="sxs-lookup"><span data-stu-id="ac10e-114">You must decide how to implement such a fallback, as MUI provides no support for such an implementation.</span></span>

## <a name="use-shell-api-to-set-shortcut-strings-from-the-registry"></a><span data-ttu-id="ac10e-115">Utiliser l’API Shell pour définir des chaînes de raccourci à partir du Registre</span><span class="sxs-lookup"><span data-stu-id="ac10e-115">Use Shell API to Set Shortcut Strings from the Registry</span></span>

<span data-ttu-id="ac10e-116">Votre application peut utiliser l’API Shell pour créer des chaînes pour les raccourcis qui lient des fichiers ou des dossiers dans le menu **Démarrer** ou sur le bureau.</span><span class="sxs-lookup"><span data-stu-id="ac10e-116">Your application can use the shell API to create strings for shortcuts that link files or folders in the **Start** menu or on the desktop.</span></span> <span data-ttu-id="ac10e-117">Pour plus d’informations, consultez créer des ressources pour les chaînes de raccourci dans [utilisation de la redirection de chaînes de Registre](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ac10e-117">For more information, see Create Resources for Shortcut Strings in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="ac10e-118">L’application peut utiliser [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) pour charger le nom complet compatible MUI pour un raccourci.</span><span class="sxs-lookup"><span data-stu-id="ac10e-118">The application can use [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) to load the MUI-compliant display name for a shortcut.</span></span> <span data-ttu-id="ac10e-119">Elle doit utiliser [**IShellLink :: SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) pour définir l’info-bulle associée.</span><span class="sxs-lookup"><span data-stu-id="ac10e-119">It should use [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) to set the associated InfoTip.</span></span> <span data-ttu-id="ac10e-120">Les appels inscrivent les chaînes avec le registre.</span><span class="sxs-lookup"><span data-stu-id="ac10e-120">The calls register the strings with the registry.</span></span> <span data-ttu-id="ac10e-121">Prenons les exemples suivants, pour lesquels « HKCR » représente la \_ clé de \_ Registre racine de classes HKEY :</span><span class="sxs-lookup"><span data-stu-id="ac10e-121">Consider the following examples, for which "HKCR" represents the HKEY\_CLASSES\_ROOT registry key:</span></span>


```C++
HKCR,"CLSID\%CLSID_AntiSpyware%",,,"Windows AntiSpyware"

HKCR,"CLSID\%CLSID_AntiSpyware%","LocalizedString",,"@%ProgramFiles%\Windows AntiSpyware\MSASCui.exe,-104"

HKCR,"CLSID\%CLSID_AntiSpyware%","InfoTip",,"@%ProgramFiles%\Windows AntiSpyware\MSASCui.exe,-208"
```



<span data-ttu-id="ac10e-122">La première ligne fournit une chaîne littérale non localisée pour la compatibilité descendante et de secours.</span><span class="sxs-lookup"><span data-stu-id="ac10e-122">The first line provides an unlocalized literal string for fallback and backward compatibility.</span></span> <span data-ttu-id="ac10e-123">La deuxième ligne montre la méthode compatible MUI pour inscrire le nom complet.</span><span class="sxs-lookup"><span data-stu-id="ac10e-123">The second line shows the MUI-compliant way to register the display name.</span></span> <span data-ttu-id="ac10e-124">Cette ligne indique l’identificateur de chaîne 104 stocké dans Msascui.exe (pour Windows XP) ou dans son fichier spécifique à la langue (pour Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="ac10e-124">This line indicates the string identifier 104 stored in Msascui.exe (for Windows XP) or in its associated language-specific file (for Windows Vista).</span></span> <span data-ttu-id="ac10e-125">Cet identificateur de chaîne correspond à « Favoris réseau ».</span><span class="sxs-lookup"><span data-stu-id="ac10e-125">This string identifier corresponds to "My Network Places".</span></span> <span data-ttu-id="ac10e-126">La troisième ligne de l’exemple gère l’inscription de l’info-bulle.</span><span class="sxs-lookup"><span data-stu-id="ac10e-126">The third line in the example handles InfoTip registration.</span></span> <span data-ttu-id="ac10e-127">% CLSID \_ antispyware% spécifie une variable d’environnement représentant le GUID qui correspond à l’identificateur de classe de ce composant.</span><span class="sxs-lookup"><span data-stu-id="ac10e-127">%CLSID\_AntiSpyware% specifies an environment variable representing the GUID that matches the class identifier of this component.</span></span>

<span data-ttu-id="ac10e-128">Pour l’exemple ci-dessus, l’application appelle [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) pour spécifier le chemin d’accès de l’exécutable pour les deux premiers paramètres, et spécifie *idsRes* comme « @% ProgramFiles% \\ Windows AntiSpyware \\MSASCui.exe, 104 ».</span><span class="sxs-lookup"><span data-stu-id="ac10e-128">For the example shown above, the application calls [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) to specify the path of the executable for the first two parameters, and specify *idsRes* as "@%ProgramFiles%\\Windows AntiSpyware\\MSASCui.exe,104".</span></span> <span data-ttu-id="ac10e-129">Un appel à [**IShellLink :: SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription), spécifie le chemin d’accès de l’info-bulle sous la forme « @% ProgramFiles% \\ Windows AntiSpyware \\MSASCui.exe, 208 ».</span><span class="sxs-lookup"><span data-stu-id="ac10e-129">A call to [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription), specifies the path for the InfoTip as "@%ProgramFiles%\\Windows AntiSpyware\\MSASCui.exe,208".</span></span>

## <a name="query-friendly-document-type-names-in-the-registry"></a><span data-ttu-id="ac10e-130">Rechercher dans le registre des noms de type de document conviviaux</span><span class="sxs-lookup"><span data-stu-id="ac10e-130">Query Friendly Document Type Names in the Registry</span></span>

<span data-ttu-id="ac10e-131">La création de ressources pour les noms de type de document convivial est décrite dans créer des ressources pour des noms de type de document conviviaux dans [à l’aide de la redirection de chaîne de Registre](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ac10e-131">Resource creation for friendly document type names is discussed in Create Resources for Friendly Document Type Names in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span> <span data-ttu-id="ac10e-132">Pour interroger un nom de document convivial, l’application doit utiliser [**IQueryAssociations :: init**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-init), suivi d’un appel à [**IQueryAssociations :: GetString**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-getstring).</span><span class="sxs-lookup"><span data-stu-id="ac10e-132">To query a friendly document name, the application should use [**IQueryAssociations::Init**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-init), followed by a call to [**IQueryAssociations::GetString**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-getstring).</span></span> <span data-ttu-id="ac10e-133">L’appel à **IQueryAssociations :: init** spécifie le type de document, par exemple « . txt ».</span><span class="sxs-lookup"><span data-stu-id="ac10e-133">The call to **IQueryAssociations::Init** specifies the document type, for example, ".txt".</span></span> <span data-ttu-id="ac10e-134">L’appel à **IQueryAssociations :: GetString** doit spécifier ASSOCSTR \_ FRIENDLYDOCNAME comme identificateur de chaîne.</span><span class="sxs-lookup"><span data-stu-id="ac10e-134">The call to **IQueryAssociations::GetString** must specify ASSOCSTR\_FRIENDLYDOCNAME as the string identifier.</span></span>

## <a name="register-microsoft-management-console-snap-in-strings-not-read-from-the-registry"></a><span data-ttu-id="ac10e-135">Inscrire les chaînes du composant logiciel enfichable Microsoft Management Console non lues dans le registre</span><span class="sxs-lookup"><span data-stu-id="ac10e-135">Register Microsoft Management Console Snap-in Strings Not Read from the Registry</span></span>

<span data-ttu-id="ac10e-136">Votre application peut utiliser un composant logiciel enfichable MMC (Microsoft Management Console) pour héberger ses tâches de gestion.</span><span class="sxs-lookup"><span data-stu-id="ac10e-136">Your application can use a Microsoft Management Console (MMC) snap-in to host its management tasks.</span></span> <span data-ttu-id="ac10e-137">La plupart des chaînes sont gérées en tant que ressources à l’aide des paramètres du registre décrits dans créer des ressources de type chaîne pour Microsoft Management Console Snap-Ins dans utilisation de la [redirection de chaînes de Registre](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ac10e-137">Most strings are handled as resources using the registry settings described in Create String Resources for Microsoft Management Console Snap-Ins in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span> <span data-ttu-id="ac10e-138">Toutefois, certains composants logiciels enfichables inscrivent les valeurs de chaîne de registre que MMC ne peut pas lire à partir du Registre.</span><span class="sxs-lookup"><span data-stu-id="ac10e-138">However, some snap-ins register registry string values that MMC cannot read from the registry.</span></span> <span data-ttu-id="ac10e-139">Dans ce cas, le composant logiciel enfichable doit obtenir les valeurs à l’aide de l’interface [**ISnapinAbout**](/windows/win32/api/mmc/nn-mmc-isnapinabout) , qui est compatible avec mui.</span><span class="sxs-lookup"><span data-stu-id="ac10e-139">In this case, the snap-in must obtain the values using the [**ISnapinAbout**](/windows/win32/api/mmc/nn-mmc-isnapinabout) interface, which is MUI-compatible.</span></span>

## <a name="set-the-display-name-and-description-for-a-windows-service-from-the-registry"></a><span data-ttu-id="ac10e-140">Définir le nom complet et la description d’un service Windows à partir du Registre</span><span class="sxs-lookup"><span data-stu-id="ac10e-140">Set the Display Name and Description for a Windows Service from the Registry</span></span>

<span data-ttu-id="ac10e-141">Si votre application MUI utilise un service Windows, elle doit afficher le nom et la description de l’affichage du service.</span><span class="sxs-lookup"><span data-stu-id="ac10e-141">If your MUI application is using a Windows service, it must display the service display name and description.</span></span> <span data-ttu-id="ac10e-142">Les ressources associées sont présentées dans la section « créer des ressources de type chaîne pour un service Windows » de la rubrique [utilisation de la redirection de chaînes de Registre](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ac10e-142">The associated resources are discussed in "Create String Resources for a Windows Service" in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="ac10e-143">Pour définir le nom d’affichage du service, l’application MUI appelle [**CreateService**](/windows/win32/api/winsvc/nf-winsvc-createservicea) ou [**ChangeServiceConfig**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfiga).</span><span class="sxs-lookup"><span data-stu-id="ac10e-143">To set the service display name, the MUI application calls [**CreateService**](/windows/win32/api/winsvc/nf-winsvc-createservicea) or [**ChangeServiceConfig**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfiga).</span></span> <span data-ttu-id="ac10e-144">Le nom est une chaîne au format " `@<PE-path>,-<stringID>[;<comment>]` ".</span><span class="sxs-lookup"><span data-stu-id="ac10e-144">The name is a string of the form "`@<PE-path>,-<stringID>[;<comment>]`".</span></span> <span data-ttu-id="ac10e-145">Par exemple, si votre service est implémenté par un fichier. dll avec le chemin d’accès% ProgramFiles% \\ % myPath% \\MyDll.dll et que l’identificateur de chaîne du nom complet propre à la langue est 347, le paramètre est spécifié comme « `@%ProgramFiles%\\%MyPath%\\MyDll.dll,-347` ».</span><span class="sxs-lookup"><span data-stu-id="ac10e-145">For example, if your service is implemented by a .dll file with path %ProgramFiles%\\%MyPath%\\MyDll.dll, and the string identifier of the language-specific display name is 347, the parameter is specified as "`@%ProgramFiles%\\%MyPath%\\MyDll.dll,-347`".</span></span> <span data-ttu-id="ac10e-146">Les doubles barres obliques inverses ( \\ \\ ) sont nécessaires, car C/C++ utilise la barre oblique inverse comme caractère d’échappement dans les chaînes.</span><span class="sxs-lookup"><span data-stu-id="ac10e-146">The double backslashes (\\\\) are necessary because C/C++ uses the backslash as an escape character in strings.</span></span>

<span data-ttu-id="ac10e-147">Pour définir la description du service spécifique à une langue, l’application MUI doit faire en sorte que le membre **lpDescription** d’une structure de [**\_ Description de service**](/windows/win32/api/winsvc/ns-winsvc-service_descriptiona) indique une chaîne de forme « `@<PE-path>,-<stringID>[;<comment>]` », en référençant l’identificateur de chaîne approprié.</span><span class="sxs-lookup"><span data-stu-id="ac10e-147">To set the language-specific service description, the MUI application should make the **lpDescription** member of a [**SERVICE\_DESCRIPTION**](/windows/win32/api/winsvc/ns-winsvc-service_descriptiona) structure indicate a string of form "`@<PE-path>,-<stringID>[;<comment>]`", referencing the appropriate string identifier.</span></span> <span data-ttu-id="ac10e-148">L’application appelle ensuite [**ChangeServiceConfig2**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfig2a) avec le paramètre *dwInfoLevel* spécifié en tant que \_ \_ Description de la configuration du service et le paramètre *lpInfo* spécifié en tant que structure de **\_ Description du service** .</span><span class="sxs-lookup"><span data-stu-id="ac10e-148">Then the application calls [**ChangeServiceConfig2**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfig2a) with parameter *dwInfoLevel* specified as SERVICE\_CONFIG\_DESCRIPTION and parameter *lpInfo* specified as the **SERVICE\_DESCRIPTION** structure.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ac10e-149">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="ac10e-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ac10e-150">Recherche de ressources Win32 PE</span><span class="sxs-lookup"><span data-stu-id="ac10e-150">Locating Win32 PE Resources</span></span>](locating-win32-pe-resources.md)
</dt> <dt>

[<span data-ttu-id="ac10e-151">Utilisation de la redirection de chaînes de Registre</span><span class="sxs-lookup"><span data-stu-id="ac10e-151">Using Registry String Redirection</span></span>](using-registry-string-redirection.md)
</dt> </dl>

 

 
