---
description: Uniscribe enregistre les mappages Unicode-à-glyphe (CMAP), les largeurs de glyphe et les tables de mise en forme de script OpenType.
ms.assetid: c06c0eaf-41cb-4fd1-9750-a78355217f12
title: Mise en cache (internationalisation)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3cf8bf7dd10fe414bc170086ff9b8c34142dc197
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106522251"
---
# <a name="caching-internationalization"></a><span data-ttu-id="b9463-103">Mise en cache (internationalisation)</span><span class="sxs-lookup"><span data-stu-id="b9463-103">Caching (Internationalization)</span></span>

<span data-ttu-id="b9463-104">Uniscribe enregistre les mappages Unicode-à-glyphe (CMAP), les largeurs de glyphe et les tables de mise en forme de script OpenType.</span><span class="sxs-lookup"><span data-stu-id="b9463-104">Uniscribe saves Unicode-to-glyph (cmap) mappings, glyph widths, and OpenType script shaping tables.</span></span> <span data-ttu-id="b9463-105">Un handle vers les tables pour une police particulière d’une taille particulière est appelé « cache de script ».</span><span class="sxs-lookup"><span data-stu-id="b9463-105">A handle to the tables for a particular font of a particular size is called a "script cache".</span></span> <span data-ttu-id="b9463-106">De nombreuses fonctions Uniscribe appellent à la fois pour un paramètre de handle de contexte de périphérique et un pointeur vers une structure de [**\_ cache de script**](script-cache.md) .</span><span class="sxs-lookup"><span data-stu-id="b9463-106">Many Uniscribe functions call for both a device context handle parameter and a pointer to a [**SCRIPT\_CACHE**](script-cache.md) structure.</span></span> <span data-ttu-id="b9463-107">Ces fonctions recherchent d’abord des informations dans le cache de script, à l’aide du contexte de périphérique uniquement lorsque les tables requises ne sont pas déjà mises en cache.</span><span class="sxs-lookup"><span data-stu-id="b9463-107">These functions look first for information through the script cache, using the device context only when required tables are not already cached.</span></span> <span data-ttu-id="b9463-108">Lors de l’appel de la fonction [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape), [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace)ou [**ScriptTextOut**](/windows/desktop/api/Usp10/nf-usp10-scripttextout) , l’application doit passer un pointeur vers une structure de **\_ cache de script** .</span><span class="sxs-lookup"><span data-stu-id="b9463-108">When calling the [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape), [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace), or [**ScriptTextOut**](/windows/desktop/api/Usp10/nf-usp10-scripttextout) function, the application must pass a pointer to a **SCRIPT\_CACHE** structure.</span></span> <span data-ttu-id="b9463-109">Le descripteur doit être initialisé à la **valeur null** avant la première fois que l’application le transmet à une fonction Uniscribe.</span><span class="sxs-lookup"><span data-stu-id="b9463-109">The handle should be initialized to **NULL** before the first time the application passes it to a Uniscribe function.</span></span> <span data-ttu-id="b9463-110">L’application ne doit jamais passer le même handle pour différentes polices ou tailles différentes.</span><span class="sxs-lookup"><span data-stu-id="b9463-110">The application should never pass the same handle for different fonts or different sizes.</span></span>

<span data-ttu-id="b9463-111">Une application peut libérer un cache de script à tout moment.</span><span class="sxs-lookup"><span data-stu-id="b9463-111">An application can free a script cache at any time.</span></span> <span data-ttu-id="b9463-112">Uniscribe conserve les décomptes de références dans ses caches de police et de former, libère les données de police uniquement lorsque toutes les tailles de la police sont libérées et libère les données de l’adapteur uniquement lorsque toutes les polices prises en charge par le formateur sont libérées.</span><span class="sxs-lookup"><span data-stu-id="b9463-112">Uniscribe maintains reference counts in its font and shaper caches, frees font data only when all sizes of the font are freed, and frees shaper data only when all fonts that the shaper supports are freed.</span></span> <span data-ttu-id="b9463-113">Lorsque l’application est effectuée avec un style, elle doit appeler la fonction [**ScriptFreeCache**](/windows/desktop/api/Usp10/nf-usp10-scriptfreecache) pour libérer le cache de script du style.</span><span class="sxs-lookup"><span data-stu-id="b9463-113">When the application is done with a style, it should call the [**ScriptFreeCache**](/windows/desktop/api/Usp10/nf-usp10-scriptfreecache) function to free the script cache for the style.</span></span>

<span data-ttu-id="b9463-114">Pour [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) et [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace), l’application doit passer un contexte de périphérique null.</span><span class="sxs-lookup"><span data-stu-id="b9463-114">For [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) and [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace), it is valid for the application to pass a null device context.</span></span> <span data-ttu-id="b9463-115">Le plus souvent, l’appel est concluant, car les tables requises sont déjà mises en cache.</span><span class="sxs-lookup"><span data-stu-id="b9463-115">Most often the call will succeed, as required tables are already cached.</span></span> <span data-ttu-id="b9463-116">Si la mise en forme ou le placement requiert l’accès à un contexte de périphérique, **ScriptShape** ou **ScriptPlace** retourne immédiatement avec le \_ code d’erreur E en attente.</span><span class="sxs-lookup"><span data-stu-id="b9463-116">If the shaping or placement requires access to a device context, **ScriptShape** or **ScriptPlace** returns immediately with the E\_PENDING error code.</span></span> <span data-ttu-id="b9463-117">L’application doit ensuite sélectionner la police dans le contexte de périphérique.</span><span class="sxs-lookup"><span data-stu-id="b9463-117">Then the application must select the font in the device context.</span></span> <span data-ttu-id="b9463-118">Pour la plupart des applications, cela permet d’obtenir des performances en évitant la préparation répétée d’un handle de contexte d’appareil avec des appels à [**SelectObject**](/windows/win32/api/wingdi/nf-wingdi-selectobject).</span><span class="sxs-lookup"><span data-stu-id="b9463-118">For most applications, this helps performance by avoiding repeated preparation of a device context handle with calls to [**SelectObject**](/windows/win32/api/wingdi/nf-wingdi-selectobject).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b9463-119">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="b9463-119">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b9463-120">Utilisation de Uniscribe</span><span class="sxs-lookup"><span data-stu-id="b9463-120">Using Uniscribe</span></span>](using-uniscribe.md)
</dt> </dl>

 

 
