---
description: Une application serveur protégée doit vérifier les droits d’accès des clients avant d’autoriser le client à accéder à un objet privé protégé.
ms.assetid: dce4dd10-1d5f-40a3-8a7e-ec708d3123c7
title: Vérification de l’accès aux objets privés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6b7b3d8b2cd933b00be0be9f1f2b077f5c7a2d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951258"
---
# <a name="checking-access-to-private-objects"></a><span data-ttu-id="f75de-103">Vérification de l’accès aux objets privés</span><span class="sxs-lookup"><span data-stu-id="f75de-103">Checking Access to Private Objects</span></span>

<span data-ttu-id="f75de-104">Une application serveur protégée doit vérifier les droits d’accès d’un client avant d’autoriser le client à accéder à un objet privé protégé.</span><span class="sxs-lookup"><span data-stu-id="f75de-104">A protected server application must check a client's access rights before allowing the client to access a protected private object.</span></span> <span data-ttu-id="f75de-105">Pour ce faire, le serveur passe un [*jeton d’emprunt d’identité*](/windows/desktop/SecGloss/i-gly), un descripteur de sécurité et un ensemble de droits d’accès demandés à [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck).</span><span class="sxs-lookup"><span data-stu-id="f75de-105">To do this, the server passes an [*impersonation token*](/windows/desktop/SecGloss/i-gly), a security descriptor, and a set of requested access rights to [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck).</span></span> <span data-ttu-id="f75de-106">Les [*entrées de contrôle d’accès*](/windows/desktop/SecGloss/a-gly) (ACE) dans la liste DACL [*du descripteur de sécurité*](/windows/desktop/SecGloss/s-gly) spécifient les droits d’accès accordés ou refusés à différents destinataires.</span><span class="sxs-lookup"><span data-stu-id="f75de-106">The [*access control entries*](/windows/desktop/SecGloss/a-gly) (ACEs) in the [*security descriptor's*](/windows/desktop/SecGloss/s-gly) DACL specify the access rights allowed or denied to various trustees.</span></span> <span data-ttu-id="f75de-107">La fonction **AccessCheck** compare le tiers de confiance de chaque ACE aux tiers de confiance identifiés dans le jeton d’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="f75de-107">The **AccessCheck** function compares the trustee in each ACE to the trustees identified in the impersonation token.</span></span> <span data-ttu-id="f75de-108">Pour obtenir une description de l’algorithme utilisé pour accorder ou refuser l’accès, voir [Comment les DACL contrôlent l’accès à un objet](how-dacls-control-access-to-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="f75de-108">For a description of the algorithm used to grant or deny access, see [How DACLs Control Access to an Object](how-dacls-control-access-to-an-object.md).</span></span>

<span data-ttu-id="f75de-109">La fonction [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) effectue une vérification d’accès similaire.</span><span class="sxs-lookup"><span data-stu-id="f75de-109">The [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) function performs a similar access check.</span></span> <span data-ttu-id="f75de-110">En outre, il génère des enregistrements d’audit dans le journal des événements de sécurité en fonction de la liste SACL dans le descripteur de sécurité.</span><span class="sxs-lookup"><span data-stu-id="f75de-110">In addition, it generates audit records in the security event log depending on the SACL in the security descriptor.</span></span>

<span data-ttu-id="f75de-111">Les fonctions [**AccessCheckByType**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytype) et [**AccessCheckByTypeAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytypeandauditalarma) sont similaires à [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) et [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) , à ceci près qu’elles vous permettent de vérifier l’accès aux sous-objets d’un objet, comme les jeux de propriétés ou les propriétés.</span><span class="sxs-lookup"><span data-stu-id="f75de-111">The [**AccessCheckByType**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytype) and [**AccessCheckByTypeAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytypeandauditalarma) functions are similar to [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) and [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) except that they allow you to check access to the subobjects of an object, such as property sets or properties.</span></span> <span data-ttu-id="f75de-112">Les fonctions [**AccessCheckByTypeResultList**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) et [**AccessCheckByTypeResultListAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytyperesultlistandauditalarma) sont également similaires à **AccessCheck** , à ceci près qu’elles fournissent les résultats de la vérification d’accès pour chaque sous-objet dans une hiérarchie des propriétés et jeux de propriétés de l’objet.</span><span class="sxs-lookup"><span data-stu-id="f75de-112">The [**AccessCheckByTypeResultList**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) and [**AccessCheckByTypeResultListAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytyperesultlistandauditalarma) functions are also similar to **AccessCheck** except that they provide the access check results for each subobject in a hierarchy of the object's properties and property sets.</span></span> <span data-ttu-id="f75de-113">Ces fonctions utilisent la structure de la [**\_ \_ liste de types**](/windows/desktop/api/Winnt/ns-winnt-object_type_list) d’objets pour décrire la hiérarchie des objets pour lesquels l’accès est vérifié.</span><span class="sxs-lookup"><span data-stu-id="f75de-113">These functions use the [**OBJECT\_TYPE\_LIST**](/windows/desktop/api/Winnt/ns-winnt-object_type_list) structure to describe the hierarchy of objects for which access is checked.</span></span> <span data-ttu-id="f75de-114">Les fonctions qui génèrent un message d’audit utilisent le type d’énumération de [**\_ \_ type d’événement audit**](/windows/desktop/api/Winnt/ne-winnt-audit_event_type) pour indiquer si l’objet en cours de vérification est un objet de service d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="f75de-114">The functions that generate an audit message use the [**AUDIT\_EVENT\_TYPE**](/windows/desktop/api/Winnt/ne-winnt-audit_event_type) enumeration type to indicate whether the object being checked is a directory service object.</span></span> <span data-ttu-id="f75de-115">Pour plus d’informations sur la hiérarchie d’un objet et de ses sous-objets, consultez [ACE pour contrôler l’accès aux propriétés d’un objet](aces-to-control-access-to-an-object-s-properties.md).</span><span class="sxs-lookup"><span data-stu-id="f75de-115">For more information about the hierarchy of an object and its subobjects, see [ACEs to Control Access to an Object's Properties](aces-to-control-access-to-an-object-s-properties.md).</span></span>

<span data-ttu-id="f75de-116">Les droits d’accès demandés passés aux fonctions [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) et [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) ne doivent pas inclure de [droits d’accès génériques](generic-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="f75de-116">The requested access rights passed to the [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) and [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) functions must not include any [generic access rights](generic-access-rights.md).</span></span> <span data-ttu-id="f75de-117">Le serveur peut utiliser la fonction [**MapGenericMask**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-mapgenericmask) pour convertir tous les droits d’accès génériques en autorisations standard et spécifiques correspondantes selon le mappage spécifié dans la structure de [**\_ mappage générique**](/windows/desktop/api/Winnt/ns-winnt-generic_mapping) .</span><span class="sxs-lookup"><span data-stu-id="f75de-117">The server can use the [**MapGenericMask**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-mapgenericmask) function to convert any generic access rights to the corresponding specific and standard rights according to the mapping specified in the [**GENERIC\_MAPPING**](/windows/desktop/api/Winnt/ns-winnt-generic_mapping) structure.</span></span>

<span data-ttu-id="f75de-118">Les fonctions [**AreAllAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areallaccessesgranted) et [**AreAnyAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areanyaccessesgranted) comparent un [*masque d’accès*](/windows/desktop/SecGloss/a-gly) demandé avec un masque d’accès accordé.</span><span class="sxs-lookup"><span data-stu-id="f75de-118">The [**AreAllAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areallaccessesgranted) and [**AreAnyAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areanyaccessesgranted) functions compare a requested [*access mask*](/windows/desktop/SecGloss/a-gly) with a granted access mask.</span></span>

<span data-ttu-id="f75de-119">Pour obtenir un exemple de code qui utilise la fonction [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) , consultez [vérification de l’accès client avec les ACL en C++](verifying-client-access-with-acls-in-c--.md).</span><span class="sxs-lookup"><span data-stu-id="f75de-119">For sample code that uses the [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) function, see [Verifying Client Access with ACLs in C++](verifying-client-access-with-acls-in-c--.md).</span></span>

<span data-ttu-id="f75de-120">La fonction [**ConvertToAutoInheritPrivateObjectSecurity**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-converttoautoinheritprivateobjectsecurity) crée et retourne un descripteur de sécurité dans un format qui autorise la propagation automatique des ACE pouvant être héritées.</span><span class="sxs-lookup"><span data-stu-id="f75de-120">The [**ConvertToAutoInheritPrivateObjectSecurity**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-converttoautoinheritprivateobjectsecurity) function creates and returns a security descriptor in a format that allows the automatic propagation of inheritable ACEs.</span></span> <span data-ttu-id="f75de-121">Ce descripteur de sécurité contient toutes les ACE, héritées et non héritées, dans le descripteur de sécurité actuel et se trouve dans [*un format auto-relatif*](/windows/desktop/SecGloss/s-gly) .</span><span class="sxs-lookup"><span data-stu-id="f75de-121">This security descriptor contains all of the ACEs, inherited and noninherited, in the current security descriptor and is in [*self-relative*](/windows/desktop/SecGloss/s-gly) format.</span></span> <span data-ttu-id="f75de-122">La fonction **ConvertToAutoInheritPrivateObjectSecurity** détermine si les ACE sont héritées ou non héritées en comparant toutes les entrées du descripteur de sécurité actuelles avec toutes les entrées du descripteur de sécurité parent.</span><span class="sxs-lookup"><span data-stu-id="f75de-122">The **ConvertToAutoInheritPrivateObjectSecurity** function determines whether the ACEs are inherited or noninherited by comparing all of the ACEs in the current security descriptor with all of the ACEs in its parent security descriptor.</span></span> <span data-ttu-id="f75de-123">Il se peut qu’il n’existe pas de correspondance un-à-un entre les deux groupes d’ACE.</span><span class="sxs-lookup"><span data-stu-id="f75de-123">There may not be a one-to-one correspondence between the two groups of ACEs.</span></span> <span data-ttu-id="f75de-124">Par exemple, une entrée du contrôle d’accès qui autorise l’autorisation de lecture/écriture peut être équivalente à deux ACE : une entrée du contrôle d’accès qui autorise l’autorisation de lecture et une entrée de contrôle d’accès qui autorise l’autorisation d’écriture.</span><span class="sxs-lookup"><span data-stu-id="f75de-124">For instance, an ACE that allows read/write permission can be equivalent to two ACEs: an ACE that allows read permission and an ACE that allows write permission.</span></span> <span data-ttu-id="f75de-125">Un descripteur de sécurité parent ne peut pas être fourni lorsque le descripteur de sécurité actuel est le parent.</span><span class="sxs-lookup"><span data-stu-id="f75de-125">A parent security descriptor may not be supplied when the current security descriptor is the parent.</span></span>

 

 
