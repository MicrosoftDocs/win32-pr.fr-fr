---
description: Un jeton restreint est un jeton d’accès principal ou d’emprunt d’identité qui a été modifié par la fonction CreateRestrictedToken.
ms.assetid: 06580ab9-ff58-4aa9-bf88-9536a2e1981d
title: Jetons restreints
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fee8e6c89915e3edd0a9206f84a0d3d5697a3cb9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104113795"
---
# <a name="restricted-tokens"></a><span data-ttu-id="921ab-103">Jetons restreints</span><span class="sxs-lookup"><span data-stu-id="921ab-103">Restricted Tokens</span></span>

<span data-ttu-id="921ab-104">Un jeton restreint est un [*jeton d’accès*](/windows/desktop/SecGloss/a-gly) [*principal*](/windows/desktop/SecGloss/p-gly) ou d’emprunt d’identité qui a été modifié par la fonction [**CreateRestrictedToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-createrestrictedtoken) .</span><span class="sxs-lookup"><span data-stu-id="921ab-104">A restricted token is a [*primary*](/windows/desktop/SecGloss/p-gly) or impersonation [*access token*](/windows/desktop/SecGloss/a-gly) that has been modified by the [**CreateRestrictedToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-createrestrictedtoken) function.</span></span> <span data-ttu-id="921ab-105">Un [*processus*](/windows/desktop/SecGloss/p-gly) ou l’emprunt de l’identité d’un thread qui s’exécute dans le [*contexte de sécurité*](/windows/desktop/SecGloss/s-gly) d’un jeton restreint est limité dans sa capacité à accéder aux objets sécurisables ou à effectuer des opérations privilégiées.</span><span class="sxs-lookup"><span data-stu-id="921ab-105">A [*process*](/windows/desktop/SecGloss/p-gly) or impersonating thread running in the [*security context*](/windows/desktop/SecGloss/s-gly) of a restricted token is restricted in its ability to access securable objects or perform privileged operations.</span></span> <span data-ttu-id="921ab-106">La fonction **CreateRestrictedToken** peut restreindre un jeton des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="921ab-106">The **CreateRestrictedToken** function can restrict a token in the following ways:</span></span>

-   <span data-ttu-id="921ab-107">Supprimez les [privilèges](privileges.md) du jeton.</span><span class="sxs-lookup"><span data-stu-id="921ab-107">Remove [privileges](privileges.md) from the token.</span></span>
-   <span data-ttu-id="921ab-108">Appliquez l’attribut de refus uniquement aux sid dans le jeton afin qu’ils ne puissent pas être utilisés pour accéder aux objets sécurisés.</span><span class="sxs-lookup"><span data-stu-id="921ab-108">Apply the deny-only attribute to SIDs in the token so that they cannot be used to access secured objects.</span></span> <span data-ttu-id="921ab-109">Pour plus d’informations sur l’attribut de refus uniquement, consultez [attributs SID dans un jeton d’accès](sid-attributes-in-an-access-token.md).</span><span class="sxs-lookup"><span data-stu-id="921ab-109">For more information about the deny-only attribute, see [SID Attributes in an Access Token](sid-attributes-in-an-access-token.md).</span></span>
-   <span data-ttu-id="921ab-110">Spécifiez une liste de SID de restriction, qui peut limiter l’accès aux objets sécurisables.</span><span class="sxs-lookup"><span data-stu-id="921ab-110">Specify a list of restricting SIDs, which can limit access to securable objects.</span></span>

<span data-ttu-id="921ab-111">Le système utilise la liste des SID restreints lorsqu’il vérifie l’accès du jeton à un objet sécurisable.</span><span class="sxs-lookup"><span data-stu-id="921ab-111">The system uses the list of restricting SIDs when it checks the token's access to a securable object.</span></span> <span data-ttu-id="921ab-112">Quand un processus ou un thread restreint tente d’accéder à un objet sécurisable, le système effectue deux vérifications d’accès : une utilisant les SID activés du jeton et une autre à l’aide de la liste des SID de restriction.</span><span class="sxs-lookup"><span data-stu-id="921ab-112">When a restricted process or thread tries to access a securable object, the system performs two access checks: one using the token's enabled SIDs, and another using the list of restricting SIDs.</span></span> <span data-ttu-id="921ab-113">L’accès est accordé uniquement si les deux contrôles d’accès autorisent les droits d’accès demandés.</span><span class="sxs-lookup"><span data-stu-id="921ab-113">Access is granted only if both access checks allow the requested access rights.</span></span> <span data-ttu-id="921ab-114">Pour plus d’informations sur les contrôles d’accès, consultez [Comment les DACL contrôlent l’accès à un objet](how-dacls-control-access-to-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="921ab-114">For more information about access checks, see [How DACLs Control Access to an Object](how-dacls-control-access-to-an-object.md).</span></span>

<span data-ttu-id="921ab-115">Vous pouvez utiliser un [*jeton principal*](/windows/desktop/SecGloss/p-gly) restreint dans un appel à la fonction [**CreateProcessAsUser**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessasusera) .</span><span class="sxs-lookup"><span data-stu-id="921ab-115">You can use a restricted [*primary token*](/windows/desktop/SecGloss/p-gly) in a call to the [**CreateProcessAsUser**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessasusera) function.</span></span> <span data-ttu-id="921ab-116">En règle générale, le processus qui appelle **CreateProcessAsUser** doit avoir \_ le \_ privilège ASSIGNPRIMARYTOKEN Name, qui est généralement détenu uniquement par le code système ou par les services s’exécutant dans le compte LocalSystem.</span><span class="sxs-lookup"><span data-stu-id="921ab-116">Typically, the process that calls **CreateProcessAsUser** must have the SE\_ASSIGNPRIMARYTOKEN\_NAME privilege, which is usually held only by system code or by services running in the LocalSystem account.</span></span> <span data-ttu-id="921ab-117">Toutefois, si l’appel de **CreateProcessAsUser** spécifie une version limitée du jeton principal de l’appelant, ce privilège n’est pas requis.</span><span class="sxs-lookup"><span data-stu-id="921ab-117">However, if the **CreateProcessAsUser** call specifies a restricted version of the caller's primary token, this privilege is not required.</span></span> <span data-ttu-id="921ab-118">Cela permet aux applications ordinaires de créer des processus restreints.</span><span class="sxs-lookup"><span data-stu-id="921ab-118">This enables ordinary applications to create restricted processes.</span></span>

<span data-ttu-id="921ab-119">Vous pouvez également utiliser un jeton principal ou d' [*emprunt d’identité*](/windows/desktop/SecGloss/i-gly) restreint dans la fonction [**ImpersonateLoggedOnUser**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser) .</span><span class="sxs-lookup"><span data-stu-id="921ab-119">You can also use a restricted primary or [*impersonation token*](/windows/desktop/SecGloss/i-gly) in the [**ImpersonateLoggedOnUser**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser) function.</span></span>

<span data-ttu-id="921ab-120">Pour déterminer si un jeton a une liste de sid restreints, appelez la fonction [**IsTokenRestricted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-istokenrestricted) .</span><span class="sxs-lookup"><span data-stu-id="921ab-120">To determine whether a token has a list of restricting SIDs, call the [**IsTokenRestricted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-istokenrestricted) function.</span></span>

> [!Note]  
> <span data-ttu-id="921ab-121">Les applications qui utilisent des jetons restreints doivent exécuter l’application restreinte sur des ordinateurs de bureau autres que le bureau par défaut.</span><span class="sxs-lookup"><span data-stu-id="921ab-121">Applications that use restricted tokens should run the restricted application on desktops other than the default desktop.</span></span> <span data-ttu-id="921ab-122">Cela est nécessaire pour empêcher une attaque par une application restreinte, à l’aide de **SendMessage** ou **PostMessage**, à des applications non restreintes sur le bureau par défaut.</span><span class="sxs-lookup"><span data-stu-id="921ab-122">This is necessary to prevent an attack by a restricted application, using **SendMessage** or **PostMessage**, to unrestricted applications on the default desktop.</span></span> <span data-ttu-id="921ab-123">Si nécessaire, basculez entre les ordinateurs de bureau à des fins d’application.</span><span class="sxs-lookup"><span data-stu-id="921ab-123">If necessary, switch between desktops for your application purposes.</span></span>

 

 

 
