---
description: L' \_ énumération de niveau d’emprunt d’identité de sécurité \_ définit quatre niveaux d’emprunt d’identité qui déterminent les opérations qu’un serveur peut effectuer dans le contexte des clients.
ms.assetid: ae152dbf-44f0-417f-a85e-09bf60dcfcb0
title: Niveaux d’emprunt d’identité (autorisation)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b91654f42a86e5c47069197bed084df56f5445dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106530200"
---
# <a name="impersonation-levels-authorization"></a><span data-ttu-id="1ca1e-103">Niveaux d’emprunt d’identité (autorisation)</span><span class="sxs-lookup"><span data-stu-id="1ca1e-103">Impersonation Levels (Authorization)</span></span>

<span data-ttu-id="1ca1e-104">L’énumération de [**\_ \_ niveau d’emprunt d’identité de sécurité**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) définit quatre niveaux d’emprunt d’identité qui déterminent les opérations qu’un serveur peut effectuer dans le contexte du client.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-104">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) enumeration defines four impersonation levels that determine the operations a server can perform in the client's context.</span></span>



| <span data-ttu-id="1ca1e-105">Niveau d'emprunt d'identité</span><span class="sxs-lookup"><span data-stu-id="1ca1e-105">Impersonation level</span></span>    | <span data-ttu-id="1ca1e-106">Description</span><span class="sxs-lookup"><span data-stu-id="1ca1e-106">Description</span></span>                                                                                      |
|------------------------|--------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1ca1e-107">SecurityAnonymous</span><span class="sxs-lookup"><span data-stu-id="1ca1e-107">SecurityAnonymous</span></span>      | <span data-ttu-id="1ca1e-108">Le serveur ne peut pas emprunter l’identité ou identifier le client.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-108">The server cannot impersonate or identify the client.</span></span>                                            |
| <span data-ttu-id="1ca1e-109">SecurityIdentification</span><span class="sxs-lookup"><span data-stu-id="1ca1e-109">SecurityIdentification</span></span> | <span data-ttu-id="1ca1e-110">Le serveur peut accéder à l’identité et aux privilèges du client, mais ne peut pas emprunter l’identité du client.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-110">The server can get the identity and privileges of the client, but cannot impersonate the client.</span></span> |
| <span data-ttu-id="1ca1e-111">SecurityImpersonation</span><span class="sxs-lookup"><span data-stu-id="1ca1e-111">SecurityImpersonation</span></span>  | <span data-ttu-id="1ca1e-112">Le serveur peut emprunter l’identité du contexte de sécurité du client sur le système local.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-112">The server can impersonate the client's security context on the local system.</span></span>                    |
| <span data-ttu-id="1ca1e-113">SecurityDelegation</span><span class="sxs-lookup"><span data-stu-id="1ca1e-113">SecurityDelegation</span></span>     | <span data-ttu-id="1ca1e-114">Le serveur peut emprunter l’identité du contexte de sécurité du client sur les systèmes distants.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-114">The server can impersonate the client's security context on remote systems.</span></span>                      |



 

<span data-ttu-id="1ca1e-115">Le client d’un canal nommé, d’un RPC ou d’une connexion DDE peut contrôler le niveau d’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-115">The client of a named pipe, RPC, or DDE connection can control the impersonation level.</span></span> <span data-ttu-id="1ca1e-116">Par exemple, un client de canal nommé peut appeler la fonction [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) pour ouvrir un handle vers un canal nommé et spécifier le niveau d’emprunt d’identité du serveur.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-116">For example, a named pipe client can call the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function to open a handle to a named pipe and specify the server's impersonation level.</span></span>

<span data-ttu-id="1ca1e-117">Lorsque le canal nommé, le RPC ou la connexion DDE est distant, les indicateurs passés à [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) pour définir le niveau d’emprunt d’identité sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-117">When the named pipe, RPC, or DDE connection is remote, the flags passed to [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) to set the impersonation level are ignored.</span></span> <span data-ttu-id="1ca1e-118">Dans ce cas, le niveau d’emprunt d’identité du client est déterminé par les niveaux d’emprunt d’identité activés par le serveur, qui est défini par un indicateur sur le compte du serveur dans le service d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-118">In this case, the impersonation level of the client is determined by the impersonation levels enabled by the server, which is set by a flag on the server's account in the directory service.</span></span> <span data-ttu-id="1ca1e-119">Par exemple, si le serveur est activé pour la délégation, le niveau d’emprunt d’identité du client est également défini sur délégation même si les indicateurs passés à **CreateFile** spécifient le niveau d’emprunt d’identité d’identification.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-119">For example, if the server is enabled for delegation, the client's impersonation level will also be set to delegation even if the flags passed to **CreateFile** specify the identification impersonation level.</span></span>

<span data-ttu-id="1ca1e-120">Les clients DDE utilisent la fonction [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) avec [**la \_ qualité de la sécurité de la structure \_ de \_ service**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) pour spécifier le niveau d’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-120">DDE clients use the [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) function with the [**SECURITY\_QUALITY\_OF\_SERVICE**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) structure to specify the impersonation level.</span></span> <span data-ttu-id="1ca1e-121">Le niveau SecurityImpersonation est la valeur par défaut pour les serveurs de canal nommé, RPC et DDE.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-121">The SecurityImpersonation level is the default for named pipe, RPC, and DDE servers.</span></span> <span data-ttu-id="1ca1e-122">Les fonctions [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken)et [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) permettent à l’appelant de spécifier un niveau d’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-122">The [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken), and [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) functions allow the caller to specify an impersonation level.</span></span> <span data-ttu-id="1ca1e-123">Utilisez la fonction [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) pour récupérer le niveau d’emprunt d’identité d’un [*jeton d’accès*](/windows/desktop/SecGloss/a-gly).</span><span class="sxs-lookup"><span data-stu-id="1ca1e-123">Use the [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) function to retrieve the impersonation level of an [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="1ca1e-124">Au niveau SecurityImpersonation, la plupart des actions du thread se produisent dans le contexte de sécurité du jeton d' [*emprunt d’identité*](/windows/desktop/SecGloss/i-gly) du thread plutôt que dans le [*jeton principal*](/windows/desktop/SecGloss/p-gly) du [*processus*](/windows/desktop/SecGloss/p-gly) qui possède le thread.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-124">At the SecurityImpersonation level, most of the thread's actions occur in the security context of the thread's [*impersonation token*](/windows/desktop/SecGloss/i-gly) rather than in the [*primary token*](/windows/desktop/SecGloss/p-gly) of the [*process*](/windows/desktop/SecGloss/p-gly) that owns the thread.</span></span> <span data-ttu-id="1ca1e-125">Par exemple, si un thread d’emprunt d’identité ouvre un [objet sécurisable](securable-objects.md), le système utilise le jeton d’emprunt d’identité pour vérifier l’accès du thread.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-125">For example, if an impersonating thread opens a [securable object](securable-objects.md), the system uses the impersonation token to check the thread's access.</span></span> <span data-ttu-id="1ca1e-126">De même, si un thread d’emprunt d’identité crée un nouvel objet, par exemple en appelant la fonction [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) , le propriétaire du nouvel objet est le propriétaire par défaut du [*jeton d’accès*](/windows/desktop/SecGloss/a-gly)du client.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-126">Similarly, if an impersonating thread creates a new object, for example by calling the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function, the owner of the new object is the default owner from the client's [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="1ca1e-127">Toutefois, le système utilise le jeton principal du processus plutôt que le jeton d’emprunt d’identité du thread appelant dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="1ca1e-127">However, the system uses the primary token of the process rather than the impersonation token of the calling thread in the following situations:</span></span>

-   <span data-ttu-id="1ca1e-128">Si un thread d’emprunt d’identité appelle la fonction [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) , le nouveau processus hérite toujours du jeton principal du processus.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-128">If an impersonating thread calls the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function, the new process always inherits the primary token of the process.</span></span>
-   <span data-ttu-id="1ca1e-129">Pour les fonctions qui requièrent \_ le \_ privilège de nom TCB se, telles que la fonction [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) , le système recherche toujours le privilège dans le jeton principal du processus.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-129">For functions that require the SE\_TCB\_NAME privilege, such as the [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="1ca1e-130">Pour les fonctions qui requièrent \_ le \_ privilège de nom d’audit se, telles que la fonction [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) , le système recherche toujours le privilège dans le jeton principal du processus.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-130">For functions that require the SE\_AUDIT\_NAME privilege, such as the [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="1ca1e-131">Dans un appel à la fonction [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) , un thread peut spécifier si la fonction utilise le jeton d’emprunt d’identité ou le jeton principal pour déterminer s’il faut accorder l’accès demandé.</span><span class="sxs-lookup"><span data-stu-id="1ca1e-131">In a call to the [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) function, a thread can specify whether the function uses the impersonation token or the primary token to determine whether to grant the requested access.</span></span>

 

 
