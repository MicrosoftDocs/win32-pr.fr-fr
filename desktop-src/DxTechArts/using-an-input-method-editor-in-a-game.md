---
title: Utilisation d’un éditeur de méthode d’entrée dans un jeu
description: Cet article explique comment vous pouvez implémenter un contrôle d’édition IME de base dans une application Microsoft DirectX en mode plein écran.
ms.assetid: 760ed960-08a3-e967-282e-7fbdbaeb7a4d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b1519f07a4e105ae822bd13fd7acd8b29e5ad8a0
ms.sourcegitcommit: 6515eef99ca0d1bbe3e27d4575e9986f5255f277
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/10/2021
ms.locfileid: "103953778"
---
# <a name="using-an-input-method-editor-in-a-game"></a><span data-ttu-id="2aa8d-103">Utilisation d’un éditeur de méthode d’entrée dans un jeu</span><span class="sxs-lookup"><span data-stu-id="2aa8d-103">Using an Input Method Editor in a Game</span></span>

> [!Note]  
> <span data-ttu-id="2aa8d-104">Cet article détaille l’utilisation de l’éditeur de méthode d’entrée (IME) Windows XP.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-104">This article details working with the Windows XP Input Method Editor (IME).</span></span> <span data-ttu-id="2aa8d-105">Les modifications apportées à l’IME pour Windows Vista ne sont pas entièrement détaillées dans cet article.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-105">Changes were made to the IME for Windows Vista that are not fully detailed in this article.</span></span> <span data-ttu-id="2aa8d-106">Pour plus d’informations sur les modifications apportées à l’IME pour Windows Vista, voir [éditeurs de méthode d’entrée (IME)](https://www.microsoft.com/globaldev/vista/Whats_New_Vista.mspx#e4eac) dans [Windows Vista-une vue d’ensemble de Ever-Expanding de l’internationalisation](https://www.microsoft.com/globaldev/vista/Whats_New_Vista.mspx) sur le portail informatique et de développement global Microsoft.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-106">For more info about changes to the IME for Windows Vista, see [Input Method Editors (IME)](https://www.microsoft.com/globaldev/vista/Whats_New_Vista.mspx#e4eac) in [Windows Vista - An Ever-Expanding View of Internationalization](https://www.microsoft.com/globaldev/vista/Whats_New_Vista.mspx) on the Microsoft Global Development and Computing Portal.</span></span>

 

<span data-ttu-id="2aa8d-107">Un éditeur de méthode d’entrée (IME) est un programme qui permet d’entrer facilement du texte à l’aide d’un clavier standard pour les langues asiatiques telles que le chinois, le japonais, le coréen et d’autres langages avec des caractères complexes.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-107">An input method editor (IME) is a program that allows easy text entry using a standard keyboard for East Asian languages such as Chinese, Japanese, Korean, and other languages with complex characters.</span></span> <span data-ttu-id="2aa8d-108">Par exemple, avec les éditeurs IME, un utilisateur peut taper des caractères complexes dans un traitement de texte, ou un joueur d’un jeu en ligne multijoueur massive peut discuter avec des amis dans des caractères complexes.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-108">For example, with IMEs a user can type complex characters in a word processor, or a player of a massive multiplayer online game can chat with friends in complex characters.</span></span>

<span data-ttu-id="2aa8d-109">Cet article explique comment vous pouvez implémenter un contrôle d’édition IME de base dans une application Microsoft DirectX en mode plein écran.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-109">This article explains how you can implement a basic IME edit control in a full-screen Microsoft DirectX application.</span></span> <span data-ttu-id="2aa8d-110">Les applications qui tirent parti de DXUT bénéficient automatiquement des fonctionnalités IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-110">Applications that take advantage of DXUT automatically get IME functionality.</span></span> <span data-ttu-id="2aa8d-111">Pour les applications qui n’utilisent pas le Framework, cet article explique comment ajouter la prise en charge de l’IME à un contrôle d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-111">For applications that do not make use of the framework, this article describes how to add IME support to an edit control.</span></span>

<span data-ttu-id="2aa8d-112">Contenu :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-112">Contents:</span></span>

-   [<span data-ttu-id="2aa8d-113">Comportement IME par défaut</span><span class="sxs-lookup"><span data-stu-id="2aa8d-113">Default IME Behavior</span></span>](#default-ime-behavior)
-   [<span data-ttu-id="2aa8d-114">Utilisation des IME avec DXUT</span><span class="sxs-lookup"><span data-stu-id="2aa8d-114">Using IMEs with DXUT</span></span>](#using-imes-with-dxut)
-   [<span data-ttu-id="2aa8d-115">Substitution du comportement IME par défaut</span><span class="sxs-lookup"><span data-stu-id="2aa8d-115">Overriding the Default IME Behavior</span></span>](#overriding-the-default-ime-behavior)
-   [<span data-ttu-id="2aa8d-116">Fonctions</span><span class="sxs-lookup"><span data-stu-id="2aa8d-116">Functions</span></span>](#functions)
-   [<span data-ttu-id="2aa8d-117">Messages</span><span class="sxs-lookup"><span data-stu-id="2aa8d-117">Messages</span></span>](#ime-messages)
-   [<span data-ttu-id="2aa8d-118">Exemples</span><span class="sxs-lookup"><span data-stu-id="2aa8d-118">Examples</span></span>](#examples)
    -   [<span data-ttu-id="2aa8d-119">Version de l’IME CHT 4,2, 4,3 et 4,4</span><span class="sxs-lookup"><span data-stu-id="2aa8d-119">CHT IME version 4.2, 4.3 and 4.4</span></span>](#cht-ime-version-42-43-and-44)
    -   [<span data-ttu-id="2aa8d-120">Version de l’IME CHT 5,0</span><span class="sxs-lookup"><span data-stu-id="2aa8d-120">CHT IME version 5.0</span></span>](#cht-ime-version-50)
    -   [<span data-ttu-id="2aa8d-121">Version de l’IME CHT 5,1, 5,2 et CHS (IME) 5,3</span><span class="sxs-lookup"><span data-stu-id="2aa8d-121">CHT IME version 5.1, 5.2 and CHS IME version 5.3</span></span>](#cht-ime-version-51-52-and-chs-ime-version-53)
    -   [<span data-ttu-id="2aa8d-122">Version d’IME CHS 4,1</span><span class="sxs-lookup"><span data-stu-id="2aa8d-122">CHS IME version 4.1</span></span>](#chs-ime-version-41)
    -   [<span data-ttu-id="2aa8d-123">Version d’IME CHS 4,2</span><span class="sxs-lookup"><span data-stu-id="2aa8d-123">CHS IME version 4.2</span></span>](#chs-ime-version-42)
-   [<span data-ttu-id="2aa8d-124">Messages IME</span><span class="sxs-lookup"><span data-stu-id="2aa8d-124">IME Messages</span></span>](#ime-messages)
    -   [<span data-ttu-id="2aa8d-125">\_INPUTLANGCHANGE WM</span><span class="sxs-lookup"><span data-stu-id="2aa8d-125">WM\_INPUTLANGCHANGE</span></span>](#wm_inputlangchange)
    -   [<span data-ttu-id="2aa8d-126">STARTCOMPOSITION de l' \_ IME WM \_</span><span class="sxs-lookup"><span data-stu-id="2aa8d-126">WM\_IME\_STARTCOMPOSITION</span></span>](/windows)
    -   [<span data-ttu-id="2aa8d-127">COMPOSITION de l' \_ IME WM \_</span><span class="sxs-lookup"><span data-stu-id="2aa8d-127">WM\_IME\_COMPOSITION</span></span>](/windows)
    -   [<span data-ttu-id="2aa8d-128">ENDCOMPOSITION de l' \_ IME WM \_</span><span class="sxs-lookup"><span data-stu-id="2aa8d-128">WM\_IME\_ENDCOMPOSITION</span></span>](/windows)
    -   [<span data-ttu-id="2aa8d-129">notification de l' \_ IME WM \_</span><span class="sxs-lookup"><span data-stu-id="2aa8d-129">WM\_IME\_NOTIFY</span></span>](/windows)
-   [<span data-ttu-id="2aa8d-130">Rendu</span><span class="sxs-lookup"><span data-stu-id="2aa8d-130">Rendering</span></span>](#rendering)
    -   [<span data-ttu-id="2aa8d-131">Indicateur de paramètres régionaux d’entrée</span><span class="sxs-lookup"><span data-stu-id="2aa8d-131">Input Locale Indicator</span></span>](#input-locale-indicator)
    -   [<span data-ttu-id="2aa8d-132">Fenêtre de composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-132">Composition Window</span></span>](#composition-window)
    -   [<span data-ttu-id="2aa8d-133">Lecture et fenêtres candidates</span><span class="sxs-lookup"><span data-stu-id="2aa8d-133">Reading and Candidate Windows</span></span>](#reading-and-candidate-windows)
-   [<span data-ttu-id="2aa8d-134">Limitations</span><span class="sxs-lookup"><span data-stu-id="2aa8d-134">Limitations</span></span>](#limitations)
-   [<span data-ttu-id="2aa8d-135">Informations de Registre</span><span class="sxs-lookup"><span data-stu-id="2aa8d-135">Registry Information</span></span>](#registry-information)
-   [<span data-ttu-id="2aa8d-136">Annexe A : versions CHT par système d’exploitation</span><span class="sxs-lookup"><span data-stu-id="2aa8d-136">Appendix A: CHT Versions per Operating System</span></span>](#appendix-a-cht-versions-per-operating-system)
-   [<span data-ttu-id="2aa8d-137">Informations complémentaires</span><span class="sxs-lookup"><span data-stu-id="2aa8d-137">Further Information</span></span>](#further-information)
-   [<span data-ttu-id="2aa8d-138">GetReadingString</span><span class="sxs-lookup"><span data-stu-id="2aa8d-138">GetReadingString</span></span>](#getreadingstring)
-   [<span data-ttu-id="2aa8d-139">ShowReadingWindow</span><span class="sxs-lookup"><span data-stu-id="2aa8d-139">ShowReadingWindow</span></span>](#showreadingwindow)

## <a name="default-ime-behavior"></a><span data-ttu-id="2aa8d-140">Comportement IME par défaut</span><span class="sxs-lookup"><span data-stu-id="2aa8d-140">Default IME Behavior</span></span>

<span data-ttu-id="2aa8d-141">Les IME mappent l’entrée au clavier aux composants phonétiques ou à d’autres éléments de langage spécifiques à une langue sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-141">IMEs map keyboard input to phonetic components or other language elements specific to a selected language.</span></span> <span data-ttu-id="2aa8d-142">Dans un scénario classique, l’utilisateur tape des clés qui représentent la prononciation d’un caractère complexe.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-142">In a typical scenario, the user types keys that represent pronunciation of a complex character.</span></span> <span data-ttu-id="2aa8d-143">Si l’IME reconnaît la prononciation comme étant valide, elle présente à l’utilisateur une liste de mots et d’expressions candidats à partir desquels l’utilisateur peut sélectionner un choix final.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-143">If the IME recognizes the pronunciation as valid, it presents the user with a list of word or phrase candidates from which the user can select a final choice.</span></span> <span data-ttu-id="2aa8d-144">Le mot choisi est ensuite envoyé à l’application par le biais d’une série de messages Microsoft Windows [**WM \_ char**](/windows/desktop/inputdev/wm-char) .</span><span class="sxs-lookup"><span data-stu-id="2aa8d-144">The chosen word is then sent to the application through a series of Microsoft Windows [**WM\_CHAR**](/windows/desktop/inputdev/wm-char) messages.</span></span> <span data-ttu-id="2aa8d-145">Étant donné que l’IME fonctionne à un niveau inférieur à l’application en interceptant l’entrée au clavier, la présence d’un IME est transparente pour l’application.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-145">Because the IME works at a level below the application by intercepting keyboard input, the presence of an IME is transparent to the application.</span></span> <span data-ttu-id="2aa8d-146">Presque toutes les applications Windows peuvent facilement tirer parti des éditeurs IME sans être conscients de leur existence et sans nécessiter un codage spécial.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-146">Almost all Windows applications can readily take advantage of IMEs without being aware of their existence and without requiring special coding.</span></span>

<span data-ttu-id="2aa8d-147">Un IME standard affiche plusieurs fenêtres pour guider l’utilisateur à travers l’entrée de caractères, comme illustré dans les exemples suivants.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-147">A typical IME displays several windows to guide the user through character entry, as shown in the following examples.</span></span>

![l’éditeur IME affiche plusieurs fenêtres](images/ime-elements.png)

| <span data-ttu-id="2aa8d-149">Type de fenêtre</span><span class="sxs-lookup"><span data-stu-id="2aa8d-149">Window Type</span></span>                                       | <span data-ttu-id="2aa8d-150">Description</span><span class="sxs-lookup"><span data-stu-id="2aa8d-150">Description</span></span>                                                                                                                                                                                                                                                                                                                 | <span data-ttu-id="2aa8d-151">Sortie IME</span><span class="sxs-lookup"><span data-stu-id="2aa8d-151">IME Output</span></span>                                   |
|---------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
| <span data-ttu-id="2aa8d-152">R.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-152">A.</span></span> <span data-ttu-id="2aa8d-153">Fenêtre de lecture</span><span class="sxs-lookup"><span data-stu-id="2aa8d-153">Reading Window</span></span>                                 | <span data-ttu-id="2aa8d-154">Contient les séquences de touches du clavier ; change généralement après chaque séquence de touches.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-154">Contains keystrokes from the keyboard; typically changes after each keystroke.</span></span>                                                                                                                                                                                                                                              | <span data-ttu-id="2aa8d-155">chaîne de lecture</span><span class="sxs-lookup"><span data-stu-id="2aa8d-155">reading string</span></span>                               |
| <span data-ttu-id="2aa8d-156">B.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-156">B.</span></span> <span data-ttu-id="2aa8d-157">Fenêtre de composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-157">Composition Window</span></span>                             | <span data-ttu-id="2aa8d-158">Contient la collection de caractères que l’utilisateur a composés avec l’IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-158">Contains the collection of characters that the user has composed with the IME.</span></span> <span data-ttu-id="2aa8d-159">Ces caractères sont dessinés par l’IME en haut de l’application.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-159">These characters are drawn by the IME on top of the application.</span></span> <span data-ttu-id="2aa8d-160">Lorsque l’utilisateur notifie l’IME que la chaîne de composition est satisfaisante, l’IME envoie ensuite la chaîne de composition à l’application via une série de \_ messages WM char.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-160">When the user notifies the IME that the composition string is satisfactory, the IME then sends the composition string to the application via a series of WM\_CHAR messages.</span></span> | <span data-ttu-id="2aa8d-161">chaîne de composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-161">composition string</span></span>                           |
| <span data-ttu-id="2aa8d-162">C.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-162">C.</span></span> <span data-ttu-id="2aa8d-163">Fenêtre candidate</span><span class="sxs-lookup"><span data-stu-id="2aa8d-163">Candidate Window</span></span>                               | <span data-ttu-id="2aa8d-164">Lorsque l’utilisateur a entré une prononciation valide, l’IME affiche une liste des caractères candidats qui correspondent tous à la prononciation donnée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-164">When the user has entered a valid pronunciation, the IME displays a list of candidate characters that all match the given pronunciation.</span></span> <span data-ttu-id="2aa8d-165">L’utilisateur sélectionne ensuite le caractère prévu dans cette liste, et l’IME ajoute ce caractère à l’affichage de la fenêtre de composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-165">The user then selects the intended character from this list, and the IME adds this character to the Composition Window display.</span></span>                                                    | <span data-ttu-id="2aa8d-166">caractère suivant dans la chaîne de composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-166">the next character in the composition string</span></span> |
| <span data-ttu-id="2aa8d-167">D.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-167">D.</span></span> <span data-ttu-id="2aa8d-168">Indicateur de [paramètres régionaux d’entrée](/windows/desktop/Intl/nls-terminology)</span><span class="sxs-lookup"><span data-stu-id="2aa8d-168">[Input Locale](/windows/desktop/Intl/nls-terminology) indicator</span></span> | <span data-ttu-id="2aa8d-169">Affiche la langue sélectionnée par l’utilisateur pour l’entrée au clavier.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-169">Shows the language the user has selected for keyboard input.</span></span> <span data-ttu-id="2aa8d-170">Cet indicateur est incorporé dans la barre des tâches Windows.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-170">This indicator is embedded in the Windows taskbar.</span></span> <span data-ttu-id="2aa8d-171">La langue d’entrée peut être sélectionnée en ouvrant les options régionales et linguistiques du panneau de configuration, puis en cliquant sur détails dans l’onglet langues.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-171">The input language can be selected by opening the Regional and Language Options Control Panel and then clicking Details on the Languages tab.</span></span>                                                               | \-                                           |



 

## <a name="using-imes-with-dxut"></a><span data-ttu-id="2aa8d-172">Utilisation des IME avec DXUT</span><span class="sxs-lookup"><span data-stu-id="2aa8d-172">Using IMEs with DXUT</span></span>

<span data-ttu-id="2aa8d-173">Dans DXUT, la classe CDXUTIMEEditBox implémente la fonctionnalité IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-173">In DXUT, the CDXUTIMEEditBox class implements IME functionality.</span></span> <span data-ttu-id="2aa8d-174">Cette classe est dérivée de la classe CDXUTEditBox, le contrôle d’édition de base fourni par le Framework.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-174">This class is derived from the CDXUTEditBox class, the basic edit control provided by the framework.</span></span> <span data-ttu-id="2aa8d-175">CDXUTIMEEditBox étend ce contrôle d’édition pour prendre en charge les IME en remplaçant les méthodes CDXUTIMEEditBox.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-175">CDXUTIMEEditBox extends that edit control to support IMEs by overriding the CDXUTIMEEditBox methods.</span></span> <span data-ttu-id="2aa8d-176">Les classes sont conçues pour aider les développeurs à apprendre ce qu’ils doivent effectuer à partir de l’infrastructure pour implémenter la prise en charge de l’éditeur IME dans leurs propres contrôles d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-176">The classes are designed this way to help developers learn what they need to take from the framework to implement IME support in their own edit controls.</span></span> <span data-ttu-id="2aa8d-177">Le reste de cette rubrique explique comment l’infrastructure, et CDXUTIMEEditBox en particulier, substitue un contrôle d’édition de base pour implémenter les fonctionnalités IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-177">The rest of this topic explains how the framework, and CDXUTIMEEditBox in particular, overrides a basic edit control to implement IME functionality.</span></span>

<span data-ttu-id="2aa8d-178">La plupart des variables spécifiques à l’IME dans CDXUTIMEEditBox sont déclarées comme statiques, car de nombreux tampons et États IME sont spécifiques au processus.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-178">Most of the IME-specific variables in CDXUTIMEEditBox are declared as static, because many IME buffers and states are specific to the process.</span></span> <span data-ttu-id="2aa8d-179">Par exemple, un processus ne possède qu’un seul tampon pour la chaîne de composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-179">For instance, a process has only one buffer for the composition string.</span></span> <span data-ttu-id="2aa8d-180">Même si le processus comporte dix contrôles d’édition, ils partagent tous la même mémoire tampon de la chaîne de composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-180">Even if the process has ten edit controls, they will all be sharing the same composition string buffer.</span></span> <span data-ttu-id="2aa8d-181">La mémoire tampon de la chaîne de composition pour CDXUTIMEEditBox est donc statique, ce qui empêche l’application d’occuper de l’espace mémoire inutile.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-181">The composition string buffer for CDXUTIMEEditBox is therefore static, preventing the application from taking up unnecessary memory space.</span></span>

<span data-ttu-id="2aa8d-182">CDXUTIMEEditBox est implémenté dans le code DXUT suivant :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-182">CDXUTIMEEditBox is implemented in the following DXUT code:</span></span>

<span data-ttu-id="2aa8d-183">(Racine SDK) \\ Exemples \\ \\ Common \\ DXUTgui. cpp du C++</span><span class="sxs-lookup"><span data-stu-id="2aa8d-183">(SDK root)\\Samples\\C++\\Common\\DXUTgui.cpp</span></span>

## <a name="overriding-the-default-ime-behavior"></a><span data-ttu-id="2aa8d-184">Substitution du comportement IME par défaut</span><span class="sxs-lookup"><span data-stu-id="2aa8d-184">Overriding the Default IME Behavior</span></span>

<span data-ttu-id="2aa8d-185">Normalement, un IME utilise des procédures Windows standard pour créer une fenêtre (voir [utilisation de Windows](/windows/desktop/winmsg/using-windows)).</span><span class="sxs-lookup"><span data-stu-id="2aa8d-185">Normally an IME uses standard Windows procedures to create a window (see [Using Windows](/windows/desktop/winmsg/using-windows)).</span></span> <span data-ttu-id="2aa8d-186">Dans des circonstances normales, cela produit des résultats satisfaisants.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-186">Under normal circumstances, this produces satisfactory results.</span></span> <span data-ttu-id="2aa8d-187">Toutefois, lorsque l’application s’affiche en mode plein écran, comme c’est souvent le cas pour les jeux, les fenêtres standard ne fonctionnent plus et peuvent ne pas s’afficher en plus de l’application.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-187">However, when the application presents in full-screen mode, as is common for games, standard windows no longer work and may not display on top of the application.</span></span> <span data-ttu-id="2aa8d-188">Pour surmonter ce problème, l’application doit dessiner les fenêtres IME lui-même au lieu de s’appuyer sur Windows pour effectuer cette tâche.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-188">To overcome this issue, the application must draw the IME windows itself instead of relying on Windows to perform this task.</span></span>

<span data-ttu-id="2aa8d-189">Lorsque le comportement de création de la fenêtre IME par défaut ne fournit pas ce qu’une application requiert, l’application peut remplacer la gestion de la fenêtre IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-189">When the default IME window creation behavior does not provide what an application requires, the application can override the IME window handling.</span></span> <span data-ttu-id="2aa8d-190">Une application peut y parvenir en traitant les messages liés à l’IME et en appelant l’API du [Gestionnaire de méthode d’entrée](/windows/desktop/Intl/input-method-manager) (IMM).</span><span class="sxs-lookup"><span data-stu-id="2aa8d-190">An application can achieve this by processing IME-related messages and calling the [Input Method Manager](/windows/desktop/Intl/input-method-manager) (IMM) API.</span></span>

<span data-ttu-id="2aa8d-191">Lorsqu’un utilisateur interagit avec un IME pour entrer des caractères complexes, le IMM envoie des messages à l’application pour l’informer des événements importants, tels que le démarrage d’une composition ou l’indication de la fenêtre candidate.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-191">When a user interacts with an IME to input complex characters, the IMM sends messages to the application to notify it of important events, such as starting a composition or showing the candidate window.</span></span> <span data-ttu-id="2aa8d-192">En général, une application ignore ces messages et les transmet au gestionnaire de messages par défaut, ce qui amène l’IME à les gérer.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-192">An application typically ignores these messages and passes them to the default message handler, which causes the IME to handle them.</span></span> <span data-ttu-id="2aa8d-193">Lorsque l’application, au lieu du gestionnaire par défaut, gère les messages, elle contrôle exactement ce qui se produit à chacun des événements IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-193">When the application, instead of the default handler, handles the messages, it controls exactly what happens at each of the IME events.</span></span> <span data-ttu-id="2aa8d-194">Souvent, le gestionnaire de messages récupère le contenu des différentes fenêtres IME en appelant l’API IMM.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-194">Often the message handler retrieves the content of the various IME windows by calling the IMM API.</span></span> <span data-ttu-id="2aa8d-195">Une fois que l’application dispose de ces informations, elle peut dessiner correctement les fenêtres IME lorsqu’elle doit effectuer un rendu à l’affichage.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-195">Once the application has this information, it can properly draw the IME windows itself when it needs to render to the display.</span></span>

## <a name="functions"></a><span data-ttu-id="2aa8d-196">Fonctions</span><span class="sxs-lookup"><span data-stu-id="2aa8d-196">Functions</span></span>

<span data-ttu-id="2aa8d-197">Un IME doit recevoir la chaîne de lecture, masquer la fenêtre de lecture et afficher l’orientation de la fenêtre de lecture.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-197">An IME needs to get the reading string, hide the reading window, and get the orientation of reading window.</span></span> <span data-ttu-id="2aa8d-198">Ce tableau indique les fonctionnalités par version de l’IME :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-198">This table shows the functionalities per IME version:</span></span>



|                    | <span data-ttu-id="2aa8d-199">Obtenir la chaîne de lecture</span><span class="sxs-lookup"><span data-stu-id="2aa8d-199">Getting reading string</span></span>                                                | <span data-ttu-id="2aa8d-200">Masquer la fenêtre de lecture</span><span class="sxs-lookup"><span data-stu-id="2aa8d-200">Hiding reading window</span></span>                       | <span data-ttu-id="2aa8d-201">Orientation de la fenêtre de lecture</span><span class="sxs-lookup"><span data-stu-id="2aa8d-201">Orientation of reading window</span></span>                              |
|--------------------|-----------------------------------------------------------------------|---------------------------------------------|------------------------------------------------------------|
| <span data-ttu-id="2aa8d-202">Avant la version 6,0</span><span class="sxs-lookup"><span data-stu-id="2aa8d-202">Before version 6.0</span></span> | <span data-ttu-id="2aa8d-203">R.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-203">A.</span></span> <span data-ttu-id="2aa8d-204">Lecture directe des données privées de l’IME d’accès à la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-204">Reading Window Access IME private data directly.</span></span> <span data-ttu-id="2aa8d-205">Voir « structure 4 »</span><span class="sxs-lookup"><span data-stu-id="2aa8d-205">See "4 Structure"</span></span> | <span data-ttu-id="2aa8d-206">Interceptez les messages privés de l’IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-206">Trap IME private messages.</span></span> <span data-ttu-id="2aa8d-207">Voir « 3 messages »</span><span class="sxs-lookup"><span data-stu-id="2aa8d-207">See "3 Messages"</span></span> | <span data-ttu-id="2aa8d-208">Examinez les informations du Registre.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-208">Examine registry information.</span></span> <span data-ttu-id="2aa8d-209">Voir « 5 informations de Registre »</span><span class="sxs-lookup"><span data-stu-id="2aa8d-209">See "5 Registry Information"</span></span> |
| <span data-ttu-id="2aa8d-210">Après la version 6,0</span><span class="sxs-lookup"><span data-stu-id="2aa8d-210">After version 6.0</span></span>  | [<span data-ttu-id="2aa8d-211">GetReadingString</span><span class="sxs-lookup"><span data-stu-id="2aa8d-211">GetReadingString</span></span>](#getreadingstring)                                 | [<span data-ttu-id="2aa8d-212">ShowReadingWindow</span><span class="sxs-lookup"><span data-stu-id="2aa8d-212">ShowReadingWindow</span></span>](#showreadingwindow)     | [<span data-ttu-id="2aa8d-213">GetReadingString</span><span class="sxs-lookup"><span data-stu-id="2aa8d-213">GetReadingString</span></span>](#getreadingstring)                      |



 

## <a name="messages"></a><span data-ttu-id="2aa8d-214">Messages</span><span class="sxs-lookup"><span data-stu-id="2aa8d-214">Messages</span></span>

<span data-ttu-id="2aa8d-215">Les messages suivants n’ont pas besoin d’être traités pour un IME plus récent qui implémente [ShowReadingWindow](#showreadingwindow)().</span><span class="sxs-lookup"><span data-stu-id="2aa8d-215">The following messages don't have to be processed for newer IME that implements [ShowReadingWindow](#showreadingwindow)().</span></span>

<span data-ttu-id="2aa8d-216">Les messages suivants sont interceptés par le gestionnaire de messages d’application (autrement dit, ils ne sont pas transmis à DefWindowProc) pour empêcher la fenêtre de lecture de s’affiche.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-216">The following messages are trapped by application message handler (i.e. they are not passed to DefWindowProc) to prevent the reading window from showing up.</span></span>

``` syntax
Msg == WM_IME_NOTIFY
wParam == IMN_PRIVATE
lParam == 1, 2 (CHT IME version 4.2, 4.3 and 4.4 / CHS IME 4.1 and 4.2)
lParam == 16, 17, 26, 27, 28 (CHT IME version 5.0, 5.1, 5.2 / CHS IME 5.3)
```

## <a name="examples"></a><span data-ttu-id="2aa8d-217">Exemples</span><span class="sxs-lookup"><span data-stu-id="2aa8d-217">Examples</span></span>

<span data-ttu-id="2aa8d-218">Les exemples suivants montrent comment obtenir des informations de chaîne d’un IME antérieur qui n’a pas de GetReadingString ().</span><span class="sxs-lookup"><span data-stu-id="2aa8d-218">The following examples illustrate how to get reading string information from older IME that doesn't have GetReadingString().</span></span> <span data-ttu-id="2aa8d-219">Le code génère les sorties suivantes :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-219">The code generates the following outputs:</span></span>



|              |                                                                                       |
|--------------|---------------------------------------------------------------------------------------|
| <span data-ttu-id="2aa8d-220">DWORD dwlen</span><span class="sxs-lookup"><span data-stu-id="2aa8d-220">DWORD dwlen</span></span>  | <span data-ttu-id="2aa8d-221">Longueur de la chaîne de lecture</span><span class="sxs-lookup"><span data-stu-id="2aa8d-221">Length of the reading string</span></span>                                                          |
| <span data-ttu-id="2aa8d-222">DWORD dwerr</span><span class="sxs-lookup"><span data-stu-id="2aa8d-222">DWORD dwerr</span></span>  | <span data-ttu-id="2aa8d-223">Index du caractère d’erreur</span><span class="sxs-lookup"><span data-stu-id="2aa8d-223">Index of error char</span></span>                                                                   |
| <span data-ttu-id="2aa8d-224">LPWSTR WSTR</span><span class="sxs-lookup"><span data-stu-id="2aa8d-224">LPWSTR wstr</span></span>  | <span data-ttu-id="2aa8d-225">Pointeur vers la chaîne de lecture</span><span class="sxs-lookup"><span data-stu-id="2aa8d-225">Pointer to the reading string</span></span>                                                         |
| <span data-ttu-id="2aa8d-226">BOOL Unicode</span><span class="sxs-lookup"><span data-stu-id="2aa8d-226">BOOL unicode</span></span> | <span data-ttu-id="2aa8d-227">Si la valeur est true, la chaîne de lecture est au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-227">If true, the reading string is in Unicode format.</span></span> <span data-ttu-id="2aa8d-228">Dans le cas contraire, il est au format multioctet.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-228">Otherwise it's in multibyte format.</span></span> |



 

### <a name="cht-ime-version-42-43-and-44"></a><span data-ttu-id="2aa8d-229">Version de l’IME CHT 4,2, 4,3 et 4,4</span><span class="sxs-lookup"><span data-stu-id="2aa8d-229">CHT IME version 4.2, 4.3 and 4.4</span></span>

``` syntax
LPINPUTCONTEXT lpIMC = _ImmLockIMC(himc);
LPBYTE p = *(LPBYTE *)((LPBYTE)_ImmLockIMCC(lpIMC->hPrivate) + 24);
if (!p) break;
dwlen = *(DWORD *)(p + 7*4 + 32*4);
dwerr = *(DWORD *)(p + 8*4 + 32*4);
wstr = (WCHAR *)(p + 56);
unicode = TRUE;
```

### <a name="cht-ime-version-50"></a><span data-ttu-id="2aa8d-230">Version de l’IME CHT 5,0</span><span class="sxs-lookup"><span data-stu-id="2aa8d-230">CHT IME version 5.0</span></span>

``` syntax
LPINPUTCONTEXT lpIMC = _ImmLockIMC(himc);
LPBYTE p = *(LPBYTE *)((LPBYTE)_ImmLockIMCC(lpIMC->hPrivate) + 3*4);
if (!p) break;
p = *(LPBYTE *)((LPBYTE)p + 1*4 + 5*4 + 4*2 );
if (!p) break;
dwlen = *(DWORD *)(p + 1*4 + (16*2+2*4) + 5*4 + 16);
dwerr = *(DWORD *)(p + 1*4 + (16*2+2*4) + 5*4 + 16 + 1*4);
wstr = (WCHAR *)(p + 1*4 + (16*2+2*4) + 5*4);
unicode = FALSE;
```

### <a name="cht-ime-version-51-52-and-chs-ime-version-53"></a><span data-ttu-id="2aa8d-231">Version de l’IME CHT 5,1, 5,2 et CHS (IME) 5,3</span><span class="sxs-lookup"><span data-stu-id="2aa8d-231">CHT IME version 5.1, 5.2 and CHS IME version 5.3</span></span>

``` syntax
LPINPUTCONTEXT lpIMC = _ImmLockIMC(himc);
LPBYTE p = *(LPBYTE *)((LPBYTE)_ImmLockIMCC(lpIMC->hPrivate) + 4);
if (!p) break;
p = *(LPBYTE *)((LPBYTE)p + 1*4 + 5*4); 
if (!p) break;
dwlen = *(DWORD *)(p + 1*4 + (16*2+2*4) + 5*4 + 16 * 2);
dwerr = *(DWORD *)(p + 1*4 + (16*2+2*4) + 5*4 + 16 * 2 + 1*4);
wstr  = (WCHAR *) (p + 1*4 + (16*2+2*4) + 5*4);
unicode = TRUE;
```

### <a name="chs-ime-version-41"></a><span data-ttu-id="2aa8d-232">Version d’IME CHS 4,1</span><span class="sxs-lookup"><span data-stu-id="2aa8d-232">CHS IME version 4.1</span></span>

``` syntax
// GetImeId(1) returns VS_FIXEDFILEINFO:: dwProductVersionLS of IME file
int offset = ( GetImeId( 1 ) >= 0x00000002 ) ? 8 : 7;
LPINPUTCONTEXT lpIMC = _ImmLockIMC(himc);
BYTE p = *(LPBYTE *)((LPBYTE)_ImmLockIMCC(lpIMC->hPrivate) + offset * 4);
if (!p) break;
dwlen = *(DWORD *)(p + 7*4 + 16*2*4);
dwerr = *(DWORD *)(p + 8*4 + 16*2*4);
dwerr = min(dwerr, dwlen);
wstr = (WCHAR *)(p + 6*4 + 16*2*1);
unicode = TRUE;
```

### <a name="chs-ime-version-42"></a><span data-ttu-id="2aa8d-233">Version d’IME CHS 4,2</span><span class="sxs-lookup"><span data-stu-id="2aa8d-233">CHS IME version 4.2</span></span>

``` syntax
int nTcharSize = IsNT() ? sizeof(WCHAR) : sizeof(char);
LPINPUTCONTEXT lpIMC = _ImmLockIMC(himc);
BYTE p = *(LPBYTE *)((LPBYTE)_ImmLockIMCC(lpIMC->hPrivate) + 1*4 + 1*4 + 6*4);
if (!p) break;
dwlen = *(DWORD *)(p + 1*4 + (16*2+2*4) + 5*4 + 16 * nTcharSize);
dwerr = *(DWORD *)(p + 1*4 + (16*2+2*4) + 5*4 + 16 * nTcharSize + 1*4);
wstr  = (WCHAR *) (p + 1*4 + (16*2+2*4) + 5*4);
unicode = IsNT() ? TRUE : FALSE;
```

## <a name="ime-messages"></a><span data-ttu-id="2aa8d-234">Messages IME</span><span class="sxs-lookup"><span data-stu-id="2aa8d-234">IME Messages</span></span>

<span data-ttu-id="2aa8d-235">Une application en plein écran doit gérer correctement les messages liés à l’IME suivants :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-235">A full-screen application must properly handle the following IME-related messages:</span></span>

### <a name="wm_inputlangchange"></a><span data-ttu-id="2aa8d-236">\_INPUTLANGCHANGE WM</span><span class="sxs-lookup"><span data-stu-id="2aa8d-236">WM\_INPUTLANGCHANGE</span></span>

<span data-ttu-id="2aa8d-237">Le IMM envoie un \_ message WM INPUTLANGCHANGE à la fenêtre active d’une application une fois que les paramètres régionaux d’entrée ont été modifiés par l’utilisateur avec une combinaison de touches (généralement Alt + Maj) ou avec l’indicateur de paramètres régionaux d’entrée sur la barre des tâches ou la barre de langue.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-237">The IMM sends a WM\_INPUTLANGCHANGE message to the active window of an application after the input locale has been changed by the user with a key combination (usually ALT+SHIFT), or with the input locale indicator on the taskbar or language bar.</span></span> <span data-ttu-id="2aa8d-238">La barre de langue est un contrôle à l’écran avec lequel l’utilisateur peut configurer un service de texte.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-238">The language bar is an on-screen control with which the user can configure a text service.</span></span> <span data-ttu-id="2aa8d-239">(Voir [comment afficher la barre de langue](/windows/desktop/TSF/how-to-set-up-tsf).) La capture d’écran suivante montre une liste de sélection de la langue qui s’affiche lorsque l’utilisateur clique sur l’indicateur de paramètres régionaux.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-239">(See [How to show the language bar](/windows/desktop/TSF/how-to-set-up-tsf).) The following screen shot shows a language selection list that is displayed when the user clicks on the locale indicator.</span></span>

![liste de sélection de la langue qui s’affiche lorsque l’utilisateur clique sur l’indicateur de paramètres régionaux](images/ime-langselection.png)

<span data-ttu-id="2aa8d-241">Lorsque le IMM envoie un \_ message WM INPUTLANGCHANGE, CDXUTIMEEditBox doit effectuer plusieurs tâches importantes :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-241">When the IMM sends a WM\_INPUTLANGCHANGE message, CDXUTIMEEditBox must perform several important tasks:</span></span>

1.  <span data-ttu-id="2aa8d-242">La méthode GetKeyboardLayout est appelée pour retourner l’identificateur de paramètres régionaux (ID) d’entrée pour le thread d’application.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-242">The GetKeyboardLayout method is called to return the input locale identifier (ID) for the application thread.</span></span> <span data-ttu-id="2aa8d-243">La classe CDXUTIMEEditBox enregistre cet ID dans sa variable membre statique s \_ hklCurrent pour une utilisation ultérieure.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-243">The CDXUTIMEEditBox class saves this ID in its static member variable s\_hklCurrent for later use.</span></span> <span data-ttu-id="2aa8d-244">Il est important pour l’application de connaître les paramètres régionaux d’entrée actuels, car l’IME pour chaque langue a son propre comportement distinct.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-244">It is important for the application to know the current input locale, because the IME for each language has its own distinct behavior.</span></span> <span data-ttu-id="2aa8d-245">Le développeur peut avoir besoin de fournir un code différent pour différents paramètres régionaux d’entrée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-245">The developer may need to provide different code for different input locales.</span></span>
2.  <span data-ttu-id="2aa8d-246">CDXUTIMEEditBox Initialise une chaîne à afficher dans l’indicateur de langue de la zone d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-246">CDXUTIMEEditBox initializes a string to display in the edit box language indicator.</span></span> <span data-ttu-id="2aa8d-247">Cet indicateur peut afficher la langue d’entrée active lorsque l’application s’exécute en mode plein écran et que la barre des tâches ou la barre de langue n’est pas visible.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-247">This indicator can display the active input language when the application is running in full-screen mode and neither the taskbar nor language bar is visible.</span></span>
3.  <span data-ttu-id="2aa8d-248">La méthode ImmGetConversionStatus est appelée pour indiquer si les paramètres régionaux d’entrée sont en mode de conversion natif ou non natif.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-248">The ImmGetConversionStatus method is called to indicate whether the input locale is in native or non-native conversion mode.</span></span> <span data-ttu-id="2aa8d-249">Le mode de conversion natif permet à l’utilisateur d’entrer du texte dans la langue choisie.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-249">Native conversion mode lets the user enter text in the chosen language.</span></span> <span data-ttu-id="2aa8d-250">Le mode de conversion non natif fait du clavier un comportement en anglais standard.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-250">Non-native conversion mode makes the keyboard act as a standard English keyboard.</span></span> <span data-ttu-id="2aa8d-251">Il est important de fournir à l’utilisateur un indice visuel sur le type de mode de conversion dans lequel se trouve l’IME, afin que l’utilisateur puisse facilement savoir quels caractères attendre quand il appuie sur une touche.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-251">It is important to give the user a visual cue as to what type of conversion mode the IME is in, so that the user can easily know what characters to expect when hitting a key.</span></span> <span data-ttu-id="2aa8d-252">CDXUTIMEEditBox fournit cette indication visuelle avec une couleur d’indicateur de langue.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-252">CDXUTIMEEditBox provides this visual cue with a language indicator color.</span></span> <span data-ttu-id="2aa8d-253">Lorsque les paramètres régionaux d’entrée utilisent un IME avec le mode de conversion natif, la classe CDXUTIMEEditBox dessine le texte de l’indicateur avec la couleur définie par le \_ paramètre m IndicatorImeColor.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-253">When the input locale uses an IME with native conversion mode, the CDXUTIMEEditBox class draws the indicator text with the color defined by the m\_IndicatorImeColor parameter.</span></span> <span data-ttu-id="2aa8d-254">Lorsque l’IME est en mode de conversion non natif ou qu’aucun IME n’est utilisé, la classe dessine le texte de l’indicateur avec la couleur définie par le \_ paramètre m IndicatorEngColor.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-254">When the IME is in non-native conversion mode, or no IME is used at all, the class draws the indicator text with the color defined by the m\_IndicatorEngColor parameter.</span></span>
4.  <span data-ttu-id="2aa8d-255">CDXUTIMEEditBox vérifie les paramètres régionaux d’entrée et définit la variable membre statique s \_ bInsertOnType sur true pour le coréen et false pour toutes les autres langues.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-255">CDXUTIMEEditBox checks the input locale and sets the static member variable s\_bInsertOnType to TRUE for Korean and FALSE for all other languages.</span></span> <span data-ttu-id="2aa8d-256">Cet indicateur est requis en raison des différents comportements des IME coréens et de tous les autres IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-256">This flag is required because of the different behaviors of Korean IMEs and all other IMEs.</span></span> <span data-ttu-id="2aa8d-257">Lorsque vous entrez des caractères dans des langues autres que le coréen, le texte entré par l’utilisateur est affiché dans la fenêtre de composition, et l’utilisateur peut modifier librement le contenu de la chaîne de composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-257">When entering characters in languages other than Korean, the user-entered text is displayed in the composition window, and the user can freely change the content of the composition string.</span></span> <span data-ttu-id="2aa8d-258">L’utilisateur appuie sur la touche entrée lorsque la chaîne de composition est satisfaite, et la chaîne de composition est envoyée à l’application sous la forme d’une série de \_ messages WM char.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-258">The user presses the ENTER key when satisfied with the composition string, and the composition string is sent to the application as a series of WM\_CHAR messages.</span></span> <span data-ttu-id="2aa8d-259">Toutefois, dans les éditeurs IME coréens, quand un utilisateur appuie sur une touche pour entrer du texte, un caractère est immédiatement envoyé à l’application.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-259">In Korean IMEs, however, when a user presses a key to enter text, a character is immediately sent to the application.</span></span> <span data-ttu-id="2aa8d-260">Lorsque l’utilisateur appuie ensuite sur plus de touches pour modifier ce caractère initial, le caractère dans la zone d’édition change pour refléter une entrée supplémentaire de la part de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-260">When the user subsequently presses more keys to modify that initial character, the character in the edit box changes to reflect additional input from the user.</span></span> <span data-ttu-id="2aa8d-261">Pour l’essentiel, l’utilisateur compose des caractères dans la zone d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-261">Essentially, the user is composing characters in the edit box.</span></span> <span data-ttu-id="2aa8d-262">Ces deux comportements sont suffisamment différents pour que CDXUTIMEEditBox doive coder spécifiquement pour chacun d’eux.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-262">These two behaviors are different enough that CDXUTIMEEditBox must code for each of them specifically.</span></span>
5.  <span data-ttu-id="2aa8d-263">La méthode membre statique SetupImeApi est appelée pour récupérer les adresses de deux fonctions à partir du module IME : GetReadingString et ShowReadingWindow.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-263">The static member method SetupImeApi is called to retrieve addresses of two functions from the IME module: GetReadingString and ShowReadingWindow.</span></span> <span data-ttu-id="2aa8d-264">Si ces fonctions existent, ShowReadingWindow est appelé pour masquer la fenêtre de lecture par défaut pour cet IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-264">If these functions exist, ShowReadingWindow is called to hide the default reading window for this IME.</span></span> <span data-ttu-id="2aa8d-265">Étant donné que l’application affiche la fenêtre de lecture elle-même, elle indique à l’IME de désactiver le dessin de la fenêtre de lecture par défaut afin qu’elle n’interfère pas avec le rendu plein écran.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-265">Because the application renders the reading window itself, it notifies the IME to disable drawing the default reading window so that it will not interfere with full-screen rendering.</span></span>

<span data-ttu-id="2aa8d-266">Le IMM envoie un \_ message WM IME \_ SETCONTEXT lorsqu’une fenêtre de l’application est activée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-266">The IMM sends a WM\_IME\_SETCONTEXT message when a window of the application is activated.</span></span> <span data-ttu-id="2aa8d-267">Le paramètre lParam de ce message contient un indicateur qui indique à l’éditeur de l’éditeur que les fenêtres doivent être dessinées et celles qui ne le doivent pas.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-267">The lParam parameter of this message contains a flag that indicates to the IME which windows should get drawn and which should not.</span></span> <span data-ttu-id="2aa8d-268">Étant donné que l’application gère tout le dessin, elle n’a pas besoin de l’éditeur IME pour dessiner les fenêtres IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-268">Because the application is handling all of the drawing, it does not need the IME to draw any of the IME windows.</span></span> <span data-ttu-id="2aa8d-269">Par conséquent, le gestionnaire de messages de l’application affecte simplement à lParam la valeur 0 et retourne.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-269">Therefore, the application's message handler simply sets lParam to 0 and returns.</span></span>

<span data-ttu-id="2aa8d-270">Pour que les applications prennent en charge l’IME, un traitement spécial est nécessaire pour le message IME WM \_ IME \_ SETCONTEXT.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-270">In order for applications to support IME, special processing is needed for the IME-related message WM\_IME\_SETCONTEXT.</span></span> <span data-ttu-id="2aa8d-271">Dans la mesure où Windows envoie généralement ce message à l’application avant d’appeler la méthode PanoramaInitialize (), le panorama n’a pas la possibilité de traiter l’interface utilisateur pour afficher les fenêtres de liste de candidats.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-271">Since Windows typically sends this message to the application prior to calling the PanoramaInitialize() method, Panorama doesn't have a chance to process the UI for showing candidate list windows.</span></span>

<span data-ttu-id="2aa8d-272">L’extrait de code suivant spécifie que les applications Windows n’affichent pas d’interface utilisateur associée à la fenêtre Liste des candidats, ce qui permet au panorama de gérer spécifiquement cette interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-272">The following code snippet specifies to Windows applications not to display any UI associated with the candidate list window, allowing Panorama to specifically handle this UI.</span></span>

``` syntax
case WM_IME_SETCONTEXT:
         lParam = 0;
    lRet = DefWindowProc(hWnd, msg, wParam, lParam);
    break;
    //... more message processing
    return lRet;
```

### <a name="wm_ime_startcomposition"></a><span data-ttu-id="2aa8d-273">STARTCOMPOSITION de l' \_ IME WM \_</span><span class="sxs-lookup"><span data-stu-id="2aa8d-273">WM\_IME\_STARTCOMPOSITION</span></span>

<span data-ttu-id="2aa8d-274">Le IMM envoie un \_ \_ message STARTCOMPOSITION WM à l’application lorsqu’une composition IME est sur le le début de la séquence de touches par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-274">The IMM sends a WM\_IME\_STARTCOMPOSITION message to the application when an IME composition is about to begin as a result of keystrokes by the user.</span></span> <span data-ttu-id="2aa8d-275">Si l’IME utilise la fenêtre de composition, il affiche la chaîne de composition actuelle dans une fenêtre de composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-275">If the IME uses the composition window, it displays the current composition string in a composition window.</span></span> <span data-ttu-id="2aa8d-276">CDXUTIMEEditBox gère ce message en effectuant deux tâches :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-276">CDXUTIMEEditBox handles this message by performing two tasks:</span></span>

1.  <span data-ttu-id="2aa8d-277">CDXUTIMEEditBox efface la mémoire tampon de la chaîne de composition et la mémoire tampon d’attribut.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-277">CDXUTIMEEditBox clears the composition string buffer and attribute buffer.</span></span> <span data-ttu-id="2aa8d-278">Ces mémoires tampons sont des membres statiques de CDXUTIMEEditBox.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-278">These buffers are static members of CDXUTIMEEditBox.</span></span>
2.  <span data-ttu-id="2aa8d-279">CDXUTIMEEditBox définit la \_ variable de membre statique bHideCaret sur true.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-279">CDXUTIMEEditBox sets the s\_bHideCaret static member variable to TRUE.</span></span> <span data-ttu-id="2aa8d-280">Ce membre, défini dans la classe de base CDXUTEditBox, contrôle si le curseur dans la zone d’édition doit être dessiné lors du rendu de la zone d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-280">This member, defined in the base CDXUTEditBox class, controls whether the cursor in the edit box should be drawn when the edit box is rendered.</span></span> <span data-ttu-id="2aa8d-281">La fenêtre de composition fonctionne de la même manière qu’une zone d’édition avec du texte et un curseur.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-281">The composition window functions similarly to an edit box with text and cursor.</span></span> <span data-ttu-id="2aa8d-282">Pour éviter toute confusion lorsque la fenêtre de composition est visible, la zone d’édition masque son curseur afin qu’un seul curseur soit visible à la fois.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-282">To avoid confusion when the composition window is visible, the edit box hides its cursor so that only one cursor is visible at a time.</span></span>

### <a name="wm_ime_composition"></a><span data-ttu-id="2aa8d-283">COMPOSITION de l' \_ IME WM \_</span><span class="sxs-lookup"><span data-stu-id="2aa8d-283">WM\_IME\_COMPOSITION</span></span>

<span data-ttu-id="2aa8d-284">Le IMM envoie un \_ message de composition WM IME \_ à l’application lorsque l’utilisateur entre une séquence de touches pour modifier la chaîne de composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-284">The IMM sends a WM\_IME\_COMPOSITION message to the application when the user enters a keystroke to change the composition string.</span></span> <span data-ttu-id="2aa8d-285">La valeur de lParam indique le type d’informations que l’application peut récupérer à partir du gestionnaire de méthode d’entrée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-285">The value of lParam indicates what type of information the application can retrieve from the Input Method Manager (IMM).</span></span> <span data-ttu-id="2aa8d-286">L’application doit récupérer les informations disponibles en appelant [**ImmGetCompositionString**](/windows/desktop/api/imm/nf-imm-immgetcompositionstringa) , puis enregistrer les informations dans sa mémoire tampon privée afin de pouvoir restituer les éléments IME ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-286">The application should retrieve the available information by calling [**ImmGetCompositionString**](/windows/desktop/api/imm/nf-imm-immgetcompositionstringa) and then should save the information in its private buffer so that it can render the IME elements later.</span></span>

<span data-ttu-id="2aa8d-287">CDXUTIMEEditBox vérifie et récupère les données de chaîne de composition suivantes :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-287">CDXUTIMEEditBox checks for and retrieves the following composition string data:</span></span>



| <span data-ttu-id="2aa8d-288">[**WM \_ Valeur \_**](/windows/desktop/Intl/wm-ime-composition) de l’indicateur lParam de la composition IME</span><span class="sxs-lookup"><span data-stu-id="2aa8d-288">[**WM\_IME\_COMPOSITION**](/windows/desktop/Intl/wm-ime-composition) lParam Flag Value</span></span> | <span data-ttu-id="2aa8d-289">Données</span><span class="sxs-lookup"><span data-stu-id="2aa8d-289">Data</span></span>                           | <span data-ttu-id="2aa8d-290">Description</span><span class="sxs-lookup"><span data-stu-id="2aa8d-290">Description</span></span>                                                                                                                                                                                                                                                                                                                                                          |
|-----------------------------------------------------------------------|--------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2aa8d-291">comfromateurs \_ gc</span><span class="sxs-lookup"><span data-stu-id="2aa8d-291">GCS\_COMPATTR</span></span>                                                         | <span data-ttu-id="2aa8d-292">Attribut de composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-292">Composition Attribute</span></span>          | <span data-ttu-id="2aa8d-293">Cet attribut contient des informations telles que l’état de chaque caractère dans la chaîne de composition (par exemple, converti ou non converti).</span><span class="sxs-lookup"><span data-stu-id="2aa8d-293">This attribute contains information such as the status of each character in the composition string (for example, converted or non-converted).</span></span> <span data-ttu-id="2aa8d-294">Ces informations sont nécessaires, car CDXUTIMEEditBox colore les caractères de la chaîne de composition différemment en fonction de leurs attributs.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-294">This information is needed because CDXUTIMEEditBox colors the composition string characters differently based upon their attributes.</span></span>                                                                                   |
| <span data-ttu-id="2aa8d-295">catalogues globaux \_ COMPCLAUSE</span><span class="sxs-lookup"><span data-stu-id="2aa8d-295">GCS\_COMPCLAUSE</span></span>                                                       | <span data-ttu-id="2aa8d-296">Informations sur la clause de composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-296">Composition Clause Information</span></span> | <span data-ttu-id="2aa8d-297">Ces informations de clause sont utilisées lorsque l’IME japonais est actif.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-297">This clause information is used when the Japanese IME is active.</span></span> <span data-ttu-id="2aa8d-298">Lorsqu’une chaîne de composition japonaise est convertie, les caractères peuvent être regroupés en une clause qui est convertie en une entité unique.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-298">When a Japanese composition string is converted, characters may be grouped together as a clause that gets converted to a single entity.</span></span> <span data-ttu-id="2aa8d-299">Lorsque l’utilisateur déplace le curseur, CDXUTIMEEditBox utilise ces informations pour mettre en surbrillance la clause entière, plutôt qu’un seul caractère dans la clause.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-299">When the user moves the cursor, CDXUTIMEEditBox uses this information to highlight the entire clause, instead of just a single character within the clause.</span></span> |
| <span data-ttu-id="2aa8d-300">catalogues globaux \_ COMPSTR</span><span class="sxs-lookup"><span data-stu-id="2aa8d-300">GCS\_COMPSTR</span></span>                                                          | <span data-ttu-id="2aa8d-301">Chaîne de composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-301">Composition String</span></span>             | <span data-ttu-id="2aa8d-302">Cette chaîne est la chaîne à jour qui est composée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-302">This string is the up-to-date string being composed by the user.</span></span> <span data-ttu-id="2aa8d-303">Il s’agit également de la chaîne affichée dans la fenêtre de composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-303">This is also the string displayed in the composition window.</span></span>                                                                                                                                                                                                                                        |
| <span data-ttu-id="2aa8d-304">catalogues globaux \_ CURSORPOS</span><span class="sxs-lookup"><span data-stu-id="2aa8d-304">GCS\_CURSORPOS</span></span>                                                        | <span data-ttu-id="2aa8d-305">Position du curseur de la composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-305">Composition Cursor Position</span></span>    | <span data-ttu-id="2aa8d-306">La fenêtre de composition implémente un curseur, similaire au curseur dans une zone d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-306">The composition window implements a cursor, similar to the cursor in an edit box.</span></span> <span data-ttu-id="2aa8d-307">L’application peut récupérer la position du curseur lors du traitement du \_ message de composition de l’IME WM afin \_ de dessiner le curseur correctement.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-307">The application can retrieve the cursor position when processing the WM\_IME\_COMPOSITION message in order to draw the cursor properly.</span></span>                                                                                                                                            |
| <span data-ttu-id="2aa8d-308">GC \_ RESULTSTR</span><span class="sxs-lookup"><span data-stu-id="2aa8d-308">GCS\_RESULTSTR</span></span>                                                        | <span data-ttu-id="2aa8d-309">Chaîne de résultat</span><span class="sxs-lookup"><span data-stu-id="2aa8d-309">Result String</span></span>                  | <span data-ttu-id="2aa8d-310">La chaîne de résultat est disponible lorsque l’utilisateur est sur le paragraphe de terminer le processus de composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-310">The result string is available when the user is about to complete the composition process.</span></span> <span data-ttu-id="2aa8d-311">Cette chaîne doit être récupérée et les caractères doivent être envoyés à la zone d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-311">This string should be retrieved and the characters should be sent to the edit box.</span></span>                                                                                                                                                                                        |



 

### <a name="wm_ime_endcomposition"></a><span data-ttu-id="2aa8d-312">ENDCOMPOSITION de l' \_ IME WM \_</span><span class="sxs-lookup"><span data-stu-id="2aa8d-312">WM\_IME\_ENDCOMPOSITION</span></span>

<span data-ttu-id="2aa8d-313">Le IMM envoie un \_ \_ message ENDCOMPOSITION WM à l’application lorsque l’opération de composition IME se termine.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-313">The IMM sends a WM\_IME\_ENDCOMPOSITION message to the application when the IME composition operation is ending.</span></span> <span data-ttu-id="2aa8d-314">Cela peut se produire lorsque l’utilisateur appuie sur la touche entrée pour approuver la chaîne de composition, ou la touche ÉCHAP pour annuler la composition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-314">This can occur when the user presses the ENTER key to approve the composition string, or the ESC key to cancel the composition.</span></span> <span data-ttu-id="2aa8d-315">CDXUTIMEEditBox gère ce message en définissant la mémoire tampon de la chaîne de composition sur vide.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-315">CDXUTIMEEditBox handles this message by setting the composition string buffer to be empty.</span></span> <span data-ttu-id="2aa8d-316">Il définit ensuite \_ bHideCaret sur false, car la fenêtre de composition est fermée et le curseur dans la zone d’édition doit à nouveau être visible.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-316">It then sets s\_bHideCaret to FALSE because the composition window is closed and the cursor in the edit box should again be visible.</span></span>

<span data-ttu-id="2aa8d-317">Le gestionnaire de messages CDXUTIMEEditBox affecte également \_ à bShowReadingWindow la valeur false.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-317">The CDXUTIMEEditBox message handler also sets s\_bShowReadingWindow to FALSE.</span></span> <span data-ttu-id="2aa8d-318">Cet indicateur contrôle si la classe dessine la fenêtre de lecture lorsque la zone d’édition s’affiche elle-même. elle doit donc avoir la valeur FALSe lorsqu’une composition se termine.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-318">This flag controls whether the class draws the reading window when the edit box renders itself, so it must be set to FALSE when a composition ends.</span></span>

### <a name="wm_ime_notify"></a><span data-ttu-id="2aa8d-319">notification de l' \_ IME WM \_</span><span class="sxs-lookup"><span data-stu-id="2aa8d-319">WM\_IME\_NOTIFY</span></span>

<span data-ttu-id="2aa8d-320">Le IMM envoie un \_ \_ message de notification de l’IME WM à l’application chaque fois qu’une fenêtre IME change.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-320">The IMM sends a WM\_IME\_NOTIFY message to the application whenever an IME window changes.</span></span> <span data-ttu-id="2aa8d-321">Une application qui gère le dessin des fenêtres IME doit traiter ce message afin qu’il prenne en charge toute mise à jour du contenu de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-321">An application that handles the drawing of the IME windows should process this message so that it is aware of any update to the content of the window.</span></span> <span data-ttu-id="2aa8d-322">WParam indique la commande ou la modification qui a lieu.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-322">The wParam indicates the command or the change that is taking place.</span></span> <span data-ttu-id="2aa8d-323">CDXUTIMEEditBox gère les commandes suivantes :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-323">CDXUTIMEEditBox handles the following commands:</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="2aa8d-324">Commande IME</span><span class="sxs-lookup"><span data-stu-id="2aa8d-324">IME Command</span></span></th>
<th><span data-ttu-id="2aa8d-325">Description</span><span class="sxs-lookup"><span data-stu-id="2aa8d-325">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="2aa8d-326"><a href="/windows/desktop/Intl/imn-setopenstatus">IMN_SETOPENSTATUS</a></span><span class="sxs-lookup"><span data-stu-id="2aa8d-326"><a href="/windows/desktop/Intl/imn-setopenstatus">IMN_SETOPENSTATUS</a></span></span></td>
<td><span data-ttu-id="2aa8d-327">Cet attribut contient des informations telles que l’état de chaque caractère dans la chaîne de composition (par exemple, converti ou non converti).</span><span class="sxs-lookup"><span data-stu-id="2aa8d-327">This attribute contains information such as the status of each character in the composition string (for example, converted or non-converted).</span></span> <span data-ttu-id="2aa8d-328">Ces informations sont nécessaires, car CDXUTIMEEditBox colore les caractères de la chaîne de composition différemment en fonction de leurs attributs.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-328">This information is needed because CDXUTIMEEditBox colors the composition string characters differently based upon their attributes.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2aa8d-329"><a href="/windows/desktop/Intl/imn-opencandidate">IMN_OPENCANDIDATE</a>  /  <a href="/windows/desktop/Intl/imn-changecandidate">IMN_CHANGECANDIDATE</a></span><span class="sxs-lookup"><span data-stu-id="2aa8d-329"><a href="/windows/desktop/Intl/imn-opencandidate">IMN_OPENCANDIDATE</a> / <a href="/windows/desktop/Intl/imn-changecandidate">IMN_CHANGECANDIDATE</a></span></span></td>
<td><span data-ttu-id="2aa8d-330">Envoyé à l’application lorsque la fenêtre candidate est sur le lieu d’être ouverte ou mise à jour, respectivement.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-330">Sent to the application when the candidate window is about to be opened or updated, respectively.</span></span> <span data-ttu-id="2aa8d-331">La fenêtre candidate s’ouvre lorsqu’un utilisateur souhaite modifier le texte converti.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-331">The candidate window opens when a user wishes to change the converted text choice.</span></span> <span data-ttu-id="2aa8d-332">La fenêtre est mise à jour lorsqu’un utilisateur déplace l’indicateur de sélection ou modifie la page.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-332">The window is updated when a user moves the selection indicator or changes the page.</span></span> <span data-ttu-id="2aa8d-333">CDXUTIMEEditBox utilise un gestionnaire de messages pour ces deux commandes, car les tâches requises sont exactement les mêmes :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-333">CDXUTIMEEditBox uses one message handler for both of these commands because the tasks required are exactly the same:</span></span><br/>
<ol>
<li><span data-ttu-id="2aa8d-334">CDXUTIMEEditBox définit le membre bShowWindow de la structure candidat List s_CandList sur TRUE pour indiquer que la fenêtre candidate doit être dessinée lors du rendu de frame.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-334">CDXUTIMEEditBox sets the bShowWindow member of the candidate list structure s_CandList to TRUE to indicate that the candidate window needs to be drawn during frame rendering.</span></span></li>
<li><span data-ttu-id="2aa8d-335">CDXUTIMEEditBox récupère la liste des candidats en appelant <a href="/windows/desktop/api/imm/nf-imm-immgetcandidatelista"><strong>ImmGetCandidateList</strong></a>, d’abord pour obtenir la taille de mémoire tampon requise, puis de nouveau pour obtenir les données réelles.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-335">CDXUTIMEEditBox retrieves the candidate list by calling <a href="/windows/desktop/api/imm/nf-imm-immgetcandidatelista"><strong>ImmGetCandidateList</strong></a>, first to get the required buffer size, and then again to get the actual data.</span></span></li>
<li><span data-ttu-id="2aa8d-336">La structure de liste de candidats privée s_CandList est initialisée avec les données candidates récupérées.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-336">The private candidate list structure s_CandList is initialized with the retrieved candidate data.</span></span></li>
<li><span data-ttu-id="2aa8d-337">Les chaînes candidates sont stockées sous la forme d’un tableau de chaînes.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-337">The candidate strings are stored as an array of strings.</span></span></li>
<li><span data-ttu-id="2aa8d-338">L’index de l’entrée sélectionnée, ainsi que l’index de la page, sont enregistrés.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-338">The index of the selected entry, as well as the page index, is saved.</span></span></li>
<li><span data-ttu-id="2aa8d-339">CDXUTIMEEditBox vérifie si le style de la fenêtre candidate est vertical ou horizontal.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-339">CDXUTIMEEditBox checks whether the candidate window style is vertical or horizontal.</span></span> <span data-ttu-id="2aa8d-340">Si le style de fenêtre est horizontal, une mémoire tampon de chaîne supplémentaire, le membre HoriCand de s_CandList, doivent être initialisées avec toutes les chaînes candidates, avec des espaces insérés entre toutes les chaînes adjacentes.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-340">If the window style is horizontal, an additional string buffer, the HoriCand member of s_CandList, must be initialized with all of the candidate strings, with space characters inserted between all adjacent strings.</span></span> <span data-ttu-id="2aa8d-341">Lors du rendu d’une fenêtre candidate verticale, les chaînes de candidats individuelles sont dessinées l’une après l’autre, avec les coordonnées y incrémentées pour chaque chaîne.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-341">When rendering a vertical candidate window, the individual candidate strings are drawn one at a time, with the y coordinates incremented for each string.</span></span> <span data-ttu-id="2aa8d-342">Toutefois, cette chaîne HoriCand doit être utilisée lors du rendu d’une fenêtre candidate horizontale, car le caractère espace est la meilleure façon de séparer deux chaînes adjacentes sur la même ligne.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-342">However, this HoriCand string should be used when rendering a horizontal candidate window, because the space character is the best way to separate two adjacent strings on the same line.</span></span></li>
</ol></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2aa8d-343"><a href="/windows/desktop/Intl/imn-closecandidate">IMN_CLOSECANDIDATE</a></span><span class="sxs-lookup"><span data-stu-id="2aa8d-343"><a href="/windows/desktop/Intl/imn-closecandidate">IMN_CLOSECANDIDATE</a></span></span></td>
<td><span data-ttu-id="2aa8d-344">Envoyé à l’application lorsqu’une fenêtre candidate est sur le moment de se fermer.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-344">Sent to the application when a candidate window is about to close.</span></span> <span data-ttu-id="2aa8d-345">Cela se produit lorsqu’un utilisateur a effectué une sélection à partir de la liste de candidats.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-345">This happens when a user has made a selection from the candidate list.</span></span> <span data-ttu-id="2aa8d-346">CDXUTIMEEditBox gère cette commande en affectant à l’indicateur visible de la fenêtre candidate la valeur FALSe, puis en effaçant la mémoire tampon de la chaîne candidate.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-346">CDXUTIMEEditBox handles this command by setting the visible flag of the candidate window to FALSE and then clearing the candidate string buffer.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2aa8d-347">IMN_PRIVATE</span><span class="sxs-lookup"><span data-stu-id="2aa8d-347">IMN_PRIVATE</span></span></td>
<td><span data-ttu-id="2aa8d-348">Envoyé à l’application lorsque l’IME a mis à jour sa chaîne de lecture suite à la saisie ou à la suppression de caractères par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-348">Sent to the application when the IME has updated its reading string as a result of the user typing or removing characters.</span></span> <span data-ttu-id="2aa8d-349">L’application doit récupérer la chaîne de lecture et l’enregistrer pour le rendu.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-349">The application should retrieve the reading string and save it for rendering.</span></span> <span data-ttu-id="2aa8d-350">CDXUTIMEEditBox a deux méthodes pour récupérer la chaîne de lecture, en fonction de la façon dont les chaînes de lecture sont prises en charge dans l’IME :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-350">CDXUTIMEEditBox has two methods to retrieve the reading string, based upon how reading strings are supported in the IME:</span></span> <br/>
<ul>
<li><span data-ttu-id="2aa8d-351">Si l’IME prend en charge la fonction GetReadingString, GetReadingString est appelé pour extraire la chaîne de lecture.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-351">If the IME supports the GetReadingString function, GetReadingString is called to retrieve the reading string.</span></span></li>
<li><span data-ttu-id="2aa8d-352">Si l’IME n’implémente pas GetReadingString, CDXUTIMEEditBox récupère la chaîne de lecture à partir du contenu du contexte d’entrée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-352">If the IME does not implement GetReadingString, CDXUTIMEEditBox retrieves the reading string from the input context content.</span></span></li>
</ul></td>
</tr>
</tbody>
</table>



 

## <a name="rendering"></a><span data-ttu-id="2aa8d-353">Rendu</span><span class="sxs-lookup"><span data-stu-id="2aa8d-353">Rendering</span></span>

<span data-ttu-id="2aa8d-354">Le rendu des éléments IME et Windows est simple.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-354">Rendering of the IME elements and windows is straightforward.</span></span> <span data-ttu-id="2aa8d-355">CDXUTIMEEditBox permet à la classe de base de s’afficher en premier, car les fenêtres IME doivent apparaître au-dessus du contrôle d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-355">CDXUTIMEEditBox lets the base class render first because IME windows should appear on top of the edit control.</span></span> <span data-ttu-id="2aa8d-356">Une fois la zone d’édition de base rendue, CDXUTIMEEditBox vérifie l’indicateur de visibilité de chaque fenêtre IME (indicateur, composition, candidat et fenêtre de lecture) et dessine la fenêtre si elle doit être visible.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-356">After the base edit box is rendered, CDXUTIMEEditBox checks the visibility flag of each IME window (indicator, composition, candidate, and reading window) and draws the window if it should be visible.</span></span> <span data-ttu-id="2aa8d-357">Pour obtenir une description des différents types de fenêtre IME, voir comportement IME par défaut.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-357">See Default IME Behavior for descriptions of the different IME window types.</span></span>

### <a name="input-locale-indicator"></a><span data-ttu-id="2aa8d-358">Indicateur de paramètres régionaux d’entrée</span><span class="sxs-lookup"><span data-stu-id="2aa8d-358">Input Locale Indicator</span></span>

<span data-ttu-id="2aa8d-359">L’indicateur de paramètres régionaux d’entrée est restitué avant toute autre fenêtre IME, car il s’agit d’un élément qui est toujours affiché.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-359">The input locale indicator is rendered before any other IME windows because it is an element that is always displayed.</span></span> <span data-ttu-id="2aa8d-360">Elle doit donc apparaître sous d’autres fenêtres IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-360">It should therefore appear below other IME windows.</span></span> <span data-ttu-id="2aa8d-361">CDXUTIMEEditBox restitue l’indicateur en appelant la méthode RenderIndicator, dans laquelle la couleur de la police de l’indicateur est déterminée en examinant la variable statique imposed \_ qui reflète le mode de conversion IME actuel.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-361">CDXUTIMEEditBox renders the indicator by calling the RenderIndicator method, in which the indicator font color is determined by examining the s\_ImeState static variable, which reflects the current IME conversion mode.</span></span> <span data-ttu-id="2aa8d-362">Lorsque l’IME est activé et que la conversion native est active, la méthode utilise m \_ IndicatorImeColor comme couleur de l’indicateur.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-362">When the IME is enabled and native conversion is active, the method uses m\_IndicatorImeColor as the indicator color.</span></span> <span data-ttu-id="2aa8d-363">Si l’IME est désactivé ou est en mode de conversion non natif, m \_ IndicatorImeColor est utilisé pour dessiner le texte de l’indicateur.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-363">If the IME is disabled or is in non-native conversion mode, m\_IndicatorImeColor is used to draw the indicator text.</span></span> <span data-ttu-id="2aa8d-364">Par défaut, la fenêtre d’indicateur est dessinée à droite de la zone d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-364">By default, the indicator window itself is drawn to the right of the edit box.</span></span> <span data-ttu-id="2aa8d-365">Les applications peuvent modifier ce comportement en remplaçant la méthode RenderIndicator.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-365">Applications can change this behavior by overriding the RenderIndicator method.</span></span>

<span data-ttu-id="2aa8d-366">L’illustration suivante montre les différentes apparences d’un indicateur de paramètres régionaux d’entrée pour l’anglais, le japonais en mode de conversion alphanumérique et le japonais en mode de conversion natif :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-366">The following figure shows the different appearances of an input locale indicator for English, Japanese in alphanumeric conversion mode, and Japanese in native conversion mode:</span></span>

![apparences différentes d’un indicateur de paramètres régionaux d’entrée pour l’anglais et le japonais](images/ime-indicator.png)

### <a name="composition-window"></a><span data-ttu-id="2aa8d-368">Fenêtre de composition</span><span class="sxs-lookup"><span data-stu-id="2aa8d-368">Composition Window</span></span>

<span data-ttu-id="2aa8d-369">Le dessin de la fenêtre de composition est géré dans la méthode RenderComposition de CDXUTIMEEditBox.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-369">The drawing of the composition window is handled in the RenderComposition method of CDXUTIMEEditBox.</span></span> <span data-ttu-id="2aa8d-370">La fenêtre de composition flotte au-dessus de la zone d’édition.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-370">The composition window floats above the edit box.</span></span> <span data-ttu-id="2aa8d-371">Elle doit être dessinée à la position du curseur du contrôle d’édition sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-371">It should be drawn at the cursor position of the underlying edit control.</span></span> <span data-ttu-id="2aa8d-372">CDXUTIMEEditBox gère le rendu comme suit :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-372">CDXUTIMEEditBox handles the rendering as follows:</span></span>

1.  <span data-ttu-id="2aa8d-373">La chaîne de composition entière est dessinée à l’aide des couleurs de la chaîne de composition par défaut.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-373">The entire composition string is drawn using the default composition string colors.</span></span>
2.  <span data-ttu-id="2aa8d-374">Les caractères avec certains attributs spéciaux doivent être dessinés dans des couleurs différentes. par conséquent, CDXUTIMEEditBox examine les caractères de la chaîne de composition et inspecte l’attribut de chaîne.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-374">Characters with certain special attributes should be drawn in different colors, so CDXUTIMEEditBox reviews the characters of the composition string and inspects the string attribute.</span></span> <span data-ttu-id="2aa8d-375">Si l’attribut appelle des couleurs différentes, le caractère est à nouveau dessiné avec les couleurs appropriées.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-375">If the attribute calls for different colors, the character is drawn again with the appropriate colors.</span></span>
3.  <span data-ttu-id="2aa8d-376">Le curseur de la fenêtre de composition est dessiné pour terminer le rendu.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-376">The cursor of the composition window is drawn to complete the rendering.</span></span>

<span data-ttu-id="2aa8d-377">Le curseur doit clignoter pour les IME coréens, mais il ne doit pas être destiné à d’autres éditeurs IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-377">The cursor should blink for Korean IMEs, but it should not for other IMEs.</span></span> <span data-ttu-id="2aa8d-378">RenderComposition détermine si le curseur doit être visible en fonction des valeurs du minuteur lorsque l’IME coréen est utilisé.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-378">RenderComposition determines whether the cursor should be visible based upon timer values when the Korean IME is used.</span></span>

### <a name="reading-and-candidate-windows"></a><span data-ttu-id="2aa8d-379">Lecture et fenêtres candidates</span><span class="sxs-lookup"><span data-stu-id="2aa8d-379">Reading and Candidate Windows</span></span>

<span data-ttu-id="2aa8d-380">Les fenêtres de lecture et de candidat sont rendues par la même méthode CDXUTIMEEditBox, RenderCandidateReadingWindow.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-380">The reading and candidate windows are rendered by the same CDXUTIMEEditBox method, RenderCandidateReadingWindow.</span></span> <span data-ttu-id="2aa8d-381">Les deux fenêtres contiennent un tableau de chaînes pour la disposition verticale, ou une chaîne unique dans le cas d’une disposition horizontale.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-381">Both windows contain an array of strings for vertical layout, or a single string in the case of horizontal layout.</span></span> <span data-ttu-id="2aa8d-382">La majeure partie du code de RenderCandidateReadingWindow est utilisée pour positionner la fenêtre afin qu’aucune partie de la fenêtre ne se situe en dehors de la fenêtre de l’application et qu’elle soit découpée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-382">The bulk of the code in RenderCandidateReadingWindow is used to position the window so that no part of the window falls outside the application window and gets clipped.</span></span>

## <a name="limitations"></a><span data-ttu-id="2aa8d-383">Limites</span><span class="sxs-lookup"><span data-stu-id="2aa8d-383">Limitations</span></span>

<span data-ttu-id="2aa8d-384">Les éditeurs IME contiennent parfois des fonctionnalités avancées pour améliorer la facilité d’entrée de texte.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-384">IMEs sometimes contain advanced features to improve the ease of inputting text.</span></span> <span data-ttu-id="2aa8d-385">Voici quelques-unes des fonctionnalités des IME les plus récents.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-385">Some of the features found in newer IMEs are shown in the following figures.</span></span> <span data-ttu-id="2aa8d-386">Ces fonctionnalités avancées ne sont pas présentes dans DXUT.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-386">These advanced features are not present in DXUT.</span></span> <span data-ttu-id="2aa8d-387">L’implémentation de la prise en charge de ces fonctionnalités avancées peut être difficile, car aucune interface n’est définie pour obtenir les informations nécessaires à partir des éditeurs IME.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-387">Implementing support for these advanced features can be challenging because there is no interface defined to obtain the necessary information from the IMEs.</span></span>

<span data-ttu-id="2aa8d-388">IME chinois traditionnel avancé avec liste de candidats développée :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-388">Advanced Traditional Chinese IME with expanded candidate list:</span></span>

![IME chinois traditionnel avancé avec liste de candidats développée](images/ime-advanced1.png)

<span data-ttu-id="2aa8d-390">IME japonais avancé avec certaines entrées candidates qui contiennent du texte supplémentaire pour décrire leurs significations :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-390">Advanced Japanese IME with some candidate entries that contain additional text to describe their meanings:</span></span>

![IME japonais avancé avec certaines entrées candidates qui contiennent du texte supplémentaire pour décrire leurs significations](images/ime-advanced2.png)

<span data-ttu-id="2aa8d-392">IME coréen avancé qui comprend un système de reconnaissance de l’écriture manuscrite :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-392">Advanced Korean IME that includes a handwriting recognition system:</span></span>

![IME coréen avancé qui comprend un système de reconnaissance de l’écriture manuscrite](images/ime-advanced3.png)

## <a name="registry-information"></a><span data-ttu-id="2aa8d-394">Informations de Registre</span><span class="sxs-lookup"><span data-stu-id="2aa8d-394">Registry Information</span></span>

<span data-ttu-id="2aa8d-395">Les informations de Registre suivantes sont vérifiées pour déterminer l’orientation de la fenêtre de lecture, lorsque l’IME actuel est ancien CHT New Phonetic qui n’implémente pas GetReadingString ().</span><span class="sxs-lookup"><span data-stu-id="2aa8d-395">The following registry information is checked to determine the orientation of the reading window, when the current IME is older CHT New Phonetic that doesn't implement GetReadingString().</span></span>



| <span data-ttu-id="2aa8d-396">Clé</span><span class="sxs-lookup"><span data-stu-id="2aa8d-396">Key</span></span>                                                           | <span data-ttu-id="2aa8d-397">Valeur</span><span class="sxs-lookup"><span data-stu-id="2aa8d-397">Value</span></span>            |
|---------------------------------------------------------------|------------------|
| <span data-ttu-id="2aa8d-398">\\Logiciel HKCU \\ Microsoft \\ Windows \\ CurrentVersion \\ IME \_ Name</span><span class="sxs-lookup"><span data-stu-id="2aa8d-398">HKCU\\software\\microsoft\\windows\\currentversion\\IME\_Name</span></span> | <span data-ttu-id="2aa8d-399">mappage du clavier</span><span class="sxs-lookup"><span data-stu-id="2aa8d-399">keyboard mapping</span></span> |



 

<span data-ttu-id="2aa8d-400">Où : \_ le nom IME est MSTCIPH si la version du fichier IME est 5,1 ou ultérieure ; sinon, le nom de l’IME \_ est tintlgnt.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-400">Where: IME\_Name is MSTCIPH if the IME file version is 5.1 or later; otherwise IME\_Name is TINTLGNT.</span></span>

<span data-ttu-id="2aa8d-401">L’orientation de la fenêtre de lecture est horizontale dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-401">The orientation of reading window is horizontal if either:</span></span>

-   <span data-ttu-id="2aa8d-402">L’IME est version 5,0 et la valeur de mappage du clavier est 0X22 ou 0x23</span><span class="sxs-lookup"><span data-stu-id="2aa8d-402">The IME is version 5.0 and keyboard mapping value is 0x22 or 0x23</span></span>
-   <span data-ttu-id="2aa8d-403">L’IME est version 5,1 ou version 5,2 et la valeur de mappage du clavier est 0X22, 0x23 ou 0x24.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-403">The IME is version 5.1 or version 5.2 and keyboard mapping value is 0x22, 0x23 or 0x24.</span></span>

<span data-ttu-id="2aa8d-404">Si aucune condition n’est remplie, la fenêtre de lecture est verticale.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-404">If neither condition is met, the reading window is vertical.</span></span>

## <a name="appendix-a-cht-versions-per-operating-system"></a><span data-ttu-id="2aa8d-405">Annexe A : versions CHT par système d’exploitation</span><span class="sxs-lookup"><span data-stu-id="2aa8d-405">Appendix A: CHT Versions per Operating System</span></span>



| <span data-ttu-id="2aa8d-406">Système d’exploitation</span><span class="sxs-lookup"><span data-stu-id="2aa8d-406">Operating System</span></span>           | <span data-ttu-id="2aa8d-407">Version de l’IME CHT</span><span class="sxs-lookup"><span data-stu-id="2aa8d-407">CHT IME Version</span></span> |
|----------------------------|-----------------|
| <span data-ttu-id="2aa8d-408">Windows 98</span><span class="sxs-lookup"><span data-stu-id="2aa8d-408">Windows 98</span></span>                 | <span data-ttu-id="2aa8d-409">4,2</span><span class="sxs-lookup"><span data-stu-id="2aa8d-409">4.2</span></span>             |
| <span data-ttu-id="2aa8d-410">Windows 2000</span><span class="sxs-lookup"><span data-stu-id="2aa8d-410">Windows 2000</span></span>               | <span data-ttu-id="2aa8d-411">4.3</span><span class="sxs-lookup"><span data-stu-id="2aa8d-411">4.3</span></span>             |
| <span data-ttu-id="2aa8d-412">unknown</span><span class="sxs-lookup"><span data-stu-id="2aa8d-412">unknown</span></span>                    | <span data-ttu-id="2aa8d-413">4.4</span><span class="sxs-lookup"><span data-stu-id="2aa8d-413">4.4</span></span>             |
| <span data-ttu-id="2aa8d-414">Windows ME</span><span class="sxs-lookup"><span data-stu-id="2aa8d-414">Windows ME</span></span>                 | <span data-ttu-id="2aa8d-415">5.0</span><span class="sxs-lookup"><span data-stu-id="2aa8d-415">5.0</span></span>             |
| <span data-ttu-id="2aa8d-416">Office XP</span><span class="sxs-lookup"><span data-stu-id="2aa8d-416">Office XP</span></span>                  | <span data-ttu-id="2aa8d-417">5,1</span><span class="sxs-lookup"><span data-stu-id="2aa8d-417">5.1</span></span>             |
| <span data-ttu-id="2aa8d-418">Windows XP</span><span class="sxs-lookup"><span data-stu-id="2aa8d-418">Windows XP</span></span>                 | <span data-ttu-id="2aa8d-419">5.2</span><span class="sxs-lookup"><span data-stu-id="2aa8d-419">5.2</span></span>             |
| <span data-ttu-id="2aa8d-420">Downloadble Web autonome</span><span class="sxs-lookup"><span data-stu-id="2aa8d-420">Standalone web downloadble</span></span> | <span data-ttu-id="2aa8d-421">6.0</span><span class="sxs-lookup"><span data-stu-id="2aa8d-421">6.0</span></span>             |



 

## <a name="further-information"></a><span data-ttu-id="2aa8d-422">Informations complémentaires</span><span class="sxs-lookup"><span data-stu-id="2aa8d-422">Further Information</span></span>

<span data-ttu-id="2aa8d-423">Pour plus d'informations, reportez-vous aux procédures suivantes :</span><span class="sxs-lookup"><span data-stu-id="2aa8d-423">For additional information, see the following:</span></span>

-   [<span data-ttu-id="2aa8d-424">Installation et utilisation des éditeurs de méthode d’entrée</span><span class="sxs-lookup"><span data-stu-id="2aa8d-424">Installing and Using Input Method Editors</span></span>](/windows/desktop/DxTechArts/installing-and-using-input-method-editors)
-   [<span data-ttu-id="2aa8d-425">Affichage de texte international</span><span class="sxs-lookup"><span data-stu-id="2aa8d-425">International Text Display</span></span>](/windows/desktop/Intl/creating-your-own-format-selection-user-interface)
-   [<span data-ttu-id="2aa8d-426">Le consortium Unicode</span><span class="sxs-lookup"><span data-stu-id="2aa8d-426">The Unicode Consortium</span></span>](https://www.unicode.org/)
-   <span data-ttu-id="2aa8d-427">Développement de logiciels internationaux.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-427">Developing International Software.</span></span> <span data-ttu-id="2aa8d-428">Dr. international.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-428">Dr. International.</span></span> <span data-ttu-id="2aa8d-429">2e ed.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-429">2nd ed.</span></span> <span data-ttu-id="2aa8d-430">Redmond, WA : Microsoft Press, 2003.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-430">Redmond, WA: Microsoft Press, 2003.</span></span>

## <a name="getreadingstring"></a><span data-ttu-id="2aa8d-431">GetReadingString</span><span class="sxs-lookup"><span data-stu-id="2aa8d-431">GetReadingString</span></span>

<span data-ttu-id="2aa8d-432">Obtient les informations de chaîne de lecture.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-432">Gets reading string information.</span></span>

<span data-ttu-id="2aa8d-433">**Paramètres**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-433">**Parameters**</span></span>

<dl> <dt>

<span data-ttu-id="2aa8d-434"><span id="himc_"></span><span id="HIMC_"></span>*himc*</span><span class="sxs-lookup"><span data-stu-id="2aa8d-434"><span id="himc_"></span><span id="HIMC_"></span>*himc*</span></span> 
</dt> <dd>

<span data-ttu-id="2aa8d-435">\[dans le \] contexte d’entrée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-435">\[in\] Input context.</span></span>

</dd> <dt>

<span data-ttu-id="2aa8d-436"><span id="uReadingBufLen"></span><span id="ureadingbuflen"></span><span id="UREADINGBUFLEN"></span>*uReadingBufLen*</span><span class="sxs-lookup"><span data-stu-id="2aa8d-436"><span id="uReadingBufLen"></span><span id="ureadingbuflen"></span><span id="UREADINGBUFLEN"></span>*uReadingBufLen*</span></span>
</dt> <dd>

<span data-ttu-id="2aa8d-437">\[dans la \] longueur de lpwReadingBuf, dans WCHAR.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-437">\[in\] Length of lpwReadingBuf, in WCHAR.</span></span> <span data-ttu-id="2aa8d-438">Si la valeur est zéro, cela signifie que la longueur de la mémoire tampon de lecture des requêtes.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-438">If it is zero, it means query reading buffer length.</span></span>

</dd> <dt>

<span data-ttu-id="2aa8d-439"><span id="lpwReadingBuf_"></span><span id="lpwreadingbuf_"></span><span id="LPWREADINGBUF_"></span>*lpwReadingBuf*</span><span class="sxs-lookup"><span data-stu-id="2aa8d-439"><span id="lpwReadingBuf_"></span><span id="lpwreadingbuf_"></span><span id="LPWREADINGBUF_"></span>*lpwReadingBuf*</span></span> 
</dt> <dd>

<span data-ttu-id="2aa8d-440">\[sortie \] de la lecture de la chaîne de retour (pas de fin nulle).</span><span class="sxs-lookup"><span data-stu-id="2aa8d-440">\[out\] Return reading string (not zero end).</span></span>

</dd> <dt>

<span data-ttu-id="2aa8d-441"><span id="pnErrorIndex_"></span><span id="pnerrorindex_"></span><span id="PNERRORINDEX_"></span>*pnErrorIndex*</span><span class="sxs-lookup"><span data-stu-id="2aa8d-441"><span id="pnErrorIndex_"></span><span id="pnerrorindex_"></span><span id="PNERRORINDEX_"></span>*pnErrorIndex*</span></span> 
</dt> <dd>

<span data-ttu-id="2aa8d-442">\[out \] de retour de l’index du caractère d’erreur dans la chaîne de lecture.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-442">\[out\] Return index of error character in the reading string if there is.</span></span>

</dd> <dt>

<span data-ttu-id="2aa8d-443"><span id="pfIsVertical_"></span><span id="pfisvertical_"></span><span id="PFISVERTICAL_"></span>*pfIsVertical*</span><span class="sxs-lookup"><span data-stu-id="2aa8d-443"><span id="pfIsVertical_"></span><span id="pfisvertical_"></span><span id="PFISVERTICAL_"></span>*pfIsVertical*</span></span> 
</dt> <dd>

<span data-ttu-id="2aa8d-444">\[\]si la valeur est true, la lecture de l’interface utilisateur est verticale.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-444">\[out\] If it is TRUE, reading UI is vertical.</span></span> <span data-ttu-id="2aa8d-445">Sinon, puMaxReadingLen horizontal.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-445">Otherwise, horizontal puMaxReadingLen.</span></span>

</dd> <dt>

<span data-ttu-id="2aa8d-446"><span id="puMaxReadingLen_"></span><span id="pumaxreadinglen_"></span><span id="PUMAXREADINGLEN_"></span>*puMaxReadingLen*</span><span class="sxs-lookup"><span data-stu-id="2aa8d-446"><span id="puMaxReadingLen_"></span><span id="pumaxreadinglen_"></span><span id="PUMAXREADINGLEN_"></span>*puMaxReadingLen*</span></span> 
</dt> <dd>

<span data-ttu-id="2aa8d-447">\[\]longueur de l’interface utilisateur de lecture.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-447">\[out\] The reading UI length.</span></span> <span data-ttu-id="2aa8d-448">La longueur maximale de lecture n’est pas fixe ; Cela dépend non seulement de la disposition du clavier, mais également du mode d’entrée (par exemple, le code interne, l’entrée de substitution).</span><span class="sxs-lookup"><span data-stu-id="2aa8d-448">The max reading length is not fixed; it depends not only on keyboard layout, but also on input mode (for example, internal code, surrogate input).</span></span>

</dd> </dl>

<span data-ttu-id="2aa8d-449">**Valeurs de retour**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-449">**Return Values**</span></span>

<span data-ttu-id="2aa8d-450">Longueur de la chaîne de lecture.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-450">The reading string length.</span></span>

<span data-ttu-id="2aa8d-451">**Remarques**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-451">**Remarks**</span></span>

<span data-ttu-id="2aa8d-452">Si la valeur de retour est supérieure à la valeur de uReadingBufLen, tous les paramètres de sortie ne sont pas définis.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-452">If the return value is greater than the value of uReadingBufLen, then all output parameters are undefined.</span></span>

<span data-ttu-id="2aa8d-453">Cette fonction est implémentée dans l’IME CHT 6,0 ou version ultérieure et peut être acquise par GetProcAddress sur un handle de module IME. le descripteur du module IME peut être obtenu par ImmGetIMEFileName et LoadLibrary.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-453">This function is implemented in CHT IME 6.0 or later, and can be acquired by GetProcAddress on an IME module handle; the IME module handle can be acquired by ImmGetIMEFileName and LoadLibrary.</span></span>

<span data-ttu-id="2aa8d-454">**Configuration requise**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-454">**Requirements**</span></span>

<dl> <dt>

<span data-ttu-id="2aa8d-455"><span id="Header"></span><span id="header"></span><span id="HEADER"></span>**Titre**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-455"><span id="Header"></span><span id="header"></span><span id="HEADER"></span>**Header**</span></span>
</dt> <dd>

<span data-ttu-id="2aa8d-456">Déclaré dans IMM. h.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-456">Declared in Imm.h.</span></span>

</dd> <dt>

<span data-ttu-id="2aa8d-457"><span id="Import_Library"></span><span id="import_library"></span><span id="IMPORT_LIBRARY"></span>**Importer la bibliothèque**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-457"><span id="Import_Library"></span><span id="import_library"></span><span id="IMPORT_LIBRARY"></span>**Import Library**</span></span>
</dt> <dd>

<span data-ttu-id="2aa8d-458">Utilisez IMM. lib.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-458">Use Imm.lib.</span></span>

</dd> </dl>

## <a name="showreadingwindow"></a><span data-ttu-id="2aa8d-459">ShowReadingWindow</span><span class="sxs-lookup"><span data-stu-id="2aa8d-459">ShowReadingWindow</span></span>

<span data-ttu-id="2aa8d-460">Affichez (ou masquez) la fenêtre de lecture.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-460">Show (or hide) the reading window.</span></span>

<span data-ttu-id="2aa8d-461">**Paramètres**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-461">**Parameters**</span></span>

<dl> <dt>

<span data-ttu-id="2aa8d-462"><span id="himc_"></span><span id="HIMC_"></span>*himc*</span><span class="sxs-lookup"><span data-stu-id="2aa8d-462"><span id="himc_"></span><span id="HIMC_"></span>*himc*</span></span> 
</dt> <dd>

<span data-ttu-id="2aa8d-463">\[dans le \] contexte d’entrée.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-463">\[in\] Input context.</span></span>

</dd> <dt>

<span data-ttu-id="2aa8d-464"><span id="bShow_"></span><span id="bshow_"></span><span id="BSHOW_"></span>*bShow*</span><span class="sxs-lookup"><span data-stu-id="2aa8d-464"><span id="bShow_"></span><span id="bshow_"></span><span id="BSHOW_"></span>*bShow*</span></span> 
</dt> <dd>

<span data-ttu-id="2aa8d-465">\[dans \] la propriété définie sur true pour afficher la fenêtre de lecture (ou false pour la masquer).</span><span class="sxs-lookup"><span data-stu-id="2aa8d-465">\[in\] Set to TRUE to show the reading window (or FALSE to hide it).</span></span>

</dd> </dl>

<span data-ttu-id="2aa8d-466">**Valeurs de retour**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-466">**Return Values**</span></span>

<span data-ttu-id="2aa8d-467">**Remarques**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-467">**Remarks**</span></span>

<span data-ttu-id="2aa8d-468">Retourne la valeur TRUE en cas de réussite ou FALSe dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-468">Return TRUE if successful or FALSE if otherwise.</span></span>

<span data-ttu-id="2aa8d-469">**Configuration requise**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-469">**Requirements**</span></span>

<dl> <dt>

<span data-ttu-id="2aa8d-470"><span id="Header"></span><span id="header"></span><span id="HEADER"></span>**Titre**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-470"><span id="Header"></span><span id="header"></span><span id="HEADER"></span>**Header**</span></span>
</dt> <dd>

<span data-ttu-id="2aa8d-471">Déclaré dans IMM. h.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-471">Declared in Imm.h.</span></span>

</dd> <dt>

<span data-ttu-id="2aa8d-472"><span id="Import_Library"></span><span id="import_library"></span><span id="IMPORT_LIBRARY"></span>**Importer la bibliothèque**</span><span class="sxs-lookup"><span data-stu-id="2aa8d-472"><span id="Import_Library"></span><span id="import_library"></span><span id="IMPORT_LIBRARY"></span>**Import Library**</span></span>
</dt> <dd>

<span data-ttu-id="2aa8d-473">Utilisez IMM. lib.</span><span class="sxs-lookup"><span data-stu-id="2aa8d-473">Use Imm.lib.</span></span>

</dd> </dl>