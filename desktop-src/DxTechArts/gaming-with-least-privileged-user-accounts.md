---
title: Jeux avec Least-Privileged comptes d’utilisateur
description: Cet article explique comment les développeurs de jeux peuvent créer des jeux Microsoft Windows qui fonctionnent bien avec les comptes d’utilisateur dotés de privilèges minimum (également appelés comptes d’utilisateur limité).
ms.assetid: 1b7cc3c9-b180-14b1-53c8-57f9e545d009
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4c44d94345462fc02ec649c5674ed88c38c12ee
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104463422"
---
# <a name="gaming-with-least-privileged-user-accounts"></a><span data-ttu-id="ad7af-103">Jeux avec Least-Privileged comptes d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="ad7af-103">Gaming with Least-Privileged User Accounts</span></span>

<span data-ttu-id="ad7af-104">Cet article explique comment les développeurs de jeux peuvent créer des jeux Microsoft Windows qui fonctionnent bien avec les comptes d’utilisateur dotés de privilèges minimum (également appelés comptes d’utilisateur limité).</span><span class="sxs-lookup"><span data-stu-id="ad7af-104">This article describes how games developers can author Microsoft Windows games that work well with least-privileged user accounts (also known as limited-user accounts).</span></span>

-   [<span data-ttu-id="ad7af-105">Introduction</span><span class="sxs-lookup"><span data-stu-id="ad7af-105">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="ad7af-106">Accès aux fichiers pour les comptes d’utilisateurs Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="ad7af-106">File Access for Least-Privileged User Accounts</span></span>](#file-access-for-least-privileged-user-accounts)
    -   [<span data-ttu-id="ad7af-107">Scénario 1 : fichiers qui ne doivent pas être affichés ou modifiés par les utilisateurs</span><span class="sxs-lookup"><span data-stu-id="ad7af-107">Scenario 1: Files that do not need to be viewed or altered by users</span></span>](#scenario-1-files-that-do-not-need-to-be-viewed-or-altered-by-users)
    -   [<span data-ttu-id="ad7af-108">Scénario 2 : fichiers qui doivent être affichés ou modifiés par les utilisateurs</span><span class="sxs-lookup"><span data-stu-id="ad7af-108">Scenario 2: Files that need to be viewed or altered by users</span></span>](#scenario-2-files-that-need-to-be-viewed-or-altered-by-users)
-   [<span data-ttu-id="ad7af-109">Accès au registre pour les comptes d’utilisateurs Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="ad7af-109">Registry Access for Least-Privileged User Accounts</span></span>](#registry-access-for-least-privileged-user-accounts)
-   [<span data-ttu-id="ad7af-110">Mise à jour corrective avec les comptes d’utilisateur Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="ad7af-110">Patching with Least-Privileged User Accounts</span></span>](#patching-with-least-privileged-user-accounts)

## <a name="introduction"></a><span data-ttu-id="ad7af-111">Introduction</span><span class="sxs-lookup"><span data-stu-id="ad7af-111">Introduction</span></span>

<span data-ttu-id="ad7af-112">Windows gère ses utilisateurs avec des comptes.</span><span class="sxs-lookup"><span data-stu-id="ad7af-112">Windows manages its users with accounts.</span></span> <span data-ttu-id="ad7af-113">Aujourd’hui, plus de 80% des utilisateurs de l’ordinateur chez eux partagent leur ordinateur avec d’autres membres de la famille.</span><span class="sxs-lookup"><span data-stu-id="ad7af-113">Today, more than eighty percent of computer users at home share their computer with other family members.</span></span> <span data-ttu-id="ad7af-114">Lorsque plusieurs utilisateurs partagent un ordinateur Windows, plusieurs comptes d’utilisateur sont créés et chaque utilisateur se connecte avec un compte individuel pour accéder à l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="ad7af-114">When multiple users share a Windows computer, multiple user accounts are created, and each user logs in with an individual account to access the computer.</span></span> <span data-ttu-id="ad7af-115">Avec la sensibilisation accrue à la sécurité, de plus en plus de personnes exploitent leurs ordinateurs avec des comptes d’utilisateur dotés de privilèges minimum, également appelés comptes d’utilisateurs limités, qui n’ont pas un contrôle total sur le système.</span><span class="sxs-lookup"><span data-stu-id="ad7af-115">With the increasing awareness for security, more people operate their computers with least-privileged user accounts, also known as limited-user accounts, which do not have complete control over the system.</span></span> <span data-ttu-id="ad7af-116">Les comptes d’administrateur ont généralement un accès illimité à chaque partie de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="ad7af-116">Administrator accounts typically have unrestricted access to every part of the computer.</span></span> <span data-ttu-id="ad7af-117">Cela peut affecter le fonctionnement des jeux basés sur Windows.</span><span class="sxs-lookup"><span data-stu-id="ad7af-117">This can affect how Windows-based games work.</span></span>

<span data-ttu-id="ad7af-118">Il existe des avantages supplémentaires pour les développeurs de jeux qui écrivent leurs jeux pour travailler avec des comptes d’utilisateur dotés de privilèges minimum.</span><span class="sxs-lookup"><span data-stu-id="ad7af-118">There are additional benefits for games developers who write their games to work with least-privileged user accounts.</span></span> <span data-ttu-id="ad7af-119">Dans Windows Vista et versions ultérieures, les comptes d’utilisateur dotés de privilèges minimum sont appliqués, ce qui signifie que chaque compte sur le système, à l’exception de l’administrateur local, est un compte d’utilisateur doté de privilèges minimum.</span><span class="sxs-lookup"><span data-stu-id="ad7af-119">In Windows Vista and later, least-privileged user accounts are enforced, which means that every account on the system, with the exception of the local administrator, is a least-privileged user account.</span></span> <span data-ttu-id="ad7af-120">Cela aura une incidence sur la façon dont les jeux qui ne suivent pas les instructions (applications héritées) s’exécutent sur Windows Vista et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="ad7af-120">This will affect how games that do not follow the guideline (legacy applications) run on Windows Vista and later.</span></span> <span data-ttu-id="ad7af-121">Par exemple, lorsqu’une application tente d’écrire dans un dossier ou une valeur de Registre pour laquelle elle n’a pas d’autorisation, l’écriture de fichier est redirigée vers un magasin de fichiers virtuel pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ad7af-121">For instance, when an application attempts to write to a folder or a registry value to which it does not have permission, the file write is redirected to a virtual file store for the user.</span></span> <span data-ttu-id="ad7af-122">Ce magasin de fichiers virtuel réside dans un dossier pour lequel l’utilisateur dispose d’un accès en écriture.</span><span class="sxs-lookup"><span data-stu-id="ad7af-122">This virtual file store will reside in a folder to which the user has write access.</span></span> <span data-ttu-id="ad7af-123">Ce comportement peut ne pas sembler catastrophique en cas d’échec de la tentative d’écriture. Toutefois, les applications qui créent des fichiers virtualisés peuvent dérouter les utilisateurs, car les fichiers ne seront pas écrits à l’emplacement attendu par les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ad7af-123">This behavior may not seem as catastrophic as outright failing the write attempt; however, applications that create virtualized files may confuse users because files will not be written to the location users expect.</span></span> <span data-ttu-id="ad7af-124">Par exemple, les jeux qui écrivent des fichiers de score élevé dans le même dossier que le dossier exécutable écrira ces fichiers dans un dossier virtualisé à la place.</span><span class="sxs-lookup"><span data-stu-id="ad7af-124">For instance, games that write high score files to the same folder as the executable folder will write these files to a virtualized folder instead.</span></span> <span data-ttu-id="ad7af-125">Par conséquent, un utilisateur ne peut pas voir le score élevé atteint par un autre utilisateur, car chaque utilisateur dispose d’un magasin de fichiers virtualisé distinct.</span><span class="sxs-lookup"><span data-stu-id="ad7af-125">Consequently, one user cannot see the high score achieved by another user because every user has a separate virtualized file store.</span></span>

<span data-ttu-id="ad7af-126">Les jeux qui suivent les instructions de cet article s’exécutent avec des comptes d’utilisateur dotés de privilèges minimum et, par conséquent, assurent la compatibilité avec Windows Vista et les versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="ad7af-126">Games that follow the guidelines in this article will run with least-privileged user accounts, and consequently will maintain compatibility with Windows Vista and later.</span></span>

## <a name="file-access-for-least-privileged-user-accounts"></a><span data-ttu-id="ad7af-127">Accès aux fichiers pour les comptes d’utilisateurs Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="ad7af-127">File Access for Least-Privileged User Accounts</span></span>

<span data-ttu-id="ad7af-128">Windows prend en charge deux systèmes de fichiers : FAT32 et NTFS.</span><span class="sxs-lookup"><span data-stu-id="ad7af-128">Windows supports two file systems: FAT32 and NTFS.</span></span> <span data-ttu-id="ad7af-129">FAT32 est un système de fichiers hérité pris en charge uniquement pour la compatibilité descendante. NTFS prend en charge des autorisations de fichiers plus puissantes et robustes.</span><span class="sxs-lookup"><span data-stu-id="ad7af-129">FAT32 is a legacy file system supported only for backward compatibility; NTFS supports more powerful and robust file permissions.</span></span> <span data-ttu-id="ad7af-130">L’utilisation du système de fichiers NTFS s’étend au fur et à mesure que les détaillants expédient de nouveaux ordinateurs sur lesquels Windows est préinstallé sur un disque dur partitionné NTFS.</span><span class="sxs-lookup"><span data-stu-id="ad7af-130">The use of NTFS is expanding as retailers are shipping new computers with Windows pre-installed on a NTFS-partitioned hard drive.</span></span> <span data-ttu-id="ad7af-131">Sur un système Windows XP NTFS, les utilisateurs disposant de comptes d’utilisateur dotés de privilèges minimum disposent uniquement d’un accès limité à plusieurs dossiers.</span><span class="sxs-lookup"><span data-stu-id="ad7af-131">On an NTFS-based Windows XP system, users with least-privileged user accounts have only limited access to several folders.</span></span> <span data-ttu-id="ad7af-132">Toutefois, ils disposent d’un accès complet sur un système Windows XP basé sur FAT32.</span><span class="sxs-lookup"><span data-stu-id="ad7af-132">However, they would have complete access on a FAT32-based Windows XP system.</span></span>

<span data-ttu-id="ad7af-133">Le tableau suivant répertorie l’emplacement par défaut de ces dossiers et leurs autorisations.</span><span class="sxs-lookup"><span data-stu-id="ad7af-133">The following table lists the default location of these folders and their permissions.</span></span>



| <span data-ttu-id="ad7af-134">Chemin d’accès</span><span class="sxs-lookup"><span data-stu-id="ad7af-134">Path</span></span>                                               | <span data-ttu-id="ad7af-135">Contenu du dossier</span><span class="sxs-lookup"><span data-stu-id="ad7af-135">Folder Contents</span></span>              | <span data-ttu-id="ad7af-136">Lire</span><span class="sxs-lookup"><span data-stu-id="ad7af-136">Read</span></span> | <span data-ttu-id="ad7af-137">Write</span><span class="sxs-lookup"><span data-stu-id="ad7af-137">Write</span></span> | <span data-ttu-id="ad7af-138">Créer/Supprimer</span><span class="sxs-lookup"><span data-stu-id="ad7af-138">Create/Delete</span></span> |
|----------------------------------------------------|------------------------------|------|-------|---------------|
| <span data-ttu-id="ad7af-139"><Drive>: \\ Windows</span><span class="sxs-lookup"><span data-stu-id="ad7af-139"><Drive>:\\Windows</span></span>                            | <span data-ttu-id="ad7af-140">Le système d’exploitation Windows</span><span class="sxs-lookup"><span data-stu-id="ad7af-140">The Windows operating system</span></span> | <span data-ttu-id="ad7af-141">X</span><span class="sxs-lookup"><span data-stu-id="ad7af-141">X</span></span>    |       |               |
| <span data-ttu-id="ad7af-142"><Drive>: \\ Program Files</span><span class="sxs-lookup"><span data-stu-id="ad7af-142"><Drive>:\\Program Files</span></span>                      | <span data-ttu-id="ad7af-143">Fichiers d’application exécutables</span><span class="sxs-lookup"><span data-stu-id="ad7af-143">Executable application files</span></span> | <span data-ttu-id="ad7af-144">X</span><span class="sxs-lookup"><span data-stu-id="ad7af-144">X</span></span>    |       |               |
| <span data-ttu-id="ad7af-145"><Drive>: \\ Documents and Settings \\ nom d’utilisateur\*</span><span class="sxs-lookup"><span data-stu-id="ad7af-145"><Drive>:\\Documents and Settings\\Username\*</span></span> | <span data-ttu-id="ad7af-146">Fichiers de chaque utilisateur</span><span class="sxs-lookup"><span data-stu-id="ad7af-146">Each user's files</span></span>            | <span data-ttu-id="ad7af-147">X</span><span class="sxs-lookup"><span data-stu-id="ad7af-147">X</span></span>    | <span data-ttu-id="ad7af-148">X</span><span class="sxs-lookup"><span data-stu-id="ad7af-148">X</span></span>     | <span data-ttu-id="ad7af-149">X</span><span class="sxs-lookup"><span data-stu-id="ad7af-149">X</span></span>             |
| <span data-ttu-id="ad7af-150"><Drive>: \\ Documents and Settings \\ All Users</span><span class="sxs-lookup"><span data-stu-id="ad7af-150"><Drive>:\\Documents and Settings\\All Users</span></span>  | <span data-ttu-id="ad7af-151">Tous les fichiers utilisateur</span><span class="sxs-lookup"><span data-stu-id="ad7af-151">All user files</span></span>               | <span data-ttu-id="ad7af-152">X</span><span class="sxs-lookup"><span data-stu-id="ad7af-152">X</span></span>    | <span data-ttu-id="ad7af-153">X</span><span class="sxs-lookup"><span data-stu-id="ad7af-153">X</span></span>     | <span data-ttu-id="ad7af-154">X</span><span class="sxs-lookup"><span data-stu-id="ad7af-154">X</span></span>             |



 

<span data-ttu-id="ad7af-155">\* Username est le nom de connexion de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ad7af-155">\* Username is the user's login name.</span></span>

<span data-ttu-id="ad7af-156">Dans un compte d’utilisateur doté de privilèges minimum, vous pouvez lire, écrire, créer et supprimer des fichiers dans l’un ou l’autre dossier : documents and Settings \\ username ou documents and Settings \\ All Users.</span><span class="sxs-lookup"><span data-stu-id="ad7af-156">In a least-privileged user account, you may read, write, create and delete files in either folder: Documents and Settings\\Username or Documents and Settings\\All Users.</span></span>

<span data-ttu-id="ad7af-157">Cela signifie que vous ne devez pas placer les jeux dans des \\ fichiers programme, mais qu’ils doivent être placés dans un sous-dossier dans \\ Mes documents.</span><span class="sxs-lookup"><span data-stu-id="ad7af-157">What this means is that you should not place save games in \\Program Files, instead they should go in a sub-folder in \\My Documents.</span></span> <span data-ttu-id="ad7af-158">En outre, vous ne devez pas placer les données d’application temporaires dans les \\ fichiers programme ou \\ Mes documents, mais vous devez les placer dans le dossier Application Data (CSIDL \_ local \_ AppData).</span><span class="sxs-lookup"><span data-stu-id="ad7af-158">Also you should not place temporary application data in \\Program Files or \\My Documents, instead it should be placed in Application Data folder (CSIDL\_LOCAL\_APPDATA).</span></span>

<span data-ttu-id="ad7af-159">Plus précisément, il existe deux scénarios que chaque jeu doit gérer :</span><span class="sxs-lookup"><span data-stu-id="ad7af-159">More specifically, there are two scenarios that each game should handle:</span></span>

### <a name="scenario-1-files-that-do-not-need-to-be-viewed-or-altered-by-users"></a><span data-ttu-id="ad7af-160">Scénario 1 : fichiers qui ne doivent pas être affichés ou modifiés par les utilisateurs</span><span class="sxs-lookup"><span data-stu-id="ad7af-160">Scenario 1: Files that do not need to be viewed or altered by users</span></span>

<span data-ttu-id="ad7af-161">Un exemple typique est le fichier de configuration, les fichiers temporaires et les fichiers de cache de jeu du jeu.</span><span class="sxs-lookup"><span data-stu-id="ad7af-161">A typical example would be the game's configuration file, temporary files, and game cache files.</span></span> <span data-ttu-id="ad7af-162">Ces fichiers sont généralement conservés dans le dossier Application Data.</span><span class="sxs-lookup"><span data-stu-id="ad7af-162">These files are typically kept in the Application Data folder.</span></span> <span data-ttu-id="ad7af-163">Pour obtenir ce chemin d’accès au dossier, appelez la fonction [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) avec CSIDL \_ AppData ou CSIDL \_ local \_ AppData comme indiqué dans l’exemple de code suivant.</span><span class="sxs-lookup"><span data-stu-id="ad7af-163">To obtain this folder path, call the [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) function with CSIDL\_APPDATA or CSIDL\_LOCAL\_APPDATA as shown in the following code example.</span></span>

``` syntax
#include <shlobj.h>
#include <strsafe.h>

#define APPNAME L"MyApp"

WCHAR wszPath[MAX_PATH];

// Local Application Data
SHGetFolderPath( hWnd, CSIDL_LOCAL_APPDATA, NULL, SHGFP_TYPE_CURRENT, wszPath );
StringCchCatW( wszPath, MAX_PATH, L"\\" );
StringCchCatW( wszPath, MAX_PATH, APPNAME );

// Create the folder wszPath
// Then create files in wszPath
// Roaming Application Data
SHGetFolderPath( hWnd, CSIDL_APPDATA, NULL, SHGFP_TYPE_CURRENT, wszPath );
StringCchCatW( wszPath, MAX_PATH, L"\\" );
StringCchCatW( wszPath, MAX_PATH, APPNAME );

// Create the folder wszPath
// Then create files in wszPath
```

<span data-ttu-id="ad7af-164">La différence entre les dossiers de données d’application locaux et itinérants réside dans le fait que sur Windows 2000 et Windows XP, le contenu itinérant est copié depuis et vers le serveur au cours du processus d’ouverture/de fermeture de session, contrairement au contenu local.</span><span class="sxs-lookup"><span data-stu-id="ad7af-164">The difference between local and roaming Application Data folders is that on Windows 2000 and Windows XP, roaming content is copied to and from the server during the logon/logoff process, while local content is not.</span></span> <span data-ttu-id="ad7af-165">Pour la plupart des jeux, les données d’application locales sont suffisantes.</span><span class="sxs-lookup"><span data-stu-id="ad7af-165">For most games, local Application Data is sufficient.</span></span>

### <a name="scenario-2-files-that-need-to-be-viewed-or-altered-by-users"></a><span data-ttu-id="ad7af-166">Scénario 2 : fichiers qui doivent être affichés ou modifiés par les utilisateurs</span><span class="sxs-lookup"><span data-stu-id="ad7af-166">Scenario 2: Files that need to be viewed or altered by users</span></span>

<span data-ttu-id="ad7af-167">Un exemple typique est un fichier de jeu enregistré par un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ad7af-167">A typical example would be a user's saved game files.</span></span> <span data-ttu-id="ad7af-168">Stockez les fichiers dans le dossier des documents de l’utilisateur afin qu’ils soient facilement visibles pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ad7af-168">Store the files in the user's document folder so that they are easily visible to the user.</span></span> <span data-ttu-id="ad7af-169">Une application obtient le chemin d’accès au dossier de documents de l’utilisateur en appelant [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) avec CSIDL \_ Personal, comme le montre l’exemple de code suivant :</span><span class="sxs-lookup"><span data-stu-id="ad7af-169">An application gets the user's document folder path by calling [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with CSIDL\_PERSONAL, as the following code example shows:</span></span>

``` syntax
#include <shlobj.h>
#include <strsafe.h>

#define APPNAME L"MyApp"

WCHAR wszPath[MAX_PATH];

SHGetFolderPath( hWnd, CSIDL_PERSONAL, NULL, SHGFP_TYPE_CURRENT, wszPath );
StringCchCatW( wszPath, MAX_PATH, L"\\" );
StringCchCatW( wszPath, MAX_PATH, APPNAME );

// Create the folder wszPath
// Then create files in wszPath
```

<span data-ttu-id="ad7af-170">Parfois, un jeu peut avoir besoin de stocker des fichiers que tous les utilisateurs sont censés voir et utiliser.</span><span class="sxs-lookup"><span data-stu-id="ad7af-170">At times, a game may need to store files that all users are meant to see and use.</span></span> <span data-ttu-id="ad7af-171">Par exemple, l’enregistrement de score élevé, où tous les utilisateurs écrivent dans le même fichier d’enregistrement afin que les scores élevés soient gérés à l’ensemble du système au lieu d’un score élevé distinct pour chaque utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ad7af-171">One example is the high score record, where all users write to the same record file so that high scores are maintained system-wide instead of a separate high score for each user.</span></span> <span data-ttu-id="ad7af-172">Voici d’autres exemples : cartes téléchargées, missions et modifications de jeux.</span><span class="sxs-lookup"><span data-stu-id="ad7af-172">Other examples are downloaded maps, missions, and game modifications.</span></span> <span data-ttu-id="ad7af-173">S’ils sont partagés, un seul utilisateur doit les télécharger au lieu de tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ad7af-173">If these are shared, then only one user has to download them instead of every user.</span></span> <span data-ttu-id="ad7af-174">Dans ce scénario, utilisez le dossier document sous le dossier profil partagé, comme illustré dans le code suivant.</span><span class="sxs-lookup"><span data-stu-id="ad7af-174">In this scenario, use the document folder under the shared profile folder, as demonstrated in the following code.</span></span>

``` syntax
#include <shlobj.h>
#include <strsafe.h>

#define APPNAME L"MyApp"

WCHAR wszPath[MAX_PATH];

SHGetFolderPath( hWnd, CSIDL_COMMON_DOCUMENTS, NULL, SHGFP_TYPE_CURRENT, wszPath );
StringCchCatW( wszPath, MAX_PATH, L"\\" );
StringCchCatW( wszPath, MAX_PATH, APPNAME );

// Create the folder wszPath
// Then create files in wszPath
```

## <a name="registry-access-for-least-privileged-user-accounts"></a><span data-ttu-id="ad7af-175">Accès au registre pour les comptes d’utilisateurs Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="ad7af-175">Registry Access for Least-Privileged User Accounts</span></span>

<span data-ttu-id="ad7af-176">Il est courant pour les applications d’utiliser le Registre Windows pour stocker des informations.</span><span class="sxs-lookup"><span data-stu-id="ad7af-176">It is common for applications to use the Windows registry to store information.</span></span> <span data-ttu-id="ad7af-177">Comme pour l’accès aux fichiers, les comptes d’utilisateur administrateur et avec privilèges minimum n’ont pas la même autorisation pour le registre.</span><span class="sxs-lookup"><span data-stu-id="ad7af-177">Similar to file access, administrator and least-privileged user accounts do not have the same permission to the registry.</span></span> <span data-ttu-id="ad7af-178">Pour les comptes d’utilisateur dotés de privilèges minimum, l’intégralité du nœud de l' \_ ordinateur local HKEY \_ est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="ad7af-178">For least-privileged user accounts, the entire HKEY\_LOCAL\_MACHINE node is read-only.</span></span> <span data-ttu-id="ad7af-179">Par exemple, un jeu peut lire les informations de configuration par défaut, mais il ne peut pas écrire de nouvelles informations sur ce nœud.</span><span class="sxs-lookup"><span data-stu-id="ad7af-179">For instance, a game can read the default configuration information, but may not write any new information to this node.</span></span> <span data-ttu-id="ad7af-180">Par conséquent, les jeux qui s’exécutent en mode utilisateur avec le moins de privilèges qui doivent écrire dans le registre doivent utiliser le nœud de l' \_ utilisateur HKEY actuel \_ pour stocker des informations par utilisateur, comme illustré dans le code suivant.</span><span class="sxs-lookup"><span data-stu-id="ad7af-180">Consequently, games running in least-privileged user mode that need to write to the registry will need to use the HKEY\_CURRENT\_USER node to store per-user information, as illustrated in the following code.</span></span>

``` syntax
#define APP_REGISTRY_KEY_PATH L"Software\\MyCompany\\MyApp"

LONG lRetVal;
HKEY hKey;

lRetVal = RegCreateKeyExW( HKEY_CURRENT_USER,
                           APP_REGISTRY_KEY_PATH,
                           0,
                           NULL,
                           REG_OPTION_NON_VOLATILE,
                           KEY_WRITE|KEY_READ,
                           NULL,
                           &hKey,
                           NULL );

if( ERROR_SUCCESS == lRetVal )
{
    // Store information in hKey
}
```

<span data-ttu-id="ad7af-181">Il est important de noter que lors de l’installation, les informations du Registre doivent être écrites sur HKEY \_ local \_ machine, et non sur HKEY \_ Current \_ User.</span><span class="sxs-lookup"><span data-stu-id="ad7af-181">It is worth noting that during installation, registry information should be written to HKEY\_LOCAL\_MACHINE, not HKEY\_CURRENT\_USER.</span></span> <span data-ttu-id="ad7af-182">Cela est dû au fait que la personne qui exécute l’installation est généralement un administrateur et peut ne pas être la seule personne à utiliser le programme.</span><span class="sxs-lookup"><span data-stu-id="ad7af-182">This is because the person running the installation is usually an administrator, and may not be the only person to use the program.</span></span> <span data-ttu-id="ad7af-183">Dans ce cas, l’écriture sur HKEY \_ Current \_ User rend les informations indisponibles pour les autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ad7af-183">In this situation, writing to HKEY\_CURRENT\_USER makes the information unavailable to other users.</span></span> <span data-ttu-id="ad7af-184">Ce n’est généralement pas un problème, car les informations écrites dans le registre au cours de l’installation sont les paramètres de configuration et par défaut qui s’appliquent à chaque utilisateur du programme.</span><span class="sxs-lookup"><span data-stu-id="ad7af-184">This is not usually an issue because the information written to the registry during installation is the configuration and default settings that apply to every user of the program.</span></span>

<span data-ttu-id="ad7af-185">Lors de la désinstallation du jeu, un effort supplémentaire est nécessaire pour supprimer toutes les valeurs que le jeu a écrites dans le registre.</span><span class="sxs-lookup"><span data-stu-id="ad7af-185">When uninstalling the game, extra effort is necessary to remove every value that the game has written to the registry.</span></span> <span data-ttu-id="ad7af-186">Étant donné que le désinstallateur est exécuté par une personne, généralement l’administrateur, il suffit de supprimer les informations pertinentes dans HKEY \_ local \_ machine et HKEY \_ Current \_ User ne supprimera pas les valeurs des autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ad7af-186">Because the uninstaller is run by one person, usually the administrator, simply deleting the relevant information in HKEY\_LOCAL\_MACHINE and HKEY\_CURRENT\_USER will not remove values for other users.</span></span> <span data-ttu-id="ad7af-187">Une façon de supprimer les informations par utilisateur dans le registre consiste à énumérer la racine de la \_ ruche de Registre HKEY Users.</span><span class="sxs-lookup"><span data-stu-id="ad7af-187">One way to remove the per-user information in the registry is to enumerate the HKEY\_USERS registry hive root.</span></span> <span data-ttu-id="ad7af-188">Chaque sous-clé sous HKEY \_ Users correspond à la ruche de l' \_ utilisateur actuel HKEY \_ pour un utilisateur particulier sur le système.</span><span class="sxs-lookup"><span data-stu-id="ad7af-188">Each subkey under HKEY\_USERS corresponds to the HKEY\_CURRENT\_USER hive for a particular user on the system.</span></span> <span data-ttu-id="ad7af-189">En énumérant HKEY \_ Users et en supprimant les informations spécifiques aux jeux sous chaque sous-clé, le désinstaller peut s’assurer qu’aucune information n’est conservée.</span><span class="sxs-lookup"><span data-stu-id="ad7af-189">By enumerating HKEY\_USERS and removing the game-specific information under each subkey, the uninstaller can ensure that no information is left behind.</span></span>

## <a name="patching-with-least-privileged-user-accounts"></a><span data-ttu-id="ad7af-190">Mise à jour corrective avec les comptes d’utilisateur Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="ad7af-190">Patching with Least-Privileged User Accounts</span></span>

<span data-ttu-id="ad7af-191">La mise à jour corrective d’un jeu implique la mise à jour des fichiers du jeu.</span><span class="sxs-lookup"><span data-stu-id="ad7af-191">Patching a game involves updating the game's files.</span></span> <span data-ttu-id="ad7af-192">Par conséquent, elle nécessite généralement un accès en écriture au dossier programme du jeu.</span><span class="sxs-lookup"><span data-stu-id="ad7af-192">Therefore, it usually requires write access to the game's program folder.</span></span> <span data-ttu-id="ad7af-193">La mise à jour corrective d’un jeu est un processus simple lorsqu’il est effectué par un administrateur, car il dispose d’un accès illimité au dossier du programme du jeu.</span><span class="sxs-lookup"><span data-stu-id="ad7af-193">Patching a game is a straightforward process when it is done by an administrator because they have unrestricted access to the game's program folder.</span></span> <span data-ttu-id="ad7af-194">À l’inverse, il a traditionnellement été difficile, voire impossible, pour un utilisateur doté de privilèges minimaux d’appliquer des correctifs à des jeux en raison de la restriction d’accès.</span><span class="sxs-lookup"><span data-stu-id="ad7af-194">Conversely, it has traditionally been difficult, if not impossible, for a least privileged user to patch games because of the access restriction.</span></span> <span data-ttu-id="ad7af-195">À présent, [Windows Installer](/windows/desktop/Msi/windows-installer-portal) a été amélioré pour rendre possible un correctif de compte d’utilisateur doté de privilèges minimum.</span><span class="sxs-lookup"><span data-stu-id="ad7af-195">Now, [Windows Installer](/windows/desktop/Msi/windows-installer-portal) has been enhanced to make least-privileged user account patching possible.</span></span> <span data-ttu-id="ad7af-196">Pour tirer parti de cette fonctionnalité, les jeux sont encouragés à utiliser Windows Installer pour l’installation et la mise à jour corrective.</span><span class="sxs-lookup"><span data-stu-id="ad7af-196">To take advantage of this feature, games are encouraged to utilize Windows Installer for installation and patching.</span></span>

<span data-ttu-id="ad7af-197">À compter de Windows Installer 3,0, les correctifs d’application peuvent être appliqués par les utilisateurs disposant de privilèges minimum lorsque certaines conditions sont remplies.</span><span class="sxs-lookup"><span data-stu-id="ad7af-197">Starting with Windows Installer 3.0, application patches can be applied by least privileged users when certain conditions are met.</span></span> <span data-ttu-id="ad7af-198">Ces conditions sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="ad7af-198">These conditions are:</span></span>

-   <span data-ttu-id="ad7af-199">L’application a été installée à l’aide de Windows Installer 3,0.</span><span class="sxs-lookup"><span data-stu-id="ad7af-199">The application was installed using Windows Installer 3.0.</span></span>
-   <span data-ttu-id="ad7af-200">L’application a été installée à l’origine par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="ad7af-200">The application was originally installed per-machine.</span></span>
-   <span data-ttu-id="ad7af-201">L’application est installée à partir d’un support amovible, tel qu’un CD-ROM ou un disque vidéo numérique (DVD).</span><span class="sxs-lookup"><span data-stu-id="ad7af-201">The application is installed from removable media, such a CD-ROM or digital video disc (DVD).</span></span>
-   <span data-ttu-id="ad7af-202">Les correctifs sont signés numériquement par un certificat identifié par le package d’installation d’origine (fichier. msi).</span><span class="sxs-lookup"><span data-stu-id="ad7af-202">The patches are digitally signed by a certificate that is identified by the original installer package (.msi file).</span></span>
-   <span data-ttu-id="ad7af-203">Les correctifs peuvent être validés par rapport à la signature numérique.</span><span class="sxs-lookup"><span data-stu-id="ad7af-203">The patches can be validated against the digital signature.</span></span>
-   <span data-ttu-id="ad7af-204">Le package d’installation d’origine n’a pas désactivé la mise à jour corrective des comptes d’utilisateur de moindre privilège.</span><span class="sxs-lookup"><span data-stu-id="ad7af-204">The original installer package has not disabled least-privileged user account patching.</span></span>
-   <span data-ttu-id="ad7af-205">L’administrateur système n’a pas désactivé la mise à jour corrective des comptes d’utilisateur avec des privilèges minimaux via la stratégie système.</span><span class="sxs-lookup"><span data-stu-id="ad7af-205">The system administrator has not disabled least-privileged user account patching via system policy.</span></span>

<span data-ttu-id="ad7af-206">En règle générale, un utilisateur doté de privilèges minimum ne peut pas modifier les fichiers programme d’un jeu.</span><span class="sxs-lookup"><span data-stu-id="ad7af-206">Normally, a least privileged user cannot modify a game's program files.</span></span> <span data-ttu-id="ad7af-207">Toutefois, lorsque les conditions ci-dessus sont remplies et que la mise à jour corrective LUA est activée, Windows Installer pouvez mettre à jour les fichiers du jeu afin que l’utilisateur puisse obtenir la dernière version.</span><span class="sxs-lookup"><span data-stu-id="ad7af-207">However, when the above conditions are met and LUA patching is enabled, Windows Installer can update the game's files so that the user gets the latest version.</span></span>

> [!Note]  
> <span data-ttu-id="ad7af-208">Les informations contenues dans cet article concernent le produit logiciel en version préliminaire, qui peut être sensiblement modifié avant sa première version commerciale.</span><span class="sxs-lookup"><span data-stu-id="ad7af-208">The information contained in this article relates to pre-release software product, which may be substantially modified before its first commercial release.</span></span> <span data-ttu-id="ad7af-209">En conséquence, les informations peuvent ne pas décrire ou refléter le produit logiciel lors de la première publication commercialisée.</span><span class="sxs-lookup"><span data-stu-id="ad7af-209">Accordingly, the information may not accurately describe or reflect the software product when first commercially released.</span></span> <span data-ttu-id="ad7af-210">Cet article est fourni à titre d’information uniquement et Microsoft exclut toute garantie, expresse ou implicite, en ce qui concerne cet article ou les informations qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="ad7af-210">This article is provided for informational purposes only, and Microsoft makes no warranties, express or implied, with respect to this article or the information contained in it.</span></span>

 

 

 