---
title: Meilleures pratiques pour l’installation de jeux en ligne massivement multijoueurs
description: Cet article décrit la création d’une chaîne de conception de l’approbation pour l’installation du client de jeux en ligne massivement multijoueurs (MMOG) et les systèmes de mise à jour de jeux personnalisés qui fonctionnent correctement avec Windows et le modèle de sécurité de Windows Vista et Windows 7.
ms.assetid: b719cff7-97e8-5e0a-9c91-3bd8178da7c8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e81003a434b830f046c29d606355104fe618d1f5
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031474"
---
# <a name="installation-best-practices-for-massively-multiplayer-online-games"></a><span data-ttu-id="f6cbd-103">Meilleures pratiques pour l’installation de jeux en ligne massivement multijoueurs</span><span class="sxs-lookup"><span data-stu-id="f6cbd-103">Installation Best Practices for Massively Multiplayer Online Games</span></span>

<span data-ttu-id="f6cbd-104">Cet article décrit la création d’une chaîne de conception de l’approbation pour l’installation du client de jeux en ligne massivement multijoueurs (MMOG) et les systèmes de mise à jour de jeux personnalisés qui fonctionnent correctement avec Windows et le modèle de sécurité de Windows Vista et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-104">This article describes creating a chain of trust design for Massively Multiplayer Online Games (MMOG) client installation and custom game update systems that work well with Windows and the security model of Windows Vista and Windows 7.</span></span> <span data-ttu-id="f6cbd-105">L’approche est conçue pour activer la mise à jour corrective des titres MMOG tout en prenant en charge les comptes d’utilisateur standard, qui ont un accès limité au disque dur et au registre système.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-105">The approach is designed to enable patching of MMOG titles while supporting standard user accounts, which have restricted access to the hard drive and system registry.</span></span>

-   [<span data-ttu-id="f6cbd-106">Pourquoi les clients MMOG ont des exigences différentes pour les jeux achetés au détail traditionnels</span><span class="sxs-lookup"><span data-stu-id="f6cbd-106">Why MMOG Clients Have Different Requirements to Traditional Retail Purchased Games</span></span>](#why-mmog-clients-have-different-requirements-to-traditional-retail-purchased-games)
-   [<span data-ttu-id="f6cbd-107">Vue d’ensemble d’une approche de chaîne d’approbation</span><span class="sxs-lookup"><span data-stu-id="f6cbd-107">Overview of a Chain of Trust Approach</span></span>](#overview-of-a-chain-of-trust-approach)
-   [<span data-ttu-id="f6cbd-108">Tout est validé sur le serveur, pourquoi dois-je m’inquiéter si mon client est piraté ?</span><span class="sxs-lookup"><span data-stu-id="f6cbd-108">Everything is validated on the server, why should I worry if my client gets hacked?</span></span>](#everything-is-validated-on-the-server-why-should-i-worry-if-my-client-gets-hacked)
-   [<span data-ttu-id="f6cbd-109">Construction de l’application Trust-Worthy Loader</span><span class="sxs-lookup"><span data-stu-id="f6cbd-109">Construction of the Trust-Worthy Loader Application</span></span>](#construction-of-the-trust-worthy-loader-application)
    -   [<span data-ttu-id="f6cbd-110">Lecture en arrière-plan</span><span class="sxs-lookup"><span data-stu-id="f6cbd-110">Background Reading</span></span>](#background-reading)
    -   [<span data-ttu-id="f6cbd-111">Installation du chargeur approuvé et Patcher</span><span class="sxs-lookup"><span data-stu-id="f6cbd-111">Installation of the Trusted Loader and Patcher</span></span>](#installation-of-the-trusted-loader-and-patcher)
    -   [<span data-ttu-id="f6cbd-112">Installation des exécutables, des dll et des données du jeu</span><span class="sxs-lookup"><span data-stu-id="f6cbd-112">Installation of the Game Executables, DLLs, and Data</span></span>](#installation-of-the-game-executables-dlls-and-data)
    -   [<span data-ttu-id="f6cbd-113">Code de modification de la liste de Access Control</span><span class="sxs-lookup"><span data-stu-id="f6cbd-113">Access Control List Modification Code</span></span>](#access-control-list-modification-code)
    -   [<span data-ttu-id="f6cbd-114">Installations pour les utilisateurs expérimentés</span><span class="sxs-lookup"><span data-stu-id="f6cbd-114">Installations for Advanced Users</span></span>](#installations-for-advanced-users)
    -   [<span data-ttu-id="f6cbd-115">Vérification de l’approbation du chargeur</span><span class="sxs-lookup"><span data-stu-id="f6cbd-115">The Loader's Verification of Trust</span></span>](#the-loaders-verification-of-trust)
    -   [<span data-ttu-id="f6cbd-116">Validation des données</span><span class="sxs-lookup"><span data-stu-id="f6cbd-116">Data Validation</span></span>](#data-validation)

## <a name="why-mmog-clients-have-different-requirements-to-traditional-retail-purchased-games"></a><span data-ttu-id="f6cbd-117">Pourquoi les clients MMOG ont des exigences différentes pour les jeux achetés au détail traditionnels</span><span class="sxs-lookup"><span data-stu-id="f6cbd-117">Why MMOG Clients Have Different Requirements to Traditional Retail Purchased Games</span></span>

<span data-ttu-id="f6cbd-118">La nature constamment connectée et en constante évolution de MMOG en fait une exigence fondamentale pour fournir des mises à jour régulières du code client et du contenu pour corriger les failles de sécurité et étendre l’expérience de jeu.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-118">The constantly connected and evolving nature of MMOGs makes it a fundamental requirement to provide regular updates of client code and content to fix security vulnerabilities and extend the gameplay experience.</span></span> <span data-ttu-id="f6cbd-119">Avec le potentiel des mises à jour presque quotidiennes, le scénario MMOG nécessite une gestion attentive pour garantir une expérience utilisateur conviviale.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-119">With the potential for almost daily updates, the MMOG scenario requires careful management to ensure a user friendly experience.</span></span> <span data-ttu-id="f6cbd-120">Cela diffère du modèle d’achat de vente au détail traditionnel où un petit nombre de correctifs peuvent être fournis à proximité de la date d’expédition du produit.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-120">This differs from the traditional retail purchase model where a small number of patches may be provided close to the retail ship date of the product.</span></span> <span data-ttu-id="f6cbd-121">La Windows Installer technologie limitée de mise à jour des utilisateurs fournie avec le système d’exploitation est conçue pour gérer un petit nombre de correctifs d’application, et non pas la grande quantité et la fréquence élevée requises par MMOG.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-121">The Windows Installer limited user patching technology provided with the operating system is designed to handle small numbers of application patches, and not the large quantity and high frequency needed by MMOGs.</span></span> <span data-ttu-id="f6cbd-122">C’est pourquoi il est souvent nécessaire de développer des systèmes de correctifs personnalisés pour répondre aux besoins des MMOG, y compris les exigences particulières spécifiques au MMOG en cours de développement.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-122">It is therefore often necessary for custom patching systems to be developed to address the needs of MMOGs, including any special requirements specific to the particular MMOG being developed.</span></span>

<span data-ttu-id="f6cbd-123">Étant donné que de nombreux ordinateurs sont connectés à Internet, Windows Vista et Windows 7 ont des restrictions et des protections de sécurité plus strictes pour les utilisateurs, qui limitent l’accès des applications aux différentes zones du disque dur.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-123">Because so many computers are connected to the Internet, Windows Vista and Windows 7 have tougher security restrictions and safeguards for users, which limit the access that applications have to various areas of the hard drive.</span></span> <span data-ttu-id="f6cbd-124">Contrairement à Windows XP, ces restrictions sont activées pour le mode par défaut pour les comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-124">Unlike Windows XP, these restrictions are enabled for the default mode for user accounts.</span></span> <span data-ttu-id="f6cbd-125">Ces restrictions doivent être prises en compte lors de la conception de la disposition d’un jeu, d’un fichier exécutable et de données, ainsi que du système de mise à jour qui lui est associé.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-125">These restrictions must be taken into account when designing the layout of a game, executable and data, and its associated patching system.</span></span> <span data-ttu-id="f6cbd-126">Pour plus d’informations sur les mesures de sécurité fournies par le système d’exploitation, consultez [contrôle de compte d’utilisateur pour les développeurs de jeux](/windows/desktop/DxTechArts/user-account-control-for-game-developers).</span><span class="sxs-lookup"><span data-stu-id="f6cbd-126">For more details about the security measures provided by the operating system, see [User Account Control for Game Developers](/windows/desktop/DxTechArts/user-account-control-for-game-developers).</span></span>

## <a name="overview-of-a-chain-of-trust-approach"></a><span data-ttu-id="f6cbd-127">Vue d’ensemble d’une approche de chaîne d’approbation</span><span class="sxs-lookup"><span data-stu-id="f6cbd-127">Overview of a Chain of Trust Approach</span></span>

<span data-ttu-id="f6cbd-128">L’approche de mise à jour personnalisée présentée dans ce livre blanc repose sur la présence d’une application de chargeur fiable installée dans le dossier Program Files protégé tout en conservant les fichiers et les données exécutables du jeu dans une zone partagée All-User accessible.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-128">The custom update approach presented in this whitepaper is based upon having a trustworthy loader application installed to the protected Program Files folder while keeping the games executable files and data in a shared all-user-accessible area.</span></span> <span data-ttu-id="f6cbd-129">Une chaîne d’approbation commence par le chargeur qui effectue des vérifications de validité sur les fichiers binaires et les données de jeu avant le lancement.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-129">A chain of trust starts with the loader which performs validity checks on the game binaries and data before launch.</span></span>

![la chaîne d’approbation commence par un chargeur fiable](images/mmo-installation-best-practices-01.gif)

<span data-ttu-id="f6cbd-131">Le chargeur de confiance doit avoir suffisamment de logique pour être en mesure de vérifier que l’exécutable du jeu et les autres binaires n’ont pas été falsifiés avant de lancer le jeu.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-131">The trustworthy loader needs to have enough logic to be able to verify that the game's executable and other binaries have not been tampered with before launching the game.</span></span> <span data-ttu-id="f6cbd-132">Le chargeur peut également vérifier les données de jeu aussi souvent que nécessaire. Toutefois, la taille des données de jeu est généralement trop importante pour permettre une vérification à chaque fois en une seule passe.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-132">The loader may also verify game data as often as needed, however, the size of game data is usually too large to allow it be checked every time in a single pass.</span></span> <span data-ttu-id="f6cbd-133">Une autre approche consiste à utiliser un modèle d’échantillonnage qui garantit que la vérification de l’ensemble du jeu de données se produit sur une période prolongée.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-133">An alternative approach is to use a sampling pattern which ensures that verification of the entire data set occurs over an extended period of time.</span></span> <span data-ttu-id="f6cbd-134">L’application Loader peut contenir un moteur de mise à jour de jeu, qui offre une méthode fiable pour intégrer les mises à jour au jeu installé.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-134">The loader application may contain a game patching engine, which provides a trust worthy method by to integrate updates with the installed game.</span></span>

## <a name="everything-is-validated-on-the-server-why-should-i-worry-if-my-client-gets-hacked"></a><span data-ttu-id="f6cbd-135">Tout est validé sur le serveur, pourquoi dois-je m’inquiéter si mon client est piraté ?</span><span class="sxs-lookup"><span data-stu-id="f6cbd-135">Everything is validated on the server, why should I worry if my client gets hacked?</span></span>

<span data-ttu-id="f6cbd-136">Il est impossible de faire confiance au fait que le client n’a pas été compromis ; par conséquent, il est courant pour les serveurs MMOG de valider toutes les données reçues du client.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-136">It is impossible to trust that the client has not been compromised; therefore it is common for MMOG servers to validate all data received from the client.</span></span> <span data-ttu-id="f6cbd-137">Alors que ce traitement peut identifier les clients de jeux compromis ou tricher au sein de l’univers du jeu, le serveur ne peut pas identifier facilement tous les problèmes auxquels le client du jeu peut être exposé.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-137">While this processing can identify compromised or cheating game clients within the game universe, the server cannot easily identify all issues the game client can be exposed to.</span></span> <span data-ttu-id="f6cbd-138">Il est important de renforcer la protection contre les pirates qui souhaitent utiliser votre client comme une plateforme pour les attaques sur votre service, d’autres utilisateurs, ou encore simplement comme un vecteur pour attaquer les ordinateurs clients eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-138">It's important to strengthen protection from hackers who wish to use your client as a platform for attacks on your service, other users, or even simply as a vector for attacking the client machines themselves.</span></span> <span data-ttu-id="f6cbd-139">L’application de la signature de code et des techniques de vérification des données peut aider à détecter les clients compromis avant qu’ils ne soient exécutés.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-139">The application of code signing and data verification techniques can help detect compromised clients before they get executed.</span></span> <span data-ttu-id="f6cbd-140">Étant donné que le mécanisme de mise à jour corrective nécessite l’exposition d’exécutables et de fichiers binaires DLL qui ne sont pas protégés par les autorisations de lecture seule standard sur les fichiers programme, la validation de ces fichiers avant leur lancement est importante pour la sécurité globale du système.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-140">Since the patching mechanism requires exposing executable and DLL binaries that are not protected by the standard read-only permissions on Program Files, validating these files before launching them is important for overall system security.</span></span>

<span data-ttu-id="f6cbd-141">Ce modèle ne tente pas de traiter le scénario d’utilisateur administrateur malveillant dans lequel le chargeur lui-même peut devenir compromis, mais se concentre sur la protection des utilisateurs standard contre l’exécution accidentelle de code falsifié.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-141">This model does not attempt to deal with the malicious admin user scenario where the loader itself could become compromised but focuses on protecting standard users from accidentally running tampered code.</span></span> <span data-ttu-id="f6cbd-142">Les techniques de validation serveur traditionnelles sont en fait la seule solution d’atténuation possible pour les administrateurs système de clients malveillants.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-142">Traditional server-client validation techniques are really the only possible mitigation for malicious client system administrators.</span></span>

## <a name="construction-of-the-trust-worthy-loader-application"></a><span data-ttu-id="f6cbd-143">Construction de l’application Trust-Worthy Loader</span><span class="sxs-lookup"><span data-stu-id="f6cbd-143">Construction of the Trust-Worthy Loader Application</span></span>

### <a name="background-reading"></a><span data-ttu-id="f6cbd-144">Lecture en arrière-plan</span><span class="sxs-lookup"><span data-stu-id="f6cbd-144">Background Reading</span></span>

<span data-ttu-id="f6cbd-145">Les lecteurs doivent se familiariser avec la documentation suivante, qui fournit des détails sur la technologie de base pour s’assurer de la meilleure pratique en matière de confiance basée sur les logiciels.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-145">Readers should familiarize themselves with the following documentation, which provides details of the foundation technology for ensuring best practice for software based trust.</span></span>

<dl> <dt>

<span data-ttu-id="f6cbd-146"><span id="Code_Signing"></span><span id="code_signing"></span><span id="CODE_SIGNING"></span>Signature du code</span><span class="sxs-lookup"><span data-stu-id="f6cbd-146"><span id="Code_Signing"></span><span id="code_signing"></span><span id="CODE_SIGNING"></span>Code Signing</span></span>
</dt> <dd>

[<span data-ttu-id="f6cbd-147">Signature Authenticode pour les développeurs de jeux</span><span class="sxs-lookup"><span data-stu-id="f6cbd-147">Authenticode Signing for Game Developers</span></span>](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers)

</dd> <dt>

<span data-ttu-id="f6cbd-148"><span id="SignTool"></span><span id="signtool"></span><span id="SIGNTOOL"></span>SignTool</span><span class="sxs-lookup"><span data-stu-id="f6cbd-148"><span id="SignTool"></span><span id="signtool"></span><span id="SIGNTOOL"></span>SignTool</span></span>
</dt> <dd>

<span data-ttu-id="f6cbd-149">[SignTool](/windows/desktop/SecCrypto/signtool) sur MSDN</span><span class="sxs-lookup"><span data-stu-id="f6cbd-149">[SignTool](/windows/desktop/SecCrypto/signtool) on MSDN</span></span>

</dd> </dl>

<span data-ttu-id="f6cbd-150">La section suivante détaille les API qui doivent être utilisées pour construire l’application Loader, qui prend en charge la disposition des disques pour l’installation et la vérification de la vérification de l’approbation.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-150">The following section details the APIs that should be used to construct the loader application, which support disc layout for install and verification of trust checking.</span></span>

### <a name="installation-of-the-trusted-loader-and-patcher"></a><span data-ttu-id="f6cbd-151">Installation du chargeur approuvé et Patcher</span><span class="sxs-lookup"><span data-stu-id="f6cbd-151">Installation of the Trusted Loader and Patcher</span></span>

<span data-ttu-id="f6cbd-152">Le chargeur approuvé et la version de base de l’utilitaire patcher doivent être installés sous le dossier Program Files protégé sur le disque dur, comme dans les installations traditionnelles.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-152">The trusted loader and base version of the patcher utility should be installed under the protected Program Files folder on the HDD just as in traditional installs.</span></span> <span data-ttu-id="f6cbd-153">L’installation et la mise à jour corrective de l’application Loader requièrent des droits d’administrateur. il est donc important de réduire la fréquence de mise à jour du chargeur pour s’assurer que les utilisateurs finaux n’ont pas besoin d’élever souvent les privilèges, bien que Windows Installer une mise à jour corrective de l’utilisateur limité puisse être utilisée pour éviter l’élévation des correctifs du chargeur.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-153">Installation and patching of the loader application requires Admin rights so it is important to minimize the frequency of update for the loader to ensure end users do not need to elevate often, although Windows Installer limited user patching could be used to avoid elevation for loader patches.</span></span>

<span data-ttu-id="f6cbd-154">Consultez l’article correctif logiciel du jeu dans Windows XP, Windows Vista et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-154">See the article Patching Game Software in Windows XP, Windows Vista, and Windows 7.</span></span>

### <a name="installation-of-the-game-executables-dlls-and-data"></a><span data-ttu-id="f6cbd-155">Installation des exécutables, des dll et des données du jeu</span><span class="sxs-lookup"><span data-stu-id="f6cbd-155">Installation of the Game Executables, DLLs, and Data</span></span>

<span data-ttu-id="f6cbd-156">Pour faciliter les mises à jour de l’utilisateur standard du jeu sans privilège administratif, l’exécutable, les dll et les données des jeux doivent être installés dans une zone du disque dur accessible en écriture pour tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-156">In order to facilitate Standard User updates of the game without administrative privilege, the games executable, DLLs, and data must be installed to an area of the hard disk that is write accessible for all users.</span></span> <span data-ttu-id="f6cbd-157">Le système d’exploitation fournit une zone « toutes les données d’application » qui peut être utilisée comme emplacement par défaut pour l’installation.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-157">The operating system provides an "All Users Application Data" area which can be used as the default location for installation.</span></span> <span data-ttu-id="f6cbd-158">[**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) doit être utilisé avec la \_ clé common \_ AppData de CSIDL pour déterminer le chemin d’accès de fichier pour cette zone.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-158">[**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) should be used with the CSIDL\_COMMON\_APPDATA key to determine the file path for this area.</span></span> <span data-ttu-id="f6cbd-159">Il est important de ne pas faire d’hypothèses sur le chemin d’accès vers lequel cette clé est retournée, car elle peut être configurée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-159">It is important that no assumptions be made about the path to which this key returns as it may be user configurable.</span></span>

<span data-ttu-id="f6cbd-160">L’installation doit modifier ou gérer les autorisations de dossier afin d’obtenir l’accès en écriture tout-utilisateur-partagé nécessaire pour mettre à jour le titre.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-160">The installation needs to alter or manage the folder permissions in order to achieve the all-user-shared-write access needed for updating the title.</span></span> <span data-ttu-id="f6cbd-161">Avec les autorisations adéquates, la fonctionnalité de mise à jour de jeu du programme Loader peut facilement corriger le jeu sans avoir besoin de privilèges spéciaux de tout compte d’utilisateur, y compris les heures de lancement par les utilisateurs standard.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-161">With the correct permissions, the game updater functionality of the loader program can easily patch the game without the need for special privilege from any users account including times when launched by standard users.</span></span>

### <a name="access-control-list-modification-code"></a><span data-ttu-id="f6cbd-162">Code de modification de la liste de Access Control</span><span class="sxs-lookup"><span data-stu-id="f6cbd-162">Access Control List Modification Code</span></span>

<span data-ttu-id="f6cbd-163">Pour Windows XP, vous devrez exécuter du code pour modifier manuellement la liste de contrôle d’accès (ACL). Voici un exemple de fonction qui montre comment procéder :</span><span class="sxs-lookup"><span data-stu-id="f6cbd-163">For Windows XP, you will need to execute code to change the access control list (ACL) manually, here is an example function that demonstrates how to do this:</span></span>

``` syntax
HRESULT ChangeACLtoAllowUserRW( WCHAR* strDir )
{
    EXPLICIT_ACCESS explicitaccess;
    PACL NewAcl = NULL;
    DWORD dwError;

    BuildExplicitAccessWithName( &explicitaccess, L"BUILTIN\\Users",
                                 GENERIC_ALL, GRANT_ACCESS,
                                 SUB_CONTAINERS_AND_OBJECTS_INHERIT );
                                 
    dwError = SetEntriesInAcl( 1, &explicitaccess, NULL, &NewAcl );
    if( dwError == ERROR_SUCCESS) 
    {
        dwError = SetNamedSecurityInfo( strDir, SE_FILE_OBJECT,
                                        DACL_SECURITY_INFORMATION,
                                        NULL, NULL, NewAcl, NULL );
        if( dwError == ERROR_SUCCESS)
        {
            if( NewAcl != NULL ) AccFree( NewAcl );
            return S_OK;
        }
    }

    if( NewAcl != NULL ) AccFree( NewAcl );
    return E_FAIL;
}
```

<span data-ttu-id="f6cbd-164">Cet exemple de code fonctionne également pour Windows Vista et Windows 7. Toutefois, ils fournissent également à l’utilitaire de ligne de commande icacls la possibilité de modifier les listes de contrôle d’accès des fichiers que vous pouvez choisir d’utiliser à la place.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-164">This code example will also work for Windows Vista and Windows 7; however, they also provide the command line utility icacls to edit file ACLS which you may choose to use instead.</span></span>

<span data-ttu-id="f6cbd-165">L’outil fournit une aide détaillée lorsqu’il est exécuté, mais un exemple d’utilisation de l’outil est :</span><span class="sxs-lookup"><span data-stu-id="f6cbd-165">The tool provides a detailed help when executed however, one example usage for the tool is:</span></span>

``` syntax
icacls "C:\Users\All Users\Game" /grant Rex:(D,WDAC)
```

<span data-ttu-id="f6cbd-166">Cette utilisation permet d’octroyer les autorisations de suppression et d’écriture DAC à l’utilisateur sur le dossier de jeu stocké dans les zones tous les utilisateurs du disque dur.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-166">This usage will grant the user Rex Delete and Write DAC permissions to game folder stored in the All Users areas of the hard drive.</span></span>

### <a name="installations-for-advanced-users"></a><span data-ttu-id="f6cbd-167">Installations pour les utilisateurs expérimentés</span><span class="sxs-lookup"><span data-stu-id="f6cbd-167">Installations for Advanced Users</span></span>

<span data-ttu-id="f6cbd-168">Pour les scénarios d’installation utilisateur avancés, un utilisateur peut souhaiter spécifier manuellement le chemin d’installation des jeux.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-168">For advanced user installation scenarios, a user may want to specify the games installation path manually.</span></span> <span data-ttu-id="f6cbd-169">La sélection de répertoire doit être limitée à une partie externe des fichiers programme pour garantir que le dossier se trouve dans une zone véritablement partageable du disque dur.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-169">The directory selection should be restricted to one outside of program files to ensure the folder is in a truly sharable area of the hard drive.</span></span> <span data-ttu-id="f6cbd-170">Le chemin d’accès sélectionné par l’utilisateur ne doit être utilisé que pour les fichiers et les fichiers exe des jeux, car le chargeur de jeux et les fichiers exe patcher doivent toujours être installés dans le dossier des fichiers de programme sécurisés pour une meilleure sécurité.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-170">The user selected path should only be used for the games exes and data as the game Loader and Patcher exes should always be installed under the secure Program Files folder for better security.</span></span>

### <a name="the-loaders-verification-of-trust"></a><span data-ttu-id="f6cbd-171">Vérification de l’approbation du chargeur</span><span class="sxs-lookup"><span data-stu-id="f6cbd-171">The Loader's Verification of Trust</span></span>

<span data-ttu-id="f6cbd-172">Windows fournit la fonction [**WinVerifyTrust**](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) pour vérifier la validité du code signé et est basée sur les services de chiffrement du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-172">Windows provides the [**WinVerifyTrust**](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) function for checking the validity of signed code and is based on the cryptographic services in the operating system.</span></span> <span data-ttu-id="f6cbd-173">La fonction est entièrement documentée sur la fonction MSDN : **WinVerifyTrust** .</span><span class="sxs-lookup"><span data-stu-id="f6cbd-173">The function is fully documented on MSDN: **WinVerifyTrust** Function.</span></span>

<span data-ttu-id="f6cbd-174">L’exemple de programme suivant sur MSDN détaille l’utilisation de la fonction pour déterminer si un exécutable de programme est signé avec un certificat valide : [exemple de programme C : vérification de la signature d’un fichier PE](/windows/desktop/SecCrypto/example-c-program--verifying-the-signature-of-a-pe-file).</span><span class="sxs-lookup"><span data-stu-id="f6cbd-174">The following example program on MSDN details the use of the function to determine whether a program executable is signed with a valid certificate: [Example C Program: Verifying the Signature of a PE File](/windows/desktop/SecCrypto/example-c-program--verifying-the-signature-of-a-pe-file).</span></span>

<span data-ttu-id="f6cbd-175">Dans le but de vérifier que l’exécutable du jeu signé est digne de confiance pour être exécuté à partir du chargeur, l’action de vérification générique suffit :</span><span class="sxs-lookup"><span data-stu-id="f6cbd-175">For the purposes of verifying that the signed game executable is trustworthy to be executed from within the loader, the Generic Verify action will suffice:</span></span>

<dl> <dt>

<span data-ttu-id="f6cbd-176"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Ajoutée</span><span class="sxs-lookup"><span data-stu-id="f6cbd-176"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Value</span></span>
</dt> <dd>

<span data-ttu-id="f6cbd-177">\_Vérification générique de l’action WINTRUST \_ \_ \_ v2</span><span class="sxs-lookup"><span data-stu-id="f6cbd-177">WINTRUST\_ACTION\_GENERIC\_VERIFY\_V2</span></span>

</dd> <dt>

<span data-ttu-id="f6cbd-178"><span id="Meaning"></span><span id="meaning"></span><span id="MEANING"></span>C.-à-d</span><span class="sxs-lookup"><span data-stu-id="f6cbd-178"><span id="Meaning"></span><span id="meaning"></span><span id="MEANING"></span>Meaning</span></span>
</dt> <dd>

<span data-ttu-id="f6cbd-179">Vérifiez un fichier ou un objet à l’aide du fournisseur de stratégie Authenticode.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-179">Verify a file or object using the Authenticode policy provider.</span></span>

</dd> </dl>

<span data-ttu-id="f6cbd-180">La fonction accepte un argument de structure d’entrée qui contient des informations dont le fournisseur d’approbation a besoin pour traiter l’action spécifiée.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-180">The function takes an input structure argument which contains information that the trust provider needs to process the specified action.</span></span> <span data-ttu-id="f6cbd-181">En général, comme dans le cas de l’exemple précédent, la structure contient des informations qui identifient l’objet que le fournisseur d’approbation doit évaluer.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-181">Typically, as in the preceding example case, the structure includes information that identifies the object that the trust provider must evaluate.</span></span>

<span data-ttu-id="f6cbd-182">Le format de la structure est spécifique à l’identificateur d’action.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-182">The format of the structure is specific to the action identifier.</span></span> <span data-ttu-id="f6cbd-183">La rubrique suivante sur MSDN détaille l’exemple de structure pour le fournisseur WinTrust : structure de [**\_ données wintrust**](/windows/desktop/api/wintrust/ns-wintrust-wintrust_data) .</span><span class="sxs-lookup"><span data-stu-id="f6cbd-183">The following topic on MSDN details the example structure for the WinTrust provider: [**WINTRUST\_DATA**](/windows/desktop/api/wintrust/ns-wintrust-wintrust_data) Structure.</span></span>

<span data-ttu-id="f6cbd-184">Si le fournisseur d’approbation vérifie que le sujet est approuvé pour l’action spécifiée, la valeur de retour est zéro.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-184">If the trust provider verifies that the subject is trusted for the specified action, the return value is zero.</span></span> <span data-ttu-id="f6cbd-185">Aucune autre valeur, hormis zéro, ne doit être considérée comme un retour correct.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-185">No other value besides zero should be considered a successful return.</span></span>

### <a name="data-validation"></a><span data-ttu-id="f6cbd-186">Validation des données</span><span class="sxs-lookup"><span data-stu-id="f6cbd-186">Data Validation</span></span>

<span data-ttu-id="f6cbd-187">Le mécanisme de coconception prend uniquement en charge la signature de quelques types de fichiers spécifiques, y compris les fichiers exécutables, les dll, les packages de Windows Installer (fichiers. msi) et les fichiers Cabinet (. cab).</span><span class="sxs-lookup"><span data-stu-id="f6cbd-187">The codesigning mechanism only supports signing a few specific types of files, including executables, DLLs, Windows Installer packages (.msi files), and cabinet (.cab) files.</span></span> <span data-ttu-id="f6cbd-188">L’API [**WinVerifyTrust**](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) ne doit pas être utilisée pour vérifier que les fichiers de données volumineux (par exemple, des fichiers. cab) n’ont pas été falsifiés, car il existe des problèmes de performances et de stabilité lors de la validation de fichiers très volumineux.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-188">The [**WinVerifyTrust**](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) API should not be used to verify that large data files (.cab files for example) have not been tampered with, as there are some issues with performance and stability when validating very large files.</span></span> <span data-ttu-id="f6cbd-189">Les exécutables de programme tendent à être suffisamment petits pour une vérification de confiance totale à l’aide du fournisseur WinTrust, mais les fichiers de données pour les jeux sont souvent du domaine de plusieurs gigaoctets en taille.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-189">Program executables tend be small enough for a full trust check to occur using the WinTrust provider but data files for games are often of the realm of many gigabytes in size.</span></span> <span data-ttu-id="f6cbd-190">L’approche adoptée par le chargeur pour la vérification des données de jeu doit être celle où un petit échantillon du jeu de données est testé au moment de l’exécution du jeu.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-190">The approach taken by the loader for verification of game data should be one where a small sample of the dataset is tested over the run time of the game.</span></span> <span data-ttu-id="f6cbd-191">Cette approche répartit le coût des tests de vérification au cours de la durée de vie de l’expérience de jeu et peut fournir une expérience utilisateur transparente sans temps d’attente.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-191">This approach spreads the cost of verification tests over the life of the game play experience and can provide a seamless user experience without long wait times.</span></span> <span data-ttu-id="f6cbd-192">Pour y parvenir, une organisation minutieuse des données peut être nécessaire.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-192">To achieve this, careful organization of the data may be required.</span></span> <span data-ttu-id="f6cbd-193">Certains MMOG utilisent une approche de base de données pour aider à gérer, gérer et vérifier l’exactitude des ressources de jeu au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-193">Some MMOGs employ a database approach to help manage, maintain and verify correctness of game assets over time.</span></span>

<span data-ttu-id="f6cbd-194">Du point de vue de la sécurité, le code client doit être conçu pour ne pas faire confiance aux fichiers de données, même si vous utilisez un type de validation de données de base avec le chargeur approuvé.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-194">From a security standpoint, the client code should be designed to not trust data files even if using some kind of basic data validation with the trusted loader.</span></span> <span data-ttu-id="f6cbd-195">Les vérifications d’en-tête, les hachages et d’autres contrôles d’intégrité traditionnels doivent être utilisés.</span><span class="sxs-lookup"><span data-stu-id="f6cbd-195">Header checks, hashes, and other traditional integrity checking should be employed.</span></span> <span data-ttu-id="f6cbd-196">Le travail de sécurisation renforcée du code d’e/s du client doit également être effectué à l’aide de techniques telles que le test de fuzzing, ainsi que l’utilisation d’outils d’analyse de code statique automatique tels que le commutateur **/analyze** dans visual Studio 2005 et visual Studio 2008 (disponible dans Visual Studio Team System et le compilateur gratuit fourni avec le SDK Windows).</span><span class="sxs-lookup"><span data-stu-id="f6cbd-196">Work to hardened the client's I/O code should also be done using techniques such as fuzz testing as well as taking advantage of automatic static code analysis tools such as the **/analyze** switch in Visual Studio 2005 and Visual Studio 2008 (available in Visual Studio Team System and the free compiler that ships with the Windows SDK).</span></span>

<span data-ttu-id="f6cbd-197">Pour plus d’informations sur la sécurité logicielle, consultez [meilleures pratiques en matière de sécurité dans le développement de jeux](/windows/desktop/DxTechArts/best-security-practices-in-game-development).</span><span class="sxs-lookup"><span data-stu-id="f6cbd-197">For more information about software security, see [Best Security Practices in Game Development](/windows/desktop/DxTechArts/best-security-practices-in-game-development).</span></span>

 

 