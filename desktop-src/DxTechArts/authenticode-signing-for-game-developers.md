---
title: Signature Authenticode pour les développeurs de jeux
description: Cet article explique comment prendre en main l’authentification de votre jeu et comment intégrer l’authentification dans un processus de génération quotidien.
ms.assetid: 0b3138ea-e4ea-57fb-756b-62fdc20cf813
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f304e6cc8e185264699709987f62dfdca17bf8b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106509862"
---
# <a name="authenticode-signing-for-game-developers"></a><span data-ttu-id="1bb69-103">Signature Authenticode pour les développeurs de jeux</span><span class="sxs-lookup"><span data-stu-id="1bb69-103">Authenticode Signing for Game Developers</span></span>

<span data-ttu-id="1bb69-104">L’authentification des données est de plus en plus importante pour les développeurs de jeux.</span><span class="sxs-lookup"><span data-stu-id="1bb69-104">Data authentication is increasingly important for game developers.</span></span> <span data-ttu-id="1bb69-105">Windows Vista et Windows 7 ont un certain nombre de fonctionnalités, telles que les contrôles de contrôle parental, qui requièrent que les jeux soient correctement signés pour s’assurer que personne n’a falsifié les données.</span><span class="sxs-lookup"><span data-stu-id="1bb69-105">Windows Vista and Windows 7 have a number of features, such as parental controls, that require games to be properly signed to ensure that no one has tampered with the data.</span></span> <span data-ttu-id="1bb69-106">Microsoft Authenticode permet aux utilisateurs finaux et au système d’exploitation de vérifier que le code du programme provient du propriétaire légitime et qu’il n’a pas été altéré ou endommagé de manière malveillante.</span><span class="sxs-lookup"><span data-stu-id="1bb69-106">Microsoft Authenticode enables end users and the operating system to verify that program code comes from the rightful owner and that it hasn't been maliciously altered or accidentally corrupted.</span></span> <span data-ttu-id="1bb69-107">Cet article explique comment prendre en main l’authentification de votre jeu et comment intégrer l’authentification dans un processus de génération quotidien.</span><span class="sxs-lookup"><span data-stu-id="1bb69-107">This article discusses how to get started with authenticating your game and how to integrate authentication into a daily build process.</span></span>

-   [<span data-ttu-id="1bb69-108">Contexte</span><span class="sxs-lookup"><span data-stu-id="1bb69-108">Background</span></span>](#background)
-   [<span data-ttu-id="1bb69-109">Prise en main</span><span class="sxs-lookup"><span data-stu-id="1bb69-109">Getting Started</span></span>](#getting-started)
-   [<span data-ttu-id="1bb69-110">Utilisation d’une autorité de certification approuvée</span><span class="sxs-lookup"><span data-stu-id="1bb69-110">Using a Trusted Certificate Authority</span></span>](#using-a-trusted-certificate-authority)
-   [<span data-ttu-id="1bb69-111">Exemple d’utilisation d’un certificat de test</span><span class="sxs-lookup"><span data-stu-id="1bb69-111">Example Using a Test Certificate</span></span>](#example-using-a-test-certificate)
-   [<span data-ttu-id="1bb69-112">Intégration de code signing dans le système de génération quotidien</span><span class="sxs-lookup"><span data-stu-id="1bb69-112">Integrating Code Signing into the Daily Build System</span></span>](#integrating-code-signing-into-the-daily-build-system)
-   [<span data-ttu-id="1bb69-113">Révocation</span><span class="sxs-lookup"><span data-stu-id="1bb69-113">Revocation</span></span>](#revocation)
-   [<span data-ttu-id="1bb69-114">Pilotes de signature de code</span><span class="sxs-lookup"><span data-stu-id="1bb69-114">Code-Signing Drivers</span></span>](#code-signing-drivers)
-   [<span data-ttu-id="1bb69-115">Résumé</span><span class="sxs-lookup"><span data-stu-id="1bb69-115">Summary</span></span>](#summary)
-   [<span data-ttu-id="1bb69-116">Plus d’informations</span><span class="sxs-lookup"><span data-stu-id="1bb69-116">More information</span></span>](#more-information)

> [!Note]  
> <span data-ttu-id="1bb69-117">Depuis le 1er janvier 2016, Windows 7 et les versions ultérieures n’approuvent plus de certificat de signature de code SHA-1 avec une date d’expiration du 1er janvier 2016 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="1bb69-117">As of January 1, 2016, Windows 7 and later no longer trust any SHA-1 code signing certificate with an expiration date of January 1, 2016 or later.</span></span> <span data-ttu-id="1bb69-118">Pour plus d’informations, consultez [application de la signature de code Authenticode et de l’horodatage Windows](https://social.technet.microsoft.com/wiki/contents/articles/32288.windows-enforcement-of-sha1-certificates.aspx) .</span><span class="sxs-lookup"><span data-stu-id="1bb69-118">See [Windows Enforcement of Authenticode Code Signing and Timestamping](https://social.technet.microsoft.com/wiki/contents/articles/32288.windows-enforcement-of-sha1-certificates.aspx) for more information.</span></span>

 

## <a name="background"></a><span data-ttu-id="1bb69-119">Arrière-plan</span><span class="sxs-lookup"><span data-stu-id="1bb69-119">Background</span></span>

<span data-ttu-id="1bb69-120">Les certificats numériques sont utilisés pour établir l’identité de l’auteur.</span><span class="sxs-lookup"><span data-stu-id="1bb69-120">Digital certificates are used to establish the identity of the author.</span></span> <span data-ttu-id="1bb69-121">Les certificats numériques sont émis par un tiers approuvé, connu sous le nom d’autorité de certification, comme VeriSign ou Thawte.</span><span class="sxs-lookup"><span data-stu-id="1bb69-121">Digital certificates are issued by a trusted third party known as a Certificate Authority (CA) such as VeriSign or Thawte.</span></span> <span data-ttu-id="1bb69-122">L’autorité de certification est chargée de vérifier que le propriétaire ne prétend pas une fausse identification.</span><span class="sxs-lookup"><span data-stu-id="1bb69-122">The CA is responsible for verifying that owner is not claiming a false identify.</span></span> <span data-ttu-id="1bb69-123">Après l’application à une autorité de certification pour un certificat, les développeurs commerciaux peuvent attendre une réponse à leur application en moins de deux semaines.</span><span class="sxs-lookup"><span data-stu-id="1bb69-123">After applying to a CA for a certificate, commercial developers can expect a response to their application in less than two weeks.</span></span>

<span data-ttu-id="1bb69-124">Une fois que l’autorité de certification a décidé que vous répondez à ses critères de stratégie, elle génère un certificat de signature de code conforme à X. 509, le format de certificat standard créé par l’Union internationale des télécommunications, avec les extensions de la version 3.</span><span class="sxs-lookup"><span data-stu-id="1bb69-124">After the CA decides that you meet its policy criteria, it generates a code-signing certificate that conforms to X.509, the industry-standard certificate format created by the International Telecommunications Union, with Version 3 extensions.</span></span> <span data-ttu-id="1bb69-125">Ce certificat vous identifie et contient votre clé publique.</span><span class="sxs-lookup"><span data-stu-id="1bb69-125">This certificate identifies you and contains your public key.</span></span> <span data-ttu-id="1bb69-126">Elle est stockée par l’autorité de certification à des fins de référence, et une copie vous est fournie par voie électronique.</span><span class="sxs-lookup"><span data-stu-id="1bb69-126">It is stored by the CA for reference, and a copy is given to you electronically.</span></span> <span data-ttu-id="1bb69-127">En même temps, vous créez également une clé privée, que vous devez conserver en toute sécurité et que vous ne devez pas partager avec quiconque, même l’autorité de certification.</span><span class="sxs-lookup"><span data-stu-id="1bb69-127">At the same time, you also create a private, key which you must keep safe and which you must not share with anyone, even the CA.</span></span>

<span data-ttu-id="1bb69-128">Une fois que vous disposez d’une clé publique et d’une clé privée, vous pouvez commencer à distribuer le logiciel signé.</span><span class="sxs-lookup"><span data-stu-id="1bb69-128">After you have a public and private key, you can then begin distributing signed software.</span></span> <span data-ttu-id="1bb69-129">Microsoft fournit des outils pour effectuer cette opération dans le SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="1bb69-129">Microsoft provides tools to do this in the Windows SDK.</span></span> <span data-ttu-id="1bb69-130">Les outils utilisent un hachage unidirectionnel, produisent un condensé de longueur fixe et génèrent une signature chiffrée avec une clé privée.</span><span class="sxs-lookup"><span data-stu-id="1bb69-130">The tools utilize a one-way hash, produce a fixed-length digest, and generate an encrypted signature with a private key.</span></span> <span data-ttu-id="1bb69-131">Ils combinent ensuite cette signature chiffrée avec votre certificat et vos informations d’identification dans une structure appelée bloc de signature et l’incorpore dans le format de fichier de l’exécutable.</span><span class="sxs-lookup"><span data-stu-id="1bb69-131">They then combine that encrypted signature with your certificate and credentials into a structure known as a signature block and embed it into the file format of the executable.</span></span> <span data-ttu-id="1bb69-132">Tout type de fichier binaire exécutable peut être signé, y compris les dll, les fichiers exécutables et les fichiers CAB.</span><span class="sxs-lookup"><span data-stu-id="1bb69-132">Any type of executable binary file can be signed, including DLLs, executable files, and cabinet files.</span></span>

<span data-ttu-id="1bb69-133">La signature peut être vérifiée de plusieurs façons.</span><span class="sxs-lookup"><span data-stu-id="1bb69-133">The signature can be verified in multiple ways.</span></span> <span data-ttu-id="1bb69-134">Les programmes peuvent appeler la fonction CertVerifyCertificateChainPolicy, et SignTool (signtool.exe) peut être utilisé pour vérifier une signature à partir de l’invite de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="1bb69-134">Programs can call the CertVerifyCertificateChainPolicy function, and SignTool (signtool.exe) can be used to verify a signature from the command-line prompt.</span></span> <span data-ttu-id="1bb69-135">L’Explorateur Windows possède également un onglet signatures numériques dans Propriétés du fichier qui affiche chaque certificat d’un fichier binaire signé.</span><span class="sxs-lookup"><span data-stu-id="1bb69-135">Windows Explorer also has a Digital Signatures tab in File Properties that displays each certificate of a signed binary file.</span></span> <span data-ttu-id="1bb69-136">(L’onglet signatures numériques s’affiche uniquement dans les propriétés de fichier des fichiers signés.) En outre, une application peut être vérifiée automatiquement à l’aide de [**CertVerifyCertificateChainPolicy**](/windows/desktop/api/wincrypt/nf-wincrypt-certverifycertificatechainpolicy).</span><span class="sxs-lookup"><span data-stu-id="1bb69-136">(The Digital Signatures tab only appears in File Properties for signed files.) Also, an application can be self-verifying by use of [**CertVerifyCertificateChainPolicy**](/windows/desktop/api/wincrypt/nf-wincrypt-certverifycertificatechainpolicy).</span></span>

<span data-ttu-id="1bb69-137">La signature Authenticode est non seulement utile pour l’authentification des données par les utilisateurs finaux, mais également pour la mise à jour corrective de comptes d’utilisateurs limités et par les contrôles parentaux dans Windows Vista et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="1bb69-137">Authenticode signing is not only useful for data authentication by end users, but is also needed for patching of Limited User Accounts and by parental controls in Windows Vista and Windows 7.</span></span> <span data-ttu-id="1bb69-138">En outre, les technologies futures dans les systèmes d’exploitation Windows peuvent également nécessiter que le code soit signé. il est donc vivement recommandé que tous les développeurs professionnels et amateurs acquièrent un certificat de signature de code d’une autorité de certification.</span><span class="sxs-lookup"><span data-stu-id="1bb69-138">In addition, future technologies in Windows operating systems may also require that code is signed, so it is strongly advised that all professional and amateur developers acquire a code-signing certificate from a CA.</span></span> <span data-ttu-id="1bb69-139">Pour plus d’informations sur cette opération, consultez [l’article utilisation d’une autorité de certification approuvée](#using-a-trusted-certificate-authority)plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="1bb69-139">More information on how this is done can be found later in this article in [Using a Trusted Certificate Authority](#using-a-trusted-certificate-authority).</span></span>

<span data-ttu-id="1bb69-140">Le code de jeu, les répartiteurs et les programmes d’installation peuvent tirer parti de la signature Authenicode en vérifiant que les fichiers sont authentiques dans le code.</span><span class="sxs-lookup"><span data-stu-id="1bb69-140">Game code, patchers, and installers can further leverage Authenicode signing by verifying files are authentic in code.</span></span> <span data-ttu-id="1bb69-141">Cela peut être utilisé pour la sécurité réseau générale et anti-fraude.</span><span class="sxs-lookup"><span data-stu-id="1bb69-141">This can be used for anti-cheat and general network security.</span></span> <span data-ttu-id="1bb69-142">Vous trouverez un exemple de code pour vérifier si un fichier est signé ici : [exemple de programme C : la vérification de la signature d’un fichier PE](/windows/desktop/SecCrypto/example-c-program--verifying-the-signature-of-a-pe-file)et un exemple de code pour vérifier la propriété d’un certificat de signature sur un fichier signé sont disponibles ici : [obtention d’informations à partir des exécutables signés par Authenticode](https://support.microsoft.com/kb/323809).</span><span class="sxs-lookup"><span data-stu-id="1bb69-142">Example code for checking if a file is signed can be found here: [Example C Program: Verifying the Signature of a PE File](/windows/desktop/SecCrypto/example-c-program--verifying-the-signature-of-a-pe-file), and example code for checking ownership of a signing certificate on a signed file can be found here: [How To Get Information from Authenticode Signed Executables](https://support.microsoft.com/kb/323809).</span></span>

## <a name="getting-started"></a><span data-ttu-id="1bb69-143">Mise en route</span><span class="sxs-lookup"><span data-stu-id="1bb69-143">Getting Started</span></span>

<span data-ttu-id="1bb69-144">Pour commencer, Microsoft fournit des outils avec Visual Studio 2005 et Visual Studio 2008, et dans le [SDK Windows](https://msdn.microsoft.com/windowsserver/bb980924.aspx), pour vous aider à effectuer et à vérifier le processus de signature de code.</span><span class="sxs-lookup"><span data-stu-id="1bb69-144">To get started, Microsoft provides tools with Visual Studio 2005 and Visual Studio 2008, and in the [Windows SDK](https://msdn.microsoft.com/windowsserver/bb980924.aspx), to help perform and verify the code-signing process.</span></span> <span data-ttu-id="1bb69-145">Après l’installation de Visual Studio ou de l’SDK Windows, les outils décrits dans cet article technique se trouvent dans un sous-répertoire de l’installation de, qui peut inclure un ou plusieurs des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="1bb69-145">After installing Visual Studio or the Windows SDK, the tools described in this technical article are located in a subdirectory of the installation, which may include one or more of the following:</span></span>

-   <span data-ttu-id="1bb69-146">% SystemDrive% \\ Program Files \\ Microsoft Visual Studio 8 \\ SDK \\ v 2.0 \\ bin</span><span class="sxs-lookup"><span data-stu-id="1bb69-146">%SystemDrive%\\Program Files\\Microsoft Visual Studio 8\\SDK\\v2.0\\Bin</span></span>
-   <span data-ttu-id="1bb69-147">% SystemDrive% \\ Program Files \\ Microsoft Visual Studio 8 \\ VC \\ PlatformSDK \\ bin</span><span class="sxs-lookup"><span data-stu-id="1bb69-147">%SystemDrive%\\Program Files\\Microsoft Visual Studio 8\\VC\\PlatformSDK\\Bin</span></span>
-   <span data-ttu-id="1bb69-148">% SystemDrive% \\ Program Files \\ Microsoft Visual Studio 9,0 \\ SmartDevices \\ SDK \\ SDKTools</span><span class="sxs-lookup"><span data-stu-id="1bb69-148">%SystemDrive%\\Program Files\\Microsoft Visual Studio 9.0\\SmartDevices\\SDK\\SDKTools</span></span>\\
-   <span data-ttu-id="1bb69-149">% SystemDrive% \\ Program Files \\ Microsoft SDK \\ Windows \\ v 6.0 a \\ bin</span><span class="sxs-lookup"><span data-stu-id="1bb69-149">%SystemDrive%\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\bin</span></span>\\

<span data-ttu-id="1bb69-150">Les outils suivants sont les plus utiles pour la signature de code :</span><span class="sxs-lookup"><span data-stu-id="1bb69-150">The following tools are the most useful for signing code:</span></span>

<dl> <dt>

<span data-ttu-id="1bb69-151"><span id="Certificate_Creation_Tool__MakeCert.exe_"></span><span id="certificate_creation_tool__makecert.exe_"></span><span id="CERTIFICATE_CREATION_TOOL__MAKECERT.EXE_"></span>Outil de création de certificats (MakeCert.exe)</span><span class="sxs-lookup"><span data-stu-id="1bb69-151"><span id="Certificate_Creation_Tool__MakeCert.exe_"></span><span id="certificate_creation_tool__makecert.exe_"></span><span id="CERTIFICATE_CREATION_TOOL__MAKECERT.EXE_"></span>Certificate Creation Tool (MakeCert.exe)</span></span>
</dt> <dd>

<span data-ttu-id="1bb69-152">Génère un certificat X. 509 de test, sous la forme d’un fichier. cer, qui contient votre clé publique et une clé privée, sous la forme d’un fichier. pvk.</span><span class="sxs-lookup"><span data-stu-id="1bb69-152">Generates a test X.509 certificate, as a .cer file, that contains your public key and a private key, as a .pvk file.</span></span> <span data-ttu-id="1bb69-153">Ce certificat est destiné uniquement à des fins de test interne et ne peut pas être utilisé publiquement.</span><span class="sxs-lookup"><span data-stu-id="1bb69-153">This certificate is only for internal testing purposes and can't be used publicly.</span></span>

</dd> <dt>

<span data-ttu-id="1bb69-154"><span id="pvk2pfx.exe"></span><span id="PVK2PFX.EXE"></span>pvk2pfx.exe</span><span class="sxs-lookup"><span data-stu-id="1bb69-154"><span id="pvk2pfx.exe"></span><span id="PVK2PFX.EXE"></span>pvk2pfx.exe</span></span>
</dt> <dd>

<span data-ttu-id="1bb69-155">Crée un fichier d’échange d’informations personnelles (. pfx) à partir d’une paire de fichiers. cer et. pvk.</span><span class="sxs-lookup"><span data-stu-id="1bb69-155">Creates a Personal Information Exchange (.pfx) file from a pair of .cer and .pvk files.</span></span> <span data-ttu-id="1bb69-156">Le fichier. pfx contient vos clés publique et privée.</span><span class="sxs-lookup"><span data-stu-id="1bb69-156">The .pfx file contains both your public and private key.</span></span>

</dd> <dt>

<span data-ttu-id="1bb69-157"><span id="SignTool__SignTool.exe_"></span><span id="signtool__signtool.exe_"></span><span id="SIGNTOOL__SIGNTOOL.EXE_"></span>SignTool (SignTool.exe)</span><span class="sxs-lookup"><span data-stu-id="1bb69-157"><span id="SignTool__SignTool.exe_"></span><span id="signtool__signtool.exe_"></span><span id="SIGNTOOL__SIGNTOOL.EXE_"></span>SignTool (SignTool.exe)</span></span>
</dt> <dd>

<span data-ttu-id="1bb69-158">Signe le fichier à l’aide du fichier. pfx.</span><span class="sxs-lookup"><span data-stu-id="1bb69-158">Signs file by using the .pfx file.</span></span> <span data-ttu-id="1bb69-159">SignTool prend en charge la signature des fichiers DLL, des fichiers exécutables, des fichiers Windows Installer (. msi) et des fichiers Cabinet (. cab).</span><span class="sxs-lookup"><span data-stu-id="1bb69-159">SignTool supports the signing of DLL files, executable files, Windows Installer (.msi) files, and cabinet (.cab) files.</span></span>

</dd> </dl>

> [!Note]  
> <span data-ttu-id="1bb69-160">Lors de la lecture d’une autre documentation, vous pouvez trouver des références à SignCode (SignCode.exe), mais cet outil est déconseillé et n’est plus pris en charge ; utilisez SignTool à la place.</span><span class="sxs-lookup"><span data-stu-id="1bb69-160">While reading other documentation, you might find references to SignCode (SignCode.exe), but this tool is deprecated and is no longer supported—use SignTool instead.</span></span>

 

## <a name="using-a-trusted-certificate-authority"></a><span data-ttu-id="1bb69-161">Utilisation d’une autorité de certification approuvée</span><span class="sxs-lookup"><span data-stu-id="1bb69-161">Using a Trusted Certificate Authority</span></span>

<span data-ttu-id="1bb69-162">Pour obtenir un certificat approuvé, vous devez appliquer à une autorité de certification, telle que VeriSign ou Thawte.</span><span class="sxs-lookup"><span data-stu-id="1bb69-162">To obtain a trusted certificate, you must apply to a Certificate Authority (CA), such as VeriSign or Thawte.</span></span> <span data-ttu-id="1bb69-163">Microsoft ne recommande pas d’autorité de certification sur une autre, mais si vous souhaitez intégrer le service Rapport d’erreurs Windows (WER), vous devez envisager d’utiliser VeriSign pour émettre le certificat, car l’accès à la base de données WER requiert un compte WinQual qui nécessite un ID VeriSign.</span><span class="sxs-lookup"><span data-stu-id="1bb69-163">Microsoft doesn't recommend any CA over another, but if you want to integrate into the Windows Error Reporting (WER) service, you should consider using VeriSign to issue the certificate, because accessing the WER database requires a WinQual account which requires a VeriSign ID.</span></span> <span data-ttu-id="1bb69-164">Pour obtenir la liste complète des autorités de certification tierces approuvées, consultez [membres du programme de certification racine de Microsoft](/previous-versions/ms995347(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="1bb69-164">For a complete list of trusted third-party certificate authorities, see [Microsoft Root Certificate Program Members](/previous-versions/ms995347(v=msdn.10)).</span></span> <span data-ttu-id="1bb69-165">Pour plus d’informations sur l’inscription avec WER, consultez «[Présentation de rapport d’erreurs Windows](https://msdn.microsoft.com/)» dans la [zone ISV](https://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="1bb69-165">For more information about registering with WER, see "[Introducing Windows Error Reporting](https://msdn.microsoft.com/)" in [ISV Zone](https://msdn.microsoft.com/).</span></span>

<span data-ttu-id="1bb69-166">Une fois que vous avez reçu votre certificat de l’autorité de certification, vous pouvez signer votre programme à l’aide de SignTool et publier votre programme au public.</span><span class="sxs-lookup"><span data-stu-id="1bb69-166">After you receive your certificate from the CA, you can sign your program by using SignTool and release your program to the public.</span></span> <span data-ttu-id="1bb69-167">Toutefois, vous devez veiller à protéger votre clé privée, qui est contenue dans vos fichiers. pfx et. pvk.</span><span class="sxs-lookup"><span data-stu-id="1bb69-167">However, you must be careful to protect your private key, which is contained in your .pfx and .pvk files.</span></span> <span data-ttu-id="1bb69-168">Veillez à conserver ces fichiers dans un emplacement sécurisé.</span><span class="sxs-lookup"><span data-stu-id="1bb69-168">Be sure to keep these files in a secure location.</span></span>

## <a name="example-using-a-test-certificate"></a><span data-ttu-id="1bb69-169">Exemple d’utilisation d’un certificat de test</span><span class="sxs-lookup"><span data-stu-id="1bb69-169">Example Using a Test Certificate</span></span>

<span data-ttu-id="1bb69-170">Les étapes suivantes illustrent la création d’un certificat de signature de code à des fins de test, puis la signature d’un exemple de programme Direct3D (appelée BasicHLSL.exe) avec ce certificat de test.</span><span class="sxs-lookup"><span data-stu-id="1bb69-170">The following steps demonstrate the creation of a code-signing certificate for testing purposes, followed by the signing of a Direct3D sample program (called BasicHLSL.exe) with this test certificate.</span></span> <span data-ttu-id="1bb69-171">Cette procédure crée des fichiers. cer et. pvk, à savoir vos clés publiques et privées, respectivement, qui ne peuvent pas être utilisées pour la certification publique.</span><span class="sxs-lookup"><span data-stu-id="1bb69-171">This procedure creates .cer and .pvk files—your public and private keys, respectively — which cannot be used for public certification.</span></span>

<span data-ttu-id="1bb69-172">Dans cet exemple, un horodatage est également ajouté à la signature.</span><span class="sxs-lookup"><span data-stu-id="1bb69-172">In this example, a time stamp is also added to the signature.</span></span> <span data-ttu-id="1bb69-173">Un horodatage empêche la signature de devenir non valide quand le certificat expire.</span><span class="sxs-lookup"><span data-stu-id="1bb69-173">A time stamp prevents the signature from becoming invalid when the certificate expires.</span></span> <span data-ttu-id="1bb69-174">Le code qui est signé mais qui n’a pas d’horodatage n’est pas validé après l’expiration du certificat.</span><span class="sxs-lookup"><span data-stu-id="1bb69-174">Code that is signed but lacking a time stamp will not validate after the certificate expires.</span></span> <span data-ttu-id="1bb69-175">Par conséquent, tout le code publié publiquement doit avoir un horodatage.</span><span class="sxs-lookup"><span data-stu-id="1bb69-175">Therefore, all publicly released code should have a time stamp.</span></span>

<span data-ttu-id="1bb69-176">**Pour créer un certificat et signer un programme**</span><span class="sxs-lookup"><span data-stu-id="1bb69-176">**To create a certificate and sign a program**</span></span>

1.  <span data-ttu-id="1bb69-177">Créez un certificat de test et une clé privée à l’aide de l’outil de création de certificats (MakeCert.exe).</span><span class="sxs-lookup"><span data-stu-id="1bb69-177">Create a test certificate and private key by using the Certificate Creation Tool (MakeCert.exe).</span></span>

    <span data-ttu-id="1bb69-178">L’exemple de ligne de commande suivant spécifie MyPrivateKey comme nom de fichier pour le fichier de clé privée (. pvk), MyPublicKey comme nom de fichier pour le fichier de certificat (. cer) et MySoftwareCompany comme nom du certificat.</span><span class="sxs-lookup"><span data-stu-id="1bb69-178">The following command-line example specifies MyPrivateKey as the file name for the private key (.pvk) file, MyPublicKey as the file name for the certificate (.cer) file, and MySoftwareCompany as the name of the certificate.</span></span> <span data-ttu-id="1bb69-179">Elle rend également le certificat auto-signé, afin qu’il n’ait pas d’autorité racine non approuvée.</span><span class="sxs-lookup"><span data-stu-id="1bb69-179">It also makes the certificate self-signed, so that it does not have an untrusted root authority.</span></span>

    ```
    MakeCert /n CN=MySoftwareCompany /r /h 0 /eku "1.3.6.1.5.5.7.3.3,1.3.6.1.4.1.311.10.3.13" /e 12-31-2020 /sv MyPrivateKey.pvk MyPublicKey.cer
    ```

    

2.  <span data-ttu-id="1bb69-180">Créez un fichier d’échange d’informations personnelles (. pfx) à partir de votre fichier de clé privée (. pvk) et du fichier de certificat (. cer) à l’aide de pvk2pfx.exe.</span><span class="sxs-lookup"><span data-stu-id="1bb69-180">Create a Personal Information Exchange (.pfx) file from your private key (.pvk) file and certificate (.cer) file by using pvk2pfx.exe.</span></span>

    <span data-ttu-id="1bb69-181">Le fichier. pfx combine vos clés publiques et privées dans un fichier unique.</span><span class="sxs-lookup"><span data-stu-id="1bb69-181">The .pfx file combines your public and private keys into a single file.</span></span> <span data-ttu-id="1bb69-182">L’exemple de ligne de commande suivant utilise les fichiers. pvk et. cer de l’étape précédente pour créer le fichier. pfx nommé MyPFX avec le mot de passe password \_ :</span><span class="sxs-lookup"><span data-stu-id="1bb69-182">The following command-line example uses the .pvk and .cer files from the previous step to create the .pfx file named MyPFX with the password your\_password:</span></span>

    ```
    pvk2pfx.exe -pvk MyPrivateKey.pvk -spc MyPublicKey.cer -pfx MyPFX.pfx -po your_password
    ```

    

3.  <span data-ttu-id="1bb69-183">Signez votre programme avec votre fichier d’échange d’informations personnelles (. pfx) à l’aide de SignTool.</span><span class="sxs-lookup"><span data-stu-id="1bb69-183">Sign your program with your Personal Information Exchange (.pfx) file by using SignTool.</span></span>

    <span data-ttu-id="1bb69-184">Vous pouvez spécifier plusieurs options sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="1bb69-184">You can specify several options on the command line.</span></span> <span data-ttu-id="1bb69-185">L’exemple de ligne de commande suivant utilise le fichier. pfx de l’étape précédente, attribue votre mot de passe \_ en tant que mot de passe, spécifie BasicHLSL comme fichier à signer et récupère un horodatage à partir d’un serveur spécifié :</span><span class="sxs-lookup"><span data-stu-id="1bb69-185">The following command-line example uses the .pfx file from the previous step, gives your\_password as the password, specifies BasicHLSL as the file to be signed, and retrieves a time stamp from a specified server:</span></span>

    ```
    signtool.exe sign /fd SHA256 /f MyPFX.pfx /p your_password /v /t URL_to_time_stamp_service BasicHLSL.exe
    ```

    

    > [!Note]  
    > <span data-ttu-id="1bb69-186">L’URL du service d’horodatage est fournie par l’autorité de certification et est facultative pour le test.</span><span class="sxs-lookup"><span data-stu-id="1bb69-186">The URL to the time stamp service is provided by the CA, and is optional for testing.</span></span> <span data-ttu-id="1bb69-187">Il est important que la signature de production inclue une autorité d’horodatage valide ou que la signature ne parvienne pas à valider quand le certificat expire.</span><span class="sxs-lookup"><span data-stu-id="1bb69-187">It is important for production signing to include a valid time stamp authority, or the signature will fail to validate when the certificate expires.</span></span>

     

4.  <span data-ttu-id="1bb69-188">Vérifiez que le programme est signé à l’aide de SignTool.</span><span class="sxs-lookup"><span data-stu-id="1bb69-188">Verify that the program is signed by using SignTool.</span></span>

    <span data-ttu-id="1bb69-189">L’exemple de ligne de commande suivant spécifie que SignTool doit tenter de vérifier la signature sur BasicHLSL.exe à l’aide de toutes les méthodes disponibles tout en fournissant une sortie détaillée :</span><span class="sxs-lookup"><span data-stu-id="1bb69-189">The following command-line example specifies that SignTool should attempt to verify the signature on BasicHLSL.exe by using all available methods while providing verbose output:</span></span>

    ```
    signtool.exe verify /a /v BasicHLSL.exe
    ```

    

    <span data-ttu-id="1bb69-190">Dans cet exemple, SignTool doit indiquer que le certificat est attaché, tout en indiquant également qu’il n’est pas approuvé, car il n’est pas émis par une autorité de certification.</span><span class="sxs-lookup"><span data-stu-id="1bb69-190">In this example, SignTool should indicate that the certificate is attached, while also stating that it is not trusted, since it is not issued by a CA.</span></span>

5.  <span data-ttu-id="1bb69-191">Approuvez le certificat de test.</span><span class="sxs-lookup"><span data-stu-id="1bb69-191">Trust the test certificate.</span></span>

    <span data-ttu-id="1bb69-192">Pour les certificats de test, vous devez approuver le certificat.</span><span class="sxs-lookup"><span data-stu-id="1bb69-192">For test certificates you need to trust the certificate.</span></span> <span data-ttu-id="1bb69-193">Cette étape doit être ignorée pour les certificats fournis par une autorité de certification, car ceux-ci sont approuvés par défaut.</span><span class="sxs-lookup"><span data-stu-id="1bb69-193">This step should be skipped for certificates provided by a CA since those will trusted by default.</span></span>

    <span data-ttu-id="1bb69-194">Sur les ordinateurs sur lesquels vous souhaitez approuver le certificat de test, exécutez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="1bb69-194">On only the computers where you want to trust the test certificate, run the following:</span></span>

    ```
    certmgr.msc
    ```

    

    <span data-ttu-id="1bb69-195">Cliquez ensuite avec le bouton droit sur autorités de certification racines de confiance et choisissez toutes les tâches \| Importer.</span><span class="sxs-lookup"><span data-stu-id="1bb69-195">Then right click on Trusted Root Certification Authorities and choose All Tasks \| Import.</span></span> <span data-ttu-id="1bb69-196">Ensuite, accédez au fichier. pfx que vous avez créé et suivez les étapes de l’Assistant, en plaçant le certificat dans les autorités de certification racines de confiance.</span><span class="sxs-lookup"><span data-stu-id="1bb69-196">Then browse to the .pfx file you created and follow the wizard steps, placing the certificate in the Trusted Root Certification Authorities.</span></span>

    <span data-ttu-id="1bb69-197">Une fois l’Assistant terminé, vous pouvez commencer le test avec le certificat approuvé sur cet ordinateur.</span><span class="sxs-lookup"><span data-stu-id="1bb69-197">When the wizard completes, you can start testing with the trusted certificate on that computer.</span></span>

## <a name="integrating-code-signing-into-the-daily-build-system"></a><span data-ttu-id="1bb69-198">Intégration de code signing dans le système de génération quotidien</span><span class="sxs-lookup"><span data-stu-id="1bb69-198">Integrating Code Signing into the Daily Build System</span></span>

<span data-ttu-id="1bb69-199">Pour intégrer la signature du code à un projet, vous pouvez créer un fichier de commandes ou un script pour exécuter les outils en ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="1bb69-199">To integrate code signing into a project, you can create a batch file or script to run the command line tools.</span></span> <span data-ttu-id="1bb69-200">Une fois le projet généré, exécutez SignTool avec les paramètres appropriés (comme indiqué à l’étape 3 de notre exemple).</span><span class="sxs-lookup"><span data-stu-id="1bb69-200">After the project is built, run SignTool with the proper settings (as shown in step 3 of our example).</span></span>

<span data-ttu-id="1bb69-201">Soyez particulièrement vigilant dans votre processus de génération pour vous assurer que l’accès aux fichiers. pfx et. pvk est limité à autant d’ordinateurs et d’utilisateurs que possible.</span><span class="sxs-lookup"><span data-stu-id="1bb69-201">Be especially cautious in your build process to insure that access to the .pfx and .pvk files is restricted to as few computers and users as possible.</span></span> <span data-ttu-id="1bb69-202">En guise de meilleure pratique, les développeurs doivent uniquement signer le code à l’aide du certificat de test jusqu’à ce qu’ils soient prêts à être expédiés.</span><span class="sxs-lookup"><span data-stu-id="1bb69-202">As a best practice, developers should only sign code by using the test certificate until they are ready to ship.</span></span> <span data-ttu-id="1bb69-203">Là encore, la clé privée (. pvk) doit être conservée dans un emplacement sécurisé, comme une salle sécurisée ou verrouillée, et idéalement sur un appareil de chiffrement, comme une carte à puce.</span><span class="sxs-lookup"><span data-stu-id="1bb69-203">Again, the private key (.pvk) should be kept in a secured location, like a safe or locked room, and ideally on a cryptographic device, like a smart card.</span></span>

<span data-ttu-id="1bb69-204">Une autre couche de protection est fournie à l’aide de Microsoft Authenticode pour signer le package Windows Installer (MSI) lui-même.</span><span class="sxs-lookup"><span data-stu-id="1bb69-204">Another layer of protection is provided by using Microsoft Authenticode to sign the Windows Installer (MSI) package itself.</span></span> <span data-ttu-id="1bb69-205">Cela permet de protéger le package MSI contre la falsification et l’endommagement accidentel.</span><span class="sxs-lookup"><span data-stu-id="1bb69-205">This helps protect the MSI package against tampering and accidental corruption.</span></span> <span data-ttu-id="1bb69-206">Pour plus d’informations sur la façon de signer des packages avec Authenticode, reportez-vous à la documentation de votre outil de création MSI.</span><span class="sxs-lookup"><span data-stu-id="1bb69-206">Refer to the documentation for your MSI creation tool for more information about how to sign packages with Authenticode.</span></span>

## <a name="revocation"></a><span data-ttu-id="1bb69-207">Révocation</span><span class="sxs-lookup"><span data-stu-id="1bb69-207">Revocation</span></span>

<span data-ttu-id="1bb69-208">Si la sécurité de la clé privée est compromise ou si un événement lié à la sécurité rend un certificat Code-Signing non valide, le développeur doit révoquer le certificat.</span><span class="sxs-lookup"><span data-stu-id="1bb69-208">In the event that the security of the private key is compromised or some security-related event renders a Code-Signing certificate invalid, the developer must revoke the certificate.</span></span> <span data-ttu-id="1bb69-209">Cela affaiblirait l’intégrité du développeur et l’efficacité de la signature du code.</span><span class="sxs-lookup"><span data-stu-id="1bb69-209">Not doing so would weaken the integrity of the developer and the effectiveness of signing code.</span></span> <span data-ttu-id="1bb69-210">Une autorité de certification peut également émettre une révocation avec une heure spécifique. le code signé avec un horodatage avant l’heure de révocation sera toujours considéré comme valide, mais le code avec un horodatage ultérieur sera non valide.</span><span class="sxs-lookup"><span data-stu-id="1bb69-210">A CA can also issue a revocation with specific time; code signed with a time stamp prior to the revocation time will still be considered valid, but code with a subsequent time stamp will be invalid.</span></span> <span data-ttu-id="1bb69-211">La révocation de certificat affecte le code dans toutes les applications signées avec le certificat révoqué.</span><span class="sxs-lookup"><span data-stu-id="1bb69-211">Certificate revocation affects code in any applications that is signed with the revoked certificate.</span></span>

## <a name="code-signing-drivers"></a><span data-ttu-id="1bb69-212">Pilotes Code-Signing</span><span class="sxs-lookup"><span data-stu-id="1bb69-212">Code-Signing Drivers</span></span>

<span data-ttu-id="1bb69-213">Les pilotes peuvent et doivent être signés par Authenticode.</span><span class="sxs-lookup"><span data-stu-id="1bb69-213">Drivers can and should be Authenticode-signed.</span></span> <span data-ttu-id="1bb69-214">Les pilotes en mode noyau ont des exigences supplémentaires : les éditions 64 bits de Windows Vista et Windows 7 empêchent l’installation de tous les pilotes non signés en mode noyau, et toutes les versions de Windows présentent un message d’avertissement lorsqu’un utilisateur tente d’installer un pilote non signé.</span><span class="sxs-lookup"><span data-stu-id="1bb69-214">Kernel-mode drivers have additional requirements: 64-bit editions of Windows Vista and Windows 7 will prevent installation of all unsigned kernel-mode drivers, and all versions of Windows will present a warning prompt when a user attempts to install an unsigned driver.</span></span> <span data-ttu-id="1bb69-215">En outre, les administrateurs peuvent définir stratégie de groupe pour empêcher l’installation de pilotes non signés sur Microsoft Windows Server 2003, Windows XP Professionnel Édition x64 et les éditions 32 bits de Windows Vista et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="1bb69-215">In addition, administrators can set Group Policy to prevent unsigned drivers from being installed on Microsoft Windows Server 2003, Windows XP Professional x64 Edition, and 32-bit editions of Windows Vista and Windows 7.</span></span>

<span data-ttu-id="1bb69-216">De nombreux types de pilotes peuvent être signés avec une signature approuvée par Microsoft, dans le cadre du programme de certification Windows de WHQL ( [Windows Hardware Quality Labs](https://www.microsoft.com/whdc/whql/) ) ou du [programme de signature non classifié](https://www.microsoft.com/whdc/winlogo/drvsign/dqs.mspx) (anciennement signature de fiabilité du pilote), qui permet au système de faire confiance à ces pilotes et de les installer même sans informations d’identification d’administration.</span><span class="sxs-lookup"><span data-stu-id="1bb69-216">Many types of drivers can be signed with a Microsoft-trusted signature — as part of the Windows Certification Program of [Windows Hardware Quality Labs](https://www.microsoft.com/whdc/whql/) (WHQL) or the [Unclassified Signature Program](https://www.microsoft.com/whdc/winlogo/drvsign/dqs.mspx) (formerly named Driver Reliability Signature) — which allows the system to fully trust these drivers and install them even without administrative credentials.</span></span>

<span data-ttu-id="1bb69-217">Au minimum, les pilotes doivent être signés par Authenticode, car les pilotes non signés ou auto-signés (c’est-à-dire signés avec un certificat de test) ne peuvent pas être installés sur de nombreuses plateformes Windows.</span><span class="sxs-lookup"><span data-stu-id="1bb69-217">At a minimum, drivers should be Authenticode-signed, because drivers that are unsigned or self-signed (that is, signed with a test certificate) will fail to install on many Windows-based platforms.</span></span> <span data-ttu-id="1bb69-218">Pour plus d’informations sur la signature des pilotes et du code et des fonctionnalités associées, consultez [Configuration requise pour la signature des pilotes pour Windows](https://www.microsoft.com/whdc/winlogo/drvsign/drvsign.mspx) sur [Windows Hardware Developer Central](https://www.microsoft.com/whdc/).</span><span class="sxs-lookup"><span data-stu-id="1bb69-218">For more information about signing drivers and code and related feature, see [Driver Signing Requirements for Windows](https://www.microsoft.com/whdc/winlogo/drvsign/drvsign.mspx) on [Windows Hardware Developer Central](https://www.microsoft.com/whdc/).</span></span>

## <a name="summary"></a><span data-ttu-id="1bb69-219">Résumé</span><span class="sxs-lookup"><span data-stu-id="1bb69-219">Summary</span></span>

<span data-ttu-id="1bb69-220">L’utilisation de Microsoft Authenticode est un processus simple.</span><span class="sxs-lookup"><span data-stu-id="1bb69-220">Using Microsoft Authenticode is a straightforward process.</span></span> <span data-ttu-id="1bb69-221">Une fois que vous avez obtenu une région d’exécution limitée et créé une clé privée, il est simple d’utiliser les outils fournis par Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1bb69-221">Once you have obtained a CER and created a private key, it is a simple matter of using the tools provided by Microsoft.</span></span> <span data-ttu-id="1bb69-222">Vous pouvez ensuite activer des fonctionnalités importantes dans Windows Vista et Windows 7, telles que le contrôle parental, et informer les clients que votre produit provient directement de son propriétaire légitime.</span><span class="sxs-lookup"><span data-stu-id="1bb69-222">You can then enable important features in Windows Vista and Windows 7, such as parental controls, and let customers know that your product comes directly from its rightful owner.</span></span>

## <a name="more-information"></a><span data-ttu-id="1bb69-223">Informations complémentaires</span><span class="sxs-lookup"><span data-stu-id="1bb69-223">More information</span></span>

<span data-ttu-id="1bb69-224">Pour plus d’informations sur les outils et les processus liés à la signature de code, consultez les liens suivants :</span><span class="sxs-lookup"><span data-stu-id="1bb69-224">More information about tools and processes related to signing code, see the following links:</span></span>

-   [<span data-ttu-id="1bb69-225">Outils de chiffrement</span><span class="sxs-lookup"><span data-stu-id="1bb69-225">Cryptography Tools</span></span>](/windows/desktop/SecCrypto/cryptography-tools)
-   [<span data-ttu-id="1bb69-226">Informations de référence sur les outils API crypto</span><span class="sxs-lookup"><span data-stu-id="1bb69-226">Crypto API Tools Reference</span></span>](/windows/desktop/SecCrypto/cryptoapi-tools-reference)
-   <span data-ttu-id="1bb69-227">[Vue d’ensemble d’Authenticode et turtorials](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537360(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="1bb69-227">[Authenticode Overview and Turtorials](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537360(v=vs.85))</span></span>
-   [<span data-ttu-id="1bb69-228">Certificats numériques</span><span class="sxs-lookup"><span data-stu-id="1bb69-228">Digital Certificates</span></span>](/windows/desktop/SecCrypto/digital-certificates)
-   [<span data-ttu-id="1bb69-229">Déploiement d’Authenticode</span><span class="sxs-lookup"><span data-stu-id="1bb69-229">Deploying Authenticode</span></span>](https://www.microsoft.com/technet/security/topics/cryptographyetc/authenticodets.mspx)
-   [<span data-ttu-id="1bb69-230">Comment : créer des certificats temporaires à utiliser pendant le développement</span><span class="sxs-lookup"><span data-stu-id="1bb69-230">How To: Create Temporary Certificates for Use During Development</span></span>](/dotnet/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development)

 

 