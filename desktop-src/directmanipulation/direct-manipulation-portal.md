---
description: Les API de manipulation directe vous permettent de créer des expériences utilisateur panoramiques, de zoom et de glissement. Pour ce faire, il traite les entrées tactiles sur une région ou un objet, génère des transformations de sortie et applique les transformations aux éléments d’interface utilisateur.
ms.assetid: 26358bc5-71e9-40f0-9243-9bddd961a0e5
title: Manipulation directe
ms.topic: article
ms.date: 02/03/2020
ms.openlocfilehash: 6db2a50893914dfb25050768f88cb289a1ecf3ea
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104109046"
---
# <a name="direct-manipulation"></a><span data-ttu-id="0a829-104">Manipulation directe</span><span class="sxs-lookup"><span data-stu-id="0a829-104">Direct Manipulation</span></span>

<span data-ttu-id="0a829-105">Les API de manipulation directe vous permettent de créer des expériences utilisateur panoramiques, de zoom et de glissement.</span><span class="sxs-lookup"><span data-stu-id="0a829-105">The Direct Manipulation APIs let you create great pan, zoom, and drag user experiences.</span></span> <span data-ttu-id="0a829-106">Pour ce faire, il traite les entrées tactiles sur une région ou un objet, génère des transformations de sortie et applique les transformations aux éléments d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0a829-106">To do this, it processes touch input on a region or object, generates output transforms, and applies the transforms to UI elements.</span></span> <span data-ttu-id="0a829-107">Vous pouvez utiliser la manipulation directe pour optimiser la réactivité et réduire la latence par le biais du traitement d’entrée hors thread, du test de positionnement d’entrée hors thread facultatif et de la prédiction d’entrée/sortie.</span><span class="sxs-lookup"><span data-stu-id="0a829-107">You can use Direct Manipulation to optimize responsiveness and reduce latency through off-thread input processing, optional off-thread input hit testing, and input/output prediction.</span></span>

<span data-ttu-id="0a829-108">Toute application qui utilise la manipulation directe pour traiter les interactions tactiles affiche les animations Windows 8 fluides et les comportements de commentaires d’interaction qui se conforment aux [instructions relatives aux interactions utilisateur courantes](/windows/uwp/design/input/).</span><span class="sxs-lookup"><span data-stu-id="0a829-108">Any application that uses Direct Manipulation to process touch interactions displays the fluid Windows 8 animations and interaction feedback behaviors that conform to the [Guidelines for common user interactions](/windows/uwp/design/input/).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="0a829-109">Public de développeurs</span><span class="sxs-lookup"><span data-stu-id="0a829-109">Developer Audience</span></span>

<span data-ttu-id="0a829-110">L’API de manipulation directe est destinée aux développeurs expérimentés qui connaissent C/C++, qui ont une bonne compréhension du [modèle COM (Component Object Model)](../com/component-object-model--com--portal.md)et connaissent les concepts de la programmation Windows.</span><span class="sxs-lookup"><span data-stu-id="0a829-110">The Direct Manipulation API is for experienced developers who know C/C++, have a solid understanding of the [Component Object Model (COM)](../com/component-object-model--com--portal.md), and are familiar with Windows programming concepts.</span></span>

## <a name="run-time-requirements"></a><span data-ttu-id="0a829-111">Conditions d’exécution</span><span class="sxs-lookup"><span data-stu-id="0a829-111">Run-time requirements</span></span>

<span data-ttu-id="0a829-112">La manipulation directe a été introduite dans Windows 8.</span><span class="sxs-lookup"><span data-stu-id="0a829-112">Direct Manipulation was introduced in Windows 8.</span></span> <span data-ttu-id="0a829-113">Il est inclus à la fois dans les versions 32 bits et 64 bits.</span><span class="sxs-lookup"><span data-stu-id="0a829-113">It is included in both 32-bit and 64-bit versions.</span></span>

## <a name="why-use-directmanipulation"></a><span data-ttu-id="0a829-114">Pourquoi utiliser DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="0a829-114">Why use DirectManipulation</span></span>

### <a name="handles-interactions-in-a-straightforward-and-consistent-manner"></a><span data-ttu-id="0a829-115">Gère les interactions de manière simple et cohérente</span><span class="sxs-lookup"><span data-stu-id="0a829-115">Handles interactions in a straightforward and consistent manner</span></span>

<span data-ttu-id="0a829-116">La manipulation directe fonctionne en prédéclarant les comportements et les interactions pour une région ou un objet.</span><span class="sxs-lookup"><span data-stu-id="0a829-116">Direct Manipulation works by pre-declaring the behaviors and interactions for a region or object.</span></span> <span data-ttu-id="0a829-117">Par exemple, une page Web est souvent configurée pour le panoramique et le zoom.</span><span class="sxs-lookup"><span data-stu-id="0a829-117">For example, a web page is often configured for pan and zoom.</span></span> <span data-ttu-id="0a829-118">Lors de l’exécution, l’entrée est ensuite associée à cette région/cet objet via un appel d’API simple.</span><span class="sxs-lookup"><span data-stu-id="0a829-118">At runtime, input is then associated with this region/object through a simple API call.</span></span> <span data-ttu-id="0a829-119">À partir de ce point, la manipulation directe fait le plus gros du traitement de l’entrée, de l’application des contraintes et de la personnalité, et de la génération des transformations de sortie.</span><span class="sxs-lookup"><span data-stu-id="0a829-119">From this point forward Direct Manipulation does all the heavy lifting of processing the input, applying constraints and personality, and generating the output transforms.</span></span>

### <a name="build-responsive-touch-applications"></a><span data-ttu-id="0a829-120">Créer des applications tactiles réactives</span><span class="sxs-lookup"><span data-stu-id="0a829-120">Build responsive touch applications</span></span>

<span data-ttu-id="0a829-121">Pour optimiser la réactivité et réduire la latence, le traitement de manipulation directe se produit sur un thread indépendant distinct du thread d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0a829-121">To optimize responsiveness and minimize latency, Direct Manipulation processing occurs on a separate, independent thread from the UI thread.</span></span> <span data-ttu-id="0a829-122">Par conséquent, les transformations de sortie peuvent s’exécuter en parallèle à l’activité sur le thread d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0a829-122">As a result, output transforms can run in parallel to activity on the UI thread.</span></span> <span data-ttu-id="0a829-123">L’activité de thread d’interface utilisateur peut inclure la logique d’application, le rendu, la disposition et toute autre chose qui consomme des cycles sur le processeur.</span><span class="sxs-lookup"><span data-stu-id="0a829-123">The UI thread activity may include application logic, rendering, layout, and anything else that consumes cycles on the processor.</span></span>

### <a name="implementation-flexibility"></a><span data-ttu-id="0a829-124">Flexibilité d’implémentation</span><span class="sxs-lookup"><span data-stu-id="0a829-124">Implementation flexibility</span></span>

<span data-ttu-id="0a829-125">Les interfaces incluses avec la manipulation directe fournissent une prise en charge complète de la gestion des entrées, de la reconnaissance des interactions, des notifications de commentaires et des mises à jour de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0a829-125">The interfaces included with Direct Manipulation provide comprehensive support for input handling, interaction recognition, feedback notifications, and UI updates.</span></span> <span data-ttu-id="0a829-126">Les interfaces incorporent également des services système tels que [DirectComposition](../directcomp/directcomposition-portal.md).</span><span class="sxs-lookup"><span data-stu-id="0a829-126">The interfaces also incorporate system services such as [DirectComposition](../directcomp/directcomposition-portal.md).</span></span>

## <a name="basic-concepts"></a><span data-ttu-id="0a829-127">Concepts de base</span><span class="sxs-lookup"><span data-stu-id="0a829-127">Basic concepts</span></span>

<span data-ttu-id="0a829-128">L’implémentation de la manipulation directe la plus simple se compose d’une *fenêtre d’affichage*, de *contenu* et d' *interactions*.</span><span class="sxs-lookup"><span data-stu-id="0a829-128">The most basic Direct Manipulation implementation consists of a *viewport*, *content*, and *interactions*.</span></span> <span data-ttu-id="0a829-129">La *fenêtre d’affichage* est une région qui est en mesure de recevoir et traiter les entrées des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="0a829-129">The *viewport* is a region that is able to receive and process input from user interactions.</span></span> <span data-ttu-id="0a829-130">Il s’agit également de la région du contenu qui est visible par l’utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="0a829-130">It is also the region of the content that is visible to the end-user.</span></span> <span data-ttu-id="0a829-131">Le *contenu* est l’objet réel que les utilisateurs finaux peuvent voir et indique ce qui se déplace ou évolue en réponse à une interaction de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0a829-131">The *content* is the actual object that end-users can see and is what moves or scales in response to a user interaction.</span></span> <span data-ttu-id="0a829-132">Les *interactions* de l’utilisateur principal (également appelées « *manipulations*») prises en charge par la manipulation directe sont le panoramique et le zoom.</span><span class="sxs-lookup"><span data-stu-id="0a829-132">The primary user *interactions* (also known as *manipulations*) supported by Direct Manipulation are panning and zooming.</span></span> <span data-ttu-id="0a829-133">Ces interactions appliquent une transformation de translation ou d’échelle au contenu dans la fenêtre d’affichage, respectivement.</span><span class="sxs-lookup"><span data-stu-id="0a829-133">These interactions apply a translate or scale transform to the content within the viewport, respectively.</span></span> <span data-ttu-id="0a829-134">Plusieurs Viewports (chacun avec son propre contenu) peuvent être configurés dans une seule fenêtre pour créer une expérience d’interface utilisateur riche.</span><span class="sxs-lookup"><span data-stu-id="0a829-134">Multiple viewports (each with their own content) can be configured in a single window to create a rich UI experience.</span></span>

<span data-ttu-id="0a829-135">Cette figure illustre une implémentation de base de la manipulation directe avant et après le panoramique.</span><span class="sxs-lookup"><span data-stu-id="0a829-135">This figure shows a basic Direct Manipulation implementation before and after panning.</span></span>

![implémentation de base de la manipulation directe avant et après le panoramique.](images/dm-art-1.png)

<span data-ttu-id="0a829-137">Pendant l’initialisation de la manipulation directe, un objet **DCompDirectManipulationCompositor** est instancié et est associé à une manipulation directe.</span><span class="sxs-lookup"><span data-stu-id="0a829-137">During initialization of Direct Manipulation a **DCompDirectManipulationCompositor** object is instantiated and is associated with Direct Manipulation.</span></span> <span data-ttu-id="0a829-138">Cet objet est un wrapper autour de [DirectComposition](../directcomp/directcomposition-portal.md), qui est le compositeur système.</span><span class="sxs-lookup"><span data-stu-id="0a829-138">This object is a wrapper around [DirectComposition](../directcomp/directcomposition-portal.md), which is the system compositor.</span></span> <span data-ttu-id="0a829-139">L’objet est chargé d’appliquer les transformations de sortie et de piloter les mises à jour visuelles.</span><span class="sxs-lookup"><span data-stu-id="0a829-139">The object is responsible for applying the output transforms and driving visual updates.</span></span>

<span data-ttu-id="0a829-140">Un contact représente un point tactile identifié par le **pointerId** fourni dans le message [WM/_POINTERDOWN](../inputmsg/wm-pointerdown.md) .</span><span class="sxs-lookup"><span data-stu-id="0a829-140">A contact represents a touch point identified by the **pointerId** provided in the [WM/_POINTERDOWN](../inputmsg/wm-pointerdown.md) message.</span></span> <span data-ttu-id="0a829-141">Lorsqu’un message **WM \_ POINTERDOWN** est reçu, l’application appelle [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact).</span><span class="sxs-lookup"><span data-stu-id="0a829-141">When a **WM\_POINTERDOWN** message is received, the application calls [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact).</span></span> <span data-ttu-id="0a829-142">L’application indique à Manipulationabout directe les contacts qui doivent être gérés et les Viewports qui doivent réagir à ces contacts.</span><span class="sxs-lookup"><span data-stu-id="0a829-142">The application notifies Direct Manipulationabout the contacts that should be handled and the viewport(s) that should react to those contacts.</span></span> <span data-ttu-id="0a829-143">Les entrées au clavier et à la souris ont des valeurs **pointerId** spéciales afin qu’elles puissent être gérées de manière appropriée par manipulation directe.</span><span class="sxs-lookup"><span data-stu-id="0a829-143">Keyboard and mouse input have special **pointerId** values so they can be handled appropriately by Direct Manipulation.</span></span>

<span data-ttu-id="0a829-144">Dans le cas de base ci-dessus, lorsque [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) est appelé, plusieurs événements se produisent :</span><span class="sxs-lookup"><span data-stu-id="0a829-144">In our basic case above, when [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) is called a few things happen:</span></span>

- <span data-ttu-id="0a829-145">Lorsque l’utilisateur effectue une panoramisation, un message [WM/_POINTERCAPTURECHANGED](../inputmsg/wm-pointercapturechanged.md) est envoyé à l’application pour notifier que le contact a été consommé par manipulation directe.</span><span class="sxs-lookup"><span data-stu-id="0a829-145">When the user performs a pan, a [WM/_POINTERCAPTURECHANGED](../inputmsg/wm-pointercapturechanged.md) message is sent to the application to notify that the contact has been consumed by Direct Manipulation.</span></span>
- <span data-ttu-id="0a829-146">Lorsque l’utilisateur déplace les déplacements, la fenêtre d’affichage déclenche des événements de mise à jour qui sont utilisés par le wrapper [DirectComposition](../directcomp/directcomposition-portal.md) pour piloter les mises à jour visuelles à l’écran.</span><span class="sxs-lookup"><span data-stu-id="0a829-146">When the user moves the moves, the viewport fires update events which are used by the [DirectComposition](../directcomp/directcomposition-portal.md) wrapper to drive visual updates to the screen.</span></span> <span data-ttu-id="0a829-147">Pour effectuer un panoramique utilisateur dans une fenêtre d’affichage, le contenu s’affiche pour se déplacer correctement sous le contact.</span><span class="sxs-lookup"><span data-stu-id="0a829-147">To a user panning in a viewport, the content will appear to move smoothly under the contact.</span></span>
- <span data-ttu-id="0a829-148">Lorsque l’utilisateur soulève le contact, il voit que le contenu continue à se déplacer lorsqu’il passe à une animation d’inertie, ce qui ralentit progressivement jusqu’à ce qu’il atteigne son emplacement de repos final.</span><span class="sxs-lookup"><span data-stu-id="0a829-148">When the user lifts the contact, the user sees the content continue to move as it transitions into an inertia animation, gradually decelerating until it reaches its final resting place.</span></span>

## <a name="processing-keyboard-and-mouse-input"></a><span data-ttu-id="0a829-149">Traitement de l’entrée du clavier et de la souris</span><span class="sxs-lookup"><span data-stu-id="0a829-149">Processing keyboard and mouse input</span></span>

<span data-ttu-id="0a829-150">La manipulation directe autorise le transfert manuel des messages du clavier et de la souris à partir du thread d’interface utilisateur de l’application via l’API [**ProcessInput**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-processinput) , de façon à ce qu’ils puissent être gérés de manière appropriée par manipulation directe.</span><span class="sxs-lookup"><span data-stu-id="0a829-150">Direct Manipulation allows keyboard and mouse messages to be forwarded manually from the application UI thread via the [**ProcessInput**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-processinput) API such that they can be handled appropriately by Direct Manipulation.</span></span>

## <a name="directmanipulation-and-the-hwnd"></a><span data-ttu-id="0a829-151">DirectManipulation et HWND</span><span class="sxs-lookup"><span data-stu-id="0a829-151">DirectManipulation and the HWND</span></span>

<span data-ttu-id="0a829-152">La manipulation directe est associée à un HWND Win32 afin de recevoir et traiter des messages d’entrée de pointeur pour cette fenêtre.</span><span class="sxs-lookup"><span data-stu-id="0a829-152">Direct Manipulation is associated with a Win32 HWND in order to receive and process pointer input messages for that window.</span></span> <span data-ttu-id="0a829-153">Lorsque la manipulation directe calcule des valeurs de sortie, elle effectue des rappels asynchrones aux objets [com (Component Object Model)](../com/component-object-model--com--portal.md) de manipulation directe qui sont implémentés dans l’application.</span><span class="sxs-lookup"><span data-stu-id="0a829-153">As Direct Manipulation computes output values, it makes asynchronous callbacks to the Direct Manipulation [Component Object Model (COM)](../com/component-object-model--com--portal.md) objects that are implemented in the application.</span></span> <span data-ttu-id="0a829-154">Ces rappels informent l’application de la transformation appliquée aux objets.</span><span class="sxs-lookup"><span data-stu-id="0a829-154">These callbacks inform the application about the transform that was applied to the objects.</span></span> <span data-ttu-id="0a829-155">La manipulation directe est activée sur le HWND spécifié en appelant [**Activate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-activate).</span><span class="sxs-lookup"><span data-stu-id="0a829-155">Direct Manipulation is activated on the specified HWND by calling [**Activate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-activate).</span></span>

## <a name="supporting-documentation"></a><span data-ttu-id="0a829-156">Documentation de prise en charge</span><span class="sxs-lookup"><span data-stu-id="0a829-156">Supporting documentation</span></span>

- [<span data-ttu-id="0a829-157">Viewports et contenu</span><span class="sxs-lookup"><span data-stu-id="0a829-157">Viewports and content</span></span>](directmanipulation-viewports-and-content.md)
- [<span data-ttu-id="0a829-158">Utilisation de plusieurs Viewports dans DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="0a829-158">Using multiple viewports in DirectManipulation</span></span>](directmanipulation-multiple-vieports.md)
- [<span data-ttu-id="0a829-159">Traitement des entrées avec DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="0a829-159">Processing input with DirectManipulation</span></span>](directmanipulation-processing-input-with-directmanipulation.md)
- [<span data-ttu-id="0a829-160">Moteur de composition</span><span class="sxs-lookup"><span data-stu-id="0a829-160">Composition engine</span></span>](directmanipulation-composition-engine.md)
- [<span data-ttu-id="0a829-161">Référence de manipulation directe</span><span class="sxs-lookup"><span data-stu-id="0a829-161">Direct Manipulation Reference</span></span>](direct-manipulation-reference.md)

- [<span data-ttu-id="0a829-162">BUILD 2013 : WCL-022 : créez votre application de bureau avec le toucher, la souris et le stylet</span><span class="sxs-lookup"><span data-stu-id="0a829-162">BUILD 2013: WCL-022: Make your desktop app great with touch, mouse, and pen</span></span>](https://channel9.msdn.com/Events/Build/2013/4-022)
- [<span data-ttu-id="0a829-163">Traitement des entrées tactiles avec manipulation directe, exemple</span><span class="sxs-lookup"><span data-stu-id="0a829-163">Process touch input with Direct Manipulation sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/1d363ff4bd17d8e20415b92e2ee989d615cc0d91/Samples/TouchInputDirectManipulation)
