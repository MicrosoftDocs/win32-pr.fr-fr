---
title: Entrée et sortie sur bande
description: Les applications peuvent utiliser plusieurs fonctions pour effectuer des entrées et sorties (e/s) sur un lecteur de bande. Les e/s de bande sont similaires aux e/s effectuées sur un appareil de communication.
ms.assetid: 1862c267-0070-4fe8-bb77-40167913978a
keywords:
- Sauvegarde d’entrée et de sortie sur bande
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5946659f1ad0246e37981201e4e08611b45b70b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315899"
---
# <a name="tape-input-and-output"></a><span data-ttu-id="fc29e-105">Entrée et sortie sur bande</span><span class="sxs-lookup"><span data-stu-id="fc29e-105">Tape Input and Output</span></span>

<span data-ttu-id="fc29e-106">Les applications peuvent utiliser plusieurs fonctions pour effectuer des entrées et sorties (e/s) sur un lecteur de bande.</span><span class="sxs-lookup"><span data-stu-id="fc29e-106">There are several functions that applications can use to perform input and output (I/O) on a tape drive.</span></span> <span data-ttu-id="fc29e-107">Les e/s de bande sont similaires aux e/s effectuées sur un appareil de communication.</span><span class="sxs-lookup"><span data-stu-id="fc29e-107">Tape I/O is similar to I/O performed on a communications device.</span></span>

<span data-ttu-id="fc29e-108">Lors de l’exécution d’e/s sur bande, certains lecteurs de bande stockent les informations du microprogramme de bande dans les premiers blocs sur une bande, généralement à l’aide d’une partie des 100 premiers blocs.</span><span class="sxs-lookup"><span data-stu-id="fc29e-108">When performing tape I/O, some tape drives store tape firmware information in the first few blocks on a tape, typically using some portion of the first 100 blocks.</span></span> <span data-ttu-id="fc29e-109">Les applications ne doivent pas utiliser ces blocs.</span><span class="sxs-lookup"><span data-stu-id="fc29e-109">Applications should not use those blocks.</span></span> <span data-ttu-id="fc29e-110">Des informations plus spécifiques sur ce sujet sont disponibles auprès des fabricants de systèmes à bandes individuels.</span><span class="sxs-lookup"><span data-stu-id="fc29e-110">More specific information on this subject is available from individual tape system manufacturers.</span></span> <span data-ttu-id="fc29e-111">En général, une application qui ignore les premiers blocs 100 sur une bande évite les caractéristiques des lecteurs de bande.</span><span class="sxs-lookup"><span data-stu-id="fc29e-111">In general, an application that skips the first 100 blocks on a tape will avoid tape drive idiosyncrasies.</span></span>

<span data-ttu-id="fc29e-112">Les fonctions [**GetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-gettapeposition) et [**SetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-settapeposition) récupèrent et déplacent la position actuelle de la bande.</span><span class="sxs-lookup"><span data-stu-id="fc29e-112">The [**GetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-gettapeposition) and [**SetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-settapeposition) functions retrieve and move the current tape position.</span></span> <span data-ttu-id="fc29e-113">La fonction [**WriteTapemark**](/windows/desktop/api/Winbase/nf-winbase-writetapemark) écrit un nombre spécifié de setmarks, de marques, de marques de courtes et de marques de caractères longs.</span><span class="sxs-lookup"><span data-stu-id="fc29e-113">The [**WriteTapemark**](/windows/desktop/api/Winbase/nf-winbase-writetapemark) function writes a specified number of setmarks, filemarks, short filemarks, and long filemarks.</span></span> <span data-ttu-id="fc29e-114">La fonction [**EraseTape**](/windows/desktop/api/Winbase/nf-winbase-erasetape) efface tout ou partie d’une bande.</span><span class="sxs-lookup"><span data-stu-id="fc29e-114">The [**EraseTape**](/windows/desktop/api/Winbase/nf-winbase-erasetape) function erases all or part of a tape.</span></span>

<span data-ttu-id="fc29e-115">Les fonctions [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) et [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) lisent et écrivent des données de fichier depuis et vers la bande.</span><span class="sxs-lookup"><span data-stu-id="fc29e-115">The [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) functions read and write file data from and to the tape.</span></span> <span data-ttu-id="fc29e-116">Les données sont lues et écrites dans des blocs complets.</span><span class="sxs-lookup"><span data-stu-id="fc29e-116">The data is read and written in complete blocks.</span></span> <span data-ttu-id="fc29e-117">Si la taille de bloc de la bande est de 512 octets, toutes les opérations de lecture et d’écriture doivent utiliser des mémoires tampons qui sont des nombres entiers simples de cette taille de bloc : 512, 1024, 1536, 2048, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="fc29e-117">If the tape's block size is 512 bytes, all read and write operations must use buffers that are simple integer multiples of that block size: 512, 1024, 1536, 2048, and so on.</span></span> <span data-ttu-id="fc29e-118">La plupart, voire tous, les lecteurs autorisent uniquement une opération d’écriture après le rembobinage de la bande ou après qu’une opération de lecture a produit un message d’erreur de fin de données.</span><span class="sxs-lookup"><span data-stu-id="fc29e-118">Most, if not all, drives only allow a write operation after the tape is rewound or after a read operation produces an end-of-data error message.</span></span>

<span data-ttu-id="fc29e-119">Pour lire ou écrire des données de fichier vers ou à partir d’une bande en mode bloc de longueur variable, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="fc29e-119">To read or write file data to or from a tape in variable-length block mode, perform the following steps:</span></span>

1.  <span data-ttu-id="fc29e-120">Déterminez si le lecteur de bande prend en charge le mode bloc de longueur variable en appelant la fonction [**GetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-gettapeparameters) et en vérifiant le \_ \_ \_ bit de bloc de la variable de lecteur de bande du membre **FeaturesLow** de la structure de [**\_ \_ \_ paramètres de lecteur obtenir la bande**](/windows/desktop/api/Winnt/ns-winnt-tape_get_drive_parameters) retournée.</span><span class="sxs-lookup"><span data-stu-id="fc29e-120">Determine whether the tape drive supports variable-length block mode by calling the [**GetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-gettapeparameters) function and checking the TAPE\_DRIVE\_VARIABLE\_BLOCK bit of the **FeaturesLow** member of the returned [**TAPE\_GET\_DRIVE\_PARAMETERS**](/windows/desktop/api/Winnt/ns-winnt-tape_get_drive_parameters) structure.</span></span>
2.  <span data-ttu-id="fc29e-121">Spécifiez le mode de taille de bloc variable en appelant la fonction [**SetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-settapeparameters) , en affectant la valeur zéro au membre **BlockSize** de la structure des [**paramètres de média de jeu de bandes \_ \_ \_**](/windows/desktop/api/Winnt/ns-winnt-tape_set_media_parameters) .</span><span class="sxs-lookup"><span data-stu-id="fc29e-121">Specify the variable block size mode by calling the [**SetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-settapeparameters) function, setting the **BlockSize** member of the [**TAPE\_SET\_MEDIA\_PARAMETERS**](/windows/desktop/api/Winnt/ns-winnt-tape_set_media_parameters) structure to zero.</span></span> <span data-ttu-id="fc29e-122">Ensuite, utilisez [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) ou [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) pour lire ou écrire les données du fichier.</span><span class="sxs-lookup"><span data-stu-id="fc29e-122">Then, use [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) or [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) to read or write the file data.</span></span>

<span data-ttu-id="fc29e-123">Si [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) rencontre une marque de marque, les données jusqu’à la marque sont lues et la fonction échoue.</span><span class="sxs-lookup"><span data-stu-id="fc29e-123">If [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) encounters a filemark, the data up to the filemark is read and the function fails.</span></span> <span data-ttu-id="fc29e-124">(La fonction [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) retourne un code d’erreur indiquant le type de la marque de texte qui a été rencontrée.) Le système d’exploitation déplace la bande au-delà de la marque de la marque, et une application peut appeler à nouveau **ReadFile** pour continuer la lecture.</span><span class="sxs-lookup"><span data-stu-id="fc29e-124">(The [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function returns an error code indicating the type of filemark that was encountered.) The operating system moves the tape past the filemark, and an application can call **ReadFile** again to continue reading.</span></span>

<span data-ttu-id="fc29e-125">[**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) et [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) lisent et écrivent uniquement le flux de données.</span><span class="sxs-lookup"><span data-stu-id="fc29e-125">[**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) read and write only the data stream.</span></span> <span data-ttu-id="fc29e-126">Les fonctions [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) et [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) lisent et écrivent tous les flux associés à un fichier.</span><span class="sxs-lookup"><span data-stu-id="fc29e-126">The [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) and [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) functions read and write all the streams associated with a file.</span></span> <span data-ttu-id="fc29e-127">Celles-ci incluent les données, les attributs étendus, la sécurité et d’autres flux de données.</span><span class="sxs-lookup"><span data-stu-id="fc29e-127">These include data, extended attributes, security, and alternative data streams.</span></span> <span data-ttu-id="fc29e-128">La sécurité et les flux de données alternatifs s’appliquent uniquement à la partition de système de fichiers NTFS.</span><span class="sxs-lookup"><span data-stu-id="fc29e-128">The security and alternate data streams are relevant only on the NTFS file system partition.</span></span>

<span data-ttu-id="fc29e-129">La fonction [**BackupSeek**](/windows/desktop/api/Winbase/nf-winbase-backupseek) recherche dans un fichier accédé initialement par [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) ou [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite).</span><span class="sxs-lookup"><span data-stu-id="fc29e-129">The [**BackupSeek**](/windows/desktop/api/Winbase/nf-winbase-backupseek) function seeks forward in a file initially accessed by [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) or [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite).</span></span> <span data-ttu-id="fc29e-130">Cette fonction permet à une application d’ignorer les informations qui provoquent des erreurs d’accès.</span><span class="sxs-lookup"><span data-stu-id="fc29e-130">This function enables an application to skip information that causes access errors.</span></span>

<span data-ttu-id="fc29e-131">Si une application doit accéder uniquement aux données du fichier, elle doit utiliser [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) et [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile).</span><span class="sxs-lookup"><span data-stu-id="fc29e-131">If an application needs to access only the file data, it should use [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile).</span></span> <span data-ttu-id="fc29e-132">Ces fonctions peuvent également lire d’autres flux de données si les flux ont été créés à l’aide de la fonction [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="fc29e-132">These functions can also read alternative data streams if the streams were created by using the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

<span data-ttu-id="fc29e-133">Une application de sauvegarde sur bande doit utiliser [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) et [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) pour copier toutes les informations relatives à un fichier.</span><span class="sxs-lookup"><span data-stu-id="fc29e-133">A tape-backup application must use [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) and [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) to copy all information pertaining to a file.</span></span> <span data-ttu-id="fc29e-134">Toutefois, ces fonctions ne lisent ni n’écrivent les caractéristiques des fichiers, telles que les attributs, l’heure de création de fichier, etc.</span><span class="sxs-lookup"><span data-stu-id="fc29e-134">However, these functions do not read or write file characteristics such as attributes, file creation time, and so on.</span></span> <span data-ttu-id="fc29e-135">Les applications doivent utiliser les fonctions d’entrée et de sortie de fichier, telles que [**GetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-getfileattributesa) et [**SetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-setfileattributesa), pour récupérer et définir ces valeurs.</span><span class="sxs-lookup"><span data-stu-id="fc29e-135">Applications must use the file input and output functions, such as [**GetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-getfileattributesa) and [**SetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-setfileattributesa), to retrieve and set those values.</span></span>

 

 