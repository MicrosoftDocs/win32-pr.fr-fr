---
title: Meilleures pratiques pour DirectComposition
description: Cette rubrique décrit les meilleures pratiques pour l’utilisation de Microsoft DirectComposition.
ms.assetid: D3A1ECD4-9358-44B9-8A84-7D901219D5CD
keywords:
- meilleures pratiques pour DirectComposition
- pratiques recommandées pour DirectComposition
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f0d19b82b188105c7914e89282c08b12dd4bdc4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103729900"
---
# <a name="best-practices-for-directcomposition"></a><span data-ttu-id="a8e8f-105">Meilleures pratiques pour DirectComposition</span><span class="sxs-lookup"><span data-stu-id="a8e8f-105">Best practices for DirectComposition</span></span>

> [!NOTE]
> <span data-ttu-id="a8e8f-106">Pour les applications sur Windows 10, nous vous recommandons d’utiliser des API Windows. UI. composition au lieu de DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-106">For apps on Windows 10, we recommend using Windows.UI.Composition APIs instead of DirectComposition.</span></span> <span data-ttu-id="a8e8f-107">Pour plus d’informations, consultez [moderniser votre application de bureau à l’aide de la couche visuelle](/windows/uwp/composition/visual-layer-in-desktop-apps).</span><span class="sxs-lookup"><span data-stu-id="a8e8f-107">For more info, see [Modernize your desktop app using the Visual layer](/windows/uwp/composition/visual-layer-in-desktop-apps).</span></span>

<span data-ttu-id="a8e8f-108">Cette rubrique décrit les meilleures pratiques pour l’utilisation de Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-108">This topic describes best practices for using Microsoft DirectComposition.</span></span>

-   [<span data-ttu-id="a8e8f-109">Bonnes pratiques</span><span class="sxs-lookup"><span data-stu-id="a8e8f-109">Best practices</span></span>](#best-practices-for-directcomposition)
-   [<span data-ttu-id="a8e8f-110">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="a8e8f-110">Security considerations</span></span>](#security-considerations)
-   [<span data-ttu-id="a8e8f-111">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="a8e8f-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="a8e8f-112">Bonnes pratiques</span><span class="sxs-lookup"><span data-stu-id="a8e8f-112">Best practices</span></span>

<span data-ttu-id="a8e8f-113">Le tableau suivant présente les pratiques recommandées pour l’utilisation des éléments visuels Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-113">The following table presents the practices recommended for working with Microsoft DirectComposition visuals.</span></span>



| <span data-ttu-id="a8e8f-114">Pratiquer</span><span class="sxs-lookup"><span data-stu-id="a8e8f-114">Practice</span></span>                                                                                                                                                                                                                                                        | <span data-ttu-id="a8e8f-115">Description</span><span class="sxs-lookup"><span data-stu-id="a8e8f-115">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a8e8f-116">Après avoir créé un appareil DirectComposition, appelez la méthode [**IDCompositionDevice :: CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) en réponse à chaque message [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) pour vous assurer que l’appareil est toujours valide.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-116">After creating a DirectComposition device, call the [**IDCompositionDevice::CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) method in response to each [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message to ensure that the device is still valid.</span></span><br/> | <span data-ttu-id="a8e8f-117">Si l’appareil Microsoft DirectX Graphics (DXGI) est perdu, l’appareil DirectComposition associé à l’appareil DXGI est également perdu.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-117">If the Microsoft DirectX Graphics Infrastructure (DXGI) device is lost, the DirectComposition device associated with the DXGI device is also lost.</span></span> <span data-ttu-id="a8e8f-118">Lorsqu’il détecte un appareil perdu, DirectComposition envoie le message [**de \_ peinture WM**](/windows/desktop/gdi/wm-paint) à toutes les fenêtres.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-118">When it detects a lost device, DirectComposition sends the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message to all windows.</span></span> <span data-ttu-id="a8e8f-119">L’appel de [**CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) en réponse à chaque message **WM \_ Paint** vous permet de déterminer si l’objet appareil DirectComposition est toujours valide et, dans le cas contraire, de prendre des mesures pour récupérer du contenu.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-119">Calling [**CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) in response to each **WM\_PAINT** message lets you determine whether the DirectComposition device object is still valid and, if not, take steps to recover content.</span></span> <br/> <span data-ttu-id="a8e8f-120">Pour plus d’informations, consultez [objet Device](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="a8e8f-120">For more information, see [Device object](basic-concepts.md).</span></span><br/> |
| <span data-ttu-id="a8e8f-121">Créez uniquement le nombre d’éléments visuels nécessaires pour une composition ou une animation, puis détruisez les visuels immédiatement après que DirectComposition a terminé de les utiliser.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-121">Create only the number of visuals needed for a composition or animation, and destroy the visuals immediately after DirectComposition finishes using them.</span></span><br/>                                                                                            | <span data-ttu-id="a8e8f-122">DirectComposition utilise l’unité de traitement graphique (GPU), une ressource que votre application partage avec d’autres applications et le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-122">DirectComposition uses the graphics processing unit (GPU), a resource that your application shares with other applications and the operating system.</span></span> <span data-ttu-id="a8e8f-123">Cette pratique garantit que toutes les applications et le système d’exploitation reçoivent des ressources GPU appropriées.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-123">This practice ensures that all applications and the operating system receive adequate GPU resources.</span></span><br/> <span data-ttu-id="a8e8f-124">Pour plus d’informations, consultez [visuels](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="a8e8f-124">For more information, see [Visuals](basic-concepts.md).</span></span><br/>                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="a8e8f-125">Ne pas masquer les visuels en affectant à l’opacité la valeur 0%; à la place, supprimez les éléments visuels de l’arborescence d’éléments visuels.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-125">Do not hide visuals by setting opacity to 0%; instead, remove visuals from the visual tree.</span></span><br/>                                                                                                                                                          | <span data-ttu-id="a8e8f-126">La définition de l’opacité à 0% nécessite davantage de ressources système que la suppression de l’arborescence d’éléments visuels.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-126">Setting opacity to 0% requires more system resources than removing them from the visual tree.</span></span><br/> <span data-ttu-id="a8e8f-127">Pour plus d’informations, consultez [opacité](effects.md) et arborescence d’éléments [visuels](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="a8e8f-127">For more information, see [Opacity](effects.md) and [Visual tree](basic-concepts.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="a8e8f-128">Ne masquez pas un visuel en appliquant un rectangle de découpage vide (de taille zéro) à un visuel.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-128">Do not hide a visual by applying an empty (zero sized) clip rectangle to a visual.</span></span> <span data-ttu-id="a8e8f-129">Au lieu de cela, supprimez le visuel de l’arborescence d’éléments visuels.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-129">Instead, remove the visual from the visual tree.</span></span> <br/>                                                                                                                 | <span data-ttu-id="a8e8f-130">La suppression d’un visuel de l’arborescence d’éléments visuels donne de meilleures performances que l’application d’un rectangle de découpage vide.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-130">Removing a visual from the visual tree results in better performance than applying an empty clip rectangle.</span></span><br/> <span data-ttu-id="a8e8f-131">Pour plus d’informations, consultez [découpage](clipping.md).</span><span class="sxs-lookup"><span data-stu-id="a8e8f-131">For more information, see [Clipping](clipping.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="a8e8f-132">N’appliquez pas de rectangle de découpage à un visuel si le rectangle de découpage n’est pas nécessaire, tel qu’un rectangle de découpage qui comprend l’intégralité du contenu de la bitmap de l’élément visuel.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-132">Do not apply a clip rectangle to a visual if the clip rectangle is not needed, such as a clip rectangle that includes the entire bitmap content of the visual.</span></span><br/>                                                                                       | <span data-ttu-id="a8e8f-133">Les rectangles de découpage inutiles nuisent aux performances du système.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-133">Unnecessary clip rectangles harm system performance.</span></span><br/> <span data-ttu-id="a8e8f-134">Pour plus d’informations, consultez [découpage](clipping.md).</span><span class="sxs-lookup"><span data-stu-id="a8e8f-134">For more information, see [Clipping](clipping.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="a8e8f-135">Si vous avez besoin d’une grande image bitmap de couleur unique, créez une surface bitmap plus petite, puis appliquez une transformation d’échelle au lieu de créer une surface pleine.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-135">If you need a large, single-color bitmap, create a smaller bitmap surface and then apply a scale transform instead of creating a full-sized surface.</span></span> <br/>                                                                                                | <span data-ttu-id="a8e8f-136">L’application d’une transformation d’échelle à une surface plus petite utilise moins de ressources système qu’une surface pleine taille.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-136">Applying a scale transform to a smaller surface is uses fewer system resources than a full-size surface.</span></span><br/> <span data-ttu-id="a8e8f-137">Pour plus d’informations, consultez [objets bitmap](bitmap-surfaces.md) et [transformations](transforms.md).</span><span class="sxs-lookup"><span data-stu-id="a8e8f-137">For more information, see [Bitmap objects](bitmap-surfaces.md) and [Transforms](transforms.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="a8e8f-138">Évitez d’appliquer des transformations 3D à plusieurs niveaux d’une arborescence d’éléments visuels, par exemple à un parent et à ses descendants.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-138">Avoid applying 3D transforms to multiple levels of a visual tree, such as to a parent and its descendent(s).</span></span> <br/>                                                                                                                                        | <span data-ttu-id="a8e8f-139">L’application de transformations 3D à plusieurs niveaux d’une arborescence d’éléments visuels peut produire des résultats inattendus, car les transformations 3D ne sont pas multipliées dans l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-139">Applying 3D transforms to multiple levels of a visual tree can produce unintended results because 3D transformations are not multiplied out in the tree.</span></span> <span data-ttu-id="a8e8f-140">Par exemple, une rotation de 90 degrés autour de l’axe y sur un enfant, et une rotation de 90 degrés autour de l’axe y sur un parent, entraîne la rotation des deux éléments visuels vers l’extérieur.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-140">For example, a 90 degree rotation around the y-axis on a child, and a  90 degree rotation around the y-axis on a parent, results in both visuals being rotated away to nothing.</span></span><br/> <span data-ttu-id="a8e8f-141">Pour plus d’informations, consultez [Effets](effects.md).</span><span class="sxs-lookup"><span data-stu-id="a8e8f-141">For more information, see [Effects](effects.md).</span></span><br/>                                                                                                                                                                                                     |



 

## <a name="security-considerations"></a><span data-ttu-id="a8e8f-142">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="a8e8f-142">Security considerations</span></span>

<span data-ttu-id="a8e8f-143">Les articles suivants fournissent des conseils pour l’écriture de code C++ sécurisé.</span><span class="sxs-lookup"><span data-stu-id="a8e8f-143">The following articles provide guidance for writing secure C++ code.</span></span>

-   [<span data-ttu-id="a8e8f-144">Meilleures pratiques de sécurité pour C++</span><span class="sxs-lookup"><span data-stu-id="a8e8f-144">Security Best Practices for C++</span></span>](/cpp/security/security-best-practices-for-cpp?view=vs-2019)
-   <span data-ttu-id="a8e8f-145">[Modèles & pratiques conseils de sécurité pour les applications](/previous-versions/msp-n-p/ff650760(v=pandp.10))</span><span class="sxs-lookup"><span data-stu-id="a8e8f-145">[Patterns & Practices Security Guidance for Applications](/previous-versions/msp-n-p/ff650760(v=pandp.10))</span></span>

## <a name="related-topics"></a><span data-ttu-id="a8e8f-146">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="a8e8f-146">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a8e8f-147">Utilisation de DirectComposition</span><span class="sxs-lookup"><span data-stu-id="a8e8f-147">How to Use DirectComposition</span></span>](how-to-use-directcomposition.md)
</dt> </dl>

 

