---
title: Concepts de base (DirectComposition)
description: Cette rubrique fournit une vue d’ensemble des concepts de base de Microsoft DirectComposition.
ms.assetid: F442BDCA-C913-4438-BFFA-D3F28B68EE85
keywords:
- Concepts DirectComposition
- DirectComposition concepts de base
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0550dc12cb0dcc5262701658d8e3883ee1ce8d82
ms.sourcegitcommit: 73417d55867c804274a55abe5ca71bcba7006119
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/20/2020
ms.locfileid: "104561384"
---
# <a name="basic-concepts"></a><span data-ttu-id="f1949-105">Concepts de base</span><span class="sxs-lookup"><span data-stu-id="f1949-105">Basic concepts</span></span>

> [!NOTE]
> <span data-ttu-id="f1949-106">Pour les applications sur Windows 10, nous vous recommandons d’utiliser des API Windows. UI. composition au lieu de DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="f1949-106">For apps on Windows 10, we recommend using Windows.UI.Composition APIs instead of DirectComposition.</span></span> <span data-ttu-id="f1949-107">Pour plus d’informations, consultez [moderniser votre application de bureau à l’aide de la couche visuelle](/windows/uwp/composition/visual-layer-in-desktop-apps).</span><span class="sxs-lookup"><span data-stu-id="f1949-107">For more info, see [Modernize your desktop app using the Visual layer](/windows/uwp/composition/visual-layer-in-desktop-apps).</span></span>

<span data-ttu-id="f1949-108">Cette rubrique fournit une vue d’ensemble des concepts de base de Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="f1949-108">This topic provides an overview of the basic concepts of Microsoft DirectComposition.</span></span> <span data-ttu-id="f1949-109">Il contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="f1949-109">It contains the following sections:</span></span>

-   [<span data-ttu-id="f1949-110">Composition</span><span class="sxs-lookup"><span data-stu-id="f1949-110">Composition</span></span>](#composition-target-window)
-   [<span data-ttu-id="f1949-111">Visuels</span><span class="sxs-lookup"><span data-stu-id="f1949-111">Visuals</span></span>](#visuals)
    -   [<span data-ttu-id="f1949-112">Arborescence d’éléments visuels</span><span class="sxs-lookup"><span data-stu-id="f1949-112">Visual tree</span></span>](#visual-tree)
    -   [<span data-ttu-id="f1949-113">Propriétés d’un objet visuel</span><span class="sxs-lookup"><span data-stu-id="f1949-113">Properties of a visual object</span></span>](#properties-of-a-visual-object)
-   [<span data-ttu-id="f1949-114">Objet d’appareil</span><span class="sxs-lookup"><span data-stu-id="f1949-114">Device object</span></span>](#device-object)
-   [<span data-ttu-id="f1949-115">Fenêtre cible de la composition</span><span class="sxs-lookup"><span data-stu-id="f1949-115">Composition target window</span></span>](#composition-target-window)
-   [<span data-ttu-id="f1949-116">Composition transactionnelle</span><span class="sxs-lookup"><span data-stu-id="f1949-116">Transactional composition</span></span>](#transactional-composition)
    -   [<span data-ttu-id="f1949-117">Traitement par lot</span><span class="sxs-lookup"><span data-stu-id="f1949-117">Batching</span></span>](#batching)
    -   [<span data-ttu-id="f1949-118">Synchronisation</span><span class="sxs-lookup"><span data-stu-id="f1949-118">Synchronization</span></span>](#synchronization)
    -   [<span data-ttu-id="f1949-119">Arborescences d’éléments visuels entre appareils</span><span class="sxs-lookup"><span data-stu-id="f1949-119">Cross-device visual trees</span></span>](#cross-device-visual-trees)
-   [<span data-ttu-id="f1949-120">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f1949-120">Related topics</span></span>](#related-topics)

## <a name="composition"></a><span data-ttu-id="f1949-121">Composition</span><span class="sxs-lookup"><span data-stu-id="f1949-121">Composition</span></span>

<span data-ttu-id="f1949-122">DirectComposition définit une *composition* en tant que collection de bitmaps combinés et manipulés en appliquant différentes transformations, effets et animations pour produire un résultat visuel dans une interface utilisateur d’application.</span><span class="sxs-lookup"><span data-stu-id="f1949-122">DirectComposition defines a *composition* as a collection of bitmaps that are combined and manipulated by applying various transforms, effects, and animations to produce a visual result in an application UI.</span></span> <span data-ttu-id="f1949-123">DirectComposition fonctionne uniquement avec le contenu de la bitmap. elle ne prend pas en charge les vecteurs ou le texte.</span><span class="sxs-lookup"><span data-stu-id="f1949-123">DirectComposition works with bitmap content only; it does not support vectors or text.</span></span> <span data-ttu-id="f1949-124">DirectComposition ne fournit pas de contenu bitmap.</span><span class="sxs-lookup"><span data-stu-id="f1949-124">DirectComposition does not provide bitmap content.</span></span> <span data-ttu-id="f1949-125">Au lieu de cela, il fournit des interfaces dans lesquelles les utilisateurs peuvent dessiner avec D2D, DXGI ou charger leur propre contenu de texture.</span><span class="sxs-lookup"><span data-stu-id="f1949-125">Instead it provides interfaces in which users can draw with D2D, DXGI, or upload their own texture content.</span></span>

<span data-ttu-id="f1949-126">Une application DirectComposition crée deux ensembles d’objets pour composer une scène : les bitmaps qui sont composés ensemble, et les visuels qui définissent les relations spatiales entre les bitmaps.</span><span class="sxs-lookup"><span data-stu-id="f1949-126">A DirectComposition application creates two sets of objects to compose a scene: bitmaps that are composed together, and visuals that define the spatial relationships among the bitmaps.</span></span> <span data-ttu-id="f1949-127">Pour plus d’informations sur les objets bitmap pris en charge par DirectComposition, consultez [objets bitmap](bitmap-surfaces.md).</span><span class="sxs-lookup"><span data-stu-id="f1949-127">For more information about the bitmap objects supported by DirectComposition, see [Bitmap objects](bitmap-surfaces.md).</span></span>

## <a name="visuals"></a><span data-ttu-id="f1949-128">Objets visuels</span><span class="sxs-lookup"><span data-stu-id="f1949-128">Visuals</span></span>

<span data-ttu-id="f1949-129">Les éléments *visuels* (ou *objets visuels*) sont les éléments fondamentaux de DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="f1949-129">*Visuals* (or *visual objects*) are the fundamental elements of DirectComposition.</span></span> <span data-ttu-id="f1949-130">Il s’agit des blocs de construction de base que vous utilisez pour créer des compositions et des animations dans l’interface utilisateur de votre application.</span><span class="sxs-lookup"><span data-stu-id="f1949-130">They are the basic building blocks that you use to create compositions and animations in your application UI.</span></span>

<span data-ttu-id="f1949-131">En termes de programmation, un visuel est un objet qui a un ensemble de propriétés et expose une interface que vous utilisez pour définir la valeur des propriétés.</span><span class="sxs-lookup"><span data-stu-id="f1949-131">In programming terms, a visual is an object that has a set of properties, and exposes an interface that you use to set the value of the properties.</span></span> <span data-ttu-id="f1949-132">La propriété de contenu d’un visuel associe une image bitmap particulière au visuel, tandis que d’autres propriétés contrôlent la façon dont DirectComposition positionne et manipule le visuel tel qu’il est affiché à l’écran.</span><span class="sxs-lookup"><span data-stu-id="f1949-132">A visual's Content property associates a particular bitmap with the visual, while other properties control how DirectComposition positions and manipulates the visual as it is rendered to the screen.</span></span>

<span data-ttu-id="f1949-133">Pour plus d’informations, consultez [propriétés d’un visuel](#properties-of-a-visual-object).</span><span class="sxs-lookup"><span data-stu-id="f1949-133">For more information, see [Properties of a Visual](#properties-of-a-visual-object).</span></span>

### <a name="visual-tree"></a><span data-ttu-id="f1949-134">Arborescence d’éléments visuels</span><span class="sxs-lookup"><span data-stu-id="f1949-134">Visual tree</span></span>

<span data-ttu-id="f1949-135">DirectComposition crée une composition à partir d’une collection hiérarchique d’objets visuels appelée *arborescence* d’éléments visuels.</span><span class="sxs-lookup"><span data-stu-id="f1949-135">DirectComposition creates a composition from a hierarchical collection of visual objects called a *visual tree*.</span></span> <span data-ttu-id="f1949-136">Le visuel à la racine d’une arborescence est appelé le *visuel racine* et peut être associé à un ou plusieurs *visuels enfants* .</span><span class="sxs-lookup"><span data-stu-id="f1949-136">The visual at the root of a tree is called the *root visual* and it can have one or more *child visuals* associated with it.</span></span> <span data-ttu-id="f1949-137">Un visuel enfant peut avoir un ou plusieurs visuels enfants.</span><span class="sxs-lookup"><span data-stu-id="f1949-137">A child visual can have one or more child visuals of its own.</span></span> <span data-ttu-id="f1949-138">Tout visuel associé à des éléments visuels enfants est appelé un *visuel parent*, et tous les visuels enfants qui partagent le même parent sont appelés des *visuels frères*.</span><span class="sxs-lookup"><span data-stu-id="f1949-138">Any visual that has associated child visuals is called a *parent visual*, and all child visuals that share the same parent are called *sibling visuals*.</span></span> <span data-ttu-id="f1949-139">Un visuel particulier, ainsi que tous ses éléments visuels enfants et descendants, sont appelés *sous-arborescences visuelles*.</span><span class="sxs-lookup"><span data-stu-id="f1949-139">A particular visual along with all its child and descendent visuals is called a *visual subtree*.</span></span>

<span data-ttu-id="f1949-140">L’emplacement d’un visuel dans l’arborescence permet de déterminer la position de l’écran et l’ordre de plan par rapport aux autres éléments visuels de la composition.</span><span class="sxs-lookup"><span data-stu-id="f1949-140">A visual's location in the tree helps determine its screen position and z-order relative to the other visuals in the composition.</span></span> <span data-ttu-id="f1949-141">Le visuel racine est positionné par rapport à l’angle supérieur gauche de la zone cliente de la fenêtre cible où la composition est rendue.</span><span class="sxs-lookup"><span data-stu-id="f1949-141">The root visual is positioned relative to the upper-left corner of the client area of the target window where the composition is rendered.</span></span> <span data-ttu-id="f1949-142">Tous les éléments visuels enfants sont positionnés par rapport à l’angle supérieur gauche de leur visuel parent (ou le visuel spécifié par la propriété TransformParent) et apparaissent toujours devant leur parent dans l’ordre de plan.</span><span class="sxs-lookup"><span data-stu-id="f1949-142">All child visuals are positioned relative to the upper-left corner of their parent visual (or the visual specified by the TransformParent property), and always appear in front of their parent in the z-order.</span></span>

<span data-ttu-id="f1949-143">L’illustration suivante montre une composition d’éléments visuels et la structure de l’arborescence d’éléments visuels utilisée pour produire la composition.</span><span class="sxs-lookup"><span data-stu-id="f1949-143">The following illustration shows a composition of visuals and the structure of the visual tree used to produce the composition.</span></span> <span data-ttu-id="f1949-144">Visual 1 est le visuel racine et est également le parent des éléments visuels enfants 2 et 3, qui sont des visuels frères.</span><span class="sxs-lookup"><span data-stu-id="f1949-144">Visual 1 is the root visual and is also the parent of child Visuals 2 and 3, which are sibling visuals.</span></span> <span data-ttu-id="f1949-145">Visual 3 a ses propres visuels enfants, les éléments visuels 4 et 5.</span><span class="sxs-lookup"><span data-stu-id="f1949-145">Visual 3 has two child visuals of its own, Visuals 4 and 5.</span></span> <span data-ttu-id="f1949-146">Ensemble, les éléments 3 à 5 composent une sous-arborescence visuelle.</span><span class="sxs-lookup"><span data-stu-id="f1949-146">Together, Visuals 3 through 5 make up a visual subtree.</span></span>

![une composition d’éléments visuels et l’arborescence d’éléments visuels correspondante](images/visuals-and-corresponding-tree.png)

<span data-ttu-id="f1949-148">Un visuel parent conserve une liste triée de ses éléments visuels enfants.</span><span class="sxs-lookup"><span data-stu-id="f1949-148">A parent visual maintains an ordered list of its child visuals.</span></span> <span data-ttu-id="f1949-149">Lorsque les éléments visuels frères sont positionnés de sorte qu’ils se chevauchent, DirectComposition définit l’ordre de plan des frères en fonction de l’ordre dans lequel ils apparaissent dans la liste des enfants du visuel parent.</span><span class="sxs-lookup"><span data-stu-id="f1949-149">When sibling visuals are positioned such that they overlap one another, DirectComposition sets the z-order of the siblings based on the order in which they appear in the parent visual's children list.</span></span> <span data-ttu-id="f1949-150">Un frère qui apparaît plus loin dans la liste est placé devant tous les frères qui apparaissent précédemment dans la liste.</span><span class="sxs-lookup"><span data-stu-id="f1949-150">A sibling that appears later in the list is placed in front of all siblings that appear earlier in the list.</span></span> <span data-ttu-id="f1949-151">L’illustration suivante montre l’ordre de plan des éléments visuels enfants qui se chevauchent.</span><span class="sxs-lookup"><span data-stu-id="f1949-151">The following illustration shows the z-order of overlapping child visuals.</span></span>

![ordre de plan des éléments visuels enfants qui se chevauchent](images/overlapping-child-visuals.png)

### <a name="properties-of-a-visual-object"></a><span data-ttu-id="f1949-153">Propriétés d’un objet visuel</span><span class="sxs-lookup"><span data-stu-id="f1949-153">Properties of a visual object</span></span>

<span data-ttu-id="f1949-154">Un objet visuel expose un ensemble de propriétés qui vous permettent de définir le contenu de la bitmap pour le visuel et de contrôler la façon dont DirectComposition positionne et manipule le contenu visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-154">A visual object exposes a set of properties that enable you to set the bitmap content for the visual, and to control how DirectComposition positions and manipulates the visual content.</span></span> <span data-ttu-id="f1949-155">Les sections suivantes décrivent chaque propriété en détail.</span><span class="sxs-lookup"><span data-stu-id="f1949-155">The following sections describe each property in detail.</span></span>

-   [<span data-ttu-id="f1949-156">Propriété de contenu</span><span class="sxs-lookup"><span data-stu-id="f1949-156">Content property</span></span>](#content-property)
-   [<span data-ttu-id="f1949-157">Clip, propriété</span><span class="sxs-lookup"><span data-stu-id="f1949-157">Clip property</span></span>](#clip-property)
-   [<span data-ttu-id="f1949-158">Propriété BorderMode</span><span class="sxs-lookup"><span data-stu-id="f1949-158">BorderMode property</span></span>](#bordermode-property)
-   [<span data-ttu-id="f1949-159">Propriété BitmapInterpolationMode</span><span class="sxs-lookup"><span data-stu-id="f1949-159">BitmapInterpolationMode property</span></span>](#bitmapinterpolationmode-property)
-   [<span data-ttu-id="f1949-160">Propriété CompositeMode</span><span class="sxs-lookup"><span data-stu-id="f1949-160">CompositeMode property</span></span>](#compositemode-property)
-   [<span data-ttu-id="f1949-161">OffsetX et propriétés OffsetY</span><span class="sxs-lookup"><span data-stu-id="f1949-161">OffsetX and OffsetY properties</span></span>](#offsetx-and-offsety-properties)
-   [<span data-ttu-id="f1949-162">Propriété Effect</span><span class="sxs-lookup"><span data-stu-id="f1949-162">Effect property</span></span>](#effect-property)
-   [<span data-ttu-id="f1949-163">Transform (propriété)</span><span class="sxs-lookup"><span data-stu-id="f1949-163">Transform property</span></span>](#transform-property)
-   [<span data-ttu-id="f1949-164">Propriété TransformParent</span><span class="sxs-lookup"><span data-stu-id="f1949-164">TransformParent property</span></span>](#transformparent-property)

### <a name="content-property"></a><span data-ttu-id="f1949-165">Propriété de contenu</span><span class="sxs-lookup"><span data-stu-id="f1949-165">Content property</span></span>

<span data-ttu-id="f1949-166">La propriété de contenu d’un visuel spécifie le contenu de la bitmap associée au visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-166">A visual's Content property specifies the bitmap content that is associated with the visual.</span></span> <span data-ttu-id="f1949-167">Il s’agit de la bitmap que DirectComposition utilise lorsque vous incluez le visuel dans une composition.</span><span class="sxs-lookup"><span data-stu-id="f1949-167">This is the bitmap that DirectComposition uses when you include the visual in a composition.</span></span>

<span data-ttu-id="f1949-168">Vous définissez la propriété de contenu d’un visuel en appelant la méthode [**IDCompositionVisual :: SetContent**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setcontent) .</span><span class="sxs-lookup"><span data-stu-id="f1949-168">You set the Content property of a visual by calling the [**IDCompositionVisual::SetContent**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setcontent) method.</span></span>

<span data-ttu-id="f1949-169">Pour plus d’informations sur les types de contenu de bitmap pris en charge par DirectComposition, consultez [objets bitmap](bitmap-surfaces.md).</span><span class="sxs-lookup"><span data-stu-id="f1949-169">For more information about the types of bitmap content supported by DirectComposition, see [Bitmap objects](bitmap-surfaces.md).</span></span>

### <a name="clip-property"></a><span data-ttu-id="f1949-170">Clip, propriété</span><span class="sxs-lookup"><span data-stu-id="f1949-170">Clip property</span></span>

<span data-ttu-id="f1949-171">La propriété clip d’un élément visuel spécifie une zone rectangulaire appelée zone de *découpage* (ou *rectangle* de découpage).</span><span class="sxs-lookup"><span data-stu-id="f1949-171">The Clip property of a visual specifies a rectangular area called the *clipping region* (or *clip rectangle*).</span></span> <span data-ttu-id="f1949-172">Quand un visuel est rendu, seule la partie du visuel qui se trouve à l’intérieur de la zone de découpage est affichée, tandis que tout contenu qui s’étend hors de la zone de découpage est coupé (c’est-à-dire, non affiché).</span><span class="sxs-lookup"><span data-stu-id="f1949-172">When a visual is rendered, only the portion of the visual that falls inside the clipping region is displayed, while any content that extends outside the clipping region is clipped (that is, not displayed).</span></span> <span data-ttu-id="f1949-173">DirectComposition prend en charge les régions de découpage qui ont des angles arrondis ou au carré.</span><span class="sxs-lookup"><span data-stu-id="f1949-173">DirectComposition supports clipping regions that have rounded or squared corners.</span></span>

<span data-ttu-id="f1949-174">Vous définissez la propriété clip d’un élément visuel en appelant la méthode [**IDCompositionVisual :: SetClip**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(constd2d_rect_f_)) .</span><span class="sxs-lookup"><span data-stu-id="f1949-174">You set the Clip property of a visual by calling the [**IDCompositionVisual::SetClip**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(constd2d_rect_f_)) method.</span></span>

<span data-ttu-id="f1949-175">Pour plus d’informations, consultez [découpage](clipping.md).</span><span class="sxs-lookup"><span data-stu-id="f1949-175">For more information, see [Clipping](clipping.md).</span></span>

### <a name="bordermode-property"></a><span data-ttu-id="f1949-176">Propriété BorderMode</span><span class="sxs-lookup"><span data-stu-id="f1949-176">BorderMode property</span></span>

<span data-ttu-id="f1949-177">La propriété BorderMode spécifie comment composer les bords des bitmaps et des clips associés à cet élément visuel, ou avec des éléments visuels dans la sous-arborescence enracinée dans ce visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-177">The BorderMode property specifies how to compose the edges of bitmaps and clips associated with this visual, or with visuals in the subtree rooted at this visual.</span></span>

<span data-ttu-id="f1949-178">Le mode Border affecte la façon dont les bords d’une image bitmap sont composés lorsque la bitmap est transformée de telle sorte que les bords ne sont pas alignés sur l’axe avec les coordonnées entières.</span><span class="sxs-lookup"><span data-stu-id="f1949-178">The border mode affects how the edges of a bitmap are composed when the bitmap is transformed such that the edges are not axis-aligned with integer coordinates.</span></span> <span data-ttu-id="f1949-179">Cela affecte également la façon dont le contenu est coupé aux angles d’un élément qui a des angles arrondis, et au bord d’un élément qui est transformé de telle sorte que les bords ne sont pas alignés sur l’axe avec les coordonnées d’entier.</span><span class="sxs-lookup"><span data-stu-id="f1949-179">It also affects how content is clipped at the corners of a clip that has rounded corners, and at the edge of a clip that is transformed such that the edges are not axis-aligned with integer coordinates.</span></span>

<span data-ttu-id="f1949-180">Pour plus d’informations, consultez [**IDCompositionVisual :: SetBorderMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setbordermode).</span><span class="sxs-lookup"><span data-stu-id="f1949-180">For more information, see [**IDCompositionVisual::SetBorderMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setbordermode).</span></span>

### <a name="bitmapinterpolationmode-property"></a><span data-ttu-id="f1949-181">Propriété BitmapInterpolationMode</span><span class="sxs-lookup"><span data-stu-id="f1949-181">BitmapInterpolationMode property</span></span>

<span data-ttu-id="f1949-182">La propriété BitmapInterpolationMode indique à DirectComposition Comment composer une image bitmap lorsqu’elle est transformée de telle sorte qu’il n’existe pas de correspondance un-à-un entre les pixels de la bitmap et les pixels de l’écran.</span><span class="sxs-lookup"><span data-stu-id="f1949-182">The BitmapInterpolationMode property tells DirectComposition how to compose a bitmap when it is transformed such that there is no one-to-one correspondence between pixels in the bitmap and pixels on the screen.</span></span>

<span data-ttu-id="f1949-183">Vous définissez la propriété BitmapInterpolationMode d’un visuel en appelant la méthode [**IDCompositionVisual :: SetBitmapInterpolationMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setbitmapinterpolationmode) .</span><span class="sxs-lookup"><span data-stu-id="f1949-183">You set the BitmapInterpolationMode property of a visual by calling the [**IDCompositionVisual::SetBitmapInterpolationMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setbitmapinterpolationmode) method.</span></span>

### <a name="compositemode-property"></a><span data-ttu-id="f1949-184">Propriété CompositeMode</span><span class="sxs-lookup"><span data-stu-id="f1949-184">CompositeMode property</span></span>

<span data-ttu-id="f1949-185">La propriété CompositeMode indique à DirectComposition comment fusionner le contenu bitmap d’un visuel avec la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="f1949-185">The CompositeMode property tells DirectComposition how to blend the bitmap content of a visual with the render target.</span></span> <span data-ttu-id="f1949-186">Pour obtenir une description des modes composites pris en charge, consultez [**\_ \_ mode composite DCOMPOSITION**](/windows/desktop/api/DcompTypes/ne-dcomptypes-dcomposition_composite_mode).</span><span class="sxs-lookup"><span data-stu-id="f1949-186">For a description of the supported composite modes, see [**DCOMPOSITION\_COMPOSITE\_MODE**](/windows/desktop/api/DcompTypes/ne-dcomptypes-dcomposition_composite_mode).</span></span>

<span data-ttu-id="f1949-187">Vous définissez la propriété CompositeMode d’un visuel en appelant la méthode [**IDCompositionVisual :: SetCompositeMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setcompositemode) .</span><span class="sxs-lookup"><span data-stu-id="f1949-187">You set the CompositeMode property of a visual by calling the [**IDCompositionVisual::SetCompositeMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setcompositemode) method.</span></span>

### <a name="offsetx-and-offsety-properties"></a><span data-ttu-id="f1949-188">OffsetX et propriétés OffsetY</span><span class="sxs-lookup"><span data-stu-id="f1949-188">OffsetX and OffsetY properties</span></span>

<span data-ttu-id="f1949-189">Les propriétés OffsetX et OffsetY indiquent à DirectComposition où positionner un visuel horizontalement et verticalement.</span><span class="sxs-lookup"><span data-stu-id="f1949-189">The OffsetX and OffsetY properties tell DirectComposition where to position a visual horizontally and vertically.</span></span> <span data-ttu-id="f1949-190">Ils définissent la position fixe à deux dimensions à partir de laquelle toutes les transformations et tous les effets du visuel sont calculés.</span><span class="sxs-lookup"><span data-stu-id="f1949-190">They define the two-dimensional fixed position from which all transforms and effects for the visual are calculated.</span></span>

<span data-ttu-id="f1949-191">Pour un visuel racine, les propriétés OffsetX et OffsetY définissent la coordonnée x et la coordonnée y d’un point par rapport à l’angle supérieur gauche de la fenêtre qui héberge le visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-191">For a root visual, the OffsetX and OffsetY properties define the x-coordinate and y-coordinate of a point relative to the upper-left corner of the window that hosts the visual.</span></span> <span data-ttu-id="f1949-192">Pour un visuel enfant, les coordonnées sont relatives à l’angle supérieur gauche du parent ou, si la [propriété TransformParent](#transformparent-property) est spécifiée, à l’angle supérieur gauche du visuel spécifié.</span><span class="sxs-lookup"><span data-stu-id="f1949-192">For a child visual, the coordinates are relative to the upper-left corner of the parent or, if the [TransformParent property](#transformparent-property) is specified, the upper-left corner of the specified visual.</span></span> <span data-ttu-id="f1949-193">Quand un visuel est rendu, il est positionné de telle sorte que l’angle supérieur gauche du visuel coïncide avec les coordonnées spécifiées.</span><span class="sxs-lookup"><span data-stu-id="f1949-193">When a visual is rendered, it is positioned such that the visual's upper-left corner coincides with the specified coordinates.</span></span>

<span data-ttu-id="f1949-194">Vous définissez les propriétés OffsetX et OffsetY d’un visuel en appelant les méthodes [**IDCompositionVisual :: SetOffsetX**](/previous-versions/windows/desktop/legacy/hh449126(v=vs.85)) et [**SetOffsetY**](/previous-versions/windows/desktop/legacy/hh449131(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="f1949-194">You set the OffsetX and OffsetY properties of a visual by calling the [**IDCompositionVisual::SetOffsetX**](/previous-versions/windows/desktop/legacy/hh449126(v=vs.85)) and [**SetOffsetY**](/previous-versions/windows/desktop/legacy/hh449131(v=vs.85)) methods.</span></span>

### <a name="effect-property"></a><span data-ttu-id="f1949-195">Propriété Effect</span><span class="sxs-lookup"><span data-stu-id="f1949-195">Effect property</span></span>

<span data-ttu-id="f1949-196">La propriété Effect vous permet de spécifier un effet ou un groupe d’effets qui modifiera la façon dont un visuel et sa sous-arborescence sont composés.</span><span class="sxs-lookup"><span data-stu-id="f1949-196">The Effect property lets you specify an effect, or group of effects, that will modify how a visual and its subtree is composed.</span></span> <span data-ttu-id="f1949-197">Par exemple, vous pouvez spécifier des effets qui contrôlent l’opacité d’un visuel, fusionner le visuel avec un autre bitmap de différentes façons et appliquer des transformations de perspective à l’visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-197">For example, you can specify effects that control the opacity of a visual, blend the visual with another bitmap in various ways, and apply perspective transforms to the visual.</span></span>

<span data-ttu-id="f1949-198">Vous définissez la propriété Effect d’un visuel en appelant la méthode [**IDCompositionVisual :: SetEffect**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-seteffect) .</span><span class="sxs-lookup"><span data-stu-id="f1949-198">You set the Effect property of a visual by calling the [**IDCompositionVisual::SetEffect**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-seteffect) method.</span></span>

<span data-ttu-id="f1949-199">Pour plus d’informations, consultez [Effets](effects.md).</span><span class="sxs-lookup"><span data-stu-id="f1949-199">For more information, see [Effects](effects.md).</span></span>

### <a name="transform-property"></a><span data-ttu-id="f1949-200">Transform (propriété)</span><span class="sxs-lookup"><span data-stu-id="f1949-200">Transform property</span></span>

<span data-ttu-id="f1949-201">La propriété Transform spécifie une transformation à deux dimensions (2D), ou un groupe de transformations 2D, que DirectComposition doit effectuer sur le visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-201">The Transform property specifies a two-dimensional (2D) transformation, or group of 2D transformations, for DirectComposition to perform on the visual.</span></span> <span data-ttu-id="f1949-202">Une transformation (ou transformation) est une opération qui modifie le système de coordonnées d’un visuel par rapport à son parent, ou par rapport au visuel spécifié par la [propriété TransformParent](#transformparent-property).</span><span class="sxs-lookup"><span data-stu-id="f1949-202">A transformation (or transform) is an operation that modifies the coordinate system of a visual relative to its parent, or relative to the visual specified by the [TransformParent property](#transformparent-property).</span></span> <span data-ttu-id="f1949-203">Vous pouvez utiliser les transformations pour modifier la position, la taille ou la nature d’un visuel en le déplaçant vers un autre emplacement (translation), en le rendant plus grand ou plus petit (mise à l’échelle), en le transformant (rotation), en déformant sa forme (inclinaison), et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="f1949-203">You can use transforms to alter the position, size, or nature of a visual by moving it to another location (translation), making it larger or smaller (scaling), turning it (rotation), distorting its shape (skewing), and so on.</span></span>

<span data-ttu-id="f1949-204">Vous définissez la propriété de transformation d’un visuel en appelant la méthode [**IDCompositionVisual :: setTransform**](/previous-versions/windows/desktop/legacy/hh449178(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="f1949-204">You set the Transform property of a visual by calling the [**IDCompositionVisual::SetTransform**](/previous-versions/windows/desktop/legacy/hh449178(v=vs.85)) method.</span></span>

<span data-ttu-id="f1949-205">Pour plus d’informations, consultez l’article [Transforms (Transformations MSBuild)](transforms.md).</span><span class="sxs-lookup"><span data-stu-id="f1949-205">For more information, see [Transforms](transforms.md).</span></span>

### <a name="transformparent-property"></a><span data-ttu-id="f1949-206">Propriété TransformParent</span><span class="sxs-lookup"><span data-stu-id="f1949-206">TransformParent property</span></span>

<span data-ttu-id="f1949-207">Le système de coordonnées d’un visuel est modifié par les propriétés OffsetX, OffsetY et Transform.</span><span class="sxs-lookup"><span data-stu-id="f1949-207">The coordinate system of a visual is modified by the OffsetX, OffsetY, and Transform properties.</span></span> <span data-ttu-id="f1949-208">Normalement, ces propriétés définissent le système de coordonnées d’un visuel par rapport à son parent immédiat.</span><span class="sxs-lookup"><span data-stu-id="f1949-208">Normally, these properties define the coordinate system of a visual relative to its immediate parent.</span></span> <span data-ttu-id="f1949-209">Pour utiliser un visuel autre que le parent comme base pour le système de coordonnées d’un visuel enfant, utilisez la propriété TransformParent pour spécifier un visuel différent comme « parent » à des fins de transformation.</span><span class="sxs-lookup"><span data-stu-id="f1949-209">To use some visual other than the parent as the basis for the coordinate system of a child visual, use the TransformParent property to specify a different visual as the "parent" for transform purposes.</span></span>

<span data-ttu-id="f1949-210">Vous définissez la propriété TransformParent d’un visuel en appelant la méthode [**IDCompositionVisual :: SetTransformParent**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-settransformparent) .</span><span class="sxs-lookup"><span data-stu-id="f1949-210">You set the TransformParent property of a visual by calling the [**IDCompositionVisual::SetTransformParent**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-settransformparent) method.</span></span>

## <a name="device-object"></a><span data-ttu-id="f1949-211">Objet d’appareil</span><span class="sxs-lookup"><span data-stu-id="f1949-211">Device object</span></span>

<span data-ttu-id="f1949-212">Pour utiliser DirectComposition, vous devez créer et manipuler une variété d’objets COM (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="f1949-212">To use DirectComposition, you must create and manipulate a variety of Component Object Model (COM) objects.</span></span> <span data-ttu-id="f1949-213">Le premier objet que vous devez créer est l' *objet appareil* DirectComposition, car il sert de fabrique pour la création de tous les autres objets utilisés dans une composition.</span><span class="sxs-lookup"><span data-stu-id="f1949-213">The first object that you need to create is the DirectComposition *device object* because it serves as the factory for creating all other objects used in a composition.</span></span>

<span data-ttu-id="f1949-214">Vous créez un objet appareil en appelant la fonction [**DCompositionCreateDevice**](/windows/desktop/api/Dcomp/nf-dcomp-dcompositioncreatedevice) , qui retourne un pointeur d’interface [**IDCompositionDevice**](/windows/win32/api/dcomp/nn-dcomp-idcompositiondevice) .</span><span class="sxs-lookup"><span data-stu-id="f1949-214">You create a device object by calling the [**DCompositionCreateDevice**](/windows/desktop/api/Dcomp/nf-dcomp-dcompositioncreatedevice) function, which returns an [**IDCompositionDevice**](/windows/win32/api/dcomp/nn-dcomp-idcompositiondevice) interface pointer.</span></span> <span data-ttu-id="f1949-215">Cette interface expose un ensemble de méthodes que vous utilisez pour créer des objets visuels, des objets clip, des objets d’animation, des objets Transform, des objets Effects, etc.</span><span class="sxs-lookup"><span data-stu-id="f1949-215">This interface exposes a set of methods that you use to create visual objects, clip objects, animation objects, transform objects, effect objects, and so on.</span></span>

<span data-ttu-id="f1949-216">L’objet appareil a une autre finalité que d’être une fabrique pour la création d’autres objets.</span><span class="sxs-lookup"><span data-stu-id="f1949-216">The device object serves one other purpose besides being a factory for creating other objects.</span></span> <span data-ttu-id="f1949-217">Il expose une méthode appelée [**Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) qui passe une arborescence d’éléments visuels à DirectComposition pour traitement.</span><span class="sxs-lookup"><span data-stu-id="f1949-217">It exposes a method called [**Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) that passes a visual tree to DirectComposition for processing.</span></span> <span data-ttu-id="f1949-218">Pour plus d’informations, consultez [composition transactionnelle](#transactional-composition).</span><span class="sxs-lookup"><span data-stu-id="f1949-218">For more information, see [Transactional Composition](#transactional-composition).</span></span>

<span data-ttu-id="f1949-219">N’oubliez pas que, bien que vous puissiez créer plusieurs instances de l’objet appareil dans votre application, tous les objets que vous utilisez dans une composition particulière doivent être créés par le même objet appareil, à une exception près : vous pouvez combiner des objets visuels de différents objets appareil dans la même arborescence d’éléments visuels.</span><span class="sxs-lookup"><span data-stu-id="f1949-219">Remember that, while you can create multiple instances of the device object in your application, all of the objects that you use in a particular composition must be created by the same device object—with one exception: You can combine visual objects from different device objects in the same visual tree.</span></span> <span data-ttu-id="f1949-220">Dans ce cas, DirectComposition traite l’arborescence d’éléments visuels comme il le ferait normalement, sauf que les modifications apportées à un objet visuel particulier dans l’arborescence prennent effet uniquement lorsque la méthode de [**validation**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) est appelée sur l’objet appareil qui a créé l’objet visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-220">When you do so, DirectComposition treats the visual tree as it normally would, except that changes to a particular visual object in the tree take effect only when the [**Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) method is called on the device object that created the visual object.</span></span>

<span data-ttu-id="f1949-221">La possibilité d’utiliser des visuels à partir de différents appareils dans la même arborescence d’éléments visuels permet à plusieurs threads de créer et de manipuler une arborescence d’éléments visuels unique tout en conservant deux appareils indépendants qui peuvent être utilisés pour valider les modifications de manière asynchrone.</span><span class="sxs-lookup"><span data-stu-id="f1949-221">The ability to use visuals from different devices in the same visual tree enables multiple threads to create and manipulate a single visual tree while maintaining two independent devices that can be used to commit changes asynchronously.</span></span> <span data-ttu-id="f1949-222">Pour plus d’informations, consultez [arborescences d’éléments visuels entre appareils](#cross-device-visual-trees).</span><span class="sxs-lookup"><span data-stu-id="f1949-222">For more information, see [Cross-Device Visual Trees](#cross-device-visual-trees).</span></span>

## <a name="composition-target-window"></a><span data-ttu-id="f1949-223">Fenêtre cible de la composition</span><span class="sxs-lookup"><span data-stu-id="f1949-223">Composition target window</span></span>

<span data-ttu-id="f1949-224">Une arborescence d’éléments visuels doit être liée à une fenêtre avant que l’un des visuels de l’arborescence ne puisse être affiché à l’écran.</span><span class="sxs-lookup"><span data-stu-id="f1949-224">A visual tree must be bound to a window before any of the tree's visuals can be displayed on the screen.</span></span> <span data-ttu-id="f1949-225">La fenêtre, appelée fenêtre *cible* de la composition, peut être une fenêtre de niveau supérieur ou une fenêtre enfant.</span><span class="sxs-lookup"><span data-stu-id="f1949-225">The window, called the *composition target window*, can be a top-level window or a child window.</span></span> <span data-ttu-id="f1949-226">En outre, la fenêtre cible de la composition peut être une fenêtre superposée. autrement dit, il peut avoir le style de fenêtre en [**\_ \_ couches WS ex**](/windows/desktop/winmsg/extended-window-styles) .</span><span class="sxs-lookup"><span data-stu-id="f1949-226">Also, the composition target window can be a layered window; that is, it can have the [**WS\_EX\_LAYERED**](/windows/desktop/winmsg/extended-window-styles) window style.</span></span>

<span data-ttu-id="f1949-227">DirectComposition permet à une application de lier au maximum deux arborescences visuelles à chaque fenêtre.</span><span class="sxs-lookup"><span data-stu-id="f1949-227">DirectComposition allows an application to bind a maximum of two visual trees to each window.</span></span> <span data-ttu-id="f1949-228">Les arborescences d’éléments visuels incluent une qui est composée en haut de la fenêtre elle-même, mais derrière toutes les fenêtres enfants de la fenêtre, et une autre composée en haut de la fenêtre et en haut des fenêtres enfants.</span><span class="sxs-lookup"><span data-stu-id="f1949-228">The visual trees include one that is composed on top of the window itself, but behind all of the window’s child windows, and another that is composed on top of the window and on top of the child windows.</span></span> <span data-ttu-id="f1949-229">En d’autres termes, chaque fenêtre possède quatre couches conceptuelles, et toutes les couches sont découpées vers la région visible de la fenêtre cible.</span><span class="sxs-lookup"><span data-stu-id="f1949-229">In other words, each window has four conceptual layers, and all layers are clipped to the target window's visible region.</span></span> <span data-ttu-id="f1949-230">L’illustration suivante montre les quatre couches conceptuelles d’une fenêtre.</span><span class="sxs-lookup"><span data-stu-id="f1949-230">The following illustration shows the four conceptual layers of a window.</span></span>

![couches conceptuelles d’une fenêtre](images/directcomposition-layers.png)

## <a name="transactional-composition"></a><span data-ttu-id="f1949-232">Composition transactionnelle</span><span class="sxs-lookup"><span data-stu-id="f1949-232">Transactional composition</span></span>

<span data-ttu-id="f1949-233">DirectComposition utilise un modèle transactionnel dans lequel vous créez un ensemble de modifications par lot dans un visuel, puis « validez » le jeu à DirectComposition pour le traitement en tout.</span><span class="sxs-lookup"><span data-stu-id="f1949-233">DirectComposition uses a transactional model where you create a batched set of changes to a visual and then "commit" the set to DirectComposition for processing all at once.</span></span> <span data-ttu-id="f1949-234">Vous pouvez modifier le même objet visuel DirectComposition et valider les modifications autant de fois que vous le voulez.</span><span class="sxs-lookup"><span data-stu-id="f1949-234">You can modify the same DirectComposition visual object and commit the changes any number of times.</span></span> <span data-ttu-id="f1949-235">Lorsque le Gestionnaire de fenêtrage (DWM) sélectionne des lots, il récupère tous les lots en attente et les applique à l’image suivante dans l’ordre dans lequel ils ont été validés.</span><span class="sxs-lookup"><span data-stu-id="f1949-235">When the Desktop Window Manager (DWM) picks up batches, it picks up all pending batches and applies them to the next frame in the order they were committed.</span></span>

<span data-ttu-id="f1949-236">Toutes les modifications au sein d’une seule validation sont assurées d’être appliquées à une seule trame.</span><span class="sxs-lookup"><span data-stu-id="f1949-236">All changes within a single commit are guaranteed to be applied to a single frame.</span></span> <span data-ttu-id="f1949-237">Étant donné que DWM collecte les lots une fois par Frame, vous ne pouvez modifier un objet particulier qu’une seule fois par image.</span><span class="sxs-lookup"><span data-stu-id="f1949-237">Because DWM collects batches once per frame, you can modify any particular object only once per frame.</span></span> <span data-ttu-id="f1949-238">Les validations suivantes qui modifient différents objets peuvent également être appliquées au frame actuel, mais DirectComposition ne garantit pas que les modifications se produiront dans le même frame.</span><span class="sxs-lookup"><span data-stu-id="f1949-238">Subsequent commits that modify different objects might also be applied to the current frame, but DirectComposition does not guarantee that the changes will occur in the same frame.</span></span>

<span data-ttu-id="f1949-239">Les méthodes [**IDCompositionSurface :: BeginDraw**](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-begindraw) et [**IDCompositionSurface :: EndDraw**](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-enddraw) vous permettent de synchroniser les mises à jour de rendu avec les mises à jour visuelles.</span><span class="sxs-lookup"><span data-stu-id="f1949-239">The [**IDCompositionSurface::BeginDraw**](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-begindraw) and [**IDCompositionSurface::EndDraw**](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-enddraw) methods let you synchronize rendering updates with visual updates.</span></span> <span data-ttu-id="f1949-240">Par exemple, vous pouvez appeler **IDCompositionSurface :: BeginDraw**, mettre à jour les OffsetX et les propriétés de clip d’un élément visuel, appeler [**IDCompositionDevice :: Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit), dessiner le contenu avec Microsoft DirectX, puis appeler **IDCompositionSurface :: EndDraw**.</span><span class="sxs-lookup"><span data-stu-id="f1949-240">For example, you can call **IDCompositionSurface::BeginDraw**, update the OffsetX and Clip properties of a visual, call [**IDCompositionDevice::Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit), draw content with Microsoft DirectX, and then call **IDCompositionSurface::EndDraw**.</span></span> <span data-ttu-id="f1949-241">Dans ce cas, Microsoft DirectComposition garantit que le contenu de la bitmap et les propriétés visuelles sont mis à jour en même temps.</span><span class="sxs-lookup"><span data-stu-id="f1949-241">In this case, Microsoft DirectComposition ensures that bitmap content and the visual properties are updated at the same time.</span></span>

### <a name="batching"></a><span data-ttu-id="f1949-242">Traitement par lot</span><span class="sxs-lookup"><span data-stu-id="f1949-242">Batching</span></span>

<span data-ttu-id="f1949-243">Vous pouvez valider plusieurs modifications dans le même visuel, ou plusieurs modifications dans différents visuels, au sein du même frame.</span><span class="sxs-lookup"><span data-stu-id="f1949-243">You can commit multiple changes to the same visual, or multiple changes to different visuals, within the same frame.</span></span> <span data-ttu-id="f1949-244">Lorsque vous apportez plusieurs modifications au même visuel dans le même cadre, gardez les points suivants à l’esprit :</span><span class="sxs-lookup"><span data-stu-id="f1949-244">When making multiple changes to the same visual within the same frame, keep the following points in mind:</span></span>

-   <span data-ttu-id="f1949-245">Si vous apportez plusieurs modifications à la même propriété d’un visuel, seule la dernière modification est appliquée.</span><span class="sxs-lookup"><span data-stu-id="f1949-245">If you make multiple changes to the same property of a visual, only the last change is applied.</span></span> <span data-ttu-id="f1949-246">Par exemple, si vous définissez l’opacité sur 0, puis sur 0,5 et enfin sur 1,0, seule une opacité de 1,0 est appliquée au visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-246">For example, if you set the opacity to 0, then to 0.5, and finally to 1.0, only an opacity of 1.0 is applied to the visual.</span></span>
-   <span data-ttu-id="f1949-247">Si vous modifiez plusieurs propriétés du même visuel, DirectComposition applique les modifications d’abord au visuel, puis à tous les visuels enfants.</span><span class="sxs-lookup"><span data-stu-id="f1949-247">If you change multiple properties of the same visual, DirectComposition applies the changes first to the visual and then to any child visuals.</span></span> <span data-ttu-id="f1949-248">Les propriétés sont appliquées dans l’ordre suivant, quel que soit l’ordre dans lequel vous les spécifiez :</span><span class="sxs-lookup"><span data-stu-id="f1949-248">The properties are applied in the following order regardless of the order in which you specify them:</span></span>

    1.  <span data-ttu-id="f1949-249">Offset</span><span class="sxs-lookup"><span data-stu-id="f1949-249">Offset</span></span>
    2.  <span data-ttu-id="f1949-250">Transformer</span><span class="sxs-lookup"><span data-stu-id="f1949-250">Transform</span></span>
    3.  <span data-ttu-id="f1949-251">Découper</span><span class="sxs-lookup"><span data-stu-id="f1949-251">Clip</span></span>
    4.  <span data-ttu-id="f1949-252">Résultat</span><span class="sxs-lookup"><span data-stu-id="f1949-252">Effect</span></span>

    <span data-ttu-id="f1949-253">L’illustration suivante montre le résultat de l’application de l’ensemble des quatre propriétés à un visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-253">The following illustration shows the result of applying all four properties to a visual.</span></span>

    ![résultat de l’application de l’ensemble des quatre propriétés à un visuel](images/order-of-properties.png)

    <span data-ttu-id="f1949-255">N’oubliez pas que toutes les modifications sont appliquées simultanément au visuel dans le contexte du même frame.</span><span class="sxs-lookup"><span data-stu-id="f1949-255">Remember that all changes are applied to the visual at once within the context of the same frame.</span></span> <span data-ttu-id="f1949-256">Cela signifie que, du point de vue de l’utilisateur, les modifications apportées au visuel se produisent instantanément.</span><span class="sxs-lookup"><span data-stu-id="f1949-256">This means that, from the user's perspective, the changes to the visual occur instantaneously.</span></span>

-   <span data-ttu-id="f1949-257">Pour la propriété Transform, vous pouvez utiliser [**IDCompositionDevice :: CreateTransformGroup**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createtransformgroup) pour créer un groupe de transformations à appliquer simultanément à un visuel.</span><span class="sxs-lookup"><span data-stu-id="f1949-257">For the Transform property, you can use [**IDCompositionDevice::CreateTransformGroup**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createtransformgroup) to create a group of transforms to apply to a visual all at once.</span></span> <span data-ttu-id="f1949-258">DirectComposition applique les transformations dans l’ordre que vous spécifiez.</span><span class="sxs-lookup"><span data-stu-id="f1949-258">DirectComposition applies the transforms in the order that you specify.</span></span>
-   <span data-ttu-id="f1949-259">Pour la propriété Effect, vous pouvez utiliser [**IDCompositionEffectGroup**](/windows/win32/api/dcomp/nn-dcomp-idcompositioneffectgroup) pour appliquer un groupe d’effets.</span><span class="sxs-lookup"><span data-stu-id="f1949-259">For the Effect property, you can use [**IDCompositionEffectGroup**](/windows/win32/api/dcomp/nn-dcomp-idcompositioneffectgroup) to apply a group of effects.</span></span> <span data-ttu-id="f1949-260">DirectComposition applique les effets dans l’ordre que vous spécifiez.</span><span class="sxs-lookup"><span data-stu-id="f1949-260">DirectComposition applies the effects in the order that you specify.</span></span> <span data-ttu-id="f1949-261">En outre, les transformations de perspective 3D entraînent l’aplatissement de l’arborescence d’éléments visuels après que toutes les transformations 3D de l’objet visuel en cours ont été appliquées.</span><span class="sxs-lookup"><span data-stu-id="f1949-261">In addition, 3D perspective transformations result in flattening of the visual tree after all 3D transformations in the current visual have been applied.</span></span> <span data-ttu-id="f1949-262">Cela permet de s’assurer que le visuel obtenu semble le plus proche possible de la 3D.</span><span class="sxs-lookup"><span data-stu-id="f1949-262">This helps ensure that the resulting visual looks as close to 3D as possible.</span></span>

### <a name="synchronization"></a><span data-ttu-id="f1949-263">Synchronization</span><span class="sxs-lookup"><span data-stu-id="f1949-263">Synchronization</span></span>

<span data-ttu-id="f1949-264">Votre application peut appeler DirectComposition à partir de plusieurs threads en même temps.</span><span class="sxs-lookup"><span data-stu-id="f1949-264">Your application can call DirectComposition from multiple threads at the same time.</span></span> <span data-ttu-id="f1949-265">L’ordre d’exécution est garanti pour les appels séquentiels, mais pas pour les appels simultanés.</span><span class="sxs-lookup"><span data-stu-id="f1949-265">The order of execution is guaranteed for sequential calls, but not for concurrent calls.</span></span> <span data-ttu-id="f1949-266">Par exemple, si le thread A modifie un visuel et que le thread B valide le lot en même temps, il n’est pas défini si cette modification visuelle est incluse dans le lot validé ou si elle démarre un nouveau lot.</span><span class="sxs-lookup"><span data-stu-id="f1949-266">For example, if thread A modifies a visual and thread B commits the batch at the same time, it is not defined whether that visual change is included in the committed batch or whether it starts a new batch.</span></span> <span data-ttu-id="f1949-267">En revanche, si votre application utilise d’autres mécanismes de synchronisation pour s’assurer qu’une méthode est appelée avant l’autre, DirectComposition honore l’ordre d’appel et les traite comme si les deux appels étaient émis dans cet ordre à partir d’un thread unique.</span><span class="sxs-lookup"><span data-stu-id="f1949-267">On the other hand, if your application uses other synchronization mechanisms to ensure that one method is called before the other, DirectComposition honors the call order and processes them as if both calls were issued in that order from a single thread.</span></span>

### <a name="cross-device-visual-trees"></a><span data-ttu-id="f1949-268">Arborescences d’éléments visuels entre appareils</span><span class="sxs-lookup"><span data-stu-id="f1949-268">Cross-device visual trees</span></span>

<span data-ttu-id="f1949-269">Les objets DirectComposition ne sont pas liés aux threads ; vous pouvez utiliser plusieurs threads pour modifier le même jeu d’objets.</span><span class="sxs-lookup"><span data-stu-id="f1949-269">DirectComposition objects are not thread bound; you can use multiple threads to modify the same set of objects.</span></span> <span data-ttu-id="f1949-270">Toutefois, tenez compte des problèmes suivants lors du partage du même objet d’appareil.</span><span class="sxs-lookup"><span data-stu-id="f1949-270">However, be aware of the following issues when sharing the same device object.</span></span>

-   <span data-ttu-id="f1949-271">Les deux threads doivent être en mesure d’appeler [**IDCompositionDevice :: Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit).</span><span class="sxs-lookup"><span data-stu-id="f1949-271">Both threads need to be able to call [**IDCompositionDevice::Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit).</span></span> <span data-ttu-id="f1949-272">Si un seul des threads appelle **IDCompositionDevice :: Commit**, l’autre thread ne peut pas valider les modifications apportées à DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="f1949-272">If only one of the threads calls **IDCompositionDevice::Commit**, the other thread cannot commit any of its changes to DirectComposition.</span></span>
-   <span data-ttu-id="f1949-273">Le comportement transactionnel peut être perdu si un thread appelle [**IDCompositionDevice :: Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) alors que l’autre thread effectue encore des modifications destinées à faire partie de la même transaction.</span><span class="sxs-lookup"><span data-stu-id="f1949-273">Transactional behavior might be lost if one thread calls [**IDCompositionDevice::Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) while the other thread is still making changes that are intended to be part of the same transaction.</span></span>

<span data-ttu-id="f1949-274">Si vous devez valider plusieurs transactions simultanées dans DirectComposition, vous devez utiliser plusieurs objets d’appareil, éventuellement à partir de plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="f1949-274">If you need to commit multiple simultaneous transactions to DirectComposition, you must use multiple device objects, possibly from multiple threads.</span></span> <span data-ttu-id="f1949-275">Dans ce scénario, la même arborescence d’éléments visuels est partagée par les deux objets d’appareil, et chaque objet d’appareil valide ses propres transactions.</span><span class="sxs-lookup"><span data-stu-id="f1949-275">In this scenario, the same visual tree is shared by both device objects, and each device object commits its own transactions.</span></span>

<span data-ttu-id="f1949-276">L’illustration suivante montre une arborescence d’éléments visuels partagée par deux objets d’appareil.</span><span class="sxs-lookup"><span data-stu-id="f1949-276">The following illustration shows a visual tree that is shared by two device objects.</span></span> <span data-ttu-id="f1949-277">Les éléments visuels 1, 2, 4 et 5 sont détenus par un appareil ou l’autre, mais Visual 3 est partagé par les deux appareils et peut donc être utilisé pour connecter deux sous-arbres dans une arborescence d’éléments visuels unique et plus grande.</span><span class="sxs-lookup"><span data-stu-id="f1949-277">Visuals 1, 2, 4 and 5 are owned by one device or the other, but visual 3 is shared by both devices, and can therefore be used to connect two sub-trees into a single, larger visual tree.</span></span> <span data-ttu-id="f1949-278">Le partage de l’arborescence d’éléments visuels permet aux deux appareils d’être manipulés à partir de deux threads différents de manière asynchrone.</span><span class="sxs-lookup"><span data-stu-id="f1949-278">Sharing the visual tree allows the two devices to be manipulated from two different threads asynchronously.</span></span>

![arborescence d’éléments visuels partagée par deux appareils](images/shared-visual-tree-1.png)

<span data-ttu-id="f1949-280">Pour illustrer l’utilité du partage d’une arborescence d’éléments visuels entre deux appareils, envisagez une architecture qui permet une entrée tactile à faible latence.</span><span class="sxs-lookup"><span data-stu-id="f1949-280">To illustrate the usefulness of sharing a visual tree between two devices, consider an architecture that enables low-latency touch input.</span></span> <span data-ttu-id="f1949-281">L’architecture peut utiliser deux threads, un qui gère la plupart des tâches d’interface utilisateur et un deuxième thread dédié au traitement des événements d’entrée tactile.</span><span class="sxs-lookup"><span data-stu-id="f1949-281">The architecture could use two threads, one that handles most UI tasks, and a second thread dedicated to processing touch input events.</span></span> <span data-ttu-id="f1949-282">Le thread tactile met à jour la transformation d’un visuel particulier en fonction du mouvement d’entrée utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f1949-282">The touch thread updates the transform of a particular visual based on the user input gesture.</span></span> <span data-ttu-id="f1949-283">En mettant à jour la transformation, le thread tactile peut rendre l’intégralité de la sous-arborescence sous cet visuel suivre le doigt de l’utilisateur, monter ou baisser en puissance à mesure que l’utilisateur exécute un mouvement tactile multipoint, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="f1949-283">By updating the transform, the touch thread can make the entire subtree under that visual follow the user’s finger, scale up or down as the user executes a multi-touch gesture, and so on.</span></span> <span data-ttu-id="f1949-284">Le thread d’interface utilisateur conserve la propriété de la majeure partie de l’arborescence de composition, avec le thread tactile qui possède uniquement les éléments visuels marqués pour une réponse tactile asynchrone.</span><span class="sxs-lookup"><span data-stu-id="f1949-284">The UI thread retains ownership of most of the composition tree, with the touch thread owning only the few visuals that are tagged for asynchronous touch response.</span></span> <span data-ttu-id="f1949-285">L’illustration suivante montre une version simplifiée d’une telle arborescence de composition :</span><span class="sxs-lookup"><span data-stu-id="f1949-285">The following illustration shows a simplified version of such a composition tree:</span></span>

![arborescence d’éléments visuels partagée entre un thread d’interface utilisateur et un thread tactile](images/shared-visual-tree-2.png)

<span data-ttu-id="f1949-287">En règle générale, le thread d’interface utilisateur modifie uniquement les visuels qu’il possède exclusivement, et le thread tactile modifie uniquement le visuel partagé.</span><span class="sxs-lookup"><span data-stu-id="f1949-287">Typically, the UI thread modifies only the visuals that it owns exclusively, and the touch thread modifies only the shared visual.</span></span> <span data-ttu-id="f1949-288">La seule exception se produit lors de la création ou de la destruction d’une sous-arborescence tactile.</span><span class="sxs-lookup"><span data-stu-id="f1949-288">The only exception occurs when creating or destroying a touch-enabled subtree.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f1949-289">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f1949-289">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f1949-290">**IDCompositionSurface :: BeginDraw**</span><span class="sxs-lookup"><span data-stu-id="f1949-290">**IDCompositionSurface::BeginDraw**</span></span>](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-begindraw)
</dt> <dt>

[<span data-ttu-id="f1949-291">**IDCompositionSurface :: EndDraw**</span><span class="sxs-lookup"><span data-stu-id="f1949-291">**IDCompositionSurface::EndDraw**</span></span>](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-enddraw)
</dt> <dt>

[<span data-ttu-id="f1949-292">**IDCompositonDevice :: Commit**</span><span class="sxs-lookup"><span data-stu-id="f1949-292">**IDCompositonDevice::Commit**</span></span>](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit)
</dt> <dt>

[<span data-ttu-id="f1949-293">Concepts DirectComposition</span><span class="sxs-lookup"><span data-stu-id="f1949-293">DirectComposition Concepts</span></span>](directcomposition-concepts.md)
</dt> </dl>

 

 