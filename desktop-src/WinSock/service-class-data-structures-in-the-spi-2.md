---
description: Quand une nouvelle classe de service est installée, une structure WSASERVICECLASSINFO doit être préparée et fournie. Cette structure se compose également de sous-structures qui contiennent une série de paramètres qui s’appliquent à des espaces de noms spécifiques.
ms.assetid: fb225e0c-a0c7-44e1-80fb-7b924b371afa
title: Structures de données de classe de service dans SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b5bf249c7437751e7c6d08b2fdf3830e92921ce7
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/12/2021
ms.locfileid: "104566727"
---
# <a name="service-class-data-structures-in-the-spi"></a><span data-ttu-id="dfab7-104">Structures de données de classe de service dans SPI</span><span class="sxs-lookup"><span data-stu-id="dfab7-104">Service Class Data Structures in the SPI</span></span>

<span data-ttu-id="dfab7-105">Quand une nouvelle classe de service est installée, une structure [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) doit être préparée et fournie.</span><span class="sxs-lookup"><span data-stu-id="dfab7-105">When a new service class is installed, a [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure must be prepared and supplied.</span></span> <span data-ttu-id="dfab7-106">Cette structure se compose également de sous-structures qui contiennent une série de paramètres qui s’appliquent à des espaces de noms spécifiques.</span><span class="sxs-lookup"><span data-stu-id="dfab7-106">This structure also consists of substructures that contain a series of parameters that apply to specific namespaces.</span></span>

![Diagramme montrant la structure WSASERVICECLASSINFO, les sous-structures et les paramètres qui s’appliquent à des espaces de noms spécifiques.](images/ovrvw3-3.png)

<span data-ttu-id="dfab7-108">Pour chaque classe de service, il existe une seule structure [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) .</span><span class="sxs-lookup"><span data-stu-id="dfab7-108">For each service class, there is a single [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure.</span></span> <span data-ttu-id="dfab7-109">Dans la structure **WSASERVICECLASSINFO** , l’identificateur unique de la classe de service est contenu dans **lpServiceClassId**, et une chaîne d’affichage associée est référencée par **lpServiceClassName**.</span><span class="sxs-lookup"><span data-stu-id="dfab7-109">Within the **WSASERVICECLASSINFO** structure, the service class's unique identifier is contained in **lpServiceClassId**, and an associated display string is referenced by **lpServiceClassName**.</span></span>

<span data-ttu-id="dfab7-110">Le membre **lpClassInfos** de la structure [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) fait référence à un tableau de structures [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) , chacune d’elles fournissant un paramètre nommé et typé qui s’applique à un espace de noms spécifié.</span><span class="sxs-lookup"><span data-stu-id="dfab7-110">The **lpClassInfos** member in the [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure references an array of [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) structures, each of which supplies a named and typed parameter that applies to a specified namespace.</span></span> <span data-ttu-id="dfab7-111">Exemples de valeurs pour le membre **lpszName** : sapid, TCPPORT, UDPPORT, etc. Ces chaînes sont généralement spécifiques à l’espace de noms identifié dans **dwNameSpace**.</span><span class="sxs-lookup"><span data-stu-id="dfab7-111">Examples of values for the **lpszName** member include: SAPID, TCPPORT, UDPPORT, etc. These strings are generally specific to the namespace identified in **dwNameSpace**.</span></span> <span data-ttu-id="dfab7-112">Les valeurs standard pour **dwValueType** peuvent être reg \_ DWORD, reg \_ SZ, etc. Le membre **dwValueSize** indique la longueur de l’élément de données vers lequel pointe **lpValue**.</span><span class="sxs-lookup"><span data-stu-id="dfab7-112">Typical values for **dwValueType** might be REG\_DWORD, REG\_SZ, etc. The **dwValueSize** member indicates the length of the data item pointed to by **lpValue**.</span></span>

<span data-ttu-id="dfab7-113">L’intégralité de la collection de données représentée dans une structure [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) est fournie à chaque fournisseur d’espace de noms via [**NSPInstallServiceClass**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass).</span><span class="sxs-lookup"><span data-stu-id="dfab7-113">The entire collection of data represented in a [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure is provided to each namespace provider via [**NSPInstallServiceClass**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass).</span></span> <span data-ttu-id="dfab7-114">Chaque fournisseur d’espace de noms individuel passe ensuite en revue la liste des structures [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) et conserve les informations qui lui sont applicables.</span><span class="sxs-lookup"><span data-stu-id="dfab7-114">Each individual namespace provider then sifts through the list of [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) structures and retain the information applicable to it.</span></span> <span data-ttu-id="dfab7-115">Cette architecture permet également d’obtenir l’existence future d’un fournisseur d’espaces de noms spécial qui conservera toutes les informations de schéma de la classe de service pour tous les espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="dfab7-115">This architecture also envisions the future existence of a special namespace provider that would retain all of the service class schema information for all of the namespaces.</span></span> <span data-ttu-id="dfab7-116">L' \_32.dll Ws2 interroge ce fournisseur pour obtenir les données **WSASERVICECLASSINFO** nécessaires pour fournir aux fournisseurs d’espaces de noms lorsque [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin) est appelé pour initier une requête, et lorsque [**NSPSetService**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice) est appelé pour inscrire un service.</span><span class="sxs-lookup"><span data-stu-id="dfab7-116">The Ws2\_32.dll would query this provider to obtain the **WSASERVICECLASSINFO** data needed to supply to namespace providers when [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin) is invoked to initiate a query, and when [**NSPSetService**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice) is invoked to register a service.</span></span> <span data-ttu-id="dfab7-117">Le fournisseur d’espaces de noms ne doit pas s’appuyer sur cette fonctionnalité pour le moment et doit disposer d’un moyen spécifique au fournisseur pour obtenir les informations de schéma de classe de service nécessaires.</span><span class="sxs-lookup"><span data-stu-id="dfab7-117">Namespace provider should not rely on this capability for the time being, and should instead have a provider-specific means to obtain any needed service class schema information.</span></span> <span data-ttu-id="dfab7-118">En l’absence d’un fournisseur qui stocke tous les schémas de classe de service pour tous les espaces de noms, le \_32.dll Ws2 utilise [**NSPGetServiceClassInfo**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspgetserviceclassinfo) pour obtenir ces informations de chaque fournisseur d’espace de noms individuel.</span><span class="sxs-lookup"><span data-stu-id="dfab7-118">In the absence of a provider that stores all service class schema for all namespaces, the Ws2\_32.dll will use [**NSPGetServiceClassInfo**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspgetserviceclassinfo) to obtain such information from each individual namespace provider.</span></span>

 

 



