---
description: Les données hors bande (OOB) sont un canal de transmission logiquement indépendant associé à une paire de sockets de flux connectés.
ms.assetid: 30f667cd-5be9-45f2-9d55-bff04834078f
title: Protocole IndependentOut-of-band Data in the SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b53e5c7c5c8c8ad7a5985ec101dd157370c5f32f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526115"
---
# <a name="protocol-independentout-of-band-data-in-the-spi"></a><span data-ttu-id="5bd6b-103">Protocole IndependentOut-of-band Data in the SPI</span><span class="sxs-lookup"><span data-stu-id="5bd6b-103">Protocol IndependentOut-of-Band Data in the SPI</span></span>

<span data-ttu-id="5bd6b-104">Les données hors bande (OOB) sont un canal de transmission logiquement indépendant associé à une paire de sockets de flux connectés.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-104">Out-of-Band (OOB) data is a logically independent transmission channel associated with a pair of connected stream sockets.</span></span> <span data-ttu-id="5bd6b-105">Les données OOB peuvent être fournies à l’utilisateur indépendamment des données normales.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-105">OOB data may be delivered to the user independently of normal data.</span></span> <span data-ttu-id="5bd6b-106">L’abstraction définit que les fonctionnalités de données OOB doivent prendre en charge la remise fiable d’au moins un bloc de données OOB à la fois.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-106">The abstraction defines that the OOB data facilities must support the reliable delivery of at least one OOB data block at a time.</span></span> <span data-ttu-id="5bd6b-107">Ce bloc de données peut contenir au moins un octet de données, et au moins un bloc de données OOB peut être en attente de remise à l’utilisateur à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-107">This data block may contain at least one byte of data, and at least one OOB data block may be pending delivery to the user at any one time.</span></span> <span data-ttu-id="5bd6b-108">Pour les protocoles de communication qui prennent en charge la signalisation intrabande (c’est-à-dire, TCP, où les données urgentes sont fournies en séquence avec les données normales), le système extrait normalement les données OOB du flux de données normal et les stocke séparément (en laissant un intervalle dans le flux de données normal).</span><span class="sxs-lookup"><span data-stu-id="5bd6b-108">For communications protocols which support in-band signaling (that is, TCP, where the urgent data is delivered in sequence with the normal data), the system normally extracts the OOB data from the normal data stream and stores it separately (leaving a gap in the normal data stream).</span></span> <span data-ttu-id="5bd6b-109">Cela permet aux utilisateurs de choisir de recevoir les données OOB dans l’ordre et de les recevoir hors séquence sans avoir à mettre en mémoire tampon toutes les données intermédiaires.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-109">This allows users to choose between receiving the OOB data in order and receiving it out of sequence without having to buffer all the intervening data.</span></span> <span data-ttu-id="5bd6b-110">Il est possible de lire des données OOB.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-110">It is possible to peek at OOB data.</span></span>

<span data-ttu-id="5bd6b-111">Un utilisateur peut déterminer s’il existe des données OOB en attente de lecture à l’aide de la fonction [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (SIOCATMARK).</span><span class="sxs-lookup"><span data-stu-id="5bd6b-111">A user can determine if there is any OOB data waiting to be read using the [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (SIOCATMARK) function.</span></span> <span data-ttu-id="5bd6b-112">Pour les protocoles où le concept de la position du bloc de données OOB dans le flux de données normal est explicite (c’est-à-dire, TCP), un fournisseur de services Windows Sockets conservera un marqueur conceptuel indiquant la position du dernier octet des données OOB dans le flux de données normal.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-112">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful (that is, TCP), a Windows Sockets service provider will maintain a conceptual marker indicating the position of the last byte of OOB data within the normal data stream.</span></span> <span data-ttu-id="5bd6b-113">Cela n’est pas nécessaire pour l’implémentation de la fonctionnalité **WSPIoctl** (SIOCATMARK) : la présence ou l’absence de données oobles est tout ce qui est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-113">This is not necessary for the implementation of the **WSPIoctl** (SIOCATMARK) functionality — the presence or absence of OOB data is all that is required.</span></span>

<span data-ttu-id="5bd6b-114">Pour les protocoles où le concept de la position du bloc de données OOB dans le flux de données normal est significatif, une application peut préférer traiter les données hors bande en ligne, dans le cadre du flux de données normal.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-114">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful an application may prefer to process out-of-band data inline, as part of the normal data stream.</span></span> <span data-ttu-id="5bd6b-115">Pour ce faire, définissez l’option de socket de sorte que \_ OOBINLINE (voir la section [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))).</span><span class="sxs-lookup"><span data-stu-id="5bd6b-115">This is achieved by setting the socket option SO\_OOBINLINE (see section [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))).</span></span> <span data-ttu-id="5bd6b-116">Pour les autres protocoles où les blocs de données OOB sont véritablement indépendants du flux de données normal, toute tentative de définition de SO \_ OOBINLINE génère une erreur.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-116">For other protocols where the OOB data blocks are truly independent of the normal data stream, attempting to set SO\_OOBINLINE will result in an error.</span></span> <span data-ttu-id="5bd6b-117">Une application peut utiliser la commande SIOCATMARK WSPIoctl pour déterminer si des données OOB non lues sont précédées de la marque.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-117">An application can use the SIOCATMARK WSPIoctl command to determine whether there is any unread OOB data preceding the mark.</span></span> <span data-ttu-id="5bd6b-118">Par exemple, il peut l’utiliser pour se resynchroniser avec son homologue en s’assurant que toutes les données jusqu’à la marque dans le flux de données sont ignorées lorsque cela est approprié.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-118">For example, it might use this to resynchronize with its peer by ensuring that all data up to the mark in the data stream is discarded when appropriate.</span></span>

<span data-ttu-id="5bd6b-119">Avec SO \_ OOBINLINE désactivé (par défaut) :</span><span class="sxs-lookup"><span data-stu-id="5bd6b-119">With SO\_OOBINLINE disabled (by default):</span></span>

-   <span data-ttu-id="5bd6b-120">Le fournisseur de services Winsock notifie un client d’un \_ événement OOB FD, si le client s’est inscrit pour la notification avec [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), exactement de la même façon que FD \_ Read est utilisé pour notifier la présence de données normales.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-120">The Winsock service provider notifies a client of an FD\_OOB event, if the client registered for notification with [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), in exactly the same way FD\_READ is used to notify of the presence of normal data.</span></span> <span data-ttu-id="5bd6b-121">Autrement dit, FD \_ OOB est publié à l’arrivée des données OOB et aucune donnée OOB n’a été mise en file d’attente, et également lorsque les données sont lues à l’aide de l’indicateur de message \_ OOB, et certaines données OOB restent lues après le retour de l’opération de lecture.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-121">That is, FD\_OOB is posted when OOB data arrives and there was no OOB data previously queued, and also when data is read using the MSG\_OOB flag, and some OOB data remains to be read after the read operation has returned.</span></span> <span data-ttu-id="5bd6b-122">Les \_ messages de lecture FD ne sont pas publiés pour les données OOB.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-122">FD\_READ messages are not posted for OOB data.</span></span>
-   <span data-ttu-id="5bd6b-123">Le fournisseur de services Winsock retourne à partir de [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) avec le jeu de Sockets *exceptfds* approprié si les données OOB sont mises en file d’attente sur le Socket.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-123">The Winsock service provider returns from [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) with the appropriate *exceptfds* socket set if OOB data is queued on the socket.</span></span>
-   <span data-ttu-id="5bd6b-124">Le client peut appeler [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) avec MSG \_ OOB pour lire le bloc de données urgent à tout moment.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-124">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) with MSG\_OOB to read the urgent data block at any time.</span></span> <span data-ttu-id="5bd6b-125">Le bloc de données OOB déplace la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-125">The block of OOB data jumps the queue.</span></span>
-   <span data-ttu-id="5bd6b-126">Le client peut appeler [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) sans msg \_ OOB pour lire le flux de données normal.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-126">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) without MSG\_OOB to read the normal data stream.</span></span> <span data-ttu-id="5bd6b-127">Le bloc de données OOB n’apparaîtra pas dans le flux de données avec des données normales.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-127">The OOB data block will not appear in the data stream with normal data.</span></span> <span data-ttu-id="5bd6b-128">Si les données OOB restent après un appel à **WSPRecv**, le fournisseur de services notifie le client avec FD \_ OOB ou via *exceptfds* lors de l’utilisation de [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="5bd6b-128">If OOB data remains after any call to **WSPRecv**, the service provider notifies the client with FD\_OOB or through *exceptfds* when using [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).</span></span>
-   <span data-ttu-id="5bd6b-129">Pour les protocoles où les données OOB ont une position dans le flux de données normal, une seule opération [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) ne s’étend pas sur cette position.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-129">For protocols where the OOB data has a position within the normal data stream, a single [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) operation will not span that position.</span></span> <span data-ttu-id="5bd6b-130">Un **WSPRecv** renvoie les données normales avant la marque, et un deuxième **WSPRecv** est requis pour commencer à lire les données après la marque.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-130">One **WSPRecv** will return the normal data before the mark, and a second **WSPRecv** is required to begin reading data after the mark.</span></span>

<span data-ttu-id="5bd6b-131">Avec SO \_ OOBINLINE activé :</span><span class="sxs-lookup"><span data-stu-id="5bd6b-131">With SO\_OOBINLINE enabled:</span></span>

-   <span data-ttu-id="5bd6b-132">Les \_ messages OOB FD ne sont pas publiés pour les données OOB. dans le cadre des fonctions [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) et [**WSPASYNCSELECT**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) , les données OOB sont traitées comme des données normales et indiquées par la définition du socket dans *readfds* ou par l’envoi d’un \_ message FD Read respectivement.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-132">FD\_OOB messages are not posted for OOB data — for the purpose of the [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) and [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) functions, OOB data is treated as normal data, and indicated by setting the socket in *readfds* or by sending an FD\_READ message respectively.</span></span>
-   <span data-ttu-id="5bd6b-133">Le client ne peut pas appeler [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) avec l' \_ indicateur OOB MSG défini pour lire le bloc de données OOB : le code d’erreur WSAEINVAL est retourné.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-133">The client may not call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) with the MSG\_OOB flag set to read the OOB data block — the error code WSAEINVAL will be returned.</span></span>
-   <span data-ttu-id="5bd6b-134">Le client peut appeler [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) sans l’indicateur de message \_ OOB défini.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-134">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) without the MSG\_OOB flag set.</span></span> <span data-ttu-id="5bd6b-135">Toute donnée OOB sera remise dans son ordre correct dans le flux de données normal.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-135">Any OOB data will be delivered in its correct order within the normal data stream.</span></span> <span data-ttu-id="5bd6b-136">Les données OOB ne seront jamais mélangées avec des données normales : il doit y avoir trois demandes de lecture pour prendre en compte les données OOB.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-136">OOB data will never be mixed with normal data — there must be three read requests to get past the OOB data.</span></span> <span data-ttu-id="5bd6b-137">La première retourne les données normales avant le bloc de données OOB, le second retourne les données OOB, le troisième retourne les données normales qui suivent les données OOB.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-137">The first returns the normal data prior to the OOB data block, the second returns the OOB data, the third returns the normal data following the OOB data.</span></span> <span data-ttu-id="5bd6b-138">En d’autres termes, les limites du bloc de données OOB sont conservées.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-138">In other words, the OOB data block boundaries are preserved.</span></span>

<span data-ttu-id="5bd6b-139">La routine [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) est particulièrement bien adaptée pour gérer la notification de la présence de données OOB lorsque \_ OOBINLINE est désactivé.</span><span class="sxs-lookup"><span data-stu-id="5bd6b-139">The [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) routine is particularly well suited to handling notification of the presence of OOB data when SO\_OOBINLINE is off.</span></span>

 

 
