---
description: Pour obtenir la notification des réseaux logiques invalidés, utilisez la fonction WSANSPIoctl pour vous inscrire aux événements de changement d’emplacement réseau.
ms.assetid: 531b6269-5f35-44c1-ad0f-c5f103029893
title: Interrogation de NLA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ac7a4f57e14bb967b04d3a9fd6fe66717da3878
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106518186"
---
# <a name="querying-nla"></a><span data-ttu-id="cde54-103">Interrogation de NLA</span><span class="sxs-lookup"><span data-stu-id="cde54-103">Querying NLA</span></span>

<span data-ttu-id="cde54-104">Pour obtenir la notification des réseaux logiques invalidés, utilisez la fonction [**WSANSPIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) pour vous inscrire aux événements de changement d’emplacement réseau.</span><span class="sxs-lookup"><span data-stu-id="cde54-104">To obtain notification of invalidated logical networks, use the [**WSANSPIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) function to register for network location change events.</span></span> <span data-ttu-id="cde54-105">Deux méthodes peuvent être utilisées pour déterminer si un emplacement réseau précédemment valide est devenu non valide : des méthodes d’interrogation ou une notification utilisant des e/s avec chevauchement ou une messagerie Windows.</span><span class="sxs-lookup"><span data-stu-id="cde54-105">Two methods can be used to determine whether a previously valid network location has become invalid: polling methods, or notification using overlapped I/O or Windows messaging.</span></span>

<span data-ttu-id="cde54-106">Les requêtes sont formées à l’aide des fonctions [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina), [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) et [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) pour énumérer tous les réseaux logiques disponibles.</span><span class="sxs-lookup"><span data-stu-id="cde54-106">Queries are formed using the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina), [**WSALookupServiceNext,**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) and [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) functions to enumerate all available logical networks.</span></span> <span data-ttu-id="cde54-107">L’utilisation de chacune de ces fonctions est expliquée individuellement dans le reste de cette section, en commençant par la fonction **WSALookupServiceBegin** .</span><span class="sxs-lookup"><span data-stu-id="cde54-107">The use of each of these functions is explained individually throughout the remainder of this section, beginning with the **WSALookupServiceBegin** function.</span></span>

> [!Note]  
> <span data-ttu-id="cde54-108">NLA requiert le fichier d’en-tête mswsock. h, qui, par défaut, n’est pas inclus dans le fichier Winsock2. h.</span><span class="sxs-lookup"><span data-stu-id="cde54-108">NLA requires the Mswsock.h header file, which by default is not included in the Winsock2.h file.</span></span>

 

## <a name="step-1-initiate-the-query"></a><span data-ttu-id="cde54-109">Étape 1 : lancer la requête</span><span class="sxs-lookup"><span data-stu-id="cde54-109">Step 1: Initiate the Query</span></span>

<span data-ttu-id="cde54-110">Pour référence rapide, la fonction [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) a la syntaxe suivante :</span><span class="sxs-lookup"><span data-stu-id="cde54-110">For quick reference, the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function has the following syntax:</span></span>

``` syntax
INT WSALookupServiceBegin(
  LPWSAQUERYSET lpqsRestrictions,
  DWORD dwControlFlags,
  LPHANDLE lphLookup
);
```

<span data-ttu-id="cde54-111">NLA prend en charge les indicateurs de recherche *dwControlFlags* suivants :</span><span class="sxs-lookup"><span data-stu-id="cde54-111">NLA supports the following *dwControlFlags* lookup flags:</span></span>

<dl> <span data-ttu-id="cde54-112">LUP \_ nom de retour \_</span><span class="sxs-lookup"><span data-stu-id="cde54-112">LUP\_RETURN\_NAME</span></span>  
<span data-ttu-id="cde54-113">LUP \_ retourner le \_ Commentaire</span><span class="sxs-lookup"><span data-stu-id="cde54-113">LUP\_RETURN\_COMMENT</span></span>  
<span data-ttu-id="cde54-114">LUP \_ retourne un \_ objet BLOB</span><span class="sxs-lookup"><span data-stu-id="cde54-114">LUP\_RETURN\_BLOB</span></span>  
<span data-ttu-id="cde54-115">LUP \_ renvoyer \_ tout</span><span class="sxs-lookup"><span data-stu-id="cde54-115">LUP\_RETURN\_ALL</span></span>  
<span data-ttu-id="cde54-116">LUP \_ profonde</span><span class="sxs-lookup"><span data-stu-id="cde54-116">LUP\_DEEP</span></span>  
</dl>

<span data-ttu-id="cde54-117">Ces indicateurs limitent les jeux de résultats retournés dans les appels suivants à la fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), aux réseaux qui contiennent des champs du type spécifié.</span><span class="sxs-lookup"><span data-stu-id="cde54-117">These flags restrict the result sets returned in subsequent calls to the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), function to networks that contain fields of the specified type.</span></span> <span data-ttu-id="cde54-118">Par exemple, si vous spécifiez LUP, \_ \_ l’objet blob de retour dans le paramètre *dwControlFlags* de l’appel de fonction [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) restreint les jeux de résultats des appels suivants à **WSALookupServiceNext**, aux réseaux qui contiennent des informations d’objet BLOB.</span><span class="sxs-lookup"><span data-stu-id="cde54-118">For example, specifying LUP\_RETURN\_BLOB in the *dwControlFlags* parameter of the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function call restricts result sets from subsequent calls to **WSALookupServiceNext**, to networks that contain BLOB information.</span></span> <span data-ttu-id="cde54-119">L’utilisation de l' \_ indicateur lup Return \_ All est équivalente à la spécification du \_ nom de retour lup, du commentaire de \_ \_ retour lup et lup à l' \_ \_ \_ objet BLOB Return, mais pas à la \_ profondeur lup.</span><span class="sxs-lookup"><span data-stu-id="cde54-119">Using the LUP\_RETURN\_ALL flag is equivalent to specifying LUP\_RETURN\_NAME, LUP\_RETURN\_COMMENT, and LUP\_RETURN\_BLOB, but not LUP\_DEEP.</span></span>

<span data-ttu-id="cde54-120">Pour obtenir une explication de ces indicateurs de recherche, consultez la page de référence sur les fonctions [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) .</span><span class="sxs-lookup"><span data-stu-id="cde54-120">For an explanation of these lookup flags, consult the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function reference page.</span></span>

<span data-ttu-id="cde54-121">Le handle de recherche retourné par NLA dans le paramètre *lphLookup* est privé pour NLA et ne doit pas être modifié.</span><span class="sxs-lookup"><span data-stu-id="cde54-121">The lookup handle returned by NLA in the *lphLookup* parameter is private to NLA, and should not be modified.</span></span> <span data-ttu-id="cde54-122">Étant donné que le handle retourné est privé pour NLA, les fonctions telles que [**WSAGetOverlappedResult**](/windows/desktop/api/Winsock2/nf-winsock2-wsagetoverlappedresult) ne sont pas disponibles.</span><span class="sxs-lookup"><span data-stu-id="cde54-122">Since the returned handle is private to NLA, functions such as [**WSAGetOverlappedResult**](/windows/desktop/api/Winsock2/nf-winsock2-wsagetoverlappedresult) are not available.</span></span>

<span data-ttu-id="cde54-123">NLA retourne la valeur zéro en cas de réussite, comme défini dans la page de référence de la fonction [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) .</span><span class="sxs-lookup"><span data-stu-id="cde54-123">NLA returns zero upon successful completion, as defined in the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function reference page.</span></span> <span data-ttu-id="cde54-124">Dans le cas contraire, NLA prend en charge les codes d’erreur suivants.</span><span class="sxs-lookup"><span data-stu-id="cde54-124">Otherwise, NLA supports the following error codes.</span></span>

| <span data-ttu-id="cde54-125">Error</span><span class="sxs-lookup"><span data-stu-id="cde54-125">Error</span></span>                    | <span data-ttu-id="cde54-126">Signification</span><span class="sxs-lookup"><span data-stu-id="cde54-126">Meaning</span></span>                                                                                                                                                     |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="cde54-127">WSANOTINITIALISED</span><span class="sxs-lookup"><span data-stu-id="cde54-127">WSANOTINITIALISED</span></span>        | <span data-ttu-id="cde54-128">Un appel réussi à la fonction [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) pour initialiser NLA n’a pas été effectué.</span><span class="sxs-lookup"><span data-stu-id="cde54-128">A successful call to the [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) function to initialize NLA was not performed.</span></span>                                                   |
| <span data-ttu-id="cde54-129">WSAEINVAL</span><span class="sxs-lookup"><span data-stu-id="cde54-129">WSAEINVAL</span></span>                | <span data-ttu-id="cde54-130">Un ou plusieurs paramètres ne sont pas valides, ou les paramètres spécifiés dans l’appel de fonction s’appliquent à des protocoles autres que l’adresse IP.</span><span class="sxs-lookup"><span data-stu-id="cde54-130">One or more parameters were invalid, or parameters specified in the function call apply to protocols other than IP.</span></span>                                         |
| <span data-ttu-id="cde54-131">WSASERVICE \_ \_ introuvable</span><span class="sxs-lookup"><span data-stu-id="cde54-131">WSASERVICE\_NOT\_FOUND</span></span>   | <span data-ttu-id="cde54-132">Le paramètre *lpServiceClassId* de la structure [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) passée dans le paramètre *lpqsRestrictions* contient un GUID non valide.</span><span class="sxs-lookup"><span data-stu-id="cde54-132">The *lpServiceClassId* parameter of the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure passed in the *lpqsRestrictions* parameter contains an invalid GUID.</span></span> |
| <span data-ttu-id="cde54-133">\_données WSANO</span><span class="sxs-lookup"><span data-stu-id="cde54-133">WSANO\_DATA</span></span>              | <span data-ttu-id="cde54-134">L' \_ indicateur lup Containers a été spécifié dans le paramètre *dwControlFlags* .</span><span class="sxs-lookup"><span data-stu-id="cde54-134">The LUP\_CONTAINERS flag was specified in *dwControlFlags* parameter.</span></span>                                                                                       |
| <span data-ttu-id="cde54-135">WSAEFAULT</span><span class="sxs-lookup"><span data-stu-id="cde54-135">WSAEFAULT</span></span>                | <span data-ttu-id="cde54-136">Une violation d’accès s’est produite lors de la tentative d’accès aux paramètres fournis par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cde54-136">An access violation occurred when attempting to access user-supplied parameters.</span></span>                                                                            |
| <span data-ttu-id="cde54-137">WSASYSNOTREADY</span><span class="sxs-lookup"><span data-stu-id="cde54-137">WSASYSNOTREADY</span></span>           | <span data-ttu-id="cde54-138">Le service NLA n’est pas disponible pour traiter la demande.</span><span class="sxs-lookup"><span data-stu-id="cde54-138">The NLA service is unavailable to process the request.</span></span>                                                                                                      |
| <span data-ttu-id="cde54-139">\_mémoire WSA \_ insuffisante \_</span><span class="sxs-lookup"><span data-stu-id="cde54-139">WSA\_NOT\_ENOUGH\_MEMORY</span></span> | <span data-ttu-id="cde54-140">NLA ou le service NLA n’a pas pu allouer suffisamment de mémoire pour traiter cette demande.</span><span class="sxs-lookup"><span data-stu-id="cde54-140">NLA or the NLA service was unable to allocate enough memory to process this request.</span></span>                                                                        |



 

## <a name="step-2-perform-the-query"></a><span data-ttu-id="cde54-141">Étape 2 : exécuter la requête</span><span class="sxs-lookup"><span data-stu-id="cde54-141">Step 2: Perform the Query</span></span>

<span data-ttu-id="cde54-142">L’étape suivante de l’interrogation de NLA requiert l’utilisation de la fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) .</span><span class="sxs-lookup"><span data-stu-id="cde54-142">The next step in querying NLA requires use of the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function.</span></span> <span data-ttu-id="cde54-143">Pour référence rapide, la fonction **WSALookupServiceNext** a la syntaxe suivante :</span><span class="sxs-lookup"><span data-stu-id="cde54-143">For quick reference, the **WSALookupServiceNext**, function has the following syntax:</span></span>

``` syntax
INT WSALookupServiceNext(
  HANDLE hLookup,
  DWORD dwControlFlags,
  LPDWORD lpdwBufferLength,
  LPWSAQUERYSET lpqsResults
);
```

<span data-ttu-id="cde54-144">Le paramètre *lLookup* est le handle de recherche retourné par l’appel précédent à la fonction [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) .</span><span class="sxs-lookup"><span data-stu-id="cde54-144">The *lLookup* parameter is the lookup handle returned from the previous call to the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function.</span></span>

<span data-ttu-id="cde54-145">Le paramètre *dwControlFlags* prend en charge les indicateurs suivants :</span><span class="sxs-lookup"><span data-stu-id="cde54-145">The *dwControlFlags* parameter supports the following flags:</span></span>

<dl> <span data-ttu-id="cde54-146">LUP \_ nom de retour \_</span><span class="sxs-lookup"><span data-stu-id="cde54-146">LUP\_RETURN\_NAME</span></span>  
<span data-ttu-id="cde54-147">LUP \_ retourner le \_ Commentaire</span><span class="sxs-lookup"><span data-stu-id="cde54-147">LUP\_RETURN\_COMMENT</span></span>  
<span data-ttu-id="cde54-148">LUP \_ retourne un \_ objet BLOB</span><span class="sxs-lookup"><span data-stu-id="cde54-148">LUP\_RETURN\_BLOB</span></span>  
<span data-ttu-id="cde54-149">LUP \_ renvoyer \_ tout</span><span class="sxs-lookup"><span data-stu-id="cde54-149">LUP\_RETURN\_ALL</span></span>  
<span data-ttu-id="cde54-150">LUP \_ FLUSHPREVIOUS</span><span class="sxs-lookup"><span data-stu-id="cde54-150">LUP\_FLUSHPREVIOUS</span></span>  
</dl>

<span data-ttu-id="cde54-151">Ces indicateurs sont indépendants des indicateurs pris en charge dans l’appel de la fonction [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) .</span><span class="sxs-lookup"><span data-stu-id="cde54-151">These flags are independent of the flags supported in the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function call.</span></span> <span data-ttu-id="cde54-152">Notez que toutes les contraintes spécifiées dans l’appel précédent à la fonction **WSALookupServiceBegin** contraignent la recherche ; l’ajout d’indicateurs avec la fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) dans une tentative d’élargissement de la requête au-delà des contraintes spécifiées dans l’appel **WSALookupServiceBegin** est ignoré en mode silencieux.</span><span class="sxs-lookup"><span data-stu-id="cde54-152">Note that any constraints specified in the previous call to the **WSALookupServiceBegin** function constrain the lookup; adding flags with the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function in an attempt to broaden the query beyond the constraints specified in the **WSALookupServiceBegin** call are silently ignored.</span></span> <span data-ttu-id="cde54-153">Toutefois, la spécification d’un jeu d’indicateurs plus restrictif que celui spécifié dans l’appel **WSALookupServiceBegin** est autorisée.</span><span class="sxs-lookup"><span data-stu-id="cde54-153">Specifying a more restrictive set of flags than that specified in the **WSALookupServiceBegin** call, however, is allowed.</span></span>

<span data-ttu-id="cde54-154">Si le réseau détaillé dans *lpqsResults* est un réseau actif, une série de **structures \_ BLOB NLA** est ajoutée comme spécifié dans le membre **lpBlob** de la structure [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) retournée dans *lpqsResults*.</span><span class="sxs-lookup"><span data-stu-id="cde54-154">If the network detailed in *lpqsResults* is an active network, a series of **NLA\_BLOB** structures is appended as specified in the **lpBlob** member of the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure returned in *lpqsResults*.</span></span> <span data-ttu-id="cde54-155">Ces **structures \_ BLOB NLA** peuvent être chaînées et peuvent être énumérées en parcourant la liste pendant que l' \_ objet BLOB NLA. Header. nextOffset est différent de zéro.</span><span class="sxs-lookup"><span data-stu-id="cde54-155">These **NLA\_BLOB** structures may be chained, and can be enumerated by traversing the list while NLA\_BLOB.header.nextOffset is nonzero.</span></span> <span data-ttu-id="cde54-156">Pour obtenir les résultats de toutes les informations relatives à l’emplacement du réseau, continuez à appeler la fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta)jusqu’à ce que le WSA \_ E \_ n' \_ ait plus d’erreur est renvoyée, comme expliqué dans la page de référence **WSALookupServiceNext**.</span><span class="sxs-lookup"><span data-stu-id="cde54-156">To obtain results for all network location information, continue calling the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), function until the WSA\_E\_NO\_MORE error is returned, as explained in the **WSALookupServiceNext**, reference page.</span></span>

<span data-ttu-id="cde54-157">La fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) est également utilisée conjointement avec la fonction [**WSANSPIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) pour recevoir la notification des modifications du réseau.</span><span class="sxs-lookup"><span data-stu-id="cde54-157">The [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function is also used in conjunction with the [**WSANSPIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) function to receive notification of network changes.</span></span> <span data-ttu-id="cde54-158">Pour plus d’informations, consultez [notification d’NLA](notification-from-nla-2.md) .</span><span class="sxs-lookup"><span data-stu-id="cde54-158">See [Notification from NLA](notification-from-nla-2.md) for more information.</span></span>

<span data-ttu-id="cde54-159">NLA retourne la valeur zéro en cas de réussite.</span><span class="sxs-lookup"><span data-stu-id="cde54-159">NLA returns zero upon successful completion.</span></span> <span data-ttu-id="cde54-160">Les clients d’NLA doivent continuer à appeler la fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta)jusqu’à ce que le WSA \_ E \_ ne \_ soit pas retourné, ce qui indique que toutes les informations sur les réseaux disponibles ont été retournées.</span><span class="sxs-lookup"><span data-stu-id="cde54-160">Clients of NLA should continue calling the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), function until WSA\_E\_NO\_MORE is returned, indicating that all of the information about available networks has been returned.</span></span>

<span data-ttu-id="cde54-161">Sinon, l’appel de la fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta)pour NLA prend en charge les codes d’erreur suivants.</span><span class="sxs-lookup"><span data-stu-id="cde54-161">Otherwise, calling the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), function for NLA supports the following error codes.</span></span>

| <span data-ttu-id="cde54-162">Error</span><span class="sxs-lookup"><span data-stu-id="cde54-162">Error</span></span>                    | <span data-ttu-id="cde54-163">Signification</span><span class="sxs-lookup"><span data-stu-id="cde54-163">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                     |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="cde54-164">WSANOTINITIALISED</span><span class="sxs-lookup"><span data-stu-id="cde54-164">WSANOTINITIALISED</span></span>        | <span data-ttu-id="cde54-165">Un appel réussi à la fonction [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) qui a initialisé NLA n’a pas été effectué.</span><span class="sxs-lookup"><span data-stu-id="cde54-165">A successful call to the [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) function that initialized NLA was not performed.</span></span>                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="cde54-166">\_descripteur WSA non valide \_</span><span class="sxs-lookup"><span data-stu-id="cde54-166">WSA\_INVALID\_HANDLE</span></span>     | <span data-ttu-id="cde54-167">Le descripteur de recherche fourni dans le paramètre *RECHERCHEH* n’était pas un handle NLA valide.</span><span class="sxs-lookup"><span data-stu-id="cde54-167">The lookup handle provided in the *hLookup* parameter was not a valid NLA SP handle.</span></span> <span data-ttu-id="cde54-168">Les clients doivent d’abord appeler la fonction [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) et recevoir un handle NLA valide pour obtenir les résultats de la requête.</span><span class="sxs-lookup"><span data-stu-id="cde54-168">Clients must first call the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function and receive a valid NLA SP handle to obtain query results.</span></span>                                                                                                                                                               |
| <span data-ttu-id="cde54-169">WSAESYSNOTREADY</span><span class="sxs-lookup"><span data-stu-id="cde54-169">WSAESYSNOTREADY</span></span>          | <span data-ttu-id="cde54-170">Le service NLA n’est pas disponible pour traiter cette demande.</span><span class="sxs-lookup"><span data-stu-id="cde54-170">The NLA service is unavailable to process this request.</span></span>                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="cde54-171">WSAEFAULT</span><span class="sxs-lookup"><span data-stu-id="cde54-171">WSAEFAULT</span></span>                | <span data-ttu-id="cde54-172">La taille de la mémoire tampon spécifiée dans le paramètre *lpdwBufferLength* est insuffisante pour contenir les résultats pointés par *lpqsResults*.</span><span class="sxs-lookup"><span data-stu-id="cde54-172">The buffer size specified in the *lpdwBufferLength* parameter was insufficient to hold the results pointed to by *lpqsResults*.</span></span> <span data-ttu-id="cde54-173">La mémoire tampon requise est spécifiée dans *lpdwBufferLength*; Si le client ne peut pas fournir une mémoire tampon suffisamment grande, le client peut appeler la fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) avec *DWCONTROLFLAGS* défini sur lup \_ FLUSHPREVIOUS pour ignorer l’entrée.</span><span class="sxs-lookup"><span data-stu-id="cde54-173">The required buffer is specified in *lpdwBufferLength*; if the client cannot supply a sufficiently large buffer, the client can call the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function with *dwControlFlags* set to LUP\_FLUSHPREVIOUS to skip the entry.</span></span> |
| <span data-ttu-id="cde54-174">\_mémoire WSA \_ insuffisante \_</span><span class="sxs-lookup"><span data-stu-id="cde54-174">WSA\_NOT\_ENOUGH\_MEMORY</span></span> | <span data-ttu-id="cde54-175">NLA ne parvient pas à obtenir les informations réseau à partir du service système NLA en raison d’une insuffisance de mémoire dans le processus appelant.</span><span class="sxs-lookup"><span data-stu-id="cde54-175">NLA is unable to obtain network information from the NLA system service due to insufficient memory in the calling process.</span></span>                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="cde54-176">WSA \_ E \_ plus \_</span><span class="sxs-lookup"><span data-stu-id="cde54-176">WSA\_E\_NO\_MORE</span></span>         | <span data-ttu-id="cde54-177">Il n’existe aucun réseau supplémentaire à énumérer pour la requête.</span><span class="sxs-lookup"><span data-stu-id="cde54-177">There are no additional networks to enumerate for the query.</span></span>                                                                                                                                                                                                                                                                                                                                                |



 

## <a name="step-3-terminate-the-query"></a><span data-ttu-id="cde54-178">Étape 3 : terminer la requête</span><span class="sxs-lookup"><span data-stu-id="cde54-178">Step 3: Terminate the Query</span></span>

<span data-ttu-id="cde54-179">Lorsque toutes les requêtes à NLA sont terminées et qu’une application n’exige plus l’utilisation de NLA, un appel à la fonction [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) doit être effectué.</span><span class="sxs-lookup"><span data-stu-id="cde54-179">When all queries to NLA are complete and an application no longer requires use of NLA, a call to the [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) function should be made.</span></span> <span data-ttu-id="cde54-180">N’appelez pas **WSALookupServiceEnd** si l’application reçoit une notification de modification en fonction de la requête envoyée.</span><span class="sxs-lookup"><span data-stu-id="cde54-180">Do not call **WSALookupServiceEnd** if the application will receive change notification based on the submitted query.</span></span> <span data-ttu-id="cde54-181">Pour plus d’informations sur la réception de notifications, consultez [notification d’NLA](notification-from-nla-2.md) .</span><span class="sxs-lookup"><span data-stu-id="cde54-181">See [Notification from NLA](notification-from-nla-2.md) for more information on receiving notification.</span></span> <span data-ttu-id="cde54-182">Comme la plupart des fournisseurs de services Windows Sockets, NLA conserve un décompte de références pour ses clients.</span><span class="sxs-lookup"><span data-stu-id="cde54-182">Like most Windows Sockets service providers, NLA maintains a reference count for its clients.</span></span> <span data-ttu-id="cde54-183">L’appel de la fonction **WSALookupServiceEnd** lorsque les requêtes à NLA sont effectuées permet de libérer les ressources système qui ne sont plus requises par NLA.</span><span class="sxs-lookup"><span data-stu-id="cde54-183">Calling the **WSALookupServiceEnd** function when queries to NLA are completed enables system resources no longer required by NLA to be freed.</span></span>

<span data-ttu-id="cde54-184">NLA prend en charge les codes d’erreur suivants pour les appels de fonction [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) .</span><span class="sxs-lookup"><span data-stu-id="cde54-184">NLA supports the following error codes for [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) function calls.</span></span>

| <span data-ttu-id="cde54-185">Error</span><span class="sxs-lookup"><span data-stu-id="cde54-185">Error</span></span>                | <span data-ttu-id="cde54-186">Signification</span><span class="sxs-lookup"><span data-stu-id="cde54-186">Meaning</span></span>                                                                                                   |
|----------------------|-----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="cde54-187">WSANOTINITIALISED</span><span class="sxs-lookup"><span data-stu-id="cde54-187">WSANOTINITIALISED</span></span>    | <span data-ttu-id="cde54-188">Un appel réussi à la fonction [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) pour initialiser NLA n’a pas été effectué.</span><span class="sxs-lookup"><span data-stu-id="cde54-188">A successful call to the [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) function to initialize NLA was not performed.</span></span> |
| <span data-ttu-id="cde54-189">\_descripteur WSA non valide \_</span><span class="sxs-lookup"><span data-stu-id="cde54-189">WSA\_INVALID\_HANDLE</span></span> | <span data-ttu-id="cde54-190">Le handle fourni dans le paramètre *RECHERCHEH* n’était pas un handle NLA valide.</span><span class="sxs-lookup"><span data-stu-id="cde54-190">The handle provided in the *hLookup* parameter was not a valid NLA SP handle.</span></span>                             |



 

 

 



