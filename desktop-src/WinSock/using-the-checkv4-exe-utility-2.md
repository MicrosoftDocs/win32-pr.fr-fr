---
description: À l’aide de l’utilitaire Checkv4.exe pour modifier votre application IPv4 pour prendre en charge IPv6.
ms.assetid: 36b72e4f-133d-4d96-a3c9-86a852d3a479
title: Utilisation de l’utilitaire Checkv4.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2fc9eca96b2138f9950b157a4b7690dc382f273e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104553944"
---
# <a name="using-the-checkv4exe-utility"></a><span data-ttu-id="11c5f-103">Utilisation de l’utilitaire Checkv4.exe</span><span class="sxs-lookup"><span data-stu-id="11c5f-103">Using the Checkv4.exe utility</span></span>

> [!IMPORTANT]
> <span data-ttu-id="11c5f-104">L’utilitaire *Checkv4.exe* n’est pas fourni avec le kit de développement logiciel (SDK) Windows pour Windows 8, ni dans les versions ultérieures du SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="11c5f-104">The *Checkv4.exe* utility doesn't ship in the Windows Software Development Kit (SDK) for Windows 8, nor in later versions of the Windows SDK.</span></span>

<span data-ttu-id="11c5f-105">L’utilitaire *Checkv4.exe* est conçu pour vous fournir un partenaire de portage de code. un utilitaire qui parcourt votre base de code avec vous, identifie les problèmes potentiels ou met en évidence le code qui peut tirer parti des structures ou des fonctions compatibles IPv6, et formule des recommandations.</span><span class="sxs-lookup"><span data-stu-id="11c5f-105">The *Checkv4.exe* utility is designed to provide you with a code porting partner; a utility that steps through your code base with you, identifies potential problems or highlights code that could benefit from IPv6-capable functions or structures, and makes recommendations.</span></span> <span data-ttu-id="11c5f-106">Avec l’utilitaire Checkv4.exe, la tâche de modification d’une application IPv4 existante pour prendre en charge IPv6 devient beaucoup plus facile.</span><span class="sxs-lookup"><span data-stu-id="11c5f-106">With the Checkv4.exe utility, the task of modifying an existing IPv4 application to support IPv6 becomes much easier.</span></span>

<span data-ttu-id="11c5f-107">L’utilitaire *Checkv4.exe* est installé dans le cadre du kit de développement logiciel (SDK) Microsoft Windows publié pour Windows Vista et les SDK ultérieurs (jusqu’au kit de développement logiciel (SDK) Windows pour Windows 8).</span><span class="sxs-lookup"><span data-stu-id="11c5f-107">The *Checkv4.exe* utility is installed as part of the Microsoft Windows Software Development Kit (SDK) released for Windows Vista and later SDKs (up to, but not including, the Windows Software Development Kit (SDK) for Windows 8).</span></span>

<span data-ttu-id="11c5f-108">Une version antérieure de l’utilitaire *Checkv4.exe* avec des fonctionnalités plus limitées a également été mise à disposition dans le cadre de la version préliminaire antérieure de la technologie IPv6 de Microsoft pour Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="11c5f-108">An earlier version of the *Checkv4.exe* utility with more limited features was also made available as part of the earlier Microsoft IPv6 Technology Preview for Windows 2000.</span></span>

<span data-ttu-id="11c5f-109">Les sections suivantes décrivent l’utilisation de l’utilitaire *Checkv4.exe* , puis expliquent l’approche recommandée pour la modification d’une application IPv4 existante afin de prendre en charge IPv6.</span><span class="sxs-lookup"><span data-stu-id="11c5f-109">The following sections describe how to use the *Checkv4.exe* utility, then explain the recommended approach for modifying an existing IPv4 application to support IPv6.</span></span>

## <a name="recommendations-for-running-checkv4exe"></a><span data-ttu-id="11c5f-110">Recommandations pour l’exécution de Checkv4.exe</span><span class="sxs-lookup"><span data-stu-id="11c5f-110">Recommendations for Running Checkv4.exe</span></span>

-   <span data-ttu-id="11c5f-111">L’utilitaire *Checkv4.exe* est simple.</span><span class="sxs-lookup"><span data-stu-id="11c5f-111">The *Checkv4.exe* utility is straightforward.</span></span> <span data-ttu-id="11c5f-112">Exécutez simplement *Checkv4.exe* sur la ligne de commande avec le nom du fichier que vous souhaitez vérifier comme paramètre.</span><span class="sxs-lookup"><span data-stu-id="11c5f-112">Simply execute *Checkv4.exe* at the command line with the name of the file you want to check as the parameter.</span></span> <span data-ttu-id="11c5f-113">*Checkv4.exe* analyse le fichier et fournit des commentaires sur l’emplacement des problèmes de Portage IPv6 dans ce fichier.</span><span class="sxs-lookup"><span data-stu-id="11c5f-113">*Checkv4.exe* parses the file and provides feedback as to where IPv6 porting issues exist in that file.</span></span> <span data-ttu-id="11c5f-114">Le fait de placer le *Checkv4.exe* dans le chemin de votre ordinateur facilite grandement l’exécution de l’utilitaire *Checkv4.exe* à partir de n’importe quel endroit dans votre structure de répertoires de code source.</span><span class="sxs-lookup"><span data-stu-id="11c5f-114">Placing the *Checkv4.exe* into your computer's path makes running the *Checkv4.exe* utility from anywhere in your source code directory structure much easier.</span></span> <span data-ttu-id="11c5f-115">Par exemple, le placement de *Checkv4.exe* dans% windir% vous permet de lancer des *Checkv4.exe* à partir de n’importe quel répertoire sur votre ordinateur sans inclure son chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="11c5f-115">For example, placing *Checkv4.exe* into %windir% enables you to launch *Checkv4.exe* from any directory on your computer without including its path.</span></span>

-   <span data-ttu-id="11c5f-116">Exécutez la commande suivante à l’invite de commandes pour analyser le fichier Simplec. c :</span><span class="sxs-lookup"><span data-stu-id="11c5f-116">Issue the following command at the command prompt to parse the file Simplec.c:</span></span>

    <span data-ttu-id="11c5f-117">**Checkv4 simplec. c**</span><span class="sxs-lookup"><span data-stu-id="11c5f-117">**Checkv4 simplec.c**</span></span>

    <span data-ttu-id="11c5f-118">Notez que certaines recommandations formulées par l’utilitaire *Checkv4.exe* requièrent des structures disponibles uniquement dans les versions récentes du fichier d’en-tête *Ws2tcpip. h* , telles que la structure **sockaddr \_ in6** .</span><span class="sxs-lookup"><span data-stu-id="11c5f-118">Note that some of the recommendations made by the *Checkv4.exe* utility require structures available only in recent versions of the *Ws2tcpip.h* header file, such as the **SOCKADDR\_IN6** structure.</span></span> <span data-ttu-id="11c5f-119">Ces fichiers d’en-tête sont inclus dans la SDK Windows publiée pour Windows Vista et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="11c5f-119">These header files are included in the Windows SDK released for Windows Vista and later.</span></span> <span data-ttu-id="11c5f-120">Ces fichiers d’en-tête sont également inclus dans le kit de développement logiciel (SDK) de plateforme précédent publié pour Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="11c5f-120">These header files are also included in the earlier Platform Software Development Kit (SDK) released for Windows Server 2003.</span></span> <span data-ttu-id="11c5f-121">Ces fichiers d’en-tête sont également inclus dans le cadre d’un abonnement MSDN ou par téléchargement.</span><span class="sxs-lookup"><span data-stu-id="11c5f-121">These header files are also included as part of an MSDN subscription or by download.</span></span>

    <span data-ttu-id="11c5f-122">La capture d’écran suivante affiche les résultats de l’utilisation de l’utilitaire *Checkv4.exe* sur le fichier Simplec. c inclus dans l’annexe A :</span><span class="sxs-lookup"><span data-stu-id="11c5f-122">The following screen shot displays the results of using the *Checkv4.exe* utility on the Simplec.c file included in Appendix A:</span></span>

    ![checkv4.exe signale des incompatibilités IPv6 dans le fichier simplec. c](images/portingguide002.jpg)

    <span data-ttu-id="11c5f-124">La capture d’écran suivante affiche les résultats de l’utilisation de l’utilitaire *Checkv4.exe* sur le fichier simple. c, qui est également inclus dans l’annexe A :</span><span class="sxs-lookup"><span data-stu-id="11c5f-124">The following screen shot displays the results of using the *Checkv4.exe* utility on the Simples.c file, which is also included in Appendix A:</span></span>

    ![checkv4.exe signale des incompatibilités IPv6 dans le fichier simple. c](images/portingguide003.jpg)

## <a name="the-application-modification-process-where-to-start"></a><span data-ttu-id="11c5f-126">Processus de modification de l’application : où démarrer</span><span class="sxs-lookup"><span data-stu-id="11c5f-126">The Application Modification Process: Where to Start</span></span>

<span data-ttu-id="11c5f-127">Il existe une procédure recommandée associée à l’ajout de la fonctionnalité IPv6 aux applications.</span><span class="sxs-lookup"><span data-stu-id="11c5f-127">There is a recommended procedure associated with adding IPv6 capability to applications.</span></span> <span data-ttu-id="11c5f-128">Le fait de suivre cette séquence est bénéfique, car il permet aux développeurs de s’assurer que toutes les étapes nécessaires à la modification d’une application IPv4 existante pour prendre en charge IPv6 sont prises.</span><span class="sxs-lookup"><span data-stu-id="11c5f-128">Following this sequence is beneficial, because it enables developers to ensure that all steps necessary to modify an existing IPv4 application to support IPv6 are taken.</span></span> <span data-ttu-id="11c5f-129">Certaines applications peuvent nécessiter une attention toute particulière à l’une de ces séquences. par exemple, un service système aura probablement moins de problèmes d’interface utilisateur qu’un programme de transfert de fichiers graphique (FTP).</span><span class="sxs-lookup"><span data-stu-id="11c5f-129">Certain applications may require more extensive attention to one of these sequences; for example, a system service would likely have less user interface issues than a graphical file transfer program (FTP).</span></span>

<span data-ttu-id="11c5f-130">**Pour modifier des applications IPv4 pour prendre en charge IPv6**</span><span class="sxs-lookup"><span data-stu-id="11c5f-130">**To modify IPv4 applications to support IPv6**</span></span>

1.  <span data-ttu-id="11c5f-131">Corrigez les structures et les déclarations pour activer la compatibilité IPv6 et IPv4.</span><span class="sxs-lookup"><span data-stu-id="11c5f-131">Fix structures and declarations to enable IPv6 and IPv4 compatibility.</span></span>
2.  <span data-ttu-id="11c5f-132">Modifiez les appels de fonction pour tirer parti des fonctions compatibles IPv6, telles que les fonctions [**getaddrinfo**](/windows/desktop/api/Ws2tcpip/nf-ws2tcpip-getaddrinfo) et [**GetNameInfo**](/windows/desktop/api/Ws2tcpip/nf-ws2tcpip-getnameinfo) .</span><span class="sxs-lookup"><span data-stu-id="11c5f-132">Modify function calls to take advantage of IPv6-enabled functions, such as the [**getaddrinfo**](/windows/desktop/api/Ws2tcpip/nf-ws2tcpip-getaddrinfo) and [**getnameinfo**](/windows/desktop/api/Ws2tcpip/nf-ws2tcpip-getnameinfo) functions.</span></span>
3.  <span data-ttu-id="11c5f-133">Examinez le code source pour l’utilisation d’adresses IPv4 codées en dur, telles que l’adresse de bouclage, ou l’utilisation d’autres chaînes littérales.</span><span class="sxs-lookup"><span data-stu-id="11c5f-133">Review source code for the use of hard-coded IPv4 addresses such as the loopback address, or the use of other literal strings.</span></span>
4.  <span data-ttu-id="11c5f-134">Effectuer un examen approfondi de l’interface utilisateur, y compris les boîtes de dialogue d’informations.</span><span class="sxs-lookup"><span data-stu-id="11c5f-134">Perform a thorough review of the user interface, including informational dialog boxes.</span></span> <span data-ttu-id="11c5f-135">Indiquez s’il est approprié pour les applications compatibles IPv6 de spécifier ou de fournir des informations sur l’adresse IP.</span><span class="sxs-lookup"><span data-stu-id="11c5f-135">Give thought to whether it is appropriate for IPv6-enabled applications to specify or provide IP-address based information.</span></span>
5.  <span data-ttu-id="11c5f-136">Déterminez si votre application s’appuie sur des protocoles sous-jacents, tels que RPC, et apportez des modifications de programmation appropriées pour gérer les adresses IPv6.</span><span class="sxs-lookup"><span data-stu-id="11c5f-136">Determine whether your application relies on underlying protocols, such as RPC, and make appropriate programmatic changes to handle IPv6 addresses.</span></span>
6.  <span data-ttu-id="11c5f-137">Utilisez l’indicateur de compilation IPV6STRICT lors de la compilation d’applications sur Windows XP et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="11c5f-137">Use the compile-time flag IPV6STRICT when compiling applications on Windows XP and later.</span></span> <span data-ttu-id="11c5f-138">Cet indicateur entraîne l’échec de la compilation du code incompatible, comme suit :</span><span class="sxs-lookup"><span data-stu-id="11c5f-138">This flag results in incompatible code failing to compile, as follows:</span></span>

    <span data-ttu-id="11c5f-139">Les applications Windows Sockets 1. x avec du code incompatible ne peuvent pas être compilées et retournent le message d’erreur « WINSOCK2 requis ».</span><span class="sxs-lookup"><span data-stu-id="11c5f-139">Windows Sockets 1.x applications with incompatible code fail to compile and return the error message "WINSOCK2 Required."</span></span>

    <span data-ttu-id="11c5f-140">Les applications Windows Sockets 2. x avec du code incompatible provoquent une erreur au moment de la compilation pour chaque instance du code incompatible.</span><span class="sxs-lookup"><span data-stu-id="11c5f-140">Windows Sockets 2.x applications with incompatible code cause a compile time error for each instance of incompatible code.</span></span> <span data-ttu-id="11c5f-141">Un message d’erreur est généré au format suivant :</span><span class="sxs-lookup"><span data-stu-id="11c5f-141">An error message is generated in the following format:</span></span>

    `[file name] ([line number]) : [error message] '[symbol]_IPV6INCOMPATIBLE'`

    <span data-ttu-id="11c5f-142">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="11c5f-142">For example:</span></span>

    `sample.c(8) : error C2065: 'gethostbyaddr_IPV6INCOMPATIBLE' : undeclared identifier`

 

 



