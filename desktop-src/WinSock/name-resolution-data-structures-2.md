---
description: Structures de données de résolution de noms dans Windows Sockets (Winsock).
ms.assetid: 87c54141-41e2-4eaa-ae3b-84598e8281d9
title: Structures de données de résolution de noms
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bf1f76607ade81503a1057dc21890ac38d5ec265
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104558461"
---
# <a name="name-resolution-data-structures"></a><span data-ttu-id="54137-103">Structures de données de résolution de noms</span><span class="sxs-lookup"><span data-stu-id="54137-103">Name Resolution Data Structures</span></span>

<span data-ttu-id="54137-104">Il existe plusieurs structures de données importantes qui sont largement utilisées dans les fonctions de résolution de noms.</span><span class="sxs-lookup"><span data-stu-id="54137-104">There are several important data structures that are used extensively throughout the name resolution functions.</span></span>

## <a name="query-related-data-structures"></a><span data-ttu-id="54137-105">Structures de données de Query-Related</span><span class="sxs-lookup"><span data-stu-id="54137-105">Query-Related Data Structures</span></span>

<span data-ttu-id="54137-106">La structure [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) permet de former des requêtes pour [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina)et de fournir des résultats de requête pour [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta).</span><span class="sxs-lookup"><span data-stu-id="54137-106">The [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure is used to form queries for [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina), and used to deliver query results for [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta).</span></span> <span data-ttu-id="54137-107">Il s’agit d’une structure complexe, car elle contient des pointeurs vers plusieurs autres structures, dont certaines font référence à d’autres structures.</span><span class="sxs-lookup"><span data-stu-id="54137-107">It is a complex structure since it contains pointers to several other structures, some of which reference still other structures.</span></span> <span data-ttu-id="54137-108">La relation entre la structure [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) et les structures qu’elle référence est illustrée ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="54137-108">The relationship between the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure and the structures it references is illustrated as follows.</span></span>

![relation entre wsaqueryset et ses structures associées](images/ovrvw3-2.png)

<span data-ttu-id="54137-110">Au sein de la structure [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) , la plupart des membres sont explicites, mais certaines méritent une explication supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="54137-110">Within the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure, most of the member are self explanatory, but some deserve additional explanation.</span></span> <span data-ttu-id="54137-111">Le membre **dwSize nul** doit toujours être renseigné avec sizeof (**WSAQUERYSET**), car il est utilisé par les fournisseurs d’espaces de noms pour détecter et s’adapter aux différentes versions de la structure **WSAQUERYSET** qui peuvent apparaître au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="54137-111">The **dwSize** member must always be filled in with sizeof(**WSAQUERYSET**), as this is used by namespace providers to detect and adapt to different versions of the **WSAQUERYSET** structure that may appear over time.</span></span>

<span data-ttu-id="54137-112">Le membre **dwOutputFlags** est utilisé par un fournisseur d’espaces de noms pour fournir des informations supplémentaires sur les résultats de la requête.</span><span class="sxs-lookup"><span data-stu-id="54137-112">The **dwOutputFlags** member is used by a namespace provider to provide additional information about query results.</span></span> <span data-ttu-id="54137-113">Pour plus d’informations, consultez la fonction [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) .</span><span class="sxs-lookup"><span data-stu-id="54137-113">For details, see the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function.</span></span>

<span data-ttu-id="54137-114">La structure [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) référencée par le membre **lpVersion** est utilisée à la fois pour la contrainte de requête et les résultats.</span><span class="sxs-lookup"><span data-stu-id="54137-114">The [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) structure referenced by the **lpversion** member is used for both query constraint and results.</span></span> <span data-ttu-id="54137-115">Pour les requêtes, le membre **dwVersion** indique la version souhaitée du service.</span><span class="sxs-lookup"><span data-stu-id="54137-115">For queries, the **dwVersion** member indicates the desired version of the service.</span></span> <span data-ttu-id="54137-116">Le membre **ecHow** est un type énuméré qui spécifie la façon dont la comparaison peut être effectuée.</span><span class="sxs-lookup"><span data-stu-id="54137-116">The **ecHow** member is an enumerated type which specifies how the comparison can be made.</span></span> <span data-ttu-id="54137-117">Les choix possibles sont \_ égal à, ce qui nécessite qu’une correspondance exacte dans la version se produise, ou comp \_ NOTLESS, qui spécifie que le numéro de version du service ne doit pas être inférieur à la valeur du membre **dwVersion** .</span><span class="sxs-lookup"><span data-stu-id="54137-117">The choices are COMP\_EQUALS which requires that an exact match in version occurs, or COMP\_NOTLESS which specifies that the service's version number be no less than the value of the **dwVersion** member.</span></span>

<span data-ttu-id="54137-118">L’interprétation de **dwNameSpace** et de **lpNSProviderId** dépend de la façon dont la structure est utilisée et est décrite plus en détail dans les descriptions de fonction individuelles qui utilisent cette structure.</span><span class="sxs-lookup"><span data-stu-id="54137-118">The interpretation of **dwNameSpace** and **lpNSProviderId** depends upon how the structure is being used and is described further in the individual function descriptions that utilize this structure.</span></span>

<span data-ttu-id="54137-119">Le membre **lpszContext** s’applique aux espaces de noms hiérarchiques et spécifie le point de départ d’une requête ou l’emplacement dans la hiérarchie où le service réside.</span><span class="sxs-lookup"><span data-stu-id="54137-119">The **lpszContext** member applies to hierarchical namespaces, and specifies the starting point of a query or the location within the hierarchy where the service resides.</span></span> <span data-ttu-id="54137-120">Les règles générales sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="54137-120">The general rules are:</span></span>

-   <span data-ttu-id="54137-121">La valeur **null**("") commence la recherche dans le contexte par défaut.</span><span class="sxs-lookup"><span data-stu-id="54137-121">A value of **NULL**, blank ("") starts the search at the default context.</span></span>
-   <span data-ttu-id="54137-122">La valeur « \\ » démarre la recherche en haut de l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="54137-122">A value of "\\" starts the search at the top of the namespace.</span></span>
-   <span data-ttu-id="54137-123">Toute autre valeur commence la recherche au point désigné.</span><span class="sxs-lookup"><span data-stu-id="54137-123">Any other value starts the search at the designated point.</span></span>

<span data-ttu-id="54137-124">Les fournisseurs qui ne prennent pas en charge la relation contenant-contenu peuvent retourner une erreur si tout autre chose que « » ou « » \\ est spécifié.</span><span class="sxs-lookup"><span data-stu-id="54137-124">Providers that do not support containment may return an error if anything other than "" or "\\" is specified.</span></span> <span data-ttu-id="54137-125">Les fournisseurs qui prennent en charge la relation contenant-contenu limitée, tels que les groupes, doivent accepter « », « » \\ ou un point désigné.</span><span class="sxs-lookup"><span data-stu-id="54137-125">Providers that support limited containment, such as groups, should accept "", '\\", or a designated point.</span></span> <span data-ttu-id="54137-126">Les contextes sont spécifiques à l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="54137-126">Contexts are namespace specific.</span></span> <span data-ttu-id="54137-127">Si le membre **dwNameSpace** est NS \_ All, seul « » ou « » \\ doit être passé comme contexte, car ceux-ci sont reconnus par tous les espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="54137-127">If the **dwNameSpace** member is NS\_ALL, then only "" or "\\" should be passed as the context since these are recognized by all namespaces.</span></span>

<span data-ttu-id="54137-128">Le membre **lpszQueryString** est utilisé pour fournir des informations supplémentaires sur les requêtes spécifiques à l’espace de noms, telles qu’une chaîne décrivant un service et un nom de protocole de transport bien connus, comme dans « FTP/TCP ».</span><span class="sxs-lookup"><span data-stu-id="54137-128">The **lpszQueryString** member is used to supply additional, namespace-specific query information such as a string describing a well-known service and transport protocol name, as in "FTP/TCP".</span></span>

<span data-ttu-id="54137-129">La structure [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) référencée par le membre **lpafpProtocols** est utilisée à des fins de requête uniquement et fournit une liste de protocoles pour contraindre la requête.</span><span class="sxs-lookup"><span data-stu-id="54137-129">The [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) structure referenced by the **lpafpProtocols** member is used for query purposes only, and supplies a list of protocols to constrain the query.</span></span> <span data-ttu-id="54137-130">Ces protocoles sont représentés par des paires (de famille d’adresses, protocole), car les valeurs de protocole n’ont que la signification dans le contexte d’une famille d’adresses.</span><span class="sxs-lookup"><span data-stu-id="54137-130">These protocols are represented as (address family, protocol) pairs, since protocol values only have meaning within the context of an address family.</span></span>

<span data-ttu-id="54137-131">Le tableau de la structure d' [**\_ informations CSADDR**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) référencé par le membre **lpcsaBuffer** contient toutes les informations nécessaires pour qu’un service soit utilisé pour établir une écoute, ou pour qu’un client l’utilise pour établir une connexion au service.</span><span class="sxs-lookup"><span data-stu-id="54137-131">The array of the [**CSADDR\_INFO**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) structure referenced by the **lpcsaBuffer** member contain all of the information needed for either a service to use in establishing a listen, or for a client to use in establishing a connection to the service.</span></span> <span data-ttu-id="54137-132">Les membres **LocalAddr** et **RemoteAddr** contiennent directement une structure [**d' \_ adresse de socket**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) .</span><span class="sxs-lookup"><span data-stu-id="54137-132">The **LocalAddr** and **RemoteAddr** members both directly contain a [**SOCKET\_ADDRESS**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) structure.</span></span>

<span data-ttu-id="54137-133">Un service crée un socket en appelant la fonction [**Socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) ou [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) à l’aide du Tuple *de LocalAddr. lpSockaddr->sa \_ Family*, *iSocketType* et *iProtocol* comme paramètres.</span><span class="sxs-lookup"><span data-stu-id="54137-133">A service would create a socket by calling the [**socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) or [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) function using the tuple of *LocalAddr.lpSockaddr->sa\_family*, *iSocketType*, and *iProtocol* as parameters.</span></span> <span data-ttu-id="54137-134">Un service lie le socket à une adresse locale en appelant la fonction [**Bind**](/windows/desktop/api/winsock/nf-winsock-bind) à l’aide de *LocalAddr. lpSockaddr* et *LocalAddr. lpSockaddrLength* en tant que paramètres.</span><span class="sxs-lookup"><span data-stu-id="54137-134">A service would bind the socket to a local address by calling the [**bind**](/windows/desktop/api/winsock/nf-winsock-bind) function using *LocalAddr.lpSockaddr* and *LocalAddr.lpSockaddrLength* as parameters.</span></span>

<span data-ttu-id="54137-135">Un client crée son socket en appelant la fonction [**Socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) ou [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) à l’aide du tuple de *LocalAddr. lpSockaddr->sa \_ Family*, *iSocketType* et *iProtocol* comme paramètres.</span><span class="sxs-lookup"><span data-stu-id="54137-135">A client creates its socket by calling the [**socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) or [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) function using the tuple of *LocalAddr.lpSockaddr->sa\_family*, *iSocketType*, and *iProtocol* as parameters.</span></span> <span data-ttu-id="54137-136">Un client utilise la combinaison de *RemoteAddr. lpSockaddr* et *RemoteAddr. lpSockaddrLength* comme paramètres lors de l’établissement d’une connexion à distance à l’aide de la fonction [**Connect**](/windows/desktop/api/Winsock2/nf-winsock2-connect), [**ConnectEx**](/windows/desktop/api/Mswsock/nc-mswsock-lpfn_connectex)ou [**WSAConnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) .</span><span class="sxs-lookup"><span data-stu-id="54137-136">A client uses the combination of *RemoteAddr.lpSockaddr* and *RemoteAddr.lpSockaddrLength* as parameters when making a remote connection using the [**connect**](/windows/desktop/api/Winsock2/nf-winsock2-connect), [**ConnectEx**](/windows/desktop/api/Mswsock/nc-mswsock-lpfn_connectex), or [**WSAConnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) function.</span></span>

## <a name="service-class-data-structures"></a><span data-ttu-id="54137-137">Structures de données de classe de service</span><span class="sxs-lookup"><span data-stu-id="54137-137">Service Class Data Structures</span></span>

<span data-ttu-id="54137-138">Quand une nouvelle classe de service est installée, une structure [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) doit être préparée et fournie.</span><span class="sxs-lookup"><span data-stu-id="54137-138">When a new service class is installed, a [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure must be prepared and supplied.</span></span> <span data-ttu-id="54137-139">Cette structure se compose également de sous-structures qui contiennent une série de membres qui s’appliquent à des espaces de noms spécifiques.</span><span class="sxs-lookup"><span data-stu-id="54137-139">This structure also consists of substructures that contain a series of members that apply to specific namespaces.</span></span> <span data-ttu-id="54137-140">Une structure de données d’informations de classe se présente comme suit :</span><span class="sxs-lookup"><span data-stu-id="54137-140">A class info data structure is as follows:</span></span>

![architecture des structures de données de classe de service](images/ovrvw3-3.png)

<span data-ttu-id="54137-142">Pour chaque classe de service, il existe une seule structure [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) .</span><span class="sxs-lookup"><span data-stu-id="54137-142">For each service class, there is a single [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure.</span></span> <span data-ttu-id="54137-143">Dans la structure [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) , l’identificateur unique de la classe de service est contenu dans le membre **lpServiceClassId** , et une chaîne d’affichage associée est référencée par le membre **lpServiceClassName** .</span><span class="sxs-lookup"><span data-stu-id="54137-143">Within the [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure, the service class' unique identifier is contained in the **lpServiceClassId** member, and an associated display string is referenced by the **lpServiceClassName** member.</span></span> <span data-ttu-id="54137-144">Il s’agit de la chaîne retournée par la fonction [**WSAGetServiceClassNameByClassId**](/windows/desktop/api/Winsock2/nf-winsock2-wsagetserviceclassnamebyclassida) .</span><span class="sxs-lookup"><span data-stu-id="54137-144">This is the string that is returned by the [**WSAGetServiceClassNameByClassId**](/windows/desktop/api/Winsock2/nf-winsock2-wsagetserviceclassnamebyclassida) function.</span></span>

<span data-ttu-id="54137-145">Le membre **lpClassInfos** de la structure [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) fait référence à un tableau de structures **WSANSCLASSINFO** , chacune d’elles fournissant un membre nommé et typé qui s’applique à un espace de noms spécifié.</span><span class="sxs-lookup"><span data-stu-id="54137-145">The **lpClassInfos** member in the [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure references an array of **WSANSCLASSINFO** structures, each of which supplies a named and typed member that applies to a specified namespace.</span></span> <span data-ttu-id="54137-146">Exemples de valeurs pour le membre **lpszName** : « sapid », « TCPPort », « UdpPort », etc. Ces chaînes sont généralement spécifiques à l’espace de noms identifié dans le membre **dwNameSpace** .</span><span class="sxs-lookup"><span data-stu-id="54137-146">Examples of values for the **lpszName** member include: "SapId", "TcpPort", "UdpPort", etc. These strings are generally specific to the namespace identified in the **dwNameSpace** member.</span></span> <span data-ttu-id="54137-147">Les valeurs typiques du membre **dwValueType** peuvent être reg \_ DWORD, reg \_ SZ, etc. Le membre **dwValueSize** indique la longueur de l’élément de données vers lequel pointe **lpValue**.</span><span class="sxs-lookup"><span data-stu-id="54137-147">Typical values for the **dwValueType** member might be REG\_DWORD, REG\_SZ, etc. The **dwValueSize** member indicates the length of the data item pointed to by **lpValue**.</span></span>

<span data-ttu-id="54137-148">L’intégralité de la collection de données représentée dans une structure **WSASERVICECLASSINFO** est fournie à chaque fournisseur d’espaces de noms lorsque la fonction [**WSAInstallServiceClass**](/windows/desktop/api/Winsock2/nf-winsock2-wsainstallserviceclassa) est appelée.</span><span class="sxs-lookup"><span data-stu-id="54137-148">The entire collection of data represented in a **WSASERVICECLASSINFO** structure is provided to each namespace provider when the [**WSAInstallServiceClass**](/windows/desktop/api/Winsock2/nf-winsock2-wsainstallserviceclassa) function is invoked.</span></span> <span data-ttu-id="54137-149">Chaque fournisseur d’espace de noms individuel passe ensuite en revue la liste des structures **WSANSCLASSINFO** et conserve les informations qui lui sont applicables.</span><span class="sxs-lookup"><span data-stu-id="54137-149">Each individual namespace provider then sifts through the list of **WSANSCLASSINFO** structures and retains the information applicable to it.</span></span>

## <a name="related-topics"></a><span data-ttu-id="54137-150">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="54137-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="54137-151">**AFPROTOCOLS**</span><span class="sxs-lookup"><span data-stu-id="54137-151">**AFPROTOCOLS**</span></span>](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols)
</dt> <dt>

[<span data-ttu-id="54137-152">**\_informations CSADDR**</span><span class="sxs-lookup"><span data-stu-id="54137-152">**CSADDR\_INFO**</span></span>](/windows/win32/api/ws2def/ns-ws2def-csaddr_info)
</dt> <dt>

[<span data-ttu-id="54137-153">Modèle de résolution de noms</span><span class="sxs-lookup"><span data-stu-id="54137-153">Name Resolution Model</span></span>](name-resolution-model-2.md)
</dt> <dt>

[<span data-ttu-id="54137-154">Résolution de noms indépendante du protocole</span><span class="sxs-lookup"><span data-stu-id="54137-154">Protocol-Independent Name Resolution</span></span>](protocol-independent-name-resolution-2.md)
</dt> <dt>

[<span data-ttu-id="54137-155">Inscription et résolution de noms</span><span class="sxs-lookup"><span data-stu-id="54137-155">Registration and Name Resolution</span></span>](registration-and-name-resolution-2.md)
</dt> <dt>

[<span data-ttu-id="54137-156">**adresse du SOCKET \_**</span><span class="sxs-lookup"><span data-stu-id="54137-156">**SOCKET\_ADDRESS**</span></span>](/windows/desktop/api/Ws2def/ns-ws2def-socket_address)
</dt> <dt>

[<span data-ttu-id="54137-157">Résumé des fonctions de résolution de noms</span><span class="sxs-lookup"><span data-stu-id="54137-157">Summary of Name Resolution Functions</span></span>](summary-of-name-resolution-functions-2.md)
</dt> <dt>

[<span data-ttu-id="54137-158">**WSAECOMPARATOR**</span><span class="sxs-lookup"><span data-stu-id="54137-158">**WSAECOMPARATOR**</span></span>](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator)
</dt> <dt>

[<span data-ttu-id="54137-159">**WSAGetServiceClassNameByClassId**</span><span class="sxs-lookup"><span data-stu-id="54137-159">**WSAGetServiceClassNameByClassId**</span></span>](/windows/desktop/api/Winsock2/nf-winsock2-wsagetserviceclassnamebyclassida)
</dt> <dt>

[<span data-ttu-id="54137-160">**WSAInstallServiceClass**</span><span class="sxs-lookup"><span data-stu-id="54137-160">**WSAInstallServiceClass**</span></span>](/windows/desktop/api/Winsock2/nf-winsock2-wsainstallserviceclassa)
</dt> <dt>

[<span data-ttu-id="54137-161">**WSALookupServiceBegin**</span><span class="sxs-lookup"><span data-stu-id="54137-161">**WSALookupServiceBegin**</span></span>](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina)
</dt> <dt>

[<span data-ttu-id="54137-162">**WSAQUERYSET**</span><span class="sxs-lookup"><span data-stu-id="54137-162">**WSAQUERYSET**</span></span>](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw)
</dt> <dt>

[<span data-ttu-id="54137-163">**WSASERVICECLASSINFO**</span><span class="sxs-lookup"><span data-stu-id="54137-163">**WSASERVICECLASSINFO**</span></span>](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow)
</dt> </dl>

 

 
