---
title: DLL d’administration RAS
description: La DLL exporte les fonctions que le serveur RAS appelle chaque fois qu’un utilisateur tente de se connecter ou de se déconnecter.
ms.assetid: 014ab85d-8924-4c7a-89ed-f83e75318ca6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0908032e0916f0937e964408b1551d3f1515dea
ms.sourcegitcommit: cba7f424a292fd7f3a8518947b9466439b455419
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/23/2019
ms.locfileid: "104313780"
---
# <a name="ras-administration-dll"></a><span data-ttu-id="9bfd3-103">DLL d’administration RAS</span><span class="sxs-lookup"><span data-stu-id="9bfd3-103">RAS administration DLL</span></span>

<span data-ttu-id="9bfd3-104">La DLL exporte les fonctions que le serveur RAS appelle chaque fois qu’un utilisateur tente de se connecter ou de se déconnecter.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-104">The DLL exports functions that the RAS server calls whenever a user tries to connect or disconnect.</span></span> <span data-ttu-id="9bfd3-105">Vous pouvez utiliser la DLL pour effectuer les fonctions d’administration suivantes :</span><span class="sxs-lookup"><span data-stu-id="9bfd3-105">You can use the DLL to perform the following administrative functions:</span></span>

-   <span data-ttu-id="9bfd3-106">Décidez s’il faut autoriser un utilisateur à se connecter au serveur.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-106">Decide whether to allow a user to connect to the server.</span></span> <span data-ttu-id="9bfd3-107">Cela peut fournir une vérification de sécurité en plus de l’authentification utilisateur RAS standard.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-107">This can provide a security check in addition to the standard RAS user authentication.</span></span>
-   <span data-ttu-id="9bfd3-108">Enregistrez l’heure à laquelle chaque utilisateur se connecte et se déconnecte du serveur.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-108">Record the time that each user connects to and disconnects from the server.</span></span> <span data-ttu-id="9bfd3-109">Cela peut être utile à des fins de facturation ou d’audit.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-109">This can be useful for billing or auditing purposes.</span></span>
-   <span data-ttu-id="9bfd3-110">Attribuez une adresse IP à chaque utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-110">Assign an IP address to each user.</span></span> <span data-ttu-id="9bfd3-111">Cela peut être utile pour des raisons de sécurité afin de mapper la connexion d’un utilisateur à un ordinateur spécifique.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-111">This can be useful for security purposes to map a user's connection to a specific computer.</span></span>

<span data-ttu-id="9bfd3-112">Implémentez les fonctions suivantes lors du développement d’une DLL d’administration de serveur RAS.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-112">Implement the following functions when developing a RAS server administration DLL.</span></span>

-   [<span data-ttu-id="9bfd3-113">**RasAdminAcceptNewConnection**</span><span class="sxs-lookup"><span data-stu-id="9bfd3-113">**RasAdminAcceptNewConnection**</span></span>](rasadminacceptnewconnection.md)
-   [<span data-ttu-id="9bfd3-114">**RasAdminConnectionHangupNotification**</span><span class="sxs-lookup"><span data-stu-id="9bfd3-114">**RasAdminConnectionHangupNotification**</span></span>](rasadminconnectionhangupnotification.md)
-   [<span data-ttu-id="9bfd3-115">**RasAdminGetIpAddressForUser**</span><span class="sxs-lookup"><span data-stu-id="9bfd3-115">**RasAdminGetIpAddressForUser**</span></span>](rasadmingetipaddressforuser.md)
-   [<span data-ttu-id="9bfd3-116">**RasAdminReleaseIpAddress**</span><span class="sxs-lookup"><span data-stu-id="9bfd3-116">**RasAdminReleaseIpAddress**</span></span>](rasadminreleaseipaddress.md)

<span data-ttu-id="9bfd3-117">Une DLL d’administration RAS doit implémenter et exporter toutes les fonctions ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-117">A RAS administration DLL must implement and export all of the above functions.</span></span> <span data-ttu-id="9bfd3-118">Si l’une des fonctions n’est pas implémentée, le démarrage du service d’accès à distance échoue.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-118">If any of the functions are not implemented, the remote access service will fail to start.</span></span>

<span data-ttu-id="9bfd3-119">Les fonctions [**RasAdminAcceptNewConnection**](rasadminacceptnewconnection.md) et [**RasAdminConnectionHangupNotification**](rasadminconnectionhangupnotification.md) permettent à la dll d’auditer les connexions utilisateur au serveur.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-119">The [**RasAdminAcceptNewConnection**](rasadminacceptnewconnection.md) and [**RasAdminConnectionHangupNotification**](rasadminconnectionhangupnotification.md) functions enable the DLL to audit user connections to the server.</span></span> <span data-ttu-id="9bfd3-120">Un serveur RAS Windows NT/Windows 2000 appelle la fonction **RasAdminAcceptNewConnection** chaque fois qu’un utilisateur tente de se connecter.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-120">A Windows NT/Windows 2000 RAS server calls the **RasAdminAcceptNewConnection** function whenever a user tries to connect.</span></span> <span data-ttu-id="9bfd3-121">La fonction peut empêcher l’utilisateur de se connecter.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-121">The function can prevent the user from connecting.</span></span> <span data-ttu-id="9bfd3-122">Vous pouvez également utiliser la fonction pour générer une entrée dans un journal pour la facturation ou l’audit.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-122">You can also use the function to generate an entry in a log for billing or auditing.</span></span> <span data-ttu-id="9bfd3-123">Lorsque l’utilisateur se déconnecte, le serveur RAS appelle la fonction **RasAdminConnectionHangupNotification** , qui peut consigner l’heure à laquelle l’utilisateur s’est déconnecté.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-123">When the user disconnects, the RAS server calls the **RasAdminConnectionHangupNotification** function, which can log the time at which the user disconnected.</span></span>

<span data-ttu-id="9bfd3-124">Une fois que le serveur RAS a authentifié un appelant, il appelle la fonction [**RasAdminGetIpAddressForUser**](rasadmingetipaddressforuser.md) pour obtenir une adresse IP pour le client distant.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-124">After the RAS server has authenticated a caller, it calls the [**RasAdminGetIpAddressForUser**](rasadmingetipaddressforuser.md) function to get an IP address for the remote client.</span></span> <span data-ttu-id="9bfd3-125">La DLL peut utiliser cette fonction pour fournir un autre schéma de mappage d’une adresse IP à un utilisateur d’accès à distance.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-125">The DLL can use this function to provide an alternate scheme for mapping an IP address to a dial-in user.</span></span> <span data-ttu-id="9bfd3-126">Si **RasAdminGetIpAddressForUser** n’est pas implémenté, un serveur RAS connecte un utilisateur distant à une adresse IP sélectionnée à partir d’un pool statique d’adresses IP, ou une option sélectionnée par un serveur DHCP (Dynamic Host Configuration Protocol).</span><span class="sxs-lookup"><span data-stu-id="9bfd3-126">If **RasAdminGetIpAddressForUser** is not implemented, a RAS server connects a remote user to an IP address selected from a static pool of IP addresses, or one selected by a Dynamic Host Configuration Protocol (DHCP) server.</span></span> <span data-ttu-id="9bfd3-127">La fonction **RasAdminGetIpAddressForUser** permet à la dll de remplacer cette adresse IP par défaut et de spécifier une adresse IP spécifique pour chaque utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-127">The **RasAdminGetIpAddressForUser** function allows the DLL to override this default IP address and specify a particular IP address for each user.</span></span> <span data-ttu-id="9bfd3-128">La fonction **RasAdminGetIpAddressForUser** peut définir un indicateur qui force RAS à appeler la fonction [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) lorsque l’utilisateur se déconnecte.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-128">The **RasAdminGetIpAddressForUser** function can set a flag that causes RAS to call the [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) function when the user disconnects.</span></span> <span data-ttu-id="9bfd3-129">La DLL peut utiliser [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) pour mettre à jour son mappage utilisateur-adresse IP.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-129">The DLL can use [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) to update its user-to-IP-address map.</span></span>

<span data-ttu-id="9bfd3-130">RAS sérialise les appels dans la DLL d’administration.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-130">RAS serializes calls into the administration DLL.</span></span> <span data-ttu-id="9bfd3-131">Un appel à l’une des fonctions de la DLL pour un client RAS donné n’est jamais devancé par un appel à cette fonction pour un autre client RAS. l’appel initial est garanti être terminé avant que RAS appelle la fonction pour l’autre client.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-131">A call into one of the DLL's functions for a given RAS client will never be preempted by a call to that function for a different RAS client; the initial call is guaranteed to be complete before RAS calls the function for the other client.</span></span> <span data-ttu-id="9bfd3-132">En outre, la sérialisation s’étend à certains groupes de fonctions.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-132">Furthermore, serialization extends to certain groups of functions.</span></span> <span data-ttu-id="9bfd3-133">Les fonctions d’adresse IP sont sérialisées en tant que groupe ; un appel dans [**RasAdminGetIpAddressForUser**](rasadmingetipaddressforuser.md) ou [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) bloquera les appels jusqu’à ce que l’appel initial soit terminé.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-133">The IP address functions are serialized as a group; a call into either [**RasAdminGetIpAddressForUser**](rasadmingetipaddressforuser.md) or [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) will block calls into both until the initial call is complete.</span></span> <span data-ttu-id="9bfd3-134">[**RasAdminAcceptNewConnection**](rasadminacceptnewconnection.md) et [**RasAdminConnectionHangupNotification**](rasadminconnectionhangupnotification.md) sont également sérialisés en tant que groupe.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-134">[**RasAdminAcceptNewConnection**](rasadminacceptnewconnection.md) and [**RasAdminConnectionHangupNotification**](rasadminconnectionhangupnotification.md) are also serialized as a group.</span></span>

<span data-ttu-id="9bfd3-135">RAS exécute les fonctions permettant d’attribuer des adresses IP dans un processus et exécute les fonctions pour les notifications de connexion et de déconnexion dans un autre processus.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-135">RAS executes the functions for assigning IP addresses in one process and executes the functions for connection and disconnection notifications in another process.</span></span> <span data-ttu-id="9bfd3-136">Par conséquent, la DLL ne doit pas dépendre des données partagées entre les deux ensembles de fonctions.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-136">Consequently, the DLL should not depend on shared data between the two sets of functions.</span></span>

<span data-ttu-id="9bfd3-137">Le serveur RAS consigne une erreur dans le journal des événements système si une erreur se produit lors de la tentative de chargement d’une DLL d’administration RAS ou lors de l’appel de l’une des fonctions de la DLL.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-137">The RAS server logs an error in the system event log if an error occurs when it tries to load a RAS administration DLL or when calling one of the DLL's functions.</span></span> <span data-ttu-id="9bfd3-138">Cela peut se produire, par exemple, si la DLL spécifiait un nom incorrect pour une fonction exportée, ou si elle n’incluait pas le nom de la fonction dans le fichier. def.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-138">This can happen, for example, if the DLL specified the wrong name for an exported function, or if it did not include the function name in the .def file.</span></span> <span data-ttu-id="9bfd3-139">L’entrée dans le journal des événements indique la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-139">The entry in the event log indicates the reason for the failure.</span></span>

<span data-ttu-id="9bfd3-140">**Windows 2000 Server et versions ultérieures :** Les dll d’administration RAS qui implémentent cette interface de fonction ne fonctionnent plus.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-140">**Windows 2000 Server and later:** RAS administration DLLs that implement this function interface no longer work.</span></span> <span data-ttu-id="9bfd3-141">Au lieu de cela, utilisez l’interface de fonction MprAdmin fournie avec les versions plus récentes de Windows.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-141">Instead, use the MprAdmin function interface provided with the more recent versions of Windows.</span></span> <span data-ttu-id="9bfd3-142">Pour plus d’informations, consultez les informations de référence sur l' [administration RAS](remote-access-service-administration-reference.md) dans la documentation routage et accès distant.</span><span class="sxs-lookup"><span data-stu-id="9bfd3-142">For more information, see the [RAS Administration Reference](remote-access-service-administration-reference.md) in the Routing and RAS documentation.</span></span>

 

 




