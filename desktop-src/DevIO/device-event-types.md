---
description: Pour déterminer le type d’événement de l’appareil lors du traitement d’un \_ message WM DEVICECHANGE, examinez le paramètre wParam.
ms.assetid: 17078548-879d-4a11-a268-27d1f30180ab
title: Types d’événements d’appareil
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35ece6b810ba4d1310638bbfbdcdcaa7f67f79d8
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104033681"
---
# <a name="device-event-types"></a><span data-ttu-id="f8a4d-103">Types d’événements d’appareil</span><span class="sxs-lookup"><span data-stu-id="f8a4d-103">Device Event Types</span></span>

<span data-ttu-id="f8a4d-104">Pour déterminer le type d’événement de l’appareil lors du traitement d’un message [**WM \_ DEVICECHANGE**](wm-devicechange.md) , examinez le paramètre *wParam* .</span><span class="sxs-lookup"><span data-stu-id="f8a4d-104">To determine the device event type when processing a [**WM\_DEVICECHANGE**](wm-devicechange.md) message, examine the *wParam* parameter.</span></span> <span data-ttu-id="f8a4d-105">La valeur de *wParam* détermine la signification des données spécifiques à l’événement dans le paramètre *lParam* .</span><span class="sxs-lookup"><span data-stu-id="f8a4d-105">The value of *wParam* determines the meaning of the event-specific data in the *lParam* parameter.</span></span> <span data-ttu-id="f8a4d-106">En général, les données spécifiques à l’événement identifient l’appareil et fournissent des détails supplémentaires sur l’événement.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-106">In general, the event-specific data identifies the device and provides additional detail about the event.</span></span> <span data-ttu-id="f8a4d-107">Le format de ces données dépend du type d’appareil, mais les premiers octets ont toujours le même format que la structure [**\_ \_ HDR de diffusion dev**](/windows/desktop/api/Dbt/ns-dbt-dev_broadcast_hdr) .</span><span class="sxs-lookup"><span data-stu-id="f8a4d-107">The format of this data depends on the device type, but the first few bytes always have the same format as the [**DEV\_BROADCAST\_HDR**](/windows/desktop/api/Dbt/ns-dbt-dev_broadcast_hdr) structure.</span></span> <span data-ttu-id="f8a4d-108">Pour déterminer le format des données, vérifiez le membre **dbch \_ DeviceType** .</span><span class="sxs-lookup"><span data-stu-id="f8a4d-108">To determine the format of the data, check the **dbch\_devicetype** member.</span></span>

<span data-ttu-id="f8a4d-109">Le système diffuse un événement de périphérique de type [DBT \_ DEVICEARRIVAL](dbt-devicearrival.md) (autrement dit, un message [**WM \_ DEVICECHANGE**](wm-devicechange.md) avec *wParam* défini sur DBT \_ DEVICEARRIVAL) chaque fois qu’un appareil a été inséré et qu’il est disponible pour utilisation.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-109">The system broadcasts a device event of type [DBT\_DEVICEARRIVAL](dbt-devicearrival.md) (that is, a [**WM\_DEVICECHANGE**](wm-devicechange.md) message with *wParam* set to DBT\_DEVICEARRIVAL) whenever a device has been inserted and is available for use.</span></span> <span data-ttu-id="f8a4d-110">En règle générale, les applications vérifient le type d’appareil et commencent à utiliser l’appareil immédiatement si cela est approprié.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-110">Applications typically check the device type and begin using the device immediately if it is appropriate.</span></span>

<span data-ttu-id="f8a4d-111">Le système diffuse un événement de périphérique [DBT \_ DEVICEQUERYREMOVE](dbt-devicequeryremove.md) pour demander l’autorisation de supprimer un appareil.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-111">The system broadcasts a [DBT\_DEVICEQUERYREMOVE](dbt-devicequeryremove.md) device event to request permission to remove a device.</span></span> <span data-ttu-id="f8a4d-112">Pour déterminer si elle a besoin de l’appareil, une application peut afficher une boîte de dialogue pour inviter l’utilisateur à fournir des instructions.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-112">To determine whether it needs the device, an application can display a dialog box to prompt the user for instructions.</span></span> <span data-ttu-id="f8a4d-113">Si une application détermine qu’elle a besoin de l’appareil, elle peut refuser cette demande et annuler la suppression en retournant la requête de diffusion \_ \_ Deny.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-113">If an application determines that it needs the device, it can deny this request and cancel the removal by returning BROADCAST\_QUERY\_DENY.</span></span> <span data-ttu-id="f8a4d-114">Si l’application n’a pas besoin de l’appareil, elle doit retourner la **valeur true**.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-114">If the application does not need the device, it must return **TRUE**.</span></span> <span data-ttu-id="f8a4d-115">Le système envoie immédiatement un message [DBT \_ DEVICEQUERYREMOVEFAILED](dbt-devicequeryremovefailed.md) si une application ou un pilote a annulé une demande précédente de suppression d’un appareil.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-115">The system immediately sends a [DBT\_DEVICEQUERYREMOVEFAILED](dbt-devicequeryremovefailed.md) message if any application or driver canceled a previous request to remove a device.</span></span>

<span data-ttu-id="f8a4d-116">Le système diffuse un événement d’appareil [DBT \_ DEVICEREMOVEPENDING](dbt-deviceremovepending.md) comme dernier avertissement avant la suppression d’un appareil.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-116">The system broadcasts a [DBT\_DEVICEREMOVEPENDING](dbt-deviceremovepending.md) device event as a last warning before a device is removed.</span></span> <span data-ttu-id="f8a4d-117">À ce stade, l’application ne peut pas annuler la suppression. par conséquent, si elle utilise l’appareil, elle doit préparer sa suppression pour éviter la perte de données.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-117">At this point, the application cannot cancel the removal, so if it is using the device it must prepare for its removal to prevent loss of data.</span></span> <span data-ttu-id="f8a4d-118">Cela est particulièrement important lors de la suppression d’une connexion réseau.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-118">This is especially important when a network connection is being removed.</span></span> <span data-ttu-id="f8a4d-119">L’application doit déterminer si l’un de ses fichiers ou canaux ouverts se trouve sur cette connexion.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-119">The application must determine whether any of its open files or pipes are on that connection.</span></span> <span data-ttu-id="f8a4d-120">Pour ce faire, il compare l’identificateur de ressource réseau dans les données spécifiques à l’événement du message avec les identificateurs de ressource obtenus précédemment pour les fichiers et les canaux.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-120">It can do this by comparing the network resource identifier in the event-specific data of the message with the resource identifiers previously obtained for the files and pipes.</span></span> <span data-ttu-id="f8a4d-121">Le système diffuse un événement d’appareil [DBT \_ DEVICEREMOVECOMPLETE](dbt-deviceremovecomplete.md) lorsqu’un appareil a été supprimé et n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-121">The system broadcasts a [DBT\_DEVICEREMOVECOMPLETE](dbt-deviceremovecomplete.md) device event when a device has been removed and is no longer available.</span></span>

<span data-ttu-id="f8a4d-122">Le système diffuse un événement de périphérique [DBT \_ QUERYCHANGECONFIG](dbt-querychangeconfig.md) pour demander l’autorisation de modifier la configuration actuelle (ancrer ou détacher).</span><span class="sxs-lookup"><span data-stu-id="f8a4d-122">The system broadcasts a [DBT\_QUERYCHANGECONFIG](dbt-querychangeconfig.md) device event to request permission to change the current configuration (dock or undock).</span></span> <span data-ttu-id="f8a4d-123">Toute application peut renvoyer la \_ requête \_ de diffusion Deny pour refuser la demande et annuler la modification.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-123">Any application can return BROADCAST\_QUERY\_DENY to deny the request and cancel the change.</span></span> <span data-ttu-id="f8a4d-124">Si une application refuse la demande, le système envoie un message [DBT \_ CONFIGCHANGECANCELED](dbt-configchangecanceled.md) .</span><span class="sxs-lookup"><span data-stu-id="f8a4d-124">If an application denies the request, the system sends a [DBT\_CONFIGCHANGECANCELED](dbt-configchangecanceled.md) message.</span></span> <span data-ttu-id="f8a4d-125">Si la configuration actuelle a changé, en raison d’une station d’accueil ou d’une déconnexion, le système envoie un message [DBT \_ CONFIGCHANGED](dbt-configchanged.md) .</span><span class="sxs-lookup"><span data-stu-id="f8a4d-125">If the current configuration has changed, due to a dock or undock, the system sends a [DBT\_CONFIGCHANGED](dbt-configchanged.md) message.</span></span>

<span data-ttu-id="f8a4d-126">Le système diffuse un événement de périphérique [DBT \_ DEVICETYPESPECIFIC](dbt-devicetypespecific.md) chaque fois qu’un événement spécifique à l’appareil se produit.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-126">The system broadcasts a [DBT\_DEVICETYPESPECIFIC](dbt-devicetypespecific.md) device event whenever a device-specific event occurs.</span></span>

<span data-ttu-id="f8a4d-127">Les pilotes peuvent créer leurs propres types d’événements personnalisés.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-127">Drivers can create their own custom event types.</span></span> <span data-ttu-id="f8a4d-128">Les événements personnalisés sont envoyés uniquement à l’application qui a été inscrite pour la notification d’événement d’appareil sur un appareil particulier et qui peuvent uniquement être initiés par des pilotes en mode noyau.</span><span class="sxs-lookup"><span data-stu-id="f8a4d-128">Custom events are sent only to application that have registered for device-event notification on a particular device, and can only be initiated by kernel-mode drivers.</span></span> <span data-ttu-id="f8a4d-129">Pour plus d’informations, consultez [DBT \_ CUSTOMEVENT](dbt-customevent.md).</span><span class="sxs-lookup"><span data-stu-id="f8a4d-129">For more information, see [DBT\_CUSTOMEVENT](dbt-customevent.md).</span></span>

 

 



