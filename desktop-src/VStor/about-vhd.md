---
description: Le format de disque dur virtuel (VHD) est une spécification de format d’image disponible publiquement qui permet l’encapsulation du disque dur dans un fichier individuel utilisable par le système d’exploitation en tant que disque virtuel dans les mêmes modes d’utilisation des disques durs physiques.
MS-HAID: vhd.about\_vhd
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
title: À propos du disque dur virtuel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 29ea37851360e70c1108e0715a47c77163c2c2fa
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103751524"
---
# <a name="span-idvhdabout_vhdspanabout-vhd"></a><span data-ttu-id="3fc32-103"><span id="vhd.about_vhd"></span>À propos du disque dur virtuel</span><span class="sxs-lookup"><span data-stu-id="3fc32-103"><span id="vhd.about_vhd"></span>About VHD</span></span>

<span data-ttu-id="3fc32-104">Le format de disque dur virtuel (VHD) est une [spécification](https://download.microsoft.com/download/f/f/e/ffef50a5-07dd-4cf8-aaa3-442c0673a029/Virtual%20Hard%20Disk%20Format%20Spec_10_18_06.doc) de format d’image disponible publiquement qui permet l’encapsulation du disque dur dans un fichier individuel utilisable par le système d’exploitation en tant que *disque virtuel* dans les mêmes modes d’utilisation des disques durs physiques.</span><span class="sxs-lookup"><span data-stu-id="3fc32-104">The Virtual Hard Disk (VHD) format is a publicly-available image format [specification](https://download.microsoft.com/download/f/f/e/ffef50a5-07dd-4cf8-aaa3-442c0673a029/Virtual%20Hard%20Disk%20Format%20Spec_10_18_06.doc) that allows encapsulation of the hard disk into an individual file for use by the operating system as a *virtual disk* in all the same ways physical hard disks are used.</span></span> <span data-ttu-id="3fc32-105">Ces disques virtuels peuvent héberger des systèmes de fichiers natifs (NTFS, FAT, exFAT et UDF) tout en prenant en charge les opérations de disque et de fichier standard.</span><span class="sxs-lookup"><span data-stu-id="3fc32-105">These virtual disks are capable of hosting native file systems (NTFS, FAT, exFAT, and UDFS) while supporting standard disk and file operations.</span></span> <span data-ttu-id="3fc32-106">La prise en charge des API VHD permet de gérer les disques virtuels.</span><span class="sxs-lookup"><span data-stu-id="3fc32-106">VHD API support allows management of the virtual disks.</span></span> <span data-ttu-id="3fc32-107">Les disques virtuels créés avec l’API VHD peuvent fonctionner en tant que disques de démarrage.</span><span class="sxs-lookup"><span data-stu-id="3fc32-107">Virtual disks created with the VHD API can function as boot disks.</span></span>

<span data-ttu-id="3fc32-108">L’utilisation des fichiers VHD est un exemple de la fonctionnalité [Hyper-V](https://www.microsoft.com/windowsserver2008/en/us/hyperv.aspx) dans Windows 7, windows Server 2008, Virtual Server et Windows Virtual PC.</span><span class="sxs-lookup"><span data-stu-id="3fc32-108">An example of how VHD files are used is the [Hyper-V](https://www.microsoft.com/windowsserver2008/en/us/hyperv.aspx) feature in Windows 7, Windows Server 2008, Virtual Server, and Windows Virtual PC.</span></span> <span data-ttu-id="3fc32-109">Ces produits utilisent l’API VHD pour contenir l’image du système d’exploitation Windows utilisée par une machine virtuelle comme disque de démarrage système.</span><span class="sxs-lookup"><span data-stu-id="3fc32-109">These products use the VHD API to contain the Windows operating system image utilized by a virtual machine as its system boot disk.</span></span>

<span data-ttu-id="3fc32-110">Le kit de développement logiciel (SDK) Microsoft Windows intègre la prise en charge du disque dur virtuel natif pour l’utilisation des disques virtuels, ce qui permet aux développeurs et aux administrateurs de créer, gérer et déployer plus facilement des images Windows dans des fichiers VHD à l’aide des outils de gestion ou de prise en charge des API de plateforme.</span><span class="sxs-lookup"><span data-stu-id="3fc32-110">The Microsoft Windows Software Development Kit (SDK) integrates Native VHD support for working with virtual disks, making it easier for developers and administrators to create, manage, and deploy Windows images in VHD files using either the platform API support or management tools.</span></span> <span data-ttu-id="3fc32-111">Il n’est pas nécessaire d’installer des applications distinctes ou d’implémenter un analyseur de format VHD pour activer ces opérations.</span><span class="sxs-lookup"><span data-stu-id="3fc32-111">It is not necessary to install separate applications or implement a VHD format parser to enable these operations.</span></span> <span data-ttu-id="3fc32-112">Ces API permettent l’utilisation générique de disques virtuels indépendamment des autres technologies de virtualisation.</span><span class="sxs-lookup"><span data-stu-id="3fc32-112">These APIs allow for generic use of virtual disks independent of any other virtualization technologies.</span></span>

## <a name="span-idterminologyspanspan-idterminologyspanspan-idterminologyspanterminology"></a><span data-ttu-id="3fc32-113"><span id="Terminology"></span><span id="terminology"></span><span id="TERMINOLOGY"></span>Correspondance</span><span class="sxs-lookup"><span data-stu-id="3fc32-113"><span id="Terminology"></span><span id="terminology"></span><span id="TERMINOLOGY"></span>Terminology</span></span>

<span data-ttu-id="3fc32-114">Le *magasin* de stockage de terme est utilisé pour faire référence au fichier physique qui existe sur le disque dur réel.</span><span class="sxs-lookup"><span data-stu-id="3fc32-114">The term *backing store* is used to refer to the physical file that exists on the actual hard disk.</span></span> <span data-ttu-id="3fc32-115">Le magasin de stockage est représenté par un *fichier image de disque dur virtuel*.</span><span class="sxs-lookup"><span data-stu-id="3fc32-115">The backing store is represented by a *VHD image file*.</span></span>

<span data-ttu-id="3fc32-116">Les termes *dynamique*, *extensible* et *épars* sont souvent utilisés indifféremment lorsque vous faites référence à des disques virtuels extensibles de façon dynamique.</span><span class="sxs-lookup"><span data-stu-id="3fc32-116">The terms *dynamic*, *expandable*, and *sparse* are often used interchangeably when referring to dynamically expandable virtual disks.</span></span> <span data-ttu-id="3fc32-117">Pour la technologie de disque dur virtuel, ces termes sont identiques.</span><span class="sxs-lookup"><span data-stu-id="3fc32-117">For VHD technology, these terms are identical.</span></span>

## <a name="span-idvhd_system_features_overviewspanspan-idvhd_system_features_overviewspanspan-idvhd_system_features_overviewspanvhd-system-features-overview"></a><span data-ttu-id="3fc32-118"><span id="VHD_System_Features_Overview"></span><span id="vhd_system_features_overview"></span><span id="VHD_SYSTEM_FEATURES_OVERVIEW"></span>Vue d’ensemble des fonctionnalités du système VHD</span><span class="sxs-lookup"><span data-stu-id="3fc32-118"><span id="VHD_System_Features_Overview"></span><span id="vhd_system_features_overview"></span><span id="VHD_SYSTEM_FEATURES_OVERVIEW"></span>VHD System Features Overview</span></span>

<span data-ttu-id="3fc32-119">Le diagramme suivant présente une vue d’ensemble des fonctionnalités de disque dur virtuel et de leurs relations.</span><span class="sxs-lookup"><span data-stu-id="3fc32-119">The following diagram presents an overview of the VHD features and their relationships.</span></span>

![diagramme de blocs VHD](images/vhd.png)

<span data-ttu-id="3fc32-121">Vous trouverez ci-dessous une explication récapitulative des fonctionnalités décrites précédemment.</span><span class="sxs-lookup"><span data-stu-id="3fc32-121">The following is a summary explanation of the previously described features.</span></span>

<span data-ttu-id="3fc32-122">API Windows natives en mode utilisateur :</span><span class="sxs-lookup"><span data-stu-id="3fc32-122">User Mode Native Windows APIs:</span></span>

-   <span data-ttu-id="3fc32-123">VirtDisk.dll-bibliothèque commune pour les API de gestion du disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="3fc32-123">VirtDisk.dll - Common library for VHD management APIs.</span></span>

<span data-ttu-id="3fc32-124">Wrappers de gestion spécifiques au domaine en mode utilisateur :</span><span class="sxs-lookup"><span data-stu-id="3fc32-124">User Mode Domain-specific Management Wrappers:</span></span>

-   <span data-ttu-id="3fc32-125">[API VHD VDS](/windows/desktop/VDS/about-vds) -wrappers de modèle objet VDS pour les API Windows VHD.</span><span class="sxs-lookup"><span data-stu-id="3fc32-125">[VDS VHD APIs](/windows/desktop/VDS/about-vds) - VDS Object Model wrappers for the VHD Windows APIs.</span></span>

<span data-ttu-id="3fc32-126">Pilotes en mode noyau :</span><span class="sxs-lookup"><span data-stu-id="3fc32-126">Kernel Mode Drivers:</span></span>

-   <span data-ttu-id="3fc32-127">VDrvRoot.sys-énumérateur de lecteur virtuel racine.</span><span class="sxs-lookup"><span data-stu-id="3fc32-127">VDrvRoot.sys - Root virtual drive enumerator.</span></span>
-   <span data-ttu-id="3fc32-128">FsDepends.sys-gestion des dépendances de volume imbriquée.</span><span class="sxs-lookup"><span data-stu-id="3fc32-128">FsDepends.sys - Nested volume dependency management.</span></span>
-   <span data-ttu-id="3fc32-129">Vhdmp.sys-l’analyseur VHD et le fournisseur de propriétés de dépendance.</span><span class="sxs-lookup"><span data-stu-id="3fc32-129">Vhdmp.sys - VHD parser and dependency property provider.</span></span>

<span data-ttu-id="3fc32-130">La documentation du kit de développement logiciel (SDK) de cette section traite des API de disque dur virtuel Windows natives en mode utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3fc32-130">The SDK documentation in this section covers the user-mode native Windows VHD APIs.</span></span>

## <a name="span-idvirtual_disk_typesspanspan-idvirtual_disk_typesspanspan-idvirtual_disk_typesspanvirtual-disk-types"></a><span data-ttu-id="3fc32-131"><span id="Virtual_Disk_Types"></span><span id="virtual_disk_types"></span><span id="VIRTUAL_DISK_TYPES"></span>Types de disques virtuels</span><span class="sxs-lookup"><span data-stu-id="3fc32-131"><span id="Virtual_Disk_Types"></span><span id="virtual_disk_types"></span><span id="VIRTUAL_DISK_TYPES"></span>Virtual Disk Types</span></span>

<span data-ttu-id="3fc32-132">Il existe des considérations relatives à l’utilisation des disques virtuels, ainsi que les types de disques virtuels disponibles :</span><span class="sxs-lookup"><span data-stu-id="3fc32-132">There are considerations for using virtual disks, and what types of virtual disks are available:</span></span>

-   <span data-ttu-id="3fc32-133">**Résolu**: le fichier image de disque dur virtuel est pré-alloué sur le magasin de stockage pour la taille maximale demandée.</span><span class="sxs-lookup"><span data-stu-id="3fc32-133">**Fixed**—The VHD image file is pre-allocated on the backing store for the maximum size requested.</span></span>
-   <span data-ttu-id="3fc32-134">**Extensible**, également connu sous le nom de « dynamique », « extensible dynamiquement » et « fragmenté », le fichier image de disque dur virtuel utilise uniquement l’espace disponible sur le magasin de stockage, si nécessaire, pour stocker les données réelles que le disque virtuel contient actuellement.</span><span class="sxs-lookup"><span data-stu-id="3fc32-134">**Expandable**—Also known as "dynamic", "dynamically expandable", and "sparse", the VHD image file uses only as much space on the backing store as needed to store the actual data the virtual disk currently contains.</span></span> <span data-ttu-id="3fc32-135">Lors de la création de ce type de disque virtuel, l’API VHD ne teste pas l’espace libre sur le disque physique en fonction de la taille maximale demandée. par conséquent, il est possible de créer un disque virtuel dynamique avec une taille maximale supérieure à l’espace libre disponible sur le disque physique.</span><span class="sxs-lookup"><span data-stu-id="3fc32-135">When creating this type of virtual disk, the VHD API does not test for free space on the physical disk based on the maximum size requested, therefore it is possible to successfully create a dynamic virtual disk with a maximum size larger than the available physical disk free space.</span></span> <span data-ttu-id="3fc32-136">Pour plus d’informations, consultez [**ExpandVirtualDisk**](/windows/win32/api/virtdisk/nf-virtdisk-expandvirtualdisk).</span><span class="sxs-lookup"><span data-stu-id="3fc32-136">For more information, see [**ExpandVirtualDisk**](/windows/win32/api/virtdisk/nf-virtdisk-expandvirtualdisk).</span></span>
    <span data-ttu-id="3fc32-137">**Remarque**  La taille maximale d’un disque virtuel dynamique est de 2 040 Go.</span><span class="sxs-lookup"><span data-stu-id="3fc32-137">**Note**  The maximum size of a dynamic virtual disk is 2,040 GB.</span></span>

     

-   <span data-ttu-id="3fc32-138">**Différenciation**: un disque virtuel parent est utilisé comme base de ce type, avec toutes les écritures suivantes écrites sur le disque virtuel en tant que différences par le nouveau fichier image de disque dur virtuel de différenciation, et le fichier image de disque dur virtuel parent n’est pas modifié.</span><span class="sxs-lookup"><span data-stu-id="3fc32-138">**Differencing**—A parent virtual disk is used as the basis of this type, with any subsequent writes written to the virtual disk as differences to the new differencing VHD image file, and the parent VHD image file is not modified.</span></span> <span data-ttu-id="3fc32-139">Par exemple, si vous disposez d’un disque virtuel de système d’exploitation de démarrage système propre au système d’exploitation en tant que parent et que vous désignez le disque virtuel de différenciation comme disque virtuel actuel à utiliser par le système, le système d’exploitation sur le disque virtuel parent reste dans son état d’origine pour une récupération rapide ou pour créer rapidement davantage d’images de démarrage basées sur des disques virtuels</span><span class="sxs-lookup"><span data-stu-id="3fc32-139">For example, if you have a clean-install system boot operating system virtual disk as a parent and designate the differencing virtual disk as the current virtual disk for the system to use, then the operating system on the parent virtual disk stays in its original state for quick recovery or for quickly creating more boot images based on additional differencing virtual disks.</span></span> <span data-ttu-id="3fc32-140">Pour plus d’informations, consultez [**MergeVirtualDisk**](/windows/win32/api/virtdisk/nf-virtdisk-mergevirtualdisk).</span><span class="sxs-lookup"><span data-stu-id="3fc32-140">For more information, see [**MergeVirtualDisk**](/windows/win32/api/virtdisk/nf-virtdisk-mergevirtualdisk).</span></span>
    <span data-ttu-id="3fc32-141">**Remarque**  La taille maximale d’un disque virtuel de différenciation est de 2 040 Go.</span><span class="sxs-lookup"><span data-stu-id="3fc32-141">**Note**  The maximum size of a differencing virtual disk is 2,040 GB.</span></span>

     

<span data-ttu-id="3fc32-142">Tous les types de disques virtuels ont une taille minimale de 3 Mo.</span><span class="sxs-lookup"><span data-stu-id="3fc32-142">All virtual disk types have a minimum size of 3 MB.</span></span>

## <a name="span-idrelated_topicsspanrelated-topics"></a><span data-ttu-id="3fc32-143"><span id="related_topics"></span>Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="3fc32-143"><span id="related_topics"></span>Related topics</span></span>

[<span data-ttu-id="3fc32-144">À propos de VDS</span><span class="sxs-lookup"><span data-stu-id="3fc32-144">About VDS</span></span>](/windows/desktop/VDS/about-vds)

[<span data-ttu-id="3fc32-145">Référence VHD</span><span class="sxs-lookup"><span data-stu-id="3fc32-145">VHD Reference</span></span>](vhd-reference.md)

[<span data-ttu-id="3fc32-146">Spécification de format d’image de disque dur virtuel</span><span class="sxs-lookup"><span data-stu-id="3fc32-146">Virtual Hard Disk Image Format Specification</span></span>](https://download.microsoft.com/download/f/f/e/ffef50a5-07dd-4cf8-aaa3-442c0673a029/Virtual%20Hard%20Disk%20Format%20Spec_10_18_06.doc)

 

 
