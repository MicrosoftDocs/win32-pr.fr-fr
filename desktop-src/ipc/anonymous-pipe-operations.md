---
description: Opérations de canal anonyme, y compris la création de canal, l’écriture dans un canal, les handles de canal.
ms.assetid: df81471c-1072-4456-a877-304e76ade4bd
title: Opérations de canal anonyme
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 963d7127c51859b05e570d00291470a49be5ba66
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106520515"
---
# <a name="anonymous-pipe-operations"></a><span data-ttu-id="8c73b-103">Opérations de canal anonyme</span><span class="sxs-lookup"><span data-stu-id="8c73b-103">Anonymous Pipe Operations</span></span>

<span data-ttu-id="8c73b-104">La fonction [**CreatePipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe) crée un canal anonyme et retourne deux Handles : un handle de lecture vers le canal et un handle d’écriture sur le canal.</span><span class="sxs-lookup"><span data-stu-id="8c73b-104">The [**CreatePipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe) function creates an anonymous pipe and returns two handles: a read handle to the pipe and a write handle to the pipe.</span></span> <span data-ttu-id="8c73b-105">Le handle de lecture a un accès en lecture seule au canal et le handle d’écriture dispose d’un accès en écriture seule au canal.</span><span class="sxs-lookup"><span data-stu-id="8c73b-105">The read handle has read-only access to the pipe, and the write handle has write-only access to the pipe.</span></span> <span data-ttu-id="8c73b-106">Pour communiquer à l’aide du canal, le serveur de canaux doit passer un handle de canal à un autre processus.</span><span class="sxs-lookup"><span data-stu-id="8c73b-106">To communicate using the pipe, the pipe server must pass a pipe handle to another process.</span></span> <span data-ttu-id="8c73b-107">En général, cette opération est effectuée par héritage ; autrement dit, le processus permet à un handle d’être hérité par un processus enfant.</span><span class="sxs-lookup"><span data-stu-id="8c73b-107">Usually, this is done through inheritance; that is, the process allows the handle to be inherited by a child process.</span></span> <span data-ttu-id="8c73b-108">Le processus peut également dupliquer un handle de canal à l’aide de la fonction [**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) et l’envoyer à un processus non lié à l’aide d’une forme de communication interprocessus, telle que DDE ou la mémoire partagée.</span><span class="sxs-lookup"><span data-stu-id="8c73b-108">The process can also duplicate a pipe handle using the [**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) function and send it to an unrelated process using some form of interprocess communication, such as DDE or shared memory.</span></span>

<span data-ttu-id="8c73b-109">Un serveur de canaux peut envoyer le descripteur de lecture ou le descripteur d’écriture au client du canal, selon que le client doit ou non utiliser le canal anonyme pour envoyer des informations ou recevoir des informations.</span><span class="sxs-lookup"><span data-stu-id="8c73b-109">A pipe server can send either the read handle or the write handle to the pipe client, depending on whether the client should use the anonymous pipe to send information or receive information.</span></span> <span data-ttu-id="8c73b-110">Pour lire à partir du canal, utilisez la poignée de lecture du canal dans un appel à la fonction [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) .</span><span class="sxs-lookup"><span data-stu-id="8c73b-110">To read from the pipe, use the pipe's read handle in a call to the [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) function.</span></span> <span data-ttu-id="8c73b-111">L’appel à **ReadFile** retourne lorsqu’un autre processus a écrit sur le canal.</span><span class="sxs-lookup"><span data-stu-id="8c73b-111">The **ReadFile** call returns when another process has written to the pipe.</span></span> <span data-ttu-id="8c73b-112">L’appel **ReadFile** peut également retourner si tous les descripteurs d’écriture du canal ont été fermés ou si une erreur se produit avant la fin de l’opération de lecture.</span><span class="sxs-lookup"><span data-stu-id="8c73b-112">The **ReadFile** call can also return if all write handles to the pipe have been closed or if an error occurs before the read operation has been completed.</span></span>

<span data-ttu-id="8c73b-113">Pour écrire dans le canal, utilisez le handle d’écriture du canal dans un appel à la fonction [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) .</span><span class="sxs-lookup"><span data-stu-id="8c73b-113">To write to the pipe, use the pipe's write handle in a call to the [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) function.</span></span> <span data-ttu-id="8c73b-114">L’appel **WriteFile** ne retourne pas jusqu’à ce qu’il ait écrit le nombre d’octets spécifié dans le canal ou qu’une erreur se produise.</span><span class="sxs-lookup"><span data-stu-id="8c73b-114">The **WriteFile** call does not return until it has written the specified number of bytes to the pipe or an error occurs.</span></span> <span data-ttu-id="8c73b-115">Si la mémoire tampon du canal est pleine et qu’il y a plus d’octets à écrire, **WriteFile** ne retourne pas jusqu’à ce qu’un autre processus Lise à partir du canal, ce qui rend plus l’espace de mémoire tampon disponible.</span><span class="sxs-lookup"><span data-stu-id="8c73b-115">If the pipe buffer is full and there are more bytes to be written, **WriteFile** does not return until another process reads from the pipe, making more buffer space available.</span></span> <span data-ttu-id="8c73b-116">Le serveur de canaux spécifie la taille de la mémoire tampon pour le canal lorsqu’il appelle [**CreatePipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe).</span><span class="sxs-lookup"><span data-stu-id="8c73b-116">The pipe server specifies the buffer size for the pipe when it calls [**CreatePipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe).</span></span>

<span data-ttu-id="8c73b-117">Les opérations de lecture et d’écriture asynchrones (avec chevauchement) ne sont pas prises en charge par les canaux anonymes.</span><span class="sxs-lookup"><span data-stu-id="8c73b-117">Asynchronous (overlapped) read and write operations are not supported by anonymous pipes.</span></span> <span data-ttu-id="8c73b-118">Cela signifie que vous ne pouvez pas utiliser les fonctions [**ReadFileEx**](/windows/desktop/api/fileapi/nf-fileapi-readfileex) et [**WriteFileEx**](/windows/desktop/api/fileapi/nf-fileapi-writefileex) avec des canaux anonymes.</span><span class="sxs-lookup"><span data-stu-id="8c73b-118">This means that you cannot use the [**ReadFileEx**](/windows/desktop/api/fileapi/nf-fileapi-readfileex) and [**WriteFileEx**](/windows/desktop/api/fileapi/nf-fileapi-writefileex) functions with anonymous pipes.</span></span> <span data-ttu-id="8c73b-119">En outre, le paramètre *lpOverlapped* de [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) et [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) est ignoré lorsque ces fonctions sont utilisées avec des canaux anonymes.</span><span class="sxs-lookup"><span data-stu-id="8c73b-119">In addition, the *lpOverlapped* parameter of [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) is ignored when these functions are used with anonymous pipes.</span></span>

<span data-ttu-id="8c73b-120">Un canal anonyme existe jusqu’à ce que tous les descripteurs de canal, en lecture et en écriture, aient été fermés.</span><span class="sxs-lookup"><span data-stu-id="8c73b-120">An anonymous pipe exists until all pipe handles, both read and write, have been closed.</span></span> <span data-ttu-id="8c73b-121">Un processus peut fermer ses descripteurs de canal à l’aide de la fonction [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="8c73b-121">A process can close its pipe handles by using the [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) function.</span></span> <span data-ttu-id="8c73b-122">Tous les descripteurs de canal sont également fermés lorsque le processus se termine.</span><span class="sxs-lookup"><span data-stu-id="8c73b-122">All pipe handles are also closed when the process terminates.</span></span>

<span data-ttu-id="8c73b-123">Les canaux anonymes sont implémentés à l’aide d’un canal nommé portant un nom unique.</span><span class="sxs-lookup"><span data-stu-id="8c73b-123">Anonymous pipes are implemented using a named pipe with a unique name.</span></span> <span data-ttu-id="8c73b-124">Par conséquent, vous pouvez souvent transmettre un handle à un canal anonyme vers une fonction qui requiert un handle vers un canal nommé.</span><span class="sxs-lookup"><span data-stu-id="8c73b-124">Therefore, you can often pass a handle to an anonymous pipe to a function that requires a handle to a named pipe.</span></span>

 

 
