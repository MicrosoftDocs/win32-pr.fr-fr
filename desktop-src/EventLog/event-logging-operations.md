---
description: Les fonctions OpenEventLog, OpenBackupEventLog, RegisterEventSource, DeregisterEventSource et CloseEventLog ouvrent et ferment les handles du journal des événements.
ms.assetid: e42a66c2-2f1e-46f8-99c7-4701075c8ec3
title: Opérations de journalisation des événements
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 065acd268788de8c9674baa1fe47a3b89a719d4c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106519651"
---
# <a name="event-logging-operations"></a><span data-ttu-id="071ab-103">Opérations de journalisation des événements</span><span class="sxs-lookup"><span data-stu-id="071ab-103">Event Logging Operations</span></span>

<span data-ttu-id="071ab-104">Les fonctions [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga), [**OpenBackupEventLog**](/windows/desktop/api/Winbase/nf-winbase-openbackupeventloga), [**RegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea), [**DeregisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-deregistereventsource)et [**CloseEventLog**](/windows/desktop/api/Winbase/nf-winbase-closeeventlog) ouvrent et ferment les handles du journal des événements.</span><span class="sxs-lookup"><span data-stu-id="071ab-104">The [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga), [**OpenBackupEventLog**](/windows/desktop/api/Winbase/nf-winbase-openbackupeventloga), [**RegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea), [**DeregisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-deregistereventsource), and [**CloseEventLog**](/windows/desktop/api/Winbase/nf-winbase-closeeventlog) functions open and close event log handles.</span></span>

<span data-ttu-id="071ab-105">Le tableau suivant présente les opérations qui peuvent être effectuées sur un journal des événements ouvert et la fonction correspondante pour chaque opération.</span><span class="sxs-lookup"><span data-stu-id="071ab-105">The following table shows the operations that can be performed on an open event log, and the corresponding function for each operation.</span></span>



| <span data-ttu-id="071ab-106">Opération</span><span class="sxs-lookup"><span data-stu-id="071ab-106">Operation</span></span> | <span data-ttu-id="071ab-107">Fonction</span><span class="sxs-lookup"><span data-stu-id="071ab-107">Function</span></span>                                                                                                                     |
|-----------|------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="071ab-108">Sauvegarde</span><span class="sxs-lookup"><span data-stu-id="071ab-108">Backup</span></span>    | [<span data-ttu-id="071ab-109">**BackupEventLog**</span><span class="sxs-lookup"><span data-stu-id="071ab-109">**BackupEventLog**</span></span>](/windows/desktop/api/Winbase/nf-winbase-backupeventloga)                                                                                     |
| <span data-ttu-id="071ab-110">Effacer</span><span class="sxs-lookup"><span data-stu-id="071ab-110">Clear</span></span>     | [<span data-ttu-id="071ab-111">**ClearEventLog**</span><span class="sxs-lookup"><span data-stu-id="071ab-111">**ClearEventLog**</span></span>](/windows/desktop/api/Winbase/nf-winbase-cleareventloga)                                                                                       |
| <span data-ttu-id="071ab-112">Superviser</span><span class="sxs-lookup"><span data-stu-id="071ab-112">Monitor</span></span>   | [<span data-ttu-id="071ab-113">**NotifyChangeEventLog**</span><span class="sxs-lookup"><span data-stu-id="071ab-113">**NotifyChangeEventLog**</span></span>](/windows/desktop/api/Winbase/nf-winbase-notifychangeeventlog)                                                                         |
| <span data-ttu-id="071ab-114">Requête</span><span class="sxs-lookup"><span data-stu-id="071ab-114">Query</span></span>     | <span data-ttu-id="071ab-115">[**GetOldestEventLogRecord**](/windows/desktop/api/Winbase/nf-winbase-getoldesteventlogrecord), [ **GetNumberOfEventLogRecords**](/windows/desktop/api/Winbase/nf-winbase-getnumberofeventlogrecords)</span><span class="sxs-lookup"><span data-stu-id="071ab-115">[**GetOldestEventLogRecord**](/windows/desktop/api/Winbase/nf-winbase-getoldesteventlogrecord), [**GetNumberOfEventLogRecords**](/windows/desktop/api/Winbase/nf-winbase-getnumberofeventlogrecords)</span></span> |
| <span data-ttu-id="071ab-116">Lire</span><span class="sxs-lookup"><span data-stu-id="071ab-116">Read</span></span>      | [<span data-ttu-id="071ab-117">**ReadEventLog**</span><span class="sxs-lookup"><span data-stu-id="071ab-117">**ReadEventLog**</span></span>](/windows/desktop/api/Winbase/nf-winbase-readeventloga)                                                                                         |
| <span data-ttu-id="071ab-118">Write</span><span class="sxs-lookup"><span data-stu-id="071ab-118">Write</span></span>     | [<span data-ttu-id="071ab-119">**ReportEvent**</span><span class="sxs-lookup"><span data-stu-id="071ab-119">**ReportEvent**</span></span>](/windows/desktop/api/Winbase/nf-winbase-reporteventa)                                                                                           |



 

<span data-ttu-id="071ab-120">Les fonctions [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) et [**ReportEvent**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) prennent un nom de serveur facultatif en tant que paramètre, de sorte que les opérations peuvent être effectuées sur le serveur distant.</span><span class="sxs-lookup"><span data-stu-id="071ab-120">The [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) and [**ReportEvent**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) functions take an optional server name as a parameter so the operations can be performed on the remote server.</span></span> <span data-ttu-id="071ab-121">Utilisez [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) pour la lecture ou l’exécution d’opérations d’administration (sauvegarde, effacement, surveillance et interrogation) dans le journal, et utilisez [**RegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea) pour l’écriture dans le journal.</span><span class="sxs-lookup"><span data-stu-id="071ab-121">Use [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) for reading or performing administrative operations (backup, clear, monitor, and query) on the log, and use [**RegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea) for writing to the log.</span></span>

<span data-ttu-id="071ab-122">Chaque appel à une fonction d’enregistrement des événements est une opération atomique.</span><span class="sxs-lookup"><span data-stu-id="071ab-122">Each call to an event logging function is an atomic operation.</span></span> <span data-ttu-id="071ab-123">Lorsque vous lisez à partir du journal des événements, seuls les enregistrements d’événements entiers sont retournés.</span><span class="sxs-lookup"><span data-stu-id="071ab-123">When you read from the event log, only whole event records are returned.</span></span> <span data-ttu-id="071ab-124">Lorsque vous écrivez dans le journal des événements, chaque enregistrement d’événement est systématiquement écrit comme un enregistrement complet dans le journal.</span><span class="sxs-lookup"><span data-stu-id="071ab-124">When you write to the event log, each event record is guaranteed to be written sequentially as a complete record in the log.</span></span> <span data-ttu-id="071ab-125">La liste suivante décrit comment le service de journalisation des événements gère les conditions spéciales :</span><span class="sxs-lookup"><span data-stu-id="071ab-125">The following list describes how the event-logging service handles special conditions:</span></span>

-   <span data-ttu-id="071ab-126">Le service de journalisation des événements reçoit une opération de lecture et une opération d’écriture en même temps : si la position de lecture se trouve à la fin du fichier, l’opération de lecture échoue avec l’état de fin de fichier (si l’opération d’écriture n’est pas terminée) ou retourne le nouvel enregistrement (si l’opération d’écriture est terminée).</span><span class="sxs-lookup"><span data-stu-id="071ab-126">The event-logging service receives a read operation and a write operation at the same time: If the read position is at the end of the file, either the read operation fails with an "end-of-file" status (if the write operation has not been completed), or it returns the new record (if the write operation has been completed).</span></span>
-   <span data-ttu-id="071ab-127">Le service de journalisation des événements effectue une opération d’effacement avant de recevoir une opération de lecture : l’opération de lecture échoue avec l’État « fin de fichier ».</span><span class="sxs-lookup"><span data-stu-id="071ab-127">The event-logging service completes a clear operation before receiving a read operation: The read operation fails with "end-of-file" status.</span></span>
-   <span data-ttu-id="071ab-128">Le service de journalisation des événements effectue une opération d’effacement avant de recevoir une opération d’écriture : l’opération Clear tronque le journal, puis l’opération d’écriture ajoute le nouvel enregistrement au début du journal.</span><span class="sxs-lookup"><span data-stu-id="071ab-128">The event-logging service completes a clear operation before receiving a write operation: The clear operation truncates the log, then the write operation adds the new record at the beginning of the log.</span></span>

 

 



