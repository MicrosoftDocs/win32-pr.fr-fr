---
description: Le système gère une palette système pour chaque périphérique qui utilise des palettes.
ms.assetid: 4c93ce8c-6b3a-4016-bb47-786c25b93374
title: Palette système
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d8738cf63eef0b77f2d184f2cf95b6550b81053
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991512"
---
# <a name="system-palette"></a><span data-ttu-id="b2e16-103">Palette système</span><span class="sxs-lookup"><span data-stu-id="b2e16-103">System Palette</span></span>

<span data-ttu-id="b2e16-104">Le système gère une *palette système* pour chaque périphérique qui utilise des palettes.</span><span class="sxs-lookup"><span data-stu-id="b2e16-104">The system maintains a *system palette* for each device that uses palettes.</span></span> <span data-ttu-id="b2e16-105">La palette système contient les valeurs de couleur pour toutes les couleurs qui peuvent actuellement être affichées ou dessinées par l’appareil.</span><span class="sxs-lookup"><span data-stu-id="b2e16-105">The system palette contains the color values for all colors that can currently be displayed or drawn by the device.</span></span> <span data-ttu-id="b2e16-106">En dehors de l’affichage du contenu de la palette système, les applications ne peuvent pas accéder directement à la palette du système.</span><span class="sxs-lookup"><span data-stu-id="b2e16-106">Other than viewing the contents of the system palette, applications cannot access the system palette directly.</span></span> <span data-ttu-id="b2e16-107">Au lieu de cela, le système dispose d’un contrôle total sur la palette du système et n’autorise l’accès qu’à l’aide de palettes logiques.</span><span class="sxs-lookup"><span data-stu-id="b2e16-107">Instead, the system has complete control of the system palette and permits access only through the use of logical palettes.</span></span>

<span data-ttu-id="b2e16-108">Une application peut afficher le contenu de la palette système à l’aide de la fonction [**GetSystemPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteentries) .</span><span class="sxs-lookup"><span data-stu-id="b2e16-108">An application can view the contents of the system palette by using the [**GetSystemPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteentries) function.</span></span> <span data-ttu-id="b2e16-109">Cette fonction récupère le contenu d’une ou plusieurs entrées, jusqu’au nombre total d’entrées dans la palette système.</span><span class="sxs-lookup"><span data-stu-id="b2e16-109">This function retrieves the contents of one or more entries, up to the total number of entries in the system palette.</span></span> <span data-ttu-id="b2e16-110">Le total est toujours égal au nombre retourné pour la valeur SIZEPALETTE par la fonction [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) et est identique à la taille maximale d’une palette logique donnée.</span><span class="sxs-lookup"><span data-stu-id="b2e16-110">The total is always equal to the number returned for the SIZEPALETTE value by the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function and is the same as the maximum size for any given logical palette.</span></span>

<span data-ttu-id="b2e16-111">Bien que les applications ne puissent pas modifier directement les couleurs de la palette système, elles peuvent entraîner des modifications lors de la réalisation de palettes logiques.</span><span class="sxs-lookup"><span data-stu-id="b2e16-111">Although applications cannot change colors in the system palette directly, they may cause changes when realizing logical palettes.</span></span> <span data-ttu-id="b2e16-112">Pour réaliser une palette, le système examine chaque couleur demandée et tente de trouver une entrée dans la palette du système qui contient une correspondance exacte.</span><span class="sxs-lookup"><span data-stu-id="b2e16-112">To realize a palette, the system examines each requested color and attempts to find an entry in the system palette that contains an exact match.</span></span> <span data-ttu-id="b2e16-113">Si le système trouve une couleur correspondante, il mappe l’index de palette logique à l’index de palette système correspondant.</span><span class="sxs-lookup"><span data-stu-id="b2e16-113">If the system finds a matching color, it maps the logical palette index to the corresponding system palette index.</span></span> <span data-ttu-id="b2e16-114">Si le système ne trouve pas de correspondance exacte, il copie la couleur demandée dans une entrée de palette système inutilisée avant de mapper les index.</span><span class="sxs-lookup"><span data-stu-id="b2e16-114">If the system does not find an exact match, it copies the requested color to an unused system palette entry before mapping the indexes.</span></span> <span data-ttu-id="b2e16-115">Si toutes les entrées de palette système sont en cours d’utilisation, le système mappe l’index de palette logique à l’entrée de la palette système dont la couleur correspond le mieux à la couleur demandée.</span><span class="sxs-lookup"><span data-stu-id="b2e16-115">If all system palette entries are in use, the system maps the logical palette index to the system palette entry whose color most closely matches the requested color.</span></span> <span data-ttu-id="b2e16-116">Une fois ce mappage défini, les applications ne peuvent pas le remplacer.</span><span class="sxs-lookup"><span data-stu-id="b2e16-116">After this mapping is set, applications cannot override it.</span></span> <span data-ttu-id="b2e16-117">Par exemple, les applications ne peuvent pas utiliser d’index de palette système pour spécifier des couleurs ; Seuls les index de palette logique sont autorisés.</span><span class="sxs-lookup"><span data-stu-id="b2e16-117">For example, applications cannot use system palette indexes to specify colors; only logical palette indexes are permitted.</span></span>

<span data-ttu-id="b2e16-118">Les applications peuvent modifier la façon dont les index sont mappés en définissant le membre **peFlags** de la structure [**PaletteEntry**](/previous-versions//dd162769(v=vs.85)) sur les valeurs sélectionnées lors de la création de la palette logique.</span><span class="sxs-lookup"><span data-stu-id="b2e16-118">Applications can modify the way indexes are mapped by setting the **peFlags** member of the [**PALETTEENTRY**](/previous-versions//dd162769(v=vs.85)) structure to selected values when creating the logical palette.</span></span> <span data-ttu-id="b2e16-119">Par exemple, l' \_ indicateur NOcollaps du PC indique au système de copier immédiatement la couleur demandée dans une entrée de la palette système inutilisé, qu’une entrée de la palette système contienne déjà cette couleur ou non.</span><span class="sxs-lookup"><span data-stu-id="b2e16-119">For example, the PC\_NOCOLLAPSE flag directs the system to immediately copy the requested color to an unused system palette entry regardless of whether a system palette entry already contains that color.</span></span> <span data-ttu-id="b2e16-120">En outre, l' \_ indicateur PC Explicit indique au système de mapper l’index de palette logique à un index de palette système donné explicitement.</span><span class="sxs-lookup"><span data-stu-id="b2e16-120">Also, the PC\_EXPLICIT flag directs the system to map the logical palette index to an explicitly given system palette index.</span></span> <span data-ttu-id="b2e16-121">(L’application fournit l’index de palette système dans le mot de poids faible de la structure **PaletteEntry** .)</span><span class="sxs-lookup"><span data-stu-id="b2e16-121">(The application gives the system palette index in the low-order word of the **PALETTEENTRY** structure.)</span></span>

<span data-ttu-id="b2e16-122">Les palettes peuvent être réalisées sous la forme d’une palette d’arrière-plan ou d’une palette de premier plan en spécifiant respectivement la **valeur true** ou **false** pour le paramètre *bForceBackground* dans la fonction [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette) .</span><span class="sxs-lookup"><span data-stu-id="b2e16-122">Palettes can be realized as either a background palette or a foreground palette by specifying **TRUE** or **FALSE** respectively for the *bForceBackground* parameter in the [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette) function.</span></span> <span data-ttu-id="b2e16-123">Le système ne peut contenir qu’une seule palette de premier plan à la fois.</span><span class="sxs-lookup"><span data-stu-id="b2e16-123">There can be only one foreground palette in the system at a time.</span></span> <span data-ttu-id="b2e16-124">Si la fenêtre est la fenêtre actuellement active ou un descendant de la fenêtre actuellement active, elle peut réaliser une palette de premier plan.</span><span class="sxs-lookup"><span data-stu-id="b2e16-124">If the window is the currently active window or a descendent of the currently active window, it can realize a foreground palette.</span></span> <span data-ttu-id="b2e16-125">Dans le cas contraire, la palette est obtenue comme une palette d’arrière-plan, quelle que soit la valeur du paramètre *bForceBackground* .</span><span class="sxs-lookup"><span data-stu-id="b2e16-125">Otherwise the palette is realized as a background palette regardless of the value of the *bForceBackground* parameter.</span></span> <span data-ttu-id="b2e16-126">La propriété critique d’une palette de premier plan est que, si elle est réalisée, elle peut remplacer toutes les entrées (à l’exception des entrées statiques) dans la palette système.</span><span class="sxs-lookup"><span data-stu-id="b2e16-126">The critical property of a foreground palette is that, when realized, it can overwrite all entries (except for the static entries) in the system palette.</span></span> <span data-ttu-id="b2e16-127">Pour ce faire, le système marque toutes les entrées qui ne sont pas statiques dans la palette système comme inutilisées avant la réalisation d’une palette de premier plan, éliminant ainsi toutes les entrées utilisées.</span><span class="sxs-lookup"><span data-stu-id="b2e16-127">The system accomplishes this by marking all of the entries that are not static in the system palette as unused before the realization of a foreground palette, thereby eliminating all of the used entries.</span></span> <span data-ttu-id="b2e16-128">Aucun prétraitement ne se produit sur la palette système pour la réalisation d’une palette d’arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="b2e16-128">No preprocessing occurs on the system palette for a background palette realization.</span></span> <span data-ttu-id="b2e16-129">La palette de premier plan définit toutes les couleurs non statiques possibles.</span><span class="sxs-lookup"><span data-stu-id="b2e16-129">The foreground palette sets all of the possible nonstatic colors.</span></span> <span data-ttu-id="b2e16-130">Les palettes d’arrière-plan ne peuvent définir que ce qui reste ouvert et sont hiérarchisées selon un premier arrivé, premier servi.</span><span class="sxs-lookup"><span data-stu-id="b2e16-130">Background palettes can set only what remains open and are prioritized in a first-come, first-serve manner.</span></span> <span data-ttu-id="b2e16-131">En règle générale, les applications utilisent des palettes d’arrière-plan pour les fenêtres enfants qui réalisent leurs propres palettes.</span><span class="sxs-lookup"><span data-stu-id="b2e16-131">Typically, applications use background palettes for child windows which realize their own individual palettes.</span></span> <span data-ttu-id="b2e16-132">Cela permet de réduire le nombre de modifications apportées à la palette du système.</span><span class="sxs-lookup"><span data-stu-id="b2e16-132">This helps minimize the number of changes that occur to the system palette.</span></span>

<span data-ttu-id="b2e16-133">Une entrée de palette système non utilisée est une entrée qui n’est pas réservée et qui ne contient pas de couleur statique.</span><span class="sxs-lookup"><span data-stu-id="b2e16-133">An unused system palette entry is any entry that is not reserved and does not contain a static color.</span></span> <span data-ttu-id="b2e16-134">Les entrées réservées sont marquées explicitement avec la \_ valeur réservée du PC.</span><span class="sxs-lookup"><span data-stu-id="b2e16-134">Reserved entries are explicitly marked with the PC\_RESERVED value.</span></span> <span data-ttu-id="b2e16-135">Ces entrées sont créées lorsqu’une application réalise une palette logique pour l’animation de la palette.</span><span class="sxs-lookup"><span data-stu-id="b2e16-135">These entries are created when an application realizes a logical palette for palette animation.</span></span> <span data-ttu-id="b2e16-136">Les entrées de couleur statiques sont créées par le système et correspondent aux couleurs de la palette par défaut.</span><span class="sxs-lookup"><span data-stu-id="b2e16-136">Static color entries are created by the system and correspond to the colors in the default palette.</span></span> <span data-ttu-id="b2e16-137">La fonction [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) peut être utilisée pour récupérer la valeur NUMRESERVED, qui spécifie le nombre d’entrées de palettes système réservées aux couleurs statiques.</span><span class="sxs-lookup"><span data-stu-id="b2e16-137">The [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function can be used to retrieve the NUMRESERVED value, which specifies the number of system palette entries reserved for static colors.</span></span>

<span data-ttu-id="b2e16-138">Étant donné que la palette système comporte un nombre limité d’entrées, la sélection et la réalisation d’une palette logique pour un appareil donné peuvent affecter les couleurs associées à d’autres palettes logiques pour le même appareil.</span><span class="sxs-lookup"><span data-stu-id="b2e16-138">Because the system palette has a limited number of entries, selecting and realizing a logical palette for a given device may affect the colors associated with other logical palettes for the same device.</span></span> <span data-ttu-id="b2e16-139">Ces changements de couleur sont particulièrement spectaculaires lorsqu’ils se produisent à l’écran.</span><span class="sxs-lookup"><span data-stu-id="b2e16-139">These color changes are especially dramatic when they occur on the display.</span></span> <span data-ttu-id="b2e16-140">Une application peut s’assurer que des couleurs raisonnables sont utilisées pour la palette logique actuellement sélectionnée en réinitialisant la palette avant chaque utilisation.</span><span class="sxs-lookup"><span data-stu-id="b2e16-140">An application can make sure that reasonable colors are used for its currently selected logical palette by resetting the palette before each use.</span></span> <span data-ttu-id="b2e16-141">Une application réinitialise la palette en appelant les fonctions [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) et [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) .</span><span class="sxs-lookup"><span data-stu-id="b2e16-141">An application resets the palette by calling the [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) functions.</span></span> <span data-ttu-id="b2e16-142">L’utilisation de ces fonctions amène le système à remapper les couleurs de la palette logique à des couleurs raisonnables dans la palette du système.</span><span class="sxs-lookup"><span data-stu-id="b2e16-142">Using these functions causes the system to remap the colors in the logical palette to reasonable colors in the system palette.</span></span>

 

 
