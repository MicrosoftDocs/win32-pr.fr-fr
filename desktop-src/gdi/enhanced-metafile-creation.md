---
description: Vous créez un métafichier amélioré à l’aide de la fonction CreateEnhMetaFile, en fournissant les arguments appropriés.
ms.assetid: b012e50e-a7f5-4687-9833-38dacc113d77
title: Création de métafichiers améliorée
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 080c350e41e895c5d4bf834a6f407cca5907743d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103754413"
---
# <a name="enhanced-metafile-creation"></a><span data-ttu-id="bcda2-103">Création de métafichiers améliorée</span><span class="sxs-lookup"><span data-stu-id="bcda2-103">Enhanced Metafile Creation</span></span>

<span data-ttu-id="bcda2-104">Vous créez un métafichier amélioré à l’aide de la fonction [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) , en fournissant les arguments appropriés.</span><span class="sxs-lookup"><span data-stu-id="bcda2-104">You create an enhanced metafile by using the [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) function, supplying the appropriate arguments.</span></span> <span data-ttu-id="bcda2-105">Le système utilise ces arguments pour conserver les dimensions de l’image, déterminer si le métafichier doit être stocké sur un disque ou en mémoire, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="bcda2-105">The system uses these arguments to maintain picture dimensions, determine whether the metafile should be stored on a disk or in memory, and so on.</span></span>

<span data-ttu-id="bcda2-106">Pour conserver les dimensions d’image sur les périphériques de sortie, [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) requiert la résolution de l’appareil de référence.</span><span class="sxs-lookup"><span data-stu-id="bcda2-106">To maintain picture dimensions across output devices, [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) requires the resolution of the reference device.</span></span> <span data-ttu-id="bcda2-107">Ce *périphérique de référence* est l’appareil sur lequel l’image est apparue pour la première fois, et le *DC de référence* est le *contexte de périphérique* associé à l’appareil de référence.</span><span class="sxs-lookup"><span data-stu-id="bcda2-107">This *reference device* is the device on which the picture first appeared, and the *reference DC* is the *device context* associated with the reference device.</span></span> <span data-ttu-id="bcda2-108">Lors de l’appel de la fonction **CreateEnhMetaFile** , vous devez fournir un handle qui identifie ce contrôleur de périphérique.</span><span class="sxs-lookup"><span data-stu-id="bcda2-108">When calling the **CreateEnhMetaFile** function, you must supply a handle that identifies this DC.</span></span> <span data-ttu-id="bcda2-109">Vous pouvez récupérer ce handle en appelant la fonction [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) ou [**CreateDC**](/windows/desktop/api/Wingdi/nf-wingdi-createdca) .</span><span class="sxs-lookup"><span data-stu-id="bcda2-109">You can get this handle by calling the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) or [**CreateDC**](/windows/desktop/api/Wingdi/nf-wingdi-createdca) function.</span></span> <span data-ttu-id="bcda2-110">Vous pouvez également spécifier **null** comme handle pour utiliser le périphérique d’affichage actuel pour l’appareil de référence.</span><span class="sxs-lookup"><span data-stu-id="bcda2-110">You can also specify **NULL** as the handle to use the current display device for the reference device.</span></span>

<span data-ttu-id="bcda2-111">La plupart des applications stockent des images de manière permanente et, par conséquent, créent un métafichier amélioré stocké sur un disque. Toutefois, il y a des cas où cela n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="bcda2-111">Most applications store pictures permanently and therefore create an enhanced metafile that is stored on a disk; however, there are some instances when this is not necessary.</span></span> <span data-ttu-id="bcda2-112">Par exemple, une application de traitement de texte qui fournit des fonctionnalités de dessin de graphique peut stocker un graphique défini par l’utilisateur en mémoire en tant que métafichier amélioré, puis copier les bits de métafichier améliorés de la mémoire dans le fichier de document de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bcda2-112">For example, a word-processing application that provides chart-drawing capabilities could store a user-defined chart in memory as an enhanced metafile and then copy the enhanced metafile bits from memory into the user's document file.</span></span> <span data-ttu-id="bcda2-113">Une application qui requiert un métafichier qui est stocké de manière permanente sur un disque doit fournir le nom de fichier lorsqu’il appelle [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span><span class="sxs-lookup"><span data-stu-id="bcda2-113">An application that requires a metafile that is stored permanently on a disk must supply the file name when it calls [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span></span> <span data-ttu-id="bcda2-114">Si vous ne fournissez pas de nom de fichier, le système traite automatiquement le métafichier comme un fichier temporaire et le stocke dans la mémoire.</span><span class="sxs-lookup"><span data-stu-id="bcda2-114">If you do not supply a file name, the system automatically treats the metafile as a temporary file and stores it in memory.</span></span>

<span data-ttu-id="bcda2-115">Vous pouvez ajouter une description textuelle facultative à un métafichier contenant des informations sur l’image et l’auteur.</span><span class="sxs-lookup"><span data-stu-id="bcda2-115">You can add an optional text description to a metafile containing information about the picture and the author.</span></span> <span data-ttu-id="bcda2-116">Une application peut afficher ces chaînes dans la boîte de dialogue Ouvrir un fichier pour fournir à l’utilisateur des informations sur le contenu du métafichier qui vous aideront à sélectionner le fichier approprié.</span><span class="sxs-lookup"><span data-stu-id="bcda2-116">An application can display these strings in the File Open dialog box to provide the user with information about metafile content that will help in selecting the appropriate file.</span></span> <span data-ttu-id="bcda2-117">Si une application comprend la description textuelle, elle doit fournir un pointeur vers la chaîne lorsqu’elle appelle [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span><span class="sxs-lookup"><span data-stu-id="bcda2-117">If an application includes the text description, it must supply a pointer to the string when it calls [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span></span>

<span data-ttu-id="bcda2-118">Quand [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) parvient, il retourne un handle qui identifie un contexte de périphérique de métafichier spécial.</span><span class="sxs-lookup"><span data-stu-id="bcda2-118">When [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) succeeds, it returns a handle that identifies a special metafile device context.</span></span> <span data-ttu-id="bcda2-119">Un contexte de périphérique de métafichier est unique en ce qu’il est associé à un fichier plutôt qu’à un périphérique de sortie.</span><span class="sxs-lookup"><span data-stu-id="bcda2-119">A metafile device context is unique in that it is associated with a file rather than with an output device.</span></span> <span data-ttu-id="bcda2-120">Lorsque le système traite une fonction GDI qui a reçu un handle vers un contexte de périphérique de métafichier, il convertit la fonction GDI en un enregistrement de métafichier amélioré et ajoute l’enregistrement à la fin du métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="bcda2-120">When the system processes a GDI function that received a handle to a metafile device context, it converts the GDI function into an enhanced-metafile record and appends the record to the end of the enhanced metafile.</span></span>

<span data-ttu-id="bcda2-121">Une fois l’image terminée et le dernier enregistrement ajouté au métafichier amélioré, l’application peut fermer le fichier en appelant la fonction [**CloseEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-closeenhmetafile) .</span><span class="sxs-lookup"><span data-stu-id="bcda2-121">After a picture is complete and the last record is appended to the enhanced metafile, the application can close the file by calling the [**CloseEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-closeenhmetafile) function.</span></span> <span data-ttu-id="bcda2-122">Cette fonction ferme et supprime le contexte de périphérique de métafichier spécial et retourne un handle identifiant le métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="bcda2-122">This function closes and deletes the special metafile device context and returns a handle identifying the enhanced metafile.</span></span>

<span data-ttu-id="bcda2-123">Pour supprimer un métafichier de format amélioré ou un handle de métafichier de format amélioré, appelez la fonction [**DeleteEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-deleteenhmetafile) .</span><span class="sxs-lookup"><span data-stu-id="bcda2-123">To delete an enhanced-format metafile or an enhanced-format metafile handle, call the [**DeleteEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-deleteenhmetafile) function.</span></span>

 

 



