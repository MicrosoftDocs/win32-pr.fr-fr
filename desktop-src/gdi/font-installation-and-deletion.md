---
description: Une application peut utiliser une police pour dessiner du texte uniquement si cette police réside sur un périphérique spécifié ou installée dans la table des polices système.
ms.assetid: b422b981-8760-4484-9965-f212287c421e
title: Installation et suppression de polices
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0184054973c769462ed8c1620e5534ff909576ca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991233"
---
# <a name="font-installation-and-deletion"></a><span data-ttu-id="af11e-103">Installation et suppression de polices</span><span class="sxs-lookup"><span data-stu-id="af11e-103">Font Installation and Deletion</span></span>

<span data-ttu-id="af11e-104">Une application peut utiliser une police pour dessiner du texte uniquement si cette police réside sur un périphérique spécifié ou installée dans la table des polices système.</span><span class="sxs-lookup"><span data-stu-id="af11e-104">An application can use a font to draw text only if that font is either resident on a specified device or installed in the system font table.</span></span> <span data-ttu-id="af11e-105">La table de polices est un tableau interne qui identifie toutes les polices non-périphériques disponibles pour une application.</span><span class="sxs-lookup"><span data-stu-id="af11e-105">The font table is an internal array that identifies all nondevice fonts that are available to an application.</span></span> <span data-ttu-id="af11e-106">Une application peut récupérer les noms des polices actuellement installées sur un périphérique ou stockées dans la table de polices interne en appelant les fonctions [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) ou [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="af11e-106">An application can retrieve the names of fonts currently installed on a device or stored in the internal font table by calling the [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) or [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) functions.</span></span>

<span data-ttu-id="af11e-107">Pour installer temporairement une police, appelez [**AddFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) ou [**AddFontResourceEx**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa).</span><span class="sxs-lookup"><span data-stu-id="af11e-107">To temporarily install a font, call [**AddFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) or [**AddFontResourceEx**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa).</span></span> <span data-ttu-id="af11e-108">Ces fonctions chargent une police qui est stockée dans un fichier de ressources de police.</span><span class="sxs-lookup"><span data-stu-id="af11e-108">These functions load a font that is stored in a font-resource file.</span></span> <span data-ttu-id="af11e-109">Toutefois, il s’agit d’une installation temporaire, car après un redémarrage, la police n’est pas présente.</span><span class="sxs-lookup"><span data-stu-id="af11e-109">However, this is a temporary installation because after a reboot the font will not be present.</span></span>

<span data-ttu-id="af11e-110">Pour installer une police qui restera après le redémarrage du système, utilisez l’une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="af11e-110">To install a font that will remain after the system is rebooted, use one of the following methods:</span></span>

-   <span data-ttu-id="af11e-111">Accédez au panneau de configuration, cliquez sur l’icône **polices** , puis sélectionnez **installer de nouvelles polices** dans le menu **fichier** .</span><span class="sxs-lookup"><span data-stu-id="af11e-111">Go to the Control Panel, click the **Fonts** icon, and select **Install New Fonts** from the **File** menu.</span></span> <span data-ttu-id="af11e-112">La police est disponible pour une application, même avant le redémarrage.</span><span class="sxs-lookup"><span data-stu-id="af11e-112">The font is available to an application even before the reboot.</span></span> <span data-ttu-id="af11e-113">Toutefois, dans une situation de serveur Terminal Server, la police est disponible pour la session active, mais elle n’est disponible pour les autres sessions qu’après un redémarrage.</span><span class="sxs-lookup"><span data-stu-id="af11e-113">However, in a terminal server situation the font is available for the current session but is not available for other sessions until after a reboot.</span></span>
-   <span data-ttu-id="af11e-114">Copiez la police dans le dossier% windir% \\ Fonts.</span><span class="sxs-lookup"><span data-stu-id="af11e-114">Copy the font into the %windir%\\fonts folder.</span></span> <span data-ttu-id="af11e-115">Ensuite, accédez au panneau de configuration et cliquez sur l’icône **polices** , ou appelez [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) ou [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa).</span><span class="sxs-lookup"><span data-stu-id="af11e-115">Then, either go to the Control Panel and click the **Fonts** icon, or call [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) or [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa).</span></span> <span data-ttu-id="af11e-116">La police est disponible pour une application, même avant le redémarrage.</span><span class="sxs-lookup"><span data-stu-id="af11e-116">The font is available to an application even before the reboot.</span></span> <span data-ttu-id="af11e-117">Toutefois, dans une situation de serveur Terminal Server, la police est disponible pour la session active, mais elle n’est disponible pour les autres sessions qu’après un redémarrage.</span><span class="sxs-lookup"><span data-stu-id="af11e-117">However, in a terminal server situation the font is available for the current session but is not available for other sessions until after a reboot.</span></span> <span data-ttu-id="af11e-118">Si vous copiez uniquement la police dans le dossier% windir% \\ Fonts, la police n’est disponible qu’après le redémarrage du système.</span><span class="sxs-lookup"><span data-stu-id="af11e-118">If you only copy the font into the %windir%\\fonts folder, the font will be available only after the system is rebooted.</span></span>

<span data-ttu-id="af11e-119">Quand une application se termine en utilisant une police installée, elle doit supprimer cette police en appelant la fonction [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) .</span><span class="sxs-lookup"><span data-stu-id="af11e-119">When an application finishes using an installed font, it must remove that font by calling the [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) function.</span></span>

<span data-ttu-id="af11e-120">Une police installée à partir d’un emplacement autre que le dossier% windir% \\ Fonts ne peut pas être modifiée lorsqu’elle est chargée dans une session active, y compris la session 0.</span><span class="sxs-lookup"><span data-stu-id="af11e-120">A font installed from a location other than the %windir%\\fonts folder cannot be modified when loaded in any active session, including session 0.</span></span> <span data-ttu-id="af11e-121">Toute tentative de modification, de remplacement ou de suppression sera donc bloquée.</span><span class="sxs-lookup"><span data-stu-id="af11e-121">Any attempt to change, replace, or delete will, therefore, be blocked.</span></span> <span data-ttu-id="af11e-122">Si la modification d’une police est nécessaire :</span><span class="sxs-lookup"><span data-stu-id="af11e-122">If modification to a font is necessary:</span></span>

-   <span data-ttu-id="af11e-123">Les *polices temporaires* sont chargées uniquement dans la session active.</span><span class="sxs-lookup"><span data-stu-id="af11e-123">*Temporary fonts* get loaded only in the current session.</span></span> <span data-ttu-id="af11e-124">Avant de tenter toute modification de police, appelez [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) pour forcer la session active à décharger la police.</span><span class="sxs-lookup"><span data-stu-id="af11e-124">Before attempting any font modifications, call [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) to force the current session to unload the font.</span></span>
-   <span data-ttu-id="af11e-125">Les *polices permanentes* restent installées après le redémarrage et sont chargées par toutes les sessions créées.</span><span class="sxs-lookup"><span data-stu-id="af11e-125">*Permanent fonts* remain installed after reboot and are loaded by all created sessions.</span></span> <span data-ttu-id="af11e-126">Appelez [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) pour forcer la session en cours à décharger la police.</span><span class="sxs-lookup"><span data-stu-id="af11e-126">Call [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) to force the current session to unload the font.</span></span> <span data-ttu-id="af11e-127">Ensuite, dans la clé de Registre font (**HKEY \_ local \_ machine \\ Software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ polices**), recherchez et supprimez la valeur de registre associée à la police.</span><span class="sxs-lookup"><span data-stu-id="af11e-127">Then, in the font registry key (**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts**) find and remove the registry value associated with the font.</span></span> <span data-ttu-id="af11e-128">Enfin, redémarrez l’ordinateur pour vous assurer que la police n’est pas chargée dans une session.</span><span class="sxs-lookup"><span data-stu-id="af11e-128">Finally, reboot the machine to ensure the font isn't loaded in any session.</span></span> <span data-ttu-id="af11e-129">Après le redémarrage, effectuez la modification ou la suppression de la police.</span><span class="sxs-lookup"><span data-stu-id="af11e-129">After reboot, proceed with your font modification/deletion.</span></span>

<span data-ttu-id="af11e-130">Chaque fois qu’une application appelle les fonctions qui ajoutent et suppriment des ressources de police, elle doit également appeler la fonction [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) et envoyer un message [**WM \_ FONTCHANGE**](wm-fontchange.md) à toutes les fenêtres de niveau supérieur du système.</span><span class="sxs-lookup"><span data-stu-id="af11e-130">Whenever an application calls the functions that add and delete font resources, it should also call the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function and send a [**WM\_FONTCHANGE**](wm-fontchange.md) message to all top-level windows in the system.</span></span> <span data-ttu-id="af11e-131">Ce message avertit d’autres applications que la table de polices interne a été modifiée par une application qui a ajouté ou supprimé une police.</span><span class="sxs-lookup"><span data-stu-id="af11e-131">This message notifies other applications that the internal font table has been altered by an application that added or removed a font.</span></span>

 

 
