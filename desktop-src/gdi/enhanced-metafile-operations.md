---
description: 'Vous pouvez utiliser le handle vers un métafichier amélioré pour effectuer les tâches suivantes :'
ms.assetid: 8f887c38-6cfa-4918-aa44-dd5fb837b40b
title: Opérations de métafichier améliorées
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18ba9e2ac2f14c4436c039a66cc3211b471c0461
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104114663"
---
# <a name="enhanced-metafile-operations"></a><span data-ttu-id="239ca-103">Opérations de métafichier améliorées</span><span class="sxs-lookup"><span data-stu-id="239ca-103">Enhanced Metafile Operations</span></span>

<span data-ttu-id="239ca-104">Vous pouvez utiliser le handle vers un métafichier amélioré pour effectuer les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="239ca-104">You can use the handle to an enhanced metafile to accomplish the following tasks:</span></span>

-   <span data-ttu-id="239ca-105">Affichez l’image stockée dans un métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-105">Display the picture stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="239ca-106">Créer des copies d’un métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-106">Create copies of an enhanced metafile.</span></span>
-   <span data-ttu-id="239ca-107">Modifiez un métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-107">Edit an enhanced metafile.</span></span>
-   <span data-ttu-id="239ca-108">Récupère la description facultative stockée dans un métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-108">Retrieve the optional description stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="239ca-109">Récupère une copie d’un en-tête de métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-109">Retrieve a copy of an enhanced-metafile header.</span></span>
-   <span data-ttu-id="239ca-110">Récupérer une version binaire d’un métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-110">Retrieve a binary version of an enhanced metafile.</span></span>
-   <span data-ttu-id="239ca-111">Énumérer les couleurs dans la palette facultative.</span><span class="sxs-lookup"><span data-stu-id="239ca-111">Enumerate the colors in the optional palette.</span></span>

<span data-ttu-id="239ca-112">Ces tâches sont décrites dans les sections du reste de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="239ca-112">These tasks are discussed in the sections in the remainder of this topic.</span></span>

## <a name="display-the-picture-stored-in-an-enhanced-metafile"></a><span data-ttu-id="239ca-113">Afficher l’image stockée dans un métafichier amélioré</span><span class="sxs-lookup"><span data-stu-id="239ca-113">Display the Picture Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="239ca-114">Vous pouvez afficher l’image stockée dans un métafichier amélioré à l’aide de la fonction [**PlayEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) .</span><span class="sxs-lookup"><span data-stu-id="239ca-114">You can display the picture stored in an enhanced metafile using the [**PlayEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) function.</span></span> <span data-ttu-id="239ca-115">Transmettez la fonction à un handle vers le métafichier amélioré, sans vous préoccuper du format des enregistrements de métafichiers améliorés.</span><span class="sxs-lookup"><span data-stu-id="239ca-115">Pass the function a handle to the enhanced metafile, without being concerned with the format of the enhanced metafile records.</span></span> <span data-ttu-id="239ca-116">Toutefois, il est parfois souhaitable d’énumérer les enregistrements dans le métafichier amélioré pour rechercher une fonction GDI particulière et modifier les paramètres de la fonction d’une certaine manière.</span><span class="sxs-lookup"><span data-stu-id="239ca-116">However, it is sometimes desirable to enumerate the records in the enhanced metafile to search for a particular GDI function and modify the parameters of the function in some manner.</span></span> <span data-ttu-id="239ca-117">Pour ce faire, vous pouvez utiliser [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) et fournir une fonction de rappel, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), pour traiter les enregistrements de métafichiers améliorés.</span><span class="sxs-lookup"><span data-stu-id="239ca-117">To do this, you can use [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) and provide a callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), to process the enhanced metafile records.</span></span> <span data-ttu-id="239ca-118">Pour modifier les paramètres d’un enregistrement de métafichier amélioré, vous devez connaître le format des paramètres dans l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="239ca-118">To modify the parameters for an enhanced metafile record, you must know the format of the parameters within the record.</span></span>

## <a name="create-copies-of-an-enhanced-metafile"></a><span data-ttu-id="239ca-119">Créer des copies d’un métafichier amélioré</span><span class="sxs-lookup"><span data-stu-id="239ca-119">Create Copies of an Enhanced Metafile</span></span>

<span data-ttu-id="239ca-120">Certaines applications créent des copies de sauvegarde temporaire (ou en double) d’un fichier avant de permettre à l’utilisateur de modifier l’original.</span><span class="sxs-lookup"><span data-stu-id="239ca-120">Some applications create temporary backup (or duplicate) copies of a file before enabling the user to alter the original.</span></span> <span data-ttu-id="239ca-121">Une application peut créer une copie de sauvegarde d’un métafichier amélioré en appelant la fonction [**CopyEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) , en fournissant un handle qui identifie le métafichier amélioré et en fournissant un pointeur vers le nom du nouveau fichier.</span><span class="sxs-lookup"><span data-stu-id="239ca-121">An application can create a backup copy of an enhanced metafile by calling the [**CopyEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) function, supplying a handle that identifies the enhanced metafile, and supplying a pointer to the name of the new file.</span></span>

<span data-ttu-id="239ca-122">Pour créer un métafichier de format amélioré basé sur la mémoire, appelez la fonction [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) .</span><span class="sxs-lookup"><span data-stu-id="239ca-122">To create a memory-based enhanced-format metafile, call the [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) function.</span></span>

## <a name="edit-an-enhanced-metafile"></a><span data-ttu-id="239ca-123">Modifier un métafichier amélioré</span><span class="sxs-lookup"><span data-stu-id="239ca-123">Edit an Enhanced Metafile</span></span>

<span data-ttu-id="239ca-124">La plupart des applications de dessin, d’illustration et de conception assistée par ordinateur (CAD) requièrent un moyen de modifier une image stockée dans un métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-124">Most drawing, illustration, and computer-aided design (CAD) applications require a means of editing a picture stored in an enhanced metafile.</span></span> <span data-ttu-id="239ca-125">Bien que la modification d’un métafichier amélioré soit une tâche complexe, vous pouvez utiliser la fonction [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) conjointement avec d’autres fonctions pour fournir cette fonctionnalité dans votre application.</span><span class="sxs-lookup"><span data-stu-id="239ca-125">Although editing an enhanced metafile is a complex task, you can use the [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) function in combination with other functions to provide this capability in your application.</span></span> <span data-ttu-id="239ca-126">La fonction **EnumEnhMetaFile** et sa fonction de rappel associée, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), permettent à l’application de traiter des enregistrements individuels dans un métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-126">The **EnumEnhMetaFile** function and its associated callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), enable the application to process individual records in an enhanced metafile.</span></span>

## <a name="retrieve-the-optional-description-stored-in-an-enhanced-metafile"></a><span data-ttu-id="239ca-127">Récupérer la description facultative stockée dans un métafichier amélioré</span><span class="sxs-lookup"><span data-stu-id="239ca-127">Retrieve the Optional Description Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="239ca-128">Certaines applications affichent la description textuelle d’un métafichier amélioré avec le nom de fichier correspondant dans la boîte de dialogue **ouvrir** .</span><span class="sxs-lookup"><span data-stu-id="239ca-128">Some applications display the text description of an enhanced metafile with the corresponding file name in the **Open** dialog box.</span></span> <span data-ttu-id="239ca-129">Vous pouvez déterminer si cette chaîne existe dans un métafichier amélioré en extrayant l’en-tête du métafichier avec la fonction [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) et en examinant l’un de ses membres.</span><span class="sxs-lookup"><span data-stu-id="239ca-129">You can determine whether this string exists in an enhanced metafile by retrieving the metafile header with the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examining one of its members.</span></span> <span data-ttu-id="239ca-130">Si la chaîne existe, l’application la récupère en appelant la fonction [**GetEnhMetaFileDescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) .</span><span class="sxs-lookup"><span data-stu-id="239ca-130">If the string exists, the application retrieves it by calling the [**GetEnhMetaFileDescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) function.</span></span>

## <a name="retrieve-a-binary-version-of-an-enhanced-metafile"></a><span data-ttu-id="239ca-131">Récupérer une version binaire d’un métafichier amélioré</span><span class="sxs-lookup"><span data-stu-id="239ca-131">Retrieve a Binary Version of an Enhanced Metafile</span></span>

<span data-ttu-id="239ca-132">Vous pouvez récupérer le contenu d’un métafichier en appelant la fonction [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) ; Toutefois, avant de récupérer le contenu, vous devez spécifier la taille du fichier.</span><span class="sxs-lookup"><span data-stu-id="239ca-132">You can retrieve the contents of a metafile by calling the [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) function; however, before retrieving the contents, you must specify the size of the file.</span></span> <span data-ttu-id="239ca-133">Pour connaître la taille, vous pouvez utiliser la fonction [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) et examiner le membre approprié.</span><span class="sxs-lookup"><span data-stu-id="239ca-133">To get the size, you can use the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examine the appropriate member.</span></span>

## <a name="enumerate-the-colors-in-the-optional-palette"></a><span data-ttu-id="239ca-134">Énumérer les couleurs dans la palette facultative</span><span class="sxs-lookup"><span data-stu-id="239ca-134">Enumerate the Colors in the Optional Palette</span></span>

<span data-ttu-id="239ca-135">Pour obtenir des couleurs cohérentes quand une image est affichée sur différents périphériques de sortie, vous pouvez appeler la fonction [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) et stocker une palette logique dans un métafichier amélioré.</span><span class="sxs-lookup"><span data-stu-id="239ca-135">To achieve consistent colors when a picture is displayed on various output devices, you can call the [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) function and store a logical palette in an enhanced metafile.</span></span> <span data-ttu-id="239ca-136">Une application qui affiche l’image stockée dans le métafichier amélioré récupère cette palette et appelle la fonction [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) avant d’afficher l’image.</span><span class="sxs-lookup"><span data-stu-id="239ca-136">An application that displays the picture stored in the enhanced metafile retrieves this palette and calls the [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) function before displaying the picture.</span></span> <span data-ttu-id="239ca-137">Pour déterminer si une palette est stockée dans un métafichier amélioré, récupérez l’en-tête du métafichier et examinez le membre approprié.</span><span class="sxs-lookup"><span data-stu-id="239ca-137">To determine whether a palette is stored in an enhanced metafile, retrieve the metafile header and examine the appropriate member.</span></span> <span data-ttu-id="239ca-138">Si une palette existe, vous pouvez appeler la fonction [**GetEnhMetaFilePaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) pour récupérer la palette logique.</span><span class="sxs-lookup"><span data-stu-id="239ca-138">If a palette exists, you can call the [**GetEnhMetaFilePaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) function to retrieve the logical palette.</span></span>

 

 
