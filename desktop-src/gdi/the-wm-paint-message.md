---
description: En règle générale, une application dessine dans une fenêtre en réponse à un \_ message de peinture WM.
ms.assetid: b2317ce9-e775-450e-91f5-00f735f256a3
title: Message WM_PAINT
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a69f7dab736972d8b7226890144efd8763de856a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104991784"
---
# <a name="the-wm_paint-message"></a><span data-ttu-id="de097-103">Message de \_ peinture WM</span><span class="sxs-lookup"><span data-stu-id="de097-103">The WM\_PAINT Message</span></span>

<span data-ttu-id="de097-104">En règle générale, une application dessine dans une fenêtre en réponse à un message de [**\_ peinture WM**](wm-paint.md) .</span><span class="sxs-lookup"><span data-stu-id="de097-104">Typically, an application draws in a window in response to a [**WM\_PAINT**](wm-paint.md) message.</span></span> <span data-ttu-id="de097-105">Le système envoie ce message à une procédure de fenêtre lorsque les modifications apportées à la fenêtre ont modifié le contenu de la zone cliente.</span><span class="sxs-lookup"><span data-stu-id="de097-105">The system sends this message to a window procedure when changes to the window have altered the content of the client area.</span></span> <span data-ttu-id="de097-106">Le système envoie le message uniquement s’il n’y a pas d’autres messages dans la file d’attente des messages d’application.</span><span class="sxs-lookup"><span data-stu-id="de097-106">The system sends the message only if there are no other messages in the application message queue.</span></span>

<span data-ttu-id="de097-107">Lors de la réception d’un message [**WM \_ Paint**](wm-paint.md) , une application peut appeler [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) pour récupérer le contexte de périphérique d’affichage pour la zone cliente et l’utiliser dans les appels aux fonctions GDI pour effectuer toutes les opérations de dessin nécessaires pour mettre à jour la zone cliente.</span><span class="sxs-lookup"><span data-stu-id="de097-107">Upon receiving a [**WM\_PAINT**](wm-paint.md) message, an application can call [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) to retrieve the display device context for the client area and use it in calls to GDI functions to carry out whatever drawing operations are necessary to update the client area.</span></span> <span data-ttu-id="de097-108">Une fois les opérations de dessin terminées, l’application appelle la fonction [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) pour libérer le contexte de périphérique d’affichage.</span><span class="sxs-lookup"><span data-stu-id="de097-108">After completing the drawing operations, the application calls the [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) function to release the display device context.</span></span>

<span data-ttu-id="de097-109">Avant que [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) retourne le contexte de périphérique d’affichage, le système prépare le contexte de périphérique pour la fenêtre spécifiée.</span><span class="sxs-lookup"><span data-stu-id="de097-109">Before [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) returns the display device context, the system prepares the device context for the specified window.</span></span> <span data-ttu-id="de097-110">Il définit d’abord la zone de découpage pour que le contexte de périphérique soit égal à l’intersection de la partie de la fenêtre qui doit être mise à jour et de la partie qui est visible pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="de097-110">It first sets the clipping region for the device context to be equal to the intersection of the portion of the window that needs updating and the portion that is visible to the user.</span></span> <span data-ttu-id="de097-111">Seules les parties de la fenêtre qui ont changé sont redessinées.</span><span class="sxs-lookup"><span data-stu-id="de097-111">Only those portions of the window that have changed are redrawn.</span></span> <span data-ttu-id="de097-112">Les tentatives de dessin en dehors de cette région sont découpées et n’apparaissent pas à l’écran.</span><span class="sxs-lookup"><span data-stu-id="de097-112">Attempts to draw outside this region are clipped and do not appear on the screen.</span></span>

<span data-ttu-id="de097-113">Le système peut également envoyer des messages [**WM \_ NCPAINT**](wm-ncpaint.md) et [**WM \_ ERASEBKGND**](../winmsg/wm-erasebkgnd.md) à la procédure de fenêtre avant que [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) retourne.</span><span class="sxs-lookup"><span data-stu-id="de097-113">The system can also send [**WM\_NCPAINT**](wm-ncpaint.md) and [**WM\_ERASEBKGND**](../winmsg/wm-erasebkgnd.md) messages to the window procedure before [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) returns.</span></span> <span data-ttu-id="de097-114">Ces messages indiquent à l’application de dessiner la zone non cliente et l’arrière-plan de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="de097-114">These messages direct the application to draw the nonclient area and window background.</span></span> <span data-ttu-id="de097-115">La *zone non cliente* est la partie d’une fenêtre qui est en dehors de la zone cliente.</span><span class="sxs-lookup"><span data-stu-id="de097-115">The *nonclient area* is the part of a window that is outside of the client area.</span></span> <span data-ttu-id="de097-116">La zone comprend des fonctionnalités telles que la barre de titre, le menu fenêtre (également connu sous le nom de menu **système** ) et les barres de défilement.</span><span class="sxs-lookup"><span data-stu-id="de097-116">The area includes features such as the title bar, window menu (also known as the **System** menu), and scroll bars.</span></span> <span data-ttu-id="de097-117">La plupart des applications s’appuient sur la fonction de fenêtre par défaut, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca), pour dessiner cette zone et transmettre donc le message **WM \_ NCPAINT** à cette fonction.</span><span class="sxs-lookup"><span data-stu-id="de097-117">Most applications rely on the default window function, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca), to draw this area and therefore pass the **WM\_NCPAINT** message to this function.</span></span> <span data-ttu-id="de097-118">L' *arrière-plan* de la fenêtre est la couleur ou le motif avec lequel une fenêtre est remplie avant le début des autres opérations de dessin.</span><span class="sxs-lookup"><span data-stu-id="de097-118">The *window background* is the color or pattern that a window is filled with before other drawing operations begin.</span></span> <span data-ttu-id="de097-119">L’arrière-plan couvre les images précédemment dans la fenêtre ou sur l’écran sous la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="de097-119">The background covers any images previously in the window or on the screen under the window.</span></span> <span data-ttu-id="de097-120">Si une fenêtre appartient à une classe de fenêtre ayant un pinceau d’arrière-plan de classe, la fonction **DefWindowProc** dessine automatiquement l’arrière-plan de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="de097-120">If a window belongs to a window class having a class background brush, the **DefWindowProc** function draws the window background automatically.</span></span>

<span data-ttu-id="de097-121">[**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) remplit une structure [**PAINTSTRUCT,**](/windows/win32/api/winuser/ns-winuser-paintstruct) avec des informations telles que les dimensions de la partie de la fenêtre à mettre à jour et un indicateur qui spécifie si l’arrière-plan de la fenêtre a été dessiné.</span><span class="sxs-lookup"><span data-stu-id="de097-121">[**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) fills a [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct) structure with information such as the dimensions of the portion of the window to be updated and a flag indicating whether the window background has been drawn.</span></span> <span data-ttu-id="de097-122">L’application peut utiliser ces informations pour optimiser le dessin.</span><span class="sxs-lookup"><span data-stu-id="de097-122">The application can use this information to optimize drawing.</span></span> <span data-ttu-id="de097-123">Par exemple, il peut utiliser les dimensions de la région de mise à jour, spécifiées par le membre **rcPaint** , pour limiter le dessin uniquement aux parties de la fenêtre qui nécessitent une mise à jour.</span><span class="sxs-lookup"><span data-stu-id="de097-123">For example, it can use the dimensions of the update region, specified by the **rcPaint** member, to limit drawing to only those portions of the window that need updating.</span></span> <span data-ttu-id="de097-124">Si une application a une sortie très simple, elle peut ignorer la région de mise à jour et dessiner dans la fenêtre entière, en se basant sur le système pour ignorer (détourer) toute sortie inutile.</span><span class="sxs-lookup"><span data-stu-id="de097-124">If an application has very simple output, it can ignore the update region and draw in the entire window, relying on the system to discard (clip) any unneeded output.</span></span> <span data-ttu-id="de097-125">Étant donné que le dessin de clips s’étend hors de la zone de découpage, seul le dessin qui se trouve dans la région de mise à jour est visible.</span><span class="sxs-lookup"><span data-stu-id="de097-125">Because the system clips drawing that extends outside the clipping region, only drawing that is in the update region is visible.</span></span>

<span data-ttu-id="de097-126">[**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) affecte la **valeur null** à la zone de mise à jour d’une fenêtre.</span><span class="sxs-lookup"><span data-stu-id="de097-126">[**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) sets the update region of a window to **NULL**.</span></span> <span data-ttu-id="de097-127">Cela efface la région, ce qui l’empêche de générer les messages de [**\_ peinture WM**](wm-paint.md) suivants.</span><span class="sxs-lookup"><span data-stu-id="de097-127">This clears the region, preventing it from generating subsequent [**WM\_PAINT**](wm-paint.md) messages.</span></span> <span data-ttu-id="de097-128">Si une application traite un message de **\_ peinture WM** mais n’appelle pas **BeginPaint** ou efface la zone de mise à jour, l’application continue à recevoir des messages de **\_ peinture WM** tant que la région n’est pas vide.</span><span class="sxs-lookup"><span data-stu-id="de097-128">If an application processes a **WM\_PAINT** message but does not call **BeginPaint** or otherwise clear the update region, the application continues to receive **WM\_PAINT** messages as long as the region is not empty.</span></span> <span data-ttu-id="de097-129">Dans tous les cas, une application doit effacer la zone de mise à jour avant de retourner le message de **\_ peinture WM** .</span><span class="sxs-lookup"><span data-stu-id="de097-129">In all cases, an application must clear the update region before returning from the **WM\_PAINT** message.</span></span>

<span data-ttu-id="de097-130">Une fois que l’application a terminé le dessin, elle doit appeler [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint).</span><span class="sxs-lookup"><span data-stu-id="de097-130">After the application finishes drawing, it should call [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint).</span></span> <span data-ttu-id="de097-131">Pour la plupart des fenêtres, **EndPaint** libère le contexte de périphérique d’affichage, ce qui le rend disponible pour d’autres fenêtres.</span><span class="sxs-lookup"><span data-stu-id="de097-131">For most windows, **EndPaint** releases the display device context, making it available to other windows.</span></span> <span data-ttu-id="de097-132">**EndPaint** affiche également le signe insertion, s’il a été précédemment masqué par [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint).</span><span class="sxs-lookup"><span data-stu-id="de097-132">**EndPaint** also shows the caret, if it was previously hidden by [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint).</span></span> <span data-ttu-id="de097-133">**BeginPaint** masque le signe insertion pour empêcher les opérations de dessin de l’endommager.</span><span class="sxs-lookup"><span data-stu-id="de097-133">**BeginPaint** hides the caret to prevent drawing operations from corrupting it.</span></span>

-   [<span data-ttu-id="de097-134">La région de mise à jour</span><span class="sxs-lookup"><span data-stu-id="de097-134">The Update Region</span></span>](the-update-region.md)
-   [<span data-ttu-id="de097-135">Invalidation et validation de la région de mise à jour</span><span class="sxs-lookup"><span data-stu-id="de097-135">Invalidating and Validating the Update Region</span></span>](invalidating-and-validating-the-update-region.md)
-   [<span data-ttu-id="de097-136">Récupération de la région de mise à jour</span><span class="sxs-lookup"><span data-stu-id="de097-136">Retrieving the Update Region</span></span>](retrieving-the-update-region.md)
-   [<span data-ttu-id="de097-137">Exclusion de la région de mise à jour</span><span class="sxs-lookup"><span data-stu-id="de097-137">Excluding the Update Region</span></span>](excluding-the-update-region.md)
-   [<span data-ttu-id="de097-138">Dessin synchrone et asynchrone</span><span class="sxs-lookup"><span data-stu-id="de097-138">Synchronous and Asynchronous Drawing</span></span>](synchronous-and-asynchronous-drawing.md)

 

 
