---
title: Objet de collection Commands
description: Objet de collection Commands
ms.assetid: 8726ce04-77d3-4ae3-bd46-e75f42b36d6f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c2367035d86f92d57dc459564943b9e7797ecb04
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104381793"
---
# <a name="the-commands-collection-object"></a><span data-ttu-id="dae85-103">Objet de collection Commands</span><span class="sxs-lookup"><span data-stu-id="dae85-103">The Commands Collection Object</span></span>

<span data-ttu-id="dae85-104">\[Microsoft Agent est déconseillé à partir de Windows 7 et peut ne pas être disponible dans les versions ultérieures de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="dae85-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="dae85-105">Le serveur Microsoft Agent gère une liste de commandes actuellement disponibles pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="dae85-105">The Microsoft Agent server maintains a list of commands that are currently available to the user.</span></span> <span data-ttu-id="dae85-106">Cette liste comprend les commandes que le serveur définit pour l’interaction générale (par exemple, masquer et ouvrir la fenêtre commandes vocales), la liste des clients disponibles (mais non-entrée-active) et les commandes définies par le client actif actuel.</span><span class="sxs-lookup"><span data-stu-id="dae85-106">This list includes commands that the server defines for general interaction (such as Hide and Open The Voice Commands Window), the list of available (but non-input-active) clients, and the commands defined by the current active client.</span></span> <span data-ttu-id="dae85-107">Les deux premiers jeux de commandes sont des commandes globales ; autrement dit, elles sont disponibles à tout moment, quel que soit le client d’entrée-actif.</span><span class="sxs-lookup"><span data-stu-id="dae85-107">The first two sets of commands are global commands; that is, they are available at any time, regardless of the input-active client.</span></span> <span data-ttu-id="dae85-108">Les commandes définies par le client ne sont disponibles que lorsque ce client est en entrée-actif et que le caractère est visible.</span><span class="sxs-lookup"><span data-stu-id="dae85-108">Client-defined commands are available only when that client is input-active and the character is visible.</span></span>

<span data-ttu-id="dae85-109">Chaque application cliente peut définir une collection de commandes appelée la collection [**Commands**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="dae85-109">Each client application can define a collection of commands called the [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="dae85-110">Pour ajouter une commande à la collection, utilisez la méthode [**Add**](add-method.md) ou [**Insert**](insert-method.md) .</span><span class="sxs-lookup"><span data-stu-id="dae85-110">To add a command to the collection, use the [**Add**](add-method.md) or [**Insert**](insert-method.md) method.</span></span> <span data-ttu-id="dae85-111">Bien que vous puissiez spécifier les propriétés d’une commande avec des instructions distinctes, pour optimiser les performances du code, spécifiez toutes les propriétés d’une commande dans l’instruction **Add** ou **Insert** Method.</span><span class="sxs-lookup"><span data-stu-id="dae85-111">Although you can specify a command's properties with separate statements, for optimum code performance, specify all of a command's properties in the **Add** or **Insert** method statement.</span></span> <span data-ttu-id="dae85-112">Pour chaque commande de la collection, vous pouvez déterminer si l’accès utilisateur à la commande s’affiche dans le menu contextuel du caractère, dans la fenêtre commandes vocales, dans les deux ou dans aucun des deux.</span><span class="sxs-lookup"><span data-stu-id="dae85-112">For each command in the collection, you can determine whether user access to the command appears in the character's pop-up menu, in the Voice Commands Window, in both, or in neither.</span></span> <span data-ttu-id="dae85-113">Par exemple, si vous souhaitez qu’une commande apparaisse dans le menu contextuel du caractère, définissez la [**légende**](caption-property.md) et les propriétés [**visibles**](visible-property.md) de la commande.</span><span class="sxs-lookup"><span data-stu-id="dae85-113">For example, if you want a command to appear on the pop-up menu for the character, set the command's [**Caption**](caption-property.md) and [**Visible**](visible-property.md) properties.</span></span> <span data-ttu-id="dae85-114">Pour afficher la commande dans la fenêtre commandes vocales, définissez les propriétés [**VoiceCaption**](voicecaption-property.md) et [**Voice**](voice-property.md) de la commande.</span><span class="sxs-lookup"><span data-stu-id="dae85-114">To display the command in the Voice Commands Window, set the command's [**VoiceCaption**](voicecaption-property.md) and [**Voice**](voice-property.md) properties.</span></span>

<span data-ttu-id="dae85-115">Un utilisateur peut accéder aux [**commandes**](/windows/desktop/lwef/the-commands-collection-object)comm individuelles ands dans votre collection uniquement lorsque votre application cliente est en entrée active.</span><span class="sxs-lookup"><span data-stu-id="dae85-115">A user can access the individual comm [**Commands**](/windows/desktop/lwef/the-commands-collection-object)ands in your collection only when your client application is input-active.</span></span> <span data-ttu-id="dae85-116">Par conséquent, lorsque vous partagez le caractère avec d’autres applications clientes, vous souhaiterez généralement définir les propriétés [**Caption**](caption-property.md), [**VoiceCaption**](voicecaption-property.md)et [**Voice**](voice-property.md) pour l’objet de collection **Commands** , ainsi que pour les commandes de la collection.</span><span class="sxs-lookup"><span data-stu-id="dae85-116">Therefore, when you may be sharing the character with other client applications you'll typically want to set the [**Caption**](caption-property.md), [**VoiceCaption**](voicecaption-property.md), and [**Voice**](voice-property.md) properties for the **Commands** collection object as well as for the commands in the collection.</span></span> <span data-ttu-id="dae85-117">Cela place une entrée pour votre collection de **commandes** dans le menu contextuel d’un caractère et dans la fenêtre commandes vocales.</span><span class="sxs-lookup"><span data-stu-id="dae85-117">This places an entry for your **Commands** collection in a character's pop-up menu and in the Voice Commands Window.</span></span>

<span data-ttu-id="dae85-118">Lorsque l’utilisateur bascule vers votre client en choisissant son entrée [**Commands**](/windows/desktop/lwef/the-commands-collection-object) , le serveur rend automatiquement votre client Input-active, en avertissant votre application cliente à l’aide de l’événement [**ActivateInput**](activateinput-event.md) et rend les commandes de sa collection disponibles.</span><span class="sxs-lookup"><span data-stu-id="dae85-118">When the user switches to your client by choosing its [**Commands**](/windows/desktop/lwef/the-commands-collection-object) entry, the server automatically makes your client input-active, notifying your client application using the [**ActivateInput**](activateinput-event.md) event and makes the commands in its collection available.</span></span> <span data-ttu-id="dae85-119">Le serveur signale également au client qu’il n’est plus en cours d’entrée-actif avec l’événement [**DeActivateInput**](deactivateinput-event.md) .</span><span class="sxs-lookup"><span data-stu-id="dae85-119">The server also notifies the client that it is no longer input-active with the [**DeActivateInput**](deactivateinput-event.md) event.</span></span> <span data-ttu-id="dae85-120">Cela permet au serveur de présenter et d’accepter uniquement les commandes qui s’appliquent au contexte du client d’entrée actif.</span><span class="sxs-lookup"><span data-stu-id="dae85-120">This enables the server to present and accept only the commands that apply to the current input-active client's context.</span></span> <span data-ttu-id="dae85-121">Elle sert également à éviter les collisions de nom de commande entre les clients.</span><span class="sxs-lookup"><span data-stu-id="dae85-121">It also serves to avoid command-name collisions between clients.</span></span>

<span data-ttu-id="dae85-122">Un client peut également demander explicitement de se rendre lui-même le client d’entrée-actif à l’aide de la méthode [**Activate**](activate-method.md) .</span><span class="sxs-lookup"><span data-stu-id="dae85-122">A client can also explicitly request to make itself the input-active client using the [**Activate**](activate-method.md) method.</span></span> <span data-ttu-id="dae85-123">Cette méthode prend également en charge la configuration de votre application pour qu’elle ne soit pas le client d’entrée-actif.</span><span class="sxs-lookup"><span data-stu-id="dae85-123">This method also supports setting your application to not be the input-active client.</span></span> <span data-ttu-id="dae85-124">Vous pouvez utiliser cette méthode lorsque vous partagez un caractère avec une autre application, en définissant votre application de sorte qu’elle soit en entrée-active quand votre fenêtre d’application devient active et non active quand elle perd le focus.</span><span class="sxs-lookup"><span data-stu-id="dae85-124">You may want to use this method when you are sharing a character with another application, setting your application to be input-active when your application window gets focus and not input-active when it loses focus.</span></span>

<span data-ttu-id="dae85-125">De même, vous pouvez utiliser la méthode [**Activate**](activate-method.md) pour définir votre application comme étant (ou non) le client actif du caractère.</span><span class="sxs-lookup"><span data-stu-id="dae85-125">Similarly, you can use the [**Activate**](activate-method.md) method to set your application to be (or not be) the active client of the character.</span></span> <span data-ttu-id="dae85-126">Le client actif est le client qui reçoit l’entrée lorsque son caractère est le caractère le plus haut.</span><span class="sxs-lookup"><span data-stu-id="dae85-126">The active client is the client that receives input when its character is the topmost character.</span></span> <span data-ttu-id="dae85-127">Lorsque cet état change, le serveur notifie votre application avec l’événement [**ActiveClientChange**](activeclientchange-event.md) .</span><span class="sxs-lookup"><span data-stu-id="dae85-127">When this status changes, the server notifies your application with the [**ActiveClientChange**](activeclientchange-event.md) event.</span></span>

<span data-ttu-id="dae85-128">Lorsque le menu contextuel d’un caractère s’affiche, les modifications apportées aux propriétés d’une collection de [**commandes**](/windows/desktop/lwef/the-commands-collection-object) ou aux commandes de sa collection ne s’affichent pas tant que l’utilisateur n’a pas réaffiché le menu.</span><span class="sxs-lookup"><span data-stu-id="dae85-128">When a character's pop-up menu displays, changes to the properties of a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection or the commands in its collection do not appear until the user redisplays the menu.</span></span> <span data-ttu-id="dae85-129">Toutefois, la fenêtre commandes affiche des modifications à mesure qu’elles se produisent.</span><span class="sxs-lookup"><span data-stu-id="dae85-129">However, the Commands Window does display changes as they happen.</span></span>

-   [<span data-ttu-id="dae85-130">Méthodes de l’objet Commands</span><span class="sxs-lookup"><span data-stu-id="dae85-130">Commands Object Methods</span></span>](commands-object-methods.md)
-   [<span data-ttu-id="dae85-131">Propriétés de l’objet Commands</span><span class="sxs-lookup"><span data-stu-id="dae85-131">Commands Object Properties</span></span>](commands-object-properties.md)

 

 