---
title: IAgentCommands SetVoice
description: IAgentCommands SetVoice
ms.assetid: dfb3b58a-7f24-4366-8f04-93a9e956fdc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a8e29936dbca65ffded5f8a5e5ea5297b28362e
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104463018"
---
# <a name="iagentcommandssetvoice"></a><span data-ttu-id="6691e-103">IAgentCommands::SetVoice</span><span class="sxs-lookup"><span data-stu-id="6691e-103">IAgentCommands::SetVoice</span></span>

<span data-ttu-id="6691e-104">\[Microsoft Agent est déconseillé à partir de Windows 7 et peut ne pas être disponible dans les versions ultérieures de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="6691e-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

``` syntax
HRESULT SetVoice(
   BSTR bszVoice  // the Voice setting for Command collection
);
```

<span data-ttu-id="6691e-105">Définit la propriété de texte [**vocal**](voice-property.md) pour une [**commande**](/windows/desktop/lwef/the-command-object).</span><span class="sxs-lookup"><span data-stu-id="6691e-105">Sets the [**Voice**](voice-property.md) text property for a [**Command**](/windows/desktop/lwef/the-command-object).</span></span>

-   <span data-ttu-id="6691e-106">Retourne \_ la valeur S OK pour indiquer que l’opération a réussi.</span><span class="sxs-lookup"><span data-stu-id="6691e-106">Returns S\_OK to indicate the operation was successful.</span></span>

<dl> <dt>

<span data-ttu-id="6691e-107"><span id="bszVoice"></span><span id="bszvoice"></span><span id="BSZVOICE"></span>*bszVoice*</span><span class="sxs-lookup"><span data-stu-id="6691e-107"><span id="bszVoice"></span><span id="bszvoice"></span><span id="BSZVOICE"></span>*bszVoice*</span></span>
</dt> <dd>

<span data-ttu-id="6691e-108">BSTR qui spécifie la valeur de la propriété texte [**vocal**](voice-property.md) d’une collection de [**commandes**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="6691e-108">A BSTR that specifies the value for the [**Voice**](voice-property.md) text property of a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span>

</dd> </dl>

<span data-ttu-id="6691e-109">La propriété de texte [**vocal**](voice-property.md) d’une collection de [**commandes**](/windows/desktop/lwef/the-commands-collection-object) doit être définie sur Voice-accessible.</span><span class="sxs-lookup"><span data-stu-id="6691e-109">A [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection must have its [**Voice**](voice-property.md) text property set to be voice-accessible.</span></span> <span data-ttu-id="6691e-110">Elle doit également avoir la propriété [**VoiceCaption**](voicecaption-property.md) ou [**Caption**](caption-property.md) définie pour s’afficher dans la fenêtre commandes vocales et sa propriété [**visible**](visible-property.md) définie sur **true** pour apparaître dans le menu contextuel du caractère.</span><span class="sxs-lookup"><span data-stu-id="6691e-110">It also must have its [**VoiceCaption**](voicecaption-property.md) or [**Caption**](caption-property.md) property set to appear in the Voice Commands Window and its [**Visible**](visible-property.md) property set to **True** to appear on the character's pop-up menu.</span></span>

<span data-ttu-id="6691e-111">L’expression BSTR que vous fournissez peut inclure des caractères de crochets ( \[ \] ) pour indiquer des mots facultatifs et des caractères de barre verticale ( \| ) pour indiquer d’autres chaînes.</span><span class="sxs-lookup"><span data-stu-id="6691e-111">The BSTR expression you supply can include square bracket characters (\[ \]) to indicate optional words and vertical bar characters (\|) to indicate alternative strings.</span></span> <span data-ttu-id="6691e-112">Les remplacements doivent être placés entre parenthèses.</span><span class="sxs-lookup"><span data-stu-id="6691e-112">Alternates must be enclosed in parentheses.</span></span> <span data-ttu-id="6691e-113">Par exemple, « (Bonjour \[ Bonjour \] \| ) » indique au moteur de reconnaissance vocale d’accepter « Hello », « Hello This » ou « HI » pour la commande.</span><span class="sxs-lookup"><span data-stu-id="6691e-113">For example, "(hello \[there\] \| hi)" tells the speech engine to accept "hello," "hello there," or "hi" for the command.</span></span> <span data-ttu-id="6691e-114">N’oubliez pas d’inclure des espaces appropriés entre les mots que vous incluez entre crochets ou entre parenthèses, ainsi que d’autres textes.</span><span class="sxs-lookup"><span data-stu-id="6691e-114">Remember to include appropriate spaces between words you include in brackets or parentheses as well as other text.</span></span> <span data-ttu-id="6691e-115">N’oubliez pas d’inclure des espaces appropriés entre le texte entre crochets ou entre parenthèses et le texte qui ne se trouve pas entre crochets ou entre parenthèses.</span><span class="sxs-lookup"><span data-stu-id="6691e-115">Remember to include appropriate spaces between the text that's in brackets or parentheses and the text that's not in brackets or parentheses.</span></span>

<span data-ttu-id="6691e-116">Vous pouvez utiliser l’opérateur Star ( \* ) pour spécifier zéro, une ou plusieurs instances des mots inclus dans le groupe ou l’opérateur plus (+) pour spécifier une ou plusieurs instances.</span><span class="sxs-lookup"><span data-stu-id="6691e-116">You can use the star (\*) operator to specify zero or more instances of the words included in the group or the plus (+) operator to specify one or more instances.</span></span> <span data-ttu-id="6691e-117">Par exemple, le code suivant génère une grammaire qui prend en charge « essayez cela », veuillez essayer cela», et « veuillez essayer cela », avec des itérations illimitées de « veuillez » :</span><span class="sxs-lookup"><span data-stu-id="6691e-117">For example, the following results in a grammar that supports "try this", "please try this", and "please please try this", with unlimited iterations of "please":</span></span>

``` syntax
   "please* try this"
```

<span data-ttu-id="6691e-118">Le format de grammaire suivant exclut « essayer », car l’opérateur + définit au moins une instance de « veuillez » :</span><span class="sxs-lookup"><span data-stu-id="6691e-118">The following grammar format excludes "try this" because the + operator defines at least one instance of "please":</span></span>

``` syntax
   "please+ try this"
```

<span data-ttu-id="6691e-119">Les opérateurs de répétition suivent les règles de précédence normales et s’appliquent à l’élément de texte qui précède immédiatement.</span><span class="sxs-lookup"><span data-stu-id="6691e-119">The repetition operators follow normal rules of precedence and apply to the immediately preceding text item.</span></span> <span data-ttu-id="6691e-120">Par exemple, la grammaire suivante aboutit à « New York » et à « New York York », mais pas à « New York New York » :</span><span class="sxs-lookup"><span data-stu-id="6691e-120">For example, the following grammar results in "New York" and "New York York", but not "New York New York":</span></span>

``` syntax
   "New York+"
```

<span data-ttu-id="6691e-121">Par conséquent, vous souhaitez généralement utiliser ces opérateurs avec les caractères de regroupement.</span><span class="sxs-lookup"><span data-stu-id="6691e-121">Therefore, you typically want to use these operators with the grouping characters.</span></span> <span data-ttu-id="6691e-122">Par exemple, la grammaire suivante comprend à la fois « New York » et « New York New York » :</span><span class="sxs-lookup"><span data-stu-id="6691e-122">For example, the following grammar includes both "New York" and "New York New York":</span></span>

``` syntax
   "(New York)+"
```

<span data-ttu-id="6691e-123">Les opérateurs de répétition sont utiles lorsque vous souhaitez composer une grammaire qui comprend une séquence répétée telle qu’un numéro de téléphone ou une spécification d’une liste d’éléments :</span><span class="sxs-lookup"><span data-stu-id="6691e-123">Repetition operators are useful when you want to compose a grammar that includes a repeated sequence such as a phone number or specification of a list of items:</span></span>

``` syntax
   "call (one|two|three|four|five|six|seven|eight|nine|zero|oh)*"
   "I'd like (cheese|pepperoni|pineapple|canadian bacon|mushrooms|and)+"
```

<span data-ttu-id="6691e-124">Bien que les opérateurs puissent également être utilisés avec des crochets (un caractère de regroupement facultatif), cela peut réduire l’efficacité du traitement de la grammaire par l’agent.</span><span class="sxs-lookup"><span data-stu-id="6691e-124">Although the operators can also be used with square brackets (an optional grouping character), doing so may reduce the efficiency of Agent's processing of the grammar.</span></span>

<span data-ttu-id="6691e-125">Vous pouvez également utiliser des points de suspension (...) *pour prendre en* charge la détection de mots, c’est-à-dire dire au moteur de reconnaissance vocale d’ignorer les mots prononcés à cette position dans l’expression ( *parfois appelés «* mots de passe »).</span><span class="sxs-lookup"><span data-stu-id="6691e-125">You can also use an ellipsis (...) to support *word spotting*, that is, telling the speech recognition engine to ignore words spoken in this position in the phrase (sometimes called *garbage* words).</span></span> <span data-ttu-id="6691e-126">Lorsque vous utilisez des ellipses, le moteur de reconnaissance vocale ne reconnaît que des mots spécifiques dans la chaîne, quel que soit le moment où il est parlé avec des mots ou expressions adjacents.</span><span class="sxs-lookup"><span data-stu-id="6691e-126">When you use ellipses, the speech engine recognizes only specific words in the string regardless of when spoken with adjacent words or phrases.</span></span> <span data-ttu-id="6691e-127">Par exemple, si vous définissez cette propriété sur « \[ ... \] vérifier \[ le courrier... \] » le moteur de reconnaissance vocale met en correspondance les expressions telles que « Veuillez vérifier la messagerie » ou « vérifier la messagerie » à cette commande.</span><span class="sxs-lookup"><span data-stu-id="6691e-127">For example, if you set this property to "\[...\] check mail \[...\]" the speech recognition engine will match phrases like "please check mail" or "check mail please" to this command.</span></span> <span data-ttu-id="6691e-128">Les ellipses peuvent être utilisées n’importe où dans une chaîne.</span><span class="sxs-lookup"><span data-stu-id="6691e-128">Ellipses can be used anywhere within a string.</span></span> <span data-ttu-id="6691e-129">Toutefois, soyez prudent lorsque vous utilisez cette technique, car les paramètres vocaux avec ellipses peuvent augmenter le potentiel des correspondances indésirables.</span><span class="sxs-lookup"><span data-stu-id="6691e-129">However, be careful using this technique as voice settings with ellipses may increase the potential of unwanted matches.</span></span>

<span data-ttu-id="6691e-130">Lorsque vous définissez les mots et la grammaire de votre commande, incluez au moins un mot requis ; autrement dit, évitez de fournir uniquement des mots facultatifs.</span><span class="sxs-lookup"><span data-stu-id="6691e-130">When defining the words and grammar for your command, include at least one word that is required; that is, avoid supplying only optional words.</span></span> <span data-ttu-id="6691e-131">En outre, assurez-vous que le mot contient uniquement des mots et des lettres de prononce.</span><span class="sxs-lookup"><span data-stu-id="6691e-131">In addition, make sure that the word includes only pronounceable words and letters.</span></span> <span data-ttu-id="6691e-132">Pour les nombres, il est préférable d’épeler le mot plutôt que d’utiliser une représentation ambiguë.</span><span class="sxs-lookup"><span data-stu-id="6691e-132">For numbers, it is better to spell out the word rather than use an ambiguous representation.</span></span> <span data-ttu-id="6691e-133">Par exemple, « 345 » n’est pas une bonne forme de grammaire.</span><span class="sxs-lookup"><span data-stu-id="6691e-133">For example, "345" is not a good grammar form.</span></span> <span data-ttu-id="6691e-134">De même, au lieu de « IEEE », utilisez « I triple E ».</span><span class="sxs-lookup"><span data-stu-id="6691e-134">Similarly, instead of "IEEE", use "I triple E".</span></span> <span data-ttu-id="6691e-135">De même, omettez les signes de ponctuation ou les symboles.</span><span class="sxs-lookup"><span data-stu-id="6691e-135">Also, omit any punctuation or symbols.</span></span> <span data-ttu-id="6691e-136">Par exemple, au lieu de « The \# $1 10 pizza ! », utilisez « the number 1 10 dollar pizza ».</span><span class="sxs-lookup"><span data-stu-id="6691e-136">For example, instead of "the \#1 $10 pizza!", use "the number one ten dollar pizza".</span></span> <span data-ttu-id="6691e-137">L’inclusion de caractères ou symboles non prononceables pour une commande peut entraîner l’échec du moteur de reconnaissance vocale à compiler la grammaire pour toutes vos commandes.</span><span class="sxs-lookup"><span data-stu-id="6691e-137">Including non-pronounceable characters or symbols for one command may cause the speech engine to fail to compile the grammar for all your commands.</span></span> <span data-ttu-id="6691e-138">Enfin, rendez votre paramètre vocal aussi distinct que possible à partir d’autres commandes vocales que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="6691e-138">Finally, make your voice parameter as distinct as reasonably possible from other voice commands you define.</span></span> <span data-ttu-id="6691e-139">Plus la similarité entre la grammaire vocale pour les commandes est grande, plus le moteur de reconnaissance vocale est susceptible de générer une erreur de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="6691e-139">The greater the similarity between the voice grammar for commands, the more likely the speech engine will make a recognition error.</span></span> <span data-ttu-id="6691e-140">Vous pouvez également utiliser les scores de confiance pour mieux distinguer deux commandes qui peuvent avoir une grammaire vocale similaire ou similaire.</span><span class="sxs-lookup"><span data-stu-id="6691e-140">You can also use the confidence scores to better distinguish between two commands that may have similar or similar-sounding voice grammar.</span></span>

<span data-ttu-id="6691e-141">Vous pouvez inclure dans vos mots de grammaire sous la forme «*\\ prononciation du texte*», où « texte » est le texte affiché et « prononciation » un texte qui clarifie la prononciation.</span><span class="sxs-lookup"><span data-stu-id="6691e-141">You can include in your grammar words in the form of "*text\\pronunciation*", where "text" is the text displayed and "pronunciation" is text that clarifies the pronunciation.</span></span> <span data-ttu-id="6691e-142">Par exemple, la grammaire, « premier \\ prénom », est reconnue quand l’utilisateur dit « First », mais l’événement de [**commande**](/windows/desktop/lwef/the-command-object) retourne le texte « First \\ First ».</span><span class="sxs-lookup"><span data-stu-id="6691e-142">For example, the grammar, "1st\\first", would be recognized when the user says "first," but the [**Command**](/windows/desktop/lwef/the-command-object) event will return the text, "1st\\first".</span></span> <span data-ttu-id="6691e-143">Vous pouvez également utiliser la Loi sur l’alphabet phonétique international pour spécifier une prononciation en commençant par un signe dièse (« \# »), puis le texte représentant la prononciation de la Loi sur la Loi.</span><span class="sxs-lookup"><span data-stu-id="6691e-143">You can also use IPA (International Phonetic Alphabet) to specify a pronunciation by beginning the pronunciation with a pound-sign character ("\#"), then the text representing the IPA pronunciation.</span></span>

<span data-ttu-id="6691e-144">Pour les moteurs de reconnaissance vocale en japonais, vous pouvez définir la grammaire sous la forme «*Kana \\ kanji*», en réduisant les autres prononciations et en renforçant la précision.</span><span class="sxs-lookup"><span data-stu-id="6691e-144">For Japanese speech recognition engines, you can define grammar in the form "*kana\\kanji*," reducing the alternative pronunciations and increasing the accuracy.</span></span> <span data-ttu-id="6691e-145">(L’ordre est inversé pour des raisons de compatibilité descendante.) Ceci est particulièrement important pour la prononciation des noms corrects en kanji.</span><span class="sxs-lookup"><span data-stu-id="6691e-145">(The ordering is reversed for backward compatibility.) This is particularly important for the pronunciation of proper names in Kanji.</span></span> <span data-ttu-id="6691e-146">Toutefois, vous pouvez simplement transmettre « kanji », sans le kana, auquel cas le moteur doit écouter toutes les prononciations acceptables pour le kanji.</span><span class="sxs-lookup"><span data-stu-id="6691e-146">However, you can just pass in "kanji," without the Kana, in which case the engine should listen for all acceptable pronunciations for the Kanji.</span></span> <span data-ttu-id="6691e-147">Vous pouvez également passer en Kana uniquement.</span><span class="sxs-lookup"><span data-stu-id="6691e-147">You can also pass in just Kana.</span></span>

<span data-ttu-id="6691e-148">À l’exception des erreurs qui utilisent les caractères de mise en forme de regroupement ou de répétition, Microsoft Agent ne signale pas les erreurs dans votre grammaire, sauf si le moteur lui-même signale l’erreur.</span><span class="sxs-lookup"><span data-stu-id="6691e-148">Except for errors using the grouping or repetition formatting characters, Microsoft Agent will not report errors in your grammar, unless the engine itself reports the error.</span></span> <span data-ttu-id="6691e-149">Si vous transmettez au texte dans votre grammaire que le moteur ne parvient pas à se compiler, mais que le moteur ne gère pas et ne retourne pas d’erreur, l’agent ne peut pas signaler l’erreur.</span><span class="sxs-lookup"><span data-stu-id="6691e-149">If you pass text in your grammar that the engine fails to compile, but the engine does not handle and return as an error, Agent cannot report the error.</span></span> <span data-ttu-id="6691e-150">Par conséquent, l’application cliente doit faire attention à définir la grammaire de la propriété [**Voice**](voice-property.md) .</span><span class="sxs-lookup"><span data-stu-id="6691e-150">Therefore, the client application must be careful defining the grammar for the [**Voice**](voice-property.md) property.</span></span>

> [!Note]  
> <span data-ttu-id="6691e-151">Les fonctionnalités grammaticales disponibles peuvent dépendre du moteur de reconnaissance vocale.</span><span class="sxs-lookup"><span data-stu-id="6691e-151">The grammar features available may depend on the speech recognition engine.</span></span> <span data-ttu-id="6691e-152">Vous pouvez consulter le fournisseur du moteur pour déterminer les options grammaticales prises en charge.</span><span class="sxs-lookup"><span data-stu-id="6691e-152">You may want to check with the engine's vendor to determine what grammar options are supported.</span></span> <span data-ttu-id="6691e-153">Utilisez [**SRModeID**](srmodeid-property.md) pour utiliser un moteur spécifique.</span><span class="sxs-lookup"><span data-stu-id="6691e-153">Use the [**SRModeID**](srmodeid-property.md) to use a specific engine.</span></span>

 

<span data-ttu-id="6691e-154">Le fonctionnement de cette propriété dépend de l’état de la reconnaissance vocale du serveur Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="6691e-154">The operation of this property depends on the state of Microsoft Agent server's speech recognition state.</span></span> <span data-ttu-id="6691e-155">Par exemple, si la reconnaissance vocale est désactivée ou n’est pas installée, cette fonction n’a aucun effet immédiat.</span><span class="sxs-lookup"><span data-stu-id="6691e-155">For example, if speech recognition is disabled or not installed, this function has no immediate effect.</span></span> <span data-ttu-id="6691e-156">Toutefois, si la reconnaissance vocale est activée au cours d’une session, la commande devient accessible lorsque son application cliente est active.</span><span class="sxs-lookup"><span data-stu-id="6691e-156">If speech recognition is enabled during a session, however, the command will become accessible when its client application is input-active.</span></span>

## <a name="see-also"></a><span data-ttu-id="6691e-157">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6691e-157">See Also</span></span>

<span data-ttu-id="6691e-158">[**IAgentCommands :: GetVoice**](iagentcommands--getvoice.md), [**IAgentCommands :: SetCaption**](iagentcommands--setcaption.md), [**IAgentCommands :: setVisible**](iagentcommands--setvisible.md)</span><span class="sxs-lookup"><span data-stu-id="6691e-158">[**IAgentCommands::GetVoice**](iagentcommands--getvoice.md), [**IAgentCommands::SetCaption**](iagentcommands--setcaption.md), [**IAgentCommands::SetVisible**](iagentcommands--setvisible.md)</span></span>


 

 