---
title: Création de gestionnaires de colonnes
description: Le mode Détails de l’Explorateur Windows Windows affiche normalement plusieurs colonnes standard.
ms.assetid: 805e0e13-d09e-40f8-955b-c585f388e07e
keywords:
- gestionnaires de colonnes
- inscrire, gestionnaires de colonnes
- GetColumnInfo
- GetItemData
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 940796e75f29ba0fcfa025d9a56267e14bdff38f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104562757"
---
# <a name="creating-column-handlers"></a><span data-ttu-id="d3f85-107">Création de gestionnaires de colonnes</span><span class="sxs-lookup"><span data-stu-id="d3f85-107">Creating Column Handlers</span></span>

<span data-ttu-id="d3f85-108">\[Cette fonctionnalité est prise en charge uniquement sous Windows XP ou version antérieure.</span><span class="sxs-lookup"><span data-stu-id="d3f85-108">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="d3f85-109">\]</span><span class="sxs-lookup"><span data-stu-id="d3f85-109">\]</span></span>

<span data-ttu-id="d3f85-110">Le mode Détails de l’Explorateur Windows Windows affiche normalement plusieurs colonnes standard.</span><span class="sxs-lookup"><span data-stu-id="d3f85-110">The Details view in the Windows Windows Explorer normally displays several standard columns.</span></span> <span data-ttu-id="d3f85-111">Chaque colonne répertorie des informations, telles que la taille ou le type de fichier, pour chaque fichier dans le dossier actif.</span><span class="sxs-lookup"><span data-stu-id="d3f85-111">Each column lists information, such as the file size or type, for each file in the current folder.</span></span> <span data-ttu-id="d3f85-112">En implémentant et en inscrivant un gestionnaire de colonnes, vous pouvez rendre les colonnes personnalisées disponibles pour l’affichage.</span><span class="sxs-lookup"><span data-stu-id="d3f85-112">By implementing and registering a column handler, you can make custom columns available for display.</span></span>

<span data-ttu-id="d3f85-113">Les procédures générales d’implémentation et d’inscription d’un gestionnaire d’extensions de Shell sont décrites dans [création de gestionnaires d’extensions de Shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="d3f85-113">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="d3f85-114">Ce document se concentre sur les aspects de l’implémentation qui sont spécifiques aux gestionnaires de colonnes.</span><span class="sxs-lookup"><span data-stu-id="d3f85-114">This document focuses on those aspects of implementation that are specific to column handlers.</span></span>

<span data-ttu-id="d3f85-115">Les rubriques suivantes sont présentées.</span><span class="sxs-lookup"><span data-stu-id="d3f85-115">The following topics are discussed.</span></span>

-   [<span data-ttu-id="d3f85-116">Fonctionnement des gestionnaires de colonnes</span><span class="sxs-lookup"><span data-stu-id="d3f85-116">How Column Handlers Work</span></span>](#how-column-handlers-work)
-   [<span data-ttu-id="d3f85-117">Inscription des gestionnaires de colonnes</span><span class="sxs-lookup"><span data-stu-id="d3f85-117">Registering Column Handlers</span></span>](#registering-column-handlers)
-   [<span data-ttu-id="d3f85-118">Implémentation de gestionnaires de colonnes</span><span class="sxs-lookup"><span data-stu-id="d3f85-118">Implementing Column Handlers</span></span>](#implementing-column-handlers)
    -   [<span data-ttu-id="d3f85-119">La méthode Initialize</span><span class="sxs-lookup"><span data-stu-id="d3f85-119">The Initialize Method</span></span>](#the-initialize-method)
    -   [<span data-ttu-id="d3f85-120">La méthode GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="d3f85-120">The GetColumnInfo Method</span></span>](#the-getcolumninfo-method)
    -   [<span data-ttu-id="d3f85-121">Méthode GetItemData</span><span class="sxs-lookup"><span data-stu-id="d3f85-121">The GetItemData Method</span></span>](#the-getitemdata-method)

## <a name="how-column-handlers-work"></a><span data-ttu-id="d3f85-122">Fonctionnement des gestionnaires de colonnes</span><span class="sxs-lookup"><span data-stu-id="d3f85-122">How Column Handlers Work</span></span>

<span data-ttu-id="d3f85-123">L’illustration suivante montre l’Explorateur Windows en mode Détails.</span><span class="sxs-lookup"><span data-stu-id="d3f85-123">The following illustration shows Windows Explorer in Details view.</span></span>

![capture d’écran de l’Explorateur Windows en mode Détails](images/columnproviderhandler1.jpg)

<span data-ttu-id="d3f85-125">Avec Windows 2000, le dossier peut également prendre en charge un certain nombre de colonnes qui, par défaut, ne sont pas affichées.</span><span class="sxs-lookup"><span data-stu-id="d3f85-125">With Windows 2000, the folder can also support a number of columns that, by default, are not displayed.</span></span> <span data-ttu-id="d3f85-126">L’utilisateur peut afficher des colonnes supplémentaires en cliquant avec le bouton droit sur l’un des en-têtes de colonne et en sélectionnant la commande **plus...** dans le menu.</span><span class="sxs-lookup"><span data-stu-id="d3f85-126">The user can display additional columns by right-clicking one of the column headers and selecting the **More...** command from the menu.</span></span> <span data-ttu-id="d3f85-127">Une boîte de dialogue s’affiche, qui répertorie les colonnes disponibles pour le dossier et permet à l’utilisateur de sélectionner les colonnes à afficher.</span><span class="sxs-lookup"><span data-stu-id="d3f85-127">A dialog box then appears that lists the available columns for the folder and allows the user to select which columns to display.</span></span> <span data-ttu-id="d3f85-128">L’illustration suivante montre cette boîte de dialogue pour l’exemple précédent.</span><span class="sxs-lookup"><span data-stu-id="d3f85-128">The following illustration shows this dialog box for the preceding example.</span></span>

![capture d’écran de l’Explorateur Windows avec la boîte de dialogue Choisir les détails affichée](images/columnproviderhandler2.jpg)

<span data-ttu-id="d3f85-130">En créant un gestionnaire de colonnes, vous pouvez créer des colonnes personnalisées et les ajouter à cette liste.</span><span class="sxs-lookup"><span data-stu-id="d3f85-130">By creating a column handler, you can create custom columns and add them to that list.</span></span> <span data-ttu-id="d3f85-131">Par exemple, une collection de fichiers qui contiennent de la musique peut utiliser un gestionnaire de colonnes pour afficher les colonnes qui répertorient l’artiste et la pièce contenues dans chaque fichier.</span><span class="sxs-lookup"><span data-stu-id="d3f85-131">For example, a collection of files that contain music could use a column handler to display columns listing the artist and piece contained by each file.</span></span>

<span data-ttu-id="d3f85-132">Un gestionnaire de colonnes est un objet global qui est appelé chaque fois que l’Explorateur Windows affiche le mode Détails.</span><span class="sxs-lookup"><span data-stu-id="d3f85-132">A column handler is a global object that is called every time Windows Explorer displays the Details view.</span></span> <span data-ttu-id="d3f85-133">Toutefois, les gestionnaires de colonnes sont généralement utilisés pour afficher des colonnes personnalisées uniquement pour les membres d’un [type de fichier](/windows/desktop/shell/fa-file-types)particulier.</span><span class="sxs-lookup"><span data-stu-id="d3f85-133">However, column handlers are typically used to display custom columns only for members of a particular [file type](/windows/desktop/shell/fa-file-types).</span></span> <span data-ttu-id="d3f85-134">Avant d’afficher le mode Détails, l’Explorateur Windows interroge tous les gestionnaires de colonne inscrits sur leurs caractéristiques de colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-134">Before it displays the Details view, Windows Explorer queries all registered column handlers for their column characteristics.</span></span> <span data-ttu-id="d3f85-135">Si l’utilisateur a sélectionné l’une des colonnes du gestionnaire, l’Explorateur Windows interroge le gestionnaire pour obtenir les données associées.</span><span class="sxs-lookup"><span data-stu-id="d3f85-135">If the user has selected one of the handler's columns, Windows Explorer queries the handler for the associated data.</span></span> <span data-ttu-id="d3f85-136">Lorsqu’un gestionnaire de colonnes reçoit une demande de données, il le fournit si le fichier est membre de son type pris en charge.</span><span class="sxs-lookup"><span data-stu-id="d3f85-136">When a column handler receives a request for data, it provides it if the file is a member of its supported type.</span></span> <span data-ttu-id="d3f85-137">Sinon, elle ignore la demande en renvoyant S \_ false.</span><span class="sxs-lookup"><span data-stu-id="d3f85-137">Otherwise, it ignores the request by returning S\_FALSE.</span></span>

## <a name="registering-column-handlers"></a><span data-ttu-id="d3f85-138">Inscription des gestionnaires de colonnes</span><span class="sxs-lookup"><span data-stu-id="d3f85-138">Registering Column Handlers</span></span>

<span data-ttu-id="d3f85-139">Les gestionnaires de colonnes sont inscrits sous la sous-clé suivante.</span><span class="sxs-lookup"><span data-stu-id="d3f85-139">Column handlers are registered under the following subkey.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
```

<span data-ttu-id="d3f85-140">Créez une sous-clé de **ColumnHandlers** nommée avec la forme de chaîne du GUID de l’identificateur de classe (CLSID) du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="d3f85-140">Create a subkey of **ColumnHandlers** named with the string form of the handler's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="d3f85-141">Pour obtenir une présentation générale de l’inscription des gestionnaires d’extensions de Shell, consultez [création de gestionnaires d’extensions de Shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="d3f85-141">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="d3f85-142">L’exemple suivant montre comment enregistrer un gestionnaire de colonnes.</span><span class="sxs-lookup"><span data-stu-id="d3f85-142">The following example illustrates how to register a column handler.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
            {My Column Handler CLSID GUID}
```

## <a name="implementing-column-handlers"></a><span data-ttu-id="d3f85-143">Implémentation de gestionnaires de colonnes</span><span class="sxs-lookup"><span data-stu-id="d3f85-143">Implementing Column Handlers</span></span>

<span data-ttu-id="d3f85-144">Comme tous les gestionnaires d’extensions de Shell, les gestionnaires de colonnes sont des objets COM (Component Object Model) in-process implémentés en tant que dll.</span><span class="sxs-lookup"><span data-stu-id="d3f85-144">Like all Shell extension handlers, column handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="d3f85-145">Ils exportent l’interface [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) en plus de [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="d3f85-145">They export the [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) interface in addition to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span>

<span data-ttu-id="d3f85-146">L’Explorateur Windows appelle les trois méthodes exportées par [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) pour demander les informations dont il a besoin pour afficher la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-146">Windows Explorer calls the three methods exported by [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) to request the information it needs to display the column.</span></span> <span data-ttu-id="d3f85-147">La procédure utilisée par l’Explorateur Windows est la suivante :</span><span class="sxs-lookup"><span data-stu-id="d3f85-147">The procedure used by Windows Explorer is:</span></span>

1.  <span data-ttu-id="d3f85-148">Appelez [**IColumnProvider :: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) pour spécifier le dossier qui va être affiché.</span><span class="sxs-lookup"><span data-stu-id="d3f85-148">Call [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to specify the folder that is about to be displayed.</span></span>
2.  <span data-ttu-id="d3f85-149">Appelez [**IColumnProvider :: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) pour récupérer l’identificateur et les caractéristiques de la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-149">Call [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to retrieve the column's identifier and characteristics.</span></span>
3.  <span data-ttu-id="d3f85-150">Si la colonne a été sélectionnée par l’utilisateur, appelez [**IColumnProvider :: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) pour chaque fichier du dossier afin de récupérer les données qui appartiennent à l’entrée de colonne du fichier.</span><span class="sxs-lookup"><span data-stu-id="d3f85-150">If the column has been selected by the user, call [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder to retrieve the data that belongs in the file's column entry.</span></span>

### <a name="the-initialize-method"></a><span data-ttu-id="d3f85-151">La méthode Initialize</span><span class="sxs-lookup"><span data-stu-id="d3f85-151">The Initialize Method</span></span>

<span data-ttu-id="d3f85-152">L’Explorateur Windows appelle [**IColumnProvider :: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) pour initialiser le gestionnaire de colonnes.</span><span class="sxs-lookup"><span data-stu-id="d3f85-152">Windows Explorer calls [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to initialize the column handler.</span></span> <span data-ttu-id="d3f85-153">La méthode a trois paramètres, mais seul *wszFolder* est actuellement utilisé.</span><span class="sxs-lookup"><span data-stu-id="d3f85-153">The method has three parameters, but only *wszFolder* is currently used.</span></span> <span data-ttu-id="d3f85-154">Elle est définie sur le dossier dont l’affichage Détails va être affiché.</span><span class="sxs-lookup"><span data-stu-id="d3f85-154">It is set to the folder whose Details view is about to be displayed.</span></span> <span data-ttu-id="d3f85-155">Stockez le nom du dossier pour une utilisation ultérieure et initialisez l’objet gestionnaire en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="d3f85-155">Store the folder name for later use and initialize the handler object as needed.</span></span>

### <a name="the-getcolumninfo-method"></a><span data-ttu-id="d3f85-156">La méthode GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="d3f85-156">The GetColumnInfo Method</span></span>

<span data-ttu-id="d3f85-157">L’Explorateur Windows appelle ensuite [**IColumnProvider :: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) pour demander l’identificateur et les caractéristiques de la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-157">Windows Explorer next calls [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to request the column's identifier and characteristics.</span></span> <span data-ttu-id="d3f85-158">Elle transmet un index pour la colonne dans le paramètre *dwIndex* .</span><span class="sxs-lookup"><span data-stu-id="d3f85-158">It passes in an index for the column in the *dwIndex* parameter.</span></span> <span data-ttu-id="d3f85-159">Cet index est une valeur arbitraire utilisée pour énumérer les colonnes.</span><span class="sxs-lookup"><span data-stu-id="d3f85-159">This index is an arbitrary value that is used to enumerate columns.</span></span> <span data-ttu-id="d3f85-160">L’Explorateur Windows passe également un pointeur vers une structure [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) .</span><span class="sxs-lookup"><span data-stu-id="d3f85-160">Windows Explorer also passes in a pointer to an [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure.</span></span> <span data-ttu-id="d3f85-161">Cette structure est utilisée pour retourner l’identificateur et les caractéristiques de la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-161">This structure is used to return the column's identifier and characteristics.</span></span> <span data-ttu-id="d3f85-162">**IColumnProvider :: GetColumnInfo** doit assigner des valeurs appropriées aux membres de la structure et retourner.</span><span class="sxs-lookup"><span data-stu-id="d3f85-162">**IColumnProvider::GetColumnInfo** should assign appropriate values to the members of the structure and return.</span></span>

<span data-ttu-id="d3f85-163">Les colonnes sont identifiées par leur ID de jeu de propriétés OLE (FMTID) et par un ID de propriété associé (PID).</span><span class="sxs-lookup"><span data-stu-id="d3f85-163">Columns are identified by their OLE property set ID (FMTID) and an associated property ID (PID).</span></span> <span data-ttu-id="d3f85-164">Le premier membre de la structure [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) , **scid**, est un pointeur vers une structure [**SHCOLUMNID**](/windows/desktop/shell/objects) qui est utilisée pour identifier la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-164">The first member of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure, **scid**, is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that is used to identify the column.</span></span> <span data-ttu-id="d3f85-165">Son membre **fmtid** contient le fmtid de la colonne, et son membre **PID** contient le PID de la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-165">Its **fmtid** member holds the column's FMTID, and its **pid** member holds the column's PID.</span></span> <span data-ttu-id="d3f85-166">Par exemple, une paire FMTID/PID standard qui est couramment utilisée pour identifier les colonnes est le PID de l’auteur de la propriété des informations de résumé définie.</span><span class="sxs-lookup"><span data-stu-id="d3f85-166">For example, a standard FMTID/PID pair that is commonly used to identify columns is the Author PID of the Summary Information property set.</span></span>

<span data-ttu-id="d3f85-167">Si possible, votre gestionnaire doit utiliser des FMTIDs et des PID existants pour identifier la colonne qu’il prend en charge.</span><span class="sxs-lookup"><span data-stu-id="d3f85-167">If possible, your handler should use existing FMTIDs and PIDs to identify the column it supports.</span></span> <span data-ttu-id="d3f85-168">Si vous utilisez une structure [**SHCOLUMNID**](/windows/desktop/shell/objects) personnalisée, la colonne affiche des données uniquement pour les fichiers qui sont pris en charge par le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="d3f85-168">If you use a custom [**SHCOLUMNID**](/windows/desktop/shell/objects) structure, the column will display data only for those files that are supported by the handler.</span></span> <span data-ttu-id="d3f85-169">Si le dossier contient d’autres fichiers, leurs entrées sont vides.</span><span class="sxs-lookup"><span data-stu-id="d3f85-169">If the folder contains other files, their entries will be blank.</span></span> <span data-ttu-id="d3f85-170">Si un dossier contient des fichiers issus de plusieurs types de fichiers, l’utilisation de valeurs FMTID/PID standard peut permettre de fusionner les données de différents types dans la même colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-170">If a folder contains files from more than one file type, using standard FMTID/PID values could make it possible to merge data from different types into the same column.</span></span>

<span data-ttu-id="d3f85-171">Définissez le membre **VT** sur le [](/windows/win32/api/oaidl/ns-oaidl-variant)   type Variant des données que vous souhaitez afficher dans la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-171">Set the **vt** member to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) type of the data you want to display in the column.</span></span> <span data-ttu-id="d3f85-172">Le type le plus couramment utilisé est VT \_ LPSTR, car la plupart des colonnes affichent leurs données sous forme de chaînes de caractères.</span><span class="sxs-lookup"><span data-stu-id="d3f85-172">The most commonly used type is VT\_LPSTR, as most columns display their data as character strings.</span></span> <span data-ttu-id="d3f85-173">Les membres restants de la structure [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) sont utilisés pour définir les caractéristiques de la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-173">The remaining members of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure are used to define the characteristics of the column.</span></span> <span data-ttu-id="d3f85-174">Affectez les valeurs appropriées.</span><span class="sxs-lookup"><span data-stu-id="d3f85-174">Assign values as appropriate.</span></span>

### <a name="the-getitemdata-method"></a><span data-ttu-id="d3f85-175">Méthode GetItemData</span><span class="sxs-lookup"><span data-stu-id="d3f85-175">The GetItemData Method</span></span>

<span data-ttu-id="d3f85-176">Si la colonne du gestionnaire de colonnes a été sélectionnée, l’Explorateur Windows appelle [**IColumnProvider :: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) pour chaque fichier du dossier à afficher.</span><span class="sxs-lookup"><span data-stu-id="d3f85-176">If the column handler's column has been selected, Windows Explorer calls [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder that is to be displayed.</span></span> <span data-ttu-id="d3f85-177">Le paramètre *pscid* est un pointeur vers une structure [**SHCOLUMNID**](/windows/desktop/shell/objects) qui identifie la colonne.</span><span class="sxs-lookup"><span data-stu-id="d3f85-177">The *pscid* parameter is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that identifies the column.</span></span> <span data-ttu-id="d3f85-178">Le paramètre *PSCD* pointe vers une structure [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) qui identifie le fichier particulier.</span><span class="sxs-lookup"><span data-stu-id="d3f85-178">The *pscd* parameter points to an [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) structure that identifies the particular file.</span></span>

<span data-ttu-id="d3f85-179">Le paramètre *pvarData* retourne les données qui doivent s’afficher dans la colonne du gestionnaire pour le fichier spécifié par *PSCD*.</span><span class="sxs-lookup"><span data-stu-id="d3f85-179">The *pvarData* parameter returns the data that should be displayed in the handler's column for the file specified by *pscd*.</span></span> <span data-ttu-id="d3f85-180">Si ce fichier est pris en charge par votre gestionnaire de colonnes, affectez sa valeur de données à *pvarData* et renvoyez \_ OK.</span><span class="sxs-lookup"><span data-stu-id="d3f85-180">If that file is supported by your column handler, assign its data value to *pvarData* and return S\_OK.</span></span> <span data-ttu-id="d3f85-181">Si le fichier n’est pas pris en charge par votre gestionnaire de colonnes, retourne \_ la valeur false sans assigner de valeur à *pvarData*.</span><span class="sxs-lookup"><span data-stu-id="d3f85-181">If the file is not supported by your column handler, return S\_FALSE without assigning a value to *pvarData*.</span></span>

<span data-ttu-id="d3f85-182">De nombreux dossiers contiennent un certain nombre de fichiers qui ne sont pas pris en charge par un gestionnaire de colonnes particulier.</span><span class="sxs-lookup"><span data-stu-id="d3f85-182">Many folders will contain a number of files that are not supported by any particular column handler.</span></span> <span data-ttu-id="d3f85-183">Pour améliorer l’efficacité, [**IColumnProvider :: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) doit d’abord vérifier le membre **pwszExt** de la structure vers laquelle pointe *PSCD*.</span><span class="sxs-lookup"><span data-stu-id="d3f85-183">To improve efficiency, [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) should first check the **pwszExt** member of the structure pointed to by *pscd*.</span></span> <span data-ttu-id="d3f85-184">Ce membre contient l’extension de nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="d3f85-184">This member holds the file name extension.</span></span> <span data-ttu-id="d3f85-185">Si l’extension indique que le fichier n’est pas membre d’un type de fichier pris en charge par votre gestionnaire, évitez tout traitement inutile en renvoyant immédiatement S \_ false.</span><span class="sxs-lookup"><span data-stu-id="d3f85-185">If the extension indicates that the file is not a member of a file type supported by your handler, avoid unnecessary processing by immediately returning S\_FALSE.</span></span>

 

 