---
title: Événement RequestComplete
description: Événement RequestComplete
ms.assetid: 543b79d1-f09d-4061-a1a8-8c8ab496bceb
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 551aecdcfbeab76ab45e6211affef794ff37d876
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104463139"
---
# <a name="requestcomplete-event"></a><span data-ttu-id="d10af-103">Événement RequestComplete</span><span class="sxs-lookup"><span data-stu-id="d10af-103">RequestComplete Event</span></span>

<span data-ttu-id="d10af-104">\[Microsoft Agent est déconseillé à partir de Windows 7 et peut ne pas être disponible dans les versions ultérieures de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="d10af-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<dl> <dt>

<span data-ttu-id="d10af-105"><span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**Descriptive**</span><span class="sxs-lookup"><span data-stu-id="d10af-105"><span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**Description**</span></span>
</dt> <dd>

<span data-ttu-id="d10af-106">Se produit lorsque le serveur termine une demande en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="d10af-106">Occurs when the server completes a queued request.</span></span>

</dd> <dt>

<span data-ttu-id="d10af-107"><span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Stockéesyntaxe**</span><span class="sxs-lookup"><span data-stu-id="d10af-107"><span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Syntax**</span></span>
</dt> <dd>

<span data-ttu-id="d10af-108">**Sous** - *agent \* \* \* \_ RequestComplete* \*  **(** *demande ByVal \* \* *)**</span><span class="sxs-lookup"><span data-stu-id="d10af-108">**Sub** *agent\*\*\*\_RequestComplete*\* **(ByVal** *Request\*\*\*)*\*</span></span>



| <span data-ttu-id="d10af-109">Partie</span><span class="sxs-lookup"><span data-stu-id="d10af-109">Part</span></span>      | <span data-ttu-id="d10af-110">Description</span><span class="sxs-lookup"><span data-stu-id="d10af-110">Description</span></span>                                            |
|-----------|--------------------------------------------------------|
| <span data-ttu-id="d10af-111">*Requête*</span><span class="sxs-lookup"><span data-stu-id="d10af-111">*Request*</span></span> | <span data-ttu-id="d10af-112">Retourne l’objet de [**requête**](/windows/desktop/lwef/the-request-object) .</span><span class="sxs-lookup"><span data-stu-id="d10af-112">Returns the [**Request**](/windows/desktop/lwef/the-request-object) object.</span></span> |



 

</dd> </dl>

### <a name="remarks"></a><span data-ttu-id="d10af-113">Notes</span><span class="sxs-lookup"><span data-stu-id="d10af-113">Remarks</span></span>

<span data-ttu-id="d10af-114">Cet événement retourne un objet de [**requête**](/windows/desktop/lwef/the-request-object) .</span><span class="sxs-lookup"><span data-stu-id="d10af-114">This event returns a [**Request**](/windows/desktop/lwef/the-request-object) object.</span></span> <span data-ttu-id="d10af-115">Étant donné que les demandes sont traitées de façon asynchrone, vous pouvez utiliser cet événement pour déterminer à quel moment le serveur a terminé le traitement d’une requête (par exemple, une méthode d' [**extraction**](get-method.md), de [**lecture**](play-method.md)ou de [**parole**](speak-method.md) ) pour synchroniser cet événement avec d’autres actions générées par votre application.</span><span class="sxs-lookup"><span data-stu-id="d10af-115">Because requests are processed asynchronously, you can use this event to determine when the server completes processing a request (such as a [**Get**](get-method.md), [**Play**](play-method.md), or [**Speak**](speak-method.md) method) to synchronize this event with other actions generated by your application.</span></span> <span data-ttu-id="d10af-116">Le serveur envoie l’événement uniquement au client qui a créé la référence à l’objet de **requête** et uniquement si vous avez défini une variable globale pour la référence à la demande :</span><span class="sxs-lookup"><span data-stu-id="d10af-116">The server sends the event only to the client that created the reference to the **Request** object and only if you defined a global variable for the request reference:</span></span>


```
   Dim MyRequest 
   Dim Genie 

   Sub window_Onload
   
   Agent1.Characters.Load "Genie","https://agent.microsoft.com/characters/v2/genie/genie.acf"

   Set Genie = Agent.Characters("Genie")

   ' This syntax will generate RequestStart and RequestComplete events.
   Set MyRequest = Genie.Get("state", "Showing")
   ' This syntax will not generate RequestStart and RequestComplete events.
   Genie.Get "state", "Hiding"
   
   End Sub

   Sub Agent1_RequestComplete(ByVal Request)

   If Request = MyRequest Then
      Status = "Showing animation is now loaded"

   End Sub
```



<span data-ttu-id="d10af-117">Étant donné que les objets de [**requête**](/windows/desktop/lwef/the-request-object) d’animation ne sont pas assignés tant que le serveur n’a pas traité la demande, assurez-vous que l’objet de **requête** existe avant d’essayer de l’évaluer.</span><span class="sxs-lookup"><span data-stu-id="d10af-117">Because animation [**Request**](/windows/desktop/lwef/the-request-object) objects don't get assigned until the server processes the request, make sure that the **Request** object exists before you attempt to evaluate it.</span></span> <span data-ttu-id="d10af-118">Par exemple, dans Visual Basic, si vous utilisez un conditionnel pour tester si une requête spécifique a été effectuée, vous pouvez utiliser le mot clé **Nothing** :</span><span class="sxs-lookup"><span data-stu-id="d10af-118">For example, in Visual Basic, if you use a conditional to test whether a specific request was completed, you can use the **Nothing** keyword:</span></span>


```
   Sub Agent1_RequestComplete (ByVal Request)

   If Not (MyRequest Is Nothing) Then
      If Request = MyRequest Then
      '-- Do whatever
      End If
   End If

   End Sub
```



> [!Note]  
> <span data-ttu-id="d10af-119">Dans VBScript 1,0, cet événement se déclenche même si vous ne définissez pas de références à un objet de [**requête**](/windows/desktop/lwef/the-request-object) .</span><span class="sxs-lookup"><span data-stu-id="d10af-119">In VBScript 1.0, this event fires even if you don't define references to a [**Request**](/windows/desktop/lwef/the-request-object) object.</span></span> <span data-ttu-id="d10af-120">Ce problème a été résolu dans VBScript 2,0, qui peut être téléchargé à partir de <https://microsoft.com/msdownload/vbscript/scripting.asp> .</span><span class="sxs-lookup"><span data-stu-id="d10af-120">This has been fixed in VBScript 2.0, which can be downloaded from <https://microsoft.com/msdownload/vbscript/scripting.asp>.</span></span>

 

### <a name="see-also"></a><span data-ttu-id="d10af-121">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d10af-121">See Also</span></span>

[<span data-ttu-id="d10af-122">**Événement RequestStart**</span><span class="sxs-lookup"><span data-stu-id="d10af-122">**RequestStart event**</span></span>](requeststart-event.md)


 

 