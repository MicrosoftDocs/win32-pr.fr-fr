---
title: ISRResGraphEx et IAttributes
description: ISRResGraphEx et IAttributes
ms.assetid: 6eb37da1-5252-4c41-891c-c19cca6fb7d1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 659d7d4723bfc5145fb8abcc77043031a0e48e8b
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104031068"
---
# <a name="isrresgraphex-and-iattributes"></a><span data-ttu-id="df4b7-103">ISRResGraphEx et IAttributes</span><span class="sxs-lookup"><span data-stu-id="df4b7-103">ISRResGraphEx and IAttributes</span></span>

<span data-ttu-id="df4b7-104">\[Microsoft Agent est déconseillé à partir de Windows 7 et peut ne pas être disponible dans les versions ultérieures de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="df4b7-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="df4b7-105">Les objets de résultats retournés par le moteur doivent prendre en charge l’interface ISRResGraphEx et l’interface IAttributes.</span><span class="sxs-lookup"><span data-stu-id="df4b7-105">The results objects returned by the engine must support the ISRResGraphEx interface and the IAttributes interface.</span></span> <span data-ttu-id="df4b7-106">Il suffit de prendre en charge l’interface ISRResGraphEx pour permettre à l’éditeur de sons de fournir des informations sur les césures de mots, mais ne fournit pas la prise en charge nécessaire pour les informations de phonème.</span><span class="sxs-lookup"><span data-stu-id="df4b7-106">Merely supporting the ISRResGraphEx interface is enough to enable the sound editor to provide word break information, but does not provide the necessary support for phoneme information.</span></span>

<span data-ttu-id="df4b7-107">L’éditeur Sound requiert que les moteurs prennent également en charge un attribut DWord spécial, **SRATTR \_ PHONESEG**.</span><span class="sxs-lookup"><span data-stu-id="df4b7-107">The sound editor requires that engines also support a special DWord attribute, **SRATTR\_PHONESEG**.</span></span> <span data-ttu-id="df4b7-108">L’éditeur interroge les moteurs pour voir l’interface IAttributes et tente de définir **le \_ PHONESEG SRATTR** sur 1.</span><span class="sxs-lookup"><span data-stu-id="df4b7-108">The editor queries the engines to see IAttributes interface and attempts to set the **SRATTR\_PHONESEG** to 1.</span></span> <span data-ttu-id="df4b7-109">Si cet appel aboutit, l’éditeur de sons suppose que les résultats du moteur prennent en charge la collecte des informations de segmentation de phonème à partir de l’objet de résultats.</span><span class="sxs-lookup"><span data-stu-id="df4b7-109">If that call succeeds, the sound editor assumes that the engine's results will support the gathering of phoneme-segmentation information from results object.</span></span>

`#define    SRATTR_PHONESEG    MAKELONG (1, SRVEN_MICROSOFT)`

<span data-ttu-id="df4b7-110">Lorsqu’un objet de résultats est transmis à l’éditeur Sound, il interroge cet objet pour son implémentation de ISRResGraphEx.</span><span class="sxs-lookup"><span data-stu-id="df4b7-110">When a results object is transmitted to the sound editor, it queries that object for its implementation of ISRResGraphEx.</span></span> <span data-ttu-id="df4b7-111">ISRResGraphEx contient une fonction membre, DataGet, avec une signature de type</span><span class="sxs-lookup"><span data-stu-id="df4b7-111">ISRResGraphEx contains a member function, DataGet, with type signature</span></span>

`HRESULT  DataGet  (DWord, dwID, GUID gAttrib, SDATA *psData)`

<span data-ttu-id="df4b7-112">Où **dwId** est l’identificateur de l’objet Graph, **GATTRIB** est un GUID correspondant à l’attribut recherché, et **psData** est un pointeur vers un objet SDATA contenant les données retournées.</span><span class="sxs-lookup"><span data-stu-id="df4b7-112">Where **dwID** is the identifier of the graph object, **gAttrib** is a GUID corresponding to the attribute sought, and **psData** is a pointer to an SDATA object containing the data returned.</span></span> <span data-ttu-id="df4b7-113">Le moteur est chargé d’allouer les données stockées dans **psData** à [**CoTaskMemAlloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc).</span><span class="sxs-lookup"><span data-stu-id="df4b7-113">The engine is responsible for allocating the data stored in **psData** through [**CoTaskMemAlloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc).</span></span> <span data-ttu-id="df4b7-114">L’application appelante (dans le cas présent, l’éditeur Sound) est chargée de la libérer via [**CoTaskMemFree**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree) quand elle est terminée.</span><span class="sxs-lookup"><span data-stu-id="df4b7-114">The calling application (in this case the sound editor) is responsible for freeing it through [**CoTaskMemFree**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree) when it is finished.</span></span>

<span data-ttu-id="df4b7-115">DataGet est requis pour reconnaître trois GUID prédéfinis, qui sont répertoriés dans la documentation SAPI.</span><span class="sxs-lookup"><span data-stu-id="df4b7-115">DataGet is required to recognize three predefined GUIDs, which are listed in the SAPI documentation.</span></span> <span data-ttu-id="df4b7-116">Un moteur qui retourne un code de réussite à l’appel à **DWORDSet (SRATTR \_ PHONESEG, 1)** est également requis pour reconnaître un GUID spécifique, **SRGARC \_ PHONEMESEGMENTATION**, lorsqu’il est appelé avec un **dwId** qui correspond à un bord dans le graphique.</span><span class="sxs-lookup"><span data-stu-id="df4b7-116">An engine which returns a success code to the call to **DWORDSet(SRATTR\_PHONESEG, 1)** is also required to recognize a specific GUID, **SRGARC\_PHONEMESEGMENTATION**, when called with a **dwID** that corresponds to an edge in the graph.</span></span>

`DEFINE_GUID(SRGARC_PHONMESEGMENTATION, 0xd05405b0, 0x1db1, 0x11d2, 0x94, 0x2, 0x0, 0xc0, 0x4f, 0x8e, 0xf4, 0x8f);`

<span data-ttu-id="df4b7-117">Lorsque l’appel est retourné, **psData** doit pointer vers un tableau de structures alignées sur la valeur DWORD de type **PHONESEG**, défini par :</span><span class="sxs-lookup"><span data-stu-id="df4b7-117">When the call returns, **psData** should point to an array of DWORD-aligned structure of type **PHONESEG**, defined by:</span></span>

``` syntax
typedef struct tagSRPHONESEG {
   DWORD   dwSize;       // Size of the SRPHONESEG structure + phone data
   QWORD   qwStartTime;  // SAPI timestamp of the start of the seqment
   …QWORD   qwEndTime;    // SAPI timestamp of the end of the seqment
   int      nScore;      // The segment's score
   WCHAR   aPhones[0];   // Array of phone(s) making up the segment
} SRPHONESEG,  *PSRPHONESEG;
```

<span data-ttu-id="df4b7-118">où **qwStartTime** et **qwEndTime** pointent vers le début et la fin de chaque phonème qui compose le mot couvert par l’arête, et **aPhones** est un tableau de caractères Unicode correspondant à la représentation de la Loi sur la loi du téléphone, qui ont été produits dans ce segment.</span><span class="sxs-lookup"><span data-stu-id="df4b7-118">where **qwStartTime** and **qwEndTime** point to the beginning and end of each phoneme making up the word covered by the edge, and **aPhones** is an array of Unicode characters corresponding to the IPA representation of the phone, which were produced in this segment.</span></span> <span data-ttu-id="df4b7-119">(Dans certains langages, il existe des phonèmes avec plus d’un phonème de la Loi sur la Loi.</span><span class="sxs-lookup"><span data-stu-id="df4b7-119">(In some languages, there are phonemes which are spelled with more than one IPA phoneme.</span></span> <span data-ttu-id="df4b7-120">En anglais, par exemple, le son « long I » dans le mot « Live » est en fait un diphthong, composé de deux phonèmes plus simples concaténés.) Le tableau **aPhones** doit être terminé par zéro et complété à la fin pour que chaque structure **SRPHONESEG** du tableau soit un multiple de 4 octets de long.</span><span class="sxs-lookup"><span data-stu-id="df4b7-120">In English, for instance, the "long I" sound in the word "live" is actually a diphthong, made up of two simpler phonemes concatenated together.) The **aPhones** array should be zero terminated and padded at the end to make each **SRPHONESEG** structure in the array an even multiple of four bytes long.</span></span>

<span data-ttu-id="df4b7-121">Par exemple, supposons que le mot parlé sur l’arc 4 soit « effectué ».</span><span class="sxs-lookup"><span data-stu-id="df4b7-121">For example, suppose the word spoken on arc 4 was "made".</span></span> <span data-ttu-id="df4b7-122">Ensuite, l’appel à DataGet (4, **SRGARC \_ PHONEMESEGMENTATION**, &SD) peut retourner un tableau de trois segments de phonème,/m/exécuté à partir de **qwStartTime**= 328434 octets à **qwEndTime**= 330354 octets,/1e/s’exécutant à partir de **qwStartTime**= 330354 octets à **QwEndTime**= 344114 octets, et/d/à partir de **qwStartTime**= 344114 octets vers **qwEndTime**= 347314 octets.</span><span class="sxs-lookup"><span data-stu-id="df4b7-122">Then the call to DataGet(4, **SRGARC\_PHONEMESEGMENTATION**, &sd) might return an array of three phoneme segments, /m/ running from **qwStartTime**=328434 bytes to **qwEndTime**=330354 bytes, /1e/ running from **qwStartTime**=330354 bytes to **qwEndTime**=344114 bytes, and /d/ running from **qwStartTime**=344114 bytes to **qwEndTime**=347314 bytes.</span></span> <span data-ttu-id="df4b7-123">Ils sont présentés sous la forme d’un tableau condensé de trois structures **SRPHONESEG** de tailles 28, 32 et 28 octets, respectivement.</span><span class="sxs-lookup"><span data-stu-id="df4b7-123">These would be presented as a packed array of three **SRPHONESEG** structures of sizes 28, 32, and 28 bytes, respectively.</span></span> <span data-ttu-id="df4b7-124">Notez qu’il existe un remplissage à la fin de la structure **SRPHONESEG** du milieu, afin que l’élément suivant du tableau commence à une limite de 4 octets.</span><span class="sxs-lookup"><span data-stu-id="df4b7-124">Notice that there is some padding at the end of the middle **SRPHONESEG** structure, so that the next item in the array starts at a 4-byte boundary.</span></span>

<span data-ttu-id="df4b7-125">Le kit de développement logiciel (SDK) SAPI 4,0 intègre un outil (SRFunc) pour tester la conformité avec la spécification SAPI 4,0. Un test de compatibilité avec cet ensemble d’interfaces est inclus dans cet outil.</span><span class="sxs-lookup"><span data-stu-id="df4b7-125">The SAPI 4.0 SDK includes a tool (SRFunc) for testing compliance with the SAPI 4.0 spec. Included in that tool is a test for compliance with this set of interfaces.</span></span> <span data-ttu-id="df4b7-126">Le code source de cet outil est un bon point de départ pour comprendre comment ces interfaces interagissent avec l’éditeur de sons et pour déboguer les interfaces pendant le développement.</span><span class="sxs-lookup"><span data-stu-id="df4b7-126">The source code for that tool is a good place to start in order to understand how these interfaces will interact with the sound editor, and to debug the interfaces during development.</span></span>

 

 