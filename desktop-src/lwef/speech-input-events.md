---
title: Événements d’entrée vocale
description: Événements d’entrée vocale
ms.assetid: d7b621fe-9274-4b16-af8a-664b0b296c89
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0dc75bb010286b7645c206d192913017472829d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104029880"
---
# <a name="speech-input-events"></a><span data-ttu-id="8877f-103">Événements d’entrée vocale</span><span class="sxs-lookup"><span data-stu-id="8877f-103">Speech Input Events</span></span>

<span data-ttu-id="8877f-104">\[Microsoft Agent est déconseillé à partir de Windows 7 et peut ne pas être disponible dans les versions ultérieures de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="8877f-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="8877f-105">En outre, pour la notification d’événement de [**commande**](command-event.md) , l’agent notifie également le client d’entrée-actif lorsque le serveur Active ou désactive le mode d’écoute, à l’aide des événements [**ListenStart**](listenstart-event.md) et [**ListenComplete**](listencomplete-event.md) ([**IAgentNotifySinkEx :: ListeningState**](iagentnotifysinkex--listeningstate.md)).</span><span class="sxs-lookup"><span data-stu-id="8877f-105">In addition, to the [**Command**](command-event.md) event notification, Agent also notifies the input-active client when the server turns the Listening mode on or off, using the [**ListenStart**](listenstart-event.md) and [**ListenComplete**](listencomplete-event.md) events ([**IAgentNotifySinkEx::ListeningState**](iagentnotifysinkex--listeningstate.md)).</span></span> <span data-ttu-id="8877f-106">Toutefois, si l’utilisateur appuie sur la touche mode d’écoute et qu’aucun moteur de reconnaissance vocale correspondant n’est disponible pour le premier caractère du client d’entrée-actif, le serveur démarre le délai d’attente du mode de raccourci d’écoute, mais ne génère pas d’événement **ListenStart** pour le client actif du caractère.</span><span class="sxs-lookup"><span data-stu-id="8877f-106">However, if the user presses the Listening mode key and there is no matching speech recognition engine available for the topmost character of the input-active client, the server starts the Listening hotkey mode time-out, but does not generate a **ListenStart** event for the active client of the character.</span></span> <span data-ttu-id="8877f-107">Si, avant la fin du délai d’attente, l’utilisateur active un autre caractère avec la prise en charge du moteur de reconnaissance vocale, le serveur tente d’activer l’entrée vocale et génère l’événement **ListenStart** .</span><span class="sxs-lookup"><span data-stu-id="8877f-107">If, before the time-out completes, the user activates another character with speech recognition engine support, the server attempts to activate speech input and generates the **ListenStart** event.</span></span>

<span data-ttu-id="8877f-108">De même, si un client tente d’activer le mode d’écoute à l’aide de la méthode [**Listen**](listen-method.md) et qu’aucun moteur de reconnaissance vocale correspondant n’est disponible, l’appel échoue et le serveur ne génère pas d’événement [**ListenStart**](listenstart-event.md).</span><span class="sxs-lookup"><span data-stu-id="8877f-108">Similarly, if a client attempts to turn on the Listening mode using the [**Listen**](listen-method.md) method and there is no matching speech recognition engine available, the call fails and the server does not generate a [**ListenStart**](listenstart-event.md)event.</span></span> <span data-ttu-id="8877f-109">Dans le contrôle Microsoft Agent, la méthode **Listen** retourne la **valeur false**, mais l’appel ne génère pas d’erreur.</span><span class="sxs-lookup"><span data-stu-id="8877f-109">In the Microsoft Agent control, the **Listen** method returns **False**, but the call does not raise an error.</span></span>

<span data-ttu-id="8877f-110">Lorsque le mode de la clé d’écoute est activé et que l’utilisateur bascule vers un caractère qui utilise un autre moteur de reconnaissance vocale, le serveur bascule vers et active ce moteur, puis déclenche un [**ListenComplete**](listencomplete-event.md) et un événement [**ListenStart**](listenstart-event.md) .</span><span class="sxs-lookup"><span data-stu-id="8877f-110">When the Listening key mode is on and the user switches to a character that uses a different speech recognition engine, the server switches to and activates that engine and triggers a [**ListenComplete**](listencomplete-event.md) and then a [**ListenStart**](listenstart-event.md) event.</span></span> <span data-ttu-id="8877f-111">Si le caractère activé ne dispose pas d’un moteur de reconnaissance vocale (parce qu’aucun n’est installé ou qu’il ne correspond pas au paramètre ID de langue du caractère activé), le serveur déclenche l’événement **ListenComplete** pour le caractère précédemment activé et transmet une valeur dans le paramètre **cause** .</span><span class="sxs-lookup"><span data-stu-id="8877f-111">If the activated character does not have an available speech recognition engine (because one is not installed or none match the activated character's language ID setting), the server will trigger the **ListenComplete** event for the previously activated character and passes back a value in the **Cause** parameter.</span></span> <span data-ttu-id="8877f-112">Toutefois, le serveur ne génère pas d’événements **ListenStart** ou **ListenComplete** pour les clients qui n’ont pas de prise en charge de la reconnaissance vocale.</span><span class="sxs-lookup"><span data-stu-id="8877f-112">However, the server does not generate **ListenStart** or **ListenComplete** events for the clients that do not have speech recognition support.</span></span>

<span data-ttu-id="8877f-113">Si un client appelle correctement la méthode [**Listen**](listen-method.md) et qu’un caractère sans prise en charge du moteur de reconnaissance vocale devient inactif avant la fin du délai d’attente du mode d’écoute, puis l’utilisateur revient au caractère du client d’origine, le serveur génère un événement [**ListenStart**](listenstart-event.md) pour ce client.</span><span class="sxs-lookup"><span data-stu-id="8877f-113">If a client successfully calls the [**Listen**](listen-method.md) method and a character without speech recognition engine support becomes input-active before the Listening mode time-out completes, and then the user switches back to the character of the original client, the server will generate a [**ListenStart**](listenstart-event.md) event for that client.</span></span>

<span data-ttu-id="8877f-114">Si le client d’entrée/de sortie active bascule les moteurs de reconnaissance vocale en modifiant [**SRModeID**](srmodeid-property.md) en mode d’écoute, le serveur bascule vers et active ce moteur sans redéclencher l’événement [**ListenStart**](listenstart-event.md) .</span><span class="sxs-lookup"><span data-stu-id="8877f-114">If the input-active client switches speech recognition engines by changing [**SRModeID**](srmodeid-property.md) while in Listening mode, the server switches to and activates that engine without re-triggering the [**ListenStart**](listenstart-event.md) event.</span></span> <span data-ttu-id="8877f-115">Toutefois, si le moteur spécifié n’est pas disponible, l’appel échoue (génère une erreur dans le contrôle) et le serveur appelle également l’événement [**ListenComplete**](listencomplete-event.md) .</span><span class="sxs-lookup"><span data-stu-id="8877f-115">However, if the specified engine is not available, the call fails (raises an error in the control) and the server also calls the [**ListenComplete**](listencomplete-event.md) event.</span></span>

 

 




