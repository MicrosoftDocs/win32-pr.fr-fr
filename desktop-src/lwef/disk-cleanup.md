---
title: Création d’un gestionnaire de nettoyage de disque
description: Un axiome et une nouvelle fois dans le monde des ordinateurs est que, quelle que soit la taille de la capacité de stockage de votre ordinateur, vous finira par le remplir.
ms.assetid: f85e0db7-fbdb-452e-90c8-672f716b5692
keywords:
- gestionnaires de nettoyage de disque
- Nettoyage de disque
- DataDrivenCleaner
- inscription, gestionnaires de nettoyage de disque
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30584439ae2c38ae8a9b7106dae96f69eea5df37
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/08/2020
ms.locfileid: "106511326"
---
# <a name="creating-a-disk-cleanup-handler"></a><span data-ttu-id="4aaf1-107">Création d’un gestionnaire de nettoyage de disque</span><span class="sxs-lookup"><span data-stu-id="4aaf1-107">Creating a Disk Cleanup Handler</span></span>

<span data-ttu-id="4aaf1-108">Un axiome et une nouvelle fois dans le monde des ordinateurs est que, quelle que soit la taille de la capacité de stockage de votre ordinateur, vous finira par le remplir.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-108">One axiom proven time and again in the world of computers is that regardless of the size of your computer's storage capacity, you will eventually fill it up.</span></span> <span data-ttu-id="4aaf1-109">Bien que la taille moyenne du disque dur d’un ordinateur ait considérablement augmenté au fil du temps, les applications ont également augmenté en conséquence, ce qui permet aux utilisateurs de rechercher des moyens de créer plus d’espace libre sur le disque dur.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-109">While the average size of a computer's hard disk has increased dramatically over time, applications have also grown accordingly, leaving users looking for ways to create more free hard disk space.</span></span> <span data-ttu-id="4aaf1-110">L’espace disponible est également réduit par le nombre de fichiers temporaires créés par les applications pour des raisons de sauvegarde ou de performances.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-110">Available space is also reduced by the many temporary files that applications create for backup or performance reasons.</span></span> <span data-ttu-id="4aaf1-111">Lorsque l’espace disque devient faible, il devient nécessaire de réduire la quantité d’espace utilisée par les applications.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-111">When disk space becomes low, it becomes necessary to reduce the amount of space used by applications.</span></span> <span data-ttu-id="4aaf1-112">L’espace disque peut être libéré à l’aide de différents moyens, y compris les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="4aaf1-112">Disk space can be freed using a variety of means, including the following:</span></span>

-   <span data-ttu-id="4aaf1-113">Suppression des fichiers.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-113">Deleting files.</span></span>
-   <span data-ttu-id="4aaf1-114">Compression des fichiers.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-114">Compressing files.</span></span>
-   <span data-ttu-id="4aaf1-115">Déplacement de fichiers vers un support de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-115">Moving files to a backup medium.</span></span>
-   <span data-ttu-id="4aaf1-116">Transfert de fichiers vers un serveur distant.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-116">Transferring files to a remote server.</span></span>

<span data-ttu-id="4aaf1-117">Les fichiers qui sont de bons candidats au nettoyage sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="4aaf1-117">Files that are good candidates for cleanup include:</span></span>

-   <span data-ttu-id="4aaf1-118">Fichiers dont l’utilisateur n’aura plus besoin.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-118">Files that the user will never need again.</span></span>
-   <span data-ttu-id="4aaf1-119">Fichiers temporaires qui existent uniquement pour des raisons de performances.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-119">Temporary files that exist only for performance reasons.</span></span>
-   <span data-ttu-id="4aaf1-120">Fichiers qui peuvent être restaurés, le cas échéant, à partir d’un CD d’installation.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-120">Files that can be restored, if needed, from an installation CD.</span></span>
-   <span data-ttu-id="4aaf1-121">Fichiers de données qui ont peut-être été remplacés par des versions plus récentes, comme les anciens fichiers de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-121">Data files that have possibly been superseded by newer versions, such as old backup files.</span></span>
-   <span data-ttu-id="4aaf1-122">Fichiers plus anciens qui n’ont pas été utilisés à long terme.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-122">Older files that have not been used in a long time.</span></span>

<span data-ttu-id="4aaf1-123">La suppression est particulièrement appropriée pour les fichiers dont l’utilisateur n’aura jamais besoin, par exemple, les fichiers qui sont temporairement mis en cache pour des raisons de performances.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-123">Deletion is particularly appropriate for files that the user will never need again for example, files that are temporarily cached for performance reasons.</span></span> <span data-ttu-id="4aaf1-124">La suppression est également appropriée pour les fichiers qui sont facilement restaurés, tels que les fichiers graphiques qui peuvent être rechargées à partir d’un CD d’installation.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-124">Deletion is also appropriate for files that are easily restored, such as graphics files that can be reloaded from an installation CD.</span></span> <span data-ttu-id="4aaf1-125">Les fichiers dont l’utilisateur peut avoir besoin plus tard ou qui serait difficile à reconstruire sont des candidats plus adaptés à la compression ou à la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-125">Files that the user might need later or that would be difficult to reconstruct are better candidates for compression or backup.</span></span>

<span data-ttu-id="4aaf1-126">L’utilisation d’un utilisateur pour nettoyer manuellement le système de fichiers n’est pas une bonne solution.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-126">Expecting a user to manually clean the file system is not a good solution.</span></span> <span data-ttu-id="4aaf1-127">L’utilisateur peut ne pas savoir où de nombreux fichiers se trouvent ou comment reconnaître ceux qui peuvent être supprimés en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-127">The user may not know where many of the files are located or how to recognize which ones can be safely removed.</span></span> <span data-ttu-id="4aaf1-128">En outre, il existe un risque que l’utilisateur puisse supprimer des fichiers essentiels.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-128">In addition, there's the risk that the user might delete essential files.</span></span>

<span data-ttu-id="4aaf1-129">Les facettes suivantes de l’utilitaire de nettoyage de disque sont présentées dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-129">The following facets of the Disk Cleanup utility are discussed in this topic.</span></span>

-   [<span data-ttu-id="4aaf1-130">Utilitaire de nettoyage de disque Windows</span><span class="sxs-lookup"><span data-stu-id="4aaf1-130">The Windows Disk Cleanup Utility</span></span>](#the-windows-disk-cleanup-utility)
-   [<span data-ttu-id="4aaf1-131">Notions de base de l’implémentation</span><span class="sxs-lookup"><span data-stu-id="4aaf1-131">Implementation Basics</span></span>](#implementation-basics)
    -   [<span data-ttu-id="4aaf1-132">Initialiser/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="4aaf1-132">Initialize/InitializeEx</span></span>](#initializeinitializeex)
    -   [<span data-ttu-id="4aaf1-133">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="4aaf1-133">GetSpaceUsed</span></span>](#getspaceused)
    -   [<span data-ttu-id="4aaf1-134">ShowProperties</span><span class="sxs-lookup"><span data-stu-id="4aaf1-134">ShowProperties</span></span>](#showproperties)
    -   [<span data-ttu-id="4aaf1-135">Purge</span><span class="sxs-lookup"><span data-stu-id="4aaf1-135">Purge</span></span>](#purge)
    -   [<span data-ttu-id="4aaf1-136">Désactivation</span><span class="sxs-lookup"><span data-stu-id="4aaf1-136">Deactivate</span></span>](#deactivate)
-   [<span data-ttu-id="4aaf1-137">Inscription d’un gestionnaire de nettoyage de disque</span><span class="sxs-lookup"><span data-stu-id="4aaf1-137">Registering a Disk Cleanup Handler</span></span>](#registering-a-disk-cleanup-handler)
    -   [<span data-ttu-id="4aaf1-138">Inscription du CLSID d’un gestionnaire</span><span class="sxs-lookup"><span data-stu-id="4aaf1-138">Registering a Handler's CLSID</span></span>](#registering-a-handlers-clsid)
    -   [<span data-ttu-id="4aaf1-139">Inscription d’un gestionnaire à l’aide du gestionnaire de nettoyage de disque : général</span><span class="sxs-lookup"><span data-stu-id="4aaf1-139">Registering a Handler with the Disk Cleanup Manager: General</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-general)
    -   [<span data-ttu-id="4aaf1-140">Inscription d’un gestionnaire à l’aide du gestionnaire de nettoyage de disque : systèmes Windows 2000 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="4aaf1-140">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems)
    -   [<span data-ttu-id="4aaf1-141">Utilisation de l’objet DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="4aaf1-141">Using the DataDrivenCleaner Object</span></span>](#using-the-datadrivencleaner-object)
    -   [<span data-ttu-id="4aaf1-142">Exemple d’inscription d’un gestionnaire de nettoyage de disque</span><span class="sxs-lookup"><span data-stu-id="4aaf1-142">Example Registration of a Disk Cleanup Handler</span></span>](#example-registration-of-a-disk-cleanup-handler)

## <a name="the-windows-disk-cleanup-utility"></a><span data-ttu-id="4aaf1-143">Utilitaire de nettoyage de disque Windows</span><span class="sxs-lookup"><span data-stu-id="4aaf1-143">The Windows Disk Cleanup Utility</span></span>

<span data-ttu-id="4aaf1-144">À partir de Windows 98, le système d’exploitation Windows comprend le nettoyage de disque, un utilitaire qui permet à l’utilisateur de gérer plus facilement l’espace disque disponible.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-144">Starting on Windows 98, the Windows operating system includes Disk Cleanup, a utility that makes it much easier for the user to manage available hard disk space.</span></span> <span data-ttu-id="4aaf1-145">L’utilitaire de nettoyage de disque est conçu pour libérer autant d’espace disque que possible et réduire le risque que l’utilisateur supprime accidentellement des fichiers essentiels.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-145">The Disk Cleanup utility is designed to free up as much disk space as possible and decrease the risk that the user will delete essential files accidentally.</span></span>

<span data-ttu-id="4aaf1-146">Le nettoyage de disque peut être lancé de trois manières.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-146">Disk cleanup can be initiated in three ways.</span></span>

-   <span data-ttu-id="4aaf1-147">L’utilisateur peut lancer le nettoyage de disque en cliquant sur **Démarrer**. pointant sur **tous les programmes**, **accessoires** et **Outils système**; puis cliquez sur **nettoyage de disque**.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-147">The user can initiate disk cleanup by clicking **Start**; pointing to **All Programs**, **Accessories**, and **System Tools**; and then clicking **Disk Cleanup**.</span></span>
-   <span data-ttu-id="4aaf1-148">Le système avertit l’utilisateur qu’une boîte de message indiquant que l’espace disque inutilisé a atteint le mode critique.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-148">The system notifies the user with a message box that unused disk space has reached critical mode.</span></span> <span data-ttu-id="4aaf1-149">Le seuil de mode critique pour un lecteur supérieur à 2,25 gigaoctets (Go) est de 200 mégaoctets (Mo).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-149">The critical mode threshold for a drive larger than 2.25 gigabytes (GB) is 200 megabytes (MB).</span></span> <span data-ttu-id="4aaf1-150">Les avertissements suivants sont donnés à 80, 50 et 1 Mo.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-150">Subsequent warnings are given at 80, 50, and 1 MB.</span></span> <span data-ttu-id="4aaf1-151">L’utilisateur a la possibilité de libérer manuellement de l’espace disque ou de démarrer l’utilitaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-151">The user is given the option of freeing disk space manually or starting the Disk Cleanup utility.</span></span>
-   <span data-ttu-id="4aaf1-152">L’utilisateur peut avoir l’Assistant tâche planifiée de Windows (appelé Assistant Maintenance sur les anciens systèmes) exécuter l’utilitaire de nettoyage de disque automatiquement à des heures planifiées.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-152">The user can have the Windows Scheduled Task Wizard (known as the Maintenance Wizard on older systems) run the Disk Cleanup utility automatically at scheduled times.</span></span>

<span data-ttu-id="4aaf1-153">Le défi de base inhérent au nettoyage de disque consiste à libérer autant d’espace disque que possible sans supprimer les fichiers essentiels.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-153">The basic challenge inherent in disk cleanup is to free as much disk space as possible without deleting essential files.</span></span> <span data-ttu-id="4aaf1-154">Étant donné qu’il n’existe pas de méthode standard pour marquer les fichiers à nettoyer, aucune application ne peut détecter et nettoyer tous les fichiers non essentiels de manière fiable.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-154">Because there is no standard way to mark files for cleanup, no single application can reliably detect and clean all unessential files.</span></span> <span data-ttu-id="4aaf1-155">L’utilitaire de nettoyage de disque résout ce problème en fractionnant l’opération de nettoyage entre un *Gestionnaire de nettoyage de disque* unique et une collection de gestionnaires de nettoyage de *disque*.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-155">The Disk Cleanup utility addresses this problem by splitting the cleanup operation between a single *disk cleanup manager* and a collection of *disk cleanup handlers*.</span></span>

<span data-ttu-id="4aaf1-156">Lorsque l’utilitaire de nettoyage de disque est exécuté, l’utilisateur voit la boîte de dialogue suivante.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-156">When the Disk Cleanup utility is run, the user sees the following dialog box.</span></span> <span data-ttu-id="4aaf1-157">(S’il existe plus d’un disque ou d’une partition de disque sur l’ordinateur, l’utilisateur est d’abord invité à choisir un lecteur avant que cette boîte de dialogue ne s’affiche.)</span><span class="sxs-lookup"><span data-stu-id="4aaf1-157">(If more than one disk or disk partition exists on the computer, the user is first asked to choose a drive before this dialog is displayed.)</span></span>

![capture d’écran de la boîte de dialogue nettoyer](images/cleanup1.png)

<span data-ttu-id="4aaf1-159">Le gestionnaire de nettoyage de disque fait partie du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-159">The disk cleanup manager is part of the operating system.</span></span> <span data-ttu-id="4aaf1-160">Il affiche la boîte de dialogue illustrée dans l’illustration précédente, gère l’entrée d’utilisateur et gère l’opération de nettoyage.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-160">It displays the dialog box shown in the preceding illustration, handles user input, and manages the cleanup operation.</span></span> <span data-ttu-id="4aaf1-161">La sélection et le nettoyage réels des fichiers inutiles sont effectués par les gestionnaires de nettoyage de disque individuels indiqués dans la zone de liste du gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-161">The actual selection and cleanup of unneeded files is done by the individual disk cleanup handlers shown in the disk cleanup manager's list box.</span></span> <span data-ttu-id="4aaf1-162">L’utilisateur a la possibilité d’activer ou de désactiver des gestionnaires individuels en activant ou en désactivant leur case à cocher dans l’interface utilisateur du gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-162">The user has the option of enabling or disabling individual handlers by selecting or clearing their check box in the disk cleanup manager's UI.</span></span>

<span data-ttu-id="4aaf1-163">Chaque gestionnaire est responsable d’un ensemble bien défini de fichiers.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-163">Each handler is responsible for a well defined set of files.</span></span> <span data-ttu-id="4aaf1-164">Par exemple, le gestionnaire sélectionné dans l’illustration est responsable du nettoyage des fichiers programmes téléchargés.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-164">For example, the selected handler in the illustration is responsible for cleaning up downloaded program files.</span></span> <span data-ttu-id="4aaf1-165">Le gestionnaire sélectionné dans l’illustration fournit également un bouton **afficher les fichiers** .</span><span class="sxs-lookup"><span data-stu-id="4aaf1-165">The handler selected in the illustration also provides a **View Files** button.</span></span> <span data-ttu-id="4aaf1-166">En cliquant sur le bouton, l’utilisateur peut demander que le gestionnaire affiche une interface utilisateur en général une fenêtre de l’Explorateur Windows qui permet à l’utilisateur de spécifier les fichiers ou les classes de fichiers à nettoyer.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-166">By clicking the button, the user can request that the handler display a UI typically a Windows Explorer window that allows the user to specify which files or classes of files to clean.</span></span>

<span data-ttu-id="4aaf1-167">Bien que Windows soit fourni avec un certain nombre de gestionnaires de nettoyage de disque, ils ne sont pas conçus pour gérer les fichiers générés par d’autres applications.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-167">Although Windows comes with a number of disk cleanup handlers, they aren't designed to handle files produced by other applications.</span></span> <span data-ttu-id="4aaf1-168">Au lieu de cela, le gestionnaire de nettoyage de disque est conçu pour être flexible et extensible en permettant à n’importe quel développeur d’implémenter et d’inscrire son propre gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-168">Instead, the disk cleanup manager is designed to be flexible and extensible by enabling any developer to implement and register their own disk cleanup handler.</span></span> <span data-ttu-id="4aaf1-169">N’importe quel développeur peut étendre les services de nettoyage de disque disponibles en implémentant et en inscrivant un gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-169">Any developer can extend the available disk cleanup services by implementing and registering a disk cleanup handler.</span></span>

<span data-ttu-id="4aaf1-170">Toutes les applications qui produisent des fichiers temporaires peuvent et doivent implémenter et enregistrer un gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-170">All applications that produce temporary files can and should implement and register a disk cleanup handler.</span></span> <span data-ttu-id="4aaf1-171">Cela offre aux utilisateurs un moyen pratique et fiable de gérer les fichiers temporaires de l’application.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-171">Doing so gives users a convenient and reliable way to manage the application's temporary files.</span></span> <span data-ttu-id="4aaf1-172">Lorsque vous implémentez le gestionnaire, vous pouvez décider quels fichiers sont affectés et déterminer la façon dont le nettoyage réel se produit.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-172">When you implement the handler, you can decide which files are affected and determine how the actual cleanup happens.</span></span>

## <a name="implementation-basics"></a><span data-ttu-id="4aaf1-173">Notions de base de l’implémentation</span><span class="sxs-lookup"><span data-stu-id="4aaf1-173">Implementation Basics</span></span>

<span data-ttu-id="4aaf1-174">Les gestionnaires de nettoyage sont des objets COM (Component Object Model) du serveur in-process.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-174">Cleanup handlers are in-process server Component Object Model (COM) objects.</span></span> <span data-ttu-id="4aaf1-175">Windows fournit un objet gestionnaire existant appelé DataDrivenCleaner à votre usage.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-175">Windows provides an existing handler object called the DataDrivenCleaner for your use.</span></span> <span data-ttu-id="4aaf1-176">Vous pouvez également choisir d’implémenter un gestionnaire vous-même pour plus de flexibilité.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-176">You can also opt to implement a handler yourself for more flexibility.</span></span> <span data-ttu-id="4aaf1-177">Ces objets vous permettent ensuite de spécifier comment sélectionner des fichiers, l’espace disque disponible et, dans le cas d’un gestionnaire implémenté, d’afficher l’interface utilisateur facultative pour un contrôle plus granulaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-177">These objects then allow you to specify how to select files, free disk space, and, in the case of an implemented handler, display the optional UI for more granular control.</span></span> <span data-ttu-id="4aaf1-178">Cette section traite de l’implémentation de votre propre gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-178">This section addresses the matter of implementing your own handler.</span></span> <span data-ttu-id="4aaf1-179">Pour plus d’informations sur l’utilisation de l’objet DataDrivenCleaner, consultez [utilisation de l’objet DataDrivenCleaner](#using-the-datadrivencleaner-object).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-179">For details concerning the use of the DataDrivenCleaner object, see [Using the DataDrivenCleaner Object](#using-the-datadrivencleaner-object).</span></span>

<span data-ttu-id="4aaf1-180">Un gestionnaire de nettoyage de disque doit effectuer ces cinq tâches de base.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-180">A disk cleanup handler should perform these five basic tasks.</span></span>

-   <span data-ttu-id="4aaf1-181">Initialise l’objet de gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-181">Initialize the handler object.</span></span>
-   <span data-ttu-id="4aaf1-182">Analysez le disque pour déterminer la quantité d’espace disque pouvant être libérée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-182">Scan the disk to determine how much disk space can be freed.</span></span>
-   <span data-ttu-id="4aaf1-183">Affichez l’interface utilisateur pour obtenir des commentaires de l’utilisateur sur les fichiers à nettoyer.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-183">Display the UI to obtain user feedback about which files to clean.</span></span> <span data-ttu-id="4aaf1-184">(facultatif)</span><span class="sxs-lookup"><span data-stu-id="4aaf1-184">(Optional)</span></span>
-   <span data-ttu-id="4aaf1-185">Effectuez le nettoyage.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-185">Do the cleanup.</span></span>
-   <span data-ttu-id="4aaf1-186">Arrêter.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-186">Shut down.</span></span>

<span data-ttu-id="4aaf1-187">Pour autoriser le gestionnaire de nettoyage de disque à gérer ces tâches, un gestionnaire doit exporter [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) pour Windows 98 ou [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) pour Windows Millennium Edition (Windows Me), Windows 2000 et Windows XP.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-187">To allow the disk cleanup manager to manage these tasks, a handler must export either [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) for Windows 98 or [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) for Windows Millennium Edition (Windows Me), Windows 2000, and Windows XP.</span></span> <span data-ttu-id="4aaf1-188">Étant donné que **IEmptyVolumeCache2** hérite de **IEmptyVolumeCache**, l’ajout de la méthode supplémentaire **InitializeEx**, relativement peu de travail supplémentaire est requis pour implémenter les deux.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-188">Because **IEmptyVolumeCache2** inherits from **IEmptyVolumeCache**, adding only the additional method **InitializeEx**, relatively little extra work is required to implement both.</span></span> <span data-ttu-id="4aaf1-189">À moins que votre gestionnaire ne soit destiné à un seul de ces systèmes d’exploitation, il doit exporter les deux interfaces.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-189">Unless your handler is intended for only one of these operating systems, it should export both interfaces.</span></span>

<span data-ttu-id="4aaf1-190">Pour exporter ces interfaces, vous devez implémenter ces méthodes correspondant aux cinq tâches de base.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-190">To export these interfaces, you must implement these methods corresponding to the five basic tasks.</span></span>

-   [<span data-ttu-id="4aaf1-191">Initialiser/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="4aaf1-191">Initialize/InitializeEx</span></span>](#initializeinitializeex)
-   [<span data-ttu-id="4aaf1-192">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="4aaf1-192">GetSpaceUsed</span></span>](#getspaceused)
-   [<span data-ttu-id="4aaf1-193">ShowProperties</span><span class="sxs-lookup"><span data-stu-id="4aaf1-193">ShowProperties</span></span>](#showproperties)
-   [<span data-ttu-id="4aaf1-194">Purge</span><span class="sxs-lookup"><span data-stu-id="4aaf1-194">Purge</span></span>](#purge)
-   [<span data-ttu-id="4aaf1-195">Désactivation</span><span class="sxs-lookup"><span data-stu-id="4aaf1-195">Deactivate</span></span>](#deactivate)

### <a name="initializeinitializeex"></a><span data-ttu-id="4aaf1-196">Initialiser/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="4aaf1-196">Initialize/InitializeEx</span></span>

<span data-ttu-id="4aaf1-197">Les deux méthodes d’initialisation, qui sont assez similaires, sont appelées lors de l’exécution de l’utilitaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-197">The two initialization methods, which are quite similar, are called when the Disk Cleanup utility is run.</span></span> <span data-ttu-id="4aaf1-198">Le gestionnaire de nettoyage de disque de Windows 98 appelle la méthode [**IEmptyVolumeCache :: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) d’un gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-198">The Windows 98 disk cleanup manager calls a handler's [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) method.</span></span> <span data-ttu-id="4aaf1-199">Toutefois, le gestionnaire de nettoyage de disque Windows Millennium Edition (Windows Me), Windows 2000 ou Windows XP tente d’abord d’appeler [**IEmptyVolumeCache2 :: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) et utilise uniquement **IEmptyVolumeCache :: Initialize** si [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) n’est pas exposé par le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-199">The Windows Millennium Edition (Windows Me), Windows 2000, or Windows XP disk cleanup manager, however, first tries calling [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) and only uses **IEmptyVolumeCache::Initialize** if [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) is not exposed by the handler.</span></span> <span data-ttu-id="4aaf1-200">Le gestionnaire de nettoyage de disque transmet des informations à la méthode, telles que la clé de Registre du gestionnaire et le volume de disque à nettoyer.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-200">The disk cleanup manager passes information to the method, such as the handler's registry key and the disk volume that is to be cleaned.</span></span>

<span data-ttu-id="4aaf1-201">L’une ou l’autre méthode peut retourner plusieurs chaînes d’affichage et définir un ou plusieurs indicateurs.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-201">Either method can return various display strings and set one or more flags.</span></span> <span data-ttu-id="4aaf1-202">La principale différence entre les deux méthodes est la façon dont le texte affiché dans le gestionnaire de nettoyage de disque est géré.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-202">The primary difference between the two methods is how the text displayed in the disk cleanup manager is handled.</span></span> <span data-ttu-id="4aaf1-203">Les trois chaînes suivantes sont affectées.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-203">The following three strings are affected.</span></span>



| <span data-ttu-id="4aaf1-204">String</span><span class="sxs-lookup"><span data-stu-id="4aaf1-204">String</span></span>       | <span data-ttu-id="4aaf1-205">Objectif</span><span class="sxs-lookup"><span data-stu-id="4aaf1-205">Purpose</span></span>                                                                            | <span data-ttu-id="4aaf1-206">Initialiser</span><span class="sxs-lookup"><span data-stu-id="4aaf1-206">Initialize</span></span>                                                                           | <span data-ttu-id="4aaf1-207">InitializeEx</span><span class="sxs-lookup"><span data-stu-id="4aaf1-207">InitializeEx</span></span>                                                                                     |
|--------------|------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4aaf1-208">Nom d’affichage</span><span class="sxs-lookup"><span data-stu-id="4aaf1-208">Display Name</span></span> | <span data-ttu-id="4aaf1-209">Nom du gestionnaire affiché dans la zone de liste du gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-209">The handler's name displayed in the disk cleanup manager's list box.</span></span>               | <span data-ttu-id="4aaf1-210">Si *ppwszDisplayName* a la valeur **null**, la valeur par défaut est récupérée à partir du Registre.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-210">If *ppwszDisplayName* is **NULL**, the default value is retrieved from the registry.</span></span> | <span data-ttu-id="4aaf1-211">Une chaîne correctement localisée doit être spécifiée dans *ppwszDisplayName* aucune valeur de Registre n’est utilisée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-211">A properly localized string must be specified in *ppwszDisplayName* no registry values are used.</span></span> |
| <span data-ttu-id="4aaf1-212">Description</span><span class="sxs-lookup"><span data-stu-id="4aaf1-212">Description</span></span>  | <span data-ttu-id="4aaf1-213">Texte descriptif affiché sous la zone de liste lorsque le nom du gestionnaire est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-213">Descriptive text displayed below the list box when the handler's name is selected.</span></span> | <span data-ttu-id="4aaf1-214">Si *ppwszDescription* a la valeur **null**, la valeur par défaut est récupérée à partir du Registre.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-214">If *ppwszDescription* is **NULL**, the default value is retrieved from the registry.</span></span> | <span data-ttu-id="4aaf1-215">Une chaîne correctement localisée doit être spécifiée dans *ppwszDescription* aucune valeur de Registre n’est utilisée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-215">A properly localized string must be specified in *ppwszDescription* no registry values are used.</span></span> |
| <span data-ttu-id="4aaf1-216">Texte du bouton</span><span class="sxs-lookup"><span data-stu-id="4aaf1-216">Button Text</span></span>  | <span data-ttu-id="4aaf1-217">Texte pour le bouton facultatif qui permet aux utilisateurs d’afficher l’interface utilisateur du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-217">Text for the optional button that allows users to display the handler's UI.</span></span>        | <span data-ttu-id="4aaf1-218">Aucun paramètre disponible.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-218">No parameter available.</span></span> <span data-ttu-id="4aaf1-219">Doit être spécifié dans le registre.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-219">Must be specified in the registry.</span></span>                           | <span data-ttu-id="4aaf1-220">Une chaîne correctement localisée doit être spécifiée dans *ppwszBtnText* aucune valeur de Registre n’est utilisée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-220">A properly localized string must be specified in *ppwszBtnText* no registry values are used.</span></span>     |



 

<span data-ttu-id="4aaf1-221">Le paramètre *pdwFlags* trouvé dans les deux méthodes d’initialisation reconnaît le même jeu d’indicateurs.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-221">The *pdwFlags* parameter found in both initialization methods recognizes the same set of flags.</span></span> <span data-ttu-id="4aaf1-222">Deux de ces indicateurs sont passés à la méthode par le gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-222">Two of these flags are passed to the method by the disk cleanup manager.</span></span>

-   <span data-ttu-id="4aaf1-223">**EVCF \_ SETTINGSMODE**</span><span class="sxs-lookup"><span data-stu-id="4aaf1-223">**EVCF\_SETTINGSMODE**</span></span>

    <span data-ttu-id="4aaf1-224">Si le gestionnaire de nettoyage de disque est exécuté selon une planification, il définit l’indicateur **EVCF \_ SETTINGSMODE** .</span><span class="sxs-lookup"><span data-stu-id="4aaf1-224">If the disk cleanup manager is being run on a schedule, it sets the **EVCF\_SETTINGSMODE** flag.</span></span> <span data-ttu-id="4aaf1-225">Si cet indicateur est défini, le gestionnaire de nettoyage de disque n’appelle pas les méthodes [GetSpaceUsed](#getspaceused), [purge](#purge)ou [showProperties](#showproperties) .</span><span class="sxs-lookup"><span data-stu-id="4aaf1-225">If this flag is set, the disk cleanup manager does not call the [GetSpaceUsed](#getspaceused), [Purge](#purge), or [ShowProperties](#showproperties) methods.</span></span> <span data-ttu-id="4aaf1-226">La méthode [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) ou [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) du gestionnaire doit gérer toutes les tâches normalement effectuées par [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) et [**purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-226">The handler's [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) or [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) method must handle all of the tasks normally performed by [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) and [**Purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge).</span></span> <span data-ttu-id="4aaf1-227">Étant donné qu’il n’y a aucune possibilité de commentaires de la part de l’utilisateur, seuls les fichiers dont le nettoyage est extrêmement sûr doivent être affectés.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-227">Because there is no opportunity for user feedback, only those files that are extremely safe to clean up should be touched.</span></span> <span data-ttu-id="4aaf1-228">Vous devez ignorer le paramètre *pcwszVolume* de la méthode d’initialisation et nettoyer les fichiers inutiles, quel que soit le lecteur sur lequel ils se trouvent.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-228">You should ignore the initialization method's *pcwszVolume* parameter and clean unneeded files regardless of what drive they are on.</span></span>

-   <span data-ttu-id="4aaf1-229">**EVCF \_ OUTOFDISKSPACE**</span><span class="sxs-lookup"><span data-stu-id="4aaf1-229">**EVCF\_OUTOFDISKSPACE**</span></span>

    <span data-ttu-id="4aaf1-230">Si l’indicateur **EVCF \_ OUTOFDISKSPACE** est défini, l’espace disque de l’utilisateur est très faible.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-230">If the **EVCF\_OUTOFDISKSPACE** flag is set, the user's disk drive is critically short of space.</span></span> <span data-ttu-id="4aaf1-231">Le gestionnaire doit être agressif en ce qui concerne la suppression de fichiers, même si cela entraîne une perte de performances.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-231">The handler should be aggressive about deleting files, even if it results in a performance loss.</span></span> <span data-ttu-id="4aaf1-232">Toutefois, le gestionnaire ne doit évidemment pas supprimer les fichiers qui provoqueraient l’échec d’une application ou la perte de données par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-232">However, the handler obviously should not delete files that would cause an application to fail or the user to lose data.</span></span>

<span data-ttu-id="4aaf1-233">Les indicateurs restants sont définis par le gestionnaire de nettoyage de disque et retournés au gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-233">The remaining flags are set by the disk cleanup handler and returned to the disk cleanup manager.</span></span> <span data-ttu-id="4aaf1-234">Pour plus d’informations, consultez les pages de référence des méthodes pour [**IEmptyVolumeCache :: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) et [**IEmptyVolumeCache2 :: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-234">For more information, see the method reference pages for [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) and [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span></span>

-   <span data-ttu-id="4aaf1-235">EVCF \_ DONTSHOWIFZERO</span><span class="sxs-lookup"><span data-stu-id="4aaf1-235">EVCF\_DONTSHOWIFZERO</span></span>

    <span data-ttu-id="4aaf1-236">Affichez le gestionnaire dans la zone de liste du gestionnaire de nettoyage de disque uniquement si la valeur retournée par [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) indique que le gestionnaire peut libérer de l’espace disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-236">Display the handler in the disk cleanup manager's list box only if the value returned by [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) indicates that the handler can free some disk space.</span></span>

-   <span data-ttu-id="4aaf1-237">EVCF \_ ENABLEBYDEFAULT</span><span class="sxs-lookup"><span data-stu-id="4aaf1-237">EVCF\_ENABLEBYDEFAULT</span></span>

    <span data-ttu-id="4aaf1-238">Spécifie que le gestionnaire est activé par défaut.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-238">Specifies that the handler is enabled by default.</span></span> <span data-ttu-id="4aaf1-239">Elle s’exécute chaque fois qu’un nettoyage de disque a lieu, sauf si l’utilisateur la désactive en désactivant sa case à cocher dans la liste des gestionnaires du gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-239">It will run every time a disk cleanup takes place unless the user disables it by clearing its check box in the disk cleanup manager's list of handlers.</span></span>

-   <span data-ttu-id="4aaf1-240">EVCF \_ ENABLEBYDEFAULT \_ auto</span><span class="sxs-lookup"><span data-stu-id="4aaf1-240">EVCF\_ENABLEBYDEFAULT\_AUTO</span></span>

    <span data-ttu-id="4aaf1-241">Spécifie que le gestionnaire est automatiquement activé pour s’exécuter pendant les nettoyages planifiés.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-241">Specifies that the handler is automatically enabled to run during scheduled cleanups.</span></span>

-   <span data-ttu-id="4aaf1-242">EVCF \_ HASSETTINGS</span><span class="sxs-lookup"><span data-stu-id="4aaf1-242">EVCF\_HASSETTINGS</span></span>

    <span data-ttu-id="4aaf1-243">Définissez cet indicateur si votre gestionnaire a une interface utilisateur à afficher.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-243">Set this flag if your handler has a UI to display.</span></span> <span data-ttu-id="4aaf1-244">En réponse, le gestionnaire de nettoyage de disque affiche un bouton lorsque ce gestionnaire est sélectionné dans la zone de liste.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-244">In response, the disk cleanup manager displays a button when that handler is selected in the list box.</span></span> <span data-ttu-id="4aaf1-245">Si vous cliquez sur ce bouton, le gestionnaire de nettoyage de disque appelle [**showProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-245">If that button is clicked, the disk cleanup manager calls [**ShowProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties).</span></span>

-   <span data-ttu-id="4aaf1-246">EVCF \_ REMOVEFROMLIST</span><span class="sxs-lookup"><span data-stu-id="4aaf1-246">EVCF\_REMOVEFROMLIST</span></span>

    <span data-ttu-id="4aaf1-247">Supprimez le nom du gestionnaire de la liste des gestionnaires disponibles une fois que le gestionnaire a été exécuté une fois.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-247">Delete the handler's name from the list of available handlers after the handler has been run once.</span></span> <span data-ttu-id="4aaf1-248">Les informations du Registre du gestionnaire sont également supprimées.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-248">The handler's registry information is also deleted.</span></span>

### <a name="getspaceused"></a><span data-ttu-id="4aaf1-249">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="4aaf1-249">GetSpaceUsed</span></span>

<span data-ttu-id="4aaf1-250">Le gestionnaire de nettoyage de disque appelle cette méthode pour déterminer la quantité d’espace qu’un gestionnaire de nettoyage de disque peut potentiellement libérer.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-250">The disk cleanup manager calls this method to determine how much space a disk cleanup handler can potentially free.</span></span> <span data-ttu-id="4aaf1-251">Le gestionnaire de nettoyage de disque affiche ensuite cette valeur à droite du nom du gestionnaire dans la zone de liste.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-251">The disk cleanup manager then displays that value to the right of the handler's name in the list box.</span></span> <span data-ttu-id="4aaf1-252">Cette opération est effectuée sur tous les gestionnaires inscrits auprès du gestionnaire de nettoyage de disque lorsque le gestionnaire est lancé et avant l’affichage de l’interface utilisateur principale du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-252">This operation is performed on all of the handlers registered with the disk cleanup manager when the manager is launched and before the manager's main UI is displayed.</span></span> <span data-ttu-id="4aaf1-253">Quand [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) est appelé, le gestionnaire doit analyser les fichiers dont il est responsable, déterminer ceux qui sont des candidats aux nettoyages et retourner la quantité d’espace disque qu’il peut libérer.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-253">When [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) is called, the handler should scan the files that it is responsible for, determine which of them are cleanup candidates, and return the amount of disk space that it can free.</span></span>

<span data-ttu-id="4aaf1-254">Étant donné que l’analyse peut être un processus long, le gestionnaire de nettoyage de disque utilise le paramètre *PICB* de cette méthode pour passer un pointeur vers une interface [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) .</span><span class="sxs-lookup"><span data-stu-id="4aaf1-254">Because scanning can be a lengthy process, the disk cleanup manager uses this method's *picb* parameter to pass a pointer to an [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) interface.</span></span> <span data-ttu-id="4aaf1-255">Le gestionnaire utilise l’interface régulièrement pendant l’analyse pour appeler [**IEmptyVolumeCacheCallBack :: ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress), qui remplit deux fonctions.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-255">The handler uses the interface periodically during the scan to call [**IEmptyVolumeCacheCallBack::ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress), which serves two purposes.</span></span>

-   <span data-ttu-id="4aaf1-256">Permet au gestionnaire de nettoyage de disque de mettre à jour une barre de progression, en informant l’utilisateur de la progression de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-256">Allows the disk cleanup manager to update a progress bar, informing the user how the scan is progressing.</span></span>
-   <span data-ttu-id="4aaf1-257">Notifie le gestionnaire d’arrêt de l’analyse dans le cas où l’utilisateur clique sur le bouton **Annuler** de la fenêtre de progression.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-257">Notifies the handler to stop the scan in the event that the progress window's **Cancel** button is clicked.</span></span> <span data-ttu-id="4aaf1-258">Cet événement de bouton n’est pas communiqué directement au gestionnaire. au lieu de cela, le gestionnaire de nettoyage de disque renvoie E \_ Abort la prochaine fois que [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) appelle [**IEmptyVolumeCacheCallBack :: ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-258">That button event is not communicated directly to the handler; instead, the disk cleanup manager returns E\_ABORT the next time [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) calls [**IEmptyVolumeCacheCallBack::ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span></span>

### <a name="showproperties"></a><span data-ttu-id="4aaf1-259">ShowProperties</span><span class="sxs-lookup"><span data-stu-id="4aaf1-259">ShowProperties</span></span>

<span data-ttu-id="4aaf1-260">Avant de commencer le nettoyage, le gestionnaire peut afficher une interface utilisateur généralement sous la forme d’une fenêtre de l’Explorateur Windows qui permet à l’utilisateur d’afficher la liste des fichiers ou des classes de fichiers sélectionnés pour être nettoyés par le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-260">Before starting cleanup, the handler can display a UI typically in the form of a Windows Explorer window that allows the user to see a list of files or classes of files selected for cleanup by the handler.</span></span> <span data-ttu-id="4aaf1-261">Si le gestionnaire définit l’indicateur **EVCF \_ HASSETTINGS** lorsque [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) ou [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) est appelé, l’utilisateur peut demander l’interface utilisateur en cliquant sur le bouton affiché à cet effet dans le gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-261">If the handler sets the **EVCF\_HASSETTINGS** flag when [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) or [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) is called, the user can request the UI by clicking the button displayed for that purpose in the disk cleanup manager.</span></span> <span data-ttu-id="4aaf1-262">Le texte du bouton varie d’un gestionnaire à un gestionnaire, mais les noms « afficher les fichiers », « afficher les pages » et « options » sont des étiquettes courantes.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-262">The button text varies from handler to handler, but "View Files," "View Pages," and "Options" are common labels.</span></span>

<span data-ttu-id="4aaf1-263">Lorsque vous cliquez sur le bouton, le gestionnaire de nettoyage de disque appelle [**showProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties) pour inviter le gestionnaire à afficher l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-263">When the button is clicked, the disk cleanup manager calls [**ShowProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties) to prompt the handler to display the UI.</span></span> <span data-ttu-id="4aaf1-264">L’interface utilisateur doit être créée en tant qu’enfant de la fenêtre dont le handle est passé dans le paramètre *HWND* de la méthode **showProperties** .</span><span class="sxs-lookup"><span data-stu-id="4aaf1-264">The UI should be created as a child of the window whose handle is passed in the **ShowProperties** method's *hwnd* parameter.</span></span>

### <a name="purge"></a><span data-ttu-id="4aaf1-265">Purge</span><span class="sxs-lookup"><span data-stu-id="4aaf1-265">Purge</span></span>

<span data-ttu-id="4aaf1-266">Le gestionnaire de nettoyage de disque appelle la méthode de [**vidage**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge) du gestionnaire pour définir le nettoyage en mouvement.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-266">The disk cleanup manager calls the handler's [**Purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge) method to set the cleanup in motion.</span></span> <span data-ttu-id="4aaf1-267">Le paramètre *PICB* de la méthode est un pointeur vers l’interface [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) du gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-267">The method's *picb* parameter is a pointer to the disk cleanup manager's [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) interface.</span></span> <span data-ttu-id="4aaf1-268">Comme avec la méthode [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) , le gestionnaire doit utiliser l’interface de rappel régulièrement pour signaler sa progression et demander au gestionnaire de nettoyage de disque si l’utilisateur a cliqué sur **Annuler**.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-268">As with the [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) method, the handler should use the callback interface periodically to report its progress and query the disk cleanup manager whether the user has clicked **Cancel**.</span></span> <span data-ttu-id="4aaf1-269">Toutefois, Notez que la méthode de **vidage** doit appeler [**IEmptyVolumeCacheCallBack ::P urgeprogress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-purgeprogress), et non [**ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-269">However, note that the **Purge** method must call [**IEmptyVolumeCacheCallBack::PurgeProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-purgeprogress), not [**ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span></span>

### <a name="deactivate"></a><span data-ttu-id="4aaf1-270">Désactivation</span><span class="sxs-lookup"><span data-stu-id="4aaf1-270">Deactivate</span></span>

<span data-ttu-id="4aaf1-271">La méthode [**Deactivate**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-deactivate) est appelée lors de la préparation de l’arrêt du gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-271">The [**Deactivate**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-deactivate) method is called when the disk cleanup manager is preparing to shut down.</span></span> <span data-ttu-id="4aaf1-272">Le gestionnaire doit effectuer les tâches de nettoyage nécessaires et retourner.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-272">The handler should perform any needed cleanup tasks and return.</span></span> <span data-ttu-id="4aaf1-273">Si vous ne souhaitez pas que le gestionnaire soit réexécuté, définissez l’indicateur **EVCF \_ REMOVEFROMLIST** dans le paramètre *pdwFlags* de la méthode d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-273">If you don't want the handler to be run again, set the **EVCF\_REMOVEFROMLIST** flag in the initialization method's *pdwFlags* parameter.</span></span> <span data-ttu-id="4aaf1-274">Si cet indicateur est défini, le gestionnaire de nettoyage de disque supprime le gestionnaire de sa liste et supprime les entrées de Registre du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-274">If this flag is set, the disk cleanup manager removes the handler from its list and deletes the handler's registry entries.</span></span> <span data-ttu-id="4aaf1-275">Vous devez rajouter les entrées de Registre pour exécuter à nouveau le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-275">You must re-add the registry entries to run the handler again.</span></span> <span data-ttu-id="4aaf1-276">Cet indicateur est généralement utilisé pour les gestionnaires qui ne sont exécutés qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-276">This flag is typically used for handlers that are run only once.</span></span>

## <a name="registering-a-disk-cleanup-handler"></a><span data-ttu-id="4aaf1-277">Inscription d’un gestionnaire de nettoyage de disque</span><span class="sxs-lookup"><span data-stu-id="4aaf1-277">Registering a Disk Cleanup Handler</span></span>

<span data-ttu-id="4aaf1-278">Pour ajouter un gestionnaire à la liste du gestionnaire de nettoyage de disque, certaines clés et valeurs doivent être ajoutées au registre Windows.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-278">To add a handler to the disk cleanup manager's list, certain keys and values must be added to the Windows registry.</span></span>

-   [<span data-ttu-id="4aaf1-279">Inscription du CLSID d’un gestionnaire</span><span class="sxs-lookup"><span data-stu-id="4aaf1-279">Registering a Handler's CLSID</span></span>](#registering-a-handlers-clsid)
-   [<span data-ttu-id="4aaf1-280">Inscription d’un gestionnaire à l’aide du gestionnaire de nettoyage de disque : général</span><span class="sxs-lookup"><span data-stu-id="4aaf1-280">Registering a Handler with the Disk Cleanup Manager: General</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-general)
-   [<span data-ttu-id="4aaf1-281">Inscription d’un gestionnaire à l’aide du gestionnaire de nettoyage de disque : systèmes Windows 2000 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="4aaf1-281">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems)
-   [<span data-ttu-id="4aaf1-282">Utilisation de l’objet DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="4aaf1-282">Using the DataDrivenCleaner Object</span></span>](#using-the-datadrivencleaner-object)
-   [<span data-ttu-id="4aaf1-283">Exemple d’inscription d’un gestionnaire de nettoyage de disque</span><span class="sxs-lookup"><span data-stu-id="4aaf1-283">Example Registration of a Disk Cleanup Handler</span></span>](#example-registration-of-a-disk-cleanup-handler)

### <a name="registering-a-handlers-clsid"></a><span data-ttu-id="4aaf1-284">Inscription du CLSID d’un gestionnaire</span><span class="sxs-lookup"><span data-stu-id="4aaf1-284">Registering a Handler's CLSID</span></span>

<span data-ttu-id="4aaf1-285">Comme pour tous les objets COM, le GUID et la DLL de l’objet Handler doivent être enregistrés sous la clé **CLSID** dans la racine de la **\_ classe \_ HKEY**.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-285">As with all COM objects, the handler object's GUID and DLL must be registered under the **CLSID** key in **HKEY\_CLASSES\_ROOT**.</span></span> <span data-ttu-id="4aaf1-286">Vous pouvez également enregistrer une icône qui est affichée en regard du nom du gestionnaire dans la zone de liste du gestionnaire de nettoyage de disque, mais cette option est facultative.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-286">You can also register an icon that is displayed next to the handler's name in the disk cleanup manager's list box, but this is optional.</span></span> <span data-ttu-id="4aaf1-287">L’exemple suivant montre les clés, les valeurs et les données impliquées.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-287">The following example shows the keys, values, and data involved.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      Handler's GUID
         DefaultIcon
            (Default) = Handler's Icon Path, Icon Index
         InprocServer32
            (Default) = Handler's DLL path
            ThreadingModel = Apartment
```

### <a name="registering-a-handler-with-the-disk-cleanup-manager-general"></a><span data-ttu-id="4aaf1-288">Inscription d’un gestionnaire à l’aide du gestionnaire de nettoyage de disque : général</span><span class="sxs-lookup"><span data-stu-id="4aaf1-288">Registering a Handler with the Disk Cleanup Manager: General</span></span>

<span data-ttu-id="4aaf1-289">Pour terminer l’inscription, un gestionnaire doit ajouter une clé contenant ses caractéristiques, comme indiqué ici.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-289">To complete the registration, a handler must add a key holding its specifics as shown here.</span></span> <span data-ttu-id="4aaf1-290">Le reste de cette section décrit le contenu de cette clé.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-290">The remainder of this section discusses the contents of this key.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     Handler's Key
```

<span data-ttu-id="4aaf1-291">En général, le nom de la clé contenant les informations d’un gestionnaire est nommé pour le type de fichier qu’il gère, par exemple les **fichiers programmes téléchargés**, mais ce n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-291">In general, the name of the key holding a handler's particulars is named for the type of file that it handles, such as **Downloaded Program Files**, but this is not a requirement.</span></span> <span data-ttu-id="4aaf1-292">Le tableau suivant détaille les valeurs possibles trouvées sous cette clé.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-292">The following table details the possible values found under this key.</span></span>

> [!Note]  
> <span data-ttu-id="4aaf1-293">Seule la valeur par défaut spécifiant l’identificateur de classe (CLSID) du gestionnaire est obligatoire. toutes les autres valeurs sont facultatives.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-293">Only the Default value specifying the handler's class identifier (CLSID) is required all other values are optional.</span></span>

 



<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="4aaf1-294">Valeur</span><span class="sxs-lookup"><span data-stu-id="4aaf1-294">Value</span></span></th>
<th><span data-ttu-id="4aaf1-295">Type</span><span class="sxs-lookup"><span data-stu-id="4aaf1-295">Type</span></span></th>
<th><span data-ttu-id="4aaf1-296">Signification</span><span class="sxs-lookup"><span data-stu-id="4aaf1-296">Meaning</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="4aaf1-297">Default</span><span class="sxs-lookup"><span data-stu-id="4aaf1-297">Default</span></span></td>
<td><span data-ttu-id="4aaf1-298">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-298">REG_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-299">CLSID du gestionnaire enregistré sous <strong>HKEY_CLASSES_ROOT</strong> \ <strong>CLSID</strong>.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-299">The handler's CLSID as registered under <strong>HKEY_CLASSES_ROOT</strong>\<strong>CLSID</strong>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4aaf1-300">AdvancedButtonText</span><span class="sxs-lookup"><span data-stu-id="4aaf1-300">AdvancedButtonText</span></span></td>
<td><span data-ttu-id="4aaf1-301">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-301">REG_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-302">Texte du bouton facultatif sur lequel les utilisateurs peuvent cliquer pour afficher l’interface utilisateur du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-302">Text for the optional button that users can click to display the handler's UI.</span></span> <span data-ttu-id="4aaf1-303">Le caractère & peut être placé avant un caractère pour affecter un raccourci clavier pour le bouton.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-303">The & character can be placed before a character to assign a keyboard shortcut for the button.</span></span> <span data-ttu-id="4aaf1-304">La valeur AdvancedButtonText est ignorée par les gestionnaires exposant <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2 :: InitializeEx</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-304">The AdvancedButtonText value is ignored by handlers exposing <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a>.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4aaf1-305">CleanupString</span><span class="sxs-lookup"><span data-stu-id="4aaf1-305">CleanupString</span></span></td>
<td><span data-ttu-id="4aaf1-306">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-306">REG_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-307">Ligne de commande spécifiant un fichier exécutable et des paramètres de ligne de commande facultatifs.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-307">Command line specifying an executable file and optional command line parameters.</span></span> <span data-ttu-id="4aaf1-308">Cette ligne de commande est exécutée à la fin du nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-308">This command line is run at the completion of the disk cleanup.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4aaf1-309">CSIDL</span><span class="sxs-lookup"><span data-stu-id="4aaf1-309">CSIDL</span></span></td>
<td><span data-ttu-id="4aaf1-310">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="4aaf1-310">REG_DWORD</span></span></td>
<td><span data-ttu-id="4aaf1-311">Identificateur indépendant du système pour un dossier spécial à inclure dans la recherche de fichiers.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-311">A system-independent identifier for a special folder to include in the file search.</span></span> <span data-ttu-id="4aaf1-312">Cette valeur doit être entrée sous la forme d’une valeur numérique pour l’instance, 0x0000001c plutôt que CSIDL_LOCAL_APPDATA.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-312">This value must be entered as a numerical value for instance, 0x0000001c rather than CSIDL_LOCAL_APPDATA.</span></span> <span data-ttu-id="4aaf1-313">Pour obtenir la liste des valeurs possibles, consultez <a href="/windows/desktop/shell/csidl"><strong>CSIDL</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-313">For a list of possible values, see <a href="/windows/desktop/shell/csidl"><strong>CSIDL</strong></a>.</span></span> <span data-ttu-id="4aaf1-314">Une seule valeur peut être utilisée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-314">Only a single value can be used.</span></span><br/> <span data-ttu-id="4aaf1-315">Si la valeur du dossier est spécifiée, l’emplacement indiqué par la valeur CSIDL est ajouté à ces informations pour composer un chemin de recherche.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-315">If the Folder value is specified, the location indicated by the CSIDL value is prepended to that information to compose a search path.</span></span> <span data-ttu-id="4aaf1-316">Par exemple, considérez le scénario suivant.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-316">For instance, consider the following scenario.</span></span><br/>
<ul>
<li><span data-ttu-id="4aaf1-317">La valeur CSIDL est spécifiée en tant que 0x0000000d (CSIDL_MYMUSIC)</span><span class="sxs-lookup"><span data-stu-id="4aaf1-317">The CSIDL value is specified as 0x0000000d (CSIDL_MYMUSIC)</span></span></li>
<li><span data-ttu-id="4aaf1-318">Votre dossier My Music se trouve dans C:\Documents and Settings \<em>username</em>\Mes Music</span><span class="sxs-lookup"><span data-stu-id="4aaf1-318">Your My Music folder is located at C:\Documents and Settings\<em>username</em>\My Music</span></span></li>
<li><span data-ttu-id="4aaf1-319">La valeur du dossier contient &quot; Jazz\Singers&quot;</span><span class="sxs-lookup"><span data-stu-id="4aaf1-319">The Folder value contains &quot;Jazz\Singers&quot;</span></span></li>
</ul>
<span data-ttu-id="4aaf1-320">Le résultat de ce scénario est que le gestionnaire de nettoyage de disque recherche le dossier C:\Documents and Settings \<em>username</em>\Mes Music\Jazz\Singers</span><span class="sxs-lookup"><span data-stu-id="4aaf1-320">The result of that scenario is that the disk cleanup handler searches the C:\Documents and Settings\<em>username</em>\My Music\Jazz\Singers folder.</span></span> <span data-ttu-id="4aaf1-321">Notez que la barre oblique qui précède la valeur du dossier est ajoutée si elle n’est pas présente.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-321">Note that the slash preceding the Folder value is added if it is not present.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4aaf1-322">Description</span><span class="sxs-lookup"><span data-stu-id="4aaf1-322">Description</span></span></td>
<td><span data-ttu-id="4aaf1-323">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-323">REG_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-324">Texte descriptif affiché sous la zone de liste du gestionnaire de nettoyage de disque lorsque le nom du gestionnaire est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-324">Descriptive text displayed below the disk cleanup manager's list box when the handler's name is selected.</span></span> <span data-ttu-id="4aaf1-325">Ici, vous pouvez expliquer ce que fait le gestionnaire, les fichiers dont il se réagit et tout autre renseignement à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-325">Here you can explain what the handler does, what files it concerns itself with, and any other information elucidatory to the user.</span></span> <span data-ttu-id="4aaf1-326">Si <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2 :: InitializeEx</strong></a> n’est pas exposé par le gestionnaire, ce texte peut être substitué par le biais de la méthode <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache :: Initialize</strong></a> du gestionnaire en spécifiant une autre chaîne dans le paramètre <em>ppwszDescription</em> lorsque la méthode est appelée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-326">If <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a> is not exposed by the handler, this text can be overridden through the handler's <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> method by specifying an alternate string in the <em>ppwszDescription</em> parameter when the method is called.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4aaf1-327">Afficher</span><span class="sxs-lookup"><span data-stu-id="4aaf1-327">Display</span></span></td>
<td><span data-ttu-id="4aaf1-328">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-328">REG_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-329">Nom du gestionnaire à afficher dans la zone de liste du gestionnaire de nettoyage de disque.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-329">The handler's name to be displayed in the disk cleanup manager's list box.</span></span> <span data-ttu-id="4aaf1-330">Si <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2 :: InitializeEx</strong></a> n’est pas exposé par le gestionnaire, ce texte peut être substitué par le biais de la méthode <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache :: Initialize</strong></a> du gestionnaire en spécifiant une autre chaîne dans le paramètre <em>ppwszDisplayName</em> lorsque la méthode est appelée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-330">If <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a> is not exposed by the handler, this text can be overridden through the handler's <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> method by specifying an alternate string in the <em>ppwszDisplayName</em> parameter when the method is called.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4aaf1-331">FileList</span><span class="sxs-lookup"><span data-stu-id="4aaf1-331">FileList</span></span></td>
<td><span data-ttu-id="4aaf1-332">REG_SZ ou REG_MULTI_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-332">REG_SZ or REG_MULTI_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-333">Liste des fichiers recherchés et nettoyés par ce gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-333">A list of files searched for and cleaned by this handler.</span></span> <span data-ttu-id="4aaf1-334">Vous pouvez spécifier des caractères génériques à l’aide de l' ?</span><span class="sxs-lookup"><span data-stu-id="4aaf1-334">You can specify wildcards using the ?</span></span> <span data-ttu-id="4aaf1-335">ou \* caractères.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-335">or \* characters.</span></span> <span data-ttu-id="4aaf1-336">Si la valeur est de type REG_SZ, plusieurs extensions sont séparées à l’aide du | ou : caractères, sans espace de chaque côté.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-336">If the value is of type REG_SZ, multiple extensions are separated using the | or : characters, with no spaces on either side of them.</span></span><br/> <span data-ttu-id="4aaf1-337">Si l’indicateur DDEVCF_REMOVEDIRS est défini dans la valeur flags, ces valeurs peuvent spécifier des noms de répertoire ainsi que des fichiers.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-337">If the DDEVCF_REMOVEDIRS flag is set in the Flags value, these values can specify directory names as well as files.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4aaf1-338">Indicateurs</span><span class="sxs-lookup"><span data-stu-id="4aaf1-338">Flags</span></span></td>
<td><span data-ttu-id="4aaf1-339">REG_DWORD ou REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="4aaf1-339">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="4aaf1-340">Indicateurs contrôlant les éléments de la procédure de recherche et de nettoyage.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-340">Flags controlling elements of the search and cleaning procedure.</span></span> <span data-ttu-id="4aaf1-341">Une ou plusieurs des valeurs suivantes.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-341">One or more of the following values.</span></span>
<ul>
<li><span data-ttu-id="4aaf1-342">DDEVCF_DOSUBDIRS (0x00000001).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-342">DDEVCF_DOSUBDIRS (0x00000001).</span></span> <span data-ttu-id="4aaf1-343">Recherchez et supprimez de manière récursive.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-343">Search and remove recursively.</span></span></li>
<li><span data-ttu-id="4aaf1-344">DDEVCF_REMOVEAFTERCLEAN (0x00000002).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-344">DDEVCF_REMOVEAFTERCLEAN (0x00000002).</span></span> <span data-ttu-id="4aaf1-345">Après l’exécution du gestionnaire, supprimez-le du Registre.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-345">After the handler is run once, remove it from the registry.</span></span></li>
<li><span data-ttu-id="4aaf1-346">DDEVCF_REMOVEREADONLY (0x00000004).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-346">DDEVCF_REMOVEREADONLY (0x00000004).</span></span> <span data-ttu-id="4aaf1-347">Supprimer les fichiers qui répondent aux critères de recherche, même s’ils sont en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-347">Remove files that meet the search criteria even if they are read-only.</span></span></li>
<li><span data-ttu-id="4aaf1-348">DDEVCF_REMOVESYSTEM (0x00000008).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-348">DDEVCF_REMOVESYSTEM (0x00000008).</span></span> <span data-ttu-id="4aaf1-349">Supprimer les fichiers qui répondent aux critères de recherche, même s’il s’agit de fichiers système.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-349">Remove files that meet the search criteria even if they are system files.</span></span></li>
<li><span data-ttu-id="4aaf1-350">DDEVCF_REMOVEHIDDEN (0x00000010).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-350">DDEVCF_REMOVEHIDDEN (0x00000010).</span></span> <span data-ttu-id="4aaf1-351">Supprimer les fichiers qui répondent aux critères de recherche, même s’il s’agit de fichiers cachés.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-351">Remove files that meet the search criteria even if they are hidden files.</span></span></li>
<li><span data-ttu-id="4aaf1-352">DDEVCF_DONTSHOWIFZERO (0x00000020).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-352">DDEVCF_DONTSHOWIFZERO (0x00000020).</span></span> <span data-ttu-id="4aaf1-353">Ne pas afficher ce gestionnaire dans le gestionnaire de nettoyage de disque si aucun fichier ne correspond à ses critères de recherche.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-353">Do not display this handler in the disk cleanup manager if no files match its search criteria.</span></span></li>
<li><span data-ttu-id="4aaf1-354">DDEVCF_REMOVEDIRS (0x00000040).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-354">DDEVCF_REMOVEDIRS (0x00000040).</span></span> <span data-ttu-id="4aaf1-355">Faire correspondre la valeur FileList aux répertoires et supprimer les correspondances et tous leurs sous-répertoires.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-355">Match the FileList value against directories and remove matches and all of their subdirectories.</span></span></li>
<li><span data-ttu-id="4aaf1-356">DDEVCF_RUNIFOUTOFDISKSPACE (0x00000080).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-356">DDEVCF_RUNIFOUTOFDISKSPACE (0x00000080).</span></span> <span data-ttu-id="4aaf1-357">Exécutez ce gestionnaire uniquement si l’espace disque disponible est tombé en dessous de la valeur critique, déterminé par le gestionnaire de nettoyage de disque qui définit l’indicateur de EVCF_OUTOFDISKSPACE via <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache :: Initialize</strong></a> ou <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2 :: InitializeEx</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-357">Run this handler only if available disk space has fallen below the critical value, determined by the disk cleanup manager setting the EVCF_OUTOFDISKSPACE flag through <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> or <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a>.</span></span></li>
<li><span data-ttu-id="4aaf1-358">DDEVCF_REMOVEPARENTDIR (0x00000100).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-358">DDEVCF_REMOVEPARENTDIR (0x00000100).</span></span> <span data-ttu-id="4aaf1-359">Supprime le répertoire parent des fichiers spécifiés une fois le nettoyeur exécuté.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-359">Remove the parent directory of the specified files once the cleaner has run.</span></span></li>
<li><span data-ttu-id="4aaf1-360">DDEVCF_PRIVATE_LASTACCESS (0x10000000).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-360">DDEVCF_PRIVATE_LASTACCESS (0x10000000).</span></span> <span data-ttu-id="4aaf1-361">Utilisez la valeur LastAccess, si elle est fournie, pour déterminer les fichiers qui doivent être nettoyés.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-361">Use the LastAccess value, if provided, in ascertaining which files should be cleaned.</span></span> <span data-ttu-id="4aaf1-362">Cet indicateur est ignoré lors de l’utilisation de <a href="#using-the-datadrivencleaner-object">DataDrivenCleaner</a> toute valeur LastAccess fournie est toujours utilisée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-362">This flag is ignored when using the <a href="#using-the-datadrivencleaner-object">DataDrivenCleaner</a> any provided LastAccess value is always used.</span></span></li>
</ul></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4aaf1-363">Dossier</span><span class="sxs-lookup"><span data-stu-id="4aaf1-363">Folder</span></span></td>
<td><span data-ttu-id="4aaf1-364">REG_SZ, REG_MULTI_SZ ou REG_EXPAND_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-364">REG_SZ, REG_MULTI_SZ, or REG_EXPAND_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-365">Dossier ou dossiers spécifiques dans lesquels rechercher les éléments correspondant aux entrées de la valeur FileList.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-365">A specific folder or folders to search for items matching entries in the FileList value.</span></span> <span data-ttu-id="4aaf1-366">Vous pouvez spécifier des caractères génériques à l’aide de l' ?</span><span class="sxs-lookup"><span data-stu-id="4aaf1-366">You can specify wildcards using the ?</span></span> <span data-ttu-id="4aaf1-367">ou \* caractères.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-367">or \* characters.</span></span> <span data-ttu-id="4aaf1-368">Si la valeur est de type REG_SZ, plusieurs noms de dossiers sont séparés à l’aide du | caractère, sans espaces de part et d’autre.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-368">If the value is of type REG_SZ, multiple folder names are separated using the | character, without spaces on either side of it.</span></span><br/> <span data-ttu-id="4aaf1-369">Si une valeur CSIDL est présente, un seul dossier peut être spécifié dans cette valeur.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-369">If a CSIDL value is present, only one folder can be specified in this value.</span></span> <span data-ttu-id="4aaf1-370">L’emplacement indiqué par la valeur CSIDL est ajouté au début de ce chemin d’accès de dossier pour composer un chemin de recherche.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-370">The location indicated by the CSIDL value is prepended to that folder path to compose a search path.</span></span> <span data-ttu-id="4aaf1-371">Pour obtenir un exemple, consultez la description de la valeur CSIDL.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-371">For an example, see the CSIDL value description.</span></span><br/> <span data-ttu-id="4aaf1-372">Si cette valeur est absente de Windows Vista Service Pack 1 (SP1) et versions ultérieures, le gestionnaire de nettoyage est ignoré et retourne S_FALSE lors de l’initialisation.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-372">If this value is absent on Windows Vista Service Pack 1 (SP1) and later, the cleanup handler is ignored and it returns S_FALSE on initialization.</span></span><br/> <span data-ttu-id="4aaf1-373">Si cette valeur est absente de la version d’origine de Windows Vista et des versions antérieures, le dossier racine du volume actuel est utilisé.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-373">If this value is absent on the original release of Windows Vista and earlier, the root folder of the current volume is used.</span></span> <span data-ttu-id="4aaf1-374">L’indicateur DDEVCF_DOSUBDIRS est nécessaire dans ce cas pour effectuer une recherche dans l’ensemble du lecteur.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-374">The DDEVCF_DOSUBDIRS flag is needed in that case to search the entire drive.</span></span> <span data-ttu-id="4aaf1-375">Sans cela, seul le dossier racine est recherché.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-375">Without it, only the root folder itself is searched.</span></span><br/> <span data-ttu-id="4aaf1-376">Vous devez spécifier un ou des lecteurs.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-376">A drive or drives must be specified.</span></span> <span data-ttu-id="4aaf1-377">Cela peut être fourni par le biais de la valeur CSIDL ou par le biais d’une chaîne REG_EXPAND_SZ.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-377">This can be provided through the CSIDL value or through a REG_EXPAND_SZ string.</span></span> <span data-ttu-id="4aaf1-378">En excluant ces options, le lecteur à rechercher doit être spécifié dans le nom du dossier.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-378">Barring those options, however, the drive to search must be specified in the folder name.</span></span> <span data-ttu-id="4aaf1-379">Utilisez ?: pour rechercher le dossier sur le lecteur actif.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-379">Use ?: to search the folder on the current drive.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4aaf1-380">IconPath</span><span class="sxs-lookup"><span data-stu-id="4aaf1-380">IconPath</span></span></td>
<td><span data-ttu-id="4aaf1-381">REG_SZ ou REG_EXPAND_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-381">REG_SZ or REG_EXPAND_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-382">Chemin d’accès à la ressource à partir de laquelle obtenir une icône à utiliser en association avec le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-382">The path to the resource from which to obtain an icon to use in association with the handler.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4aaf1-383">LastAccess</span><span class="sxs-lookup"><span data-stu-id="4aaf1-383">LastAccess</span></span></td>
<td><span data-ttu-id="4aaf1-384">REG_DWORD ou REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="4aaf1-384">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="4aaf1-385">Nombre de jours qui doivent s’écouler depuis le dernier accès à un fichier ou lors de la création d’un répertoire pour ce fichier ou ce répertoire en vue du nettoyage.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-385">The number of days that must have elapsed since a file was last accessed or a directory was created for that file or directory to be considered for cleanup.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4aaf1-386">Priority</span><span class="sxs-lookup"><span data-stu-id="4aaf1-386">Priority</span></span></td>
<td><span data-ttu-id="4aaf1-387">REG_DWORD ou REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="4aaf1-387">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="4aaf1-388">Détermine l’ordre d’exécution du gestionnaire par rapport à d’autres gestionnaires.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-388">Determines the order that the handler is run with respect to other handlers.</span></span> <span data-ttu-id="4aaf1-389">Plus le nombre est élevé, plus il est haut dans le processus exécuté par le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-389">The higher the number, the earlier in the process that the handler runs.</span></span> <span data-ttu-id="4aaf1-390">Il n’existe aucune plage définie. aucun nombre n’est acceptable.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-390">There is no defined range any number is acceptable.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="4aaf1-391">PropertyBag</span><span class="sxs-lookup"><span data-stu-id="4aaf1-391">PropertyBag</span></span></td>
<td><span data-ttu-id="4aaf1-392">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="4aaf1-392">REG_SZ</span></span></td>
<td><span data-ttu-id="4aaf1-393">CLSID d’une ressource utilisée pour fournir du texte localisé pour le nom complet, la description et le texte du bouton.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-393">The CLSID of a resource used to provide localized text for the display name, description, and button text.</span></span> <span data-ttu-id="4aaf1-394">Cette ressource est utile dans le cas où un gestionnaire n’implémente pas <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache"><strong>IEmptyVolumeCache</strong></a> et que le gestionnaire est exécuté sous Microsoft Windows NT ou Windows XP.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-394">This resource is useful in the situation where a handler does not implement <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache"><strong>IEmptyVolumeCache</strong></a> and the handler is being run under Microsoft Windows NT or Windows XP.</span></span><br/> <span data-ttu-id="4aaf1-395">Le gestionnaire de nettoyage de disque vérifie d’abord si la routine d’initialisation du gestionnaire a retourné ces chaînes, comme c’est le cas lors de l’implémentation de <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2"><strong>IEmptyVolumeCache2</strong></a> .</span><span class="sxs-lookup"><span data-stu-id="4aaf1-395">The disk cleanup manager first checks whether the handler's initialization routine returned those strings, as would be the case when <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2"><strong>IEmptyVolumeCache2</strong></a> is implemented.</span></span> <span data-ttu-id="4aaf1-396">À l’échec, le gestionnaire se transforme en un conteneur de propriétés nommé dans cette valeur.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-396">Failing that, the manager next turns to a property bag named in this value.</span></span> <span data-ttu-id="4aaf1-397">Si aucun n’a été fourni, il récupère le texte à partir du Registre.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-397">If none has been provided, it retrieves the text from the registry.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="4aaf1-398">StateFlags</span><span class="sxs-lookup"><span data-stu-id="4aaf1-398">StateFlags</span></span></td>
<td><span data-ttu-id="4aaf1-399">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="4aaf1-399">REG_DWORD</span></span></td>
<td><span data-ttu-id="4aaf1-400">En exécutant le fichier exécutable du gestionnaire de nettoyage de disque Cleanmgr.exe à partir d’une ligne de commande, vous pouvez déclarer des <em>profils</em>de nettoyage.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-400">By running the disk cleanup manager's executable file Cleanmgr.exe from a command line, you can declare cleanup <em>profiles</em>.</span></span> <span data-ttu-id="4aaf1-401">Ces profils sont composés d’un sous-ensemble des gestionnaires disponibles et reçoivent une étiquette numérique unique.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-401">These profiles are composed of a subset of the available handlers and are given a unique numeric label.</span></span> <span data-ttu-id="4aaf1-402">Cela vous permet d’automatiser l’exécution de différents jeux de gestionnaires à des moments différents.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-402">This allows you to automate the running of different sets of handlers at different times.</span></span><br/> <span data-ttu-id="4aaf1-403">La ligne de commande &quot;cleanmgr.exe/sageset :<strong>nnnn</strong> &quot; , où <strong>nnnn</strong> est une étiquette numérique unique, affiche une interface utilisateur qui vous permet de choisir les gestionnaires à inclure dans ce profil.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-403">The command line &quot;cleanmgr.exe /sageset:<strong>nnnn</strong>&quot;, where <strong>nnnn</strong> is a unique numeric label, displays a UI allowing you to choose the handlers to be included in that profile.</span></span> <span data-ttu-id="4aaf1-404">En plus de définir le profil, le paramètre sageset écrit également une valeur nommée StateFlags<strong>nnnn</strong>, où <strong>nnnn</strong> est l’étiquette que vous avez utilisée dans le paramètre, à toutes les sous-clés sous <strong>VolumeCaches</strong>.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-404">As well as defining the profile, the sageset parameter also writes a value named StateFlags<strong>nnnn</strong>, where <strong>nnnn</strong> is the label you used in the parameter, to all of the subkeys under <strong>VolumeCaches</strong>.</span></span> <span data-ttu-id="4aaf1-405">Il existe deux valeurs de données possibles pour ces entrées.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-405">There are two possible data values for those entries.</span></span>
<ul>
<li><span data-ttu-id="4aaf1-406">0 : n’exécutez pas ce gestionnaire lors de l’exécution de ce profil.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-406">0: Do not run this handler when this profile is run.</span></span></li>
<li><span data-ttu-id="4aaf1-407">2 : inclure ce gestionnaire lors de l’exécution de ce profil.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-407">2: Include this handler when this profile is run.</span></span></li>
</ul>
<br/> <span data-ttu-id="4aaf1-408">Par exemple, supposons que la ligne de commande &quot;cleanmgr.exe/sageset : 1234 &quot; soit exécutée.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-408">For example, suppose that the command line &quot;cleanmgr.exe /sageset:1234&quot; is run.</span></span> <span data-ttu-id="4aaf1-409">Dans l’interface utilisateur présentée, l’utilisateur choisit <strong>fichiers programmes téléchargés</strong>, mais ne choisit pas <strong>fichiers Internet temporaires</strong>.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-409">In the UI that is presented, the user chooses <strong>Downloaded Program Files</strong>, but does not choose <strong>Temporary Internet Files</strong>.</span></span> <span data-ttu-id="4aaf1-410">Les valeurs suivantes sont ensuite écrites dans le registre.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-410">The following values are then written to the registry.</span></span><br/>
<pre data-space="preserve"><code>HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     Downloaded Program Files
                        StateFlags1234 = 0x00000002
                     Internet Cache Files
                        StateFlags1234 = 0x00000000</code></pre>
<br/> <span data-ttu-id="4aaf1-411">La ligne &quot; de commandecleanmgr.exe/sagerun :<strong>nnnn</strong> &quot; , où la valeur de <strong>nnnn</strong> correspond à l’étiquette déclarée avec le paramètre sageset, exécute tous les gestionnaires sélectionnés dans ce profil.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-411">The command line &quot;cleanmgr.exe /sagerun:<strong>nnnn</strong>&quot;, where the value of <strong>nnnn</strong> matches the label declared with the sageset parameter, runs all of the handlers selected in that profile.</span></span><br/> <span data-ttu-id="4aaf1-412">Une valeur StateFlags générique est écrite dans le registre lorsque le nettoyage de disque est exécuté normalement.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-412">A generic StateFlags value is written to the registry when Disk Cleanup is run normally.</span></span> <span data-ttu-id="4aaf1-413">Cette valeur stocke simplement l’État (activé ou désactivé) du gestionnaire la dernière fois qu’il a été présenté en tant qu’option à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-413">This value simply stores the state (checked or unchecked) of the handler the last time it was presented as an option to the user.</span></span> <span data-ttu-id="4aaf1-414">Il existe deux valeurs de données possibles pour ces entrées.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-414">There are two possible data values for those entries.</span></span>
<ul>
<li><span data-ttu-id="4aaf1-415">0 : le gestionnaire n’a pas été sélectionné.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-415">0: The handler was not selected.</span></span></li>
<li><span data-ttu-id="4aaf1-416">1 : le gestionnaire a été sélectionné.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-416">1: The handler was selected.</span></span></li>
</ul>
<br/></td>
</tr>
</tbody>
</table>



 

### <a name="registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems"></a><span data-ttu-id="4aaf1-417">Inscription d’un gestionnaire à l’aide du gestionnaire de nettoyage de disque : systèmes Windows 2000 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="4aaf1-417">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>

<span data-ttu-id="4aaf1-418">La spécification du texte affiché dans le registre peut compliquer la localisation des logiciels.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-418">Specifying display text in the registry can make it difficult to localize software.</span></span> <span data-ttu-id="4aaf1-419">Pour cette raison, Windows 2000 et Windows XP prennent en charge l’interface [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) avec sa méthode d’initialisation préférée [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-419">For this reason, Windows 2000 and Windows XP support the [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) interface with its preferred initialization method [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span></span> <span data-ttu-id="4aaf1-420">Sous Windows 2000 ou une version ultérieure, une tentative est toujours effectuée pour appeler **IEmptyVolumeCache2 :: InitializeEx** avant [**IEmptyVolumeCache :: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-420">Under Windows 2000 or later, an attempt is always made to call **IEmptyVolumeCache2::InitializeEx** before [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize).</span></span> <span data-ttu-id="4aaf1-421">Le système utilise uniquement **Initialize** pour initialiser un gestionnaire si **IEmptyVolumeCache2** n’est pas exposé.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-421">The system only uses **Initialize** to initialize a handler if **IEmptyVolumeCache2** is not exposed.</span></span>

<span data-ttu-id="4aaf1-422">En ce qui concerne le registre, la seule différence sous Windows 2000 ou version ultérieure est que vous pouvez omettre les valeurs AdvancedButtonText, Display et description lorsque [**IEmptyVolumeCache2 :: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) est exposé par le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-422">In regard to the registry, the only difference under Windows 2000 or later is that you can omit the AdvancedButtonText, Display, and Description values when [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) is exposed by the handler.</span></span> <span data-ttu-id="4aaf1-423">Ces valeurs, contenant du texte correctement localisé, sont fournies au gestionnaire de nettoyage de disque lors de l’appel de **InitializeEx**.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-423">Those values, containing properly localized text, are provided to the disk cleanup manager when it calls **InitializeEx**.</span></span>

### <a name="using-the-datadrivencleaner-object"></a><span data-ttu-id="4aaf1-424">Utilisation de l’objet DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="4aaf1-424">Using the DataDrivenCleaner Object</span></span>

<span data-ttu-id="4aaf1-425">Un gestionnaire de nettoyage de disque de base, appelé DataDrivenCleaner, est fourni par le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-425">A basic disk cleanup handler, called the DataDrivenCleaner, is provided by the operating system.</span></span> <span data-ttu-id="4aaf1-426">Pour utiliser cet objet en tant que gestionnaire plutôt que d’implémenter le vôtre, utilisez le CLSID {C0E13E61-0CC6-11d1-BBB6-0060978B2AE6} comme valeur par défaut pour la sous-clé du gestionnaire sous **VolumeCaches** , comme décrit dans [inscription d’un gestionnaire à l’aide du gestionnaire de nettoyage de disque : général](#registering-a-handler-with-the-disk-cleanup-manager-general).</span><span class="sxs-lookup"><span data-stu-id="4aaf1-426">To use this object as a handler rather than implementing your own, use the CLSID {C0E13E61-0CC6-11d1-BBB6-0060978B2AE6} as the Default value for the handler's subkey under **VolumeCaches** as described in [Registering a Handler with the Disk Cleanup Manager: General](#registering-a-handler-with-the-disk-cleanup-manager-general).</span></span>

<span data-ttu-id="4aaf1-427">DataDrivenCleaner n’expose pas [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), de sorte que les valeurs d’affichage et de description sont fournies par le biais du Registre.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-427">The DataDrivenCleaner does not expose [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), so the Display and Description values are provided through the registry.</span></span> <span data-ttu-id="4aaf1-428">Lorsque vous déclarez ces chaînes, sachez que cela peut entraîner des problèmes de localisation.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-428">When declaring those strings, be aware that this could cause localization issues.</span></span> <span data-ttu-id="4aaf1-429">Le texte localisé peut être fourni via la valeur PropertyBag.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-429">Localized text can be provided through the PropertyBag value.</span></span> <span data-ttu-id="4aaf1-430">La valeur AdvancedButtonText est ignorée, car aucune interface utilisateur, et donc aucun bouton pour l’afficher, est disponible pour ce gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-430">The AdvancedButtonText value is ignored since no UI, and thus no button to display it, is available for this handler.</span></span>

### <a name="example-registration-of-a-disk-cleanup-handler"></a><span data-ttu-id="4aaf1-431">Exemple d’inscription d’un gestionnaire de nettoyage de disque</span><span class="sxs-lookup"><span data-stu-id="4aaf1-431">Example Registration of a Disk Cleanup Handler</span></span>

<span data-ttu-id="4aaf1-432">Le code suivant montre un exemple d’inscription pour un gestionnaire de nettoyage de disque implémenté par l’entreprise de téléphone.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-432">The following shows an example registration for a disk cleanup handler implemented by The Phone Company.</span></span> <span data-ttu-id="4aaf1-433">Ce gestionnaire implémente à la fois [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) et [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), et fournit donc des valeurs AdvancedButtonText, description et Display en cas d’utilisation sur un ordinateur exécutant Windows 98.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-433">This handler implements both [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) and [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), and so provides AdvancedButtonText, Description, and Display values in case it is used on a computer running Windows 98.</span></span> <span data-ttu-id="4aaf1-434">Le gestionnaire combine les valeurs de l’option CSIDL et du dossier pour rechercher des fichiers dans le fichier C : \\ Program Files \\ du répertoire Temp de la société \\ , et l' \_ indicateur DDEVCF DOSUBDIRS est défini de sorte que la recherche s’effectue également dans ses sous-répertoires.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-434">The handler combines the CSIDL and Folder values to search for files in the C:\\Program Files\\The Phone Company\\Temp directory, and the DDEVCF\_DOSUBDIRS flag is set so that its subdirectories are also searched.</span></span> <span data-ttu-id="4aaf1-435">Seuls les fichiers avec les extensions. tmp et. TPC sont pris en compte pour le nettoyage, et l' \_ indicateur DDEVCF Private \_ LASTACCESS est défini de sorte que seuls les fichiers qui n’ont pas été consultés depuis 14 jours ou plus soient pris en compte.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-435">Only those files with .tmp and .tpc extensions are considered for cleanup, and the DDEVCF\_PRIVATE\_LASTACCESS flag is set so that out of those files, only those that have not been accessed for 14 days or more are considered.</span></span> <span data-ttu-id="4aaf1-436">L' \_ indicateur DDEVCF DONTSHOWIFZERO est également défini de sorte que le gestionnaire n’apparaisse pas dans la liste, sauf s’il a trouvé des candidats aux nettoyages.</span><span class="sxs-lookup"><span data-stu-id="4aaf1-436">The DDEVCF\_DONTSHOWIFZERO flag is also set so that the handler does not appear on the list unless it has found cleanup candidates.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     The Phone Company Files
                        (Default) = {the CLSID GUID}
                        AdvancedButtonText = &View Files
                        CleanupString = c:\tpc.exe
                        CSIDL = 0x00000026
                        Description = Old temporary files.
                        Display = The Phone Company Files
                        FileList = *.tmp|*.tpc
                        Flags = 0x10000021
                        Folder = \The Phone Company\Temp
                        IconPath = c:\Program Files\The Phone Company\tpc.dll,2
                        LastAccess = 0x0000000e
                        Priority = 200
                        PropertyBag = {Property Bag CLSID GUID}
```

 

