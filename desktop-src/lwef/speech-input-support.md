---
title: Prise en charge des entrées vocales
description: Prise en charge des entrées vocales
ms.assetid: 4702b941-fcc9-4d00-aba2-eca624b6d417
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8ecb6f2ddfbbe10f8b892ce922cd466eca96890
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "106513717"
---
# <a name="speech-input-support"></a><span data-ttu-id="705a1-103">Prise en charge des entrées vocales</span><span class="sxs-lookup"><span data-stu-id="705a1-103">Speech Input Support</span></span>

<span data-ttu-id="705a1-104">\[Microsoft Agent est déconseillé à partir de Windows 7 et peut ne pas être disponible dans les versions ultérieures de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="705a1-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="705a1-105">Outre la prise en charge de l’interaction de la souris et du clavier, Microsoft Agent offre une prise en charge directe des entrées vocales.</span><span class="sxs-lookup"><span data-stu-id="705a1-105">In addition to supporting mouse and keyboard interaction, Microsoft Agent includes direct support for speech input.</span></span> <span data-ttu-id="705a1-106">Étant donné que la prise en charge de l’entrée vocale par Microsoft Agent est basée sur Microsoft SAPI (Speech Application Programming Interface), vous pouvez utiliser Microsoft Agent avec la commande de reconnaissance vocale et les moteurs de contrôle qui incluent la prise en charge de SAPI-required.</span><span class="sxs-lookup"><span data-stu-id="705a1-106">Because Microsoft Agent's support for speech input is based on Microsoft SAPI (Speech Application Programming Interface), you can use Microsoft Agent with speech recognition command and control engines that include the SAPI-required support.</span></span> <span data-ttu-id="705a1-107">Pour plus d’informations sur la configuration requise du moteur de reconnaissance vocale, consultez [spécifications de prise en charge du moteur vocal](requirements-for-speech-recognition-engines.md).</span><span class="sxs-lookup"><span data-stu-id="705a1-107">For more information on speech engine requirements, see [Speech Engine Support Requirements](requirements-for-speech-recognition-engines.md).</span></span>

<span data-ttu-id="705a1-108">Microsoft fournit un moteur de reconnaissance vocale de contrôle et de commande que vous pouvez utiliser avec Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="705a1-108">Microsoft provides a command-and-control speech recognition engine you can use with Microsoft Agent.</span></span> <span data-ttu-id="705a1-109">Pour plus d’informations, consultez [sélection du moteur de reconnaissance vocale](speech-engine-selection.md).</span><span class="sxs-lookup"><span data-stu-id="705a1-109">For more information, see [Speech Engine Selection](speech-engine-selection.md).</span></span>

<span data-ttu-id="705a1-110">L’utilisateur peut lancer des entrées vocales en appuyant sur le raccourci d’écoute Push-to-débats et en le maintenant enfoncé.</span><span class="sxs-lookup"><span data-stu-id="705a1-110">The user can initiate speech input by pressing and holding the push-to-talk Listening hotkey.</span></span> <span data-ttu-id="705a1-111">Dans ce mode d’écoute, si le moteur de reconnaissance vocale reçoit le début de l’entrée parlée, il maintient le canal audio ouvert jusqu’à ce qu’il détecte la fin de l’énoncé.</span><span class="sxs-lookup"><span data-stu-id="705a1-111">In this Listening mode, if the speech engine receives the beginning of spoken input, it holds the audio channel open until it detects the end of the utterance.</span></span> <span data-ttu-id="705a1-112">Toutefois, lorsqu’il ne reçoit pas d’entrée, il ne bloque pas la sortie audio.</span><span class="sxs-lookup"><span data-stu-id="705a1-112">However, when not receiving input, it does not block audio output.</span></span> <span data-ttu-id="705a1-113">Cela permet à l’utilisateur d’émettre plusieurs commandes vocales tout en maintenant la touche enfoncée, et le caractère peut répondre lorsque l’utilisateur n’est pas en train de parler.</span><span class="sxs-lookup"><span data-stu-id="705a1-113">This enables the user to issue multiple voice commands while holding down the key, and the character can respond when the user isn't speaking.</span></span>

<span data-ttu-id="705a1-114">Le mode d’écoute expire une fois que l’utilisateur relâche la touche d’écoute.</span><span class="sxs-lookup"><span data-stu-id="705a1-114">The Listening mode times out once the user releases the Listening key.</span></span> <span data-ttu-id="705a1-115">L’utilisateur peut ajuster le délai d’expiration pour ce mode à l’aide des options de caractères avancés.</span><span class="sxs-lookup"><span data-stu-id="705a1-115">The user can adjust the time-out for this mode using the Advanced Character Options.</span></span> <span data-ttu-id="705a1-116">Vous ne pouvez pas définir ce délai d’attente à partir du code de votre application cliente.</span><span class="sxs-lookup"><span data-stu-id="705a1-116">You cannot set this time-out from your client application code.</span></span>

<span data-ttu-id="705a1-117">Si un caractère tente de parler pendant que l’utilisateur parle, la sortie audible du caractère échoue bien que le texte puisse toujours s’afficher dans sa bulle de mot.</span><span class="sxs-lookup"><span data-stu-id="705a1-117">If a character attempts to speak while the user is speaking, the character's audible output fails though text may still be displayed in its word balloon.</span></span> <span data-ttu-id="705a1-118">Si le caractère est le canal audio pendant que la touche d’écoute est enfoncée, le serveur transfère automatiquement le contrôle à l’utilisateur après le traitement du texte dans la méthode [**Speak**](speak-method.md) .</span><span class="sxs-lookup"><span data-stu-id="705a1-118">If the character has the audio channel while the Listening key is pressed, the server automatically transfers control back to the user after processing the text in the [**Speak**](speak-method.md) method.</span></span> <span data-ttu-id="705a1-119">Un ton MIDI facultatif est joué pour signaler à l’utilisateur de commencer à parler.</span><span class="sxs-lookup"><span data-stu-id="705a1-119">An optional MIDI tone is played to cue the user to begin speaking.</span></span> <span data-ttu-id="705a1-120">Cela permet à l’utilisateur de fournir une entrée même si l’application qui pilote le caractère n’a pas pu fournir des pauses logiques dans sa sortie.</span><span class="sxs-lookup"><span data-stu-id="705a1-120">This enables the user to provide input even if the application driving the character failed to provide logical pauses in its output.</span></span>

<span data-ttu-id="705a1-121">Vous pouvez également utiliser la méthode [**Listen**](listen-method.md) pour initier une entrée vocale.</span><span class="sxs-lookup"><span data-stu-id="705a1-121">You can also use the [**Listen**](listen-method.md) method to initiate speech input.</span></span> <span data-ttu-id="705a1-122">L’appel de cette méthode active la reconnaissance vocale pour une période prédéfinie.</span><span class="sxs-lookup"><span data-stu-id="705a1-122">Calling this method turns on the speech recognition for a predefined period of time.</span></span> <span data-ttu-id="705a1-123">S’il n’y a aucune entrée au cours de cet intervalle, Microsoft Agent désactive automatiquement le moteur de reconnaissance vocale et libère le canal audio.</span><span class="sxs-lookup"><span data-stu-id="705a1-123">If there is no input during this interval, Microsoft Agent automatically turns off the speech recognition engine and frees up the audio channel.</span></span> <span data-ttu-id="705a1-124">Cela évite le blocage de l’entrée ou de la sortie du périphérique audio et minimise la surcharge du processeur que la reconnaissance vocale utilise lorsqu’elle est activée.</span><span class="sxs-lookup"><span data-stu-id="705a1-124">This avoids blocking input to or output from the audio device and minimizes the processor overhead the speech recognition uses when it is on.</span></span> <span data-ttu-id="705a1-125">Vous pouvez également utiliser la méthode **Listen** pour désactiver l’entrée vocale.</span><span class="sxs-lookup"><span data-stu-id="705a1-125">You can also use the **Listen** method to turn off speech input.</span></span> <span data-ttu-id="705a1-126">Toutefois, gardez à l’esprit que, étant donné que le moteur de reconnaissance vocale fonctionne de façon asynchrone, l’effet peut ne pas être immédiat.</span><span class="sxs-lookup"><span data-stu-id="705a1-126">However, be aware that because the speech recognition engine operates asynchronously, the effect may not be immediate.</span></span> <span data-ttu-id="705a1-127">Par conséquent, il est possible de recevoir un événement de [**commande**](command-event.md) même après que votre code a appelé **Listen** pour désactiver l’entrée vocale.</span><span class="sxs-lookup"><span data-stu-id="705a1-127">As a result, it is possible to receive a [**Command**](command-event.md) event even after your code called **Listen** to turn off speech input.</span></span>

<span data-ttu-id="705a1-128">Pour prendre en charge l’entrée vocale, vous définissez une *grammaire*, un ensemble de mots que le moteur de reconnaissance vocale doit écouter et faire correspondre comme paramètre **vocal** pour une [**commande**](/windows/desktop/lwef/the-command-object) dans votre collection de [**commandes**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="705a1-128">To support speech input, you define a *grammar*, a set of words you want the speech recognition engine to listen and match for as the **Voice** setting for a [**Command**](/windows/desktop/lwef/the-command-object) in your [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="705a1-129">Vous pouvez inclure des mots facultatifs et alternatifs et des séquences répétées dans votre grammaire.</span><span class="sxs-lookup"><span data-stu-id="705a1-129">You can include optional and alternative words and repeated sequences in your grammar.</span></span> <span data-ttu-id="705a1-130">Notez que l’agent n’active pas la touche d’accès rapide d’écoute tant que l’un de ses clients n’a pas chargé avec succès un moteur de reconnaissance vocale ou a créé une **voix** pour l’un de ses objets de **commande** .</span><span class="sxs-lookup"><span data-stu-id="705a1-130">Note that Agent does not enable the Listening hotkey until one of its clients has successfully loaded a speech engine or has authored a **Voice** for one of its **Command** objects.</span></span>

<span data-ttu-id="705a1-131">Que l’utilisateur appuie sur la touche d’écoute ou que votre application cliente appelle la méthode [**Listen**](listen-method.md) pour initier l’entrée vocale, le moteur de reconnaissance vocale tente de faire correspondre l’entrée d’un énoncé d’énoncé à la grammaire pour les commandes qui ont été définies et transmet les informations au serveur.</span><span class="sxs-lookup"><span data-stu-id="705a1-131">Whether the user presses the Listening hotkey or your client application calls the [**Listen**](listen-method.md) method to initiate speech input, the speech recognition engine attempts to match an utterance's input to the grammar for the commands that have been defined, and passes the information back the server.</span></span> <span data-ttu-id="705a1-132">Le serveur notifie ensuite l’application cliente à l’aide de l’événement de [**commande**](command-event.md) ([**IAgentNotifySink :: Command**](iagentnotifysink--command.md)); retour de l’objet [**UserInput**](/windows/desktop/lwef/iagentuserinput) qui comprend l’ID de commande de la meilleure correspondance et les deux autres correspondances (le cas échéant), un score de confiance et le texte correspondant pour chaque correspondance.</span><span class="sxs-lookup"><span data-stu-id="705a1-132">The server then notifies the client application using the [**Command**](command-event.md) event ([**IAgentNotifySink::Command**](iagentnotifysink--command.md)); passing back the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object that includes the command ID of the best match and next two alternative matches (if any), a confidence score, and the matching text for each match.</span></span>

<span data-ttu-id="705a1-133">Le serveur signale également à votre application cliente qu’elle met en correspondance l’entrée vocale avec l’une des commandes fournies.</span><span class="sxs-lookup"><span data-stu-id="705a1-133">The server also notifies your client application when it matches the speech input to one of its supplied commands.</span></span> <span data-ttu-id="705a1-134">Si l’ID de commande est **null**, vous obtenez toujours le score de confiance et le texte correspondant.</span><span class="sxs-lookup"><span data-stu-id="705a1-134">While the command ID is **NULL**, you still get the confidence score and text matched.</span></span> <span data-ttu-id="705a1-135">En mode d’écoute, le serveur lit automatiquement l’animation assignée à l’état d' **écoute** du caractère.</span><span class="sxs-lookup"><span data-stu-id="705a1-135">When in Listening mode, the server automatically plays the animation assigned to the character's **Listening** state.</span></span> <span data-ttu-id="705a1-136">Ensuite, lorsqu’un énoncé est effectivement détecté, le serveur lit l’animation de l’état **auditif** du caractère.</span><span class="sxs-lookup"><span data-stu-id="705a1-136">Then, when an utterance is actually detected, the server plays the character's **Hearing** state animation.</span></span> <span data-ttu-id="705a1-137">Le serveur conserve le caractère dans un état précis jusqu’à la fin de l’énoncé.</span><span class="sxs-lookup"><span data-stu-id="705a1-137">The server will keep the character in an attentive state until the utterance has ended.</span></span> <span data-ttu-id="705a1-138">Cela fournit les commentaires sociaux appropriés pour signaler à l’utilisateur l’entrée.</span><span class="sxs-lookup"><span data-stu-id="705a1-138">This provides the appropriate social feedback to cue the user for input.</span></span>

<span data-ttu-id="705a1-139">Si l’utilisateur désactive l’entrée vocale dans les options de caractères avancées, la touche d’écoute est également désactivée.</span><span class="sxs-lookup"><span data-stu-id="705a1-139">If the user disables speech input in Advanced Character Options, the Listening hotkey will also be disabled.</span></span> <span data-ttu-id="705a1-140">De même, toute tentative d’appel de la méthode [**Listen**](listen-method.md) lorsque l’entrée vocale est désactivée entraîne l’échec de la méthode.</span><span class="sxs-lookup"><span data-stu-id="705a1-140">Similarly, attempting to call the [**Listen**](listen-method.md) method when speech input is disabled will cause the method to fail.</span></span>

 

 