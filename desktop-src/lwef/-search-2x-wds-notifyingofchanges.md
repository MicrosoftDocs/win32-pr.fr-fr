---
title: Notification de l’index des modifications (fonctionnalités héritées de l’environnement Windows)
description: Avec Microsoft Windows Desktop Search (WDS) 2,6, les gestionnaires de protocoles pour un magasin de données donné peuvent indiquer à l’indexeur WDS quand les données de leur magasin ont changé.
ms.assetid: 700b1707-dd11-4a30-8f00-5c4aae1173ff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6021cfe5cd7061a3d3255e56d08e665a6caedf03
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/10/2020
ms.locfileid: "104200538"
---
# <a name="notifying-the-index-of-changes-legacy-windows-environment-features"></a><span data-ttu-id="37c6d-103">Notification de l’index des modifications (fonctionnalités héritées de l’environnement Windows)</span><span class="sxs-lookup"><span data-stu-id="37c6d-103">Notifying the Index of Changes (Legacy Windows Environment Features)</span></span>

> [!NOTE]
> <span data-ttu-id="37c6d-104">Windows Desktop Search 2. x est une technologie obsolète qui était à l’origine disponible en tant que complément pour Windows XP et Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="37c6d-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="37c6d-105">Dans les versions ultérieures, utilisez [Windows Search](../search/-search-3x-wds-overview.md) à la place.</span><span class="sxs-lookup"><span data-stu-id="37c6d-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="37c6d-106">Avec Microsoft Windows Desktop Search (WDS) 2,6, les gestionnaires de protocoles pour un magasin de données donné peuvent indiquer à l’indexeur WDS quand les données de leur magasin ont changé.</span><span class="sxs-lookup"><span data-stu-id="37c6d-106">With Microsoft Windows Desktop Search (WDS) 2.6, protocol handlers for a given data store can tell the WDS Indexer when data in their store has changed.</span></span> <span data-ttu-id="37c6d-107">Cela améliore les performances en garantissant que l’indexeur n’analyse pas l’intégralité du magasin sur les index incrémentiels.</span><span class="sxs-lookup"><span data-stu-id="37c6d-107">This improves performance by ensuring the Indexer doesn't crawl the entire store on incremental indexes.</span></span> <span data-ttu-id="37c6d-108">À l’aide des API de notification, les gestionnaires de protocole peuvent notifier l’indexeur qu’un élément a été déplacé ou supprimé, et ils peuvent ajouter des étendues à la file d’attente d’analyse de l’indexeur WDS des URL nécessitant une indexation.</span><span class="sxs-lookup"><span data-stu-id="37c6d-108">Using notification APIs, protocol handlers can notify the Indexer that an item has been moved or deleted, and they can add scopes to the WDS Indexer's crawl queue of URLs requiring indexing.</span></span> <span data-ttu-id="37c6d-109">La notification est utile pour les applications telles que la messagerie électronique, où le gestionnaire de protocole surveille le magasin et notifie l’indexeur que les éléments ont changé et nécessitent une indexation.</span><span class="sxs-lookup"><span data-stu-id="37c6d-109">Notification is helpful for applications such as email, where the protocol handler monitors the store and notifies the Indexer that items have changed and require indexing.</span></span>

## <a name="isearchitemschangedsink"></a><span data-ttu-id="37c6d-110">ISearchItemsChangedSink</span><span class="sxs-lookup"><span data-stu-id="37c6d-110">ISearchItemsChangedSink</span></span>

<span data-ttu-id="37c6d-111">Les gestionnaires de protocole notifient l’indexeur des modifications par le biais de l’interface [**ISearchItemsChangedSink**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) .</span><span class="sxs-lookup"><span data-stu-id="37c6d-111">Protocol handlers notify the Indexer of changes through the [**ISearchItemsChangedSink**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) interface.</span></span> <span data-ttu-id="37c6d-112">Les informations sur les modifications de données doivent être collectées dans les \_ \_ types de modification d’élément de recherche et \_ \_ de type de recherche de type d' \_ énumération de modification, puis communiquées à l’indexeur via la méthode **OnItemsChanged** de l’interface **ISearchItemsChangedSink** .</span><span class="sxs-lookup"><span data-stu-id="37c6d-112">Information about data changes should be collected in SEARCH\_ITEM\_CHANGE structs and SEARCH\_KIND\_OF\_CHANGE enumeration types and then communicated to the Indexer through the **OnItemsChanged** method of the **ISearchItemsChangedSink** interface.</span></span>

<span data-ttu-id="37c6d-113">Pour accéder à cette interface, un gestionnaire de protocole personnalisé doit d’abord instancier un objet [**ISearchManager**](/windows/desktop/api/searchapi/nn-searchapi-isearchmanager) pour accéder à l’objet [**ISearchCatalogManager**](/windows/desktop/api/searchapi/nn-searchapi-isearchcatalogmanager) .</span><span class="sxs-lookup"><span data-stu-id="37c6d-113">To access this interface, a custom protocol handlers must first instantiate an [**ISearchManager**](/windows/desktop/api/searchapi/nn-searchapi-isearchmanager) object to gain access to the [**ISearchCatalogManager**](/windows/desktop/api/searchapi/nn-searchapi-isearchcatalogmanager) object.</span></span> <span data-ttu-id="37c6d-114">À partir de là, il est possible d’instancier un objet [**ISearchItemsChangedSink**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) et d’informer l’indexeur des modifications apportées aux données.</span><span class="sxs-lookup"><span data-stu-id="37c6d-114">From there, one can instantiate an [**ISearchItemsChangedSink**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) object and notify the Indexer of the data changes.</span></span>

<span data-ttu-id="37c6d-115">La méthode OnItemsChanged vous permet de collecter et de communiquer les modifications de données à votre magasin de données client pour initialiser l’indexation.</span><span class="sxs-lookup"><span data-stu-id="37c6d-115">The OnItemsChanged method lets you collect and communicate data changes to your customer data store to initiate indexing.</span></span>



| <span data-ttu-id="37c6d-116">Sens</span><span class="sxs-lookup"><span data-stu-id="37c6d-116">Direction</span></span> | <span data-ttu-id="37c6d-117">Variable</span><span class="sxs-lookup"><span data-stu-id="37c6d-117">Variable</span></span>              | <span data-ttu-id="37c6d-118">Description</span><span class="sxs-lookup"><span data-stu-id="37c6d-118">Description</span></span>                                                              |
|-----------|-----------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="37c6d-119">Dans</span><span class="sxs-lookup"><span data-stu-id="37c6d-119">In</span></span>        | <span data-ttu-id="37c6d-120">dwNumberofChanges</span><span class="sxs-lookup"><span data-stu-id="37c6d-120">dwNumberofChanges</span></span>     | <span data-ttu-id="37c6d-121">Nombre total de modifications dans la notification.</span><span class="sxs-lookup"><span data-stu-id="37c6d-121">Total number of changes in the notification.</span></span>                             |
| <span data-ttu-id="37c6d-122">Dans</span><span class="sxs-lookup"><span data-stu-id="37c6d-122">In</span></span>        | <span data-ttu-id="37c6d-123">DataChangeEntries\[\]</span><span class="sxs-lookup"><span data-stu-id="37c6d-123">DataChangeEntries\[\]</span></span> | <span data-ttu-id="37c6d-124">Toutes les notifications de modification dans un tableau de structures de modification d’élément de recherche \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="37c6d-124">All change notifications in an array of SEARCH\_ITEM\_CHANGE structures.</span></span> |
| <span data-ttu-id="37c6d-125">Sortie</span><span class="sxs-lookup"><span data-stu-id="37c6d-125">Out</span></span>       | <span data-ttu-id="37c6d-126">dwBatchId</span><span class="sxs-lookup"><span data-stu-id="37c6d-126">dwBatchId</span></span>             | <span data-ttu-id="37c6d-127">ID de lot qui sera renvoyé avec des erreurs.</span><span class="sxs-lookup"><span data-stu-id="37c6d-127">The batch ID that will be passed back with errors.</span></span>                       |
| <span data-ttu-id="37c6d-128">Sortie</span><span class="sxs-lookup"><span data-stu-id="37c6d-128">Out</span></span>       | <span data-ttu-id="37c6d-129">hrCompletionCodes\[\]</span><span class="sxs-lookup"><span data-stu-id="37c6d-129">hrCompletionCodes\[\]</span></span> | <span data-ttu-id="37c6d-130">Indique si chaque URL a été acceptée pour l’indexation.</span><span class="sxs-lookup"><span data-stu-id="37c6d-130">Indicates whether each URL was accepted for indexing.</span></span>                    |



 

<span data-ttu-id="37c6d-131">La \_ \_ structure de modification de l’élément de recherche identifie le type de modification qui s’est produit, ainsi que l’URL actuelle et l’URL précédente de l’élément, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="37c6d-131">The SEARCH\_ITEM\_CHANGE structure identifies the kind of change that occurred as well as the item's current URL and previous URL, if applicable.</span></span> <span data-ttu-id="37c6d-132">La structure est définie comme suit :</span><span class="sxs-lookup"><span data-stu-id="37c6d-132">The structure is defined as follows:</span></span>



| <span data-ttu-id="37c6d-133">Nom de la propriété</span><span class="sxs-lookup"><span data-stu-id="37c6d-133">Property Name</span></span> | <span data-ttu-id="37c6d-134">Type de propriété</span><span class="sxs-lookup"><span data-stu-id="37c6d-134">Property Type</span></span>                  | <span data-ttu-id="37c6d-135">Description</span><span class="sxs-lookup"><span data-stu-id="37c6d-135">Description</span></span>                                                                |
|---------------|--------------------------------|----------------------------------------------------------------------------|
| <span data-ttu-id="37c6d-136">Modifier</span><span class="sxs-lookup"><span data-stu-id="37c6d-136">Change</span></span>        | <span data-ttu-id="37c6d-137">\_type \_ de recherche de \_ modification</span><span class="sxs-lookup"><span data-stu-id="37c6d-137">SEARCH\_KIND\_OF\_CHANGE</span></span>       | <span data-ttu-id="37c6d-138">Type de modification notifié.</span><span class="sxs-lookup"><span data-stu-id="37c6d-138">The type of change that is being notified.</span></span>                                 |
| <span data-ttu-id="37c6d-139">URL</span><span class="sxs-lookup"><span data-stu-id="37c6d-139">URL</span></span>           | <span data-ttu-id="37c6d-140">LPWSTR</span><span class="sxs-lookup"><span data-stu-id="37c6d-140">LPWSTR</span></span>                         | <span data-ttu-id="37c6d-141">URL de l’objet qui a changé.</span><span class="sxs-lookup"><span data-stu-id="37c6d-141">The URL for the object that has changed.</span></span>                                   |
| <span data-ttu-id="37c6d-142">OldURL</span><span class="sxs-lookup"><span data-stu-id="37c6d-142">OldURL</span></span>        | <span data-ttu-id="37c6d-143">LPWSTR</span><span class="sxs-lookup"><span data-stu-id="37c6d-143">LPWSTR</span></span>                         | <span data-ttu-id="37c6d-144">Si la notification est un déplacement, l’ancienne URL est fournie et doit être unique.</span><span class="sxs-lookup"><span data-stu-id="37c6d-144">If the notification is a move, the old URL is provided and must be unique.</span></span> |
| <span data-ttu-id="37c6d-145">Priority</span><span class="sxs-lookup"><span data-stu-id="37c6d-145">Priority</span></span>      | <span data-ttu-id="37c6d-146">\_priorité de notification de recherche \_</span><span class="sxs-lookup"><span data-stu-id="37c6d-146">SEARCH\_NOTIFICATION\_PRIORITY</span></span> | <span data-ttu-id="37c6d-147">Priorité de la modification.</span><span class="sxs-lookup"><span data-stu-id="37c6d-147">The priority of the change.</span></span>                                                |



 

<span data-ttu-id="37c6d-148">Le \_ type \_ de recherche de l' \_ énumération des modifications est défini comme suit :</span><span class="sxs-lookup"><span data-stu-id="37c6d-148">The SEARCH\_KIND\_OF\_CHANGE enumeration is defined as follows:</span></span>



| <span data-ttu-id="37c6d-149">Valeur Enum</span><span class="sxs-lookup"><span data-stu-id="37c6d-149">Enum Value</span></span>                           | <span data-ttu-id="37c6d-150">Valeur</span><span class="sxs-lookup"><span data-stu-id="37c6d-150">Value</span></span>   | <span data-ttu-id="37c6d-151">Description</span><span class="sxs-lookup"><span data-stu-id="37c6d-151">Description</span></span>                                                                                     |
|--------------------------------------|---------|-------------------------------------------------------------------------------------------------|
| <span data-ttu-id="37c6d-152">modifier la recherche \_ \_ Ajouter</span><span class="sxs-lookup"><span data-stu-id="37c6d-152">SEARCH\_CHANGE\_ADD</span></span>                  | <span data-ttu-id="37c6d-153">0</span><span class="sxs-lookup"><span data-stu-id="37c6d-153">0</span></span>       | <span data-ttu-id="37c6d-154">La notification est destinée à une URL supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="37c6d-154">The notification is for an additional URL.</span></span>                                                      |
| <span data-ttu-id="37c6d-155">recherche de modification de la recherche \_ \_</span><span class="sxs-lookup"><span data-stu-id="37c6d-155">SEARCH\_CHANGE\_DELETE</span></span>               | <span data-ttu-id="37c6d-156">1</span><span class="sxs-lookup"><span data-stu-id="37c6d-156">1</span></span>       | <span data-ttu-id="37c6d-157">La notification est destinée à la suppression d’une URL.</span><span class="sxs-lookup"><span data-stu-id="37c6d-157">The notification is for the deletion of a URL.</span></span>                                                  |
| <span data-ttu-id="37c6d-158">modification de \_ la modification de la recherche \_</span><span class="sxs-lookup"><span data-stu-id="37c6d-158">SEARCH\_CHANGE\_MODIFY</span></span>               | <span data-ttu-id="37c6d-159">2</span><span class="sxs-lookup"><span data-stu-id="37c6d-159">2</span></span>       | <span data-ttu-id="37c6d-160">La notification est qu’une URL a été modifiée.</span><span class="sxs-lookup"><span data-stu-id="37c6d-160">The notification is that a URL has been modified.</span></span>                                               |
| <span data-ttu-id="37c6d-161">RECHERCHE \_ modifier le déplacement du changement de \_ \_ nom</span><span class="sxs-lookup"><span data-stu-id="37c6d-161">SEARCH\_CHANGE\_MOVE\_RENAME</span></span>         | <span data-ttu-id="37c6d-162">3</span><span class="sxs-lookup"><span data-stu-id="37c6d-162">3</span></span>       | <span data-ttu-id="37c6d-163">La notification concerne le déplacement et le changement de nom d’un objet en une nouvelle URL.</span><span class="sxs-lookup"><span data-stu-id="37c6d-163">The notification is for the move and rename of an object to a new URL.</span></span>                          |
| <span data-ttu-id="37c6d-164">Rechercher dans le répertoire de sémantique de \_ modification \_ \_</span><span class="sxs-lookup"><span data-stu-id="37c6d-164">SEARCH\_CHANGE\_SEMANTICS\_DIRECTORY</span></span> | <span data-ttu-id="37c6d-165">0x10000</span><span class="sxs-lookup"><span data-stu-id="37c6d-165">0x10000</span></span> | <span data-ttu-id="37c6d-166">La notification est destinée à une URL de conteneur.</span><span class="sxs-lookup"><span data-stu-id="37c6d-166">The notification is for a container URL.</span></span>                                                        |
| <span data-ttu-id="37c6d-167">Rechercher \_ les \_ sémantiques de modification \_ superficielles</span><span class="sxs-lookup"><span data-stu-id="37c6d-167">SEARCH\_CHANGE\_SEMANTICS\_SHALLOW</span></span>   | <span data-ttu-id="37c6d-168">0x20000</span><span class="sxs-lookup"><span data-stu-id="37c6d-168">0x20000</span></span> | <span data-ttu-id="37c6d-169">La notification concerne une URL de conteneur qui ne doit avoir que ses propriétés de conteneur indexées.</span><span class="sxs-lookup"><span data-stu-id="37c6d-169">The notification is for a container URL that should only have its container properties indexed.</span></span> |
| <span data-ttu-id="37c6d-170">sécurité de modification de la \_ \_ sémantique de la recherche \_</span><span class="sxs-lookup"><span data-stu-id="37c6d-170">SEARCH\_CHANGE\_SEMANTICS\_SECURITY</span></span>  | <span data-ttu-id="37c6d-171">0x40000</span><span class="sxs-lookup"><span data-stu-id="37c6d-171">0x40000</span></span> | <span data-ttu-id="37c6d-172">La notification concerne une URL ou une URL de conteneur dont les propriétés de sécurité ont été modifiées.</span><span class="sxs-lookup"><span data-stu-id="37c6d-172">The notification is for a URL or container URL that has had its security properties changed.</span></span>    |



 

<span data-ttu-id="37c6d-173">L’énumération de la priorité de notification de recherche \_ \_ est définie comme suit :</span><span class="sxs-lookup"><span data-stu-id="37c6d-173">The SEARCH\_NOTIFICATION\_PRIORITY enumeration is defined as follows:</span></span>



| <span data-ttu-id="37c6d-174">Valeur Enum</span><span class="sxs-lookup"><span data-stu-id="37c6d-174">Enum Value</span></span>               | <span data-ttu-id="37c6d-175">Valeur</span><span class="sxs-lookup"><span data-stu-id="37c6d-175">Value</span></span> | <span data-ttu-id="37c6d-176">Description</span><span class="sxs-lookup"><span data-stu-id="37c6d-176">Description</span></span>                                                                                                                                                                    |
|--------------------------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="37c6d-177">Rechercher \_ la \_ priorité normale</span><span class="sxs-lookup"><span data-stu-id="37c6d-177">SEARCH\_NORMAL\_PRIORITY</span></span> | <span data-ttu-id="37c6d-178">0</span><span class="sxs-lookup"><span data-stu-id="37c6d-178">0</span></span>     | <span data-ttu-id="37c6d-179">Seule une priorité normale doit être utilisée lors de l’indexation de l’URL.</span><span class="sxs-lookup"><span data-stu-id="37c6d-179">Only a normal priority should be used when indexing the URL.</span></span> <span data-ttu-id="37c6d-180">Ces notifications sont traitées avant l’indexation normale en arrière-plan normale des fichiers et des magasins d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="37c6d-180">These notifications are processed before the normal background incremental indexing of a user's files and stores.</span></span> |



 

 

 
