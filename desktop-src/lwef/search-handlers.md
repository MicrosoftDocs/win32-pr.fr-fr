---
title: Création de gestionnaires de recherche
description: L’interpréteur de commandes prend en charge plusieurs utilitaires de recherche qui permettent aux utilisateurs de localiser des objets d’espace de noms tels que des fichiers ou des imprimantes. Vous pouvez créer un moteur de recherche personnalisé et le mettre à la disposition des utilisateurs en implémentant et en inscrivant un gestionnaire de recherche.
ms.assetid: ffd023bb-16ab-43ce-b00b-5e32656c8013
keywords:
- gestionnaires de recherche
- inscrire, gestionnaires de recherche
- gestionnaires de recherche statiques
- Register, gestionnaires de recherche statiques
- gestionnaires de recherche dynamique
- inscription, gestionnaires de recherche dynamique
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e6476109302a176822137747353b2762b0caea8a
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104315035"
---
# <a name="creating-search-handlers"></a><span data-ttu-id="e7d07-110">Création de gestionnaires de recherche</span><span class="sxs-lookup"><span data-stu-id="e7d07-110">Creating Search Handlers</span></span>

<span data-ttu-id="e7d07-111">\[Cette fonctionnalité est prise en charge uniquement sous Windows XP ou version antérieure.</span><span class="sxs-lookup"><span data-stu-id="e7d07-111">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="e7d07-112">Utilisez plutôt la recherche Windows.\]</span><span class="sxs-lookup"><span data-stu-id="e7d07-112">Use Windows Search instead.\]</span></span>

<span data-ttu-id="e7d07-113">L’interpréteur de commandes prend en charge plusieurs utilitaires de recherche qui permettent aux utilisateurs de localiser des objets d’espace de noms tels que des fichiers ou des imprimantes.</span><span class="sxs-lookup"><span data-stu-id="e7d07-113">The Shell supports several search utilities that allow users to locate namespace objects such as files or printers.</span></span> <span data-ttu-id="e7d07-114">Vous pouvez créer un moteur de recherche personnalisé et le mettre à la disposition des utilisateurs en implémentant et en inscrivant un *Gestionnaire de recherche*.</span><span class="sxs-lookup"><span data-stu-id="e7d07-114">You can create a custom search engine and make it available to users by implementing and registering a *search handler*.</span></span>

<span data-ttu-id="e7d07-115">Les procédures générales d’implémentation et d’inscription d’un gestionnaire d’extensions de Shell sont décrites dans [création de gestionnaires d’extensions de Shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="e7d07-115">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="e7d07-116">Ce document se concentre sur les aspects de l’implémentation qui sont spécifiques aux gestionnaires de recherche.</span><span class="sxs-lookup"><span data-stu-id="e7d07-116">This document focuses on those aspects of implementation that are specific to search handlers.</span></span>

-   [<span data-ttu-id="e7d07-117">Fonctionnement des gestionnaires de recherche</span><span class="sxs-lookup"><span data-stu-id="e7d07-117">How Search Handlers Work</span></span>](#how-search-handlers-work)
-   [<span data-ttu-id="e7d07-118">Inscription des gestionnaires de recherche</span><span class="sxs-lookup"><span data-stu-id="e7d07-118">Registering Search Handlers</span></span>](#registering-search-handlers)
    -   [<span data-ttu-id="e7d07-119">Inscription d’un gestionnaire de recherche statique</span><span class="sxs-lookup"><span data-stu-id="e7d07-119">Registering a Static Search Handler</span></span>](#registering-a-static-search-handler)
    -   [<span data-ttu-id="e7d07-120">Inscription d’un gestionnaire de recherche dynamique</span><span class="sxs-lookup"><span data-stu-id="e7d07-120">Registering a Dynamic Search Handler</span></span>](#registering-a-dynamic-search-handler)
-   [<span data-ttu-id="e7d07-121">Implémentation de gestionnaires de recherche</span><span class="sxs-lookup"><span data-stu-id="e7d07-121">Implementing Search Handlers</span></span>](#implementing-search-handlers)

## <a name="how-search-handlers-work"></a><span data-ttu-id="e7d07-122">Fonctionnement des gestionnaires de recherche</span><span class="sxs-lookup"><span data-stu-id="e7d07-122">How Search Handlers Work</span></span>

<span data-ttu-id="e7d07-123">Les utilisateurs ont deux moyens de sélectionner un moteur de recherche.</span><span class="sxs-lookup"><span data-stu-id="e7d07-123">Users have two ways to select a search engine.</span></span> <span data-ttu-id="e7d07-124">La première consiste à partir du menu Démarrer.</span><span class="sxs-lookup"><span data-stu-id="e7d07-124">The first way is from the Start menu.</span></span> <span data-ttu-id="e7d07-125">Avec les systèmes antérieurs à Windows 2000, la sélection de la commande **Rechercher** dans le menu **Démarrer** affiche un sous-menu des moteurs de recherche disponibles.</span><span class="sxs-lookup"><span data-stu-id="e7d07-125">With systems earlier than Windows 2000, selecting the **Find** command on the **Start** menu displays a submenu of the available search engines.</span></span> <span data-ttu-id="e7d07-126">Avec Windows 2000 et versions ultérieures, la commande **Rechercher** du menu de la **Saint**-art est renommée Rechercher.</span><span class="sxs-lookup"><span data-stu-id="e7d07-126">With Windows 2000 and later, the **St** art menu's **Find** command is renamed Search.</span></span> <span data-ttu-id="e7d07-127">L’illustration suivante montre le bouton de **recherche** sur un système Windows XP.</span><span class="sxs-lookup"><span data-stu-id="e7d07-127">The following illustration shows the **Search** button on a Windows XP system.</span></span>

![sous-menu Rechercher du menu Démarrer](images/searchhandler1.jpg)

<span data-ttu-id="e7d07-129">Les utilisateurs peuvent également lancer une recherche à partir de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="e7d07-129">Users can also launch a search from Windows Explorer.</span></span> <span data-ttu-id="e7d07-130">Sur les systèmes antérieurs à Windows 2000, ils cliquent sur la commande **Rechercher** du menu **Outils** pour afficher essentiellement le même menu que celui associé au menu **Démarrer** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-130">On systems earlier than Windows 2000, they click the **Find** command on the **Tools** menu to display essentially the same menu as the one associated with the **Start** menu.</span></span> <span data-ttu-id="e7d07-131">Toutefois, l’Explorateur Windows pour Windows 2000 gère les moteurs de recherche d’une manière très différente.</span><span class="sxs-lookup"><span data-stu-id="e7d07-131">However, Windows Explorer for Windows 2000 handles search engines in a very different way.</span></span> <span data-ttu-id="e7d07-132">Au lieu de gérer les moteurs de recherche en tant que sous-menu du menu **Outils** , il existe désormais un bouton de **recherche** dans la barre d’outils.</span><span class="sxs-lookup"><span data-stu-id="e7d07-132">Instead of handling search engines as a submenu of the **Tools** menu, there is now a **Search** button on the toolbar.</span></span> <span data-ttu-id="e7d07-133">Cliquez sur ce bouton pour ouvrir le volet de **recherche** de la barre d’explorateur.</span><span class="sxs-lookup"><span data-stu-id="e7d07-133">Clicking this button opens the Explorer bar's **Search** pane.</span></span> <span data-ttu-id="e7d07-134">L’illustration suivante montre le volet **de recherche Rechercher des fichiers et des dossiers** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-134">The following illustration shows the **Search For Files And Folders** search pane.</span></span>

![volet de recherche de la barre d’Explorateur Windows](images/searchhandler2.jpg)

<span data-ttu-id="e7d07-136">Il existe un certain nombre de différences dans la façon dont Windows 2000 et les systèmes antérieurs gèrent les gestionnaires de recherche qui affectent l’implémentation et l’inscription.</span><span class="sxs-lookup"><span data-stu-id="e7d07-136">There are a number of differences in how Windows 2000 and earlier systems manage search handlers that affect both implementation and registration.</span></span>



| <span data-ttu-id="e7d07-137">Pré-Windows 2000</span><span class="sxs-lookup"><span data-stu-id="e7d07-137">Pre-Windows 2000</span></span>                                                                                                                                                                                                       | <span data-ttu-id="e7d07-138">Windows 2000 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="e7d07-138">Windows 2000 and later</span></span>                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e7d07-139">Les gestionnaires de recherche sont implémentés en tant que type de [Gestionnaire de menu contextuel](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="e7d07-139">Search handlers are implemented as a type of [shortcut menu handler](/windows/desktop/shell/context-menu-handlers).</span></span>                                                                                                                     | <span data-ttu-id="e7d07-140">Les gestionnaires de recherche peuvent être implémentés en tant que gestionnaires de menus contextuels ou en tant que documents HTML dynamiques (DHTML).</span><span class="sxs-lookup"><span data-stu-id="e7d07-140">Search handlers can be implemented as shortcut menu handlers, or as Dynamic HTML (DHTML) documents.</span></span>                                                                                                                                                                                                               |
| <span data-ttu-id="e7d07-141">Les gestionnaires de recherche peuvent être statiques ou dynamiques.</span><span class="sxs-lookup"><span data-stu-id="e7d07-141">Search handlers can be either static or dynamic.</span></span> <span data-ttu-id="e7d07-142">Les gestionnaires statiques sont chargés uniquement lorsqu’ils sont sélectionnés par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e7d07-142">Static handlers are loaded only when they are selected by the user.</span></span> <span data-ttu-id="e7d07-143">Les gestionnaires dynamiques sont chargés par le shell au démarrage et ne se terminent pas tant que le shell n’est pas fermé.</span><span class="sxs-lookup"><span data-stu-id="e7d07-143">Dynamic handlers are loaded by the Shell at startup and are not terminated until the Shell exits.</span></span> | <span data-ttu-id="e7d07-144">Les gestionnaires implémentés en tant que gestionnaires de menu contextuel peuvent être statiques ou dynamiques.</span><span class="sxs-lookup"><span data-stu-id="e7d07-144">Handlers implemented as shortcut menu handlers can be either static or dynamic.</span></span> <span data-ttu-id="e7d07-145">Les gestionnaires implémentés en tant que documents DHTML doivent être statiques.</span><span class="sxs-lookup"><span data-stu-id="e7d07-145">Handlers implemented as DHTML documents must be static.</span></span>                                                                                                                                                                           |
| <span data-ttu-id="e7d07-146">Les gestionnaires de recherche s’affichent dans le sous-menu **Rechercher** du menu **Démarrer** et dans le sous-menu **Rechercher** du menu  **Outils** de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="e7d07-146">Search handlers appear on the **Find** submenu of the **Start** menu and the **Find** submenu of the Windows Explorer **Tools** menu.</span></span>                                                                                  | <span data-ttu-id="e7d07-147">Les gestionnaires de recherche s’affichent uniquement dans le sous-menu **Rechercher** du menu **Démarrer** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-147">Search handlers appear only on the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="e7d07-148">Pour mettre un volet de recherche personnalisé à disposition par le biais de la barre de menus de l’Explorateur Windows, vous devez l’implémenter en tant qu' [objet de bande](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="e7d07-148">To make a custom search pane available through the Windows Explorer menu bar, you must implement it as a [band object](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span> <span data-ttu-id="e7d07-149">Elle est ensuite listée dans le sous-menu du **volet d’exploration** du menu  **affichage** de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="e7d07-149">It is then listed on the **Explorer Bar** submenu of the Windows Explorer **View** menu.</span></span> |



 

## <a name="registering-search-handlers"></a><span data-ttu-id="e7d07-150">Inscription des gestionnaires de recherche</span><span class="sxs-lookup"><span data-stu-id="e7d07-150">Registering Search Handlers</span></span>

<span data-ttu-id="e7d07-151">Les gestionnaires de recherche sont inscrits sous la sous-clé **FindExtensions** du type de fichier.</span><span class="sxs-lookup"><span data-stu-id="e7d07-151">Search handlers are registered under the file types's **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="e7d07-152">À partir de ce point, la procédure d’inscription varie selon que le gestionnaire doit être statique ou dynamique.</span><span class="sxs-lookup"><span data-stu-id="e7d07-152">From this point, the registration procedure depends on whether the handler is to be static or dynamic.</span></span> <span data-ttu-id="e7d07-153">Pour obtenir une présentation générale de l’inscription des gestionnaires d’extensions de Shell, consultez [création de gestionnaires d’extensions de Shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="e7d07-153">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span>

### <a name="registering-a-static-search-handler"></a><span data-ttu-id="e7d07-154">Inscription d’un gestionnaire de recherche statique</span><span class="sxs-lookup"><span data-stu-id="e7d07-154">Registering a Static Search Handler</span></span>

<span data-ttu-id="e7d07-155">Les gestionnaires de recherche statiques sont chargés uniquement lorsqu’ils sont lancés par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e7d07-155">Static search handlers are loaded only when they are launched by the user.</span></span> <span data-ttu-id="e7d07-156">Cette approche fonctionne mieux pour les dll de petite taille qui peuvent être chargées rapidement.</span><span class="sxs-lookup"><span data-stu-id="e7d07-156">This approach works best for DLLs that are small and can be loaded quickly.</span></span> <span data-ttu-id="e7d07-157">Si vous utilisez DHTML pour implémenter votre gestionnaire, il doit être statique.</span><span class="sxs-lookup"><span data-stu-id="e7d07-157">If you are using DHTML to implement your handler, it must be static.</span></span> <span data-ttu-id="e7d07-158">Pour inscrire un gestionnaire d’extensions statiques, créez une sous-clé nommée pour le gestionnaire sous la sous-clé **statique** de la sous-clé **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-158">To register a static extension handler, create a subkey named for the handler under the **Static** subkey of the **FindExtensions** subkey.</span></span> <span data-ttu-id="e7d07-159">Le nom n’est pas utilisé par le système, mais il ne doit pas être identique aux autres noms de gestionnaires de recherche sous la sous-clé **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-159">The name is not used by the system, but it must not be identical to other search handler names under the **FindExtensions** subkey.</span></span>

### <a name="shortcut-menu-based-search-handlers"></a><span data-ttu-id="e7d07-160">Gestionnaires de recherche basés sur des menus contextuels</span><span class="sxs-lookup"><span data-stu-id="e7d07-160">Shortcut menu-based search handlers</span></span>

<span data-ttu-id="e7d07-161">Si votre gestionnaire est implémenté en tant que [Gestionnaire de menu contextuel](/windows/desktop/shell/context-menu-handlers), définissez la valeur par défaut de la sous-clé de nom du gestionnaire sur le GUID de l’identificateur de classe (CLSID) de l’objet.</span><span class="sxs-lookup"><span data-stu-id="e7d07-161">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), set the default value of the handler's name subkey to the object's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="e7d07-162">Sous la sous-clé Name du gestionnaire, créez une sous-clé nommée **0**   (zéro) et définissez sa valeur par défaut sur la chaîne qui sera affichée dans le sous-menu **Rechercher** ou **Rechercher** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-162">Under the handler's name subkey, create a subkey named **0** (zero) and set its default value to the string that will be displayed in the **Search** or **Find** submenu.</span></span> <span data-ttu-id="e7d07-163">Vous pouvez activer les raccourcis clavier de la manière habituelle, en faisant précéder le caractère de raccourci d’une esperluette (&).</span><span class="sxs-lookup"><span data-stu-id="e7d07-163">You can enable keyboard shortcuts in the usual way, by preceding the shortcut character with an ampersand (&).</span></span> <span data-ttu-id="e7d07-164">Vous pouvez afficher une petite icône facultative à droite du texte du menu en créant une sous-clé **DefaultIcon** sous la sous-clé **0** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-164">You can have an optional small icon displayed to the right of the menu text by creating a **DefaultIcon** subkey under the **0** subkey.</span></span> <span data-ttu-id="e7d07-165">Définissez sa valeur par défaut sur une chaîne contenant le chemin d’accès du fichier contenant l’icône, suivi d’une virgule, puis de l’index de base zéro de l’icône.</span><span class="sxs-lookup"><span data-stu-id="e7d07-165">Set its default value to a string containing the path of the file containing the icon, followed by a comma, followed by the icon's zero-based index.</span></span>

<span data-ttu-id="e7d07-166">L’exemple suivant enregistre le gestionnaire de recherche **MySearchEngine** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-166">The following example registers the **MySearchEngine** search handler.</span></span> <span data-ttu-id="e7d07-167">Le texte du menu est « mon moteur de recherche », avec M spécifié comme touche de raccourci.</span><span class="sxs-lookup"><span data-stu-id="e7d07-167">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="e7d07-168">L’icône se trouve dans C : \\ MyDir \\MySearch.dll, avec un index de 2.</span><span class="sxs-lookup"><span data-stu-id="e7d07-168">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {MySearchEngine CLSID GUID}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
```

### <a name="dhtml-based-search-handlers"></a><span data-ttu-id="e7d07-169">Gestionnaires de recherche DHTML</span><span class="sxs-lookup"><span data-stu-id="e7d07-169">DHTML-based search handlers</span></span>

<span data-ttu-id="e7d07-170">Avec Windows 2000, vous pouvez également implémenter un gestionnaire de recherche en tant que document DHTML.</span><span class="sxs-lookup"><span data-stu-id="e7d07-170">With Windows 2000, you can also implement a search handler as a DHTML document.</span></span> <span data-ttu-id="e7d07-171">Son nom est indiqué dans le sous-menu **Rechercher** du menu **Démarrer** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-171">Its name is listed in the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="e7d07-172">Lorsque l’utilisateur le sélectionne, il lance l’Explorateur Windows avec la barre d’exploration ouverte dans le document de recherche.</span><span class="sxs-lookup"><span data-stu-id="e7d07-172">When the user selects it, it launches Windows Explorer with the Explorer bar opened to the search document.</span></span> <span data-ttu-id="e7d07-173">Vous pouvez également spécifier un document DHTML à afficher à droite du volet d’exploration.</span><span class="sxs-lookup"><span data-stu-id="e7d07-173">You can also specify a DHTML document to be displayed to the right of the Explorer bar.</span></span> <span data-ttu-id="e7d07-174">Il n’existe aucun moyen de lancer un autre gestionnaire à partir du volet de recherche par défaut.</span><span class="sxs-lookup"><span data-stu-id="e7d07-174">There is no way to launch a different handler from the default Search pane.</span></span> <span data-ttu-id="e7d07-175">Les moteurs de recherche peuvent être lancés directement à partir de l’Explorateur Windows, mais uniquement s’ils sont implémentés en tant qu' [objets de bande](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="e7d07-175">Search engines can be launched directly from Windows Explorer, but only if they are implemented as as [band objects](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span>

<span data-ttu-id="e7d07-176">Pour inscrire un gestionnaire de recherche DHTML, définissez la sous-clé de nom du gestionnaire sur la forme de chaîne du CLSID \_ ShellSearchExt (actuellement {169A0691-8DF9-11D1-A1C4-00C04FD75D13}) et créez les sous-clés suivantes.</span><span class="sxs-lookup"><span data-stu-id="e7d07-176">To register a DHTML-based search handler, set the handler's name subkey to the string form of CLSID\_ShellSearchExt (currently {169A0691-8DF9-11d1-A1C4-00C04FD75D13}) and create the following subkeys.</span></span>

1.  <span data-ttu-id="e7d07-177">Créez une sous-clé **0**(zéro) sous la sous-clé du nom du gestionnaire et définissez sa valeur par défaut sur le texte du menu.</span><span class="sxs-lookup"><span data-stu-id="e7d07-177">Create a **0**(zero) subkey under the handler name subkey and set its default value to the menu text.</span></span>
2.  <span data-ttu-id="e7d07-178">Pour qu’une icône s’affiche en regard du texte du menu, créez une sous-clé **DefaultIcon** sous **0** et définissez sa valeur par défaut sur le chemin d’accès et l’index de l’icône.</span><span class="sxs-lookup"><span data-stu-id="e7d07-178">To have an icon displayed next to the menu text, create a **DefaultIcon** subkey under **0** and set its default value to the icon's path and index.</span></span>
3.  <span data-ttu-id="e7d07-179">Créez une sous-clé **SearchGUID** sous **0**.</span><span class="sxs-lookup"><span data-stu-id="e7d07-179">Create a **SearchGUID** subkey under **0**.</span></span> <span data-ttu-id="e7d07-180">Attribuez un GUID au document DHTML et définissez la valeur par défaut de **SearchGUID** sur son format de chaîne.</span><span class="sxs-lookup"><span data-stu-id="e7d07-180">Assign a GUID to the DHTML document and set the default value of **SearchGUID** to its string form.</span></span> <span data-ttu-id="e7d07-181">Ce GUID n’a pas besoin d’être inscrit sous le **\_ \_ \\ CLSID racine de la classe HKEY**.</span><span class="sxs-lookup"><span data-stu-id="e7d07-181">This GUID does not need to be registered under **HKEY\_CLASSES\_ROOT\\CLSID**.</span></span>
4.  <span data-ttu-id="e7d07-182">Créez une sous-clé d' **URL** sous **SearchGUID**.</span><span class="sxs-lookup"><span data-stu-id="e7d07-182">Create a **Url** subkey under **SearchGUID**.</span></span> <span data-ttu-id="e7d07-183">Définissez sa valeur par défaut sur le chemin d’accès du document HTML qui s’affichera dans le volet d’exploration.</span><span class="sxs-lookup"><span data-stu-id="e7d07-183">Set its default value to the path of the HTML document that will appear in the Explorer bar.</span></span>
5.  <span data-ttu-id="e7d07-184">Créez une sous-clé **UrlNavNew** sous **SearchGUID**.</span><span class="sxs-lookup"><span data-stu-id="e7d07-184">Create a **UrlNavNew** subkey under **SearchGUID**.</span></span> <span data-ttu-id="e7d07-185">Définissez sa valeur par défaut sur le chemin d’accès du document HTML qui s’affiche à droite du volet d’exploration.</span><span class="sxs-lookup"><span data-stu-id="e7d07-185">Set its default value to the path of the HTML document that will appear to the right of the Explorer bar.</span></span>

<span data-ttu-id="e7d07-186">L’exemple suivant enregistre le gestionnaire de recherche **MySearchEngine** implémenté en tant que document DHTML.</span><span class="sxs-lookup"><span data-stu-id="e7d07-186">The following example registers the **MySearchEngine** search handler implemented as a DHTML document.</span></span> <span data-ttu-id="e7d07-187">Le texte du menu est « mon moteur de recherche », avec M spécifié comme touche de raccourci.</span><span class="sxs-lookup"><span data-stu-id="e7d07-187">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="e7d07-188">L’icône se trouve dans C : \\ MyDir \\MySearch.dll, avec un index de 2.</span><span class="sxs-lookup"><span data-stu-id="e7d07-188">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span> <span data-ttu-id="e7d07-189">Le document DHTML de la barre d’exploration est C : \\ MyDir \\MySearch.htm et le document qui s’affiche à droite de la barre d’exploration est c : \\ mydir \\MySearchPage.htm.</span><span class="sxs-lookup"><span data-stu-id="e7d07-189">The Explorer bar's DHTML document is C:\\MyDir\\MySearch.htm, and the document that will be displayed to the right of the Explorer bar is C:\\MyDir\\MySearchPage.htm.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {169A0691-8DF9-11d1-A1C4-00C04FD75D13}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
                                 SearchGUID
                                    (Default) = {My Search GUID}
                                    Url
                                       (Default) = C:\MyDir\MySearch.htm
                                    UrlNavNew
                                       (Default) = C:\MyDir\MySearchPage.htm
```

### <a name="registering-a-dynamic-search-handler"></a><span data-ttu-id="e7d07-190">Inscription d’un gestionnaire de recherche dynamique</span><span class="sxs-lookup"><span data-stu-id="e7d07-190">Registering a Dynamic Search Handler</span></span>

<span data-ttu-id="e7d07-191">Si votre gestionnaire est implémenté en tant que [Gestionnaire de menu contextuel](/windows/desktop/shell/context-menu-handlers), vous pouvez également l’inscrire en tant que gestionnaire dynamique.</span><span class="sxs-lookup"><span data-stu-id="e7d07-191">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), you can also register it as a dynamic handler.</span></span> <span data-ttu-id="e7d07-192">Dans ce cas, il est chargé avec l’interpréteur de commandes et se termine uniquement lorsque l’interpréteur de commandes se termine.</span><span class="sxs-lookup"><span data-stu-id="e7d07-192">In that case, it will be loaded with the Shell and will terminate only when the Shell exits.</span></span> <span data-ttu-id="e7d07-193">Les gestionnaires de recherche dynamique répondent bien plus rapidement que les gestionnaires statiques lorsqu’ils sont lancés par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e7d07-193">Dynamic search handlers respond much more quickly than static handlers when they are launched by the user.</span></span> <span data-ttu-id="e7d07-194">Cette approche fonctionne mieux si le chargement de la DLL de votre gestionnaire peut prendre beaucoup de temps, ou s’il est probable qu’elle est souvent appelée.</span><span class="sxs-lookup"><span data-stu-id="e7d07-194">This approach works best if your handler's DLL might take a long time to load, or if it is likely to be called frequently.</span></span>

<span data-ttu-id="e7d07-195">Les gestionnaires de recherche dynamique sont inscrits sous la sous-clé **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-195">Dynamic search handlers are registered under the **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="e7d07-196">Créez une sous-clé de **FindExtensions** nommée pour le gestionnaire et définissez sa valeur par défaut sur le GUID CLSID du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="e7d07-196">Create a subkey of **FindExtensions** named for the handler, and set its default value to the handler's CLSID GUID.</span></span> <span data-ttu-id="e7d07-197">Les icônes de menu ne sont pas prises en charge pour les gestionnaires de recherche dynamique.</span><span class="sxs-lookup"><span data-stu-id="e7d07-197">Menu icons are not supported for dynamic search handlers.</span></span> <span data-ttu-id="e7d07-198">L’exemple suivant inscrit MySearchEngine en tant que gestionnaire de recherche dynamique.</span><span class="sxs-lookup"><span data-stu-id="e7d07-198">The following example registers MySearchEngine as a dynamic search handler.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     MySearchEngine
                        (Default) = {MySearchEngine CLSID GUID}
                        0
                           (Default) = &My Search Engine
```

<span data-ttu-id="e7d07-199">Contrairement aux gestionnaires de recherche statique, vous ne spécifiez pas le texte de menu dans le registre.</span><span class="sxs-lookup"><span data-stu-id="e7d07-199">Unlike static search handlers, you do not specify the menu text in the registry.</span></span> <span data-ttu-id="e7d07-200">Lorsque le gestionnaire est chargé, l’interpréteur de commandes appelle la méthode [**IContextMenu :: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) du gestionnaire pour ajouter des éléments au sous-menu **Rechercher** ou **Rechercher** .</span><span class="sxs-lookup"><span data-stu-id="e7d07-200">When the handler is loaded, the Shell will call the handler's [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) method to add items to the **Find** or **Search** submenu.</span></span>

## <a name="implementing-search-handlers"></a><span data-ttu-id="e7d07-201">Implémentation de gestionnaires de recherche</span><span class="sxs-lookup"><span data-stu-id="e7d07-201">Implementing Search Handlers</span></span>

<span data-ttu-id="e7d07-202">Les gestionnaires de recherche peuvent être implémentés en tant que gestionnaires de menus contextuels pour toutes les versions de Windows.</span><span class="sxs-lookup"><span data-stu-id="e7d07-202">Search handlers can be implemented as shortcut menu handlers for all versions of Windows.</span></span> <span data-ttu-id="e7d07-203">Pour Windows 2000, ils peuvent également être implémentés en tant que documents DHTML.</span><span class="sxs-lookup"><span data-stu-id="e7d07-203">For Windows 2000, they can also be implemented as DHTML documents.</span></span>

<span data-ttu-id="e7d07-204">Pour obtenir une présentation générale de l’implémentation des gestionnaires de menus contextuels, consultez [création de gestionnaires de menus contextuels](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="e7d07-204">For a general discussion of how to implement shortcut menu handlers, see [Creating Context Menu Handlers](/windows/desktop/shell/context-menu-handlers).</span></span> <span data-ttu-id="e7d07-205">Les gestionnaires de recherche diffèrent des gestionnaires de menus contextuels standard de plusieurs façons.</span><span class="sxs-lookup"><span data-stu-id="e7d07-205">Search handlers differ from standard shortcut menu handlers in only a few ways.</span></span>

<span data-ttu-id="e7d07-206">Pour les gestionnaires de menus statiques, le sous-menu **Rechercher** ou **Rechercher** est créé à partir des informations contenues dans le registre.</span><span class="sxs-lookup"><span data-stu-id="e7d07-206">For static menu handlers, the **Find** or **Search** submenu is created from the information in the registry.</span></span> <span data-ttu-id="e7d07-207">Il n’est pas nécessaire que le gestionnaire ajoute un élément de menu, comme le ferait un gestionnaire de menu contextuel normal.</span><span class="sxs-lookup"><span data-stu-id="e7d07-207">There is no need to have the handler add a menu item, as a normal shortcut menu handler would.</span></span> <span data-ttu-id="e7d07-208">L’interpréteur de commandes gère les gestionnaires de menus statiques de la façon suivante.</span><span class="sxs-lookup"><span data-stu-id="e7d07-208">The Shell manages static menu handlers in the following way.</span></span>

-   <span data-ttu-id="e7d07-209">Lorsque l’utilisateur lance l’élément de menu du gestionnaire, le shell charge la DLL du gestionnaire et appelle [**IContextMenu :: commande InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) pour indiquer au gestionnaire de lancer le moteur de recherche.</span><span class="sxs-lookup"><span data-stu-id="e7d07-209">When the user launches the handler's menu item, the Shell loads the handler's DLL and calls [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) to notify the handler to launch the search engine.</span></span> <span data-ttu-id="e7d07-210">Les méthodes [**IShellExtInit :: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) et [**IContextMenu :: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) ne sont pas appelées.</span><span class="sxs-lookup"><span data-stu-id="e7d07-210">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) methods are not called.</span></span>
-   <span data-ttu-id="e7d07-211">Quand [**IContextMenu :: commande InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) est appelé, le membre **lpVerb** de la structure [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) qui est passé identifie la commande.</span><span class="sxs-lookup"><span data-stu-id="e7d07-211">When [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) is called, the **lpVerb** member of the [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) structure that is passed in identifies the command.</span></span> <span data-ttu-id="e7d07-212">Le mot de poids faible de **lpVerb** est défini sur l’équivalent numérique du nom de la sous-clé de la commande.</span><span class="sxs-lookup"><span data-stu-id="e7d07-212">The low-order word of **lpVerb** is set to the numerical equivalent of the command's subkey name.</span></span> <span data-ttu-id="e7d07-213">Étant donné que cette sous-clé est normalement nommée **0**, **lpVerb** est généralement défini sur zéro.</span><span class="sxs-lookup"><span data-stu-id="e7d07-213">Since this subkey is normally named **0**, **lpVerb** is usually set to zero.</span></span> <span data-ttu-id="e7d07-214">Le gestionnaire doit ensuite lancer le moteur de recherche.</span><span class="sxs-lookup"><span data-stu-id="e7d07-214">The handler should then launch the search engine.</span></span>

<span data-ttu-id="e7d07-215">Les gestionnaires de recherche dynamique sont implémentés à peu près de la même façon que les gestionnaires de menus contextuels normaux.</span><span class="sxs-lookup"><span data-stu-id="e7d07-215">Dynamic search handlers are implemented in much the same way as normal shortcut menu handlers.</span></span> <span data-ttu-id="e7d07-216">L’exception principale est que lorsque [**IShellExtInit :: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) est appelé, les arguments *pidlFolder* et *lpdobj* ont la valeur **null**.</span><span class="sxs-lookup"><span data-stu-id="e7d07-216">The primary exception is that when [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) is called, the *pidlFolder* and *lpdobj* arguments are set to **NULL**.</span></span>

<span data-ttu-id="e7d07-217">Les gestionnaires de recherche DHTML sont implémentés en tant que document DHTML normal.</span><span class="sxs-lookup"><span data-stu-id="e7d07-217">DHTML-based search handlers are implemented as a normal DHTML document.</span></span> <span data-ttu-id="e7d07-218">Ils peuvent inclure toute technologie HTML, DHTML ou de script prise en charge par Windows Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="e7d07-218">They can include any HTML, DHTML, or scripting technology that is supported by Windows Internet Explorer.</span></span>

 

 