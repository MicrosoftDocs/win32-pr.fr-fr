---
title: Accès aux services vocaux (interface du serveur Microsoft Agent)
description: Accès aux services vocaux
ms.assetid: 99cf630d-3bd1-403a-833a-9173a84fe3c0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9eeb4afb2b05ca13c52d49508c3c25b7e02da676
ms.sourcegitcommit: 59ec383331366f8a62c94bb88468ca03e95c43f8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/13/2021
ms.locfileid: "107380803"
---
# <a name="accessing-speech-services-microsoft-agent-server-interface"></a><span data-ttu-id="ba0cd-103">Accès aux services vocaux (interface du serveur Microsoft Agent)</span><span class="sxs-lookup"><span data-stu-id="ba0cd-103">Accessing Speech Services (Microsoft Agent Server Interface)</span></span>

<span data-ttu-id="ba0cd-104">\[Microsoft Agent est déconseillé à partir de Windows 7 et peut ne pas être disponible dans les versions ultérieures de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="ba0cd-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="ba0cd-105">Bien que les services de Microsoft Agent incluent la prise en charge de l’entrée vocale, un moteur de reconnaissance vocale de commande et de contrôle compatible doit être installé pour accéder aux services d’entrée vocale de l’agent.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-105">Although Microsoft Agent's services include support for speech input, a compatible command-and-control speech recognition engine must be installed to access Agent's speech input services.</span></span> <span data-ttu-id="ba0cd-106">De même, si vous souhaitez utiliser les services de reconnaissance vocale de Microsoft Agent pour prendre en charge la synthèse vocale d’un caractère, vous devez installer un moteur de reconnaissance vocale de conversion de texte en parole (TTS) compatible pour votre caractère.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-106">Similarly, if you want to use Microsoft Agent's speech services to support synthesized speech output for a character, you must install a compatible text-to-speech (TTS) speech engine for your character.</span></span> <span data-ttu-id="ba0cd-107">Étant donné que les services de reconnaissance vocale de Microsoft Agent sont basés sur l’API Microsoft Speech (SAPI), vous pouvez utiliser tous les moteurs compatibles avec les interfaces vocales requises.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-107">Because Microsoft Agent's speech services are based on the Microsoft Speech API (SAPI), you can use any engines that compatibly support the required speech interfaces.</span></span>

<span data-ttu-id="ba0cd-108">Pour activer la prise en charge de l’entrée vocale dans votre application, définissez un objet de [**commande**](https://www.bing.com/search?q=**Command**) et définissez sa propriété [**Voice**](https://www.bing.com/search?q=**Voice**) .</span><span class="sxs-lookup"><span data-stu-id="ba0cd-108">To enable speech input support in your application, define a [**Command**](https://www.bing.com/search?q=**Command**) object and set its [**Voice**](https://www.bing.com/search?q=**Voice**) property.</span></span> <span data-ttu-id="ba0cd-109">Microsoft Agent chargera automatiquement les services vocaux, de sorte que lorsque l’utilisateur appuie sur la touche d’écoute ou que vous appelez [**Listen**](https://www.bing.com/search?q=**Listen**), le moteur de reconnaissance vocale est chargé.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-109">Microsoft Agent will automatically load speech services, so that when the user presses the Listening key or you call [**Listen**](https://www.bing.com/search?q=**Listen**), the speech recognition engine will be loaded.</span></span> <span data-ttu-id="ba0cd-110">Par défaut, l’ID de langue du caractère détermine quel moteur est chargé.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-110">By default the character's language ID will determine which engine is loaded.</span></span> <span data-ttu-id="ba0cd-111">L’agent tente de charger le premier moteur que SAPI retourne comme correspondant à cette langue.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-111">Agent attempts to load the first engine that SAPI returns as matching this language.</span></span> <span data-ttu-id="ba0cd-112">Utilisez **IAgentCharacterEx :: SetSRModeID** si vous souhaitez charger un moteur spécifique.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-112">Use **IAgentCharacterEx::SetSRModeID** if you want to load a specific engine.</span></span>

<span data-ttu-id="ba0cd-113">Pour activer la sortie de conversion de texte par synthèse vocale, utilisez la méthode [**Speak**](https://www.bing.com/search?q=**Speak**) .</span><span class="sxs-lookup"><span data-stu-id="ba0cd-113">To enable text-to-speech output, use the [**Speak**](https://www.bing.com/search?q=**Speak**) method.</span></span> <span data-ttu-id="ba0cd-114">Microsoft Agent tente automatiquement de charger un moteur qui correspond à l’ID de langue du caractère.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-114">Microsoft Agent will automatically attempt to load an engine that matches the character's language ID.</span></span> <span data-ttu-id="ba0cd-115">Si la définition du caractère comprend un ID de mode de moteur TTS spécifique et que le moteur est disponible et correspond à l’ID de langue du caractère, l’agent charge ce moteur pour le caractère.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-115">If the character's definition includes a specific TTS engine mode ID and that engine is available and matches the character's language ID, Agent loads that engine for the character.</span></span> <span data-ttu-id="ba0cd-116">Si ce n’est pas le cas, l’agent charge le premier moteur TTS retourné par SAPI comme correspondant au paramètre de langue du caractère.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-116">If not, Agent loads the first TTS engine that SAPI returns as matching the character's language setting.</span></span> <span data-ttu-id="ba0cd-117">Vous pouvez également utiliser **IAgentCharacterEx :: SetTTSModeID** pour charger un moteur spécifique.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-117">You can also use **IAgentCharacterEx::SetTTSModeID** to load a specific engine.</span></span>

<span data-ttu-id="ba0cd-118">En règle générale, Microsoft agent charge un moteur de reconnaissance vocale lorsque le mode d’écoute est initié et charge un moteur de synthèse vocale lorsque la fonction [**Speak**](https://www.bing.com/search?q=**Speak**) est appelée pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-118">Typically, Microsoft Agent loads a speech recognition engine when the Listening mode is initiated and loads a text-to-speech engine when [**Speak**](https://www.bing.com/search?q=**Speak**) is first called.</span></span> <span data-ttu-id="ba0cd-119">Toutefois, si vous souhaitez précharger le moteur de reconnaissance vocale, vous pouvez effectuer cette opération en interrogeant les propriétés relatives aux interfaces vocales.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-119">However, if you want to preload the speech engine, you can do this by querying the properties related to the speech interfaces.</span></span> <span data-ttu-id="ba0cd-120">Par exemple, si vous appelez **IAgentCharacterEx :: GetSRModeID** ou **IAgentCharacterEx :: GetTTSModeID** , vous tenterez de charger ce type de moteur.</span><span class="sxs-lookup"><span data-stu-id="ba0cd-120">For example, calling **IAgentCharacterEx::GetSRModeID** or **IAgentCharacterEx::GetTTSModeID** will attempt to load that type of engine.</span></span>

 

 




