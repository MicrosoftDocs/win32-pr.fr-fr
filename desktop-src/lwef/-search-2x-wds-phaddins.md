---
title: Développement de compléments de gestionnaires de protocole
description: Vous pouvez étendre Microsoft Windows Desktop Search (WDS) pour inclure de nouveaux magasins de données en implémentant un gestionnaire de protocole personnalisé.
ms.assetid: 2447d95f-5832-453c-8857-3b4f4c158177
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45a8688621f7d2fda653d769c0e1dfdadd240f49
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104507914"
---
# <a name="developing-protocol-handler-add-ins"></a><span data-ttu-id="d566f-103">Développement de compléments de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="d566f-103">Developing Protocol Handler Add-ins</span></span>

> [!NOTE]
> <span data-ttu-id="d566f-104">Windows Desktop Search 2. x est une technologie obsolète qui était à l’origine disponible en tant que complément pour Windows XP et Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="d566f-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="d566f-105">Dans les versions ultérieures, utilisez [Windows Search](../search/-search-3x-wds-overview.md) à la place.</span><span class="sxs-lookup"><span data-stu-id="d566f-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="d566f-106">Vous pouvez étendre Microsoft Windows Desktop Search (WDS) pour inclure de nouveaux magasins de données en implémentant un gestionnaire de protocole personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d566f-106">You can extend Microsoft Windows Desktop Search (WDS) to include new data stores by implementing a custom protocol handler.</span></span>

## <a name="indexing-data-stores-with-protocol-handlers"></a><span data-ttu-id="d566f-107">Indexation des magasins de données à l’aide de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="d566f-107">Indexing Data Stores with Protocol Handlers</span></span>

<span data-ttu-id="d566f-108">Un magasin de données est une source de contenu (système de base de données, répertoire, système de fichiers) dans laquelle les données sont stockées et peuvent être analysées par l’indexeur WDS.</span><span class="sxs-lookup"><span data-stu-id="d566f-108">A data store is a content source (a database system, a directory, a file system) where data is stored and can be crawled by the WDS Indexer.</span></span> <span data-ttu-id="d566f-109">Le magasin peut être hiérarchique (comme une base de données) ou basé sur des liens (comme un site Web).</span><span class="sxs-lookup"><span data-stu-id="d566f-109">The store can be hierarchical (like a database) or link-based (like a website).</span></span> <span data-ttu-id="d566f-110">Un gestionnaire de protocole permet d’indexer des applications telles que WDS pour analyser systématiquement les nœuds d’un magasin de données afin d’extraire les informations pertinentes à inclure dans l’index.</span><span class="sxs-lookup"><span data-stu-id="d566f-110">A protocol handler enables indexing applications like WDS to systematically crawl the nodes of a data store to extract relevant information to include in the index.</span></span> <span data-ttu-id="d566f-111">Chaque gestionnaire de protocole est utilisé pour indexer un type spécifique de magasin de données.</span><span class="sxs-lookup"><span data-stu-id="d566f-111">Each protocol handler is used to index a specific type of data store.</span></span> <span data-ttu-id="d566f-112">WDS est livré avec des gestionnaires de protocole pour les magasins de système de fichiers et pour les banques de données Microsoft Outlook et Microsoft Outlook Express (magasins de courrier électronique). Fichiers PST, etc.).</span><span class="sxs-lookup"><span data-stu-id="d566f-112">WDS ships with protocol handlers for file system stores and for both Microsoft Outlook and Microsoft Outlook Express data stores (email stores, .PST files, and so on).</span></span> <span data-ttu-id="d566f-113">Lors de l’indexation de la messagerie Outlook, par exemple, le gestionnaire de protocole analyse tous les messages de tous les dossiers en extrayant les informations de chaque message et pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="d566f-113">When indexing Outlook email, for example, the protocol handler crawls all messages in all folders extracting information from each message and attachment.</span></span> <span data-ttu-id="d566f-114">Ces informations sont transmises à l’indexeur à inclure dans le catalogue WDS.</span><span class="sxs-lookup"><span data-stu-id="d566f-114">This information is passed to the Indexer to include in the WDS catalog.</span></span>

<span data-ttu-id="d566f-115">Souvent, les utilisateurs doivent effectuer des recherches dans d’autres magasins de données, tels que les bases de données héritées, les magasins de messagerie ou les structures de données non pris en charge par WDS.</span><span class="sxs-lookup"><span data-stu-id="d566f-115">Often users need to search other data stores such as legacy databases, email stores or data structures not supported by WDS.</span></span> <span data-ttu-id="d566f-116">Vous pouvez étendre WDS pour analyser un nouveau magasin de données à l’aide de ou de l’implémentation d’un gestionnaire de protocole spécifiquement pour ce magasin de données.</span><span class="sxs-lookup"><span data-stu-id="d566f-116">You can extend WDS to crawl a new data store by using or implementing a protocol handler specifically for that data store.</span></span> <span data-ttu-id="d566f-117">Tout d’abord, vous devez déterminer si un gestionnaire de protocole existe déjà pour votre magasin de données, peut-être pour une utilisation avec une autre application telle que SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="d566f-117">First, you should first determine if a protocol handler already exists for your data store, perhaps for use with another application like SharePoint Services.</span></span> <span data-ttu-id="d566f-118">Dans ce cas, vous pouvez installer ce gestionnaire de protocole sur le système.</span><span class="sxs-lookup"><span data-stu-id="d566f-118">If so, you can install that protocol handler on the system.</span></span> <span data-ttu-id="d566f-119">Toutefois, si un autre gestionnaire de protocole n’existe pas, vous devez en implémenter un.</span><span class="sxs-lookup"><span data-stu-id="d566f-119">If, however, another protocol handler does not exist, then you need to implement one.</span></span> <span data-ttu-id="d566f-120">Les gestionnaires de protocole WDS utilisent les mêmes spécifications de conception que SharePoint Services et peuvent souvent être utilisés de manière interchangeable.</span><span class="sxs-lookup"><span data-stu-id="d566f-120">WDS protocol handlers use the same design specifications as SharePoint Services, and they can often be used interchangeably.</span></span>

<span data-ttu-id="d566f-121">En outre, si le magasin de données contient des données ou des types de fichier autres que l’un des types de fichiers 200 pris en charge par WDS, vous devez également implémenter un filtre pour accéder au contenu des éléments du magasin et l’indexer.</span><span class="sxs-lookup"><span data-stu-id="d566f-121">Furthermore, if the data store contains data or file types other than one of the 200 file types supported by WDS, you also need to implement a filter to access and index the contents of items in the store.</span></span> <span data-ttu-id="d566f-122">WDS 2. x utilise le gestionnaire de protocole et la technologie [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)utilisés par les services SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d566f-122">WDS 2.x uses the protocol handler and [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)technology used by SharePoint Services.</span></span> <span data-ttu-id="d566f-123">Si vous avez déjà des filtres pour un magasin et un type de fichier spécifiques installés sur le système en cours d’indexation, WDS utilise les interfaces existantes pour indexer ces données.</span><span class="sxs-lookup"><span data-stu-id="d566f-123">If you already have filters for a specific store and file type installed on the system being indexed, WDS uses the existing interfaces to index this data.</span></span>

 

## <a name="roadmap-to-adding-new-data-stores"></a><span data-ttu-id="d566f-124">Feuille de route pour l’ajout de nouveaux magasins de données</span><span class="sxs-lookup"><span data-stu-id="d566f-124">Roadmap to Adding New Data Stores</span></span>

<span data-ttu-id="d566f-125">Pour étendre WDS en vue d’analyser de nouveaux magasins de données, vous pouvez créer un gestionnaire de protocole et un ou plusieurs des compléments suivants : gestionnaire de menu contextuel, gestionnaire d’icône et complément SearchProtocolOptions.</span><span class="sxs-lookup"><span data-stu-id="d566f-125">To extend WDS to crawl new data stores, you can create a protocol handler and one or more of the following add-ins: context menu handler, icon handler and a SearchProtocolOptions add-in.</span></span>

1.  <span data-ttu-id="d566f-126">Créez et inscrivez un gestionnaire de protocole multithread pour le magasin de données :</span><span class="sxs-lookup"><span data-stu-id="d566f-126">Create and register a multithreaded protocol handler for the data store:</span></span>
    -   <span data-ttu-id="d566f-127">**ISearchProtocol** : cette interface accède à un protocole et mappe une URL à un IUrlAccessor.</span><span class="sxs-lookup"><span data-stu-id="d566f-127">**ISearchProtocol** - This interface accesses a protocol and maps a URL to an IUrlAccessor.</span></span>
    -   <span data-ttu-id="d566f-128">**IUrlAccessor** : il s’agit de l’interface principale utilisée pour accéder aux éléments à partir de la source de contenu et lier le contenu au filtre approprié.</span><span class="sxs-lookup"><span data-stu-id="d566f-128">**IUrlAccessor** - This is the main interface used for accessing items from the content source and binding the content to appropriate filter.</span></span>
    -   <span data-ttu-id="d566f-129">**IProtocolHandlerSite** : cette interface permet de demander et de charger des filtres supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="d566f-129">**IProtocolHandlerSite** - This interface is used to request and load additional filters.</span></span>
    -   <span data-ttu-id="d566f-130">**IFilter** : cette interface retourne l’URL de chaque élément d’un dossier en tant que propriétés de valeur pour le traitement.</span><span class="sxs-lookup"><span data-stu-id="d566f-130">**IFilter** - This interface returns the URL of each item in a folder as value properties for processing.</span></span>

    > [!Note]
    >
    > <span data-ttu-id="d566f-131">La fonctionnalité de complément minimale nécessaire pour retourner les résultats de recherche à partir d’un magasin de données non hiérarchique est une implémentation d’interfaces ISearchProtocol et IUrlAccessor.</span><span class="sxs-lookup"><span data-stu-id="d566f-131">The minimum add-in functionality needed to return search results from a non-hierarchical data store is an implementation of ISearchProtocol and IUrlAccessor interfaces.</span></span>

     

2.  <span data-ttu-id="d566f-132">Implémentez l’interface ISearchProtocolOptions pour inclure des options de gestionnaire de protocole personnalisées, telles que des pages de démarrage prédéfinies :</span><span class="sxs-lookup"><span data-stu-id="d566f-132">Implement the ISearchProtocolOptions interface to include customized protocol handler options, like predefined start page(s):</span></span>
    -   <span data-ttu-id="d566f-133">**ISearchProtocolOptions** : cette interface définit les URL par défaut que le gestionnaire de protocole doit traiter, détermine la configuration requise pour un gestionnaire de protocole et détermine si les spécifications ont été satisfaites sur un système donné.</span><span class="sxs-lookup"><span data-stu-id="d566f-133">**ISearchProtocolOptions** - This interface defines default URLs for the protocol handler to process, determines what the requirements are for a protocol handler, and determines whether the requirements have been met on a given system.</span></span>
3.  <span data-ttu-id="d566f-134">Étendez l’interpréteur de commandes pour inclure des éléments d’interface utilisateur, tels que des menus contextuels et des icônes spécifiques aux fichiers, en implémentant les interfaces suivantes :</span><span class="sxs-lookup"><span data-stu-id="d566f-134">Extend Shell to include user interface elements, like context menus and file-specific icons, by implementing the following interfaces:</span></span>
    -   <span data-ttu-id="d566f-135">**IShellFolder** : cette interface, qui est utilisée pour gérer les dossiers, est requise pour fournir les interfaces IContextMenu et IExtractIcon pour une URL dans un nouveau magasin.</span><span class="sxs-lookup"><span data-stu-id="d566f-135">**IShellFolder** - This interface, which is used to manage folders, is required to provide the IContextMenu and IExtractIcon interfaces for a URL in a new store.</span></span>
    -   <span data-ttu-id="d566f-136">**IPersistFolder** : cette interface est requise pour indiquer à un objet de dossier de Shell de s’initialiser.</span><span class="sxs-lookup"><span data-stu-id="d566f-136">**IPersistFolder** - This interface is required to instruct a Shell folder object to initialize itself.</span></span>
    -   <span data-ttu-id="d566f-137">**IPersist** : cette interface fournit l’identificateur de classe (CLSID) d’un objet qui peut être stocké de manière permanente dans le système.</span><span class="sxs-lookup"><span data-stu-id="d566f-137">**IPersist** - This interface supplies the class identifier (CLSID) of an object that can be stored persistently in the system.</span></span>
    -   <span data-ttu-id="d566f-138">**IContextMenu** : cette interface définit le menu contextuel d’un élément désigné par une URL.</span><span class="sxs-lookup"><span data-stu-id="d566f-138">**IContextMenu** - This interface defines the right-click context menu for an item pointed to by URL.</span></span>
    -   <span data-ttu-id="d566f-139">**IExtractIcon** : cette interface définit l’icône à afficher pour un élément désigné par une URL.</span><span class="sxs-lookup"><span data-stu-id="d566f-139">**IExtractIcon** - This interface defines the icon to display for an item pointed to by URL.</span></span>
4.  <span data-ttu-id="d566f-140">Implémentez un mécanisme pour notifier l’indexeur des modifications à votre banque de données :</span><span class="sxs-lookup"><span data-stu-id="d566f-140">Implement a mechanism to notify the Indexer of changes to your data store:</span></span>
    -   <span data-ttu-id="d566f-141">**ISearchItemsChangedSink** : cette interface permet à votre gestionnaire de protocole de notifier l’index des modifications apportées à votre magasin de données.</span><span class="sxs-lookup"><span data-stu-id="d566f-141">**ISearchItemsChangedSink** - This interface enables your protocol handler to notify the Index of changes to your data store.</span></span> <span data-ttu-id="d566f-142">Cela améliore les performances en garantissant que l’indexeur n’analyse pas l’intégralité du magasin sur les index incrémentiels.</span><span class="sxs-lookup"><span data-stu-id="d566f-142">This improves performance by ensuring the Indexer doesn't crawl the entire store on incremental indexes.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d566f-143">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="d566f-143">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="d566f-144">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="d566f-144">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="d566f-145">Implémentation d’un gestionnaire de protocole pour WDS</span><span class="sxs-lookup"><span data-stu-id="d566f-145">Implementing a Protocol Handler for WDS</span></span>](-search-2x-wds-phimplementing.md)
</dt> <dt>

[<span data-ttu-id="d566f-146">Ajout d’icônes, d’aperçus et de menus contextuels avec des extensions de Shell</span><span class="sxs-lookup"><span data-stu-id="d566f-146">Adding Icons, Previews, and Context Menus with Shell Extensions</span></span>](-search-2x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="d566f-147">Notification de l’index des modifications</span><span class="sxs-lookup"><span data-stu-id="d566f-147">Notifying the Index of Changes</span></span>](-search-2x-wds-notifyingofchanges.md)
</dt> <dt>

[<span data-ttu-id="d566f-148">Installation et inscription de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="d566f-148">Installing and Registering Protocol Handlers</span></span>](-search-2x-wds-ph-install-registration.md)
</dt> </dl>

 

 