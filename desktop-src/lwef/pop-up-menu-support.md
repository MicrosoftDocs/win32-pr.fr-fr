---
title: Prise en charge des menus contextuels
description: Prise en charge des menus contextuels
ms.assetid: a8a1cf91-c18a-497f-89a7-b47536eaca0a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 890d7eab6595200cb00e8422644b10f39807bab2
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104315036"
---
# <a name="pop-up-menu-support"></a><span data-ttu-id="49b70-103">Prise en charge des menus contextuels</span><span class="sxs-lookup"><span data-stu-id="49b70-103">Pop-up Menu Support</span></span>

<span data-ttu-id="49b70-104">\[Microsoft Agent est déconseillé à partir de Windows 7 et peut ne pas être disponible dans les versions ultérieures de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="49b70-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="49b70-105">Microsoft Agent comprend un menu contextuel (également appelé menu contextuel) pour chaque caractère.</span><span class="sxs-lookup"><span data-stu-id="49b70-105">Microsoft Agent includes a pop-up menu (also known as a contextual menu) for each character.</span></span> <span data-ttu-id="49b70-106">Le serveur affiche automatiquement ce menu contextuel quand un utilisateur clique avec le bouton droit sur le caractère.</span><span class="sxs-lookup"><span data-stu-id="49b70-106">The server displays this pop-up menu automatically when a user right-clicks the character.</span></span> <span data-ttu-id="49b70-107">Vous pouvez ajouter des commandes pour votre application cliente au menu en définissant une collection de [**commandes**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="49b70-107">You can add commands for your client application to the menu by defining a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="49b70-108">Pour chaque commande de la collection que vous définissez, vous pouvez spécifier la [**légende**](caption-property.md) et les propriétés [**visibles**](visible-property.md) .</span><span class="sxs-lookup"><span data-stu-id="49b70-108">For each command in the collection that you define, you can specify [**Caption**](caption-property.md) and [**Visible**](visible-property.md) properties.</span></span> <span data-ttu-id="49b70-109">La **légende** est le texte qui apparaît dans le menu lorsque la propriété **visible** a la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="49b70-109">The **Caption** is the text that appears in the menu when the **Visible** property is set to **True**.</span></span> <span data-ttu-id="49b70-110">Vous pouvez également utiliser la propriété [**Enabled**](enabled-property.md) pour afficher la commande dans le menu comme Disabled et [**HelpContextID**](helpcontextid-property.md) pour prendre en charge la prise en charge de l’aide pour la propriété.</span><span class="sxs-lookup"><span data-stu-id="49b70-110">You can also use the [**Enabled**](enabled-property.md) property to display the command in the menu as disabled and the [**HelpContextID**](helpcontextid-property.md) to support Help support for the property.</span></span> <span data-ttu-id="49b70-111">Définissez la touche d’accès pour le texte du menu en incluant une esperluette (&) avant le caractère de texte du paramètre de texte de la **légende** .</span><span class="sxs-lookup"><span data-stu-id="49b70-111">Define the access key for the menu text by including an ampersand (&) before the text character of the **Caption** text setting.</span></span>

<span data-ttu-id="49b70-112">Le serveur ajoute automatiquement aux commandes de menu pour ouvrir la fenêtre commandes vocales et masquer le caractère ainsi que les légendes des [**commandes**](/windows/desktop/lwef/the-commands-collection-object) des autres clients du caractère pour permettre aux utilisateurs de basculer entre les clients.</span><span class="sxs-lookup"><span data-stu-id="49b70-112">The server automatically adds to the menu commands for opening the Voice Commands Window and hiding the character as well as the [**Commands**](/windows/desktop/lwef/the-commands-collection-object) captions of other clients of the character to enable users to switch between clients.</span></span> <span data-ttu-id="49b70-113">Le serveur ajoute automatiquement un séparateur au menu entre ses entrées de menu et celles définies par le client.</span><span class="sxs-lookup"><span data-stu-id="49b70-113">The server automatically adds a separator to the menu between its menu entries and those defined by the client.</span></span> <span data-ttu-id="49b70-114">Les séparateurs s’affichent uniquement lorsqu’il existe des éléments dans le menu à séparer.</span><span class="sxs-lookup"><span data-stu-id="49b70-114">Separators appear only when there are items in the menu to separate.</span></span>

<span data-ttu-id="49b70-115">Pour supprimer des commandes d’un menu, utilisez la méthode [**Remove**](remove-method.md) .</span><span class="sxs-lookup"><span data-stu-id="49b70-115">To remove commands from a menu, use the [**Remove**](remove-method.md) method.</span></span> <span data-ttu-id="49b70-116">Notez que les entrées de menu ne changent pas pendant que le menu s’affiche.</span><span class="sxs-lookup"><span data-stu-id="49b70-116">Note that menu entries do not change while the menu displays.</span></span> <span data-ttu-id="49b70-117">Si vous ajoutez ou supprimez des commandes ou modifiez leurs propriétés, le menu affiche les modifications lorsque l’utilisateur réaffiche le menu.</span><span class="sxs-lookup"><span data-stu-id="49b70-117">If you add or remove commands or change their properties, the menu displays the changes when the user redisplays the menu.</span></span>

<span data-ttu-id="49b70-118">Si vous préférez fournir vos propres services de menu contextuel pour un caractère, vous pouvez utiliser la propriété [**AutoPopupMenu**](autopopupmenu-property.md) pour désactiver la gestion du serveur de l’action de clic droit.</span><span class="sxs-lookup"><span data-stu-id="49b70-118">If you prefer to provide your own pop-up menu services for a character, you can use the [**AutoPopupMenu**](autopopupmenu-property.md) property to turn off server handling of the right-click action.</span></span> <span data-ttu-id="49b70-119">Vous pouvez ensuite utiliser la notification d’événement [**Click**](click-event.md) pour créer votre propre comportement de gestion de menu.</span><span class="sxs-lookup"><span data-stu-id="49b70-119">You can then use the [**Click**](click-event.md) event notification to create your own menu handling behavior.</span></span>

<span data-ttu-id="49b70-120">Lorsque l’utilisateur sélectionne une commande dans le menu contextuel d’un caractère ou dans la fenêtre commandes vocales, le serveur déclenche l’événement de [**commande**](command-event.md) du client associé et transmet les paramètres de l’entrée à l’aide de l’objet [**UserInput**](/windows/desktop/lwef/iagentuserinput) .</span><span class="sxs-lookup"><span data-stu-id="49b70-120">When the user selects a command from a character's pop-up menu or the Voice Commands Window, the server triggers the [**Command**](command-event.md) event of the associated client and passes back the parameters of the input using the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object.</span></span>

<span data-ttu-id="49b70-121">Le serveur fournit également un menu contextuel pour l’icône de barre des tâches du caractère.</span><span class="sxs-lookup"><span data-stu-id="49b70-121">The server also provides a pop-up menu for the character's taskbar icon.</span></span> <span data-ttu-id="49b70-122">Lorsque le caractère est visible, cliquez avec le bouton droit sur ce menu pour afficher les mêmes commandes que celles affichées en cliquant avec le bouton droit sur le caractère.</span><span class="sxs-lookup"><span data-stu-id="49b70-122">When the character is visible, right-clicking this menu displays the same commands as those displayed by right-clicking the character.</span></span> <span data-ttu-id="49b70-123">Toutefois, lorsque le caractère est masqué, seules les commandes fournies par le serveur sont incluses.</span><span class="sxs-lookup"><span data-stu-id="49b70-123">However, when the character is hidden, only the server-supplied commands are included.</span></span>

 

 