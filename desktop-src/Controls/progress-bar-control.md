---
title: À propos des contrôles de barre de progression
description: Une barre de progression est une fenêtre qu’une application peut utiliser pour indiquer la progression d’une longue opération. Il se compose d’un rectangle animé à mesure qu’une opération progresse.
ms.assetid: 1db7a5c9-71cd-4ebc-86b8-8159f30348fa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f00c80b1f9e97cec1657fe979a19437f607251b8
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730452"
---
# <a name="about-progress-bar-controls"></a><span data-ttu-id="72f40-104">À propos des contrôles de barre de progression</span><span class="sxs-lookup"><span data-stu-id="72f40-104">About Progress Bar Controls</span></span>

<span data-ttu-id="72f40-105">Une barre de progression est une fenêtre qu’une application peut utiliser pour indiquer la progression d’une longue opération.</span><span class="sxs-lookup"><span data-stu-id="72f40-105">A progress bar is a window that an application can use to indicate the progress of a lengthy operation.</span></span>

<span data-ttu-id="72f40-106">Il se compose d’un rectangle animé à mesure qu’une opération progresse.</span><span class="sxs-lookup"><span data-stu-id="72f40-106">It consists of a rectangle that is animated as an operation progresses.</span></span>

<span data-ttu-id="72f40-107">L’illustration suivante montre une barre de progression qui n’utilise pas les styles visuels.</span><span class="sxs-lookup"><span data-stu-id="72f40-107">The following illustration shows a progress bar that does not use visual styles.</span></span>

![capture d’écran d’une barre de progression qui ajoute des rectangles dans une ligne pour indiquer la progression](images/pb-oldstyle.png)

<span data-ttu-id="72f40-109">L’illustration suivante montre une barre de progression à l’aide de styles visuels.</span><span class="sxs-lookup"><span data-stu-id="72f40-109">The following illustration shows a progress bar using visual styles.</span></span> <span data-ttu-id="72f40-110">L’apparence du contrôle varie selon le système d’exploitation et le thème sélectionné.</span><span class="sxs-lookup"><span data-stu-id="72f40-110">The appearance of the control will vary depending on the operating system and the selected theme.</span></span> <span data-ttu-id="72f40-111">Pour plus d’informations, consultez [styles visuels](themes-overview.md).</span><span class="sxs-lookup"><span data-stu-id="72f40-111">For more information, see [Visual Styles](themes-overview.md).</span></span>

![capture d’écran d’une barre de progression qui allonge un rectangle vert animé pour indiquer la progression](images/pb-newstyle.png)

<span data-ttu-id="72f40-113">Des informations supplémentaires sont contenues dans les en-têtes suivants.</span><span class="sxs-lookup"><span data-stu-id="72f40-113">More information is contained under the following headings.</span></span>

-   [<span data-ttu-id="72f40-114">Utilisation des barres de progression</span><span class="sxs-lookup"><span data-stu-id="72f40-114">Using Progress Bars</span></span>](#using-progress-bars)
    -   [<span data-ttu-id="72f40-115">Plage et position actuelle</span><span class="sxs-lookup"><span data-stu-id="72f40-115">Range and Current Position</span></span>](#range-and-current-position)
    -   [<span data-ttu-id="72f40-116">Traitement par défaut des messages de la barre de progression</span><span class="sxs-lookup"><span data-stu-id="72f40-116">Default Progress Bar Message Processing</span></span>](#default-progress-bar-message-processing)
    -   [<span data-ttu-id="72f40-117">Style de texte défilant</span><span class="sxs-lookup"><span data-stu-id="72f40-117">Marquee Style</span></span>](#marquee-style)

## <a name="using-progress-bars"></a><span data-ttu-id="72f40-118">Utilisation des barres de progression</span><span class="sxs-lookup"><span data-stu-id="72f40-118">Using Progress Bars</span></span>

<span data-ttu-id="72f40-119">Vous pouvez créer une barre de progression à l’aide de la fonction [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) , en spécifiant la classe de fenêtre [**Progress \_ Class**](common-control-window-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="72f40-119">You can create a progress bar by using the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, specifying the [**PROGRESS\_CLASS**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="72f40-120">Cette classe de fenêtre est inscrite lors du chargement de la DLL de contrôles communs.</span><span class="sxs-lookup"><span data-stu-id="72f40-120">This window class is registered when the common controls DLL is loaded.</span></span> <span data-ttu-id="72f40-121">Pour plus d’informations, consultez [à propos des contrôles communs](common-controls-intro.md).</span><span class="sxs-lookup"><span data-stu-id="72f40-121">For more information, see [About Common Controls](common-controls-intro.md).</span></span>

<span data-ttu-id="72f40-122">Le contrôle est également disponible dans la boîte à outils Microsoft Visual Studio, où il est appelé contrôle de progression.</span><span class="sxs-lookup"><span data-stu-id="72f40-122">The control is also available in the Microsoft Visual Studio Toolbox, where it is called Progress Control.</span></span>

### <a name="range-and-current-position"></a><span data-ttu-id="72f40-123">Plage et position actuelle</span><span class="sxs-lookup"><span data-stu-id="72f40-123">Range and Current Position</span></span>

<span data-ttu-id="72f40-124">La *plage* d’une barre de progression représente la durée totale de l’opération, tandis que la *position actuelle* représente la progression de l’application vers la fin de l’opération.</span><span class="sxs-lookup"><span data-stu-id="72f40-124">A progress bar's *range* represents the entire duration of the operation, and the *current position* represents the progress that the application has made toward completing the operation.</span></span> <span data-ttu-id="72f40-125">La procédure de fenêtre utilise la plage et la position actuelle pour déterminer le pourcentage de la barre de progression à remplir avec la couleur de surbrillance.</span><span class="sxs-lookup"><span data-stu-id="72f40-125">The window procedure uses the range and the current position to determine the percentage of the progress bar to fill with the highlight color.</span></span>

<span data-ttu-id="72f40-126">Si vous ne définissez pas les valeurs de plage, le système définit la valeur minimale sur 0 et la valeur maximale sur 100.</span><span class="sxs-lookup"><span data-stu-id="72f40-126">If you do not set the range values, the system sets the minimum value to 0 and the maximum value to 100.</span></span> <span data-ttu-id="72f40-127">Vous pouvez ajuster la plage à des entiers pratiques à l’aide du message [**PBM \_ SetRange**](pbm-setrange.md) .</span><span class="sxs-lookup"><span data-stu-id="72f40-127">You can adjust the range to convenient integers by using the [**PBM\_SETRANGE**](pbm-setrange.md) message.</span></span>

<span data-ttu-id="72f40-128">Une barre de progression fournit plusieurs messages que vous pouvez utiliser pour définir la position actuelle.</span><span class="sxs-lookup"><span data-stu-id="72f40-128">A progress bar provides several messages that you can use to set the current position.</span></span> <span data-ttu-id="72f40-129">Le message [**PBM \_ SetPos**](pbm-setpos.md) définit la position sur une valeur donnée.</span><span class="sxs-lookup"><span data-stu-id="72f40-129">The [**PBM\_SETPOS**](pbm-setpos.md) message sets the position to a given value.</span></span> <span data-ttu-id="72f40-130">Le message [**PBM \_ DELTAPOS**](pbm-deltapos.md) avance la position en ajoutant une valeur spécifiée à la position actuelle.</span><span class="sxs-lookup"><span data-stu-id="72f40-130">The [**PBM\_DELTAPOS**](pbm-deltapos.md) message advances the position by adding a specified value to the current position.</span></span>

<span data-ttu-id="72f40-131">Le message [**PBM \_ SETSTEP**](pbm-setstep.md) vous permet de spécifier un incrément d’étape pour une barre de progression.</span><span class="sxs-lookup"><span data-stu-id="72f40-131">The [**PBM\_SETSTEP**](pbm-setstep.md) message allows you to specify a step increment for a progress bar.</span></span> <span data-ttu-id="72f40-132">Par la suite, chaque fois que vous envoyez le message [**PBM \_ STEPIT**](pbm-stepit.md) à la barre de progression, la position actuelle avance de l’incrément spécifié.</span><span class="sxs-lookup"><span data-stu-id="72f40-132">Subsequently, whenever you send the [**PBM\_STEPIT**](pbm-stepit.md) message to the progress bar, the current position advances by the specified increment.</span></span> <span data-ttu-id="72f40-133">Par défaut, l’incrément de l’étape est défini sur 10.</span><span class="sxs-lookup"><span data-stu-id="72f40-133">By default, the step increment is set to 10.</span></span>

### <a name="default-progress-bar-message-processing"></a><span data-ttu-id="72f40-134">Traitement par défaut des messages de la barre de progression</span><span class="sxs-lookup"><span data-stu-id="72f40-134">Default Progress Bar Message Processing</span></span>

<span data-ttu-id="72f40-135">Cette section décrit les messages traités par la procédure de fenêtre pour la classe de la [**\_ classe Progress**](common-control-window-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="72f40-135">This section describes the messages handled by the window procedure for the [**PROGRESS\_CLASS**](common-control-window-classes.md) class.</span></span>



| <span data-ttu-id="72f40-136">Message</span><span class="sxs-lookup"><span data-stu-id="72f40-136">Message</span></span>            | <span data-ttu-id="72f40-137">Traitement effectué</span><span class="sxs-lookup"><span data-stu-id="72f40-137">Processing performed</span></span>                                                                                                                                                               |
|--------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="72f40-138">**création de WM \_**</span><span class="sxs-lookup"><span data-stu-id="72f40-138">**WM\_CREATE**</span></span>     | <span data-ttu-id="72f40-139">Alloue et Initialise une structure initiale.</span><span class="sxs-lookup"><span data-stu-id="72f40-139">Allocates and initializes an initial structure.</span></span>                                                                                                                                    |
| <span data-ttu-id="72f40-140">**\_destructeur WM**</span><span class="sxs-lookup"><span data-stu-id="72f40-140">**WM\_DESTROY**</span></span>    | <span data-ttu-id="72f40-141">Libère toutes les ressources associées à la barre de progression.</span><span class="sxs-lookup"><span data-stu-id="72f40-141">Frees all resources associated with the progress bar.</span></span>                                                                                                                              |
| <span data-ttu-id="72f40-142">**\_ERASEBKGND WM**</span><span class="sxs-lookup"><span data-stu-id="72f40-142">**WM\_ERASEBKGND**</span></span> | <span data-ttu-id="72f40-143">Dessine l’arrière-plan et les bordures de la barre de progression.</span><span class="sxs-lookup"><span data-stu-id="72f40-143">Draws the background and borders of the progress bar.</span></span>                                                                                                                              |
| <span data-ttu-id="72f40-144">**WM \_ GETFONT**</span><span class="sxs-lookup"><span data-stu-id="72f40-144">**WM\_GETFONT**</span></span>    | <span data-ttu-id="72f40-145">Retourne le handle de la police actuelle.</span><span class="sxs-lookup"><span data-stu-id="72f40-145">Returns the handle to the current font.</span></span> <span data-ttu-id="72f40-146">La barre de progression ne dessine pas de texte. par conséquent, l’envoi de ce message n’a aucun effet sur le contrôle.</span><span class="sxs-lookup"><span data-stu-id="72f40-146">The progress bar does not currently draw text, so sending this message has no effect on the control.</span></span>                                       |
| <span data-ttu-id="72f40-147">**\_peinture WM**</span><span class="sxs-lookup"><span data-stu-id="72f40-147">**WM\_PAINT**</span></span>      | <span data-ttu-id="72f40-148">Dessine la barre de progression.</span><span class="sxs-lookup"><span data-stu-id="72f40-148">Draws the progress bar.</span></span> <span data-ttu-id="72f40-149">Si le paramètre *wParam* est non **null**, le contrôle suppose que la valeur est un HDC et peint à l’aide de ce contexte de périphérique.</span><span class="sxs-lookup"><span data-stu-id="72f40-149">If the *wParam* parameter is non-**NULL**, the control assumes that the value is an HDC and paints using that device context.</span></span>                              |
| <span data-ttu-id="72f40-150">**\_SetFont WM**</span><span class="sxs-lookup"><span data-stu-id="72f40-150">**WM\_SETFONT**</span></span>    | <span data-ttu-id="72f40-151">Enregistre le handle dans la nouvelle police et retourne le handle de la police précédente.</span><span class="sxs-lookup"><span data-stu-id="72f40-151">Saves the handle to the new font and returns the handle to the previous font.</span></span> <span data-ttu-id="72f40-152">La barre de progression ne dessine pas de texte. par conséquent, l’envoi de ce message n’a aucun effet sur le contrôle.</span><span class="sxs-lookup"><span data-stu-id="72f40-152">The progress bar does not currently draw text, so sending this message has no effect on the control.</span></span> |



 

### <a name="marquee-style"></a><span data-ttu-id="72f40-153">Style de texte défilant</span><span class="sxs-lookup"><span data-stu-id="72f40-153">Marquee Style</span></span>

<span data-ttu-id="72f40-154">En créant le contrôle de barre de progression avec le style [**PBS \_ Marquee**](progress-bar-control-styles.md) , vous pouvez l’animer de façon à afficher l’activité, mais n’indique pas quelle proportion de la tâche est terminée.</span><span class="sxs-lookup"><span data-stu-id="72f40-154">By creating the progress bar control with the [**PBS\_MARQUEE**](progress-bar-control-styles.md) style, you can animate it in a way that shows activity but does not indicate what proportion of the task is complete.</span></span> <span data-ttu-id="72f40-155">La partie mise en surbrillance de la barre de progression se déplace de façon répétée le long de la longueur de la barre.</span><span class="sxs-lookup"><span data-stu-id="72f40-155">The highlighted part of the progress bar moves repeatedly along the length of the bar.</span></span> <span data-ttu-id="72f40-156">Vous pouvez démarrer et arrêter l’animation et contrôler sa vitesse, en envoyant le message [**PBM \_ SETMARQUEE**](pbm-setmarquee.md) .</span><span class="sxs-lookup"><span data-stu-id="72f40-156">You can start and stop the animation, and control its speed, by sending the [**PBM\_SETMARQUEE**](pbm-setmarquee.md) message.</span></span> <span data-ttu-id="72f40-157">Les barres de progression de texte défilant n’ont pas de plage ou de position.</span><span class="sxs-lookup"><span data-stu-id="72f40-157">Marquee progress bars do not have a range or position.</span></span>

<span data-ttu-id="72f40-158">L’illustration suivante montre une barre de progression en mode palissade.</span><span class="sxs-lookup"><span data-stu-id="72f40-158">The following illustration shows a progress bar in marquee mode.</span></span> <span data-ttu-id="72f40-159">La partie en surbrillance se déplace dans la barre.</span><span class="sxs-lookup"><span data-stu-id="72f40-159">The highlighted part moves across the bar.</span></span>

![capture d’écran d’une barre de progression qui déplace une surbrillance verte dans un rectangle gris pour indiquer la progression](images/pb-marquee.png)

 

 