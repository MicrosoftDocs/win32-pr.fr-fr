---
title: À propos des zones de liste modifiable
description: Cette section décrit les différents types de zones de liste déroulante.
ms.assetid: 76410a87-aa0e-4da9-9e78-c80ac485e3cd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 344596a3c0aa772568956344aaddcc053b534993
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104558417"
---
# <a name="about-combo-boxes"></a><span data-ttu-id="44dd4-103">À propos des zones de liste modifiable</span><span class="sxs-lookup"><span data-stu-id="44dd4-103">About Combo Boxes</span></span>

<span data-ttu-id="44dd4-104">Une zone de liste déroulante combine une zone d’édition ou du texte statique et une liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-104">A combo box combines an edit box or static text and a list.</span></span>

<span data-ttu-id="44dd4-105">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="44dd4-105">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="44dd4-106">Types et styles de zone de liste déroulante</span><span class="sxs-lookup"><span data-stu-id="44dd4-106">Combo Box Types and Styles</span></span>](#combo-box-types-and-styles)
-   [<span data-ttu-id="44dd4-107">Liste de zones de liste modifiable</span><span class="sxs-lookup"><span data-stu-id="44dd4-107">Combo Box List</span></span>](#combo-box-list)
    -   [<span data-ttu-id="44dd4-108">Sélection actuelle</span><span class="sxs-lookup"><span data-stu-id="44dd4-108">Current Selection</span></span>](#current-selection)
    -   [<span data-ttu-id="44dd4-109">Listes déroulantes</span><span class="sxs-lookup"><span data-stu-id="44dd4-109">Drop-down Lists</span></span>](#drop-down-lists)
    -   [<span data-ttu-id="44dd4-110">Lister le contenu</span><span class="sxs-lookup"><span data-stu-id="44dd4-110">List Contents</span></span>](#list-contents)
-   [<span data-ttu-id="44dd4-111">Modifier les champs de sélection du contrôle</span><span class="sxs-lookup"><span data-stu-id="44dd4-111">Edit Control Selection Fields</span></span>](#edit-control-selection-fields)
-   [<span data-ttu-id="44dd4-112">Zones de liste déroulante owner-drawn</span><span class="sxs-lookup"><span data-stu-id="44dd4-112">Owner-Drawn Combo Boxes</span></span>](#owner-drawn-combo-boxes)
-   [<span data-ttu-id="44dd4-113">Zones de liste déroulante sous-classées</span><span class="sxs-lookup"><span data-stu-id="44dd4-113">Subclassed Combo Boxes</span></span>](#subclassed-combo-boxes)

## <a name="combo-box-types-and-styles"></a><span data-ttu-id="44dd4-114">Types et styles de zone de liste déroulante</span><span class="sxs-lookup"><span data-stu-id="44dd4-114">Combo Box Types and Styles</span></span>

<span data-ttu-id="44dd4-115">Une zone de liste déroulante se compose d’une liste et d’un champ de sélection.</span><span class="sxs-lookup"><span data-stu-id="44dd4-115">A combo box consists of a list and a selection field.</span></span> <span data-ttu-id="44dd4-116">La liste présente les options qu’un utilisateur peut sélectionner et le champ de sélection affiche la sélection actuelle.</span><span class="sxs-lookup"><span data-stu-id="44dd4-116">The list presents the options that a user can select, and the selection field displays the current selection.</span></span> <span data-ttu-id="44dd4-117">Si le champ de sélection est un contrôle d’édition, l’utilisateur peut entrer des informations non disponibles dans la liste ; dans le cas contraire, l’utilisateur ne peut sélectionner que les éléments de la liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-117">If the selection field is an edit control, the user can enter information not available in the list; otherwise, the user can only select items in the list.</span></span>

<span data-ttu-id="44dd4-118">La bibliothèque de contrôles communs comprend trois styles principaux de zone de liste déroulante, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="44dd4-118">The common controls library includes three main styles of combo box, as shown in the following table.</span></span>



| <span data-ttu-id="44dd4-119">Type de zone de liste déroulante</span><span class="sxs-lookup"><span data-stu-id="44dd4-119">Combo box type</span></span>             | <span data-ttu-id="44dd4-120">Style, constante</span><span class="sxs-lookup"><span data-stu-id="44dd4-120">Style constant</span></span>                                                 | <span data-ttu-id="44dd4-121">Description</span><span class="sxs-lookup"><span data-stu-id="44dd4-121">Description</span></span>                                                                                  |
|----------------------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| <span data-ttu-id="44dd4-122">Simple</span><span class="sxs-lookup"><span data-stu-id="44dd4-122">Simple</span></span>                     | [<span data-ttu-id="44dd4-123">**CBS \_ simple**</span><span class="sxs-lookup"><span data-stu-id="44dd4-123">**CBS\_SIMPLE**</span></span>](combo-box-styles.md)             | <span data-ttu-id="44dd4-124">Affiche la liste à tout moment et affiche l’élément sélectionné dans un contrôle d’édition.</span><span class="sxs-lookup"><span data-stu-id="44dd4-124">Displays the list at all times, and shows the selected item in an edit control.</span></span>              |
| <span data-ttu-id="44dd4-125">Drop-down</span><span class="sxs-lookup"><span data-stu-id="44dd4-125">Drop-down</span></span>                  | [<span data-ttu-id="44dd4-126">**\_liste déroulante CBS**</span><span class="sxs-lookup"><span data-stu-id="44dd4-126">**CBS\_DROPDOWN**</span></span>](combo-box-styles.md)         | <span data-ttu-id="44dd4-127">Affiche la liste lorsque l’utilisateur clique sur l’icône et affiche l’élément sélectionné dans un contrôle d’édition.</span><span class="sxs-lookup"><span data-stu-id="44dd4-127">Displays the list when the icon is clicked, and shows the selected item in an edit control.</span></span>  |
| <span data-ttu-id="44dd4-128">Liste déroulante (liste déroulante)</span><span class="sxs-lookup"><span data-stu-id="44dd4-128">Drop-down list (drop list)</span></span> | [<span data-ttu-id="44dd4-129">**\_DropDownList SCC**</span><span class="sxs-lookup"><span data-stu-id="44dd4-129">**CBS\_DROPDOWNLIST**</span></span>](combo-box-styles.md) | <span data-ttu-id="44dd4-130">Affiche la liste lorsque l’utilisateur clique sur l’icône et affiche l’élément sélectionné dans un contrôle statique.</span><span class="sxs-lookup"><span data-stu-id="44dd4-130">Displays the list when the icon is clicked, and shows the selected item in a static control.</span></span> |



 

<span data-ttu-id="44dd4-131">Les captures d’écran suivantes montrent chacune les trois sortes de zone de liste déroulante telles qu’elles peuvent apparaître dans Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="44dd4-131">The following screen shots each show the three kinds of combo box as they might appear in Windows Vista.</span></span> <span data-ttu-id="44dd4-132">Dans la première capture d’écran, l’utilisateur a sélectionné un élément dans la zone de liste déroulante simple.</span><span class="sxs-lookup"><span data-stu-id="44dd4-132">In the first screen shot, the user has selected an item in the simple combo box.</span></span> <span data-ttu-id="44dd4-133">L’utilisateur peut également taper une nouvelle valeur dans la zone d’édition de ce contrôle.</span><span class="sxs-lookup"><span data-stu-id="44dd4-133">The user can also type a new value in the edit box of this control.</span></span> <span data-ttu-id="44dd4-134">La liste a été dimensionnée dans l’éditeur de ressources Microsoft Visual Studio et n’est suffisante que pour accueillir deux éléments.</span><span class="sxs-lookup"><span data-stu-id="44dd4-134">The list has been sized in the Microsoft Visual Studio resource editor and is only large enough to accommodate two items.</span></span>

![capture d’écran montrant un élément sélectionné dans une zone de liste modifiable simple](images/simplecombo.png)

<span data-ttu-id="44dd4-136">Dans la deuxième capture d’écran, l’utilisateur a tapé un nouveau texte dans le contrôle d’édition de la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-136">In the second screen shot, the user has typed new text in the edit control of the drop-down combo box.</span></span> <span data-ttu-id="44dd4-137">L’utilisateur peut également avoir sélectionné un élément existant.</span><span class="sxs-lookup"><span data-stu-id="44dd4-137">The user could also have selected an existing item.</span></span> <span data-ttu-id="44dd4-138">La zone de liste se développe pour accueillir autant d’éléments que possible.</span><span class="sxs-lookup"><span data-stu-id="44dd4-138">The list box expands to accommodate as many items as possible.</span></span>

![capture d’écran montrant le texte tapé dans une zone de liste déroulante](images/dropdown.png)

<span data-ttu-id="44dd4-140">Dans la troisième capture d’écran, l’utilisateur a ouvert la zone de liste déroulante de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-140">In the third screen shot, the user has opened the drop-down list combo box.</span></span> <span data-ttu-id="44dd4-141">La zone de liste se développe pour accueillir autant d’éléments que possible.</span><span class="sxs-lookup"><span data-stu-id="44dd4-141">The list box expands to accommodate as many items as possible.</span></span> <span data-ttu-id="44dd4-142">L’utilisateur ne peut pas entrer de nouveau texte.</span><span class="sxs-lookup"><span data-stu-id="44dd4-142">The user cannot enter new text.</span></span>

![capture d’écran montrant un élément sélectionné dans une zone de liste déroulante de liste déroulante](images/droplist.png)

<span data-ttu-id="44dd4-144">Il existe également un certain nombre de styles de zone de liste déroulante qui définissent des propriétés spécifiques.</span><span class="sxs-lookup"><span data-stu-id="44dd4-144">There are also a number of combo box styles that define specific properties.</span></span> <span data-ttu-id="44dd4-145">Les styles de zone de liste modifiable définissent des propriétés spécifiques d’une zone de liste modifiable.</span><span class="sxs-lookup"><span data-stu-id="44dd4-145">Combo box styles define specific properties of a combo box.</span></span> <span data-ttu-id="44dd4-146">Vous pouvez combiner des styles. Toutefois, certains styles s’appliquent uniquement à certains types de zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-146">You can combine styles; however, some styles apply only to certain combo box types.</span></span> <span data-ttu-id="44dd4-147">Pour obtenir un tableau des styles de zone de liste déroulante, consultez [styles de zone de liste déroulante](combo-box-styles.md).</span><span class="sxs-lookup"><span data-stu-id="44dd4-147">For a table of combo box styles, see [Combo Box Styles](combo-box-styles.md).</span></span>

> [!Note]  
> <span data-ttu-id="44dd4-148">Pour utiliser des styles visuels avec des zones de liste déroulante, une application doit inclure un manifeste et doit appeler [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) au début du programme.</span><span class="sxs-lookup"><span data-stu-id="44dd4-148">To use visual styles with combo boxes, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="44dd4-149">Pour plus d’informations sur les styles visuels, consultez [styles visuels](themes-overview.md).</span><span class="sxs-lookup"><span data-stu-id="44dd4-149">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="44dd4-150">Pour plus d’informations sur les manifestes, consultez [activation des styles visuels](cookbook-overview.md).</span><span class="sxs-lookup"><span data-stu-id="44dd4-150">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="combo-box-list"></a><span data-ttu-id="44dd4-151">Liste de zones de liste modifiable</span><span class="sxs-lookup"><span data-stu-id="44dd4-151">Combo Box List</span></span>

<span data-ttu-id="44dd4-152">La liste est la partie d’une zone de liste déroulante qui affiche les éléments qu’un utilisateur peut sélectionner.</span><span class="sxs-lookup"><span data-stu-id="44dd4-152">The list is the portion of a combo box that displays the items a user can select.</span></span> <span data-ttu-id="44dd4-153">En règle générale, une application initialise le contenu de la liste lorsqu’elle crée une zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-153">Typically, an application initializes the contents of the list when it creates a combo box.</span></span> <span data-ttu-id="44dd4-154">Tout élément de liste sélectionné par l’utilisateur est la *sélection actuelle*.</span><span class="sxs-lookup"><span data-stu-id="44dd4-154">Any list item selected by the user is the *current selection*.</span></span> <span data-ttu-id="44dd4-155">Impossible de sélectionner plusieurs éléments.</span><span class="sxs-lookup"><span data-stu-id="44dd4-155">Multiple items cannot be selected.</span></span> <span data-ttu-id="44dd4-156">Dans les zones de liste modifiable simples et déroulantes, l’utilisateur peut taper dans le champ de sélection au lieu de sélectionner un élément de liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-156">In simple and drop-down combo boxes, the user can type in the selection field instead of selecting a list item.</span></span> <span data-ttu-id="44dd4-157">Dans ce cas, il n’y a aucune sélection actuelle, et il incombe à l’application d’ajouter l’élément à la liste et de le faire passer à la sélection actuelle, s’il y a lieu.</span><span class="sxs-lookup"><span data-stu-id="44dd4-157">In these cases, there is no current selection, and it is the application's responsibility to add the item to the list and make it the current selection, if it is appropriate to do so.</span></span>

<span data-ttu-id="44dd4-158">Cette section aborde les sujets suivants :</span><span class="sxs-lookup"><span data-stu-id="44dd4-158">This section discusses following topics:</span></span>

-   [<span data-ttu-id="44dd4-159">Sélection actuelle</span><span class="sxs-lookup"><span data-stu-id="44dd4-159">Current Selection</span></span>](#current-selection)
-   [<span data-ttu-id="44dd4-160">Listes déroulantes</span><span class="sxs-lookup"><span data-stu-id="44dd4-160">Drop-down Lists</span></span>](#drop-down-lists)
-   [<span data-ttu-id="44dd4-161">Lister le contenu</span><span class="sxs-lookup"><span data-stu-id="44dd4-161">List Contents</span></span>](#list-contents)

### <a name="current-selection"></a><span data-ttu-id="44dd4-162">Sélection actuelle</span><span class="sxs-lookup"><span data-stu-id="44dd4-162">Current Selection</span></span>

<span data-ttu-id="44dd4-163">La sélection actuelle est un élément de liste que l’utilisateur a sélectionné ; le texte sélectionné s’affiche dans le champ de sélection de la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-163">The current selection is a list item that the user has selected; the selected text appears in the selection field of the combo box.</span></span> <span data-ttu-id="44dd4-164">Toutefois, dans le cas d’une zone de liste modifiable simple ou d’une zone de liste déroulante, la sélection actuelle n’est qu’une forme d’entrée utilisateur possible dans une zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-164">However, in the case of a simple combo box or a drop-down combo box, the current selection is only one form of possible user input in a combo box.</span></span> <span data-ttu-id="44dd4-165">L’utilisateur peut également taper du texte dans le champ de sélection.</span><span class="sxs-lookup"><span data-stu-id="44dd4-165">The user can also type text in the selection field.</span></span>

<span data-ttu-id="44dd4-166">La sélection actuelle est identifiée par l’index de base zéro de l’élément de liste sélectionné.</span><span class="sxs-lookup"><span data-stu-id="44dd4-166">The current selection is identified by the zero-based index of the selected list item.</span></span> <span data-ttu-id="44dd4-167">Une application peut la définir et la récupérer à tout moment.</span><span class="sxs-lookup"><span data-stu-id="44dd4-167">An application can set and retrieve it at any time.</span></span> <span data-ttu-id="44dd4-168">La fenêtre parente ou la procédure de boîte de dialogue reçoit une notification lorsque l’utilisateur modifie la sélection actuelle pour une zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-168">The parent window or dialog box procedure receives notification when the user changes the current selection for a combo box.</span></span> <span data-ttu-id="44dd4-169">La fenêtre parente ou la boîte de dialogue n’est pas avertie lorsque l’application modifie la sélection.</span><span class="sxs-lookup"><span data-stu-id="44dd4-169">The parent window or dialog box is not notified when the application changes the selection.</span></span>

<span data-ttu-id="44dd4-170">Lorsqu’une zone de liste déroulante est créée, il n’y a aucune sélection actuelle.</span><span class="sxs-lookup"><span data-stu-id="44dd4-170">When a combo box is created, there is no current selection.</span></span> <span data-ttu-id="44dd4-171">C’est également le cas pour une zone de liste modifiable simple ou déroulante, si l’utilisateur a modifié le contenu du champ de sélection.</span><span class="sxs-lookup"><span data-stu-id="44dd4-171">This is also true for a simple or drop-down combo box, if the user has edited the contents of the selection field.</span></span> <span data-ttu-id="44dd4-172">Pour définir la sélection actuelle, une application envoie le message [**CB \_ SETCURSEL**](cb-setcursel.md) à la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-172">To set the current selection, an application sends the [**CB\_SETCURSEL**](cb-setcursel.md) message to the combo box.</span></span> <span data-ttu-id="44dd4-173">Une application peut également utiliser le message [**CB \_ SELECTSTRING**](cb-selectstring.md) pour définir la sélection actuelle sur un élément de liste dont la chaîne commence par une chaîne spécifiée.</span><span class="sxs-lookup"><span data-stu-id="44dd4-173">An application can also use the [**CB\_SELECTSTRING**](cb-selectstring.md) message to set the current selection to a list item whose string begins with a specified string.</span></span> <span data-ttu-id="44dd4-174">Pour déterminer la sélection actuelle, une application envoie le message [**CB \_ GETCURSEL**](cb-getcursel.md) à la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-174">To determine the current selection, an application sends the [**CB\_GETCURSEL**](cb-getcursel.md) message to the combo box.</span></span> <span data-ttu-id="44dd4-175">S’il n’y a aucune sélection actuelle, ce message retourne CB \_ Err.</span><span class="sxs-lookup"><span data-stu-id="44dd4-175">If there is no current selection, this message returns CB\_ERR.</span></span>

<span data-ttu-id="44dd4-176">Lorsque l’utilisateur modifie la sélection actuelle dans une zone de liste déroulante, la fenêtre parente ou la procédure de boîte de dialogue reçoit un message de [**\_ commande WM**](/windows/desktop/menurc/wm-command) avec le code de notification [CBN \_ selChange](cbn-selchange.md) dans le mot de poids fort du paramètre *wParam* .</span><span class="sxs-lookup"><span data-stu-id="44dd4-176">When the user changes the current selection in a combo box, the parent window or dialog-box procedure receives a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message with the [CBN\_SELCHANGE](cbn-selchange.md) notification code in the high-order word of the *wParam* parameter.</span></span> <span data-ttu-id="44dd4-177">Ce code de notification n’est pas envoyé lorsque la sélection actuelle est définie à l’aide du message [**CB \_ SETCURSEL**](cb-setcursel.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-177">This notification code is not sent when the current selection is set using the [**CB\_SETCURSEL**](cb-setcursel.md) message.</span></span>

<span data-ttu-id="44dd4-178">Une zone de liste déroulante ou une zone de liste déroulante déroulante envoie le code de notification [CBN \_ gros plan](cbn-closeup.md) à la fenêtre parente ou à la procédure de boîte de dialogue lorsque la liste déroulante se ferme.</span><span class="sxs-lookup"><span data-stu-id="44dd4-178">A drop-down combo box or drop-down list box sends the [CBN\_CLOSEUP](cbn-closeup.md) notification code to the parent window or dialog-box procedure when the drop-down list closes.</span></span> <span data-ttu-id="44dd4-179">Si l’utilisateur a modifié la sélection actuelle, la zone de liste déroulante envoie également le code de notification [CBN \_ selChange](cbn-selchange.md) lorsque la liste déroulante se ferme.</span><span class="sxs-lookup"><span data-stu-id="44dd4-179">If the user changed the current selection, the combo box also sends the [CBN\_SELCHANGE](cbn-selchange.md) notification code when the drop-down list closes.</span></span> <span data-ttu-id="44dd4-180">Pour exécuter un processus spécifique chaque fois que l’utilisateur sélectionne un élément de liste, vous pouvez gérer le \_ Code de notification CBN selChange ou CBN \_ gros plan.</span><span class="sxs-lookup"><span data-stu-id="44dd4-180">To execute a specific process each time the user selects a list item, you can handle either the CBN\_SELCHANGE or CBN\_CLOSEUP notification code.</span></span> <span data-ttu-id="44dd4-181">En général, vous attendez le code de \_ notification CBN gros plan avant de traiter une modification dans la sélection actuelle.</span><span class="sxs-lookup"><span data-stu-id="44dd4-181">Typically, you would wait for the CBN\_CLOSEUP notification code before processing a change in the current selection.</span></span> <span data-ttu-id="44dd4-182">Cela peut être particulièrement important si une quantité importante de traitement est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="44dd4-182">This can be particularly important if a significant amount of processing is required.</span></span>

<span data-ttu-id="44dd4-183">Une application peut également traiter les codes de notification [CBN \_ SELENDOK](cbn-selendok.md) et [CBN \_ SELENDCANCEL](cbn-selendcancel.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-183">An application could also process the [CBN\_SELENDOK](cbn-selendok.md) and [CBN\_SELENDCANCEL](cbn-selendcancel.md) notification codes.</span></span> <span data-ttu-id="44dd4-184">Le système envoie CBN \_ SELENDOK lorsque l’utilisateur sélectionne un élément de liste, ou sélectionne un élément, puis ferme la liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-184">The system sends CBN\_SELENDOK when the user selects a list item, or selects an item and then closes the list.</span></span> <span data-ttu-id="44dd4-185">Cela indique que l’utilisateur a terminé et que la sélection doit être traitée.</span><span class="sxs-lookup"><span data-stu-id="44dd4-185">This indicates that the user has finished, and that the selection should be processed.</span></span> <span data-ttu-id="44dd4-186">CBN \_ SELENDCANCEL est envoyé lorsque l’utilisateur sélectionne un élément, mais sélectionne un autre contrôle, appuie sur ÉCHAP pendant que la liste déroulante est ouverte ou ferme la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="44dd4-186">CBN\_SELENDCANCEL is sent when the user selects an item, but then selects another control, presses ESC while the drop-down list is open, or closes the dialog box.</span></span> <span data-ttu-id="44dd4-187">Cela indique que la sélection de l’utilisateur doit être ignorée.</span><span class="sxs-lookup"><span data-stu-id="44dd4-187">This indicates that the user's selection should be ignored.</span></span> <span data-ttu-id="44dd4-188">CBN \_ SELENDOK est envoyé avant chaque message [CBN \_ selChange](cbn-selchange.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-188">CBN\_SELENDOK is sent before every [CBN\_SELCHANGE](cbn-selchange.md) message.</span></span>

<span data-ttu-id="44dd4-189">Dans une zone de liste modifiable simple, le système envoie le code de notification [CBN \_ DBLCLK](cbn-dblclk.md) lorsque l’utilisateur double-clique sur un élément de liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-189">In a simple combo box, the system sends the [CBN\_DBLCLK](cbn-dblclk.md) notification code when the user double-clicks a list item.</span></span> <span data-ttu-id="44dd4-190">Dans une zone de liste déroulante ou une liste déroulante, un seul clic masque la liste. il n’est donc pas possible de double-cliquer sur un élément.</span><span class="sxs-lookup"><span data-stu-id="44dd4-190">In a drop-down combo box or drop-down list, a single click hides the list, so it is not possible to double-click an item.</span></span>

### <a name="drop-down-lists"></a><span data-ttu-id="44dd4-191">Listes déroulantes</span><span class="sxs-lookup"><span data-stu-id="44dd4-191">Drop-down Lists</span></span>

<span data-ttu-id="44dd4-192">Certains messages et notifications s’appliquent uniquement aux zones de liste déroulante contenant des listes déroulantes.</span><span class="sxs-lookup"><span data-stu-id="44dd4-192">Certain notifications and messages apply only to combo boxes containing drop-down lists.</span></span> <span data-ttu-id="44dd4-193">Quand une liste déroulante est ouverte ou fermée, la fenêtre parente d’une zone de liste déroulante reçoit une notification sous la forme d’un message de [**\_ commande WM**](/windows/desktop/menurc/wm-command) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-193">When a drop-down list is open or closed, the parent window of a combo box receives a notification in the form of a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span> <span data-ttu-id="44dd4-194">Si la liste est ouverte, le mot de poids fort de *wParam* est [CBN \_ DROPDOWN](cbn-dropdown.md).</span><span class="sxs-lookup"><span data-stu-id="44dd4-194">If the list is being opened, the high-order word of *wParam* is [CBN\_DROPDOWN](cbn-dropdown.md).</span></span> <span data-ttu-id="44dd4-195">Si la liste est fermée, il s’agit de [CBN \_ gros plan](cbn-closeup.md).</span><span class="sxs-lookup"><span data-stu-id="44dd4-195">If the list is being closed, it is [CBN\_CLOSEUP](cbn-closeup.md).</span></span>

<span data-ttu-id="44dd4-196">Une application peut ouvrir la liste d’une zone de liste déroulante ou d’une zone de liste déroulante à l’aide du message [**CB \_ SHOWDROPDOWN**](cb-showdropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-196">An application can open the list of a drop-down combo box or drop-down list box by using the [**CB\_SHOWDROPDOWN**](cb-showdropdown.md) message.</span></span> <span data-ttu-id="44dd4-197">Il peut déterminer si la liste est ouverte à l’aide du message [**CB \_ GETDROPPEDSTATE**](cb-getdroppedstate.md) et peut déterminer les coordonnées d’une liste déroulante à l’aide du message [**CB \_ GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-197">It can determine whether the list is open by using the [**CB\_GETDROPPEDSTATE**](cb-getdroppedstate.md) message and can determine the coordinates of a drop-down list by using the [**CB\_GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) message.</span></span> <span data-ttu-id="44dd4-198">Une application peut également augmenter la largeur d’une liste déroulante à l’aide du message [**CB \_ SETDROPPEDWIDTH**](cb-setdroppedwidth.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-198">An application can also increase the width of a drop-down list by using the [**CB\_SETDROPPEDWIDTH**](cb-setdroppedwidth.md) message.</span></span>

### <a name="list-contents"></a><span data-ttu-id="44dd4-199">Lister le contenu</span><span class="sxs-lookup"><span data-stu-id="44dd4-199">List Contents</span></span>

<span data-ttu-id="44dd4-200">Lorsqu’une application crée une zone de liste déroulante, elle Initialise généralement la zone de liste déroulante en ajoutant un ou plusieurs éléments à la liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-200">When an application creates a combo box, it typically initializes the combo box by adding one or more items to the list.</span></span> <span data-ttu-id="44dd4-201">Plus tard, une application peut ajouter ou supprimer des éléments de liste, réinitialiser la liste ou récupérer des informations d’élément à partir de celle-ci.</span><span class="sxs-lookup"><span data-stu-id="44dd4-201">Later, an application may add or delete list items, reinitialize the list, or retrieve item information from it.</span></span>

<span data-ttu-id="44dd4-202">Une application ajoute des éléments de liste à une zone de liste déroulante en lui envoyant le message [**CB \_ ADDSTRING**](cb-addstring.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-202">An application adds list items to a combo box by sending the [**CB\_ADDSTRING**](cb-addstring.md) message to it.</span></span> <span data-ttu-id="44dd4-203">L’élément spécifié est ajouté à la fin de la liste ou, dans une zone de liste déroulante triée, dans sa position triée correcte en fonction de la chaîne de l’élément.</span><span class="sxs-lookup"><span data-stu-id="44dd4-203">The specified item is added to the end of the list or, in a sorted combo box, in its correct sorted position based on the item's string.</span></span> <span data-ttu-id="44dd4-204">Dans une zone de liste modifiable non triée, une application peut utiliser le message [**CB \_ INSERTSTRING**](cb-insertstring.md) pour insérer un élément à une position spécifique.</span><span class="sxs-lookup"><span data-stu-id="44dd4-204">In an unsorted combo box, an application can use the [**CB\_INSERTSTRING**](cb-insertstring.md) message to insert an item at a specific position.</span></span> <span data-ttu-id="44dd4-205">Une fois ajouté, un élément de liste est identifié par sa position.</span><span class="sxs-lookup"><span data-stu-id="44dd4-205">Once added, a list item is identified by its position.</span></span>

<span data-ttu-id="44dd4-206">En utilisant le message [**CB \_ FindString**](cb-findstring.md) ou [**CB \_ FindExactString**](cb-findstringexact.md) , une application peut déterminer la position d’un élément de liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-206">By using the [**CB\_FINDSTRING**](cb-findstring.md) or [**CB\_FINDSTRINGEXACT**](cb-findstringexact.md) message, an application can determine the position of a list item.</span></span> <span data-ttu-id="44dd4-207">**CB \_ FINDSTRING** recherche un élément dont la chaîne commence par la chaîne spécifiée.</span><span class="sxs-lookup"><span data-stu-id="44dd4-207">**CB\_FINDSTRING** finds an item whose string begins with the specified string.</span></span> <span data-ttu-id="44dd4-208">**CB \_ FINDEXACTSTRING** recherche un élément dont la chaîne correspond exactement à la chaîne.</span><span class="sxs-lookup"><span data-stu-id="44dd4-208">**CB\_FINDSTRINGEXACT** finds an item whose string matches the string exactly.</span></span> <span data-ttu-id="44dd4-209">Aucun des messages n’est sensible à la casse.</span><span class="sxs-lookup"><span data-stu-id="44dd4-209">Neither message is case sensitive.</span></span>

<span data-ttu-id="44dd4-210">Une application peut supprimer un élément de liste à l’aide du message [**CB \_ DELETESTRING**](cb-deletestring.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-210">An application can remove a list item by using the [**CB\_DELETESTRING**](cb-deletestring.md) message.</span></span> <span data-ttu-id="44dd4-211">Si une application doit réinitialiser la liste de la zone de liste déroulante, elle peut tout d’abord effacer tout son contenu à l’aide du message [**CB \_ RESETCONTENT**](cb-resetcontent.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-211">If an application needs to reinitialize the combo box list, it can first clear its entire contents by using the [**CB\_RESETCONTENT**](cb-resetcontent.md) message.</span></span> <span data-ttu-id="44dd4-212">Lors de l’ajout de plusieurs éléments à la liste après l’affichage d’une zone de liste déroulante, une application peut effacer l’indicateur de redessin pour empêcher que la zone de liste modifiable ne soit redessinée après l’ajout de chaque élément.</span><span class="sxs-lookup"><span data-stu-id="44dd4-212">When adding multiple items to the list after a combo box has already been shown, an application can clear the redraw flag to prevent the combo box from being repainted after each item is added.</span></span> <span data-ttu-id="44dd4-213">Pour plus d’informations sur le redessin, consultez la description du message [**WM \_ SETREDRAW**](/windows/desktop/gdi/wm-setredraw) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-213">For more information about redrawing, see the description of the [**WM\_SETREDRAW**](/windows/desktop/gdi/wm-setredraw) message.</span></span>

<span data-ttu-id="44dd4-214">Pour récupérer la chaîne associée à un élément de liste, une application peut utiliser le message [**CB \_ GETLBTEXT**](cb-getlbtext.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-214">To retrieve the string associated with a list item, an application can use the [**CB\_GETLBTEXT**](cb-getlbtext.md) message.</span></span> <span data-ttu-id="44dd4-215">La chaîne de l’élément est copiée dans la mémoire tampon spécifiée par l’application.</span><span class="sxs-lookup"><span data-stu-id="44dd4-215">The item's string is copied to the buffer specified by the application.</span></span> <span data-ttu-id="44dd4-216">Pour vous assurer que la mémoire tampon est suffisamment grande pour recevoir la chaîne, l’application peut d’abord utiliser le message [**CB \_ GETLBTEXTLEN**](cb-getlbtextlen.md) pour déterminer la longueur de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="44dd4-216">To ensure that the buffer is large enough to receive the string, the application can first use the [**CB\_GETLBTEXTLEN**](cb-getlbtextlen.md) message to determine the length of the string.</span></span> <span data-ttu-id="44dd4-217">Pour obtenir le nombre d’éléments de liste dans une zone de liste déroulante, une application peut utiliser le message [**CB \_ GETCOUNT**](cb-getcount.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-217">To get the number of list items in a combo box, an application can use the [**CB\_GETCOUNT**](cb-getcount.md) message.</span></span>

## <a name="edit-control-selection-fields"></a><span data-ttu-id="44dd4-218">Modifier les champs de sélection du contrôle</span><span class="sxs-lookup"><span data-stu-id="44dd4-218">Edit Control Selection Fields</span></span>

<span data-ttu-id="44dd4-219">Une application peut récupérer ou définir le contenu du champ de sélection et peut déterminer ou définir la sélection de modification.</span><span class="sxs-lookup"><span data-stu-id="44dd4-219">An application can retrieve or set the contents of the selection field and can determine or set the edit selection.</span></span> <span data-ttu-id="44dd4-220">L’application peut également limiter la quantité de texte qu’un utilisateur peut taper dans le champ de sélection.</span><span class="sxs-lookup"><span data-stu-id="44dd4-220">The application can also limit the amount of text a user can type in the selection field.</span></span> <span data-ttu-id="44dd4-221">Lorsque le contenu du champ de sélection change, le système envoie des messages de notification à la procédure de la fenêtre parente ou de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="44dd4-221">When the contents of the selection field change, the system sends notification messages to the parent window or dialog box procedure.</span></span>

<span data-ttu-id="44dd4-222">Pour récupérer le contenu du champ de sélection, une application peut envoyer le message [**WM \_ GETTEXT**](/windows/desktop/winmsg/wm-gettext) à la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-222">To retrieve the content of the selection field, an application can send the [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext) message to the combo box.</span></span> <span data-ttu-id="44dd4-223">Pour définir le contenu du champ de sélection d’une zone de liste modifiable simple ou d’une zone de liste déroulante, une application peut envoyer le message [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext) à la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-223">To set the contents of the selection field of a simple or drop-down combo box, an application can send the [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message to the combo box.</span></span>

<span data-ttu-id="44dd4-224">La sélection de modification correspond à la plage de texte sélectionné, le cas échéant, dans le champ de sélection d’une zone de liste modifiable simple ou déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-224">The edit selection is the range of selected text, if any, in the selection field of a simple or drop-down combo box.</span></span> <span data-ttu-id="44dd4-225">Une application peut déterminer les positions des caractères de début et de fin de la sélection actuelle à l’aide du message [**CB \_ GETEDITSEL**](cb-geteditsel.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-225">An application can determine the starting and ending character positions of the current selection by using the [**CB\_GETEDITSEL**](cb-geteditsel.md) message.</span></span> <span data-ttu-id="44dd4-226">Il peut également sélectionner des caractères dans la sélection de modification à l’aide du message [**CB \_ SETEDITSEL**](cb-seteditsel.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-226">It can also select characters in the edit selection by using the [**CB\_SETEDITSEL**](cb-seteditsel.md) message.</span></span>

<span data-ttu-id="44dd4-227">Initialement, la quantité de texte que l’utilisateur peut taper dans le champ de sélection est limitée par la taille du champ de sélection.</span><span class="sxs-lookup"><span data-stu-id="44dd4-227">Initially, the amount of text that the user can type into the selection field is limited by the size of the selection field.</span></span> <span data-ttu-id="44dd4-228">Toutefois, si la zone de liste déroulante a le style [**CBS \_ AUTOHSCROLL**](combo-box-styles.md) , le texte peut continuer au-delà de la taille du champ de sélection.</span><span class="sxs-lookup"><span data-stu-id="44dd4-228">However, if the combo box has the [**CBS\_AUTOHSCROLL**](combo-box-styles.md) style, the text can continue beyond the size of the selection field.</span></span> <span data-ttu-id="44dd4-229">Une application peut utiliser le message [**CB \_ LIMITTEXT**](cb-limittext.md) pour limiter la quantité de texte qu’un utilisateur peut taper dans le champ de sélection, que le contrôle ait le style **CBS \_ AUTOHSCROLL** ou non.</span><span class="sxs-lookup"><span data-stu-id="44dd4-229">An application can use the [**CB\_LIMITTEXT**](cb-limittext.md) message to limit the amount of text a user can type into the selection field, regardless of whether the control has the **CBS\_AUTOHSCROLL** style.</span></span>

<span data-ttu-id="44dd4-230">Lorsque l’utilisateur modifie le contenu du champ de sélection, la procédure de la fenêtre parente ou de la boîte de dialogue reçoit des messages de notification.</span><span class="sxs-lookup"><span data-stu-id="44dd4-230">When the user edits the content of the selection field, the parent window or dialog box procedure receives notification messages.</span></span> <span data-ttu-id="44dd4-231">Le code de notification [CBN \_ EDITUPDATE](cbn-editupdate.md) est envoyé en premier, ce qui indique que le texte dans le champ de sélection a été modifié.</span><span class="sxs-lookup"><span data-stu-id="44dd4-231">The [CBN\_EDITUPDATE](cbn-editupdate.md) notification code is sent first, indicating that the text in the selection field has been edited.</span></span> <span data-ttu-id="44dd4-232">Une fois le texte modifié affiché, le système envoie [CBN \_ EDITCHANGE](cbn-editchange.md).</span><span class="sxs-lookup"><span data-stu-id="44dd4-232">After the altered text is displayed, the system sends [CBN\_EDITCHANGE](cbn-editchange.md).</span></span> <span data-ttu-id="44dd4-233">Lorsque le contenu du champ de sélection change à la suite de la sélection d’un élément de liste, ces messages ne sont pas envoyés.</span><span class="sxs-lookup"><span data-stu-id="44dd4-233">When the selection field content changes as the result of a list item being selected, these messages are not sent.</span></span>

## <a name="owner-drawn-combo-boxes"></a><span data-ttu-id="44dd4-234">Zones de liste déroulante Owner-Drawn</span><span class="sxs-lookup"><span data-stu-id="44dd4-234">Owner-Drawn Combo Boxes</span></span>

<span data-ttu-id="44dd4-235">Une application peut créer une zone de liste déroulante owner-drawn pour assumer la responsabilité de la peinture des éléments de liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-235">An application can create an owner-drawn combo box to take responsibility for painting list items.</span></span> <span data-ttu-id="44dd4-236">La fenêtre parente d’une zone de liste déroulante owner-drawn (son propriétaire) reçoit des messages [**WM \_ DRAWITEM**](wm-drawitem.md) lorsqu’une partie de la zone de liste déroulante doit être peinte.</span><span class="sxs-lookup"><span data-stu-id="44dd4-236">The parent window of an owner-drawn combo box (its owner) receives [**WM\_DRAWITEM**](wm-drawitem.md) messages when a portion of the combo box needs to be painted.</span></span> <span data-ttu-id="44dd4-237">Une zone de liste déroulante owner-drawn peut répertorier des informations autres que des chaînes de texte, ou en plus de celles-ci.</span><span class="sxs-lookup"><span data-stu-id="44dd4-237">An owner-drawn combo box can list information other than, or in addition to, text strings.</span></span> <span data-ttu-id="44dd4-238">Les zones de liste déroulante owner-drawn peuvent être de n’importe quel type.</span><span class="sxs-lookup"><span data-stu-id="44dd4-238">Owner-drawn combo boxes can be of any type.</span></span> <span data-ttu-id="44dd4-239">Toutefois, le contrôle d’édition dans une zone de liste modifiable simple ou déroulante ne peut afficher que du texte, tandis que le propriétaire peint le champ de sélection dans une zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-239">However, the edit control in a simple or drop-down combo box can only display text, while the owner paints the selection field in a drop-down list box.</span></span>

<span data-ttu-id="44dd4-240">Le propriétaire d’une zone de liste déroulante owner-drawn doit traiter le message [**WM \_ DRAWITEM**](wm-drawitem.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-240">The owner of an owner-drawn combo box must process the [**WM\_DRAWITEM**](wm-drawitem.md) message.</span></span> <span data-ttu-id="44dd4-241">Ce message est envoyé chaque fois qu’une partie de la zone de liste déroulante doit être redessinée.</span><span class="sxs-lookup"><span data-stu-id="44dd4-241">This message is sent whenever a portion of the combo box must be redrawn.</span></span> <span data-ttu-id="44dd4-242">Le propriétaire peut avoir besoin de traiter d’autres messages, selon les styles spécifiés pour la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-242">The owner may need to process other messages, depending on the styles specified for the combo box.</span></span>

<span data-ttu-id="44dd4-243">Une application peut créer une zone de liste déroulante owner-drawn en spécifiant le style [**CBS \_ OWNERDRAWFIXED**](combo-box-styles.md) ou [**CBS \_ OWNERDRAWVARIABLE**](combo-box-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-243">An application can create an owner-drawn combo box by specifying the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) or [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style.</span></span> <span data-ttu-id="44dd4-244">Si tous les éléments de liste de la zone de liste déroulante sont de la même hauteur, tels que des chaînes ou des icônes, une application peut utiliser le style **CBS \_ OWNERDRAWFIXED** .</span><span class="sxs-lookup"><span data-stu-id="44dd4-244">If all list items in the combo box are the same height, such as strings or icons, an application can use the **CBS\_OWNERDRAWFIXED** style.</span></span> <span data-ttu-id="44dd4-245">Si les éléments de liste sont de hauteur variable, comme les bitmaps de taille différente, une application peut utiliser le style **CBS \_ OWNERDRAWVARIABLE** .</span><span class="sxs-lookup"><span data-stu-id="44dd4-245">If list items are of varying height, like bitmaps of different size, an application can use the **CBS\_OWNERDRAWVARIABLE** style.</span></span>

<span data-ttu-id="44dd4-246">Le propriétaire d’une zone de liste déroulante owner-drawn peut traiter un message [**WM \_ MEASUREITEM**](wm-measureitem.md) pour spécifier les dimensions des éléments de liste dans la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-246">The owner of an owner-drawn combo box can process a [**WM\_MEASUREITEM**](wm-measureitem.md) message to specify the dimensions of list items in the combo box.</span></span> <span data-ttu-id="44dd4-247">Si l’application crée la zone de liste déroulante en utilisant le style [**CBS \_ OWNERDRAWFIXED**](combo-box-styles.md) , le système envoie le message **WM \_ MEASUREITEM** une seule fois.</span><span class="sxs-lookup"><span data-stu-id="44dd4-247">If the application creates the combo box by using the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) style, the system sends the **WM\_MEASUREITEM** message only once.</span></span> <span data-ttu-id="44dd4-248">Les dimensions spécifiées par le propriétaire sont utilisées pour tous les éléments de liste.</span><span class="sxs-lookup"><span data-stu-id="44dd4-248">The dimensions specified by the owner are used for all list items.</span></span> <span data-ttu-id="44dd4-249">Si le style [**CBS \_ OWNERDRAWVARIABLE**](combo-box-styles.md) est utilisé, le système envoie un message **WM \_ MEASUREITEM** pour chaque élément de liste ajouté à la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-249">If the [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style is used, the system sends a **WM\_MEASUREITEM** message for each list item added to the combo box.</span></span> <span data-ttu-id="44dd4-250">Le propriétaire peut déterminer ou définir la hauteur d’un élément de liste à tout moment à l’aide des messages [**CB \_ GETITEMHEIGHT**](cb-getitemheight.md) et [**CB \_ SETITEMHEIGHT**](cb-setitemheight.md) , respectivement.</span><span class="sxs-lookup"><span data-stu-id="44dd4-250">The owner can determine or set the height of a list item at any time by using the [**CB\_GETITEMHEIGHT**](cb-getitemheight.md) and [**CB\_SETITEMHEIGHT**](cb-setitemheight.md) messages, respectively.</span></span>

<span data-ttu-id="44dd4-251">Si les informations affichées dans une zone de liste déroulante owner-drawn incluent du texte, une application peut effectuer le suivi du texte pour chaque élément de liste en spécifiant le style [**CBS \_ HASSTRINGS**](combo-box-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-251">If the information displayed in an owner-drawn combo box includes text, an application can keep track of the text for each list item by specifying the [**CBS\_HASSTRINGS**](combo-box-styles.md) style.</span></span> <span data-ttu-id="44dd4-252">Les zones de liste déroulante avec le style de [**\_ Tri CBS**](combo-box-styles.md) sont triées en fonction de ce texte.</span><span class="sxs-lookup"><span data-stu-id="44dd4-252">Combo boxes with the [**CBS\_SORT**](combo-box-styles.md) style are sorted based on this text.</span></span> <span data-ttu-id="44dd4-253">Si une zone de liste déroulante est triée et non le style **CBS \_ HASSTRINGS** , le propriétaire doit traiter le message [**WM \_ COMPAREITEM**](wm-compareitem.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-253">If a combo box is sorted and not of the **CBS\_HASSTRINGS** style, the owner must process the [**WM\_COMPAREITEM**](wm-compareitem.md) message.</span></span>

<span data-ttu-id="44dd4-254">Dans une zone de liste déroulante owner-drawn, le propriétaire doit effectuer le suivi des éléments de liste contenant des informations autres que ou en plus du texte.</span><span class="sxs-lookup"><span data-stu-id="44dd4-254">In an owner-drawn combo box, the owner must keep track of list items containing information other than or in addition to text.</span></span> <span data-ttu-id="44dd4-255">Pour ce faire, une méthode pratique consiste à enregistrer le handle dans les informations en tant que données d’élément.</span><span class="sxs-lookup"><span data-stu-id="44dd4-255">One convenient way to do this is to save the handle to the information as item data.</span></span> <span data-ttu-id="44dd4-256">Pour libérer des objets de données associés à des éléments dans une zone de liste déroulante, le propriétaire peut traiter le message [**WM \_ DELETEITEM**](wm-deleteitem.md) .</span><span class="sxs-lookup"><span data-stu-id="44dd4-256">To free data objects associated with items in a combo box, the owner can process the [**WM\_DELETEITEM**](wm-deleteitem.md) message.</span></span>

## <a name="subclassed-combo-boxes"></a><span data-ttu-id="44dd4-257">Zones de liste déroulante sous-classées</span><span class="sxs-lookup"><span data-stu-id="44dd4-257">Subclassed Combo Boxes</span></span>

<span data-ttu-id="44dd4-258">Le sous-classing est une procédure qui permet à une application d’intercepter et de traiter les messages envoyés ou publiés dans une fenêtre.</span><span class="sxs-lookup"><span data-stu-id="44dd4-258">Subclassing is a procedure that allows an application to intercept and process messages sent or posted to a window.</span></span> <span data-ttu-id="44dd4-259">En utilisant le sous-usinage, une application peut substituer son propre traitement à certains messages, tout en laissant la plupart du traitement des messages à la procédure de fenêtre définie par la classe.</span><span class="sxs-lookup"><span data-stu-id="44dd4-259">By using subclassing, an application can substitute its own processing for certain messages, while leaving most message processing to the class-defined window procedure.</span></span>

<span data-ttu-id="44dd4-260">Lorsque le système d’exploitation crée une fenêtre, il enregistre les informations qui le concernent dans une structure de données interne qui comprend un pointeur vers la procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="44dd4-260">When the operating system creates a window, it saves information about it in an internal data structure that includes a pointer to the window procedure.</span></span> <span data-ttu-id="44dd4-261">Pour sous-classer une fenêtre, une application appelle la fonction [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) pour remplacer le pointeur vers cette procédure par un pointeur vers une procédure de sous-classe définie par l’application.</span><span class="sxs-lookup"><span data-stu-id="44dd4-261">To subclass a window, an application calls the [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) function to replace the pointer to that procedure with a pointer to an application-defined subclass procedure.</span></span> <span data-ttu-id="44dd4-262">Par la suite, tous les messages dans la fenêtre sont envoyés à la procédure de sous-classe.</span><span class="sxs-lookup"><span data-stu-id="44dd4-262">Thereafter, all messages to the window are sent to the subclass procedure.</span></span> <span data-ttu-id="44dd4-263">Cette procédure utilise ensuite la fonction [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) pour transmettre des messages non traités à la procédure de fenêtre d’origine.</span><span class="sxs-lookup"><span data-stu-id="44dd4-263">This procedure then uses the [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) function to pass unprocessed messages to the original window procedure.</span></span> <span data-ttu-id="44dd4-264">Pour obtenir une description du traitement des messages effectué par la procédure de fenêtre de la classe COMBOBOX, consultez comportement de la [zone de liste déroulante par défaut](combo-box-features.md).</span><span class="sxs-lookup"><span data-stu-id="44dd4-264">For a description of the message processing performed by the COMBOBOX class window procedure, see [Default Combo Box Behavior](combo-box-features.md).</span></span>

<span data-ttu-id="44dd4-265">Lorsque la zone de liste déroulante est à l’extérieur d’une boîte de dialogue, une application ne peut pas traiter les touches TAB, entrée et ÉCHAP, sauf si elle utilise une procédure de sous-classe.</span><span class="sxs-lookup"><span data-stu-id="44dd4-265">When the combo box is outside a dialog box, an application cannot process the TAB, ENTER, and ESC keys unless it uses a subclass procedure.</span></span> <span data-ttu-id="44dd4-266">Lorsqu’une zone de liste modifiable simple ou déroulante reçoit le focus d’entrée, elle définit immédiatement le focus sur son contrôle d’édition enfant.</span><span class="sxs-lookup"><span data-stu-id="44dd4-266">When a simple or drop-down combo box receives the input focus, it immediately sets the focus to its child edit control.</span></span> <span data-ttu-id="44dd4-267">Par conséquent, une application doit sous-définir le contrôle d’édition pour intercepter l’entrée au clavier pour une zone de liste modifiable simple ou déroulante.</span><span class="sxs-lookup"><span data-stu-id="44dd4-267">Therefore, an application must subclass the edit control to intercept keyboard input for a simple or drop-down combo box.</span></span> <span data-ttu-id="44dd4-268">Pour obtenir un exemple, consultez [sous-classement d’une zone de liste déroulante](using-combo-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="44dd4-268">For an example of this, see [Subclassing a Combo Box](using-combo-boxes.md).</span></span>

<span data-ttu-id="44dd4-269">Si une procédure de sous-classe traite le message [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) , elle doit utiliser la fonction [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) pour préparer la peinture.</span><span class="sxs-lookup"><span data-stu-id="44dd4-269">If a subclass procedure processes the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, it must use the [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) function to prepare for painting.</span></span> <span data-ttu-id="44dd4-270">Avant d’appeler la fonction [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) , elle passe le handle de contexte de périphérique (DC) comme paramètre *wParam* pour la procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="44dd4-270">Before calling the [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) function, it passes the device context (DC) handle as the *wParam* parameter for the window procedure.</span></span> <span data-ttu-id="44dd4-271">Si **EndPaint** est appelé en premier, la procédure de la fenêtre de classe ne dessine pas, car **EndPaint** valide la fenêtre entière.</span><span class="sxs-lookup"><span data-stu-id="44dd4-271">If **EndPaint** is called first, the class window procedure does no painting because **EndPaint** validates the entire window.</span></span>

<span data-ttu-id="44dd4-272">Une technique en rapport avec le sous-classing est la superclassement.</span><span class="sxs-lookup"><span data-stu-id="44dd4-272">A technique related to subclassing is superclassing.</span></span> <span data-ttu-id="44dd4-273">Une superclasse ressemble à toute autre classe, sauf que sa procédure de fenêtre n’appelle pas [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) pour gérer les messages non traités.</span><span class="sxs-lookup"><span data-stu-id="44dd4-273">A superclass resembles any other class except that its window procedure does not call [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) to handle unprocessed messages.</span></span> <span data-ttu-id="44dd4-274">Au lieu de cela, il transmet des messages non traités à la procédure de fenêtre pour la classe de fenêtre parente.</span><span class="sxs-lookup"><span data-stu-id="44dd4-274">Instead, it passes unprocessed messages to the window procedure for the parent window class.</span></span> <span data-ttu-id="44dd4-275">Suivez les instructions des [procédures de fenêtre](/windows/desktop/winmsg/window-procedures) pour éviter les problèmes qui peuvent se produire avec le sous-classing et le surclassement.</span><span class="sxs-lookup"><span data-stu-id="44dd4-275">Follow the guidelines in [Window Procedures](/windows/desktop/winmsg/window-procedures) to avoid problems that can occur with subclassing and superclassing.</span></span>

 

 