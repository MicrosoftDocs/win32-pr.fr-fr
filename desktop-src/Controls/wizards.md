---
title: Comment créer des assistants
description: Un Assistant est un type de feuille de propriétés qui offre un moyen simple et puissant pour guider les utilisateurs dans une procédure.
ms.assetid: f8def159-0a68-4d7f-9840-c7b6b906ed08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fedd35bd0454e0d78ddbe74d832543e58d0a8fc7
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/19/2021
ms.locfileid: "106529645"
---
# <a name="how-to-create-wizards"></a><span data-ttu-id="e1556-103">Comment créer des assistants</span><span class="sxs-lookup"><span data-stu-id="e1556-103">How to Create Wizards</span></span>

<span data-ttu-id="e1556-104">Un Assistant est un type de feuille de propriétés qui offre un moyen simple et puissant pour guider les utilisateurs dans une procédure.</span><span class="sxs-lookup"><span data-stu-id="e1556-104">A wizard is a type of property sheet that provides a simple and powerful way to guide users through a procedure.</span></span>

<span data-ttu-id="e1556-105">Les assistants sont l’une des clés permettant de simplifier l’expérience utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e1556-105">Wizards are one of the keys to simplifying the user experience.</span></span> <span data-ttu-id="e1556-106">Elles vous permettent d’effectuer une opération complexe, telle que la configuration d’une application, et de la décomposer en une série d’étapes simples.</span><span class="sxs-lookup"><span data-stu-id="e1556-106">They allow you to take a complex operation, such as configuration of an application, and break it into a series of simple steps.</span></span> <span data-ttu-id="e1556-107">À chaque étape du processus, vous pouvez fournir une explication de ce qui est nécessaire et afficher les contrôles qui permettent à l’utilisateur d’effectuer des sélections et d’entrer du texte.</span><span class="sxs-lookup"><span data-stu-id="e1556-107">At each point in the process, you can provide an explanation of what is needed, and display controls that allow the user to make selections and enter text.</span></span>

<span data-ttu-id="e1556-108">Un Assistant est en fait un type de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e1556-108">A wizard is actually a type of property sheet.</span></span> <span data-ttu-id="e1556-109">Une feuille de propriétés est essentiellement un conteneur pour une collection de *pages*, où chaque page est une boîte de dialogue distincte.</span><span class="sxs-lookup"><span data-stu-id="e1556-109">A property sheet is essentially a container for a collection of *pages*, where each page is a separate dialog box.</span></span> <span data-ttu-id="e1556-110">Tandis que les feuilles de propriétés standard permettent à l’utilisateur d’accéder à n’importe quelle page à tout moment, les assistants présentent des pages en séquence.</span><span class="sxs-lookup"><span data-stu-id="e1556-110">Whereas regular property sheets allow the user to access any page at any time, wizards present pages in sequence.</span></span> <span data-ttu-id="e1556-111">Au lieu de tabulations, les boutons permettent de naviguer vers l’avant et vers l’arrière.</span><span class="sxs-lookup"><span data-stu-id="e1556-111">Instead of tabs, buttons are used to navigate forward and backward.</span></span> <span data-ttu-id="e1556-112">L’ordre dans lequel les pages sont affichées est contrôlé par l’application et peut être modifié en fonction de l’entrée de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e1556-112">The order in which pages are displayed is controlled by the application and can be modified based on user input.</span></span>

<span data-ttu-id="e1556-113">Il existe deux principaux styles d’Assistant : l’ancien style Wizard97 et le style Aero introduit dans Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="e1556-113">There are two main styles of wizard: the older Wizard97 style, and the Aero style introduced in Windows Vista.</span></span> <span data-ttu-id="e1556-114">Pour obtenir des illustrations, consultez [à propos des feuilles de propriétés](property-sheets.md).</span><span class="sxs-lookup"><span data-stu-id="e1556-114">For illustrations, see [About Property Sheets](property-sheets.md).</span></span> <span data-ttu-id="e1556-115">(Un troisième style, utilisant uniquement PSH \_ L’Assistant ou \_ l' \_ indicateur Lite de l’Assistant PSH présente une séquence simple de feuilles de propriétés sans en-tête ni filigrane.)</span><span class="sxs-lookup"><span data-stu-id="e1556-115">(A third style, using just the PSH\_WIZARD or PSH\_WIZARD\_LITE flag, presents a simple sequence of property sheets with no headers or watermarks.)</span></span>

> [!Note]  
> <span data-ttu-id="e1556-116">Un « filigrane » dans le contexte des assistants est une image bitmap qui apparaît dans la marge de gauche de certaines pages.</span><span class="sxs-lookup"><span data-stu-id="e1556-116">A "watermark" in the context of wizards is a bitmap that appears in the left margin of some pages.</span></span>

 

<span data-ttu-id="e1556-117">La description de la majeure partie de ce document suppose que vous implémentiez un Assistant pour un système avec la [version 5,80](common-control-versions.md) ou ultérieure des contrôles communs.</span><span class="sxs-lookup"><span data-stu-id="e1556-117">The discussion in most of this document assumes that you are implementing a wizard for a system with [version 5.80](common-control-versions.md) or later of the common controls.</span></span> <span data-ttu-id="e1556-118">Si vous tentez d’utiliser le style Wizard97 avec des versions antérieures des contrôles communs, votre application peut se compiler, mais elle ne s’affichera pas correctement.</span><span class="sxs-lookup"><span data-stu-id="e1556-118">If you attempt to use the Wizard97 style with earlier versions of the common controls, your application may compile but it will not display properly.</span></span> <span data-ttu-id="e1556-119">Pour plus d’informations sur la création d’un Assistant compatible Wizard97 sur des systèmes antérieurs, consultez la section assistants à compatibilité descendante, plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="e1556-119">For a discussion about how to create a Wizard97-compatible wizard on earlier systems, see Backward Compatible Wizards later in this topic.</span></span>

## <a name="what-you-need-to-know"></a><span data-ttu-id="e1556-120">Ce que vous devez savoir</span><span class="sxs-lookup"><span data-stu-id="e1556-120">What you need to know</span></span>

### <a name="technologies"></a><span data-ttu-id="e1556-121">Technologies</span><span class="sxs-lookup"><span data-stu-id="e1556-121">Technologies</span></span>

-   [<span data-ttu-id="e1556-122">Contrôles Windows</span><span class="sxs-lookup"><span data-stu-id="e1556-122">Windows Controls</span></span>](window-controls.md)

### <a name="prerequisites"></a><span data-ttu-id="e1556-123">Prérequis</span><span class="sxs-lookup"><span data-stu-id="e1556-123">Prerequisites</span></span>

-   <span data-ttu-id="e1556-124">C/C++</span><span class="sxs-lookup"><span data-stu-id="e1556-124">C/C++</span></span>
-   <span data-ttu-id="e1556-125">Programmation de l’interface utilisateur Windows</span><span class="sxs-lookup"><span data-stu-id="e1556-125">Windows User Interface Programming</span></span>

## <a name="instructions"></a><span data-ttu-id="e1556-126">Instructions</span><span class="sxs-lookup"><span data-stu-id="e1556-126">Instructions</span></span>

### <a name="wizard-implementation"></a><span data-ttu-id="e1556-127">Implémentation de l’Assistant</span><span class="sxs-lookup"><span data-stu-id="e1556-127">Wizard Implementation</span></span>

<span data-ttu-id="e1556-128">L’implémentation d’un Assistant est semblable à l’implémentation d’une feuille de propriétés régulière.</span><span class="sxs-lookup"><span data-stu-id="e1556-128">Implementing a wizard is similar to implementing a regular property sheet.</span></span> <span data-ttu-id="e1556-129">Au niveau le plus simple, il est important de définir l’un des indicateurs ou combinaisons suivants dans la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) qui définit la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e1556-129">At the most basic level, it is a matter of setting one of the following flags or combinations of flags in the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure that defines the property sheet.</span></span>



| <span data-ttu-id="e1556-130">Indicateur</span><span class="sxs-lookup"><span data-stu-id="e1556-130">Flag</span></span>                           | <span data-ttu-id="e1556-131">Style</span><span class="sxs-lookup"><span data-stu-id="e1556-131">Style</span></span>                                                                                                                                                 |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e1556-132">\_Assistant PSH</span><span class="sxs-lookup"><span data-stu-id="e1556-132">PSH\_WIZARD</span></span>                    | <span data-ttu-id="e1556-133">Assistant simple sans en-tête ni bitmap.</span><span class="sxs-lookup"><span data-stu-id="e1556-133">A simple wizard with no headers or bitmaps.</span></span>                                                                                                           |
| <span data-ttu-id="e1556-134">\_Assistant PSH \_ Lite</span><span class="sxs-lookup"><span data-stu-id="e1556-134">PSH\_WIZARD\_LITE</span></span>              | <span data-ttu-id="e1556-135">Similaire à l' \_ Assistant PSH, avec quelques différences mineures d’apparence ; par exemple, le séparateur au-dessus des boutons est défini sur la largeur totale de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="e1556-135">Similar to PSH\_WIZARD, with some minor differences in appearance; for example, the divider above the buttons is set to the full width of the window.</span></span> |
| <span data-ttu-id="e1556-136">PSH \_ WIZARD97</span><span class="sxs-lookup"><span data-stu-id="e1556-136">PSH\_WIZARD97</span></span>                  | <span data-ttu-id="e1556-137">Un Assistant Wizard97 avec des en-têtes (facultatifs), des bitmaps d’en-tête et des filigranes.</span><span class="sxs-lookup"><span data-stu-id="e1556-137">A Wizard97 wizard with (optional) headers, header bitmaps, and watermarks.</span></span>                                                                            |
| <span data-ttu-id="e1556-138">\_Assistant PSH \| PSH \_ AEROWIZARD</span><span class="sxs-lookup"><span data-stu-id="e1556-138">PSH\_WIZARD \| PSH\_AEROWIZARD</span></span> | <span data-ttu-id="e1556-139">Assistant Aero.</span><span class="sxs-lookup"><span data-stu-id="e1556-139">An Aero Wizard.</span></span> <span data-ttu-id="e1556-140">Les assistants Aero n’utilisent pas les filigranes ni les bitmaps d’en-tête.</span><span class="sxs-lookup"><span data-stu-id="e1556-140">Aero Wizards do not use watermarks or header bitmaps.</span></span> <span data-ttu-id="e1556-141">Ils requièrent le modèle STA (Single-Threaded Apartment).</span><span class="sxs-lookup"><span data-stu-id="e1556-141">They require the single-threaded apartment (STA) model.</span></span>                         |



 

<span data-ttu-id="e1556-142">La procédure de base pour l’implémentation d’un Assistant est la suivante :</span><span class="sxs-lookup"><span data-stu-id="e1556-142">The basic procedure for implementing a wizard is as follows:</span></span>

1.  <span data-ttu-id="e1556-143">Créez un modèle de boîte de dialogue pour chaque page.</span><span class="sxs-lookup"><span data-stu-id="e1556-143">Create a dialog box template for each page.</span></span>
2.  <span data-ttu-id="e1556-144">Définissez les pages en créant une structure [**PROPSHEETPAGE**](pss-propsheetpage.md) pour chaque page.</span><span class="sxs-lookup"><span data-stu-id="e1556-144">Define the pages by creating a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure for each page.</span></span> <span data-ttu-id="e1556-145">Cette structure définit la page et contient des pointeurs vers le modèle de boîte de dialogue et toutes les bitmaps ou autres ressources.</span><span class="sxs-lookup"><span data-stu-id="e1556-145">This structure defines the page, and contains pointers to the dialog box template and any bitmaps or other resources.</span></span>
3.  <span data-ttu-id="e1556-146">Transmettez la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) créée à l’étape précédente à la fonction [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) pour créer le descripteur HPROPSHEETPAGE de la page.</span><span class="sxs-lookup"><span data-stu-id="e1556-146">Pass the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that was created in the previous step to the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function to create the page's HPROPSHEETPAGE handle.</span></span>
4.  <span data-ttu-id="e1556-147">Définissez l’Assistant en créant une structure [**PROPSHEETHEADER**](pss-propsheetheader.md) pour celui-ci.</span><span class="sxs-lookup"><span data-stu-id="e1556-147">Define the wizard by creating a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure for it.</span></span>
5.  <span data-ttu-id="e1556-148">Transmettez la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) à la fonction [**feuille**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) pour afficher l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-148">Pass the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure to the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to display the wizard.</span></span>
6.  <span data-ttu-id="e1556-149">Implémentez des procédures de boîte de dialogue pour chaque page pour gérer les messages de notification à partir des contrôles de la page et des boutons de l’Assistant et pour traiter d’autres messages Windows.</span><span class="sxs-lookup"><span data-stu-id="e1556-149">Implement dialog box procedures for each page to handle notification messages from the page's controls and the wizard's buttons and to process other Windows messaging.</span></span>

### <a name="create-the-dialog-box-templates"></a><span data-ttu-id="e1556-150">Créer les modèles de boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="e1556-150">Create the Dialog Box Templates</span></span>

<span data-ttu-id="e1556-151">Il existe deux types de base de page de l’Assistant : extérieur et intérieur.</span><span class="sxs-lookup"><span data-stu-id="e1556-151">There are two basic types of wizard page: exterior and interior.</span></span> <span data-ttu-id="e1556-152">Les pages externes sont l’introduction (Bienvenue) et les pages de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="e1556-152">Exterior pages are the introduction (welcome) and completion pages.</span></span> <span data-ttu-id="e1556-153">Toutes les autres sont des pages intérieures.</span><span class="sxs-lookup"><span data-stu-id="e1556-153">All others are interior pages.</span></span>

<span data-ttu-id="e1556-154">**Modèles de boîte de dialogue page externe**</span><span class="sxs-lookup"><span data-stu-id="e1556-154">**Exterior Page Dialog Box Templates**</span></span>

<span data-ttu-id="e1556-155">La disposition de base des pages d’introduction et de fin est identique.</span><span class="sxs-lookup"><span data-stu-id="e1556-155">The basic layout of the introduction and completion pages is identical.</span></span> <span data-ttu-id="e1556-156">L’illustration suivante montre un exemple de page d’introduction Wizard97, avec un filigrane d’espace réservé.</span><span class="sxs-lookup"><span data-stu-id="e1556-156">The following illustration shows a sample Wizard97 introduction page, with a placeholder watermark.</span></span>

![capture d’écran montrant une page d’Assistant avec un graphique à gauche, le titre et le corps du texte à droite, et les boutons précédent, suivant et annuler en bas](images/wiz97exterior.png)

<span data-ttu-id="e1556-158">Pour les pages extérieures Wizard97, le modèle de boîte de dialogue est 317x193 Units Dialog units.</span><span class="sxs-lookup"><span data-stu-id="e1556-158">For Wizard97 exterior pages, the dialog box template is 317x193 dialog units.</span></span> <span data-ttu-id="e1556-159">Il remplit tout l’Assistant, à l’exception de la légende et de la bande en bas qui contient les boutons **précédent**, **suivant** et **Annuler** .</span><span class="sxs-lookup"><span data-stu-id="e1556-159">It fills all of the wizard, except for the caption and the band at the bottom that contains the **Back**, **Next**, and **Cancel** buttons.</span></span> <span data-ttu-id="e1556-160">La partie gauche du modèle, qui est réservée à une image bitmap « filigrane », ne doit pas contenir de contrôles.</span><span class="sxs-lookup"><span data-stu-id="e1556-160">The left side of the template, which is reserved for a "watermark" bitmap, should not contain any controls.</span></span> <span data-ttu-id="e1556-161">Le filigrane est spécifié dans la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) de l’Assistant et est ajouté automatiquement à la page.</span><span class="sxs-lookup"><span data-stu-id="e1556-161">The watermark is specified in the wizard's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure and is added to the page automatically.</span></span> <span data-ttu-id="e1556-162">Vous devez lui accorder de l’espace lors de la conception du modèle de ressource.</span><span class="sxs-lookup"><span data-stu-id="e1556-162">You must allow space for it when designing the resource template.</span></span>

<span data-ttu-id="e1556-163">Lorsque vous créez la bitmap de filigrane, gardez à l’esprit que la taille de la boîte de dialogue peut augmenter si, par exemple, l’utilisateur choisit une police système volumineuse.</span><span class="sxs-lookup"><span data-stu-id="e1556-163">When you create the watermark bitmap, keep in mind that the dialog box may increase in size if, for example, the user chooses a large system font.</span></span> <span data-ttu-id="e1556-164">Les différentes langues ont également tendance à avoir des mesures de police différentes.</span><span class="sxs-lookup"><span data-stu-id="e1556-164">Different languages also tend to have different font metrics.</span></span> <span data-ttu-id="e1556-165">Lorsque la page s’agrandit, la zone réservée pour le filigrane est proportionnellement plus grande.</span><span class="sxs-lookup"><span data-stu-id="e1556-165">When the page grows, the area reserved for the watermark gets proportionately larger.</span></span> <span data-ttu-id="e1556-166">Toutefois, vous ne pouvez pas modifier la bitmap de filigrane, ni la bitmap étirée pour remplir la plus grande zone.</span><span class="sxs-lookup"><span data-stu-id="e1556-166">However, you cannot change the watermark bitmap, nor is the bitmap stretched to fill the larger area.</span></span> <span data-ttu-id="e1556-167">Au lieu de cela, la bitmap reste dans sa taille d’origine, dans la partie supérieure gauche de la zone réservée.</span><span class="sxs-lookup"><span data-stu-id="e1556-167">Instead, the bitmap is left in its original size in the upper-left portion of the reserved area.</span></span> <span data-ttu-id="e1556-168">La partie de la zone réservée la plus grande qui n’est pas couverte par le filigrane est remplie automatiquement avec la couleur du pixel supérieur gauche de la bitmap.</span><span class="sxs-lookup"><span data-stu-id="e1556-168">The part of the larger reserved area that is not covered by the watermark is automatically filled with the color of the bitmap's upper-left pixel.</span></span>

<span data-ttu-id="e1556-169">Si vous avez besoin de bitmaps de filigranes de taille différente pour différentes métriques de police, deux solutions possibles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="e1556-169">If you need to have different-sized watermark bitmaps for different font metrics, two possible solutions are:</span></span>

-   <span data-ttu-id="e1556-170">Récupérez les métriques de police avant de créer l’Assistant et spécifiez une bitmap de filigrane de taille appropriée.</span><span class="sxs-lookup"><span data-stu-id="e1556-170">Get the font metrics before creating the wizard, and specify an appropriately sized watermark bitmap.</span></span>
-   <span data-ttu-id="e1556-171">Ne spécifiez pas de bitmap de filigrane lors de la création de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-171">Do not specify a watermark bitmap when you create the wizard.</span></span> <span data-ttu-id="e1556-172">Wizard97 laisse la zone de filigrane vide.</span><span class="sxs-lookup"><span data-stu-id="e1556-172">Wizard97 will leave the watermark area blank.</span></span> <span data-ttu-id="e1556-173">Dessinez ensuite une bitmap de taille appropriée sur la zone réservée pour le filigrane.</span><span class="sxs-lookup"><span data-stu-id="e1556-173">Then draw an appropriately sized bitmap on the area reserved for the watermark.</span></span>

<span data-ttu-id="e1556-174">Vous pouvez placer des contrôles dans la zone à droite du filigrane comme vous le feriez pour une boîte de dialogue normale.</span><span class="sxs-lookup"><span data-stu-id="e1556-174">You can place controls in the area to the right of the watermark as you would for a regular dialog box.</span></span> <span data-ttu-id="e1556-175">La couleur d’arrière-plan de cette zone est déterminée par le système et ne nécessite aucune action de votre part.</span><span class="sxs-lookup"><span data-stu-id="e1556-175">The background color of this area is determined by the system, and requires no action on your part.</span></span> <span data-ttu-id="e1556-176">En général, vous placez deux contrôles statiques dans cette zone.</span><span class="sxs-lookup"><span data-stu-id="e1556-176">You typically put two static controls in this area.</span></span> <span data-ttu-id="e1556-177">La partie supérieure contient le titre et utilise une grande police en gras (12 points Verdana en gras pour Wizard97).</span><span class="sxs-lookup"><span data-stu-id="e1556-177">The upper one holds the title and uses a large bold font (12 point Verdana Bold for Wizard97).</span></span> <span data-ttu-id="e1556-178">L’autre, qui est un texte explicatif, utilise la police de la boîte de dialogue standard.</span><span class="sxs-lookup"><span data-stu-id="e1556-178">The other one, which is for explanatory text, uses the standard dialog box font.</span></span>

<span data-ttu-id="e1556-179">La principale différence entre les pages d’introduction et de fin est les boutons de l’Assistant et le texte des contrôles statiques.</span><span class="sxs-lookup"><span data-stu-id="e1556-179">The main difference between the introduction and completion pages is the wizard buttons and the text in the static controls.</span></span> <span data-ttu-id="e1556-180">Les pages d’introduction ont normalement un bouton **suivant** et un bouton **précédent** , avec uniquement le bouton **suivant** activé.</span><span class="sxs-lookup"><span data-stu-id="e1556-180">Introduction pages normally have a **Next** and a **Back** button, with only the **Next** button enabled.</span></span> <span data-ttu-id="e1556-181">Le bouton **précédent** est activé pour les pages de saisie semi-automatique et le bouton **suivant** est remplacé par un bouton **Terminer** .</span><span class="sxs-lookup"><span data-stu-id="e1556-181">Completion pages have the **Back** button enabled, and the **Next** button is replaced by a **Finish** button.</span></span>

> [!Note]  
> <span data-ttu-id="e1556-182">Dans les assistants Aero, le bouton **précédent** est remplacé par un bouton fléché dans la barre de légende.</span><span class="sxs-lookup"><span data-stu-id="e1556-182">In Aero Wizards, the **Back** button is replaced by an arrow button in the caption bar.</span></span>

 

<span data-ttu-id="e1556-183">Vous pouvez modifier le texte du bouton **Terminer** en envoyant un message [**\_ SETFINISHTEXT PSM**](psm-setfinishtext.md) à l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-183">You can modify the text on the **Finish** button by sending the wizard a [**PSM\_SETFINISHTEXT**](psm-setfinishtext.md) message.</span></span> <span data-ttu-id="e1556-184">Par défaut, le bouton **Terminer** n’inclut pas d’accélérateur clavier.</span><span class="sxs-lookup"><span data-stu-id="e1556-184">By default, the **Finish** button does not include a keyboard accelerator.</span></span> <span data-ttu-id="e1556-185">Pour définir une touche d’accès rapide, incluez une esperluette dans la chaîne de texte que vous transmettez à PSM \_ SETFINISHTEXT.</span><span class="sxs-lookup"><span data-stu-id="e1556-185">To define a keyboard accelerator, include an ampersand in the text string that you pass to PSM\_SETFINISHTEXT.</span></span> <span data-ttu-id="e1556-186">Par exemple, « &Finish » définit « F » comme touche d’accès rapide.</span><span class="sxs-lookup"><span data-stu-id="e1556-186">For instance, "&Finish" defines 'F' as the keyboard accelerator.</span></span>

<span data-ttu-id="e1556-187">**Pages intérieures, modèles de boîte de dialogue**</span><span class="sxs-lookup"><span data-stu-id="e1556-187">**Interior Page Dialog Box Templates**</span></span>

<span data-ttu-id="e1556-188">Les pages intérieures ont une apparence quelque peu différente de celle des pages extérieures.</span><span class="sxs-lookup"><span data-stu-id="e1556-188">Interior pages have a somewhat different appearance than exterior pages.</span></span> <span data-ttu-id="e1556-189">L’illustration suivante montre un exemple de page Wizard97 Interior, avec un bitmap d’en-tête d’espace réservé.</span><span class="sxs-lookup"><span data-stu-id="e1556-189">The following illustration shows a sample Wizard97 interior page, with a placeholder header bitmap.</span></span>

![capture d’écran d’une page d’Assistant avec texte du titre et du sous-titre et un graphique en haut, texte au milieu et boutons en bas](images/wiz97interior.png)

<span data-ttu-id="e1556-191">La zone d’en-tête en haut de la page est gérée par la feuille de propriétés, de sorte qu’elle n’est pas incluse dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="e1556-191">The header area at the top of the page is handled by the property sheet, so it is not included in the template.</span></span> <span data-ttu-id="e1556-192">Le contenu de l’en-tête est spécifié dans la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) de la page et la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-192">The contents of the header are specified in the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure and the wizard's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="e1556-193">Étant donné que la page intérieure doit tenir entre l’en-tête et les boutons, le modèle de boîte de dialogue Wizard97 est 317x143 unités de boîte de dialogue, un peu plus petit que le modèle pour les pages externes.</span><span class="sxs-lookup"><span data-stu-id="e1556-193">Because the interior page needs to fit between the header and the buttons, the Wizard97 dialog box template is 317x143 dialog units, somewhat smaller than the template for exterior pages.</span></span>

<span data-ttu-id="e1556-194">L’illustration suivante montre un Assistant Aero créé à partir du même modèle.</span><span class="sxs-lookup"><span data-stu-id="e1556-194">The following illustration shows an Aero Wizard that was created from the same template.</span></span>

![capture d’écran qui diffère de la précédente en ayant une zone de titre en haut, et uniquement les boutons suivant et annuler en bas](images/wizardaerointerior.png)

### <a name="define-the-wizard-pages"></a><span data-ttu-id="e1556-196">Définir les pages de l’Assistant</span><span class="sxs-lookup"><span data-stu-id="e1556-196">Define the Wizard Pages</span></span>

<span data-ttu-id="e1556-197">Une fois que vous avez créé les modèles de boîte de dialogue et les ressources associées, telles que les bitmaps et les tables de chaînes, vous pouvez créer les pages de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e1556-197">After you have created the dialog box templates and related resources such as bitmaps and string tables, you can create the property sheet pages.</span></span> <span data-ttu-id="e1556-198">La procédure est similaire à celle des feuilles de propriétés standard.</span><span class="sxs-lookup"><span data-stu-id="e1556-198">The procedure is similar to that for standard property sheets.</span></span> <span data-ttu-id="e1556-199">Tout d’abord, renseignez les membres appropriés d’une structure [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="e1556-199">First, fill in the appropriate members of a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span> <span data-ttu-id="e1556-200">(Certains membres sont spécifiques aux assistants.) Appelez ensuite la fonction [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) pour créer le descripteur HPROPSHEETPAGE de la page.</span><span class="sxs-lookup"><span data-stu-id="e1556-200">(Some members are specific to wizards.) Then call the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function to create the page's HPROPSHEETPAGE handle.</span></span>

<span data-ttu-id="e1556-201">Les indicateurs suivants relatifs à l’Assistant peuvent être définis dans le membre **dwFlags** de la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="e1556-201">The following wizard-related flags can be set in the **dwFlags** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span>



| <span data-ttu-id="e1556-202">Indicateur</span><span class="sxs-lookup"><span data-stu-id="e1556-202">Flag</span></span>                   | <span data-ttu-id="e1556-203">Description</span><span class="sxs-lookup"><span data-stu-id="e1556-203">Description</span></span>                                                                                                                         |
|------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e1556-204">\_HIDEHEADER PSP</span><span class="sxs-lookup"><span data-stu-id="e1556-204">PSP\_HIDEHEADER</span></span>        | <span data-ttu-id="e1556-205">Définissez cet indicateur pour les pages extérieures dans Wizard97.</span><span class="sxs-lookup"><span data-stu-id="e1556-205">Set this flag for exterior pages in Wizard97.</span></span> <span data-ttu-id="e1556-206">L’en-tête n’est pas affiché et un filigrane peut être affiché.</span><span class="sxs-lookup"><span data-stu-id="e1556-206">The header is not shown, and a watermark can be shown.</span></span>                                |
| <span data-ttu-id="e1556-207">\_USEHEADERTITLE PSP</span><span class="sxs-lookup"><span data-stu-id="e1556-207">PSP\_USEHEADERTITLE</span></span>    | <span data-ttu-id="e1556-208">Définissez cet indicateur pour les pages intérieures pour placer un titre dans la zone d’en-tête dans Wizard97 ou en haut de la zone cliente dans un Assistant Aero.</span><span class="sxs-lookup"><span data-stu-id="e1556-208">Set this flag for interior pages to put a title in the header area in Wizard97, or at the top of the client area in an Aero Wizard.</span></span> |
| <span data-ttu-id="e1556-209">\_USEHEADERSUBTITLE PSP</span><span class="sxs-lookup"><span data-stu-id="e1556-209">PSP\_USEHEADERSUBTITLE</span></span> | <span data-ttu-id="e1556-210">Définissez cet indicateur pour les pages intérieures pour placer un sous-titre dans la zone d’en-tête dans Wizard97.</span><span class="sxs-lookup"><span data-stu-id="e1556-210">Set this flag for interior pages to put a subtitle in the header area in Wizard97.</span></span>                                                  |



 

<span data-ttu-id="e1556-211">Si vous avez défini PSP \_ USEHEADERTITLE ou PSP \_ USEHEADERSUBTITLE, assignez le titre et le texte du sous-titre aux membres **pszHeaderTitle** et **pszHeaderSubtitle** , respectivement.</span><span class="sxs-lookup"><span data-stu-id="e1556-211">If you have set PSP\_USEHEADERTITLE or PSP\_USEHEADERSUBTITLE, assign the title and subtitle text to the **pszHeaderTitle** and **pszHeaderSubtitle** members, respectively.</span></span> <span data-ttu-id="e1556-212">Lorsque vous assignez des chaînes de texte à des membres des structures [**PROPSHEETPAGE**](pss-propsheetpage.md) et [**PROPSHEETHEADER**](pss-propsheetheader.md) , vous pouvez assigner un pointeur de chaîne ou utiliser la macro **MAKEINTRESOURCE** pour assigner une valeur à partir d’une ressource de type chaîne.</span><span class="sxs-lookup"><span data-stu-id="e1556-212">When you assign text strings to members of the [**PROPSHEETPAGE**](pss-propsheetpage.md) and [**PROPSHEETHEADER**](pss-propsheetheader.md) structures, you can either assign a string pointer or use the **MAKEINTRESOURCE** macro to assign a value from a string resource.</span></span> <span data-ttu-id="e1556-213">La ressource de type chaîne est chargée à partir du module spécifié dans le membre **HINSTANCE** de la structure **PROPSHEETHEADER** de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-213">The string resource is loaded from the module specified in the **hInstance** member of the wizard's **PROPSHEETHEADER** structure.</span></span>

<span data-ttu-id="e1556-214">Quand vous appelez [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) pour créer une page, assignez le résultat à un élément d’un tableau de handles HPROPSHEETPAGE.</span><span class="sxs-lookup"><span data-stu-id="e1556-214">When you call [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) to create a page, assign the result to an element of an array of HPROPSHEETPAGE handles.</span></span> <span data-ttu-id="e1556-215">Ce tableau est utilisé lors de la création de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e1556-215">This array is used when creating the property sheet.</span></span> <span data-ttu-id="e1556-216">L’index de tableau du descripteur d’une page détermine l’ordre par défaut dans lequel il est affiché.</span><span class="sxs-lookup"><span data-stu-id="e1556-216">The array index of a page's handle determines the default order in which it is displayed.</span></span> <span data-ttu-id="e1556-217">Une fois que vous avez créé le descripteur HPROPSHEETPAGE d’une page, vous pouvez réutiliser la même structure [**PROPSHEETPAGE**](pss-propsheetpage.md) pour créer la page suivante en assignant de nouvelles valeurs aux membres appropriés.</span><span class="sxs-lookup"><span data-stu-id="e1556-217">After you have created a page's HPROPSHEETPAGE handle, you can reuse the same [**PROPSHEETPAGE**](pss-propsheetpage.md) structure to create the next page by assigning new values to the relevant members.</span></span>

<span data-ttu-id="e1556-218">Une autre façon de créer des pages consiste à utiliser des structures [**PROPSHEETPAGE**](pss-propsheetpage.md) distinctes pour chaque page et à créer un tableau de structures.</span><span class="sxs-lookup"><span data-stu-id="e1556-218">An alternative way to create pages is to use separate [**PROPSHEETPAGE**](pss-propsheetpage.md) structures for each page, and create an array of structures.</span></span> <span data-ttu-id="e1556-219">Ce tableau est utilisé à la place d’un tableau de handles HPROPSHEETPAGE lors de la création de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e1556-219">This array is used instead of an array of HPROPSHEETPAGE handles when creating the property sheet.</span></span> <span data-ttu-id="e1556-220">L’utilisation de structures **PROPSHEETPAGE** distinctes évite d’avoir à appeler [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , mais utilise davantage de mémoire.</span><span class="sxs-lookup"><span data-stu-id="e1556-220">Using separate **PROPSHEETPAGE** structures eliminates the need to call [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) but uses more memory.</span></span> <span data-ttu-id="e1556-221">Dans le cas contraire, il n’y a pas de différence significative entre les deux approches.</span><span class="sxs-lookup"><span data-stu-id="e1556-221">Otherwise, there is no significant difference between the two approaches.</span></span>

<span data-ttu-id="e1556-222">L’exemple suivant définit une page Wizard97 intérieure en assignant des valeurs à une structure [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="e1556-222">The following example defines an interior Wizard97 page by assigning values to a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span> <span data-ttu-id="e1556-223">Dans cet exemple, le titre, le sous-titre et le modèle de boîte de dialogue de la page sont tous identifiés par leur ID de ressource.</span><span class="sxs-lookup"><span data-stu-id="e1556-223">In this example, the page's title, subtitle, and dialog box template are all identified by their resource IDs.</span></span> <span data-ttu-id="e1556-224">La fonction [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) est ensuite appelée pour créer le descripteur HPROPSHEETPAGE de la page.</span><span class="sxs-lookup"><span data-stu-id="e1556-224">The [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function is then called to create the page's HPROPSHEETPAGE handle.</span></span> <span data-ttu-id="e1556-225">Étant donné qu’il s’agit de la deuxième page à afficher, la poignée est assignée au tableau de descripteurs, *ahpsp*, avec un index de 1.</span><span class="sxs-lookup"><span data-stu-id="e1556-225">Because it will be the second page to appear, the handle is assigned to the array of handles, *ahpsp*, with an index of 1.</span></span>


```C++
// g_hInstance is the global HINSTANCE of the application.
// IntPage1DlgProc is the dialog procedure for this page.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETPAGE psp = { sizeof(psp) };

psp.hInstance         = g_hInstance;
psp.dwFlags           = PSP_USEHEADERTITLE | PSP_USEHEADERSUBTITLE;
psp.lParam            = (LPARAM) &wizdata;
psp.pszHeaderTitle    = MAKEINTRESOURCE(IDS_TITLE1);
psp.pszHeaderSubTitle = MAKEINTRESOURCE(IDS_SUBTITLE1);
psp.pszTemplate       = MAKEINTRESOURCE(IDD_INTERIOR1);
psp.pfnDlgProc        = IntPage1DlgProc;

ahpsp[1] = CreatePropertySheetPage(&psp);
```



### <a name="custom-page-data"></a><span data-ttu-id="e1556-226">Données de page personnalisées</span><span class="sxs-lookup"><span data-stu-id="e1556-226">Custom Page Data</span></span>

<span data-ttu-id="e1556-227">Lorsque vous créez une page, vous pouvez lui assigner des données personnalisées à l’aide du membre **lParam** de la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) , généralement en lui assignant un pointeur vers une structure définie par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e1556-227">When you create a page, you can assign custom data to it by using the **lParam** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure, typically by assigning it a pointer to a user-defined structure.</span></span>

<span data-ttu-id="e1556-228">Lorsque la page est sélectionnée pour la première fois, sa procédure de boîte de dialogue reçoit un message [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="e1556-228">When the page is first selected, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="e1556-229">La valeur *lParam* du message pointe vers une copie de la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) de la page, à partir de laquelle vous pouvez récupérer les données personnalisées.</span><span class="sxs-lookup"><span data-stu-id="e1556-229">The message's *lParam* value points to a copy of of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure, from which you can retrieve the custom data.</span></span> <span data-ttu-id="e1556-230">Vous pouvez ensuite stocker ces données pour les utiliser dans les messages suivants à l’aide de [**SetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) avec GWL \_ UserData comme paramètre d’index.</span><span class="sxs-lookup"><span data-stu-id="e1556-230">You can then store this data for use in subsequent messages by using [**SetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) with GWL\_USERDATA as the index parameter.</span></span> <span data-ttu-id="e1556-231">Plusieurs pages peuvent avoir un pointeur vers les mêmes données et toute modification apportée aux données d’une page est disponible pour les autres pages de leurs procédures de dialogue.</span><span class="sxs-lookup"><span data-stu-id="e1556-231">Multiple pages can have a pointer to the same data, and any change to the data made by one page is available to the other pages in their dialog procedures.</span></span>

### <a name="define-the-wizard-property-sheet"></a><span data-ttu-id="e1556-232">Définir la feuille de propriétés de l’Assistant</span><span class="sxs-lookup"><span data-stu-id="e1556-232">Define the Wizard Property Sheet</span></span>

<span data-ttu-id="e1556-233">Comme avec les feuilles de propriétés ordinaires, vous définissez la feuille de propriétés de l’Assistant en remplissant les membres d’une structure [**PROPSHEETHEADER**](pss-propsheetheader.md) .</span><span class="sxs-lookup"><span data-stu-id="e1556-233">As with ordinary property sheets, you define the wizard's property sheet by filling in members of a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="e1556-234">Cette structure vous permet de spécifier les pages qui composent l’Assistant et l’ordre par défaut dans lequel elles sont affichées, ainsi que plusieurs paramètres associés.</span><span class="sxs-lookup"><span data-stu-id="e1556-234">This structure allows you to specify the pages that make up the wizard and the default order in which they are displayed, along with several related parameters.</span></span> <span data-ttu-id="e1556-235">Vous lancez ensuite l’Assistant en appelant la fonction [**feuille**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="e1556-235">You then launch the wizard by calling the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="e1556-236">Dans le style Wizard97, le membre **pszCaption** de la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e1556-236">In the Wizard97 style, the **pszCaption** member of the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure is ignored.</span></span> <span data-ttu-id="e1556-237">Au lieu de cela, l’Assistant affiche la légende qui est spécifiée dans le modèle de boîte de dialogue de la page active.</span><span class="sxs-lookup"><span data-stu-id="e1556-237">Instead, the wizard displays the caption that is specified in the current page's dialog box template.</span></span> <span data-ttu-id="e1556-238">Si le modèle ne possède pas de légende, la légende de la page précédente s’affiche.</span><span class="sxs-lookup"><span data-stu-id="e1556-238">If the template lacks a caption, the caption from the previous page is displayed.</span></span> <span data-ttu-id="e1556-239">Ainsi, pour afficher la même légende dans toutes les pages, spécifiez la légende dans le modèle pour la page d’introduction.</span><span class="sxs-lookup"><span data-stu-id="e1556-239">Thus, to display the same caption on all pages, specify the caption in the template for the introductory page.</span></span>

<span data-ttu-id="e1556-240">Dans le style de l’Assistant Aero, la légende de la boîte de dialogue est extraite de **pszCaption**.</span><span class="sxs-lookup"><span data-stu-id="e1556-240">In the Aero Wizard style, the dialog box caption is taken from **pszCaption**.</span></span>

<span data-ttu-id="e1556-241">Si vous avez créé un tableau de handles HPROPSHEETPAGE pour vos pages, assignez le tableau au membre **phpage** .</span><span class="sxs-lookup"><span data-stu-id="e1556-241">If you have created an array of HPROPSHEETPAGE handles for your pages, assign the array to the **phpage** member.</span></span> <span data-ttu-id="e1556-242">Si vous avez créé un tableau de structures [**PROPSHEETPAGE**](pss-propsheetpage.md) à la place, assignez le tableau au membre **PPSP** et définissez l' \_ indicateur PROPSHEETPAGE PSH dans le membre **dwFlags** .</span><span class="sxs-lookup"><span data-stu-id="e1556-242">If you have instead created an array of [**PROPSHEETPAGE**](pss-propsheetpage.md) structures, assign the array to the **ppsp** member and set the PSH\_PROPSHEETPAGE flag in the **dwFlags** member.</span></span>

<span data-ttu-id="e1556-243">L’exemple suivant affecte des valeurs à *PSH*, à une structure [**PROPSHEETHEADER**](pss-propsheetheader.md) , et appelle la fonction [**feuille**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) pour lancer l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-243">The following example assigns values to *psh*, a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure, and calls the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to launch the wizard.</span></span> <span data-ttu-id="e1556-244">L’Assistant de style Wizard97 contient à la fois des graphiques en filigrane et en-tête, spécifiés par leur ID de ressource.</span><span class="sxs-lookup"><span data-stu-id="e1556-244">The Wizard97-style wizard has both watermark and header graphics, specified by their resource IDs.</span></span> <span data-ttu-id="e1556-245">Le tableau *ahpsp* contient tous les handles HPROPSHEETPAGE et définit l’ordre par défaut dans lequel ils sont affichés.</span><span class="sxs-lookup"><span data-stu-id="e1556-245">The *ahpsp* array contains all the HPROPSHEETPAGE handles and defines the default order in which they are displayed.</span></span>


```C++
// g_hInstance is the global HINSTANCE of the application.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETHEADER psh = { sizeof(psh) };

psh.hInstance      = g_hInstance;
psh.hwndParent     = NULL;
psh.phpage         = ahpsp;
psh.dwFlags        = PSH_WIZARD97 | PSH_WATERMARK | PSH_HEADER;
psh.pszbmWatermark = MAKEINTRESOURCE(IDB_WATERMARK);
psh.pszbmHeader    = MAKEINTRESOURCE(IDB_BANNER);
psh.nStartPage     = 0;
psh.nPages         = 4;

PropertySheet(&psh);
```



### <a name="the-dialog-box-procedure"></a><span data-ttu-id="e1556-246">La procédure de la boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="e1556-246">The Dialog Box Procedure</span></span>

<span data-ttu-id="e1556-247">Chaque page de l’Assistant a besoin d’une procédure de boîte de dialogue pour traiter les messages Windows, en particulier les notifications de ses contrôles et de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-247">Each page of the wizard needs a dialog box procedure to process Windows messages, particularly notifications from its controls and the wizard.</span></span> <span data-ttu-id="e1556-248">Les trois messages que presque tous les assistants doivent pouvoir gérer sont [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog), [**WM \_ Destroy**](/windows/desktop/winmsg/wm-destroy)et [**WM \_ Notify**](wm-notify.md).</span><span class="sxs-lookup"><span data-stu-id="e1556-248">The three messages that almost all wizards must be able to handle are [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog), [**WM\_DESTROY**](/windows/desktop/winmsg/wm-destroy), and [**WM\_NOTIFY**](wm-notify.md).</span></span>

<span data-ttu-id="e1556-249">Le message [**WM \_ Notify**](wm-notify.md) est reçu avant l’affichage de la page et l’utilisateur clique sur l’un des boutons de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-249">The [**WM\_NOTIFY**](wm-notify.md) message is received before the page is displayed and when any of the wizard's buttons are clicked.</span></span> <span data-ttu-id="e1556-250">Le paramètre *lParam* du message est un pointeur vers une structure d’en-tête [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) .</span><span class="sxs-lookup"><span data-stu-id="e1556-250">The *lParam* parameter of the message is a pointer to a [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) header structure.</span></span> <span data-ttu-id="e1556-251">L’ID de la notification est contenu dans le membre de **code** de la structure.</span><span class="sxs-lookup"><span data-stu-id="e1556-251">The notification's ID is contained in the structure's **code** member.</span></span> <span data-ttu-id="e1556-252">Les quatre notifications que la plupart des assistants doivent gérer sont les suivantes.</span><span class="sxs-lookup"><span data-stu-id="e1556-252">The four notifications that most wizards need to handle are the following.</span></span>



| <span data-ttu-id="e1556-253">Code</span><span class="sxs-lookup"><span data-stu-id="e1556-253">Code</span></span>                                | <span data-ttu-id="e1556-254">Description</span><span class="sxs-lookup"><span data-stu-id="e1556-254">Description</span></span>                                 |
|-------------------------------------|---------------------------------------------|
| [<span data-ttu-id="e1556-255">PSN \_</span><span class="sxs-lookup"><span data-stu-id="e1556-255">PSN\_SETACTIVE</span></span>](psn-setactive.md) | <span data-ttu-id="e1556-256">Envoyé avant l’affichage de la page.</span><span class="sxs-lookup"><span data-stu-id="e1556-256">Sent before the page is displayed.</span></span>          |
| [<span data-ttu-id="e1556-257">PSN \_ WIZBACK</span><span class="sxs-lookup"><span data-stu-id="e1556-257">PSN\_WIZBACK</span></span>](psn-wizback.md)     | <span data-ttu-id="e1556-258">Envoyé lorsque l’utilisateur clique sur le bouton **précédent** .</span><span class="sxs-lookup"><span data-stu-id="e1556-258">Sent when the **Back** button is clicked.</span></span>   |
| [<span data-ttu-id="e1556-259">PSN \_ WIZNEXT</span><span class="sxs-lookup"><span data-stu-id="e1556-259">PSN\_WIZNEXT</span></span>](psn-wiznext.md)     | <span data-ttu-id="e1556-260">Envoyé lorsque l’utilisateur clique sur le bouton **suivant** .</span><span class="sxs-lookup"><span data-stu-id="e1556-260">Sent when the **Next** button is clicked.</span></span>   |
| [<span data-ttu-id="e1556-261">PSN \_ WIZFINISH</span><span class="sxs-lookup"><span data-stu-id="e1556-261">PSN\_WIZFINISH</span></span>](psn-wizfinish.md) | <span data-ttu-id="e1556-262">Envoyé lorsque l’utilisateur clique sur le bouton **Terminer** .</span><span class="sxs-lookup"><span data-stu-id="e1556-262">Sent when the **Finish** button is clicked.</span></span> |



 

### <a name="handle-wm_initdialog-and-wm_destroy"></a><span data-ttu-id="e1556-263">Gérer WM \_ INITDIALOG et WM \_ Destroy</span><span class="sxs-lookup"><span data-stu-id="e1556-263">Handle WM\_INITDIALOG and WM\_DESTROY</span></span>

<span data-ttu-id="e1556-264">Quand une page est sur le point d’être affichée pour la première fois, la procédure de la boîte de dialogue reçoit un message [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="e1556-264">When a page is about to be displayed for the first time, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="e1556-265">La gestion de ce message permet à l’Assistant d’effectuer toutes les tâches d’initialisation nécessaires, telles que le stockage de données personnalisées ou la définition de polices.</span><span class="sxs-lookup"><span data-stu-id="e1556-265">Handling this message allows the wizard to do any needed initialization tasks, such as storing custom data or setting fonts.</span></span>

<span data-ttu-id="e1556-266">Lorsque la feuille de propriétés est détruite, vous recevez un message [**WM \_ Destroy**](/windows/desktop/winmsg/wm-destroy) .</span><span class="sxs-lookup"><span data-stu-id="e1556-266">When the property sheet is destroyed, you receive a [**WM\_DESTROY**](/windows/desktop/winmsg/wm-destroy) message.</span></span> <span data-ttu-id="e1556-267">L’Assistant est automatiquement détruit par le système, mais le traitement de ce message vous permet d’effectuer les nettoyages nécessaires.</span><span class="sxs-lookup"><span data-stu-id="e1556-267">The wizard is automatically destroyed by the system, but handling this message allows you to do any needed cleanup.</span></span>

### <a name="handle-psn_setactive"></a><span data-ttu-id="e1556-268">Gérer PSN \_ SEtactive</span><span class="sxs-lookup"><span data-stu-id="e1556-268">Handle PSN\_SETACTIVE</span></span>

<span data-ttu-id="e1556-269">Le [code \_ de notification PSN](psn-setactive.md) est envoyé chaque fois qu’une page est sur le point d’être affichée.</span><span class="sxs-lookup"><span data-stu-id="e1556-269">The [PSN\_SETACTIVE](psn-setactive.md) notification code is sent each time a page is about to be made visible.</span></span> <span data-ttu-id="e1556-270">La première fois qu’une page est visitée, PSN \_ SEtactive suit le message [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="e1556-270">The first time a page is visited, PSN\_SETACTIVE follows the [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="e1556-271">Si la page est revisitée par la suite, elle reçoit uniquement une \_ notification SEtactive PSN.</span><span class="sxs-lookup"><span data-stu-id="e1556-271">If the page is subsequently revisited, it receives only a PSN\_SETACTIVE notification.</span></span> <span data-ttu-id="e1556-272">Cette notification est généralement gérée pour initialiser les données de la page et activer les boutons appropriés.</span><span class="sxs-lookup"><span data-stu-id="e1556-272">This notification is usually handled to initialize data for the page and enable the appropriate buttons.</span></span>

<span data-ttu-id="e1556-273">Par défaut, l’Assistant affiche les boutons **précédent**, **suivant** et **Annuler** , avec tous les boutons activés.</span><span class="sxs-lookup"><span data-stu-id="e1556-273">By default, the wizard displays **Back**, **Next**, and **Cancel** buttons, with all buttons enabled.</span></span> <span data-ttu-id="e1556-274">Pour désactiver un bouton ou afficher la **fin** au lieu de la **prochaine**, vous devez envoyer un message [**\_ SETWIZBUTTONS PSM**](psm-setwizbuttons.md) .</span><span class="sxs-lookup"><span data-stu-id="e1556-274">To disable a button or display **Finish** instead of **Next**, you must send a [**PSM\_SETWIZBUTTONS**](psm-setwizbuttons.md) message.</span></span> <span data-ttu-id="e1556-275">Une fois que ce message a été envoyé, l’état des boutons est conservé jusqu’à ce qu’il soit modifié par un autre message **\_ SETWIZBUTTONS PSM** , même si une nouvelle page est sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e1556-275">After this message has been sent, the state of the buttons is preserved until it is modified by another **PSM\_SETWIZBUTTONS** message, even if a new page is selected.</span></span> <span data-ttu-id="e1556-276">En règle générale, tous les gestionnaires [PSN \_ setacteurs](psn-setactive.md) envoient ce message pour s’assurer que chaque page a l’état de bouton correct.</span><span class="sxs-lookup"><span data-stu-id="e1556-276">Typically, all [PSN\_SETACTIVE](psn-setactive.md) handlers send this message to ensure that each page has the correct button state.</span></span>

<span data-ttu-id="e1556-277">Vous pouvez modifier l’état du bouton avec ce message à tout moment.</span><span class="sxs-lookup"><span data-stu-id="e1556-277">You can change the button state with this message at any time.</span></span> <span data-ttu-id="e1556-278">Par exemple, vous souhaiterez peut-être désactiver initialement le bouton **suivant** .</span><span class="sxs-lookup"><span data-stu-id="e1556-278">For example, you may want the **Next** button to be initially disabled.</span></span> <span data-ttu-id="e1556-279">Une fois qu’un utilisateur a entré toutes les informations nécessaires, vous pouvez envoyer un autre message [**\_ SETWIZBUTTONS PSM**](psm-setwizbuttons.md) pour activer le bouton **suivant** et permettre à l’utilisateur de passer à la page suivante.</span><span class="sxs-lookup"><span data-stu-id="e1556-279">After a user has entered all the necessary information, you can send another [**PSM\_SETWIZBUTTONS**](psm-setwizbuttons.md) message to enable the **Next** button and let the user proceed to the next page.</span></span>

<span data-ttu-id="e1556-280">Le fragment de code suivant utilise la macro [**PropSheet \_ SetWizButtons**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) pour activer les boutons **précédent** et **suivant** sur une page intérieure avant qu’elle ne soit affichée.</span><span class="sxs-lookup"><span data-stu-id="e1556-280">The following code fragment uses the [**PropSheet\_SetWizButtons**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) macro to enable the **Back** and **Next** buttons on an interior page before it is displayed.</span></span>


```C++
case WM_NOTIFY :
    {
        LPNMHDR pnmh = (LPNMHDR)lParam;
        
        switch(pnmh->code)
        {
        
        ...
        
        case PSN_SETACTIVE :
        
            ...
            
            // This is an interior page.
            PropSheet_SetWizButtons(hwnd, PSWIZB_NEXT | PSWIZB_BACK);
            
            ...
        }
    ...
    
    }
```



### <a name="handle-psn_wiznext-psnwizback-and-psn_wizfinish"></a><span data-ttu-id="e1556-281">Gérer PSN \_ WIZNEXT, PSNWIZBACK et PSN \_ WIZFINISH</span><span class="sxs-lookup"><span data-stu-id="e1556-281">Handle PSN\_WIZNEXT, PSNWIZBACK, and PSN\_WIZFINISH</span></span>

<span data-ttu-id="e1556-282">Quand vous cliquez sur un bouton **suivant** ou **précédent** , vous recevez un code de notification [PSN \_ WIZNEXT](psn-wiznext.md) ou [PSN \_ WIZBACK](psn-wizback.md) .</span><span class="sxs-lookup"><span data-stu-id="e1556-282">When a **Next** or **Back** button is clicked, you receive a [PSN\_WIZNEXT](psn-wiznext.md) or [PSN\_WIZBACK](psn-wizback.md) notification code.</span></span> <span data-ttu-id="e1556-283">Par défaut, l’Assistant passe automatiquement à la page suivante ou précédente dans l’ordre défini lors de la création de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e1556-283">By default, the wizard automatically goes to either the next or previous page in the order that is defined when the property sheet is created.</span></span> <span data-ttu-id="e1556-284">Une raison courante pour gérer ces notifications est d’empêcher l’utilisateur de changer de page ou de remplacer l’ordre des pages par défaut.</span><span class="sxs-lookup"><span data-stu-id="e1556-284">A common reason to handle these notifications is to prevent the user from switching pages, or to override the default page order.</span></span>

<span data-ttu-id="e1556-285">Pour empêcher l’utilisateur de changer de page, gérez la notification du bouton, appelez la fonction [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) avec la \_ valeur-1 de la propriété DWL MSGRESULT, et retournez la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="e1556-285">To prevent the user from switching pages, handle the button notification, call the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function with the DWL\_MSGRESULT value set to –1, and return **TRUE**.</span></span> <span data-ttu-id="e1556-286">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="e1556-286">For example:</span></span>


```C++
case PSN_WIZNEXT :

        ...
        
        // Do not go to the next page yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, -1);
        
        return TRUE;
        
        ...
```



<span data-ttu-id="e1556-287">Pour remplacer l’ordre standard et accéder à une page particulière, appelez [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) avec la \_ valeur MSGRESULT de la page DWL définie sur l’ID de ressource de la boîte de dialogue de la page, puis renvoyez **true**.</span><span class="sxs-lookup"><span data-stu-id="e1556-287">To override the standard order and go to a particular page, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with the DWL\_MSGRESULT value set to the page's dialog box resource ID, and return **TRUE**.</span></span> <span data-ttu-id="e1556-288">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="e1556-288">For example:</span></span>


```C++
case PSN_WIZNEXT :

        ...
        
        // Go straight to the completion page.
        SetWindowLong(hwnd, DWL_MSGRESULT, IDD_FINISH);
        
        return TRUE;
        
        ...
```



<span data-ttu-id="e1556-289">Lorsque l’utilisateur clique sur le bouton **Terminer** ou **Annuler** , vous recevez un code de notification de [ \_ réinitialisation](psn-reset.md) [PSN \_ WIZFINISH](psn-wizfinish.md) ou PSN, respectivement.</span><span class="sxs-lookup"><span data-stu-id="e1556-289">When the **Finish** or **Cancel** button is clicked, you receive a [PSN\_WIZFINISH](psn-wizfinish.md) or [PSN\_RESET](psn-reset.md) notification code, respectively.</span></span> <span data-ttu-id="e1556-290">Lorsque vous cliquez sur l’un de ces boutons, l’Assistant est automatiquement détruit par le système.</span><span class="sxs-lookup"><span data-stu-id="e1556-290">When either of these buttons is clicked, the wizard is automatically destroyed by the system.</span></span> <span data-ttu-id="e1556-291">Toutefois, vous pouvez gérer ces notifications si vous devez effectuer des tâches de nettoyage avant la destruction de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="e1556-291">However, you can handle these notifications if you need to perform cleanup tasks before the wizard is destroyed.</span></span> <span data-ttu-id="e1556-292">Pour empêcher la destruction de l’Assistant lorsque vous recevez une \_ notification PSN WIZFINISH, appelez [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) avec la \_ valeur de MSGRESULT DWL définie sur **true**, puis revenez à **true**.</span><span class="sxs-lookup"><span data-stu-id="e1556-292">To prevent the wizard from being destroyed when you receive a PSN\_WIZFINISH notification, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with the DWL\_MSGRESULT value set to **TRUE**, and return **TRUE**.</span></span> <span data-ttu-id="e1556-293">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="e1556-293">For example:</span></span>


```C++
case PSN_WIZFINISH :

        ...
        
        // Not finished yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, TRUE);
        
        return TRUE;
        
        ...
```



### <a name="backward-compatible-wizards"></a><span data-ttu-id="e1556-294">Assistants à compatibilité descendante</span><span class="sxs-lookup"><span data-stu-id="e1556-294">Backward Compatible Wizards</span></span>

<span data-ttu-id="e1556-295">La section précédente suppose que vous implémentez un Assistant pour un système avec la [version 5](common-control-versions.md) ou ultérieure des contrôles communs.</span><span class="sxs-lookup"><span data-stu-id="e1556-295">The preceding section assumes that you are implementing a wizard for a system with [version 5](common-control-versions.md) or later of the common controls.</span></span>

<span data-ttu-id="e1556-296">Si vous écrivez un Assistant pour des systèmes avec des versions antérieures des contrôles communs, la plupart des fonctionnalités décrites dans la section précédente ne seront pas disponibles.</span><span class="sxs-lookup"><span data-stu-id="e1556-296">If you are writing a wizard for systems with earlier versions of the common controls, many of the features discussed in the preceding section will not be available.</span></span> <span data-ttu-id="e1556-297">Un certain nombre de membres des structures [**PROPSHEETHEADER**](pss-propsheetheader.md) et [**PROPSHEETPAGE**](pss-propsheetpage.md) qui sont utilisés par le style Wizard97 sont pris en charge uniquement par les contrôles communs version 5 et ultérieures.</span><span class="sxs-lookup"><span data-stu-id="e1556-297">A number of the members of the [**PROPSHEETHEADER**](pss-propsheetheader.md) and [**PROPSHEETPAGE**](pss-propsheetpage.md) structures that are used by the Wizard97 style are supported only by common controls version 5 and later.</span></span> <span data-ttu-id="e1556-298">Toutefois, il est toujours possible d’implémenter un assistant à *compatibilité descendante* avec une apparence similaire à celle du style Wizard97.</span><span class="sxs-lookup"><span data-stu-id="e1556-298">However, it is still possible to implement a *backward compatible* wizard with an appearance similar to that of the Wizard97 style.</span></span> <span data-ttu-id="e1556-299">Pour ce faire, vous devez implémenter explicitement les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="e1556-299">To do so, you must explicitly implement the following:</span></span>

-   <span data-ttu-id="e1556-300">Ajoutez le graphique en filigrane au modèle de boîte de dialogue pour vos pages d’introduction et de fin.</span><span class="sxs-lookup"><span data-stu-id="e1556-300">Add the watermark graphic to the dialog box template for your introduction and completion pages.</span></span>
-   <span data-ttu-id="e1556-301">Modifiez la taille de tous vos modèles.</span><span class="sxs-lookup"><span data-stu-id="e1556-301">Make all your templates the same size.</span></span> <span data-ttu-id="e1556-302">Il n’existe pas de zone d’en-tête définie par le système distincte pour les pages intérieures.</span><span class="sxs-lookup"><span data-stu-id="e1556-302">There is no separate system-defined header area for interior pages.</span></span>
-   <span data-ttu-id="e1556-303">Créez explicitement la zone d’en-tête de la page intérieure sur vos modèles.</span><span class="sxs-lookup"><span data-stu-id="e1556-303">Create the interior page's header area explicitly on your templates.</span></span>
-   <span data-ttu-id="e1556-304">N’utilisez pas de graphique d’en-tête, car il peut être en conflit avec le titre ou le sous-titre si l’Assistant change de taille.</span><span class="sxs-lookup"><span data-stu-id="e1556-304">Do not use a header graphic because it may conflict with the title or subtitle if the wizard changes size.</span></span>

<span data-ttu-id="e1556-305">Pour plus d’informations sur les assistants à compatibilité descendante, consultez Assistant à compatibilité [descendante 97](/previous-versions//ms737910(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="e1556-305">For further discussion of backward-compatible wizards, see [Backward Compatible Wizard 97](/previous-versions//ms737910(v=vs.85)).</span></span>

## <a name="remarks"></a><span data-ttu-id="e1556-306">Notes</span><span class="sxs-lookup"><span data-stu-id="e1556-306">Remarks</span></span>

<span data-ttu-id="e1556-307">Pour une présentation complète des problèmes de conception pour Wizard97, consultez la [spécification Wizard97](/previous-versions//ms738248(v=vs.85)), ailleurs dans le SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="e1556-307">For a complete discussion of design issues for Wizard97, see the [Wizard97 Specification](/previous-versions//ms738248(v=vs.85)), elsewhere in the Windows SDK.</span></span> <span data-ttu-id="e1556-308">Ce document contient des instructions pour des éléments tels que les dimensions des boîtes de dialogue, les dimensions et les couleurs de la bitmap et le positionnement des contrôles.</span><span class="sxs-lookup"><span data-stu-id="e1556-308">This document has guidelines for such things as the dimensions for the dialog boxes, bitmap dimensions and colors, and the placement of controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e1556-309">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e1556-309">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e1556-310">Utilisation des feuilles de propriétés</span><span class="sxs-lookup"><span data-stu-id="e1556-310">Using Property Sheets</span></span>](using-property-sheets.md)
</dt> <dt>

<span data-ttu-id="e1556-311">[Démonstration des contrôles communs Windows (CppWindowsCommonControls)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)</span><span class="sxs-lookup"><span data-stu-id="e1556-311">[Windows common controls demo (CppWindowsCommonControls)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)</span></span>
</dt> </dl>

 

 