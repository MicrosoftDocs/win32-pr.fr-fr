---
title: À propos des feuilles de propriétés
description: Une feuille de propriétés est une fenêtre qui permet à l’utilisateur d’afficher et de modifier les propriétés d’un élément.
ms.assetid: 93676a64-7980-48cd-8615-23b14a118e1c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3256959b588e2109740033692c0c528889fc939f
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/19/2021
ms.locfileid: "106525315"
---
# <a name="about-property-sheets"></a><span data-ttu-id="f769d-103">À propos des feuilles de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-103">About Property Sheets</span></span>

<span data-ttu-id="f769d-104">Une *feuille de propriétés* est une fenêtre qui permet à l’utilisateur d’afficher et de modifier les propriétés d’un élément.</span><span class="sxs-lookup"><span data-stu-id="f769d-104">A *property sheet* is a window that allows the user to view and edit the properties of an item.</span></span> <span data-ttu-id="f769d-105">Par exemple, une application de feuille de calcul peut utiliser une feuille de propriétés pour permettre à l’utilisateur de définir les propriétés de police et de bordure d’une cellule ou pour afficher et définir les propriétés d’un périphérique, tel qu’un lecteur de disque, une imprimante ou une souris.</span><span class="sxs-lookup"><span data-stu-id="f769d-105">For example, a spreadsheet application can use a property sheet to allow the user to set the font and border properties of a cell or to view and set the properties of a device, such as a disk drive, printer, or mouse.</span></span>

<span data-ttu-id="f769d-106">Cette section décrit les rubriques suivantes.</span><span class="sxs-lookup"><span data-stu-id="f769d-106">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="f769d-107">Notions de base de la feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-107">Property Sheet Basics</span></span>](#property-sheet-basics)
-   [<span data-ttu-id="f769d-108">Boîtes de dialogue de la feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-108">Property Sheet Dialog Boxes</span></span>](#property-sheet-dialog-boxes)
-   [<span data-ttu-id="f769d-109">Pages</span><span class="sxs-lookup"><span data-stu-id="f769d-109">Pages</span></span>](#pages)
-   [<span data-ttu-id="f769d-110">Création de la feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-110">Property Sheet Creation</span></span>](#property-sheet-creation)
-   [<span data-ttu-id="f769d-111">Ajout et suppression de pages</span><span class="sxs-lookup"><span data-stu-id="f769d-111">Adding and Removing Pages</span></span>](#adding-and-removing-pages)
-   [<span data-ttu-id="f769d-112">Titre et étiquettes de page de la feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-112">Property Sheet Title and Page Labels</span></span>](#property-sheet-title-and-page-labels)
-   [<span data-ttu-id="f769d-113">Activation de page</span><span class="sxs-lookup"><span data-stu-id="f769d-113">Page Activation</span></span>](#page-activation)
-   [<span data-ttu-id="f769d-114">Bouton aide</span><span class="sxs-lookup"><span data-stu-id="f769d-114">Help Button</span></span>](#help-button)
    -   [<span data-ttu-id="f769d-115">Suppression du bouton d’aide barre de légende</span><span class="sxs-lookup"><span data-stu-id="f769d-115">Removing the Caption Bar Help Button</span></span>](#removing-the-caption-bar-help-button)
-   [<span data-ttu-id="f769d-116">Boutons OK, annuler et appliquer</span><span class="sxs-lookup"><span data-stu-id="f769d-116">OK, Cancel, and Apply Buttons</span></span>](#ok-cancel-and-apply-buttons)
-   [<span data-ttu-id="f769d-117">Assistants</span><span class="sxs-lookup"><span data-stu-id="f769d-117">Wizards</span></span>](#wizards)

## <a name="property-sheet-basics"></a><span data-ttu-id="f769d-118">Notions de base de la feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-118">Property Sheet Basics</span></span>

<span data-ttu-id="f769d-119">Pour implémenter les feuilles de propriétés dans votre application, incluez le fichier d’en-tête Prsht. h dans votre projet.</span><span class="sxs-lookup"><span data-stu-id="f769d-119">To implement property sheets in your application, include the Prsht.h header file in your project.</span></span> <span data-ttu-id="f769d-120">Prsht. h contient tous les identificateurs utilisés avec les feuilles de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-120">Prsht.h contains all of the identifiers used with property sheets.</span></span>

<span data-ttu-id="f769d-121">Une feuille de propriétés contient une ou plusieurs fenêtres enfants qui se chevauchent, appelées pages, chacune contenant des fenêtres de contrôle pour la définition d’un groupe de propriétés associées.</span><span class="sxs-lookup"><span data-stu-id="f769d-121">A property sheet contains one or more overlapping child windows called pages, each containing control windows for setting a group of related properties.</span></span> <span data-ttu-id="f769d-122">Par exemple, une page peut contenir les contrôles permettant de définir les propriétés de police d’un élément, notamment le style de type, la taille du point, la couleur, etc.</span><span class="sxs-lookup"><span data-stu-id="f769d-122">For example, a page can contain the controls for setting the font properties of an item, including the type style, point size, color, and so on.</span></span> <span data-ttu-id="f769d-123">Chaque page comporte un onglet que l’utilisateur peut sélectionner pour amener la page au premier plan de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-123">Each page has a tab that the user can select to bring the page to the foreground of the property sheet.</span></span> <span data-ttu-id="f769d-124">Par exemple, l' Date-Time application du panneau de configuration affiche la feuille de propriétés suivante.</span><span class="sxs-lookup"><span data-stu-id="f769d-124">For example, the Date-Time control panel application displays the following property sheet.</span></span>

![capture d’écran d’une feuille de propriétés avec deux onglets, l’un d’entre eux montrant une horloge et un contrôle calendrier mensuel](images/propsheet1.png)

<span data-ttu-id="f769d-126">Une feuille de propriétés standard avec plusieurs pages avec onglets permet à l’utilisateur d’accéder de manière aléatoire à toutes les propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-126">A standard property sheet with multiple, tabbed pages allows the user random access to all properties.</span></span> <span data-ttu-id="f769d-127">S’il est plus approprié d’avoir des propriétés définies en séquence, vous pouvez utiliser un [Assistant](#wizards).</span><span class="sxs-lookup"><span data-stu-id="f769d-127">If it is more appropriate to have properties set in sequence, you can use a [wizard](#wizards).</span></span>

## <a name="property-sheet-dialog-boxes"></a><span data-ttu-id="f769d-128">Boîtes de dialogue de la feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-128">Property Sheet Dialog Boxes</span></span>

<span data-ttu-id="f769d-129">Une feuille de propriétés et les pages qu’elle contient sont en fait des boîtes de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f769d-129">A property sheet and the pages it contains are actually dialog boxes.</span></span> <span data-ttu-id="f769d-130">La feuille de propriétés est une boîte de dialogue définie par le système qui gère les pages et fournit un conteneur commun pour eux.</span><span class="sxs-lookup"><span data-stu-id="f769d-130">The property sheet is a system-defined dialog box that manages the pages and provides a common container for them.</span></span> <span data-ttu-id="f769d-131">Une boîte de dialogue de feuille de propriétés peut être modale ou non modale.</span><span class="sxs-lookup"><span data-stu-id="f769d-131">A property sheet dialog box can be modal or modeless.</span></span> <span data-ttu-id="f769d-132">Il comprend un cadre, une barre de titre et quatre boutons : **OK**, **Annuler**, **appliquer** et (éventuellement) de **l’aide**.</span><span class="sxs-lookup"><span data-stu-id="f769d-132">It includes a frame, a title bar, and four buttons: **OK**, **Cancel**, **Apply**, and (optionally) **Help**.</span></span> <span data-ttu-id="f769d-133">Les procédures de la boîte de dialogue pour les pages reçoivent des codes de notification sous la forme de messages [**WM \_ Notify**](wm-notify.md) quand l’utilisateur clique sur les boutons.</span><span class="sxs-lookup"><span data-stu-id="f769d-133">The dialog box procedures for the pages receive notification codes in the form of [**WM\_NOTIFY**](wm-notify.md) messages when the user clicks the buttons.</span></span>

> [!NOTE]  
> <span data-ttu-id="f769d-134">Toutes les informations contenues dans cette section ne s’appliquent pas aux assistants, qui ont une apparence et un comportement légèrement différents.</span><span class="sxs-lookup"><span data-stu-id="f769d-134">Not all the information in this section applies to wizards, which have a somewhat different appearance and behavior.</span></span> <span data-ttu-id="f769d-135">Par exemple, les assistants ont un ensemble différent de boutons et aucun onglet.</span><span class="sxs-lookup"><span data-stu-id="f769d-135">For example, wizards have a different set of buttons and no tabs.</span></span> <span data-ttu-id="f769d-136">Pour plus d’informations, consultez [création d’assistants](wizards.md).</span><span class="sxs-lookup"><span data-stu-id="f769d-136">For more information, see [Creating Wizards](wizards.md).</span></span>

<span data-ttu-id="f769d-137">Chaque page d’une feuille de propriétés est une boîte de dialogue non modale définie par l’application qui gère les fenêtres de contrôle utilisées pour afficher et modifier les propriétés d’un élément.</span><span class="sxs-lookup"><span data-stu-id="f769d-137">Each page in a property sheet is an application-defined modeless dialog box that manages the control windows used to view and edit the properties of an item.</span></span> <span data-ttu-id="f769d-138">Vous fournissez le modèle de boîte de dialogue utilisé pour créer chaque page, ainsi que la procédure de boîte de dialogue qui gère les contrôles et définit les propriétés de l’élément correspondant.</span><span class="sxs-lookup"><span data-stu-id="f769d-138">You provide the dialog box template used to create each page as well as the dialog box procedure that manages the controls and sets the properties of the corresponding item.</span></span>

<span data-ttu-id="f769d-139">Une feuille de propriétés envoie des codes de notification à la procédure de boîte de dialogue pour une page lorsque la page obtient ou perd l’activation et lorsque l’utilisateur clique sur le bouton **OK**, **Annuler**, **appliquer** ou **aide** .</span><span class="sxs-lookup"><span data-stu-id="f769d-139">A property sheet sends notification codes to the dialog box procedure for a page when the page is gaining or losing the activation and when the user clicks the **OK**, **Cancel**, **Apply**, or **Help** button.</span></span> <span data-ttu-id="f769d-140">Les notifications sont envoyées sous la forme de messages de [**\_ notification WM**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="f769d-140">The notifications are sent in the form of [**WM\_NOTIFY**](wm-notify.md) messages.</span></span> <span data-ttu-id="f769d-141">Le paramètre *lParam* est l’adresse d’une structure [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) qui comprend le handle de fenêtre dans la boîte de dialogue feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-141">The *lParam* parameter is the address of an [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) structure that includes the window handle to the property sheet dialog box.</span></span>

<span data-ttu-id="f769d-142">Certains codes de notification requièrent qu’une page retourne la **valeur true** ou **false** en réponse au message [**WM \_ Notify**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="f769d-142">Some notification codes require a page to return either **TRUE** or **FALSE** in response to the [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <span data-ttu-id="f769d-143">Pour ce faire, la page doit utiliser la fonction [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) pour affecter la valeur **true** ou **false** à la valeur **\_ MSGRESULT** de la boîte de dialogue de la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-143">To do this, the page must use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to set the **DWL\_MSGRESULT** value for the page dialog box to either **TRUE** or **FALSE**.</span></span>

## <a name="pages"></a><span data-ttu-id="f769d-144">Pages</span><span class="sxs-lookup"><span data-stu-id="f769d-144">Pages</span></span>

<span data-ttu-id="f769d-145">Une feuille de propriétés doit contenir au moins une page, mais elle ne peut pas contenir plus de valeurs que la valeur de **MAXPROPPAGES** , comme défini dans les fichiers d’en-tête Windows.</span><span class="sxs-lookup"><span data-stu-id="f769d-145">A property sheet must contain at least one page, but it cannot contain more than the value of **MAXPROPPAGES** as defined in the Windows header files.</span></span> <span data-ttu-id="f769d-146">Chaque page a un index de base zéro que la feuille de propriétés attribue en fonction de l’ordre dans lequel la page est ajoutée à la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-146">Each page has a zero-based index that the property sheet assigns according to the order in which the page is added to the property sheet.</span></span> <span data-ttu-id="f769d-147">Les index sont utilisés dans les messages que vous envoyez à la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-147">The indexes are used in messages that you send to the property sheet.</span></span>

<span data-ttu-id="f769d-148">Une page de propriétés peut contenir une boîte de dialogue imbriquée.</span><span class="sxs-lookup"><span data-stu-id="f769d-148">A property page can contain a nested dialog box.</span></span> <span data-ttu-id="f769d-149">Si c’est le cas, vous devez inclure le style [**WS \_ ex \_ CONTROLPARENT**](/windows/desktop/winmsg/extended-window-styles) pour la boîte de dialogue de niveau supérieur et appeler la fonction [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) avec le descripteur de la boîte de dialogue parente.</span><span class="sxs-lookup"><span data-stu-id="f769d-149">If it does, you must include the [**WS\_EX\_CONTROLPARENT**](/windows/desktop/winmsg/extended-window-styles) style for the top-level dialog box and call the [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) function with the handle to the parent dialog box.</span></span> <span data-ttu-id="f769d-150">Cela permet de s’assurer que l’utilisateur peut utiliser des mnémoniques et les touches de navigation de la boîte de dialogue pour déplacer le focus sur les contrôles de la boîte de dialogue imbriquée.</span><span class="sxs-lookup"><span data-stu-id="f769d-150">This ensures that the user can use mnemonics and the dialog box navigation keys to move the focus to controls in the nested dialog box.</span></span>

<span data-ttu-id="f769d-151">Chaque page comporte une icône et une étiquette correspondantes.</span><span class="sxs-lookup"><span data-stu-id="f769d-151">Each page has a corresponding icon and label.</span></span> <span data-ttu-id="f769d-152">La feuille de propriétés crée un onglet pour chaque page et affiche l’icône et l’étiquette dans l’onglet. Toutes les pages de feuille de propriétés sont censées utiliser une police qui n’est pas en gras.</span><span class="sxs-lookup"><span data-stu-id="f769d-152">The property sheet creates a tab for each page and displays the icon and label in the tab. All property sheet pages are expected to use a nonbold font.</span></span> <span data-ttu-id="f769d-153">Pour vous assurer que la police n’est pas en gras, spécifiez le style **DS \_ 3DLOOK** dans le modèle de boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f769d-153">To ensure that the font is not bold, specify the **DS\_3DLOOK** style in the dialog box template.</span></span>

<span data-ttu-id="f769d-154">La procédure de boîte de dialogue pour une page ne doit pas appeler la fonction [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) .</span><span class="sxs-lookup"><span data-stu-id="f769d-154">The dialog box procedure for a page must not call the [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) function.</span></span> <span data-ttu-id="f769d-155">Cela entraînera la suppression de la feuille de propriétés entière, pas seulement de la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-155">Doing so will destroy the entire property sheet, not just the page.</span></span>

<span data-ttu-id="f769d-156">La taille minimale d’une page de feuille de propriétés est 212 unités de boîte de dialogue horizontalement et 114 unités de boîte de dialogue verticalement.</span><span class="sxs-lookup"><span data-stu-id="f769d-156">The minimum size for a property sheet page is 212 dialog units horizontally and 114 dialog units vertically.</span></span> <span data-ttu-id="f769d-157">Si une boîte de dialogue de page est plus petite, la page est agrandie jusqu’à ce qu’elle atteigne la taille minimale.</span><span class="sxs-lookup"><span data-stu-id="f769d-157">If a page dialog is smaller than this, the page will be enlarged until it meets the minimum size.</span></span> <span data-ttu-id="f769d-158">Le fichier d’en-tête Prsht. h contient trois ensembles de tailles recommandées pour les pages de feuille de propriétés, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="f769d-158">The Prsht.h header file contains three sets of recommended sizes for property sheet pages, as shown in the following table.</span></span>

|  <span data-ttu-id="f769d-159">Taille</span><span class="sxs-lookup"><span data-stu-id="f769d-159">Size</span></span>                |   <span data-ttu-id="f769d-160">Description</span><span class="sxs-lookup"><span data-stu-id="f769d-160">Description</span></span>                                                   |
|----------------------|-----------------------------------------------------------------|
| <span data-ttu-id="f769d-161">**PROP \_ SM \_ CXDLG**</span><span class="sxs-lookup"><span data-stu-id="f769d-161">**PROP\_SM\_CXDLG**</span></span>  | <span data-ttu-id="f769d-162">Largeur, en unités de boîte de dialogue, d’une petite page de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-162">Width, in dialog units, of a small property sheet page.</span></span>         |
| <span data-ttu-id="f769d-163">**PROP \_ SM \_ CYDLG**</span><span class="sxs-lookup"><span data-stu-id="f769d-163">**PROP\_SM\_CYDLG**</span></span>  | <span data-ttu-id="f769d-164">Hauteur, en unités de boîte de dialogue, d’une petite page de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-164">Height, in dialog units, of a small property sheet page.</span></span>        |
| <span data-ttu-id="f769d-165">**PROP \_ med \_ CXDLG**</span><span class="sxs-lookup"><span data-stu-id="f769d-165">**PROP\_MED\_CXDLG**</span></span> | <span data-ttu-id="f769d-166">Largeur, en unités de boîte de dialogue, d’une page de feuille de propriétés de taille moyenne.</span><span class="sxs-lookup"><span data-stu-id="f769d-166">Width, in dialog units, of a medium-sized property sheet page.</span></span>  |
| <span data-ttu-id="f769d-167">**PROP \_ med \_ CYDLG**</span><span class="sxs-lookup"><span data-stu-id="f769d-167">**PROP\_MED\_CYDLG**</span></span> | <span data-ttu-id="f769d-168">Hauteur, en unités de boîte de dialogue, d’une page de feuille de propriétés de taille moyenne.</span><span class="sxs-lookup"><span data-stu-id="f769d-168">Height, in dialog units, of a medium-sized property sheet page.</span></span> |
| <span data-ttu-id="f769d-169">**PROP \_ LG \_ CXDLG**</span><span class="sxs-lookup"><span data-stu-id="f769d-169">**PROP\_LG\_CXDLG**</span></span>  | <span data-ttu-id="f769d-170">Largeur, en unités de boîte de dialogue, d’une grande page de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-170">Width, in dialog units, of a large property sheet page.</span></span>         |
| <span data-ttu-id="f769d-171">**PROP \_ LG \_ CYDLG**</span><span class="sxs-lookup"><span data-stu-id="f769d-171">**PROP\_LG\_CYDLG**</span></span>  | <span data-ttu-id="f769d-172">Hauteur, en unités de boîte de dialogue, d’une grande page de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-172">Height, in dialog units, of a large property sheet page.</span></span>        |

<span data-ttu-id="f769d-173">L’utilisation de ces tailles recommandées permet de garantir la cohérence visuelle entre votre application et d’autres applications Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="f769d-173">Using these recommended sizes will help ensure visual consistency between your application and other Microsoft Windows applications.</span></span>

<span data-ttu-id="f769d-174">Dans l’éditeur de ressources Microsoft Visual Studio, vous pouvez créer une page de la taille appropriée dans la boîte de dialogue **Ajouter une ressource** .</span><span class="sxs-lookup"><span data-stu-id="f769d-174">In the Microsoft Visual Studio resource editor, you can create a page of the appropriate size in the **Add Resource** dialog box.</span></span> <span data-ttu-id="f769d-175">Développez le nœud de la boîte de dialogue et sélectionnez **IDD \_ PropPage \_ large**, **IDD \_ PropPage \_ Medium** ou **IDD \_ PropPage \_ Small**.</span><span class="sxs-lookup"><span data-stu-id="f769d-175">Expand the Dialog node and select **IDD\_PROPPAGE\_LARGE**, **IDD\_PROPPAGE\_MEDIUM**, or **IDD\_PROPPAGE\_SMALL**.</span></span>

<span data-ttu-id="f769d-176">La feuille de propriétés est automatiquement dimensionnée pour s’adapter à la plus grande page.</span><span class="sxs-lookup"><span data-stu-id="f769d-176">The property sheet is automatically sized to accommodate the largest page.</span></span>

## <a name="property-sheet-creation"></a><span data-ttu-id="f769d-177">Création de la feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-177">Property Sheet Creation</span></span>

<span data-ttu-id="f769d-178">Avant de créer une feuille de propriétés, vous devez définir une ou plusieurs pages.</span><span class="sxs-lookup"><span data-stu-id="f769d-178">Before creating a property sheet, you must define one or more pages.</span></span> <span data-ttu-id="f769d-179">Cela implique de remplir une structure [**PROPSHEETPAGE**](pss-propsheetpage.md) avec des informations sur la page (icône, étiquette, modèle de boîte de dialogue, procédure de boîte de dialogue, etc.), puis en spécifiant l’adresse de la structure dans un appel à la fonction [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) .</span><span class="sxs-lookup"><span data-stu-id="f769d-179">This involves filling a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure with information about the page—its icon, label, dialog box template, dialog box procedure, and so on—and then specifying the address of the structure in a call to the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function.</span></span> <span data-ttu-id="f769d-180">La fonction retourne un handle vers le type HPROPSHEETPAGE qui identifie de façon unique la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-180">The function returns a handle to the HPROPSHEETPAGE type that uniquely identifies the page.</span></span>

<span data-ttu-id="f769d-181">Pour créer une feuille de propriétés, vous spécifiez l’adresse d’une structure [**PROPSHEETHEADER**](pss-propsheetheader.md) dans un appel à la fonction [**feuille**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="f769d-181">To create a property sheet, you specify the address of a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure in a call to the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function.</span></span> <span data-ttu-id="f769d-182">La structure définit l’icône et le titre de la feuille de propriétés et comprend également l’adresse d’un tableau de handles HPROPSHEETPAGE que vous obtenez à l’aide de [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea).</span><span class="sxs-lookup"><span data-stu-id="f769d-182">The structure defines the icon and title for the property sheet and also includes the address of an array of HPROPSHEETPAGE handles that you obtain by using [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea).</span></span> <span data-ttu-id="f769d-183">Quand **feuille** crée la feuille de propriétés, il comprend les pages identifiées dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="f769d-183">When **PropertySheet** creates the property sheet, it includes the pages identified in the array.</span></span> <span data-ttu-id="f769d-184">Les pages s’affichent dans la feuille de propriétés dans l’ordre dans lequel elles sont contenues dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="f769d-184">The pages appear in the property sheet in the same order that they are contained in the array.</span></span>

<span data-ttu-id="f769d-185">Une autre façon d’assigner des pages à une feuille de propriétés consiste à spécifier un tableau de structures [**PROPSHEETPAGE**](pss-propsheetpage.md) au lieu d’un tableau de handles **HPROPSHEETPAGE** .</span><span class="sxs-lookup"><span data-stu-id="f769d-185">Another way to assign pages to a property sheet is to specify an array of [**PROPSHEETPAGE**](pss-propsheetpage.md) structures instead of an array of **HPROPSHEETPAGE** handles.</span></span> <span data-ttu-id="f769d-186">Dans ce cas, [**feuille**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) crée des handles pour les pages avant de les ajouter à la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-186">In this case, [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) creates handles for the pages before adding them to the property sheet.</span></span>

<span data-ttu-id="f769d-187">Lorsqu’une page est créée, sa procédure de boîte de dialogue reçoit un message [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="f769d-187">When a page is created, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="f769d-188">Le paramètre *lParam* du message est un pointeur vers une copie de la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) qui est définie lors de la création de la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-188">The message's *lParam* parameter is a pointer to a copy of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that is defined when the page is created.</span></span> <span data-ttu-id="f769d-189">En particulier, quand une page est créée, le membre **lParam** de la structure peut être utilisé pour passer des informations définies par l’application à la procédure de boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f769d-189">In particular, when a page is created, the structure's **lParam** member can be used to pass application-defined information to the dialog box procedure.</span></span> <span data-ttu-id="f769d-190">À l’exception du membre **lParam** , cette structure doit être traitée en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="f769d-190">With the exception of the **lParam** member, this structure must be treated as read-only.</span></span> <span data-ttu-id="f769d-191">Toute modification autre que **lParam** aura des conséquences imprévisibles.</span><span class="sxs-lookup"><span data-stu-id="f769d-191">Modifying anything other than **lParam** will have unpredictable consequences.</span></span>

<span data-ttu-id="f769d-192">Lorsque le système passe par la suite une copie de la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) de la page à votre application, il utilise le même pointeur.</span><span class="sxs-lookup"><span data-stu-id="f769d-192">When the system subsequently passes a copy of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure to your application, it uses the same pointer.</span></span> <span data-ttu-id="f769d-193">Toutes les modifications apportées à la structure seront transmises.</span><span class="sxs-lookup"><span data-stu-id="f769d-193">Any changes to the structure will be passed along.</span></span> <span data-ttu-id="f769d-194">Étant donné que le membre **lParam** est ignoré par le système, il peut être modifié pour envoyer des informations à d’autres parties de votre application.</span><span class="sxs-lookup"><span data-stu-id="f769d-194">Because the **lParam** member is ignored by the system, it can be modified to send information to other parts of your application.</span></span> <span data-ttu-id="f769d-195">Vous pouvez, par exemple, utiliser **lParam** pour transmettre des informations à la fonction de rappel [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) de la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-195">You can, for instance, use **lParam** to pass information to the page's [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) callback function.</span></span>

<span data-ttu-id="f769d-196">[**Feuille**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) définit automatiquement la taille et la position initiale d’une feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-196">[**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) automatically sets the size and initial position of a property sheet.</span></span> <span data-ttu-id="f769d-197">La position est basée sur la position de la fenêtre propriétaire, et la taille est basée sur la plus grande page spécifiée dans le tableau de pages lors de la création de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-197">The position is based on the position of the owner window, and the size is based on the largest page specified in the array of pages when the property sheet was created.</span></span> <span data-ttu-id="f769d-198">Si vous souhaitez que les pages correspondent à la largeur des quatre boutons au bas de la feuille de propriétés, définissez la largeur de la page la plus large sur 190 unités de boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f769d-198">If you want the pages to match the width of the four buttons at the bottom of the property sheet, set the width of the widest page to 190 dialog units.</span></span>

<span data-ttu-id="f769d-199">La taille d’une feuille de propriétés est calculée à partir des propriétés *Width* et *Height* du modèle de boîte de dialogue dans le fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="f769d-199">The size of a property sheet is computed from the *width* and *height* properties of the dialog template in the resource file.</span></span> <span data-ttu-id="f769d-200">Pour plus d’informations, consultez ressource de [**boîte de dialogue**](/windows/desktop/menurc/dialog-resource) ou [**ressource DIALOGEX**](/windows/desktop/menurc/dialogex-resource) .</span><span class="sxs-lookup"><span data-stu-id="f769d-200">See [**DIALOG Resource**](/windows/desktop/menurc/dialog-resource) or [**DIALOGEX Resource**](/windows/desktop/menurc/dialogex-resource) for further details.</span></span> <span data-ttu-id="f769d-201">Notez, toutefois, que pour des raisons de compatibilité, les dimensions sont calculées par rapport à la police MS Shell Dlg et non à la police utilisée par la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-201">Note, however, that for compatibility reasons, the dimensions are computed relative to the MS Shell Dlg font rather than the font used by the page.</span></span> <span data-ttu-id="f769d-202">Si vous concevez une page qui utilise une autre police, vous pouvez utiliser l’une des suggestions suivantes.</span><span class="sxs-lookup"><span data-stu-id="f769d-202">If you design a page that uses another font, one of the following suggestions can be used.</span></span>

-   <span data-ttu-id="f769d-203">Ajustez les dimensions du modèle de boîte de dialogue pour compenser la différence de taille entre la police MS Shell Dlg et la police réellement utilisée par la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-203">Adjust the dimensions of the dialog template to compensate for the difference in size between the MS Shell Dlg font and the font the page actually uses.</span></span> <span data-ttu-id="f769d-204">Par exemple, si vous choisissez une police qui est deux fois plus large que MS Shell Dlg, définissez la propriété Width du modèle de boîte de dialogue sur deux fois l’utilisation normale.</span><span class="sxs-lookup"><span data-stu-id="f769d-204">For example, if you choose a font that is twice as wide as MS Shell Dlg, then set the dialog template's width property to twice the normal use.</span></span>
-   <span data-ttu-id="f769d-205">Utilisez un modèle [**DIALOGEX**](/windows/desktop/menurc/dialogex-resource) et définissez le style de boîte de dialogue **\_ SHELLFONT DS** .</span><span class="sxs-lookup"><span data-stu-id="f769d-205">Use a [**DIALOGEX**](/windows/desktop/menurc/dialogex-resource) template and set the **DS\_SHELLFONT** dialog style.</span></span> <span data-ttu-id="f769d-206">Dans ce cas, le gestionnaire de feuille de propriétés interprète les dimensions du modèle de boîte de dialogue par rapport à la police utilisée par le modèle de boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f769d-206">In that case, the property sheet manager interprets the dialog template dimensions relative to the font used by the dialog template.</span></span>

## <a name="adding-and-removing-pages"></a><span data-ttu-id="f769d-207">Ajout et suppression de pages</span><span class="sxs-lookup"><span data-stu-id="f769d-207">Adding and Removing Pages</span></span>

<span data-ttu-id="f769d-208">Après la création d’une feuille de propriétés, une application peut ajouter une page à la fin de l’ensemble de pages existant en envoyant un message de la [**\_ ADDPAGE PSM**](psm-addpage.md) .</span><span class="sxs-lookup"><span data-stu-id="f769d-208">After creating a property sheet, an application can add a page to the end of the existing set of pages by sending a [**PSM\_ADDPAGE**](psm-addpage.md) message.</span></span> <span data-ttu-id="f769d-209">Pour insérer une page entre des pages existantes, envoyez un message [**PropSheet \_ InsertPage**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) .</span><span class="sxs-lookup"><span data-stu-id="f769d-209">To insert a page between existing pages, send a [**PropSheet\_InsertPage**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) message.</span></span> <span data-ttu-id="f769d-210">Notez que la taille de la feuille de propriétés ne peut pas être modifiée une fois qu’elle a été créée.</span><span class="sxs-lookup"><span data-stu-id="f769d-210">Note that the size of the property sheet cannot change after it has been created.</span></span> <span data-ttu-id="f769d-211">Les pages ajoutées ou insérées ne doivent pas être supérieures à la plus grande page actuellement dans la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-211">Any added or inserted pages must be no larger than the largest page currently in the property sheet.</span></span> <span data-ttu-id="f769d-212">Pour supprimer une page, envoyez un message [**PSM \_ REMOVEPAGE**](psm-removepage.md) .</span><span class="sxs-lookup"><span data-stu-id="f769d-212">To remove a page, send a [**PSM\_REMOVEPAGE**](psm-removepage.md) message.</span></span>

<span data-ttu-id="f769d-213">Lorsque vous définissez une page, vous pouvez spécifier l’adresse d’une fonction de rappel [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) que la feuille de propriétés appelle lors de la création ou de la suppression de la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-213">When you define a page, you can specify the address of a [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) callback function that the property sheet calls when it is creating or removing the page.</span></span> <span data-ttu-id="f769d-214">L’utilisation de *PropSheetPageProc* vous donne la possibilité d’effectuer des opérations d’initialisation et de nettoyage pour des pages individuelles.</span><span class="sxs-lookup"><span data-stu-id="f769d-214">Using *PropSheetPageProc* gives you an opportunity to perform initialization and cleanup operations for individual pages.</span></span>

> [!NOTE]  
> <span data-ttu-id="f769d-215">Un certain nombre de messages et un appel de fonction se produisent pendant que la feuille de propriétés manipule la liste de pages.</span><span class="sxs-lookup"><span data-stu-id="f769d-215">A number of messages and one function call occur while the property sheet is manipulating the list of pages.</span></span> <span data-ttu-id="f769d-216">Pendant cette action, toute tentative de modification de la liste de pages aura des résultats imprévisibles.</span><span class="sxs-lookup"><span data-stu-id="f769d-216">While this action is taking place, attempting to modify the list of pages will have unpredictable results.</span></span> <span data-ttu-id="f769d-217">N’ajoutez pas, n’insérez pas ou ne supprimez pas de pages dans votre implémentation de [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka), ou lors de la gestion des notifications et des messages Windows suivants.</span><span class="sxs-lookup"><span data-stu-id="f769d-217">Do not add, insert, or remove pages in your implementation of [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka), or while handling the following notifications and Windows messages.</span></span>
>
> -   [<span data-ttu-id="f769d-218">PSN \_ appliquer</span><span class="sxs-lookup"><span data-stu-id="f769d-218">PSN\_APPLY</span></span>](psn-apply.md)
> -   [<span data-ttu-id="f769d-219">PSN \_ KILLACTIVE</span><span class="sxs-lookup"><span data-stu-id="f769d-219">PSN\_KILLACTIVE</span></span>](psn-killactive.md)
> -   [<span data-ttu-id="f769d-220">\_réinitialisation PSN</span><span class="sxs-lookup"><span data-stu-id="f769d-220">PSN\_RESET</span></span>](psn-reset.md)
> -   [<span data-ttu-id="f769d-221">PSN \_</span><span class="sxs-lookup"><span data-stu-id="f769d-221">PSN\_SETACTIVE</span></span>](psn-setactive.md)
> -   [<span data-ttu-id="f769d-222">PSN \_ WIZBACK</span><span class="sxs-lookup"><span data-stu-id="f769d-222">PSN\_WIZBACK</span></span>](psn-wizback.md)
> -   [<span data-ttu-id="f769d-223">PSN \_ WIZNEXT</span><span class="sxs-lookup"><span data-stu-id="f769d-223">PSN\_WIZNEXT</span></span>](psn-wiznext.md)
> -   [<span data-ttu-id="f769d-224">**\_INITDIALOG WM**</span><span class="sxs-lookup"><span data-stu-id="f769d-224">**WM\_INITDIALOG**</span></span>](/windows/desktop/dlgbox/wm-initdialog)
> -   [<span data-ttu-id="f769d-225">**\_destructeur WM**</span><span class="sxs-lookup"><span data-stu-id="f769d-225">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)

<span data-ttu-id="f769d-226">Si vous avez besoin de modifier une page de feuille de propriétés alors que vous gérez l’un de ces messages ou que [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) est en cours d’exécution, publiez un message Windows privé.</span><span class="sxs-lookup"><span data-stu-id="f769d-226">If the need arises to modify a property sheet page while you are handling one of these messages or while [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) is in operation, post a private Windows message.</span></span> <span data-ttu-id="f769d-227">Votre application ne recevra pas ce message avant que le gestionnaire de feuille de propriétés ait terminé ses tâches. à ce stade, il est possible de modifier la liste des pages en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="f769d-227">Your application will not receive that message until after the property sheet manager has finished its tasks, at which point it will be safe to modify the list of pages.</span></span>

<span data-ttu-id="f769d-228">Lorsqu’une feuille de propriétés est détruite, elle détruit automatiquement toutes les pages qui y ont été ajoutées.</span><span class="sxs-lookup"><span data-stu-id="f769d-228">When a property sheet is destroyed, it automatically destroys all of the pages that have been added to it.</span></span> <span data-ttu-id="f769d-229">Les pages sont détruites dans l’ordre inverse de celles spécifiées dans le tableau utilisé pour créer les pages.</span><span class="sxs-lookup"><span data-stu-id="f769d-229">The pages are destroyed in reverse order from that specified in the array used to create the pages.</span></span> <span data-ttu-id="f769d-230">Pour détruire une page qui a été créée par la fonction [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) mais qui n’a pas été ajoutée à la feuille de propriétés, utilisez la fonction [**DestroyPropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) .</span><span class="sxs-lookup"><span data-stu-id="f769d-230">To destroy a page that was created by the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function but was not added to the property sheet, use the [**DestroyPropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) function.</span></span>

## <a name="property-sheet-title-and-page-labels"></a><span data-ttu-id="f769d-231">Titre et étiquettes de page de la feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="f769d-231">Property Sheet Title and Page Labels</span></span>

<span data-ttu-id="f769d-232">Vous spécifiez le titre d’une feuille de propriétés dans la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) utilisée pour créer la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-232">You specify the title of a property sheet in the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure used to create the property sheet.</span></span> <span data-ttu-id="f769d-233">Si le membre **dwFlags** inclut la valeur **PSH \_ PROPTITLE** , la feuille de propriétés ajoute le suffixe "Properties" ou le préfixe "Properties for", en fonction de la version.</span><span class="sxs-lookup"><span data-stu-id="f769d-233">If the **dwFlags** member includes the **PSH\_PROPTITLE** value, the property sheet adds the suffix "Properties" or the prefix "Properties for", depending on the version.</span></span> <span data-ttu-id="f769d-234">Vous pouvez modifier le titre après la création d’une feuille de propriétés à l’aide du message [**PSM \_ SETTITLE**](psm-settitle.md) .</span><span class="sxs-lookup"><span data-stu-id="f769d-234">You can change the title after a property sheet is created by using the [**PSM\_SETTITLE**](psm-settitle.md) message.</span></span> <span data-ttu-id="f769d-235">Dans un Assistant Aero, ce message peut être utilisé pour modifier le titre d’une page intérieure de manière dynamique.</span><span class="sxs-lookup"><span data-stu-id="f769d-235">In an Aero Wizard, this message can be used to change the title of an interior page dynamically.</span></span>

<span data-ttu-id="f769d-236">Par défaut, une feuille de propriétés utilise la chaîne de nom spécifiée dans le modèle de boîte de dialogue en tant qu’étiquette d’une page.</span><span class="sxs-lookup"><span data-stu-id="f769d-236">By default, a property sheet uses the name string specified in the dialog box template as the label for a page.</span></span> <span data-ttu-id="f769d-237">Vous pouvez remplacer la chaîne de nom en incluant la valeur **PSP \_ USETITLE** dans le membre **DwFlags** de la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) qui définit la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-237">You can override the name string by including the **PSP\_USETITLE** value in the **dwFlags** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that defines the page.</span></span> <span data-ttu-id="f769d-238">Quand **PSP \_ USETITLE** est spécifié, le membre **pszTitle** doit contenir l’adresse de la chaîne d’étiquette pour la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-238">When **PSP\_USETITLE** is specified, the **pszTitle** member must contain the address of the label string for the page.</span></span>

## <a name="page-activation"></a><span data-ttu-id="f769d-239">Activation de page</span><span class="sxs-lookup"><span data-stu-id="f769d-239">Page Activation</span></span>

<span data-ttu-id="f769d-240">Une feuille de propriétés ne peut avoir qu’une seule page active à la fois.</span><span class="sxs-lookup"><span data-stu-id="f769d-240">A property sheet can have only one active page at a time.</span></span> <span data-ttu-id="f769d-241">La page qui a l’activation est au premier plan de la pile de pages qui se chevauche.</span><span class="sxs-lookup"><span data-stu-id="f769d-241">The page that has the activation is at the foreground of the overlapping stack of pages.</span></span> <span data-ttu-id="f769d-242">L’utilisateur active une page en sélectionnant son onglet. une application active une page à l’aide du message [**PSM \_ SETCURSEL**](psm-setcursel.md) .</span><span class="sxs-lookup"><span data-stu-id="f769d-242">The user activates a page by selecting its tab; an application activates a page by using the [**PSM\_SETCURSEL**](psm-setcursel.md) message.</span></span>

<span data-ttu-id="f769d-243">La feuille de propriétés envoie le code de notification [PSN \_ KILLACTIVE](psn-killactive.md) à la page qui va perdre l’activation.</span><span class="sxs-lookup"><span data-stu-id="f769d-243">The property sheet sends the [PSN\_KILLACTIVE](psn-killactive.md) notification code to the page that is about to lose the activation.</span></span> <span data-ttu-id="f769d-244">En réponse, la page doit valider toutes les modifications apportées par l’utilisateur à la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-244">In response, the page must validate any changes that the user has made to the page.</span></span> <span data-ttu-id="f769d-245">Si la page requiert une entrée d’utilisateur supplémentaire avant de perdre l’activation, utilisez la fonction [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) pour définir la valeur de la **\_ MSGRESULT au DWL** de la page sur **true**.</span><span class="sxs-lookup"><span data-stu-id="f769d-245">If the page requires additional user input before losing the activation, use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to set the **DWL\_MSGRESULT** value of the page to **TRUE**.</span></span> <span data-ttu-id="f769d-246">En outre, la page doit afficher une boîte de message qui décrit le problème et fournit l’action recommandée.</span><span class="sxs-lookup"><span data-stu-id="f769d-246">Also, the page must display a message box that describes the problem and provides the recommended action.</span></span> <span data-ttu-id="f769d-247">Affectez la valeur **false** à **DWL \_ MSGRESULT** lorsqu’il est possible de perdre l’activation.</span><span class="sxs-lookup"><span data-stu-id="f769d-247">Set **DWL\_MSGRESULT** to **FALSE** when it is okay to lose the activation.</span></span>

<span data-ttu-id="f769d-248">Avant que la page qui obtient l’activation ne soit visible, la feuille de propriétés envoie le code de notification [ \_ SetActive PSN](psn-setactive.md) à la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-248">Before the page that is gaining the activation is visible, the property sheet sends the [PSN\_SETACTIVE](psn-setactive.md) notification code to the page.</span></span> <span data-ttu-id="f769d-249">La page doit répondre en initialisant ses fenêtres de contrôle.</span><span class="sxs-lookup"><span data-stu-id="f769d-249">The page must respond by initializing its control windows.</span></span>

## <a name="help-button"></a><span data-ttu-id="f769d-250">Bouton aide</span><span class="sxs-lookup"><span data-stu-id="f769d-250">Help Button</span></span>

<span data-ttu-id="f769d-251">Les feuilles de propriétés peuvent afficher deux boutons d’aide : un bouton d’aide de feuille de propriétés qui s’affiche en bas du cadre, à côté des boutons **OK** / **Annuler** l' / **application** et un bouton de barre de légende standard qui fournit de l’aide contextuelle.</span><span class="sxs-lookup"><span data-stu-id="f769d-251">Property sheets can display two Help buttons: a property sheet Help button that is displayed at the bottom of the frame, next to the **OK**/**Cancel**/**Apply** buttons, and a standard caption bar button that provides context-sensitive Help.</span></span>

<span data-ttu-id="f769d-252">Le bouton aide de la feuille de propriétés est facultatif et peut être activé sur une page par page.</span><span class="sxs-lookup"><span data-stu-id="f769d-252">The property sheet Help button is optional, and can be enabled on a page by page basis.</span></span> <span data-ttu-id="f769d-253">Pour afficher le bouton d’aide de la feuille de propriétés pour une ou plusieurs pages :</span><span class="sxs-lookup"><span data-stu-id="f769d-253">To display the property sheet Help button for one or more pages:</span></span>

-   <span data-ttu-id="f769d-254">Définissez l' **indicateur \_ HasHelp PSH** dans le membre **DwFlags** de la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-254">Set the **PSH\_HASHELP** flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span>
-   <span data-ttu-id="f769d-255">Pour chaque page qui affiche un bouton aide, définissez l’indicateur **de \_ HasHelp HasHelp** dans le membre **DwFlags** de la structure [**PROPSHEETPAGE**](pss-propsheetpage.md) de la page.</span><span class="sxs-lookup"><span data-stu-id="f769d-255">For each page that will display a Help button, set the **PSP\_HASHELP** flag in the **dwFlags** member of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span>

<span data-ttu-id="f769d-256">Quand l’utilisateur clique sur le bouton aide, la page active reçoit un code de notification [ \_ d’aide PSN](psn-help.md) .</span><span class="sxs-lookup"><span data-stu-id="f769d-256">When the user clicks the Help button, the active page receives a [PSN\_HELP](psn-help.md) notification code.</span></span> <span data-ttu-id="f769d-257">La page doit répondre en affichant des informations d’aide, généralement en appelant la fonction [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="f769d-257">The page must respond by displaying Help information, typically by calling the [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) function.</span></span>

### <a name="removing-the-caption-bar-help-button"></a><span data-ttu-id="f769d-258">Suppression du bouton d’aide barre de légende</span><span class="sxs-lookup"><span data-stu-id="f769d-258">Removing the Caption Bar Help Button</span></span>

<span data-ttu-id="f769d-259">Le bouton aide de la barre de légende s’affiche par défaut, afin que l’aide contextuelle soit toujours disponible pour les boutons OK/Annuler/appliquer.</span><span class="sxs-lookup"><span data-stu-id="f769d-259">The caption bar Help button is displayed by default, so that context-sensitive Help is always available for the OK/Cancel/Apply buttons.</span></span> <span data-ttu-id="f769d-260">Toutefois, ce bouton peut être supprimé, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="f769d-260">However, this button can be removed, if necessary.</span></span> <span data-ttu-id="f769d-261">Pour supprimer le bouton d’aide de la barre de légende d’une feuille de propriétés :</span><span class="sxs-lookup"><span data-stu-id="f769d-261">To remove a property sheet's caption bar Help button:</span></span>

-   <span data-ttu-id="f769d-262">Pour les versions des contrôles communs antérieures à la [version 5,80](common-control-versions.md), vous devez implémenter une fonction de rappel de la [**feuille de propriétés**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).</span><span class="sxs-lookup"><span data-stu-id="f769d-262">For versions of the common controls prior to [version 5.80](common-control-versions.md), you must implement a [**property sheet callback function**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).</span></span>
-   <span data-ttu-id="f769d-263">Pour la [version 5,80](common-control-versions.md) et les versions ultérieures des contrôles communs, vous pouvez simplement définir l' \_ indicateur PSH NOCONTEXTHELP dans le membre **DwFlags** de la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-263">For [version 5.80](common-control-versions.md) and later of the common controls, you can simply set the PSH\_NOCONTEXTHELP flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="f769d-264">Toutefois, si vous avez besoin d’une compatibilité descendante avec les versions de contrôle courantes antérieures, vous devez implémenter la fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="f769d-264">However, if you need backward compatibility with earlier common control versions, you must implement the callback function.</span></span>

<span data-ttu-id="f769d-265">Pour implémenter une fonction de rappel de feuille de propriétés qui supprime le bouton d’aide barre de légende :</span><span class="sxs-lookup"><span data-stu-id="f769d-265">To implement a property sheet callback function that removes the caption bar Help button:</span></span>

-   <span data-ttu-id="f769d-266">Définissez l’indicateur **PSH \_ USECALLBACK** dans le membre **DwFlags** de la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-266">Set the **PSH\_USECALLBACK** flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span>
-   <span data-ttu-id="f769d-267">Définissez le membre **pfnCallBack** de la structure [**PROPSHEETHEADER**](pss-propsheetheader.md) pour qu’il pointe vers la fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="f769d-267">Set the **pfnCallBack** member of the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure to point to the callback function.</span></span>
-   <span data-ttu-id="f769d-268">Implémentez la fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="f769d-268">Implement the callback function.</span></span> <span data-ttu-id="f769d-269">Lorsque cette fonction reçoit le message de **\_ précréation PSCB** , elle reçoit également un pointeur vers le modèle de boîte de dialogue de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-269">When this function receives the **PSCB\_PRECREATE** message, it will also receive a pointer to the property sheet's dialog box template.</span></span> <span data-ttu-id="f769d-270">Supprimez le style **DS \_ CONTEXTHELP** de ce modèle.</span><span class="sxs-lookup"><span data-stu-id="f769d-270">Remove the **DS\_CONTEXTHELP** style from this template.</span></span>

<span data-ttu-id="f769d-271">L’exemple suivant montre comment implémenter une telle fonction de rappel :</span><span class="sxs-lookup"><span data-stu-id="f769d-271">The following sample illustrates how to implement such a callback function:</span></span>

```cpp
int CALLBACK RemoveContextHelpProc(HWND hwnd, UINT message, LPARAM lParam)
{
    switch (message) 
    {
    case PSCB_PRECREATE:
        // Remove the DS_CONTEXTHELP style from the
        // dialog box template
        if (((LPDLGTEMPLATEEX)lParam)->signature ==    
           0xFFFF)
           {
            ((LPDLGTEMPLATEEX)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        else {
            ((LPDLGTEMPLATE)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        return TRUE;
    }
    return TRUE;
}
```

<span data-ttu-id="f769d-272">Si la structure [**DLGTEMPLATEEX**](/windows/desktop/dlgbox/dlgtemplateex) n’est pas définie, incluez la déclaration suivante :</span><span class="sxs-lookup"><span data-stu-id="f769d-272">If the [**DLGTEMPLATEEX**](/windows/desktop/dlgbox/dlgtemplateex) structure is not defined, include the following declaration:</span></span>

```cpp
#include <pshpack1.h>

typedef struct DLGTEMPLATEEX
{
    WORD dlgVer;
    WORD signature;
    DWORD helpID;
    DWORD exStyle;
    DWORD style;
    WORD cDlgItems;
    short x;
    short y;
    short cx;
    short cy;
} DLGTEMPLATEEX, *LPDLGTEMPLATEEX;

#include <poppack.h>
```

## <a name="ok-cancel-and-apply-buttons"></a><span data-ttu-id="f769d-273">Boutons OK, annuler et appliquer</span><span class="sxs-lookup"><span data-stu-id="f769d-273">OK, Cancel, and Apply Buttons</span></span>

<span data-ttu-id="f769d-274">Les boutons **OK** et **appliquer** sont similaires. dirigent les pages d’une feuille de propriétés pour valider et appliquer les modifications de propriété apportées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f769d-274">The **OK** and **Apply** buttons are similar; both direct a property sheet's pages to validate and apply the property changes that the user has made.</span></span> <span data-ttu-id="f769d-275">La seule différence est que le fait de cliquer sur le bouton **OK** entraîne la destruction de la feuille de propriétés après l’application des modifications.</span><span class="sxs-lookup"><span data-stu-id="f769d-275">The only difference is that clicking the **OK** button causes the property sheet to be destroyed after the changes are applied.</span></span>

<span data-ttu-id="f769d-276">Quand l’utilisateur clique sur le bouton **OK** ou **appliquer** , la feuille de propriétés envoie une notification [PSN \_ KILLACTIVE](psn-killactive.md) à la page active, ce qui lui donne la possibilité de valider les modifications de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f769d-276">When the user clicks the **OK** or **Apply** button, the property sheet sends a [PSN\_KILLACTIVE](psn-killactive.md) notification to the active page, giving it an opportunity to validate the user's changes.</span></span> <span data-ttu-id="f769d-277">Si les modifications sont valides, la page doit appeler la fonction [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) avec la valeur **DWL \_ MSGRESULT** définie sur **false**.</span><span class="sxs-lookup"><span data-stu-id="f769d-277">If the changes are valid, the page must call the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function with the **DWL\_MSGRESULT** value set to **FALSE**.</span></span> <span data-ttu-id="f769d-278">Si les modifications de l’utilisateur ne sont pas valides, la page doit définir la propriété **DWL \_ MSGRESULT** sur **true** et afficher une boîte de dialogue qui informe l’utilisateur du problème.</span><span class="sxs-lookup"><span data-stu-id="f769d-278">If the user's changes are not valid, the page must set **DWL\_MSGRESULT** to **TRUE** and display a dialog box informing the user of the problem.</span></span> <span data-ttu-id="f769d-279">La page reste active jusqu’à ce qu’elle affecte à **\_ MSGRESULT** la **valeur false** en réponse à un \_ message PSN KILLACTIVE.</span><span class="sxs-lookup"><span data-stu-id="f769d-279">The page remains active until it sets **DWL\_MSGRESULT** to **FALSE** in response to a PSN\_KILLACTIVE message.</span></span>

<span data-ttu-id="f769d-280">Une fois qu’une page répond à une notification [PSN \_ KILLACTIVE](psn-killactive.md) en affectant à la propriété **DWL \_ MSGRESULT** la **valeur false**, la feuille de propriétés envoie une notification d' [ \_ application PSN](psn-apply.md) à chaque page.</span><span class="sxs-lookup"><span data-stu-id="f769d-280">After a page responds to a [PSN\_KILLACTIVE](psn-killactive.md) notification by setting **DWL\_MSGRESULT** to **FALSE**, the property sheet will send a [PSN\_APPLY](psn-apply.md) notification to each page.</span></span> <span data-ttu-id="f769d-281">Quand une page reçoit cette notification, elle doit appliquer les nouvelles propriétés à l’élément correspondant.</span><span class="sxs-lookup"><span data-stu-id="f769d-281">When a page receives this notification, it must apply the new properties to the corresponding item.</span></span> <span data-ttu-id="f769d-282">Pour indiquer à la feuille de propriétés que les modifications sont valides pour la page, appelez [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) avec **DWL \_ MSGRESULT** défini sur **PSNRET \_ NOERROR**.</span><span class="sxs-lookup"><span data-stu-id="f769d-282">To indicate to the property sheet that the changes are valid for the page, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with **DWL\_MSGRESULT** set to **PSNRET\_NOERROR**.</span></span> <span data-ttu-id="f769d-283">Si les modifications ne sont pas valides pour la page, retournez une erreur.</span><span class="sxs-lookup"><span data-stu-id="f769d-283">If the changes are invalid for the page, return an error.</span></span> <span data-ttu-id="f769d-284">Cela empêche la modification de la feuille de propriétés et retourne le focus sur la page qui a reçu la \_ notification d’application PSN ou sur la page qui avait le focus lorsque le bouton **appliquer** était enfoncé.</span><span class="sxs-lookup"><span data-stu-id="f769d-284">Doing so prevents the property sheet from being destroyed and returns focus to either the page that received the PSN\_APPLY notification or the page that had focus when the **Apply** button was pressed.</span></span> <span data-ttu-id="f769d-285">Pour retourner une erreur et indiquer la page qui recevra le focus, définissez la valeur de l' **\_ MSGRESULT** au point de contrôle DWL sur l’une des valeurs suivantes.</span><span class="sxs-lookup"><span data-stu-id="f769d-285">To return an error, and indicate which page will receive focus, set **DWL\_MSGRESULT** to one of the following values.</span></span>

-   <span data-ttu-id="f769d-286">**PSNRET \_ NON valide**.</span><span class="sxs-lookup"><span data-stu-id="f769d-286">**PSNRET\_INVALID**.</span></span> <span data-ttu-id="f769d-287">La feuille de propriétés ne sera pas détruite et le focus sera renvoyé à cette page.</span><span class="sxs-lookup"><span data-stu-id="f769d-287">The property sheet will not be destroyed, and focus will be returned to this page.</span></span>
-   <span data-ttu-id="f769d-288">**PSNRET \_ \_NOCHANGEPAGE non valide**.</span><span class="sxs-lookup"><span data-stu-id="f769d-288">**PSNRET\_INVALID\_NOCHANGEPAGE**.</span></span> <span data-ttu-id="f769d-289">La feuille de propriétés ne sera pas détruite et le focus sera retourné à la page qui avait le focus lorsque le bouton était enfoncé.</span><span class="sxs-lookup"><span data-stu-id="f769d-289">The property sheet will not be destroyed, and focus will be returned to the page that had focus when the button was pressed.</span></span>

<span data-ttu-id="f769d-290">Une application peut utiliser le message d’application [**PSM \_**](psm-apply.md) pour simuler la sélection du bouton **appliquer** .</span><span class="sxs-lookup"><span data-stu-id="f769d-290">An application can use the [**PSM\_APPLY**](psm-apply.md) message to simulate the selection of the **Apply** button.</span></span>

<span data-ttu-id="f769d-291">Le bouton **appliquer** est initialement désactivé lorsqu’une page devient active, ce qui indique qu’il n’y a pas encore de modification de propriété à appliquer.</span><span class="sxs-lookup"><span data-stu-id="f769d-291">The **Apply** button is initially disabled when a page becomes active, indicating that there are not yet any property changes to apply.</span></span> <span data-ttu-id="f769d-292">Lorsque la page reçoit une entrée via l’un de ses contrôles indiquant que l’utilisateur a modifié une propriété, la page doit envoyer le message [**PSM \_ modifié**](psm-changed.md) à la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-292">When the page receives input through one of its controls indicating that the user has edited a property, the page must send the [**PSM\_CHANGED**](psm-changed.md) message to the property sheet.</span></span> <span data-ttu-id="f769d-293">Le message entraîne l’activation du bouton **appliquer** par la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-293">The message causes the property sheet to enable the **Apply** button.</span></span> <span data-ttu-id="f769d-294">Si l’utilisateur clique ensuite sur le bouton **appliquer** ou **Annuler** , la page doit réinitialiser ses contrôles, puis envoyer le message [**PSM non \_ modifié**](psm-unchanged.md) pour désactiver à nouveau le bouton **appliquer** .</span><span class="sxs-lookup"><span data-stu-id="f769d-294">If the user subsequently clicks the **Apply** or **Cancel** button, the page must reinitialize its controls and then send the [**PSM\_UNCHANGED**](psm-unchanged.md) message to again disable the **Apply** button.</span></span>

<span data-ttu-id="f769d-295">Parfois, le bouton **appliquer** entraîne une modification d’une page dans une feuille de propriétés, et la modification ne peut pas être annulée.</span><span class="sxs-lookup"><span data-stu-id="f769d-295">Sometimes the **Apply** button causes a page to make a change to a property sheet, and the change cannot be undone.</span></span> <span data-ttu-id="f769d-296">Dans ce cas, la page doit envoyer le [**message \_ CANCELTOCLOSE PSM**](psm-canceltoclose.md) à la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-296">When this happens, the page must send the [**PSM\_CANCELTOCLOSE**](psm-canceltoclose.md) message to the property sheet.</span></span> <span data-ttu-id="f769d-297">Le message amène la feuille de propriétés à remplacer le texte du bouton **OK** par « Close », ce qui indique que les modifications appliquées ne peuvent pas être annulées.</span><span class="sxs-lookup"><span data-stu-id="f769d-297">The message causes the property sheet to change the text of the **OK** button to "Close," indicating that the applied changes cannot be canceled.</span></span>

<span data-ttu-id="f769d-298">Parfois, une page apporte une modification à la configuration système qui nécessite le redémarrage de Windows ou le système redémarré pour que la modification puisse prendre effet.</span><span class="sxs-lookup"><span data-stu-id="f769d-298">Sometimes a page makes a change to the system configuration that requires Windows to be restarted or the system rebooted before the change can take effect.</span></span> <span data-ttu-id="f769d-299">Une fois cette modification apportée, une page doit envoyer le message [**PSM \_ RESTARTWINDOWS**](psm-restartwindows.md) ou [**PSM \_ REBOOTSYSTEM**](psm-rebootsystem.md) à la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-299">After making such a change, a page must send either the [**PSM\_RESTARTWINDOWS**](psm-restartwindows.md) or [**PSM\_REBOOTSYSTEM**](psm-rebootsystem.md) message to the property sheet.</span></span> <span data-ttu-id="f769d-300">Ces messages font en sorte que la fonction [**feuille**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) retourne la valeur **ID \_ PSRESTARTWINDOWS** ou **ID \_ PSREBOOTSYSTEM** après la destruction de la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-300">These messages cause the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to return the **ID\_PSRESTARTWINDOWS** or **ID\_PSREBOOTSYSTEM** value after the property sheet is destroyed.</span></span>

<span data-ttu-id="f769d-301">Quand un utilisateur clique sur le bouton **Annuler** , la feuille de propriétés envoie le code de notification de [ \_ réinitialisation PSN](psn-reset.md) à toutes les pages, indiquant que la feuille de propriétés va être détruite.</span><span class="sxs-lookup"><span data-stu-id="f769d-301">When a user clicks the **Cancel** button, the property sheet sends the [PSN\_RESET](psn-reset.md) notification code to all pages, indicating that the property sheet is about to be destroyed.</span></span> <span data-ttu-id="f769d-302">Une page doit utiliser la notification pour effectuer des opérations de nettoyage.</span><span class="sxs-lookup"><span data-stu-id="f769d-302">A page must use the notification to perform cleanup operations.</span></span>

## <a name="wizards"></a><span data-ttu-id="f769d-303">Assistants</span><span class="sxs-lookup"><span data-stu-id="f769d-303">Wizards</span></span>

<span data-ttu-id="f769d-304">Un Assistant est un type spécial de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="f769d-304">A wizard is a special type of property sheet.</span></span> <span data-ttu-id="f769d-305">Les assistants sont conçus pour présenter les pages une à la fois dans une séquence contrôlée par l’application.</span><span class="sxs-lookup"><span data-stu-id="f769d-305">Wizards are designed to present pages one at a time in a sequence that is controlled by the application.</span></span> <span data-ttu-id="f769d-306">Au lieu de sélectionner à partir d’un groupe de pages en cliquant sur un onglet, les utilisateurs naviguent vers l’avant et vers l’arrière dans la séquence, une page à la fois, en cliquant sur les boutons.</span><span class="sxs-lookup"><span data-stu-id="f769d-306">Instead of selecting from a group of pages by clicking a tab, users navigate forward and backward through the sequence, one page at a time, by clicking buttons.</span></span> <span data-ttu-id="f769d-307">Par exemple, la capture d’écran suivante montre la page d’accueil de l’Assistant Ajout de matériel :</span><span class="sxs-lookup"><span data-stu-id="f769d-307">For example, the following screen shot shows the welcome page from the Add Hardware wizard:</span></span>

![capture d’écran de la page d’accueil d’un Assistant](images/wizard97.png)

<span data-ttu-id="f769d-309">La capture d’écran suivante montre la première page d’un Assistant Aero, le nouveau style introduit dans Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="f769d-309">The following screen shot shows the first page of an Aero Wizard, the new style introduced in Windows Vista.</span></span>

![capture d’écran de la première page d’un Assistant Aero](images/wizardaero.png)

<span data-ttu-id="f769d-311">Pour une présentation complète des assistants, consultez [création d’assistants](wizards.md) .</span><span class="sxs-lookup"><span data-stu-id="f769d-311">See [Creating Wizards](wizards.md) for a complete discussion of wizards.</span></span>
