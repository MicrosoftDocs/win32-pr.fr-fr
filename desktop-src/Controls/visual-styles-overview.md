---
title: Vue d’ensemble des styles visuels
description: Cette rubrique décrit les styles visuels et identifie les composants Windows qui les prennent en charge. Elle explique également les étapes à suivre pour utiliser les styles visuels dans vos applications.
ms.assetid: 5B5D7BB6-684F-478D-BF5F-B8D18BBCFF2E
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5663730c752fbf16c4f229a031eafa0c65bb9dbb
ms.sourcegitcommit: a716ca2a6a22a400f02c6b31699cf4da83ee3619
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/04/2020
ms.locfileid: "104463942"
---
# <a name="visual-styles-overview"></a><span data-ttu-id="1f6ca-104">Vue d’ensemble des styles visuels</span><span class="sxs-lookup"><span data-stu-id="1f6ca-104">Visual Styles Overview</span></span>

<span data-ttu-id="1f6ca-105">Cette rubrique décrit les styles visuels et identifie les composants Windows qui les prennent en charge.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-105">This topic describes visual styles and identifies the Windows components that support them.</span></span> <span data-ttu-id="1f6ca-106">Elle explique également les étapes à suivre pour utiliser les styles visuels dans vos applications.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-106">It also explains the steps you must take to use visual styles in your applications.</span></span> <span data-ttu-id="1f6ca-107">Cette rubrique comporte les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="1f6ca-107">This topic includes the following sections:</span></span>

-   [<span data-ttu-id="1f6ca-108">Thèmes et styles visuels</span><span class="sxs-lookup"><span data-stu-id="1f6ca-108">Themes and Visual Styles</span></span>](#themes-and-visual-styles)
-   [<span data-ttu-id="1f6ca-109">Composants de styles visuels</span><span class="sxs-lookup"><span data-stu-id="1f6ca-109">Visual Styles Components</span></span>](#visual-styles-components)
-   [<span data-ttu-id="1f6ca-110">Spécifications de l’application pour la prise en charge des styles visuels</span><span class="sxs-lookup"><span data-stu-id="1f6ca-110">Application Requirements for Supporting Visual Styles</span></span>](#application-requirements-for-supporting-visual-styles)
-   [<span data-ttu-id="1f6ca-111">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1f6ca-111">Related topics</span></span>](#related-topics)

## <a name="themes-and-visual-styles"></a><span data-ttu-id="1f6ca-112">Thèmes et styles visuels</span><span class="sxs-lookup"><span data-stu-id="1f6ca-112">Themes and Visual Styles</span></span>

<span data-ttu-id="1f6ca-113">Windows propose plusieurs fonctionnalités qui permettent aux utilisateurs d’adapter l’interface utilisateur en fonction de leurs besoins et préférences spécifiques.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-113">Windows includes several features that enable users to tailor the UI to accommodate their individual needs and preferences.</span></span> <span data-ttu-id="1f6ca-114">Ces fonctionnalités incluent des thèmes, qui ont été introduits dans Microsoft plus !</span><span class="sxs-lookup"><span data-stu-id="1f6ca-114">These features include themes, which were introduced in Microsoft Plus!</span></span> <span data-ttu-id="1f6ca-115">pour Windows 95.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-115">for Windows 95.</span></span> <span data-ttu-id="1f6ca-116">Un thème est une collection de paramètres sélectionnables par l’utilisateur, qui comprend le papier peint, les curseurs, les polices, les sons et les icônes.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-116">A theme is a user-selectable collection of settings that includes wallpaper, cursors, fonts, sounds, and icons.</span></span> <span data-ttu-id="1f6ca-117">Voici quelques caractéristiques des thèmes.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-117">The following are some characteristics of themes.</span></span>

-   <span data-ttu-id="1f6ca-118">Les paramètres de thème sont spécifiés dans les fichiers. Theme qui ont un format similaire à win.ini fichiers.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-118">Theme settings are specified in .theme files that have a format similar to win.ini files.</span></span>
-   <span data-ttu-id="1f6ca-119">Un éditeur de logiciels indépendant (ISV) peut créer et distribuer un fichier. Theme avec un produit.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-119">An independent software vendor (ISV) can create and distribute a .theme file with a product.</span></span>
-   <span data-ttu-id="1f6ca-120">Dans les versions antérieures à Windows Vista, les fichiers de thème s’affichent sous l’onglet thème du panneau de configuration d’affichage.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-120">In versions earlier than Windows Vista, theme files are displayed on the Theme tab of the Display control panel.</span></span> <span data-ttu-id="1f6ca-121">Dans Windows Vista et versions ultérieures, les thèmes s’affichent dans le panneau de configuration personnalisation.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-121">In Windows Vista and later, themes are displayed in the Personalization control panel.</span></span>

<span data-ttu-id="1f6ca-122">Pour plus d’informations sur les fichiers. Theme, consultez [format de fichier de thème](themesfileformat-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1f6ca-122">For more information about .theme files, see [Theme File Format](themesfileformat-overview.md).</span></span>

<span data-ttu-id="1f6ca-123">Un style visuel est une spécification qui définit l’apparence des contrôles communs Windows.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-123">A visual style is a specification that defines the appearance of the Windows common controls.</span></span> <span data-ttu-id="1f6ca-124">Les styles visuels sont associés à des thèmes ; autrement dit, un fichier. Theme contient une section qui spécifie le style visuel à appliquer lorsque le thème particulier est actif.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-124">Visual styles are associated with themes; that is, a .theme file contains a section that specifies the visual style to apply when the particular theme is active.</span></span> <span data-ttu-id="1f6ca-125">Voici quelques caractéristiques des styles visuels.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-125">The following are some characteristics of visual styles.</span></span>

-   <span data-ttu-id="1f6ca-126">Les utilisateurs peuvent modifier le style visuel à tout moment en sélectionnant un autre thème.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-126">Users can change the visual style at any time by selecting a different theme.</span></span>
-   <span data-ttu-id="1f6ca-127">Vous devez utiliser l’API des styles visuels pour appliquer le style visuel actuellement actif aux contrôles personnalisés ou owner-drawn de votre application, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-127">You must use the visual styles API to apply the currently active visual style to your application's custom or owner-drawn controls, if any.</span></span>
-   <span data-ttu-id="1f6ca-128">Les informations qui définissent un style visuel sont stockées dans un fichier. msstyles.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-128">The information that defines a visual style is stored in a .msstyles file.</span></span> <span data-ttu-id="1f6ca-129">Microsoft ne prend pas en charge la création de fichiers. msstyles.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-129">Microsoft does not support the authoring of .msstyles files.</span></span>


<span data-ttu-id="1f6ca-130">L’illustration suivante montre une boîte de dialogue simple avec une barre des tâches, sur un bureau Windows 7 qui utilise le thème Windows Aero sans transparence.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-130">The following illustration shows a simple dialog box with a taskbar, on a Windows 7 desktop that uses the Windows Aero theme without transparency.</span></span> <span data-ttu-id="1f6ca-131">Étant donné que l’application n’est pas configurée pour utiliser les styles visuels, les boutons sont les mêmes, quels que soient les paramètres de thème.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-131">Because the application is not configured to use visual styles, the buttons appear the same regardless of the theme settings.</span></span>

![capture d’écran d’une boîte de dialogue avec des boutons qui n’utilisent pas la transparence](images/tb-wostyles.png)

<span data-ttu-id="1f6ca-133">En revanche, l’illustration suivante montre la même boîte de dialogue sur le même bureau, mais cette fois, l’application a été configurée pour fonctionner avec les styles visuels.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-133">In contrast, the following illustration shows the same dialog box on the same desktop, but this time the application has been configured to work with visual styles.</span></span> <span data-ttu-id="1f6ca-134">Notez l’apparence différente des boutons dans la zone cliente.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-134">Note the different appearance of the buttons in the client area.</span></span> <span data-ttu-id="1f6ca-135">Les boutons s’affichent différemment, car le système a appliqué les styles visuels définis dans le thème Aero.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-135">The buttons look different because the system has applied the visual styles that are defined in the Aero theme.</span></span>

![capture d’écran d’une boîte de dialogue avec des boutons qui utilisent la transparence](images/tb-withstyles.png)

<span data-ttu-id="1f6ca-137">L’exemple suivant montre une boîte de dialogue similaire sur un bureau Windows 8.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-137">The following example shows a similar dialog box on a Windows 8 desktop.</span></span> <span data-ttu-id="1f6ca-138">Dans Windows 8, les styles visuels sont toujours activés, afin que les applications Windows 8 les obtiennent « gratuitement ».</span><span class="sxs-lookup"><span data-stu-id="1f6ca-138">In Windows 8, visual styles are always on, so Windows 8 apps get theming "for free".</span></span>

![capture d’écran d’une boîte de dialogue simple sur le bureau Windows 8](images/tb-win8.png)

## <a name="visual-styles-components"></a><span data-ttu-id="1f6ca-140">Composants de styles visuels</span><span class="sxs-lookup"><span data-stu-id="1f6ca-140">Visual Styles Components</span></span>

<span data-ttu-id="1f6ca-141">Les styles visuels sont pris en charge par les composants suivants :</span><span class="sxs-lookup"><span data-stu-id="1f6ca-141">Visual styles are supported by the following components:</span></span>

-   <span data-ttu-id="1f6ca-142">Version 6 ou ultérieure de la bibliothèque de contrôles communs (ComCtl32.dll)</span><span class="sxs-lookup"><span data-stu-id="1f6ca-142">Version 6 or later of the common control library (ComCtl32.dll)</span></span>
-   <span data-ttu-id="1f6ca-143">API des styles visuels implémentée dans UxTheme.dll</span><span class="sxs-lookup"><span data-stu-id="1f6ca-143">The visual styles API implemented in UxTheme.dll</span></span>
-   <span data-ttu-id="1f6ca-144">Service thèmes</span><span class="sxs-lookup"><span data-stu-id="1f6ca-144">Themes service</span></span>
-   <span data-ttu-id="1f6ca-145">Un ou plusieurs fichiers de définition de style visuel (. msstyles)</span><span class="sxs-lookup"><span data-stu-id="1f6ca-145">One or more visual style definition files (.msstyles)</span></span>

<span data-ttu-id="1f6ca-146">L’API des styles visuels dépend d’un service système appelé themes.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-146">The visual styles API depends on a system service called Themes.</span></span> <span data-ttu-id="1f6ca-147">La bibliothèque de contrôles communs interroge le service Themes pour obtenir des informations relatives au style et, jusqu’à Windows 7, utilise le service pour restituer les contrôles dans le style visuel actuel.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-147">The common control library queries the Themes service to get style-related information and, up through Windows 7, uses the service to render controls in the current visual style.</span></span>

<span data-ttu-id="1f6ca-148">Dans Windows 8 et versions ultérieures, l’API des styles visuels fonctionne toujours si le service thèmes est désactivé.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-148">In Windows 8 and later, the visual styles API still works if the Themes service is off.</span></span> <span data-ttu-id="1f6ca-149">Cela signifie que les contrôles communs et la zone non cliente de Windows auront toujours des styles visuels lorsque le service thèmes est désactivé.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-149">This means that the common controls and the non-client area of windows will still have visual styles when the Themes service is off.</span></span> <span data-ttu-id="1f6ca-150">Les fonctionnalités de Windows 8 qui nécessitent toujours le service thèmes sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="1f6ca-150">The Windows 8 features that still require the Themes service include:</span></span>

-   <span data-ttu-id="1f6ca-151">Modification du style visuel, en général via la page de **personnalisation** des **paramètres du PC**.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-151">Changing the visual style, typically through the **Personalization** page of **PC Settings**.</span></span>
-   <span data-ttu-id="1f6ca-152">Optimisations des performances impliquées dans le changement des utilisateurs, la déconnexion, l’arrêt et le partage entre les sessions utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-152">Performance optimizations involved in switching users, logging off, shutting down, and sharing across user sessions.</span></span>

<span data-ttu-id="1f6ca-153">L’API des styles visuels obtient des informations de style à partir du fichier. msstyles associé au thème actuellement sélectionné.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-153">The visual styles API gets style information from the .msstyles file associated with the currently selected theme.</span></span> <span data-ttu-id="1f6ca-154">Le fichier. msstyles contient un ensemble de métriques, de polices, de couleurs et de bitmaps qui définissent un style visuel</span><span class="sxs-lookup"><span data-stu-id="1f6ca-154">The .msstyles file contains a set of metrics, fonts, colors, and bitmaps that define a visual style</span></span>

## <a name="application-requirements-for-supporting-visual-styles"></a><span data-ttu-id="1f6ca-155">Spécifications de l’application pour la prise en charge des styles visuels</span><span class="sxs-lookup"><span data-stu-id="1f6ca-155">Application Requirements for Supporting Visual Styles</span></span>

<span data-ttu-id="1f6ca-156">Pour utiliser les styles visuels, votre application doit s’exécuter sur un système d’exploitation qui contient ComCtl32.dll version 6 ou ultérieure.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-156">To use visual styles, your application must be running on an operating system that contains ComCtl32.dll version 6 or later.</span></span> <span data-ttu-id="1f6ca-157">Si vous souhaitez que votre application utilise ComCtl32.dll version 6, vous devez ajouter un manifeste d’application ou une directive de compilateur pour spécifier que la version 6 doit être utilisée si elle est disponible.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-157">If you want your application to use ComCtl32.dll version 6, you must add an application manifest or compiler directive to specify that version 6 should be used if it is available.</span></span> <span data-ttu-id="1f6ca-158">Pour plus d’informations sur la création d’un manifeste d’application qui permet à votre application d’utiliser des styles visuels, consultez [activation de styles visuels](cookbook-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1f6ca-158">For information on how to create an application manifest that enables your application to use visual styles, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

<span data-ttu-id="1f6ca-159">Pour les contrôles communs, aucune action supplémentaire n’est nécessaire pour s’assurer que les contrôles sont affichés dans le style visuel préféré de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-159">For common controls, no further action is necessary to ensure that the controls are displayed in the user's preferred visual style.</span></span>

<span data-ttu-id="1f6ca-160">Si votre application contient des contrôles personnalisés ou owner-drawn, vous devez utiliser l’API des styles visuels pour récupérer des informations sur le style visuel actuellement actif et dessiner les contrôles dans ce style.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-160">If your application contains custom or owner-drawn controls, you need to use the visual styles API to retrieve information about the currently active visual style, and to draw the controls in that style.</span></span>

<span data-ttu-id="1f6ca-161">Pour les versions de Windows antérieures à Windows 8, les applications doivent généralement fournir deux chemins de code distincts pour dessiner des contrôles personnalisés et owner-drawn.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-161">For Windows versions prior to Windows 8, applications typically need to provide two separate code paths for drawing custom and owner-drawn controls.</span></span> <span data-ttu-id="1f6ca-162">Un chemin d’accès de code dessine les contrôles lorsqu’un thème qui utilise des styles visuels est actif, et un autre chemin d’accès de code dessine les contrôles lorsque le thème classique Windows ou un thème à contraste élevé est actif.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-162">One code path draws the controls when a theme that uses visual styles is active, and another code path draws the controls when the Windows Classic theme or a high contrast theme is active.</span></span> <span data-ttu-id="1f6ca-163">Dans Windows 8, toutefois, les styles visuels sont toujours activés. il n’est donc pas nécessaire de séparer les chemins de code.</span><span class="sxs-lookup"><span data-stu-id="1f6ca-163">In Windows 8, however, visual styles are always on, so separate theming code paths are not needed.</span></span> <span data-ttu-id="1f6ca-164">Les applications qui sont manifestes pour Windows 8 obtiennent un contraste élevé « gratuit ».</span><span class="sxs-lookup"><span data-stu-id="1f6ca-164">Applications that are manifested for Windows 8 get high contrast theming "for free."</span></span> <span data-ttu-id="1f6ca-165">Pour plus d’informations, consultez [prise en charge des thèmes de contraste élevé](supporting-high-contrast-themes.md).</span><span class="sxs-lookup"><span data-stu-id="1f6ca-165">For more information, see [Supporting High Contrast Themes](supporting-high-contrast-themes.md).</span></span>

<span data-ttu-id="1f6ca-166">Pour plus d’informations sur, consultez [utilisation de styles visuels avec des contrôles personnalisés et Owner-Drawn](using-visual-styles.md) et [référence des styles visuels](uxctl-ref.md).</span><span class="sxs-lookup"><span data-stu-id="1f6ca-166">For more information about, see [Using Visual Styles with Custom and Owner-Drawn Controls](using-visual-styles.md) and [Visual Styles Reference](uxctl-ref.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1f6ca-167">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1f6ca-167">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1f6ca-168">Styles visuels</span><span class="sxs-lookup"><span data-stu-id="1f6ca-168">Visual Styles</span></span>](themes-overview.md)
</dt> </dl>

 

 




