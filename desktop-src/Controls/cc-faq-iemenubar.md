---
title: Procédure de création d’une barre de menus Explorer-Style Internet
description: À première vue, la barre de menus dans Microsoft Internet Explorer 5 et versions ultérieures ressemble à un menu standard. Toutefois, il semble très différent lorsque vous commencez à l’utiliser.
ms.assetid: e0fe25f2-3d49-4c5a-a3f9-2f468f2cfef2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b262bc55407d263c97d4bd7e3938a9794d3a58f5
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103842773"
---
# <a name="how-to-create-an-internet-explorer-style-menu-bar"></a><span data-ttu-id="0ea32-104">Procédure de création d’une barre de menus Explorer-Style Internet</span><span class="sxs-lookup"><span data-stu-id="0ea32-104">How to Create an Internet Explorer-Style Menu Bar</span></span>

<span data-ttu-id="0ea32-105">À première vue, la barre de menus dans Microsoft Internet Explorer 5 et versions ultérieures ressemble à un menu standard.</span><span class="sxs-lookup"><span data-stu-id="0ea32-105">At first glance, the menu bar in Microsoft Internet Explorer 5 and later looks similar to a standard menu.</span></span> <span data-ttu-id="0ea32-106">Toutefois, il semble très différent lorsque vous commencez à l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="0ea32-106">However, it looks quite different when you begin using it.</span></span>

<span data-ttu-id="0ea32-107">La capture d’écran suivante montre la barre de menus de Windows Internet Explorer avec le menu Outils sélectionné.</span><span class="sxs-lookup"><span data-stu-id="0ea32-107">The following screen shot shows the Windows Internet Explorer menu bar with the Tools menu selected.</span></span>

![capture d’écran qui affiche la barre de menus de Windows Internet Explorer, avec le menu Outils sélectionné](images/howto8.jpg)

<span data-ttu-id="0ea32-109">La barre de menus est en fait un contrôle de barre d’outils qui ressemble à un menu standard.</span><span class="sxs-lookup"><span data-stu-id="0ea32-109">The menu bar is actually a toolbar control that looks like a standard menu.</span></span> <span data-ttu-id="0ea32-110">Au lieu d’éléments de menu de niveau supérieur, une barre de menus contient une série de boutons de texte uniquement qui affichent un menu déroulant lorsque l’utilisateur clique dessus.</span><span class="sxs-lookup"><span data-stu-id="0ea32-110">Instead of top-level menu items, a menu bar has a series of text-only buttons that display a drop-down menu when clicked.</span></span> <span data-ttu-id="0ea32-111">Toutefois, en tant que type spécialisé de barre d’outils, une barre de menus présente certaines fonctionnalités dont les menus standard sont absents :</span><span class="sxs-lookup"><span data-stu-id="0ea32-111">However, as a specialized type of toolbar, a menu bar has some capabilities that standard menus lack:</span></span>

-   <span data-ttu-id="0ea32-112">Il peut être personnalisé à l’aide de techniques de barre d’outils standard, ce qui permet à l’utilisateur de déplacer, supprimer ou ajouter des éléments.</span><span class="sxs-lookup"><span data-stu-id="0ea32-112">It can be customized using standard toolbar techniques, allowing the user to move, delete, or add items.</span></span>
-   <span data-ttu-id="0ea32-113">Il peut avoir un suivi à chaud, afin que les utilisateurs sachent quand ils se trouvent sur un élément de niveau supérieur sans devoir le cliquer au préalable.</span><span class="sxs-lookup"><span data-stu-id="0ea32-113">It can have hot-tracking, so that users will know when they are over a top-level item without having to click it first.</span></span>

<span data-ttu-id="0ea32-114">Une barre de menus peut être incorporée dans un contrôle rebar, en lui donnant les fonctionnalités suivantes :</span><span class="sxs-lookup"><span data-stu-id="0ea32-114">A menu bar can be incorporated into a rebar control, giving it the following features:</span></span>

-   <span data-ttu-id="0ea32-115">Il peut avoir une pince, qui permet à l’utilisateur de déplacer ou de redimensionner la bande.</span><span class="sxs-lookup"><span data-stu-id="0ea32-115">It can have a gripper, which allows the user to move or resize the band.</span></span>
-   <span data-ttu-id="0ea32-116">Elle peut partager une bande dans le contrôle rebar avec d’autres bandes, telles que la barre d’outils standard de l’illustration précédente.</span><span class="sxs-lookup"><span data-stu-id="0ea32-116">It can share a strip in the rebar control with other bands, such as the standard toolbar in the preceding illustration.</span></span>
-   <span data-ttu-id="0ea32-117">Il peut afficher un chevron lorsqu’il est couvert par une bande adjacente, ce qui permet à l’utilisateur d’accéder aux éléments masqués.</span><span class="sxs-lookup"><span data-stu-id="0ea32-117">It can display a chevron when it is covered by an adjacent band, giving the user access to the hidden items.</span></span>
-   <span data-ttu-id="0ea32-118">Il peut avoir une image bitmap d’arrière-plan définie par l’application.</span><span class="sxs-lookup"><span data-stu-id="0ea32-118">It can have an application-defined background bitmap.</span></span>

<span data-ttu-id="0ea32-119">Cette rubrique explique comment implémenter une barre de menus.</span><span class="sxs-lookup"><span data-stu-id="0ea32-119">This topic discusses how to implement a menu bar.</span></span> <span data-ttu-id="0ea32-120">Comme une barre de menus est une implémentation spécialisée d’un contrôle ToolBar, le focus sera sur les rubriques spécifiques aux barres de menus.</span><span class="sxs-lookup"><span data-stu-id="0ea32-120">Since a menu bar is a specialized implementation of a toolbar control, the focus will be on topics that are specific to menu bars.</span></span> <span data-ttu-id="0ea32-121">Pour plus d’informations sur l’incorporation d’une barre d’outils dans un contrôle rebar, consultez [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md) et [about Rebar Controls](rebar-controls.md).</span><span class="sxs-lookup"><span data-stu-id="0ea32-121">For a discussion of how to incorporate a toolbar into a rebar control, see [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md) and [About Rebar Controls](rebar-controls.md).</span></span>

-   [<span data-ttu-id="0ea32-122">Création d’une barre d’outils dans une barre de menus</span><span class="sxs-lookup"><span data-stu-id="0ea32-122">Making a Toolbar into a Menu Bar</span></span>](#making-a-toolbar-into-a-menu-bar)
-   [<span data-ttu-id="0ea32-123">Gestion de la navigation avec le menu Hot-Tracking désactivé</span><span class="sxs-lookup"><span data-stu-id="0ea32-123">Handling Navigation with Menu Hot-Tracking Disabled</span></span>](#handling-navigation-with-menu-hot-tracking-disabled)
    -   [<span data-ttu-id="0ea32-124">Navigation de la souris</span><span class="sxs-lookup"><span data-stu-id="0ea32-124">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="0ea32-125">Navigation au clavier</span><span class="sxs-lookup"><span data-stu-id="0ea32-125">Keyboard Navigation</span></span>](#keyboard-navigation)
    -   [<span data-ttu-id="0ea32-126">Navigation mixte</span><span class="sxs-lookup"><span data-stu-id="0ea32-126">Mixed Navigation</span></span>](#mixed-navigation)
-   [<span data-ttu-id="0ea32-127">Gestion de la navigation avec le Hot-Tracking de menu activé</span><span class="sxs-lookup"><span data-stu-id="0ea32-127">Handling Navigation with Menu Hot-Tracking Enabled</span></span>](#handling-navigation-with-menu-hot-tracking-enabled)
    -   [<span data-ttu-id="0ea32-128">Traitement des messages pour le suivi chaud du menu</span><span class="sxs-lookup"><span data-stu-id="0ea32-128">Message Processing for Menu Hot-Tracking</span></span>](#message-processing-for-menu-hot-tracking)
    -   [<span data-ttu-id="0ea32-129">Navigation de la souris</span><span class="sxs-lookup"><span data-stu-id="0ea32-129">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="0ea32-130">Navigation au clavier</span><span class="sxs-lookup"><span data-stu-id="0ea32-130">Keyboard Navigation</span></span>](#keyboard-navigation)

## <a name="making-a-toolbar-into-a-menu-bar"></a><span data-ttu-id="0ea32-131">Création d’une barre d’outils dans une barre de menus</span><span class="sxs-lookup"><span data-stu-id="0ea32-131">Making a Toolbar into a Menu Bar</span></span>

<span data-ttu-id="0ea32-132">Pour créer une barre d’outils dans une barre de menus :</span><span class="sxs-lookup"><span data-stu-id="0ea32-132">To make a toolbar into a menu bar:</span></span>

-   <span data-ttu-id="0ea32-133">Créez une barre d’outils plate en incluant [**TBSTYLE \_ Flat**](toolbar-control-and-button-styles.md) avec les autres indicateurs de style de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="0ea32-133">Create a flat toolbar by including [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="0ea32-134">Le **style \_ plat TBSTYLE** active également le suivi à chaud.</span><span class="sxs-lookup"><span data-stu-id="0ea32-134">The **TBSTYLE\_FLAT** style also enables hot-tracking.</span></span> <span data-ttu-id="0ea32-135">Avec ce style, la barre de menus ressemble à un menu standard jusqu’à ce que l’utilisateur active un bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-135">With this style, the menu bar looks much like a standard menu until the user activates a button.</span></span> <span data-ttu-id="0ea32-136">Ensuite, le bouton apparaît pour s’afficher dans la barre d’outils et appuyez sur la touche enfoncé, tout comme un bouton standard.</span><span class="sxs-lookup"><span data-stu-id="0ea32-136">Then, the button appears to stand out from the toolbar and depress when it is clicked, just like a standard button.</span></span> <span data-ttu-id="0ea32-137">Étant donné que le suivi à chaud est activé, tout ce qui est nécessaire pour activer un bouton est que le curseur pointe dessus.</span><span class="sxs-lookup"><span data-stu-id="0ea32-137">Because hot-tracking is enabled, all that is needed to activate a button is for the cursor to hover over it.</span></span> <span data-ttu-id="0ea32-138">Si le curseur se déplace vers un autre bouton, il est activé et l’ancien bouton est désactivé.</span><span class="sxs-lookup"><span data-stu-id="0ea32-138">If the cursor moves to another button, it will be activated and the old button deactivated.</span></span>
-   <span data-ttu-id="0ea32-139">Créer des boutons de style liste en incluant la [**\_ liste TBSTYLE**](toolbar-control-and-button-styles.md) avec les autres indicateurs de style de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="0ea32-139">Create list-style buttons by including [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="0ea32-140">Ce style crée un bouton plus fin qui ressemble plus à un élément de menu de niveau supérieur standard.</span><span class="sxs-lookup"><span data-stu-id="0ea32-140">This style creates a thinner button that looks more like a standard top-level menu item.</span></span>
-   <span data-ttu-id="0ea32-141">Définissez le texte des boutons uniquement en définissant le membre **iBitmap** de la structure [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) du bouton sur I \_ IMAGENONE et le membre **iString** sur le texte du bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-141">Make the buttons text-only by setting the **iBitmap** member of the button's [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure to I\_IMAGENONE and the **iString** member to the button text.</span></span>
-   <span data-ttu-id="0ea32-142">Donnez à chaque bouton le style de [**\_ liste déroulante BTNS**](toolbar-control-and-button-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="0ea32-142">Give each button the [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="0ea32-143">Lorsque vous cliquez sur le bouton, le contrôle ToolBar envoie à votre application une notification de [ \_ liste déroulante TBN](tbn-dropdown.md) pour lui demander d’afficher le menu du bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-143">When the button is clicked, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification to prompt it to display the button's menu.</span></span>
-   <span data-ttu-id="0ea32-144">Incorporez la barre de menus dans une bande rebar.</span><span class="sxs-lookup"><span data-stu-id="0ea32-144">Incorporate the menu bar into a rebar band.</span></span> <span data-ttu-id="0ea32-145">Activez les pinceaux et les chevrons, comme indiqué dans [la rubrique How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md).</span><span class="sxs-lookup"><span data-stu-id="0ea32-145">Enable both grippers and chevrons, as discussed in [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md).</span></span>
-   <span data-ttu-id="0ea32-146">Implémentez un gestionnaire de [ \_ liste déroulante TBN](tbn-dropdown.md) pour afficher le *menu* déroulant du bouton lorsque l’utilisateur clique dessus.</span><span class="sxs-lookup"><span data-stu-id="0ea32-146">Implement a [TBN\_DROPDOWN](tbn-dropdown.md) handler to display the button's *drop-down menu* when it is clicked.</span></span> <span data-ttu-id="0ea32-147">Le menu déroulant est un type de menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="0ea32-147">The drop-down menu is a type of pop-up menu.</span></span> <span data-ttu-id="0ea32-148">Elle est créée à l’aide de la fonction [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) , dont l’angle supérieur gauche est aligné avec l’angle inférieur gauche du bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-148">It is created by using the [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) function, with its upper-left corner aligned with the lower-left corner of the button.</span></span>
-   <span data-ttu-id="0ea32-149">Implémentez la navigation au clavier, afin que la barre de menus soit entièrement accessible sans souris.</span><span class="sxs-lookup"><span data-stu-id="0ea32-149">Implement keyboard navigation, so that the menu bar is fully accessible without a mouse.</span></span>
-   <span data-ttu-id="0ea32-150">Implémenter le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-150">Implement menu hot-tracking.</span></span> <span data-ttu-id="0ea32-151">Avec les menus standard, une fois qu’un menu d’élément de menu de niveau supérieur a été affiché, le déplacement du curseur sur un autre élément de niveau supérieur affiche automatiquement son menu et réduit le menu de l’élément précédent.</span><span class="sxs-lookup"><span data-stu-id="0ea32-151">With standard menus, once a top level menu item's menu has been displayed, moving the cursor over another top-level item automatically displays its menu and collapses the menu of the previous item.</span></span> <span data-ttu-id="0ea32-152">Le contrôle ToolBar effectue un suivi à chaud du curseur et modifie l’image du bouton, mais il affiche automatiquement le nouveau menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-152">The toolbar control will hot-track the cursor and change the button image, but it does automatically display the new menu.</span></span> <span data-ttu-id="0ea32-153">Votre application doit le faire explicitement.</span><span class="sxs-lookup"><span data-stu-id="0ea32-153">Your application must do so explicitly.</span></span>

<span data-ttu-id="0ea32-154">La plupart de ces éléments sont faciles à implémenter et sont abordés ailleurs.</span><span class="sxs-lookup"><span data-stu-id="0ea32-154">Most of these items are straightforward to implement and are discussed elsewhere.</span></span> <span data-ttu-id="0ea32-155">Consultez Guide pratique [pour créer une barre d’outils Internet Explorer-Style](cc-faq-ietoolbar.md), [à propos des contrôles ToolBar](toolbar-controls-overview.md)ou [à propos des contrôles Rebar](rebar-controls.md) pour obtenir une présentation générale de l’utilisation des barres d’outils et des contrôles Rebar.</span><span class="sxs-lookup"><span data-stu-id="0ea32-155">See [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md), [About Toolbar Controls](toolbar-controls-overview.md), or [About Rebar Controls](rebar-controls.md) for a general discussion of how to use toolbars and rebar controls.</span></span> <span data-ttu-id="0ea32-156">Pour plus d’informations sur la gestion des menus contextuels, consultez [menus](/windows/desktop/menurc/menus) .</span><span class="sxs-lookup"><span data-stu-id="0ea32-156">See [Menus](/windows/desktop/menurc/menus) for a discussion of how to handle pop-up menus.</span></span> <span data-ttu-id="0ea32-157">Les deux derniers éléments, la navigation au clavier et le suivi des menus à chaud, sont décrits dans le reste de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="0ea32-157">The final two items, keyboard navigation and menu hot-tracking, are discussed in the remainder of this topic.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-disabled"></a><span data-ttu-id="0ea32-158">Gestion de la navigation avec le menu Hot-Tracking désactivé</span><span class="sxs-lookup"><span data-stu-id="0ea32-158">Handling Navigation with Menu Hot-Tracking Disabled</span></span>

<span data-ttu-id="0ea32-159">Les utilisateurs peuvent choisir de naviguer dans la barre de menus avec la souris, le clavier ou une combinaison des deux.</span><span class="sxs-lookup"><span data-stu-id="0ea32-159">Users can choose to navigate the menu bar with the mouse, the keyboard, or a mixture of both.</span></span> <span data-ttu-id="0ea32-160">Pour implémenter la navigation dans la barre de menus, votre application doit gérer les notifications de barre d’outils et surveiller la souris et le clavier.</span><span class="sxs-lookup"><span data-stu-id="0ea32-160">To implement menu bar navigation, your application must handle toolbar notifications and monitor the mouse and keyboard.</span></span> <span data-ttu-id="0ea32-161">Cette tâche peut être divisée en deux parties distinctes : avec et sans suivi chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-161">This task can be broken into two distinct parts: with and without menu hot-tracking.</span></span> <span data-ttu-id="0ea32-162">Cette section explique comment gérer la navigation quand aucun menu n’est affiché et que le suivi des menus à chaud n’est pas activé.</span><span class="sxs-lookup"><span data-stu-id="0ea32-162">This section discusses how to handle navigation when no menus are displayed and menu hot-tracking is not enabled.</span></span>

### <a name="mouse-navigation"></a><span data-ttu-id="0ea32-163">Navigation de la souris</span><span class="sxs-lookup"><span data-stu-id="0ea32-163">Mouse Navigation</span></span>

<span data-ttu-id="0ea32-164">Si le suivi à chaud du menu est désactivé, vous pouvez traiter une barre de menus comme une barre d’outils normale.</span><span class="sxs-lookup"><span data-stu-id="0ea32-164">If menu hot-tracking is disabled, you can treat a menu bar as a normal toolbar.</span></span> <span data-ttu-id="0ea32-165">Si l’utilisateur navigue avec une souris, toute votre application doit effectuer la notification de la [ \_ liste déroulante TBN](tbn-dropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="0ea32-165">If the user is navigating with a mouse, all your application needs to do is handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="0ea32-166">Quand cette notification est reçue, affichez le menu déroulant approprié et activez le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-166">When this notification is received, display the appropriate drop-down menu, and enable menu hot-tracking.</span></span> <span data-ttu-id="0ea32-167">À partir de là, vous êtes dans le menu du régime de suivi à chaud abordé dans [gestion de la navigation avec le menu Hot-Tracking activé](#handling-navigation-with-menu-hot-tracking-enabled).</span><span class="sxs-lookup"><span data-stu-id="0ea32-167">From then on, you are in the menu hot-tracking regime discussed in [Handling Navigation with Menu Hot-Tracking Enabled](#handling-navigation-with-menu-hot-tracking-enabled).</span></span>

<span data-ttu-id="0ea32-168">Comme indiqué dans la [navigation mixte](#mixed-navigation), vous devez également gérer la [notification \_ HOTITEMCHANGE TBN](tbn-hotitemchange.md) pour effectuer le suivi du bouton actif.</span><span class="sxs-lookup"><span data-stu-id="0ea32-168">As discussed in [Mixed Navigation](#mixed-navigation), you also need to handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="0ea32-169">Cette notification n’est pas pertinente si l’utilisateur navigue uniquement avec la souris, mais elle est nécessaire lorsque la souris et la navigation au clavier sont mélangées.</span><span class="sxs-lookup"><span data-stu-id="0ea32-169">This notification is irrelevant if the user is only navigating with the mouse, but it is necessary when mouse and keyboard navigation are mixed.</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="0ea32-170">Navigation au clavier</span><span class="sxs-lookup"><span data-stu-id="0ea32-170">Keyboard Navigation</span></span>

<span data-ttu-id="0ea32-171">Comme indiqué dans la section précédente, l’utilisateur peut effectuer un certain nombre d’opérations de navigation à l’aide du clavier lorsque le suivi actif du menu est désactivé.</span><span class="sxs-lookup"><span data-stu-id="0ea32-171">As noted in the previous section, the user can do a number of navigation operations with the keyboard when menu hot-tracking is disabled.</span></span> <span data-ttu-id="0ea32-172">Les contrôles ToolBar prennent uniquement en charge la navigation au clavier s’ils ont le focus.</span><span class="sxs-lookup"><span data-stu-id="0ea32-172">Toolbar controls support keyboard navigation only if they have focus.</span></span> <span data-ttu-id="0ea32-173">Ils ne gèrent pas non plus toutes les touches d’appui nécessaires pour les barres de menus.</span><span class="sxs-lookup"><span data-stu-id="0ea32-173">They also do not handle all the key presses that are needed for menu bars.</span></span> <span data-ttu-id="0ea32-174">La solution la plus simple pour gérer la navigation au clavier consiste à traiter explicitement les événements d’appui sur les touches appropriées.</span><span class="sxs-lookup"><span data-stu-id="0ea32-174">The simplest solution to handling keyboard navigation is to process the relevant key press events explicitly.</span></span>

<span data-ttu-id="0ea32-175">Si le suivi à chaud du menu est désactivé, votre application doit gérer ces événements de pression de touche de la façon suivante :</span><span class="sxs-lookup"><span data-stu-id="0ea32-175">If menu hot-tracking is disabled, your application must handle these key press events in the following way:</span></span>

-   <span data-ttu-id="0ea32-176">Touche F10.</span><span class="sxs-lookup"><span data-stu-id="0ea32-176">The F10 key.</span></span> <span data-ttu-id="0ea32-177">Activez le premier bouton avec [**to \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="0ea32-177">Activate the first button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span>
-   <span data-ttu-id="0ea32-178">Touches de direction gauche et droite.</span><span class="sxs-lookup"><span data-stu-id="0ea32-178">The LEFT ARROW and RIGHT ARROW keys.</span></span> <span data-ttu-id="0ea32-179">Activez le bouton adjacent avec [**to \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="0ea32-179">Activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="0ea32-180">Si l’utilisateur tente de naviguer à l’extrémité de la barre de menus, activez le premier bouton à l’extrémité opposée.</span><span class="sxs-lookup"><span data-stu-id="0ea32-180">If the user attempts to navigate off either end of the menu bar, activate the first button at the opposite end.</span></span>
-   <span data-ttu-id="0ea32-181">Touche ÉCHAP.</span><span class="sxs-lookup"><span data-stu-id="0ea32-181">The ESCAPE key.</span></span> <span data-ttu-id="0ea32-182">Désactivez le bouton actif avec [**to \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="0ea32-182">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="0ea32-183">La barre de menus doit être retournée à l’État qu’elle avait avant l’activation du premier bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-183">The menu bar should be returned to the state it had prior to activating the first button.</span></span>
-   <span data-ttu-id="0ea32-184">Touche d’accès rapide de *touche* Alt.</span><span class="sxs-lookup"><span data-stu-id="0ea32-184">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="0ea32-185">Utilisez le message [**to \_ MAPACCELERATOR**](tb-mapaccelerator.md) pour déterminer le bouton auquel le caractère *clé* correspond.</span><span class="sxs-lookup"><span data-stu-id="0ea32-185">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="0ea32-186">Affichez le menu déroulant du bouton et activez le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-186">Display the button's drop-down menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="0ea32-187">Touche Bas.</span><span class="sxs-lookup"><span data-stu-id="0ea32-187">The DOWN ARROW key.</span></span> <span data-ttu-id="0ea32-188">Si un bouton est actif mais qu’aucun menu n’a été affiché, affichez le menu du bouton et activez le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-188">If a button is active but no menu has been displayed, display the button's menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="0ea32-189">Touche Entrée.</span><span class="sxs-lookup"><span data-stu-id="0ea32-189">The ENTER key.</span></span> <span data-ttu-id="0ea32-190">Désactivez le bouton actif avec [**to \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="0ea32-190">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="0ea32-191">La barre de menus doit être retournée à l’État qu’elle avait avant l’activation du premier bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-191">The menu bar should be returned to the state it had prior to activating the first button.</span></span>

### <a name="mixed-navigation"></a><span data-ttu-id="0ea32-192">Navigation mixte</span><span class="sxs-lookup"><span data-stu-id="0ea32-192">Mixed Navigation</span></span>

<span data-ttu-id="0ea32-193">Les gestionnaires de navigation au clavier décrits dans la section précédente effectuent essentiellement deux tâches : suivre le bouton actif et afficher le menu approprié lorsqu’un bouton est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="0ea32-193">The keyboard navigation handlers outlined in the preceding section basically do two tasks: keep track of the active button and display the appropriate menu when a button is selected.</span></span> <span data-ttu-id="0ea32-194">Ces gestionnaires sont suffisants tant que l’utilisateur navigue uniquement avec le clavier.</span><span class="sxs-lookup"><span data-stu-id="0ea32-194">These handlers are sufficient as long as the user navigates only with the keyboard.</span></span> <span data-ttu-id="0ea32-195">Toutefois, les utilisateurs combinent souvent la navigation au clavier et à la souris.</span><span class="sxs-lookup"><span data-stu-id="0ea32-195">However, users often mix keyboard and mouse navigation.</span></span> <span data-ttu-id="0ea32-196">Par exemple, ils peuvent activer le premier bouton avec la touche F10, utiliser la souris pour activer un autre bouton, puis ouvrir son menu avec la touche de direction bas.</span><span class="sxs-lookup"><span data-stu-id="0ea32-196">For example, they might activate the first button with the F10 key, use the mouse to activate a different button, and then open its menu with the DOWN ARROW key.</span></span> <span data-ttu-id="0ea32-197">Si vous analysez uniquement les Appuyez sur les touches pour suivre la clé active, vous affichez le mauvais menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-197">If you are only monitoring key presses to keep track of the active key, you will display the wrong menu.</span></span> <span data-ttu-id="0ea32-198">Vous devez également gérer la [notification \_ HOTITEMCHANGE TBN](tbn-hotitemchange.md) pour suivre avec précision le bouton actif.</span><span class="sxs-lookup"><span data-stu-id="0ea32-198">You must also handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to accurately keep track of the active button.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-enabled"></a><span data-ttu-id="0ea32-199">Gestion de la navigation avec le Hot-Tracking de menu activé</span><span class="sxs-lookup"><span data-stu-id="0ea32-199">Handling Navigation with Menu Hot-Tracking Enabled</span></span>

<span data-ttu-id="0ea32-200">Lorsque le suivi des menus à chaud est activé, votre application doit modifier la façon dont elle répond à la navigation de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0ea32-200">When menu hot-tracking is enabled, your application must change the way it responds to user navigation.</span></span> <span data-ttu-id="0ea32-201">Pour répliquer le comportement des menus standard, vous devez implémenter les fonctionnalités suivantes explicitement.</span><span class="sxs-lookup"><span data-stu-id="0ea32-201">To replicate the behavior of standard menus, you must implement the following features explicitly.</span></span>

<span data-ttu-id="0ea32-202">Avec la navigation de la souris :</span><span class="sxs-lookup"><span data-stu-id="0ea32-202">With mouse navigation:</span></span>

-   <span data-ttu-id="0ea32-203">Si l’utilisateur déplace le curseur sur un autre bouton, ce menu s’affiche immédiatement et le menu précédent disparaît.</span><span class="sxs-lookup"><span data-stu-id="0ea32-203">If the user moves the cursor over another button, that menu immediately appears and the previous menu disappears.</span></span>
-   <span data-ttu-id="0ea32-204">Le suivi à chaud du menu reste actif jusqu’à ce que l’utilisateur sélectionne une commande ou clique sur un point qui ne fait pas partie de la zone de menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-204">Menu hot-tracking stays active until the user selects a command or clicks a point that is not part of the menu region.</span></span> <span data-ttu-id="0ea32-205">L’une des actions désactive le suivi à chaud du menu jusqu’à ce que vous cliquiez sur un autre bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-205">Either action deactivates menu hot-tracking until another button is clicked.</span></span>
-   <span data-ttu-id="0ea32-206">Si le curseur est déplacé en dehors du menu, le menu déroulant actuel reste jusqu’à ce que le curseur repasse sur, ou lorsque l’utilisateur clique sur un point extérieur, la zone couverte par le menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-206">If the cursor moves off the menu, the current drop-down menu remains until the cursor moves back onto, or the user clicks a point outside, the area covered by the menu.</span></span> <span data-ttu-id="0ea32-207">Si le curseur retourne à un autre bouton que celui actuellement affiché, l’ancien menu est réduit et le nouveau menu s’affiche.</span><span class="sxs-lookup"><span data-stu-id="0ea32-207">If the cursor returns to a different button than the one currently being displayed, the old menu is collapsed and the new menu is displayed.</span></span>

<span data-ttu-id="0ea32-208">Avec la navigation à l’aide du clavier :</span><span class="sxs-lookup"><span data-stu-id="0ea32-208">With keyboard navigation:</span></span>

-   <span data-ttu-id="0ea32-209">La touche de direction droite déplace le focus vers la droite.</span><span class="sxs-lookup"><span data-stu-id="0ea32-209">The RIGHT ARROW key moves the focus to the right.</span></span> <span data-ttu-id="0ea32-210">Si l’élément a un sous-menu, affichez le sous-menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-210">If the item has a submenu, display the submenu.</span></span> <span data-ttu-id="0ea32-211">Si l’élément n’a pas de sous-menu, réduisez le menu et tous les sous-menus, activez le bouton suivant avec [**to \_ SETHOTITEM**](tb-sethotitem.md)et affichez le menu du bouton adjacent.</span><span class="sxs-lookup"><span data-stu-id="0ea32-211">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="0ea32-212">Si le dernier bouton est actif lors de la réception de ce message, affichez le menu du premier bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-212">If the last button is active when this message is received, display the menu for the first button.</span></span>
-   <span data-ttu-id="0ea32-213">La touche de direction gauche déplace le focus vers la gauche.</span><span class="sxs-lookup"><span data-stu-id="0ea32-213">The LEFT ARROW key moves the focus to the left.</span></span> <span data-ttu-id="0ea32-214">Si l’élément est un sous-menu, réduisez-le et déplacez le focus vers son menu parent.</span><span class="sxs-lookup"><span data-stu-id="0ea32-214">If the item is a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="0ea32-215">Si l’élément n’est pas un sous-menu, réduisez le menu, activez le bouton suivant avec [**to \_ SETHOTITEM**](tb-sethotitem.md)et affichez le menu du bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-215">If the item is not a submenu, collapse the menu, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for that button.</span></span>

<!-- -->

-   <span data-ttu-id="0ea32-216">La touche Échap rétablit l’affichage d’une étape.</span><span class="sxs-lookup"><span data-stu-id="0ea32-216">The ESCAPE key backs the display up one step.</span></span>
    -   <span data-ttu-id="0ea32-217">Si un sous-menu est affiché, il est réduit et le focus se déplace vers le menu parent.</span><span class="sxs-lookup"><span data-stu-id="0ea32-217">If a submenu is displayed, it is collapsed and focus shifts to the parent menu.</span></span>
    -   <span data-ttu-id="0ea32-218">Si le menu d’un bouton est affiché, il est réduit et le suivi à chaud du menu est désactivé.</span><span class="sxs-lookup"><span data-stu-id="0ea32-218">If a button's menu is displayed, it is collapsed and menu hot-tracking is disabled.</span></span> <span data-ttu-id="0ea32-219">Le bouton de l’élément reste actif.</span><span class="sxs-lookup"><span data-stu-id="0ea32-219">The item's button remains active.</span></span>
    -   <span data-ttu-id="0ea32-220">Si aucun menu n’est affiché, mais qu’un bouton est actif, le bouton est désactivé et le suivi de menu actif est désactivé.</span><span class="sxs-lookup"><span data-stu-id="0ea32-220">If no menus are displayed but a button is active, the button is deactivated and menu hot-tracking is disabled.</span></span>
-   <span data-ttu-id="0ea32-221">Les touches de direction haut et bas permettent uniquement de naviguer dans un menu particulier.</span><span class="sxs-lookup"><span data-stu-id="0ea32-221">The UP ARROW and DOWN ARROW keys are used only to navigate within a particular menu.</span></span>
-   <span data-ttu-id="0ea32-222">La touche entrée lance la commande associée à un élément de menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-222">The ENTER key launches the command associated with a menu item.</span></span> <span data-ttu-id="0ea32-223">Si l’élément de menu a un sous-menu, la touche entrée l’affiche.</span><span class="sxs-lookup"><span data-stu-id="0ea32-223">If the menu item has a submenu, the ENTER key displays it.</span></span>

<span data-ttu-id="0ea32-224">Comme avec le cas où le suivi des menus est désactivé, votre application doit être en mesure de gérer la souris, le clavier et la navigation mixte.</span><span class="sxs-lookup"><span data-stu-id="0ea32-224">As with the menu hot-tracking disabled case, your application must be able to handle mouse, keyboard, and mixed navigation.</span></span> <span data-ttu-id="0ea32-225">Toutefois, le fait qu’un menu s’affiche signifie que la messagerie doit être traitée un peu différemment.</span><span class="sxs-lookup"><span data-stu-id="0ea32-225">However, the fact that a menu is displayed means that messaging will have to be handled somewhat differently.</span></span>

### <a name="message-processing-for-menu-hot-tracking"></a><span data-ttu-id="0ea32-226">Traitement des messages pour les Hot-Tracking de menu</span><span class="sxs-lookup"><span data-stu-id="0ea32-226">Message Processing for Menu Hot-Tracking</span></span>

<span data-ttu-id="0ea32-227">Le suivi à chaud du menu requiert qu’un menu s’affiche en permanence, à l’exception du bref intervalle requis pour basculer vers un nouveau menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-227">Menu hot-tracking requires that a menu be displayed at all times, apart from the brief interval required to switch to a new menu.</span></span> <span data-ttu-id="0ea32-228">Toutefois, le menu déroulant qui s’affiche par [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) est modal.</span><span class="sxs-lookup"><span data-stu-id="0ea32-228">However, the drop-down menu that is displayed by [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) is modal.</span></span> <span data-ttu-id="0ea32-229">Votre application continuera à recevoir des messages directement, y compris les messages de [**\_ commande WM**](/windows/desktop/menurc/wm-command), [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md)et normal, tels que [**WM \_ MENUSELECT**](/windows/desktop/menurc/wm-menuselect).</span><span class="sxs-lookup"><span data-stu-id="0ea32-229">Your application will continue to receive some messages directly, including [**WM\_COMMAND**](/windows/desktop/menurc/wm-command), [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md), and normal menu-related messages such as [**WM\_MENUSELECT**](/windows/desktop/menurc/wm-menuselect).</span></span> <span data-ttu-id="0ea32-230">Toutefois, il ne recevra pas directement les messages de clavier ou de souris de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="0ea32-230">However, it will not receive low-level keyboard or mouse messages directly.</span></span> <span data-ttu-id="0ea32-231">Pour gérer les messages tels que [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), vous devez définir un raccordement de message pour intercepter les messages qui sont dirigés vers le menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-231">To handle messages such as [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), you must set a message hook to intercept messages that are directed to the menu.</span></span>

<span data-ttu-id="0ea32-232">Quand un menu déroulant s’affiche, définissez le hook de message en appelant la fonction [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) avec le paramètre *IDHOOK* défini sur WH \_ msgfilter.</span><span class="sxs-lookup"><span data-stu-id="0ea32-232">When a drop-down menu is displayed, set the message hook by calling the [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) function with the *idHook* parameter set to WH\_MSGFILTER.</span></span> <span data-ttu-id="0ea32-233">Tous les messages destinés au menu seront transmis à votre [procédure de raccordement](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="0ea32-233">All messages intended for the menu will be passed to your [hook procedure](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)).</span></span> <span data-ttu-id="0ea32-234">Par exemple, le fragment de code suivant définit un hook de message qui intercepte les messages qui vont dans un menu déroulant.</span><span class="sxs-lookup"><span data-stu-id="0ea32-234">For example, the following code fragment sets a message hook that will trap messages that are going to a drop-down menu.</span></span> <span data-ttu-id="0ea32-235">`MsgHook` nom de la procédure de raccordement et `hhookMsg` est le handle de la procédure.</span><span class="sxs-lookup"><span data-stu-id="0ea32-235">`MsgHook` is the name of the hook procedure, and `hhookMsg` is the handle to the procedure.</span></span>


```
hhookMsg = SetWindowsHookEx(WH_MSGFILTER, MsgHook, HINST_THISDLL, 0);
```



<span data-ttu-id="0ea32-236">Les messages de menu sont identifiés en définissant le paramètre *nCode* de la procédure de hook sur le \_ menu MSGF.</span><span class="sxs-lookup"><span data-stu-id="0ea32-236">Menu messages are identified by setting the hook procedure's *nCode* parameter to MSGF\_MENU.</span></span> <span data-ttu-id="0ea32-237">Le paramètre *lParam* pointera vers une structure [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) avec le message.</span><span class="sxs-lookup"><span data-stu-id="0ea32-237">The *lParam* parameter will point to a [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure with the message.</span></span> <span data-ttu-id="0ea32-238">Les détails des messages qui doivent être gérés, et comment, sont décrits dans le reste de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="0ea32-238">The details of which messages need to be handled, and how, are discussed in the remainder of this topic.</span></span>

<span data-ttu-id="0ea32-239">Votre application doit transmettre tous les messages au hook de message suivant en appelant la fonction [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) .</span><span class="sxs-lookup"><span data-stu-id="0ea32-239">Your application must pass all messages on to the next message hook by calling the [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) function.</span></span> <span data-ttu-id="0ea32-240">Vous devez également envoyer des messages de souris directement au contrôle ToolBar, en veillant à convertir toutes les coordonnées de point dans l’espace de coordonnées client de la barre d’outils.</span><span class="sxs-lookup"><span data-stu-id="0ea32-240">You must also send mouse messages directly to the toolbar control, making sure to convert any point coordinates to the toolbar client coordinate space.</span></span> <span data-ttu-id="0ea32-241">L’envoi des messages permet de s’assurer que le contrôle de barre d’outils reçoit les messages de souris appropriés.</span><span class="sxs-lookup"><span data-stu-id="0ea32-241">Sending the messages directly ensures that the toolbar control receives the appropriate mouse messages.</span></span> <span data-ttu-id="0ea32-242">Par exemple, la barre d’outils doit recevoir les messages de la [**\_ souris WM**](/windows/desktop/inputdev/wm-mousemove) pour effectuer un suivi à chaud de ses boutons.</span><span class="sxs-lookup"><span data-stu-id="0ea32-242">For instance, the toolbar needs to receive [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in order to hot-track its buttons.</span></span>

<span data-ttu-id="0ea32-243">Quand un nouveau bouton est activé, votre application doit réduire l’ancien menu déroulant avec un message [**WM \_ CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) et afficher un nouveau menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-243">When a new button is activated, your application must collapse the old drop-down menu with a [**WM\_CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) message, and display a new menu.</span></span> <span data-ttu-id="0ea32-244">Il doit également réduire le menu déroulant lorsque le focus est effectué à partir de la barre de menus avec la navigation au clavier ou en cliquant à l’extérieur de la zone de menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-244">It must also collapse the drop-down menu when focus is taken from the menu bar with keyboard navigation or by clicking outside the menu area.</span></span> <span data-ttu-id="0ea32-245">Chaque fois que vous réduisez un menu, vous devez libérer son hook de message à l’aide de la fonction [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) .</span><span class="sxs-lookup"><span data-stu-id="0ea32-245">Whenever you collapse a menu, you should free its message hook by using the [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) function.</span></span> <span data-ttu-id="0ea32-246">Si vous avez besoin d’afficher un autre menu déroulant, créez un nouveau hook de message.</span><span class="sxs-lookup"><span data-stu-id="0ea32-246">If you need to display another drop-down menu, create a new message hook.</span></span> <span data-ttu-id="0ea32-247">Quand une commande est lancée, le menu est réduit automatiquement, mais vous devez libérer explicitement le hook de message.</span><span class="sxs-lookup"><span data-stu-id="0ea32-247">When a command is launched, the menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="0ea32-248">L’exemple de code suivant libère le hook de message qui a été défini dans l’exemple précédent.</span><span class="sxs-lookup"><span data-stu-id="0ea32-248">The following code example frees the message hook that was set in the previous example.</span></span>


```
UnhookWindowsHookEx(hhookMsg);
```



### <a name="mouse-navigation"></a><span data-ttu-id="0ea32-249">Navigation de la souris</span><span class="sxs-lookup"><span data-stu-id="0ea32-249">Mouse Navigation</span></span>

<span data-ttu-id="0ea32-250">Lorsqu’un contrôle de barre d’outils normal effectue le suivi des boutons à chaud, il met en surbrillance le bouton actif et envoie une notification [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) à l’application chaque fois qu’un nouveau bouton est activé.</span><span class="sxs-lookup"><span data-stu-id="0ea32-250">When a normal toolbar control hot-tracks buttons, it highlights the active button and sends the application a [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification each time a new button is activated.</span></span> <span data-ttu-id="0ea32-251">Votre application est chargée d’afficher le menu déroulant approprié.</span><span class="sxs-lookup"><span data-stu-id="0ea32-251">Your application is responsible for displaying the appropriate drop-down menu.</span></span> <span data-ttu-id="0ea32-252">Elle doit :</span><span class="sxs-lookup"><span data-stu-id="0ea32-252">It must:</span></span>

-   <span data-ttu-id="0ea32-253">Gérez la [notification \_ HOTITEMCHANGE TBN](tbn-hotitemchange.md) pour effectuer le suivi du bouton actif.</span><span class="sxs-lookup"><span data-stu-id="0ea32-253">Handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="0ea32-254">Lorsque le bouton actif change, réduisez l’ancien menu et créez-en un nouveau.</span><span class="sxs-lookup"><span data-stu-id="0ea32-254">When the active button changes, collapse the old menu and create a new one.</span></span>
-   <span data-ttu-id="0ea32-255">Gérez la notification de [ \_ liste déroulante TBN](tbn-dropdown.md) qui est envoyée lorsque l’utilisateur clique sur un bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-255">Handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification that is sent when a button is clicked.</span></span> <span data-ttu-id="0ea32-256">Il doit ensuite réduire le menu et désactiver le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-256">It should then collapse the menu and disable menu hot-tracking.</span></span> <span data-ttu-id="0ea32-257">Le bouton reste actif.</span><span class="sxs-lookup"><span data-stu-id="0ea32-257">The button remains active.</span></span>
-   <span data-ttu-id="0ea32-258">Gérez les messages [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM \_ RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown)et [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) dans votre procédure de raccordement de message, afin d’assurer le suivi de la position de la souris.</span><span class="sxs-lookup"><span data-stu-id="0ea32-258">Handle the [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM\_RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown), and [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in your message hook procedure, to keep track of the mouse position.</span></span> <span data-ttu-id="0ea32-259">Si l’utilisateur clique sur le bouton de la souris en dehors de la zone de menu, réduisez le menu déroulant actuel, désactivez le suivi à chaud du menu et replacez la barre de menus à son état de préactivation.</span><span class="sxs-lookup"><span data-stu-id="0ea32-259">If the mouse is clicked outside the menu area, collapse the current drop-down menu, deactivate menu hot-tracking, and return the menu bar to its preactivation state.</span></span>
-   <span data-ttu-id="0ea32-260">Quand une commande de menu est lancée, désactiver le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-260">When a menu command is launched, disable menu hot-tracking.</span></span> <span data-ttu-id="0ea32-261">Le menu est réduit automatiquement, mais vous devez libérer explicitement le hook de message.</span><span class="sxs-lookup"><span data-stu-id="0ea32-261">The menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="0ea32-262">Vous devez également gérer la messagerie liée au menu, telle que le message [**WM \_ INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) envoyé lorsqu’un élément de menu doit afficher un sous-menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-262">You must also handle menu-related messaging, such as the [**WM\_INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) message that is sent when a menu item needs to display a submenu.</span></span> <span data-ttu-id="0ea32-263">Pour plus d’informations sur la gestion de ces messages, consultez [menus](/windows/desktop/menurc/menus).</span><span class="sxs-lookup"><span data-stu-id="0ea32-263">For a discussion of how to handle such messages, see [Menus](/windows/desktop/menurc/menus).</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="0ea32-264">Navigation au clavier</span><span class="sxs-lookup"><span data-stu-id="0ea32-264">Keyboard Navigation</span></span>

<span data-ttu-id="0ea32-265">Votre application doit traiter les messages de clavier dans la procédure de hook de message et agir sur ceux qui affectent le suivi chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-265">Your application must process keyboard messages in the message hook procedure and act on those that affect menu hot-tracking.</span></span> <span data-ttu-id="0ea32-266">Les pressions sur les touches suivantes doivent être gérées :</span><span class="sxs-lookup"><span data-stu-id="0ea32-266">The following key presses must be handled:</span></span>

-   <span data-ttu-id="0ea32-267">Touche ÉCHAP.</span><span class="sxs-lookup"><span data-stu-id="0ea32-267">The ESCAPE key.</span></span> <span data-ttu-id="0ea32-268">La touche Échap rétablit l’affichage d’un niveau.</span><span class="sxs-lookup"><span data-stu-id="0ea32-268">The ESCAPE key backs the display up one level.</span></span> <span data-ttu-id="0ea32-269">Si un sous-menu est affiché, il doit être réduit.</span><span class="sxs-lookup"><span data-stu-id="0ea32-269">If a submenu is being displayed, it must be collapsed.</span></span> <span data-ttu-id="0ea32-270">Si le menu principal d’un bouton s’affiche, réduisez-le et désactivez le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-270">If a button's primary menu is displayed, collapse it and disable menu hot-tracking.</span></span> <span data-ttu-id="0ea32-271">Le bouton reste actif.</span><span class="sxs-lookup"><span data-stu-id="0ea32-271">The button remains active.</span></span>
-   <span data-ttu-id="0ea32-272">Touche Droite.</span><span class="sxs-lookup"><span data-stu-id="0ea32-272">The RIGHT ARROW key.</span></span> <span data-ttu-id="0ea32-273">Si l’élément a un sous-menu, affichez-le.</span><span class="sxs-lookup"><span data-stu-id="0ea32-273">If the item has a submenu, display it.</span></span> <span data-ttu-id="0ea32-274">Si l’élément n’a pas de sous-menu, réduisez le menu et tous les sous-menus, activez le bouton suivant avec [**to \_ SETHOTITEM**](tb-sethotitem.md)et Affichez son menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-274">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="0ea32-275">Si le dernier bouton était actif au moment de la réception de cette notification, affichez le menu du premier bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-275">If the last button was active when this notification was received, display the menu for the first button.</span></span>
-   <span data-ttu-id="0ea32-276">Touche Gauche.</span><span class="sxs-lookup"><span data-stu-id="0ea32-276">The LEFT ARROW key.</span></span> <span data-ttu-id="0ea32-277">Si l’élément se trouve dans un sous-menu, réduisez-le et déplacez le focus vers son menu parent.</span><span class="sxs-lookup"><span data-stu-id="0ea32-277">If the item is in a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="0ea32-278">Si l’élément n’est pas un sous-menu, réduisez le menu, activez le bouton adjacent avec [**to \_ SETHOTITEM**](tb-sethotitem.md)et Affichez son menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-278">If the item is not a submenu, collapse the menu, activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="0ea32-279">Si le premier bouton était actif au moment de la réception de cette notification, affichez le menu du dernier bouton.</span><span class="sxs-lookup"><span data-stu-id="0ea32-279">If the first button was active when this notification was received, display the menu for the last button.</span></span>
-   <span data-ttu-id="0ea32-280">Les flèches haut et bas.</span><span class="sxs-lookup"><span data-stu-id="0ea32-280">The UP ARROW and DOWN ARROW keys.</span></span> <span data-ttu-id="0ea32-281">Ces clés sont utilisées pour naviguer dans un menu, mais n’affectent pas directement le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-281">These keys are used to navigate within a menu but do not directly affect menu hot-tracking.</span></span>
-   <span data-ttu-id="0ea32-282">Touche d’accès rapide de *touche* Alt.</span><span class="sxs-lookup"><span data-stu-id="0ea32-282">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="0ea32-283">Utilisez le message [**to \_ MAPACCELERATOR**](tb-mapaccelerator.md) pour déterminer le bouton auquel le caractère *clé* correspond.</span><span class="sxs-lookup"><span data-stu-id="0ea32-283">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="0ea32-284">Si elle correspond à un autre bouton que celui actuellement actif, réduisez le menu déroulant actuel, activez le nouveau bouton avec [**to \_ SETHOTITEM**](tb-sethotitem.md)et affichez le menu du bouton adjacent.</span><span class="sxs-lookup"><span data-stu-id="0ea32-284">If it corresponds to a different button than the currently active one, collapse the current drop-down menu, activate the new button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="0ea32-285">Si le *caractère clé* correspond au bouton actuellement affiché, réduisez le menu déroulant et désactivez le suivi à chaud du menu.</span><span class="sxs-lookup"><span data-stu-id="0ea32-285">If the *Key character* corresponds to the currently displayed button, collapse the drop-down menu and disable menu hot-tracking.</span></span> <span data-ttu-id="0ea32-286">Le bouton doit rester actif.</span><span class="sxs-lookup"><span data-stu-id="0ea32-286">The button should remain active.</span></span>

 

 