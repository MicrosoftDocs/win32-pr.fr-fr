---
description: Cette rubrique décrit la prise en charge des appareils multirésidents dans WSDAPI et fournit des recommandations d’implémentation pour les développeurs de clients et d’appareils.
ms.assetid: d30ed536-d477-4f50-8c80-aacc35f948b9
title: Implémentation d’un périphérique WSD multirésident
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ac3537b96a577db47419d55cb5c6f732f8f7906
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104210408"
---
# <a name="implementing-a-multi-homed-wsd-device"></a><span data-ttu-id="20c0a-103">Implémentation d’un périphérique WSD multirésident</span><span class="sxs-lookup"><span data-stu-id="20c0a-103">Implementing a Multi-Homed WSD Device</span></span>

<span data-ttu-id="20c0a-104">[WS-Discovery](https://specs.xmlsoap.org/ws/2005/04/discovery/ws-discovery.pdf) et le [profil de périphériques pour les services Web](https://specs.xmlsoap.org/ws/2006/02/devprof/) (DPWS) ne décrivent pas l’implémentation des appareils multirésidents.</span><span class="sxs-lookup"><span data-stu-id="20c0a-104">[WS-Discovery](https://specs.xmlsoap.org/ws/2005/04/discovery/ws-discovery.pdf) and the [Devices Profile for Web Services](https://specs.xmlsoap.org/ws/2006/02/devprof/) (DPWS) do not describe the implementation of multi-homed devices.</span></span> <span data-ttu-id="20c0a-105">Cette rubrique décrit la prise en charge des appareils multirésidents dans WSDAPI et fournit des recommandations d’implémentation pour les développeurs de clients et d’appareils.</span><span class="sxs-lookup"><span data-stu-id="20c0a-105">This topic describes multi-homed device support in WSDAPI, and provides implementation recommendations to client and device developers.</span></span> <span data-ttu-id="20c0a-106">Dans cette rubrique, on suppose que les messages de découverte sont envoyés sur IPv4 et IPv6 (le cas échéant) avec le même ID de message et les mêmes informations de séquencement d’application.</span><span class="sxs-lookup"><span data-stu-id="20c0a-106">In this topic, it is assumed that discovery messages are sent over both IPv4 and IPv6 (if available) with the same message ID and application sequencing information.</span></span>

## <a name="discovery-in-a-multi-homed-environment"></a><span data-ttu-id="20c0a-107">Découverte dans un environnement multirésident</span><span class="sxs-lookup"><span data-stu-id="20c0a-107">Discovery in a multi-homed environment</span></span>

<span data-ttu-id="20c0a-108">Comme mentionné dans la section [Hello](hello-message.md) et [XAddrs](xaddr-validation-rules.md) de la [fonctionnalité WS-Discovery supplémentaire](additional-ws-discovery-functionality.md), wsdapi ne fournit jamais XAddrs dans un message Hello.</span><span class="sxs-lookup"><span data-stu-id="20c0a-108">As mentioned in [Hello](hello-message.md) and [XAddrs](xaddr-validation-rules.md) section of [Additional WS-Discovery Functionality](additional-ws-discovery-functionality.md), WSDAPI never provides XAddrs in a Hello message.</span></span> <span data-ttu-id="20c0a-109">Cela signifie que le même message Hello peut être envoyé sur toutes les interfaces réseau avec le même ID de message et les mêmes informations de séquencement d’application.</span><span class="sxs-lookup"><span data-stu-id="20c0a-109">That means the same Hello message can be sent on all network interfaces with the same message ID and application sequencing information.</span></span> <span data-ttu-id="20c0a-110">Il est ainsi plus facile pour la détection de collision client d’ignorer plusieurs messages de salutation du même appareil lorsqu’un client et l’appareil partagent plusieurs sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="20c0a-110">This makes it easier for client collision detection to discard multiple Hello messages from the same device when a client and the device share more than one subnet.</span></span>

<span data-ttu-id="20c0a-111">Étant donné que les [XAddrs](xaddr-validation-rules.md) ne sont pas envoyés dans le message [Hello](hello-message.md) , les implémentations clientes doivent envoyer un message de [résolution](resolve-message.md) pour obtenir l’adresse d’appareil appropriée.</span><span class="sxs-lookup"><span data-stu-id="20c0a-111">Because the [XAddrs](xaddr-validation-rules.md) are not sent in the [Hello](hello-message.md) message, client implementations must send a [Resolve](resolve-message.md) message to get the relevant device address.</span></span> <span data-ttu-id="20c0a-112">La résolution doit être envoyée sur toutes les interfaces clientes avec le même ID de message, et l’appareil doit filtrer les messages en double en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="20c0a-112">The Resolve should be sent on all client interfaces with the same message ID, and the device should filter duplicate messages as needed.</span></span> <span data-ttu-id="20c0a-113">L’utilisation du même ID de message pour le message de résolution permet à l’appareil de choisir une interface préférée pour communiquer avec les clients, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="20c0a-113">Using the same message ID for the Resolve message allows the device to pick a preferred interface for communicating with clients if necessary.</span></span>

<span data-ttu-id="20c0a-114">Lors de l’envoi d’un message [ResolveMatch](resolvematches-message.md) , un appareil doit fournir des [XAddrs](xaddr-validation-rules.md) qui se rapportent à l’interface réseau sur laquelle il diffuse le message.</span><span class="sxs-lookup"><span data-stu-id="20c0a-114">When sending a [ResolveMatch](resolvematches-message.md) message, a device should provide [XAddrs](xaddr-validation-rules.md) that relate to the network interface over which it is unicasting the message.</span></span> <span data-ttu-id="20c0a-115">Cette pratique permet d’éviter plusieurs tentatives de connexion au client et une logique de nouvelle tentative compliquée.</span><span class="sxs-lookup"><span data-stu-id="20c0a-115">This practice helps to avoid multiple client connection attempts and complicated retry logic.</span></span>

## <a name="metadata-exchange-in-a-multi-homed-environment"></a><span data-ttu-id="20c0a-116">Échange de métadonnées dans un environnement multirésident</span><span class="sxs-lookup"><span data-stu-id="20c0a-116">Metadata exchange in a multi-homed environment</span></span>

<span data-ttu-id="20c0a-117">Il est plus difficile d’implémenter l’échange de métadonnées dans un environnement multirésident que d’implémenter la découverte en raison du contrôle de version des métadonnées.</span><span class="sxs-lookup"><span data-stu-id="20c0a-117">Implementing metadata exchange in a multi-homed environment is more difficult than implementing discovery because of metadata versioning.</span></span> <span data-ttu-id="20c0a-118">Si un client demande des métadonnées sur plusieurs interfaces, le client peut recevoir plusieurs messages [GetResponse](getresponse--metadata-exchange--message.md) sur différentes interfaces.</span><span class="sxs-lookup"><span data-stu-id="20c0a-118">If a client requests metadata over multiple interfaces, then the client can receive multiple [GetResponse](getresponse--metadata-exchange--message.md) messages over different interfaces.</span></span> <span data-ttu-id="20c0a-119">Ces messages GetResponse peuvent contenir différentes sections de métadonnées de **relation** avec la même version de métadonnées.</span><span class="sxs-lookup"><span data-stu-id="20c0a-119">These GetResponse messages can contain different **Relationship** metadata sections with the same metadata version.</span></span> <span data-ttu-id="20c0a-120">Cela réduit la valeur du numéro de version des métadonnées.</span><span class="sxs-lookup"><span data-stu-id="20c0a-120">This reduces the value of the metadata version number.</span></span>

<span data-ttu-id="20c0a-121">Il existe une autre approche, où un seul message [GetResponse](getresponse--metadata-exchange--message.md) est envoyé en réponse à toutes les adresses du service.</span><span class="sxs-lookup"><span data-stu-id="20c0a-121">There is an alternative approach, where a single [GetResponse](getresponse--metadata-exchange--message.md) message is sent in response with all addresses for the service.</span></span> <span data-ttu-id="20c0a-122">L’inconvénient de cette méthode est que des informations privées, telles que la topologie de réseaux indirectement accessibles, peuvent être divulguées.</span><span class="sxs-lookup"><span data-stu-id="20c0a-122">The disadvantage of this method is that private information, such as the topology of indirectly accessible networks, may be disclosed.</span></span>

<span data-ttu-id="20c0a-123">Sur Windows Vista, les métadonnées fournies par WSDAPI contiennent uniquement les adresses valides pour l’interface sur laquelle la demande de métadonnées a été reçue.</span><span class="sxs-lookup"><span data-stu-id="20c0a-123">On Windows Vista, the metadata provided by WSDAPI contains only addresses that are valid for the interface upon which the metadata request was received.</span></span>

 

 



