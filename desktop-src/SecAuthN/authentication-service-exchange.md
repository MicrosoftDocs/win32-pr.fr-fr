---
description: L’utilisateur commence à ouvrir une session sur le réseau en tapant un nom d’ouverture de session et un mot de passe. Le client Kerberos sur la station de travail de l’utilisateur convertit le mot de passe en une clé de chiffrement et enregistre le résultat dans une variable de programme.
ms.assetid: fcb3b601-9953-474c-9a08-1fa25706f3d7
title: Échange de service d'authentification
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c14121ed33ae0ac169c590b03dfb0b395306d11f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106544927"
---
# <a name="authentication-service-exchange"></a><span data-ttu-id="0f3fe-104">Échange de service d'authentification</span><span class="sxs-lookup"><span data-stu-id="0f3fe-104">Authentication Service Exchange</span></span>

<span data-ttu-id="0f3fe-105">L’utilisateur commence à ouvrir une session sur le réseau en tapant un nom d’ouverture de session et un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-105">The user begins logging on to the network by typing a logon name and password.</span></span> <span data-ttu-id="0f3fe-106">Le client [*Kerberos*](/windows/desktop/SecGloss/k-gly) sur la station de travail de l’utilisateur convertit le mot de passe en une clé de chiffrement et enregistre le résultat dans une variable de programme.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-106">The [*Kerberos*](/windows/desktop/SecGloss/k-gly) client on the user's workstation converts the password to an encryption key and saves the result in a program variable.</span></span>

<span data-ttu-id="0f3fe-107">Le client demande ensuite des [*informations d’identification*](/windows/desktop/SecGloss/c-gly) pour le TGS (Ticket-Granting Service) du [*Centre de distribution de clés*](/windows/desktop/SecGloss/k-gly) (KDC) en envoyant au service d’authentification du KDC un message de type KRB \_ comme \_ req (demande de service d’authentification Kerberos).</span><span class="sxs-lookup"><span data-stu-id="0f3fe-107">The client then requests [*credentials*](/windows/desktop/SecGloss/c-gly) for the ticket-granting service (TGS) of the [*Key Distribution Center*](/windows/desktop/SecGloss/k-gly) (KDC) by sending the KDC's authentication service a message of type KRB\_AS\_REQ (Kerberos Authentication Service Request).</span></span> <span data-ttu-id="0f3fe-108">La première partie de ce message identifie l’utilisateur et le service TGS demandé.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-108">The first part of this message identifies the user and the TGS service being requested.</span></span> <span data-ttu-id="0f3fe-109">La deuxième partie de ce message contient des données de pré-authentification destinées à prouver que l’utilisateur connaît le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-109">The second part of this message contains preauthentication data intended to prove that the user knows the password.</span></span> <span data-ttu-id="0f3fe-110">Il s’agit simplement d’un message d’authentificateur chiffré avec la [*clé principale*](/windows/desktop/SecGloss/m-gly) dérivée du mot de passe d’ouverture de session de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-110">This is simply an authenticator message that is encrypted with the [*master key*](/windows/desktop/SecGloss/m-gly) derived from the user's logon password.</span></span>

<span data-ttu-id="0f3fe-111">Lorsque le KDC reçoit le KRB \_ comme \_ req, il recherche l’utilisateur dans sa base de données, obtient la clé principale de l’utilisateur associé, déchiffre les données de pré-authentification et évalue l’horodatage à l’intérieur de.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-111">When the KDC receives KRB\_AS\_REQ, it looks up the user in its database, gets the associated user's master key, decrypts the preauthentication data, and evaluates the time stamp inside.</span></span> <span data-ttu-id="0f3fe-112">Si l’horodatage est valide, le KDC peut être certain que les données de pré-authentification ont été chiffrées à l’aide de la clé principale de l’utilisateur et que le client est donc authentique.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-112">If the time stamp is valid, the KDC can be assured that the preauthentication data was encrypted with the user's master key and thus that the client is genuine.</span></span>

<span data-ttu-id="0f3fe-113">Une fois que le KDC a vérifié l’identité de l’utilisateur, il crée des informations d’identification que le client peut présenter au TGS, comme suit :</span><span class="sxs-lookup"><span data-stu-id="0f3fe-113">After the KDC has verified the user's identity, it creates credentials that the client can present to the TGS, as follows:</span></span>

1.  <span data-ttu-id="0f3fe-114">Le KDC invente une clé de [*session*](/windows/desktop/SecGloss/s-gly) de connexion et chiffre une copie avec la clé principale de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-114">The KDC invents a logon [*session key*](/windows/desktop/SecGloss/s-gly) and encrypts a copy with the user's master key.</span></span>
2.  <span data-ttu-id="0f3fe-115">Le centre de distribution de clés incorpore une autre copie de la clé de session de connexion et les données d’autorisation de l’utilisateur dans un ticket TGT (Ticket-Granting Ticket) et chiffre le ticket TGT avec la propre clé principale du KDC.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-115">The KDC embeds another copy of the logon session key and the user's authorization data in a ticket-granting ticket (TGT), and encrypts the TGT with the KDC's own master key.</span></span>
3.  <span data-ttu-id="0f3fe-116">Le KDC renvoie ces informations d’identification au client en répondant avec un message de type KRB \_ As \_ Rep (Kerberos Authentication Service Reply).</span><span class="sxs-lookup"><span data-stu-id="0f3fe-116">The KDC sends these credentials back to the client by replying with a message of type KRB\_AS\_REP (Kerberos Authentication Service Reply).</span></span>
4.  <span data-ttu-id="0f3fe-117">Lorsque le client reçoit la réponse, il utilise la clé dérivée du mot de passe de l’utilisateur pour déchiffrer la nouvelle clé de session de connexion.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-117">When the client receives the reply, it uses the key derived from the user's password to decrypt the new logon session key.</span></span>
5.  <span data-ttu-id="0f3fe-118">Le client stocke la nouvelle clé dans son cache de tickets.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-118">The client stores the new key in its ticket cache.</span></span>
6.  <span data-ttu-id="0f3fe-119">Le client extrait le ticket TGT du message et le stocke également dans son cache de tickets.</span><span class="sxs-lookup"><span data-stu-id="0f3fe-119">The client extracts the TGT from the message and stores that in its ticket cache as well.</span></span>

 

 
