---
description: Initialisation du contexte client
ms.assetid: 0c8aad3e-e726-49ce-8fc9-94dbd60cc5cb
title: Initialisation du contexte client
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 615ce5c157371f1ebfec685d6227bd11a1d76531
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104114947"
---
# <a name="client-context-initialization"></a><span data-ttu-id="5993c-103">Initialisation du contexte client</span><span class="sxs-lookup"><span data-stu-id="5993c-103">Client Context Initialization</span></span>

<span data-ttu-id="5993c-104">Pour établir une connexion sécurisée, le client acquiert un handle [*d’informations d’identification*](/windows/desktop/SecGloss/c-gly) sortantes avant d’envoyer une demande d’authentification au serveur.</span><span class="sxs-lookup"><span data-stu-id="5993c-104">To establish a secure connection, the client acquires an outbound [*credentials*](/windows/desktop/SecGloss/c-gly) handle before sending an authentication request to the server.</span></span> <span data-ttu-id="5993c-105">Le serveur crée un contexte de sécurité pour le client à partir de la demande d’authentification.</span><span class="sxs-lookup"><span data-stu-id="5993c-105">The server creates a security context for the client from the authentication request.</span></span> <span data-ttu-id="5993c-106">Deux fonctions SSPI côté client sont impliquées dans la configuration de l’authentification :</span><span class="sxs-lookup"><span data-stu-id="5993c-106">There are two client-side SSPI functions involved in authentication setup:</span></span>

-   <span data-ttu-id="5993c-107">[**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) obtient une référence aux [*informations d’identification*](/windows/desktop/SecGloss/c-gly)d’ouverture de session précédemment obtenues.</span><span class="sxs-lookup"><span data-stu-id="5993c-107">[**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) obtains a reference to previously obtained logon [*credentials*](/windows/desktop/SecGloss/c-gly).</span></span>
-   <span data-ttu-id="5993c-108">[**InitializeSecurityContext (général)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) crée les jetons de sécurité de la demande d’authentification initiale.</span><span class="sxs-lookup"><span data-stu-id="5993c-108">[**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) creates the initial authentication request security tokens.</span></span>

<span data-ttu-id="5993c-109">Vous pouvez voir le code de ce processus dans la fonction **GenClientContext** de l' [utilisation de SSPI avec un client Windows Sockets](using-sspi-with-a-windows-sockets-client.md).</span><span class="sxs-lookup"><span data-stu-id="5993c-109">Code for this process can be seen in the **GenClientContext** function in [Using SSPI with a Windows Sockets Client](using-sspi-with-a-windows-sockets-client.md).</span></span>

<span data-ttu-id="5993c-110">Si un programme client doit utiliser des informations d’identification en plus de ses propres informations d’identification d’ouverture de session, telles qu’un nom d’utilisateur, un nom de domaine et un mot de passe différents, il les fournit dans l’appel [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) avec une structure d’identité de l' [**\_ \_ authentification \_ winnt**](/windows/win32/api/sspi/ns-sspi-sec_winnt_auth_identity_a) , en spécifiant les informations d’identification supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="5993c-110">If a client program needs to use credentials in addition to its own logon credentials, such as a different user name, domain name, and password, it provides them in the [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) call with a [**SEC\_WINNT\_AUTH\_IDENTITY**](/windows/win32/api/sspi/ns-sspi-sec_winnt_auth_identity_a) structure specifying the additional credentials.</span></span> <span data-ttu-id="5993c-111">Pour plus d’informations sur les fonctions d’informations d’identification, consultez [gestion des informations d’identification](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="5993c-111">For more information on credentials functions, see [Credential Management](authentication-functions.md).</span></span>

> [!Note]  
> <span data-ttu-id="5993c-112">Le membre **Flags** de la structure de l' [**\_ \_ \_ identité d’authentification Winnt**](/windows/win32/api/sspi/ns-sspi-sec_winnt_auth_identity_a) de la sec peut être défini sur sec \_ winnt \_ \_ Identity \_ ANSI lorsque les chaînes de la structure sont ASCI ou OEM.</span><span class="sxs-lookup"><span data-stu-id="5993c-112">The **Flags** member of the [**SEC\_WINNT\_AUTH\_IDENTITY**](/windows/win32/api/sspi/ns-sspi-sec_winnt_auth_identity_a) structure can be set to SEC\_WINNT\_AUTH\_IDENTITY\_ANSI when strings in the structure are ASCI or OEM.</span></span> <span data-ttu-id="5993c-113">Les chaînes ANSI peuvent être utilisées avec le membre **Flags** de la seconde structure d' **\_ \_ \_ identité d’authentification Winnt** avec la valeur s \_ winnt \_ \_ Identity \_ Unicode Unicode si elles sont d’abord converties en [*Unicode*](/windows/desktop/SecGloss/u-gly) à l’aide de la fonction [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) .</span><span class="sxs-lookup"><span data-stu-id="5993c-113">ANSI strings can be used with the **Flags** member of the **SEC\_WINNT\_AUTH\_IDENTITY** structure set to SEC\_WINNT\_AUTH\_IDENTITY\_UNICODE if they are first converted to [*Unicode*](/windows/desktop/SecGloss/u-gly) by using the [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) function.</span></span>

 

<span data-ttu-id="5993c-114">Pour initier la première branche de l’authentification, le client appelle [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) pour obtenir un jeton de sécurité initial à envoyer dans un message de demande de connexion au serveur.</span><span class="sxs-lookup"><span data-stu-id="5993c-114">To initiate the first leg of the authentication, the client calls [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) to obtain an initial security token to be sent in a connection request message to the server.</span></span>

<span data-ttu-id="5993c-115">Le client utilise les informations de jeton de sécurité reçues dans le descripteur de mémoire tampon de sortie pour générer un message à envoyer au serveur.</span><span class="sxs-lookup"><span data-stu-id="5993c-115">The client uses the security token information received in the output buffer descriptor to generate a message to send to the server.</span></span> <span data-ttu-id="5993c-116">La construction du message, en termes de positionnement de plusieurs mémoires tampons, et ainsi de suite, fait partie du [*protocole d’application*](/windows/desktop/SecGloss/a-gly) et doit être comprise par les deux parties.</span><span class="sxs-lookup"><span data-stu-id="5993c-116">The construction of the message, in terms of placement of various buffers and so forth, is part of the [*application protocol*](/windows/desktop/SecGloss/a-gly) and must be understood by both parties.</span></span>

<span data-ttu-id="5993c-117">Le client vérifie l’état de retour de [**InitializeSecurityContext (général)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) pour déterminer si l’authentification se termine en un seul appel.</span><span class="sxs-lookup"><span data-stu-id="5993c-117">The client checks the return status from [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) to see if authentication will complete in a single call.</span></span> <span data-ttu-id="5993c-118">Un état de retour de SEC \_ je \_ continue \_ requis indique que le protocole de sécurité nécessite plusieurs messages d’authentification.</span><span class="sxs-lookup"><span data-stu-id="5993c-118">A return status of SEC\_I\_CONTINUE\_NEEDED indicates that the security protocol requires multiple authentication messages.</span></span> <span data-ttu-id="5993c-119">Pour plus d’informations sur les fonctions de contexte, consultez [gestion du contexte](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="5993c-119">For more information on context functions, see [Context Management](authentication-functions.md).</span></span>

 

 
