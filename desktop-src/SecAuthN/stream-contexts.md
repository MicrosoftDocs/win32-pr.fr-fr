---
description: Les contextes de flux gèrent les protocoles orientés flux sécurisés, tels que SSL ou PCT.
ms.assetid: 05a6b036-1f7f-473f-9813-a1e1534e0f0d
title: Contextes de flux
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53103dc1269c05e5a2c162133d21e167d8035c2c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951596"
---
# <a name="stream-contexts"></a><span data-ttu-id="42d54-103">Contextes de flux</span><span class="sxs-lookup"><span data-stu-id="42d54-103">Stream Contexts</span></span>

<span data-ttu-id="42d54-104">Les contextes de flux gèrent les protocoles orientés flux sécurisés, tels que SSL ou PCT.</span><span class="sxs-lookup"><span data-stu-id="42d54-104">Stream contexts handle the secure stream-oriented protocols such as SSL or PCT.</span></span> <span data-ttu-id="42d54-105">Dans l’intérêt du partage de la même interface et de la gestion des informations d’identification similaires, SSPI assure la prise en charge des contextes de flux.</span><span class="sxs-lookup"><span data-stu-id="42d54-105">In the interest of sharing the same interface and similar credential management, SSPI provides support for stream contexts.</span></span> <span data-ttu-id="42d54-106">Le [*protocole de sécurité*](../secgloss/s-gly.md) intègre le schéma d’authentification et les formats d’enregistrement du flux.</span><span class="sxs-lookup"><span data-stu-id="42d54-106">The [*security protocol*](../secgloss/s-gly.md) incorporates both the stream authentication scheme and record formats.</span></span>

<span data-ttu-id="42d54-107">Pour fournir des protocoles orientés flux, les [*packages de sécurité*](../secgloss/s-gly.md) qui prennent en charge les contextes de flux présentent les caractéristiques de processus suivantes :</span><span class="sxs-lookup"><span data-stu-id="42d54-107">To provide stream-oriented protocols, [*security packages*](../secgloss/s-gly.md) that support stream contexts have the following process characteristics:</span></span>

-   <span data-ttu-id="42d54-108">Le package définit l' \_ \_ indicateur de flux de l’indicateur SECPKG pour indiquer qu’il prend en charge la sémantique de flux.</span><span class="sxs-lookup"><span data-stu-id="42d54-108">The package sets the SECPKG\_FLAG\_STREAM flag to indicate that it supports stream semantics.</span></span>
-   <span data-ttu-id="42d54-109">Les applications de transport demandent la sémantique de flux en définissant les indicateurs du flux de demande ISC \_ \_ et du \_ \_ flux de demande ASC dans les appels aux fonctions [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) et [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="42d54-109">Transport applications requests stream semantics by setting the ISC\_REQ\_STREAM and ASC\_REQ\_STREAM flags in the calls to the [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) and [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) functions.</span></span>
-   <span data-ttu-id="42d54-110">L’application appelle la fonction [**QueryContextAttributes (général)**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) avec une structure [**SecPkgContext \_ StreamSizes**](/windows/desktop/api/Sspi/ns-sspi-secpkgcontext_streamsizes) pour interroger le contexte de [*sécurité*](../secgloss/s-gly.md) en fonction du nombre de mémoires tampons à fournir et des tailles à réserver pour les en-têtes ou les codes de fin.</span><span class="sxs-lookup"><span data-stu-id="42d54-110">The application calls the [**QueryContextAttributes (General)**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) function with a [**SecPkgContext\_StreamSizes**](/windows/desktop/api/Sspi/ns-sspi-secpkgcontext_streamsizes) structure to query the [*security context*](../secgloss/s-gly.md) for the number of buffers to provide and the sizes to reserve for headers or trailers.</span></span>
-   <span data-ttu-id="42d54-111">L’application fournit des descripteurs de mémoire tampon à Spare pendant le traitement réel des données.</span><span class="sxs-lookup"><span data-stu-id="42d54-111">The application provides buffer descriptors to spare during the actual processing of the data.</span></span> <span data-ttu-id="42d54-112">En spécifiant la sémantique de flux, l’appelant indique la volonté d’effectuer un traitement supplémentaire afin que le [*package de sécurité*](../secgloss/s-gly.md) puisse gérer le blocage des messages.</span><span class="sxs-lookup"><span data-stu-id="42d54-112">By specifying stream semantics, the caller indicates willingness to do extra processing so that the [*security package*](../secgloss/s-gly.md) can handle the blocking of the messages.</span></span> <span data-ttu-id="42d54-113">Par essence, pour les fonctions [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) et [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) , l’appelant transmet une liste de mémoires tampons.</span><span class="sxs-lookup"><span data-stu-id="42d54-113">In essence, for the [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) and [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) functions, the caller passes in a list of buffers.</span></span> <span data-ttu-id="42d54-114">Lorsqu’un message est reçu d’un canal orienté en continu (par exemple, un port TCP), l’appelant passe dans une liste de tampons comme suit.</span><span class="sxs-lookup"><span data-stu-id="42d54-114">When a message is received from a channel that is stream-oriented (such as a TCP port), the caller passes in a buffer list as follows.</span></span>

    | <span data-ttu-id="42d54-115">Buffer</span><span class="sxs-lookup"><span data-stu-id="42d54-115">Buffer</span></span> | <span data-ttu-id="42d54-116">Longueur</span><span class="sxs-lookup"><span data-stu-id="42d54-116">Length</span></span>         | <span data-ttu-id="42d54-117">Type de mémoire tampon</span><span class="sxs-lookup"><span data-stu-id="42d54-117">Buffer type</span></span>      |
    |--------|----------------|------------------|
    | <span data-ttu-id="42d54-118">1</span><span class="sxs-lookup"><span data-stu-id="42d54-118">1</span></span>      | <span data-ttu-id="42d54-119">Longueur du message</span><span class="sxs-lookup"><span data-stu-id="42d54-119">Message Length</span></span> | <span data-ttu-id="42d54-120">\_données SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="42d54-120">SECBUFFER\_DATA</span></span>  |
    | <span data-ttu-id="42d54-121">2</span><span class="sxs-lookup"><span data-stu-id="42d54-121">2</span></span>      | <span data-ttu-id="42d54-122">0</span><span class="sxs-lookup"><span data-stu-id="42d54-122">0</span></span>              | <span data-ttu-id="42d54-123">SECBUFFER \_ vide</span><span class="sxs-lookup"><span data-stu-id="42d54-123">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="42d54-124">3</span><span class="sxs-lookup"><span data-stu-id="42d54-124">3</span></span>      | <span data-ttu-id="42d54-125">0</span><span class="sxs-lookup"><span data-stu-id="42d54-125">0</span></span>              | <span data-ttu-id="42d54-126">SECBUFFER \_ vide</span><span class="sxs-lookup"><span data-stu-id="42d54-126">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="42d54-127">4</span><span class="sxs-lookup"><span data-stu-id="42d54-127">4</span></span>      | <span data-ttu-id="42d54-128">0</span><span class="sxs-lookup"><span data-stu-id="42d54-128">0</span></span>              | <span data-ttu-id="42d54-129">SECBUFFER \_ vide</span><span class="sxs-lookup"><span data-stu-id="42d54-129">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="42d54-130">5</span><span class="sxs-lookup"><span data-stu-id="42d54-130">5</span></span>      | <span data-ttu-id="42d54-131">0</span><span class="sxs-lookup"><span data-stu-id="42d54-131">0</span></span>              | <span data-ttu-id="42d54-132">SECBUFFER \_ vide</span><span class="sxs-lookup"><span data-stu-id="42d54-132">SECBUFFER\_EMPTY</span></span> |

    

     

    <span data-ttu-id="42d54-133">Le package de sécurité fonctionne alors sur l' [*objet BLOB*](../secgloss/b-gly.md).</span><span class="sxs-lookup"><span data-stu-id="42d54-133">The security package then works on the [*BLOB*](../secgloss/b-gly.md).</span></span> <span data-ttu-id="42d54-134">Si la fonction est correctement retournée, la liste de mémoires tampons se présente comme suit.</span><span class="sxs-lookup"><span data-stu-id="42d54-134">If the function returns successfully, the buffer list looks like the following.</span></span>

    

    | <span data-ttu-id="42d54-135">Buffer</span><span class="sxs-lookup"><span data-stu-id="42d54-135">Buffer</span></span> | <span data-ttu-id="42d54-136">Longueur</span><span class="sxs-lookup"><span data-stu-id="42d54-136">Length</span></span>         | <span data-ttu-id="42d54-137">Type de mémoire tampon</span><span class="sxs-lookup"><span data-stu-id="42d54-137">Buffer type</span></span>                |
    |--------|----------------|----------------------------|
    | <span data-ttu-id="42d54-138">1</span><span class="sxs-lookup"><span data-stu-id="42d54-138">1</span></span>      | <span data-ttu-id="42d54-139">Longueur de l’en-tête</span><span class="sxs-lookup"><span data-stu-id="42d54-139">Header Length</span></span>  | <span data-ttu-id="42d54-140">\_ \_ en-tête de flux SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="42d54-140">SECBUFFER\_STREAM\_HEADER</span></span>  |
    | <span data-ttu-id="42d54-141">2</span><span class="sxs-lookup"><span data-stu-id="42d54-141">2</span></span>      | <span data-ttu-id="42d54-142">Longueur des données</span><span class="sxs-lookup"><span data-stu-id="42d54-142">Data Length</span></span>    | <span data-ttu-id="42d54-143">\_données SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="42d54-143">SECBUFFER\_DATA</span></span>            |
    | <span data-ttu-id="42d54-144">3</span><span class="sxs-lookup"><span data-stu-id="42d54-144">3</span></span>      | <span data-ttu-id="42d54-145">Longueur de la remorque</span><span class="sxs-lookup"><span data-stu-id="42d54-145">Trailer Length</span></span> | <span data-ttu-id="42d54-146">Code de fin de \_ flux SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="42d54-146">SECBUFFER\_STREAM\_TRAILER</span></span> |
    | <span data-ttu-id="42d54-147">4</span><span class="sxs-lookup"><span data-stu-id="42d54-147">4</span></span>      | <span data-ttu-id="42d54-148">0</span><span class="sxs-lookup"><span data-stu-id="42d54-148">0</span></span>              | <span data-ttu-id="42d54-149">SECBUFFER \_ vide</span><span class="sxs-lookup"><span data-stu-id="42d54-149">SECBUFFER\_EMPTY</span></span>           |
    | <span data-ttu-id="42d54-150">5</span><span class="sxs-lookup"><span data-stu-id="42d54-150">5</span></span>      | <span data-ttu-id="42d54-151">0</span><span class="sxs-lookup"><span data-stu-id="42d54-151">0</span></span>              | <span data-ttu-id="42d54-152">SECBUFFER \_ vide</span><span class="sxs-lookup"><span data-stu-id="42d54-152">SECBUFFER\_EMPTY</span></span>           |

    

     

    <span data-ttu-id="42d54-153">Le package aurait peut-être également retourné buffer \# 4 avec la longueur x et le type de tampon SECBUFFER, \_ indiquant que les données de ce tampon font partie de l’enregistrement suivant et n’ont pas encore été traitées.</span><span class="sxs-lookup"><span data-stu-id="42d54-153">The package could have also returned buffer \#4 with length x and buffer type SECBUFFER\_EXTRA indicating that the data in this buffer is part of the next record and has not yet been processed.</span></span> <span data-ttu-id="42d54-154">À l’inverse, si la fonction de message retourne le \_ code d’erreur sec E \_ message incomplet \_ , la liste de tampons retournée ressemble à ce qui suit.</span><span class="sxs-lookup"><span data-stu-id="42d54-154">Conversely, if the message function returns the SEC\_E\_INCOMPLETE\_MESSAGE error code, the returned buffer list would look like the following.</span></span>

    

    | <span data-ttu-id="42d54-155">Buffer</span><span class="sxs-lookup"><span data-stu-id="42d54-155">Buffer</span></span> | <span data-ttu-id="42d54-156">Longueur</span><span class="sxs-lookup"><span data-stu-id="42d54-156">Length</span></span> | <span data-ttu-id="42d54-157">Type de mémoire tampon</span><span class="sxs-lookup"><span data-stu-id="42d54-157">Buffer type</span></span>        |
    |--------|--------|--------------------|
    | <span data-ttu-id="42d54-158">1</span><span class="sxs-lookup"><span data-stu-id="42d54-158">1</span></span>      | <span data-ttu-id="42d54-159">x</span><span class="sxs-lookup"><span data-stu-id="42d54-159">x</span></span>      | <span data-ttu-id="42d54-160">SECBUFFER \_ manquant</span><span class="sxs-lookup"><span data-stu-id="42d54-160">SECBUFFER\_MISSING</span></span> |

    

     

    <span data-ttu-id="42d54-161">Cela indique qu’un plus grand nombre de données était nécessaire pour traiter l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="42d54-161">This indicates that more data was needed to process the record.</span></span> <span data-ttu-id="42d54-162">Contrairement à la plupart des erreurs retournées par une fonction de message, ce type de mémoire tampon n’indique pas que le contexte a été compromis.</span><span class="sxs-lookup"><span data-stu-id="42d54-162">Unlike most errors returned from a message function, this buffer type does not indicate that the context has been compromised.</span></span> <span data-ttu-id="42d54-163">Au lieu de cela, cela indique qu’un plus grand nombre de données est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="42d54-163">Instead, it indicates that more data is needed.</span></span> <span data-ttu-id="42d54-164">les [*packages de sécurité*](../secgloss/s-gly.md) ne doivent pas mettre à jour leur [*État*](../secgloss/s-gly.md) dans cette condition.</span><span class="sxs-lookup"><span data-stu-id="42d54-164">[*security packages*](../secgloss/s-gly.md) must not update their [*state*](../secgloss/s-gly.md) in this condition.</span></span>

    <span data-ttu-id="42d54-165">De même, du côté de l’expéditeur de la communication, l’appelant peut appeler la fonction [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) .</span><span class="sxs-lookup"><span data-stu-id="42d54-165">Similarly, on the sender side of the communication, the caller can call the [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) function.</span></span> <span data-ttu-id="42d54-166">Le package de sécurité doit peut-être réallouer la mémoire tampon ou copier des éléments.</span><span class="sxs-lookup"><span data-stu-id="42d54-166">The security package may need to reallocate the buffer or copy things around.</span></span> <span data-ttu-id="42d54-167">L’appelant peut être plus efficace en fournissant une liste de tampons comme suit.</span><span class="sxs-lookup"><span data-stu-id="42d54-167">The caller can be more efficient by providing a buffer list as follows.</span></span>

    

    | <span data-ttu-id="42d54-168">Buffer</span><span class="sxs-lookup"><span data-stu-id="42d54-168">Buffer</span></span> | <span data-ttu-id="42d54-169">Longueur</span><span class="sxs-lookup"><span data-stu-id="42d54-169">Length</span></span>         | <span data-ttu-id="42d54-170">Type</span><span class="sxs-lookup"><span data-stu-id="42d54-170">Type</span></span>                       |
    |--------|----------------|----------------------------|
    | <span data-ttu-id="42d54-171">1</span><span class="sxs-lookup"><span data-stu-id="42d54-171">1</span></span>      | <span data-ttu-id="42d54-172">Longueur de l’en-tête</span><span class="sxs-lookup"><span data-stu-id="42d54-172">Header Length</span></span>  | <span data-ttu-id="42d54-173">\_ \_ en-tête de flux SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="42d54-173">SECBUFFER\_STREAM\_HEADER</span></span>  |
    | <span data-ttu-id="42d54-174">2</span><span class="sxs-lookup"><span data-stu-id="42d54-174">2</span></span>      | <span data-ttu-id="42d54-175">Longueur des données</span><span class="sxs-lookup"><span data-stu-id="42d54-175">Data Length</span></span>    | <span data-ttu-id="42d54-176">\_données SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="42d54-176">SECBUFFER\_DATA</span></span>            |
    | <span data-ttu-id="42d54-177">3</span><span class="sxs-lookup"><span data-stu-id="42d54-177">3</span></span>      | <span data-ttu-id="42d54-178">Longueur de la remorque</span><span class="sxs-lookup"><span data-stu-id="42d54-178">Trailer Length</span></span> | <span data-ttu-id="42d54-179">Code de fin de \_ flux SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="42d54-179">SECBUFFER\_STREAM\_TRAILER</span></span> |

    

     

    <span data-ttu-id="42d54-180">Cela permet à l’appelant d’utiliser plus efficacement les mémoires tampons.</span><span class="sxs-lookup"><span data-stu-id="42d54-180">This allows the caller to use the buffers more efficiently.</span></span> <span data-ttu-id="42d54-181">En appelant la fonction [**QueryContextAttributes**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) pour déterminer la quantité d’espace à réserver avant d’appeler [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature), l’opération est plus efficace pour l’application et le package de sécurité.</span><span class="sxs-lookup"><span data-stu-id="42d54-181">By calling the [**QueryContextAttributes**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) function to determine the amount of space to reserve before calling [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature), the operation is more efficient for the application and the security package.</span></span>

 

 
