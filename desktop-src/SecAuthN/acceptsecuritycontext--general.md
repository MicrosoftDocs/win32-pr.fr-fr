---
description: Active le composant serveur d’une application de transport pour établir un [*contexte de sécurité*](../secgloss/s-gly.md) entre le serveur et un client distant.
ms.assetid: eaa15fed-4438-4e43-9be3-aa100ca453c7
title: AcceptSecurityContext (général), fonction (SSPI. h)
ms.topic: reference
ms.date: 07/25/2019
ms.openlocfilehash: 41b3220e9304f63e1a6ac4f77b609e3cbbac8741
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103865733"
---
# <a name="acceptsecuritycontext-general-function"></a><span data-ttu-id="bc5d0-103">AcceptSecurityContext (général) (fonction)</span><span class="sxs-lookup"><span data-stu-id="bc5d0-103">AcceptSecurityContext (General) function</span></span>

<span data-ttu-id="bc5d0-104">La fonction **AcceptSecurityContext (général)** permet au composant serveur d’une application de transport d’établir un [*contexte de sécurité*](../secgloss/s-gly.md) entre le serveur et un client distant.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-104">The **AcceptSecurityContext (General)** function enables the server component of a transport application to establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client.</span></span> <span data-ttu-id="bc5d0-105">Le client distant utilise la fonction [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md) pour démarrer le processus d’établissement d’un [*contexte de sécurité*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-105">The remote client uses the [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md) function to start the process of establishing a [*security context*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="bc5d0-106">Le serveur peut exiger un ou plusieurs jetons de réponse du client distant pour terminer l’établissement du [*contexte de sécurité*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-106">The server can require one or more reply tokens from the remote client to complete establishing the [*security context*](../secgloss/s-gly.md).</span></span>

<span data-ttu-id="bc5d0-107">Pour plus d’informations sur l’utilisation de cette fonction avec un fournisseur SSP ( [*Security Support Provider*](../secgloss/s-gly.md) ) spécifique, consultez les rubriques suivantes.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-107">For information about using this function with a specific [*security support provider*](../secgloss/s-gly.md) (SSP), see the following topics.</span></span>



| <span data-ttu-id="bc5d0-108">Rubrique</span><span class="sxs-lookup"><span data-stu-id="bc5d0-108">Topic</span></span>                                                                          | <span data-ttu-id="bc5d0-109">Description</span><span class="sxs-lookup"><span data-stu-id="bc5d0-109">Description</span></span>                                                                                                                                                                                                                                                                      |
|--------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="bc5d0-110">**AcceptSecurityContext (CredSSP)**</span><span class="sxs-lookup"><span data-stu-id="bc5d0-110">**AcceptSecurityContext (CredSSP)**</span></span>](acceptsecuritycontext--credssp.md)     | <span data-ttu-id="bc5d0-111">Autorise le composant serveur d’une application de transport à établir un [*contexte de sécurité*](../secgloss/s-gly.md) entre le serveur et un client distant à l’aide du protocole CredSSP (Credential Security Support Provider).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-111">Allows the server component of a transport application establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client by using Credential Security Support Provider (CredSSP).</span></span><br/> |
| [<span data-ttu-id="bc5d0-112">**AcceptSecurityContext (Digest)**</span><span class="sxs-lookup"><span data-stu-id="bc5d0-112">**AcceptSecurityContext (Digest)**</span></span>](acceptsecuritycontext--digest.md)       | <span data-ttu-id="bc5d0-113">Active le composant serveur d’une application de transport pour établir un [*contexte de sécurité*](../secgloss/s-gly.md) entre le serveur et un client distant qui utilise le protocole Digest.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-113">Enables the server component of a transport application to establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client that is using Digest.</span></span><br/>                                                                                                                  |
| [<span data-ttu-id="bc5d0-114">**AcceptSecurityContext (Kerberos)**</span><span class="sxs-lookup"><span data-stu-id="bc5d0-114">**AcceptSecurityContext (Kerberos)**</span></span>](acceptsecuritycontext--kerberos.md)   | <span data-ttu-id="bc5d0-115">Active le composant serveur d’une application de transport pour établir un [*contexte de sécurité*](../secgloss/s-gly.md) entre le serveur et un client distant qui utilise Kerberos.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-115">Enables the server component of a transport application to establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client that is using Kerberos.</span></span><br/>                                                                                                                |
| [<span data-ttu-id="bc5d0-116">**AcceptSecurityContext (Negotiate)**</span><span class="sxs-lookup"><span data-stu-id="bc5d0-116">**AcceptSecurityContext (Negotiate)**</span></span>](acceptsecuritycontext--negotiate.md) | <span data-ttu-id="bc5d0-117">Active le composant serveur d’une application de transport pour établir un [*contexte de sécurité*](../secgloss/s-gly.md) entre le serveur et un client distant qui utilise Negotiate.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-117">Enables the server component of a transport application to establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client that is using Negotiate.</span></span><br/>                                                                                                               |
| [<span data-ttu-id="bc5d0-118">**AcceptSecurityContext (NTLM)**</span><span class="sxs-lookup"><span data-stu-id="bc5d0-118">**AcceptSecurityContext (NTLM)**</span></span>](acceptsecuritycontext--ntlm.md)           | <span data-ttu-id="bc5d0-119">Active le composant serveur d’une application de transport pour établir un [*contexte de sécurité*](../secgloss/s-gly.md) entre le serveur et un client distant qui utilise NTLM.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-119">Enables the server component of a transport application to establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client that is using NTLM.</span></span><br/>                                                                                                                    |
| [<span data-ttu-id="bc5d0-120">**AcceptSecurityContext (SChannel)**</span><span class="sxs-lookup"><span data-stu-id="bc5d0-120">**AcceptSecurityContext (Schannel)**</span></span>](acceptsecuritycontext--schannel.md)   | <span data-ttu-id="bc5d0-121">Active le composant serveur d’une application de transport pour établir un [*contexte de sécurité*](../secgloss/s-gly.md) entre le serveur et un client distant qui utilise Schannel.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-121">Enables the server component of a transport application to establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client that is using Schannel.</span></span><br/>                                                                                                                |



 

## <a name="syntax"></a><span data-ttu-id="bc5d0-122">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="bc5d0-122">Syntax</span></span>


```C++
SECURITY_STATUS SEC_Entry AcceptSecurityContext(
  _In_opt_    PCredHandle    phCredential,
  _Inout_opt_ PCtxtHandle    phContext,
  _In_opt_    PSecBufferDesc pInput,
  _In_        ULONG          fContextReq,
  _In_        ULONG          TargetDataRep,
  _Inout_opt_ PCtxtHandle    phNewContext,
  _Inout_opt_ PSecBufferDesc pOutput,
  _Out_       PULONG         pfContextAttr,
  _Out_opt_   PTimeStamp     ptsExpiry
);
```



## <a name="parameters"></a><span data-ttu-id="bc5d0-123">Paramètres</span><span class="sxs-lookup"><span data-stu-id="bc5d0-123">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="bc5d0-124">*phCredential* \[ dans, facultatif\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-124">*phCredential* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-125">Handle des informations d’identification du serveur.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-125">A handle to the credentials of the server.</span></span> <span data-ttu-id="bc5d0-126">Le serveur appelle la fonction [**AcquireCredentialsHandle (général)**](acquirecredentialshandle--general.md) avec l’indicateur SECPKG \_ cred \_ entrant ou SECPKG \_ cred \_ défini pour récupérer ce handle.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-126">The server calls the [**AcquireCredentialsHandle (General)**](acquirecredentialshandle--general.md) function with either the SECPKG\_CRED\_INBOUND or SECPKG\_CRED\_BOTH flag set to retrieve this handle.</span></span>

</dd> <dt>

<span data-ttu-id="bc5d0-127">*phContext* \[ in, out\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-127">*phContext* \[in, out\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-128">Pointeur vers une structure [CtxtHandle](sspi-handles.md) .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-128">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="bc5d0-129">Lors du premier appel à **AcceptSecurityContext (général)**, ce pointeur est **null**.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-129">On the first call to **AcceptSecurityContext (General)**, this pointer is **NULL**.</span></span> <span data-ttu-id="bc5d0-130">Lors des appels suivants, *phContext* est le handle du contexte partiellement formé qui a été retourné dans le paramètre *phNewContext* par le premier appel.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-130">On subsequent calls, *phContext* is the handle to the partially formed context that was returned in the *phNewContext* parameter by the first call.</span></span>

</dd> <dt>

<span data-ttu-id="bc5d0-131">*pInput* \[ dans, facultatif\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-131">*pInput* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-132">Pointeur vers une structure [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) générée par un appel client à [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md) qui contient le descripteur de mémoire tampon d’entrée.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-132">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure generated by a client call to [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md) that contains the input buffer descriptor.</span></span>

<span data-ttu-id="bc5d0-133">Lors de l’utilisation du SSP Schannel, le premier tampon doit être de type SECBUFFER \_ Token et contenir le jeton de sécurité reçu du client.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-133">When using the Schannel SSP, the first buffer must be of type SECBUFFER\_TOKEN and contain the security token received from the client.</span></span> <span data-ttu-id="bc5d0-134">La deuxième mémoire tampon doit être de type SECBUFFER \_ vide.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-134">The second buffer should be of type SECBUFFER\_EMPTY.</span></span>

<span data-ttu-id="bc5d0-135">Lors de l’utilisation des SSP Negotiate, Kerberos ou NTLM, les informations de liaison de canal peuvent être spécifiées en passant une structure [**SecBuffer**](/windows/win32/api/sspi/ns-sspi-secbuffer) de **\_ \_ liaisons de canaux** de type SecBuffer en plus des mémoires tampons générées par l’appel à la fonction [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md) .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-135">When using the Negotiate, Kerberos, or NTLM SSPs, channel binding information can be specified by passing in a [**SecBuffer**](/windows/win32/api/sspi/ns-sspi-secbuffer) structure of type **SECBUFFER\_CHANNEL\_BINDINGS** in addition to the buffers generated by the call to the [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md) function.</span></span> <span data-ttu-id="bc5d0-136">Les informations de liaison de canal pour la mémoire tampon de liaison de canal peuvent être obtenues en appelant la fonction [**QueryContextAttributes (SChannel)**](querycontextattributes--schannel.md) sur le contexte Schannel utilisé par le client pour s’authentifier.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-136">The channel binding information for the channel binding buffer can be obtained by calling the [**QueryContextAttributes (Schannel)**](querycontextattributes--schannel.md) function on the Schannel context the client used to authenticate.</span></span>

</dd> <dt>

<span data-ttu-id="bc5d0-137">*fContextReq* \[ dans\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-137">*fContextReq* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-138">Indicateurs de bits qui spécifient les attributs requis par le serveur pour établir le contexte.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-138">Bit flags that specify the attributes required by the server to establish the context.</span></span> <span data-ttu-id="bc5d0-139">**Les indicateurs de bits** peuvent être combinés à l’aide d’opérations or au niveau du bit.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-139">Bit flags can be combined by using bitwise-**OR** operations.</span></span> <span data-ttu-id="bc5d0-140">Ce paramètre peut être une ou plusieurs des valeurs suivantes.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-140">This parameter can be one or more of the following values.</span></span>



| <span data-ttu-id="bc5d0-141">Valeur</span><span class="sxs-lookup"><span data-stu-id="bc5d0-141">Value</span></span>                                                                                                                                                                                                                                          | <span data-ttu-id="bc5d0-142">Signification</span><span class="sxs-lookup"><span data-stu-id="bc5d0-142">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="ASC_REQ_ALLOCATE_MEMORY"></span><span id="asc_req_allocate_memory"></span><dl> <span data-ttu-id="bc5d0-143"><dt>**\_demande ASC \_ allouer de la \_ mémoire**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-143"><dt>**ASC\_REQ\_ALLOCATE\_MEMORY**</dt></span></span> </dl>                                                  | <span data-ttu-id="bc5d0-144">Digest et Schannel allouent les tampons de sortie pour vous.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-144">Digest and Schannel will allocate output buffers for you.</span></span> <span data-ttu-id="bc5d0-145">Lorsque vous avez fini d’utiliser les tampons de sortie, libérez-les en appelant la fonction [**FreeContextBuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-145">When you have finished using the output buffers, free them by calling the [**FreeContextBuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) function.</span></span><br/>                                                                                                                                                                                                                                                                                |
| <span id="ASC_REQ_ALLOW_MISSING_BINDINGS"></span><span id="asc_req_allow_missing_bindings"></span><dl> <span data-ttu-id="bc5d0-146"><dt>**la \_ demande ASC \_ autorise les \_ liaisons manquantes \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-146"><dt>**ASC\_REQ\_ALLOW\_MISSING\_BINDINGS**</dt></span></span> </dl>                            | <span data-ttu-id="bc5d0-147">Indique que Digest ne requiert pas de liaisons de canal pour les canaux internes et externes.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-147">Indicates that Digest does not require channel bindings for both inner and outer channels.</span></span> <span data-ttu-id="bc5d0-148">Cette valeur est utilisée pour la compatibilité descendante lorsque la prise en charge de la liaison de canal de point de terminaison n’est pas connue.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-148">This value is used for backward compatibility when support for endpoint channel binding is not known.</span></span><br/> <span data-ttu-id="bc5d0-149">Cette valeur s’exclut mutuellement avec les **\_ liaisons de \_ proxy \_ de demande ASC**.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-149">This value is mutually exclusive with **ASC\_REQ\_PROXY\_BINDINGS**.</span></span><br/> <span data-ttu-id="bc5d0-150">Cette valeur est prise en charge uniquement par le SSP Digest.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-150">This value is supported only by the Digest SSP.</span></span><br/> <span data-ttu-id="bc5d0-151">**Windows server 2008, Windows Vista, Windows server 2003 et Windows XP :** Cette valeur n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-151">**Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP:** This value is not supported.</span></span><br/> <br/> |
| <span id="ASC_REQ_CONFIDENTIALITY"></span><span id="asc_req_confidentiality"></span><dl> <span data-ttu-id="bc5d0-152"><dt>**\_confidentialité des demandes ASC \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-152"><dt>**ASC\_REQ\_CONFIDENTIALITY**</dt></span></span> </dl>                                                   | <span data-ttu-id="bc5d0-153">Chiffrer et déchiffrer les messages.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-153">Encrypt and decrypt messages.</span></span> <br/> <span data-ttu-id="bc5d0-154">Le SSP Digest prend en charge cet indicateur pour SASL uniquement.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-154">The Digest SSP supports this flag for SASL only.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="ASC_REQ_CONNECTION"></span><span id="asc_req_connection"></span><dl> <span data-ttu-id="bc5d0-155"><dt>**connexion à la \_ demande ASC \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-155"><dt>**ASC\_REQ\_CONNECTION**</dt></span></span> </dl>                                                                  | <span data-ttu-id="bc5d0-156">Le [*contexte de sécurité*](../secgloss/s-gly.md) ne gère pas les messages de mise en forme.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-156">The [*security context*](../secgloss/s-gly.md) will not handle formatting messages.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="ASC_REQ_DELEGATE"></span><span id="asc_req_delegate"></span><dl> <span data-ttu-id="bc5d0-157"><dt>**\_délégué req \_ ASC**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-157"><dt>**ASC\_REQ\_DELEGATE**</dt></span></span> </dl>                                                                        | <span data-ttu-id="bc5d0-158">Le serveur est autorisé à emprunter l’identité du client.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-158">The server is allowed to impersonate the client.</span></span> <span data-ttu-id="bc5d0-159">Valide pour Kerberos.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-159">Valid for Kerberos.</span></span> <span data-ttu-id="bc5d0-160">Ignorez cet indicateur pour la [*délégation avec restriction*](../secgloss/c-gly.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-160">Ignore this flag for [*constrained delegation*](../secgloss/c-gly.md).</span></span><br/>                                                                                                                                                                                                                                                             |
| <span id="ASC_REQ_EXTENDED_ERROR"></span><span id="asc_req_extended_error"></span><dl> <span data-ttu-id="bc5d0-161"><dt>**\_ \_ erreur étendue ASC \_ req**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-161"><dt>**ASC\_REQ\_EXTENDED\_ERROR**</dt></span></span> </dl>                                                     | <span data-ttu-id="bc5d0-162">Lorsque des erreurs se produisent, le tiers distant est averti.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-162">When errors occur, the remote party will be notified.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span id="ASC_REQ_HTTP__0x10000000_"></span><span id="asc_req_http__0x10000000_"></span><span id="ASC_REQ_HTTP__0X10000000_"></span><dl> <span data-ttu-id="bc5d0-163"><dt>**ASC \_ req \_ http (0x10000000)**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-163"><dt>**ASC\_REQ\_HTTP (0x10000000)**</dt></span></span> </dl> | <span data-ttu-id="bc5d0-164">Utilisez Digest pour HTTP.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-164">Use Digest for HTTP.</span></span> <span data-ttu-id="bc5d0-165">Omettez cet indicateur pour utiliser Digest comme mécanisme SASL.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-165">Omit this flag to use Digest as an SASL mechanism.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span id="ASC_REQ_INTEGRITY"></span><span id="asc_req_integrity"></span><dl> <span data-ttu-id="bc5d0-166"><dt>**\_intégrité des demandes ASC \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-166"><dt>**ASC\_REQ\_INTEGRITY**</dt></span></span> </dl>                                                                     | <span data-ttu-id="bc5d0-167">Signer des messages et vérifier les signatures.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-167">Sign messages and verify signatures.</span></span><br/> <span data-ttu-id="bc5d0-168">Schannel ne prend pas en charge cet indicateur.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-168">Schannel does not support this flag.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                        |
| <span id="ASC_REQ_MUTUAL_AUTH"></span><span id="asc_req_mutual_auth"></span><dl> <span data-ttu-id="bc5d0-169"><dt>**\_ \_ authentification mutuelle des demandes ASC \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-169"><dt>**ASC\_REQ\_MUTUAL\_AUTH**</dt></span></span> </dl>                                                              | <span data-ttu-id="bc5d0-170">Le client doit fournir un certificat à utiliser pour l’authentification du client.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-170">The client is required to supply a certificate to be used for client authentication.</span></span><br/> <span data-ttu-id="bc5d0-171">Cet indicateur est pris en charge uniquement par Schannel.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-171">This flag is supported only by Schannel.</span></span><br/>                                                                                                                                                                                                                                                                                                                                    |
| <span id="ASC_REQ_PROXY_BINDINGS"></span><span id="asc_req_proxy_bindings"></span><dl> <span data-ttu-id="bc5d0-172"><dt>**\_liaisons de \_ proxy de demande ASC \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-172"><dt>**ASC\_REQ\_PROXY\_BINDINGS**</dt></span></span> </dl>                                                     | <span data-ttu-id="bc5d0-173">Indique que le Digest requiert la liaison de canal.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-173">Indicates that Digest requires channel binding.</span></span><br/> <span data-ttu-id="bc5d0-174">Cette valeur s’exclut mutuellement avec la **demande ASC qui \_ autorise les \_ \_ \_ liaisons manquantes**.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-174">This value is mutually exclusive with **ASC\_REQ\_ALLOW\_MISSING\_BINDINGS**.</span></span><br/> <span data-ttu-id="bc5d0-175">Cette valeur est prise en charge uniquement par le SSP Digest.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-175">This value is supported only by the Digest SSP.</span></span><br/> <span data-ttu-id="bc5d0-176">**Windows server 2008, Windows Vista, Windows server 2003 et Windows XP :** Cette valeur n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-176">**Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP:** This value is not supported.</span></span><br/> <br/>                                                                                                                                         |
| <span id="ASC_REQ_REPLAY_DETECT"></span><span id="asc_req_replay_detect"></span><dl> <span data-ttu-id="bc5d0-177"><dt>**détection de la \_ RElecture de la demande ASC \_ \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-177"><dt>**ASC\_REQ\_REPLAY\_DETECT**</dt></span></span> </dl>                                                        | <span data-ttu-id="bc5d0-178">Détecter les paquets relus.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-178">Detect replayed packets.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="ASC_REQ_SEQUENCE_DETECT"></span><span id="asc_req_sequence_detect"></span><dl> <span data-ttu-id="bc5d0-179"><dt>**détection de la \_ séquence de demande ASC \_ \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-179"><dt>**ASC\_REQ\_SEQUENCE\_DETECT**</dt></span></span> </dl>                                                  | <span data-ttu-id="bc5d0-180">Détecte les messages reçus en dehors de la séquence.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-180">Detect messages received out of sequence.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="ASC_REQ_STREAM"></span><span id="asc_req_stream"></span><dl> <span data-ttu-id="bc5d0-181"><dt>**\_flux de demande ASC \_**</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-181"><dt>**ASC\_REQ\_STREAM**</dt></span></span> </dl>                                                                              | <span data-ttu-id="bc5d0-182">Prend en charge une connexion orientée flux.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-182">Support a stream-oriented connection.</span></span><br/> <span data-ttu-id="bc5d0-183">Cet indicateur est pris en charge uniquement par Schannel.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-183">This flag is supported only by Schannel.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                   |



 

<span data-ttu-id="bc5d0-184">Pour connaître les indicateurs d’attribut possibles et leurs significations, consultez [spécifications de contexte](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-184">For possible attribute flags and their meanings, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="bc5d0-185">Les indicateurs utilisés pour ce paramètre sont préfixés avec ASC \_ req, par exemple ASC \_ req \_ Delegate.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-185">Flags used for this parameter are prefixed with ASC\_REQ, for example, ASC\_REQ\_DELEGATE.</span></span>

<span data-ttu-id="bc5d0-186">Les attributs demandés ne sont peut-être pas pris en charge par le client.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-186">The requested attributes may not be supported by the client.</span></span> <span data-ttu-id="bc5d0-187">Pour plus d’informations, consultez le paramètre *pfContextAttr* .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-187">For more information, see the *pfContextAttr* parameter.</span></span>

</dd> <dt>

<span data-ttu-id="bc5d0-188">*TargetDataRep* \[ dans\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-188">*TargetDataRep* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-189">Représentation des données, telle que l’ordonnancement des octets, sur la cible.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-189">The data representation, such as byte ordering, on the target.</span></span> <span data-ttu-id="bc5d0-190">Ce paramètre peut être SECURITY \_ native \_ DREP ou Security \_ Network \_ DREP.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-190">This parameter can be either SECURITY\_NATIVE\_DREP or SECURITY\_NETWORK\_DREP.</span></span>

<span data-ttu-id="bc5d0-191">Ce paramètre n’est pas utilisé avec les SSP Schannel ou Digest.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-191">This parameter is not used with Schannel or Digest SSPs.</span></span> <span data-ttu-id="bc5d0-192">Lorsque vous utilisez Schannel ou SSP Digest, spécifiez zéro pour ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-192">When you use Schannel or Digest SSPs, specify zero for this parameter.</span></span>

</dd> <dt>

<span data-ttu-id="bc5d0-193">*phNewContext* \[ in, out, facultatif\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-193">*phNewContext* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-194">Pointeur vers une structure [CtxtHandle](sspi-handles.md) .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-194">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="bc5d0-195">Lors du premier appel à **AcceptSecurityContext (général)**, ce pointeur reçoit le nouveau handle de contexte.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-195">On the first call to **AcceptSecurityContext (General)**, this pointer receives the new context handle.</span></span> <span data-ttu-id="bc5d0-196">Lors des appels suivants, *phNewContext* peut être le même que le handle spécifié dans le paramètre *phContext* .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-196">On subsequent calls, *phNewContext* can be the same as the handle specified in the *phContext* parameter.</span></span>

</dd> <dt>

<span data-ttu-id="bc5d0-197">*pOutput* \[ in, out, facultatif\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-197">*pOutput* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-198">Pointeur vers une structure [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) qui contient le descripteur de mémoire tampon de sortie.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-198">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure that contains the output buffer descriptor.</span></span> <span data-ttu-id="bc5d0-199">Cette mémoire tampon est envoyée au client pour l’entrée dans des appels supplémentaires à [**InitializeSecurityContext (général)**](initializesecuritycontext--general.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-199">This buffer is sent to the client for input into additional calls to [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md).</span></span> <span data-ttu-id="bc5d0-200">Une mémoire tampon de sortie peut être générée même si la fonction retourne SEC \_ E \_ OK.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-200">An output buffer may be generated even if the function returns SEC\_E\_OK.</span></span> <span data-ttu-id="bc5d0-201">Toute mémoire tampon générée doit être renvoyée à l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-201">Any buffer generated must be sent back to the client application.</span></span>

<span data-ttu-id="bc5d0-202">Lors de l’utilisation de Schannel, en sortie, cette mémoire tampon reçoit un jeton pour le [*contexte de sécurité*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-202">When using Schannel, on output, this buffer receives a token for the [*security context*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="bc5d0-203">Le jeton doit être envoyé au client.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-203">The token must be sent to the client.</span></span> <span data-ttu-id="bc5d0-204">La fonction peut également retourner une mémoire tampon de type SECBUFFER \_ extra.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-204">The function can also return a buffer of type SECBUFFER\_EXTRA.</span></span> <span data-ttu-id="bc5d0-205">En outre, l’appelant doit passer une mémoire tampon de type **\_ alerte SECBUFFER**.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-205">In addition, the caller must pass in a buffer of type **SECBUFFER\_ALERT**.</span></span> <span data-ttu-id="bc5d0-206">Lors de la sortie, si une alerte est générée, cette mémoire tampon contient des informations sur cette alerte et la fonction échoue.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-206">On output, if an alert is generated, this buffer contains information about that alert, and the function fails.</span></span>

</dd> <dt>

<span data-ttu-id="bc5d0-207">*pfContextAttr* \[ à\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-207">*pfContextAttr* \[out\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-208">Pointeur vers une variable qui reçoit un jeu d’indicateurs binaires qui indiquent les attributs du contexte établi.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-208">A pointer to a variable that receives a set of bit flags that indicate the attributes of the established context.</span></span> <span data-ttu-id="bc5d0-209">Pour obtenir une description des différents attributs, consultez [spécifications de contexte](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-209">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="bc5d0-210">Les indicateurs utilisés pour ce paramètre sont préfixés par ASC \_ RET, par exemple ASC \_ RET \_ Delegate.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-210">Flags used for this parameter are prefixed with ASC\_RET, for example, ASC\_RET\_DELEGATE.</span></span>

<span data-ttu-id="bc5d0-211">Ne vérifiez pas les attributs liés à la sécurité jusqu’à ce que l’appel de fonction final soit retourné avec succès.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-211">Do not check for security-related attributes until the final function call returns successfully.</span></span> <span data-ttu-id="bc5d0-212">Les indicateurs d’attribut non liés à la sécurité, tels que l' \_ indicateur ASC RET \_ allouée la \_ mémoire, peuvent être vérifiés avant le retour final.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-212">Attribute flags not related to security, such as the ASC\_RET\_ALLOCATED\_MEMORY flag, can be checked before the final return.</span></span>

</dd> <dt>

<span data-ttu-id="bc5d0-213">*ptsTimeStamp* \[ out, facultatif\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-213">*ptsTimeStamp* \[out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="bc5d0-214">Pointeur vers une structure d' [**horodatage**](timestamp.md) qui reçoit l’heure d’expiration du contexte.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-214">A pointer to a [**TimeStamp**](timestamp.md) structure that receives the expiration time of the context.</span></span> <span data-ttu-id="bc5d0-215">Nous recommandons que le [*package de sécurité*](../secgloss/s-gly.md) retourne toujours cette valeur en heure locale.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-215">We recommend that the [*security package*](../secgloss/s-gly.md) always return this value in local time.</span></span>

<span data-ttu-id="bc5d0-216">Ce paramètre est défini sur une durée maximale constante.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-216">This parameter is set to a constant maximum time.</span></span> <span data-ttu-id="bc5d0-217">Il n’y a pas de délai d’expiration pour les informations d’identification ou les informations d’identification du [*contexte de sécurité*](../secgloss/s-gly.md)Digest ou lors de l’utilisation du SSP Digest.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-217">There is no expiration time for Digest [*security context*](../secgloss/s-gly.md)s or credentials or when using the Digest SSP.</span></span>

<span data-ttu-id="bc5d0-218">Cette option est facultative lors de l’utilisation du SSP Schannel.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-218">This is optional when using the Schannel SSP.</span></span> <span data-ttu-id="bc5d0-219">Lorsque le tiers distant a fourni un certificat à utiliser pour l’authentification, ce paramètre reçoit l’heure d’expiration de ce certificat.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-219">When the remote party has supplied a certificate to be used for authentication, this parameter receives the expiration time for that certificate.</span></span> <span data-ttu-id="bc5d0-220">Si aucun certificat n’a été fourni, une valeur de temps maximale est retournée.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-220">If no certificate was supplied, a maximum time value is returned.</span></span>

> [!Note]  
> <span data-ttu-id="bc5d0-221">Jusqu’au dernier appel du processus d’authentification, l’heure d’expiration du contexte peut être incorrecte, car des informations supplémentaires seront fournies lors des étapes ultérieures de la négociation.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-221">Until the last call of the authentication process, the expiration time for the context can be incorrect because more information will be provided during later stages of the negotiation.</span></span> <span data-ttu-id="bc5d0-222">Par conséquent, *ptsTimeStamp* doit avoir la **valeur null** jusqu’au dernier appel à la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-222">Therefore, *ptsTimeStamp* must be **NULL** until the last call to the function.</span></span>

 

</dd> </dl>

## <a name="return-value"></a><span data-ttu-id="bc5d0-223">Valeur retournée</span><span class="sxs-lookup"><span data-stu-id="bc5d0-223">Return value</span></span>

<span data-ttu-id="bc5d0-224">Cette fonction retourne l’une des valeurs suivantes.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-224">This function returns one of the following values.</span></span>



<table><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><thead><tr class="header"><th><span data-ttu-id="bc5d0-225">Code/valeur de retour</span><span class="sxs-lookup"><span data-stu-id="bc5d0-225">Return code/value</span></span></th><th><span data-ttu-id="bc5d0-226">Description</span><span class="sxs-lookup"><span data-stu-id="bc5d0-226">Description</span></span></th></tr></thead><tbody><tr class="odd"><td><dl> <span data-ttu-id="bc5d0-227"><dt><strong>SEC_E_BAD_BINDINGS</strong></dt> <dt>0x80090346L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-227"><dt><strong>SEC_E_BAD_BINDINGS</strong></dt> <dt>0x80090346L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-228">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-228">The function failed.</span></span> <span data-ttu-id="bc5d0-229">La stratégie de liaison de canal n’a pas été satisfaite.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-229">Channel binding policy was not satisfied.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="bc5d0-230"><dt><strong>SEC_E_INCOMPLETE_MESSAGE</strong></dt> <dt>0x80090318L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-230"><dt><strong>SEC_E_INCOMPLETE_MESSAGE</strong></dt> <dt>0x80090318L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-231">La fonction a réussi.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-231">The function succeeded.</span></span> <span data-ttu-id="bc5d0-232">Les données de la mémoire tampon d’entrée sont incomplètes.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-232">The data in the input buffer is incomplete.</span></span> <span data-ttu-id="bc5d0-233">L’application doit lire les données supplémentaires à partir du client et appeler à nouveau [<strong>AcceptSecurityContext (General)</strong>] (AcceptSecurityContext--General.MD).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-233">The application must read additional data from the client and call [<strong>AcceptSecurityContext (General)</strong>](acceptsecuritycontext--general.md) again.</span></span><br/> <span data-ttu-id="bc5d0-234">Cette valeur peut être retournée lors de l’utilisation du SSP Schannel.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-234">This value can be returned when using the Schannel SSP.</span></span> <span data-ttu-id="bc5d0-235">Pour plus d’informations sur cette valeur de retour, consultez [<strong>AcceptSecurityContext (SChannel)</strong>] (AcceptSecurityContext--Schannel.MD).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-235">For more information about this return value, see [<strong>AcceptSecurityContext (Schannel)</strong>](acceptsecuritycontext--schannel.md).</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="bc5d0-236"><dt><strong>SEC_E_INSUFFICIENT_MEMORY</strong></dt> <dt>0x80090300L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-236"><dt><strong>SEC_E_INSUFFICIENT_MEMORY</strong></dt> <dt>0x80090300L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-237">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-237">The function failed.</span></span> <span data-ttu-id="bc5d0-238">La mémoire disponible est insuffisante pour terminer l’action demandée.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-238">There is not enough memory available to complete the requested action.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="bc5d0-239"><dt><strong>SEC_E_INTERNAL_ERROR</strong></dt> <dt>0x80090304L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-239"><dt><strong>SEC_E_INTERNAL_ERROR</strong></dt> <dt>0x80090304L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-240">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-240">The function failed.</span></span> <span data-ttu-id="bc5d0-241">Une erreur qui n’a pas été mappée à un code d’erreur SSPI s’est produite.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-241">An error occurred that did not map to an SSPI error code.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="bc5d0-242"><dt><strong>SEC_E_INVALID_HANDLE</strong></dt> <dt>0x80100003L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-242"><dt><strong>SEC_E_INVALID_HANDLE</strong></dt> <dt>0x80100003L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-243">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-243">The function failed.</span></span> <span data-ttu-id="bc5d0-244">Le handle passé à la fonction n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-244">The handle passed to the function is not valid.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="bc5d0-245"><dt><strong>SEC_E_INVALID_TOKEN</strong></dt> <dt>0x80090308L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-245"><dt><strong>SEC_E_INVALID_TOKEN</strong></dt> <dt>0x80090308L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-246">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-246">The function failed.</span></span> <span data-ttu-id="bc5d0-247">Le jeton passé à la fonction n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-247">The token passed to the function is not valid.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="bc5d0-248"><dt><strong>SEC_E_LOGON_DENIED</strong></dt> <dt>0x8009030CL</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-248"><dt><strong>SEC_E_LOGON_DENIED</strong></dt> <dt>0x8009030CL</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-249">L’ouverture de session a échoué.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-249">The logon failed.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="bc5d0-250"><dt><strong>SEC_E_NO_AUTHENTICATING_AUTHORITY</strong></dt> <dt>0x80090311L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-250"><dt><strong>SEC_E_NO_AUTHENTICATING_AUTHORITY</strong></dt> <dt>0x80090311L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-251">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-251">The function failed.</span></span> <span data-ttu-id="bc5d0-252">Aucune autorité n’a pu être contactée pour l’authentification.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-252">No authority could be contacted for authentication.</span></span> <span data-ttu-id="bc5d0-253">Cela peut être dû aux conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="bc5d0-253">This could be due to the following conditions:</span></span><br/><ul><li><span data-ttu-id="bc5d0-254">Le nom de domaine du tiers d’authentification est incorrect.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-254">The domain name of the authenticating party is incorrect.</span></span></li><li><span data-ttu-id="bc5d0-255">Le domaine n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-255">The domain is unavailable.</span></span></li><li><span data-ttu-id="bc5d0-256">La relation d’approbation a échoué.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-256">The trust relationship has failed.</span></span></li></ul></td></tr><tr class="odd"><td><dl> <span data-ttu-id="bc5d0-257"><dt><strong>SEC_E_NO_CREDENTIALS</strong></dt> <dt>0x8009030EL</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-257"><dt><strong>SEC_E_NO_CREDENTIALS</strong></dt> <dt>0x8009030EL</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-258">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-258">The function failed.</span></span> <span data-ttu-id="bc5d0-259">Le descripteur des informations d’identification spécifié dans le paramètre <em>phCredential</em> n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-259">The credentials handle specified in the <em>phCredential</em> parameter is not valid.</span></span> <span data-ttu-id="bc5d0-260">Cette valeur peut être retournée lors de l’utilisation du SSP condensé ou Schannel.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-260">This value can be returned when using the Digest or Schannel SSP.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="bc5d0-261"><dt><strong>SEC_E_OK</strong></dt> <dt>0x00000000L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-261"><dt><strong>SEC_E_OK</strong></dt> <dt>0x00000000L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-262">La fonction a réussi.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-262">The function succeeded.</span></span> <span data-ttu-id="bc5d0-263">Le [*contexte de sécurité*](../secgloss/s-gly.md) reçu du client a été accepté.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-263">The [*security context*](../secgloss/s-gly.md) received from the client was accepted.</span></span> <span data-ttu-id="bc5d0-264">Si un jeton de sortie a été généré par la fonction, il doit être envoyé au processus client.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-264">If an output token was generated by the function, it must be sent to the client process.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="bc5d0-265"><dt><strong>SEC_E_SECURITY_QOS_FAILED</strong></dt> <dt>0x80090332L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-265"><dt><strong>SEC_E_SECURITY_QOS_FAILED</strong></dt> <dt>0x80090332L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-266">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-266">The function failed.</span></span> <span data-ttu-id="bc5d0-267">Un indicateur d’attribut de contexte non valide a été spécifié dans le paramètre <em>fContextReq</em> .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-267">A context attribute flag that is not valid was specified in the <em>fContextReq</em> parameter.</span></span> <span data-ttu-id="bc5d0-268">Cette valeur peut être retournée lors de l’utilisation du SSP Digest.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-268">This value can be returned when using the Digest SSP.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="bc5d0-269"><dt><strong>SEC_E_UNSUPPORTED_FUNCTION</strong></dt> <dt>0x80090302L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-269"><dt><strong>SEC_E_UNSUPPORTED_FUNCTION</strong></dt> <dt>0x80090302L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-270">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-270">The function failed.</span></span> <span data-ttu-id="bc5d0-271">Un indicateur d’attribut de contexte qui n’est pas valide (ASC_REQ_DELEGATE ou ASC_REQ_PROMPT_FOR_CREDS) a été spécifié dans le paramètre <em>fContextReq</em> .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-271">A context attribute flag that is not valid (ASC_REQ_DELEGATE or ASC_REQ_PROMPT_FOR_CREDS) was specified in the <em>fContextReq</em> parameter.</span></span> <span data-ttu-id="bc5d0-272">Cette valeur peut être retournée lors de l’utilisation du SSP Schannel.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-272">This value can be returned when using the Schannel SSP.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="bc5d0-273"><dt><strong>SEC_I_COMPLETE_AND_CONTINUE</strong></dt> <dt>0x00090314L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-273"><dt><strong>SEC_I_COMPLETE_AND_CONTINUE</strong></dt> <dt>0x00090314L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-274">La fonction a réussi.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-274">The function succeeded.</span></span> <span data-ttu-id="bc5d0-275">Le serveur doit appeler [<strong>CompleteAuthToken</strong>] (/Windows/Win32/API/SSPI/NF-SSPI-CompleteAuthToken) et transmettre le jeton de sortie au client.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-275">The server must call [<strong>CompleteAuthToken</strong>](/windows/win32/api/sspi/nf-sspi-completeauthtoken) and pass the output token to the client.</span></span> <span data-ttu-id="bc5d0-276">Le serveur attend ensuite un jeton de retour du client et effectue ensuite un autre appel à [<strong>AcceptSecurityContext (General)</strong>] (AcceptSecurityContext--General.MD).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-276">The server then waits for a return token from the client and then makes another call to [<strong>AcceptSecurityContext (General)</strong>](acceptsecuritycontext--general.md).</span></span> <br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="bc5d0-277"><dt><strong>SEC_I_COMPLETE_NEEDED</strong></dt> <dt>0x00090313L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-277"><dt><strong>SEC_I_COMPLETE_NEEDED</strong></dt> <dt>0x00090313L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-278">La fonction a réussi.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-278">The function succeeded.</span></span> <span data-ttu-id="bc5d0-279">Le serveur doit terminer la génération du message à partir du client, puis appeler la fonction [<strong>CompleteAuthToken</strong>] (/Windows/Win32/API/SSPI/NF-SSPI-CompleteAuthToken).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-279">The server must finish building the message from the client and then call the [<strong>CompleteAuthToken</strong>](/windows/win32/api/sspi/nf-sspi-completeauthtoken) function.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="bc5d0-280"><dt><strong>SEC_I_CONTINUE_NEEDED</strong></dt> <dt>0x00090312L</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-280"><dt><strong>SEC_I_CONTINUE_NEEDED</strong></dt> <dt>0x00090312L</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-281">La fonction a réussi.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-281">The function succeeded.</span></span> <span data-ttu-id="bc5d0-282">Le serveur doit envoyer le jeton de sortie au client et attendre un jeton retourné.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-282">The server must send the output token to the client and wait for a returned token.</span></span> <span data-ttu-id="bc5d0-283">Le jeton retourné doit être passé dans <em>pInput</em> pour un autre appel à [<strong>AcceptSecurityContext (General)</strong>] (AcceptSecurityContext--General.MD).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-283">The returned token should be passed in <em>pInput</em> for another call to [<strong>AcceptSecurityContext (General)</strong>](acceptsecuritycontext--general.md).</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="bc5d0-284"><dt><strong>STATUS_LOGON_FAILURE</strong></dt> <dt>0xC000006DL</dt> </span><span class="sxs-lookup"><span data-stu-id="bc5d0-284"><dt><strong>STATUS_LOGON_FAILURE</strong></dt> <dt>0xC000006DL</dt> </span></span></dl></td><td><span data-ttu-id="bc5d0-285">Échec de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-285">The function failed.</span></span> <span data-ttu-id="bc5d0-286">La fonction [<strong>AcceptSecurityContext (General)</strong>] (AcceptSecurityContext--General.MD) a été appelée après l’établissement du contexte spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-286">The [<strong>AcceptSecurityContext (General)</strong>](acceptsecuritycontext--general.md) function was called after the specified context was established.</span></span> <span data-ttu-id="bc5d0-287">Cette valeur peut être retournée lors de l’utilisation du SSP Digest.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-287">This value can be returned when using the Digest SSP.</span></span><br/></td></tr></tbody></table>



 

## <a name="remarks"></a><span data-ttu-id="bc5d0-288">Notes</span><span class="sxs-lookup"><span data-stu-id="bc5d0-288">Remarks</span></span>

<span data-ttu-id="bc5d0-289">La fonction **AcceptSecurityContext (General)** est l’équivalent serveur de la fonction [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md) .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-289">The **AcceptSecurityContext (General)** function is the server counterpart to the [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md) function.</span></span>

<span data-ttu-id="bc5d0-290">Lorsque le serveur reçoit une demande d’un client, le serveur utilise le paramètre *fContextReq* pour spécifier ce qu’il requiert de la session.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-290">When the server receives a request from a client, the server uses the *fContextReq* parameter to specify what it requires of the session.</span></span> <span data-ttu-id="bc5d0-291">De cette manière, un serveur peut spécifier que les clients doivent être en mesure d’utiliser une session confidentielle ou contrôlée par [*l’intégrité*](../secgloss/i-gly.md), et il peut rejeter des clients qui ne répondent pas à cette demande.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-291">In this fashion, a server can specify that clients must be capable of using a confidential or [*integrity*](../secgloss/i-gly.md)-checked session, and it can reject clients that cannot meet that demand.</span></span> <span data-ttu-id="bc5d0-292">En guise d’alternative, un serveur ne peut nécessiter rien, et tout ce que le client peut fournir ou nécessite est retourné dans le paramètre *pfContextAttr* .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-292">Alternatively, a server can require nothing, and whatever the client can provide or requires is returned in the *pfContextAttr* parameter.</span></span>

<span data-ttu-id="bc5d0-293">Pour un package qui prend en charge l’authentification à plusieurs jambes, telle que l’authentification mutuelle, la séquence d’appel est la suivante :</span><span class="sxs-lookup"><span data-stu-id="bc5d0-293">For a package that supports multiple-leg authentication, such as mutual authentication, the calling sequence is as follows:</span></span>

1.  <span data-ttu-id="bc5d0-294">Le client transmet un jeton au serveur.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-294">The client transmits a token to the server.</span></span>
2.  <span data-ttu-id="bc5d0-295">Le serveur appelle **AcceptSecurityContext (général)** la première fois, qui génère un jeton de réponse qui est ensuite envoyé au client.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-295">The server calls **AcceptSecurityContext (General)** the first time, which generates a reply token that is then sent to the client.</span></span>
3.  <span data-ttu-id="bc5d0-296">Le client reçoit le jeton et le passe à [**InitializeSecurityContext (général)**](initializesecuritycontext--general.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-296">The client receives the token and passes it to [**InitializeSecurityContext (General)**](initializesecuritycontext--general.md).</span></span> <span data-ttu-id="bc5d0-297">Si **InitializeSecurityContext (General)** retourne sec \_ E \_ OK, l’authentification mutuelle est terminée et une session sécurisée peut commencer.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-297">If **InitializeSecurityContext (General)** returns SEC\_E\_OK, mutual authentication has been completed and a secure session can begin.</span></span> <span data-ttu-id="bc5d0-298">Si **InitializeSecurityContext (General)** retourne un code d’erreur, la négociation de l’authentification mutuelle se termine.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-298">If **InitializeSecurityContext (General)** returns an error code, the mutual authentication negotiation ends.</span></span> <span data-ttu-id="bc5d0-299">Dans le cas contraire, le jeton de sécurité retourné par **InitializeSecurityContext (General)** est envoyé au client et les étapes 2 et 3 sont répétées.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-299">Otherwise, the security token returned by **InitializeSecurityContext (General)** is sent to the client, and steps 2 and 3 are repeated.</span></span>

<span data-ttu-id="bc5d0-300">Les paramètres *fContextReq* et *pfContextAttr* sont des masques de masques qui représentent différents attributs de contexte.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-300">The *fContextReq* and *pfContextAttr* parameters are bitmasks that represent various context attributes.</span></span> <span data-ttu-id="bc5d0-301">Pour obtenir une description des différents attributs, consultez [spécifications de contexte](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="bc5d0-301">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span>

> [!Note]  
> <span data-ttu-id="bc5d0-302">Le paramètre *pfContextAttr* est valide en cas de retour réussi, mais uniquement lors du retour final réussi, vous devez examiner les indicateurs relatifs aux aspects de sécurité du contexte.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-302">The *pfContextAttr* parameter is valid on any successful return, but only on the final successful return should you examine the flags pertaining to security aspects of the context.</span></span> <span data-ttu-id="bc5d0-303">Les retours intermédiaires peuvent définir, par exemple, \_ l' \_ indicateur ISC RET allouée \_ Memory.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-303">Intermediate returns can set, for example, the ISC\_RET\_ALLOCATED\_MEMORY flag.</span></span>

 

<span data-ttu-id="bc5d0-304">L’appelant est chargé de déterminer si les attributs de contexte finaux sont suffisants.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-304">The caller is responsible for determining whether the final context attributes are sufficient.</span></span> <span data-ttu-id="bc5d0-305">Si, par exemple, la confidentialité (chiffrement) a été demandée mais n’a pas pu être établie, certaines applications peuvent choisir d’arrêter immédiatement la connexion.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-305">If, for example, confidentiality (encryption) was requested, but could not be established, some applications may choose to shut down the connection immediately.</span></span> <span data-ttu-id="bc5d0-306">Si le [*contexte de sécurité*](../secgloss/s-gly.md) ne peut pas être établi, le serveur doit libérer le contexte partiellement créé en appelant la fonction [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="bc5d0-306">If the [*security context*](../secgloss/s-gly.md) cannot be established, the server must free the partially created context by calling the [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) function.</span></span> <span data-ttu-id="bc5d0-307">Pour plus d’informations sur l’appel de la fonction **DeleteSecurityContext** , consultez **DeleteSecurityContext**.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-307">For information about when to call the **DeleteSecurityContext** function, see **DeleteSecurityContext**.</span></span>

<span data-ttu-id="bc5d0-308">Une fois le [*contexte de sécurité*](../secgloss/s-gly.md) établi, l’application serveur peut utiliser la fonction [**QuerySecurityContextToken**](/windows/win32/api/sspi/nf-sspi-querysecuritycontexttoken) pour récupérer un handle vers le compte d’utilisateur auquel le certificat client a été mappé.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-308">After the [*security context*](../secgloss/s-gly.md) has been established, the server application can use the [**QuerySecurityContextToken**](/windows/win32/api/sspi/nf-sspi-querysecuritycontexttoken) function to retrieve a handle to the user account to which the client certificate was mapped.</span></span> <span data-ttu-id="bc5d0-309">En outre, le serveur peut utiliser la fonction [**ImpersonateSecurityContext**](/windows/win32/api/sspi/nf-sspi-impersonatesecuritycontext) pour emprunter l’identité de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bc5d0-309">Also, the server can use the [**ImpersonateSecurityContext**](/windows/win32/api/sspi/nf-sspi-impersonatesecuritycontext) function to impersonate the user.</span></span>

## <a name="requirements"></a><span data-ttu-id="bc5d0-310">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="bc5d0-310">Requirements</span></span>



| <span data-ttu-id="bc5d0-311">Condition requise</span><span class="sxs-lookup"><span data-stu-id="bc5d0-311">Requirement</span></span> | <span data-ttu-id="bc5d0-312">Valeur</span><span class="sxs-lookup"><span data-stu-id="bc5d0-312">Value</span></span> |
|-------------------------------------|--------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="bc5d0-313">Client minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="bc5d0-313">Minimum supported client</span></span><br/> | <span data-ttu-id="bc5d0-314">Applications de \[ Bureau Windows XP uniquement\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-314">Windows XP \[desktop apps only\]</span></span><br/>                                                            |
| <span data-ttu-id="bc5d0-315">Serveur minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="bc5d0-315">Minimum supported server</span></span><br/> | <span data-ttu-id="bc5d0-316">Applications de bureau Windows Server 2003 \[ uniquement\]</span><span class="sxs-lookup"><span data-stu-id="bc5d0-316">Windows Server 2003 \[desktop apps only\]</span></span><br/>                                                   |
| <span data-ttu-id="bc5d0-317">En-tête</span><span class="sxs-lookup"><span data-stu-id="bc5d0-317">Header</span></span><br/>                   | <dl> <span data-ttu-id="bc5d0-318"><dt>SSPI. h (include Security. h)</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-318"><dt>Sspi.h (include Security.h)</dt></span></span> </dl> |
| <span data-ttu-id="bc5d0-319">Bibliothèque</span><span class="sxs-lookup"><span data-stu-id="bc5d0-319">Library</span></span><br/>                  | <dl> <span data-ttu-id="bc5d0-320"><dt>Secur32. lib</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-320"><dt>Secur32.lib</dt></span></span> </dl>                 |
| <span data-ttu-id="bc5d0-321">DLL</span><span class="sxs-lookup"><span data-stu-id="bc5d0-321">DLL</span></span><br/>                      | <dl> <span data-ttu-id="bc5d0-322"><dt>Secur32.dll</dt></span><span class="sxs-lookup"><span data-stu-id="bc5d0-322"><dt>Secur32.dll</dt></span></span> </dl>                 |



## <a name="see-also"></a><span data-ttu-id="bc5d0-323">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="bc5d0-323">See also</span></span>

<dl> <dt>

[<span data-ttu-id="bc5d0-324">Fonctions SSPI</span><span class="sxs-lookup"><span data-stu-id="bc5d0-324">SSPI Functions</span></span>](authentication-functions.md#sspi-functions)
</dt> <dt>

[<span data-ttu-id="bc5d0-325">**DeleteSecurityContext**</span><span class="sxs-lookup"><span data-stu-id="bc5d0-325">**DeleteSecurityContext**</span></span>](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext)
</dt> <dt>

[<span data-ttu-id="bc5d0-326">**InitializeSecurityContext (général)**</span><span class="sxs-lookup"><span data-stu-id="bc5d0-326">**InitializeSecurityContext (General)**</span></span>](initializesecuritycontext--general.md)
</dt> </dl>

 

 
