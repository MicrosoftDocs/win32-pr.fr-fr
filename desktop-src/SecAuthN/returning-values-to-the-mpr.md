---
description: Les fonctions de mise en réseau Windows renvoient la \_ fonction WN réussite en cas de réussite, ou elles retournent une valeur différente de zéro unique si la fonction rencontre une erreur. En outre, elles retournent des informations d’erreur étendues à l’aide de WNetSetLastError et SetLastError.
ms.assetid: cb9d29a1-b3a5-4440-a069-3cd1565b1699
title: Retour de valeurs à l’MPR
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c96a5636f57d5c926af4e43e676f0b6db75d164
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951887"
---
# <a name="returning-values-to-the-mpr"></a><span data-ttu-id="39c87-104">Retour de valeurs à l’MPR</span><span class="sxs-lookup"><span data-stu-id="39c87-104">Returning Values to the MPR</span></span>

<span data-ttu-id="39c87-105">Les fonctions de mise en réseau Windows renvoient la \_ fonction WN réussite en cas de réussite, ou elles retournent une valeur différente de zéro unique si la fonction rencontre une erreur.</span><span class="sxs-lookup"><span data-stu-id="39c87-105">The Windows Networking functions return WN\_SUCCESS on success, or they return a unique nonzero value if the function encounters an error.</span></span> <span data-ttu-id="39c87-106">En outre, elles retournent des informations d’erreur étendues à l’aide de [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) et [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror).</span><span class="sxs-lookup"><span data-stu-id="39c87-106">In addition, they return extended error information using [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) and [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror).</span></span>

<span data-ttu-id="39c87-107">Pour prendre en charge le comportement ci-dessus, les fonctions de fournisseur réseau ne doivent pas appeler [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) avant de retourner.</span><span class="sxs-lookup"><span data-stu-id="39c87-107">To support the above behavior, network provider functions should not call [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) before returning.</span></span> <span data-ttu-id="39c87-108">Cela est dû au fait que le MPR appelle **SetLastError** pour les fonctions de l’API du fournisseur réseau une fois qu’il a retourné.</span><span class="sxs-lookup"><span data-stu-id="39c87-108">This is because the MPR calls **SetLastError** for the functions in the Network Provider API after they return.</span></span> <span data-ttu-id="39c87-109">Si les fournisseurs de réseau appellent **SetLastError** directement, ils effectuent des appels de fonction redondants.</span><span class="sxs-lookup"><span data-stu-id="39c87-109">If the network providers call **SetLastError** directly, they will be making redundant function calls.</span></span> <span data-ttu-id="39c87-110">Les fonctions des fournisseurs de réseau doivent simplement retourner un code d’erreur.</span><span class="sxs-lookup"><span data-stu-id="39c87-110">Network provider functions should simply return an error code.</span></span> <span data-ttu-id="39c87-111">Les codes d’erreur sont spécifiés dans la description de la fonction ou les [valeurs de retour](network-security-return-values.md).</span><span class="sxs-lookup"><span data-stu-id="39c87-111">The error codes are specified in the function description or [Return Values](network-security-return-values.md).</span></span> <span data-ttu-id="39c87-112">En outre, les fonctions du fournisseur de réseau peuvent retourner des [codes d’erreur système](../debug/system-error-codes.md), tels qu’une mémoire insuffisante.</span><span class="sxs-lookup"><span data-stu-id="39c87-112">Also, network provider functions may return any [System Error Codes](../debug/system-error-codes.md), such as insufficient memory.</span></span> <span data-ttu-id="39c87-113">La seule exception est [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps), qui doit retourner un masque indiquant les fonctions prises en charge par le fournisseur réseau.</span><span class="sxs-lookup"><span data-stu-id="39c87-113">The only exception is [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps), which should return a mask indicating the functions supported by the network provider.</span></span>

<span data-ttu-id="39c87-114">Si une fonction de fournisseur réseau doit retourner des informations d’erreur étendues, elle doit appeler [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora).</span><span class="sxs-lookup"><span data-stu-id="39c87-114">If a network provider function needs to return extended error information, it should call [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora).</span></span> <span data-ttu-id="39c87-115">Cette fonction est fournie par le système d’exploitation Windows pour une utilisation par les fournisseurs de réseau.</span><span class="sxs-lookup"><span data-stu-id="39c87-115">This function is provided by the Windows operating system for use by network providers.</span></span> <span data-ttu-id="39c87-116">Lorsque le fournisseur appelle **WNetSetLastError**, il peut définir une chaîne contenant des informations supplémentaires sur l’erreur.</span><span class="sxs-lookup"><span data-stu-id="39c87-116">When the provider calls **WNetSetLastError**, it can set a string containing additional information about the error.</span></span> <span data-ttu-id="39c87-117">Ces informations sont stockées par thread.</span><span class="sxs-lookup"><span data-stu-id="39c87-117">This information is stored on a per-thread basis.</span></span> <span data-ttu-id="39c87-118">Cela est analogue à [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) pour les applications Windows.</span><span class="sxs-lookup"><span data-stu-id="39c87-118">This is analogous to [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) for Windows applications.</span></span> <span data-ttu-id="39c87-119">Le système d’exploitation Windows appelle **WNetSetLastError** pour rechercher une chaîne stockée à l’aide de **WNetSetLastError** et, si elle est trouvée, retourne les informations d’erreur étendues à l’application appelante qui a initié la demande réseau.</span><span class="sxs-lookup"><span data-stu-id="39c87-119">The Windows operating system calls **WNetSetLastError** to check for a string stored using **WNetSetLastError** and, if found, returns the extended error information to the calling application that initiated the network request.</span></span>

> [!Note]  
> <span data-ttu-id="39c87-120">Le préfixe WNet de [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) est trompeur, car cette API, contrairement à **WNetSetLastError**, ne fait pas partie de l’ensemble des API réseau Windows.</span><span class="sxs-lookup"><span data-stu-id="39c87-120">The WNet prefix of [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) is misleading since this API, unlike **WNetSetLastError**, is not part of the Windows Networking API set.</span></span> <span data-ttu-id="39c87-121">**WNetSetLastError** est destiné à être utilisé uniquement par les fournisseurs de réseau.</span><span class="sxs-lookup"><span data-stu-id="39c87-121">**WNetSetLastError** is intended for use only by network providers.</span></span> <span data-ttu-id="39c87-122">Le nom, **WNetSetLastError**, est conservé pour la compatibilité avec les fournisseurs existants.</span><span class="sxs-lookup"><span data-stu-id="39c87-122">The name, **WNetSetLastError**, is retained for compatibility with existing providers.</span></span>

 

 

 
