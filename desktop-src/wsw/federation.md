---
title: Fédération
description: La Fédération permet à la délégation de l’autorité d’autorisation à d’autres membres d’un intersociété.
ms.assetid: 574496df-95dc-45f7-8c42-e646aec12e69
keywords:
- Services Web de Fédération pour Windows
- WWSAPI
- WWS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45a02744c9c0a5358da35f4c31c20633c420fee9
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/12/2021
ms.locfileid: "104559898"
---
# <a name="federation"></a><span data-ttu-id="6caac-106">Fédération</span><span class="sxs-lookup"><span data-stu-id="6caac-106">Federation</span></span>

<span data-ttu-id="6caac-107">La Fédération permet à la délégation de l’autorité d’autorisation à d’autres membres d’un intersociété.</span><span class="sxs-lookup"><span data-stu-id="6caac-107">Federation allows the delegation of authorization authority to other members of an interprise.</span></span> <span data-ttu-id="6caac-108">Par exemple, considérez le problème d’entreprise suivant : la société de fabrication de pièces auto contoso Ltd souhaite autoriser les employés autorisés de son client Fabrikam Inc à accéder en toute sécurité au service Web de commande des pièces de contoso.</span><span class="sxs-lookup"><span data-stu-id="6caac-108">For example, consider the following business problem: The auto parts manufacturing company Contoso Ltd would like to allow authorized employees of its customer Fabrikam Inc to securely access Contoso's parts order Web Service.</span></span> <span data-ttu-id="6caac-109">Une solution de sécurité pour ce scénario est que contoso peut configurer un mécanisme d’approbation avec Fabrikam pour déléguer la décision d’autorisation d’accès à fabrikam.</span><span class="sxs-lookup"><span data-stu-id="6caac-109">One security solution for this scenario is for Contoso to set up a trust mechanism with Fabrikam to delegate the access authorization decision to Fabrikam.</span></span> <span data-ttu-id="6caac-110">Ce processus peut fonctionner comme suit :</span><span class="sxs-lookup"><span data-stu-id="6caac-110">This process could work as follows:</span></span>

-   <span data-ttu-id="6caac-111">Fabrikam, lorsqu’il devient partenaire de contoso, configure un accord de confiance avec contoso.</span><span class="sxs-lookup"><span data-stu-id="6caac-111">Fabrikam, when it becomes a partner of Contoso, sets up a trust agreement with Contoso.</span></span> <span data-ttu-id="6caac-112">L’objectif de cette étape est d’accepter le type de jeton de sécurité et le contenu qui représenteront l’autorisation de Fabrikam et sera acceptable pour contoso.</span><span class="sxs-lookup"><span data-stu-id="6caac-112">The goal of this step is to agree on the security token type and content that will represent Fabrikam's authorization and will be acceptable to Contoso.</span></span> <span data-ttu-id="6caac-113">Par exemple, il peut être décidé qu’un certificat X. 509 approuvé avec le nom de sujet « CN = Fabrikam Inc Supplier STS » doit signer un jeton SAML pour que ce SAML soit accepté par le service Web contoso.</span><span class="sxs-lookup"><span data-stu-id="6caac-113">For example, it may be decided that a trusted X.509 certificate with subject name "CN=Fabrikam Inc Supplier STS" should sign a SAML token for that SAML to be accepted by the Contoso Web Service.</span></span> <span data-ttu-id="6caac-114">En outre, il peut être décidé que la revendication de sécurité dans le jeton SAML émis doit être « https://schemas.contoso.com/claims/lookup » (pour l’autorisation de recherche de pièce) ou « https://schemas.contoso.com/claims/order » (pour l’autorisation de classement de pièces).</span><span class="sxs-lookup"><span data-stu-id="6caac-114">Further, it may be decided that the security claim in the issued SAML token should be either 'https://schemas.contoso.com/claims/lookup' (for part lookup authorization) or 'https://schemas.contoso.com/claims/order' (for part ordering authorization).</span></span>
-   <span data-ttu-id="6caac-115">Lorsqu’un employé Fabrikam utilise l’application de classement des pièces internes, il contacte d’abord un service d’émission de jeton de sécurité (STS) au sein de fabrikam.</span><span class="sxs-lookup"><span data-stu-id="6caac-115">When a Fabrikam employee uses the internal parts ordering application, it first contacts a security token service (STS) inside Fabrikam.</span></span> <span data-ttu-id="6caac-116">Cet employé est authentifié à l’aide du mécanisme de sécurité Fabrikam interne (par exemple, nom d’utilisateur/mot de passe du domaine Windows), son autorisation de commander des pièces est vérifiée et il émet un jeton SAML de courte durée contenant les revendications appropriées et signé par le certificat X. 509 choisi ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="6caac-116">That employee is authenticated using the internal Fabrikam security mechanism (say, Windows domain username/password), his authorization to order parts is verified, and he is issued a short lived SAML token containing the appropriate claims and signed by the X.509 certificate decided above.</span></span> <span data-ttu-id="6caac-117">L’application de classement des pièces contacte ensuite le service Contoso présentant le jeton SAML émis pour authentifier et effectuer la tâche de tri.</span><span class="sxs-lookup"><span data-stu-id="6caac-117">The parts ordering application then contacts the Contoso service presenting the issued SAML token to authenticate and perform the ordering task.</span></span>

<span data-ttu-id="6caac-118">Ici, le STS Fabrikam agit comme le « tiers émetteur » et le service de parties contoso agit comme « partie de confiance ».</span><span class="sxs-lookup"><span data-stu-id="6caac-118">Here, the Fabrikam STS acts as the 'issuing party' and the Contoso parts service acts as the 'relying party'.</span></span> ![Diagramme montrant un tiers émetteur et une partie de confiance dans une Fédération.](images/stsmodel.png)

## <a name="federation-features"></a><span data-ttu-id="6caac-120">Fonctionnalités de Fédération</span><span class="sxs-lookup"><span data-stu-id="6caac-120">Federation Features</span></span>

<span data-ttu-id="6caac-121">Voici les fonctionnalités de sécurité prises en charge pour les tiers ou les rôles impliqués dans un scénario de Fédération :</span><span class="sxs-lookup"><span data-stu-id="6caac-121">The following are the supported security features for the parties or roles involved in a federation scenario:</span></span>

-   <span data-ttu-id="6caac-122">Côté client : pour obtenir le jeton de sécurité du STS, il est possible d’utiliser la fonction [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken) .</span><span class="sxs-lookup"><span data-stu-id="6caac-122">Client-side: For obtaining the security token from the STS, one may use [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken) function.</span></span> <span data-ttu-id="6caac-123">Vous pouvez également utiliser une bibliothèque de fournisseurs de jetons de sécurité côté client comme CardSpace ou LiveID, puis utiliser leur sortie pour créer localement un jeton de sécurité à l’aide de [**WsCreateXmlSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wscreatexmlsecuritytoken).</span><span class="sxs-lookup"><span data-stu-id="6caac-123">Alternatively, one may use a client side security token provider library such as CardSpace or LiveID, and then use their output to locally create a security token using [**WsCreateXmlSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wscreatexmlsecuritytoken).</span></span> <span data-ttu-id="6caac-124">Dans les deux cas, une fois que le client dispose du jeton de sécurité, il peut créer un canal vers le service qui spécifie la [**\_ \_ \_ \_ \_ liaison de sécurité de jeton WS XML**](/windows/desktop/api/WebServices/ns-webservices-ws_xml_token_message_security_binding) pour présenter le jeton, ainsi qu’une liaison de sécurité de transport telle que la [**\_ \_ \_ \_ liaison de sécurité de transport WS SSL**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) pour protéger le canal.</span><span class="sxs-lookup"><span data-stu-id="6caac-124">Either way, once the client has the security token, it may then create a channel to the service specifying [**WS\_XML\_TOKEN\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_xml_token_message_security_binding) to present the token, together with a transport security binding such as [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) to protect the channel.</span></span>
-   <span data-ttu-id="6caac-125">Côté serveur : dans un scénario de Fédération avec un service de jeton de sécurité qui émet des jetons SAML, le serveur peut utiliser la [**liaison de sécurité de message de WS \_ SAML \_ \_ \_**](/windows/desktop/api/WebServices/ns-webservices-ws_saml_message_security_binding), ainsi qu’une liaison de sécurité de transport telle que la liaison de [**\_ sécurité de \_ transport \_ \_ WS SSL**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) pour protéger le canal.</span><span class="sxs-lookup"><span data-stu-id="6caac-125">Server-side: In a federation scenario with a security token service that issues SAML tokens, the server may use the [**WS\_SAML\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_saml_message_security_binding), together with a transport security binding such as [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) to protect the channel.</span></span>
-   <span data-ttu-id="6caac-126">STS-Side : Notez que le STS est une application de service Web et qu’il peut spécifier les exigences de sécurité pour ceux qui demandent un jeton de sécurité à l’aide d’une structure de [**Description de sécurité**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) au moment de la création de l’écouteur comme tout autre service Web sécurisé.</span><span class="sxs-lookup"><span data-stu-id="6caac-126">STS-side: Note that the STS is a Web Service application, and it can specify the security requirements for those requesting a security token from it using a [**security description**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) structure at listener creation time just as any other secure Web Service would.</span></span> <span data-ttu-id="6caac-127">Il peut ensuite analyser les charges utiles des messages de demande entrants pour valider les demandes de jeton et renvoyer les jetons émis en tant que charges utiles de message de réponse.</span><span class="sxs-lookup"><span data-stu-id="6caac-127">It may then parse incoming request message payloads to validate the token requests and send back issued tokens as reply message payloads.</span></span> <span data-ttu-id="6caac-128">Actuellement, aucune fonctionnalité n’est fournie pour aider ces étapes d’analyse et d’émission.</span><span class="sxs-lookup"><span data-stu-id="6caac-128">Currently, no features are provided to help these parsing and issuing steps.</span></span>

<span data-ttu-id="6caac-129">Notez que le côté client peut gérer le jeton de sécurité émis de façon générique en tant que jeton de sécurité XML sans connaître le type de jeton ou effectuer un traitement spécifique au type de jeton.</span><span class="sxs-lookup"><span data-stu-id="6caac-129">Note that the client side can handle the issued security token generically as an XML security token without knowing the token type, or doing token type specific processing.</span></span> <span data-ttu-id="6caac-130">Toutefois, le serveur doit comprendre le type de jeton de sécurité spécifique afin de le comprendre et de le traiter.</span><span class="sxs-lookup"><span data-stu-id="6caac-130">However, the server has to understand the specific security token type in order to understand and process it.</span></span> <span data-ttu-id="6caac-131">Les étapes de demande et de réponse de jeton de sécurité utilisent les constructions définies dans la spécification WS-Trust.</span><span class="sxs-lookup"><span data-stu-id="6caac-131">The security token request and response steps use the constructs defined in the WS-Trust specification.</span></span>

## <a name="more-complex-federation-scenarios"></a><span data-ttu-id="6caac-132">Scénarios de Fédération plus complexes</span><span class="sxs-lookup"><span data-stu-id="6caac-132">More Complex Federation Scenarios</span></span>

<span data-ttu-id="6caac-133">Un scénario de Fédération peut impliquer plusieurs émission formant une chaîne de Fédération.</span><span class="sxs-lookup"><span data-stu-id="6caac-133">A federation scenario may involve multiple STSs that form a federation chain.</span></span> <span data-ttu-id="6caac-134">Prenons l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="6caac-134">Consider the following example:</span></span>

-   <span data-ttu-id="6caac-135">Le client s’authentifie auprès du STS STS à l’aide d’un nom d’utilisateur et d’un mot de passe LiveID et obtient un jeton de sécurité T1.</span><span class="sxs-lookup"><span data-stu-id="6caac-135">Client authenticates to the LiveID STS using a LiveID username/password, and obtains a security token T1.</span></span>
-   <span data-ttu-id="6caac-136">Le client s’authentifie auprès de STS1 à l’aide de T1 et obtient un jeton de sécurité T2.</span><span class="sxs-lookup"><span data-stu-id="6caac-136">Client authenticates to STS1 using T1 and obtains a security token T2.</span></span>
-   <span data-ttu-id="6caac-137">Le client s’authentifie auprès de STS2 à l’aide de T2 et obtient un jeton de sécurité T3.</span><span class="sxs-lookup"><span data-stu-id="6caac-137">Client authenticates to STS2 using T2 and obtains a security token T3.</span></span>
-   <span data-ttu-id="6caac-138">Le client s’authentifie auprès du service cible à l’aide de T3.</span><span class="sxs-lookup"><span data-stu-id="6caac-138">Client authenticates to the target service S using T3.</span></span>

<span data-ttu-id="6caac-139">Ici, L’LiveID STS, STS1, STS2 et S constituent la chaîne de Fédération.</span><span class="sxs-lookup"><span data-stu-id="6caac-139">Here, the LiveID STS, STS1, STS2 and S form the federation chain.</span></span> <span data-ttu-id="6caac-140">Les émission dans une chaîne de Fédération peuvent exécuter différents rôles pour le scénario d’application globale.</span><span class="sxs-lookup"><span data-stu-id="6caac-140">The STSs in a federation chain may perform various roles for the overall application scenario.</span></span> <span data-ttu-id="6caac-141">Parmi ces rôles fonctionnels STS, citons le fournisseur d’identité, le décideur d’autorisation, Anonymizer et Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="6caac-141">Examples of such STS functional roles include identity provider, authorization decision maker, anonymizer, and resource manager.</span></span>

## <a name="sts-request-parameters-and-metadata-exchange"></a><span data-ttu-id="6caac-142">Paramètres de demande STS et échange de métadonnées</span><span class="sxs-lookup"><span data-stu-id="6caac-142">STS Request Parameters and Metadata Exchange</span></span>

<span data-ttu-id="6caac-143">Pour que le client réussisse un appel [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken) , il doit connaître les paramètres de cet appel (tels que le type de jeton et les types de revendication requis), les spécifications de la description de la [**sécurité**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) du canal de demande au STS et l’adresse du [point de terminaison](endpoint-address.md) du STS.</span><span class="sxs-lookup"><span data-stu-id="6caac-143">For the client to make a successful [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken) call, it needs to know the parameters of that call (such as the required token type and claim types), the [**security description**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) requirements of the request channel to the STS, and the [endpoint address](endpoint-address.md) of the STS.</span></span> <span data-ttu-id="6caac-144">L’application cliente peut utiliser l’une des techniques suivantes pour déterminer ces informations :</span><span class="sxs-lookup"><span data-stu-id="6caac-144">The client application may use any of the following techniques for determining this information:</span></span>

-   <span data-ttu-id="6caac-145">Coder en dur les informations de l’application dans le cadre des décisions au moment de la conception.</span><span class="sxs-lookup"><span data-stu-id="6caac-145">Hard code the information in the application as part of the design time decisions.</span></span>
-   <span data-ttu-id="6caac-146">Lisez ces informations à partir d’un fichier de configuration au niveau de l’application configuré par le programme de déploiement d’applications local.</span><span class="sxs-lookup"><span data-stu-id="6caac-146">Read this information from an application level configuration file set up by the local application deployer.</span></span>
-   <span data-ttu-id="6caac-147">Détectez dynamiquement ces informations au moment de l’exécution à l’aide de la fonctionnalité d' [importation de métadonnées](metadata-import.md) avec la structure de [**contrainte de \_ liaison de sécurité de \_ \_ message \_ \_ \_ de jeton WS**](/windows/desktop/api/WebServices/ns-webservices-ws_issued_token_message_security_binding_constraint) .</span><span class="sxs-lookup"><span data-stu-id="6caac-147">Dynamically discover this information at runtime using the [metadata import](metadata-import.md) feature with the [**WS\_ISSUED\_TOKEN\_MESSAGE\_SECURITY\_BINDING\_CONSTRAINT**](/windows/desktop/api/WebServices/ns-webservices-ws_issued_token_message_security_binding_constraint) structure.</span></span>

<span data-ttu-id="6caac-148">Pour illustrer l’utilisation de MEX dynamique avec la Fédération, considérez l’exemple 3 STS ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="6caac-148">To illustrate the use of dynamic MEX with federation, consider the 3 STS example above.</span></span> <span data-ttu-id="6caac-149">Le client effectue tout d’abord un MEX dynamique avec des pour obtenir des informations sur T3 (c’est-à-dire, ce qu’il faut demander à partir de STS2), ainsi que l’adresse MEX dynamique STS2 (par exemple, où trouver STS2).</span><span class="sxs-lookup"><span data-stu-id="6caac-149">The client will first do a dynamic MEX with S to obtain information about T3 (i.e., what to ask from STS2) as well as the STS2 dynamic MEX address (i.e., where to find STS2).</span></span> <span data-ttu-id="6caac-150">Il utilise ensuite ces informations pour effectuer un MEX dynamique avec STS2 pour découvrir des informations sur T2 et STS1, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="6caac-150">It will then use that information to do a dynamic MEX with STS2 to discover information about T2 and STS1, and so on.</span></span>

<span data-ttu-id="6caac-151">Ainsi, les étapes MEX dynamiques s’effectuent dans l’ordre 4, 3, 2, 1 pour créer la chaîne de Fédération et les étapes de demande et de présentation du jeton sont effectuées dans l’ordre 1, 2, 3, 4 pour dérouler la chaîne de Fédération.</span><span class="sxs-lookup"><span data-stu-id="6caac-151">Thus, the dynamic MEX steps take place in the order 4, 3, 2, 1 to build up the federation chain and the token request and presentation steps take place in the order 1, 2, 3, 4 to unwind the federation chain.</span></span>

> [!Note]  
> <span data-ttu-id="6caac-152">Windows 7 et Windows Server 2008 R2 : WWSAPI prend uniquement en charge [WS-Trust](https://specs.xmlsoap.org/ws/2005/02/trust/WS-Trust.pdf) et [WS-SecureConversation](https://specs.xmlsoap.org/ws/2005/02/sc/WS-SecureConversation.pdf) comme défini par [Lightweight Web Services Security Profile (LWSSP)](/openspecs/windows_protocols/ms-lwssp/376af2f8-f4fe-4577-bfd5-370ac12cac2e).</span><span class="sxs-lookup"><span data-stu-id="6caac-152">Windows 7 and Windows Server 2008 R2: WWSAPI only supports [Ws-Trust](https://specs.xmlsoap.org/ws/2005/02/trust/WS-Trust.pdf) and [Ws-SecureConversation](https://specs.xmlsoap.org/ws/2005/02/sc/WS-SecureConversation.pdf) as defined by [Lightweight Web Services Security Profile (LWSSP)](/openspecs/windows_protocols/ms-lwssp/376af2f8-f4fe-4577-bfd5-370ac12cac2e).</span></span> <span data-ttu-id="6caac-153">Pour plus d’informations sur l’implémentation de Microsoft, consultez la section relative à la [syntaxe du message](/openspecs/windows_protocols/ms-lwssp/d4f0f509-e14a-47b5-81e8-ade06a51d1ed) de LWSSP.</span><span class="sxs-lookup"><span data-stu-id="6caac-153">For details regarding Microsoft's implementation please see the [MESSAGE Syntax](/openspecs/windows_protocols/ms-lwssp/d4f0f509-e14a-47b5-81e8-ade06a51d1ed) section of LWSSP.</span></span>

 

 

 