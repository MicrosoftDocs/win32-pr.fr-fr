---
title: Objets incorporés (Text Services Framework)
description: Text Services Framework permet à un service de texte d’incorporer des objets dans un flux de texte d’application.
ms.assetid: 44cb22b5-707b-4f21-b986-5258ed273543
keywords:
- Text Services Framework (TSF), objets incorporés
- TSF (Text Services Framework), objets incorporés
- Applications compatibles TSF, objets incorporés
- objets incorporés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39e4f819e6f42cc4e8d2ed81e47c79efe5ff7407
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/10/2020
ms.locfileid: "104564381"
---
# <a name="embedded-objects-text-services-framework"></a><span data-ttu-id="19927-107">Objets incorporés (Text Services Framework)</span><span class="sxs-lookup"><span data-stu-id="19927-107">Embedded Objects (Text Services Framework)</span></span>

<span data-ttu-id="19927-108">Text Services Framework permet à un service de texte d’incorporer des objets dans un flux de texte d’application.</span><span class="sxs-lookup"><span data-stu-id="19927-108">Text Services Framework enables a text service to embed objects in an application text stream.</span></span> <span data-ttu-id="19927-109">Les objets incorporés sont insérés dans le flux de texte à l’aide de la valeur [TS \_ char \_ Embedded](ts-char--constants.md).</span><span class="sxs-lookup"><span data-stu-id="19927-109">Embedded objects are inserted into the text stream using the value [TS\_CHAR\_EMBEDDED](ts-char--constants.md).</span></span> <span data-ttu-id="19927-110">Cette valeur correspond au caractère de remplacement d’objet Unicode U + FFFC, à l’aide de la notation hexadécimale.</span><span class="sxs-lookup"><span data-stu-id="19927-110">This value resolves to the Unicode object replacement character U+fffc, using hexadecimal notation.</span></span> <span data-ttu-id="19927-111">Par exemple, l’illustration suivante montre le rendu d’un objet incorporé qui représente le IDÉOGRAMME *Hi* japonais, en association avec la séquence de caractères Unicode qui représente la traduction en anglais de « Sun ».</span><span class="sxs-lookup"><span data-stu-id="19927-111">For example, the following illustration shows the rendering of an embedded object that represents the Japanese ideograph *hi*, in combination with the sequence of Unicode characters that represent the English translation of "Sun."</span></span>

![encodage de caractères d’un objet incorporé](images/emb-obj.gif)

<span data-ttu-id="19927-113">La ligne supérieure de la figure contient le texte traduit, composé du mot « Sun » suivi du caractère japonais pour Sun, *Hi*.</span><span class="sxs-lookup"><span data-stu-id="19927-113">The top row of the figure contains the translated text, consisting of the word "Sun" followed by the Japanese character for sun, *hi*.</span></span> <span data-ttu-id="19927-114">La ligne centrale de l’illustration montre le caractère Unicode.</span><span class="sxs-lookup"><span data-stu-id="19927-114">The center row of the figure shows the Unicode character.</span></span> <span data-ttu-id="19927-115">Dans le cas de U + FFFC, il s’agit du caractère de remplacement de l’objet.</span><span class="sxs-lookup"><span data-stu-id="19927-115">In the case of U+fffc, this is the object replacement character.</span></span> <span data-ttu-id="19927-116">La ligne inférieure de la figure montre la valeur hexadécimale de chaque caractère.</span><span class="sxs-lookup"><span data-stu-id="19927-116">The bottom row of the figure shows the hexadecimal value of each character.</span></span>

## <a name="supporting-embedded-objects-in-an-application"></a><span data-ttu-id="19927-117">Prise en charge des objets incorporés dans une application</span><span class="sxs-lookup"><span data-stu-id="19927-117">Supporting Embedded Objects in an Application</span></span>

<span data-ttu-id="19927-118">Le gestionnaire TSF insère un objet incorporé dans le flux de texte en appelant [ITextStoreACP :: InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) pour une application ACP, ou [ITextStoreAnchor :: InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) pour une application basée sur un point d’ancrage.</span><span class="sxs-lookup"><span data-stu-id="19927-118">The TSF manager inserts an embedded object into the text stream by calling [ITextStoreACP::InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) for an ACP-based application, or [ITextStoreAnchor::InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) for an anchor-based application.</span></span> <span data-ttu-id="19927-119">Lorsqu’un objet incorporé est inséré, l’application doit placer la valeur du caractère **\_ \_ incorporé TS** au niveau de la position du caractère (ou de l’emplacement d’ancrage) où l’objet est incorporé et stocker l’IDataObject associé à l’objet incorporé.</span><span class="sxs-lookup"><span data-stu-id="19927-119">When an embedded object is inserted, the application should place the **TS\_CHAR\_EMBEDDED** value at the character position (or anchor location) where the object is embedded and store the IDataObject associated with the embedded object.</span></span> <span data-ttu-id="19927-120">Quand [ITextStoreACP :: gettext](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) ou [ITextStoreAnchor :: gettext](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) est appelé et qu’un objet incorporé est contenu dans le texte obtenu, la valeur **\_ \_ Embedded char TS** indique la présence et l’emplacement de l’objet incorporé.</span><span class="sxs-lookup"><span data-stu-id="19927-120">When [ITextStoreACP::GetText](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) or [ITextStoreAnchor::GetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) is called and an embedded object is contained within the text obtained, the **TS\_CHAR\_EMBEDDED** value indicates the presence and location of the embedded object.</span></span> <span data-ttu-id="19927-121">Pour obtenir l’objet incorporé, appelez [ITextStoreACP :: GetEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) avec la position de caractère de l’objet incorporé ou [ITextStoreAnchor :: GetEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) avec l’emplacement d’ancrage de l’objet incorporé.</span><span class="sxs-lookup"><span data-stu-id="19927-121">To obtain the embedded object, call [ITextStoreACP::GetEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) with the character position of the embedded object, or [ITextStoreAnchor::GetEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) with the anchor location of the embedded object.</span></span>

<span data-ttu-id="19927-122">L’application ne reconnaît pas normalement le contenu de l’objet incorporé.</span><span class="sxs-lookup"><span data-stu-id="19927-122">The application does not normally recognize the embedded object contents.</span></span> <span data-ttu-id="19927-123">L’application peut tenter d’obtenir des informations d’affichage à partir de l’objet lui-même.</span><span class="sxs-lookup"><span data-stu-id="19927-123">The application can attempt to obtain display information from the object itself.</span></span> <span data-ttu-id="19927-124">Si l’objet incorporé peut fournir des données dans un format reconnu par l’application, tel que CF \_ UNICODETEXT ou CF \_ bitmap, l’application peut afficher des informations graphiques fournies par l’objet.</span><span class="sxs-lookup"><span data-stu-id="19927-124">If the embedded object can supply data in a format that the application recognizes, such as CF\_UNICODETEXT or CF\_BITMAP, the application can display graphic information supplied by the object.</span></span>

## <a name="inserting-embedded-objects"></a><span data-ttu-id="19927-125">Insertion d’objets incorporés</span><span class="sxs-lookup"><span data-stu-id="19927-125">Inserting Embedded Objects</span></span>

<span data-ttu-id="19927-126">Un service de texte insère un objet incorporé dans un contexte en appelant [ITfRange :: InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) ou [ITfInsertAtSelection :: InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span><span class="sxs-lookup"><span data-stu-id="19927-126">A text service inserts an embedded object into a context by calling [ITfRange::InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) or [ITfInsertAtSelection::InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span></span> <span data-ttu-id="19927-127">Le service de texte doit fournir l’IDataObject incorporé.</span><span class="sxs-lookup"><span data-stu-id="19927-127">The text service must supply the embedded IDataObject.</span></span>

 

 
