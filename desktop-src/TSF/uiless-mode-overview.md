---
title: Vue d’ensemble du mode UILess
description: Vue d’ensemble du mode UILess
ms.assetid: cc0e4936-eab1-452d-9ba1-188401918e99
keywords:
- Text Services Framework (TSF), UILessMode
- TSF (Text Services Framework), UILessMode
- Applications compatibles TSF, UILessMode
- UILessMode
- Text Services Framework (TSF), liste de candidats UIElement
- TSF (Text Services Framework), liste de candidats UIElement
- Applications compatibles TSF, liste de candidats UIElement
- UIElement liste de candidats
- Text Services Framework (TSF), info-bulle UIElement
- TSF (Text Services Framework), info-bulle UIElement
- Applications compatibles TSF, info-bulle UIElement
- Info-bulle UIElement
- Text Services Framework (TSF), éléments d’interface utilisateur prédéfinis
- TSF (Text Services Framework), éléments d’interface utilisateur prédéfinis
- Applications compatibles TSF, éléments d’interface utilisateur prédéfinis
- éléments d’interface utilisateur prédéfinis
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7354a88fb28fd0d6bf5f4180ac23359a2117fe7
ms.sourcegitcommit: ee06501cc29132927ade9813e0888aaa4decc487
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/28/2021
ms.locfileid: "104553457"
---
# <a name="uiless-mode-overview"></a><span data-ttu-id="0afab-119">Vue d’ensemble du mode UILess</span><span class="sxs-lookup"><span data-stu-id="0afab-119">UILess Mode Overview</span></span>

## <a name="how-to-create-uilessmode"></a><span data-ttu-id="0afab-120">Création de UILessMode</span><span class="sxs-lookup"><span data-stu-id="0afab-120">How to create UILessMode</span></span>

<span data-ttu-id="0afab-121">**Création d’un thread sans interface utilisateur :** L’application peut rendre une interface utilisateur moins thread par [**ITfThreadMgrEx :: ActivateEx**](/windows/desktop/api/Msctf/nf-msctf-itfthreadmgrex-activateex) avec ITF \_ AE \_ UIELEMENTENABLEDONLY.</span><span class="sxs-lookup"><span data-stu-id="0afab-121">**Making UI-less Thread:** The application can make a UI Less Thread by [**ITfThreadMgrEx::ActivateEx**](/windows/desktop/api/Msctf/nf-msctf-itfthreadmgrex-activateex) with ITF\_AE\_UIELEMENTENABLEDONLY.</span></span> <span data-ttu-id="0afab-122">Quand ThreadMgr est activé avec cet indicateur, seules les astuces qui peuvent contrôler son élément d’interface utilisateur sont activées sur le thread.</span><span class="sxs-lookup"><span data-stu-id="0afab-122">When ThreadMgr is activated with this flag, only TIPs that can control its UI element are activated on the thread.</span></span> <span data-ttu-id="0afab-123">L’application doit implémenter l’interface [**ITfUIElementSink**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) et informer l’interface dans le gestionnaire de threads.</span><span class="sxs-lookup"><span data-stu-id="0afab-123">The application needs to implement [**ITfUIElementSink**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) interface and advise the interface into thread manager.</span></span> <span data-ttu-id="0afab-124">[**ITfUIElementSink :: BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-beginuielement) est appelé quand le TIP affiche son interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0afab-124">[**ITfUIElementSink::BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-beginuielement) is called when TIP shows its UI.</span></span> <span data-ttu-id="0afab-125">L’application peut retourner **true** dans pbShow param pour permettre à Tip d’afficher l’interface utilisateur d’origine de l’info-bulle lorsque l’application ne souhaite pas dessiner.</span><span class="sxs-lookup"><span data-stu-id="0afab-125">The application can return **TRUE** in pbShow param to allow TIP to show TIP's original UI when the application does not want to draw.</span></span> <span data-ttu-id="0afab-126">Si l’application n’autorise pas l’interface utilisateur du TIP, elle peut retourner la **valeur false** dans pbShow (consultez les diagrammes ci-dessous).</span><span class="sxs-lookup"><span data-stu-id="0afab-126">If the application does not allow TIP's UI, it can return **FALSE** in pbShow (see diagrams below).</span></span> <span data-ttu-id="0afab-127">L’application peut dessiner l’interface utilisateur en lui-même en obtenant des informations à partir du paramètre d' *Empelement* .</span><span class="sxs-lookup"><span data-stu-id="0afab-127">The application can draw the UI by itself by getting some information from the *pElement* param.</span></span> <span data-ttu-id="0afab-128">Il peut s’agir de la liste candidate, de l’élément de la barre de langue ou de l’interface utilisateur personnalisée du Conseil.</span><span class="sxs-lookup"><span data-stu-id="0afab-128">It could be the candidate list, the language bar item, or the custom UI of TIP.</span></span> <span data-ttu-id="0afab-129">L’application peut connaître le type d’interface utilisateur par l’interface QIing [**ITfUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) .</span><span class="sxs-lookup"><span data-stu-id="0afab-129">The application can know the kind of UI by QIing [**ITfUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) interface.</span></span> <span data-ttu-id="0afab-130">Lorsque l’interface utilisateur est modifiée, [**ITfUIElementSink :: UpdateUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-updateuielement) est appelée.</span><span class="sxs-lookup"><span data-stu-id="0afab-130">When the UI is changed, [**ITfUIElementSink::UpdateUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-updateuielement) is called.</span></span> <span data-ttu-id="0afab-131">L’application peut comparer le GUID de l’enpelement->GetGUID () pour savoir si l’élément est actuellement dessiné par l’application.</span><span class="sxs-lookup"><span data-stu-id="0afab-131">The application can compare the GUID from pElement->GetGUID() to know if the element is currently drawn by the application.</span></span>

<span data-ttu-id="0afab-132">**Astuce pour la prise en charge de l’interface utilisateur :** Le Conseil doit prendre en charge le mode sans interface utilisateur s’il souhaite s’exécuter sous l’application qui ne souhaite pas autoriser l’interface utilisateur du TIP, comme l’application de jeu ou les applications plein écran.</span><span class="sxs-lookup"><span data-stu-id="0afab-132">**Making UI-less Aware TIP:** TIP should support UI less mode if it wants to run under the application that does not want to allow TIP's UI such as game application or full screen applications.</span></span> <span data-ttu-id="0afab-133">Pour être moins conscient de l’interface utilisateur, TIP doit implémenter l’interface [**ITfTextInputProcessorEx**](/windows/desktop/api/Msctf/nn-msctf-itftextinputprocessorex) .</span><span class="sxs-lookup"><span data-stu-id="0afab-133">To be UI less aware, TIP needs to implement [**ITfTextInputProcessorEx**](/windows/desktop/api/Msctf/nn-msctf-itftextinputprocessorex) interface.</span></span> <span data-ttu-id="0afab-134">Si cette interface n’est pas implémentée, TIP ne sera pas activé sous le thread en mode sans interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0afab-134">If this interface is not implemented, TIP will not be activated under the UI less mode thread.</span></span> <span data-ttu-id="0afab-135">En outre, TIP doit appeler [**ITFUIElementMgr :: BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement) avant d’afficher une interface utilisateur visible à l’écran.</span><span class="sxs-lookup"><span data-stu-id="0afab-135">In addition, TIP must call [**ITFUIElementMgr::BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement) before it shows a visible UI to the screen.</span></span> <span data-ttu-id="0afab-136">Cette méthode effectue un appel à [**ITfUIElementSink**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) pour notifier l’application.</span><span class="sxs-lookup"><span data-stu-id="0afab-136">This method makes a call to [**ITfUIElementSink**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) to notify the application.</span></span> <span data-ttu-id="0afab-137">Et l’application décidera si elle peut être affichée ou non.</span><span class="sxs-lookup"><span data-stu-id="0afab-137">And the application will decide if it can be shown or not.</span></span> <span data-ttu-id="0afab-138">Quand TIP appelle BeginUIElement (), TIP doit avoir l’interface [**ITfUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) pour l’interface utilisateur correspondante.</span><span class="sxs-lookup"><span data-stu-id="0afab-138">When TIP calls BeginUIElement(), TIP needs to have the [**ITfUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) interface for the corresponding UI.</span></span> <span data-ttu-id="0afab-139">L’application effectue un QI en QI pour obtenir une autre interface spécifique à l’interface utilisateur afin de récupérer plus d’informations pour dessiner l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0afab-139">The application will QI the interface to get another UI specific interface to retrieve more information to draw the UI.</span></span> <span data-ttu-id="0afab-140">Le système prédéfinit [**ITfCandidateListUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfcandidatelistuielement) et [**ITfReadingInformationUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfreadinginformationuielement) pour Tip.</span><span class="sxs-lookup"><span data-stu-id="0afab-140">System predefines [**ITfCandidateListUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfcandidatelistuielement) and [**ITfReadingInformationUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfreadinginformationuielement) for TIP.</span></span> <span data-ttu-id="0afab-141">Quand le TIP souhaite afficher la liste des candidats en mode thread sans interface utilisateur, TIP doit créer une instance de l’interface **ITfCandidateListUIElement** et appeler **ITFUIElementMgr :: BeginUIElement**.</span><span class="sxs-lookup"><span data-stu-id="0afab-141">When TIP wants to show the candidate list under UI less mode thread, TIP must create an instance of the **ITfCandidateListUIElement** interface and call **ITFUIElementMgr::BeginUIElement**.</span></span> <span data-ttu-id="0afab-142">Quand [**ITfTextInputProcessorEx :: ActivateEx**](/windows/desktop/api/Msctf/nf-msctf-itftextinputprocessorex-activateex) est appelé, Conseil sait déjà que le thread est moins d’interface utilisateur, ce qui permet d’éliminer l’interface utilisateur personnalisée supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="0afab-142">When [**ITfTextInputProcessorEx::ActivateEx**](/windows/desktop/api/Msctf/nf-msctf-itftextinputprocessorex-activateex) is called, TIP already know the thread is UI less more so it can eliminate the extra custom UI.</span></span> <span data-ttu-id="0afab-143">Toutefois, bien entendu, il peut implémenter sa propre interface qui peut être QIed et essayer d’effectuer une notification.</span><span class="sxs-lookup"><span data-stu-id="0afab-143">However, of course, it can implement its own interface that can be QIed from and try to make a notification.</span></span> <span data-ttu-id="0afab-144">Ainsi, le TIP et l’applicateur **ITfUIElement** cationique peuvent avoir une négociation pour l’interface utilisateur personnalisée Tip.</span><span class="sxs-lookup"><span data-stu-id="0afab-144">Thus TIP and the appli **ITfUIElement** cation can have a negotiation for the TIP custom UI.</span></span>

## <a name="uielement-supporting-tip"></a><span data-ttu-id="0afab-145">Info-bulle de support UIElement</span><span class="sxs-lookup"><span data-stu-id="0afab-145">UIElement Supporting TIP</span></span>

<span data-ttu-id="0afab-146">Le Conseil qui prend en charge l’UIElement doit être catégorisé par GUID \_ TFCAT \_ TIPCAP \_ UIELEMENTENABLED.</span><span class="sxs-lookup"><span data-stu-id="0afab-146">The TIP that supports the UIElement must be categorized by GUID\_TFCAT\_TIPCAP\_UIELEMENTENABLED.</span></span> <span data-ttu-id="0afab-147">Le Conseil dans GUID \_ TFCAT \_ TIPCAP \_ UIELEMENTENABLED doit utiliser [**ITfUIElementMgr**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) pour afficher une interface utilisateur afin que l’application puisse contrôler la visibilité de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0afab-147">The TIP in GUID\_TFCAT\_TIPCAP\_UIELEMENTENABLED must use [**ITfUIElementMgr**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) to show any UI so the application can control the visibility of the UI.</span></span>

<span data-ttu-id="0afab-148">**Afficher/masquer l’état de l’UIElement :** Afficher/masquer l’état indiqué par la méthode [**ITfUIElement :: Show**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-show) ou [**ITfUIElement :: IsShown**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-isshown) est l’état visible réel.</span><span class="sxs-lookup"><span data-stu-id="0afab-148">**Show/Hide status of UIElement:** Show/Hide status that is indicated by [**ITfUIElement::Show**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-show) or [**ITfUIElement::IsShown**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-isshown) method is the actual visible status.</span></span> <span data-ttu-id="0afab-149">Elle n’est pas liée à la disponibilité d’UIElement.</span><span class="sxs-lookup"><span data-stu-id="0afab-149">It is not related to the availability of UIElement.</span></span> <span data-ttu-id="0afab-150">UIElement doit toujours être disponible lorsque l’affichage de l’État existe.</span><span class="sxs-lookup"><span data-stu-id="0afab-150">UIElement should be always available when the show status exists.</span></span> <span data-ttu-id="0afab-151">L’affichage de l’État est contrôlable à partir de l’application.</span><span class="sxs-lookup"><span data-stu-id="0afab-151">The show status is controllable from the application.</span></span> <span data-ttu-id="0afab-152">L’application peut soudainement passer en mode UILess et commencer à dessiner une interface utilisateur seule, en appelant **ITfUIElement :: Show** with **false** pour masquer toute l’interface utilisateur du TIP.</span><span class="sxs-lookup"><span data-stu-id="0afab-152">The application may suddenly move into UILess mode and start drawing some UI by itself, by calling **ITfUIElement::Show** with **FALSE** to hide all the UI of TIP.</span></span> <span data-ttu-id="0afab-153">Ensuite, TIP peut prendre l’une des options ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="0afab-153">Then TIP can take one of some options.</span></span> <span data-ttu-id="0afab-154">1) Conseil peut déplacer l’UIElement vers l’état de masquage et commencer à générer des UpdateUIElement.</span><span class="sxs-lookup"><span data-stu-id="0afab-154">1) TIP can move the UIElement to the Hide status and start generating UpdateUIElement.</span></span> <span data-ttu-id="0afab-155">2) l’info-bulle peut terminer UIElement, car l’élément d’interface utilisateur ne prend pas en charge Hide Status et Tip appelle EndUIElement () pour le terminer.</span><span class="sxs-lookup"><span data-stu-id="0afab-155">2) TIP can finish UIElement since the UI element does not support Hide status and Tip calls EndUIElement() to finish it.</span></span>

## <a name="predefined-ui-elements"></a><span data-ttu-id="0afab-156">Éléments d’interface utilisateur prédéfinis</span><span class="sxs-lookup"><span data-stu-id="0afab-156">Predefined UI Elements</span></span>

<span data-ttu-id="0afab-157">**Liste des candidats :** La liste candidate est l’un des principaux éléments d’interface utilisateur pour l’entrée EA.</span><span class="sxs-lookup"><span data-stu-id="0afab-157">**The candidate list:** The candidate list is one of the major UI elements for EA input.</span></span> <span data-ttu-id="0afab-158">Cet élément d’interface utilisateur fournit la liste de candidats et le nombre correspondant de chaînes candidates pour le dessin.</span><span class="sxs-lookup"><span data-stu-id="0afab-158">This UI Element provides the candidate list and corresponding number of the candidate strings for drawing.</span></span>

<span data-ttu-id="0afab-159">**Fenêtre informations de lecture** La fenêtre informations de lecture est courante pour l’entrée au clavier chinois.</span><span class="sxs-lookup"><span data-stu-id="0afab-159">**The reading information window** The reading information window is common for Chinese Keyboard Input.</span></span> <span data-ttu-id="0afab-160">Il a l’étape qui ne peut pas être insérée dans le document comme chaîne de composition.</span><span class="sxs-lookup"><span data-stu-id="0afab-160">It has the stage that cannot be inserted into the document as the composition string.</span></span> <span data-ttu-id="0afab-161">Certains processeurs d’entrée en chinois ouvrent une petite fenêtre d’informations de lecture qui affiche les informations de lecture, phonétique ou de saisie.</span><span class="sxs-lookup"><span data-stu-id="0afab-161">Some Chinese Input Processor opens a small reading information window that shows the reading, phonetic or typing information.</span></span>

## <a name="the-flow-chart-of-uilessmode"></a><span data-ttu-id="0afab-162">Organigramme de UILessMode</span><span class="sxs-lookup"><span data-stu-id="0afab-162">The flow chart of UILessMode</span></span>

![Diagramme qui montre le graphique de bord U I LessMode.](images/tsf-uilessmode-ovw1.gif)

<span data-ttu-id="0afab-164">Une fois que l’info-bulle a reçu la **valeur true** dans \* pbShown par [**ITfUIElementMgr :: BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement), l’astuce n’a pas besoin d’appeler UpdateUIElement pour l’UIElement.</span><span class="sxs-lookup"><span data-stu-id="0afab-164">After the TIP receives **TRUE** in \*pbShown by [**ITfUIElementMgr::BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement), the TIP does not have to call UpdateUIElement for the UIElement.</span></span> <span data-ttu-id="0afab-165">Mais TIP doit appeler EndUIElement () afin que le [**ITfUIElementMgr**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) et l’application puissent suivre l’état d’UIElement.</span><span class="sxs-lookup"><span data-stu-id="0afab-165">But TIP needs to call EndUIElement() so the [**ITfUIElementMgr**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) and the application can track the status of UIElement.</span></span> <span data-ttu-id="0afab-166">TIP doit appeler UpdateUIElement () après que BeginUIElement () a retourné la **valeur false** dans \* pbShow.</span><span class="sxs-lookup"><span data-stu-id="0afab-166">TIP must calls UpdateUIElement() after BeginUIElement() returns **FALSE** in \*pbShow.</span></span> <span data-ttu-id="0afab-167">L’application qui souhaite dessiner l’interface utilisateur ne vérifie pas le contenu dans BeginUIElement (), elle retourne simplement l’État Show sur BeginUIElement () et commence à vérifier le contenu à UpdateUIElement ().</span><span class="sxs-lookup"><span data-stu-id="0afab-167">The application that wants to draw the UI does not check the contents in BeginUIElement(), it just returns the show status at BeginUIElement() and starts checking the contents at UpdateUIElement().</span></span> <span data-ttu-id="0afab-168">Par exemple, l’indicateur de mise à jour de la liste de candidats UIElement a tous les bits au premier UpdateUIElement ().</span><span class="sxs-lookup"><span data-stu-id="0afab-168">For example, the update flag of the candidate list UIElement has all bits at the first UpdateUIElement().</span></span> <span data-ttu-id="0afab-169">Cela signifie que le contenu d’UIElement n’a pas besoin d’être prêt sur BeginUIElement ().</span><span class="sxs-lookup"><span data-stu-id="0afab-169">This means that the contents of UIElement does not have to be ready at BeginUIElement().</span></span>

![Diagramme qui indique quand le T I P appelle’ITUIElementMgr :: BeginUIElement () 'et’BeginUIElement’UIElementSink’de l’application est appelé.](images/tsf-uilessmode-ovw2.gif)![Diagramme qui montre que l’application retourne FALSe dans \* pbShow.](images/tsf-uilessmode-ovw3.gif)![Organigramme uilessmode](images/tsf-uilessmode-ovw4.gif)

## <a name="the-candidate-list-uielement"></a><span data-ttu-id="0afab-173">UIElement liste candidate</span><span class="sxs-lookup"><span data-stu-id="0afab-173">The candidate list UIElement</span></span>

<span data-ttu-id="0afab-174">**À propos de IndexPage :** L’application qui dessine la liste candidate calcule le nombre de chaînes par page lorsque le contenu de la liste est modifié (la \_ chaîne TF CLUIE \_ est définie).</span><span class="sxs-lookup"><span data-stu-id="0afab-174">**About PageIndex:** The application that draws the candidate list will calculate the number of strings per page when the contents of the list is changed (TF\_CLUIE\_STRING is set).</span></span> <span data-ttu-id="0afab-175">Il n’est pas recommandé de modifier l’index de page tant que la liste candidate est disponible pour le mode UILess.</span><span class="sxs-lookup"><span data-stu-id="0afab-175">It is not good to change the page index while the candidate list is available for UILess mode.</span></span> <span data-ttu-id="0afab-176">Cela signifie que la liste des candidats de TIP doit se comporter avec la pagination au lieu de faire défiler le curseur lorsque la sélection est déplacée vers la page suivante.</span><span class="sxs-lookup"><span data-stu-id="0afab-176">This means that TIP's candidate list should behave the paging rather than scrolling when the selection is moved to the next page.</span></span> <span data-ttu-id="0afab-177">Si le défilement se produit au déplacement de la sélection, l’index de la page est modifié et l’application doit recalculer l’index de la page.</span><span class="sxs-lookup"><span data-stu-id="0afab-177">If the scroll happens at the selection moves, the page index is changed and the application needs to recalculate the page index.</span></span> <span data-ttu-id="0afab-178">Le résultat peut ne pas être attendu par TIP.</span><span class="sxs-lookup"><span data-stu-id="0afab-178">The result may not be expected by TIP.</span></span>

<span data-ttu-id="0afab-179">**No Selection :** [**ITfCandidateListUIElement :: GetSelection**](/windows/desktop/api/Msctf/nf-msctf-itfcandidatelistuielement-getselection) retourne S \_ false, si la liste candidate n’a pas de sélection.</span><span class="sxs-lookup"><span data-stu-id="0afab-179">**No Selection:** [**ITfCandidateListUIElement::GetSelection**](/windows/desktop/api/Msctf/nf-msctf-itfcandidatelistuielement-getselection) returns S\_FALSE, if the candidate list does not have a selection.</span></span> <span data-ttu-id="0afab-180">La valeur de retour du premier paramètre n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="0afab-180">The return value of the first param is invalid.</span></span>

 

 




