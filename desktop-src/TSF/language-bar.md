---
title: Barre de langue (services de texte)
description: Barre de langue
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- Text Services Framework (TSF), barre de langue
- TSF (Text Services Framework), barre de langue
- services de texte, barre de langue
- barre de langue
- Text Services Framework (TSF), boutons
- TSF (Text Services Framework), boutons
- services de texte, boutons
- Text Services Framework (TSF), menus
- TSF (Text Services Framework), menus
- services de texte, menus
- styles des boutons
- boutons de menu
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e3c4359c6753f5d96613435f9501036f1d5f317
ms.sourcegitcommit: 8ebcf6cd36f67f8bcf78e76ae8923d65b8995c8a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/05/2021
ms.locfileid: "111524443"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="b076d-115">Barre de langue (services de texte)</span><span class="sxs-lookup"><span data-stu-id="b076d-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="b076d-116">Implémentation de l’objet de barre de langue</span><span class="sxs-lookup"><span data-stu-id="b076d-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="b076d-117">Pour prendre en charge l’ajout d’un élément à la barre de langage, un service de texte doit implémenter un objet qui prend en charge l’interface [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) et l’un des éléments de contrôle [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) .</span><span class="sxs-lookup"><span data-stu-id="b076d-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="b076d-118">Lorsque l’élément est installé, la barre de langue installe un récepteur [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) en appelant l’élément [ITfSource :: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) de l’élément avec IID \_ ITfLangBarItemSink.</span><span class="sxs-lookup"><span data-stu-id="b076d-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="b076d-119">L’élément utilise l’interface **ITfLangBarItemSink** pour notifier la barre de langue des modifications, par exemple lorsque l’élément est masqué, affiché, activé ou désactivé.</span><span class="sxs-lookup"><span data-stu-id="b076d-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="b076d-120">Quatre types d’éléments de la barre de langue peuvent être installés et chacune des interfaces requises est créée à partir de **ITfLangBarItem**.</span><span class="sxs-lookup"><span data-stu-id="b076d-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="b076d-121">Les éléments suivants sont des éléments de contrôle **ITfLangBarItem** possibles.</span><span class="sxs-lookup"><span data-stu-id="b076d-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|   <span data-ttu-id="b076d-122">Élément</span><span class="sxs-lookup"><span data-stu-id="b076d-122">Element</span></span>            |    <span data-ttu-id="b076d-123">Description</span><span class="sxs-lookup"><span data-stu-id="b076d-123">Description</span></span>                                                                                                                                                                               |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b076d-124">Bouton</span><span class="sxs-lookup"><span data-stu-id="b076d-124">Button</span></span>        | <span data-ttu-id="b076d-125">Un bouton de barre de langue fonctionne comme un bouton de commande, un contrôle de basculement ou un menu dans la barre de langue.</span><span class="sxs-lookup"><span data-stu-id="b076d-125">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="b076d-126">L’objet doit prendre en charge l’interface ITfLangBarItemButton.</span><span class="sxs-lookup"><span data-stu-id="b076d-126">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="b076d-127">Forfaitaire</span><span class="sxs-lookup"><span data-stu-id="b076d-127">Balloon</span></span>       | <span data-ttu-id="b076d-128">Une bulle de barre de langue fonctionne comme une notification contextuelle sur la barre de langue.</span><span class="sxs-lookup"><span data-stu-id="b076d-128">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="b076d-129">L’objet doit prendre en charge l’interface ITfLangBarItemBalloon.</span><span class="sxs-lookup"><span data-stu-id="b076d-129">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="b076d-130">Bitmap</span><span class="sxs-lookup"><span data-stu-id="b076d-130">Bitmap</span></span>        | <span data-ttu-id="b076d-131">Une image de la barre de langue fonctionne comme un élément statique sur la barre de langue qui affiche une image bitmap.</span><span class="sxs-lookup"><span data-stu-id="b076d-131">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="b076d-132">L’objet doit prendre en charge l’interface ITfLangBarItemBitmap.</span><span class="sxs-lookup"><span data-stu-id="b076d-132">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="b076d-133">Bouton bitmap</span><span class="sxs-lookup"><span data-stu-id="b076d-133">Bitmap Button</span></span> | <span data-ttu-id="b076d-134">Un bouton bitmap de barre de langue fonctionne comme un élément bouton sur la barre de langue qui affiche du texte et une bitmap.</span><span class="sxs-lookup"><span data-stu-id="b076d-134">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="b076d-135">L’objet doit prendre en charge l’interface ITfLangBarItemBitmapButton.</span><span class="sxs-lookup"><span data-stu-id="b076d-135">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="b076d-136">Styles des boutons</span><span class="sxs-lookup"><span data-stu-id="b076d-136">Button Styles</span></span>

<span data-ttu-id="b076d-137">Un élément Button peut fonctionner comme l’un des éléments suivants.</span><span class="sxs-lookup"><span data-stu-id="b076d-137">A button element can function as any of the following.</span></span> <span data-ttu-id="b076d-138">La fonction de l’élément de bouton est déterminée par les indicateurs définis dans le membre **dwStyle** de la structure [ \_ LANGBARITEMINFO TF](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) dans la méthode [ITfLangBarItem :: GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) .</span><span class="sxs-lookup"><span data-stu-id="b076d-138">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|    <span data-ttu-id="b076d-139">Élément</span><span class="sxs-lookup"><span data-stu-id="b076d-139">Element</span></span>           |    <span data-ttu-id="b076d-140">Description</span><span class="sxs-lookup"><span data-stu-id="b076d-140">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b076d-141">Bouton</span><span class="sxs-lookup"><span data-stu-id="b076d-141">Button</span></span>        | <span data-ttu-id="b076d-142">Le bouton fonctionne comme un bouton de commande standard.</span><span class="sxs-lookup"><span data-stu-id="b076d-142">The button functions as a standard command button.</span></span> <span data-ttu-id="b076d-143">Ce style de bouton est identifié par le \_ \_ style de bouton de style BTN de type IFA \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="b076d-143">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="b076d-144">ITfLangBarItemButton :: OnClick est appelé lorsque l’utilisateur clique sur l’élément.</span><span class="sxs-lookup"><span data-stu-id="b076d-144">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="b076d-145">ITfLangBarItemButton :: InitMenu et ITfLangBarItemButton :: OnMenuSelect ne sont pas utilisés.</span><span class="sxs-lookup"><span data-stu-id="b076d-145">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="b076d-146">Bouton bascule</span><span class="sxs-lookup"><span data-stu-id="b076d-146">Toggle Button</span></span> | <span data-ttu-id="b076d-147">Le bouton fonctionne comme un contrôle de basculement qui peut maintenir un état de clic, similaire à une case à cocher.</span><span class="sxs-lookup"><span data-stu-id="b076d-147">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="b076d-148">Ce style de bouton est identifié par le style de basculement de style d’un type de bouton à la ligne TF \_ IFA \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="b076d-148">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="b076d-149">ITfLangBarItemButton :: OnClick est appelé lorsque l’utilisateur clique sur l’élément.</span><span class="sxs-lookup"><span data-stu-id="b076d-149">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="b076d-150">ITfLangBarItemButton :: InitMenu et ITfLangBarItemButton :: OnMenuSelect ne sont pas utilisés.</span><span class="sxs-lookup"><span data-stu-id="b076d-150">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="b076d-151">Menu</span><span class="sxs-lookup"><span data-stu-id="b076d-151">Menu</span></span>          | <span data-ttu-id="b076d-152">Le bouton fonctionne comme un menu déroulant.</span><span class="sxs-lookup"><span data-stu-id="b076d-152">The button functions as a drop-down menu.</span></span> <span data-ttu-id="b076d-153">Ce style de bouton est identifié par le \_ style de menu d’TF IFA \_ style \_ BTN \_ .</span><span class="sxs-lookup"><span data-stu-id="b076d-153">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="b076d-154">ITfLangBarItemButton :: InitMenu est appelé lorsque l’utilisateur clique sur le bouton.</span><span class="sxs-lookup"><span data-stu-id="b076d-154">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="b076d-155">Lorsque l’utilisateur sélectionne un élément dans le menu, la barre de langage appelle ITfLangBarItemButton :: OnMenuSelect avec l’identificateur de l’élément de menu sélectionné.</span><span class="sxs-lookup"><span data-stu-id="b076d-155">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="b076d-156">ITfLangBarItemButton :: OnClickis non utilisé.</span><span class="sxs-lookup"><span data-stu-id="b076d-156">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="b076d-157">Implémentation d’un bouton de menu</span><span class="sxs-lookup"><span data-stu-id="b076d-157">Implementing a Menu Button</span></span>

<span data-ttu-id="b076d-158">Quand l’utilisateur clique sur un bouton de menu, la barre de langage appelle [ITfLangBarItemButton :: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span><span class="sxs-lookup"><span data-stu-id="b076d-158">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="b076d-159">L’élément ajoute des éléments au menu à l’aide de l’interface [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) transmise à InitMenu.</span><span class="sxs-lookup"><span data-stu-id="b076d-159">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="b076d-160">Pour ajouter un sous-menu au menu, appelez [ITfMenu :: AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) avec le \_ \_ sous-menu TF LBMENUF.</span><span class="sxs-lookup"><span data-stu-id="b076d-160">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="b076d-161">Une fois cette opération effectuée, un nouvel objet **ITfMenu** qui représente le sous-menu est retourné dans le paramètre *ppMenu* de AddMenuItem.</span><span class="sxs-lookup"><span data-stu-id="b076d-161">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="b076d-162">Ce nouvel objet menu est utilisé pour ajouter des éléments au sous-menu.</span><span class="sxs-lookup"><span data-stu-id="b076d-162">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="b076d-163">Lorsque l’utilisateur sélectionne un élément dans le menu, la barre de langage appelle [ITfLangBarItemButton :: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) avec l’identificateur de l’élément de menu sélectionné.</span><span class="sxs-lookup"><span data-stu-id="b076d-163">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="b076d-164">Ajout d’éléments à la barre de langue</span><span class="sxs-lookup"><span data-stu-id="b076d-164">Adding Items to the Language Bar</span></span>

<span data-ttu-id="b076d-165">Un service de texte doit ajouter ses éléments à la barre de langue lorsque sa méthode [ITfTextInputProcessor :: Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) est appelée et les supprimer quand son [ITfTextInputProcessor ::D eactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) est appelé.</span><span class="sxs-lookup"><span data-stu-id="b076d-165">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="b076d-166">Pour ajouter un élément à la barre de langue, le service de texte obtient une interface [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) en appelant ITfThreadMgr :: QUERYINTERFACE avec IID \_ ITfLangBarItemMgr.</span><span class="sxs-lookup"><span data-stu-id="b076d-166">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="b076d-167">Le service de texte appelle ensuite [ITfLangBarItemMgr :: AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) avec le pointeur vers l’objet élément de la barre de langage.</span><span class="sxs-lookup"><span data-stu-id="b076d-167">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="b076d-168">Le service de texte doit supprimer l’élément lorsqu’il est désactivé.</span><span class="sxs-lookup"><span data-stu-id="b076d-168">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="b076d-169">Le service de texte utilise la même interface **ITfLangBarItemMgr** que celle utilisée pour ajouter les éléments ou obtenir une autre instance de l’interface.</span><span class="sxs-lookup"><span data-stu-id="b076d-169">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="b076d-170">Le service de texte appelle ensuite [ITfLangBarItemMgr :: RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) avec le pointeur d’interface de l’élément à supprimer.</span><span class="sxs-lookup"><span data-stu-id="b076d-170">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="b076d-171">Extension des éléments de la barre de langue système</span><span class="sxs-lookup"><span data-stu-id="b076d-171">Extending System Language Bar Items</span></span>

<span data-ttu-id="b076d-172">TSF offre la possibilité d’ajouter des éléments de menu à des menus de la barre de langage existants.</span><span class="sxs-lookup"><span data-stu-id="b076d-172">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="b076d-173">Cela permet à un service de texte d’ajouter des éléments au menu d’un autre service de texte sans avoir à ajouter un bouton distinct à la barre d’outils.</span><span class="sxs-lookup"><span data-stu-id="b076d-173">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="b076d-174">Cela permet également d’organiser les éléments de menu en groupes logiques.</span><span class="sxs-lookup"><span data-stu-id="b076d-174">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="b076d-175">Par exemple, un service de texte qui fournit des fonctionnalités supplémentaires au service de texte vocal standard peut ajouter des éléments au menu service de texte vocal au lieu d’ajouter son propre bouton de menu de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="b076d-175">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="b076d-176">Un service de texte fournit une extension de menu de barre de langue en implémentant un objet qui prend en charge l’interface [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) .</span><span class="sxs-lookup"><span data-stu-id="b076d-176">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="b076d-177">Cette interface fonctionne exactement comme l’interface [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) pour un bouton de menu.</span><span class="sxs-lookup"><span data-stu-id="b076d-177">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="b076d-178">Lorsque le menu est affiché, le service de texte qui est étendu appelle [ITfSystemLangBarItemSink :: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span><span class="sxs-lookup"><span data-stu-id="b076d-178">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="b076d-179">L’extension ajoute des éléments au menu à l’aide de l’interface [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) transmise à **InitMenu**.</span><span class="sxs-lookup"><span data-stu-id="b076d-179">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="b076d-180">Lorsque l’utilisateur sélectionne un élément ajouté par l’extension, le service de texte qui est étendu appelle [ITfSystemLangBarItemSink :: OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) avec l’identificateur de l’élément de menu sélectionné.</span><span class="sxs-lookup"><span data-stu-id="b076d-180">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="b076d-181">Pour installer une extension de menu de barre de langue, le service de texte effectue les étapes suivantes.</span><span class="sxs-lookup"><span data-stu-id="b076d-181">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="b076d-182">Obtenez l’interface **ITfLangBarItem** de l’élément à étendre en appelant [ITfLangBarItemMgr :: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) avec le **GUID** de l’élément à étendre.</span><span class="sxs-lookup"><span data-stu-id="b076d-182">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="b076d-183">Obtenez l’interface **ITfSource** de l’élément à étendre en appelant ITfLangBarItem :: QUERYINTERFACE avec IID \_ ITfSource.</span><span class="sxs-lookup"><span data-stu-id="b076d-183">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="b076d-184">Appelez [ITfSource :: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) avec IID \_ ITfSystemLangBarItemSink et le pointeur vers l’objet **ITfSystemLangBarItemSink** .</span><span class="sxs-lookup"><span data-stu-id="b076d-184">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="b076d-185">Si ITfSource :: AdviseSink échoue, le service de texte ne prend pas en charge les extensions de menu.</span><span class="sxs-lookup"><span data-stu-id="b076d-185">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="b076d-186">[ITfSource :: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource :: AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="b076d-186">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="b076d-187">Prise en charge des extensions de menu de barre de langage</span><span class="sxs-lookup"><span data-stu-id="b076d-187">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="b076d-188">Un service de texte peut permettre à d’autres services de texte d’ajouter des éléments à ses menus de barre de langue comme indiqué ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="b076d-188">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="b076d-189">Service de texte qui doit publier son GUID afin que l’élément puisse être obtenu en appelant [ITfLangBarItemMgr :: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span><span class="sxs-lookup"><span data-stu-id="b076d-189">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="b076d-190">Pour prendre en charge les extensions de menu, le service de texte doit prendre en charge l’interface [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) .</span><span class="sxs-lookup"><span data-stu-id="b076d-190">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="b076d-191">Les étapes suivantes activent la prise en charge d’une ou plusieurs extensions de menu.</span><span class="sxs-lookup"><span data-stu-id="b076d-191">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="b076d-192">Quand [ITfSource :: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) avec IID \_ ITfSystemLangBarItemSink est appelé, le service de texte doit stocker l’interface **ITfSystemLangBarItemSink** et retourner une valeur de cookie qui identifie l’extension.</span><span class="sxs-lookup"><span data-stu-id="b076d-192">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="b076d-193">Quand [ITfLangBarItemButton :: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) est appelé, le service de texte appelle la méthode [ITfSystemLangBarItemSink :: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) de l’extension.</span><span class="sxs-lookup"><span data-stu-id="b076d-193">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="b076d-194">Le service de texte doit implémenter un moyen d’identifier les éléments de menu ajoutés par l’extension, par opposition aux éléments ajoutés par le service de texte lui-même.</span><span class="sxs-lookup"><span data-stu-id="b076d-194">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="b076d-195">Quand [ITfLangBarItemButton :: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) est appelé avec un identificateur d’élément de menu qui appartient à une extension, le service de texte appelle la méthode **ITfSystemLangBarItemSink :: OnMenuSelect** de l’extension.</span><span class="sxs-lookup"><span data-stu-id="b076d-195">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="b076d-196">Lorsque [ITfSource :: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) est appelé avec le cookie approprié, le service de texte supprime l’extension de menu.</span><span class="sxs-lookup"><span data-stu-id="b076d-196">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b076d-197">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="b076d-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b076d-198">Comment configurer Text Services Framework</span><span class="sxs-lookup"><span data-stu-id="b076d-198">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="b076d-199">Barre de langue (applications)</span><span class="sxs-lookup"><span data-stu-id="b076d-199">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
