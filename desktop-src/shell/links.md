---
description: Un lien d’interpréteur de commandes est un objet de données qui contient des informations utilisées pour accéder à un autre objet dans l’espace de noms du shell&\# 8212 ; autrement dit, tout objet visible par le biais de l’Explorateur Windows.
ms.assetid: 32ad306d-54bd-4130-ad30-08db50ef106e
title: Liens de Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 327bcb425f998bcc2a4c0714118d4461ded253ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104203448"
---
# <a name="shell-links"></a><span data-ttu-id="bdfaa-103">Liens de Shell</span><span class="sxs-lookup"><span data-stu-id="bdfaa-103">Shell Links</span></span>

<span data-ttu-id="bdfaa-104">Un *lien d’interpréteur* de commandes est un objet de données qui contient des informations utilisées pour accéder à un autre objet dans l’espace de noms du shell, c’est-à-dire tout objet visible par le biais de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-104">A *Shell link* is a data object that contains information used to access another object in the Shell's namespace—that is, any object visible through Windows Explorer.</span></span> <span data-ttu-id="bdfaa-105">Les types d’objets accessibles via des liens de Shell incluent des fichiers, des dossiers, des lecteurs de disque et des imprimantes.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-105">The types of objects that can be accessed through Shell links include files, folders, disk drives, and printers.</span></span> <span data-ttu-id="bdfaa-106">Un lien de Shell permet à un utilisateur ou à une application d’accéder à un objet à partir de n’importe quel emplacement de l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-106">A Shell link allows a user or an application to access an object from anywhere in the namespace.</span></span> <span data-ttu-id="bdfaa-107">L’utilisateur ou l’application n’a pas besoin de connaître le nom et l’emplacement actuels de l’objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-107">The user or application does not need to know the current name and location of the object.</span></span>

-   [<span data-ttu-id="bdfaa-108">À propos des liens de Shell</span><span class="sxs-lookup"><span data-stu-id="bdfaa-108">About Shell Links</span></span>](#about-shell-links)
    -   [<span data-ttu-id="bdfaa-109">Résolution de lien</span><span class="sxs-lookup"><span data-stu-id="bdfaa-109">Link Resolution</span></span>](#link-resolution)
    -   [<span data-ttu-id="bdfaa-110">Fichiers de liaison</span><span class="sxs-lookup"><span data-stu-id="bdfaa-110">Link Files</span></span>](#link-files)
    -   [<span data-ttu-id="bdfaa-111">Identificateurs d’éléments et listes d’identificateurs</span><span class="sxs-lookup"><span data-stu-id="bdfaa-111">Item Identifiers and Identifier Lists</span></span>](#item-identifiers-and-identifier-lists)
-   [<span data-ttu-id="bdfaa-112">Utilisation des liens de l’interpréteur de commandes</span><span class="sxs-lookup"><span data-stu-id="bdfaa-112">Using Shell Links</span></span>](#using-shell-links)
    -   [<span data-ttu-id="bdfaa-113">Création d’un raccourci et d’un raccourci vers un fichier</span><span class="sxs-lookup"><span data-stu-id="bdfaa-113">Creating a Shortcut and a Folder Shortcut to a File</span></span>](#creating-a-shortcut-and-a-folder-shortcut-to-a-file)
    -   [<span data-ttu-id="bdfaa-114">Résolution d’un raccourci</span><span class="sxs-lookup"><span data-stu-id="bdfaa-114">Resolving a Shortcut</span></span>](#resolving-a-shortcut)
    -   [<span data-ttu-id="bdfaa-115">Création d’un raccourci vers un objet qui n’est pas un fichier</span><span class="sxs-lookup"><span data-stu-id="bdfaa-115">Creating a Shortcut to a Nonfile Object</span></span>](#creating-a-shortcut-to-a-nonfile-object)

## <a name="about-shell-links"></a><span data-ttu-id="bdfaa-116">À propos des liens de Shell</span><span class="sxs-lookup"><span data-stu-id="bdfaa-116">About Shell Links</span></span>

<span data-ttu-id="bdfaa-117">L’utilisateur crée un lien de Shell en choisissant la commande **créer un raccourci** dans le menu contextuel d’un objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-117">The user creates a Shell link by choosing the **Create Shortcut** command from an object's shortcut menu.</span></span> <span data-ttu-id="bdfaa-118">Le système crée automatiquement une icône pour le lien de l’interpréteur de commandes en associant l’icône de l’objet à une petite flèche (appelée icône de superposition de lien définie par le système) qui apparaît dans le coin inférieur gauche de l’icône.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-118">The system automatically creates an icon for the Shell link by combining the object's icon with a small arrow (known as the system-defined link overlay icon) that appears in the lower left corner of the icon.</span></span> <span data-ttu-id="bdfaa-119">Un lien de Shell avec une icône est appelé raccourci ; Toutefois, les termes lien et raccourci de l’interpréteur de commandes sont souvent utilisés indifféremment.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-119">A Shell link that has an icon is called a shortcut; however, the terms Shell link and shortcut are often used interchangeably.</span></span> <span data-ttu-id="bdfaa-120">En règle générale, l’utilisateur crée des raccourcis pour accéder rapidement aux objets stockés dans des sous-dossiers ou dans des dossiers partagés sur d’autres ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-120">Typically, the user creates shortcuts to gain quick access to objects stored in subfolders or in shared folders on other computers.</span></span> <span data-ttu-id="bdfaa-121">Par exemple, un utilisateur peut créer un raccourci vers un document Microsoft Word situé dans un sous-dossier et placer l’icône de raccourci sur le bureau.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-121">For example, a user can create a shortcut to a Microsoft Word document that is located in a subfolder and place the shortcut icon on the desktop.</span></span> <span data-ttu-id="bdfaa-122">L’utilisateur peut ensuite ouvrir le document en double-cliquant sur l’icône de raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-122">The user can then open the document by double-clicking the shortcut icon.</span></span> <span data-ttu-id="bdfaa-123">Si le document est déplacé ou renommé après la création du raccourci, le système tente de mettre à jour le raccourci la prochaine fois que l’utilisateur le sélectionne.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-123">If the document is moved or renamed after the shortcut is created, the system will attempt to update the shortcut the next time the user selects it.</span></span>

<span data-ttu-id="bdfaa-124">Les applications peuvent également créer et utiliser des liens et des raccourcis de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-124">Applications can also create and use Shell links and shortcuts.</span></span> <span data-ttu-id="bdfaa-125">Par exemple, une application de traitement de texte peut créer un lien de Shell pour implémenter une liste des documents les plus récemment utilisés.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-125">For example, a word processing application might create a Shell link to implement a list of the most recently used documents.</span></span> <span data-ttu-id="bdfaa-126">Une application crée un lien de Shell à l’aide de l’interface [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) pour créer un objet de lien de Shell.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-126">An application creates a Shell link by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface to create a Shell link object.</span></span> <span data-ttu-id="bdfaa-127">L’application utilise l’interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) ou [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) pour stocker l’objet dans un fichier ou un flux.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-127">The application uses the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) interface to store the object in a file or stream.</span></span>

> [!Note]  
> <span data-ttu-id="bdfaa-128">Vous ne pouvez pas utiliser [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) pour créer un lien vers une URL.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-128">You cannot use [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) to create a link to a URL.</span></span>

 

<span data-ttu-id="bdfaa-129">Cette vue d’ensemble décrit l’interface [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) et explique comment l’utiliser pour créer et résoudre des liens de Shell à partir d’une application basée sur Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-129">This overview describes the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface and explains how to use it to create and resolve Shell links from within a Microsoft Win32-based application.</span></span> <span data-ttu-id="bdfaa-130">Étant donné que la conception des liens de Shell est basée sur le modèle COM (Component Object Model) OLE, vous devez être familiarisé avec les concepts de base de la programmation COM et OLE avant de lire cette vue d’ensemble.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-130">Because the design of Shell links is based on the OLE Component Object Model (COM), you should be familiar with the basic concepts of COM and OLE programming before reading this overview.</span></span>

### <a name="link-resolution"></a><span data-ttu-id="bdfaa-131">Résolution de lien</span><span class="sxs-lookup"><span data-stu-id="bdfaa-131">Link Resolution</span></span>

<span data-ttu-id="bdfaa-132">Si un utilisateur crée un raccourci vers un objet et que le nom ou l’emplacement de l’objet est modifié ultérieurement, le système prend automatiquement les mesures nécessaires pour mettre à jour ou résoudre le raccourci la prochaine fois que l’utilisateur le sélectionne.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-132">If a user creates a shortcut to an object and the name or location of the object is later changed, the system automatically takes steps to update, or resolve, the shortcut the next time the user selects it.</span></span> <span data-ttu-id="bdfaa-133">Toutefois, si une application crée un lien de Shell et le stocke dans un flux, le système n’essaie pas automatiquement de résoudre le lien.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-133">However, if an application creates a Shell link and stores it in a stream, the system does not automatically attempt to resolve the link.</span></span> <span data-ttu-id="bdfaa-134">L’application doit résoudre le lien en appelant la méthode [**IShellLink :: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-134">The application must resolve the link by calling the [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) method.</span></span>

<span data-ttu-id="bdfaa-135">Lorsqu’un lien de Shell est créé, le système enregistre les informations sur le lien.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-135">When a Shell link is created, the system saves information about the link.</span></span> <span data-ttu-id="bdfaa-136">Lors de la résolution d’un lien (automatiquement ou à l’aide d’un appel [**IShellLink :: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) ), le système récupère d’abord le chemin d’accès associé au lien de l’interpréteur de commandes en utilisant un pointeur vers la liste d’identificateur du lien de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-136">When resolving a link—either automatically or with an [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) call—the system first retrieves the path associated with the Shell link by using a pointer to the Shell link's identifier list.</span></span> <span data-ttu-id="bdfaa-137">Pour plus d’informations sur la liste d’identificateurs, consultez [identificateurs d’éléments et listes d’identificateurs](#item-identifiers-and-identifier-lists).</span><span class="sxs-lookup"><span data-stu-id="bdfaa-137">For more information about the identifier list, see [Item Identifiers and Identifier Lists](#item-identifiers-and-identifier-lists).</span></span> <span data-ttu-id="bdfaa-138">Le système recherche l’objet associé dans ce chemin d’accès et, s’il trouve l’objet, résout le lien.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-138">The system searches for the associated object in that path and, if it finds the object, resolves the link.</span></span> <span data-ttu-id="bdfaa-139">Si le système ne trouve pas l’objet, il appelle le service de [suivi des liaisons distribuées et les identificateurs d’objets](../fileio/distributed-link-tracking-and-object-identifiers.md) (DLT), s’il est disponible, pour localiser l’objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-139">If the system cannot find the object, it calls on the [Distributed Link Tracking and Object Identifiers](../fileio/distributed-link-tracking-and-object-identifiers.md) (DLT) service, if available, to locate the object.</span></span> <span data-ttu-id="bdfaa-140">Si le service DLT n’est pas disponible ou ne trouve pas l’objet, le système recherche un objet avec les mêmes attributs et heure de création de fichier, mais avec un nom différent.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-140">If the DLT service is not available or cannot find the object, the system looks in the same directory for an object with the same file creation time and attributes but with a different name.</span></span> <span data-ttu-id="bdfaa-141">Ce type de recherche résout un lien vers un objet qui a été renommé.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-141">This type of search resolves a link to an object that has been renamed.</span></span>

<span data-ttu-id="bdfaa-142">Si le système ne parvient toujours pas à trouver l’objet, il recherche les répertoires, le bureau et les volumes locaux, en regardant de manière récursive l’arborescence de répertoires d’un objet ayant le même nom ou la même heure de création.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-142">If the system still cannot find the object, it searches the directories, the desktop, and local volumes, looking recursively though the directory tree for an object with either the same name or creation time.</span></span> <span data-ttu-id="bdfaa-143">Si le système ne trouve toujours pas de correspondance, il affiche une boîte de dialogue invitant l’utilisateur à entrer un emplacement.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-143">If the system still does not find a match, it displays a dialog box prompting the user for a location.</span></span> <span data-ttu-id="bdfaa-144">Une application peut supprimer la boîte de dialogue en spécifiant la valeur de la variable de l’interface de l' **\_ \_ utilisateur** dans un appel à [**IShellLink :: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve).</span><span class="sxs-lookup"><span data-stu-id="bdfaa-144">An application can suppress the dialog box by specifying the **SLR\_NO\_UI** value in a call to [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve).</span></span>

### <a name="initialization-of-the-component-object-library"></a><span data-ttu-id="bdfaa-145">Initialisation de la bibliothèque d’objets du composant</span><span class="sxs-lookup"><span data-stu-id="bdfaa-145">Initialization of the Component Object Library</span></span>

<span data-ttu-id="bdfaa-146">Pour qu’une application puisse créer et résoudre des raccourcis, elle doit initialiser la bibliothèque d’objets de composant en appelant la fonction [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-146">Before an application can create and resolve shortcuts, it must initialize the component object library by calling the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function.</span></span> <span data-ttu-id="bdfaa-147">Chaque appel à **CoInitialize** requiert un appel correspondant à la fonction [**CoUninitialize**](/windows/win32/api/combaseapi/nf-combaseapi-couninitialize) , qu’une application doit appeler lorsqu’elle se termine.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-147">Each call to **CoInitialize** requires a corresponding call to the [**CoUninitialize**](/windows/win32/api/combaseapi/nf-combaseapi-couninitialize) function, which an application should call when it terminates.</span></span> <span data-ttu-id="bdfaa-148">L’appel à **CoUninitialize** garantit que l’application ne se termine pas tant qu’elle n’a pas reçu tous ses messages en attente.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-148">The call to **CoUninitialize** ensures that the application does not terminate until it has received all of its pending messages.</span></span>

### <a name="location-independent-names"></a><span data-ttu-id="bdfaa-149">Noms de Location-Independent</span><span class="sxs-lookup"><span data-stu-id="bdfaa-149">Location-Independent Names</span></span>

<span data-ttu-id="bdfaa-150">Le système fournit des noms indépendants de l’emplacement pour les liens de Shell vers des objets stockés dans des dossiers partagés.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-150">The system provides location-independent names for Shell links to objects stored in shared folders.</span></span> <span data-ttu-id="bdfaa-151">Si l’objet est stocké localement, le système fournit le chemin d’accès local et le nom de fichier de l’objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-151">If the object is stored locally, the system provides the local path and file name for the object.</span></span> <span data-ttu-id="bdfaa-152">Si l’objet est stocké à distance, le système fournit un nom de ressource réseau UNC (Universal Naming Convention) pour l’objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-152">If the object is stored remotely, the system provides a Universal Naming Convention (UNC) network resource name for the object.</span></span> <span data-ttu-id="bdfaa-153">Étant donné que le système fournit des noms indépendants de l’emplacement, un lien de Shell peut servir de nom universel pour un fichier qui peut être transféré à d’autres ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-153">Because the system provides location-independent names, a Shell link can serve as a universal name for a file that can be transferred to other computers.</span></span>

### <a name="link-files"></a><span data-ttu-id="bdfaa-154">Fichiers de liaison</span><span class="sxs-lookup"><span data-stu-id="bdfaa-154">Link Files</span></span>

<span data-ttu-id="bdfaa-155">Quand l’utilisateur crée un raccourci vers un objet en choisissant la commande **créer un raccourci** dans le menu contextuel de l’objet, Windows stocke les informations dont il a besoin pour accéder à l’objet dans un fichier de liaison, c’est-à-dire un fichier binaire avec l’extension de nom de fichier. lnk.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-155">When the user creates a shortcut to an object by choosing the **Create Shortcut** command from the object's shortcut menu, Windows stores the information it needs to access the object in a link file—a binary file that has the .lnk file name extension.</span></span> <span data-ttu-id="bdfaa-156">Un fichier de liaison contient les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="bdfaa-156">A link file contains the following information:</span></span>

-   <span data-ttu-id="bdfaa-157">Emplacement (chemin d’accès) de l’objet référencé par le raccourci (appelé objet correspondant).</span><span class="sxs-lookup"><span data-stu-id="bdfaa-157">The location (path) of the object referenced by the shortcut (called the corresponding object).</span></span>
-   <span data-ttu-id="bdfaa-158">Répertoire de travail de l’objet correspondant.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-158">The working directory of the corresponding object.</span></span>
-   <span data-ttu-id="bdfaa-159">Liste d’arguments que le système passe à l’objet correspondant quand la méthode [**IContextMenu :: commande InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) est activée pour le raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-159">The list of arguments that the system passes to the corresponding object when the [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) method is activated for the shortcut.</span></span>
-   <span data-ttu-id="bdfaa-160">Commande show utilisée pour définir l’état d’affichage initial de l’objet correspondant.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-160">The show command used to set the initial show state of the corresponding object.</span></span> <span data-ttu-id="bdfaa-161">Il s’agit de l’une des valeurs LOGICIELles \_ décrites dans [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow).</span><span class="sxs-lookup"><span data-stu-id="bdfaa-161">This is one of the SW\_ values described in [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow).</span></span>
-   <span data-ttu-id="bdfaa-162">Emplacement (chemin d’accès et index) de l’icône du raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-162">The location (path and index) of the shortcut's icon.</span></span>
-   <span data-ttu-id="bdfaa-163">Chaîne de description du raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-163">The shortcut's description string.</span></span>
-   <span data-ttu-id="bdfaa-164">Raccourci clavier du raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-164">The keyboard shortcut for the shortcut.</span></span>

<span data-ttu-id="bdfaa-165">Lorsqu’un fichier de liaison est supprimé, l’objet correspondant n’est pas affecté.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-165">When a link file is deleted, the corresponding object is not affected.</span></span>

<span data-ttu-id="bdfaa-166">Si vous créez un raccourci vers un autre raccourci, le système copie simplement le fichier de liaison au lieu de créer un nouveau fichier de liaison.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-166">If you create a shortcut to another shortcut, the system simply copies the link file rather than creating a new link file.</span></span> <span data-ttu-id="bdfaa-167">Dans ce cas, les raccourcis ne sont pas indépendants l’un de l’autre.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-167">In this case, the shortcuts will not be independent of each other.</span></span>

<span data-ttu-id="bdfaa-168">Une application peut inscrire une extension de nom de fichier en tant que type de fichier de raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-168">An application can register a file name extension as a shortcut file type.</span></span> <span data-ttu-id="bdfaa-169">Si un fichier a une extension de nom de fichier qui a été inscrite en tant que type de fichier de raccourci, le système ajoute automatiquement l’icône de superposition de lien définie par le système (une petite flèche) à l’icône du fichier.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-169">If a file has a file name extension that has been registered as a shortcut file type, the system automatically adds the system-defined link overlay icon (a small arrow) to the file's icon.</span></span> <span data-ttu-id="bdfaa-170">Pour inscrire une extension de nom de fichier en tant que type de fichier de raccourci, vous devez ajouter la valeur IsShortcut à la description du registre de l’extension de nom de fichier, comme indiqué dans l’exemple ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-170">To register a file name extension as a shortcut file type, you must add the IsShortcut value to the registry description of the file name extension, as shown in the example below.</span></span> <span data-ttu-id="bdfaa-171">Notez que l’interpréteur de commandes doit être redémarré pour que l’icône de superposition prenne effet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-171">Note that the Shell must be restarted for the overlay icon to take effect.</span></span> <span data-ttu-id="bdfaa-172">IsShortcut n’a pas de valeur de données.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-172">IsShortcut has no data value.</span></span>

```
HKEY_CLASSES_ROOT
   .xyz
      (Default) = XYZApp
   XYZApp
      IsShortcut
```

### <a name="shortcut-names"></a><span data-ttu-id="bdfaa-173">Noms de raccourcis</span><span class="sxs-lookup"><span data-stu-id="bdfaa-173">Shortcut names</span></span>

<span data-ttu-id="bdfaa-174">Le nom du raccourci, qui est une chaîne qui apparaît sous l’icône de lien de l’interpréteur de commandes, correspond en fait au nom de fichier du raccourci lui-même.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-174">The shortcut's name, which is a string that appears below the Shell link icon, is actually the file name of the shortcut itself.</span></span> <span data-ttu-id="bdfaa-175">L’utilisateur peut modifier la chaîne de description en la sélectionnant et en entrant une nouvelle chaîne.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-175">The user can edit the description string by selecting it and entering a new string.</span></span>

### <a name="location-of-shortcuts-in-the-namespace"></a><span data-ttu-id="bdfaa-176">Emplacement des raccourcis dans l’espace de noms</span><span class="sxs-lookup"><span data-stu-id="bdfaa-176">Location of shortcuts in the namespace</span></span>

<span data-ttu-id="bdfaa-177">Un raccourci peut exister sur le bureau ou n’importe où dans l’espace de noms de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-177">A shortcut can exist on the desktop or anywhere in the Shell's namespace.</span></span> <span data-ttu-id="bdfaa-178">De même, l’objet associé au raccourci peut également se trouver n’importe où dans l’espace de noms de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-178">Similarly, the object that is associated with the shortcut can also exist anywhere in the Shell's namespace.</span></span> <span data-ttu-id="bdfaa-179">Une application peut utiliser la méthode [**IShellLink :: setPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setpath) pour définir le chemin d’accès et le nom de fichier de l’objet associé, et la méthode [**IShellLink :: GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) pour récupérer le chemin d’accès et le nom de fichier actuels de l’objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-179">An application can use the [**IShellLink::SetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setpath) method to set the path and file name for the associated object, and the [**IShellLink::GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) method to retrieve the current path and file name for the object.</span></span>

### <a name="shortcut-working-directory"></a><span data-ttu-id="bdfaa-180">Répertoire de travail du raccourci</span><span class="sxs-lookup"><span data-stu-id="bdfaa-180">Shortcut working directory</span></span>

<span data-ttu-id="bdfaa-181">Le répertoire de travail est le répertoire dans lequel l’objet correspondant d’un raccourci charge ou stocke les fichiers lorsque l’utilisateur n’identifie pas un répertoire spécifique.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-181">The working directory is the directory where the corresponding object of a shortcut loads or stores files when the user does not identify a specific directory.</span></span> <span data-ttu-id="bdfaa-182">Un fichier de liaison contient le nom du répertoire de travail de l’objet correspondant.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-182">A link file contains the name of the working directory for the corresponding object.</span></span> <span data-ttu-id="bdfaa-183">Une application peut définir le nom du répertoire de travail pour l’objet correspondant à l’aide de la méthode [**IShellLink :: SetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setworkingdirectory) et peut récupérer le nom du répertoire de travail actuel pour l’objet correspondant à l’aide de la méthode [**IShellLink :: GetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getworkingdirectory) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-183">An application can set the name of the working directory for the corresponding object by using the [**IShellLink::SetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setworkingdirectory) method and can retrieve the name of the current working directory for the corresponding object by using the [**IShellLink::GetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getworkingdirectory) method.</span></span>

### <a name="shortcut-command-line-arguments"></a><span data-ttu-id="bdfaa-184">Arguments de ligne de commande du raccourci</span><span class="sxs-lookup"><span data-stu-id="bdfaa-184">Shortcut command-line arguments</span></span>

<span data-ttu-id="bdfaa-185">Un fichier de liaison contient des arguments de ligne de commande que le shell passe à l’objet correspondant lorsque l’utilisateur sélectionne le lien.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-185">A link file contains command-line arguments that the Shell passes to the corresponding object when the user selects the link.</span></span> <span data-ttu-id="bdfaa-186">Une application peut définir les arguments de ligne de commande d’un raccourci à l’aide de la méthode [**IShellLink :: setArguments**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setarguments) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-186">An application can set the command-line arguments for a shortcut by using the [**IShellLink::SetArguments**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setarguments) method.</span></span> <span data-ttu-id="bdfaa-187">Il est utile de définir des arguments de ligne de commande lorsque l’application correspondante, telle qu’un éditeur de liens ou un compilateur, prend des indicateurs spéciaux comme arguments.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-187">It is useful to set command-line arguments when the corresponding application, such as a linker or compiler, takes special flags as arguments.</span></span> <span data-ttu-id="bdfaa-188">Une application peut récupérer les arguments de ligne de commande à partir d’un raccourci à l’aide de la méthode [**IShellLink :: GetArguments**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-ishelllinka-getarguments) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-188">An application can retrieve the command-line arguments from a shortcut by using the [**IShellLink::GetArguments**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-ishelllinka-getarguments) method.</span></span>

### <a name="shortcut-show-commands"></a><span data-ttu-id="bdfaa-189">Commandes d’affichage de raccourci</span><span class="sxs-lookup"><span data-stu-id="bdfaa-189">Shortcut show commands</span></span>

<span data-ttu-id="bdfaa-190">Lorsque l’utilisateur double-clique sur un raccourci, le système démarre l’application associée à l’objet correspondant et définit l’état d’affichage initial de l’application en fonction de la commande show spécifiée par le raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-190">When the user double-clicks a shortcut, the system starts the application associated with the corresponding object and sets the initial show state of the application based on the show command specified by the shortcut.</span></span> <span data-ttu-id="bdfaa-191">La commande show peut être l’une des \_ valeurs SW incluses dans la description de la fonction [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-191">The show command can be any of the SW\_ values included in the description of the [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) function.</span></span> <span data-ttu-id="bdfaa-192">Une application peut définir la commande Show pour un raccourci à l’aide de la méthode [**IShellLink :: SetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setshowcmd) et peut récupérer la commande Show en cours à l’aide de la méthode [**IShellLink :: GetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getshowcmd) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-192">An application can set the show command for a shortcut by using the [**IShellLink::SetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setshowcmd) method and can retrieve the current show command by using the [**IShellLink::GetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getshowcmd) method.</span></span>

### <a name="shortcut-icons"></a><span data-ttu-id="bdfaa-193">Icônes de raccourci</span><span class="sxs-lookup"><span data-stu-id="bdfaa-193">Shortcut icons</span></span>

<span data-ttu-id="bdfaa-194">Comme les autres objets Shell, un raccourci a une icône.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-194">Like other Shell objects, a shortcut has an icon.</span></span> <span data-ttu-id="bdfaa-195">L’utilisateur accède à l’objet associé à un raccourci en double-cliquant sur l’icône du raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-195">The user accesses the object associated with a shortcut by double-clicking the shortcut's icon.</span></span> <span data-ttu-id="bdfaa-196">Lorsque le système crée une icône pour un raccourci, il utilise l’image bitmap de l’objet correspondant et ajoute l’icône de superposition de lien définie par le système (une petite flèche) dans le coin inférieur gauche.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-196">When the system creates an icon for a shortcut, it uses the bitmap of the corresponding object and adds the system-defined link overlay icon (a small arrow) to the lower left corner.</span></span> <span data-ttu-id="bdfaa-197">Une application peut définir l’emplacement (chemin d’accès et index) d’une icône de raccourci à l’aide de la méthode [**IShellLink :: SetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-seticonlocation) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-197">An application can set the location (path and index) of a shortcut's icon by using the [**IShellLink::SetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-seticonlocation) method.</span></span> <span data-ttu-id="bdfaa-198">Une application peut récupérer cet emplacement à l’aide de la méthode [**IShellLink :: GetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-geticonlocation) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-198">An application can retrieve this location by using the [**IShellLink::GetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-geticonlocation) method.</span></span>

### <a name="shortcut-descriptions"></a><span data-ttu-id="bdfaa-199">Descriptions des raccourcis</span><span class="sxs-lookup"><span data-stu-id="bdfaa-199">Shortcut descriptions</span></span>

<span data-ttu-id="bdfaa-200">Les raccourcis ont des descriptions, mais l’utilisateur ne les voit jamais.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-200">Shortcuts have descriptions, but the user never sees them.</span></span> <span data-ttu-id="bdfaa-201">Une application peut utiliser une description pour stocker des informations de texte.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-201">An application can use a description to store any text information.</span></span> <span data-ttu-id="bdfaa-202">Les descriptions sont définies à l’aide de la méthode [**IShellLink :: SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) et récupérées à l’aide de la méthode [**IShellLink :: GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-202">Descriptions are set using the [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) method and retrieved using the [**IShellLink::GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) method.</span></span>

### <a name="shortcut-keyboard-shortcuts"></a><span data-ttu-id="bdfaa-203">Raccourcis clavier de raccourci</span><span class="sxs-lookup"><span data-stu-id="bdfaa-203">Shortcut Keyboard Shortcuts</span></span>

<span data-ttu-id="bdfaa-204">Un raccourci clavier peut être associé à un objet shortcut.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-204">A shortcut object can have a keyboard shortcut associated with it.</span></span> <span data-ttu-id="bdfaa-205">Les raccourcis clavier permettent à l’utilisateur d’appuyer sur une combinaison de touches pour activer un raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-205">Keyboard shortcuts allow a user to press a combination of keys to activate a shortcut.</span></span> <span data-ttu-id="bdfaa-206">Une application peut définir le raccourci clavier d’un raccourci à l’aide de la méthode [**IShellLink :: SetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-sethotkey) et peut récupérer le raccourci clavier actuel à l’aide de la méthode [**IShellLink :: GetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-gethotkey) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-206">An application can set the keyboard shortcut for a shortcut by using the [**IShellLink::SetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-sethotkey) method and can retrieve the current keyboard shortcut by using the [**IShellLink::GetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-gethotkey) method.</span></span>

### <a name="item-identifiers-and-identifier-lists"></a><span data-ttu-id="bdfaa-207">Identificateurs d’éléments et listes d’identificateurs</span><span class="sxs-lookup"><span data-stu-id="bdfaa-207">Item Identifiers and Identifier Lists</span></span>

<span data-ttu-id="bdfaa-208">L’interpréteur de commandes utilise des identificateurs d’objet dans l’espace de noms du shell.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-208">The Shell uses object identifiers within the Shell's namespace.</span></span> <span data-ttu-id="bdfaa-209">Tous les objets visibles dans l’interpréteur de commandes (fichiers, répertoires, serveurs, groupes de travail, etc.) ont des identificateurs uniques parmi les objets de leur dossier parent.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-209">All objects visible in the Shell (files, directories, servers, workgroups, and so on) have unique identifiers among the objects within their parent folder.</span></span> <span data-ttu-id="bdfaa-210">Ces identificateurs sont appelés identificateurs d’élément et ont le type de données [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) tel que défini dans le fichier d’en-tête Shtypes. h.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-210">These identifiers are called item identifiers, and they have the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) data type as defined in the Shtypes.h header file.</span></span> <span data-ttu-id="bdfaa-211">Un identificateur d’élément est un flux d’octets de longueur variable qui contient des informations qui identifient un objet dans un dossier.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-211">An item identifier is a variable-length byte stream that contains information that identifies an object within a folder.</span></span> <span data-ttu-id="bdfaa-212">Seul le créateur d’un identificateur d’élément connaît le contenu et le format de l’identificateur.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-212">Only the creator of an item identifier knows the content and format of the identifier.</span></span> <span data-ttu-id="bdfaa-213">La seule partie d’un identificateur d’élément utilisée par l’interpréteur de commandes est les deux premiers octets, qui spécifient la taille de l’identificateur.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-213">The only part of an item identifier that the Shell uses is the first two bytes, which specify the size of the identifier.</span></span>

<span data-ttu-id="bdfaa-214">Chaque dossier parent a son propre identificateur d’élément qui l’identifie dans son propre dossier parent.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-214">Each parent folder has its own item identifier that identifies it within its own parent folder.</span></span> <span data-ttu-id="bdfaa-215">Ainsi, tout objet Shell peut être identifié de manière unique par une liste d’identificateurs d’éléments.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-215">Thus, any Shell object can be uniquely identified by a list of item identifiers.</span></span> <span data-ttu-id="bdfaa-216">Un dossier parent conserve une liste d’identificateurs pour les éléments qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-216">A parent folder keeps a list of identifiers for the items it contains.</span></span> <span data-ttu-id="bdfaa-217">La liste a le type de données [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-217">The list has the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) data type.</span></span> <span data-ttu-id="bdfaa-218">Les listes d’identificateurs d’élément sont allouées par le shell et peuvent être passées entre les interfaces de Shell, telles que [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span><span class="sxs-lookup"><span data-stu-id="bdfaa-218">Item identifier lists are allocated by the Shell and may be passed across Shell interfaces, such as [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span> <span data-ttu-id="bdfaa-219">Il est important de se souvenir que chaque identificateur dans une liste d’identificateurs d’éléments est uniquement significatif dans le contexte de son dossier parent.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-219">It is important to remember that each identifier in an item identifier list is only meaningful within the context of its parent folder.</span></span>

<span data-ttu-id="bdfaa-220">Une application peut définir une liste d’identificateurs d’éléments de raccourci à l’aide de la méthode [**IShellLink :: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-220">An application can set a shortcut's item identifier list by using the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) method.</span></span> <span data-ttu-id="bdfaa-221">Cette méthode est utile lors de la définition d’un raccourci vers un objet qui n’est pas un fichier, tel qu’une imprimante ou un lecteur de disque.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-221">This method is useful when setting a shortcut to an object that is not a file, such as a printer or disk drive.</span></span> <span data-ttu-id="bdfaa-222">Une application peut récupérer la liste des identificateurs d’élément d’un raccourci à l’aide de la méthode [**IShellLink :: GetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getidlist) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-222">An application can retrieve a shortcut's item identifier list by using the [**IShellLink::GetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getidlist) method.</span></span>

## <a name="using-shell-links"></a><span data-ttu-id="bdfaa-223">Utilisation des liens de l’interpréteur de commandes</span><span class="sxs-lookup"><span data-stu-id="bdfaa-223">Using Shell Links</span></span>

<span data-ttu-id="bdfaa-224">Cette section contient des exemples qui montrent comment créer et résoudre des raccourcis à partir d’une application Win32.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-224">This section contains examples that demonstrate how to create and resolve shortcuts from within a Win32-based application.</span></span> <span data-ttu-id="bdfaa-225">Cette section suppose que vous êtes familiarisé avec la programmation Win32, C++ et OLE COM.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-225">This section assumes you are familiar with Win32, C++, and OLE COM programming.</span></span>

### <a name="creating-a-shortcut-and-a-folder-shortcut-to-a-file"></a><span data-ttu-id="bdfaa-226">Création d’un raccourci et d’un raccourci vers un fichier</span><span class="sxs-lookup"><span data-stu-id="bdfaa-226">Creating a Shortcut and a Folder Shortcut to a File</span></span>

<span data-ttu-id="bdfaa-227">L’exemple de fonction CreateLink de l’exemple suivant crée un raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-227">The CreateLink sample function in the following example creates a shortcut.</span></span> <span data-ttu-id="bdfaa-228">Les paramètres incluent un pointeur vers le nom du fichier à lier, un pointeur vers le nom du raccourci que vous créez et un pointeur vers la description du lien.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-228">The parameters include a pointer to the name of the file to link to, a pointer to the name of the shortcut that you are creating, and a pointer to the description of the link.</span></span> <span data-ttu-id="bdfaa-229">La description se compose de la chaîne « raccourci vers le **nom de fichier**», où nom de **fichier** est le nom du fichier à lier.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-229">The description consists of the string, "Shortcut to **file name**," where **file name** is the name of the file to link to.</span></span>

<span data-ttu-id="bdfaa-230">Pour créer un raccourci vers un dossier à l’aide de l’exemple de fonction CreateLink, appelez [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) en utilisant CLSID \_ FolderShortcut, au lieu de CLSID \_ ShellLink (CLSID \_ FolderShortcut prend en charge IShellLink).</span><span class="sxs-lookup"><span data-stu-id="bdfaa-230">To create a folder shortcut using the CreateLink sample function, call [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) using CLSID\_FolderShortcut, instead of CLSID\_ShellLink (CLSID\_FolderShortcut supports IShellLink).</span></span> <span data-ttu-id="bdfaa-231">Tout autre code reste le même.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-231">All other code remains the same.</span></span>

<span data-ttu-id="bdfaa-232">Étant donné que CreateLink appelle la fonction [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) , il est supposé que la fonction [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) a déjà été appelée.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-232">Because CreateLink calls the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function, it is assumed that the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function has already been called.</span></span> <span data-ttu-id="bdfaa-233">CreateLink utilise l’interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) pour enregistrer le raccourci et l’interface [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) pour stocker le nom et la description du fichier.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-233">CreateLink uses the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface to save the shortcut and the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface to store the file name and description.</span></span>


```C++
// CreateLink - Uses the Shell's IShellLink and IPersistFile interfaces 
//              to create and store a shortcut to the specified object. 
//
// Returns the result of calling the member functions of the interfaces. 
//
// Parameters:
// lpszPathObj  - Address of a buffer that contains the path of the object,
//                including the file name.
// lpszPathLink - Address of a buffer that contains the path where the 
//                Shell link is to be stored, including the file name.
// lpszDesc     - Address of a buffer that contains a description of the 
//                Shell link, stored in the Comment field of the link
//                properties.

#include "stdafx.h"
#include "windows.h"
#include "winnls.h"
#include "shobjidl.h"
#include "objbase.h"
#include "objidl.h"
#include "shlguid.h"

HRESULT CreateLink(LPCWSTR lpszPathObj, LPCSTR lpszPathLink, LPCWSTR lpszDesc) 
{ 
    HRESULT hres; 
    IShellLink* psl; 
 
    // Get a pointer to the IShellLink interface. It is assumed that CoInitialize
    // has already been called.
    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID*)&psl); 
    if (SUCCEEDED(hres)) 
    { 
        IPersistFile* ppf; 
 
        // Set the path to the shortcut target and add the description. 
        psl->SetPath(lpszPathObj); 
        psl->SetDescription(lpszDesc); 
 
        // Query IShellLink for the IPersistFile interface, used for saving the 
        // shortcut in persistent storage. 
        hres = psl->QueryInterface(IID_IPersistFile, (LPVOID*)&ppf); 
 
        if (SUCCEEDED(hres)) 
        { 
            WCHAR wsz[MAX_PATH]; 
 
            // Ensure that the string is Unicode. 
            MultiByteToWideChar(CP_ACP, 0, lpszPathLink, -1, wsz, MAX_PATH); 
            
            // Add code here to check return value from MultiByteWideChar 
            // for success.
 
            // Save the link by calling IPersistFile::Save. 
            hres = ppf->Save(wsz, TRUE); 
            ppf->Release(); 
        } 
        psl->Release(); 
    } 
    return hres; 
```



### <a name="resolving-a-shortcut"></a><span data-ttu-id="bdfaa-234">Résolution d’un raccourci</span><span class="sxs-lookup"><span data-stu-id="bdfaa-234">Resolving a Shortcut</span></span>

<span data-ttu-id="bdfaa-235">Une application peut avoir besoin d’accéder à un raccourci précédemment créé et de le manipuler.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-235">An application may need to access and manipulate a shortcut that was previously created.</span></span> <span data-ttu-id="bdfaa-236">Cette opération est appelée résolution du raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-236">This operation is referred to as resolving the shortcut.</span></span>

<span data-ttu-id="bdfaa-237">La fonction ResolveIt définie par l’application dans l’exemple suivant résout un raccourci.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-237">The application-defined ResolveIt function in the following example resolves a shortcut.</span></span> <span data-ttu-id="bdfaa-238">Ses paramètres incluent un handle de fenêtre, un pointeur vers le chemin d’accès du raccourci et l’adresse d’une mémoire tampon qui reçoit le nouveau chemin d’accès à l’objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-238">Its parameters include a window handle, a pointer to the path of the shortcut, and the address of a buffer that receives the new path to the object.</span></span> <span data-ttu-id="bdfaa-239">Le handle de fenêtre identifie la fenêtre parente pour les boîtes de message que le Shell peut avoir besoin d’afficher.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-239">The window handle identifies the parent window for any message boxes that the Shell may need to display.</span></span> <span data-ttu-id="bdfaa-240">Par exemple, l’interpréteur de commandes peut afficher une boîte de message si le lien se trouve sur un média non partagé, si des problèmes réseau se produisent, si l’utilisateur doit insérer une disquette, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-240">For example, the Shell can display a message box if the link is on unshared media, if network problems occur, if the user needs to insert a floppy disk, and so on.</span></span>

<span data-ttu-id="bdfaa-241">La fonction ResolveIt appelle la fonction [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) et suppose que la fonction [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) a déjà été appelée.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-241">The ResolveIt function calls the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and assumes that the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function has already been called.</span></span> <span data-ttu-id="bdfaa-242">Notez que ResolveIt doit utiliser l’interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) pour stocker les informations de lien.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-242">Note that ResolveIt needs to use the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface to store the link information.</span></span> <span data-ttu-id="bdfaa-243">**IPersistFile** est implémenté par l’objet [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-243">**IPersistFile** is implemented by the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) object.</span></span> <span data-ttu-id="bdfaa-244">Les informations de lien doivent être chargées avant que les informations de chemin d’accès ne soient récupérées, ce qui est indiqué plus loin dans cet exemple.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-244">The link information must be loaded before the path information is retrieved, which is shown later in the example.</span></span> <span data-ttu-id="bdfaa-245">L’échec du chargement des informations de lien entraîne l’échec des appels aux fonctions membres [**IShellLink :: GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) et [**IShellLink :: GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) .</span><span class="sxs-lookup"><span data-stu-id="bdfaa-245">Failing to load the link information causes the calls to the [**IShellLink::GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) and [**IShellLink::GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) member functions to fail.</span></span>


```C++
// ResolveIt - Uses the Shell's IShellLink and IPersistFile interfaces 
//             to retrieve the path and description from an existing shortcut. 
//
// Returns the result of calling the member functions of the interfaces. 
//
// Parameters:
// hwnd         - A handle to the parent window. The Shell uses this window to 
//                display a dialog box if it needs to prompt the user for more 
//                information while resolving the link.
// lpszLinkFile - Address of a buffer that contains the path of the link,
//                including the file name.
// lpszPath     - Address of a buffer that receives the path of the link
                  target, including the file name.
// lpszDesc     - Address of a buffer that receives the description of the 
//                Shell link, stored in the Comment field of the link
//                properties.

#include "stdafx.h"
#include "windows.h"
#include "shobjidl.h"
#include "shlguid.h"
#include "strsafe.h"
                            
HRESULT ResolveIt(HWND hwnd, LPCSTR lpszLinkFile, LPWSTR lpszPath, int iPathBufferSize) 
{ 
    HRESULT hres; 
    IShellLink* psl; 
    WCHAR szGotPath[MAX_PATH]; 
    WCHAR szDescription[MAX_PATH]; 
    WIN32_FIND_DATA wfd; 
 
    *lpszPath = 0; // Assume failure 

    // Get a pointer to the IShellLink interface. It is assumed that CoInitialize
    // has already been called. 
    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID*)&psl); 
    if (SUCCEEDED(hres)) 
    { 
        IPersistFile* ppf; 
 
        // Get a pointer to the IPersistFile interface. 
        hres = psl->QueryInterface(IID_IPersistFile, (void**)&ppf); 
        
        if (SUCCEEDED(hres)) 
        { 
            WCHAR wsz[MAX_PATH]; 
 
            // Ensure that the string is Unicode. 
            MultiByteToWideChar(CP_ACP, 0, lpszLinkFile, -1, wsz, MAX_PATH); 
 
            // Add code here to check return value from MultiByteWideChar 
            // for success.
 
            // Load the shortcut. 
            hres = ppf->Load(wsz, STGM_READ); 
            
            if (SUCCEEDED(hres)) 
            { 
                // Resolve the link. 
                hres = psl->Resolve(hwnd, 0); 

                if (SUCCEEDED(hres)) 
                { 
                    // Get the path to the link target. 
                    hres = psl->GetPath(szGotPath, MAX_PATH, (WIN32_FIND_DATA*)&wfd, SLGP_SHORTPATH); 

                    if (SUCCEEDED(hres)) 
                    { 
                        // Get the description of the target. 
                        hres = psl->GetDescription(szDescription, MAX_PATH); 

                        if (SUCCEEDED(hres)) 
                        {
                            hres = StringCbCopy(lpszPath, iPathBufferSize, szGotPath);
                            if (SUCCEEDED(hres))
                            {
                                // Handle success
                            }
                            else
                            {
                                // Handle the error
                            }
                        }
                    }
                } 
            } 

            // Release the pointer to the IPersistFile interface. 
            ppf->Release(); 
        } 

        // Release the pointer to the IShellLink interface. 
        psl->Release(); 
    } 
    return hres; 
}
```



### <a name="creating-a-shortcut-to-a-nonfile-object"></a><span data-ttu-id="bdfaa-246">Création d’un raccourci vers un objet qui n’est pas un fichier</span><span class="sxs-lookup"><span data-stu-id="bdfaa-246">Creating a Shortcut to a Nonfile Object</span></span>

<span data-ttu-id="bdfaa-247">La création d’un raccourci vers un objet non-fichier, tel qu’une imprimante, est similaire à la création d’un raccourci vers un fichier, à ceci près qu’au lieu de définir le chemin d’accès au fichier, vous devez définir la liste d’identificateurs sur l’imprimante.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-247">Creating a shortcut to a nonfile object, such as a printer, is similar to creating a shortcut to a file except that rather than setting the path to the file, you must set the identifier list to the printer.</span></span> <span data-ttu-id="bdfaa-248">Pour définir la liste d’identificateurs, appelez la méthode [**IShellLink :: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) , en spécifiant l’adresse d’une liste d’identificateurs.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-248">To set the identifier list, call the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) method, specifying the address of an identifier list.</span></span>

<span data-ttu-id="bdfaa-249">Chaque objet dans l’espace de noms de l’interpréteur de commandes a un identificateur d’élément.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-249">Each object within the Shell's namespace has an item identifier.</span></span> <span data-ttu-id="bdfaa-250">L’interpréteur de commandes concatène souvent des identificateurs d’élément dans des listes se terminant par un caractère null, composées de n’importe quel nombre d’identificateurs d’élément.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-250">The Shell often concatenates item identifiers into null-terminated lists consisting of any number of item identifiers.</span></span> <span data-ttu-id="bdfaa-251">Pour plus d’informations sur les identificateurs d’élément, consultez [identificateurs d’élément et listes d’identificateurs](#item-identifiers-and-identifier-lists).</span><span class="sxs-lookup"><span data-stu-id="bdfaa-251">For more information about item identifiers, see [Item Identifiers and Identifier Lists](#item-identifiers-and-identifier-lists).</span></span>

<span data-ttu-id="bdfaa-252">En général, si vous devez définir un raccourci vers un élément qui n’a pas de nom de fichier, tel qu’une imprimante, vous aurez déjà un pointeur vers l’interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) de l’objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-252">In general, if you need to set a shortcut to an item that does not have a file name, such as a printer, you will already have a pointer to the object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="bdfaa-253">**IShellFolder** est utilisé pour créer des extensions d’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-253">**IShellFolder** is used to create namespace extensions.</span></span>

<span data-ttu-id="bdfaa-254">Une fois que vous disposez de l’identificateur de classe pour [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), vous pouvez appeler la fonction [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) pour récupérer l’adresse de l’interface.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-254">Once you have the class identifier for [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), you can call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function to retrieve the address of the interface.</span></span> <span data-ttu-id="bdfaa-255">Vous pouvez ensuite appeler l’interface pour énumérer les objets dans le dossier et récupérer l’adresse de l’identificateur d’élément pour l’objet que vous recherchez.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-255">Then you can call the interface to enumerate the objects in the folder and retrieve the address of the item identifier for the object that you are searching for.</span></span> <span data-ttu-id="bdfaa-256">Enfin, vous pouvez utiliser l’adresse dans un appel à la fonction membre [**IShellLink :: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) pour créer un raccourci vers l’objet.</span><span class="sxs-lookup"><span data-stu-id="bdfaa-256">Finally, you can use the address in a call to the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) member function to create a shortcut to the object.</span></span>

 

 
