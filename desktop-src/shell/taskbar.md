---
description: L’interface Windows comprend une barre d’outils de bureau d’application spéciale appelée barre des tâches. Vous pouvez utiliser la barre des tâches pour effectuer des tâches telles que le basculement entre des fenêtres ouvertes et le démarrage de nouvelles applications.
ms.assetid: 14d520e7-7c15-441d-9662-24b972d208ac
title: La barre des tâches
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cce37991c6265f02ab92ece62dbae341031d272a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104991708"
---
# <a name="the-taskbar"></a><span data-ttu-id="272df-104">La barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-104">The Taskbar</span></span>

<span data-ttu-id="272df-105">L’interface Windows comprend une [barre d’outils de bureau d’application](application-desktop-toolbars.md) spéciale appelée *barre des tâches*.</span><span class="sxs-lookup"><span data-stu-id="272df-105">The Windows interface includes a special [application desktop toolbar](application-desktop-toolbars.md) called the *taskbar*.</span></span> <span data-ttu-id="272df-106">Vous pouvez utiliser la barre des tâches pour effectuer des tâches telles que le basculement entre des fenêtres ouvertes et le démarrage de nouvelles applications.</span><span class="sxs-lookup"><span data-stu-id="272df-106">You can use the taskbar for such tasks as switching between open windows and starting new applications.</span></span>

> [!Note]  
> <span data-ttu-id="272df-107">Pour plus d’informations sur les modifications apportées à la barre des tâches depuis Windows 7, consultez extensions de la [barre des tâches](taskbar-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="272df-107">For information on changes made to the taskbar as of Windows 7, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

 

<span data-ttu-id="272df-108">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="272df-108">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="272df-109">À propos de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-109">About the Taskbar</span></span>](#about-the-taskbar)
    -   [<span data-ttu-id="272df-110">Options d’affichage de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-110">Taskbar Display Options</span></span>](#taskbar-display-options)
    -   [<span data-ttu-id="272df-111">Ajout de raccourcis au menu Démarrer</span><span class="sxs-lookup"><span data-stu-id="272df-111">Adding Shortcuts to the Start Menu</span></span>](#adding-shortcuts-to-the-start-menu)
    -   [<span data-ttu-id="272df-112">Gestion des boutons de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-112">Managing Taskbar Buttons</span></span>](#managing-taskbar-buttons)
    -   [<span data-ttu-id="272df-113">Ajout, modification et suppression d’icônes dans la zone de notification</span><span class="sxs-lookup"><span data-stu-id="272df-113">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>](#adding-modifying-and-deleting-icons-in-the-notification-area)
    -   [<span data-ttu-id="272df-114">Notification de création de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-114">Taskbar Creation Notification</span></span>](#taskbar-creation-notification)
-   [<span data-ttu-id="272df-115">Utilisation de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-115">Using the Taskbar</span></span>](#using-the-taskbar)
    -   [<span data-ttu-id="272df-116">Ajout et suppression d’icônes de la barre des tâches dans la zone de notification</span><span class="sxs-lookup"><span data-stu-id="272df-116">Adding and Deleting Taskbar Icons in the Notification Area</span></span>](#adding-and-deleting-taskbar-icons-in-the-notification-area)
    -   [<span data-ttu-id="272df-117">Réception d’événements de souris</span><span class="sxs-lookup"><span data-stu-id="272df-117">Receiving Mouse Events</span></span>](#receiving-mouse-events)

## <a name="about-the-taskbar"></a><span data-ttu-id="272df-118">À propos de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-118">About the Taskbar</span></span>

<span data-ttu-id="272df-119">La barre des tâches comprend les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="272df-119">The taskbar includes the following:</span></span>

-   <span data-ttu-id="272df-120">Menu **Démarrer**</span><span class="sxs-lookup"><span data-stu-id="272df-120">**Start** menu</span></span>
-   <span data-ttu-id="272df-121">Barre lancement rapide (Windows Vista et versions antérieures uniquement)</span><span class="sxs-lookup"><span data-stu-id="272df-121">Quick Launch bar (Windows Vista and earlier only)</span></span>
-   <span data-ttu-id="272df-122">Boutons de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-122">Taskbar buttons</span></span>
-   <span data-ttu-id="272df-123">Barres d’outils (facultatif)</span><span class="sxs-lookup"><span data-stu-id="272df-123">Toolbars (optional)</span></span>
-   <span data-ttu-id="272df-124">Zone Notifications</span><span class="sxs-lookup"><span data-stu-id="272df-124">Notification area</span></span>

<span data-ttu-id="272df-125">Le menu **Démarrer** contient des commandes qui peuvent accéder à des programmes, des documents et des paramètres.</span><span class="sxs-lookup"><span data-stu-id="272df-125">The **Start** menu contains commands that can access programs, documents, and settings.</span></span> <span data-ttu-id="272df-126">Ces commandes incluent **l’ensemble des programmes**, des **documents**, **le panneau de configuration**, les **jeux**, **l’aide et le support, l'** arrêt et **la** **recherche de programmes et fichiers**.</span><span class="sxs-lookup"><span data-stu-id="272df-126">These commands include **All Programs**, **Documents**, **Control Panel**, **Games**, **Help and Support**, **Shut down**, and **Search programs and files**.</span></span>

<span data-ttu-id="272df-127">Le **début** dans les versions antérieures de Windows contenait des éléments tels que la **recherche** et l' **exécution**, qui étaient inclus dans les **programmes et les fichiers de recherche** de Windows Vista et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="272df-127">The **Start** in earlier versions of Windows contained items such as **Find** and **Run**, the functionality of which was included in **Search programs and files** in Windows Vista and later.</span></span>

<span data-ttu-id="272df-128">La barre lancement rapide, disponible dans les versions de Windows antérieures à Windows 7, contient des raccourcis vers les applications.</span><span class="sxs-lookup"><span data-stu-id="272df-128">The Quick Launch bar, available in versions of Windows earlier than Windows 7, contains shortcuts to applications.</span></span> <span data-ttu-id="272df-129">Windows fournit des entrées par défaut, telles que Windows Internet Explorer, et l’utilisateur peut ajouter les autres raccourcis qu’il choisit.</span><span class="sxs-lookup"><span data-stu-id="272df-129">Windows provides default entries, such as Windows Internet Explorer, and the user can add any further shortcuts that they choose.</span></span> <span data-ttu-id="272df-130">Les icônes de cette zone répondent à un simple clic.</span><span class="sxs-lookup"><span data-stu-id="272df-130">Icons in this area respond to a single click.</span></span> <span data-ttu-id="272df-131">Dans Windows 7 et versions ultérieures, cette fonctionnalité est incluse dans les boutons de la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-131">In Windows 7 and later, this functionality is included in the taskbar buttons.</span></span>

<span data-ttu-id="272df-132">L’interpréteur de commandes place un bouton sur la barre des tâches chaque fois qu’une application crée une fenêtre sans propriétaire, autrement dit une fenêtre qui n’a pas de parent et qui possède les bits de style étendu appropriés (consultez [gestion des boutons de la barre des tâches](#managing-taskbar-buttons), ci-dessous).</span><span class="sxs-lookup"><span data-stu-id="272df-132">The Shell places a button on the taskbar whenever an application creates an unowned window—that is, a window that does not have a parent and that has the appropriate extended style bits (see [Managing Taskbar Buttons](#managing-taskbar-buttons), below).</span></span> <span data-ttu-id="272df-133">Pour basculer vers une fenêtre, l’utilisateur clique sur son bouton de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="272df-133">To switch to a window, the user clicks its window button.</span></span> <span data-ttu-id="272df-134">Cette fonctionnalité a été développée à partir de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="272df-134">This functionality has been greatly expanded as of Windows 7.</span></span> <span data-ttu-id="272df-135">Pour plus d’informations, consultez [extensions de la barre des tâches](taskbar-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="272df-135">For more information, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

<span data-ttu-id="272df-136">Les applications peuvent placer des icônes dans la zone de notification pour indiquer l’état d’une opération ou pour notifier l’utilisateur d’un événement.</span><span class="sxs-lookup"><span data-stu-id="272df-136">Applications can put icons in the notification area to indicate the status of an operation or to notify the user about an event.</span></span> <span data-ttu-id="272df-137">Par exemple, une application peut placer une icône d’imprimante dans la zone de notification pour montrer qu’un travail d’impression est en cours.</span><span class="sxs-lookup"><span data-stu-id="272df-137">For example, an application might put a printer icon in the notification area to show that a print job is under way.</span></span> <span data-ttu-id="272df-138">Toutefois, dans Windows 7 et versions ultérieures, certaines des informations fournies précédemment par la zone de notification doivent être fournies par le biais du bouton de la barre des tâches d’une application.</span><span class="sxs-lookup"><span data-stu-id="272df-138">However, in Windows 7 and later, some of the information previously provided by the notification area should be provided through an application's taskbar button.</span></span> <span data-ttu-id="272df-139">La zone de notification se trouve sur le bord droit de la barre des tâches (si la barre des tâches est horizontale) ou en bas (si la barre des tâches est verticale).</span><span class="sxs-lookup"><span data-stu-id="272df-139">The notification area is located at the right edge of the taskbar (if the taskbar is horizontal) or at the bottom (if the taskbar is vertical).</span></span> <span data-ttu-id="272df-140">Pour plus d’informations, consultez [notifications et la zone de notification](notification-area.md).</span><span class="sxs-lookup"><span data-stu-id="272df-140">For more information, see [Notifications and the Notification Area](notification-area.md).</span></span>

<span data-ttu-id="272df-141">La zone de notification affiche également l’heure actuelle si cette option est sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="272df-141">The notification area also displays the current time if that option is selected.</span></span> <span data-ttu-id="272df-142">L’option se trouve comme suit :</span><span class="sxs-lookup"><span data-stu-id="272df-142">The option is found as:</span></span>

-   <span data-ttu-id="272df-143">**Windows 7 et versions ultérieures**: liste déroulante **horloge** dans la page **activer ou désactiver les icônes système** de la **zone de notification icône** de l’application panneau de configuration (également accessible via les propriétés de la zone de notification).</span><span class="sxs-lookup"><span data-stu-id="272df-143">**Windows 7 and later**: The **Clock** drop-down list in the **Turn system icons on or off** page of the **Notification Area Icons** Control Panel application (also accessible through the notification area properties).</span></span>
-   <span data-ttu-id="272df-144">**Windows Vista**: case à cocher **horloge** dans la page **zone de notification** de la fenêtre Propriétés de la **barre des tâches et du menu Démarrer** .</span><span class="sxs-lookup"><span data-stu-id="272df-144">**Windows Vista**: The **Clock** check box in the **Notification Area** page of the **Taskbar and Start Menu** properties window.</span></span>
-   <span data-ttu-id="272df-145">**Windows XP**: la case à cocher **afficher l’horloge** dans la **barre des tâches et** la fenêtre Propriétés du menu Démarrer.</span><span class="sxs-lookup"><span data-stu-id="272df-145">**Windows XP**: The **Show the clock** check box in the **Taskbar and Start Menu** properties window.</span></span>

<span data-ttu-id="272df-146">L’utilisateur peut cliquer avec le bouton droit sur la barre des tâches pour afficher le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="272df-146">The user can right-click the taskbar to display the shortcut menu.</span></span> <span data-ttu-id="272df-147">Le menu contextuel comprend des commandes pour les fenêtres en cascade, les fenêtres de pile, les fenêtres afficher côte à côte, afficher le bureau, démarrer le gestionnaire des tâches et définir les propriétés de la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-147">The shortcut menu includes commands to cascade windows, stack windows, show windows side-by-side, show the desktop, start Task Manager, and set taskbar properties.</span></span> <span data-ttu-id="272df-148">Le menu contextuel offre également la possibilité d’ajouter ou de supprimer un ensemble de barres d’outils à partir de la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-148">The shortcut menu also provides the option to add or remove a set of toolbars from the taskbar.</span></span> <span data-ttu-id="272df-149">Vous pouvez ajouter de nouvelles barres d’outils à ce menu en les inscrivant sous la \_ catégorie DESKBAND CATID.</span><span class="sxs-lookup"><span data-stu-id="272df-149">You can add new toolbars to this menu by registering them under the CATID\_DeskBand category.</span></span> <span data-ttu-id="272df-150">Pour plus d’informations, consultez [Implementing Band Objects](band-objects.md).</span><span class="sxs-lookup"><span data-stu-id="272df-150">For more information, see [Implementing Band Objects](band-objects.md).</span></span> <span data-ttu-id="272df-151">Notez que depuis Windows 7, la barre des tâches et la zone de notification ont des menus contextuels distincts.</span><span class="sxs-lookup"><span data-stu-id="272df-151">Note that as of Windows 7, the taskbar and the notification area have separate shortcut menus.</span></span> <span data-ttu-id="272df-152">Ces menus contextuels partagent des options, telles que la disposition des fenêtres, et en ajouter d’autres.</span><span class="sxs-lookup"><span data-stu-id="272df-152">These shortcut menus share some options, such as window arrangement, and add others.</span></span>

### <a name="taskbar-display-options"></a><span data-ttu-id="272df-153">Options d’affichage de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-153">Taskbar Display Options</span></span>

<span data-ttu-id="272df-154">La barre des tâches prend en charge deux options d’affichage : Masquer automatiquement et, dans Windows Vista et les versions antérieures uniquement, Always On haut (la barre des tâches est toujours dans ce mode dans Windows 7 et versions ultérieures).</span><span class="sxs-lookup"><span data-stu-id="272df-154">The taskbar supports two display options: Auto-Hide and, in Windows Vista and earlier only, Always On Top (the taskbar is always in this mode in Windows 7 and later).</span></span> <span data-ttu-id="272df-155">Pour définir ces options, l’utilisateur doit ouvrir le menu contextuel de la barre des tâches, cliquer sur **Propriétés**, activer ou désactiver la case à cocher **Masquer automatiquement la barre des tâches** ou **conserver la barre des tâches au-dessus des autres fenêtres** .</span><span class="sxs-lookup"><span data-stu-id="272df-155">To set these options, the user must open the taskbar shortcut menu, click **Properties**, and select or clear the **Auto-hide the taskbar** check box or the **Keep the taskbar on top of other windows** check box.</span></span> <span data-ttu-id="272df-156">Pour récupérer l’état de ces options d’affichage, utilisez le message [**ABM \_ GETSTATE**](abm-getstate.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-156">To retrieve the state of these display options, use the [**ABM\_GETSTATE**](abm-getstate.md) message.</span></span> <span data-ttu-id="272df-157">Si vous souhaitez être averti lorsque l’état de ces options d’affichage change, traitez le message de notification [**ABN \_ STATECHANGE**](abn-statechange.md) dans votre procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="272df-157">If you would like to be notified when the state of these display options changes, process the [**ABN\_STATECHANGE**](abn-statechange.md) notification message in your window procedure.</span></span> <span data-ttu-id="272df-158">Pour modifier l’état de ces options d’affichage, utilisez le message [**ABM \_ SETSTATE**](abm-setstate.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-158">To change the state of these display options, use the [**ABM\_SETSTATE**](abm-setstate.md) message.</span></span>

<span data-ttu-id="272df-159">La *zone de travail* est la partie de l’écran qui n’est pas masquée par la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-159">The *work area* is the portion of the screen not obscured by the taskbar.</span></span> <span data-ttu-id="272df-160">Pour récupérer la taille de la zone de travail, appelez la fonction [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) avec la valeur **SPI \_ GETWORKAREA** définie.</span><span class="sxs-lookup"><span data-stu-id="272df-160">To retrieve the size of the work area, call the [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) function with the **SPI\_GETWORKAREA** value set.</span></span> <span data-ttu-id="272df-161">Pour récupérer les coordonnées du rectangle qui décrivent l’emplacement de la barre des tâches, utilisez le message [**ABM \_ GETTASKBARPOS**](abm-gettaskbarpos.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-161">To retrieve the rectangle coordinates that describe the location of the taskbar, use the [**ABM\_GETTASKBARPOS**](abm-gettaskbarpos.md) message.</span></span>

<span data-ttu-id="272df-162">Il est possible de couvrir la barre des tâches en définissant explicitement la taille du rectangle de la fenêtre sur la taille de l’écran avec [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span><span class="sxs-lookup"><span data-stu-id="272df-162">It is possible to cover the taskbar by explicitly setting the size of the window rectangle equal to the size of the screen with [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span></span> <span data-ttu-id="272df-163">Pour les systèmes Windows 2000 ou version ultérieure, la fenêtre ne doit pas avoir la valeur [**WS \_ Caption**](../winmsg/window-styles.md) ou [**WS \_ THICKFRAME**](../winmsg/window-styles.md), sinon la fenêtre doit être dimensionnée afin que la zone cliente couvre la totalité de l’écran.</span><span class="sxs-lookup"><span data-stu-id="272df-163">For Windows 2000 systems or later, the window must lack either [**WS\_CAPTION**](../winmsg/window-styles.md) or [**WS\_THICKFRAME**](../winmsg/window-styles.md), or else the window must be sized so that the client area covers the entire screen.</span></span> <span data-ttu-id="272df-164">Plus particulièrement, si la barre des tâches est définie sur Always On Top, elle reste masquée uniquement lorsque l’application est l’application de premier plan.</span><span class="sxs-lookup"><span data-stu-id="272df-164">Also particular to those systems, if the taskbar is set to Always On Top, it will remain hidden only while the application is the foreground application.</span></span>

### <a name="adding-shortcuts-to-the-start-menu"></a><span data-ttu-id="272df-165">Ajout de raccourcis au menu Démarrer</span><span class="sxs-lookup"><span data-stu-id="272df-165">Adding Shortcuts to the Start Menu</span></span>

<span data-ttu-id="272df-166">Pour ajouter un élément au sous-menu **programmes** sur Microsoft Windows NT 4,0, Windows 2000 et versions ultérieures, ou Windows 95 ou version ultérieure, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="272df-166">To add an item to the **Programs** submenu on Microsoft Windows NT 4.0, Windows 2000 and later, or Windows 95 or later, follow these steps.</span></span>

1.  <span data-ttu-id="272df-167">Créez un [lien de Shell](./links.md) à l’aide de l’interface [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) .</span><span class="sxs-lookup"><span data-stu-id="272df-167">Create a [shell link](./links.md) by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface.</span></span>
2.  <span data-ttu-id="272df-168">Obtenez le PIDL du dossier programmes à l’aide de [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), en passant les [**\_ programmes CSIDL**](csidl.md).</span><span class="sxs-lookup"><span data-stu-id="272df-168">Obtain the PIDL of the Programs folder by using [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), passing [**CSIDL\_PROGRAMS**](csidl.md).</span></span>
3.  <span data-ttu-id="272df-169">Ajoutez le lien de l’interpréteur de commandes au dossier programmes.</span><span class="sxs-lookup"><span data-stu-id="272df-169">Add the Shell link to the Programs folder.</span></span> <span data-ttu-id="272df-170">Vous pouvez également créer un dossier dans le dossier programmes et ajouter le lien vers ce dossier.</span><span class="sxs-lookup"><span data-stu-id="272df-170">You can also create a folder in the Programs folder and add the link to that folder.</span></span>

### <a name="managing-taskbar-buttons"></a><span data-ttu-id="272df-171">Gestion des boutons de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-171">Managing Taskbar Buttons</span></span>

<span data-ttu-id="272df-172">L’interpréteur de commandes crée un bouton sur la barre des tâches chaque fois qu’une application crée une fenêtre qui n’est pas propriétaire.</span><span class="sxs-lookup"><span data-stu-id="272df-172">The Shell creates a button on the taskbar whenever an application creates a window that isn't owned.</span></span> <span data-ttu-id="272df-173">Pour vous assurer que le bouton de la fenêtre est placé dans la barre des tâches, créez une fenêtre sans propriétaire avec le style étendu [**WS \_ ex \_ APPWINDOW**](../winmsg/extended-window-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-173">To ensure that the window button is placed on the taskbar, create an unowned window with the [**WS\_EX\_APPWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="272df-174">Pour empêcher le bouton de la fenêtre d’être placé dans la barre des tâches, créez la fenêtre sans propriétaire avec le style étendu [**WS \_ ex \_ TOOLWINDOW**](../winmsg/extended-window-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-174">To prevent the window button from being placed on the taskbar, create the unowned window with the [**WS\_EX\_TOOLWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="272df-175">Vous pouvez également créer une fenêtre masquée et faire de cette fenêtre masquée le propriétaire de votre fenêtre visible.</span><span class="sxs-lookup"><span data-stu-id="272df-175">As an alternative, you can create a hidden window and make this hidden window the owner of your visible window.</span></span>

<span data-ttu-id="272df-176">L’interpréteur de commandes ne supprime le bouton d’une fenêtre de la barre des tâches que si le style de la fenêtre prend en charge les boutons de barre des tâches visibles.</span><span class="sxs-lookup"><span data-stu-id="272df-176">The Shell will remove a window's button from the taskbar only if the window's style supports visible taskbar buttons.</span></span> <span data-ttu-id="272df-177">Si vous souhaitez modifier dynamiquement le style d’une fenêtre pour qu’il ne prenne pas en charge les boutons visibles de la barre des tâches, vous devez d’abord masquer la fenêtre (en appelant la fonction [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) avec l’affichage **logiciel \_ masqué**), modifier le style de la fenêtre, puis afficher la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="272df-177">If you want to dynamically change a window's style to one that does not support visible taskbar buttons, you must hide the window first (by calling [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) with **SW\_HIDE**), change the window style, and then show the window.</span></span>

<span data-ttu-id="272df-178">Le bouton de la fenêtre contient généralement l’icône et le titre de l’application.</span><span class="sxs-lookup"><span data-stu-id="272df-178">The window button typically contains the application icon and title.</span></span> <span data-ttu-id="272df-179">Toutefois, si l’application ne contient pas de menu système, le bouton de la fenêtre est créé sans l’icône.</span><span class="sxs-lookup"><span data-stu-id="272df-179">However, if the application does not contain a system menu, the window button is created without the icon.</span></span>

<span data-ttu-id="272df-180">Si vous souhaitez que votre application attire l’attention de l’utilisateur lorsque la fenêtre n’est pas active, utilisez la fonction [**flashwindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) pour informer l’utilisateur qu’un message est en attente.</span><span class="sxs-lookup"><span data-stu-id="272df-180">If you want your application to get the user's attention when the window is not active, use the [**FlashWindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) function to let the user know that a message is waiting.</span></span> <span data-ttu-id="272df-181">Cette fonction clignote le bouton de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="272df-181">This function flashes the window button.</span></span> <span data-ttu-id="272df-182">Une fois que l’utilisateur a cliqué sur le bouton de la fenêtre pour activer la fenêtre, votre application peut afficher le message.</span><span class="sxs-lookup"><span data-stu-id="272df-182">Once the user clicks the window button to activate the window, your application can display the message.</span></span>

### <a name="modifying-the-contents-of-the-taskbar"></a><span data-ttu-id="272df-183">Modification du contenu de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-183">Modifying the Contents of the Taskbar</span></span>

<span data-ttu-id="272df-184">La [Version 4,71 et les versions ultérieures](versions.md) de Shell32.dll ajoutent la possibilité de modifier le contenu de la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-184">[Version 4.71 and later](versions.md) of Shell32.dll adds the capability to modify the contents of the taskbar.</span></span> <span data-ttu-id="272df-185">À partir d’une application, vous pouvez maintenant ajouter, supprimer et activer des boutons de la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-185">From an application, you can now add, remove, and activate taskbar buttons.</span></span> <span data-ttu-id="272df-186">L’activation de l’élément n’active pas la fenêtre ; il affiche l’élément tel qu’il est appuyé sur la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-186">Activating the item does not activate the window; it shows the item as pressed on the taskbar.</span></span>

<span data-ttu-id="272df-187">Les fonctionnalités de modification de la barre des tâches sont implémentées dans un objet COM (Component Object Model) (CLSID \_ TaskbarList) qui expose l’interface [**ITASKBARLIST**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) (IID \_ ITaskbarList).</span><span class="sxs-lookup"><span data-stu-id="272df-187">The taskbar modification capabilities are implemented in a Component Object Model (COM) object (CLSID\_TaskbarList ) that exposes the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface (IID\_ITaskbarList).</span></span> <span data-ttu-id="272df-188">Vous devez appeler la méthode [**ITaskbarList :: HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) pour initialiser l’objet.</span><span class="sxs-lookup"><span data-stu-id="272df-188">You must call the [**ITaskbarList::HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) method to initialize the object.</span></span> <span data-ttu-id="272df-189">Vous pouvez ensuite utiliser les méthodes de l’interface [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) pour modifier le contenu de la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-189">You can then use the methods of the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface to modify the contents of the taskbar.</span></span>

### <a name="adding-modifying-and-deleting-icons-in-the-notification-area"></a><span data-ttu-id="272df-190">Ajout, modification et suppression d’icônes dans la zone de notification</span><span class="sxs-lookup"><span data-stu-id="272df-190">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>

<span data-ttu-id="272df-191">Utilisez la [**fonction \_ NotifyIcon de l’interpréteur**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) de commandes pour ajouter, modifier ou supprimer des icônes dans la zone de notification.</span><span class="sxs-lookup"><span data-stu-id="272df-191">Use the [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) function to add, modify, or delete icons from the notification area.</span></span> <span data-ttu-id="272df-192">Le paramètre *dwMessage* de l' **interface \_ NotifyIcon de l’interpréteur** de commandes est un message de la barre des tâches qui spécifie l’action à entreprendre.</span><span class="sxs-lookup"><span data-stu-id="272df-192">The *dwMessage* parameter of **Shell\_NotifyIcon** is a message to the taskbar that specifies the action to be taken.</span></span> <span data-ttu-id="272df-193">Le paramètre *pnid* est un pointeur vers une structure [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) qui permet d’identifier l’icône et de transmettre toutes les informations supplémentaires nécessaires au système pour traiter le message.</span><span class="sxs-lookup"><span data-stu-id="272df-193">The *pnid* parameter is a pointer to a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure that is used to identify the icon and pass any additional information that is needed for the system to process the message.</span></span>

<span data-ttu-id="272df-194">Vous pouvez effectuer les actions suivantes avec les icônes de la zone de notification.</span><span class="sxs-lookup"><span data-stu-id="272df-194">You can perform the following actions with notification area icons.</span></span>

-   <span data-ttu-id="272df-195">Pour ajouter une icône à la zone de notification de la barre des tâches, appelez l' [**interface \_ NotifyIcon Shell**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) avec le paramètre *dwMessage* défini sur NIM \_ Add.</span><span class="sxs-lookup"><span data-stu-id="272df-195">To add an icon to the taskbar's notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_ADD.</span></span> <span data-ttu-id="272df-196">La structure [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) est utilisée pour spécifier le handle et l’identificateur de l’icône, ainsi que tout texte info-bulle.</span><span class="sxs-lookup"><span data-stu-id="272df-196">The [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure is used to specify the icon's handle and identifier, and any tooltip text.</span></span> <span data-ttu-id="272df-197">Si l’utilisateur a activé la case à cocher **afficher l’horloge** dans les propriétés de la barre des tâches, le système place l’icône à gauche de l’horloge.</span><span class="sxs-lookup"><span data-stu-id="272df-197">If the user has selected the **Show Clock** check box in the taskbar properties, the system places the icon to the immediate left of the clock.</span></span> <span data-ttu-id="272df-198">Dans le cas contraire, l’icône apparaît sur le côté droit ou en bas de la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-198">Otherwise, the icon appears on the right side or at the bottom of the taskbar.</span></span> <span data-ttu-id="272df-199">Toutes les icônes existantes sont décalées vers la gauche pour faire de la place pour la nouvelle icône.</span><span class="sxs-lookup"><span data-stu-id="272df-199">Any existing icons are shifted to the left to make room for the new icon.</span></span>
-   <span data-ttu-id="272df-200">Pour modifier les informations d’une icône, y compris son handle d’icône, le texte d’info-bulle et l’identificateur du message de rappel, appelez la fonction [**\_ NotifyIcon de l’interpréteur**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) de commandes avec *dwMessage* défini sur NIM \_ modifier.</span><span class="sxs-lookup"><span data-stu-id="272df-200">To modify an icon's information, including its icon handle, tooltip text, and callback message identifier, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_MODIFY.</span></span>
-   <span data-ttu-id="272df-201">Pour supprimer une icône de la zone de notification, appelez la fonction NotifyIcon de l' [**interpréteur \_**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) de commandes avec le paramètre *dwMessage* défini sur NIM \_ Delete.</span><span class="sxs-lookup"><span data-stu-id="272df-201">To delete an icon from the notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_DELETE.</span></span>

<span data-ttu-id="272df-202">Lorsque vous avez terminé une opération d’interface utilisateur, retournez le focus à la zone de notification en appelant [**\_ NotifyIcon Shell**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) avec *dwMessage* défini sur NIM \_ SetFocus.</span><span class="sxs-lookup"><span data-stu-id="272df-202">When you have completed a user interface operation, return focus to the notification area by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_SETFOCUS.</span></span> <span data-ttu-id="272df-203">Par exemple, vous pouvez le faire quand une icône de la barre des tâches affiche un menu contextuel, mais que l’utilisateur l’annule en appuyant sur la touche ÉCHAP.</span><span class="sxs-lookup"><span data-stu-id="272df-203">For example, you could do this when a taskbar icon displays a shortcut menu, but the user cancels it by pressing the ESCAPE key.</span></span>

### <a name="receiving-notification-area-callback-messages"></a><span data-ttu-id="272df-204">Réception des messages de rappel de la zone de notification</span><span class="sxs-lookup"><span data-stu-id="272df-204">Receiving Notification Area Callback Messages</span></span>

<span data-ttu-id="272df-205">Les applications placent généralement des icônes dans la zone de notification de la barre des tâches pour servir d’indicateurs d’État.</span><span class="sxs-lookup"><span data-stu-id="272df-205">Applications commonly put icons in the notification area of the taskbar to serve as status indicators.</span></span> <span data-ttu-id="272df-206">Vous pouvez fournir des informations supplémentaires lorsque l’utilisateur effectue des actions de la souris, par exemple en déplaçant le pointeur de la souris sur l’icône ou en cliquant sur l’icône.</span><span class="sxs-lookup"><span data-stu-id="272df-206">You can provide additional information when the user performs mouse actions, such as moving the mouse pointer over the icon or clicking the icon.</span></span>

<span data-ttu-id="272df-207">Le système vous avertit des événements de souris et de clavier en envoyant un message de rappel défini par l’application qui est associé à une icône particulière.</span><span class="sxs-lookup"><span data-stu-id="272df-207">The system notifies you of mouse and keyboard events by sending an application-defined callback message that is associated with a particular icon.</span></span> <span data-ttu-id="272df-208">De cette façon, le système peut notifier une application lorsque l’utilisateur, par exemple, clique sur l’icône ou la sélectionne en appuyant sur une touche.</span><span class="sxs-lookup"><span data-stu-id="272df-208">In this way, the system can notify an application when the user, for instance, clicks the icon or selects it by pressing a key.</span></span>

<span data-ttu-id="272df-209">Vous définissez le message de rappel d’une icône lorsque vous ajoutez l’icône à la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-209">You define an icon's callback message when you add the icon to the taskbar.</span></span> <span data-ttu-id="272df-210">L’identificateur du message de rappel est spécifié dans le membre **uCallbackMessage** de la structure [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) passée avec NIM \_ Add.</span><span class="sxs-lookup"><span data-stu-id="272df-210">The callback message identifier is specified in the **uCallbackMessage** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure passed with NIM\_ADD.</span></span> <span data-ttu-id="272df-211">Lorsqu’un événement se produit, le système envoie le message de rappel à la procédure de fenêtre de la fenêtre spécifiée par le membre **HWND** .</span><span class="sxs-lookup"><span data-stu-id="272df-211">When an event occurs, the system sends the callback message to the window procedure of the window specified by the **hWnd** member.</span></span> <span data-ttu-id="272df-212">Le paramètre *wParam* du message contient l’identificateur de l’icône de la barre des tâches dans laquelle l’événement s’est produit.</span><span class="sxs-lookup"><span data-stu-id="272df-212">The *wParam* parameter of the message contains the identifier of the taskbar icon in which the event occurred.</span></span> <span data-ttu-id="272df-213">Le paramètre *lParam* contient le message de souris ou de clavier associé à l’événement.</span><span class="sxs-lookup"><span data-stu-id="272df-213">The *lParam* parameter holds the mouse or keyboard message associated with the event.</span></span> <span data-ttu-id="272df-214">Par exemple, lorsque le pointeur de la souris se déplace sur une icône de barre des tâches, *lParam* contient [**WM \_ MOUSEMOVE**](../inputdev/wm-mousemove.md).</span><span class="sxs-lookup"><span data-stu-id="272df-214">For example, when the mouse pointer moves onto a taskbar icon, *lParam* contains [**WM\_MOUSEMOVE**](../inputdev/wm-mousemove.md).</span></span>

<span data-ttu-id="272df-215">Les résultats de divers événements de souris peuvent être résumés comme suit :</span><span class="sxs-lookup"><span data-stu-id="272df-215">The results of various mouse events can be summarized as follows:</span></span>

-   <span data-ttu-id="272df-216">Lorsque l’utilisateur déplace le pointeur de la souris sur l’icône, le système affiche le texte d’info-bulle qui a été spécifié dans [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span><span class="sxs-lookup"><span data-stu-id="272df-216">When the user moves the mouse pointer over the icon, the system displays the tooltip text that was specified in [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span></span>
-   <span data-ttu-id="272df-217">Quand l’utilisateur clique sur l’icône, votre application reçoit une notification [**WM \_ LBUTTONDOWN**](../inputdev/wm-lbuttondown.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-217">When the user clicks the icon, your application receives a [**WM\_LBUTTONDOWN**](../inputdev/wm-lbuttondown.md) notification.</span></span>
-   <span data-ttu-id="272df-218">Quand l’utilisateur clique avec le bouton droit sur l’icône, votre application reçoit une notification [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-218">When the user right-clicks the icon, your application receives a [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) notification.</span></span>
-   <span data-ttu-id="272df-219">Lorsque l’utilisateur double-clique sur l’icône, votre application reçoit une notification [**WM \_ LBUTTONDBLCLK**](../inputdev/wm-lbuttondblclk.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-219">When the user double-clicks the icon, your application receives a [**WM\_LBUTTONDBLCLK**](../inputdev/wm-lbuttondblclk.md) notification.</span></span>

<span data-ttu-id="272df-220">En règle générale, si vous cliquez sur l’icône, l’application affiche une fenêtre contenant des informations supplémentaires, clique avec le bouton droit sur affiche un menu contextuel, puis double-clique sur exécute la commande de menu contextuel par défaut.</span><span class="sxs-lookup"><span data-stu-id="272df-220">Typically, clicking the icon causes the application to display a window with additional information, right-clicking displays a shortcut menu, and double-clicking executes the default shortcut menu command.</span></span>

<span data-ttu-id="272df-221">Pour obtenir un exemple de modification du texte info-bulle associé à une icône de zone de notification, consultez [info-bulles Info-bulles pour les icônes de barre d’État](../controls/tooltip-controls.md).</span><span class="sxs-lookup"><span data-stu-id="272df-221">For an example of how to change the tooltip text associated with a notification area icon, see [Balloon Tooltips for Status Bar Icons](../controls/tooltip-controls.md).</span></span>

<span data-ttu-id="272df-222">Les versions 5,0 et ultérieures de l’interpréteur de commandes gèrent les événements de souris et de clavier de l' [**interpréteur \_**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) de commandes de manière différente des versions antérieures du shell qui se trouvaient sur Windows NT 4,0, Windows 95 et Windows 98.</span><span class="sxs-lookup"><span data-stu-id="272df-222">Versions 5.0 and later of the Shell handle [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) mouse and keyboard events in different ways than earlier Shell versions found on Windows NT 4.0, Windows 95, and Windows 98.</span></span> <span data-ttu-id="272df-223">Les différences sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="272df-223">The differences are as follows:</span></span>

-   <span data-ttu-id="272df-224">Si un utilisateur demande le menu contextuel d’une icône de notification avec le clavier, la version 5,0 Shell envoie l’application associée à un message [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-224">If a user requests a notify icon's shortcut menu with the keyboard, the version 5.0 Shell sends the associated application a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message.</span></span> <span data-ttu-id="272df-225">Les versions antérieures envoient les messages [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) et [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-225">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="272df-226">Si un utilisateur sélectionne une icône de notification avec le clavier et l’active avec la barre d’espace ou la touche entrée, le shell version 5,0 envoie à l’application associée une notification **nDans \_ keyselect** .</span><span class="sxs-lookup"><span data-stu-id="272df-226">If a user selects a notify icon with the keyboard and activates it with the space bar or ENTER key, the version 5.0 Shell sends the associated application an **NIN\_KEYSELECT** notification.</span></span> <span data-ttu-id="272df-227">Les versions antérieures envoient les messages [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) et [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-227">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="272df-228">Si un utilisateur sélectionne une icône Notify avec la souris et l’active avec la touche entrée, le shell version 5,0 envoie à l’application associée une **notification \_ Select nDans** .</span><span class="sxs-lookup"><span data-stu-id="272df-228">If a user selects a notify icon with the mouse and activates it with the ENTER key, the version 5.0 Shell sends the associated application an **NIN\_SELECT** notification.</span></span> <span data-ttu-id="272df-229">Les versions antérieures envoient les messages [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) et [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="272df-229">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="272df-230">Si un utilisateur passe le pointeur de la souris sur une icône à laquelle une info-bulle est associée, le shell version 6,0 (Windows XP) envoie les messages suivants.</span><span class="sxs-lookup"><span data-stu-id="272df-230">If a user passes the mouse pointer over an icon with which a balloon tooltip is associated, the version 6.0 Shell (Windows XP)sends the following messages.</span></span>
    -   -   <span data-ttu-id="272df-231">**NDans \_ BALLOONSHOW** : envoyé lorsque la bulle est affichée (les bulles sont mises en file d’attente).</span><span class="sxs-lookup"><span data-stu-id="272df-231">**NIN\_BALLOONSHOW** - Sent when the balloon is shown (balloons are queued).</span></span>
        -   <span data-ttu-id="272df-232">**NDans \_ BALLOONHIDE** : envoyé lorsque l’info-bulle disparaît, par exemple lorsque l’icône est supprimée.</span><span class="sxs-lookup"><span data-stu-id="272df-232">**NIN\_BALLOONHIDE** - Sent when the balloon disappears—for example, when the icon is deleted.</span></span> <span data-ttu-id="272df-233">Ce message n’est pas envoyé si la bulle est fermée en raison d’un délai d’attente ou d’un clic de souris.</span><span class="sxs-lookup"><span data-stu-id="272df-233">This message is not sent if the balloon is dismissed because of a timeout or a mouse click.</span></span>
        -   <span data-ttu-id="272df-234">**NDans \_ BALLOONTIMEOUT** : envoyé lorsque l’info-bulle est fermée en raison d’un dépassement de délai.</span><span class="sxs-lookup"><span data-stu-id="272df-234">**NIN\_BALLOONTIMEOUT** - Sent when the balloon is dismissed because of a timeout.</span></span>
        -   <span data-ttu-id="272df-235">**NDans \_ BALLOONUSERCLICK** : envoyé lorsque l’info-bulle est fermée en raison d’un clic de souris.</span><span class="sxs-lookup"><span data-stu-id="272df-235">**NIN\_BALLOONUSERCLICK** - Sent when the balloon is dismissed because of a mouse click.</span></span>

<span data-ttu-id="272df-236">Vous pouvez sélectionner la façon dont l’interpréteur de commandes doit se comporter en appelant [**\_ NotifyIcon Shell**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) avec *dwMessage* défini sur **NIM \_ SETVERSION**.</span><span class="sxs-lookup"><span data-stu-id="272df-236">You can select which way the Shell should behave by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_SETVERSION**.</span></span> <span data-ttu-id="272df-237">Définissez le membre **uVersion** de la structure [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) pour indiquer si vous souhaitez une version 5,0 ou une version antérieure de 5,0.</span><span class="sxs-lookup"><span data-stu-id="272df-237">Set the **uVersion** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure to indicate whether you want version 5.0 or pre-version 5.0 behavior.</span></span>

### <a name="taskbar-creation-notification"></a><span data-ttu-id="272df-238">Notification de création de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-238">Taskbar Creation Notification</span></span>

<span data-ttu-id="272df-239">Avec Microsoft Internet Explorer 4,0 et versions ultérieures, l’interpréteur de commandes avertit les applications que la barre des tâches a été créée.</span><span class="sxs-lookup"><span data-stu-id="272df-239">With Microsoft Internet Explorer 4.0 and later, the Shell notifies applications that the taskbar has been created.</span></span> <span data-ttu-id="272df-240">Lorsque la barre des tâches est créée, elle enregistre un message avec la chaîne TaskbarCreated, puis diffuse ce message à toutes les fenêtres de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="272df-240">When the taskbar is created, it registers a message with the TaskbarCreated string and then broadcasts this message to all top-level windows.</span></span> <span data-ttu-id="272df-241">Lorsque votre application de barre des tâches reçoit ce message, elle doit supposer que toutes les icônes de la barre des tâches qu’elle a ajoutées ont été supprimées et les rajouter.</span><span class="sxs-lookup"><span data-stu-id="272df-241">When your taskbar application receives this message, it should assume that any taskbar icons it added have been removed and add them again.</span></span> <span data-ttu-id="272df-242">Cette fonctionnalité s’applique généralement uniquement aux services qui sont déjà en cours d’exécution au lancement de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="272df-242">This feature generally applies only to services that are already running when the Shell launches.</span></span> <span data-ttu-id="272df-243">L’exemple suivant montre une méthode très simplifiée pour gérer ce cas.</span><span class="sxs-lookup"><span data-stu-id="272df-243">The following example shows a very simplified method for handling this case.</span></span>

<span data-ttu-id="272df-244">Sur Windows 10, la barre des tâches diffuse également ce message lorsque la résolution de l’affichage principal change.</span><span class="sxs-lookup"><span data-stu-id="272df-244">On Windows 10, the taskbar also broadcasts this message when the DPI of the primary display changes.</span></span>

```
LRESULT CALLBACK WndProc(HWND hWnd, 
                         UINT uMessage, 
                         WPARAM wParam, 
                         LPARAM lParam)
{
    static UINT s_uTaskbarRestart;

    switch(uMessage)
    {
        case WM_CREATE:
            s_uTaskbarRestart = RegisterWindowMessage(TEXT("TaskbarCreated"));
            break;
        
        default:
            if(uMessage == s_uTaskbarRestart)
                AddTaskbarIcons();
            break;
    }

    return DefWindowProc(hWnd, uMessage, wParam, lParam);
}
```



## <a name="using-the-taskbar"></a><span data-ttu-id="272df-245">Utilisation de la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="272df-245">Using the Taskbar</span></span>

<span data-ttu-id="272df-246">Cette section contient des exemples qui montrent comment ajouter des icônes à la zone de notification de la barre des tâches et comment traiter les messages de rappel pour les icônes de la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-246">This section includes examples that demonstrate how to add icons to the taskbar notification area and how to process callback messages for taskbar icons.</span></span>

### <a name="adding-and-deleting-taskbar-icons-in-the-notification-area"></a><span data-ttu-id="272df-247">Ajout et suppression d’icônes de la barre des tâches dans la zone de notification</span><span class="sxs-lookup"><span data-stu-id="272df-247">Adding and Deleting Taskbar Icons in the Notification Area</span></span>

<span data-ttu-id="272df-248">Vous ajoutez une icône à la zone de notification de la barre des tâches en remplissant une structure [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) , puis en passant la structure à l' [**interface \_ NotifyIcon de l’interpréteur**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) de commandes avec *dwMessage* défini sur **NIM \_ Add**.</span><span class="sxs-lookup"><span data-stu-id="272df-248">You add an icon to the taskbar notification area by filling in a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and then passing the structure to [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_ADD**.</span></span> <span data-ttu-id="272df-249">Les membres de structure doivent spécifier le handle de la fenêtre qui ajoute l’icône, ainsi que l’identificateur d’icône et le handle d’icône.</span><span class="sxs-lookup"><span data-stu-id="272df-249">The structure members must specify the handle to the window that is adding the icon, as well as the icon identifier and icon handle.</span></span> <span data-ttu-id="272df-250">Vous pouvez également spécifier le texte info-bulle pour l’icône.</span><span class="sxs-lookup"><span data-stu-id="272df-250">You can also specify tooltip text for the icon.</span></span> <span data-ttu-id="272df-251">Si vous avez besoin de recevoir des messages de souris pour l’icône, spécifiez l’identificateur du message de rappel que le système doit utiliser pour envoyer le message à la procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="272df-251">If you need to receive mouse messages for the icon, specify the identifier of the callback message that the system should use to send the message to the window procedure.</span></span>

<span data-ttu-id="272df-252">La fonction de l’exemple suivant montre comment ajouter une icône à la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-252">The function in the following example demonstrates how to add an icon to the taskbar.</span></span>


```
// MyTaskBarAddIcon - adds an icon to the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window to receive callback messages 
// uID - identifier of the icon 
// hicon - handle to the icon to add 
// lpszTip - tooltip text 

BOOL MyTaskBarAddIcon(HWND hwnd, UINT uID, HICON hicon, LPSTR lpszTip) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
    tnid.uFlags = NIF_MESSAGE | NIF_ICON | NIF_TIP; 
    tnid.uCallbackMessage = MYWM_NOTIFYICON; 
    tnid.hIcon = hicon; 
    if (lpszTip) 
        hr = StringCbCopyN(tnid.szTip, sizeof(tnid.szTip), lpszTip, 
                           sizeof(tnid.szTip));
        // TODO: Add error handling for the HRESULT.
    else 
        tnid.szTip[0] = (TCHAR)'\0'; 
 
    res = Shell_NotifyIcon(NIM_ADD, &tnid); 
 
    if (hicon) 
        DestroyIcon(hicon); 
 
    return res; 
}
```



<span data-ttu-id="272df-253">Pour supprimer une icône de la zone de notification de la barre des tâches, remplissez une structure [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) et appelez l' [**interface \_ NotifyIcon Shell**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) avec *dwMessage* défini sur **NIM \_ Delete**.</span><span class="sxs-lookup"><span data-stu-id="272df-253">To delete an icon from the taskbar notification area, fill a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_DELETE**.</span></span> <span data-ttu-id="272df-254">Lorsque vous supprimez une icône de barre des tâches, spécifiez uniquement les membres **cbSize**, **HWND** et **uID** de la structure.</span><span class="sxs-lookup"><span data-stu-id="272df-254">When deleting a taskbar icon, specify only the **cbSize**, **hWnd**, and **uID** members of the structure.</span></span> <span data-ttu-id="272df-255">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="272df-255">For example:</span></span>


```
// MyTaskBarDeleteIcon - deletes an icon from the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window that added the icon. 
// uID - identifier of the icon to delete. 

BOOL MyTaskBarDeleteIcon(HWND hwnd, UINT uID) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
         
    res = Shell_NotifyIcon(NIM_DELETE, &tnid); 
    return res; 
}
```



### <a name="receiving-mouse-events"></a><span data-ttu-id="272df-256">Réception d’événements de souris</span><span class="sxs-lookup"><span data-stu-id="272df-256">Receiving Mouse Events</span></span>

<span data-ttu-id="272df-257">Si vous spécifiez un message de rappel pour une icône de barre des tâches, le système envoie le message à votre application chaque fois qu’un événement de souris se produit dans le rectangle englobant de l’icône.</span><span class="sxs-lookup"><span data-stu-id="272df-257">If you specify a callback message for a taskbar icon, the system sends the message to your application whenever a mouse event occurs in the icon's bounding rectangle.</span></span> <span data-ttu-id="272df-258">Le paramètre *wParam* du message spécifie l’identificateur de l’icône de la barre des tâches, et le paramètre *lParam* du message spécifie le message généré par le système à la suite de l’événement de souris.</span><span class="sxs-lookup"><span data-stu-id="272df-258">The *wParam* parameter of the message specifies the identifier of the taskbar icon, and the *lParam* parameter of the message specifies the message that the system generated as a result of the mouse event.</span></span>

<span data-ttu-id="272df-259">La fonction de l’exemple suivant provient d’une application qui ajoute les icônes de batterie et d’imprimante à la barre des tâches.</span><span class="sxs-lookup"><span data-stu-id="272df-259">The function in the following example is from an application that adds both battery and printer icons to the taskbar.</span></span> <span data-ttu-id="272df-260">L’application appelle la fonction lorsqu’elle reçoit un message de rappel.</span><span class="sxs-lookup"><span data-stu-id="272df-260">The application calls the function when it receives a callback message.</span></span> <span data-ttu-id="272df-261">La fonction détermine si l’utilisateur a cliqué sur l’une des icônes et, si un clic s’est produit, appelle une fonction définie par l’application pour afficher les informations d’État.</span><span class="sxs-lookup"><span data-stu-id="272df-261">The function determines whether the user has clicked one of the icons and, if a click has occurred, calls an application-defined function to display status information.</span></span>


```
// On_MYWM_NOTIFYICON - processes callback messages for taskbar icons. 
// wParam - first message parameter of the callback message. 
// lParam - second message parameter of the callback message. 

void On_MYWM_NOTIFYICON(WPARAM wParam, LPARAM lParam) 
{ 
    UINT uID; 
    UINT uMouseMsg; 
 
    uID = (UINT) wParam; 
    uMouseMsg = (UINT) lParam; 
 
    if (uMouseMsg == WM_LBUTTONDOWN) 
    { 
        switch (uID) 
        { 
            case IDI_MYBATTERYICON: 
 
                // The user clicked the battery icon. Display the 
                // battery status. 
                ShowBatteryStatus(); 
                break; 
 
            case IDI_MYPRINTERICON: 
 
                // The user clicked the printer icon. Display the 
                // status of the print job. 
                ShowJobStatus(); 
                break; 
 
            default: 
                break; 
        } 
     } 

     return; 
 }
```



 

 
