---
description: Pour permettre à votre application de fonctionner avec le gestionnaire de synchronisation, vous devez implémenter un objet COM (Component Object Model) pour gérer les notifications de synchronisation que vous recevez de SyncMgr.
title: Utilisation du gestionnaire de synchronisation à partir d’un programme
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bf18d493-0fe7-46e7-9686-f7ee75b3039b
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 9bd5abdc382c82c6c1aafcda3a967337384dc807
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104530177"
---
# <a name="using-synchronization-manager-from-a-program"></a><span data-ttu-id="8ff41-103">Utilisation du gestionnaire de synchronisation à partir d’un programme</span><span class="sxs-lookup"><span data-stu-id="8ff41-103">Using Synchronization Manager from a Program</span></span>

<span data-ttu-id="8ff41-104">Pour permettre à votre application de fonctionner avec le gestionnaire de synchronisation, vous devez implémenter un objet COM (Component Object Model) pour gérer les notifications de synchronisation que vous recevez de SyncMgr.</span><span class="sxs-lookup"><span data-stu-id="8ff41-104">To enable your application to work with the Synchronization Manager you must implement a Component Object Model (COM) object to handle synchronization notifications that you receive from SyncMgr.</span></span> <span data-ttu-id="8ff41-105">Le gestionnaire de votre application effectue la synchronisation pour les éléments que vous gérez.</span><span class="sxs-lookup"><span data-stu-id="8ff41-105">Your application's handler performs the synchronization for the items that you handle.</span></span> <span data-ttu-id="8ff41-106">Inclus dans votre gestionnaire, vous devez implémenter l’interface [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) .</span><span class="sxs-lookup"><span data-stu-id="8ff41-106">Included in your handler, you must implement the [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) interface.</span></span> <span data-ttu-id="8ff41-107">En outre, vous devez fournir un objet énumérateur et [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) pour tous les éléments séparés que votre application peut synchroniser.</span><span class="sxs-lookup"><span data-stu-id="8ff41-107">Also, you must provide an enumerator object and [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) for any separate items that your application can synchronize.</span></span>

<span data-ttu-id="8ff41-108">SyncMgr implémente [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) et [**ISyncMgrSynchronizeInvoke**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronizeinvoke).</span><span class="sxs-lookup"><span data-stu-id="8ff41-108">SyncMgr implements [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) and [**ISyncMgrSynchronizeInvoke**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronizeinvoke).</span></span>

<span data-ttu-id="8ff41-109">SyncMgr appelle les méthodes de votre [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) pour obtenir des informations sur les éléments que votre application gère et les informations sur le gestionnaire que vous fournissez pour synchroniser ces éléments.</span><span class="sxs-lookup"><span data-stu-id="8ff41-109">The SyncMgr calls methods in your [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) to get information on the items that your application handles and information on the handler that you provide for synchronizing these items.</span></span>

<span data-ttu-id="8ff41-110">Au moment de l’exécution, le processus de synchronisation suit ces étapes.</span><span class="sxs-lookup"><span data-stu-id="8ff41-110">At runtime, the synchronization process follows these steps.</span></span>

1.  <span data-ttu-id="8ff41-111">SyncMgr informe votre application qu’il est temps que la synchronisation se produise pour l’un des éléments que votre application gère en appelant votre méthode [**ISyncMgrSynchronize :: Initialize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-initialize) .</span><span class="sxs-lookup"><span data-stu-id="8ff41-111">SyncMgr notifies your application that it is time for synchronization to occur for one of the items that your application handles by calling your [**ISyncMgrSynchronize::Initialize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-initialize) method.</span></span>
2.  <span data-ttu-id="8ff41-112">SyncMgr appelle [**ISyncMgrSynchronize :: EnumSyncMgrItems**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-enumsyncmgritems) pour obtenir l’interface [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) pour les éléments gérés par votre application.</span><span class="sxs-lookup"><span data-stu-id="8ff41-112">SyncMgr calls [**ISyncMgrSynchronize::EnumSyncMgrItems**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-enumsyncmgritems) to obtain the [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) interface for the items handled by your application.</span></span>
3.  <span data-ttu-id="8ff41-113">SyncMgr appelle [**ISyncMgrSynchronize :: SetProgressCallback**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-setprogresscallback) pour fournir votre gestionnaire avec le pointeur d’interface pour l’interface [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) .</span><span class="sxs-lookup"><span data-stu-id="8ff41-113">SyncMgr calls [**ISyncMgrSynchronize::SetProgressCallback**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-setprogresscallback) to provide your handler with the interface pointer for the [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) interface.</span></span> <span data-ttu-id="8ff41-114">Votre gestionnaire utilise cette interface pour rappeler le SyncMgr pendant la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="8ff41-114">Your handler uses this interface to call back to the SyncMgr during synchronization.</span></span>
4.  <span data-ttu-id="8ff41-115">SyncMgr appelle ensuite votre méthode [**ISyncMgrSynchronize ::P repareforsync**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-prepareforsync) pour permettre à votre gestionnaire d’afficher n’importe quel élément d’interface utilisateur nécessaire avant le début de la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="8ff41-115">SyncMgr then calls your [**ISyncMgrSynchronize::PrepareForSync**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-prepareforsync) method to give your handler a chance to display any user interface element that is necessary before synchronization begins.</span></span> <span data-ttu-id="8ff41-116">Par exemple, une application de messagerie peut afficher une boîte de dialogue d’ouverture de session utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8ff41-116">For example, an email application may display a user logon dialog.</span></span>
5.  <span data-ttu-id="8ff41-117">Votre gestionnaire appelle [**ISyncMgrSynchronizeCallback :: EnableModeless**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-enablemodeless) avant et après l’affichage des éléments d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8ff41-117">Your handler calls [**ISyncMgrSynchronizeCallback::EnableModeless**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-enablemodeless) before and after displaying any user interface elements.</span></span> <span data-ttu-id="8ff41-118">Votre gestionnaire appelle [**ISyncMgrSynchronizeCallback ::P repareforsynccompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-prepareforsynccompleted) lorsque vous avez terminé.</span><span class="sxs-lookup"><span data-stu-id="8ff41-118">Your handler calls [**ISyncMgrSynchronizeCallback::PrepareForSyncCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-prepareforsynccompleted) when you are done.</span></span>
6.  <span data-ttu-id="8ff41-119">SyncMgr appelle votre méthode [**ISyncMgrSynchronize :: Synchronize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-synchronize) pour démarrer la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="8ff41-119">SyncMgr calls your [**ISyncMgrSynchronize::Synchronize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-synchronize) method to start the synchronization.</span></span>

<span data-ttu-id="8ff41-120">Pendant le processus de synchronisation, SyncMgr continue d’appeler des méthodes dans votre interface [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) .</span><span class="sxs-lookup"><span data-stu-id="8ff41-120">During the synchronization process, SyncMgr continues to call methods in your [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) interface.</span></span> <span data-ttu-id="8ff41-121">Il peut envoyer vos erreurs de gestionnaire, la progression et les notifications.</span><span class="sxs-lookup"><span data-stu-id="8ff41-121">It can send your handler errors, progress, and notifications.</span></span> <span data-ttu-id="8ff41-122">Il peut également énumérer les éléments que votre application gère ou autoriser votre application à afficher les propriétés des éléments.</span><span class="sxs-lookup"><span data-stu-id="8ff41-122">It can also enumerate through the items that your application handles or allow your application to show properties for the items.</span></span>

<span data-ttu-id="8ff41-123">Votre gestionnaire appelle des méthodes dans [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) pour déterminer si un élément doit être ignoré, pour consigner les erreurs et pour poster des informations de progression pendant le processus de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="8ff41-123">Your handler calls methods in [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) to determine if an item should be skipped, to log errors, and to post progress information during the synchronization process.</span></span>

<span data-ttu-id="8ff41-124">Pour plus d’informations, consultez les pages de référence associées pour les interfaces impliquées.</span><span class="sxs-lookup"><span data-stu-id="8ff41-124">For further information, see the related reference pages for the interfaces involved.</span></span>

<span data-ttu-id="8ff41-125">Une fois la synchronisation terminée, votre gestionnaire appelle [**ISyncMgrSynchronizeCallback :: SynchronizeCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-synchronizecompleted).</span><span class="sxs-lookup"><span data-stu-id="8ff41-125">When the synchronization is completed, your handler calls [**ISyncMgrSynchronizeCallback::SynchronizeCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-synchronizecompleted).</span></span>

 

 



