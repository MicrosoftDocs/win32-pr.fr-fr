---
description: L’aide en ligne peut se présenter sous différentes formes, des informations conceptuelles détaillées aux définitions rapides. Cette rubrique contient les sections suivantes.
title: Gestion de l’aide en ligne
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 2a3f6034-6ba6-4204-a2e1-59995fbf40fe
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: f1c125df135068c2eee37cb33a8a9d2b281b1f83
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991572"
---
# <a name="handling-online-help"></a><span data-ttu-id="ae04a-104">Gestion de l’aide en ligne</span><span class="sxs-lookup"><span data-stu-id="ae04a-104">Handling Online Help</span></span>

<span data-ttu-id="ae04a-105">L’aide en ligne peut se présenter sous différentes formes, des informations conceptuelles détaillées aux définitions rapides.</span><span class="sxs-lookup"><span data-stu-id="ae04a-105">Online help can come in a variety of forms, from detailed conceptual information to quick definitions.</span></span> <span data-ttu-id="ae04a-106">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="ae04a-106">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="ae04a-107">À propos de l’aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-107">About Help</span></span>](#about-help)
    -   [<span data-ttu-id="ae04a-108">Demandes d’aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-108">Help Requests</span></span>](#help-requests)
    -   [<span data-ttu-id="ae04a-109">Affichage de l’aide et aide de Windows</span><span class="sxs-lookup"><span data-stu-id="ae04a-109">Help Display and Windows Help</span></span>](#help-display-and-windows-help)
-   [<span data-ttu-id="ae04a-110">Utilisation de l’aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-110">Using Help</span></span>](#using-help)
    -   [<span data-ttu-id="ae04a-111">Fournir de l’aide dans une boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="ae04a-111">Providing Help in a Dialog Box</span></span>](#providing-help-in-a-dialog-box)
    -   [<span data-ttu-id="ae04a-112">Définition de l’apparence d’une fenêtre d’aide secondaire</span><span class="sxs-lookup"><span data-stu-id="ae04a-112">Setting the Appearance of a Secondary Help Window</span></span>](#setting-the-appearance-of-a-secondary-help-window)

## <a name="about-help"></a><span data-ttu-id="ae04a-113">À propos de l’aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-113">About Help</span></span>

<span data-ttu-id="ae04a-114">Un élément important d’une application conviviale est facilement disponible dans l’aide en ligne.</span><span class="sxs-lookup"><span data-stu-id="ae04a-114">An important element of a user-friendly application is readily available in online help.</span></span> <span data-ttu-id="ae04a-115">Windows fournit des fonctions et des messages qui, lorsqu’ils sont utilisés conjointement avec l’application d’aide Windows, facilitent l’implémentation de l’aide en ligne dans votre application.</span><span class="sxs-lookup"><span data-stu-id="ae04a-115">Windows provides functions and messages that, when used in conjunction with the Windows Help application, make it easy to implement online help in your application.</span></span> <span data-ttu-id="ae04a-116">Cette vue d’ensemble décrit les éléments de Windows qui prennent en charge l’aide en ligne.</span><span class="sxs-lookup"><span data-stu-id="ae04a-116">This overview discusses the elements of Windows that support online help.</span></span> <span data-ttu-id="ae04a-117">Il décrit comment utiliser ces éléments pour offrir aux utilisateurs un moyen de demander de l’aide, et il explique comment utiliser l’application d’aide Windows pour afficher de l’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-117">It describes how to use these elements to give users a means to request help, and it explains how to use the Windows Help application to display help.</span></span>

### <a name="help-requests"></a><span data-ttu-id="ae04a-118">Demandes d’aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-118">Help Requests</span></span>

<span data-ttu-id="ae04a-119">La plupart des applications basées sur Windows fournissent des informations d’aide en ligne sous différentes formes, à partir d’une aide conceptuelle qui explique l’objectif des fonctionnalités d’une application à l’aide contextuelle qui fournit des définitions rapides d’éléments individuels dans l’interface utilisateur de l’application.</span><span class="sxs-lookup"><span data-stu-id="ae04a-119">Most Windows-based applications provide online help information in a variety of forms, ranging from conceptual help that explains the purpose of an application's features to pop-up help that provides quick definitions of individual elements in the application's user interface.</span></span> <span data-ttu-id="ae04a-120">Vous utilisez des fonctions et des messages pour fournir aux utilisateurs plusieurs moyens de demander l’accès à ces informations.</span><span class="sxs-lookup"><span data-stu-id="ae04a-120">You use functions and messages to give users a variety of ways to request access to this information.</span></span> <span data-ttu-id="ae04a-121">Les sections suivantes décrivent ces demandes d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-121">The following sections describe these help requests.</span></span>

### <a name="help-menu"></a><span data-ttu-id="ae04a-122">Menu aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-122">Help menu</span></span>

<span data-ttu-id="ae04a-123">La plupart des applications fournissent un accès utilisateur aux informations d’aide en incluant un menu **aide** dans la fenêtre principale.</span><span class="sxs-lookup"><span data-stu-id="ae04a-123">Most applications provide user access to help information by including a **Help** menu in the main window.</span></span> <span data-ttu-id="ae04a-124">Lorsque l’utilisateur sélectionne un élément dans un menu **aide** , la procédure de fenêtre correspondante reçoit un message de [**\_ commande WM**](../menurc/wm-command.md) qui identifie l’élément sélectionné.</span><span class="sxs-lookup"><span data-stu-id="ae04a-124">When the user selects an item from a **Help** menu, the corresponding window procedure receives a [**WM\_COMMAND**](../menurc/wm-command.md) message that identifies the selected item.</span></span> <span data-ttu-id="ae04a-125">L’application répond en affichant les informations d’aide appropriées, telles qu’une liste de rubriques d’aide, un index ou une introduction à l’application.</span><span class="sxs-lookup"><span data-stu-id="ae04a-125">The application responds by displaying the appropriate help information, such as a list of help topics, an index, or an introduction to the application.</span></span>

### <a name="help-from-the-keyboard"></a><span data-ttu-id="ae04a-126">Aide à partir du clavier</span><span class="sxs-lookup"><span data-stu-id="ae04a-126">Help from the keyboard</span></span>

<span data-ttu-id="ae04a-127">Windows permet à l’utilisateur d’accéder à des informations d’aide à partir du clavier en avertissant l’application chaque fois que l’utilisateur appuie sur la touche F1.</span><span class="sxs-lookup"><span data-stu-id="ae04a-127">Windows provides user access to help information from the keyboard by notifying the application whenever the user presses the F1 key.</span></span> <span data-ttu-id="ae04a-128">Le système envoie un message d' [**\_ aide WM**](wm-help.md) à la fenêtre qui avait le focus clavier lorsque l’utilisateur a appuyé sur la touche.</span><span class="sxs-lookup"><span data-stu-id="ae04a-128">The system sends a [**WM\_HELP**](wm-help.md) message to the window that had the keyboard focus when the user pressed the key.</span></span> <span data-ttu-id="ae04a-129">Si la fenêtre est une fenêtre enfant (par exemple, un contrôle dans une boîte de dialogue), la fonction [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) passe le message à la fenêtre parente.</span><span class="sxs-lookup"><span data-stu-id="ae04a-129">If the window is a child window (for example, a control in a dialog box), the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function passes the message to the parent window.</span></span> <span data-ttu-id="ae04a-130">Si un menu est actif lorsque la touche F1 est enfoncée, le système envoie le message à la fenêtre associée au menu.</span><span class="sxs-lookup"><span data-stu-id="ae04a-130">If a menu is active when F1 is pressed, the system sends the message to the window associated with the menu.</span></span> <span data-ttu-id="ae04a-131">L’application répond en affichant des informations d’aide associées à la fenêtre, au contrôle ou au menu qui a le focus ou qui est actif.</span><span class="sxs-lookup"><span data-stu-id="ae04a-131">The application responds by displaying help information associated with the window, control, or menu that has the focus or is active.</span></span> <span data-ttu-id="ae04a-132">Par exemple, si l’utilisateur sélectionne un contrôle dans une boîte de dialogue et appuie sur la touche F1, l’application affiche des informations d’aide pour ce contrôle.</span><span class="sxs-lookup"><span data-stu-id="ae04a-132">For example, if the user selects a control in a dialog box and presses F1, the application displays help information for that control.</span></span>

<span data-ttu-id="ae04a-133">Le paramètre *lParam* de [**l' \_ aide WM**](wm-help.md) est un pointeur vers une structure [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) qui contient des informations détaillées sur l’élément pour lequel l’aide est demandée.</span><span class="sxs-lookup"><span data-stu-id="ae04a-133">The *lParam* parameter of [**WM\_HELP**](wm-help.md) is a pointer to a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that contains detailed information about the item for which help is requested.</span></span> <span data-ttu-id="ae04a-134">Vous utilisez ces informations pour déterminer la rubrique d’aide à afficher.</span><span class="sxs-lookup"><span data-stu-id="ae04a-134">You use this information to determine the help topic to display.</span></span> <span data-ttu-id="ae04a-135">La structure **HELPINFO** comprend également les coordonnées du curseur de la souris au moment où l’utilisateur a appuyé sur la touche.</span><span class="sxs-lookup"><span data-stu-id="ae04a-135">The **HELPINFO** structure also includes the coordinates of the mouse cursor at the time the user pressed the key.</span></span> <span data-ttu-id="ae04a-136">Vous pouvez utiliser ces informations pour fournir de l’aide en fonction de l’emplacement du curseur de la souris.</span><span class="sxs-lookup"><span data-stu-id="ae04a-136">You can use this information to provide help based on the location of the mouse cursor.</span></span>

### <a name="help-from-the-mouse"></a><span data-ttu-id="ae04a-137">Aide à partir de la souris</span><span class="sxs-lookup"><span data-stu-id="ae04a-137">Help from the mouse</span></span>

<span data-ttu-id="ae04a-138">Windows permet à l’utilisateur d’accéder à des informations d’aide à partir de la souris en avertissant l’application chaque fois que l’utilisateur clique sur le bouton droit de la souris ou clique sur une fenêtre, un contrôle ou un menu après avoir cliqué sur le bouton de question ( ?).</span><span class="sxs-lookup"><span data-stu-id="ae04a-138">Windows provides the user access to help information from the mouse by notifying the application whenever the user clicks the right mouse button or clicks a window, control, or menu after clicking the Question (?) button.</span></span> <span data-ttu-id="ae04a-139">L’application répond en affichant des informations d’aide associées à la fenêtre, au contrôle ou au menu donné.</span><span class="sxs-lookup"><span data-stu-id="ae04a-139">The application responds by displaying help information associated with the given window, control, or menu.</span></span>

<span data-ttu-id="ae04a-140">Le système envoie un message [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) lorsque l’utilisateur clique avec le bouton droit de la souris.</span><span class="sxs-lookup"><span data-stu-id="ae04a-140">The system sends a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message when the user clicks the right mouse button.</span></span> <span data-ttu-id="ae04a-141">La fenêtre sur laquelle l’utilisateur a cliqué reçoit le message.</span><span class="sxs-lookup"><span data-stu-id="ae04a-141">The window that was clicked receives the message.</span></span> <span data-ttu-id="ae04a-142">Si la fenêtre est une fenêtre enfant, telle qu’un contrôle, la fonction [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) passe le message à la fenêtre parente.</span><span class="sxs-lookup"><span data-stu-id="ae04a-142">If the window is a child window, such as a control, the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function passes the message to the parent window.</span></span> <span data-ttu-id="ae04a-143">Le message **WM \_ CONTEXTMENU** spécifie les coordonnées du curseur de la souris.</span><span class="sxs-lookup"><span data-stu-id="ae04a-143">The **WM\_CONTEXTMENU** message specifies the coordinates of the mouse cursor.</span></span> <span data-ttu-id="ae04a-144">La coordonnée x se trouve dans le mot de poids faible du paramètre *lParam* , et la coordonnée y est dans le mot de poids fort.</span><span class="sxs-lookup"><span data-stu-id="ae04a-144">The x-coordinate is in the low-order word of the *lParam* parameter, and the y-coordinate is in the high-order word.</span></span> <span data-ttu-id="ae04a-145">Si l’utilisateur clique sur un contrôle, le paramètre *wParam* est le handle du contrôle qui a reçu le clic.</span><span class="sxs-lookup"><span data-stu-id="ae04a-145">If the user clicked a control, the *wParam* parameter is the handle to the control that received the click.</span></span>

<span data-ttu-id="ae04a-146">Le système envoie un [**message \_ d’aide WM**](wm-help.md) quand l’utilisateur clique sur un élément d’une fenêtre après avoir cliqué sur le bouton de question ( ?) qui apparaît dans la barre de titre de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="ae04a-146">The system sends a [**WM\_HELP**](wm-help.md) message when the user clicks an item in a window after clicking the Question (?) button that appears in the title bar of the window.</span></span> <span data-ttu-id="ae04a-147">Vous pouvez ajouter un bouton de question à une barre de titre en spécifiant le style **WS \_ ex \_ CONTEXTHELP** dans la fonction [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) lors de la création de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="ae04a-147">You can add a Question button to a title bar by specifying the **WS\_EX\_CONTEXTHELP** style in the [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) function when creating the window.</span></span> <span data-ttu-id="ae04a-148">Le paramètre *lParam* de **l' \_ aide WM** est un pointeur vers une structure [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) qui contient des informations détaillées sur l’élément pour lequel l’aide est demandée, y compris les coordonnées du curseur de la souris au moment où l’utilisateur clique sur le bouton de la souris.</span><span class="sxs-lookup"><span data-stu-id="ae04a-148">The *lParam* parameter of **WM\_HELP** is a pointer to a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that contains detailed information about the item for which help is requested, including the coordinates of the mouse cursor at the time the user clicked the mouse button.</span></span>

<span data-ttu-id="ae04a-149">Le bouton de question est recommandé pour une utilisation dans les boîtes de dialogue uniquement.</span><span class="sxs-lookup"><span data-stu-id="ae04a-149">The Question button is recommended for use in dialog boxes only.</span></span> <span data-ttu-id="ae04a-150">Auparavant, les applications fournissaient un accès utilisateur aux informations d’aide sur une boîte de dialogue en fournissant un bouton **aide** dans la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="ae04a-150">In the past, applications have provided user access to help information about a dialog box by providing a **Help** button in the dialog box.</span></span> <span data-ttu-id="ae04a-151">Cette méthode n’est plus recommandée.</span><span class="sxs-lookup"><span data-stu-id="ae04a-151">This method is no longer recommended.</span></span> <span data-ttu-id="ae04a-152">Utilisez le bouton de question à la place.</span><span class="sxs-lookup"><span data-stu-id="ae04a-152">Use the Question button instead.</span></span>

### <a name="help-display-and-windows-help"></a><span data-ttu-id="ae04a-153">Affichage de l’aide et aide de Windows</span><span class="sxs-lookup"><span data-stu-id="ae04a-153">Help Display and Windows Help</span></span>

<span data-ttu-id="ae04a-154">Une fois qu’une application reçoit une demande d’aide, elle doit afficher les informations d’aide appropriées.</span><span class="sxs-lookup"><span data-stu-id="ae04a-154">Once an application receives a request for help, it should display the appropriate help information.</span></span> <span data-ttu-id="ae04a-155">Étant donné que l’application d’aide Windows fournit une interface utilisateur cohérente, il est recommandé que les applications utilisent l’aide de Windows plutôt que d’autres méthodes.</span><span class="sxs-lookup"><span data-stu-id="ae04a-155">Because the Windows Help application supplies a consistent user interface, it is recommended that applications use Windows Help rather than other methods.</span></span> <span data-ttu-id="ae04a-156">Pour demander à l’aide de Windows d’afficher des informations d’aide, une application utilise la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , en spécifiant des détails tels que les informations à afficher et la forme de la fenêtre dans laquelle l’afficher.</span><span class="sxs-lookup"><span data-stu-id="ae04a-156">To direct Windows Help to display help information, an application uses the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function, specifying details such as the information to display and the form of the window in which to display it.</span></span> <span data-ttu-id="ae04a-157">Les sections suivantes expliquent comment utiliser **WinHelp** pour afficher des informations d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-157">The following sections explain how to use **WinHelp** to display help information.</span></span>

### <a name="help-files"></a><span data-ttu-id="ae04a-158">fichiers d'aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-158">Help files</span></span>

<span data-ttu-id="ae04a-159">Pour afficher les informations d’aide, vous devez spécifier un fichier d’aide lors de l’appel de la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="ae04a-159">To view help information, you must specify a help file when calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span> <span data-ttu-id="ae04a-160">Le fichier d’aide doit avoir le format de fichier d’aide Windows (. hlp) et une ou plusieurs rubriques.</span><span class="sxs-lookup"><span data-stu-id="ae04a-160">The help file must have the Windows Help (.hlp) file format and one or more topics.</span></span> <span data-ttu-id="ae04a-161">Chaque rubrique est une unité d’information distincte, telle qu’une description conceptuelle, un ensemble d’instructions, une image, une définition de Glossaire, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="ae04a-161">Each topic is a distinct unit of information, such as a conceptual description, a set of instructions, a picture, a glossary definition, and so on.</span></span> <span data-ttu-id="ae04a-162">Les rubriques doivent être identifiées de manière unique afin que l’aide de Windows puisse les localiser chaque fois qu’elles sont demandées.</span><span class="sxs-lookup"><span data-stu-id="ae04a-162">Topics must be uniquely identified so that Windows Help can locate them whenever they are requested.</span></span> <span data-ttu-id="ae04a-163">En interne, l’aide de Windows utilise des identificateurs de rubrique pour localiser les rubriques, mais les applications utilisent souvent des identificateurs de contexte (valeurs entières uniques) pour spécifier les rubriques à afficher.</span><span class="sxs-lookup"><span data-stu-id="ae04a-163">Internally, Windows Help uses topic identifiers to locate topics, but applications most often use context identifiers (unique integer values) to specify the topics to display.</span></span> <span data-ttu-id="ae04a-164">L’auteur du fichier d’aide doit mapper explicitement les identificateurs de contexte aux identificateurs de rubrique dans la \[ \] section de mappage du fichier projet utilisé pour générer le fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-164">The help file author must explicitly map context identifiers to topic identifiers in the \[MAP\] section of the project file used to build the help file.</span></span>

<span data-ttu-id="ae04a-165">Lorsque vous spécifiez un fichier d’aide mais que vous ne spécifiez pas de chemin d’accès, [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) recherche le fichier d’aide dans le répertoire d’aide ou dans un répertoire spécifié par la variable d’environnement PATH.</span><span class="sxs-lookup"><span data-stu-id="ae04a-165">When you specify a help file but you do not specify a path, [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) looks for the help file in the help directory or in a directory specified by the PATH environment variable.</span></span> <span data-ttu-id="ae04a-166">En outre, **WinHelp** peut trouver un fichier d’aide dont le nom est indiqué dans l’emplacement de Registre suivant :</span><span class="sxs-lookup"><span data-stu-id="ae04a-166">In addition, **WinHelp** can find a help file whose name is listed in the following registry location:</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            Help
```

<span data-ttu-id="ae04a-167">Pour tirer parti du Registre, vous devez créer un nom de valeur qui porte le même nom que votre fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-167">To take advantage of the registry, you must create a value name that has the same name as your help file.</span></span> <span data-ttu-id="ae04a-168">La valeur assignée à ce nom doit être le répertoire où se trouve le fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-168">The value assigned to that name must be the directory where the help file resides.</span></span>

<span data-ttu-id="ae04a-169">Si [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) ne trouve pas le fichier d’aide donné, il affiche une boîte de dialogue qui permet à l’utilisateur de spécifier l’emplacement du fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-169">If [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) cannot find the given help file, it displays a dialog box that allows the user to specify the location of the help file.</span></span> <span data-ttu-id="ae04a-170">Étant donné que **WinHelp** enregistre les informations d’emplacement dans le registre, il ne redemande pas l’emplacement du même fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-170">Because **WinHelp** saves the location information in the registry, it does not ask again for the location of the same help file.</span></span>

<span data-ttu-id="ae04a-171">Pour plus d’informations sur la création et la création d’un fichier d’aide, consultez la documentation fournie avec vos outils de développement.</span><span class="sxs-lookup"><span data-stu-id="ae04a-171">For more information about how to author and build a help file, see the documentation provided with your development tools.</span></span>

### <a name="starting-windows-help"></a><span data-ttu-id="ae04a-172">Démarrage de l’aide Windows</span><span class="sxs-lookup"><span data-stu-id="ae04a-172">Starting Windows Help</span></span>

<span data-ttu-id="ae04a-173">L’exemple suivant utilise la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) pour démarrer l’application d’aide Windows et ouvrir le fichier d’aide dans son contenu.</span><span class="sxs-lookup"><span data-stu-id="ae04a-173">The following example uses the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to start the Windows Help application and open the help file to its Contents topic.</span></span>


```
HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 

bResult = WinHelp(hWnd, "WINNT.HLP", HELP_CONTENTS, 0L);
```



<span data-ttu-id="ae04a-174">L’exemple suivant ouvre le fichier d’aide de l’utilisateur, recherche la rubrique associée à une chaîne de mot clé dans le fichier, puis affiche la rubrique.</span><span class="sxs-lookup"><span data-stu-id="ae04a-174">This next example opens the user help file, searches the file for the topic associated with a keyword string, and then displays the topic.</span></span>


```
HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 

bResult = WinHelp(hWnd, "WINNT.HLP", HELP_KEY, (DWORD) "finding topics");
```



### <a name="help-topics-dialog-box"></a><span data-ttu-id="ae04a-175">Rubriques d’aide (boîte de dialogue)</span><span class="sxs-lookup"><span data-stu-id="ae04a-175">Help Topics dialog box</span></span>

<span data-ttu-id="ae04a-176">Vous pouvez afficher la boîte de dialogue **rubriques d’aide** en appelant la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) avec la commande de **\_ recherche** de l’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-176">You can display the **Help Topics** dialog box by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the **HELP\_FINDER** command.</span></span> <span data-ttu-id="ae04a-177">La boîte de dialogue **rubriques d’aide** permet à l’utilisateur de sélectionner les rubriques à afficher en affichant les titres des rubriques, les mots clés associés aux rubriques ou les mots et expressions figurant dans les rubriques.</span><span class="sxs-lookup"><span data-stu-id="ae04a-177">The **Help Topics** dialog box lets the user select topics to display by viewing the titles of the topics, the keywords associated with the topics, or the words and phrases found in the topics.</span></span> <span data-ttu-id="ae04a-178">En général, les applications affichent cette boîte de dialogue lorsque l’utilisateur choisit une commande, telle que rubriques d’aide, dans le menu aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-178">Applications typically display this dialog box when the user chooses a command, such as Help Topics, from the Help menu.</span></span> <span data-ttu-id="ae04a-179">Une application peut également afficher cette boîte de dialogue si l’utilisateur appuie sur la touche quand aucune fenêtre, contrôle ou menu spécifique dans l’application n’a le focus ou est actif.</span><span class="sxs-lookup"><span data-stu-id="ae04a-179">An application may also display this dialog box if the user presses the key when no specific window, control, or menu in the application has the focus or is active.</span></span>

<span data-ttu-id="ae04a-180">Dans le passé, les applications utilisaient **le \_ Sommaire** de l’aide et les commandes **d' \_ index** avec la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) pour afficher la rubrique contenu et l’index du mot clé du fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-180">In the past, applications have used the **HELP\_CONTENTS** and **HELP\_INDEX** commands with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to display the Contents topic and the keyword index of the Help file.</span></span> <span data-ttu-id="ae04a-181">Ces commandes ne sont plus recommandées.</span><span class="sxs-lookup"><span data-stu-id="ae04a-181">These commands are no longer recommended.</span></span> <span data-ttu-id="ae04a-182">Utilisez la commande de **\_ recherche** de l’aide à la place.</span><span class="sxs-lookup"><span data-stu-id="ae04a-182">Use the **HELP\_FINDER** command instead.</span></span>

### <a name="information-topics"></a><span data-ttu-id="ae04a-183">Rubriques d’informations</span><span class="sxs-lookup"><span data-stu-id="ae04a-183">Information topics</span></span>

<span data-ttu-id="ae04a-184">Vous pouvez afficher une rubrique spécifique en appelant la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) avec la commande de contexte d’aide \_ et en spécifiant l’identificateur de contexte pour la rubrique.</span><span class="sxs-lookup"><span data-stu-id="ae04a-184">You can display a specific topic by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the HELP\_CONTEXT command and specifying the context identifier for the topic.</span></span> <span data-ttu-id="ae04a-185">Les applications utilisent généralement la \_ commande de contexte d’aide en réponse aux demandes de l’utilisateur pour les rubriques qui contiennent des informations conceptuelles ou une aide procédurale plutôt que des informations sur un contrôle ou un menu spécifique.</span><span class="sxs-lookup"><span data-stu-id="ae04a-185">Applications typically use the HELP\_CONTEXT command in response to user requests for topics containing conceptual information or procedural help rather than information about a specific control or menu.</span></span> <span data-ttu-id="ae04a-186">Dans ce cas, l’utilisateur peut continuer à parcourir le fichier d’aide à la recherche d’informations connexes avant de revenir à l’application.</span><span class="sxs-lookup"><span data-stu-id="ae04a-186">In such cases, the user may continue to browse the help file looking for related information before returning to the application.</span></span>

<span data-ttu-id="ae04a-187">La \_ commande de contexte d’aide appelle une instance normale de l’aide de Windows, ce qui permet à l’utilisateur de rechercher d’autres rubriques dans le fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-187">The HELP\_CONTEXT command invokes a regular instance of Windows Help, enabling the user to find other topics in the help file.</span></span> <span data-ttu-id="ae04a-188">Il affiche généralement la fenêtre d’aide principale, qui comprend une barre de titre, un menu système, des boutons réduire et agrandir, un menu principal, une barre de navigation facultative, une bordure de redimensionnement et une zone cliente.</span><span class="sxs-lookup"><span data-stu-id="ae04a-188">It typically displays the main Help window, which includes a title bar, a system menu, minimize and maximize buttons, a main menu, an optional navigation bar, a sizing border, and a client area.</span></span> <span data-ttu-id="ae04a-189">Le texte de la rubrique sélectionnée apparaît dans la zone cliente et l’utilisateur peut naviguer dans le fichier d’aide à l’aide de liens hypertexte ou de boutons de navigation dans la fenêtre principale.</span><span class="sxs-lookup"><span data-stu-id="ae04a-189">The text of the selected topic appears in the client area, and the user can navigate through the help file by using hot links or navigation buttons in the main window.</span></span> <span data-ttu-id="ae04a-190">L’instance normale de l’aide de Windows peut également être utilisée pour afficher l’aide dans une ou plusieurs fenêtres secondaires et non dans la fenêtre principale.</span><span class="sxs-lookup"><span data-stu-id="ae04a-190">The regular instance of Windows Help can also be used to display help in one or more secondary windows instead of the main window.</span></span>

### <a name="pop-up-topics"></a><span data-ttu-id="ae04a-191">Rubriques indépendantes</span><span class="sxs-lookup"><span data-stu-id="ae04a-191">Pop-up topics</span></span>

<span data-ttu-id="ae04a-192">Vous pouvez afficher une rubrique contextuelle qui contient des informations sur un contrôle ou un menu spécifique en appelant la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) avec l’aide \_ WM \_ help ou Help \_ CONTEXTMENU.</span><span class="sxs-lookup"><span data-stu-id="ae04a-192">You can display a pop-up topic that contains information for a specific control or menu by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the HELP\_WM\_HELP or HELP\_CONTEXTMENU command.</span></span> <span data-ttu-id="ae04a-193">Ces commandes affichent une rubrique dans une fenêtre indépendante près du contrôle ou du menu correspondant.</span><span class="sxs-lookup"><span data-stu-id="ae04a-193">These commands display a topic in a pop-up window near the corresponding control or menu.</span></span> <span data-ttu-id="ae04a-194">Pour permettre à l’utilisateur de retourner immédiatement à l’application, la fenêtre indépendante est détruite dès que l’utilisateur appuie sur une touche ou clique avec le bouton gauche de la souris.</span><span class="sxs-lookup"><span data-stu-id="ae04a-194">To let the user return immediately to work in the application, the pop-up window is destroyed as soon as the user presses a key or clicks the left mouse button.</span></span>

<span data-ttu-id="ae04a-195">Vous utilisez la \_ commande help WM \_ Help lors du traitement des messages [**\_ d’aide WM**](wm-help.md) pour les fenêtres de contrôle.</span><span class="sxs-lookup"><span data-stu-id="ae04a-195">You use the HELP\_WM\_HELP command when processing [**WM\_HELP**](wm-help.md) messages for control windows.</span></span> <span data-ttu-id="ae04a-196">Étant donné que la plupart des contrôles transmettent le message d' **\_ aide WM** à la fonction [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) , la procédure de boîte de dialogue correspondante (ou la procédure de fenêtre parente) traite ce message.</span><span class="sxs-lookup"><span data-stu-id="ae04a-196">Because most controls pass the **WM\_HELP** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, the corresponding dialog box procedure (or parent window procedure) processes this message.</span></span> <span data-ttu-id="ae04a-197">Au lieu de fournir un identificateur de contexte spécifique, la procédure de la boîte de dialogue doit passer un tableau de paires d’identificateurs de contrôle et de contexte à [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) avec le descripteur de contrôle spécifié dans le membre **hItemHandle** de la structure [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) passé avec le message **\_ d’aide WM** .</span><span class="sxs-lookup"><span data-stu-id="ae04a-197">Rather than give a specific context identifier, the dialog box procedure must pass an array of control and context identifier pairs to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) along with the control handle specified in the **hItemHandle** member of the [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure passed with the **WM\_HELP** message.</span></span> <span data-ttu-id="ae04a-198">La fonction détermine l’identificateur du contrôle pour lequel le message **\_ d’aide WM** a été généré et utilise l’identificateur de contexte correspondant pour afficher la rubrique appropriée.</span><span class="sxs-lookup"><span data-stu-id="ae04a-198">The function determines the identifier of the control for which the **WM\_HELP** message was generated and uses the matching context identifier to display the appropriate topic.</span></span>

<span data-ttu-id="ae04a-199">Vous utilisez la \_ commande help ContextMenu lors du traitement des messages [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="ae04a-199">You use the HELP\_CONTEXTMENU command when processing [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) messages.</span></span> <span data-ttu-id="ae04a-200">Étant donné que la plupart des contrôles transmettent le message **WM \_ CONTEXTMENU** à la fonction [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) , la procédure de boîte de dialogue correspondante (ou la procédure de fenêtre parente) traite ce message.</span><span class="sxs-lookup"><span data-stu-id="ae04a-200">Because most controls pass the **WM\_CONTEXTMENU** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, the corresponding dialog box procedure (or parent window procedure) processes this message.</span></span> <span data-ttu-id="ae04a-201">La procédure spécifie un tableau de paires d’identificateurs de contexte et de contrôle ; elle spécifie également le handle dans le paramètre *wParam* lors de l’appel de [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) afin que la fonction puisse sélectionner l’identificateur de contexte approprié dans le tableau et afficher la rubrique appropriée.</span><span class="sxs-lookup"><span data-stu-id="ae04a-201">The procedure specifies an array of control and context identifier pairs; it also specifies the handle in the *wParam* parameter when calling [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) so that the function can pick the appropriate context identifier from the array and display the appropriate topic.</span></span> <span data-ttu-id="ae04a-202">Contrairement à la \_ commande help de l’aide WM \_ , Help \_ CONTEXTMENU affiche d’abord une commande **qu’est-ce que c’est ?** dans un menu.</span><span class="sxs-lookup"><span data-stu-id="ae04a-202">Unlike the HELP\_WM\_HELP command, HELP\_CONTEXTMENU first displays a **What's This?** command in a menu.</span></span> <span data-ttu-id="ae04a-203">Si l’utilisateur choisit la commande, **WinHelp** affiche la rubrique.</span><span class="sxs-lookup"><span data-stu-id="ae04a-203">If the user chooses the command, **WinHelp** displays the topic.</span></span> <span data-ttu-id="ae04a-204">Dans le cas contraire, la demande est annulée.</span><span class="sxs-lookup"><span data-stu-id="ae04a-204">Otherwise, the request is canceled.</span></span>

<span data-ttu-id="ae04a-205">Vous pouvez également afficher des rubriques contextuelles à l’aide de la \_ commande help CONTEXTPOPUP et en spécifiant un identificateur de contexte de la rubrique.</span><span class="sxs-lookup"><span data-stu-id="ae04a-205">You can also display pop-up topics by using the HELP\_CONTEXTPOPUP command and specifying a context identifier of the topic.</span></span> <span data-ttu-id="ae04a-206">Cette commande est similaire à la commande de contexte d’aide \_ , mais elle appelle l’instance contextuelle de l’aide de Windows utilisée par l’aide de \_ WM \_ et Help \_ CONTEXTMENU.</span><span class="sxs-lookup"><span data-stu-id="ae04a-206">This command is similar to the HELP\_CONTEXT command but invokes the pop-up instance of Windows Help used by HELP\_WM\_HELP and HELP\_CONTEXTMENU.</span></span> <span data-ttu-id="ae04a-207">Les applications peuvent utiliser cette commande en réponse aux messages d' [**\_ aide WM**](wm-help.md) pour afficher de l’aide sur les menus et les fenêtres qui ne sont pas des contrôles dans une boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="ae04a-207">Applications can use this command in response to [**WM\_HELP**](wm-help.md) messages to display help for menus and for windows that are not controls in a dialog box.</span></span> <span data-ttu-id="ae04a-208">Pour utiliser cette commande de manière plus efficace, l’application doit assigner des identificateurs de contexte à ces menus et fenêtres.</span><span class="sxs-lookup"><span data-stu-id="ae04a-208">To use this command most effectively, the application should assign context identifiers to these menus and windows.</span></span>

<span data-ttu-id="ae04a-209">Vous pouvez assigner un identificateur de contexte à n’importe quelle fenêtre ou menu dans l’application.</span><span class="sxs-lookup"><span data-stu-id="ae04a-209">You can assign a context identifier to any window or menu in the application.</span></span> <span data-ttu-id="ae04a-210">Lorsqu’un [**message \_ d’aide WM**](wm-help.md) est généré, le système comprend l’identificateur de contexte dans la structure [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) qui est passé à la fenêtre parente dans le message **\_ d’aide WM** .</span><span class="sxs-lookup"><span data-stu-id="ae04a-210">When a [**WM\_HELP**](wm-help.md) message is generated, the system includes the context identifier in the [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that is passed to the parent window in the **WM\_HELP** message.</span></span> <span data-ttu-id="ae04a-211">La fenêtre parente peut ensuite passer l’identificateur de contexte à [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) pour afficher la rubrique d’aide demandée.</span><span class="sxs-lookup"><span data-stu-id="ae04a-211">The parent window can then pass the context identifier to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) to display the requested help topic.</span></span>

<span data-ttu-id="ae04a-212">Vous utilisez la fonction [**SetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setwindowcontexthelpid) pour assigner un identificateur de contexte à une fenêtre ou à un contrôle et la fonction [**SetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setmenucontexthelpid) pour assigner un identificateur de contexte à un menu.</span><span class="sxs-lookup"><span data-stu-id="ae04a-212">You use the [**SetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setwindowcontexthelpid) function to assign a context identifier to a window or control and the [**SetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setmenucontexthelpid) function to assign a context identifier to a menu.</span></span> <span data-ttu-id="ae04a-213">Vous pouvez récupérer l’identificateur de contexte d’une fenêtre ou d’un menu à l’aide de la fonction [**GetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getwindowcontexthelpid) ou [**GetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getmenucontexthelpid) .</span><span class="sxs-lookup"><span data-stu-id="ae04a-213">You can retrieve the context identifier for a window or menu by using the [**GetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getwindowcontexthelpid) or [**GetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getmenucontexthelpid) function.</span></span>

### <a name="keyword-searches"></a><span data-ttu-id="ae04a-214">Recherches par mot clé</span><span class="sxs-lookup"><span data-stu-id="ae04a-214">Keyword searches</span></span>

<span data-ttu-id="ae04a-215">Vous pouvez permettre à l’utilisateur de rechercher et d’afficher des rubriques en affectant des mots clés aux rubriques du fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-215">You can enable the user to find and view topics by assigning keywords to topics in the help file.</span></span> <span data-ttu-id="ae04a-216">Un mot clé est simplement une chaîne associée à une ou plusieurs rubriques.</span><span class="sxs-lookup"><span data-stu-id="ae04a-216">A keyword is simply a string that is associated with one or more topics.</span></span> <span data-ttu-id="ae04a-217">L’aide de Windows recueille tous les mots clés dans un fichier d’aide, les place dans un tableau et les affiche dans la liste index de la boîte de dialogue **rubriques d’aide** .</span><span class="sxs-lookup"><span data-stu-id="ae04a-217">Windows Help collects all keywords in a help file, places them in a table, and displays them in the Index list of the **Help Topics** dialog box.</span></span> <span data-ttu-id="ae04a-218">Quand l’utilisateur sélectionne un mot clé, l’aide de Windows affiche la rubrique d’aide associée ou, si plusieurs rubriques sont associées au mot clé, affiche une liste des rubriques à partir desquelles l’utilisateur peut choisir.</span><span class="sxs-lookup"><span data-stu-id="ae04a-218">When the user selects a keyword, Windows Help displays the associated help topic or, if there is more than one topic associated with the keyword, displays a list of topics from which the user can choose.</span></span>

<span data-ttu-id="ae04a-219">Dans une application, vous pouvez utiliser la \_ \_ commande help PARTIALKEY ou Help \_ relations avec la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) pour rechercher et afficher les rubriques d’aide en fonction de mots clés entiers ou partiels.</span><span class="sxs-lookup"><span data-stu-id="ae04a-219">In an application, you can use the HELP\_KEY, HELP\_PARTIALKEY, or HELP\_MULTIKEY command with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to search for and display help topics based on whole or partial keywords.</span></span> <span data-ttu-id="ae04a-220">Vous spécifiez la commande, la chaîne de mot clé, le fichier d’aide et le handle de la fenêtre propriétaire.</span><span class="sxs-lookup"><span data-stu-id="ae04a-220">You specify the command, the keyword string, the help file, and the handle to the owner window.</span></span> <span data-ttu-id="ae04a-221">Dans tous les cas, si une correspondance unique est trouvée, **WinHelp** affiche la rubrique correspondante.</span><span class="sxs-lookup"><span data-stu-id="ae04a-221">In all cases, if a single match is found, **WinHelp** displays the corresponding topic.</span></span> <span data-ttu-id="ae04a-222">Si plusieurs correspondances sont trouvées, la fonction affiche la boîte de dialogue rubriques trouvées et l’utilisateur peut choisir la rubrique à afficher.</span><span class="sxs-lookup"><span data-stu-id="ae04a-222">If more than one match is found, the function displays the Topics Found dialog box, and the user can choose which topic to view.</span></span> <span data-ttu-id="ae04a-223">Si aucune correspondance n’est trouvée, **WinHelp** affiche la liste d’index (pour la clé d’aide \_ et l’aide \_ PARTIALKEY) ou affiche un message d’erreur (pour obtenir de l’aide \_ relations).</span><span class="sxs-lookup"><span data-stu-id="ae04a-223">If no match is found, **WinHelp** either displays the Index list (for HELP\_KEY and HELP\_PARTIALKEY) or displays an error message (for HELP\_MULTIKEY).</span></span>

<span data-ttu-id="ae04a-224">Votre application peut rechercher plusieurs mots clés dans un seul appel à [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) en séparant les mots clés par des points-virgules.</span><span class="sxs-lookup"><span data-stu-id="ae04a-224">Your application can search for multiple keywords in a single call to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) by separating the keywords with semicolons.</span></span> <span data-ttu-id="ae04a-225">(La recherche de plusieurs mots clés n’est pas prise en charge pour les fichiers d’aide créés pour Windows version 3. *x*) il peut également rechercher des mots clés dans plusieurs fichiers d’aide si le fichier d’aide spécifié possède un fichier Contents (. CNT) qui contient les commandes : index ou : Link.</span><span class="sxs-lookup"><span data-stu-id="ae04a-225">(Searching for multiple keywords is not supported for help files created for Windows version 3.*x*) It can also search for keywords across multiple help files if the help file that is specified has a contents(.cnt) file that contains :Index or :Link commands.</span></span> <span data-ttu-id="ae04a-226">Avec la \_ commande clé d’aide, **WinHelp** recherche les mots clés dans tous les fichiers spécifiés par ces commandes.</span><span class="sxs-lookup"><span data-stu-id="ae04a-226">With the HELP\_KEY command, **WinHelp** searches for keywords in all files specified by these commands.</span></span> <span data-ttu-id="ae04a-227">Avec les \_ commandes Help relations et Help \_ PARTIALKEY, la fonction recherche tous les fichiers, à l’exception de ceux spécifiés par : les commandes Link.</span><span class="sxs-lookup"><span data-stu-id="ae04a-227">With the HELP\_MULTIKEY and HELP\_PARTIALKEY commands, the function searches all files except those specified by :Link commands.</span></span>

<span data-ttu-id="ae04a-228">Par défaut, l’aide de Windows reconnaît uniquement le mot clé table identifié par le caractère de note de bas de page K dans le fichier source d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-228">By default, Windows Help recognizes only the keyword table identified by the K footnote character in the help source file.</span></span> <span data-ttu-id="ae04a-229">Vous pouvez demander à l’aide de Windows de créer des tables de mots clés supplémentaires en ajoutant un caractère de note de bas de page, avec la définition du mot clé, dans le fichier source d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-229">You can direct Windows Help to create additional keyword tables by adding a footnote character other than K, with the keyword definition, in the help source file.</span></span> <span data-ttu-id="ae04a-230">(Toutefois, le caractère de note de bas de page A est réservé.) Vous devez définir des tables de mots clés supplémentaires à l’aide des instructions relations dans la \[ \] section Options du fichier projet lors de la génération du fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-230">(The footnote character A, however, is reserved.) You must define any additional keyword tables by using MULTIKEY statements in the \[OPTIONS\] section of the project file when building the help file.</span></span>

<span data-ttu-id="ae04a-231">Une application peut utiliser la \_ commande help SETINDEX avec la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) pour demander à l’aide de Windows d’afficher une table de mots clés autre que K dans sa liste d’index.</span><span class="sxs-lookup"><span data-stu-id="ae04a-231">An application can use the HELP\_SETINDEX command with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to direct Windows Help to display a keyword table other than K in its Index list.</span></span> <span data-ttu-id="ae04a-232">Pour demander à l’aide de Windows de rechercher un mot clé dans une autre table de mots clés, une application peut utiliser la \_ commande help relations.</span><span class="sxs-lookup"><span data-stu-id="ae04a-232">To direct Windows Help to search for a keyword in an alternate keyword table, an application can use the HELP\_MULTIKEY command.</span></span> <span data-ttu-id="ae04a-233">Vous spécifiez le mot clé et la table des mots clés dans une structure [**MULTIKEYHELP**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) , que vous transmettez à **WinHelp**.</span><span class="sxs-lookup"><span data-stu-id="ae04a-233">You specify the keyword and keyword table in a [**MULTIKEYHELP**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) structure, which you pass to **WinHelp**.</span></span>

<span data-ttu-id="ae04a-234">Quand [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) affiche une rubrique, il l’affiche dans la fenêtre spécifiée par la note de bas de page « > » pour la rubrique, dans la fenêtre spécifiée par la commande : base dans le fichier de contenu, ou dans la fenêtre principale.</span><span class="sxs-lookup"><span data-stu-id="ae04a-234">When [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) displays a topic, it displays it in the window specified by the ">" footnote for the topic, in the window specified by the :Base command in the contents file, or in the main window.</span></span> <span data-ttu-id="ae04a-235">Si la fenêtre principale est déjà ouverte dans un autre fichier d’aide lorsque vous appelez **WinHelp**, la fonction masque la fenêtre principale lors de la recherche.</span><span class="sxs-lookup"><span data-stu-id="ae04a-235">If the main window is already open to a different help file when you call **WinHelp**, the function hides the main window while searching.</span></span> <span data-ttu-id="ae04a-236">Dans ce cas, l’annulation de la boîte de dialogue **rubriques trouvées** et **rubriques d’aide** ferme la fenêtre principale.</span><span class="sxs-lookup"><span data-stu-id="ae04a-236">In this case, canceling both the **Topics Found** and **Help Topics** dialog boxes closes the main window.</span></span>

### <a name="secondary-help-windows"></a><span data-ttu-id="ae04a-237">Fenêtres d’aide secondaires</span><span class="sxs-lookup"><span data-stu-id="ae04a-237">Secondary Help windows</span></span>

<span data-ttu-id="ae04a-238">La fenêtre principale de l’application d’aide Windows est appelée fenêtre principale.</span><span class="sxs-lookup"><span data-stu-id="ae04a-238">The main window of the Windows Help application is called the primary window.</span></span> <span data-ttu-id="ae04a-239">L’aide de Windows peut également afficher les rubriques d’aide dans une fenêtre secondaire.</span><span class="sxs-lookup"><span data-stu-id="ae04a-239">Windows Help can also display help topics in a secondary window.</span></span> <span data-ttu-id="ae04a-240">Contrairement à la fenêtre d’aide principale, une fenêtre secondaire ne contient pas de barre de menus.</span><span class="sxs-lookup"><span data-stu-id="ae04a-240">Unlike the primary Help window, a secondary window does not contain a menu bar.</span></span> <span data-ttu-id="ae04a-241">Vous pouvez inclure une barre de navigation dans une fenêtre secondaire, et vous pouvez ajouter des boutons à la barre.</span><span class="sxs-lookup"><span data-stu-id="ae04a-241">You can include a navigation bar in a secondary window, and you can add buttons to the bar.</span></span> <span data-ttu-id="ae04a-242">Vous pouvez également choisir de faire en sorte que l’aide de Windows ajuste automatiquement la hauteur de la fenêtre secondaire pour s’adapter à la rubrique.</span><span class="sxs-lookup"><span data-stu-id="ae04a-242">You can also choose to have Windows Help automatically adjust the height of the secondary window to accommodate the topic.</span></span>

<span data-ttu-id="ae04a-243">Vous devez définir des fenêtres secondaires dans \[ la \] section Windows de votre fichier de projet d’aide, en fournissant le nom et, éventuellement, la taille initiale et la position de chaque fenêtre.</span><span class="sxs-lookup"><span data-stu-id="ae04a-243">You must define secondary windows in the \[WINDOWS\] section of your help project file, providing the name and, optionally, initial size and position of each window.</span></span> <span data-ttu-id="ae04a-244">Vous pouvez demander à l’application d’aide Windows d’afficher une rubrique dans une fenêtre secondaire en ajoutant un chevron (>) et le nom que vous avez défini pour la fenêtre secondaire au nom du fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-244">You can direct the Windows Help application to display a topic in a secondary window by appending an angle bracket (>) and the name you have defined for the secondary window to the name of the help file.</span></span> <span data-ttu-id="ae04a-245">La chaîne résultante est ensuite transmise à la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="ae04a-245">The resulting string is then passed to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span>

<span data-ttu-id="ae04a-246">Une application peut modifier la taille et la position d’une fenêtre principale ou secondaire en spécifiant l’adresse d’une structure [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) et la \_ commande help SETWINPOS dans un appel à [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span><span class="sxs-lookup"><span data-stu-id="ae04a-246">An application can change the size and position of a primary or secondary window by specifying the address of a [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) structure and the HELP\_SETWINPOS command in a call to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span></span> <span data-ttu-id="ae04a-247">**HELPWININFO** spécifie le nom de la fenêtre et sa nouvelle taille et position.</span><span class="sxs-lookup"><span data-stu-id="ae04a-247">**HELPWININFO** specifies the name of the window and its new size and position.</span></span>

### <a name="training-card-help"></a><span data-ttu-id="ae04a-248">Aide sur la carte de formation</span><span class="sxs-lookup"><span data-stu-id="ae04a-248">Training card help</span></span>

<span data-ttu-id="ae04a-249">À l’aide de la carte d’apprentissage, une application peut afficher une séquence d’instructions pour guider l’utilisateur à travers les étapes d’une tâche.</span><span class="sxs-lookup"><span data-stu-id="ae04a-249">Using training card help, an application can display a sequence of instructions to guide the user through the steps of a task.</span></span> <span data-ttu-id="ae04a-250">Une carte de formation se compose généralement d’un texte expliquant une étape particulière et des boutons associés à des macros TCard, qui permettent à l’utilisateur d’indiquer à l’application ce qu’il doit faire ensuite.</span><span class="sxs-lookup"><span data-stu-id="ae04a-250">A training card typically consists of text that explains a particular step and buttons that are associated with TCard macros, which allow the user to tell the application what to do next.</span></span> <span data-ttu-id="ae04a-251">Les cartes de formation ne peuvent être affichées que dans des fenêtres secondaires et ne doivent pas contenir de liens hypertexte vers d’autres rubriques du fichier d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-251">Training cards can only be displayed in secondary windows and must not contain hot links to other topics in the help file.</span></span>

<span data-ttu-id="ae04a-252">Une application démarre l’instance de la carte de formation de l’aide Windows en appelant la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) et en spécifiant la \_ commande help TCARD en combinaison avec une autre commande, telle que le contexte d’aide \_ .</span><span class="sxs-lookup"><span data-stu-id="ae04a-252">An application initiates the training card instance of Windows Help by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function and specifying the HELP\_TCARD command in combination with another command, such as HELP\_CONTEXT.</span></span> <span data-ttu-id="ae04a-253">Par la suite, quand l’utilisateur clique sur un bouton dans la carte de formation, clique sur une zone réactive assignée à la macro TCard ou ferme la carte de formation, Windows Help notifie l’application en lui envoyant un message [**WM \_ TCard**](wm-tcard.md) .</span><span class="sxs-lookup"><span data-stu-id="ae04a-253">Subsequently, when the user clicks a button in the training card, clicks a hot spot assigned to the TCard macro, or closes the training card, Windows Help notifies the application by sending it a [**WM\_TCARD**](wm-tcard.md) message.</span></span> <span data-ttu-id="ae04a-254">Le paramètre *wParam* identifie le bouton ou l’action de l’utilisateur, et le paramètre *lParam* contient des données supplémentaires, dont la signification dépend de la valeur de *wParam*.</span><span class="sxs-lookup"><span data-stu-id="ae04a-254">The *wParam* parameter identifies the button or user action, and the *lParam* parameter contains additional data, the meaning of which depends on the value of *wParam*.</span></span>

### <a name="canceling-help"></a><span data-ttu-id="ae04a-255">Annulation de l’aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-255">Canceling Help</span></span>

<span data-ttu-id="ae04a-256">L’aide de Windows requiert une application pour annuler explicitement l’aide afin qu’elle puisse libérer toutes les ressources utilisées pour effectuer le suivi de l’application et de ses fichiers d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-256">Windows Help requires an application to explicitly cancel help so that it can free any resources used to keep track of the application and its help files.</span></span> <span data-ttu-id="ae04a-257">L’application peut le faire à tout moment en appelant la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) et en spécifiant la \_ commande help Quit.</span><span class="sxs-lookup"><span data-stu-id="ae04a-257">The application can do this at any time by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function and specifying the HELP\_QUIT command.</span></span> <span data-ttu-id="ae04a-258">Notez que cela n’est pas vrai pour l’instance contextuelle de l’aide de Windows.</span><span class="sxs-lookup"><span data-stu-id="ae04a-258">Note that this is not true for the pop-up instance of Windows Help.</span></span> <span data-ttu-id="ae04a-259">Une application ne doit pas essayer de fermer une instance contextuelle.</span><span class="sxs-lookup"><span data-stu-id="ae04a-259">An application should not try to close a pop-up instance.</span></span>

<span data-ttu-id="ae04a-260">Si une application a effectué des appels à [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa), elle doit annuler l’aide avant de fermer sa fenêtre principale (par exemple, en réponse au \_ message WM Destroy dans la procédure de fenêtre principale).</span><span class="sxs-lookup"><span data-stu-id="ae04a-260">If an application has made any calls to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa), it must cancel help before it closes its main window (for example, in response to the WM\_DESTROY message in the main window procedure).</span></span> <span data-ttu-id="ae04a-261">Une application doit appeler **WinHelp** une seule fois pour annuler l’aide, quel que soit le nombre de fichiers d’aide ouverts.</span><span class="sxs-lookup"><span data-stu-id="ae04a-261">An application needs to call **WinHelp** only once to cancel help, no matter how many help files it has opened.</span></span> <span data-ttu-id="ae04a-262">L’aide de Windows reste en cours d’exécution jusqu’à ce que toutes les applications ou dll aient annulé l’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-262">Windows Help remains running until all applications or DLLs have canceled help.</span></span>

<span data-ttu-id="ae04a-263">Pour fermer l’instance de la carte de formation de l’aide de Windows, vous devez spécifier à la fois l’aide \_ TCARD et l’aide \_ pour quitter les commandes lors de l’appel de [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span><span class="sxs-lookup"><span data-stu-id="ae04a-263">To close the training card instance of Windows Help, you must specify both the HELP\_TCARD and HELP\_QUIT commands when calling [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span></span> <span data-ttu-id="ae04a-264">Une application n’a pas besoin d’annuler l’instance de la carte de formation de l’aide de Windows si l’utilisateur l’annule en premier.</span><span class="sxs-lookup"><span data-stu-id="ae04a-264">An application does not need to cancel the training card instance of Windows Help if the user cancels it first.</span></span> <span data-ttu-id="ae04a-265">L’aide de Windows avertit une application lorsque l’utilisateur annule l’instance de la carte de formation en envoyant le message [**WM \_ TCARD**](wm-tcard.md) avec le paramètre *wParam* défini sur IDCLOSE.</span><span class="sxs-lookup"><span data-stu-id="ae04a-265">Windows Help notifies an application when the user cancels the training card instance by sending the [**WM\_TCARD**](wm-tcard.md) message with the *wParam* parameter set to IDCLOSE.</span></span>

## <a name="using-help"></a><span data-ttu-id="ae04a-266">Utilisation de l'aide</span><span class="sxs-lookup"><span data-stu-id="ae04a-266">Using Help</span></span>

<span data-ttu-id="ae04a-267">Cette section montre comment fournir une aide contextuelle pour une boîte de dialogue et comment définir l’apparence d’une fenêtre d’aide secondaire.</span><span class="sxs-lookup"><span data-stu-id="ae04a-267">This section shows how to provide context-sensitive help for a dialog box and how to set the appearance of a secondary Help window.</span></span>

-   [<span data-ttu-id="ae04a-268">Fournir de l’aide dans une boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="ae04a-268">Providing Help in a Dialog Box</span></span>](#providing-help-in-a-dialog-box)
-   [<span data-ttu-id="ae04a-269">Définition de l’apparence d’une fenêtre d’aide secondaire</span><span class="sxs-lookup"><span data-stu-id="ae04a-269">Setting the Appearance of a Secondary Help Window</span></span>](#setting-the-appearance-of-a-secondary-help-window)

### <a name="providing-help-in-a-dialog-box"></a><span data-ttu-id="ae04a-270">Fournir de l’aide dans une boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="ae04a-270">Providing Help in a Dialog Box</span></span>

<span data-ttu-id="ae04a-271">Pour fournir une aide contextuelle dans une boîte de dialogue, vous devez créer un tableau constitué de paires de valeurs **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="ae04a-271">To provide context-sensitive help in a dialog box, you must create an array consisting of pairs of **DWORD** values.</span></span> <span data-ttu-id="ae04a-272">La première valeur de chaque paire est l’identificateur d’un contrôle dans la boîte de dialogue, tandis que la seconde est l’identificateur de contexte de la rubrique d’aide pour le contrôle.</span><span class="sxs-lookup"><span data-stu-id="ae04a-272">The first value in each pair is the identifier of a control in the dialog box, and the second is the context identifier of the help topic for the control.</span></span> <span data-ttu-id="ae04a-273">Le tableau doit contenir une paire d’identificateurs pour chaque contrôle de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="ae04a-273">The array should contain one pair of identifiers for each control in the dialog box.</span></span>

<span data-ttu-id="ae04a-274">La procédure de la boîte de dialogue doit traiter l' [**\_ aide WM**](wm-help.md) et les messages [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="ae04a-274">The dialog box procedure must process the [**WM\_HELP**](wm-help.md) and [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) messages.</span></span> <span data-ttu-id="ae04a-275">La procédure de boîte de dialogue reçoit l' **\_ aide de WM** quand l’utilisateur appuie sur la touche et **WM \_ CONTEXTMENU** quand l’utilisateur clique avec le bouton droit de la souris.</span><span class="sxs-lookup"><span data-stu-id="ae04a-275">The dialog box procedure receives **WM\_HELP** when the user presses the key and **WM\_CONTEXTMENU** when the user clicks the right mouse button.</span></span>

<span data-ttu-id="ae04a-276">Le paramètre *lParam* de [**l' \_ aide WM**](wm-help.md) contient l’adresse d’une structure [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) .</span><span class="sxs-lookup"><span data-stu-id="ae04a-276">The *lParam* parameter of [**WM\_HELP**](wm-help.md) contains the address of a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure.</span></span> <span data-ttu-id="ae04a-277">Le membre **hItemHandle** de cette structure identifie le contrôle pour lequel l’utilisateur a demandé de l’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-277">The **hItemHandle** member of this structure identifies the control for which the user has requested help.</span></span> <span data-ttu-id="ae04a-278">Vous devez transmettre ce handle à la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) avec la commande help \_ WM \_ Help, le nom de votre fichier d’aide et un pointeur vers le tableau d’identificateurs.</span><span class="sxs-lookup"><span data-stu-id="ae04a-278">You must pass this handle to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function along with the HELP\_WM\_HELP command, the name of your help file, and a pointer to the array of identifiers.</span></span> <span data-ttu-id="ae04a-279">La fonction **WinHelp** recherche l’identificateur de contrôle du contrôle spécifié dans le tableau, puis récupère l’identificateur de contexte d’aide correspondant.</span><span class="sxs-lookup"><span data-stu-id="ae04a-279">The **WinHelp** function searches the array for the control identifier of the specified control and then retrieves the corresponding help context identifier.</span></span> <span data-ttu-id="ae04a-280">Ensuite, la fonction passe l’identificateur de contexte d’aide à l’aide de Windows, qui recherche la rubrique correspondante et l’affiche dans une fenêtre indépendante.</span><span class="sxs-lookup"><span data-stu-id="ae04a-280">Next, the function passes the help context identifier to Windows Help, which finds the corresponding topic and displays it in a pop-up window.</span></span> <span data-ttu-id="ae04a-281">Si le contrôle a un identificateur de-1, le système recherche le contrôle suivant qui est un taquet de tabulation, puis utilise son identificateur pour Rechercher l’identificateur de contexte d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-281">If the control has an identifier of -1, the system searches for the next control that is a tab stop and then uses its identifier to find the help context identifier.</span></span> <span data-ttu-id="ae04a-282">Pour cette raison, il est important de placer le texte statique avant les contrôles dans un fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="ae04a-282">For this reason, it is important that you place static text before controls in a resource file.</span></span>

<span data-ttu-id="ae04a-283">Lors de l’appel de la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , le traitement de [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md) est semblable au traitement de l' [**\_ aide WM**](wm-help.md) avec ces deux exceptions :</span><span class="sxs-lookup"><span data-stu-id="ae04a-283">When calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function, processing [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) is similar to processing [**WM\_HELP**](wm-help.md) with these two exceptions:</span></span>

-   <span data-ttu-id="ae04a-284">Vous transmettez le paramètre *wParam* à partir de [**WM \_ CONTEXTMENU**](../menurc/wm-contextmenu.md), qui est le handle du contrôle qui a envoyé le message.</span><span class="sxs-lookup"><span data-stu-id="ae04a-284">You pass the *wParam* parameter from [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md), which is the handle to the control that sent the message.</span></span>
-   <span data-ttu-id="ae04a-285">Vous spécifiez la commande **Help \_ CONTEXTMENU** au lieu de **Help \_ WM \_ Help**.</span><span class="sxs-lookup"><span data-stu-id="ae04a-285">You specify the **HELP\_CONTEXTMENU** command instead of **HELP\_WM\_HELP**.</span></span>

<span data-ttu-id="ae04a-286">La commande **Help \_ CONTEXTMENU** permet à l’aide de Windows d’afficher un menu avant d’afficher la rubrique d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-286">The **HELP\_CONTEXTMENU** command causes Windows Help to display a menu before it displays the help topic.</span></span> <span data-ttu-id="ae04a-287">Le menu est défini par le système.</span><span class="sxs-lookup"><span data-stu-id="ae04a-287">The menu is system-defined.</span></span> <span data-ttu-id="ae04a-288">Elle permet à l’utilisateur d’afficher de l’aide pour le contrôle ou d’afficher la boîte de dialogue **rubriques d’aide** .</span><span class="sxs-lookup"><span data-stu-id="ae04a-288">It allows the user to display help for the control or to display the **Help Topics** dialog box.</span></span>

<span data-ttu-id="ae04a-289">L’exemple suivant montre comment implémenter l’aide contextuelle dans une boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="ae04a-289">The following example shows how to implement context-sensitive help in a dialog box.</span></span>


```
LRESULT CALLBACK EditDlgProc(HWND hwndDlg, UINT uMsg, 
                             WPARAM wParam, LPARAM lParam) 
{ 
    // Create an array of control identifiers and context identifiers. 
    static DWORD aIds[ ] = 
    { 
        ID_SAVE,   IDH_SAVE, 
        ID_DELETE, IDH_DELETE, 
        ID_COPY,   IDH_COPY, 
        ID_PASTE,  IDH_PASTE, 
        0,0 
    }; 

    switch (uMsg) 
    { 
        case WM_HELP: 
            WinHelp(((LPHELPINFO)lParam)->hItemHandle, "helpfile.hlp", 
                    HELP_WM_HELP, (DWORD)(LPSTR)aIds); 
            break; 

        case WM_CONTEXTMENU: 
            WinHelp((HWND)wParam, "helpfile.hlp", HELP_CONTEXTMENU, 
                    (DWORD)(LPVOID)aIds); 
            break; 
        
        // Process other messages here. 
    } 
    return FALSE; 
}
```



### <a name="setting-the-appearance-of-a-secondary-help-window"></a><span data-ttu-id="ae04a-290">Définition de l’apparence d’une fenêtre d’aide secondaire</span><span class="sxs-lookup"><span data-stu-id="ae04a-290">Setting the Appearance of a Secondary Help Window</span></span>

<span data-ttu-id="ae04a-291">Une application peut définir la taille, la position et l’état d’affichage d’une fenêtre d’aide secondaire en passant la \_ commande help SETWINPOS et l’adresse d’une structure [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) à la fonction [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="ae04a-291">An application can set the size, position, and show state of a secondary help window by passing the HELP\_SETWINPOS command and the address of a [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) structure to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span> <span data-ttu-id="ae04a-292">Les membres de **HELPWININFO** spécifient le nom de la fenêtre à modifier et la nouvelle taille, la position et l’état de l’affichage de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="ae04a-292">The members of **HELPWININFO** specify the name of the window to change and the window's new size, position, and show state.</span></span>

<span data-ttu-id="ae04a-293">L’exemple suivant définit l’apparence d’une fenêtre secondaire nommée « WND \_ menu ».</span><span class="sxs-lookup"><span data-stu-id="ae04a-293">The following example sets the appearance of a secondary window named "wnd\_menu".</span></span> <span data-ttu-id="ae04a-294">Le nom doit être défini dans la \[ \] section Windows du fichier projet d’aide.</span><span class="sxs-lookup"><span data-stu-id="ae04a-294">The name must be defined in the \[WINDOWS\] section of the help project file.</span></span>


```
BOOL DoWindowSize(VOID) 
{ 
    HANDLE hhwi; 
    LPHELPWININFO lphwi; 
    WORD wSize; 
    char *szWndName = "wnd_menu"; 
    size_t NameLength;      // Does not include the terminating null character
    HRESULT hr
    BOOL retval;

    hr = StringCbLengthA(szWndName, STRSAFE_MAX_CCH, &NameLength);
    
    if (SUCCEEDED(hr))
    {
        // Add 1 to account for the name string's terminating null character.
        NameLength++;
        
        // The HELPWININFO structure contains a minimal TCHAR array of size [2] 
        // that is used for the window name. Since sizeof(HELPWININFO) 
        // includes those two TCHARS, they must be subtracted from the 
        // total when adding the actual string length to calculate the  
        // size of the structure. 
        wSize = sizeof(HELPWININFO) - 2 + NameLength; 
    }
    else
        // Something's amiss with the string.
        return FALSE;
        
    hhwi  = GlobalAlloc(GHND, wSize); 
    lphwi = (LPHELPWININFO)GlobalLock(hhwi); 

    lphwi->wStructSize = wSize; 
    lphwi->x    = 256;      // horizontal position 
    lphwi->y    = 256;      // vertical position 
    lphwi->dx   = 767;      // width 
    lphwi->dy   = 512;      // height 
    lphwi->wMax = SW_SHOW;  // show the window 
    
    // secondary window
    hr = StringCbCopyA(lphwi->rgchMember, sizeof(lphwi->rgchMember), szWndName);
    
    if (SUCCEEDED(hr))
    {
        WinHelp(hwnd, "myhelp.hlp", HELP_SETWINPOS, (DWORD)lphwi); 
     
        GlobalUnlock(hhwi); 
        GlobalFree(hhwi); 

        return TRUE; 
    }
    else
        // There was a problem copying the window name.
        return FALSE;
}
```



 

 
