---
description: Avant Windows Vista, vous avez créé un élément du panneau de configuration en créant un fichier. dll et en le nommant avec une extension. cpl.
ms.assetid: 258dae28-c054-4392-b0e9-99493f23c814
title: Utilisation de CPLApplet
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b1e59b29dd7c082822ed63d425dd4967a542b5d1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104973111"
---
# <a name="using-cplapplet"></a><span data-ttu-id="e5094-103">Utilisation de CPLApplet</span><span class="sxs-lookup"><span data-stu-id="e5094-103">Using CPLApplet</span></span>

<span data-ttu-id="e5094-104">Avant Windows Vista, vous avez créé un élément du panneau de configuration en créant un fichier. dll et en le nommant avec une extension. cpl.</span><span class="sxs-lookup"><span data-stu-id="e5094-104">Prior to Windows Vista, you created a Control Panel item by creating a .dll file and naming it with a .cpl extension.</span></span> <span data-ttu-id="e5094-105">Ce fichier a exporté la fonction [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) .</span><span class="sxs-lookup"><span data-stu-id="e5094-105">This file exported the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function.</span></span> <span data-ttu-id="e5094-106">Ce schéma est toujours pris en charge dans Windows Vista et les versions ultérieures et est abordé dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="e5094-106">This scheme is still supported in Windows Vista and later versions and is discussed in this topic.</span></span> <span data-ttu-id="e5094-107">Toutefois, les instructions pour les nouveaux éléments du panneau de configuration recommandent une approche plus simple avec l’élément du panneau de configuration créé comme un fichier. exe qui utilise une disposition de workflow de tâche.</span><span class="sxs-lookup"><span data-stu-id="e5094-107">However, the guidelines for new Control Panel items recommend a simpler approach with the Control Panel item built as a .exe file that uses a task flow layout.</span></span>

<span data-ttu-id="e5094-108">Lorsque le panneau de configuration charge un fichier. dll (ou. cpl), il appelle la fonction [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) pour obtenir des informations telles que le nombre d’éléments du panneau de configuration que le fichier héberge, ainsi que des informations sur chaque élément.</span><span class="sxs-lookup"><span data-stu-id="e5094-108">When Control Panel loads a .dll (or .cpl) file, it calls the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function to get information such as the number of Control Panel items the file hosts, as well as information about each item.</span></span> <span data-ttu-id="e5094-109">Le panneau de configuration appelle également la fonction lorsque la fenêtre de l’élément est initialisée, ouverte ou fermée.</span><span class="sxs-lookup"><span data-stu-id="e5094-109">Control Panel also calls the function when the item's window is initialized, opened, or closed.</span></span>

<span data-ttu-id="e5094-110">Lorsque Windows charge pour la première fois l’élément du panneau de configuration, il récupère l’adresse de la fonction [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) et utilise ensuite cette adresse pour appeler la fonction et lui transmettre des messages.</span><span class="sxs-lookup"><span data-stu-id="e5094-110">When Windows first loads the Control Panel item, it retrieves the address of the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function and subsequently uses that address to call the function and pass it messages.</span></span> <span data-ttu-id="e5094-111">Il peut envoyer les messages suivants.</span><span class="sxs-lookup"><span data-stu-id="e5094-111">It might send the following messages.</span></span>



| <span data-ttu-id="e5094-112">Message</span><span class="sxs-lookup"><span data-stu-id="e5094-112">Message</span></span>                                     | <span data-ttu-id="e5094-113">Description</span><span class="sxs-lookup"><span data-stu-id="e5094-113">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e5094-114">**\_DBLCLK cpl**</span><span class="sxs-lookup"><span data-stu-id="e5094-114">**CPL\_DBLCLK**</span></span>](cpl-dblclk.md)           | <span data-ttu-id="e5094-115">Envoyé pour notifier à [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que l’utilisateur a choisi l’icône associée à un élément de panneau de configuration donné.</span><span class="sxs-lookup"><span data-stu-id="e5094-115">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given Control Panel item.</span></span> <span data-ttu-id="e5094-116">**CPlApplet** doit afficher la boîte de dialogue pour l’élément spécifié et effectuer toutes les tâches spécifiées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e5094-116">**CPlApplet** should display the dialog box for the specified item and carry out any user-specified tasks.</span></span> <span data-ttu-id="e5094-117">Le paramètre **CPlApplet** *lParam1* est un entier qui représente l’index de base zéro de l’élément du panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="e5094-117">The **CPlApplet** *lParam1* parameter is an integer that represents the zero-based index of the Control Panel item.</span></span> <span data-ttu-id="e5094-118">Le *paramètre lParam2* est le pointeur **lpData** retourné dans la structure [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) ou [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) dans le message [**Cpl \_ inquire**](cpl-inquire.md) ou [**Cpl \_ NEWINQUIRE**](cpl-newinquire.md) .</span><span class="sxs-lookup"><span data-stu-id="e5094-118">The *lParam2* parameter is the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="e5094-119">La valeur de retour est ignorée.</span><span class="sxs-lookup"><span data-stu-id="e5094-119">The return value is ignored.</span></span>                                                                |
| [<span data-ttu-id="e5094-120">**fermeture de CPL \_**</span><span class="sxs-lookup"><span data-stu-id="e5094-120">**CPL\_EXIT**</span></span>](cpl-exit.md)               | <span data-ttu-id="e5094-121">Envoyé après le dernier \_ message d’arrêt de cpl et immédiatement avant que Windows utilise la fonction [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) pour libérer la dll qui contient l’élément du panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="e5094-121">Sent after the last CPL\_STOP message and immediately before Windows uses the [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) function to free the DLL that contains the Control Panel item.</span></span> <span data-ttu-id="e5094-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) doit libérer la mémoire restante et préparer la fermeture.</span><span class="sxs-lookup"><span data-stu-id="e5094-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any remaining memory and prepare to close.</span></span> <span data-ttu-id="e5094-123">La valeur de retour est ignorée.</span><span class="sxs-lookup"><span data-stu-id="e5094-123">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="e5094-124">**CPL \_ GETCOUNT**</span><span class="sxs-lookup"><span data-stu-id="e5094-124">**CPL\_GETCOUNT**</span></span>](cpl-getcount.md)       | <span data-ttu-id="e5094-125">Envoyé après le \_ message d’initialisation de CPL pour inviter [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) à retourner un nombre qui indique le nombre de sous-programmes qu’il prend en charge.</span><span class="sxs-lookup"><span data-stu-id="e5094-125">Sent after the CPL\_INIT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to return a number that indicates how many subprograms it supports.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="e5094-126">**\_init cpl**</span><span class="sxs-lookup"><span data-stu-id="e5094-126">**CPL\_INIT**</span></span>](cpl-init.md)               | <span data-ttu-id="e5094-127">Envoyé immédiatement après le chargement de la DLL qui contient l’élément du panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="e5094-127">Sent immediately after the DLL that contains the Control Panel item is loaded.</span></span> <span data-ttu-id="e5094-128">Le message invite [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) à effectuer des procédures d’initialisation, y compris l’allocation de mémoire.</span><span class="sxs-lookup"><span data-stu-id="e5094-128">The message prompts [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to perform initialization procedures, including memory allocation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="e5094-129">**Rechercher dans CPL \_**</span><span class="sxs-lookup"><span data-stu-id="e5094-129">**CPL\_INQUIRE**</span></span>](cpl-inquire.md)         | <span data-ttu-id="e5094-130">Envoyé après le \_ message Cpl GETCOUNT pour inviter [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) à fournir des informations sur un sous-programme spécifié.</span><span class="sxs-lookup"><span data-stu-id="e5094-130">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified subprogram.</span></span> <span data-ttu-id="e5094-131">La valeur *lParam1* est un entier qui représente l’index de base zéro du sous-programme sur les informations demandées.</span><span class="sxs-lookup"><span data-stu-id="e5094-131">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="e5094-132">Le paramètre *lParam2* de **CPlApplet** pointe vers une structure [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) .</span><span class="sxs-lookup"><span data-stu-id="e5094-132">The *lParam2* parameter of **CPlApplet** points to a [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) structure.</span></span> <span data-ttu-id="e5094-133">La valeur de retour est ignorée.</span><span class="sxs-lookup"><span data-stu-id="e5094-133">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="e5094-134">**\_NEWINQUIRE cpl**</span><span class="sxs-lookup"><span data-stu-id="e5094-134">**CPL\_NEWINQUIRE**</span></span>](cpl-newinquire.md)   | <span data-ttu-id="e5094-135">Envoyé après le \_ message Cpl GETCOUNT pour inviter [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) à fournir des informations sur un élément du panneau de configuration spécifié.</span><span class="sxs-lookup"><span data-stu-id="e5094-135">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified Control Panel item.</span></span> <span data-ttu-id="e5094-136">La valeur *lParam1* est un entier qui représente l’index de base zéro du sous-programme sur les informations demandées.</span><span class="sxs-lookup"><span data-stu-id="e5094-136">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="e5094-137">Le paramètre *lParam2* est un pointeur vers une structure [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) .</span><span class="sxs-lookup"><span data-stu-id="e5094-137">The *lParam2* parameter is a pointer to a [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure.</span></span> <span data-ttu-id="e5094-138">La \_ NEWINQUIRE de cpl doit normalement être ignorée.</span><span class="sxs-lookup"><span data-stu-id="e5094-138">CPL\_NEWINQUIRE normally should be ignored.</span></span> <span data-ttu-id="e5094-139">Votre application doit traiter uniquement les \_ recherches de cpl sur Windows 95, Microsoft Windows NT 4,0 et les systèmes ultérieurs, car les performances du panneau de configuration sont affectées par l’utilisation de cpl \_ NEWINQUIRE.</span><span class="sxs-lookup"><span data-stu-id="e5094-139">Your application should process only CPL\_INQUIRE on Windows 95, Microsoft Windows NT 4.0, and later systems since Control Panel performance suffers when CPL\_NEWINQUIRE is used.</span></span> <span data-ttu-id="e5094-140">Cela est dû au fait que les chaînes et les icônes retournées ne peuvent pas être mises en cache.</span><span class="sxs-lookup"><span data-stu-id="e5094-140">This is because the returned strings and icons cannot be cached.</span></span> <span data-ttu-id="e5094-141">La valeur de retour est ignorée.</span><span class="sxs-lookup"><span data-stu-id="e5094-141">The return value is ignored.</span></span> |
| [<span data-ttu-id="e5094-142">**CPL \_ Sélectionner**</span><span class="sxs-lookup"><span data-stu-id="e5094-142">**CPL\_SELECT**</span></span>](cpl-select.md)           | <span data-ttu-id="e5094-143">Obsolète.</span><span class="sxs-lookup"><span data-stu-id="e5094-143">Obsolete.</span></span> <span data-ttu-id="e5094-144">Les versions actuelles de Windows n’envoient pas ce message.</span><span class="sxs-lookup"><span data-stu-id="e5094-144">Current versions of Windows do not send this message.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="e5094-145">**\_STARTWPARMS cpl**</span><span class="sxs-lookup"><span data-stu-id="e5094-145">**CPL\_STARTWPARMS**</span></span>](cpl-startwparms.md) | <span data-ttu-id="e5094-146">Envoyé pour notifier à [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que l’utilisateur a choisi l’icône associée à une boîte de dialogue donnée.</span><span class="sxs-lookup"><span data-stu-id="e5094-146">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given dialog box.</span></span> <span data-ttu-id="e5094-147">**CPlApplet** doit afficher la boîte de dialogue correspondante et effectuer toutes les tâches spécifiées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e5094-147">**CPlApplet** should display the corresponding dialog box and carry out any user-specified tasks.</span></span> <span data-ttu-id="e5094-148">Ce message est similaire à CPL \_ DBLCLK, mais il peut y avoir des informations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="e5094-148">This message is similar to CPL\_DBLCLK, but there might be some additional information.</span></span> <span data-ttu-id="e5094-149">Le paramètre *lParam1* est le numéro d’élément du panneau de configuration et *LParam2* est un **LPCTSTR** à toute direction supplémentaire qui peut être nécessaire.</span><span class="sxs-lookup"><span data-stu-id="e5094-149">The *lParam1* parameter is the Control Panel item number and *lParam2* is an **LPCTSTR** to any extra directions that might be necessary.</span></span> <span data-ttu-id="e5094-150">Retourne la **valeur true** si ce message est géré ; Sinon, **false**.</span><span class="sxs-lookup"><span data-stu-id="e5094-150">Return **TRUE** if this message is handled; otherwise, **FALSE**.</span></span> <span data-ttu-id="e5094-151">Ce message est valide pour la [version 5,00](versions.md) et les versions ultérieures de Shell32.dll.</span><span class="sxs-lookup"><span data-stu-id="e5094-151">This message is valid for [version 5.00](versions.md) and later of Shell32.dll.</span></span>                                                                                         |
| [<span data-ttu-id="e5094-152">**arrêt de CPL \_**</span><span class="sxs-lookup"><span data-stu-id="e5094-152">**CPL\_STOP**</span></span>](cpl-stop.md)               | <span data-ttu-id="e5094-153">Envoyé une fois pour chaque élément du panneau de configuration dans le fichier. cpl avant que Windows ne décharge l’extension du panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="e5094-153">Sent once for each Control Panel item in the .cpl file before Windows unloads the Control Panel extension.</span></span> <span data-ttu-id="e5094-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) doit libérer toute mémoire associée au numéro d’élément fourni dans *lParam1*.</span><span class="sxs-lookup"><span data-stu-id="e5094-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any memory associated with the item number provided in *lParam1*.</span></span> <span data-ttu-id="e5094-155">Le paramètre *lParam2* est un pointeur **lpData** retourné dans la structure [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) ou [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) dans le message [**Cpl \_ inquire**](cpl-inquire.md) ou [**Cpl \_ NEWINQUIRE**](cpl-newinquire.md) .</span><span class="sxs-lookup"><span data-stu-id="e5094-155">The *lParam2* parameter is **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="e5094-156">La valeur de retour est ignorée.</span><span class="sxs-lookup"><span data-stu-id="e5094-156">The return value is ignored.</span></span>                                                                                                                                                                                                       |



 

## <a name="related-topics"></a><span data-ttu-id="e5094-157">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e5094-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e5094-158">Éléments du panneau de configuration</span><span class="sxs-lookup"><span data-stu-id="e5094-158">Control Panel Items</span></span>](control-panel-applications.md)
</dt> <dt>

[<span data-ttu-id="e5094-159">Conseils sur l’expérience utilisateur</span><span class="sxs-lookup"><span data-stu-id="e5094-159">User Experience Guidelines</span></span>](user-experience-guidelines.md)
</dt> <dt>

[<span data-ttu-id="e5094-160">Inscription des éléments du panneau de configuration</span><span class="sxs-lookup"><span data-stu-id="e5094-160">Registering Control Panel Items</span></span>](registering-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="e5094-161">Traitement des messages du panneau de configuration</span><span class="sxs-lookup"><span data-stu-id="e5094-161">Control Panel Message Processing</span></span>](message-processing.md)
</dt> <dt>

[<span data-ttu-id="e5094-162">Exécution des éléments du panneau de configuration</span><span class="sxs-lookup"><span data-stu-id="e5094-162">Executing Control Panel Items</span></span>](executing-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="e5094-163">Extension des éléments du panneau de configuration système</span><span class="sxs-lookup"><span data-stu-id="e5094-163">Extending System Control Panel Items</span></span>](extending-system-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="e5094-164">Affectation des catégories du panneau de configuration</span><span class="sxs-lookup"><span data-stu-id="e5094-164">Assigning Control Panel Categories</span></span>](assigning-control-panel-categories.md)
</dt> <dt>

[<span data-ttu-id="e5094-165">Création de liens de tâches pouvant faire l’objet d’une recherche pour un élément du panneau de configuration</span><span class="sxs-lookup"><span data-stu-id="e5094-165">Creating Searchable Task Links for a Control Panel Item</span></span>](creating-searchable-task-links.md)
</dt> <dt>

[<span data-ttu-id="e5094-166">Accès au panneau de configuration en mode sans échec sous Windows Vista</span><span class="sxs-lookup"><span data-stu-id="e5094-166">Accessing the Control Panel in Safe Mode under Windows Vista</span></span>](accessing-the-cp-in-safe-mode-under-vista.md)
</dt> </dl>

 

 
