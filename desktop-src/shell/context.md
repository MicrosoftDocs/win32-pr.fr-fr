---
description: Le fait de cliquer avec le bouton droit sur un objet entraîne normalement l’affichage d’un menu contextuel. Ce menu contient une liste de commandes que l’utilisateur peut sélectionner pour effectuer diverses actions sur l’objet. Cette section est une présentation des menus contextuels pour les objets de système de fichiers.
ms.assetid: d951d1e8-0f88-49c4-8373-e6db0e18cd72
title: Extension des menus contextuels
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 895550ff050d559b3523676ddaa2a58099398a97
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104571212"
---
# <a name="extending-shortcut-menus"></a><span data-ttu-id="5d6ff-105">Extension des menus contextuels</span><span class="sxs-lookup"><span data-stu-id="5d6ff-105">Extending Shortcut Menus</span></span>

<span data-ttu-id="5d6ff-106">Le fait de cliquer avec le bouton droit sur un objet entraîne normalement l’affichage d’un *menu contextuel*.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-106">Right-clicking an object normally causes the display of a *shortcut menu*.</span></span> <span data-ttu-id="5d6ff-107">Ce menu contient une liste de commandes que l’utilisateur peut sélectionner pour effectuer diverses actions sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-107">This menu contains a list of commands that the user can select to perform various actions on the object.</span></span> <span data-ttu-id="5d6ff-108">Cette section est une présentation des menus contextuels pour les objets de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-108">This section is an introduction to shortcut menus for file system objects.</span></span>

-   [<span data-ttu-id="5d6ff-109">Menus contextuels pour les objets de système de fichiers</span><span class="sxs-lookup"><span data-stu-id="5d6ff-109">Shortcut Menus for File System Objects</span></span>](#shortcut-menus-for-file-system-objects)
-   [<span data-ttu-id="5d6ff-110">Verbes de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="5d6ff-110">Shortcut Menu Verbs</span></span>](#shortcut-menu-verbs)
    -   [<span data-ttu-id="5d6ff-111">Verbes canoniques</span><span class="sxs-lookup"><span data-stu-id="5d6ff-111">Canonical Verbs</span></span>](#canonical-verbs)
    -   [<span data-ttu-id="5d6ff-112">Verbes étendus</span><span class="sxs-lookup"><span data-stu-id="5d6ff-112">Extended Verbs</span></span>](#extended-verbs)
-   [<span data-ttu-id="5d6ff-113">Extension du menu contextuel d’un type de fichier</span><span class="sxs-lookup"><span data-stu-id="5d6ff-113">Extending the Shortcut Menu for a File Type</span></span>](#extending-the-shortcut-menu-for-a-file-type)
-   [<span data-ttu-id="5d6ff-114">Extension du menu contextuel pour les objets Shell prédéfinis</span><span class="sxs-lookup"><span data-stu-id="5d6ff-114">Extending the Shortcut Menu for Predefined Shell Objects</span></span>](#extending-the-shortcut-menu-for-predefined-shell-objects)
-   [<span data-ttu-id="5d6ff-115">Inscription d’une application pour gérer des types de fichiers arbitraires</span><span class="sxs-lookup"><span data-stu-id="5d6ff-115">Registering an Application to Handle Arbitrary File Types</span></span>](#registering-an-application-to-handle-arbitrary-file-types)
-   [<span data-ttu-id="5d6ff-116">Extension du nouveau sous-menu</span><span class="sxs-lookup"><span data-stu-id="5d6ff-116">Extending the New Submenu</span></span>](#extending-the-new-submenu)

<span data-ttu-id="5d6ff-117">Des informations supplémentaires sont disponibles ici :</span><span class="sxs-lookup"><span data-stu-id="5d6ff-117">Additional information is available here:</span></span>

-   [<span data-ttu-id="5d6ff-118">Comment définir des verbes étendus</span><span class="sxs-lookup"><span data-stu-id="5d6ff-118">How To Define Extended Verbs</span></span>](how-to-define-extended-verbs.md)
-   [<span data-ttu-id="5d6ff-119">Comment associer des verbes à des commandes DDE</span><span class="sxs-lookup"><span data-stu-id="5d6ff-119">How To Associate Verbs with DDE Commands</span></span>](how-to-associate-verbs-with-dde-commands.md)

## <a name="shortcut-menus-for-file-system-objects"></a><span data-ttu-id="5d6ff-120">Menus contextuels pour les objets de système de fichiers</span><span class="sxs-lookup"><span data-stu-id="5d6ff-120">Shortcut Menus for File System Objects</span></span>

<span data-ttu-id="5d6ff-121">Quand un utilisateur clique avec le bouton droit sur un objet, tel qu’un fichier, qui est affiché dans l’Explorateur Windows ou sur le bureau, un menu contextuel s’affiche avec une liste de commandes.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-121">When a user right-clicks an object, such as a file, that is displayed in Windows Explorer or on the desktop, a shortcut menu appears with a list of commands.</span></span> <span data-ttu-id="5d6ff-122">L’utilisateur peut ensuite exécuter une action sur le fichier, par exemple l’ouvrir ou le supprimer, en sélectionnant la commande appropriée.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-122">The user can then perform an action on the file, such as opening or deleting it, by selecting the appropriate command.</span></span>

<span data-ttu-id="5d6ff-123">Comme les menus contextuels sont souvent utilisés pour la gestion des fichiers, l’interpréteur de commandes fournit un ensemble de commandes par défaut, telles que couper et copier, qui apparaissent dans le menu contextuel de n’importe quel fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-123">Because shortcut menus are often used for file management, the Shell provides a set of default commands, such as Cut and Copy, that appear on the shortcut menu for any file.</span></span> <span data-ttu-id="5d6ff-124">Notez que même si Open with est une commande par défaut, il n’est pas affiché pour certains types de fichiers standard, tels que. wav.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-124">Note that although Open With is a default command, it is not displayed for some standard file types, such as .wav.</span></span> <span data-ttu-id="5d6ff-125">L’illustration suivante de l’exemple de répertoire My documents, également utilisé comme exemple dans personnalisation des [icônes](icon.md), affiche un menu contextuel par défaut qui s’affichait en cliquant avec le bouton droit sur MyDocs4.xyz.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-125">The following illustration of the sample My Documents directory, which was also used as an example in [Customizing Icons](icon.md), shows a default shortcut menu that was displayed by right-clicking MyDocs4.xyz.</span></span>

![capture d’écran du menu contextuel par défaut pour les objets du système de fichiers](images/context1.jpg)

<span data-ttu-id="5d6ff-127">La raison pour laquelle MyDocs4.xyz affiche un menu contextuel par défaut est qu’il n’est pas membre d’un [type de fichier](fa-file-types.md)inscrit.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-127">The reason that MyDocs4.xyz shows a default shortcut menu is that it is not a member of a registered [file type](fa-file-types.md).</span></span> <span data-ttu-id="5d6ff-128">En revanche,. txt est un type de fichier inscrit.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-128">On the other hand, .txt is a registered file type.</span></span> <span data-ttu-id="5d6ff-129">Si vous cliquez avec le bouton droit sur l’un des fichiers. txt, vous verrez à la place un menu contextuel avec deux commandes supplémentaires dans sa section supérieure : **ouvrir** et **Imprimer**.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-129">If you right-click one of the .txt files, you will instead see a shortcut menu with two additional commands in its upper section: **Open** and **Print**.</span></span>

![capture d’écran du menu contextuel personnalisé pour les objets du système de fichiers](images/context2.jpg)

<span data-ttu-id="5d6ff-131">Une fois qu’un type de fichier est inscrit, vous pouvez étendre son menu contextuel avec des commandes supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-131">Once a file type is registered, you can extend its shortcut menu with additional commands.</span></span> <span data-ttu-id="5d6ff-132">Ils s’affichent au-dessus des commandes par défaut lorsqu’un utilisateur clique avec le bouton droit sur un fichier de ce type.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-132">They are displayed above the default commands when any file of that type is right-clicked.</span></span> <span data-ttu-id="5d6ff-133">Bien que la plupart des commandes ajoutées de cette manière soient courantes, telles que **Print** ou **Open**, vous êtes libre d’ajouter les commandes qu’un utilisateur peut trouver utiles.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-133">Although most of the commands added in this way are common ones, such as **Print** or **Open**, you are free to add any command that a user might find helpful.</span></span>

<span data-ttu-id="5d6ff-134">Tout ce qui est nécessaire pour étendre le menu contextuel d’un type de fichier consiste à créer une entrée de Registre pour chaque commande.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-134">All that is required to extend the shortcut menu for a file type is to create a registry entry for each command.</span></span> <span data-ttu-id="5d6ff-135">Une approche plus sophistiquée consiste à implémenter un *Gestionnaire de menu contextuel*, qui vous permet d’étendre le menu contextuel pour un type de fichier fichier par fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-135">A more sophisticated approach is to implement a *shortcut menu handler*, which allows you to extend the shortcut menu for a file type on a file-by-file basis.</span></span> <span data-ttu-id="5d6ff-136">Pour plus d’informations, consultez [création de gestionnaires de menus contextuels](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="5d6ff-136">For more information, see [Creating Context Menu Handlers](context-menu-handlers.md).</span></span>

## <a name="shortcut-menu-verbs"></a><span data-ttu-id="5d6ff-137">Verbes de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="5d6ff-137">Shortcut Menu Verbs</span></span>

<span data-ttu-id="5d6ff-138">Chaque commande du menu contextuel est identifiée dans le registre par son *verbe*.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-138">Each command on the shortcut menu is identified in the registry by its *verb*.</span></span> <span data-ttu-id="5d6ff-139">Ces verbes sont les mêmes que ceux utilisés par [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) lors du lancement d’applications par programme.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-139">These verbs are the same as those used by [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) when launching applications programmatically.</span></span> <span data-ttu-id="5d6ff-140">Pour plus d’informations sur l’utilisation de **ShellExecuteEx**, consultez la discussion dans [lancement d’applications](launch.md).</span><span class="sxs-lookup"><span data-stu-id="5d6ff-140">For further information about the use of **ShellExecuteEx**, see the discussion in [Launching Applications](launch.md).</span></span>

<span data-ttu-id="5d6ff-141">Un verbe est une chaîne de texte simple qui est utilisée par l’interpréteur de commandes pour identifier la commande associée.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-141">A verb is a simple text string that is used by the Shell to identify the associated command.</span></span> <span data-ttu-id="5d6ff-142">Chaque verbe correspond à la *chaîne de commande* utilisée pour lancer la commande dans une fenêtre de console ou un fichier de commandes (. bat).</span><span class="sxs-lookup"><span data-stu-id="5d6ff-142">Each verb corresponds to the *command string* used to launch the command in a console window or batch (.bat) file.</span></span> <span data-ttu-id="5d6ff-143">Par exemple, le verbe **Open** lance normalement un programme pour ouvrir un fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-143">For example, the **open** verb normally launches a program to open a file.</span></span> <span data-ttu-id="5d6ff-144">Sa chaîne de commande se présente généralement comme suit :</span><span class="sxs-lookup"><span data-stu-id="5d6ff-144">Its command string typically looks something like this:</span></span>

``` syntax
"My Program.exe" "%1"
```

<span data-ttu-id="5d6ff-145">« %1 » est l’espace réservé standard pour un paramètre de ligne de commande fourni avec le nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-145">"%1" is the standard placeholder for a command line parameter provided with the filename.</span></span> <span data-ttu-id="5d6ff-146">Par exemple, il peut spécifier une page particulière à afficher dans une vue à onglets.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-146">For instance, it can specify a particular page to display in a tabbed view.</span></span>

> [!Note]  
> <span data-ttu-id="5d6ff-147">Si un élément de la chaîne de commande contient ou peut contenir des espaces, il doit être placé entre guillemets.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-147">If any element of the command string contains or might contain spaces, it must be enclosed in quotation marks.</span></span> <span data-ttu-id="5d6ff-148">Sinon, si l’élément contient un espace, il ne sera pas analysé correctement.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-148">Otherwise, if the element contains a space, it will not parse correctly.</span></span> <span data-ttu-id="5d6ff-149">Par exemple, « My Program.exe » lance l’application correctement.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-149">For instance, "My Program.exe" will launch the application properly.</span></span> <span data-ttu-id="5d6ff-150">Si vous utilisez mon Program.exe, le système tente de lancer « My » avec « Program.exe » comme premier argument de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-150">If you use My Program.exe, the system will attempt to launch "My" with "Program.exe" as its first command line argument.</span></span> <span data-ttu-id="5d6ff-151">Vous devez toujours utiliser des guillemets avec des arguments tels que « %1 » développés pour les chaînes par l’interpréteur de commandes, car vous ne pouvez pas être certain que la chaîne ne contiendra pas d’espace.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-151">You should always use quotation marks with arguments such as "%1" that are expanded to strings by the Shell, because you cannot be certain that the string will not contain a space.</span></span>

 

<span data-ttu-id="5d6ff-152">Les verbes peuvent également être associés à une *chaîne d’affichage* , qui est affichée dans le menu contextuel au lieu de la chaîne de verbe elle-même.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-152">Verbs can also have a *display string* associated with them, which is displayed on the shortcut menu instead of the verb string itself.</span></span> <span data-ttu-id="5d6ff-153">Par exemple, la chaîne d’affichage pour **openas** est ouverte avec.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-153">For example, the display string for **openas** is Open With.</span></span> <span data-ttu-id="5d6ff-154">Comme les chaînes de menu normales, y compris une esperluette (&) dans la chaîne d’affichage, permet de sélectionner le clavier de la commande.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-154">Like normal menu strings, including an ampersand (&) in the display string allows keyboard selection of the command.</span></span>

### <a name="canonical-verbs"></a><span data-ttu-id="5d6ff-155">Verbes canoniques</span><span class="sxs-lookup"><span data-stu-id="5d6ff-155">Canonical Verbs</span></span>

<span data-ttu-id="5d6ff-156">En général, les applications sont chargées de fournir des chaînes d’affichage localisées pour les verbes qu’elles définissent.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-156">In general, applications are responsible for providing localized display strings for the verbs they define.</span></span> <span data-ttu-id="5d6ff-157">Toutefois, pour fournir un degré d’indépendance du langage, le système définit un ensemble standard de verbes couramment utilisés appelés *verbes canoniques*.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-157">However, to provide a degree of language independence, the system defines a standard set of commonly used verbs called *canonical verbs*.</span></span> <span data-ttu-id="5d6ff-158">Un verbe canonique peut être utilisé avec n’importe quel langage et le système génère automatiquement une chaîne d’affichage correctement localisée.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-158">A canonical verb can be used with any language, and the system automatically generates a properly localized display string.</span></span> <span data-ttu-id="5d6ff-159">Par exemple, la chaîne d’affichage du verbe **Open** sera définie sur Open sur un système en anglais et öffnen sur un système allemand.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-159">For instance, the **open** verb's display string will be set to Open on an English system, and to Öffnen on a German system.</span></span>

<span data-ttu-id="5d6ff-160">Les verbes canoniques sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="5d6ff-160">The canonical verbs include:</span></span>



| <span data-ttu-id="5d6ff-161">Valeur</span><span class="sxs-lookup"><span data-stu-id="5d6ff-161">Value</span></span>      | <span data-ttu-id="5d6ff-162">Description</span><span class="sxs-lookup"><span data-stu-id="5d6ff-162">Description</span></span>                                                                                 |
|------------|---------------------------------------------------------------------------------------------|
| <span data-ttu-id="5d6ff-163">ouvert</span><span class="sxs-lookup"><span data-stu-id="5d6ff-163">open</span></span>       | <span data-ttu-id="5d6ff-164">Ouvre le fichier ou le dossier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-164">Opens the file or folder.</span></span>                                                                   |
| <span data-ttu-id="5d6ff-165">opennew</span><span class="sxs-lookup"><span data-stu-id="5d6ff-165">opennew</span></span>    | <span data-ttu-id="5d6ff-166">Ouvre le fichier ou le dossier dans une nouvelle fenêtre.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-166">Opens the file or folder in a new window.</span></span>                                                   |
| <span data-ttu-id="5d6ff-167">print</span><span class="sxs-lookup"><span data-stu-id="5d6ff-167">print</span></span>      | <span data-ttu-id="5d6ff-168">Imprime le fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-168">Prints the file.</span></span>                                                                            |
| <span data-ttu-id="5d6ff-169">explorer</span><span class="sxs-lookup"><span data-stu-id="5d6ff-169">explore</span></span>    | <span data-ttu-id="5d6ff-170">Ouvre l’Explorateur Windows avec le dossier sélectionné.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-170">Opens Windows Explorer with the folder selected.</span></span>                                            |
| <span data-ttu-id="5d6ff-171">trouver</span><span class="sxs-lookup"><span data-stu-id="5d6ff-171">find</span></span>       | <span data-ttu-id="5d6ff-172">Ouvre la boîte de dialogue **Recherche Windows** avec le dossier défini comme emplacement de recherche par défaut.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-172">Opens the **Windows Search** dialog box with the folder set as the default search location.</span></span> |
| <span data-ttu-id="5d6ff-173">ouvertes</span><span class="sxs-lookup"><span data-stu-id="5d6ff-173">openas</span></span>     | <span data-ttu-id="5d6ff-174">Ouvre la boîte **de dialogue Ouvrir avec** .</span><span class="sxs-lookup"><span data-stu-id="5d6ff-174">Opens the **Open With** dialog box.</span></span>                                                         |
| <span data-ttu-id="5d6ff-175">properties</span><span class="sxs-lookup"><span data-stu-id="5d6ff-175">properties</span></span> | <span data-ttu-id="5d6ff-176">Ouvre la feuille de propriétés de l’objet.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-176">Opens the object's property sheet.</span></span>                                                          |



 

<span data-ttu-id="5d6ff-177">Le verbe Printto est également canonique, mais n’est jamais affiché.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-177">The printto verb is also canonical but is never displayed.</span></span> <span data-ttu-id="5d6ff-178">Elle permet à l’utilisateur d’imprimer un fichier en le faisant glisser vers un objet Printer.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-178">It allows the user to print a file by dragging it to a printer object.</span></span>

### <a name="extended-verbs"></a><span data-ttu-id="5d6ff-179">Verbes étendus</span><span class="sxs-lookup"><span data-stu-id="5d6ff-179">Extended Verbs</span></span>

<span data-ttu-id="5d6ff-180">Quand l’utilisateur clique avec le bouton droit sur un objet, le menu contextuel contient tous les verbes normaux.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-180">When the user right-clicks an object, the shortcut menu contains all the normal verbs.</span></span> <span data-ttu-id="5d6ff-181">Toutefois, il peut y avoir des commandes que vous souhaitez prendre en charge mais qui n’ont pas été affichées dans chaque menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-181">However, there could be commands that you want to support but not have displayed on every shortcut menu.</span></span> <span data-ttu-id="5d6ff-182">Par exemple, vous pouvez avoir des commandes qui ne sont pas couramment utilisées ou qui sont destinées à des utilisateurs expérimentés.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-182">For example, you could have commands that are not commonly used or that are intended for experienced users.</span></span> <span data-ttu-id="5d6ff-183">Pour cette raison, vous pouvez également définir un ou plusieurs *verbes étendus*.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-183">For this reason, you can also define one or more *extended verbs*.</span></span> <span data-ttu-id="5d6ff-184">Ces verbes sont également des chaînes de caractères et sont similaires aux verbes normaux.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-184">These verbs are also character strings and are similar to normal verbs.</span></span> <span data-ttu-id="5d6ff-185">Ils se distinguent des verbes normaux par leur mode d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-185">They are distinguished from normal verbs by the way they are registered.</span></span> <span data-ttu-id="5d6ff-186">Pour accéder aux commandes associées à des verbes étendus, l’utilisateur doit cliquer avec le bouton droit sur un objet tout en appuyant sur la touche Maj.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-186">To have access to the commands associated with extended verbs, the user must right-click an object while pressing the SHIFT key.</span></span> <span data-ttu-id="5d6ff-187">Les verbes étendus s’affichent alors en même temps que les verbes normaux.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-187">The extended verbs will then be displayed along with the normal verbs.</span></span>

## <a name="extending-the-shortcut-menu-for-a-file-type"></a><span data-ttu-id="5d6ff-188">Extension du menu contextuel d’un type de fichier</span><span class="sxs-lookup"><span data-stu-id="5d6ff-188">Extending the Shortcut Menu for a File Type</span></span>

<span data-ttu-id="5d6ff-189">Le moyen le plus simple d’étendre le menu contextuel pour un type de fichier est d’utiliser le registre.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-189">The simplest way to extend the shortcut menu for a file type is with the registry.</span></span> <span data-ttu-id="5d6ff-190">Pour ce faire, ajoutez une sous-clé **Shell** sous la clé pour le ProgID de l’application associée au [type de fichier](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="5d6ff-190">To do this, add a **Shell** subkey below the key for the ProgID of the application associated with the [file type](fa-file-types.md).</span></span> <span data-ttu-id="5d6ff-191">Si vous le souhaitez, vous pouvez définir un *verbe par défaut* pour le type de fichier en en faisant la valeur par défaut de la sous-clé **Shell** .</span><span class="sxs-lookup"><span data-stu-id="5d6ff-191">Optionally, you can define a *default verb* for the file type by making it the default value of the **Shell** subkey.</span></span>

<span data-ttu-id="5d6ff-192">Le verbe par défaut s’affiche en premier dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-192">The default verb is displayed first on the shortcut menu.</span></span> <span data-ttu-id="5d6ff-193">Son objectif est de fournir à l’interpréteur de commandes un verbe qu’il peut utiliser lorsque [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) est appelé, mais qu’aucun verbe n’est spécifié.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-193">Its purpose is to provide the Shell with a verb it can use when [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) is called but no verb is specified.</span></span> <span data-ttu-id="5d6ff-194">L’interpréteur de commandes ne sélectionne pas nécessairement le verbe par défaut lorsque **ShellExecuteEx** est utilisé de cette manière.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-194">The Shell does not necessarily select the default verb when **ShellExecuteEx** is used in this fashion.</span></span> <span data-ttu-id="5d6ff-195">Pour les [versions](versions.md) de Shell 5,0 et ultérieures, détectées sur les systèmes Windows 2000 et versions ultérieures, l’interpréteur de commandes utilise le premier verbe disponible de la liste suivante.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-195">For Shell [versions 5.0](versions.md) and later, found on Windows 2000 and later systems, the Shell uses the first available verb from the following list.</span></span> <span data-ttu-id="5d6ff-196">Si aucun n’est disponible, l’opération échoue.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-196">If none are available, the operation fails.</span></span>

-   <span data-ttu-id="5d6ff-197">Verbe Open</span><span class="sxs-lookup"><span data-stu-id="5d6ff-197">The open verb</span></span>
-   <span data-ttu-id="5d6ff-198">Le verbe par défaut</span><span class="sxs-lookup"><span data-stu-id="5d6ff-198">The default verb</span></span>
-   <span data-ttu-id="5d6ff-199">Premier verbe dans le registre</span><span class="sxs-lookup"><span data-stu-id="5d6ff-199">The first verb in the registry</span></span>
-   <span data-ttu-id="5d6ff-200">Le verbe openWith</span><span class="sxs-lookup"><span data-stu-id="5d6ff-200">The openwith verb</span></span>

<span data-ttu-id="5d6ff-201">Pour les versions de Shell antérieures à la [version 5,0](versions.md), omettez le troisième élément.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-201">For Shell versions prior to [version 5.0](versions.md), omit the third item.</span></span>

<span data-ttu-id="5d6ff-202">Sous la sous-clé **Shell** , créez une sous-clé pour chaque verbe que vous souhaitez ajouter.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-202">Below the **Shell** subkey, create one subkey for each verb you want to add.</span></span> <span data-ttu-id="5d6ff-203">Chacune de ces sous-clés aura une valeur **reg \_ SZ** définie sur la chaîne d’affichage du verbe.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-203">Each of these subkeys will have a **REG\_SZ** value set to the verb's display string.</span></span> <span data-ttu-id="5d6ff-204">Vous pouvez omettre la chaîne d’affichage pour les verbes canoniques, car le système affichera automatiquement une chaîne correctement localisée.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-204">You can omit the display string for canonical verbs because the system will automatically display a properly localized string.</span></span> <span data-ttu-id="5d6ff-205">Si vous omettez la chaîne d’affichage pour les verbes qui ne sont pas Canon, la chaîne de verbes s’affiche.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-205">If you omit the display string for noncanonical verbs, the verb string will be displayed.</span></span> <span data-ttu-id="5d6ff-206">Pour chaque sous-clé de verbe, créez une sous-clé de **commande** avec la valeur par défaut définie sur la chaîne de commande.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-206">For each verb subkey, create a **command** subkey with the default value set to the command string.</span></span>

<span data-ttu-id="5d6ff-207">L’illustration suivante montre un menu contextuel pour le type de fichier. MYP utilisé dans [types de fichiers](fa-file-types.md) et [Personnalisation des icônes](icon.md).</span><span class="sxs-lookup"><span data-stu-id="5d6ff-207">The following illustration shows a shortcut menu for the .myp file type used in [File Types](fa-file-types.md) and [Customizing Icons](icon.md).</span></span> <span data-ttu-id="5d6ff-208">Il a maintenant des verbes ouvrir, doit, imprimer et Printto dans son menu contextuel, avec doit comme verbe par défaut.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-208">It now has open, doit, print, and printto verbs on its shortcut menu, with doit as the default verb.</span></span> <span data-ttu-id="5d6ff-209">Le menu contextuel ressemble à ce qui suit.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-209">The shortcut menu looks like this.</span></span>

![capture d’écran du menu contextuel personnalisé](images/context3.jpg)

<span data-ttu-id="5d6ff-211">Les entrées de Registre utilisées pour étendre le menu contextuel présenté dans l’illustration précédente sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="5d6ff-211">The registry entries used to extend the shortcut menu shown in the preceding illustration are:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   MyProgram.1
      (Default) = MyProgram Application
      Shell
         (Default) = doit
         open
            command
               (Default) = C:\MyDir\MyProgram.exe "%1"
         doit
            (Default) = &Do It
            command
               (Default) = C:\MyDir\MyProgram.exe /d "%1"
         print
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1"
         printto
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1" "%2" %3 %4
```

<span data-ttu-id="5d6ff-212">Bien que la commande **Ouvrir avec** se trouve au-dessus du premier séparateur, elle est automatiquement créée par le système et ne nécessite pas d’entrée de registre.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-212">Although the **Open With** command is above the first separator, it is automatically created by the system and does not require a registry entry.</span></span> <span data-ttu-id="5d6ff-213">Le système crée automatiquement des noms complets pour les verbes canoniques ouverts et imprimés.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-213">The system automatically creates display names for the canonical verbs open and print.</span></span> <span data-ttu-id="5d6ff-214">Étant donné que doit n’est pas un verbe canonique, il se voit attribuer un nom d’affichage, « &le faire », que vous pouvez sélectionner en appuyant sur la touche D.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-214">Because doit is not a canonical verb, it is assigned a display name, "&Do It", which can be selected by pressing the D key.</span></span> <span data-ttu-id="5d6ff-215">Le verbe Printto n’apparaît pas dans le menu contextuel, mais il permet à l’utilisateur d’imprimer des fichiers en les déposant sur une icône d’imprimante.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-215">The printto verb does not appear on the shortcut menu, but including it allows the user to print files by dropping them on a printer icon.</span></span> <span data-ttu-id="5d6ff-216">Dans cet exemple, %1 représente le nom de fichier et %2 le nom de l’imprimante.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-216">In this example, %1 represents the file name and %2 the printer name.</span></span>

<span data-ttu-id="5d6ff-217">Les verbes peuvent être supprimés par le biais des paramètres de stratégie en ajoutant une valeur SuppressionPolicy à la clé du verbe.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-217">Verbs can be suppressed through policy settings by adding a SuppressionPolicy value to the verb's key.</span></span> <span data-ttu-id="5d6ff-218">Définissez la valeur de SuppressionPolicy sur l’ID de stratégie.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-218">Set the value of SuppressionPolicy to the policy ID.</span></span> <span data-ttu-id="5d6ff-219">Si la stratégie est activée, le verbe et son entrée de menu contextuel associée sont supprimés.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-219">If the policy is turned on, the verb and its associated shortcut menu entry are suppressed.</span></span> <span data-ttu-id="5d6ff-220">Pour connaître les valeurs possibles de l’ID de stratégie, consultez l’énumération [**restrictions**](/windows/desktop/api/shlobj_core/ne-shlobj_core-restrictions) .</span><span class="sxs-lookup"><span data-stu-id="5d6ff-220">For possible policy ID values, see the [**RESTRICTIONS**](/windows/desktop/api/shlobj_core/ne-shlobj_core-restrictions) enumeration.</span></span>

## <a name="extending-the-shortcut-menu-for-predefined-shell-objects"></a><span data-ttu-id="5d6ff-221">Extension du menu contextuel pour les objets Shell prédéfinis</span><span class="sxs-lookup"><span data-stu-id="5d6ff-221">Extending the Shortcut Menu for Predefined Shell Objects</span></span>

<span data-ttu-id="5d6ff-222">De nombreux objets Shell prédéfinis ont des menus contextuels qui peuvent être étendus.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-222">Many predefined Shell objects have shortcut menus that can be extended.</span></span> <span data-ttu-id="5d6ff-223">Inscrivez la commande à peu près de la même façon que vous enregistrez des types de fichiers standard, mais utilisez le nom de l’objet prédéfini comme nom de type de fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-223">Register the command in much the same way that you register typical file types, but use the name of the predefined object as the file type name.</span></span>

<span data-ttu-id="5d6ff-224">Vous trouverez une liste d’objets prédéfinis dans la section *objets Shell prédéfinis* de la rubrique [création de gestionnaires d’extension de Shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="5d6ff-224">A list of predefined objects can be found in the *Predefined Shell Objects* section of [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="5d6ff-225">Les objets Shell prédéfinis dont les menus contextuels peuvent être étendus en ajoutant des verbes dans le Registre sont marqués dans la table avec le mot « Verb ».</span><span class="sxs-lookup"><span data-stu-id="5d6ff-225">Those predefined Shell objects whose shortcut menus can be extended by adding verbs in the registry are marked in the table with the word "Verb."</span></span>

## <a name="registering-an-application-to-handle-arbitrary-file-types"></a><span data-ttu-id="5d6ff-226">Inscription d’une application pour gérer des types de fichiers arbitraires</span><span class="sxs-lookup"><span data-stu-id="5d6ff-226">Registering an Application to Handle Arbitrary File Types</span></span>

<span data-ttu-id="5d6ff-227">Les sections précédentes de ce document décrivent comment définir des éléments de menu contextuel pour un type de fichier particulier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-227">The preceding sections of this document have discussed how to define shortcut menu items for a particular file type.</span></span> <span data-ttu-id="5d6ff-228">Entre autres choses, la définition du menu contextuel vous permet de spécifier la manière dont l’application associée ouvre un membre du type de fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-228">Among other things, defining the shortcut menu allows you to specify how the associated application opens a member of the file type.</span></span> <span data-ttu-id="5d6ff-229">Toutefois, comme indiqué dans [types de fichiers](fa-file-types.md), les applications peuvent également inscrire une procédure par défaut distincte à utiliser lorsqu’un utilisateur tente d’utiliser votre application pour ouvrir un type de fichier que vous n’avez pas associé à l’application.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-229">However, as discussed in [File Types](fa-file-types.md), applications can also register a separate default procedure to be used when a user attempts to use your application to open a file type that you have not associated with the application.</span></span> <span data-ttu-id="5d6ff-230">Cette rubrique est présentée ici, car vous inscrivez la procédure par défaut à peu près de la même façon que vous enregistrez les éléments de menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-230">This topic is discussed here because you register the default procedure in much the same way you register shortcut menu items.</span></span>

<span data-ttu-id="5d6ff-231">La procédure par défaut remplit deux fonctions de base.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-231">The default procedure serves two basic purposes.</span></span> <span data-ttu-id="5d6ff-232">La première consiste à spécifier la manière dont votre application doit être appelée pour ouvrir un type de fichier arbitraire.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-232">One is to specify how your application should be invoked to open an arbitrary file type.</span></span> <span data-ttu-id="5d6ff-233">Vous pouvez, par exemple, utiliser un indicateur de ligne de commande pour indiquer qu’un type de fichier inconnu est en cours d’ouverture.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-233">You could, for instance, use a command-line flag to indicate that an unknown file type is being opened.</span></span> <span data-ttu-id="5d6ff-234">L’autre objectif est de définir les différentes caractéristiques d’un type de fichier, telles que les éléments de menu contextuel et l’icône.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-234">The other purpose is to define the various characteristics of a file type, such as the shortcut menu items and the icon.</span></span> <span data-ttu-id="5d6ff-235">Si un utilisateur associe votre application à un type de fichier supplémentaire, ce type aura ces caractéristiques.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-235">If a user associates your application with an additional file type, that type will have these characteristics.</span></span> <span data-ttu-id="5d6ff-236">Si le type de fichier supplémentaire a été précédemment associé à une autre application, ces caractéristiques remplacent les originaux.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-236">If the additional file type was previously associated with another application, these characteristics will replace the originals.</span></span>

<span data-ttu-id="5d6ff-237">Pour inscrire la procédure par défaut, placez les mêmes clés de registre que celles que vous avez créées pour le ProgID de votre application sous la sous-clé de l’application des applications **\_ \_ racines de la classe HKEY** \\ .</span><span class="sxs-lookup"><span data-stu-id="5d6ff-237">To register the default procedure, place the same registry keys you created for your application's ProgID under the application's subkey of **HKEY\_CLASSES\_ROOT**\\**Applications**.</span></span> <span data-ttu-id="5d6ff-238">Vous pouvez également inclure une valeur FriendlyAppName pour fournir au système un nom convivial pour votre application.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-238">You can also include a FriendlyAppName value to provide the system with a friendly name for your application.</span></span> <span data-ttu-id="5d6ff-239">Le nom convivial de l’application peut également être extrait de son fichier exécutable, mais uniquement si la valeur FriendlyAppName est absente.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-239">The application's friendly name may also be extracted from its executable file, but only if the FriendlyAppName value is absent.</span></span> <span data-ttu-id="5d6ff-240">Le fragment de Registre suivant montre un exemple de procédure par défaut pour MyProgram.exe qui définit un nom convivial et plusieurs éléments de menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-240">The following registry fragment shows a sample default procedure for MyProgram.exe that defines a friendly name and several shortcut menu items.</span></span> <span data-ttu-id="5d6ff-241">Les chaînes de commande incluent l’indicateur/a pour notifier l’application qu’il ouvre un type de fichier arbitraire.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-241">The command strings include the /a flag to notify the application that it is opening an arbitrary file type.</span></span> <span data-ttu-id="5d6ff-242">Si vous incluez une sous-clé **DefaultIcon** , vous devez utiliser une icône générique.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-242">If you include a **DefaultIcon** subkey, you should use a generic icon.</span></span>

```
HKEY_CLASSES_ROOT
   Applications
      MyProgram.exe
         FriendlyAppName = Friendly Name
         shell
            open
               command
                  (Default) = C:\MyDir\MyProgram.exe /a "%1"
            print
               command
                  (Default) = C:\MyDir\MyProgram.exe /a /p "%1"
            printto
               command
                  (Default) = C:\MyDir\MyProgram.exe /a /p "%1" "%2" %3 %4
```

## <a name="extending-the-new-submenu"></a><span data-ttu-id="5d6ff-243">Extension du nouveau sous-menu</span><span class="sxs-lookup"><span data-stu-id="5d6ff-243">Extending the New Submenu</span></span>

<span data-ttu-id="5d6ff-244">Quand un utilisateur ouvre le menu **fichier** dans l’Explorateur Windows, la première commande est **nouvelle**.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-244">When a user opens the **File** menu in Windows Explorer, the first command is **New**.</span></span> <span data-ttu-id="5d6ff-245">La sélection de cette commande affiche un sous-menu.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-245">Selecting this command displays a submenu.</span></span> <span data-ttu-id="5d6ff-246">Par défaut, il contient deux commandes, **dossier** et **raccourci**, qui permettent aux utilisateurs de créer des sous-dossiers et des raccourcis.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-246">By default, it contains two commands, **Folder** and **Shortcut**, that allow users to create subfolders and shortcuts.</span></span> <span data-ttu-id="5d6ff-247">Ce sous-menu peut être étendu pour inclure des commandes de création de fichier pour n’importe quel type de fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-247">This submenu can be extended to include file creation commands for any file type.</span></span>

<span data-ttu-id="5d6ff-248">Pour ajouter une commande de création de fichier au sous-menu **nouveau** , les fichiers de votre application doivent être associés à un [type de fichier](fa-file-types.md) .</span><span class="sxs-lookup"><span data-stu-id="5d6ff-248">To add a file-creation command to the **New** submenu, your application's files must have a [file type](fa-file-types.md) associated with them.</span></span> <span data-ttu-id="5d6ff-249">Incluez une sous-clé **ShellNew** sous la clé pour l’extension de nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-249">Include a **ShellNew** subkey under the key for the file name extension.</span></span> <span data-ttu-id="5d6ff-250">Lorsque la **nouvelle** commande du menu **fichier** est sélectionnée, l’interpréteur de commandes l’ajoute au **nouveau** sous-menu.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-250">When the **File** menu's **New** command is selected, the Shell will add it to the **New** submenu.</span></span> <span data-ttu-id="5d6ff-251">La chaîne d’affichage de la commande sera la chaîne descriptive qui est assignée au ProgID du programme.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-251">The command's display string will be the descriptive string that is assigned to the program's ProgID.</span></span>

<span data-ttu-id="5d6ff-252">Affectez une ou plusieurs valeurs de données à la sous-clé **ShellNew** pour spécifier la méthode de création de fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-252">Assign one or more data values to the **ShellNew** subkey to specify the file creation method.</span></span> <span data-ttu-id="5d6ff-253">Les valeurs disponibles suivent.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-253">The available values follow.</span></span>



| <span data-ttu-id="5d6ff-254">Valeur</span><span class="sxs-lookup"><span data-stu-id="5d6ff-254">Value</span></span>    | <span data-ttu-id="5d6ff-255">Description</span><span class="sxs-lookup"><span data-stu-id="5d6ff-255">Description</span></span>                                                                                                                                                   |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5d6ff-256">Commande</span><span class="sxs-lookup"><span data-stu-id="5d6ff-256">Command</span></span>  | <span data-ttu-id="5d6ff-257">Exécute une application.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-257">Executes an application.</span></span> <span data-ttu-id="5d6ff-258">Il s’agit d’une valeur de **reg \_ SZ** spécifiant le chemin d’accès de l’application à exécuter.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-258">This is a **REG\_SZ** value specifying the path of the application to be executed.</span></span> <span data-ttu-id="5d6ff-259">Par exemple, vous pouvez le configurer pour lancer un Assistant.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-259">For example, you could set it to launch a wizard.</span></span> |
| <span data-ttu-id="5d6ff-260">Données</span><span class="sxs-lookup"><span data-stu-id="5d6ff-260">Data</span></span>     | <span data-ttu-id="5d6ff-261">Crée un fichier contenant les données spécifiées.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-261">Creates a file containing specified data.</span></span> <span data-ttu-id="5d6ff-262">Data est une **valeur \_ binaire de Reg** avec les données du fichier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-262">Data is a **REG\_BINARY** value with the file's data.</span></span> <span data-ttu-id="5d6ff-263">Les données sont ignorées si NullFile ou FileName est spécifié.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-263">Data is ignored if either NullFile or FileName is specified.</span></span>  |
| <span data-ttu-id="5d6ff-264">FileName</span><span class="sxs-lookup"><span data-stu-id="5d6ff-264">FileName</span></span> | <span data-ttu-id="5d6ff-265">Crée un fichier qui est une copie d’un fichier spécifié.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-265">Creates a file that is a copy of a specified file.</span></span> <span data-ttu-id="5d6ff-266">FileName est une valeur de **reg \_ SZ** , définie sur le chemin d’accès complet du fichier à copier.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-266">FileName is a **REG\_SZ** value, set to the fully qualified path of the file to be copied.</span></span>                 |
| <span data-ttu-id="5d6ff-267">NullFile</span><span class="sxs-lookup"><span data-stu-id="5d6ff-267">NullFile</span></span> | <span data-ttu-id="5d6ff-268">Crée un fichier vide.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-268">Creates an empty file.</span></span> <span data-ttu-id="5d6ff-269">Aucune valeur n’est assignée à NullFile.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-269">NullFile is not assigned a value.</span></span> <span data-ttu-id="5d6ff-270">Si NullFile est spécifié, les valeurs de nom de fichier et de données sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-270">If NullFile is specified, the Data and FileName values are ignored.</span></span>                                  |



 

<span data-ttu-id="5d6ff-271">L’illustration suivante montre le **nouveau** sous-menu du type de fichier. MYP utilisé à titre d’exemple dans [types de fichiers](fa-file-types.md) et [Personnalisation des icônes](icon.md).</span><span class="sxs-lookup"><span data-stu-id="5d6ff-271">The following illustration shows the **New** submenu for the .myp file type used as an example in [File Types](fa-file-types.md) and [Customizing Icons](icon.md).</span></span> <span data-ttu-id="5d6ff-272">Elle dispose maintenant d’une commande, **MyProgram application**.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-272">It now has a command, **MyProgram Application**.</span></span> <span data-ttu-id="5d6ff-273">Lorsqu’un utilisateur sélectionne **application MyProgram** dans le sous-menu **nouveau** , l’interpréteur de commandes crée un fichier nommé « New MyProgram application. MYP » et le transmet à MyProgram.exe.</span><span class="sxs-lookup"><span data-stu-id="5d6ff-273">When a user selects **MyProgram Application** from the **New** submenu, the Shell creates a file named "New MyProgram Application.myp" and passes it to MyProgram.exe.</span></span>

![capture d’écran du menu nouveau personnalisé](images/context5.png)

<span data-ttu-id="5d6ff-275">L’entrée de Registre est maintenant la suivante :</span><span class="sxs-lookup"><span data-stu-id="5d6ff-275">The registry entry is now as follows:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
      MyProgram.1
         ShellNew
            NullFile
   MyProgram.1
      (Default) = MyProgram Application
      DefaultIcon
         (Default) = C:\MyDir\MyProgram.exe,2
      Shell
         (Default) = doit
         open
            command
               (Default) = C:\MyDir\MyProgram.exe "%1"
         doit
            (Default) = &Do It
            command
               (Default) = C:\MyDir\MyProgram.exe /d "%1"
         print
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1"
         printto
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1" "%2" %3 %4
```

 

 



