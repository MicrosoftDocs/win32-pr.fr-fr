---
description: L’Explorateur Windows fournit une représentation graphique de l’espace de noms Shell associée à des outils qui permettent aux utilisateurs d’interagir avec les objets Shell.
ms.assetid: cc387338-15fa-4350-b039-61a0f1c5030a
title: Fonctionnement des extensions d’espace de noms Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a0150092a25708c1f079160a9d106a7b8205e231
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104973359"
---
# <a name="understanding-shell-namespace-extensions"></a><span data-ttu-id="64d4c-103">Fonctionnement des extensions d’espace de noms Shell</span><span class="sxs-lookup"><span data-stu-id="64d4c-103">Understanding Shell Namespace Extensions</span></span>

<span data-ttu-id="64d4c-104">L’Explorateur Windows fournit une représentation graphique de l’espace de noms Shell associée à des outils qui permettent aux utilisateurs d’interagir avec les objets Shell.</span><span class="sxs-lookup"><span data-stu-id="64d4c-104">Windows Explorer provides a graphical representation of the Shell namespace combined with tools that allow users to interact with Shell objects.</span></span> <span data-ttu-id="64d4c-105">Avec une extension d’espace de noms, vous pouvez prendre n’importe quel corps de données et faire en sorte que l’Explorateur Windows le présente à l’utilisateur comme un dossier virtuel.</span><span class="sxs-lookup"><span data-stu-id="64d4c-105">With a namespace extension, you can take any body of data and have Windows Explorer present it to the user as a virtual folder.</span></span> <span data-ttu-id="64d4c-106">Quand un utilisateur accède à ce dossier, vos données sont présentées sous la forme d’une hiérarchie structurée en arborescence de dossiers et de fichiers, à l’instar du reste de l’espace de noms Shell.</span><span class="sxs-lookup"><span data-stu-id="64d4c-106">When a user browses into this folder, your data is presented as a tree-structured hierarchy of folders and files, much like the rest of the Shell namespace.</span></span> <span data-ttu-id="64d4c-107">Les utilisateurs et les applications peuvent interagir avec le contenu de ce dossier virtuel à peu près de la même façon qu’avec tout autre objet d’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="64d4c-107">Users and applications are able to interact with the contents of this virtual folder in much the same way as with any other namespace object.</span></span> <span data-ttu-id="64d4c-108">Ce document explique comment créer une extension d’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="64d4c-108">This document discusses how to create a namespace extension.</span></span>

-   [<span data-ttu-id="64d4c-109">Fonctionnement d’une extension d’espace de noms</span><span class="sxs-lookup"><span data-stu-id="64d4c-109">How a Namespace Extension Works</span></span>](#how-a-namespace-extension-works)
-   [<span data-ttu-id="64d4c-110">Objet de vue de dossier système par défaut (DefView)</span><span class="sxs-lookup"><span data-stu-id="64d4c-110">The Default System Folder View Object (DefView)</span></span>](#the-default-system-folder-view-object-defview)
-   [<span data-ttu-id="64d4c-111">Comment l’Explorateur Windows interagit avec une extension d’espace de noms</span><span class="sxs-lookup"><span data-stu-id="64d4c-111">How Windows Explorer Interacts with a Namespace Extension</span></span>](#how-windows-explorer-interacts-with-a-namespace-extension)
    -   [<span data-ttu-id="64d4c-112">Arborescence</span><span class="sxs-lookup"><span data-stu-id="64d4c-112">Tree View</span></span>](#tree-view)
    -   [<span data-ttu-id="64d4c-113">Affichage des dossiers</span><span class="sxs-lookup"><span data-stu-id="64d4c-113">Folder View</span></span>](#folder-view)
    -   [<span data-ttu-id="64d4c-114">Barre de menus et barres d’outils</span><span class="sxs-lookup"><span data-stu-id="64d4c-114">Menu Bar and Toolbars</span></span>](#menu-bar-and-toolbars)
    -   [<span data-ttu-id="64d4c-115">Barre d’état</span><span class="sxs-lookup"><span data-stu-id="64d4c-115">Status Bar</span></span>](#status-bar)

## <a name="how-a-namespace-extension-works"></a><span data-ttu-id="64d4c-116">Fonctionnement d’une extension d’espace de noms</span><span class="sxs-lookup"><span data-stu-id="64d4c-116">How a Namespace Extension Works</span></span>

<span data-ttu-id="64d4c-117">En arrière-plan, chaque dossier affiché par l’Explorateur Windows est représenté par un objet COM (Component Object Model) appelé *objet dossier*.</span><span class="sxs-lookup"><span data-stu-id="64d4c-117">Behind the scenes, every folder that Windows Explorer displays is represented by a Component Object Model (COM) object called a *folder object*.</span></span> <span data-ttu-id="64d4c-118">Chaque fois que l’utilisateur interagit avec un dossier ou son contenu, l’interpréteur de commandes communique avec l’objet dossier associé via l’une des nombreuses interfaces standard.</span><span class="sxs-lookup"><span data-stu-id="64d4c-118">Each time the user interacts with a folder or its contents, the Shell communicates with the associated folder object through one of a number of standard interfaces.</span></span> <span data-ttu-id="64d4c-119">L’objet Folder fait ensuite ce qui est nécessaire pour répondre à l’action de l’utilisateur, et l’interpréteur de commandes met à jour l’affichage de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="64d4c-119">The folder object then does whatever is necessary to respond to the user's action, and the Shell updates the Windows Explorer display.</span></span>

<span data-ttu-id="64d4c-120">La majorité des fichiers et dossiers avec lesquels les utilisateurs interagissent font partie du système de fichiers ou d’un dossier virtuel système tel que la corbeille.</span><span class="sxs-lookup"><span data-stu-id="64d4c-120">The majority of the files and folders that users interact with are part of the file system or a system virtual folder such as the Recycle Bin.</span></span> <span data-ttu-id="64d4c-121">D’autres documents ont abordé la manière dont vous pouvez personnaliser le comportement de ces dossiers standard pour répondre aux exigences de votre application en modifiant le registre ou en implémentant des [gestionnaires d’extensions de Shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="64d4c-121">Other documentation has discussed how you can customize the behavior of these standard folders to meet the requirements of your application by modifying the registry or by implementing [Shell extension handlers](handlers.md).</span></span> <span data-ttu-id="64d4c-122">Toutefois, l’extension de l’interpréteur de commandes est particulièrement utile lorsque vos informations peuvent être facilement empaquetées sous la forme de fichiers ou de dossiers du système de fichiers normal.</span><span class="sxs-lookup"><span data-stu-id="64d4c-122">However, extending the Shell in these ways is most useful when your information can be readily packaged in the form of normal file system files or folders.</span></span>

<span data-ttu-id="64d4c-123">Il existe plusieurs situations où le stockage de données sous la forme d’une collection de dossiers et de fichiers de système de fichiers peut être indésirable, voire impossible.</span><span class="sxs-lookup"><span data-stu-id="64d4c-123">There are a number of situations where storing data as a collection of file-system folders and files might be undesirable or even impossible.</span></span> <span data-ttu-id="64d4c-124">Voici quelques exemples de ce type de données :</span><span class="sxs-lookup"><span data-stu-id="64d4c-124">Some examples of this type of data include:</span></span>

-   <span data-ttu-id="64d4c-125">Collection d’éléments qui est le plus efficacement empaqueté dans un fichier unique, tel qu’une base de données.</span><span class="sxs-lookup"><span data-stu-id="64d4c-125">A collection of items that is most effectively packaged in a single file, such as a database.</span></span>
-   <span data-ttu-id="64d4c-126">Collection d’éléments stockés sur un ordinateur distant qui ne dispose pas d’un système de fichiers Windows standard.</span><span class="sxs-lookup"><span data-stu-id="64d4c-126">A collection of items stored on a remote computer that does not have a standard Windows file system.</span></span> <span data-ttu-id="64d4c-127">Les informations stockées sur un assistant numérique personnel (PDA) ou un appareil photo numérique sont un exemple de ces données.</span><span class="sxs-lookup"><span data-stu-id="64d4c-127">An example of such data is the information stored on a personal digital assistant (PDA) or digital camera.</span></span>
-   <span data-ttu-id="64d4c-128">Collection d’éléments qui ne représente pas de données stockées.</span><span class="sxs-lookup"><span data-stu-id="64d4c-128">A collection of items that does not represent stored data.</span></span> <span data-ttu-id="64d4c-129">Les liens d’imprimante contenus dans le dossier Imprimantes standard sont un exemple de ces données.</span><span class="sxs-lookup"><span data-stu-id="64d4c-129">An example of such data is the printer links contained by the standard Printers folder.</span></span>

<span data-ttu-id="64d4c-130">Une façon de présenter ce type de données à un utilisateur consiste à écrire une application pour permettre aux utilisateurs d’afficher et d’interagir avec les différents éléments.</span><span class="sxs-lookup"><span data-stu-id="64d4c-130">One way to present this kind of data to a user is to write an application to allow users to view and interact with the various items.</span></span> <span data-ttu-id="64d4c-131">Toutefois, si vos données peuvent être présentées sous la forme d’une hiérarchie de dossiers/fichiers, la plupart des fonctionnalités que vous devrez implémenter peuvent être des services d’interface utilisateur qui sont déjà fournis par l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="64d4c-131">However, if your data can be presented as a folder/file hierarchy, much of the functionality you will need to implement might be user interface services that are already provided by Windows Explorer.</span></span> <span data-ttu-id="64d4c-132">Une approche bien plus efficace consisterait à écrire une extension d’espace de noms et à laisser l’Explorateur Windows devenir votre interface utilisateur graphique.</span><span class="sxs-lookup"><span data-stu-id="64d4c-132">A much more efficient approach could be to write a namespace extension and let Windows Explorer become your GUI.</span></span>

<span data-ttu-id="64d4c-133">Pour implémenter une extension d’espace de noms, vos informations doivent être organisées sous la forme d’un espace de noms structuré en arborescence.</span><span class="sxs-lookup"><span data-stu-id="64d4c-133">To implement a namespace extension, your information must be organized as a tree-structured namespace.</span></span> <span data-ttu-id="64d4c-134">La *racine* de l’espace de noms est présentée sous la forme d’un dossier virtuel dans l’espace de noms Shell.</span><span class="sxs-lookup"><span data-stu-id="64d4c-134">Your *namespace root* is presented as a virtual folder in the Shell namespace.</span></span> <span data-ttu-id="64d4c-135">Le dossier racine, ainsi que tous ses sous-dossiers et éléments de données, deviennent partie intégrante de l’espace de noms Shell et l’Explorateur Windows devient votre interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="64d4c-135">The root folder, and all its subfolders and data items, becomes part of the Shell namespace, and Windows Explorer becomes your user interface.</span></span> <span data-ttu-id="64d4c-136">Vous pouvez ainsi présenter vos informations à l’utilisateur de manière familière et facilement accessible avec une programmation d’interface utilisateur bien moins importante que celle requise pour une application personnalisée.</span><span class="sxs-lookup"><span data-stu-id="64d4c-136">You can thus present your information to the user in a familiar and readily accessible way with much less UI programming than would be required for a custom application.</span></span>

<span data-ttu-id="64d4c-137">Une extension d’espace de noms se compose de deux composants de base :</span><span class="sxs-lookup"><span data-stu-id="64d4c-137">A namespace extension consists of two basic components:</span></span>

-   <span data-ttu-id="64d4c-138">Un gestionnaire de données</span><span class="sxs-lookup"><span data-stu-id="64d4c-138">A data manager</span></span>
-   <span data-ttu-id="64d4c-139">Interface entre le gestionnaire de données et l’Explorateur Windows</span><span class="sxs-lookup"><span data-stu-id="64d4c-139">An interface between the data manager and Windows Explorer</span></span>

<span data-ttu-id="64d4c-140">Le premier composant de la liste dépend entièrement de vous.</span><span class="sxs-lookup"><span data-stu-id="64d4c-140">The first component on the list is entirely up to you.</span></span> <span data-ttu-id="64d4c-141">Vous pouvez stocker et gérer vos données de la manière la plus efficace.</span><span class="sxs-lookup"><span data-stu-id="64d4c-141">You can store and manage your data in whatever way is most effective.</span></span> <span data-ttu-id="64d4c-142">Le deuxième composant est le code nécessaire pour empaqueter vos données sous forme d’objets de dossier et gérer l’interaction avec l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="64d4c-142">The second component is the code needed to package your data as folder objects and handle the interaction with Windows Explorer.</span></span> <span data-ttu-id="64d4c-143">L’Explorateur Windows peut ensuite appeler ces objets pour permettre aux utilisateurs d’afficher et d’interagir avec vos données comme s’il s’agissait d’une collection de dossiers et de fichiers.</span><span class="sxs-lookup"><span data-stu-id="64d4c-143">Windows Explorer can then call these objects to allow users to view and interact with your data as if it were a collection of folders and files.</span></span> <span data-ttu-id="64d4c-144">Les objets de dossier de votre extension d’espace de noms doivent interagir avec l’Explorateur Windows comme s’il s’agissait de dossiers normaux.</span><span class="sxs-lookup"><span data-stu-id="64d4c-144">Your namespace extension's folder objects must interact with Windows Explorer as if they were normal folders.</span></span> <span data-ttu-id="64d4c-145">Avant de tenter d’implémenter une extension d’espace de noms, vous devez d’abord comprendre comment l’Explorateur Windows gère un objet dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-145">Before attempting to implement a namespace extension, you must first understand how Windows Explorer handles a folder object.</span></span>

## <a name="the-default-system-folder-view-object-defview"></a><span data-ttu-id="64d4c-146">Objet de vue de dossier système par défaut (DefView)</span><span class="sxs-lookup"><span data-stu-id="64d4c-146">The Default System Folder View Object (DefView)</span></span>

<span data-ttu-id="64d4c-147">L’interpréteur de commandes fournit une implémentation par défaut de l’affichage des dossiers, connu sous le nom de DefView, ce qui vous permet d’éviter une grande partie du travail d’implémentation de votre propre extension d’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="64d4c-147">The Shell provides a default implementation of the folder view, colloquially known as DefView, so that you can avoid much of the work of implementing your own namespace extension.</span></span> <span data-ttu-id="64d4c-148">Étant donné que certaines fonctionnalités de vue ne peuvent pas être obtenues par le biais de vues personnalisées, il est souvent recommandé d’utiliser l’objet de vue de dossier système par défaut à la place d’une vue personnalisée.</span><span class="sxs-lookup"><span data-stu-id="64d4c-148">Because some view features cannot be achieved through custom views, it is often recommended that the default system folder view object is used in place of a custom view.</span></span> <span data-ttu-id="64d4c-149">Pour plus d’informations, consultez [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span><span class="sxs-lookup"><span data-stu-id="64d4c-149">For more information, see [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span></span>

## <a name="how-windows-explorer-interacts-with-a-namespace-extension"></a><span data-ttu-id="64d4c-150">Comment l’Explorateur Windows interagit avec une extension d’espace de noms</span><span class="sxs-lookup"><span data-stu-id="64d4c-150">How Windows Explorer Interacts with a Namespace Extension</span></span>

<span data-ttu-id="64d4c-151">L’Explorateur Windows fournit aux utilisateurs une interface utilisateur graphique qui leur permet d’effectuer diverses tâches, notamment :</span><span class="sxs-lookup"><span data-stu-id="64d4c-151">Windows Explorer provides users with a GUI that allows them to do a variety of tasks, including:</span></span>

-   <span data-ttu-id="64d4c-152">[Navigation dans](navigate.md) la hiérarchie de l’espace de noms et affichage du contenu des dossiers.</span><span class="sxs-lookup"><span data-stu-id="64d4c-152">[Navigating](navigate.md) the namespace hierarchy and viewing the contents of folders.</span></span>
-   <span data-ttu-id="64d4c-153">[Gestion](manage.md) du contenu de l’espace de noms en déplaçant, en supprimant et en copiant des objets.</span><span class="sxs-lookup"><span data-stu-id="64d4c-153">[Managing](manage.md) the contents of the namespace by moving, deleting, and copying objects.</span></span>
-   <span data-ttu-id="64d4c-154">[Récupération](folder-info.md) d’une variété d’informations sur les objets.</span><span class="sxs-lookup"><span data-stu-id="64d4c-154">[Retrieving](folder-info.md) a variety of information about objects.</span></span>
-   <span data-ttu-id="64d4c-155">[Lancement](launch.md) d’applications.</span><span class="sxs-lookup"><span data-stu-id="64d4c-155">[Launching](launch.md) applications.</span></span>

<span data-ttu-id="64d4c-156">L’interface utilisateur graphique de l’Explorateur Windows comporte cinq composants de base.</span><span class="sxs-lookup"><span data-stu-id="64d4c-156">The Windows Explorer GUI has five basic components.</span></span> <span data-ttu-id="64d4c-157">L’illustration suivante nomme les composants et indique où ils s’affichent généralement dans l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="64d4c-157">The following illustration names the components and shows where they are typically displayed within Windows Explorer.</span></span>

![<span data-ttu-id="64d4c-158">Illustration montrant les composants de l’interface utilisateur de l’Explorateur Windows</span><span class="sxs-lookup"><span data-stu-id="64d4c-158">illustration showing components of the windows explorer user interface</span></span> ](images/nse1.png)

<span data-ttu-id="64d4c-159">Lorsqu’un utilisateur affiche un dossier qui appartient à une extension d’espace de noms dans l’Explorateur Windows, l’objet Folder a au moins le contrôle partiel sur le contenu des cinq zones.</span><span class="sxs-lookup"><span data-stu-id="64d4c-159">When a user displays a folder that belongs to a namespace extension in Windows Explorer, the folder object has at least partial control over the contents of all five areas.</span></span>

### <a name="tree-view"></a><span data-ttu-id="64d4c-160">Arborescence</span><span class="sxs-lookup"><span data-stu-id="64d4c-160">Tree View</span></span>

<span data-ttu-id="64d4c-161">L’arborescence fournit une vue d’ensemble de l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="64d4c-161">The tree view provides a high-level view of the namespace.</span></span> <span data-ttu-id="64d4c-162">Cette zone héberge un [contrôle arborescence](../controls/tree-view-controls.md) qui peut afficher chaque dossier d’espace de noms et la position du dossier dans la hiérarchie d’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="64d4c-162">This area hosts a [tree view control](../controls/tree-view-controls.md) that can display every namespace folder and the folder's position in the namespace hierarchy.</span></span> <span data-ttu-id="64d4c-163">Un utilisateur peut effectuer plusieurs opérations avec la zone d’arborescence, notamment :</span><span class="sxs-lookup"><span data-stu-id="64d4c-163">A user can perform several operations with the tree view area, including:</span></span>

-   <span data-ttu-id="64d4c-164">Affichage ou masquage du niveau suivant dans l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="64d4c-164">Displaying or hiding the next level in the namespace.</span></span>
-   <span data-ttu-id="64d4c-165">Copier, déplacer ou supprimer des dossiers.</span><span class="sxs-lookup"><span data-stu-id="64d4c-165">Copying, moving, or deleting folders.</span></span>
-   <span data-ttu-id="64d4c-166">Cliquez avec le bouton droit sur un dossier pour afficher un menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="64d4c-166">Right-clicking a folder to display a shortcut menu.</span></span>
-   <span data-ttu-id="64d4c-167">Sélection d’un dossier et affichage de son contenu dans l’affichage des dossiers.</span><span class="sxs-lookup"><span data-stu-id="64d4c-167">Selecting a folder and viewing its contents in the folder view.</span></span>

<span data-ttu-id="64d4c-168">L’arborescence communique avec les objets de dossier principalement par le biais de leur interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="64d4c-168">The tree view communicates with folder objects primarily through their [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="64d4c-169">Par exemple, lorsqu’un utilisateur clique sur le signe plus (+) en regard de l’icône du dossier, l’Explorateur Windows développe l’affichage pour afficher les sous-dossiers du dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-169">For example, when a user clicks the plus sign (+) next to the folder's icon, Windows Explorer expands the display to show the folder's subfolders.</span></span> <span data-ttu-id="64d4c-170">Pour obtenir les informations nécessaires à la mise à jour de l’arborescence, le shell effectue plusieurs appels à l’interface **IShellFolder** de l’objet dossier :</span><span class="sxs-lookup"><span data-stu-id="64d4c-170">To obtain the information needed to update the tree view, the Shell makes several calls to the folder object's **IShellFolder** interface to:</span></span>

-   <span data-ttu-id="64d4c-171">Demandez les attributs du dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-171">Request the folder's attributes.</span></span>
-   <span data-ttu-id="64d4c-172">Énumérer le contenu du dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-172">Enumerate the contents of the folder.</span></span>
-   <span data-ttu-id="64d4c-173">Demandez les noms d’affichage de chaque sous-dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-173">Request display names for each subfolder.</span></span>
-   <span data-ttu-id="64d4c-174">Demandez une icône à afficher en regard de chaque dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-174">Request an icon to display next to each folder.</span></span>

<span data-ttu-id="64d4c-175">L’Explorateur Windows met ensuite à jour l’arborescence pour afficher les sous-dossiers du dossier sélectionné.</span><span class="sxs-lookup"><span data-stu-id="64d4c-175">Windows Explorer then updates the tree view to show the selected folder's subfolders.</span></span> <span data-ttu-id="64d4c-176">Si les sous-dossiers comportent des sous-dossiers, un caractère « + » s’affiche à côté de leur icône de dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-176">If the subfolders have subfolders, a '+' character is displayed next to their folder icon.</span></span> <span data-ttu-id="64d4c-177">Il existe un certain nombre de tâches plus sophistiquées qu’un utilisateur peut également effectuer avec l’arborescence, notamment :</span><span class="sxs-lookup"><span data-stu-id="64d4c-177">There are a number of more sophisticated tasks that a user can also perform with the tree view, including:</span></span>

-   <span data-ttu-id="64d4c-178">À l’aide du presse-papiers, coupez ou copiez un dossier, puis collez-le dans un autre dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-178">Using the Clipboard to cut or copy a folder and paste it into another folder.</span></span>
-   <span data-ttu-id="64d4c-179">À l’aide de la fonction glisser-déplacer pour couper ou copier un dossier et le déposer dans un autre dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-179">Using drag-and-drop to cut or copy a folder and drop it on another folder.</span></span>
-   <span data-ttu-id="64d4c-180">Utilisation d’un moteur de recherche pour rechercher des éléments dans un dossier ou dans ses sous-dossiers.</span><span class="sxs-lookup"><span data-stu-id="64d4c-180">Using a search engine to search for items in a folder or its subfolders.</span></span>
-   <span data-ttu-id="64d4c-181">Modification des propriétés du dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-181">Modifying the folder's properties.</span></span>

<span data-ttu-id="64d4c-182">Pour plus d’informations sur la façon dont une extension d’espace de noms gère ces actions utilisateur, consultez [implémentation des interfaces d’objet de dossier de base](nse-implement.md).</span><span class="sxs-lookup"><span data-stu-id="64d4c-182">For a more detailed discussion of how a namespace extension handles these user actions, see [Implementing the Basic Folder Object Interfaces](nse-implement.md).</span></span>

### <a name="folder-view"></a><span data-ttu-id="64d4c-183">Affichage des dossiers</span><span class="sxs-lookup"><span data-stu-id="64d4c-183">Folder View</span></span>

<span data-ttu-id="64d4c-184">Lorsqu’un utilisateur sélectionne un dossier, le contenu du dossier s’affiche dans l’affichage des dossiers.</span><span class="sxs-lookup"><span data-stu-id="64d4c-184">When a user selects a folder, the contents of the folder are displayed in the folder view.</span></span> <span data-ttu-id="64d4c-185">Dans une certaine mesure, les fonctionnalités normales de l’affichage des dossiers chevauchent l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="64d4c-185">To some extent, the normal functionality of the folder view overlaps with the tree view.</span></span> <span data-ttu-id="64d4c-186">Les utilisateurs peuvent déplacer ou copier des dossiers, modifier les propriétés des dossiers, afficher le contenu d’un sous-dossier, afficher un menu contextuel pour un dossier, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="64d4c-186">Users can move or copy folders, change folder properties, view the contents of a subfolder, display a shortcut menu for a folder, and so on.</span></span> <span data-ttu-id="64d4c-187">Toutefois, il existe des différences distinctes entre l’arborescence et l’affichage des dossiers :</span><span class="sxs-lookup"><span data-stu-id="64d4c-187">However, there are some distinct differences between tree view and folder view:</span></span>

-   <span data-ttu-id="64d4c-188">L’affichage des dossiers affiche uniquement le contenu d’un dossier unique, et non une partie ou la totalité de la hiérarchie d’espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="64d4c-188">Folder view displays only the contents of a single folder, not part or all of the namespace hierarchy.</span></span>
-   <span data-ttu-id="64d4c-189">L’affichage des dossiers affiche les objets de fichier ainsi que les objets de dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-189">Folder view displays file objects as well as folder objects.</span></span>
-   <span data-ttu-id="64d4c-190">L’affichage des dossiers peut afficher plus d’informations sur les objets que l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="64d4c-190">Folder view can display much more information about objects than tree view.</span></span>
-   <span data-ttu-id="64d4c-191">L’affichage des dossiers permet aux extensions d’espace de noms d’avoir un contrôle presque entièrement sur les informations qui s’affichent et sur la manière dont.</span><span class="sxs-lookup"><span data-stu-id="64d4c-191">Folder view allows namespace extensions to have almost complete control over what information is displayed and how.</span></span> <span data-ttu-id="64d4c-192">Seuls les aspects mineurs de l’arborescence, tels que les icônes de dossiers, peuvent être modifiés.</span><span class="sxs-lookup"><span data-stu-id="64d4c-192">Only minor aspects of the tree view, such as folder icons, can be modified.</span></span>

<span data-ttu-id="64d4c-193">Contrairement à l’arborescence, l’Explorateur Windows ne contrôle pas directement le contenu de l’affichage des dossiers.</span><span class="sxs-lookup"><span data-stu-id="64d4c-193">Unlike the tree view, Windows Explorer does not directly control the contents of the folder view.</span></span> <span data-ttu-id="64d4c-194">L’affichage des dossiers est une zone que l’Explorateur Windows fournit aux objets de dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-194">The folder view is an area that Windows Explorer provides to folder objects.</span></span> <span data-ttu-id="64d4c-195">L’affichage et la gestion du contenu d’un dossier dans l’affichage des dossiers sont la responsabilité de l’objet dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-195">Displaying and managing the contents of a folder in the folder view are the responsibility of the folder object.</span></span> <span data-ttu-id="64d4c-196">Bien que la plupart des affichages de dossiers suivent un format relativement standard, il existe en fait quelques limitations sur ce qui peut être affiché ou comment.</span><span class="sxs-lookup"><span data-stu-id="64d4c-196">Although most folder views follow a fairly standard format, there are actually few limitations on what can be displayed or how.</span></span> <span data-ttu-id="64d4c-197">Un cas extrême est le dossier Internet, qui est un navigateur complet.</span><span class="sxs-lookup"><span data-stu-id="64d4c-197">An extreme case is the Internet folder, which is a full-featured browser.</span></span>

<span data-ttu-id="64d4c-198">Quand un utilisateur sélectionne un dossier qui appartient à votre extension d’espace de noms, vous créez une fenêtre et transmettez son handle à l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="64d4c-198">When a user selects a folder that belongs to your namespace extension, you create a window and pass its handle to Windows Explorer.</span></span> <span data-ttu-id="64d4c-199">Cette fenêtre devient un enfant de la fenêtre d’affichage des dossiers.</span><span class="sxs-lookup"><span data-stu-id="64d4c-199">This window becomes a child of the folder view window.</span></span> <span data-ttu-id="64d4c-200">L’Explorateur Windows fournit les dimensions de la fenêtre d’affichage des dossiers, mais n’impose aucune restriction sur le contenu de votre fenêtre enfant.</span><span class="sxs-lookup"><span data-stu-id="64d4c-200">Windows Explorer provides the dimensions of the folder view window but places no restrictions on the content of your child window.</span></span> <span data-ttu-id="64d4c-201">Vous pouvez ensuite utiliser la fenêtre enfant pour afficher l’affichage des dossiers du dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-201">You can then use the child window to display the folder's folder view.</span></span>

<span data-ttu-id="64d4c-202">Les extensions d’espace de noms utilisent l’une des deux approches suivantes pour créer un affichage des dossiers :</span><span class="sxs-lookup"><span data-stu-id="64d4c-202">Namespace extensions use one of two approaches for creating a folder view:</span></span>

-   <span data-ttu-id="64d4c-203">Utilisez votre fenêtre enfant pour héberger un contrôle [List View](../controls/list-view-control-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="64d4c-203">Use your child window to host a [list view](../controls/list-view-control-reference.md) control.</span></span> <span data-ttu-id="64d4c-204">Ce contrôle vous permet d’afficher le contenu d’un dossier à peu près de la même façon que l' [affichage classique](../lwef/web-view.md)de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="64d4c-204">This control allows you to display the contents of a folder in much the same way as the Windows Explorer [classic view](../lwef/web-view.md).</span></span>
-   <span data-ttu-id="64d4c-205">Utilisez votre fenêtre enfant pour héberger un [contrôle WebBrowser](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752044(v=vs.85)) et utilisez un document DHTML (Dynamic HTML) pour afficher le contenu du dossier.</span><span class="sxs-lookup"><span data-stu-id="64d4c-205">Use your child window to host a [WebBrowser control](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752044(v=vs.85)) and use a Dynamic HTML (DHTML) document to display the contents of the folder.</span></span>

<span data-ttu-id="64d4c-206">Les deux approches affichent une vue de dossier qui ressemble beaucoup à celle affichée pour les dossiers système.</span><span class="sxs-lookup"><span data-stu-id="64d4c-206">Both approaches display a folder view that looks very much like that displayed for system folders.</span></span> <span data-ttu-id="64d4c-207">Toutefois, si vous souhaitez utiliser un autre modèle d’affichage, vous êtes libre de le faire.</span><span class="sxs-lookup"><span data-stu-id="64d4c-207">However, if you want to use a different display scheme, you are free to do so.</span></span>

### <a name="menu-bar-and-toolbars"></a><span data-ttu-id="64d4c-208">Barre de menus et barres d’outils</span><span class="sxs-lookup"><span data-stu-id="64d4c-208">Menu Bar and Toolbars</span></span>

<span data-ttu-id="64d4c-209">Comme la plupart des applications Windows, l’Explorateur Windows fournit à l’utilisateur un ensemble d’outils.</span><span class="sxs-lookup"><span data-stu-id="64d4c-209">Like most Windows applications, Windows Explorer provides the user with a collection of tools.</span></span> <span data-ttu-id="64d4c-210">Une sélection complète d’outils est disponible via la barre de menus.</span><span class="sxs-lookup"><span data-stu-id="64d4c-210">A complete selection of tools is available through the menu bar.</span></span> <span data-ttu-id="64d4c-211">Les outils les plus couramment utilisés sont également représentés par des boutons ou des zones d’édition dans une barre d’outils.</span><span class="sxs-lookup"><span data-stu-id="64d4c-211">The more commonly used tools are also represented by buttons or edit boxes on a toolbar.</span></span> <span data-ttu-id="64d4c-212">Contrairement à de nombreuses applications Windows, la barre de menus de l’Explorateur Windows est en fait un [contrôle de barre d’outils](../controls/toolbar-control-reference.md) qui a été personnalisé pour se comporter comme un menu conventionnel.</span><span class="sxs-lookup"><span data-stu-id="64d4c-212">Unlike many Windows applications, the Windows Explorer menu bar is actually a [toolbar control](../controls/toolbar-control-reference.md) that has been customized to behave like a conventional menu.</span></span> <span data-ttu-id="64d4c-213">La barre de menus et la barre d’outils sont incorporées dans un [contrôle rebar](../controls/rebar-control-reference.md) pour permettre aux utilisateurs d’organiser les contrôles en fonction de leurs besoins.</span><span class="sxs-lookup"><span data-stu-id="64d4c-213">Both the menu bar and the toolbar are incorporated into a [rebar control](../controls/rebar-control-reference.md) to allow users to organize the individual controls to suit their needs.</span></span>

<span data-ttu-id="64d4c-214">Par défaut, l’Explorateur Windows prend en charge un ensemble standard de boutons et d’éléments de menu, tels que copier et propriétés.</span><span class="sxs-lookup"><span data-stu-id="64d4c-214">By default, Windows Explorer supports a standard set of buttons and menu items, such as Copy and Properties.</span></span> <span data-ttu-id="64d4c-215">Votre extension d’espace de noms peut personnaliser la barre de menus et les barres d’outils en supprimant les outils standard et en ajoutant des outils personnalisés.</span><span class="sxs-lookup"><span data-stu-id="64d4c-215">Your namespace extension can customize the menu bar and toolbars by deleting standard tools and adding custom tools.</span></span> <span data-ttu-id="64d4c-216">Lorsque votre objet de vue de dossier est initialisé, l’Explorateur Windows passe un pointeur vers son interface [**IShellBrowser**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) .</span><span class="sxs-lookup"><span data-stu-id="64d4c-216">When your folder view object is initialized, Windows Explorer passes a pointer to its [**IShellBrowser**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface.</span></span> <span data-ttu-id="64d4c-217">Cette interface prend en charge plusieurs méthodes que vous pouvez appeler pour personnaliser la barre de menus et la barre d’outils.</span><span class="sxs-lookup"><span data-stu-id="64d4c-217">This interface supports several methods that you can call to customize the menu bar and toolbar.</span></span> <span data-ttu-id="64d4c-218">Lorsque l’utilisateur sélectionne l’un de vos éléments de menu personnalisés ou boutons de la barre d’outils, l’Explorateur Windows transmet les \_ messages de commande WM pour les éléments de menu et de barre d’outils personnalisés à la procédure de fenêtre de votre fenêtre enfant.</span><span class="sxs-lookup"><span data-stu-id="64d4c-218">When the user selects one of your custom menu items or toolbar buttons, Windows Explorer forwards WM\_COMMAND messages for custom menu and toolbar items to your child window's window procedure.</span></span>

### <a name="status-bar"></a><span data-ttu-id="64d4c-219">Barre d’état</span><span class="sxs-lookup"><span data-stu-id="64d4c-219">Status Bar</span></span>

<span data-ttu-id="64d4c-220">La barre d’état de l’Explorateur Windows affiche des informations sur l’objet actuellement sélectionné.</span><span class="sxs-lookup"><span data-stu-id="64d4c-220">The Windows Explorer status bar displays information about the currently selected object.</span></span> <span data-ttu-id="64d4c-221">Votre extension d’espace de noms peut utiliser la barre d’État pour afficher des informations d’État, telles qu’une chaîne de texte.</span><span class="sxs-lookup"><span data-stu-id="64d4c-221">Your namespace extension can use the status bar to display status information, such as a text string.</span></span> <span data-ttu-id="64d4c-222">Vous pouvez personnaliser la barre d’État en appelant [**IShellBrowser**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).</span><span class="sxs-lookup"><span data-stu-id="64d4c-222">You can customize the status bar by calling [**IShellBrowser**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).</span></span>

 

 
