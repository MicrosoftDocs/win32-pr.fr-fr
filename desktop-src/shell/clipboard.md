---
description: Les formats de presse-papiers de l’interpréteur de commandes sont utilisés pour identifier le type de données de Shell transférées via le presse-papiers.
ms.assetid: fb8ce5d3-3215-4e05-a916-4d4a803464d2
title: Formats de presse-papiers de Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 674ccc33db3a35a1a60abb549f5e1ab5b5c96760
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103750268"
---
# <a name="shell-clipboard-formats"></a><span data-ttu-id="a6c47-103">Formats de presse-papiers de Shell</span><span class="sxs-lookup"><span data-stu-id="a6c47-103">Shell Clipboard Formats</span></span>

<span data-ttu-id="a6c47-104">Les formats de presse-papiers de l’interpréteur de commandes sont utilisés pour identifier le type de données de Shell transférées via le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="a6c47-104">Shell clipboard formats are used to identify the type of Shell data being transferred through the clipboard.</span></span> <span data-ttu-id="a6c47-105">La plupart des formats de presse-papiers de l’interpréteur de commandes identifient un type de données, par exemple une liste de noms de fichiers ou de pointeurs vers des listes d’identificateurs d’élément (PIDL).</span><span class="sxs-lookup"><span data-stu-id="a6c47-105">Most Shell clipboard formats identify a type of data, such as a list of file names or pointers to item identifier lists (PIDLs).</span></span> <span data-ttu-id="a6c47-106">Toutefois, certains formats sont utilisés pour la communication entre la source et la cible.</span><span class="sxs-lookup"><span data-stu-id="a6c47-106">However, some formats are used for communication between source and target.</span></span> <span data-ttu-id="a6c47-107">Ils peuvent accélérer le processus de transfert de données en prenant en charge les opérations de Shell, telles que le déplacement et la [delete_on_paste](datascenarios.md) [optimisés](datascenarios.md) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-107">They can expedite the data transfer process by supporting Shell operations such as [optimized move](datascenarios.md) and [delete_on_paste](datascenarios.md).</span></span> <span data-ttu-id="a6c47-108">Les données de l’interpréteur de commandes sont toujours contenues dans un [objet de données](dataobject.md) qui utilise une structure [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) comme un moyen plus général de caractériser les données.</span><span class="sxs-lookup"><span data-stu-id="a6c47-108">Shell data is always contained in a [data object](dataobject.md) that uses a [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as a more general way to characterize data.</span></span> <span data-ttu-id="a6c47-109">Le membre **cfFormat** de la structure est défini sur le format du presse-papiers pour l’élément de données particulier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-109">The structure's **cfFormat** member is set to the clipboard format for the particular item of data.</span></span> <span data-ttu-id="a6c47-110">Les autres membres fournissent des informations supplémentaires, telles que le mécanisme de transfert de données.</span><span class="sxs-lookup"><span data-stu-id="a6c47-110">The other members provide additional information, such as the data transfer mechanism.</span></span> <span data-ttu-id="a6c47-111">Les données sont contenues dans une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui l’accompagne.</span><span class="sxs-lookup"><span data-stu-id="a6c47-111">The data is contained in an accompanying [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure.</span></span>

> [!Note]  
> <span data-ttu-id="a6c47-112">Les identificateurs de format du presse-papiers standard se présentent sous la forme CF_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="a6c47-112">Standard clipboard format identifiers have the form CF_ *XXX*.</span></span> <span data-ttu-id="a6c47-113">Un exemple courant est CF_TEXT, qui est utilisé pour transférer des données texte ANSI.</span><span class="sxs-lookup"><span data-stu-id="a6c47-113">A common example is CF_TEXT, which is used for transferring ANSI text data.</span></span> <span data-ttu-id="a6c47-114">Ces identificateurs ont des valeurs prédéfinies et peuvent être utilisés directement avec les structures [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-114">These identifiers have predefined values and can be used directly with [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures.</span></span> <span data-ttu-id="a6c47-115">À l’exception de [CF_HDROP](#cf_hdrop), les identificateurs de format de Shell ne sont pas prédéfinis.</span><span class="sxs-lookup"><span data-stu-id="a6c47-115">With the exception of [CF_HDROP](#cf_hdrop), Shell format identifiers are not predefined.</span></span> <span data-ttu-id="a6c47-116">À l’exception de DragWindow, ils se présentent sous la forme CFSTR_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="a6c47-116">With the exception of DragWindow, they have the form CFSTR_ *XXX*.</span></span> <span data-ttu-id="a6c47-117">Pour différencier ces valeurs des formats prédéfinis, ils sont souvent appelés simples *formats*.</span><span class="sxs-lookup"><span data-stu-id="a6c47-117">To differentiate these values from predefined formats, they are often referred to as simply *formats*.</span></span> <span data-ttu-id="a6c47-118">Toutefois, à la différence des formats prédéfinis, ils doivent être inscrits par source et cible avant de pouvoir être utilisés pour transférer des données.</span><span class="sxs-lookup"><span data-stu-id="a6c47-118">However, unlike predefined formats, they must be registered by both source and target before they can be used to transfer data.</span></span> <span data-ttu-id="a6c47-119">Pour inscrire un format de Shell, incluez le fichier d’en-tête shlobj. h et transmettez l’identificateur de format CFSTR_ *xxx* à [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span><span class="sxs-lookup"><span data-stu-id="a6c47-119">To register a Shell format, include the Shlobj.h header file and pass the CFSTR_ *XXX* format identifier to [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="a6c47-120">Cette fonction retourne une valeur de format de presse-papiers valide, qui peut ensuite être utilisée en tant que membre **cfFormat** d’une structure **FORMATETC** .</span><span class="sxs-lookup"><span data-stu-id="a6c47-120">This function returns a valid clipboard format value, which can then be used as the **cfFormat** member of a **FORMATETC** structure.</span></span>

 

<span data-ttu-id="a6c47-121">Les formats du presse-papiers de l’interpréteur de commandes sont organisés ici en trois groupes, en fonction de leur utilisation.</span><span class="sxs-lookup"><span data-stu-id="a6c47-121">The Shell clipboard formats are organized here into three groups, based on how they are used.</span></span>

-   [<span data-ttu-id="a6c47-122">Formats pour le transfert d’objets de système de fichiers</span><span class="sxs-lookup"><span data-stu-id="a6c47-122">Formats for Transferring File System Objects</span></span>](#formats-for-transferring-file-system-objects)
    -   [<span data-ttu-id="a6c47-123">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="a6c47-123">CF_HDROP</span></span>](#cf_hdrop)
    -   [<span data-ttu-id="a6c47-124">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="a6c47-124">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
    -   [<span data-ttu-id="a6c47-125">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="a6c47-125">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
    -   [<span data-ttu-id="a6c47-126">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="a6c47-126">CFSTR_FILENAME</span></span>](#cfstr_filename)
    -   [<span data-ttu-id="a6c47-127">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="a6c47-127">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
    -   [<span data-ttu-id="a6c47-128">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="a6c47-128">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
    -   [<span data-ttu-id="a6c47-129">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="a6c47-129">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
    -   [<span data-ttu-id="a6c47-130">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="a6c47-130">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)
-   [<span data-ttu-id="a6c47-131">Formats pour le transfert d’objets virtuels</span><span class="sxs-lookup"><span data-stu-id="a6c47-131">Formats for Transferring Virtual Objects</span></span>](#formats-for-transferring-virtual-objects)
    -   [<span data-ttu-id="a6c47-132">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="a6c47-132">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
    -   [<span data-ttu-id="a6c47-133">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="a6c47-133">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
    -   [<span data-ttu-id="a6c47-134">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="a6c47-134">CFSTR_INETURL</span></span>](#cfstr_ineturl)
    -   [<span data-ttu-id="a6c47-135">CFSTR_SHELLURL (déconseillée)</span><span class="sxs-lookup"><span data-stu-id="a6c47-135">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)
-   [<span data-ttu-id="a6c47-136">Formats pour la communication entre la source et la cible</span><span class="sxs-lookup"><span data-stu-id="a6c47-136">Formats for Communication Between Source and Target</span></span>](#formats-for-communication-between-source-and-target)
    -   [<span data-ttu-id="a6c47-137">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="a6c47-137">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
    -   [<span data-ttu-id="a6c47-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
    -   [<span data-ttu-id="a6c47-139">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="a6c47-139">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
    -   [<span data-ttu-id="a6c47-140">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-140">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
    -   [<span data-ttu-id="a6c47-141">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-141">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
    -   [<span data-ttu-id="a6c47-142">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="a6c47-142">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
    -   [<span data-ttu-id="a6c47-143">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="a6c47-143">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
    -   [<span data-ttu-id="a6c47-144">DragWindow</span><span class="sxs-lookup"><span data-stu-id="a6c47-144">DragWindow</span></span>](#dragwindow)

## <a name="formats-for-transferring-file-system-objects"></a><span data-ttu-id="a6c47-145">Formats pour le transfert d’objets de système de fichiers</span><span class="sxs-lookup"><span data-stu-id="a6c47-145">Formats for Transferring File System Objects</span></span>

<span data-ttu-id="a6c47-146">Ces formats sont utilisés pour transférer un ou plusieurs fichiers ou d’autres objets Shell.</span><span class="sxs-lookup"><span data-stu-id="a6c47-146">These formats are used to transfer one or more files or other Shell objects.</span></span>

-   [<span data-ttu-id="a6c47-147">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="a6c47-147">CF_HDROP</span></span>](#cf_hdrop)
-   [<span data-ttu-id="a6c47-148">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="a6c47-148">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
-   [<span data-ttu-id="a6c47-149">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="a6c47-149">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
-   [<span data-ttu-id="a6c47-150">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="a6c47-150">CFSTR_FILENAME</span></span>](#cfstr_filename)
-   [<span data-ttu-id="a6c47-151">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="a6c47-151">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
-   [<span data-ttu-id="a6c47-152">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="a6c47-152">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
-   [<span data-ttu-id="a6c47-153">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="a6c47-153">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
-   [<span data-ttu-id="a6c47-154">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="a6c47-154">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)

### <a name="cf_hdrop"></a><span data-ttu-id="a6c47-155">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="a6c47-155">CF_HDROP</span></span>

<span data-ttu-id="a6c47-156">Ce format de presse-papiers est utilisé lors du transfert des emplacements d’un groupe de fichiers existants.</span><span class="sxs-lookup"><span data-stu-id="a6c47-156">This clipboard format is used when transferring the locations of a group of existing files.</span></span> <span data-ttu-id="a6c47-157">Contrairement aux autres formats de Shell, il est prédéfini, donc il n’est pas nécessaire d’appeler [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span><span class="sxs-lookup"><span data-stu-id="a6c47-157">Unlike the other Shell formats, it is predefined, so there is no need to call [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="a6c47-158">Les données se composent d’une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-158">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-159">Le membre **HGLOBAL** de la structure pointe vers une structure [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) comme membre **HGLOBAL** .</span><span class="sxs-lookup"><span data-stu-id="a6c47-159">The structure's **hGlobal** member points to a [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure as its **hGlobal** member.</span></span>

<span data-ttu-id="a6c47-160">Le membre **fichiers pfile** de la structure [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contient un décalage vers un tableau de caractères double se terminant par un caractère **null** qui contient les noms de fichiers.</span><span class="sxs-lookup"><span data-stu-id="a6c47-160">The **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains an offset to a double **null**-terminated character array that contains the file names.</span></span> <span data-ttu-id="a6c47-161">Si vous extrayez un format de CF_HDROP à partir d’un objet de données, vous pouvez utiliser [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) pour extraire des noms de fichiers individuels de l’objet mémoire globale.</span><span class="sxs-lookup"><span data-stu-id="a6c47-161">If you are extracting a CF_HDROP format from a data object, you can use [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) to extract individual file names from the global memory object.</span></span> <span data-ttu-id="a6c47-162">Si vous créez un format de CF_HDROP à placer dans un objet de données, vous devrez construire le tableau de noms de fichiers.</span><span class="sxs-lookup"><span data-stu-id="a6c47-162">If you are creating a CF_HDROP format to place in a data object, you will need to construct the file name array.</span></span>

<span data-ttu-id="a6c47-163">Le tableau de noms de fichiers se compose d’une série de chaînes, chacune contenant le chemin d’accès complet d’un fichier, y compris le caractère **null** de fin.</span><span class="sxs-lookup"><span data-stu-id="a6c47-163">The file name array consists of a series of strings, each containing one file's fully qualified path, including the terminating **NULL** character.</span></span> <span data-ttu-id="a6c47-164">Un caractère **null** supplémentaire est ajouté à la chaîne finale pour terminer le tableau.</span><span class="sxs-lookup"><span data-stu-id="a6c47-164">An additional **null** character is appended to the final string to terminate the array.</span></span> <span data-ttu-id="a6c47-165">Par exemple, si les fichiers c : \\temp1.txt et c : \\temp2.txt sont en cours de transfert, le tableau de caractères se présente comme suit :</span><span class="sxs-lookup"><span data-stu-id="a6c47-165">For example, if the files c:\\temp1.txt and c:\\temp2.txt are being transferred, the character array looks like this:</span></span>


```CMD
c:\temp1.txt'\0'c:\temp2.txt'\0''\0'
```

> [!Note]  
> <span data-ttu-id="a6c47-166">Dans cet exemple, « \\ 0 » est utilisé pour représenter le caractère **null** , et non les caractères littéraux qui doivent être inclus.</span><span class="sxs-lookup"><span data-stu-id="a6c47-166">In this example, '\\0' is used to represent the **null** character, not the literal characters that should be included.</span></span>


<span data-ttu-id="a6c47-167">Si l’objet a été copié dans le presse-papiers dans le cadre d’une opération de glisser-déplacer, le membre **PT** de la structure [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contient les coordonnées du point où l’objet a été supprimé.</span><span class="sxs-lookup"><span data-stu-id="a6c47-167">If the object was copied to the clipboard as part of a drag-and-drop operation, the **pt** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains the coordinates of the point where the object was dropped.</span></span> <span data-ttu-id="a6c47-168">Vous pouvez utiliser [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) pour extraire les coordonnées du curseur.</span><span class="sxs-lookup"><span data-stu-id="a6c47-168">You can use [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) to extract the cursor coordinates.</span></span>

<span data-ttu-id="a6c47-169">Si ce format est présent dans un objet de données, une boucle OLE Drag simule [**WM_DROPFILES**](wm-dropfiles.md) fonctionnalité avec des cibles de dépôt non-OLE.</span><span class="sxs-lookup"><span data-stu-id="a6c47-169">If this format is present in a data object, an OLE drag loop simulates [**WM_DROPFILES**](wm-dropfiles.md) functionality with non-OLE drop targets.</span></span> <span data-ttu-id="a6c47-170">Cela est important si votre application est la source d’une opération de glisser-déplacer sur un système Windows 3,1.</span><span class="sxs-lookup"><span data-stu-id="a6c47-170">This is important if your application is the source of a drag-and-drop operation on a Windows 3.1 system.</span></span>

### <a name="cfstr_filecontents"></a><span data-ttu-id="a6c47-171">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="a6c47-171">CFSTR_FILECONTENTS</span></span>

<span data-ttu-id="a6c47-172">Cet identificateur de format est utilisé avec le format [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) pour transférer des données comme s’il s’agissait d’un fichier, quelle que soit la manière dont il est réellement stocké.</span><span class="sxs-lookup"><span data-stu-id="a6c47-172">This format identifier is used with the [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format to transfer data as if it were a file, regardless of how it is actually stored.</span></span> <span data-ttu-id="a6c47-173">Les données se composent d’une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui représente le contenu d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-173">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that represents the contents of one file.</span></span> <span data-ttu-id="a6c47-174">Le fichier est normalement représenté sous la forme d’un objet de flux, ce qui évite d’avoir à placer le contenu du fichier en mémoire.</span><span class="sxs-lookup"><span data-stu-id="a6c47-174">The file is normally represented as a stream object, which avoids having to place the contents of the file in memory.</span></span> <span data-ttu-id="a6c47-175">Dans ce cas, le membre **TYMED** de la structure **STGMEDIUM** est défini sur TYMED_ISTREAM, et le fichier est représenté par une interface [**ISTREAM**](/windows/win32/api/objidl/nn-objidl-istream) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-175">In that case, the **tymed** member of the **STGMEDIUM** structure is set to TYMED_ISTREAM, and the file is represented by an [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) interface.</span></span> <span data-ttu-id="a6c47-176">Le fichier peut également être un objet de stockage ou de mémoire globale (TYMED_ISTORAGE ou TYMED_HGLOBAL).</span><span class="sxs-lookup"><span data-stu-id="a6c47-176">The file can also be a storage or global memory object (TYMED_ISTORAGE or TYMED_HGLOBAL).</span></span> <span data-ttu-id="a6c47-177">Le format de CFSTR_FILEDESCRIPTOR associé contient une structure [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) pour chaque fichier qui spécifie le nom et les attributs du fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-177">The associated CFSTR_FILEDESCRIPTOR format contains a [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file that specifies the file's name and attributes.</span></span>

<span data-ttu-id="a6c47-178">La cible traite les données associées à un format de CFSTR_FILECONTENTS comme s’il s’agissait d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-178">The target treats the data associated with a CFSTR_FILECONTENTS format as if it were a file.</span></span> <span data-ttu-id="a6c47-179">Quand la cible appelle [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) pour extraire les données, elle spécifie un fichier particulier en définissant le membre **Lindex** de la structure [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) sur l’index de base zéro de la structure [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) du fichier dans le format d' [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) qui l’accompagne.</span><span class="sxs-lookup"><span data-stu-id="a6c47-179">When the target calls [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to extract the data, it specifies a particular file by setting the **lindex** member of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure in the accompanying [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format.</span></span> <span data-ttu-id="a6c47-180">La cible utilise ensuite le pointeur d’interface retourné ou le handle de mémoire globale pour extraire les données.</span><span class="sxs-lookup"><span data-stu-id="a6c47-180">The target then uses the returned interface pointer or global memory handle to extract the data.</span></span>

### <a name="cfstr_filedescriptor"></a><span data-ttu-id="a6c47-181">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="a6c47-181">CFSTR_FILEDESCRIPTOR</span></span>

<span data-ttu-id="a6c47-182">Cet identificateur de format est utilisé avec le format [CFSTR_FILECONTENTS](#cfstr_filecontents) pour transférer des données sous la forme d’un groupe de fichiers.</span><span class="sxs-lookup"><span data-stu-id="a6c47-182">This format identifier is used with the [CFSTR_FILECONTENTS](#cfstr_filecontents) format to transfer data as a group of files.</span></span> <span data-ttu-id="a6c47-183">Ces deux formats sont la méthode recommandée pour transférer des objets Shell qui ne sont pas stockés en tant que fichiers de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="a6c47-183">These two formats are the preferred way to transfer Shell objects that are not stored as file-system files.</span></span> <span data-ttu-id="a6c47-184">Par exemple, ces formats peuvent être utilisés pour transférer un groupe de messages électroniques en tant que fichiers individuels, même si chaque e-mail est stocké en tant que bloc de données dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="a6c47-184">For example, these formats can be used to transfer a group of email messages as individual files, even though each email is actually stored as a block of data in a database.</span></span> <span data-ttu-id="a6c47-185">Les données se composent d’une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-185">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-186">Le membre **hGlobal** de la structure pointe vers une structure [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) qui est suivie d’un tableau contenant une structure [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) pour chaque fichier du groupe.</span><span class="sxs-lookup"><span data-stu-id="a6c47-186">The structure's **hGlobal** member points to a [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) structure that is followed by an array containing one [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file in the group.</span></span> <span data-ttu-id="a6c47-187">Pour chaque structure **FILEDESCRIPTOR** , il existe un format de CFSTR_FILECONTENTS distinct qui contient le contenu du fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-187">For each **FILEDESCRIPTOR** structure, there is a separate CFSTR_FILECONTENTS format that contains the contents of the file.</span></span> <span data-ttu-id="a6c47-188">Pour identifier le format de CFSTR_FILECONTENTS d’un fichier particulier, définissez la valeur **Lindex** de la structure [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) sur l’index de base zéro de la structure **FILEDESCRIPTOR** du fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-188">To identify a particular file's CFSTR_FILECONTENTS format, set the **lIndex** value of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's **FILEDESCRIPTOR** structure.</span></span>

<span data-ttu-id="a6c47-189">Le format CFSTR_FILEDESCRIPTOR est couramment utilisé pour transférer des données comme s’il s’agissait d’un groupe de fichiers, quelle que soit la façon dont ils sont réellement stockés.</span><span class="sxs-lookup"><span data-stu-id="a6c47-189">The CFSTR_FILEDESCRIPTOR format is commonly used to transfer data as if it were a group of files, regardless of how it is actually stored.</span></span> <span data-ttu-id="a6c47-190">Du point de vue de la cible, chaque format de CFSTR_FILECONTENTS représente un fichier unique et est traité en conséquence.</span><span class="sxs-lookup"><span data-stu-id="a6c47-190">From the target's perspective, each CFSTR_FILECONTENTS format represents a single file and is treated accordingly.</span></span> <span data-ttu-id="a6c47-191">Toutefois, la source peut stocker les données de la manière choisie.</span><span class="sxs-lookup"><span data-stu-id="a6c47-191">However, the source can store the data in any way it chooses.</span></span> <span data-ttu-id="a6c47-192">Bien qu’un format de CSFTR_FILECONTENTS puisse correspondre à un seul fichier, il peut, par exemple, représenter des données extraites par la source à partir d’une base de données ou d’un document texte.</span><span class="sxs-lookup"><span data-stu-id="a6c47-192">While a CSFTR_FILECONTENTS format might correspond to a single file, it could also, for example, represent data extracted by the source from a database or text document.</span></span>

### <a name="cfstr_filename"></a><span data-ttu-id="a6c47-193">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="a6c47-193">CFSTR_FILENAME</span></span>

<span data-ttu-id="a6c47-194">Cet identificateur de format est utilisé pour transférer un fichier unique.</span><span class="sxs-lookup"><span data-stu-id="a6c47-194">This format identifier is used to transfer a single file.</span></span> <span data-ttu-id="a6c47-195">Les données se composent d’une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-195">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-196">Le membre **hGlobal** de la structure pointe vers une chaîne unique se terminant par un caractère **null** qui contient le chemin d’accès complet au fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-196">The structure's **hGlobal** member points to a single **null**-terminated string containing the file's fully qualified file path.</span></span> <span data-ttu-id="a6c47-197">Ce format a été remplacé par [CF_HDROP](#cf_hdrop), mais il est pris en charge pour la compatibilité descendante avec les applications Windows 3,1.</span><span class="sxs-lookup"><span data-stu-id="a6c47-197">This format has been superseded by [CF_HDROP](#cf_hdrop), but it is supported for backward compatibility with Windows 3.1 applications.</span></span>

### <a name="cfstr_filenamemap"></a><span data-ttu-id="a6c47-198">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="a6c47-198">CFSTR_FILENAMEMAP</span></span>

<span data-ttu-id="a6c47-199">Cet identificateur de format est utilisé lorsqu’un groupe de fichiers au format [CF_HDROP](#cf_hdrop) est renommé et transféré.</span><span class="sxs-lookup"><span data-stu-id="a6c47-199">This format identifier is used when a group of files in [CF_HDROP](#cf_hdrop) format is being renamed as well as transferred.</span></span> <span data-ttu-id="a6c47-200">Les données se composent d’une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-200">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-201">Le membre **hGlobal** de la structure pointe vers un tableau de caractères double se terminant par un caractère **null**.</span><span class="sxs-lookup"><span data-stu-id="a6c47-201">The structure's **hGlobal** member points to a double **null**-terminated character array.</span></span> <span data-ttu-id="a6c47-202">Ce tableau contient un nouveau nom pour chaque fichier, dans l’ordre dans lequel les fichiers sont répertoriés dans le format d’CF_HDROP qui l’accompagne.</span><span class="sxs-lookup"><span data-stu-id="a6c47-202">This array contains a new name for each file, in the same order that the files are listed in the accompanying CF_HDROP format.</span></span> <span data-ttu-id="a6c47-203">Le format du tableau de caractères est le même que celui utilisé par CF_HDROP pour répertorier les fichiers transférés.</span><span class="sxs-lookup"><span data-stu-id="a6c47-203">The format of the character array is the same as that used by CF_HDROP to list the transferred files.</span></span>

### <a name="cfstr_mountedvolume"></a><span data-ttu-id="a6c47-204">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="a6c47-204">CFSTR_MOUNTEDVOLUME</span></span>

<span data-ttu-id="a6c47-205">Cet identificateur de format est utilisé pour transférer un chemin sur un volume monté.</span><span class="sxs-lookup"><span data-stu-id="a6c47-205">This format identifier is used to transfer a path on a mounted volume.</span></span> <span data-ttu-id="a6c47-206">Elle est similaire à [CF_HDROP](#cf_hdrop), mais elle ne contient qu’un seul chemin d’accès et peut gérer les chaînes de chemin d’accès plus longues qui peuvent être nécessaires pour représenter un chemin d’accès lorsque le volume est monté sur un dossier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-206">It is similar to [CF_HDROP](#cf_hdrop), but it contains only a single path and can handle the longer path strings that might be needed to represent a path when the volume is mounted on a folder.</span></span> <span data-ttu-id="a6c47-207">Les données se composent d’une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-207">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-208">Le membre **hGlobal** de la structure pointe vers une chaîne unique se terminant par un caractère **null** qui contient le chemin d’accès complet au fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-208">The structure's **hGlobal** member points to a single **null**-terminated string containing the fully qualified file path.</span></span> <span data-ttu-id="a6c47-209">La chaîne de chemin d’accès doit se terminer par un \\ caractère «», suivi de la **valeur null** de fin.</span><span class="sxs-lookup"><span data-stu-id="a6c47-209">The path string must end with a '\\' character, followed by the terminating **NULL**.</span></span>

<span data-ttu-id="a6c47-210">Avant Windows 2000, les volumes pouvaient être montés uniquement sur des lettres de lecteur.</span><span class="sxs-lookup"><span data-stu-id="a6c47-210">Prior to Windows 2000, volumes could be mounted only on drive letters.</span></span> <span data-ttu-id="a6c47-211">Pour les systèmes Windows 2000 et versions ultérieures avec un lecteur au format NTFS, vous pouvez également monter des volumes sur des dossiers vides.</span><span class="sxs-lookup"><span data-stu-id="a6c47-211">For Windows 2000 and later systems with an NTFS formatted drive, you can also mount volumes on empty folders.</span></span> <span data-ttu-id="a6c47-212">Cette fonctionnalité permet de monter un volume sans prendre de lettre de lecteur.</span><span class="sxs-lookup"><span data-stu-id="a6c47-212">This feature allows a volume to be mounted without taking up a drive letter.</span></span> <span data-ttu-id="a6c47-213">Le volume monté peut utiliser n’importe quel format actuellement pris en charge, y compris FAT, FAT32, NTFS et CDFS.</span><span class="sxs-lookup"><span data-stu-id="a6c47-213">The mounted volume can use any currently supported format, including FAT, FAT32, NTFS, and CDFS.</span></span>

<span data-ttu-id="a6c47-214">Vous pouvez ajouter des pages à une feuille de propriétés de propriétés de lecteur en implémentant un [Gestionnaire de feuille de propriétés](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="a6c47-214">You can add pages to a Drive Properties property sheet by implementing a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="a6c47-215">Si le volume est monté sur une lettre de lecteur, l’interpréteur de commandes transmet les informations de chemin d’accès au gestionnaire avec le format [CF_HDROP](#cf_hdrop) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-215">If the volume is mounted on a drive letter, the Shell passes path information to the handler with the [CF_HDROP](#cf_hdrop) format.</span></span> <span data-ttu-id="a6c47-216">Avec les systèmes Windows 2000 et versions ultérieures, le format de CF_HDROP est utilisé lorsqu’un volume est monté sur une lettre de lecteur, tout comme avec les systèmes précédents.</span><span class="sxs-lookup"><span data-stu-id="a6c47-216">With Windows 2000 and later systems, the CF_HDROP format is used when a volume is mounted on a drive letter, just as with earlier systems.</span></span> <span data-ttu-id="a6c47-217">Toutefois, si un volume est monté sur un dossier, le [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) identificateur de format est utilisé à la place de CF_HDROP.</span><span class="sxs-lookup"><span data-stu-id="a6c47-217">However, if a volume is mounted on a folder, the [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) format identifier is used instead of CF_HDROP.</span></span>

<span data-ttu-id="a6c47-218">Si seules les lettres de lecteur sont utilisées pour monter des volumes, seules les [CF_HDROP](#cf_hdrop) sont utilisées, et les gestionnaires de feuille de propriétés existants fonctionnent comme pour les systèmes antérieurs.</span><span class="sxs-lookup"><span data-stu-id="a6c47-218">If only drive letters will be used to mount volumes, only [CF_HDROP](#cf_hdrop) will be used, and existing property sheet handlers will work as they did with earlier systems.</span></span> <span data-ttu-id="a6c47-219">Toutefois, si vous souhaitez que votre gestionnaire affiche une page pour les volumes montés sur des dossiers, ainsi que des lettres de lecteur, le gestionnaire doit être en mesure de comprendre les formats CSFTR_MOUNTEDVOLUME et CF_HDROP.</span><span class="sxs-lookup"><span data-stu-id="a6c47-219">However, if you want your handler to display a page for volumes that are mounted on folders as well as drive letters, the handler must be able to understand both the CSFTR_MOUNTEDVOLUME and CF_HDROP formats.</span></span>

### <a name="cfstr_shellidlist"></a><span data-ttu-id="a6c47-220">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="a6c47-220">CFSTR_SHELLIDLIST</span></span>

<span data-ttu-id="a6c47-221">Cet identificateur de format est utilisé lors du transfert des emplacements d’un ou plusieurs objets d’espace de noms existants.</span><span class="sxs-lookup"><span data-stu-id="a6c47-221">This format identifier is used when transferring the locations of one or more existing namespace objects.</span></span> <span data-ttu-id="a6c47-222">Il est utilisé à peu près de la même façon que [CF_HDROP](#cf_hdrop), mais il contient PIDL au lieu des chemins de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="a6c47-222">It is used in much the same way as [CF_HDROP](#cf_hdrop), but it contains PIDLs instead of file system paths.</span></span> <span data-ttu-id="a6c47-223">L’utilisation de PIDL permet au format CFSTR_SHELLIDLIST de gérer des objets virtuels et des objets de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="a6c47-223">Using PIDLs allows the CFSTR_SHELLIDLIST format to handle virtual objects as well as file system objects.</span></span> <span data-ttu-id="a6c47-224">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-224">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-225">Le membre **hGlobal** de [**la structure pointe vers une structure**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) a.</span><span class="sxs-lookup"><span data-stu-id="a6c47-225">The structure's **hGlobal** member points to a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span>

<span data-ttu-id="a6c47-226">Le membre **aoffset** de la [**structure dispose**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) est un tableau contenant des décalages au début de la structure [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) pour chaque PIDL en cours de transfert.</span><span class="sxs-lookup"><span data-stu-id="a6c47-226">The **aoffset** member of the [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure is an array containing offsets to the beginning of the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure for each PIDL that is being transferred.</span></span> <span data-ttu-id="a6c47-227">Pour extraire un PIDL particulier, commencez par déterminer son index.</span><span class="sxs-lookup"><span data-stu-id="a6c47-227">To extract a particular PIDL, first determine its index.</span></span> <span data-ttu-id="a6c47-228">Ensuite, ajoutez la valeur **aoffset** qui correspond à cet index **à l’adresse de la structure d'** avant.</span><span class="sxs-lookup"><span data-stu-id="a6c47-228">Then, add the **aoffset** value that corresponds to that index to the address of the **CIDA** structure.</span></span>

<span data-ttu-id="a6c47-229">Le premier élément de **aoffset** contient un décalage vers le PIDL complet d’un dossier parent.</span><span class="sxs-lookup"><span data-stu-id="a6c47-229">The first element of **aoffset** contains an offset to the fully qualified PIDL of a parent folder.</span></span> <span data-ttu-id="a6c47-230">Si ce PIDL est vide, le dossier parent est le bureau.</span><span class="sxs-lookup"><span data-stu-id="a6c47-230">If this PIDL is empty, the parent folder is the desktop.</span></span> <span data-ttu-id="a6c47-231">Chacun des éléments restants du tableau contient un offset à l’un des PIDL à transférer.</span><span class="sxs-lookup"><span data-stu-id="a6c47-231">Each of the remaining elements of the array contains an offset to one of the PIDLs to be transferred.</span></span> <span data-ttu-id="a6c47-232">Tous ces PIDL sont relatifs au PIDL du dossier parent.</span><span class="sxs-lookup"><span data-stu-id="a6c47-232">All of these PIDLs are relative to the PIDL of the parent folder.</span></span>

<span data-ttu-id="a6c47-233">Les deux macros suivantes peuvent être utilisées pour récupérer des PIDL à partir [**d’une structure de**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) préversion.</span><span class="sxs-lookup"><span data-stu-id="a6c47-233">The following two macros can be used to retrieve PIDLs from a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span> <span data-ttu-id="a6c47-234">La première prend un pointeur vers la structure et récupère le PIDL du dossier parent.</span><span class="sxs-lookup"><span data-stu-id="a6c47-234">The first takes a pointer to the structure and retrieves the PIDL of the parent folder.</span></span> <span data-ttu-id="a6c47-235">Le deuxième prend un pointeur vers la structure et récupère l’un des autres PIDL, identifié par son index de base zéro.</span><span class="sxs-lookup"><span data-stu-id="a6c47-235">The second takes a pointer to the structure and retrieves one of the other PIDLs, identified by its zero-based index.</span></span>


```C++
#define GetPIDLFolder(pida) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[0])

#define GetPIDLItem(pida, i) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[i+1])
```

> [!Note]  
> <span data-ttu-id="a6c47-236">La valeur retournée par ces macros est un pointeur vers la structure [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) du PIDL.</span><span class="sxs-lookup"><span data-stu-id="a6c47-236">The value that is returned by these macros is a pointer to the PIDL's [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure.</span></span> <span data-ttu-id="a6c47-237">Dans la mesure où ces structures varient en longueur, vous devez déterminer la fin de la structure en parcourant chacune des structures [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) de la structure **ITEMIDLIST** jusqu’à atteindre la **valeur null** sur deux octets qui marque la fin.</span><span class="sxs-lookup"><span data-stu-id="a6c47-237">Since these structures vary in length, you must determine the end of the structure by walking through each of the **ITEMIDLIST** structure's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures until you reach the two-byte **NULL** that marks the end.</span></span>

### <a name="cfstr_shellidlistoffset"></a><span data-ttu-id="a6c47-238">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="a6c47-238">CFSTR_SHELLIDLISTOFFSET</span></span>

<span data-ttu-id="a6c47-239">Cet identificateur de format est utilisé avec les formats tels que [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist)et [CFSTR_FILECONTENTS](#cfstr_filecontents) pour spécifier la position d’un groupe d’objets après un transfert.</span><span class="sxs-lookup"><span data-stu-id="a6c47-239">This format identifier is used with formats such as [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist), and [CFSTR_FILECONTENTS](#cfstr_filecontents) to specify the position of a group of objects following a transfer.</span></span> <span data-ttu-id="a6c47-240">Les données se composent d’une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-240">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-241">Le membre **hGlobal** de la structure pointe vers un tableau de structures [**point**](/previous-versions//dd162805(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-241">The structure's **hGlobal** member points to an array of [**POINT**](/previous-versions//dd162805(v=vs.85)) structures.</span></span> <span data-ttu-id="a6c47-242">La première structure spécifie les coordonnées d’écran, en pixels, de l’angle supérieur gauche du rectangle qui englobe le groupe.</span><span class="sxs-lookup"><span data-stu-id="a6c47-242">The first structure specifies the screen coordinates, in pixels, of the upper-left corner of the rectangle that encloses the group.</span></span> <span data-ttu-id="a6c47-243">Les autres structures spécifient les emplacements des objets individuels par rapport à la position du groupe.</span><span class="sxs-lookup"><span data-stu-id="a6c47-243">The remainder of the structures specify the locations of the individual objects relative to the group's position.</span></span> <span data-ttu-id="a6c47-244">Ils doivent être dans le même ordre que celui utilisé pour répertorier les objets dans le format associé.</span><span class="sxs-lookup"><span data-stu-id="a6c47-244">They must be in the same order as that used to list the objects in the associated format.</span></span>

## <a name="formats-for-transferring-virtual-objects"></a><span data-ttu-id="a6c47-245">Formats pour le transfert d’objets virtuels</span><span class="sxs-lookup"><span data-stu-id="a6c47-245">Formats for Transferring Virtual Objects</span></span>

<span data-ttu-id="a6c47-246">Le format de CFSTR_SHELLIDLIST peut être utilisé pour transférer à la fois le système de fichiers et les objets virtuels.</span><span class="sxs-lookup"><span data-stu-id="a6c47-246">The CFSTR_SHELLIDLIST format can be used to transfer both file system and virtual objects.</span></span> <span data-ttu-id="a6c47-247">Toutefois, il existe également plusieurs formats spécialisés pour transférer des types particuliers d’objets virtuels.</span><span class="sxs-lookup"><span data-stu-id="a6c47-247">However, there are also several specialized formats for transferring particular types of virtual objects.</span></span>

-   [<span data-ttu-id="a6c47-248">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="a6c47-248">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
-   [<span data-ttu-id="a6c47-249">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="a6c47-249">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
-   [<span data-ttu-id="a6c47-250">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="a6c47-250">CFSTR_INETURL</span></span>](#cfstr_ineturl)
-   [<span data-ttu-id="a6c47-251">CFSTR_SHELLURL (déconseillée)</span><span class="sxs-lookup"><span data-stu-id="a6c47-251">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)

### <a name="cfstr_netresources"></a><span data-ttu-id="a6c47-252">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="a6c47-252">CFSTR_NETRESOURCES</span></span>

<span data-ttu-id="a6c47-253">Cet identificateur de format est utilisé lors du transfert des ressources réseau, telles qu’un domaine ou un serveur.</span><span class="sxs-lookup"><span data-stu-id="a6c47-253">This format identifier is used when transferring network resources, such as a domain or server.</span></span> <span data-ttu-id="a6c47-254">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-254">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-255">Le membre **hGlobal** de la structure pointe vers une structure [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-255">The structure's **hGlobal** member points to a [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) structure.</span></span> <span data-ttu-id="a6c47-256">Le membre **Nr** de cette structure indique une structure [**Resource**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) dont le membre **lpRemoteName** contient une chaîne terminée par le caractère **null** qui identifie la ressource réseau.</span><span class="sxs-lookup"><span data-stu-id="a6c47-256">The **nr** member of that structure indicates a [**NETRESOURCE**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) structure whose **lpRemoteName** member contains a **null**-terminated string identifying the network resource.</span></span> <span data-ttu-id="a6c47-257">La cible de déplacement peut ensuite utiliser les données avec l’une des fonctions d’API de [mise en réseau Windows (WNET)](../wnet/windows-networking-wnet-.md) , telles que [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), pour effectuer des opérations réseau sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="a6c47-257">The drop target can then use the data with any of the [Windows Networking (WNet)](../wnet/windows-networking-wnet-.md) API functions, such as [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), to perform network operations on the object.</span></span>

### <a name="cfstr_printergroup"></a><span data-ttu-id="a6c47-258">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="a6c47-258">CFSTR_PRINTERGROUP</span></span>

<span data-ttu-id="a6c47-259">Cet identificateur de format est utilisé lors du transfert des noms conviviaux des imprimantes.</span><span class="sxs-lookup"><span data-stu-id="a6c47-259">This format identifier is used when transferring the friendly names of printers.</span></span> <span data-ttu-id="a6c47-260">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-260">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-261">Le membre **hGlobal** de la structure pointe vers une chaîne dans le même format que celui utilisé avec [CF_HDROP](#cf_hdrop).</span><span class="sxs-lookup"><span data-stu-id="a6c47-261">The structure's **hGlobal** member points to a string in the same format as that used with [CF_HDROP](#cf_hdrop).</span></span> <span data-ttu-id="a6c47-262">Toutefois, le membre **fichiers pfile** de la structure [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contient un ou plusieurs noms conviviaux d’imprimantes au lieu de chemins d’accès aux fichiers.</span><span class="sxs-lookup"><span data-stu-id="a6c47-262">However, the **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains one or more friendly names of printers instead of file paths.</span></span>

### <a name="cfstr_ineturl"></a><span data-ttu-id="a6c47-263">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="a6c47-263">CFSTR_INETURL</span></span>

<span data-ttu-id="a6c47-264">Cet identificateur de format remplace [CFSTR_SHELLURL (déconseillé)](#cfstr_shellurl-deprecated).</span><span class="sxs-lookup"><span data-stu-id="a6c47-264">This format identifier replaces [CFSTR_SHELLURL (deprecated)](#cfstr_shellurl-deprecated).</span></span> <span data-ttu-id="a6c47-265">Si vous souhaitez que votre application manipule les URL du presse-papiers, utilisez CFSTR_INETURL au lieu de CFSTR_SHELLURL (déconseillé).</span><span class="sxs-lookup"><span data-stu-id="a6c47-265">If you want your application to manipulate clipboard URLs, use CFSTR_INETURL instead of CFSTR_SHELLURL (deprecated).</span></span> <span data-ttu-id="a6c47-266">Ce format donne la meilleure représentation du presse-papiers d’une URL unique.</span><span class="sxs-lookup"><span data-stu-id="a6c47-266">This format gives the best clipboard representation of a single URL.</span></span> <span data-ttu-id="a6c47-267">Si UNICODE n’est pas défini, l’application récupère la version CF_TEXT/CFSTR_SHELLURL de l’URL.</span><span class="sxs-lookup"><span data-stu-id="a6c47-267">If UNICODE is not defined, the application retrieves the CF_TEXT/CFSTR_SHELLURL version of the URL.</span></span> <span data-ttu-id="a6c47-268">Si UNICODE est défini, l’application récupère la version CF_UNICODE de l’URL.</span><span class="sxs-lookup"><span data-stu-id="a6c47-268">If UNICODE is defined, the application retrieves the CF_UNICODE version of the URL.</span></span>

### <a name="cfstr_shellurl-deprecated"></a><span data-ttu-id="a6c47-269">CFSTR_SHELLURL (déconseillée)</span><span class="sxs-lookup"><span data-stu-id="a6c47-269">CFSTR_SHELLURL (deprecated)</span></span>

> [!Note]  
> <span data-ttu-id="a6c47-270">Cet identificateur de format est déconseillé. Utilisez à la place CFSTR_INETURL.</span><span class="sxs-lookup"><span data-stu-id="a6c47-270">This format identifier has been deprecated; use CFSTR_INETURL instead.</span></span>

 

## <a name="formats-for-communication-between-source-and-target"></a><span data-ttu-id="a6c47-271">Formats pour la communication entre la source et la cible</span><span class="sxs-lookup"><span data-stu-id="a6c47-271">Formats for Communication Between Source and Target</span></span>

<span data-ttu-id="a6c47-272">Ces identificateurs de format autorisent la communication entre la source et la cible.</span><span class="sxs-lookup"><span data-stu-id="a6c47-272">These format identifiers allow communication between source and target.</span></span> <span data-ttu-id="a6c47-273">Les formats accompagnent les données et donnent aux applications un plus grand contrôle sur les opérations de glisser-copier-coller ou de glisser-déplacer impliquant des objets Shell.</span><span class="sxs-lookup"><span data-stu-id="a6c47-273">The formats accompany the data and give applications a greater degree of control over move-copy-paste or drag-and-drop operations involving Shell objects.</span></span>

-   [<span data-ttu-id="a6c47-274">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="a6c47-274">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
-   [<span data-ttu-id="a6c47-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
-   [<span data-ttu-id="a6c47-276">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="a6c47-276">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
-   [<span data-ttu-id="a6c47-277">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-277">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
-   [<span data-ttu-id="a6c47-278">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-278">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
-   [<span data-ttu-id="a6c47-279">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="a6c47-279">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
-   [<span data-ttu-id="a6c47-280">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="a6c47-280">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
-   [<span data-ttu-id="a6c47-281">DragWindow</span><span class="sxs-lookup"><span data-stu-id="a6c47-281">DragWindow</span></span>](#dragwindow)

### <a name="cfstr_indragloop"></a><span data-ttu-id="a6c47-282">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="a6c47-282">CFSTR_INDRAGLOOP</span></span>

<span data-ttu-id="a6c47-283">Cet identificateur de format est utilisé par un objet de données pour indiquer s’il se trouve dans une boucle de glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="a6c47-283">This format identifier is used by a data object to indicate whether it is in a drag-and-drop loop.</span></span> <span data-ttu-id="a6c47-284">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-284">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-285">Le membre **hGlobal** de la structure pointe vers une valeur **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="a6c47-285">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="a6c47-286">Si la valeur **DWORD** est différente de zéro, l’objet de données se trouve dans une boucle de glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="a6c47-286">If the **DWORD** value is nonzero, the data object is within a drag-and-drop loop.</span></span> <span data-ttu-id="a6c47-287">Si la valeur est définie sur zéro, l’objet de données ne se trouve pas dans une boucle de glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="a6c47-287">If the value is set to zero, the data object is not within a drag-and-drop loop.</span></span>

<span data-ttu-id="a6c47-288">Certaines cibles de déplacement peuvent appeler [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) et tenter d’extraire des données alors que l’objet se trouve toujours dans la boucle de glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="a6c47-288">Some drop targets might call [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) and attempt to extract data while the object is still within the drag-and-drop loop.</span></span> <span data-ttu-id="a6c47-289">Le rendu complet de l’objet pour chaque occurrence peut entraîner le blocage du curseur de glissement.</span><span class="sxs-lookup"><span data-stu-id="a6c47-289">Fully rendering the object for each such occurrence might cause the drag cursor to stall.</span></span> <span data-ttu-id="a6c47-290">Si l’objet de données prend en charge [CFSTR_INDRAGLOOP](#cfstr_indragloop), la cible peut à la place utiliser ce format pour vérifier l’état de la boucle de glisser-déplacer et éviter le rendu gourmand en mémoire de l’objet jusqu’à ce qu’il soit réellement supprimé.</span><span class="sxs-lookup"><span data-stu-id="a6c47-290">If the data object supports [CFSTR_INDRAGLOOP](#cfstr_indragloop), the target can instead use that format to check the status of the drag-and-drop loop and avoid memory intensive rendering of the object until it is actually dropped.</span></span> <span data-ttu-id="a6c47-291">Les formats qui consomment beaucoup de mémoire à restituer doivent toujours être inclus dans l’énumérateur [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) et dans les appels à [**IDataObject :: QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span><span class="sxs-lookup"><span data-stu-id="a6c47-291">The formats that are memory intensive to render should still be included in the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) enumerator and in calls to [**IDataObject::QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span></span> <span data-ttu-id="a6c47-292">Si l’objet de données ne définit pas CFSTR_INDRAGLOOP, il doit agir comme si la valeur était définie sur zéro.</span><span class="sxs-lookup"><span data-stu-id="a6c47-292">If the data object does not set CFSTR_INDRAGLOOP, it should act as if the value is set to zero.</span></span>

### <a name="cfstr_logicalperformeddropeffect"></a><span data-ttu-id="a6c47-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="a6c47-294">[Version 5,0.](versions.md) Cet identificateur de format permet à une source de déplacement d’appeler la méthode [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) de l’objet de données pour déterminer le résultat d’un transfert de données de Shell.</span><span class="sxs-lookup"><span data-stu-id="a6c47-294">[Version 5.0.](versions.md)This format identifier allows a drop source to call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to determine the outcome of a Shell data transfer.</span></span> <span data-ttu-id="a6c47-295">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-295">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-296">Le membre **hGlobal** de la structure pointe vers une valeur DWORD contenant une valeur [**DROPEFFECT**](../com/dropeffect-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-296">The structure's **hGlobal** member points to a DWORD containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span>

<span data-ttu-id="a6c47-297">L’identificateur de format [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) a été conçu pour permettre à la cible d’indiquer à l’objet de données la nature de l’opération qui a réellement eu lieu.</span><span class="sxs-lookup"><span data-stu-id="a6c47-297">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format identifier was intended to allow the target to indicate to the data object what operation actually took place.</span></span> <span data-ttu-id="a6c47-298">Toutefois, l’interpréteur de commandes utilise des [déplacements optimisés](datascenarios.md) pour les objets du système de fichiers dans la mesure du possible.</span><span class="sxs-lookup"><span data-stu-id="a6c47-298">However, the Shell uses [optimized moves](datascenarios.md) for file system objects whenever possible.</span></span> <span data-ttu-id="a6c47-299">Dans ce cas, le shell définit normalement la valeur CFSTR_PERFORMEDDROPEFFECT sur DROPEFFECT_NONE pour indiquer à l’objet de données que les données d’origine ont été supprimées.</span><span class="sxs-lookup"><span data-stu-id="a6c47-299">In that case, the Shell normally sets the CFSTR_PERFORMEDDROPEFFECT value to DROPEFFECT_NONE, to indicate to the data object that the original data has been deleted.</span></span> <span data-ttu-id="a6c47-300">Par conséquent, la source ne peut pas utiliser la valeur CFSTR_PERFORMEDDROPEFFECT pour déterminer quelle opération a eu lieu.</span><span class="sxs-lookup"><span data-stu-id="a6c47-300">Thus, the source cannot use the CFSTR_PERFORMEDDROPEFFECT value to determine which operation has taken place.</span></span> <span data-ttu-id="a6c47-301">Alors que la plupart des sources n’ont pas besoin de ces informations, il existe des exceptions.</span><span class="sxs-lookup"><span data-stu-id="a6c47-301">While most sources do not need this information, there are some exceptions.</span></span> <span data-ttu-id="a6c47-302">Par exemple, même si les déplacements optimisés éliminent la nécessité d’une source pour supprimer des données, il se peut que la source doive toujours mettre à jour une base de données associée pour indiquer que les fichiers ont été déplacés ou copiés.</span><span class="sxs-lookup"><span data-stu-id="a6c47-302">For instance, even though optimized moves eliminate the need for a source to delete any data, the source might still need to update a related database to indicate that the files have been moved or copied.</span></span>

<span data-ttu-id="a6c47-303">Si une source doit savoir quelle opération a eu lieu, elle peut appeler la méthode [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) de l’objet de données et demander le format de CFSTR_LOGICALPERFORMEDDROPEFFECT.</span><span class="sxs-lookup"><span data-stu-id="a6c47-303">If a source needs to know which operation took place, it can call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method and request the CFSTR_LOGICALPERFORMEDDROPEFFECT format.</span></span> <span data-ttu-id="a6c47-304">Ce format reflète essentiellement ce qui se passe du point de vue de l’utilisateur une fois l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="a6c47-304">This format essentially reflects what happens from the user's point of view after the operation is complete.</span></span> <span data-ttu-id="a6c47-305">Si un nouveau fichier est créé et que le fichier d’origine est supprimé, l’utilisateur voit une opération de déplacement et la valeur de données du format est définie sur DROPEFFECT_MOVE.</span><span class="sxs-lookup"><span data-stu-id="a6c47-305">If a new file is created and the original file is deleted, the user sees a move operation and the format's data value is set to DROPEFFECT_MOVE.</span></span> <span data-ttu-id="a6c47-306">Si le fichier d’origine est toujours présent, l’utilisateur voit une opération de copie et la valeur de données du format est définie sur DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="a6c47-306">If the original file is still there, the user sees a copy operation and the format's data value is set to DROPEFFECT_COPY.</span></span> <span data-ttu-id="a6c47-307">Si un lien a été créé, la valeur de données du format sera DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="a6c47-307">If a link was created, the format's data value will be DROPEFFECT_LINK.</span></span>

### <a name="cfstr_pastesucceeded"></a><span data-ttu-id="a6c47-308">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="a6c47-308">CFSTR_PASTESUCCEEDED</span></span>

<span data-ttu-id="a6c47-309">Cet identificateur de format est utilisé par la cible pour informer l’objet de données, par le biais de sa méthode [**IDataObject :: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) , qu’une opération de suppression sur le collage a réussi.</span><span class="sxs-lookup"><span data-stu-id="a6c47-309">This format identifier is used by the target to inform the data object, through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method, that a delete-on-paste operation succeeded.</span></span> <span data-ttu-id="a6c47-310">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-310">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-311">Le membre **hGlobal** de la structure pointe vers une valeur **DWORD** contenant une valeur [**DROPEFFECT**](../com/dropeffect-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-311">The structure's **hGlobal** member points to a **DWORD** containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span> <span data-ttu-id="a6c47-312">Ce format est utilisé pour notifier à l’objet de données qu’il doit terminer l’opération de coupe et supprimer les données d’origine, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="a6c47-312">This format is used to notify the data object that it should complete the cut operation and delete the original data, if necessary.</span></span> <span data-ttu-id="a6c47-313">Pour plus d’informations, consultez [opérations de suppression sur le collage](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="a6c47-313">For more information, see [Delete-on-Paste Operations](datascenarios.md).</span></span>

### <a name="cfstr_performeddropeffect"></a><span data-ttu-id="a6c47-314">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-314">CFSTR_PERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="a6c47-315">Cet identificateur de format est utilisé par la cible pour informer l’objet de données par le biais de sa méthode [**IDataObject :: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) du résultat d’un transfert de données.</span><span class="sxs-lookup"><span data-stu-id="a6c47-315">This format identifier is used by the target to inform the data object through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method of the outcome of a data transfer.</span></span> <span data-ttu-id="a6c47-316">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-316">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-317">Le membre **hGlobal** de la structure pointe vers une valeur **DWORD** définie sur la valeur [**DROPEFFECT**](../com/dropeffect-constants.md) appropriée, normalement DROPEFFECT_MOVE ou DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="a6c47-317">The structure's **hGlobal** member points to a **DWORD** set to the appropriate [**DROPEFFECT**](../com/dropeffect-constants.md) value, normally DROPEFFECT_MOVE or DROPEFFECT_COPY.</span></span>

<span data-ttu-id="a6c47-318">Ce format est normalement utilisé lorsque le résultat d’une opération peut être Move ou Copy, par exemple dans le cadre d’une opération de déplacement ou de suppression sur le collage [optimisée](datascenarios.md) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-318">This format is normally used when the outcome of an operation can be either move or copy, such as in an [optimized move](datascenarios.md) or delete-on-paste operation.</span></span> <span data-ttu-id="a6c47-319">Il fournit un moyen fiable pour la cible d’indiquer à l’objet de données ce qui s’est réellement produit.</span><span class="sxs-lookup"><span data-stu-id="a6c47-319">It provides a reliable way for the target to tell the data object what actually happened.</span></span> <span data-ttu-id="a6c47-320">Elle a été introduite, car la valeur de *pdwEffect* retournée par [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) n’indique pas quelle opération a eu lieu.</span><span class="sxs-lookup"><span data-stu-id="a6c47-320">It was introduced because the value of *pdwEffect* returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) did not reliably indicate which operation had taken place.</span></span> <span data-ttu-id="a6c47-321">Le format [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) est la méthode fiable pour indiquer qu’un déplacement non optimisé a eu lieu.</span><span class="sxs-lookup"><span data-stu-id="a6c47-321">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format is the reliable way to indicate that an unoptimized move has taken place.</span></span>

### <a name="cfstr_preferreddropeffect"></a><span data-ttu-id="a6c47-322">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="a6c47-322">CFSTR_PREFERREDDROPEFFECT</span></span>

<span data-ttu-id="a6c47-323">Cet identificateur de format est utilisé par la source pour spécifier si sa méthode préférée de transfert de données est Move ou Copy.</span><span class="sxs-lookup"><span data-stu-id="a6c47-323">This format identifier is used by the source to specify whether its preferred method of data transfer is move or copy.</span></span> <span data-ttu-id="a6c47-324">Une cible de déplacement demande ce format en appelant la méthode [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) de l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="a6c47-324">A drop target requests this format by calling the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span> <span data-ttu-id="a6c47-325">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-325">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-326">Le membre **hGlobal** de la structure pointe vers une valeur **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="a6c47-326">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="a6c47-327">Cette valeur est définie sur DROPEFFECT_MOVE si une opération de déplacement est préférable ou DROPEFFECT_COPY si une opération de copie est préférable.</span><span class="sxs-lookup"><span data-stu-id="a6c47-327">This value is set to DROPEFFECT_MOVE if a move operation is preferred or DROPEFFECT_COPY if a copy operation is preferred.</span></span>

<span data-ttu-id="a6c47-328">Cette fonctionnalité est utilisée lorsqu’une source peut prendre en charge une opération de déplacement ou de copie.</span><span class="sxs-lookup"><span data-stu-id="a6c47-328">This feature is used when a source can support either a move or copy operation.</span></span> <span data-ttu-id="a6c47-329">Elle utilise le format de [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) pour communiquer sa préférence à la cible.</span><span class="sxs-lookup"><span data-stu-id="a6c47-329">It uses the [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) format to communicate its preference to the target.</span></span> <span data-ttu-id="a6c47-330">Étant donné que la cible n’est pas obligée d’honorer la demande, la cible doit appeler la méthode [**IDataObject :: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) de la source avec un format [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) pour indiquer à l’objet de données quelle opération a été effectuée réellement.</span><span class="sxs-lookup"><span data-stu-id="a6c47-330">Because the target is not obligated to honor the request, the target must call the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method with a [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format to tell the data object which operation was actually performed.</span></span>

<span data-ttu-id="a6c47-331">Avec une opération de [suppression sur le collage](datascenarios.md) , le format de CFSTR_PREFERREDDROPFORMAT est utilisé pour indiquer à la cible si la source a effectué une coupe ou une copie.</span><span class="sxs-lookup"><span data-stu-id="a6c47-331">With a [delete-on-paste](datascenarios.md) operation, the CFSTR_PREFERREDDROPFORMAT format is used to tell the target whether the source did a cut or copy.</span></span> <span data-ttu-id="a6c47-332">Avec une opération de glisser-déplacer, vous pouvez utiliser CFSTR_PREFERREDDROPFORMAT pour spécifier l’action de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="a6c47-332">With a drag-and-drop operation, you can use CFSTR_PREFERREDDROPFORMAT to specify the Shell's action.</span></span> <span data-ttu-id="a6c47-333">Si ce format n’est pas présent, l’interpréteur de commandes effectue une action par défaut en fonction du contexte.</span><span class="sxs-lookup"><span data-stu-id="a6c47-333">If this format is not present, the Shell performs a default action, based on context.</span></span> <span data-ttu-id="a6c47-334">Par exemple, si un utilisateur fait glisser un fichier à partir d’un volume et le dépose sur un autre volume, l’action par défaut de l’interpréteur de commandes consiste à copier le fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-334">For instance, if a user drags a file from one volume and drops it on another volume, the Shell's default action is to copy the file.</span></span> <span data-ttu-id="a6c47-335">En incluant un format de CFSTR_PREFERREDDROPFORMAT dans l’objet de données, vous pouvez substituer l’action par défaut et indiquer explicitement à l’interpréteur de commandes de copier, déplacer ou lier le fichier.</span><span class="sxs-lookup"><span data-stu-id="a6c47-335">By including a CFSTR_PREFERREDDROPFORMAT format in the data object, you can override the default action and explicitly tell the Shell to copy, move, or link the file.</span></span> <span data-ttu-id="a6c47-336">Si l’utilisateur choisit de faire glisser avec le bouton droit, CFSTR_PREFERREDDROPFORMAT spécifie la commande par défaut dans le menu contextuel [glisser-déplacer](context-menu-handlers.md) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-336">If the user chooses to drag with the right button, CFSTR_PREFERREDDROPFORMAT specifies the default command on the [drag-and-drop](context-menu-handlers.md) shortcut menu.</span></span> <span data-ttu-id="a6c47-337">L’utilisateur est toujours libre de choisir d’autres commandes dans le menu.</span><span class="sxs-lookup"><span data-stu-id="a6c47-337">The user is still free to choose other commands on the menu.</span></span>

<span data-ttu-id="a6c47-338">Avant Microsoft Internet Explorer 4,0, une application indiquait qu’elle transférait des types de fichiers de raccourci en définissant FD_LINKUI dans le membre **dwFlags** de la structure [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-338">Before Microsoft Internet Explorer 4.0, an application indicated that it was transferring shortcut file types by setting FD_LINKUI in the **dwFlags** member of the [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure.</span></span> <span data-ttu-id="a6c47-339">Les cibles devaient ensuite utiliser un appel potentiellement fastidieux à [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) pour déterminer si l’indicateur de FD_LINKUI a été défini.</span><span class="sxs-lookup"><span data-stu-id="a6c47-339">Targets then had to use a potentially time-consuming call to [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to find out if the FD_LINKUI flag was set.</span></span> <span data-ttu-id="a6c47-340">À présent, la meilleure façon d’indiquer que les raccourcis sont transférés consiste à utiliser le format de CFSTR_PREFERREDDROPEFFECT défini sur DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="a6c47-340">Now, the preferred way to indicate that shortcuts are being transferred is to use the CFSTR_PREFERREDDROPEFFECT format set to DROPEFFECT_LINK.</span></span> <span data-ttu-id="a6c47-341">Toutefois, pour assurer la compatibilité descendante avec les systèmes plus anciens, les sources doivent toujours définir l’indicateur FD_LINKUI.</span><span class="sxs-lookup"><span data-stu-id="a6c47-341">However, for backward compatibility with older systems, sources should still set the FD_LINKUI flag.</span></span>

### <a name="cfstr_targetclsid"></a><span data-ttu-id="a6c47-342">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="a6c47-342">CFSTR_TARGETCLSID</span></span>

<span data-ttu-id="a6c47-343">Cet identificateur de format est utilisé par une cible pour fournir son CLSID à la source.</span><span class="sxs-lookup"><span data-stu-id="a6c47-343">This format identifier is used by a target to provide its CLSID to the source.</span></span> <span data-ttu-id="a6c47-344">Les données sont une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-344">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-345">Le membre **hGlobal** de la structure pointe vers le GUID CLSID de la cible de déplacement.</span><span class="sxs-lookup"><span data-stu-id="a6c47-345">The structure's **hGlobal** member points to the CLSID GUID of the drop target.</span></span>

<span data-ttu-id="a6c47-346">Ce format est principalement utilisé pour permettre la suppression d’objets en les faisant glisser vers la corbeille.</span><span class="sxs-lookup"><span data-stu-id="a6c47-346">This format is used primarily to allow objects to be deleted by dragging them to the Recycle Bin.</span></span> <span data-ttu-id="a6c47-347">Lorsqu’un objet est supprimé dans la corbeille, la méthode [**IDataObject :: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) de la source est appelée avec un CFSTR_TARGETCLSID format défini sur le CLSID de la corbeille (CLSID_RecycleBin).</span><span class="sxs-lookup"><span data-stu-id="a6c47-347">When an object is dropped in the Recycle Bin, the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method is called with a CFSTR_TARGETCLSID format set to the Recycle Bin's CLSID (CLSID_RecycleBin).</span></span> <span data-ttu-id="a6c47-348">La source peut ensuite supprimer l’objet d’origine.</span><span class="sxs-lookup"><span data-stu-id="a6c47-348">The source can then delete the original object.</span></span>

### <a name="cfstr_untrusteddragdrop"></a><span data-ttu-id="a6c47-349">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="a6c47-349">CFSTR_UNTRUSTEDDRAGDROP</span></span>

<span data-ttu-id="a6c47-350">Cet identificateur de format est utilisé par Windows Internet Explorer et le shell Windows pour fournir un mécanisme permettant de bloquer ou de demander des opérations de glisser-déplacer provenant d’Internet Explorer conjointement avec l’indicateur [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-350">This format identifier is used by Windows Internet Explorer and the Windows Shell to provide a mechanism through which to block or prompt for drag-and-drop operations originating from Internet Explorer in conjunction with the [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag.</span></span>

<span data-ttu-id="a6c47-351">**CFSTR_UNTRUSTEDDRAGDROP** est ajouté par la source d’une opération de glisser-déplacer pour spécifier que l’objet de données peut contenir des données non fiables.</span><span class="sxs-lookup"><span data-stu-id="a6c47-351">**CFSTR_UNTRUSTEDDRAGDROP** is added by the source of a drag-and-drop operation to specify that the data object might contain untrustworthy data.</span></span> <span data-ttu-id="a6c47-352">Les données sont représentées par une structure [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) qui contient un objet mémoire global.</span><span class="sxs-lookup"><span data-stu-id="a6c47-352">The data is represented by an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="a6c47-353">Le membre **hGlobal** de la structure pointe vers un **DWORD** défini sur un indicateur d' [**action d’URL**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) approprié pour déclencher une vérification de stratégie par le biais de la méthode [**IInternetSecurityManager ::P rocessurlaction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) , à l’aide de l’indicateur [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-353">The structure's **hGlobal** member points to a **DWORD** set to an appropriate [**URL Action**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag to cause a policy check through the [**IInternetSecurityManager::ProcessUrlAction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) method, using the [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) flag.</span></span>

### <a name="dragwindow"></a><span data-ttu-id="a6c47-354">DragWindow</span><span class="sxs-lookup"><span data-stu-id="a6c47-354">DragWindow</span></span>

<span data-ttu-id="a6c47-355">Ce format est utilisé dans une opération de glisser-déplacer pour identifier l’image de glissement d’un objet (fenêtre) afin que ses informations visuelles puissent être mises à jour dynamiquement.</span><span class="sxs-lookup"><span data-stu-id="a6c47-355">This format is used in a drag-and-drop operation to identify an object's drag image (window) so that its visual information can be updated dynamically.</span></span> <span data-ttu-id="a6c47-356">Lorsqu’un objet est glissé sur une cible de dépôt, une application met à jour sa structure [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) en réponse à la méthode [**IDropTarget ::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) ou [**IDropSource :: GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) .</span><span class="sxs-lookup"><span data-stu-id="a6c47-356">When an object is dragged over a drop target, an application updates its [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) structure in response to the [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) or [**IDropSource::GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) method.</span></span> <span data-ttu-id="a6c47-357">Le **DROPDESCRIPTION** est mis à jour avec une nouvelle valeur [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) qui indique la décoration à appliquer au visuel de la fenêtre de glissement. par exemple, une indication que le fichier est copié plutôt que déplacé ou que l’objet ne peut pas être supprimé à cet emplacement.</span><span class="sxs-lookup"><span data-stu-id="a6c47-357">The **DROPDESCRIPTION** is updated with a new [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) value that indicates the decoration to be applied to the drag window's visual; for instance, an indication that the file is being copied rather than moved or that the object cannot be dropped to that location.</span></span> <span data-ttu-id="a6c47-358">Toutefois, tant que l’objet n’a pas reçu de [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) message, les éléments visuels ne sont pas mis à jour.</span><span class="sxs-lookup"><span data-stu-id="a6c47-358">However, until the object receives a [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) message, the visuals are not updated.</span></span> <span data-ttu-id="a6c47-359">Ce format fournit le **HWND** de la fenêtre de glissement du destinataire à l’expéditeur du message de **DDWM_UPDATEWINDOW** .</span><span class="sxs-lookup"><span data-stu-id="a6c47-359">This format provides the **HWND** of the recipient drag window to the sender of the **DDWM_UPDATEWINDOW** message.</span></span>

<span data-ttu-id="a6c47-360">Les données du presse-papiers sont de type [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span><span class="sxs-lookup"><span data-stu-id="a6c47-360">The clipboard data is of type [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span></span> <span data-ttu-id="a6c47-361">Il s’agit d’une représentation **DWORD** d’un **HWND**.</span><span class="sxs-lookup"><span data-stu-id="a6c47-361">It is a **DWORD** representation of an **HWND**.</span></span> <span data-ttu-id="a6c47-362">Les données peuvent être passées à la fonction **ULongToHandle** , définie dans Basetsd. h, pour fournir un **HWND** 64 bits pour une utilisation sur Windows 64 bits.</span><span class="sxs-lookup"><span data-stu-id="a6c47-362">The data can be passed to the **ULongToHandle** function, defined in Basetsd.h, to provide a 64-bit **HWND** for use on 64-bit Windows.</span></span>

<span data-ttu-id="a6c47-363">Ce format ne nécessite pas l’inclusion de shlobj. h.</span><span class="sxs-lookup"><span data-stu-id="a6c47-363">This format does not require the inclusion of Shlobj.h.</span></span>

 

 
