---
description: La section obtenir l’ID d’un dossier a présenté deux approches pour obtenir le pointeur d’un objet Namespace vers une liste d’identificateurs d’éléments (PIDL).
ms.assetid: c99a2f6c-3144-41ec-ad97-59a30bfec9ab
title: Obtention d’informations sur le contenu d’un dossier
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7eb26e9df28af4811e74f2878eebb7af9d5c92a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991065"
---
# <a name="getting-information-about-the-contents-of-a-folder"></a><span data-ttu-id="b707e-103">Obtention d’informations sur le contenu d’un dossier</span><span class="sxs-lookup"><span data-stu-id="b707e-103">Getting Information About the Contents of a Folder</span></span>

<span data-ttu-id="b707e-104">La section [obtenir l’ID d’un dossier a](folder-id.md) présenté deux approches pour obtenir le pointeur d’un objet Namespace vers une liste d’identificateurs d’éléments (PIDL).</span><span class="sxs-lookup"><span data-stu-id="b707e-104">The [Getting a Folder's ID](folder-id.md) section discussed two approaches to getting a namespace object's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="b707e-105">Une question évidente est : une fois que vous avez un PIDL, que pouvez-vous en faire ?</span><span class="sxs-lookup"><span data-stu-id="b707e-105">One obvious question is: Once you have a PIDL, what can you do with it?</span></span> <span data-ttu-id="b707e-106">Une question associée est : que se passe-t-il si aucune de ces approches ne fonctionne ou convient à votre application ?</span><span class="sxs-lookup"><span data-stu-id="b707e-106">A related question is: What if neither approach works, or is suitable for your application?</span></span> <span data-ttu-id="b707e-107">La réponse aux deux questions requiert un examen plus approfondi de l’implémentation de l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="b707e-107">The answer to both questions requires taking a closer look at how the namespace is implemented.</span></span> <span data-ttu-id="b707e-108">La clé est l’interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="b707e-108">The key is the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

-   [<span data-ttu-id="b707e-109">Utilisation de l’interface IShellFolder</span><span class="sxs-lookup"><span data-stu-id="b707e-109">Using the IShellFolder Interface</span></span>](#using-the-ishellfolder-interface)
-   [<span data-ttu-id="b707e-110">Énumération du contenu d’un dossier</span><span class="sxs-lookup"><span data-stu-id="b707e-110">Enumerating the Contents of a Folder</span></span>](#enumerating-the-contents-of-a-folder)
-   [<span data-ttu-id="b707e-111">Détermination des noms d’affichage et d’autres propriétés</span><span class="sxs-lookup"><span data-stu-id="b707e-111">Determining Display Names and Other Properties</span></span>](#determining-display-names-and-other-properties)
-   [<span data-ttu-id="b707e-112">Obtention d’un pointeur vers l’interface IShellFolder d’un sous-dossier</span><span class="sxs-lookup"><span data-stu-id="b707e-112">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>](#getting-a-pointer-to-a-subfolders-ishellfolder-interface)
-   [<span data-ttu-id="b707e-113">Détermination du dossier parent d’un objet</span><span class="sxs-lookup"><span data-stu-id="b707e-113">Determining an Object's Parent Folder</span></span>](#determining-an-objects-parent-folder)

## <a name="using-the-ishellfolder-interface"></a><span data-ttu-id="b707e-114">Utilisation de l’interface IShellFolder</span><span class="sxs-lookup"><span data-stu-id="b707e-114">Using the IShellFolder Interface</span></span>

<span data-ttu-id="b707e-115">Plus haut dans cette documentation, les dossiers d’espace de noms étaient appelés objets.</span><span class="sxs-lookup"><span data-stu-id="b707e-115">Earlier in this documentation, namespace folders were referred to as objects.</span></span> <span data-ttu-id="b707e-116">Bien que, à ce stade, le terme était utilisé dans un sens faible, il s’agit en fait d’un bon sens.</span><span class="sxs-lookup"><span data-stu-id="b707e-116">Although, at that point, the term was used in a loose sense, it is actually true in a strict sense as well.</span></span> <span data-ttu-id="b707e-117">Chaque dossier d’espace de noms est représenté par un objet COM (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="b707e-117">Every namespace folder is represented by a Component Object Model (COM) object.</span></span> <span data-ttu-id="b707e-118">Chaque objet Folder expose un certain nombre d’interfaces qui peuvent être utilisées pour un large éventail de tâches.</span><span class="sxs-lookup"><span data-stu-id="b707e-118">Each folder object exposes a number of interfaces that can be used for a wide variety of tasks.</span></span> <span data-ttu-id="b707e-119">Certaines interfaces facultatives ne peuvent pas être exposées par tous les dossiers.</span><span class="sxs-lookup"><span data-stu-id="b707e-119">Some interfaces that are optional may not be exposed by all folders.</span></span> <span data-ttu-id="b707e-120">Toutefois, tous les dossiers doivent exposer l’interface fondamentale, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span><span class="sxs-lookup"><span data-stu-id="b707e-120">However, all folders must expose the fundamental interface, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span>

<span data-ttu-id="b707e-121">La première étape de l’utilisation d’un objet Folder consiste à récupérer un pointeur vers son interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="b707e-121">The first step in using a folder object is to retrieve a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="b707e-122">En plus de fournir l’accès aux autres interfaces de l’objet, **IShellFolder** expose un groupe de méthodes qui gèrent un certain nombre de tâches courantes, dont plusieurs sont décrites dans cette section.</span><span class="sxs-lookup"><span data-stu-id="b707e-122">In addition to providing access to the object's other interfaces, **IShellFolder** exposes a group of methods that handle a number of common tasks, several of which are discussed in this section.</span></span>

<span data-ttu-id="b707e-123">Pour récupérer un pointeur vers l’interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) d’un objet Namespace, vous devez d’abord appeler [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span><span class="sxs-lookup"><span data-stu-id="b707e-123">To retrieve a pointer to a namespace object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, you must first call [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span></span> <span data-ttu-id="b707e-124">Cette fonction retourne un pointeur vers l’interface **IShellFolder** de la racine de l’espace de noms, le bureau.</span><span class="sxs-lookup"><span data-stu-id="b707e-124">This function returns a pointer to the **IShellFolder** interface of the namespace root, the desktop.</span></span> <span data-ttu-id="b707e-125">Une fois que vous disposez de l’interface **IShellFolder** du bureau, vous pouvez procéder de différentes façons.</span><span class="sxs-lookup"><span data-stu-id="b707e-125">Once you have the desktop's **IShellFolder** interface, there a variety of ways to proceed.</span></span>

<span data-ttu-id="b707e-126">Si vous avez déjà le PIDL du dossier qui vous intéresse (par exemple, en appelant [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)), vous pouvez récupérer son interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) en appelant la méthode [**IShellFolder :: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) du bureau.</span><span class="sxs-lookup"><span data-stu-id="b707e-126">If you already have the PIDL of the folder you are interested in—for instance, by calling [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)—you can retrieve its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface by calling the desktop's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="b707e-127">Si vous avez le chemin d’accès d’un objet de système de fichiers, vous devez d’abord obtenir son PIDL en appelant la méthode [**IShellFolder ::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) du bureau, puis appeler **IShellFolder :: BindToObject**.</span><span class="sxs-lookup"><span data-stu-id="b707e-127">If you have the path of a file system object, you must first obtain its PIDL by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method and then call **IShellFolder::BindToObject**.</span></span> <span data-ttu-id="b707e-128">Si aucune de ces approches n’est applicable, vous pouvez utiliser d’autres méthodes **IShellFolder** pour naviguer dans l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="b707e-128">If neither of these approaches is applicable, you can use other **IShellFolder** methods to navigate the namespace.</span></span> <span data-ttu-id="b707e-129">Pour plus d’informations, consultez [navigation dans l’espace de noms](navigate.md).</span><span class="sxs-lookup"><span data-stu-id="b707e-129">For more information, see [Navigating the Namespace](navigate.md).</span></span>

## <a name="enumerating-the-contents-of-a-folder"></a><span data-ttu-id="b707e-130">Énumération du contenu d’un dossier</span><span class="sxs-lookup"><span data-stu-id="b707e-130">Enumerating the Contents of a Folder</span></span>

<span data-ttu-id="b707e-131">La première chose que vous souhaitez généralement faire avec un dossier est de savoir ce qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="b707e-131">The first thing you usually want to do with a folder is to find out what it contains.</span></span> <span data-ttu-id="b707e-132">Vous devez d’abord appeler la méthode [**IShellFolder :: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) du dossier.</span><span class="sxs-lookup"><span data-stu-id="b707e-132">You must first call the folder's [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="b707e-133">Le dossier crée un objet énumération OLE standard et retourne son interface [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) .</span><span class="sxs-lookup"><span data-stu-id="b707e-133">The folder will create a standard OLE enumeration object and return its [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span> <span data-ttu-id="b707e-134">Cette interface expose quatre méthodes standard ([**clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**suivant**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset)et [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)) qui peuvent être utilisées pour énumérer le contenu du dossier.</span><span class="sxs-lookup"><span data-stu-id="b707e-134">This interface exposes four standard methods—[**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), and [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)—that can be used to enumerate the contents of the folder.</span></span>

<span data-ttu-id="b707e-135">La procédure de base pour énumérer le contenu d’un dossier est la suivante :</span><span class="sxs-lookup"><span data-stu-id="b707e-135">The basic procedure for enumerating a folder's contents is:</span></span>

1.  <span data-ttu-id="b707e-136">Appelez la méthode Folders [**IShellFolder :: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) pour récupérer un pointeur vers l’interface [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) d’un objet d’énumération.</span><span class="sxs-lookup"><span data-stu-id="b707e-136">Call the folders [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method to retrieve a pointer to an enumeration object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>
2.  <span data-ttu-id="b707e-137">Transmettez un PIDL non alloué à [**IEnumIDList :: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="b707e-137">Pass an unallocated PIDL to [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="b707e-138">**Ensuite** , s’occupe de l’allocation de PIDL, mais l’application doit la désallouer lorsqu’elle n’est plus nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b707e-138">**Next** takes care of allocating the PIDL, but the application must deallocate it when it is no longer needed.</span></span> <span data-ttu-id="b707e-139">Lors du retour **suivant** , le PIDL contient uniquement l’ID d’élément de l’objet et les caractères **null** de fin.</span><span class="sxs-lookup"><span data-stu-id="b707e-139">When **Next** returns, the PIDL will contain just the object's item ID and the terminating **NULL** characters.</span></span> <span data-ttu-id="b707e-140">En d’autres termes, il s’agit d’un PIDL à un seul niveau, par rapport au dossier, et non d’un PIDL complet.</span><span class="sxs-lookup"><span data-stu-id="b707e-140">In other words, it is a single-level PIDL, relative to the folder, not a fully qualified PIDL.</span></span>
3.  <span data-ttu-id="b707e-141">Répétez l’étape 2 jusqu’à ce que [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) retourne S \_ false pour indiquer que tous les éléments ont été énumérés.</span><span class="sxs-lookup"><span data-stu-id="b707e-141">Repeat step 2 until [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) returns S\_FALSE to indicate that all items have been enumerated.</span></span>
4.  <span data-ttu-id="b707e-142">Appelez **IEnumIDList :: Release** pour libérer l’objet d’énumération.</span><span class="sxs-lookup"><span data-stu-id="b707e-142">Call **IEnumIDList::Release** to release the enumeration object.</span></span>

> [!Note]  
> <span data-ttu-id="b707e-143">Il est important de suivre si vous utilisez un PIDL complet ou relatif.</span><span class="sxs-lookup"><span data-stu-id="b707e-143">It is important to keep track of whether you are working with a full or relative PIDL.</span></span> <span data-ttu-id="b707e-144">Certaines fonctions et méthodes acceptent les deux, mais d’autres n’en prennent que l’un ou l’autre.</span><span class="sxs-lookup"><span data-stu-id="b707e-144">Some functions and methods will accept either, but others will only take one or the other.</span></span>

 

<span data-ttu-id="b707e-145">Les trois méthodes [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) restantes ([**Réinitialiser**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**Ignorer**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)et [**cloner**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) sont utiles si vous devez effectuer des énumérations répétées du dossier.</span><span class="sxs-lookup"><span data-stu-id="b707e-145">The remaining three [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) methods ([**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip), and [**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) are useful if you need to do repeated enumerations of the folder.</span></span> <span data-ttu-id="b707e-146">Elles vous permettent de réinitialiser l’énumération, d’ignorer un ou plusieurs objets et de faire une copie de l’objet d’énumération pour conserver son état.</span><span class="sxs-lookup"><span data-stu-id="b707e-146">They allow you to reset the enumeration, skip one or more objects, and make a copy of the enumeration object to preserve its state.</span></span>

## <a name="determining-display-names-and-other-properties"></a><span data-ttu-id="b707e-147">Détermination des noms d’affichage et d’autres propriétés</span><span class="sxs-lookup"><span data-stu-id="b707e-147">Determining Display Names and Other Properties</span></span>

<span data-ttu-id="b707e-148">Une fois que vous avez énuméré tous les PIDL contenus dans un dossier, vous pouvez déterminer le type d’objets qu’ils représentent.</span><span class="sxs-lookup"><span data-stu-id="b707e-148">Once you have enumerated all the PIDLs that are contained by a folder, you can find out what sort of objects they represent.</span></span> <span data-ttu-id="b707e-149">L’interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) fournit un certain nombre de méthodes utiles, dont deux sont décrites ici.</span><span class="sxs-lookup"><span data-stu-id="b707e-149">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface provides a number of useful methods, two of which are discussed here.</span></span> <span data-ttu-id="b707e-150">D’autres méthodes **IShellFolder** et d’autres interfaces de dossiers Shell sont abordées plus loin.</span><span class="sxs-lookup"><span data-stu-id="b707e-150">Other **IShellFolder** methods and other Shell folder interfaces are discussed later.</span></span>

<span data-ttu-id="b707e-151">L’une des propriétés les plus utiles est le nom complet de l’objet.</span><span class="sxs-lookup"><span data-stu-id="b707e-151">One of the most useful properties is the object's display name.</span></span> <span data-ttu-id="b707e-152">Pour récupérer le nom complet d’un objet, transmettez son PIDL à [**IShellFolder :: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="b707e-152">To retrieve the display name of an object, pass its PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="b707e-153">Bien que l’objet puisse être situé n’importe où sous le dossier parent dans l’espace de noms, son PIDL doit être relatif au dossier.</span><span class="sxs-lookup"><span data-stu-id="b707e-153">Although the object can be located anywhere below the parent folder in the namespace, its PIDL must be relative to the folder.</span></span>

<span data-ttu-id="b707e-154">[**IShellFolder :: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) retourne le nom complet dans le cadre d’une structure [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) .</span><span class="sxs-lookup"><span data-stu-id="b707e-154">[**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) returns the display name as part of of a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="b707e-155">Étant donné que l’extraction du nom complet à partir d’une structure **STRRET** peut être un peu délicate, l’interpréteur de commandes fournit deux fonctions qui effectuent le travail pour vous, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) et [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span><span class="sxs-lookup"><span data-stu-id="b707e-155">Because extracting the display name from a **STRRET** structure can be a little tricky, the Shell provides two functions that do the job for you, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) and [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span></span> <span data-ttu-id="b707e-156">Les deux fonctions prennent une structure **STRRET** et retournent le nom complet sous la forme d’une chaîne normale.</span><span class="sxs-lookup"><span data-stu-id="b707e-156">Both functions take a **STRRET** structure, and return the display name as a normal string.</span></span> <span data-ttu-id="b707e-157">Elles diffèrent uniquement par la façon dont la chaîne est allouée.</span><span class="sxs-lookup"><span data-stu-id="b707e-157">They differ only in how the string is allocated.</span></span>

<span data-ttu-id="b707e-158">En plus de son nom complet, un objet peut avoir un certain nombre d’attributs, par exemple s’il s’agit d’un dossier ou s’il peut être déplacé.</span><span class="sxs-lookup"><span data-stu-id="b707e-158">In addition to its display name, an object can have a number of attributes, such as whether it is a folder or whether it can be moved.</span></span> <span data-ttu-id="b707e-159">Vous pouvez récupérer les attributs d’un objet en passant son PIDL à [**IShellFolder :: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span><span class="sxs-lookup"><span data-stu-id="b707e-159">You can retrieve an object's attributes by passing its PIDL to [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span> <span data-ttu-id="b707e-160">La liste complète des attributs est assez volumineuse. vous devez donc voir la référence pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="b707e-160">The complete list of attributes is quite large, so you should see the reference for details.</span></span> <span data-ttu-id="b707e-161">Notez que le PIDL que vous transmettez à **GetAttributesOf** doit être de niveau simple.</span><span class="sxs-lookup"><span data-stu-id="b707e-161">Note that the PIDL that you pass to **GetAttributesOf** must be single-level.</span></span> <span data-ttu-id="b707e-162">En particulier, **IShellFolder :: GetAttributesOf** accepte le PIDL retourné par [**IEnumIDList :: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="b707e-162">In particular, **IShellFolder::GetAttributesOf** will accept the PIDLs returned by [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="b707e-163">Vous pouvez passer un tableau de PIDL et **GetAttributesOf** retournera les attributs que tous les objets du tableau ont en commun.</span><span class="sxs-lookup"><span data-stu-id="b707e-163">You can pass in an array of PIDLs, and **GetAttributesOf** will return those attributes that all objects in the array have in common.</span></span>

<span data-ttu-id="b707e-164">Si vous avez le chemin qualifié complet d’un objet ou PIDL, [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) offre un moyen simple de récupérer des informations sur un objet qui est suffisant pour de nombreuses raisons.</span><span class="sxs-lookup"><span data-stu-id="b707e-164">If you have an object's fully qualified path or PIDL, [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) provides a simple way to retrieve information about an object that is sufficient for many purposes.</span></span> <span data-ttu-id="b707e-165">**SHGetFileInfo** prend un chemin d’accès qualifié complet ou PIDL, et retourne une variété d’informations sur l’objet, notamment :</span><span class="sxs-lookup"><span data-stu-id="b707e-165">**SHGetFileInfo** takes a fully qualified path or PIDL, and returns a variety of information about the object including:</span></span>

-   <span data-ttu-id="b707e-166">Nom complet de l’objet</span><span class="sxs-lookup"><span data-stu-id="b707e-166">The object's display name</span></span>
-   <span data-ttu-id="b707e-167">Attributs de l’objet</span><span class="sxs-lookup"><span data-stu-id="b707e-167">The object's attributes</span></span>
-   <span data-ttu-id="b707e-168">Gère les icônes de l’objet</span><span class="sxs-lookup"><span data-stu-id="b707e-168">Handles to the object's icons</span></span>
-   <span data-ttu-id="b707e-169">Handle de la liste d’images système</span><span class="sxs-lookup"><span data-stu-id="b707e-169">A handle to the system image list</span></span>
-   <span data-ttu-id="b707e-170">Chemin d’accès du fichier contenant l’icône de l’objet</span><span class="sxs-lookup"><span data-stu-id="b707e-170">The path of the file containing the object's icon</span></span>

## <a name="getting-a-pointer-to-a-subfolders-ishellfolder-interface"></a><span data-ttu-id="b707e-171">Obtention d’un pointeur vers l’interface IShellFolder d’un sous-dossier</span><span class="sxs-lookup"><span data-stu-id="b707e-171">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>

<span data-ttu-id="b707e-172">Vous pouvez déterminer si votre dossier contient des sous-dossiers en appelant [**IShellFolder :: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) et en vérifiant si l' \_ indicateur de dossier SFGAO est défini.</span><span class="sxs-lookup"><span data-stu-id="b707e-172">You can determine whether your folder contains any subfolders by calling [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) and checking to see if the SFGAO\_FOLDER flag is set.</span></span> <span data-ttu-id="b707e-173">Si un objet est un dossier, vous pouvez y créer une liaison, qui vous fournit un pointeur vers son interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="b707e-173">If an object is a folder, you can bind to it, which provides you with a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

<span data-ttu-id="b707e-174">Pour effectuer une liaison à un sous-dossier, appelez la méthode [**IShellFolder :: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) du dossier parent.</span><span class="sxs-lookup"><span data-stu-id="b707e-174">To bind to a subfolder, call the parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="b707e-175">Cette méthode prend le PIDL du sous-dossier et retourne un pointeur vers son interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="b707e-175">This method takes the subfolder's PIDL and returns a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="b707e-176">Une fois que vous avez ce pointeur, vous pouvez utiliser les méthodes **IShellFolder** pour énumérer le contenu des sous-dossiers, déterminer leurs propriétés, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="b707e-176">Once you have this pointer, you can use the **IShellFolder** methods to enumerate the subfolders contents, determine their properties, and so on.</span></span>

## <a name="determining-an-objects-parent-folder"></a><span data-ttu-id="b707e-177">Détermination du dossier parent d’un objet</span><span class="sxs-lookup"><span data-stu-id="b707e-177">Determining an Object's Parent Folder</span></span>

<span data-ttu-id="b707e-178">Si vous avez le PIDL d’un objet, vous pouvez avoir besoin d’un handle vers l’une des interfaces exposées par son dossier parent.</span><span class="sxs-lookup"><span data-stu-id="b707e-178">If you have an object's PIDL, you may need a handle to one of the interfaces exposed by its parent folder.</span></span> <span data-ttu-id="b707e-179">Par exemple, si vous souhaitez déterminer le nom complet associé à un PIDL à l’aide de [**IShellFolder :: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), vous devez d’abord récupérer l’interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) du parent de l’objet.</span><span class="sxs-lookup"><span data-stu-id="b707e-179">For example, if you want to determine the display name associated with a PIDL by using [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), you must first retrieve the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface of the object's parent.</span></span> <span data-ttu-id="b707e-180">Il est possible de le faire avec les techniques décrites dans les sections précédentes.</span><span class="sxs-lookup"><span data-stu-id="b707e-180">It is possible to do this with the techniques discussed in the previous sections.</span></span> <span data-ttu-id="b707e-181">Toutefois, une approche bien plus simple consiste à utiliser la fonction Shell, [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span><span class="sxs-lookup"><span data-stu-id="b707e-181">However, a much simpler approach is to use the Shell function, [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span></span> <span data-ttu-id="b707e-182">Cette fonction prend le PIDL complet d’un objet et retourne un pointeur d’interface spécifié sur le dossier parent.</span><span class="sxs-lookup"><span data-stu-id="b707e-182">This function takes the fully qualified PIDL of an object and returns a specified interface pointer on the parent folder.</span></span> <span data-ttu-id="b707e-183">Éventuellement, elle retourne également le PIDL à un seul niveau de l’élément pour une utilisation dans des méthodes telles que [**IShellFolder :: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span><span class="sxs-lookup"><span data-stu-id="b707e-183">Optionally, it also returns the item's single-level PIDL for use in methods such as [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span>

<span data-ttu-id="b707e-184">L’exemple d’application console suivant récupère le PIDL du dossier spécial du système et retourne son nom complet.</span><span class="sxs-lookup"><span data-stu-id="b707e-184">The following sample console application retrieves the PIDL of the System special folder and returns its display name.</span></span>


```
#include <shlobj.h>
#include <shlwapi.h>
#include <iostream.h>
#include <objbase.h>

int main()
{
    IShellFolder *psfParent = NULL;
    LPITEMIDLIST pidlSystem = NULL;
    LPCITEMIDLIST pidlRelative = NULL;
    STRRET strDispName;
    TCHAR szDisplayName[MAX_PATH];
    HRESULT hr;

    hr = SHGetFolderLocation(NULL, CSIDL_SYSTEM, NULL, NULL, &pidlSystem);

    hr = SHBindToParent(pidlSystem, IID_IShellFolder, (void **) &psfParent, &pidlRelative);

    if(SUCCEEDED(hr))
    {
        hr = psfParent->GetDisplayNameOf(pidlRelative, SHGDN_NORMAL, &strDispName);
        hr = StrRetToBuf(&strDispName, pidlSystem, szDisplayName, sizeof(szDisplayName));
        cout << "SHGDN_NORMAL - " <<szDisplayName << '\n';
    }

    psfParent->Release();
    CoTaskMemFree(pidlSystem);

    return 0;
}
```



<span data-ttu-id="b707e-185">L’application utilise d’abord [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) pour récupérer le PIDL du dossier système.</span><span class="sxs-lookup"><span data-stu-id="b707e-185">The application first uses [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) to retrieve the System folder's PIDL.</span></span> <span data-ttu-id="b707e-186">Il appelle ensuite [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), qui retourne un pointeur vers l’interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) du dossier parent et le PIDL du dossier système par rapport à son parent.</span><span class="sxs-lookup"><span data-stu-id="b707e-186">It then calls [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), which returns a pointer to the parent folder's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, and the System folder's PIDL relative to its parent.</span></span> <span data-ttu-id="b707e-187">Il utilise ensuite la méthode [**IShellFolder :: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) du dossier parent pour récupérer le nom complet du dossier système.</span><span class="sxs-lookup"><span data-stu-id="b707e-187">It then uses the parent folder's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to retrieve the display name of the System folder.</span></span> <span data-ttu-id="b707e-188">Étant donné que **GetDisplayNameOf** retourne une structure [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) , [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) est utilisé pour convertir le nom complet en une chaîne normale.</span><span class="sxs-lookup"><span data-stu-id="b707e-188">Because **GetDisplayNameOf** returns a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure, [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) is used to convert the display name into a normal string.</span></span> <span data-ttu-id="b707e-189">Une fois le nom complet affiché, les pointeurs d’interface sont libérés et le système PIDL libéré.</span><span class="sxs-lookup"><span data-stu-id="b707e-189">After displaying the display name, the interface pointers are released and the System PIDL freed.</span></span> <span data-ttu-id="b707e-190">Notez que vous ne devez pas libérer le PIDL relatif retourné par **SHBindToParent**.</span><span class="sxs-lookup"><span data-stu-id="b707e-190">Note that you must not free the relative PIDL returned by **SHBindToParent**.</span></span>

 

 
