---
description: Cette rubrique répertorie les principaux éléments de programmation utilisés avec les menus contextuels (contextuels) et les gestionnaires de menus contextuels. Les gestionnaires de menus contextuels, également appelés gestionnaires de menus contextuels ou gestionnaires de verbes, sont un type de gestionnaire de type de fichier.
ms.assetid: efd96a52-6455-40bc-9c21-65f89728e771
title: Référence du menu contextuel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8cb1552c8f2f383b08984e9142e464b6831a3c8e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104201276"
---
# <a name="shortcut-menu-reference"></a><span data-ttu-id="27145-104">Référence du menu contextuel</span><span class="sxs-lookup"><span data-stu-id="27145-104">Shortcut Menu Reference</span></span>

<span data-ttu-id="27145-105">Cette rubrique répertorie les principaux éléments de programmation utilisés avec les menus contextuels (contextuels) et les gestionnaires de menus contextuels.</span><span class="sxs-lookup"><span data-stu-id="27145-105">This topic lists the main programming elements used with shortcut (context) menus, and shortcut menu handlers.</span></span> <span data-ttu-id="27145-106">Les gestionnaires de menus contextuels, également appelés gestionnaires de menus contextuels ou gestionnaires de verbes, sont un type de gestionnaire de type de fichier.</span><span class="sxs-lookup"><span data-stu-id="27145-106">Shortcut menu handlers, which also known as context menu handlers or verb handlers, are a type of file type handler.</span></span>

## <a name="about-shortcut-menu-implemetation"></a><span data-ttu-id="27145-107">À propos du menu contextuel implémentation</span><span class="sxs-lookup"><span data-stu-id="27145-107">About Shortcut Menu Implemetation</span></span>

<span data-ttu-id="27145-108">Il est vivement recommandé d’implémenter un menu contextuel à l’aide de l’une des méthodes de verbe statique.</span><span class="sxs-lookup"><span data-stu-id="27145-108">It is strongly encouraged that you implement a shortcut menu using one of the static verb methods.</span></span> <span data-ttu-id="27145-109">Veuillez consulter les instructions suivantes :</span><span class="sxs-lookup"><span data-stu-id="27145-109">Please review the following instructions:</span></span>

-   <span data-ttu-id="27145-110">Pour utiliser une méthode verbale statique pour implémenter un menu contextuel, consultez la section « personnalisation d’un menu contextuel à l’aide de verbes statiques » de [création de gestionnaires de menus contextuels](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="27145-110">To use a static verb method to implement a shortcut menu, see the "Customizing a Shortcut Menu using Static Verbs" section of [Creating Shortcut Menu Handlers](context-menu-handlers.md).</span></span>
-   <span data-ttu-id="27145-111">Pour obtenir le comportement dynamique des verbes statiques dans Windows 7 et versions ultérieures, consultez « obtention du comportement dynamique pour les verbes statiques » dans [création de gestionnaires de menus contextuels](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="27145-111">To get dynamic behavior for static verbs in Windows 7 and later, see "Getting Dynamic Behavior for Static Verbs" in [Creating Shortcut Menu Handlers](context-menu-handlers.md).</span></span>
-   <span data-ttu-id="27145-112">Pour plus d’informations sur l’implémentation d’un verbe statique et sur les verbes dynamiques à éviter, consultez [choix d’un verbe statique ou dynamique pour votre menu contextuel](shortcut-choose-method.md).</span><span class="sxs-lookup"><span data-stu-id="27145-112">For details on static verb implementation, and which dynamic verbs to avoid, see [Choosing a Static or Dynamic Verb for your Shortcut Menu](shortcut-choose-method.md).</span></span>
-   <span data-ttu-id="27145-113">Si vous devez étendre le menu contextuel d’un type de fichier en inscrivant un verbe dynamique pour le type de fichier, suivez les instructions fournies dans [Personnalisation d’un menu contextuel à l’aide de verbes dynamiques](shortcut-menu-using-dynamic-verbs.md).</span><span class="sxs-lookup"><span data-stu-id="27145-113">If you must extend the shortcut menu for a file type by registering a dynamic verb for the file type, then follow the instructions provided in [Customizing a Shortcut Menu Using Dynamic Verbs](shortcut-menu-using-dynamic-verbs.md).</span></span>

### <a name="interfaces"></a><span data-ttu-id="27145-114">Interfaces</span><span class="sxs-lookup"><span data-stu-id="27145-114">Interfaces</span></span>



| <span data-ttu-id="27145-115">Rubrique</span><span class="sxs-lookup"><span data-stu-id="27145-115">Topic</span></span>                                        | <span data-ttu-id="27145-116">Contenu</span><span class="sxs-lookup"><span data-stu-id="27145-116">Contents</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|----------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="27145-117">**IContextMenu**</span><span class="sxs-lookup"><span data-stu-id="27145-117">**IContextMenu**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu)         | <span data-ttu-id="27145-118">Expose les méthodes qui créent ou fusionnent un menu contextuel associé à un objet Shell.</span><span class="sxs-lookup"><span data-stu-id="27145-118">Exposes methods that either create or merge a shortcut menu associated with a Shell object.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="27145-119">**IContextMenu2**</span><span class="sxs-lookup"><span data-stu-id="27145-119">**IContextMenu2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2)       | <span data-ttu-id="27145-120">Expose des méthodes qui créent ou fusionnent un menu contextuel (contexte) associé à un objet Shell.</span><span class="sxs-lookup"><span data-stu-id="27145-120">Exposes methods that either create or merge a shortcut (context) menu associated with a Shell object.</span></span> <span data-ttu-id="27145-121">Étend [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) en ajoutant une méthode qui permet aux objets clients de gérer des messages associés à des éléments de menu owner-drawn.</span><span class="sxs-lookup"><span data-stu-id="27145-121">Extends [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) by adding a method that allows client objects to handle messages associated with owner-drawn menu items.</span></span><br/>                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="27145-122">**IContextMenu3**</span><span class="sxs-lookup"><span data-stu-id="27145-122">**IContextMenu3**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3)       | <span data-ttu-id="27145-123">Expose les méthodes qui créent ou fusionnent un menu contextuel associé à un objet Shell.</span><span class="sxs-lookup"><span data-stu-id="27145-123">Exposes methods that either create or merge a shortcut menu associated with a Shell object.</span></span> <span data-ttu-id="27145-124">Permet aux objets clients de gérer des messages associés à des éléments de menu owner-drawn et étend [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2) en acceptant une valeur de retour de cette gestion des messages.</span><span class="sxs-lookup"><span data-stu-id="27145-124">Allows client objects to handle messages associated with owner-drawn menu items and extends [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2) by accepting a return value from that message handling.</span></span><br/>                                                                                                                                                                                                                         |
| [<span data-ttu-id="27145-125">**IContextMenuCB**</span><span class="sxs-lookup"><span data-stu-id="27145-125">**IContextMenuCB**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenucb)     | <span data-ttu-id="27145-126">Expose une méthode qui active le rappel d’un menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="27145-126">Exposes a method that enables the callback of a context menu.</span></span> <span data-ttu-id="27145-127">Par exemple, pour ajouter une icône de bouclier à un **MenuItem** qui requiert une élévation.</span><span class="sxs-lookup"><span data-stu-id="27145-127">For example, to add a shield icon to a **menuItem** that requires elevation.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="27145-128">**IContextMenuSite**</span><span class="sxs-lookup"><span data-stu-id="27145-128">**IContextMenuSite**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite) | <span data-ttu-id="27145-129">Implémenté par l’affichage des dossiers par défaut créé à l’aide de [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span><span class="sxs-lookup"><span data-stu-id="27145-129">Implemented by the default folder view created using [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span></span> <span data-ttu-id="27145-130">Une implémentation de [**IContextMenuSite**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite) prend en charge [**IContextMenu :: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), [**IContextMenu :: commande InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand)et [**TrackPopupMenu**](/windows/win32/api/winuser/nf-winuser-trackpopupmenu) et tout transfert de messages nécessaire pour cette fonction.</span><span class="sxs-lookup"><span data-stu-id="27145-130">An implementation of [**IContextMenuSite**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite) supports [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand), and [**TrackPopupMenu**](/windows/win32/api/winuser/nf-winuser-trackpopupmenu) and any message forwarding necessary for that function.</span></span> <span data-ttu-id="27145-131">**IContextMenuSite** met également à jour également la barre d’État.</span><span class="sxs-lookup"><span data-stu-id="27145-131">**IContextMenuSite** typically updates the status bar as well.</span></span><br/> |



 

### <a name="functions"></a><span data-ttu-id="27145-132">Fonctions</span><span class="sxs-lookup"><span data-stu-id="27145-132">Functions</span></span>



| <span data-ttu-id="27145-133">Rubrique</span><span class="sxs-lookup"><span data-stu-id="27145-133">Topic</span></span>                                                            | <span data-ttu-id="27145-134">Contenu</span><span class="sxs-lookup"><span data-stu-id="27145-134">Contents</span></span>                                                                                                                                |
|------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="27145-135">**CDefFolderMenu \_ Create2**</span><span class="sxs-lookup"><span data-stu-id="27145-135">**CDefFolderMenu\_Create2**</span></span>](/windows/desktop/api/shlobj_core/nf-shlobj_core-cdeffoldermenu_create2)        | <span data-ttu-id="27145-136">Crée un menu contextuel pour un groupe sélectionné d’objets de dossier de fichiers.</span><span class="sxs-lookup"><span data-stu-id="27145-136">Creates a context menu for a selected group of file folder objects.</span></span><br/>                                                          |
| [<span data-ttu-id="27145-137">**LPFNDFMCALLBACK**</span><span class="sxs-lookup"><span data-stu-id="27145-137">**LPFNDFMCALLBACK**</span></span>](/windows/win32/api/shlobj_core/nc-shlobj_core-lpfndfmcallback)                       | <span data-ttu-id="27145-138">Définit le prototype pour la fonction de rappel qui reçoit des messages à partir de l’implémentation du menu contextuel par défaut de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="27145-138">Defines the prototype for the callback function that receives messages from the Shell's default context menu implementation.</span></span><br/> |
| [<span data-ttu-id="27145-139">**SHCreateDefaultContextMenu**</span><span class="sxs-lookup"><span data-stu-id="27145-139">**SHCreateDefaultContextMenu**</span></span>](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu) | <span data-ttu-id="27145-140">Crée un objet qui représente l’implémentation du menu contextuel par défaut de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="27145-140">Creates an object that represents the Shell's default context menu implementation.</span></span><br/>                                           |



 

### <a name="structures"></a><span data-ttu-id="27145-141">Structures</span><span class="sxs-lookup"><span data-stu-id="27145-141">Structures</span></span>



| <span data-ttu-id="27145-142">Rubrique</span><span class="sxs-lookup"><span data-stu-id="27145-142">Topic</span></span>                                                  | <span data-ttu-id="27145-143">Contenu</span><span class="sxs-lookup"><span data-stu-id="27145-143">Contents</span></span>                                                                                                                                                                                                   |
|--------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="27145-144">**CMINVOKECOMMANDINFO**</span><span class="sxs-lookup"><span data-stu-id="27145-144">**CMINVOKECOMMANDINFO**</span></span>](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo)     | <span data-ttu-id="27145-145">Contient les informations nécessaires à [**IContextMenu :: commande InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) pour appeler une commande de menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="27145-145">Contains information needed by [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) to invoke a shortcut menu command.</span></span><br/>                                                             |
| [<span data-ttu-id="27145-146">**CMINVOKECOMMANDINFOEX**</span><span class="sxs-lookup"><span data-stu-id="27145-146">**CMINVOKECOMMANDINFOEX**</span></span>](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfoex) | <span data-ttu-id="27145-147">Contient des informations étendues sur une commande de menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="27145-147">Contains extended information about a shortcut menu command.</span></span> <span data-ttu-id="27145-148">Cette structure est une version étendue de [**CMINVOKECOMMANDINFO**](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) qui permet d’utiliser des valeurs Unicode.</span><span class="sxs-lookup"><span data-stu-id="27145-148">This structure is an extended version of [**CMINVOKECOMMANDINFO**](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) that allows the use of Unicode values.</span></span><br/> |
| [<span data-ttu-id="27145-149">**DEFCONTEXTMENU**</span><span class="sxs-lookup"><span data-stu-id="27145-149">**DEFCONTEXTMENU**</span></span>](/windows/desktop/api/shlobj_core/ns-shlobj_core-defcontextmenu)               | <span data-ttu-id="27145-150">Contient les informations de menu contextuel utilisées par [**SHCreateDefaultContextMenu**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="27145-150">Contains context menu information used by [**SHCreateDefaultContextMenu**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu).</span></span><br/>                                                                                     |



 

## <a name="related-topics"></a><span data-ttu-id="27145-151">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="27145-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="27145-152">Menus contextuels (menu contextuel) et gestionnaires de menus contextuels</span><span class="sxs-lookup"><span data-stu-id="27145-152">Shortcut (Context) Menus and Shortcut Menu Handlers</span></span>](context-menu.md)
</dt> <dt>

[<span data-ttu-id="27145-153">Choix d’un verbe statique ou dynamique pour votre menu contextuel</span><span class="sxs-lookup"><span data-stu-id="27145-153">Choosing a Static or Dynamic Verb for your Shortcut Menu</span></span>](shortcut-choose-method.md)
</dt> <dt>

[<span data-ttu-id="27145-154">Verbes et associations de fichiers</span><span class="sxs-lookup"><span data-stu-id="27145-154">Verbs and File Associations</span></span>](fa-verbs.md)
</dt> <dt>

[<span data-ttu-id="27145-155">Meilleures pratiques pour les gestionnaires de menus contextuels et les verbes de sélection multiple</span><span class="sxs-lookup"><span data-stu-id="27145-155">Best Practices for Shortcut Menu Handlers and Multiple Selection Verbs</span></span>](verbs-best-practices.md)
</dt> <dt>

[<span data-ttu-id="27145-156">Création de gestionnaires de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="27145-156">Creating Shortcut Menu Handlers</span></span>](context-menu-handlers.md)
</dt> <dt>

[<span data-ttu-id="27145-157">Personnalisation d’un menu contextuel à l’aide de verbes dynamiques</span><span class="sxs-lookup"><span data-stu-id="27145-157">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](shortcut-menu-using-dynamic-verbs.md)
</dt> </dl>

 

 
