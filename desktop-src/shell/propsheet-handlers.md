---
description: Quand un utilisateur clique avec le bouton droit sur un objet Shell, le menu contextuel qui s’affiche normalement comprend un élément Propriétés.
title: Gestionnaires de feuille de propriétés
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 72233ab5-212d-498c-8df1-1a96c8eda892
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 40ccb8d1cee0fffb993aef417b979816597cf707
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103866150"
---
# <a name="property-sheet-handlers"></a><span data-ttu-id="c0e1d-103">Gestionnaires de feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="c0e1d-103">Property Sheet Handlers</span></span>

<span data-ttu-id="c0e1d-104">Quand un utilisateur clique avec le bouton droit sur un objet Shell, le menu contextuel qui s’affiche normalement comprend un élément **Propriétés** .</span><span class="sxs-lookup"><span data-stu-id="c0e1d-104">When a user right-clicks a Shell object, the shortcut menu that is displayed normally includes a **Properties** item.</span></span> <span data-ttu-id="c0e1d-105">La sélection de cet élément lance une feuille de propriétés qui permet à l’utilisateur d’afficher et, dans certains cas, de modifier les propriétés de l’objet.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-105">Selecting that item launches a property sheet that allows the user to view, and in some cases modify, the object's properties.</span></span> <span data-ttu-id="c0e1d-106">Vous pouvez personnaliser cette feuille de propriétés en implémentant et en inscrivant un *Gestionnaire de feuille de propriétés*.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-106">You can customize this property sheet by implementing and registering a *property sheet handler*.</span></span>

<span data-ttu-id="c0e1d-107">Les procédures générales d’implémentation et d’inscription d’un gestionnaire d’extensions de Shell sont décrites dans [création de gestionnaires d’extensions de Shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="c0e1d-107">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="c0e1d-108">Ce document se concentre sur les aspects de l’implémentation qui sont spécifiques aux gestionnaires de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-108">This document focuses on those aspects of implementation that are specific to property sheet handlers.</span></span>

-   [<span data-ttu-id="c0e1d-109">Fonctionnement des gestionnaires de feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="c0e1d-109">How Property Sheet Handlers Work</span></span>](#how-property-sheet-handlers-work)
-   [<span data-ttu-id="c0e1d-110">Inscription et implémentation d’un gestionnaire de feuille de propriétés pour un lecteur monté</span><span class="sxs-lookup"><span data-stu-id="c0e1d-110">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>](#registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive)
-   [<span data-ttu-id="c0e1d-111">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c0e1d-111">Related topics</span></span>](#related-topics)

## <a name="how-property-sheet-handlers-work"></a><span data-ttu-id="c0e1d-112">Fonctionnement des gestionnaires de feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="c0e1d-112">How Property Sheet Handlers Work</span></span>

<span data-ttu-id="c0e1d-113">L’illustration suivante montre la feuille de propriétés des propriétés d’un fichier texte Windows XP.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-113">The following illustration shows the Properties property sheet for a Windows XP text file.</span></span>

![feuille de propriétés](images/propsheethandler1.jpg)

<span data-ttu-id="c0e1d-115">Cette illustration montre la feuille de propriétés des propriétés par défaut qui s’affiche pour tous les fichiers.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-115">This illustration shows the default Properties property sheet that is displayed for any file.</span></span> <span data-ttu-id="c0e1d-116">Pour de nombreuses feuilles de propriétés de ce type, vous pouvez ajouter une ou plusieurs pages à la feuille de propriétés en implémentant et en inscrivant un gestionnaire de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-116">For many such property sheets, you can add one or more pages to the property sheet by implementing and registering a property sheet handler.</span></span>

<span data-ttu-id="c0e1d-117">Les gestionnaires de feuille de propriétés sont les plus couramment inscrits pour un [type de fichier](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="c0e1d-117">Property sheet handlers are most commonly registered for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="c0e1d-118">Chaque gestionnaire peut ajouter une page personnalisée à la feuille de propriétés de propriétés pour la classe.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-118">Each handler can add one custom page to the Properties property sheet for the class.</span></span> <span data-ttu-id="c0e1d-119">Ces pages permettent généralement aux utilisateurs d’accéder aux propriétés spécifiques à un type de fichier particulier.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-119">These pages typically give users access to properties that are specific to the particular file type.</span></span> <span data-ttu-id="c0e1d-120">Un type de fichier composé de documents texte peut, par exemple, afficher une page qui répertorie le titre et l’auteur, ainsi qu’un résumé du document.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-120">A file type consisting of text documents could, for instance, display a page that listed the title and author, and an abstract of the document.</span></span> <span data-ttu-id="c0e1d-121">Un cas particulier de ce type de gestionnaire de feuille de propriétés est utilisé pour ajouter une page à la feuille de propriétés de propriétés pour un lecteur monté.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-121">A special case of this type of property sheet handler is used to add a page to the Properties property sheet for a mounted drive.</span></span>

<span data-ttu-id="c0e1d-122">L’autre utilisation pour les gestionnaires de feuille de propriétés consiste à remplacer des pages dans les feuilles de propriétés affichées par les applications du panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-122">The other use for property sheet handlers is to replace pages in the property sheets displayed by Control Panel applications.</span></span> <span data-ttu-id="c0e1d-123">Un fabricant de souris, par exemple, peut utiliser un gestionnaire de feuille de propriétés pour remplacer la page **boutons** sur la feuille de propriétés propriétés de la **souris** du panneau de configuration par une page personnalisée pour les caractéristiques de sa souris.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-123">A mouse manufacturer, for instance, can use a property sheet handler to replace the **Buttons** page on the Control Panel's **Mouse Properties** property sheet with a page that is customized for the characteristics of its mouse.</span></span>

<span data-ttu-id="c0e1d-124">Comme tous les gestionnaires d’extensions de Shell, les gestionnaires de feuille de propriétés sont des objets COM (Component Object Model) in-process implémentés en tant que dll.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-124">Like all Shell extension handlers, property sheet handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="c0e1d-125">Ils doivent exporter deux interfaces en plus de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) et [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span><span class="sxs-lookup"><span data-stu-id="c0e1d-125">They must export two interfaces in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) and [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span></span>

<span data-ttu-id="c0e1d-126">L’interface [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) est utilisée par le Shell pour initialiser le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-126">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface is used by the Shell to initialize the handler.</span></span> <span data-ttu-id="c0e1d-127">Lorsque l’interpréteur de commandes appelle [**IShellExtInit :: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), il passe un objet de données avec le nom de l’objet et le pointeur vers une liste d’identificateurs d’éléments (PIDL) du dossier qui contient le fichier.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-127">When the Shell calls [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), it passes in a data object with the object's name, and the pointer to an item identifier list (PIDL) of the folder that contains the file.</span></span> <span data-ttu-id="c0e1d-128">Le paramètre *hRegKey* n’est pas utilisé avec les gestionnaires de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-128">The *hRegKey* parameter is not used with property sheet handlers.</span></span> <span data-ttu-id="c0e1d-129">La méthode **IShellExtInit :: Initialize** doit extraire le nom de fichier de l’objet de données et stocker le nom et le PIDL du dossier pour une utilisation ultérieure.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-129">The **IShellExtInit::Initialize** method must extract the file name from the data object, and store the name and the folder's PIDL for later use.</span></span> <span data-ttu-id="c0e1d-130">Pour plus d’informations, consultez la section *Implementing IShellExtInit* de [Creating shell extension Handlers](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="c0e1d-130">For further details, see the *Implementing IShellExtInit* section of [Creating Shell Extension Handlers](handlers.md).</span></span>

<span data-ttu-id="c0e1d-131">Le reste de l’opération s’effectue par le biais de l’interface [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-131">The remainder of the operation takes place through the handler's [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface.</span></span> <span data-ttu-id="c0e1d-132">Si la feuille de propriétés est associée à un type de fichier, l’interpréteur de commandes appelle [**IShellPropSheetExt :: AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) pour permettre au gestionnaire d’ajouter une page à la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-132">If the property sheet is associated with a file type, the Shell calls [**IShellPropSheetExt::AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) to allow the handler to add a page to the property sheet.</span></span> <span data-ttu-id="c0e1d-133">Si la feuille de propriétés est associée à une application du panneau de configuration, l’interpréteur de commandes appelle [**IShellPropSheetExt :: ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) pour permettre au gestionnaire de remplacer une page.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-133">If the property sheet is associated with a Control Panel application, the Shell calls [**IShellPropSheetExt::ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) to allow the handler to replace a page.</span></span>

## <a name="registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive"></a><span data-ttu-id="c0e1d-134">Inscription et implémentation d’un gestionnaire de feuille de propriétés pour un lecteur monté</span><span class="sxs-lookup"><span data-stu-id="c0e1d-134">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>

<span data-ttu-id="c0e1d-135">Chaque lecteur monté a une feuille de propriétés qui peut être affichée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-135">Each mounted drive has a Properties sheet that can be displayed by the user.</span></span> <span data-ttu-id="c0e1d-136">L’illustration suivante montre une feuille de propriétés de propriétés pour un lecteur de CD-ROM.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-136">The following illustration shows a Properties property sheet for a CD-ROM drive.</span></span>

![Propriétés de CD-ROM, feuille de propriétés](images/propsheethandler2.jpg)

<span data-ttu-id="c0e1d-138">Il existe un large éventail d’appareils qui peuvent être montés en tant que lecteurs.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-138">There are a wide variety of devices that can be mounted as drives.</span></span> <span data-ttu-id="c0e1d-139">Étant donné que la feuille de propriétés par défaut, conçue pour les lecteurs de disque, peut ne pas suffire pour certains périphériques, un gestionnaire de feuilles de propriétés peut être implémenté pour ajouter une page spécifique à l’appareil monté.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-139">Because the default property sheet, designed for disk drives, might not be sufficient for some devices, a property sheet handler can be implemented to add a page that is specific to the mounted device.</span></span> <span data-ttu-id="c0e1d-140">L’implémentation de base de ce type de gestionnaire de feuille de propriétés est identique à celle décrite dans [comment inscrire et implémenter un gestionnaire de feuille de propriétés pour un type de fichier](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), à deux exceptions près.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-140">The basic implementation of this type of property sheet handler is identical to that discussed in [How to Register and Implement a Property Sheet Handler for a File Type](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), with two exceptions.</span></span>

-   <span data-ttu-id="c0e1d-141">L’objet de données passé à la méthode [**IShellExtInit :: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) du gestionnaire peut contenir le chemin d’accès au lecteur au format [CFSTR \_ MOUNTEDVOLUME](clipboard.md) au lieu du format [CF \_ HDROP](clipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="c0e1d-141">The data object passed to the handler's [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method may contain the drive path in the [CFSTR\_MOUNTEDVOLUME](clipboard.md) format instead of the [CF\_HDROP](clipboard.md) format.</span></span> <span data-ttu-id="c0e1d-142">Le \_ format CF HDROP est utilisé lorsque l’appareil est monté sur une lettre de lecteur.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-142">The CF\_HDROP format is used when the device is mounted to a drive letter.</span></span> <span data-ttu-id="c0e1d-143">Le \_ format CFSTR MOUNTEDVOLUME est utilisé avec les systèmes de fichiers NTFS lorsque l’appareil distant est monté dans un dossier plutôt que dans une lettre de lecteur.</span><span class="sxs-lookup"><span data-stu-id="c0e1d-143">The CFSTR\_MOUNTEDVOLUME format is used with NTFS file systems when the remote device is mounted to a folder rather than to a drive letter.</span></span>
-   <span data-ttu-id="c0e1d-144">Le GUID du gestionnaire est inscrit sous la clé de shellex PropertySheetHandlers du lecteur **\_ \_ racine HKEY classes** \\  \\  \\  .</span><span class="sxs-lookup"><span data-stu-id="c0e1d-144">The handler's GUID is registered under the **HKEY\_CLASSES\_ROOT**\\**Drive**\\**shellex**\\**PropertySheetHandlers** key.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c0e1d-145">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c0e1d-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c0e1d-146">Comment inscrire et implémenter un gestionnaire de feuille de propriétés pour un type de fichier</span><span class="sxs-lookup"><span data-stu-id="c0e1d-146">How to Register and Implement a Property Sheet Handler for a File Type</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)
</dt> <dt>

[<span data-ttu-id="c0e1d-147">Comment inscrire et implémenter un gestionnaire de feuille de propriétés pour une application du panneau de configuration</span><span class="sxs-lookup"><span data-stu-id="c0e1d-147">How to Register and Implement a Property Sheet Handler for a Control Panel Application</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-control-panel-application.md)
</dt> </dl>

 

 
