---
description: Cet ensemble de rubriques explique comment implémenter les gestionnaires d’extension qui vous permettent de modifier diverses actions de l’interpréteur de commandes.
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: Utilisation des extensions de Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbb696f4536cdb0fb6869be073771d431bd8d2de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104973698"
---
# <a name="working-with-shell-extensions"></a><span data-ttu-id="85692-103">Utilisation des extensions de Shell</span><span class="sxs-lookup"><span data-stu-id="85692-103">Working with Shell Extensions</span></span>

<span data-ttu-id="85692-104">Les fonctionnalités de l’interpréteur de commandes peuvent être étendues avec des entrées de Registre et des fichiers. ini.</span><span class="sxs-lookup"><span data-stu-id="85692-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="85692-105">Bien que cette approche de l’extension de l’interpréteur de commandes soit simple et adaptée à de nombreuses fins, elle est limitée.</span><span class="sxs-lookup"><span data-stu-id="85692-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="85692-106">Par exemple, si vous utilisez le registre pour spécifier une icône personnalisée pour un type de fichier, la même icône s’affiche pour chaque fichier de ce type.</span><span class="sxs-lookup"><span data-stu-id="85692-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="85692-107">L’extension de l’interpréteur de commandes avec le registre ne vous permet pas de faire varier l’icône pour différents membres du type de fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-107">Extending the Shell with the registry does not allow you to vary the icon for different members of the file type.</span></span> <span data-ttu-id="85692-108">D’autres aspects de l’interpréteur de commandes, tels que la feuille de propriétés des **Propriétés** qui peuvent être affichées lorsqu’un utilisateur clique avec le bouton droit, ne peuvent pas être modifiés du tout à l’aide du Registre.</span><span class="sxs-lookup"><span data-stu-id="85692-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="85692-109">Une approche plus puissante et flexible pour étendre l’interpréteur de commandes consiste à implémenter des *gestionnaires d’extensions de Shell*.</span><span class="sxs-lookup"><span data-stu-id="85692-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="85692-110">Ces gestionnaires peuvent être implémentés pour diverses actions que l’interpréteur de commandes peut prendre.</span><span class="sxs-lookup"><span data-stu-id="85692-110">These handlers can be implemented for a variety of actions that the Shell can take.</span></span> <span data-ttu-id="85692-111">Avant d’entreprendre l’action, l’interpréteur de commandes interroge le gestionnaire d’extensions, en lui donnant la possibilité de modifier l’action.</span><span class="sxs-lookup"><span data-stu-id="85692-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="85692-112">Un gestionnaire d’extensions de menu contextuel est un exemple courant.</span><span class="sxs-lookup"><span data-stu-id="85692-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="85692-113">Si l’une d’elles est implémentée pour un type de fichier, elle est interrogée chaque fois que l’utilisateur clique avec le bouton droit sur l’un des fichiers.</span><span class="sxs-lookup"><span data-stu-id="85692-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="85692-114">Le gestionnaire peut ensuite spécifier des éléments de menu supplémentaires pour chaque fichier, au lieu d’avoir le même ensemble pour tous les fichiers de ce type de fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for all files of that file type.</span></span>

<span data-ttu-id="85692-115">Cet ensemble de rubriques explique comment implémenter les gestionnaires d’extension qui vous permettent de modifier diverses actions de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="85692-115">This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="85692-116">Les gestionnaires suivants sont associés à un type de fichier particulier et vous permettent de spécifier la base de données fichier par fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis.</span></span>



| <span data-ttu-id="85692-117">Handler</span><span class="sxs-lookup"><span data-stu-id="85692-117">Handler</span></span>                                               | <span data-ttu-id="85692-118">Description</span><span class="sxs-lookup"><span data-stu-id="85692-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="85692-119">Gestionnaire de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="85692-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="85692-120">Appelé avant l’affichage du menu contextuel d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="85692-121">Elle vous permet d’ajouter des éléments au menu contextuel, fichier par fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="85692-122">Gestionnaire de données</span><span class="sxs-lookup"><span data-stu-id="85692-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="85692-123">Appelé lorsqu’une opération de glisser-déplacer est exécutée sur des objets Shell.</span><span class="sxs-lookup"><span data-stu-id="85692-123">Called when a drag-and-drop operation is performed on Shell objects.</span></span> <span data-ttu-id="85692-124">Elle vous permet de fournir des formats de presse-papiers supplémentaires à la cible de déplacement.</span><span class="sxs-lookup"><span data-stu-id="85692-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                            |
| [<span data-ttu-id="85692-125">Supprimer le gestionnaire</span><span class="sxs-lookup"><span data-stu-id="85692-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="85692-126">Appelé lorsqu’un objet de données est déplacé ou déplacé sur un fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="85692-127">Elle vous permet de créer un fichier dans une cible de déplacement.</span><span class="sxs-lookup"><span data-stu-id="85692-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="85692-128">Gestionnaire d’icône</span><span class="sxs-lookup"><span data-stu-id="85692-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="85692-129">Appelé avant l’affichage de l’icône d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="85692-130">Elle vous permet de remplacer l’icône par défaut du fichier par une icône personnalisée, fichier par fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="85692-131">Gestionnaire de feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="85692-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="85692-132">Appelé avant l’affichage de la feuille de propriétés des **Propriétés** d’un objet.</span><span class="sxs-lookup"><span data-stu-id="85692-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="85692-133">Elle vous permet d’ajouter ou de remplacer des pages.</span><span class="sxs-lookup"><span data-stu-id="85692-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="85692-134">**Gestionnaire d’images miniatures**</span><span class="sxs-lookup"><span data-stu-id="85692-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="85692-135">Fournit une image pour représenter l’élément.</span><span class="sxs-lookup"><span data-stu-id="85692-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="85692-136">**Gestionnaire d'info-bulle**</span><span class="sxs-lookup"><span data-stu-id="85692-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="85692-137">Fournit du texte contextuel lorsque l’utilisateur place le pointeur de la souris sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="85692-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="85692-138">**Gestionnaire de métadonnées**</span><span class="sxs-lookup"><span data-stu-id="85692-138">**Metadata handler**</span></span>](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | <span data-ttu-id="85692-139">Fournit un accès en lecture et en écriture aux métadonnées (propriétés) stockées dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="85692-140">Cela peut être utilisé pour étendre le mode Détails, info-bulles, la page de propriétés et les fonctionnalités de regroupement.</span><span class="sxs-lookup"><span data-stu-id="85692-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="85692-141">D’autres ne sont pas associées à un type de fichier particulier, mais sont appelées avant certaines opérations de Shell.</span><span class="sxs-lookup"><span data-stu-id="85692-141">Others are not associated with a particular file type but are called before some Shell operations.</span></span>



| <span data-ttu-id="85692-142">Handler</span><span class="sxs-lookup"><span data-stu-id="85692-142">Handler</span></span>                                                            | <span data-ttu-id="85692-143">Description</span><span class="sxs-lookup"><span data-stu-id="85692-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="85692-144">Gestionnaire de colonnes</span><span class="sxs-lookup"><span data-stu-id="85692-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="85692-145">Appelée par l’Explorateur Windows avant d’afficher la vue Détails d’un dossier.</span><span class="sxs-lookup"><span data-stu-id="85692-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="85692-146">Elle vous permet d’ajouter des colonnes personnalisées à la vue Détails.</span><span class="sxs-lookup"><span data-stu-id="85692-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="85692-147">Gestionnaire de raccordement de copie</span><span class="sxs-lookup"><span data-stu-id="85692-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="85692-148">Appelé lorsqu’un objet de dossier ou d’imprimante est sur le lieu d’être déplacé, copié, supprimé ou renommé.</span><span class="sxs-lookup"><span data-stu-id="85692-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="85692-149">Elle vous permet d’approuver ou de refuser l’opération.</span><span class="sxs-lookup"><span data-stu-id="85692-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="85692-150">Gestionnaire de glisser-déplacer</span><span class="sxs-lookup"><span data-stu-id="85692-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="85692-151">Appelé lorsqu’un fichier est glissé avec le bouton droit de la souris.</span><span class="sxs-lookup"><span data-stu-id="85692-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="85692-152">Elle vous permet de modifier le menu contextuel qui s’affiche.</span><span class="sxs-lookup"><span data-stu-id="85692-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="85692-153">Gestionnaire de superposition d’icône</span><span class="sxs-lookup"><span data-stu-id="85692-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="85692-154">Appelé avant l’affichage de l’icône d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="85692-155">Elle vous permet de spécifier une superposition pour l’icône du fichier.</span><span class="sxs-lookup"><span data-stu-id="85692-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="85692-156">Gestionnaire de recherche</span><span class="sxs-lookup"><span data-stu-id="85692-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="85692-157">Appelé pour lancer un moteur de recherche.</span><span class="sxs-lookup"><span data-stu-id="85692-157">Called to launch a search engine.</span></span> <span data-ttu-id="85692-158">Elle vous permet d’implémenter un moteur de recherche personnalisé accessible à partir du menu **Démarrer** ou de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="85692-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="85692-159">Les détails sur la façon d’implémenter des gestionnaires d’extensions spécifiques sont traités dans les sections répertoriées ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="85692-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="85692-160">Pour connaître les problèmes d’implémentation qui sont communs à tous les gestionnaires d’extensions de Shell, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="85692-160">For discussions of implementation issues that are common to all Shell extension handlers, see these topics:</span></span>

-   [<span data-ttu-id="85692-161">Initialisation des gestionnaires d’extensions de Shell</span><span class="sxs-lookup"><span data-stu-id="85692-161">Initializing Shell Extension Handlers</span></span>](int-shell-exts.md)
-   [<span data-ttu-id="85692-162">Inscription des gestionnaires d’extensions de Shell</span><span class="sxs-lookup"><span data-stu-id="85692-162">Registering Shell Extension Handlers</span></span>](reg-shell-exts.md)

 

 
