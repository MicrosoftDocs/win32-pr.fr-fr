---
description: Cette rubrique décrit quelques éléments à prendre en compte lors de l’utilisation de bibliothèques dans votre programme.
ms.assetid: 40ACC8F6-1416-4390-A8D7-8F924DC2C2FE
title: Utilisation de bibliothèques dans votre programme
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2812a66b148d9bd16fc3951efab64a4d37afaaff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104321118"
---
# <a name="using-libraries-in-your-program"></a><span data-ttu-id="508d7-103">Utilisation de bibliothèques dans votre programme</span><span class="sxs-lookup"><span data-stu-id="508d7-103">Using Libraries in your Program</span></span>

<span data-ttu-id="508d7-104">Cette rubrique décrit quelques éléments à prendre en compte lors de l’utilisation de bibliothèques dans votre programme.</span><span class="sxs-lookup"><span data-stu-id="508d7-104">This topic describes some of the things to consider when using libraries in your program.</span></span>

<span data-ttu-id="508d7-105">Dans cette rubrique :</span><span class="sxs-lookup"><span data-stu-id="508d7-105">In this topic:</span></span>

-   [<span data-ttu-id="508d7-106">Vue d’ensemble de la programmation de bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-106">Library programming overview</span></span>](#library-programming-overview)
-   [<span data-ttu-id="508d7-107">Programmation à l’aide de bibliothèques</span><span class="sxs-lookup"><span data-stu-id="508d7-107">Programming with Libraries</span></span>](#programming-with-libraries)
    -   [<span data-ttu-id="508d7-108">Passage de dossiers connus aux bibliothèques</span><span class="sxs-lookup"><span data-stu-id="508d7-108">Moving from Known Folders to Libraries</span></span>](#moving-from-known-folders-to-libraries)
    -   [<span data-ttu-id="508d7-109">Groupes résidentiels et bibliothèques partagées</span><span class="sxs-lookup"><span data-stu-id="508d7-109">HomeGroup and shared libraries</span></span>](#homegroup-and-shared-libraries)
-   [<span data-ttu-id="508d7-110">Utilisation d’une boîte de dialogue de fichier commune avec des bibliothèques</span><span class="sxs-lookup"><span data-stu-id="508d7-110">Using a common file dialog box with libraries</span></span>](#using-a-common-file-dialog-box-with-libraries)
-   [<span data-ttu-id="508d7-111">Activation de la sélection de la bibliothèque à partir de l’interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="508d7-111">Enabling library selection from the user interface</span></span>](#enabling-library-selection-from-the-user-interface)
-   [<span data-ttu-id="508d7-112">Accès au contenu de la bibliothèque dans un programme</span><span class="sxs-lookup"><span data-stu-id="508d7-112">Accessing library content in a program</span></span>](#accessing-library-content-in-a-program)
    -   [<span data-ttu-id="508d7-113">Accès au contenu de la bibliothèque avec l’interface IShellLibrary</span><span class="sxs-lookup"><span data-stu-id="508d7-113">Accessing library content with the IShellLibrary interface</span></span>](#accessing-library-content-with-the-ishelllibrary-interface)
    -   [<span data-ttu-id="508d7-114">Accès au contenu de la bibliothèque à l’aide des API Shell</span><span class="sxs-lookup"><span data-stu-id="508d7-114">Accessing library content with the Shell APIs</span></span>](#accessing-library-content-with-the-shell-apis)
-   [<span data-ttu-id="508d7-115">Enregistrement du contenu utilisateur dans une bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-115">Saving user content in a library</span></span>](#saving-user-content-in-a-library)
-   [<span data-ttu-id="508d7-116">Prise en charge des opérations de glisser-déplacer dans une bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-116">Supporting drag-and-drop operations in a library</span></span>](#supporting-drag-and-drop-operations-in-a-library)
-   [<span data-ttu-id="508d7-117">Maintien de la synchronisation avec une bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-117">Keeping in sync with a library</span></span>](#keeping-in-sync-with-a-library)
    -   [<span data-ttu-id="508d7-118">Mise à jour en bloc</span><span class="sxs-lookup"><span data-stu-id="508d7-118">Bulk Update</span></span>](#bulk-update)
    -   [<span data-ttu-id="508d7-119">Notification de l’API Shell</span><span class="sxs-lookup"><span data-stu-id="508d7-119">Shell API Notification</span></span>](#shell-api-notification)
    -   [<span data-ttu-id="508d7-120">Notification de l’API du système de fichiers</span><span class="sxs-lookup"><span data-stu-id="508d7-120">File-system API Notification</span></span>](#file-system-api-notification)
-   [<span data-ttu-id="508d7-121">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="508d7-121">Related topics</span></span>](#related-topics)

## <a name="library-programming-overview"></a><span data-ttu-id="508d7-122">Vue d’ensemble de la programmation de bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-122">Library programming overview</span></span>

<span data-ttu-id="508d7-123">Les bibliothèques permettent aux utilisateurs d’organiser leurs contenus basés sur des fichiers d’une façon qui leur est significative et qui ne sont pas limités par l’organisation du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-123">Libraries enable users to organize their file-based content in a way that is meaningful to them and not limited by the organization of the file system.</span></span> <span data-ttu-id="508d7-124">Lorsque votre programme prend en charge les bibliothèques, il permet à l’utilisateur de trouver son contenu d’une manière qui lui semble logique tout en présentant une interface utilisateur qui est cohérente avec l’expérience utilisateur de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="508d7-124">When your program supports libraries, it allows the user to find their content in a way that makes sense to them while presenting a user interface that is consistent with the Windows 7 user experience.</span></span> <span data-ttu-id="508d7-125">Les bibliothèques permettent également à votre programme de localiser plus facilement le contenu basé sur des fichiers qui est stocké dans différents dossiers ou sur des ordinateurs différents.</span><span class="sxs-lookup"><span data-stu-id="508d7-125">Libraries also make it easier for your program to locate file-based content that is stored in different folders or on different machines.</span></span>

<span data-ttu-id="508d7-126">Les rubriques de cette section décrivent comment vous pouvez ajouter la prise en charge de bibliothèque à votre programme et tirer parti des nouvelles fonctionnalités offertes par les bibliothèques.</span><span class="sxs-lookup"><span data-stu-id="508d7-126">The topics in this section describe how you can add library support to your program and take advantage of the new capabilities that libraries offer.</span></span> <span data-ttu-id="508d7-127">Par défaut, Windows 7 fournit une partie de cette prise en charge.</span><span class="sxs-lookup"><span data-stu-id="508d7-127">Windows 7 provides some of this support by default.</span></span> <span data-ttu-id="508d7-128">Si votre programme ne modifie pas les boîtes de dialogue de fichier courantes qu’il utilise actuellement, il peut nécessiter très peu de programmation supplémentaire pour prendre en charge les bibliothèques.</span><span class="sxs-lookup"><span data-stu-id="508d7-128">If your program does not modify the common file dialog boxes that it currently uses, it might require very little additional programming to support libraries.</span></span>

<span data-ttu-id="508d7-129">Cette section décrit certaines des fonctionnalités clés fournies par les bibliothèques et comment les prendre en charge dans votre programme.</span><span class="sxs-lookup"><span data-stu-id="508d7-129">This section describes some of the key features that libraries provide and how to support them in your program.</span></span> <span data-ttu-id="508d7-130">Grâce à ces informations, vous pouvez choisir les fonctionnalités qui offriront la meilleure expérience utilisateur à partir de votre programme.</span><span class="sxs-lookup"><span data-stu-id="508d7-130">With this information, you can decide which features will provide the best user experience from your program.</span></span> <span data-ttu-id="508d7-131">Si votre programme personnalise les boîtes de dialogue de fichier courantes, les informations contenues dans cette section peuvent vous aider à déterminer comment utiliser les nouvelles boîtes de dialogue de fichier courantes pour utiliser des bibliothèques et fournir des fonctionnalités équivalentes dans Windows 7.</span><span class="sxs-lookup"><span data-stu-id="508d7-131">If your program customizes the common file dialog boxes, the information in this section can help you determine how to use the new common file dialog boxes to use libraries and provide equivalent functionality in Windows 7.</span></span>

## <a name="programming-with-libraries"></a><span data-ttu-id="508d7-132">Programmation à l’aide de bibliothèques</span><span class="sxs-lookup"><span data-stu-id="508d7-132">Programming with Libraries</span></span>

<span data-ttu-id="508d7-133">Le modèle de programmation Windows Shell décrit comment un programme interagit avec les objets de programmation du shell Windows.</span><span class="sxs-lookup"><span data-stu-id="508d7-133">The Windows Shell programming model describes how a program interacts with Windows Shell programming objects.</span></span> <span data-ttu-id="508d7-134">Alors que les objets de système de fichiers, tels que les fichiers et les répertoires, sont représentés par des objets shell Windows, tous les objets shell Windows ne sont pas représentés par le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-134">While file-system objects, such as files and directories, are represented by Windows Shell objects, not all Windows Shell objects are represented by the file-system.</span></span> <span data-ttu-id="508d7-135">Par exemple, les bibliothèques sont des objets de shell Windows qui n’ont pas d’équivalent de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-135">Libraries, for example, are Windows Shell objects that do not have a file-system equivalent.</span></span> <span data-ttu-id="508d7-136">L’utilisation d’objets shell Windows dans votre programme permet à votre programme d’accéder à tous les objets Shell et pas uniquement aux objets de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-136">Using Windows Shell objects in your program enables your program to access all Shell objects and not just file-system objects.</span></span>

<span data-ttu-id="508d7-137">Pour obtenir les meilleurs résultats, votre programme utilise l' [**API de la bibliothèque de shells**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) pour interagir avec les bibliothèques et accéder à leur contenu.</span><span class="sxs-lookup"><span data-stu-id="508d7-137">For the best results, your program would use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) to interact with libraries and access their contents.</span></span> <span data-ttu-id="508d7-138">Les bibliothèques contiennent des éléments de système de fichiers tels que des dossiers et des fichiers, mais pas des éléments de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-138">While libraries contain file-system items such as folders and files, libraries are not file-system items.</span></span> <span data-ttu-id="508d7-139">Ainsi, les API du système de fichiers ne peuvent pas être utilisées pour accéder aux fonctionnalités ou au contenu de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-139">As such, file-system APIs cannot be used to access library features or library contents.</span></span>

<span data-ttu-id="508d7-140">Si vous disposez déjà d’un programme qui utilise de nombreuses API du système de fichiers, votre programme peut toujours tirer parti des fonctionnalités de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-140">If you have an existing program that currently uses many file-system APIs, your program can still take advantage of library features.</span></span> <span data-ttu-id="508d7-141">L' [**API de la bibliothèque de shells**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) peut fournir des références de système de fichiers aux éléments qui se trouvent dans une bibliothèque, et ces références de système de fichiers, telles que le nom de fichier et le chemin d’accès, peuvent être passées aux API de système de fichiers existantes qui se trouvent dans votre programme existant.</span><span class="sxs-lookup"><span data-stu-id="508d7-141">The [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) can provide file-system references to the items that are found in a library and these file-system references, such as the file name and path, can be passed to the existing file-system APIs that are in your existing program.</span></span>

### <a name="moving-from-known-folders-to-libraries"></a><span data-ttu-id="508d7-142">Passage de dossiers connus aux bibliothèques</span><span class="sxs-lookup"><span data-stu-id="508d7-142">Moving from Known Folders to Libraries</span></span>

<span data-ttu-id="508d7-143">Avant Windows 7, il était courant d’utiliser un dossier connu, tel que le dossier Mes documents, comme dossier par défaut dans les opérations d’enregistrement de fichier ou d’ouverture de fichier.</span><span class="sxs-lookup"><span data-stu-id="508d7-143">Before Windows 7 it was common to use a known folder, such as the My Documents folder, as the default folder in file save or file open operations.</span></span> <span data-ttu-id="508d7-144">Dans Windows 7, la bibliothèque correspondante doit être utilisée pour que l’utilisateur dispose de la même expérience dans votre programme qu’avec d’autres programmes Windows 7, tels que l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="508d7-144">In Windows 7, the corresponding library should be used so the user will have the same experience in your program as they would with other Windows 7 programs, such as the Windows Explorer.</span></span>

<span data-ttu-id="508d7-145">Si vous utilisez actuellement l’API shell Windows dans votre programme, l’ajout de la prise en charge de bibliothèque est simple.</span><span class="sxs-lookup"><span data-stu-id="508d7-145">If you are currently using the Windows Shell API in your program, adding library support is straightforward.</span></span> <span data-ttu-id="508d7-146">Par exemple, si vous appelez actuellement la fonction [**SHGetKnownFolderItem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) pour obtenir l’emplacement du dossier Mes documents, vous pouvez remplacer la valeur [**KNOWNFOLDERID**](knownfolderid.md) du dossier connu mes documents par la valeur **KNOWNFOLDERID** de la bibliothèque correspondante.</span><span class="sxs-lookup"><span data-stu-id="508d7-146">For example, if you currently call the [**SHGetKnownFolderItem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) function to get the location of the My Documents folder, you can replace the [**KNOWNFOLDERID**](knownfolderid.md) value of the My Documents known folder with the **KNOWNFOLDERID** value of the corresponding library.</span></span>

<span data-ttu-id="508d7-147">Le tableau suivant montre la relation entre les valeurs [**KNOWNFOLDERID**](knownfolderid.md) des dossiers connus et la valeur **KNOWNFOLDERID** de la bibliothèque correspondante dans Windows 7.</span><span class="sxs-lookup"><span data-stu-id="508d7-147">The following table shows the relationship between the [**KNOWNFOLDERID**](knownfolderid.md) values of known folders and the **KNOWNFOLDERID** value of the corresponding library in Windows 7.</span></span> 

| <span data-ttu-id="508d7-148">Valeurs KNOWNFOLDERID de dossier connues</span><span class="sxs-lookup"><span data-stu-id="508d7-148">Known Folder KNOWNFOLDERID values</span></span> | <span data-ttu-id="508d7-149">Valeurs KNOWNFOLDERID de la bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-149">Library KNOWNFOLDERID values</span></span> |
|-----------------------------------|------------------------------|
| <span data-ttu-id="508d7-150">\_Documents FOLDERID</span><span class="sxs-lookup"><span data-stu-id="508d7-150">FOLDERID\_Documents</span></span>               | <span data-ttu-id="508d7-151">FOLDERID \_ DocumentsLibrary</span><span class="sxs-lookup"><span data-stu-id="508d7-151">FOLDERID\_DocumentsLibrary</span></span>   |
| <span data-ttu-id="508d7-152">\_Images FOLDERID</span><span class="sxs-lookup"><span data-stu-id="508d7-152">FOLDERID\_Pictures</span></span>                | <span data-ttu-id="508d7-153">FOLDERID \_ PicturesLibrary</span><span class="sxs-lookup"><span data-stu-id="508d7-153">FOLDERID\_PicturesLibrary</span></span>    |
| <span data-ttu-id="508d7-154">\_Musique FOLDERID</span><span class="sxs-lookup"><span data-stu-id="508d7-154">FOLDERID\_Music</span></span>                   | <span data-ttu-id="508d7-155">FOLDERID \_ MusicLibrary</span><span class="sxs-lookup"><span data-stu-id="508d7-155">FOLDERID\_MusicLibrary</span></span>       |
| <span data-ttu-id="508d7-156">FOLDERID \_ RecordedTV</span><span class="sxs-lookup"><span data-stu-id="508d7-156">FOLDERID\_RecordedTV</span></span>              | <span data-ttu-id="508d7-157">FOLDERID \_ RecordedTVLibrary</span><span class="sxs-lookup"><span data-stu-id="508d7-157">FOLDERID\_RecordedTVLibrary</span></span>  |



 

### <a name="homegroup-and-shared-libraries"></a><span data-ttu-id="508d7-158">Groupes résidentiels et bibliothèques partagées</span><span class="sxs-lookup"><span data-stu-id="508d7-158">HomeGroup and shared libraries</span></span>

<span data-ttu-id="508d7-159">L’ajout de la prise en charge de bibliothèque à votre programme permet la prise en charge des bibliothèques partagées dans un groupe résidentiel.</span><span class="sxs-lookup"><span data-stu-id="508d7-159">Adding library support to your program will enable support for shared libraries in a HomeGroup.</span></span> <span data-ttu-id="508d7-160">Le groupe résidentiel est identifié par sa valeur [**KNOWNFOLDERID**](knownfolderid.md) de [**\_ groupe résidentiel FOLDERID**](knownfolderid.md).</span><span class="sxs-lookup"><span data-stu-id="508d7-160">The HomeGroup is identified by its [**KNOWNFOLDERID**](knownfolderid.md) value of [**FOLDERID\_HomeGroup**](knownfolderid.md).</span></span> <span data-ttu-id="508d7-161">Votre programme peut identifier l’emplacement d’enregistrement par défaut privé ou partagé de l’utilisateur en définissant la valeur [**DEFAULTSAVEFOLDERTYPE**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) dans l’appel à la méthode [**IShellLibrary :: GetDefaultSaveFolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) .</span><span class="sxs-lookup"><span data-stu-id="508d7-161">Your program can find identify the user's private or shared default save location by setting the [**DEFAULTSAVEFOLDERTYPE**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) value in the call to [**IShellLibrary::GetDefaultSaveFolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) method.</span></span>

## <a name="using-a-common-file-dialog-box-with-libraries"></a><span data-ttu-id="508d7-162">Utilisation d’une boîte de dialogue de fichier commune avec des bibliothèques</span><span class="sxs-lookup"><span data-stu-id="508d7-162">Using a common file dialog box with libraries</span></span>

<span data-ttu-id="508d7-163">Utilisation d’une boîte de dialogue de fichier commune avec des bibliothèques la boîte de dialogue fichier courant a été mise à jour pour prendre en charge les bibliothèques dans Windows 7.</span><span class="sxs-lookup"><span data-stu-id="508d7-163">Using a common file dialog box with libraries The common file dialog box has been updated to support libraries in Windows 7.</span></span> <span data-ttu-id="508d7-164">L’illustration suivante montre comment la boîte de dialogue fichier commun s’affiche à un utilisateur dans Windows 7.</span><span class="sxs-lookup"><span data-stu-id="508d7-164">The following illustration shows how the common file dialog box appears to a user in Windows 7.</span></span>

![capture d’écran de la boîte de dialogue fichier courant avec les bibliothèques](images/libraries-commonfiledialog.png)

<span data-ttu-id="508d7-166">Dans Windows 7, si votre programme affiche actuellement une boîte de dialogue de fichier commune et ne modifie pas le modèle de boîte de dialogue ou ne raccorde aucun de ses événements, la nouvelle version de Windows 7 de la boîte de dialogue s’affiche automatiquement.</span><span class="sxs-lookup"><span data-stu-id="508d7-166">In Windows 7, if your program currently displays a common file dialog box and does not change the dialog box template or hook any of its events, it will display the new Windows 7 version of the dialog box automatically.</span></span> <span data-ttu-id="508d7-167">Plus précisément, dans l’appel à la fonction de boîte de dialogue de fichier commune, les membres **lpfnHook**, **HINSTANCE**, **lpTemplatename** de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) doivent avoir la **valeur null** et les indicateurs **OFN \_ ENABLEHOOK** et **OFN \_ ENABLETEMPLATE** doivent être clairs.</span><span class="sxs-lookup"><span data-stu-id="508d7-167">Specifically, in the call to the common file dialog box function, the **lpfnHook**, **hInstance**, **lpTemplatename** members of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must be **NULL** and the **OFN\_ENABLEHOOK** and **OFN\_ENABLETEMPLATE** flags must be clear.</span></span>

<span data-ttu-id="508d7-168">Dans Windows 7, les interfaces associées à [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)remplacent les fonctions de boîte de dialogue de fichier courantes qui étaient utilisées dans les versions antérieures de Windows.</span><span class="sxs-lookup"><span data-stu-id="508d7-168">In Windows 7, the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces replace the common file dialog box functions that were used in earlier versions of Windows.</span></span> <span data-ttu-id="508d7-169">Les fonctions de la boîte de dialogue de fichier courantes précédentes sont toujours prises en charge dans Windows 7, mais elles ne fournissent pas l’expérience utilisateur complète de Windows 7 et ne prennent pas en charge les bibliothèques.</span><span class="sxs-lookup"><span data-stu-id="508d7-169">The earlier common file dialog box functions are still supported in Windows 7 but they do not provide the complete Windows 7 user experience and they do not support libraries.</span></span> <span data-ttu-id="508d7-170">Voici quelques-unes des nouvelles fonctionnalités prises en charge par les interfaces associées à **IFileDialog**:</span><span class="sxs-lookup"><span data-stu-id="508d7-170">Some of the new features supported by the **IFileDialog**-related interfaces include:</span></span>

-   <span data-ttu-id="508d7-171">L’utilisateur peut accéder aux propriétés de fichier prises en charge par l’Explorateur Windows Windows 7 pour rechercher et sélectionner les fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-171">The user can access the file properties supported by the Windows 7 Windows Explorer to search and select the files.</span></span>
-   <span data-ttu-id="508d7-172">Le programme peut utiliser des interfaces et des méthodes de l’API de l’espace de noms du Shell pour travailler avec les éléments.</span><span class="sxs-lookup"><span data-stu-id="508d7-172">The program can use interfaces and methods from the Shell namespace API to work with the items.</span></span>
-   <span data-ttu-id="508d7-173">Le programme peut utiliser un modèle de personnalisation piloté par les données au lieu d’un modèle de personnalisation piloté par des fichiers de ressources pour ajouter de nouveaux contrôles aux boîtes de dialogue de fichier courantes.</span><span class="sxs-lookup"><span data-stu-id="508d7-173">The program can use a data-driven customization model instead of a resource-file-driven customization model to add new controls to the common file dialog boxes.</span></span>

<span data-ttu-id="508d7-174">Vous devez utiliser les interfaces relatives à [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="508d7-174">You should use the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces when:</span></span>

-   <span data-ttu-id="508d7-175">vous devez personnaliser la boîte de dialogue fichier commun pour votre programme dans Windows 7.</span><span class="sxs-lookup"><span data-stu-id="508d7-175">you need to customize the common file dialog box for your program in Windows 7.</span></span> <span data-ttu-id="508d7-176">Cela permettra à votre programme de travailler avec des bibliothèques et de prendre en charge la personnalisation de votre boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="508d7-176">This will allow your program to work with libraries and support customizing your dialog box.</span></span>
-   <span data-ttu-id="508d7-177">vous souhaitez que l’utilisateur puisse sélectionner plusieurs fichiers dans une boîte de dialogue fichier commun.</span><span class="sxs-lookup"><span data-stu-id="508d7-177">you want the user to be able to select multiple files from a common file dialog box.</span></span> <span data-ttu-id="508d7-178">Cela garantit que vous obtiendrez les chemins d’accès corrects à l’objet sélectionné, car une bibliothèque peut avoir du contenu stocké dans des dossiers différents.</span><span class="sxs-lookup"><span data-stu-id="508d7-178">This will ensure you get the correct paths to the selected object because a library can have contents that are stored in different folders.</span></span>

<span data-ttu-id="508d7-179">Pour plus d’informations sur les interfaces associées à [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog), consultez :</span><span class="sxs-lookup"><span data-stu-id="508d7-179">For more information on the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces, see:</span></span>

-   [<span data-ttu-id="508d7-180">**IFileDialog**</span><span class="sxs-lookup"><span data-stu-id="508d7-180">**IFileDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)
-   [<span data-ttu-id="508d7-181">**IFileOpenDialog**</span><span class="sxs-lookup"><span data-stu-id="508d7-181">**IFileOpenDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)
-   [<span data-ttu-id="508d7-182">**IFileSaveDialog**</span><span class="sxs-lookup"><span data-stu-id="508d7-182">**IFileSaveDialog**</span></span>](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ifilesavedialog)
-   [<span data-ttu-id="508d7-183">**IFileDialogCustomize**</span><span class="sxs-lookup"><span data-stu-id="508d7-183">**IFileDialogCustomize**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)
-   [<span data-ttu-id="508d7-184">**IFileDialogEvents**</span><span class="sxs-lookup"><span data-stu-id="508d7-184">**IFileDialogEvents**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogevents)
-   [<span data-ttu-id="508d7-185">**IFileDialogControlEvents**</span><span class="sxs-lookup"><span data-stu-id="508d7-185">**IFileDialogControlEvents**</span></span>](/windows/desktop/api/Shobjidl/nn-shobjidl-ifiledialogcontrolevents)

## <a name="enabling-library-selection-from-the-user-interface"></a><span data-ttu-id="508d7-186">Activation de la sélection de la bibliothèque à partir de l’interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="508d7-186">Enabling library selection from the user interface</span></span>

<span data-ttu-id="508d7-187">Si votre programme permet à l’utilisateur de sélectionner un dossier, comme pour les fonctions d’importation ou d’exportation, dans Windows 7, il doit autoriser l’utilisateur à sélectionner également une bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-187">If your program allows the user to select a folder, such as for import or export functions, in Windows 7, it should allow the user to select a library as well.</span></span> <span data-ttu-id="508d7-188">L’interface [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) et la fonction [**SHBrowseForFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) permettent à l’utilisateur de sélectionner une bibliothèque lorsque vous êtes invité à sélectionner un dossier.</span><span class="sxs-lookup"><span data-stu-id="508d7-188">The [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface and [**SHBrowseForFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) function allow the user to select a library when prompted to select a folder.</span></span> <span data-ttu-id="508d7-189">L’interface **IFileOpenDialog** est préférable à la fonction **SHBrowseForFolder** , car **IFileOpenDialog** prend en charge l’interface utilisateur de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="508d7-189">The **IFileOpenDialog** interface is preferred over the **SHBrowseForFolder** function because **IFileOpenDialog** supports the Windows 7 user interface.</span></span>

<span data-ttu-id="508d7-190">Pour permettre aux utilisateurs de sélectionner des dossiers lors de l’utilisation de l’interface [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) , appelez SetOptions avec l’indicateur Fos PICKFOLDERS défini et assurez-vous \_ que l' \_ indicateur Fos FORCEFILESYSTEM est désactivé.</span><span class="sxs-lookup"><span data-stu-id="508d7-190">To allow users to select folders when using the [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface, call SetOptions with the FOS\_PICKFOLDERS flag set and make sure the FOS\_FORCEFILESYSTEM flag is clear.</span></span>


```C++
FILEOPENDIALOGOPTIONS fileOptions;

hr = fileOpenDialogBox->GetOptions(&fileOptions);
fileOptions = fileOptions | FOS_PICKFOLDERS | ~FOS_FORCEFILESYSTEM;
hr = fileOpenDialogBox->SetOptions(fileOptions);
```



<span data-ttu-id="508d7-191">Pour permettre aux utilisateurs de sélectionner des dossiers lors de l’appel de la fonction SHBrowseForFolder, dans le membre ulFlags de la structure [**BROWSEINFO**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) , définissez l' \_ indicateur BIF USENEWUI et décochez l' \_ indicateur BIF RETURNONLYFSDIRS.</span><span class="sxs-lookup"><span data-stu-id="508d7-191">To allow users to select folders when calling the SHBrowseForFolder function, in the ulFlags member of the [**BROWSEINFO**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) structure, set the BIF\_USENEWUI flag and clear the BIF\_RETURNONLYFSDIRS flag.</span></span>


```C++
BROWSEINFO    browseInfo;
browseInfo.ulFlags = BIF_USENEWUI | ~BIF_RETURNONLYFSDIRS;
// Set other member values
pidl = SHBrowseForFolder(&browseInfo);
```



## <a name="accessing-library-content-in-a-program"></a><span data-ttu-id="508d7-192">Accès au contenu de la bibliothèque dans un programme</span><span class="sxs-lookup"><span data-stu-id="508d7-192">Accessing library content in a program</span></span>

<span data-ttu-id="508d7-193">Pour accéder au contenu d’une bibliothèque, vous devez utiliser l’API du shell Windows.</span><span class="sxs-lookup"><span data-stu-id="508d7-193">To access the contents of a library, you must use the Windows Shell API.</span></span> <span data-ttu-id="508d7-194">Les fonctions de l’API du système de fichiers ne peuvent pas être utilisées pour accéder au contenu de la bibliothèque, car les bibliothèques ne sont pas des objets de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-194">Functions of the file-system API cannot be used to access library contents because libraries are not file-system objects.</span></span> <span data-ttu-id="508d7-195">Si votre programme utilise un Explorateur de fichiers personnalisé basé sur l’API du système de fichiers, il ne pourra pas parcourir les bibliothèques ou accéder au contenu de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-195">If your program uses a custom file browser that is based on the file-system API, it will not be able to browse libraries or access library content.</span></span>

<span data-ttu-id="508d7-196">Cette section décrit la façon dont vous pouvez accéder au contenu de la bibliothèque afin de pouvoir sélectionner la meilleure façon de mettre à jour votre programme pour qu’il fonctionne avec les bibliothèques.</span><span class="sxs-lookup"><span data-stu-id="508d7-196">This section describes how you can access library content so that you can select the best way to update your program to work with libraries.</span></span>

### <a name="accessing-library-content-with-the-ishelllibrary-interface"></a><span data-ttu-id="508d7-197">Accès au contenu de la bibliothèque avec l’interface IShellLibrary</span><span class="sxs-lookup"><span data-stu-id="508d7-197">Accessing library content with the IShellLibrary interface</span></span>

<span data-ttu-id="508d7-198">Le moyen le plus simple pour un programme d’accéder au contenu de la bibliothèque consiste à utiliser l’API de bibliothèque de l' [**interpréteur**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary)de commandes.</span><span class="sxs-lookup"><span data-stu-id="508d7-198">The easiest way for a program to access library content is to use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span></span> <span data-ttu-id="508d7-199">Si vous travaillez sur un programme qui utilise l’API de système de fichiers, l' **API de bibliothèque de Shell** peut retourner les dossiers de système de fichiers d’une bibliothèque, ce qui réduit la modification apportée à votre code de programme existant.</span><span class="sxs-lookup"><span data-stu-id="508d7-199">If you are working on a program that uses the file-system API, the **Shell Library API** can return the file-system folders of a library, which minimizes the change to your existing program code.</span></span>


```C++
IShellLibrary *picturesLibrary;

hr = SHLoadLibraryFromKnownFolder(FOLDERID_PicturesLibrary, 
                                  STGM_READ, 
                                  IID_PPV_ARGS(&picturesLibrary));

// picturesLibrary now points to the user's picture library
    
IShellItemArray *pictureFolders; 

hr = pslLibrary->GetFolders(LFF_FORCEFILESYSTEM, IID_PPV_ARGS(&pictureFolders));

// pictureFolders now contains an array of Shell items that
// represent the folders found in the user's pictures library
```



### <a name="accessing-library-content-with-the-shell-apis"></a><span data-ttu-id="508d7-200">Accès au contenu de la bibliothèque à l’aide des API Shell</span><span class="sxs-lookup"><span data-stu-id="508d7-200">Accessing library content with the Shell APIs</span></span>

<span data-ttu-id="508d7-201">Étant donné que les objets de bibliothèque font partie du modèle de programmation de l’interpréteur de commandes, ils peuvent être utilisés avec d’autres API de shell Windows.</span><span class="sxs-lookup"><span data-stu-id="508d7-201">Because the library objects are part of the Shell programming model, they can be used with other Windows Shell APIs.</span></span> <span data-ttu-id="508d7-202">Par exemple, vous pouvez utiliser les interfaces [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) et [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) dans votre programme, ainsi que les fonctions d’assistance associées, pour accéder au contenu d’une bibliothèque de la même façon que vous énumérez les dossiers et le contenu du dossier pour accéder au contenu avec les API du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-202">For example you can use the [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) and [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interfaces in your program, along with related helper functions, to access the contents of a library in the same way as you would enumerate folders and folder contents to access content with the file system APIs.</span></span>

<span data-ttu-id="508d7-203">Les API de shell Windows prennent en charge deux modes d’énumération pour accéder au contenu d’une bibliothèque :</span><span class="sxs-lookup"><span data-stu-id="508d7-203">The Windows Shell APIs support two enumeration modes to access the contents of a library:</span></span>

-   <span data-ttu-id="508d7-204">**Parcourir l’énumération**</span><span class="sxs-lookup"><span data-stu-id="508d7-204">**Browse enumeration**</span></span>

    <span data-ttu-id="508d7-205">L’énumération Browse est le mode d’énumération par défaut et énumère le contenu d’un dossier de bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-205">Browse enumeration is the default enumeration mode and enumerates the contents of a library folder.</span></span> <span data-ttu-id="508d7-206">Désactivez \_ l' \_ indicateur d’énumération de navigation SHCONTF pour utiliser ce mode.</span><span class="sxs-lookup"><span data-stu-id="508d7-206">Clear the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

-   <span data-ttu-id="508d7-207">**Énumération de navigation**</span><span class="sxs-lookup"><span data-stu-id="508d7-207">**Navigation enumeration**</span></span>

    <span data-ttu-id="508d7-208">L’énumération de navigation énumère les dossiers de bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-208">Navigation enumeration enumerates the library folders.</span></span> <span data-ttu-id="508d7-209">Définissez l' \_ \_ indicateur d’énumération de navigation SHCONTF pour utiliser ce mode.</span><span class="sxs-lookup"><span data-stu-id="508d7-209">Set the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

<span data-ttu-id="508d7-210">Si votre programme utilise un contrôle d’arborescence personnalisé pour naviguer dans les dossiers de l’utilisateur, l’énumération des dossiers en mode d’énumération de navigation vous donnera une liste des dossiers d’une bibliothèque qui est cohérente avec la manière dont l’Explorateur Windows énumère les dossiers dans Windows 7.</span><span class="sxs-lookup"><span data-stu-id="508d7-210">If your program uses a custom tree control to navigate the user's folders, enumerating the folders in the navigation enumeration mode will give you a list of a library's folders that is consistent with how the Windows Explorer enumerates folders in Windows 7.</span></span>

<span data-ttu-id="508d7-211">Pour obtenir des exemples d’utilisation de ces fonctionnalités dans un programme, consultez l’exemple ShellStorage dans le SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="508d7-211">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="saving-user-content-in-a-library"></a><span data-ttu-id="508d7-212">Enregistrement du contenu utilisateur dans une bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-212">Saving user content in a library</span></span>

<span data-ttu-id="508d7-213">Votre programme peut enregistrer le contenu de l’utilisateur dans une bibliothèque et dans un dossier de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-213">Your program can save user content to a library as well as to a folder in the library.</span></span> <span data-ttu-id="508d7-214">De même, l’utilisateur peut enregistrer dans un dossier spécifique d’une bibliothèque, ou il peut simplement enregistrer dans la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-214">Likewise, the user can save to a specific folder in a library or they can just save to the library.</span></span>

<span data-ttu-id="508d7-215">Chaque bibliothèque a un dossier qui est désigné comme emplacement d’enregistrement par défaut.</span><span class="sxs-lookup"><span data-stu-id="508d7-215">Every library has a folder that is designated as the default save location.</span></span> <span data-ttu-id="508d7-216">L’emplacement d’enregistrement par défaut est défini lors de la création de la bibliothèque. Toutefois, l’utilisateur peut réassigner l’emplacement d’enregistrement par défaut à n’importe quel dossier de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-216">The default save location is defined when the library is created; however the user can reassign the default save location to be any folder in the library.</span></span> <span data-ttu-id="508d7-217">Bien que l’utilisateur n’ait pas besoin de configurer un emplacement d’enregistrement par défaut, il a la possibilité de le modifier.</span><span class="sxs-lookup"><span data-stu-id="508d7-217">While the user does not need to configure a default save location, they have the option to change it.</span></span> <span data-ttu-id="508d7-218">Si l’utilisateur supprime le dossier actuellement défini comme emplacement d’enregistrement par défaut, la bibliothèque configure automatiquement le dossier suivant dans la bibliothèque comme emplacement d’enregistrement par défaut.</span><span class="sxs-lookup"><span data-stu-id="508d7-218">If the user deletes the folder that is currently set as the default save location, the library will automatically configure the next folder in the library to be the default save location.</span></span>

<span data-ttu-id="508d7-219">Vous pouvez enregistrer le contenu utilisateur dans une bibliothèque de plusieurs manières.</span><span class="sxs-lookup"><span data-stu-id="508d7-219">There are several ways you can save user content to a library.</span></span>

-   <span data-ttu-id="508d7-220">**API Shell**</span><span class="sxs-lookup"><span data-stu-id="508d7-220">**Shell API**</span></span>

    <span data-ttu-id="508d7-221">Si vous utilisez le modèle de programmation de l’interpréteur de commandes et enregistrez un élément de Shell, tel que représenté par un [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage ou IStream, sur un objet de bibliothèque, l’élément de Shell sera automatiquement stocké dans l’emplacement d’enregistrement par défaut de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-221">If you are using the Shell programming model and save a Shell item, as represented by an [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage, or IStream, to a library object, the Shell item will be automatically stored in the default save location of the library.</span></span>

-   <span data-ttu-id="508d7-222">**API du système de fichiers**</span><span class="sxs-lookup"><span data-stu-id="508d7-222">**File-system API**</span></span>

    <span data-ttu-id="508d7-223">Si vous disposez d’un programme existant qui utilise de nombreux appels d’API de système de fichiers, vous pouvez obtenir un chemin d’accès au dossier défini en tant qu’emplacement d’enregistrement par défaut de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-223">If you have an existing program that uses many file-system API calls, you can get a path to the folder that is defined as the library's default save location.</span></span> <span data-ttu-id="508d7-224">Le chemin d’accès au dossier peut ensuite être passé à une API de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="508d7-224">The folder path can then be passed to a file-system API.</span></span>

<span data-ttu-id="508d7-225">Pour obtenir des exemples d’utilisation de ces fonctionnalités dans un programme, consultez l’exemple ShellStorage dans le SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="508d7-225">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="supporting-drag-and-drop-operations-in-a-library"></a><span data-ttu-id="508d7-226">Prise en charge des opérations de glisser-déplacer dans une bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-226">Supporting drag-and-drop operations in a library</span></span>

<span data-ttu-id="508d7-227">Si votre programme prend en charge les actions de glisser-déplacer, celles-ci doivent être mises à jour pour prendre en charge l’interaction de bibliothèque correcte.</span><span class="sxs-lookup"><span data-stu-id="508d7-227">If your program supports drag-and-drop actions, those should be updated to support the correct library interaction.</span></span> <span data-ttu-id="508d7-228">Si un fichier est supprimé dans une bibliothèque, le fichier supprimé doit être enregistré dans l’emplacement d’enregistrement par défaut.</span><span class="sxs-lookup"><span data-stu-id="508d7-228">If a file is dropped into a library, the dropped file should be saved in the default save location.</span></span> <span data-ttu-id="508d7-229">Si un dossier est déposé dans une bibliothèque, le dossier supprimé doit être ajouté en tant que nouveau dossier à la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-229">If a folder is dropped into a library, the dropped folder should be added as a new folder to the library.</span></span> <span data-ttu-id="508d7-230">Si un fichier est déplacé dans un dossier existant qui n’est pas l’emplacement d’enregistrement par défaut, le fichier doit être ajouté au dossier sélectionné.</span><span class="sxs-lookup"><span data-stu-id="508d7-230">If a file is dropped into an existing folder that is not the default save location, the file should be added to the selected folder.</span></span>

<span data-ttu-id="508d7-231">Pour obtenir des exemples d’ajout de la prise en charge de bibliothèque pour la fonctionnalité glisser-déplacer de vos programmes, consultez l’exemple ShellLibraryCommandLine dans le SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="508d7-231">For examples of how to add library support for your programs drag-and-drop functionality, see the ShellLibraryCommandLine sample in the Windows SDK.</span></span>

## <a name="keeping-in-sync-with-a-library"></a><span data-ttu-id="508d7-232">Maintien de la synchronisation avec une bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-232">Keeping in sync with a library</span></span>

<span data-ttu-id="508d7-233">Cette rubrique décrit comment un programme peut conserver son affichage du contenu d’une bibliothèque à jour.</span><span class="sxs-lookup"><span data-stu-id="508d7-233">This topic describes how a program can keep its view of a library's content up-to-date.</span></span>

### <a name="bulk-update"></a><span data-ttu-id="508d7-234">Mise à jour en bloc</span><span class="sxs-lookup"><span data-stu-id="508d7-234">Bulk Update</span></span>

<span data-ttu-id="508d7-235">Étant donné que l’utilisateur peut modifier les dossiers d’une bibliothèque de manière interactive lorsque votre programme n’est pas en cours d’exécution, votre programme doit appeler [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) lorsqu’il commence à détecter et à stocker les modifications apportées à la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-235">Because the user can modify the folders of a library interactively when your program is not running, your program should call [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) when it starts to discover and store any changes to the library.</span></span> <span data-ttu-id="508d7-236">L’API Shell fournit la fonction **SHResolveLibrary** pour permettre à un programme d’obtenir le contenu actuel d’une bibliothèque et les emplacements actuels des dossiers que la bibliothèque peut contenir.</span><span class="sxs-lookup"><span data-stu-id="508d7-236">The Shell API provides the **SHResolveLibrary** function to enable a program to get the current contents of a library and the current locations of any folders the library might contain.</span></span>

<span data-ttu-id="508d7-237">Notez que [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) est une fonction de blocage qui peut prendre beaucoup de temps pour être retournée en fonction de ce qui a changé dans la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-237">Note that [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) is a blocking function that could take a long time to return depending on what has changed in the library.</span></span> <span data-ttu-id="508d7-238">Par conséquent, il ne doit pas être appelé à partir d’un thread d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="508d7-238">As such, it should not be called from a UI thread.</span></span>

<span data-ttu-id="508d7-239">Une fois le programme mis à jour, il peut s’inscrire aux notifications de modification pour conserver une vue actuelle.</span><span class="sxs-lookup"><span data-stu-id="508d7-239">After the program has been brought up-to-date, it can then register for change notifications to maintain a current view.</span></span>

### <a name="shell-api-notification"></a><span data-ttu-id="508d7-240">Notification de l’API Shell</span><span class="sxs-lookup"><span data-stu-id="508d7-240">Shell API Notification</span></span>

<span data-ttu-id="508d7-241">L’API shell Windows fournit la fonction [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) , qui est la méthode recommandée pour que les processus non-service soient avertis d’une modification dans la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-241">The Windows Shell API provides the [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) function, which is the preferred way for non-service processes to be notified of a change in the library.</span></span>

<span data-ttu-id="508d7-242">Pour détecter les modifications apportées aux éléments d’une bibliothèque à l’aide de l’API du shell Windows, appelez [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) pour inscrire votre programme afin de recevoir des notifications de modifications apportées aux éléments d’un dossier de bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="508d7-242">To detect changes to items within a library using the Windows Shell API, call [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) to register your program for notifications of changes to items in a library folder.</span></span> <span data-ttu-id="508d7-243">Cette fonction peut notifier votre programme s’il y a une modification dans une bibliothèque ou dans une bibliothèque spécifique.</span><span class="sxs-lookup"><span data-stu-id="508d7-243">This function can notify your program if there is a change in any library or just in a specific library.</span></span> <span data-ttu-id="508d7-244">Les notifications sont envoyées immédiatement lorsqu’une bibliothèque est modifiée.</span><span class="sxs-lookup"><span data-stu-id="508d7-244">Notifications are sent immediately when a library is changed.</span></span>

### <a name="file-system-api-notification"></a><span data-ttu-id="508d7-245">Notification de l’API du système de fichiers</span><span class="sxs-lookup"><span data-stu-id="508d7-245">File-system API Notification</span></span>

<span data-ttu-id="508d7-246">Les notifications de système de fichiers doivent être utilisées dans les processus de service.</span><span class="sxs-lookup"><span data-stu-id="508d7-246">File system notifications must be used in service processes.</span></span>

<span data-ttu-id="508d7-247">Pour détecter les modifications apportées aux éléments d’une bibliothèque à l’aide de l’API du système de fichiers, énumérez les dossiers dans la bibliothèque et appelez [**FindFirstChangeNotification**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) pour chaque dossier à surveiller.</span><span class="sxs-lookup"><span data-stu-id="508d7-247">To detect changes to items in a library using the file-system API, enumerate the folders in the library and call [**FindFirstChangeNotification**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) for each folder to monitor.</span></span> <span data-ttu-id="508d7-248">Votre programme recevra une notification lors de la modification d’un dossier surveillé.</span><span class="sxs-lookup"><span data-stu-id="508d7-248">Your program will receive notification when a monitored folder changes.</span></span> <span data-ttu-id="508d7-249">Pour rechercher le fichier spécifique des fichiers qui ont été modifiés dans le dossier, appelez [**ReadDirectoryChangesW**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span><span class="sxs-lookup"><span data-stu-id="508d7-249">To find the specific file of files that changed in the folder, call [**ReadDirectoryChangesW**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span></span> <span data-ttu-id="508d7-250">Pour détecter les modifications apportées au fichier de description de la bibliothèque, surveillez le dossier qui le contient.</span><span class="sxs-lookup"><span data-stu-id="508d7-250">To detect changes in the library description file, monitor the folder that contains it.</span></span> <span data-ttu-id="508d7-251">Le fichier de description de la bibliothèque se trouve dans le dossier [**FOLDERID \_ Libraries**](knownfolderid.md) .</span><span class="sxs-lookup"><span data-stu-id="508d7-251">The library description file can be found in the [**FOLDERID\_Libraries**](knownfolderid.md) folder.</span></span> <span data-ttu-id="508d7-252">Toutefois, le fichier de description de la bibliothèque ne doit pas être ouvert ou modifié.</span><span class="sxs-lookup"><span data-stu-id="508d7-252">The library description file, however, should not be opened or modified.</span></span>

## <a name="related-topics"></a><span data-ttu-id="508d7-253">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="508d7-253">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="508d7-254">À propos des bibliothèques</span><span class="sxs-lookup"><span data-stu-id="508d7-254">About Libraries</span></span>](library-leverage-to-manage-folders.md)
</dt> <dt>

[<span data-ttu-id="508d7-255">**IShellLibrary**</span><span class="sxs-lookup"><span data-stu-id="508d7-255">**IShellLibrary**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary)
</dt> <dt>

[<span data-ttu-id="508d7-256">Liens de Shell</span><span class="sxs-lookup"><span data-stu-id="508d7-256">Shell Links</span></span>](./links.md)
</dt> <dt>

[<span data-ttu-id="508d7-257">Dossiers connus</span><span class="sxs-lookup"><span data-stu-id="508d7-257">Known Folders</span></span>](known-folders.md)
</dt> <dt>

[<span data-ttu-id="508d7-258">Schéma de description de la bibliothèque</span><span class="sxs-lookup"><span data-stu-id="508d7-258">Library Description Schema</span></span>](library-schema-entry.md)
</dt> <dt>

[<span data-ttu-id="508d7-259">**IID \_ PPV \_ args**</span><span class="sxs-lookup"><span data-stu-id="508d7-259">**IID\_PPV\_ARGS**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-iid_ppv_args)
</dt> </dl>

 

 
