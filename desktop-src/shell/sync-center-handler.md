---
description: Cette rubrique fournit un examen pas à pas de la configuration requise pour créer un fichier DLL qui implémente un gestionnaire à utiliser avec le centre de synchronisation. Ces informations sont valides à compter de Windows Vista.
title: Développement d’un gestionnaire de centre de synchronisation Windows
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 66b40f81-9515-4190-8ced-44f20bb9df86
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 11185aa5976c27b7af95787b081e1eaacd99c8e9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104973271"
---
# <a name="developing-a-windows-sync-center-handler"></a><span data-ttu-id="1536b-104">Développement d’un gestionnaire de centre de synchronisation Windows</span><span class="sxs-lookup"><span data-stu-id="1536b-104">Developing a Windows Sync Center Handler</span></span>

<span data-ttu-id="1536b-105">Cette rubrique fournit un examen pas à pas de la configuration requise pour créer un fichier DLL qui implémente un gestionnaire à utiliser avec le centre de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1536b-105">This topic provides a step-by-step examination of the requirements to build a DLL file that implements a handler to be used with Sync Center.</span></span> <span data-ttu-id="1536b-106">Ces informations sont valides à compter de Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="1536b-106">This information is valid as of Windows Vista.</span></span>

-   [<span data-ttu-id="1536b-107">L’expérience de synchronisation Windows avant Vista</span><span class="sxs-lookup"><span data-stu-id="1536b-107">The Windows Synchronization Experience Before Vista</span></span>](#the-windows-synchronization-experience-before-vista)
-   [<span data-ttu-id="1536b-108">API du centre de synchronisation</span><span class="sxs-lookup"><span data-stu-id="1536b-108">Sync Center APIs</span></span>](#sync-center-apis)
    -   [<span data-ttu-id="1536b-109">Interfaces essentielles</span><span class="sxs-lookup"><span data-stu-id="1536b-109">Essential Interfaces</span></span>](#essential-interfaces)

## <a name="the-windows-synchronization-experience-before-vista"></a><span data-ttu-id="1536b-110">L’expérience de synchronisation Windows avant Vista</span><span class="sxs-lookup"><span data-stu-id="1536b-110">The Windows Synchronization Experience Before Vista</span></span>

<span data-ttu-id="1536b-111">Windows XP a fourni un [Gestionnaire de synchronisation](syncmgr-start-page.md) (mobsync.exe).</span><span class="sxs-lookup"><span data-stu-id="1536b-111">Windows XP provided a [Synchronization Manager](syncmgr-start-page.md) (mobsync.exe).</span></span> <span data-ttu-id="1536b-112">De nombreux appareils, tels que les lecteurs MP3, les téléphones cellulaires et les appareils photo, ont également fourni leurs propres interfaces de synchronisation plutôt que d’utiliser le gestionnaire de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1536b-112">Many devices such as mp3 players, cell phones, and cameras also provided their own synchronization interfaces rather than using the Synchronization Manager.</span></span> <span data-ttu-id="1536b-113">Cela a abouti à une expérience utilisateur incohérente et non centralisée.</span><span class="sxs-lookup"><span data-stu-id="1536b-113">This resulted in an inconsistent and noncentralized user experience.</span></span>

<span data-ttu-id="1536b-114">La nouvelle fonctionnalité du centre de synchronisation fournie dans Windows Vista présente plusieurs avantages par rapport à l’ancien gestionnaire de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1536b-114">The new Sync Center feature provided in Windows Vista has several advantages over the older Synchronization Manager.</span></span>

-   <span data-ttu-id="1536b-115">Meilleure détectabilité</span><span class="sxs-lookup"><span data-stu-id="1536b-115">Better discoverability</span></span>
-   <span data-ttu-id="1536b-116">Moins besoin d’une action directe de l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="1536b-116">Less need for direct user action</span></span>
-   <span data-ttu-id="1536b-117">Ne bloque pas les autres opérations</span><span class="sxs-lookup"><span data-stu-id="1536b-117">Does not block other operations</span></span>
-   <span data-ttu-id="1536b-118">Meilleure visualisation de la progression de la synchronisation</span><span class="sxs-lookup"><span data-stu-id="1536b-118">Better visualization of the synchronization progress</span></span>
-   <span data-ttu-id="1536b-119">Modèle de développement plus facile à comprendre</span><span class="sxs-lookup"><span data-stu-id="1536b-119">Easier to understand development model</span></span>

## <a name="sync-center-apis"></a><span data-ttu-id="1536b-120">API du centre de synchronisation</span><span class="sxs-lookup"><span data-stu-id="1536b-120">Sync Center APIs</span></span>

<span data-ttu-id="1536b-121">Le centre de synchronisation communique avec les gestionnaires via un certain nombre d’interfaces COM (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="1536b-121">Sync Center communicates with handlers through a number of Component Object Model (COM) interfaces.</span></span> <span data-ttu-id="1536b-122">Toutes ces interfaces ne sont pas nécessaires pour implémenter un gestionnaire du centre de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1536b-122">Not all of these interfaces are needed to implement a Sync Center handler.</span></span> <span data-ttu-id="1536b-123">Cette rubrique a été divisée en deux sections.</span><span class="sxs-lookup"><span data-stu-id="1536b-123">This topic has been broken into two sections.</span></span> <span data-ttu-id="1536b-124">La première section explique les interfaces COM essentielles que chaque gestionnaire doit prendre en charge, et la deuxième section examine les interfaces COM facultatives et examine les raisons pour lesquelles un gestionnaire les prend en charge.</span><span class="sxs-lookup"><span data-stu-id="1536b-124">The first section explains the essential COM interfaces that every handler must support, and the second section examines the optional COM interfaces and looks at the reasons that a handler would support them.</span></span>

-   [<span data-ttu-id="1536b-125">Interfaces essentielles</span><span class="sxs-lookup"><span data-stu-id="1536b-125">Essential Interfaces</span></span>](#essential-interfaces)

### <a name="essential-interfaces"></a><span data-ttu-id="1536b-126">Interfaces essentielles</span><span class="sxs-lookup"><span data-stu-id="1536b-126">Essential Interfaces</span></span>

<span data-ttu-id="1536b-127">Tous les gestionnaires du centre de synchronisation doivent prendre en charge les interfaces suivantes :</span><span class="sxs-lookup"><span data-stu-id="1536b-127">All Sync Center handlers must support the following interfaces:</span></span>

-   [<span data-ttu-id="1536b-128">**ISyncMgrHandler**</span><span class="sxs-lookup"><span data-stu-id="1536b-128">**ISyncMgrHandler**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler)
-   [<span data-ttu-id="1536b-129">**ISyncMgrHandlerInfo**</span><span class="sxs-lookup"><span data-stu-id="1536b-129">**ISyncMgrHandlerInfo**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo)
-   [<span data-ttu-id="1536b-130">**ISyncMgrSyncItemContainer**</span><span class="sxs-lookup"><span data-stu-id="1536b-130">**ISyncMgrSyncItemContainer**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer)
-   [<span data-ttu-id="1536b-131">**IEnumSyncMgrSyncItems**</span><span class="sxs-lookup"><span data-stu-id="1536b-131">**IEnumSyncMgrSyncItems**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems)
-   [<span data-ttu-id="1536b-132">**ISyncMgrSyncItem**</span><span class="sxs-lookup"><span data-stu-id="1536b-132">**ISyncMgrSyncItem**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem)
-   [<span data-ttu-id="1536b-133">**ISyncMgrSyncItemInfo**</span><span class="sxs-lookup"><span data-stu-id="1536b-133">**ISyncMgrSyncItemInfo**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo)

<span data-ttu-id="1536b-134">[**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) et [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) sont utilisés pour décrire un élément de synchronisation unique impliqué dans la synchronisation dans le centre de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1536b-134">[**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) and [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) are used to describe a single sync item involved in the synchronization to the Sync Center.</span></span> <span data-ttu-id="1536b-135">Un élément de synchronisation représente généralement un type de données particulier (tel que des images) ou un emplacement de données particulier.</span><span class="sxs-lookup"><span data-stu-id="1536b-135">A sync item generally represents either a particular data type (such as images) or a particular location of data.</span></span>

<span data-ttu-id="1536b-136">Les éléments de synchronisation qui représentent des emplacements de données différents permettent des synchronisations très spécifiques.</span><span class="sxs-lookup"><span data-stu-id="1536b-136">Sync items that represent different data locations allow for very specific synchronizations.</span></span> <span data-ttu-id="1536b-137">La granularité de l’emplacement est jusqu’à l’auteur du gestionnaire, mais il est important de le faire dans la conception.</span><span class="sxs-lookup"><span data-stu-id="1536b-137">The granularity of the location is up to the handler author, but care should be taken in the design.</span></span> <span data-ttu-id="1536b-138">Si le nombre d’éléments de synchronisation (emplacements) est trop faible, l’utilisateur est limité dans la mesure où il ne peut synchroniser que certaines données.</span><span class="sxs-lookup"><span data-stu-id="1536b-138">If there are too few sync items (locations), then the user is restricted in their ability to sync only certain data.</span></span> <span data-ttu-id="1536b-139">À l’autre extrême, une granularité trop importante peut devenir ingérable.</span><span class="sxs-lookup"><span data-stu-id="1536b-139">At the other extreme, too much granularity can become unmanageable.</span></span>

<span data-ttu-id="1536b-140">Si un gestionnaire prend en charge plusieurs types de données ou plusieurs emplacements de données, il doit prendre en charge plusieurs objets d’élément de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1536b-140">If a handler supports more than one data type or multiple data locations, then it needs to support more than one sync item object.</span></span> <span data-ttu-id="1536b-141">Il peut s’agir, par exemple, d’un assistant de données personnelles (PDA) qui permet à l’utilisateur de synchroniser des contacts, des éléments de calendrier et des documents.</span><span class="sxs-lookup"><span data-stu-id="1536b-141">An example might be a personal data assistant (PDA) that allows the user to sync contacts, calendar items and documents.</span></span> <span data-ttu-id="1536b-142">Ces trois types de données doivent être représentés par trois objets uniques qui exposent chacun les interfaces [**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) et [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) .</span><span class="sxs-lookup"><span data-stu-id="1536b-142">These three data types would need to be represented by three unique objects that each expose the [**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) and [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) interfaces.</span></span>

<span data-ttu-id="1536b-143">L’interface [**IEnumSyncMgrSyncItems**](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems) fournit un mécanisme pour énumérer les éléments de synchronisation d’un gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="1536b-143">The [**IEnumSyncMgrSyncItems**](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems) interface provides a mechanism to enumerate through a handler's sync items.</span></span> <span data-ttu-id="1536b-144">Pour récupérer cet énumérateur, le centre de synchronisation appelle la méthode [**ISyncMgrSyncItemContainer :: GetSyncItemEnumerator**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemenumerator) exposée par le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="1536b-144">To retrieve this enumerator, Sync Center calls the [**ISyncMgrSyncItemContainer::GetSyncItemEnumerator**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemenumerator) method exposed by the handler.</span></span> <span data-ttu-id="1536b-145">[**ISyncMgrSyncItemContainer**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer) contient également deux autres méthodes que le centre de synchronisation peut utiliser pour récupérer des informations sur les éléments de synchronisation du gestionnaire :</span><span class="sxs-lookup"><span data-stu-id="1536b-145">[**ISyncMgrSyncItemContainer**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer) also contains two other methods that the Sync Center can use to retrieve information about the handler's sync items:</span></span>

-   <span data-ttu-id="1536b-146">[**GetSyncItem**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitem) retourne un élément de synchronisation spécifique.</span><span class="sxs-lookup"><span data-stu-id="1536b-146">[**GetSyncItem**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitem) returns a specific sync item.</span></span>
-   <span data-ttu-id="1536b-147">[**GetSyncItemCount**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemcount) retourne le nombre d’éléments de synchronisation pris en charge par le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="1536b-147">[**GetSyncItemCount**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemcount) returns the number of sync items supported by the handler.</span></span>

<span data-ttu-id="1536b-148">[**ISyncMgrHandler**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler) et [**ISyncMgrHandlerInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo) sont utilisés pour décrire les propriétés du gestionnaire de la main et lancer la synchronisation réelle.</span><span class="sxs-lookup"><span data-stu-id="1536b-148">[**ISyncMgrHandler**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler) and [**ISyncMgrHandlerInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo) are used to describe the properties of the hander and launch the actual synchronization.</span></span> <span data-ttu-id="1536b-149">[**ISyncMgrHandler :: Synchronize**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrhandler-synchronize) est l’endroit où le code du gestionnaire effectue la synchronisation et fournit des commentaires sur la progression et les problèmes qui se produisent.</span><span class="sxs-lookup"><span data-stu-id="1536b-149">[**ISyncMgrHandler::Synchronize**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrhandler-synchronize) is where the handler code carries out the synchronization and provides feedback on progress and any issues that occur.</span></span>

<span data-ttu-id="1536b-150">La plupart des méthodes d’interface n’ont pas besoin d’être entièrement implémentées.</span><span class="sxs-lookup"><span data-stu-id="1536b-150">Many of the interface methods do not need to be fully implemented.</span></span> <span data-ttu-id="1536b-151">Le centre de synchronisation fournit une certaine quantité d’informations par défaut.</span><span class="sxs-lookup"><span data-stu-id="1536b-151">Sync Center provides a certain amount of default information.</span></span> <span data-ttu-id="1536b-152">Les interfaces permettent à un gestionnaire de remplacer ces informations et de fournir des informations personnalisées à afficher, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="1536b-152">The interfaces allow a handler to override this information and provide custom information to display, if needed.</span></span>

 

 



