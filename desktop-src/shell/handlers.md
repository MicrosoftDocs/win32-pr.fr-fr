---
description: Les fonctionnalités de l’interpréteur de commandes peuvent être étendues avec des entrées de Registre et des fichiers. ini.
ms.assetid: 74a81e4f-7357-4901-a118-ba44e8892f25
title: Création de gestionnaires d’extensions d’environnement
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 991f3c1684b7491e2ad29fae29f48164ffdd47cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104991573"
---
# <a name="creating-shell-extension-handlers"></a><span data-ttu-id="8f837-103">Création de gestionnaires d’extensions d’environnement</span><span class="sxs-lookup"><span data-stu-id="8f837-103">Creating Shell Extension Handlers</span></span>

<span data-ttu-id="8f837-104">Les fonctionnalités de l’interpréteur de commandes peuvent être étendues avec des entrées de Registre et des fichiers. ini.</span><span class="sxs-lookup"><span data-stu-id="8f837-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="8f837-105">Bien que cette approche de l’extension de l’interpréteur de commandes soit simple et adaptée à de nombreuses fins, elle est limitée.</span><span class="sxs-lookup"><span data-stu-id="8f837-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="8f837-106">Par exemple, si vous utilisez le registre pour spécifier une icône personnalisée pour un type de fichier, la même icône s’affiche pour chaque fichier de ce type.</span><span class="sxs-lookup"><span data-stu-id="8f837-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="8f837-107">L’extension de l’interpréteur de commandes avec le registre ne vous permet pas de faire varier l’icône pour différents fichiers du même type.</span><span class="sxs-lookup"><span data-stu-id="8f837-107">Extending the Shell with the registry does not allow you to vary the icon for different files of the same type.</span></span> <span data-ttu-id="8f837-108">D’autres aspects de l’interpréteur de commandes, tels que la feuille de propriétés des **Propriétés** qui peuvent être affichées lorsqu’un utilisateur clique avec le bouton droit, ne peuvent pas être modifiés du tout à l’aide du Registre.</span><span class="sxs-lookup"><span data-stu-id="8f837-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="8f837-109">Une approche plus puissante et flexible pour étendre l’interpréteur de commandes consiste à implémenter des *gestionnaires d’extensions de Shell*.</span><span class="sxs-lookup"><span data-stu-id="8f837-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="8f837-110">Ces gestionnaires peuvent être implémentés pour diverses actions que l’interpréteur de commandes peut effectuer.</span><span class="sxs-lookup"><span data-stu-id="8f837-110">These handlers can be implemented for a variety of actions that the Shell can perform.</span></span> <span data-ttu-id="8f837-111">Avant d’entreprendre l’action, l’interpréteur de commandes interroge le gestionnaire d’extensions, en lui donnant la possibilité de modifier l’action.</span><span class="sxs-lookup"><span data-stu-id="8f837-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="8f837-112">Un gestionnaire d’extensions de menu contextuel est un exemple courant.</span><span class="sxs-lookup"><span data-stu-id="8f837-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="8f837-113">Si l’une d’elles est implémentée pour un type de fichier, elle est interrogée chaque fois que l’utilisateur clique avec le bouton droit sur l’un des fichiers.</span><span class="sxs-lookup"><span data-stu-id="8f837-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="8f837-114">Le gestionnaire peut ensuite spécifier des éléments de menu supplémentaires pour chaque fichier, au lieu d’avoir le même ensemble pour le type de fichier entier.</span><span class="sxs-lookup"><span data-stu-id="8f837-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for the entire file type.</span></span>

<span data-ttu-id="8f837-115">Ce document explique comment implémenter les gestionnaires d’extension qui vous permettent de modifier diverses actions de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="8f837-115">This document discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="8f837-116">Les gestionnaires suivants sont associés à un type de fichier particulier et vous permettent de spécifier la base de données fichier par fichier :</span><span class="sxs-lookup"><span data-stu-id="8f837-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis:</span></span>



| <span data-ttu-id="8f837-117">Handler</span><span class="sxs-lookup"><span data-stu-id="8f837-117">Handler</span></span>                                               | <span data-ttu-id="8f837-118">Description</span><span class="sxs-lookup"><span data-stu-id="8f837-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8f837-119">Gestionnaire de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="8f837-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="8f837-120">Appelé avant l’affichage du menu contextuel d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="8f837-121">Elle vous permet d’ajouter des éléments au menu contextuel, fichier par fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="8f837-122">Gestionnaire de données</span><span class="sxs-lookup"><span data-stu-id="8f837-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="8f837-123">Appelé lorsqu’une opération de glisser-déplacer est exécutée sur des objets dragShell.</span><span class="sxs-lookup"><span data-stu-id="8f837-123">Called when a drag-and-drop operation is performed on dragShell objects.</span></span> <span data-ttu-id="8f837-124">Elle vous permet de fournir des formats de presse-papiers supplémentaires à la cible de déplacement.</span><span class="sxs-lookup"><span data-stu-id="8f837-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                        |
| [<span data-ttu-id="8f837-125">Supprimer le gestionnaire</span><span class="sxs-lookup"><span data-stu-id="8f837-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="8f837-126">Appelé lorsqu’un objet de données est déplacé ou déplacé sur un fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="8f837-127">Elle vous permet de créer un fichier dans une cible de déplacement.</span><span class="sxs-lookup"><span data-stu-id="8f837-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="8f837-128">Gestionnaire d’icône</span><span class="sxs-lookup"><span data-stu-id="8f837-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="8f837-129">Appelé avant l’affichage de l’icône d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="8f837-130">Elle vous permet de remplacer l’icône par défaut du fichier par une icône personnalisée, fichier par fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="8f837-131">Gestionnaire de feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="8f837-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="8f837-132">Appelé avant l’affichage de la feuille de propriétés des **Propriétés** d’un objet.</span><span class="sxs-lookup"><span data-stu-id="8f837-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="8f837-133">Elle vous permet d’ajouter ou de remplacer des pages.</span><span class="sxs-lookup"><span data-stu-id="8f837-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="8f837-134">**Gestionnaire d’images miniatures**</span><span class="sxs-lookup"><span data-stu-id="8f837-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="8f837-135">Fournit une image pour représenter l’élément.</span><span class="sxs-lookup"><span data-stu-id="8f837-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="8f837-136">**Gestionnaire d'info-bulle**</span><span class="sxs-lookup"><span data-stu-id="8f837-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="8f837-137">Fournit du texte contextuel lorsque l’utilisateur place le pointeur de la souris sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="8f837-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="8f837-138">**Gestionnaire de métadonnées**</span><span class="sxs-lookup"><span data-stu-id="8f837-138">**Metadata handler**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)     | <span data-ttu-id="8f837-139">Fournit un accès en lecture et en écriture aux métadonnées (propriétés) stockées dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="8f837-140">Cela peut être utilisé pour étendre le mode Détails, info-bulles, la page de propriétés et les fonctionnalités de regroupement.</span><span class="sxs-lookup"><span data-stu-id="8f837-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="8f837-141">Les autres gestionnaires ne sont pas associés à un type de fichier particulier, mais sont appelés avant certaines opérations de Shell :</span><span class="sxs-lookup"><span data-stu-id="8f837-141">Other handlers are not associated with a particular file type but are called before some Shell operations:</span></span>



| <span data-ttu-id="8f837-142">Handler</span><span class="sxs-lookup"><span data-stu-id="8f837-142">Handler</span></span>                                                            | <span data-ttu-id="8f837-143">Description</span><span class="sxs-lookup"><span data-stu-id="8f837-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8f837-144">Gestionnaire de colonnes</span><span class="sxs-lookup"><span data-stu-id="8f837-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="8f837-145">Appelée par l’Explorateur Windows avant d’afficher la vue Détails d’un dossier.</span><span class="sxs-lookup"><span data-stu-id="8f837-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="8f837-146">Elle vous permet d’ajouter des colonnes personnalisées à la vue Détails.</span><span class="sxs-lookup"><span data-stu-id="8f837-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="8f837-147">Gestionnaire de raccordement de copie</span><span class="sxs-lookup"><span data-stu-id="8f837-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="8f837-148">Appelé lorsqu’un objet de dossier ou d’imprimante est sur le lieu d’être déplacé, copié, supprimé ou renommé.</span><span class="sxs-lookup"><span data-stu-id="8f837-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="8f837-149">Elle vous permet d’approuver ou de refuser l’opération.</span><span class="sxs-lookup"><span data-stu-id="8f837-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="8f837-150">Gestionnaire de glisser-déplacer</span><span class="sxs-lookup"><span data-stu-id="8f837-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="8f837-151">Appelé lorsqu’un fichier est glissé avec le bouton droit de la souris.</span><span class="sxs-lookup"><span data-stu-id="8f837-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="8f837-152">Elle vous permet de modifier le menu contextuel qui s’affiche.</span><span class="sxs-lookup"><span data-stu-id="8f837-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="8f837-153">Gestionnaire de superposition d’icône</span><span class="sxs-lookup"><span data-stu-id="8f837-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="8f837-154">Appelé avant l’affichage de l’icône d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="8f837-155">Elle vous permet de spécifier une superposition pour l’icône du fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="8f837-156">Gestionnaire de recherche</span><span class="sxs-lookup"><span data-stu-id="8f837-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="8f837-157">Appelé pour lancer un moteur de recherche.</span><span class="sxs-lookup"><span data-stu-id="8f837-157">Called to launch a search engine.</span></span> <span data-ttu-id="8f837-158">Elle vous permet d’implémenter un moteur de recherche personnalisé accessible à partir du menu **Démarrer** ou de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="8f837-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="8f837-159">Les détails sur la façon d’implémenter des gestionnaires d’extensions spécifiques sont traités dans les sections répertoriées ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="8f837-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="8f837-160">Le reste de ce document traite de certains problèmes d’implémentation qui sont communs à tous les gestionnaires d’extensions de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f837-160">The remainder of this document covers some implementation issues that are common to all Shell extension handlers.</span></span>

-   [<span data-ttu-id="8f837-161">Implémentation de gestionnaires d’extension de Shell</span><span class="sxs-lookup"><span data-stu-id="8f837-161">Implementing Shell Extension Handlers</span></span>](#implementing-shell-extension-handlers)
    -   [<span data-ttu-id="8f837-162">Implémentation de IPersistFile</span><span class="sxs-lookup"><span data-stu-id="8f837-162">Implementing IPersistFile</span></span>](#implementing-ipersistfile)
    -   [<span data-ttu-id="8f837-163">Implémentation de IShellExtInit</span><span class="sxs-lookup"><span data-stu-id="8f837-163">Implementing IShellExtInit</span></span>](#implementing-ishellextinit)
    -   [<span data-ttu-id="8f837-164">Personnalisation de l’info-bulle</span><span class="sxs-lookup"><span data-stu-id="8f837-164">Infotip Customization</span></span>](#infotip-customization)
-   [<span data-ttu-id="8f837-165">Amélioration de la recherche Windows avec les gestionnaires d’extensions de Shell</span><span class="sxs-lookup"><span data-stu-id="8f837-165">Enhancing Windows Search with Shell Extension Handlers</span></span>](#enhancing-windows-search-with-shell-extension-handlers)
-   [<span data-ttu-id="8f837-166">Inscription des gestionnaires d’extensions de Shell</span><span class="sxs-lookup"><span data-stu-id="8f837-166">Registering Shell Extension Handlers</span></span>](#registering-shell-extension-handlers)
    -   [<span data-ttu-id="8f837-167">Noms de gestionnaires</span><span class="sxs-lookup"><span data-stu-id="8f837-167">Handler Names</span></span>](#handler-names)
    -   [<span data-ttu-id="8f837-168">Objets Shell prédéfinis</span><span class="sxs-lookup"><span data-stu-id="8f837-168">Predefined Shell Objects</span></span>](#predefined-shell-objects)
    -   [<span data-ttu-id="8f837-169">Exemple d’inscription d’un gestionnaire d’extensions</span><span class="sxs-lookup"><span data-stu-id="8f837-169">Example of an Extension Handler Registration</span></span>](#example-of-an-extension-handler-registration)
-   [<span data-ttu-id="8f837-170">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8f837-170">Related topics</span></span>](#related-topics)

## <a name="implementing-shell-extension-handlers"></a><span data-ttu-id="8f837-171">Implémentation de gestionnaires d’extension de Shell</span><span class="sxs-lookup"><span data-stu-id="8f837-171">Implementing Shell Extension Handlers</span></span>

<span data-ttu-id="8f837-172">La majeure partie de l’implémentation d’un objet de gestionnaire d’extensions de Shell dépend de son type.</span><span class="sxs-lookup"><span data-stu-id="8f837-172">Much of the implementation of a Shell extension handler object depends on its type.</span></span> <span data-ttu-id="8f837-173">Toutefois, il existe des éléments communs.</span><span class="sxs-lookup"><span data-stu-id="8f837-173">There are, however, some common elements.</span></span> <span data-ttu-id="8f837-174">Cette section décrit les aspects de l’implémentation qui sont partagés par tous les gestionnaires d’extensions de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f837-174">This section discusses those aspects of implementation that are shared by all Shell extension handlers.</span></span>

<span data-ttu-id="8f837-175">De nombreux gestionnaires d’extension de Shell sont des objets COM (Component Object Model) in-process.</span><span class="sxs-lookup"><span data-stu-id="8f837-175">Many Shell extension handlers are in-process Component Object Model (COM) objects.</span></span> <span data-ttu-id="8f837-176">Ils doivent recevoir un GUID et être inscrits comme décrit dans inscription des gestionnaires d’extensions de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f837-176">They must be assigned a GUID and registered as described in Registering Shell Extension Handlers.</span></span> <span data-ttu-id="8f837-177">Elles sont implémentées en tant que dll et doivent exporter les fonctions standard suivantes :</span><span class="sxs-lookup"><span data-stu-id="8f837-177">They are implemented as DLLs and must export the following standard functions:</span></span>

-   <span data-ttu-id="8f837-178">[**DllMain**](../dlls/dllmain.md).</span><span class="sxs-lookup"><span data-stu-id="8f837-178">[**DllMain**](../dlls/dllmain.md).</span></span> <span data-ttu-id="8f837-179">Point d’entrée standard de la DLL.</span><span class="sxs-lookup"><span data-stu-id="8f837-179">The standard entry point to the DLL.</span></span>
-   <span data-ttu-id="8f837-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span><span class="sxs-lookup"><span data-stu-id="8f837-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span></span> <span data-ttu-id="8f837-181">Expose la fabrique de classe de l’objet.</span><span class="sxs-lookup"><span data-stu-id="8f837-181">Exposes the object's class factory.</span></span>
-   <span data-ttu-id="8f837-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span><span class="sxs-lookup"><span data-stu-id="8f837-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span></span> <span data-ttu-id="8f837-183">COM appelle cette fonction pour déterminer si l’objet dessert des clients.</span><span class="sxs-lookup"><span data-stu-id="8f837-183">COM calls this function to determine whether the object is serving any clients.</span></span> <span data-ttu-id="8f837-184">Si ce n’est pas le cas, le système peut décharger la DLL et libérer la mémoire associée.</span><span class="sxs-lookup"><span data-stu-id="8f837-184">If not, the system can unload the DLL and free the associated memory.</span></span>

<span data-ttu-id="8f837-185">Comme tous les objets COM, les gestionnaires d’extensions de Shell doivent implémenter une interface [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) et une [fabrique de classe](../com/implementing-iclassfactory.md).</span><span class="sxs-lookup"><span data-stu-id="8f837-185">Like all COM objects, Shell extension handlers must implement an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface and a [class factory](../com/implementing-iclassfactory.md).</span></span> <span data-ttu-id="8f837-186">La plupart des gestionnaires d’extensions doivent également implémenter une interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) ou [**ISHELLEXTINIT**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) dans Windows XP ou une version antérieure.</span><span class="sxs-lookup"><span data-stu-id="8f837-186">Most extension handlers must also implement either an [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface in Windows XP or earlier.</span></span> <span data-ttu-id="8f837-187">Ils ont été remplacés par [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) et [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) dans Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="8f837-187">These were replaced by [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) and [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) in Windows Vista.</span></span> <span data-ttu-id="8f837-188">L’interpréteur de commandes utilise ces interfaces pour initialiser le gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="8f837-188">The Shell uses these interfaces to initialize the handler.</span></span>

<span data-ttu-id="8f837-189">L’interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) doit être implémentée par les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="8f837-189">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="8f837-190">Gestionnaires de données</span><span class="sxs-lookup"><span data-stu-id="8f837-190">Data handlers</span></span>
-   <span data-ttu-id="8f837-191">Gestionnaires de suppression</span><span class="sxs-lookup"><span data-stu-id="8f837-191">Drop handlers</span></span>

<span data-ttu-id="8f837-192">Dans le passé, les gestionnaires d’icônes étaient également requis pour implémenter [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), mais ce n’est plus le cas.</span><span class="sxs-lookup"><span data-stu-id="8f837-192">In the past, icon handlers were also required to implement [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), but this is no longer true.</span></span> <span data-ttu-id="8f837-193">Pour les gestionnaires d’icônes, **IPersistFile** est maintenant facultatif et d’autres interfaces telles que [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) sont préférées.</span><span class="sxs-lookup"><span data-stu-id="8f837-193">For icon handlers, **IPersistFile** is now optional and other interfaces such as [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) are preferred.</span></span>

<span data-ttu-id="8f837-194">L’interface [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) doit être implémentée par les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="8f837-194">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="8f837-195">Gestionnaires de menus contextuels</span><span class="sxs-lookup"><span data-stu-id="8f837-195">Shortcut menu handlers</span></span>
-   <span data-ttu-id="8f837-196">Gestionnaires de glisser-déplacer</span><span class="sxs-lookup"><span data-stu-id="8f837-196">Drag-and-drop handlers</span></span>
-   <span data-ttu-id="8f837-197">Gestionnaires de feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="8f837-197">Property sheet handlers</span></span>

### <a name="implementing-ipersistfile"></a><span data-ttu-id="8f837-198">Implémentation de IPersistFile</span><span class="sxs-lookup"><span data-stu-id="8f837-198">Implementing IPersistFile</span></span>

<span data-ttu-id="8f837-199">L’interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) est conçue pour autoriser le chargement d’un objet à partir de ou son enregistrement dans un fichier sur disque.</span><span class="sxs-lookup"><span data-stu-id="8f837-199">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface is intended to permit an object to be loaded from or saved to a disk file.</span></span> <span data-ttu-id="8f837-200">Il a six méthodes en plus de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), cinq propres et la méthode [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) qu’il hérite de l’interface [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span><span class="sxs-lookup"><span data-stu-id="8f837-200">It has six methods in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), five of its own, and the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) method that it inherits from [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span></span> <span data-ttu-id="8f837-201">Avec les extensions de Shell, **IPersist** est utilisé uniquement pour initialiser un objet de gestionnaire d’extensions de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f837-201">With Shell extensions, **IPersist** is used only to initialize a Shell extension handler object.</span></span> <span data-ttu-id="8f837-202">Étant donné qu’il n’est généralement pas nécessaire de lire ou d’écrire sur le disque, seules les méthodes **GetClassID** et [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) requièrent une implémentation sans jeton.</span><span class="sxs-lookup"><span data-stu-id="8f837-202">Because there is typically no need to read from or write to the disk, only the **GetClassID** and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods require a nontoken implementation.</span></span>

<span data-ttu-id="8f837-203">L’interpréteur de commandes appelle d’abord [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) , et la fonction retourne l’identificateur de classe (CLSID) de l’objet de gestionnaire d’extensions.</span><span class="sxs-lookup"><span data-stu-id="8f837-203">The Shell calls [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) first, and the function returns the class identifier (CLSID) of the extension handler object.</span></span> <span data-ttu-id="8f837-204">L’interpréteur de commandes appelle ensuite la [**charge**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) et passe deux valeurs.</span><span class="sxs-lookup"><span data-stu-id="8f837-204">The Shell then calls [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) and passes in two values.</span></span> <span data-ttu-id="8f837-205">La première, *pszFileName*, est une chaîne Unicode avec le nom du fichier ou du dossier sur lequel l’interpréteur de commandes va fonctionner.</span><span class="sxs-lookup"><span data-stu-id="8f837-205">The first, *pszFileName*, is a Unicode string with the name of the file or folder that Shell is about to operate on.</span></span> <span data-ttu-id="8f837-206">Le deuxième est *dwMode*, qui indique le mode d’accès au fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-206">The second is *dwMode*, which indicates the file access mode.</span></span> <span data-ttu-id="8f837-207">Étant donné qu’il n’est généralement pas nécessaire d’accéder aux fichiers, *dwMode* est généralement égal à zéro.</span><span class="sxs-lookup"><span data-stu-id="8f837-207">Because there is typically no need to access files, *dwMode* is usually zero.</span></span> <span data-ttu-id="8f837-208">La méthode stocke ces valeurs en fonction des besoins pour une référence ultérieure.</span><span class="sxs-lookup"><span data-stu-id="8f837-208">The method stores these values as needed for later reference.</span></span>

<span data-ttu-id="8f837-209">Le fragment de code suivant illustre la façon dont un gestionnaire d’extensions de Shell standard implémente les méthodes [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) et [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) .</span><span class="sxs-lookup"><span data-stu-id="8f837-209">The following code fragment illustrates how a typical Shell extension handler implements the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods.</span></span> <span data-ttu-id="8f837-210">Il est conçu pour gérer ANSI ou Unicode.</span><span class="sxs-lookup"><span data-stu-id="8f837-210">It is designed to handle either ANSI or Unicode.</span></span> <span data-ttu-id="8f837-211">CLSID \_ SampleExtHandler est le GUID de l’objet de gestionnaire d’extensions et CSampleExtHandler est le nom de la classe utilisée pour implémenter l’interface.</span><span class="sxs-lookup"><span data-stu-id="8f837-211">CLSID\_SampleExtHandler is the extension handler object's GUID, and CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="8f837-212">Les variables **m \_ szFileName** et **m \_ dwMode** sont des variables privées utilisées pour stocker le nom et les indicateurs d’accès du fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-212">The **m\_szFileName** and **m\_dwMode** variables are private variables that are used to store the file's name and access flags.</span></span>


```C++
wchar_t m_szFileName[MAX_PATH];    // The file name
DWORD m_dwMode;                  // The file access mode

CSampleExtHandler::GetClassID(CLSID *pCLSID)
{
    *pCLSID = CLSID_SampleExtHandler;
}

CSampleExtHandler::Load(PCWSTR pszFile, DWORD dwMode)
{
    m_dwMode = dwMode;
    return StringCchCopy(_szFileName, ARRAYSIZE(m_szFileName), pszFile);
}
```

### <a name="implementing-ishellextinit"></a><span data-ttu-id="8f837-213">Implémentation de IShellExtInit</span><span class="sxs-lookup"><span data-stu-id="8f837-213">Implementing IShellExtInit</span></span>

<span data-ttu-id="8f837-214">L’interface [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) n’a qu’une seule méthode, [**IShellExtInit :: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), en plus de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="8f837-214">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface has only one method, [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="8f837-215">La méthode a trois paramètres que l’interpréteur de commandes peut utiliser pour passer divers types d’informations.</span><span class="sxs-lookup"><span data-stu-id="8f837-215">The method has three parameters that the Shell can use to pass in various types of information.</span></span> <span data-ttu-id="8f837-216">Les valeurs transmises dépendent du type de gestionnaire, tandis que d’autres peuvent avoir la valeur **null**.</span><span class="sxs-lookup"><span data-stu-id="8f837-216">The values passed in depend on the type of handler, and some can be set to **NULL**.</span></span>

-   <span data-ttu-id="8f837-217">*pIDFolder* contient le pointeur d’un dossier vers une liste d’identificateurs d’éléments (PIDL).</span><span class="sxs-lookup"><span data-stu-id="8f837-217">*pIDFolder* holds a folder's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="8f837-218">Pour les extensions de feuille de propriétés, la **valeur est null**.</span><span class="sxs-lookup"><span data-stu-id="8f837-218">For property sheet extensions, it is **NULL**.</span></span> <span data-ttu-id="8f837-219">Pour les extensions de menu contextuel, il s’agit de l’PIDL du dossier qui contient l’élément dont le menu contextuel est affiché.</span><span class="sxs-lookup"><span data-stu-id="8f837-219">For shortcut menu extensions, it is the PIDL of the folder that contains the item whose shortcut menu is being displayed.</span></span> <span data-ttu-id="8f837-220">Pour les gestionnaires de glisser-déplacer non par défaut, il s’agit de l’PIDL du dossier cible.</span><span class="sxs-lookup"><span data-stu-id="8f837-220">For nondefault drag-and-drop handlers, it is the PIDL of the target folder.</span></span>
-   <span data-ttu-id="8f837-221">*pDataObject* contient un pointeur vers l’interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) d’un objet de données.</span><span class="sxs-lookup"><span data-stu-id="8f837-221">*pDataObject* holds a pointer to a data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="8f837-222">L’objet de données contient un ou plusieurs noms de fichiers au format [CF \_ HDROP](dragdrop.md) .</span><span class="sxs-lookup"><span data-stu-id="8f837-222">The data object holds one or more file names in [CF\_HDROP](dragdrop.md) format.</span></span>
-   <span data-ttu-id="8f837-223">*hRegKey* contient une clé de Registre pour l’objet de fichier ou le type de dossier.</span><span class="sxs-lookup"><span data-stu-id="8f837-223">*hRegKey* holds a registry key for the file object or folder type.</span></span>

<span data-ttu-id="8f837-224">La méthode [**IShellExtInit :: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) stocke le nom de fichier, le pointeur [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) et la clé de Registre nécessaires pour une utilisation ultérieure.</span><span class="sxs-lookup"><span data-stu-id="8f837-224">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method stores the file name, [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer, and registry key as needed for later use.</span></span> <span data-ttu-id="8f837-225">Le fragment de code suivant illustre une implémentation de **IShellExtInit :: Initialize**.</span><span class="sxs-lookup"><span data-stu-id="8f837-225">The following code fragment illustrates an implementation of **IShellExtInit::Initialize**.</span></span> <span data-ttu-id="8f837-226">Pour plus de simplicité, cet exemple suppose que l’objet de données ne contient qu’un seul fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-226">For simplicity, this example assumes that the data object contains only a single file.</span></span> <span data-ttu-id="8f837-227">En général, il peut contenir plusieurs fichiers qui devront être extraits.</span><span class="sxs-lookup"><span data-stu-id="8f837-227">In general, it might contain multiple files that will each need to be extracted.</span></span>


```C++
LPCITEMIDLIST  m_pIDFolder;           //The folder's PIDL
wchar_t        m_szFile[MAX_PATH];    //The file name
IDataObject   *m_pDataObj;            //The IDataObject pointer
HKEY           m_hRegKey;             //The file or folder's registry key

STDMETHODIMP CShellExt::Initialize(LPCITEMIDLIST pIDFolder, 
                                   IDataObject *pDataObj, 
                                   HKEY hRegKey) 
{ 
    // If Initialize has already been called, release the old PIDL
    ILFree(m_pIDFolder);
    m_pIDFolder = nullptr;

    // Store the new PIDL.
    if (pIDFolder)
    {
        m_pIDFolder = ILClone(pIDFolder);
    }
    
    // If Initialize has already been called, release the old
    // IDataObject pointer.
    if (m_pDataObj)
    { 
        m_pDataObj->Release(); 
    }
     
    // If a data object pointer was passed in, save it and
    // extract the file name. 
    if (pDataObj) 
    { 
        m_pDataObj = pDataObj; 
        pDataObj->AddRef(); 
      
        STGMEDIUM   medium;
        FORMATETC   fe = {CF_HDROP, NULL, DVASPECT_CONTENT, -1, TYMED_HGLOBAL};
        UINT        uCount;

        if (SUCCEEDED(m_pDataObj->GetData(&fe, &medium)))
        {
            // Get the count of files dropped.
            uCount = DragQueryFile((HDROP)medium.hGlobal, (UINT)-1, NULL, 0);

            // Get the first file name from the CF_HDROP.
            if (uCount)
                DragQueryFile((HDROP)medium.hGlobal, 0, m_szFile, 
                              sizeof(m_szFile)/sizeof(TCHAR));

            ReleaseStgMedium(&medium);
        }
    }

    // Duplicate the registry handle. 
    if (hRegKey) 
        RegOpenKeyEx(hRegKey, nullptr, 0L, MAXIMUM_ALLOWED, &m_hRegKey); 
    return S_OK; 
}
```

<span data-ttu-id="8f837-228">CSampleExtHandler est le nom de la classe utilisée pour implémenter l’interface.</span><span class="sxs-lookup"><span data-stu-id="8f837-228">CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="8f837-229">Les **variables \_ m pIDFolder**, **m \_ pDataObject**, **m \_ szFileName** et **m \_ hRegKey** sont des variables privées utilisées pour stocker les informations transmises.</span><span class="sxs-lookup"><span data-stu-id="8f837-229">The **m\_pIDFolder**, **m\_pDataObject**, **m\_szFileName**, and **m\_hRegKey** variables are private variables used to store the information that is passed in.</span></span> <span data-ttu-id="8f837-230">Par souci de simplicité, cet exemple suppose qu’un seul nom de fichier sera détenu par l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="8f837-230">For simplicity, this example assumes that only one file name will be held by the data object.</span></span> <span data-ttu-id="8f837-231">Une fois que la structure [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) est Récupérée de l’objet de données, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) est utilisé pour extraire le nom de fichier du membre **Medium. hGlobal** de la structure **FORMATETC** .</span><span class="sxs-lookup"><span data-stu-id="8f837-231">After the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure is retrieved from the data object, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) is used to extract the file name from the **FORMATETC** structure's **medium.hGlobal** member.</span></span> <span data-ttu-id="8f837-232">Si une clé de Registre est passée, la méthode utilise [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) pour ouvrir la clé et assigne le handle à **m \_ hRegKey**.</span><span class="sxs-lookup"><span data-stu-id="8f837-232">If a registry key is passed in, the method uses [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) to open the key and assigns the handle to **m\_hRegKey**.</span></span>

### <a name="infotip-customization"></a><span data-ttu-id="8f837-233">Personnalisation de l’info-bulle</span><span class="sxs-lookup"><span data-stu-id="8f837-233">Infotip Customization</span></span>

<span data-ttu-id="8f837-234">Il existe deux façons de personnaliser info-bulles :</span><span class="sxs-lookup"><span data-stu-id="8f837-234">There are two ways to customize infotips:</span></span>

-   <span data-ttu-id="8f837-235">Implémentez un objet qui prend en charge [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) , puis inscrivez cet objet sous la sous-clé appropriée du Registre (consultez [inscription des gestionnaires d’extensions de Shell](#registering-shell-extension-handlers) ci-dessous).</span><span class="sxs-lookup"><span data-stu-id="8f837-235">Implement an object that supports [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) and then register that object under the proper subkey in the registry (see [Registering Shell Extension Handlers](#registering-shell-extension-handlers) below).</span></span>
-   <span data-ttu-id="8f837-236">Spécifiez une chaîne fixe ou une liste de propriétés de fichier spécifiques à afficher.</span><span class="sxs-lookup"><span data-stu-id="8f837-236">Specify a fixed string or a list of specific file properties to be displayed.</span></span>

<span data-ttu-id="8f837-237">Pour afficher une chaîne fixe pour une extension d’espace de noms, créez une entrée appelée `InfoTip` dans la clé *{CLSID}* de votre extension d’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="8f837-237">To display a fixed string for a namespace extension, create an entry called `InfoTip` in the *{CLSID}* key of your namespace extension.</span></span> <span data-ttu-id="8f837-238">Définissez la valeur de cette entrée de sorte qu’elle soit la chaîne littérale que vous souhaitez afficher, comme illustré dans cet exemple, ou une chaîne indirecte qui spécifie une ressource et un index dans cette ressource (à des fins de localisation).</span><span class="sxs-lookup"><span data-stu-id="8f837-238">Set the value of that entry to be either the literal string you want to display, as shown in this example, or an indirect string that specifies a resource and index within that resource (for localization purposes).</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {CLSID}
         InfoTip = InfoTip string for your namespace extension
```

<span data-ttu-id="8f837-239">Pour afficher une chaîne fixe pour un type de fichier, créez une entrée appelée `InfoTip` dans la clé *ProgID* de ce type de fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-239">To display a fixed string for a file type, create an entry called `InfoTip` in the *ProgID* key of that file type.</span></span> <span data-ttu-id="8f837-240">Définissez la valeur de cette entrée sur la chaîne littérale que vous souhaitez afficher ou sur une chaîne indirecte qui spécifie une ressource et un index au sein de cette ressource (à des fins de localisation), comme illustré dans cet exemple.</span><span class="sxs-lookup"><span data-stu-id="8f837-240">Set the value of that entry to be either the literal string you want to display or an indirect string that specifies a resource and index within that resource (for localization purposes), as shown in this example.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = Resource.dll, 3
```

<span data-ttu-id="8f837-241">Si vous souhaitez que l’interpréteur de commandes affiche des propriétés de fichier spécifiques dans l’info-bulle pour un type de fichier spécifique, créez une entrée appelée `InfoTip` dans la clé *ProgID* pour ce type de fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-241">If you want the Shell to display specific file properties in the infotip for a specific file type, create an entry called `InfoTip` in the *ProgID* key for that file type.</span></span> <span data-ttu-id="8f837-242">Définissez la valeur de cette entrée sur une liste délimitée par des points-virgules de noms de propriétés canoniques, d’identificateurs de format (FMTID) de paires d’identificateurs (PID)/Property, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="8f837-242">Set the value of that entry to be a semicolon-delineated list of canonical property names, format identifier (FMTID)/property identifier (PID) pairs, or both.</span></span> <span data-ttu-id="8f837-243">Cette valeur doit commencer par « prop : » pour l’identifier en tant que chaîne de liste de propriétés.</span><span class="sxs-lookup"><span data-stu-id="8f837-243">This value must begin with "prop:" to identify it as a property list string.</span></span> <span data-ttu-id="8f837-244">Si vous omettez « prop : », la valeur est considérée comme une chaîne littérale et affichée comme telle.</span><span class="sxs-lookup"><span data-stu-id="8f837-244">If you omit "prop:", the value is seen as a literal string and displayed as such.</span></span>

<span data-ttu-id="8f837-245">Dans l’exemple suivant, *propName* est un nom de propriété canonique (tel que System. date) et *{fmtid}, PID* est une paire [**fmtid/PID**](./objects.md) .</span><span class="sxs-lookup"><span data-stu-id="8f837-245">In the following example, *propname* is a canonical property name (such as System.Date) and *{fmtid},pid* is an [**FMTID/PID**](./objects.md) pair.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = prop:propname;propname;{fmtid},pid;{fmtid},pid
```

<span data-ttu-id="8f837-246">Les noms de propriétés suivants peuvent être utilisés :</span><span class="sxs-lookup"><span data-stu-id="8f837-246">The following property names can be used:</span></span>



| <span data-ttu-id="8f837-247">Nom de la propriété</span><span class="sxs-lookup"><span data-stu-id="8f837-247">Property Name</span></span>    | <span data-ttu-id="8f837-248">Description</span><span class="sxs-lookup"><span data-stu-id="8f837-248">Description</span></span>                   | <span data-ttu-id="8f837-249">Récupéré à partir de</span><span class="sxs-lookup"><span data-stu-id="8f837-249">Retrieved From</span></span>                                                                             |
|------------------|-------------------------------|--------------------------------------------------------------------------------------------|
| <span data-ttu-id="8f837-250">Auteur</span><span class="sxs-lookup"><span data-stu-id="8f837-250">Author</span></span>           | <span data-ttu-id="8f837-251">Auteur du document</span><span class="sxs-lookup"><span data-stu-id="8f837-251">Author of the document</span></span>        | [<span data-ttu-id="8f837-252">**\_auteur PIDSI**</span><span class="sxs-lookup"><span data-stu-id="8f837-252">**PIDSI\_AUTHOR**</span></span>](../stg/the-summary-information-property-set.md)                              |
| <span data-ttu-id="8f837-253">Intitulé</span><span class="sxs-lookup"><span data-stu-id="8f837-253">Title</span></span>            | <span data-ttu-id="8f837-254">Titre du document</span><span class="sxs-lookup"><span data-stu-id="8f837-254">Title of the document</span></span>         | [<span data-ttu-id="8f837-255">**\_titre PIDSI**</span><span class="sxs-lookup"><span data-stu-id="8f837-255">**PIDSI\_TITLE**</span></span>](../stg/the-summary-information-property-set.md)                               |
| <span data-ttu-id="8f837-256">Objet</span><span class="sxs-lookup"><span data-stu-id="8f837-256">Subject</span></span>          | <span data-ttu-id="8f837-257">Résumé de l’objet</span><span class="sxs-lookup"><span data-stu-id="8f837-257">Subject summary</span></span>               | [<span data-ttu-id="8f837-258">**PIDSI \_ objet**</span><span class="sxs-lookup"><span data-stu-id="8f837-258">**PIDSI\_SUBJECT**</span></span>](../stg/the-summary-information-property-set.md)                             |
| <span data-ttu-id="8f837-259">Commentaire</span><span class="sxs-lookup"><span data-stu-id="8f837-259">Comment</span></span>          | <span data-ttu-id="8f837-260">Commentaires sur le document</span><span class="sxs-lookup"><span data-stu-id="8f837-260">Document comments</span></span>             | <span data-ttu-id="8f837-261">[**PIDSI \_**](../stg/the-summary-information-property-set.md) Propriétés d’un commentaire ou d’un dossier/pilote</span><span class="sxs-lookup"><span data-stu-id="8f837-261">[**PIDSI\_COMMENT**](../stg/the-summary-information-property-set.md) or folder/driver properties</span></span> |
| <span data-ttu-id="8f837-262">PageCount</span><span class="sxs-lookup"><span data-stu-id="8f837-262">PageCount</span></span>        | <span data-ttu-id="8f837-263">Nombre de pages</span><span class="sxs-lookup"><span data-stu-id="8f837-263">Number of pages</span></span>               | [<span data-ttu-id="8f837-264">**PIDSI \_ PageCount**</span><span class="sxs-lookup"><span data-stu-id="8f837-264">**PIDSI\_PAGECOUNT**</span></span>](../stg/the-summary-information-property-set.md)                           |
| <span data-ttu-id="8f837-265">Nom</span><span class="sxs-lookup"><span data-stu-id="8f837-265">Name</span></span>             | <span data-ttu-id="8f837-266">Nom convivial</span><span class="sxs-lookup"><span data-stu-id="8f837-266">Friendly name</span></span>                 | <span data-ttu-id="8f837-267">Affichage des dossiers standard</span><span class="sxs-lookup"><span data-stu-id="8f837-267">Standard folder view</span></span>                                                                       |
| <span data-ttu-id="8f837-268">OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="8f837-268">OriginalLocation</span></span> | <span data-ttu-id="8f837-269">Emplacement du fichier d’origine</span><span class="sxs-lookup"><span data-stu-id="8f837-269">Location of original file</span></span>     | <span data-ttu-id="8f837-270">Dossier porte-documents et dossier Corbeille</span><span class="sxs-lookup"><span data-stu-id="8f837-270">Briefcase folder and Recycle Bin folder</span></span>                                                    |
| <span data-ttu-id="8f837-271">DateDeleted</span><span class="sxs-lookup"><span data-stu-id="8f837-271">DateDeleted</span></span>      | <span data-ttu-id="8f837-272">Date de suppression du fichier</span><span class="sxs-lookup"><span data-stu-id="8f837-272">Date file was deleted</span></span>         | <span data-ttu-id="8f837-273">Dossier Corbeille</span><span class="sxs-lookup"><span data-stu-id="8f837-273">Recycle Bin folder</span></span>                                                                         |
| <span data-ttu-id="8f837-274">Type</span><span class="sxs-lookup"><span data-stu-id="8f837-274">Type</span></span>             | <span data-ttu-id="8f837-275">Type de fichier</span><span class="sxs-lookup"><span data-stu-id="8f837-275">Type of file</span></span>                  | <span data-ttu-id="8f837-276">Mode Détails du dossier standard</span><span class="sxs-lookup"><span data-stu-id="8f837-276">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8f837-277">Taille</span><span class="sxs-lookup"><span data-stu-id="8f837-277">Size</span></span>             | <span data-ttu-id="8f837-278">Taille du fichier</span><span class="sxs-lookup"><span data-stu-id="8f837-278">Size of file</span></span>                  | <span data-ttu-id="8f837-279">Mode Détails du dossier standard</span><span class="sxs-lookup"><span data-stu-id="8f837-279">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8f837-280">SyncCopyIn</span><span class="sxs-lookup"><span data-stu-id="8f837-280">SyncCopyIn</span></span>       | <span data-ttu-id="8f837-281">Identique à OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="8f837-281">Same as OriginalLocation</span></span>      | <span data-ttu-id="8f837-282">Identique à OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="8f837-282">Same as OriginalLocation</span></span>                                                                   |
| <span data-ttu-id="8f837-283">Modifié le</span><span class="sxs-lookup"><span data-stu-id="8f837-283">Modified</span></span>         | <span data-ttu-id="8f837-284">Date de dernière modification</span><span class="sxs-lookup"><span data-stu-id="8f837-284">Date last modified</span></span>            | <span data-ttu-id="8f837-285">Mode Détails du dossier standard</span><span class="sxs-lookup"><span data-stu-id="8f837-285">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8f837-286">Date de création</span><span class="sxs-lookup"><span data-stu-id="8f837-286">Created</span></span>          | <span data-ttu-id="8f837-287">Date de création</span><span class="sxs-lookup"><span data-stu-id="8f837-287">Date created</span></span>                  | <span data-ttu-id="8f837-288">Mode Détails du dossier standard</span><span class="sxs-lookup"><span data-stu-id="8f837-288">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8f837-289">Atteint</span><span class="sxs-lookup"><span data-stu-id="8f837-289">Accessed</span></span>         | <span data-ttu-id="8f837-290">Date du dernier accès</span><span class="sxs-lookup"><span data-stu-id="8f837-290">Date last accessed</span></span>            | <span data-ttu-id="8f837-291">Mode Détails du dossier standard</span><span class="sxs-lookup"><span data-stu-id="8f837-291">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8f837-292">Indossier</span><span class="sxs-lookup"><span data-stu-id="8f837-292">InFolder</span></span>         | <span data-ttu-id="8f837-293">Répertoire contenant le fichier</span><span class="sxs-lookup"><span data-stu-id="8f837-293">Directory containing the file</span></span> | <span data-ttu-id="8f837-294">Résultats de la recherche de documents</span><span class="sxs-lookup"><span data-stu-id="8f837-294">Document search results</span></span>                                                                    |
| <span data-ttu-id="8f837-295">Rank</span><span class="sxs-lookup"><span data-stu-id="8f837-295">Rank</span></span>             | <span data-ttu-id="8f837-296">Qualité de la recherche de correspondance</span><span class="sxs-lookup"><span data-stu-id="8f837-296">Quality of search match</span></span>       | <span data-ttu-id="8f837-297">Résultats de la recherche de documents</span><span class="sxs-lookup"><span data-stu-id="8f837-297">Document search results</span></span>                                                                    |
| <span data-ttu-id="8f837-298">FreeSpace</span><span class="sxs-lookup"><span data-stu-id="8f837-298">FreeSpace</span></span>        | <span data-ttu-id="8f837-299">Espace de stockage disponible</span><span class="sxs-lookup"><span data-stu-id="8f837-299">Available storage space</span></span>       | <span data-ttu-id="8f837-300">Lecteurs de disque</span><span class="sxs-lookup"><span data-stu-id="8f837-300">Disk drives</span></span>                                                                                |
| <span data-ttu-id="8f837-301">NumberOfVisits</span><span class="sxs-lookup"><span data-stu-id="8f837-301">NumberOfVisits</span></span>   | <span data-ttu-id="8f837-302">Nombre de visites</span><span class="sxs-lookup"><span data-stu-id="8f837-302">Number of visits</span></span>              | <span data-ttu-id="8f837-303">Dossier Favoris</span><span class="sxs-lookup"><span data-stu-id="8f837-303">Favorites folder</span></span>                                                                           |
| <span data-ttu-id="8f837-304">Attributs</span><span class="sxs-lookup"><span data-stu-id="8f837-304">Attributes</span></span>       | <span data-ttu-id="8f837-305">Attributs de fichier</span><span class="sxs-lookup"><span data-stu-id="8f837-305">File Attributes</span></span>               | <span data-ttu-id="8f837-306">Mode Détails du dossier standard</span><span class="sxs-lookup"><span data-stu-id="8f837-306">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8f837-307">Company</span><span class="sxs-lookup"><span data-stu-id="8f837-307">Company</span></span>          | <span data-ttu-id="8f837-308">Nom de la société</span><span class="sxs-lookup"><span data-stu-id="8f837-308">Company name</span></span>                  | [<span data-ttu-id="8f837-309">**\_entreprise PIDDSI**</span><span class="sxs-lookup"><span data-stu-id="8f837-309">**PIDDSI\_COMPANY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)    |
| <span data-ttu-id="8f837-310">Category</span><span class="sxs-lookup"><span data-stu-id="8f837-310">Category</span></span>         | <span data-ttu-id="8f837-311">Catégorie de document</span><span class="sxs-lookup"><span data-stu-id="8f837-311">Document category</span></span>             | [<span data-ttu-id="8f837-312">**\_catégorie PIDDSI**</span><span class="sxs-lookup"><span data-stu-id="8f837-312">**PIDDSI\_CATEGORY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)   |
| <span data-ttu-id="8f837-313">copyright</span><span class="sxs-lookup"><span data-stu-id="8f837-313">Copyright</span></span>        | <span data-ttu-id="8f837-314">Copyright du support</span><span class="sxs-lookup"><span data-stu-id="8f837-314">Media copyright</span></span>               | [<span data-ttu-id="8f837-315">**\_Copyright PIDMSI**</span><span class="sxs-lookup"><span data-stu-id="8f837-315">**PIDMSI\_COPYRIGHT**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)  |
| <span data-ttu-id="8f837-316">HTMLInfoTipFile</span><span class="sxs-lookup"><span data-stu-id="8f837-316">HTMLInfoTipFile</span></span>  | <span data-ttu-id="8f837-317">Fichier info-bulle HTML</span><span class="sxs-lookup"><span data-stu-id="8f837-317">HTML InfoTip file</span></span>             | <span data-ttu-id="8f837-318">Fichier Desktop.ini pour le dossier</span><span class="sxs-lookup"><span data-stu-id="8f837-318">Desktop.ini file for folder</span></span>                                                                |



 

## <a name="enhancing-windows-search-with-shell-extension-handlers"></a><span data-ttu-id="8f837-319">Amélioration de la recherche Windows avec les gestionnaires d’extensions de Shell</span><span class="sxs-lookup"><span data-stu-id="8f837-319">Enhancing Windows Search with Shell Extension Handlers</span></span>

<span data-ttu-id="8f837-320">Les gestionnaires d’extensions de Shell peuvent être utilisés pour améliorer l’expérience utilisateur fournie par un gestionnaire de protocole de recherche Windows.</span><span class="sxs-lookup"><span data-stu-id="8f837-320">Shell extension handlers may be used to enhance the user experience provided by a Windows Search protocol handler.</span></span> <span data-ttu-id="8f837-321">Pour activer ces améliorations, le gestionnaire d’extensions de Shell de prise en charge doit être conçu pour s’intégrer au gestionnaire de protocole de recherche comme source de données.</span><span class="sxs-lookup"><span data-stu-id="8f837-321">To enable such enhancements, the supporting Shell extension handler must be designed to integrate with the search protocol handler as a data source.</span></span> <span data-ttu-id="8f837-322">Pour plus d’informations sur la façon d’améliorer un gestionnaire de protocole de recherche Windows par le biais de l’intégration à un gestionnaire d’extensions de Shell, consultez [Ajout d’icônes, d’aperçus et de menus contextuels](../search/-search-3x-wds-ph-ui-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="8f837-322">For information about how to enhance a Windows Search protocol handler through integration with a Shell extension handler, see [Adding Icons, Previews and Shortcut Menus](../search/-search-3x-wds-ph-ui-extensions.md).</span></span> <span data-ttu-id="8f837-323">Pour plus d’informations sur les gestionnaires de protocole de recherche Windows, consultez [développement de gestionnaires de protocole](../search/-search-3x-wds-phaddins.md).</span><span class="sxs-lookup"><span data-stu-id="8f837-323">For more information about Windows Search protocol handlers, see [Developing Protocol Handlers](../search/-search-3x-wds-phaddins.md).</span></span>

## <a name="registering-shell-extension-handlers"></a><span data-ttu-id="8f837-324">Inscription des gestionnaires d’extensions de Shell</span><span class="sxs-lookup"><span data-stu-id="8f837-324">Registering Shell Extension Handlers</span></span>

<span data-ttu-id="8f837-325">Un objet de gestionnaire d’extensions d’interpréteur de commandes doit être inscrit pour que l’interpréteur de commandes puisse l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="8f837-325">A Shell extension handler object must be registered before the Shell can use it.</span></span> <span data-ttu-id="8f837-326">Cette section est une discussion générale sur l’enregistrement d’un gestionnaire d’extensions de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f837-326">This section is a general discussion of how to register a Shell extension handler.</span></span>

<span data-ttu-id="8f837-327">Chaque fois que vous créez ou modifiez un gestionnaire d’extensions de Shell, il est important d’informer le système que vous avez apporté une modification à [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), en spécifiant l’événement **\_ ASSOCCHANGED SHCNE** .</span><span class="sxs-lookup"><span data-stu-id="8f837-327">Any time you create or change a Shell extension handler, it is important to notify the system that you have made a change with [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), specifying the **SHCNE\_ASSOCCHANGED** event.</span></span> <span data-ttu-id="8f837-328">Si vous n’appelez pas **SHChangeNotify**, la modification peut ne pas être reconnue tant que le système n’est pas redémarré.</span><span class="sxs-lookup"><span data-stu-id="8f837-328">If you do not call **SHChangeNotify**, the change might not be recognized until the system is rebooted.</span></span>

<span data-ttu-id="8f837-329">Comme avec tous les objets COM, vous devez créer un GUID pour le gestionnaire à l’aide d’un outil tel que UUIDGEN.exe.</span><span class="sxs-lookup"><span data-stu-id="8f837-329">As with all COM objects, you must create a GUID for the handler using a tool such as UUIDGEN.exe.</span></span> <span data-ttu-id="8f837-330">Créez une clé sous le CLSID **\_ \_ racine des classes HKEY** dont le \\  nom est le format de chaîne du GUID.</span><span class="sxs-lookup"><span data-stu-id="8f837-330">Create a key under **HKEY\_CLASSES\_ROOT**\\**CLSID** whose name is the string form of the GUID.</span></span> <span data-ttu-id="8f837-331">Étant donné que les gestionnaires d’extensions de Shell sont des serveurs in-process, vous devez créer une clé **InprocServer32** sous la clé GUID avec la valeur par défaut définie sur le chemin d’accès de la dll du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="8f837-331">Because Shell extension handlers are in-process servers, you must create an **InProcServer32** key under the GUID key with the default value set to the path of the handler's DLL.</span></span> <span data-ttu-id="8f837-332">Utilisez le modèle de thread cloisonné.</span><span class="sxs-lookup"><span data-stu-id="8f837-332">Use the Apartment threading model.</span></span>

<span data-ttu-id="8f837-333">Chaque fois que l’interpréteur de commandes prend une mesure qui peut impliquer un gestionnaire d’extensions de Shell, il vérifie la clé de registre appropriée.</span><span class="sxs-lookup"><span data-stu-id="8f837-333">Any time the Shell takes an action that can involve a Shell extension handler, it checks the appropriate registry key.</span></span> <span data-ttu-id="8f837-334">La clé sous laquelle un gestionnaire d’extensions est inscrit, contrôle le moment où il sera appelé.</span><span class="sxs-lookup"><span data-stu-id="8f837-334">The key under which an extension handler is registered thus controls when it will be called.</span></span> <span data-ttu-id="8f837-335">Par exemple, il est courant d’avoir un gestionnaire de menu contextuel appelé lorsque l’interpréteur de commandes affiche un menu contextuel pour un membre d’un [type de fichier](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="8f837-335">For instance, it is a common practice to have a shortcut menu handler called when the Shell displays a shortcut menu for a member of a [file type](fa-file-types.md).</span></span> <span data-ttu-id="8f837-336">Dans ce cas, le gestionnaire doit être inscrit sous la clé **ProgID** du type de fichier.</span><span class="sxs-lookup"><span data-stu-id="8f837-336">In this case, the handler must be registered under the file type's **ProgID** key.</span></span>

### <a name="handler-names"></a><span data-ttu-id="8f837-337">Noms de gestionnaires</span><span class="sxs-lookup"><span data-stu-id="8f837-337">Handler Names</span></span>

<span data-ttu-id="8f837-338">Pour activer un gestionnaire d’extensions de Shell, créez une sous-clé avec le nom de la sous-clé du gestionnaire (voir ci-dessous) sous la sous-clé **shellex** du **ProgID** (pour les types de fichiers) ou du nom du type d’objet Shell (pour les [objets Shell prédéfinis](#predefined-shell-objects)).</span><span class="sxs-lookup"><span data-stu-id="8f837-338">To enable a Shell extension handler, create a subkey with the handler subkey name (see below) under the **ShellEx** subkey of either the **ProgID** (for file types) or the Shell object type name (for [Predefined Shell Objects](#predefined-shell-objects)).</span></span>

<span data-ttu-id="8f837-339">Par exemple, si vous souhaitez inscrire un gestionnaire d’extension de menu contextuel pour MyProgram. 1, vous devez commencer par créer la sous-clé suivante :</span><span class="sxs-lookup"><span data-stu-id="8f837-339">For example, if you wanted to register a shortcut menu extension handler for MyProgram.1, you would begin by creating the following subkey:</span></span>

```
HKEY_CLASSES_ROOT
   MyProgram.1
      ShellEx
         ContextMenuHandlers
```

<span data-ttu-id="8f837-340">Pour les gestionnaires suivants, créez une sous-clé sous la clé « nom de la sous-clé du gestionnaire » dont le nom est la version de chaîne du CLSID de l’extension de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f837-340">For the following handlers, create a subkey underneath the "Handler Subkey name" key whose name is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="8f837-341">Plusieurs extensions peuvent être inscrites sous la clé de nom de la sous-clé du gestionnaire en créant plusieurs sous-clés.</span><span class="sxs-lookup"><span data-stu-id="8f837-341">Multiple extensions can be registered under the handler subkey name key by creating multiple subkeys.</span></span>



| <span data-ttu-id="8f837-342">Handler</span><span class="sxs-lookup"><span data-stu-id="8f837-342">Handler</span></span>                                               | <span data-ttu-id="8f837-343">Interface</span><span class="sxs-lookup"><span data-stu-id="8f837-343">Interface</span></span>          | <span data-ttu-id="8f837-344">Nom de la sous-clé du gestionnaire</span><span class="sxs-lookup"><span data-stu-id="8f837-344">Handler Subkey Name</span></span>       |
|-------------------------------------------------------|--------------------|---------------------------|
| <span data-ttu-id="8f837-345">Gestionnaire de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="8f837-345">Shortcut menu handler</span></span>                                 | <span data-ttu-id="8f837-346">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="8f837-346">IContextMenu</span></span>       | <span data-ttu-id="8f837-347">**ContextMenuHandlers**</span><span class="sxs-lookup"><span data-stu-id="8f837-347">**ContextMenuHandlers**</span></span>   |
| <span data-ttu-id="8f837-348">Gestionnaire CopyHook</span><span class="sxs-lookup"><span data-stu-id="8f837-348">Copyhook handler</span></span>                                      | <span data-ttu-id="8f837-349">ICopyHook</span><span class="sxs-lookup"><span data-stu-id="8f837-349">ICopyHook</span></span>          | <span data-ttu-id="8f837-350">**CopyHookHandlers**</span><span class="sxs-lookup"><span data-stu-id="8f837-350">**CopyHookHandlers**</span></span>      |
| <span data-ttu-id="8f837-351">Gestionnaire de glisser-déplacer</span><span class="sxs-lookup"><span data-stu-id="8f837-351">Drag-and-drop handler</span></span>                                 | <span data-ttu-id="8f837-352">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="8f837-352">IContextMenu</span></span>       | <span data-ttu-id="8f837-353">**DragDropHandlers**</span><span class="sxs-lookup"><span data-stu-id="8f837-353">**DragDropHandlers**</span></span>      |
| <span data-ttu-id="8f837-354">Gestionnaire de feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="8f837-354">Property sheet handler</span></span>                                | <span data-ttu-id="8f837-355">IShellPropSheetExt</span><span class="sxs-lookup"><span data-stu-id="8f837-355">IShellPropSheetExt</span></span> | <span data-ttu-id="8f837-356">**PropertySheetHandlers**</span><span class="sxs-lookup"><span data-stu-id="8f837-356">**PropertySheetHandlers**</span></span> |
| <span data-ttu-id="8f837-357">Gestionnaire de fournisseur de colonne (déconseillé dans Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="8f837-357">Column provider handler (deprecated in Windows Vista)</span></span> | <span data-ttu-id="8f837-358">IColumnProvider</span><span class="sxs-lookup"><span data-stu-id="8f837-358">IColumnProvider</span></span>    | <span data-ttu-id="8f837-359">**ColumnHandlers**</span><span class="sxs-lookup"><span data-stu-id="8f837-359">**ColumnHandlers**</span></span>        |



 

<span data-ttu-id="8f837-360">Pour les gestionnaires suivants, la valeur par défaut de la clé « nom de la sous-clé du gestionnaire » est la version de chaîne du CLSID de l’extension de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f837-360">For the following handlers, the default value of the "Handler Subkey Name" key is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="8f837-361">Une seule extension peut être inscrite pour ces gestionnaires.</span><span class="sxs-lookup"><span data-stu-id="8f837-361">Only one extension can be registered for these handlers.</span></span>



| <span data-ttu-id="8f837-362">Handler</span><span class="sxs-lookup"><span data-stu-id="8f837-362">Handler</span></span>                 | <span data-ttu-id="8f837-363">Interface</span><span class="sxs-lookup"><span data-stu-id="8f837-363">Interface</span></span>                                         | <span data-ttu-id="8f837-364">Nom de la sous-clé du gestionnaire</span><span class="sxs-lookup"><span data-stu-id="8f837-364">Handler Subkey Name</span></span>                        |
|-------------------------|---------------------------------------------------|--------------------------------------------|
| <span data-ttu-id="8f837-365">Gestionnaire de données</span><span class="sxs-lookup"><span data-stu-id="8f837-365">Data handler</span></span>            | <span data-ttu-id="8f837-366">IDataObject</span><span class="sxs-lookup"><span data-stu-id="8f837-366">IDataObject</span></span>                                       | <span data-ttu-id="8f837-367">**DataHandler**</span><span class="sxs-lookup"><span data-stu-id="8f837-367">**DataHandler**</span></span>                            |
| <span data-ttu-id="8f837-368">Supprimer le gestionnaire</span><span class="sxs-lookup"><span data-stu-id="8f837-368">Drop handler</span></span>            | <span data-ttu-id="8f837-369">IDropTarget</span><span class="sxs-lookup"><span data-stu-id="8f837-369">IDropTarget</span></span>                                       | <span data-ttu-id="8f837-370">**DropHandler**</span><span class="sxs-lookup"><span data-stu-id="8f837-370">**DropHandler**</span></span>                            |
| <span data-ttu-id="8f837-371">Gestionnaire d’icône</span><span class="sxs-lookup"><span data-stu-id="8f837-371">Icon handler</span></span>            | <span data-ttu-id="8f837-372">IExtractIconA/W</span><span class="sxs-lookup"><span data-stu-id="8f837-372">IExtractIconA/W</span></span>                                   | <span data-ttu-id="8f837-373">**IconHandler**</span><span class="sxs-lookup"><span data-stu-id="8f837-373">**IconHandler**</span></span>                            |
| <span data-ttu-id="8f837-374">Gestionnaire d’images</span><span class="sxs-lookup"><span data-stu-id="8f837-374">Image handler</span></span>           | <span data-ttu-id="8f837-375">IExtractImage</span><span class="sxs-lookup"><span data-stu-id="8f837-375">IExtractImage</span></span>                                     | <span data-ttu-id="8f837-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span><span class="sxs-lookup"><span data-stu-id="8f837-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span></span> |
| <span data-ttu-id="8f837-377">Gestionnaire d’images miniatures</span><span class="sxs-lookup"><span data-stu-id="8f837-377">Thumbnail image handler</span></span> | <span data-ttu-id="8f837-378">IThumbnailProvider</span><span class="sxs-lookup"><span data-stu-id="8f837-378">IThumbnailProvider</span></span>                                | <span data-ttu-id="8f837-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span><span class="sxs-lookup"><span data-stu-id="8f837-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span></span> |
| <span data-ttu-id="8f837-380">Gestionnaire d'info-bulle</span><span class="sxs-lookup"><span data-stu-id="8f837-380">Infotip handler</span></span>         | <span data-ttu-id="8f837-381">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="8f837-381">IQueryInfo</span></span>                                        | <span data-ttu-id="8f837-382">**{00021500-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="8f837-382">**{00021500-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="8f837-383">Lien de Shell (ANSI)</span><span class="sxs-lookup"><span data-stu-id="8f837-383">Shell link (ANSI )</span></span>      | <span data-ttu-id="8f837-384">IShellLinkA</span><span class="sxs-lookup"><span data-stu-id="8f837-384">IShellLinkA</span></span>                                       | <span data-ttu-id="8f837-385">**{000214EE-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="8f837-385">**{000214EE-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="8f837-386">Lien de Shell (UNICODE)</span><span class="sxs-lookup"><span data-stu-id="8f837-386">Shell link (UNICODE)</span></span>    | <span data-ttu-id="8f837-387">IShellLinkW</span><span class="sxs-lookup"><span data-stu-id="8f837-387">IShellLinkW</span></span>                                       | <span data-ttu-id="8f837-388">**{000214F9-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="8f837-388">**{000214F9-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="8f837-389">Stockage structuré</span><span class="sxs-lookup"><span data-stu-id="8f837-389">Structured storage</span></span>      | <span data-ttu-id="8f837-390">IStorage</span><span class="sxs-lookup"><span data-stu-id="8f837-390">IStorage</span></span>                                          | <span data-ttu-id="8f837-391">**{0000000B-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="8f837-391">**{0000000B-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="8f837-392">Métadonnées</span><span class="sxs-lookup"><span data-stu-id="8f837-392">Metadata</span></span>                | <span data-ttu-id="8f837-393">IPropertyStore</span><span class="sxs-lookup"><span data-stu-id="8f837-393">IPropertyStore</span></span>                                    | <span data-ttu-id="8f837-394">**PropertyHandler**</span><span class="sxs-lookup"><span data-stu-id="8f837-394">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="8f837-395">Métadonnées</span><span class="sxs-lookup"><span data-stu-id="8f837-395">Metadata</span></span>                | <span data-ttu-id="8f837-396">IPropertySetStorage (déconseillée dans Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="8f837-396">IPropertySetStorage (deprecated in Windows Vista)</span></span> | <span data-ttu-id="8f837-397">**PropertyHandler**</span><span class="sxs-lookup"><span data-stu-id="8f837-397">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="8f837-398">Épingler au menu Démarrer</span><span class="sxs-lookup"><span data-stu-id="8f837-398">Pin to Start Menu</span></span>       | <span data-ttu-id="8f837-399">IStartMenuPinnedList</span><span class="sxs-lookup"><span data-stu-id="8f837-399">IStartMenuPinnedList</span></span>                              | <span data-ttu-id="8f837-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span><span class="sxs-lookup"><span data-stu-id="8f837-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span></span> |
| <span data-ttu-id="8f837-401">Épingler à la barre des tâches</span><span class="sxs-lookup"><span data-stu-id="8f837-401">Pin to Taskbar</span></span>          |                                                   | <span data-ttu-id="8f837-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span><span class="sxs-lookup"><span data-stu-id="8f837-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span></span> |



 

<span data-ttu-id="8f837-403">Les sous-clés spécifiées pour ajouter **Épingler au menu Démarrer** et **Épingler à la barre des tâches** dans le menu contextuel d’un élément ne sont nécessaires que pour les types de fichiers qui incluent l’entrée [IsShortCut](./links.md) .</span><span class="sxs-lookup"><span data-stu-id="8f837-403">The subkeys specified to add **Pin to Start Menu** and **Pin to Taskbar** to an item's shortcut menu are only required for file types that include the [IsShortCut](./links.md) entry.</span></span>

<span data-ttu-id="8f837-404">La prise en charge des gestionnaires de fournisseurs de colonne a été supprimée dans Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="8f837-404">Support for column provider handlers was removed in Windows Vista.</span></span> <span data-ttu-id="8f837-405">En outre, à compter de Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) a été dépréciée en faveur de [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="8f837-405">Also, as of Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) has been deprecated in favor of [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span>

<span data-ttu-id="8f837-406">Bien que [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) reste pris en charge, [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) est préférable pour Windows Vista et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="8f837-406">While [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) remains supported, [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) is preferred for Windows Vista and later.</span></span>

### <a name="predefined-shell-objects"></a><span data-ttu-id="8f837-407">Objets Shell prédéfinis</span><span class="sxs-lookup"><span data-stu-id="8f837-407">Predefined Shell Objects</span></span>

<span data-ttu-id="8f837-408">L’interpréteur de commandes définit des objets supplémentaires sous la **\_ \_ racine HKEY classes** qui peuvent être étendus de la même façon que les types de fichiers.</span><span class="sxs-lookup"><span data-stu-id="8f837-408">The Shell defines additional objects under **HKEY\_CLASSES\_ROOT** which can be extended in the same way as file types.</span></span> <span data-ttu-id="8f837-409">Par exemple, pour ajouter un gestionnaire de feuille de propriétés pour tous les fichiers, vous pouvez vous inscrire sous la clé **PropertySheetHandlers** .</span><span class="sxs-lookup"><span data-stu-id="8f837-409">For example, to add a property sheet handler for all files, you can register under the **PropertySheetHandlers** key.</span></span>

```
HKEY_CLASSES_ROOT
   *
      shellex
         PropertySheetHandlers
```

<span data-ttu-id="8f837-410">Le tableau suivant indique les différentes sous-clés de la **\_ \_ racine de la classe HKEY** sous lesquelles les gestionnaires d’extension peuvent être inscrits.</span><span class="sxs-lookup"><span data-stu-id="8f837-410">The following table gives the various subkeys of **HKEY\_CLASSES\_ROOT** under which extension handlers can be registered.</span></span> <span data-ttu-id="8f837-411">Notez que de nombreux gestionnaires d’extension ne peuvent pas être enregistrés sous toutes les sous-clés répertoriées.</span><span class="sxs-lookup"><span data-stu-id="8f837-411">Note that many extension handlers cannot be registered under all of the listed subkeys.</span></span> <span data-ttu-id="8f837-412">Pour plus d’informations, consultez la documentation du gestionnaire spécifique.</span><span class="sxs-lookup"><span data-stu-id="8f837-412">For further details, see the specific handler's documentation.</span></span>



| <span data-ttu-id="8f837-413">Sous-clé</span><span class="sxs-lookup"><span data-stu-id="8f837-413">Subkey</span></span>                    | <span data-ttu-id="8f837-414">Description</span><span class="sxs-lookup"><span data-stu-id="8f837-414">Description</span></span>                                                          | <span data-ttu-id="8f837-415">Gestionnaires possibles</span><span class="sxs-lookup"><span data-stu-id="8f837-415">Possible Handlers</span></span>                                | <span data-ttu-id="8f837-416">Version</span><span class="sxs-lookup"><span data-stu-id="8f837-416">Version</span></span> |
|---------------------------|----------------------------------------------------------------------|--------------------------------------------------|---------|
| <span data-ttu-id="8f837-417">\**\** _</span><span class="sxs-lookup"><span data-stu-id="8f837-417">\**\** _</span></span>                    | <span data-ttu-id="8f837-418">Tous les fichiers</span><span class="sxs-lookup"><span data-stu-id="8f837-418">All files</span></span>                                                            | <span data-ttu-id="8f837-419">Menu contextuel, feuille de propriétés, verbes (voir ci-dessous)</span><span class="sxs-lookup"><span data-stu-id="8f837-419">Shortcut Menu, Property Sheet, Verbs (see below)</span></span> | <span data-ttu-id="8f837-420">Tous</span><span class="sxs-lookup"><span data-stu-id="8f837-420">All</span></span>     |
| <span data-ttu-id="8f837-421">_ *AllFileSystemObjects*\*</span><span class="sxs-lookup"><span data-stu-id="8f837-421">_ *AllFileSystemObjects*\*</span></span>  | <span data-ttu-id="8f837-422">Tous les fichiers et dossiers de fichiers</span><span class="sxs-lookup"><span data-stu-id="8f837-422">All files and file folders</span></span>                                           | <span data-ttu-id="8f837-423">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-423">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-424">4.71</span><span class="sxs-lookup"><span data-stu-id="8f837-424">4.71</span></span>    |
| <span data-ttu-id="8f837-425">**Folder**</span><span class="sxs-lookup"><span data-stu-id="8f837-425">**Folder**</span></span>                | <span data-ttu-id="8f837-426">Tous les dossiers</span><span class="sxs-lookup"><span data-stu-id="8f837-426">All folders</span></span>                                                          | <span data-ttu-id="8f837-427">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-427">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-428">Tous</span><span class="sxs-lookup"><span data-stu-id="8f837-428">All</span></span>     |
| <span data-ttu-id="8f837-429">**Directory**</span><span class="sxs-lookup"><span data-stu-id="8f837-429">**Directory**</span></span>             | <span data-ttu-id="8f837-430">Dossiers de fichiers</span><span class="sxs-lookup"><span data-stu-id="8f837-430">File folders</span></span>                                                         | <span data-ttu-id="8f837-431">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-431">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-432">Tous</span><span class="sxs-lookup"><span data-stu-id="8f837-432">All</span></span>     |
| <span data-ttu-id="8f837-433">**\\Arrière-plan du répertoire**</span><span class="sxs-lookup"><span data-stu-id="8f837-433">**Directory\\Background**</span></span> | <span data-ttu-id="8f837-434">Arrière-plan du dossier de fichiers</span><span class="sxs-lookup"><span data-stu-id="8f837-434">File folder background</span></span>                                               | <span data-ttu-id="8f837-435">Menu contextuel uniquement</span><span class="sxs-lookup"><span data-stu-id="8f837-435">Shortcut Menu only</span></span>                               | <span data-ttu-id="8f837-436">4.71</span><span class="sxs-lookup"><span data-stu-id="8f837-436">4.71</span></span>    |
| <span data-ttu-id="8f837-437">**Lecteur**</span><span class="sxs-lookup"><span data-stu-id="8f837-437">**Drive**</span></span>                 | <span data-ttu-id="8f837-438">Tous les lecteurs dans MyComputer, tels que « C : \\ »</span><span class="sxs-lookup"><span data-stu-id="8f837-438">All drives in MyComputer, such as "C:\\"</span></span>                             | <span data-ttu-id="8f837-439">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-439">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-440">Tous</span><span class="sxs-lookup"><span data-stu-id="8f837-440">All</span></span>     |
| <span data-ttu-id="8f837-441">**Réseau**</span><span class="sxs-lookup"><span data-stu-id="8f837-441">**Network**</span></span>               | <span data-ttu-id="8f837-442">Tout le réseau (sous Favoris réseau)</span><span class="sxs-lookup"><span data-stu-id="8f837-442">Entire network (under My Network Places)</span></span>                             | <span data-ttu-id="8f837-443">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-443">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-444">Tous</span><span class="sxs-lookup"><span data-stu-id="8f837-444">All</span></span>     |
| <span data-ttu-id="8f837-445">**Type de réseau \\\\\#**</span><span class="sxs-lookup"><span data-stu-id="8f837-445">**Network\\Type\\\#**</span></span>     | <span data-ttu-id="8f837-446">Tous les objets de type \# (voir ci-dessous)</span><span class="sxs-lookup"><span data-stu-id="8f837-446">All objects of type \# (see below)</span></span>                                   | <span data-ttu-id="8f837-447">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-447">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-448">4.71</span><span class="sxs-lookup"><span data-stu-id="8f837-448">4.71</span></span>    |
| <span data-ttu-id="8f837-449">**NetShare**</span><span class="sxs-lookup"><span data-stu-id="8f837-449">**NetShare**</span></span>              | <span data-ttu-id="8f837-450">Tous les partages réseau</span><span class="sxs-lookup"><span data-stu-id="8f837-450">All network shares</span></span>                                                   | <span data-ttu-id="8f837-451">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-451">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-452">4.71</span><span class="sxs-lookup"><span data-stu-id="8f837-452">4.71</span></span>    |
| <span data-ttu-id="8f837-453">**Serveur netserver**</span><span class="sxs-lookup"><span data-stu-id="8f837-453">**NetServer**</span></span>             | <span data-ttu-id="8f837-454">Tous les serveurs réseau</span><span class="sxs-lookup"><span data-stu-id="8f837-454">All network servers</span></span>                                                  | <span data-ttu-id="8f837-455">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-455">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-456">4.71</span><span class="sxs-lookup"><span data-stu-id="8f837-456">4.71</span></span>    |
| <span data-ttu-id="8f837-457">*\_nom du fournisseur réseau \_*</span><span class="sxs-lookup"><span data-stu-id="8f837-457">*network\_provider\_name*</span></span> | <span data-ttu-id="8f837-458">Tous les objets fournis par le fournisseur réseau «*\_ \_ nom du fournisseur réseau*»</span><span class="sxs-lookup"><span data-stu-id="8f837-458">All objects provided by network provider "*network\_provider\_name*"</span></span> | <span data-ttu-id="8f837-459">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-459">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-460">Tous</span><span class="sxs-lookup"><span data-stu-id="8f837-460">All</span></span>     |
| <span data-ttu-id="8f837-461">**Imprimantes**</span><span class="sxs-lookup"><span data-stu-id="8f837-461">**Printers**</span></span>              | <span data-ttu-id="8f837-462">Toutes les imprimantes</span><span class="sxs-lookup"><span data-stu-id="8f837-462">All printers</span></span>                                                         | <span data-ttu-id="8f837-463">Menu contextuel, feuille de propriétés</span><span class="sxs-lookup"><span data-stu-id="8f837-463">Shortcut Menu, Property Sheet</span></span>                    | <span data-ttu-id="8f837-464">Tous</span><span class="sxs-lookup"><span data-stu-id="8f837-464">All</span></span>     |
| <span data-ttu-id="8f837-465">**AudioCD**</span><span class="sxs-lookup"><span data-stu-id="8f837-465">**AudioCD**</span></span>               | <span data-ttu-id="8f837-466">CD audio dans le lecteur CD</span><span class="sxs-lookup"><span data-stu-id="8f837-466">Audio CD in CD drive</span></span>                                                 | <span data-ttu-id="8f837-467">Verbes uniquement</span><span class="sxs-lookup"><span data-stu-id="8f837-467">Verbs only</span></span>                                       | <span data-ttu-id="8f837-468">Tous</span><span class="sxs-lookup"><span data-stu-id="8f837-468">All</span></span>     |
| <span data-ttu-id="8f837-469">**DVD**</span><span class="sxs-lookup"><span data-stu-id="8f837-469">**DVD**</span></span>                   | <span data-ttu-id="8f837-470">Lecteur de DVD (Windows 2000)</span><span class="sxs-lookup"><span data-stu-id="8f837-470">DVD drive (Windows 2000)</span></span>                                             | <span data-ttu-id="8f837-471">Menu contextuel, feuille de propriétés, verbes</span><span class="sxs-lookup"><span data-stu-id="8f837-471">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8f837-472">4.71</span><span class="sxs-lookup"><span data-stu-id="8f837-472">4.71</span></span>    |



 

<span data-ttu-id="8f837-473">Remarques :</span><span class="sxs-lookup"><span data-stu-id="8f837-473">Notes:</span></span>

-   <span data-ttu-id="8f837-474">Le menu contextuel de l’arrière-plan du dossier de fichiers est accessible en cliquant avec le bouton droit dans un dossier de fichiers, mais pas sur le contenu du dossier.</span><span class="sxs-lookup"><span data-stu-id="8f837-474">The file folder background shortcut menu is accessed by right-clicking within a file folder, but not over any of the folder's contents.</span></span>
-   <span data-ttu-id="8f837-475">Les « verbes » sont des commandes spéciales **inscrites sous le \_ \_** verbe de Shell de la \\ *sous-clé* de l' \\ **interpréteur** de commandes \\  .</span><span class="sxs-lookup"><span data-stu-id="8f837-475">"Verbs" are special commands registered under **HKEY\_CLASSES\_ROOT**\\*Subkey*\\**Shell**\\**Verb** .</span></span>
-   <span data-ttu-id="8f837-476">Pour le type de **réseau** \\  \\ **\#** , « \# » est un code de type de fournisseur réseau au format décimal.</span><span class="sxs-lookup"><span data-stu-id="8f837-476">For **Network**\\**Type**\\**\#** , "\#" is a network provider type code in decimal.</span></span> <span data-ttu-id="8f837-477">Le code du type de fournisseur réseau est le mot de poids fort d’un type de réseau.</span><span class="sxs-lookup"><span data-stu-id="8f837-477">The network provider type code is the high word of a network type.</span></span> <span data-ttu-id="8f837-478">La liste des types de réseau est fournie dans le fichier d’en-tête Winnetwk. h ( \_ valeurs net WNNC \_ \* ).</span><span class="sxs-lookup"><span data-stu-id="8f837-478">The list of network types is given in the Winnetwk.h header file (WNNC\_NET\_\* values).</span></span> <span data-ttu-id="8f837-479">Par exemple, WNNC \_ NET \_ Shiva est 0x00330000. par conséquent, la clé de type correspondante serait de type HKEY de la **\_ \_ racine** de \\  \\ **type** \\ **51** .</span><span class="sxs-lookup"><span data-stu-id="8f837-479">For example, WNNC\_NET\_SHIVA is 0x00330000, so the corresponding type key would be **HKEY\_CLASSES\_ROOT**\\**Network**\\**Type**\\**51** .</span></span>
-   <span data-ttu-id="8f837-480">«*\_ \_ nom du fournisseur réseau*» est un nom de fournisseur réseau spécifié par [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), avec les espaces convertis en traits de soulignement.</span><span class="sxs-lookup"><span data-stu-id="8f837-480">"*network\_provider\_name*" is a network provider name as specified by [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), with the spaces converted into underscores.</span></span> <span data-ttu-id="8f837-481">Par exemple, si le fournisseur réseau de réseau Microsoft est installé, son nom de fournisseur est « Microsoft Windows Network » et le *\_ \_ nom du fournisseur réseau* correspondant est **Microsoft \_ Windows \_ Network**.</span><span class="sxs-lookup"><span data-stu-id="8f837-481">For example, if the Microsoft Networking network provider is installed, its provider name is "Microsoft Windows Network", and the corresponding *network\_provider\_name* is **Microsoft\_Windows\_Network**.</span></span>

### <a name="example-of-an-extension-handler-registration"></a><span data-ttu-id="8f837-482">Exemple d’inscription d’un gestionnaire d’extensions</span><span class="sxs-lookup"><span data-stu-id="8f837-482">Example of an Extension Handler Registration</span></span>

<span data-ttu-id="8f837-483">Pour activer un gestionnaire spécifique, créez une sous-clé sous la clé de type de gestionnaire d’extension avec le nom du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="8f837-483">To enable a particular handler, create a subkey under the extension handler type key with the name of the handler.</span></span> <span data-ttu-id="8f837-484">L’interpréteur de commandes n’utilise pas le nom du gestionnaire, mais il doit être différent de tous les autres noms sous cette sous-clé de type.</span><span class="sxs-lookup"><span data-stu-id="8f837-484">The Shell does not use the handler's name, but it must be different from all other names under that type subkey.</span></span> <span data-ttu-id="8f837-485">Définissez la valeur par défaut de la sous-clé Name sur la forme de chaîne du GUID du gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="8f837-485">Set the default value of the name subkey to the string form of the handler's GUID.</span></span>

<span data-ttu-id="8f837-486">L’exemple suivant illustre les entrées de Registre qui activent les gestionnaires d’extensions de menu contextuel et de feuille de propriétés, à l’aide d’un exemple de type de fichier. MYP :</span><span class="sxs-lookup"><span data-stu-id="8f837-486">The following example illustrates registry entries that enable shortcut menu and property sheet extension handlers, using an example .myp file type:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   CLSID
      {00000000-1111-2222-3333-444444444444}
         InProcServer32
            (Default) = C:\MyDir\MyCommand.dll
            ThreadingModel = Apartment
      {11111111-2222-3333-4444-555555555555}
         InProcServer32
            (Default) = C:\MyDir\MyPropSheet.dll
            ThreadingModel = Apartment
   MyProgram.1
      (Default) = MyProgram Application
      Shellex
         ContextMenuHandler
            MyCommand
               (Default) = {00000000-1111-2222-3333-444444444444}
         PropertySheetHandlers
            MyPropSheet
               (Default) = {11111111-2222-3333-4444-555555555555}
```

<span data-ttu-id="8f837-487">La procédure d’inscription décrite dans cette section doit être suivie pour tous les systèmes Windows.</span><span class="sxs-lookup"><span data-stu-id="8f837-487">The registration procedure discussed in this section must be followed for all Windows systems.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8f837-488">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8f837-488">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8f837-489">Conseils pour l’implémentation des extensions de In-Process</span><span class="sxs-lookup"><span data-stu-id="8f837-489">Guidance for Implementing In-Process Extensions</span></span>](shell-and-managed-code.md)
</dt> </dl>

 

 
