---
description: L’interpréteur de commandes offre plusieurs moyens de gérer les systèmes de fichiers.
ms.assetid: d9ffda6f-adc0-44a3-b410-e23bf5f4f165
title: Gestion du système de fichiers
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 404b456ce1f26c128e6c3fc3bc9971672378a0d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104317949"
---
# <a name="managing-the-file-system"></a><span data-ttu-id="02209-103">Gestion du système de fichiers</span><span class="sxs-lookup"><span data-stu-id="02209-103">Managing the File System</span></span>

<span data-ttu-id="02209-104">L’interpréteur de commandes offre plusieurs moyens de gérer les systèmes de fichiers.</span><span class="sxs-lookup"><span data-stu-id="02209-104">The Shell provides a number of ways to manage file systems.</span></span> <span data-ttu-id="02209-105">L’interpréteur de commandes fournit une fonction, [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa), qui permet à une application de déplacer, copier, renommer et supprimer des fichiers par programmation.</span><span class="sxs-lookup"><span data-stu-id="02209-105">The Shell provides a function, [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa), that allows an application to programmatically move, copy, rename, and delete files.</span></span> <span data-ttu-id="02209-106">L’interpréteur de commandes prend également en charge des fonctionnalités de gestion de fichiers supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="02209-106">The Shell also supports some additional file management capabilities.</span></span>

-   <span data-ttu-id="02209-107">Les documents HTML peuvent être *connectés* à des fichiers associés, tels que des fichiers graphiques ou des feuilles de style.</span><span class="sxs-lookup"><span data-stu-id="02209-107">HTML documents can be *connected* to related files, such as graphics files or style sheets.</span></span> <span data-ttu-id="02209-108">Lorsque le document est déplacé ou copié, les fichiers connectés sont également déplacés ou copiés automatiquement.</span><span class="sxs-lookup"><span data-stu-id="02209-108">When the document is moved or copied, the connected files are automatically moved or copied as well.</span></span>
-   <span data-ttu-id="02209-109">Pour les systèmes qui sont disponibles pour plusieurs utilisateurs, les fichiers peuvent être gérés par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="02209-109">For systems that are available to more than one user, files can be managed on a per-user basis.</span></span> <span data-ttu-id="02209-110">Les utilisateurs ont facilement accès à leurs fichiers de données, mais pas aux fichiers appartenant à d’autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="02209-110">Users have easy access to their data files, but not to files belonging to other users.</span></span>
-   <span data-ttu-id="02209-111">Si des fichiers de document sont ajoutés ou modifiés, ils peuvent être ajoutés à la liste des documents récents de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="02209-111">If document files are added or modified, they can be added to the Shell's list of recent documents.</span></span> <span data-ttu-id="02209-112">Quand l’utilisateur clique sur la commande **documents** dans le menu Démarrer, une liste de liens vers les documents s’affiche.</span><span class="sxs-lookup"><span data-stu-id="02209-112">When the user clicks the **Documents** command on the Start menu, a list of links to the documents appears.</span></span>

<span data-ttu-id="02209-113">Ce document décrit le fonctionnement de ces technologies de gestion de fichiers.</span><span class="sxs-lookup"><span data-stu-id="02209-113">This document discusses how these file management technologies work.</span></span> <span data-ttu-id="02209-114">Il décrit ensuite comment utiliser l’interpréteur de commandes pour déplacer, copier, renommer et supprimer des fichiers, et comment gérer des objets dans la corbeille.</span><span class="sxs-lookup"><span data-stu-id="02209-114">It then outlines how to use the Shell to move, copy, rename, and delete files, and how to manage objects in the Recycle Bin.</span></span>

-   [<span data-ttu-id="02209-115">Gestion des fichiers par utilisateur</span><span class="sxs-lookup"><span data-stu-id="02209-115">Per-User File Management</span></span>](#per-user-file-management)
-   [<span data-ttu-id="02209-116">Dossiers Mes documents et mes images</span><span class="sxs-lookup"><span data-stu-id="02209-116">My Documents and My Pictures Folders</span></span>](#my-documents-and-my-pictures-folders)
-   [<span data-ttu-id="02209-117">Fichiers connectés</span><span class="sxs-lookup"><span data-stu-id="02209-117">Connected Files</span></span>](#connected-files)
-   [<span data-ttu-id="02209-118">Déplacement, copie, attribution d’un nouveau nom et suppression de fichiers</span><span class="sxs-lookup"><span data-stu-id="02209-118">Moving, Copying, Renaming, and Deleting Files</span></span>](#moving-copying-renaming-and-deleting-files)
    -   [<span data-ttu-id="02209-119">Notification de l’interpréteur de commandes</span><span class="sxs-lookup"><span data-stu-id="02209-119">Notifying the Shell</span></span>](#notifying-the-shell)
-   [<span data-ttu-id="02209-120">Exemple simple de gestion de fichiers avec SHFileOperation</span><span class="sxs-lookup"><span data-stu-id="02209-120">Simple Example of Managing Files with SHFileOperation</span></span>](#simple-example-of-managing-files-with-shfileoperation)
-   [<span data-ttu-id="02209-121">Ajout de fichiers à la liste des documents récents de l’interpréteur de commandes</span><span class="sxs-lookup"><span data-stu-id="02209-121">Adding Files to the Shell's List of Recent Documents</span></span>](#adding-files-to-the-shells-list-of-recent-documents)

## <a name="per-user-file-management"></a><span data-ttu-id="02209-122">Gestion de fichiers Per-User</span><span class="sxs-lookup"><span data-stu-id="02209-122">Per-User File Management</span></span>

<span data-ttu-id="02209-123">L’interpréteur de commandes Windows 2000 permet à des fichiers d’être associés à un utilisateur particulier, de sorte que les fichiers restent masqués pour les autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="02209-123">The Windows 2000 Shell allows files to be associated with a particular user so the files remain hidden from other users.</span></span> <span data-ttu-id="02209-124">En termes de système de fichiers, les fichiers sont stockés dans le dossier de profil de l’utilisateur, généralement C : \\ Documents and Settings \\ *username* \\ sur les systèmes Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="02209-124">In terms of the file system, the files are stored under the user's profile folder, typically C:\\Documents and Settings\\*Username*\\ on Windows 2000 systems.</span></span> <span data-ttu-id="02209-125">Cette fonctionnalité permet à de nombreuses personnes d’utiliser le même ordinateur, tout en préservant la confidentialité de leurs fichiers d’autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="02209-125">This feature allows many individuals to use the same computer, while maintaining the privacy of their files from other users.</span></span> <span data-ttu-id="02209-126">Différents utilisateurs peuvent avoir différents programmes disponibles.</span><span class="sxs-lookup"><span data-stu-id="02209-126">Different users can have different programs available.</span></span> <span data-ttu-id="02209-127">Il offre également un moyen simple aux administrateurs et aux applications de stocker des éléments tels que les fichiers d’initialisation (. ini) ou de lien (. lnk).</span><span class="sxs-lookup"><span data-stu-id="02209-127">It also provides a straightforward way for administrators and applications to store such things as initialization (.ini) or link (.lnk) files.</span></span> <span data-ttu-id="02209-128">Les applications peuvent donc conserver un état différent pour chaque utilisateur et récupérer facilement cet état particulier en cas de besoin.</span><span class="sxs-lookup"><span data-stu-id="02209-128">Applications can thus preserve a different state for each user and easily recover that particular state when needed.</span></span> <span data-ttu-id="02209-129">Il existe également un dossier de profil pour stocker des informations qui sont communes à tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="02209-129">There is also a profile folder for storing information that is common to all users.</span></span>

<span data-ttu-id="02209-130">Étant donné qu’il est peu commode de déterminer quel utilisateur est connecté et où se trouvent ses fichiers, les dossiers par utilisateur standard sont des dossiers spéciaux et sont identifiés par un [**CSIDL**](csidl.md).</span><span class="sxs-lookup"><span data-stu-id="02209-130">Because it is inconvenient to determine which user is logged in and where their files are located, the standard per-user folders are special folders and are identified by a [**CSIDL**](csidl.md).</span></span> <span data-ttu-id="02209-131">Par exemple, le CSIDL pour le dossier Program Files par utilisateur est programmes CSIDL \_ .</span><span class="sxs-lookup"><span data-stu-id="02209-131">For instance, the CSIDL for the per-user Program Files folder is CSIDL\_PROGRAMS.</span></span> <span data-ttu-id="02209-132">Si votre application appelle [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) ou [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) avec l’un des CSIDLs par utilisateur, la fonction retourne le pointeur vers une liste d’identificateurs d’éléments (PIDL) ou un chemin d’accès approprié à l’utilisateur actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="02209-132">If your application calls [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) or [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with one of the per-user CSIDLs, the function returns the pointer to an item identifier list (PIDL) or path appropriate to the currently logged-in user.</span></span> <span data-ttu-id="02209-133">Si votre application doit récupérer le chemin d’accès ou le PIDL du dossier du profil, son CSIDL est un **\_ Profil CSIDL**.</span><span class="sxs-lookup"><span data-stu-id="02209-133">If your application needs to retrieve the path or PIDL of the profile folder, its CSIDL is **CSIDL\_PROFILE**.</span></span>

## <a name="my-documents-and-my-pictures-folders"></a><span data-ttu-id="02209-134">Dossiers Mes documents et mes images</span><span class="sxs-lookup"><span data-stu-id="02209-134">My Documents and My Pictures Folders</span></span>

<span data-ttu-id="02209-135">L’une des icônes standard se trouvant sur le bureau est **Mes documents**.</span><span class="sxs-lookup"><span data-stu-id="02209-135">One of the standard icons found on the desktop is **My Documents**.</span></span> <span data-ttu-id="02209-136">Lorsque vous ouvrez ce dossier, il contient les fichiers de document de l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="02209-136">When you open this folder, it contains the current user's document files.</span></span> <span data-ttu-id="02209-137">L’instance de bureau de mes documents est un dossier virtuel (un alias vers l’emplacement du système de fichiers utilisé pour stocker physiquement les documents de l’utilisateur) situé juste sous le bureau dans la hiérarchie de l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="02209-137">The desktop instance of My Documents is a virtual folder—an alias to the file system location used to physically store the user's documents—located immediately below the desktop in the namespace hierarchy.</span></span>

<span data-ttu-id="02209-138">L’objectif des dossiers Mes documents et mes images est de fournir une méthode simple et sécurisée permettant aux utilisateurs d’accéder à leurs fichiers de documents et d’images sur un système qui peut avoir plusieurs utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="02209-138">The purpose of the My Documents and My Pictures folders is to provide a straightforward and secure way for users to access their document and picture files on a system that might have multiple users.</span></span> <span data-ttu-id="02209-139">Des dossiers de système de fichiers distincts sont attribués à chaque utilisateur pour ses fichiers.</span><span class="sxs-lookup"><span data-stu-id="02209-139">Each user is assigned separate file system folders for his or her files.</span></span> <span data-ttu-id="02209-140">Par exemple, l’emplacement du dossier Documents d’un utilisateur dans le système de fichiers est généralement semblable à C : \\ Documents and Settings \\ *username* \\ My documents.</span><span class="sxs-lookup"><span data-stu-id="02209-140">For example, the location of a user's documents folder in the file system is typically something like C:\\Documents and Settings\\*username*\\My Documents.</span></span> <span data-ttu-id="02209-141">Les utilisateurs n’ont pas besoin de connaître l’emplacement physique de leurs dossiers de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="02209-141">There is no need for users to know anything about the physical location of their file system folders.</span></span> <span data-ttu-id="02209-142">Ils accèdent simplement à leurs fichiers via l’icône Mes documents.</span><span class="sxs-lookup"><span data-stu-id="02209-142">They simply access their files through the My Documents icon.</span></span>

> [!Note]  
> <span data-ttu-id="02209-143">Mes documents permet à un utilisateur d’accéder à ses propres fichiers, mais pas à ceux d’autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="02209-143">My Documents allows a user to access his or her own files but not those of any other user.</span></span> <span data-ttu-id="02209-144">Si plusieurs personnes utilisent le même ordinateur, un administrateur peut verrouiller les utilisateurs de la partie du système de fichiers où sont stockés les fichiers réels.</span><span class="sxs-lookup"><span data-stu-id="02209-144">If multiple individuals use the same computer, an administrator can lock users out of the part of the file system where the actual files are stored.</span></span> <span data-ttu-id="02209-145">Les utilisateurs pourront ainsi travailler sur leurs propres documents par le biais du dossier Mes documents, mais pas sur des documents appartenant à d’autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="02209-145">Users will thus be able to work on their own documents through the My Documents folder but not on documents that belong to any other users.</span></span>

 

<span data-ttu-id="02209-146">Il n’est généralement pas nécessaire pour une application de savoir quel utilisateur est connecté ou dans le système de fichiers où se trouve le dossier Mes documents de cet utilisateur.</span><span class="sxs-lookup"><span data-stu-id="02209-146">There is usually no need for an application to know which user is logged in or where in the file system that user's My Documents folder is located.</span></span> <span data-ttu-id="02209-147">Au lieu de cela, votre application peut récupérer le PIDL de l’icône Mes documents du Bureau en appelant la méthode [**IShellFolder ::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) du bureau.</span><span class="sxs-lookup"><span data-stu-id="02209-147">Instead, your application can retrieve the PIDL of the My Documents desktop icon by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method.</span></span> <span data-ttu-id="02209-148">Le nom d’analyse utilisé pour identifier le dossier Mes documents n’est pas un chemin d’accès de fichier, mais à la place : {450d8fba-ad25-11D0-98a8-0800361b1103}.</span><span class="sxs-lookup"><span data-stu-id="02209-148">The parsing name used to identify the My Documents folder is not a file path but rather ::{450d8fba-ad25-11d0-98a8-0800361b1103}.</span></span> <span data-ttu-id="02209-149">L’expression entre crochets est la forme textuelle du GUID mes documents.</span><span class="sxs-lookup"><span data-stu-id="02209-149">The bracketed expression is the text form of the My Documents GUID.</span></span> <span data-ttu-id="02209-150">Par exemple, pour récupérer le PIDL de mes documents, votre application doit utiliser cet appel à **IShellFolder ::P arsedisplayname**.</span><span class="sxs-lookup"><span data-stu-id="02209-150">For example, to retrieve the PIDL of My Documents, your application should use this call to **IShellFolder::ParseDisplayName**.</span></span>


```C++
hr = psfDeskTop->ParseDisplayName(NULL, 
                                  NULL, 
                                  L"::{450d8fba-ad25-11d0-98a8-0800361b1103}", 
                                  &chEaten, 
                                  &pidlDocFiles, 
                                  NULL);
```



<span data-ttu-id="02209-151">Une fois que votre application a le PIDL mes documents, elle peut gérer le dossier comme s’il s’agissait d’un dossier de système de fichiers normal (énumération d’éléments, analyse, liaison et exécution de toute autre opération de dossier valide).</span><span class="sxs-lookup"><span data-stu-id="02209-151">Once your application has the My Documents PIDL, it can handle the folder just as it would a normal file system folder—enumerating items, parsing, binding, and performing any other valid folder operations.</span></span> <span data-ttu-id="02209-152">L’interpréteur de commandes mappe automatiquement les modifications dans mes documents ou ses sous-dossiers vers les dossiers du système de fichiers appropriés.</span><span class="sxs-lookup"><span data-stu-id="02209-152">The Shell automatically maps changes in My Documents or its subfolders to the appropriate file system folders.</span></span>

<span data-ttu-id="02209-153">Si votre application a besoin d’accéder au dossier réel du système de fichiers qui contient les documents de l’utilisateur actuel, transmettez la valeur de CSIDL- \_ Personal à [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation).</span><span class="sxs-lookup"><span data-stu-id="02209-153">If your application needs access to the actual file system folder that contains the current user's documents, pass CSIDL\_PERSONAL to [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation).</span></span> <span data-ttu-id="02209-154">La fonction retourne le PIDL du dossier de système de fichiers qui est affiché dans le dossier Mes documents de l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="02209-154">The function returns the PIDL of the file system folder that is displayed in the current user's My Documents folder.</span></span>

## <a name="connected-files"></a><span data-ttu-id="02209-155">Fichiers connectés</span><span class="sxs-lookup"><span data-stu-id="02209-155">Connected Files</span></span>

<span data-ttu-id="02209-156">Les documents HTML ont souvent plusieurs fichiers graphiques associés, un fichier de feuille de style, plusieurs fichiers Microsoft JScript (compatibles avec la spécification de langage ECMA 262), et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="02209-156">HTML documents often have a number of associated graphics files, a style sheet file, several Microsoft JScript (compatible with ECMA 262 language specification ) files, and so on.</span></span> <span data-ttu-id="02209-157">Lorsque vous déplacez ou copiez le document HTML principal, vous souhaitez également déplacer ou copier les fichiers associés afin d’éviter de rompre les liens.</span><span class="sxs-lookup"><span data-stu-id="02209-157">When you move or copy the primary HTML document, you also usually want to move or copy its associated files to avoid breaking links.</span></span> <span data-ttu-id="02209-158">Malheureusement, il n’existait aucun moyen simple de déterminer quels fichiers sont associés à un document HTML donné, à l’exception de l’analyse de leur contenu.</span><span class="sxs-lookup"><span data-stu-id="02209-158">Unfortunately, there has been no easy way until now to determine which files are related to any given HTML document other than by analyzing their contents.</span></span> <span data-ttu-id="02209-159">Pour pallier ce problème, Windows 2000 fournit un moyen simple de *connecter* un document HTML primaire à son groupe de fichiers associés.</span><span class="sxs-lookup"><span data-stu-id="02209-159">To alleviate this problem, Windows 2000 provides a simple way to *connect* a primary HTML document to its group of associated files.</span></span> <span data-ttu-id="02209-160">Si la connexion de fichiers est activée, lorsque le document est déplacé ou copié, tous ses fichiers connectés y sont associés.</span><span class="sxs-lookup"><span data-stu-id="02209-160">If file connection is enabled, when the document is moved or copied all its connected files go with it.</span></span>

<span data-ttu-id="02209-161">Pour créer un groupe de fichiers connectés, le document principal doit avoir une extension de nom de fichier. htm ou. html.</span><span class="sxs-lookup"><span data-stu-id="02209-161">To create a group of connected files, the primary document must have an .htm or .html file name extension.</span></span> <span data-ttu-id="02209-162">Créez un sous-dossier du dossier parent du document principal.</span><span class="sxs-lookup"><span data-stu-id="02209-162">Create a subfolder of the primary document's parent folder.</span></span> <span data-ttu-id="02209-163">Le nom du sous-dossier doit être le nom du document principal, moins l’extension. htm ou. html, suivie de l’une des extensions listées ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="02209-163">The subfolder's name must be the name of the primary document, minus the .htm or .html extension, followed by one of the extensions listed below.</span></span> <span data-ttu-id="02209-164">Les extensions les plus couramment utilisées sont « . Files » ou « \_ files ».</span><span class="sxs-lookup"><span data-stu-id="02209-164">The most commonly used extensions are ".files" or "\_files".</span></span> <span data-ttu-id="02209-165">Par exemple, si le document principal est nommé MyDoc.htm, le fait de nommer le sous-dossier « \_ fichiers MyDoc » définit le sous-dossier comme le conteneur des fichiers connectés du document.</span><span class="sxs-lookup"><span data-stu-id="02209-165">For instance, if the primary document is named MyDoc.htm, naming the subfolder "MyDoc\_files" defines the subfolder as the container for the document's connected files.</span></span> <span data-ttu-id="02209-166">Si le document principal est déplacé ou copié, le sous-dossier et ses fichiers sont également déplacés ou copiés.</span><span class="sxs-lookup"><span data-stu-id="02209-166">If the primary document is moved or copied, the subfolder and its files are moved or copied as well.</span></span>

<span data-ttu-id="02209-167">Pour certaines langues, il est possible d’utiliser un équivalent localisé de « \_ files » pour créer un sous-dossier pour les fichiers connectés.</span><span class="sxs-lookup"><span data-stu-id="02209-167">For some languages, it is possible to use a localized equivalent of "\_files" to create a subfolder for connected files.</span></span> <span data-ttu-id="02209-168">Le tableau suivant répertorie les chaînes valides qui peuvent être ajoutées à un nom de document pour créer un sous-dossier de fichiers connectés.</span><span class="sxs-lookup"><span data-stu-id="02209-168">The following table lists the valid strings that can be appended to a document name to create a connected files subfolder.</span></span> <span data-ttu-id="02209-169">Notez que certaines de ces chaînes ont « - » comme premier caractère plutôt que « \_ » ou « . ».</span><span class="sxs-lookup"><span data-stu-id="02209-169">Note that some of these strings have '-' as their first character rather than '\_' or '.'.</span></span>



|              |               |                 |               |
|--------------|---------------|-----------------|---------------|
| <span data-ttu-id="02209-170">« \_ Archivos »</span><span class="sxs-lookup"><span data-stu-id="02209-170">"\_archivos"</span></span> | <span data-ttu-id="02209-171">« \_ Arquivos »</span><span class="sxs-lookup"><span data-stu-id="02209-171">"\_arquivos"</span></span>  | <span data-ttu-id="02209-172">« \_ debout »</span><span class="sxs-lookup"><span data-stu-id="02209-172">"\_bestanden"</span></span>   | <span data-ttu-id="02209-173">« \_ Bylos »</span><span class="sxs-lookup"><span data-stu-id="02209-173">"\_bylos"</span></span>     |
| <span data-ttu-id="02209-174">"-Dateien"</span><span class="sxs-lookup"><span data-stu-id="02209-174">"-Dateien"</span></span>   | <span data-ttu-id="02209-175">« \_ datoteke »</span><span class="sxs-lookup"><span data-stu-id="02209-175">"\_datoteke"</span></span>  | <span data-ttu-id="02209-176">« \_ dosyalar »</span><span class="sxs-lookup"><span data-stu-id="02209-176">"\_dosyalar"</span></span>    | <span data-ttu-id="02209-177">« \_ elemei »</span><span class="sxs-lookup"><span data-stu-id="02209-177">"\_elemei"</span></span>    |
| <span data-ttu-id="02209-178">« \_ failid »</span><span class="sxs-lookup"><span data-stu-id="02209-178">"\_failid"</span></span>   | <span data-ttu-id="02209-179">« \_ échec »</span><span class="sxs-lookup"><span data-stu-id="02209-179">"\_fails"</span></span>     | <span data-ttu-id="02209-180">« \_ fajlovi »</span><span class="sxs-lookup"><span data-stu-id="02209-180">"\_fajlovi"</span></span>     | <span data-ttu-id="02209-181">« \_ ficheiros »</span><span class="sxs-lookup"><span data-stu-id="02209-181">"\_ficheiros"</span></span> |
| <span data-ttu-id="02209-182">« \_ fichier »</span><span class="sxs-lookup"><span data-stu-id="02209-182">"\_fichiers"</span></span> | <span data-ttu-id="02209-183">« -du serveur de fichiers »</span><span class="sxs-lookup"><span data-stu-id="02209-183">"-filer"</span></span>      | <span data-ttu-id="02209-184">". Files"</span><span class="sxs-lookup"><span data-stu-id="02209-184">".files"</span></span>        | <span data-ttu-id="02209-185">« \_ fichiers »</span><span class="sxs-lookup"><span data-stu-id="02209-185">"\_files"</span></span>     |
| <span data-ttu-id="02209-186">« \_ fichier »</span><span class="sxs-lookup"><span data-stu-id="02209-186">"\_file"</span></span>     | <span data-ttu-id="02209-187">« \_ fitxers »</span><span class="sxs-lookup"><span data-stu-id="02209-187">"\_fitxers"</span></span>   | <span data-ttu-id="02209-188">« \_ fitxategiak »</span><span class="sxs-lookup"><span data-stu-id="02209-188">"\_fitxategiak"</span></span> | <span data-ttu-id="02209-189">« \_ pliki »</span><span class="sxs-lookup"><span data-stu-id="02209-189">"\_pliki"</span></span>     |
| <span data-ttu-id="02209-190">« \_ Soubory »</span><span class="sxs-lookup"><span data-stu-id="02209-190">"\_soubory"</span></span>  | <span data-ttu-id="02209-191">« \_ tiedostot »</span><span class="sxs-lookup"><span data-stu-id="02209-191">"\_tiedostot"</span></span> |                 |               |



 

> [!Note]  
> <span data-ttu-id="02209-192">Cette fonctionnalité est sensible à la casse de l’extension.</span><span class="sxs-lookup"><span data-stu-id="02209-192">This feature is sensitive to the case of the extension.</span></span> <span data-ttu-id="02209-193">Par exemple, dans l’exemple ci-dessus, un sous-dossier nommé « fichiers MyDoc » n’est \_ pas connecté à MyDoc.htm.</span><span class="sxs-lookup"><span data-stu-id="02209-193">For instance, for the example given above, a subfolder named "MyDoc\_Files" will not be connected to MyDoc.htm.</span></span>

 

<span data-ttu-id="02209-194">L’activation ou la désactivation de la connexion de fichiers est contrôlée par une valeur **reg \_ DWORD** , NoFileFolderConnection, de la clé de Registre suivante.</span><span class="sxs-lookup"><span data-stu-id="02209-194">Whether file connection is enabled or disabled is controlled by a **REG\_DWORD** value, NoFileFolderConnection, of the following registry key.</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
```

<span data-ttu-id="02209-195">Normalement, cette valeur n’est pas définie et la connexion de fichiers est activée.</span><span class="sxs-lookup"><span data-stu-id="02209-195">This value normally is not defined, and file connection is enabled.</span></span> <span data-ttu-id="02209-196">Si nécessaire, vous pouvez désactiver la connexion de fichiers en ajoutant cette valeur à la clé et en lui affectant la valeur 1.</span><span class="sxs-lookup"><span data-stu-id="02209-196">If necessary, you can disable file connection by adding this value to the key and setting it to 1.</span></span> <span data-ttu-id="02209-197">Pour réactiver la connexion de fichiers, affectez à NoFileFolderConnection la valeur zéro.</span><span class="sxs-lookup"><span data-stu-id="02209-197">To enable file connection again, set NoFileFolderConnection to zero.</span></span>

> [!Note]  
> <span data-ttu-id="02209-198">La connexion de fichiers doit normalement être activée, car d’autres applications peuvent en dépendre.</span><span class="sxs-lookup"><span data-stu-id="02209-198">File connection should normally be enabled because other applications might depend on it.</span></span> <span data-ttu-id="02209-199">Désactivez la connexion de fichiers uniquement si cela est absolument nécessaire.</span><span class="sxs-lookup"><span data-stu-id="02209-199">Disable file connection only if absolutely necessary.</span></span>

 

## <a name="moving-copying-renaming-and-deleting-files"></a><span data-ttu-id="02209-200">Déplacement, copie, attribution d’un nouveau nom et suppression de fichiers</span><span class="sxs-lookup"><span data-stu-id="02209-200">Moving, Copying, Renaming, and Deleting Files</span></span>

<span data-ttu-id="02209-201">L’espace de noms n’est pas statique, et les applications doivent généralement gérer le système de fichiers en effectuant l’une des opérations suivantes.</span><span class="sxs-lookup"><span data-stu-id="02209-201">The namespace is not static, and applications commonly need to manage the file system by performing one of the following operations.</span></span>

-   <span data-ttu-id="02209-202">Copie d’un objet dans un autre dossier.</span><span class="sxs-lookup"><span data-stu-id="02209-202">Copying an object to another folder.</span></span>
-   <span data-ttu-id="02209-203">Déplacement d’un objet vers un autre dossier.</span><span class="sxs-lookup"><span data-stu-id="02209-203">Moving an object to another folder.</span></span>
-   <span data-ttu-id="02209-204">Suppression d’un objet.</span><span class="sxs-lookup"><span data-stu-id="02209-204">Deleting an object.</span></span>
-   <span data-ttu-id="02209-205">Attribution d’un nouveau nom à un objet.</span><span class="sxs-lookup"><span data-stu-id="02209-205">Renaming an object.</span></span>

<span data-ttu-id="02209-206">Ces opérations sont toutes effectuées avec [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span><span class="sxs-lookup"><span data-stu-id="02209-206">These operations are all performed with [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span></span> <span data-ttu-id="02209-207">Cette fonction accepte un ou plusieurs fichiers sources et produit les fichiers de destination correspondants.</span><span class="sxs-lookup"><span data-stu-id="02209-207">This function takes one or more source files and produces corresponding destination files.</span></span> <span data-ttu-id="02209-208">Dans le cas de l’opération de suppression, le système tente de placer les fichiers supprimés dans la corbeille.</span><span class="sxs-lookup"><span data-stu-id="02209-208">In the case of the delete operation, the system attempts to put the deleted files into the Recycle Bin.</span></span>

<span data-ttu-id="02209-209">Il est également possible de déplacer des fichiers à l’aide de la fonctionnalité de [glisser-déplacer](dragdrop.md) .</span><span class="sxs-lookup"><span data-stu-id="02209-209">It is also possible to move files using the [drag-and-drop](dragdrop.md) functionality.</span></span>

<span data-ttu-id="02209-210">Pour utiliser la fonction, vous devez renseigner les membres d’une structure [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) et la passer à [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span><span class="sxs-lookup"><span data-stu-id="02209-210">To use the function, you must fill in the members of an [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) structure and pass it to [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span></span> <span data-ttu-id="02209-211">Les membres clés de la structure sont **pFrom** et **pTo**.</span><span class="sxs-lookup"><span data-stu-id="02209-211">The key members of the structure are **pFrom** and **pTo**.</span></span>

<span data-ttu-id="02209-212">Le membre **pFrom** est une chaîne double se terminant par un caractère **null** qui contient un ou plusieurs noms de fichiers sources.</span><span class="sxs-lookup"><span data-stu-id="02209-212">The **pFrom** member is a double **null**-terminated string that contains one or more source file names.</span></span> <span data-ttu-id="02209-213">Ces noms peuvent être des chemins d’accès complets ou des caractères génériques DOS standard tels que \* . \*</span><span class="sxs-lookup"><span data-stu-id="02209-213">These names can be either fully qualified paths or standard DOS wildcards such as \*.\*.</span></span> <span data-ttu-id="02209-214">Bien que ce membre soit déclaré comme une chaîne terminée par le caractère **null**, il est utilisé comme mémoire tampon pour contenir plusieurs noms de fichiers.</span><span class="sxs-lookup"><span data-stu-id="02209-214">Although this member is declared as a **null**-terminated string, it is used as a buffer to hold multiple file names.</span></span> <span data-ttu-id="02209-215">Chaque nom de fichier doit se terminer par le caractère **null** unique habituel.</span><span class="sxs-lookup"><span data-stu-id="02209-215">Each file name must be terminated by the usual single **NULL** character.</span></span> <span data-ttu-id="02209-216">Un caractère **null** supplémentaire doit être ajouté à la fin du nom final pour indiquer la fin de **pFrom**.</span><span class="sxs-lookup"><span data-stu-id="02209-216">An additional **NULL** character must be appended to the end of the final name to indicate the end of **pFrom**.</span></span>

<span data-ttu-id="02209-217">Le membre **pTo** est une chaîne double terminée par un caractère **null**, similaire à **pFrom**.</span><span class="sxs-lookup"><span data-stu-id="02209-217">The **pTo** member is a double **null**-terminated string, much like **pFrom**.</span></span> <span data-ttu-id="02209-218">Le membre **pTo** contient les noms d’un ou de plusieurs noms de destination qualifiés complets.</span><span class="sxs-lookup"><span data-stu-id="02209-218">The **pTo** member contains the names of one or more fully qualified destination names.</span></span> <span data-ttu-id="02209-219">Elles sont compressées dans **pTo** de la même façon que pour les **pFrom**.</span><span class="sxs-lookup"><span data-stu-id="02209-219">They are packed into **pTo** in the same way as they are for **pFrom**.</span></span> <span data-ttu-id="02209-220">Si **pTo** contient plusieurs noms, vous devez également définir l’indicateur **FOF \_ MULTIDESTFILES** dans le membre **fFlags** .</span><span class="sxs-lookup"><span data-stu-id="02209-220">If **pTo** contains multiple names, you must also set the **FOF\_MULTIDESTFILES** flag in the **fFlags** member.</span></span> <span data-ttu-id="02209-221">L’utilisation de **pTo** dépend de l’opération, comme décrit ici.</span><span class="sxs-lookup"><span data-stu-id="02209-221">The usage of **pTo** depends on the operation as described here.</span></span>

-   <span data-ttu-id="02209-222">Pour les opérations de copie et de déplacement, si tous les fichiers sont dirigés vers un répertoire unique, **pTo** contient le nom de répertoire complet.</span><span class="sxs-lookup"><span data-stu-id="02209-222">For copy and move operations, if all the files are going to a single directory, **pTo** contains the fully qualified directory name.</span></span> <span data-ttu-id="02209-223">Si les fichiers sont destinés à des destinations différentes, la fonction **pTo** peut également contenir un nom de fichier ou de répertoire complet pour chaque fichier source.</span><span class="sxs-lookup"><span data-stu-id="02209-223">If the files are going to different destinations, **pTo** can also contain one fully qualified directory or file name for each source file.</span></span> <span data-ttu-id="02209-224">Si un répertoire n’existe pas, le système le crée.</span><span class="sxs-lookup"><span data-stu-id="02209-224">If a directory does not exist, the system creates it.</span></span>
-   <span data-ttu-id="02209-225">Pour les opérations de changement de nom, **pTo** contient un chemin d’accès complet pour chaque fichier source dans **pFrom**.</span><span class="sxs-lookup"><span data-stu-id="02209-225">For rename operations, **pTo** contains one fully qualified path for each source file in **pFrom**.</span></span>
-   <span data-ttu-id="02209-226">Pour les opérations de suppression, **pTo** n’est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="02209-226">For delete operations, **pTo** is not used.</span></span>

### <a name="notifying-the-shell"></a><span data-ttu-id="02209-227">Notification de l’interpréteur de commandes</span><span class="sxs-lookup"><span data-stu-id="02209-227">Notifying the Shell</span></span>

<span data-ttu-id="02209-228">Notifiez l’interpréteur de la modification après avoir utilisé [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) pour déplacer, copier, renommer ou supprimer des fichiers, ou après avoir effectué une autre action qui affecte l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="02209-228">Notify the Shell of the change after using [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) to move, copy, rename, or delete files, or after taking any other action that affects the namespace.</span></span> <span data-ttu-id="02209-229">Les actions qui doivent être accompagnées de notifications sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="02209-229">Actions that should be accompanied by notification include the following:</span></span>

-   <span data-ttu-id="02209-230">Ajout ou suppression de fichiers ou de dossiers.</span><span class="sxs-lookup"><span data-stu-id="02209-230">Adding or deleting files or folders.</span></span>
-   <span data-ttu-id="02209-231">Déplacement, copie ou attribution d’un nouveau nom aux fichiers ou dossiers.</span><span class="sxs-lookup"><span data-stu-id="02209-231">Moving, copying, or renaming files or folders.</span></span>
-   <span data-ttu-id="02209-232">Modification d’une association de fichiers.</span><span class="sxs-lookup"><span data-stu-id="02209-232">Changing a file association.</span></span>
-   <span data-ttu-id="02209-233">Modification des attributs de fichier.</span><span class="sxs-lookup"><span data-stu-id="02209-233">Changing file attributes.</span></span>
-   <span data-ttu-id="02209-234">Ajout ou suppression de lecteurs ou de supports de stockage.</span><span class="sxs-lookup"><span data-stu-id="02209-234">Adding or removing drives or storage media.</span></span>
-   <span data-ttu-id="02209-235">Création ou désactivation d’un dossier partagé.</span><span class="sxs-lookup"><span data-stu-id="02209-235">Creating or disabling a shared folder.</span></span>
-   <span data-ttu-id="02209-236">Modification de la liste d’images système.</span><span class="sxs-lookup"><span data-stu-id="02209-236">Changing the system image list.</span></span>

<span data-ttu-id="02209-237">Une application avertit l’interpréteur de commandes en appelant [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) avec les détails de ce qui a changé.</span><span class="sxs-lookup"><span data-stu-id="02209-237">An application notifies the Shell by calling [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) with the details of what has changed.</span></span> <span data-ttu-id="02209-238">L’interpréteur de commandes peut ensuite mettre à jour son image de l’espace de noms pour refléter précisément son nouvel État.</span><span class="sxs-lookup"><span data-stu-id="02209-238">The Shell can then update its image of the namespace to accurately reflect its new state.</span></span>

## <a name="simple-example-of-managing-files-with-shfileoperation"></a><span data-ttu-id="02209-239">Exemple simple de gestion de fichiers avec SHFileOperation</span><span class="sxs-lookup"><span data-stu-id="02209-239">Simple Example of Managing Files with SHFileOperation</span></span>

<span data-ttu-id="02209-240">L’exemple d’application console suivant illustre l’utilisation de [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) pour copier des fichiers d’un répertoire vers un autre.</span><span class="sxs-lookup"><span data-stu-id="02209-240">The following sample console application illustrates the use of [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) to copy files from one directory to another.</span></span> <span data-ttu-id="02209-241">Les répertoires source et de destination, C : \\ My \_ docs et c : \\ My \_ Docs2, sont codés en dur dans l’application pour des raisons de simplicité.</span><span class="sxs-lookup"><span data-stu-id="02209-241">The source and destination directories, C:\\My\_Docs and C:\\My\_Docs2, are hard-coded into the application for simplicity.</span></span>


```C++
#include <shlobj.h>
#include <shlwapi.h>
#include <strsafe.h>

int main(void)
{
    IShellFolder *psfDeskTop = NULL;
    IShellFolder *psfDocFiles = NULL;
    LPITEMIDLIST pidlDocFiles = NULL;
    LPITEMIDLIST pidlItems = NULL;
    IEnumIDList *ppenum = NULL;
    SHFILEOPSTRUCT sfo;
    STRRET strDispName;
    TCHAR szParseName[MAX_PATH];
    TCHAR szSourceFiles[256];
    int i;
    int iBufPos = 0;
    ULONG chEaten;
    ULONG celtFetched;
    size_t ParseNameSize = 0;
    HRESULT hr;
    

    szSourceFiles[0] = '\0';
    hr = SHGetDesktopFolder(&psfDeskTop);

    hr = psfDeskTop->ParseDisplayName(NULL, NULL, L"c:\\My_Docs", 
         &chEaten, &pidlDocFiles, NULL);
    hr = psfDeskTop->BindToObject(pidlDocFiles, NULL, IID_IShellFolder, 
         (LPVOID *) &psfDocFiles);
    hr = psfDeskTop->Release();

    hr = psfDocFiles->EnumObjects(NULL,SHCONTF_FOLDERS | SHCONTF_NONFOLDERS, 
         &ppenum);

    while( (hr = ppenum->Next(1,&pidlItems, &celtFetched)) == S_OK 
       && (celtFetched) == 1)
    {
        psfDocFiles->GetDisplayNameOf(pidlItems, SHGDN_FORPARSING, 
            &strDispName);
        StrRetToBuf(&strDispName, pidlItems, szParseName, MAX_PATH);
        
        hr = StringCchLength(szParseName, MAX_PATH, &ParseNameSize);
        
        if (SUCCEEDED(hr))
        {
            for(i=0; i<=ParseNameSize; i++)
            {
                szSourceFiles[iBufPos++] = szParseName[i];
            }
            CoTaskMemFree(pidlItems);
        }
    }
    ppenum->Release();
    
    szSourceFiles[iBufPos] = '\0';

    sfo.hwnd = NULL;
    sfo.wFunc = FO_COPY;
    sfo.pFrom = szSourceFiles;
    sfo.pTo = "c:\\My_Docs2\0";
    sfo.fFlags = FOF_SILENT | FOF_NOCONFIRMATION | FOF_NOCONFIRMMKDIR;

    hr = SHFileOperation(&sfo);
    
    SHChangeNotify(SHCNE_UPDATEDIR, SHCNF_PATH, (LPCVOID) "c:\\My_Docs2", 0);

    CoTaskMemFree(pidlDocFiles);
    psfDocFiles->Release();

    return 0;
}
```



<span data-ttu-id="02209-242">L’application récupère d’abord un pointeur vers l’interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) du bureau.</span><span class="sxs-lookup"><span data-stu-id="02209-242">The application first retrieves a pointer to the desktop's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="02209-243">Il récupère ensuite le PIDL du répertoire source en passant son chemin d’accès complet à [**IShellFolder ::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname).</span><span class="sxs-lookup"><span data-stu-id="02209-243">It then retrieves the source directory's PIDL by passing its fully qualified path to [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname).</span></span> <span data-ttu-id="02209-244">Notez que **IShellFolder ::P arsedisplayname** requiert que le chemin d’accès du répertoire soit une chaîne Unicode.</span><span class="sxs-lookup"><span data-stu-id="02209-244">Note that **IShellFolder::ParseDisplayName** requires the directory's path to be a Unicode string.</span></span> <span data-ttu-id="02209-245">L’application est ensuite liée au répertoire source et utilise son interface **IShellFolder** pour récupérer l’interface [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) d’un objet énumérateur.</span><span class="sxs-lookup"><span data-stu-id="02209-245">The application then binds to the source directory and uses its **IShellFolder** interface to retrieve an enumerator object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>

<span data-ttu-id="02209-246">À mesure que chaque fichier du répertoire source est énuméré, [**IShellFolder :: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) est utilisé pour récupérer son nom.</span><span class="sxs-lookup"><span data-stu-id="02209-246">As each file in the source directory is enumerated, [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) is used to retrieve its name.</span></span> <span data-ttu-id="02209-247">L' \_ indicateur SHGDN FORPARSING est défini, ce qui amène **IShellFolder :: GetDisplayNameOf** à retourner le chemin d’accès qualifié complet du fichier.</span><span class="sxs-lookup"><span data-stu-id="02209-247">The SHGDN\_FORPARSING flag is set, which causes **IShellFolder::GetDisplayNameOf** to return the file's fully qualified path.</span></span> <span data-ttu-id="02209-248">Les chemins d’accès aux fichiers, y compris les caractères **null** de fin, sont concaténés dans un tableau unique, *szSourceFiles*.</span><span class="sxs-lookup"><span data-stu-id="02209-248">The file paths, including the terminating **NULL** characters, are concatenated into a single array, *szSourceFiles*.</span></span> <span data-ttu-id="02209-249">Un deuxième caractère **null** est ajouté au chemin final pour terminer correctement le tableau.</span><span class="sxs-lookup"><span data-stu-id="02209-249">A second **NULL** character is appended to the final path to terminate the array properly.</span></span>

<span data-ttu-id="02209-250">Une fois l’énumération terminée, l’application assigne des valeurs à une structure [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) .</span><span class="sxs-lookup"><span data-stu-id="02209-250">Once the enumeration is complete, the application assigns values to an [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) structure.</span></span> <span data-ttu-id="02209-251">Notez que le tableau affecté à **pTo** pour spécifier la destination doit également se terminer par une valeur double **null**.</span><span class="sxs-lookup"><span data-stu-id="02209-251">Note that the array assigned to **pTo** to specify the destination must also be terminated by a double **NULL**.</span></span> <span data-ttu-id="02209-252">Dans ce cas, il est simplement inclus dans la chaîne qui est assignée à **pTo**.</span><span class="sxs-lookup"><span data-stu-id="02209-252">In this case, it is simply included in the string that is assigned to **pTo**.</span></span> <span data-ttu-id="02209-253">Étant donné qu’il s’agit d’une application console, les \_ indicateurs FOF Silent, FOF \_ noconfirm et FOF \_ NOCONFIRMMKDIR sont définis de manière à supprimer toutes les boîtes de dialogue susceptibles d’apparaître.</span><span class="sxs-lookup"><span data-stu-id="02209-253">Because this is a console application, the FOF\_SILENT, FOF\_NOCONFIRMATION, and FOF\_NOCONFIRMMKDIR flags are set to suppress any dialog boxes that might appear.</span></span> <span data-ttu-id="02209-254">Une fois [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) retourné, [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) est appelé pour avertir l’interpréteur de la modification.</span><span class="sxs-lookup"><span data-stu-id="02209-254">After [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) returns, [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) is called to notify the Shell of the change.</span></span> <span data-ttu-id="02209-255">L’application effectue ensuite le nettoyage habituel et retourne.</span><span class="sxs-lookup"><span data-stu-id="02209-255">Then the application performs the usual cleanup and returns.</span></span>

## <a name="adding-files-to-the-shells-list-of-recent-documents"></a><span data-ttu-id="02209-256">Ajout de fichiers à la liste des documents récents de l’interpréteur de commandes</span><span class="sxs-lookup"><span data-stu-id="02209-256">Adding Files to the Shell's List of Recent Documents</span></span>

<span data-ttu-id="02209-257">L’interpréteur de commandes gère une liste de documents récemment ajoutés ou modifiés pour chaque utilisateur.</span><span class="sxs-lookup"><span data-stu-id="02209-257">The Shell maintains a list of recently added or modified documents for each user.</span></span> <span data-ttu-id="02209-258">L’utilisateur peut afficher une liste de liens vers ces fichiers en cliquant sur documents dans le menu Démarrer.</span><span class="sxs-lookup"><span data-stu-id="02209-258">The user can display a list of links to these files by clicking Documents on the Start menu.</span></span> <span data-ttu-id="02209-259">Comme avec mes documents, chaque utilisateur dispose d’un répertoire de système de fichiers pour stocker les liens réels.</span><span class="sxs-lookup"><span data-stu-id="02209-259">As with My Documents, each user has a file system directory to hold the actual links.</span></span> <span data-ttu-id="02209-260">Pour récupérer le PIDL de l’annuaire récent de l’utilisateur actuel, votre application peut appeler [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) avec CSIDL \_ récent ou appeler [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) pour récupérer son chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="02209-260">To retrieve the PIDL of the current user's Recent directory, your application can call [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) with CSIDL\_RECENT, or call [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) to retrieve its path.</span></span>

<span data-ttu-id="02209-261">Votre application peut énumérer le contenu du dossier récent à l’aide des techniques présentées plus haut dans ce document.</span><span class="sxs-lookup"><span data-stu-id="02209-261">Your application can enumerate the contents of the Recent folder using the techniques discussed earlier in this document.</span></span> <span data-ttu-id="02209-262">Toutefois, une application ne doit pas modifier le contenu du dossier comme s’il s’agissait d’un dossier de système de fichiers normal.</span><span class="sxs-lookup"><span data-stu-id="02209-262">However, an application should not modify the contents of the folder as if it were a normal file system folder.</span></span> <span data-ttu-id="02209-263">Si c’est le cas, la liste des documents récents de l’interpréteur de commandes ne sera pas mise à jour correctement et les modifications ne seront pas reflétées dans le menu Démarrer.</span><span class="sxs-lookup"><span data-stu-id="02209-263">If it does so, the Shell's list of recent documents will not be updated properly, and the changes will not be reflected in the Start menu.</span></span> <span data-ttu-id="02209-264">Au lieu de cela, pour ajouter un lien de document au dossier récent d’un utilisateur, votre application peut appeler [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span><span class="sxs-lookup"><span data-stu-id="02209-264">Instead, to add a document link to a user's Recent folder, your application can call [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span> <span data-ttu-id="02209-265">L’interpréteur de commandes ajoutera un lien au dossier du système de fichiers approprié et mettra à jour sa liste de documents récents et le menu Démarrer.</span><span class="sxs-lookup"><span data-stu-id="02209-265">The Shell will add a link to the appropriate file system folder, as well as updating its list of recent documents and the Start menu.</span></span> <span data-ttu-id="02209-266">Vous pouvez également utiliser cette fonction pour effacer le dossier.</span><span class="sxs-lookup"><span data-stu-id="02209-266">You can also use this function to clear the folder.</span></span>

 

 
