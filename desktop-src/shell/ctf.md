---
description: Indicateurs qui contrôlent le comportement de la fonction appelante. Utilisé par SHCreateThread et SHCreateThreadWithHandle. Dans ces fonctions, ces valeurs sont définies comme étant de type SHCT \_ Flags.
title: Indicateurs CTF (Shlwapi. h)
ms.topic: reference
ms.date: 05/31/2018
ms.assetid: 66cda866-7a39-4c5a-a795-a4c5c64cbab7
api_name:
- CTF_INSIST
- CTF_THREAD_REF
- CTF_PROCESS_REF
- CTF_COINIT_STA
- CTF_COINIT
- CTF_FREELIBANDEXIT
- CTF_REF_COUNTED
- CTF_WAIT_ALLOWCOM
- CTF_UNUSED
- CTF_INHERITWOW64
- CTF_WAIT_NO_REENTRANCY
- CTF_KEYBOARD_LOCALE
- CTF_OLEINITIALIZE
- CTF_COINIT_MTA
- CTF_NOADDREFLIB
api_type:
- HeaderDef
api_location:
- Shlwapi.h
topic_type:
- APIRef
- kbSyntax
ms.openlocfilehash: db0f33daecc4abcbfbc9972d0607f4817bc7ecff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104972031"
---
# <a name="ctf-flags"></a>Indicateurs CTF

Indicateurs qui contrôlent le comportement de la fonction appelante. Utilisé par [**SHCreateThread**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread) et [**SHCreateThreadWithHandle**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle). Dans ces fonctions, ces valeurs sont définies comme étant de type SHCT \_ Flags.



| Constante/valeur                                                                                                                                                                                                                                             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="CTF_INSIST"></span><span id="ctf_insist"></span><dl> <dt>**CTF \_ INSISTer**</dt> sur <dt>0x00000001</dt> </dl>                                       | 0x00000001. Si la tentative de création du thread avec [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) échoue, la définition de cet indicateur entraîne l’appel synchrone de la fonction vers laquelle pointe *pfnThreadProc* à partir du thread appelant. Cet indicateur peut être utilisé uniquement si *pfnCallback* a la **valeur null**.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_THREAD_REF"></span><span id="ctf_thread_ref"></span><dl> <dt>**CTF \_ \_Réf**</dt> . du thread <dt>0x00000002</dt> </dl>                          | 0x00000002. Placez une référence au thread de création pour la durée de l’appel à la fonction vers laquelle pointe *pfnThreadProc*. Cette référence doit avoir été définie avec [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span id="CTF_PROCESS_REF"></span><span id="ctf_process_ref"></span><dl> <dt>**CTF \_ TRAITER la \_ référence**</dt> <dt>0x00000004</dt> </dl>                       | 0x00000004. Maintenez une référence au processus de l’Explorateur Windows pendant la durée de l’appel à la fonction vers laquelle pointe *pfnThreadProc*. Cet indicateur est utile pour les [gestionnaires d’extensions de Shell](handlers.md), qui peuvent nécessiter la fermeture prématurée du processus de l’Explorateur Windows. Cette action est utile pendant des tâches telles que l’utilisation d’un thread d’arrière-plan ou la copie de fichiers. Pour plus d’informations, consultez [**SHGetInstanceExplorer**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetinstanceexplorer).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_COINIT_STA"></span><span id="ctf_coinit_sta"></span><dl> <dt>**CTF \_ Coinit \_ STA**</dt> <dt>0x00000008</dt> </dl>                          | 0x00000008. Initialisez COM en tant que thread cloisonné (STA, Single-Threaded Apartment) pour le thread créé avant d’appeler la fonction facultative désignée par *pfnCallback* ou la fonction vers laquelle pointe *pfnThreadProc*. Cet indicateur est utile lorsque COM doit être initialisé pour un thread. COM sera automatiquement non initialisé.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="CTF_COINIT"></span><span id="ctf_coinit"></span><dl> <dt>**CTF \_ Coinit**</dt> <dt>0x00000008</dt> </dl>                                       | Équivalent à CTF \_ coinit \_ STA.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span id="CTF_FREELIBANDEXIT"></span><span id="ctf_freelibandexit"></span><dl> <dt>**CTF \_ FREELIBANDEXIT**</dt> <dt>0x00000010</dt> </dl>               | 0x00000010. **Internet Explorer 6 ou version ultérieure.** [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) sera appelé sur la dll qui contient la fonction *pfnThreadProc* pour empêcher son déchargement. Une fois *pfnThreadProc* retourné, la dll est libérée avec [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary), ce qui décrémente le nombre de références de dll. Transmettez cet indicateur pour empêcher la déchargement de la DLL prématurément. par exemple, par [**coFreeUnusedLibraries**](/windows/win32/api/combaseapi/nf-combaseapi-cofreeunusedlibraries). Notez que si cet indicateur est passé, la fonction *pfnThreadProc* doit résider dans une dll. Cet indicateur est implicite dans Windows Vista et versions ultérieures.<br/>                                                                                                                                                                                                                                                                   |
| <span id="CTF_REF_COUNTED"></span><span id="ctf_ref_counted"></span><dl> <dt>**CTF \_ Réf \_**</dt> . de référence <dt>0x00000020</dt> </dl>                       | 0x00000020. **Internet Explorer 6 ou version ultérieure.** Une référence de thread est automatiquement créée pour le thread créé et définie avec [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref). Une fois le *pfnThreadProc* retourné, la référence de thread est libérée et les messages sont envoyés jusqu’à ce que le décompte de références sur la référence de thread perde à zéro, autrement dit, jusqu’à ce que les threads dépendants du thread créé aient émis leurs références.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_WAIT_ALLOWCOM"></span><span id="ctf_wait_allowcom"></span><dl> <dt>**CTF \_ WAIT \_ ALLOWCOM**</dt> <dt>0x00000040</dt> </dl>                 | 0x00000040. **Internet Explorer 6 ou version ultérieure.** Le thread appelant attend et pompe les messages COM et [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) . Si la procédure synchrone tente d’envoyer un message Windows avec **SendMessage** à une fenêtre hébergée sur le thread appelant, le message s’affiche correctement. Si la procédure synchrone tente d’utiliser COM pour communiquer avec un objet STA hébergé sur le thread appelant, l’appel de fonction parviendra à atteindre l’objet prévu. Le thread appelant est ouvert pour la réentrance de fragilité. Alors que le thread appelant peut gérer l’utilisation de **SendMessage** et com par la procédure synchrone, si d’autres threads utilisent **SendMessage** ou com pour communiquer avec des objets hébergés sur le thread appelant, il peut s’agir de messages ou d’appels de fonction inattendus qui sont traités pendant que la procédure synchrone est terminée.<br/> |
| <span id="CTF_UNUSED"></span><span id="ctf_unused"></span><dl> <dt>**CTF \_ 0x00000080 inutilisé**</dt> <dt></dt> </dl>                                       | 0x00000080. **Internet Explorer 7 ou version ultérieure.** Non utilisé.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_INHERITWOW64"></span><span id="ctf_inheritwow64"></span><dl> <dt>**CTF \_ INHERITWOW64**</dt> <dt>0x00000100</dt> </dl>                     | 0x00000100. **Internet Explorer 7 ou version ultérieure.** Le nouveau thread hérite de l’état de désactivation de Windows sur Windows 64 bits (WOW64) pour le redirecteur du système de fichiers.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_WAIT_NO_REENTRANCY"></span><span id="ctf_wait_no_reentrancy"></span><dl> <dt>**CTF \_ WAIT \_ no \_ Reentry**</dt> <dt>0x00000200</dt> </dl> | 0x00000200. **Windows Vista ou version ultérieure.** Le thread appelant bloque tous les autres processus en attendant que la procédure synchrone s’exécute sur le nouveau thread. Si la procédure synchrone tente d’envoyer un message Windows avec [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) à une fenêtre hébergée sur le thread appelant, cela provoque un interblocage de la procédure synchrone. Si la procédure synchrone tente d’utiliser COM pour communiquer avec un objet STA hébergé sur le thread appelant, cela entraîne également l’interblocage de la procédure synchrone. Le thread appelant est protégé contre tous les problèmes de nouvelle entrée en spécifiant cet indicateur.<br/>                                                                                                                                                                                                                                                                |
| <span id="CTF_KEYBOARD_LOCALE"></span><span id="ctf_keyboard_locale"></span><dl> <dt>**CTF \_ \_Paramètres régionaux du clavier**</dt> <dt>0x00000400</dt> </dl>           | 0x00000400. **Windows 7 ou version ultérieure.** Utilisez les paramètres régionaux clavier du thread d’origine dans le nouveau thread qu’il génère.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_OLEINITIALIZE"></span><span id="ctf_oleinitialize"></span><dl> <dt>**CTF \_**</dt> <dt>0x00000800</dt> OLEINITIALIZE </dl>                  | 0x00000800. **Windows 7 ou version ultérieure.** Initialiser COM avec le modèle STA (Single-Threaded Apartment) pour le thread créé.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_COINIT_MTA"></span><span id="ctf_coinit_mta"></span><dl> <dt>**CTF \_ 0x00001000 \_ MTA de COinit**</dt> <dt></dt> </dl>                          | 0x00001000. **Windows 7 et versions ultérieures**. Initialiser COM avec le modèle multithread cloisonné (MTA) pour le thread créé.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_NOADDREFLIB"></span><span id="ctf_noaddreflib"></span><dl> <dt>**CTF \_ NOADDREFLIB**</dt> <dt>0x00002000</dt> </dl>                        | 0x00002000. **Windows 7 ou version ultérieure.** Cet indicateur est essentiellement l’opposé de CTF \_ FREELIBANDEXIT. Cela évite les appels [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) / [**FreeLibraryAndExitThread**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibraryandexitthread) qui peuvent entraîner une contention du verrouillage du chargeur. Utilisez CTF \_ NOADDREFLIB uniquement lorsque le nouveau thread a des moyens de s’assurer que le code de la procédure de thread d’origine reste chargé. Cette valeur ne doit pas être utilisée dans le contexte d’objets COM, car les objets COM doivent s’assurer que la DLL reste chargée (normalement, COM décharge les dll).<br/>                                                                                                                                                                                                                                                                                                                    |



## <a name="remarks"></a>Notes

Si aucun \_ indicateur d’attente CTF \_ n’est spécifié, le thread appelant attendra et enverra des messages [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) . Si la procédure synchrone tente d’envoyer un message Windows avec **SendMessage** à une fenêtre hébergée sur le thread appelant, le message s’affiche dans la fenêtre prévue. Si la procédure synchrone tente d’utiliser COM pour communiquer avec un objet STA hébergé sur le thread appelant, la procédure synchrone se bloquera. Le thread appelant est ouvert pour la réentrance de fragilité. Alors que le thread appelant peut gérer l’utilisation de **SendMessage** de la procédure synchrone, si d’autres threads utilisent **SendMessage** pour communiquer avec une fenêtre hébergée sur le thread appelant, ces messages peuvent être inattendus. Cela peut entraîner leur traitement pendant l’exécution de la procédure synchrone.

## <a name="requirements"></a>Spécifications



| Condition requise | Valeur |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Client minimal pris en charge<br/> | Applications de bureau Windows 2000 professionnel, Windows XP, Windows 7 \[ uniquement\]<br/>    |
| Serveur minimal pris en charge<br/> | Windows 2000 Server - \[Applications de bureau uniquement\]<br/>                                 |
| En-tête<br/>                   | <dl> <dt>Shlwapi. h</dt> </dl> |



 

 
