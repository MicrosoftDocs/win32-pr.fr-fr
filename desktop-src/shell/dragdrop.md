---
description: De nombreuses applications permettent aux utilisateurs de transférer des données vers une autre application en les faisant glisser et en les déposant avec la souris, ou à l’aide du presse-papiers.
title: Transfert d’objets Shell avec glisser-déplacer et le presse-papiers
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bd73098b-2f69-48a4-bb06-e1e0a452e69d
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: b04523d0ae22eac7bef68f37a6d22ac94b21e303
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104973246"
---
# <a name="transferring-shell-objects-with-drag-and-drop-and-the-clipboard"></a><span data-ttu-id="c0a8b-103">Transfert d’objets Shell avec glisser-déplacer et le presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c0a8b-103">Transferring Shell Objects with Drag-and-Drop and the Clipboard</span></span>

<span data-ttu-id="c0a8b-104">De nombreuses applications permettent aux utilisateurs de transférer des données vers une autre application en les faisant glisser et en les déposant avec la souris, ou à l’aide du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-104">Many applications allow users to transfer data to another application by dragging and dropping the data with the mouse, or by using the Clipboard.</span></span> <span data-ttu-id="c0a8b-105">Parmi les nombreux types de données qu’il est possible de transférer, citons les objets Shell tels que les fichiers ou les dossiers.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-105">Among the many types of data that can be transferred are Shell objects such as files or folders.</span></span> <span data-ttu-id="c0a8b-106">Le transfert de données Shell peut avoir lieu entre deux applications, mais les utilisateurs peuvent également transférer des données de l’interpréteur de commandes vers ou à partir du bureau ou de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-106">Shell data transfer can take place between two applications, but users can also transfer Shell data to or from the desktop or Windows Explorer.</span></span>

<span data-ttu-id="c0a8b-107">Bien que les fichiers soient l’objet Shell le plus couramment transféré, le transfert de données Shell peut impliquer l’un des nombreux objets trouvés dans l' [espace de noms Shell](namespace-intro.md).</span><span class="sxs-lookup"><span data-stu-id="c0a8b-107">Although files are the most commonly transferred Shell object, Shell data transfer can involve any of the variety of objects found in the [Shell namespace](namespace-intro.md).</span></span> <span data-ttu-id="c0a8b-108">Par exemple, votre application peut être amenée à transférer un fichier vers un dossier virtuel, tel que la corbeille, ou à accepter un objet à partir d’une extension d’espace de noms non-Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-108">For instance, your application might need to transfer a file to a virtual folder such as the Recycle Bin, or accept an object from a non-Microsoft namespace extension.</span></span> <span data-ttu-id="c0a8b-109">Si vous implémentez une extension d’espace de noms, elle doit pouvoir se comporter correctement comme source de déplacement et cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-109">If you are implementing a namespace extension, it must be able to behave properly as a drop source and target.</span></span>

<span data-ttu-id="c0a8b-110">Ce document explique comment les applications peuvent implémenter les transferts de données par glisser-déplacer et le presse-papiers avec des objets Shell.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-110">This document discusses how applications can implement drag-and-drop and Clipboard data transfers with Shell objects.</span></span>

-   [<span data-ttu-id="c0a8b-111">Objet de données de l’interpréteur de commandes</span><span class="sxs-lookup"><span data-stu-id="c0a8b-111">The Shell Data Object</span></span>](dataobject.md)
-   [<span data-ttu-id="c0a8b-112">Formats de presse-papiers de Shell</span><span class="sxs-lookup"><span data-stu-id="c0a8b-112">Shell Clipboard Formats</span></span>](clipboard.md)
-   [<span data-ttu-id="c0a8b-113">Gestion des scénarios de transfert de données de Shell</span><span class="sxs-lookup"><span data-stu-id="c0a8b-113">Handling Shell Data Transfer Scenarios</span></span>](datascenarios.md)

## <a name="how-drag-and-drop-works-with-shell-objects"></a><span data-ttu-id="c0a8b-114">Fonctionnement du glisser-déplacer avec les objets Shell</span><span class="sxs-lookup"><span data-stu-id="c0a8b-114">How Drag-and-Drop Works with Shell Objects</span></span>

<span data-ttu-id="c0a8b-115">Les applications doivent souvent fournir aux utilisateurs un moyen de transférer des données de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-115">Applications often need to provide users with a way to transfer Shell data.</span></span> <span data-ttu-id="c0a8b-116">Voici quelques exemples :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-116">Some examples are:</span></span>

-   <span data-ttu-id="c0a8b-117">En faisant glisser un fichier à partir de l’Explorateur Windows ou du bureau, puis en le déposant sur une application.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-117">Dragging a file from Windows Explorer or the desktop and dropping it on an application.</span></span>
-   <span data-ttu-id="c0a8b-118">Copie d’un fichier dans le presse-papiers dans l’Explorateur Windows et collage dans une application.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-118">Copying a file to the Clipboard in Windows Explorer and pasting it into an application.</span></span>
-   <span data-ttu-id="c0a8b-119">Glissement d’un fichier d’une application vers la corbeille.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-119">Dragging a file from an application to the Recycle Bin.</span></span>

<span data-ttu-id="c0a8b-120">Pour obtenir une présentation détaillée de la façon de gérer ces scénarios et d’autres, consultez Gestion des scénarios de Transfert de données de l' [interpréteur](datascenarios.md)de commandes.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-120">For a detailed discussion of how to handle these and other scenarios, see [Handling Shell Data Transfer Scenarios](datascenarios.md).</span></span> <span data-ttu-id="c0a8b-121">Ce document se concentre sur les principes généraux sous-jacents au transfert de données Shell.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-121">This document focuses on the general principles behind Shell data transfer.</span></span>

<span data-ttu-id="c0a8b-122">Windows fournit deux méthodes standard pour les applications de transfert des données de l’interpréteur de commandes :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-122">Windows provides two standard ways for applications to transfer Shell data:</span></span>

-   <span data-ttu-id="c0a8b-123">Un utilisateur coupe ou copie des données de l’interpréteur de commandes, par exemple un ou plusieurs fichiers, dans le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-123">A user cuts or copies Shell data, such as one or more files, to the Clipboard.</span></span> <span data-ttu-id="c0a8b-124">L’autre application récupère les données du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-124">The other application retrieves the data from the Clipboard.</span></span>
-   <span data-ttu-id="c0a8b-125">Un utilisateur fait glisser une icône qui représente les données de l’application source et dépose l’icône sur une fenêtre appartenant à la cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-125">A user drags an icon that represents the data from the source application and drops the icon on a window owned by the target.</span></span>

<span data-ttu-id="c0a8b-126">Dans les deux cas, les données transférées sont contenues dans un *objet de données*.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-126">In both cases, the transferred data is contained in a *data object*.</span></span> <span data-ttu-id="c0a8b-127">Les objets de données sont des objets COM (Component Object Model) qui exposent l’interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) .</span><span class="sxs-lookup"><span data-stu-id="c0a8b-127">Data objects are Component Object Model (COM) objects that expose the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="c0a8b-128">Schématiquement, il existe trois étapes essentielles que tous les transferts de données de Shell doivent suivre :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-128">Schematically, there are three essential steps that all Shell data transfers must follow:</span></span>

1.  <span data-ttu-id="c0a8b-129">La source crée un objet de données qui représente les données à transférer.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-129">The source creates a data object that represents the data that is to be transferred.</span></span>
2.  <span data-ttu-id="c0a8b-130">La cible reçoit un pointeur vers l’interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) de l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-130">The target receives a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
3.  <span data-ttu-id="c0a8b-131">La cible appelle l’interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pour en extraire les données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-131">The target calls the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface to extract the data from it.</span></span>

<span data-ttu-id="c0a8b-132">La différence entre les transferts de données du presse-papiers et du glisser-déplacer réside principalement dans la manière dont le pointeur [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) est transféré de la source à la cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-132">The difference between Clipboard and drag-and-drop data transfers lies primarily in how the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer is transferred from the source to the target.</span></span>

### <a name="clipboard-data-transfers"></a><span data-ttu-id="c0a8b-133">Transferts de données du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="c0a8b-133">Clipboard Data Transfers</span></span>

<span data-ttu-id="c0a8b-134">Le presse-papiers est le moyen le plus simple pour transférer des données de Shell.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-134">The Clipboard is the simplest way to transfer Shell data.</span></span> <span data-ttu-id="c0a8b-135">La procédure de base est similaire aux transferts de données du presse-papiers standard.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-135">The basic procedure is similar to standard Clipboard data transfers.</span></span> <span data-ttu-id="c0a8b-136">Toutefois, étant donné que vous transférez un pointeur vers un objet de données, et non les données lui-même, vous devez utiliser l’API du presse-papiers OLE au lieu de l’API du presse-papiers standard.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-136">However, because you are transferring a pointer to a data object, not the data itself, you must use the OLE clipboard API instead of the standard clipboard API.</span></span> <span data-ttu-id="c0a8b-137">La procédure suivante décrit comment utiliser l’API du presse-papiers OLE pour transférer des données de l’interpréteur de commandes avec le presse-papiers :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-137">The following procedure outlines how to use the OLE clipboard API to transfer Shell data with the Clipboard:</span></span>

1.  <span data-ttu-id="c0a8b-138">La source de données crée un objet de données pour contenir les données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-138">The data source creates a data object to contain the data.</span></span>
2.  <span data-ttu-id="c0a8b-139">La source de données appelle [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), qui place un pointeur vers l’interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) de l’objet de données dans le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-139">The data source calls [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), which places a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface on the Clipboard.</span></span>
3.  <span data-ttu-id="c0a8b-140">La cible appelle [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) pour récupérer le pointeur vers l’interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) de l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-140">The target calls [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) to retrieve the pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
4.  <span data-ttu-id="c0a8b-141">La cible extrait les données en appelant la méthode [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) .</span><span class="sxs-lookup"><span data-stu-id="c0a8b-141">The target extracts the data by calling the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span>
5.  <span data-ttu-id="c0a8b-142">Avec certains transferts de données de l’interpréteur de commandes, la cible peut également avoir besoin d’appeler la méthode [**IDataObject :: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) de l’objet de données pour fournir des commentaires à l’objet de données sur le résultat du transfert de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-142">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the data object on the outcome of the data transfer.</span></span> <span data-ttu-id="c0a8b-143">Pour obtenir un exemple de ce type d’opération, consultez [gestion des opérations de déplacement optimisées](datascenarios.md) .</span><span class="sxs-lookup"><span data-stu-id="c0a8b-143">See [Handling Optimized Move Operations](datascenarios.md) for an example of this type of operation.</span></span>

### <a name="drag-and-drop-data-transfers"></a><span data-ttu-id="c0a8b-144">Transfert de données par glisser-déplacer</span><span class="sxs-lookup"><span data-stu-id="c0a8b-144">Drag-and-Drop Data Transfers</span></span>

<span data-ttu-id="c0a8b-145">Bien qu’un peu plus complexe à implémenter, le transfert de données par glisser-déplacer présente des avantages significatifs par rapport au Presse-papiers :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-145">While somewhat more complex to implement, drag-and-drop data transfer has some significant advantages over the Clipboard:</span></span>

-   <span data-ttu-id="c0a8b-146">Les transferts par glisser-déplacer peuvent être effectués à l’aide d’un simple déplacement de souris, ce qui rend l’opération plus flexible et intuitive à utiliser que le presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-146">Drag-and-drop transfers can be done with a simple mouse movement, making operation more flexible and intuitive to use than the Clipboard.</span></span>
-   <span data-ttu-id="c0a8b-147">Le glisser-déplacer fournit à l’utilisateur une représentation visuelle de l’opération.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-147">Drag-and-drop provides the user with a visual representation of the operation.</span></span> <span data-ttu-id="c0a8b-148">L’utilisateur peut suivre l’icône lorsqu’il passe de la source à la cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-148">The user can follow the icon as it moves from source to target.</span></span>
-   <span data-ttu-id="c0a8b-149">Le glisser-déplacer notifie la cible lorsque les données sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-149">Drag-and-drop notifies the target when the data is available.</span></span>

<span data-ttu-id="c0a8b-150">Les opérations de glisser-déplacer utilisent également des objets de données pour transférer des données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-150">Drag-and-drop operations also use data objects to transfer data.</span></span> <span data-ttu-id="c0a8b-151">Toutefois, la source de déplacement doit fournir des fonctionnalités au-delà de celles requises pour les transferts du presse-papiers :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-151">However, the drop source must provide functionality beyond that required for Clipboard transfers:</span></span>

-   <span data-ttu-id="c0a8b-152">La source de déplacement doit également créer un objet qui expose une interface [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) .</span><span class="sxs-lookup"><span data-stu-id="c0a8b-152">The drop source must also create an object that exposes an [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface.</span></span> <span data-ttu-id="c0a8b-153">Le système utilise **IDropSource** pour communiquer avec la source pendant que l’opération est en cours.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-153">The system uses **IDropSource** to communicate with the source while the operation is in progress.</span></span>
-   <span data-ttu-id="c0a8b-154">L’objet de données glisser-déplacer est chargé de suivre le déplacement du curseur et d’afficher une icône pour représenter l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-154">The drag-and-drop data object is responsible for tracking cursor movement and displaying an icon to represent the data object.</span></span>

<span data-ttu-id="c0a8b-155">Les cibles de dépôt doivent également fournir plus de fonctionnalités que nécessaire pour gérer les transferts du presse-papiers :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-155">Drop targets must also provide more functionality than is needed to handle Clipboard transfers:</span></span>

-   <span data-ttu-id="c0a8b-156">La cible de déplacement doit exposer une interface [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="c0a8b-156">The drop target must expose an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="c0a8b-157">Lorsque le curseur se trouve sur une fenêtre cible, le système utilise **IDropTarget** pour fournir à la cible des informations telles que la position du curseur et l’avertir lorsque les données sont supprimées.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-157">When the cursor is over a target window, the system uses **IDropTarget** to provide the target with information such as the cursor position, and to notify it when the data is dropped.</span></span>
-   <span data-ttu-id="c0a8b-158">La cible de déplacement doit s’inscrire auprès du système en appelant [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span><span class="sxs-lookup"><span data-stu-id="c0a8b-158">The drop target must register itself with the system by calling [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span></span> <span data-ttu-id="c0a8b-159">Cette fonction fournit au système le handle d’une fenêtre cible et un pointeur vers l’interface [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) de l’application cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-159">This function provides the system with the handle to a target window and a pointer to the target application's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span>

> [!Note]  
> <span data-ttu-id="c0a8b-160">Pour les opérations de glisser-déplacer, votre application doit initialiser COM avec [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), et non [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span><span class="sxs-lookup"><span data-stu-id="c0a8b-160">For drag-and-drop operations, your application must initialize COM with [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), not [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span></span>

 

<span data-ttu-id="c0a8b-161">La procédure suivante décrit les étapes essentielles qui sont généralement utilisées pour transférer des données de Shell avec le glisser-déplacer :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-161">The following procedure outlines the essential steps that are typically used to transfer Shell data with drag-and-drop:</span></span>

1.  <span data-ttu-id="c0a8b-162">La cible appelle [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) pour fournir au système un pointeur vers son interface [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) et enregistrer une fenêtre comme cible de déplacement.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-162">The target calls [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) to give the system a pointer to its [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface and register a window as a drop target.</span></span>
2.  <span data-ttu-id="c0a8b-163">Lorsque l’utilisateur démarre une opération de glisser-déplacer, la source crée un objet de données et lance une *boucle de glissement* en appelant [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span><span class="sxs-lookup"><span data-stu-id="c0a8b-163">When the user starts a drag-and-drop operation, the source creates a data object and initiates a *drag loop* by calling [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span></span>
3.  <span data-ttu-id="c0a8b-164">Lorsque le curseur se trouve sur la fenêtre cible, le système notifie la cible en appelant l’une des méthodes [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) de la cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-164">When the cursor is over the target window, the system notifies the target by calling one of the target's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) methods.</span></span> <span data-ttu-id="c0a8b-165">Le système appelle [**IDropTarget ::D ragenter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) lorsque le curseur entre dans la fenêtre cible, et [**IDropTarget ::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) lorsque le curseur passe au-dessus de la fenêtre cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-165">The system calls [**IDropTarget::DragEnter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) when the cursor enters the target window, and [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) as the cursor passes over the target window.</span></span> <span data-ttu-id="c0a8b-166">Les deux méthodes fournissent la cible de déplacement avec la position actuelle du curseur et l’état des touches de modification du clavier, telles que CTRL ou ALT.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-166">Both methods provide the drop target with the current cursor position and the state of keyboard modifier keys such as CTRL or ALT.</span></span> <span data-ttu-id="c0a8b-167">Lorsque le curseur quitte la fenêtre cible, le système notifie la cible en appelant [**IDropTarget ::D ragleave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span><span class="sxs-lookup"><span data-stu-id="c0a8b-167">When the cursor leaves the target window, the system notifies the target by calling [**IDropTarget::DragLeave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span></span> <span data-ttu-id="c0a8b-168">Quand l’une de ces méthodes retourne, le système appelle l’interface [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) pour passer la valeur de retour à la source.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-168">When any of these methods return, the system calls the [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface to pass the return value to the source.</span></span>
4.  <span data-ttu-id="c0a8b-169">Quand l’utilisateur relâche le bouton de la souris pour supprimer les données, le système appelle la méthode [**IDropTarget ::D ROP**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) de la cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-169">When the user releases the mouse button to drop the data, the system calls the target's [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) method.</span></span> <span data-ttu-id="c0a8b-170">Parmi les paramètres de la méthode se trouve un pointeur vers l’interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) de l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-170">Among the method's parameters is a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
5.  <span data-ttu-id="c0a8b-171">La cible appelle la méthode [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) de l’objet de données pour extraire les données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-171">The target calls the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to extract the data.</span></span>
6.  <span data-ttu-id="c0a8b-172">Avec certains transferts de données de l’interpréteur de commandes, la cible peut également avoir besoin d’appeler la méthode [**IDataObject :: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) de l’objet de données pour fournir des commentaires à la source sur le résultat du transfert de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-172">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the source on the outcome of the data transfer.</span></span>
7.  <span data-ttu-id="c0a8b-173">Lorsque la cible est terminée avec l’objet de données, elle retourne à partir de [**IDropTarget ::D ROP**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span><span class="sxs-lookup"><span data-stu-id="c0a8b-173">When the target is finished with the data object, it returns from [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span></span> <span data-ttu-id="c0a8b-174">Le système retourne l’appel [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) de la source pour notifier la source que le transfert de données est terminé.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-174">The system returns the source's [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) call to notify the source that the data transfer is complete.</span></span>
8.  <span data-ttu-id="c0a8b-175">Selon le [scénario de transfert de données](datascenarios.md)particulier, la source devra peut-être effectuer des actions supplémentaires en fonction de la valeur retournée par [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) et des valeurs passées à l’objet de données par la cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-175">Depending on the particular [data transfer scenario](datascenarios.md), the source might need to take additional action based on the value returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) and the values that are passed to the data object by the target.</span></span> <span data-ttu-id="c0a8b-176">Par exemple, lorsqu’un fichier est déplacé, la source doit vérifier ces valeurs pour déterminer si elle doit supprimer le fichier d’origine.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-176">For instance, when a file is moved, the source must check these values to determine whether it must delete the original file.</span></span>
9.  <span data-ttu-id="c0a8b-177">La source libère l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-177">The source releases the data object.</span></span>

<span data-ttu-id="c0a8b-178">Bien que les procédures décrites ci-dessus fournissent un bon modèle général pour le transfert de données de Shell, il existe de nombreux types de données différents qui peuvent être contenus dans un objet de données Shell.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-178">While the procedures outlined above provide a good general model for Shell data transfer, there are many different types of data that can be contained in a Shell data object.</span></span> <span data-ttu-id="c0a8b-179">Il existe également plusieurs scénarios de transfert de données que votre application peut avoir à gérer.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-179">There are also a number of different data transfer scenarios that your application might need to handle.</span></span> <span data-ttu-id="c0a8b-180">Chaque type de données et scénario requiert une approche quelque peu différente de celle des trois étapes clés de la procédure :</span><span class="sxs-lookup"><span data-stu-id="c0a8b-180">Each data type and scenario requires a somewhat different approach to three key steps in the procedure:</span></span>

-   <span data-ttu-id="c0a8b-181">Comment une source construit un objet de données pour contenir les données de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-181">How a source constructs a data object to contain the Shell data.</span></span>
-   <span data-ttu-id="c0a8b-182">Comment une cible extrait les données de l’interpréteur de commandes de l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-182">How a target extracts Shell data from the data object.</span></span>
-   <span data-ttu-id="c0a8b-183">Comment la source termine l’opération de transfert de données.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-183">How the source completes the data transfer operation.</span></span>

<span data-ttu-id="c0a8b-184">L' [objet de données Shell](dataobject.md) fournit une discussion générale sur la manière dont une source construit un objet de données de l’interpréteur de commandes, ainsi que sur la façon dont cet objet de données peut être géré par la cible.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-184">The [Shell Data Object](dataobject.md) provides a general discussion of how a source constructs a Shell data object, and how that data object can be handled by the target.</span></span> <span data-ttu-id="c0a8b-185">[Gestion des scénarios de transfert de données de l’interpréteur](datascenarios.md) de commandes explique en détail comment gérer un certain nombre de scénarios courants de transfert de données Shell.</span><span class="sxs-lookup"><span data-stu-id="c0a8b-185">[Handling Shell Data Transfer Scenarios](datascenarios.md) discusses in detail how to handle a number of common Shell data transfer scenarios.</span></span>

 

 
