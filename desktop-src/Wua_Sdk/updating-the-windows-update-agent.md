---
description: Windows Update Agent (WUA) se met automatiquement à jour lorsqu’il est connecté à un serveur Windows Server Update Services (WSUS) ou Windows Update.
ms.assetid: 829112ab-b240-4cc4-8053-18b484934886
title: Mise à jour de l’agent de Windows Update
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b00fe439b1bea377e2699f6fe5714b208ac5d951
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106516491"
---
# <a name="updating-windows-update-agent"></a><span data-ttu-id="48963-103">Mise à jour de l’agent de Windows Update</span><span class="sxs-lookup"><span data-stu-id="48963-103">Updating Windows Update Agent</span></span>

<span data-ttu-id="48963-104">Windows Update Agent (WUA) se met à jour par le biais de différents moyens, en fonction de la version de Windows exécutée sur l’appareil.</span><span class="sxs-lookup"><span data-stu-id="48963-104">Windows Update Agent (WUA) updates itself through various means, depending on the version of Windows running on the device.</span></span> <span data-ttu-id="48963-105">Les anciennes versions de WUA peuvent ne pas être en mesure de se connecter aux services de mise à jour actuels. elles peuvent ne pas être compatibles avec toutes les mises à jour et peuvent ne pas prendre en charge toutes les API documentées.</span><span class="sxs-lookup"><span data-stu-id="48963-105">Old versions of WUA may not be able to connect to current update services, may not be compatible with all updates, and may not support all documented APIs.</span></span> <span data-ttu-id="48963-106">Voici comment s’assurer que WUA est entièrement mis à jour et compatible.</span><span class="sxs-lookup"><span data-stu-id="48963-106">Here is how to insure that WUA is fully updated and compatible.</span></span>

<span data-ttu-id="48963-107">**Sur les versions de Windows à compter de Windows 7 et de Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="48963-107">**On versions of Windows beginning with Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="48963-108">Les mises à jour de l’agent de Windows Update (WUA) sont incluses dans les mises à jour périodiques régulières de Windows distribué par le biais de Windows Update ou Windows Server Update Services (WSUS).</span><span class="sxs-lookup"><span data-stu-id="48963-108">Windows Update Agent (WUA) updates are included in the regular periodic updates to Windows distributed through Windows Update or to Windows Server Update Services (WSUS).</span></span> <span data-ttu-id="48963-109">Vous n’avez pas besoin de prendre des mesures spéciales pour mettre à jour WUA sur ces versions de Windows.</span><span class="sxs-lookup"><span data-stu-id="48963-109">You do not need to take any special steps to update WUA on these Windows versions.</span></span>

<span data-ttu-id="48963-110">**Sur les versions de Windows antérieures à Windows 7 et Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="48963-110">**On versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="48963-111">WUA se met automatiquement à jour quand Mises à jour automatiques se connecte à Windows Update ou à WSUS.</span><span class="sxs-lookup"><span data-stu-id="48963-111">WUA automatically updates itself when Automatic Updates connects to Windows Update or to WSUS.</span></span>

<span data-ttu-id="48963-112">Si Mises à jour automatiques n’a pas encore été exécutée correctement, il est possible qu’un appareil exécutant ces versions de Windows exécute une version antérieure de WUA qui ne prenne pas en charge toutes les API documentées.</span><span class="sxs-lookup"><span data-stu-id="48963-112">If Automatic Updates has not yet successfully run, it is possible that a device running these Windows versions will be running an older version of WUA that does not support all the documented APIs.</span></span> <span data-ttu-id="48963-113">Si vous recevez un résultat WU_E_SELFUPDATE_REQUIRED lorsque vous utilisez l’API WUA pour effectuer une analyse, un téléchargement ou une installation, cette erreur indique que la version installée de WUA est trop ancienne pour se connecter aux services Windows Update actuels.</span><span class="sxs-lookup"><span data-stu-id="48963-113">If you receive a WU_E_SELFUPDATE_REQUIRED result when you use the WUA API to perform a scan, download, or install, this error tells you that the installed version of WUA is too old to connect to current Windows Update services.</span></span> <span data-ttu-id="48963-114">Vous ne pouvez pas utiliser les API WUA normales pour mettre à jour WUA sur ces systèmes d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="48963-114">You cannot use the normal WUA APIs to update WUA on these operating systems.</span></span> 

<span data-ttu-id="48963-115">Un utilisateur peut mettre à jour manuellement WUA vers une version actuelle en ouvrant le Windows Update panneau de configuration, en sélectionnant Rechercher les mises à jour, puis en acceptant la mise à jour automatique qui s’affiche.</span><span class="sxs-lookup"><span data-stu-id="48963-115">A user can manually update WUA to a current version by opening the Windows Update control panel, selecting Check for Updates, then accepting the self-update that appears.</span></span> <span data-ttu-id="48963-116">Vous pouvez également mettre à jour WUA par programme.</span><span class="sxs-lookup"><span data-stu-id="48963-116">Alternately, you can update WUA programmatically.</span></span>

<span data-ttu-id="48963-117">**Pour mettre à jour par programme WUA sur les versions de Windows antérieures à Windows 7 et Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="48963-117">**To programmatically update WUA on versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

1.  <span data-ttu-id="48963-118">Utilisez les API [WinHTTP](../winhttp/winhttp-start-page.md) pour télécharger [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="48963-118">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
2.  <span data-ttu-id="48963-119">Utilisez les [fonctions de chiffrement](../seccrypto/cryptography-functions.md) pour vérifier que la copie téléchargée de [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) a une signature numérique de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="48963-119">Use the [Cryptography Functions](../seccrypto/cryptography-functions.md) to verify that the downloaded copy of [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) has a digital signature from Microsoft.</span></span> <span data-ttu-id="48963-120">Si vous ne pouvez pas vérifier la signature numérique, arrêtez.</span><span class="sxs-lookup"><span data-stu-id="48963-120">If you can't verify the digital signature, stop.</span></span>
3.  <span data-ttu-id="48963-121">Utilisez les API de l' [interface de décompression du fichier](../devnotes/cabinet-api-functions.md) pour extraire le fichier XML de [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="48963-121">Use the [File Decompression Interface](../devnotes/cabinet-api-functions.md) APIs to extract the XML file from [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
4.  <span data-ttu-id="48963-122">Utilisez les API Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) pour charger le fichier XML et recherchez le nœud WURedist/StandaloneRedist/architecture pour l’architecture de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="48963-122">Use the Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) APIs to load the XML file and locate the WURedist/StandaloneRedist/architecture node for the computer's architecture.</span></span> <span data-ttu-id="48963-123">Par exemple, pour x86, localisez le nœud WURedist/StandaloneRedist/architecture avec l’attribut **Name** de x86.</span><span class="sxs-lookup"><span data-stu-id="48963-123">For example, for x86, locate the WURedist/StandaloneRedist/architecture node with the **name** attribute of x86.</span></span>
5.  <span data-ttu-id="48963-124">Appelez [**IWindowsUpdateAgentInfo :: GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) pour déterminer la version actuelle de WUA.</span><span class="sxs-lookup"><span data-stu-id="48963-124">Call [**IWindowsUpdateAgentInfo::GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) to determine the current version of WUA.</span></span> <span data-ttu-id="48963-125">Si **IWindowsUpdateAgentInfo :: GetInfo** retourne un numéro de version au moins aussi élevé que l’attribut **clientVersion** dans le nœud architecture que vous avez localisé, arrêtez.</span><span class="sxs-lookup"><span data-stu-id="48963-125">If **IWindowsUpdateAgentInfo::GetInfo** returns a version number that is at least as high as the **clientVersion** attribute in the architecture node you located, stop.</span></span>
6.  <span data-ttu-id="48963-126">Utilisez les API [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) pour lire l’attribut **DownloadURL** à partir du nœud architecture que vous avez localisé.</span><span class="sxs-lookup"><span data-stu-id="48963-126">Use the [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) APIs to read the **downloadUrl** attribute from the architecture node that you located.</span></span> <span data-ttu-id="48963-127">**DownloadURL** vous donne l’URL de téléchargement du programme d’installation WUA approprié pour l’architecture de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="48963-127">**downloadUrl** gives you the download URL for the appropriate WUA installer for the computer's architecture.</span></span>
7.  <span data-ttu-id="48963-128">Utilisez les API [WinHTTP](../winhttp/winhttp-start-page.md) pour télécharger le programme d’installation approprié.</span><span class="sxs-lookup"><span data-stu-id="48963-128">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download the appropriate installer.</span></span>
8.  <span data-ttu-id="48963-129">Utilisez la fonction [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) ou une API similaire pour exécuter le programme d’installation téléchargé.</span><span class="sxs-lookup"><span data-stu-id="48963-129">Use the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function or a similar API to execute the downloaded installer.</span></span>

 

 
