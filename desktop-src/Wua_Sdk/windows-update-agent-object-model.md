---
description: Les programmeurs qui utilisent Windows Update Agent (WUA) commencent par ajouter une référence à Wuapi.dll à leur projet actuel (dans Visual C++, Microsoft Visual Basic ou C \# ) ou en référençant wuapi. h et Wuguid. lib dans un projet C ou C++.
ms.assetid: ec9cbb0b-b5d4-41f2-8a25-143130d08a3b
title: Windows Update le modèle objet de l’agent
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5060a76c850ea9ad97e9132f661d4b64f4f4fd03
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104564921"
---
# <a name="windows-update-agent-object-model"></a><span data-ttu-id="b4220-103">Windows Update le modèle objet de l’agent</span><span class="sxs-lookup"><span data-stu-id="b4220-103">Windows Update Agent Object Model</span></span>

<span data-ttu-id="b4220-104">Les programmeurs qui utilisent Windows Update Agent (WUA) commencent par ajouter une référence à Wuapi.dll à leur projet actuel (dans Visual C++, Microsoft Visual Basic ou C \# ) ou en référençant wuapi. h et Wuguid. lib dans un projet C ou C++.</span><span class="sxs-lookup"><span data-stu-id="b4220-104">Programmers using Windows Update Agent (WUA) begin by adding a reference to Wuapi.dll to their current project (in Visual C++, Microsoft Visual Basic, or C\#) or by referencing Wuapi.h and Wuguid.lib in a C or C++ project.</span></span> <span data-ttu-id="b4220-105">La première étape de l’utilisation de l’API WUA consiste à créer une instance de l’une des interfaces en créant un objet à partir de la coclasse appropriée.</span><span class="sxs-lookup"><span data-stu-id="b4220-105">The first step in using the WUA API is to create an instance of one of the interfaces by creating an object from the appropriate coclass.</span></span>

<span data-ttu-id="b4220-106">L’illustration suivante décrit le modèle objet WUA.</span><span class="sxs-lookup"><span data-stu-id="b4220-106">The following illustration describes the WUA object model.</span></span> <span data-ttu-id="b4220-107">Pour plus d’informations, consultez la section «[objets WUA et tâches associées](#wua-objects-and-associated-tasks)».</span><span class="sxs-lookup"><span data-stu-id="b4220-107">For more information, see the "[WUA Objects and Associated Tasks](#wua-objects-and-associated-tasks)" section.</span></span> <span data-ttu-id="b4220-108">Pour obtenir la liste complète de toutes les interfaces WUA, consultez [interfaces](interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="b4220-108">For a complete list of all the WUA interfaces, see [Interfaces](interfaces.md).</span></span>

![modèle objet de l’agent Windows Update](images/wua-object-model.png)

## <a name="wua-objects-and-associated-tasks"></a><span data-ttu-id="b4220-110">Objets WUA et tâches associées</span><span class="sxs-lookup"><span data-stu-id="b4220-110">WUA Objects and Associated Tasks</span></span>

<span data-ttu-id="b4220-111">Le tableau suivant répertorie les objets WUA et les tâches typiques associées aux objets WUA.</span><span class="sxs-lookup"><span data-stu-id="b4220-111">The following table lists the WUA objects and the typical tasks that are associated with the WUA objects.</span></span>



| <span data-ttu-id="b4220-112">Object</span><span class="sxs-lookup"><span data-stu-id="b4220-112">Object</span></span>                                                                | <span data-ttu-id="b4220-113">Description</span><span class="sxs-lookup"><span data-stu-id="b4220-113">Description</span></span>                                                                                                                                                                                                                                 |
|-----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b4220-114">**AutomaticUpdates**</span><span class="sxs-lookup"><span data-stu-id="b4220-114">**AutomaticUpdates**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iautomaticupdates)                         | <span data-ttu-id="b4220-115">Commencez, interrompez ou reprenez Mises à jour automatiques.</span><span class="sxs-lookup"><span data-stu-id="b4220-115">Begin, pause, or resume Automatic Updates.</span></span>                                                                                                                                                                                                  |
| [<span data-ttu-id="b4220-116">**AutomaticUpdatesSettings**</span><span class="sxs-lookup"><span data-stu-id="b4220-116">**AutomaticUpdatesSettings**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iautomaticupdatessettings)         | <span data-ttu-id="b4220-117">Récupérer ou définir le jour et l’heure d’installation des mises à jour.</span><span class="sxs-lookup"><span data-stu-id="b4220-117">Retrieve or set the day and time to install updates.</span></span> <span data-ttu-id="b4220-118">Spécifiez comment les utilisateurs sont avertis d’un événement Mises à jour automatiques.</span><span class="sxs-lookup"><span data-stu-id="b4220-118">Specify how users are notified of an Automatic Updates event.</span></span>                                                                                                                          |
| [<span data-ttu-id="b4220-119">**Category**</span><span class="sxs-lookup"><span data-stu-id="b4220-119">**Category**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-icategory)                                         | <span data-ttu-id="b4220-120">Récupérez les informations relatives à la catégorie de la mise à jour, notamment le nom, l’ID, la description, le propriétaire et le produit souhaité.</span><span class="sxs-lookup"><span data-stu-id="b4220-120">Retrieve information about the update's category, including the name, ID, description, owner, and intended product.</span></span> <span data-ttu-id="b4220-121">Récupérer une collection de mises à jour qui appartiennent à cette catégorie.</span><span class="sxs-lookup"><span data-stu-id="b4220-121">Retrieve a collection of updates that belong to this category.</span></span> <span data-ttu-id="b4220-122">Récupère une collection de catégories parent ou enfant.</span><span class="sxs-lookup"><span data-stu-id="b4220-122">Retrieve a collection of the parent or child categories.</span></span> |
| [<span data-ttu-id="b4220-123">**CategoryCollection**</span><span class="sxs-lookup"><span data-stu-id="b4220-123">**CategoryCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-icategorycollection)                     | <span data-ttu-id="b4220-124">Accédez à une collection d’objets Category.</span><span class="sxs-lookup"><span data-stu-id="b4220-124">Access a collection of Category objects.</span></span>                                                                                                                                                                                                    |
| [<span data-ttu-id="b4220-125">**DownloadResult**</span><span class="sxs-lookup"><span data-stu-id="b4220-125">**DownloadResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-idownloadresult)                             | <span data-ttu-id="b4220-126">Récupérez des informations sur le résultat d’un téléchargement.</span><span class="sxs-lookup"><span data-stu-id="b4220-126">Retrieve information about the result of a download.</span></span>                                                                                                                                                                                        |
| [<span data-ttu-id="b4220-127">**InstallationResult**</span><span class="sxs-lookup"><span data-stu-id="b4220-127">**InstallationResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iinstallationresult)                     | <span data-ttu-id="b4220-128">Récupérez des informations sur le résultat d’une installation ou d’une désinstallation.</span><span class="sxs-lookup"><span data-stu-id="b4220-128">Retrieve information about the result of an installation or uninstallation.</span></span> <span data-ttu-id="b4220-129">Déterminez si un redémarrage du système est nécessaire pour terminer l’installation ou la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="b4220-129">Determine whether a system restart is required to complete the installation or uninstallation.</span></span>                                                                  |
| [<span data-ttu-id="b4220-130">**SearchResult**</span><span class="sxs-lookup"><span data-stu-id="b4220-130">**SearchResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-isearchresult)                                 | <span data-ttu-id="b4220-131">Récupérez des informations sur le résultat d’une recherche de catégories ou de mises à jour.</span><span class="sxs-lookup"><span data-stu-id="b4220-131">Retrieve information about the result of a search for categories or updates.</span></span> <span data-ttu-id="b4220-132">Récupère une collection de catégories détectées sur l’ordinateur de destination à l’aide de la recherche.</span><span class="sxs-lookup"><span data-stu-id="b4220-132">Retrieve a collection of categories found on the destination computer by the search.</span></span> <span data-ttu-id="b4220-133">Récupère une collection de mises à jour trouvées par la recherche.</span><span class="sxs-lookup"><span data-stu-id="b4220-133">Retrieve a collection of updates found by the search.</span></span>                     |
| [<span data-ttu-id="b4220-134">**SystemInformation**</span><span class="sxs-lookup"><span data-stu-id="b4220-134">**SystemInformation**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-isysteminformation)                       | <span data-ttu-id="b4220-135">Récupérez des informations sur la configuration requise pour le système OEM et le redémarrage du système sur l’ordinateur de destination.</span><span class="sxs-lookup"><span data-stu-id="b4220-135">Retrieve information about OEM hardware and system restart requirements on the destination computer.</span></span>                                                                                                                                        |
| [<span data-ttu-id="b4220-136">**Mise à jour**</span><span class="sxs-lookup"><span data-stu-id="b4220-136">**Update**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdate)                                             | <span data-ttu-id="b4220-137">Récupérer la plupart des informations sur la mise à jour, y compris les mises à jour regroupées, les spécifications source, l’identité, la description, les options de désinstallation, la priorité de téléchargement, la taille et l’échéance.</span><span class="sxs-lookup"><span data-stu-id="b4220-137">Retrieve most information about the update, including bundled updates, source requirements, identity, description, uninstall options, download priority, size, and deadline.</span></span>                                                                |
| [<span data-ttu-id="b4220-138">**UpdateCollection**</span><span class="sxs-lookup"><span data-stu-id="b4220-138">**UpdateCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatecollection)                         | <span data-ttu-id="b4220-139">Accédez à une collection d’objets de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="b4220-139">Access a collection of Update objects.</span></span>                                                                                                                                                                                                      |
| [<span data-ttu-id="b4220-140">**UpdateDownloader**</span><span class="sxs-lookup"><span data-stu-id="b4220-140">**UpdateDownloader**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloader)                         | <span data-ttu-id="b4220-141">Démarrez un téléchargement asynchrone ou synchrone des fichiers associés aux mises à jour.</span><span class="sxs-lookup"><span data-stu-id="b4220-141">Start an asynchronous or synchronous download of the files that are associated with the updates.</span></span>                                                                                                                                            |
| [<span data-ttu-id="b4220-142">**UpdateDownloadResult**</span><span class="sxs-lookup"><span data-stu-id="b4220-142">**UpdateDownloadResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloadresult)                 | <span data-ttu-id="b4220-143">Récupérez des informations sur le résultat du téléchargement pour une seule mise à jour.</span><span class="sxs-lookup"><span data-stu-id="b4220-143">Retrieve information about the result of the download for one update.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="b4220-144">**UpdateException**</span><span class="sxs-lookup"><span data-stu-id="b4220-144">**UpdateException**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateexception)                           | <span data-ttu-id="b4220-145">Récupère la description et le contexte d’une exception qui est levée lorsqu’une erreur de mise à jour se produit.</span><span class="sxs-lookup"><span data-stu-id="b4220-145">Retrieve the description and context of an exception that is thrown when an update error occurs.</span></span>                                                                                                                                            |
| [<span data-ttu-id="b4220-146">**UpdateExceptionCollection**</span><span class="sxs-lookup"><span data-stu-id="b4220-146">**UpdateExceptionCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateexceptioncollection)       | <span data-ttu-id="b4220-147">Accédez à une collection d’objets UpdateException.</span><span class="sxs-lookup"><span data-stu-id="b4220-147">Access a collection of UpdateException objects.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="b4220-148">**UpdateHistoryEntry**</span><span class="sxs-lookup"><span data-stu-id="b4220-148">**UpdateHistoryEntry**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatehistoryentry)                     | <span data-ttu-id="b4220-149">Récupérez des informations sur une mise à jour qui a été installée ou désinstallée, y compris l’application, la date et la description traitées.</span><span class="sxs-lookup"><span data-stu-id="b4220-149">Retrieve information about an update that has been installed or uninstalled, including the processed application, date, and description.</span></span>                                                                                                    |
| [<span data-ttu-id="b4220-150">**UpdateHistoryEntryCollection**</span><span class="sxs-lookup"><span data-stu-id="b4220-150">**UpdateHistoryEntryCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatehistoryentrycollection) | <span data-ttu-id="b4220-151">Accédez à une collection d’objets UpdateHistoryEntry.</span><span class="sxs-lookup"><span data-stu-id="b4220-151">Access a collection of UpdateHistoryEntry objects.</span></span>                                                                                                                                                                                          |
| [<span data-ttu-id="b4220-152">**UpdateInstallationResult**</span><span class="sxs-lookup"><span data-stu-id="b4220-152">**UpdateInstallationResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateinstallationresult)         | <span data-ttu-id="b4220-153">Récupérez des informations sur le résultat de l’installation ou de la désinstallation d’une mise à jour.</span><span class="sxs-lookup"><span data-stu-id="b4220-153">Retrieve information about the result of the installation or uninstallation for an update.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="b4220-154">**UpdateInstaller**</span><span class="sxs-lookup"><span data-stu-id="b4220-154">**UpdateInstaller**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateinstaller)                           | <span data-ttu-id="b4220-155">Démarrez une installation asynchrone ou synchrone ou une désinstallation d’une mise à jour.</span><span class="sxs-lookup"><span data-stu-id="b4220-155">Start an asynchronous or synchronous installation or uninstallation of an update.</span></span> <span data-ttu-id="b4220-156">Démarrer une séquence de dialogue interactive pour guider l’utilisateur tout au long des étapes d’installation des mises à jour.</span><span class="sxs-lookup"><span data-stu-id="b4220-156">Start an interactive dialog sequence to guide the user through the steps to install updates.</span></span>                                                              |
| [<span data-ttu-id="b4220-157">**UpdateSearcher**</span><span class="sxs-lookup"><span data-stu-id="b4220-157">**UpdateSearcher**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatesearcher)                             | <span data-ttu-id="b4220-158">Recherche des mises à jour sur le serveur en fonction de critères tels que le type de mise à jour, l’ID ou la catégorie.</span><span class="sxs-lookup"><span data-stu-id="b4220-158">Searches for updates on the server by criteria such as the update type, the ID, or the category.</span></span>                                                                                                                                            |
| [<span data-ttu-id="b4220-159">**UpdateSession**</span><span class="sxs-lookup"><span data-stu-id="b4220-159">**UpdateSession**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatesession)                               | <span data-ttu-id="b4220-160">Démarrez une session pour rechercher, télécharger, installer ou désinstaller les mises à jour pour une application.</span><span class="sxs-lookup"><span data-stu-id="b4220-160">Start a session to search, download, install, or uninstall the updates for an application.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="b4220-161">**WebProxy**</span><span class="sxs-lookup"><span data-stu-id="b4220-161">**WebProxy**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iwebproxy)                                         | <span data-ttu-id="b4220-162">Récupérez et définissez les paramètres du proxy HTTP.</span><span class="sxs-lookup"><span data-stu-id="b4220-162">Retrieve and set HTTP proxy settings.</span></span>                                                                                                                                                                                                       |



 

 

 



