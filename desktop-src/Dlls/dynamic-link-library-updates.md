---
description: Il est parfois nécessaire de remplacer une DLL par une version plus récente.
ms.assetid: 82349a33-dc2c-4309-b0fc-890f230e3f2c
title: Mises à jour de la bibliothèque de Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a10f76103ddebc723466fb7e32a216c0c039691d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104034149"
---
# <a name="dynamic-link-library-updates"></a><span data-ttu-id="e683f-103">Mises à jour de la bibliothèque de Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="e683f-103">Dynamic-Link Library Updates</span></span>

<span data-ttu-id="e683f-104">Il est parfois nécessaire de remplacer une DLL par une version plus récente.</span><span class="sxs-lookup"><span data-stu-id="e683f-104">It is sometimes necessary to replace a DLL with a newer version.</span></span> <span data-ttu-id="e683f-105">Avant de remplacer une DLL, effectuez une vérification de la version pour vous assurer que vous remplacez une version antérieure par une version plus récente.</span><span class="sxs-lookup"><span data-stu-id="e683f-105">Before replacing a DLL, perform a version check to ensure that you are replacing an older version with a newer version.</span></span> <span data-ttu-id="e683f-106">Il est possible de remplacer une DLL en cours d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="e683f-106">It is possible to replace a DLL that is in use.</span></span> <span data-ttu-id="e683f-107">La méthode que vous utilisez pour remplacer les dll en cours d’utilisation dépend du système d’exploitation que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="e683f-107">The method you use to replace DLLs that are in use depends on the operating system you are using.</span></span> <span data-ttu-id="e683f-108">Sur Windows XP et versions ultérieures, les applications doivent utiliser [des applications isolées et des assemblys côte à côte](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="e683f-108">On Windows XP and later, applications should use [Isolated Applications and Side-by-side Assemblies](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="e683f-109">Il n’est pas nécessaire de redémarrer l’ordinateur si vous effectuez les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="e683f-109">It is not necessary to restart the computer if you perform the following steps:</span></span>

1.  <span data-ttu-id="e683f-110">Utilisez la fonction [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) pour renommer la dll remplacée.</span><span class="sxs-lookup"><span data-stu-id="e683f-110">Use the [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) function to rename the DLL being replaced.</span></span> <span data-ttu-id="e683f-111">Ne spécifiez pas \_ de copie MOVEFILE autorisée, et assurez-vous que \_ le fichier renommé se trouve sur le même volume que celui qui contient le fichier d’origine.</span><span class="sxs-lookup"><span data-stu-id="e683f-111">Do not specify MOVEFILE\_COPY\_ALLOWED, and make sure the renamed file is on the same volume that contains the original file.</span></span> <span data-ttu-id="e683f-112">Vous pouvez également simplement renommer le fichier dans le même répertoire en lui attribuant une extension différente.</span><span class="sxs-lookup"><span data-stu-id="e683f-112">You could also simply rename the file in the same directory by giving it a different extension.</span></span>
2.  <span data-ttu-id="e683f-113">Copiez la nouvelle DLL dans le répertoire qui contient la DLL renommée.</span><span class="sxs-lookup"><span data-stu-id="e683f-113">Copy the new DLL to the directory that contains the renamed DLL.</span></span> <span data-ttu-id="e683f-114">Toutes les applications utiliseront désormais la nouvelle DLL.</span><span class="sxs-lookup"><span data-stu-id="e683f-114">All applications will now use the new DLL.</span></span>
3.  <span data-ttu-id="e683f-115">Utilisez [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) avec \_ le délai MOVEFILE \_ jusqu' \_ au redémarrage pour supprimer la dll renommée.</span><span class="sxs-lookup"><span data-stu-id="e683f-115">Use [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) with MOVEFILE\_DELAY\_UNTIL\_REBOOT to delete the renamed DLL.</span></span>

<span data-ttu-id="e683f-116">Avant de procéder à ce remplacement, les applications utiliseront la DLL d’origine jusqu’à ce qu’elle soit déchargée.</span><span class="sxs-lookup"><span data-stu-id="e683f-116">Before you make this replacement, applications will use the original DLL until it is unloaded.</span></span> <span data-ttu-id="e683f-117">Une fois le remplacement effectué, les applications utiliseront la nouvelle DLL.</span><span class="sxs-lookup"><span data-stu-id="e683f-117">After you make the replacement, applications will use the new DLL.</span></span> <span data-ttu-id="e683f-118">Lorsque vous écrivez une DLL, vous devez veiller à ce qu’elle soit préparée pour cette situation, en particulier si la DLL conserve des informations d’État globales ou communique avec d’autres services.</span><span class="sxs-lookup"><span data-stu-id="e683f-118">When you write a DLL, you must be careful to ensure that it is prepared for this situation, especially if the DLL maintains global state information or communicates with other services.</span></span> <span data-ttu-id="e683f-119">Si la DLL n’est pas préparée pour une modification des informations d’État globales ou des protocoles de communication, la mise à jour de la DLL vous oblige à redémarrer l’ordinateur pour s’assurer que toutes les applications utilisent la même version de la DLL.</span><span class="sxs-lookup"><span data-stu-id="e683f-119">If the DLL is not prepared for a change in global state information or communication protocols, updating the DLL will require you to restart the computer to ensure that all applications are using the same version of the DLL.</span></span>

 

 
