---
description: Pour créer une bibliothèque de Dynamic-Link (DLL), vous devez créer un ou plusieurs fichiers de code source, et éventuellement un fichier de l’éditeur de liens pour exporter les fonctions.
ms.assetid: b66ea0e8-84c3-40be-bf02-765b9dd61f9f
title: Création de la bibliothèque de Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c12d296b1494cfcedcdfa823eb1a3dd4d408427a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103753780"
---
# <a name="dynamic-link-library-creation"></a><span data-ttu-id="22ada-103">Création de la bibliothèque de Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="22ada-103">Dynamic-Link Library Creation</span></span>

<span data-ttu-id="22ada-104">Pour créer une bibliothèque de Dynamic-Link (DLL), vous devez créer un ou plusieurs fichiers de code source, et éventuellement un fichier de l’éditeur de liens pour exporter les fonctions.</span><span class="sxs-lookup"><span data-stu-id="22ada-104">To create a Dynamic-Link Library (DLL), you must create one or more source code files, and possibly a linker file for exporting the functions.</span></span> <span data-ttu-id="22ada-105">Si vous prévoyez d’autoriser les applications qui utilisent votre DLL à utiliser la liaison dynamique au moment du chargement, vous devez également créer une bibliothèque d’importation.</span><span class="sxs-lookup"><span data-stu-id="22ada-105">If you plan to allow applications that use your DLL to use load-time dynamic linking, you must also create an import library.</span></span>

## <a name="creating-source-files"></a><span data-ttu-id="22ada-106">Création de fichiers sources</span><span class="sxs-lookup"><span data-stu-id="22ada-106">Creating Source Files</span></span>

<span data-ttu-id="22ada-107">Les fichiers sources d’une DLL contiennent des fonctions et des données exportées, des fonctions et des données internes, ainsi qu’une [fonction de point d’entrée](dynamic-link-library-entry-point-function.md) facultative pour la dll.</span><span class="sxs-lookup"><span data-stu-id="22ada-107">The source files for a DLL contain exported functions and data, internal functions and data, and an optional [entry-point function](dynamic-link-library-entry-point-function.md) for the DLL.</span></span> <span data-ttu-id="22ada-108">Vous pouvez utiliser tous les outils de développement qui prennent en charge la création de dll Windows.</span><span class="sxs-lookup"><span data-stu-id="22ada-108">You may use any development tools that support the creation of Windows-based DLLs.</span></span>

<span data-ttu-id="22ada-109">Si votre DLL peut être utilisée par une application multithread, vous devez rendre votre DLL « thread-safe ».</span><span class="sxs-lookup"><span data-stu-id="22ada-109">If your DLL may be used by a multithreaded application, you should make your DLL "thread-safe".</span></span> <span data-ttu-id="22ada-110">Vous devez synchroniser l’accès à toutes les données globales de la DLL pour éviter l’endommagement des données.</span><span class="sxs-lookup"><span data-stu-id="22ada-110">You must synchronize access to all of the DLL's global data to avoid data corruption.</span></span> <span data-ttu-id="22ada-111">Vous devez également vous assurer que vous effectuez un lien uniquement avec des bibliothèques thread-safe.</span><span class="sxs-lookup"><span data-stu-id="22ada-111">You must also ensure that you link only with libraries that are thread-safe as well.</span></span> <span data-ttu-id="22ada-112">Par exemple, Microsoft Visual C++ contient plusieurs versions de la bibliothèque Runtime C, une qui n’est pas thread-safe et deux qui sont.</span><span class="sxs-lookup"><span data-stu-id="22ada-112">For example, Microsoft Visual C++ contains multiple versions of the C Run-time Library, one that is not thread-safe and two that are.</span></span>

## <a name="exporting-functions"></a><span data-ttu-id="22ada-113">Exportation de fonctions</span><span class="sxs-lookup"><span data-stu-id="22ada-113">Exporting Functions</span></span>

<span data-ttu-id="22ada-114">La façon dont vous spécifiez les fonctions d’une DLL à exporter dépend des outils que vous utilisez pour le développement.</span><span class="sxs-lookup"><span data-stu-id="22ada-114">How you specify which functions in a DLL should be exported depends on the tools that you are using for development.</span></span> <span data-ttu-id="22ada-115">Certains compilateurs vous permettent d’exporter une fonction directement dans le code source en utilisant un modificateur dans la déclaration de la fonction.</span><span class="sxs-lookup"><span data-stu-id="22ada-115">Some compilers allow you to export a function directly in the source code by using a modifier in the function declaration.</span></span> <span data-ttu-id="22ada-116">Dans d’autres cas, vous devez spécifier des exportations dans un fichier que vous transmettez à l’éditeur de liens.</span><span class="sxs-lookup"><span data-stu-id="22ada-116">Other times, you must specify exports in a file that you pass to the linker.</span></span>

<span data-ttu-id="22ada-117">Par exemple, à l’aide de Visual C++, il existe deux façons d’exporter des fonctions dll : avec le modificateur [**\_ \_ declspec (dllexport)**](https://msdn.microsoft.com/library/3y1sfaz2(v=VS.71).aspx) ou avec un fichier de définition de module (. def).</span><span class="sxs-lookup"><span data-stu-id="22ada-117">For example, using Visual C++, there are two possible ways to export DLL functions: with the [**\_\_declspec(dllexport)**](https://msdn.microsoft.com/library/3y1sfaz2(v=VS.71).aspx) modifier or with a module-definition (.def) file.</span></span> <span data-ttu-id="22ada-118">Si vous utilisez le modificateur **\_ \_ declspec (dllexport)** , il n’est pas nécessaire d’utiliser un fichier. def.</span><span class="sxs-lookup"><span data-stu-id="22ada-118">If you use the **\_\_declspec(dllexport)** modifier, it is not necessary to use a .def file.</span></span> <span data-ttu-id="22ada-119">Pour plus d’informations, consultez [exportation à partir d’une dll](/cpp/build/exporting-from-a-dll?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="22ada-119">For more information, see [Exporting from a DLL](/cpp/build/exporting-from-a-dll?view=vs-2019).</span></span>

## <a name="creating-an-import-library"></a><span data-ttu-id="22ada-120">Création d’une bibliothèque d’importation</span><span class="sxs-lookup"><span data-stu-id="22ada-120">Creating an Import Library</span></span>

<span data-ttu-id="22ada-121">Un fichier de bibliothèque d’importation (. lib) contient des informations dont l’éditeur de liens a besoin pour résoudre les références externes aux fonctions DLL exportées, de sorte que le système puisse localiser la DLL spécifiée et les fonctions DLL exportées au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="22ada-121">An import library (.lib) file contains information the linker needs to resolve external references to exported DLL functions, so the system can locate the specified DLL and exported DLL functions at run time.</span></span> <span data-ttu-id="22ada-122">Vous pouvez créer une bibliothèque d’importation pour votre DLL lorsque vous générez votre DLL.</span><span class="sxs-lookup"><span data-stu-id="22ada-122">You can create an import library for your DLL when you build your DLL.</span></span>

<span data-ttu-id="22ada-123">Pour plus d’informations, consultez [génération d’une bibliothèque d’importation et d’un fichier d’exportation](/cpp/build/reference/building-an-import-library-and-export-file?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="22ada-123">For more information, see [Building an Import Library and Export File](/cpp/build/reference/building-an-import-library-and-export-file?view=vs-2019).</span></span>

## <a name="using-an-import-library"></a><span data-ttu-id="22ada-124">Utilisation d’une bibliothèque d’importation</span><span class="sxs-lookup"><span data-stu-id="22ada-124">Using an Import Library</span></span>

<span data-ttu-id="22ada-125">Par exemple, pour appeler la fonction [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) , vous devez lier votre code à la bibliothèque d’importation user32. lib.</span><span class="sxs-lookup"><span data-stu-id="22ada-125">For example, to call the [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) function, you must link your code with the import library User32.lib.</span></span> <span data-ttu-id="22ada-126">La raison en est que **CreateWindow** réside dans une DLL système nommée User32.dll et user32. lib est la bibliothèque d’importation utilisée pour résoudre les appels aux fonctions exportées dans User32.dll dans votre code.</span><span class="sxs-lookup"><span data-stu-id="22ada-126">The reason is that **CreateWindow** resides in a system DLL named User32.dll, and User32.lib is the import library used to resolve the calls to exported functions in User32.dll in your code.</span></span> <span data-ttu-id="22ada-127">L’éditeur de liens crée une table qui contient l’adresse de chaque appel de fonction.</span><span class="sxs-lookup"><span data-stu-id="22ada-127">The linker creates a table that contains the address of each function call.</span></span> <span data-ttu-id="22ada-128">Les appels aux fonctions dans une DLL sont résolus lors du chargement de la DLL.</span><span class="sxs-lookup"><span data-stu-id="22ada-128">Calls to functions in a DLL will be fixed up when the DLL is loaded.</span></span> <span data-ttu-id="22ada-129">Pendant l’initialisation du processus, le système charge User32.dll, car le processus dépend des fonctions exportées dans cette DLL et met à jour les entrées dans la table des adresses de la fonction.</span><span class="sxs-lookup"><span data-stu-id="22ada-129">While the system is initializing the process, it loads User32.dll because the process depends on exported functions in that DLL, and it updates the entries in the function address table.</span></span> <span data-ttu-id="22ada-130">Tous les appels à **CreateWindow** appellent la fonction exportée à partir de User32.dll.</span><span class="sxs-lookup"><span data-stu-id="22ada-130">All calls to **CreateWindow** invoke the function exported from User32.dll.</span></span>

<span data-ttu-id="22ada-131">Pour plus d’informations, consultez [liaison implicite avec une dll](/previous-versions/d14wsce5(v=vs.140)).</span><span class="sxs-lookup"><span data-stu-id="22ada-131">For information, see [Linking Implicitly with a DLL](/previous-versions/d14wsce5(v=vs.140)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="22ada-132">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="22ada-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="22ada-133">Création d’une bibliothèque de liens dynamiques simple</span><span class="sxs-lookup"><span data-stu-id="22ada-133">Creating a Simple Dynamic-link Library</span></span>](creating-a-simple-dynamic-link-library.md)
</dt> <dt>

[<span data-ttu-id="22ada-134">Dll (Visual C++)</span><span class="sxs-lookup"><span data-stu-id="22ada-134">DLLs (Visual C++)</span></span>](/cpp/build/dlls-in-visual-cpp?view=vs-2019)
</dt> </dl>

 

 
