---
description: Quand une application charge dynamiquement une bibliothèque de liens dynamiques sans spécifier un nom de chemin d’accès complet, Windows tente de localiser la DLL en recherchant un ensemble bien défini de répertoires dans un ordre particulier, comme décrit dans Dynamic-Link l’ordre de recherche de la bibliothèque. Si un attaquant gagne le contrôle de l’un des répertoires du chemin de recherche de DLL, il peut placer une copie malveillante de la DLL dans ce répertoire. C’est ce qu’on appelle parfois une attaque de préchargement de DLL ou une attaque de plantation binaire.
ms.assetid: 9493F299-789D-4CBC-9822-96EEAE39B494
title: Sécurité de la bibliothèque de Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4016139762461784702ac0190c1ee65d8bc6e72d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106526266"
---
# <a name="dynamic-link-library-security"></a><span data-ttu-id="5b3b8-105">Sécurité de la bibliothèque de Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="5b3b8-105">Dynamic-Link Library Security</span></span>

<span data-ttu-id="5b3b8-106">Quand une application charge dynamiquement une bibliothèque de liens dynamiques sans spécifier un nom de chemin d’accès complet, Windows tente de localiser la DLL en recherchant un ensemble bien défini de répertoires dans un ordre particulier, comme décrit dans l’ordre de recherche de la [bibliothèque de liens dynamiques](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="5b3b8-106">When an application dynamically loads a dynamic-link library without specifying a fully qualified path name, Windows attempts to locate the DLL by searching a well-defined set of directories in a particular order, as described in [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span> <span data-ttu-id="5b3b8-107">Si un attaquant gagne le contrôle de l’un des répertoires du chemin de recherche de DLL, il peut placer une copie malveillante de la DLL dans ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-107">If an attacker gains control of one of the directories on the DLL search path, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="5b3b8-108">C’est ce qu’on appelle parfois une attaque de *préchargement de dll* ou une *attaque de plantation binaire*.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-108">This is sometimes called a *DLL preloading attack* or a *binary planting attack*.</span></span> <span data-ttu-id="5b3b8-109">Si le système ne trouve pas de copie légitime de la DLL avant de rechercher le répertoire compromis, il charge la DLL malveillante.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-109">If the system does not find a legitimate copy of the DLL before it searches the compromised directory, it loads the malicious DLL.</span></span> <span data-ttu-id="5b3b8-110">Si l’application s’exécute avec des privilèges d’administrateur, l’attaquant peut parvenir à une élévation de privilèges locale.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-110">If the application is running with administrator privileges, the attacker may succeed in local privilege elevation.</span></span>

<span data-ttu-id="5b3b8-111">Supposons, par exemple, qu’une application soit conçue pour charger une DLL à partir du répertoire actuel de l’utilisateur et échouer correctement si la DLL est introuvable.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-111">For example, suppose an application is designed to load a DLL from the user's current directory and fail gracefully if the DLL is not found.</span></span> <span data-ttu-id="5b3b8-112">L’application appelle [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) uniquement avec le nom de la dll, ce qui amène le système à rechercher la dll.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-112">The application calls [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) with just the name of the DLL, which causes the system to search for the DLL.</span></span> <span data-ttu-id="5b3b8-113">En supposant que le mode de recherche de DLL sécurisé est activé et que l’application n’utilise pas d’autre ordre de recherche, le système recherche les répertoires dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="5b3b8-113">Assuming safe DLL search mode is enabled and the application is not using an alternate search order, the system searches directories in the following order:</span></span>

1.  <span data-ttu-id="5b3b8-114">Répertoire à partir duquel l’application a été chargée.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-114">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="5b3b8-115">Répertoire du système.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-115">The system directory.</span></span>
3.  <span data-ttu-id="5b3b8-116">Répertoire système 16 bits.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-116">The 16-bit system directory.</span></span>
4.  <span data-ttu-id="5b3b8-117">Répertoire Windows.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-117">The Windows directory.</span></span>
5.  <span data-ttu-id="5b3b8-118">Le répertoire actif.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-118">The current directory.</span></span>
6.  <span data-ttu-id="5b3b8-119">Répertoires répertoriés dans la variable d’environnement PATH.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-119">The directories that are listed in the PATH environment variable.</span></span>

<span data-ttu-id="5b3b8-120">En poursuivant l’exemple, une personne malveillante ayant connaissance de l’application prend le contrôle du répertoire actuel et place une copie malveillante de la DLL dans ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-120">Continuing the example, an attacker with knowledge of the application gains control of the current directory and places a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="5b3b8-121">Lorsque l’application émet l’appel **LoadLibrary** , le système recherche la dll, recherche la copie malveillante de la dll dans le répertoire actif et la charge.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-121">When the application issues the **LoadLibrary** call, the system searches for the DLL, finds the malicious copy of the DLL in the current directory, and loads it.</span></span> <span data-ttu-id="5b3b8-122">La copie malveillante de la DLL s’exécute ensuite dans l’application et obtient les privilèges de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-122">The malicious copy of the DLL then runs within the application and gains the privileges of the user.</span></span>

<span data-ttu-id="5b3b8-123">Les développeurs peuvent aider à protéger leurs applications contre les attaques de préchargement de DLL en suivant ces instructions :</span><span class="sxs-lookup"><span data-stu-id="5b3b8-123">Developers can help safeguard their applications against DLL preloading attacks by following these guidelines:</span></span>

-   <span data-ttu-id="5b3b8-124">Dans la mesure du possible, spécifiez un chemin d’accès complet lorsque vous utilisez les fonctions [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya), [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa), [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa)ou [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="5b3b8-124">Wherever possible, specify a fully qualified path when using the [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya), [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa), [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), or [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) functions.</span></span>
-   <span data-ttu-id="5b3b8-125">Utilisez les \_ indicateurs de \_ recherche de la bibliothèque de chargement avec la fonction [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) , ou utilisez ces indicateurs avec la fonction [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) pour établir un ordre de recherche de dll pour un processus, puis utilisez les fonctions [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) ou [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) pour modifier la liste.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-125">Use the LOAD\_LIBRARY\_SEARCH flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function, or use these flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process and then use the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions to modify the list.</span></span> <span data-ttu-id="5b3b8-126">Pour plus d’informations, consultez ordre de recherche de la [bibliothèque de liens dynamiques](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="5b3b8-126">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>

    <span data-ttu-id="5b3b8-127">**Windows 7, Windows server 2008 R2, Windows Vista et Windows server 2008 :** Ces indicateurs et fonctions sont disponibles sur les systèmes sur lesquels [KB2533623](https://support.microsoft.com/kb/2533623) est installé.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-127">**Windows 7, Windows Server 2008 R2, Windows Vista and Windows Server 2008:** These flags and functions are available on systems with [KB2533623](https://support.microsoft.com/kb/2533623) installed.</span></span>

-   <span data-ttu-id="5b3b8-128">Sur les systèmes sur lesquels [KB2533623](https://support.microsoft.com/kb/2533623) est installé, utilisez les indicateurs de recherche de la \_ bibliothèque \_ de chargement avec la fonction [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) , ou utilisez ces indicateurs avec la fonction [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) pour établir un ordre de recherche de dll pour un processus, puis utilisez les fonctions [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) ou [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) pour modifier la liste.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-128">On systems with [KB2533623](https://support.microsoft.com/kb/2533623) installed, use the LOAD\_LIBRARY\_SEARCH flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function, or use these flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process and then use the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions to modify the list.</span></span> <span data-ttu-id="5b3b8-129">Pour plus d’informations, consultez ordre de recherche de la [bibliothèque de liens dynamiques](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="5b3b8-129">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>
-   <span data-ttu-id="5b3b8-130">Envisagez d’utiliser la [redirection de dll](dynamic-link-library-redirection.md) ou un [manifeste](/windows/desktop/SbsCs/manifests) pour vous assurer que votre application utilise la dll correcte.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-130">Consider using [DLL redirection](dynamic-link-library-redirection.md) or a [manifest](/windows/desktop/SbsCs/manifests) to ensure that your application uses the correct DLL.</span></span>
-   <span data-ttu-id="5b3b8-131">Lorsque vous utilisez l’ordre de recherche standard, assurez-vous que le mode de recherche de DLL sécurisé est activé.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-131">When using the standard search order, make sure that safe DLL search mode is enabled.</span></span> <span data-ttu-id="5b3b8-132">Cela place le répertoire actuel de l’utilisateur plus tard dans l’ordre de recherche, ce qui augmente le risque que Windows trouve une copie légitime de la DLL avant une copie malveillante.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-132">This places the user's current directory later in the search order, increasing the chances that Windows will find a legitimate copy of the DLL before a malicious copy.</span></span> <span data-ttu-id="5b3b8-133">Le mode de recherche de dll sécurisé est activé par défaut à partir de Windows XP avec Service Pack 2 (SP2) et est contrôlé par la valeur de Registre SafeDllSearchMode du gestionnaire de session de la clé **HKEY \_ local \_ machine \\ System \\ \\ \\** \\  .</span><span class="sxs-lookup"><span data-stu-id="5b3b8-133">Safe DLL search mode is enabled by default starting with Windows XP with Service Pack 2 (SP2) and is controlled by the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value.</span></span> <span data-ttu-id="5b3b8-134">Pour plus d’informations, consultez ordre de recherche de la [bibliothèque de liens dynamiques](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="5b3b8-134">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>
-   <span data-ttu-id="5b3b8-135">Envisagez de supprimer le répertoire actif du chemin de recherche standard en appelant [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) avec une chaîne vide ("").</span><span class="sxs-lookup"><span data-stu-id="5b3b8-135">Consider removing the current directory from the standard search path by calling [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) with an empty string ("").</span></span> <span data-ttu-id="5b3b8-136">Cela doit être fait une fois au début de l’initialisation du processus, et non avant et après les appels à [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya).</span><span class="sxs-lookup"><span data-stu-id="5b3b8-136">This should be done once early in process initialization, not before and after calls to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya).</span></span> <span data-ttu-id="5b3b8-137">Sachez que **SetDllDirectory** affecte l’ensemble du processus et que plusieurs threads appelant **SetDllDirectory** avec des valeurs différentes peuvent entraîner un comportement indéfini.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-137">Be aware that **SetDllDirectory** affects the entire process and that multiple threads calling **SetDllDirectory** with different values can cause undefined behavior.</span></span> <span data-ttu-id="5b3b8-138">Si votre application charge des dll tierces, testez-les soigneusement pour identifier les incompatibilités.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-138">If your application loads third-party DLLs, test carefully to identify any incompatibilities.</span></span>
-   <span data-ttu-id="5b3b8-139">N’utilisez pas la fonction [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) pour récupérer un chemin d’accès à une dll pour un appel [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) ultérieur, sauf si le mode de recherche de processus sécurisé est activé.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-139">Do not use the [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) function to retrieve a path to a DLL for a subsequent [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) call unless safe process search mode is enabled.</span></span> <span data-ttu-id="5b3b8-140">Lorsque le mode de recherche de processus sécurisé n’est pas activé, la fonction **SearchPath** utilise un ordre de recherche différent de **LoadLibrary** et est susceptible d’effectuer une recherche dans le répertoire actuel de l’utilisateur pour la DLL spécifiée.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-140">When safe process search mode is not enabled, the **SearchPath** function uses a different search order than **LoadLibrary** and is likely to first search the user's current directory for the specified DLL.</span></span> <span data-ttu-id="5b3b8-141">Pour activer le mode de recherche de processus sécurisé pour la fonction **SearchPath** , utilisez la fonction [**SetSearchPathMode**](/windows/desktop/api/winbase/nf-winbase-setsearchpathmode) avec le chemin de recherche de base \_ \_ \_ Enable \_ Safe \_ searchmode.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-141">To enable safe process search mode for the **SearchPath** function, use the [**SetSearchPathMode**](/windows/desktop/api/winbase/nf-winbase-setsearchpathmode) function with BASE\_SEARCH\_PATH\_ENABLE\_SAFE\_SEARCHMODE.</span></span> <span data-ttu-id="5b3b8-142">Cela déplace le répertoire actif à la fin de la liste de recherche de la **SearchPath** pendant la durée de vie du processus.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-142">This moves the current directory to the end of the **SearchPath** search list for the life of the process.</span></span> <span data-ttu-id="5b3b8-143">Notez que le répertoire actif n’est pas supprimé du chemin de recherche. par conséquent, si le système ne trouve pas de copie légitime de la DLL avant qu’il n’atteigne le répertoire actif, l’application est toujours vulnérable.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-143">Note that the current directory is not removed from the search path, so if the system does not find a legitimate copy of the DLL before it reaches the current directory, the application is still vulnerable.</span></span> <span data-ttu-id="5b3b8-144">Comme avec [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya), l’appel de **SetSearchPathMode** doit être effectué tôt dans l’initialisation du processus et affecte l’ensemble du processus.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-144">As with [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya), calling **SetSearchPathMode** should be done early in process initialization and it affects the entire process.</span></span> <span data-ttu-id="5b3b8-145">Si votre application charge des dll tierces, testez-les soigneusement pour identifier les incompatibilités.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-145">If your application loads third-party DLLs, test carefully to identify any incompatibilities.</span></span>
-   <span data-ttu-id="5b3b8-146">N’effectuez pas d’hypothèses sur la version du système d’exploitation en fonction d’un appel [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) qui recherche une dll.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-146">Do not make assumptions about the operating system version based on a [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) call that searches for a DLL.</span></span> <span data-ttu-id="5b3b8-147">Si l’application s’exécute dans un environnement où la DLL est légitimement absente mais où une copie malveillante de la DLL se trouve dans le chemin de recherche, la copie malveillante de la DLL peut être chargée.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-147">If the application is running in an environment where the DLL is legitimately not present but a malicious copy of the DLL is in the search path, the malicious copy of the DLL may be loaded.</span></span> <span data-ttu-id="5b3b8-148">Utilisez plutôt les techniques recommandées décrites dans [obtention de la version du système](/windows/desktop/SysInfo/getting-the-system-version).</span><span class="sxs-lookup"><span data-stu-id="5b3b8-148">Instead, use the recommended techniques described in [Getting the System Version](/windows/desktop/SysInfo/getting-the-system-version).</span></span>

<span data-ttu-id="5b3b8-149">L’outil process Monitor peut être utilisé pour identifier les opérations de chargement de DLL susceptibles d’être vulnérables.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-149">The Process Monitor tool can be used to help identify DLL load operations that might be vulnerable.</span></span> <span data-ttu-id="5b3b8-150">L’outil process Monitor peut être téléchargé à partir de <https://technet.microsoft.com/sysinternals/bb896645.aspx> .</span><span class="sxs-lookup"><span data-stu-id="5b3b8-150">The Process Monitor tool can be downloaded from <https://technet.microsoft.com/sysinternals/bb896645.aspx>.</span></span>

<span data-ttu-id="5b3b8-151">La procédure suivante décrit comment utiliser process Monitor pour examiner les opérations de chargement des DLL dans votre application.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-151">The following procedure describes how to use Process Monitor to examine DLL load operations in your application.</span></span>

<span data-ttu-id="5b3b8-152">**Pour utiliser process Monitor afin d’examiner les opérations de chargement des DLL dans votre application**</span><span class="sxs-lookup"><span data-stu-id="5b3b8-152">**To use Process Monitor to examine DLL load operations in your application**</span></span>

1.  <span data-ttu-id="5b3b8-153">Démarrez le moniteur de processus.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-153">Start Process Monitor.</span></span>
2.  <span data-ttu-id="5b3b8-154">Dans Process Monitor, incluez les filtres suivants :</span><span class="sxs-lookup"><span data-stu-id="5b3b8-154">In Process Monitor, include the following filters:</span></span>
    -   <span data-ttu-id="5b3b8-155">L’opération est CreateFile</span><span class="sxs-lookup"><span data-stu-id="5b3b8-155">Operation is CreateFile</span></span>
    -   <span data-ttu-id="5b3b8-156">L’opération est LoadImage</span><span class="sxs-lookup"><span data-stu-id="5b3b8-156">Operation is LoadImage</span></span>
    -   <span data-ttu-id="5b3b8-157">Le chemin contient. cpl</span><span class="sxs-lookup"><span data-stu-id="5b3b8-157">Path contains .cpl</span></span>
    -   <span data-ttu-id="5b3b8-158">Le chemin contient. dll</span><span class="sxs-lookup"><span data-stu-id="5b3b8-158">Path contains .dll</span></span>
    -   <span data-ttu-id="5b3b8-159">Le chemin d’accès contient. drv</span><span class="sxs-lookup"><span data-stu-id="5b3b8-159">Path contains .drv</span></span>
    -   <span data-ttu-id="5b3b8-160">Le chemin d’accès contient. exe</span><span class="sxs-lookup"><span data-stu-id="5b3b8-160">Path contains .exe</span></span>
    -   <span data-ttu-id="5b3b8-161">Le chemin d’accès contient. ocx</span><span class="sxs-lookup"><span data-stu-id="5b3b8-161">Path contains .ocx</span></span>
    -   <span data-ttu-id="5b3b8-162">Le chemin contient. SCR</span><span class="sxs-lookup"><span data-stu-id="5b3b8-162">Path contains .scr</span></span>
    -   <span data-ttu-id="5b3b8-163">Le chemin d’accès contient. sys</span><span class="sxs-lookup"><span data-stu-id="5b3b8-163">Path contains .sys</span></span>
3.  <span data-ttu-id="5b3b8-164">Excluez les filtres suivants :</span><span class="sxs-lookup"><span data-stu-id="5b3b8-164">Exclude the following filters:</span></span>
    -   <span data-ttu-id="5b3b8-165">Le nom du processus est procmon.exe</span><span class="sxs-lookup"><span data-stu-id="5b3b8-165">Process Name is procmon.exe</span></span>
    -   <span data-ttu-id="5b3b8-166">Le nom du processus est Procmon64.exe</span><span class="sxs-lookup"><span data-stu-id="5b3b8-166">Process Name is Procmon64.exe</span></span>
    -   <span data-ttu-id="5b3b8-167">Le nom du processus est System</span><span class="sxs-lookup"><span data-stu-id="5b3b8-167">Process Name is System</span></span>
    -   <span data-ttu-id="5b3b8-168">L’opération commence avec IRP \_ MJ\_</span><span class="sxs-lookup"><span data-stu-id="5b3b8-168">Operation begins with IRP\_MJ\_</span></span>
    -   <span data-ttu-id="5b3b8-169">L’opération commence par FASTIO\_</span><span class="sxs-lookup"><span data-stu-id="5b3b8-169">Operation begins with FASTIO\_</span></span>
    -   <span data-ttu-id="5b3b8-170">Résultat réussi</span><span class="sxs-lookup"><span data-stu-id="5b3b8-170">Result is SUCCESS</span></span>
    -   <span data-ttu-id="5b3b8-171">Le chemin d’accès se termine par pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="5b3b8-171">Path ends with pagefile.sys</span></span>
4.  <span data-ttu-id="5b3b8-172">Essayez de démarrer votre application avec le répertoire actif défini sur un répertoire spécifique.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-172">Attempt to start your application with the current directory set to a specific directory.</span></span> <span data-ttu-id="5b3b8-173">Par exemple, double-cliquez sur un fichier avec une extension dont le gestionnaire de fichiers est assigné à votre application.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-173">For example, double-click a file with an extension whose file handler is assigned to your application.</span></span>
5.  <span data-ttu-id="5b3b8-174">Vérifiez la sortie de process Monitor pour les chemins d’accès suspects, tels qu’un appel au répertoire actif pour charger une DLL.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-174">Check Process Monitor output for paths that look suspicious, such as a call to the current directory to load a DLL.</span></span> <span data-ttu-id="5b3b8-175">Ce type d’appel peut indiquer une vulnérabilité dans votre application.</span><span class="sxs-lookup"><span data-stu-id="5b3b8-175">This kind of call might indicate a vulnerability in your application.</span></span>

 

 
