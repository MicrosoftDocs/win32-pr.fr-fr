---
description: Les applications peuvent dépendre d’une version spécifique d’une DLL partagée et commencer à échouer si une autre application est installée avec une version plus récente ou plus ancienne de la même DLL.
ms.assetid: 3b426b6c-1ad5-43b9-81ea-5e6d3c6588c8
title: Redirection de la bibliothèque de Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b575d566231058cca13c10a067a3c2e20078073
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106534391"
---
# <a name="dynamic-link-library-redirection"></a><span data-ttu-id="7d541-103">Redirection de la bibliothèque de Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="7d541-103">Dynamic-Link Library Redirection</span></span>

<span data-ttu-id="7d541-104">Les applications peuvent dépendre d’une version spécifique d’une DLL partagée et commencer à échouer si une autre application est installée avec une version plus récente ou plus ancienne de la même DLL.</span><span class="sxs-lookup"><span data-stu-id="7d541-104">Applications can depend on a specific version of a shared DLL and start to fail if another application is installed with a newer or older version of the same DLL.</span></span> <span data-ttu-id="7d541-105">Il existe deux façons de s’assurer que votre application utilise la DLL correcte : la redirection de DLL et les composants côte à côte.</span><span class="sxs-lookup"><span data-stu-id="7d541-105">There are two ways to ensure that your application uses the correct DLL: DLL redirection and side-by-side components.</span></span> <span data-ttu-id="7d541-106">Les développeurs et les administrateurs doivent utiliser la redirection de DLL pour les applications existantes, car elles ne nécessitent aucune modification de l’application.</span><span class="sxs-lookup"><span data-stu-id="7d541-106">Developers and administrators should use DLL redirection for existing applications, because it does not require any changes to the application.</span></span> <span data-ttu-id="7d541-107">Si vous créez une nouvelle application ou que vous mettez à jour une application et souhaitez isoler votre application des problèmes potentiels, créez un [composant côte à côte](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="7d541-107">If you are creating a new application or updating an application and want to isolate your application from potential problems, create a [side-by-side component](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="7d541-108">Pour activer la redirection de DLL au niveau de l’ordinateur, vous devez créer une nouvelle clé de registre.</span><span class="sxs-lookup"><span data-stu-id="7d541-108">To enable DLL redirection machine-wide, you must create a new registry key.</span></span> <span data-ttu-id="7d541-109">Créez une nouvelle clé DWORD appelée **DevOverrideEnable** dans **HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution** , puis définissez-la sur 1.</span><span class="sxs-lookup"><span data-stu-id="7d541-109">Create a new DWORD key called **DevOverrideEnable** at **HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options** and set it to 1.</span></span> <span data-ttu-id="7d541-110">Après cela, vous devez redémarrer votre ordinateur pour voir les effets.</span><span class="sxs-lookup"><span data-stu-id="7d541-110">After this, you must restart your computer to see the effects.</span></span>

<span data-ttu-id="7d541-111">Pour utiliser la redirection de DLL, créez un *fichier de redirection* pour votre application.</span><span class="sxs-lookup"><span data-stu-id="7d541-111">To use DLL redirection, create a *redirection file* for your application.</span></span> <span data-ttu-id="7d541-112">Le fichier de redirection doit être nommé comme suit : *app \_ Name*. local.</span><span class="sxs-lookup"><span data-stu-id="7d541-112">The redirection file must be named as follows: *App\_name*.local.</span></span> <span data-ttu-id="7d541-113">Par exemple, si le nom de l’application est Editor.exe, le fichier de redirection doit être nommé Editor.exe. local.</span><span class="sxs-lookup"><span data-stu-id="7d541-113">For example, if the application name is Editor.exe, the redirection file should be named Editor.exe.local.</span></span> <span data-ttu-id="7d541-114">Vous devez installer le fichier. local dans le répertoire de l’application.</span><span class="sxs-lookup"><span data-stu-id="7d541-114">You must install the .local file in the application directory.</span></span> <span data-ttu-id="7d541-115">Vous devez également installer les dll dans le répertoire de l’application.</span><span class="sxs-lookup"><span data-stu-id="7d541-115">You must also install the DLLs in the application directory.</span></span>

<span data-ttu-id="7d541-116">Le contenu d’un fichier de redirection est ignoré, mais sa présence fait que Windows vérifie d’abord le répertoire de l’application chaque fois qu’il charge une DLL, quel que soit le chemin d’accès spécifié pour [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) ou [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="7d541-116">The contents of a redirection file are ignored, but its presence causes Windows to check the application directory first whenever it loads a DLL, regardless of the path specified to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="7d541-117">Si la DLL est introuvable dans le répertoire de l’application, ces fonctions utilisent leur ordre de recherche habituel.</span><span class="sxs-lookup"><span data-stu-id="7d541-117">If the DLL is not found in the application directory, then these functions use their usual search order.</span></span> <span data-ttu-id="7d541-118">Par exemple, si l’application c : \\ myapp \\myapp.exe appelle **LoadLibrary** à l’aide du chemin d’accès suivant :</span><span class="sxs-lookup"><span data-stu-id="7d541-118">For example, if the application c:\\myapp\\myapp.exe calls **LoadLibrary** using the following path:</span></span>

<span data-ttu-id="7d541-119">c : \\ Program Files \\ système de fichiers communs \\ \\mydll.dll</span><span class="sxs-lookup"><span data-stu-id="7d541-119">c:\\program files\\common files\\system\\mydll.dll</span></span>

<span data-ttu-id="7d541-120">Et, si c : \\ myapp \\myapp.exe. local et c : \\ MyApp \\mydll.dll existent, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) charge c : \\ MyApp \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="7d541-120">And, if both c:\\myapp\\myapp.exe.local and c:\\myapp\\mydll.dll exist, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\mydll.dll.</span></span> <span data-ttu-id="7d541-121">Sinon, **LoadLibrary** charge le \\ système de fichiers communs c : Program Files \\ \\ \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="7d541-121">Otherwise, **LoadLibrary** loads c:\\program files\\common files\\system\\mydll.dll.</span></span>

<span data-ttu-id="7d541-122">Sinon, si un répertoire nommé c : \\ myapp \\myapp.exe. local existe et contient mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) charge c : \\ MyApp \\myapp.exe. local \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="7d541-122">Alternatively, if a directory named c:\\myapp\\myapp.exe.local exists and contains mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\myapp.exe.local\\mydll.dll.</span></span>

<span data-ttu-id="7d541-123">Si l’application a un manifeste, tous les fichiers. local sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="7d541-123">If the application has a manifest, then any .local files are ignored.</span></span>

<span data-ttu-id="7d541-124">Si vous utilisez la redirection de DLL et que l’application n’a pas accès à tous les lecteurs et répertoires dans l’ordre de recherche, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) arrête la recherche dès que l’accès est refusé.</span><span class="sxs-lookup"><span data-stu-id="7d541-124">If you are using DLL redirection and the application does not have access to all drives and directories in the search order, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) stops searching as soon as access is denied.</span></span> <span data-ttu-id="7d541-125">(Si vous n’utilisez pas la redirection de DLL, **LoadLibrary** ignore les répertoires auxquels il ne peut pas accéder, puis poursuit la recherche.)</span><span class="sxs-lookup"><span data-stu-id="7d541-125">(If you are not using DLL redirection, **LoadLibrary** skips directories that it cannot access and then continues searching.)</span></span>

<span data-ttu-id="7d541-126">Il est recommandé d’installer des dll d’application dans le même répertoire que celui qui contient l’application, même si vous n’utilisez pas la redirection de DLL.</span><span class="sxs-lookup"><span data-stu-id="7d541-126">It is good practice to install application DLLs in the same directory that contains the application, even if you are not using DLL redirection.</span></span> <span data-ttu-id="7d541-127">Cela permet de s’assurer que l’installation de l’application ne remplace pas d’autres copies de la DLL et provoque l’échec d’autres applications.</span><span class="sxs-lookup"><span data-stu-id="7d541-127">This ensures that installing the application does not overwrite other copies of the DLL and cause other applications to fail.</span></span> <span data-ttu-id="7d541-128">En outre, si vous suivez cette bonne pratique, les autres applications ne remplacent pas votre copie de la DLL et provoquent l’échec de votre application.</span><span class="sxs-lookup"><span data-stu-id="7d541-128">Also, if you follow this good practice, other applications do not overwrite your copy of the DLL and cause your application to fail.</span></span>

 

 
