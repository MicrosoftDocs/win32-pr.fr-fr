---
description: Les applications peuvent contrôler l’emplacement à partir duquel une DLL est chargée en spécifiant un chemin d’accès complet ou en utilisant un autre mécanisme tel qu’un manifeste. Si ces méthodes ne sont pas utilisées, le système recherche la DLL au moment du chargement, comme décrit dans cette rubrique.
ms.assetid: 44228cf2-6306-466c-8f16-f513cd3ba8b5
title: Ordre de recherche de la bibliothèque Dynamic-Link
ms.topic: article
ms.date: 09/11/2020
ms.custom: contperf-fy21q1
ms.openlocfilehash: 928cf9030e24c91145ae95e1eed680017bf68533
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/04/2021
ms.locfileid: "104520332"
---
# <a name="dynamic-link-library-search-order"></a><span data-ttu-id="cf924-104">Ordre de recherche de la bibliothèque Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="cf924-104">Dynamic-Link Library Search Order</span></span>

<span data-ttu-id="cf924-105">Un système peut contenir plusieurs versions de la même bibliothèque de liens dynamiques (DLL).</span><span class="sxs-lookup"><span data-stu-id="cf924-105">A system can contain multiple versions of the same dynamic-link library (DLL).</span></span> <span data-ttu-id="cf924-106">Les applications peuvent contrôler l’emplacement à partir duquel une DLL est chargée en spécifiant un chemin d’accès complet ou en utilisant un autre mécanisme tel qu’un manifeste.</span><span class="sxs-lookup"><span data-stu-id="cf924-106">Applications can control the location from which a DLL is loaded by specifying a full path or using another mechanism such as a manifest.</span></span> <span data-ttu-id="cf924-107">Si ces méthodes ne sont pas utilisées, le système recherche la DLL au moment du chargement, comme décrit dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="cf924-107">If these methods are not used, the system searches for the DLL at load time as described in this topic.</span></span>

-   [<span data-ttu-id="cf924-108">Facteurs qui affectent la recherche</span><span class="sxs-lookup"><span data-stu-id="cf924-108">Factors That Affect Searching</span></span>](#factors-that-affect-searching)
-   [<span data-ttu-id="cf924-109">Ordre de recherche des applications UWP</span><span class="sxs-lookup"><span data-stu-id="cf924-109">Search Order for UWP Apps</span></span>](#search-order-for-uwp-apps)
    -   [<span data-ttu-id="cf924-110">Ordre de recherche standard pour les applications UWP</span><span class="sxs-lookup"><span data-stu-id="cf924-110">Standard Search Order for UWP Apps</span></span>](#standard-search-order-for-uwp-apps)
    -   [<span data-ttu-id="cf924-111">Ordre de recherche alternatif pour les applications UWP</span><span class="sxs-lookup"><span data-stu-id="cf924-111">Alternate Search Order for UWP Apps</span></span>](#alternate-search-order-for-uwp-apps)
-   [<span data-ttu-id="cf924-112">Ordre de recherche pour les applications de bureau</span><span class="sxs-lookup"><span data-stu-id="cf924-112">Search Order for Desktop Applications</span></span>](#search-order-for-desktop-applications)
    -   [<span data-ttu-id="cf924-113">Ordre de recherche standard pour les applications de bureau</span><span class="sxs-lookup"><span data-stu-id="cf924-113">Standard Search Order for Desktop Applications</span></span>](#standard-search-order-for-desktop-applications)
    -   [<span data-ttu-id="cf924-114">Ordre de recherche alternatif pour les applications de bureau</span><span class="sxs-lookup"><span data-stu-id="cf924-114">Alternate Search Order for Desktop Applications</span></span>](#alternate-search-order-for-desktop-applications)
    -   [<span data-ttu-id="cf924-115">Ordre de recherche à l’aide des indicateurs de **\_ \_ recherche** de la bibliothèque de chargement</span><span class="sxs-lookup"><span data-stu-id="cf924-115">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>](/windows)
-   [<span data-ttu-id="cf924-116">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="cf924-116">Related topics</span></span>](#related-topics)

## <a name="factors-that-affect-searching"></a><span data-ttu-id="cf924-117">Facteurs qui affectent la recherche</span><span class="sxs-lookup"><span data-stu-id="cf924-117">Factors That Affect Searching</span></span>

<span data-ttu-id="cf924-118">Les facteurs suivants déterminent si le système recherche une DLL :</span><span class="sxs-lookup"><span data-stu-id="cf924-118">The following factors affect whether the system searches for a DLL:</span></span>

-   <span data-ttu-id="cf924-119">Si une DLL portant le même nom de module est déjà chargée en mémoire, le système vérifie uniquement la redirection et un manifeste avant de résoudre la DLL chargée, quel que soit le répertoire dans lequel elle se trouve.</span><span class="sxs-lookup"><span data-stu-id="cf924-119">If a DLL with the same module name is already loaded in memory, the system checks only for redirection and a manifest before resolving to the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="cf924-120">Le système ne recherche pas la DLL.</span><span class="sxs-lookup"><span data-stu-id="cf924-120">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="cf924-121">Si la DLL se trouve dans la liste des dll connues pour la version de Windows sur laquelle l’application s’exécute, le système utilise sa copie de la DLL connue (et les dll dépendantes de la DLL connue, le cas échéant) au lieu de rechercher la DLL.</span><span class="sxs-lookup"><span data-stu-id="cf924-121">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any) instead of searching for the DLL.</span></span> <span data-ttu-id="cf924-122">Pour obtenir la liste des dll connues sur le système actuel, consultez la clé de Registre suivante : **HKEY \_ local \_ machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="cf924-122">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>
-   <span data-ttu-id="cf924-123">Si une DLL a des dépendances, le système recherche les dll dépendantes comme si elles étaient chargées avec uniquement leurs noms de module.</span><span class="sxs-lookup"><span data-stu-id="cf924-123">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="cf924-124">Cela est vrai même si la première DLL a été chargée en spécifiant un chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="cf924-124">This is true even if the first DLL was loaded by specifying a full path.</span></span>

## <a name="search-order-for-uwp-apps"></a><span data-ttu-id="cf924-125">Ordre de recherche des applications UWP</span><span class="sxs-lookup"><span data-stu-id="cf924-125">Search Order for UWP apps</span></span>

<span data-ttu-id="cf924-126">Quand une application UWP pour Windows 10 (ou une application Windows Store pour Windows 8. x) charge un module empaqueté en appelant la fonction [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) , celle-ci doit se trouver dans le graphique de dépendance du package du processus.</span><span class="sxs-lookup"><span data-stu-id="cf924-126">When a UWP app for Windows 10 (or a Store app for Windows 8.x) loads a packaged module by calling the [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) function, the DLL must be in the package dependency graph of the process.</span></span> <span data-ttu-id="cf924-127">Pour plus d’informations, consultez **LoadPackagedLibrary**.</span><span class="sxs-lookup"><span data-stu-id="cf924-127">For more information, see **LoadPackagedLibrary**.</span></span> <span data-ttu-id="cf924-128">Quand une application UWP charge un module par d’autres moyens et ne spécifie pas de chemin d’accès complet, le système recherche la DLL et ses dépendances au moment du chargement, comme décrit dans cette section.</span><span class="sxs-lookup"><span data-stu-id="cf924-128">When a UWP app loads a module by other means and does not specify a full path, the system searches for the DLL and its dependencies at load time as described in this section.</span></span>

<span data-ttu-id="cf924-129">Avant que le système ne recherche une DLL, il vérifie les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="cf924-129">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="cf924-130">Si une DLL portant le même nom de module est déjà chargée en mémoire, le système utilise la DLL chargée, quel que soit le répertoire dans lequel elle se trouve.</span><span class="sxs-lookup"><span data-stu-id="cf924-130">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="cf924-131">Le système ne recherche pas la DLL.</span><span class="sxs-lookup"><span data-stu-id="cf924-131">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="cf924-132">Si la DLL se trouve dans la liste des dll connues pour la version de Windows sur laquelle l’application s’exécute, le système utilise sa copie de la DLL connue (et les dll dépendantes de la DLL connue, le cas échéant).</span><span class="sxs-lookup"><span data-stu-id="cf924-132">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="cf924-133">Le système ne recherche pas la DLL.</span><span class="sxs-lookup"><span data-stu-id="cf924-133">The system does not search for the DLL.</span></span> <span data-ttu-id="cf924-134">Pour obtenir la liste des dll connues sur le système actuel, consultez la clé de Registre suivante : **HKEY \_ local \_ machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="cf924-134">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="cf924-135">Si le système doit rechercher un module ou ses dépendances, il utilise toujours l’ordre de recherche des applications UWP, même si une dépendance n’est pas un code d’application UWP.</span><span class="sxs-lookup"><span data-stu-id="cf924-135">If the system must search for a module or its dependencies, it always uses the search order for UWP apps even if a dependency is not UWP app code.</span></span>

### <a name="standard-search-order-for-uwp-apps"></a><span data-ttu-id="cf924-136">Ordre de recherche standard pour les applications UWP</span><span class="sxs-lookup"><span data-stu-id="cf924-136">Standard Search Order for UWP apps</span></span>

<span data-ttu-id="cf924-137">Si le module n’est pas déjà chargé ou dans la liste des dll connues, le système recherche les emplacements suivants dans cet ordre :</span><span class="sxs-lookup"><span data-stu-id="cf924-137">If the module is not already loaded or on the list of known DLLs, the system searches these locations in this order:</span></span>

1.  <span data-ttu-id="cf924-138">Graphique de dépendance du package du processus.</span><span class="sxs-lookup"><span data-stu-id="cf924-138">The package dependency graph of the process.</span></span> <span data-ttu-id="cf924-139">Il s’agit du package de l’application et de toutes les dépendances spécifiées comme `<PackageDependency>` dans la `<Dependencies>` section du manifeste du package de l’application.</span><span class="sxs-lookup"><span data-stu-id="cf924-139">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="cf924-140">Les dépendances sont recherchées dans l’ordre dans lequel elles apparaissent dans le manifeste.</span><span class="sxs-lookup"><span data-stu-id="cf924-140">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="cf924-141">Répertoire à partir duquel le processus appelant a été chargé.</span><span class="sxs-lookup"><span data-stu-id="cf924-141">The directory the calling process was loaded from.</span></span>
3.  <span data-ttu-id="cf924-142">Répertoire système (% SystemRoot% \\ system32).</span><span class="sxs-lookup"><span data-stu-id="cf924-142">The system directory (%SystemRoot%\\system32).</span></span>

<span data-ttu-id="cf924-143">Si une DLL a des dépendances, le système recherche les dll dépendantes comme si elles étaient chargées avec uniquement leurs noms de module.</span><span class="sxs-lookup"><span data-stu-id="cf924-143">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="cf924-144">Cela est vrai même si la première DLL a été chargée en spécifiant un chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="cf924-144">This is true even if the first DLL was loaded by specifying a full path.</span></span>

### <a name="alternate-search-order-for-uwp-apps"></a><span data-ttu-id="cf924-145">Ordre de recherche alternatif pour les applications UWP</span><span class="sxs-lookup"><span data-stu-id="cf924-145">Alternate Search Order for UWP apps</span></span>

<span data-ttu-id="cf924-146">Si un module modifie l’ordre de recherche standard en appelant la fonction [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) avec le **\_ \_ \_ \_ chemin de recherche modifié**, le système recherche dans le répertoire que le module spécifié a été chargé à partir du répertoire du processus appelant.</span><span class="sxs-lookup"><span data-stu-id="cf924-146">If a module changes the standard search order by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**, the system searches the directory the specified module was loaded from instead of the directory of the calling process.</span></span> <span data-ttu-id="cf924-147">Le système recherche les emplacements suivants dans cet ordre :</span><span class="sxs-lookup"><span data-stu-id="cf924-147">The system searches these locations in this order:</span></span>

1.  <span data-ttu-id="cf924-148">Graphique de dépendance du package du processus.</span><span class="sxs-lookup"><span data-stu-id="cf924-148">The package dependency graph of the process.</span></span> <span data-ttu-id="cf924-149">Il s’agit du package de l’application et de toutes les dépendances spécifiées comme `<PackageDependency>` dans la `<Dependencies>` section du manifeste du package de l’application.</span><span class="sxs-lookup"><span data-stu-id="cf924-149">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="cf924-150">Les dépendances sont recherchées dans l’ordre dans lequel elles apparaissent dans le manifeste.</span><span class="sxs-lookup"><span data-stu-id="cf924-150">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="cf924-151">Répertoire à partir duquel le module spécifié a été chargé.</span><span class="sxs-lookup"><span data-stu-id="cf924-151">The directory the specified module was loaded from.</span></span>
3.  <span data-ttu-id="cf924-152">Répertoire système (% SystemRoot% \\ system32).</span><span class="sxs-lookup"><span data-stu-id="cf924-152">The system directory (%SystemRoot%\\system32).</span></span>

## <a name="search-order-for-desktop-applications"></a><span data-ttu-id="cf924-153">Ordre de recherche pour les applications de bureau</span><span class="sxs-lookup"><span data-stu-id="cf924-153">Search Order for Desktop Applications</span></span>

<span data-ttu-id="cf924-154">Les applications de bureau peuvent contrôler l’emplacement à partir duquel une DLL est chargée en spécifiant un chemin d’accès complet, à l’aide de la [redirection de dll](dynamic-link-library-redirection.md)ou à l’aide d’un [manifeste](/windows/desktop/SbsCs/manifests).</span><span class="sxs-lookup"><span data-stu-id="cf924-154">Desktop applications can control the location from which a DLL is loaded by specifying a full path, using [DLL redirection](dynamic-link-library-redirection.md), or by using a [manifest](/windows/desktop/SbsCs/manifests).</span></span> <span data-ttu-id="cf924-155">Si aucune de ces méthodes n’est utilisée, le système recherche la DLL au moment du chargement, comme décrit dans cette section.</span><span class="sxs-lookup"><span data-stu-id="cf924-155">If none of these methods are used, the system searches for the DLL at load time as described in this section.</span></span>

<span data-ttu-id="cf924-156">Avant que le système ne recherche une DLL, il vérifie les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="cf924-156">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="cf924-157">Si une DLL portant le même nom de module est déjà chargée en mémoire, le système utilise la DLL chargée, quel que soit le répertoire dans lequel elle se trouve.</span><span class="sxs-lookup"><span data-stu-id="cf924-157">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="cf924-158">Le système ne recherche pas la DLL.</span><span class="sxs-lookup"><span data-stu-id="cf924-158">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="cf924-159">Si la DLL se trouve dans la liste des dll connues pour la version de Windows sur laquelle l’application s’exécute, le système utilise sa copie de la DLL connue (et les dll dépendantes de la DLL connue, le cas échéant).</span><span class="sxs-lookup"><span data-stu-id="cf924-159">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="cf924-160">Le système ne recherche pas la DLL.</span><span class="sxs-lookup"><span data-stu-id="cf924-160">The system does not search for the DLL.</span></span> <span data-ttu-id="cf924-161">Pour obtenir la liste des dll connues sur le système actuel, consultez la clé de Registre suivante : **HKEY \_ local \_ machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="cf924-161">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="cf924-162">Si une DLL a des dépendances, le système recherche les dll dépendantes comme si elles étaient chargées avec uniquement leurs noms de module.</span><span class="sxs-lookup"><span data-stu-id="cf924-162">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="cf924-163">Cela est vrai même si la première DLL a été chargée en spécifiant un chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="cf924-163">This is true even if the first DLL was loaded by specifying a full path.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="cf924-164">Si une personne malveillante prend le contrôle de l’un des répertoires dans lesquels elle est recherchée, elle peut placer une copie malveillante de la DLL dans ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-164">If an attacker gains control of one of the directories that is searched, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="cf924-165">Pour plus d’informations sur les méthodes permettant d’éviter de telles attaques, consultez [sécurité de la bibliothèque de liens dynamiques](dynamic-link-library-security.md).</span><span class="sxs-lookup"><span data-stu-id="cf924-165">For ways to help prevent such attacks, see [Dynamic-Link Library Security](dynamic-link-library-security.md).</span></span>

### <a name="standard-search-order-for-desktop-applications"></a><span data-ttu-id="cf924-166">Ordre de recherche standard pour les applications de bureau</span><span class="sxs-lookup"><span data-stu-id="cf924-166">Standard Search Order for Desktop Applications</span></span>

<span data-ttu-id="cf924-167">L’ordre de recherche des DLL standard utilisé par le système varie selon que le mode de recherche de DLL sécurisé est activé ou désactivé.</span><span class="sxs-lookup"><span data-stu-id="cf924-167">The standard DLL search order used by the system depends on whether safe DLL search mode is enabled or disabled.</span></span> <span data-ttu-id="cf924-168">Le mode de recherche de DLL sécurisé place le répertoire actuel de l’utilisateur plus tard dans l’ordre de recherche.</span><span class="sxs-lookup"><span data-stu-id="cf924-168">Safe DLL search mode places the user's current directory later in the search order.</span></span>

<span data-ttu-id="cf924-169">Le mode de recherche de DLL sécurisé est activé par défaut.</span><span class="sxs-lookup"><span data-stu-id="cf924-169">Safe DLL search mode is enabled by default.</span></span> <span data-ttu-id="cf924-170">Pour désactiver cette fonctionnalité, créez la valeur de Registre SafeDllSearchMode du **\_ Gestionnaire de \_ \\ \\ \\ \\ session** de la clé HKEY locale de l’ordinateur local \\  et affectez-lui la valeur 0.</span><span class="sxs-lookup"><span data-stu-id="cf924-170">To disable this feature, create the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value and set it to 0.</span></span> <span data-ttu-id="cf924-171">L’appel de la fonction [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) désactive efficacement **SafeDllSearchMode** alors que le répertoire spécifié se trouve dans le chemin de recherche et modifie l’ordre de recherche comme décrit dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="cf924-171">Calling the [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) function effectively disables **SafeDllSearchMode** while the specified directory is in the search path and changes the search order as described in this topic.</span></span>

<span data-ttu-id="cf924-172">Si **SafeDllSearchMode** est activé, l’ordre de recherche est le suivant :</span><span class="sxs-lookup"><span data-stu-id="cf924-172">If **SafeDllSearchMode** is enabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="cf924-173">Répertoire à partir duquel l’application a été chargée.</span><span class="sxs-lookup"><span data-stu-id="cf924-173">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="cf924-174">Répertoire du système.</span><span class="sxs-lookup"><span data-stu-id="cf924-174">The system directory.</span></span> <span data-ttu-id="cf924-175">Utilisez la fonction [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-175">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="cf924-176">Répertoire système 16 bits.</span><span class="sxs-lookup"><span data-stu-id="cf924-176">The 16-bit system directory.</span></span> <span data-ttu-id="cf924-177">Aucune fonction n’obtient le chemin d’accès de ce répertoire, mais elle est recherchée.</span><span class="sxs-lookup"><span data-stu-id="cf924-177">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="cf924-178">Répertoire Windows.</span><span class="sxs-lookup"><span data-stu-id="cf924-178">The Windows directory.</span></span> <span data-ttu-id="cf924-179">Utilisez la fonction [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-179">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="cf924-180">Le répertoire actif.</span><span class="sxs-lookup"><span data-stu-id="cf924-180">The current directory.</span></span>
6.  <span data-ttu-id="cf924-181">Répertoires répertoriés dans la variable d’environnement PATH.</span><span class="sxs-lookup"><span data-stu-id="cf924-181">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cf924-182">Notez que cela n’inclut pas le chemin d’accès par application spécifié par la clé de Registre **App Paths** .</span><span class="sxs-lookup"><span data-stu-id="cf924-182">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cf924-183">La clé **chemins d’accès** à l’application n’est pas utilisée lors du calcul du chemin de recherche de dll.</span><span class="sxs-lookup"><span data-stu-id="cf924-183">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="cf924-184">Si **SafeDllSearchMode** est désactivé, l’ordre de recherche est le suivant :</span><span class="sxs-lookup"><span data-stu-id="cf924-184">If **SafeDllSearchMode** is disabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="cf924-185">Répertoire à partir duquel l’application a été chargée.</span><span class="sxs-lookup"><span data-stu-id="cf924-185">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="cf924-186">Le répertoire actif.</span><span class="sxs-lookup"><span data-stu-id="cf924-186">The current directory.</span></span>
3.  <span data-ttu-id="cf924-187">Répertoire du système.</span><span class="sxs-lookup"><span data-stu-id="cf924-187">The system directory.</span></span> <span data-ttu-id="cf924-188">Utilisez la fonction [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-188">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="cf924-189">Répertoire système 16 bits.</span><span class="sxs-lookup"><span data-stu-id="cf924-189">The 16-bit system directory.</span></span> <span data-ttu-id="cf924-190">Aucune fonction n’obtient le chemin d’accès de ce répertoire, mais elle est recherchée.</span><span class="sxs-lookup"><span data-stu-id="cf924-190">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="cf924-191">Répertoire Windows.</span><span class="sxs-lookup"><span data-stu-id="cf924-191">The Windows directory.</span></span> <span data-ttu-id="cf924-192">Utilisez la fonction [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-192">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="cf924-193">Répertoires répertoriés dans la variable d’environnement PATH.</span><span class="sxs-lookup"><span data-stu-id="cf924-193">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cf924-194">Notez que cela n’inclut pas le chemin d’accès par application spécifié par la clé de Registre **App Paths** .</span><span class="sxs-lookup"><span data-stu-id="cf924-194">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cf924-195">La clé **chemins d’accès** à l’application n’est pas utilisée lors du calcul du chemin de recherche de dll.</span><span class="sxs-lookup"><span data-stu-id="cf924-195">The **App Paths** key is not used when computing the DLL search path.</span></span>

### <a name="alternate-search-order-for-desktop-applications"></a><span data-ttu-id="cf924-196">Ordre de recherche alternatif pour les applications de bureau</span><span class="sxs-lookup"><span data-stu-id="cf924-196">Alternate Search Order for Desktop Applications</span></span>

<span data-ttu-id="cf924-197">L’ordre de recherche standard utilisé par le système peut être modifié en appelant la fonction [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) avec le **\_ \_ \_ \_ chemin de recherche modifié**.</span><span class="sxs-lookup"><span data-stu-id="cf924-197">The standard search order used by the system can be changed by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**.</span></span> <span data-ttu-id="cf924-198">L’ordre de recherche standard peut également être modifié en appelant la fonction [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cf924-198">The standard search order can also be changed by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span>

> [!NOTE]
> <span data-ttu-id="cf924-199">L’ordre de recherche standard du processus est également affecté par l’appel de la fonction [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) dans le processus parent avant le démarrage du processus actuel.</span><span class="sxs-lookup"><span data-stu-id="cf924-199">The standard search order of the process will also be affected by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function in the parent process before start of the current process.</span></span>

<span data-ttu-id="cf924-200">Si vous spécifiez une autre stratégie de recherche, son comportement continue jusqu’à ce que tous les modules exécutables associés aient été localisés.</span><span class="sxs-lookup"><span data-stu-id="cf924-200">If you specify an alternate search strategy, its behavior continues until all associated executable modules have been located.</span></span> <span data-ttu-id="cf924-201">Une fois que le système a démarré le traitement des routines d’initialisation de la DLL, le système revient à la stratégie de recherche standard.</span><span class="sxs-lookup"><span data-stu-id="cf924-201">After the system starts processing DLL initialization routines, the system reverts to the standard search strategy.</span></span>

<span data-ttu-id="cf924-202">La fonction [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) prend en charge un ordre de recherche alternatif si l’appel spécifie le **chargement avec un \_ \_ \_ \_ chemin de recherche modifié** et le paramètre *lpFileName* spécifie un chemin d’accès absolu.</span><span class="sxs-lookup"><span data-stu-id="cf924-202">The [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function supports an alternate search order if the call specifies **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** and the *lpFileName* parameter specifies an absolute path.</span></span>

<span data-ttu-id="cf924-203">Notez que la stratégie de recherche standard et la stratégie de recherche alternative spécifiée par [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) avec le **\_ \_ \_ \_ chemin de recherche modifié** diffèrent d’une seule façon : la recherche standard commence dans le répertoire de l’application appelante, et l’autre recherche commence dans le répertoire du module exécutable que **LoadLibraryEx** est en cours de chargement.</span><span class="sxs-lookup"><span data-stu-id="cf924-203">Note that the standard search strategy and the alternate search strategy specified by [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** differ in just one way: The standard search begins in the calling application's directory, and the alternate search begins in the directory of the executable module that **LoadLibraryEx** is loading.</span></span>

<span data-ttu-id="cf924-204">Si **SafeDllSearchMode** est activé, l’ordre de recherche alternatif est le suivant :</span><span class="sxs-lookup"><span data-stu-id="cf924-204">If **SafeDllSearchMode** is enabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="cf924-205">Répertoire spécifié par *lpFileName*.</span><span class="sxs-lookup"><span data-stu-id="cf924-205">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="cf924-206">Répertoire du système.</span><span class="sxs-lookup"><span data-stu-id="cf924-206">The system directory.</span></span> <span data-ttu-id="cf924-207">Utilisez la fonction [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-207">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="cf924-208">Répertoire système 16 bits.</span><span class="sxs-lookup"><span data-stu-id="cf924-208">The 16-bit system directory.</span></span> <span data-ttu-id="cf924-209">Aucune fonction n’obtient le chemin d’accès de ce répertoire, mais elle est recherchée.</span><span class="sxs-lookup"><span data-stu-id="cf924-209">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="cf924-210">Répertoire Windows.</span><span class="sxs-lookup"><span data-stu-id="cf924-210">The Windows directory.</span></span> <span data-ttu-id="cf924-211">Utilisez la fonction [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-211">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="cf924-212">Le répertoire actif.</span><span class="sxs-lookup"><span data-stu-id="cf924-212">The current directory.</span></span>
6.  <span data-ttu-id="cf924-213">Répertoires répertoriés dans la variable d’environnement PATH.</span><span class="sxs-lookup"><span data-stu-id="cf924-213">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cf924-214">Notez que cela n’inclut pas le chemin d’accès par application spécifié par la clé de Registre **App Paths** .</span><span class="sxs-lookup"><span data-stu-id="cf924-214">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cf924-215">La clé **chemins d’accès** à l’application n’est pas utilisée lors du calcul du chemin de recherche de dll.</span><span class="sxs-lookup"><span data-stu-id="cf924-215">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="cf924-216">Si **SafeDllSearchMode** est désactivé, l’ordre de recherche alternatif est le suivant :</span><span class="sxs-lookup"><span data-stu-id="cf924-216">If **SafeDllSearchMode** is disabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="cf924-217">Répertoire spécifié par *lpFileName*.</span><span class="sxs-lookup"><span data-stu-id="cf924-217">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="cf924-218">Le répertoire actif.</span><span class="sxs-lookup"><span data-stu-id="cf924-218">The current directory.</span></span>
3.  <span data-ttu-id="cf924-219">Répertoire du système.</span><span class="sxs-lookup"><span data-stu-id="cf924-219">The system directory.</span></span> <span data-ttu-id="cf924-220">Utilisez la fonction [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-220">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="cf924-221">Répertoire système 16 bits.</span><span class="sxs-lookup"><span data-stu-id="cf924-221">The 16-bit system directory.</span></span> <span data-ttu-id="cf924-222">Aucune fonction n’obtient le chemin d’accès de ce répertoire, mais elle est recherchée.</span><span class="sxs-lookup"><span data-stu-id="cf924-222">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="cf924-223">Répertoire Windows.</span><span class="sxs-lookup"><span data-stu-id="cf924-223">The Windows directory.</span></span> <span data-ttu-id="cf924-224">Utilisez la fonction [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-224">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="cf924-225">Répertoires répertoriés dans la variable d’environnement PATH.</span><span class="sxs-lookup"><span data-stu-id="cf924-225">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cf924-226">Notez que cela n’inclut pas le chemin d’accès par application spécifié par la clé de Registre **App Paths** .</span><span class="sxs-lookup"><span data-stu-id="cf924-226">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cf924-227">La clé **chemins d’accès** à l’application n’est pas utilisée lors du calcul du chemin de recherche de dll.</span><span class="sxs-lookup"><span data-stu-id="cf924-227">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="cf924-228">La fonction [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) prend en charge un ordre de recherche alternatif si le paramètre *lpPathName* spécifie un chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="cf924-228">The [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function supports an alternate search order if the *lpPathName* parameter specifies a path.</span></span> <span data-ttu-id="cf924-229">L’ordre de recherche alternatif est le suivant :</span><span class="sxs-lookup"><span data-stu-id="cf924-229">The alternate search order is as follows:</span></span>

1.  <span data-ttu-id="cf924-230">Répertoire à partir duquel l’application a été chargée.</span><span class="sxs-lookup"><span data-stu-id="cf924-230">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="cf924-231">Répertoire spécifié par le paramètre *lpPathName* de [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span><span class="sxs-lookup"><span data-stu-id="cf924-231">The directory specified by the *lpPathName* parameter of [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span></span>
3.  <span data-ttu-id="cf924-232">Répertoire du système.</span><span class="sxs-lookup"><span data-stu-id="cf924-232">The system directory.</span></span> <span data-ttu-id="cf924-233">Utilisez la fonction [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-233">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span> <span data-ttu-id="cf924-234">Le nom de ce répertoire est system32.</span><span class="sxs-lookup"><span data-stu-id="cf924-234">The name of this directory is System32.</span></span>
4.  <span data-ttu-id="cf924-235">Répertoire système 16 bits.</span><span class="sxs-lookup"><span data-stu-id="cf924-235">The 16-bit system directory.</span></span> <span data-ttu-id="cf924-236">Aucune fonction n’obtient le chemin d’accès de ce répertoire, mais elle est recherchée.</span><span class="sxs-lookup"><span data-stu-id="cf924-236">There is no function that obtains the path of this directory, but it is searched.</span></span> <span data-ttu-id="cf924-237">Le nom de ce répertoire est System.</span><span class="sxs-lookup"><span data-stu-id="cf924-237">The name of this directory is System.</span></span>
5.  <span data-ttu-id="cf924-238">Répertoire Windows.</span><span class="sxs-lookup"><span data-stu-id="cf924-238">The Windows directory.</span></span> <span data-ttu-id="cf924-239">Utilisez la fonction [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) pour récupérer le chemin d’accès à ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="cf924-239">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="cf924-240">Répertoires répertoriés dans la variable d’environnement PATH.</span><span class="sxs-lookup"><span data-stu-id="cf924-240">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="cf924-241">Notez que cela n’inclut pas le chemin d’accès par application spécifié par la clé de Registre **App Paths** .</span><span class="sxs-lookup"><span data-stu-id="cf924-241">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="cf924-242">La clé **chemins d’accès** à l’application n’est pas utilisée lors du calcul du chemin de recherche de dll.</span><span class="sxs-lookup"><span data-stu-id="cf924-242">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="cf924-243">Si le paramètre *lpPathName* est une chaîne vide, l’appel supprime le répertoire actif de l’ordre de recherche.</span><span class="sxs-lookup"><span data-stu-id="cf924-243">If the *lpPathName* parameter is an empty string, the call removes the current directory from the search order.</span></span>

<span data-ttu-id="cf924-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) désactive efficacement le mode de recherche de dll sécurisée lorsque le répertoire spécifié se trouve dans le chemin de recherche.</span><span class="sxs-lookup"><span data-stu-id="cf924-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) effectively disables safe DLL search mode while the specified directory is in the search path.</span></span> <span data-ttu-id="cf924-245">Pour restaurer le mode de recherche de DLL sécurisée en fonction de la valeur de Registre **SafeDllSearchMode** et restaurer le répertoire actif dans l’ordre de recherche, appelez **SetDllDirectory** avec *lpPathName* comme valeur null.</span><span class="sxs-lookup"><span data-stu-id="cf924-245">To restore safe DLL search mode based on the **SafeDllSearchMode** registry value and restore the current directory to the search order, call **SetDllDirectory** with *lpPathName* as NULL.</span></span>

### <a name="search-order-using-load_library_search-flags"></a><span data-ttu-id="cf924-246">Ordre de recherche à l’aide des indicateurs de **\_ \_ recherche** de la bibliothèque de chargement</span><span class="sxs-lookup"><span data-stu-id="cf924-246">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>

<span data-ttu-id="cf924-247">Une application peut spécifier un ordre de recherche à l’aide d’un ou plusieurs indicateurs de **\_ \_ recherche** de la bibliothèque de chargement avec la fonction [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) .</span><span class="sxs-lookup"><span data-stu-id="cf924-247">An application can specify a search order by using one or more **LOAD\_LIBRARY\_SEARCH** flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function.</span></span> <span data-ttu-id="cf924-248">Une application peut également utiliser les indicateurs de **\_ \_ recherche** de la bibliothèque de chargement avec la fonction [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) pour établir un ordre de recherche de dll pour un processus.</span><span class="sxs-lookup"><span data-stu-id="cf924-248">An application can also use **LOAD\_LIBRARY\_SEARCH** flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process.</span></span> <span data-ttu-id="cf924-249">L’application peut spécifier des répertoires supplémentaires pour l’ordre de recherche des DLL du processus à l’aide des fonctions [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) ou [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cf924-249">The application can specify additional directories for the process DLL search order by using the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions.</span></span>

<span data-ttu-id="cf924-250">Les répertoires recherchés dépendent des indicateurs spécifiés avec [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) ou [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="cf924-250">The directories that are searched depend on the flags specified with [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="cf924-251">Si plusieurs indicateurs sont utilisés, les répertoires correspondants sont recherchés dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="cf924-251">If more than one flag is used, the corresponding directories are searched in the following order:</span></span>

1.  <span data-ttu-id="cf924-252">Répertoire qui contient la DLL (chargement de la dll de recherche de la **bibliothèque de chargement \_ \_ \_ \_ \_**).</span><span class="sxs-lookup"><span data-stu-id="cf924-252">The directory that contains the DLL (**LOAD\_LIBRARY\_SEARCH\_DLL\_LOAD\_DIR**).</span></span> <span data-ttu-id="cf924-253">Ce répertoire est recherché uniquement pour les dépendances de la DLL à charger.</span><span class="sxs-lookup"><span data-stu-id="cf924-253">This directory is searched only for dependencies of the DLL to be loaded.</span></span>
2.  <span data-ttu-id="cf924-254">Le répertoire de l’application (chargement de l’application de recherche dans la **\_ bibliothèque \_ \_ \_**).</span><span class="sxs-lookup"><span data-stu-id="cf924-254">The application directory (**LOAD\_LIBRARY\_SEARCH\_APPLICATION\_DIR**).</span></span>
3.  <span data-ttu-id="cf924-255">Les chemins d’accès ont été ajoutés explicitement avec la fonction [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) (**charger la \_ bibliothèque Rechercher les \_ \_ \_ répertoires utilisateur**) ou la fonction [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="cf924-255">Paths explicitly added with the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) function (**LOAD\_LIBRARY\_SEARCH\_USER\_DIRS**) or the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span> <span data-ttu-id="cf924-256">Si plusieurs chemins d’accès ont été ajoutés, l’ordre dans lequel les chemins d’accès sont recherchés n’est pas spécifié.</span><span class="sxs-lookup"><span data-stu-id="cf924-256">If more than one path has been added, the order in which the paths are searched is unspecified.</span></span>
4.  <span data-ttu-id="cf924-257">Le répertoire système (**chargement de la \_ recherche de bibliothèque \_ \_ system32**).</span><span class="sxs-lookup"><span data-stu-id="cf924-257">The System directory (**LOAD\_LIBRARY\_SEARCH\_SYSTEM32**).</span></span>

<span data-ttu-id="cf924-258">Si l’application n’appelle pas [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) avec les indicateurs de **\_ \_ recherche** de la bibliothèque de chargement ou établit un ordre de recherche de dll pour le processus, le système recherche des dll à l’aide de l’ordre de recherche standard ou de l’ordre de recherche alternatif.</span><span class="sxs-lookup"><span data-stu-id="cf924-258">If the application does not call [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with any **LOAD\_LIBRARY\_SEARCH** flags or establish a DLL search order for the process, the system searches for DLLs using either the standard search order or the alternate search order.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cf924-259">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="cf924-259">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cf924-260">**AddDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="cf924-260">**AddDllDirectory**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory)
</dt> <dt>

[<span data-ttu-id="cf924-261">Inscription de l’application</span><span class="sxs-lookup"><span data-stu-id="cf924-261">Application Registration</span></span>](/windows/desktop/shell/app-registration)
</dt> <dt>

[<span data-ttu-id="cf924-262">Redirection de bibliothèque de liens dynamiques</span><span class="sxs-lookup"><span data-stu-id="cf924-262">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
</dt> <dt>

[<span data-ttu-id="cf924-263">Sécurité de la bibliothèque de liens dynamiques</span><span class="sxs-lookup"><span data-stu-id="cf924-263">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
</dt> <dt>

[<span data-ttu-id="cf924-264">**LoadLibrary**</span><span class="sxs-lookup"><span data-stu-id="cf924-264">**LoadLibrary**</span></span>](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)
</dt> <dt>

[<span data-ttu-id="cf924-265">**LoadLibraryEx**</span><span class="sxs-lookup"><span data-stu-id="cf924-265">**LoadLibraryEx**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)
</dt> <dt>

[<span data-ttu-id="cf924-266">**LoadPackagedLibrary**</span><span class="sxs-lookup"><span data-stu-id="cf924-266">**LoadPackagedLibrary**</span></span>](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary)
</dt> <dt>

[<span data-ttu-id="cf924-267">**SetDefaultDllDirectories**</span><span class="sxs-lookup"><span data-stu-id="cf924-267">**SetDefaultDllDirectories**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories)
</dt> <dt>

[<span data-ttu-id="cf924-268">**SetDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="cf924-268">**SetDllDirectory**</span></span>](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)
</dt> <dt>

[<span data-ttu-id="cf924-269">Composants côte à côte</span><span class="sxs-lookup"><span data-stu-id="cf924-269">Side-by-side Components</span></span>](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal)
</dt> </dl>

 

 