---
title: Plug-in de magasin en ligne de type 2
description: Plug-in de magasin en ligne de type 2
ms.assetid: 16e90a01-20be-49a6-96df-de81a7283f42
keywords:
- Windows Media Player Online stores, plug-ins
- magasins en ligne, plug-ins
- tapez 2 magasins en ligne, plug-ins
- Windows Media Player Online stores, interface IWMPSubscriptionService
- magasins en ligne, interface IWMPSubscriptionService
- types 2 magasins en ligne, interface IWMPSubscriptionService
- plug-ins, Windows Media Player Online stores
- plug-ins, magasins en ligne
- plug-ins, type 2 magasins en ligne
- plug-ins, interface IWMPSubscriptionService
- Plug-ins du lecteur Windows Media, type 2 magasins en ligne
- Plug-ins du lecteur Windows Media, magasins en ligne
- Plug-ins du lecteur Windows Media, magasins en ligne Windows Media Player
- Plug-ins du lecteur Windows Media, interface IWMPSubscriptionService
- IWMPSubscriptionService
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6d2f3aeeaa7456c3452b498a1a728e24c96783c
ms.sourcegitcommit: ad672d3a10192c5ccac619ad2524407109266e93
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/25/2020
ms.locfileid: "104101356"
---
# <a name="type-2-online-store-plug-in"></a><span data-ttu-id="633cb-118">Plug-in de magasin en ligne de type 2</span><span class="sxs-lookup"><span data-stu-id="633cb-118">Type 2 Online Store Plug-in</span></span>

<span data-ttu-id="633cb-119">Un plug-in de magasin en ligne de type 2 est un composant COM qui implémente l’interface [IWMPSubscriptionService](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice) et éventuellement l’interface [IWMPSubscriptionService2](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2) .</span><span class="sxs-lookup"><span data-stu-id="633cb-119">A type 2 online store plug-in is a COM component that implements the [IWMPSubscriptionService](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice) interface and optionally the [IWMPSubscriptionService2](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2) interface.</span></span> <span data-ttu-id="633cb-120">Le lecteur Windows Media 9 appelle les méthodes de l’interface **IWMPSubscriptionService** .</span><span class="sxs-lookup"><span data-stu-id="633cb-120">Windows Media Player 9 calls the methods of the **IWMPSubscriptionService** interface.</span></span> <span data-ttu-id="633cb-121">Le lecteur Windows Media 10 ou version ultérieure appelle les méthodes des interfaces **IWMPSubscriptionService** et **IWMPSubscriptionService2** .</span><span class="sxs-lookup"><span data-stu-id="633cb-121">Windows Media Player 10 or later calls the methods of both the **IWMPSubscriptionService** and **IWMPSubscriptionService2** interfaces.</span></span>

<span data-ttu-id="633cb-122">Un plug-in de magasin en ligne de type 2 est empaqueté en tant que serveur COM in-process.</span><span class="sxs-lookup"><span data-stu-id="633cb-122">A type 2 online store plug-in is packaged as an in-process COM server.</span></span> <span data-ttu-id="633cb-123">Autrement dit, le plug-in est implémenté dans un fichier. dll qui est mappé dans le processus du lecteur Windows Media.</span><span class="sxs-lookup"><span data-stu-id="633cb-123">That is, the plug-in is implemented in a .dll file that is mapped into the Windows Media Player process.</span></span>

<span data-ttu-id="633cb-124">Le lecteur Windows Media active les plug-ins de magasin de type 2 en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="633cb-124">Windows Media Player activates type 2 online store plug-ins as needed.</span></span> <span data-ttu-id="633cb-125">Par exemple, supposons que l’utilisateur tente de lire une chanson protégée et qu’il n’y ait pas de licence actuelle pour le lire.</span><span class="sxs-lookup"><span data-stu-id="633cb-125">For example, suppose the user attempts to play a protected song, and there is no current license to play it.</span></span> <span data-ttu-id="633cb-126">Dans ce cas, le lecteur Windows Media inspecte l’attribut **ContentDistributor** dans l’en-tête de fichier ou l’en-tête DRM.</span><span class="sxs-lookup"><span data-stu-id="633cb-126">In that case, Windows Media Player inspects the **ContentDistributor** attribute in either the file header or the DRM header.</span></span> <span data-ttu-id="633cb-127">S’il existe une valeur qui correspond au nom de clé d’un magasin en ligne, le lecteur Windows Media vérifie le registre pour déterminer si ce magasin en ligne a fourni un plug-in de type 2.</span><span class="sxs-lookup"><span data-stu-id="633cb-127">If a value exists that matches the key name of an online store, Windows Media Player checks the registry to see whether that online store has provided a type 2 plug-in.</span></span> <span data-ttu-id="633cb-128">Si le plug-in existe, le lecteur Windows Media charge le plug-in et appelle ses méthodes pour déterminer si l’utilisateur dispose des droits nécessaires pour lire la chanson.</span><span class="sxs-lookup"><span data-stu-id="633cb-128">If the plug-in exists, Windows Media Player loads the plug-in and calls its methods to determine whether the user is has the rights to play the song.</span></span>

<span data-ttu-id="633cb-129">La liste suivante décrit certains des scénarios dans lesquels le lecteur Windows Media appelle un plug-in de magasin en ligne de type 2.</span><span class="sxs-lookup"><span data-stu-id="633cb-129">The following list describes some of the scenarios in which Windows Media Player calls a type 2 online store plug-in.</span></span>

-   <span data-ttu-id="633cb-130">**L’utilisateur tente de lire le contenu de la boutique en ligne.**</span><span class="sxs-lookup"><span data-stu-id="633cb-130">**The user attempts to play online store content.**</span></span> <span data-ttu-id="633cb-131">Dans ce cas, le lecteur Windows Media appelle la méthode [IWMPSubscriptionService :: allowPlay](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowplay) du plug-in, en passant un pointeur vers l’élément multimédia numérique que l’utilisateur tente de lire.</span><span class="sxs-lookup"><span data-stu-id="633cb-131">When this happens, Windows Media Player calls the plug-in's [IWMPSubscriptionService::allowPlay](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowplay) method, passing a pointer to the digital media item that the user is attempting to play.</span></span> <span data-ttu-id="633cb-132">Le magasin en ligne peut l’utiliser comme opportunité de mettre à jour la licence de l’utilisateur pour lire le contenu ou interdire la lecture.</span><span class="sxs-lookup"><span data-stu-id="633cb-132">The online store can use this as an opportunity to update the user's license to play the content or to disallow playback.</span></span> <span data-ttu-id="633cb-133">Si le plug-in retourne la **valeur true** dans le paramètre *PfAllowPlay* , le lecteur Windows Media tente de lire le contenu.</span><span class="sxs-lookup"><span data-stu-id="633cb-133">If the plug-in returns **TRUE** in the *pfAllowPlay* parameter, Windows Media Player attempts to play the content.</span></span> <span data-ttu-id="633cb-134">La lecture échouera quand une licence valide n’existe pas ; Ce processus ne contourne pas la gestion des droits numériques (DRM).</span><span class="sxs-lookup"><span data-stu-id="633cb-134">Playback will still fail if a valid license does not exist; this process does not circumvent digital rights management (DRM).</span></span>
-   <span data-ttu-id="633cb-135">**L’utilisateur demande l’autorisation de graver du contenu sur un CD ou un DVD.**</span><span class="sxs-lookup"><span data-stu-id="633cb-135">**The user requests permission to burn content to a CD or DVD.**</span></span> <span data-ttu-id="633cb-136">Dans ce cas, le lecteur Windows Media appelle la méthode [IWMPSubscriptionService :: allowCDBurn](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowcdburn) du plug-in.</span><span class="sxs-lookup"><span data-stu-id="633cb-136">When this happens, Windows Media Player calls the plug-in's [IWMPSubscriptionService::allowCDBurn](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowcdburn) method.</span></span>
-   <span data-ttu-id="633cb-137">**L’utilisateur tente de synchroniser le contenu de la boutique en ligne avec un appareil, ou le lecteur Windows Media est prêt à synchroniser automatiquement le contenu de la boutique en ligne avec un appareil.**</span><span class="sxs-lookup"><span data-stu-id="633cb-137">**The user attempts to synchronize online store content with a device, or Windows Media Player is ready to automatically synchronize online store content with a device.**</span></span> <span data-ttu-id="633cb-138">Dans ce cas, le lecteur Windows Media appelle la méthode [IWMPSubscriptionService2 ::P repareforsync](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-prepareforsync) du plug-in pour signaler à la Banque en ligne qu’un élément multimédia est sur le point d’être synchronisé avec un appareil particulier, identifié par son nom canonique.</span><span class="sxs-lookup"><span data-stu-id="633cb-138">When this happens, Windows Media Player calls the plug-in's [IWMPSubscriptionService2::prepareForSync](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-prepareforsync) method to alert the online store that a media item is about to be synchronized with a particular device, which is identified by its canonical name.</span></span> <span data-ttu-id="633cb-139">Il s’agit d’une opportunité pour le magasin en ligne de déterminer si l’utilisateur est autorisé à synchroniser l’élément multimédia avec l’appareil.</span><span class="sxs-lookup"><span data-stu-id="633cb-139">This is an opportunity for the online store to determine whether the user is allowed to synchronize the media item with the device.</span></span> <span data-ttu-id="633cb-140">Il est également possible pour le magasin en ligne de préparer l’appareil pour la synchronisation et de mettre à jour les enregistrements, tels que les nombres de synchronisation, associés à l’appareil ou à l’élément multimédia.</span><span class="sxs-lookup"><span data-stu-id="633cb-140">It is also an opportunity for the online store to prepare the device for synchronization and to update records, such as synchronization counts, associated with the device or the media item.</span></span> <span data-ttu-id="633cb-141">Le plug-in doit passer l’autorisation, la préparation et les tâches d’enregistrement à un thread distinct et retourner immédiatement à partir de **prepareForSync**.</span><span class="sxs-lookup"><span data-stu-id="633cb-141">The plug-in should pass the permission, preparation, and record-keeping tasks to a separate thread and return immediately from **prepareForSync**.</span></span> <span data-ttu-id="633cb-142">Lorsque le thread distinct a terminé son travail, il doit notifier le lecteur Windows Media en appelant [IWMPSubscriptionServiceCallback :: OnComplete](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservicecallback-oncomplete).</span><span class="sxs-lookup"><span data-stu-id="633cb-142">When the separate thread has finished its work, it must notify Windows Media Player by calling [IWMPSubscriptionServiceCallback::onComplete](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservicecallback-oncomplete).</span></span>
-   <span data-ttu-id="633cb-143">**Un appareil est disponible pour le traitement en arrière-plan.**</span><span class="sxs-lookup"><span data-stu-id="633cb-143">**A device becomes available for background processing.**</span></span> <span data-ttu-id="633cb-144">Quand un appareil est connecté, le lecteur Windows Media signale au magasin en ligne que l’appareil est disponible et inactif en appelant [IWMPSubscriptionService2 ::D eviceavailable](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-deviceavailable).</span><span class="sxs-lookup"><span data-stu-id="633cb-144">When a device is connected, Windows Media Player alerts the online store that the device is available and idle by calling [IWMPSubscriptionService2::deviceAvailable](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-deviceavailable).</span></span>
-   <span data-ttu-id="633cb-145">**L’utilisateur clique sur un bouton pour activer un magasin en ligne dans le lecteur Windows Media.**</span><span class="sxs-lookup"><span data-stu-id="633cb-145">**The user clicks a button to activate an online store in Windows Media Player.**</span></span> <span data-ttu-id="633cb-146">Dans ce cas, le lecteur Windows Media appelle la méthode [IWMPSubscriptionService2 :: serviceEvent](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-serviceevent) du plug-in.</span><span class="sxs-lookup"><span data-stu-id="633cb-146">When this occurs, Windows Media Player calls the plug-in's [IWMPSubscriptionService2::serviceEvent](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-serviceevent) method.</span></span> <span data-ttu-id="633cb-147">Le lecteur Windows Media appelle également cette méthode lorsque l’utilisateur bascule vers un autre service.</span><span class="sxs-lookup"><span data-stu-id="633cb-147">Windows Media Player also calls this method when the user switches to another service.</span></span>
-   <span data-ttu-id="633cb-148">**Le lecteur Windows Media passe à l’État faible activité.**</span><span class="sxs-lookup"><span data-stu-id="633cb-148">**Windows Media Player enters a state of low activity.**</span></span> <span data-ttu-id="633cb-149">Dans ce cas, le lecteur appelle la méthode [IWMPSubscriptionService :: startBackgroundProcessing](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-startbackgroundprocessing) du plug-in.</span><span class="sxs-lookup"><span data-stu-id="633cb-149">When this happens, the Player calls the plug-in's [IWMPSubscriptionService::startBackgroundProcessing](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-startbackgroundprocessing) method.</span></span> <span data-ttu-id="633cb-150">Le magasin en ligne peut utiliser cette opportunité pour démarrer ou réveiller tous les threads qui effectuent des tâches en arrière-plan, tels que le renouvellement des licences expirées ou la compilation des données de lecture-nombre.</span><span class="sxs-lookup"><span data-stu-id="633cb-150">The online store can use this opportunity to start or wake up any threads that perform background tasks, such as renewing expired licenses or compiling play-count data.</span></span>
-   <span data-ttu-id="633cb-151">**Le lecteur Windows Media passe à l’État activité élevée.**</span><span class="sxs-lookup"><span data-stu-id="633cb-151">**Windows Media Player enters a state of high activity.**</span></span> <span data-ttu-id="633cb-152">Dans ce cas, le lecteur Windows Media appelle la méthode [IWMPSubscriptionService2 :: stopBackgroundProcessing](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-stopbackgroundprocessing) du plug-in.</span><span class="sxs-lookup"><span data-stu-id="633cb-152">When this happens, Windows Media Player calls the plug-in's [IWMPSubscriptionService2::stopBackgroundProcessing](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-stopbackgroundprocessing) method.</span></span> <span data-ttu-id="633cb-153">Cela indique au plug-in qu’il doit suspendre les threads effectuant des tâches en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="633cb-153">This informs the plug-in that it must suspend any threads that are performing background tasks.</span></span>

<span data-ttu-id="633cb-154">Le lecteur Windows Media diffuse le composant de la Banque d’aide en ligne à la fin de la session du lecteur.</span><span class="sxs-lookup"><span data-stu-id="633cb-154">Windows Media Player releases the online store component when the Player session ends.</span></span> <span data-ttu-id="633cb-155">Lors de la mise en production, le composant doit interrompre tout traitement en arrière-plan en cours, puis s’arrêter.</span><span class="sxs-lookup"><span data-stu-id="633cb-155">Upon release, the component must interrupt any background processing in progress and then shut down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="633cb-156">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="633cb-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="633cb-157">**Interface IWMPSubscriptionService**</span><span class="sxs-lookup"><span data-stu-id="633cb-157">**IWMPSubscriptionService Interface**</span></span>](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice)
</dt> <dt>

[<span data-ttu-id="633cb-158">**Interface IWMPSubscriptionService2**</span><span class="sxs-lookup"><span data-stu-id="633cb-158">**IWMPSubscriptionService2 Interface**</span></span>](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2)
</dt> <dt>

[<span data-ttu-id="633cb-159">**Interface IWMPSubscriptionServiceCallback**</span><span class="sxs-lookup"><span data-stu-id="633cb-159">**IWMPSubscriptionServiceCallback Interface**</span></span>](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservicecallback)
</dt> <dt>

[<span data-ttu-id="633cb-160">**Exemples de magasins en ligne de type 2**</span><span class="sxs-lookup"><span data-stu-id="633cb-160">**Type 2 Online Store Samples**</span></span>](type-2-online-store-samples.md)
</dt> </dl>

 

 




