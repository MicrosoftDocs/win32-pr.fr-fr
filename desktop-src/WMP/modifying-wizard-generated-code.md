---
title: Modification du code généré par l’Assistant
description: Modification du code généré par l’Assistant
ms.assetid: 391a7773-c3e2-499a-bb63-e5934537d963
keywords:
- Windows Media Player Mobile, plug-ins
- Windows Media Player Mobile, plug-ins d’interface utilisateur
- Plug-ins Windows Media Player Mobile
- plug-ins, interface utilisateur
- plug-ins, Windows Media Player Mobile
- plug-ins d’interface utilisateur, Windows Media Player Mobile
- Plug-ins d’interface utilisateur, Windows Media Player Mobile
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a83bda7cb265d0c2e039ada6d9d827c6da3faf63
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "106536876"
---
# <a name="modifying-wizard-generated-code"></a><span data-ttu-id="2e05f-110">Modification du code généré par l’Assistant</span><span class="sxs-lookup"><span data-stu-id="2e05f-110">Modifying Wizard-generated Code</span></span>

<span data-ttu-id="2e05f-111">Il y a plusieurs endroits dans le code de plug-in généré par l’Assistant que vous devez modifier pour que votre plug-in fonctionne avec le lecteur Windows Media 10 mobile.</span><span class="sxs-lookup"><span data-stu-id="2e05f-111">There are several places in the wizard-generated plug-in code that you must modify before your plug-in will work with Windows Media Player 10 Mobile.</span></span> <span data-ttu-id="2e05f-112">Le code que vous devez modifier est gras dans les exemples suivants.</span><span class="sxs-lookup"><span data-stu-id="2e05f-112">The code you must modify is bold in the following examples.</span></span>

## <a name="changes-to-wmpplugh"></a><span data-ttu-id="2e05f-113">Modifications apportées à wmpplug. h</span><span class="sxs-lookup"><span data-stu-id="2e05f-113">Changes to wmpplug.h</span></span>

<span data-ttu-id="2e05f-114">Les méthodes ANSI ne sont pas prises en charge sur les appareils exécutant Windows CE. vous devez donc modifier la méthode ANSI suivante générée par l’Assistant dans wmpplug. h :</span><span class="sxs-lookup"><span data-stu-id="2e05f-114">ANSI methods are not supported on devices running Windows CE, so you must modify the following ANSI method generated by the wizard in wmpplug.h:</span></span>


```C++
return( ::PostMessage( HWND_BROADCAST, ::RegisterWindowMessageA( "WMPlayer_PluginAddRemove" ), 0, 0 ) );
```



<span data-ttu-id="2e05f-115">Modifiez-le comme indiqué dans le code suivant afin qu’il devienne une méthode Unicode :</span><span class="sxs-lookup"><span data-stu-id="2e05f-115">Modify it as shown in the following so that it becomes a Unicode method:</span></span>


```C++
return( ::PostMessage( HWND_BROADCAST, ::RegisterWindowMessageW( L"WMPlayer_PluginAddRemove" ), 0, 0 ) );
```



## <a name="changes-to-networkpluginh"></a><span data-ttu-id="2e05f-116">Modifications apportées à NetworkPlugin. h</span><span class="sxs-lookup"><span data-stu-id="2e05f-116">Changes to NetworkPlugin.h</span></span>

<span data-ttu-id="2e05f-117">Recherchez le code suivant dans NetworkPlugin. h :</span><span class="sxs-lookup"><span data-stu-id="2e05f-117">Find the following code in NetworkPlugin.h:</span></span>


```C++
BEGIN_COM_MAP(CNetworkPlugin)
    COM_INTERFACE(IWMPPluginUI)
END_COM_MAP()
```



<span data-ttu-id="2e05f-118">Modifiez le code afin qu’il ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="2e05f-118">Modify the code so that it looks like this:</span></span>


```C++
BEGIN_COM_MAP(CNetworkPlugin)
    
COM_INTERFACE_ENTRY_IID(__uuidof(IWMPPluginUI), IWMPPluginUI)
END_COM_MAP()
```



## <a name="changes-to-networkplugindllcpp"></a><span data-ttu-id="2e05f-119">Modifications apportées à NetworkPlugindll. cpp</span><span class="sxs-lookup"><span data-stu-id="2e05f-119">Changes to NetworkPlugindll.cpp</span></span>

<span data-ttu-id="2e05f-120">Recherchez la fonction **DllMain** dans NetworkPlugindll. cpp :</span><span class="sxs-lookup"><span data-stu-id="2e05f-120">Find the **DllMain** function in NetworkPlugindll.cpp:</span></span>


```C++
extern "C" BOOL WINAPI DllMain(HINSTANCE hInstance, DWORD dwReason, LPVOID /*lpReserved*/)
{
    if (dwReason == DLL_PROCESS_ATTACH)
    {
        _Module.Init(ObjectMap, hInstance);
        DisableThreadLibraryCalls(hInstance);
    }
    else if (dwReason == DLL_PROCESS_DETACH)
        _Module.Term();
    return TRUE;    // ok
}
```



<span data-ttu-id="2e05f-121">Modifiez le code afin qu’il ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="2e05f-121">Modify the code so that it looks like this:</span></span>


```C++
extern "C" BOOL WINAPI DllMain(HANDLE hInstance, DWORD dwReason, LPVOID /*lpReserved*/)
{
    if (dwReason == DLL_PROCESS_ATTACH)
    {
        _Module.Init(ObjectMap, (HINSTANCE)hInstance);
#ifndef UNDER_CE
        DisableThreadLibraryCalls((HINSTANCE)hInstance);
#endif
    }
    else if (dwReason == DLL_PROCESS_DETACH)
        _Module.Term();
    return TRUE;    // ok
}
```



## <a name="changes-to-networkplugincpp"></a><span data-ttu-id="2e05f-122">Modifications apportées à NetworkPlugin. cpp</span><span class="sxs-lookup"><span data-stu-id="2e05f-122">Changes to NetworkPlugin.cpp</span></span>

<span data-ttu-id="2e05f-123">Recherchez le code suivant dans NetworkPlugin. cpp :</span><span class="sxs-lookup"><span data-stu-id="2e05f-123">Find the following code in NetworkPlugin.cpp:</span></span>


```C++
hr = m_spCore->QueryInterface(&spConnectionContainer);
```



<span data-ttu-id="2e05f-124">Modifiez le code afin qu’il ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="2e05f-124">Modify the code so that it looks like this:</span></span>


```C++
hr = m_spCore->QueryInterface(__uuidof(IConnectionPointContainer), (void**)&spConnectionContainer);
```



## <a name="change-the-threading-model"></a><span data-ttu-id="2e05f-125">Modifier le modèle de thread</span><span class="sxs-lookup"><span data-stu-id="2e05f-125">Change the Threading Model</span></span>

<span data-ttu-id="2e05f-126">Contrairement à ATL pour Windows, ATL pour Windows CE ne prend pas en charge le modèle de thread cloisonné car le modèle cloisonné requiert plus de ressources mémoire que les modèles de thread unique et de thread libre.</span><span class="sxs-lookup"><span data-stu-id="2e05f-126">Unlike ATL for Windows, ATL for Windows CE does not support the apartment threading model because the apartment model requires more memory resources than the single threading and free threading models.</span></span> <span data-ttu-id="2e05f-127">Par conséquent, vous devez rechercher toutes les instances de cloisonnement Threading dans StdAfx. h et NetworkPlugin. RGS et les modifier pour indiquer le Threading libre.</span><span class="sxs-lookup"><span data-stu-id="2e05f-127">Therefore, you must find all instances of apartment threading in StdAfx.h and NetworkPlugin.rgs and change them to indicate free threading.</span></span>

<span data-ttu-id="2e05f-128">En outre, vous pouvez uniquement appeler le contrôle mobile du lecteur Windows Media 10 à partir du thread sur lequel il a été créé.</span><span class="sxs-lookup"><span data-stu-id="2e05f-128">Also, you can only call the Windows Media Player 10 Mobile control from the thread on which it was created.</span></span>

## <a name="build-and-test-the-project"></a><span data-ttu-id="2e05f-129">Générer et tester le projet</span><span class="sxs-lookup"><span data-stu-id="2e05f-129">Build and Test the Project</span></span>

<span data-ttu-id="2e05f-130">Après avoir apporté ces modifications décrites ici, vous pouvez générer votre projet pour vérifier qu’il est compilé avant d’ajouter du code personnalisé.</span><span class="sxs-lookup"><span data-stu-id="2e05f-130">After making these changes outlined here, you can build your project to verify that it compiles before you add any custom code.</span></span>

1.  <span data-ttu-id="2e05f-131">Définissez la configuration de projet active sur Win32 (WCE ARMV4) debug ou Win32 (WCE ARMV4) Release.</span><span class="sxs-lookup"><span data-stu-id="2e05f-131">Set the active project configuration to Win32 (WCE ARMV4) Debug or Win32 (WCE ARMV4) Release.</span></span>
2.  <span data-ttu-id="2e05f-132">Définissez la plateforme active sur Pocket PC 2003.</span><span class="sxs-lookup"><span data-stu-id="2e05f-132">Set the active platform to Pocket PC 2003.</span></span>
3.  <span data-ttu-id="2e05f-133">Cliquez sur l’élément de menu **générer** , puis sélectionnez **générer NetworkPlugin.dll**.</span><span class="sxs-lookup"><span data-stu-id="2e05f-133">Click the **Build** menu item, and then select **Build NetworkPlugin.dll**.</span></span> <span data-ttu-id="2e05f-134">Elle doit être compilée, téléchargée et inscrite sur votre appareil.</span><span class="sxs-lookup"><span data-stu-id="2e05f-134">It should compile, download, and register itself on your device.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2e05f-135">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="2e05f-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2e05f-136">**Création d’un plug-in d’interface utilisateur pour Windows Media Player 10 mobile**</span><span class="sxs-lookup"><span data-stu-id="2e05f-136">**Creating a User Interface Plug-in for Windows Media Player 10 Mobile**</span></span>](creating-a-user-interface-plug-in-for-windows-media-player-10-mobile.md)
</dt> </dl>

 

 




