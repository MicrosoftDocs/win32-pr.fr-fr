---
title: Implémentation du mécanisme d’LEAP EAPHost
description: Décrit le mécanisme EAPHost qui permet à des tiers d’écrire des modules LEAP (Extensible Authentication Protocol) légers pour Windows.
ms.assetid: d17a99cb-4a43-4719-984e-b742c9518f52
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc50cda8d32cc26dd81af5733345deebb579c792
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/09/2020
ms.locfileid: "104102508"
---
# <a name="implementing-the-eaphost-leap-mechanism"></a><span data-ttu-id="34cae-103">Implémentation du mécanisme d’LEAP EAPHost</span><span class="sxs-lookup"><span data-stu-id="34cae-103">Implementing the EAPHost LEAP Mechanism</span></span>

<span data-ttu-id="34cae-104">Cette rubrique décrit le mécanisme EAPHost qui permet à des tiers d’écrire des modules LEAP (Extensible Authentication Protocol) légers pour Windows.</span><span class="sxs-lookup"><span data-stu-id="34cae-104">This topic describes the EAPHost mechanism that allows third parties to write Lightweight Extensible Authentication Protocol (LEAP) modules for Windows.</span></span> <span data-ttu-id="34cae-105">LEAP est une méthode d’authentification héritée, créée par Cisco, conformément à la [norme RFC 3748](https://go.microsoft.com/fwlink/p/?linkid=84016).</span><span class="sxs-lookup"><span data-stu-id="34cae-105">LEAP is a legacy authentication method, created by Cisco, as per [RFC 3748](https://go.microsoft.com/fwlink/p/?linkid=84016).</span></span> <span data-ttu-id="34cae-106">Pour plus d’informations sur LEAP, consultez [Cisco LEAP Q&A](https://go.microsoft.com/fwlink/p/?linkid=84018).</span><span class="sxs-lookup"><span data-stu-id="34cae-106">For more information about LEAP, see [Cisco LEAP Q&A](https://go.microsoft.com/fwlink/p/?linkid=84018).</span></span>

## <a name="eaphost-authentication-process"></a><span data-ttu-id="34cae-107">Processus d’authentification EAPHost</span><span class="sxs-lookup"><span data-stu-id="34cae-107">EAPHost Authentication Process</span></span>

<span data-ttu-id="34cae-108">Le processus d’authentification EAPHost standard se produit comme suit :</span><span class="sxs-lookup"><span data-stu-id="34cae-108">The regular EAPHost authentication process occurs as follows:</span></span>

-   <span data-ttu-id="34cae-109">L’authentificateur envoie une demande d’authentification de l’homologue.</span><span class="sxs-lookup"><span data-stu-id="34cae-109">The authenticator sends a Request to authenticate the peer.</span></span> <span data-ttu-id="34cae-110">Par exemple, l’application appelle [**EapHostPeerBeginSession**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerbeginsession) avec la configuration EAPHost et les données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="34cae-110">For example, the application calls [**EapHostPeerBeginSession**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerbeginsession) with EAPHost configuration and user data.</span></span>
-   <span data-ttu-id="34cae-111">L’homologue envoie un paquet de réponse en réponse à une demande valide.</span><span class="sxs-lookup"><span data-stu-id="34cae-111">The peer sends a Response packet in reply to a valid Request.</span></span> <span data-ttu-id="34cae-112">Par exemple, un appel réussi retourne un handle de session de **\_ \_ handle de session EAP** .</span><span class="sxs-lookup"><span data-stu-id="34cae-112">For example, a successful call returns an **EAP\_SESSION\_HANDLE** session handle.</span></span>
-   <span data-ttu-id="34cae-113">L’authentificateur envoie un paquet de demande supplémentaire et l’homologue répond avec une réponse.</span><span class="sxs-lookup"><span data-stu-id="34cae-113">The authenticator sends an additional Request packet, and the peer replies with a Response.</span></span> <span data-ttu-id="34cae-114">Par exemple, l’application appelle [**EapHostPeerGetSendPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeergetsendpacket) pour obtenir les paquets EAP reçus par EAPHost tout au long de la session.</span><span class="sxs-lookup"><span data-stu-id="34cae-114">For example, the application calls [**EapHostPeerGetSendPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeergetsendpacket) to obtain EAP packets received by EAPHost throughout the session.</span></span> <span data-ttu-id="34cae-115">Chaque paquet est traité par un appel à [**EapHostPeerProcessReceivedPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerprocessreceivedpacket).</span><span class="sxs-lookup"><span data-stu-id="34cae-115">Each packet is processed by a call to [**EapHostPeerProcessReceivedPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerprocessreceivedpacket).</span></span>
-   <span data-ttu-id="34cae-116">[**EapHostPeerProcessReceivedPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerprocessreceivedpacket) retourne toujours un code d’action.</span><span class="sxs-lookup"><span data-stu-id="34cae-116">[**EapHostPeerProcessReceivedPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerprocessreceivedpacket) will always return an action code.</span></span> <span data-ttu-id="34cae-117">Le demandeur doit ensuite appeler la fonction correspondant au code d’action.</span><span class="sxs-lookup"><span data-stu-id="34cae-117">The supplicant must then call the function corresponding to the action code.</span></span>
-   <span data-ttu-id="34cae-118">La séquence des demandes et des réponses se poursuit aussi longtemps que nécessaire.</span><span class="sxs-lookup"><span data-stu-id="34cae-118">The sequence of Requests and Responses continues as long as needed.</span></span> <span data-ttu-id="34cae-119">Par exemple, l’application peut appeler [**EapHostPeerGetResponseAttributes**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeergetresponseattributes) pour demander des attributs EAP disponibles, et l’homologue répond avec [**EapHostPeerSetResponseAttributes**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeersetresponseattributes) pour les retourner.</span><span class="sxs-lookup"><span data-stu-id="34cae-119">For example, the application can call [**EapHostPeerGetResponseAttributes**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeergetresponseattributes) to request available EAP attributes, and the peer responds with [**EapHostPeerSetResponseAttributes**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeersetresponseattributes) to return them.</span></span>
-   <span data-ttu-id="34cae-120">Après une demande initiale, une nouvelle demande ne peut pas être envoyée tant qu’une réponse valide n’a pas été reçue.</span><span class="sxs-lookup"><span data-stu-id="34cae-120">After an initial Request, a new Request cannot be sent until a valid Response is received.</span></span>
-   <span data-ttu-id="34cae-121">La conversation se poursuit jusqu’à ce que l’authentificateur ne puisse pas authentifier l’homologue. dans ce cas, l’implémentation de l’authentificateur doit transmettre un échec EAP.</span><span class="sxs-lookup"><span data-stu-id="34cae-121">The conversation continues until the authenticator cannot authenticate the peer, in which case the authenticator implementation must transmit an EAP Failure.</span></span> <span data-ttu-id="34cae-122">Par exemple, les réponses inacceptables à une ou plusieurs demandes obligent l’authentificateur à transmettre un échec EAP code 4.</span><span class="sxs-lookup"><span data-stu-id="34cae-122">For example, unacceptable Responses to one or more Requests would cause the authenticator to transmit a Code 4 EAP Failure.</span></span>
-   <span data-ttu-id="34cae-123">Sinon, la conversation d’authentification peut se poursuivre jusqu’à ce que l’authentificateur détermine que l’authentification réussie s’est produite, auquel cas l’authentificateur doit transmettre une réussite EAP (code 3).</span><span class="sxs-lookup"><span data-stu-id="34cae-123">Alternatively, the authentication conversation can continue until the authenticator determines that successful authentication has occurred, in which case the authenticator must transmit an EAP Success (Code 3).</span></span>
-   <span data-ttu-id="34cae-124">Que le résultat indique la réussite ou l’échec, l’application appelle [**EapHostPeerEndSession**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerendsession) pour mettre fin à la session.</span><span class="sxs-lookup"><span data-stu-id="34cae-124">Whether the result indicates success or failure, the application calls [**EapHostPeerEndSession**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerendsession) to terminate the session.</span></span> <span data-ttu-id="34cae-125">En cas de défaillance, une nouvelle authentification peut être tentée en ouvrant une autre session avec EAPHost et en fournissant la même identité ou une nouvelle identité.</span><span class="sxs-lookup"><span data-stu-id="34cae-125">In the case of failure, re-authentication can be attempted by opening another session with EAPHost and providing either the same or a new identity.</span></span>

### <a name="leap-authentication-process"></a><span data-ttu-id="34cae-126">Processus d’authentification LEAP</span><span class="sxs-lookup"><span data-stu-id="34cae-126">LEAP Authentication Process</span></span>

<span data-ttu-id="34cae-127">Le processus d’authentification LEAP diffère du processus d’authentification EAPhost standard, comme suit :</span><span class="sxs-lookup"><span data-stu-id="34cae-127">The LEAP authentication process differs from the regular EAPhost authentication process as follows:</span></span>

-   <span data-ttu-id="34cae-128">L’authentification EAP est lancée par le serveur (authentificateur).</span><span class="sxs-lookup"><span data-stu-id="34cae-128">EAP authentication is initiated by the server (authenticator).</span></span> <span data-ttu-id="34cae-129">Par opposition, le client (homologue) initie le LEAP.</span><span class="sxs-lookup"><span data-stu-id="34cae-129">LEAP, in contrast, is initiated by the client (peer).</span></span>
    -   <span data-ttu-id="34cae-130">Par conséquent, lors de l’écriture d’un module LEAP, vous devez toujours vous assurer que le paquet de demande de vérification de la méthode d’homologue et la réponse EAP du serveur EAP doivent toujours avoir le même ID de paquet que celui du paquet de réussite EAP du serveur.</span><span class="sxs-lookup"><span data-stu-id="34cae-130">Therefore, when writing a LEAP module you must always ensure that the Challenge Request packet from the peer method and the EAP Response from the EAP server must always have the same packet ID as that of the EAP Success packet from the server.</span></span>

    <!-- -->

    -   <span data-ttu-id="34cae-131">En revanche, les paquets de demande et de réponse EAPHost et les paquets de réussite ont généralement des ID différents.</span><span class="sxs-lookup"><span data-stu-id="34cae-131">In contrast, EAPHost Request and Response and Success packets typically all have different IDs.</span></span>
        > [!Note]  
        > <span data-ttu-id="34cae-132">Chaque demande EAP a un champ type pour indiquer ce qui est demandé.</span><span class="sxs-lookup"><span data-stu-id="34cae-132">Every EAP Request has a Type field to indicate what is being requested.</span></span> <span data-ttu-id="34cae-133">Comme pour le paquet de demande, chaque paquet de réponse EAP contient un champ de type, qui correspond au champ de type de la demande.</span><span class="sxs-lookup"><span data-stu-id="34cae-133">As with the Request packet, every EAP Response packet contains a Type field, which corresponds to the Type field of the Request.</span></span> <span data-ttu-id="34cae-134">Citons par exemple les paquets de demande d’identité et de demande de stimulation.</span><span class="sxs-lookup"><span data-stu-id="34cae-134">Examples include Identity Request and Challenge Request packets.</span></span>

         

-   <span data-ttu-id="34cae-135">En cas de défaillance avec EAPHost, une nouvelle authentification peut être tentée en ouvrant une autre session avec EAPHost et en fournissant la même identité ou une nouvelle identité.</span><span class="sxs-lookup"><span data-stu-id="34cae-135">In the case of failure with EAPHost, re-authentication can be attempted by opening another session with EAPHost and providing either the same identity or a new identity.</span></span>

### <a name="leap-authenticator-method-implementation"></a><span data-ttu-id="34cae-136">Implémentation de la méthode d’authentificateur LEAP</span><span class="sxs-lookup"><span data-stu-id="34cae-136">LEAP Authenticator Method Implementation</span></span>

<span data-ttu-id="34cae-137">Lors du développement d’une méthode d’authentificateur LEAP, vérifiez les points suivants :</span><span class="sxs-lookup"><span data-stu-id="34cae-137">When developing a LEAP authenticator method, please ensure the following:</span></span>

-   <span data-ttu-id="34cae-138">Les méthodes d’authentificateur LEAP doivent retourner le code d’action d’envoi de la réponse de l' [**\_ authentificateur de méthode \_ \_ \_ EAP**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) après la première phase de l’authentification (authentification d’homologue).</span><span class="sxs-lookup"><span data-stu-id="34cae-138">LEAP authenticator methods must return the [**EAP\_METHOD\_AUTHENTICATOR\_RESPONSE\_SEND**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) action code after the 1st phase of authentication (peer authentication) is successful.</span></span> <span data-ttu-id="34cae-139">Quand [**EapMethodAuthenticatorSendPacket**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorsendpacket) est appelé, il doit retourner un [**EapPacket**](/windows/win32/api/eapmethodtypes/ns-eapmethodtypes-eappacket) valide avec un code EAP de [**EapCodeSuccess**](/windows/win32/api/eapmethodtypes/ne-eapmethodtypes-eapcode).</span><span class="sxs-lookup"><span data-stu-id="34cae-139">Then when [**EapMethodAuthenticatorSendPacket**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorsendpacket) is called, it should return a valid [**EapPacket**](/windows/win32/api/eapmethodtypes/ns-eapmethodtypes-eappacket) with an EAP code of [**EapCodeSuccess**](/windows/win32/api/eapmethodtypes/ne-eapmethodtypes-eapcode).</span></span>
-   <span data-ttu-id="34cae-140">Les méthodes d’authentificateur LEAP doivent retourner le code d’action du résultat de la réponse de l' [**\_ authentificateur de méthode \_ \_ \_ EAP**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) si la première phase de l’authentification d’homologue échoue.</span><span class="sxs-lookup"><span data-stu-id="34cae-140">LEAP authenticator methods should return the [**EAP\_METHOD\_AUTHENTICATOR\_RESPONSE\_RESULT**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) action code if the 1st phase of peer authentication is unsuccessful.</span></span>
-   <span data-ttu-id="34cae-141">Les méthodes d’authentificateur LEAP doivent retourner le paquet de réponse d’authentification final avec le code d’action du [](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorsendpacket) résultat de la réponse de l' [**authentificateur de \_ méthode \_ \_ \_ EAP**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) lorsque EapMethodAuthenticatorSendPacket est appelé.</span><span class="sxs-lookup"><span data-stu-id="34cae-141">LEAP authenticator methods must return the final authentication response packet with the [**EAP\_METHOD\_AUTHENTICATOR\_RESPONSE\_RESULT**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) action code when [**EapMethodAuthenticatorSendPacket**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorsendpacket) is called.</span></span> <span data-ttu-id="34cae-142">Ensuite, dans les appels suivants à [**EapMethodAuthenticatorGetResult**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorgetresult) , le **\_ \_ descripteur de session EAP** doit être retourné pour identifier la session authentifiée.</span><span class="sxs-lookup"><span data-stu-id="34cae-142">Then in subsequent calls to [**EapMethodAuthenticatorGetResult**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorgetresult) the **EAP\_SESSION\_HANDLE** must be returned to identify the authenticated session.</span></span>
-   

### <a name="leap-peer-method-implementation"></a><span data-ttu-id="34cae-143">Implémentation de la méthode d’homologue LEAP</span><span class="sxs-lookup"><span data-stu-id="34cae-143">LEAP Peer Method Implementation</span></span>

<span data-ttu-id="34cae-144">Lors du développement d’une méthode pair LEAP, vérifiez les points suivants :</span><span class="sxs-lookup"><span data-stu-id="34cae-144">When developing a LEAP peer method, please ensure the following</span></span>

-   <span data-ttu-id="34cae-145">Les méthodes pair LEAP doivent retourner le code d’action [**EapPeerMethodResponseActionSend**](/windows/win32/api/eapauthenticatoractiondefine/ne-eapauthenticatoractiondefine-eappeermethodresponseaction) après la réussite de la première phase de l’authentification (authentification d’homologue).</span><span class="sxs-lookup"><span data-stu-id="34cae-145">LEAP peer methods should return the [**EapPeerMethodResponseActionSend**](/windows/win32/api/eapauthenticatoractiondefine/ne-eapauthenticatoractiondefine-eappeermethodresponseaction) action code after the 1st phase of authentication (peer authentication) is successful.</span></span>
-   <span data-ttu-id="34cae-146">Les méthodes pair LEAP doivent retourner le code d’action [**EapPeerMethodResponseActionResult**](/windows/win32/api/eapauthenticatoractiondefine/ne-eapauthenticatoractiondefine-eappeermethodresponseaction) après la réussite de la deuxième phase de l’authentification.</span><span class="sxs-lookup"><span data-stu-id="34cae-146">LEAP peer methods should return the [**EapPeerMethodResponseActionResult**](/windows/win32/api/eapauthenticatoractiondefine/ne-eapauthenticatoractiondefine-eappeermethodresponseaction) action code after the 2nd phase of authentication is successful.</span></span>

## <a name="related-topics"></a><span data-ttu-id="34cae-147">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="34cae-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="34cae-148">Séquence d’appel EAPHost</span><span class="sxs-lookup"><span data-stu-id="34cae-148">EAPHost Call Sequence</span></span>](about-eaphost-call-sequences.md)
</dt> <dt>

[<span data-ttu-id="34cae-149">Utilisation d’EAPHost</span><span class="sxs-lookup"><span data-stu-id="34cae-149">Using EAPHost</span></span>](using-eap-host.md)
</dt> </dl>

 

 




