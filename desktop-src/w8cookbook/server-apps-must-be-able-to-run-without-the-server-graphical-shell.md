---
title: Restrictions de l’interpréteur de commandes graphiques de serveur
description: Les applications serveur doivent pouvoir s’exécuter sans l’interpréteur de commandes graphique de serveur
ms.assetid: 8F531497-B64D-4E79-AD7A-790EFDC6ADFE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7666ae07a28d798a36d249bf37ab2d7719b9fba0
ms.sourcegitcommit: 46376be61d3fa308f9b1a06d7e2fa122a39755af
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/10/2020
ms.locfileid: "104383147"
---
# <a name="server-apps-must-be-able-to-run-without-the-server-graphical-shell"></a><span data-ttu-id="f1b04-103">Les applications serveur doivent pouvoir s’exécuter sans l’interpréteur de commandes graphique de serveur</span><span class="sxs-lookup"><span data-stu-id="f1b04-103">Server apps must be able to run without the Server Graphical Shell</span></span>

## <a name="platform"></a><span data-ttu-id="f1b04-104">Plateforme</span><span class="sxs-lookup"><span data-stu-id="f1b04-104">Platform</span></span>

<span data-ttu-id="f1b04-105">**Serveurs** – Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="f1b04-105">**Servers** – Windows Server 2012</span></span> 

## <a name="description"></a><span data-ttu-id="f1b04-106">Description</span><span class="sxs-lookup"><span data-stu-id="f1b04-106">Description</span></span>

<span data-ttu-id="f1b04-107">L’interpréteur de commandes graphique de serveur, la fonctionnalité qui comprend l’Explorateur Windows et Internet Explorer, est installé par défaut sur les installations « serveur avec une interface graphique utilisateur » de Windows Server 2012.</span><span class="sxs-lookup"><span data-stu-id="f1b04-107">Server Graphical Shell, the feature that includes Windows Explorer and Internet Explorer, is installed by default on “Server with a GUI” installations of Windows Server 2012.</span></span> <span data-ttu-id="f1b04-108">La fonctionnalité d’interpréteur de commandes graphique de serveur peut être désinstallée pour réduire le risque de maintenance et d’encombrement des performances, limitant ainsi le nombre de redémarrages que le serveur peut entraîner, tout en autorisant l’exécution locale des outils de gestion sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="f1b04-108">The Server Graphical Shell feature can be uninstalled in order to reduce the potential servicing and performance footprint, thereby limiting the number of reboots that the server may incur, while still allowing management tools to be run locally on the server.</span></span>

<span data-ttu-id="f1b04-109">Une fois qu’un administrateur a désinstallé l’interpréteur de commandes graphique de serveur, le serveur se trouve dans la configuration d’interface serveur minimale :</span><span class="sxs-lookup"><span data-stu-id="f1b04-109">After an administrator uninstalls the Server Graphical Shell, the server is in the Minimal Server Interface configuration:</span></span>

![configuration de l’interface d’interpréteur de commandes graphique de serveur](images/minimalserverinterface.png)

<span data-ttu-id="f1b04-111">Les administrateurs peuvent ensuite choisir de s’exécuter dans la configuration de l’interface serveur minimale (qui inclut un ensemble d’outils d’administration locaux), par défaut, plutôt que sur le serveur avec une configuration GUI.</span><span class="sxs-lookup"><span data-stu-id="f1b04-111">Administrators can then opt to run in the Minimal Server Interface configuration (which includes a set of local management tools), as the default, rather than in the Server with a GUI configuration.</span></span> <span data-ttu-id="f1b04-112">Cela permet la surveillance et la gestion locales, tout en réduisant l’utilisation des ressources et la fréquence de maintenance.</span><span class="sxs-lookup"><span data-stu-id="f1b04-112">This allows local monitoring and management, while reducing both resource usage and frequency of servicing.</span></span>

<span data-ttu-id="f1b04-113">Les administrateurs peuvent réinstaller l’interpréteur de commandes graphique de serveur ultérieurement s’ils en ont besoin.</span><span class="sxs-lookup"><span data-stu-id="f1b04-113">Administrators can reinstall Server Graphical Shell later if they need the functionality within it.</span></span> <span data-ttu-id="f1b04-114">(Les administrateurs peuvent également démarrer à partir d’une installation minimale et se « développer » dans la configuration de l’interface serveur minimale à l’aide de la fonctionnalité fonctionnalités à la demande.)</span><span class="sxs-lookup"><span data-stu-id="f1b04-114">(Administrators can also start from a Server Core install, and “build up” to the Minimal Server Interface configuration using the Features On Demand functionality.)</span></span>

<span data-ttu-id="f1b04-115">Les applications serveur doivent pouvoir s’exécuter dans la configuration de l’interface serveur minimale pour tirer parti de l’encombrement réduit de l’utilisation des ressources et de la maintenance.</span><span class="sxs-lookup"><span data-stu-id="f1b04-115">Server apps must be capable of running in the Minimal Server Interface configuration to take advantage of the reduced resource utilization and servicing footprint.</span></span> <span data-ttu-id="f1b04-116">Cette fonctionnalité peut être obtenue en permettant à l’administrateur de choisir de ne pas installer les parties de l’application qui a besoin de l’interpréteur de commandes graphique de serveur, ou en détectant la présence de l’interpréteur de commandes graphique de serveur et en désactivant certains aspects de l’application.</span><span class="sxs-lookup"><span data-stu-id="f1b04-116">This capability can be achieved by allowing the administrator to choose not to install parts of the app that needs the Server Graphical Shell, or by detecting the presence of Server Graphical Shell and disabling some aspects of the app.</span></span>

<span data-ttu-id="f1b04-117">L’interface serveur minimale offre une réduction des ressources et de la maintenance, car de nombreuses API et binaires incluses dans l’interpréteur de commandes graphique de serveur ne sont pas disponibles dans cette configuration.</span><span class="sxs-lookup"><span data-stu-id="f1b04-117">The Minimal Server Interface has a reduced resource and servicing footprint because many APIs and binaries that are included in the Server Graphical Shell are not available in this configuration.</span></span> <span data-ttu-id="f1b04-118">Le cas échéant, les applications serveur doivent également autoriser l’administration à distance (de préférence via la communication à distance Windows PowerShell) à partir d’une autre installation de Windows Server ou d’un client Windows.</span><span class="sxs-lookup"><span data-stu-id="f1b04-118">Where appropriate, server apps should also allow remote administration (preferably via Windows PowerShell Remoting) from another Windows Server or Windows Client installation.</span></span> <span data-ttu-id="f1b04-119">Cela permet une meilleure administration centralisée d’un ou plusieurs ordinateurs dans la configuration de l’interface serveur minimale, ou des machines dans une configuration à faible encombrement, telle que Server Core.</span><span class="sxs-lookup"><span data-stu-id="f1b04-119">This enables better centralized administration of one or more machines in the Minimal Server Interface configuration, or of machines in an even lower footprint configuration such as Server Core.</span></span>

## <a name="manifestation"></a><span data-ttu-id="f1b04-120">Manifestation</span><span class="sxs-lookup"><span data-stu-id="f1b04-120">Manifestation</span></span>

<span data-ttu-id="f1b04-121">Si une application requiert des API ou des fichiers binaires qui ne sont pas disponibles dans la configuration minimale de l’interface serveur, elle risque de ne pas s’afficher correctement à l’écran et/ou être inutilisable.</span><span class="sxs-lookup"><span data-stu-id="f1b04-121">If an app requires any of the APIs or binaries that are not available in the Minimal Server Interface configuration, it may not display properly on the screen and/or be unusable.</span></span>

## <a name="mitigation"></a><span data-ttu-id="f1b04-122">Limitation des risques</span><span class="sxs-lookup"><span data-stu-id="f1b04-122">Mitigation</span></span>

<span data-ttu-id="f1b04-123">Les développeurs d’applications serveur doivent identifier les parties de leurs applications qui nécessitent l’une des API ou les binaires supprimées et incluent des informations pour l’administrateur de serveur identifiant les parties de l’application qui ne s’exécutent pas correctement lors de l’utilisation de l’interface serveur minimale.</span><span class="sxs-lookup"><span data-stu-id="f1b04-123">Server app developers should identify those parts of their apps that require any of the removed APIs or binaries and include info for the server administrator identifying the parts of the app that won’t run properly when using the Minimal Server Interface.</span></span> <span data-ttu-id="f1b04-124">Si ces parties de l’application peuvent éventuellement être installées ou ne sont pas absolument requises pour les fonctionnalités du produit, elles peuvent toujours être installées et exécutées dans le cadre de la configuration minimale de l’interface serveur.</span><span class="sxs-lookup"><span data-stu-id="f1b04-124">If those parts of the app can be optionally installed or are not absolutely required for product functionality, the app can still be installed and run under the Minimal Server Interface configuration.</span></span>

<span data-ttu-id="f1b04-125">Si l’application ne peut pas être utilisée sans l’interpréteur de commandes graphique de serveur, cette limitation doit être documentée et l’administrateur du serveur doit être invité à installer l’interpréteur de commandes graphique de serveur.</span><span class="sxs-lookup"><span data-stu-id="f1b04-125">If the app cannot be used at all without the Server Graphical Shell, this limitation should be documented and the server administrator should be instructed to install the Server Graphical Shell.</span></span> <span data-ttu-id="f1b04-126">(En cas d’ajout à une installation Server Core, il peut être nécessaire d’ajouter des fonctionnalités à l’aide de fonctionnalités à la demande.) En outre, l’application doit vérifier au démarrage que tous les fichiers requis sont disponibles, car l’interpréteur de commandes graphique de serveur peut être désinstallé à tout moment avant ou après l’installation de l’application.</span><span class="sxs-lookup"><span data-stu-id="f1b04-126">(If adding to a Server Core installation, this might require adding features using Features On Demand.) In addition, the app should check on startup that all required files are available, as the Server Graphical Shell can be uninstalled at any time before or after the installation of the app.</span></span>

## <a name="solution"></a><span data-ttu-id="f1b04-127">Solution</span><span class="sxs-lookup"><span data-stu-id="f1b04-127">Solution</span></span>

<span data-ttu-id="f1b04-128">S’appuyer sur le plus petit ensemble de dépendances possible et modulariser les applications afin que la fonctionnalité de l’application principale puisse fonctionner sans nécessiter des composants d’interface utilisateur plus lourds.</span><span class="sxs-lookup"><span data-stu-id="f1b04-128">Rely on the smallest possible set of dependencies, and modularize apps so that the core app functionality can work without requiring more heavyweight user interface components installed.</span></span> <span data-ttu-id="f1b04-129">Développez des applications qui ne nécessitent aucune des API ou binaires supprimées, et reposez-vous plutôt sur les fonctionnalités contenues dans l’interface serveur minimale ou le noyau de serveur.</span><span class="sxs-lookup"><span data-stu-id="f1b04-129">Develop apps that do not require any of the removed APIs or binaries, and rely instead on the functionality contained within the Minimal Server Interface or Server Core.</span></span> <span data-ttu-id="f1b04-130">Cela permet de réduire les besoins de maintenance tout en améliorant les performances et la satisfaction des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="f1b04-130">This will reduce maintenance requirements while improving performance and user satisfaction.</span></span>

<span data-ttu-id="f1b04-131">Lorsqu’il existe des parties d’une application qui peuvent ajouter des fonctionnalités importantes lorsque l’interpréteur de commandes graphique de serveur est disponible, les développeurs d’applications peuvent :</span><span class="sxs-lookup"><span data-stu-id="f1b04-131">Where there are parts of an app that might add significant functionality when the Server Graphical Shell is available, app developers can:</span></span>

-   <span data-ttu-id="f1b04-132">Autorisez ces fonctionnalités supplémentaires à utiliser l’interpréteur de commandes graphique de serveur pour les installer en option, afin qu’ils puissent être omis des installations sur une configuration d’interface serveur minimale.</span><span class="sxs-lookup"><span data-stu-id="f1b04-132">Allow these additional features making use of Server Graphical Shell to be optionally installed, so they can be omitted from installations on a Minimal Server Interface configuration</span></span>
-   <span data-ttu-id="f1b04-133">Détecter la présence de l’interpréteur de commandes graphique de serveur et adapter le comportement de l’application</span><span class="sxs-lookup"><span data-stu-id="f1b04-133">Detect the presence of Server Graphical Shell and adapt the app behavior</span></span>

<span data-ttu-id="f1b04-134">Les développeurs d’applications doivent également s’assurer que les applications serveur sont gérables à distance lorsque cela est possible et approprié.</span><span class="sxs-lookup"><span data-stu-id="f1b04-134">App developers should also ensure that server apps are remotely manageable where possible and appropriate.</span></span>

## <a name="detecting-minimal-server-interface-and-server-core"></a><span data-ttu-id="f1b04-135">Détection de l’interface serveur minimale et de Server Core</span><span class="sxs-lookup"><span data-stu-id="f1b04-135">Detecting Minimal Server Interface and Server Core</span></span>

<span data-ttu-id="f1b04-136">Windows Server installe une valeur de Registre correspondante pour chaque niveau de serveur installé.</span><span class="sxs-lookup"><span data-stu-id="f1b04-136">Windows Server will install a corresponding registry value for each server level installed.</span></span> <span data-ttu-id="f1b04-137">Vous pouvez interroger l’existence de ces clés pour déterminer si l’interpréteur de commandes graphique de serveur ou les fonctionnalités minimales de l’interface serveur sont installés et activés.</span><span class="sxs-lookup"><span data-stu-id="f1b04-137">You can query for the existence of these keys to determine if the Server Graphical Shell or Minimal Server Interface features are installed and enabled.</span></span>

<span data-ttu-id="f1b04-138">HKEY \_ local \_ machine \\ Software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ Server \\ ServerLevels :</span><span class="sxs-lookup"><span data-stu-id="f1b04-138">HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Server\\ServerLevels:</span></span>



|                  | <span data-ttu-id="f1b04-139">Server Core</span><span class="sxs-lookup"><span data-stu-id="f1b04-139">Server Core</span></span> | <span data-ttu-id="f1b04-140">Interface serveur minimale</span><span class="sxs-lookup"><span data-stu-id="f1b04-140">Minimal Server Interface</span></span> | <span data-ttu-id="f1b04-141">Interpréteur de commandes graphique de serveur</span><span class="sxs-lookup"><span data-stu-id="f1b04-141">Server Graphical Shell</span></span> |
|------------------|-------------|--------------------------|------------------------|
| <span data-ttu-id="f1b04-142">ServerCore = 1</span><span class="sxs-lookup"><span data-stu-id="f1b04-142">ServerCore=1</span></span>     | <span data-ttu-id="f1b04-143">X</span><span class="sxs-lookup"><span data-stu-id="f1b04-143">X</span></span>           | <span data-ttu-id="f1b04-144">X</span><span class="sxs-lookup"><span data-stu-id="f1b04-144">X</span></span>                        | <span data-ttu-id="f1b04-145">X</span><span class="sxs-lookup"><span data-stu-id="f1b04-145">X</span></span>                      |
| <span data-ttu-id="f1b04-146">Serveur-GuiMgmt = 1</span><span class="sxs-lookup"><span data-stu-id="f1b04-146">Server-GuiMgmt=1</span></span> |             | <span data-ttu-id="f1b04-147">X</span><span class="sxs-lookup"><span data-stu-id="f1b04-147">X</span></span>                        | <span data-ttu-id="f1b04-148">X</span><span class="sxs-lookup"><span data-stu-id="f1b04-148">X</span></span>                      |
| <span data-ttu-id="f1b04-149">ServerGuiShell = 1</span><span class="sxs-lookup"><span data-stu-id="f1b04-149">ServerGuiShell=1</span></span> |             |                          | <span data-ttu-id="f1b04-150">X</span><span class="sxs-lookup"><span data-stu-id="f1b04-150">X</span></span>                      |



 

<span data-ttu-id="f1b04-151">Un « X » dans le tableau ci-dessus signifie que la clé de Registre est présente lorsque la fonctionnalité correspondante est installée.</span><span class="sxs-lookup"><span data-stu-id="f1b04-151">An “X” in the table above means that registry key will be present when the corresponding feature is installed.</span></span>

<span data-ttu-id="f1b04-152">Notez que ces niveaux de serveur sont additifs ; Si l’interpréteur de commandes graphique de serveur est installé, il s’agit de l’interface serveur minimale et de Server Core.</span><span class="sxs-lookup"><span data-stu-id="f1b04-152">Note that these server levels are additive; if the Server Graphical Shell is installed, so is the Minimal Server Interface and Server Core.</span></span> <span data-ttu-id="f1b04-153">Dans ce cas, les deux clés de Registre sont présentes.</span><span class="sxs-lookup"><span data-stu-id="f1b04-153">In that case, both registry keys will be present.</span></span>

## <a name="tests"></a><span data-ttu-id="f1b04-154">Tests</span><span class="sxs-lookup"><span data-stu-id="f1b04-154">Tests</span></span>

<span data-ttu-id="f1b04-155">Examinez le code de votre application pour connaître les exigences qui utilisent l’un des API et binaires supprimés.</span><span class="sxs-lookup"><span data-stu-id="f1b04-155">Inspect your app code for requirements that use any of the removed APIs and binaries.</span></span> <span data-ttu-id="f1b04-156">Après avoir supprimé toutes les instances de ces fichiers binaires d’application de base, testez votre application dans un environnement qui n’inclut pas l’interpréteur de commandes graphique de serveur.</span><span class="sxs-lookup"><span data-stu-id="f1b04-156">After you have removed any instances of these from “core application” binaries, test your app in an environment that does not include the Server Graphical Shell.</span></span> <span data-ttu-id="f1b04-157">Les outils tels que Process Monitor peuvent vous aider.</span><span class="sxs-lookup"><span data-stu-id="f1b04-157">Tools such as the Process Monitor might help with this.</span></span>

<span data-ttu-id="f1b04-158">Si vous ne pouvez pas complètement cesser d’utiliser ces API et ces fichiers binaires, assurez-vous que votre application échoue correctement lorsqu’elle est exécutée sur une interface serveur minimale ou sur Server Core.</span><span class="sxs-lookup"><span data-stu-id="f1b04-158">If you cannot completely discontinue use of these APIs and binaries, ensure that your app fails gracefully when run on Minimal Server Interface or Server Core.</span></span>

## <a name="resources"></a><span data-ttu-id="f1b04-159">Ressources</span><span class="sxs-lookup"><span data-stu-id="f1b04-159">Resources</span></span>

-   <span data-ttu-id="f1b04-160">[Documentation Server Core existante sur MSDN](/previous-versions/windows/desktop/legacy/ms723891(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="f1b04-160">[Existing Server Core docs on MSDN](/previous-versions/windows/desktop/legacy/ms723891(v=vs.85))</span></span>

 

 