---
description: L’action MigrateFeatureStates est utilisée lors de la mise à niveau et lors de l’installation d’une nouvelle application sur une application associée.
ms.assetid: 3f53c555-02a9-4249-9f1a-98cd655fc79f
title: Action MigrateFeatureStates
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a8e76edb5fa13506291cc85ebcf8c8824e4ee28e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106536546"
---
# <a name="migratefeaturestates-action"></a><span data-ttu-id="24d47-103">Action MigrateFeatureStates</span><span class="sxs-lookup"><span data-stu-id="24d47-103">MigrateFeatureStates Action</span></span>

<span data-ttu-id="24d47-104">L’action MigrateFeatureStates est utilisée lors de la mise à niveau et lors de l’installation d’une nouvelle application sur une application associée.</span><span class="sxs-lookup"><span data-stu-id="24d47-104">The MigrateFeatureStates action is used during upgrading and when installing a new application over a related application.</span></span> <span data-ttu-id="24d47-105">MigrateFeatureStates lit les États des fonctionnalités dans l’application existante, puis définit ces États de fonctionnalités dans l’installation en attente.</span><span class="sxs-lookup"><span data-stu-id="24d47-105">MigrateFeatureStates reads the feature states in the existing application and then sets these feature states in the pending installation.</span></span> <span data-ttu-id="24d47-106">La méthode est utile uniquement lorsque la nouvelle arborescence de fonctionnalités n’a pas beaucoup changé par rapport à l’original.</span><span class="sxs-lookup"><span data-stu-id="24d47-106">The method is only useful when the new feature tree has not greatly changed from the original.</span></span>

<span data-ttu-id="24d47-107">L’action MigrateFeatureStates s’exécute uniquement lors de la première installation du produit.</span><span class="sxs-lookup"><span data-stu-id="24d47-107">The MigrateFeatureStates action only runs the first time the product is installed.</span></span> <span data-ttu-id="24d47-108">L’action MigrateFeatureStates ne s’exécute pas en mode maintenance ni en cours de désinstallation.</span><span class="sxs-lookup"><span data-stu-id="24d47-108">The MigrateFeatureStates action does not run during maintenance mode or uninstallation.</span></span>

<span data-ttu-id="24d47-109">L’action MigrateFeatureStates s’exécute dans l’ordre de chaque enregistrement de la [table de mise à niveau](upgrade-table.md) et compare le code de mise à niveau, la version du produit et la langue de chaque ligne à tous les produits installés sur le système.</span><span class="sxs-lookup"><span data-stu-id="24d47-109">MigrateFeatureStates action runs through each record of the [Upgrade table](upgrade-table.md) in sequence and compares the upgrade code, product version, and language in each row to all products installed on the system.</span></span> <span data-ttu-id="24d47-110">Si l’action MigrateFeatureStates détecte une correspondance, et si l’indicateur de bits msidbUpgradeAttributesMigrateFeatures est défini dans la colonne attributs de la table de mise à niveau, le programme d’installation interroge les États de fonctionnalités existants pour le produit et définit ces États pour les mêmes fonctionnalités dans la nouvelle application.</span><span class="sxs-lookup"><span data-stu-id="24d47-110">If MigrateFeatureStates action detects a correspondence, and if the msidbUpgradeAttributesMigrateFeatures bit flag is set in the Attributes column of the Upgrade table, the installer queries the existing feature states for the product and sets these states for the same features in the new application.</span></span> <span data-ttu-id="24d47-111">L’action migre uniquement les États de fonctionnalité si la propriété [**présélectionnée**](preselected.md) n’est pas définie.</span><span class="sxs-lookup"><span data-stu-id="24d47-111">The action only migrates the feature states if the [**Preselected**](preselected.md) property is not set.</span></span>

## <a name="sequence-restrictions"></a><span data-ttu-id="24d47-112">Restrictions de séquence</span><span class="sxs-lookup"><span data-stu-id="24d47-112">Sequence Restrictions</span></span>

<span data-ttu-id="24d47-113">L’action MigrateFeatureStates doit se trouver immédiatement après l' [action CostFinalize](costfinalize-action.md).</span><span class="sxs-lookup"><span data-stu-id="24d47-113">The MigrateFeatureStates action should come immediately after the [CostFinalize action](costfinalize-action.md).</span></span> <span data-ttu-id="24d47-114">MigrateFeatureStates doit être séquencé à la fois dans la [table InstallUISequence](installuisequence-table.md) et dans la [table InstallExecuteSequence](installexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="24d47-114">MigrateFeatureStates must be sequenced in both the [InstallUISequence table](installuisequence-table.md) and the [InstallExecuteSequence table](installexecutesequence-table.md).</span></span> <span data-ttu-id="24d47-115">Le programme d’installation empêche MigrateFeatureStates de s’exécuter dans InstallExecuteSequence si l’action a déjà été exécutée dans InstallUISequence.</span><span class="sxs-lookup"><span data-stu-id="24d47-115">The installer prevents MigrateFeatureStates from running in InstallExecuteSequence if the action has already run in InstallUISequence.</span></span>

## <a name="actiondata-messages"></a><span data-ttu-id="24d47-116">Messages ActionData</span><span class="sxs-lookup"><span data-stu-id="24d47-116">ActionData Messages</span></span>

<span data-ttu-id="24d47-117">MigrateFeatureSettings envoie un message de données d’action pour chaque produit.</span><span class="sxs-lookup"><span data-stu-id="24d47-117">MigrateFeatureSettings sends an action data message for each product.</span></span>

## <a name="remarks"></a><span data-ttu-id="24d47-118">Notes</span><span class="sxs-lookup"><span data-stu-id="24d47-118">Remarks</span></span>

<span data-ttu-id="24d47-119">Si plusieurs produits installés partagent une fonctionnalité, l’état d’installation de cette fonctionnalité peut varier d’un produit à l’autre.</span><span class="sxs-lookup"><span data-stu-id="24d47-119">If more than one installed product shares a feature, the installation state for that feature may differ between products.</span></span> <span data-ttu-id="24d47-120">L’action MigrateFeatureState utilise l’ordre de priorité suivant lors de la migration des États d’installation des fonctionnalités : exécution locale, exécution à partir de la source, publiée et désinstallée.</span><span class="sxs-lookup"><span data-stu-id="24d47-120">MigrateFeatureState action uses the following order of precedence when migrating feature installation states: run local, run from source, advertised, and uninstalled.</span></span> <span data-ttu-id="24d47-121">Par exemple, le produit installé A peut avoir la fonctionnalité Y en tant que INSTALLSTATE \_ local et le produit B installé peut avoir la fonctionnalité y en tant que InstallState \_ absente.</span><span class="sxs-lookup"><span data-stu-id="24d47-121">For example, installed product A may have feature Y as INSTALLSTATE\_LOCAL and installed product B may have feature Y as INSTALLSTATE\_ABSENT.</span></span> <span data-ttu-id="24d47-122">Si une mise à niveau installe le produit C et migre l’état d’installation de la fonctionnalité Y, MigrateFeatureState définit l’état d’installation de la fonctionnalité Y du produit C sur INSTALLSTATE \_ local.</span><span class="sxs-lookup"><span data-stu-id="24d47-122">If an upgrade installs product C and migrates the installation state of feature Y, MigrateFeatureState sets the installation state of feature Y in product C to INSTALLSTATE\_LOCAL.</span></span>

<span data-ttu-id="24d47-123">Pour plus d’informations sur l’utilisation de l’action MigrateFeatureStates pour les mises à niveau de produit, consultez [préparation d’une application pour les futures mises à niveau majeures](preparing-an-application-for-future-major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="24d47-123">For more information about how to use the MigrateFeatureStates action for product upgrades, see [Preparing an Application for Future Major Upgrades](preparing-an-application-for-future-major-upgrades.md).</span></span>

 

 



