---
description: L’action WriteEnvironmentStrings modifie les valeurs des variables d’environnement.
ms.assetid: a91c1ffe-1bdd-49bb-aa6a-71667a1ed812
title: Action WriteEnvironmentStrings
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc3a9d64a1140fc883d94e8d3733608d29dc2d39
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104034746"
---
# <a name="writeenvironmentstrings-action"></a><span data-ttu-id="90769-103">Action WriteEnvironmentStrings</span><span class="sxs-lookup"><span data-stu-id="90769-103">WriteEnvironmentStrings Action</span></span>

<span data-ttu-id="90769-104">L’action WriteEnvironmentStrings modifie les valeurs des variables d’environnement.</span><span class="sxs-lookup"><span data-stu-id="90769-104">The WriteEnvironmentStrings action modifies the values of environment variables.</span></span>

<span data-ttu-id="90769-105">Les variables d’environnement ne changent pas pour l’installation en cours lorsque l’action WriteEnvironmentStrings ou l' [action RemoveEnvironmentStrings](removeenvironmentstrings-action.md) est exécutée.</span><span class="sxs-lookup"><span data-stu-id="90769-105">Environment variables do not change for the installation in progress when the WriteEnvironmentStrings action or [RemoveEnvironmentStrings action](removeenvironmentstrings-action.md) are run.</span></span> <span data-ttu-id="90769-106">Sur Windows 2000, Windows Server 2003, Windows XP et Windows Vista, ces informations sont stockées dans le registre et un message [**WM \_ SETTINGCHANGE**](../winmsg/wm-settingchange.md) est envoyé pour informer le système des modifications une fois l’installation terminée.</span><span class="sxs-lookup"><span data-stu-id="90769-106">On Windows 2000, Windows Server 2003, Windows XP, and Windows Vista this information is stored in the registry and a [**WM\_SETTINGCHANGE**](../winmsg/wm-settingchange.md) message is sent to notify the system of the changes when the installation completes.</span></span> <span data-ttu-id="90769-107">Un autre processus peut recevoir la notification des modifications en gérant ces messages.</span><span class="sxs-lookup"><span data-stu-id="90769-107">Another process can receive notification of the changes by handling these messages.</span></span> <span data-ttu-id="90769-108">Aucun message n’est envoyé si le redémarrage du système est en attente.</span><span class="sxs-lookup"><span data-stu-id="90769-108">No message is sent if a restart of the system is pending.</span></span> <span data-ttu-id="90769-109">Un package peut utiliser la propriété [**MsiSystemRebootPending**](msisystemrebootpending.md) pour vérifier si un redémarrage du système est en attente.</span><span class="sxs-lookup"><span data-stu-id="90769-109">A package can use the [**MsiSystemRebootPending**](msisystemrebootpending.md) property to check whether a system restart is pending.</span></span>

<span data-ttu-id="90769-110">Le programme d’installation exécute l’action WriteEnvironmentStrings uniquement lors de l’installation ou de la réinstallation d’un composant, et exécute l' [action RemoveEnvironmentStrings](removeenvironmentstrings-action.md) uniquement pendant la suppression d’un composant.</span><span class="sxs-lookup"><span data-stu-id="90769-110">The installer runs the WriteEnvironmentStrings action only during the installation or reinstallation of a component, and runs the [RemoveEnvironmentStrings action](removeenvironmentstrings-action.md) only during the removal of a component.</span></span>

<span data-ttu-id="90769-111">Les valeurs sont écrites ou supprimées en fonction de la sélection d’actions et de modificateurs principaux.</span><span class="sxs-lookup"><span data-stu-id="90769-111">Values are written or removed based on the selection of primary actions and modifiers.</span></span> <span data-ttu-id="90769-112">Celles-ci sont décrites dans la section messages ActionData suivants.</span><span class="sxs-lookup"><span data-stu-id="90769-112">These are described in the following ActionData Messages section.</span></span> <span data-ttu-id="90769-113">Notez que, selon l’action spécifiée, WriteEnvironmentStrings peut supprimer des variables et RemoveEnvironmentStrings peut les ajouter en fonction de la création de la [table d’environnement](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="90769-113">Note that depending on the action specified, WriteEnvironmentStrings may remove variables, and RemoveEnvironmentStrings may add them based on the authoring of the [Environment table](environment-table.md).</span></span>

## <a name="sequence-restrictions"></a><span data-ttu-id="90769-114">Restrictions de séquence</span><span class="sxs-lookup"><span data-stu-id="90769-114">Sequence Restrictions</span></span>

<span data-ttu-id="90769-115">L' [action InstallValidate](installvalidate-action.md) doit être exécutée avant l’action RemoveEnvironmentStrings.</span><span class="sxs-lookup"><span data-stu-id="90769-115">The [InstallValidate action](installvalidate-action.md) must be executed before the RemoveEnvironmentStrings action.</span></span> <span data-ttu-id="90769-116">Étant donné que les actions WriteEnvironmentStrings et RemoveEnvironmentStrings ne sont jamais appliquées au cours de l’installation ou de la suppression d’un composant, leur séquence relative n’est pas restreinte.</span><span class="sxs-lookup"><span data-stu-id="90769-116">Because the WriteEnvironmentStrings action and RemoveEnvironmentStrings action are never both applied during an install or removal of a component, their relative sequence is not restricted.</span></span>

## <a name="actiondata-messages"></a><span data-ttu-id="90769-117">Messages ActionData</span><span class="sxs-lookup"><span data-stu-id="90769-117">ActionData Messages</span></span>



| <span data-ttu-id="90769-118">Champ</span><span class="sxs-lookup"><span data-stu-id="90769-118">Field</span></span> | <span data-ttu-id="90769-119">Description des données d’action</span><span class="sxs-lookup"><span data-stu-id="90769-119">Description of action data</span></span>                                                                                                                                                                                                  |
|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="90769-120">\[1\]</span><span class="sxs-lookup"><span data-stu-id="90769-120">\[1\]</span></span> | <span data-ttu-id="90769-121">Nom de la variable d’environnement à modifier.</span><span class="sxs-lookup"><span data-stu-id="90769-121">Name of the environment variable to modify.</span></span>                                                                                                                                                                                 |
| <span data-ttu-id="90769-122">\[2\]</span><span class="sxs-lookup"><span data-stu-id="90769-122">\[2\]</span></span> | <span data-ttu-id="90769-123">Valeur de la variable d’environnement.</span><span class="sxs-lookup"><span data-stu-id="90769-123">The environment variable value.</span></span>                                                                                                                                                                                             |
| <span data-ttu-id="90769-124">\[3\]</span><span class="sxs-lookup"><span data-stu-id="90769-124">\[3\]</span></span> | <span data-ttu-id="90769-125">Il s’agit d’un champ de bits indicateurs qui spécifie l’action à exécuter.</span><span class="sxs-lookup"><span data-stu-id="90769-125">This is a field of bit flags that specifies the action to be performed.</span></span> <span data-ttu-id="90769-126">N’incluez qu’un seul bit pour une action principale.</span><span class="sxs-lookup"><span data-stu-id="90769-126">Include only one bit for a primary action.</span></span> <span data-ttu-id="90769-127">Il peut y avoir plusieurs bits de modificateur inclus dans ce champ.</span><span class="sxs-lookup"><span data-stu-id="90769-127">There may be more than one modifier bit included in this field.</span></span> <span data-ttu-id="90769-128">Consultez les descriptions des indicateurs de bits suivantes.</span><span class="sxs-lookup"><span data-stu-id="90769-128">See the following bit flag descriptions.</span></span> |



 



| <span data-ttu-id="90769-129">Valeur de bit</span><span class="sxs-lookup"><span data-stu-id="90769-129">Bit Value</span></span> | <span data-ttu-id="90769-130">Description des actions principales</span><span class="sxs-lookup"><span data-stu-id="90769-130">Description of primary actions</span></span>                                                                                                                                                                                      |
|-----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="90769-131">0x1</span><span class="sxs-lookup"><span data-stu-id="90769-131">0x1</span></span>       | <span data-ttu-id="90769-132">Prêts ?</span><span class="sxs-lookup"><span data-stu-id="90769-132">Set.</span></span> <span data-ttu-id="90769-133">Définit la valeur de la variable d’environnement dans tous les cas.</span><span class="sxs-lookup"><span data-stu-id="90769-133">Sets the value of the environment variable in all cases.</span></span><br/> <span data-ttu-id="90769-134">Si ce bit est combiné avec un bit de modificateur d’ajout ou de préfixe, l’action ajoute la valeur à toute valeur existante dans la variable.</span><span class="sxs-lookup"><span data-stu-id="90769-134">If this bit is combined with an Append or Prefix modifier bit, the action adds the value to any existing value in the variable.</span></span><br/> |
| <span data-ttu-id="90769-135">0x2</span><span class="sxs-lookup"><span data-stu-id="90769-135">0x2</span></span>       | <span data-ttu-id="90769-136">Prêts ?</span><span class="sxs-lookup"><span data-stu-id="90769-136">Set.</span></span> <span data-ttu-id="90769-137">Définit la valeur si la variable est absente.</span><span class="sxs-lookup"><span data-stu-id="90769-137">Sets the value if the variable is absent.</span></span><br/> <span data-ttu-id="90769-138">Si ce bit est combiné avec un bit de modificateur d’ajout ou de préfixe, l’action ajoute la valeur à toute valeur existante dans la variable.</span><span class="sxs-lookup"><span data-stu-id="90769-138">If this bit is combined with an Append or Prefix modifier bit, the action adds the value to any existing value in the variable.</span></span><br/>                |
| <span data-ttu-id="90769-139">0x4</span><span class="sxs-lookup"><span data-stu-id="90769-139">0x4</span></span>       | <span data-ttu-id="90769-140">Supprimer.</span><span class="sxs-lookup"><span data-stu-id="90769-140">Remove.</span></span> <span data-ttu-id="90769-141">Supprime la valeur de la variable.</span><span class="sxs-lookup"><span data-stu-id="90769-141">Removes the value from the variable.</span></span><br/> <span data-ttu-id="90769-142">Si ce bit est combiné avec un bit de modificateur d’ajout ou de préfixe, la valeur est supprimée de la chaîne existante, si la valeur existe.</span><span class="sxs-lookup"><span data-stu-id="90769-142">If this bit is combined with an Append or Prefix modifier bit, the value is removed from the existing string, if the value exists.</span></span><br/>               |



 



| <span data-ttu-id="90769-143">Valeur de bit</span><span class="sxs-lookup"><span data-stu-id="90769-143">Bit Value</span></span>  | <span data-ttu-id="90769-144">Description du modificateur</span><span class="sxs-lookup"><span data-stu-id="90769-144">Description of modifier</span></span>                                                                                                                                                              |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="90769-145">0x20000000</span><span class="sxs-lookup"><span data-stu-id="90769-145">0x20000000</span></span> | <span data-ttu-id="90769-146">Si ce bit est défini, les actions sont appliquées aux variables d’environnement de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="90769-146">If this bit is set, actions are applied to the machine environment variables.</span></span><br/> <span data-ttu-id="90769-147">Si ce bit n’est pas défini, des actions sont appliquées aux variables d’environnement de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="90769-147">If this bit is not set, actions are applied to the user's environment variables.</span></span><br/> |
| <span data-ttu-id="90769-148">0x40000000</span><span class="sxs-lookup"><span data-stu-id="90769-148">0x40000000</span></span> | <span data-ttu-id="90769-149">Ajouter :</span><span class="sxs-lookup"><span data-stu-id="90769-149">Append.</span></span> <span data-ttu-id="90769-150">Ce bit est facultatif.</span><span class="sxs-lookup"><span data-stu-id="90769-150">This bit is optional.</span></span> <span data-ttu-id="90769-151">Ne définissez pas à la fois les modificateurs Append et prefix.</span><span class="sxs-lookup"><span data-stu-id="90769-151">Do not set both the Append and Prefix modifiers.</span></span><br/>                                                                                            |
| <span data-ttu-id="90769-152">0x80000000</span><span class="sxs-lookup"><span data-stu-id="90769-152">0x80000000</span></span> | <span data-ttu-id="90769-153">Céder.</span><span class="sxs-lookup"><span data-stu-id="90769-153">Prefix.</span></span> <span data-ttu-id="90769-154">Ce bit est facultatif.</span><span class="sxs-lookup"><span data-stu-id="90769-154">This bit is optional.</span></span> <span data-ttu-id="90769-155">Ne définissez pas à la fois les modificateurs Append et prefix.</span><span class="sxs-lookup"><span data-stu-id="90769-155">Do not set both the Append and Prefix modifiers.</span></span><br/>                                                                                            |



 

 

 
