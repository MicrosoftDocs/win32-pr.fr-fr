---
description: La rubrique suivante décrit comment créer un package Windows Installer pour installer un assembly Win32.
ms.assetid: 1234e904-fc7f-4eb7-8c50-0c959bbf5261
title: Installation d’assemblys Win32 pour le partage côte à côte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea72c9bcb7bd85ac38dfc8857030d6b9d6afbf23
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106532155"
---
# <a name="installing-win32-assemblies-for-side-by-side-sharing"></a><span data-ttu-id="6ef79-103">Installation d’assemblys Win32 pour le partage côte à côte</span><span class="sxs-lookup"><span data-stu-id="6ef79-103">Installing Win32 Assemblies for Side-by-Side Sharing</span></span>

<span data-ttu-id="6ef79-104">La rubrique suivante décrit comment créer un package Windows Installer pour installer un assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="6ef79-104">The following describes how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="6ef79-105">Le package installe un assembly côte à côte dans le dossier WinSxS pour l’utilisation partagée de l’application.</span><span class="sxs-lookup"><span data-stu-id="6ef79-105">The package installs a side-by-side assembly in the Winsxs folder for the shared use of the application.</span></span> <span data-ttu-id="6ef79-106">Après l’installation du package, l’assembly partagé est accessible globalement à toute application qui spécifie une dépendance sur l’assembly dans un fichier manifeste d’assembly.</span><span class="sxs-lookup"><span data-stu-id="6ef79-106">After installing the package, the shared assembly is globally available to any application that specifies a dependence on the assembly in an assembly manifest file.</span></span> <span data-ttu-id="6ef79-107">Le programme d’installation n’enregistre pas globalement l’assembly côte à côte sur le système.</span><span class="sxs-lookup"><span data-stu-id="6ef79-107">The installer does not globally register the side-by-side assembly on the system.</span></span>

<span data-ttu-id="6ef79-108">Notez que vous pouvez installer des assemblys côte à côte partagés à l’aide de [modules de fusion](merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-108">Note that you may install shared side-by-side assemblies using [merge modules](merge-modules.md).</span></span>

<span data-ttu-id="6ef79-109">Avant de continuer, vous devez comprendre comment créer un package Windows Installer sans assemblys.</span><span class="sxs-lookup"><span data-stu-id="6ef79-109">Before continuing you should understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="6ef79-110">Pour obtenir un exemple de création d’une installation simple, consultez [un exemple d’installation](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-110">For an example of how to author a simple installation, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="6ef79-111">**Pour installer un assembly partagé côte à côte**</span><span class="sxs-lookup"><span data-stu-id="6ef79-111">**To install a shared assembly side-by-side**</span></span>

1.  <span data-ttu-id="6ef79-112">Définissez un composant Windows Installer qui comprend l’assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="6ef79-112">Define a Windows Installer component that includes the Win32 assembly.</span></span> <span data-ttu-id="6ef79-113">Ce composant peut contenir d’autres ressources qui doivent toujours être installées ou supprimées avec l’assembly.</span><span class="sxs-lookup"><span data-stu-id="6ef79-113">This component may contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="6ef79-114">Tous les autres composants de l’application peuvent être créés de la même manière que pour une installation sans assemblys.</span><span class="sxs-lookup"><span data-stu-id="6ef79-114">All the other components of the application can be authored just as for an installation without assemblies.</span></span> <span data-ttu-id="6ef79-115">Ajoutez une ligne à la [table des composants](component-table.md) pour le composant contenant l’assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="6ef79-115">Add a row to the [Component table](component-table.md) for the component containing the Win32 assembly.</span></span> <span data-ttu-id="6ef79-116">Entrez un [GUID](guid.md) de Windows Installer valide pour ce code de composant.</span><span class="sxs-lookup"><span data-stu-id="6ef79-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="6ef79-117">N’utilisez pas le fichier manifeste comme chemin d’accès de clé pour ce composant.</span><span class="sxs-lookup"><span data-stu-id="6ef79-117">Do not use the manifest file as the key path for this component.</span></span>
2.  <span data-ttu-id="6ef79-118">Ajoutez une ligne à la [table FeatureComponents](featurecomponents-table.md) en liant le composant à une fonctionnalité de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="6ef79-118">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="6ef79-119">Pour plus d’informations, consultez [composants et fonctionnalités](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-119">For information see, [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="6ef79-120">Une fonctionnalité de Windows Installer doit être une partie des fonctionnalités de l’application qui est reconnaissable à un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6ef79-120">A Windows Installer feature should be a piece of the application's functionality that is recognizable to a user.</span></span> <span data-ttu-id="6ef79-121">L’assembly est activé lorsque cette fonctionnalité est sélectionnée par un utilisateur ou a généré une erreur par une application.</span><span class="sxs-lookup"><span data-stu-id="6ef79-121">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="6ef79-122">Si l’assembly définit une fonctionnalité supplémentaire, ajoutez une ligne supplémentaire à la [table des fonctionnalités](feature-table.md) pour les attributs de la fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="6ef79-122">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature's attributes.</span></span> <span data-ttu-id="6ef79-123">Cette étape n’est pas nécessaire lors de la création d’un module de fusion.</span><span class="sxs-lookup"><span data-stu-id="6ef79-123">This step is not needed when authoring a merge module.</span></span>
3.  <span data-ttu-id="6ef79-124">Pour les assemblys côte à côte, les informations de liaison et d’activation, telles que les classes COM, les interfaces et les bibliothèques de types, sont stockées dans des fichiers manifestes plutôt que dans le registre.</span><span class="sxs-lookup"><span data-stu-id="6ef79-124">For side-by-side assemblies, binding and activation information, such as COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="6ef79-125">Les assemblys partagés stockent ces informations dans un manifeste d’assembly.</span><span class="sxs-lookup"><span data-stu-id="6ef79-125">Shared assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="6ef79-126">Sur les systèmes qui prennent en charge les assemblys côte à côte, le programme d’installation ignore le traitement des informations relatives au composant entré dans la [table d’extension](extension-table.md), la [table de verbes](verb-table.md), la [table Typelib](typelib-table.md), la [table MIME](mime-table.md), la table de [classes](class-table.md), la [table ProgID](progid-table.md)et la [table AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-126">On systems that support side-by-side assemblies, the installer skips processing any information about the component entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="6ef79-127">Les informations de liaison et d’activation peuvent être entrées dans ces tables pour être utilisées par les systèmes qui ne prennent pas en charge le partage d’assembly côte à côte.</span><span class="sxs-lookup"><span data-stu-id="6ef79-127">Binding and activation information may be entered into these tables for use by systems that do not support side-by-side assembly sharing.</span></span>
4.  <span data-ttu-id="6ef79-128">L’installation côte à côte n’inscrit pas l’assembly globalement, le programme d’installation ignore l’inscription automatique du composant si des informations d’auto-inscription ont été entrées dans la [table Selfreg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-128">Side-by-side installation does not globally register the assembly, the installer skips self-registering the component if any self-registration information has been entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="6ef79-129">Les informations d’auto-inscription peuvent être entrées dans la table SelfReg pour l’inscription automatique du composant sur les systèmes qui ne prennent pas en charge le partage d’assembly côte à côte.</span><span class="sxs-lookup"><span data-stu-id="6ef79-129">Self-registration information may be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
5.  <span data-ttu-id="6ef79-130">Ajoutez toutes les autres informations du Registre, en excluant la liaison et l’activation ou l’inscription automatique du composant, à la table [du Registre](registry-table.md), à la [table RemoveRegistry](removeregistry-table.md)et à la [table d’environnement](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-130">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
6.  <span data-ttu-id="6ef79-131">Comme il s’agit d’un assembly partagé, ne générez pas de fichier. local.</span><span class="sxs-lookup"><span data-stu-id="6ef79-131">Because this is a shared assembly do not generate a .local file.</span></span> <span data-ttu-id="6ef79-132">N’incluez pas d’informations pour ce composant dans la [table IsolatedComponent](isolatedcomponent-table.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-132">Do not include information for this component in the [IsolatedComponent table](isolatedcomponent-table.md).</span></span> <span data-ttu-id="6ef79-133">Le programme d’installation ignore la table IsolatedComponent pour ce composant sur les systèmes d’exploitation qui prennent en charge le partage côte à côte.</span><span class="sxs-lookup"><span data-stu-id="6ef79-133">The installer skips the IsolatedComponent table for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="6ef79-134">Ajoutez des informations à la table IsolatedComponent si vous souhaitez que l’assembly soit privé sur les systèmes qui prennent en charge les fichiers. local.</span><span class="sxs-lookup"><span data-stu-id="6ef79-134">Add information to the IsolatedComponent table if you would like the assembly to be private on systems that support .local files.</span></span>
7.  <span data-ttu-id="6ef79-135">Pour activer le partage côte à côte, l’assembly Win32 doit être installé dans le dossier WinSxS.</span><span class="sxs-lookup"><span data-stu-id="6ef79-135">To enable side-by-side sharing, the Win32 assembly must be installed into the Winsxs folder.</span></span> <span data-ttu-id="6ef79-136">Pour ce faire, vous devez laisser la \_ colonne application de fichier de la [table MsiAssembly](msiassembly-table.md) null pour l’assembly.</span><span class="sxs-lookup"><span data-stu-id="6ef79-136">This is accomplished by leaving the File\_Application column of the [MsiAssembly table](msiassembly-table.md) null for the assembly.</span></span> <span data-ttu-id="6ef79-137">Cela indique au programme d’installation d’installer l’assembly dans le dossier WinSxS, plutôt que dans le dossier du composant.</span><span class="sxs-lookup"><span data-stu-id="6ef79-137">This tells the installer to install the assembly to the WinSxS folder, instead of to the folder of the component.</span></span> <span data-ttu-id="6ef79-138">Ajoutez une ligne à la [table MsiAssembly](msiassembly-table.md) pour le composant qui contient l’assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="6ef79-138">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="6ef79-139">Entrez la valeur 1 dans le champ attributs de la table MsiAssembly pour spécifier qu’il s’agit d’un assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="6ef79-139">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="6ef79-140">Pour un assembly partagé, laissez le champ de l’application de fichier \_ vide.</span><span class="sxs-lookup"><span data-stu-id="6ef79-140">For a shared assembly, leave the File\_Application field empty.</span></span> <span data-ttu-id="6ef79-141">Ajoutez l' [action MsiPublishAssemblies](msipublishassemblies-action.md) à la table [InstallExecuteSequence](installexecutesequence-table.md) ou à la [table AdvtExecuteSequence](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-141">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="6ef79-142">Ajoutez l' [action MsiUnpublishAssemblies](msiunpublishassemblies-action.md) à la table InstallExecuteSequence.</span><span class="sxs-lookup"><span data-stu-id="6ef79-142">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span>
8.  <span data-ttu-id="6ef79-143">Ajoutez des lignes à la [table MsiAssemblyName](msiassemblyname-table.md) pour le composant.</span><span class="sxs-lookup"><span data-stu-id="6ef79-143">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="6ef79-144">Ajoutez une ligne pour chaque paire nom/valeur spécifiée dans la section assemblyIdentity du manifeste.</span><span class="sxs-lookup"><span data-stu-id="6ef79-144">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="6ef79-145">Pour obtenir un exemple, consultez la [table MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="6ef79-145">For an example, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



