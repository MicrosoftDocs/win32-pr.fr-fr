---
description: 'Cette section énumère une liste de conseils, liés à la documentation principale du kit de développement logiciel (SDK) Windows Installer, pour aider les développeurs d’applications, les auteurs de la configuration, les professionnels de l’informatique et les développeurs d’infrastructure à découvrir les meilleures pratiques en matière d’utilisation de la Windows Installer :'
ms.assetid: ff48d995-fe6f-4d1b-898d-67574ed3c5b7
title: Meilleures pratiques en matière de Windows Installer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ffaf6aae83afbe510f2b1eefc447e34754296ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104034783"
---
# <a name="windows-installer-best-practices"></a><span data-ttu-id="868bf-103">Meilleures pratiques en matière de Windows Installer</span><span class="sxs-lookup"><span data-stu-id="868bf-103">Windows Installer Best Practices</span></span>

<span data-ttu-id="868bf-104">Cette section énumère une liste de conseils, liés à la documentation principale du kit de développement logiciel (SDK) Windows Installer, pour aider les développeurs d’applications, les auteurs de la configuration, les professionnels de l’informatique et les développeurs d’infrastructure à découvrir les meilleures pratiques en matière d’utilisation de la Windows Installer :</span><span class="sxs-lookup"><span data-stu-id="868bf-104">This section enumerates a list of tips, linked to the main Windows Installer SDK documentation, to help Application Developers, Setup Authors, IT Professionals, and Infrastructure Developers discover best practices for using the Windows Installer:</span></span>

-   [<span data-ttu-id="868bf-105">Mettez à jour la version de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-105">Update the Windows Installer version.</span></span>](#update-the-windows-installer-version)
-   [<span data-ttu-id="868bf-106">Répondez aux exigences de certification du logo Windows.</span><span class="sxs-lookup"><span data-stu-id="868bf-106">Meet the Windows Logo certification requirements.</span></span>](#meet-the-windows-logo-certification-requirements)
-   [<span data-ttu-id="868bf-107">Préparez le package pour la localisation.</span><span class="sxs-lookup"><span data-stu-id="868bf-107">Prepare the package for localization.</span></span>](#prepare-the-package-for-localization)
-   [<span data-ttu-id="868bf-108">Mettez à jour vos outils de développement Windows Installer et votre documentation.</span><span class="sxs-lookup"><span data-stu-id="868bf-108">Update your Windows Installer development tools and documentation.</span></span>](#update-your-windows-installer-development-tools-and-documentation)
-   [<span data-ttu-id="868bf-109">Si vous décidez de reconditionner une application d’installation héritée, suivez les bonnes pratiques en matière de réintégration.</span><span class="sxs-lookup"><span data-stu-id="868bf-109">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>](#if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices)
-   [<span data-ttu-id="868bf-110">N’essayez pas de remplacer des ressources protégées.</span><span class="sxs-lookup"><span data-stu-id="868bf-110">Do not try to replace protected resources.</span></span>](#do-not-try-to-replace-protected-resources)
-   [<span data-ttu-id="868bf-111">Ne dépendez pas de ressources non critiques.</span><span class="sxs-lookup"><span data-stu-id="868bf-111">Do not depend upon non-critical resources.</span></span>](#do-not-depend-upon-non-critical-resources)
-   [<span data-ttu-id="868bf-112">Utilisez l’API pour récupérer les informations de configuration de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-112">Use the API to retrieve Windows Installer configuration information.</span></span>](#use-the-api-to-retrieve-windows-installer-configuration-information)
-   [<span data-ttu-id="868bf-113">Organisez l’installation de votre application autour des composants.</span><span class="sxs-lookup"><span data-stu-id="868bf-113">Organize the installation of your application around components.</span></span>](#organize-the-installation-of-your-application-around-components)
-   [<span data-ttu-id="868bf-114">Réduisez la taille des packages de Windows Installer volumineux.</span><span class="sxs-lookup"><span data-stu-id="868bf-114">Reduce the size of large Windows Installer packages.</span></span>](#reduce-the-size-of-large-windows-installer-packages)
-   [<span data-ttu-id="868bf-115">Si vous utilisez des actions personnalisées, suivez les bonnes pratiques d’action personnalisées.</span><span class="sxs-lookup"><span data-stu-id="868bf-115">If you use custom actions, follow good custom action practices.</span></span>](#if-you-use-custom-actions-follow-good-custom-action-practices)
-   [<span data-ttu-id="868bf-116">Si vous utilisez des assemblys, suivez les bonnes pratiques d’assembly</span><span class="sxs-lookup"><span data-stu-id="868bf-116">If you use assemblies, follow good assembly practices</span></span>](#if-you-use-assemblies-follow-good-assembly-practices)
-   [<span data-ttu-id="868bf-117">N’expédiez pas d’installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="868bf-117">Do not ship concurrent installations.</span></span>](#do-not-ship-concurrent-installations)
-   [<span data-ttu-id="868bf-118">Assurez la cohérence des noms de packages et des codes de package.</span><span class="sxs-lookup"><span data-stu-id="868bf-118">Keep package names and package codes consistent.</span></span>](#keep-package-names-and-package-codes-consistent)
-   [<span data-ttu-id="868bf-119">N’utilisez pas les tables SelfReg et TypeLib.</span><span class="sxs-lookup"><span data-stu-id="868bf-119">Do not use the SelfReg and TypeLib tables.</span></span>](#do-not-use-the-selfreg-and-typelib-tables)
-   [<span data-ttu-id="868bf-120">Fournissez l’option d’installation sans interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-120">Provide the option to install without a user interface.</span></span>](#provide-the-option-to-install-without-a-user-interface)
-   [<span data-ttu-id="868bf-121">Évitez d’utiliser la stratégie AlwaysInstallElevated a.</span><span class="sxs-lookup"><span data-stu-id="868bf-121">Avoid using the AlwaysInstallElevated policy.</span></span>](#avoid-using-the-alwaysinstallelevated-policy)
-   [<span data-ttu-id="868bf-122">Activez la stratégie DisableMedia pour limiter l’installation non autorisée.</span><span class="sxs-lookup"><span data-stu-id="868bf-122">Enable the DisableMedia policy to limit unauthorized installation.</span></span>](#enable-the-disablemedia-policy-to-limit-unauthorized-installation)
-   [<span data-ttu-id="868bf-123">Conservez les fichiers sources du package d’origine sécurisés et disponibles pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="868bf-123">Keep the original package source files secure and available to users.</span></span>](#keep-the-original-package-source-files-secure-and-available-to-users)
-   [<span data-ttu-id="868bf-124">Activez la journalisation documentée sur l’ordinateur de l’utilisateur lors du dépannage du déploiement.</span><span class="sxs-lookup"><span data-stu-id="868bf-124">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>](#enable-verbose-logging-on-users-computer-when-troubleshooting-deployment)
-   [<span data-ttu-id="868bf-125">La désinstallation laisse l’ordinateur de l’utilisateur dans un état propre.</span><span class="sxs-lookup"><span data-stu-id="868bf-125">Uninstallation leaves the user's computer in a clean state.</span></span>](#uninstallation-leaves-the-users-computer-in-a-clean-state)
-   [<span data-ttu-id="868bf-126">Testez les packages pour un déploiement d’installation par utilisateur et par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-126">Test packages for both per-user and per-machine installation deployment.</span></span>](#test-packages-for-both-per-user-and-per-machine-installation-deployment)
-   [<span data-ttu-id="868bf-127">Planifiez et testez une stratégie de maintenance avant d’expédier l’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-127">Plan and test a servicing strategy before shipping the application.</span></span>](#plan-and-test-a-servicing-strategy-before-shipping-the-application)
-   [<span data-ttu-id="868bf-128">Réduisez la dépendance des mises à jour sur les sources d’origine.</span><span class="sxs-lookup"><span data-stu-id="868bf-128">Reduce the dependency of updates upon the original sources.</span></span>](#reduce-the-dependency-of-updates-upon-the-original-sources)
-   [<span data-ttu-id="868bf-129">Ne distribuez pas les modules de fusion non desservis.</span><span class="sxs-lookup"><span data-stu-id="868bf-129">Do not distribute unserviceable merge modules.</span></span>](#do-not-distribute-unserviceable-merge-modules)
-   [<span data-ttu-id="868bf-130">Évitez d’appliquer des correctifs aux installations administratives.</span><span class="sxs-lookup"><span data-stu-id="868bf-130">Avoid patching administrative installations.</span></span>](#avoid-patching-administrative-installations)
-   [<span data-ttu-id="868bf-131">Enregistrez les mises à jour à exécuter avec des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="868bf-131">Register updates to run with elevated privilege.</span></span>](#register-updates-to-run-with-elevated-privilege)
-   [<span data-ttu-id="868bf-132">Utilisez la table MsiPatchSequence pour séquencer les correctifs.</span><span class="sxs-lookup"><span data-stu-id="868bf-132">Use the MsiPatchSequence Table to sequence patches.</span></span>](#use-the-msipatchsequence-table-to-sequence-patches)
-   [<span data-ttu-id="868bf-133">Testez soigneusement le package d’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-133">Test the installation package thoroughly.</span></span>](#test-the-installation-package-thoroughly)
-   [<span data-ttu-id="868bf-134">Corrigez toutes les erreurs de validation avant de déployer un package d’installation nouveau ou révisé.</span><span class="sxs-lookup"><span data-stu-id="868bf-134">Fix all validation errors before deploying a new or revised installation package.</span></span>](#fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package)
-   [<span data-ttu-id="868bf-135">Créer une installation sécurisée.</span><span class="sxs-lookup"><span data-stu-id="868bf-135">Author a secure installation.</span></span>](#author-a-secure-installation)
-   [<span data-ttu-id="868bf-136">Utiliser PMSIHANDLE au lieu de HANDLE</span><span class="sxs-lookup"><span data-stu-id="868bf-136">Use PMSIHANDLE instead of HANDLE</span></span>](#use-pmsihandle-instead-of-handle)

## <a name="update-the-windows-installer-version"></a><span data-ttu-id="868bf-137">Mettez à jour la version de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-137">Update the Windows Installer version.</span></span>

-   <span data-ttu-id="868bf-138">Utilisez Windows Installer 5,0 sur Windows Server 2008 R2 et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="868bf-138">Use Windows Installer 5.0 on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="868bf-139">Il s’agit de la version Windows Installer fournie avec le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="868bf-139">This is the Windows Installer version provided with the operating system.</span></span>
-   <span data-ttu-id="868bf-140">Utilisez Windows Installer 4,5 sur Windows Server 2008, Windows Server 2003 avec Service Pack 1 (SP1), Windows Vista avec Service Pack 1 (SP1) ou Windows XP avec Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="868bf-140">Use Windows Installer 4.5 on Windows Server 2008, Windows Server 2003 with Service Pack 1 (SP1), Windows Vista with Service Pack 1 (SP1), or Windows XP with Service Pack 2 (SP2).</span></span> <span data-ttu-id="868bf-141">Pour plus d’informations sur l’obtention de la dernière version de Windows Installer, consultez [Windows Installer redistribuables](windows-installer-redistributables.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-141">For information about obtaining the latest Windows Installer version, see [Windows Installer Redistributables](windows-installer-redistributables.md).</span></span>
-   <span data-ttu-id="868bf-142">Utilisez Windows Installer 3,1 sur Windows 2000 avec Service Pack 3 (SP3).</span><span class="sxs-lookup"><span data-stu-id="868bf-142">Use Windows Installer 3.1 on Windows 2000 with Service Pack 3 (SP3).</span></span> <span data-ttu-id="868bf-143">Windows Installer version 3,1 possède des fonctionnalités qui facilitent la maintenance et la mise à [jour corrective](patching.md)des applications.</span><span class="sxs-lookup"><span data-stu-id="868bf-143">Windows Installer version 3.1 has features that facilitate better application servicing and [patching](patching.md).</span></span>
-   <span data-ttu-id="868bf-144">De nombreuses fonctionnalités importantes ont été introduites avec la version 3,0 et sont répertoriées dans la section [non prise en charge dans Windows Installer version 2,0](not-supported-in-windows-installer-version-2-0.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-144">Many important features were introduced with version 3.0 and are listed in the section [Not Supported in Windows Installer Version 2.0](not-supported-in-windows-installer-version-2-0.md).</span></span> <span data-ttu-id="868bf-145">Les packages d’installation et les mises à jour qui ont été créés pour Windows Installer 2,0 peuvent être installés à l’aide de Windows Installer 3,0 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="868bf-145">Installation packages and updates that were created for Windows Installer 2.0 can be installed using Windows Installer 3.0 and later.</span></span> <span data-ttu-id="868bf-146">Les packages de correctifs qui contiennent les nouvelles tables utilisées par Windows Installer 3,0 peuvent toujours être appliqués à l’aide de versions antérieures de Windows Installer mais sans la fonctionnalité de mise à jour corrective Windows Installer 3,0.</span><span class="sxs-lookup"><span data-stu-id="868bf-146">Patch packages that contain the new tables used by Windows Installer 3.0 can still be applied using earlier versions of Windows Installer but without the Windows Installer 3.0 patching functionality.</span></span> <span data-ttu-id="868bf-147">Il est également possible de créer des correctifs qui requièrent explicitement le Windows Installer 3,0 qui ne peuvent pas être appliqués par des versions antérieures de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-147">It is also possible to author patches that explicitly require the Windows Installer 3.0 that cannot be applied by earlier versions of Windows Installer.</span></span> <span data-ttu-id="868bf-148">Si un utilisateur ne parvient pas à mettre à jour la version du programme d’installation, assurez-vous que votre application ou mise à jour sera compatible avec une prochaine mise à jour du Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-148">If a user is unable to update the installer version, ensure that your application or update will be compatible with a future update of the Windows Installer.</span></span>
-   <span data-ttu-id="868bf-149">Pour obtenir la liste des fonctionnalités Windows Installer non prises en charge par les versions antérieures de Windows Installer, consultez [Nouveautés de Windows Installer](what-s-new-in-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-149">For a list of the Windows Installer features not supported by earlier versions of the Windows installer see [What's New in Windows Installer](what-s-new-in-windows-installer.md).</span></span>

## <a name="meet-the-windows-logo-certification-requirements"></a><span data-ttu-id="868bf-150">Répondez aux exigences de certification du logo Windows.</span><span class="sxs-lookup"><span data-stu-id="868bf-150">Meet the Windows Logo certification requirements.</span></span>

-   <span data-ttu-id="868bf-151">Même si vous n’envisagez pas de soumettre votre application au programme de logo, le respect des instructions de certification du logo peut contribuer à améliorer votre Windows Installer Package.</span><span class="sxs-lookup"><span data-stu-id="868bf-151">Even if you do not intend to submit your application to the logo program, following the logo certification guidelines can help make your Windows Installer package better.</span></span> <span data-ttu-id="868bf-152">Pour obtenir une vue d’ensemble des conditions requises pour le logo et des liens vers des programmes de certification de logo spécifiques, consultez [Windows Installer et logo Requirements](windows-installer-and-logo-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-152">For an overview of the logo requirements, and links to specific logo certification programs, see [Windows Installer and Logo Requirements](windows-installer-and-logo-requirements.md).</span></span>

## <a name="prepare-the-package-for-localization"></a><span data-ttu-id="868bf-153">Préparez le package pour la localisation.</span><span class="sxs-lookup"><span data-stu-id="868bf-153">Prepare the package for localization.</span></span>

-   <span data-ttu-id="868bf-154">Il est recommandé de préparer la localisation future lors de la création du package d’installation d’origine.</span><span class="sxs-lookup"><span data-stu-id="868bf-154">It is a good practice to prepare for future localization when authoring the original installation package.</span></span> <span data-ttu-id="868bf-155">Vous pouvez suivre la procédure de localisation de packages suggérée pour [localiser un package de Windows Installer](localizing-a-windows-installer-package.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-155">You can follow the suggested package localization procedure in [Localizing a Windows Installer Package](localizing-a-windows-installer-package.md).</span></span>

## <a name="update-your-windows-installer-development-tools-and-documentation"></a><span data-ttu-id="868bf-156">Mettez à jour vos outils de développement Windows Installer et votre documentation.</span><span class="sxs-lookup"><span data-stu-id="868bf-156">Update your Windows Installer development tools and documentation.</span></span>

-   <span data-ttu-id="868bf-157">Les [outils de développement Windows Installer](windows-installer-development-tools.md) ne sont pas redistribuables et vous devez uniquement utiliser les versions de ces outils disponibles auprès de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="868bf-157">The [Windows Installer Development Tools](windows-installer-development-tools.md) are not redistributable, and you should only use the versions of these tools available from Microsoft.</span></span> <span data-ttu-id="868bf-158">Celles-ci sont disponibles dans les [composants SDK Windows pour Windows Installer les développeurs](platform-sdk-components-for-windows-installer-developers.md) dans le kit de développement logiciel (SDK) Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="868bf-158">These are available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="868bf-159">Plusieurs éditeurs de logiciels indépendants proposent des outils permettant de créer ou de modifier des packages de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-159">Several independent software vendors offer tools to create or modify Windows Installer packages.</span></span> <span data-ttu-id="868bf-160">Ces outils peuvent fournir un environnement de création de packages qui peut être plus facile à utiliser que les outils fournis dans le kit de développement logiciel (SDK) Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-160">These tools can provide a package authoring environment that may be easier to use than the tools provided in the Windows Installer SDK.</span></span> <span data-ttu-id="868bf-161">Vous pouvez en savoir plus sur ces outils à partir des ressources d’informations abordées dans [autres sources d’informations](other-sources-of-windows-installer-information.md)sur les Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-161">You can learn more about these tools from the information resources discussed in [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md).</span></span>
-   <span data-ttu-id="868bf-162">La capacité de créer un package à partir de fichiers texte peut être plus intuitive pour certains développeurs.</span><span class="sxs-lookup"><span data-stu-id="868bf-162">The capability to build a package from text files may be more intuitive for some developers.</span></span> <span data-ttu-id="868bf-163">L’ensemble d’outils Windows Installer XML (WiX) disponible sur [sourceforge.net](https://sourceforge.net/projects/wix) génère des packages d’installation Windows à partir du code source XML.</span><span class="sxs-lookup"><span data-stu-id="868bf-163">The Windows Installer XML (WiX) toolset available on [Sourceforge.net](https://sourceforge.net/projects/wix) builds Windows installation packages from XML source code.</span></span>
-   <span data-ttu-id="868bf-164">La documentation du [Kit de développement logiciel (SDK) Windows Installer](./windows-installer-portal.md) publiée dans la bibliothèque en ligne MSDN est mise à jour le plus fréquemment.</span><span class="sxs-lookup"><span data-stu-id="868bf-164">The documentation in the [Windows Installer SDK](./windows-installer-portal.md) released in the MSDN Online Library is updated the most frequently.</span></span>
-   <span data-ttu-id="868bf-165">Utilisez la version récente de [Msizap.exe](msizap-exe.md) (version 3.1.4000.2726 ou ultérieure) qui est disponible dans les [composants SDK Windows pour les développeurs Windows Installer](platform-sdk-components-for-windows-installer-developers.md) pour Windows Vista ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="868bf-165">Use the recent version of [Msizap.exe](msizap-exe.md) (version 3.1.4000.2726 or greater) that is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) for Windows Vista or greater.</span></span> <span data-ttu-id="868bf-166">Les versions plus petites de Msizap.exe peuvent supprimer des informations sur toutes les mises à jour qui ont été appliquées à d’autres applications sur l’ordinateur de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-166">Lesser versions of Msizap.exe can remove information about all updates that have been applied to other applications on the user's computer.</span></span> <span data-ttu-id="868bf-167">Si ces informations sont supprimées, ces autres applications devront peut-être être supprimées et réinstallées pour recevoir des mises à jour supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="868bf-167">If this information is removed, these other applications may need to be removed and reinstalled to receive additional updates.</span></span>
-   <span data-ttu-id="868bf-168">L’éditeur de table de base de données [Orca.exe](orca-exe.md) est un éditeur de table de base de données pour la création et la modification des packages Windows Installer et des modules de fusion.</span><span class="sxs-lookup"><span data-stu-id="868bf-168">The database table editor [Orca.exe](orca-exe.md) is a database table editor for creating and editing Windows Installer packages and merge modules.</span></span> <span data-ttu-id="868bf-169">Il dispose d’une interface graphique utilisateur de base, mais prend en charge l’édition avancée des bases de données Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-169">It has a basic GUI interface but supports advanced editing of Windows Installer databases.</span></span> <span data-ttu-id="868bf-170">Même si vous utilisez une autre application comme outil de développement principal, vous pouvez utiliser Orca.exe est pratique pour le dépannage et le test d’un package.</span><span class="sxs-lookup"><span data-stu-id="868bf-170">Even if you use another application as your primary development tool, you may find using Orca.exe is convenient when troubleshooting and testing a package.</span></span>
-   <span data-ttu-id="868bf-171">Consultez [les autres sources d’informations de Windows Installer](other-sources-of-windows-installer-information.md) pour obtenir des informations sur les Windows Installer actuelles disponibles dans les blogs, les conversations techniques, les groupes de discussion, les articles techniques et les sites Web.</span><span class="sxs-lookup"><span data-stu-id="868bf-171">See [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md) for current Windows Installer information available in blogs, technical chats, newsgroups, technical articles, and websites.</span></span>

## <a name="if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices"></a><span data-ttu-id="868bf-172">Si vous décidez de reconditionner une application d’installation héritée, suivez les bonnes pratiques en matière de réintégration.</span><span class="sxs-lookup"><span data-stu-id="868bf-172">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>

<span data-ttu-id="868bf-173">De nombreux fournisseurs d’applications fournissent des packages de Windows Installer natifs pour l’installation ou leurs produits.</span><span class="sxs-lookup"><span data-stu-id="868bf-173">Many application vendors provide native Windows Installer packages for the installation or their products.</span></span> <span data-ttu-id="868bf-174">Un logiciel qui convertit une application d’installation existante existante en package Windows Installer est désigné sous le terme de « outil de réintégration ».</span><span class="sxs-lookup"><span data-stu-id="868bf-174">Software that converts an existing legacy setup application into a Windows Installer package is referred to as a repackaging tool.</span></span> <span data-ttu-id="868bf-175">Le guide pas à pas du livre blanc [sur la création de Packages Windows Installer et le logiciel de reconditionnement pour le Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) décrit un outil de réemballage disponible dans le commerce.</span><span class="sxs-lookup"><span data-stu-id="868bf-175">The whitepaper [Step-by-Step Guide to Creating Windows Installer Packages and Repackaging Software for the Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) describes a commercially available repackaging tool.</span></span> <span data-ttu-id="868bf-176">Le reconditionnement d’une application d’installation existante n’est pas la meilleure pratique de développement.</span><span class="sxs-lookup"><span data-stu-id="868bf-176">Repackaging an existing setup application is not the best development practice.</span></span> <span data-ttu-id="868bf-177">Les applications qui ont été conçues à partir du début pour tirer parti des fonctionnalités de Windows Installer peuvent être plus faciles à installer et à traiter.</span><span class="sxs-lookup"><span data-stu-id="868bf-177">Applications that have been designed from the start to take advantage of Windows Installer features can be easier for users to install and service.</span></span> <span data-ttu-id="868bf-178">Si vous décidez d’utiliser un logiciel de empaquetage, les pratiques suivantes peuvent vous aider à créer un package plus Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-178">If you decide to use a repackaging software the following practices can help you produce a better Windows Installer package.</span></span>

-   <span data-ttu-id="868bf-179">Les outils de empaquetage convertissent les installations héritées en un package Windows Installer en utilisant une image d’un système intermédiaire avant et après l’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-179">Repackaging tools convert legacy installations into a Windows Installer package by taking a picture of a staging system before and after installation.</span></span> <span data-ttu-id="868bf-180">Toute modification du Registre, modification de fichier ou paramètre système qui se produit pendant le processus de capture est inclus dans l’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-180">Any registry changes, file changes, or system setting that occurs during the capture process is included in the installation.</span></span> <span data-ttu-id="868bf-181">Configurez le matériel et le logiciel de l’ordinateur utilisé pour reconditionner l’installation aussi près que possible du système de l’utilisateur prévu.</span><span class="sxs-lookup"><span data-stu-id="868bf-181">Configure the hardware and software of the computer used to repackage the installation as close as possible to the intended user's system.</span></span> <span data-ttu-id="868bf-182">Créez un package distinct pour chaque configuration matérielle différente.</span><span class="sxs-lookup"><span data-stu-id="868bf-182">Create a separate package for each different hardware configuration.</span></span> <span data-ttu-id="868bf-183">Repackage à l’aide d’un ordinateur intermédiaire propre.</span><span class="sxs-lookup"><span data-stu-id="868bf-183">Repackage using a clean staging computer.</span></span> <span data-ttu-id="868bf-184">Supprimez toutes les applications inutiles.</span><span class="sxs-lookup"><span data-stu-id="868bf-184">Remove any unnecessary applications.</span></span> <span data-ttu-id="868bf-185">Arrêtez tous les processus inutiles.</span><span class="sxs-lookup"><span data-stu-id="868bf-185">Stop all unnecessary processes.</span></span> <span data-ttu-id="868bf-186">Fermez tous les services système non essentiels.</span><span class="sxs-lookup"><span data-stu-id="868bf-186">Close all non-essential system services.</span></span>
-   <span data-ttu-id="868bf-187">Effectuez toujours une copie de l’installation d’origine avant de commencer à travailler dessus.</span><span class="sxs-lookup"><span data-stu-id="868bf-187">Always make a copy of the original installation before starting to work on it.</span></span> <span data-ttu-id="868bf-188">Travaillez toujours sur la copie.</span><span class="sxs-lookup"><span data-stu-id="868bf-188">Always work on the copy.</span></span> <span data-ttu-id="868bf-189">N’arrêtez jamais un reconditionneur avant de terminer la génération du package.</span><span class="sxs-lookup"><span data-stu-id="868bf-189">Never stop a repackager before it finishes building the package.</span></span> <span data-ttu-id="868bf-190">Si le reconditionneur endommage le package, vous disposez toujours de l’original.</span><span class="sxs-lookup"><span data-stu-id="868bf-190">If the repackager damages the package you will still have the original.</span></span>
-   <span data-ttu-id="868bf-191">Ne reconditionnez pas les mises à jour logicielles Microsoft dans un package Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-191">Do not repackage Microsoft software updates into a Windows Installer package.</span></span> <span data-ttu-id="868bf-192">Microsoft publie les mises à jour logicielles, telles que les service packs, sous la forme de fichiers à extraction automatique qui exécutent automatiquement l’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-192">Microsoft releases software updates, such as service packs, as self-extracting files that automatically runs installation.</span></span> <span data-ttu-id="868bf-193">Ces mises à jour utilisent des programmes d’installation différents de ceux de la Windows Installer pour remplacer les ressources Windows protégées et ne peuvent pas être converties en package Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-193">These updates use different installers than the Windows Installer to replace protected Windows resources and cannot be converted into a Windows Installer package.</span></span> <span data-ttu-id="868bf-194">Pour plus d’informations sur le déploiement des Service Packs Windows, consultez le Guide de déploiement de Service Pack sur [Microsoft TechNet](https://technet.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="868bf-194">For information about how to deploy Windows service packs, see the service pack's deployment guide on [Microsoft TechNet](https://technet.microsoft.com/).</span></span>
-   <span data-ttu-id="868bf-195">N’utilisez pas un outil de empaquetage pour convertir un package Windows Installer en nouveau package.</span><span class="sxs-lookup"><span data-stu-id="868bf-195">Do not use a repackaging tool to convert a Windows Installer package into a new package.</span></span> <span data-ttu-id="868bf-196">Le Windows Installer ajoute des informations de configuration au système ainsi qu’aux ressources de l’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-196">The Windows Installer adds configuration information to the system as well as application resources.</span></span> <span data-ttu-id="868bf-197">Quand un outil de empaquetage compare le système avant et après l’installation, le reconditionneur interprète les informations de configuration dans le cadre de l’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-197">When a repackaging tool compares the system before and after the installation, the repackager misinterprets the configuration information as part of the application.</span></span> <span data-ttu-id="868bf-198">Cela endommage généralement l’application reconditionnée.</span><span class="sxs-lookup"><span data-stu-id="868bf-198">This usually damages the repackaged application.</span></span> <span data-ttu-id="868bf-199">Utilisez plutôt des [transformations de personnalisation](a-customization-transform-example.md) pour modifier un package de Windows Installer existant ou pour créer un nouveau package.</span><span class="sxs-lookup"><span data-stu-id="868bf-199">Instead use [customization transforms](a-customization-transform-example.md) to modify an existing Windows Installer package, or make an new package.</span></span> <span data-ttu-id="868bf-200">Vous pouvez créer des transformations de personnalisation à l’aide de l’outil [Msitran.exe](msitran-exe.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-200">You can create customization transforms using the [Msitran.exe](msitran-exe.md) tool.</span></span>
-   <span data-ttu-id="868bf-201">N’utilisez pas un outil de réintégration pour consolider plusieurs packages de Windows Installer dans un même package.</span><span class="sxs-lookup"><span data-stu-id="868bf-201">Do not use a repackaging tool to consolidate several Windows Installer packages into a single package.</span></span> <span data-ttu-id="868bf-202">Au lieu de cela, vous pouvez utiliser l’outil [Msistuff.exe](msistuff-exe.md) pour configurer le Setup.exe exécutable de démarrage pour installer les packages l’un après l’autre.</span><span class="sxs-lookup"><span data-stu-id="868bf-202">Instead you can use the [Msistuff.exe](msistuff-exe.md) tool to configure the Setup.exe bootstrap executable to install the packages one after another.</span></span>
-   <span data-ttu-id="868bf-203">Créez votre Windows Installer Package afin qu’il puisse être facilement personnalisé par le client.</span><span class="sxs-lookup"><span data-stu-id="868bf-203">Make your Windows Installer package so that it can be easily customized by the customer.</span></span> <span data-ttu-id="868bf-204">Les variables globales utilisées par l’Windows Installer pendant une installation peuvent être définies à l’aide de [Propriétés](properties.md) publiques ou de [transformations de personnalisation](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-204">Global variables used by the Windows Installer during an installation can be set using public [properties](properties.md) or [customization transforms](a-customization-transform-example.md).</span></span> <span data-ttu-id="868bf-205">Fournissez une documentation pour l’utilisation de ces propriétés et des valeurs par défaut pratiques pour toutes les valeurs personnalisables.</span><span class="sxs-lookup"><span data-stu-id="868bf-205">Provide documentation for the use of those properties and practical default values for all customizable values.</span></span> <span data-ttu-id="868bf-206">Pour plus d’informations sur l’obtention et la définition des propriétés, consultez [utilisation des propriétés](using-properties.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-206">For information about getting and setting properties see [Using Properties](using-properties.md).</span></span> <span data-ttu-id="868bf-207">Pour obtenir un exemple de transformation de personnalisation, consultez [un exemple de transformation de personnalisation](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-207">For an example of a customization transform see [A Customization Transform Example](a-customization-transform-example.md).</span></span>

## <a name="do-not-try-to-replace-protected-resources"></a><span data-ttu-id="868bf-208">N’essayez pas de remplacer des ressources protégées.</span><span class="sxs-lookup"><span data-stu-id="868bf-208">Do not try to replace protected resources.</span></span>

<span data-ttu-id="868bf-209">Les packages de Windows Installer ne doivent pas tenter de remplacer les ressources protégées pendant l’installation ou la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="868bf-209">Windows Installer packages should not attempt to replace protected resources during installation or update.</span></span> <span data-ttu-id="868bf-210">Le Windows Installer ne supprime ni ne remplace ces ressources, car Windows empêche le remplacement des fichiers système essentiels, des dossiers et des clés de registre.</span><span class="sxs-lookup"><span data-stu-id="868bf-210">The Windows Installer does not remove or replace these resources because Windows prevents the replacement of essential system files, folders, and registry keys.</span></span> <span data-ttu-id="868bf-211">La protection de ces ressources empêche les défaillances de l’application et du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="868bf-211">Protecting these resources prevents application and operating system failures.</span></span>

-   <span data-ttu-id="868bf-212">En cas d’exécution sur Windows Server 2008 ou Windows Vista, le Windows Installer ignore l’installation d’un fichier ou d’une clé de Registre protégée par [protection des ressources Windows](../wfp/windows-resource-protection-portal.md) (WRP), le programme d’installation entre un avertissement dans le fichier journal et continue avec le reste de l’installation sans erreur.</span><span class="sxs-lookup"><span data-stu-id="868bf-212">When running on Windows Server 2008 or Windows Vista, the Windows Installer skips the installation of any file or registry key that is protected by [Windows Resource Protection](../wfp/windows-resource-protection-portal.md) (WRP), the installer enters a warning in the log file, and continues with the remainder of the installation without an error.</span></span> <span data-ttu-id="868bf-213">Pour plus d’informations, consultez [utilisation de Windows Installer et protection des ressources Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-213">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>
-   <span data-ttu-id="868bf-214">WRP est le nouveau nom de la protection de fichiers Windows (WFP).</span><span class="sxs-lookup"><span data-stu-id="868bf-214">WRP is the new name for Windows File Protection (WFP).</span></span> <span data-ttu-id="868bf-215">WRP protège les clés de Registre et les dossiers, ainsi que les fichiers système essentiels.</span><span class="sxs-lookup"><span data-stu-id="868bf-215">WRP protects registry keys and folders as well as essential system files.</span></span> <span data-ttu-id="868bf-216">Dans Windows Server 2003, Windows XP et Windows 2000, lorsque le Windows Installer a rencontré un fichier protégé par WFP, le programme d’installation demande que WFP installe le fichier.</span><span class="sxs-lookup"><span data-stu-id="868bf-216">In Windows Server 2003, Windows XP, and Windows 2000, when the Windows Installer encountered a WFP-protected file, the installer would request that WFP install the file.</span></span> <span data-ttu-id="868bf-217">Pour plus d’informations, consultez [utilisation de Windows Installer et protection des ressources Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-217">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>

## <a name="do-not-depend-upon-non-critical-resources"></a><span data-ttu-id="868bf-218">Ne dépendez pas de ressources non critiques.</span><span class="sxs-lookup"><span data-stu-id="868bf-218">Do not depend upon non-critical resources.</span></span>

<span data-ttu-id="868bf-219">Votre installation ou mise à jour ne doit pas dépendre de l’installation de ressources non critiques pour les raisons suivantes.</span><span class="sxs-lookup"><span data-stu-id="868bf-219">Your installation or update should not depend upon the installation of non-critical resources for the following reasons.</span></span>

-   <span data-ttu-id="868bf-220">Les actions personnalisées peuvent échouer si elles dépendent d’un composant appartenant à une fonctionnalité que l’utilisateur publie au lieu d’installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-220">Custom actions can fail if they depend upon a component belonging to a feature that the user advertises rather than installs.</span></span>
-   <span data-ttu-id="868bf-221">Les actions personnalisées séquencées avant l’action [InstallFinalize](installfinalize-action.md) peuvent échouer si elles dépendent d’un composant contenant un assembly en cours d’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-221">Custom actions sequenced before the [InstallFinalize](installfinalize-action.md) action can fail if they depend on a component containing an assembly that is being installed.</span></span> <span data-ttu-id="868bf-222">Le Windows Installer ne valide pas les assemblys dans le global assembly cache (GAC) tant que l’action InstallFinalize n’est pas terminée.</span><span class="sxs-lookup"><span data-stu-id="868bf-222">The Windows Installer does not commit assemblies to the Global Assembly Cache (GAC) until the InstallFinalize action completes.</span></span>

## <a name="use-the-api-to-retrieve-windows-installer-configuration-information"></a><span data-ttu-id="868bf-223">Utilisez l’API pour récupérer les informations de configuration de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-223">Use the API to retrieve Windows Installer configuration information.</span></span>

<span data-ttu-id="868bf-224">L’installation de votre application ou mise à jour ne doit pas dépendre d’un accès direct aux informations de configuration Windows Installer enregistrées sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-224">The installation of your application or update should not depend upon direct access to Windows Installer configuration information saved on your computer.</span></span> <span data-ttu-id="868bf-225">Au lieu de cela, utilisez l’interface de programmation d’applications Windows Installer pour récupérer les informations de configuration.</span><span class="sxs-lookup"><span data-stu-id="868bf-225">Instead use the Windows Installer application programming interface to retrieve configuration information.</span></span> <span data-ttu-id="868bf-226">L’emplacement et le format des informations de configuration sont gérés par le service Windows Installer et peuvent être modifiés.</span><span class="sxs-lookup"><span data-stu-id="868bf-226">The location and format of configuration information is managed by the Windows Installer service and can change.</span></span>

-   <span data-ttu-id="868bf-227">Les fonctions d’installation et de configuration de l’API Windows Installer sont décrites dans la [référence des fonctions du programme d’installation](installer-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-227">The Installation and Configuration Functions of the Windows Installer API are described in the [Installer Function Reference](installer-function-reference.md).</span></span>
-   <span data-ttu-id="868bf-228">Les [Propriétés de configuration](property-reference.md) sont décrites dans la référence de propriété.</span><span class="sxs-lookup"><span data-stu-id="868bf-228">The [Configuration Properties](property-reference.md) are described in the Property Reference.</span></span>
-   <span data-ttu-id="868bf-229">Les méthodes et propriétés Automation sont décrites dans la [référence de l’interface Automation](automation-interface-reference.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-229">The automation methods and properties are described in the [Automation Interface Reference](automation-interface-reference.md).</span></span> <span data-ttu-id="868bf-230">L’exemple de script WiLstPrd.vbs se connecte à un objet installer et énumère les produits inscrits et les informations produit.</span><span class="sxs-lookup"><span data-stu-id="868bf-230">The sample script WiLstPrd.vbs connects to an Installer object and enumerates registered products and product information.</span></span> <span data-ttu-id="868bf-231">Pour plus d’informations, consultez [répertorier les produits, les propriétés, les fonctionnalités et les composants](list-products-properties-features-and-components.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-231">For information see [List Products, Properties, Features, and Components](list-products-properties-features-and-components.md).</span></span>

## <a name="organize-the-installation-of-your-application-around-components"></a><span data-ttu-id="868bf-232">Organisez l’installation de votre application autour des composants.</span><span class="sxs-lookup"><span data-stu-id="868bf-232">Organize the installation of your application around components.</span></span>

<span data-ttu-id="868bf-233">Le service Windows Installer installe ou supprime les collections de ressources appelées [composants](windows-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-233">The Windows Installer service installs or removes collections of resources referred to as [components](windows-installer-components.md).</span></span> <span data-ttu-id="868bf-234">Étant donné que les composants sont généralement partagés, l’auteur d’un package d’installation doit suivre les règles lors de la spécification des composants d’une fonctionnalité ou d’une application.</span><span class="sxs-lookup"><span data-stu-id="868bf-234">Because components are commonly shared, the author of an installation package must follow rules when specifying the components of a feature or application.</span></span>

-   <span data-ttu-id="868bf-235">Respectez les règles des composants lors de l' [Organisation des applications en composants](organizing-applications-into-components.md) pour vous assurer que les nouveaux composants ou les nouvelles versions des composants puissent être installés et supprimés sans endommager d’autres applications.</span><span class="sxs-lookup"><span data-stu-id="868bf-235">Adhere to the component rules when [Organizing Applications into Components](organizing-applications-into-components.md) to ensure that new components, or new versions of components, can be installed and removed without damaging other applications.</span></span> <span data-ttu-id="868bf-236">Vous pouvez suivre la procédure décrite dans [définition des composants du programme d’installation](defining-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-236">You can follow the procedure described in [Defining Installer Components](defining-installer-components.md).</span></span>
-   <span data-ttu-id="868bf-237">Le programme d’installation effectue le suivi de chaque composant par le GUID d’ID de composant respectif spécifié dans la [table des composants](component-table.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-237">The installer tracks every component by the respective component ID GUID specified in the [Component table](component-table.md).</span></span> <span data-ttu-id="868bf-238">Il est essentiel pour le fonctionnement du mécanisme de décompte de références Windows Installer que le GUID de l’ID du composant est correct.</span><span class="sxs-lookup"><span data-stu-id="868bf-238">It is essential for the operation of the Windows Installer reference-counting mechanism that the component ID GUID is correct.</span></span> <span data-ttu-id="868bf-239">Suivez les instructions dans [modification du code du composant](changing-the-component-code.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-239">Follow the guidelines in [Changing the Component Code](changing-the-component-code.md).</span></span>
-   <span data-ttu-id="868bf-240">Si votre package doit rompre les règles du composant, tenez compte des conséquences possibles et assurez-vous que votre installation n’installe jamais ces composants lorsqu’ils peuvent endommager les composants sur le système de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-240">If your package must break the component rules, be aware of the possible consequences and ensure that your installation never installs these components where they may damage components on the user's system.</span></span> <span data-ttu-id="868bf-241">Pour plus d’informations, consultez [que se passe-t-il si les règles des composants sont rompues ?](what-happens-if-the-component-rules-are-broken.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-241">For information see [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md).</span></span>
-   <span data-ttu-id="868bf-242">N’oubliez pas que la Windows Installer applique les règles de contrôle de [version](file-versioning-rules.md) des fichiers lors du [remplacement de fichiers existants](replacing-existing-files.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-242">Be aware how the Windows Installer applies the [File Versioning Rules](file-versioning-rules.md) when [Replacing Existing Files](replacing-existing-files.md).</span></span> <span data-ttu-id="868bf-243">Le Windows Installer détermine d’abord si le fichier de clé du composant est déjà installé avant de tenter d’installer les fichiers du composant.</span><span class="sxs-lookup"><span data-stu-id="868bf-243">The Windows Installer first determines whether the component's key file is already installed before attempting to install any of the files of the component.</span></span> <span data-ttu-id="868bf-244">Si le programme d’installation trouve un fichier portant le même nom que le fichier de clé du composant installé à l’emplacement cible, il compare la version, la date et la langue des deux fichiers de clé et utilise des règles de contrôle de version de fichier pour déterminer s’il faut installer le composant fourni par le package.</span><span class="sxs-lookup"><span data-stu-id="868bf-244">If the installer finds a file with the same name as the component's key file installed in the target location, it compares the version, date, and language of the two key files and uses file versioning rules to determine whether to install the component provided by the package.</span></span> <span data-ttu-id="868bf-245">Si le programme d’installation détermine qu’il doit remplacer la base de composants sur le fichier de clé, il utilise les règles de contrôle de version de fichier sur chaque fichier installé pour déterminer s’il faut remplacer le fichier.</span><span class="sxs-lookup"><span data-stu-id="868bf-245">If the installer determines it needs to replace the component base upon the key file, then it uses the file versioning rules on each installed file to determine whether to replace the file.</span></span>

## <a name="reduce-the-size-of-large-windows-installer-packages"></a><span data-ttu-id="868bf-246">Réduisez la taille des packages de Windows Installer volumineux.</span><span class="sxs-lookup"><span data-stu-id="868bf-246">Reduce the size of large Windows Installer packages.</span></span>

<span data-ttu-id="868bf-247">Les packages Windows de très grande taille prennent des ressources système et peuvent être difficiles à installer par les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="868bf-247">Very large Windows Packages take system resources and can be difficult for users to install.</span></span> <span data-ttu-id="868bf-248">Il est conseillé de réduire la taille des packages de Windows Installer très volumineux à l’aide des méthodes suivantes.</span><span class="sxs-lookup"><span data-stu-id="868bf-248">It is good practice to reduce the size of very large Windows Installer Packages by the following methods.</span></span>

-   <span data-ttu-id="868bf-249">Compressez les fichiers dans l’installation et stockez-les dans un fichier cabinet (. cab).</span><span class="sxs-lookup"><span data-stu-id="868bf-249">Compress the files in the installation and store them in a cabinet (.cab) file .</span></span> <span data-ttu-id="868bf-250">Le programme d’installation permet au fichier. cab d’être stocké en tant que fichier externe distinct, ou en tant que flux de données dans le package MSI lui-même.</span><span class="sxs-lookup"><span data-stu-id="868bf-250">The Installer allows the .cab file to be stored as a separate external file, or as a data stream in the MSI package itself.</span></span> <span data-ttu-id="868bf-251">Pour plus d’informations [, consultez Utilisation d’armoires et de sources compressées](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-251">For information see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>
-   <span data-ttu-id="868bf-252">Supprimez l’espace de stockage gaspillé dans le fichier. msi à l’aide de l’une des options décrites dans [réduction de la taille d’un fichier. msi](reducing-the-size-of-an--msi-file.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-252">Remove wasted storage space in the .msi file using one of the options discussed in [Reducing the Size of an .msi File](reducing-the-size-of-an--msi-file.md).</span></span>
-   <span data-ttu-id="868bf-253">Si votre package Windows Installer contient plus de 32767 fichiers, vous devez modifier le schéma de la base de données.</span><span class="sxs-lookup"><span data-stu-id="868bf-253">If your Windows Installer package contains more than 32767 files, you must change the schema of the database.</span></span> <span data-ttu-id="868bf-254">Pour plus d’informations, consultez [création d’un package volumineux](authoring-a-large-package.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-254">For information see [Authoring a Large Package](authoring-a-large-package.md).</span></span>

## <a name="if-you-use-custom-actions-follow-good-custom-action-practices"></a><span data-ttu-id="868bf-255">Si vous utilisez des actions personnalisées, suivez les bonnes pratiques d’action personnalisées.</span><span class="sxs-lookup"><span data-stu-id="868bf-255">If you use custom actions, follow good custom action practices.</span></span>

<span data-ttu-id="868bf-256">Le Windows Installer possède de nombreuses [actions standard](standard-actions-reference.md) intégrées pour l’installation et la maintenance des applications.</span><span class="sxs-lookup"><span data-stu-id="868bf-256">The Windows Installer has many built-in [standard actions](standard-actions-reference.md) for the installation and maintenance of applications.</span></span> <span data-ttu-id="868bf-257">Les développeurs doivent tenter de s’appuyer sur les actions standard aussi bien que possible, au lieu de créer leurs propres [actions personnalisées](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-257">Developers should attempt to rely upon the standard actions as much as practical, rather than create their own [custom actions](custom-actions.md).</span></span> <span data-ttu-id="868bf-258">Toutefois, il existe des situations où le développeur d’un package d’installation trouve qu’il est nécessaire d’écrire une action personnalisée.</span><span class="sxs-lookup"><span data-stu-id="868bf-258">However, there are situations where the developer of an installation package finds it necessary to write a custom action.</span></span>

-   <span data-ttu-id="868bf-259">Suivez les instructions relatives [à l’utilisation des actions personnalisées](using-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-259">Follow the guidelines for [Using Custom Actions](using-custom-actions.md).</span></span>
-   <span data-ttu-id="868bf-260">Suivez les [instructions relatives à la sécurisation des actions personnalisées](guidelines-for-securing-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-260">Follow the [Guidelines for Securing Custom Actions](guidelines-for-securing-custom-actions.md).</span></span> <span data-ttu-id="868bf-261">Les actions personnalisées qui utilisent des informations sensibles ne doivent pas écrire ces informations dans le journal.</span><span class="sxs-lookup"><span data-stu-id="868bf-261">Custom actions that use sensitive information should not write this information into the log.</span></span> <span data-ttu-id="868bf-262">Pour plus d’informations, consultez [sécurité des actions personnalisées](custom-action-security.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-262">For information see [Custom Action Security](custom-action-security.md).</span></span>
-   <span data-ttu-id="868bf-263">Les actions personnalisées ne doivent pas tenter de définir un point d’entrée de restauration du système à partir d’une action personnalisée.</span><span class="sxs-lookup"><span data-stu-id="868bf-263">Custom Actions must not attempt to set a System Restore entry point from within a custom action.</span></span> <span data-ttu-id="868bf-264">Pour plus d’informations, consultez [définition d’un point de restauration à partir d’une action personnalisée](setting-a-restore-point-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-264">For information see [Setting a restore point from a Custom Action](setting-a-restore-point-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="868bf-265">Retourner des messages d’erreur à partir d’actions personnalisées et les écrire dans le journal pour faciliter le dépannage des actions personnalisées.</span><span class="sxs-lookup"><span data-stu-id="868bf-265">Return error messages from custom actions and write them to the log to facilitate troubleshooting custom actions.</span></span> <span data-ttu-id="868bf-266">Pour plus d’informations, consultez [messages d’erreur-actions personnalisées](error-message-custom-actions.md) et [retour de messages d’erreur à partir d’actions personnalisées](returning-error-messages-from-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-266">For information see [Error Message Custom Actions](error-message-custom-actions.md) and [Returning Error Messages from Custom Actions](returning-error-messages-from-custom-actions.md).</span></span>
-   <span data-ttu-id="868bf-267">Ne modifiez pas l’état du système à partir d’une action personnalisée immédiate.</span><span class="sxs-lookup"><span data-stu-id="868bf-267">Do not change the system state from an immediate custom action.</span></span> <span data-ttu-id="868bf-268">Les actions personnalisées qui modifient directement le système ou appellent un autre service système doivent être différées à l’heure d’exécution du script d’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-268">Custom actions that change the system directly or call another system service must be deferred to the time when the installation script is executed.</span></span> <span data-ttu-id="868bf-269">Chaque [action personnalisée d’exécution différée](deferred-execution-custom-actions.md) qui modifie l’état du système doit être précédée d’une [action de restauration personnalisée](rollback-custom-actions.md) pour annuler la modification de l’état du système lors d’une restauration de l’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-269">Every [deferred execution custom action](deferred-execution-custom-actions.md) that changes the system state must be preceded by a [rollback custom action](rollback-custom-actions.md) to undo the system state change on an installation rollback.</span></span> <span data-ttu-id="868bf-270">Pour plus d’informations, consultez [modification de l’état du système à l’aide d’une action personnalisée](changing-the-system-state-using-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-270">For information see [Changing the System State Using a Custom Action](changing-the-system-state-using-a-custom-action.md).</span></span>
-   <span data-ttu-id="868bf-271">Les actions personnalisées qui effectuent des opérations d’installation complexes doivent être un [fichier exécutable](executable-files.md) ou une [bibliothèque de liens dynamiques](dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-271">Custom actions that perform complex installation operations should be an [executable file](executable-files.md) or [dynamic-link library](dynamic-link-libraries.md).</span></span> <span data-ttu-id="868bf-272">Limitez l’utilisation d’actions personnalisées basées sur des [scripts](scripts.md) pour des opérations d’installation simples.</span><span class="sxs-lookup"><span data-stu-id="868bf-272">Limit the use of custom actions based on [scripts](scripts.md) to simple installation operations.</span></span>
-   <span data-ttu-id="868bf-273">Rendez les détails de votre action personnalisée au système facilement détectable par les administrateurs système.</span><span class="sxs-lookup"><span data-stu-id="868bf-273">Make the details of what your custom action does to the system easily discoverable to system administrators.</span></span> <span data-ttu-id="868bf-274">Placez dans une table personnalisée les détails des entrées de Registre et des fichiers utilisés par votre action personnalisée et faites en sorte que l’action personnalisée soit lue à partir de cette table.</span><span class="sxs-lookup"><span data-stu-id="868bf-274">Put the details of registry entries and files used by your custom action into a custom table and have the custom action read from this table.</span></span> <span data-ttu-id="868bf-275">Cela est illustré par l’exemple de [l’utilisation d’une action personnalisée pour créer des comptes d’utilisateur sur un ordinateur local](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-275">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span> <span data-ttu-id="868bf-276">Pour plus d’informations sur l’ajout de tables personnalisées à une base de données, consultez [utilisation de requêtes](working-with-queries.md) et [d’exemples de requêtes de base de données avec SQL et script](examples-of-database-queries-using-sql-and-script.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-276">For information on adding custom tables to a database, see [Working with Queries](working-with-queries.md) and [Examples of Database Queries Using SQL and Script](examples-of-database-queries-using-sql-and-script.md).</span></span>
-   <span data-ttu-id="868bf-277">Les actions personnalisées ne doivent pas afficher une boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="868bf-277">A custom actions should not display a dialog box.</span></span> <span data-ttu-id="868bf-278">Les actions personnalisées nécessitant une interface utilisateur peuvent utiliser la fonction [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) à la place.</span><span class="sxs-lookup"><span data-stu-id="868bf-278">Custom actions requiring a user interface can use the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function instead.</span></span> <span data-ttu-id="868bf-279">Consultez [envoi de messages à Windows Installer à l’aide de MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-279">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>
-   <span data-ttu-id="868bf-280">Les actions personnalisées ne doivent pas utiliser les fonctions listées sur la page : les [fonctions ne sont pas utilisables dans les actions personnalisées](functions-not-for-use-in-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-280">Custom actions must not use any of the functions listed on the page: [Functions Not for Use in Custom Actions](functions-not-for-use-in-custom-actions.md).</span></span>
-   <span data-ttu-id="868bf-281">Si l’installation est destinée à s’exécuter sur un serveur Terminal Server, vérifiez que toutes vos actions personnalisées sont susceptibles d’être exécutées sur un serveur Terminal Server.</span><span class="sxs-lookup"><span data-stu-id="868bf-281">If the installation is intended to run on a terminal server, test that all your custom actions are capable of running on a terminal server.</span></span> <span data-ttu-id="868bf-282">Pour plus d’informations, consultez propriété [**TerminalServer**](terminalserver.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-282">For more information see [**TerminalServer**](terminalserver.md) property.</span></span>
-   <span data-ttu-id="868bf-283">Pour qu’une action personnalisée s’exécute lors de la désinstallation d’un correctif particulier, l’action personnalisée doit être présente dans l’application d’origine ou être dans un correctif pour le produit qui est toujours appliqué.</span><span class="sxs-lookup"><span data-stu-id="868bf-283">To have a custom action run when a particular patch is uninstalled the custom action must either be present in the original application or be in a patch for the product that is always applied.</span></span> <span data-ttu-id="868bf-284">Pour plus d’informations, consultez [désinstallation des actions personnalisées](patch-uninstall-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-284">For more information see [Patch Uninstall Custom Actions](patch-uninstall-custom-actions.md).</span></span>
-   <span data-ttu-id="868bf-285">Les actions personnalisées ne doivent pas utiliser le niveau d’interface utilisateur comme condition pour envoyer des messages d’erreur au programme d’installation, car cela peut interférer avec la journalisation et les messages externes.</span><span class="sxs-lookup"><span data-stu-id="868bf-285">Custom actions should not use the UI level as a condition for sending error messages to the installer because this can interfere with logging and external messages.</span></span> <span data-ttu-id="868bf-286">Pour plus d’informations, consultez [détermination du niveau d’interface utilisateur à partir d’une action personnalisée](determining-ui-level-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-286">For information see [Determining UI Level from a Custom Action](determining-ui-level-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="868bf-287">Utilisez des instructions conditionnelles et une [syntaxe d’instruction conditionnelle](conditional-statement-syntax.md) pour vous assurer que votre package exécute correctement des actions personnalisées, qu’il n’exécute pas d’actions personnalisées ou qu’il exécute une autre action personnalisée lors de la désinstallation du package.</span><span class="sxs-lookup"><span data-stu-id="868bf-287">Use conditional statements and [Conditional Statement Syntax](conditional-statement-syntax.md) to ensure that your package correctly runs custom actions, does not run a custom actions, or runs alternate custom action when the package is uninstalled.</span></span> <span data-ttu-id="868bf-288">Vérifiez que le package fonctionne comme prévu lors de la [désinstallation des actions personnalisées](uninstalling-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-288">Test that the package works as expected when [uninstalling custom actions](uninstalling-custom-actions.md).</span></span> <span data-ttu-id="868bf-289">Pour plus d’informations, consultez [conditionnement des actions à exécuter pendant la suppression](conditioning-actions-to-run-during-removal.md)</span><span class="sxs-lookup"><span data-stu-id="868bf-289">For information see [Conditioning Actions to Run During Removal](conditioning-actions-to-run-during-removal.md)</span></span>
-   <span data-ttu-id="868bf-290">Si l’installation doit pouvoir être exécutée par des utilisateurs qui ne disposent pas de privilèges d’administrateur, effectuez un test pour vérifier que toutes les actions personnalisées peuvent être exécutées avec des privilèges non-administrateurs.</span><span class="sxs-lookup"><span data-stu-id="868bf-290">If the installation must be capable of being run by users that do not have administrator privileges, test to ensure that all the custom actions can be run with non-administrator privileges.</span></span> <span data-ttu-id="868bf-291">Les actions personnalisées requièrent des privilèges élevés pour modifier les parties du système qui ne sont pas spécifiques à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-291">Custom actions require elevated privileges to modify parts of the system that are not user specific.</span></span> <span data-ttu-id="868bf-292">Le programme d’installation peut exécuter des actions personnalisées avec des privilèges élevés si une application managée est en cours d’installation ou si la stratégie système a été spécifiée pour des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="868bf-292">The installer may run custom actions with elevated privileges if a managed application is being installed or if the system policy has been specified for elevated privileges.</span></span> <span data-ttu-id="868bf-293">Toutes les actions personnalisées nécessitant des privilèges élevés doivent inclure l' [action personnalisée](custom-action-in-script-execution-options.md) MsidbCustomActionTypeInScript et msidbCustomActionTypeNoImpersonate In-Script les options d’exécution dans le type d’action personnalisé.</span><span class="sxs-lookup"><span data-stu-id="868bf-293">Any custom actions the require elevated privileges must include the msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate [Custom Action In-Script Execution Options](custom-action-in-script-execution-options.md) in the custom action type.</span></span> <span data-ttu-id="868bf-294">Cela est illustré par l’exemple de [l’utilisation d’une action personnalisée pour créer des comptes d’utilisateur sur un ordinateur local](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-294">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span>

## <a name="if-you-use-assemblies-follow-good-assembly-practices"></a><span data-ttu-id="868bf-295">Si vous utilisez des assemblys, suivez les bonnes pratiques d’assembly</span><span class="sxs-lookup"><span data-stu-id="868bf-295">If you use assemblies, follow good assembly practices</span></span>

<span data-ttu-id="868bf-296">Si votre package utilise des [assemblys](assemblies.md)logiciels, suivez les instructions relatives à l' [Ajout d’assemblys à un package](adding-assemblies-to-a-package.md), à la [mise à jour des assemblys](updating-assemblies.md)et à [l’installation et](installing-and-removing-assemblies.md)à la suppression d’assemblys.</span><span class="sxs-lookup"><span data-stu-id="868bf-296">If your package uses software [assemblies](assemblies.md), follow the guidelines for [Adding Assemblies to a Package](adding-assemblies-to-a-package.md), [Updating Assemblies](updating-assemblies.md), and [Installing and Removing Assemblies](installing-and-removing-assemblies.md).</span></span>

## <a name="do-not-ship-concurrent-installations"></a><span data-ttu-id="868bf-297">N’expédiez pas d’installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="868bf-297">Do not ship concurrent installations.</span></span>

<span data-ttu-id="868bf-298">Les [installations simultanées](concurrent-installations.md), également appelées installations imbriquées, installent un autre Windows Installer Package lors d’une installation en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="868bf-298">[Concurrent Installations](concurrent-installations.md), also called Nested Installations, install another Windows Installer package during a currently running installation.</span></span> <span data-ttu-id="868bf-299">L’utilisation d’installations simultanées n’est pas une bonne pratique, car elles sont difficiles à traiter par les clients.</span><span class="sxs-lookup"><span data-stu-id="868bf-299">The use of concurrent installations is not a good practice because they are difficult for customers to service.</span></span> <span data-ttu-id="868bf-300">L’application de correctifs et la mise à niveau peuvent ne pas fonctionner avec des installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="868bf-300">Patching and upgrading may not work with concurrent installations.</span></span> <span data-ttu-id="868bf-301">L’alternative recommandée à l’utilisation des installations simultanées consiste à utiliser à la place une application d’installation et un gestionnaire d’interface utilisateur externe pour installer plusieurs packages de Windows Installer de manière séquentielle.</span><span class="sxs-lookup"><span data-stu-id="868bf-301">The recommended alternative to using concurrent installations is to instead use a setup application and external UI handler to install several Windows Installer packages sequentially.</span></span>

<span data-ttu-id="868bf-302">Pour plus d’informations sur l’utilisation d’un gestionnaire d’interface utilisateur externe, consultez [surveillance d’une installation à l’aide de MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-302">For more information about using an external UI handler see [Monitoring an Installation Using MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span></span> <span data-ttu-id="868bf-303">Pour plus d’informations sur l’utilisation d’un gestionnaire externe basé sur les enregistrements, consultez [surveillance d’une installation à l’aide de MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-303">For more information about using a record-based external handler, see [Monitoring an Installation Using MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span></span>

<span data-ttu-id="868bf-304">Les installations simultanées sont parfois utilisées dans des environnements d’entreprise contrôlés pour installer des applications qui ne sont pas destinées au public.</span><span class="sxs-lookup"><span data-stu-id="868bf-304">Concurrent installations are sometimes used in controlled corporate environments to install applications that are not intended for the public.</span></span> <span data-ttu-id="868bf-305">Suivez ces instructions si vous décidez d’utiliser des installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="868bf-305">Follow these guidelines if you decide to use concurrent installations.</span></span>

-   <span data-ttu-id="868bf-306">N’utilisez pas d’installations simultanées pour installer ou mettre à jour un produit d’expédition.</span><span class="sxs-lookup"><span data-stu-id="868bf-306">Do not use concurrent installations to install or update a shipping product.</span></span>
-   <span data-ttu-id="868bf-307">Les installations simultanées ne doivent pas partager de composants.</span><span class="sxs-lookup"><span data-stu-id="868bf-307">Concurrent installations should not share components.</span></span>
-   <span data-ttu-id="868bf-308">Une installation d’administration ne doit pas contenir d’installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="868bf-308">An administrative installation should not contain a concurrent installation.</span></span>
-   <span data-ttu-id="868bf-309">Le ProgressBars intégré ne doit pas être utilisé avec des installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="868bf-309">Integrated ProgressBars should not be used with concurrent installations.</span></span>
-   <span data-ttu-id="868bf-310">Les ressources qui doivent être publiées ne doivent pas être installées par une installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="868bf-310">Resources that are to be advertised should not be installed by a concurrent installation.</span></span>
-   <span data-ttu-id="868bf-311">Un package qui effectue une installation simultanée d’une application doit également désinstaller l’application simultanée lorsque le produit parent est désinstallé.</span><span class="sxs-lookup"><span data-stu-id="868bf-311">A package that performs a concurrent installation of an application should also uninstall the concurrent application when the parent product is uninstalled.</span></span> <span data-ttu-id="868bf-312">Une installation imbriquée existe dans le contexte du produit parent dans Ajout/suppression de programmes dans le panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="868bf-312">A nested installation exists under the context of the parent product in the Add/Remove Programs in Control Panel.</span></span>

## <a name="keep-package-names-and-package-codes-consistent"></a><span data-ttu-id="868bf-313">Assurez la cohérence des noms de packages et des codes de package.</span><span class="sxs-lookup"><span data-stu-id="868bf-313">Keep package names and package codes consistent.</span></span>

<span data-ttu-id="868bf-314">Le fichier. msi peut recevoir n’importe quel nom permettant aux utilisateurs d’identifier le package, mais le nom ne doit pas être modifié sans modifier également le code du produit.</span><span class="sxs-lookup"><span data-stu-id="868bf-314">The .msi file can be given any name that helps users identify the package, but the name should not be changed without also changing the product code.</span></span>

-   <span data-ttu-id="868bf-315">Donnez à votre fichier. msi un nom convivial qui permet à l’utilisateur d’identifier le contenu du package de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-315">Give your .msi file a user-friendly name that enables the user to identify the contents of the Windows Installer package.</span></span>
-   <span data-ttu-id="868bf-316">Le [Code du produit](product-codes.md) est l’identification principale d’une application et doit changer chaque fois qu’il existe une mise à jour complète de l’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-316">The [product code](product-codes.md) is the principal identification of an application and must change whenever there is a comprehensive update to the application.</span></span> <span data-ttu-id="868bf-317">Pour plus d’informations, consultez [**ProductCode**](productcode.md) et [modification du code du produit](changing-the-product-code.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-317">For information, see [**ProductCode**](productcode.md) and [Changing the Product Code](changing-the-product-code.md).</span></span> <span data-ttu-id="868bf-318">La modification du nom du fichier. msi de l’application est considérée comme une modification complète et requiert toujours une modification correspondante du code du produit pour maintenir la cohérence.</span><span class="sxs-lookup"><span data-stu-id="868bf-318">Changing the name of the application's .msi file is considered a comprehensive change and always requires a corresponding change of the product code to maintain consistency.</span></span>
-   <span data-ttu-id="868bf-319">Le [Code du package](package-codes.md) est l’identificateur principal utilisé par le programme d’installation pour rechercher et valider le package approprié pour une installation donnée.</span><span class="sxs-lookup"><span data-stu-id="868bf-319">The [package code](package-codes.md) is the primary identifier used by the installer to search for and validate the correct package for a given installation.</span></span> <span data-ttu-id="868bf-320">Deux fichiers. msi non identiques ne doivent jamais avoir le même code de package.</span><span class="sxs-lookup"><span data-stu-id="868bf-320">No two nonidentical .msi files should ever have the same package code.</span></span> <span data-ttu-id="868bf-321">Si un package est modifié sans modifier le code du package, le programme d’installation peut ne pas utiliser le package le plus récent si les deux sont toujours accessibles au programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-321">If a package is changed without changing the package code, the installer may not use the newer package if both are still accessible to the installer.</span></span> <span data-ttu-id="868bf-322">Le code du package est stocké dans la propriété [**Résumé du numéro de révision**](revision-number-summary.md) du flux d’informations de [synthèse](summary-information-stream.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-322">The package code is stored in the [**Revision Number Summary**](revision-number-summary.md) Property of the [Summary Information Stream](summary-information-stream.md).</span></span>
-   <span data-ttu-id="868bf-323">Notez que les lettres du code du produit et des [GUID](guid.md) du code du package doivent toutes être en majuscules.</span><span class="sxs-lookup"><span data-stu-id="868bf-323">Note that letters in product code and package code [GUIDs](guid.md) must all be uppercase.</span></span>

## <a name="do-not-use-the-selfreg-and-typelib-tables"></a><span data-ttu-id="868bf-324">N’utilisez pas les tables SelfReg et TypeLib.</span><span class="sxs-lookup"><span data-stu-id="868bf-324">Do not use the SelfReg and TypeLib tables.</span></span>

-   <span data-ttu-id="868bf-325">Les auteurs de packages d’installation sont fortement recommandés pour utiliser l’inscription automatique et la table [Selfreg](selfreg-table.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-325">Installation package authors are strongly advised against using self registration and the [SelfReg](selfreg-table.md) table.</span></span> <span data-ttu-id="868bf-326">Au lieu de cela, ils doivent inscrire des modules en créant une ou plusieurs tables dans le [groupe tables du Registre](registry-tables-group.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-326">Instead they should register modules by authoring one or more of the tables in the [Registry Tables Group](registry-tables-group.md).</span></span> <span data-ttu-id="868bf-327">La plupart des avantages de la Windows Installer sont perdus avec l’inscription automatique, car les routines d’auto-inscription ont tendance à masquer les informations de configuration critiques.</span><span class="sxs-lookup"><span data-stu-id="868bf-327">Many of the benefits of the Windows Installer are lost with self registration because self-registration routines tend to hide critical configuration information.</span></span> <span data-ttu-id="868bf-328">Pour obtenir la liste des raisons pour lesquelles éviter l’auto-enregistrement, consultez la [table Selfreg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-328">For a list of the reasons for avoiding self registration see [SelfReg table](selfreg-table.md).</span></span>
-   <span data-ttu-id="868bf-329">Les auteurs de packages d’installation sont fortement recommandés par rapport à l’utilisation de la table [TypeLib](typelib-table.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-329">Installation package authors are strongly advised against using the [TypeLib](typelib-table.md) table.</span></span> <span data-ttu-id="868bf-330">Au lieu d’utiliser la table TypeLib, inscrivez les bibliothèques de types à l’aide de la table [Registry](registry-table.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-330">Instead of using the TypeLib table, register type libraries by using [Registry](registry-table.md) table.</span></span> <span data-ttu-id="868bf-331">Si une installation qui utilise la table TypeLib échoue et doit être restaurée, la restauration peut ne pas restaurer l’état de l’ordinateur qui existait avant la restauration.</span><span class="sxs-lookup"><span data-stu-id="868bf-331">If an installation using the TypeLib table fails and must be rolled back, the rollback may not restore the computer to the same state that existed prior to the rollback.</span></span>

## <a name="provide-the-option-to-install-without-a-user-interface"></a><span data-ttu-id="868bf-332">Fournissez l’option d’installation sans interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-332">Provide the option to install without a user interface.</span></span>

<span data-ttu-id="868bf-333">Les administrateurs préfèrent souvent déployer des applications au sein d’une entreprise sans intervention de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-333">Administrators often prefer to deploy applications within a corporation without requiring user interaction.</span></span> <span data-ttu-id="868bf-334">Il est recommandé de permettre à votre application de fournir la possibilité d’être installée avec le [niveau d’interface utilisateur](user-interface-levels.md) aucun.</span><span class="sxs-lookup"><span data-stu-id="868bf-334">It is good practice to enable your application to provide the option of being installed with the [user interface level](user-interface-levels.md) of None.</span></span>

-   <span data-ttu-id="868bf-335">Utilisez les [propriétés publiques](public-properties.md) pour les informations de configuration.</span><span class="sxs-lookup"><span data-stu-id="868bf-335">Use [public properties](public-properties.md) for configuration information.</span></span> <span data-ttu-id="868bf-336">Les administrateurs peuvent fournir ces informations sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="868bf-336">Administrators can provide this information on the command-line.</span></span>
-   <span data-ttu-id="868bf-337">Ne pas exiger que l’installation dépende des informations collectées à partir de l’interaction de l’utilisateur avec les boîtes de dialogue.</span><span class="sxs-lookup"><span data-stu-id="868bf-337">Do not require that the installation depend upon information gathered from user interaction with dialog boxes.</span></span> <span data-ttu-id="868bf-338">Ces informations ne sont pas disponibles au cours d’une installation sans assistance.</span><span class="sxs-lookup"><span data-stu-id="868bf-338">This information is not available during a silent installation.</span></span>
-   <span data-ttu-id="868bf-339">Ne redémarrez pas automatiquement l’ordinateur de l’utilisateur au cours d’une installation sans assistance.</span><span class="sxs-lookup"><span data-stu-id="868bf-339">Do not automatically restart the user's computer during a silent installation.</span></span>
-   <span data-ttu-id="868bf-340">Les administrateurs peuvent définir le niveau de l' [interface utilisateur](user-interface-levels.md) lors de l’installation à l’aide de l' [option de ligne de commande](command-line-options.md) « /q ».</span><span class="sxs-lookup"><span data-stu-id="868bf-340">Administrators can set the [user interface level](user-interface-levels.md) when installing by using the [command line option](command-line-options.md) "/q".</span></span> <span data-ttu-id="868bf-341">Le niveau de l’interface utilisateur peut également être défini par programme avec un appel à [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span><span class="sxs-lookup"><span data-stu-id="868bf-341">The user interface level can also be set programmatically with a call to [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span></span>

## <a name="avoid-using-the-alwaysinstallelevated-policy"></a><span data-ttu-id="868bf-342">Évitez d’utiliser la stratégie AlwaysInstallElevated a.</span><span class="sxs-lookup"><span data-stu-id="868bf-342">Avoid using the AlwaysInstallElevated policy.</span></span>

<span data-ttu-id="868bf-343">Si la stratégie [AlwaysInstallElevated a](alwaysinstallelevated.md) n’est pas définie, les applications non distribuées par l’administrateur sont installées à l’aide des privilèges de l’utilisateur et seules les applications gérées obtiennent des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="868bf-343">If the [AlwaysInstallElevated](alwaysinstallelevated.md) policy is not set, applications not distributed by the administrator are installed using the user's privileges and only managed applications get elevated privileges.</span></span> <span data-ttu-id="868bf-344">La définition de cette stratégie indique à Windows Installer d’utiliser des autorisations système lors de l’installation de l’application sur le système.</span><span class="sxs-lookup"><span data-stu-id="868bf-344">Setting this policy directs Windows Installer to use system permissions when it installs the application on the system.</span></span> <span data-ttu-id="868bf-345">Cette méthode peut ouvrir un ordinateur à un risque de sécurité, car lorsque cette stratégie est définie, un utilisateur non-administrateur peut exécuter des installations avec des privilèges [*élevés*](e-gly.md) et accéder à des emplacements sécurisés sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-345">This method can open a computer to a security risk, because when this policy is set, a non-administrator user can run installations with [*elevated*](e-gly.md) privileges and access secure locations on the computer.</span></span> <span data-ttu-id="868bf-346">Il est recommandé d’utiliser une autre méthode que la stratégie AlwaysInstallElevated a lors de l' [installation d’un package avec des privilèges élevés pour une application non-administrateur ou une](installing-a-package-with-elevated-privileges-for-a-non-admin.md) mise à [jour corrective d’Applications gérées Per-User](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-346">It is a good practice to use another method than the AlwaysInstallElevated policy when [Installing a Package with Elevated Privileges for a Non-Admin](installing-a-package-with-elevated-privileges-for-a-non-admin.md) or [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

## <a name="enable-the-disablemedia-policy-to-limit-unauthorized-installation"></a><span data-ttu-id="868bf-347">Activez la stratégie DisableMedia pour limiter l’installation non autorisée.</span><span class="sxs-lookup"><span data-stu-id="868bf-347">Enable the DisableMedia policy to limit unauthorized installation.</span></span>

<span data-ttu-id="868bf-348">La stratégie [DisableMedia](disablemedia.md) peut empêcher l’installation non autorisée d’applications.</span><span class="sxs-lookup"><span data-stu-id="868bf-348">The [DisableMedia](disablemedia.md) policy can prevent unauthorized installation of applications.</span></span> <span data-ttu-id="868bf-349">Lorsque cette stratégie est activée, les utilisateurs et les administrateurs qui exécutent une installation de maintenance d’un produit ne peuvent pas utiliser la boîte de dialogue Parcourir pour parcourir les sources de média, telles que les CD-ROM, pour les sources d’autres produits installables.</span><span class="sxs-lookup"><span data-stu-id="868bf-349">When this policy is enabled, users and administrators running a maintenance installation of one product are prevented from using the Browse Dialog to browse media sources, such as CD-ROM, for the sources of other installable products.</span></span> <span data-ttu-id="868bf-350">La recherche d’autres produits est empêchée, que l’installation soit effectuée avec des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="868bf-350">Browsing for other products is prevented regardless of whether the installation is done with elevated privileges.</span></span> <span data-ttu-id="868bf-351">Il est toujours possible pour l’utilisateur de réinstaller le produit à partir d’un support si celui-ci possède une source de média correctement libellée.</span><span class="sxs-lookup"><span data-stu-id="868bf-351">It is still possible for the user to reinstall the product from media if the user has a correctly labeled media source.</span></span>

## <a name="keep-the-original-package-source-files-secure-and-available-to-users"></a><span data-ttu-id="868bf-352">Conservez les fichiers sources du package d’origine sécurisés et disponibles pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="868bf-352">Keep the original package source files secure and available to users.</span></span>

<span data-ttu-id="868bf-353">Dans certains cas, la source d’origine du package de Windows Installer peut être nécessaire pour installer à la demande, réparer ou mettre à jour une application.</span><span class="sxs-lookup"><span data-stu-id="868bf-353">In some cases the original source of the Windows Installer package may be needed to install-on-demand, repair, or update an application.</span></span> <span data-ttu-id="868bf-354">Si le programme d’installation ne parvient pas à localiser une source disponible, il est invité à fournir un média ou à accéder à un emplacement réseau contenant les sources nécessaires.</span><span class="sxs-lookup"><span data-stu-id="868bf-354">If the installer is unable to locate an available source, the user is asked to provide media or to go to a network location containing the needed sources.</span></span> <span data-ttu-id="868bf-355">Il est recommandé de s’assurer que le programme d’installation a les sources dont il a besoin sans avoir à demander à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-355">It is a good practice to ensure that the installer has the sources it needs without having to prompt the user.</span></span>

-   <span data-ttu-id="868bf-356">Utilisez des [signatures numériques et des fichiers CAB externes](digital-signatures-and-external-cabinet-files.md) pour vous assurer que les sources d’origine utilisées par le programme d’installation sont sécurisées.</span><span class="sxs-lookup"><span data-stu-id="868bf-356">Use [Digital Signatures and External Cabinet Files](digital-signatures-and-external-cabinet-files.md) to ensure that the origial sources being used by the installer are secure.</span></span> <span data-ttu-id="868bf-357">Une image source non compressée stockée dans un emplacement public n’est pas sécurisée.</span><span class="sxs-lookup"><span data-stu-id="868bf-357">An uncompressed source image stored in an public location is not secure.</span></span>
-   <span data-ttu-id="868bf-358">Incluez une liste complète de chemins d’accès source réseau ou URL au package d’installation de l’application dans la propriété [**SourceList**](sourcelist.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-358">Include a complete list of network or URL source paths to the application's installation package in the [**SOURCELIST**](sourcelist.md) property.</span></span>
-   <span data-ttu-id="868bf-359">Utilisez un partage système de fichiers DFS (DFS) pour le chemin d’accès source.</span><span class="sxs-lookup"><span data-stu-id="868bf-359">Use a Distributed File System (DFS) share for the source path.</span></span>
-   <span data-ttu-id="868bf-360">Utilisez l’API Windows Installer pour récupérer et modifier les informations de liste source pour les applications et les correctifs Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-360">Use the Windows Installer API to retrieve and modify source list information for Windows Installer applications and patches.</span></span> <span data-ttu-id="868bf-361">Pour plus d’informations, consultez [gestion des sources d’installation](managing-installation-sources.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-361">For information see [Managing Installation Sources](managing-installation-sources.md).</span></span>
-   <span data-ttu-id="868bf-362">Utilisez les méthodes et les propriétés de l’objet du [**programme d’installation**](installer-object.md), l’objet [**Product**](product-object.md)et l' [**objet patch**](patch-object.md) pour récupérer et modifier les informations de la liste source pour Windows Installer applications et les correctifs.</span><span class="sxs-lookup"><span data-stu-id="868bf-362">Use the methods and properties of the [**Installer Object**](installer-object.md), [**Product Object**](product-object.md), and [**Patch Object**](patch-object.md) to retrieve and modify source list information for Windows Installer applications and patches.</span></span>
-   <span data-ttu-id="868bf-363">Adhérez aux points listés dans [empêcher un correctif d’exiger l’accès aux points de source d’installation d’origine](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) pour réduire la possibilité que votre correctif nécessite l’accès aux sources d’origine.</span><span class="sxs-lookup"><span data-stu-id="868bf-363">Adhere to points listed in [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) points to minimize the possibility that your patch will require access to the original sources.</span></span>
-   <span data-ttu-id="868bf-364">Stockez les fichiers sources du package dans un emplacement qui n’est pas le dossier temporaire du système.</span><span class="sxs-lookup"><span data-stu-id="868bf-364">Store the package source files in a location that is not the system's temporary folder.</span></span> <span data-ttu-id="868bf-365">Windows Installer fichiers sources stockés dans le dossier temporaire peuvent devenir indisponibles pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="868bf-365">Windows Installer source files stored in the temporary folder can become unavailable to users.</span></span>

## <a name="enable-verbose-logging-on-users-computer-when-troubleshooting-deployment"></a><span data-ttu-id="868bf-366">Activez la journalisation documentée sur l’ordinateur de l’utilisateur lors du dépannage du déploiement.</span><span class="sxs-lookup"><span data-stu-id="868bf-366">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>

<span data-ttu-id="868bf-367">[Windows Installer journalisation](windows-installer-logging.md) comprend une option de journalisation détaillée qui peut être activée sur l’ordinateur d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-367">[Windows Installer Logging](windows-installer-logging.md) includes a verbose logging option that can be enabled on a user's computer.</span></span> <span data-ttu-id="868bf-368">Les informations contenues dans un journal détaillé peuvent être utiles lorsque vous tentez de résoudre les problèmes de déploiement Windows Installer Package.</span><span class="sxs-lookup"><span data-stu-id="868bf-368">The information in a verbose log can helpful when trying to troubleshoot Windows Installer package deployment.</span></span>

-   <span data-ttu-id="868bf-369">Vous pouvez activer la journalisation documentée sur l’ordinateur de l’utilisateur à l’aide des [options de ligne de commande](command-line-options.md), de la propriété [**MsiLogging**](msilogging.md) , de la [stratégie de journalisation](logging.md), de [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga)et de la méthode [**EnableLog**](installer-enablelog.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-369">You can enable verbose logging on the user's computer by using [Command Line Options](command-line-options.md), the [**MsiLogging**](msilogging.md) property, [Logging policy](logging.md), [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga), and [**EnableLog**](installer-enablelog.md) method.</span></span>
-   <span data-ttu-id="868bf-370">Une ressource très utile pour interpréter les fichiers journaux de Windows Installer est [Wilogutl.exe](wilogutl-exe.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-370">A very useful resource for interpreting Windows Installer log files is [Wilogutl.exe](wilogutl-exe.md).</span></span> <span data-ttu-id="868bf-371">Cet outil aide à analyser les fichiers journaux et affiche les solutions suggérées aux erreurs qui se trouvent dans un fichier journal.</span><span class="sxs-lookup"><span data-stu-id="868bf-371">This tool assists the analysis of log files and displays suggested solutions to errors that are found in a log file.</span></span>
-   <span data-ttu-id="868bf-372">Pour plus d’informations sur l’interprétation des fichiers journaux de Windows Installer, consultez le livre blanc disponible sur le site TechNet : [Windows Installer : avantages et implémentation pour les administrateurs système](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span><span class="sxs-lookup"><span data-stu-id="868bf-372">For more information about interpreting Windows Installer log files, see the white paper available on the TechNet site: [Windows Installer: Benefits and Implementation for System Administrators](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span></span>
-   <span data-ttu-id="868bf-373">L’option de journalisation détaillée doit être utilisée uniquement à des fins de dépannage et ne doit pas être conservée, car elle peut avoir des effets néfastes sur les performances du système et sur l’espace disque.</span><span class="sxs-lookup"><span data-stu-id="868bf-373">The verbose logging option should be used only for troubleshooting purposes and should not be left on because it can have adverse effects on system performance and disk space.</span></span> <span data-ttu-id="868bf-374">Chaque fois que vous utilisez l’outil Ajout/suppression de programmes dans le panneau de configuration, un nouveau fichier est créé.</span><span class="sxs-lookup"><span data-stu-id="868bf-374">Each time you use the Add/Remove Programs tool in Control Panel, a new file is created.</span></span>

## <a name="uninstallation-leaves-the-users-computer-in-a-clean-state"></a><span data-ttu-id="868bf-375">La désinstallation laisse l’ordinateur de l’utilisateur dans un état propre.</span><span class="sxs-lookup"><span data-stu-id="868bf-375">Uninstallation leaves the user's computer in a clean state.</span></span>

<span data-ttu-id="868bf-376">La suppression de l’application est aussi importante que l’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-376">Application removal is as important as installation.</span></span> <span data-ttu-id="868bf-377">Lors de la désinstallation d’un package Windows Installer, il ne doit pas faire partie des éléments inutiles sur l’ordinateur de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-377">When a Windows Installer package is uninstalled it should leave no useless parts of itself behind on the user's computer.</span></span>

-   <span data-ttu-id="868bf-378">Si un fichier qui aurait dû être supprimé de l’ordinateur de l’utilisateur reste installé après l’exécution d’une désinstallation, il se peut que le programme d’installation ne supprime pas le composant contenant le fichier pour une ou plusieurs des raisons décrites dans [suppression des fichiers bloqués](removing-stranded-files.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-378">If a file that should have been removed from the user's computer remains installed after running an uninstall, the installer may not be removing the component containing the file for one or more of the reasons described in [Removing Stranded Files](removing-stranded-files.md).</span></span>
-   <span data-ttu-id="868bf-379">Si une application doit être inscrite, créez le package pour supprimer les informations de registre lorsque l’application est désinstallée.</span><span class="sxs-lookup"><span data-stu-id="868bf-379">If an application must be registered, author the package to remove registry information when the application is uninstalled.</span></span> <span data-ttu-id="868bf-380">Pour plus d’informations, consultez [Ajout ou suppression de clés de registre lors de l’installation ou de la suppression de composants](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-380">For information see [Adding or Removing Registry Keys on the Installation or Removal of Components](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span></span> <span data-ttu-id="868bf-381">Si une application n’est pas inscrite, l’application n’est pas répertoriée dans la fonctionnalité Ajout/suppression de programmes du panneau de configuration et ne peut pas être gérée à l’aide de l’Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-381">If an application is not registered, the application is not listed in the Add or Remove Programs feature in Control Panel and cannot be managed by using the Windows Installer.</span></span>
-   <span data-ttu-id="868bf-382">Pour masquer une application à partir de la fonctionnalité Ajout/suppression de programmes du panneau de configuration tout en étant en mesure d’utiliser la Windows Installer pour gérer l’application, suivez les instructions décrites dans [Ajout et suppression d’une application et ne laissant aucune trace dans le registre](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-382">To hide an application from the Add or Remove Programs feature in Control Panel and still be able to use the Windows Installer to manage the application, follow the guidelines described in [Adding and Removing an Application and Leaving No Trace in the Registry](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span></span>
-   <span data-ttu-id="868bf-383">Les actions personnalisées doivent être conditionnées pour être exécutées si nécessaire lors de la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="868bf-383">Custom actions should be conditioned to run or not as needed upon uninstallation.</span></span> <span data-ttu-id="868bf-384">Il peut s’avérer nécessaire d’exécuter différentes actions personnalisées lors de l’installation et de la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="868bf-384">Different custom actions may need to run on install and uninstall.</span></span>
-   <span data-ttu-id="868bf-385">Les informations de personnalisation spécifiques à l’utilisateur peuvent être stockées dans un fichier texte sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-385">User-specific customization information can be stored in a text file on the computer.</span></span> <span data-ttu-id="868bf-386">Cela présente l’avantage que le fichier peut être supprimé lors de la désinstallation de l’application, même si l’utilisateur de cette personnalisation n’est pas actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="868bf-386">This has the advantage that the file can be removed when the application is uninstalled, even if the user of this customization is not currently logged on.</span></span>

## <a name="test-packages-for-both-per-user-and-per-machine-installation-deployment"></a><span data-ttu-id="868bf-387">Testez les packages pour un déploiement d’installation par utilisateur et par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-387">Test packages for both per-user and per-machine installation deployment.</span></span>

<span data-ttu-id="868bf-388">Il est conseillé d’autoriser les clients à décider s’il faut déployer un package pour l’installation dans le [contexte d’installation](installation-context.md)par ordinateur ou par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-388">It is good practice to enable customers to decide whether to deploy a package for installation in either the per-machine or per-user [installation context](installation-context.md).</span></span>

-   <span data-ttu-id="868bf-389">Déterminez si l’application doit être disponible uniquement pour des utilisateurs particuliers ou pour tous les utilisateurs de l’ordinateur pendant le processus de développement.</span><span class="sxs-lookup"><span data-stu-id="868bf-389">Consider whether the application should be available to only particular users or all users of the computer during the development process.</span></span>
-   <span data-ttu-id="868bf-390">Vérifiez que le package fonctionne correctement pour les contextes d’installation par utilisateur et par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-390">Test that the package works correctly for both the per-user installation and per-machine installation contexts.</span></span>
-   <span data-ttu-id="868bf-391">Rendre le package facilement personnalisable et permettre aux clients de décider s’il faut le déployer par utilisateur ou par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-391">Make the package easily customizable and let customers decide whether to deploy it per-user or per-machine.</span></span>

## <a name="plan-and-test-a-servicing-strategy-before-shipping-the-application"></a><span data-ttu-id="868bf-392">Planifiez et testez une stratégie de maintenance avant d’expédier l’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-392">Plan and test a servicing strategy before shipping the application.</span></span>

<span data-ttu-id="868bf-393">Vous devez décider de la façon dont vous envisagez de traiter l’application avant de déployer l’application pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="868bf-393">You should decide how you intend to service the application before deploying the application for the first time.</span></span>

-   <span data-ttu-id="868bf-394">Tenez compte des types de mises à jour que vous prévoyez d’utiliser pour traiter votre application à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="868bf-394">Consider the types of updates you expect to use to service your application in the future.</span></span> <span data-ttu-id="868bf-395">Le Windows Installer fournit trois types de mises à jour : [mises à jour de petite taille](small-updates.md), [mise à niveau mineure](minor-upgrades.md)et [mises à niveau majeures](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-395">The Windows Installer provides three types of updates: [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="868bf-396">Les différences entre ces deux sujets sont décrites dans la rubrique [correctif et mises à niveau](patching-and-upgrades.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-396">The differences between these are described in [Patching and Upgrades](patching-and-upgrades.md) topic.</span></span>
-   <span data-ttu-id="868bf-397">Avant d’expédier votre application, testez qu’elle fonctionne comme prévu après la maintenance de chaque type de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="868bf-397">Before shipping your application, test that it works as expected after servicing with each update type.</span></span>

## <a name="reduce-the-dependency-of-updates-upon-the-original-sources"></a><span data-ttu-id="868bf-398">Réduisez la dépendance des mises à jour sur les sources d’origine.</span><span class="sxs-lookup"><span data-stu-id="868bf-398">Reduce the dependency of updates upon the original sources.</span></span>

<span data-ttu-id="868bf-399">Si les fichiers sources d’origine sont requis pour mettre à jour votre application, cela peut compliquer la maintenance de l’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-399">If the original source files are required to update your application, this can make servicing the application more difficult.</span></span> <span data-ttu-id="868bf-400">Les méthodes suivantes peuvent aider à réduire la dépendance des mises à jour sur les sources d’origine.</span><span class="sxs-lookup"><span data-stu-id="868bf-400">The following methods can help reduce the dependence of updates upon the original sources.</span></span>

-   <span data-ttu-id="868bf-401">Utilisez un [*correctif Delta*](d-gly.md) pour mettre à jour les versions de référence de votre application, telles que la version RTM et les versions de Service Pack.</span><span class="sxs-lookup"><span data-stu-id="868bf-401">Use a [*delta patch*](d-gly.md) to update the baseline versions of your application, such as the RTM version and the service pack versions.</span></span> <span data-ttu-id="868bf-402">Suivez les instructions relatives à l’utilisation des correctifs Delta décrits dans la rubrique : réduction de la [taille des correctifs](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-402">Follow the guidelines for using delta patches described in the topic: [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="868bf-403">Suivez les recommandations indiquées dans la rubrique : [empêcher un correctif de demander l’accès à la source d’installation d’origine](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-403">Follow the recommendations listed in the topic: [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span></span>

## <a name="do-not-distribute-unserviceable-merge-modules"></a><span data-ttu-id="868bf-404">Ne distribuez pas les modules de fusion non desservis.</span><span class="sxs-lookup"><span data-stu-id="868bf-404">Do not distribute unserviceable merge modules.</span></span>

<span data-ttu-id="868bf-405">Les applications ne doivent pas dépendre des [modules de fusion](merge-modules.md) pour l’installation du composant si le propriétaire du module de fusion et le propriétaire de l’application sont différents.</span><span class="sxs-lookup"><span data-stu-id="868bf-405">Applications should not depend on [merge modules](merge-modules.md) for the installation of component if the owner of the merge module and the owner of the application are different.</span></span> <span data-ttu-id="868bf-406">Cela peut compliquer la maintenance de l’application, car les deux propriétaires doivent coordonner la mise à jour de l’application ou du module.</span><span class="sxs-lookup"><span data-stu-id="868bf-406">This can make it difficult to service the application because both owners need to coordinate to update the application or module.</span></span> <span data-ttu-id="868bf-407">Sans connaître toutes les applications qui ont utilisé le module de fusion, le propriétaire de l’application n’est pas en mesure de mettre à jour le module de fusion sans risque que la mise à jour puisse être incompatible avec une autre application.</span><span class="sxs-lookup"><span data-stu-id="868bf-407">Without knowing all the applications that have used the merge module, the owner of the application is unable update the merge module without risking that the update might be incompatible with another application.</span></span> <span data-ttu-id="868bf-408">Le propriétaire du module de fusion n’a pas de méthode directe pour mettre à jour les packages Windows Installer qui ont déjà installé le module de fusion.</span><span class="sxs-lookup"><span data-stu-id="868bf-408">The owner of the merge module has no direct method for updating Windows Installer packages that have already installed the merge module.</span></span>

-   <span data-ttu-id="868bf-409">Envisagez de fournir les composants nécessaires aux utilisateurs comme une autre installation de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-409">Consider providing the needed components to users as another Windows Installer installation.</span></span>

## <a name="avoid-patching-administrative-installations"></a><span data-ttu-id="868bf-410">Évitez d’appliquer des correctifs aux installations administratives.</span><span class="sxs-lookup"><span data-stu-id="868bf-410">Avoid patching administrative installations.</span></span>

<span data-ttu-id="868bf-411">Fournissez sur un réseau une [installation administrative](administrative-installation.md) du package de Windows Installer d’origine de votre application pour permettre aux membres d’un groupe de travail d’installer l’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-411">Provide on a network an [administrative installation](administrative-installation.md) of your application's original Windows Installer package to enable members of a workgroup to install the application.</span></span> <span data-ttu-id="868bf-412">Les utilisateurs de cette image administrative doivent ensuite appliquer des mises à jour à l’instance locale de l’application située sur leur ordinateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-412">Users of this administrative image should then apply updates to the local instance of the application located on their computer.</span></span> <span data-ttu-id="868bf-413">Cela permet aux utilisateurs de synchroniser avec l’image administrative.</span><span class="sxs-lookup"><span data-stu-id="868bf-413">This keeps users in synchronization with the administrative image.</span></span> <span data-ttu-id="868bf-414">L’application de mises à jour à l’installation administrative n’est pas recommandée pour les raisons suivantes.</span><span class="sxs-lookup"><span data-stu-id="868bf-414">Applying updates to the administrative installation is not recommended for the following reasons.</span></span>

-   <span data-ttu-id="868bf-415">La taille et la latence du téléchargement requises par les utilisateurs pour obtenir une mise à jour sont accrues par rapport au téléchargement d’un correctif.</span><span class="sxs-lookup"><span data-stu-id="868bf-415">The size and latency of the download required for users to obtain an update is increased compared to downloading a patch.</span></span> <span data-ttu-id="868bf-416">La totalité du package Windows Installer mis à jour et des fichiers sources doivent être téléchargés, replacés en cache et réinstallés.</span><span class="sxs-lookup"><span data-stu-id="868bf-416">The entire updated Windows Installer package and source files must download, recached, and reinstalled.</span></span>
-   <span data-ttu-id="868bf-417">Les utilisateurs ne sont pas en mesure d' [installer à la demande](installation-on-demand.md) et de réparer des applications à partir d’une installation administrative mise à jour jusqu’à ce qu’ils replacent et réinstallent l’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-417">Users are unable to [installation-on-demand](installation-on-demand.md) and repair applications from an updated administrative installation until they recache and reinstall the application.</span></span>
-   <span data-ttu-id="868bf-418">L’application d’un correctif à une installation d’administration supprime la signature numérique du package.</span><span class="sxs-lookup"><span data-stu-id="868bf-418">Applying a patch to an administrative installation removes the digital signature from the package.</span></span> <span data-ttu-id="868bf-419">Un administrateur doit abandonner le package.</span><span class="sxs-lookup"><span data-stu-id="868bf-419">An administrator must resign the package.</span></span> <span data-ttu-id="868bf-420">Pour plus d’informations sur l’utilisation des signatures numériques, consultez [signatures numériques et Windows Installer](digital-signatures-and-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-420">For more information about using digital signatures, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md).</span></span>
-   <span data-ttu-id="868bf-421">De nombreux correctifs binaires ciblent l’image RTM de l’application et nécessitent une version de fichier antérieure.</span><span class="sxs-lookup"><span data-stu-id="868bf-421">Many binary patches target the RTM image of the application and require a previous file version.</span></span> <span data-ttu-id="868bf-422">L’instance locale d’une application installée à partir d’une installation d’administration mise à jour peut ne pas fonctionner avec d’autres mises à jour.</span><span class="sxs-lookup"><span data-stu-id="868bf-422">The local instance of an application installed from an updated administrative installation may not work with other updates.</span></span> <span data-ttu-id="868bf-423">De nombreuses applications de correctifs binaires peuvent échouer.</span><span class="sxs-lookup"><span data-stu-id="868bf-423">Many binary patch applications can fail.</span></span>
-   <span data-ttu-id="868bf-424">L’application d’un correctif à une installation administrative met à jour les fichiers sources et le fichier. msi, mais ne marque pas l’image réseau avec des informations sur la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="868bf-424">Applying a patch to an administrative installation updates the source files and the .msi file but does not stamp the network image with information about the update.</span></span> <span data-ttu-id="868bf-425">Les utilisateurs ne peuvent pas déterminer quelles mises à jour ont été reçues de l’installation d’administration.</span><span class="sxs-lookup"><span data-stu-id="868bf-425">Users cannot determine which updates they have received from the administrative installation.</span></span> <span data-ttu-id="868bf-426">Cela rend impossible la séquence des mises à jour appliquées côté utilisateur avec celles déjà appliquées côté image administrative.</span><span class="sxs-lookup"><span data-stu-id="868bf-426">This makes it impossible to sequence updates applied on the user side with those already applied on the administrative image side.</span></span>
-   <span data-ttu-id="868bf-427">Les correctifs appliqués à une installation administrative ne sont pas des [correctifs](uninstallable-patches.md)qui ne peuvent pas être installés.</span><span class="sxs-lookup"><span data-stu-id="868bf-427">Patches applied to an administrative installation are not [uninstallable patches](uninstallable-patches.md).</span></span> <span data-ttu-id="868bf-428">Cela peut empêcher le code du package mis en cache sur l’ordinateur de l’utilisateur de devenir différent du code du package sur l’installation d’administration.</span><span class="sxs-lookup"><span data-stu-id="868bf-428">This can prevent the package code cached on the user's computer from becoming different than the package code on the administrative installation.</span></span> <span data-ttu-id="868bf-429">Si le code de package mis en cache sur l’ordinateur de l’utilisateur est différent de celui utilisé lors de l’installation administrative, réinstallez l’application à partir de l’installation administrative, puis corrigez l’ordinateur client.</span><span class="sxs-lookup"><span data-stu-id="868bf-429">If the package code cached on the user's computer becomes different from that on the administrative installation, reinstall the application from the administrative installation and then patch the client computer.</span></span>
-   <span data-ttu-id="868bf-430">Si vous décidez d’appliquer de petites mises à jour en appliquant des correctifs à une image administrative, suivez les instructions décrites dans la rubrique : [application de petites mises à jour en corrigeant une image administrative](applying-small-updates-by-patching-an-administrative-image.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-430">If you decide to apply small updates by patching an administrative image, follow the guidelines described in the topic: [Applying Small Updates by Patching an Administrative Image](applying-small-updates-by-patching-an-administrative-image.md).</span></span>

## <a name="register-updates-to-run-with-elevated-privilege"></a><span data-ttu-id="868bf-431">Enregistrez les mises à jour à exécuter avec des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="868bf-431">Register updates to run with elevated privilege.</span></span>

<span data-ttu-id="868bf-432">À partir de Windows Installer 3,0, il est possible d’appliquer des correctifs à une application qui a été installée dans un contexte géré par l’utilisateur, une fois que le correctif a été inscrit comme ayant des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="868bf-432">Beginning with Windows Installer 3.0, it is possible to apply patches to an application that has been installed in a per-user-managed context, after the patch has been registered as having elevated privileges.</span></span> <span data-ttu-id="868bf-433">Vous ne pouvez pas appliquer de correctifs aux applications installées dans un contexte géré par utilisateur à l’aide des versions de Windows Installer antérieures à la version 3,0.</span><span class="sxs-lookup"><span data-stu-id="868bf-433">You cannot apply patches to applications that are installed in a per-user managed context using versions of Windows Installer earlier than version 3.0.</span></span>

-   <span data-ttu-id="868bf-434">Utilisez la méthode [**SourceListAddSource**](patch-sourcelistaddsource.md) ou la fonction [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) pour inscrire un package de correctifs comme ayant des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="868bf-434">Use the [**SourceListAddSource**](patch-sourcelistaddsource.md) method or [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to register a patch package as having elevated privileges.</span></span> <span data-ttu-id="868bf-435">Suivez les instructions et les exemples fournis dans [application des correctifs Per-User applications gérées](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-435">Follow the guidelines and examples provided in [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>
-   <span data-ttu-id="868bf-436">Lors de l’exécution de Windows Installer version 4,0 sur Windows Vista, vous pouvez également utiliser la mise à [jour corrective du contrôle de compte d’utilisateur (UAC)](user-account-control--uac--patching.md) pour permettre aux auteurs d’Windows Installer installations d’identifier les correctifs signés numériquement qui peuvent être appliqués ultérieurement par des utilisateurs non-administrateurs.</span><span class="sxs-lookup"><span data-stu-id="868bf-436">When running Windows Installer version 4.0 on Windows Vista you can also use [User Account Control (UAC) Patching](user-account-control--uac--patching.md) to enables the authors of Windows Installer installations to identify digitally-signed patches that can be applied in the future by non-administrator users.</span></span> <span data-ttu-id="868bf-437">Cette fonction est disponible uniquement avec l’installation des packages dans le contexte d' [installation](installation-context.md) par ordinateur (ALLUSERS = 1).</span><span class="sxs-lookup"><span data-stu-id="868bf-437">This is only available with the installation of packages in the per-machine [installation context](installation-context.md) (ALLUSERS=1).</span></span>
-   <span data-ttu-id="868bf-438">Vérifiez que la mise à jour corrective des privilèges minimaux n’a pas été désactivée en définissant la propriété [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) ou la stratégie [DisableLUAPatching](disableluapatching.md) .</span><span class="sxs-lookup"><span data-stu-id="868bf-438">Ensure that least-privilege patching has not been disabled by setting the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property or the [DisableLUAPatching](disableluapatching.md) policy.</span></span>

## <a name="use-the-msipatchsequence-table-to-sequence-patches"></a><span data-ttu-id="868bf-439">Utilisez la table MsiPatchSequence pour séquencer les correctifs.</span><span class="sxs-lookup"><span data-stu-id="868bf-439">Use the MsiPatchSequence Table to sequence patches.</span></span>

<span data-ttu-id="868bf-440">Incluez une [table MsiPatchSequence](msipatchsequence-table.md) dans votre package et ajoutez des informations sur le séquencement des correctifs.</span><span class="sxs-lookup"><span data-stu-id="868bf-440">Include a [MsiPatchSequence Table](msipatchsequence-table.md) in your package and add patch sequencing information.</span></span> <span data-ttu-id="868bf-441">À partir de Windows Installer version 3,0, le programme d’installation peut utiliser la table MsiPatchSequence lors de l' [installation de plusieurs correctifs](installing-multiple-patches.md) pour déterminer la meilleure séquence d’application corrective.</span><span class="sxs-lookup"><span data-stu-id="868bf-441">Beginning with Windows Installer version 3.0, the installer can use the MsiPatchSequence Table when [installing multiple patches](installing-multiple-patches.md) to determine the best patch application sequence.</span></span> <span data-ttu-id="868bf-442">Utilisez les instructions décrites dans le livre blanc [sur le séquencement des correctifs dans Windows Installer version 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) pour la définition des familles de correctifs.</span><span class="sxs-lookup"><span data-stu-id="868bf-442">Use the guidelines described in the [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) white paper for defining patch families.</span></span>

-   <span data-ttu-id="868bf-443">Si possible, spécifiez tous les correctifs comme appartenant à une seule famille de correctifs.</span><span class="sxs-lookup"><span data-stu-id="868bf-443">If practical, specify all patches as belonging to a single patch family.</span></span> <span data-ttu-id="868bf-444">Dans de nombreux cas, une seule famille de correctifs offre suffisamment de souplesse pour séquencer les correctifs.</span><span class="sxs-lookup"><span data-stu-id="868bf-444">In many cases a single patch family provides enough flexibility to sequence patches.</span></span> <span data-ttu-id="868bf-445">La complexité de la création augmente lorsque plusieurs familles de correctifs sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="868bf-445">The complexity of authoring increases when multiple patch families are used.</span></span> <span data-ttu-id="868bf-446">Attribuez un nom explicite à la famille de correctifs et affectez des valeurs de séquence dans cette famille de correctifs qui augmentent au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="868bf-446">Assign a meaningful name to the patch family and assign sequence values in that patch family that increase over time.</span></span> <span data-ttu-id="868bf-447">Suivez l' [exemple de correctifs multiples](multiple-patching-example.md) pour appliquer des correctifs dans l’ordre dans lequel ils ont été émis.</span><span class="sxs-lookup"><span data-stu-id="868bf-447">Follow the [Multiple Patching Example](multiple-patching-example.md) to apply patches in the order in which they have been issued.</span></span>
-   <span data-ttu-id="868bf-448">Utilisez la [table PatchSequence](patchsequence-table--patchwiz-dll-.md) dans [Patchwiz.dll](patchwiz-dll.md) pour générer les informations dans la [table MsiPatchSequence](msipatchsequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-448">Use the [PatchSequence Table](patchsequence-table--patchwiz-dll-.md) in [Patchwiz.dll](patchwiz-dll.md) to generate the information in [MsiPatchSequence Table](msipatchsequence-table.md).</span></span> <span data-ttu-id="868bf-449">La version de PATCHWIZ.DLL qui a été publiée avec Windows Installer 3,0 peut générer automatiquement des informations sur le séquencement des correctifs.</span><span class="sxs-lookup"><span data-stu-id="868bf-449">The version of PATCHWIZ.DLL that was released with Windows Installer 3.0 can automatically generate patch sequencing information.</span></span> <span data-ttu-id="868bf-450">Pour plus d’informations sur l’ajout d’un nouveau correctif, consultez génération d’informations sur les [séquences de correctifs](generating-patch-sequence-information---patchwiz-dll-.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-450">For more information on how to add a new patch, see [Generating Patch Sequence Information](generating-patch-sequence-information---patchwiz-dll-.md).</span></span> <span data-ttu-id="868bf-451">Pour plus d’informations sur les scénarios de séquencement des correctifs, consultez le livre blanc : mise [en séquence des correctifs dans Windows Installer version 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span><span class="sxs-lookup"><span data-stu-id="868bf-451">For more information about patch sequencing scenarios, see the whitepaper: [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span></span>

## <a name="test-the-installation-package-thoroughly"></a><span data-ttu-id="868bf-452">Testez soigneusement le package d’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-452">Test the installation package thoroughly.</span></span>

<span data-ttu-id="868bf-453">Testez l’installation, la réparation et la suppression correctes de votre package Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-453">Test for correct installation, repair, and removal of your Windows Installer package.</span></span> <span data-ttu-id="868bf-454">Vous pouvez diviser votre processus de test en éléments suivants.</span><span class="sxs-lookup"><span data-stu-id="868bf-454">You can divide your testing process into the following parts.</span></span>

-   <span data-ttu-id="868bf-455">Test d’installation : Testez l’installation avec toutes les combinaisons possibles de fonctionnalités d’application.</span><span class="sxs-lookup"><span data-stu-id="868bf-455">Installation Testing - Test the installation with all possible combinations of application features.</span></span> <span data-ttu-id="868bf-456">Testez tous les types d’installation, y compris [l’installation administrative](administrative-installation.md), la [restauration](rollback-installation.md)et l’installation à [la demande](installation-on-demand.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-456">Test all types of installation, including [Administrative Installation](administrative-installation.md), [Rollback Installation](rollback-installation.md), and [Installation-On-Demand](installation-on-demand.md).</span></span> <span data-ttu-id="868bf-457">Essayez toutes les méthodes d’installation possibles, notamment en cliquant sur le fichier. msi, sur les [options de ligne de commande](command-line-options.md)et en installant à partir du panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="868bf-457">Try all possible methods of installation, including clicking on the .msi file, [command line options](command-line-options.md), and installing from the control panel.</span></span> <span data-ttu-id="868bf-458">Teste que le package peut être installé par les utilisateurs dans tous les contextes de privilège possibles.</span><span class="sxs-lookup"><span data-stu-id="868bf-458">Test that the package can be installed by users in all possible privilege contexts.</span></span> <span data-ttu-id="868bf-459">Essayez d’installer le package une fois qu’il a été déployé par toutes les méthodes possibles.</span><span class="sxs-lookup"><span data-stu-id="868bf-459">Try installing the package after it has been deployed by all possible methods.</span></span> <span data-ttu-id="868bf-460">Activez la [journalisation des Windows Installer](windows-installer-logging.md) pour chaque test et corrigez toutes les erreurs trouvées dans le journal du programme d’installation et le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="868bf-460">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="868bf-461">Test de l’interface utilisateur : testez le package lorsqu’il est installé avec tous les [niveaux d’interface utilisateur](user-interface-levels.md)possibles.</span><span class="sxs-lookup"><span data-stu-id="868bf-461">User Interface Testing - Test the package when installed with all possible [user interface levels](user-interface-levels.md).</span></span> <span data-ttu-id="868bf-462">Testez le package installé sans interface utilisateur et toutes les informations fournies par le biais de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-462">Test the package installed with no user interface and with all information provided through the user interface.</span></span> <span data-ttu-id="868bf-463">Assurez-vous que l’interface utilisateur est [accessible](accessibility.md) et que l’interface utilisateur fonctionne comme prévu pour différentes résolutions d’écran et tailles de police.</span><span class="sxs-lookup"><span data-stu-id="868bf-463">Ensure the [Accessibility](accessibility.md) of the user interface and that the user interface functions as expected for different screen resolutions and font sizes.</span></span>
-   <span data-ttu-id="868bf-464">Test de maintenance et de réparation-test que le package peut gérer les [correctifs et les mises à niveau](patching-and-upgrades.md) fournis par une [petite mise à jour](small-updates.md), une [mise à niveau mineure](minor-upgrades.md)et des mises à niveau [majeures](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-464">Servicing and Repair Testing - Test that the package can handle [Patching and Upgrades](patching-and-upgrades.md) delivered by a [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="868bf-465">Avant de déployer le package, écrivez une mise à jour d’évaluation de chaque type et essayez de l’appliquer au package d’origine.</span><span class="sxs-lookup"><span data-stu-id="868bf-465">Before deploying the package, write a trial update of each type and try applying it to the original package.</span></span>
-   <span data-ttu-id="868bf-466">Désinstaller le test : Vérifiez que lorsque le package est supprimé, il ne laisse pas de parties inutiles sur l’ordinateur de l’utilisateur et que seules les informations appartenant au package ont été supprimées.</span><span class="sxs-lookup"><span data-stu-id="868bf-466">Uninstall Testing - Verify that when the package is removed it leaves no useless parts of itself behind on the user's computer and that only information belonging to the package has been removed.</span></span> <span data-ttu-id="868bf-467">Redémarrez l’ordinateur de test après la désinstallation du package et vérifiez l’intégrité des outils système communs et d’autres applications standard.</span><span class="sxs-lookup"><span data-stu-id="868bf-467">Reboot the test computer after uninstalling the package and verify the integrity of common system tools and other standard applications.</span></span> <span data-ttu-id="868bf-468">Teste que le package peut être supprimé par les utilisateurs dans tous les contextes de privilège possibles.</span><span class="sxs-lookup"><span data-stu-id="868bf-468">Test that the package can be removed by users in all possible privilege contexts.</span></span> <span data-ttu-id="868bf-469">Testez toutes les méthodes pour supprimer le package, cliquez sur le fichier. msi, essayez les [options de ligne de commande](command-line-options.md), puis essayez de supprimer le package à partir du panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="868bf-469">Test all methods to remove the package, click the .msi file, try the [command line options](command-line-options.md), and try removing the package from the control panel.</span></span> <span data-ttu-id="868bf-470">Activez la [journalisation des Windows Installer](windows-installer-logging.md) pour chaque test et corrigez toutes les erreurs trouvées dans le journal du programme d’installation et le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="868bf-470">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="868bf-471">Test des fonctionnalités du produit : Assurez-vous que l’application fonctionne comme prévu après l’installation, la réparation ou la suppression du package.</span><span class="sxs-lookup"><span data-stu-id="868bf-471">Product Functionality Testing - Ensure that the application functions as expected after the installation, repair, or removal of the package.</span></span>

## <a name="fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package"></a><span data-ttu-id="868bf-472">Corrigez toutes les erreurs de validation avant de déployer un package d’installation nouveau ou révisé.</span><span class="sxs-lookup"><span data-stu-id="868bf-472">Fix all validation errors before deploying a new or revised installation package.</span></span>

<span data-ttu-id="868bf-473">Exécutez la [validation du package](package-validation.md) sur un package de Windows Installer nouveau ou révisé avant de tenter de l’installer pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="868bf-473">Run [package validation](package-validation.md) on a new or revised Windows Installer package before attempting to install it for the first time.</span></span> <span data-ttu-id="868bf-474">La validation vérifie les erreurs de création dans la base de données Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="868bf-474">Validation checks the Windows Installer database for authoring errors.</span></span> <span data-ttu-id="868bf-475">Toute tentative d’installation d’un package qui n’est pas validé peut endommager le système de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="868bf-475">Attempting to install a package that does not pass validation can damage the user's system.</span></span>

-   <span data-ttu-id="868bf-476">Vous pouvez valider votre package à l’aide de [Orca.exe](orca-exe.md) ou [Msival2.exe](msival2-exe.md).</span><span class="sxs-lookup"><span data-stu-id="868bf-476">You can validate your package using [Orca.exe](orca-exe.md) or [Msival2.exe](msival2-exe.md).</span></span> <span data-ttu-id="868bf-477">Les deux outils sont fournis avec le SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="868bf-477">Both tools are provided with the Windows SDK.</span></span> <span data-ttu-id="868bf-478">Les fournisseurs tiers peuvent également intégrer le système de validation des GLACEs dans leur environnement de création.</span><span class="sxs-lookup"><span data-stu-id="868bf-478">Third-party vendors may also incorporate the ICE validation system into their authoring environment.</span></span>
-   <span data-ttu-id="868bf-479">Vous pouvez utiliser l’ensemble standard d' [évaluateurs de cohérence internes-ICEs](internal-consistency-evaluators-ices.md) inclus dans les fichiers. CUB fournis avec le kit de développement logiciel (SDK), ou personnaliser la validation en [générant une glace](building-an-ice.md) et en l’ajoutant au fichier. CUB.</span><span class="sxs-lookup"><span data-stu-id="868bf-479">You can use the standard set of [Internal Consistency Evaluators - ICEs](internal-consistency-evaluators-ices.md) included in the .cub files provided with the SDK, or customize validation by [Building an ICE](building-an-ice.md) and adding it to the .cub file.</span></span>
-   <span data-ttu-id="868bf-480">Vous pouvez utiliser la Evalcom2.dll pour implémenter l’automatisation de la [validation](validation-automation.md) des packages d’installation et des modules de fusion.</span><span class="sxs-lookup"><span data-stu-id="868bf-480">You can use the Evalcom2.dll to implement [Validation Automation](validation-automation.md) for installation packages and merge modules.</span></span>

## <a name="author-a-secure-installation"></a><span data-ttu-id="868bf-481">Créer une installation sécurisée.</span><span class="sxs-lookup"><span data-stu-id="868bf-481">Author a secure installation.</span></span>

<span data-ttu-id="868bf-482">Suivez ces instructions lors du développement de votre package pour aider à maintenir un environnement sécurisé lors de l’installation.</span><span class="sxs-lookup"><span data-stu-id="868bf-482">Following these guidelines when developing your package to help maintain a secure environment during installation.</span></span>

-   [<span data-ttu-id="868bf-483">Instructions pour la création d’installations sécurisées</span><span class="sxs-lookup"><span data-stu-id="868bf-483">Guidelines for Authoring Secure Installations</span></span>](guidelines-for-authoring-secure-installations.md)
-   [<span data-ttu-id="868bf-484">Instructions pour la sécurisation des packages sur les ordinateurs verrouillés</span><span class="sxs-lookup"><span data-stu-id="868bf-484">Guidelines for Securing Packages on Locked-Down Computers</span></span>](guidelines-for-securing-packages-on-locked-down-computers.md)
-   [<span data-ttu-id="868bf-485">Instructions pour la sécurisation des actions personnalisées</span><span class="sxs-lookup"><span data-stu-id="868bf-485">Guidelines for Securing Custom Actions</span></span>](guidelines-for-securing-custom-actions.md)

## <a name="use-pmsihandle-instead-of-handle"></a><span data-ttu-id="868bf-486">Utiliser PMSIHANDLE au lieu de HANDLE</span><span class="sxs-lookup"><span data-stu-id="868bf-486">Use PMSIHANDLE instead of HANDLE</span></span>

<span data-ttu-id="868bf-487">Les variables de type **PMSIHANDLE** sont définies dans msi. h.</span><span class="sxs-lookup"><span data-stu-id="868bf-487">The **PMSIHANDLE** type variables is defined in msi.h.</span></span> <span data-ttu-id="868bf-488">Il est recommandé que votre application utilise le type **PMSIHANDLE** , car le programme d’installation ferme les objets **PMSIHANDLE** à mesure qu’ils sont hors de portée, tandis que votre application doit fermer **MSIHANDLE** objets en appelant [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span><span class="sxs-lookup"><span data-stu-id="868bf-488">It is recommended that your application use the **PMSIHANDLE** type because the installer closes **PMSIHANDLE** objects as they go out of scope, whereas your application must close **MSIHANDLE** objects by calling [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span></span>

<span data-ttu-id="868bf-489">Par exemple, si vous utilisez du code comme celui-ci :</span><span class="sxs-lookup"><span data-stu-id="868bf-489">For example, if you use code like this:</span></span>

``` syntax
MSIHANDLE hRec = MsiCreateRecord(3);
```

<span data-ttu-id="868bf-490">Remplacez-le par :</span><span class="sxs-lookup"><span data-stu-id="868bf-490">Change it to:</span></span>

``` syntax
PMSIHANDLE hRec = MsiCreateRecord(3);
```

 

 
