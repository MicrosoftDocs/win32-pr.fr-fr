---
description: 'Le tableau ci-dessous répertorie les cinq actions personnalisées utilisées pour satisfaire les exemples de spécifications : ProcessAccounts, UninstallAccounts, CreateAccounts, RemoveAccounts et RollbackAccounts.'
ms.assetid: 389ec652-243e-4392-aec9-3a7eb90e6c68
title: Création des actions personnalisées
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e09525490304762b98635bcbbe6c238ce3fe413f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951758"
---
# <a name="authoring-the-custom-actions"></a><span data-ttu-id="96ca2-103">Création des actions personnalisées</span><span class="sxs-lookup"><span data-stu-id="96ca2-103">Authoring the Custom Actions</span></span>

<span data-ttu-id="96ca2-104">Le tableau ci-dessous répertorie les cinq actions personnalisées utilisées pour satisfaire les exemples de spécifications : ProcessAccounts, UninstallAccounts, CreateAccounts, RemoveAccounts et RollbackAccounts.</span><span class="sxs-lookup"><span data-stu-id="96ca2-104">The table below lists the five custom actions used to meet the sample specifications: ProcessAccounts, UninstallAccounts, CreateAccounts, RemoveAccounts, and RollbackAccounts.</span></span> <span data-ttu-id="96ca2-105">Toutes ces actions personnalisées se trouvent dans les [bibliothèques de liens dynamiques](dynamic-link-libraries.md) stockées dans la [table binaire](binary-table.md).</span><span class="sxs-lookup"><span data-stu-id="96ca2-105">All of these custom actions are in [dynamic-link libraries](dynamic-link-libraries.md) stored in the [Binary Table](binary-table.md).</span></span> <span data-ttu-id="96ca2-106">Le code source C++ pour les bibliothèques de liens dynamiques contenant les exemples d’actions personnalisées est fourni dans le kit de développement logiciel (SDK) Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="96ca2-106">The C++ source code for the dynamic-link libraries containing the sample custom actions are provided in the Windows Installer SDK.</span></span> <span data-ttu-id="96ca2-107">ProcessAccounts et UninstallAccounts se trouvent dans le fichier process. cpp.</span><span class="sxs-lookup"><span data-stu-id="96ca2-107">ProcessAccounts and UninstallAccounts are in the file Process.cpp.</span></span> <span data-ttu-id="96ca2-108">CreateAccount se trouve dans le fichier Create. cpp.</span><span class="sxs-lookup"><span data-stu-id="96ca2-108">CreateAccount is in the file Create.cpp.</span></span> <span data-ttu-id="96ca2-109">RemoveAccount et RollbackAccount se trouvent dans le fichier Remove. cpp.</span><span class="sxs-lookup"><span data-stu-id="96ca2-109">RemoveAccount and RollbackAccount are in the file Remove.cpp.</span></span> <span data-ttu-id="96ca2-110">Ces fichiers sources peuvent être utilisés pour créer les fichiers Process.dll, Create.dll et Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="96ca2-110">These source files can be used to create the files Process.dll, Create.dll, and Remove.dll.</span></span>

<span data-ttu-id="96ca2-111">Étant donné que la création ou la suppression d’un compte d’utilisateur nécessite des privilèges élevés, les [actions personnalisées d’exécution différée](deferred-execution-custom-actions.md) qui s’exécutent dans le contexte du système doivent être utilisées pour créer, supprimer ou restaurer des comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="96ca2-111">Because the creation or removal of a user account requires elevated privileges, [deferred execution custom actions](deferred-execution-custom-actions.md) that run in the context of the system must be used to create, remove, or roll back user accounts.</span></span> <span data-ttu-id="96ca2-112">Les actions personnalisées d’exécution immédiate, ProcessAccounts et UninstallAccounts, génèrent les actions personnalisées différées qui créent, suppriment ou restaurent les comptes d’utilisateur : CreateAccount, RemoveAccount et RollbackAccount.</span><span class="sxs-lookup"><span data-stu-id="96ca2-112">The immediate execution custom actions, ProcessAccounts and UninstallAccounts, generate the deferred custom actions that create, remove, or rollback user accounts: CreateAccount, RemoveAccount, and RollbackAccount.</span></span>

<span data-ttu-id="96ca2-113">Étant donné que les actions personnalisées différées ne peuvent pas lire les informations dans les tables de base de données, ProcessAccounts et UninstallUserAccouts doivent définir une propriété CustomActionData pour transmettre les informations de la table UserAccounts aux actions personnalisées différées, comme décrit dans [obtention d’informations de contexte pour les actions personnalisées d’exécution différée](obtaining-context-information-for-deferred-execution-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="96ca2-113">Because deferred custom actions cannot read information in database tables, ProcessAccounts and UninstallUserAccouts must set a CustomActionData property to pass the information in the UserAccounts table to the deferred custom actions as described in [Obtaining Context Information for Deferred Execution Custom Actions](obtaining-context-information-for-deferred-execution-custom-actions.md).</span></span> <span data-ttu-id="96ca2-114">Quand le programme d’installation exécute le script d’exécution, les actions personnalisées différées gèrent les comptes d’utilisateur en fonction des informations contenues dans la propriété CustomActionData.</span><span class="sxs-lookup"><span data-stu-id="96ca2-114">When the installer runs the execution script, the deferred custom actions handle user accounts according to the information in the CustomActionData property.</span></span>

<span data-ttu-id="96ca2-115">Étant donné que toutes les actions personnalisées se trouvent dans les bibliothèques de liens dynamiques stockées dans la table binaire, elles incluent toutes les constantes msidbCustomActionTypeDll et msidbCustomActionTypeBinaryData dans leur type numérique de base.</span><span class="sxs-lookup"><span data-stu-id="96ca2-115">Because all the custom actions are in dynamic-link libraries stored in the Binary table, they all include the constants msidbCustomActionTypeDll and msidbCustomActionTypeBinaryData in their base numeric type.</span></span> <span data-ttu-id="96ca2-116">ProcessAccounts et UninstallAccounts sont des exemples de [type d’action personnalisée pur 1](custom-action-type-1.md).</span><span class="sxs-lookup"><span data-stu-id="96ca2-116">ProcessAccounts and UninstallAccounts are examples of pure [Custom Action Type 1](custom-action-type-1.md).</span></span> <span data-ttu-id="96ca2-117">Pour plus d’informations sur les autres types d’actions personnalisées, consultez la [liste récapitulative de tous les types d’actions personnalisées](summary-list-of-all-custom-action-types.md).</span><span class="sxs-lookup"><span data-stu-id="96ca2-117">For information on other custom action types see the [Summary List of All Custom Action Types](summary-list-of-all-custom-action-types.md).</span></span>

<span data-ttu-id="96ca2-118">CreateAccount et RemoveAccount sont des [actions personnalisées d’exécution différée](deferred-execution-custom-actions.md) qui n’autorisent pas les services à emprunter l’identité d’utilisateurs particuliers.</span><span class="sxs-lookup"><span data-stu-id="96ca2-118">CreateAccount and RemoveAccount are [deferred execution custom actions](deferred-execution-custom-actions.md) that do not allow services to impersonate particular users.</span></span> <span data-ttu-id="96ca2-119">Ces actions personnalisées incluent les constantes msidbCustomActionTypeInScript et msidbCustomActionTypeNoImpersonate pour spécifier ces actions [personnalisées dans les options d’exécution de script](custom-action-in-script-execution-options.md).</span><span class="sxs-lookup"><span data-stu-id="96ca2-119">These custom actions include the constants msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate to specify these [custom action in-script execution options](custom-action-in-script-execution-options.md).</span></span>

<span data-ttu-id="96ca2-120">RollbackAccount est une [action personnalisée de restauration](rollback-custom-actions.md) qui supprime uniquement les comptes d’utilisateur lors d’une [installation de restauration](rollback-installation.md).</span><span class="sxs-lookup"><span data-stu-id="96ca2-120">RollbackAccount is a [rollback custom action](rollback-custom-actions.md) that only removes user accounts during a [rollback installation](rollback-installation.md).</span></span> <span data-ttu-id="96ca2-121">RollbackAccount comprend les constantes msidbCustomActionTypeInScript et msidbCustomActionTypeRollback pour spécifier ces [actions personnalisées dans les options d’exécution de script](custom-action-in-script-execution-options.md).</span><span class="sxs-lookup"><span data-stu-id="96ca2-121">RollbackAccount includes the constants msidbCustomActionTypeInScript and msidbCustomActionTypeRollback to specify these [custom action in-script execution options](custom-action-in-script-execution-options.md).</span></span>

<span data-ttu-id="96ca2-122">Ces actions personnalisées peuvent gérer des données sensibles telles que des mots de passe utilisateur, qui ne doivent pas être écrits dans le fichier journal.</span><span class="sxs-lookup"><span data-stu-id="96ca2-122">These custom actions may handle sensitive data such as user passwords, which should not be written to the log file.</span></span> <span data-ttu-id="96ca2-123">Les actions personnalisées différées doivent donc inclure msidbCustomActionTypeHideTarget dans le type d’action personnalisé.</span><span class="sxs-lookup"><span data-stu-id="96ca2-123">The deferred custom actions should therefore include msidbCustomActionTypeHideTarget in the custom action type.</span></span> <span data-ttu-id="96ca2-124">Les noms des actions personnalisées différées doivent également être ajoutés à la liste de propriétés [**MsiHiddenProperties**](msihiddenproperties.md) dans la [table des propriétés](property-table.md) en raison de la façon dont les actions personnalisées immédiates transmettent les données aux actions personnalisées différées à l’aide de la propriété CustomActionData.</span><span class="sxs-lookup"><span data-stu-id="96ca2-124">The names of the deferred custom actions also need to be added to the [**MsiHiddenProperties**](msihiddenproperties.md) property list in the [Property table](property-table.md) because of the way immediate custom actions pass data to deferred custom actions using the CustomActionData property.</span></span>



| <span data-ttu-id="96ca2-125">Action personnalisée</span><span class="sxs-lookup"><span data-stu-id="96ca2-125">Custom action</span></span>     | <span data-ttu-id="96ca2-126">Point d’entrée de DLL</span><span class="sxs-lookup"><span data-stu-id="96ca2-126">DLL entry point</span></span>                       | <span data-ttu-id="96ca2-127">Type d’action personnalisé</span><span class="sxs-lookup"><span data-stu-id="96ca2-127">Custom action type</span></span>                                                                                                                                                         |
|-------------------|---------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="96ca2-128">ProcessAccounts</span><span class="sxs-lookup"><span data-stu-id="96ca2-128">ProcessAccounts</span></span>   | <span data-ttu-id="96ca2-129">ProcessUserAccounts dans Process.dll.</span><span class="sxs-lookup"><span data-stu-id="96ca2-129">ProcessUserAccounts in Process.dll.</span></span>   | <span data-ttu-id="96ca2-130">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span><span class="sxs-lookup"><span data-stu-id="96ca2-130">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span></span>                                                                                                             |
| <span data-ttu-id="96ca2-131">UninstallAccounts</span><span class="sxs-lookup"><span data-stu-id="96ca2-131">UninstallAccounts</span></span> | <span data-ttu-id="96ca2-132">UninstallUserAccounts dans Process.dll.</span><span class="sxs-lookup"><span data-stu-id="96ca2-132">UninstallUserAccounts in Process.dll.</span></span> | <span data-ttu-id="96ca2-133">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span><span class="sxs-lookup"><span data-stu-id="96ca2-133">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span></span>                                                                                                             |
| <span data-ttu-id="96ca2-134">CreateAccount</span><span class="sxs-lookup"><span data-stu-id="96ca2-134">CreateAccount</span></span>     | <span data-ttu-id="96ca2-135">CreateUserAccount dans Create.dll.</span><span class="sxs-lookup"><span data-stu-id="96ca2-135">CreateUserAccount in Create.dll.</span></span>      | <span data-ttu-id="96ca2-136">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span><span class="sxs-lookup"><span data-stu-id="96ca2-136">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span></span> |
| <span data-ttu-id="96ca2-137">RemoveAccount</span><span class="sxs-lookup"><span data-stu-id="96ca2-137">RemoveAccount</span></span>     | <span data-ttu-id="96ca2-138">RemoveUserAccount dans Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="96ca2-138">RemoveUserAccount in Remove.dll.</span></span>      | <span data-ttu-id="96ca2-139">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span><span class="sxs-lookup"><span data-stu-id="96ca2-139">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span></span> |
| <span data-ttu-id="96ca2-140">RollbackAccount</span><span class="sxs-lookup"><span data-stu-id="96ca2-140">RollbackAccount</span></span>   | <span data-ttu-id="96ca2-141">RemoveUserAccount dans Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="96ca2-141">RemoveUserAccount in Remove.dll.</span></span>      | <span data-ttu-id="96ca2-142">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeRollback + msidbCustomActionTypeHideTarget = 9473.</span><span class="sxs-lookup"><span data-stu-id="96ca2-142">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeRollback + msidbCustomActionTypeHideTarget = 9473.</span></span>       |



 

<span data-ttu-id="96ca2-143">Passez à [la création de la table CustomAction](authoring-the-customaction-table.md).</span><span class="sxs-lookup"><span data-stu-id="96ca2-143">Continue to [Authoring the CustomAction Table](authoring-the-customaction-table.md).</span></span>

 

 



