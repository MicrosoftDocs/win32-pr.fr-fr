---
description: Cette section décrit l’inclusion de fichiers CAB dans des installations de. Pour plus d’informations, consultez Utilisation d’armoires et de sources compressées.
ms.assetid: 17ea7f76-90b2-48fb-8187-64dc6d294443
title: Inclusion d’un fichier cab dans une installation
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 098e660de3f7ec7097ab02613d75219ac0a0d624
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106534219"
---
# <a name="including-a-cabinet-file-in-an-installation"></a><span data-ttu-id="0b4c1-104">Inclusion d’un fichier cab dans une installation</span><span class="sxs-lookup"><span data-stu-id="0b4c1-104">Including a Cabinet File in an Installation</span></span>

<span data-ttu-id="0b4c1-105">Cette section décrit l’inclusion de fichiers CAB dans des installations de.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-105">This section describes including cabinet files in installations.</span></span> <span data-ttu-id="0b4c1-106">Pour plus d’informations, consultez [utilisation d’armoires et de sources compressées](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="0b4c1-106">For more information, see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>

<span data-ttu-id="0b4c1-107">**Pour inclure un fichier cab dans un package d’installation**</span><span class="sxs-lookup"><span data-stu-id="0b4c1-107">**To include a cabinet file in a installation package**</span></span>

1.  <span data-ttu-id="0b4c1-108">Utilisez un outil de création d’armoire pour compresser les fichiers sources dans un fichier CAB.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-108">Use a cabinet creation tool to compress the source files into a cabinet file.</span></span> <span data-ttu-id="0b4c1-109">Consultez [fichiers CAB](cabinet-files.md).</span><span class="sxs-lookup"><span data-stu-id="0b4c1-109">See [Cabinet Files](cabinet-files.md).</span></span>
2.  <span data-ttu-id="0b4c1-110">Le fichier cab doit se trouver dans un flux de données à l’intérieur du fichier. msi ou dans un fichier CAB séparé situé à la racine de l’arborescence source spécifiée par la [table de répertoires](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="0b4c1-110">The cabinet file must either be located in a data stream inside the .msi file or in a separate cabinet file located at the root of the source tree specified by the [Directory Table](directory-table.md).</span></span>
3.  <span data-ttu-id="0b4c1-111">Déterminez si la source doit être un type compressé ou un type mixte qui a à la fois des fichiers non compressés et des fichiers compressés.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-111">Determine whether the source is to be a compressed type or a mixed type that has both uncompressed and compressed files.</span></span> <span data-ttu-id="0b4c1-112">Consultez sources compressées [et non compressées](compressed-and-uncompressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="0b4c1-112">See [Compressed and Uncompressed Sources](compressed-and-uncompressed-sources.md).</span></span> <span data-ttu-id="0b4c1-113">Selon le type d’image source, définissez les bits d’indicateur compressés ou non compressés de la propriété [**Résumé du nombre de mots**](word-count-summary.md) .</span><span class="sxs-lookup"><span data-stu-id="0b4c1-113">Depending on the type of source image, set the compressed or uncompressed flag bits of the [**Word Count Summary**](word-count-summary.md) Property.</span></span>
4.  <span data-ttu-id="0b4c1-114">Ajoutez un enregistrement à la [table de fichiers](file-table.md) pour chacun des fichiers dans le fichier CAB.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-114">Add a record to the [File table](file-table.md) for each of the files in the cabinet.</span></span> <span data-ttu-id="0b4c1-115">Entrez dans la colonne fichier une clé de fichier qui correspond exactement à la clé de fichier du fichier dans le fichier CAB.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-115">Enter a file key in the File column that exactly matches the file key of the file in the cabinet.</span></span> <span data-ttu-id="0b4c1-116">Les clés de fichier respectent la casse.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-116">The file keys are case-sensitive.</span></span> <span data-ttu-id="0b4c1-117">La séquence d’installation de fichier dans la table de fichiers et l’armoire doit également être identique.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-117">The file installation sequence in the File table and the cabinet must also be the same.</span></span> <span data-ttu-id="0b4c1-118">La séquence de fichiers est spécifiée par le numéro de séquence dans la colonne séquence.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-118">The file sequence is specified by the sequence number in the Sequence column.</span></span> <span data-ttu-id="0b4c1-119">Pour obtenir le numéro de séquence du premier fichier du fichier CAB, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-119">To arrive at the sequence number for the first file in the cabinet, do the following.</span></span> <span data-ttu-id="0b4c1-120">Recherchez l’enregistrement existant dans la [table des médias](media-table.md) qui a la plus grande valeur dans la colonne dipatinage.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-120">Find the existing record in the [Media table](media-table.md) having the greatest value in the DiskID column.</span></span> <span data-ttu-id="0b4c1-121">Le champ LastSequence de cet enregistrement indique le dernier numéro de séquence de fichier utilisé sur le support.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-121">The LastSequence field of this record gives the last file sequence number used on the media.</span></span> <span data-ttu-id="0b4c1-122">Dans la table file, affectez au premier fichier du nouvel armoire un numéro de séquence supérieur à celui-ci.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-122">In the File table, assign the first file of the new cabinet a sequence number that is greater than this.</span></span> <span data-ttu-id="0b4c1-123">Attribuez des numéros de séquence à tous les fichiers restants dans le même ordre que dans le fichier CAB.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-123">Assign sequence numbers to all of the remaining files in the same order as in the cabinet file.</span></span> <span data-ttu-id="0b4c1-124">Pour obtenir une description des champs d’enregistrement restants, consultez [table file](file-table.md).</span><span class="sxs-lookup"><span data-stu-id="0b4c1-124">For a description of the remaining record fields, see [File table](file-table.md).</span></span>
5.  <span data-ttu-id="0b4c1-125">Ajoutez un enregistrement à la [table des médias](media-table.md) pour le cabinet.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-125">Add a record to the [Media table](media-table.md) for the cabinet.</span></span> <span data-ttu-id="0b4c1-126">Spécifiez une valeur dans le champ dipatinage de ce nouvel enregistrement qui est supérieure à la plus grande valeur de dépatinage déjà présente dans la table.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-126">Specify a value in the DiskID field of this new record that is greater than the largest DiskID value already existing in the table.</span></span> <span data-ttu-id="0b4c1-127">Placez le nom de l’armoire dans le champ Cabinet.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-127">Put the name of the cabinet into the Cabinet field.</span></span> <span data-ttu-id="0b4c1-128">Ce nom doit se présenter sous la forme d’un type de données [CAB](cabinet.md) .</span><span class="sxs-lookup"><span data-stu-id="0b4c1-128">This name must be in the form of a [Cabinet](cabinet.md) data type.</span></span> <span data-ttu-id="0b4c1-129">Préfixez le nom avec le signe dièse « \# » si le fichier cab est un flux de données stocké dans le fichier. msi.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-129">Prefix the name with a number sign "\#" if the cabinet is a data stream stored in the .msi file.</span></span> <span data-ttu-id="0b4c1-130">Notez que si le fichier cab est un flux de données, le nom du fichier cab est sensible à la casse.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-130">Note that if the cabinet is a data stream, the name of the cabinet is case-sensitive.</span></span> <span data-ttu-id="0b4c1-131">Si le fichier cab est un fichier distinct, le nom du fichier n’est pas sensible à la casse.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-131">If the cabinet is a separate file, the name of the file is not case-sensitive.</span></span>
6.  <span data-ttu-id="0b4c1-132">Déterminez le numéro de séquence de fichier le plus grand dans le nouvel armoire en vérifiant la colonne séquence de la table de fichiers mise à jour.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-132">Determine the greatest file sequence number in the new cabinet by checking the Sequence column of the updated File table.</span></span> <span data-ttu-id="0b4c1-133">Entrez une valeur supérieure à celle-ci dans le champ LastSequence du nouvel enregistrement de la table multimédia.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-133">Enter a value that is greater than this into the LastSequence field of the new record of the Media table.</span></span> <span data-ttu-id="0b4c1-134">Pour obtenir une description des champs d’enregistrement restants, consultez [table des médias](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="0b4c1-134">For a description of the remaining record fields, see [Media table](media-table.md).</span></span>
7.  <span data-ttu-id="0b4c1-135">Vous pouvez stocker le fichier cab dans le package d’installation à l’aide d’un outil tel que Msidb.exe ou à l’aide des [fonctions de base de données](database-functions.md)du programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-135">You can store the cabinet file in the installation package either by using a tool such as Msidb.exe or by using the installer's [Database Functions](database-functions.md).</span></span> <span data-ttu-id="0b4c1-136">Les quatre étapes suivantes expliquent comment ajouter le fichier cab à partir d’un programme à l’aide des fonctions de base de données.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-136">The following four steps explain how to add the cabinet from a program by using the database functions.</span></span>
8.  <span data-ttu-id="0b4c1-137">Pour ajouter le fichier CAB au package d’installation à partir d’un programme, ouvrez une vue sur la [ \_ table Streams](-streams-table.md) de la base de données à l’aide de [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span><span class="sxs-lookup"><span data-stu-id="0b4c1-137">To add the cabinet to the installation package from a program open a view on the [\_Streams table](-streams-table.md) of the database using [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span></span>
9.  <span data-ttu-id="0b4c1-138">Utilisez [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) pour définir la colonne Name de la \_ table Streams sur le nom figurant dans la colonne Cabinet de la [table Media](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="0b4c1-138">Use [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) to set the Name column of the \_Streams table to the name appearing in the Cabinet column of the [Media table](media-table.md).</span></span> <span data-ttu-id="0b4c1-139">Omettez le signe dièse : \# .</span><span class="sxs-lookup"><span data-stu-id="0b4c1-139">Omit the number sign: \#.</span></span>
10. <span data-ttu-id="0b4c1-140">Utilisez [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) pour définir la colonne de données de la \_ table Streams sur les données de l’armoire.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-140">Use [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) to set the Data column of the \_Streams table to the cabinet's data.</span></span>
11. <span data-ttu-id="0b4c1-141">Utilisez [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) pour mettre à jour l’enregistrement dans la \_ table streams.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-141">Use [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) to update the record in the \_Streams table.</span></span>
12. <span data-ttu-id="0b4c1-142">Pour utiliser Msidb.exe pour ajouter le fichier CAB Mycab.cab au package d’installation nommé Mydatabase.msi, utilisez la ligne de commande suivante : Msidb.exe-d mydatabase.msi-a mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-142">To use Msidb.exe to add the cabinet file Mycab.cab to the installation package named Mydatabase.msi, use the following command line: Msidb.exe -d mydatabase.msi -a mycab.cab.</span></span> <span data-ttu-id="0b4c1-143">Dans ce cas, la colonne Cabinet de la table Media doit contenir la chaîne : \#mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="0b4c1-143">In this case, the Cabinet column of the Media table should contain the string: \#mycab.cab.</span></span>

 

 



