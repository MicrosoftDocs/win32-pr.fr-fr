---
description: L’objet session contrôle le processus d’installation.
ms.assetid: 013959d9-900c-45f7-b742-17b0365d6107
title: Objet session (Windows Installer)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: c391249d5ccc58fe9a947c9db761a77521c9776d
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/22/2021
ms.locfileid: "106540077"
---
# <a name="session-object-windows-installer"></a><span data-ttu-id="25330-103">Objet session (Windows Installer)</span><span class="sxs-lookup"><span data-stu-id="25330-103">Session object (Windows Installer)</span></span>

<span data-ttu-id="25330-104">L’objet **session** contrôle le processus d’installation.</span><span class="sxs-lookup"><span data-stu-id="25330-104">The **Session** object controls the installation process.</span></span> <span data-ttu-id="25330-105">Il ouvre la base de données du programme d’installation, qui contient les tables et les données d’installation.</span><span class="sxs-lookup"><span data-stu-id="25330-105">It opens the Installer database, which contains the installation tables and data.</span></span> <span data-ttu-id="25330-106">Cet objet est associé à un ensemble standard de fonctions d’action, chacune effectuant des opérations particulières sur des données à partir d’une ou plusieurs tables.</span><span class="sxs-lookup"><span data-stu-id="25330-106">This object is associated with a standard set of action functions, each performing particular operations on data from one or more tables.</span></span> <span data-ttu-id="25330-107">Des actions personnalisées supplémentaires peuvent être ajoutées pour des installations de produits spécifiques.</span><span class="sxs-lookup"><span data-stu-id="25330-107">Additional custom actions may be added for particular product installations.</span></span> <span data-ttu-id="25330-108">La fonction de moteur de base est un séquenceur qui extrait les enregistrements séquentiels d’une table de séquences désignée, évalue toute expression de condition spécifiée et exécute l’action désignée.</span><span class="sxs-lookup"><span data-stu-id="25330-108">The basic engine function is a sequencer that fetches sequential records from a designated sequence table, evaluates any specified condition expression, and executes the designated action.</span></span> <span data-ttu-id="25330-109">Les actions non reconnues par le moteur sont différées à l’objet gestionnaire d’interface utilisateur pour le traitement, généralement des séquences de boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="25330-109">Actions not recognized by the engine are deferred to the UI handler object for processing, usually dialog box sequences.</span></span>

<span data-ttu-id="25330-110">Notez qu’un seul objet de **session** peut être ouvert par un processus unique.</span><span class="sxs-lookup"><span data-stu-id="25330-110">Note that only one **Session** object can be opened by a single process.</span></span>

## <a name="members"></a><span data-ttu-id="25330-111">Membres</span><span class="sxs-lookup"><span data-stu-id="25330-111">Members</span></span>

<span data-ttu-id="25330-112">L’objet **session** possède les types de membres suivants :</span><span class="sxs-lookup"><span data-stu-id="25330-112">The **Session** object has these types of members:</span></span>

-   [<span data-ttu-id="25330-113">Méthodes</span><span class="sxs-lookup"><span data-stu-id="25330-113">Methods</span></span>](#methods)
-   [<span data-ttu-id="25330-114">Propriétés</span><span class="sxs-lookup"><span data-stu-id="25330-114">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="25330-115">Méthodes</span><span class="sxs-lookup"><span data-stu-id="25330-115">Methods</span></span>

<span data-ttu-id="25330-116">L’objet **session** possède ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="25330-116">The **Session** object has these methods.</span></span>



| <span data-ttu-id="25330-117">Méthode</span><span class="sxs-lookup"><span data-stu-id="25330-117">Method</span></span>                                                 | <span data-ttu-id="25330-118">Description</span><span class="sxs-lookup"><span data-stu-id="25330-118">Description</span></span>                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="25330-119">**Action**</span><span class="sxs-lookup"><span data-stu-id="25330-119">**DoAction**</span></span>](session-doaction.md)                   | <span data-ttu-id="25330-120">Exécute l’action spécifiée.</span><span class="sxs-lookup"><span data-stu-id="25330-120">Executes the specified action.</span></span> <br/>                                                                                                                                                                                                                                |
| [<span data-ttu-id="25330-121">**EvaluateCondition**</span><span class="sxs-lookup"><span data-stu-id="25330-121">**EvaluateCondition**</span></span>](session-evaluatecondition.md) | <span data-ttu-id="25330-122">Évalue une expression logique contenant des symboles et des valeurs et retourne un entier de l’énumération msiEvaluateConditionErrorEnum.</span><span class="sxs-lookup"><span data-stu-id="25330-122">Evaluates a logical expression containing symbols and values and returns an integer of the enumeration msiEvaluateConditionErrorEnum.</span></span><br/>                                                                                                                          |
| [<span data-ttu-id="25330-123">**FeatureInfo**</span><span class="sxs-lookup"><span data-stu-id="25330-123">**FeatureInfo**</span></span>](session-featureinfo.md)             | <span data-ttu-id="25330-124">Retourne un objet [**FeatureInfo**](featureinfo-object.md) qui contient des informations descriptives pour la fonctionnalité spécifiée.</span><span class="sxs-lookup"><span data-stu-id="25330-124">Returns a [**FeatureInfo**](featureinfo-object.md) object containing descriptive information for the specified feature.</span></span><br/>                                                                                                                                       |
| [<span data-ttu-id="25330-125">**FormatRecord**</span><span class="sxs-lookup"><span data-stu-id="25330-125">**FormatRecord**</span></span>](session-formatrecord.md)           | <span data-ttu-id="25330-126">Retourne une chaîne mise en forme à partir de données de modèle et d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="25330-126">Returns a formatted string from template and record data.</span></span><br/>                                                                                                                                                                                                      |
| [<span data-ttu-id="25330-127">**Message**</span><span class="sxs-lookup"><span data-stu-id="25330-127">**Message**</span></span>](session-message.md)                     | <span data-ttu-id="25330-128">Exécute toutes les opérations de journalisation activées et diffère l’exécution à l’objet de gestionnaire d’interface utilisateur associé au moteur.</span><span class="sxs-lookup"><span data-stu-id="25330-128">Performs any enabled logging operations and defers execution to the UI handler object associated with the engine.</span></span><br/>                                                                                                                                              |
| [<span data-ttu-id="25330-129">**Séquence**</span><span class="sxs-lookup"><span data-stu-id="25330-129">**Sequence**</span></span>](session-sequence.md)                   | <span data-ttu-id="25330-130">Ouvre une requête sur la table spécifiée, en ordonnant les actions en fonction des nombres figurant dans la colonne séquence.</span><span class="sxs-lookup"><span data-stu-id="25330-130">Opens a query on the specified table, ordering the actions by the numbers in the Sequence column.</span></span> <span data-ttu-id="25330-131">Pour chaque ligne extraite, la méthode d' [**action**](session-doaction.md) est appelée, à condition que toute expression de condition fournie ne corresponde pas à false.</span><span class="sxs-lookup"><span data-stu-id="25330-131">For each row fetched, the [**DoAction**](session-doaction.md) method is called, provided that any supplied condition expression does not evaluate to False.</span></span><br/> |
| [<span data-ttu-id="25330-132">**SetInstallLevel**</span><span class="sxs-lookup"><span data-stu-id="25330-132">**SetInstallLevel**</span></span>](session-setinstalllevel.md)     | <span data-ttu-id="25330-133">Définit le niveau d’installation de l’installation actuelle sur une valeur spécifiée et recalcule les États SELECT et installed pour toutes les fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="25330-133">Sets the install level for the current installation to a specified value and recalculates the Select and Installed states for all features.</span></span><br/>                                                                                                                    |



 

### <a name="properties"></a><span data-ttu-id="25330-134">Propriétés</span><span class="sxs-lookup"><span data-stu-id="25330-134">Properties</span></span>

<span data-ttu-id="25330-135">L’objet **session** possède ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="25330-135">The **Session** object has these properties.</span></span>



| <span data-ttu-id="25330-136">Propriété</span><span class="sxs-lookup"><span data-stu-id="25330-136">Property</span></span>                                                                  | <span data-ttu-id="25330-137">Type d’accès</span><span class="sxs-lookup"><span data-stu-id="25330-137">Access type</span></span>           | <span data-ttu-id="25330-138">Description</span><span class="sxs-lookup"><span data-stu-id="25330-138">Description</span></span>                                                                                                                                                                |
|:--------------------------------------------------------------------------|:----------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="25330-139">**ComponentCosts**</span><span class="sxs-lookup"><span data-stu-id="25330-139">**ComponentCosts**</span></span>](session-componentcosts.md)<br/>               |                       | <span data-ttu-id="25330-140">Retourne un objet [**RecordList**](recordlist-object.md) énumérant l’espace disque par lecteur requis pour installer un composant.</span><span class="sxs-lookup"><span data-stu-id="25330-140">Returns a [**RecordList**](recordlist-object.md) object enumerating the disk space per drive required to install a component.</span></span><br/>                                  |
| [<span data-ttu-id="25330-141">**ComponentCurrentState**</span><span class="sxs-lookup"><span data-stu-id="25330-141">**ComponentCurrentState**</span></span>](session-componentcurrentstate.md)<br/> |                       | <span data-ttu-id="25330-142">Retourne l’état installé actuel du composant désigné.</span><span class="sxs-lookup"><span data-stu-id="25330-142">Returns the current installed state of the designated component.</span></span><br/>                                                                                                |
| [<span data-ttu-id="25330-143">**ComponentRequestState**</span><span class="sxs-lookup"><span data-stu-id="25330-143">**ComponentRequestState**</span></span>](session-componentrequeststate.md)<br/> |                       | <span data-ttu-id="25330-144">Obtient ou demande une modification de l’état d’action d’une ligne dans la table des composants.</span><span class="sxs-lookup"><span data-stu-id="25330-144">Obtains or requests a change in the Action state of a row in the Component table.</span></span><br/>                                                                               |
| [<span data-ttu-id="25330-145">**Base de données**</span><span class="sxs-lookup"><span data-stu-id="25330-145">**Database**</span></span>](session-database.md)<br/>                           |                       | <span data-ttu-id="25330-146">Retourne la base de données pour la session d’installation en cours.</span><span class="sxs-lookup"><span data-stu-id="25330-146">Returns the database for the current installation session.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="25330-147">**FeatureCost**</span><span class="sxs-lookup"><span data-stu-id="25330-147">**FeatureCost**</span></span>](session-featurecost.md)<br/>                     |                       | <span data-ttu-id="25330-148">Retourne la quantité totale d’espace disque (en unités de 512 octets) requise par la fonctionnalité spécifiée et ses fonctionnalités parentes (jusqu’à la racine du tableau des fonctionnalités).</span><span class="sxs-lookup"><span data-stu-id="25330-148">Returns the total amount of disk space (in units of 512 bytes) required by the specified feature and its parent features (up to the root of the Feature table).</span></span><br/> |
| [<span data-ttu-id="25330-149">**FeatureCurrentState**</span><span class="sxs-lookup"><span data-stu-id="25330-149">**FeatureCurrentState**</span></span>](session-featurecurrentstate.md)<br/>     |                       | <span data-ttu-id="25330-150">Retourne l’état installé actuel de la fonctionnalité désignée.</span><span class="sxs-lookup"><span data-stu-id="25330-150">Returns the current installed state of the designated feature.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="25330-151">**FeatureRequestState**</span><span class="sxs-lookup"><span data-stu-id="25330-151">**FeatureRequestState**</span></span>](session-featurerequeststate.md)<br/>     | <span data-ttu-id="25330-152">Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="25330-152">Read/write</span></span><br/> | <span data-ttu-id="25330-153">Obtient ou demande une modification de l’État SELECT de l’enregistrement et des sous-enregistrements d’une fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="25330-153">Obtains or requests a change in the Select state of a feature's record and subrecords.</span></span><br/>                                                                          |
| [<span data-ttu-id="25330-154">**FeatureValidStates**</span><span class="sxs-lookup"><span data-stu-id="25330-154">**FeatureValidStates**</span></span>](session-featurevalidstates.md)<br/>       |                       | <span data-ttu-id="25330-155">Retourne un entier représentant des indicateurs binaires avec chaque bit approprié représentant un état d’installation valide pour la fonctionnalité spécifiée.</span><span class="sxs-lookup"><span data-stu-id="25330-155">Returns an integer representing bit flags with each relevant bit representing a valid installation state for the specified feature.</span></span><br/>                             |
| [<span data-ttu-id="25330-156">**Programme d’installation**</span><span class="sxs-lookup"><span data-stu-id="25330-156">**Installer**</span></span>](session-installer.md)<br/>                         |                       | <span data-ttu-id="25330-157">Retourne l’objet d’installation actif.</span><span class="sxs-lookup"><span data-stu-id="25330-157">Returns the active installer object.</span></span><br/>                                                                                                                            |
| [<span data-ttu-id="25330-158">**Language (objet session)**</span><span class="sxs-lookup"><span data-stu-id="25330-158">**Language (Session Object)**</span></span>](session-language.md)<br/>          |                       | <span data-ttu-id="25330-159">Représente l’identificateur de langue numérique utilisé par la session d’installation en cours.</span><span class="sxs-lookup"><span data-stu-id="25330-159">Represents the numeric language identifier used by the current installation session.</span></span><br/>                                                                            |
| [<span data-ttu-id="25330-160">**Mode**</span><span class="sxs-lookup"><span data-stu-id="25330-160">**Mode**</span></span>](session-mode.md)<br/>                                   |                       | <span data-ttu-id="25330-161">Cette propriété est une valeur représentant l’indicateur de mode désigné pour la session d’installation en cours.</span><span class="sxs-lookup"><span data-stu-id="25330-161">This property is a value representing the designated mode flag for the current installation session.</span></span><br/>                                                            |
| [<span data-ttu-id="25330-162">**ProductProperty**</span><span class="sxs-lookup"><span data-stu-id="25330-162">**ProductProperty**</span></span>](session-productproperty.md)<br/>             |                       | <span data-ttu-id="25330-163">Représente la valeur de chaîne d’une propriété de programme d’installation nommée.</span><span class="sxs-lookup"><span data-stu-id="25330-163">Represents the string value of a named installer property.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="25330-164">**Propriété (objet session)**</span><span class="sxs-lookup"><span data-stu-id="25330-164">**Property (Session Object)**</span></span>](session-session.md)<br/>           | <span data-ttu-id="25330-165">Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="25330-165">Read/write</span></span><br/> | <span data-ttu-id="25330-166">Récupère les propriétés du produit de la base de données du produit.</span><span class="sxs-lookup"><span data-stu-id="25330-166">Retrieves product properties from the product database.</span></span><br/>                                                                                                         |
| [<span data-ttu-id="25330-167">**SourcePath**</span><span class="sxs-lookup"><span data-stu-id="25330-167">**SourcePath**</span></span>](session-sourcepath.md)<br/>                       |                       | <span data-ttu-id="25330-168">Fournit le chemin d’accès complet au dossier désigné sur le média source ou l’image serveur.</span><span class="sxs-lookup"><span data-stu-id="25330-168">Provides the full path to the designated folder on the source media or server image.</span></span><br/>                                                                            |
| [<span data-ttu-id="25330-169">**TargetPath**</span><span class="sxs-lookup"><span data-stu-id="25330-169">**TargetPath**</span></span>](session-targetpath.md)<br/>                       | <span data-ttu-id="25330-170">Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="25330-170">Read/write</span></span><br/> | <span data-ttu-id="25330-171">Fournit le chemin d’accès complet au dossier désigné sur le lecteur cible de l’installation.</span><span class="sxs-lookup"><span data-stu-id="25330-171">Provides the full path to the designated folder on the installation target drive.</span></span><br/>                                                                               |
| [<span data-ttu-id="25330-172">**VerifyDiskSpace**</span><span class="sxs-lookup"><span data-stu-id="25330-172">**VerifyDiskSpace**</span></span>](session-verifydiskspace.md)<br/>             |                       | <span data-ttu-id="25330-173">Retourne la valeur true si l’espace disque disponible est suffisant, et false si le disque est plein.</span><span class="sxs-lookup"><span data-stu-id="25330-173">Returns true if enough disk space exists, and false if the disk is full.</span></span><br/>                                                                                        |



 

## <a name="requirements"></a><span data-ttu-id="25330-174">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="25330-174">Requirements</span></span>



| <span data-ttu-id="25330-175">Condition requise</span><span class="sxs-lookup"><span data-stu-id="25330-175">Requirement</span></span> | <span data-ttu-id="25330-176">Valeur</span><span class="sxs-lookup"><span data-stu-id="25330-176">Value</span></span> |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="25330-177">Version</span><span class="sxs-lookup"><span data-stu-id="25330-177">Version</span></span><br/> | <span data-ttu-id="25330-178">Windows Installer 5,0 sur Windows Server 2012, Windows 8, Windows Server 2008 R2 ou Windows 7.</span><span class="sxs-lookup"><span data-stu-id="25330-178">Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7.</span></span> <span data-ttu-id="25330-179">Windows Installer 4,0 ou Windows Installer 4,5 sur Windows Server 2008 ou Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="25330-179">Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista.</span></span> <span data-ttu-id="25330-180">Windows Installer sur Windows Server 2003 ou Windows XP</span><span class="sxs-lookup"><span data-stu-id="25330-180">Windows Installer on Windows Server 2003 or Windows XP</span></span><br/> |
| <span data-ttu-id="25330-181">DLL</span><span class="sxs-lookup"><span data-stu-id="25330-181">DLL</span></span><br/>     | <dl> <span data-ttu-id="25330-182"><dt>Msi.dll</dt></span><span class="sxs-lookup"><span data-stu-id="25330-182"><dt>Msi.dll</dt></span></span> </dl>                                                                                                                                                                      |
| <span data-ttu-id="25330-183">IID</span><span class="sxs-lookup"><span data-stu-id="25330-183">IID</span></span><br/>     | <span data-ttu-id="25330-184">IID \_ ISession est défini en tant que 000C109E-0000-0000-C000-000000000046</span><span class="sxs-lookup"><span data-stu-id="25330-184">IID\_ISession is defined as 000C109E-0000-0000-C000-000000000046</span></span><br/>                                                                                                                                                                             |



## <a name="see-also"></a><span data-ttu-id="25330-185">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="25330-185">See also</span></span>

<dl> <dt>

[<span data-ttu-id="25330-186">Exemples de scripts Windows Installer</span><span class="sxs-lookup"><span data-stu-id="25330-186">Windows Installer Scripting Examples</span></span>](windows-installer-scripting-examples.md)
</dt> </dl>

 

 




