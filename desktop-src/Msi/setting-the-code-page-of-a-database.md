---
description: Définissez toujours la page de codes d’une base de données avant d’ajouter des informations de localisation.
ms.assetid: 0d8aee30-989a-4093-8718-1bb90029c0fb
title: Définition de la page de codes d’une base de données
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87ef04c2969d0933c4601bbca2f3897d86de43a1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103753005"
---
# <a name="setting-the-code-page-of-a-database"></a><span data-ttu-id="4a37f-103">Définition de la page de codes d’une base de données</span><span class="sxs-lookup"><span data-stu-id="4a37f-103">Setting the Code Page of a Database</span></span>

<span data-ttu-id="4a37f-104">Définissez toujours la page de codes d’une base de données avant d’ajouter des informations de localisation.</span><span class="sxs-lookup"><span data-stu-id="4a37f-104">Always set the code page of a database prior to adding any localization information.</span></span> <span data-ttu-id="4a37f-105">La tentative de définition de la page de codes après l’entrée de données dans la base de données n’est pas recommandée, car cela peut corrompre des caractères étendus.</span><span class="sxs-lookup"><span data-stu-id="4a37f-105">Attempting to set the code page after entering data into the database is not recommended because this could corrupt extended characters.</span></span> <span data-ttu-id="4a37f-106">La localisation peut être facilement facilitée en commençant par une base de données qui est indépendante de la page de codes.</span><span class="sxs-lookup"><span data-stu-id="4a37f-106">Localization can be greatly facilitated by starting with a database that is code page neutral.</span></span> <span data-ttu-id="4a37f-107">Pour plus d’informations, consultez [création d’une base de données avec une page de codes neutre](creating-a-database-with-a-neutral-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="4a37f-107">For details, see [Creating a database with a neutral code page](creating-a-database-with-a-neutral-code-page.md).</span></span> <span data-ttu-id="4a37f-108">Vous pouvez déterminer la page de codes actuelle d’une base de données comme décrit dans détermination de la [page de codes d’une base de données d’installation](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="4a37f-108">You may determine the current code page of a database as described in [Determining an installation database's code page](determining-an-installation-database-s-code-page.md).</span></span> <span data-ttu-id="4a37f-109">Consultez [localisation des tables Error et ActionText](localizing-the-error-and-actiontext-tables.md) pour obtenir la liste des pages de codes numériques.</span><span class="sxs-lookup"><span data-stu-id="4a37f-109">See [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md) for a list of numeric code pages.</span></span>

<span data-ttu-id="4a37f-110">Vous pouvez définir la page de codes d’une base de données vide ou d’une base de données avec une page de codes neutre, en important un fichier d’archive de texte contenant une page de codes non neutre avec [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="4a37f-110">You may set the code page of a blank database, or a database with a neutral code page, by importing a text archive file having a non-neutral code page with [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="4a37f-111">Cela permet de définir la page de codes de la base de données sur la page de codes du fichier importé.</span><span class="sxs-lookup"><span data-stu-id="4a37f-111">This sets the code page of the database to the imported file's code page.</span></span> <span data-ttu-id="4a37f-112">Tous les fichiers d’archive qui sont ensuite importés dans la base de données doivent avoir la même page de codes que le premier fichier.</span><span class="sxs-lookup"><span data-stu-id="4a37f-112">All archive files subsequently imported into the database must then have the same code page as the first file.</span></span> <span data-ttu-id="4a37f-113">Si un fichier d’archive de texte est exporté à partir d’une base de données, la page de codes du fichier d’archive est la même que la base de données parente.</span><span class="sxs-lookup"><span data-stu-id="4a37f-113">If a text archive file is exported from a database, the code page of the archive file is the same as the parent database.</span></span> <span data-ttu-id="4a37f-114">Consultez [gestion des pages de codes des tables importées et exportées](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="4a37f-114">See [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

<span data-ttu-id="4a37f-115">La page de codes d’une base de données peut être définie sur une page de codes numérique spécifiée à l’aide de [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) pour importer un fichier d’archive de texte au format suivant : deux lignes vides ; suivi d’une ligne contenant la page de codes numérique, d’un délimiteur de tabulation et de la chaîne exacte : \_ ForceCodepage.</span><span class="sxs-lookup"><span data-stu-id="4a37f-115">The code page of any database may be set to a specified numeric code page by using [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) to import a text archive file with the following format: Two blank lines; followed by a line containing the numeric code page, a tab delimiter, and the exact string: \_ForceCodepage.</span></span> <span data-ttu-id="4a37f-116">Notez que, avec Windows 2000, toutes les chaînes de la base de données sont traduites en page de codes de \_ ForceCodepage.</span><span class="sxs-lookup"><span data-stu-id="4a37f-116">Note that with Windows 2000, this translates all of the strings in the database to the code page of \_ForceCodepage.</span></span> <span data-ttu-id="4a37f-117">Cela peut être prévu lors de la localisation d’une base de données existante et de la conversion de toutes les chaînes non neutres vers la nouvelle page de codes.</span><span class="sxs-lookup"><span data-stu-id="4a37f-117">This may be intended when localizing an existing database and translating all non-neutral strings to the new code page.</span></span> <span data-ttu-id="4a37f-118">Toutefois, cela génère une erreur si la base de données contient des chaînes non neutres qui ne doivent pas être traduites.</span><span class="sxs-lookup"><span data-stu-id="4a37f-118">However, this causes an error if the database contains non-neutral strings that are not to be translated.</span></span>

<span data-ttu-id="4a37f-119">L’utilitaire WiLangId.vbs fournit un exemple de la façon de définir la page de codes d’un package à l’aide de la [**méthode Import**](database-import.md).</span><span class="sxs-lookup"><span data-stu-id="4a37f-119">The utility WiLangId.vbs provides an example of how to set the code page of a package using the [**Import method**](database-import.md).</span></span> <span data-ttu-id="4a37f-120">Une copie de WiLangId.vbs est fournie dans le kit de développement logiciel (SDK) Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="4a37f-120">A copy of WiLangId.vbs is provided in the Windows Installer SDK.</span></span> <span data-ttu-id="4a37f-121">Vous pouvez utiliser cet utilitaire pour déterminer les versions de langue prises en charge par la base de données (package), la langue utilisée par le programme d’installation pour toutes les chaînes de l’interface utilisateur qui ne sont pas créées dans la base de données (produit) ou la page de codes ANSI unique pour le pool de chaînes (CodePage).</span><span class="sxs-lookup"><span data-stu-id="4a37f-121">You can use this utility to determine the language versions that are supported by the database (Package), the language the installer uses for any strings in the user interface that are not authored into the database (Product), or the single ANSI code page for the string pool (Codepage).</span></span> <span data-ttu-id="4a37f-122">Pour plus d’informations sur l’utilisation de WiLangId.vbs consultez la page d’aide : [gérer la langue et la page de codes](manage-language-and-codepage.md).</span><span class="sxs-lookup"><span data-stu-id="4a37f-122">For information on using WiLangId.vbs see the help page: [Manage Language and Codepage](manage-language-and-codepage.md).</span></span>

<span data-ttu-id="4a37f-123">Pour déterminer les valeurs du produit, du package et de la page de codes, exécutez WiLangId.vbs comme suit.</span><span class="sxs-lookup"><span data-stu-id="4a37f-123">To determine the values of Product, Package, and Codepage, run WiLangId.vbs as follows.</span></span>

<span data-ttu-id="4a37f-124">**cscript wilangid.vbs** *\[ chemin d’accès \] à la base de données*</span><span class="sxs-lookup"><span data-stu-id="4a37f-124">**cscript wilangid.vbs** *\[path to database\]*</span></span>

<span data-ttu-id="4a37f-125">Pour définir la page de codes du package, exécutez la ligne de commande suivante.</span><span class="sxs-lookup"><span data-stu-id="4a37f-125">To set the Codepage of the package run the following command line.</span></span>

<span data-ttu-id="4a37f-126">**cscript wilangid.vbs** *\[ chemin d’accès \] à la page* *\[ \]* de **codes** de la base de données</span><span class="sxs-lookup"><span data-stu-id="4a37f-126">**cscript wilangid.vbs** *\[path to database\]* **Codepage** *\[value\]*</span></span>

<span data-ttu-id="4a37f-127">Par exemple, pour définir la page de codes de test.msi sur la valeur de page de codes ANSI numérique 1252, exécutez la ligne de commande suivante.</span><span class="sxs-lookup"><span data-stu-id="4a37f-127">For example, to set the Codepage of test.msi to the numeric ANSI code page value 1252, run the following command line.</span></span>

<span data-ttu-id="4a37f-128">**cscript wilangid.vbs c : \\ temp \\test.msi CodePage 1252**</span><span class="sxs-lookup"><span data-stu-id="4a37f-128">**cscript wilangid.vbs c:\\temp\\test.msi Codepage 1252**</span></span>

 

 



