---
description: Les informations contenues dans cette rubrique identifient les instructions recommandées pour la mise à jour des assemblys à l’aide de Windows Installer correctifs.
ms.assetid: 60c70d48-aae2-4ea5-a880-ac9e2c83c28c
title: Mise à jour des assemblys
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35b185a9943ba20c81a1fa3431dd590eb05648c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104042849"
---
# <a name="updating-assemblies"></a><span data-ttu-id="23764-103">Mise à jour des assemblys</span><span class="sxs-lookup"><span data-stu-id="23764-103">Updating Assemblies</span></span>

<span data-ttu-id="23764-104">Les informations contenues dans cette rubrique identifient les instructions recommandées pour la mise à jour des assemblys à l’aide de Windows Installer correctifs.</span><span class="sxs-lookup"><span data-stu-id="23764-104">The information in this topic identifies the recommended guidelines for updating assemblies using Windows Installer patches.</span></span>

<span data-ttu-id="23764-105">Les auteurs des mises à jour d’assembly peuvent utiliser les instructions suivantes, qui s’appliquent à tous les types d’assemblys :</span><span class="sxs-lookup"><span data-stu-id="23764-105">Authors of assembly updates can use the following guidelines, which apply to all types of assemblies:</span></span>

-   <span data-ttu-id="23764-106">La méthode recommandée pour la mise à jour d’un assembly consiste à modifier le nom fort de l’assembly dans la [table MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="23764-106">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span> <span data-ttu-id="23764-107">La nouvelle version de l’assembly peut être fournie par un nouveau composant ou par le composant qui fournit l’ancienne version.</span><span class="sxs-lookup"><span data-stu-id="23764-107">The new assembly version can be provided by a new component or by the same component that provides the old version.</span></span>
-   <span data-ttu-id="23764-108">Si la nouvelle version de l’assembly est fournie par le même composant, ne modifiez pas le type d’assembly d’un assembly .NET Framework à un assembly Win32, ou vice versa.</span><span class="sxs-lookup"><span data-stu-id="23764-108">If the new assembly version is provided by the same component, do not change the assembly type from a .NET Framework assembly to a Win32 assembly or vice versa.</span></span>
-   <span data-ttu-id="23764-109">Si toutes les applications du système doivent utiliser l’assembly mis à jour, vous devez déployer un assembly de stratégie.</span><span class="sxs-lookup"><span data-stu-id="23764-109">If all applications on the system must use the updated assembly, you should deploy a policy assembly.</span></span> <span data-ttu-id="23764-110">Un assembly de stratégie peut rediriger les applications sur le système pour utiliser la nouvelle version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-110">A policy assembly can redirect applications on the system to use the new assembly version.</span></span> <span data-ttu-id="23764-111">Les assemblys de stratégie doivent être fournis en créant un nouveau composant.</span><span class="sxs-lookup"><span data-stu-id="23764-111">Policy assemblies should be provided by creating a new component.</span></span>
-   <span data-ttu-id="23764-112">Windows Installer 3,0 ou version ultérieure est requis pour désinstaller les mises à jour d’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-112">Windows Installer 3.0 or later is required to uninstall assembly updates.</span></span> <span data-ttu-id="23764-113">Pour plus d’informations, consultez [Suppression de correctifs](removing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="23764-113">For more information, see [Removing Patches](removing-patches.md).</span></span>
-   <span data-ttu-id="23764-114">La version la plus récente de l’assembly doit contenir des versions identiques ou supérieures des fichiers des assemblys précédemment publiés.</span><span class="sxs-lookup"><span data-stu-id="23764-114">The newer version of the assembly should contain the same or higher versions of files from previously released assemblies.</span></span>
-   <span data-ttu-id="23764-115">Windows Installer 3,0 peut traiter les assemblys .NET Framework et Win32 par un remplacement de fichier complet ou par une mise à jour Delta plus petite.</span><span class="sxs-lookup"><span data-stu-id="23764-115">Windows Installer 3.0 can service .NET Framework and Win32 assemblies by a complete file replacement or by a smaller delta update.</span></span> <span data-ttu-id="23764-116">Pour plus d’informations, consultez réduction de la [taille des correctifs](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="23764-116">For more information, see [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="23764-117">Si votre mise à jour modifie le nom fort de l’assembly, la table [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) et la table [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) sont obligatoires si le package de correctifs n’a pas de table [MsiPatchSequence](msipatchsequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="23764-117">If your update changes the strong name of the assembly, the [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) table and [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) table are required if the patch package does not have a [MsiPatchSequence](msipatchsequence-table.md) table.</span></span> <span data-ttu-id="23764-118">La table MsiPatchOldAssemblyFile et la table MsiPatchOldAssemblyName ne sont pas requises si le package correctif contient des informations de séquencement de correctifs dans une table MsiPatchSequence.</span><span class="sxs-lookup"><span data-stu-id="23764-118">The MsiPatchOldAssemblyFile table and MsiPatchOldAssemblyName table are not required if the patch package has patch sequencing information in a MsiPatchSequence table.</span></span>
-   <span data-ttu-id="23764-119">Avant de publier un nouveau correctif, testez le correctif en l’appliquant à tous les correctifs précédemment publiés.</span><span class="sxs-lookup"><span data-stu-id="23764-119">Before releasing a new patch, test the patch by applying it with all previously released patches.</span></span>

## <a name="updating-win32-assemblies"></a><span data-ttu-id="23764-120">Mise à jour des assemblys Win32</span><span class="sxs-lookup"><span data-stu-id="23764-120">Updating Win32 Assemblies</span></span>

<span data-ttu-id="23764-121">Lorsque vous mettez à jour des assemblys Win32, suivez les instructions ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="23764-121">Use the following guidelines when you update Win32 assemblies:</span></span>

-   <span data-ttu-id="23764-122">Modifiez le nom fort du nouvel assembly qui est spécifié dans la [table MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="23764-122">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="23764-123">Si vous souhaitez que votre application utilise toujours la nouvelle version de l’assembly sans affecter la version de l’assembly utilisée par d’autres applications sur le système, utilisez le même composant pour contenir la nouvelle version de l’assembly que vous avez utilisée pour l’ancienne version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-123">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="23764-124">Conservez le même ID de [composant](component-table.md) dans la table des composants.</span><span class="sxs-lookup"><span data-stu-id="23764-124">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="23764-125">Une fois votre application corrigée, elle contient uniquement une référence à la nouvelle version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-125">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="23764-126">L’ancienne version de l’assembly peut être conservée avec la nouvelle version dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="23764-126">The old version of the assembly can remain with the new version in the global assembly cache.</span></span> <span data-ttu-id="23764-127">Cela n’affecte pas les autres applications du système qui utilisent l’ancienne version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-127">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="23764-128">Lorsque le même composant est utilisé à la fois pour les versions nouvelles et anciennes de l’assembly, votre mise à jour peut être un correctif Delta plus petit.</span><span class="sxs-lookup"><span data-stu-id="23764-128">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="23764-129">Si la nouvelle version de l’assembly n’est pas compatible avec tous les systèmes sur lesquels vous souhaitez installer votre application, vous pouvez installer les versions nouvelles et anciennes de l’assembly en tant qu’assemblys côte à côte.</span><span class="sxs-lookup"><span data-stu-id="23764-129">If the new version of the assembly is not compatible with all the systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="23764-130">Pour installer les deux versions d’assembly côte à côte, créez un nouveau composant pour contenir la nouvelle version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-130">To install both assembly versions side-by-side, create a new component to contain the new assembly version.</span></span> <span data-ttu-id="23764-131">L’ID de composant dans la table des [composants](component-table.md) du nouveau composant doit être différent de l’ID de composant du composant avec l’ancienne version.</span><span class="sxs-lookup"><span data-stu-id="23764-131">The ComponentId in the [Component](component-table.md) table for the new component should be different from the ComponentId of the component with the old version.</span></span> <span data-ttu-id="23764-132">Une fois votre application corrigée, elle contient des références aux deux versions de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-132">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="23764-133">L’application peut ensuite être dirigée vers la version compatible de l’assembly par un manifeste.</span><span class="sxs-lookup"><span data-stu-id="23764-133">Then the application can be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="23764-134">Lorsque différents composants sont utilisés pour les versions nouvelles et anciennes de l’assembly, votre mise à jour utilise le remplacement de fichier complet.</span><span class="sxs-lookup"><span data-stu-id="23764-134">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>

## <a name="updating-net-framework-assemblies"></a><span data-ttu-id="23764-135">Mise à jour des assemblys de .NET Framework</span><span class="sxs-lookup"><span data-stu-id="23764-135">Updating .NET Framework Assemblies</span></span>

<span data-ttu-id="23764-136">Utilisez les instructions suivantes lorsque vous mettez à jour des assemblys .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="23764-136">Use the following guidelines when you update .NET Framework assemblies.</span></span>

-   <span data-ttu-id="23764-137">Modifiez le nom fort du nouvel assembly qui est spécifié dans la [table MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="23764-137">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="23764-138">Si vous souhaitez que votre application utilise toujours la nouvelle version de l’assembly sans affecter la version de l’assembly utilisée par d’autres applications sur le système, modifiez le nom fort du nouvel assembly qui est spécifié dans la [table MsiAssemblyName](msiassemblyname-table.md)et utilisez le même composant pour contenir la nouvelle version de l’assembly que celle utilisée pour l’ancienne version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-138">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="23764-139">Conservez le même ID de [composant](component-table.md) dans la table des composants.</span><span class="sxs-lookup"><span data-stu-id="23764-139">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="23764-140">Une fois votre application corrigée, elle contient uniquement une référence à la nouvelle version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-140">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="23764-141">L’ancienne version de l’assembly peut être conservée avec la nouvelle version dans le cache global.</span><span class="sxs-lookup"><span data-stu-id="23764-141">The old version of the assembly can remain with the new version in the global cache.</span></span> <span data-ttu-id="23764-142">Cela n’affecte pas les autres applications du système qui utilisent l’ancienne version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-142">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="23764-143">Lorsque le même composant est utilisé à la fois pour les versions nouvelles et anciennes de l’assembly, votre mise à jour peut être un correctif Delta plus petit.</span><span class="sxs-lookup"><span data-stu-id="23764-143">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="23764-144">Si la nouvelle version de l’assembly n’est pas compatible avec tous les systèmes sur lesquels vous souhaitez installer votre application, vous pouvez installer les versions nouvelles et anciennes de l’assembly en tant qu’assemblys côte à côte.</span><span class="sxs-lookup"><span data-stu-id="23764-144">If the new version of the assembly is not compatible with all systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="23764-145">Pour installer les deux versions d’assembly côte à côte, modifiez le nom fort du nouvel assembly qui est spécifié dans la [table MsiAssemblyName](msiassemblyname-table.md), puis créez un nouveau composant pour contenir la nouvelle version de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-145">To install both assembly versions side-by-side, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and create a new component to contain the new assembly version.</span></span> <span data-ttu-id="23764-146">L’ID de composant dans la table des [composants](component-table.md) du nouveau composant doit être différent de l’ID de composant du composant avec l’ancienne version.</span><span class="sxs-lookup"><span data-stu-id="23764-146">The ComponentId in the [Component](component-table.md) table for the new component should be different than the ComponentId of the component with the old version.</span></span> <span data-ttu-id="23764-147">Une fois votre application corrigée, elle contient des références aux deux versions de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-147">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="23764-148">L’application peut ensuite être dirigée vers la version compatible de l’assembly par un manifeste.</span><span class="sxs-lookup"><span data-stu-id="23764-148">The application can then be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="23764-149">Lorsque différents composants sont utilisés pour les versions nouvelles et anciennes de l’assembly, votre mise à jour utilise le remplacement de fichier complet.</span><span class="sxs-lookup"><span data-stu-id="23764-149">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>
-   <span data-ttu-id="23764-150">Une mise à jour sur place remplace la copie d’un assembly .NET Framework dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="23764-150">An in-place update overwrites the copy of a .NET Framework Assembly in the global assembly cache.</span></span> <span data-ttu-id="23764-151">Ce type de mise à jour d’assembly ne change pas le nom fort de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="23764-151">This type of assembly update does not change the strong name of the assembly.</span></span> <span data-ttu-id="23764-152">Seule la valeur du champ FileVersion de la [table MsiAssemblyName](msiassemblyname-table.md) est modifiée.</span><span class="sxs-lookup"><span data-stu-id="23764-152">Only the value in the FileVersion field of the [MsiAssemblyName table](msiassemblyname-table.md) is changed.</span></span> <span data-ttu-id="23764-153">La mise à jour sur place d’un assembly .NET Framework nécessite .NET Framework 1,1 SP1 ou une version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="23764-153">The in-place update of a .NET Framework Assembly requires .NET Framework 1.1 SP1 or greater.</span></span>
    > [!Note]  
    > <span data-ttu-id="23764-154">Le type de mise à jour sur place remplace la copie de l’assembly dans le cache global et peut arrêter d’autres applications si la nouvelle version de l’assembly n’est pas totalement compatible avec le niveau de compatibilité descendante.</span><span class="sxs-lookup"><span data-stu-id="23764-154">The in-place type of update overwrites the copy of the assembly in the global cache, and can break other applications if the new version of the assembly is not completely backward compatible.</span></span> <span data-ttu-id="23764-155">La méthode recommandée pour la mise à jour d’un assembly consiste à modifier le nom fort de l’assembly dans la [table MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="23764-155">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

     

 

 



