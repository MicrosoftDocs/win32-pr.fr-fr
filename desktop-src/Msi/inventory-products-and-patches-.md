---
description: 'Les utilisateurs et les applications avec des privilèges d’administrateur peuvent utiliser Windows Installer fonctions pour inventorier les applications Windows Installer, les fonctionnalités, les composants et les correctifs installés sur le système. À partir de Windows Installer&\# 160 ; 3.0, les utilisateurs et les applications qui possèdent des privilèges d’administrateur peuvent énumérer les applications, les fonctionnalités, les composants et les correctifs Windows Installer installés sur le système par tous les utilisateurs. Les administrateurs et les applications peuvent obtenir des informations sur un produit ou un correctif pour un utilisateur spécifique ou tous les utilisateurs du système. Les applications peuvent obtenir l’état de la fonctionnalité ou l’état du composant pour un utilisateur particulier. Les fonctions d’inventaire disponibles à partir de Windows Installer&\# 160 ; 3.0 peuvent limiter l’étendue des éléments à rechercher dans le contexte de l’installation et le contexte de l’utilisateur. Il existe trois contextes d’installation possibles : par utilisateur, par ordinateur et par utilisateur. Le contexte de l’utilisateur peut être un utilisateur particulier ou tous les utilisateurs du système. Les versions de la Windows Installer fonctions d’inventaire antérieures à Windows Installer&\# 160 ; 3.0 peuvent uniquement énumérer les éléments installés sur le système dans le contexte de l’ordinateur ou dans le contexte par utilisateur de l’utilisateur actuel. Cette limitation empêche un inventaire complet de tous les produits Windows Installer et des correctifs installés dans le système par des utilisateurs autres que l’utilisateur actuel. Énumération des informations d’État du composant InformationObtaining ProductsEnumerating PatchesObtaining Product InformationObtaining patch InformationObtaining'
ms.assetid: ef95c3c8-b4c8-4305-8aa2-07ec74b3121b
title: Utilisation de Windows Installer pour inventorier des produits et des correctifs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7915a8a58954c2e07a3dae9536ed7bae399e416b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104525162"
---
# <a name="using-windows-installer-to-inventory-products-and-patches"></a><span data-ttu-id="140b9-109">Utilisation de Windows Installer pour inventorier des produits et des correctifs</span><span class="sxs-lookup"><span data-stu-id="140b9-109">Using Windows Installer to Inventory Products and Patches</span></span>

<span data-ttu-id="140b9-110">Les utilisateurs et les applications avec des privilèges d’administrateur peuvent utiliser Windows Installer fonctions pour inventorier les applications Windows Installer, les fonctionnalités, les composants et les correctifs installés sur le système.</span><span class="sxs-lookup"><span data-stu-id="140b9-110">Users and applications with administrative privileges can use Windows Installer functions to inventory the Windows Installer applications, features, components and patches installed on the system.</span></span>

<span data-ttu-id="140b9-111">À partir de Windows Installer 3,0, les utilisateurs et les applications qui possèdent des privilèges d’administrateur peuvent énumérer les Windows Installer applications, fonctionnalités, composants et correctifs installés sur le système par tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="140b9-111">Beginning with Windows Installer 3.0, users and applications that have administrator privileges can enumerate the Windows Installer applications, features, components and patches installed on the system by all users.</span></span> <span data-ttu-id="140b9-112">Les administrateurs et les applications peuvent obtenir des informations sur un produit ou un correctif pour un utilisateur spécifique ou tous les utilisateurs du système.</span><span class="sxs-lookup"><span data-stu-id="140b9-112">Administrators and applications can obtain information on a product or patch for a particular user or all users in the system.</span></span> <span data-ttu-id="140b9-113">Les applications peuvent obtenir l’état de la fonctionnalité ou l’état du composant pour un utilisateur particulier.</span><span class="sxs-lookup"><span data-stu-id="140b9-113">Applications can obtain the feature state or component state for a particular user.</span></span>

<span data-ttu-id="140b9-114">Les fonctions d’inventaire disponibles à partir de Windows Installer 3,0 peuvent limiter l’étendue des éléments à rechercher dans le contexte de l’installation et dans le contexte de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="140b9-114">The inventory functions available beginning with Windows Installer 3.0 can limit the scope of items to be found by installation context and user context.</span></span> <span data-ttu-id="140b9-115">Il existe trois contextes d’installation possibles : par utilisateur, par ordinateur et par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="140b9-115">There are three possible installation contexts: per-user, per-machine, and per-user managed.</span></span> <span data-ttu-id="140b9-116">Le contexte de l’utilisateur peut être un utilisateur particulier ou tous les utilisateurs du système.</span><span class="sxs-lookup"><span data-stu-id="140b9-116">The user context can be a particular user or all users in the system.</span></span>

<span data-ttu-id="140b9-117">Les versions des fonctions d’inventaire Windows Installer antérieures à Windows Installer 3,0 peuvent uniquement énumérer les éléments installés sur le système dans le contexte de l’ordinateur ou dans le contexte par utilisateur de l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="140b9-117">The versions of the Windows Installer inventory functions earlier than Windows Installer 3.0 can only enumerate items installed on the system in the machine context or in the per-user context of the current user.</span></span> <span data-ttu-id="140b9-118">Cette limitation empêche un inventaire complet de tous les produits Windows Installer et des correctifs installés dans le système par des utilisateurs autres que l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="140b9-118">This limitation prevents a complete inventory of all Windows Installer products and patches installed in the system by users other than the current user.</span></span>

-   [<span data-ttu-id="140b9-119">Énumération des produits</span><span class="sxs-lookup"><span data-stu-id="140b9-119">Enumerating Products</span></span>](#enumerating-products)
-   [<span data-ttu-id="140b9-120">Énumération des correctifs</span><span class="sxs-lookup"><span data-stu-id="140b9-120">Enumerating Patches</span></span>](#enumerating-patches)
-   [<span data-ttu-id="140b9-121">Obtention d’informations sur le produit</span><span class="sxs-lookup"><span data-stu-id="140b9-121">Obtaining Product Information</span></span>](#obtaining-product-information)
-   [<span data-ttu-id="140b9-122">Obtention d’informations sur les correctifs</span><span class="sxs-lookup"><span data-stu-id="140b9-122">Obtaining Patch Information</span></span>](#obtaining-patch-information)
-   [<span data-ttu-id="140b9-123">Obtention d’informations sur l’état du composant</span><span class="sxs-lookup"><span data-stu-id="140b9-123">Obtaining Component State Information</span></span>](#obtaining-component-state-information)
-   [<span data-ttu-id="140b9-124">Obtention d’informations sur l’état des fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="140b9-124">Obtaining Feature State Information</span></span>](#obtaining-feature-state-information)

## <a name="enumerating-products"></a><span data-ttu-id="140b9-125">Énumération des produits</span><span class="sxs-lookup"><span data-stu-id="140b9-125">Enumerating Products</span></span>

<span data-ttu-id="140b9-126">Utilisez la fonction [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) pour énumérer Windows Installer les applications qui sont installées dans le système.</span><span class="sxs-lookup"><span data-stu-id="140b9-126">Use the [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) function to enumerate Windows Installer applications that are installed in the system.</span></span> <span data-ttu-id="140b9-127">Cette fonction peut trouver toutes les installations par ordinateur et les installations par utilisateur des applications (gérées et non gérées) pour l’utilisateur actuel et les autres utilisateurs du système.</span><span class="sxs-lookup"><span data-stu-id="140b9-127">This function can find all the per-machine installations and per-user installations of applications (managed and unmanaged) for the current user and other users in the system.</span></span> <span data-ttu-id="140b9-128">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-128">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="140b9-129">Vous pouvez spécifier n’importe quelle combinaison des contextes d’installation possibles.</span><span class="sxs-lookup"><span data-stu-id="140b9-129">You can specify any one or any combination of the possible installation contexts.</span></span> <span data-ttu-id="140b9-130">Utilisez le paramètre *szUserSid* pour spécifier le contexte utilisateur des applications à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-130">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

## <a name="enumerating-patches"></a><span data-ttu-id="140b9-131">Énumération des correctifs</span><span class="sxs-lookup"><span data-stu-id="140b9-131">Enumerating Patches</span></span>

<span data-ttu-id="140b9-132">Utilisez la fonction [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) pour rechercher les correctifs appliqués à une application.</span><span class="sxs-lookup"><span data-stu-id="140b9-132">Use the [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) function to find patches applied for an application.</span></span> <span data-ttu-id="140b9-133">Cette fonction peut rechercher les correctifs appliqués à une application particulière ou à toutes les applications du système.</span><span class="sxs-lookup"><span data-stu-id="140b9-133">This function can find patches applied for a particular application or for all applications in the system.</span></span> <span data-ttu-id="140b9-134">Cette fonction peut trouver les correctifs appliqués à toutes les installations par ordinateur et aux installations par utilisateur des applications (gérées et non gérées) pour l’utilisateur actuel et les autres utilisateurs du système.</span><span class="sxs-lookup"><span data-stu-id="140b9-134">This function can find patches applied to all the per-machine installations and per-user installations of applications (managed and unmanaged) for the current user and other users in the system.</span></span>

<span data-ttu-id="140b9-135">Vous pouvez utiliser le contexte d’installation et le contexte utilisateur pour limiter l’énumération des correctifs à un contexte particulier ou dans tous les contextes.</span><span class="sxs-lookup"><span data-stu-id="140b9-135">You can use the installation context and user context to restrict the patch enumeration to a particular context or across all contexts.</span></span> <span data-ttu-id="140b9-136">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-136">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="140b9-137">Vous pouvez spécifier n’importe quelle combinaison des contextes d’installation possibles.</span><span class="sxs-lookup"><span data-stu-id="140b9-137">You can specify any one or any combination of the possible installation contexts.</span></span> <span data-ttu-id="140b9-138">Utilisez le paramètre *szUserSid* pour spécifier le contexte utilisateur des applications à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-138">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

<span data-ttu-id="140b9-139">**Pour énumérer les correctifs appliqués à tous les produits publiés ou installés par tous les utilisateurs du système**</span><span class="sxs-lookup"><span data-stu-id="140b9-139">**To enumerate patches applied for all products advertised or installed by all users in the system**</span></span>

-   <span data-ttu-id="140b9-140">Appelez la fonction [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) .</span><span class="sxs-lookup"><span data-stu-id="140b9-140">Call the [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) function.</span></span>
    -   <span data-ttu-id="140b9-141">Utilisez **null** pour la valeur du paramètre *szProductCode* .</span><span class="sxs-lookup"><span data-stu-id="140b9-141">Use **NULL** for the value of the *szProductCode* parameter.</span></span>
    -   <span data-ttu-id="140b9-142">Utilisez « s-1-1-0 » pour la valeur du paramètre *szUserSid* .</span><span class="sxs-lookup"><span data-stu-id="140b9-142">Use "s-1-1-0" for the value of the *szUserSid* parameter.</span></span>
    -   <span data-ttu-id="140b9-143">Utilisez « MSIINSTALLCONTEXT \_ All » pour la valeur du paramètre *dwContext* .</span><span class="sxs-lookup"><span data-stu-id="140b9-143">Use "MSIINSTALLCONTEXT\_ALL" for the value of the *dwContext* parameter.</span></span>

<span data-ttu-id="140b9-144">**Pour énumérer les correctifs appliqués à tous les produits publiés ou installés par tous les utilisateurs du système**</span><span class="sxs-lookup"><span data-stu-id="140b9-144">**To enumerate patches applied for all products advertised or installed by all users in the system**</span></span>

1.  <span data-ttu-id="140b9-145">Appelez la fonction [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) .</span><span class="sxs-lookup"><span data-stu-id="140b9-145">Call the [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) function.</span></span>

    -   <span data-ttu-id="140b9-146">Utilisez **null** pour la valeur du paramètre *szProductCode* .</span><span class="sxs-lookup"><span data-stu-id="140b9-146">Use **NULL** for the value of the *szProductCode* parameter.</span></span>
    -   <span data-ttu-id="140b9-147">Utilisez « s-1-1-0 » pour la valeur du paramètre *szUserSid* .</span><span class="sxs-lookup"><span data-stu-id="140b9-147">Use "s-1-1-0" for the value of the *szUserSid* parameter.</span></span>
    -   <span data-ttu-id="140b9-148">Utilisez « MSIINSTALLCONTEXT \_ All » pour la valeur du paramètre *dwContext* .</span><span class="sxs-lookup"><span data-stu-id="140b9-148">Use "MSIINSTALLCONTEXT\_ALL" for the value of the *dwContext* parameter.</span></span>

    <span data-ttu-id="140b9-149">La fonction fournit un code de produit, un contexte utilisateur et un contexte d’installation pour chaque application trouvée.</span><span class="sxs-lookup"><span data-stu-id="140b9-149">The function provides a product code, user context, and installation context for each application found.</span></span>

2.  <span data-ttu-id="140b9-150">Pour chaque application énumérée à l’étape 1, appelez [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) pour énumérer les correctifs.</span><span class="sxs-lookup"><span data-stu-id="140b9-150">For each application enumerated in step 1, call [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) to enumerate the patches.</span></span>

    <span data-ttu-id="140b9-151">Utilisez les codes de produit, les contextes utilisateur et les contextes d’installation obtenus à partir de [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) pour les valeurs de *szProductCode*, *szUserSid* et *dwContext*, ainsi que pour chaque appel de fonction **MsiEnumProductsEx** .</span><span class="sxs-lookup"><span data-stu-id="140b9-151">Use the product codes, user contexts and installation contexts obtained from [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) for the values of *szProductCode*, *szUserSid*, and *dwContext*, and each **MsiEnumProductsEx** function call.</span></span>

## <a name="obtaining-product-information"></a><span data-ttu-id="140b9-152">Obtention d’informations sur le produit</span><span class="sxs-lookup"><span data-stu-id="140b9-152">Obtaining Product Information</span></span>

<span data-ttu-id="140b9-153">Utilisez la fonction [**MsiGetProductInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) pour obtenir des informations sur les applications publiées ou installées sur le système, ainsi que sur les propriétés qui peuvent être récupérées.</span><span class="sxs-lookup"><span data-stu-id="140b9-153">Use the [**MsiGetProductInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) function to get information about applications that are advertised or installed on the system, and the properties that can be retrieved.</span></span> <span data-ttu-id="140b9-154">Cette fonction peut obtenir des informations sur une instance d’une application installée sous un compte d’utilisateur autre que l’utilisateur actuel, mais ne peut pas interroger une instance d’un produit publié dans un contexte non géré par utilisateur pour un compte d’utilisateur autre que l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="140b9-154">This function can get information for an instance of an application installed under a user account other than the current user, but cannot query an instance of a product that is advertised under a per-user unmanaged context for a user account other than the current user.</span></span>

<span data-ttu-id="140b9-155">Vous pouvez spécifier le contexte d’installation et le contexte utilisateur pour restreindre les informations pour les applications installées dans un contexte particulier.</span><span class="sxs-lookup"><span data-stu-id="140b9-155">You can specify the installation context and user context to restrict information for applications installed in a particular context.</span></span> <span data-ttu-id="140b9-156">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-156">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="140b9-157">Vous ne pouvez spécifier qu’un seul des contextes d’installation possibles.</span><span class="sxs-lookup"><span data-stu-id="140b9-157">You can specify only one of the possible installation contexts.</span></span> <span data-ttu-id="140b9-158">Utilisez le paramètre *szUserSid* pour spécifier le contexte utilisateur des applications à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-158">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

## <a name="obtaining-patch-information"></a><span data-ttu-id="140b9-159">Obtention d’informations sur les correctifs</span><span class="sxs-lookup"><span data-stu-id="140b9-159">Obtaining Patch Information</span></span>

<span data-ttu-id="140b9-160">Une application peut appeler la fonction [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) pour demander des informations sur l’application d’un correctif à une instance spécifiée d’un produit.</span><span class="sxs-lookup"><span data-stu-id="140b9-160">An application can call the [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) function to query for information about the application of a patch to a specified instance of a product.</span></span> <span data-ttu-id="140b9-161">Les propriétés telles que **LocalPackage**, [**transformations**](transforms.md)et **State** peuvent être récupérées à l’aide de cette fonction.</span><span class="sxs-lookup"><span data-stu-id="140b9-161">Properties such as **LocalPackage**, [**Transforms**](transforms.md), and **State** can be retrieved using this function.</span></span> <span data-ttu-id="140b9-162">Il n’est pas garanti que toutes les valeurs de propriété soient disponibles pour les applications non gérées par utilisateur si l’utilisateur n’est pas actuellement connecté à l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="140b9-162">Not all property values are guaranteed to be available for per-user unmanaged applications if the user is not currently logged in to the machine.</span></span> <span data-ttu-id="140b9-163">Vous ne pouvez spécifier qu’un seul des contextes d’installation possibles.</span><span class="sxs-lookup"><span data-stu-id="140b9-163">You can specify only one of the possible installation contexts.</span></span>

<span data-ttu-id="140b9-164">Vous pouvez spécifier le contexte d’installation et le contexte utilisateur pour limiter les informations aux correctifs appliqués aux applications installées dans un contexte particulier.</span><span class="sxs-lookup"><span data-stu-id="140b9-164">You can specify the installation context and user context to restrict information to patches applied to applications installed in a particular context.</span></span> <span data-ttu-id="140b9-165">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-165">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="140b9-166">Vous ne pouvez spécifier qu’un seul des contextes d’installation possibles.</span><span class="sxs-lookup"><span data-stu-id="140b9-166">You can specify only one of the possible installation contexts.</span></span> <span data-ttu-id="140b9-167">Utilisez le paramètre *szUserSid* pour spécifier le contexte utilisateur des applications à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-167">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

## <a name="obtaining-component-state-information"></a><span data-ttu-id="140b9-168">Obtention d’informations sur l’état du composant</span><span class="sxs-lookup"><span data-stu-id="140b9-168">Obtaining Component State Information</span></span>

<span data-ttu-id="140b9-169">Les applications peuvent appeler la fonction [**MsiQueryComponentState**](/windows/desktop/api/Msi/nf-msi-msiquerycomponentstatea) pour obtenir l’état d’installation d’un composant.</span><span class="sxs-lookup"><span data-stu-id="140b9-169">Applications can call the [**MsiQueryComponentState**](/windows/desktop/api/Msi/nf-msi-msiquerycomponentstatea) function to get the installed state for a component.</span></span> <span data-ttu-id="140b9-170">Cette fonction détermine si le composant est installé localement ou s’il est installé pour être exécuté à partir de la source.</span><span class="sxs-lookup"><span data-stu-id="140b9-170">This function determines if the component is installed locally or installed to run from the source.</span></span> <span data-ttu-id="140b9-171">La fonction peut rechercher un composant d’une instance d’une application qui est installée sous des comptes d’utilisateurs autres que l’utilisateur actuel, à condition que le produit ne soit pas publié sous le contexte non géré par utilisateur pour un compte d’utilisateur autre que l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="140b9-171">The function can query for a component of an instance of an application that is installed under user accounts other than the current user, provided that the product is not advertised under the per-user unmanaged context for a user account other than the current user.</span></span>

<span data-ttu-id="140b9-172">Vous pouvez spécifier un contexte d’installation et un contexte utilisateur pour obtenir l’état des composants pour les applications installées dans un contexte particulier.</span><span class="sxs-lookup"><span data-stu-id="140b9-172">You can specify an installation context and user context to get the state of components for applications installed in a particular context.</span></span> <span data-ttu-id="140b9-173">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-173">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="140b9-174">Vous ne pouvez spécifier qu’un seul des contextes d’installation possibles.</span><span class="sxs-lookup"><span data-stu-id="140b9-174">You can specify only one of the possible installation contexts.</span></span> <span data-ttu-id="140b9-175">Utilisez le paramètre *szUserSid* pour spécifier le contexte utilisateur des applications à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-175">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

## <a name="obtaining-feature-state-information"></a><span data-ttu-id="140b9-176">Obtention d’informations sur l’état des fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="140b9-176">Obtaining Feature State Information</span></span>

<span data-ttu-id="140b9-177">Les applications peuvent appeler la fonction [**MsiQueryFeatureStateEx**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa) pour obtenir l’état d’installation d’une fonctionnalité de produit.</span><span class="sxs-lookup"><span data-stu-id="140b9-177">Applications can call the [**MsiQueryFeatureStateEx**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa) function to get the installed state for a product feature.</span></span> <span data-ttu-id="140b9-178">Cette fonction détermine si la fonctionnalité est publiée, installée localement ou installée pour être exécutée à partir de la source.</span><span class="sxs-lookup"><span data-stu-id="140b9-178">This function determines if the feature is advertised, installed locally, or installed to run from the source.</span></span> <span data-ttu-id="140b9-179">La fonction peut être utilisée pour interroger n’importe quelle fonctionnalité d’une instance d’une application installée sous le compte de l’ordinateur ou n’importe quel contexte sous le compte d’utilisateur actuel ou le contexte géré par utilisateur sous n’importe quel compte d’utilisateur autre que l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="140b9-179">The function can be used to query any feature of an instance of an application installed under the machine account or any context under the current user account or the per-user managed context under any user account other than the current user.</span></span> <span data-ttu-id="140b9-180">Cette fonction ne peut pas rechercher une application installée dans le contexte non géré par utilisateur pour un compte d’utilisateur autre que l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="140b9-180">This function cannot query for an application installed under the per-user unmanaged context for a user account other than the current user.</span></span> <span data-ttu-id="140b9-181">Vous ne pouvez spécifier qu’un seul des contextes d’installation possibles.</span><span class="sxs-lookup"><span data-stu-id="140b9-181">You can specify only one of the possible installation contexts.</span></span>

<span data-ttu-id="140b9-182">Vous pouvez spécifier un contexte d’installation et un contexte utilisateur pour obtenir l’état des fonctionnalités pour les applications installées dans un contexte particulier.</span><span class="sxs-lookup"><span data-stu-id="140b9-182">You can specify an installation context and user context to get the state of features for applications installed in a particular context.</span></span> <span data-ttu-id="140b9-183">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-183">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="140b9-184">Vous ne pouvez spécifier qu’un seul des contextes d’installation possibles.</span><span class="sxs-lookup"><span data-stu-id="140b9-184">You can specify only one of the possible installation contexts.</span></span> <span data-ttu-id="140b9-185">Utilisez le paramètre *szUserSid* pour spécifier le contexte utilisateur des applications à trouver.</span><span class="sxs-lookup"><span data-stu-id="140b9-185">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

 

 



