---
description: Les actions personnalisées sont planifiées dans les tables de séquence de la même façon que les actions standard.
ms.assetid: 1aea75b1-a498-405e-9208-91672455496b
title: Séquencement des actions personnalisées
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad7c24fb91247a36880cb808c9b8e10437312cf7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104210765"
---
# <a name="sequencing-custom-actions"></a><span data-ttu-id="54287-103">Séquencement des actions personnalisées</span><span class="sxs-lookup"><span data-stu-id="54287-103">Sequencing Custom Actions</span></span>

<span data-ttu-id="54287-104">Les actions personnalisées sont planifiées dans les tables de séquence de la même façon que les actions standard.</span><span class="sxs-lookup"><span data-stu-id="54287-104">Custom actions are scheduled in sequence tables in the same way as standard actions.</span></span>

<span data-ttu-id="54287-105">**Pour planifier une action personnalisée dans une table de séquences**</span><span class="sxs-lookup"><span data-stu-id="54287-105">**To schedule a custom action in a sequence table**</span></span>

1.  <span data-ttu-id="54287-106">Entrez le nom de l’action personnalisée (qui est la clé primaire de la table [CustomAction](customaction-table.md)) dans la colonne action de la table [Sequence](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="54287-106">Enter the custom action name (which is the primary key of the [CustomAction](customaction-table.md)) table into the Action column of the [Sequence](sequence-table-detailed-example.md) table.</span></span>
2.  <span data-ttu-id="54287-107">Entrez la séquence de l’action personnalisée relative aux autres actions du tableau dans la colonne séquence de la table de [séquences](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="54287-107">Enter the custom action's sequence relative to the other actions in the table into the Sequence column of the [Sequence](sequence-table-detailed-example.md) table.</span></span> <span data-ttu-id="54287-108">Pour plus d’informations sur les tables de séquences, consultez [utilisation d’une table de séquences](using-a-sequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="54287-108">For more information about sequence tables, see [Using a Sequence Table](using-a-sequence-table.md).</span></span>
3.  <span data-ttu-id="54287-109">Pour ignorer conditionnellement l’action, entrez une expression conditionnelle dans la colonne condition de la table [Sequence](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="54287-109">To conditionally skip the action, enter a conditional expression into the Condition column of the [Sequence](sequence-table-detailed-example.md) table.</span></span> <span data-ttu-id="54287-110">Le programme d’installation ignore cette action si l’expression prend la valeur FALSe.</span><span class="sxs-lookup"><span data-stu-id="54287-110">The installer skips this action if the expression evaluates to FALSE.</span></span>

<span data-ttu-id="54287-111">Comme dans le cas d’actions standard, les actions personnalisées qui sont planifiées dans [InstallUISequence](installuisequence-table.md) ou [AdminUISequence](adminuisequence-table.md) s’exécutent uniquement si l’interface utilisateur interne est définie sur le niveau complet.</span><span class="sxs-lookup"><span data-stu-id="54287-111">As in the case of standard actions, custom actions that are scheduled in the [InstallUISequence](installuisequence-table.md) or [AdminUISequence](adminuisequence-table.md) run only if the internal user interface is set to the full level.</span></span> <span data-ttu-id="54287-112">Le niveau de l’interface utilisateur est défini à l’aide de la fonction [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) .</span><span class="sxs-lookup"><span data-stu-id="54287-112">The UI level is set by using the [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) function.</span></span>

<span data-ttu-id="54287-113">Les actions standard et personnalisées planifiées dans les tables [InstallExecuteSequence](installexecutesequence-table.md), [AdminExecuteSequence](adminexecutesequence-table.md)ou [AdvtExecuteSequence](advtexecutesequence-table.md) n’effectuent pas de modifications du système.</span><span class="sxs-lookup"><span data-stu-id="54287-113">Standard and custom actions scheduled in the [InstallExecuteSequence](installexecutesequence-table.md), [AdminExecuteSequence](adminexecutesequence-table.md), or [AdvtExecuteSequence](advtexecutesequence-table.md) tables do not make system changes.</span></span> <span data-ttu-id="54287-114">Au lieu de cela, le programme d’installation met en file d’attente les enregistrements d’exécution dans un script pour une exécution ultérieure pendant le service d’installation.</span><span class="sxs-lookup"><span data-stu-id="54287-114">Instead the installer queues up execution records in a script for subsequent execution during the install service.</span></span> <span data-ttu-id="54287-115">S’il n’existe aucun service d’installation, les actions planifiées dans ces tables sont exécutées dans le même contexte que la séquence d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="54287-115">If there is no install service, then the actions scheduled in these tables are run in the same context as the UI sequence.</span></span>

<span data-ttu-id="54287-116">Si le serveur d’installation n’est pas inscrit, les actions personnalisées sont exécutées côté client.</span><span class="sxs-lookup"><span data-stu-id="54287-116">If the installer server is not registered, the custom actions are executed on the client side.</span></span> <span data-ttu-id="54287-117">Si le serveur est inscrit et utilise le mode d’interface utilisateur complet, les actions personnalisées sont exécutées côté serveur.</span><span class="sxs-lookup"><span data-stu-id="54287-117">If the server is registered and using the full UI mode, then the custom actions are run on the server side.</span></span>

<span data-ttu-id="54287-118">Si vous utilisez l’interface utilisateur complète avec le serveur, les actions initiales antérieures à l’action [InstallValidate](installvalidate-action.md) sont exécutées sur le client pour permettre une interaction complète.</span><span class="sxs-lookup"><span data-stu-id="54287-118">If using full UI with the server, the initial actions prior to the [InstallValidate](installvalidate-action.md) action are run on the client to allow full interaction.</span></span> <span data-ttu-id="54287-119">L’exécution est ensuite basculée vers le serveur qui répète ces actions et exécute les actions d’exécution du script.</span><span class="sxs-lookup"><span data-stu-id="54287-119">Execution is then switched to the server which repeats those actions and runs the script execution actions.</span></span> <span data-ttu-id="54287-120">Cela est suivi par un retour au client pour les actions finales.</span><span class="sxs-lookup"><span data-stu-id="54287-120">This is followed by a return to the client for the final actions.</span></span>

<span data-ttu-id="54287-121">Notez que, si un produit est supprimé en définissant sa fonctionnalité Top sur absent, la propriété [**Remove**](remove.md) ne peut pas être égale à All until après l’action [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="54287-121">Note that if a product is removed by setting its top feature to absent, the [**REMOVE**](remove.md) property may not equal ALL until after the [InstallValidate](installvalidate-action.md) action.</span></span> <span data-ttu-id="54287-122">Cela signifie que toute action personnalisée qui dépend de REMOVE = ALL doit être séquencée après l’action InstallValidate.</span><span class="sxs-lookup"><span data-stu-id="54287-122">This means that any custom action that depends on REMOVE=ALL must be sequenced after the InstallValidate action.</span></span> <span data-ttu-id="54287-123">Une action personnalisée peut vérifier REMOVE pour déterminer si un produit a été configuré pour être complètement désinstallé.</span><span class="sxs-lookup"><span data-stu-id="54287-123">A custom action may check REMOVE to determine whether a product has been set to be completely uninstalled.</span></span>

<span data-ttu-id="54287-124">Les actions personnalisées qui font référence à un fichier installé comme source, telles que le type d’action personnalisé 17 (DLL), le type d’action personnalisé 18 (EXE), le type d’action personnalisée 21 (JScript) et le type d’action personnalisé 22 (VBScript), doivent respecter les restrictions de séquencement suivantes.</span><span class="sxs-lookup"><span data-stu-id="54287-124">Custom actions that reference an installed file as their source, such as Custom Action Type 17 (DLL), Custom Action Type 18 (EXE), Custom Action Type 21 (JScript), and Custom Action Type 22 (VBScript), must adhere to the following sequencing restrictions.</span></span>

-   <span data-ttu-id="54287-125">L’action personnalisée doit être séquencée après l’action [CostFinalize](costfinalize-action.md) afin que le chemin d’accès au fichier référencé puisse être résolu.</span><span class="sxs-lookup"><span data-stu-id="54287-125">The custom action must be sequenced after the [CostFinalize](costfinalize-action.md) action so that the path to the referenced file can be resolved.</span></span>
-   <span data-ttu-id="54287-126">Si le fichier source n’est pas déjà installé sur l’ordinateur, les actions personnalisées différées (dans le script) doivent être séquencées après le [InstallFiles](installfiles-action.md).</span><span class="sxs-lookup"><span data-stu-id="54287-126">If the source file is not already installed on the computer, deferred (in-script) custom actions must be sequenced after the [InstallFiles](installfiles-action.md).</span></span>
-   <span data-ttu-id="54287-127">Si le fichier source n’est pas déjà installé sur l’ordinateur, les actions personnalisées non différées doivent être séquencées après l’action [InstallInitialize](installinitialize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="54287-127">If the source file is not already installed on the computer, nondeferred custom actions must be sequenced after the [InstallInitialize](installinitialize-action.md) action.</span></span>

<span data-ttu-id="54287-128">Les restrictions de séquencement suivantes s’appliquent aux actions personnalisées qui modifient ou mettent à jour un package de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="54287-128">The following sequencing restrictions apply to custom actions that change or update a Windows Installer package.</span></span>

-   <span data-ttu-id="54287-129">Si l’action personnalisée modifie le package, par exemple en ajoutant des lignes à une table, l’action doit être séquencée avant l’action [InstallInitialize](installinitialize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="54287-129">If the custom action changes the package, such as by adding rows to a table, the action must be sequenced before the [InstallInitialize](installinitialize-action.md) action.</span></span>
-   <span data-ttu-id="54287-130">Si l’action personnalisée apporte des modifications susceptibles d’affecter la rentabilité, elle doit être séquencée avant l’action [CostInitialize](costfinalize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="54287-130">If the custom action makes changes that would affect costing, then it should be sequenced before the [CostInitialize](costfinalize-action.md) action.</span></span>
-   <span data-ttu-id="54287-131">Si l’action personnalisée modifie l’état d’installation des fonctionnalités ou des composants, elle doit être séquencée avant l’action [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="54287-131">If the custom action changes the installation state of features or components, it must be sequenced before the [InstallValidate](installvalidate-action.md) action.</span></span>

 

 



