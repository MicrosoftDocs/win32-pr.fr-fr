---
description: Cet exemple montre comment utiliser des actions personnalisées pour créer des comptes d’utilisateur sur un ordinateur local lors de l’installation d’un composant.
ms.assetid: fc06dd7b-46d7-45a0-85b3-26f808c64f89
title: Utilisation d’une action personnalisée pour créer des comptes d’utilisateur sur un ordinateur local
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cfd3bf002c0fa1d661c6bfebb6d1a18cbc4b0652
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104319606"
---
# <a name="using-a-custom-action-to-create-user-accounts-on-a-local-computer"></a><span data-ttu-id="864eb-103">Utilisation d’une action personnalisée pour créer des comptes d’utilisateur sur un ordinateur local</span><span class="sxs-lookup"><span data-stu-id="864eb-103">Using a Custom Action to Create User Accounts on a Local Computer</span></span>

<span data-ttu-id="864eb-104">Cet exemple montre comment utiliser des actions personnalisées pour créer des comptes d’utilisateur sur un ordinateur local lors de l’installation d’un composant.</span><span class="sxs-lookup"><span data-stu-id="864eb-104">This sample demonstrates how to use custom actions to create user accounts on a local computer when installing a component.</span></span> <span data-ttu-id="864eb-105">La suppression d’un composant supprime les comptes d’utilisateurs locaux créés par l’action personnalisée.</span><span class="sxs-lookup"><span data-stu-id="864eb-105">Removal of a component removes the local user accounts created by the custom action.</span></span> <span data-ttu-id="864eb-106">Plusieurs actions personnalisées sont illustrées, notamment des actions personnalisées d' [exécution différée](deferred-execution-custom-actions.md) et des [actions personnalisées de restauration](rollback-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="864eb-106">Several custom actions are demonstrated including [Deferred Execution Custom Actions](deferred-execution-custom-actions.md) and [Rollback Custom Actions](rollback-custom-actions.md).</span></span>

<span data-ttu-id="864eb-107">L’exemple est conforme aux spécifications suivantes.</span><span class="sxs-lookup"><span data-stu-id="864eb-107">The sample meets the following specifications.</span></span>

-   <span data-ttu-id="864eb-108">L’installation de crée des comptes d’utilisateur uniquement si Windows 2000 est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="864eb-108">The installation creates user accounts only if running Windows 2000.</span></span>
-   <span data-ttu-id="864eb-109">L’installation de crée des comptes d’utilisateur uniquement si le composant est en cours d’installation pour s’exécuter localement.</span><span class="sxs-lookup"><span data-stu-id="864eb-109">The installation creates user accounts only if the component is being installed to run locally.</span></span> <span data-ttu-id="864eb-110">Cela empêche la création de comptes d’utilisateur lors de la réparation ou de la réinstallation du composant.</span><span class="sxs-lookup"><span data-stu-id="864eb-110">This precludes creating user accounts during the repair or reinstallation of the component.</span></span>
-   <span data-ttu-id="864eb-111">Le programme d’installation supprime les comptes lorsque le composant est supprimé.</span><span class="sxs-lookup"><span data-stu-id="864eb-111">The Installer removes the accounts when the component is removed.</span></span>
-   <span data-ttu-id="864eb-112">Les informations de compte d’utilisateur sont lues à partir d’une table personnalisée dans la base de données d’installation et ne sont pas codées en dur dans le code d’action personnalisé.</span><span class="sxs-lookup"><span data-stu-id="864eb-112">User account information is read from a custom table in the installation database and is not hard-coded into the custom action code.</span></span>
-   <span data-ttu-id="864eb-113">Étant donné que la création ou la suppression de comptes d’utilisateur requiert des privilèges élevés, certaines des actions personnalisées doivent être en mesure d’apporter des modifications au système qui nécessitent des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="864eb-113">Because the creation or removal of user accounts requires elevated privileges, some of the custom actions must be capable of making changes to the system that require elevated privileges.</span></span> <span data-ttu-id="864eb-114">Ces actions personnalisées doivent être des actions personnalisées différées qui s’exécutent dans le script d’exécution.</span><span class="sxs-lookup"><span data-stu-id="864eb-114">These custom actions must be deferred custom actions that run when in the execution script.</span></span>
-   <span data-ttu-id="864eb-115">Chaque compte a une action personnalisée de restauration pour s’assurer que le compte est supprimé lors de la restauration de l’installation du composant.</span><span class="sxs-lookup"><span data-stu-id="864eb-115">Each account has a rollback custom action to ensure the account is removed on rollback of the component installation.</span></span> <span data-ttu-id="864eb-116">Cela n’inclut pas la restauration d’une suppression de compte lors de la suppression d’un composant.</span><span class="sxs-lookup"><span data-stu-id="864eb-116">This does not include the rollback of an account deletion during the removal of a component.</span></span>
-   <span data-ttu-id="864eb-117">Les actions personnalisées envoient des messages ActionData pour chaque compte créé ou supprimé.</span><span class="sxs-lookup"><span data-stu-id="864eb-117">Custom actions send ActionData messages for each account that is created or removed.</span></span> <span data-ttu-id="864eb-118">Cela n’inclut pas la fourniture de messages de progression pour le ProgressBar.</span><span class="sxs-lookup"><span data-stu-id="864eb-118">This does not include providing progress messages for the ProgressBar.</span></span>
-   <span data-ttu-id="864eb-119">Les actions personnalisées signalent une erreur si un compte ne peut pas être créé.</span><span class="sxs-lookup"><span data-stu-id="864eb-119">Custom actions report an error if an account cannot be created.</span></span>
-   <span data-ttu-id="864eb-120">Le mot de passe du compte est obtenu par le biais de l’interaction de l’utilisateur avec l’interface utilisateur, ou dans le cas d’une installation au niveau de l’interface utilisateur de base ou aucun [niveau d’interface utilisateur](user-interface-levels.md), en tant que propriété passée sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="864eb-120">The password for the account is obtained through the user interaction with the user interface, or in the case of an installation at the Basic UI or None [User Interface Levels](user-interface-levels.md), as a property passed on the command line.</span></span>
-   <span data-ttu-id="864eb-121">Les données sensibles sont masquées dans le fichier journal.</span><span class="sxs-lookup"><span data-stu-id="864eb-121">Sensitive data is hidden from the log file.</span></span>

<span data-ttu-id="864eb-122">L’exemple comprend un composant hypothétique nommé TestAccount.</span><span class="sxs-lookup"><span data-stu-id="864eb-122">The sample includes a hypothetical component named TestAccount.</span></span> <span data-ttu-id="864eb-123">Les sections suivantes supposent que vous avez déjà créé les ressources requises par TestAccount et que vous avez créé les tables de [fonctionnalités](feature-table.md), de [composants](component-table.md), de [fichiers](file-table.md), de [répertoires](directory-table.md)et de [FeatureComponents](featurecomponents-table.md) dans l’exemple de base de données requis pour installer ce composant.</span><span class="sxs-lookup"><span data-stu-id="864eb-123">The discussion in the following sections assumes that you have already created the resources required by TestAccount and have authored the [Feature](feature-table.md), [Component](component-table.md), [File](file-table.md), [Directory](directory-table.md), and [FeatureComponents](featurecomponents-table.md) tables in the sample database required to install this component.</span></span> <span data-ttu-id="864eb-124">Pour plus d’informations, consultez [un exemple d’installation](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="864eb-124">For more information, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="864eb-125">Les rubriques suivantes contiennent des informations sur la façon de créer des actions personnalisées requises et de les ajouter à un package d’installation.</span><span class="sxs-lookup"><span data-stu-id="864eb-125">The following topics contain information about how to create required custom actions and add them to an installation package.</span></span>

-   [<span data-ttu-id="864eb-126">Création des actions personnalisées</span><span class="sxs-lookup"><span data-stu-id="864eb-126">Authoring the Custom Actions</span></span>](authoring-the-custom-actions.md)
-   [<span data-ttu-id="864eb-127">Ajout d’une table CustomUserAccounts personnalisée</span><span class="sxs-lookup"><span data-stu-id="864eb-127">Adding a Custom CustomUserAccounts Table</span></span>](adding-a-custom-customuseraccounts-table.md)
-   [<span data-ttu-id="864eb-128">Création de la table CustomAction</span><span class="sxs-lookup"><span data-stu-id="864eb-128">Authoring the CustomAction Table</span></span>](authoring-the-customaction-table.md)
-   [<span data-ttu-id="864eb-129">Création des tables ActionText et Error</span><span class="sxs-lookup"><span data-stu-id="864eb-129">Authoring the ActionText and Error Tables</span></span>](authoring-the-actiontext-and-error-tables.md)
-   [<span data-ttu-id="864eb-130">Création de la table InstallExecuteSequence</span><span class="sxs-lookup"><span data-stu-id="864eb-130">Authoring the InstallExecuteSequence Table</span></span>](authoring-the-installexecutesequence-table.md)
-   [<span data-ttu-id="864eb-131">Création de l’interface utilisateur pour l’entrée de mot de passe</span><span class="sxs-lookup"><span data-stu-id="864eb-131">Authoring the User Interface for Password Input</span></span>](authoring-the-user-interface-for-password-input.md)
-   [<span data-ttu-id="864eb-132">Sécurisation de l’installation</span><span class="sxs-lookup"><span data-stu-id="864eb-132">Securing the installation</span></span>](securing-the-installation.md)

 

 



