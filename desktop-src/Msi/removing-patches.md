---
description: À partir de Windows Installer&\# 160 ; version&\# 160 ; 3.0, il est possible de créer et d’installer des correctifs qui peuvent être désinstallés séparément et dans n’importe quel ordre, sans avoir à désinstaller et réinstaller l’application entière et les autres correctifs.
ms.assetid: 2ad30ac9-eac9-49cf-98ae-5c053a0b500a
title: Suppression des correctifs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7cd54db3bde3a356a0c3adb299555248bbc87a0b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106534592"
---
# <a name="removing-patches"></a><span data-ttu-id="864fe-103">Suppression des correctifs</span><span class="sxs-lookup"><span data-stu-id="864fe-103">Removing Patches</span></span>

<span data-ttu-id="864fe-104">À partir de Windows Installer version 3,0, il est possible de créer et d’installer des correctifs qui peuvent être désinstallés séparément et dans n’importe quel ordre, sans avoir à désinstaller et réinstaller l’application entière et les autres correctifs.</span><span class="sxs-lookup"><span data-stu-id="864fe-104">Beginning with Windows Installer version 3.0, it is possible to create and install patches that can be uninstalled singly, and in any order, without having to uninstall and reinstall the entire application and other patches.</span></span> <span data-ttu-id="864fe-105">Windows Installer 3,0 permet également de créer des [packages de correctifs](patch-packages.md) à l’aide d’une [table MsiPatchSequence](msipatchsequence-table.md) contenant des informations sur le séquencement des correctifs.</span><span class="sxs-lookup"><span data-stu-id="864fe-105">Windows Installer 3.0 also enables [Patch Packages](patch-packages.md) to be authored with a [MsiPatchSequence Table](msipatchsequence-table.md) that contains patch sequencing information.</span></span> <span data-ttu-id="864fe-106">Avec les versions de Windows Installer antérieures à Windows Installer 3,0, la seule méthode permettant de supprimer des correctifs particuliers d’une application consiste à désinstaller l’ensemble de l’application corrigée, puis à réinstaller sans réappliquer les correctifs en cours de suppression.</span><span class="sxs-lookup"><span data-stu-id="864fe-106">With versions of Windows Installer earlier than Windows Installer 3.0, the only method to remove particular patches from an application is to uninstall the entire patched application and then reinstall without reapplying any patches being removed.</span></span>

<span data-ttu-id="864fe-107">Le fait de pouvoir désinstaller un correctif dépend de la manière dont le correctif a été créé, de la version de Windows Installer utilisée pour installer le correctif et des modifications apportées par le correctif à l’application.</span><span class="sxs-lookup"><span data-stu-id="864fe-107">Whether a patch can be uninstalled depends upon how the patch was authored, the version of Windows Installer used to install the patch, and the changes made by the patch to the application.</span></span> <span data-ttu-id="864fe-108">Si un correctif ne peut pas être installé, le seul moyen de supprimer le correctif consiste à désinstaller l’application entière et à la réinstaller sans appliquer le correctif en cours de suppression.</span><span class="sxs-lookup"><span data-stu-id="864fe-108">If a patch is not uninstallable, then the only way to remove the patch is to uninstall the entire application and reinstall without applying the patch being removed.</span></span>

<span data-ttu-id="864fe-109">Vous pouvez désinstaller un ou plusieurs correctifs à l’aide d’une option de ligne de commande, de l’interface de script ou en appelant [**MsiRemovePatches**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) à partir d’une autre application.</span><span class="sxs-lookup"><span data-stu-id="864fe-109">You can uninstall one or more patches using a command line option, the scripting interface, or by calling [**MsiRemovePatches**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) from another application.</span></span> <span data-ttu-id="864fe-110">Pour plus d’informations sur la désinstallation des correctifs, voir [désinstallation des correctifs](uninstalling-patches.md) .</span><span class="sxs-lookup"><span data-stu-id="864fe-110">See [Uninstalling Patches](uninstalling-patches.md) for more information about how to uninstall patches.</span></span>

<span data-ttu-id="864fe-111">La valeur de la propriété [**MSIPATCHREMOVE**](msipatchremove.md) répertorie les correctifs à désinstaller.</span><span class="sxs-lookup"><span data-stu-id="864fe-111">The value of the [**MSIPATCHREMOVE**](msipatchremove.md) property lists the patches to be uninstalled.</span></span> <span data-ttu-id="864fe-112">Pour chaque correctif de la liste, le programme d’installation vérifie que le correctif n’est pas installé.</span><span class="sxs-lookup"><span data-stu-id="864fe-112">For each patch in the list, the installer verifies that the patch is uninstallable.</span></span> <span data-ttu-id="864fe-113">Si l’utilisateur ne dispose pas des privilèges nécessaires pour supprimer le correctif, si le correctif est inconnu pour le produit, si la stratégie de correctifs empêche la suppression ou si le correctif a été marqué comme ne pouvant pas être installé, le programme d’installation renvoie une erreur indiquant qu’une transaction d’installation a échoué.</span><span class="sxs-lookup"><span data-stu-id="864fe-113">If the user does not have privileges to remove the patch, the patch is unknown for the product, patch policy prevents removal, or the patch was marked as not uninstallable, the installer returns an error that indicates a failed installation transaction.</span></span> <span data-ttu-id="864fe-114">Pour plus d’informations sur les éléments qui déterminent si un correctif ne peut pas être installé, consultez [correctifs non installés](uninstallable-patches.md) .</span><span class="sxs-lookup"><span data-stu-id="864fe-114">See [Uninstallable Patches](uninstallable-patches.md) for more information about what determines whether a patch is not uninstallable.</span></span>

<span data-ttu-id="864fe-115">Une fois que le correctif est vérifié comme étant amovible, le programme d’installation supprime le correctif de la séquence d’application du correctif.</span><span class="sxs-lookup"><span data-stu-id="864fe-115">Once the patch is verified as removable, the installer removes the patch from the patch application sequence.</span></span> <span data-ttu-id="864fe-116">Pour plus d’informations sur la façon dont Windows Installer 3,0 détermine la séquence à utiliser lors de l’application des correctifs, consultez mise en [séquence des correctifs](sequencing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="864fe-116">For more information about how Windows Installer 3.0 determines what sequence to use when applying patches see [Sequencing Patches](sequencing-patches.md).</span></span> <span data-ttu-id="864fe-117">Notez que la suppression de correctifs de la séquence peut entraîner la désactivation des correctifs marqués comme obsolètes ou remplacés.</span><span class="sxs-lookup"><span data-stu-id="864fe-117">Note that removing patches from the sequence can cause patches marked obsolete or superseded to become active.</span></span>

<span data-ttu-id="864fe-118">Tous les correctifs sélectionnés pour la suppression sont répertoriés dans la propriété [**MsiPatchRemovalList**](msipatchremovallist.md) .</span><span class="sxs-lookup"><span data-stu-id="864fe-118">All patches selected for removal are listed in the [**MsiPatchRemovalList**](msipatchremovallist.md) property.</span></span> <span data-ttu-id="864fe-119">Cette propriété est une propriété privée qui est définie par le programme d’installation et peut être utilisée dans les expressions conditionnelles ou interrogée par des [actions personnalisées](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="864fe-119">This property is a private property that is set by the installer and can be used in conditional expressions or queried by [custom actions](custom-actions.md).</span></span> <span data-ttu-id="864fe-120">La propriété contient la liste des GUID de code correctif des correctifs à supprimer.</span><span class="sxs-lookup"><span data-stu-id="864fe-120">The property contains the list of patch code GUIDs of patches to be removed.</span></span> <span data-ttu-id="864fe-121">Une action personnalisée peut déterminer si l’état d’installation du correctif est appliqué, obsolète ou remplacé en appelant la propriété [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) ou [**PatchProperty**](patch-patchproperty.md) de l' [objet patch](patch-object.md).</span><span class="sxs-lookup"><span data-stu-id="864fe-121">A custom action can determine whether the installation state of the patch is applied, obsolete or superseded by calling the [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) or the [**PatchProperty**](patch-patchproperty.md) property of the [Patch Object](patch-object.md).</span></span>

<span data-ttu-id="864fe-122">Après la suppression d’un correctif, l’état de l’application est le même que si le correctif n’a jamais été installé.</span><span class="sxs-lookup"><span data-stu-id="864fe-122">After a patch is removed the state of the application is the same as if the patch was never installed.</span></span> <span data-ttu-id="864fe-123">Si possible, le programme d’installation limite le processus au sous-ensemble de fonctionnalités affectées par le correctif en cours de suppression.</span><span class="sxs-lookup"><span data-stu-id="864fe-123">If possible, the installer restricts the process to the subset of features affected by the patch being removed.</span></span> <span data-ttu-id="864fe-124">Le programme d’installation définit automatiquement la propriété [**réinstaller**](reinstall.md) sur la liste des fonctionnalités affectées.</span><span class="sxs-lookup"><span data-stu-id="864fe-124">The installer automatically sets the [**REINSTALL**](reinstall.md) property to the list of affected features.</span></span> <span data-ttu-id="864fe-125">Les fichiers qui ont été ajoutés par le correctif sont supprimés et les fichiers qui ont été modifiés par le correctif sont remplacés.</span><span class="sxs-lookup"><span data-stu-id="864fe-125">Files that were added by the patch are removed and files that were modified by the patch are overwritten.</span></span> <span data-ttu-id="864fe-126">Les fichiers et les entrées de Registre sont restaurés à la version attendue par le produit moins le correctif.</span><span class="sxs-lookup"><span data-stu-id="864fe-126">Files and registry entries are restored to the version expected by the product minus the patch.</span></span> <span data-ttu-id="864fe-127">Les fonctionnalités et les composants qui ont été ajoutés par le correctif sont désinscrits de l’application.</span><span class="sxs-lookup"><span data-stu-id="864fe-127">Features and components that were added by the patch are unregistered from the application.</span></span> <span data-ttu-id="864fe-128">Notez que le contenu supplémentaire ajouté par le correctif peut rester sur l’ordinateur de l’utilisateur si le contenu est utilisé par un autre correctif qui est toujours applicable.</span><span class="sxs-lookup"><span data-stu-id="864fe-128">Note that additional content added by the patch can remain on the user's computer if the content is used by another patch that is still applicable.</span></span>

<span data-ttu-id="864fe-129">Si un fichier d’un composant partagé est mis à jour par un correctif, la modification affecte toutes les applications qui partagent le composant.</span><span class="sxs-lookup"><span data-stu-id="864fe-129">If a file of a shared component is updated by a patch, the change affects all applications that share the component.</span></span> <span data-ttu-id="864fe-130">Une fois le correctif supprimé, la modification affecte toutes les applications qui partagent le composant.</span><span class="sxs-lookup"><span data-stu-id="864fe-130">When the patch is removed, again, the change affects all applications that share the component.</span></span> <span data-ttu-id="864fe-131">Cela signifie que la suppression d’un correctif par une application peut restaurer le fichier du composant partagé dans une version inférieure à celle requise par une autre application.</span><span class="sxs-lookup"><span data-stu-id="864fe-131">This means that removal of a patch by one application can restore the file of the shared component to a lower version than required by another application.</span></span> <span data-ttu-id="864fe-132">Cela peut corriger la première application, mais provoquer l’arrêt du fonctionnement de la deuxième application.</span><span class="sxs-lookup"><span data-stu-id="864fe-132">This could fix the first application, but cause the second application to stop working.</span></span> <span data-ttu-id="864fe-133">Dans ce cas, la deuxième application peut être réparée en réinstallant la deuxième application à l’aide des méthodes décrites dans [réinstallation d’une fonctionnalité ou d’une application](reinstalling-a-feature-or-application.md).</span><span class="sxs-lookup"><span data-stu-id="864fe-133">In this case, the second application can be repaired by reinstalling the second application using the methods describe in [Reinstalling a Feature or Application](reinstalling-a-feature-or-application.md).</span></span> <span data-ttu-id="864fe-134">Cette opération restaure la version corrigée du fichier.</span><span class="sxs-lookup"><span data-stu-id="864fe-134">This will restore the patched version of the file.</span></span>

## <a name="related-topics"></a><span data-ttu-id="864fe-135">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="864fe-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="864fe-136">**MsiEnumapplicationsEx**</span><span class="sxs-lookup"><span data-stu-id="864fe-136">**MsiEnumapplicationsEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumproductsexa)
</dt> <dt>

[<span data-ttu-id="864fe-137">**MsiGetPatchInfoEx**</span><span class="sxs-lookup"><span data-stu-id="864fe-137">**MsiGetPatchInfoEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa)
</dt> <dt>

[<span data-ttu-id="864fe-138">**MSIPATCHREMOVE**</span><span class="sxs-lookup"><span data-stu-id="864fe-138">**MSIPATCHREMOVE**</span></span>](msipatchremove.md)
</dt> <dt>

[<span data-ttu-id="864fe-139">**MsiRemovePatches**</span><span class="sxs-lookup"><span data-stu-id="864fe-139">**MsiRemovePatches**</span></span>](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa)
</dt> <dt>

[<span data-ttu-id="864fe-140">Séquencement des correctifs</span><span class="sxs-lookup"><span data-stu-id="864fe-140">Patch Sequencing</span></span>](sequencing-patches.md)
</dt> <dt>

[<span data-ttu-id="864fe-141">Actions personnalisées de désinstallation des correctifs</span><span class="sxs-lookup"><span data-stu-id="864fe-141">Patch Uninstall Custom Actions</span></span>](patch-uninstall-custom-actions.md)
</dt> <dt>

[<span data-ttu-id="864fe-142">Correctifs désinstallés</span><span class="sxs-lookup"><span data-stu-id="864fe-142">Uninstallable Patches</span></span>](uninstallable-patches.md)
</dt> <dt>

[<span data-ttu-id="864fe-143">Désinstallation des correctifs</span><span class="sxs-lookup"><span data-stu-id="864fe-143">Uninstalling Patches</span></span>](uninstalling-patches.md)
</dt> </dl>

 

 



