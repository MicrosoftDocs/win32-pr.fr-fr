---
description: Actuellement, chaque installation qui tente d’utiliser le Windows Installer commence par vérifier si le programme d’installation est présent sur l’ordinateur de l’utilisateur et, s’il n’est pas présent, si l’utilisateur et l’ordinateur sont prêts à installer Windows Installer.
ms.assetid: a5174284-2a8c-4510-accf-641fda5be98d
title: Amorçage
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ff743acbcd2dfc81b0e912e5be84c363f34614ea
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106527434"
---
# <a name="bootstrapping"></a><span data-ttu-id="25ad7-103">Amorçage</span><span class="sxs-lookup"><span data-stu-id="25ad7-103">Bootstrapping</span></span>

<span data-ttu-id="25ad7-104">Actuellement, chaque installation qui tente d’utiliser le Windows Installer commence par vérifier si le programme d’installation est présent sur l’ordinateur de l’utilisateur et, s’il n’est pas présent, si l’utilisateur et l’ordinateur sont prêts à installer Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="25ad7-104">Currently every installation that attempts to use the Windows Installer begins by checking whether the installer is present on the user's computer, and if it is not present, whether the user and computer are ready to install Windows Installer.</span></span> <span data-ttu-id="25ad7-105">Une application d’installation [Instmsi.exe](instmsi-exe.md) est disponible avec le kit de développement logiciel (SDK) Windows Installer qui contient la logique et les fonctionnalités d’installation de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="25ad7-105">A setup application [Instmsi.exe](instmsi-exe.md) is available with the Windows Installer SDK that contains all logic and functionality to install Windows Installer.</span></span> <span data-ttu-id="25ad7-106">Toutefois, une application d’amorçage doit gérer cette installation.</span><span class="sxs-lookup"><span data-stu-id="25ad7-106">However, a bootstrapping application must manage this installation.</span></span>

<span data-ttu-id="25ad7-107">L’application d’amorçage doit tout d’abord vérifier si Windows Installer est actuellement installé.</span><span class="sxs-lookup"><span data-stu-id="25ad7-107">The bootstrapping application must first check to see whether Windows Installer is currently installed.</span></span> <span data-ttu-id="25ad7-108">Les applications peuvent récupérer la version de Windows Installer actuellement installée à l’aide de [**DllGetVersion**](/windows/win32/api/shlwapi/nc-shlwapi-dllgetversionproc).</span><span class="sxs-lookup"><span data-stu-id="25ad7-108">Applications can get the version of Windows Installer currently installed by using [**DllGetVersion**](/windows/win32/api/shlwapi/nc-shlwapi-dllgetversionproc).</span></span> <span data-ttu-id="25ad7-109">Si Windows Installer n’est pas installé actuellement, l’application d’amorçage doit interroger le système d’exploitation pour déterminer quelle version du Instmsi.exe est requise.</span><span class="sxs-lookup"><span data-stu-id="25ad7-109">If Windows Installer is not currently installed, the bootstrapping application must query the operating system to determine which version of the Instmsi.exe is required.</span></span> <span data-ttu-id="25ad7-110">Une fois que l’installation de Windows Installer a démarré, l’application d’amorçage doit gérer les codes de retour de l’application Instmsi.exe et gérer tout redémarrage qui survient au cours de l’installation de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="25ad7-110">Once the installation of Windows Installer has initiated, the bootstrapping application must handle return codes from the Instmsi.exe application and handle any reboot that is incurred during the Windows Installer installation.</span></span> <span data-ttu-id="25ad7-111">Pour plus d’informations, consultez [détermination de la version de Windows Installer](determining-the-windows-installer-version.md)</span><span class="sxs-lookup"><span data-stu-id="25ad7-111">For more information, see [Determining the Windows Installer Version](determining-the-windows-installer-version.md)</span></span>

<span data-ttu-id="25ad7-112">L’exemple suivant montre comment l’application d’installation qui installe Microsoft Office 2000 vérifie le système de l’utilisateur et configure l’installation Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="25ad7-112">The following example demonstrates how the setup application which installs Microsoft Office 2000 checks the user's system and configures the Windows Installer installation.</span></span> <span data-ttu-id="25ad7-113">Cet exemple est écrit spécifiquement pour installer Office 2000 et doit être utilisé comme référence générale uniquement.</span><span class="sxs-lookup"><span data-stu-id="25ad7-113">This example is specifically written to install Office 2000 and should be used as a general reference only.</span></span>

<span data-ttu-id="25ad7-114">Quand un utilisateur insère un CD-ROM Office 2000 sur son ordinateur, Setup.exe tente de lancer le mode de maintenance, l’application d’installation ou rien du tout en fonction des besoins de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="25ad7-114">When a user inserts an Office 2000 CD-ROM into their computer, Setup.exe attempts to launch the maintenance mode, the setup application, or does nothing at all, according to the user's needs.</span></span> <span data-ttu-id="25ad7-115">La section suivante décrit comment l’application d’installation Office 2000, nommée Setup.exe, qualifie l’utilisateur et son ordinateur, crée une ligne de commande et installe Windows Installer à l’aide de l’application Msiexec.exe.</span><span class="sxs-lookup"><span data-stu-id="25ad7-115">The following section describes how the Office 2000 setup application, named Setup.exe, qualifies the user and their computer, constructs a command line and installs Windows Installer using the Msiexec.exe application.</span></span>

## <a name="how-setupexe-bootstraps-the-windows-installer-when-installing-office-2000"></a><span data-ttu-id="25ad7-116">Comment Setup.exe amorce le Windows Installer lors de l’installation d’Office 2000</span><span class="sxs-lookup"><span data-stu-id="25ad7-116">How Setup.exe Bootstraps the Windows Installer when Installing Office 2000</span></span>

1.  <span data-ttu-id="25ad7-117">L’utilisateur insère un CD-ROM Office 2000 sur son ordinateur.</span><span class="sxs-lookup"><span data-stu-id="25ad7-117">The user inserts an Office 2000 CD-ROM into their computer.</span></span> <span data-ttu-id="25ad7-118">Le système d’exploitation Windows lance Setup.exe à l’aide du commutateur/autorun et du fichier autorun. inf.</span><span class="sxs-lookup"><span data-stu-id="25ad7-118">The Windows operating system initiates Setup.exe using the /autorun switch and the Autorun.inf file.</span></span> <span data-ttu-id="25ad7-119">Le fichier autorun. inf se trouve à la racine du CD-ROM Office 2000 et contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="25ad7-119">The Autorun.inf file is found at the root of the Office 2000 CD-ROM and contains the following sections:</span></span>

    <span data-ttu-id="25ad7-120">\[Autorun\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-120">\[Autorun\]</span></span>

     

    <span data-ttu-id="25ad7-121">\[Fonctionnalités Office\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-121">\[Office Features\]</span></span>

     

    <span data-ttu-id="25ad7-122">\[Informations sur le produit\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-122">\[Product Information\]</span></span>

     

    <span data-ttu-id="25ad7-123">\[ServicePack \] .</span><span class="sxs-lookup"><span data-stu-id="25ad7-123">\[ServicePack\].</span></span>

    <span data-ttu-id="25ad7-124">La \[ \] section autorun contient une ligne de commande qui exécute l’application Setup.exe, exécute l’icône utilisée pour afficher le disque et contient des informations pour ajouter une option « installer » et une option « configurer » au menu contextuel du CD-ROM.</span><span class="sxs-lookup"><span data-stu-id="25ad7-124">The \[Autorun\] section contains a command line that executes the Setup.exe application, executes the icon used to display the disc, and contains information to add an "Install" option and a "Configure" option to the context menu for the CD-ROM.</span></span>

    <span data-ttu-id="25ad7-125">La \[ section fonctionnalités Office \] contient une liste de fonctionnalités et de paires de noms de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="25ad7-125">The \[Office Features\] section contains a list of features and feature name pairs.</span></span>

    <span data-ttu-id="25ad7-126">La \[ section informations sur le produit \] spécifie le nom et la version de l’application.</span><span class="sxs-lookup"><span data-stu-id="25ad7-126">The \[Product Information\] section specifies the name and version of the application.</span></span>

    <span data-ttu-id="25ad7-127">La \[ \] section ServicePack permet à un administrateur réseau de définir le niveau de Service Pack minimal requis.</span><span class="sxs-lookup"><span data-stu-id="25ad7-127">The \[ServicePack\] section allows a network administrator to set the minimum required service pack level.</span></span> <span data-ttu-id="25ad7-128">L’administrateur réseau peut utiliser cette section pour créer le texte d’un message d’alerte affiché si le système d’exploitation local ne dispose pas de l’Service Pack requis.</span><span class="sxs-lookup"><span data-stu-id="25ad7-128">The network administrator can use this section to author the text of an alert message displayed if the local operating system does not have the required service pack.</span></span>

    <span data-ttu-id="25ad7-129">Voici un exemple de fichier autorun. inf.</span><span class="sxs-lookup"><span data-stu-id="25ad7-129">The following is a sample Autorun.inf.</span></span>

    ``` syntax
    [autorun] 
    OPEN=setup.EXE /AUTORUN /KEY:Software\Microsoft\Office\9.0\Common\General\InstallProductID
    ICON=setup.EXE,1
    shell\configure=&Configure
    shell\configure\command=setup.EXE
    shell\install=&Install
    shell\install\command=setup.EXE
    [OfficeFeatures]
    Feature1=ACCESSFiles
    Feature2=OfficeFiles
    Feature3=WORDFiles
    Feature4=EXCELFiles
    Feature5=PPTFiles
    [ProductInformation]
    DisplayName=Microsoft Office 9
    Version=9.0
    ProductCode={product guid}
    [ServicePack]
    MessageText="The operating system does not have a required service pack. Please download and install this from www.microsoft.com."
    SPLevel=3
    ```

2.  <span data-ttu-id="25ad7-130">L’application Setup.exe recherche le \_ mutex MsiPromptForCD.</span><span class="sxs-lookup"><span data-stu-id="25ad7-130">The Setup.exe application checks for the \_MsiPromptForCD mutex.</span></span> <span data-ttu-id="25ad7-131">Windows Installer crée ce mutex lorsqu’il invite l’utilisateur à insérer le CD-ROM.</span><span class="sxs-lookup"><span data-stu-id="25ad7-131">Windows Installer creates this mutex when it prompts the user to insert the CD-ROM.</span></span> <span data-ttu-id="25ad7-132">La présence du mutex indique que Windows Installer exécute une installation qui a demandé le CD-ROM Office 2000.</span><span class="sxs-lookup"><span data-stu-id="25ad7-132">The presence of the mutex indicates that Windows Installer is running an installation that has requested the Office 2000 CD-ROM.</span></span> <span data-ttu-id="25ad7-133">Dans ce cas, l’application Setup.exe s’arrête immédiatement et permet à l’installation d’Office 2000 de continuer.</span><span class="sxs-lookup"><span data-stu-id="25ad7-133">In this case, the Setup.exe application exits immediately and allows the Office 2000 installation to continue.</span></span> <span data-ttu-id="25ad7-134">Si le mutex est absent, l’application Setup.exe continue à l’étape 3 où une clé de Registre est évaluée pour déterminer si Office 2000 est installé.</span><span class="sxs-lookup"><span data-stu-id="25ad7-134">If the mutex is absent, the Setup.exe application continues at step 3 where a registry key is evaluated to determine if Office 2000 is installed.</span></span>
3.  <span data-ttu-id="25ad7-135">L’application Setup.exe vérifie la présence de la clé de Registre Office9 :</span><span class="sxs-lookup"><span data-stu-id="25ad7-135">The Setup.exe application checks the presence of the Office9 registry key:</span></span>

    <span data-ttu-id="25ad7-136">**HKCU/Software/Microsoft/Office/9.0/common/General/InstallProductID**</span><span class="sxs-lookup"><span data-stu-id="25ad7-136">**HKCU/Software/Microsoft/Office/9.0/Common/General/InstallProductID**</span></span>

    <span data-ttu-id="25ad7-137">Si cette clé de Registre n’existe pas, l’application Setup.exe continue à l’étape 6 où le système d’exploitation est vérifié pour déterminer si elle est qualifiée pour l’installation d’Office 2000.</span><span class="sxs-lookup"><span data-stu-id="25ad7-137">If this registry key does not exist, the Setup.exe application continues at step 6 where the operating system is checked to determine if it qualifies for the installation of Office 2000.</span></span>

4.  <span data-ttu-id="25ad7-138">Si la clé de Registre Office 2000 existe, l’application Setup.exe vérifie l’état d’installation actuel en appelant [**MsiQueryProductState**](/windows/desktop/api/Msi/nf-msi-msiqueryproductstatea).</span><span class="sxs-lookup"><span data-stu-id="25ad7-138">If the Office 2000 registry key exists, the Setup.exe application checks the current installation state by calling [**MsiQueryProductState**](/windows/desktop/api/Msi/nf-msi-msiqueryproductstatea).</span></span> <span data-ttu-id="25ad7-139">Un état de retour de InstallState \_ default indique qu’Office 2000 est déjà installé et que l’application Setup.exe se poursuit à l’étape 5, où l’exécution de la source office 2000 est vérifiée.</span><span class="sxs-lookup"><span data-stu-id="25ad7-139">A return state of InstallState\_Default indicates that Office 2000 is already installed and the Setup.exe application continues at step 5 where the Office 2000 is checked for run from source.</span></span>

    <span data-ttu-id="25ad7-140">Si Office 2000 n’est pas installé, l’application Setup.exe continue à l’étape 6 où le système d’exploitation est vérifié pour déterminer si elle est qualifiée pour l’installation d’Office 2000.</span><span class="sxs-lookup"><span data-stu-id="25ad7-140">If Office 2000 is not installed, the Setup.exe application continues at step 6 where the operating system is checked to determine if it qualifies for the installation of Office 2000.</span></span>

5.  <span data-ttu-id="25ad7-141">L’application Setup.exe appelle [**MsiQueryFeatureState**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestatea) pour chacune des fonctionnalités de la section **\[ OfficeFeatures \]** du fichier autorun. inf.</span><span class="sxs-lookup"><span data-stu-id="25ad7-141">The Setup.exe application calls [**MsiQueryFeatureState**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestatea) for each of the features in the **\[OfficeFeatures\]** section of the Autorun.inf file.</span></span> <span data-ttu-id="25ad7-142">Si l’une de ces fonctionnalités retourne \_ la source INSTALLSTATE, cela indique que la fonctionnalité est exécutée à partir de la source et que l’application Setup.exe s’arrête immédiatement.</span><span class="sxs-lookup"><span data-stu-id="25ad7-142">If any of these features returns INSTALLSTATE\_SOURCE, this indicates that the feature is being run from source and the Setup.exe application exits immediately.</span></span>

    <span data-ttu-id="25ad7-143">Si aucune des fonctionnalités ne retourne \_ la source INSTALLSTATE, l’application Setup.exe lance l’application du programme d’installation, Msiexec.exe et présente le mode de maintenance Windows Installer avant de quitter.</span><span class="sxs-lookup"><span data-stu-id="25ad7-143">If none of the features returns INSTALLSTATE\_SOURCE, the Setup.exe application launches the installer application, Msiexec.exe, and presents the Windows Installer maintenance mode before exiting.</span></span>

6.  <span data-ttu-id="25ad7-144">L’application Setup.exe détermine si le système d’exploitation est qualifié pour une installation d’Office 2000.</span><span class="sxs-lookup"><span data-stu-id="25ad7-144">The Setup.exe application determines whether the operating system qualifies for an installation of Office 2000.</span></span> <span data-ttu-id="25ad7-145">Windows XP est requis pour installer Office 2000.</span><span class="sxs-lookup"><span data-stu-id="25ad7-145">Windows XP is required to install Office 2000.</span></span> <span data-ttu-id="25ad7-146">Si le système d’exploitation requiert une mise à jour Service Pack pour être éligible à Office 2000, l’application Setup.exe affiche le texte spécifié dans le fichier autorun. inf.</span><span class="sxs-lookup"><span data-stu-id="25ad7-146">If the operating system requires a service pack update to qualify for Office 2000, the Setup.exe application displays the text specified in the Autorun.inf file.</span></span> <span data-ttu-id="25ad7-147">Si le système d’exploitation n’est pas éligible à Office 2000 ou à une mise à niveau d’Office 2000, l’application Setup.exe affiche un message qui empêche l’utilisateur de continuer.</span><span class="sxs-lookup"><span data-stu-id="25ad7-147">If the operating system does not qualify for Office 2000 or an upgrade of Office 2000, the Setup.exe application displays a message that prevents the user from continuing.</span></span>

    <span data-ttu-id="25ad7-148">Si le système d’exploitation qualifie Office 2000, l’application Setup.exe continue à l’étape 7, qui détermine si Windows Installer est installé sur l’ordinateur de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="25ad7-148">If the operating system qualifies for Office 2000, the Setup.exe application continues at step 7, which determines whether Windows Installer is installed on the user's computer.</span></span>

7.  <span data-ttu-id="25ad7-149">Si Windows Installer existe sur l’ordinateur de l’utilisateur, l’application Setup.exe lance l’application Msiexec.exe et lui transmet le fichier Office 2000. msi.</span><span class="sxs-lookup"><span data-stu-id="25ad7-149">If Windows Installer exists on the user's machine, the Setup.exe application launches the Msiexec.exe application and passes the Office 2000 .msi file to it.</span></span>

    <span data-ttu-id="25ad7-150">Si Windows Installer n’est pas installé sur l’ordinateur local, l’application Setup.exe se poursuit à l’étape 8, qui détermine si le système d’exploitation est qualifié pour l’installation de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="25ad7-150">If Windows Installer is not installed on the local machine, the Setup.exe application continues at step 8, which determines whether the operating system qualifies to have Windows Installer installed.</span></span>

8.  <span data-ttu-id="25ad7-151">Si l’ordinateur local est autorisé à avoir Windows Installer installé, l’application Setup.exe exécute la version appropriée de l’application Instmsi.exe installer pour la plateforme.</span><span class="sxs-lookup"><span data-stu-id="25ad7-151">If the local computer is eligible to have Windows Installer installed, the Setup.exe application runs the correct version of the Instmsi.exe installer application for the platform.</span></span> <span data-ttu-id="25ad7-152">Setup.exe pouvez passer le commutateur de ligne de commande « /q » pour supprimer l’interface utilisateur et empêcher l’utilisateur de modifier les options de configuration de l’installation.</span><span class="sxs-lookup"><span data-stu-id="25ad7-152">Setup.exe may pass the "/q" command line switch to suppress the user interface and prevent the user from changing any installation configuration options.</span></span>
9.  <span data-ttu-id="25ad7-153">L’application Setup.exe charge le fichier Msi.dll récemment installé et effectue un appel à la fonction [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) pour installer l’application de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="25ad7-153">The Setup.exe application loads the newly installed Msi.dll file and performs a call to the [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) function to install the user's application.</span></span>

## <a name="setupexe-command-line-parameters"></a><span data-ttu-id="25ad7-154">Setup.exe les paramètres de ligne de commande</span><span class="sxs-lookup"><span data-stu-id="25ad7-154">Setup.exe Command Line Parameters</span></span>

<span data-ttu-id="25ad7-155">L’application Setup.exe permet aux administrateurs et aux utilisateurs de passer des options de ligne de commande à l’application Msiexec.exe.</span><span class="sxs-lookup"><span data-stu-id="25ad7-155">The Setup.exe application enables administrators and users to pass command line options to the Msiexec.exe application.</span></span> <span data-ttu-id="25ad7-156">Pour plus d’informations, consultez [options de ligne de commande](command-line-options.md).</span><span class="sxs-lookup"><span data-stu-id="25ad7-156">For more information, see [Command Line Options](command-line-options.md).</span></span> <span data-ttu-id="25ad7-157">Le tableau suivant répertorie les options de commande qui peuvent être utilisées avec Setup.exe.</span><span class="sxs-lookup"><span data-stu-id="25ad7-157">The following table lists the command options that can be used with Setup.exe.</span></span>



| <span data-ttu-id="25ad7-158">Option</span><span class="sxs-lookup"><span data-stu-id="25ad7-158">Option</span></span>                       | <span data-ttu-id="25ad7-159">Usage</span><span class="sxs-lookup"><span data-stu-id="25ad7-159">Usage</span></span>                                                                                                                                        | <span data-ttu-id="25ad7-160">Signification</span><span class="sxs-lookup"><span data-stu-id="25ad7-160">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="25ad7-161">/autorun</span><span class="sxs-lookup"><span data-stu-id="25ad7-161">/autorun</span></span>                     | <span data-ttu-id="25ad7-162">setup.exe/autorun</span><span class="sxs-lookup"><span data-stu-id="25ad7-162">setup.exe /autorun</span></span>                                                                                                                           | <span data-ttu-id="25ad7-163">Exécute le fichier autorun. inf décrit ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="25ad7-163">Runs the Autorun.inf described above.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="25ad7-164">/a</span><span class="sxs-lookup"><span data-stu-id="25ad7-164">/a</span></span>                           | <span data-ttu-id="25ad7-165">setup.exe /a</span><span class="sxs-lookup"><span data-stu-id="25ad7-165">setup.exe /a</span></span>                                                                                                                                 | <span data-ttu-id="25ad7-166">Lance une installation administrative.</span><span class="sxs-lookup"><span data-stu-id="25ad7-166">Initiates an administrative installation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="25ad7-167">/j</span><span class="sxs-lookup"><span data-stu-id="25ad7-167">/j</span></span>                           | <span data-ttu-id="25ad7-168">\[\| \] *package* u m ou</span><span class="sxs-lookup"><span data-stu-id="25ad7-168">\[u\|m\]*Package* or</span></span> <br/> <span data-ttu-id="25ad7-169">\[\|liste des \] *transformations* du *package* u m</span><span class="sxs-lookup"><span data-stu-id="25ad7-169">\[u\|m\]*Package* /t *Transform List*</span></span><br/> <span data-ttu-id="25ad7-170">ou</span><span class="sxs-lookup"><span data-stu-id="25ad7-170">or</span></span> <br/> <span data-ttu-id="25ad7-171">\[\|package u m m \]  /g *LanguageID*</span><span class="sxs-lookup"><span data-stu-id="25ad7-171">\[u\|m\]*Package* /g *LanguageID*</span></span><br/> | <span data-ttu-id="25ad7-172">Publie un produit.</span><span class="sxs-lookup"><span data-stu-id="25ad7-172">Advertises a product.</span></span> <span data-ttu-id="25ad7-173">Cette option ignore toutes les valeurs de propriété entrées sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="25ad7-173">This option ignores any property values entered on the command line.</span></span> <span data-ttu-id="25ad7-174">Publier sur l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="25ad7-174">u   Advertise to the current user.</span></span><br/> <span data-ttu-id="25ad7-175">Publier sur tous les utilisateurs de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="25ad7-175">m   Advertise to all users of machine.</span></span><br/> <span data-ttu-id="25ad7-176">identificateur de langue g</span><span class="sxs-lookup"><span data-stu-id="25ad7-176">g   Language identifier</span></span><br/> <span data-ttu-id="25ad7-177">t applique la transformation au package publié.</span><span class="sxs-lookup"><span data-stu-id="25ad7-177">t   Applies transform to advertised package.</span></span><br/>                                                                                                                                                                                                                        |
| <span data-ttu-id="25ad7-178">/I</span><span class="sxs-lookup"><span data-stu-id="25ad7-178">/I</span></span>                           | <span data-ttu-id="25ad7-179">setup.exe/I Office9.msi/t ProgramMgmt. MST</span><span class="sxs-lookup"><span data-stu-id="25ad7-179">setup.exe /I Office9.msi /t ProgramMgmt.mst</span></span>                                                                                                  | <span data-ttu-id="25ad7-180">Spécifie le fichier. msi que Setup.exe doit installer.</span><span class="sxs-lookup"><span data-stu-id="25ad7-180">Specifies the .msi file that Setup.exe is to install.</span></span> <span data-ttu-id="25ad7-181">Si l’option/I n’est pas incluse, Setup.exe utilise le fichier Office9.msi.</span><span class="sxs-lookup"><span data-stu-id="25ad7-181">If the /I option is not included, Setup.exe uses the Office9.msi file.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="25ad7-182">/o< = *valeur* de la propriété></span><span class="sxs-lookup"><span data-stu-id="25ad7-182">/o<*property*=*value*></span></span> | <span data-ttu-id="25ad7-183">setup.exe/o CDKEY = 111111-1111</span><span class="sxs-lookup"><span data-stu-id="25ad7-183">setup.exe /o CDKEY=111111-1111</span></span>                                                                                                               | <span data-ttu-id="25ad7-184">Définit les propriétés dans le fichier. msi.</span><span class="sxs-lookup"><span data-stu-id="25ad7-184">Sets properties in the .msi file.</span></span> <span data-ttu-id="25ad7-185">Setup.exe le transmet à msiexec comme écrit.</span><span class="sxs-lookup"><span data-stu-id="25ad7-185">Setup.exe passes these it to msiexec as written.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="25ad7-186">/q</span><span class="sxs-lookup"><span data-stu-id="25ad7-186">/q</span></span>                           | <span data-ttu-id="25ad7-187">setup.exe/q</span><span class="sxs-lookup"><span data-stu-id="25ad7-187">setup.exe /q</span></span>                                                                                                                                 | <span data-ttu-id="25ad7-188">Définissez le niveau d’interface utilisateur de l’installation.</span><span class="sxs-lookup"><span data-stu-id="25ad7-188">Set the UI level the installation.</span></span> <span data-ttu-id="25ad7-189">/q aucune interface utilisateur (/qn pour MsiExec.)/QB interface utilisateur de base</span><span class="sxs-lookup"><span data-stu-id="25ad7-189">/q   no UI (/qn   for msiexec.) /qb   basic UI</span></span><br/> <span data-ttu-id="25ad7-190">/QR interface utilisateur réduite.</span><span class="sxs-lookup"><span data-stu-id="25ad7-190">/qr   reduced UI.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="25ad7-191">/m\#</span><span class="sxs-lookup"><span data-stu-id="25ad7-191">/m\#</span></span>                         | <span data-ttu-id="25ad7-192">setup.exe/M4</span><span class="sxs-lookup"><span data-stu-id="25ad7-192">setup.exe /m4</span></span>                                                                                                                                | <span data-ttu-id="25ad7-193">Prend en charge plusieurs licences conformément aux contrats sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="25ad7-193">Supports multiple licenses in accordance with Select agreements.</span></span> <span data-ttu-id="25ad7-194">Cette propriété est utilisée par l’action personnalisée de vérification de licence pour écrire le certificat LV.</span><span class="sxs-lookup"><span data-stu-id="25ad7-194">This property is used in by the License Verification custom action to write the LV certificate.</span></span> <span data-ttu-id="25ad7-195">L’option/m doit être suivie du nombre de déverrouillages autorisés.</span><span class="sxs-lookup"><span data-stu-id="25ad7-195">The /m option must be followed by the number of unlocks allowed.</span></span> <span data-ttu-id="25ad7-196">La valeur spécifiée par l’option/m doit être définie en tant que propriété « M » dans le fichier Office9.msi.</span><span class="sxs-lookup"><span data-stu-id="25ad7-196">The value specified by the /m option should be set as the "M" property in the Office9.msi file.</span></span> <span data-ttu-id="25ad7-197">Si aucune valeur n’est spécifiée, mais que l’option/m est utilisée avec le programme d’installation, la valeur 0 doit être définie.</span><span class="sxs-lookup"><span data-stu-id="25ad7-197">If no value is specified, but the /m option is used with setup, the value of 0 should be set.</span></span> <span data-ttu-id="25ad7-198">L’option/m est requise pour prendre en charge les clients Select à l’aide d’un CD ou d’un réseau.</span><span class="sxs-lookup"><span data-stu-id="25ad7-198">The /m option is required to support Select customers using a CD or network.</span></span> |
| <span data-ttu-id="25ad7-199">/Settings</span><span class="sxs-lookup"><span data-stu-id="25ad7-199">/settings</span></span>                    | <span data-ttu-id="25ad7-200">setup.exe/Settings mysettings.ini</span><span class="sxs-lookup"><span data-stu-id="25ad7-200">setup.exe /settings mysettings.ini</span></span>                                                                                                           | <span data-ttu-id="25ad7-201">Permet aux administrateurs de spécifier un fichier. ini contenant tous les paramètres personnalisés à passer lors de l’installation d’Office 2000.</span><span class="sxs-lookup"><span data-stu-id="25ad7-201">Enables administrators to specify an .ini file containing all of the customized settings to be passed during Office 2000 setup.</span></span> <span data-ttu-id="25ad7-202">Consultez la description du fichier. ini ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="25ad7-202">See the description of the .ini file below.</span></span>                                                                                                                                                                                                                                                                                                                                  |



 

## <a name="using-an-ini-file"></a><span data-ttu-id="25ad7-203">Utilisation d’un fichier. ini</span><span class="sxs-lookup"><span data-stu-id="25ad7-203">Using an .ini File</span></span>

<span data-ttu-id="25ad7-204">La création d’un fichier d’initialisation peut être plus facile que la création d’une ligne de commande longue.</span><span class="sxs-lookup"><span data-stu-id="25ad7-204">Creating an initialization file may be easier than creating a long command line.</span></span> <span data-ttu-id="25ad7-205">À l’aide de l’option/Settings, l’application Setup.exe lit le fichier. ini spécifié et construit une ligne de commande à passer à l’application Msiexec.exe.</span><span class="sxs-lookup"><span data-stu-id="25ad7-205">Using the /settings option, the Setup.exe application reads the specified .ini file and constructs a command line to pass to the Msiexec.exe application.</span></span> <span data-ttu-id="25ad7-206">Seules les propriétés prises en charge sur la ligne de commande sont prises en charge dans le fichier. ini.</span><span class="sxs-lookup"><span data-stu-id="25ad7-206">Only properties supported on the command line are supported in the .ini file.</span></span> <span data-ttu-id="25ad7-207">Si une propriété ou une valeur se trouve à la fois dans le fichier. ini et sur la ligne de commande, les paramètres de ligne de commande remplacent les paramètres du fichier. ini.</span><span class="sxs-lookup"><span data-stu-id="25ad7-207">If a property or value is found in both the .ini file and on the command line, the command line settings override the .ini file settings.</span></span>

<span data-ttu-id="25ad7-208">Le format du fichier. ini est le suivant :</span><span class="sxs-lookup"><span data-stu-id="25ad7-208">The format of the .ini file is:</span></span>

<span data-ttu-id="25ad7-209">\[msi\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-209">\[msi\]</span></span>

 

<span data-ttu-id="25ad7-210">\[débit maximal acceptable\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-210">\[mst\]</span></span>

 

<span data-ttu-id="25ad7-211">\[options\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-211">\[options\]</span></span>

 

<span data-ttu-id="25ad7-212">\[Afficher\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-212">\[Display\]</span></span>

<span data-ttu-id="25ad7-213">La \[ \] section MSI du fichier. ini spécifie le chemin d’accès au package d’installation pour l’installation.</span><span class="sxs-lookup"><span data-stu-id="25ad7-213">The \[msi\] section of the .ini file specifies the path to the installation package for the installation.</span></span> <span data-ttu-id="25ad7-214">Cela correspond à l’option/I sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="25ad7-214">This corresponds to the /I option on the command line.</span></span>

<span data-ttu-id="25ad7-215">La \[ \] section MST du fichier. ini spécifie le chemin d’accès aux transformations utilisées avec cette installation.</span><span class="sxs-lookup"><span data-stu-id="25ad7-215">The \[mst\] section of the .ini file specifies the path to transforms used with this installation.</span></span> <span data-ttu-id="25ad7-216">Cela correspond à l’option/j sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="25ad7-216">This corresponds to the /j option on the command line.</span></span> <span data-ttu-id="25ad7-217">Plusieurs transformations sont indiquées sur une autre ligne, à l’aide de MST1 MST (N).</span><span class="sxs-lookup"><span data-stu-id="25ad7-217">Multiple transforms are each indicated on a different line, using MST1   MST(N).</span></span> <span data-ttu-id="25ad7-218">Lorsqu’elle est analysée dans la ligne de commande, la liste dans le fichier. ini est retournée de gauche à droite.</span><span class="sxs-lookup"><span data-stu-id="25ad7-218">When parsed into the command line, the list in the .ini file is turned from left to right.</span></span> <span data-ttu-id="25ad7-219">Notez que le nombre associé au titre MST (N) est présent uniquement pour gérer des identificateurs uniques et n’a aucune signification par programmation.</span><span class="sxs-lookup"><span data-stu-id="25ad7-219">Note that the number associated with the MST(N) title is present only to maintain unique identifiers and has no programmatic meaning.</span></span>

<span data-ttu-id="25ad7-220">La \[ \] section Options permet aux administrateurs réseau de définir et de remplacer des propriétés dans les fichiers. msi ou. MST.</span><span class="sxs-lookup"><span data-stu-id="25ad7-220">The \[options\] section allows network administrators to set and override properties in the .msi or .mst files.</span></span> <span data-ttu-id="25ad7-221">Les options définies dans le fichier. ini sont ajoutées à la ligne de commande à l’aide de l’option/o.</span><span class="sxs-lookup"><span data-stu-id="25ad7-221">Options set in the .ini file are added to the command line using the /o option.</span></span> <span data-ttu-id="25ad7-222">Chaque option de la section option doit avoir un nom de propriété et une valeur.</span><span class="sxs-lookup"><span data-stu-id="25ad7-222">Each option in the option section must have a property name and a value.</span></span>

<span data-ttu-id="25ad7-223">La \[ section Affichage permet \] de définir le niveau d’interface utilisateur utilisé lors de l’installation.</span><span class="sxs-lookup"><span data-stu-id="25ad7-223">The \[Display\] section is used to set the user interface level used during setup.</span></span> <span data-ttu-id="25ad7-224">Cela correspond à l’option/q sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="25ad7-224">This corresponds to the /q option on the command line.</span></span> <span data-ttu-id="25ad7-225">Les valeurs valides sont None, Basic, Reduced et Full.</span><span class="sxs-lookup"><span data-stu-id="25ad7-225">Valid values are   none, basic, reduced, and full.</span></span>

<span data-ttu-id="25ad7-226">Exemple de fichier. ini</span><span class="sxs-lookup"><span data-stu-id="25ad7-226">Sample .ini file</span></span>

<span data-ttu-id="25ad7-227">\[MSI\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-227">\[MSI\]</span></span>

 

<span data-ttu-id="25ad7-228">MSI = \\ \\ sourceshare \\ office2000 \\Office2000.msi</span><span class="sxs-lookup"><span data-stu-id="25ad7-228">MSI=\\\\sourceshare\\Office2000\\Office2000.msi</span></span>

 

<span data-ttu-id="25ad7-229">\[DÉBIT maximal acceptable\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-229">\[MST\]</span></span>

 

<span data-ttu-id="25ad7-230">MST1 = \\ \\ sourceshare \\ office2000 \\ trns1. MST</span><span class="sxs-lookup"><span data-stu-id="25ad7-230">MST1=\\\\sourceshare\\Office2000\\trns1.mst</span></span>

 

<span data-ttu-id="25ad7-231">MST2 = \\ \\ sourceshare \\ office2000 \\ trns2. MST</span><span class="sxs-lookup"><span data-stu-id="25ad7-231">MST2=\\\\sourceshare\\Office2000\\trns2.mst</span></span>

 

<span data-ttu-id="25ad7-232">\[Options\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-232">\[Options\]</span></span>

 

<span data-ttu-id="25ad7-233">PUBLICPROPERTY = votre valeur</span><span class="sxs-lookup"><span data-stu-id="25ad7-233">PUBLICPROPERTY=your value</span></span>

<span data-ttu-id="25ad7-234">\[Afficher\]</span><span class="sxs-lookup"><span data-stu-id="25ad7-234">\[Display\]</span></span>

 

<span data-ttu-id="25ad7-235">Affichage = aucun</span><span class="sxs-lookup"><span data-stu-id="25ad7-235">Display=None</span></span>

 

