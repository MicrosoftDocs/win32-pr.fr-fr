---
description: Les installations simultanées, également appelées installations imbriquées, constituent une fonctionnalité dépréciée du Windows Installer.
ms.assetid: 579ae4ee-47a0-440e-81ca-ea8bf60c5349
title: Installations simultanées
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d89f2ef4af062c8151935fefab471603f79d7633
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103866369"
---
# <a name="concurrent-installations"></a><span data-ttu-id="685ed-103">Installations simultanées</span><span class="sxs-lookup"><span data-stu-id="685ed-103">Concurrent Installations</span></span>

<span data-ttu-id="685ed-104">Les installations simultanées, également appelées installations imbriquées, constituent une fonctionnalité dépréciée du Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="685ed-104">Concurrent Installations, also called Nested Installations, is a deprecated feature of the Windows Installer.</span></span> <span data-ttu-id="685ed-105">Les applications installées avec des installations simultanées peuvent échouer, car elles sont difficiles à traiter correctement pour les clients.</span><span class="sxs-lookup"><span data-stu-id="685ed-105">Applications installed with concurrent installations can eventually fail because they are difficult for customers to service correctly.</span></span> <span data-ttu-id="685ed-106">N’utilisez pas d’installations simultanées pour installer des produits destinés à être diffusés au public.</span><span class="sxs-lookup"><span data-stu-id="685ed-106">Do not use concurrent installations to install products that are intended to be released to the public.</span></span> <span data-ttu-id="685ed-107">Les installations simultanées peuvent avoir une applicabilité limitée dans les environnements d’entreprise contrôlés lorsqu’ils sont utilisés pour installer des applications qui ne sont pas destinées à une version publique.</span><span class="sxs-lookup"><span data-stu-id="685ed-107">Concurrent installations can have limited applicability in controlled corporate environments when used to install applications that are not intended for public release.</span></span> <span data-ttu-id="685ed-108">La documentation sur les installations simultanées est fournie pour les auteurs de packages qui souhaitent utiliser des installations simultanées avec des applications qui ne sont pas destinées à la distribution publique.</span><span class="sxs-lookup"><span data-stu-id="685ed-108">The concurrent installations documentation is provided for package authors that wish to use concurrent installations with applications that are not for public distribution.</span></span>

<span data-ttu-id="685ed-109">Une action d’installation simultanée installe un autre package de Windows Installer lors de l’installation en cours.</span><span class="sxs-lookup"><span data-stu-id="685ed-109">A concurrent installation action installs another Windows Installer package during a currently running installation.</span></span> <span data-ttu-id="685ed-110">Une installation simultanée est ajoutée à un package en créant une action d’installation simultanée dans la [table CustomAction](customaction-table.md) et en planifiant cette action personnalisée dans les tables de séquence.</span><span class="sxs-lookup"><span data-stu-id="685ed-110">A concurrent installation is added to a package by authoring a concurrent installation action into the [CustomAction table](customaction-table.md) and scheduling this custom action into the sequence tables.</span></span> <span data-ttu-id="685ed-111">Le champ cible de la table CustomAction contient une chaîne de paramètres de propriété publique utilisée par l’installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-111">The Target field of the CustomAction table contains a string of public property settings used by the concurrent installation.</span></span> <span data-ttu-id="685ed-112">Le champ source de la table CustomAction identifie le package simultané.</span><span class="sxs-lookup"><span data-stu-id="685ed-112">The Source field of the CustomAction table identifies the concurrent package.</span></span> <span data-ttu-id="685ed-113">Une action d’installation simultanée peut uniquement réinstaller ou supprimer une application qui a été installée par le package d’installation de l’application actuelle.</span><span class="sxs-lookup"><span data-stu-id="685ed-113">A concurrent installation action can only reinstall or remove an application that has been installed by the current application's installation package.</span></span>

<span data-ttu-id="685ed-114">Le type d’action d’installation simultanée est spécifié dans le champ type de la table CustomAction.</span><span class="sxs-lookup"><span data-stu-id="685ed-114">The type of concurrent installation action is specified in the Type field of the CustomAction table.</span></span> <span data-ttu-id="685ed-115">Selon le type d’action personnalisé, le package de l’application simultanée peut résider dans un sous-stockage du package principal, sous la forme d’un fichier à un emplacement spécifié par une propriété, ou sous la forme d’une application publiée sur l’ordinateur de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="685ed-115">Depending upon the custom action type, the package for the concurrent application can reside in a substorage of the main package, as a file at a location specified by a property, or as an advertised application on the user's machine.</span></span> <span data-ttu-id="685ed-116">Les types d’actions personnalisées suivants effectuent une installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-116">The following types of custom actions perform a concurrent installation.</span></span>



| <span data-ttu-id="685ed-117">Type d’action personnalisé</span><span class="sxs-lookup"><span data-stu-id="685ed-117">Custom action type</span></span>                                 | <span data-ttu-id="685ed-118">Description</span><span class="sxs-lookup"><span data-stu-id="685ed-118">Description</span></span>                                                                     |
|----------------------------------------------------|---------------------------------------------------------------------------------|
| [<span data-ttu-id="685ed-119">Type d’action personnalisé 7</span><span class="sxs-lookup"><span data-stu-id="685ed-119">Custom Action Type 7</span></span>](custom-action-type-7.md)   | <span data-ttu-id="685ed-120">Installation simultanée d’un produit résidant dans le package d’installation.</span><span class="sxs-lookup"><span data-stu-id="685ed-120">Concurrent installation of a product residing in the installation package.</span></span>      |
| [<span data-ttu-id="685ed-121">Type d’action personnalisé 23</span><span class="sxs-lookup"><span data-stu-id="685ed-121">Custom Action Type 23</span></span>](custom-action-type-23.md) | <span data-ttu-id="685ed-122">Installation simultanée d’un package d’installation dans l’arborescence source actuelle.</span><span class="sxs-lookup"><span data-stu-id="685ed-122">Concurrent installation of an installer package within the current source tree.</span></span> |
| [<span data-ttu-id="685ed-123">Type d’action personnalisé 39</span><span class="sxs-lookup"><span data-stu-id="685ed-123">Custom Action Type 39</span></span>](custom-action-type-39.md) | <span data-ttu-id="685ed-124">Installation simultanée d’un package d’installation publié.</span><span class="sxs-lookup"><span data-stu-id="685ed-124">Concurrent installation of an advertised installer package.</span></span>                     |



 

<span data-ttu-id="685ed-125">Une installation simultanée partage les mêmes paramètres d’interface utilisateur et de journalisation que l’installation principale.</span><span class="sxs-lookup"><span data-stu-id="685ed-125">A concurrent installation shares the same user interface and logging settings as the main installation.</span></span>

<span data-ttu-id="685ed-126">Les actions d’installation simultanée doivent être placées entre l’action [InstallInitialize](installinitialize-action.md) et l' [action InstallFinalize](installfinalize-action.md) de la séquence d’action de l’installation principale.</span><span class="sxs-lookup"><span data-stu-id="685ed-126">Concurrent installation actions should be placed between the [InstallInitialize action](installinitialize-action.md) and [InstallFinalize action](installfinalize-action.md) of the main installation's action sequence.</span></span> <span data-ttu-id="685ed-127">Lors de la restauration de l’installation principale, le programme d’installation annule également l’installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-127">Upon rollback of the main installation, the installer will then rollback the concurrent installation as well.</span></span> <span data-ttu-id="685ed-128">L’utilisation d’une [exécution différée](deferred-execution-custom-actions.md) avec des actions d’installation simultanées est inutile, car le programme d’installation combine les informations de restauration des installations simultanées et principales.</span><span class="sxs-lookup"><span data-stu-id="685ed-128">The use of [deferred execution](deferred-execution-custom-actions.md) with concurrent installation actions is unnecessary because the installer combines rollback information from the concurrent and main installations.</span></span> <span data-ttu-id="685ed-129">Toutes les modifications sont annulées lors de l’installation d’une restauration.</span><span class="sxs-lookup"><span data-stu-id="685ed-129">All changes are reversed upon a rollback installation.</span></span>

<span data-ttu-id="685ed-130">Les valeurs de retour pour les actions d’installation simultanées sont les mêmes que pour d’autres actions personnalisées.</span><span class="sxs-lookup"><span data-stu-id="685ed-130">The return values for concurrent installation actions are the same as for other custom actions.</span></span> <span data-ttu-id="685ed-131">Consultez [valeurs de retour de l’action personnalisée](custom-action-return-values.md).</span><span class="sxs-lookup"><span data-stu-id="685ed-131">See [Custom Action Return Values](custom-action-return-values.md).</span></span>

<span data-ttu-id="685ed-132">Les actions standard ou personnalisées qui spécifient un redémarrage automatique du système ou demandent à l’utilisateur de redémarrer, peuvent également effectuer un redémarrage ou une demande à partir d’une installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-132">Standard or custom actions that specify an automatic restart of the system, or request the user to restart, can also perform restart or request from within a concurrent installation.</span></span>

<span data-ttu-id="685ed-133">Une fois que le programme d’installation a lancé une installation simultanée, il verrouille toutes les autres installations jusqu’à ce que l’installation simultanée soit terminée et avant de poursuivre l’installation principale.</span><span class="sxs-lookup"><span data-stu-id="685ed-133">Once the installer begins a concurrent installation, it locks out all other installations until the concurrent installation is complete and before continuing the main installation.</span></span> <span data-ttu-id="685ed-134">Le programme d’installation peut uniquement exécuter des installations simultanées en tant qu’actions personnalisées synchrones.</span><span class="sxs-lookup"><span data-stu-id="685ed-134">The installer can only execute concurrent installations as synchronous custom actions.</span></span> <span data-ttu-id="685ed-135">Consultez [actions personnalisées synchrones et asynchrones](synchronous-and-asynchronous-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="685ed-135">See [Synchronous and Asynchronous Custom Actions](synchronous-and-asynchronous-custom-actions.md).</span></span> <span data-ttu-id="685ed-136">Les indicateurs d’option décrits dans [options de traitement des retours d’actions personnalisées](custom-action-return-processing-options.md) doivent être définis sur aucun (+ 0) ou **msidbCustomActionTypeContinue** (+ 64).</span><span class="sxs-lookup"><span data-stu-id="685ed-136">The option flags described in [Custom Action Return Processing Options](custom-action-return-processing-options.md) must be set to none (+0) or **msidbCustomActionTypeContinue** (+64).</span></span>

<span data-ttu-id="685ed-137">Une action d’installation simultanée peut installer une application pour qu’elle soit exécutée localement, pour être exécutée à partir de la source, pour être réinstallée ou supprimée de la même façon que lors de l’utilisation de [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) pour une installation normale.</span><span class="sxs-lookup"><span data-stu-id="685ed-137">A concurrent installation action can install an application to be run locally, to run from source, to be reinstalled, or to be removed in the same manner as when using [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) for a regular installation.</span></span> <span data-ttu-id="685ed-138">Pour spécifier le type d’installation, transmettez la propriété [**addlocal**](addlocal.md), [**addsource**](addsource.md), [**REINSTALL**](reinstall.md)ou [**Remove**](remove.md) à l’action d’installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-138">To specify the type of installation, pass either the [**ADDLOCAL**](addlocal.md), [**ADDSOURCE**](addsource.md), [**REINSTALL**](reinstall.md), or [**REMOVE**](remove.md) property to the concurrent installation action.</span></span>

<span data-ttu-id="685ed-139">Les actions d’installation simultanée peuvent être créées par paires, une action utilisée pour installer et l’autre action utilisée pour supprimer l’installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-139">Concurrent installation actions can be authored in pairs, one action used for installing and the other action used for removing the concurrent installation.</span></span> <span data-ttu-id="685ed-140">Un [type d’action personnalisé 7](custom-action-type-7.md) ou un [type d’action personnalisé 23](custom-action-type-23.md) est généralement utilisé pour installer.</span><span class="sxs-lookup"><span data-stu-id="685ed-140">A [Custom Action Type 7](custom-action-type-7.md) or [Custom Action Type 23](custom-action-type-23.md) is typically used to install.</span></span> <span data-ttu-id="685ed-141">Un [type d’action personnalisé 39](custom-action-type-39.md) est généralement utilisé pour supprimer l’installation simultanée lorsque le produit parent est désinstallé.</span><span class="sxs-lookup"><span data-stu-id="685ed-141">A [Custom Action Type 39](custom-action-type-39.md) is typically used to remove the concurrent installation when the parent product is uninstalled.</span></span> <span data-ttu-id="685ed-142">L’enregistrement de l’action personnalisée de suppression dans la [table CustomAction](customaction-table.md) peut avoir le GUID du code du produit dans le champ source et « Remove = All » dans le champ cible.</span><span class="sxs-lookup"><span data-stu-id="685ed-142">The record for the removal custom action in the [CustomAction table](customaction-table.md) can have the product code GUID in the Source field and "REMOVE=ALL" in the Target field.</span></span> <span data-ttu-id="685ed-143">Les deux actions personnalisées doivent être créées dans la table de séquence d’action avec des conditions qui s’excluent mutuellement.</span><span class="sxs-lookup"><span data-stu-id="685ed-143">The two custom actions need to be authored in the action sequence table with mutually exclusive conditions.</span></span> <span data-ttu-id="685ed-144">Par exemple, l’action personnalisée qui installe le produit peut avoir « non installé » dans son champ condition et l’action personnalisée supprimer l’installation simultanée peut avoir REMOVE = « ALL » dans son champ condition.</span><span class="sxs-lookup"><span data-stu-id="685ed-144">For example, the custom action that installs the product can have "NOT Installed" in its Condition field and the custom action removes the concurrent installation can have REMOVE="ALL" in its Condition field.</span></span>

<span data-ttu-id="685ed-145">Il n’existe aucune méthode pour interroger un package à son coût.</span><span class="sxs-lookup"><span data-stu-id="685ed-145">There is no method for querying a package for its cost.</span></span> <span data-ttu-id="685ed-146">Cela complique le coût d’installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="685ed-146">This makes the costing of a concurrent installations difficult.</span></span> <span data-ttu-id="685ed-147">Des lignes doivent être ajoutées à la [table ReserveCost](reservecost-table.md) pour indiquer les dossiers et les pires coûts du composant associé à l’installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-147">Rows must be added to the [ReserveCost table](reservecost-table.md) to indicate the folders and worst-case costs of the component associated with the concurrent install.</span></span>

<span data-ttu-id="685ed-148">Les seules [options de traitement de retour d’action personnalisées](custom-action-return-processing-options.md) disponibles avec des actions d’installation simultanées sont None (+ 0) ou **msidbCustomActionTypeContinue** (+ 64).</span><span class="sxs-lookup"><span data-stu-id="685ed-148">The only [Custom Action Return Processing Options](custom-action-return-processing-options.md) available with concurrent installation actions are none (+0) or **msidbCustomActionTypeContinue** (+64).</span></span>

<span data-ttu-id="685ed-149">Notez qu’une installation parente ne peut pas appeler son propre package en tant qu’action d’installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-149">Note that a parent installation cannot call its own package as a concurrent installation action.</span></span>

<span data-ttu-id="685ed-150">Notez que si une installation par ordinateur tente d’exécuter une installation simultanée par utilisateur, le programme d’installation inscrit l’installation parente en tant qu’utilisateur par défaut.</span><span class="sxs-lookup"><span data-stu-id="685ed-150">Note that if a per-machine installation attempts to run a per-user concurrent installation, the installer registers the parent installation as per-user by default.</span></span> <span data-ttu-id="685ed-151">Cela peut entraîner la suppression incorrecte de l’application par le programme d’installation, car le programme d’installation tente de désinstaller l’application par ordinateur lorsqu’elle est inscrite en tant qu’utilisateur par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="685ed-151">This can cause the installer to incorrectly remove the application because the installer attempts to uninstall the application per-machine when it is actually registered as per-user.</span></span> <span data-ttu-id="685ed-152">Pour forcer l’état d’une installation simultanée à suivre l’état de son installation parente, entrez ALLUSERS = " \[ ALLUSERS \] " dans la colonne cible de la [table CustomAction](customaction-table.md).</span><span class="sxs-lookup"><span data-stu-id="685ed-152">To force the state of a concurrent installation to track the state of its parent installation, enter ALLUSERS="\[ALLUSERS\]" in the Target column of the [CustomAction table](customaction-table.md).</span></span> <span data-ttu-id="685ed-153">Dans ce cas, l’installation simultanée est par machine si le parent est par ordinateur, et si l’installation simultanée est par utilisateur si le parent est par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="685ed-153">In this case, the concurrent installation is per-machine if the parent is per-machine, and the concurrent installation is per-user if the parent is per-user.</span></span>

<span data-ttu-id="685ed-154">Les développeurs doivent noter les avertissements suivants lors de la création d’installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="685ed-154">Developers should note the following warnings when authoring concurrent installations.</span></span>

-   <span data-ttu-id="685ed-155">Les installations simultanées ne peuvent pas partager des composants.</span><span class="sxs-lookup"><span data-stu-id="685ed-155">Concurrent installations cannot share components.</span></span>
-   <span data-ttu-id="685ed-156">Une installation d’administration ne peut pas également contenir une installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-156">An administrative installation cannot also contain a concurrent installation.</span></span>
-   <span data-ttu-id="685ed-157">L’application de correctifs et la mise à niveau peuvent ne pas fonctionner avec des installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="685ed-157">Patching and upgrading may not work with concurrent installations.</span></span>
-   <span data-ttu-id="685ed-158">Le programme d’installation peut ne pas coûter correctement une installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-158">The installer may not properly cost a concurrent installation.</span></span>
-   <span data-ttu-id="685ed-159">Les ProgressBars intégrés ne peuvent pas être utilisés avec des installations simultanées.</span><span class="sxs-lookup"><span data-stu-id="685ed-159">Integrated ProgressBars cannot be used with concurrent installations.</span></span>
-   <span data-ttu-id="685ed-160">Les ressources qui doivent être publiées ne peuvent pas être installées par l’installation simultanée.</span><span class="sxs-lookup"><span data-stu-id="685ed-160">Resources that are to be advertised cannot be installed by the concurrent installation.</span></span>
-   <span data-ttu-id="685ed-161">Un package qui effectue une installation simultanée d’une application doit également désinstaller l’application simultanée lorsque le produit parent est désinstallé.</span><span class="sxs-lookup"><span data-stu-id="685ed-161">A package that performs a concurrent installation of an application should also uninstall the concurrent application when the parent product is uninstalled.</span></span>

<span data-ttu-id="685ed-162">Pour empêcher l’installation d’un package en tant qu’installation simultanée, ajoutez l’une des instructions conditionnelles suivantes à la table [LaunchCondition](launchcondition-table.md) .</span><span class="sxs-lookup"><span data-stu-id="685ed-162">To prevent a package from ever being installed as a concurrent installation, add either of the following conditional statements to the [LaunchCondition](launchcondition-table.md) table.</span></span> <span data-ttu-id="685ed-163">Cela évite que le package ne soit installé par une action d’installation simultanée exécutée par une autre installation.</span><span class="sxs-lookup"><span data-stu-id="685ed-163">This prevents the package from ever being installed by a concurrent installation action run by another installation.</span></span> <span data-ttu-id="685ed-164">Cela n’empêche pas le package d’être supprimé par l’action [RemoveExistingProducts](removeexistingproducts-action.md) .</span><span class="sxs-lookup"><span data-stu-id="685ed-164">This does not prevent the package from being removed by the [RemoveExistingProducts](removeexistingproducts-action.md) action.</span></span> <span data-ttu-id="685ed-165">Consultez également la propriété [**ParentOriginalDatabase**](parentoriginaldatabase.md) et la propriété [**ParentProductCode**](parentproductcode.md) .</span><span class="sxs-lookup"><span data-stu-id="685ed-165">See also the [**ParentOriginalDatabase**](parentoriginaldatabase.md) property and [**ParentProductCode**](parentproductcode.md) property.</span></span>

``` syntax
"Not ParentProductCode"
```

``` syntax
"Not ParentOriginalDatabase"
```

 

 



