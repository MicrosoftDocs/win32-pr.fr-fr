---
description: Windows Installer pouvez réparer, remplacer et vérifier les fichiers contenus dans une application. Une réinstallation partielle ou complète de l’application peut être nécessaire si des fichiers ou des entrées de Registre associés à une fonctionnalité sont manquants ou endommagés.
ms.assetid: fab23ab9-f1ab-4743-b883-cffc29b0124b
title: Réinstallation d’une fonctionnalité ou d’une application
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 645f7dbf95204d96202c71a120eafb6e6e054ac6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104115498"
---
# <a name="reinstalling-a-feature-or-application"></a><span data-ttu-id="e85af-104">Réinstallation d’une fonctionnalité ou d’une application</span><span class="sxs-lookup"><span data-stu-id="e85af-104">Reinstalling a Feature or Application</span></span>

<span data-ttu-id="e85af-105">Windows Installer pouvez réparer, remplacer et vérifier les fichiers contenus dans une application.</span><span class="sxs-lookup"><span data-stu-id="e85af-105">Windows Installer can repair, replace, and verify files contained in an application.</span></span> <span data-ttu-id="e85af-106">Une réinstallation partielle ou complète de l’application peut être nécessaire si des fichiers ou des entrées de Registre associés à une fonctionnalité sont manquants ou endommagés.</span><span class="sxs-lookup"><span data-stu-id="e85af-106">A partial or complete application reinstallation might be required if any files or registry entries associated with any feature are missing or corrupt.</span></span>

<span data-ttu-id="e85af-107">Quand une fonctionnalité ou une application est réinstallée, tous les services, les variables d’environnement et les actions personnalisées appartenant à la fonctionnalité ou à l’application sont également réinstallés.</span><span class="sxs-lookup"><span data-stu-id="e85af-107">When a feature or application is reinstalled, all the services, environment variables, and custom actions belonging to the feature or application are reinstalled as well.</span></span> <span data-ttu-id="e85af-108">Notez que cela signifie que toutes les modifications apportées aux variables d’environnement entre l’installation d’origine et la réinstallation sont perdues.</span><span class="sxs-lookup"><span data-stu-id="e85af-108">Note that this means that any changes made to environment variables between the original installation and the reinstallation are lost.</span></span>

<span data-ttu-id="e85af-109">La liste suivante contient les méthodes de réinstallation d’une fonctionnalité ou d’un produit.</span><span class="sxs-lookup"><span data-stu-id="e85af-109">The following list contains methods of reinstalling a feature or product.</span></span> <span data-ttu-id="e85af-110">Les deux premières méthodes ont été automatisées par le programme d’installation :</span><span class="sxs-lookup"><span data-stu-id="e85af-110">The first two methods have been automated by the installer:</span></span>

-   <span data-ttu-id="e85af-111">Réparez, remplacez ou vérifiez les fichiers en appelant la fonction [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) .</span><span class="sxs-lookup"><span data-stu-id="e85af-111">Repair, replace, or verify files by calling the [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) function.</span></span>
-   <span data-ttu-id="e85af-112">Réinstallez l’intégralité du produit en appelant la fonction [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) .</span><span class="sxs-lookup"><span data-stu-id="e85af-112">Reinstall the entire product by calling the [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) function.</span></span>
-   <span data-ttu-id="e85af-113">Réinstallez, remplacez ou vérifiez les fichiers avec un bouton de contrôle de l’interface utilisateur du programme d’installation via le [ControlEvent, réinstaller](reinstall-controlevent.md).</span><span class="sxs-lookup"><span data-stu-id="e85af-113">Reinstall, replace, or verify files with an installer UI control button through the [Reinstall ControlEvent](reinstall-controlevent.md).</span></span>
-   <span data-ttu-id="e85af-114">Réinstallez, remplacez ou vérifiez les fichiers à partir d’une ligne de commande en définissant les propriétés [**REINSTALL**](reinstall.md) et [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="e85af-114">Reinstall, replace, or verify files from a command line by setting the [**REINSTALL**](reinstall.md) property and the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

<span data-ttu-id="e85af-115">Pour plus d’informations sur la réinstallation d’une fonctionnalité ou d’une application, consultez [résilience](resiliency.md).</span><span class="sxs-lookup"><span data-stu-id="e85af-115">For more information on reinstalling a feature or application, see [Resiliency](resiliency.md).</span></span>

<span data-ttu-id="e85af-116">**Pour réinstaller un produit à l’aide du programme d’installation**</span><span class="sxs-lookup"><span data-stu-id="e85af-116">**To reinstall a product using the installer**</span></span>

-   <span data-ttu-id="e85af-117">Appelez [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span><span class="sxs-lookup"><span data-stu-id="e85af-117">Call [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span></span>

<span data-ttu-id="e85af-118">**Pour réinstaller une fonctionnalité à l’aide du programme d’installation**</span><span class="sxs-lookup"><span data-stu-id="e85af-118">**To reinstall a feature using the installer**</span></span>

-   <span data-ttu-id="e85af-119">Appelez [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="e85af-119">Call [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="e85af-120">**Pour réinstaller un produit ou une fonctionnalité à l’aide d’une interface utilisateur du programme d’installation**</span><span class="sxs-lookup"><span data-stu-id="e85af-120">**To reinstall a product or feature with an installer user interface**</span></span>

1.  <span data-ttu-id="e85af-121">Ajoutez un bouton à la boîte de dialogue spécifiée en ajoutant une entrée à la [table de contrôle](control-table.md).</span><span class="sxs-lookup"><span data-stu-id="e85af-121">Add a button to the specified dialog box by adding an entry to the [Control table](control-table.md).</span></span>
2.  <span data-ttu-id="e85af-122">Ajoutez un [ControlEvent, ReinstallMode](reinstallmode-controlevent.md) à la table ControlEvent,, avec les champs de boîte de dialogue \_ et de contrôle qui \_ référencent le contrôle Button créé à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="e85af-122">Add a [ReinstallMode ControlEvent](reinstallmode-controlevent.md) to the ControlEvent table, with the Dialog\_ and Control\_ fields referencing the button control created in step 1.</span></span> <span data-ttu-id="e85af-123">Dans le champ argument, entrez une chaîne contenant les lettres correspondant aux modes de réinstallation souhaités (les valeurs acceptables pour ce champ sont identiques à celles acceptées pour la propriété [**REINSTALLMODE**](reinstallmode.md) ).</span><span class="sxs-lookup"><span data-stu-id="e85af-123">In the Argument field, enter a string containing the letters corresponding to the reinstall modes you want (the acceptable values for this field are identical to those accepted for the [**REINSTALLMODE**](reinstallmode.md) property).</span></span> <span data-ttu-id="e85af-124">La valeur dans la colonne classement de cet événement doit être 1.</span><span class="sxs-lookup"><span data-stu-id="e85af-124">The value in the Ordering column for this event should be 1.</span></span>
3.  <span data-ttu-id="e85af-125">Ajoutez un événement de [réinstallation ControlEvent,](reinstall-controlevent.md) à la [table ControlEvent,](controlevent-table.md), en référençant à nouveau le même contrôle bouton.</span><span class="sxs-lookup"><span data-stu-id="e85af-125">Add a [Reinstall ControlEvent](reinstall-controlevent.md) event to the [ControlEvent table](controlevent-table.md), again referencing the same button control.</span></span> <span data-ttu-id="e85af-126">Le champ argument de cet événement est normalement ALL, pour forcer la réinstallation de toutes les fonctionnalités, mais vous pouvez placer le nom d’une fonctionnalité spécifique ici.</span><span class="sxs-lookup"><span data-stu-id="e85af-126">The Argument field for this event will normally be ALL, to force reinstallation of all features, but you can place the name of a specific feature here.</span></span> <span data-ttu-id="e85af-127">La valeur dans la colonne classement de cet événement doit être 2.</span><span class="sxs-lookup"><span data-stu-id="e85af-127">The value in the Ordering column for this event should be 2.</span></span>
4.  <span data-ttu-id="e85af-128">Ajoutez un événement supplémentaire lié au même contrôle de bouton pour lancer la réinstallation.</span><span class="sxs-lookup"><span data-stu-id="e85af-128">Add one more event tied to the same button control, to actually initiate the reinstallation.</span></span> <span data-ttu-id="e85af-129">Il peut s’agir d’un événement EndDialog (avec un argument Return).</span><span class="sxs-lookup"><span data-stu-id="e85af-129">This can be an EndDialog event (with an argument of Return).</span></span> <span data-ttu-id="e85af-130">En général, toutefois, un événement NewDialog serait utilisé ici pour accéder à une boîte de dialogue **voulez-vous vraiment réinstaller ?** confirmer.</span><span class="sxs-lookup"><span data-stu-id="e85af-130">More typically, however, a NewDialog event would be used here to jump to an **Are you sure you want to reinstall?** confirmation dialog box.</span></span> <span data-ttu-id="e85af-131">La valeur dans la colonne classement de cet événement doit être 3.</span><span class="sxs-lookup"><span data-stu-id="e85af-131">The value in the Ordering column for this event should be 3.</span></span>

    <span data-ttu-id="e85af-132">Si vous le souhaitez, plusieurs boutons de [**réinstallation**](reinstall.md) peuvent être créés pour une seule boîte de dialogue, ce qui permet à l’utilisateur de sélectionner le type de réinstallation effectué.</span><span class="sxs-lookup"><span data-stu-id="e85af-132">If desired, several [**REINSTALL**](reinstall.md) buttons can be created for a single dialog box, allowing the user to select the type of reinstallation performed.</span></span> <span data-ttu-id="e85af-133">Dans ce cas, chaque bouton est créé comme indiqué dans la procédure précédente, avec un autre paramètre [ControlEvent, ReinstallMode](reinstallmode-controlevent.md) pour chaque bouton.</span><span class="sxs-lookup"><span data-stu-id="e85af-133">In this case, each button is authored as outlined in the preceding procedure, with a different [ReinstallMode ControlEvent](reinstallmode-controlevent.md) parameter for each button.</span></span>

<span data-ttu-id="e85af-134">Une fois qu’un produit particulier a été installé (avec une partie ou la totalité des fonctionnalités du produit), une réinstallation peut être effectuée à partir de la ligne de commande :</span><span class="sxs-lookup"><span data-stu-id="e85af-134">Once a particular product has been installed (with some or all of the product's features), a reinstallation can be performed at the command line:</span></span>

<span data-ttu-id="e85af-135">**Pour réinstaller un produit ou une fonctionnalité à partir d’une ligne de commande**</span><span class="sxs-lookup"><span data-stu-id="e85af-135">**To reinstall a product or feature from a command line**</span></span>

1.  <span data-ttu-id="e85af-136">À partir de l’invite de commandes, spécifiez la propriété [**réinstaller**](reinstall.md) .</span><span class="sxs-lookup"><span data-stu-id="e85af-136">From the command prompt, specify the [**REINSTALL**](reinstall.md) property.</span></span>
2.  <span data-ttu-id="e85af-137">À partir de l’invite de commandes, spécifiez la propriété [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="e85af-137">From the command prompt, specify the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

    <span data-ttu-id="e85af-138">La spécification de ces propriétés permet à l’utilisateur de réinstaller tout ou partie des fonctionnalités du produit.</span><span class="sxs-lookup"><span data-stu-id="e85af-138">Specifying these properties allows the user to reinstall any or all of the product's features.</span></span> <span data-ttu-id="e85af-139">Le type de réinstallation peut également être spécifié.</span><span class="sxs-lookup"><span data-stu-id="e85af-139">The type of reinstallation can also be specified.</span></span> <span data-ttu-id="e85af-140">Par exemple, vous pouvez spécifier que seuls les fichiers qui sont complètement manquants doivent être réinstallés, ou que seuls les fichiers endommagés (par exemple, tout fichier exécutable dont le checksum ne correspond pas au contenu réel du fichier) soient remplacés.</span><span class="sxs-lookup"><span data-stu-id="e85af-140">For example, you can specify that only those files that are completely missing should be reinstalled, or that only corrupt files (for example, any executable file whose checksum does not match the actual file contents) be replaced.</span></span>

 

 



