---
description: L’Windows Installer stocke toutes les chaînes de base de données dans un seul pool de chaînes partagé pour réduire la taille de la base de données et améliorer les performances. Pour obtenir la liste des pages de codes numériques, consultez localisation des tables Error et ActionText.
ms.assetid: 5d413fb7-99da-49f3-ace3-ec285df2e634
title: Gestion des pages de codes (Windows Installer)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6db2788a1bfc6bdb49ec1402d5bba8a1a2594b30
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106524075"
---
# <a name="code-page-handling-windows-installer"></a><span data-ttu-id="87418-104">Gestion des pages de codes (Windows Installer)</span><span class="sxs-lookup"><span data-stu-id="87418-104">Code Page Handling (Windows Installer)</span></span>

<span data-ttu-id="87418-105">L’Windows Installer stocke toutes les chaînes de base de données dans un seul pool de chaînes partagé pour réduire la taille de la base de données et améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="87418-105">The Windows Installer stores all database strings in a single shared string pool to reduce the size of the database, and to improve performance.</span></span> <span data-ttu-id="87418-106">Pour obtenir la liste des pages de codes numériques, consultez [localisation des tables Error et ActionText](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="87418-106">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="87418-107">Pour plus d’informations, [détermination de la page de codes d’une base de données d’installation](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="87418-107">For more information, [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

<span data-ttu-id="87418-108">Windows Installer utilise [**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) pour déterminer si la page de codes est valide.</span><span class="sxs-lookup"><span data-stu-id="87418-108">Windows Installer uses [**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) to determine whether the code page is valid.</span></span>

### <a name="localizing-a-windows-installer-package"></a><span data-ttu-id="87418-109">Localisation d’un package Windows Installer</span><span class="sxs-lookup"><span data-stu-id="87418-109">Localizing a Windows Installer Package</span></span>

<span data-ttu-id="87418-110">Si vous localisez un package de Windows Installer, il peut impliquer la modification des informations dans les tables de base de données, l’exportation des tables vers des fichiers d’archive de texte ANSI, puis l’importation des fichiers d’archive dans la base de données localisée.</span><span class="sxs-lookup"><span data-stu-id="87418-110">If you localize a Windows Installer package, it may involve modifying information in database tables, exporting the tables to ANSI text archive files, and then importing the archive files into the database that is being localized.</span></span> <span data-ttu-id="87418-111">Vous pouvez également ajouter des modifications de localisation à une base de données à l’aide d’un éditeur de table de base de données ou [de fonctions de base de données](database-functions.md).</span><span class="sxs-lookup"><span data-stu-id="87418-111">You can also add localization changes to a database by using a database table editor or the [Database Functions](database-functions.md).</span></span> <span data-ttu-id="87418-112">Il est important de définir la page de codes de la base de données qui est localisée avant d’apporter des modifications de localisation à la base de données.</span><span class="sxs-lookup"><span data-stu-id="87418-112">It is important to set the code page of the database that is being localized before you make any localization changes to the database.</span></span> <span data-ttu-id="87418-113">Ne définissez pas la page de codes de la base de données après la localisation de la base de données, car cela peut corrompre les caractères étendus.</span><span class="sxs-lookup"><span data-stu-id="87418-113">Do not set the code page of the database after localizing the database, because this can corrupt extended characters.</span></span> <span data-ttu-id="87418-114">Pour plus d’informations, consultez [définition de la page de codes d’une base de données](setting-the-code-page-of-a-database.md).</span><span class="sxs-lookup"><span data-stu-id="87418-114">For more information, see [Setting the Code Page of a Database](setting-the-code-page-of-a-database.md).</span></span>

<span data-ttu-id="87418-115">L’approche recommandée pour gérer les pages de codes consiste à créer une base de données neutre qui contient uniquement des caractères qui peuvent être traduits dans une page de codes.</span><span class="sxs-lookup"><span data-stu-id="87418-115">The recommended approach for handling code pages is to author a neutral database that only contains characters that can be translated into any code page.</span></span> <span data-ttu-id="87418-116">Pour plus d’informations, consultez [création d’une base de données à l’aide d’une page de codes neutre](creating-a-database-with-a-neutral-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="87418-116">For more information, see [Creating a Database with a Neutral Code Page](creating-a-database-with-a-neutral-code-page.md).</span></span>

<span data-ttu-id="87418-117">Si vous ajoutez des informations de localisation à des fichiers d’archive de base de données, vous pouvez utiliser [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) pour exporter des tables à partir d’une base de données qui contient des modifications de localisation vers des fichiers d’archive de texte ANSI, puis les importer dans la base de données localisée avec [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="87418-117">If you add localization information with database archive files, you can use [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) to export tables from a database that contains localization changes to ANSI text archive files, and then import these into the database being localized with [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="87418-118">La page de codes d’un fichier d’archive exporté est toujours la même que la base de données parente.</span><span class="sxs-lookup"><span data-stu-id="87418-118">The code page of an exported archive file is always the same as its parent database.</span></span> <span data-ttu-id="87418-119">Les pages de codes d’un fichier importé et la base de données qui reçoit le fichier doivent être identiques, ou au moins l’une des deux pages de codes doit être neutre.</span><span class="sxs-lookup"><span data-stu-id="87418-119">The code pages of an imported file and the database that is receiving the file must be identical, or at least one of the two code pages must be neutral.</span></span> <span data-ttu-id="87418-120">Pour plus d’informations, consultez [gestion des pages de codes des tables importées et exportées](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="87418-120">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

<span data-ttu-id="87418-121">Si vous ajoutez des informations de localisation à l’aide d’un éditeur de texte ou si les [fonctions de base de données](database-functions.md) veillent uniquement à passer des paramètres de chaîne à l’API Windows Installer qui utilise la page de codes de la base de données localisée.</span><span class="sxs-lookup"><span data-stu-id="87418-121">If you add localization information with a text editor or the [Database Functions](database-functions.md) be careful to only pass string parameters to the Windows Installer API that uses the code page of the database that is being localized.</span></span> <span data-ttu-id="87418-122">Si un paramètre de chaîne contient des caractères qui ne sont pas représentés par la page de codes de la base de données, une erreur se produit lors de l’appel de [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span><span class="sxs-lookup"><span data-stu-id="87418-122">If a string parameter contains characters not represented by the code page of the database, an error occurs when calling [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span> <span data-ttu-id="87418-123">Pour plus d’informations, consultez [gestion des pages de codes des chaînes de paramètres](code-page-handling-of-parameter-strings.md).</span><span class="sxs-lookup"><span data-stu-id="87418-123">For more information, see [Code Page Handling of Parameter Strings](code-page-handling-of-parameter-strings.md).</span></span>

<span data-ttu-id="87418-124">Si un package est utilisé pour installer plusieurs versions linguistiques d’un produit, la transformation utilisée pour localiser les chaînes peut également modifier la page de codes de la base de données.</span><span class="sxs-lookup"><span data-stu-id="87418-124">If one package is used to install multiple language versions of a product, the transform that is used to localize strings can also change the code page of the database.</span></span>

 

 
