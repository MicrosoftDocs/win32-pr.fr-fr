---
description: Une utilisation courante des composants transitives consiste à préparer un produit à réinstaller pendant une mise à niveau du système.
ms.assetid: 73677573-945f-4646-89d8-93e28f7856fe
title: Utilisation de composants transitifs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35982aafd486a62ce8560e507b8b6caf88e32591
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/05/2021
ms.locfileid: "103953508"
---
# <a name="using-transitive-components"></a><span data-ttu-id="b42c7-103">Utilisation de composants transitifs</span><span class="sxs-lookup"><span data-stu-id="b42c7-103">Using Transitive Components</span></span>

<span data-ttu-id="b42c7-104">Une utilisation courante des composants transitives consiste à préparer un produit à réinstaller pendant une mise à niveau du système.</span><span class="sxs-lookup"><span data-stu-id="b42c7-104">A typical use for transitive components is to prepare a product to reinstall during a system upgrade.</span></span> <span data-ttu-id="b42c7-105">L’auteur du package d’installation de spécifie les composants qui doivent être échangés pendant une mise à niveau du système comme ayant l’attribut transitif.</span><span class="sxs-lookup"><span data-stu-id="b42c7-105">The author of the installation package specifies those components that need to be swapped out during a system upgrade as having the transitive attribute.</span></span> <span data-ttu-id="b42c7-106">Lorsque l’utilisateur met ultérieurement à niveau le système, le produit doit être réinstallé.</span><span class="sxs-lookup"><span data-stu-id="b42c7-106">When the user later upgrades the system, the product must be reinstalled.</span></span> <span data-ttu-id="b42c7-107">Lors de cette réinstallation, le programme d’installation supprime les composants précédents et installe les composants ultérieurs, sans avoir à installer l’intégralité du produit.</span><span class="sxs-lookup"><span data-stu-id="b42c7-107">Upon this reinstall, the installer removes the earlier components and installs the later components, without having to install the entire product.</span></span>

<span data-ttu-id="b42c7-108">**Pour inclure deux composants transitifs dans le package d’installation**</span><span class="sxs-lookup"><span data-stu-id="b42c7-108">**To include two transitive components in the installation package**</span></span>

1.  <span data-ttu-id="b42c7-109">Incluez les deux composants transitifs dans le package d’installation.</span><span class="sxs-lookup"><span data-stu-id="b42c7-109">Include both transitive components in the installation package.</span></span>
2.  <span data-ttu-id="b42c7-110">Créez les deux composants transitifs dans la [table](component-table.md) des composants de la même façon que les composants normaux.</span><span class="sxs-lookup"><span data-stu-id="b42c7-110">Author both transitive components into the [Component table](component-table.md) the same as regular components.</span></span> <span data-ttu-id="b42c7-111">Chaque composant transitif doit avoir son propre GUID unique spécifié dans la colonne ComponentId.</span><span class="sxs-lookup"><span data-stu-id="b42c7-111">Each transitive component must have its own unique GUID specified in the ComponentId column.</span></span>
3.  <span data-ttu-id="b42c7-112">Incluez le bit **msidbComponentAttributesTransitive** dans la colonne attributs de la table des composants pour chaque composant transitif.</span><span class="sxs-lookup"><span data-stu-id="b42c7-112">Include the **msidbComponentAttributesTransitive** bit in the Attributes column of the Component table for each transitive component.</span></span> <span data-ttu-id="b42c7-113">Si ce bit est défini, le programme d’installation réévalue la valeur de l’instruction dans la colonne condition lors de la réinstallation.</span><span class="sxs-lookup"><span data-stu-id="b42c7-113">If this bit is set, the installer reevaluates the value of the statement in the Condition column upon a reinstall.</span></span>

    <span data-ttu-id="b42c7-114">Si la valeur était précédemment false et a été remplacée par true, le programme d’installation installe le composant.</span><span class="sxs-lookup"><span data-stu-id="b42c7-114">If the value was previously False and has changed to True, the installer installs the component.</span></span>

    <span data-ttu-id="b42c7-115">Si la valeur était précédemment true et a été remplacée par false, le programme d’installation supprime le composant même si le composant a d’autres produits comme clients.</span><span class="sxs-lookup"><span data-stu-id="b42c7-115">If the value was previously True and has changed to False the installer removes the component even if the component has other products as clients.</span></span>

    > [!Note]  
    > <span data-ttu-id="b42c7-116">À moins que le bit transitif ne soit défini, le composant reste activé une fois installé, même si l’instruction conditionnelle prend la valeur false lors d’une installation de maintenance ultérieure du produit.</span><span class="sxs-lookup"><span data-stu-id="b42c7-116">Unless the transitive bit is set, the component remains enabled once installed even if the conditional statement evaluates to False on a subsequent maintenance installation of the product.</span></span> <span data-ttu-id="b42c7-117">Les conditions doivent être basées uniquement sur les États de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="b42c7-117">The conditions must be based only on computer states.</span></span> <span data-ttu-id="b42c7-118">N’utilisez pas avec des conditions basées sur les États utilisateur ou les propriétés définies sur la ligne de commande, car cela peut obliger le programme d’installation à exiger une réinstallation du produit à chaque utilisation par un autre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b42c7-118">Do not use with conditions based on user states or properties set on the command line because this can cause the installer to require a reinstallation of the product on each use by a different user.</span></span>

     

4.  <span data-ttu-id="b42c7-119">Entrez des expressions conditionnelles complémentaires dans les champs condition de la table de contrôle, de sorte que lorsque la condition sur le premier composant transitif devient false, la condition sur le deuxième composant transitif passe à true.</span><span class="sxs-lookup"><span data-stu-id="b42c7-119">Enter complementary conditional expressions into the Condition fields of the Control table such that when the condition on the first transitive component changes to False the condition on the second transitive component changes to True.</span></span> <span data-ttu-id="b42c7-120">Cela entraîne la suppression du premier composant et l’installation du deuxième composant lors de la réinstallation de l’application.</span><span class="sxs-lookup"><span data-stu-id="b42c7-120">This results in the removal of the first component and installation of the second component upon reinstallation of the application.</span></span>

<span data-ttu-id="b42c7-121">Une réinstallation du produit est nécessaire pour basculer les composants transitifs.</span><span class="sxs-lookup"><span data-stu-id="b42c7-121">A reinstallation of the product is necessary to switch the transitive components.</span></span> <span data-ttu-id="b42c7-122">Les auteurs de package doivent donc fournir aux utilisateurs une méthode pour réinstaller le produit et pour définir les modes de la propriété [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="b42c7-122">Package authors therefore need to provide users with a method for reinstalling the product and for setting the modes of the [**REINSTALLMODE**](reinstallmode.md) property.</span></span> <span data-ttu-id="b42c7-123">Il existe trois façons de déclencher la réinstallation :</span><span class="sxs-lookup"><span data-stu-id="b42c7-123">There are basically three ways to trigger the reinstallation:</span></span>

-   <span data-ttu-id="b42c7-124">Exécutez et configurez la réinstallation par le biais de l’interface utilisateur en créant un package qui utilise l' [*interface utilisateur complète*](f-gly.md).</span><span class="sxs-lookup"><span data-stu-id="b42c7-124">Run and configure the reinstallation through the user interface by authoring a package that uses the [*full UI*](f-gly.md).</span></span>
-   <span data-ttu-id="b42c7-125">Exécutez la réinstallation à partir de la ligne de commande en utilisant **msiexec/f** et sélectionnez les modes dans la liste de l' [option de ligne de commande](command-line-options.md) **/f** .</span><span class="sxs-lookup"><span data-stu-id="b42c7-125">Run the reinstallation from the command line by using **msiexec /f** and select the modes from the list for the **/f** [command line option](command-line-options.md).</span></span>
-   <span data-ttu-id="b42c7-126">Demander à l’application d’appeler [**MsiReInstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) ou [**MsiReInstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="b42c7-126">Have the application call [**MsiReInstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) or [**MsiReInstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="b42c7-127">Le bit ne doit être utilisé qu’avec des conditions basées sur les États de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="b42c7-127">The bit should only be used with conditions based on computer states.</span></span> <span data-ttu-id="b42c7-128">N’utilisez pas avec des conditions basées sur les États utilisateur ou les propriétés définies sur la ligne de commande, car cela peut obliger le programme d’installation à exiger une réinstallation du produit à chaque utilisation par un autre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b42c7-128">Do not use with conditions based on user states or properties set on the command line because this can cause the installer to require a reinstallation of the product on each use by a different user.</span></span>

> [!Note]
> <span data-ttu-id="b42c7-129">À moins que le bit transitif de la colonne attributs ne soit défini pour un composant, le composant reste activé une fois installé, même si l’instruction conditionnelle dans la colonne condition prend la valeur false lors d’une installation de maintenance ultérieure du produit.</span><span class="sxs-lookup"><span data-stu-id="b42c7-129">Unless the Transitive bit in the Attributes column is set for a component, the component remains enabled once installed even if the conditional statement in the Condition column evaluates to False on a subsequent maintenance installation of the product.</span></span>
> 
> <span data-ttu-id="b42c7-130">Dans la plupart des cas, si une application comprend des composants transitifs, Windows Installer nécessite que la source de l’application répare ou met à niveau l’application.</span><span class="sxs-lookup"><span data-stu-id="b42c7-130">In most cases, if an application includes transitive components, Windows Installer requires the application's source to repair or upgrade the application.</span></span> <span data-ttu-id="b42c7-131">Dans ce cas, le CD-ROM de restauration du système fourni par un fabricant d’équipements d’origine ne fonctionne pas et une source d’installation réelle doit être fournie pour l’application.</span><span class="sxs-lookup"><span data-stu-id="b42c7-131">In these cases, the system restoration CD-ROM shipped by an original equipment manufacturer does not work and an actual installation source for the application needs to be provided.</span></span>

 

 

 



