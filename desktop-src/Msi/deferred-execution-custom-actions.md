---
description: L’objectif d’une action personnalisée d’exécution différée est de retarder l’exécution d’une modification du système au moment de l’exécution du script d’installation.
ms.assetid: 79bf4d0b-624d-4652-8c4f-0ecd928a88e3
title: Actions personnalisées d’exécution différée
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e09b91793f5d5bbc7be7099c92f8d8f212012d12
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103952311"
---
# <a name="deferred-execution-custom-actions"></a><span data-ttu-id="d4735-103">Actions personnalisées d’exécution différée</span><span class="sxs-lookup"><span data-stu-id="d4735-103">Deferred Execution Custom Actions</span></span>

<span data-ttu-id="d4735-104">L’objectif d’une action personnalisée d’exécution différée est de retarder l’exécution d’une modification du système au moment de l’exécution du script d’installation.</span><span class="sxs-lookup"><span data-stu-id="d4735-104">The purpose of a deferred execution custom action is to delay the execution of a system change to the time when the installation script is executed.</span></span> <span data-ttu-id="d4735-105">Cela diffère d’une action personnalisée normale, ou d’une action standard, dans laquelle le programme d’installation exécute l’action immédiatement lorsqu’il le rencontre dans une table de séquence ou dans un appel à [**MsiDoAction**](/windows/desktop/api/Msiquery/nf-msiquery-msidoactiona).</span><span class="sxs-lookup"><span data-stu-id="d4735-105">This differs from a regular custom action, or a standard action, in which the installer executes the action immediately upon encountering it in a sequence table or in a call to [**MsiDoAction**](/windows/desktop/api/Msiquery/nf-msiquery-msidoactiona).</span></span> <span data-ttu-id="d4735-106">Une action personnalisée d’exécution différée permet à l’auteur d’un package de spécifier des opérations système à un point particulier au sein de l’exécution du script d’installation.</span><span class="sxs-lookup"><span data-stu-id="d4735-106">A deferred execution custom action enables a package author to specify system operations at a particular point within the execution of the installation script.</span></span>

<span data-ttu-id="d4735-107">Le programme d’installation n’exécute pas d’action personnalisée d’exécution différée au moment du traitement de la séquence d’installation.</span><span class="sxs-lookup"><span data-stu-id="d4735-107">The installer does not execute a deferred execution custom action at the time the installation sequence is processed.</span></span> <span data-ttu-id="d4735-108">Au lieu de cela, le programme d’installation écrit l’action personnalisée dans le script d’installation.</span><span class="sxs-lookup"><span data-stu-id="d4735-108">Instead the installer writes the custom action into the installation script.</span></span> <span data-ttu-id="d4735-109">Le seul paramètre de mode défini par le programme d’installation dans ce cas est MSIRUNMODE \_ planifié.</span><span class="sxs-lookup"><span data-stu-id="d4735-109">The only mode parameter the installer sets in this case is MSIRUNMODE\_SCHEDULED.</span></span> <span data-ttu-id="d4735-110">Pour obtenir une description des paramètres du mode d’exécution, consultez [**MsiGetMode**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode) .</span><span class="sxs-lookup"><span data-stu-id="d4735-110">See [**MsiGetMode**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode) for a description of the run mode parameters.</span></span>

<span data-ttu-id="d4735-111">Une action personnalisée d’exécution différée doit être planifiée dans la table des séquences d’exécution de la section qui effectue la génération de scripts.</span><span class="sxs-lookup"><span data-stu-id="d4735-111">A deferred execution custom action must be scheduled in the execute sequence table within the section that performs script generation.</span></span> <span data-ttu-id="d4735-112">Les actions personnalisées d’exécution différée doivent être postérieures à [InstallInitialize](installinitialize-action.md) et précéder [InstallFinalize](installfinalize-action.md) dans la séquence d’action.</span><span class="sxs-lookup"><span data-stu-id="d4735-112">Deferred execution custom actions must come after [InstallInitialize](installinitialize-action.md) and come before [InstallFinalize](installfinalize-action.md) in the action sequence.</span></span>

<span data-ttu-id="d4735-113">Les actions personnalisées qui définissent les propriétés, les États des fonctionnalités, les États des composants ou les répertoires cibles, ou qui planifient les opérations système en insérant des lignes dans des tables de séquence, peuvent, dans de nombreux cas, utiliser l’exécution immédiate en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="d4735-113">Custom actions that set properties, feature states, component states, or target directories, or that schedule system operations by inserting rows into sequence tables, can in many cases use immediate execution safely.</span></span> <span data-ttu-id="d4735-114">Toutefois, les actions personnalisées qui modifient directement le système ou appellent un autre service système doivent être différées à l’heure d’exécution du script d’installation.</span><span class="sxs-lookup"><span data-stu-id="d4735-114">However, custom actions that change the system directly, or call another system service, must be deferred to the time when the installation script is executed.</span></span> <span data-ttu-id="d4735-115">Consultez [actions personnalisées synchrones et asynchrones](synchronous-and-asynchronous-custom-actions.md) pour plus d’informations sur les conflits potentiels entre leurs actions personnalisées et le thread d’installation principal.</span><span class="sxs-lookup"><span data-stu-id="d4735-115">See [Synchronous and Asynchronous Custom Actions](synchronous-and-asynchronous-custom-actions.md) for more information about potential clashes between their custom actions and the main installation thread.</span></span>

<span data-ttu-id="d4735-116">Étant donné que le script d’installation peut être exécuté en dehors de la session d’installation dans laquelle il a été écrit, la session n’existe peut-être plus pendant l’exécution du script d’installation.</span><span class="sxs-lookup"><span data-stu-id="d4735-116">Because the installation script can be executed outside of the installation session in which it was written, the session may no longer exist during execution of the installation script.</span></span> <span data-ttu-id="d4735-117">Cela signifie que le handle de session d’origine et le jeu de données de propriété pendant la séquence d’installation ne sont pas disponibles pour une action personnalisée d’exécution différée.</span><span class="sxs-lookup"><span data-stu-id="d4735-117">This means that the original session handle and property data set during the installation sequence is not available to a deferred execution custom action.</span></span> <span data-ttu-id="d4735-118">Les actions personnalisées différées qui appellent des bibliothèques de liens dynamiques (dll) passent un handle qui ne peut être utilisé que pour obtenir une quantité très limitée d’informations, comme décrit dans [obtention d’informations de contexte pour les actions personnalisées d’exécution différée](obtaining-context-information-for-deferred-execution-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="d4735-118">Deferred custom actions that call dynamic-link libraries (DLLs) pass a handle which can only be used to obtain a very limited amount of information, as described in [Obtaining Context Information for Deferred Execution Custom Actions](obtaining-context-information-for-deferred-execution-custom-actions.md).</span></span>

<span data-ttu-id="d4735-119">Notez que les actions personnalisées différées, y compris les actions personnalisées de [restauration](rollback-custom-actions.md) et de [validation des actions personnalisées](commit-custom-actions.md), sont les seuls types d’actions qui peuvent s’exécuter en dehors du contexte de sécurité des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="d4735-119">Note that deferred custom actions, including [rollback custom actions](rollback-custom-actions.md) and [commit custom actions](commit-custom-actions.md), are the only types of actions that can run outside the users security context.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d4735-120">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="d4735-120">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d4735-121">Options d’exécution d’une action personnalisée In-Script</span><span class="sxs-lookup"><span data-stu-id="d4735-121">Custom Action In-Script Execution Options</span></span>](custom-action-in-script-execution-options.md)
</dt> <dt>

[<span data-ttu-id="d4735-122">Référence des actions personnalisées</span><span class="sxs-lookup"><span data-stu-id="d4735-122">Custom Action Reference</span></span>](custom-action-reference.md)
</dt> </dl>

 

 



