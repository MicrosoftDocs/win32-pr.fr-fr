---
description: Instmsi.exe est le package redistribuable pour l’installation de Windows Installer&\# 160 ; 2.0 et des versions antérieures de Windows Installer. Consultez Windows Installer redistribuables pour les redistribuables pour Windows Installer&\# 160 ; 3.0 et versions ultérieures.
ms.assetid: 74ea4530-3a73-4169-b0b7-f0272229192d
title: Instmsi.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 229d748cda68731627a6af2af992e321755b5ca2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106530899"
---
# <a name="instmsiexe"></a><span data-ttu-id="0955f-104">Instmsi.exe</span><span class="sxs-lookup"><span data-stu-id="0955f-104">Instmsi.exe</span></span>

<span data-ttu-id="0955f-105">Instmsi.exe est le package redistribuable pour l’installation de Windows Installer 2,0 et des versions antérieures de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="0955f-105">Instmsi.exe is the redistributable package for installing Windows Installer 2.0, and earlier versions of Windows Installer.</span></span> <span data-ttu-id="0955f-106">Consultez [Windows Installer redistribuables](windows-installer-redistributables.md) pour les redistribuables pour Windows Installer 3,0 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="0955f-106">See [Windows Installer Redistributables](windows-installer-redistributables.md) for the redistributables for Windows Installer 3.0 and later versions.</span></span>

<span data-ttu-id="0955f-107">Pour plus d’informations sur la version de la Windows Installer qui a été fournie avec votre système d’exploitation, consultez [versions publiées de Windows Installer](released-versions-of-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="0955f-107">For more information about which version of the Windows Installer was shipped with your operating system, see [Released Versions of Windows Installer](released-versions-of-windows-installer.md).</span></span>

<span data-ttu-id="0955f-108">Certains redistribuables ne doivent pas être exécutés sur certaines versions du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="0955f-108">Some redistributables should not be run on certain versions of the operating system.</span></span> <span data-ttu-id="0955f-109">Le tableau suivant décrit le Instmsi est compatible avec le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="0955f-109">The following table describes which Instmsi is compatible on which operating system.</span></span>



| <span data-ttu-id="0955f-110">Si Instmsi.exe installe cette version du Windows Installer</span><span class="sxs-lookup"><span data-stu-id="0955f-110">If Instmsi.exe installs this version of the Windows Installer</span></span> | <span data-ttu-id="0955f-111">Instmsi.exe peuvent être exécutés sur ces systèmes d’exploitation</span><span class="sxs-lookup"><span data-stu-id="0955f-111">Instmsi.exe can be run on these operating systems</span></span>                    | <span data-ttu-id="0955f-112">Instmsi.exe ne doit pas être exécuté sur ces systèmes d’exploitation</span><span class="sxs-lookup"><span data-stu-id="0955f-112">Instmsi.exe must not be run on these operating systems</span></span>                                        |
|---------------------------------------------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| <span data-ttu-id="0955f-113">Windows Installer version 1,0</span><span class="sxs-lookup"><span data-stu-id="0955f-113">Windows Installer version 1.0</span></span>                                 | <span data-ttu-id="0955f-114">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="0955f-114">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="0955f-115">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="0955f-115">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="0955f-116">Windows Installer version 1,1</span><span class="sxs-lookup"><span data-stu-id="0955f-116">Windows Installer version 1.1</span></span>                                 | <span data-ttu-id="0955f-117">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="0955f-117">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="0955f-118">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="0955f-118">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="0955f-119">Windows Installer version 1,2</span><span class="sxs-lookup"><span data-stu-id="0955f-119">Windows Installer version 1.2</span></span>                                 | <span data-ttu-id="0955f-120">Windows 95, Windows 98, Windows Me, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="0955f-120">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP3</span></span>               | <span data-ttu-id="0955f-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="0955f-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>             |
| <span data-ttu-id="0955f-122">Windows Installer version 2,0</span><span class="sxs-lookup"><span data-stu-id="0955f-122">Windows Installer version 2.0</span></span>                                 | <span data-ttu-id="0955f-123">Windows 95, Windows 98, Windows Me, Windows NT 4.0 + SP6, Windows 2000</span><span class="sxs-lookup"><span data-stu-id="0955f-123">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP6, Windows 2000</span></span> | <span data-ttu-id="0955f-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="0955f-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>                           |



 

<span data-ttu-id="0955f-125">Par exemple, une application qui redistribue Windows Installer version 1,1 doit vérifier que le système d’exploitation est Windows NT 4,0 SP3 ou Windows 98/95 avant d’exécuter le package redistribuable.</span><span class="sxs-lookup"><span data-stu-id="0955f-125">For example, an application that redistributes Windows Installer version 1.1 should check that the operating system is Windows NT 4.0 SP3 or Windows 98/95 before running the redistributable package.</span></span> <span data-ttu-id="0955f-126">Les applications qui utilisent le package redistribuable doivent également s’assurer que la version ANSI du Windows Installer est installée sur Windows 98/95 et que la version Unicode est installée sur Windows NT ou Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="0955f-126">Applications using the redistributable package should also ensure that the ANSI version of the Windows Installer is installed on Windows 98/95, and that the Unicode version is installed on Windows NT or Windows 2000.</span></span> <span data-ttu-id="0955f-127">Notez que certaines applications renomment la version Unicode en InstMsiW.</span><span class="sxs-lookup"><span data-stu-id="0955f-127">Note that some applications rename the Unicode version to InstMsiW.</span></span>

## <a name="syntax"></a><span data-ttu-id="0955f-128">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="0955f-128">Syntax</span></span>

<span data-ttu-id="0955f-129"> *options* Instmsi</span><span class="sxs-lookup"><span data-stu-id="0955f-129">**instmsi** *options*</span></span>

## <a name="command-line-options"></a><span data-ttu-id="0955f-130">Options de la ligne de commande</span><span class="sxs-lookup"><span data-stu-id="0955f-130">Command Line Options</span></span>

<span data-ttu-id="0955f-131">Les options de ligne de commande ne respectent pas la casse.</span><span class="sxs-lookup"><span data-stu-id="0955f-131">The command line options are case-insensitive.</span></span>



| <span data-ttu-id="0955f-132">Option</span><span class="sxs-lookup"><span data-stu-id="0955f-132">Option</span></span>                     | <span data-ttu-id="0955f-133">Description</span><span class="sxs-lookup"><span data-stu-id="0955f-133">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0955f-134">/q</span><span class="sxs-lookup"><span data-stu-id="0955f-134">/q</span></span>                         | <span data-ttu-id="0955f-135">Pour une utilisation par les applications qui redistribuent les Windows Installer dans le cadre d’une application d’amorçage.</span><span class="sxs-lookup"><span data-stu-id="0955f-135">For use by applications that redistribute the Windows Installer as part of a bootstrapping application.</span></span> <span data-ttu-id="0955f-136">Aucune interface utilisateur n’est présentée à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0955f-136">No UI is presented to the user.</span></span> <span data-ttu-id="0955f-137">L’application d’amorçage doit vérifier le code de retour pour déterminer si un redémarrage est nécessaire pour terminer l’installation du Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="0955f-137">The bootstrapping application should check the return code to determine whether a reboot is needed to complete the installation of the Windows Installer.</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="0955f-138">/t</span><span class="sxs-lookup"><span data-stu-id="0955f-138">/t</span></span>                         | <span data-ttu-id="0955f-139">Utilisé à des fins de débogage uniquement.</span><span class="sxs-lookup"><span data-stu-id="0955f-139">Used for debugging purposes only.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="0955f-140">/c : "msiinst/delayreboot"</span><span class="sxs-lookup"><span data-stu-id="0955f-140">/c:"msiinst /delayreboot"</span></span>  | <span data-ttu-id="0955f-141">Option redémarrage différé.</span><span class="sxs-lookup"><span data-stu-id="0955f-141">The delayed reboot option.</span></span> <span data-ttu-id="0955f-142">Empêche Instmsi de demander à l’utilisateur un redémarrage même s’il devait remplacer des fichiers qui étaient en cours d’utilisation pendant l’installation.</span><span class="sxs-lookup"><span data-stu-id="0955f-142">Prevents Instmsi from prompting the user for a reboot even if it had to replace files that were in use during the installation.</span></span> <span data-ttu-id="0955f-143">Si Instmsi est appelé avec cette option, il retourne une erreur \_ de \_ redémarrage de la réussite \_ obligatoire s’il a dû remplacer des fichiers qui étaient en cours d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="0955f-143">If Instmsi is invoked with this option, it returns ERROR\_SUCCESS\_REBOOT\_REQUIRED if it had to replace files that were in use.</span></span> <span data-ttu-id="0955f-144">S’il n’a pas été nécessaire de remplacer les fichiers qui étaient en cours d’utilisation, il renvoie une erreur \_ .</span><span class="sxs-lookup"><span data-stu-id="0955f-144">If it did not have to replace files that were in use, it returns ERROR\_SUCCESS.</span></span> <span data-ttu-id="0955f-145">Disponible avec Instmsi pour Windows Installer 2,0 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="0955f-145">Available with Instmsi for Windows Installer  2.0 or later.</span></span> <span data-ttu-id="0955f-146">Pour plus d’informations sur les redémarrages différés, consultez la section Notes.</span><span class="sxs-lookup"><span data-stu-id="0955f-146">See the remarks section for additional information on delayed reboots.</span></span><br/> |
| <span data-ttu-id="0955f-147">/c : "msiinst/delayrebootq"</span><span class="sxs-lookup"><span data-stu-id="0955f-147">/c:"msiinst /delayrebootq"</span></span> | <span data-ttu-id="0955f-148">Version en mode silencieux de l’option redémarrage différé.</span><span class="sxs-lookup"><span data-stu-id="0955f-148">The quiet version of the delayed reboot option.</span></span> <span data-ttu-id="0955f-149">Elle ne présente pas d’interface utilisateur à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0955f-149">It does not present any UI to the user.</span></span> <span data-ttu-id="0955f-150">Dans le cas contraire, le comportement est identique à l’option précédente.</span><span class="sxs-lookup"><span data-stu-id="0955f-150">Otherwise the behavior is identical to the previous option.</span></span> <span data-ttu-id="0955f-151">Disponible avec Instmsi pour Windows Installer 2,0 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="0955f-151">Available with Instmsi for Windows Installer 2.0 or later.</span></span> <span data-ttu-id="0955f-152">Pour plus d’informations sur les redémarrages différés, consultez la section Notes.</span><span class="sxs-lookup"><span data-stu-id="0955f-152">See the remarks section for additional information on delayed reboots.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="0955f-153">/?</span><span class="sxs-lookup"><span data-stu-id="0955f-153">/?</span></span>                         | <span data-ttu-id="0955f-154">Affiche de l’aide.</span><span class="sxs-lookup"><span data-stu-id="0955f-154">Displays help.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

## <a name="remarks"></a><span data-ttu-id="0955f-155">Notes</span><span class="sxs-lookup"><span data-stu-id="0955f-155">Remarks</span></span>

<span data-ttu-id="0955f-156">Les applications d' [amorçage](bootstrapping.md) qui utilisent Instmsi.exe pour installer le Windows Installer avec une autre application peuvent nécessiter un redémarrage du système supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="0955f-156">[Bootstrapping](bootstrapping.md) applications that use Instmsi.exe to install the Windows Installer with another application may require an extra system reboot.</span></span> <span data-ttu-id="0955f-157">Il peut s’agit d’un redémarrage supplémentaire en plus des redémarrages nécessaires pour installer l’application.</span><span class="sxs-lookup"><span data-stu-id="0955f-157">This is potentially an extra reboot in addition to any reboots that are needed to install the application.</span></span>

<span data-ttu-id="0955f-158">L’option redémarrage différé est recommandée pour les développeurs de programme d’installation qui souhaitent éliminer un redémarrage supplémentaire provoqué par l’utilisation de Instmsi.exe avec une application d’installation qui installe les fichiers en cours d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="0955f-158">The delayed reboot option is only recommended for setup developers who want to eliminate an extra reboot caused by using Instmsi.exe with a setup application that installs files that are in use.</span></span>

<span data-ttu-id="0955f-159">Les développeurs doivent effectuer les opérations suivantes dans leur application d’installation pour utiliser l’option redémarrage différé.</span><span class="sxs-lookup"><span data-stu-id="0955f-159">Developers should do the following in their setup application to use the delayed reboot option.</span></span> <span data-ttu-id="0955f-160">Cette option n’est pas disponible avec les versions Instmsi.exe qui installent les versions de Windows Installer antérieures à la version 2,0 :</span><span class="sxs-lookup"><span data-stu-id="0955f-160">This option is not available with Instmsi.exe versions that install Window Installer versions earlier than version 2.0:</span></span>

<span data-ttu-id="0955f-161">**Pour utiliser l’option redémarrage différé**</span><span class="sxs-lookup"><span data-stu-id="0955f-161">**To use the delayed reboot option**</span></span>

1.  <span data-ttu-id="0955f-162">Appelez Instmsi.exe avec l’une des options de ligne de commande reboot retardée.</span><span class="sxs-lookup"><span data-stu-id="0955f-162">Call Instmsi.exe with one of the delayed reboot command line options.</span></span>
2.  <span data-ttu-id="0955f-163">Traitez le retour du succès de l’erreur ou de la réussite de l' \_ erreur \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="0955f-163">Treat the return of either ERROR\_SUCCESS or ERROR\_SUCCESS\_REBOOT\_REQUIRED as meaning success.</span></span>
3.  <span data-ttu-id="0955f-164">Récupérez le chemin d’accès au dossier contenant les binaires de Windows Installer récemment installés à partir de la valeur InstallerLocation sous :</span><span class="sxs-lookup"><span data-stu-id="0955f-164">Get the path to the folder containing the newly installed Windows Installer binaries from the InstallerLocation value under:</span></span>

    <span data-ttu-id="0955f-165">**HKEY \_ Logiciel de l' \_ ordinateur local** \\  \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **installer**</span><span class="sxs-lookup"><span data-stu-id="0955f-165">**HKEY\_LOCAL\_MACHINE**\\**Software**\\**Microsoft**\\**Windows**\\**CurrentVersion**\\**Installer**</span></span>

    <span data-ttu-id="0955f-166">Cette valeur est de type **reg \_ SZ**.</span><span class="sxs-lookup"><span data-stu-id="0955f-166">This value is of type **REG\_SZ**.</span></span>

4.  <span data-ttu-id="0955f-167">Définissez le répertoire actif sur le chemin d’accès obtenu à l’étape 3.</span><span class="sxs-lookup"><span data-stu-id="0955f-167">Set the current directory to the path obtained in step 3.</span></span>
5.  <span data-ttu-id="0955f-168">Appelez msiexec sur le package de l’application et exécutez un autre code d’installation spécifique à l’application.</span><span class="sxs-lookup"><span data-stu-id="0955f-168">Invoke Msiexec on the application's package and run other setup code specific to the application.</span></span> <span data-ttu-id="0955f-169">Si l’application d’installation utilise [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), l’application doit charger MSI.DLL à partir de l’emplacement obtenu à l’étape 3.</span><span class="sxs-lookup"><span data-stu-id="0955f-169">If the setup application uses [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), then the application must load MSI.DLL from the location obtained in step 3.</span></span>
    > [!Note]  
    > <span data-ttu-id="0955f-170">Les applications qui appellent **LoadLibrary** sur le nouvel MSI.DLL à l’emplacement obtenu à l’étape 3 doivent s’assurer qu’une version antérieure de MSI.DLL n’a pas déjà été chargée dans le processus.</span><span class="sxs-lookup"><span data-stu-id="0955f-170">Applications that call **LoadLibrary** on the new MSI.DLL in the location obtained in step 3 must ensure that an older version of MSI.DLL has not already been loaded within the process.</span></span> <span data-ttu-id="0955f-171">Si une version antérieure de MSI.DLL a été chargée dans le processus, elle doit être déchargée de l’espace d’adressage du processus avant l’appel de **LoadLibrary** pour la nouvelle MSI.DLL.</span><span class="sxs-lookup"><span data-stu-id="0955f-171">If an older version of MSI.DLL was loaded within the process, it must be unloaded from the process address space prior to the **LoadLibrary** call for the new MSI.DLL.</span></span>

     

6.  <span data-ttu-id="0955f-172">Si l’étape (5) ne nécessite pas de redémarrage et si Instmsi.exe a retourné une erreur de redémarrage de la \_ réussite \_ \_ requise à l’étape (1), invitez l’utilisateur à redémarrer pour terminer l’installation des fichiers binaires Windows Installer sur le système.</span><span class="sxs-lookup"><span data-stu-id="0955f-172">If step (5) does not require a reboot and if Instmsi.exe had returned ERROR\_SUCCESS\_REBOOT\_REQUIRED in step (1), prompt the user for a reboot to complete the setup of the Windows Installer binaries on the system.</span></span> <span data-ttu-id="0955f-173">Toutefois, si un redémarrage se produit à l’étape (5), aucune étape supplémentaire n’est requise.</span><span class="sxs-lookup"><span data-stu-id="0955f-173">However, if a reboot occurs in step (5), no additional steps are required.</span></span>

<span data-ttu-id="0955f-174">Instmsi.exe est disponible dans les [composants SDK Windows pour les développeurs Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="0955f-174">Instmsi.exe is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="0955f-175">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="0955f-175">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0955f-176">Amorçage</span><span class="sxs-lookup"><span data-stu-id="0955f-176">Bootstrapping</span></span>](bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="0955f-177">Amorçage du téléchargement Internet</span><span class="sxs-lookup"><span data-stu-id="0955f-177">Internet Download Bootstrapping</span></span>](internet-download-bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="0955f-178">Versions, outils et redistribuables publiés</span><span class="sxs-lookup"><span data-stu-id="0955f-178">Released Versions, Tools, and Redistributables</span></span>](released-versions-tools-and-redistributables.md)
</dt> <dt>

[<span data-ttu-id="0955f-179">Outils de développement Windows Installer</span><span class="sxs-lookup"><span data-stu-id="0955f-179">Windows Installer Development Tools</span></span>](windows-installer-development-tools.md)
</dt> </dl>

 

 




