---
description: La procédure de cette rubrique indique comment créer un package Windows Installer pour installer un assembly Win32.
ms.assetid: 2d4bc2be-cce6-45e6-b6a7-7ff96d28eb96
title: Installation d’assemblys Win32 pour l’utilisation privée d’une application sur Windows XP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e807e22c9c5dea67ece5ead0ded95f06ab203689
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106514851"
---
# <a name="installing-win32-assemblies-for-the-private-use-of-an-application-on-windows-xp"></a><span data-ttu-id="e4acb-103">Installation d’assemblys Win32 pour l’utilisation privée d’une application sur Windows XP</span><span class="sxs-lookup"><span data-stu-id="e4acb-103">Installing Win32 Assemblies for the Private Use of an Application on Windows XP</span></span>

<span data-ttu-id="e4acb-104">La procédure de cette rubrique indique comment créer un package Windows Installer pour installer un assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="e4acb-104">The procedure in this topic identifies how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="e4acb-105">Le package installe l’assembly et un fichier manifeste d’application dans un dossier créé que l’application utilise.</span><span class="sxs-lookup"><span data-stu-id="e4acb-105">The package installs the assembly and an application manifest file into an authored folder that the application uses.</span></span> <span data-ttu-id="e4acb-106">Le manifeste d’application spécifie la dépendance de l’application sur l’assembly privé.</span><span class="sxs-lookup"><span data-stu-id="e4acb-106">The application manifest specifies the dependence of the application on the private assembly.</span></span> <span data-ttu-id="e4acb-107">Une fois le package installé, l’assembly privé est disponible pour l’utilisation exclusive de l’application.</span><span class="sxs-lookup"><span data-stu-id="e4acb-107">After installing the package, the private assembly is available for the exclusive use of the application.</span></span> <span data-ttu-id="e4acb-108">La dépendance d’assembly spécifiée dans le manifeste de l’application remplace (pour cette application) toutes les autres dépendances d’assembly globales spécifiées dans les fichiers manifeste de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="e4acb-108">The assembly dependence that is specified in the application manifest overrides (for this application) any other global assembly dependencies that are specified in assembly manifest files.</span></span>

<span data-ttu-id="e4acb-109">Avant de continuer, il est judicieux de comprendre comment créer un package Windows Installer sans assemblys.</span><span class="sxs-lookup"><span data-stu-id="e4acb-109">Before you continue, it is a good idea to understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="e4acb-110">Pour plus d’informations, consultez [un exemple d’installation](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-110">For more information, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="e4acb-111">**Pour installer un assembly privé sur Windows XP**</span><span class="sxs-lookup"><span data-stu-id="e4acb-111">**To install a private assembly on Windows XP**</span></span>

1.  <span data-ttu-id="e4acb-112">Définissez un composant Windows Installer qui comprend l’assembly Win32 et le fichier manifeste de l’application.</span><span class="sxs-lookup"><span data-stu-id="e4acb-112">Define a Windows Installer component that includes the Win32 assembly and the application manifest file.</span></span> <span data-ttu-id="e4acb-113">Ce composant peut contenir d’autres ressources qui doivent toujours être installées ou supprimées avec l’assembly.</span><span class="sxs-lookup"><span data-stu-id="e4acb-113">This component can contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="e4acb-114">Les étapes restantes de cette procédure décrivent comment créer la base de données d’installation pour installer ce composant.</span><span class="sxs-lookup"><span data-stu-id="e4acb-114">The remaining steps of this procedure describe how to author the installation database to install this component.</span></span>
2.  <span data-ttu-id="e4acb-115">Ajoutez une ligne à la [table des composants](component-table.md) pour le composant qui contient l’assembly Win32 et le fichier manifeste de l’application.</span><span class="sxs-lookup"><span data-stu-id="e4acb-115">Add a row to the [Component table](component-table.md) for the component that contains the Win32 assembly and application manifest file.</span></span> <span data-ttu-id="e4acb-116">Entrez un [GUID](guid.md) de Windows Installer valide pour ce code de composant.</span><span class="sxs-lookup"><span data-stu-id="e4acb-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="e4acb-117">Pour plus d’informations, consultez [modification du code du composant](changing-the-component-code.md) et [que se passe-t-il si les règles des composants sont rompues ?](what-happens-if-the-component-rules-are-broken.md)</span><span class="sxs-lookup"><span data-stu-id="e4acb-117">For more information, see [Changing the Component Code](changing-the-component-code.md) and [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md)</span></span>
3.  <span data-ttu-id="e4acb-118">Le programme d’installation copie le fichier manifeste de l’assembly dans le dossier qui contient le fichier spécifié dans le \_ champ application de fichier de la [table MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-118">The installer copies the assembly manifest file into the folder that contains the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span>
4.  <span data-ttu-id="e4acb-119">Ajoutez une ligne à la [table FeatureComponents](featurecomponents-table.md) en liant le composant à une fonctionnalité de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="e4acb-119">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="e4acb-120">Pour plus d’informations, consultez [composants et fonctionnalités](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-120">For more information, see [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="e4acb-121">Une fonctionnalité de Windows Installer doit être une partie des fonctionnalités d’application qu’un utilisateur peut reconnaître.</span><span class="sxs-lookup"><span data-stu-id="e4acb-121">A Windows Installer feature should be a piece of the application functionality that a user can recognize.</span></span> <span data-ttu-id="e4acb-122">L’assembly est activé lorsque cette fonctionnalité est sélectionnée par un utilisateur ou a généré une erreur par une application.</span><span class="sxs-lookup"><span data-stu-id="e4acb-122">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="e4acb-123">Si l’assembly définit une fonctionnalité supplémentaire, ajoutez une ligne supplémentaire à la [table des fonctionnalités](feature-table.md) pour les attributs de fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="e4acb-123">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature attributes.</span></span> <span data-ttu-id="e4acb-124">Cette étape n’est pas requise en cas de création d’un module de fusion.</span><span class="sxs-lookup"><span data-stu-id="e4acb-124">This step is not required if authoring a merge module.</span></span>
5.  <span data-ttu-id="e4acb-125">Pour les assemblys côte à côte, les informations de liaison et d’activation, par exemple, les classes COM, les interfaces et les bibliothèques de types, sont stockées dans des fichiers manifeste plutôt que dans le registre.</span><span class="sxs-lookup"><span data-stu-id="e4acb-125">For side-by-side assemblies, binding and activation information, for example, COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="e4acb-126">Les assemblys privés stockent ces informations dans un manifeste d’assembly.</span><span class="sxs-lookup"><span data-stu-id="e4acb-126">Private assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="e4acb-127">Sur les systèmes qui prennent en charge les assemblys côte à côte, le programme d’installation ignore le traitement des informations relatives au composant qui est entré dans la [table d’extension](extension-table.md), la [table de verbes](verb-table.md), la [table Typelib](typelib-table.md), la [table MIME](mime-table.md), la table de [classes](class-table.md), la [table ProgID](progid-table.md)et la [table AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-127">On systems that support side-by-side assemblies, the installer skips processing any information about the component that is entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="e4acb-128">Les informations de liaison et d’activation peuvent être entrées dans les tables pour être utilisées par les systèmes qui ne prennent pas en charge le partage d’assembly côte à côte.</span><span class="sxs-lookup"><span data-stu-id="e4acb-128">Binding and activation information can be entered into the tables for use by systems that do not support side-by-side assembly sharing.</span></span>
6.  <span data-ttu-id="e4acb-129">L’installation côte à côte n’inscrit pas l’assembly globalement.</span><span class="sxs-lookup"><span data-stu-id="e4acb-129">Side-by-side installation does not register the assembly globally.</span></span> <span data-ttu-id="e4acb-130">Le programme d’installation ignore l’inscription automatique du composant si des informations d’auto-inscription sont entrées dans la [table Selfreg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-130">The installer skips self-registering the component if any self-registration information is entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="e4acb-131">Les informations d’auto-inscription peuvent être entrées dans la table SelfReg pour l’inscription automatique du composant sur les systèmes qui ne prennent pas en charge le partage d’assembly côte à côte.</span><span class="sxs-lookup"><span data-stu-id="e4acb-131">Self-registration information can be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
7.  <span data-ttu-id="e4acb-132">Ajoutez toutes les autres informations du Registre, en excluant la liaison et l’activation ou l’inscription automatique du composant, à la table [du Registre](registry-table.md), à la [table RemoveRegistry](removeregistry-table.md)et à la [table d’environnement](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-132">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
8.  <span data-ttu-id="e4acb-133">Le programme d’installation ignore la [table IsolatedComponent](isolatedcomponent-table.md) pour ce composant sur les systèmes d’exploitation qui prennent en charge le partage côte à côte.</span><span class="sxs-lookup"><span data-stu-id="e4acb-133">The installer skips the [IsolatedComponent table](isolatedcomponent-table.md) for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="e4acb-134">Entrez les informations dans cette table si vous souhaitez que l’assembly soit privé sur les systèmes qui prennent en charge des fichiers locaux.</span><span class="sxs-lookup"><span data-stu-id="e4acb-134">Enter information into this table if you want the assembly to be private on systems that support local files.</span></span>
9.  <span data-ttu-id="e4acb-135">Ajoutez une ligne à la [table MsiAssembly](msiassembly-table.md) pour le composant qui contient l’assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="e4acb-135">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="e4acb-136">Entrez la valeur 1 dans le champ attributs de la table MsiAssembly pour spécifier qu’il s’agit d’un assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="e4acb-136">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="e4acb-137">Entrez la clé de fichier de l’assembly privé dans le \_ champ application de fichier de la [table MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-137">Enter the file key of the private assembly in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="e4acb-138">Ajoutez l' [action MsiPublishAssemblies](msipublishassemblies-action.md) à la table [InstallExecuteSequence](installexecutesequence-table.md) ou à la [table AdvtExecuteSequence](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-138">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="e4acb-139">Ajoutez l' [action MsiUnpublishAssemblies](msiunpublishassemblies-action.md) à la table InstallExecuteSequence.</span><span class="sxs-lookup"><span data-stu-id="e4acb-139">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span> <span data-ttu-id="e4acb-140">Créez un dossier pour l’assembly et le fichier manifeste dans la [table de répertoires](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-140">Author a folder for the assembly and manifest file into the [Directory table](directory-table.md).</span></span> <span data-ttu-id="e4acb-141">Ce dossier doit se trouver dans le répertoire racine de l’application et contenir le fichier spécifié dans le \_ champ application de fichier de la [table MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-141">This folder should be in the application's root directory and contain the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="e4acb-142">Pendant l’installation de l’application, le programme d’installation résout la [table de répertoire](directory-table.md) pour le chemin d’accès à ce dossier.</span><span class="sxs-lookup"><span data-stu-id="e4acb-142">During the installation of the application, the installer resolves the [Directory table](directory-table.md) for the path to this folder.</span></span> <span data-ttu-id="e4acb-143">Pour plus d’informations, consultez [utilisation de la table des répertoires](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-143">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>
10. <span data-ttu-id="e4acb-144">Ajoutez des lignes à la [table MsiAssemblyName](msiassemblyname-table.md) pour le composant.</span><span class="sxs-lookup"><span data-stu-id="e4acb-144">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="e4acb-145">Ajoutez une ligne pour chaque paire nom/valeur spécifiée dans la section assemblyIdentity du manifeste.</span><span class="sxs-lookup"><span data-stu-id="e4acb-145">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="e4acb-146">Pour plus d’informations, consultez la [table MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="e4acb-146">For more information, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



