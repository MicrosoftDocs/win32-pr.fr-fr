---
description: Le WiMerge.vbs de fichiers VBScript est fourni dans les composants SDK Windows pour les développeurs Windows Installer. Cet exemple de script fusionne une base de données Windows Installer dans une autre base de données. Pour plus d’informations, consultez fusions et transformations.
ms.assetid: 31867082-7c1d-4530-a066-236d8ee5f023
title: Fusionner deux bases de données
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0254cbe2bd0785b45d4ced3a16770023e617bc63
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106526958"
---
# <a name="merge-two-databases"></a><span data-ttu-id="e9b3c-105">Fusionner deux bases de données</span><span class="sxs-lookup"><span data-stu-id="e9b3c-105">Merge Two Databases</span></span>

<span data-ttu-id="e9b3c-106">Le WiMerge.vbs de fichiers VBScript est fourni dans les [composants SDK Windows pour les développeurs Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="e9b3c-106">The VBScript file WiMerge.vbs is provided in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="e9b3c-107">Cet exemple de script fusionne une base de données Windows Installer dans une autre base de données.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-107">This sample script merges one Windows Installer database into another database.</span></span> <span data-ttu-id="e9b3c-108">Pour plus d’informations, consultez [fusions et transformations](merges-and-transforms.md).</span><span class="sxs-lookup"><span data-stu-id="e9b3c-108">For more information, see [Merges and Transforms](merges-and-transforms.md).</span></span>

<span data-ttu-id="e9b3c-109">La fonction [**MsiDatabaseMerge**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea) et la méthode [**Merge**](database-merge.md) de l’objet [**Database**](database-object.md) ne peuvent pas être utilisées pour fusionner un module inclus dans le package d’installation.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-109">The [**MsiDatabaseMerge**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea) function and the [**Merge**](database-merge.md) method of the [**Database**](database-object.md) object cannot be used to merge a module included in the installation package.</span></span> <span data-ttu-id="e9b3c-110">Ils ne doivent pas être utilisés pour fusionner des [modules de fusion](merge-modules.md) dans un package de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-110">They should not be used to merge [Merge Modules](merge-modules.md) into a Windows Installer package.</span></span> <span data-ttu-id="e9b3c-111">Pour inclure un module de fusion dans un package d’installation, les auteurs des packages d’installation doivent suivre les instructions décrites dans la rubrique [application de modules de fusion](applying-merge-modules.md) .</span><span class="sxs-lookup"><span data-stu-id="e9b3c-111">To include a merge module in an installation package, authors of installation packages should follow the guidelines that are described in [Applying Merge Modules](applying-merge-modules.md) topic.</span></span>

<span data-ttu-id="e9b3c-112">L’exemple illustre l’utilisation des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="e9b3c-112">The sample demonstrates the use of the following:</span></span>

-   [<span data-ttu-id="e9b3c-113">**OpenDatabase, méthode (objet installer)**</span><span class="sxs-lookup"><span data-stu-id="e9b3c-113">**OpenDatabase method (Installer Object)**</span></span>](installer-opendatabase.md)
-   <span data-ttu-id="e9b3c-114">[**Méthode LastErrorRecord**](installer-lasterrorrecord.md) de l' [ **objet installer**](installer-object.md)</span><span class="sxs-lookup"><span data-stu-id="e9b3c-114">[**LastErrorRecord method**](installer-lasterrorrecord.md) of the [**Installer object**](installer-object.md)</span></span>
-   [<span data-ttu-id="e9b3c-115">**OpenView, méthode**</span><span class="sxs-lookup"><span data-stu-id="e9b3c-115">**OpenView method**</span></span>](database-openview.md)
-   [<span data-ttu-id="e9b3c-116">**Merge (méthode)**</span><span class="sxs-lookup"><span data-stu-id="e9b3c-116">**Merge method**</span></span>](database-merge.md)
-   <span data-ttu-id="e9b3c-117">[**Méthode Commit**](database-commit.md) de l' [ **objet Database**](database-object.md)</span><span class="sxs-lookup"><span data-stu-id="e9b3c-117">[**Commit method**](database-commit.md) of the [**Database object**](database-object.md)</span></span>
-   [<span data-ttu-id="e9b3c-118">**Méthode fetch**</span><span class="sxs-lookup"><span data-stu-id="e9b3c-118">**Fetch method**</span></span>](view-fetch.md)
-   [<span data-ttu-id="e9b3c-119">**Afficher l’objet**</span><span class="sxs-lookup"><span data-stu-id="e9b3c-119">**View object**</span></span>](view-object.md)
-   <span data-ttu-id="e9b3c-120">[**Propriété StringData**](record-stringdata.md) de l' [ **objet record**](record-object.md)</span><span class="sxs-lookup"><span data-stu-id="e9b3c-120">[**StringData property**](record-stringdata.md) of the [**Record object**](record-object.md)</span></span>

<span data-ttu-id="e9b3c-121">Vous devez disposer de la version CScript.exe ou WScript.exe de Windows Script Host pour utiliser cet exemple.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-121">You must have the CScript.exe or WScript.exe version of Windows Script Host to use this sample.</span></span> <span data-ttu-id="e9b3c-122">Pour utiliser CScript.exe pour exécuter cet exemple, tapez une ligne de commande à l’invite de commandes en utilisant la syntaxe suivante.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-122">To use CScript.exe to run this sample, type a command line at the command prompt using the following syntax.</span></span> <span data-ttu-id="e9b3c-123">L’aide s’affiche si le premier argument est/ ?</span><span class="sxs-lookup"><span data-stu-id="e9b3c-123">Help is displayed if the first argument is /?</span></span> <span data-ttu-id="e9b3c-124">ou si le nombre d’arguments spécifié est insuffisant.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-124">or if too few arguments are specified.</span></span> <span data-ttu-id="e9b3c-125">Pour rediriger la sortie vers un fichier, terminez la ligne de commande avec VBS > \[ chemin d’accès au fichier \] .</span><span class="sxs-lookup"><span data-stu-id="e9b3c-125">To redirect the output to a file, end the command line with VBS > \[path to file\].</span></span> <span data-ttu-id="e9b3c-126">L’exemple retourne la valeur 0 pour Success, 1 si l’aide est appelée, et 2 si le script échoue.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-126">The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</span></span>

<span data-ttu-id="e9b3c-127">**cscript WiMerge.vbs \[ chemin d’accès au chemin d’accès de la base de données \] \[ importé \] \[\]**</span><span class="sxs-lookup"><span data-stu-id="e9b3c-127">**cscript WiMerge.vbs \[path to database\]\[path to imported database\]\[table name\]**</span></span>

<span data-ttu-id="e9b3c-128">Spécifiez le chemin d’accès à la base de données Windows Installer qui reçoit la fusion.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-128">Specify the path to the Windows Installer database that is receiving the merge.</span></span> <span data-ttu-id="e9b3c-129">Spécifiez le chemin d’accès à la base de données importée dans la première.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-129">Specify the path to the database being imported into the first.</span></span> <span data-ttu-id="e9b3c-130">Vous pouvez spécifier un nom facultatif pour une table qui contiendra les erreurs de fusion.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-130">You may specify an optional name for a table to hold the merge errors.</span></span> <span data-ttu-id="e9b3c-131">Si aucun nom de table n’est spécifié, le programme d’installation utilise le nom \_ MergeErrors et supprime la table après avoir affiché le contenu.</span><span class="sxs-lookup"><span data-stu-id="e9b3c-131">If no table name is specified, the installer uses the name \_MergeErrors and drops the table after displaying the contents.</span></span>

<span data-ttu-id="e9b3c-132">Pour obtenir des exemples supplémentaires de scripts, consultez [Windows Installer des exemples de scripts](windows-installer-scripting-examples.md).</span><span class="sxs-lookup"><span data-stu-id="e9b3c-132">For additional scripting examples, see [Windows Installer Scripting Examples](windows-installer-scripting-examples.md).</span></span> <span data-ttu-id="e9b3c-133">Pour obtenir des exemples d’utilitaires qui ne nécessitent pas Windows Script Host, consultez [Windows Installer les outils de développement](windows-installer-development-tools.md).</span><span class="sxs-lookup"><span data-stu-id="e9b3c-133">For sample utilities that do not require Windows Script Host, see [Windows Installer Development Tools](windows-installer-development-tools.md).</span></span>

 

 



