---
description: Vous pouvez ajouter des informations de localisation à une base de données d’installation en important et en exportant des fichiers d’archive de texte ASCII à l’aide de MsiDatabaseExport et MsiDatabaseImport.
ms.assetid: dc52313b-38e7-43cc-abfd-86966c836fce
title: Gestion des pages de codes des tables importées et exportées
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3b090bead1fa35b451ed12e0e0da0143b98b8918
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106534365"
---
# <a name="code-page-handling-of-imported-and-exported-tables"></a><span data-ttu-id="f885f-103">Gestion des pages de codes des tables importées et exportées</span><span class="sxs-lookup"><span data-stu-id="f885f-103">Code Page Handling of Imported and Exported Tables</span></span>

<span data-ttu-id="f885f-104">Vous pouvez ajouter des informations de localisation à une base de données d’installation en important et en exportant des fichiers d’archive de texte ASCII à l’aide de [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) et [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="f885f-104">You can add localization information to an installation database by importing and exporting ASCII text archive files using [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) and [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="f885f-105">Étant donné que le pool de chaînes de base de données utilise une page de codes ANSI, la base de données et les [fichiers d’archive de texte](text-archive-files.md) exportés ont des pages de codes.</span><span class="sxs-lookup"><span data-stu-id="f885f-105">Because the database string pool uses an ANSI code page, both the database and exported [Text Archive Files](text-archive-files.md) have code pages.</span></span>

<span data-ttu-id="f885f-106">Lorsqu’un [fichier d’archive de texte](text-archive-files.md) est exporté à partir d’une base de données, la page de codes du fichier d’archive est la même que la base de données parente.</span><span class="sxs-lookup"><span data-stu-id="f885f-106">When a [Text Archive File](text-archive-files.md) is exported from a database, the code page of the archive file is the same as the parent database.</span></span> <span data-ttu-id="f885f-107">Pour obtenir la liste des pages de codes numériques, consultez [localisation des tables Error et ActionText](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="f885f-107">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

> [!Note]  
> <span data-ttu-id="f885f-108">L’exportation d’une table dans un fichier d’archive de texte traduit les caractères de contrôle pour éviter les conflits avec les délimiteurs de fichiers.</span><span class="sxs-lookup"><span data-stu-id="f885f-108">Exporting a table to a text archive file translates the control characters to avoid conflicts with file delimiters.</span></span>

 

## <a name="ascii-text-archive-files"></a><span data-ttu-id="f885f-109">Fichiers d’archive de texte ASCII</span><span class="sxs-lookup"><span data-stu-id="f885f-109">ASCII Text Archive Files</span></span>

<span data-ttu-id="f885f-110">Les [fichiers d’archive de texte](text-archive-files.md) ASCII exportés par [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) sont expliqués dans le format suivant :</span><span class="sxs-lookup"><span data-stu-id="f885f-110">The ASCII [Text Archive Files](text-archive-files.md) exported by [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) are explained in the following format:</span></span>

-   <span data-ttu-id="f885f-111">Les noms des colonnes de la table sont écrits sur la première ligne.</span><span class="sxs-lookup"><span data-stu-id="f885f-111">The names of the table columns are written on the first line.</span></span>
-   <span data-ttu-id="f885f-112">Les formats de colonne sont écrits sur la deuxième ligne.</span><span class="sxs-lookup"><span data-stu-id="f885f-112">The column formats are written on the second line.</span></span>
-   <span data-ttu-id="f885f-113">Si la table contient uniquement des données ASCII, la troisième ligne du fichier texte est le nom de la table suivi d’une liste de clés primaires.</span><span class="sxs-lookup"><span data-stu-id="f885f-113">If the table contains only ASCII data, the third line of the text file is the table name followed by a list of the primary keys.</span></span>
-   <span data-ttu-id="f885f-114">Si la table contient des données non-ASCII et que la base de données est marquée avec une page de codes numérique, le numéro de la page de codes apparaît au début de la troisième ligne.</span><span class="sxs-lookup"><span data-stu-id="f885f-114">If the table contains non-ASCII data and the database is stamped with a numeric code page, the code page number appears at the beginning of the third line.</span></span>
-   <span data-ttu-id="f885f-115">Si la base de données contient des données non-ASCII, mais que la base de données n’est pas marquée avec la page de codes numérique, le numéro de page de codes système actuel est écrit au début de la troisième ligne.</span><span class="sxs-lookup"><span data-stu-id="f885f-115">If the database contains non-ASCII data, but the database is not stamped with the numeric code page, the current system code page number is written at the beginning of the third line.</span></span>
-   <span data-ttu-id="f885f-116">Les lignes restantes du fichier texte sont les données de la page de codes spécifiée.</span><span class="sxs-lookup"><span data-stu-id="f885f-116">The remaining lines of the text file are the data in the specified code page.</span></span>
-   <span data-ttu-id="f885f-117">Si une table contient des flux, [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) exporte chaque flux de la table dans un fichier séparé.</span><span class="sxs-lookup"><span data-stu-id="f885f-117">If a table contains streams, [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) exports each stream in the table to a separate file.</span></span>

### <a name="neutral-and-non-neutral-code-pages"></a><span data-ttu-id="f885f-118">Pages de codes neutres et non neutres</span><span class="sxs-lookup"><span data-stu-id="f885f-118">Neutral and Non-Neutral Code Pages</span></span>

<span data-ttu-id="f885f-119">Vous pouvez faciliter la localisation en commençant par une base de données qui contient une page de codes neutre :</span><span class="sxs-lookup"><span data-stu-id="f885f-119">You can facilitate localization by starting with a database that has a neutral code page:</span></span>

-   <span data-ttu-id="f885f-120">Une base de données vide contient une page de codes neutre.</span><span class="sxs-lookup"><span data-stu-id="f885f-120">A blank database has a neutral code page.</span></span>
-   <span data-ttu-id="f885f-121">Une base de données qui ne contient pas de caractères étendus qui nécessitent une page de codes à représenter en ASCII a une page de codes neutre.</span><span class="sxs-lookup"><span data-stu-id="f885f-121">A database that does not contain extended characters that require a code page to be represented in ASCII has a neutral code page.</span></span>

<span data-ttu-id="f885f-122">Pour plus d’informations, consultez [création d’une base de données à l’aide d’une page de codes neutre](creating-a-database-with-a-neutral-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="f885f-122">For more information, see [Creating a Database with a Neutral Code Page](creating-a-database-with-a-neutral-code-page.md).</span></span>

<span data-ttu-id="f885f-123">Les pages de codes neutres et non neutres présentent les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="f885f-123">Neutral and non-neutral code pages have the following characteristics:</span></span>

-   <span data-ttu-id="f885f-124">Si un [fichier d’archive de texte](text-archive-files.md) avec une page de codes non neutre est importé dans une base de données dont la page de codes n’est pas neutre, le programme d’installation renvoie une erreur lors de l’appel de [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) .</span><span class="sxs-lookup"><span data-stu-id="f885f-124">If a [Text Archive File](text-archive-files.md) with a non-neutral code page is imported into a database that has a different non-neutral code page, the Installer returns an error when [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) is called.</span></span>
-   <span data-ttu-id="f885f-125">Un [fichier d’archive de texte](text-archive-files.md) contenant une page de codes neutre peut être importé dans une base de données qui contient une page de codes.</span><span class="sxs-lookup"><span data-stu-id="f885f-125">A [Text Archive File](text-archive-files.md) that has a neutral code page can be imported into a database that has any code page.</span></span>
-   <span data-ttu-id="f885f-126">Un [fichier d’archive de texte](text-archive-files.md) contenant une page de codes peut être importé dans une base de données qui contient une page de codes neutre.</span><span class="sxs-lookup"><span data-stu-id="f885f-126">A [Text Archive File](text-archive-files.md) that has any code page can be imported into a database that has a neutral code page.</span></span>
-   <span data-ttu-id="f885f-127">L’importation d’un [fichier d’archive de texte](text-archive-files.md) dans une base de données à l’aide d’une page de codes neutre définit la page de codes de la base de données sur la page de codes du fichier d’archive.</span><span class="sxs-lookup"><span data-stu-id="f885f-127">Importing a [Text Archive File](text-archive-files.md) into a database with a neutral code page sets the code page of the database to the archive file code page.</span></span> <span data-ttu-id="f885f-128">Tous les fichiers d’archive qui sont ensuite importés dans la base de données doivent avoir la même page de codes que le premier fichier.</span><span class="sxs-lookup"><span data-stu-id="f885f-128">All archive files subsequently imported into the database must have the same code page as the first file.</span></span>

<span data-ttu-id="f885f-129">Pour plus d’informations, consultez la [page détermination d’une page de codes de base de données d’installation](determining-an-installation-database-s-code-page.md) et [définition de la page de codes d’une base de données](setting-the-code-page-of-a-database.md).</span><span class="sxs-lookup"><span data-stu-id="f885f-129">For more information, see [Determining an Installation Database Code Page](determining-an-installation-database-s-code-page.md) and [Setting the Code Page of a Database](setting-the-code-page-of-a-database.md).</span></span>

<span data-ttu-id="f885f-130">Les [fichiers d’archive de texte](text-archive-files.md) qui sont exportés par [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) peuvent être utilisés avec les systèmes de gestion de version.</span><span class="sxs-lookup"><span data-stu-id="f885f-130">The [Text Archive Files](text-archive-files.md) that are exported by [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) can be used with version control systems.</span></span> <span data-ttu-id="f885f-131">Utilisez les [fonctions de base de données](database-functions.md) ou un éditeur de table de base de données pour modifier la base de données.</span><span class="sxs-lookup"><span data-stu-id="f885f-131">Use the [Database Functions](database-functions.md) or a database table editor to edit the database.</span></span>

<span data-ttu-id="f885f-132">Vous pouvez ajouter des informations de localisation à une base de données d’installation à l’aide d’un éditeur de table de base de données ou de l’API Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="f885f-132">You can add localization information to an installation database by using a database table editor or the Windows Installer API.</span></span> <span data-ttu-id="f885f-133">Pour plus d’informations, consultez [gestion des pages de codes des chaînes de paramètres](code-page-handling-of-parameter-strings.md).</span><span class="sxs-lookup"><span data-stu-id="f885f-133">For more information, see [Code Page Handling of Parameter Strings](code-page-handling-of-parameter-strings.md).</span></span>

 

 



