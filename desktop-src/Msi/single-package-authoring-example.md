---
description: L’exemple de PUASample.msi est un exemple de package Windows Installer 5,0 à double usage qui peut être installé dans le contexte d’installation par utilisateur ou par ordinateur sur Windows Server 2008 R2 et Windows 7.
ms.assetid: be018e8a-ca5f-4135-a019-970ec4173f23
title: Exemple de création de package unique
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e0ed56b8d7aaf8793416ba3ecab24c1f2a48ffe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106522095"
---
# <a name="single-package-authoring-example"></a><span data-ttu-id="e6578-103">Exemple de création de package unique</span><span class="sxs-lookup"><span data-stu-id="e6578-103">Single Package Authoring Example</span></span>

<span data-ttu-id="e6578-104">L’exemple de PUASample.msi est un exemple de package Windows Installer 5,0 à double usage qui peut être installé dans le [contexte d’installation](installation-context.md) par utilisateur ou par ordinateur sur windows Server 2008 R2 et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="e6578-104">The sample PUASample.msi is an example of a dual-purpose Windows Installer 5.0 package that is capable of being installed in either the per-user or per-machine [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="e6578-105">Cet exemple de package suit les instructions de développement décrites dans [création de package unique](single-package-authoring.md).</span><span class="sxs-lookup"><span data-stu-id="e6578-105">This sample package follows the development guidelines described in [Single Package Authoring](single-package-authoring.md).</span></span>

## <a name="obtaining-a-copy-of-the-sample"></a><span data-ttu-id="e6578-106">Obtention d’une copie de l’exemple</span><span class="sxs-lookup"><span data-stu-id="e6578-106">Obtaining a copy of the sample</span></span>

<span data-ttu-id="e6578-107">Une copie de cet exemple et d’un Windows Installer éditeur de table de base de données, Orca.exe, se trouvent dans les [composants SDK Windows pour les développeurs Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="e6578-107">A copy of this sample and a Windows Installer database table editor, Orca.exe, are in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="e6578-108">L’exemple et l’éditeur de table sont fournis avec le kit de développement logiciel (SDK) Windows pour Windows Server 2008 R2 et Windows 7 en tant que fichiers d’installation Windows Installer PUASample1.msi et Orca.msi.</span><span class="sxs-lookup"><span data-stu-id="e6578-108">The sample and table editor are provided with the Windows Software Development Kit for Windows Server 2008 R2 and Windows 7 as the Windows Installer installation files PUASample1.msi and Orca.msi.</span></span>

## <a name="system-requirements"></a><span data-ttu-id="e6578-109">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="e6578-109">System Requirements</span></span>

<span data-ttu-id="e6578-110">L’éditeur de base de données, [Orca.exe](orca-exe.md), requiert windows Server 2008 R2 et versions antérieures, ainsi que Windows 7 et versions antérieures.</span><span class="sxs-lookup"><span data-stu-id="e6578-110">The database editor, [Orca.exe](orca-exe.md), requires Windows Server 2008 R2 and earlier and Windows 7 and earlier.</span></span> <span data-ttu-id="e6578-111">Le package à double usage, PUASample1.msi, peut être installé dans le [contexte d’installation](installation-context.md) par ordinateur ou par utilisateur sur windows Server 2008 R2 et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="e6578-111">The dual-purpose package, PUASample1.msi, can be installed in either the per-machine or per-user [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="e6578-112">PUASample1.msi peut être installé uniquement dans le contexte par ordinateur sur Windows Server 2008 et versions antérieures, et Windows Vista et versions antérieures.</span><span class="sxs-lookup"><span data-stu-id="e6578-112">PUASample1.msi can be installed only in the per-machine context on Windows Server 2008 and earlier and Windows Vista and earlier.</span></span> <span data-ttu-id="e6578-113">Vous pouvez installer l’éditeur de base de données pour examiner le contenu de PUASample1.msi sans installer l’exemple.</span><span class="sxs-lookup"><span data-stu-id="e6578-113">You can install the database editor to examine the contents of PUASample1.msi without installing the sample.</span></span> <span data-ttu-id="e6578-114">Pour installer les packages de l’exemple ou de l’éditeur, vérifiez que la stratégie [DisableMSI](disablemsi.md) n’est pas définie sur une valeur qui bloque les installations d’applications.</span><span class="sxs-lookup"><span data-stu-id="e6578-114">To install the sample or editor packages, ensure that the [DisableMSI](disablemsi.md) policy is not set to a value that blocks application installations.</span></span>

## <a name="identifying-a-dual-purpose-package"></a><span data-ttu-id="e6578-115">Identification d’un package Dual-Purpose</span><span class="sxs-lookup"><span data-stu-id="e6578-115">Identifying a Dual-Purpose Package</span></span>

<span data-ttu-id="e6578-116">Les packages à double usage doivent initialiser la valeur de la propriété [**MSIINSTALLPERUSER**](msiinstallperuser.md) sur 1.</span><span class="sxs-lookup"><span data-stu-id="e6578-116">Dual-purpose packages should initialize the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1.</span></span> <span data-ttu-id="e6578-117">Cela permet d’identifier le package comme étant en mesure de l’installer dans le contexte par ordinateur ou par utilisateur sur Windows Server 2008 R2 et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="e6578-117">This identifies the package as capable of being installed in either the per-machine or per-user context on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="e6578-118">Définissez la propriété **MSIINSTALLPERUSER** dans le package uniquement si elle a été écrite conformément aux instructions de développement décrites dans [création de package unique](single-package-authoring.md) et, si vous envisagez de fournir aux utilisateurs la possibilité d’installer le package dans le contexte par utilisateur ou par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e6578-118">Set the **MSIINSTALLPERUSER** property in the package only if it has been written following the development guidelines described in [Single Package Authoring](single-package-authoring.md) and if you intend to provide users with the option to install the package in either the per-user or per-machine context.</span></span> <span data-ttu-id="e6578-119">Un package à double usage doit également initialiser la valeur de la propriété [**ALLUSERS**](allusers.md) à 2.</span><span class="sxs-lookup"><span data-stu-id="e6578-119">A dual-purpose package should also initialize the value of the [**ALLUSERS**](allusers.md) property to 2.</span></span> <span data-ttu-id="e6578-120">Cela spécifie par utilisateur comme contexte d’installation par défaut pour l’application.</span><span class="sxs-lookup"><span data-stu-id="e6578-120">This specifies per-user as the default installation context for the application.</span></span> <span data-ttu-id="e6578-121">Si la valeur de la propriété **ALLUSERS** est différente de 2, Windows Installer ignore la propriété **MSIINSTALLPERUSER** .</span><span class="sxs-lookup"><span data-stu-id="e6578-121">If the value of the **ALLUSERS** property is any value other than 2, Windows Installer ignores the **MSIINSTALLPERUSER** property.</span></span>

<span data-ttu-id="e6578-122">Utilisez un éditeur de base de données Windows Installer, tel que [Orca.exe](orca-exe.md), pour examiner le contenu de PUASample1.msi.</span><span class="sxs-lookup"><span data-stu-id="e6578-122">Use a Windows Installer database editor, such as [Orca.exe](orca-exe.md), to examine the contents of PUASample1.msi.</span></span> <span data-ttu-id="e6578-123">La table des [Propriétés](property-table.md) de l’exemple de package contient les deux entrées suivantes.</span><span class="sxs-lookup"><span data-stu-id="e6578-123">The [Property](property-table.md) table in the sample package contains the following two entries.</span></span>

<span data-ttu-id="e6578-124">[Propriété](property-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-124">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="e6578-125">Propriété</span><span class="sxs-lookup"><span data-stu-id="e6578-125">Property</span></span>          | <span data-ttu-id="e6578-126">Valeur</span><span class="sxs-lookup"><span data-stu-id="e6578-126">Value</span></span> |
|-------------------|-------|
| <span data-ttu-id="e6578-127">ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="e6578-127">ALLUSERS</span></span>          | <span data-ttu-id="e6578-128">2</span><span class="sxs-lookup"><span data-stu-id="e6578-128">2</span></span>     |
| <span data-ttu-id="e6578-129">MSIINSTALLPERUSER</span><span class="sxs-lookup"><span data-stu-id="e6578-129">MSIINSTALLPERUSER</span></span> | <span data-ttu-id="e6578-130">1</span><span class="sxs-lookup"><span data-stu-id="e6578-130">1</span></span>     |



 

## <a name="custom-dialog-box-for-installation-context"></a><span data-ttu-id="e6578-131">Boîte de dialogue personnalisée pour le contexte d’installation</span><span class="sxs-lookup"><span data-stu-id="e6578-131">Custom Dialog Box for Installation Context</span></span>

<span data-ttu-id="e6578-132">L' [interface utilisateur](user-interface.md) de l’exemple de package contient un exemple de boîte de dialogue personnalisée, VerifyReadyDialog, qui permet aux utilisateurs de sélectionner le contexte d’installation par utilisateur ou par ordinateur au moment de l’installation.</span><span class="sxs-lookup"><span data-stu-id="e6578-132">The [user interface](user-interface.md) of the sample package includes an example of a custom dialog box, VerifyReadyDialog, that enables users to select either the per-user or per-machine installation context at installation time.</span></span> <span data-ttu-id="e6578-133">La table [boîte de dialogue](dialog-table.md) contient un enregistrement qui décrit la boîte de dialogue VerifyReadyDialog.</span><span class="sxs-lookup"><span data-stu-id="e6578-133">The [Dialog](dialog-table.md) table contains a record that describes the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="e6578-134">La valeur entrée dans le champ attributs est 39, car cette boîte de dialogue utilise les [bits de style de boîte de dialogue](dialog-style-bits.md)msidbDialogAttributesVisible (1), msidbDialogAttributesModal (2), msidbDialogAttributesMinimize (4) et msidbDialogAttributesTrackDiskSpace (32).</span><span class="sxs-lookup"><span data-stu-id="e6578-134">The value entered in the Attributes field is 39 because this dialog box uses the msidbDialogAttributesVisible (1), msidbDialogAttributesModal (2), msidbDialogAttributesMinimize (4), and msidbDialogAttributesTrackDiskSpace (32) [dialog style bits](dialog-style-bits.md).</span></span> <span data-ttu-id="e6578-135">La barre de titre de la boîte de dialogue affiche un titre donné par la valeur de la propriété [**ProductName**](productname.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-135">The title bar of the dialog box displays a title given by the value of the [**ProductName**](productname.md) property.</span></span>

<span data-ttu-id="e6578-136">[Boîte de dialogue](dialog-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-136">[Dialog](dialog-table.md) Table (partial)</span></span> 

| <span data-ttu-id="e6578-137">Boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="e6578-137">Dialog</span></span>            | <span data-ttu-id="e6578-138">HCentering</span><span class="sxs-lookup"><span data-stu-id="e6578-138">HCentering</span></span> | <span data-ttu-id="e6578-139">VCentering</span><span class="sxs-lookup"><span data-stu-id="e6578-139">VCentering</span></span> | <span data-ttu-id="e6578-140">Largeur</span><span class="sxs-lookup"><span data-stu-id="e6578-140">Width</span></span> | <span data-ttu-id="e6578-141">Hauteur</span><span class="sxs-lookup"><span data-stu-id="e6578-141">Height</span></span> | <span data-ttu-id="e6578-142">Attributs</span><span class="sxs-lookup"><span data-stu-id="e6578-142">Attributes</span></span> | <span data-ttu-id="e6578-143">Intitulé</span><span class="sxs-lookup"><span data-stu-id="e6578-143">Title</span></span>           | <span data-ttu-id="e6578-144">\_Premier contrôle</span><span class="sxs-lookup"><span data-stu-id="e6578-144">Control\_First</span></span> | <span data-ttu-id="e6578-145">\_Valeur par défaut du contrôle</span><span class="sxs-lookup"><span data-stu-id="e6578-145">Control\_Default</span></span> | <span data-ttu-id="e6578-146">Annuler le contrôle \_</span><span class="sxs-lookup"><span data-stu-id="e6578-146">Control\_Cancel</span></span> |
|-------------------|------------|------------|-------|--------|------------|-----------------|----------------|------------------|-----------------|
| <span data-ttu-id="e6578-147">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-147">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-148">50</span><span class="sxs-lookup"><span data-stu-id="e6578-148">50</span></span>         | <span data-ttu-id="e6578-149">50</span><span class="sxs-lookup"><span data-stu-id="e6578-149">50</span></span>         | <span data-ttu-id="e6578-150">480</span><span class="sxs-lookup"><span data-stu-id="e6578-150">480</span></span>   | <span data-ttu-id="e6578-151">280</span><span class="sxs-lookup"><span data-stu-id="e6578-151">280</span></span>    | <span data-ttu-id="e6578-152">39</span><span class="sxs-lookup"><span data-stu-id="e6578-152">39</span></span>         | <span data-ttu-id="e6578-153">\[ProductName\]</span><span class="sxs-lookup"><span data-stu-id="e6578-153">\[ProductName\]</span></span> | <span data-ttu-id="e6578-154">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-154">InstallPerUser</span></span> | <span data-ttu-id="e6578-155">Suivant</span><span class="sxs-lookup"><span data-stu-id="e6578-155">Next</span></span>             | <span data-ttu-id="e6578-156">Annuler</span><span class="sxs-lookup"><span data-stu-id="e6578-156">Cancel</span></span>          |



 

<span data-ttu-id="e6578-157">La table de [contrôle](control-table.md) contient des entrées pour les [contrôles](controls.md) affichés par la boîte de dialogue VerifyReadyDialog.</span><span class="sxs-lookup"><span data-stu-id="e6578-157">The [Control](control-table.md) table contains entries for the [controls](controls.md) displayed by the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="e6578-158">La boîte de dialogue affiche les contrôles [PUSHBUTTON](pushbutton-control.md) et un contrôle de [texte](text-control.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-158">The dialog box displays [PushButton](pushbutton-control.md) controls and a [Text](text-control.md) control.</span></span> <span data-ttu-id="e6578-159">Tous les contrôles utilisent les [attributs de contrôle](control-attributes.md)msidbControlAttributesEnabled (2) et msidbControlAttributesVisible (1).</span><span class="sxs-lookup"><span data-stu-id="e6578-159">All the controls use the msidbControlAttributesEnabled (2) and msidbControlAttributesVisible (1) [control attributes](control-attributes.md).</span></span> <span data-ttu-id="e6578-160">Le contrôle InstallPerMachine utilise également l’attribut de contrôle [ElevationShield](elevationshield-attribute.md) , msidbControlAttributesElevationShield (8388608.) Cet attribut de contrôle ajoute l’icône d’élévation du [*contrôle de compte d’utilisateur*](u-gly.md) (icône bouclier) au contrôle InstallPerMachine et informe l’utilisateur que les informations d’identification UAC sont requises pour installer l’application dans le contexte par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e6578-160">The InstallPerMachine control also uses the [ElevationShield](elevationshield-attribute.md) control attribute, msidbControlAttributesElevationShield (8388608.) This control attribute adds the [*User Account Control*](u-gly.md) (UAC) elevation icon (shield icon) to the InstallPerMachine control and informs the user that UAC credentials are required to install the application in the per-machine context.</span></span> <span data-ttu-id="e6578-161">La valeur dans le champ de texte de la table de contrôle correspond au style de texte et au texte affiché par le contrôle.</span><span class="sxs-lookup"><span data-stu-id="e6578-161">The value in the Text field of the Control table is the text-style and text displayed by the control.</span></span> <span data-ttu-id="e6578-162">Pour plus d’informations sur l’ajout de texte à un contrôle à l’aide de styles prédéfinis, consultez la description du champ de texte dans la rubrique table de contrôle.</span><span class="sxs-lookup"><span data-stu-id="e6578-162">See the description of the Text field in the Control table topic for more information about adding text to a control using predefined styles.</span></span>

<span data-ttu-id="e6578-163">[Contrôle](control-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-163">[Control](control-table.md) Table (partial)</span></span>

| <span data-ttu-id="e6578-164">Dialogue\_</span><span class="sxs-lookup"><span data-stu-id="e6578-164">Dialog\_</span></span>          | <span data-ttu-id="e6578-165">Contrôler</span><span class="sxs-lookup"><span data-stu-id="e6578-165">Control</span></span>           | <span data-ttu-id="e6578-166">Type</span><span class="sxs-lookup"><span data-stu-id="e6578-166">Type</span></span>       | <span data-ttu-id="e6578-167">Attribut</span><span class="sxs-lookup"><span data-stu-id="e6578-167">Attribute</span></span> | <span data-ttu-id="e6578-168">Texte</span><span class="sxs-lookup"><span data-stu-id="e6578-168">Text</span></span>                                                   | <span data-ttu-id="e6578-169">Contrôle \_ suivant</span><span class="sxs-lookup"><span data-stu-id="e6578-169">Control\_Next</span></span>     |
|-------------------|-------------------|------------|-----------|--------------------------------------------------------|-------------------|
| <span data-ttu-id="e6578-170">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-170">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-171">Annuler</span><span class="sxs-lookup"><span data-stu-id="e6578-171">Cancel</span></span>            | <span data-ttu-id="e6578-172">Boutons</span><span class="sxs-lookup"><span data-stu-id="e6578-172">PushButton</span></span> | <span data-ttu-id="e6578-173">3</span><span class="sxs-lookup"><span data-stu-id="e6578-173">3</span></span>         | <span data-ttu-id="e6578-174">{ \\ Tahoma10} &annuler</span><span class="sxs-lookup"><span data-stu-id="e6578-174">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="e6578-175">Suivant</span><span class="sxs-lookup"><span data-stu-id="e6578-175">Next</span></span>              |
| <span data-ttu-id="e6578-176">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-176">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-177">Précédente</span><span class="sxs-lookup"><span data-stu-id="e6578-177">Previous</span></span>          | <span data-ttu-id="e6578-178">Boutons</span><span class="sxs-lookup"><span data-stu-id="e6578-178">PushButton</span></span> | <span data-ttu-id="e6578-179">3</span><span class="sxs-lookup"><span data-stu-id="e6578-179">3</span></span>         | <span data-ttu-id="e6578-180">{ \\ Tahoma10} <<&précédent</span><span class="sxs-lookup"><span data-stu-id="e6578-180">{\\Tahoma10}<<&Previous</span></span>                          | <span data-ttu-id="e6578-181">Annuler</span><span class="sxs-lookup"><span data-stu-id="e6578-181">Cancel</span></span>            |
| <span data-ttu-id="e6578-182">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-182">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-183">Suivant</span><span class="sxs-lookup"><span data-stu-id="e6578-183">Next</span></span>              | <span data-ttu-id="e6578-184">Boutons</span><span class="sxs-lookup"><span data-stu-id="e6578-184">PushButton</span></span> | <span data-ttu-id="e6578-185">3</span><span class="sxs-lookup"><span data-stu-id="e6578-185">3</span></span>         | <span data-ttu-id="e6578-186">{ \\ Tahoma10} &>> suivant</span><span class="sxs-lookup"><span data-stu-id="e6578-186">{\\Tahoma10}&Next >></span></span>                             | <span data-ttu-id="e6578-187">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-187">InstallPerUser</span></span>    |
| <span data-ttu-id="e6578-188">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-188">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-189">Text2</span><span class="sxs-lookup"><span data-stu-id="e6578-189">Text2</span></span>             | <span data-ttu-id="e6578-190">Texte</span><span class="sxs-lookup"><span data-stu-id="e6578-190">Text</span></span>       | <span data-ttu-id="e6578-191">3</span><span class="sxs-lookup"><span data-stu-id="e6578-191">3</span></span>         | <span data-ttu-id="e6578-192">Êtes-vous prêt à terminer l’installation interrompue ?</span><span class="sxs-lookup"><span data-stu-id="e6578-192">Are you ready to complete your suspended installation?</span></span> |                   |
| <span data-ttu-id="e6578-193">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-193">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-194">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-194">InstallPerUser</span></span>    | <span data-ttu-id="e6578-195">Boutons</span><span class="sxs-lookup"><span data-stu-id="e6578-195">PushButton</span></span> | <span data-ttu-id="e6578-196">3</span><span class="sxs-lookup"><span data-stu-id="e6578-196">3</span></span>         | <span data-ttu-id="e6578-197">{ \\ Tahoma10} installer uniquement pour &moi</span><span class="sxs-lookup"><span data-stu-id="e6578-197">{\\Tahoma10}Install Only for &Me</span></span>                       | <span data-ttu-id="e6578-198">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="e6578-198">InstallPerMachine</span></span> |
| <span data-ttu-id="e6578-199">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-199">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-200">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="e6578-200">InstallPerMachine</span></span> | <span data-ttu-id="e6578-201">Boutons</span><span class="sxs-lookup"><span data-stu-id="e6578-201">PushButton</span></span> | <span data-ttu-id="e6578-202">8388611</span><span class="sxs-lookup"><span data-stu-id="e6578-202">8388611</span></span>   | <span data-ttu-id="e6578-203">{ \\ Tahoma10} installer pour &tout le monde</span><span class="sxs-lookup"><span data-stu-id="e6578-203">{\\Tahoma10}Install for &Everyone</span></span>                      | <span data-ttu-id="e6578-204">Précédente</span><span class="sxs-lookup"><span data-stu-id="e6578-204">Previous</span></span>          |
| <span data-ttu-id="e6578-205">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-205">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-206">Annuler</span><span class="sxs-lookup"><span data-stu-id="e6578-206">Cancel</span></span>            | <span data-ttu-id="e6578-207">Boutons</span><span class="sxs-lookup"><span data-stu-id="e6578-207">PushButton</span></span> | <span data-ttu-id="e6578-208">3</span><span class="sxs-lookup"><span data-stu-id="e6578-208">3</span></span>         | <span data-ttu-id="e6578-209">{ \\ Tahoma10} &annuler</span><span class="sxs-lookup"><span data-stu-id="e6578-209">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="e6578-210">Suivant</span><span class="sxs-lookup"><span data-stu-id="e6578-210">Next</span></span>              |



 

<span data-ttu-id="e6578-211">La table [ControlEvent,](controlevent-table.md) spécifie le [ControlEvents](control-events.md), ou les actions, que le programme d’installation effectue lorsque l’utilisateur interagit avec un contrôle.</span><span class="sxs-lookup"><span data-stu-id="e6578-211">The [ControlEvent](controlevent-table.md) table specifies the [ControlEvents](control-events.md), or actions, the installer performs when the user interacts with a control.</span></span> <span data-ttu-id="e6578-212">Lorsqu’un utilisateur active le bouton de sélection InstallPerUser, l’interface utilisateur affiche une boîte de dialogue OutOfDisk si la propriété [**OutOfDiskSpace**](outofdiskspace.md) a la valeur 1, définit la valeur de la propriété [**MSIINSTALLPERUSER**](msiinstallperuser.md) sur 1, définit la propriété [**ALLUSERS**](allusers.md) sur la valeur 2, affecte la valeur 1 à la propriété [**MSIFASTINSTALL**](msifastinstall.md) et retourne.</span><span class="sxs-lookup"><span data-stu-id="e6578-212">When a user activates the InstallPerUser pushbutton, the user interface displays an OutOfDisk dialog box if the [**OutOfDiskSpace**](outofdiskspace.md) property is 1, sets the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1, sets the value of the [**ALLUSERS**](allusers.md) property to 2, sets the [**MSIFASTINSTALL**](msifastinstall.md) property to 1, and returns .</span></span> <span data-ttu-id="e6578-213">Étant donné que la propriété **MSIFASTINSTALL** est définie, aucun point de restauration système n’est généré pour l’installation.</span><span class="sxs-lookup"><span data-stu-id="e6578-213">Because the **MSIFASTINSTALL** property is set, no System Restore point is generated for the installation.</span></span> <span data-ttu-id="e6578-214">Lorsqu’un utilisateur active le PUSHBUTTON InstallPerMachine, l’interface utilisateur affiche une boîte de dialogue OutOfDisk si la propriété **OutOfDiskSpace** est 1, définit la valeur de la propriété **ALLUSERS** sur 1 et retourne.</span><span class="sxs-lookup"><span data-stu-id="e6578-214">When a user activates the InstallPerMachine pushbutton, the user interface displays an OutOfDisk dialog box if the **OutOfDiskSpace** property is 1, sets the value of the **ALLUSERS** property to 1, and returns.</span></span>

<span data-ttu-id="e6578-215">[ControlEvent,](controlevent-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-215">[ControlEvent](controlevent-table.md) Table (partial)</span></span> 

| <span data-ttu-id="e6578-216">Dialogue\_</span><span class="sxs-lookup"><span data-stu-id="e6578-216">Dialog\_</span></span>          | <span data-ttu-id="e6578-217">contrôle\_</span><span class="sxs-lookup"><span data-stu-id="e6578-217">Control\_</span></span>         | <span data-ttu-id="e6578-218">Événement</span><span class="sxs-lookup"><span data-stu-id="e6578-218">Event</span></span>                 | <span data-ttu-id="e6578-219">Argument</span><span class="sxs-lookup"><span data-stu-id="e6578-219">Argument</span></span>  | <span data-ttu-id="e6578-220">Condition</span><span class="sxs-lookup"><span data-stu-id="e6578-220">Condition</span></span>                 | <span data-ttu-id="e6578-221">Commande</span><span class="sxs-lookup"><span data-stu-id="e6578-221">Order</span></span> |
|-------------------|-------------------|-----------------------|-----------|---------------------------|-------|
| <span data-ttu-id="e6578-222">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-222">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-223">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-223">InstallPerUser</span></span>    | <span data-ttu-id="e6578-224">SpawnDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-224">SpawnDialog</span></span>           | <span data-ttu-id="e6578-225">OutOfDisk</span><span class="sxs-lookup"><span data-stu-id="e6578-225">OutOfDisk</span></span> | <span data-ttu-id="e6578-226">OutOfDiskSpace = 1</span><span class="sxs-lookup"><span data-stu-id="e6578-226">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="e6578-227">1</span><span class="sxs-lookup"><span data-stu-id="e6578-227">1</span></span>     |
| <span data-ttu-id="e6578-228">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-228">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-229">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-229">InstallPerUser</span></span>    | <span data-ttu-id="e6578-230">EndDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-230">EndDialog</span></span>             | <span data-ttu-id="e6578-231">Renvoie</span><span class="sxs-lookup"><span data-stu-id="e6578-231">Return</span></span>    | <span data-ttu-id="e6578-232">OutOfDiskSpace <> 1</span><span class="sxs-lookup"><span data-stu-id="e6578-232">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="e6578-233">5</span><span class="sxs-lookup"><span data-stu-id="e6578-233">5</span></span>     |
| <span data-ttu-id="e6578-234">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-234">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-235">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-235">InstallPerUser</span></span>    | <span data-ttu-id="e6578-236">\[MSIINSTALLPERUSER\]</span><span class="sxs-lookup"><span data-stu-id="e6578-236">\[MSIINSTALLPERUSER\]</span></span> | <span data-ttu-id="e6578-237">1</span><span class="sxs-lookup"><span data-stu-id="e6578-237">1</span></span>         | <span data-ttu-id="e6578-238">1</span><span class="sxs-lookup"><span data-stu-id="e6578-238">1</span></span>                         | <span data-ttu-id="e6578-239">2</span><span class="sxs-lookup"><span data-stu-id="e6578-239">2</span></span>     |
| <span data-ttu-id="e6578-240">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-240">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-241">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-241">InstallPerUser</span></span>    | <span data-ttu-id="e6578-242">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="e6578-242">\[ALLUSERS\]</span></span>          | <span data-ttu-id="e6578-243">2</span><span class="sxs-lookup"><span data-stu-id="e6578-243">2</span></span>         | <span data-ttu-id="e6578-244">1</span><span class="sxs-lookup"><span data-stu-id="e6578-244">1</span></span>                         | <span data-ttu-id="e6578-245">3</span><span class="sxs-lookup"><span data-stu-id="e6578-245">3</span></span>     |
| <span data-ttu-id="e6578-246">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-246">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-247">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="e6578-247">InstallPerMachine</span></span> | <span data-ttu-id="e6578-248">SpawnDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-248">SpawnDialog</span></span>           | <span data-ttu-id="e6578-249">OutOfDisk</span><span class="sxs-lookup"><span data-stu-id="e6578-249">OutOfDisk</span></span> | <span data-ttu-id="e6578-250">OutOfDiskSpace = 1</span><span class="sxs-lookup"><span data-stu-id="e6578-250">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="e6578-251">1</span><span class="sxs-lookup"><span data-stu-id="e6578-251">1</span></span>     |
| <span data-ttu-id="e6578-252">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-252">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-253">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="e6578-253">InstallPerMachine</span></span> | <span data-ttu-id="e6578-254">EndDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-254">EndDialog</span></span>             | <span data-ttu-id="e6578-255">Renvoie</span><span class="sxs-lookup"><span data-stu-id="e6578-255">Return</span></span>    | <span data-ttu-id="e6578-256">OutOfDiskSpace <> 1</span><span class="sxs-lookup"><span data-stu-id="e6578-256">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="e6578-257">3</span><span class="sxs-lookup"><span data-stu-id="e6578-257">3</span></span>     |
| <span data-ttu-id="e6578-258">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-258">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-259">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="e6578-259">InstallPerMachine</span></span> | <span data-ttu-id="e6578-260">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="e6578-260">\[ALLUSERS\]</span></span>          | <span data-ttu-id="e6578-261">1</span><span class="sxs-lookup"><span data-stu-id="e6578-261">1</span></span>         | <span data-ttu-id="e6578-262">1</span><span class="sxs-lookup"><span data-stu-id="e6578-262">1</span></span>                         | <span data-ttu-id="e6578-263">2</span><span class="sxs-lookup"><span data-stu-id="e6578-263">2</span></span>     |
| <span data-ttu-id="e6578-264">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-264">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-265">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-265">InstallPerUser</span></span>    | <span data-ttu-id="e6578-266">\[MSIFASTINSTALL\]</span><span class="sxs-lookup"><span data-stu-id="e6578-266">\[MSIFASTINSTALL\]</span></span>    | <span data-ttu-id="e6578-267">1</span><span class="sxs-lookup"><span data-stu-id="e6578-267">1</span></span>         | <span data-ttu-id="e6578-268">1</span><span class="sxs-lookup"><span data-stu-id="e6578-268">1</span></span>                         | <span data-ttu-id="e6578-269">4</span><span class="sxs-lookup"><span data-stu-id="e6578-269">4</span></span>     |



 

<span data-ttu-id="e6578-270">Le contrôle InstallPerUser doit être supprimé de l’interface utilisateur de toute installation à l’aide d’une Windows Installer version antérieure à Windows Installer Windows Installer 5,0.</span><span class="sxs-lookup"><span data-stu-id="e6578-270">The InstallPerUser control should be removed from the user interface of any installation using a Windows Installer version earlier than Windows Installer Windows Installer 5.0.</span></span> <span data-ttu-id="e6578-271">La table [ControlCondition](controlcondition-table.md) de l’exemple de package contient quatre entrées qui désactivent et masquent le contrôle InstallPerUser si la version actuelle est inférieure à Windows Installer 5,0.</span><span class="sxs-lookup"><span data-stu-id="e6578-271">The [ControlCondition](controlcondition-table.md) table in the sample package contains four entries that disable and hide the InstallPerUser control if the current version is less than Windows Installer 5.0.</span></span> <span data-ttu-id="e6578-272">La table utilise la valeur de la propriété [**VersionMsi**](versionmsi.md) et la [syntaxe d’instruction conditionnelle](conditional-statement-syntax.md) pour définir cette condition.</span><span class="sxs-lookup"><span data-stu-id="e6578-272">The table uses the value of the [**VersionMsi**](versionmsi.md) property and the [conditional statement syntax](conditional-statement-syntax.md) to define this condition.</span></span> <span data-ttu-id="e6578-273">L’action spécifiée dans le champ action est exécutée uniquement si l’instruction dans le champ condition a la valeur true.</span><span class="sxs-lookup"><span data-stu-id="e6578-273">The action specified in the Action field is performed only if the statement in the Condition field is true.</span></span>

<span data-ttu-id="e6578-274">[ControlCondition](controlcondition-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-274">[ControlCondition](controlcondition-table.md) Table (partial)</span></span>

| <span data-ttu-id="e6578-275">Dialogue\_</span><span class="sxs-lookup"><span data-stu-id="e6578-275">Dialog\_</span></span>          | <span data-ttu-id="e6578-276">contrôle\_</span><span class="sxs-lookup"><span data-stu-id="e6578-276">Control\_</span></span>      | <span data-ttu-id="e6578-277">Action</span><span class="sxs-lookup"><span data-stu-id="e6578-277">Action</span></span>  | <span data-ttu-id="e6578-278">Condition</span><span class="sxs-lookup"><span data-stu-id="e6578-278">Condition</span></span>               |
|-------------------|----------------|---------|-------------------------|
| <span data-ttu-id="e6578-279">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-279">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-280">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-280">InstallPerUser</span></span> | <span data-ttu-id="e6578-281">Activer</span><span class="sxs-lookup"><span data-stu-id="e6578-281">Enable</span></span>  | <span data-ttu-id="e6578-282">VersionMsi >= « 5,00 »</span><span class="sxs-lookup"><span data-stu-id="e6578-282">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="e6578-283">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-283">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-284">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-284">InstallPerUser</span></span> | <span data-ttu-id="e6578-285">Désactiver</span><span class="sxs-lookup"><span data-stu-id="e6578-285">Disable</span></span> | <span data-ttu-id="e6578-286">VersionMsi < « 5,00 »</span><span class="sxs-lookup"><span data-stu-id="e6578-286">VersionMsi < "5.00"</span></span>  |
| <span data-ttu-id="e6578-287">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-287">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-288">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-288">InstallPerUser</span></span> | <span data-ttu-id="e6578-289">Afficher</span><span class="sxs-lookup"><span data-stu-id="e6578-289">Show</span></span>    | <span data-ttu-id="e6578-290">VersionMsi >= « 5,00 »</span><span class="sxs-lookup"><span data-stu-id="e6578-290">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="e6578-291">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="e6578-291">VerifyReadyDialog</span></span> | <span data-ttu-id="e6578-292">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="e6578-292">InstallPerUser</span></span> | <span data-ttu-id="e6578-293">Masquer</span><span class="sxs-lookup"><span data-stu-id="e6578-293">Hide</span></span>    | <span data-ttu-id="e6578-294">VersionMsi < « 5,00 »</span><span class="sxs-lookup"><span data-stu-id="e6578-294">VersionMsi < "5.00"</span></span>  |



 

## <a name="specifying-directory-structure"></a><span data-ttu-id="e6578-295">Spécification de la structure de répertoires</span><span class="sxs-lookup"><span data-stu-id="e6578-295">Specifying Directory Structure</span></span>

<span data-ttu-id="e6578-296">Utilisez l’éditeur de base de données pour examiner la table de [répertoire](directory-table.md) de PUASample1.msi.</span><span class="sxs-lookup"><span data-stu-id="e6578-296">Use the database editor to examine the [Directory](directory-table.md) table of PUASample1.msi.</span></span> <span data-ttu-id="e6578-297">L’enregistrement de la table de répertoire ayant une chaîne vide dans son \_ champ parent de répertoire représente le répertoire racine des arborescences de répertoires source et cible.</span><span class="sxs-lookup"><span data-stu-id="e6578-297">The record of the Directory Table having an empty string in its Directory\_Parent field represents the root directory of both the source and target directory trees.</span></span> <span data-ttu-id="e6578-298">Si la propriété [**targetDir**](targetdir.md) n’est pas définie, le programme d’installation définit sa valeur au moment de l’installation sur la valeur de la propriété [**ROOTDRIVE**](rootdrive.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-298">If the [**TARGETDIR**](targetdir.md) property is undefined, the installer sets its value at installation time to the value of the [**ROOTDRIVE**](rootdrive.md) property.</span></span> <span data-ttu-id="e6578-299">Si la propriété [**SourceDir**](sourcedir.md) n’est pas définie, le programme d’installation définit sa valeur sur l’emplacement du répertoire contenant le package Windows Installer (fichier. msi). Les noms de répertoires sont spécifiés à l’aide du \| format short long.</span><span class="sxs-lookup"><span data-stu-id="e6578-299">If the [**SourceDir**](sourcedir.md) property is undefined, the installer sets its value to the location of the directory containing the Windows Installer package (.msi file.) The directory names are specified using the short\|long format.</span></span>

<span data-ttu-id="e6578-300">[Répertoire](directory-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-300">[Directory](directory-table.md) Table (partial)</span></span>

| <span data-ttu-id="e6578-301">Répertoire</span><span class="sxs-lookup"><span data-stu-id="e6578-301">Directory</span></span>          | <span data-ttu-id="e6578-302">Répertoire \_ parent</span><span class="sxs-lookup"><span data-stu-id="e6578-302">Directory\_Parent</span></span>  | <span data-ttu-id="e6578-303">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="e6578-303">DefaultDir</span></span>               |
|--------------------|--------------------|--------------------------|
| <span data-ttu-id="e6578-304">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-304">TARGETDIR</span></span>          |                    | <span data-ttu-id="e6578-305">SourceDir</span><span class="sxs-lookup"><span data-stu-id="e6578-305">SourceDir</span></span>                |
| <span data-ttu-id="e6578-306">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="e6578-306">ProgramFilesFolder</span></span> | <span data-ttu-id="e6578-307">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-307">TARGETDIR</span></span>          | <span data-ttu-id="e6578-308">.</span><span class="sxs-lookup"><span data-stu-id="e6578-308">.</span></span>                        |
| <span data-ttu-id="e6578-309">ProgramMenuFolder</span><span class="sxs-lookup"><span data-stu-id="e6578-309">ProgramMenuFolder</span></span>  | <span data-ttu-id="e6578-310">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-310">TARGETDIR</span></span>          | <span data-ttu-id="e6578-311">.</span><span class="sxs-lookup"><span data-stu-id="e6578-311">.</span></span>                        |
| <span data-ttu-id="e6578-312">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="e6578-312">INSTALLLOCATION</span></span>    | <span data-ttu-id="e6578-313">MyVendor</span><span class="sxs-lookup"><span data-stu-id="e6578-313">MyVendor</span></span>           | <span data-ttu-id="e6578-314">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="e6578-314">Sample1\|MSDN-PUASample1</span></span> |
| <span data-ttu-id="e6578-315">MyVendor</span><span class="sxs-lookup"><span data-stu-id="e6578-315">MyVendor</span></span>           | <span data-ttu-id="e6578-316">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="e6578-316">ProgramFilesFolder</span></span> | <span data-ttu-id="e6578-317">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="e6578-317">Msft\|Microsoft</span></span>          |



 

<span data-ttu-id="e6578-318">À la source, cette table de [répertoires](directory-table.md) correspond aux chemins d’accès aux répertoires suivants.</span><span class="sxs-lookup"><span data-stu-id="e6578-318">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="e6578-319">\[SourceDir \] \\ msft \\ sample1</span><span class="sxs-lookup"><span data-stu-id="e6578-319">\[SourceDir\]\\Msft\\Sample1</span></span>  
<span data-ttu-id="e6578-320">\[SourceDir\]</span><span class="sxs-lookup"><span data-stu-id="e6578-320">\[SourceDir\]</span></span>  
</dl>

<span data-ttu-id="e6578-321">Au niveau de la cible, la table de [répertoires](directory-table.md) correspond aux chemins d’accès figurant dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="e6578-321">At the target, the [Directory](directory-table.md) table resolves to the paths in the following table.</span></span> <span data-ttu-id="e6578-322">Le programme d’installation définit les valeurs des propriétés [**ProgramFilesFolder**](programfilesfolder.md) et [**ProgramMenuFolder**](programmenufolder.md) sur les emplacements qui dépendent du [contexte d’installation](installation-context.md) et indique si le système est la version 32 bits ou 64 bits de Windows Server 2008 R2 et Windows 7.</span><span class="sxs-lookup"><span data-stu-id="e6578-322">The installer sets the values of the [**ProgramFilesFolder**](programfilesfolder.md) and [**ProgramMenuFolder**](programmenufolder.md) properties to locations that depend upon the [installation context](installation-context.md) and whether the system is the 32-bit or 64-bit versions of Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="e6578-323">Les chemins d’accès aux dossiers cibles varient selon que l’utilisateur sélectionne une installation par utilisateur ou par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e6578-323">The paths to the target folders depend on whether the user selects a per-user or per-machine installation.</span></span>

| <span data-ttu-id="e6578-324">Contexte d’installation</span><span class="sxs-lookup"><span data-stu-id="e6578-324">Installation Context</span></span> | <span data-ttu-id="e6578-325">Système</span><span class="sxs-lookup"><span data-stu-id="e6578-325">System</span></span>                                                                              | <span data-ttu-id="e6578-326">Exemples de chemins</span><span class="sxs-lookup"><span data-stu-id="e6578-326">Example Paths</span></span>                                                                                                                    |
|----------------------|-------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e6578-327">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="e6578-327">Per-Machine</span></span>          | <span data-ttu-id="e6578-328">Windows Server 2008 R2 et Windows 7</span><span class="sxs-lookup"><span data-stu-id="e6578-328">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="e6578-329">version 32 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-329">32-bit version</span></span><br/>           | <span data-ttu-id="e6578-330">% ProgramFiles% \\ msft \\ sample1</span><span class="sxs-lookup"><span data-stu-id="e6578-330">%ProgramFiles%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="e6578-331">% ALLUSERSPROFILE% \\ des \\ \\ programmes du menu démarrer \\ de Microsoft Windows</span><span class="sxs-lookup"><span data-stu-id="e6578-331">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>                  |
| <span data-ttu-id="e6578-332">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="e6578-332">Per-Machine</span></span>          | <span data-ttu-id="e6578-333">Windows Server 2008 R2 et Windows 7</span><span class="sxs-lookup"><span data-stu-id="e6578-333">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="e6578-334">version 64 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-334">64-bit version</span></span><br/>           | <span data-ttu-id="e6578-335">% ProgramFiles (x86)% \\ msft \\ sample1</span><span class="sxs-lookup"><span data-stu-id="e6578-335">%ProgramFiles(x86)%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="e6578-336">% ALLUSERSPROFILE% \\ des \\ \\ programmes du menu démarrer \\ de Microsoft Windows</span><span class="sxs-lookup"><span data-stu-id="e6578-336">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>             |
| <span data-ttu-id="e6578-337">Per-User</span><span class="sxs-lookup"><span data-stu-id="e6578-337">Per-User</span></span>             | <span data-ttu-id="e6578-338">Windows Server 2008 R2 et Windows 7</span><span class="sxs-lookup"><span data-stu-id="e6578-338">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="e6578-339">version 32 bits ou 64 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-339">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="e6578-340">% USERPROFILE% \\ AppData \\ local \\ Programs \\ msft \\ sample1</span><span class="sxs-lookup"><span data-stu-id="e6578-340">%USERPROFILE%\\AppData\\Local\\Programs\\Msft\\Sample1</span></span><br/> <span data-ttu-id="e6578-341">% APPDATA% \\ des \\ \\ programmes du menu démarrer \\ de Microsoft Windows</span><span class="sxs-lookup"><span data-stu-id="e6578-341">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/> |



 

<span data-ttu-id="e6578-342">Les applications par utilisateur doivent être stockées dans des sous-dossiers sous le dossier programmes spécifié par la valeur de la propriété [**ProgramFilesFolder**](programfilesfolder.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-342">Per-user applications should be stored in subfolders under the Programs folder specified by the value of [**ProgramFilesFolder**](programfilesfolder.md) property.</span></span> <span data-ttu-id="e6578-343">En général, le chemin d’accès à l’application prend la forme suivante.</span><span class="sxs-lookup"><span data-stu-id="e6578-343">Typically, the path to the application takes the following form.</span></span>

<span data-ttu-id="e6578-344">% LocalAppData% \\ Programs \\ *ISV Name* \\ *appname*.</span><span class="sxs-lookup"><span data-stu-id="e6578-344">%LOCALAPPDATA%\\Programs\\*ISV name*\\*AppName*.</span></span>

<span data-ttu-id="e6578-345">Les données de configuration par utilisateur doivent être stockées dans le dossier Programs spécifié par la valeur de la propriété [**ProgramMenuFolder**](programmenufolder.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-345">Per-user configuration data should be stored in the Programs folder specified by the value of the [**ProgramMenuFolder**](programmenufolder.md) property.</span></span> <span data-ttu-id="e6578-346">En règle générale, ce dossier se trouve à l’emplacement suivant.</span><span class="sxs-lookup"><span data-stu-id="e6578-346">Typically, this folder is located at the following path.</span></span>

<span data-ttu-id="e6578-347">% APPDATA% \\ des \\ \\ programmes du menu démarrer \\ de Microsoft Windows</span><span class="sxs-lookup"><span data-stu-id="e6578-347">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span>

<span data-ttu-id="e6578-348">Si vous installez des composants [de Package Windows Installer 32 bits](32-bit-windows-installer-packages.md) , utilisez la propriété [**ProgramFilesFolder**](programfilesfolder.md) et [**CommonFilesFolder**](commonfilesfolder.md) dans la table [Directory](directory-table.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-348">If installing [32-bit Windows Installer Package](32-bit-windows-installer-packages.md) components, use the [**ProgramFilesFolder**](programfilesfolder.md) and [**CommonFilesFolder**](commonfilesfolder.md) property in the [Directory](directory-table.md) table.</span></span> <span data-ttu-id="e6578-349">Si vous installez des composants [de Package Windows Installer 64 bits](64-bit-windows-installer-packages.md) , utilisez les propriétés [**ProgramFiles64Folder**](programfiles64folder.md) et [**CommonFiles64Folder**](commonfiles64folder.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-349">If installing [64-bit Windows Installer Package](64-bit-windows-installer-packages.md) components, use the [**ProgramFiles64Folder**](programfiles64folder.md) and [**CommonFiles64Folder**](commonfiles64folder.md) properties.</span></span> <span data-ttu-id="e6578-350">Si votre application contient des versions 32 bits et 64 bits du même composant, avec le même nom, assurez-vous que ces versions sont enregistrées dans des répertoires différents ou attribuez-leur des noms différents.</span><span class="sxs-lookup"><span data-stu-id="e6578-350">If your application contains 32-bit and 64-bit versions of the same component, with the same name, ensure that these versions are saved in different directories or give them different names.</span></span>

<span data-ttu-id="e6578-351">La table de [répertoire](directory-table.md) suivante fournit un exemple de disposition de répertoire compatible avec un package qui inclut des composants 32 bits et 64 bits et inclut certains composants qui sont partagés entre les applications.</span><span class="sxs-lookup"><span data-stu-id="e6578-351">The following [Directory](directory-table.md) table provides an example of a directory layout compatible with a package that includes 32-bit and 64-bit components and includes some components that are shared across applications.</span></span>

| <span data-ttu-id="e6578-352">Répertoire</span><span class="sxs-lookup"><span data-stu-id="e6578-352">Directory</span></span>            | <span data-ttu-id="e6578-353">Répertoire \_ parent</span><span class="sxs-lookup"><span data-stu-id="e6578-353">Directory\_Parent</span></span>    | <span data-ttu-id="e6578-354">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="e6578-354">DefaultDir</span></span>                        |
|----------------------|----------------------|-----------------------------------|
| <span data-ttu-id="e6578-355">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-355">TARGETDIR</span></span>            |                      | <span data-ttu-id="e6578-356">SourceDir</span><span class="sxs-lookup"><span data-stu-id="e6578-356">SourceDir</span></span>                         |
| <span data-ttu-id="e6578-357">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="e6578-357">ProgramFilesFolder</span></span>   | <span data-ttu-id="e6578-358">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-358">TARGETDIR</span></span>            | <span data-ttu-id="e6578-359">. :P rog32</span><span class="sxs-lookup"><span data-stu-id="e6578-359">.:Prog32</span></span>                          |
| <span data-ttu-id="e6578-360">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="e6578-360">ProgramFiles64Folder</span></span> | <span data-ttu-id="e6578-361">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-361">TARGETDIR</span></span>            | <span data-ttu-id="e6578-362">. :P rog64</span><span class="sxs-lookup"><span data-stu-id="e6578-362">.:Prog64</span></span>                          |
| <span data-ttu-id="e6578-363">CommonFilesFolder</span><span class="sxs-lookup"><span data-stu-id="e6578-363">CommonFilesFolder</span></span>    | <span data-ttu-id="e6578-364">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-364">TARGETDIR</span></span>            | <span data-ttu-id="e6578-365">.:Share32</span><span class="sxs-lookup"><span data-stu-id="e6578-365">.:Share32</span></span>                         |
| <span data-ttu-id="e6578-366">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="e6578-366">CommonFiles64Folder</span></span>  | <span data-ttu-id="e6578-367">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-367">TARGETDIR</span></span>            | <span data-ttu-id="e6578-368">.:Share64</span><span class="sxs-lookup"><span data-stu-id="e6578-368">.:Share64</span></span>                         |
| <span data-ttu-id="e6578-369">ProgramMenuFolder</span><span class="sxs-lookup"><span data-stu-id="e6578-369">ProgramMenuFolder</span></span>    | <span data-ttu-id="e6578-370">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="e6578-370">TARGETDIR</span></span>            | <span data-ttu-id="e6578-371">. : Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="e6578-371">.:Sample1\|MSDN-PUASample1</span></span>        |
| <span data-ttu-id="e6578-372">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="e6578-372">INSTALLLOCATION</span></span>      | <span data-ttu-id="e6578-373">MyVendor</span><span class="sxs-lookup"><span data-stu-id="e6578-373">MyVendor</span></span>             | <span data-ttu-id="e6578-374">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="e6578-374">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="e6578-375">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="e6578-375">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="e6578-376">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="e6578-376">Vendorx64</span></span>            | <span data-ttu-id="e6578-377">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="e6578-377">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="e6578-378">SHAREDLOCATION</span><span class="sxs-lookup"><span data-stu-id="e6578-378">SHAREDLOCATION</span></span>       | <span data-ttu-id="e6578-379">ShVendor</span><span class="sxs-lookup"><span data-stu-id="e6578-379">ShVendor</span></span>             | <span data-ttu-id="e6578-380">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="e6578-380">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="e6578-381">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="e6578-381">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="e6578-382">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="e6578-382">ShVendorx64</span></span>          | <span data-ttu-id="e6578-383">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="e6578-383">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="e6578-384">MyVendor</span><span class="sxs-lookup"><span data-stu-id="e6578-384">MyVendor</span></span>             | <span data-ttu-id="e6578-385">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="e6578-385">ProgramFilesFolder</span></span>   | <span data-ttu-id="e6578-386">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="e6578-386">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="e6578-387">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="e6578-387">Vendorx64</span></span>            | <span data-ttu-id="e6578-388">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="e6578-388">ProgramFiles64Folder</span></span> | <span data-ttu-id="e6578-389">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="e6578-389">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="e6578-390">ShVendor</span><span class="sxs-lookup"><span data-stu-id="e6578-390">ShVendor</span></span>             | <span data-ttu-id="e6578-391">CommonFilesFolder</span><span class="sxs-lookup"><span data-stu-id="e6578-391">CommonFilesFolder</span></span>    | <span data-ttu-id="e6578-392">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="e6578-392">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="e6578-393">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="e6578-393">ShVendorx64</span></span>          | <span data-ttu-id="e6578-394">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="e6578-394">CommonFiles64Folder</span></span>  | <span data-ttu-id="e6578-395">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="e6578-395">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="e6578-396">Shrx86</span><span class="sxs-lookup"><span data-stu-id="e6578-396">Shrx86</span></span>               | <span data-ttu-id="e6578-397">SHAREDLOCATION</span><span class="sxs-lookup"><span data-stu-id="e6578-397">SHAREDLOCATION</span></span>       | <span data-ttu-id="e6578-398">\|composants x32 32 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-398">x32\|32-bit components</span></span>            |
| <span data-ttu-id="e6578-399">Shrx64</span><span class="sxs-lookup"><span data-stu-id="e6578-399">Shrx64</span></span>               | <span data-ttu-id="e6578-400">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="e6578-400">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="e6578-401">\|composants 64 bits x64</span><span class="sxs-lookup"><span data-stu-id="e6578-401">x64\|64-bit components</span></span>            |
| <span data-ttu-id="e6578-402">Binx86</span><span class="sxs-lookup"><span data-stu-id="e6578-402">Binx86</span></span>               | <span data-ttu-id="e6578-403">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="e6578-403">INSTALLLOCATION</span></span>      | <span data-ttu-id="e6578-404">\|composants x32 32 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-404">x32\|32-bit components</span></span>            |
| <span data-ttu-id="e6578-405">Binx64</span><span class="sxs-lookup"><span data-stu-id="e6578-405">Binx64</span></span>               | <span data-ttu-id="e6578-406">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="e6578-406">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="e6578-407">\|composants 64 bits x64</span><span class="sxs-lookup"><span data-stu-id="e6578-407">x64\|64-bit components</span></span>            |
| <span data-ttu-id="e6578-408">App32</span><span class="sxs-lookup"><span data-stu-id="e6578-408">App32</span></span>                | <span data-ttu-id="e6578-409">Binx86</span><span class="sxs-lookup"><span data-stu-id="e6578-409">Binx86</span></span>               | <span data-ttu-id="e6578-410">MyApp \| -composants 32 bits non partagés</span><span class="sxs-lookup"><span data-stu-id="e6578-410">myapp\|unshared 32-bit components</span></span> |
| <span data-ttu-id="e6578-411">App64</span><span class="sxs-lookup"><span data-stu-id="e6578-411">App64</span></span>                | <span data-ttu-id="e6578-412">Binx64</span><span class="sxs-lookup"><span data-stu-id="e6578-412">Binx64</span></span>               | <span data-ttu-id="e6578-413">MyApp \| -composants 64 bits non partagés</span><span class="sxs-lookup"><span data-stu-id="e6578-413">myapp\|unshared 64-bit components</span></span> |
| <span data-ttu-id="e6578-414">Share32</span><span class="sxs-lookup"><span data-stu-id="e6578-414">Share32</span></span>              | <span data-ttu-id="e6578-415">Shrx86</span><span class="sxs-lookup"><span data-stu-id="e6578-415">Shrx86</span></span>               | <span data-ttu-id="e6578-416">\|composants partagés partagés 32 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-416">shared\|shared 32-bit components</span></span>  |
| <span data-ttu-id="e6578-417">Share64</span><span class="sxs-lookup"><span data-stu-id="e6578-417">Share64</span></span>              | <span data-ttu-id="e6578-418">Shrx64</span><span class="sxs-lookup"><span data-stu-id="e6578-418">Shrx64</span></span>               | <span data-ttu-id="e6578-419">\|composants partagés partagés 64 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-419">shared\|shared 64-bit components</span></span>  |



 

<span data-ttu-id="e6578-420">À la source, cette table de [répertoires](directory-table.md) correspond aux chemins d’accès aux répertoires suivants.</span><span class="sxs-lookup"><span data-stu-id="e6578-420">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="e6578-421">\[SourceDir \] Prog32 \\ msft \\ sample1 \\ x32 \\ MonApp</span><span class="sxs-lookup"><span data-stu-id="e6578-421">\[SourceDir\]Prog32\\Msft\\Sample1\\x32\\myapp</span></span>  
<span data-ttu-id="e6578-422">\[SourceDir \] \\ fichiers communs Share32 \\ msft \\ sample1 \\ x32 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="e6578-422">\[SourceDir\]Share32\\Common Files\\Msft\\Sample1\\x32\\shared</span></span>  
<span data-ttu-id="e6578-423">\[SourceDir \] Prog64 \\ msft \\ sample1 \\ x64 \\ MonApp</span><span class="sxs-lookup"><span data-stu-id="e6578-423">\[SourceDir\]Prog64\\Msft\\Sample1\\x64\\myapp</span></span>  
<span data-ttu-id="e6578-424">\[SourceDir \] \\ fichiers communs Share64 \\ msft \\ sample1 \\ x64 \\ partagé</span><span class="sxs-lookup"><span data-stu-id="e6578-424">\[SourceDir\]Share64\\Common Files\\Msft\\Sample1\\x64\\shared</span></span>  
<span data-ttu-id="e6578-425">\[SourceDir \] sample1</span><span class="sxs-lookup"><span data-stu-id="e6578-425">\[SourceDir\]Sample1</span></span>  
</dl>

<span data-ttu-id="e6578-426">Au niveau de la cible, cette table de [répertoires](directory-table.md) correspond aux chemins d’accès aux répertoires suivants.</span><span class="sxs-lookup"><span data-stu-id="e6578-426">At the target, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span> <span data-ttu-id="e6578-427">Les chemins d’accès cibles dépendent du contexte et du système d' [installation](installation-context.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-427">The target paths depend on the [installation context](installation-context.md) and system.</span></span>

| <span data-ttu-id="e6578-428">Contexte d’installation</span><span class="sxs-lookup"><span data-stu-id="e6578-428">Installation Context</span></span> | <span data-ttu-id="e6578-429">Système</span><span class="sxs-lookup"><span data-stu-id="e6578-429">System</span></span>                                                                              | <span data-ttu-id="e6578-430">Exemples de chemins</span><span class="sxs-lookup"><span data-stu-id="e6578-430">Example Paths</span></span>                                                                                                                                                                                                                                                                                                                                         |
|----------------------|-------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e6578-431">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="e6578-431">Per-Machine</span></span>          | <span data-ttu-id="e6578-432">Windows Server 2008 R2 et Windows 7</span><span class="sxs-lookup"><span data-stu-id="e6578-432">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="e6578-433">version 32 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-433">32-bit version</span></span><br/>           | <span data-ttu-id="e6578-434">% ProgramFiles% \\ msft \\ sample1 \\ x32 \\ MonApp</span><span class="sxs-lookup"><span data-stu-id="e6578-434">%ProgramFiles%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="e6578-435">% ProgramFiles% \\ fichiers communs \\ msft \\ sample1 \\ x32 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="e6578-435">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="e6578-436">% ProgramFiles (x86)% \\ msft \\ sample1 \\ x64 \\</span><span class="sxs-lookup"><span data-stu-id="e6578-436">%ProgramFiles(x86)%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="e6578-437">% ProgramFiles (x86)% \\ fichiers communs \\ msft \\ sample1 \\ x64 \\ partagés</span><span class="sxs-lookup"><span data-stu-id="e6578-437">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="e6578-438">% ProgramData% \\ des \\ programmes du menu Démarrer de Microsoft Windows \\ \\ \\ sample1</span><span class="sxs-lookup"><span data-stu-id="e6578-438">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="e6578-439">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="e6578-439">Per-Machine</span></span>          | <span data-ttu-id="e6578-440">Windows Server 2008 R2 et Windows 7</span><span class="sxs-lookup"><span data-stu-id="e6578-440">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="e6578-441">version 64 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-441">64-bit version</span></span><br/>           | <span data-ttu-id="e6578-442">% ProgramFiles (x86)% \\ msft \\ sample1 \\ x32 \\ MonApp</span><span class="sxs-lookup"><span data-stu-id="e6578-442">%ProgramFiles(x86)%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="e6578-443">% ProgramFiles (x86)% \\ fichiers communs \\ msft \\ sample1 \\ x32 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="e6578-443">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="e6578-444">% ProgramFiles% \\ msft \\ sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="e6578-444">%ProgramFiles%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="e6578-445">% ProgramFiles% \\ fichiers communs \\ msft \\ sample1 \\ x64 \\ partagé</span><span class="sxs-lookup"><span data-stu-id="e6578-445">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="e6578-446">% ProgramData% \\ des \\ programmes du menu Démarrer de Microsoft Windows \\ \\ \\ sample1</span><span class="sxs-lookup"><span data-stu-id="e6578-446">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="e6578-447">Per-User</span><span class="sxs-lookup"><span data-stu-id="e6578-447">Per-User</span></span>             | <span data-ttu-id="e6578-448">Windows Server 2008 R2 et Windows 7</span><span class="sxs-lookup"><span data-stu-id="e6578-448">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="e6578-449">version 32 bits ou 64 bits</span><span class="sxs-lookup"><span data-stu-id="e6578-449">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="e6578-450">% LOCALAPPDATA% \\ Programs \\ msft \\ sample1 \\ x32 \\ MonApp</span><span class="sxs-lookup"><span data-stu-id="e6578-450">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="e6578-451">% LOCALAPPDATA% \\ Programs \\ Common \\ msft \\ sample1 \\ x32 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="e6578-451">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="e6578-452">% LOCALAPPDATA% \\ Programs \\ msft \\ sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="e6578-452">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="e6578-453">% LOCALAPPDATA% \\ Programs \\ Common \\ msft \\ sample1 \\ x64 \\ Shared</span><span class="sxs-lookup"><span data-stu-id="e6578-453">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="e6578-454">% APPDATA% \\ des \\ programmes du menu Démarrer de Microsoft Windows \\ \\ \\ sample1</span><span class="sxs-lookup"><span data-stu-id="e6578-454">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/> |



 

## <a name="application-registration"></a><span data-ttu-id="e6578-455">Inscription de l’application</span><span class="sxs-lookup"><span data-stu-id="e6578-455">Application Registration</span></span>

<span data-ttu-id="e6578-456">L' PUASample.msi ajoute une sous-clé à la clé de Registre App Paths pour l’application et effectue des inscriptions qui permettent d’enregistrer les informations de l’application dans le Registre sous cette clé.</span><span class="sxs-lookup"><span data-stu-id="e6578-456">The PUASample.msi adds a subkey to the App Paths registry key for the application and performs registrations that enable application information to be saved in the registry under this key.</span></span> <span data-ttu-id="e6578-457">Pour plus d’informations sur les chemins d’accès des applications et l’inscription des applications, consultez [PerceivedTypes, SystemFileAssociations et inscription des applications](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) dans la section extensibilité de l' [interpréteur](https://msdn.microsoft.com/library/bb762762.aspx) de commandes dans le [Guide du développeur de l’interpréteur](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85))de commandes.</span><span class="sxs-lookup"><span data-stu-id="e6578-457">For more information about App Paths and application registration, see the [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="e6578-458">Au moment de l’installation, l’utilisateur prend la décision d’installer l’application dans le contexte d’installation par utilisateur ou par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e6578-458">At installation time, the user makes the decision to install the application in either the per-user or per-machine installation context.</span></span> <span data-ttu-id="e6578-459">Au moment de la création du package à double usage, le développeur du package ne peut pas savoir si les inscriptions doivent être effectuées sous la \_ clé HKEY local \_ machine ou HKEY \_ Current \_ User.</span><span class="sxs-lookup"><span data-stu-id="e6578-459">At the time the dual-purpose package is authored, the package developer cannot know if the registrations should be performed under the HKEY\_LOCAL\_MACHINE or HKEY\_CURRENT\_USER keys.</span></span>

<span data-ttu-id="e6578-460">Le développeur du package définit l’identificateur de fichier du fichier exécutable de l’application dans le champ fichier de la table de [fichiers](file-table.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-460">The package developer defines the file identifier for the application's executable file in the File field of the [File](file-table.md) Table.</span></span>

<span data-ttu-id="e6578-461">[Fichier](file-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-461">[File](file-table.md) Table (partial)</span></span> 

| <span data-ttu-id="e6578-462">Fichier</span><span class="sxs-lookup"><span data-stu-id="e6578-462">File</span></span>      | <span data-ttu-id="e6578-463">-\_</span><span class="sxs-lookup"><span data-stu-id="e6578-463">Component\_</span></span>      | <span data-ttu-id="e6578-464">FileName</span><span class="sxs-lookup"><span data-stu-id="e6578-464">FileName</span></span>                     | <span data-ttu-id="e6578-465">FileSize</span><span class="sxs-lookup"><span data-stu-id="e6578-465">FileSize</span></span> | <span data-ttu-id="e6578-466">Version</span><span class="sxs-lookup"><span data-stu-id="e6578-466">Version</span></span> | <span data-ttu-id="e6578-467">Language</span><span class="sxs-lookup"><span data-stu-id="e6578-467">Language</span></span> | <span data-ttu-id="e6578-468">Attributs</span><span class="sxs-lookup"><span data-stu-id="e6578-468">Attributes</span></span> | <span data-ttu-id="e6578-469">Séquence</span><span class="sxs-lookup"><span data-stu-id="e6578-469">Sequence</span></span> |
|-----------|------------------|------------------------------|----------|---------|----------|------------|----------|
| <span data-ttu-id="e6578-470">MyAppFile</span><span class="sxs-lookup"><span data-stu-id="e6578-470">MyAppFile</span></span> | <span data-ttu-id="e6578-471">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-471">ProductComponent</span></span> | <span data-ttu-id="e6578-472">PUASAMP1.EXE\|PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="e6578-472">PUASAMP1.EXE\|PUASample1.exe</span></span> | <span data-ttu-id="e6578-473">81920</span><span class="sxs-lookup"><span data-stu-id="e6578-473">81920</span></span>    |         |          | <span data-ttu-id="e6578-474">0</span><span class="sxs-lookup"><span data-stu-id="e6578-474">0</span></span>          | <span data-ttu-id="e6578-475">1</span><span class="sxs-lookup"><span data-stu-id="e6578-475">1</span></span>        |



 

<span data-ttu-id="e6578-476">Les valeurs à enregistrer dans le registre peuvent être spécifiées dans le champ de valeur de la table [du Registre](registry-table.md) sous forme de chaîne [mise en forme](formatted.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-476">Values to be saved in the registry can be specified in the Value field of the [Registry](registry-table.md) table as a [Formatted](formatted.md) string.</span></span> <span data-ttu-id="e6578-477">Utilisez l’identificateur de fichier défini dans le champ fichier de la table [file](file-table.md) et la \[ \# convention *filekey* \] du type mis en forme pour spécifier la valeur par défaut de la clé de Registre Paths de l’application.</span><span class="sxs-lookup"><span data-stu-id="e6578-477">Use the file identifier defined in the File field of the [File](file-table.md) table, and the \[\#*filekey*\] convention of the Formatted type, to specify the default value for the App Paths registry key.</span></span> <span data-ttu-id="e6578-478">L’action d' [installation](install-action.md) de niveau supérieur effectue les actions dans la table [InstallExecuteSequence](installexecutesequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-478">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table.</span></span> <span data-ttu-id="e6578-479">Une fois les actions [CostInitialize](costinitialize-action.md), [FileCost](filecost-action.md)et [InstallFinalize](installfinalize-action.md) effectuées dans ce tableau, la Windows Installer remplace la sous-chaîne mise en forme \[ \# MyAppFile \] dans la table du Registre par le chemin d’accès complet au fichier d’application.</span><span class="sxs-lookup"><span data-stu-id="e6578-479">After the [CostInitialize](costinitialize-action.md), [FileCost](filecost-action.md), and [InstallFinalize](installfinalize-action.md) actions in this table have completed, the Windows Installer replaces the formatted substring \[\#MyAppFile\] in the Registry table with the full path to the application file.</span></span>

<span data-ttu-id="e6578-480">L’exemple définit une propriété personnalisée, RegRoot, pour contenir l’emplacement de la clé racine et utilise une action personnalisée pour réinitialiser la valeur de la propriété si l’utilisateur choisit une installation par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e6578-480">The sample defines a custom property, RegRoot, to contain the location of the root key and uses a custom action to reset the property value if the user chooses a per-machine installation.</span></span> <span data-ttu-id="e6578-481">Utilisez la propriété personnalisée, RegRoot, dans toutes les valeurs de chaîne mises en forme qui référencent l’emplacement racine.</span><span class="sxs-lookup"><span data-stu-id="e6578-481">Use the custom property, RegRoot, in any formatted string values that reference the root location.</span></span> <span data-ttu-id="e6578-482">Dans la table des [Propriétés](property-table.md) , le package PUASample.msi définit la propriété personnalisée et définit la valeur de REGROOT sur HKCU.</span><span class="sxs-lookup"><span data-stu-id="e6578-482">In the [Property](property-table.md) table the PUASample.msi package defines the custom property and sets the value of RegRoot to HKCU.</span></span> <span data-ttu-id="e6578-483">Cela initialise la valeur de la propriété pour le contexte d’installation par utilisateur, le contexte par défaut recommandé pour les packages à double usage.</span><span class="sxs-lookup"><span data-stu-id="e6578-483">This initializes the value of the property for the per-user installation context, the recommended default context for dual-purpose packages.</span></span>

<span data-ttu-id="e6578-484">[Propriété](property-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-484">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="e6578-485">Propriété</span><span class="sxs-lookup"><span data-stu-id="e6578-485">Property</span></span> | <span data-ttu-id="e6578-486">Valeur</span><span class="sxs-lookup"><span data-stu-id="e6578-486">Value</span></span> |
|----------|-------|
| <span data-ttu-id="e6578-487">RegRoot</span><span class="sxs-lookup"><span data-stu-id="e6578-487">RegRoot</span></span>  | <span data-ttu-id="e6578-488">HKCU</span><span class="sxs-lookup"><span data-stu-id="e6578-488">HKCU</span></span>  |



 

<span data-ttu-id="e6578-489">Dans la table [CustomAction](customaction-table.md) , le package définit une action personnalisée nommée Set \_ RegRoot \_ HKLM.</span><span class="sxs-lookup"><span data-stu-id="e6578-489">In the [CustomAction](customaction-table.md) table the package defines a custom action named Set\_RegRoot\_HKLM.</span></span> <span data-ttu-id="e6578-490">La valeur dans le champ type identifie cela comme une action personnalisée [51 de type action](custom-action-type-51.md) personnalisée standard.</span><span class="sxs-lookup"><span data-stu-id="e6578-490">The value in the Type field identifies this as a [Custom Action Type 51](custom-action-type-51.md) standard custom action.</span></span> <span data-ttu-id="e6578-491">La signification des champs source et cible dans la table CustomAction dépend du type d’action personnalisé.</span><span class="sxs-lookup"><span data-stu-id="e6578-491">The meaning of the Source and Target fields in the CustomAction table depend upon the custom action type.</span></span> <span data-ttu-id="e6578-492">Pour plus d’informations sur les types standard d’actions personnalisées, consultez types d’actions [personnalisées](summary-list-of-all-custom-action-types.md).</span><span class="sxs-lookup"><span data-stu-id="e6578-492">For more information about the standard types of custom actions, see [Custom Action Types](summary-list-of-all-custom-action-types.md).</span></span> <span data-ttu-id="e6578-493">Le champ source de l' \_ \_ action personnalisée HKLM Set RegRoot spécifie que la valeur de la propriété RegRoot.</span><span class="sxs-lookup"><span data-stu-id="e6578-493">The Source field for the Set\_RegRoot\_HKLM custom action specifies that the value of the RegRoot property.</span></span> <span data-ttu-id="e6578-494">Si le programme d’installation effectue \_ l' \_ action personnalisée de définition de RegRoot HKLM, cette opération réinitialise la valeur de la propriété REGROOT à HKLM.</span><span class="sxs-lookup"><span data-stu-id="e6578-494">If the installer performs the Set\_RegRoot\_HKLM custom action, this resets the value of the RegRoot property to HKLM.</span></span>

<span data-ttu-id="e6578-495">[CustomAction](customaction-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-495">[CustomAction](customaction-table.md) Table (partial)</span></span>

| <span data-ttu-id="e6578-496">Action</span><span class="sxs-lookup"><span data-stu-id="e6578-496">Action</span></span>             | <span data-ttu-id="e6578-497">Type</span><span class="sxs-lookup"><span data-stu-id="e6578-497">Type</span></span> | <span data-ttu-id="e6578-498">Source</span><span class="sxs-lookup"><span data-stu-id="e6578-498">Source</span></span>      | <span data-ttu-id="e6578-499">Cible</span><span class="sxs-lookup"><span data-stu-id="e6578-499">Target</span></span> |
|--------------------|------|-------------|--------|
| <span data-ttu-id="e6578-500">Définir \_ RegRoot \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="e6578-500">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="e6578-501">51</span><span class="sxs-lookup"><span data-stu-id="e6578-501">51</span></span>   | <span data-ttu-id="e6578-502">\[RegRoot\]</span><span class="sxs-lookup"><span data-stu-id="e6578-502">\[RegRoot\]</span></span> | <span data-ttu-id="e6578-503">HKLM</span><span class="sxs-lookup"><span data-stu-id="e6578-503">HKLM</span></span>   |



 

<span data-ttu-id="e6578-504">L’action d' [installation](install-action.md) de niveau supérieur effectue les actions dans la table [InstallExecuteSequence](installexecutesequence-table.md) , dans la séquence spécifiée dans le champ séquence de cette table.</span><span class="sxs-lookup"><span data-stu-id="e6578-504">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table, in the sequence specified in the Sequence field of that table.</span></span> <span data-ttu-id="e6578-505">La valeur créée dans le champ séquence pour l' \_ \_ action personnalisée RegRoot HKLM (1501) spécifie que cette action personnalisée doit être exécutée après l’action [InstallInitialize](installinitialize-action.md) (1500) et avant l’action [ProcessComponents](processcomponents-action.md) (1600.) Cette séquence garantit que l’enregistrement de l' \_ \_ action personnalisée HKLM Set RegRoot est évalué au moment de l’installation.</span><span class="sxs-lookup"><span data-stu-id="e6578-505">The value authored in the Sequence field for the Set\_RegRoot\_HKLM custom action (1501) specifies that this custom action be performed after the [InstallInitialize](installinitialize-action.md) action (1500) and before the [ProcessComponents](processcomponents-action.md) action (1600.) This sequence ensures that the record for the Set\_RegRoot\_HKLM custom action is evaluated at installation time.</span></span> <span data-ttu-id="e6578-506">Pour plus d’informations sur la séquence d’actions recommandée dans la table InstallExecuteSequence, consultez la rubrique [InstallExecuteSequence suggérée](suggested-installexecutesequence.md) .</span><span class="sxs-lookup"><span data-stu-id="e6578-506">For more information about the recommended sequence of actions in the InstallExecuteSequence table, see the [Suggested InstallExecuteSequence](suggested-installexecutesequence.md) topic.</span></span> <span data-ttu-id="e6578-507">La [syntaxe d’instruction conditionnelle](conditional-statement-syntax.md) créée dans le champ condition spécifie que l' \_ \_ action HKLM Set RegRoot doit être exécutée uniquement si la valeur de la propriété [**ALLUSERS**](allusers.md) est égale à 1 au moment de l’installation.</span><span class="sxs-lookup"><span data-stu-id="e6578-507">The [conditional statement syntax](conditional-statement-syntax.md) authored in the Condition field specifies that the Set\_RegRoot\_HKLM action be performed only if the value of the [**ALLUSERS**](allusers.md) property evaluates to 1 at installation time.</span></span> <span data-ttu-id="e6578-508">Une valeur de propriété **ALLUSERS** de 1 spécifie une installation par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e6578-508">An **ALLUSERS** property value of 1 specifies a per-machine installation.</span></span>

<span data-ttu-id="e6578-509">[InstallExecuteSequence](installexecutesequence-table.md) Table (partielle)</span><span class="sxs-lookup"><span data-stu-id="e6578-509">[InstallExecuteSequence](installexecutesequence-table.md) Table (partial)</span></span>

| <span data-ttu-id="e6578-510">Action</span><span class="sxs-lookup"><span data-stu-id="e6578-510">Action</span></span>             | <span data-ttu-id="e6578-511">Condition</span><span class="sxs-lookup"><span data-stu-id="e6578-511">Condition</span></span>  | <span data-ttu-id="e6578-512">Séquence</span><span class="sxs-lookup"><span data-stu-id="e6578-512">Sequence</span></span> |
|--------------------|------------|----------|
| <span data-ttu-id="e6578-513">Définir \_ RegRoot \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="e6578-513">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="e6578-514">ALLUSERS = 1</span><span class="sxs-lookup"><span data-stu-id="e6578-514">ALLUSERS=1</span></span> | <span data-ttu-id="e6578-515">1501</span><span class="sxs-lookup"><span data-stu-id="e6578-515">1501</span></span>     |



 

<span data-ttu-id="e6578-516">Les enregistrements suivants dans la table [du Registre](registry-table.md) effectuent les inscriptions si le composant ProductComponent est installé.</span><span class="sxs-lookup"><span data-stu-id="e6578-516">The following records in the [Registry](registry-table.md) table perform the registrations if the ProductComponent component is installed.</span></span> <span data-ttu-id="e6578-517">La valeur-1 dans le champ racine est requise pour effectuer l’inscription sous HKEY \_ local \_ machine pour une installation par utilisateur et sous HKEY \_ Current \_ User pour une installation par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e6578-517">The value -1 in the Root field is required to perform the registration under HKEY\_LOCAL\_MACHINE for a per-user installation and under HKEY\_CURRENT\_USER for a per-user installation.</span></span> <span data-ttu-id="e6578-518">L’enregistrement avec une chaîne vide dans le champ Registry ajoute une sous-clé pour l’application sous la clé de Registre chemins et définit la valeur « (par défaut) » sur le chemin d’accès complet du fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="e6578-518">The record with an empty string in the Registry field adds a subkey for the application under the AppPaths registry key and sets the "(Default)" value to the full path of the application's executable file.</span></span> <span data-ttu-id="e6578-519">L’inscription MyAppPathAlias mappe le fichier exécutable à un alias d’application et permet à l’application d’être lancée si l’utilisateur tape l’alias « puapct » à l’invite de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="e6578-519">The MyAppPathAlias registration maps the executable file to an application alias and enables the application to be launched if the user types the alias "puapct" at a command line prompt.</span></span> <span data-ttu-id="e6578-520">L’inscription MyAppPathRegistration mappe le nom du fichier exécutable sur le chemin d’accès complet du fichier.</span><span class="sxs-lookup"><span data-stu-id="e6578-520">The MyAppPathRegistration registration maps the name of the executable file to the file's full path.</span></span>



| <span data-ttu-id="e6578-521">Registre</span><span class="sxs-lookup"><span data-stu-id="e6578-521">Registry</span></span>              | <span data-ttu-id="e6578-522">Root</span><span class="sxs-lookup"><span data-stu-id="e6578-522">Root</span></span> | <span data-ttu-id="e6578-523">Clé</span><span class="sxs-lookup"><span data-stu-id="e6578-523">Key</span></span>                                                                     | <span data-ttu-id="e6578-524">Nom</span><span class="sxs-lookup"><span data-stu-id="e6578-524">Name</span></span> | <span data-ttu-id="e6578-525">Valeur</span><span class="sxs-lookup"><span data-stu-id="e6578-525">Value</span></span>                                                                            | <span data-ttu-id="e6578-526">Composant</span><span class="sxs-lookup"><span data-stu-id="e6578-526">Component</span></span>        |
|-----------------------|------|-------------------------------------------------------------------------|------|----------------------------------------------------------------------------------|------------------|
|                       | <span data-ttu-id="e6578-527">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-527">-1</span></span>   | <span data-ttu-id="e6578-528">Logiciel \\ Microsoft \\ MyAppPathRegistrationLocation</span><span class="sxs-lookup"><span data-stu-id="e6578-528">Software\\Microsoft\\MyAppPathRegistrationLocation</span></span>                      |      | <span data-ttu-id="e6578-529">\[RegRoot \] \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ path \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="e6578-529">\[RegRoot\]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span> | <span data-ttu-id="e6578-530">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-530">ProductComponent</span></span> |
| <span data-ttu-id="e6578-531">MyAppPathAlias</span><span class="sxs-lookup"><span data-stu-id="e6578-531">MyAppPathAlias</span></span>        | <span data-ttu-id="e6578-532">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-532">-1</span></span>   | <span data-ttu-id="e6578-533">Logiciel \\ Microsoft \\ Windows \\ CurrentVersion \\ path \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="e6578-533">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span>     |      | <span data-ttu-id="e6578-534">\[\#MyAppFile\]</span><span class="sxs-lookup"><span data-stu-id="e6578-534">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="e6578-535">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-535">ProductComponent</span></span> |
| <span data-ttu-id="e6578-536">MyAppPathRegistration</span><span class="sxs-lookup"><span data-stu-id="e6578-536">MyAppPathRegistration</span></span> | <span data-ttu-id="e6578-537">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-537">-1</span></span>   | <span data-ttu-id="e6578-538">Logiciel \\ Microsoft \\ Windows \\ CurrentVersion \\ path \\PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="e6578-538">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUASample1.exe</span></span> |      | <span data-ttu-id="e6578-539">\[\#MyAppFile\]</span><span class="sxs-lookup"><span data-stu-id="e6578-539">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="e6578-540">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-540">ProductComponent</span></span> |



 

## <a name="autoplay-cancel-registration"></a><span data-ttu-id="e6578-541">Annulation de l’inscription automatique</span><span class="sxs-lookup"><span data-stu-id="e6578-541">AutoPlay Cancel Registration</span></span>

<span data-ttu-id="e6578-542">L' PUASample.msi effectue des inscriptions qui permettent à l’utilisateur de l’application d’empêcher le lancement de l' [exécution automatique du matériel](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) pour les appareils sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="e6578-542">The PUASample.msi performs registrations that enable the application user to prevent [Hardware Autoplay](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) from launching for selected devices.</span></span> <span data-ttu-id="e6578-543">Pour plus d’informations sur l’inscription d’un gestionnaire pour annuler l’exécution automatique en réponse à un événement, consultez la rubrique [préparation du matériel et des logiciels à utiliser avec l’exécution automatique](/previous-versions//cc144208(v=vs.85)) dans la section extensibilité de l' [interpréteur](https://msdn.microsoft.com/library/bb762762.aspx) de commandes dans le [Guide du développeur de l’interpréteur](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85))de commandes.</span><span class="sxs-lookup"><span data-stu-id="e6578-543">For information about registering a handler to cancel Autoplay in response to an event, see the [Preparing Hardware and Software for Use with AutoPlay](/previous-versions//cc144208(v=vs.85)) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="e6578-544">L’enregistrement suivant inscrit le gestionnaire spécifié dans le champ nom lorsque le composant ProductComponent est installé.</span><span class="sxs-lookup"><span data-stu-id="e6578-544">The following record registers the handler specified in the Name field when the ProductComponent component is installed.</span></span> <span data-ttu-id="e6578-545">La valeur-1 dans le champ racine est obligatoire pour spécifier l’Windows Installer que l’inscription doit être redirigée vers un emplacement qui dépend du contexte d’installation.</span><span class="sxs-lookup"><span data-stu-id="e6578-545">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="e6578-546">[Registre](registry-table.md) Tableau</span><span class="sxs-lookup"><span data-stu-id="e6578-546">[Registry](registry-table.md) Table</span></span> 

| <span data-ttu-id="e6578-547">Registre</span><span class="sxs-lookup"><span data-stu-id="e6578-547">Registry</span></span>                     | <span data-ttu-id="e6578-548">Root</span><span class="sxs-lookup"><span data-stu-id="e6578-548">Root</span></span> | <span data-ttu-id="e6578-549">Clé</span><span class="sxs-lookup"><span data-stu-id="e6578-549">Key</span></span>                                                                                             | <span data-ttu-id="e6578-550">Nom</span><span class="sxs-lookup"><span data-stu-id="e6578-550">Name</span></span>                                 | <span data-ttu-id="e6578-551">Valeur</span><span class="sxs-lookup"><span data-stu-id="e6578-551">Value</span></span> | <span data-ttu-id="e6578-552">Composant</span><span class="sxs-lookup"><span data-stu-id="e6578-552">Component</span></span>        |
|------------------------------|------|-------------------------------------------------------------------------------------------------|--------------------------------------|-------|------------------|
| <span data-ttu-id="e6578-553">MyAutoplayCancelRegistration</span><span class="sxs-lookup"><span data-stu-id="e6578-553">MyAutoplayCancelRegistration</span></span> | <span data-ttu-id="e6578-554">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-554">-1</span></span>   | <span data-ttu-id="e6578-555">LOGICIEL \\ Microsoft \\ Windows \\ CurrentVersion \\ Explorer \\ AutoplayHandlers \\ cancelautoplay \\ CLSID</span><span class="sxs-lookup"><span data-stu-id="e6578-555">SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\AutoplayHandlers\\CancelAutoplay\\CLSID</span></span> | <span data-ttu-id="e6578-556">66A32FE6-229D-427b-A608-D273F40C034C</span><span class="sxs-lookup"><span data-stu-id="e6578-556">66A32FE6-229D-427b-A608-D273F40C034C</span></span> |       | <span data-ttu-id="e6578-557">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-557">ProductComponent</span></span> |



 

## <a name="preview-handler-registration"></a><span data-ttu-id="e6578-558">Aperçu du gestionnaire d’aperçus</span><span class="sxs-lookup"><span data-stu-id="e6578-558">Preview Handler Registration</span></span>

<span data-ttu-id="e6578-559">L' PUASample.msi effectue les inscriptions nécessaires à l’installation d’un [Gestionnaire d’aperçus](../shell/preview-handlers.md) qui permet une version d’évaluation en lecture seule des fichiers. PUA sans lancer l’application.</span><span class="sxs-lookup"><span data-stu-id="e6578-559">The PUASample.msi performs registrations that are required to install a [preview handler](../shell/preview-handlers.md) that enables a read-only preview of .pua files without launching the application.</span></span> <span data-ttu-id="e6578-560">Pour plus d’informations sur l’inscription des gestionnaires d’aperçus, consultez la rubrique [inscription des gestionnaires d’aperçus](../shell/how-to-register-a-preview-handler.md) dans la section extensibilité de l' [interpréteur](https://msdn.microsoft.com/library/bb762762.aspx) de commandes dans le Guide du développeur de l' [interpréteur](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85))de commandes.</span><span class="sxs-lookup"><span data-stu-id="e6578-560">For information about registering preview handlers, see the [Registering Preview Handlers](../shell/how-to-register-a-preview-handler.md) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="e6578-561">Les enregistrements suivants de la table [du Registre](registry-table.md) inscrivent le gestionnaire lors de l’installation du composant ProductComponent.</span><span class="sxs-lookup"><span data-stu-id="e6578-561">The following records in the [Registry](registry-table.md) table register the handler when the ProductComponent component is installed.</span></span> <span data-ttu-id="e6578-562">La valeur-1 dans le champ racine est obligatoire pour spécifier l’Windows Installer que l’inscription doit être redirigée vers un emplacement qui dépend du contexte d’installation.</span><span class="sxs-lookup"><span data-stu-id="e6578-562">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="e6578-563">[Registre](registry-table.md) Tableau</span><span class="sxs-lookup"><span data-stu-id="e6578-563">[Registry](registry-table.md) Table</span></span>

| <span data-ttu-id="e6578-564">Registre</span><span class="sxs-lookup"><span data-stu-id="e6578-564">Registry</span></span>                       | <span data-ttu-id="e6578-565">Root</span><span class="sxs-lookup"><span data-stu-id="e6578-565">Root</span></span> | <span data-ttu-id="e6578-566">Clé</span><span class="sxs-lookup"><span data-stu-id="e6578-566">Key</span></span>                                                                              | <span data-ttu-id="e6578-567">Nom</span><span class="sxs-lookup"><span data-stu-id="e6578-567">Name</span></span>                                   | <span data-ttu-id="e6578-568">Valeur</span><span class="sxs-lookup"><span data-stu-id="e6578-568">Value</span></span>                                        | <span data-ttu-id="e6578-569">Composant</span><span class="sxs-lookup"><span data-stu-id="e6578-569">Component</span></span>        |
|--------------------------------|------|----------------------------------------------------------------------------------|----------------------------------------|----------------------------------------------|------------------|
| <span data-ttu-id="e6578-570">MyPreviewHandlerRegistration1</span><span class="sxs-lookup"><span data-stu-id="e6578-570">MyPreviewHandlerRegistration1</span></span>  | <span data-ttu-id="e6578-571">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-571">-1</span></span>   | <span data-ttu-id="e6578-572">Classes de logiciels \\ \\ . PUA</span><span class="sxs-lookup"><span data-stu-id="e6578-572">Software\\Classes\\.pua</span></span>                                                          |                                        | <span data-ttu-id="e6578-573">puafile</span><span class="sxs-lookup"><span data-stu-id="e6578-573">puafile</span></span>                                      | <span data-ttu-id="e6578-574">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-574">ProductComponent</span></span> |
| <span data-ttu-id="e6578-575">MyPreviewHandlerRegistration2</span><span class="sxs-lookup"><span data-stu-id="e6578-575">MyPreviewHandlerRegistration2</span></span>  | <span data-ttu-id="e6578-576">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-576">-1</span></span>   | <span data-ttu-id="e6578-577">Logiciel \\ Microsoft \\ Windows \\ CurrentVersion \\ PreviewHandlers</span><span class="sxs-lookup"><span data-stu-id="e6578-577">Software\\Microsoft\\Windows\\CurrentVersion\\PreviewHandlers</span></span>                    | <span data-ttu-id="e6578-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="e6578-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span> | <span data-ttu-id="e6578-579">Gestionnaire d’aperçus de TEST Microsoft Windows PUA</span><span class="sxs-lookup"><span data-stu-id="e6578-579">Microsoft Windows PUA TEST Preview Handler</span></span>   | <span data-ttu-id="e6578-580">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-580">ProductComponent</span></span> |
| <span data-ttu-id="e6578-581">MyPreviewHandlerRegistration3</span><span class="sxs-lookup"><span data-stu-id="e6578-581">MyPreviewHandlerRegistration3</span></span>  | <span data-ttu-id="e6578-582">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-582">-1</span></span>   | <span data-ttu-id="e6578-583">Classes de logiciels \\ \\ puafile \\ shellex \\ {8895b1c6-B41F-4c1c-A562-0d564250836f}</span><span class="sxs-lookup"><span data-stu-id="e6578-583">Software\\Classes\\puafile\\ShellEx\\{8895b1c6-b41f-4c1c-a562-0d564250836f}</span></span>      |                                        | <span data-ttu-id="e6578-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="e6578-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>       | <span data-ttu-id="e6578-585">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-585">ProductComponent</span></span> |
| <span data-ttu-id="e6578-586">MyPreviewHandlerRegistration4</span><span class="sxs-lookup"><span data-stu-id="e6578-586">MyPreviewHandlerRegistration4</span></span>  | <span data-ttu-id="e6578-587">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-587">-1</span></span>   | <span data-ttu-id="e6578-588">Classes de logiciels \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="e6578-588">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 |                                        | <span data-ttu-id="e6578-589">Per-User exemple de gestionnaire d’aperçus application 1</span><span class="sxs-lookup"><span data-stu-id="e6578-589">Per-User Applicaton Sample 1 Preview Handler</span></span> | <span data-ttu-id="e6578-590">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-590">ProductComponent</span></span> |
| <span data-ttu-id="e6578-591">MyPreviewHandlerRegistration5</span><span class="sxs-lookup"><span data-stu-id="e6578-591">MyPreviewHandlerRegistration5</span></span>  | <span data-ttu-id="e6578-592">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-592">-1</span></span>   | <span data-ttu-id="e6578-593">Classes de logiciels \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="e6578-593">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="e6578-594">AppID</span><span class="sxs-lookup"><span data-stu-id="e6578-594">AppID</span></span>                                  | <span data-ttu-id="e6578-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span><span class="sxs-lookup"><span data-stu-id="e6578-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span></span>       | <span data-ttu-id="e6578-596">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-596">ProductComponent</span></span> |
| <span data-ttu-id="e6578-597">MyPreviewHandlerRegistration6</span><span class="sxs-lookup"><span data-stu-id="e6578-597">MyPreviewHandlerRegistration6</span></span>  | <span data-ttu-id="e6578-598">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-598">-1</span></span>   | <span data-ttu-id="e6578-599">Classes de logiciels \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="e6578-599">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="e6578-600">DisplayName</span><span class="sxs-lookup"><span data-stu-id="e6578-600">DisplayName</span></span>                            | <span data-ttu-id="e6578-601">@shell32,-38242</span><span class="sxs-lookup"><span data-stu-id="e6578-601">@shell32,-38242</span></span>                              | <span data-ttu-id="e6578-602">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-602">ProductComponent</span></span> |
| <span data-ttu-id="e6578-603">MyPreviewHandlerRegistration7</span><span class="sxs-lookup"><span data-stu-id="e6578-603">MyPreviewHandlerRegistration7</span></span>  | <span data-ttu-id="e6578-604">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-604">-1</span></span>   | <span data-ttu-id="e6578-605">Classes de logiciels \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="e6578-605">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="e6578-606">Icône</span><span class="sxs-lookup"><span data-stu-id="e6578-606">Icon</span></span>                                   | <span data-ttu-id="e6578-607">notepad.exe, 2</span><span class="sxs-lookup"><span data-stu-id="e6578-607">notepad.exe,2</span></span>                                | <span data-ttu-id="e6578-608">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-608">ProductComponent</span></span> |
| <span data-ttu-id="e6578-609">MyPreviewHandlerRegistration8</span><span class="sxs-lookup"><span data-stu-id="e6578-609">MyPreviewHandlerRegistration8</span></span>  | <span data-ttu-id="e6578-610">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-610">-1</span></span>   | <span data-ttu-id="e6578-611">Classes de logiciels \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="e6578-611">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="e6578-612">ThreadingModel</span><span class="sxs-lookup"><span data-stu-id="e6578-612">ThreadingModel</span></span>                         | <span data-ttu-id="e6578-613">STA</span><span class="sxs-lookup"><span data-stu-id="e6578-613">Apartment</span></span>                                    | <span data-ttu-id="e6578-614">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-614">ProductComponent</span></span> |
| <span data-ttu-id="e6578-615">MyPreviewHandlerRegistration9</span><span class="sxs-lookup"><span data-stu-id="e6578-615">MyPreviewHandlerRegistration9</span></span>  | <span data-ttu-id="e6578-616">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-616">-1</span></span>   | <span data-ttu-id="e6578-617">Classes de logiciels \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="e6578-617">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> |                                        | <span data-ttu-id="e6578-618">\#%% SystemRoot% \\ system32 \\shell32.dll</span><span class="sxs-lookup"><span data-stu-id="e6578-618">\#%%SystemRoot%\\system32\\shell32.dll</span></span>       | <span data-ttu-id="e6578-619">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-619">ProductComponent</span></span> |
| <span data-ttu-id="e6578-620">MyPreviewHandlerRegistration10</span><span class="sxs-lookup"><span data-stu-id="e6578-620">MyPreviewHandlerRegistration10</span></span> | <span data-ttu-id="e6578-621">-1</span><span class="sxs-lookup"><span data-stu-id="e6578-621">-1</span></span>   | <span data-ttu-id="e6578-622">Classes de logiciels \\ \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="e6578-622">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="e6578-623">ProgID</span><span class="sxs-lookup"><span data-stu-id="e6578-623">ProgID</span></span>                                 | <span data-ttu-id="e6578-624">puafile</span><span class="sxs-lookup"><span data-stu-id="e6578-624">puafile</span></span>                                      | <span data-ttu-id="e6578-625">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="e6578-625">ProductComponent</span></span> |



 

 

 
