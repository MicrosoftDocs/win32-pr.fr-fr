---
description: Windows Installer installe et supprime une application ou un produit dans des parties appelées composants.
ms.assetid: 949d8b8c-8f1a-4fde-9a7d-824d33436e62
title: Organisation des applications en composants
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d3fc2db794bef2a29025bf7ebc54c65691145ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103864397"
---
# <a name="organizing-applications-into-components"></a><span data-ttu-id="cdc1f-103">Organisation des applications en composants</span><span class="sxs-lookup"><span data-stu-id="cdc1f-103">Organizing Applications into Components</span></span>

<span data-ttu-id="cdc1f-104">Windows Installer installe et supprime une application ou un produit dans des parties appelées [composants](windows-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="cdc1f-104">Windows Installer installs and removes an application or product in parts referred to as [components](windows-installer-components.md).</span></span> <span data-ttu-id="cdc1f-105">Les composants sont des collections de ressources qui sont toujours installées ou supprimées comme une unité du système d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-105">Components are collections of resources that are always installed or removed as a unit from a user's system.</span></span> <span data-ttu-id="cdc1f-106">Une ressource peut être un fichier, une clé de Registre, un raccourci ou tout autre fichier qui peut être installé.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-106">A resource can be a file, registry key, shortcut, or anything else that may be installed.</span></span> <span data-ttu-id="cdc1f-107">Un [GUID](guid.md)de code de composant unique est attribué à chaque composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-107">Every component is assigned a unique component code [GUID](guid.md).</span></span>

<span data-ttu-id="cdc1f-108">Les auteurs des packages d’installation doivent uniquement créer des composants et des versions de composants qui peuvent être installés et supprimés sans endommager d’autres composants.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-108">Authors of installation packages should only create components, and versions of components, that can be installed and removed without damaging other components.</span></span> <span data-ttu-id="cdc1f-109">En outre, la suppression d’un composant ne doit pas conserver derrière les ressources orphelines sur l’ordinateur de l’utilisateur, telles que les fichiers inutilisés, les clés de registre ou les raccourcis.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-109">Also, the removal of a component should not leave behind any orphaned resources on the user's computer, such as unused files, registry keys, or shortcuts.</span></span> <span data-ttu-id="cdc1f-110">Pour ce faire, les auteurs doivent respecter les règles générales suivantes lors de l’Organisation des ressources en composants :</span><span class="sxs-lookup"><span data-stu-id="cdc1f-110">To ensure this, authors should adhere to the following general rules when organizing resources into components:</span></span>

-   <span data-ttu-id="cdc1f-111">Ne créez jamais deux composants qui installent une ressource sous le même nom et dans l’emplacement cible.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-111">Never create two components that install a resource under the same name and target location.</span></span> <span data-ttu-id="cdc1f-112">Si une ressource doit être dupliquée dans plusieurs composants, modifiez son nom ou son emplacement cible dans chaque composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-112">If a resource must be duplicated in multiple components, change its name or target location in each component.</span></span> <span data-ttu-id="cdc1f-113">Cette règle doit être appliquée entre les applications, les produits, les versions de produits et les sociétés.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-113">This rule should be applied across applications, products, product versions, and companies.</span></span>
-   <span data-ttu-id="cdc1f-114">Notez que la règle précédente signifie que deux composants ne doivent pas avoir le même fichier de chemin d’accès de clé.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-114">Note that the previous rule means that two components must not have the same key path file.</span></span> <span data-ttu-id="cdc1f-115">La valeur du chemin d’accès de la clé pointe vers un fichier ou dossier particulier appartenant au composant que le programme d’installation utilise pour détecter le composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-115">The key path value points to a particular file or folder belonging to the component that the installer uses to detect the component.</span></span> <span data-ttu-id="cdc1f-116">Si deux composants ont le même fichier de chemin d’accès de clé, le programme d’installation ne peut pas distinguer le composant installé.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-116">If two components had the same key path file, the installer would be unable to distinguish which component is installed.</span></span> <span data-ttu-id="cdc1f-117">Toutefois, deux composants peuvent partager un dossier de chemin d’accès de clé.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-117">Two components however may share a key path folder.</span></span>
-   <span data-ttu-id="cdc1f-118">Ne créez pas une version d’un composant qui n’est pas compatible avec toutes les versions précédentes du composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-118">Do not create a version of a component that is incompatible with all previous versions of the component.</span></span> <span data-ttu-id="cdc1f-119">Le composant peut être partagé par d’autres applications, produits, versions de produits et sociétés.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-119">The component may be shared by other applications, products, product versions, and companies.</span></span> <span data-ttu-id="cdc1f-120">Au lieu de cela, créez un nouveau composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-120">Instead create a new component.</span></span>
-   <span data-ttu-id="cdc1f-121">Ne créez pas de composants contenant des ressources qui devront être installés dans plusieurs répertoires sur le système de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-121">Do not create components containing resources that will need to be installed into more than one directory on the user's system.</span></span> <span data-ttu-id="cdc1f-122">Le programme d’installation installe toutes les ressources d’un composant dans le même répertoire.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-122">The installer installs all of the resources in a component into the same directory.</span></span> <span data-ttu-id="cdc1f-123">Il n’est pas possible d’installer des ressources dans des sous-répertoires.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-123">It is not possible to install some resources into subdirectories.</span></span>
-   <span data-ttu-id="cdc1f-124">N’incluez pas plus d’un serveur COM par composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-124">Do not include more than one COM server per component.</span></span> <span data-ttu-id="cdc1f-125">Si un composant contient un serveur COM, il doit s’agir du chemin d’accès à la clé du composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-125">If a component contains a COM server, this must be the key path for the component.</span></span>
-   <span data-ttu-id="cdc1f-126">Ne spécifiez pas plusieurs fichiers par composant en tant que cible pour le menu **Démarrer** ou un raccourci sur le bureau.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-126">Do not specify more than one file per component as a target for the **Start** menu or a Desktop shortcut.</span></span>

<span data-ttu-id="cdc1f-127">Lorsque vous organisez une application en composants, les auteurs de package peuvent avoir besoin d’ajouter, de supprimer ou de modifier les ressources d’une installation existante.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-127">When organizing an application into components, package authors may need to add, remove, or modify the resources in an existing installation.</span></span> <span data-ttu-id="cdc1f-128">Dans ce cas, l’auteur doit décider s’il faut fournir les ressources en introduisant un nouveau composant ou en modifiant les composants existants et en les remplaçant par une nouvelle version du composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-128">In this case, the author must decide whether to provide the resources by introducing a new component or by modifying existing components and changing them into a new version of the component.</span></span> <span data-ttu-id="cdc1f-129">Comme un code de composant unique doit être affecté lors de l’introduction d’un nouveau composant, les auteurs doivent déterminer si leurs modifications requièrent la modification du code du composant.</span><span class="sxs-lookup"><span data-stu-id="cdc1f-129">Because a unique component code must be assigned when a new component is introduced, authors must determine whether their changes require changing the component code.</span></span> <span data-ttu-id="cdc1f-130">Pour plus d’informations, consultez [modification du code du composant](changing-the-component-code.md), [que se passe-t-il si les règles des composants sont rompues ?](what-happens-if-the-component-rules-are-broken.md)et [définition des composants du programme d’installation](defining-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="cdc1f-130">For more information, see [Changing the Component Code](changing-the-component-code.md), [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md), and [Defining Installer Components](defining-installer-components.md).</span></span>

 

 



