---
description: Vous pouvez ajouter des informations de localisation à une base de données d’installation à l’aide d’un éditeur de tables de base de données comme Orca fourni avec le kit de développement logiciel (SDK) Windows Installer, ou en appelant les fonctions de base de données à partir d’une application.
ms.assetid: cc1eb336-5dec-40cc-8aa5-564cd167855d
title: Gestion des pages de codes des chaînes de paramètres
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22a52872472d5509e1abdf35aa12be5afb6a8d13
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104201701"
---
# <a name="code-page-handling-of-parameter-strings"></a><span data-ttu-id="c58ba-103">Gestion des pages de codes des chaînes de paramètres</span><span class="sxs-lookup"><span data-stu-id="c58ba-103">Code Page Handling of Parameter Strings</span></span>

<span data-ttu-id="c58ba-104">Vous pouvez ajouter des informations de localisation à une base de données d’installation à l’aide d’un éditeur de tables de base de données comme Orca fourni avec le kit de développement logiciel (SDK) Windows Installer, ou en appelant les [fonctions de base de données](database-functions.md) à partir d’une application.</span><span class="sxs-lookup"><span data-stu-id="c58ba-104">You can add localization information to an installation database by using a database table editor such as Orca that is provided with the Windows Installer SDK, or by calling the [Database Functions](database-functions.md) from an application.</span></span> <span data-ttu-id="c58ba-105">Veillez à passer uniquement des paramètres de chaîne qui utilisent la page de codes de la base de données localisée.</span><span class="sxs-lookup"><span data-stu-id="c58ba-105">Be careful to only pass string parameters that use the code page of the database that is being localized.</span></span> <span data-ttu-id="c58ba-106">Si un paramètre de chaîne contient des caractères qui ne peuvent pas être représentés par la page de codes de la base de données, le programme d’installation retourne une erreur lors de l’appel de [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="c58ba-106">If a string parameter contains characters that cannot be represented by the code page of the database, the Installer returns an error when calling [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="c58ba-107">Pour obtenir la liste des pages de codes numériques, consultez [localisation des tables Error et ActionText](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="c58ba-107">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="c58ba-108">Pour plus d’informations, consultez [la page détermination de la page de codes d’une base de données d’installation](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="c58ba-108">For more information, see [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

## <a name="adding-localization-information-to-a-database"></a><span data-ttu-id="c58ba-109">Ajout d’informations de localisation à une base de données</span><span class="sxs-lookup"><span data-stu-id="c58ba-109">Adding Localization Information to a Database</span></span>

<span data-ttu-id="c58ba-110">Lorsque vous ajoutez des informations de localisation à une base de données, la page de codes de la base de données doit être prise en charge par le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="c58ba-110">When you add localization information to a database, the code page of the database must be supported by the operating system.</span></span> <span data-ttu-id="c58ba-111">Il n’est pas nécessaire qu’il s’agit de la page de codes actuelle du système.</span><span class="sxs-lookup"><span data-stu-id="c58ba-111">It does not have to be the current code page of the system.</span></span> <span data-ttu-id="c58ba-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) doit retourner la **valeur true** pour la page de codes de la base de données.</span><span class="sxs-lookup"><span data-stu-id="c58ba-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) must return **TRUE** for the database code page.</span></span> <span data-ttu-id="c58ba-113">Étant donné que le système convertit les chaînes ANSI en Unicode, il existe une erreur si la page de codes de l’utilisateur actuel n’est pas la même que la page de codes de la base de données.</span><span class="sxs-lookup"><span data-stu-id="c58ba-113">Because the system converts ANSI strings to Unicode, there is an error if the current user code page is not the same as the database code page.</span></span>

<span data-ttu-id="c58ba-114">L’appel de la version ANSI de l’API Windows Installer convertit la chaîne localisée en Unicode à l’aide de la page de codes système actuelle.</span><span class="sxs-lookup"><span data-stu-id="c58ba-114">Calling the ANSI version of the Windows Installer API converts the localized string to Unicode by using the current system code page.</span></span> <span data-ttu-id="c58ba-115">Lorsque la base de données est validée, la chaîne Unicode est convertie en ANSI à l’aide de la page de codes de la base de données.</span><span class="sxs-lookup"><span data-stu-id="c58ba-115">When the database is committed, the Unicode string is converted to ANSI using the code page of the database.</span></span> <span data-ttu-id="c58ba-116">Si la page de codes système actuelle diffère de la page de codes de la chaîne localisée, le résultat peut être une perte de données et une conversion de chaîne incorrecte.</span><span class="sxs-lookup"><span data-stu-id="c58ba-116">If the current system code page differs from the code page of the localized string, the result can be a loss of data and incorrect string conversion.</span></span>

<span data-ttu-id="c58ba-117">La procédure suivante vous montre comment stocker les données de localisation.</span><span class="sxs-lookup"><span data-stu-id="c58ba-117">The following procedure shows you how to store the localization data.</span></span>

<span data-ttu-id="c58ba-118">**Pour stocker les données de localisation**</span><span class="sxs-lookup"><span data-stu-id="c58ba-118">**To store localization data**</span></span>

1.  <span data-ttu-id="c58ba-119">Définissez la page de codes de la base de données sur la page de codes de la chaîne localisée.</span><span class="sxs-lookup"><span data-stu-id="c58ba-119">Set the code page of the database to the code page of the localized string.</span></span>
2.  <span data-ttu-id="c58ba-120">Convertissez la chaîne ANSI en Unicode à l’aide de la fonction [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) , puis spécifiez la page de codes des données localisées.</span><span class="sxs-lookup"><span data-stu-id="c58ba-120">Convert the ANSI string to Unicode by using the [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) function, and specify the code page of the localized data.</span></span>
3.  <span data-ttu-id="c58ba-121">Appelez la version Unicode de l’API Windows Installer à l’aide de la chaîne Unicode pour ajouter les données localisées.</span><span class="sxs-lookup"><span data-stu-id="c58ba-121">Call the Unicode version of the Windows Installer API by using the Unicode string to add the localized data.</span></span>
4.  <span data-ttu-id="c58ba-122">Validez les modifications apportées à la localisation dans la base de données à l’aide de [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span><span class="sxs-lookup"><span data-stu-id="c58ba-122">Commit the localization changes to the database by using [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span>

<span data-ttu-id="c58ba-123">Vous pouvez également ajouter des informations de localisation à une base de données d’installation en important et en exportant des fichiers d’archive de texte ASCII.</span><span class="sxs-lookup"><span data-stu-id="c58ba-123">You can also add localization information to an installation database by importing and exporting ASCII text archive files.</span></span> <span data-ttu-id="c58ba-124">Pour plus d’informations, consultez [gestion des pages de codes des tables importées et exportées](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="c58ba-124">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

 

 
