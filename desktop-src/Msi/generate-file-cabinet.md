---
description: Le WiMakCab.vbs de fichiers VBScript est fourni dans les composants SDK Windows pour les développeurs Windows Installer. Cet exemple montre comment le script est utilisé pour générer des armoires de fichier à partir d’une base de données Windows Installer.
ms.assetid: 26671cb9-a200-4520-8b52-4cff3f71a2f2
title: Générer un fichier CAB
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3df2355c247ff602d644d2865ec3b9d9a8447ca4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103952299"
---
# <a name="generate-file-cabinet"></a><span data-ttu-id="d6e21-104">Générer un fichier CAB</span><span class="sxs-lookup"><span data-stu-id="d6e21-104">Generate File Cabinet</span></span>

<span data-ttu-id="d6e21-105">Le WiMakCab.vbs de fichiers VBScript est fourni dans les [composants SDK Windows pour les développeurs Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="d6e21-105">The VBScript file WiMakCab.vbs is provided in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="d6e21-106">Cet exemple montre comment le script est utilisé pour générer des armoires de fichier à partir d’une base de données Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="d6e21-106">This sample shows how script is used to generate file cabinets from a Windows Installer database.</span></span>

<span data-ttu-id="d6e21-107">Cet exemple montre :</span><span class="sxs-lookup"><span data-stu-id="d6e21-107">This sample demonstrates:</span></span>

-   <span data-ttu-id="d6e21-108">[**OpenDatabase, méthode (objet installer)**](installer-opendatabase.md) et [**méthode LastErrorRecord**](installer-lasterrorrecord.md) de l' [**objet installer**](installer-object.md)</span><span class="sxs-lookup"><span data-stu-id="d6e21-108">[**OpenDatabase method (Installer Object)**](installer-opendatabase.md) and the [**LastErrorRecord method**](installer-lasterrorrecord.md) of the [**Installer Object**](installer-object.md)</span></span>
-   <span data-ttu-id="d6e21-109">[**Méthode Commit**](database-commit.md), [**méthode OpenView**](database-openview.md) et [**propriété SummaryInformation (objet Database)**](database-summaryinformation.md) de l' [**objet Database**](database-object.md)</span><span class="sxs-lookup"><span data-stu-id="d6e21-109">[**Commit method**](database-commit.md), the [**OpenView method**](database-openview.md) and [**SummaryInformation property (Database Object)**](database-summaryinformation.md) of the [**Database Object**](database-object.md)</span></span>
-   <span data-ttu-id="d6e21-110">Méthode [**Fetch**](view-fetch.md), méthode [**Execute**](view-execute.md) et [**méthode modify**](view-modify.md) de l' [**objet View**](view-object.md)</span><span class="sxs-lookup"><span data-stu-id="d6e21-110">[**Fetch method**](view-fetch.md), [**Execute method**](view-execute.md) and [**Modify method**](view-modify.md) of the [**View Object**](view-object.md)</span></span>
-   <span data-ttu-id="d6e21-111">Propriété [**StringData**](record-stringdata.md) et [**propriété IntegerData**](record-integerdata.md) de l' [**objet record**](record-object.md)</span><span class="sxs-lookup"><span data-stu-id="d6e21-111">[**StringData property**](record-stringdata.md) and [**IntegerData property**](record-integerdata.md) of the [**Record Object**](record-object.md)</span></span>
-   <span data-ttu-id="d6e21-112">[**Méthode d’action**](session-doaction.md), propriété [**Property (objet session)**](session-session.md)et [**propriété mode**](session-mode.md) de l' [**objet session**](session-object.md)</span><span class="sxs-lookup"><span data-stu-id="d6e21-112">[**DoAction method**](session-doaction.md), the [**Property property (Session Object)**](session-session.md), and the [**Mode property**](session-mode.md) of the [**Session Object**](session-object.md)</span></span>

<span data-ttu-id="d6e21-113">Vous aurez besoin de la version CScript.exe ou WScript.exe de Windows Script Host pour utiliser cet exemple.</span><span class="sxs-lookup"><span data-stu-id="d6e21-113">You'll require the CScript.exe or WScript.exe version of Windows Script Host to use this sample.</span></span> <span data-ttu-id="d6e21-114">Pour utiliser CScript.exe pour exécuter cet exemple, tapez une commande à l’invite de commandes en utilisant la syntaxe suivante.</span><span class="sxs-lookup"><span data-stu-id="d6e21-114">To use CScript.exe to run this sample, type a command at the command prompt using the following syntax.</span></span> <span data-ttu-id="d6e21-115">L’aide s’affiche si le premier argument est/ ?</span><span class="sxs-lookup"><span data-stu-id="d6e21-115">Help is displayed if the first argument is /?</span></span> <span data-ttu-id="d6e21-116">ou si le nombre d’arguments spécifié est insuffisant.</span><span class="sxs-lookup"><span data-stu-id="d6e21-116">or if too few arguments are specified.</span></span> <span data-ttu-id="d6e21-117">Pour rediriger la sortie vers un fichier, terminez la ligne de commande avec VBS > \[ *chemin d’accès au fichier* \] .</span><span class="sxs-lookup"><span data-stu-id="d6e21-117">To redirect the output to a file, end the command line with VBS > \[*path to file*\].</span></span> <span data-ttu-id="d6e21-118">L’exemple retourne la valeur 0 pour Success, 1 si l’aide est appelée, et 2 si le script échoue.</span><span class="sxs-lookup"><span data-stu-id="d6e21-118">The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</span></span>

<span data-ttu-id="d6e21-119">**cscript WiMakCab.vbs \[ chemin d’accès au nom de base de base de données \] \[ \] \[ emplacements sources facultatifs\]**</span><span class="sxs-lookup"><span data-stu-id="d6e21-119">**cscript WiMakCab.vbs \[path to database\]\[base name\]\[optional source locations\]**</span></span>

<span data-ttu-id="d6e21-120">Pour générer un fichier CAB, Makecab.exe doit se trouver sur le chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="d6e21-120">In order to generate a cabinet, Makecab.exe must be on the PATH.</span></span> <span data-ttu-id="d6e21-121">L’utilitaire Makecab.exe est inclus dans les [composants SDK Windows pour les développeurs Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="d6e21-121">The Makecab.exe utility is included in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="d6e21-122">Notez que l’exemple ne met pas à jour la [table des médias](media-table.md) pour gérer plusieurs armoires.</span><span class="sxs-lookup"><span data-stu-id="d6e21-122">Note that the sample does not update the [Media table](media-table.md) to handle multiple cabinets.</span></span> <span data-ttu-id="d6e21-123">Pour remplacer un fichier CAB incorporé, incluez les options suivantes:/R/C/U/E.</span><span class="sxs-lookup"><span data-stu-id="d6e21-123">To replace an embedded cabinet, include the options: /R /C /U /E.</span></span>

<span data-ttu-id="d6e21-124">Spécifiez le chemin d’accès à la base de données du programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="d6e21-124">Specify the path to the installer database.</span></span> <span data-ttu-id="d6e21-125">Celui-ci doit se trouver à la racine de l’arborescence source.</span><span class="sxs-lookup"><span data-stu-id="d6e21-125">This must be located at the root of the source tree.</span></span> <span data-ttu-id="d6e21-126">Spécifiez le nom de base sensible à la casse pour les fichiers CAB générés.</span><span class="sxs-lookup"><span data-stu-id="d6e21-126">Specify the case-sensitive base name for the generated cabinet files.</span></span> <span data-ttu-id="d6e21-127">Si le type de source est compressé, tous les fichiers sont ouverts à la racine.</span><span class="sxs-lookup"><span data-stu-id="d6e21-127">If the source type is compressed, all files are opened at the root.</span></span> <span data-ttu-id="d6e21-128">Les options suivantes peuvent être spécifiées à n’importe quel point de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="d6e21-128">The following options may be specified at any point on the command line.</span></span>



| <span data-ttu-id="d6e21-129">Option</span><span class="sxs-lookup"><span data-stu-id="d6e21-129">Option</span></span>              | <span data-ttu-id="d6e21-130">Description</span><span class="sxs-lookup"><span data-stu-id="d6e21-130">Description</span></span>                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d6e21-131">aucune option spécifiée</span><span class="sxs-lookup"><span data-stu-id="d6e21-131">no option specified</span></span> |                                                                                                                                           |
| <span data-ttu-id="d6e21-132">/C</span><span class="sxs-lookup"><span data-stu-id="d6e21-132">/C</span></span>                  | <span data-ttu-id="d6e21-133">Exécutez la compression.</span><span class="sxs-lookup"><span data-stu-id="d6e21-133">Run compression.</span></span> <span data-ttu-id="d6e21-134">Si/C n’est pas spécifié, WiMakCab.vbs génère uniquement le fichier DDF.</span><span class="sxs-lookup"><span data-stu-id="d6e21-134">If /C is not specified, WiMakCab.vbs only generates the DDF file.</span></span>                                                        |
| <span data-ttu-id="d6e21-135">/L</span><span class="sxs-lookup"><span data-stu-id="d6e21-135">/L</span></span>                  | <span data-ttu-id="d6e21-136">Utiliser la compression LZX au lieu de MSZIP</span><span class="sxs-lookup"><span data-stu-id="d6e21-136">Use LZX compression instead of MSZIP</span></span>                                                                                                      |
| <span data-ttu-id="d6e21-137">/F</span><span class="sxs-lookup"><span data-stu-id="d6e21-137">/F</span></span>                  | <span data-ttu-id="d6e21-138">Limiter la taille du fichier cab à 1,44 Mo par rapport à la taille des disquettes au lieu du CD-ROM</span><span class="sxs-lookup"><span data-stu-id="d6e21-138">Limit cabinet size to 1.44 MB floppy size rather than CD-ROM</span></span>                                                                              |
| <span data-ttu-id="d6e21-139">/U</span><span class="sxs-lookup"><span data-stu-id="d6e21-139">/U</span></span>                  | <span data-ttu-id="d6e21-140">Mettre à jour la base de données pour référencer le fichier CAB généré</span><span class="sxs-lookup"><span data-stu-id="d6e21-140">Update the database to reference the generated cabinet</span></span>                                                                                    |
| <span data-ttu-id="d6e21-141">/E</span><span class="sxs-lookup"><span data-stu-id="d6e21-141">/E</span></span>                  | <span data-ttu-id="d6e21-142">Incorporer le fichier cab dans le package d’installation en tant que flux</span><span class="sxs-lookup"><span data-stu-id="d6e21-142">Embed the cabinet file in the installer package as a stream</span></span>                                                                               |
| <span data-ttu-id="d6e21-143">/S</span><span class="sxs-lookup"><span data-stu-id="d6e21-143">/S</span></span>                  | <span data-ttu-id="d6e21-144">Utiliser des numéros de séquence dans la table de fichiers triée par répertoires</span><span class="sxs-lookup"><span data-stu-id="d6e21-144">Use sequence numbers in the File table ordered by directories</span></span>                                                                             |
| <span data-ttu-id="d6e21-145">/R</span><span class="sxs-lookup"><span data-stu-id="d6e21-145">/R</span></span>                  | <span data-ttu-id="d6e21-146">Revenir à une installation sans fichier CAB, supprimer le fichier cab si l’option/E est spécifiée (l’option/R supprime la propriété de bit compressé SummaryInfo 15 & 2)</span><span class="sxs-lookup"><span data-stu-id="d6e21-146">Revert to non-cabinet install, remove cabinet if /E is specified (The /R option removes the compressed bit - SummaryInfo property 15 & 2)</span></span> |



 

<span data-ttu-id="d6e21-147">Pour obtenir des exemples supplémentaires de scripts, consultez [Windows Installer des exemples de scripts](windows-installer-scripting-examples.md).</span><span class="sxs-lookup"><span data-stu-id="d6e21-147">For additional scripting examples, see [Windows Installer Scripting Examples](windows-installer-scripting-examples.md).</span></span> <span data-ttu-id="d6e21-148">Pour obtenir des exemples d’utilitaires qui ne nécessitent pas Windows Script Host, consultez [Windows Installer les outils de développement](windows-installer-development-tools.md).</span><span class="sxs-lookup"><span data-stu-id="d6e21-148">For sample utilities that do not require Windows Script Host, see [Windows Installer Development Tools](windows-installer-development-tools.md).</span></span>

 

 



