---
description: À partir de Windows Installer version 3,0, les rédacteurs de correctifs peuvent utiliser la référence de produit mise en cache par le programme d’installation pour faciliter le service des applications avec des correctifs Delta plus petits.
ms.assetid: ab5b193d-79ce-4ed4-af53-89a4197197c1
title: Réduction de la taille des correctifs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fa365e831ab8685073347dc254bac58269135f1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106534249"
---
# <a name="reducing-patch-size"></a><span data-ttu-id="778b2-103">Réduction de la taille des correctifs</span><span class="sxs-lookup"><span data-stu-id="778b2-103">Reducing Patch Size</span></span>

<span data-ttu-id="778b2-104">À partir de Windows Installer version 3,0, les rédacteurs de correctifs peuvent utiliser la référence de produit mise en cache par le programme d’installation pour faciliter le service des applications avec des correctifs Delta plus petits.</span><span class="sxs-lookup"><span data-stu-id="778b2-104">Beginning with Windows Installer version 3.0, patch authors can use the product baseline cached by the installer to more easily service applications with smaller delta patches.</span></span> <span data-ttu-id="778b2-105">Dans de nombreux cas, un [*correctif Delta*](d-gly.md) qui fournit des informations de maintenance à une application peut être considérablement plus petit qu’un correctif de fichier complet ou un package d’installation qui fournit les mêmes informations.</span><span class="sxs-lookup"><span data-stu-id="778b2-105">In many cases, a [*delta patch*](d-gly.md) that delivers servicing information to an application can be significantly smaller than a full-file patch or installation package that delivers the same information.</span></span>

<span data-ttu-id="778b2-106">**Windows Installer 2,0 :** Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="778b2-106">**Windows Installer 2.0:** Not supported.</span></span> <span data-ttu-id="778b2-107">À partir de Windows Installer 3,0, le programme d’installation enregistre de manière sélective les informations de référence sur les fichiers lorsqu’ils sont mis à jour.</span><span class="sxs-lookup"><span data-stu-id="778b2-107">Beginning with Windows Installer 3.0, the installer selectively saves baseline information about files when they are updated.</span></span>

<span data-ttu-id="778b2-108">Windows Installer propose trois méthodes de mise à jour et de maintenance des applications : [petites mises à jour](small-updates.md), mises à [niveau mineures](minor-upgrades.md)et [mises à niveau majeures](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="778b2-108">Windows Installer provides three methods for updating and servicing applications: [small updates](small-updates.md), [minor upgrades](minor-upgrades.md), and [major upgrades](major-upgrades.md).</span></span> <span data-ttu-id="778b2-109">Une petite mise à jour est également appelée mise à jour QFE (Quick Fix Engineering) et une mise à niveau mineure est également appelée mise à jour de Service Pack (SP).</span><span class="sxs-lookup"><span data-stu-id="778b2-109">A small update is also referred to as a quick fix engineering (QFE) update, and a minor upgrade is also referred to as a service pack (SP) update.</span></span> <span data-ttu-id="778b2-110">Une mise à niveau majeure classique supprime une application précédente et installe une nouvelle application.</span><span class="sxs-lookup"><span data-stu-id="778b2-110">A typical major upgrade removes a previous application and installs a new application.</span></span> <span data-ttu-id="778b2-111">Windows Installer pouvez fournir des informations de maintenance aux applications sous la forme d’un [package d’installation](installation-package.md) (fichier. msi) ou en tant que [package correctif](patch-packages.md) (fichier. msp).</span><span class="sxs-lookup"><span data-stu-id="778b2-111">Windows Installer can deliver servicing information to applications as an [installation package](installation-package.md) (.msi file) or as a [patch package](patch-packages.md) (.msp file).</span></span>

<span data-ttu-id="778b2-112">Un package de correctifs Windows Installer qui fournit des informations de maintenance pour une petite mise à jour ou une mise à niveau mineure est généralement bien plus petit que le package d’installation équivalent qui fournit les mêmes informations de maintenance.</span><span class="sxs-lookup"><span data-stu-id="778b2-112">A Windows Installer patch package that delivers servicing information for a small update or minor upgrade is generally much smaller than the equivalent installation package that delivers the same servicing information.</span></span> <span data-ttu-id="778b2-113">Il est recommandé d’utiliser des packages de correctifs pour la distribution de petites et mineures mises à niveau.</span><span class="sxs-lookup"><span data-stu-id="778b2-113">It is recommended that patch packages be used for the distribution of small and minor upgrades.</span></span> <span data-ttu-id="778b2-114">Il est recommandé d’utiliser un package d’installation pour la distribution d’une mise à niveau majeure.</span><span class="sxs-lookup"><span data-stu-id="778b2-114">It is recommended that an installation package be used for the distribution of a major upgrade.</span></span>

<span data-ttu-id="778b2-115">Les correctifs Windows Installer (fichiers. msp) peuvent être générés à partir de fichiers complets ou de différences de fichiers (également appelées deltas de fichiers). Un correctif Windows Installer généré à partir de deltas de fichiers peut être plus petit que le correctif de fichier complet équivalent.</span><span class="sxs-lookup"><span data-stu-id="778b2-115">Windows Installer patches (.msp files) can be generated from either full files or from file differences (also called file deltas.) A Windows Installer patch generated from file deltas can be much smaller than the equivalent full-file patch.</span></span> <span data-ttu-id="778b2-116">Toutes les versions du Windows Installer peuvent utiliser des correctifs de fichiers complets ou des correctifs Delta.</span><span class="sxs-lookup"><span data-stu-id="778b2-116">All versions of the Windows Installer can use both full-file patches or delta patches.</span></span>

<span data-ttu-id="778b2-117">À partir de Windows Installer version 3,0, le programme d’installation enregistre de manière sélective les informations de référence sur les fichiers lorsqu’ils sont mis à jour.</span><span class="sxs-lookup"><span data-stu-id="778b2-117">Beginning with Windows Installer version 3.0, the installer selectively saves baseline information about files when they are updated.</span></span> <span data-ttu-id="778b2-118">Les informations relatives à l’application de base d’origine (version RTM) et à la mise à niveau mineure la plus récente (Service Pack) sont enregistrées dans un emplacement privé lorsque l’application est installée ou reçoit une mise à niveau mineure.</span><span class="sxs-lookup"><span data-stu-id="778b2-118">Information about the original base application (the RTM version) and the most recent minor upgrade (service pack) are saved in a private location when the application is installed or receives a minor upgrade.</span></span>

<span data-ttu-id="778b2-119">Le programme d’installation effectue les opérations suivantes pour réduire la taille du cache de base :</span><span class="sxs-lookup"><span data-stu-id="778b2-119">The installer does the following to minimize the size of the baseline cache:</span></span>

-   <span data-ttu-id="778b2-120">Plus de deux lignes de base sont conservées pour chaque application : une ligne de base du fichier à l’origine (RTM) et une ligne de base du fichier au moment de la mise à niveau mineure la plus récente (Service Pack.)</span><span class="sxs-lookup"><span data-stu-id="778b2-120">No more than two baselines are maintained for each application: a baseline of the file as originally released (RTM) and a baseline of the file at the most recent minor upgrade (service pack.)</span></span>
-   <span data-ttu-id="778b2-121">Un fichier n’est pas ajouté au cache tant qu’il n’est pas corrigé.</span><span class="sxs-lookup"><span data-stu-id="778b2-121">A file is not added to the cache until it is patched.</span></span> <span data-ttu-id="778b2-122">Le cache de base est copié en écriture.</span><span class="sxs-lookup"><span data-stu-id="778b2-122">The baseline cache is copy-on-write.</span></span>
-   <span data-ttu-id="778b2-123">Si l’application n’a jamais été mise à jour, il n’y a aucun fichier dans le cache de base.</span><span class="sxs-lookup"><span data-stu-id="778b2-123">If the application has never been updated, there are no files in the baseline cache.</span></span>
-   <span data-ttu-id="778b2-124">Lorsque la dernière maintenance de l’application était une mise à niveau mineure (Service Pack), l’application se trouve au niveau de la ligne de base et au maximum deux copies d’un fichier peuvent être présentes sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="778b2-124">When the application's last servicing was a minor upgrade (service pack) the application is at a baseline level and at most two copies of a file can be present on the computer.</span></span> <span data-ttu-id="778b2-125">Une copie du fichier se trouve dans le répertoire cible de l’installation.</span><span class="sxs-lookup"><span data-stu-id="778b2-125">One copy of the file is in the target directory of the installation.</span></span> <span data-ttu-id="778b2-126">L’autre copie peut être dans le cache de base de la version RTM.</span><span class="sxs-lookup"><span data-stu-id="778b2-126">The other copy can be in the RTM baseline cache.</span></span>
-   <span data-ttu-id="778b2-127">Lorsque la dernière maintenance de l’application était une petite mise à jour (QFE), l’application n’est pas au niveau de la ligne de base et au plus trois copies d’un fichier peuvent être présentes sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="778b2-127">When the application's last servicing was a small update (QFE) the application is not at a baseline level and at most three copies of a file can be present on the computer.</span></span> <span data-ttu-id="778b2-128">La première copie du fichier se trouve dans le répertoire cible de l’installation.</span><span class="sxs-lookup"><span data-stu-id="778b2-128">The first copy of the file is in the target directory of the installation.</span></span> <span data-ttu-id="778b2-129">La deuxième copie du fichier se trouve dans le cache de base de données RTM.</span><span class="sxs-lookup"><span data-stu-id="778b2-129">The second copy of the file is in the RTM baseline cache.</span></span> <span data-ttu-id="778b2-130">La dernière copie du fichier se trouve dans le cache de base de référence le plus récent.</span><span class="sxs-lookup"><span data-stu-id="778b2-130">The last copy of the file is in the most recent baseline cache.</span></span>
-   <span data-ttu-id="778b2-131">Le cache de base de l’application est supprimé lors de la désinstallation du produit.</span><span class="sxs-lookup"><span data-stu-id="778b2-131">The application's baseline cache is removed when the product is uninstalled.</span></span>

<span data-ttu-id="778b2-132">À partir de Windows Installer version 3,0, le programme d’installation peut utiliser le cache de base lorsque des correctifs sont appliqués à l’application.</span><span class="sxs-lookup"><span data-stu-id="778b2-132">Beginning with Windows Installer version 3.0, the installer can use the baseline cache when patches are applied to the application.</span></span> <span data-ttu-id="778b2-133">Les informations de ligne de base peuvent être utilisées pour appliquer un correctif Delta ou pour rétablir une version antérieure d’un fichier pendant la désinstallation d’un correctif.</span><span class="sxs-lookup"><span data-stu-id="778b2-133">The baseline information can be used to apply a delta patch or to revert a file to a previous version during a patch uninstall.</span></span> <span data-ttu-id="778b2-134">Cela peut permettre aux auteurs de correctifs de bénéficier de plus petits correctifs Delta.</span><span class="sxs-lookup"><span data-stu-id="778b2-134">This can enable patch authors to benefit from smaller delta patches.</span></span> <span data-ttu-id="778b2-135">Si le programme d’installation détecte que le correctif delta ne peut pas être appliqué au fichier cible, le programme d’installation peut tenter d’utiliser un fichier enregistré dans le cache de base comme point de départ.</span><span class="sxs-lookup"><span data-stu-id="778b2-135">If the installer finds that the delta patch cannot be applied to the target file, the installer can attempt to use a file saved in the baseline cache as a starting point.</span></span> <span data-ttu-id="778b2-136">Le programme d’installation n’a besoin que de demander la source d’installation d’origine après avoir essayé toutes les possibilités du cache.</span><span class="sxs-lookup"><span data-stu-id="778b2-136">The installer only resorts to requesting the original installation source after trying all the possibilities in the cache.</span></span>

<span data-ttu-id="778b2-137">L’adhérence aux instructions suivantes peut aider les auteurs des correctifs à utiliser Windows Installer correctifs de la version 3,0 et le cache de base pour créer des correctifs Delta plus petits :</span><span class="sxs-lookup"><span data-stu-id="778b2-137">Adherence to the following guidelines can help patch authors use Windows Installer version 3.0 patches and the baseline cache to create smaller delta patches:</span></span>

-   <span data-ttu-id="778b2-138">Créez des correctifs qui incluent la [table MsiPatchSequence](msipatchsequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="778b2-138">Author patches that include the [MsiPatchSequence table](msipatchsequence-table.md).</span></span> <span data-ttu-id="778b2-139">Cette table est requise pour utiliser le cache de base et est disponible à partir de Windows Installer version 3,0.</span><span class="sxs-lookup"><span data-stu-id="778b2-139">This table is required to use the baseline cache and is available beginning with Windows Installer version 3.0.</span></span>
-   <span data-ttu-id="778b2-140">Ne définissez pas de stratégie qui empêche la mise en cache de base.</span><span class="sxs-lookup"><span data-stu-id="778b2-140">Do not set policy that prevents baseline caching.</span></span> <span data-ttu-id="778b2-141">La valeur de la stratégie [MaxPatchCacheSize](maxpatchcachesize.md) spécifie le pourcentage maximal d’espace disque qui peut être utilisé.</span><span class="sxs-lookup"><span data-stu-id="778b2-141">The value of the [MaxPatchCacheSize](maxpatchcachesize.md) policy specifies the maximum percentage of disk space that can be used.</span></span> <span data-ttu-id="778b2-142">Si la stratégie MaxPatchCacheSize est définie sur 0, aucun fichier supplémentaire n’est enregistré dans le cache de base.</span><span class="sxs-lookup"><span data-stu-id="778b2-142">If the MaxPatchCacheSize policy is set to 0, no additional files are saved in the baseline cache.</span></span> <span data-ttu-id="778b2-143">Si la stratégie n’est pas définie, la valeur par défaut est qu’un maximum de 10% de l’espace disque peut être utilisé.</span><span class="sxs-lookup"><span data-stu-id="778b2-143">If the policy is not set, the default is that a maximum of 10% of the disk space can be used.</span></span> <span data-ttu-id="778b2-144">Si la taille totale du cache atteint le pourcentage maximal d’espace disque, aucun fichier supplémentaire n’est enregistré.</span><span class="sxs-lookup"><span data-stu-id="778b2-144">If the total size of the cache reaches the maximum percentage of disk space, no additional files are saved.</span></span> <span data-ttu-id="778b2-145">La stratégie n’affecte pas les fichiers qui ont déjà été enregistrés.</span><span class="sxs-lookup"><span data-stu-id="778b2-145">The policy does not affect files that have already been saved.</span></span> <span data-ttu-id="778b2-146">Même lorsque la mise en cache est désactivée, le programme d’installation peut utiliser les caches de référence de produit existants.</span><span class="sxs-lookup"><span data-stu-id="778b2-146">Even when caching is disabled, the installer can use existing product baseline caches.</span></span>
-   <span data-ttu-id="778b2-147">Si le premier correctif appliqué comprend la [table MsiPatchSequence](msipatchsequence-table.md), la mise en cache est activée pour l’application.</span><span class="sxs-lookup"><span data-stu-id="778b2-147">If the first patch applied includes the [MsiPatchSequence table](msipatchsequence-table.md), caching is enabled for the application.</span></span>
-   <span data-ttu-id="778b2-148">Si un correctif de la transaction de maintenance n’inclut pas la [table MsiPatchSequence](msipatchsequence-table.md), la mise en cache est activée pour l’application uniquement si un correctif de mise à niveau mineure (Service Pack) incluant la table MsiPatchSequence est appliqué avec succès au produit.</span><span class="sxs-lookup"><span data-stu-id="778b2-148">If any patch in the servicing transaction does not include the [MsiPatchSequence table](msipatchsequence-table.md), caching is enabled for the application only if a minor upgrade patch (service pack) that includes the MsiPatchSequence table is successfully applied to the product.</span></span>
-   <span data-ttu-id="778b2-149">Générez le package de correctifs à l’aide d’outils de création de correctifs tels que [Msimsp.exe](msimsp-exe.md) et [PATCHWIZ.DLL](patchwiz-dll.md).</span><span class="sxs-lookup"><span data-stu-id="778b2-149">Generate the patch package using patch creation tools such as [Msimsp.exe](msimsp-exe.md) and [PATCHWIZ.DLL](patchwiz-dll.md).</span></span>
-   <span data-ttu-id="778b2-150">Toujours cibler les correctifs pour la version RTM de l’application ou une version de mise à niveau mineure (Service Pack) de l’application.</span><span class="sxs-lookup"><span data-stu-id="778b2-150">Always target patches for the RTM version of the application or a minor upgrade (service pack) version of the application.</span></span> <span data-ttu-id="778b2-151">Les cibles spécifiées dans la [table TargetImages](targetimages-table-patchwiz-dll-.md) du fichier de propriétés de création de correctif (PCP) doivent être des points de vérification de produit définis par les trois premiers champs de la propriété [**ProductVersion**](productversion.md) .</span><span class="sxs-lookup"><span data-stu-id="778b2-151">The targets specified in the [TargetImages table](targetimages-table-patchwiz-dll-.md) of the Patch Creation Properties (PCP) file should be product check points defined by the first three fields of the [**ProductVersion**](productversion.md) property.</span></span>
-   <span data-ttu-id="778b2-152">Ne ciblez jamais les correctifs de petites images de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="778b2-152">Never target patches at small update images.</span></span> <span data-ttu-id="778b2-153">Les cibles pour la génération du correctif ne doivent pas inclure les images de mise à niveau de petite mise à jour précédentes.</span><span class="sxs-lookup"><span data-stu-id="778b2-153">The targets for building the patch should not include previous small update upgrade images.</span></span>

 

 



