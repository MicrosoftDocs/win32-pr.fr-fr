---
description: Si possible, la meilleure façon de spécifier l’emplacement cible d’un répertoire consiste à créer la table de répertoires dans votre package d’installation afin de fournir l’emplacement correct. Pour plus d’informations, consultez Utilisation de la table des répertoires.
ms.assetid: 2d16e036-2d7f-431d-b646-1addf2f65f3f
title: Modification de l’emplacement cible d’un répertoire
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 818c4e9d555244dd1637e19eb249478f13ea2d48
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104202543"
---
# <a name="changing-the-target-location-for-a-directory"></a><span data-ttu-id="1fade-104">Modification de l’emplacement cible d’un répertoire</span><span class="sxs-lookup"><span data-stu-id="1fade-104">Changing the Target Location for a Directory</span></span>

<span data-ttu-id="1fade-105">Si possible, la meilleure façon de spécifier l’emplacement cible d’un répertoire consiste à créer la [table de répertoires](directory-table.md) dans votre package d’installation afin de fournir l’emplacement correct.</span><span class="sxs-lookup"><span data-stu-id="1fade-105">If possible, the best way to specify the target location for a directory is to author the [Directory Table](directory-table.md) in your installation package to provide the correct location.</span></span> <span data-ttu-id="1fade-106">Pour plus d’informations, consultez [utilisation de la table des répertoires](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="1fade-106">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>

<span data-ttu-id="1fade-107">Si vous avez besoin de modifier l’emplacement du répertoire au moment de l’installation, vous disposez des options suivantes :</span><span class="sxs-lookup"><span data-stu-id="1fade-107">If you need to change the directory location at the time of the installation, you have the following options:</span></span>

-   <span data-ttu-id="1fade-108">Spécifiez l’emplacement d’un répertoire en définissant la valeur d’une [propriété publique](public-properties.md) sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="1fade-108">Specify the location of a directory by setting the value of a [Public Property](public-properties.md) on the command line.</span></span> <span data-ttu-id="1fade-109">Au cours de l' [action CostFinalize](costfinalize-action.md), les chemins d’accès de répertoire internes utilisés par le programme d’installation sont mis à jour avec la valeur des propriétés répertoriées en tant que clés dans la [table de répertoire](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="1fade-109">During the [CostFinalize Action](costfinalize-action.md), the internal directory paths used by the installer are updated to the value of properties listed as keys in the [Directory Table](directory-table.md).</span></span> <span data-ttu-id="1fade-110">Pour plus d’informations, consultez [utilisation des propriétés](using-properties.md) et [définition des valeurs de propriété publiques sur la ligne de commande](setting-public-property-values-on-the-command-line.md).</span><span class="sxs-lookup"><span data-stu-id="1fade-110">For more information, see [Using Properties](using-properties.md) and [Setting Public Property Values on the Command Line](setting-public-property-values-on-the-command-line.md).</span></span>
-   <span data-ttu-id="1fade-111">Spécifiez l’emplacement d’un répertoire à l’aide d’une action personnalisée.</span><span class="sxs-lookup"><span data-stu-id="1fade-111">Specify the location of a directory by using a custom action.</span></span> <span data-ttu-id="1fade-112">Si l’action personnalisée doit être exécutée avant l' [action CostFinalize](costfinalize-action.md), vous pouvez utiliser un [type d’action personnalisé 51](custom-action-type-51.md) pour définir la valeur d’une propriété à partir d’une chaîne de texte mise en forme.</span><span class="sxs-lookup"><span data-stu-id="1fade-112">If the custom action is to run before the [CostFinalize Action](costfinalize-action.md), you can use a [Custom Action Type 51](custom-action-type-51.md) to set the value of a property from a formatted text string.</span></span> <span data-ttu-id="1fade-113">Si l’action personnalisée s’exécute après l' [action CostFinalize](costfinalize-action.md), vous pouvez utiliser un [type d’action personnalisé 35](custom-action-type-35.md) pour définir la valeur du chemin d’accès du répertoire à partir d’une chaîne de texte mise en forme.</span><span class="sxs-lookup"><span data-stu-id="1fade-113">If the custom action runs after the [CostFinalize Action](costfinalize-action.md), you can use a [Custom Action Type 35](custom-action-type-35.md) to set the value of the directory path from a formatted text string.</span></span> <span data-ttu-id="1fade-114">Les actions personnalisées qui modifient l’une des [Propriétés du dossier système](property-reference.md) doivent être incluses dans les tables de séquence d’exécution (table [InstallExecuteSequence](installexecutesequence-table.md) ou [AdminExecuteSequence](adminexecutesequence-table.md)) et les tables de séquences de l’interface utilisateur (table [InstallUISequence](installuisequence-table.md) et [table AdminUISequence](adminuisequence-table.md)) afin que le dossier soit modifié au cours de l’installation [*complète*](f-gly.md) de l’interface utilisateur et de l’interface utilisateur de [*base*](b-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="1fade-114">Custom actions that change one of the [System Folder Properties](property-reference.md) should be included in both the execution sequence tables ([InstallExecuteSequence Table](installexecutesequence-table.md) or [AdminExecuteSequence Table](adminexecutesequence-table.md)), and the user interface sequence tables ([InstallUISequence Table](installuisequence-table.md) and [AdminUISequence Table](adminuisequence-table.md)) so that the folder is changed during both [*full UI*](f-gly.md) and [*basic UI*](b-gly.md) installations.</span></span>
-   <span data-ttu-id="1fade-115">Si l’installation exécute une [*interface utilisateur complète*](f-gly.md), vous pouvez utiliser [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) ou [SetTargetPath ControlEvent,](settargetpath-controlevent.md) pour définir le chemin d’accès du répertoire.</span><span class="sxs-lookup"><span data-stu-id="1fade-115">If the installation is running a [*full UI*](f-gly.md), you can use [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) or the [SetTargetPath ControlEvent](settargetpath-controlevent.md) to set the directory path.</span></span> <span data-ttu-id="1fade-116">Vérifiez la propriété [**ProductState**](productstate.md) pour déterminer si le produit qui contient ce composant est déjà installé avant d’appeler **MsiSetTargetPath** ou SetTargetPath ControlEvent,.</span><span class="sxs-lookup"><span data-stu-id="1fade-116">Check the [**ProductState**](productstate.md) Property to determine whether the product that contains this component is already installed before calling **MsiSetTargetPath** or the SetTargetPath ControlEvent.</span></span> <span data-ttu-id="1fade-117">N’essayez pas de modifier le chemin d’accès au répertoire cible si certains composants qui utilisent ce chemin d’accès sont déjà installés pour l’utilisateur actuel ou un autre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1fade-117">Do not attempt to change the target directory path if some components that use that path are already installed for the current user or a different user.</span></span>

<span data-ttu-id="1fade-118">Les restrictions suivantes s’appliquent à toutes les options ci-dessus :</span><span class="sxs-lookup"><span data-stu-id="1fade-118">The following restrictions apply to all of the above options:</span></span>

-   <span data-ttu-id="1fade-119">N’essayez pas de modifier le chemin d’accès au répertoire cible si certains composants qui utilisent le chemin d’accès sont déjà installés pour l’utilisateur actuel ou pour un autre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1fade-119">Do not attempt to change the target directory path if some components that use the path are already installed for the current user or for a different user.</span></span>
-   <span data-ttu-id="1fade-120">N’essayez pas de modifier le chemin d’accès au répertoire cible pendant une [installation de maintenance](maintenance-installation.md).</span><span class="sxs-lookup"><span data-stu-id="1fade-120">Do not attempt to change the target directory path during a [Maintenance Installation](maintenance-installation.md).</span></span>

 

 



