---
description: Ce document est destiné aux développeurs qui écrivent leurs propres programmes d’installation et développeurs qui souhaitent en savoir plus sur les tables de la base de données du programme d’installation. Pour obtenir des informations générales sur le programme d’installation, consultez à propos de Windows Installer.
ms.assetid: 95516437-9708-4f4e-a5c2-7bcd4741c776
title: Fonctions de base de données
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e4a4233437d24944c8bb7fe5c7de6412e700022b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103752797"
---
# <a name="database-functions"></a><span data-ttu-id="d3e2f-104">Fonctions de base de données</span><span class="sxs-lookup"><span data-stu-id="d3e2f-104">Database Functions</span></span>

<span data-ttu-id="d3e2f-105">Ce document est destiné aux développeurs qui écrivent leurs propres programmes d’installation et développeurs qui souhaitent en savoir plus sur les tables de la base de données du programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-105">This material is intended for developers who are writing their own setup programs and developers who want to learn more about the installer database tables.</span></span> <span data-ttu-id="d3e2f-106">Pour obtenir des informations générales sur le programme d’installation, consultez [à propos de Windows Installer](about-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="d3e2f-106">For general information on the installer, see [About Windows Installer](about-windows-installer.md).</span></span>

<span data-ttu-id="d3e2f-107">Vous pouvez utiliser les fonctions d’installation pour accéder à la base de données et au processus d’installation.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-107">You can use the installer access functions to access the database and the installation process.</span></span> <span data-ttu-id="d3e2f-108">Ces fonctions ne doivent être utilisées que par les actions d’installation personnalisée et les outils de création.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-108">These functions should only be used by custom installation actions and authoring tools.</span></span> <span data-ttu-id="d3e2f-109">Certaines fonctions d’accès au programme d’installation requièrent des chaînes de requête SQL pour interroger la base de données.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-109">Some of the installer access functions require SQL query strings for querying the database.</span></span> <span data-ttu-id="d3e2f-110">Les requêtes doivent adhérer à la [syntaxe SQL](sql-syntax.md)du programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-110">Queries must adhere to the installer [SQL syntax](sql-syntax.md).</span></span>

<span data-ttu-id="d3e2f-111">Cette rubrique répertorie les fonctions d’accès à la base de données du programme d’installation par catégorie.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-111">This topic lists the installer database access functions by category.</span></span>

## <a name="general-database-access-functions"></a><span data-ttu-id="d3e2f-112">Fonctions générales d’accès aux bases de données</span><span class="sxs-lookup"><span data-stu-id="d3e2f-112">General Database Access Functions</span></span>



| <span data-ttu-id="d3e2f-113">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-113">Function</span></span>                                                             | <span data-ttu-id="d3e2f-114">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-114">Description</span></span>                                                                             |
|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-115">**MsiDatabaseCommit**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-115">**MsiDatabaseCommit**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)                       | <span data-ttu-id="d3e2f-116">Valide les modifications apportées à une base de données.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-116">Commits changes to a database.</span></span>                                                          |
| [<span data-ttu-id="d3e2f-117">**MsiDatabaseGetPrimaryKeys**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-117">**MsiDatabaseGetPrimaryKeys**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegetprimarykeysa)       | <span data-ttu-id="d3e2f-118">Retourne les noms de toutes les colonnes clés primaires.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-118">Returns the names of all the primary key columns.</span></span>                                       |
| [<span data-ttu-id="d3e2f-119">**MsiDatabaseIsTablePersistent**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-119">**MsiDatabaseIsTablePersistent**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseistablepersistenta) | <span data-ttu-id="d3e2f-120">Retourne une énumération décrivant l’état d’une table.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-120">Returns an enumeration describing the state of a table.</span></span>                                 |
| [<span data-ttu-id="d3e2f-121">**MsiDatabaseOpenView**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-121">**MsiDatabaseOpenView**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa)                   | <span data-ttu-id="d3e2f-122">Prépare une requête de base de données et crée un objet de vue.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-122">Prepares a database query and creates a view object.</span></span>                                    |
| [<span data-ttu-id="d3e2f-123">**MsiGetActiveDatabase**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-123">**MsiGetActiveDatabase**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetactivedatabase)                 | <span data-ttu-id="d3e2f-124">Retourne la base de données active pour l’installation.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-124">Returns the active database for the installation.</span></span>                                       |
| [<span data-ttu-id="d3e2f-125">**MsiViewGetColumnInfo**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-125">**MsiViewGetColumnInfo**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgetcolumninfo)                 | <span data-ttu-id="d3e2f-126">Retourne des définitions ou des noms de colonnes.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-126">Returns column names or definitions.</span></span>                                                    |
| [<span data-ttu-id="d3e2f-127">**MsiOpenDatabase**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-127">**MsiOpenDatabase**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiopendatabasea)                           | <span data-ttu-id="d3e2f-128">Ouvre un fichier de base de données pour l’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-128">Opens a database file for data access.</span></span>                                                  |
| [<span data-ttu-id="d3e2f-129">**MsiViewClose**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-129">**MsiViewClose**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewclose)                                 | <span data-ttu-id="d3e2f-130">Libère le jeu de résultats pour une vue exécutée.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-130">Releases the result set for an executed view.</span></span>                                           |
| [<span data-ttu-id="d3e2f-131">**MsiViewExecute**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-131">**MsiViewExecute**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewexecute)                             | <span data-ttu-id="d3e2f-132">Exécute la requête de vue et fournit les paramètres requis.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-132">Executes the view query and supplies required parameters.</span></span>                               |
| [<span data-ttu-id="d3e2f-133">**MsiViewFetch**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-133">**MsiViewFetch**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewfetch)                                 | <span data-ttu-id="d3e2f-134">Extrait l’enregistrement séquentiel suivant de la vue.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-134">Fetches the next sequential record from the view.</span></span>                                       |
| [<span data-ttu-id="d3e2f-135">**MsiViewGetError**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-135">**MsiViewGetError**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora)                           | <span data-ttu-id="d3e2f-136">Retourne l’erreur qui s’est produite dans la fonction [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) .</span><span class="sxs-lookup"><span data-stu-id="d3e2f-136">Returns the error that occurred in the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function.</span></span> |
| [<span data-ttu-id="d3e2f-137">**MsiViewModify**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-137">**MsiViewModify**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify)                               | <span data-ttu-id="d3e2f-138">Met à jour un enregistrement extrait.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-138">Updates a fetched record.</span></span>                                                               |



 

## <a name="database-management-functions"></a><span data-ttu-id="d3e2f-139">Fonctions de gestion de base de données</span><span class="sxs-lookup"><span data-stu-id="d3e2f-139">Database Management Functions</span></span>



| <span data-ttu-id="d3e2f-140">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-140">Function</span></span>                                                               | <span data-ttu-id="d3e2f-141">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-141">Description</span></span>                                                      |
|------------------------------------------------------------------------|------------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-142">**MsiCreateTransformSummaryInfo**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-142">**MsiCreateTransformSummaryInfo**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msicreatetransformsummaryinfoa) | <span data-ttu-id="d3e2f-143">Crée des informations de synthèse pour une transformation existante.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-143">Creates summary information for an existing transform.</span></span>           |
| [<span data-ttu-id="d3e2f-144">**MsiDatabaseApplyTransform**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-144">**MsiDatabaseApplyTransform**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseapplytransforma)         | <span data-ttu-id="d3e2f-145">Applique une transformation à une base de données.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-145">Applies a transform to a database.</span></span>                               |
| [<span data-ttu-id="d3e2f-146">**MsiDatabaseExport**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-146">**MsiDatabaseExport**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta)                         | <span data-ttu-id="d3e2f-147">Exporte une table d’une base de données ouverte dans un fichier d’archive de texte.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-147">Exports a table from an open database to a text archive file.</span></span>    |
| [<span data-ttu-id="d3e2f-148">**MsiDatabaseGenerateTransform**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-148">**MsiDatabaseGenerateTransform**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegeneratetransforma)   | <span data-ttu-id="d3e2f-149">Génère un fichier de transformation de différences entre deux bases de données.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-149">Generates a transform file of differences between two databases.</span></span> |
| [<span data-ttu-id="d3e2f-150">**MsiDatabaseImport**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-150">**MsiDatabaseImport**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta)                         | <span data-ttu-id="d3e2f-151">Importe une table d’archive de texte du programme d’installation dans une base de données ouverte.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-151">Imports an installer text archive table into an open database.</span></span>   |
| [<span data-ttu-id="d3e2f-152">**MsiDatabaseMerge**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-152">**MsiDatabaseMerge**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea)                           | <span data-ttu-id="d3e2f-153">Fusionne deux bases de données.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-153">Merges two databases together.</span></span>                                   |
| [<span data-ttu-id="d3e2f-154">**MsiGetDatabaseState**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-154">**MsiGetDatabaseState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetdatabasestate)                     | <span data-ttu-id="d3e2f-155">Retourne l’état de la base de données.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-155">Returns the state of the database.</span></span>                               |



 

## <a name="record-processing-functions"></a><span data-ttu-id="d3e2f-156">Fonctions de traitement des enregistrements</span><span class="sxs-lookup"><span data-stu-id="d3e2f-156">Record Processing Functions</span></span>



| <span data-ttu-id="d3e2f-157">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-157">Function</span></span>                                                 | <span data-ttu-id="d3e2f-158">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-158">Description</span></span>                                                     |
|----------------------------------------------------------|-----------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-159">**MsiCreateRecord**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-159">**MsiCreateRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msicreaterecord)               | <span data-ttu-id="d3e2f-160">Crée un objet record avec le nombre spécifié de champs.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-160">Creates new record object with specified number of fields.</span></span>      |
| [<span data-ttu-id="d3e2f-161">**MsiFormatRecord**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-161">**MsiFormatRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiformatrecorda)               | <span data-ttu-id="d3e2f-162">Met en forme les données et les propriétés des champs d’enregistrement à l’aide d’une chaîne de format.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-162">Formats record field data and properties using a format string.</span></span> |
| [<span data-ttu-id="d3e2f-163">**MsiRecordClearData**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-163">**MsiRecordClearData**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordcleardata)         | <span data-ttu-id="d3e2f-164">Affecte la valeur null à tous les champs d’un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-164">Sets all fields in a record to null.</span></span>                            |
| [<span data-ttu-id="d3e2f-165">**MsiRecordDataSize**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-165">**MsiRecordDataSize**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecorddatasize)           | <span data-ttu-id="d3e2f-166">Retourne la longueur d’un champ d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-166">Returns the length of a record field.</span></span>                           |
| [<span data-ttu-id="d3e2f-167">**MsiRecordGetFieldCount**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-167">**MsiRecordGetFieldCount**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetfieldcount) | <span data-ttu-id="d3e2f-168">Retourne le nombre de champs dans un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-168">Returns the number of fields in a record.</span></span>                       |
| [<span data-ttu-id="d3e2f-169">**MsiRecordGetInteger**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-169">**MsiRecordGetInteger**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetinteger)       | <span data-ttu-id="d3e2f-170">Retourne la valeur entière d’un champ d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-170">Returns the integer value from a record field.</span></span>                  |
| [<span data-ttu-id="d3e2f-171">**MsiRecordGetString**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-171">**MsiRecordGetString**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetstringa)         | <span data-ttu-id="d3e2f-172">Retourne la valeur de chaîne d’un champ d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-172">Returns the string value of a record field.</span></span>                     |
| [<span data-ttu-id="d3e2f-173">**MsiRecordIsNull**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-173">**MsiRecordIsNull**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordisnull)               | <span data-ttu-id="d3e2f-174">Indique si un champ d’enregistrement a la valeur null.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-174">Reports whether a record field is null.</span></span>                         |
| [<span data-ttu-id="d3e2f-175">**MsiRecordReadStream**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-175">**MsiRecordReadStream**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordreadstream)       | <span data-ttu-id="d3e2f-176">Lit les octets d’un champ de flux d’enregistrement dans une mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-176">Reads bytes from a record stream field into a buffer.</span></span>           |
| [<span data-ttu-id="d3e2f-177">**MsiRecordSetInteger**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-177">**MsiRecordSetInteger**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetinteger)       | <span data-ttu-id="d3e2f-178">Définit un champ d’enregistrement sur un champ de type entier.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-178">Sets a record field to an integer field.</span></span>                        |
| [<span data-ttu-id="d3e2f-179">**MsiRecordSetStream**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-179">**MsiRecordSetStream**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama)         | <span data-ttu-id="d3e2f-180">Définit un champ de flux d’enregistrement à partir d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-180">Sets a record stream field from a file.</span></span>                         |
| [<span data-ttu-id="d3e2f-181">**MsiRecordSetString**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-181">**MsiRecordSetString**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa)         | <span data-ttu-id="d3e2f-182">Copie une chaîne dans le champ désigné.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-182">Copies a string into the designated field.</span></span>                      |



 

## <a name="summary-information-property-functions"></a><span data-ttu-id="d3e2f-183">Fonctions de propriété des informations de résumé</span><span class="sxs-lookup"><span data-stu-id="d3e2f-183">Summary Information Property Functions</span></span>



| <span data-ttu-id="d3e2f-184">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-184">Function</span></span>                                                                 | <span data-ttu-id="d3e2f-185">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-185">Description</span></span>                                                            |
|--------------------------------------------------------------------------|------------------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-186">**MsiGetSummaryInformation**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-186">**MsiGetSummaryInformation**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetsummaryinformationa)             | <span data-ttu-id="d3e2f-187">Obtient le handle du flux d’informations récapitulatives de la base de données du programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-187">Obtains handle to summary information stream of installer database.</span></span>    |
| [<span data-ttu-id="d3e2f-188">**MsiSummaryInfoGetProperty**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-188">**MsiSummaryInfoGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfogetpropertya)           | <span data-ttu-id="d3e2f-189">Obtient une propriété unique à partir des informations de résumé.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-189">Gets a single property from the summary information.</span></span>                   |
| [<span data-ttu-id="d3e2f-190">**MsiSummaryInfoGetPropertyCount**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-190">**MsiSummaryInfoGetPropertyCount**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfogetpropertycount) | <span data-ttu-id="d3e2f-191">Retourne le nombre de propriétés dans le flux d’informations de résumé.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-191">Returns number of properties in the summary information stream.</span></span>        |
| [<span data-ttu-id="d3e2f-192">**MsiSummaryInfoPersist**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-192">**MsiSummaryInfoPersist**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfopersist)                   | <span data-ttu-id="d3e2f-193">Écrit les informations de résumé modifiées dans le flux d’informations de synthèse.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-193">Writes changed summary information back to summary information stream.</span></span> |
| [<span data-ttu-id="d3e2f-194">**MsiSummaryInfoSetProperty**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-194">**MsiSummaryInfoSetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfosetpropertya)           | <span data-ttu-id="d3e2f-195">Définit une propriété d’informations de résumé unique.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-195">Sets a single summary information property.</span></span>                            |



 

## <a name="installer-state-access-functions"></a><span data-ttu-id="d3e2f-196">Fonctions d’accès à l’état du programme d’installation</span><span class="sxs-lookup"><span data-stu-id="d3e2f-196">Installer State Access Functions</span></span>



| <span data-ttu-id="d3e2f-197">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-197">Function</span></span>                                               | <span data-ttu-id="d3e2f-198">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-198">Description</span></span>                                                 |
|--------------------------------------------------------|-------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-199">**MsiGetLanguage**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-199">**MsiGetLanguage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlanguage)               | <span data-ttu-id="d3e2f-200">Retourne la langue numérique de l’installation actuelle.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-200">Returns the numeric language of the current installation.</span></span>   |
| [<span data-ttu-id="d3e2f-201">**MsiGetLastErrorRecord**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-201">**MsiGetLastErrorRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlasterrorrecord) | <span data-ttu-id="d3e2f-202">Retourne le dernier enregistrement d’erreur retourné pour le processus appelant.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-202">Returns error record last returned for the calling process.</span></span> |
| [<span data-ttu-id="d3e2f-203">**MsiGetMode**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-203">**MsiGetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode)                       | <span data-ttu-id="d3e2f-204">Retourne l’un des États d’installation internes booléens.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-204">Returns one of the Boolean internal installation states.</span></span>    |
| [<span data-ttu-id="d3e2f-205">**MsiGetProperty**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-205">**MsiGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetpropertya)               | <span data-ttu-id="d3e2f-206">Obtient la valeur d’une propriété du programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-206">Gets the value of an installer property.</span></span>                    |
| [<span data-ttu-id="d3e2f-207">**MsiSetProperty**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-207">**MsiSetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetpropertya)               | <span data-ttu-id="d3e2f-208">Définit la valeur d’une propriété d’installation.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-208">Sets the value of an installation property.</span></span>                 |
| [<span data-ttu-id="d3e2f-209">**MsiSetMode**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-209">**MsiSetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetmode)                       | <span data-ttu-id="d3e2f-210">Définit un état booléen du moteur interne.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-210">Sets an internal engine Boolean state.</span></span>                      |



 

## <a name="installer-action-functions"></a><span data-ttu-id="d3e2f-211">Fonctions d’action du programme d’installation</span><span class="sxs-lookup"><span data-stu-id="d3e2f-211">Installer Action Functions</span></span>



| <span data-ttu-id="d3e2f-212">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-212">Function</span></span>                                             | <span data-ttu-id="d3e2f-213">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-213">Description</span></span>                                                               |
|------------------------------------------------------|---------------------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-214">**MsiDoAction**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-214">**MsiDoAction**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidoactiona)                   | <span data-ttu-id="d3e2f-215">Exécute une action intégrée, une action personnalisée ou une action de l’Assistant interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-215">Executes built-in action, custom action, or user-interface wizard action.</span></span> |
| [<span data-ttu-id="d3e2f-216">**MsiEvaluateCondition**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-216">**MsiEvaluateCondition**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msievaluateconditiona) | <span data-ttu-id="d3e2f-217">Évalue une expression conditionnelle contenant des noms et des valeurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-217">Evaluates a conditional expression containing property names and values.</span></span>  |
| [<span data-ttu-id="d3e2f-218">**MsiProcessMessage**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-218">**MsiProcessMessage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage)       | <span data-ttu-id="d3e2f-219">Envoie un enregistrement d’erreur au programme d’installation pour traitement.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-219">Sends an error record to the installer for processing.</span></span>                    |
| [<span data-ttu-id="d3e2f-220">**MsiSequence**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-220">**MsiSequence**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisequencea)                   | <span data-ttu-id="d3e2f-221">Exécute une séquence d’action.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-221">Executes an action sequence.</span></span>                                              |



 

## <a name="installer-location-functions"></a><span data-ttu-id="d3e2f-222">Fonctions d’emplacement du programme d’installation</span><span class="sxs-lookup"><span data-stu-id="d3e2f-222">Installer Location Functions</span></span>



| <span data-ttu-id="d3e2f-223">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-223">Function</span></span>                                     | <span data-ttu-id="d3e2f-224">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-224">Description</span></span>                                                       |
|----------------------------------------------|-------------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-225">**MsiGetSourcePath**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-225">**MsiGetSourcePath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetsourcepatha) | <span data-ttu-id="d3e2f-226">Retourne le chemin d’accès source complet d’un dossier dans la table de répertoires.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-226">Returns the full source path for a folder in the Directory table.</span></span> |
| [<span data-ttu-id="d3e2f-227">**MsiGetTargetPath**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-227">**MsiGetTargetPath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigettargetpatha) | <span data-ttu-id="d3e2f-228">Retourne le chemin d’accès cible complet d’un dossier dans la table de répertoires.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-228">Returns the full target path for a folder in the Directory table.</span></span> |
| [<span data-ttu-id="d3e2f-229">**MsiSetTargetPath**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-229">**MsiSetTargetPath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) | <span data-ttu-id="d3e2f-230">Définit le chemin d’accès cible complet d’un dossier dans la table de répertoires.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-230">Sets the full target path for a folder in the Directory table.</span></span>    |



 

## <a name="installer-selection-functions"></a><span data-ttu-id="d3e2f-231">Fonctions de sélection du programme d’installation</span><span class="sxs-lookup"><span data-stu-id="d3e2f-231">Installer Selection Functions</span></span>



| <span data-ttu-id="d3e2f-232">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-232">Function</span></span>                                                     | <span data-ttu-id="d3e2f-233">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-233">Description</span></span>                                                          |
|--------------------------------------------------------------|----------------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-234">**MsiEnumComponentCosts**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-234">**MsiEnumComponentCosts**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msienumcomponentcostsa)       | <span data-ttu-id="d3e2f-235">Énumère l’espace disque par lecteur requis pour installer un composant.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-235">Enumerates the disk-space per drive required to install a component.</span></span> |
| [<span data-ttu-id="d3e2f-236">**MsiGetComponentState**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-236">**MsiGetComponentState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetcomponentstatea)         | <span data-ttu-id="d3e2f-237">Obtient l’état d’un composant.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-237">Obtains the state of a component.</span></span>                                    |
| [<span data-ttu-id="d3e2f-238">**MsiGetFeatureCost**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-238">**MsiGetFeatureCost**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturecosta)               | <span data-ttu-id="d3e2f-239">Retourne l’espace disque requis par une fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-239">Returns the disk space required by a feature.</span></span>                        |
| [<span data-ttu-id="d3e2f-240">**MsiGetFeatureState**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-240">**MsiGetFeatureState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturestatea)             | <span data-ttu-id="d3e2f-241">Obtient l’état d’une fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-241">Gets the state of a feature.</span></span>                                         |
| [<span data-ttu-id="d3e2f-242">**MsiGetFeatureValidStates**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-242">**MsiGetFeatureValidStates**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturevalidstatesa) | <span data-ttu-id="d3e2f-243">Retourne un état d’installation valide.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-243">Returns a valid installation state.</span></span>                                  |
| [<span data-ttu-id="d3e2f-244">**MsiSetComponentState**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-244">**MsiSetComponentState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetcomponentstatea)         | <span data-ttu-id="d3e2f-245">Définit un composant à l’état spécifié.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-245">Sets a component to the specified state.</span></span>                             |
| [<span data-ttu-id="d3e2f-246">**MsiSetFeatureAttributes**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-246">**MsiSetFeatureAttributes**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetfeatureattributesa)   | <span data-ttu-id="d3e2f-247">Modifie les attributs par défaut d’une fonctionnalité au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-247">Modifies the default attributes of a feature at run time.</span></span>            |
| [<span data-ttu-id="d3e2f-248">**MsiSetFeatureState**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-248">**MsiSetFeatureState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetfeaturestatea)             | <span data-ttu-id="d3e2f-249">Affecte un état spécifié à une fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-249">Sets a feature to a specified state.</span></span>                                 |
| [<span data-ttu-id="d3e2f-250">**MsiSetInstallLevel**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-250">**MsiSetInstallLevel**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetinstalllevel)             | <span data-ttu-id="d3e2f-251">Définit le niveau d’installation d’une installation complète du produit.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-251">Sets the installation level of a full product installation.</span></span>          |
| [<span data-ttu-id="d3e2f-252">**MsiVerifyDiskSpace**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-252">**MsiVerifyDiskSpace**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiverifydiskspace)             | <span data-ttu-id="d3e2f-253">Vérifie que l’espace disque est suffisant.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-253">Checks for sufficient disk space.</span></span>                                    |



 

## <a name="user-interface-functions"></a><span data-ttu-id="d3e2f-254">Fonctions de l’interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="d3e2f-254">User Interface Functions</span></span>



| <span data-ttu-id="d3e2f-255">Fonction</span><span class="sxs-lookup"><span data-stu-id="d3e2f-255">Function</span></span>                                           | <span data-ttu-id="d3e2f-256">Description</span><span class="sxs-lookup"><span data-stu-id="d3e2f-256">Description</span></span>                                                             |
|----------------------------------------------------|-------------------------------------------------------------------------|
| [<span data-ttu-id="d3e2f-257">**MsiEnableUIPreview**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-257">**MsiEnableUIPreview**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msienableuipreview)   | <span data-ttu-id="d3e2f-258">Active le mode aperçu de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-258">Enables preview mode of the user interface.</span></span>                             |
| [<span data-ttu-id="d3e2f-259">**MsiPreviewBillboard**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-259">**MsiPreviewBillboard**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msipreviewbillboarda) | <span data-ttu-id="d3e2f-260">Affiche un tableau blanc avec le contrôle hôte dans la boîte de dialogue affichée.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-260">Displays a billboard with the host control in the displayed dialog box.</span></span> |
| [<span data-ttu-id="d3e2f-261">**MsiPreviewDialog**</span><span class="sxs-lookup"><span data-stu-id="d3e2f-261">**MsiPreviewDialog**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msipreviewdialoga)       | <span data-ttu-id="d3e2f-262">Affiche une boîte de dialogue non modale et inactive.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-262">Displays a dialog box as modeless and inactive.</span></span>                         |



 

<span data-ttu-id="d3e2f-263">Toutes les fonctions prennent en charge les appels ANSI et Unicode.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-263">All functions support both ANSI and Unicode calls.</span></span> <span data-ttu-id="d3e2f-264">Pour utiliser ces fonctions, incluez MsiQuery. h et liez-le à msi. lib.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-264">To use these functions, include MsiQuery.h and link with Msi.lib.</span></span>

## <a name="installation-functions"></a><span data-ttu-id="d3e2f-265">Fonctions d’installation</span><span class="sxs-lookup"><span data-stu-id="d3e2f-265">Installation Functions</span></span>

<span data-ttu-id="d3e2f-266">Outre les fonctions d’accès à la base de données listées ci-dessus, vous créez un package d’installation pour une application à l’aide des fonctions de programme d’installation listées dans la section [référence des fonctions du programme](installer-function-reference.md) d’installation.</span><span class="sxs-lookup"><span data-stu-id="d3e2f-266">In addition to the database access functions listed above, you create an installation package for an application by using the installer functions listed in the [Installer Function Reference](installer-function-reference.md) section.</span></span>

 

 



