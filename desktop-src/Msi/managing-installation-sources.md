---
description: Les utilisateurs et les applications avec des privilèges d’administrateur peuvent récupérer et modifier les informations de liste de sources de données, d’URL et de réseau pour Windows Installer les applications et les correctifs sur le système.
ms.assetid: e8c66bad-f594-4926-b3b4-c8b245dcfa83
title: Gestion des sources d’installation
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7fc45253af20ae5f9792ee3a5ec7dd318c80295
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106541238"
---
# <a name="managing-installation-sources"></a><span data-ttu-id="3c980-103">Gestion des sources d’installation</span><span class="sxs-lookup"><span data-stu-id="3c980-103">Managing Installation Sources</span></span>

<span data-ttu-id="3c980-104">Les utilisateurs et les applications avec des privilèges d’administrateur peuvent récupérer et modifier les informations de liste de sources de données, d’URL et de réseau pour Windows Installer les applications et les correctifs sur le système.</span><span class="sxs-lookup"><span data-stu-id="3c980-104">Users and applications with administrative privileges can retrieve and modify network, URL, and media source list information for Windows Installer applications and patches on the system.</span></span>

<span data-ttu-id="3c980-105">**Windows Installer 2,0 :** Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="3c980-105">**Windows Installer 2.0:** Not supported.</span></span> <span data-ttu-id="3c980-106">Les administrateurs ne peuvent pas lire, réorganiser ou remplacer des entrées dans la liste source et ne peuvent pas modifier ou récupérer les propriétés de la liste source.</span><span class="sxs-lookup"><span data-stu-id="3c980-106">Administrators cannot read, reorder, or replace entries in the source list and cannot modify or retrieve source list properties.</span></span> <span data-ttu-id="3c980-107">Il est possible de gérer des sources réseau, mais pas des sources d’URL ou de médias.</span><span class="sxs-lookup"><span data-stu-id="3c980-107">It is possible to manage Network sources, but not URL or Media sources.</span></span> <span data-ttu-id="3c980-108">Les administrateurs peuvent uniquement gérer des listes de sources pour les applications par ordinateur ou les applications installées en fonction de l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="3c980-108">Administrators can only manage source lists for per-machine applications or applications installed as per-user for the current user.</span></span> <span data-ttu-id="3c980-109">Cela empêche les administrateurs qui utilisent des versions antérieures à Windows Installer version 3,0 de gérer les informations de liste source pour tous les utilisateurs du système.</span><span class="sxs-lookup"><span data-stu-id="3c980-109">This prevents administrators using versions earlier than Windows Installer version 3.0 from managing source list information for all users in the system.</span></span>

<span data-ttu-id="3c980-110">**Windows Installer 3,0 et versions ultérieures :** Les utilisateurs et les applications qui possèdent des privilèges d’administrateur peuvent récupérer et modifier les informations de liste source pour les applications Windows Installer et les correctifs installés sur le système pour tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="3c980-110">**Windows Installer 3.0 and later:** Users and applications that have administrator privileges can retrieve and modify source list information for Windows Installer applications and patches installed on the system for all users.</span></span> <span data-ttu-id="3c980-111">Les fonctions de liste source peuvent être utilisées pour gérer des listes sources et des propriétés de liste source pour les sources de réseau, d’URL et de média.</span><span class="sxs-lookup"><span data-stu-id="3c980-111">The source list functions can be used to manage source lists and source list properties for network, URL and media sources.</span></span> <span data-ttu-id="3c980-112">Le programme d’installation peut réorganiser les listes de sources à partir d’un processus externe.</span><span class="sxs-lookup"><span data-stu-id="3c980-112">The installer can reorder source lists from an external process.</span></span>

<span data-ttu-id="3c980-113">Les utilisateurs et les applications qui ont des privilèges d’administrateur peuvent lire et modifier les types suivants d’informations de liste source :</span><span class="sxs-lookup"><span data-stu-id="3c980-113">Users and applications that have administrative privileges can read and modify the following types of source list information:</span></span>

-   <span data-ttu-id="3c980-114">Listes de sources pour les applications et les correctifs installés pour tous les utilisateurs sur le système.</span><span class="sxs-lookup"><span data-stu-id="3c980-114">Source lists for applications and patches installed for all users on the system.</span></span>
-   <span data-ttu-id="3c980-115">Listes sources pour les sources de correctifs qui existent indépendamment des sources de l’application.</span><span class="sxs-lookup"><span data-stu-id="3c980-115">Source lists for patch sources that exist apart from the application sources.</span></span>
-   <span data-ttu-id="3c980-116">Listes sources pour les sources d’URL et de supports qui existent en dehors des sources réseau.</span><span class="sxs-lookup"><span data-stu-id="3c980-116">Source lists for URL and media sources that exist apart from network sources.</span></span>
-   <span data-ttu-id="3c980-117">Propriétés de la liste source, telles que [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType** et **PackageName**.</span><span class="sxs-lookup"><span data-stu-id="3c980-117">Source list properties such as [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType**, and **PackageName**.</span></span>

<span data-ttu-id="3c980-118">Les fonctions de listes de sources peuvent limiter l’étendue des listes sources trouvées en spécifiant le contexte d’installation et le contexte de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-118">The source lists functions can limit the scope of the source lists found by specifying the installation context and user context.</span></span> <span data-ttu-id="3c980-119">Il existe trois contextes d’installation possibles : par utilisateur (non géré), par ordinateur et par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-119">There are three possible installation contexts: per-user (unmanaged), per-machine, and per-user managed.</span></span> <span data-ttu-id="3c980-120">Le contexte de l’utilisateur peut être un utilisateur particulier ou tous les utilisateurs du système.</span><span class="sxs-lookup"><span data-stu-id="3c980-120">The user context can be a particular user or all users on the system.</span></span>

<span data-ttu-id="3c980-121">Les non-administrateurs ne peuvent pas modifier la liste source d’une instance d’une application ou d’un correctif qui existe dans le contexte d’un autre utilisateur (managé ou non géré).</span><span class="sxs-lookup"><span data-stu-id="3c980-121">Non-administrators cannot modify the source list of an instance of an application or patch that exists under another user's per-user (managed or unmanaged) context.</span></span> <span data-ttu-id="3c980-122">Les non-administrateurs peuvent modifier les listes sources d’une instance d’une application ou d’un correctif installé dans les contextes suivants :</span><span class="sxs-lookup"><span data-stu-id="3c980-122">Non-administrators can modify the source lists of an instance of an application or patch installed under the following contexts:</span></span>

-   <span data-ttu-id="3c980-123">Leur propre contexte par utilisateur (non managé).</span><span class="sxs-lookup"><span data-stu-id="3c980-123">Their own per-user(unmanaged) context.</span></span>
-   <span data-ttu-id="3c980-124">Le contexte de l’ordinateur, mais uniquement si les stratégies [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md)et [AlwaysInstallElevated a](alwaysinstallelevated.md) les permettent de rechercher une source d’application ou de correctif.</span><span class="sxs-lookup"><span data-stu-id="3c980-124">The machine context, but only if the [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md), and [AlwaysInstallElevated](alwaysinstallelevated.md) policies allows them to browse for an application or patch source.</span></span>
-   <span data-ttu-id="3c980-125">Leur propre contexte géré par utilisateur, mais uniquement si les stratégies [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md)et [AlwaysInstallElevated a](alwaysinstallelevated.md) leur permettent de rechercher une source d’application ou de correctif.</span><span class="sxs-lookup"><span data-stu-id="3c980-125">Their own per-user managed context, but only if the [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md), and [AlwaysInstallElevated](alwaysinstallelevated.md) policies allows them to browse for an application or patch source.</span></span>

<span data-ttu-id="3c980-126">Les administrateurs peuvent modifier les listes de sources qu’un non-administrateur peut modifier.</span><span class="sxs-lookup"><span data-stu-id="3c980-126">Administrators can modify any source list that a non-administrator can modify.</span></span> <span data-ttu-id="3c980-127">En outre, les administrateurs et les applications qui possèdent des privilèges d’administrateur peuvent modifier les listes sources d’une application ou d’un correctif installé dans les contextes suivants :</span><span class="sxs-lookup"><span data-stu-id="3c980-127">In addition, administrators and applications that have administrative privileges can modify the source lists of an application or patch installed under the following contexts:</span></span>

-   <span data-ttu-id="3c980-128">Contexte par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-128">Per-machine context.</span></span>
-   <span data-ttu-id="3c980-129">Leur propre utilisateur (non managé) ou son propre contexte géré par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-129">Their own per-user (unmanaged) or their own per-user managed context.</span></span>
-   <span data-ttu-id="3c980-130">Contexte géré par utilisateur d’un autre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-130">Another user's per-user managed context.</span></span>

> [!Note]  
> <span data-ttu-id="3c980-131">Les utilisateurs et les applications qui ont des privilèges d’administration ne peuvent pas modifier la liste source d’une instance d’une application ou d’un correctif installé dans le contexte par utilisateur (non géré) d’un autre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-131">Users and applications that have administrative privileges cannot modify the source list of an instance of an application or patch installed in the per-user (unmanaged) context of another user.</span></span>

 

## <a name="managing-network-and-url-sources-for-products-and-patches"></a><span data-ttu-id="3c980-132">Gestion des sources de réseau et d’URL pour les produits et les correctifs</span><span class="sxs-lookup"><span data-stu-id="3c980-132">Managing Network and URL sources for Products and Patches</span></span>

<span data-ttu-id="3c980-133">Utilisez la fonction [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) pour ajouter ou réorganiser la liste source des sources réseau et URL pour un correctif ou une application dans un contexte particulier.</span><span class="sxs-lookup"><span data-stu-id="3c980-133">Use the [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to add or reorder the source list of network and URL sources for a patch or application in a particular context.</span></span> <span data-ttu-id="3c980-134">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation.</span><span class="sxs-lookup"><span data-stu-id="3c980-134">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="3c980-135">Utilisez le paramètre *szUserSid* pour spécifier le contexte de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-135">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="3c980-136">Utilisez la fonction [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) pour créer une liste source pour un correctif qui n’a pas encore été appliqué à une application dans le contexte spécifié.</span><span class="sxs-lookup"><span data-stu-id="3c980-136">Use the [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to create a source list for a patch that has not yet been applied to any application in the specified context.</span></span> <span data-ttu-id="3c980-137">Cela peut être utile lors de l’inscription d’un correctif à des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="3c980-137">This can be useful when registering a patch to have elevated privileges.</span></span> <span data-ttu-id="3c980-138">Pour plus d’informations sur l’inscription des privilèges élevés pour un correctif, consultez Mise à [jour corrective Per-User applications gérées](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="3c980-138">For more information about registering elevated privileges for a patch, see [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

<span data-ttu-id="3c980-139">Utilisez la fonction [**MsiSourceListClearSource**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea) pour supprimer une source existante pour une application ou un correctif dans un contexte spécifié.</span><span class="sxs-lookup"><span data-stu-id="3c980-139">Use the [**MsiSourceListClearSource**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea) function to remove an existing source for an application or patch in a specified context.</span></span> <span data-ttu-id="3c980-140">La suppression de la source actuelle d’une application ou d’un correctif force le programme d’installation à rechercher une source dans la liste source la prochaine fois qu’une source est requise.</span><span class="sxs-lookup"><span data-stu-id="3c980-140">Removing the current source for an application or patch forces the installer to search the source list for a source the next time a source is required.</span></span>

<span data-ttu-id="3c980-141">Utilisez la fonction [**MsiSourceListEnumSources**](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa) pour énumérer les sources dans la liste source d’un correctif ou d’une application spécifique.</span><span class="sxs-lookup"><span data-stu-id="3c980-141">Use the [**MsiSourceListEnumSources**](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa) function to enumerate sources in the source list of a specified patch or application.</span></span>

## <a name="managing-media-sources-for-products-and-patches"></a><span data-ttu-id="3c980-142">Gestion des sources multimédias pour les produits et les correctifs</span><span class="sxs-lookup"><span data-stu-id="3c980-142">Managing Media sources for Products and Patches</span></span>

<span data-ttu-id="3c980-143">Utilisez la fonction [**MsiSourceListAddMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska) pour ajouter ou mettre à jour les informations de disque de la source du média d’une application ou d’un correctif inscrit.</span><span class="sxs-lookup"><span data-stu-id="3c980-143">Use the [**MsiSourceListAddMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska) function to add or update the disk information of the media source of a registered application or patch.</span></span> <span data-ttu-id="3c980-144">Chaque entrée est identifiée de manière unique par un ID de disque.</span><span class="sxs-lookup"><span data-stu-id="3c980-144">Each entry is uniquely identified by a disk ID.</span></span> <span data-ttu-id="3c980-145">Si le disque existe déjà, il est mis à jour avec les nouvelles valeurs de nom de volume et d’invite de disque.</span><span class="sxs-lookup"><span data-stu-id="3c980-145">If the disk already exists, it is updated with the new volume label and disk prompt values.</span></span> <span data-ttu-id="3c980-146">Si le disque n’existe pas, une nouvelle entrée de disque est créée avec les nouvelles valeurs.</span><span class="sxs-lookup"><span data-stu-id="3c980-146">If the disk does not exist, a new disk entry is created with the new values.</span></span>

<span data-ttu-id="3c980-147">Utilisez la fonction [**MsiSourceListClearMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska) pour supprimer un disque inscrit existant sous la source du média pour une application ou un correctif dans un contexte spécifique.</span><span class="sxs-lookup"><span data-stu-id="3c980-147">Use the [**MsiSourceListClearMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska) function to remove an existing registered disk under the media source for an application or patch in a specific context.</span></span>

<span data-ttu-id="3c980-148">Utilisez la fonction [**MsiSourceListEnumMediaDisks**](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa) pour énumérer une liste de disques enregistrés sous la source du média pour une application ou un correctif.</span><span class="sxs-lookup"><span data-stu-id="3c980-148">Use the [**MsiSourceListEnumMediaDisks**](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa) function to enumerate a list of disks registered under the media source for an application or patch.</span></span>

## <a name="retrieval-and-modification-of-source-list-information"></a><span data-ttu-id="3c980-149">Récupération et modification des informations de la liste source</span><span class="sxs-lookup"><span data-stu-id="3c980-149">Retrieval and modification of source list information</span></span>

<span data-ttu-id="3c980-150">Utilisez les fonctions [**MsiSourceListGetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa) et [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) pour récupérer ou modifier des informations sur la liste source pour une application ou un correctif dans un contexte spécifique.</span><span class="sxs-lookup"><span data-stu-id="3c980-150">Use the [**MsiSourceListGetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa) and [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) functions to retrieve or modify information about the source list for an application or patch in a specific context.</span></span> <span data-ttu-id="3c980-151">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation.</span><span class="sxs-lookup"><span data-stu-id="3c980-151">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="3c980-152">Utilisez le paramètre *szUserSid* pour spécifier le contexte de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-152">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="3c980-153">Vous pouvez accéder aux propriétés de la liste source, telles que [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType** et **PackageName** .</span><span class="sxs-lookup"><span data-stu-id="3c980-153">Source list properties such as [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType**, and **PackageName** can be accessed.</span></span>

> [!Note]  
> <span data-ttu-id="3c980-154">La propriété de la liste source **LastUsedType** peut uniquement être lue.</span><span class="sxs-lookup"><span data-stu-id="3c980-154">The **LastUsedType** source list property can only be read.</span></span> <span data-ttu-id="3c980-155">Elle ne peut pas être définie directement à l’aide de la fonction [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) .</span><span class="sxs-lookup"><span data-stu-id="3c980-155">It cannot be set directly using the [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) function.</span></span>

 

## <a name="clearing-the-complete-source-list-or-forcing-a-source-resolution"></a><span data-ttu-id="3c980-156">Effacement de la liste source complète ou forçage d’une résolution source</span><span class="sxs-lookup"><span data-stu-id="3c980-156">Clearing the complete source list or forcing a source resolution</span></span>

<span data-ttu-id="3c980-157">Utilisez la fonction [**MsiSourceListClearAllEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa) pour supprimer toutes les sources existantes d’un type de source donné pour l’application ou l’instance de correctif spécifiée.</span><span class="sxs-lookup"><span data-stu-id="3c980-157">Use the [**MsiSourceListClearAllEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa) function to remove all the existing sources of a given source type for the specified application or patch instance.</span></span> <span data-ttu-id="3c980-158">L’inscription du correctif est également supprimée si le correctif n’est pas installé par une application dans le même contexte.</span><span class="sxs-lookup"><span data-stu-id="3c980-158">The patch registration is also removed if the patch is not installed by any application in the same context.</span></span> <span data-ttu-id="3c980-159">Utilisez le paramètre *dwContext* pour spécifier le contexte d’installation.</span><span class="sxs-lookup"><span data-stu-id="3c980-159">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="3c980-160">Utilisez le paramètre *szUserSid* pour spécifier le contexte de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c980-160">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="3c980-161">Utilisez [**MsiSourceListForceResolutionEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) pour effacer la dernière entrée source utilisée pour une application ou un correctif dans le contexte spécifié.</span><span class="sxs-lookup"><span data-stu-id="3c980-161">Use the [**MsiSourceListForceResolutionEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) to clear the last used source entry for an application or patch in the specified context.</span></span> <span data-ttu-id="3c980-162">Cette fonction supprime l’inscription de la propriété appelée **LastUsedSource**.</span><span class="sxs-lookup"><span data-stu-id="3c980-162">This function removes the registration of the property called **LastUsedSource**.</span></span> <span data-ttu-id="3c980-163">Cette fonction n’affecte pas la liste des sources inscrites.</span><span class="sxs-lookup"><span data-stu-id="3c980-163">This function does not affect the registered source list.</span></span> <span data-ttu-id="3c980-164">La désactivation de l’inscription **LastUsedSource** force le programme d’installation à effectuer une résolution de la source par rapport aux sources inscrites la prochaine fois qu’il requiert la source.</span><span class="sxs-lookup"><span data-stu-id="3c980-164">Clearing the **LastUsedSource** registration forces the installer to do a source resolution against the registered sources the next time it requires the source.</span></span>

 

 



