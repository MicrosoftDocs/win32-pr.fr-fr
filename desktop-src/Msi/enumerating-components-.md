---
description: Windows Installer 5,0 s’exécutant sur Windows Server 2008 R2 ou Windows 7 peuvent énumérer tous les composants installés sur l’ordinateur et obtenir le chemin d’accès à la clé du composant.
ms.assetid: a6676340-1695-48c7-a1e4-7a02a7bc3fef
title: Énumération des composants
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea314ee91c35fb021f5a8da64b6430e8cf950ecd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103755420"
---
# <a name="enumerating-components"></a><span data-ttu-id="dba7b-103">Énumération des composants</span><span class="sxs-lookup"><span data-stu-id="dba7b-103">Enumerating Components</span></span>

<span data-ttu-id="dba7b-104">Windows Installer 5,0 s’exécutant sur Windows Server 2008 R2 ou Windows 7 peuvent énumérer tous les composants installés sur l’ordinateur et obtenir le chemin d’accès à la clé du composant.</span><span class="sxs-lookup"><span data-stu-id="dba7b-104">Windows Installer 5.0 running on Windows Server 2008 R2 or Windows 7 can enumerate all components installed on the computer and obtain the key path for the component.</span></span> <span data-ttu-id="dba7b-105">Un package créé pour Windows Installer 5,0 peut utiliser les fonctions [**MsiEnumComponentsEx**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa), [**MsiEnumClientsEx**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa)et [**MsiGetComponentPathEx**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa) pour rechercher des composants et des produits dans les comptes d’utilisateur et les contextes d’installation.</span><span class="sxs-lookup"><span data-stu-id="dba7b-105">A package authored for Windows Installer 5.0 can use the [**MsiEnumComponentsEx**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa), [**MsiEnumClientsEx**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa), and [**MsiGetComponentPathEx**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa) functions to search for components and products across user accounts and installation contexts.</span></span> <span data-ttu-id="dba7b-106">Les fonctions [**MsiEnumComponents**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsa), [**MsiEnumClients**](/windows/desktop/api/Msi/nf-msi-msienumclientsa)et [**MsiGetComponentPath**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha) retournent uniquement des informations sur les composants et les produits installés pour le compte d’utilisateur qui a appelé la fonction.</span><span class="sxs-lookup"><span data-stu-id="dba7b-106">The [**MsiEnumComponents**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsa), [**MsiEnumClients**](/windows/desktop/api/Msi/nf-msi-msienumclientsa), and [**MsiGetComponentPath**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha) functions only return information for components and products installed for the user account that called the function.</span></span> <span data-ttu-id="dba7b-107">Plusieurs appels à ces fonctions, au moins une fois pour chaque compte d’utilisateur, sont nécessaires pour collecter des informations sur l’ordinateur entier.</span><span class="sxs-lookup"><span data-stu-id="dba7b-107">Multiple calls to these functions, at least once for each user account, are required to collect information for the entire computer.</span></span>

<span data-ttu-id="dba7b-108">La fonction [**MsiEnumComponentsEx**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa) énumère les composants installés.</span><span class="sxs-lookup"><span data-stu-id="dba7b-108">The [**MsiEnumComponentsEx**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa) function enumerates installed components.</span></span> <span data-ttu-id="dba7b-109">La fonction récupère un code de composant chaque fois qu’elle est appelée.</span><span class="sxs-lookup"><span data-stu-id="dba7b-109">The function retrieves one component code each time it is called.</span></span> <span data-ttu-id="dba7b-110">L' [**objet Component**](components.md) reçoit des informations sur un composant installé par cette fonction.</span><span class="sxs-lookup"><span data-stu-id="dba7b-110">The [**Component Object**](components.md) receives information about an installed component by this function.</span></span>

<span data-ttu-id="dba7b-111">La fonction [**MsiEnumClientsEx**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa) énumère les produits qui sont des clients d’un composant installé spécifié.</span><span class="sxs-lookup"><span data-stu-id="dba7b-111">The [**MsiEnumClientsEx**](/windows/desktop/api/Msi/nf-msi-msienumclientsexa) function enumerates products that are clients of a specified installed component.</span></span> <span data-ttu-id="dba7b-112">L' [**objet client**](client.md) reçoit des informations sur un client par cette fonction.</span><span class="sxs-lookup"><span data-stu-id="dba7b-112">The [**Client Object**](client.md) receives information about a client by this function.</span></span>

<span data-ttu-id="dba7b-113">La fonction [**MsiGetComponentPathEx**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa) retourne le chemin d’accès complet à un composant installé.</span><span class="sxs-lookup"><span data-stu-id="dba7b-113">The [**MsiGetComponentPathEx**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa) function returns the full path to an installed component.</span></span> <span data-ttu-id="dba7b-114">La fonction retourne la clé de Registre si le chemin d’accès de la clé du composant est une clé de registre.</span><span class="sxs-lookup"><span data-stu-id="dba7b-114">The function returns the registry key if the key path for the component is a registry key.</span></span> <span data-ttu-id="dba7b-115">L' [**objet ComponentInfo**](componentinfo.md) reçoit des informations sur un composant installé par cette fonction.</span><span class="sxs-lookup"><span data-stu-id="dba7b-115">The [**ComponentInfo Object**](componentinfo.md) receives information about an installed component by this function.</span></span>

<span data-ttu-id="dba7b-116">**[Windows Installer 4,5 ou version antérieure](not-supported-in-windows-installer-4-5.md):** Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="dba7b-116">**[Windows Installer 4.5 or earlier](not-supported-in-windows-installer-4-5.md):** Not supported.</span></span> <span data-ttu-id="dba7b-117">Cette fonctionnalité est disponible à partir de Windows Installer 5,0 s’exécutant sur Windows 7 ou Windows Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="dba7b-117">This functionality is available beginning with Windows Installer 5.0 running on Windows 7 or Windows Server 2008 R2.</span></span>

 

 



