---
description: Lors de la création d’un package d’installation, vous pouvez utiliser la fonction MsiViewModify ou la méthode View. Modify pour vous assurer que les données que vous entrez sont syntaxiquement correctes.
ms.assetid: c960e9df-dcd6-44d2-8662-40a1dea81f45
title: Validation interne
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca3c1a9e6f7b7e35b4d7d91287af64eff7812de6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104112259"
---
# <a name="internal-validation"></a><span data-ttu-id="4159b-103">Validation interne</span><span class="sxs-lookup"><span data-stu-id="4159b-103">Internal Validation</span></span>

<span data-ttu-id="4159b-104">Lors de la création d’un package d’installation, vous pouvez utiliser la fonction [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) ou la méthode View. Modify pour vous assurer que les données que vous entrez sont syntaxiquement correctes.</span><span class="sxs-lookup"><span data-stu-id="4159b-104">When authoring an installation package, you can use the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function or the View.Modify method to ensure that the data you enter is syntactically correct.</span></span> <span data-ttu-id="4159b-105">Pour plus d’informations, consultez [**Modify, méthode**](view-modify.md).</span><span class="sxs-lookup"><span data-stu-id="4159b-105">For more information, see [**Modify method**](view-modify.md).</span></span> <span data-ttu-id="4159b-106">Au niveau le plus bas, la colonne d’une table de base de données peut stocker des entiers (courts ou longs), des chaînes ou des données binaires.</span><span class="sxs-lookup"><span data-stu-id="4159b-106">At the lowest level, a database table's column can store integers (short or long), strings, or binary data.</span></span> <span data-ttu-id="4159b-107">Toutefois, un package d’installation requiert des entiers ou des chaînes spécifiques dans certaines tables.</span><span class="sxs-lookup"><span data-stu-id="4159b-107">However, an installation package requires specific integers or strings in certain tables.</span></span> <span data-ttu-id="4159b-108">Ces spécifications sont conservées dans le [ \_ tableau de validation](-validation-table.md).</span><span class="sxs-lookup"><span data-stu-id="4159b-108">These specifications are maintained in the [\_Validation table](-validation-table.md).</span></span> <span data-ttu-id="4159b-109">Par exemple, la colonne de nom de [fichier](file-table.md) de la table de fichiers est une colonne de chaîne, mais elle stocke spécifiquement un nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="4159b-109">For example, the FileName column of the [File table](file-table.md) is a string column, but it specifically stores a file name.</span></span> <span data-ttu-id="4159b-110">Par conséquent, non seulement votre entrée doit être une chaîne, mais elle doit également respecter la configuration requise pour nommer les fichiers.</span><span class="sxs-lookup"><span data-stu-id="4159b-110">Therefore, not only should your entry be a string, but it should also follow the requirements for naming files.</span></span>

<span data-ttu-id="4159b-111">Les différentes valeurs enum de validation utilisées avec la fonction [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) autorisent la validation immédiate à différents niveaux.</span><span class="sxs-lookup"><span data-stu-id="4159b-111">The various validation enum values used with the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function allow for immediate validation at different levels.</span></span> <span data-ttu-id="4159b-112">L' \_ énumération du champ Validate MSIMODIFY \_ peut être utilisée pour valider des champs individuels d’un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="4159b-112">The MSIMODIFY\_VALIDATE\_FIELD enum can be used to validate individual fields of a record.</span></span> <span data-ttu-id="4159b-113">Elle ne valide pas les clés étrangères.</span><span class="sxs-lookup"><span data-stu-id="4159b-113">It does not validate foreign keys.</span></span> <span data-ttu-id="4159b-114">L' \_ enum MSIMODIFY Validate valide une ligne entière et comprend la validation de la clé étrangère.</span><span class="sxs-lookup"><span data-stu-id="4159b-114">The MSIMODIFY\_VALIDATE enum validates an entire row and includes foreign key validation.</span></span> <span data-ttu-id="4159b-115">Si vous insérez une nouvelle ligne dans une table, utilisez l’MSIMODIFY \_ valider une \_ nouvelle énumération pour vérifier que vous ajoutez des données valides et que vous utilisez des clés primaires uniques.</span><span class="sxs-lookup"><span data-stu-id="4159b-115">If you are inserting a new row into a table, use the MSIMODIFY\_VALIDATE\_NEW enum to verify that you are adding valid data as well as using unique primary keys.</span></span> <span data-ttu-id="4159b-116">Une insertion échoue si les clés primaires ne sont pas uniques.</span><span class="sxs-lookup"><span data-stu-id="4159b-116">An insert fails if the primary keys are not unique.</span></span> <span data-ttu-id="4159b-117">Si un appel à **MsiViewModify** avec l’une des énumérations de validation retourne une erreur, vous pouvez effectuer des appels répétés à [**MsiViewGetError**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) pour diagnostiquer le problème.</span><span class="sxs-lookup"><span data-stu-id="4159b-117">If a call to **MsiViewModify** with one of the validation enums returns an error, you can make repeated calls to [**MsiViewGetError**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) for diagnosing the problem.</span></span> <span data-ttu-id="4159b-118">**MsiViewGetError** indique la colonne dans laquelle l’erreur s’est produite, ainsi que la valeur enum pour aider à résoudre le problème.</span><span class="sxs-lookup"><span data-stu-id="4159b-118">**MsiViewGetError** indicates the column where the error occurred as well as the enum value to help fix the problem.</span></span> <span data-ttu-id="4159b-119">Pour plus d’informations, consultez [**méthode GetError**](view-geterror.md).</span><span class="sxs-lookup"><span data-stu-id="4159b-119">For more information, see [**GetError method**](view-geterror.md).</span></span>

<span data-ttu-id="4159b-120">Vous pouvez également utiliser la validation interne pour vous assurer que les autres auteurs entrent correctement les données dans votre table personnalisée.</span><span class="sxs-lookup"><span data-stu-id="4159b-120">You can also use internal validation to ensure that other authors enter data correctly into your custom table.</span></span> <span data-ttu-id="4159b-121">Ajoutez chacune des colonnes de votre table personnalisée à la \_ table de validation en utilisant le nom de la table et le nom de la colonne personnalisés comme clé primaire.</span><span class="sxs-lookup"><span data-stu-id="4159b-121">Add each of the columns of your custom table to the \_Validation table using the custom table name and column name as the primary key.</span></span> <span data-ttu-id="4159b-122">Fournissez une description ou un objectif de chaque colonne dans la colonne Description du \_ tableau de validation.</span><span class="sxs-lookup"><span data-stu-id="4159b-122">Provide a description or purpose of each column in the Description column of the \_Validation table.</span></span> <span data-ttu-id="4159b-123">Entrez les exigences applicables à chaque colonne en utilisant les colonnes Nullable, MinValue, MaxValue, keytable, KeyColumn, Category et set :</span><span class="sxs-lookup"><span data-stu-id="4159b-123">Enter the applicable requirements for each column using the Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Category, and Set columns:</span></span>

-   <span data-ttu-id="4159b-124">Si la colonne accepte la valeur null, entrez un « Y ».</span><span class="sxs-lookup"><span data-stu-id="4159b-124">If the column is Nullable, enter a 'Y'.</span></span> <span data-ttu-id="4159b-125">Si ce n’est pas le cas, entrez un « N ».</span><span class="sxs-lookup"><span data-stu-id="4159b-125">If not, enter a 'N'.</span></span>
-   <span data-ttu-id="4159b-126">Si la colonne est une colonne d’entiers et peut contenir une plage d’entiers, entrez cette plage à l’aide des colonnes MinValue et MaxValue.</span><span class="sxs-lookup"><span data-stu-id="4159b-126">If the column is an integer column and can contain a range of integers, enter that range using the MinValue and MaxValue columns.</span></span>
-   <span data-ttu-id="4159b-127">Les colonnes clés étrangères sont identifiées à l’aide des colonnes keytable et KeyColumn.</span><span class="sxs-lookup"><span data-stu-id="4159b-127">Foreign key columns are identified using the KeyTable and KeyColumn columns.</span></span>
-   <span data-ttu-id="4159b-128">Pour les colonnes de type chaîne, spécifiez une catégorie telle que nom de fichier, GUID ou identificateur.</span><span class="sxs-lookup"><span data-stu-id="4159b-128">For string columns, specify a Category such as Filename, GUID, or Identifier.</span></span> <span data-ttu-id="4159b-129">Pour plus d’informations, consultez [types de données des colonnes](column-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="4159b-129">For more information, see [column data types](column-data-types.md).</span></span>
-   <span data-ttu-id="4159b-130">Si les données ne peuvent concerner qu’un nombre spécifique de valeurs (chaîne ou entier), utilisez la colonne définir pour répertorier les valeurs acceptables.</span><span class="sxs-lookup"><span data-stu-id="4159b-130">If the data can only pertain to a specific number of values (string or integer), use the Set column to list the acceptable values.</span></span>

<span data-ttu-id="4159b-131">La liste suivante répertorie les colonnes (en plus de la table, de la colonne et de la description) de la \_ table de validation qui peuvent être renseignées si votre colonne est du type spécifié.</span><span class="sxs-lookup"><span data-stu-id="4159b-131">The following is a list of the columns (in addition to Table, Column, and Description) in the \_Validation table that can be filled in if your column is of the specified type.</span></span> <span data-ttu-id="4159b-132">(Notez que vous n’avez pas besoin de renseigner toutes les colonnes.)</span><span class="sxs-lookup"><span data-stu-id="4159b-132">(Note that you do not have to fill in all the columns.)</span></span>



| <span data-ttu-id="4159b-133">Type</span><span class="sxs-lookup"><span data-stu-id="4159b-133">Type</span></span>    | <span data-ttu-id="4159b-134">Colonnes</span><span class="sxs-lookup"><span data-stu-id="4159b-134">Columns</span></span>                                                          |
|---------|------------------------------------------------------------------|
| <span data-ttu-id="4159b-135">Integer</span><span class="sxs-lookup"><span data-stu-id="4159b-135">Integer</span></span> | <span data-ttu-id="4159b-136">Nullable, MinValue, MaxValue, keytable, KeyColumn, Set</span><span class="sxs-lookup"><span data-stu-id="4159b-136">Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Set</span></span>           |
| <span data-ttu-id="4159b-137">String</span><span class="sxs-lookup"><span data-stu-id="4159b-137">String</span></span>  | <span data-ttu-id="4159b-138">Nullable, keytable, KeyColumn, Category, Set, MinValue, MaxValue</span><span class="sxs-lookup"><span data-stu-id="4159b-138">Nullable, KeyTable, KeyColumn, Category, Set, MinValue, MaxValue</span></span> |
| <span data-ttu-id="4159b-139">Binary</span><span class="sxs-lookup"><span data-stu-id="4159b-139">Binary</span></span>  | <span data-ttu-id="4159b-140">Nullable, Category (la catégorie doit être « Binary »)</span><span class="sxs-lookup"><span data-stu-id="4159b-140">Nullable, Category (Category must be "Binary")</span></span>                   |



 

<span data-ttu-id="4159b-141">Les environnements de création peuvent utiliser MSIMODIFY \_ valider la \_ suppression.</span><span class="sxs-lookup"><span data-stu-id="4159b-141">Authoring environments may make use of MSIMODIFY\_VALIDATE\_DELETE.</span></span> <span data-ttu-id="4159b-142">Cet enum part du principe que vous souhaitez supprimer la ligne.</span><span class="sxs-lookup"><span data-stu-id="4159b-142">This enum assumes that you want to delete the row.</span></span> <span data-ttu-id="4159b-143">Aucune validation de champ ou de clé étrangère n’est effectuée.</span><span class="sxs-lookup"><span data-stu-id="4159b-143">No field or foreign key validation is performed.</span></span> <span data-ttu-id="4159b-144">Cette énumération effectue en fait une validation de clé étrangère inverse.</span><span class="sxs-lookup"><span data-stu-id="4159b-144">This enum actually performs a reverse foreign key validation.</span></span> <span data-ttu-id="4159b-145">Il vérifie la \_ table de validation pour rechercher des références dans les colonnes keytable et KeyColumn de la table à laquelle appartient la ligne « Deleted ».</span><span class="sxs-lookup"><span data-stu-id="4159b-145">It checks the \_Validation table for references in the KeyTable and KeyColumn columns for the table to which the "deleted" row belongs.</span></span> <span data-ttu-id="4159b-146">S’il existe des colonnes qui répertorient la table contenant la ligne « supprimée » comme clé étrangère potentielle, elle parcourt cette colonne pour voir si des valeurs font référence à des valeurs dans la ligne « supprimée ».</span><span class="sxs-lookup"><span data-stu-id="4159b-146">If there are columns that list the table containing the "deleted" row as a potential foreign key, it cycles through that column to see if any of the values reference values in the "deleted" row.</span></span> <span data-ttu-id="4159b-147">Une erreur de retour signifie que vous rompez l’intégrité relationnelle de la base de données en supprimant la ligne.</span><span class="sxs-lookup"><span data-stu-id="4159b-147">An error return means that you break the relational integrity of the database by deleting the row.</span></span>

 

 



