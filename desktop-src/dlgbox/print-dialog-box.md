---
title: Boîte de dialogue Imprimer
description: La boîte de dialogue Imprimer permet à l’utilisateur de sélectionner des options pour un travail d’impression particulier.
ms.assetid: 34f69b25-8a89-4322-af4c-a80b85a4a973
keywords:
- Interface utilisateur Windows, entrée utilisateur
- Interface utilisateur Windows, bibliothèque de boîtes de dialogue communes
- entrée utilisateur, bibliothèque de boîtes de dialogue communes
- capture de l’entrée utilisateur, bibliothèque de boîtes de dialogue communes
- Bibliothèque de boîtes de dialogue communes
- boîtes de dialogue communes
- Boîte de dialogue Imprimer
- Boîte de dialogue Configuration de l’impression
- personnalisation de la boîte de dialogue Imprimer
- boîtes de dialogue prédéfinies
- boîtes de dialogue, imprimer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fae1dd244391ea16478a0cb4f10803cf622dc64
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104102297"
---
# <a name="print-dialog-box"></a><span data-ttu-id="c17e0-114">Boîte de dialogue Imprimer</span><span class="sxs-lookup"><span data-stu-id="c17e0-114">Print Dialog Box</span></span>

<span data-ttu-id="c17e0-115">La boîte de dialogue **Imprimer** permet à l’utilisateur de sélectionner des options pour un travail d’impression particulier.</span><span class="sxs-lookup"><span data-stu-id="c17e0-115">The **Print** dialog box lets the user select options for a particular print job.</span></span> <span data-ttu-id="c17e0-116">Par exemple, l’utilisateur peut spécifier l’imprimante à utiliser, la plage de pages à imprimer et le nombre de copies.</span><span class="sxs-lookup"><span data-stu-id="c17e0-116">For example, the user can specify the printer to use, the range of pages to print, and the number of copies.</span></span>

<span data-ttu-id="c17e0-117">Vous pouvez utiliser la fonction [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) pour afficher une [feuille de propriétés d’impression](print-property-sheet.md), qui contient une page **générale** contenant des contrôles similaires à ceux de la boîte de dialogue **Imprimer** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-117">You can use the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function to display a [Print Property Sheet](print-property-sheet.md), which has a **General** page containing controls similar to the **Print** dialog box.</span></span> <span data-ttu-id="c17e0-118">La feuille de propriétés peut également contenir des pages de propriétés supplémentaires spécifiques à l’application et spécifiques au pilote, à la suite de la page **général** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-118">The property sheet can also have additional application-specific and driver-specific property pages following the **General** page.</span></span>

<span data-ttu-id="c17e0-119">Vous créez et affichez une boîte de dialogue **Imprimer** en initialisant une structure [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) et en transmettant la structure à la fonction [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="c17e0-119">You create and display a **Print** dialog box by initializing a [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure and passing the structure to the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span>

<span data-ttu-id="c17e0-120">L’illustration suivante montre une boîte de dialogue **Imprimer** standard.</span><span class="sxs-lookup"><span data-stu-id="c17e0-120">The following illustration shows a typical **Print** dialog box.</span></span>

![boîte de dialogue Imprimer](images/printdialogboxxp.png)

<span data-ttu-id="c17e0-122">Si l’utilisateur clique sur le bouton **OK** , [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retourne **true** et utilise la structure [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) pour retourner des informations sur les sélections de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c17e0-122">If the user clicks the **OK** button, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns **TRUE** and uses the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure to return information about the user's selections.</span></span> <span data-ttu-id="c17e0-123">Par exemple, les membres **hDevMode** et **hDevNames** retournent généralement des handles de mémoire globaux pour les structures et [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="c17e0-123">For example, the **hDevMode** and **hDevNames** members typically return global memory handles for and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="c17e0-124">Vous pouvez utiliser les informations de ces structures pour créer un contexte de périphérique ou un contexte d’informations pour l’imprimante sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="c17e0-124">You can use the information in these structures to create a device context or an information context for the selected printer.</span></span>

<span data-ttu-id="c17e0-125">Si l’utilisateur annule la boîte de dialogue **Imprimer** ou si une erreur se produit, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retourne la **valeur false**.</span><span class="sxs-lookup"><span data-stu-id="c17e0-125">If the user cancels the **Print** dialog box or an error occurs, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="c17e0-126">Vous pouvez déterminer la cause d’une erreur en utilisant la fonction [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) pour récupérer la valeur d’erreur étendue.</span><span class="sxs-lookup"><span data-stu-id="c17e0-126">You can determine the cause of an error by using the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="c17e0-127">La boîte de dialogue **Imprimer** comprend un groupe d' **étendues** de cases d’option qui indiquent si l’utilisateur souhaite imprimer toutes les pages, une plage de pages ou uniquement le texte sélectionné.</span><span class="sxs-lookup"><span data-stu-id="c17e0-127">The **Print** dialog box includes a **Print Range** group of radio buttons that indicate whether the user wants to print all pages, a range of pages, or only the selected text.</span></span> <span data-ttu-id="c17e0-128">Avant d’appeler [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)), vous pouvez définir l’un des indicateurs **PD \_ ALLPAGES**, **PD \_ Selection** ou **PD \_ PAGENUMS** pour indiquer quel bouton est initialement sélectionné.</span><span class="sxs-lookup"><span data-stu-id="c17e0-128">Before calling [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)), you can set one of the **PD\_ALLPAGES**, **PD\_SELECTION**, or **PD\_PAGENUMS** flags to indicate which button is initially selected.</span></span> <span data-ttu-id="c17e0-129">Quand **PrintDlg** retourne la **valeur true**, la fonction définit l’un de ces indicateurs pour indiquer les sélections de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c17e0-129">When **PrintDlg** returns **TRUE**, the function sets one of these flags to indicate the user's selections.</span></span> <span data-ttu-id="c17e0-130">Si **PD \_ PAGENUMS** est défini, les membres **nFromPage** et **nToPage** de la structure [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) contiennent les pages de début et de fin spécifiées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c17e0-130">If **PD\_PAGENUMS** is set, the **nFromPage** and **nToPage** members of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure contain the starting and ending pages specified by the user.</span></span> <span data-ttu-id="c17e0-131">Pour désactiver la case **d'** option **pages** et les contrôles associés from et **to** Edit, définissez l’indicateur **PD \_ NOPAGENUMS** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-131">To disable the **Pages** radio button and its associated **From** and **To** edit controls, set the **PD\_NOPAGENUMS** flag.</span></span> <span data-ttu-id="c17e0-132">Pour désactiver la case d’option **sélection** , définissez l’indicateur **PD \_ noselect** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-132">To disable the **Selection** radio button, set the **PD\_NOSELECTION** flag.</span></span>

<span data-ttu-id="c17e0-133">La boîte de dialogue comprend un contrôle d’édition dans lequel l’utilisateur peut taper le nombre de copies à imprimer.</span><span class="sxs-lookup"><span data-stu-id="c17e0-133">The dialog box includes an edit control in which the user can type the number of copies to print.</span></span> <span data-ttu-id="c17e0-134">Si le membre **hDevMode** de la structure [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) est non **null**, le membre **dmCopies** de la structure spécifie la valeur initiale pour ce contrôle d’édition.</span><span class="sxs-lookup"><span data-stu-id="c17e0-134">If the **hDevMode** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure is non-**NULL**, the **dmCopies** member of the structure specifies the initial value for this edit control.</span></span> <span data-ttu-id="c17e0-135">Si **hDevMode** a la valeur **null**, le membre **nCopies** de la structure **PRINTDLG** spécifie la valeur initiale.</span><span class="sxs-lookup"><span data-stu-id="c17e0-135">If **hDevMode** is **NULL**, the **nCopies** member of the **PRINTDLG** structure specifies the initial value.</span></span> <span data-ttu-id="c17e0-136">Quand [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retourne, **nCopies** indique généralement le nombre de copies spécifiées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c17e0-136">When [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns, **nCopies** typically indicates the number of copies specified by the user.</span></span> <span data-ttu-id="c17e0-137">Toutefois, si vous définissez l' **indicateur \_ PD USEDEVMODECOPIESANDCOLLATE** lors de la création de la boîte de dialogue, **nCopies** a toujours la valeur 1 au retour et le membre **dmCopies** de [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) indique le nombre de copies à imprimer.</span><span class="sxs-lookup"><span data-stu-id="c17e0-137">However, if you set the **PD\_USEDEVMODECOPIESANDCOLLATE** flag when you create the dialog box, **nCopies** is always set to 1 on return and the **dmCopies** member of [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) indicates the number of copies to print.</span></span>

<span data-ttu-id="c17e0-138">La case à cocher **assembler** indique si l’utilisateur souhaite reclasser les pages si plusieurs copies sont imprimées.</span><span class="sxs-lookup"><span data-stu-id="c17e0-138">The **Collate** check box indicates whether the user wants to collate the pages if multiple copies are being printed.</span></span> <span data-ttu-id="c17e0-139">L’indicateur de **\_ classement PD** est défini si la case à cocher **assembler** est activée.</span><span class="sxs-lookup"><span data-stu-id="c17e0-139">The **PD\_COLLATE** flag is set if the **Collate** check box is selected.</span></span> <span data-ttu-id="c17e0-140">Si votre application ne prend pas en charge plusieurs copies ou un classement simulé, définissez l’indicateur **PD \_ USEDEVMODECOPIESANDCOLLATE** dans le membre **Flags** de la structure [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="c17e0-140">If your application does not support multiple copies or simulated collation, set the **PD\_USEDEVMODECOPIESANDCOLLATE** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="c17e0-141">Cela désactive la case à cocher **assembler** et le **nombre de copies du contrôle d'** édition, sauf si le pilote d’imprimante prend en charge plusieurs copies et classement.</span><span class="sxs-lookup"><span data-stu-id="c17e0-141">This disables the **Collate** check box and the **Number of Copies** edit control unless the printer driver supports multiple copies and collation.</span></span>

<span data-ttu-id="c17e0-142">La case à cocher **Imprimer dans un fichier** indique si l’utilisateur souhaite envoyer la sortie vers un fichier plutôt que vers une imprimante.</span><span class="sxs-lookup"><span data-stu-id="c17e0-142">The **Print To File** check box indicates whether the user wants to send output to a file rather than to a printer.</span></span> <span data-ttu-id="c17e0-143">Vous pouvez définir l’indicateur **PD \_ PRINTTOFILE** pour que la case à cocher soit initialement sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="c17e0-143">You can set the **PD\_PRINTTOFILE** flag so the check box is initially selected.</span></span> <span data-ttu-id="c17e0-144">Pour masquer la case à cocher, définissez l’indicateur **PD \_ HIDEPRINTTOFILE** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-144">To hide the check box, set the **PD\_HIDEPRINTTOFILE** flag.</span></span> <span data-ttu-id="c17e0-145">Pour le désactiver, définissez l’indicateur **PD \_ DISABLEPRINTTOFILE** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-145">To disable it, set the **PD\_DISABLEPRINTTOFILE** flag.</span></span> <span data-ttu-id="c17e0-146">Si l’utilisateur sélectionne l’option **Imprimer dans un fichier** , [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) définit l’indicateur **PD \_ PRINTTOFILE** et retourne « file : » à l’offset indiqué par le membre **wOutputOffset** de la structure [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="c17e0-146">If the user selects the **Print To File** option, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) sets the **PD\_PRINTTOFILE** flag and returns "FILE:" at the offset indicated by the **wOutputOffset** member of the [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure.</span></span> <span data-ttu-id="c17e0-147">Quand vous appelez la fonction pour démarrer l’opération d’impression, spécifiez la chaîne « FILE : » dans le membre **lpszOutput** de la structure.</span><span class="sxs-lookup"><span data-stu-id="c17e0-147">When you call the function to start the printing operation, specify this "FILE:" string in the **lpszOutput** member of the structure.</span></span> <span data-ttu-id="c17e0-148">Si vous spécifiez cette chaîne, le sous-système d’impression interroge l’utilisateur sur le nom du fichier de sortie.</span><span class="sxs-lookup"><span data-stu-id="c17e0-148">Specifying this string causes the print subsystem to query the user for the name of the output file.</span></span>

<span data-ttu-id="c17e0-149">Par défaut, la boîte de dialogue **Imprimer** affiche initialement des informations sur l’imprimante par défaut actuelle.</span><span class="sxs-lookup"><span data-stu-id="c17e0-149">By default, the **Print** dialog box initially displays information about the current default printer.</span></span> <span data-ttu-id="c17e0-150">Pour afficher les informations d’une autre imprimante installée, initialisez une et une structure [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) et attribuez le descripteur de mémoire globale à la structure aux membres **hDevMode** et **hDevNames** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-150">To display information for another installed printer, initialize a and a [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handle to the structure to the **hDevMode** and **hDevNames** members.</span></span> <span data-ttu-id="c17e0-151">Le nom de l’appareil que vous spécifiez dans le membre **dmDeviceName** de la structure [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) et dans le membre **wDriverOffset** de la structure **DEVNAMES** doit identifier un périphérique d’impression qui est également indiqué dans la \[ \] section périphériques du fichier Win.ini.</span><span class="sxs-lookup"><span data-stu-id="c17e0-151">The device name you specify in the **dmDeviceName** member of the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure and in the **wDriverOffset** member of the **DEVNAMES** structure must identify a printer device that is also listed in the \[Devices\] section of the Win.ini file.</span></span> <span data-ttu-id="c17e0-152">Si l’appareil n’est pas listé, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) renvoie une erreur.</span><span class="sxs-lookup"><span data-stu-id="c17e0-152">If the device is not listed, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns an error.</span></span>

<span data-ttu-id="c17e0-153">Vous pouvez demander à [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) de créer un contexte de périphérique ou un contexte d’informations pour l’imprimante en définissant l’indicateur de **\_ retour** **PD \_ RETURNDC** ou PD dans le membre **Flags** de la structure [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="c17e0-153">You can direct [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) to create a device context or information context for the printer by setting the **PD\_RETURNDC** or **PD\_RETURNIC** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="c17e0-154">La fonction retourne un handle vers le contexte de périphérique ou le contexte d’information dans le membre **HDC** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-154">The function returns a handle to the device context or information context in the **hDC** member.</span></span> <span data-ttu-id="c17e0-155">Si vous utilisez l’indicateur **PD \_ RETURNDC** , vous pouvez utiliser le contexte de périphérique pour générer la sortie de l’imprimante.</span><span class="sxs-lookup"><span data-stu-id="c17e0-155">If you use the **PD\_RETURNDC** flag, you can use the device context to generate output for the printer.</span></span>

<span data-ttu-id="c17e0-156">Pour récupérer des informations sur l’imprimante par défaut sans afficher la boîte de dialogue **Imprimer** , définissez l’indicateur **PD \_ RETURNDEFAULT** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-156">To retrieve information about the default printer without displaying the **Print** dialog box, set the **PD\_RETURNDEFAULT** flag.</span></span> <span data-ttu-id="c17e0-157">Dans ce cas, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retourne immédiatement après avoir défini les membres **hDevMode** et **hDevNames** sur Handles pour les structures contenant les informations.</span><span class="sxs-lookup"><span data-stu-id="c17e0-157">In this case, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns immediately after setting the **hDevMode** and **hDevNames** members to handles for structures containing the information.</span></span>

<span data-ttu-id="c17e0-158">Par défaut, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) affiche des boîtes de message lorsque des erreurs se produisent.</span><span class="sxs-lookup"><span data-stu-id="c17e0-158">By default, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) displays message boxes when errors occur.</span></span> <span data-ttu-id="c17e0-159">Par exemple, la fonction affiche un message d’erreur si aucune imprimante n’est installée.</span><span class="sxs-lookup"><span data-stu-id="c17e0-159">For example, the function displays an error message if no printers are installed.</span></span> <span data-ttu-id="c17e0-160">Pour empêcher la fonction d’afficher ces messages d’avertissement, définissez l’indicateur **PD \_ nowarning** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-160">To prevent the function from displaying these warning messages, set the **PD\_NOWARNING** flag.</span></span>

<span data-ttu-id="c17e0-161">Les rubriques suivantes sont présentées dans cette section.</span><span class="sxs-lookup"><span data-stu-id="c17e0-161">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="c17e0-162">Personnalisation de la boîte de dialogue Imprimer</span><span class="sxs-lookup"><span data-stu-id="c17e0-162">Customizing the Print Dialog Box</span></span>](#customizing-the-print-dialog-box)
-   [<span data-ttu-id="c17e0-163">Boîte de dialogue Configuration de l’impression</span><span class="sxs-lookup"><span data-stu-id="c17e0-163">Print Setup Dialog Box</span></span>](#print-setup-dialog-box)

## <a name="customizing-the-print-dialog-box"></a><span data-ttu-id="c17e0-164">Personnalisation de la boîte de dialogue Imprimer</span><span class="sxs-lookup"><span data-stu-id="c17e0-164">Customizing the Print Dialog Box</span></span>

<span data-ttu-id="c17e0-165">Vous pouvez fournir un modèle personnalisé pour la boîte de dialogue **Imprimer** , par exemple, si vous souhaitez inclure des contrôles supplémentaires propres à votre application.</span><span class="sxs-lookup"><span data-stu-id="c17e0-165">You can provide a custom template for the **Print** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="c17e0-166">La fonction [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) utilise votre modèle personnalisé à la place du modèle par défaut.</span><span class="sxs-lookup"><span data-stu-id="c17e0-166">The [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="c17e0-167">Pour fournir un modèle personnalisé pour la boîte de dialogue **Imprimer** :</span><span class="sxs-lookup"><span data-stu-id="c17e0-167">To provide a custom template for the **Print** dialog box:</span></span>

1.  <span data-ttu-id="c17e0-168">Créez le modèle personnalisé en modifiant le modèle par défaut spécifié dans le fichier Prnsetup. dlg.</span><span class="sxs-lookup"><span data-stu-id="c17e0-168">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="c17e0-169">Les identificateurs de contrôle utilisés dans le modèle de boîte de dialogue d' **impression** par défaut sont définis dans le fichier Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="c17e0-169">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="c17e0-170">Utilisez la structure [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) pour activer le modèle comme suit :</span><span class="sxs-lookup"><span data-stu-id="c17e0-170">Use the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="c17e0-171">Si votre modèle personnalisé est une ressource d’une application ou d’une bibliothèque de liens dynamiques, définissez l’indicateur **PD \_ ENABLEPRINTTEMPLATE** dans le membre **Flags** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-171">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="c17e0-172">Utilisez les membres **HINSTANCE** et **lpPrintTemplateName** de la structure pour identifier le nom du module et de la ressource.</span><span class="sxs-lookup"><span data-stu-id="c17e0-172">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="c17e0-173">Ou</span><span class="sxs-lookup"><span data-stu-id="c17e0-173">-Or-</span></span>

    -   <span data-ttu-id="c17e0-174">Si votre modèle personnalisé est déjà en mémoire, définissez l’indicateur **PD \_ ENABLEPRINTTEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-174">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="c17e0-175">Utilisez le membre **hPrintTemplate** pour identifier l’objet mémoire qui contient le modèle.</span><span class="sxs-lookup"><span data-stu-id="c17e0-175">Use the **hPrintTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="c17e0-176">Vous pouvez fournir une procédure de hook [**PrintHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc) pour la boîte de dialogue **Imprimer** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-176">You can provide a [**PrintHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc) hook procedure for the **Print** dialog box.</span></span> <span data-ttu-id="c17e0-177">La procédure de raccordement peut traiter les messages envoyés à la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c17e0-177">The hook procedure can process messages sent to the dialog box.</span></span> <span data-ttu-id="c17e0-178">Il peut également envoyer des messages à la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c17e0-178">It can also send messages to the dialog box.</span></span> <span data-ttu-id="c17e0-179">Si vous utilisez un modèle personnalisé pour définir des contrôles supplémentaires, vous devez fournir une procédure de raccordement pour traiter l’entrée de vos contrôles.</span><span class="sxs-lookup"><span data-stu-id="c17e0-179">If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls.</span></span>

<span data-ttu-id="c17e0-180">Pour activer une procédure de Hook pour la boîte de dialogue **Imprimer** :</span><span class="sxs-lookup"><span data-stu-id="c17e0-180">To enable a hook procedure for the **Print** dialog box:</span></span>

1.  <span data-ttu-id="c17e0-181">Définissez l’indicateur **PD \_ ENABLEPRINTHOOK** dans le membre **Flags** de la structure [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="c17e0-181">Set the **PD\_ENABLEPRINTHOOK** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span>
2.  <span data-ttu-id="c17e0-182">Spécifiez l’adresse de la procédure de raccordement dans le membre **lpfnPrintHook** .</span><span class="sxs-lookup"><span data-stu-id="c17e0-182">Specify the address of the hook procedure in the **lpfnPrintHook** member.</span></span>

<span data-ttu-id="c17e0-183">Après le traitement du message [**WM \_ INITDIALOG**](wm-initdialog.md) , la procédure de la boîte de dialogue envoie un message **WM \_ INITDIALOG** à la procédure de Hook.</span><span class="sxs-lookup"><span data-stu-id="c17e0-183">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the hook procedure.</span></span> <span data-ttu-id="c17e0-184">Le paramètre *lParam* de ce message est un pointeur vers la structure [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) utilisée pour initialiser la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c17e0-184">The *lParam* parameter of this message is a pointer to the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure used to initialize the dialog box.</span></span>

## <a name="print-setup-dialog-box"></a><span data-ttu-id="c17e0-185">Boîte de dialogue Configuration de l’impression</span><span class="sxs-lookup"><span data-stu-id="c17e0-185">Print Setup Dialog Box</span></span>

<span data-ttu-id="c17e0-186">Vous pouvez créer et afficher une boîte de dialogue de configuration de l' **impression** en définissant l’indicateur **PD \_ PRINTSETUP** dans un appel à la fonction [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="c17e0-186">You can create and display a **Print Setup** dialog box by setting the **PD\_PRINTSETUP** flag in a call to the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span> <span data-ttu-id="c17e0-187">Toutefois, la boîte de dialogue Configuration de l' **impression** a été remplacée par la boîte de dialogue **mise en page** et ne doit pas être utilisée dans les nouvelles applications.</span><span class="sxs-lookup"><span data-stu-id="c17e0-187">However, the **Print Setup** dialog box has been superseded by the **Page Setup** dialog box and should not be used in new applications.</span></span>

<span data-ttu-id="c17e0-188">Les indicateurs suivants s’appliquent uniquement à la boîte de dialogue Configuration de l' **impression** :</span><span class="sxs-lookup"><span data-stu-id="c17e0-188">The following flags apply only to the **Print Setup** dialog box:</span></span>

-   <span data-ttu-id="c17e0-189">**PD \_ ENABLESETUPHOOK**</span><span class="sxs-lookup"><span data-stu-id="c17e0-189">**PD\_ENABLESETUPHOOK**</span></span>
-   <span data-ttu-id="c17e0-190">**PD \_ ENABLESETUPTEMPLATE**</span><span class="sxs-lookup"><span data-stu-id="c17e0-190">**PD\_ENABLESETUPTEMPLATE**</span></span>
-   <span data-ttu-id="c17e0-191">**PD \_ ENABLESETUPTEMPLATEHANDLE**</span><span class="sxs-lookup"><span data-stu-id="c17e0-191">**PD\_ENABLESETUPTEMPLATEHANDLE**</span></span>

 

 