---
title: Boîte de dialogue Mise en page
description: Affiche une boîte de dialogue modale qui permet à l’utilisateur de choisir des paramètres qui incluent le type de papier, la source de papier, l’orientation de page et la largeur des marges de page.
ms.assetid: debde0a0-07d4-46ed-a936-e517eab1852d
keywords:
- Interface utilisateur Windows, entrée utilisateur
- Interface utilisateur Windows, bibliothèque de boîtes de dialogue communes
- entrée utilisateur, bibliothèque de boîtes de dialogue communes
- capture de l’entrée utilisateur, bibliothèque de boîtes de dialogue communes
- Bibliothèque de boîtes de dialogue communes
- boîtes de dialogue communes
- Mise en page (boîte de dialogue)
- personnalisation de la boîte de dialogue mise en page
- raccordements, boîte de dialogue mise en page
- boîtes de dialogue prédéfinies
- boîtes de dialogue, mise en page
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4b9a8f7f30a8313017dc3a124cdccb7d00c872b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104102300"
---
# <a name="page-setup-dialog-box"></a><span data-ttu-id="a00a9-114">Boîte de dialogue Mise en page</span><span class="sxs-lookup"><span data-stu-id="a00a9-114">Page Setup Dialog Box</span></span>

<span data-ttu-id="a00a9-115">Affiche une boîte de dialogue modale qui permet à l’utilisateur de définir les attributs suivants de la page imprimée :</span><span class="sxs-lookup"><span data-stu-id="a00a9-115">Displays a modal dialog box that allows the user to set the following attributes of the printed page:</span></span>

-   <span data-ttu-id="a00a9-116">Le type de papier (enveloppe, légal, lettre, etc.)</span><span class="sxs-lookup"><span data-stu-id="a00a9-116">The paper type (envelope, legal, letter, and so on)</span></span>
-   <span data-ttu-id="a00a9-117">Source de papier (alimentation manuelle, alimentation de tracteur, chargeur de feuille, etc.)</span><span class="sxs-lookup"><span data-stu-id="a00a9-117">The paper source (manual feed, tractor feed, sheet feeder, and so on)</span></span>
-   <span data-ttu-id="a00a9-118">Orientation de la page (portrait ou paysage)</span><span class="sxs-lookup"><span data-stu-id="a00a9-118">The page orientation (portrait or landscape)</span></span>
-   <span data-ttu-id="a00a9-119">Largeur des marges de la page</span><span class="sxs-lookup"><span data-stu-id="a00a9-119">The width of the page margins</span></span>

<span data-ttu-id="a00a9-120">Vous créez et affichez une boîte de dialogue **mise en page** en initialisant une structure [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) et en transmettant la structure à la fonction [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="a00a9-120">You create and display a **Page Setup** dialog box by initializing a [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure and passing the structure to the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function.</span></span> <span data-ttu-id="a00a9-121">Toutefois, les attributs présentés dans la boîte de dialogue varient selon les capacités de l’imprimante.</span><span class="sxs-lookup"><span data-stu-id="a00a9-121">However, the attributes presented in the dialog box vary, depending on the capabilities of the printer.</span></span> <span data-ttu-id="a00a9-122">L’illustration suivante montre une boîte de dialogue de **mise en page** classique.</span><span class="sxs-lookup"><span data-stu-id="a00a9-122">The following illustration shows a typical **Page Setup** dialog box.</span></span>

![mise en page, boîte de dialogue](images/pagesetupdialogboxxp.png)

<span data-ttu-id="a00a9-124">Si l’utilisateur clique sur le bouton **OK** , [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) retourne **true** après avoir défini différents membres dans la structure [**PageSetupDlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) pour spécifier les sélections de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a00a9-124">If the user clicks the **OK** button, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **TRUE** after setting various members in the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to specify the user's selections.</span></span> <span data-ttu-id="a00a9-125">Les membres **ptPaperSize** et **rtMargin** contiennent les valeurs spécifiées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a00a9-125">The **ptPaperSize** and **rtMargin** members contain the values specified by the user.</span></span> <span data-ttu-id="a00a9-126">Les membres **hDevMode** et **hDevNames** contiennent des descripteurs de mémoire globaux pour les structures [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) et [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="a00a9-126">The **hDevMode** and **hDevNames** members contain global memory handles for the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="a00a9-127">Ces structures contiennent des informations de page supplémentaires ainsi que des informations sur l’imprimante.</span><span class="sxs-lookup"><span data-stu-id="a00a9-127">These structures contain additional page information as well as information about the printer.</span></span> <span data-ttu-id="a00a9-128">Vous pouvez utiliser ces informations pour préparer la sortie à envoyer à l’imprimante sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="a00a9-128">You can use this information to prepare the output to be sent to the selected printer.</span></span>

<span data-ttu-id="a00a9-129">Si l’utilisateur annule la boîte de dialogue **mise en page** ou si une erreur se produit, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) retourne **false**.</span><span class="sxs-lookup"><span data-stu-id="a00a9-129">If the user cancels the **Page Setup** dialog box or an error occurs, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="a00a9-130">Pour déterminer la cause de l’erreur, appelez la fonction [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) pour récupérer la valeur d’erreur étendue.</span><span class="sxs-lookup"><span data-stu-id="a00a9-130">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="a00a9-131">Cette section décrit les rubriques suivantes.</span><span class="sxs-lookup"><span data-stu-id="a00a9-131">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="a00a9-132">Initialisation de la boîte de dialogue mise en page</span><span class="sxs-lookup"><span data-stu-id="a00a9-132">Initializing the Page Setup Dialog Box</span></span>](#initializing-the-page-setup-dialog-box)
-   [<span data-ttu-id="a00a9-133">Personnalisation de la boîte de dialogue mise en page</span><span class="sxs-lookup"><span data-stu-id="a00a9-133">Customizing the Page Setup Dialog Box</span></span>](#customizing-the-page-setup-dialog-box)
-   [<span data-ttu-id="a00a9-134">Personnalisation de l’exemple de page</span><span class="sxs-lookup"><span data-stu-id="a00a9-134">Customizing the Sample Page</span></span>](#customizing-the-sample-page)

## <a name="initializing-the-page-setup-dialog-box"></a><span data-ttu-id="a00a9-135">Initialisation de la boîte de dialogue mise en page</span><span class="sxs-lookup"><span data-stu-id="a00a9-135">Initializing the Page Setup Dialog Box</span></span>

<span data-ttu-id="a00a9-136">Par défaut, la boîte de dialogue **mise en page** affiche des informations sur l’imprimante par défaut actuelle.</span><span class="sxs-lookup"><span data-stu-id="a00a9-136">By default, the **Page Setup** dialog box displays information about the current default printer.</span></span> <span data-ttu-id="a00a9-137">Pour indiquer à la boîte de dialogue d’afficher des informations sur une imprimante spécifique, définissez les membres d’une structure [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) ou [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) et affectez les descripteurs de mémoire globaux de ces structures au membre correspondant dans [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span><span class="sxs-lookup"><span data-stu-id="a00a9-137">To direct the dialog box to display information about a specific printer, set the members of a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) or [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handles of these structures to the corresponding member in [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span></span> <span data-ttu-id="a00a9-138">Si vous spécifiez le nom d’une imprimante qui n’est pas installée actuellement, la boîte de dialogue affiche un message d’erreur.</span><span class="sxs-lookup"><span data-stu-id="a00a9-138">If you specify the name of a printer that is not currently installed, the dialog box displays an error message.</span></span> <span data-ttu-id="a00a9-139">Pour empêcher la boîte de dialogue d’afficher des messages d’erreur, utilisez la valeur **PSD \_ nowarning** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-139">To prevent the dialog box from displaying error messages, use the **PSD\_NOWARNING** value.</span></span> <span data-ttu-id="a00a9-140">Pour récupérer des informations sur l’imprimante par défaut sans afficher la boîte de dialogue **mise en page** , utilisez la valeur **PSD \_ RETURNDEFAULT** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-140">To retrieve information about the default printer without displaying the **Page Setup** dialog box, use the **PSD\_RETURNDEFAULT** value.</span></span>

<span data-ttu-id="a00a9-141">Si le système de mesure par défaut est pouces, la boîte de dialogue utilise des millièmes de pouce comme unité de mesure par défaut.</span><span class="sxs-lookup"><span data-stu-id="a00a9-141">If the default measurement system is inches, the dialog box uses thousandths of inches as the default unit of measurement.</span></span> <span data-ttu-id="a00a9-142">Si le système de mesure par défaut est métrique, la boîte de dialogue utilise des centièmes de millimètres comme unité de mesure par défaut.</span><span class="sxs-lookup"><span data-stu-id="a00a9-142">If the default measurement system is metric, the dialog box uses hundredths of millimeters as the default unit of measurement.</span></span> <span data-ttu-id="a00a9-143">Pour remplacer l’unité de mesure par défaut, définissez l' **indicateur \_ PSD INHUNDREDTHSOFMILLIMETERS** ou **PSD \_ INTHOUSANDTHSOFINCHES** dans le membre **Flags** de la structure [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="a00a9-143">To override the default unit of measurement, set the **PSD\_INHUNDREDTHSOFMILLIMETERS** or **PSD\_INTHOUSANDTHSOFINCHES** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>

<span data-ttu-id="a00a9-144">Par défaut, les valeurs initiales des marges sont d’un pouce.</span><span class="sxs-lookup"><span data-stu-id="a00a9-144">The initial values for the margins are one inch, by default.</span></span> <span data-ttu-id="a00a9-145">Si vous définissez l’indicateur de **\_ marges PSD** , la boîte de dialogue affiche les valeurs de marge initiale spécifiées dans le membre **rtMargin** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-145">If you set the **PSD\_MARGINS** flag, the dialog box displays the initial margin values specified in the **rtMargin** member.</span></span> <span data-ttu-id="a00a9-146">Les valeurs minimales par défaut que l’utilisateur peut spécifier pour les marges sont les marges minimales autorisées par l’imprimante.</span><span class="sxs-lookup"><span data-stu-id="a00a9-146">The default minimum values that the user can specify for the margins are the minimum margins allowed by the printer.</span></span> <span data-ttu-id="a00a9-147">Si vous définissez l’indicateur **PSD \_ MINMARGINS** , la boîte de dialogue applique les marges minimales spécifiées dans le membre **rtMinMargin** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-147">If you set the **PSD\_MINMARGINS** flag, the dialog box enforces the minimum margins specified in the **rtMinMargin** member.</span></span>

<span data-ttu-id="a00a9-148">Pour empêcher les utilisateurs de sélectionner certaines options, définissez une combinaison des indicateurs suivants pour désactiver les contrôles correspondants.</span><span class="sxs-lookup"><span data-stu-id="a00a9-148">To prevent users from selecting certain options, set any combination of the following flags to disable the corresponding controls.</span></span>



| <span data-ttu-id="a00a9-149">Indicateur</span><span class="sxs-lookup"><span data-stu-id="a00a9-149">Flag</span></span>                        | <span data-ttu-id="a00a9-150">Signification</span><span class="sxs-lookup"><span data-stu-id="a00a9-150">Meaning</span></span>                                                                  |
|-----------------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="a00a9-151">**\_DISABLEMARGINS PSD**</span><span class="sxs-lookup"><span data-stu-id="a00a9-151">**PSD\_DISABLEMARGINS**</span></span>     | <span data-ttu-id="a00a9-152">Désactive les contrôles d’édition dans lesquels l’utilisateur entre les paramètres de marge.</span><span class="sxs-lookup"><span data-stu-id="a00a9-152">Disables the edit controls in which the user enters the margin settings.</span></span> |
| <span data-ttu-id="a00a9-153">**\_DISABLEORIENTATION PSD**</span><span class="sxs-lookup"><span data-stu-id="a00a9-153">**PSD\_DISABLEORIENTATION**</span></span> | <span data-ttu-id="a00a9-154">Désactive les cases d’option **portrait** et **paysage** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-154">Disables the **Portrait** and **Landscape** radio buttons.</span></span>               |
| <span data-ttu-id="a00a9-155">**\_DISABLEPAPER PSD**</span><span class="sxs-lookup"><span data-stu-id="a00a9-155">**PSD\_DISABLEPAPER**</span></span>       | <span data-ttu-id="a00a9-156">Désactive les contrôles permettant de sélectionner le format de papier et la source de papier.</span><span class="sxs-lookup"><span data-stu-id="a00a9-156">Disables the controls for selecting the paper size and paper source.</span></span>     |
| <span data-ttu-id="a00a9-157">**\_DISABLEPRINTER PSD**</span><span class="sxs-lookup"><span data-stu-id="a00a9-157">**PSD\_DISABLEPRINTER**</span></span>     | <span data-ttu-id="a00a9-158">Désactive le bouton **imprimante** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-158">Disables the **Printer** button.</span></span>                                         |



 

## <a name="customizing-the-page-setup-dialog-box"></a><span data-ttu-id="a00a9-159">Personnalisation de la boîte de dialogue mise en page</span><span class="sxs-lookup"><span data-stu-id="a00a9-159">Customizing the Page Setup Dialog Box</span></span>

<span data-ttu-id="a00a9-160">Vous pouvez fournir un modèle personnalisé pour la boîte de dialogue **mise en page** , par exemple, si vous souhaitez inclure des contrôles supplémentaires propres à votre application.</span><span class="sxs-lookup"><span data-stu-id="a00a9-160">You can provide a custom template for the **Page Setup** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="a00a9-161">La fonction [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) utilise votre modèle personnalisé à la place du modèle par défaut.</span><span class="sxs-lookup"><span data-stu-id="a00a9-161">The [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="a00a9-162">**Pour fournir un modèle personnalisé pour la boîte de dialogue mise en page**</span><span class="sxs-lookup"><span data-stu-id="a00a9-162">**To provide a custom template for the Page Setup dialog box**</span></span>

1.  <span data-ttu-id="a00a9-163">Créez le modèle personnalisé en modifiant le modèle par défaut spécifié dans le fichier Prnsetup. dlg.</span><span class="sxs-lookup"><span data-stu-id="a00a9-163">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="a00a9-164">Les identificateurs de contrôle utilisés dans le modèle de boîte de dialogue de **mise en page** par défaut sont définis dans le fichier Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="a00a9-164">The control identifiers used in the default **Page Setup** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="a00a9-165">Utilisez la structure [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) pour activer le modèle comme suit :</span><span class="sxs-lookup"><span data-stu-id="a00a9-165">Use the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to enable the template as follows:</span></span>
    -   -   <span data-ttu-id="a00a9-166">Si votre modèle personnalisé est une ressource d’une application ou d’une bibliothèque de liens dynamiques, définissez l’indicateur **PSD \_ ENABLEPAGESETUPTEMPLATE** dans le membre **Flags** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-166">If your custom template is a resource in an application or dynamic-link library, set the **PSD\_ENABLEPAGESETUPTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="a00a9-167">Utilisez les membres **HINSTANCE** et **lpPageSetupTemplateName** de la structure pour identifier le nom du module et de la ressource.</span><span class="sxs-lookup"><span data-stu-id="a00a9-167">Use the **hInstance** and **lpPageSetupTemplateName** members of the structure to identify the module and resource name.</span></span>

            <span data-ttu-id="a00a9-168">Ou</span><span class="sxs-lookup"><span data-stu-id="a00a9-168">-Or-</span></span>

        -   <span data-ttu-id="a00a9-169">Si votre modèle personnalisé est déjà en mémoire, définissez l’indicateur **PSD \_ ENABLEPAGESETUPTEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-169">If your custom template is already in memory, set the **PSD\_ENABLEPAGESETUPTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="a00a9-170">Utilisez le membre **hPageSetupTemplate** pour identifier l’objet mémoire qui contient le modèle.</span><span class="sxs-lookup"><span data-stu-id="a00a9-170">Use the **hPageSetupTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="a00a9-171">Pour filtrer les messages envoyés à la procédure de la boîte de dialogue, vous pouvez fournir une procédure de hook [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="a00a9-171">To filter messages sent to the dialog box procedure, you can provide a [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="a00a9-172">Si vous utilisez un modèle personnalisé pour définir des contrôles supplémentaires, vous devez fournir une procédure de hook **PageSetupHook** pour traiter l’entrée de vos contrôles.</span><span class="sxs-lookup"><span data-stu-id="a00a9-172">If you use a custom template to define additional controls, you must provide a **PageSetupHook** hook procedure to process input for your controls.</span></span> <span data-ttu-id="a00a9-173">En outre, vous pouvez fournir une procédure de hook [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) pour personnaliser le contenu de l’exemple de page affiché dans la boîte de dialogue **mise en page** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-173">In addition, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the contents of the sample page displayed by the **Page Setup** dialog box.</span></span> <span data-ttu-id="a00a9-174">Pour plus d’informations sur la procédure de hook **PagePaintHook** , consultez [Personnalisation de la page d’exemple](#customizing-the-sample-page).</span><span class="sxs-lookup"><span data-stu-id="a00a9-174">For more information about the **PagePaintHook** hook procedure, see [Customizing the Sample Page](#customizing-the-sample-page).</span></span>

<span data-ttu-id="a00a9-175">**Pour activer une procédure de hook PageSetupHook**</span><span class="sxs-lookup"><span data-stu-id="a00a9-175">**To enable a PageSetupHook hook procedure**</span></span>

1.  <span data-ttu-id="a00a9-176">Définissez l’indicateur **PSD \_ ENABLEPAGESETUPHOOK** dans le membre **Flags** de la structure [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="a00a9-176">Set the **PSD\_ENABLEPAGESETUPHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="a00a9-177">Spécifiez l’adresse de la procédure de raccordement dans le membre **lpfnPageSetupHook** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-177">Specify the address of the hook procedure in the **lpfnPageSetupHook** member.</span></span>

<span data-ttu-id="a00a9-178">Après le traitement du message [**WM \_ INITDIALOG**](wm-initdialog.md) , la procédure de la boîte de dialogue envoie un message **WM \_ INITDIALOG** à la procédure de hook [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="a00a9-178">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="a00a9-179">Le paramètre *lParam* de ce message est un pointeur vers la structure [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) utilisée pour initialiser la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="a00a9-179">The *lParam* parameter of this message is a pointer to the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure used to initialize the dialog box.</span></span>

## <a name="customizing-the-sample-page"></a><span data-ttu-id="a00a9-180">Personnalisation de l’exemple de page</span><span class="sxs-lookup"><span data-stu-id="a00a9-180">Customizing the Sample Page</span></span>

<span data-ttu-id="a00a9-181">La boîte de dialogue **mise en page** comprend une image d’un exemple de page qui montre comment les sélections de l’utilisateur affectent l’apparence de la sortie imprimée.</span><span class="sxs-lookup"><span data-stu-id="a00a9-181">The **Page Setup** dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output.</span></span> <span data-ttu-id="a00a9-182">L’image se compose d’un rectangle qui représente le type de papier ou d’enveloppe sélectionné, avec un rectangle en pointillé représentant les marges actuelles et des caractères partiels (texte grec) pour afficher l’aspect du texte sur la page imprimée.</span><span class="sxs-lookup"><span data-stu-id="a00a9-182">The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (Greek text) characters to show how text looks on the printed page.</span></span>

<span data-ttu-id="a00a9-183">Quand vous appelez la fonction [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) , vous pouvez fournir une procédure de hook [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) pour personnaliser l’apparence de la page d’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-183">When you call the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the appearance of the sample page.</span></span>

<span data-ttu-id="a00a9-184">**Pour activer une procédure de hook PagePaintHook**</span><span class="sxs-lookup"><span data-stu-id="a00a9-184">**To enable a PagePaintHook hook procedure**</span></span>

1.  <span data-ttu-id="a00a9-185">Définissez l’indicateur **PSD \_ ENABLEPAGEPAINTHOOK** dans le membre **Flags** de la structure [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="a00a9-185">Set the **PSD\_ENABLEPAGEPAINTHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="a00a9-186">Spécifiez l’adresse de la procédure de raccordement dans le membre **lpfnPagePaintHook** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-186">Specify the address of the hook procedure in the **lpfnPagePaintHook** member.</span></span>

<span data-ttu-id="a00a9-187">Chaque fois que la boîte de dialogue est sur le le contenu de la page d’exemple, la procédure de raccordement reçoit les messages suivants dans l’ordre dans lequel ils sont répertoriés.</span><span class="sxs-lookup"><span data-stu-id="a00a9-187">Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed.</span></span>



| <span data-ttu-id="a00a9-188">Message</span><span class="sxs-lookup"><span data-stu-id="a00a9-188">Message</span></span>                                                  | <span data-ttu-id="a00a9-189">Signification</span><span class="sxs-lookup"><span data-stu-id="a00a9-189">Meaning</span></span>                                                                                                                                          |
|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a00a9-190">**\_PAGESETUPDLG WM \_**</span><span class="sxs-lookup"><span data-stu-id="a00a9-190">**WM\_PSD\_PAGESETUPDLG**</span></span>](wm-psd-pagesetupdlg.md)     | <span data-ttu-id="a00a9-191">La boîte de dialogue vous permet de dessiner la page de l’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-191">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="a00a9-192">La procédure de raccordement peut utiliser ce message pour préparer le contenu de la page d’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-192">The hook procedure can use this message to prepare to draw the contents of the sample page.</span></span>     |
| [<span data-ttu-id="a00a9-193">**\_FULLPAGERECT WM \_**</span><span class="sxs-lookup"><span data-stu-id="a00a9-193">**WM\_PSD\_FULLPAGERECT**</span></span>](wm-psd-fullpagerect.md)     | <span data-ttu-id="a00a9-194">La boîte de dialogue vous permet de dessiner la page de l’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-194">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="a00a9-195">Ce message spécifie le rectangle englobant de la page d’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-195">This message specifies the bounding rectangle of the sample page.</span></span>                               |
| [<span data-ttu-id="a00a9-196">**\_MINMARGINRECT WM \_**</span><span class="sxs-lookup"><span data-stu-id="a00a9-196">**WM\_PSD\_MINMARGINRECT**</span></span>](wm-psd-minmarginrect.md)   | <span data-ttu-id="a00a9-197">La boîte de dialogue vous permet de dessiner la page de l’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-197">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="a00a9-198">Ce message spécifie le rectangle de marge.</span><span class="sxs-lookup"><span data-stu-id="a00a9-198">This message specifies the margin rectangle.</span></span>                                                    |
| [<span data-ttu-id="a00a9-199">**\_MARGINRECT WM \_**</span><span class="sxs-lookup"><span data-stu-id="a00a9-199">**WM\_PSD\_MARGINRECT**</span></span>](wm-psd-marginrect.md)         | <span data-ttu-id="a00a9-200">La boîte de dialogue est sur le sujet de dessiner le rectangle de marge.</span><span class="sxs-lookup"><span data-stu-id="a00a9-200">The dialog box is about to draw the margin rectangle.</span></span>                                                                                            |
| [<span data-ttu-id="a00a9-201">**\_GREEKTEXTRECT WM \_**</span><span class="sxs-lookup"><span data-stu-id="a00a9-201">**WM\_PSD\_GREEKTEXTRECT**</span></span>](wm-psd-greektextrect.md)   | <span data-ttu-id="a00a9-202">La boîte de dialogue vous permet de dessiner le texte grec à l’intérieur du rectangle de marge.</span><span class="sxs-lookup"><span data-stu-id="a00a9-202">The dialog box is about to draw the Greek text inside the margin rectangle.</span></span>                                                                      |
| [<span data-ttu-id="a00a9-203">**\_ENVSTAMPRECT WM \_**</span><span class="sxs-lookup"><span data-stu-id="a00a9-203">**WM\_PSD\_ENVSTAMPRECT**</span></span>](wm-psd-envstamprect.md)     | <span data-ttu-id="a00a9-204">La boîte de dialogue est sur le dessin du rectangle d’enveloppe d’une page d’exemple d’enveloppe.</span><span class="sxs-lookup"><span data-stu-id="a00a9-204">The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page.</span></span> <span data-ttu-id="a00a9-205">Ce message est envoyé uniquement pour les enveloppes.</span><span class="sxs-lookup"><span data-stu-id="a00a9-205">This message is sent for envelopes only.</span></span>             |
| [<span data-ttu-id="a00a9-206">**\_YAFULLPAGERECT WM \_**</span><span class="sxs-lookup"><span data-stu-id="a00a9-206">**WM\_PSD\_YAFULLPAGERECT**</span></span>](wm-psd-yafullpagerect.md) | <span data-ttu-id="a00a9-207">La boîte de dialogue vous permet de dessiner la partie adresse de retour d’une page d’exemple d’enveloppe.</span><span class="sxs-lookup"><span data-stu-id="a00a9-207">The dialog box is about to draw the return address portion of an envelope sample page.</span></span> <span data-ttu-id="a00a9-208">Ce message est envoyé pour les enveloppes et autres formats de papier.</span><span class="sxs-lookup"><span data-stu-id="a00a9-208">This message is sent for envelopes and other paper sizes.</span></span> |



 

<span data-ttu-id="a00a9-209">Si la procédure de raccordement retourne la **valeur true** pour l’un des trois premiers messages d’une séquence de dessin ([**WM \_ PSD \_ PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM \_ PSD \_ FULLPAGERECT**](wm-psd-fullpagerect.md)ou [**WM \_ PSD \_ MINMARGINRECT**](wm-psd-minmarginrect.md)), la boîte de dialogue n’envoie plus de messages et ne dessine pas dans la page d’exemple tant que le système n’a pas besoin de redessiner la page d’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-209">If the hook procedure returns **TRUE** for any of the first three messages of a drawing sequence ([**WM\_PSD\_PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM\_PSD\_FULLPAGERECT**](wm-psd-fullpagerect.md), or [**WM\_PSD\_MINMARGINRECT**](wm-psd-minmarginrect.md)) the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page.</span></span> <span data-ttu-id="a00a9-210">Si la procédure de hook retourne la **valeur false** pour les trois messages, la boîte de dialogue envoie les messages restants de la séquence de dessin.</span><span class="sxs-lookup"><span data-stu-id="a00a9-210">If the hook procedure returns **FALSE** for all three messages, the dialog box sends the remaining messages of the drawing sequence.</span></span>

<span data-ttu-id="a00a9-211">Si la procédure de raccordement retourne la **valeur true** pour l’un des messages restants dans une séquence de dessin, la boîte de dialogue ne dessine pas la partie correspondante de la page d’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-211">If the hook procedure returns **TRUE** for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page.</span></span> <span data-ttu-id="a00a9-212">Si la procédure de raccordement retourne la **valeur false** pour l’un de ces messages, la boîte de dialogue crée cette partie de la page d’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-212">If the hook procedure returns **FALSE** for any of these messages, the dialog box draws that portion of the sample page.</span></span>

<span data-ttu-id="a00a9-213">Pour empêcher la boîte de dialogue de dessiner le contenu de la page d’exemple, vous pouvez définir l’indicateur **PSD \_ DISABLEPAGEPAINTING** .</span><span class="sxs-lookup"><span data-stu-id="a00a9-213">To prevent the dialog box from drawing the contents of the sample page, you can set the **PSD\_DISABLEPAGEPAINTING** flag.</span></span> <span data-ttu-id="a00a9-214">Cet indicateur n’affecte pas votre procédure de hook [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) , qui reçoit toujours tous **\_ les messages \_ \* WM** et peut dessiner le contenu de la page d’exemple.</span><span class="sxs-lookup"><span data-stu-id="a00a9-214">This flag does not affect your [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure, which still receives all the **WM\_PSD\_\*** messages and can draw the sample page contents.</span></span>

 

 