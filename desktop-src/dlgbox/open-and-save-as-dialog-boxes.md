---
title: Boîtes de dialogue Ouvrir et enregistrer sous
description: La boîte de dialogue Ouvrir permet à l’utilisateur de spécifier le lecteur, le répertoire et le nom d’un fichier ou d’un ensemble de fichiers à ouvrir.
ms.assetid: 5676ca9d-daca-40bf-8881-def2ff841c58
keywords:
- Bibliothèque de boîtes de dialogue communes
- boîtes de dialogue communes
- Boîte de dialogue Ouvrir
- Enregistrer sous, boîte de dialogue
- personnalisation de la boîte de dialogue Ouvrir
- personnalisation de la boîte de dialogue Enregistrer sous
- boîtes de dialogue, ouvrir
- boîtes de dialogue, enregistrer sous
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: be957276f0d5a6370bb53aca4b1af5052b422011
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/27/2021
ms.locfileid: "110548884"
---
# <a name="open-and-save-as-dialog-boxes"></a><span data-ttu-id="c4ba1-111">Boîtes de dialogue Ouvrir et enregistrer sous</span><span class="sxs-lookup"><span data-stu-id="c4ba1-111">Open and Save As Dialog Boxes</span></span>

> [!NOTE]
> <span data-ttu-id="c4ba1-112">La fonction [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) est illustrée dans l' [exemple fichier en cours d’utilisation](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-112">The [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function is demonstrated in the [File is in use sample](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse).</span></span>

<span data-ttu-id="c4ba1-113">\[À compter de Windows Vista, les boîtes de dialogue **ouvrir** et **Enregistrer comme** courantes ont été remplacées par la [boîte de dialogue élément commun](../shell/common-file-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-113">\[Starting with Windows Vista, the **Open** and **Save As** common dialog boxes have been superseded by the [Common Item Dialog](../shell/common-file-dialog.md).</span></span> <span data-ttu-id="c4ba1-114">Nous vous recommandons d’utiliser l’API de la boîte de dialogue élément commun au lieu de ces boîtes de dialogue à partir de la bibliothèque de boîtes de dialogue communes.\]</span><span class="sxs-lookup"><span data-stu-id="c4ba1-114">We recommended that you use the Common Item Dialog API instead of these dialog boxes from the Common Dialog Box Library.\]</span></span>

<span data-ttu-id="c4ba1-115">La boîte de dialogue **ouvrir** permet à l’utilisateur de spécifier le lecteur, le répertoire et le nom d’un fichier ou d’un ensemble de fichiers à ouvrir.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-115">The **Open** dialog box lets the user specify the drive, directory, and the name of a file or set of files to open.</span></span> <span data-ttu-id="c4ba1-116">Vous créez et affichez une boîte de dialogue **ouvrir** en initialisant une structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) et en passant la structure à la fonction [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-116">You create and display an **Open** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function.</span></span>

<span data-ttu-id="c4ba1-117">La boîte de dialogue **Enregistrer sous** permet à l’utilisateur de spécifier le lecteur, le répertoire et le nom d’un fichier à enregistrer.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-117">The **Save As** dialog box lets the user specify the drive, directory, and name of a file to save.</span></span> <span data-ttu-id="c4ba1-118">Vous créez et affichez une boîte de dialogue **Enregistrer sous** en initialisant une structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) et en passant la structure à la fonction [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-118">You create and display a **Save As** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) function.</span></span>

<span data-ttu-id="c4ba1-119">Les boîtes de dialogue **ouvrir** et **Enregistrer sous** de style Explorateur fournissent des fonctionnalités d’interface utilisateur similaires à celles de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-119">Explorer-style **Open** and **Save As** dialog boxes provide user-interface features that are similar to the Windows Explorer.</span></span> <span data-ttu-id="c4ba1-120">Toutefois, le système continue à prendre en charge les anciennes boîtes de dialogue **ouvrir** et **Enregistrer sous** pour les applications qui doivent être cohérentes avec l’interface utilisateur de type ancien.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-120">However, the system continues to support old-style **Open** and **Save As** dialog boxes for applications that must be consistent with the old-style user interface.</span></span>

<span data-ttu-id="c4ba1-121">En plus de la différence de l’apparence, les boîtes de dialogue de style Explorateur et ancien diffèrent au niveau de leur utilisation des modèles personnalisés et des procédures de Hook pour la personnalisation des boîtes de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-121">In addition to the difference in appearance, the Explorer-style and old-style dialog boxes differ in their use of custom templates and hook procedures for customizing the dialog boxes.</span></span> <span data-ttu-id="c4ba1-122">Toutefois, les boîtes de dialogue de style Explorateur et ancien ont le même comportement pour la plupart des opérations de base, telles que la spécification d’un filtre de nom de fichier, la validation de l’entrée de l’utilisateur et l’obtention du nom de fichier spécifié par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-122">However, the Explorer-style and old-style dialog boxes have the same behavior for most basic operations, such as specifying a file name filter, validating the user's input, and getting the file name specified by the user.</span></span> <span data-ttu-id="c4ba1-123">Pour plus d’informations sur les boîtes de dialogue de style Explorateur et ancien, consultez [Personnalisation de la boîte de dialogue Ouvrir et enregistrer sous](#open-and-save-as-dialog-box-customization).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-123">For more information about the Explorer-style and old-style dialog boxes, see [Open and Save As Dialog Box Customization](#open-and-save-as-dialog-box-customization).</span></span>

<span data-ttu-id="c4ba1-124">L’illustration suivante montre une boîte de dialogue d' **ouverture** de style Explorateur typique.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-124">The following illustration shows a typical Explorer-style **Open** dialog box.</span></span>

![ouvrir un fichier (boîte de dialogue)](images/opendialogboxxp.png)

<span data-ttu-id="c4ba1-126">L’illustration suivante montre une boîte de dialogue standard **Enregistrer sous** de type Explorateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-126">The following illustration shows a typical Explorer-style **Save As** dialog box.</span></span>

![boîte de dialogue Enregistrer le fichier](images/saveasdialogboxxp.png)

<span data-ttu-id="c4ba1-128">Si l’utilisateur spécifie un nom de fichier et clique sur le bouton **OK** , [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) ou [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) retourne la **valeur true**.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-128">If the user specifies a file name and clicks the **OK** button, [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) returns **TRUE**.</span></span> <span data-ttu-id="c4ba1-129">La mémoire tampon vers laquelle pointe le membre **lpstrFile** de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) contient le chemin d’accès complet et le nom de fichier spécifiés par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-129">The buffer pointed to by the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure contains the full path and file name specified by the user.</span></span>

<span data-ttu-id="c4ba1-130">Si l’utilisateur annule la boîte de dialogue **ouvrir** ou **Enregistrer sous** , ou qu’une erreur se produit, la fonction retourne **false**.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-130">If the user cancels the **Open** or **Save As** dialog box or an error occurs, the function returns **FALSE**.</span></span> <span data-ttu-id="c4ba1-131">Pour déterminer la cause de l’erreur, appelez la fonction [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) pour récupérer la valeur d’erreur étendue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-131">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span> <span data-ttu-id="c4ba1-132">Si la mémoire tampon **lpstrFile** est trop petite pour recevoir le nom complet, **CommDlgExtendedError** retourne **FNERR \_ BUFFERTOOSMALL** et les 2 premiers octets de la mémoire tampon vers laquelle pointe le membre **lpstrFile** sont définis sur une valeur entière spécifiant la taille requise pour recevoir le nom complet.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-132">If the **lpstrFile** buffer is too small to receive the full name, **CommDlgExtendedError** returns **FNERR\_BUFFERTOOSMALL** and the first 2 bytes of the buffer pointed to by the **lpstrFile** member are set to an integer value specifying the size required to receive the full name.</span></span>

<span data-ttu-id="c4ba1-133">Les rubriques suivantes sont présentées dans cette section.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-133">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="c4ba1-134">Noms et répertoires de fichiers</span><span class="sxs-lookup"><span data-stu-id="c4ba1-134">File Names and Directories</span></span>](#file-names-and-directories)
-   [<span data-ttu-id="c4ba1-135">Filtres</span><span class="sxs-lookup"><span data-stu-id="c4ba1-135">Filters</span></span>](#filters)
-   [<span data-ttu-id="c4ba1-136">Validation de fichiers et de répertoires</span><span class="sxs-lookup"><span data-stu-id="c4ba1-136">File and Directory Validation</span></span>](#file-and-directory-validation)
-   [<span data-ttu-id="c4ba1-137">Personnalisation de la boîte de dialogue Ouvrir et enregistrer sous</span><span class="sxs-lookup"><span data-stu-id="c4ba1-137">Open and Save As Dialog Box Customization</span></span>](#open-and-save-as-dialog-box-customization)
-   [<span data-ttu-id="c4ba1-138">Procédures de hook de style Explorer</span><span class="sxs-lookup"><span data-stu-id="c4ba1-138">Explorer-Style Hook Procedures</span></span>](#explorer-style-hook-procedures)
-   [<span data-ttu-id="c4ba1-139">Modèles personnalisés de style Explorateur</span><span class="sxs-lookup"><span data-stu-id="c4ba1-139">Explorer-Style Custom Templates</span></span>](#explorer-style-custom-templates)
-   [<span data-ttu-id="c4ba1-140">Identificateurs de contrôle de style Explorateur</span><span class="sxs-lookup"><span data-stu-id="c4ba1-140">Explorer-Style Control Identifiers</span></span>](#explorer-style-control-identifiers)
-   [<span data-ttu-id="c4ba1-141">Personnalisation des boîtes de dialogue Old-Style</span><span class="sxs-lookup"><span data-stu-id="c4ba1-141">Customizing Old-Style Dialog Boxes</span></span>](#customizing-old-style-dialog-boxes)

## <a name="file-names-and-directories"></a><span data-ttu-id="c4ba1-142">Noms et répertoires de fichiers</span><span class="sxs-lookup"><span data-stu-id="c4ba1-142">File Names and Directories</span></span>

<span data-ttu-id="c4ba1-143">Les informations contenues dans cette section s’appliquent aux boîtes de dialogue **ouvrir** et **Enregistrer sous** de style Explorateur et ancien style.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-143">The information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="c4ba1-144">Avant d’appeler les fonctions [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) ou [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) , le membre **lpstrFile** de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) doit pointer vers la mémoire tampon pour recevoir le nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-144">Before calling the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions, the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must point to the buffer to receive the file name.</span></span> <span data-ttu-id="c4ba1-145">Le membre **nMaxFile** doit spécifier la taille, en caractères, de la mémoire tampon **lpstrFile** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-145">The **nMaxFile** member must specify the size, in characters, of the **lpstrFile** buffer.</span></span> <span data-ttu-id="c4ba1-146">Pour une fonction ANSI, il s’agit du nombre d’octets, mais pour une fonction Unicode, il s’agit du nombre de caractères.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-146">For an ANSI function this is the number of bytes, but for a Unicode function this is the number of characters.</span></span>

<span data-ttu-id="c4ba1-147">Si l’utilisateur spécifie un nom de fichier et clique sur le bouton **OK** , la boîte de dialogue copie le lecteur, le répertoire et le nom de fichier sélectionnés dans la mémoire tampon **lpstrFile** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-147">If the user specifies a file name and clicks the **OK** button, the dialog box copies the selected drive, directory, and file name to the **lpstrFile** buffer.</span></span> <span data-ttu-id="c4ba1-148">La fonction définit également les membres **nFileOffset** et **nFileExtension** sur les décalages, en caractères, entre le début de la mémoire tampon et le nom de fichier et l’extension de nom de fichier, respectivement.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-148">The function also sets the **nFileOffset** and **nFileExtension** members to the offsets, in characters, from the start of the buffer to the file name and to the file name extension, respectively.</span></span>

<span data-ttu-id="c4ba1-149">Pour récupérer uniquement le nom de fichier et l’extension, définissez le membre **lpstrFileTitle** pour qu’il pointe vers une mémoire tampon et définissez le membre **nMaxFileTitle** sur la taille, en caractères, de la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-149">To retrieve just the file name and extension, set the **lpstrFileTitle** member to point to a buffer and set the **nMaxFileTitle** member to the size, in characters, of the buffer.</span></span> <span data-ttu-id="c4ba1-150">Vous pouvez également transmettre la mémoire tampon **lpstrFile** dans un appel à la fonction [**GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) pour obtenir le nom complet du fichier sélectionné.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-150">Alternatively, you can pass the **lpstrFile** buffer in a call to the [**GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) function to get the display name of the selected file.</span></span> <span data-ttu-id="c4ba1-151">Notez, toutefois, que le nom de fichier retourné par **GetFileTitle** comprend une extension uniquement s’il s’agit de la préférence de l’utilisateur pour l’affichage des noms de fichiers.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-151">Note, however, that the file name that **GetFileTitle** returns includes an extension only if that is the user's preference for displaying file names.</span></span>

<span data-ttu-id="c4ba1-152">La boîte de dialogue utilise le répertoire actif pour le processus appelant comme répertoire initial à partir duquel les fichiers et les répertoires sont affichés.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-152">The dialog box uses the current directory for the calling process as the initial directory from which to display files and directories.</span></span> <span data-ttu-id="c4ba1-153">Utilisez les fonctions [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) et [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) pour obtenir et modifier le répertoire actif d’un processus.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-153">Use the [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) and [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) functions to get and change the current directory of a process.</span></span> <span data-ttu-id="c4ba1-154">Pour spécifier un autre répertoire initial sans modifier votre répertoire actif, utilisez le membre **lpstrInitialDir** pour spécifier le nom d’un répertoire.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-154">To specify a different initial directory without changing your current directory, use the **lpstrInitialDir** member to specify the name of a directory.</span></span> <span data-ttu-id="c4ba1-155">La boîte de dialogue change automatiquement votre répertoire actuel lorsque l’utilisateur sélectionne un autre lecteur ou répertoire.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-155">The dialog box automatically changes your current directory when the user selects a different drive or directory.</span></span> <span data-ttu-id="c4ba1-156">Pour empêcher la boîte de dialogue de changer votre répertoire actif, définissez l’indicateur **OFN \_ NOCHANGEDIR** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-156">To prevent the dialog box from changing your current directory, set the **OFN\_NOCHANGEDIR** flag.</span></span> <span data-ttu-id="c4ba1-157">Cet indicateur n’empêche pas l’utilisateur de changer de répertoire pour rechercher un fichier.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-157">This flag does not prevent the user from changing directories to find a file.</span></span>

<span data-ttu-id="c4ba1-158">Pour spécifier une extension de nom de fichier par défaut, utilisez le membre **lpstrDefExt** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-158">To specify a default file name extension, use the **lpstrDefExt** member.</span></span> <span data-ttu-id="c4ba1-159">Si l’utilisateur spécifie un nom de fichier qui n’a pas d’extension, la boîte de dialogue ajoute votre extension par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-159">If the user specifies a file name that does not have an extension, the dialog box adds your default extension.</span></span> <span data-ttu-id="c4ba1-160">Si vous spécifiez une extension par défaut et que l’utilisateur spécifie un nom de fichier avec une extension différente, la boîte de dialogue définit l’indicateur **OFN \_ EXTENSIONDIFFERENT** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-160">If you specify a default extension and the user specifies a file name with a different extension, the dialog box sets the **OFN\_EXTENSIONDIFFERENT** flag.</span></span>

<span data-ttu-id="c4ba1-161">Pour permettre à l’utilisateur de sélectionner plusieurs fichiers dans un répertoire, définissez l’indicateur **OFN \_ ALLOWMULTISELECT** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-161">To let the user select more than one file from a directory, set the **OFN\_ALLOWMULTISELECT** flag.</span></span> <span data-ttu-id="c4ba1-162">Pour la compatibilité avec les anciennes applications, la boîte de dialogue sélection multiple par défaut utilise l’ancienne interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-162">For compatibility with older applications, the default multiple selection dialog box uses the old-style user interface.</span></span> <span data-ttu-id="c4ba1-163">Pour afficher une boîte de dialogue de sélection multiple de type Explorateur, vous devez également définir l’indicateur **OFN \_ Explorer** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-163">To display an Explorer-style multiple selection dialog box, you must also set the **OFN\_EXPLORER** flag.</span></span>

<span data-ttu-id="c4ba1-164">Si l’utilisateur sélectionne plusieurs fichiers, la mémoire tampon vers laquelle pointe le membre **lpstrFile** retourne le chemin d’accès au répertoire actif, suivi des noms de fichiers des fichiers sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-164">If the user selects more than one file, the buffer pointed to by the **lpstrFile** member returns the path to the current directory followed by the file names of the selected files.</span></span> <span data-ttu-id="c4ba1-165">Le membre **nFileOffset** est le décalage par rapport au premier nom de fichier, et le membre **nFileExtension** n’est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-165">The **nFileOffset** member is the offset to the first file name, and the **nFileExtension** member is not used.</span></span> <span data-ttu-id="c4ba1-166">Le tableau suivant décrit la différence entre les boîtes de dialogue de style Explorateur et de style ancien dans le retour de plusieurs noms de fichiers.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-166">The following table describes the difference between Explorer-style and old-style dialog boxes in returning multiple file names.</span></span>



| <span data-ttu-id="c4ba1-167">Style de boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="c4ba1-167">Dialog box style</span></span>            | <span data-ttu-id="c4ba1-168">Description</span><span class="sxs-lookup"><span data-stu-id="c4ba1-168">Description</span></span>                                                                                                                                                                                                               |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c4ba1-169">Boîtes de dialogue de style Explorateur</span><span class="sxs-lookup"><span data-stu-id="c4ba1-169">Explorer-style dialog boxes</span></span> | <span data-ttu-id="c4ba1-170">Les chaînes de nom de fichier et de répertoire sont séparées par des **valeurs NULL** , avec un caractère **null** supplémentaire après le dernier nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-170">The directory and file name strings are **NULL** separated, with an extra **NULL** character after the last file name.</span></span> <span data-ttu-id="c4ba1-171">Ce format permet aux boîtes de dialogue de style Explorateur de retourner des noms de fichiers longs qui incluent des espaces.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-171">This format enables the Explorer-style dialog boxes to return long file names that include spaces.</span></span> |
| <span data-ttu-id="c4ba1-172">Anciennes boîtes de dialogue</span><span class="sxs-lookup"><span data-stu-id="c4ba1-172">Old-style dialog boxes</span></span>      | <span data-ttu-id="c4ba1-173">Les chaînes de noms de répertoires et de fichiers sont séparées par des espaces.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-173">The directory and file name strings are separated by spaces.</span></span> <span data-ttu-id="c4ba1-174">Pour les noms de fichiers avec des espaces, la fonction utilise des noms de fichiers courts.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-174">For file names with spaces, the function uses short file names.</span></span>                                                                                              |



 

<span data-ttu-id="c4ba1-175">Vous pouvez utiliser la fonction [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) pour effectuer une conversion entre des noms de fichiers longs et courts.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-175">You can use the [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) function to convert between long and short file names.</span></span>

<span data-ttu-id="c4ba1-176">Si vous spécifiez **OFN \_ ALLOWMULTISELECT** et que l’utilisateur sélectionne un seul fichier, la chaîne **lpstrFile** n’a pas de séparateur entre le chemin d’accès et le nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-176">If you specify **OFN\_ALLOWMULTISELECT** and the user selects only one file, the **lpstrFile** string does not have a separator between the path and file name.</span></span>

## <a name="filters"></a><span data-ttu-id="c4ba1-177">Filtres</span><span class="sxs-lookup"><span data-stu-id="c4ba1-177">Filters</span></span>

<span data-ttu-id="c4ba1-178">Les informations contenues dans cette section s’appliquent à la fois aux boîtes de dialogue **ouvrir** et **Enregistrer sous** d’un style d’explorateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-178">The information in this section applies to both Explorer-style and old style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="c4ba1-179">Vous pouvez fournir des filtres de nom de fichier pour aider l’utilisateur à limiter les noms de fichiers que la boîte de dialogue affiche.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-179">You can provide file name filters to assist the user in limiting the file names that the dialog box displays.</span></span> <span data-ttu-id="c4ba1-180">Un filtre de nom de fichier se compose d’une paire de chaînes se terminant par un caractère null, d’une description et d’un modèle, d’une concaténation à l’autre.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-180">A file name filter consists of a pair of null-terminated strings, a description and a pattern, one concatenated to the other.</span></span> <span data-ttu-id="c4ba1-181">La boîte de dialogue affiche la description pour permettre à l’utilisateur de choisir le filtre à utiliser. et utilise le modèle pour sélectionner les fichiers à afficher.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-181">The dialog box displays the description to let the user pick which filter to use; and it uses the pattern to select the files to display.</span></span>

<span data-ttu-id="c4ba1-182">Pour spécifier les filtres, définissez le membre **lpstrFilter** de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) de façon à ce qu’il pointe vers une mémoire tampon qui contient un tableau de paires de chaînes de filtre.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-182">To specify the filters, set the **lpstrFilter** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to point to a buffer that contains an array of filter string pairs.</span></span> <span data-ttu-id="c4ba1-183">La dernière chaîne dans le tableau doit être suivie d’un caractère null supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-183">The last string in the array must be followed by an extra null character.</span></span>

<span data-ttu-id="c4ba1-184">Une chaîne de modèle peut être une combinaison de caractères de nom de fichier valides et de l’astérisque ( \* ).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-184">A pattern string can be a combination of valid file name characters and the asterisk (\*).</span></span> <span data-ttu-id="c4ba1-185">L’astérisque est un caractère générique qui représente toute combinaison de caractères de nom de fichier valides.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-185">The asterisk is a wildcard that represents any combination of valid file name characters.</span></span> <span data-ttu-id="c4ba1-186">La boîte de dialogue affiche uniquement les fichiers qui correspondent au modèle.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-186">The dialog box displays only those files that match the pattern.</span></span> <span data-ttu-id="c4ba1-187">Pour spécifier plusieurs modèles pour la même description, vous devez utiliser un point-virgule (;) pour séparer les modèles.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-187">To specify multiple patterns for the same description, you must use a semicolon (;) to separate the patterns.</span></span> <span data-ttu-id="c4ba1-188">Notez que les espaces dans la chaîne de modèle peuvent produire des résultats inattendus.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-188">Note that space characters in the pattern string can produce unexpected results.</span></span>

<span data-ttu-id="c4ba1-189">Le fragment de code suivant spécifie deux filtres.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-189">The following code fragment specifies two filters.</span></span> <span data-ttu-id="c4ba1-190">Le filtre avec la description « source » a deux modèles.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-190">The filter with the "Source" description has two patterns.</span></span> <span data-ttu-id="c4ba1-191">Si l’utilisateur sélectionne ce filtre, la boîte de dialogue affiche uniquement les fichiers qui ont le. C et. Extensions CXX.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-191">If the user selects this filter, the dialog box displays only files that have the .C and .CXX extensions.</span></span> <span data-ttu-id="c4ba1-192">Notez que, dans le langage de programmation C, une chaîne placée entre guillemets doubles est terminée par un caractère null.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-192">Note, in the C programming language, a string enclosed in double quotes is null-terminated.</span></span>


```
OPENFILENAME ofn;       // common dialog box structure

ofn.lpstrFilter = "Source\0*.C;*.CXX\0All\0*.*\0"
ofn.nFilterIndex = 1;
```



<span data-ttu-id="c4ba1-193">Le membre **nFilterIndex** de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) spécifie un index qui indique le filtre utilisé initialement par la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-193">The **nFilterIndex** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure specifies an index that indicates which filter the dialog box initially uses.</span></span> <span data-ttu-id="c4ba1-194">Le premier filtre de la mémoire tampon a l’index 1, le deuxième 2, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-194">The first filter in the buffer has index 1, the second 2, and so on.</span></span> <span data-ttu-id="c4ba1-195">Si l’utilisateur modifie le filtre lors de l’utilisation de la boîte de dialogue, le membre **nFilterIndex** est défini sur l’index du filtre sélectionné lors du retour.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-195">If the user changes the filter while using the dialog box, the **nFilterIndex** member is set to the index of the selected filter on return.</span></span>

<span data-ttu-id="c4ba1-196">Vous pouvez créer un filtre personnalisé en définissant le membre **lpstrCustomFilter** sur l’adresse d’une mémoire tampon qui contient un filtre unique et en définissant le membre **nMaxCustFilter** sur la taille de la mémoire tampon, en caractères ou en octets.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-196">You can create a custom filter by setting the **lpstrCustomFilter** member to the address of a buffer that contains a single filter, and by setting the **nMaxCustFilter** member to the size of the buffer, in characters or bytes.</span></span> <span data-ttu-id="c4ba1-197">La boîte de dialogue place toujours le filtre personnalisé au début de la liste de filtres et, au retour, met toujours à jour la partie de modèle du filtre avec le modèle du filtre sélectionné par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-197">The dialog box always places the custom filter at the beginning of the list of filters and, on return, always updates the pattern part of the filter with the pattern from the filter selected by the user.</span></span>

<span data-ttu-id="c4ba1-198">Pour les boîtes de dialogue de style Explorateur, l’extension par défaut peut changer si l’utilisateur sélectionne un filtre différent.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-198">For Explorer-style dialog boxes, the default extension may change if the user selects a different filter.</span></span> <span data-ttu-id="c4ba1-199">Si l’utilisateur sélectionne un filtre dont le premier modèle se présente sous la forme \* .*xxx* (autrement dit, l’extension n’inclut pas de caractère générique), la boîte de dialogue utilise *xxx* comme extension par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-199">If the user selects a filter whose first pattern is of the form \*.*xxx* (that is, the extension does not include a wildcard character), the dialog box uses *xxx* as the default extension.</span></span> <span data-ttu-id="c4ba1-200">Cela se produit uniquement si vous avez spécifié une extension par défaut dans le membre **lpstrDefExt** de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-200">This occurs only if you specified a default extension in the **lpstrDefExt** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span> <span data-ttu-id="c4ba1-201">Par exemple, si l’utilisateur sélectionne la «source \\ 0 \* . C ; \* . CXX \\ 0», l’extension par défaut devient « C ».</span><span class="sxs-lookup"><span data-stu-id="c4ba1-201">For example, if the user selects the "Source\\0\*.C;\*.CXX\\0" filter, the default extension changes to "C".</span></span> <span data-ttu-id="c4ba1-202">Toutefois, si vous aviez défini le filtre sur «source \\ 0 \* . C \* \\ 0», l’extension par défaut ne change pas, car l’extension contient un caractère générique.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-202">However, if you had defined the filter as "Source\\0\*.C\*\\0", the default extension would not change because the extension includes a wildcard.</span></span>

<span data-ttu-id="c4ba1-203">Le message de notification [**CDN \_ INCLUDEITEM**](cdn-includeitem.md) fournit une autre méthode pour filtrer les noms que la boîte de dialogue affiche.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-203">The [**CDN\_INCLUDEITEM**](cdn-includeitem.md) notification message provides another way to filter the names that the dialog box displays.</span></span> <span data-ttu-id="c4ba1-204">Pour utiliser ce message, fournissez une procédure de hook [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) et spécifiez l’indicateur **OFN \_ ENABLEINCLUDENOTIFY** dans la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) lorsque vous créez la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-204">To use this message, provide an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure and specify the **OFN\_ENABLEINCLUDENOTIFY** flag in the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="c4ba1-205">Chaque fois que l’utilisateur ouvre un dossier, la boîte de dialogue envoie une notification **\_ INCLUDEITEM CDN** à votre procédure de Hook pour chaque élément dans le dossier qui vient d’être ouvert.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-205">Each time the user opens a folder, the dialog box sends a **CDN\_INCLUDEITEM** notification to your hook procedure for each item in the newly opened folder.</span></span> <span data-ttu-id="c4ba1-206">La valeur de retour de la procédure de raccordement indique si la boîte de dialogue doit afficher l’élément dans la liste d’éléments du dossier.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-206">The return value of the hook procedure indicates whether the dialog box should display the item in the folder's item list.</span></span>

## <a name="file-and-directory-validation"></a><span data-ttu-id="c4ba1-207">Validation de fichiers et de répertoires</span><span class="sxs-lookup"><span data-stu-id="c4ba1-207">File and Directory Validation</span></span>

<span data-ttu-id="c4ba1-208">Sauf indication contraire, les informations contenues dans cette section s’appliquent aux boîtes de dialogue **ouvrir** et **Enregistrer sous** de style Explorateur et ancien style.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-208">Except as noted, the information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="c4ba1-209">La boîte de dialogue valide automatiquement les noms de fichiers tapés par l’utilisateur pour s’assurer que les noms contiennent uniquement des caractères valides.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-209">The dialog box automatically validates file names typed by the user to ensure that the names contain only valid characters.</span></span> <span data-ttu-id="c4ba1-210">Pour remplacer la validation de caractère de nom de fichier, définissez l’indicateur **\_ novalidate OFN** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-210">To override the file name character validation, set the **OFN\_NOVALIDATE** flag.</span></span>

<span data-ttu-id="c4ba1-211">Pour forcer la boîte de dialogue à vérifier que l’utilisateur a spécifié le nom d’un fichier existant, définissez l’indicateur **OFN \_ FILEMUSTEXIST** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-211">To force the dialog box to verify that the user specified the name of an existing file, set the **OFN\_FILEMUSTEXIST** flag.</span></span> <span data-ttu-id="c4ba1-212">Pour forcer la vérification que le chemin d’accès spécifié existe, définissez l’indicateur **OFN \_ PATHMUSTEXIST** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-212">To force verification that the specified path exists, set the **OFN\_PATHMUSTEXIST** flag.</span></span> <span data-ttu-id="c4ba1-213">Si vous définissez l’indicateur **OFN \_ CREATEPROMPT** , la boîte de dialogue demande à l’utilisateur l’autorisation de créer un fichier inexistant.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-213">If you set the **OFN\_CREATEPROMPT** flag, the dialog box prompts the user for permission to create a nonexistent file.</span></span> <span data-ttu-id="c4ba1-214">Si cet indicateur est défini et que l’utilisateur choisit de créer un nouveau fichier, la boîte de dialogue se ferme et la fonction retourne le nom spécifié.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-214">If this flag is set and the user chooses to create a new file, the dialog box closes, and the function returns the specified name.</span></span> <span data-ttu-id="c4ba1-215">Dans le cas contraire, la boîte de dialogue reste ouverte.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-215">Otherwise, the dialog box remains open.</span></span>

<span data-ttu-id="c4ba1-216">Lorsque vous utilisez la boîte de dialogue **Enregistrer sous** , vous pouvez indiquer à la boîte de dialogue de demander à l’utilisateur l’autorisation de remplacer un fichier existant en définissant l’indicateur **OFN \_ OVERWRITEPROMPT** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-216">When using the **Save As** dialog box, you can direct the dialog box to prompt the user for permission to overwrite an existing file by setting the **OFN\_OVERWRITEPROMPT** flag.</span></span>

<span data-ttu-id="c4ba1-217">Par défaut, la boîte de dialogue crée un fichier de test de longueur zéro pour déterminer si un nouveau fichier peut être créé dans le répertoire sélectionné.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-217">By default, the dialog box creates a zero-length test file to determine whether a new file can be created in the selected directory.</span></span> <span data-ttu-id="c4ba1-218">Pour empêcher la création de ce fichier de test, définissez l’indicateur **OFN \_ NOTESTFILECREATE** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-218">To prevent the creation of this test file, set the **OFN\_NOTESTFILECREATE** flag.</span></span>

<span data-ttu-id="c4ba1-219">Si vous activez une procédure de Hook, la boîte de dialogue notifie votre procédure de raccordement lorsqu’une violation de partage réseau se produit pour le nom de fichier spécifié par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-219">If you enable a hook procedure, the dialog box notifies your hook procedure when a network sharing violation occurs for the file name specified by the user.</span></span> <span data-ttu-id="c4ba1-220">Si vous définissez l’indicateur **OFN \_ Explorer** , la boîte de dialogue envoie le message [**CDN \_ SHAREVIOLATION**](cdn-shareviolation.md) à la procédure de Hook.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-220">If you set the **OFN\_EXPLORER** flag, the dialog box sends the [**CDN\_SHAREVIOLATION**](cdn-shareviolation.md) message to the hook procedure.</span></span> <span data-ttu-id="c4ba1-221">Si vous ne définissez pas **OFN \_ Explorer**, la boîte de dialogue envoie le message [**SHAREVISTRING**](sharevistring.md) Registered à la procédure de Hook.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-221">If you do not set **OFN\_EXPLORER**, the dialog box sends the [**SHAREVISTRING**](sharevistring.md) registered message to the hook procedure.</span></span> <span data-ttu-id="c4ba1-222">Pour empêcher la boîte de dialogue d’envoyer des notifications pour les violations de partage, définissez l’indicateur **OFN \_ SHAREAWARE** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-222">To prevent the dialog box from sending any notifications for sharing violations, set the **OFN\_SHAREAWARE** flag.</span></span>

<span data-ttu-id="c4ba1-223">Si l’utilisateur sélectionne la case à cocher en lecture seule, la boîte de dialogue définit l’indicateur **\_ ReadOnly OFN** lors du retour.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-223">If the user selects the read-only check box, the dialog box sets the **OFN\_READONLY** flag on return.</span></span> <span data-ttu-id="c4ba1-224">Pour masquer la case à cocher **ouvrir en lecture seule** , définissez l’indicateur **OFN \_ HIDEREADONLY** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-224">To hide the **Open As Read Only** check box, set the **OFN\_HIDEREADONLY** flag.</span></span> <span data-ttu-id="c4ba1-225">Pour empêcher la boîte de dialogue de retourner les noms des fichiers existants qui ont l’attribut de lecture seule, définissez l’indicateur **OFN \_ NOREADONLYRETURN** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-225">To prevent the dialog box from returning names of existing files that have the read-only attribute, set the **OFN\_NOREADONLYRETURN** flag.</span></span>

<span data-ttu-id="c4ba1-226">Pour empêcher la boîte de dialogue de déréférencer les fichiers de liaison, définissez la valeur **\_ NODEREFERENCELINKS OFN** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-226">To prevent the dialog box from dereferencing link files, set the **OFN\_NODEREFERENCELINKS** value.</span></span> <span data-ttu-id="c4ba1-227">Dans ce cas, la boîte de dialogue retourne le nom du fichier de liaison au lieu du nom du fichier référencé par le fichier de liaison.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-227">In this case, the dialog box returns the name of the link file rather than the name of the file referenced by the link file.</span></span>

## <a name="open-and-save-as-dialog-box-customization"></a><span data-ttu-id="c4ba1-228">Personnalisation de la boîte de dialogue Ouvrir et enregistrer sous</span><span class="sxs-lookup"><span data-stu-id="c4ba1-228">Open and Save As Dialog Box Customization</span></span>

<span data-ttu-id="c4ba1-229">Vous pouvez personnaliser une boîte de dialogue **ouvrir** ou **Enregistrer sous** en fournissant une procédure de raccordement, un modèle personnalisé, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-229">You can customize an **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="c4ba1-230">Toutefois, les versions de type Explorateur et ancien style des boîtes de dialogue diffèrent au niveau de leur utilisation des modèles personnalisés et des procédures de Hook.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-230">However, the Explorer-style and old-style versions of the dialog boxes differ in their use of custom templates and hook procedures.</span></span>

<span data-ttu-id="c4ba1-231">Pour plus d’informations sur la personnalisation d’une boîte de dialogue de style Explorateur, consultez [procédures de hook de style](#explorer-style-hook-procedures)Explorateur, [modèles personnalisés de style Explorateur](#explorer-style-custom-templates)et [identificateurs de contrôle de style Explorateur](#explorer-style-control-identifiers).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-231">For information about customizing an Explorer-style dialog box, see [Explorer-Style Hook Procedures](#explorer-style-hook-procedures), [Explorer-Style Custom Templates](#explorer-style-custom-templates), and [Explorer-Style Control Identifiers](#explorer-style-control-identifiers).</span></span> <span data-ttu-id="c4ba1-232">Pour plus d’informations sur la personnalisation d’une ancienne boîte de dialogue de style, consultez [Personnalisation des boîtes de dialogue de Old-Style](#customizing-old-style-dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-232">For information about customizing an old-style dialog box, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="c4ba1-233">Le tableau suivant résume les différences entre les deux styles.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-233">The following table summarizes the differences between the two styles.</span></span>



| <span data-ttu-id="c4ba1-234">Personnalisation</span><span class="sxs-lookup"><span data-stu-id="c4ba1-234">Customization</span></span>                  | <span data-ttu-id="c4ba1-235">Description</span><span class="sxs-lookup"><span data-stu-id="c4ba1-235">Description</span></span>                                                                                                                                                                                                                                                                          |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c4ba1-236">Procédure de hook de style Explorer</span><span class="sxs-lookup"><span data-stu-id="c4ba1-236">Explorer-style Hook procedure</span></span>  | <span data-ttu-id="c4ba1-237">La procédure de hook reçoit des messages de notification envoyés à partir de la boîte de dialogue commune et des messages pour tous les contrôles supplémentaires que vous avez définis en spécifiant un modèle de boîte de dialogue enfant.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-237">The hook procedure receives notification messages sent from the common dialog box and messages for any additional controls that you defined by specifying a child dialog template.</span></span> <span data-ttu-id="c4ba1-238">La procédure de hook ne reçoit pas de messages pour les contrôles standard de la boîte de dialogue par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-238">The hook procedure does not receive messages for the standard controls of the default dialog box.</span></span> |
| <span data-ttu-id="c4ba1-239">Modèle personnalisé de style Explorateur</span><span class="sxs-lookup"><span data-stu-id="c4ba1-239">Explorer-style Custom template</span></span> | <span data-ttu-id="c4ba1-240">Le système utilise le modèle personnalisé pour créer une boîte de dialogue enfant.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-240">The system uses the custom template to create a child dialog box.</span></span> <span data-ttu-id="c4ba1-241">Le modèle peut définir des contrôles supplémentaires et peut spécifier l’emplacement du cluster de contrôles standard.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-241">The template can define additional controls, and can specify the location of the cluster of standard controls.</span></span> <span data-ttu-id="c4ba1-242">Le modèle personnalisé ne remplace pas le modèle par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-242">The custom template does not replace the default template.</span></span>                                          |
| <span data-ttu-id="c4ba1-243">Procédure de hook de style ancien</span><span class="sxs-lookup"><span data-stu-id="c4ba1-243">Old-style Hook procedure</span></span>       | <span data-ttu-id="c4ba1-244">La procédure de hook reçoit tous les messages envoyés à la boîte de dialogue, y compris les messages pour les contrôles standard et les contrôles personnalisés.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-244">The hook procedure receives all messages sent to the dialog box, including messages for the standard controls and any custom controls.</span></span> <span data-ttu-id="c4ba1-245">La procédure de hook reçoit également les messages enregistrés à partir de la boîte de dialogue commune.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-245">The hook procedure also receives registered messages sent from the common dialog box.</span></span>                                                         |
| <span data-ttu-id="c4ba1-246">Ancien modèle personnalisé</span><span class="sxs-lookup"><span data-stu-id="c4ba1-246">Old-style Custom template</span></span>      | <span data-ttu-id="c4ba1-247">Le modèle personnalisé remplace le modèle par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-247">The custom template replaces the default template.</span></span> <span data-ttu-id="c4ba1-248">Créez le modèle personnalisé en modifiant le modèle par défaut spécifié dans le fichier FileOpen. dlg.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-248">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span>                                                                                                                                  |



 

<span data-ttu-id="c4ba1-249">Le titre par défaut pour les deux boîtes de dialogue de style Explorateur et ancien est soit «**ouvrir**», soit «**Enregistrer sous**».</span><span class="sxs-lookup"><span data-stu-id="c4ba1-249">The default title for both Explorer-style and old-style dialog boxes is either "**Open**" or "**Save As**."</span></span> <span data-ttu-id="c4ba1-250">Pour modifier le titre, spécifiez le nouveau titre dans le membre **lpstrTitle** de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-250">To change the title, specify the new title in the **lpstrTitle** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="c4ba1-251">La ruche de Registre **HKEY \_ Current \_ User** d’un utilisateur peut contenir des valeurs qui personnalisent le contenu des boîtes de dialogue **ouvrir** et **Enregistrer sous** de style Explorateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-251">A user's **HKEY\_CURRENT\_USER** registry hive can contain values that customize the contents of the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="c4ba1-252">Ces entrées de Registre affectent uniquement les boîtes de dialogue affichées pour l’utilisateur associé à la ruche du Registre.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-252">These registry entries affect only the dialog boxes displayed for the user associated with the registry hive.</span></span>

<span data-ttu-id="c4ba1-253">Pour masquer les fonctionnalités des boîtes de dialogue **ouvrir** et **Enregistrer sous** d’un navigateur, un administrateur peut définir les valeurs du tableau suivant sous cette sous-clé :</span><span class="sxs-lookup"><span data-stu-id="c4ba1-253">To hide features of Explorer-style **Open** and **Save As** dialog boxes, an administrator can set the values in the following table under this subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
```



| <span data-ttu-id="c4ba1-254">Nom de la valeur</span><span class="sxs-lookup"><span data-stu-id="c4ba1-254">Value name</span></span>       | <span data-ttu-id="c4ba1-255">Valeur</span><span class="sxs-lookup"><span data-stu-id="c4ba1-255">Value</span></span> | <span data-ttu-id="c4ba1-256">Signification</span><span class="sxs-lookup"><span data-stu-id="c4ba1-256">Meaning</span></span>                                  |
|------------------|-------|------------------------------------------|
| <span data-ttu-id="c4ba1-257">**NoPlacesBar**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-257">**NoPlacesBar**</span></span>  | <span data-ttu-id="c4ba1-258">1</span><span class="sxs-lookup"><span data-stu-id="c4ba1-258">1</span></span>     | <span data-ttu-id="c4ba1-259">Masque la barre des emplacements.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-259">Hides the places bar.</span></span>                    |
| <span data-ttu-id="c4ba1-260">**NoFileMRU**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-260">**NoFileMRU**</span></span>    | <span data-ttu-id="c4ba1-261">1</span><span class="sxs-lookup"><span data-stu-id="c4ba1-261">1</span></span>     | <span data-ttu-id="c4ba1-262">Masque la liste des derniers fichiers utilisés (MRU).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-262">Hides the Most Recently Used (MRU) list.</span></span> |
| <span data-ttu-id="c4ba1-263">**NoBackButton**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-263">**NoBackButton**</span></span> | <span data-ttu-id="c4ba1-264">1</span><span class="sxs-lookup"><span data-stu-id="c4ba1-264">1</span></span>     | <span data-ttu-id="c4ba1-265">Masque le bouton **précédent** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-265">Hides the **Back** button.</span></span>               |



 

<span data-ttu-id="c4ba1-266">Le contenu de la barre **emplacements** est déterminé par le contenu de la sous-clé suivante :</span><span class="sxs-lookup"><span data-stu-id="c4ba1-266">The contents of the **Places** bar are determined by the contents of the following subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
                     Placesbar
```

<span data-ttu-id="c4ba1-267">Actuellement, il ne peut y avoir que cinq entrées sous cette clé, et l’index de valeur/nom est de base zéro.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-267">Currently, there can only be five entries under this key, and the value/name index is zero-based.</span></span> <span data-ttu-id="c4ba1-268">Les noms des entrées doivent être Place0, place1, place2, place3 et Place4.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-268">The names for the entries should be Place0, Place1, Place2,Place3, and Place4.</span></span> <span data-ttu-id="c4ba1-269">Les valeurs des entrées peuvent être **reg \_ DWORD**, **reg \_ SZ** ou **reg Expand valeurs \_ \_ SZ** qui identifient les emplacements à inclure dans la barre des emplacements.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-269">The values of the entries can be **REG\_DWORD**, **REG\_SZ**, or **REG\_EXPAND\_SZ** values that identify locations to include in the places bar.</span></span>



| <span data-ttu-id="c4ba1-270">Type de valeur</span><span class="sxs-lookup"><span data-stu-id="c4ba1-270">Value type</span></span>                         | <span data-ttu-id="c4ba1-271">Signification</span><span class="sxs-lookup"><span data-stu-id="c4ba1-271">Meaning</span></span>                                                                                                   |
|------------------------------------|-----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c4ba1-272">**\_valeur DWORD reg**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-272">**REG\_DWORD**</span></span>                     | <span data-ttu-id="c4ba1-273">Valeur CSIDL qui identifie un dossier.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-273">A CSIDL value that identifies a folder.</span></span> <span data-ttu-id="c4ba1-274">Pour obtenir la liste des valeurs CSIDL, consultez [**valeurs CSIDL**](../shell/csidl.md).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-274">For a list of CSIDL values, see [**CSIDL values**](../shell/csidl.md).</span></span> |
| <span data-ttu-id="c4ba1-275">**Reg \_ SZ** ou **reg \_ développé \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-275">**REG\_SZ** or **REG\_EXPAND\_SZ**</span></span> | <span data-ttu-id="c4ba1-276">Chaîne terminée par le caractère null qui spécifie un chemin d’accès valide.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-276">A null-terminated string that specifies a valid path.</span></span>                                                     |



 

## <a name="explorer-style-hook-procedures"></a><span data-ttu-id="c4ba1-277">Procédures de hook Explorer-Style</span><span class="sxs-lookup"><span data-stu-id="c4ba1-277">Explorer-Style Hook Procedures</span></span>

<span data-ttu-id="c4ba1-278">Vous pouvez personnaliser une boîte de dialogue **ouvrir** ou **Enregistrer sous** d’un navigateur en fournissant une procédure de raccordement, un modèle personnalisé, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-278">You can customize an Explorer-style **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="c4ba1-279">Si vous fournissez une procédure de raccordement pour une boîte de dialogue de style Explorateur, le système crée une boîte de dialogue qui est un enfant de la boîte de dialogue par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-279">If you provide a hook procedure for an Explorer-style dialog box, the system creates a dialog box that is a child of the default dialog box.</span></span> <span data-ttu-id="c4ba1-280">La procédure de raccordement agit comme procédure de dialogue pour la boîte de dialogue enfant.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-280">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="c4ba1-281">Cette boîte de dialogue enfant est basée sur le modèle personnalisé ou sur un modèle par défaut si aucun n’est fourni.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-281">This child dialog box is based on the custom template, or on a default template if none is provided.</span></span> <span data-ttu-id="c4ba1-282">Pour plus d’informations, consultez [modèles personnalisés de style Explorateur](#explorer-style-custom-templates).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-282">For more information, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

<span data-ttu-id="c4ba1-283">Pour activer une procédure de Hook pour une boîte de dialogue **ouvrir** ou **Enregistrer sous** de style Explorateur, utilisez la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) lorsque vous créez la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-283">To enable a hook procedure for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="c4ba1-284">Définissez les **indicateurs OFN \_ ENABLEHOOK** et **OFN \_ Explorer** dans le membre **Flags** et spécifiez l’adresse d’une procédure de hook [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) dans le membre **lpfnHook** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-284">Set the **OFN\_ENABLEHOOK** and **OFN\_EXPLORER** flags in the **Flags** member and specify the address of an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="c4ba1-285">Si vous fournissez une procédure de raccordement et omettez l’indicateur **OFN \_ Explorer** , vous devez utiliser une procédure de hook [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) . vous obtiendrez alors l’interface utilisateur de type ancien.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-285">If you provide a hook procedure and omit the **OFN\_EXPLORER** flag, you must use an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and you will get the old-style user-interface.</span></span> <span data-ttu-id="c4ba1-286">Pour plus d’informations, consultez [Personnalisation des boîtes de dialogue de Old-Style](#customizing-old-style-dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-286">For more information, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="c4ba1-287">Une procédure de raccordement de type Explorateur reçoit un grand nombre de messages lorsque la boîte de dialogue est ouverte.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-287">An Explorer-style hook procedure receives a variety of messages while the dialog box is open.</span></span> <span data-ttu-id="c4ba1-288">Ces options en question sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="c4ba1-288">These include the following:</span></span>

-   <span data-ttu-id="c4ba1-289">Le message [**WM \_ INITDIALOG**](wm-initdialog.md) et d’autres messages de boîte de dialogue standard tels que le message de couleur de contrôle [**WM \_ CTLCOLORDLG**](wm-ctlcolordlg.md) .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-289">The [**WM\_INITDIALOG**](wm-initdialog.md) message and other standard dialog box messages such as the [**WM\_CTLCOLORDLG**](wm-ctlcolordlg.md) control color message.</span></span>
-   <span data-ttu-id="c4ba1-290">Ensemble de messages de notification [**WM \_ Notify**](../controls/wm-notify.md) indiquant les actions effectuées par l’utilisateur ou d’autres événements de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-290">A set of [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user or other dialog box events.</span></span>
-   <span data-ttu-id="c4ba1-291">Messages pour tous les contrôles supplémentaires que vous avez définis en spécifiant un modèle de boîte de dialogue enfant.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-291">Messages for any additional controls that you defined by specifying a child dialog template.</span></span>

<span data-ttu-id="c4ba1-292">En outre, il existe un ensemble de messages que vous pouvez envoyer à une boîte de dialogue de type Explorateur pour obtenir des informations ou contrôler le comportement et l’apparence de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-292">In addition, there is a set of messages that you can send to an Explorer-style dialog box to get information or to control the behavior and appearance of the dialog box.</span></span>

<span data-ttu-id="c4ba1-293">Si vous fournissez une procédure de raccordement pour une boîte de dialogue de style Explorateur, la procédure de boîte de dialogue par défaut crée une boîte de dialogue enfant lorsque la procédure de boîte de dialogue par défaut traite son message [**WM \_ INITDIALOG**](wm-initdialog.md) .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-293">If you provide a hook procedure for an Explorer-style dialog box, the default dialog box procedure creates a child dialog box when the default dialog procedure is processing its [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="c4ba1-294">La procédure de raccordement agit comme procédure de dialogue pour la boîte de dialogue enfant.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-294">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="c4ba1-295">À ce stade, la procédure de hook reçoit son propre message **WM \_ INITDIALOG** avec le paramètre *lParam* défini sur l’adresse de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) utilisée pour initialiser la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-295">At this time, the hook procedure receives its own **WM\_INITDIALOG** message with the *lParam* parameter set to the address of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure used to initialize the dialog box.</span></span> <span data-ttu-id="c4ba1-296">Une fois que la boîte de dialogue enfant a fini de traiter son propre message **WM \_ INITDIALOG** , la procédure de dialogue par défaut déplace les contrôles standard, si nécessaire, pour faire de la place pour tous les contrôles supplémentaires de la boîte de dialogue enfant.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-296">After the child dialog finishes processing its own **WM\_INITDIALOG** message, the default dialog procedure moves the standard controls, if necessary, to make room for any additional controls of the child dialog box.</span></span> <span data-ttu-id="c4ba1-297">La procédure de dialogue par défaut envoie ensuite le message de notification [**CDN \_ INITDONE**](cdn-initdone.md) à la procédure de Hook.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-297">The default dialog procedure then sends the [**CDN\_INITDONE**](cdn-initdone.md) notification message to the hook procedure.</span></span>

<span data-ttu-id="c4ba1-298">La procédure de hook reçoit des messages de notification de notification [**WM \_**](../controls/wm-notify.md) indiquant les actions effectuées par l’utilisateur dans la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-298">The hook procedure receives [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user in the dialog box.</span></span> <span data-ttu-id="c4ba1-299">Vous pouvez utiliser certains de ces messages pour contrôler le comportement de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-299">You can use some of these messages to control the behavior of the dialog box.</span></span> <span data-ttu-id="c4ba1-300">Par exemple, la procédure de raccordement reçoit le message [**CDN \_ FILEOK**](cdn-fileok.md) lorsque l’utilisateur choisit un nom de fichier et clique sur le bouton **OK** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-300">For example, the hook procedure receives the [**CDN\_FILEOK**](cdn-fileok.md) message when the user chooses a file name and clicks the **OK** button.</span></span> <span data-ttu-id="c4ba1-301">En réponse à ce message, la procédure de hook peut utiliser la fonction [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) pour rejeter le nom sélectionné et forcer la boîte de dialogue à rester ouverte.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-301">In response to this message, the hook procedure can use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to reject the selected name and force the dialog box to remain open.</span></span>

<span data-ttu-id="c4ba1-302">Le paramètre *lParam* pour chaque message [**WM \_ Notify**](../controls/wm-notify.md) est un pointeur vers une structure [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) ou [**OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) qui définit l’action.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-302">The *lParam* parameter for each [**WM\_NOTIFY**](../controls/wm-notify.md) message is a pointer to an [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) or [**OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) structure that defines the action.</span></span> <span data-ttu-id="c4ba1-303">Le membre de **code** dans l’en-tête de cette structure contient l’un des messages de notification suivants.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-303">The **code** member in the header of this structure contains one of the following notification messages.</span></span>



| <span data-ttu-id="c4ba1-304">Message</span><span class="sxs-lookup"><span data-stu-id="c4ba1-304">Message</span></span>                                           | <span data-ttu-id="c4ba1-305">Signification</span><span class="sxs-lookup"><span data-stu-id="c4ba1-305">Meaning</span></span>                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c4ba1-306">**\_FILEOK CDN**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-306">**CDN\_FILEOK**</span></span>](cdn-fileok.md)                 | <span data-ttu-id="c4ba1-307">L’utilisateur a cliqué sur le bouton **OK** . la boîte de dialogue va être fermée.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-307">The user clicked the **OK** button; the dialog box is about to close.</span></span>                                                                                                                                                                                                                          |
| [<span data-ttu-id="c4ba1-308">**\_FOLDERCHANGE CDN**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-308">**CDN\_FOLDERCHANGE**</span></span>](cdn-folderchange.md)     | <span data-ttu-id="c4ba1-309">L’utilisateur a ouvert un nouveau dossier ou répertoire.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-309">The user opened a new folder or directory.</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="c4ba1-310">**\_aide CDN**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-310">**CDN\_HELP**</span></span>](cdn-help.md)                     | <span data-ttu-id="c4ba1-311">L’utilisateur a cliqué sur le bouton **aide** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-311">The user clicked the **Help** button.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="c4ba1-312">**\_INCLUDEITEM CDN**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-312">**CDN\_INCLUDEITEM**</span></span>](cdn-includeitem.md)       | <span data-ttu-id="c4ba1-313">Détermine si un élément doit être affiché.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-313">Determines whether an item should be displayed.</span></span> <span data-ttu-id="c4ba1-314">Lorsque l’utilisateur ouvre un nouveau dossier ou répertoire, le système envoie cette notification pour chaque élément du dossier ou du répertoire.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-314">When the user opens a new folder or directory, the system sends this notification for each item in the folder or directory.</span></span> <span data-ttu-id="c4ba1-315">Le système envoie cette notification uniquement si l’indicateur **OFN \_ ENABLEINCLUDENOTIFY** a été défini.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-315">The system sends this notification only if the **OFN\_ENABLEINCLUDENOTIFY** flag was set.</span></span>                          |
| [<span data-ttu-id="c4ba1-316">**\_INITDONE CDN**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-316">**CDN\_INITDONE**</span></span>](cdn-initdone.md)             | <span data-ttu-id="c4ba1-317">Le système a terminé l’initialisation de la boîte de dialogue et la boîte de dialogue a terminé le traitement du message [**WM \_ INITDIALOG**](wm-initdialog.md) .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-317">The system has finished initializing the dialog box, and the dialog box has finished processing the [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="c4ba1-318">En outre, le système a terminé la disposition des contrôles dans la boîte de dialogue commune pour faire de la place pour les contrôles de la boîte de dialogue enfant (le cas échéant).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-318">Also, the system has finished arranging controls in the common dialog box to make room for the controls of the child dialog box (if any).</span></span> |
| [<span data-ttu-id="c4ba1-319">**\_selChange CDN**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-319">**CDN\_SELCHANGE**</span></span>](cdn-selchange.md)           | <span data-ttu-id="c4ba1-320">L’utilisateur a sélectionné un nouveau fichier ou dossier dans la liste des fichiers.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-320">The user selected a new file or folder from the file list.</span></span>                                                                                                                                                                                                                                     |
| [<span data-ttu-id="c4ba1-321">**\_SHAREVIOLATION CDN**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-321">**CDN\_SHAREVIOLATION**</span></span>](cdn-shareviolation.md) | <span data-ttu-id="c4ba1-322">La boîte de dialogue commune a rencontré une violation de partage sur le fichier sur le le le sujet du renvoi.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-322">The common dialog box encountered a sharing violation on the file about to be returned.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="c4ba1-323">**\_TYPECHANGE CDN**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-323">**CDN\_TYPECHANGE**</span></span>](cdn-typechange.md)         | <span data-ttu-id="c4ba1-324">L’utilisateur a sélectionné un nouveau type de fichier dans la liste des types de fichiers.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-324">The user selected a new file type from the list of file types.</span></span>                                                                                                                                                                                                                                 |



 

<span data-ttu-id="c4ba1-325">Ces messages de [**\_ notification WM**](../controls/wm-notify.md) remplacent les messages inscrits [**FILEOKSTRING**](fileokstring.md), [**LBSELCHSTRING**](lbselchstring.md), [**SHAREVISTRING**](sharevistring.md)et [**HELPMSGSTRING**](helpmsgstring.md) utilisés par les versions précédentes des boîtes de dialogue **ouvrir** et **Enregistrer sous** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-325">These [**WM\_NOTIFY**](../controls/wm-notify.md) messages supersede the [**FILEOKSTRING**](fileokstring.md), [**LBSELCHSTRING**](lbselchstring.md), [**SHAREVISTRING**](sharevistring.md), and [**HELPMSGSTRING**](helpmsgstring.md) registered messages used by previous versions of the **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="c4ba1-326">Toutefois, la procédure de hook reçoit également le message remplacé après le **message \_ WM Notify** si le traitement de **\_ notification WM** n’utilise pas [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) pour définir une valeur **\_ MSGRESULT DWL** différente de zéro.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-326">However, the hook procedure also receives the superseded message after the **WM\_NOTIFY** message if the **WM\_NOTIFY** processing does not use [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) to set a nonzero **DWL\_MSGRESULT** value.</span></span>

<span data-ttu-id="c4ba1-327">Pour récupérer les informations relatives à l’état de la boîte de dialogue ou contrôler le comportement et l’apparence de la boîte de dialogue, la procédure de raccordement peut envoyer les messages suivants à la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-327">To retrieve information about the status of the dialog box or to control the behavior and appearance of the dialog box, the hook procedure can send the following messages to the dialog box.</span></span>



| <span data-ttu-id="c4ba1-328">Message</span><span class="sxs-lookup"><span data-stu-id="c4ba1-328">Message</span></span>                                             | <span data-ttu-id="c4ba1-329">Signification</span><span class="sxs-lookup"><span data-stu-id="c4ba1-329">Meaning</span></span>                                                                                                                                                                                                                  |
|-----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c4ba1-330">**\_GETFILEPATH CDM**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-330">**CDM\_GETFILEPATH**</span></span>](cdm-getfilepath.md)         | <span data-ttu-id="c4ba1-331">Récupère le chemin d’accès et le nom de fichier du fichier sélectionné.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-331">Retrieves the path and file name of the selected file.</span></span>                                                                                                                                                                   |
| [<span data-ttu-id="c4ba1-332">**\_GETFOLDERIDLIST CDM**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-332">**CDM\_GETFOLDERIDLIST**</span></span>](cdm-getfolderidlist.md) | <span data-ttu-id="c4ba1-333">Récupère la liste d’identificateurs d’éléments correspondant au dossier actif ouvert par la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-333">Retrieves the item identifier list corresponding to the current folder that the dialog box has open.</span></span> <span data-ttu-id="c4ba1-334">Pour plus d’informations sur les listes d’identificateurs d’éléments, consultez [Introduction à l’espace de noms Shell](/windows/desktop/shell/namespace-intro).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-334">For more information about item identifier lists, see [Introduction to the Shell Namespace](/windows/desktop/shell/namespace-intro).</span></span> |
| [<span data-ttu-id="c4ba1-335">**\_GETFOLDERPATH CDM**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-335">**CDM\_GETFOLDERPATH**</span></span>](cdm-getfolderpath.md)     | <span data-ttu-id="c4ba1-336">Récupère le chemin d’accès du dossier ou du répertoire actif pour la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-336">Retrieves the path of the current folder or directory for the dialog box.</span></span>                                                                                                                                                |
| [<span data-ttu-id="c4ba1-337">**\_GETSPEC CDM**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-337">**CDM\_GETSPEC**</span></span>](cdm-getspec.md)                 | <span data-ttu-id="c4ba1-338">Récupère le nom de fichier (sans le chemin d’accès) du fichier actuellement sélectionné dans la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-338">Retrieves the file name (not including the path) of the file currently selected in the dialog box.</span></span>                                                                                                                       |
| [<span data-ttu-id="c4ba1-339">**\_HIDECONTROL CDM**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-339">**CDM\_HIDECONTROL**</span></span>](cdm-hidecontrol.md)         | <span data-ttu-id="c4ba1-340">Masque le contrôle spécifié.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-340">Hides the specified control.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="c4ba1-341">**\_SETCONTROLTEXT CDM**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-341">**CDM\_SETCONTROLTEXT**</span></span>](cdm-setcontroltext.md)   | <span data-ttu-id="c4ba1-342">Définit le texte dans le contrôle spécifié.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-342">Sets the text in the specified control.</span></span>                                                                                                                                                                                  |
| [<span data-ttu-id="c4ba1-343">**\_SETDEFEXT CDM**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-343">**CDM\_SETDEFEXT**</span></span>](cdm-setdefext.md)             | <span data-ttu-id="c4ba1-344">Définit l’extension de nom de fichier par défaut pour la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-344">Sets the default file name extension for the dialog box.</span></span>                                                                                                                                                                 |



 

## <a name="explorer-style-custom-templates"></a><span data-ttu-id="c4ba1-345">Explorer-Style des modèles personnalisés</span><span class="sxs-lookup"><span data-stu-id="c4ba1-345">Explorer-Style Custom Templates</span></span>

<span data-ttu-id="c4ba1-346">Pour définir des contrôles supplémentaires pour une boîte de dialogue **ouvrir** ou **Enregistrer sous** de style Explorateur, utilisez la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) pour spécifier un modèle pour une boîte de dialogue enfant qui contient les contrôles supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-346">To define additional controls for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a template for a child dialog box that contains the additional controls.</span></span> <span data-ttu-id="c4ba1-347">Si votre modèle de boîte de dialogue enfant est une ressource d’une application ou d’une bibliothèque de liens dynamiques, définissez l’indicateur **OFN \_ ENABLETEMPLATE** dans le membre **Flags** et utilisez les membres **HINSTANCE** et **lpTemplateName** de la structure pour identifier le module et le nom de la ressource.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-347">If your child dialog template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="c4ba1-348">Si le modèle est déjà en mémoire, définissez l’indicateur **OFN \_ ENABLETEMPLATEHANDLE** et utilisez le membre **HINSTANCE** pour identifier l’objet mémoire qui contient le modèle.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-348">If the template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="c4ba1-349">Lorsque vous fournissez un modèle de boîte de dialogue enfant pour une boîte de dialogue de type Explorateur, vous devez également définir l’indicateur **OFN \_ Explorer** ; dans le cas contraire, le système suppose que vous fournissez un modèle de remplacement pour une boîte de dialogue de style ancien.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-349">When providing a child dialog template for an Explorer-style dialog box, you must also set the **OFN\_EXPLORER** flag; otherwise, the system assumes you are providing a replacement template for an old-style dialog box.</span></span> <span data-ttu-id="c4ba1-350">En général, si vous fournissez des contrôles supplémentaires, vous devez également fournir une [procédure de hook de style Explorateur](#explorer-style-hook-procedures) pour traiter les messages des nouveaux contrôles.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-350">Typically, if you provide additional controls, you must also provide an [Explorer-style hook procedure](#explorer-style-hook-procedures) to process messages for the new controls.</span></span>

<span data-ttu-id="c4ba1-351">Vous pouvez créer votre modèle de boîte de dialogue enfant de la même façon que vous le feriez pour tout autre modèle, sauf que vous devez spécifier les styles **WS \_ Child** et **WS \_ CLIPSIBLINGS** et spécifier les styles de **\_ contrôle** **DS \_ 3DLOOK** et DS.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-351">You can create your child dialog box template as you do any other template, except that you must specify the **WS\_CHILD** and **WS\_CLIPSIBLINGS** styles and should specify the **DS\_3DLOOK** and **DS\_CONTROL** styles.</span></span> <span data-ttu-id="c4ba1-352">Le système requiert le style **WS \_ Child** , car votre modèle définit une boîte de dialogue enfant de la boîte de dialogue **ouvrir** ou **Enregistrer sous** par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-352">The system requires the **WS\_CHILD** style because your template defines a child dialog of the default **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="c4ba1-353">Le style **WS \_ CLIPSIBLINGS** garantit que la boîte de dialogue enfant ne dessine pas sur l’un des contrôles de la boîte de dialogue par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-353">The **WS\_CLIPSIBLINGS** style ensures that the child dialog box does not paint over any of the controls in the default dialog box.</span></span> <span data-ttu-id="c4ba1-354">Le style **DS \_ 3DLOOK** garantit que l’apparence des contrôles dans la boîte de dialogue enfant est cohérente avec les contrôles de la boîte de dialogue par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-354">The **DS\_3DLOOK** style makes sure that the appearance of the controls in the child dialog box is consistent with the controls in the default dialog box.</span></span> <span data-ttu-id="c4ba1-355">Le style de **\_ contrôle du service d’annuaire** permet de s’assurer que l’utilisateur peut utiliser l’onglet et d’autres touches de navigation pour se déplacer entre tous les contrôles, par défaut ou personnalisés, dans la boîte de dialogue personnalisée.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-355">The **DS\_CONTROL** style makes sure that the user can use the TAB and other navigation keys to move between all controls, default or custom, in the customized dialog box.</span></span>

<span data-ttu-id="c4ba1-356">Pour faire de la place pour les nouveaux contrôles, le système développe la boîte de dialogue par défaut en se sur la largeur et la hauteur de la boîte de dialogue personnalisée.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-356">To make room for the new controls, the system expands the default dialog box by the width and height of the custom dialog box.</span></span> <span data-ttu-id="c4ba1-357">Par défaut, tous les contrôles de la boîte de dialogue personnalisée sont positionnés sous les contrôles dans la boîte de dialogue par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-357">By default, all controls from the custom dialog box are positioned below the controls in the default dialog box.</span></span> <span data-ttu-id="c4ba1-358">Toutefois, vous pouvez remplacer ce positionnement par défaut en incluant un contrôle de texte statique dans votre modèle de boîte de dialogue personnalisé et en lui assignant la valeur de l’identificateur de contrôle de **stc32**.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-358">However, you can override this default positioning by including a static text control in your custom dialog box template and assigning it the control identifier value of **stc32**.</span></span> <span data-ttu-id="c4ba1-359">(Cette valeur est définie dans le fichier d’en-tête Dlgs. h.) Dans ce cas, le système utilise le contrôle comme point de référence pour déterminer où positionner les nouveaux contrôles.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-359">(This value is defined in the Dlgs.h header file.) In this case, the system uses the control as the point of reference for determining where to position the new controls.</span></span> <span data-ttu-id="c4ba1-360">Tous les nouveaux contrôles situés au-dessus et à gauche du contrôle **stc32** sont positionnés au même niveau et à gauche des contrôles dans la boîte de dialogue par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-360">All new controls above and to the left of the **stc32** control are positioned the same amount above and to the left of the controls in the default dialog box.</span></span> <span data-ttu-id="c4ba1-361">Les nouveaux contrôles situés sous et à droite du contrôle **stc32** sont positionnés en dessous et à droite des contrôles par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-361">New controls below and to the right of the **stc32** control are positioned below and to the right of the default controls.</span></span> <span data-ttu-id="c4ba1-362">En général, chaque nouveau contrôle est positionné de façon à ce qu’il ait la même position par rapport aux contrôles par défaut que le contrôle **stc32** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-362">In general, each new control is positioned so that it has the same position relative to the default controls as it had to the **stc32** control.</span></span> <span data-ttu-id="c4ba1-363">Pour faire de la place pour ces nouveaux contrôles, le système ajoute l’espace à gauche, à droite, en bas et en haut de la boîte de dialogue par défaut, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-363">To make room for these new controls, the system adds space to the left, right, bottom, and top of the default dialog box as needed.</span></span>

<span data-ttu-id="c4ba1-364">Le système exige que la procédure de hook traite tous les messages destinés à la boîte de dialogue personnalisée et envoie donc les mêmes messages de fenêtre à la procédure de hook que pour toute autre procédure de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-364">The system requires the hook procedure to process all messages intended for the custom dialog box and therefore sends the same window messages to the hook procedure as to any other dialog box procedure.</span></span> <span data-ttu-id="c4ba1-365">Par exemple, la procédure de hook reçoit des messages de [**\_ commande WM**](/windows/desktop/menurc/wm-command) lorsque l’utilisateur clique sur les contrôles de bouton dans la boîte de dialogue personnalisée.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-365">For example, the hook procedure receives [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages when the user clicks on button controls in the custom dialog box.</span></span> <span data-ttu-id="c4ba1-366">La procédure de raccordement est chargée d’initialiser ces contrôles et de récupérer les valeurs des contrôles lorsque la boîte de dialogue est fermée.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-366">The hook procedure is responsible for initializing these controls and retrieving values from the controls when the dialog box is closed.</span></span> <span data-ttu-id="c4ba1-367">Notez que lorsque la procédure de hook reçoit le message [**WM \_ INITDIALOG**](wm-initdialog.md) , le système n’a pas encore déplacé les contrôles vers leurs positions finales.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-367">Note that when the hook procedure receives the [**WM\_INITDIALOG**](wm-initdialog.md) message, the system has not yet moved the controls to their final positions.</span></span>

<span data-ttu-id="c4ba1-368">La procédure de boîte de dialogue par défaut gère les messages de tous les contrôles dans la boîte de dialogue par défaut, mais la procédure de hook reçoit les messages de notification pour les actions de l’utilisateur sur ces contrôles, comme décrit dans [procédures de hook de style Explorateur](#explorer-style-hook-procedures).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-368">The default dialog box procedure handles messages for all the controls in the default dialog box, but the hook procedure receives the notification messages for user actions on these controls as described in [Explorer-Style Hook Procedures](#explorer-style-hook-procedures).</span></span>

## <a name="explorer-style-control-identifiers"></a><span data-ttu-id="c4ba1-369">Identificateurs de contrôle Explorer-Style</span><span class="sxs-lookup"><span data-stu-id="c4ba1-369">Explorer-Style Control Identifiers</span></span>

<span data-ttu-id="c4ba1-370">Le kit de développement logiciel (SDK) Windows fournit le modèle de boîte de dialogue par défaut pour les anciennes boîtes de dialogue, mais il n’inclut pas le modèle par défaut pour les boîtes de dialogue de style Explorateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-370">The Windows Software Development Kit (SDK) provides the default dialog box template for the old-style dialog boxes, but does not include the default template for the Explorer-style dialog boxes.</span></span> <span data-ttu-id="c4ba1-371">Cela est dû au fait que les boîtes de dialogue de style Explorateur vous permettent d’ajouter vos propres contrôles, mais ne prennent pas en charge la modification du modèle pour les contrôles standard.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-371">This is because the Explorer-style dialog boxes allow you to add your own controls but do not support modifying the template for the standard controls.</span></span> <span data-ttu-id="c4ba1-372">Toutefois, dans certains cas, vous devrez peut-être connaître les identificateurs de contrôle utilisés dans les modèles par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-372">However, in some cases, you may need to know the control identifiers used in the default templates.</span></span> <span data-ttu-id="c4ba1-373">Par exemple, les messages [**CDM \_ HIDECONTROL**](cdm-hidecontrol.md) et [**CDM \_ SETCONTROLTEXT**](cdm-setcontroltext.md) requièrent un identificateur de contrôle.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-373">For example, the [**CDM\_HIDECONTROL**](cdm-hidecontrol.md) and [**CDM\_SETCONTROLTEXT**](cdm-setcontroltext.md) messages require a control identifier.</span></span>

<span data-ttu-id="c4ba1-374">Le tableau suivant présente les identificateurs des contrôles standard dans les boîtes de dialogue **ouvrir** et **Enregistrer sous** de style Explorateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-374">The following table shows the identifiers of the standard controls in the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="c4ba1-375">Les identificateurs sont des constantes définies dans Dlgs. h et winuser. h.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-375">The identifiers are constants defined in Dlgs.h and Winuser.h.</span></span>



| <span data-ttu-id="c4ba1-376">Identificateur de contrôle</span><span class="sxs-lookup"><span data-stu-id="c4ba1-376">Control identifier</span></span> | <span data-ttu-id="c4ba1-377">Description du contrôle</span><span class="sxs-lookup"><span data-stu-id="c4ba1-377">Control description</span></span>                                                                                                                                                                                                                                                                        |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c4ba1-378">**chx1**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-378">**chx1**</span></span>           | <span data-ttu-id="c4ba1-379">Case à cocher en lecture seule</span><span class="sxs-lookup"><span data-stu-id="c4ba1-379">The read-only check box</span></span>                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="c4ba1-380">**cmb1**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-380">**cmb1**</span></span>           | <span data-ttu-id="c4ba1-381">Zone de liste déroulante déroulante qui affiche la liste des filtres de type de fichier</span><span class="sxs-lookup"><span data-stu-id="c4ba1-381">Drop-down combo box that displays the list of file type filters</span></span>                                                                                                                                                                                                                            |
| <span data-ttu-id="c4ba1-382">**stc2**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-382">**stc2**</span></span>           | <span data-ttu-id="c4ba1-383">Étiquette de la zone de liste déroulante **cmb1**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-383">Label for the **cmb1** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="c4ba1-384">**cmb2**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-384">**cmb2**</span></span>           | <span data-ttu-id="c4ba1-385">Zone de liste déroulante déroulante qui affiche le lecteur ou le dossier actif, et qui permet à l’utilisateur de sélectionner un lecteur ou un dossier à ouvrir</span><span class="sxs-lookup"><span data-stu-id="c4ba1-385">Drop-down combo box that displays the current drive or folder, and that allows the user to select a drive or folder to open</span></span>                                                                                                                                                                |
| <span data-ttu-id="c4ba1-386">**stc4**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-386">**stc4**</span></span>           | <span data-ttu-id="c4ba1-387">Étiquette de la zone de liste déroulante **cmb2**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-387">Label for the **cmb2** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="c4ba1-388">**cmb13**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-388">**cmb13**</span></span>          | <span data-ttu-id="c4ba1-389">Zone de liste déroulante déroulante qui affiche le nom du fichier actif, permet à l’utilisateur de taper le nom d’un fichier à ouvrir et sélectionne un fichier qui a été ouvert ou enregistré récemment.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-389">Drop-down combo box that displays the name of the current file, allows the user to type the name of a file to open, and select a file that has been opened or saved recently.</span></span> <span data-ttu-id="c4ba1-390">C’est le cas pour les applications compatibles avec l’Explorateur antérieures sans le modèle de raccordement ou de boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-390">This is for earlier Explorer-compatible applications without hook or dialog template.</span></span> <span data-ttu-id="c4ba1-391">Comparer à **edt1**.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-391">Compare with **edt1**.</span></span> |
| <span data-ttu-id="c4ba1-392">**edt1**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-392">**edt1**</span></span>           | <span data-ttu-id="c4ba1-393">Contrôle d’édition qui affiche le nom du fichier actif, ou permet à l’utilisateur de taper le nom du fichier à ouvrir.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-393">Edit control that displays the name of the current file, or allows the user to type the name of the file to open.</span></span> <span data-ttu-id="c4ba1-394">Comparer à **cmb13**.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-394">Compare with **cmb13**.</span></span>                                                                                                                                                  |
| <span data-ttu-id="c4ba1-395">**stc3**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-395">**stc3**</span></span>           | <span data-ttu-id="c4ba1-396">Étiquette pour la zone de liste déroulante **cmb13** et le contrôle d’édition edt1</span><span class="sxs-lookup"><span data-stu-id="c4ba1-396">Label for the **cmb13** combo box and the edt1 edit control</span></span>                                                                                                                                                                                                                                |
| <span data-ttu-id="c4ba1-397">**lst1**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-397">**lst1**</span></span>           | <span data-ttu-id="c4ba1-398">Zone de liste qui affiche le contenu du lecteur ou du dossier actif</span><span class="sxs-lookup"><span data-stu-id="c4ba1-398">List box that displays the contents of the current drive or folder</span></span>                                                                                                                                                                                                                         |
| <span data-ttu-id="c4ba1-399">**stc1**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-399">**stc1**</span></span>           | <span data-ttu-id="c4ba1-400">Étiquette de la zone de liste **lst1**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-400">Label for the **lst1** list box</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="c4ba1-401">**IDOK**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-401">**IDOK**</span></span>           | <span data-ttu-id="c4ba1-402">Bouton de commande **OK** (bouton de commande)</span><span class="sxs-lookup"><span data-stu-id="c4ba1-402">The **OK** command button (push button)</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="c4ba1-403">**IDCANCEL**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-403">**IDCANCEL**</span></span>       | <span data-ttu-id="c4ba1-404">Bouton de commande **Annuler** (bouton de commande)</span><span class="sxs-lookup"><span data-stu-id="c4ba1-404">The **Cancel** command button (push button)</span></span>                                                                                                                                                                                                                                                |
| <span data-ttu-id="c4ba1-405">**pshHelp**</span><span class="sxs-lookup"><span data-stu-id="c4ba1-405">**pshHelp**</span></span>        | <span data-ttu-id="c4ba1-406">Bouton de commande **d’aide** (bouton de commande)</span><span class="sxs-lookup"><span data-stu-id="c4ba1-406">The **Help** command button (push button)</span></span>                                                                                                                                                                                                                                                  |



 

## <a name="customizing-old-style-dialog-boxes"></a><span data-ttu-id="c4ba1-407">Personnalisation des boîtes de dialogue Old-Style</span><span class="sxs-lookup"><span data-stu-id="c4ba1-407">Customizing Old-Style Dialog Boxes</span></span>

<span data-ttu-id="c4ba1-408">Vous pouvez personnaliser une boîte de dialogue **ouvrir** ou **Enregistrer sous** à l’ancien style en fournissant une procédure de hook [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) qui reçoit des messages ou des notifications destinés à la procédure de boîte de dialogue par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-408">You can customize an old-style **Open** or **Save As** dialog box by providing an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure that receives messages or notifications intended for the default dialog box procedure.</span></span> <span data-ttu-id="c4ba1-409">Vous pouvez également fournir un modèle personnalisé à utiliser à la place du modèle par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-409">You can also provide a custom template to use in place of the default template.</span></span> <span data-ttu-id="c4ba1-410">Les procédures de hook et les modèles utilisés avec les anciennes boîtes de dialogue sont similaires à ceux utilisés avec les autres boîtes de dialogue courantes.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-410">The hook procedures and templates used with the old-style dialog boxes are similar to those used with the other common dialog boxes.</span></span> <span data-ttu-id="c4ba1-411">Pour plus d’informations, consultez [procédures de Hook pour les boîtes de dialogue communes](customizing-common-dialog-boxes.md) et les [modèles personnalisés](customizing-common-dialog-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-411">For more information, see [Hook Procedures for Common Dialog Boxes](customizing-common-dialog-boxes.md) and [Custom Templates](customizing-common-dialog-boxes.md).</span></span>

<span data-ttu-id="c4ba1-412">Pour activer une procédure de Hook pour une boîte de dialogue **ouvrir** ou **Enregistrer sous** de style ancien, utilisez la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) lors de la création de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-412">To enable a hook procedure for an old-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="c4ba1-413">Définissez l' **indicateur OFN \_ ENABLEHOOK** dans le membre **Flags** et spécifiez l’adresse d’une procédure de hook [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) dans le membre **lpfnHook** .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-413">Set the **OFN\_ENABLEHOOK** flag in the **Flags** member and specify the address of an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="c4ba1-414">La procédure de boîte de dialogue envoie un message [**WM \_ INITDIALOG**](wm-initdialog.md) à la procédure de raccordement avec le paramètre *param* défini sur l’adresse de la structure **OpenFileName** utilisée pour initialiser la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-414">The dialog box procedure sends a [**WM\_INITDIALOG**](wm-initdialog.md) message to the hook procedure with the *Param* parameter set to the address of the **OPENFILENAME** structure used to initialize the dialog box.</span></span>

<span data-ttu-id="c4ba1-415">Vous pouvez utiliser la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) pour spécifier un modèle personnalisé pour la boîte de dialogue **ouvrir** ou **Enregistrer sous** à utiliser à la place du modèle par défaut.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-415">You can use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a custom template for the **Open** or **Save As** dialog box to use in place of the default template.</span></span> <span data-ttu-id="c4ba1-416">Si votre modèle personnalisé est une ressource dans une application ou une bibliothèque de liens dynamiques, définissez l’indicateur **OFN \_ ENABLETEMPLATE** dans le membre **Flags** et utilisez les membres **HINSTANCE** et **lpTemplateName** de la structure pour identifier le module et le nom de la ressource.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-416">If your custom template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="c4ba1-417">Si votre modèle personnalisé est déjà en mémoire, définissez l’indicateur **OFN \_ ENABLETEMPLATEHANDLE** et utilisez le membre **HINSTANCE** pour identifier l’objet mémoire qui contient le modèle.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-417">If your custom template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="c4ba1-418">Créez le modèle personnalisé en modifiant le modèle par défaut spécifié dans le fichier FileOpen. dlg.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-418">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span> <span data-ttu-id="c4ba1-419">Les identificateurs de contrôle utilisés dans les modèles de boîte de dialogue Rechercher et remplacer par défaut sont définis dans le fichier Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-419">The control identifiers used in the default Find and Replace dialog templates are defined in the Dlgs.h file.</span></span>

<span data-ttu-id="c4ba1-420">Par défaut, les fonctions [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) et [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) affichent les boîtes de dialogue de style Explorateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-420">By default, the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) and [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions display the Explorer-style dialog boxes.</span></span> <span data-ttu-id="c4ba1-421">Si vous souhaitez afficher une boîte de dialogue de style ancien, vous devez fournir une procédure de hook [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) et vérifier que l’indicateur **OFN \_ Explorer** n’est pas défini dans le membre **Flags** de la structure [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="c4ba1-421">If you want to display an old-style dialog box, you must provide an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and ensure that the **OFN\_EXPLORER** flag is not set in the **Flags** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="c4ba1-422">Si vous définissez l’indicateur **OFN \_ Explorer** , le système traite une procédure de raccordement ou un modèle personnalisé en tant que personnalisation de type Explorateur.</span><span class="sxs-lookup"><span data-stu-id="c4ba1-422">If you set the **OFN\_EXPLORER** flag, the system treats a hook procedure or custom template as an Explorer-style customization.</span></span> <span data-ttu-id="c4ba1-423">Pour plus d’informations sur la personnalisation d’une boîte de dialogue de style Explorateur, consultez [modèles personnalisés de style Explorateur](#explorer-style-custom-templates).</span><span class="sxs-lookup"><span data-stu-id="c4ba1-423">For information about customizing an Explorer-style dialog box, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

## <a name="see-also"></a><span data-ttu-id="c4ba1-424">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c4ba1-424">See also</span></span>

* [<span data-ttu-id="c4ba1-425">Exemple de fichier en cours d’utilisation</span><span class="sxs-lookup"><span data-stu-id="c4ba1-425">File is in use sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse)