---
description: Le mise en pool d’objets est un service automatique fourni par COM+ qui vous permet de configurer un composant pour que des instances de lui-même restent actives dans un pool, prêtes à être utilisées par n’importe quel client qui demande le composant.
ms.assetid: 74a45220-449a-4d89-a979-a206e5e3d3ad
title: Concepts de mise en pool d’objets COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fb2aa6481b2493371801d0d274420d356b0a32e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393015"
---
# <a name="com-object-pooling-concepts"></a><span data-ttu-id="c628c-103">Concepts de mise en pool d’objets COM+</span><span class="sxs-lookup"><span data-stu-id="c628c-103">COM+ Object Pooling Concepts</span></span>

<span data-ttu-id="c628c-104">Le mise en pool d’objets est un service automatique fourni par COM+ qui vous permet de configurer un composant pour que des instances de lui-même restent actives dans un pool, prêtes à être utilisées par n’importe quel client qui demande le composant.</span><span class="sxs-lookup"><span data-stu-id="c628c-104">Object pooling is an automatic service provided by COM+ that enables you to configure a component to have instances of itself kept active in a pool, ready to be used by any client that requests the component.</span></span> <span data-ttu-id="c628c-105">Vous pouvez configurer et surveiller de manière administrative le pool maintenu pour un composant donné, en spécifiant des caractéristiques telles que la taille du pool et les valeurs de délai d’attente de la demande de création.</span><span class="sxs-lookup"><span data-stu-id="c628c-105">You can administratively configure and monitor the pool maintained for a given component, specifying characteristics such as pool size and creation request time-out values.</span></span> <span data-ttu-id="c628c-106">Lorsque l’application est en cours d’exécution, COM+ gère le pool pour vous, en gérant les détails de l’activation et de la réutilisation des objets en fonction des critères que vous avez spécifiés.</span><span class="sxs-lookup"><span data-stu-id="c628c-106">When the application is running, COM+ manages the pool for you, handling the details of object activation and reuse according to the criteria you have specified.</span></span>

<span data-ttu-id="c628c-107">Vous pouvez obtenir des avantages significatifs en termes de performances et de mise à l’échelle en réutilisant les objets de cette manière, en particulier lorsqu’ils sont écrits pour tirer pleinement parti de la réutilisation.</span><span class="sxs-lookup"><span data-stu-id="c628c-107">You can achieve very significant performance and scaling benefits by reusing objects in this manner, particularly when they are written to take full advantage of reuse.</span></span> <span data-ttu-id="c628c-108">Avec la mise en pool d’objets, vous bénéficiez des avantages suivants :</span><span class="sxs-lookup"><span data-stu-id="c628c-108">With object pooling, you gain the following benefits:</span></span>

-   <span data-ttu-id="c628c-109">Vous pouvez accélérer l’utilisation des objets pour chaque client, en déterminant l’initialisation et l’acquisition des ressources fastidieuses à partir du travail réel effectué par l’objet pour les clients.</span><span class="sxs-lookup"><span data-stu-id="c628c-109">You can speed object use time for each client, factoring out time-consuming initialization and resource acquisition from the actual work that the object performs for clients.</span></span>
-   <span data-ttu-id="c628c-110">Vous pouvez partager le coût de l’acquisition de ressources coûteuses sur tous les clients.</span><span class="sxs-lookup"><span data-stu-id="c628c-110">You can share the cost of acquiring expensive resources across all clients.</span></span>
-   <span data-ttu-id="c628c-111">Vous pouvez préallouer des objets au démarrage de l’application avant que les demandes des clients ne soient générées.</span><span class="sxs-lookup"><span data-stu-id="c628c-111">You can pre-allocate objects when the application starts, before any client requests come in.</span></span>
-   <span data-ttu-id="c628c-112">Vous pouvez régir l’utilisation des ressources avec la gestion des pools d’administration. par exemple, en définissant un niveau de pool maximal approprié, vous ne pouvez garder l’Open que le nombre de connexions à la base de données que vous disposez d’une licence pour.</span><span class="sxs-lookup"><span data-stu-id="c628c-112">You can govern resource use with administrative pool management for example, by setting an appropriate maximum pool level, you can keep open only as many database connections as you have a license for.</span></span>
-   <span data-ttu-id="c628c-113">Vous pouvez configurer de façon administrative la mise en pool pour tirer le meilleur parti des ressources matérielles disponibles. vous pouvez facilement ajuster la configuration du pool en fonction de la modification des ressources matérielles disponibles.</span><span class="sxs-lookup"><span data-stu-id="c628c-113">You can administratively configure pooling to take best advantage of available hardware resources you can easily adjust the pool configuration as available hardware resources change.</span></span>
-   <span data-ttu-id="c628c-114">Vous pouvez accélérer la réactivation des objets qui utilisent [l’activation juste-à-temps (JIT)](com--just-in-time-activation.md), tout en contrôlant délibérément la façon dont les ressources sont dédiées aux clients.</span><span class="sxs-lookup"><span data-stu-id="c628c-114">You can speed reactivation time for objects that use [just-in-time (JIT) activation](com--just-in-time-activation.md), while deliberately controlling how resources are dedicated to clients.</span></span>

## <a name="writing-poolable-objects"></a><span data-ttu-id="c628c-115">Écriture d’objets regroupables</span><span class="sxs-lookup"><span data-stu-id="c628c-115">Writing Poolable Objects</span></span>

<span data-ttu-id="c628c-116">Les objets regroupables doivent répondre à certaines exigences pour permettre l’utilisation d’une instance d’objet unique par plusieurs clients.</span><span class="sxs-lookup"><span data-stu-id="c628c-116">Poolable objects must meet certain requirements to enable a single object instance to be used by multiple clients.</span></span> <span data-ttu-id="c628c-117">Par exemple, ils ne peuvent pas conserver l’état du client ou avoir une affinité de thread.</span><span class="sxs-lookup"><span data-stu-id="c628c-117">For example, they can't hold client state or have any thread affinity.</span></span> <span data-ttu-id="c628c-118">Les objets transactionnels ont également des exigences particulières, dans la mesure où les ressources managées détenues par un objet mis en pool doivent être inscrites manuellement dans une transaction.</span><span class="sxs-lookup"><span data-stu-id="c628c-118">Transactional objects also have particular requirements, in that managed resources held by a pooled object must be manually enlisted in a transaction.</span></span>

<span data-ttu-id="c628c-119">Les objets regroupés peuvent implémenter [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) pour contrôler la façon dont ils sont réutilisés.</span><span class="sxs-lookup"><span data-stu-id="c628c-119">Pooled objects can implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) to control how they are reused.</span></span> <span data-ttu-id="c628c-120">Cela leur permet d’effectuer l’initialisation lorsqu’elle est activée dans un contexte donné, de nettoyer tout état du client lors de la désactivation et d’indiquer quand ils sont dans un État non réutilisable.</span><span class="sxs-lookup"><span data-stu-id="c628c-120">This enables them to perform initialization when activated in a given context, to clean up any client state on deactivation, and to indicate when they are in a non-reusable state.</span></span>

<span data-ttu-id="c628c-121">Souvent, il est utile d’écrire des objets pouvant être regroupés de façon quelque peu générique, afin qu’ils puissent être personnalisés de façon administrative avec une chaîne de constructeur.</span><span class="sxs-lookup"><span data-stu-id="c628c-121">Often, it useful to write poolable objects in a somewhat generic fashion so that they can be administratively customized with a constructor string.</span></span> <span data-ttu-id="c628c-122">Par exemple, un objet peut être écrit pour contenir une connexion ODBC générique, avec un nom de source de données particulier, défini administrativement dans une chaîne de constructeur.</span><span class="sxs-lookup"><span data-stu-id="c628c-122">For example, an object might be written to hold a generic ODBC connection, with a particular DSN administratively specified in a constructor string.</span></span>

<span data-ttu-id="c628c-123">Les rubriques de cette section, décrites dans le tableau suivant, fournissent des informations sur le fonctionnement du regroupement d’objets dans COM+, ainsi que des informations sur l’écriture, la configuration et l’implémentation d’objets regroupables.</span><span class="sxs-lookup"><span data-stu-id="c628c-123">The topics in this section, described in the following table, provide information about how object pooling works in COM+, as well as information about how to write, configure, and implement poolable objects.</span></span>



| <span data-ttu-id="c628c-124">Rubrique</span><span class="sxs-lookup"><span data-stu-id="c628c-124">Topic</span></span>                                                                                                 | <span data-ttu-id="c628c-125">Description</span><span class="sxs-lookup"><span data-stu-id="c628c-125">Description</span></span>                                                                                              |
|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c628c-126">Fonctionnement du regroupement d’objets</span><span class="sxs-lookup"><span data-stu-id="c628c-126">How Object Pooling Works</span></span>](how-object-pooling-works.md)<br/>                                   | <span data-ttu-id="c628c-127">Présente les concepts de base.</span><span class="sxs-lookup"><span data-stu-id="c628c-127">Presents basic concepts.</span></span><br/>                                                                      |
| [<span data-ttu-id="c628c-128">Amélioration des performances avec la mise en pool d’objets</span><span class="sxs-lookup"><span data-stu-id="c628c-128">Improving Performance with Object Pooling</span></span>](improving-performance-with-object-pooling.md)<br/> | <span data-ttu-id="c628c-129">Fournit des détails spécifiques sur la façon dont vous pouvez utiliser le regroupement d’objets le plus efficacement possible.</span><span class="sxs-lookup"><span data-stu-id="c628c-129">Provides specific details on how you can use object pooling most effectively.</span></span><br/>                 |
| [<span data-ttu-id="c628c-130">Conditions requises pour les objets regroupables</span><span class="sxs-lookup"><span data-stu-id="c628c-130">Requirements for Poolable Objects</span></span>](requirements-for-poolable-objects.md)<br/>                 | <span data-ttu-id="c628c-131">Fournit des détails sur l’écriture d’un objet qui doit être regroupé.</span><span class="sxs-lookup"><span data-stu-id="c628c-131">Provides details on how to write an object that is to be pooled.</span></span><br/>                              |
| [<span data-ttu-id="c628c-132">Regroupement d’objets transactionnels</span><span class="sxs-lookup"><span data-stu-id="c628c-132">Pooling Transactional Objects</span></span>](pooling-transactional-objects.md)<br/>                         | <span data-ttu-id="c628c-133">Fournit des détails sur les exigences spéciales qui s’appliquent aux objets transactionnels regroupables.</span><span class="sxs-lookup"><span data-stu-id="c628c-133">Provides details about the special requirements that apply to poolable transactional objects.</span></span><br/> |
| [<span data-ttu-id="c628c-134">Contrôle de la durée de vie et de l’état des objets</span><span class="sxs-lookup"><span data-stu-id="c628c-134">Controlling Object Lifetime and State</span></span>](controlling-object-lifetime-and-state.md)<br/>         | <span data-ttu-id="c628c-135">Décrit comment implémenter des objets regroupés pour contrôler la façon dont ils sont réutilisés.</span><span class="sxs-lookup"><span data-stu-id="c628c-135">Describes how pooled objects can be implemented to control how they are reused.</span></span><br/>               |



 

## <a name="related-topics"></a><span data-ttu-id="c628c-136">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c628c-136">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c628c-137">Tâches de mise en pool d’objets COM+</span><span class="sxs-lookup"><span data-stu-id="c628c-137">COM+ Object Pooling Tasks</span></span>](com--object-pooling-tasks.md)
</dt> </dl>

 

 




