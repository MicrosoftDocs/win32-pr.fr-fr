---
description: Le service d’activation juste-à-temps (JIT) permet à COM+ de désactiver un objet alors qu’un client contient toujours une référence active à cet objet.
ms.assetid: dbc7b257-8506-42c8-8a78-3474c6d4f4b6
title: Concepts d’activation juste-à-temps de COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6c942bfeb342ea305083e0c7d7ebdea2fe96bf24
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106513924"
---
# <a name="com-just-in-time-activation-concepts"></a><span data-ttu-id="d374d-103">Concepts d’activation juste-à-temps de COM+</span><span class="sxs-lookup"><span data-stu-id="d374d-103">COM+ Just-in-Time Activation Concepts</span></span>

<span data-ttu-id="d374d-104">Le service d’activation juste-à-temps (JIT) permet à COM+ de désactiver un objet alors qu’un client contient toujours une référence active à cet objet.</span><span class="sxs-lookup"><span data-stu-id="d374d-104">The just-in-time (JIT) activation service enables COM+ to deactivate an object while a client still holds an active reference to that object.</span></span> <span data-ttu-id="d374d-105">La prochaine fois que le client appelle une méthode sur l’objet, que le client estime toujours actif, le service d’activation JIT COM+ réactive l’objet de manière transparente au client, juste à temps.</span><span class="sxs-lookup"><span data-stu-id="d374d-105">The next time the client calls a method on the object, which the client believes to be still active, the COM+ JIT activation service reactivates the object transparently to the client, just in time.</span></span>

<span data-ttu-id="d374d-106">Le principal avantage de l’utilisation de COM + l’activation JIT est que vous pouvez permettre aux clients de conserver des références aux objets aussi longtemps qu’ils en ont besoin, sans nécessairement mettre en place des ressources serveur précieuses telles que la mémoire.</span><span class="sxs-lookup"><span data-stu-id="d374d-106">The main advantage of using COM + JIT activation is that you can enable clients to hold references to objects for as long as they need them, without necessarily tying up valuable server resources such as memory.</span></span> <span data-ttu-id="d374d-107">Les autres avantages importants sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="d374d-107">Other important benefits include the following:</span></span>

-   <span data-ttu-id="d374d-108">L’utilisation du service d’activation JIT COM+ simplifie grandement le modèle de programmation pour le client, car le client n’a pas à réfléchir à la façon dont il utilise des objets serveur et des ressources serveur coûteux.</span><span class="sxs-lookup"><span data-stu-id="d374d-108">Using the COM+ JIT activation service greatly simplifies the programming model for the client because the client doesn't have to think about how it uses expensive server objects and server resources.</span></span> <span data-ttu-id="d374d-109">Sans l’activation JIT, les clients peuvent subir une pénalité significative lorsqu’ils ont souvent besoin d’appeler et de libérer des objets.</span><span class="sxs-lookup"><span data-stu-id="d374d-109">Without JIT activation, clients can incur a significant penalty when they frequently need to call and release objects.</span></span>
    > [!Note]  
    > <span data-ttu-id="d374d-110">Vous pouvez affiner ce gain de performances en utilisant le service de mise en [pool d’objets com+](com--object-pooling.md) .</span><span class="sxs-lookup"><span data-stu-id="d374d-110">You can refine this performance benefit further by using the [COM+ Object Pooling](com--object-pooling.md) service.</span></span> <span data-ttu-id="d374d-111">En regroupant les objets activés par le JIT, vous pouvez considérablement accélérer la réactivation des objets pour les clients tout en réutilisant les ressources qu’ils peuvent contenir, ce qui vous permet de contrôler plus précisément la quantité de mémoire utilisée par un objet donné sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="d374d-111">By pooling JIT-activated objects, you can greatly speed object reactivation for clients while reusing whatever resources they might be holding, giving you more precise control over how much memory is used by a given object on the server.</span></span> <span data-ttu-id="d374d-112">Pour plus d’informations, consultez mise en [pool d’objets et activation JIT com+](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="d374d-112">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

     

-   <span data-ttu-id="d374d-113">Avec les applications distribuées, un aller-retour réseau onéreux est nécessaire pour la création de chaque objet, et plus le client est éloigné du serveur, plus les coûts d’activation et de marshaling de l’objet serveur, d’ouverture du canal et de configuration du proxy et du stub sont importants.</span><span class="sxs-lookup"><span data-stu-id="d374d-113">With distributed applications, an expensive network round-trip is required for the creation of every object, and the farther the client is from the server, the greater the costs of activating and marshaling the server object, opening the channel, and setting up the proxy and stub.</span></span> <span data-ttu-id="d374d-114">En utilisant le service d’activation JIT COM+, vous pouvez réduire la fréquence de création des objets pour améliorer de manière significative les performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="d374d-114">By using the COM+ JIT activation service, you can minimize the frequency of object creation to significantly improve the performance of your application.</span></span>
-   <span data-ttu-id="d374d-115">Lorsque vous utilisez l’activation JIT COM+ pour activer les objets sur lesquels les clients contiennent des références à long terme, mais qui ne sont pas nécessairement utilisées tout le temps, la mémoire du serveur n’est pas toujours liée à la conservation de ces objets actifs.</span><span class="sxs-lookup"><span data-stu-id="d374d-115">When you use COM+ JIT activation to activate those objects to which clients hold long-lived references but which they aren't necessarily using all the time, server memory is not always tied up keeping those objects alive.</span></span> <span data-ttu-id="d374d-116">Cela peut augmenter considérablement l’évolutivité de votre application.</span><span class="sxs-lookup"><span data-stu-id="d374d-116">This can significantly increase the scalability of your application.</span></span> <span data-ttu-id="d374d-117">Le seul impact sur les performances que les clients voient est le temps qu’il faut pour réactiver l’objet, généralement plus de temps qu’il n’en faut pour allouer de la mémoire pour l’objet et sensiblement inférieur à l’aller-retour réseau pour la création de l’objet distant.</span><span class="sxs-lookup"><span data-stu-id="d374d-117">The only performance hit that clients see is the time it takes COM+ to reactivate the object, usually just marginally more time than it takes to allocate memory for the object and substantially less than the network round-trip for remote object creation.</span></span>

## <a name="enabling-com-jit-activation"></a><span data-ttu-id="d374d-118">Activation de l’activation JIT COM+</span><span class="sxs-lookup"><span data-stu-id="d374d-118">Enabling COM+ JIT Activation</span></span>

<span data-ttu-id="d374d-119">Vous pouvez activer le service d’activation JIT COM+ pour un composant à l’aide de l’outil d’administration Services de composants ou des fonctions d’administration.</span><span class="sxs-lookup"><span data-stu-id="d374d-119">You can enable the COM+ JIT activation service for a component by using either the Component Services administrative tool or the Administrative functions.</span></span> <span data-ttu-id="d374d-120">Pour plus d’informations sur la façon de procéder, consultez [activation de l’activation JIT pour un composant](enabling-jit-activation-for-a-component.md).</span><span class="sxs-lookup"><span data-stu-id="d374d-120">For details about how to do this, see [Enabling JIT Activation for a Component](enabling-jit-activation-for-a-component.md).</span></span>

<span data-ttu-id="d374d-121">L’activation JIT COM+ peut interagir avec d’autres services COM+, tels que les suivants :</span><span class="sxs-lookup"><span data-stu-id="d374d-121">COM+ JIT activation can interact with other COM+ services, such as the following:</span></span>

-   <span data-ttu-id="d374d-122">Lorsque votre composant requiert des transactions, l’activation JIT est automatiquement activée pour celle-ci.</span><span class="sxs-lookup"><span data-stu-id="d374d-122">When your component requires transactions, JIT activation is automatically enabled for it.</span></span> <span data-ttu-id="d374d-123">Pour plus d’informations, consultez [transactions et activation JIT com+](transactions-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="d374d-123">For greater detail, see [Transactions and COM+ JIT Activation](transactions-and-com--jit-activation.md).</span></span>
-   <span data-ttu-id="d374d-124">Lorsque votre composant est activé pour l’activation juste-à-temps, la synchronisation est automatiquement définie sur obligatoire.</span><span class="sxs-lookup"><span data-stu-id="d374d-124">When your component is enabled for JIT activation, synchronization is automatically set to required.</span></span> <span data-ttu-id="d374d-125">Cela signifie que si deux clients appellent simultanément un composant activé juste-à-temps et un appel de méthode pour l’un d’eux retourne, ce qui entraîne la désactivation de l’objet, l’autre n’est pas laissée bloquée.</span><span class="sxs-lookup"><span data-stu-id="d374d-125">This means that if two clients simultaneously call a JIT-activated component and a method call for one of them returns, causing the object to be deactivated, the other is not left stranded.</span></span>

## <a name="how-deactivation-is-triggered"></a><span data-ttu-id="d374d-126">Mode de déclenchement de la désactivation</span><span class="sxs-lookup"><span data-stu-id="d374d-126">How Deactivation Is Triggered</span></span>

<span data-ttu-id="d374d-127">COM+ désactive un objet en fonction de l’état du bit de réalisation sur le contexte de l’objet.</span><span class="sxs-lookup"><span data-stu-id="d374d-127">COM+ deactivates an object based on the status of the doneness bit on the object context.</span></span> <span data-ttu-id="d374d-128">Votre objet peut utiliser ce bit pour signaler s’il est terminé (c’est-à-dire prêt à être désactivé) pendant un appel de méthode donné.</span><span class="sxs-lookup"><span data-stu-id="d374d-128">Your object can use this bit to signal whether it is done—that is, ready to be deactivated—during a given method call.</span></span> <span data-ttu-id="d374d-129">Pour plus d’informations, consultez [définition du bit terminé](setting-the-done-bit.md).</span><span class="sxs-lookup"><span data-stu-id="d374d-129">For more information, see [Setting the Done Bit](setting-the-done-bit.md).</span></span>

## <a name="using-the-auto-done-property"></a><span data-ttu-id="d374d-130">Utilisation de la propriété Done automatique</span><span class="sxs-lookup"><span data-stu-id="d374d-130">Using the Auto-Done Property</span></span>

<span data-ttu-id="d374d-131">À l’aide de l’outil d’administration Services de composants, vous pouvez configurer une méthode de sorte que l’objet soit automatiquement désactivé lors du retour de la méthode.</span><span class="sxs-lookup"><span data-stu-id="d374d-131">Using the Component Services administrative tool, you can configure a method such that the object is automatically deactivated on method return.</span></span> <span data-ttu-id="d374d-132">(Pour obtenir des instructions sur la définition de cette propriété, consultez [activation de la saisie semi-automatique pour une méthode](enabling-auto-done-for-a-method.md) .) En sélectionnant cette option, vous pouvez éliminer les appels de méthode répétitifs pour voter dans les transactions.</span><span class="sxs-lookup"><span data-stu-id="d374d-132">(See [Enabling Auto-Done for a Method](enabling-auto-done-for-a-method.md) for instructions about how to set this property.) By selecting this option, you can eliminate the repetitive method calls for voting in transactions.</span></span> <span data-ttu-id="d374d-133">Étant donné que le paramètre par défaut pour le bit de cohérence a la valeur true, si vous avez également modifié le bit Done en true et que vous n’effectuez aucune action pour modifier ces paramètres, [**IObjectContext :: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) est appelé automatiquement après le retour de la méthode.</span><span class="sxs-lookup"><span data-stu-id="d374d-133">Because the default setting for the consistency bit is True, if you have changed the done bit to True as well and you take no action to change these settings, [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) is called automatically after the method returns.</span></span>

<span data-ttu-id="d374d-134">Toutefois, il existe un inconvénient à ce comportement : COM+ examine le HRESULT retourné par la méthode.</span><span class="sxs-lookup"><span data-stu-id="d374d-134">However, there is one caveat to this behavior: COM+ will examine the HRESULT that the method returns.</span></span> <span data-ttu-id="d374d-135">Si cette valeur HRESULT indique un échec, le bit de cohérence est défini sur false et le résultat est le même que si vous aviez appelé [**IObjectContext :: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span><span class="sxs-lookup"><span data-stu-id="d374d-135">If that HRESULT indicates failure, the consistency bit is set to False and the result is the same as if you had called [**IObjectContext::SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

<span data-ttu-id="d374d-136">Pour résumer, si vous sélectionnez terminé automatiquement pour une méthode et que vous n’effectuez aucune action pour définir des bits, et si un HRESULT (HR) est retourné, les conditions suivantes s’appliquent :</span><span class="sxs-lookup"><span data-stu-id="d374d-136">To summarize, if you select auto-done for a method and don't take any action to set any bits, and if an HRESULT(hr) is returned, the following applies:</span></span>

-   <span data-ttu-id="d374d-137">Si la méthode est réussie (HR), c’est comme si vous appeliez [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span><span class="sxs-lookup"><span data-stu-id="d374d-137">If SUCCEEDS(hr), it is as though you called [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span></span>
-   <span data-ttu-id="d374d-138">En cas d’échec (HR), c’est comme si vous appeliez [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span><span class="sxs-lookup"><span data-stu-id="d374d-138">If FAILED(hr), it is as though you called [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

## <a name="using-iobjectcontrol-to-manage-object-activation-and-deactivation"></a><span data-ttu-id="d374d-139">Utilisation de IObjectControl pour gérer l’activation et la désactivation d’objets</span><span class="sxs-lookup"><span data-stu-id="d374d-139">Using IObjectControl to Manage Object Activation and Deactivation</span></span>

<span data-ttu-id="d374d-140">Vous pouvez implémenter l’interface [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) afin que le runtime com+ gère automatiquement la désactivation et la réactivation de vos objets.</span><span class="sxs-lookup"><span data-stu-id="d374d-140">You can implement the [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) interface so that the COM+ runtime automatically manages deactivation and reactivation for your objects.</span></span> <span data-ttu-id="d374d-141">Lorsqu’un objet implémente cette interface, COM+ appelle [**IObjectControl ::D eactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) quand il désactive l’objet et [**IObjectControl :: Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) lorsqu’il le réactive.</span><span class="sxs-lookup"><span data-stu-id="d374d-141">When an object implements this interface, COM+ calls [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) when it deactivates the object and [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) when it reactivates it.</span></span> <span data-ttu-id="d374d-142">Ces méthodes activent l’initialisation de contexte automatique sur l’activation d’objet et le nettoyage de l’État sur la désactivation.</span><span class="sxs-lookup"><span data-stu-id="d374d-142">These methods enable automatic context initialization on object activation and cleanup of state on deactivation.</span></span>

<span data-ttu-id="d374d-143">Si vous regroupez des objets qui utilisent l’activation JIT COM+, il est vivement recommandé d’implémenter [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span><span class="sxs-lookup"><span data-stu-id="d374d-143">If you are pooling objects that use COM+ JIT activation, it is highly recommended that you implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="d374d-144">Pour plus d’informations, consultez mise en [pool d’objets et activation JIT com+](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="d374d-144">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

## <a name="statelessness-and-jit-activation"></a><span data-ttu-id="d374d-145">Abandon et activation JIT</span><span class="sxs-lookup"><span data-stu-id="d374d-145">Statelessness and JIT Activation</span></span>

<span data-ttu-id="d374d-146">Les objets transactionnels sont nécessairement sans État, car vous ne pouvez pas partager l’État à travers une limite de transaction.</span><span class="sxs-lookup"><span data-stu-id="d374d-146">Transactional objects are necessarily stateless because you cannot share state across a transaction boundary.</span></span> <span data-ttu-id="d374d-147">Par conséquent, vous devez utiliser l’activation juste-à-temps uniquement lorsque votre objet ne contient aucun État qui serait perdu lors de la désactivation. dans le cas contraire, vous ne respectez pas l’isolation des transactions.</span><span class="sxs-lookup"><span data-stu-id="d374d-147">Therefore, you would use JIT activation only when your object holds no state that would be lost on deactivation; otherwise, you violate the isolation of the transactions.</span></span> <span data-ttu-id="d374d-148">En raison des modèles d’utilisation naturelle des objets transactionnels, ils effectuent une certaine unité de travail et libèrent l’objet lorsque la transaction est validée ou abandonnée : l’activation juste-à-temps et les transactions automatiques sont étroitement liées.</span><span class="sxs-lookup"><span data-stu-id="d374d-148">Due to the natural use patterns of transactional objects—they do some unit of work and release the object when the transaction commits or aborts—JIT activation and automatic transactions are closely related.</span></span> <span data-ttu-id="d374d-149">La configuration d’un objet pour exiger des transactions active automatiquement COM+ JIT activation.</span><span class="sxs-lookup"><span data-stu-id="d374d-149">Configuring an object to require transactions enables COM+ JIT activation automatically.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d374d-150">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="d374d-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d374d-151">Tâches d’activation juste-à-temps COM+</span><span class="sxs-lookup"><span data-stu-id="d374d-151">COM+ Just-in-Time Activation Tasks</span></span>](com--just-in-time-activation-tasks.md)
</dt> <dt>

[<span data-ttu-id="d374d-152">Mise en pool d’objets et activation JIT COM+</span><span class="sxs-lookup"><span data-stu-id="d374d-152">Object Pooling and COM+ JIT Activation</span></span>](object-pooling-and-com--jit-activation.md)
</dt> <dt>

[<span data-ttu-id="d374d-153">Transactions et activation JIT COM+</span><span class="sxs-lookup"><span data-stu-id="d374d-153">Transactions and COM+ JIT Activation</span></span>](transactions-and-com--jit-activation.md)
</dt> </dl>

 

 



