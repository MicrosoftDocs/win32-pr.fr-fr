---
description: Dans certains cas, une application serveur doit présenter une identité de clients aux ressources auxquelles elle accède au nom des clients, généralement pour faire en sorte que les contrôles d’accès ou l’authentification soient effectués sur l’identité des clients.
ms.assetid: fd75eb54-eefe-411f-a7aa-0bc8628f8778
title: Emprunt d’identité et délégation du client
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7557dcde4cadf559dd8e116cf4e7bece4221aaae
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106516182"
---
# <a name="client-impersonation-and-delegation"></a><span data-ttu-id="8e701-103">Emprunt d’identité et délégation du client</span><span class="sxs-lookup"><span data-stu-id="8e701-103">Client Impersonation and Delegation</span></span>

<span data-ttu-id="8e701-104">Dans certains cas, une application serveur doit présenter l’identité d’un client aux ressources auxquelles elle accède au nom du client, généralement pour faire en sorte que les contrôles d’accès ou l’authentification soient effectués sur l’identité du client.</span><span class="sxs-lookup"><span data-stu-id="8e701-104">In some circumstances, a server application needs to present a client's identity to resources it accesses on the client's behalf, usually to cause access checks or authentication to be performed against the client's identity.</span></span> <span data-ttu-id="8e701-105">Dans une certaine mesure, le serveur peut agir sous l’identité du client, une action appelée empruntant l’identité du client.</span><span class="sxs-lookup"><span data-stu-id="8e701-105">To a certain extent, the server can act under the client's identity—an action referred to as impersonating the client.</span></span>

<span data-ttu-id="8e701-106">L' *emprunt d’identité* est la capacité d’un thread à s’exécuter dans un contexte de sécurité différent de celui du processus qui possède le thread.</span><span class="sxs-lookup"><span data-stu-id="8e701-106">*Impersonation* is the ability of a thread to execute in a security context different from that of the process owning the thread.</span></span> <span data-ttu-id="8e701-107">Le thread serveur utilise un jeton d’accès qui représente les informations d’identification du client et, avec cela, il peut accéder aux ressources auxquelles le client peut accéder.</span><span class="sxs-lookup"><span data-stu-id="8e701-107">The server thread uses an access token representing the client's credentials, and with this, it can access resources that the client can access.</span></span>

<span data-ttu-id="8e701-108">L’utilisation de l’emprunt d’identité permet de s’assurer que le serveur peut faire précisément ce que le client peut faire.</span><span class="sxs-lookup"><span data-stu-id="8e701-108">Using impersonation ensures that the server can do precisely what the client can do.</span></span> <span data-ttu-id="8e701-109">L’accès aux ressources peut être restreint ou développé, en fonction de ce que le client est autorisé à faire.</span><span class="sxs-lookup"><span data-stu-id="8e701-109">Access to resources may be either restricted or expanded, depending on what the client has permission to do.</span></span>

<span data-ttu-id="8e701-110">Vous pouvez choisir de faire en sorte qu’un serveur emprunte l’identité d’un client lors de la connexion à une base de données afin que la base de données puisse s’authentifier et autoriser le client pour lui-même.</span><span class="sxs-lookup"><span data-stu-id="8e701-110">You might choose to have a server impersonate a client when connecting to a database so that the database can authenticate and authorize the client for itself.</span></span> <span data-ttu-id="8e701-111">Ou, si votre application accède à des fichiers protégés par un descripteur de sécurité et pour permettre au client d’obtenir un accès autorisé aux informations contenues dans ces fichiers, l’application peut emprunter l’identité du client avant d’accéder aux fichiers.</span><span class="sxs-lookup"><span data-stu-id="8e701-111">Or, if your application accesses files that are protected with a security descriptor and to enable the client to obtain authorized access to information in these files, the application can impersonate the client before accessing the files.</span></span>

## <a name="how-to-implement-impersonation"></a><span data-ttu-id="8e701-112">Comment implémenter l’emprunt d’identité</span><span class="sxs-lookup"><span data-stu-id="8e701-112">How to Implement Impersonation</span></span>

<span data-ttu-id="8e701-113">L’emprunt d’identité requiert la participation du client et du serveur (et, dans certains cas, des administrateurs système).</span><span class="sxs-lookup"><span data-stu-id="8e701-113">Impersonation requires participation by both client and server (and, in some cases, system administrators).</span></span> <span data-ttu-id="8e701-114">Le client doit indiquer sa volonté de laisser le serveur utiliser son identité, et le serveur doit supposer explicitement l’identité du client par programme.</span><span class="sxs-lookup"><span data-stu-id="8e701-114">The client must indicate its willingness to let the server use its identity, and the server must explicitly assume the client's identity programmatically.</span></span> <span data-ttu-id="8e701-115">Pour plus d’informations, consultez les rubriques [Configuration requise côté client pour l’emprunt d’identité](client-side-requirements-for-impersonation.md) et [exigences côté serveur pour l’emprunt d’identité](server-side-requirements-for-impersonation.md).</span><span class="sxs-lookup"><span data-stu-id="8e701-115">For details, see the topics [Client-Side Requirements for Impersonation](client-side-requirements-for-impersonation.md) and [Server-Side Requirements for Impersonation](server-side-requirements-for-impersonation.md).</span></span>

## <a name="administrative-requirements-for-delegate-level-impersonation"></a><span data-ttu-id="8e701-116">Configuration administrative requise pour l’emprunt d’identité Delegate-Level</span><span class="sxs-lookup"><span data-stu-id="8e701-116">Administrative Requirements for Delegate-Level Impersonation</span></span>

<span data-ttu-id="8e701-117">Pour utiliser efficacement la forme d’emprunt d’identité la plus puissante, la *délégation*, qui est l’emprunt d’identité des clients sur le réseau, les comptes d’utilisateurs du client et du serveur doivent être correctement configurés dans le service Active Directory pour la prise en charge (en plus de l’autorité d’octroi du client pour l’emprunt d’identité au niveau du délégué), comme suit :</span><span class="sxs-lookup"><span data-stu-id="8e701-117">To effectively use the most powerful form of impersonation, *delegation*, which is the impersonation of clients over the network, the client and server user accounts must be properly configured in the Active Directory Service to support it (in addition to the client granting authority to do delegate-level impersonation), as follows:</span></span>

-   <span data-ttu-id="8e701-118">L’identité du serveur doit être marquée comme « approuvée pour la délégation » dans le service Active Directory.</span><span class="sxs-lookup"><span data-stu-id="8e701-118">The server identity must be marked as "Trusted for delegation" in the Active Directory Service.</span></span>
-   <span data-ttu-id="8e701-119">L’identité du client ne doit pas être marquée comme « le compte est sensible et ne peut pas être délégué » dans le service Active Directory.</span><span class="sxs-lookup"><span data-stu-id="8e701-119">The client identity must not be marked as "Account is sensitive and cannot be delegated" in the Active Directory Service.</span></span>

<span data-ttu-id="8e701-120">Ces fonctionnalités de configuration offrent à l’administrateur de domaine un degré élevé de contrôle sur la délégation, ce qui est souhaitable, compte tenu de la confiance (et donc des risques de sécurité).</span><span class="sxs-lookup"><span data-stu-id="8e701-120">These configuration features give the domain administrator a high degree of control over delegation, which is desirable, given how much trust (and hence security risk) is involved.</span></span> <span data-ttu-id="8e701-121">Pour plus d’informations sur la délégation, consultez [délégation et emprunt d’identité](/windows/desktop/com/delegation-and-impersonation).</span><span class="sxs-lookup"><span data-stu-id="8e701-121">For more detail about delegation, see [Delegation and Impersonation](/windows/desktop/com/delegation-and-impersonation).</span></span>

## <a name="cloaking"></a><span data-ttu-id="8e701-122">Masquer</span><span class="sxs-lookup"><span data-stu-id="8e701-122">Cloaking</span></span>

<span data-ttu-id="8e701-123">En plus de l’autorité qu’un client accorde à un serveur via le niveau d’emprunt d’identité, la fonctionnalité de voilage du serveur détermine en grande partie comment l’emprunt d’identité se comportera.</span><span class="sxs-lookup"><span data-stu-id="8e701-123">Along with the authority a client grants a server through the impersonation level, the server's cloaking capability largely determines how impersonation will behave.</span></span> <span data-ttu-id="8e701-124">Le masquage affecte l’identité qui est réellement présentée par le serveur lorsqu’il effectue des appels au nom du client, son propre ou le client.</span><span class="sxs-lookup"><span data-stu-id="8e701-124">Cloaking affects what identity is actually presented by the server when it makes calls on the client's behalf—its own or the client's.</span></span> <span data-ttu-id="8e701-125">Pour plus d’informations, consultez [masquage](cloaking.md).</span><span class="sxs-lookup"><span data-stu-id="8e701-125">For details, see [Cloaking](cloaking.md).</span></span>

## <a name="performance-implications"></a><span data-ttu-id="8e701-126">Impact sur les performances</span><span class="sxs-lookup"><span data-stu-id="8e701-126">Performance Implications</span></span>

<span data-ttu-id="8e701-127">L’emprunt d’identité peut avoir un impact significatif sur les performances et la mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="8e701-127">Impersonation can significantly affect performance and scaling.</span></span> <span data-ttu-id="8e701-128">Il est généralement plus coûteux d’emprunter l’identité d’un client sur un appel que d’effectuer l’appel directement.</span><span class="sxs-lookup"><span data-stu-id="8e701-128">It is generally more expensive to impersonate a client on a call than to make the call directly.</span></span> <span data-ttu-id="8e701-129">Voici quelques-uns des problèmes à prendre en compte :</span><span class="sxs-lookup"><span data-stu-id="8e701-129">Following are some of the issues to consider:</span></span>

-   <span data-ttu-id="8e701-130">La surcharge de calcul qui consiste à transmettre l’identité en modèles compliqués, en particulier si le voilage dynamique est activé.</span><span class="sxs-lookup"><span data-stu-id="8e701-130">The computational overhead of passing around identity in complicated patterns, particularly if dynamic cloaking is enabled.</span></span>
-   <span data-ttu-id="8e701-131">La complexité générale de l’application de la vérification de la sécurité redondante à de nombreux emplacements, plutôt que de centraliser la couche intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="8e701-131">The general complexity of enforcing redundant security checking in numerous places, instead of just centrally in the middle tier.</span></span>
-   <span data-ttu-id="8e701-132">Les ressources telles que les connexions de base de données, lors de l’ouverture d’emprunt d’identité d’un client, ne peuvent pas être réutilisées sur plusieurs clients, ce qui est un très grand obstacle à la mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="8e701-132">Resources such as database connections, when opened impersonating a client, cannot be reused across multiple clients—a very large roadblock to scaling well.</span></span>

<span data-ttu-id="8e701-133">Parfois, la seule solution efficace à un problème consiste à utiliser l’emprunt d’identité, mais cette décision doit être soigneusement pesée.</span><span class="sxs-lookup"><span data-stu-id="8e701-133">Sometimes the only effective solution to a problem is to use impersonation, but this decision should be carefully weighed.</span></span> <span data-ttu-id="8e701-134">Pour plus d’informations sur ces problèmes, consultez [sécurité des applications multiniveau](multi-tier-application-security.md).</span><span class="sxs-lookup"><span data-stu-id="8e701-134">For a further discussion of these issues, see [Multi-Tier Application Security](multi-tier-application-security.md).</span></span>

## <a name="queued-components"></a><span data-ttu-id="8e701-135">Composants en file d’attente</span><span class="sxs-lookup"><span data-stu-id="8e701-135">Queued Components</span></span>

<span data-ttu-id="8e701-136">Les [composants en file d’attente](com--queued-components.md) ne prennent pas en charge l’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="8e701-136">[Queued components](com--queued-components.md) do not support impersonation.</span></span> <span data-ttu-id="8e701-137">Lorsqu’un client effectue un appel à un objet mis en file d’attente, l’appel est effectué à l’enregistreur, qui l’empaquette dans le cadre d’un message sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="8e701-137">When a client makes a call to a queued object, the call is actually made to the recorder, which packages it as part of a message to the server.</span></span> <span data-ttu-id="8e701-138">L’écouteur lit ensuite le message à partir de la file d’attente et le transmet au lecteur, qui appelle le composant serveur réel et effectue le même appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="8e701-138">The listener then reads the message from the queue and passes it to the player, which invokes the actual server component and makes the same method call.</span></span> <span data-ttu-id="8e701-139">Ainsi, lorsque le serveur reçoit l’appel, le jeton client d’origine n’est pas disponible via l’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="8e701-139">As such, when the server receives the call, the original client token is unavailable via impersonation.</span></span> <span data-ttu-id="8e701-140">La sécurité basée sur les rôles continue à s’appliquer, cependant, et la sécurité par programmation à l’aide de l’interface [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) fonctionnera.</span><span class="sxs-lookup"><span data-stu-id="8e701-140">Role-based security still applies, however, and programmatic security using the [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) interface will work.</span></span> <span data-ttu-id="8e701-141">Pour plus d’informations, consultez [sécurité des composants en file d’attente](queued-components-security.md).</span><span class="sxs-lookup"><span data-stu-id="8e701-141">For details, see [Queued Components Security](queued-components-security.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8e701-142">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8e701-142">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8e701-143">Authentification du client</span><span class="sxs-lookup"><span data-stu-id="8e701-143">Client Authentication</span></span>](client-authentication.md)
</dt> <dt>

[<span data-ttu-id="8e701-144">Sécurité de l’application de bibliothèque</span><span class="sxs-lookup"><span data-stu-id="8e701-144">Library Application Security</span></span>](library-application-security.md)
</dt> <dt>

[<span data-ttu-id="8e701-145">Sécurité des applications multiniveau</span><span class="sxs-lookup"><span data-stu-id="8e701-145">Multi-Tier Application Security</span></span>](multi-tier-application-security.md)
</dt> <dt>

[<span data-ttu-id="8e701-146">Sécurité des composants de programmation</span><span class="sxs-lookup"><span data-stu-id="8e701-146">Programmatic Component Security</span></span>](programmatic-component-security.md)
</dt> <dt>

[<span data-ttu-id="8e701-147">Administration de la sécurité basée sur les rôles</span><span class="sxs-lookup"><span data-stu-id="8e701-147">Role-Based Security Administration</span></span>](role-based-security-administration.md)
</dt> <dt>

[<span data-ttu-id="8e701-148">Utilisation de la stratégie de restriction logicielle dans COM+</span><span class="sxs-lookup"><span data-stu-id="8e701-148">Using the Software Restriction Policy in COM+</span></span>](using-the-software-restriction-policy-in-com-.md)
</dt> </dl>

 

 
