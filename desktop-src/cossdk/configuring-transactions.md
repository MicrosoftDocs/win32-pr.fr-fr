---
description: L’attribut de transaction est une propriété déclarative qui gère automatiquement les transactions pour le développeur de composants. En définissant cet attribut, vous éliminez le besoin d’utiliser des contrôles de transaction explicites dans votre composant.
ms.assetid: ea0e4d7e-2598-4a42-993c-58815f2fa138
title: Configuration des transactions
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b57f27d47836193dc5d23c44e3344cb2a81d5984
ms.sourcegitcommit: bf526e267d3991892733bdd229c66d5365cf244a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/05/2021
ms.locfileid: "104566356"
---
# <a name="configuring-transactions"></a><span data-ttu-id="0d6d6-104">Configuration des transactions</span><span class="sxs-lookup"><span data-stu-id="0d6d6-104">Configuring Transactions</span></span>

<span data-ttu-id="0d6d6-105">L' *attribut de transaction* est une propriété déclarative qui gère automatiquement les transactions pour le développeur de composants.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-105">The *transaction attribute* is a declarative property that automatically manages transactions for the component developer.</span></span> <span data-ttu-id="0d6d6-106">En définissant cet attribut, vous éliminez le besoin d’utiliser des contrôles de transaction explicites dans votre composant.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-106">By setting this attribute, you eliminate the need to use explicit transaction controls in your component.</span></span>

<span data-ttu-id="0d6d6-107">COM+ utilise l’attribut de transaction du composant pour déterminer le type de protection de transaction requis pour chaque objet qu’il active.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-107">COM+ uses the component's transaction attribute to determine the type of transaction protection required for each object it activates.</span></span> <span data-ttu-id="0d6d6-108">En fonction de ses besoins, un objet peut partager la transaction de son appelant, exiger une nouvelle transaction ou fonctionner sans protection des transactions.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-108">Depending on its requirement, an object can share its caller's transaction, require a new transaction, or operate without transaction protection.</span></span>

<span data-ttu-id="0d6d6-109">COM+ fournit les valeurs d’attribut de transaction suivantes :</span><span class="sxs-lookup"><span data-stu-id="0d6d6-109">COM+ provides the following transaction attribute values:</span></span>

<dl> <dt>

<span data-ttu-id="0d6d6-110"><span id="Disabled"></span><span id="disabled"></span><span id="DISABLED"></span>Activée</span><span class="sxs-lookup"><span data-stu-id="0d6d6-110"><span id="Disabled"></span><span id="disabled"></span><span id="DISABLED"></span>Disabled</span></span>
</dt> <dd>

<span data-ttu-id="0d6d6-111">En général, vous devez définir cette valeur d’attribut uniquement lorsque vous êtes sûr que le composant n’accède jamais à un gestionnaire de ressources.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-111">In general, you should set this attribute value only when you are sure that the component never accesses a resource manager.</span></span> <span data-ttu-id="0d6d6-112">Lorsque vous désactivez l’attribut de transaction, COM+ ignore les exigences transactionnelles du composant pour déterminer l’emplacement du contexte de l’objet.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-112">When you disable the transaction attribute, COM+ ignores the transactional requirements of the component in determining context placement of the object.</span></span> <span data-ttu-id="0d6d6-113">Par conséquent, l’objet peut partager le contexte de son appelant (et la transaction).</span><span class="sxs-lookup"><span data-stu-id="0d6d6-113">As a result, the object can share its caller's context (and transaction).</span></span> <span data-ttu-id="0d6d6-114">Lors de la migration d’un composant COM vers COM+, vous devez désactiver l’attribut transaction pour conserver le même comportement transactionnel que le composant COM non configuré.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-114">When migrating a COM component to COM+, you must disable the transaction attribute to maintain the same transactional behavior as the unconfigured COM component.</span></span>

> [!Note]  
> <span data-ttu-id="0d6d6-115">Un *composant non configuré* est un composant COM qui n’a pas été installé dans une application com+.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-115">An *unconfigured component* is a COM component that has not been installed in a COM+ application.</span></span>

 

</dd> <dt>

<span data-ttu-id="0d6d6-116"><span id="Not_Supported"></span><span id="not_supported"></span><span id="NOT_SUPPORTED"></span>Non pris en charge</span><span class="sxs-lookup"><span data-stu-id="0d6d6-116"><span id="Not_Supported"></span><span id="not_supported"></span><span id="NOT_SUPPORTED"></span>Not Supported</span></span>
</dt> <dd>

<span data-ttu-id="0d6d6-117">Lorsque vous définissez cette valeur d’attribut, COM+ garantit que tous les objets créés à partir du composant ne participent jamais à une transaction, quel que soit l’état transactionnel de son appelant.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-117">When you set this attribute value, COM+ ensures that any object created from the component never participates in a transaction, regardless of the transactional status of its caller.</span></span> <span data-ttu-id="0d6d6-118">En déclarant cette valeur, vous vous assurez qu’un objet ne vote pas dans la transaction de son appelant et ne peut pas commencer une transaction qui lui est propre.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-118">By declaring this value, you ensure that an object does not vote in its caller's transaction nor can it begin a transaction of its own.</span></span> <span data-ttu-id="0d6d6-119">Non pris en charge est la valeur par défaut pour tous les composants.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-119">Not Supported is the default value for all components.</span></span>

</dd> <dt>

<span data-ttu-id="0d6d6-120"><span id="Supported"></span><span id="supported"></span><span id="SUPPORTED"></span>Géré</span><span class="sxs-lookup"><span data-stu-id="0d6d6-120"><span id="Supported"></span><span id="supported"></span><span id="SUPPORTED"></span>Supported</span></span>
</dt> <dd>

<span data-ttu-id="0d6d6-121">Lorsque vous définissez cette valeur d’attribut, COM+ garantit que tous les objets créés à partir du composant participent à une transaction, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-121">When you set this attribute value, COM+ ensures that any object created from the component participates in a transaction if one exists.</span></span> <span data-ttu-id="0d6d6-122">Vous pouvez déclarer cette valeur lorsque vous souhaitez qu’un objet soit partagé dans la transaction de son appelant sans qu’il soit nécessaire de disposer d’une transaction propre.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-122">You declare this value when you want an object to share in its caller's transaction without requiring a transaction of its own.</span></span>

</dd> <dt>

<span data-ttu-id="0d6d6-123"><span id="Required"></span><span id="required"></span><span id="REQUIRED"></span>Obligatoire</span><span class="sxs-lookup"><span data-stu-id="0d6d6-123"><span id="Required"></span><span id="required"></span><span id="REQUIRED"></span>Required</span></span>
</dt> <dd>

<span data-ttu-id="0d6d6-124">Lorsque vous définissez cette valeur d’attribut, COM+ garantit que tous les objets créés à partir du composant sont transactionnels.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-124">When you set this attribute value, COM+ ensures that any object created from the component is transactional.</span></span> <span data-ttu-id="0d6d6-125">Lorsque COM+ active un objet avec le paramètre requis, il examine l’état transactionnel de son appelant.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-125">When COM+ activates an object with the Required setting, it looks at the transactional status of its caller.</span></span> <span data-ttu-id="0d6d6-126">Si l’appelant a une transaction, le nouvel objet est inclus dans la transaction en cours.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-126">If the caller has a transaction, the new object is included in the current transaction.</span></span> <span data-ttu-id="0d6d6-127">Dans le cas contraire, COM+ commence une transaction, en faisant du nouvel objet la racine de la transaction.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-127">Otherwise, COM+ begins a transaction, making the new object the root of the transaction.</span></span> <span data-ttu-id="0d6d6-128">Il s’agit du paramètre par défaut pour un composant qui exécute des activités de ressources, car il permet de fournir une protection des transactions pour ces activités.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-128">This is the preferred setting for a component that performs resource activities because it helps provide transaction protection for those activities.</span></span>

</dd> <dt>

<span data-ttu-id="0d6d6-129"><span id="Requires_New"></span><span id="requires_new"></span><span id="REQUIRES_NEW"></span>Nouvelles</span><span class="sxs-lookup"><span data-stu-id="0d6d6-129"><span id="Requires_New"></span><span id="requires_new"></span><span id="REQUIRES_NEW"></span>Requires New</span></span>
</dt> <dd>

<span data-ttu-id="0d6d6-130">Lorsque vous définissez cette valeur d’attribut, COM+ garantit que tous les objets créés à partir du composant doivent participer à une nouvelle transaction comme racine de la transaction, quel que soit l’état transactionnel de l’appelant.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-130">When you set this attribute value, COM+ ensures that any objects created from the component must participate in a new transaction as the root of the transaction, regardless of the transactional status of the caller.</span></span> <span data-ttu-id="0d6d6-131">COM+ lance automatiquement une nouvelle transaction qui est distincte de la transaction de l’appelant.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-131">COM+ automatically initiates a new transaction that is distinct from the caller's transaction.</span></span>

> [!Note]  
> <span data-ttu-id="0d6d6-132">COM+ ne prend pas en charge les transactions imbriquées.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-132">COM+ does not support nested transactions.</span></span> <span data-ttu-id="0d6d6-133">Lorsqu’un objet transactionnel appelle un autre composant marqué comme nécessite New, COM+ crée une limite transactionnelle indépendante pour l’objet qui vient d’être activé.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-133">When one transactional object calls another component marked as Requires New, COM+ creates an independent transactional boundary for the newly activated object.</span></span> <span data-ttu-id="0d6d6-134">La deuxième transaction ne peut pas affecter la première transaction, sauf si la première transaction note explicitement les résultats de la deuxième transaction et modifie son vote en fonction de ces résultats.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-134">The second transaction cannot affect the first transaction unless the first transaction explicitly notes the results of the second transaction and modifies its vote based on those results.</span></span>

 

</dd> </dl>

## <a name="transaction-attribute-dependencies"></a><span data-ttu-id="0d6d6-135">Dépendances d’attribut de transaction</span><span class="sxs-lookup"><span data-stu-id="0d6d6-135">Transaction Attribute Dependencies</span></span>

<span data-ttu-id="0d6d6-136">Le tableau suivant présente les caractéristiques de chaque valeur d’attribut de transaction COM+, y compris l’effet de la valeur sur les caractéristiques de transaction.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-136">The following table shows the characteristics of each COM+ transaction attribute value, including the value's effect on transaction characteristics.</span></span> <span data-ttu-id="0d6d6-137">COM+ applique [l’activation](com--just-in-time-activation.md) et la [synchronisation](com--synchronization.md) JIT pour tous les composants de transaction.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-137">COM+ enforces [JIT activation](com--just-in-time-activation.md) and [Synchronization](com--synchronization.md) for all transaction components.</span></span>



| <span data-ttu-id="0d6d6-138">Valeur d'attribut</span><span class="sxs-lookup"><span data-stu-id="0d6d6-138">Attribute Value</span></span>          | <span data-ttu-id="0d6d6-139">Nouvelle transaction</span><span class="sxs-lookup"><span data-stu-id="0d6d6-139">New Transaction</span></span>   | <span data-ttu-id="0d6d6-140">Transaction du client</span><span class="sxs-lookup"><span data-stu-id="0d6d6-140">Client's Transaction</span></span>                 | <span data-ttu-id="0d6d6-141">Racine de la transaction</span><span class="sxs-lookup"><span data-stu-id="0d6d6-141">Transaction Root</span></span>                        | <span data-ttu-id="0d6d6-142">Activation juste-à-temps</span><span class="sxs-lookup"><span data-stu-id="0d6d6-142">JIT Activation</span></span>      | <span data-ttu-id="0d6d6-143">Synchronization</span><span class="sxs-lookup"><span data-stu-id="0d6d6-143">Synchronization</span></span>     |
|--------------------------|-------------------|--------------------------------------|-----------------------------------------|---------------------|---------------------|
| <span data-ttu-id="0d6d6-144">Désactivé</span><span class="sxs-lookup"><span data-stu-id="0d6d6-144">Disabled</span></span><br/>      | <span data-ttu-id="0d6d6-145">Jamais</span><span class="sxs-lookup"><span data-stu-id="0d6d6-145">Never</span></span><br/>  | <span data-ttu-id="0d6d6-146">Peut-être</span><span class="sxs-lookup"><span data-stu-id="0d6d6-146">Maybe</span></span><br/>                     | <span data-ttu-id="0d6d6-147">Jamais</span><span class="sxs-lookup"><span data-stu-id="0d6d6-147">Never</span></span><br/>                        | <span data-ttu-id="0d6d6-148">Facultatif</span><span class="sxs-lookup"><span data-stu-id="0d6d6-148">Optional</span></span><br/> | <span data-ttu-id="0d6d6-149">Facultatif</span><span class="sxs-lookup"><span data-stu-id="0d6d6-149">Optional</span></span><br/> |
| <span data-ttu-id="0d6d6-150">Non pris en charge</span><span class="sxs-lookup"><span data-stu-id="0d6d6-150">Not Supported</span></span><br/> | <span data-ttu-id="0d6d6-151">Jamais</span><span class="sxs-lookup"><span data-stu-id="0d6d6-151">Never</span></span><br/>  | <span data-ttu-id="0d6d6-152">Jamais</span><span class="sxs-lookup"><span data-stu-id="0d6d6-152">Never</span></span><br/>                     | <span data-ttu-id="0d6d6-153">Jamais</span><span class="sxs-lookup"><span data-stu-id="0d6d6-153">Never</span></span><br/>                        | <span data-ttu-id="0d6d6-154">Facultatif</span><span class="sxs-lookup"><span data-stu-id="0d6d6-154">Optional</span></span><br/> | <span data-ttu-id="0d6d6-155">Facultatif</span><span class="sxs-lookup"><span data-stu-id="0d6d6-155">Optional</span></span><br/> |
| <span data-ttu-id="0d6d6-156">Pris en charge</span><span class="sxs-lookup"><span data-stu-id="0d6d6-156">Supported</span></span><br/>     | <span data-ttu-id="0d6d6-157">Jamais</span><span class="sxs-lookup"><span data-stu-id="0d6d6-157">Never</span></span><br/>  | <span data-ttu-id="0d6d6-158">Si le client a une transaction</span><span class="sxs-lookup"><span data-stu-id="0d6d6-158">If client has transaction</span></span><br/> | <span data-ttu-id="0d6d6-159">Jamais</span><span class="sxs-lookup"><span data-stu-id="0d6d6-159">Never</span></span><br/>                        | <span data-ttu-id="0d6d6-160">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="0d6d6-160">Required</span></span><br/> | <span data-ttu-id="0d6d6-161">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="0d6d6-161">Required</span></span><br/> |
| <span data-ttu-id="0d6d6-162">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="0d6d6-162">Required</span></span><br/>      | <span data-ttu-id="0d6d6-163">Peut-être</span><span class="sxs-lookup"><span data-stu-id="0d6d6-163">Maybe</span></span><br/>  | <span data-ttu-id="0d6d6-164">Si le client a une transaction</span><span class="sxs-lookup"><span data-stu-id="0d6d6-164">If client has transaction</span></span><br/> | <span data-ttu-id="0d6d6-165">Si le client n’a pas de transaction</span><span class="sxs-lookup"><span data-stu-id="0d6d6-165">If client has no transaction</span></span><br/> | <span data-ttu-id="0d6d6-166">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="0d6d6-166">Required</span></span><br/> | <span data-ttu-id="0d6d6-167">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="0d6d6-167">Required</span></span><br/> |
| <span data-ttu-id="0d6d6-168">Nouveau requis</span><span class="sxs-lookup"><span data-stu-id="0d6d6-168">Requires New</span></span><br/>  | <span data-ttu-id="0d6d6-169">Toujours</span><span class="sxs-lookup"><span data-stu-id="0d6d6-169">Always</span></span><br/> | <span data-ttu-id="0d6d6-170">Jamais</span><span class="sxs-lookup"><span data-stu-id="0d6d6-170">Never</span></span><br/>                     | <span data-ttu-id="0d6d6-171">Toujours</span><span class="sxs-lookup"><span data-stu-id="0d6d6-171">Always</span></span><br/>                       | <span data-ttu-id="0d6d6-172">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="0d6d6-172">Required</span></span><br/> | <span data-ttu-id="0d6d6-173">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="0d6d6-173">Required</span></span><br/> |



 

## <a name="transaction-boundaries"></a><span data-ttu-id="0d6d6-174">Limites de transaction</span><span class="sxs-lookup"><span data-stu-id="0d6d6-174">Transaction Boundaries</span></span>

<span data-ttu-id="0d6d6-175">Une transaction a un début, une fin et se produit exactement une fois.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-175">A transaction has a beginning, an end, and occurs exactly once.</span></span> <span data-ttu-id="0d6d6-176">Pendant son exécution, une transaction peut appeler sur une ressource, telle qu’une base de données ou une file d’attente, pour accomplir une ou plusieurs tâches.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-176">During its execution, a transaction may call on a resource, such as a database or queue, to accomplish one or more tasks.</span></span> <span data-ttu-id="0d6d6-177">Chaque ressource est comprise dans la limite de la *transaction*.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-177">Each resource falls within the *transaction boundary*.</span></span> <span data-ttu-id="0d6d6-178">Toutes les ressources au sein d’une limite de transaction, qui peuvent s’étendre sur plusieurs limites de processus et d’ordinateur, partagent une seule transaction.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-178">All resources within a transaction boundary, which can span multiple process and computer boundaries, share a single transaction.</span></span> <span data-ttu-id="0d6d6-179">La gestion de la cohérence entre ces processus et les limites de l’ordinateur est importante.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-179">Managing consistency across these process and computer boundaries is important.</span></span>

<span data-ttu-id="0d6d6-180">COM+ garantit la cohérence en gérant automatiquement les limites de transaction, en fonction de la valeur de l’attribut de transaction que vous avez défini pour chaque composant.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-180">COM+ ensures consistency by managing transaction boundaries automatically, based on the value of the transaction attribute that you set for each component.</span></span> <span data-ttu-id="0d6d6-181">Une transaction COM+ est automatiquement transférée aux objets qui doivent participer à une transaction et ignore les objets qui doivent être exécutés en dehors d’une transaction.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-181">A COM+ transaction automatically flows to objects instructed to participate in a transaction and bypasses objects instructed to execute outside a transaction.</span></span> <span data-ttu-id="0d6d6-182">COM+ ne prend pas en charge les transactions imbriquées.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-182">COM+ does not support nested transactions.</span></span> <span data-ttu-id="0d6d6-183">Au lieu de cela, les transactions COM+ sont distinctes et éphémères.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-183">Instead, COM+ transactions are distinct and short-lived.</span></span>

<span data-ttu-id="0d6d6-184">Le premier objet dans une limite de transaction est spécial pour la transaction et est appelé l' *objet racine* de la transaction.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-184">The first object in a transaction boundary is special to the transaction and is called the *root object* of the transaction.</span></span> <span data-ttu-id="0d6d6-185">Il ne peut y avoir qu’un seul objet racine dans une transaction.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-185">There can be only one root object in a transaction.</span></span> <span data-ttu-id="0d6d6-186">Tous les autres objets de la hiérarchie transactionnelle sous l’objet racine sont appelés *objets intérieurs*.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-186">All other objects in the transactional hierarchy under the root object are called *interior objects*.</span></span>

## <a name="mapping-transactions"></a><span data-ttu-id="0d6d6-187">Mappage de transactions</span><span class="sxs-lookup"><span data-stu-id="0d6d6-187">Mapping Transactions</span></span>

<span data-ttu-id="0d6d6-188">Une façon de s’assurer qu’un objet est inclus dans la limite de transaction correcte consiste à mapper vos transactions avant de commencer à écrire vos composants.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-188">One way to ensure that an object is included in the correct transaction boundary is to map your transactions before you start writing your components.</span></span> <span data-ttu-id="0d6d6-189">En mappant les transactions, vous pouvez déterminer le meilleur paramètre pour chaque composant que vous écrivez.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-189">By mapping transactions, you can determine the best setting for each component you write.</span></span> <span data-ttu-id="0d6d6-190">Plus vous êtes certain de l’utilisation de vos composants, plus il est facile de sélectionner la valeur d’attribut de transaction correcte.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-190">The more certain you are about how your components are to be used, the easier it is to select the correct transaction attribute value.</span></span>

<span data-ttu-id="0d6d6-191">Au moment de l’exécution, COM+ examine l’attribut de transaction pour déterminer si un objet doit être la racine d’une nouvelle transaction, être créé dans une transaction existante ou être créé en tant qu’objet non transactionnel.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-191">At run time, COM+ looks at the transaction attribute to determine whether an object should be the root of a new transaction, be created in an existing transaction, or be created as a non-transactional object.</span></span>

<span data-ttu-id="0d6d6-192">L’illustration suivante montre un mappage de transaction possible.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-192">The following illustration shows a possible transaction mapping.</span></span> <span data-ttu-id="0d6d6-193">Dans l’illustration, le client crée l’objet 1, qui requiert une transaction.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-193">In the illustration, the client creates Object  1, which requires a transaction.</span></span> <span data-ttu-id="0d6d6-194">Étant donné qu’il n’existe aucune transaction, COM+ crée la transaction 1 et place l’objet 1 dans celui-ci en tant qu’objet racine.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-194">Because no transaction exists, COM+ creates Transaction 1 and places Object 1 in it as the root object.</span></span> <span data-ttu-id="0d6d6-195">Object 1 crée l’objet 2, qui prend en charge les transactions et est donc placé dans la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-195">Object 1 creates Object 2, which supports transactions and is therefore placed in Transaction 1.</span></span> <span data-ttu-id="0d6d6-196">L’objet 2 crée l’objet 3, qui ne prend pas en charge les transactions et est donc placé en dehors de toutes les transactions.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-196">Object 2 creates Object 3, which does not support transactions and therefore is placed outside all transactions.</span></span> <span data-ttu-id="0d6d6-197">L’objet 2 crée également l’objet 4, qui requiert une transaction et est donc placé dans la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-197">Object 2 also creates Object 4, which requires a transaction and is therefore placed in Transaction  1.</span></span> <span data-ttu-id="0d6d6-198">L’objet 3 crée l’objet 5, qui prend en charge les transactions.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-198">Object 3 creates Object 5, which supports transactions.</span></span> <span data-ttu-id="0d6d6-199">Toutefois, étant donné que l’objet 5 est créé par un objet qui n’existe pas dans une transaction, il est également placé en dehors de toutes les transactions.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-199">However, because Object 5 is created by an object that does not exist within a transaction, it also is placed outside all transactions.</span></span> <span data-ttu-id="0d6d6-200">L’objet 4 crée l’objet 6, qui nécessite une nouvelle transaction, de sorte que COM+ crée la transaction 2 et place l’objet 6 en tant qu’objet racine.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-200">Object 4 creates Object 6, which requires a new transaction, so COM+ creates Transaction 2 and places Object 6 in it as the root object.</span></span> <span data-ttu-id="0d6d6-201">L’objet 6 crée l’objet 7, qui prend en charge les transactions et est donc placé dans la transaction 2.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-201">Object 6 creates Object 7, which supports transactions and is therefore placed in Transaction 2.</span></span>

![Diagramme illustrant une interaction client avec la transaction 1 et la transaction 2.](images/fc7e2d03-94c2-40d9-a79b-1e05ca31dd80.png)

<span data-ttu-id="0d6d6-203">L’illustration précédente montre deux problèmes potentiels.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-203">The preceding illustration shows two potential problem areas.</span></span> <span data-ttu-id="0d6d6-204">Tout d’abord, la majorité du travail est divisée entre deux transactions distinctes.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-204">First, the majority of work is split between two distinct transactions.</span></span> <span data-ttu-id="0d6d6-205">Si la transaction 1 échoue après que l’objet 4 a créé l’objet 6, la transaction 2 n’est pas affectée par le résultat de la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-205">If Transaction 1 fails after Object 4 creates Object 6, Transaction 2 runs unaffected by the outcome of Transaction 1.</span></span> <span data-ttu-id="0d6d6-206">Si ce résultat n’est pas intentionnel, vous préférerez peut-être plier les opérations des deux transactions en une seule transaction, ce que vous pouvez effectuer en remplaçant l’attribut de transaction de l’objet 6 par requis.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-206">If this outcome is unintended, you might prefer to fold the operations of both transactions into a single transaction, which you can accomplish by changing the transaction attribute of Object  6 to Required.</span></span>

<span data-ttu-id="0d6d6-207">L’illustration de mappage indique également que les objets 3 et 5 sont non transactionnels, qui s’exécutent complètement en dehors de l’étendue des transactions 1 et 2.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-207">The mapping illustration also shows that Object 3 and Object 5 are non-transactional, running completely outside the scope of Transactions 1 and 2.</span></span> <span data-ttu-id="0d6d6-208">Si l’objet 5 met à jour les données persistantes, vous souhaiterez peut-être reconsidérer son état non transactionnel.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-208">If Object 5 updates persistent data, you might want to reconsider its non-transactional status.</span></span> <span data-ttu-id="0d6d6-209">L’objet 5 peut être placé dans une transaction en remplaçant son attribut de transaction par required.</span><span class="sxs-lookup"><span data-stu-id="0d6d6-209">Object 5 can be placed within a transaction by changing its transaction attribute to Required.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0d6d6-210">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="0d6d6-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0d6d6-211">Définition de l’attribut de transaction</span><span class="sxs-lookup"><span data-stu-id="0d6d6-211">Setting the Transaction Attribute</span></span>](setting-the-transaction-attribute.md)
</dt> </dl>

 

 




