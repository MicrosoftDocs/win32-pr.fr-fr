---
description: Prise en charge du débogage des Visual Basic COM+ avec MTS
ms.assetid: aa012f88-1f88-4c7f-b774-82b9e29da5e9
title: Prise en charge du débogage des Visual Basic COM+ avec MTS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 038b29bbc6fbe5c8375f91f0006b85940f00b944
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106513942"
---
# <a name="com-visual-basic-debugging-support-contrasted-with-mts"></a><span data-ttu-id="9d584-103">Prise en charge du débogage des Visual Basic COM+ avec MTS</span><span class="sxs-lookup"><span data-stu-id="9d584-103">COM+ Visual Basic Debugging Support Contrasted with MTS</span></span>

<span data-ttu-id="9d584-104">COM+ supprime ou réduit plusieurs limites du débogage avec Microsoft Visual Basic 6,0 et MTS.</span><span class="sxs-lookup"><span data-stu-id="9d584-104">COM+ removes or reduces several limitations of debugging with Microsoft Visual Basic 6.0 and MTS.</span></span> <span data-ttu-id="9d584-105">La liste suivante récapitule les modifications que vous pouvez attendre avec COM+ :</span><span class="sxs-lookup"><span data-stu-id="9d584-105">The following list summarizes changes you can expect with COM+:</span></span>

-   <span data-ttu-id="9d584-106">Débogage de plusieurs composants : dans COM+, vous pouvez déboguer des scénarios dans lesquels un client s’exécutant dans une instance de l’IDE effectue des appels à n’importe quel nombre de dll s’exécutant dans un autre en tant que groupe de projets.</span><span class="sxs-lookup"><span data-stu-id="9d584-106">Debugging multiple components—In COM+, you can debug scenarios in which a client running in one instance of the IDE makes calls to any number of DLLs running in another as a project group.</span></span> <span data-ttu-id="9d584-107">Les objets dans les projets de DLL groupés peuvent se composer les uns les autres arbitrairement, en passant le contexte en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="9d584-107">The objects in the grouped DLL projects can call each other arbitrarily, flowing context as needed.</span></span> <span data-ttu-id="9d584-108">Bien entendu, cela fonctionne également lorsque les dll et le client se trouvent dans le même groupe de projets dans la même instance de l’IDE.</span><span class="sxs-lookup"><span data-stu-id="9d584-108">Of course, this also works when the DLLs and the client are in the same project group in the same instance of the IDE.</span></span>

-   <span data-ttu-id="9d584-109">Limitations du débogage pour \_ les événements Class Initialize et Class \_ Terminate : avec com+, vous pouvez placer du code dans les \_ événements Class Initialize et Class \_ Terminate d’un composant d’application com+ même si ce code tente d’accéder à l’objet ou à son objet de contexte correspondant.</span><span class="sxs-lookup"><span data-stu-id="9d584-109">Debugging Limitations on Class\_Initialize and Class\_Terminate Events—With COM+, you can put code in the Class\_Initialize and Class\_Terminate events of a COM+ application component even if that code attempts to access the object or its corresponding context object.</span></span> <span data-ttu-id="9d584-110">Vous pouvez définir des points d’arrêt à cet emplacement et utiliser des montres.</span><span class="sxs-lookup"><span data-stu-id="9d584-110">You can set breakpoints there and use watches.</span></span> <span data-ttu-id="9d584-111">Vous pouvez également définir des points d’arrêt dans l’événement de fin de classe \_ .</span><span class="sxs-lookup"><span data-stu-id="9d584-111">You can also set breakpoints in the Class\_Terminate event.</span></span>

    <span data-ttu-id="9d584-112">Bien qu’il ne soit plus nécessaire comme solution de contournement, vous pouvez toujours implémenter l’interface [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) et utiliser ses méthodes [**Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) et [**Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) si vous devez exécuter du code au démarrage et à l’arrêt de votre composant.</span><span class="sxs-lookup"><span data-stu-id="9d584-112">Although it is no longer needed as a workaround, you can still implement the [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) interface and use its [**Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) and [**Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) methods if you need to execute code during startup and shutdown of your component.</span></span> <span data-ttu-id="9d584-113">Vous pouvez également placer des points d’arrêt dans le code pour les méthodes **Deactivate** ou [**CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) .</span><span class="sxs-lookup"><span data-stu-id="9d584-113">You can also now put breakpoints in code for the **Deactivate** or [**CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) methods.</span></span>

-   <span data-ttu-id="9d584-114">La surveillance des objets MTS : avec COM+, vous pouvez ajouter des espions pour les variables d’objet retournées par COM+, y compris les valeurs de retour des méthodes [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef), [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext)et [**IObjectContext :: CreateInstance**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-createinstance) .</span><span class="sxs-lookup"><span data-stu-id="9d584-114">Watching MTS Objects—With COM+, you can add watches for object variables returned by COM+, including return values from the [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef), [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext), and [**IObjectContext::CreateInstance**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-createinstance) methods.</span></span>

-   <span data-ttu-id="9d584-115">Stabilité accrue lorsque les composants échouent : dans COM+, l’échec d’un composant ne s’arrête toujours pas Visual Basic (qui s’exécute dans le même processus que le composant débogué).</span><span class="sxs-lookup"><span data-stu-id="9d584-115">Increased stability when components fail—In COM+, a component failure will no longer always stop Visual Basic (which runs in the same process as the debugged component).</span></span> <span data-ttu-id="9d584-116">Par exemple, la prise en charge des échecs de réactivation juste-à-temps (JIT) vous permet désormais d’examiner le contexte de l’objet pendant le débogage.</span><span class="sxs-lookup"><span data-stu-id="9d584-116">For example, support for just-in-time (JIT) reactivation failures now allows you to look at the object context while debugging.</span></span>

-   <span data-ttu-id="9d584-117">Le débogueur peut réactiver les objets publiés par COM+ : comme avec MTS, Visual Basic 6,0 peut réactiver les objets COM+ pendant que vous déboguez une seule étape via un client.</span><span class="sxs-lookup"><span data-stu-id="9d584-117">Debugger may reactivate objects released by COM+—As with MTS, Visual Basic 6.0 may reactivate COM+ objects while you are debugging single-step through a client.</span></span> <span data-ttu-id="9d584-118">En raison de la façon dont Visual Basic 6,0 Découvre des informations sur les objets, il s’agit d’un comportement attendu.</span><span class="sxs-lookup"><span data-stu-id="9d584-118">Because of the way that Visual Basic 6.0 discovers information about objects, this is expected behavior.</span></span> <span data-ttu-id="9d584-119">Considérons par exemple le code suivant :</span><span class="sxs-lookup"><span data-stu-id="9d584-119">For example, consider the following code:</span></span>

    ``` syntax
    Dim obj As Object
    Set obj = CreateObject("MyApp.MyClass")
    obj.Test  'Call the user-defined subroutine named Test.
    Set obj = Nothing
    ```

    <span data-ttu-id="9d584-120">Si le obj. La méthode de test appelle [**IObjectContext :: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete), com+ libère immédiatement obj de la mémoire, mais obj n’a pas encore été défini sur Nothing.</span><span class="sxs-lookup"><span data-stu-id="9d584-120">If the obj.Test method calls [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete), COM+ immediately frees obj from memory, but obj has not yet been set to Nothing.</span></span> <span data-ttu-id="9d584-121">Quand obj. Le test retourne, le débogueur Visual Basic appelle [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) sur obj pour l’interface [**IProvideClassInfo**](/windows/desktop/api/ocidl/nn-ocidl-iprovideclassinfo) .</span><span class="sxs-lookup"><span data-stu-id="9d584-121">When obj.Test returns, the Visual Basic debugger calls [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on obj for the [**IProvideClassInfo**](/windows/desktop/api/ocidl/nn-ocidl-iprovideclassinfo) interface.</span></span> <span data-ttu-id="9d584-122">Le wrapper de contexte associé à obj crée une nouvelle instance de MyApp. MyClass pour traiter l’appel **QueryInterface** .</span><span class="sxs-lookup"><span data-stu-id="9d584-122">The context wrapper associated with obj creates a new instance of MyApp.MyClass to service the **QueryInterface** call.</span></span> <span data-ttu-id="9d584-123">En conséquence, vous verrez cet objet non initialisé dans le débogueur après obj. Le test a été retourné.</span><span class="sxs-lookup"><span data-stu-id="9d584-123">As a result, you will see this uninitialized object in the debugger after obj.Test has returned.</span></span> <span data-ttu-id="9d584-124">Cet objet apparaît uniquement dans le débogueur et est supprimé par l’instruction suivante pour affecter à obj la valeur Nothing.</span><span class="sxs-lookup"><span data-stu-id="9d584-124">This object appears only in the debugger and is removed by the subsequent instruction to set obj to Nothing.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9d584-125">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="9d584-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9d584-126">Débogage de composants Visual Basic compilés</span><span class="sxs-lookup"><span data-stu-id="9d584-126">Debugging Compiled Visual Basic Components</span></span>](debugging-compiled-visual-basic-components.md)
</dt> <dt>

[<span data-ttu-id="9d584-127">Débogage dans l’IDE Visual Basic</span><span class="sxs-lookup"><span data-stu-id="9d584-127">Debugging in the Visual Basic IDE</span></span>](debugging-in-the-visual-basic-ide.md)
</dt> </dl>

 

 
