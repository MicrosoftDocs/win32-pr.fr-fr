---
description: 'Les données d’abonnement résident dans le catalogue COM+ de l’abonnement. Vous pouvez créer un abonnement à l’aide de l’outil d’administration Services de composants ou par programme à l’aide de l’interface ICOMAdminCatalog :: InstallComponent.'
ms.assetid: 190e88f3-1d87-4c27-9451-0a633cbae829
title: Abonnements
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9973eb76fc22354f1a2fc8e381c90cf5be1efee3
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104200976"
---
# <a name="subscriptions"></a><span data-ttu-id="c6291-104">Abonnements</span><span class="sxs-lookup"><span data-stu-id="c6291-104">Subscriptions</span></span>

<span data-ttu-id="c6291-105">Les données d’abonnement résident dans le catalogue COM+ de l’abonnement.</span><span class="sxs-lookup"><span data-stu-id="c6291-105">Subscription data resides in the subscription COM+ catalog.</span></span> <span data-ttu-id="c6291-106">Vous pouvez créer un abonnement à l’aide de l’outil d’administration Services de composants ou par programme à l’aide de l’interface [**ICOMAdminCatalog :: InstallComponent**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installcomponent) .</span><span class="sxs-lookup"><span data-stu-id="c6291-106">A subscription can be created either by using the Component Services administrative tool or programmatically by using the [**ICOMAdminCatalog::InstallComponent**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installcomponent) interface.</span></span>

<span data-ttu-id="c6291-107">La collection [**SubscriptionsForComponent**](subscriptionsforcomponent.md) permet d’ajouter, de supprimer ou de modifier des informations relatives aux abonnements.</span><span class="sxs-lookup"><span data-stu-id="c6291-107">The [**SubscriptionsForComponent**](subscriptionsforcomponent.md) collection is used to add, delete, or change information pertaining to subscriptions.</span></span> <span data-ttu-id="c6291-108">La collection **SubscriptionsForComponent** est une collection enfant d’un composant.</span><span class="sxs-lookup"><span data-stu-id="c6291-108">The **SubscriptionsForComponent** collection is a child collection to a component.</span></span> <span data-ttu-id="c6291-109">Pour ajouter un abonnement, récupérez la collection **SubscriptionsForComponent** du composant et utilisez la méthode [**Add**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-add) pour ajouter une entrée à la collection.</span><span class="sxs-lookup"><span data-stu-id="c6291-109">To add a subscription, get the component's **SubscriptionsForComponent** collection and use the [**Add**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-add) method to add an entry to the collection.</span></span> <span data-ttu-id="c6291-110">Pour définir les différentes propriétés de l’objet d’abonnement, utilisez la propriété [**value**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogobject-get_value) .</span><span class="sxs-lookup"><span data-stu-id="c6291-110">To set up the various properties of the subscription object, use the [**Value**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogobject-get_value) property.</span></span> <span data-ttu-id="c6291-111">Pour enregistrer les modifications, utilisez [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges) sur l’objet de collection **SubscriptionsForComponent** .</span><span class="sxs-lookup"><span data-stu-id="c6291-111">To save the changes, use [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges) on the **SubscriptionsForComponent** collection object.</span></span>

<span data-ttu-id="c6291-112">Vous pouvez également utiliser l’outil d’administration Services de composants pour modifier certaines des propriétés de l’abonnement, mais pas toutes.</span><span class="sxs-lookup"><span data-stu-id="c6291-112">You can also use the Component Services administration tool to modify some, but not all, of the subscription properties.</span></span> <span data-ttu-id="c6291-113">Les abonnements spécifient les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="c6291-113">Subscriptions specify the following information:</span></span>

-   <span data-ttu-id="c6291-114">Identité et emplacement de l’abonné</span><span class="sxs-lookup"><span data-stu-id="c6291-114">Identity and location of the subscriber</span></span>
-   <span data-ttu-id="c6291-115">Méthode de remise</span><span class="sxs-lookup"><span data-stu-id="c6291-115">Delivery method</span></span>
-   <span data-ttu-id="c6291-116">Méthodes d’événements à remettre</span><span class="sxs-lookup"><span data-stu-id="c6291-116">Event methods to deliver</span></span>
-   <span data-ttu-id="c6291-117">Objet de classe d’événements et propriété PublisherID d’un composant de classe d’événements à partir duquel l’abonné souhaite recevoir des événements</span><span class="sxs-lookup"><span data-stu-id="c6291-117">Event class object and PublisherID property of an event class component from which the subscriber wants to receive events</span></span>

<span data-ttu-id="c6291-118">Les abonnements existent indépendamment des objets de la classe d’événements.</span><span class="sxs-lookup"><span data-stu-id="c6291-118">Subscriptions exist independently from event class objects.</span></span> <span data-ttu-id="c6291-119">Vous pouvez désactiver un abonnement en affectant la valeur false à la propriété Enabled.</span><span class="sxs-lookup"><span data-stu-id="c6291-119">You can disable a subscription by setting the Enabled property to False.</span></span> <span data-ttu-id="c6291-120">Un abonnement désactivé n’est pas appelé par les événements COM+.</span><span class="sxs-lookup"><span data-stu-id="c6291-120">A disabled subscription is not called by COM+ Events.</span></span>

<span data-ttu-id="c6291-121">Les trois types d’abonnements sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="c6291-121">The three types of subscriptions are as follows:</span></span>

<dl> <dt>

<span data-ttu-id="c6291-122"><span id="Persistent"></span><span id="persistent"></span><span id="PERSISTENT"></span>Manière</span><span class="sxs-lookup"><span data-stu-id="c6291-122"><span id="Persistent"></span><span id="persistent"></span><span id="PERSISTENT"></span>Persistent</span></span>
</dt> <dd>

<span data-ttu-id="c6291-123">Les abonnements persistants résident dans le catalogue COM+ et sont indépendants de la durée de vie de l’abonné.</span><span class="sxs-lookup"><span data-stu-id="c6291-123">Persistent subscriptions reside in the COM+ catalog and are independent from the subscriber's lifetime.</span></span> <span data-ttu-id="c6291-124">Les abonnements persistants survivent au redémarrage du système.</span><span class="sxs-lookup"><span data-stu-id="c6291-124">Persistent subscriptions survive a system restart.</span></span> <span data-ttu-id="c6291-125">En règle générale, un abonnement persistant est créé lorsqu’une application est installée sur l’ordinateur d’un abonné et supprimée lorsque l’application est supprimée.</span><span class="sxs-lookup"><span data-stu-id="c6291-125">Generally, a persistent subscription is created when an application is installed on a subscriber's computer and removed when the application is removed.</span></span> <span data-ttu-id="c6291-126">Après la création d’un abonnement persistant, les événements COM+ activent l’abonné chaque fois qu’un événement lui est fourni.</span><span class="sxs-lookup"><span data-stu-id="c6291-126">After a persistent subscription is created, COM+ Events activates the subscriber each time an event should be delivered to it.</span></span>

<span data-ttu-id="c6291-127">Lorsqu’un serveur de publication instancie et effectue un appel sur un objet de [classe d’événements](the-com--event-class-object.md) , l’objet recherche tous les abonnements persistants dans le catalogue com+ et crée une nouvelle instance de chaque objet.</span><span class="sxs-lookup"><span data-stu-id="c6291-127">When a publisher instantiates and makes a call on an [event class](the-com--event-class-object.md) object, the object looks for all the persistent subscriptions in the COM+ catalog and creates a new instance of each object.</span></span> <span data-ttu-id="c6291-128">Le processus de création peut être direct ou par le biais d’un moniker pour les composants en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="c6291-128">The creation process can be either direct or through a moniker for queued components.</span></span> <span data-ttu-id="c6291-129">Spécifiez l’objet d’abonné par la propriété [**SubscriberMoniker**](subscriptionsforcomponent.md) de l’abonnement.</span><span class="sxs-lookup"><span data-stu-id="c6291-129">Specify the subscriber object by the [**SubscriberMoniker**](subscriptionsforcomponent.md) property of the subscription.</span></span> <span data-ttu-id="c6291-130">Les objets abonnés créés par un abonnement persistant sont toujours libérés après chaque appel d’événement.</span><span class="sxs-lookup"><span data-stu-id="c6291-130">Subscriber objects created by a persistent subscription are always released after each event call.</span></span>

</dd> <dt>

<span data-ttu-id="c6291-131"><span id="Transient"></span><span id="transient"></span><span id="TRANSIENT"></span>Provisoire</span><span class="sxs-lookup"><span data-stu-id="c6291-131"><span id="Transient"></span><span id="transient"></span><span id="TRANSIENT"></span>Transient</span></span>
</dt> <dd>

<span data-ttu-id="c6291-132">Pour les abonnements temporaires, vous pouvez utiliser la collection [**TransientSubscriptions**](transientsubscriptions.md) , dont l’objet parent est l’objet catalogue racine.</span><span class="sxs-lookup"><span data-stu-id="c6291-132">For transient subscriptions, you can use the [**TransientSubscriptions**](transientsubscriptions.md) collection, whose parent object is the root catalog object.</span></span> <span data-ttu-id="c6291-133">Les abonnements temporaires demandent un événement pour un objet d’abonné spécifique qui existe déjà.</span><span class="sxs-lookup"><span data-stu-id="c6291-133">Transient subscriptions request an event for a specific subscriber object that already exists.</span></span> <span data-ttu-id="c6291-134">Les abonnements temporaires sont stockés dans le catalogue COM+, mais l’abonnement est supprimé si le système d’événements ou le système d’exploitation est arrêté.</span><span class="sxs-lookup"><span data-stu-id="c6291-134">Transient subscriptions are stored in the COM+ catalog, but the subscription is deleted if the event system or operating system is stopped.</span></span> <span data-ttu-id="c6291-135">Contrairement aux abonnements persistants, les abonnements temporaires sont liés à un objet particulier et sont stockés uniquement dans le système d’événements.</span><span class="sxs-lookup"><span data-stu-id="c6291-135">Unlike persistent subscriptions, transient subscriptions are tied to a particular object and are stored only in the event system.</span></span> <span data-ttu-id="c6291-136">Les abonnements temporaires peuvent être plus efficaces que les abonnements persistants, mais vous devez gérer leurs cycles de vie d’objet.</span><span class="sxs-lookup"><span data-stu-id="c6291-136">Transient subscriptions can be more efficient than persistent subscriptions, but you must manage their object life cycles.</span></span> <span data-ttu-id="c6291-137">Pour plus d’informations sur l’inscription d’un abonnement temporaire, consultez [inscription d’un abonnement temporaire](registering-a-transient-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6291-137">For information about registering a transient subscription, see [Registering a Transient Subscription](registering-a-transient-subscription.md).</span></span>

</dd> <dt>

<span data-ttu-id="c6291-138"><span id="Per_user"></span><span id="per_user"></span><span id="PER_USER"></span>Par utilisateur</span><span class="sxs-lookup"><span data-stu-id="c6291-138"><span id="Per_user"></span><span id="per_user"></span><span id="PER_USER"></span>Per user</span></span>
</dt> <dd>

<span data-ttu-id="c6291-139">Les abonnements par utilisateur peuvent remettre des événements uniquement lorsque l’abonné est connecté à l’ordinateur du système d’événement.</span><span class="sxs-lookup"><span data-stu-id="c6291-139">Per User subscriptions can deliver events only when the subscriber is logged on to the event system's computer.</span></span> <span data-ttu-id="c6291-140">Lorsque l’abonné ouvre une session, le système d’événements active tous les abonnements pour lesquels l’indicateur de *PerUser* est défini sur **true** *et le nom d’utilisateur* est défini sur le nom de l’utilisateur qui a ouvert une session.</span><span class="sxs-lookup"><span data-stu-id="c6291-140">When the subscriber logs on, the event system enables all subscriptions on which the *PerUser* flag is set to **TRUE** and *UserName* is set to the name of the user who is logged on.</span></span> <span data-ttu-id="c6291-141">Lorsque l’abonné ferme une session, les abonnements sont désactivés.</span><span class="sxs-lookup"><span data-stu-id="c6291-141">When the subscriber logs off, the subscriptions are disabled.</span></span>

<span data-ttu-id="c6291-142">Les abonnements par utilisateur sont effectifs uniquement lorsque le serveur de publication et l’abonné se trouvent sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="c6291-142">Per User subscriptions are effective only when the publisher and subscriber are on the same computer.</span></span> <span data-ttu-id="c6291-143">L’ouverture et la fermeture de session sont détectées uniquement sur l’ordinateur de l’éditeur, et non sur l’ordinateur sur lequel réside l’objet de l’abonné.</span><span class="sxs-lookup"><span data-stu-id="c6291-143">Logon and logoff are detected only at the publisher's computer—not the computer on which the subscriber object resides.</span></span>

</dd> </dl>

<span data-ttu-id="c6291-144">Le système d’événements utilise des méta-événements pour notifier les abonnés intéressés chaque fois que des objets de classe d’événements ou des abonnements sont créés, modifiés ou supprimés.</span><span class="sxs-lookup"><span data-stu-id="c6291-144">The event system uses meta-events to notify interested subscribers whenever event class objects or subscriptions are created, modified, or removed.</span></span> <span data-ttu-id="c6291-145">Pour recevoir des méta-événements du système d’événements, les applications doivent créer un abonnement qui réside sur l’ordinateur du système d’événements et qui spécifie l’ID d’interface de déclenchement (IID \_ IEventObjectChange).</span><span class="sxs-lookup"><span data-stu-id="c6291-145">To receive meta-events from the event system, applications must create a subscription that resides on the event system's computer and that specifies the firing interface ID (IID\_IEventObjectChange).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c6291-146">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c6291-146">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c6291-147">Filtrage des événements dans COM+</span><span class="sxs-lookup"><span data-stu-id="c6291-147">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="c6291-148">Publication et diffusion d’événements dans COM+</span><span class="sxs-lookup"><span data-stu-id="c6291-148">Publishing and Delivering Events in COM+</span></span>](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="c6291-149">Objet de classe d’événements COM+</span><span class="sxs-lookup"><span data-stu-id="c6291-149">The COM+ Event Class Object</span></span>](the-com--event-class-object.md)
</dt> <dt>

[<span data-ttu-id="c6291-150">Utilisation d’événements COM+ avec des composants en file d’attente COM+</span><span class="sxs-lookup"><span data-stu-id="c6291-150">Using COM+ Events with COM+ Queued Components</span></span>](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 



