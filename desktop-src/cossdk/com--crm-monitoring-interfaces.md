---
description: L’infrastructure CRM fournit un ensemble d’interfaces qui peuvent être utilisées pour analyser les CRM au sein d’une application serveur particulière.
ms.assetid: b8f40c91-001b-4003-b377-57a918988100
title: Interfaces d’analyse CRM COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c893040c46810c980c647cbacdc808200e8d5f5e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104200931"
---
# <a name="com-crm-monitoring-interfaces"></a><span data-ttu-id="be6c3-103">Interfaces d’analyse CRM COM+</span><span class="sxs-lookup"><span data-stu-id="be6c3-103">COM+ CRM Monitoring Interfaces</span></span>

<span data-ttu-id="be6c3-104">L’infrastructure CRM fournit un ensemble d’interfaces qui peuvent être utilisées pour analyser les CRM au sein d’une application serveur particulière.</span><span class="sxs-lookup"><span data-stu-id="be6c3-104">The CRM infrastructure provides a set of interfaces that can be used for monitoring the CRMs within a particular server application.</span></span> <span data-ttu-id="be6c3-105">Pour accéder aux interfaces de surveillance, un composant qui s’exécute dans l’application serveur doit d’abord créer un Clerk CRM spécialisé appelé « Clerk Recovery Clerk ».</span><span class="sxs-lookup"><span data-stu-id="be6c3-105">To access the monitoring interfaces, a component running within the server application must first create a specialized CRM clerk called the CRM recovery clerk.</span></span>

<span data-ttu-id="be6c3-106">Dans le cas d’une utilisation normale de CRM, les transactions sont supposées être éphémères et, par conséquent, les Workers CRM et les compensateurs CRM existent pendant une courte période, en général seulement quelques secondes.</span><span class="sxs-lookup"><span data-stu-id="be6c3-106">In normal use of CRMs, transactions are expected to be short-lived, and hence CRM Workers and CRM Compensators exist for a brief period of time, typically only a few seconds at most.</span></span> <span data-ttu-id="be6c3-107">Par conséquent, les interfaces de surveillance sont conçues pour fournir un instantané de l’état des CRM en cours d’exécution à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="be6c3-107">The monitoring interfaces are therefore designed to give a snapshot of the state of the executing CRMs at a particular point in time.</span></span> <span data-ttu-id="be6c3-108">Si l’un des CRM rencontre des problèmes, les interfaces de surveillance peuvent être utilisées pour se trouver à zéro dans sur le CRM gênant, pour inspecter ses enregistrements de journal et pour abandonner sa transaction si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="be6c3-108">If any of the CRMs are having problems, the monitoring interfaces can be used to zero in on the troublesome CRM, to inspect its log records and to abort its transaction if required.</span></span>

<span data-ttu-id="be6c3-109">Voici les trois interfaces d’analyse CRM et les descriptions de leur fonctionnement.</span><span class="sxs-lookup"><span data-stu-id="be6c3-109">Following are the three CRM monitoring interfaces and descriptions of how they work.</span></span>



| <span data-ttu-id="be6c3-110">Interface</span><span class="sxs-lookup"><span data-stu-id="be6c3-110">Interface</span></span>                                                         | <span data-ttu-id="be6c3-111">Description</span><span class="sxs-lookup"><span data-stu-id="be6c3-111">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="be6c3-112">**ICrmMonitor**</span><span class="sxs-lookup"><span data-stu-id="be6c3-112">**ICrmMonitor**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitor)<br/>                     | <span data-ttu-id="be6c3-113">À l’aide de [**ICrmMonitor :: GetClerks**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-getclerks), un instantané peut être obtenu de l’ensemble actuel des Clerk CRM actifs au sein de l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="be6c3-113">Using [**ICrmMonitor::GetClerks**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-getclerks), a snapshot can be obtained of the current set of active CRM clerks within the server application.</span></span> <span data-ttu-id="be6c3-114">À partir de ce, un objet de collection de Clerk CRM particulier digne d’intérêt peut être localisé et interrogé, y compris l’état actuel de sa transaction et les enregistrements de journal écrits par le CRM.</span><span class="sxs-lookup"><span data-stu-id="be6c3-114">From this, a particular CRM clerk collection object of interest can be located and queried, including the current state of its transaction and the log records written by the CRM.</span></span><br/> <span data-ttu-id="be6c3-115">Lorsque l’outil de surveillance a déterminé quel Clerk est digne d’intérêt, il appelle [**ICrmMonitor :: HoldClerk**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-holdclerk) pour recevoir une interface [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) sur ce Clerk particulier.</span><span class="sxs-lookup"><span data-stu-id="be6c3-115">When the monitoring tool has determined which clerk is of interest, it calls [**ICrmMonitor::HoldClerk**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-holdclerk) to get an [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) interface on that particular clerk.</span></span> <span data-ttu-id="be6c3-116">À ce stade, l’outil de surveillance détient une référence à ce Clerk et, si la transaction se termine, le régisseur est conservé en mémoire et n’est pas libéré tant que l’outil de surveillance n’est pas terminé.</span><span class="sxs-lookup"><span data-stu-id="be6c3-116">At this point, the monitoring tool is holding a reference to that clerk, and if the transaction completes, the clerk is held in memory and is not released until the monitoring tool is done.</span></span><br/>                                                                                                                                                                                                    |
| [<span data-ttu-id="be6c3-117">**ICrmMonitorClerks**</span><span class="sxs-lookup"><span data-stu-id="be6c3-117">**ICrmMonitorClerks**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorclerks)<br/>         | <span data-ttu-id="be6c3-118">À l’aide de cette interface, l’objet de collection Clerk peut être parcouru pour obtenir des informations sur l’état de la collection Clerk au moment où elle a été obtenue.</span><span class="sxs-lookup"><span data-stu-id="be6c3-118">Using this interface, the clerk collection object can be browsed for information about the state of the clerk collection at the moment it was obtained.</span></span> <span data-ttu-id="be6c3-119">Ces informations incluent le nombre d’employés, le ProgID du compensateur CRM utilisé par le Clerk, la description fournie au moment de l’inscription du compensateur CRM (à l’aide de [**ICrmLogControl :: RegisterCompensator**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-registercompensator)), l’ID d’unité de travail de la transaction et l’ID d’activité.</span><span class="sxs-lookup"><span data-stu-id="be6c3-119">This information includes the number of clerks, the ProgID of the CRM Compensator used by the clerk, the description provided at the time the CRM Compensator was registered (using [**ICrmLogControl::RegisterCompensator**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-registercompensator)), the transaction unit-of-work ID, and the activity ID.</span></span> <span data-ttu-id="be6c3-120">Les employés individuels sont également identifiés de manière unique par un « CLSID d’instance du Clerk », qui n’est pas un CLSID COM au sens habituel du terme, mais simplement un GUID unique qui identifie ce Clerk en particulier pour sa durée de vie.</span><span class="sxs-lookup"><span data-stu-id="be6c3-120">Individual clerks are also uniquely identified by a "clerk instance CLSID," which is not a COM CLSID in the usual sense of the term but simply a unique GUID that identifies this particular clerk for its lifetime.</span></span><br/>                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="be6c3-121">**ICrmMonitorLogRecords**</span><span class="sxs-lookup"><span data-stu-id="be6c3-121">**ICrmMonitorLogRecords**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords)<br/> | <span data-ttu-id="be6c3-122">Cette interface peut être utilisée pour interroger l’état actuel de la transaction, pour connaître le nombre d’enregistrements de journal écrits par le Clerk CRM et pour obtenir les données d’enregistrement de journal réelles.</span><span class="sxs-lookup"><span data-stu-id="be6c3-122">This interface can be used to query the current state of the transaction, to find out how many log records this CRM clerk has written, and to get the actual log record data.</span></span> <span data-ttu-id="be6c3-123">Les enregistrements de journal sont fournis à partir de l’interface [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) dans le même format que celui dans lequel ils ont été écrits à l’origine (à l’aide de [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol)).</span><span class="sxs-lookup"><span data-stu-id="be6c3-123">The log records are provided from the [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) interface in the same format that they were originally written (using [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol)).</span></span> <span data-ttu-id="be6c3-124">En outre, les **ICrmMonitorLogRecords** peuvent éventuellement être implémentés pour convertir les enregistrements de journal au format affichable, de sorte qu’ils puissent être présentés à l’aide d’un outil d’analyse générique.</span><span class="sxs-lookup"><span data-stu-id="be6c3-124">In addition, **ICrmMonitorLogRecords** can be optionally implemented to convert the log records to viewable format so they can be presented using a generic monitoring tool.</span></span><br/> <span data-ttu-id="be6c3-125">Étant donné que [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) est implémenté directement sur le Clerk CRM, vous pouvez [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) pour [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) (également implémenté sur le Clerk CRM).</span><span class="sxs-lookup"><span data-stu-id="be6c3-125">Because [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) is implemented directly on the CRM clerk, you can [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) (also implemented on the CRM clerk).</span></span> <span data-ttu-id="be6c3-126">Il peut ensuite être utilisé pour abandonner directement la transaction si nécessaire ([**ICrmLogControl :: ForceTransactionToAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-forcetransactiontoabort)).</span><span class="sxs-lookup"><span data-stu-id="be6c3-126">This can then be used to directly abort the transaction if required ([**ICrmLogControl::ForceTransactionToAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-forcetransactiontoabort)).</span></span><br/> |



 

## <a name="related-topics"></a><span data-ttu-id="be6c3-127">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="be6c3-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="be6c3-128">Concepts de Gestionnaire des ressources de compensation COM+</span><span class="sxs-lookup"><span data-stu-id="be6c3-128">COM+ Compensating Resource Manager Concepts</span></span>](com--compensating-resource-manager-concepts.md)
</dt> </dl>

 

