---
description: Résolution des problèmes liés à COM+ CRM
ms.assetid: 4d2d9372-b540-4e08-9b57-8687802610b6
title: Résolution des problèmes liés à COM+ CRM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b04e37d183dbf3df8d017e780917f955e14a033
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104523863"
---
# <a name="troubleshooting-the-com-crm"></a><span data-ttu-id="24dc9-103">Résolution des problèmes liés à COM+ CRM</span><span class="sxs-lookup"><span data-stu-id="24dc9-103">Troubleshooting the COM+ CRM</span></span>

<span data-ttu-id="24dc9-104">Voici les problèmes les plus courants rencontrés lors du développement et de l’utilisation du CRM COM+ :</span><span class="sxs-lookup"><span data-stu-id="24dc9-104">Following are the most common problems encountered when developing and using the COM+ CRM:</span></span>

-   <span data-ttu-id="24dc9-105">**Messages du journal des événements.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-105">**Event log messages.**</span></span> <span data-ttu-id="24dc9-106">Si l’application serveur CRM rencontre une erreur interne grave, elle échoue (met fin au processus de l’application CRM Server) et écrit un message dans le journal des événements Windows.</span><span class="sxs-lookup"><span data-stu-id="24dc9-106">If the CRM server application encounters a serious internal error, it will failfast (terminate the CRM server application process) and write a message to the Windows event log.</span></span> <span data-ttu-id="24dc9-107">Reportez-vous au journal des événements si des problèmes surviennent.</span><span class="sxs-lookup"><span data-stu-id="24dc9-107">Please refer to the event log if any problems are encountered.</span></span>

-   <span data-ttu-id="24dc9-108">**Exceptions du compensateur CRM.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-108">**Exceptions from the CRM Compensator.**</span></span> <span data-ttu-id="24dc9-109">L’infrastructure CRM crée le compensateur CRM et lui transmet les notifications de résultat de la transaction et les enregistrements de journal écrits par le processus de travail CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-109">The CRM infrastructure creates the CRM Compensator and passes it the transaction outcome notifications and the log records written by the CRM Worker.</span></span> <span data-ttu-id="24dc9-110">Si le compensateur CRM retourne une erreur ou lève une exception, il est intercepté par l’infrastructure CRM et provoque un FailFast.</span><span class="sxs-lookup"><span data-stu-id="24dc9-110">If the CRM Compensator returns an error or throws an exception, it is caught by the CRM infrastructure and causes a failfast.</span></span> <span data-ttu-id="24dc9-111">Un message dans le journal des événements indique qu’une exception a été reçue du compensateur CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-111">A message in the event log indicates that an exception was received from the CRM Compensator.</span></span> <span data-ttu-id="24dc9-112">Il est possible de forcer l’ignorance de ces exceptions.</span><span class="sxs-lookup"><span data-stu-id="24dc9-112">It is possible to force these exceptions to be ignored.</span></span> <span data-ttu-id="24dc9-113">(Voir [paramètres du Registre CRM com+](com--crm-registry-settings.md).) Les exceptions du compensateur CRM signifient probablement un problème dans le composant CRM Compensator spécifique et non dans l’infrastructure CRM elle-même.</span><span class="sxs-lookup"><span data-stu-id="24dc9-113">(See [COM+ CRM Registry Settings](com--crm-registry-settings.md).) Exceptions from the CRM Compensator most likely mean a problem in the specific CRM Compensator component and not in the CRM infrastructure itself.</span></span>

-   <span data-ttu-id="24dc9-114">**Trace de récupération.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-114">**Recovery trace.**</span></span> <span data-ttu-id="24dc9-115">Le suivi de récupération peut être très utile pour déterminer les problèmes lors de la récupération.</span><span class="sxs-lookup"><span data-stu-id="24dc9-115">The recovery trace can be very useful to determine problems during recovery.</span></span> <span data-ttu-id="24dc9-116">Pour plus d’informations sur l’activation de la trace de récupération, consultez [paramètres de Registre CRM com+](com--crm-registry-settings.md).</span><span class="sxs-lookup"><span data-stu-id="24dc9-116">For information about enabling recovery trace, see [COM+ CRM Registry Settings](com--crm-registry-settings.md).</span></span>

-   <span data-ttu-id="24dc9-117">**La tentative d’exécution avec le CRM n’est pas activée.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-117">**Trying to run with the CRM not enabled.**</span></span> <span data-ttu-id="24dc9-118">Il n’est pas suffisant simplement de placer les composants de travail CRM et du compensateur CRM dans l’application serveur COM+.</span><span class="sxs-lookup"><span data-stu-id="24dc9-118">It is not sufficient simply to place the CRM Worker and CRM Compensator components into the COM+ server application.</span></span> <span data-ttu-id="24dc9-119">La prise en charge de CRM doit être activée spécifiquement pour l’application serveur COM+ spécifique à l’aide de l’option **activer les gestionnaires de ressources de compensation** sous l’onglet **avancé** des pages de propriétés de l’application com+.</span><span class="sxs-lookup"><span data-stu-id="24dc9-119">Support for CRMs must be specifically enabled for the specific COM+ server application using the **Enable compensating resource managers** option on the **Advanced** tab of the COM+ application's property pages.</span></span> <span data-ttu-id="24dc9-120">(Pour plus d’informations, consultez [Configuration des composants CRM de com+](configuring-com--crm-components.md) .) En cas de tentative d’utilisation d’un CRM à l’intérieur d’une application serveur pour laquelle le CRM n’est pas activé, un code d’erreur est renvoyé au traitement CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-120">(See [Configuring COM+ CRM Components](configuring-com--crm-components.md) for more information.) If an attempt is made to use a CRM inside a server application that does not have the CRM enabled, an error code is returned to the CRM Worker.</span></span>

-   <span data-ttu-id="24dc9-121">**Tentative d’exécution de CRM dans les processus client.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-121">**Trying to run CRMs in client processes.**</span></span> <span data-ttu-id="24dc9-122">Les CRM ne s’exécutent pas dans les processus clients ; ils doivent s’exécuter dans un processus d’application serveur COM+.</span><span class="sxs-lookup"><span data-stu-id="24dc9-122">CRMs do not run in client processes; they must run in a COM+ server application process.</span></span> <span data-ttu-id="24dc9-123">Les composants CRM peuvent être placés dans un package de bibliothèque pour être utilisés par plusieurs applications serveur COM+, mais ils ne sont pas disponibles pour une utilisation dans les processus clients.</span><span class="sxs-lookup"><span data-stu-id="24dc9-123">CRM components can be placed in a library package for use by multiple COM+ server applications, but they are not available for use within client processes.</span></span> <span data-ttu-id="24dc9-124">Toute tentative d’utilisation des interfaces CRM à l’intérieur d’un processus client retourne un code d’erreur au travail CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-124">Attempting to use the CRM interfaces inside a client process returns an error code to the CRM Worker.</span></span>

-   <span data-ttu-id="24dc9-125">**Récupération en cours.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-125">**Recovery in progress.**</span></span> <span data-ttu-id="24dc9-126">La récupération démarre au démarrage d’une application de serveur CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-126">Recovery starts when a CRM server application starts.</span></span> <span data-ttu-id="24dc9-127">Toutefois, la récupération se produit en arrière-plan pendant le traitement normal de l’application CRM Server.</span><span class="sxs-lookup"><span data-stu-id="24dc9-127">However, recovery occurs in the background during the normal processing of the CRM server application.</span></span> <span data-ttu-id="24dc9-128">Le processus de travail CRM peut être créé avant la fin de la récupération.</span><span class="sxs-lookup"><span data-stu-id="24dc9-128">The CRM Worker can be created prior to recovery being completed.</span></span> <span data-ttu-id="24dc9-129">Les CRM ne peuvent pas être utilisés dans un processus d’application CRM Server tant que la récupération n’a pas abouti.</span><span class="sxs-lookup"><span data-stu-id="24dc9-129">CRMs cannot be used in a CRM server application process until recovery has been successfully completed.</span></span> <span data-ttu-id="24dc9-130">Dans ce cas, le processus de travail CRM reçoit un code d’erreur « récupération en cours » lorsqu’il tente d’inscrire le compensateur CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-130">In this case, the CRM Worker receives a "recovery in progress" error code as it tries to register the CRM Compensator.</span></span> <span data-ttu-id="24dc9-131">Le processus de travail CRM doit interroger ou différer jusqu’à ce que la récupération soit terminée.</span><span class="sxs-lookup"><span data-stu-id="24dc9-131">The CRM Worker should poll or otherwise delay until recovery has been completed.</span></span> <span data-ttu-id="24dc9-132">Le temps de récupération est spécifique à un type particulier de CRM et doit être pris en compte lors de la conception du CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-132">The recovery time is specific to a particular type of CRM, and this should be considered when designing the CRM.</span></span> <span data-ttu-id="24dc9-133">Les récupérations de longue durée ne sont pas souhaitables.</span><span class="sxs-lookup"><span data-stu-id="24dc9-133">Long duration recoveries are not desirable.</span></span>

-   <span data-ttu-id="24dc9-134">**Sécurité dans le fichier journal CRM.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-134">**Security on the CRM log file.**</span></span> <span data-ttu-id="24dc9-135">Si l’accès au fichier journal CRM est refusé, consultez Considérations sur la [sécurité de com+ CRM](com--crm-security-considerations.md) pour obtenir une description de la façon dont la sécurité est définie sur le fichier journal CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-135">If access to the CRM log file is denied, please see [COM+ CRM Security Considerations](com--crm-security-considerations.md) for a description of how security is set on the CRM log file.</span></span>

-   <span data-ttu-id="24dc9-136">**Transactions incertaines.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-136">**In-doubt transactions.**</span></span> <span data-ttu-id="24dc9-137">Dans de rares cas, une transaction DTC peut passer à l’état incertain ; autrement dit, le DTC ne peut pas déterminer le résultat de la transaction.</span><span class="sxs-lookup"><span data-stu-id="24dc9-137">In rare cases, a DTC transaction might go into the in-doubt state; that is, the DTC cannot determine the transaction outcome.</span></span> <span data-ttu-id="24dc9-138">Dans ce cas, pendant la récupération, le CRM conserve les enregistrements de journal pour cette transaction dans le fichier journal CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-138">For these cases, during recovery, the CRM maintains the log records for that transaction in the CRM log file.</span></span> <span data-ttu-id="24dc9-139">Lorsque la transaction incertaine a été résolue par le DTC, une autre récupération de CRM termine la transaction.</span><span class="sxs-lookup"><span data-stu-id="24dc9-139">When the in-doubt transaction has been resolved by the DTC, performing another CRM recovery completes the transaction.</span></span>

-   <span data-ttu-id="24dc9-140">**Création et publication du compensateur CRM.**</span><span class="sxs-lookup"><span data-stu-id="24dc9-140">**Creation and release of CRM Compensator.**</span></span> <span data-ttu-id="24dc9-141">La première fois qu’un compensateur CRM est inscrit par un travail CRM, il est créé par l’infrastructure CRM et interrogé pour déterminer quelles interfaces du compensateur CRM prennent en charge.</span><span class="sxs-lookup"><span data-stu-id="24dc9-141">The first time a CRM Compensator is registered by a CRM Worker, it is created by the CRM infrastructure and queried to determine which of the CRM Compensator interfaces it supports.</span></span> <span data-ttu-id="24dc9-142">Il est ensuite immédiatement libéré.</span><span class="sxs-lookup"><span data-stu-id="24dc9-142">It is then immediately released.</span></span> <span data-ttu-id="24dc9-143">Les compensateurs CRM doivent prendre en charge la possibilité d’être créés et libérés sans qu’aucun appel de méthode n’ait été effectué.</span><span class="sxs-lookup"><span data-stu-id="24dc9-143">CRM Compensators need to support the ability to be created and released without having had any intervening method calls.</span></span> <span data-ttu-id="24dc9-144">Si le compensateur CRM ne peut pas être créé correctement, peut-être en raison d’une inscription COM incorrecte, ou s’il ne prend pas en charge au moins l’une des interfaces CRM Compensator appropriées, un code d’erreur est renvoyé au traitement CRM.</span><span class="sxs-lookup"><span data-stu-id="24dc9-144">If the CRM Compensator cannot be created correctly, perhaps due to incorrect COM registration, or if it does not support at least one of the correct CRM Compensator interfaces, an error code is returned to the CRM Worker.</span></span>

## <a name="related-topics"></a><span data-ttu-id="24dc9-145">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="24dc9-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="24dc9-146">Concepts de Gestionnaire des ressources de compensation COM+</span><span class="sxs-lookup"><span data-stu-id="24dc9-146">COM+ Compensating Resource Manager Concepts</span></span>](com--compensating-resource-manager-concepts.md)
</dt> </dl>

 

 



