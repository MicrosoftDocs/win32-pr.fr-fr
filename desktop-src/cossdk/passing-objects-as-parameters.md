---
description: Passage d’objets en tant que paramètres
ms.assetid: 174847c8-4545-4f61-ae13-42bdec1405e7
title: Passage d’objets en tant que paramètres
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a58e012138bc65cec481f714ac216bb8227fb924
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104524044"
---
# <a name="passing-objects-as-parameters"></a><span data-ttu-id="ccf55-103">Passage d’objets en tant que paramètres</span><span class="sxs-lookup"><span data-stu-id="ccf55-103">Passing Objects as Parameters</span></span>

<span data-ttu-id="ccf55-104">Le service composants en file d’attente COM+ n’active pas la mise en file d’attente pour chaque composant COM existant.</span><span class="sxs-lookup"><span data-stu-id="ccf55-104">The COM+ queued components service does not enable queuing for every existing COM component.</span></span> <span data-ttu-id="ccf55-105">Il existe des restrictions sur les types de méthodes qui peuvent être mis en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="ccf55-105">There are restrictions on the types of methods that can be queued.</span></span> <span data-ttu-id="ccf55-106">En raison des contraintes de messagerie, les méthodes doivent respecter les règles suivantes :</span><span class="sxs-lookup"><span data-stu-id="ccf55-106">Because of messaging constraints, methods must adhere to the following rules:</span></span>

-   <span data-ttu-id="ccf55-107">Ils ne doivent contenir que des paramètres d’entrée.</span><span class="sxs-lookup"><span data-stu-id="ccf55-107">They must contain input parameters only.</span></span>
-   <span data-ttu-id="ccf55-108">Ils ne doivent retourner aucun résultat propre à l’application.</span><span class="sxs-lookup"><span data-stu-id="ccf55-108">They must return no application-specific result.</span></span>

<span data-ttu-id="ccf55-109">En outre, il existe des restrictions sur les types de paramètres d’entrée qui peuvent être passés à un composant mis en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="ccf55-109">Additionally, there are restrictions on the types of input parameters that can be passed to a queued component.</span></span> <span data-ttu-id="ccf55-110">Au moment de l’exécution, le service des composants en file d’attente empaquette les arguments au niveau du client et les transmet au composant serveur à l’aide de [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="ccf55-110">At run time, the queued components service packages the arguments at the client and passes them to the server component by using [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span></span> <span data-ttu-id="ccf55-111">Des types simples, tels que des entiers et des valeurs booléennes, peuvent être marshalés facilement ; les types plus complexes ne peuvent pas être marshalés sans l’aide.</span><span class="sxs-lookup"><span data-stu-id="ccf55-111">Simple types, such as integers and Booleans, can be marshaled easily—more complex types cannot be marshaled without help.</span></span>

<span data-ttu-id="ccf55-112">Dans le cas de la transmission d’un objet via l’appel de méthode d’un composant mis en file d’attente en tant que paramètre, le client passe l’objet à l’enregistreur.</span><span class="sxs-lookup"><span data-stu-id="ccf55-112">In the case of passing an object through a queued component's method call as a parameter, the client passes the object to the recorder.</span></span> <span data-ttu-id="ccf55-113">L’enregistreur marshale l’objet dans un message Message Queuing et le passe à l’écouteur.</span><span class="sxs-lookup"><span data-stu-id="ccf55-113">The recorder marshals the object into a Message Queuing message and passes it to the listener.</span></span> <span data-ttu-id="ccf55-114">Une fois que l’écouteur a sélectionné le message et l’a transmis au lecteur, le lecteur doit réinstancier l’objet pour le distribuer à l’appel de méthode spécifié par le client.</span><span class="sxs-lookup"><span data-stu-id="ccf55-114">After the listener picks up the message and passes it to the player, the player must reinstantiate the object to dispatch it to the method call specified by the client.</span></span> <span data-ttu-id="ccf55-115">En fonction des durées de vie du client et du serveur dans un environnement mis en file d’attente, l’implication est que ces objets doivent être en mesure de marshaler par valeur.</span><span class="sxs-lookup"><span data-stu-id="ccf55-115">Based on the lifetimes of the client and server in a queued environment, the implication is that these objects must be able to marshal by value.</span></span> <span data-ttu-id="ccf55-116">Étant donné que COM+ ne fournit pas de sémantique de passage par valeur pour les objets COM standard, l’enregistreur et le lecteur ont besoin d’aide du composant pour marshaler et démarshaler l’objet.</span><span class="sxs-lookup"><span data-stu-id="ccf55-116">Because COM+ does not provide pass-by-value semantics for standard COM objects, the recorder and player need help from the component to marshal and unmarshal the object.</span></span>

<span data-ttu-id="ccf55-117">Les références d’objets qui prennent en charge [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) peuvent être utilisées comme paramètres pour les appels de méthode sur les composants en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="ccf55-117">Object references that support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) can be used as parameters to method calls on queued components.</span></span> <span data-ttu-id="ccf55-118">L’objet ne peut pas faire d’hypothèses sur le moment où il sera réinstancié.</span><span class="sxs-lookup"><span data-stu-id="ccf55-118">The object cannot make assumptions about when it will be reinstantiated.</span></span> <span data-ttu-id="ccf55-119">Par exemple, le serveur peut ne pas être disponible ou le composant serveur ne peut pas être démarré tant que plus tard dans la journée.</span><span class="sxs-lookup"><span data-stu-id="ccf55-119">For example, the server may be unavailable or the server component may not be started until later in the day.</span></span> <span data-ttu-id="ccf55-120">Les objets qui ne prennent pas en charge **IPersistStream** renverront une erreur.</span><span class="sxs-lookup"><span data-stu-id="ccf55-120">Objects that do not support **IPersistStream** will return an error.</span></span>

## <a name="visual-basic-persistable-objects"></a><span data-ttu-id="ccf55-121">Visual Basic les objets persistants</span><span class="sxs-lookup"><span data-stu-id="ccf55-121">Visual Basic Persistable Objects</span></span>

<span data-ttu-id="ccf55-122">Microsoft Visual Basic 6 autorise la création d’objets persistants.</span><span class="sxs-lookup"><span data-stu-id="ccf55-122">Microsoft Visual Basic 6 allows persistable objects to be created.</span></span> <span data-ttu-id="ccf55-123">Ces objets prennent en charge [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) et peuvent être passés en tant que paramètres aux appels de méthode de composant mis en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="ccf55-123">These objects support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) and can be passed as parameters to queued component method calls.</span></span> <span data-ttu-id="ccf55-124">Avant qu’un objet Visual Basic puisse être passé à un composant mis en file d’attente, l’objet persistable doit être initialisé.</span><span class="sxs-lookup"><span data-stu-id="ccf55-124">Before a Visual Basic object can be passed to a queued component, the persistable object must be initialized.</span></span> <span data-ttu-id="ccf55-125">Pour ce faire, vous pouvez procéder de l’une des deux manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="ccf55-125">This can be done in one of the following two ways:</span></span>

-   <span data-ttu-id="ccf55-126">Si l’application qui crée l’objet persistant est écrite en Visual Basic, le runtime Visual Basic gère automatiquement l’initialisation de l’objet.</span><span class="sxs-lookup"><span data-stu-id="ccf55-126">If the application creating the persistable object is written in Visual Basic, the Visual Basic runtime handles the object initialization automatically.</span></span>
-   <span data-ttu-id="ccf55-127">Si l’application qui crée l’objet Visual Basic persistant est écrite dans un langage autre que Visual Basic, tel que Microsoft Visual C++, l’application doit initialiser explicitement le composant en interrogeant l’interface [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) de l’objet persistant ou en appelant la méthode [**IPersistStreamInit :: InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)ou [**IPersistStream :: Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) .</span><span class="sxs-lookup"><span data-stu-id="ccf55-127">If the application that creates the Visual Basic persistable object is written in a language other than Visual Basic, such as Microsoft Visual C++, the application must explicitly initialize the component by either querying for the persistable object's [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) interface or calling the [**IPersistStreamInit::InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew), or [**IPersistStream::Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) method.</span></span>

## <a name="ado-recordsets-and-ole-db-rowsets"></a><span data-ttu-id="ccf55-128">Jeux d’enregistrements ADO et ensembles de lignes OLE DB</span><span class="sxs-lookup"><span data-stu-id="ccf55-128">ADO Recordsets and OLE DB Rowsets</span></span>

<span data-ttu-id="ccf55-129">Le passage d' **objets d’ensemble de lignes ADO ou** OLE DB entre les composants permet à un composant de traiter les résultats des requêtes exécutées par un autre composant.</span><span class="sxs-lookup"><span data-stu-id="ccf55-129">Passing ADO **Recordset** or OLE DB rowset objects between components allows one component to process the results of queries executed by another component.</span></span> <span data-ttu-id="ccf55-130">Cela est utile lors du déploiement d’une application sur plusieurs ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="ccf55-130">This is helpful when deploying an application across multiple computers.</span></span> <span data-ttu-id="ccf55-131">Les objets **Recordset** et rowset peuvent être passés en tant que paramètres de méthode aux composants mis en file d’attente, avec les restrictions suivantes :</span><span class="sxs-lookup"><span data-stu-id="ccf55-131">**Recordset** and rowset objects can be passed as method parameters to queued components, with the following restrictions:</span></span>

-   <span data-ttu-id="ccf55-132">Les objets **Recordset** côté serveur ne peuvent pas être marshalés à l’aide de [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span><span class="sxs-lookup"><span data-stu-id="ccf55-132">Server-side **Recordset** objects cannot be marshaled using [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span></span> <span data-ttu-id="ccf55-133">Seuls les objets **Recordset** côté client peuvent être passés en tant que paramètres à un appel de méthode de composant mis en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="ccf55-133">Only client-side **Recordset** objects can be passed as parameters to a queued component method call.</span></span>
-   <span data-ttu-id="ccf55-134">Si vous travaillez directement avec OLE DB, l’ensemble de lignes OLE DB doit être défini en tant qu’ensemble de lignes côté client.</span><span class="sxs-lookup"><span data-stu-id="ccf55-134">If you work directly with OLE DB, the OLE DB rowset must be defined as a client-side rowset.</span></span>

 

 
