---
description: Création d’un filtre d’éditeur
ms.assetid: d91efecc-f02a-41c6-acf7-37b74723e7e8
title: Création d’un filtre d’éditeur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 997fe37cf0021bcb2aa153c2dc4b73597e0c43cc
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104111439"
---
# <a name="creating-a-publisher-filter"></a><span data-ttu-id="c4bc2-103">Création d’un filtre d’éditeur</span><span class="sxs-lookup"><span data-stu-id="c4bc2-103">Creating a Publisher Filter</span></span>

<span data-ttu-id="c4bc2-104">Il existe deux méthodes pour établir le filtre de l’éditeur : à l’aide de la propriété MultiPublisherFilterCLSID de la classe d’événements, ou à l’aide de [**IEventControl :: SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span><span class="sxs-lookup"><span data-stu-id="c4bc2-104">There are two methods to establish the publisher filter: using the MultiPublisherFilterCLSID property of the event class, or using [**IEventControl::SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span></span>

-   <span data-ttu-id="c4bc2-105">Étant donné qu’elle vous permet de composer l’objet d’événement avec le service [com+ en file d’attente](com--queued-components.md) , la méthode recommandée consiste à utiliser la propriété MultiPublisherFilterCLSID de la classe d’événements pour définir le filtre de l’éditeur.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-105">Because it allows you to compose the event object with the [COM+ queued components](com--queued-components.md) service, the preferred method is to use the MultiPublisherFilterCLSID property in the event class to set the publisher filter.</span></span> <span data-ttu-id="c4bc2-106">Cela établit un objet de filtre pour toutes les méthodes des interfaces d’événements pour un objet d’événement.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-106">This establishes one filter object for all the methods of the event interfaces for an event object.</span></span> <span data-ttu-id="c4bc2-107">L’objet d’événement active le filtre de l’éditeur lorsque l’objet de classe d’événements est instancié à l’aide de [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span><span class="sxs-lookup"><span data-stu-id="c4bc2-107">The event object activates the publisher filter when the event class object is instantiated using [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span>
-   <span data-ttu-id="c4bc2-108">Vous pouvez également utiliser [**SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span><span class="sxs-lookup"><span data-stu-id="c4bc2-108">You can also use [**SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span></span> <span data-ttu-id="c4bc2-109">Toutefois, si vous choisissez cette méthode, l’interface n’est pas mise en file d’attente et ne peut donc pas utiliser l’objet d’événement avec le service composants en file d’attente COM+ entre le serveur de publication et l’objet de classe d’événements.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-109">However, if you choose this method, the interface is not queuable and therefore cannot use the event object with the COM+ queued components service between the publisher and the event class object.</span></span> <span data-ttu-id="c4bc2-110">Pour plus d’informations sur l’utilisation du service Queued Components avec des événements COM+, consultez [utilisation d’événements com+ avec des composants en file d’attente com+](using-com--events-with-com--queued-components.md).</span><span class="sxs-lookup"><span data-stu-id="c4bc2-110">For additional information about using the queued components service with COM+ Events, see [Using COM+ Events with COM+ Queued Components](using-com--events-with-com--queued-components.md).</span></span>

<span data-ttu-id="c4bc2-111">Un événement peut avoir un ou plusieurs objets de filtre, ou aucun.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-111">An event can have one or more filter objects or none at all.</span></span> <span data-ttu-id="c4bc2-112">Les objets de filtre d’éditeur doivent prendre en charge [**IPublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) ou [**IMultiInterfacePublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter), selon que vous disposez d’une interface de déclenchement unique ou de plusieurs interfaces de déclenchement sur l’objet de classe d’événements.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-112">The publisher filter objects must support either [**IPublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) or [**IMultiInterfacePublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter), depending on whether you have a single firing interface or multiple firing interfaces on the event class object.</span></span> <span data-ttu-id="c4bc2-113">Les interfaces **IPublisherFilter** et **IMultiInterfacePublisherFilter** spécifient toutes deux une méthode **Initialize** .</span><span class="sxs-lookup"><span data-stu-id="c4bc2-113">The **IPublisherFilter** and **IMultiInterfacePublisherFilter** interfaces both specify an **Initialize** method.</span></span> <span data-ttu-id="c4bc2-114">La méthode Initialize est appelée par l’objet de classe **d'** événements immédiatement après la création de l’objet de filtre.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-114">The **Initialize** method is called by the event class object immediately after creating the filter object.</span></span>

<span data-ttu-id="c4bc2-115">Les événements COM+ essaient d’appeler deux méthodes sur le filtre.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-115">COM+ Events tries to invoke two methods on the filter.</span></span> <span data-ttu-id="c4bc2-116">Tout d’abord, elle appelle [**IPublisherFilter ::P reparetofire**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) et transmet un pointeur d’interface [**IFiringControl**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) au filtre.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-116">First it calls [**IPublisherFilter::PrepareToFire**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) and passes an [**IFiringControl**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) interface pointer to the filter.</span></span> <span data-ttu-id="c4bc2-117">Ensuite, il interroge l’objet de filtre pour l’interface d’événement.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-117">Then it queries the filter object for the event interface.</span></span> <span data-ttu-id="c4bc2-118">Si le filtre prend en charge l’interface d’événement, il appelle une méthode sur celui-ci.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-118">If the filter supports the event interface, it invokes a method on it.</span></span> <span data-ttu-id="c4bc2-119">Cela permet d’accéder aux paramètres du serveur de publication d’un événement.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-119">This provides access to the publisher parameters for an event.</span></span> <span data-ttu-id="c4bc2-120">Le filtre peut utiliser ces paramètres pour déterminer les abonnements à activer.</span><span class="sxs-lookup"><span data-stu-id="c4bc2-120">The filter can use these parameters to determine which subscriptions to fire.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c4bc2-121">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c4bc2-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c4bc2-122">Filtrage des événements dans COM+</span><span class="sxs-lookup"><span data-stu-id="c4bc2-122">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> </dl>

 

 
