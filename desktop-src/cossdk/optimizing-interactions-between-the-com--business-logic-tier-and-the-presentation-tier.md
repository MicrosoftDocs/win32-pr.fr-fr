---
description: En règle générale, la latence entre les niveaux d’une application distribuée diffère sensiblement.
ms.assetid: 4780a9fd-5940-4b10-a596-22214b17c033
title: Optimisation des interactions entre le niveau de logique métier COM+ et la couche présentation
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe6094cb12cc7875d8a18dea3d28ac55bf8d6ae2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106516390"
---
# <a name="optimizing-interactions-between-the-com-business-logic-tier-and-the-presentation-tier"></a><span data-ttu-id="26fbb-103">Optimisation des interactions entre le niveau de logique métier COM+ et la couche présentation</span><span class="sxs-lookup"><span data-stu-id="26fbb-103">Optimizing Interactions Between the COM+ Business Logic Tier and the Presentation Tier</span></span>

<span data-ttu-id="26fbb-104">En règle générale, la latence entre les niveaux d’une application distribuée diffère sensiblement.</span><span class="sxs-lookup"><span data-stu-id="26fbb-104">Typically, the latency between tiers of a distributed application differs greatly.</span></span> <span data-ttu-id="26fbb-105">Les appels entre le niveau de présentation et le niveau de logique métier sont souvent un ordre de grandeur plus lent que les appels entre le niveau métier et la couche données.</span><span class="sxs-lookup"><span data-stu-id="26fbb-105">Calls between the presentation tier and business logic tier are often an order of magnitude slower than calls between the business tier and data tier.</span></span> <span data-ttu-id="26fbb-106">Par conséquent, l’État détenu est plus coûteux lors de l’appel au niveau de la logique métier.</span><span class="sxs-lookup"><span data-stu-id="26fbb-106">As a result, held state is more costly when calling into the business logic tier.</span></span>

<span data-ttu-id="26fbb-107">Les rubriques suivantes expliquent comment passer des données entre les couches de la présentation et de la logique métier :</span><span class="sxs-lookup"><span data-stu-id="26fbb-107">The following topics discuss ways to pass data between the presentation and business logic tiers:</span></span>

-   [<span data-ttu-id="26fbb-108">Passage de paramètres</span><span class="sxs-lookup"><span data-stu-id="26fbb-108">Passing Parameters</span></span>](#passing-parameters)
-   [<span data-ttu-id="26fbb-109">Options de passage de données</span><span class="sxs-lookup"><span data-stu-id="26fbb-109">Data Passing Options</span></span>](#data-passing-options)
-   [<span data-ttu-id="26fbb-110">Utilisation d’un modèle de fabrique pour passer des données</span><span class="sxs-lookup"><span data-stu-id="26fbb-110">Using a Factory Pattern to Pass Data</span></span>](#using-a-factory-pattern-to-pass-data)
-   [<span data-ttu-id="26fbb-111">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="26fbb-111">Related topics</span></span>](#related-topics)

## <a name="passing-parameters"></a><span data-ttu-id="26fbb-112">Passage de paramètres</span><span class="sxs-lookup"><span data-stu-id="26fbb-112">Passing Parameters</span></span>

<span data-ttu-id="26fbb-113">Pour qu’un ensemble d’informations donné soit passé entre la couche de présentation et le niveau de logique métier, vous pouvez avoir une seule ligne, plusieurs lignes ou une combinaison d’une seule ligne (par exemple, un en-tête) et de plusieurs lignes de données de détail.</span><span class="sxs-lookup"><span data-stu-id="26fbb-113">For a given set of information to be passed between the presentation tier and the business logic tier, you may have a single row, multiple rows, or a combination of a single row (such as a header) and multiple detail rows of data.</span></span> <span data-ttu-id="26fbb-114">La méthode la plus efficace pour passer ces informations entre les niveaux est un appel de méthode unique.</span><span class="sxs-lookup"><span data-stu-id="26fbb-114">The most efficient way to pass this information between tiers is by a single method call.</span></span> <span data-ttu-id="26fbb-115">Cet appel unique gère l’ensemble des informations à transmettre.</span><span class="sxs-lookup"><span data-stu-id="26fbb-115">This single call would manage the entire information set to be passed.</span></span> <span data-ttu-id="26fbb-116">Cela est nécessaire, sauf si vous choisissez de contrôler la transaction à partir de la couche de présentation (et que tout traitement de transaction dans la couche de présentation est identique dans la fonction).</span><span class="sxs-lookup"><span data-stu-id="26fbb-116">This is necessary unless you choose to control the transaction from the presentation tier (and make all transaction treatment in the presentation tier identical in function).</span></span> <span data-ttu-id="26fbb-117">Microsoft ne recommande pas de mener des transactions à partir de la couche de présentation, car les appels entre ce niveau et le niveau de logique métier sont généralement les plus lents des appels dans une application multiniveau.</span><span class="sxs-lookup"><span data-stu-id="26fbb-117">Microsoft does not recommend conducting transactions from the presentation tier because calls between this tier and the business logic tier are usually the slowest of any calls in a multi-tier application.</span></span>

<span data-ttu-id="26fbb-118">Une façon de créer une telle méthode consiste à passer des lignes d’informations uniques en tant que paramètres et à passer plusieurs lignes en tant que jeux d’enregistrements ADO.</span><span class="sxs-lookup"><span data-stu-id="26fbb-118">One way to create such a method is to pass single rows of information as parameters and pass multiple rows as ADO recordsets.</span></span> <span data-ttu-id="26fbb-119">Les jeux d’enregistrements sont le cœur de la méthodologie d’accès aux données ADO de Microsoft, et l’utilisation des recordsets ADO vous permet de transmettre toutes les informations relatives à une seule transaction en une seule étape.</span><span class="sxs-lookup"><span data-stu-id="26fbb-119">Recordsets are the core of Microsoft's ADO data access methodology, and using ADO recordsets allows you to pass all the information related to a single transaction in one step.</span></span>

## <a name="data-passing-options"></a><span data-ttu-id="26fbb-120">Options de passage de données</span><span class="sxs-lookup"><span data-stu-id="26fbb-120">Data Passing Options</span></span>

<span data-ttu-id="26fbb-121">D’autres options sont à prendre en compte lors du passage de données.</span><span class="sxs-lookup"><span data-stu-id="26fbb-121">There are other options to consider when passing data.</span></span> <span data-ttu-id="26fbb-122">Il s’agit notamment de l’utilisation d’une liste de paramètres et d’un jeu d’enregistrements ADO (comme indiqué ci-dessus), de simplement des jeux d’enregistrements ADO, des chaînes encodées XML ou des tableaux de structures.</span><span class="sxs-lookup"><span data-stu-id="26fbb-122">These include using a list of parameters and ADO recordsets (as discussed above), just ADO recordsets, XML encoded strings, or arrays of structures.</span></span> <span data-ttu-id="26fbb-123">Cette section décrit chacune de ces options.</span><span class="sxs-lookup"><span data-stu-id="26fbb-123">This section discusses each of these options.</span></span>

<span data-ttu-id="26fbb-124">Le tableau suivant répertorie les zones où des précautions supplémentaires doivent être prises lors de l’utilisation de l’une des quatre possibilités de passage des arguments.</span><span class="sxs-lookup"><span data-stu-id="26fbb-124">The following table shows areas where extra care needs to be taken when using any of the four different argument-passing possibilities.</span></span> <span data-ttu-id="26fbb-125">Un « X » représente les zones où les compromis doivent être compris et pesés par rapport aux besoins de chaque projet.</span><span class="sxs-lookup"><span data-stu-id="26fbb-125">An "X" represents areas where trade-offs need to be understood and weighed against the needs of each project.</span></span> <span data-ttu-id="26fbb-126">N’essayez pas de prendre des décisions de passage d’argument pour chaque composant.</span><span class="sxs-lookup"><span data-stu-id="26fbb-126">Try not to make argument-passing decisions on a per-component basis.</span></span> <span data-ttu-id="26fbb-127">Les avantages d’un modèle de programmation cohérent dans un projet sont beaucoup plus importants que l’optimisation par méthode ou par composant dans toutes les circonstances sauf les plus extrêmes.</span><span class="sxs-lookup"><span data-stu-id="26fbb-127">The benefits of a consistent programming model throughout a project far outweigh any advantage of optimizing on a per-method or per-component basis in all but the most extreme circumstances.</span></span> <span data-ttu-id="26fbb-128">Les colonnes sont décrites dans la liste qui suit le tableau.</span><span class="sxs-lookup"><span data-stu-id="26fbb-128">The columns are described in the list that follows the table.</span></span>



|                       | <span data-ttu-id="26fbb-129">Accès concurrentiel</span><span class="sxs-lookup"><span data-stu-id="26fbb-129">Concurrency</span></span>  | <span data-ttu-id="26fbb-130">WAN</span><span class="sxs-lookup"><span data-stu-id="26fbb-130">WAN</span></span>          | <span data-ttu-id="26fbb-131">Déploiement</span><span class="sxs-lookup"><span data-stu-id="26fbb-131">Deployment</span></span>   | <span data-ttu-id="26fbb-132">Complexité</span><span class="sxs-lookup"><span data-stu-id="26fbb-132">Complexity</span></span>   |
|-----------------------|--------------|--------------|--------------|--------------|
| <span data-ttu-id="26fbb-133">Entrée</span><span class="sxs-lookup"><span data-stu-id="26fbb-133">Entry</span></span> | <span data-ttu-id="26fbb-134">Valeur</span><span class="sxs-lookup"><span data-stu-id="26fbb-134">Value</span></span> |
| <span data-ttu-id="26fbb-135">Recordsets</span><span class="sxs-lookup"><span data-stu-id="26fbb-135">Recordsets</span></span><br/> |              | <span data-ttu-id="26fbb-136">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-136">X</span></span><br/> | <span data-ttu-id="26fbb-137">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-137">X</span></span><br/> | <span data-ttu-id="26fbb-138">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-138">X</span></span><br/> |
| <span data-ttu-id="26fbb-139">XML</span><span class="sxs-lookup"><span data-stu-id="26fbb-139">XML</span></span><br/>        | <span data-ttu-id="26fbb-140">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-140">X</span></span><br/> |              | <span data-ttu-id="26fbb-141">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-141">X</span></span><br/> | <span data-ttu-id="26fbb-142">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-142">X</span></span><br/> |
| <span data-ttu-id="26fbb-143">Tableaux</span><span class="sxs-lookup"><span data-stu-id="26fbb-143">Arrays</span></span><br/>     | <span data-ttu-id="26fbb-144">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-144">X</span></span><br/> |              | <span data-ttu-id="26fbb-145">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-145">X</span></span><br/> | <span data-ttu-id="26fbb-146">X</span><span class="sxs-lookup"><span data-stu-id="26fbb-146">X</span></span><br/> |



 

<span data-ttu-id="26fbb-147">Les quatre colonnes définissent les zones à surveiller lors de l’utilisation de cette option pour passer des paramètres.</span><span class="sxs-lookup"><span data-stu-id="26fbb-147">The four columns define areas to watch out for when using that option to pass parameters.</span></span>

-   <span data-ttu-id="26fbb-148">**La colonne concurrence** représente la nécessité de coder ou de fournir un mécanisme qui gère les conditions de verrouillage sur les opérations de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="26fbb-148">**The Concurrency column** represents the need to code or provide a mechanism that manages locking conditions on update operations.</span></span> <span data-ttu-id="26fbb-149">Étant donné que les méthodes qui effectuent des enregistrements peuvent représenter des mises à jour, des problèmes d’accès concurrentiel peuvent survenir.</span><span class="sxs-lookup"><span data-stu-id="26fbb-149">Since methods that perform saves can represent updates, concurrency problems can arise.</span></span> <span data-ttu-id="26fbb-150">Deux types de verrouillage sont optimistes et pessimistes.</span><span class="sxs-lookup"><span data-stu-id="26fbb-150">Two types of locking are prevalent optimistic and pessimistic.</span></span> <span data-ttu-id="26fbb-151">Les verrous pessimistes empêchent un utilisateur d’obtenir des données à mettre à jour alors qu’un autre utilisateur est susceptible d’effectuer une mise à jour.</span><span class="sxs-lookup"><span data-stu-id="26fbb-151">Pessimistic locks prevent a user from getting data for update while another user has the potential for performing an update.</span></span> <span data-ttu-id="26fbb-152">Le verrouillage optimiste prend en charge un grand nombre d’utilisateurs en vous permettant de faire face à la probabilité que deux utilisateurs mettent à jour le même document en même temps.</span><span class="sxs-lookup"><span data-stu-id="26fbb-152">Optimistic locking supports a great many more users by trading against the likelihood that any two users would be updating the same document at the same time.</span></span> <span data-ttu-id="26fbb-153">Les appels de verrouillage optimistes permettent de vérifier que les données stockées correspondent aux données au moment où une copie des données a été consultée pour modification.</span><span class="sxs-lookup"><span data-stu-id="26fbb-153">Optimistic locking calls for checking to see that the data that is stored matches the data at the point when a copy of the data was accessed for modification.</span></span> <span data-ttu-id="26fbb-154">Les jeux d’enregistrements ADO assurent la prise en charge automatique du verrouillage optimiste.</span><span class="sxs-lookup"><span data-stu-id="26fbb-154">ADO recordsets provide automatic support for optimistic locking.</span></span> <span data-ttu-id="26fbb-155">Les scénarios de mise à jour impliquant des listes de paramètres de lignes uniques ne fournissent pas une prise en charge suffisante pour la vérification de l’accès concurrentiel.</span><span class="sxs-lookup"><span data-stu-id="26fbb-155">Update scenarios involving single row parameter lists do not provide sufficient support for concurrency checking.</span></span> <span data-ttu-id="26fbb-156">XML souffre de ce même problème, dans le cas où aucune reconnaissance du verrouillage n’est présente dans les données XML.</span><span class="sxs-lookup"><span data-stu-id="26fbb-156">XML suffers from this same problem, in that no locking awareness is present in XML data.</span></span>
-   <span data-ttu-id="26fbb-157">**La colonne WAN représente les** conditions dans lesquelles il peut y avoir une contention de transmission sur un réseau étendu (WAN).</span><span class="sxs-lookup"><span data-stu-id="26fbb-157">**The WAN column** represents conditions where there may be transmission contention on a wide area network (WAN ).</span></span> <span data-ttu-id="26fbb-158">Lorsque le réseau étendu ne dispose pas d’une capacité suffisante pour gérer l’ensemble des données déplacées à un moment donné, les utilisateurs de l’application rencontrent des retards de temps de réponse.</span><span class="sxs-lookup"><span data-stu-id="26fbb-158">When the WAN does not have sufficient capacity to manage all of the data being moved at any one time, application users experience response time delays.</span></span> <span data-ttu-id="26fbb-159">Pour prendre en charge l’accès concurrentiel optimiste, les jeux d’enregistrements ADO déconnectés transmettent deux copies des données du serveur au client.</span><span class="sxs-lookup"><span data-stu-id="26fbb-159">To support optimistic concurrency, disconnected ADO recordsets pass two copies of the data from the server to the client.</span></span> <span data-ttu-id="26fbb-160">La deuxième copie est utilisée par le client pour déterminer l’ensemble de lignes de mise à jour le plus petit à renvoyer lorsqu’une modification est validée.</span><span class="sxs-lookup"><span data-stu-id="26fbb-160">The second copy is used by the client to determine the smallest update rowset to pass back when a change is being committed.</span></span> <span data-ttu-id="26fbb-161">Bien que cela diminue le trafic du niveau présentation vers les données, la charge supplémentaire de la deuxième copie peut être importante.</span><span class="sxs-lookup"><span data-stu-id="26fbb-161">While this cuts down on traffic from the presentation tier to the data, the extra load of the second copy can be significant.</span></span> <span data-ttu-id="26fbb-162">L’utilisation de recordsets comme seul moyen de transmettre toutes les informations entraîne donc deux fois plus de données qu’il est nécessaire de passer entre les niveaux, sauf lorsque l’ensemble de lignes de mise à jour est renvoyé à la couche de données à partir d’une couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="26fbb-162">Using recordsets as the sole means of passing all information therefore causes twice as much data to be passed between tiers as is required, except when the update rowset is being passed back to the data tier from a presentation tier.</span></span>
-   <span data-ttu-id="26fbb-163">**La colonne de déploiement** représente les problèmes associés au passage de données lorsque des technologies spéciales sont requises à la fois sur l’appelant et sur le côté composant du réseau.</span><span class="sxs-lookup"><span data-stu-id="26fbb-163">**The Deployment column** represents issues associated with data passing when special technology is required on both the caller and component side of the network.</span></span> <span data-ttu-id="26fbb-164">Par exemple, l’utilisation d’un jeu d’enregistrements ADO requiert que les composants ADO soient présents sur le client et sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="26fbb-164">For example, using ADO recordsets requires ADO components to be present on both client and server.</span></span> <span data-ttu-id="26fbb-165">Les analyseurs XML doivent également être présents des deux côtés, afin d’éviter d’avoir à coder les analyseurs dans vos applications.</span><span class="sxs-lookup"><span data-stu-id="26fbb-165">XML parsers must be present on both sides as well, to avoid having to code parsers into your applications.</span></span>
-   <span data-ttu-id="26fbb-166">**La colonne complexité** est indiquée pour les quatre choix, et est une question de préférence ou d’expérience de modèle de programmation antérieure qui peut être déjà établie dans votre organisation de développement.</span><span class="sxs-lookup"><span data-stu-id="26fbb-166">**The Complexity column** is indicated for all four choices, and is a matter of preference or prior programming model experience that may be already established in your development organization.</span></span> <span data-ttu-id="26fbb-167">Certaines personnes trouvent que le passage de paramètres est fastidieux et semble qu’elle ajoute trop de complexité au problème de programmation.</span><span class="sxs-lookup"><span data-stu-id="26fbb-167">Some people find parameter passing to be cumbersome and feel it adds too much complexity to the programming problem.</span></span> <span data-ttu-id="26fbb-168">Le suivi du paramètre que vous gérez et de l’obtention de tous les éléments visibles dans une fenêtre de modification peut créer une complexité logistique que certains développeurs trouvent non gérables.</span><span class="sxs-lookup"><span data-stu-id="26fbb-168">Keeping track of which parameter you are handling, and getting them all visible in one editing window, can create a logistical complexity that some developers find unmanageable.</span></span>

<span data-ttu-id="26fbb-169">La méthode de passage de paramètres peut également avoir des compromis, tels que les suivants :</span><span class="sxs-lookup"><span data-stu-id="26fbb-169">The parameter-passing method also can have trade-offs, such as the following:</span></span>

-   <span data-ttu-id="26fbb-170">Les paramètres peuvent impliquer la gestion de plusieurs arguments et types d’argument, ainsi que le choix du moment approprié pour créer un jeu d’enregistrements à partir d’un paramètre.</span><span class="sxs-lookup"><span data-stu-id="26fbb-170">Parameters can involve managing multiple arguments and argument types as well as having to decide when it is appropriate to make a recordset a parameter.</span></span>
-   <span data-ttu-id="26fbb-171">Les jeux d’enregistrements ADO peuvent réduire les relations hiérarchiques dans les paramètres de méthode jusqu’à un ou deux arguments.</span><span class="sxs-lookup"><span data-stu-id="26fbb-171">ADO recordsets can cut hierarchical relationships in method parameters down to one or two arguments.</span></span> <span data-ttu-id="26fbb-172">Cela simplifie considérablement le modèle de programmation et prend en charge l’ajout de colonnes à un moment ultérieur, mais masque également la hiérarchie d’informations.</span><span class="sxs-lookup"><span data-stu-id="26fbb-172">This simplifies the programming model dramatically and supports adding columns at a later time, but it also hides the information hierarchy.</span></span> <span data-ttu-id="26fbb-173">L’extraction d’informations dans un jeu d’enregistrements ADO et son extraction ultérieure impliquent de connaître le nom de chaque colonne ou de connaître l’ordre des colonnes.</span><span class="sxs-lookup"><span data-stu-id="26fbb-173">Stuffing information into an ADO recordset and later extracting it involves knowing the names of each column or knowing the column order.</span></span> <span data-ttu-id="26fbb-174">Cette situation peut ajouter de la complexité pour d’autres développeurs de composants ou d’applications sur le projet.</span><span class="sxs-lookup"><span data-stu-id="26fbb-174">This situation can add complexity for other component or application developers on the project.</span></span>
-   <span data-ttu-id="26fbb-175">XML est une fonction différente de la complication de hiérarchie cachée mentionnée ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="26fbb-175">XML is a different spin on the hidden hierarchy complication mentioned above.</span></span> <span data-ttu-id="26fbb-176">Le programmeur doit comprendre l’utilisation d’un analyseur XML pour accéder aux informations et doit souvent connaître les noms de chaque élément dans le jeu de données avant que le jeu de données ne soit trouvé.</span><span class="sxs-lookup"><span data-stu-id="26fbb-176">The programmer needs to understand the use of an XML parser to gain access to the information and often must know the names of each item in the data set before the data set can be found.</span></span>
-   <span data-ttu-id="26fbb-177">Les tableaux de structures introduisent la nécessité d’une compréhension commune des informations transmises sur la partie de l’appelant et du composant.</span><span class="sxs-lookup"><span data-stu-id="26fbb-177">Arrays of structures introduce the need for a common understanding of the information being passed on the part of both caller and component.</span></span> <span data-ttu-id="26fbb-178">Ce besoin d’un mappage partagé entre deux éléments système peut entraîner des difficultés lors de la gestion de différentes versions de composants.</span><span class="sxs-lookup"><span data-stu-id="26fbb-178">This need for a map that is shared between two system elements can lead to difficulties when dealing with different versions of components.</span></span> <span data-ttu-id="26fbb-179">Bien que la signature de la méthode ne change pas, les modifications apportées aux informations attendues peuvent rendre les programmes d’appel incompatibles.</span><span class="sxs-lookup"><span data-stu-id="26fbb-179">While the method signature might not change, changes to the expected information can render calling programs incompatible.</span></span>

<span data-ttu-id="26fbb-180">Étant donné que les problèmes de complexité associés aux quatre méthodes de passage de paramètres sont tellement similaires, il est discutable qu’il existe une opportunité de simplification significative associée à une sélection.</span><span class="sxs-lookup"><span data-stu-id="26fbb-180">Because the complexity issues associated with all four parameter-passing methods are so similar, it is debatable that there is a significant simplification opportunity associated with any one selection.</span></span>

## <a name="using-a-factory-pattern-to-pass-data"></a><span data-ttu-id="26fbb-181">Utilisation d’un modèle de fabrique pour passer des données</span><span class="sxs-lookup"><span data-stu-id="26fbb-181">Using a Factory Pattern to Pass Data</span></span>

<span data-ttu-id="26fbb-182">Un point de conception important est la simplicité d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="26fbb-182">One important design point is ease of use.</span></span> <span data-ttu-id="26fbb-183">Le moment où vous avez décidé d’utiliser les jeux d’enregistrements ADO pour transmettre un ensemble structuré de détails à la couche présentation, vous avez introduit un problème de complexité.</span><span class="sxs-lookup"><span data-stu-id="26fbb-183">The moment you decided to use ADO recordsets to pass a structured set of details back to the presentation tier, you introduced a complexity problem.</span></span> <span data-ttu-id="26fbb-184">Les programmeurs de la couche présentation doivent comprendre la structure de ces jeux d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="26fbb-184">Presentation tier programmers need to understand the structure of those recordsets.</span></span> <span data-ttu-id="26fbb-185">Un problème plus complexe peut survenir lorsque vous avez besoin de plusieurs détails pour un ensemble de données à transmettre dans un Recordset.</span><span class="sxs-lookup"><span data-stu-id="26fbb-185">A greater complexity issue can arise when you require multiple details for a set of data to be passed in a recordset.</span></span> <span data-ttu-id="26fbb-186">Pour simplifier les choses, vous devez envisager de créer une méthode de fabrique d’objet Recordset chaque fois que vous envisagez de transmettre des données dans des jeux d’enregistrements ADO structurés.</span><span class="sxs-lookup"><span data-stu-id="26fbb-186">To simplify matters, you should consider creating a recordset factory method whenever you intend to require data to be passed in structured ADO recordsets.</span></span>

<span data-ttu-id="26fbb-187">La fabrique d’objets Recordset doit retourner un jeu d’enregistrements vide mais accessible en écriture à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="26fbb-187">The recordset factory should return an empty but writable disconnected recordset to the caller.</span></span> <span data-ttu-id="26fbb-188">Ce jeu d’enregistrements doit avoir les champs appropriés (noms et types de données) déjà configurés afin que le client appelant n’ait pas besoin de savoir comment fabriquer le Recordset.</span><span class="sxs-lookup"><span data-stu-id="26fbb-188">This recordset should have the proper fields (names and data types) already configured so that the calling client does not need to know how to manufacture the recordset.</span></span> <span data-ttu-id="26fbb-189">Cette approche est souvent appelée *modèle de fabrique* et est un modèle de solution courant qui résout le besoin de créer un objet d’une complexité donnée sans avoir à connaître les nuances de sa création.</span><span class="sxs-lookup"><span data-stu-id="26fbb-189">This approach is often referred to as the *factory pattern* and is a common solution pattern that solves the need to create an object of a given complexity without having to know the nuances of creating it.</span></span>

<span data-ttu-id="26fbb-190">Les choix de conception simples, tels que le choix du même nom de paramètre pour le même élément de données, sur chaque méthode, où ces informations sont passées, facilitent l’examen d’une méthode et savent ce qui est attendu.</span><span class="sxs-lookup"><span data-stu-id="26fbb-190">Simple design choices such as choosing the same parameter name for the same piece of data across every method where that information is passed makes it easy to look at a method and know what is expected.</span></span> <span data-ttu-id="26fbb-191">Le fait de s’assurer que l’ordre dans lequel les arguments like sont passés est cohérent dans une famille de méthodes complète offre un point de confort qui applique un modèle cohérent.</span><span class="sxs-lookup"><span data-stu-id="26fbb-191">Making sure that the order in which like arguments are passed is consistent across an entire family of methods provides a comfort point that enforces a consistent model.</span></span>

## <a name="related-topics"></a><span data-ttu-id="26fbb-192">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="26fbb-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="26fbb-193">Optimisation des interactions entre le niveau de logique métier COM+ et la couche données</span><span class="sxs-lookup"><span data-stu-id="26fbb-193">Optimizing Interactions Between the COM+ Business Logic Tier and the Data Tier</span></span>](optimizing-interactions-between-the-com--business-logic-tier-and-the-data-tier.md)
</dt> </dl>

 

 




