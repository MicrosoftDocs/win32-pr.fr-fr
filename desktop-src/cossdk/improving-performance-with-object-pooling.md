---
description: Amélioration des performances avec la mise en pool d’objets
ms.assetid: 7a8a38d8-6549-4686-a298-f3b427b380e3
title: Amélioration des performances avec la mise en pool d’objets
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 398b9140080d3a439293b5152b4da7251978e800
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106515160"
---
# <a name="improving-performance-with-object-pooling"></a><span data-ttu-id="485d3-103">Amélioration des performances avec la mise en pool d’objets</span><span class="sxs-lookup"><span data-stu-id="485d3-103">Improving Performance with Object Pooling</span></span>

<span data-ttu-id="485d3-104">La mise en pool d’objets peut être extrêmement efficace dans certaines circonstances, entraînant des augmentations significatives des performances.</span><span class="sxs-lookup"><span data-stu-id="485d3-104">Object pooling can be extremely effective in certain circumstances, yielding substantial increases in performance.</span></span> <span data-ttu-id="485d3-105">L’idée générale de la réutilisation d’objets pour tirer le meilleur parti consiste à regrouper autant de ressources que possible, à mettre en œuvre l’initialisation à partir du travail réel effectué, puis à personnaliser administrativement les caractéristiques du pool sur le matériel réel au moment du déploiement.</span><span class="sxs-lookup"><span data-stu-id="485d3-105">The general idea for reusing objects to best advantage is to pool as many resources as possible, factoring out initialization from actual work performed, and then to administratively tailor the pool characteristics to actual hardware at deployment time.</span></span> <span data-ttu-id="485d3-106">En d’autres termes, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="485d3-106">That is, you should proceed according to the following steps:</span></span>

1.  <span data-ttu-id="485d3-107">Écrivez l’objet afin de prendre en compte l’initialisation coûteuse et l’acquisition des ressources qui est effectuée pour n’importe quel client comme condition préalable à l’exécution du travail réel au nom du client.</span><span class="sxs-lookup"><span data-stu-id="485d3-107">Write the object so as to factor out expensive initialization and resource acquisition that is performed for any client as a prerequisite to doing actual work on the client's behalf.</span></span> <span data-ttu-id="485d3-108">Écrire des constructeurs d’objets lourds pour regrouper autant de ressources que possible, afin qu’ils soient détenus par l’objet et immédiatement disponibles lorsque les clients obtiennent un objet à partir du pool.</span><span class="sxs-lookup"><span data-stu-id="485d3-108">Write heavy object constructors to pool as many resources as possible so that these are held by the object and immediately available when clients get an object from the pool.</span></span>
2.  <span data-ttu-id="485d3-109">Configurez le pool de manière administrative pour obtenir le meilleur équilibre dans les ressources matérielles disponibles, en général la mémoire dédiée à la gestion d’un pool d’une certaine taille en échange d’un accès client et de l’utilisation des objets plus rapides.</span><span class="sxs-lookup"><span data-stu-id="485d3-109">Administratively configure the pool to achieve the best balance in available hardware resources, usually trading the memory dedicated to maintaining a pool of a certain size in exchange for faster client access and use of objects.</span></span> <span data-ttu-id="485d3-110">À un certain point, le regroupement permettra de réduire les retours et vous pourrez obtenir de bonnes performances tout en limitant l’utilisation possible des ressources par un composant particulier.</span><span class="sxs-lookup"><span data-stu-id="485d3-110">At a certain point, pooling will achieve diminishing returns and you can get good enough performance while limiting possible resource usage by a particular component.</span></span>

## <a name="doing-actual-work-or-acquiring-resources"></a><span data-ttu-id="485d3-111">Travail réel ou acquisition de ressources</span><span class="sxs-lookup"><span data-stu-id="485d3-111">Doing Actual Work or Acquiring Resources</span></span>

<span data-ttu-id="485d3-112">Si vous avez un composant que les clients utiliseront brièvement et en succession rapide, où une partie importante du temps d’utilisation des objets est passée à acquérir des ressources ou à s’initialiser avant d’effectuer un travail spécifique pour le client, il est probable que l’écriture de votre composant pour utiliser le regroupement d’objets sera un grand succès pour vous.</span><span class="sxs-lookup"><span data-stu-id="485d3-112">If you have a component that clients will use briefly and in rapid succession, where a significant portion of object use time is spent in acquiring resources or initializing prior to doing specific work for the client, chances are that writing your component to use object pooling will be a big win for you.</span></span>

<span data-ttu-id="485d3-113">Vous pouvez écrire le composant de sorte que dans le constructeur de l’objet, vous réalisiez la plus grande partie du travail long qui est uniforme pour tous les clients, en obtenant une ou plusieurs connexions, en exécutant des scripts, en extrayant des données d’initialisation à partir de fichiers ou sur un réseau, etc.</span><span class="sxs-lookup"><span data-stu-id="485d3-113">You can write the component so that in the object's constructor you perform as much of the time-consuming work that is uniform for all clients as possible—acquiring one or several connections, running scripts, fetching initialization data from files or across a network, and so forth.</span></span> <span data-ttu-id="485d3-114">Cela a pour effet de regrouper toutes ces ressources.</span><span class="sxs-lookup"><span data-stu-id="485d3-114">This has the effect of pooling every such resource.</span></span> <span data-ttu-id="485d3-115">Vous regroupez la combinaison des ressources et de l’état générique nécessaire pour effectuer un travail.</span><span class="sxs-lookup"><span data-stu-id="485d3-115">You are pooling the combination of resources and generic state necessary to perform some work.</span></span>

<span data-ttu-id="485d3-116">Dans ce cas, lorsque les clients obtiennent un objet à partir du pool, ces ressources sont immédiatement disponibles.</span><span class="sxs-lookup"><span data-stu-id="485d3-116">In this circumstance, when clients get an object from the pool, they have those resources immediately available.</span></span> <span data-ttu-id="485d3-117">En règle générale, ils utilisent l’objet pour effectuer une petite unité de travail, en envoyant ou en extrayant des données, puis l’objet appellera [**IObjectContext :: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) ou [**IObjectContext :: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort) et retournent.</span><span class="sxs-lookup"><span data-stu-id="485d3-117">Typically, they will use the object to do some small unit of work, pushing or pulling data, and then the object will call [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) or [**IObjectContext::SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort) and return.</span></span> <span data-ttu-id="485d3-118">Avec les modèles d’utilisation à incendie rapide tels que celui-ci, le regroupement offre d’excellentes avantages en matière de performances.</span><span class="sxs-lookup"><span data-stu-id="485d3-118">With rapid-fire use patterns such as this, pooling yields excellent performance benefits.</span></span> <span data-ttu-id="485d3-119">Vous pouvez tirer pleinement parti de la simplicité du modèle de programmation de transaction automatique sans État, tout en obtenant des performances avec des composants avec état traditionnels.</span><span class="sxs-lookup"><span data-stu-id="485d3-119">You can fully leverage the simplicity of the stateless automatic transaction programming model yet achieve performance on par with traditional stateful components.</span></span>

<span data-ttu-id="485d3-120">Toutefois, si les clients utilisent un objet pendant une longue période à chaque fois qu’ils l’appellent, le regroupement aura moins de sens.</span><span class="sxs-lookup"><span data-stu-id="485d3-120">However, if clients use an object for a long time each time they call it, pooling will make less sense.</span></span> <span data-ttu-id="485d3-121">L’avantage en termes de vitesse que vous obtenez est marginal lorsque le temps d’utilisation augmente par rapport au temps d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="485d3-121">The speed advantage that you gain is marginal as use time increases relative to initialization time.</span></span> <span data-ttu-id="485d3-122">Vous gagnez des retours qui peuvent ne pas justifier le coût de la mémoire nécessaire à la conservation d’un pool d’objets actifs.</span><span class="sxs-lookup"><span data-stu-id="485d3-122">You get diminishing returns that may not justify the cost of the memory necessary to hold a pool of active objects.</span></span>

## <a name="sharing-cost-across-multiple-clients"></a><span data-ttu-id="485d3-123">Partage des coûts entre plusieurs clients</span><span class="sxs-lookup"><span data-stu-id="485d3-123">Sharing Cost Across Multiple Clients</span></span>

<span data-ttu-id="485d3-124">Une variante de l’initialisation de la factorisation est que vous pouvez utiliser le regroupement pour amortir de façon statistique le coût de l’acquisition de ressources coûteuses.</span><span class="sxs-lookup"><span data-stu-id="485d3-124">A variation on factoring out initialization is that you can use pooling to statistically amortize the cost of acquiring expensive resources.</span></span> <span data-ttu-id="485d3-125">Si vous prenez l’acquisition ou l’initialisation une fois, puis réutilisez l’objet, vous partagez ce coût sur tous les clients qui utilisent l’objet pendant sa durée de vie.</span><span class="sxs-lookup"><span data-stu-id="485d3-125">If you take the hit of acquisition or initialization once and then reuse the object, you share that cost across all clients that use the object during its lifetime.</span></span> <span data-ttu-id="485d3-126">Une durée de construction lourde n’est générée qu’une seule fois par objet.</span><span class="sxs-lookup"><span data-stu-id="485d3-126">Heavy construction time is incurred only once per object.</span></span>

## <a name="preallocating-objects"></a><span data-ttu-id="485d3-127">Préallouer des objets</span><span class="sxs-lookup"><span data-stu-id="485d3-127">Preallocating Objects</span></span>

<span data-ttu-id="485d3-128">Si vous spécifiez une taille de pool minimale différente de zéro, ce nombre minimal d’objets sera créé et regroupé au démarrage de l’application, prêt pour tous les clients qui appellent à l’application.</span><span class="sxs-lookup"><span data-stu-id="485d3-128">If you specify a nonzero minimum pool size, that minimum number of objects will be created and pooled when the application starts, ready for any clients that call in to the application.</span></span>

## <a name="governing-resource-use-with-pool-management"></a><span data-ttu-id="485d3-129">Administration de l’utilisation des ressources avec la gestion des pools</span><span class="sxs-lookup"><span data-stu-id="485d3-129">Governing Resource Use with Pool Management</span></span>

<span data-ttu-id="485d3-130">Vous pouvez utiliser la taille de pool maximale pour régir très précisément la manière dont vous utilisez les ressources.</span><span class="sxs-lookup"><span data-stu-id="485d3-130">You can use the maximum pool size to govern very precisely how you use resources.</span></span> <span data-ttu-id="485d3-131">Par exemple, si vous disposez d’une licence pour un certain nombre de connexions de base de données, vous pouvez contrôler le nombre de connexions ouvertes à tout moment.</span><span class="sxs-lookup"><span data-stu-id="485d3-131">For example, if you have licensed a certain number of database connections, you can control how many connections you have open at any time.</span></span>

<span data-ttu-id="485d3-132">Lorsque vous prenez en compte les modèles d’utilisation des clients, les caractéristiques d’utilisation des objets et les ressources physiques telles que la mémoire et les connexions, vous pouvez trouver un point d’équilibre optimal quand vous effectuez le réglage des performances.</span><span class="sxs-lookup"><span data-stu-id="485d3-132">When you take into consideration client use patterns, object use characteristics, and physical resources such as memory and connections, you are likely to find some optimal balance point when you do performance tuning.</span></span> <span data-ttu-id="485d3-133">Le regroupement d’objets entraînera la diminution des retours après un certain point.</span><span class="sxs-lookup"><span data-stu-id="485d3-133">Pooling objects will yield diminishing returns after a certain point.</span></span> <span data-ttu-id="485d3-134">Vous pouvez déterminer le niveau de performances dont vous avez besoin et équilibrer les ressources nécessaires pour y parvenir.</span><span class="sxs-lookup"><span data-stu-id="485d3-134">You can determine what level of performance you require and balance that against what resources are necessary to achieve it.</span></span>

<span data-ttu-id="485d3-135">Pour faciliter le réglage des performances lors de la configuration de la mise en pool d’objets, vous pouvez surveiller les statistiques d’objets des composants d’une application.</span><span class="sxs-lookup"><span data-stu-id="485d3-135">To facilitate performance tuning when you configure object pooling, you can monitor object statistics for the components in an application.</span></span> <span data-ttu-id="485d3-136">Pour plus d’informations, consultez [Monitoring Object Statistics](monitoring-object-statistics.md).</span><span class="sxs-lookup"><span data-stu-id="485d3-136">For details, see [Monitoring Object Statistics](monitoring-object-statistics.md).</span></span>

## <a name="improve-performance-of-jit-activated-components"></a><span data-ttu-id="485d3-137">Améliorer les performances des composants de JIT-Activated</span><span class="sxs-lookup"><span data-stu-id="485d3-137">Improve Performance of JIT-Activated Components</span></span>

<span data-ttu-id="485d3-138">Le regroupement d’objets fonctionne très bien avec le service [d’activation juste-à-temps com+](com--just-in-time-activation.md) .</span><span class="sxs-lookup"><span data-stu-id="485d3-138">Object pooling works very well with the [COM+ just-in-time activation](com--just-in-time-activation.md) service.</span></span> <span data-ttu-id="485d3-139">En regroupant les objets qui sont activés juste-à-temps, vous pouvez accélérer la réactivation des objets.</span><span class="sxs-lookup"><span data-stu-id="485d3-139">By pooling objects that are being JIT-activated, you can speed object reactivation.</span></span> <span data-ttu-id="485d3-140">Vous bénéficiez des avantages du maintien du canal ouvert par l’activation JIT tout en réduisant le coût de la réactivation.</span><span class="sxs-lookup"><span data-stu-id="485d3-140">You get the benefits of holding the channel open by JIT activation while mitigating the cost of reactivation.</span></span> <span data-ttu-id="485d3-141">Vous pouvez utiliser le regroupement dans ce cas pour déterminer la quantité de mémoire que vous souhaitez allouer aux objets dont les références sont actives.</span><span class="sxs-lookup"><span data-stu-id="485d3-141">You can use pooling in this case to govern how much memory you wish to allocate to objects that have references active.</span></span>

<span data-ttu-id="485d3-142">Il est très probable que vous regroupez des composants activés juste-à-temps lorsqu’ils sont transactionnels.</span><span class="sxs-lookup"><span data-stu-id="485d3-142">You are most likely to be pooling JIT-activated components when they are transactional.</span></span> <span data-ttu-id="485d3-143">Le mise en pool d’objets est optimisé pour gérer les composants transactionnels.</span><span class="sxs-lookup"><span data-stu-id="485d3-143">Object pooling is optimized to handle transactional components.</span></span> <span data-ttu-id="485d3-144">Pour plus d’informations, consultez [regroupement d’objets transactionnels](pooling-transactional-objects.md).</span><span class="sxs-lookup"><span data-stu-id="485d3-144">For more information, see [Pooling Transactional Objects](pooling-transactional-objects.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="485d3-145">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="485d3-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="485d3-146">Chaînes du constructeur d’objet COM+</span><span class="sxs-lookup"><span data-stu-id="485d3-146">COM+ Object Constructor Strings</span></span>](com--object-constructor-strings.md)
</dt> <dt>

[<span data-ttu-id="485d3-147">Contrôle de la durée de vie et de l’état des objets</span><span class="sxs-lookup"><span data-stu-id="485d3-147">Controlling Object Lifetime and State</span></span>](controlling-object-lifetime-and-state.md)
</dt> <dt>

[<span data-ttu-id="485d3-148">Fonctionnement du regroupement d’objets</span><span class="sxs-lookup"><span data-stu-id="485d3-148">How Object Pooling Works</span></span>](how-object-pooling-works.md)
</dt> <dt>

[<span data-ttu-id="485d3-149">Regroupement d’objets transactionnels</span><span class="sxs-lookup"><span data-stu-id="485d3-149">Pooling Transactional Objects</span></span>](pooling-transactional-objects.md)
</dt> <dt>

[<span data-ttu-id="485d3-150">Conditions requises pour les objets regroupables</span><span class="sxs-lookup"><span data-stu-id="485d3-150">Requirements for Poolable Objects</span></span>](requirements-for-poolable-objects.md)
</dt> </dl>

 

 



