---
description: Le recyclage des applications peut augmenter considérablement la stabilité globale de vos applications COM+ en proposant un correctif rapide pour les problèmes connus et en vous aidant à vous protéger contre les problèmes inattendus.
ms.assetid: bf98318b-4d87-44cc-85a1-68faf5547e06
title: Concepts de recyclage des applications COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab37376ff3bc6d03f454f63822641ed69fad0b47
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393019"
---
# <a name="com-application-recycling-concepts"></a><span data-ttu-id="fa8c1-103">Concepts de recyclage des applications COM+</span><span class="sxs-lookup"><span data-stu-id="fa8c1-103">COM+ Application Recycling Concepts</span></span>

<span data-ttu-id="fa8c1-104">Le recyclage des applications peut augmenter considérablement la stabilité globale de vos applications COM+ en proposant un correctif rapide pour les problèmes connus et en vous aidant à vous protéger contre les problèmes inattendus.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-104">Application recycling can significantly increase the overall stability of your COM+ applications by offering a quick fix for known problems and helping to protect against unexpected ones.</span></span> <span data-ttu-id="fa8c1-105">Par exemple, les performances de l’application peuvent se dégrader au fil du temps en raison de problèmes tels que les fuites de mémoire, l’utilisation des ressources non évolutives et l’échec du processus.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-105">For example, application performance can degrade over time because of problems such as memory leaks, nonscalable resource usage, and process failure.</span></span> <span data-ttu-id="fa8c1-106">COM+ fournit le recyclage des applications comme solution à ces problèmes.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-106">COM+ provides application recycling as a solution to these problems.</span></span> <span data-ttu-id="fa8c1-107">Vous pouvez utiliser le recyclage d’applications pour arrêter automatiquement un processus et le redémarrer, ce qui a pour conséquence la réinitialisation d’un processus défaillant et la réallocation de mémoire qu’il utilise.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-107">You can use application recycling to automatically shut down a process and restart it, thus reinitializing a failing process and reallocating memory it uses.</span></span>

<span data-ttu-id="fa8c1-108">Le recyclage d’applications s’effectue en créant un doublon du processus Dllhost associé à une application.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-108">Application recycling works by creating a duplicate of the Dllhost process associated with an application.</span></span> <span data-ttu-id="fa8c1-109">Ce processus Dllhost duplique toutes les futures demandes d’objets, ce qui laisse l’ancien Dllhost terminer la maintenance des demandes d’objets restantes.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-109">This duplicate Dllhost process services all future object requests, which leaves the old Dllhost to finish servicing the remaining object requests.</span></span> <span data-ttu-id="fa8c1-110">L’ancien processus Dllhost est arrêté lorsqu’il détecte la publication de toutes les références externes aux objets du processus ou lorsque la valeur du délai d’expiration est atteinte.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-110">The old Dllhost process is shut down when it detects the release of all external references to objects in the process or when the expiration time-out value is reached.</span></span> <span data-ttu-id="fa8c1-111">Grâce à ce comportement, le recyclage d’applications garantit qu’une application cliente ne rencontre pas d’interruption de service.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-111">Through this behavior, application recycling ensures that a client application does not experience a service interruption.</span></span>

> [!Note]  
> <span data-ttu-id="fa8c1-112">Vous ne pouvez pas recycler une application COM+ qui a été configurée pour s’exécuter en tant que service Windows.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-112">You cannot recycle a COM+ application that has been configured to run as a Windows service.</span></span> <span data-ttu-id="fa8c1-113">En outre, les applications de bibliothèque disposent des propriétés de recyclage et de regroupement de leur processus hôte.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-113">Also, library applications have the recycling and pooling properties of their host process.</span></span>

 

<span data-ttu-id="fa8c1-114">Vous pouvez configurer le recyclage d’applications de manière administrative, à l’aide de l’outil d’administration Services de composants, ou par programme, via le kit de développement logiciel (SDK) d’administration COM+.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-114">You can configure application recycling administratively, by using the Component Services administrative tool, or programmatically, through the COM+ Administrative SDK.</span></span> <span data-ttu-id="fa8c1-115">Vous pouvez recycler les processus en fonction de plusieurs critères, déterminés par les propriétés suivantes d’un objet [**COMAdminCatalogObject**](comadmincatalogobject.md) dans la collection d' [**applications**](applications.md) :</span><span class="sxs-lookup"><span data-stu-id="fa8c1-115">You can recycle processes based on several criteria, determined by the following properties of a [**COMAdminCatalogObject**](comadmincatalogobject.md) object in the [**Applications**](applications.md) collection:</span></span>

-   <span data-ttu-id="fa8c1-116">**RecycleLifetimeLimit.**</span><span class="sxs-lookup"><span data-stu-id="fa8c1-116">**RecycleLifetimeLimit.**</span></span> <span data-ttu-id="fa8c1-117">Nombre maximal de minutes pendant lesquelles un processus peut s’exécuter avant son recyclage.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-117">The maximum number of minutes a process can run before it's recycled.</span></span> <span data-ttu-id="fa8c1-118">La plage valide est comprise entre 0 et 30 240 minutes (21 jours).</span><span class="sxs-lookup"><span data-stu-id="fa8c1-118">The valid range is 0 through 30,240 minutes (21 days).</span></span> <span data-ttu-id="fa8c1-119">Le nombre de minutes par défaut est 0, ce qui indique que le processus ne se recyclera pas pour atteindre une limite de durée de vie.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-119">The default number of minutes is 0, which indicates that the process will not recycle from reaching a lifetime limit.</span></span>
-   <span data-ttu-id="fa8c1-120">**RecycleMemoryLimit.**</span><span class="sxs-lookup"><span data-stu-id="fa8c1-120">**RecycleMemoryLimit.**</span></span> <span data-ttu-id="fa8c1-121">Quantité maximale d’utilisation de la mémoire de processus (en kilo-octets) avant le recyclage du processus.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-121">The maximum amount of process memory usage (in kilobytes) before recycling the process.</span></span> <span data-ttu-id="fa8c1-122">Si l’utilisation de la mémoire de processus dépasse le nombre spécifié pendant plus d’une minute, le processus est recyclé.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-122">If the process memory usage exceeds the specified number for longer than one minute, the process is recycled.</span></span> <span data-ttu-id="fa8c1-123">La plage valide est comprise entre 0 et 1 048 576 Ko.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-123">The valid range is 0 through 1,048,576 KB.</span></span> <span data-ttu-id="fa8c1-124">La quantité d’utilisation de la mémoire par défaut est de 0 Ko, ce qui indique que le processus ne recyclera pas d’atteindre une limite de mémoire.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-124">The default amount of memory usage is 0 KB, which indicates that the process will not recycle from reaching a memory limit.</span></span>
-   <span data-ttu-id="fa8c1-125">**RecycleCallLimit.**</span><span class="sxs-lookup"><span data-stu-id="fa8c1-125">**RecycleCallLimit.**</span></span> <span data-ttu-id="fa8c1-126">Nombre maximal d’appels que les objets d’application peuvent accepter avant de recycler le processus.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-126">The maximum number of calls that application objects can accept before recycling the process.</span></span> <span data-ttu-id="fa8c1-127">La plage valide est comprise entre 0 et 1 048 576 appels.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-127">The valid range is 0 through 1,048,576 calls.</span></span> <span data-ttu-id="fa8c1-128">Le nombre d’appels par défaut est 0, ce qui indique que le processus ne sera pas recyclé pour atteindre une limite d’appel.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-128">The default number of calls is 0, which indicates that the process will not recycle from reaching a call limit.</span></span>
-   <span data-ttu-id="fa8c1-129">**RecycleActivationLimit.**</span><span class="sxs-lookup"><span data-stu-id="fa8c1-129">**RecycleActivationLimit.**</span></span> <span data-ttu-id="fa8c1-130">Nombre maximal d’activations d’objets d’application à accepter avant de recycler le processus.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-130">The maximum number of application object activations to accept before recycling the process.</span></span> <span data-ttu-id="fa8c1-131">La plage valide est comprise entre 0 et 1 048 576.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-131">The valid range is 0 through 1,048,576 activations.</span></span> <span data-ttu-id="fa8c1-132">Le nombre d’activations par défaut est 0, ce qui indique que le processus ne sera pas recyclé pour atteindre une limite d’activation.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-132">The default number of activations is 0, which indicates that the process will not recycle from reaching an activation limit.</span></span>

<span data-ttu-id="fa8c1-133">En outre, la propriété RecycleExpirationTimeout de l’objet [**COMAdminCatalogObject**](comadmincatalogobject.md) est utilisée pour forcer l’arrêt d’un processus recyclé.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-133">Additionally, the RecycleExpirationTimeout property of the [**COMAdminCatalogObject**](comadmincatalogobject.md) object is used to force the shutdown of a recycled process.</span></span> <span data-ttu-id="fa8c1-134">Elle indique le nombre de minutes d’attente pour la libération de toutes les références externes aux objets dans le processus recyclé avant de forcer l’arrêt du processus.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-134">It indicates the number of minutes to wait for the release of all external references to objects in the recycled process before forcibly shutting down the process.</span></span> <span data-ttu-id="fa8c1-135">La plage valide est comprise entre 1 et 1440 minutes (24 heures) et le délai d’expiration par défaut est de 15 minutes.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-135">The valid range is 1 through 1440 minutes (24 hours), and the default expiration time-out is 15 minutes.</span></span> <span data-ttu-id="fa8c1-136">Cette valeur est utilisée uniquement lorsqu’il est déjà déterminé qu’un processus sera recyclé selon les autres critères.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-136">This value is used only when it is already determined that a process will be recycled based on the other criteria.</span></span>

<span data-ttu-id="fa8c1-137">Vous pouvez sélectionner plusieurs critères pour le recyclage d’une application.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-137">You can select more than one criterion for recycling an application.</span></span> <span data-ttu-id="fa8c1-138">COM+ recycle l’application une fois que le premier du jeu de critères est satisfait.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-138">COM+ recycles the application after the first of the set of criteria is satisfied.</span></span> <span data-ttu-id="fa8c1-139">Vous pouvez définir la valeur du délai d’expiration pour déterminer la durée pendant laquelle un ancien processus Dllhost peut consacrer des demandes de service restantes avant d’être arrêté de force.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-139">You can set the expiration time-out value to determine how long an old Dllhost process can spend completing remaining service requests before being forcibly shut down.</span></span>

<span data-ttu-id="fa8c1-140">La collection [**ApplicationInstances**](applicationinstances.md) fournit la propriété HasRecycled, qui permet de déterminer si l’application a déjà été recyclée.</span><span class="sxs-lookup"><span data-stu-id="fa8c1-140">The [**ApplicationInstances**](applicationinstances.md) collection provides the HasRecycled property, which provides a way to determine whether the application has ever been recycled.</span></span>

## <a name="related-topics"></a><span data-ttu-id="fa8c1-141">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="fa8c1-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fa8c1-142">Tâches de recyclage des applications COM+</span><span class="sxs-lookup"><span data-stu-id="fa8c1-142">COM+ Application Recycling Tasks</span></span>](com--application-recycling-tasks.md)
</dt> <dt>

[<span data-ttu-id="fa8c1-143">**RecycleSurrogate**</span><span class="sxs-lookup"><span data-stu-id="fa8c1-143">**RecycleSurrogate**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-recyclesurrogate)
</dt> </dl>

 

 



