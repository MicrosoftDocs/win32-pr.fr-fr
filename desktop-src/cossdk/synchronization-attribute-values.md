---
description: L’attribut de synchronisation est une propriété déclarative qui spécifie le type de synchronisation que vous souhaitez attribuer à vos composants lorsqu’ils sont activés.
ms.assetid: 7f044ee5-b99e-4f0c-a680-b1e2672949fc
title: Valeurs d’attribut de synchronisation
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4606726d5202a1453e98d5bf609084982f8f824e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393043"
---
# <a name="synchronization-attribute-values"></a><span data-ttu-id="1d49e-103">Valeurs d’attribut de synchronisation</span><span class="sxs-lookup"><span data-stu-id="1d49e-103">Synchronization Attribute Values</span></span>

<span data-ttu-id="1d49e-104">L’attribut de synchronisation est une propriété déclarative qui spécifie le type de synchronisation que vous souhaitez attribuer à vos composants lorsqu’ils sont activés.</span><span class="sxs-lookup"><span data-stu-id="1d49e-104">The synchronization attribute is a declarative property that specifies what type of synchronization you want your components to have when they are activated.</span></span> <span data-ttu-id="1d49e-105">Lorsque vous incluez l’attribut de synchronisation, COM+ gère les détails de la synchronisation en votre nom ; vous n’avez pas besoin d’effectuer d’autres appels.</span><span class="sxs-lookup"><span data-stu-id="1d49e-105">When you include the synchronization attribute, COM+ handles the details of synchronization on your behalf; you do not have to make any other calls.</span></span>

<span data-ttu-id="1d49e-106">En fonction de ses exigences, un objet peut partager la synchronisation de son appelant, exiger une nouvelle synchronisation ou fonctionner sans synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1d49e-106">Depending on its requirements, an object can share its caller's synchronization, require a new synchronization, or operate without synchronization.</span></span>

<span data-ttu-id="1d49e-107">COM+ fournit les valeurs d’attribut de synchronisation suivantes :</span><span class="sxs-lookup"><span data-stu-id="1d49e-107">COM+ provides the following synchronization attribute values:</span></span>

-   <span data-ttu-id="1d49e-108">**Désactivé.**</span><span class="sxs-lookup"><span data-stu-id="1d49e-108">**Disabled.**</span></span> <span data-ttu-id="1d49e-109">Lorsque vous désactivez l’attribut de synchronisation, COM+ ignore les exigences de synchronisation du composant en déterminant le contexte de l’objet.</span><span class="sxs-lookup"><span data-stu-id="1d49e-109">When you disable the synchronization attribute, COM+ ignores the synchronization requirements of the component in determining context for the object.</span></span> <span data-ttu-id="1d49e-110">Par conséquent, l’objet peut ou ne peut pas partager le contexte (et la synchronisation) de son appelant.</span><span class="sxs-lookup"><span data-stu-id="1d49e-110">As a result, the object may or may not share its caller's context (and synchronization).</span></span>

    <span data-ttu-id="1d49e-111">En général, vous devez utiliser cette valeur d’attribut lorsque vous savez que le composant n’accède jamais à un gestionnaire de ressources.</span><span class="sxs-lookup"><span data-stu-id="1d49e-111">In general, you should use this attribute value when you know the component never accesses a resource manager.</span></span> <span data-ttu-id="1d49e-112">Lors de la migration de composants COM vers COM+, vous devez désactiver l’attribut de synchronisation pour conserver le même comportement que le composant COM non configuré.</span><span class="sxs-lookup"><span data-stu-id="1d49e-112">When migrating COM components to COM+, you must disable the synchronization attribute to maintain the same behavior as the unconfigured COM component.</span></span> <span data-ttu-id="1d49e-113">Un composant non configuré est un composant COM qui n’a pas été installé dans une application COM+.</span><span class="sxs-lookup"><span data-stu-id="1d49e-113">An unconfigured component is a COM component that has not been installed in a COM+ application.</span></span>

-   <span data-ttu-id="1d49e-114">**Non pris en charge.**</span><span class="sxs-lookup"><span data-stu-id="1d49e-114">**Not Supported.**</span></span> <span data-ttu-id="1d49e-115">Un objet avec cette valeur ne participe jamais à la synchronisation, et ce quel que soit l’état de son appelant.</span><span class="sxs-lookup"><span data-stu-id="1d49e-115">An object with this value never participates in synchronization, regardless of the status of its caller.</span></span> <span data-ttu-id="1d49e-116">Ce paramètre est disponible uniquement pour les composants qui ne sont pas transactionnels et qui n’utilisent pas le service [d’activation juste-à-temps (JIT) com+](com--just-in-time-activation.md) .</span><span class="sxs-lookup"><span data-stu-id="1d49e-116">This setting is available only for components that are non-transactional and do not use the [COM+ just-in-time (JIT) activation](com--just-in-time-activation.md) service.</span></span>

-   <span data-ttu-id="1d49e-117">**Géré.**</span><span class="sxs-lookup"><span data-stu-id="1d49e-117">**Supported.**</span></span> <span data-ttu-id="1d49e-118">Un objet avec cette valeur participe à la synchronisation, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="1d49e-118">An object with this value participates in synchronization if it exists.</span></span> <span data-ttu-id="1d49e-119">Vous déclarez cette valeur lorsque vous souhaitez qu’un objet partage dans la synchronisation de son appelant, mais ne nécessite pas de synchronisation propre.</span><span class="sxs-lookup"><span data-stu-id="1d49e-119">You declare this value when you want an object to share in its caller's synchronization but not require synchronization of its own.</span></span>

    <span data-ttu-id="1d49e-120">Une bonne raison de définir votre attribut de synchronisation sur pris en charge est que ce paramètre peut être moins onéreux en termes de ressources système.</span><span class="sxs-lookup"><span data-stu-id="1d49e-120">A good reason to set your synchronization attribute to Supported is that this setting can be less expensive in terms of system resources.</span></span> <span data-ttu-id="1d49e-121">Toutefois, il est plus difficile d’écrire votre composant en raison de la nécessité de le protéger contre les appels simultanés.</span><span class="sxs-lookup"><span data-stu-id="1d49e-121">However, it is more difficult to write your component because of the need to protect it from concurrent calls.</span></span> <span data-ttu-id="1d49e-122">L’implication de la définition de l’attribut de synchronisation sur pris en charge est que, dans certains cas, une instance de votre objet peut être créée de façon à ce qu’elle ne soit pas synchronisée.</span><span class="sxs-lookup"><span data-stu-id="1d49e-122">The implication of setting the synchronization attribute to Supported is that, under certain circumstances, an instance of your object may be created in such a way that it's not synchronized.</span></span> <span data-ttu-id="1d49e-123">Si le modèle de thread du composant est libre ou les deux, vous devez protéger les données de votre instance avec un certain type de mécanisme de verrouillage.</span><span class="sxs-lookup"><span data-stu-id="1d49e-123">If the component's threading model is Free or Both, you will have to protect your instance data with some type of locking mechanism.</span></span> <span data-ttu-id="1d49e-124">Si le modèle de thread est cloisonné (STA), vous n’aurez pas besoin de protéger les données de votre instance.</span><span class="sxs-lookup"><span data-stu-id="1d49e-124">If the Threading Model is Apartment (STA), you won't need to protect your instance data.</span></span>

-   <span data-ttu-id="1d49e-125">**Obligatoire.**</span><span class="sxs-lookup"><span data-stu-id="1d49e-125">**Required.**</span></span> <span data-ttu-id="1d49e-126">Lorsque vous définissez cet attribut, COM+ garantit que tous les objets créés à partir du composant seront synchronisés.</span><span class="sxs-lookup"><span data-stu-id="1d49e-126">When you set this attribute, COM+ ensures that all objects created from the component will be synchronized.</span></span> <span data-ttu-id="1d49e-127">En fait, chaque fois que COM+ crée une instance de votre composant, il n’y a qu’un seul thread à la fois.</span><span class="sxs-lookup"><span data-stu-id="1d49e-127">In effect, whenever COM+ creates an instance of your component, it makes sure there's only one thread going through this instance at a time.</span></span>

    <span data-ttu-id="1d49e-128">Lorsque COM+ active un objet, il examine l’état de synchronisation de son appelant.</span><span class="sxs-lookup"><span data-stu-id="1d49e-128">As COM+ activates an object, it looks at the synchronization status of its caller.</span></span> <span data-ttu-id="1d49e-129">Si l’appelant est synchronisé, COM+ transmet la limite de synchronisation de l’appelant pour inclure le nouvel objet.</span><span class="sxs-lookup"><span data-stu-id="1d49e-129">If the caller is synchronized, COM+ flows the caller's synchronization boundary to include the new object.</span></span> <span data-ttu-id="1d49e-130">Dans le cas contraire, COM+ commence la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1d49e-130">Otherwise, COM+ begins the synchronization.</span></span>

-   <span data-ttu-id="1d49e-131">**Nécessite New.**</span><span class="sxs-lookup"><span data-stu-id="1d49e-131">**Requires New.**</span></span> <span data-ttu-id="1d49e-132">Un objet avec cette valeur doit participer à une nouvelle synchronisation, où COM+ gère les contextes et les cloisonnements pour le compte de tous les composants impliqués dans l’appel.</span><span class="sxs-lookup"><span data-stu-id="1d49e-132">An object with this value must participate in a new synchronization, where COM+ manages contexts and apartments on behalf of all components involved in the call.</span></span> <span data-ttu-id="1d49e-133">COM+ lance automatiquement une nouvelle synchronisation, qui est différente de la synchronisation de l’appelant.</span><span class="sxs-lookup"><span data-stu-id="1d49e-133">COM+ automatically initiates a new synchronization, which is distinct from the caller's synchronization.</span></span>

    <span data-ttu-id="1d49e-134">Une bonne raison de définir votre attribut de synchronisation sur requiert New est que ce paramètre vous permet d’effectuer plus efficacement des appels externes à une instance de votre composant.</span><span class="sxs-lookup"><span data-stu-id="1d49e-134">A good reason to set your synchronization attribute to Requires New is that this setting allows you to make outside calls to an instance of your component more efficiently.</span></span> <span data-ttu-id="1d49e-135">Toutefois, elle effectue également des appels entre votre objet et l’objet qui l’a créé plus cher en termes de ressources système.</span><span class="sxs-lookup"><span data-stu-id="1d49e-135">However, it also makes calls between your object and the object that created it more expensive in terms of system resources.</span></span>

    <span data-ttu-id="1d49e-136">Par exemple, supposons que votre objet et son objet créateur partagent les mêmes limites de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1d49e-136">For example, assume a case where your object and its creator object share the same synchronization boundary.</span></span> <span data-ttu-id="1d49e-137">Si le client A appelle l’objet créateur et que le client B appelle votre objet, le deuxième appel devra attendre la fin du premier appel.</span><span class="sxs-lookup"><span data-stu-id="1d49e-137">If client A calls the creator object and client B calls your object, the second call will have to wait until the first call is completed.</span></span> <span data-ttu-id="1d49e-138">Si vous définissez requires New, votre objet est créé dans une limite de synchronisation distincte.</span><span class="sxs-lookup"><span data-stu-id="1d49e-138">If you set Requires New, your object is created in a separate synchronization boundary.</span></span> <span data-ttu-id="1d49e-139">Dans ce cas, les appels d’autres objets peuvent être traités en même temps.</span><span class="sxs-lookup"><span data-stu-id="1d49e-139">In this case, calls from other objects can be processed at the same time.</span></span> <span data-ttu-id="1d49e-140">Toutefois, les appels de l’objet créateur à votre objet nécessitent davantage de ressources système, car ils doivent franchir les limites de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="1d49e-140">However, calls from the creator object to your object require more system resources because they must cross synchronization boundaries.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1d49e-141">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1d49e-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1d49e-142">Définition de l’attribut de synchronisation</span><span class="sxs-lookup"><span data-stu-id="1d49e-142">Setting the Synchronization Attribute</span></span>](setting-the-synchronization-attribute.md)
</dt> <dt>

[<span data-ttu-id="1d49e-143">Dépendances de synchronisation</span><span class="sxs-lookup"><span data-stu-id="1d49e-143">Synchronization Dependencies</span></span>](synchronization-dependencies.md)
</dt> </dl>

 

 



