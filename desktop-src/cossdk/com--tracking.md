---
description: Suivi COM+
ms.assetid: ad3bdeb5-f303-411a-abfb-ccde3f9a86b9
title: Suivi COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 828cc87b5a24363fd814d37c29e61a3ce204d988
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104483064"
---
# <a name="com-tracking"></a><span data-ttu-id="ec841-103">Suivi COM+</span><span class="sxs-lookup"><span data-stu-id="ec841-103">COM+ Tracking</span></span>

<span data-ttu-id="ec841-104">Le service de suivi COM+ vous permet de créer vos propres programmes d’administration et de diagnostic qui assurent le suivi de l’État et des performances des applications COM+ en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="ec841-104">The COM+ tracking service enables you to build your own administrative and diagnostic programs that track the status and performance of running COM+ applications.</span></span> <span data-ttu-id="ec841-105">Le suivi COM+ fournit des informations statistiques sur l’utilisation des applications COM+, ainsi que des informations d’État, par exemple si une instance d’application serveur COM+ est suspendue ou a été recyclée.</span><span class="sxs-lookup"><span data-stu-id="ec841-105">COM+ tracking provides statistical information about the use of COM+ applications as well as status information, such as whether a COM+ server application instance is paused or has been recycled.</span></span> <span data-ttu-id="ec841-106">Les outils peuvent utiliser des informations de suivi dans le cadre de la surveillance du diagnostic ou à des fins d’affichage.</span><span class="sxs-lookup"><span data-stu-id="ec841-106">Tools can use tracking information in diagnostic monitoring or for display purposes.</span></span> <span data-ttu-id="ec841-107">Par exemple, l’outil d’administration Services de composants utilise le suivi COM+ pour afficher l’état des instances de l’application COM+ dans les dossiers applications COM+ et processus en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="ec841-107">For example, the Component Services administrative tool uses COM+ tracking to display the status of COM+ application instances in the COM+ Applications and Running Processes folders.</span></span>

<span data-ttu-id="ec841-108">Le suivi COM+ calcule et met à jour périodiquement un ensemble de métriques couramment utilisées, ce qui rend ces informations disponibles aux programmes qui en ont besoin.</span><span class="sxs-lookup"><span data-stu-id="ec841-108">COM+ tracking calculates and periodically updates a set of commonly-used metrics, making this information available to programs that need it.</span></span> <span data-ttu-id="ec841-109">Elle est similaire à l’instrumentation COM+ dans le sens où les deux services collectent automatiquement des données à partir d’instances d’application COM+ et mettent ces données à la disposition des consommateurs.</span><span class="sxs-lookup"><span data-stu-id="ec841-109">It is similar to COM+ Instrumentation in that both services automatically collect data from COM+ application instances and make this data available to consumers.</span></span> <span data-ttu-id="ec841-110">Toutefois, il existe des différences importantes entre ces services, à la fois dans la fonctionnalité fournie et dans l’utilisation classique.</span><span class="sxs-lookup"><span data-stu-id="ec841-110">However, there are some important differences between these services, both in the functionality provided and typical usage.</span></span> <span data-ttu-id="ec841-111">Le tableau suivant résume ces différences.</span><span class="sxs-lookup"><span data-stu-id="ec841-111">The following table summarizes these differences.</span></span>



| <span data-ttu-id="ec841-112">Instrumentation COM+</span><span class="sxs-lookup"><span data-stu-id="ec841-112">COM+ Instrumentation</span></span>                                                                                                                                                                                                   | <span data-ttu-id="ec841-113">Suivi COM+</span><span class="sxs-lookup"><span data-stu-id="ec841-113">COM+ Tracking</span></span>                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ec841-114">Données affinées.</span><span class="sxs-lookup"><span data-stu-id="ec841-114">Fine-grained data.</span></span> <span data-ttu-id="ec841-115">Le service d’instrumentation COM+ notifie les abonnés inscrits d’événements discrets individuels (par exemple, méthode appelée, objet détruit) qui se produisent dans une instance d’application COM+.</span><span class="sxs-lookup"><span data-stu-id="ec841-115">The COM+ instrumentation service notifies registered subscribers of individual discrete events (for example, method called, object destroyed) that occur in a COM+ application instance.</span></span><br/> | <span data-ttu-id="ec841-116">Données agrégées.</span><span class="sxs-lookup"><span data-stu-id="ec841-116">Aggregated data.</span></span> <span data-ttu-id="ec841-117">Le suivi COM+ calcule et met régulièrement à jour les métriques couramment utilisées pour l’État et les performances des instances de l’application COM+.</span><span class="sxs-lookup"><span data-stu-id="ec841-117">COM+ tracking calculates and periodically updates commonly-used metrics for the status and performance of COM+ application instances.</span></span><br/> |
| <span data-ttu-id="ec841-118">En général, les abonnés aux événements calculent les métriques, à l’aide d’algorithmes et de stratégies ad hoc.</span><span class="sxs-lookup"><span data-stu-id="ec841-118">Event subscribers typically calculate metrics on their own, using ad-hoc algorithms and policies.</span></span><br/>                                                                                                           | <span data-ttu-id="ec841-119">Les métriques sont calculées automatiquement par le service de suivi COM+.</span><span class="sxs-lookup"><span data-stu-id="ec841-119">Metrics are calculated automatically by the COM+ tracking service.</span></span> <span data-ttu-id="ec841-120">Tous les consommateurs obtiennent les mêmes données, sans prise en charge des mesures personnalisées.</span><span class="sxs-lookup"><span data-stu-id="ec841-120">All consumers get the same data, with no support for custom metrics.</span></span><br/>                |
| <span data-ttu-id="ec841-121">Après l’inscription d’un abonnement, le consommateur ne reçoit pas d’informations sur une instance d’application COM+ jusqu’à ce qu’un événement se produise.</span><span class="sxs-lookup"><span data-stu-id="ec841-121">After registering a subscription, the consumer does not receive any information about a COM+ application instance until an event occurs.</span></span><br/>                                                                    | <span data-ttu-id="ec841-122">Les données de suivi de toutes les instances d’application COM+ peuvent être récupérées à tout moment.</span><span class="sxs-lookup"><span data-stu-id="ec841-122">Tracking data for all COM+ application instances may be retrieved at any time.</span></span><br/>                                                                         |
| <span data-ttu-id="ec841-123">Prend uniquement en charge un mécanisme d’abonnement basé sur les événements COM+ pour les consommateurs.</span><span class="sxs-lookup"><span data-stu-id="ec841-123">Supports only a COM+ events-based subscription mechanism for consumers.</span></span><br/>                                                                                                                                     | <span data-ttu-id="ec841-124">Prend en charge à la fois un mécanisme d’abonnement basé sur les événements COM+ et l’interrogation d’une interface de serveur local COM.</span><span class="sxs-lookup"><span data-stu-id="ec841-124">Supports both a COM+ events-based subscription mechanism and polling on a COM local server interface.</span></span><br/>                                                  |
| <span data-ttu-id="ec841-125">Exemples</span><span class="sxs-lookup"><span data-stu-id="ec841-125">Examples</span></span>                                                                                                                                                                                                               |                                                                                                                                                                   |
| <span data-ttu-id="ec841-126">Notifications lorsqu’une méthode est appelée ou est retournée.</span><span class="sxs-lookup"><span data-stu-id="ec841-126">Notifications when a method is called or returns.</span></span><br/>                                                                                                                                                           | <span data-ttu-id="ec841-127">Temps de réponse moyen des appels, nombre d’appels de méthode ayant réussi ou échoué au cours d’une période récente, nombre d’objets actuellement dans un appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="ec841-127">Average call response time, number of method calls that succeeded or failed in a recent time period, number of objects currently in a method call.</span></span><br/>     |
| <span data-ttu-id="ec841-128">Notifications lorsqu’un objet est ajouté ou obtenu à partir du pool d’objets.</span><span class="sxs-lookup"><span data-stu-id="ec841-128">Notifications when an object is added to or obtained from the object pool.</span></span><br/>                                                                                                                                  | <span data-ttu-id="ec841-129">Nombre d’objets dans le pool, nombre total d’objets.</span><span class="sxs-lookup"><span data-stu-id="ec841-129">Number of objects in the pool, total number of objects.</span></span><br/>                                                                                                |
| <span data-ttu-id="ec841-130">Notifications lors du démarrage, de la suspension ou du recyclage d’une application serveur COM+.</span><span class="sxs-lookup"><span data-stu-id="ec841-130">Notifications when a COM+ server application is started, paused, or recycled.</span></span><br/>                                                                                                                               | <span data-ttu-id="ec841-131">État du processus de l’application serveur COM+ (par exemple, s’il est suspendu ou recyclé).</span><span class="sxs-lookup"><span data-stu-id="ec841-131">Status of the COM+ server application process (for example, whether it is paused or recycled).</span></span><br/>                                                         |
| <span data-ttu-id="ec841-132">Notifications des événements de début, de préparation, d’abandon et de validation de la transaction.</span><span class="sxs-lookup"><span data-stu-id="ec841-132">Notifications of transaction start, prepare, abort, and commit events.</span></span><br/>                                                                                                                                      | <span data-ttu-id="ec841-133">Aucun équivalent.</span><span class="sxs-lookup"><span data-stu-id="ec841-133">No equivalent.</span></span><br/>                                                                                                                                         |
| <span data-ttu-id="ec841-134">Notifications de tentatives d’authentification de la méthode réussie et ayant échoué.</span><span class="sxs-lookup"><span data-stu-id="ec841-134">Notifications of successful and failed method call level authentication attempts.</span></span><br/>                                                                                                                           | <span data-ttu-id="ec841-135">Aucun équivalent.</span><span class="sxs-lookup"><span data-stu-id="ec841-135">No equivalent.</span></span><br/>                                                                                                                                         |



 

<span data-ttu-id="ec841-136">Bien que le suivi COM+ soit plus limité en termes d’étendue des données et de flexibilité pour le calcul des mesures, les mesures qu’il fournit doivent être suffisantes pour un large éventail de programmes d’administration et de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="ec841-136">Although COM+ tracking is more limited in terms of data scope and flexibility for calculating metrics, the metrics it provides should be sufficient for a wide variety of administrative and diagnostic programs.</span></span> <span data-ttu-id="ec841-137">Dans la mesure du possible, le suivi COM+ peut simplifier la conception de ces programmes.</span><span class="sxs-lookup"><span data-stu-id="ec841-137">Using COM+ tracking, when possible, can simplify the design of these programs.</span></span> <span data-ttu-id="ec841-138">En outre, l’utilisation du suivi COM+ dans les systèmes de production peut avoir un impact nettement inférieur sur les performances, ce qui le rend plus approprié pour les outils de surveillance en temps réel.</span><span class="sxs-lookup"><span data-stu-id="ec841-138">Additionally, using COM+ tracking in production systems can have a significantly lower performance impact, making it more appropriate for real-time monitoring tools.</span></span>

## <a name="how-com-tracking-collects-data"></a><span data-ttu-id="ec841-139">Comment le suivi COM+ collecte des données</span><span class="sxs-lookup"><span data-stu-id="ec841-139">How COM+ Tracking Collects Data</span></span>

<span data-ttu-id="ec841-140">Lors du démarrage d’un processus d’application serveur COM+, COM+ enregistre le processus auprès du *serveur de suivi*, un composant de l’application système.</span><span class="sxs-lookup"><span data-stu-id="ec841-140">When a COM+ server application process is started, COM+ registers the process with the *tracker server*, a component of the system application.</span></span> <span data-ttu-id="ec841-141">Les composants des applications et des services de la bibliothèque COM+ sans les contextes de composants (SWC) prennent également en charge le suivi.</span><span class="sxs-lookup"><span data-stu-id="ec841-141">Components in COM+ library applications and services without components (SWC) contexts also support tracking.</span></span> <span data-ttu-id="ec841-142">Lorsqu’un composant de bibliothèque ou un contexte SWC est créé dans un processus, COM+ inscrit le processus auprès du serveur de suivi s’il n’a pas déjà été inscrit.</span><span class="sxs-lookup"><span data-stu-id="ec841-142">When a library component or SWC context is created in a process, COM+ registers the process with the tracker server if it has not been registered already.</span></span>

<span data-ttu-id="ec841-143">COM+ met à jour les statistiques d’un processus suivi lorsque certains événements se produisent dans le processus, tels que la création d’un objet ou l’achèvement d’un appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="ec841-143">COM+ updates statistics for a tracked process when certain events occur in the process, such as the creation of an object or the completion of a method call.</span></span> <span data-ttu-id="ec841-144">Les données mises à jour sont régulièrement envoyées au serveur de suivi, auquel cas elles deviennent disponibles pour les consommateurs.</span><span class="sxs-lookup"><span data-stu-id="ec841-144">Updated data is periodically submitted to the tracker server, at which point it becomes available to consumers.</span></span> <span data-ttu-id="ec841-145">Le serveur de suivi est également chargé de calculer certaines des métriques utilisées par les fonctionnalités de surveillance du recyclage et des blocages des applications COM+.</span><span class="sxs-lookup"><span data-stu-id="ec841-145">The tracker server is also responsible for calculating some of the metrics used by the COM+ application recycling and hang monitoring features.</span></span> <span data-ttu-id="ec841-146">Ces données sont également disponibles pour les consommateurs.</span><span class="sxs-lookup"><span data-stu-id="ec841-146">This data is also available to consumers.</span></span>

<span data-ttu-id="ec841-147">Les données de suivi sont organisées en fonction du processus qui a généré les données.</span><span class="sxs-lookup"><span data-stu-id="ec841-147">Tracking data is organized according to the process that generated the data.</span></span> <span data-ttu-id="ec841-148">Les données au niveau des applications ou des composants COM+ individuels dans le processus sont également disponibles pour les consommateurs qui ont besoin de ces informations.</span><span class="sxs-lookup"><span data-stu-id="ec841-148">Data at the level of individual COM+ applications or components in the process is also available for consumers that need this information.</span></span>

## <a name="events-versus-polling"></a><span data-ttu-id="ec841-149">Événements et interrogation</span><span class="sxs-lookup"><span data-stu-id="ec841-149">Events versus Polling</span></span>

<span data-ttu-id="ec841-150">Le suivi COM+ prend en charge deux mécanismes permettant à un consommateur d’obtenir des données de suivi à partir du serveur Tracker, d’un mécanisme d’abonnement basé sur les événements COM+ et d’une interface de serveur local COM.</span><span class="sxs-lookup"><span data-stu-id="ec841-150">COM+ tracking supports two mechanisms for a consumer to obtain tracking data from the tracker server, a COM+ events-based subscription mechanism and a COM local server interface.</span></span>

<span data-ttu-id="ec841-151">Les programmes qui doivent être régulièrement avertis avec des données de suivi mises à jour peuvent inscrire un abonnement pour l’interface d’événement [**IComTrackingInfoEvents**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfoevents) .</span><span class="sxs-lookup"><span data-stu-id="ec841-151">Programs that need to be notified periodically with updated tracking data can register a subscription for the [**IComTrackingInfoEvents**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfoevents) event interface.</span></span> <span data-ttu-id="ec841-152">Environ toutes les trois secondes, le serveur de suivi appelle la méthode [**IComTrackingInfoEvents :: OnNewTrackingInfo**](/windows/desktop/api/ComSvcs/nf-comsvcs-icomtrackinginfoevents-onnewtrackinginfo) de chaque abonné, en envoyant les données de suivi les plus récentes sous la forme d’un objet de collection.</span><span class="sxs-lookup"><span data-stu-id="ec841-152">Roughly every three seconds, the tracker server calls each subscriber's [**IComTrackingInfoEvents::OnNewTrackingInfo**](/windows/desktop/api/ComSvcs/nf-comsvcs-icomtrackinginfoevents-onnewtrackinginfo) method, sending the most recent tracking data in the form of a collection object.</span></span> <span data-ttu-id="ec841-153">Cet objet implémente l’interface [**IComTrackingInfoCollection**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfocollection) , et les abonnés peuvent parcourir cette collection pour trouver les données qui les intéressent.</span><span class="sxs-lookup"><span data-stu-id="ec841-153">This object implements the [**IComTrackingInfoCollection**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfocollection) interface, and subscribers can navigate this collection to find the data they are interested in.</span></span>

<span data-ttu-id="ec841-154">Pour diverses raisons, il peut être plus judicieux pour un programme d’interroger le serveur de suivi des données.</span><span class="sxs-lookup"><span data-stu-id="ec841-154">For various reasons, it might make more sense for a program to poll tracker server for data.</span></span> <span data-ttu-id="ec841-155">Par exemple, un outil de surveillance peut nécessiter des mises à jour nettement moins fréquentes qu’un programme qui affiche l’État dans une interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ec841-155">For example, a monitoring tool may need updates much less frequently than a program that displays status in a user interface.</span></span> <span data-ttu-id="ec841-156">En outre, un programme ne peut utiliser qu’une petite partie des données de suivi disponibles pour le système (par exemple, un outil peut uniquement surveiller les performances des instances d’une seule application COM+).</span><span class="sxs-lookup"><span data-stu-id="ec841-156">Also, a program may use only a small portion of the tracking data available for the system (for example, a tool might only monitor the performance of instances of a single COM+ application).</span></span> <span data-ttu-id="ec841-157">Le modèle d’abonnement envoie à chaque abonné les données de suivi de toutes les applications COM+ dans chaque notification, et il est de la responsabilité de l’abonné de rechercher les données dont il a besoin.</span><span class="sxs-lookup"><span data-stu-id="ec841-157">The subscription model sends each subscriber the tracking data for all COM+ applications in each notification, and it is the responsibility of the subscriber to find the data it wants.</span></span> <span data-ttu-id="ec841-158">Enfin, les événements COM+ constituent un mécanisme de notification d’événements le mieux adapté.</span><span class="sxs-lookup"><span data-stu-id="ec841-158">Finally, COM+ events is a best-effort event notification mechanism.</span></span> <span data-ttu-id="ec841-159">Les services de remise de messages fiables ne sont pas fournis, et il n’existe aucun moyen pour un abonné de détecter que le serveur de suivi n’a pas réussi à lui envoyer une notification.</span><span class="sxs-lookup"><span data-stu-id="ec841-159">Reliable message delivery services are not provided, and there is no way for a subscriber to detect that the tracker server failed to send it a notification.</span></span>

<span data-ttu-id="ec841-160">Un programme qui a besoin d’un contrôle accru sur sa récupération des données de suivi peut utiliser l’interface [**IGetAppTrackerData**](/windows/desktop/api/ComSvcs/nn-comsvcs-igetapptrackerdata) du serveur tracker.</span><span class="sxs-lookup"><span data-stu-id="ec841-160">A program that needs greater control over its retrieval of tracking data can use the [**IGetAppTrackerData**](/windows/desktop/api/ComSvcs/nn-comsvcs-igetapptrackerdata) interface of the tracker server.</span></span>

 

 




