---
description: Pour les composants configurés qui s’exécutent dans les applications COM+, les contextes constituent la base sur laquelle les services COM+ sont fournis.
ms.assetid: 62a0bef2-c3c2-4a60-a5d1-6c038958e13e
title: Contextes COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f0ae1228f89797f9124e817db07f11a23dbec12
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393180"
---
# <a name="com-contexts"></a><span data-ttu-id="64fc1-103">Contextes COM+</span><span class="sxs-lookup"><span data-stu-id="64fc1-103">COM+ Contexts</span></span>

<span data-ttu-id="64fc1-104">Pour les composants configurés qui s’exécutent dans les applications COM+, les *contextes* constituent la base sur laquelle les services com+ sont fournis.</span><span class="sxs-lookup"><span data-stu-id="64fc1-104">For configured components running within COM+ applications, *contexts* are the foundation on which COM+ services are provided.</span></span> <span data-ttu-id="64fc1-105">Dans COM+, un contexte est défini comme un ensemble de propriétés au moment de l’exécution associées à un ou plusieurs objets COM utilisés pour fournir des services pour ces objets.</span><span class="sxs-lookup"><span data-stu-id="64fc1-105">In COM+, a context is defined as set of run-time properties associated with one or more COM objects that are used to provide services for those objects.</span></span>

<span data-ttu-id="64fc1-106">Dans COM+, chaque objet COM est associé à un contexte exactement à mesure qu’il s’exécute (c’est-à-dire entre son activation et sa désactivation), et chaque contexte réside dans précisément un cloisonnement COM.</span><span class="sxs-lookup"><span data-stu-id="64fc1-106">In COM+, every COM object is associated with precisely one context as it runs (that is, between its activation and deactivation), and every context resides within precisely one COM apartment.</span></span> <span data-ttu-id="64fc1-107">Plusieurs objets peuvent s’exécuter dans le même contexte, et plusieurs contextes peuvent résider dans le même cloisonnement.</span><span class="sxs-lookup"><span data-stu-id="64fc1-107">Multiple objects can run within the same context, and multiple contexts can reside within the same apartment.</span></span> <span data-ttu-id="64fc1-108">Initialisé lorsqu’un objet est activé, les propriétés de contexte, telles que les propriétés de contexte de sécurité, représentent les besoins d’un objet au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="64fc1-108">Initialized when an object is activated, context properties, such as security context properties, represent the run-time needs of an object.</span></span>

> [!Note]  
> <span data-ttu-id="64fc1-109">Pour les composants non configurés qui n’utilisent pas les services COM+, le contexte est, pour l’essentiel, ignoré.</span><span class="sxs-lookup"><span data-stu-id="64fc1-109">For unconfigured components that do not use COM+ services, the context is, for the most part, ignored.</span></span>

 

<span data-ttu-id="64fc1-110">COM+ utilise des propriétés de contexte comme base pour fournir des services au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="64fc1-110">COM+ uses context properties as the basis for providing run-time services.</span></span> <span data-ttu-id="64fc1-111">Ces propriétés contiennent l’État qui détermine la façon dont l’environnement d’exécution exécute des services pour les objets dans le contexte.</span><span class="sxs-lookup"><span data-stu-id="64fc1-111">These properties hold state that determines how the execution environment performs services for objects within the context.</span></span> <span data-ttu-id="64fc1-112">Dans certains cas, vous pouvez interagir directement avec les propriétés de contexte d’un objet pour indiquer un État adapté à un service fourni pour l’objet.</span><span class="sxs-lookup"><span data-stu-id="64fc1-112">In some cases, you can interact directly with an object's context properties to indicate some state relevant to a service being provided for the object.</span></span> <span data-ttu-id="64fc1-113">Par exemple, vous pouvez le faire lorsqu’un objet qui participe à une transaction automatique vote sur le résultat de la transaction.</span><span class="sxs-lookup"><span data-stu-id="64fc1-113">For example, you would do this when an object that is participating in an automatic transaction votes on the outcome of the transaction.</span></span>

<span data-ttu-id="64fc1-114">Pour une présentation détaillée de la base COM de ces concepts, consultez [processus, threads et Apartments](/windows/desktop/com/processes--threads--and-apartments).</span><span class="sxs-lookup"><span data-stu-id="64fc1-114">For a detailed discussion of the COM foundation of these concepts, see [Processes, Threads, and Apartments](/windows/desktop/com/processes--threads--and-apartments).</span></span>

## <a name="programmatic-interaction-with-context-properties"></a><span data-ttu-id="64fc1-115">Interaction par programmation avec les propriétés de contexte</span><span class="sxs-lookup"><span data-stu-id="64fc1-115">Programmatic Interaction with Context Properties</span></span>

<span data-ttu-id="64fc1-116">Chaque contexte est associé à un objet [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) qui effectue le suivi de ses propriétés.</span><span class="sxs-lookup"><span data-stu-id="64fc1-116">Each context has an associated [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) object that keeps track of its properties.</span></span> <span data-ttu-id="64fc1-117">Vous pouvez accéder à **ObjectContext** en appelant la fonction [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) .</span><span class="sxs-lookup"><span data-stu-id="64fc1-117">You can access **ObjectContext** by calling the [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) function.</span></span> <span data-ttu-id="64fc1-118">Après avoir accédé à **ObjectContext**, vous pouvez appeler des méthodes sur l’interface [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) qu’il expose pour manipuler les propriétés de contexte.</span><span class="sxs-lookup"><span data-stu-id="64fc1-118">After you have accessed **ObjectContext**, you can call methods on the [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) interface it exposes to manipulate context properties.</span></span>

<span data-ttu-id="64fc1-119">Par exemple, l’appel de [**IObjectContext :: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) a pour effet de définir le bit de cohérence de la transaction sur « consistent » et le bit d' [activation JIT](com--just-in-time-activation.md) sur « done » dans le contexte associé à l’objet.</span><span class="sxs-lookup"><span data-stu-id="64fc1-119">For example, calling [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) has the effect of setting the transaction consistency bit to "consistent" and the [JIT-activation](com--just-in-time-activation.md) done bit to "done" on the context associated with the object.</span></span> <span data-ttu-id="64fc1-120">Des signaux « cohérents » vers COM+ que vous votez pour valider la transaction et « Done » indiquent que votre objet est prêt à être désactivé lorsque la méthode est retournée.</span><span class="sxs-lookup"><span data-stu-id="64fc1-120">"Consistent" signals to COM+ that you vote to commit the transaction, and "done" indicates that your object is ready to be deactivated when the method returns.</span></span>

<span data-ttu-id="64fc1-121">En plus de [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), d’autres interfaces spécialisées qui fournissent l’accès aux propriétés de contexte sont [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate)et [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span><span class="sxs-lookup"><span data-stu-id="64fc1-121">In addition to [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), other specialized interfaces providing access to context properties are [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate), and [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span></span> <span data-ttu-id="64fc1-122">Dans une certaine mesure, [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) accède également aux propriétés de contexte.</span><span class="sxs-lookup"><span data-stu-id="64fc1-122">To a certain extent, [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) also accesses context properties.</span></span> <span data-ttu-id="64fc1-123">Vous pouvez utiliser [**IGetSecurityCallContext :: GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) pour obtenir **ISecurityCallContext**.</span><span class="sxs-lookup"><span data-stu-id="64fc1-123">You can use [**IGetSecurityCallContext::GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) to obtain **ISecurityCallContext**.</span></span>

## <a name="understanding-activation-and-interception"></a><span data-ttu-id="64fc1-124">Compréhension de l’activation et de l’interception</span><span class="sxs-lookup"><span data-stu-id="64fc1-124">Understanding Activation and Interception</span></span>

<span data-ttu-id="64fc1-125">En règle générale, vous devez réfléchir au contexte uniquement dans la mesure où il représente un certain nombre de propriétés, que vous pouvez définir ou obtenir, qui sont utilisées pour fournir des services COM+ pour vos composants.</span><span class="sxs-lookup"><span data-stu-id="64fc1-125">Generally, you need to think about context only to the extent that it represents a number of properties, some of which you can set or get, that are used to provide COM+ services for your components.</span></span> <span data-ttu-id="64fc1-126">Dans certains cas, toutefois, vous devrez peut-être considérer les deux facettes de contextes suivantes de manière plus détaillée :</span><span class="sxs-lookup"><span data-stu-id="64fc1-126">In some circumstances, however, you might need to consider the following two interrelated facets of contexts in greater detail:</span></span>

-   <span data-ttu-id="64fc1-127">[Activation du contexte](context-activation.md)ou initialisation d’un objet dans un contexte approprié.</span><span class="sxs-lookup"><span data-stu-id="64fc1-127">[Context activation](context-activation.md), or the initialization of an object in an appropriate context.</span></span>
-   <span data-ttu-id="64fc1-128">L' [interception](interception-of-cross-context-calls.md)ou ce que com+ effectue sur les appels à travers une limite de contexte.</span><span class="sxs-lookup"><span data-stu-id="64fc1-128">[Interception](interception-of-cross-context-calls.md), or what COM+ does on calls across a context boundary.</span></span>

## <a name="relation-to-mts-context-wrappers"></a><span data-ttu-id="64fc1-129">Relation avec les wrappers de contexte MTS</span><span class="sxs-lookup"><span data-stu-id="64fc1-129">Relation to MTS Context Wrappers</span></span>

<span data-ttu-id="64fc1-130">Les contextes remplacent efficacement les wrappers de contexte MTS.</span><span class="sxs-lookup"><span data-stu-id="64fc1-130">Contexts effectively replace the MTS context wrappers.</span></span> <span data-ttu-id="64fc1-131">L’objectif qu’ils ont servi, à savoir fournir des services automatiques par le biais de demandes de création de recouvrement, est désormais une fonctionnalité intégrée de COM+.</span><span class="sxs-lookup"><span data-stu-id="64fc1-131">The purpose they served—providing automatic services by trapping creation requests—is now an integrated feature of COM+.</span></span> <span data-ttu-id="64fc1-132">Par conséquent, vous n’avez plus besoin d’utiliser la fonction [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) .</span><span class="sxs-lookup"><span data-stu-id="64fc1-132">As a result, you no longer need to use the [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) function.</span></span> <span data-ttu-id="64fc1-133">Dans MTS, **SafeRef** a été utilisé pour obtenir une référence à votre objet qui peut être passé en dehors de son Wrapper de contexte.</span><span class="sxs-lookup"><span data-stu-id="64fc1-133">In MTS, **SafeRef** was used to obtain a reference to your object which could be passed outside of its context wrapper.</span></span> <span data-ttu-id="64fc1-134">Dans COM+, cela est inutile. des références d’objet normales (**ce** pointeurs) fonctionnent.</span><span class="sxs-lookup"><span data-stu-id="64fc1-134">In COM+, this is unnecessary; normal object references (**this** pointers) work.</span></span>

 

 
