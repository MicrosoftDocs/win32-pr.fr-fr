---
description: Le service d’événements COM+ utilise un objet de classe d’événements pour gérer la connexion entre le serveur de publication et l’abonné.
ms.assetid: 877c5890-588d-4978-8fb2-b4ecf4134068
title: Objet de classe d’événements COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aae397f647354ac24395fa073365160829a687a2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103950600"
---
# <a name="the-com-event-class-object"></a><span data-ttu-id="ed359-103">Objet de classe d’événements COM+</span><span class="sxs-lookup"><span data-stu-id="ed359-103">The COM+ Event Class Object</span></span>

<span data-ttu-id="ed359-104">Le service d’événements COM+ utilise un *objet de classe d’événements* pour gérer la connexion entre le serveur de publication et l’abonné.</span><span class="sxs-lookup"><span data-stu-id="ed359-104">The COM+ Events service uses an *event class object* to manage the connection between publisher and subscriber.</span></span> <span data-ttu-id="ed359-105">L’objet de classe d’événements est un composant COM+ géré et stocké par le système d’événements COM+ et qui contient les interfaces et les méthodes utilisées par un serveur de publication pour déclencher des événements.</span><span class="sxs-lookup"><span data-stu-id="ed359-105">The event class object is a COM+ component that is managed and stored by the COM+ Events system and contains the interfaces and methods used by a publisher to fire events.</span></span> <span data-ttu-id="ed359-106">Il s’agit d’un objet persistant qui indique les événements qui peuvent se produire et, éventuellement, identifie le serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="ed359-106">It is a persistent object that indicates the events that can occur and, optionally, identifies the publisher.</span></span> <span data-ttu-id="ed359-107">Vous spécifiez les interfaces et les méthodes que vous souhaitez qu’une classe d’événements contienne en fournissant une bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="ed359-107">You specify the interfaces and methods you want an event class to contain by providing a type library.</span></span>

<span data-ttu-id="ed359-108">Pour déclencher un événement, le serveur de publication instancie l’objet de classe d’événements en appelant [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) ou la méthode Microsoft Visual Basic **CreateObject** et en demandant que l’interface d’événement soit retournée.</span><span class="sxs-lookup"><span data-stu-id="ed359-108">To fire an event, the publisher instantiates the event class object by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or the Microsoft Visual Basic **CreateObject** method and requesting the event interface be returned.</span></span> <span data-ttu-id="ed359-109">L’objet de classe d’événements instancié contient l’implémentation du système d’événements de l’interface demandée.</span><span class="sxs-lookup"><span data-stu-id="ed359-109">The instantiated event class object contains the event system's implementation of the requested interface.</span></span> <span data-ttu-id="ed359-110">Un abonné intéressé doit également implémenter l’interface de la classe d’événements pour recevoir les événements d’un serveur de publication donné.</span><span class="sxs-lookup"><span data-stu-id="ed359-110">An interested subscriber must also implement the event class interface to receive events from a given publisher.</span></span> <span data-ttu-id="ed359-111">Lorsque l’objet de classe d’événements est instancié, le système d’événements l’associe aux abonnés appropriés.</span><span class="sxs-lookup"><span data-stu-id="ed359-111">When the event class object is instantiated, the event system associates it with the appropriate subscribers.</span></span> <span data-ttu-id="ed359-112">La liste des abonnés est conservée pendant la durée de vie de l’objet de classe d’événements.</span><span class="sxs-lookup"><span data-stu-id="ed359-112">The list of subscribers is maintained for the lifetime of the event class object.</span></span> <span data-ttu-id="ed359-113">Un événement peut être remis à plusieurs abonnés en série ou en parallèle.</span><span class="sxs-lookup"><span data-stu-id="ed359-113">An event can be delivered to multiple subscribers either serially or in parallel.</span></span>

<span data-ttu-id="ed359-114">Lorsque vous implémentez un objet de classe d’événements, vous devez fournir une DLL à inscription automatique qui exporte les fonctions [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) et [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) .</span><span class="sxs-lookup"><span data-stu-id="ed359-114">When you implement an event class object, you should provide a self-registering DLL that exports the [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) and [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) functions.</span></span> <span data-ttu-id="ed359-115">La fonction **DllRegisterServer** inscrit une classe com et la fonction **DllUnregisterServer** annule l’inscription du composant.</span><span class="sxs-lookup"><span data-stu-id="ed359-115">The **DllRegisterServer** function registers a COM class, and the **DllUnregisterServer** function unregisters the component.</span></span> <span data-ttu-id="ed359-116">Les objets de la classe d’événements sont stockés dans le catalogue COM+, soit à l’aide de l’outil d’administration Services de composants, soit par programme à l’aide des méthodes des interfaces [**ICOMAdminCatalog :: InstallEventClass**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) ou [**ICOMAdminCatalog :: InstallMultipleEventClasses**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) .</span><span class="sxs-lookup"><span data-stu-id="ed359-116">Event class objects are stored in the COM+ catalog, either by using the Component Services administration tool or programmatically by using the methods of the [**ICOMAdminCatalog::InstallEventClass**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) or [**ICOMAdminCatalog::InstallMultipleEventClasses**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) interfaces.</span></span> <span data-ttu-id="ed359-117">Pour plus d’informations sur l’inscription des objets de classe d’événements, consultez [inscription d’une classe d’événements](registering-an-event-class.md).</span><span class="sxs-lookup"><span data-stu-id="ed359-117">For detailed information about registering event class objects, see [Registering an Event Class](registering-an-event-class.md).</span></span>

<span data-ttu-id="ed359-118">Étant donné que les objets de classe d’événements sont des composants configurés, d’autres attributs, tels que la mise en file d’attente, les transactions, la sécurité, etc., peuvent être configurés pour eux à l’aide de l’outil d’administration Services de composants ou des fonctions du SDK d’administration COM+.</span><span class="sxs-lookup"><span data-stu-id="ed359-118">Because event class objects are configured components, other attributes, such as queuing, transactions, security, and so on, can be configured for them by using either the Component Services administration tool or the COM+ Administrative SDK functions.</span></span>

> [!Note]  
> <span data-ttu-id="ed359-119">Le service d’événements COM+ utilise le marshaling de bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="ed359-119">The COM+ Events service uses type library marshaling.</span></span> <span data-ttu-id="ed359-120">Cela place des restrictions sur les interfaces de classes d’événements.</span><span class="sxs-lookup"><span data-stu-id="ed359-120">This places some restrictions on event class interfaces.</span></span> <span data-ttu-id="ed359-121">Par exemple, le marshaleur de bibliothèque de types ne prend pas en charge la taille des attributs MIDL et la [**longueur \_ est**](/windows/desktop/Midl/length-is). [**\_**](/windows/desktop/Midl/size-is)</span><span class="sxs-lookup"><span data-stu-id="ed359-121">For example, the type library marshaler does not support the MIDL attributes [**size\_is**](/windows/desktop/Midl/size-is) and [**length\_is**](/windows/desktop/Midl/length-is).</span></span>

 

<span data-ttu-id="ed359-122">Un objet de classe d’événements possède des attributs de publication qui déterminent la façon dont les événements sont publiés, ainsi que les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="ed359-122">An event class object possesses publication attributes that determine the way events are published, as well as the following properties:</span></span>

-   <span data-ttu-id="ed359-123">**EventCLSID**.</span><span class="sxs-lookup"><span data-stu-id="ed359-123">**EventCLSID**.</span></span> <span data-ttu-id="ed359-124">Identificateur unique qui spécifie le CLSID du composant.</span><span class="sxs-lookup"><span data-stu-id="ed359-124">A unique identifier that specifies the CLSID of the component.</span></span>
-   <span data-ttu-id="ed359-125">**Événements**.</span><span class="sxs-lookup"><span data-stu-id="ed359-125">**EventClassName**.</span></span> <span data-ttu-id="ed359-126">Identificateur unique qui spécifie le PROGID du composant.</span><span class="sxs-lookup"><span data-stu-id="ed359-126">A unique identifier that specifies the PROGID of the component.</span></span>
-   <span data-ttu-id="ed359-127">**TypeLibrary**.</span><span class="sxs-lookup"><span data-stu-id="ed359-127">**TypeLibrary**.</span></span> <span data-ttu-id="ed359-128">Fournit la liste des interfaces offertes par l’objet de classe d’événements.</span><span class="sxs-lookup"><span data-stu-id="ed359-128">Provides a list of interfaces offered by the event class object.</span></span> <span data-ttu-id="ed359-129">Il n’est pas nécessaire d’implémenter les interfaces de déclenchement spécifiées dans la bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="ed359-129">There is no need to implement the firing interfaces specified in the type library.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ed359-130">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="ed359-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ed359-131">Considérations sur la sécurité des événements COM+</span><span class="sxs-lookup"><span data-stu-id="ed359-131">COM+ Events Security Considerations</span></span>](com--events-security-considerations.md)
</dt> <dt>

[<span data-ttu-id="ed359-132">Filtrage des événements dans COM+</span><span class="sxs-lookup"><span data-stu-id="ed359-132">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="ed359-133">Publication et diffusion d’événements dans COM+</span><span class="sxs-lookup"><span data-stu-id="ed359-133">Publishing and Delivering Events in COM+</span></span>](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="ed359-134">Abonnements</span><span class="sxs-lookup"><span data-stu-id="ed359-134">Subscriptions</span></span>](subscriptions.md)
</dt> <dt>

[<span data-ttu-id="ed359-135">Utilisation d’événements COM+ avec des composants en file d’attente COM+</span><span class="sxs-lookup"><span data-stu-id="ed359-135">Using COM+ Events with COM+ Queued Components</span></span>](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 
