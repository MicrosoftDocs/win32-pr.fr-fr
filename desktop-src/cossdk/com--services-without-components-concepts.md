---
description: COM+ 1,5 introduit la possibilité d’utiliser des services COM+ sans composants.
ms.assetid: da93d164-234a-4d1e-b82c-f3f904bb8cb6
title: Concepts des services COM+ sans composants
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d692657d33143b9437a9c8134260a8c32431cb
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103861554"
---
# <a name="com-services-without-components-concepts"></a><span data-ttu-id="f098e-103">Concepts des services COM+ sans composants</span><span class="sxs-lookup"><span data-stu-id="f098e-103">COM+ Services Without Components Concepts</span></span>

<span data-ttu-id="f098e-104">COM+ 1,5 introduit la possibilité d’utiliser des services COM+ sans composants.</span><span class="sxs-lookup"><span data-stu-id="f098e-104">COM+ 1.5 introduces the ability to use COM+ services without components.</span></span> <span data-ttu-id="f098e-105">Cela réduit considérablement les coûts de performances lors de l’utilisation de services COM+ à partir d’un environnement qui n’utilise pas de composants, et il élimine également la complexité liée à l’utilisation de ces services.</span><span class="sxs-lookup"><span data-stu-id="f098e-105">This significantly reduces the performance costs when using COM+ services from an environment that doesn't use components, and it also eliminates the complexity of using these services.</span></span> <span data-ttu-id="f098e-106">Depuis IIS 6,0, IIS et ASP tirent parti de l’utilisation des services COM+ sans composants.</span><span class="sxs-lookup"><span data-stu-id="f098e-106">Beginning with IIS 6.0, IIS and ASP take advantage of using COM+ services without components.</span></span>

<span data-ttu-id="f098e-107">Les services COM+ ont été conçus à l’origine pour être utilisés avec les composants COM+.</span><span class="sxs-lookup"><span data-stu-id="f098e-107">COM+ services were originally designed to be used with COM+ components.</span></span> <span data-ttu-id="f098e-108">Toutefois, certains environnements de programmation ne sont pas basés sur des composants et nécessitent donc une surcharge importante pour l’utilisation des services COM+.</span><span class="sxs-lookup"><span data-stu-id="f098e-108">However, some programming environments are not component-based and therefore required substantial overhead to use COM+ services.</span></span> <span data-ttu-id="f098e-109">Par exemple, avant la publication de COM+ 1,5, IIS devait créer des objets shim uniquement pour pouvoir utiliser les services de transactions COM+ dans les pages ASP.</span><span class="sxs-lookup"><span data-stu-id="f098e-109">For example, before the release of COM+ 1.5, IIS had to create shim objects solely to be able to use COM+ transaction services in ASP pages.</span></span> <span data-ttu-id="f098e-110">Les coûts de performances résultant de la création de ces objets incluent le stockage des données de configuration dans la métabase IIS et la base de données d’inscription COM+ (RegDB), ainsi que la communication supplémentaire entre la métabase IIS et le RegDB COM+ requis pour gérer efficacement les données de configuration.</span><span class="sxs-lookup"><span data-stu-id="f098e-110">The performance costs that come from creating those objects include storing the configuration data in both the IIS metabase and the COM+ registration database (RegDB) as well as the extra communication between the IIS metabase and the COM+ RegDB that is needed to effectively manage the configuration data.</span></span>

<span data-ttu-id="f098e-111">Si IIS devait utiliser un deuxième service COM+, tel que la synchronisation, il devait créer un objet shim complètement différent pour ce faire.</span><span class="sxs-lookup"><span data-stu-id="f098e-111">If IIS needed to use a second COM+ service, such as synchronization, it had to create a completely different shim object to do so.</span></span> <span data-ttu-id="f098e-112">Pour utiliser à la fois les transactions COM+ et la synchronisation, un troisième type d’objet shim est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="f098e-112">To use both COM+ transactions and synchronization, a third type of shim object would be needed.</span></span> <span data-ttu-id="f098e-113">La complexité de cette approche s’adapte à O (N2), ce qui rend l’implémentation de nouveaux services extrêmement difficile.</span><span class="sxs-lookup"><span data-stu-id="f098e-113">The complexity of this approach scales as O(n2), making the implementation of new services extremely difficult.</span></span>

<span data-ttu-id="f098e-114">Avec l’introduction des services COM+ sans composants, les services nécessaires sont configurés via un objet instancié à partir de la classe.</span><span class="sxs-lookup"><span data-stu-id="f098e-114">With the introduction of COM+ services without components, the services that are needed are configured through an object instantiated from the class.</span></span> <span data-ttu-id="f098e-115">La classe [**CServiceConfig**](cserviceconfig.md) implémente les interfaces nécessaires pour configurer les différents services tout en offrant la flexibilité nécessaire pour prendre en charge plusieurs services en même temps et la possibilité de prendre en charge de nouveaux services à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="f098e-115">The [**CServiceConfig**](cserviceconfig.md) class implements the interfaces needed to configure the different services while providing the flexibility to support multiple services at the same time and the ability to support new services in the future.</span></span>

<span data-ttu-id="f098e-116">Les services configurés peuvent ensuite être utilisés par le biais de deux mécanismes différents : ils peuvent être utilisés par le biais de la fonction [**CoCreateActivity**](/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity) , qui applique les services à l’ensemble du travail soumis via l’activité créée par la fonction, et ils peuvent également être utilisés en incorporant le travail qui utilise les services entre les appels aux fonctions [**CoEnterServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain) et [**CoLeaveServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain) .</span><span class="sxs-lookup"><span data-stu-id="f098e-116">The configured services can then be used through two different mechanisms: They can be used through the [**CoCreateActivity**](/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity) function, which applies the services to all of the work submitted via the activity that is created by the function, and they can also be used by embedding the work that uses the services between calls to the [**CoEnterServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain) and [**CoLeaveServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain) functions.</span></span> <span data-ttu-id="f098e-117">Aucune de ces fonctions ne nécessite la création de nouveaux composants pour pouvoir utiliser les services COM+. seul l’objet [**CServiceConfig**](cserviceconfig.md) est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="f098e-117">None of these functions requires the creation of any new components to be able to use the COM+ services; only the [**CServiceConfig**](cserviceconfig.md) object is needed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f098e-118">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f098e-118">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f098e-119">Tâches des services COM+ sans composants</span><span class="sxs-lookup"><span data-stu-id="f098e-119">COM+ Services Without Components Tasks</span></span>](com--services-without-components-tasks.md)
</dt> </dl>

 

 



