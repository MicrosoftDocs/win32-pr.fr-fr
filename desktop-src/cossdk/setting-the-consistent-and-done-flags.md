---
description: Définition des indicateurs cohérents et terminés
ms.assetid: d9b6096d-f93c-4f8e-a4d9-ea8309b35f0f
title: Définition des indicateurs cohérents et terminés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fd45d457828a222ce7f4ccbdc0080001b0f0b55f
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104483024"
---
# <a name="setting-the-consistent-and-done-flags"></a><span data-ttu-id="e6706-103">Définition des indicateurs cohérents et terminés</span><span class="sxs-lookup"><span data-stu-id="e6706-103">Setting the Consistent and Done Flags</span></span>

<span data-ttu-id="e6706-104">Vous définissez les indicateurs consistent et Done en appelant des méthodes sur les interfaces [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) ou [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate) .</span><span class="sxs-lookup"><span data-stu-id="e6706-104">You set the consistent and done flags by invoking methods on either the [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) or the [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate) interfaces.</span></span> <span data-ttu-id="e6706-105">Les stratégies utilisées par ces deux interfaces diffèrent considérablement.</span><span class="sxs-lookup"><span data-stu-id="e6706-105">The strategies used by these two interfaces differ significantly.</span></span> <span data-ttu-id="e6706-106">**IObjectContext** possède quatre méthodes qui lient les indicateurs consistent et Done dans des combinaisons uniques, tandis que **IContextState** a deux méthodes qui vous permettent de définir chaque indicateur de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="e6706-106">**IObjectContext** has four methods that bind the consistent and done flags together in unique combinations, while **IContextState** has two methods that allow you to set each flag independently.</span></span> <span data-ttu-id="e6706-107">Les méthodes de **IObjectContext** sont également exposées par le biais de l’objet [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) .</span><span class="sxs-lookup"><span data-stu-id="e6706-107">The methods of **IObjectContext** are also exposed through the [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) object.</span></span>

<span data-ttu-id="e6706-108">Pour un contrôle indépendant de chaque indicateur, [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate) fournit une méthode pour définir l’indicateur consistent sur true ou false et une méthode pour définir l’indicateur Done sur true ou false.</span><span class="sxs-lookup"><span data-stu-id="e6706-108">For independent control of each flag, [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate) provides a method to set the consistent flag to True or False and a method to set the done flag to True or False.</span></span> <span data-ttu-id="e6706-109">Ces méthodes sont [**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) et [**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn), respectivement.</span><span class="sxs-lookup"><span data-stu-id="e6706-109">These methods are [**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) and [**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn), respectively.</span></span> <span data-ttu-id="e6706-110">L’interface **IContextState** comprend également des méthodes permettant de récupérer la valeur actuelle de chaque indicateur.</span><span class="sxs-lookup"><span data-stu-id="e6706-110">The **IContextState** interface also includes methods to retrieve the current value of each flag.</span></span>

<span data-ttu-id="e6706-111">Lorsque vous définissez la valeur de la méthode [**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) sur TXCOMMIT, com+ vérifie la présence d’une transaction.</span><span class="sxs-lookup"><span data-stu-id="e6706-111">When you set the [**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) method value to TxCommit, COM+ verifies the presence of a transaction.</span></span> <span data-ttu-id="e6706-112">Si COM+ ne détecte pas de transaction, il génère une erreur que vous pouvez capturer dans un fichier journal.</span><span class="sxs-lookup"><span data-stu-id="e6706-112">If COM+ does not detect a transaction, it generates an error that you can capture in a log file.</span></span> <span data-ttu-id="e6706-113">Par exemple, supposons que quelqu’un configure par inadvertance l’attribut de transaction de votre composant pour qu’il ne soit pas pris en charge, mais que vous pensiez qu’il doit être défini sur obligatoire.</span><span class="sxs-lookup"><span data-stu-id="e6706-113">For example, suppose someone inadvertently configures your component's transaction attribute to Not Supported but you expected it to be set to Required.</span></span> <span data-ttu-id="e6706-114">En définissant **SetMyTransactionVote** = TxCommit, vous pouvez identifier le conflit et prendre une mesure.</span><span class="sxs-lookup"><span data-stu-id="e6706-114">By setting **SetMyTransactionVote** = TxCommit, you can identify the conflict and take action.</span></span>

<span data-ttu-id="e6706-115">Le tableau suivant décrit les appels de méthode qui peuvent être utilisés pour définir les indicateurs cohérents et terminés.</span><span class="sxs-lookup"><span data-stu-id="e6706-115">The following table describes the method calls that can be used to set the consistent and done flags.</span></span>



| <span data-ttu-id="e6706-116">Indicateur de cohérence</span><span class="sxs-lookup"><span data-stu-id="e6706-116">Consistent flag</span></span>  | <span data-ttu-id="e6706-117">Indicateur Done</span><span class="sxs-lookup"><span data-stu-id="e6706-117">Done flag</span></span>        | <span data-ttu-id="e6706-118">Méthode IObjectContext</span><span class="sxs-lookup"><span data-stu-id="e6706-118">IObjectContext method</span></span>                                            | <span data-ttu-id="e6706-119">Méthodes IContextState</span><span class="sxs-lookup"><span data-stu-id="e6706-119">IContextState methods</span></span>                                                                                                                                                                                    |
|------------------|------------------|------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e6706-120">Vrai</span><span class="sxs-lookup"><span data-stu-id="e6706-120">True</span></span><br/>  | <span data-ttu-id="e6706-121">Faux</span><span class="sxs-lookup"><span data-stu-id="e6706-121">False</span></span><br/> | [<span data-ttu-id="e6706-122">**EnableCommit**</span><span class="sxs-lookup"><span data-stu-id="e6706-122">**EnableCommit**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-enablecommit)<br/>   | <span data-ttu-id="e6706-123">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxCommit</span><span class="sxs-lookup"><span data-stu-id="e6706-123">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxCommit</span></span> <br/> <span data-ttu-id="e6706-124">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = false</span><span class="sxs-lookup"><span data-stu-id="e6706-124">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = False</span></span><br/> |
| <span data-ttu-id="e6706-125">Faux</span><span class="sxs-lookup"><span data-stu-id="e6706-125">False</span></span><br/> | <span data-ttu-id="e6706-126">False</span><span class="sxs-lookup"><span data-stu-id="e6706-126">False</span></span><br/> | [<span data-ttu-id="e6706-127">**DisableCommit**</span><span class="sxs-lookup"><span data-stu-id="e6706-127">**DisableCommit**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-disablecommit)<br/> | <span data-ttu-id="e6706-128">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxAbort</span><span class="sxs-lookup"><span data-stu-id="e6706-128">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxAbort</span></span> <br/> <span data-ttu-id="e6706-129">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = false</span><span class="sxs-lookup"><span data-stu-id="e6706-129">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = False</span></span><br/>  |
| <span data-ttu-id="e6706-130">False</span><span class="sxs-lookup"><span data-stu-id="e6706-130">False</span></span><br/> | <span data-ttu-id="e6706-131">True</span><span class="sxs-lookup"><span data-stu-id="e6706-131">True</span></span><br/>  | [<span data-ttu-id="e6706-132">**SetAbort**</span><span class="sxs-lookup"><span data-stu-id="e6706-132">**SetAbort**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort)<br/>           | <span data-ttu-id="e6706-133">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxAbort</span><span class="sxs-lookup"><span data-stu-id="e6706-133">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxAbort</span></span> <br/> <span data-ttu-id="e6706-134">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = true</span><span class="sxs-lookup"><span data-stu-id="e6706-134">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = True</span></span><br/>   |
| <span data-ttu-id="e6706-135">True</span><span class="sxs-lookup"><span data-stu-id="e6706-135">True</span></span><br/>  | <span data-ttu-id="e6706-136">True</span><span class="sxs-lookup"><span data-stu-id="e6706-136">True</span></span><br/>  | [<span data-ttu-id="e6706-137">**SetComplete**</span><span class="sxs-lookup"><span data-stu-id="e6706-137">**SetComplete**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete)<br/>     | <span data-ttu-id="e6706-138">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxCommit</span><span class="sxs-lookup"><span data-stu-id="e6706-138">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxCommit</span></span> <br/><span data-ttu-id="e6706-139">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = true</span><span class="sxs-lookup"><span data-stu-id="e6706-139">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = True</span></span>              |



 

> [!Note]  
> <span data-ttu-id="e6706-140">La propriété Done automatique, définie au niveau de la méthode, peut affecter la définition des indicateurs cohérents et terminés.</span><span class="sxs-lookup"><span data-stu-id="e6706-140">The auto-done property, which is set at the method level, can affect how the consistent and done flags are set.</span></span> <span data-ttu-id="e6706-141">Pour plus d’informations sur la propriété effectuée automatiquement, consultez [activation de la saisie semi-automatique pour une méthode](enabling-auto-done-for-a-method.md) et [définition du bit terminé](setting-the-done-bit.md).</span><span class="sxs-lookup"><span data-stu-id="e6706-141">For more information regarding the auto-done property, see [Enabling Auto-Done for a Method](enabling-auto-done-for-a-method.md) and [Setting the Done Bit](setting-the-done-bit.md).</span></span>

 

 

 




