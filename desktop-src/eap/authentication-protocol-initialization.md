---
title: Initialisation du protocole d’authentification
description: La connexion sécurisée EAP est initialisée entre le client et le serveur de la même façon pour les clients RAS et sans fil (802.1 X).
ms.assetid: 1cd5bfc9-2ba3-477c-9bbb-73578a5623c2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 856bd173ef617fb272460f874fa1d2087322c8b4
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104381864"
---
# <a name="authentication-protocol-initialization"></a><span data-ttu-id="0dbd6-103">Initialisation du protocole d’authentification</span><span class="sxs-lookup"><span data-stu-id="0dbd6-103">Authentication Protocol Initialization</span></span>

<span data-ttu-id="0dbd6-104">La connexion sécurisée EAP est initialisée entre le client et le serveur de la même façon pour les clients RAS et sans fil (802.1 X).</span><span class="sxs-lookup"><span data-stu-id="0dbd6-104">The EAP secured connection is initialized between the client and server in similar ways for RAS and wireless (802.1X) clients.</span></span>

## <a name="client"></a><span data-ttu-id="0dbd6-105">Client</span><span class="sxs-lookup"><span data-stu-id="0dbd6-105">Client</span></span>

<span data-ttu-id="0dbd6-106">Lorsque le client tente d’établir la connexion, le service d’authentification obtient les [informations d’identité](obtaining-identity-information.md) de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-106">When the client attempts to establish the connection, the authentication service obtains [identity information](obtaining-identity-information.md) for the user.</span></span> <span data-ttu-id="0dbd6-107">Si la valeur NAMEDLG de l' **\_ \_ \_ appel \_ du valueName EAP RAS** est présente dans le registre pour ce protocole d’authentification et que cette valeur est définie à zéro, le service d’authentification appelle [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity).</span><span class="sxs-lookup"><span data-stu-id="0dbd6-107">If the **RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG** value is present in the registry for this authentication protocol and this value is set to zero, the authentication service calls [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity).</span></span> <span data-ttu-id="0dbd6-108">Cette fonction affiche généralement une interface utilisateur qui permet d’obtenir des informations d’identité d’un type spécifique au protocole d’authentification. par exemple, un certificat ou un ID numérique.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-108">This function typically displays a user interface that allows the identity information to be of a type specific to the authentication protocol; for example, a certificate or numeric ID.</span></span> <span data-ttu-id="0dbd6-109">Si le nom d' **appel d’accès distant \_ EAP \_ \_ \_ NAMEDLG** n’est pas présent ou est défini sur un, le service d’authentification affiche la boîte de dialogue nom d’utilisateur standard du système.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-109">If **RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG** is not present, or is set to one, the authentication service displays the standard system user-name dialog.</span></span>

<span data-ttu-id="0dbd6-110">Une fois que le service d’authentification a obtenu les informations d’identité de l’utilisateur, il appelle l’implémentation de [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85))par le protocole d’authentification.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-110">Once the authentication service has obtained the identity information for the user, it calls the authentication protocol's implementation of [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)).</span></span> <span data-ttu-id="0dbd6-111">Cet appel permet au protocole d’authentification d’allouer et d’initialiser une mémoire tampon de travail que le service transmet lors des appels suivants à [**RasEapMakeMessage**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85)) et [**RasEapEnd**](/previous-versions/windows/desktop/legacy/aa363521(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="0dbd6-111">This call allows the authentication protocol to allocate and initialize a work buffer that the service passes on subsequent calls to [**RasEapMakeMessage**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85)) and [**RasEapEnd**](/previous-versions/windows/desktop/legacy/aa363521(v=vs.85)).</span></span> <span data-ttu-id="0dbd6-112">La mémoire tampon de travail est opaque pour le service et n’accède jamais au contenu de la mémoire tampon de travail.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-112">The work buffer is opaque to the service and never accesses the contents of the work buffer.</span></span> <span data-ttu-id="0dbd6-113">Si le protocole d’authentification crée une mémoire tampon de travail distincte pour chaque session EAP, la mémoire tampon de travail est session et thread-safe.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-113">If the authentication protocol creates a distinct work buffer for each EAP session, then the work buffer is session and thread safe.</span></span> <span data-ttu-id="0dbd6-114">Étant donné que le protocole d’authentification alloue la mémoire pour la mémoire tampon de travail, le protocole d’authentification doit également libérer cette mémoire à l’aide de la fonction [**RasEapFreeMemory**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) .</span><span class="sxs-lookup"><span data-stu-id="0dbd6-114">Because the authentication protocol allocates the memory for the work buffer, the authentication protocol should also free this memory using the [**RasEapFreeMemory**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) function.</span></span>

<span data-ttu-id="0dbd6-115">Dans l’appel à [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)), le service passe également une [**structure \_ \_ d’entrée EAP PPP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) qui contient des pointeurs vers les informations de configuration de la connexion, ainsi que les informations d’identité de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-115">In the call to [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)), the service also passes a [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) structure that contains pointers to the configuration information for the connection, and the identity information for the user.</span></span> <span data-ttu-id="0dbd6-116">Le service transmet toujours une valeur au membre **pszIdentity** de l' **\_ \_ entrée EAP PPP**.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-116">The service always passes in a value for the **pszIdentity** member of **PPP\_EAP\_INPUT**.</span></span> <span data-ttu-id="0dbd6-117">Toutefois, le membre **pszPassword** de [**l' \_ \_ entrée PPP EAP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) peut avoir la **valeur null**.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-117">However, the **pszPassword** member of [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) may be **NULL**.</span></span>

<span data-ttu-id="0dbd6-118">Dans la [**structure \_ \_ d’entrée EAP PPP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) , le membre **fAuthenticator** indique si le protocole d’authentification est appelé pour être authentifié (sur le client) ou en tant qu’authentificateur (sur le serveur).</span><span class="sxs-lookup"><span data-stu-id="0dbd6-118">Within the [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) structure, the **fAuthenticator** member indicates whether the authentication protocol is being invoked to be authenticated (on the client) or as the authenticator (on the server).</span></span>

## <a name="server"></a><span data-ttu-id="0dbd6-119">Serveur</span><span class="sxs-lookup"><span data-stu-id="0dbd6-119">Server</span></span>

<span data-ttu-id="0dbd6-120">Sur le serveur, le membre **bInitialID** de [**l' \_ \_ entrée PPP EAP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) spécifie l’ID que le serveur utilise pour le premier paquet EAP.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-120">On the server, the **bInitialID** member of [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) specifies the ID that the server uses for the first EAP packet.</span></span> <span data-ttu-id="0dbd6-121">Le serveur incrémente cet ID pour les paquets suivants.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-121">The server increments this ID for subsequent packets.</span></span>

<span data-ttu-id="0dbd6-122">De même, sur le serveur, le pointeur **pUserAttributes** dans l' [**\_ \_ entrée EAP PPP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) pointe vers un tableau d’attributs du type d' [**\_ \_ attribut \_ d’authentification RAS**](/windows/win32/api/raseapif/ne-raseapif-ras_auth_attribute_type) .</span><span class="sxs-lookup"><span data-stu-id="0dbd6-122">Also on the server, the **pUserAttributes** pointer in [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) points to an array of attributes of the [**RAS\_AUTH\_ATTRIBUTE\_TYPE**](/windows/win32/api/raseapif/ne-raseapif-ras_auth_attribute_type) type.</span></span> <span data-ttu-id="0dbd6-123">Il s’agit des attributs de l’utilisateur qui ont été obtenus à partir du client.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-123">These are attributes for the user that were obtained from the client.</span></span>

<span data-ttu-id="0dbd6-124">Si l’appel [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)) retourne une valeur autre qu' **aucune \_ erreur**, la session est déconnectée.</span><span class="sxs-lookup"><span data-stu-id="0dbd6-124">If the [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)) call returns any value other than **NO\_ERROR**, the session is disconnected.</span></span> <span data-ttu-id="0dbd6-125">L’erreur renvoyée est enregistrée (sur le serveur) ou affichée à l’utilisateur (sur le client).</span><span class="sxs-lookup"><span data-stu-id="0dbd6-125">The returned error is logged (on the server), or displayed to the user (on the client).</span></span>

 

 