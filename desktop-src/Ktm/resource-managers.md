---
description: Gestionnaires de ressources
ms.assetid: c717b731-cf0b-45cb-bbff-695410fcf6ce
title: Gestionnaires de ressources
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b2ea9b1cd834daf3bfbca49bf37d3f2c0956344
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106527858"
---
# <a name="resource-managers"></a><span data-ttu-id="39c67-103">Gestionnaires de ressources</span><span class="sxs-lookup"><span data-stu-id="39c67-103">Resource Managers</span></span>

<span data-ttu-id="39c67-104">Un gestionnaire de ressources utilise le journal du gestionnaire de transactions pour suivre l’état de la transaction.</span><span class="sxs-lookup"><span data-stu-id="39c67-104">A resource manager uses the transaction manager log to track the transaction state.</span></span> <span data-ttu-id="39c67-105">L’action du gestionnaire de ressources lors du traitement d’une transaction est la suivante :</span><span class="sxs-lookup"><span data-stu-id="39c67-105">The resource manager's action when processing a transaction is as follows:</span></span>

-   <span data-ttu-id="39c67-106">Le client transmet explicitement une transaction au gestionnaire de transactions.</span><span class="sxs-lookup"><span data-stu-id="39c67-106">The client passes a transaction to the RM explicitly.</span></span>
-   <span data-ttu-id="39c67-107">Le gestionnaire de transactions inscrit dans la transaction à l’aide de [**CreateEnlistment**](/windows/desktop/api/KtmW32/nf-ktmw32-createenlistment).</span><span class="sxs-lookup"><span data-stu-id="39c67-107">The RM enlists in the transaction using [**CreateEnlistment**](/windows/desktop/api/KtmW32/nf-ktmw32-createenlistment).</span></span>
-   <span data-ttu-id="39c67-108">L’utilisateur peut ensuite procéder à toute opération.</span><span class="sxs-lookup"><span data-stu-id="39c67-108">The user can then proceed to perform any operation.</span></span>
-   <span data-ttu-id="39c67-109">Lorsque l’utilisateur appelle CommitTransaction, KTM envoie une \_ notification de préparation de transaction au gestionnaire de transactions.</span><span class="sxs-lookup"><span data-stu-id="39c67-109">When the user calls CommitTransaction, KTM sends a PREPARE\_TRANSACTION notification to the RM.</span></span> <span data-ttu-id="39c67-110">À ce stade, le gestionnaire de transactions vide sur le disque toutes les modifications nécessaires pour valider la transaction, mais peut échouer.</span><span class="sxs-lookup"><span data-stu-id="39c67-110">At this point, the RM flushes to disk any changes that would be necessary to commit the transaction, but could fail.</span></span> <span data-ttu-id="39c67-111">Si ces opérations réussissent, le RM signale qu’il a terminé l’opération de préparation en appelant [**PrepareComplete**](/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete).</span><span class="sxs-lookup"><span data-stu-id="39c67-111">If these operations succeed, the RM signals that it is finished with the prepare operation by calling [**PrepareComplete**](/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete).</span></span> <span data-ttu-id="39c67-112">Si ces opérations échouent, le gestionnaire de tâches répond en appelant [**RollBackEnlistment**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackenlistment).</span><span class="sxs-lookup"><span data-stu-id="39c67-112">If these operations fail, the RM responds by calling [**RollBackEnlistment**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackenlistment).</span></span>
-   <span data-ttu-id="39c67-113">Le gestionnaire des ressources reçoit une notification de préparation.</span><span class="sxs-lookup"><span data-stu-id="39c67-113">The resource manager receives a prepare notification.</span></span>
-   <span data-ttu-id="39c67-114">Le gestionnaire de ressources vide toutes les données associées à la transaction dans son fichier journal des services de journalisation commun.</span><span class="sxs-lookup"><span data-stu-id="39c67-114">The resource manager flushes any data associated with the transaction to its Common Log Services log file.</span></span>
-   <span data-ttu-id="39c67-115">Le gestionnaire des ressources appelle la fonction [**PrepareComplete**](/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete) et attend de recevoir le résultat de la transaction du KTM.</span><span class="sxs-lookup"><span data-stu-id="39c67-115">The resource manager calls the [**PrepareComplete**](/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete) function and awaits to receive the transaction's outcome from the KTM.</span></span>
-   <span data-ttu-id="39c67-116">Selon le résultat de la transaction, le gestionnaire des ressources reçoit un événement de notification de validation ou de restauration.</span><span class="sxs-lookup"><span data-stu-id="39c67-116">Depending on the outcome of the transaction, the resource manager receives a commit or rollback notification event.</span></span> <span data-ttu-id="39c67-117">Si le gestionnaire de ressources reçoit une notification de validation, il rend les modifications permanentes et informe le KTM en appelant la fonction [**CommitComplete**](/windows/desktop/api/Ktmw32/nf-ktmw32-commitcomplete) .</span><span class="sxs-lookup"><span data-stu-id="39c67-117">If the resource manager receives a commit notification, it makes the changes permanent and informs the KTM by calling the [**CommitComplete**](/windows/desktop/api/Ktmw32/nf-ktmw32-commitcomplete) function.</span></span> <span data-ttu-id="39c67-118">Si le gestionnaire de ressources reçoit une notification de restauration, il ignore toutes les modifications et revient à l’État qui existait avant l’une des modifications traitées et informe le KTM en appelant [**RollbackComplete**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackcomplete).</span><span class="sxs-lookup"><span data-stu-id="39c67-118">If the resource manager receives a rollback notification, it discards all changes and reverts to the state that existed before any of the transacted changes and informs the KTM by calling [**RollbackComplete**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackcomplete).</span></span>

## <a name="resource-manager-functions"></a><span data-ttu-id="39c67-119">Fonctions Gestionnaire des ressources</span><span class="sxs-lookup"><span data-stu-id="39c67-119">Resource Manager Functions</span></span>

<span data-ttu-id="39c67-120">Les fonctions suivantes sont utilisées avec les gestionnaires de ressources.</span><span class="sxs-lookup"><span data-stu-id="39c67-120">The following functions are used with resource managers.</span></span>



| <span data-ttu-id="39c67-121">Fonction</span><span class="sxs-lookup"><span data-stu-id="39c67-121">Function</span></span>                                                                           | <span data-ttu-id="39c67-122">Description</span><span class="sxs-lookup"><span data-stu-id="39c67-122">Description</span></span>                                                                                                                                                                      |
|------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="39c67-123">**CreateResourceManager,**</span><span class="sxs-lookup"><span data-stu-id="39c67-123">**CreateResourceManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-createresourcemanager)                             | <span data-ttu-id="39c67-124">Crée un nouvel objet Resource Manager (RM) et l’associe à un gestionnaire de transactions (TM).</span><span class="sxs-lookup"><span data-stu-id="39c67-124">Creates a new resource manager (RM) object, and associates the RM with a transaction manager (TM).</span></span>                                                                               |
| [<span data-ttu-id="39c67-125">**GetNotificationResourceManager**</span><span class="sxs-lookup"><span data-stu-id="39c67-125">**GetNotificationResourceManager**</span></span>](/windows/desktop/api/KtmW32/nf-ktmw32-getnotificationresourcemanager)           | <span data-ttu-id="39c67-126">Demande et reçoit une notification pour un gestionnaire de ressources (RM).</span><span class="sxs-lookup"><span data-stu-id="39c67-126">Requests and receives a notification for a resource manager (RM).</span></span> <span data-ttu-id="39c67-127">Cette fonction est utilisée par le registre RM pour recevoir des notifications lorsqu’une transaction change d’État.</span><span class="sxs-lookup"><span data-stu-id="39c67-127">This function is used by the RM register to receive notifications when a transaction changes state.</span></span>            |
| [<span data-ttu-id="39c67-128">**GetNotificationResourceManagerAsync**</span><span class="sxs-lookup"><span data-stu-id="39c67-128">**GetNotificationResourceManagerAsync**</span></span>](/windows/desktop/api/KtmW32/nf-ktmw32-getnotificationresourcemanagerasync) | <span data-ttu-id="39c67-129">Demande et reçoit une notification asynchrone pour un gestionnaire de ressources (RM).</span><span class="sxs-lookup"><span data-stu-id="39c67-129">Requests and receives asynchronous notification for a resource manager (RM).</span></span> <span data-ttu-id="39c67-130">Cette fonction est utilisée par le registre RM pour recevoir des notifications lorsqu’une transaction change d’État.</span><span class="sxs-lookup"><span data-stu-id="39c67-130">This function is used by the RM register to receive notifications when a transaction changes state.</span></span> |
| [<span data-ttu-id="39c67-131">**OpenResourceManager**</span><span class="sxs-lookup"><span data-stu-id="39c67-131">**OpenResourceManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-openresourcemanager)                                 | <span data-ttu-id="39c67-132">Ouvre un gestionnaire de ressources existant (RM).</span><span class="sxs-lookup"><span data-stu-id="39c67-132">Opens an existing resource manager (RM).</span></span>                                                                                                                                         |
| [<span data-ttu-id="39c67-133">**PrepareComplete**</span><span class="sxs-lookup"><span data-stu-id="39c67-133">**PrepareComplete**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete)                                         | <span data-ttu-id="39c67-134">Indique que le gestionnaire de ressources a terminé le traitement nécessaire pour garantir la réussite d’une opération de validation ou d’abandon pour la transaction spécifiée.</span><span class="sxs-lookup"><span data-stu-id="39c67-134">Indicates that the resource manager (RM) has completed all processing necessary to guarantee that a commit or abort operation will succeed for the specified transaction.</span></span>        |
| [<span data-ttu-id="39c67-135">**PrePrepareComplete**</span><span class="sxs-lookup"><span data-stu-id="39c67-135">**PrePrepareComplete**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-prepreparecomplete)                                   | <span data-ttu-id="39c67-136">Signale que ce gestionnaire de ressources a terminé son travail de prépréparation, afin que d’autres gestionnaires de ressources puissent maintenant commencer leurs opérations de préparation.</span><span class="sxs-lookup"><span data-stu-id="39c67-136">Signals that this resource manager has completed its preprepare work, so that other resource managers can now begin their prepare operations.</span></span>                                    |
| [<span data-ttu-id="39c67-137">**SetResourceManagerCompletionPort**</span><span class="sxs-lookup"><span data-stu-id="39c67-137">**SetResourceManagerCompletionPort**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-setresourcemanagercompletionport)       | <span data-ttu-id="39c67-138">Associe le port de terminaison d’e/s spécifié au gestionnaire de ressources spécifié (RM).</span><span class="sxs-lookup"><span data-stu-id="39c67-138">Associates the specified I/O completion port with the specified resource manager (RM).</span></span> <span data-ttu-id="39c67-139">Ce port reçoit toutes les notifications pour le gestionnaire de comptes.</span><span class="sxs-lookup"><span data-stu-id="39c67-139">This port receives all notifications for the RM.</span></span>                                          |



 

 

 



