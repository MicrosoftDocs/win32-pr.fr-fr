---
description: Un gestionnaire de transactions (TM) est une instance d’un journal. Dans KTM, les objets TM spécifient le journal et certaines fonctionnalités du gestionnaire de transactions. Il y a généralement de nombreux objets TM sur un nœud particulier. Les gestionnaires de ressources (RMs) doivent être associés à un gestionnaire de traduction spécifique.
ms.assetid: 8d43977a-84cf-4109-b7db-f9c94a226c5d
title: Gestionnaires de transactions
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 313215816642201c75ae5f0facae3bf98799c8d1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106529803"
---
# <a name="transaction-managers"></a><span data-ttu-id="cf4af-106">Gestionnaires de transactions</span><span class="sxs-lookup"><span data-stu-id="cf4af-106">Transaction Managers</span></span>

<span data-ttu-id="cf4af-107">Un gestionnaire de transactions (TM) est une instance d’un journal.</span><span class="sxs-lookup"><span data-stu-id="cf4af-107">A transaction manager (TM) is an instance of a log.</span></span> <span data-ttu-id="cf4af-108">Dans KTM, les objets TM spécifient le journal et certaines fonctionnalités du gestionnaire de transactions.</span><span class="sxs-lookup"><span data-stu-id="cf4af-108">In KTM, the TM objects specify the log and some of the functionality of the TM.</span></span> <span data-ttu-id="cf4af-109">Il y a généralement de nombreux objets TM sur un nœud particulier.</span><span class="sxs-lookup"><span data-stu-id="cf4af-109">There are typically many TM objects on a particular node.</span></span> <span data-ttu-id="cf4af-110">Les gestionnaires de ressources (RMs) doivent être associés à un gestionnaire de traduction spécifique.</span><span class="sxs-lookup"><span data-stu-id="cf4af-110">Resource managers (RMs) must be associated with a specific TM.</span></span> <span data-ttu-id="cf4af-111">Il existe trois types de TMs :</span><span class="sxs-lookup"><span data-stu-id="cf4af-111">There are three types of TMs:</span></span>

-   <span data-ttu-id="cf4af-112">Un TM volatile, qui n’a pas de journal.</span><span class="sxs-lookup"><span data-stu-id="cf4af-112">A volatile TM, which has no log.</span></span>
-   <span data-ttu-id="cf4af-113">TM standard, qui dispose d’un journal et permet de coordonner les transactions d’un ou de plusieurs services RMs.</span><span class="sxs-lookup"><span data-stu-id="cf4af-113">A regular TM, which has a log and is used to coordinate the transactions of one or more RMs.</span></span>
-   <span data-ttu-id="cf4af-114">Gestionnaire de transactions supérieur.</span><span class="sxs-lookup"><span data-stu-id="cf4af-114">A superior transaction manager.</span></span>

## <a name="volatile-transaction-managers"></a><span data-ttu-id="cf4af-115">Gestionnaires de transactions volatiles</span><span class="sxs-lookup"><span data-stu-id="cf4af-115">Volatile Transaction Managers</span></span>

<span data-ttu-id="cf4af-116">Un TM volatile est un TM pour les services RMs en lecture seule ou volatiles.</span><span class="sxs-lookup"><span data-stu-id="cf4af-116">A volatile TM is a TM for read-only or volatile RMs.</span></span> <span data-ttu-id="cf4af-117">Il n’a pas de journal et ne conserve pas l’état des transactions entre les redémarrages du système.</span><span class="sxs-lookup"><span data-stu-id="cf4af-117">It does not have a log and does not persist the state of transactions across system restarts.</span></span>

## <a name="transaction-managers"></a><span data-ttu-id="cf4af-118">Gestionnaires de transactions</span><span class="sxs-lookup"><span data-stu-id="cf4af-118">Transaction Managers</span></span>

<span data-ttu-id="cf4af-119">TMs ont un journal, un ou plusieurs services RMs durables ou volatiles, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="cf4af-119">TMs have a log, one or more durable or volatile RMs, or both.</span></span> <span data-ttu-id="cf4af-120">Le gestionnaire de transactions conserve l’état d’une transaction sur les redémarrages du système jusqu’à ce que les transactions soient terminées.</span><span class="sxs-lookup"><span data-stu-id="cf4af-120">The TM will persist the state of a transaction across system restarts until the transactions are completed.</span></span> <span data-ttu-id="cf4af-121">Un modèle présumé d’abandon est utilisé, donc les transactions qui étaient actives mais non préparées lorsque l’objet TM est arrêté sont restaurées.</span><span class="sxs-lookup"><span data-stu-id="cf4af-121">A presumed-abort model is used, so transactions which were active but not prepared when the TM object is shut down are rolled back.</span></span> <span data-ttu-id="cf4af-122">Lorsque vous ouvrez une TM pour la première fois, vous devez récupérer la TM en appelant la fonction [**RecoverTransactionManager**](/windows/desktop/api/Ktmw32/nf-ktmw32-recovertransactionmanager) .</span><span class="sxs-lookup"><span data-stu-id="cf4af-122">When you open a TM for the first time, you must recover the TM by calling the [**RecoverTransactionManager**](/windows/desktop/api/Ktmw32/nf-ktmw32-recovertransactionmanager) function.</span></span>

## <a name="superior-transaction-managers"></a><span data-ttu-id="cf4af-123">Gestionnaires de transactions supérieurs</span><span class="sxs-lookup"><span data-stu-id="cf4af-123">Superior Transaction Managers</span></span>

<span data-ttu-id="cf4af-124">Un gestionnaire de traduction supérieur est un gestionnaire de traduction pour d’autres TMs.</span><span class="sxs-lookup"><span data-stu-id="cf4af-124">A superior TM is a TM for other TMs.</span></span> <span data-ttu-id="cf4af-125">Il coordonne les transactions.</span><span class="sxs-lookup"><span data-stu-id="cf4af-125">It coordinates transactions.</span></span> <span data-ttu-id="cf4af-126">Il émet également des notifications de **\_ \_ préparation de la transaction Notify** au gestionnaire de transactions KTM (Kernel Transaction Manager).</span><span class="sxs-lookup"><span data-stu-id="cf4af-126">It also issues **TRANSACTION\_NOTIFY\_PREPARE** notifications to the Kernel Transaction Manager (KTM).</span></span> <span data-ttu-id="cf4af-127">Le Distributed Transaction Coordinator Microsoft (DTC) est un exemple de gestionnaire de transactions supérieur.</span><span class="sxs-lookup"><span data-stu-id="cf4af-127">An example of a superior TM is the Microsoft Distributed Transaction Coordinator (DTC).</span></span> <span data-ttu-id="cf4af-128">Cette capacité est accompagnée d’une responsabilité dans le temps de récupération.</span><span class="sxs-lookup"><span data-stu-id="cf4af-128">This ability comes with an added recovery-time responsibility.</span></span> <span data-ttu-id="cf4af-129">Pendant la récupération, le gestionnaire de comptes doit d’abord appeler la fonction [**OpenEnlistment**](/windows/desktop/api/Ktmw32/nf-ktmw32-openenlistment) pour rouvrir l’inscription.</span><span class="sxs-lookup"><span data-stu-id="cf4af-129">During recovery, the RM must first call the [**OpenEnlistment**](/windows/desktop/api/Ktmw32/nf-ktmw32-openenlistment) function to re-open the enlistment.</span></span> <span data-ttu-id="cf4af-130">Elle doit également fournir (ou remettre à nouveau) le résultat de la transaction si la transaction a été validée ; Il est libre de fournir un résultat en appelant la fonction [**CommitTransaction**](/windows/desktop/api/Ktmw32/nf-ktmw32-committransaction) ou la fonction [**RollbackTransaction**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbacktransaction) .</span><span class="sxs-lookup"><span data-stu-id="cf4af-130">It must also deliver (or re-deliver) the transaction's outcome if the transaction was committed; it is free to deliver an outcome by calling either the [**CommitTransaction**](/windows/desktop/api/Ktmw32/nf-ktmw32-committransaction) function or the [**RollbackTransaction**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbacktransaction) function.</span></span> <span data-ttu-id="cf4af-131">Cette obligation ne se termine pas tant qu’elle n’a pas reçu d’événement de notification de **validation de transaction \_ Notify \_ \_ complet** ou **transaction \_ Notify \_ \_ Complete** . Si un gestionnaire de transactions supérieur ne parvient pas à effectuer ces opérations au moment de la récupération, le KTM nettoie toutes les transactions qui n’ont pas reçu de résultats à la fin de la phase de récupération.</span><span class="sxs-lookup"><span data-stu-id="cf4af-131">This obligation does not end until it has received an associated **TRANSACTION\_NOTIFY\_COMMIT\_COMPLETE** or **TRANSACTION\_NOTIFY\_ROLLBACK\_COMPLETE** notification event.If a superior TM fails to perform these operations at recovery time, the KTM will clean up any transactions that have not received outcomes by the end of the recovery phase.</span></span> <span data-ttu-id="cf4af-132">Toutefois, cela peut entraîner des résultats incohérents de transaction.</span><span class="sxs-lookup"><span data-stu-id="cf4af-132">However, this can result in inconsistent transaction outcomes.</span></span>

## <a name="transaction-manager-functions"></a><span data-ttu-id="cf4af-133">Fonctions du gestionnaire de transactions</span><span class="sxs-lookup"><span data-stu-id="cf4af-133">Transaction Manager Functions</span></span>

<span data-ttu-id="cf4af-134">Les fonctions suivantes sont utilisées avec les gestionnaires de transactions.</span><span class="sxs-lookup"><span data-stu-id="cf4af-134">The following functions are used with transaction managers.</span></span>



| <span data-ttu-id="cf4af-135">Fonction</span><span class="sxs-lookup"><span data-stu-id="cf4af-135">Function</span></span>                                                                            | <span data-ttu-id="cf4af-136">Description</span><span class="sxs-lookup"><span data-stu-id="cf4af-136">Description</span></span>                                                                                    |
|-------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="cf4af-137">**CreateTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="cf4af-137">**CreateTransactionManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-createtransactionmanager)                        | <span data-ttu-id="cf4af-138">Crée un nouvel objet de gestionnaire de transactions (TM) et retourne un handle avec l’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="cf4af-138">Creates a new transaction manager (TM) object and returns a handle with the specified access.</span></span>  |
| [<span data-ttu-id="cf4af-139">**GetCurrentClockTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="cf4af-139">**GetCurrentClockTransactionManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-getcurrentclocktransactionmanager) | <span data-ttu-id="cf4af-140">Obtient une valeur d’horloge virtuelle à partir d’un gestionnaire de transactions.</span><span class="sxs-lookup"><span data-stu-id="cf4af-140">Obtains a virtual clock value from a transaction manager.</span></span>                                      |
| [<span data-ttu-id="cf4af-141">**GetTransactionManagerId**</span><span class="sxs-lookup"><span data-stu-id="cf4af-141">**GetTransactionManagerId**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-gettransactionmanagerid)                          | <span data-ttu-id="cf4af-142">Obtient un identificateur pour le gestionnaire de transactions spécifié.</span><span class="sxs-lookup"><span data-stu-id="cf4af-142">Obtains an identifier for the specified transaction manager.</span></span>                                   |
| [<span data-ttu-id="cf4af-143">**OpenTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="cf4af-143">**OpenTransactionManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-opentransactionmanager)                            | <span data-ttu-id="cf4af-144">Ouvre un gestionnaire de transactions existant.</span><span class="sxs-lookup"><span data-stu-id="cf4af-144">Opens an existing transaction manager.</span></span>                                                         |
| [<span data-ttu-id="cf4af-145">**RecoverTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="cf4af-145">**RecoverTransactionManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-recovertransactionmanager)                      | <span data-ttu-id="cf4af-146">Récupère l’état d’un gestionnaire de transactions à partir de son fichier journal.</span><span class="sxs-lookup"><span data-stu-id="cf4af-146">Recovers a transaction manager's state from its log file.</span></span>                                      |
| [<span data-ttu-id="cf4af-147">**RollforwardTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="cf4af-147">**RollforwardTransactionManager**</span></span>](/windows/desktop/api/KtmW32/nf-ktmw32-rollforwardtransactionmanager)              | <span data-ttu-id="cf4af-148">Récupère l’état d’un gestionnaire de transactions à partir de son fichier journal vers la valeur d’horloge virtuelle spécifiée.</span><span class="sxs-lookup"><span data-stu-id="cf4af-148">Recovers a transaction manager's state from its log file to the specified virtual clock value.</span></span> |



 

 

 



