---
description: Vous pouvez écrire une application qui peut réagir aux événements à tout moment.
ms.assetid: 475dca47-b1e5-4362-ab00-9ab9383e92f9
ms.tgt_platform: multiple
title: Réception d’événements à tout moment
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5559068e1e108c6f4185c31f8858a9e4169c50c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104318869"
---
# <a name="receiving-events-at-all-times"></a><span data-ttu-id="a9f4e-103">Réception d’événements à tout moment</span><span class="sxs-lookup"><span data-stu-id="a9f4e-103">Receiving Events at All Times</span></span>

<span data-ttu-id="a9f4e-104">Vous pouvez écrire une application qui peut réagir aux événements à tout moment.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-104">You may want to write an application that can react to events at any time.</span></span> <span data-ttu-id="a9f4e-105">Par exemple, un administrateur peut vouloir recevoir un message électronique lorsque des mesures de performances spécifiques baissent sur les serveurs réseau.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-105">For example, an administrator may want to receive an email message when specific performance measures decline on network servers.</span></span> <span data-ttu-id="a9f4e-106">Dans ce cas, votre application doit être exécutée à tout moment.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-106">In this case, your application should run at all times.</span></span> <span data-ttu-id="a9f4e-107">Toutefois, l’exécution d’une application en continu n’est pas une utilisation efficace des ressources système.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-107">However, running an application continuously is not an efficient use of system resources.</span></span> <span data-ttu-id="a9f4e-108">Au lieu de cela, WMI vous permet de créer un consommateur d’événements permanent.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-108">Instead, WMI allows you to create a permanent event consumer.</span></span> <span data-ttu-id="a9f4e-109">Les consommateurs d’événements permanents doivent répondre à des exigences de sécurité particulières.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-109">Permanent event consumers must meet special security requirements.</span></span> <span data-ttu-id="a9f4e-110">Pour plus d’informations, consultez [sécurisation des événements WMI](securing-wmi-events.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-110">For more information, see [Securing WMI Events](securing-wmi-events.md).</span></span>

<span data-ttu-id="a9f4e-111">Un consommateur d’événements permanent reçoit des événements jusqu’à ce que son inscription soit explicitement annulée.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-111">A permanent event consumer receives events until its registration is explicitly canceled.</span></span>

<span data-ttu-id="a9f4e-112">Un consommateur d’événements permanent est une combinaison des classes WMI, des filtres et des objets COM qui résident sur votre système :</span><span class="sxs-lookup"><span data-stu-id="a9f4e-112">A permanent event consumer is a combination of the following WMI classes, filters, and COM objects that reside on your system:</span></span>

-   <span data-ttu-id="a9f4e-113">Objet COM appelé consommateur physique.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-113">A COM object called a physical consumer.</span></span> <span data-ttu-id="a9f4e-114">WMI fournit plusieurs consommateurs permanents standard.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-114">WMI supplies several standard permanent consumers.</span></span> <span data-ttu-id="a9f4e-115">Par exemple, le consommateur d’événements active script [exécute un script lorsqu’un événement se produit](running-a-script-based-on-an-event.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-115">For example, the Active Script Event consumer [runs a script when an event occurs](running-a-script-based-on-an-event.md).</span></span>
-   <span data-ttu-id="a9f4e-116">Nouvelle classe de consommateur permanente.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-116">A new permanent consumer class.</span></span>
-   <span data-ttu-id="a9f4e-117">Une instance de la classe de consommateur permanente appelée consommateur logique.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-117">An instance of the permanent consumer class called a logical consumer.</span></span>
-   <span data-ttu-id="a9f4e-118">Filtre qui contient la requête pour les événements.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-118">A filter that contains the query for events.</span></span>
-   <span data-ttu-id="a9f4e-119">Liaison entre le consommateur et le filtre.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-119">A linkage between the consumer and the filter.</span></span>

<span data-ttu-id="a9f4e-120">Les propriétés d’un consommateur d’événements logiques spécifient les actions à effectuer lors de la notification d’un événement, mais ne définissent pas les requêtes d’événement auxquelles elles sont associées.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-120">The properties of a logical event consumer specify the actions to perform when notified of an event, but do not define the event queries with which they are associated.</span></span> <span data-ttu-id="a9f4e-121">Lorsqu’il est signalé, WMI charge automatiquement l’objet COM qui représente le consommateur d’événements permanent dans la mémoire active.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-121">When signaled, WMI automatically loads the COM object that represents the permanent event consumer into active memory.</span></span> <span data-ttu-id="a9f4e-122">En général, cela se produit au démarrage ou en réponse à un événement de déclenchement.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-122">Typically, this occurs during startup or in response to a triggering event.</span></span> <span data-ttu-id="a9f4e-123">Une fois activé, le consommateur d’événements permanent agit comme un consommateur d’événements normal, mais reste jusqu’à ce qu’il soit spécifiquement déchargé par le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-123">After being activated, the permanent event consumer acts as a normal event consumer, but remains until specifically unloaded by the operating system.</span></span>

<span data-ttu-id="a9f4e-124">Vous pouvez écrire votre propre consommateur d’événements permanent ou utiliser les [classes de consommateur standard](standard-consumer-classes.md)préinstallées WMI, telles que [**ActiveScriptEventConsumer**](activescripteventconsumer.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-124">You can write your own permanent event consumer or use the WMI preinstalled [Standard Consumer Classes](standard-consumer-classes.md), such as [**ActiveScriptEventConsumer**](activescripteventconsumer.md).</span></span> <span data-ttu-id="a9f4e-125">Pour plus d’informations, consultez [classes de consommateur standard](standard-consumer-classes.md), [surveillance et réponse aux événements avec des consommateurs standard](monitoring-and-responding-to-events-with-standard-consumers.md)et [surveillance des événements](monitoring-events.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-125">For more information, see [Standard Consumer Classes](standard-consumer-classes.md), [Monitoring and Responding to Events with Standard Consumers](monitoring-and-responding-to-events-with-standard-consumers.md), and [Monitoring Events](monitoring-events.md).</span></span>

<span data-ttu-id="a9f4e-126">La procédure suivante décrit comment créer votre propre consommateur d’événements permanent.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-126">The following procedure describes how to create your own permanent event consumer.</span></span>

<span data-ttu-id="a9f4e-127">**Pour créer votre propre consommateur d’événements permanent**</span><span class="sxs-lookup"><span data-stu-id="a9f4e-127">**To create your own permanent event consumer**</span></span>

1.  <span data-ttu-id="a9f4e-128">Déterminez le type d’événement que vous souhaitez recevoir.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-128">Determine what kind of events you want to receive.</span></span>

    <span data-ttu-id="a9f4e-129">WMI prend en charge les événements intrinsèques et extrinsèques.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-129">WMI supports intrinsic and extrinsic events.</span></span> <span data-ttu-id="a9f4e-130">Un événement intrinsèque est un événement prédéfini par WMI, alors qu’un événement extrinsèque est un événement défini par un fournisseur tiers.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-130">An intrinsic event is an event predefined by WMI, whereas an extrinsic event is an event defined by a third party provider.</span></span> <span data-ttu-id="a9f4e-131">Pour plus d’informations, consultez [détermination du type d’événement à recevoir](determining-the-type-of-event-to-receive.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-131">For more information, see [Determining the Type of Event to Receive](determining-the-type-of-event-to-receive.md).</span></span>

2.  <span data-ttu-id="a9f4e-132">[Implémentez un consommateur physique](implementing-a-physical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-132">[Implement a physical consumer](implementing-a-physical-consumer.md).</span></span>

    <span data-ttu-id="a9f4e-133">La principale différence entre une application de gestion et un [*consommateur physique*](gloss-p.md) est qu’un utilisateur charge et décharge une application de gestion, alors que WMI charge et décharge un consommateur physique.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-133">The main difference between a management application and a [*physical consumer*](gloss-p.md) is that a user loads and unloads a management application, whereas WMI loads and unloads a physical consumer.</span></span> <span data-ttu-id="a9f4e-134">La majeure partie de votre code doit être dans le consommateur physique.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-134">Most of your coding should be in the physical consumer.</span></span>

    > [!Note]  
    > <span data-ttu-id="a9f4e-135">Cette étape est tout d’abord décrite dans la procédure pour faciliter l’explication.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-135">This step is first in the procedure for ease of explanation.</span></span> <span data-ttu-id="a9f4e-136">En termes de codage, vous devez en fait créer le consommateur physique en dernier.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-136">In terms of coding, you should actually create the physical consumer last.</span></span> <span data-ttu-id="a9f4e-137">De cette façon, vous pouvez disposer vos paramètres et votre logique pour votre fournisseur d’événements permanent avant de commencer le codage long.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-137">That way you can lay out your parameters and logic for your permanent event provider before you start lengthy coding.</span></span> <span data-ttu-id="a9f4e-138">Toutefois, il n’existe aucune restriction pour l’écriture du consommateur physique en premier.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-138">However, there is no restriction against writing the physical consumer first.</span></span>

     

3.  <span data-ttu-id="a9f4e-139">[Créez une classe de consommateur décrivant le consommateur physique](creating-a-new-permanent-event-consumer-class.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-139">[Create a new consumer class describing the physical consumer](creating-a-new-permanent-event-consumer-class.md).</span></span>

    <span data-ttu-id="a9f4e-140">Comme n’importe quelle classe, la classe Consumer décrit les paramètres généraux d’un consommateur d’événements permanent à WMI.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-140">Like any class, the consumer class describes the general parameters of a permanent event consumer to WMI.</span></span>

4.  <span data-ttu-id="a9f4e-141">[Créez une instance de la classe de consommateur](creating-a-logical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-141">[Create an instance of the consumer class](creating-a-logical-consumer.md).</span></span>

    <span data-ttu-id="a9f4e-142">Comme toute autre classe WMI, vous devez créer une instance de la classe de consommateur si vous souhaitez implémenter la classe.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-142">Like any other WMI class, you must create an instance of the consumer class if you want to implement the class.</span></span> <span data-ttu-id="a9f4e-143">Une instance d’une classe de consommateur est également appelée [*consommateur logique*](gloss-l.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-143">An instance of a consumer class is also known as a [*logical consumer*](gloss-l.md).</span></span> <span data-ttu-id="a9f4e-144">Le consommateur logique représente le consommateur physique de WMI.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-144">The logical consumer represents the physical consumer to WMI.</span></span>

5.  <span data-ttu-id="a9f4e-145">[Créez un filtre d’événements](creating-an-event-filter.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-145">[Create an event filter](creating-an-event-filter.md).</span></span>

    <span data-ttu-id="a9f4e-146">Les requêtes d’événement qui activent les consommateurs d’événements permanents sont appelées [*filtres d’événements*](gloss-e.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-146">The event queries that activate permanent event consumers are called [*event filters*](gloss-e.md).</span></span> <span data-ttu-id="a9f4e-147">Un filtre d’événement unique peut être associé à plusieurs consommateurs d’événements logiques.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-147">A single event filter can be associated with multiple logical event consumers.</span></span> <span data-ttu-id="a9f4e-148">En outre, plusieurs filtres d’événements peuvent être associés à un seul consommateur d’événements logiques.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-148">Furthermore, multiple event filters can be associated with a single logical event consumer.</span></span> <span data-ttu-id="a9f4e-149">Le filtre est une instance de [**\_ \_ EventFilter**](--eventfilter.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-149">The filter is an instance of [**\_\_EventFilter**](--eventfilter.md).</span></span>

    <span data-ttu-id="a9f4e-150">Un événement de journal NT est généré en cas d’échec de la requête d’un consommateur d’événements permanent.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-150">An NT Log event is generated when a permanent event consumer's query fails.</span></span> <span data-ttu-id="a9f4e-151">La source de l’événement est WinMgmt, l’ID d’événement est 10 et le type d’événement est Error.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-151">The event's source is WinMgmt, the event ID is 10, and the event type is Error.</span></span>

6.  <span data-ttu-id="a9f4e-152">[Liez le filtre d’événement au consommateur logique](binding-an-event-filter-with-a-logical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-152">[Link the event filter to the logical consumer](binding-an-event-filter-with-a-logical-consumer.md).</span></span>

    <span data-ttu-id="a9f4e-153">En liant le filtre d’événement au consommateur logique, vous indiquez à WMI le filtre d’événement qui appartient à ce consommateur logique.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-153">By linking the event filter to the logical consumer, you instruct WMI about which event filter belongs to which logical consumer.</span></span> <span data-ttu-id="a9f4e-154">Les consommateurs d’événements logiques et les filtres d’événements sont liés par une instance de classe d’association de [**\_ \_ FilterToConsumerBinding**](--filtertoconsumerbinding.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-154">Logical event consumers and event filters are linked by an association class instance of [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md).</span></span> <span data-ttu-id="a9f4e-155">Lors de la réception d’un événement qui correspond à une requête d’événement décrite dans un filtre d’événements, WMI recherche le consommateur d’événements logiques associé en examinant l’instance de la classe d’association.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-155">When an event is received that matches an event query described in an event filter, WMI finds the associated logical event consumer by looking at the association class instance.</span></span> <span data-ttu-id="a9f4e-156">Une fois l’instance de consommateur d’événements logique localisée, WMI utilise une instance de la classe [**\_ \_ EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) pour rechercher et exécuter le consommateur d’événements physique associé à cette instance.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-156">After the logical event consumer instance is located, WMI uses an instance of the [**\_\_EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) class to locate and run the physical event consumer associated with this instance.</span></span>

7.  <span data-ttu-id="a9f4e-157">[Écriture d’un fournisseur de consommateur d’événements](writing-an-event-consumer-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a9f4e-157">[Writing an event consumer provider](writing-an-event-consumer-provider.md).</span></span>

    <span data-ttu-id="a9f4e-158">Le fournisseur de consommateur d’événements est un objet COM qui localise le consommateur physique pour WMI.</span><span class="sxs-lookup"><span data-stu-id="a9f4e-158">The event consumer provider is a COM object that locates the physical consumer for WMI.</span></span>

 

 



