---
description: Vous pouvez empêcher des utilisateurs non autorisés de recevoir des événements auxquels ils ne devraient pas avoir accès.
ms.assetid: 59788643-f57d-458f-91ab-26552218523b
ms.tgt_platform: multiple
title: Fournir des événements en toute sécurité
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d2c92ed1de08dde4891365440f559544a0b26de5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104209648"
---
# <a name="providing-events-securely"></a><span data-ttu-id="bcad4-103">Fournir des événements en toute sécurité</span><span class="sxs-lookup"><span data-stu-id="bcad4-103">Providing Events Securely</span></span>

<span data-ttu-id="bcad4-104">Vous pouvez empêcher des utilisateurs non autorisés de recevoir des événements auxquels ils ne devraient pas avoir accès.</span><span class="sxs-lookup"><span data-stu-id="bcad4-104">You can prevent unauthorized users from receiving events to which they should not have access.</span></span> <span data-ttu-id="bcad4-105">Votre fournisseur d’événements peut fournir des instances de ses propres classes d’événements, tout comme le [fournisseur de Registre système](/previous-versions/windows/desktop/regprov/system-registry-provider) fournit des classes telles que [**RegistryKeyChangeEvent**](/previous-versions/windows/desktop/regprov/registrykeychangeevent).</span><span class="sxs-lookup"><span data-stu-id="bcad4-105">Your event provider can supply instances of its own event classes, just as the [System Registry Provider](/previous-versions/windows/desktop/regprov/system-registry-provider) supplies classes such as [**RegistryKeyChangeEvent**](/previous-versions/windows/desktop/regprov/registrykeychangeevent).</span></span> <span data-ttu-id="bcad4-106">Votre fournisseur d’événements peut également fournir des événements intrinsèques tels que [**\_ \_ InstanceCreationEvent**](--instancecreationevent.md).</span><span class="sxs-lookup"><span data-stu-id="bcad4-106">Your event provider can also deliver intrinsic events such as [**\_\_InstanceCreationEvent**](--instancecreationevent.md).</span></span> <span data-ttu-id="bcad4-107">Pour plus d’informations, consultez [écriture d’un fournisseur d’événements](writing-an-event-provider.md).</span><span class="sxs-lookup"><span data-stu-id="bcad4-107">For more information, see [Writing an Event Provider](writing-an-event-provider.md).</span></span>

<span data-ttu-id="bcad4-108">Un fournisseur d’événements peut contrôler l’accès aux destinataires des événements des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="bcad4-108">An event provider can control access to event recipients in the following ways:</span></span>

-   <span data-ttu-id="bcad4-109">L’utilisation du contrôle d’accès en implémentant [**IWbemEventProviderSecurity :: AccessCheck**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovidersecurity) est le moyen le plus efficace.</span><span class="sxs-lookup"><span data-stu-id="bcad4-109">Using access control by implementing [**IWbemEventProviderSecurity::AccessCheck**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovidersecurity) is the most efficient way.</span></span>

    <span data-ttu-id="bcad4-110">Le fournisseur détermine si le consommateur dispose des privilèges nécessaires pour recevoir un événement demandé.</span><span class="sxs-lookup"><span data-stu-id="bcad4-110">The provider determines whether the consumer has privileges to receive a requested event.</span></span> <span data-ttu-id="bcad4-111">Si le consommateur ne dispose pas des privilèges suffisants pour s’inscrire, WMI renvoie une erreur d’accès refusé.</span><span class="sxs-lookup"><span data-stu-id="bcad4-111">If the consumer lacks sufficient privileges to register, WMI returns an access denied error.</span></span> <span data-ttu-id="bcad4-112">Utilisez ce mode lorsque le fournisseur peut décider qui peut recevoir des événements.</span><span class="sxs-lookup"><span data-stu-id="bcad4-112">Use this mode when the provider can make the decision about who can receive events.</span></span> <span data-ttu-id="bcad4-113">Par exemple, un fournisseur peut fournir des événements liés à la sécurité et peut exiger que le consommateur dispose de privilèges d’administrateur avec le privilège **SeSecurityPrivilege** activé.</span><span class="sxs-lookup"><span data-stu-id="bcad4-113">For example, a provider may supply security related events and can require that the consumer have administrator privileges with the **SeSecurityPrivilege** privilege enabled.</span></span>

-   <span data-ttu-id="bcad4-114">L’implémentation de [**IWbemEventSink :: SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) sur le récepteur utilisé pour déclencher des événements permet de définir un descripteur de sécurité (SD) sur un récepteur pour tous les événements passés.</span><span class="sxs-lookup"><span data-stu-id="bcad4-114">Implementing [**IWbemEventSink::SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) on the sink used to raise events allows the setting of a security descriptor (SD) on a sink for all the events passing through.</span></span>

    <span data-ttu-id="bcad4-115">WMI effectue des vérifications d’accès basées sur le SD.</span><span class="sxs-lookup"><span data-stu-id="bcad4-115">WMI performs access checks based on the SD.</span></span> <span data-ttu-id="bcad4-116">Utilisez ce mode lorsque le fournisseur ne peut pas prendre la décision concernant les personnes autorisées à utiliser ses événements, mais peut choisir un SD pour un récepteur spécifique.</span><span class="sxs-lookup"><span data-stu-id="bcad4-116">Use this mode when the provider cannot make the decision regarding who is allowed to consume its events, but can decide on an SD for a specific sink.</span></span> <span data-ttu-id="bcad4-117">Par exemple, utilisez [**IWbemEventSink :: SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) si votre fournisseur d’événements a obtenu plusieurs récepteurs par des appels à [**IWbemEventSink :: GetRestrictedSink**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-getrestrictedsink) et que vous souhaitez un descripteur de sécurité pour chaque récepteur.</span><span class="sxs-lookup"><span data-stu-id="bcad4-117">For example, use [**IWbemEventSink::SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) if your event provider obtained several sinks by calls to [**IWbemEventSink::GetRestrictedSink**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-getrestrictedsink) and you want a security descriptor for each sink.</span></span>

-   <span data-ttu-id="bcad4-118">La définition de la propriété **\_ descripteur de sécurité** d’un événement permet de définir un SD pour chaque événement.</span><span class="sxs-lookup"><span data-stu-id="bcad4-118">Setting the **SECURITY\_DESCRIPTOR** property of an event allows for the setting of an SD for each event.</span></span>

    <span data-ttu-id="bcad4-119">Utilisez cette approche lorsque chaque événement remis au récepteur peut avoir des descripteurs de sécurité différents.</span><span class="sxs-lookup"><span data-stu-id="bcad4-119">Use this approach when each event delivered to the sink can have different security descriptors.</span></span> <span data-ttu-id="bcad4-120">Pour utiliser cette approche, dérivez les classes d’événements extrinsèques définies par votre fournisseur de [**\_ \_ Event**](--event.md) ou [**\_ \_ ExtrinsicEvent**](--extrinsicevent.md) afin que votre classe contienne la propriété **\_ descripteur de sécurité** .</span><span class="sxs-lookup"><span data-stu-id="bcad4-120">To use this approach, derive any of the extrinsic event classes defined by your provider from [**\_\_Event**](--event.md) or [**\_\_ExtrinsicEvent**](--extrinsicevent.md) so that your class contains the **SECURITY\_DESCRIPTOR** property.</span></span> <span data-ttu-id="bcad4-121">Par exemple, votre fournisseur d’événements peut publier des événements sécurisés et normaux via un récepteur.</span><span class="sxs-lookup"><span data-stu-id="bcad4-121">For example, your event provider may publish both secure and normal events through a sink.</span></span> <span data-ttu-id="bcad4-122">Dans ce cas, utilisez le descripteur de sécurité de compte administrateurs pour les événements sécurisés et un descripteur de sécurité **null** pour les événements normaux qui peuvent être reçus par n’importe qui.</span><span class="sxs-lookup"><span data-stu-id="bcad4-122">In this case, use the Administrators account security descriptor for secure events and a **NULL** security descriptor for normal events that can be received by anyone.</span></span>

## <a name="securing-events-by-decoupled-event-providers"></a><span data-ttu-id="bcad4-123">Sécurisation des événements par des fournisseurs d’événements découplé</span><span class="sxs-lookup"><span data-stu-id="bcad4-123">Securing Events by Decoupled Event Providers</span></span>

<span data-ttu-id="bcad4-124">Les fournisseurs d’événements découplés diffèrent des fournisseurs d’événements nondecoupled de la façon dont ils s’inscrivent auprès de WMI.</span><span class="sxs-lookup"><span data-stu-id="bcad4-124">Decoupled event providers differ from nondecoupled event providers in the way that they register with WMI.</span></span> <span data-ttu-id="bcad4-125">L’appel à [**IWbemEventProviderSecurity :: AccessCheck**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovidersecurity-accesscheck) pour les événements d’un fournisseur découplé ne propage jamais le jeton d’accès client.</span><span class="sxs-lookup"><span data-stu-id="bcad4-125">The call to [**IWbemEventProviderSecurity::AccessCheck**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovidersecurity-accesscheck) for events from a decoupled provider never propagates the client access token.</span></span> <span data-ttu-id="bcad4-126">WMI gère le contrôle d’accès de la même manière que pour les fournisseurs d’événements nondecoupled.</span><span class="sxs-lookup"><span data-stu-id="bcad4-126">WMI handles the access control in the same manner as for nondecoupled event providers.</span></span> <span data-ttu-id="bcad4-127">Pour plus d’informations sur l’écriture d’un fournisseur découplé, consultez [incorporation d’un fournisseur dans une application](incorporating-a-provider-in-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="bcad4-127">For more information about writing a decoupled provider, see [Incorporating a Provider in an Application](incorporating-a-provider-in-an-application.md).</span></span>

<span data-ttu-id="bcad4-128">Seuls les administrateurs disposant du privilège d' **\_ écriture complet** défini dans le **contrôle WMI** du **panneau de configuration** sont autorisés à déclencher des événements pour un espace de noms.</span><span class="sxs-lookup"><span data-stu-id="bcad4-128">Only administrators with the **FULL\_WRITE** privilege set in **WMI Control** of the **Control Panel** are allowed to raise events for a namespace.</span></span> <span data-ttu-id="bcad4-129">Pour plus d’informations, consultez [définition de la sécurité de l’espace de noms avec le contrôle WMI](setting-namespace-security-with-the-wmi-control.md).</span><span class="sxs-lookup"><span data-stu-id="bcad4-129">For more information, see [Setting Namespace Security with the WMI Control](setting-namespace-security-with-the-wmi-control.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="bcad4-130">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="bcad4-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bcad4-131">Sécurisation des événements WMI</span><span class="sxs-lookup"><span data-stu-id="bcad4-131">Securing WMI Events</span></span>](securing-wmi-events.md)
</dt> </dl>

 

 
