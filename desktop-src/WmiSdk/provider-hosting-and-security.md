---
description: Spécifie le modèle d’hébergement du fournisseur. La définition de cette propriété entraîne le chargement du fournisseur dans un processus hôte partagé qui a un niveau de privilège spécifié.
ms.assetid: 1e5c778d-cd29-449b-88e2-fe0c90d0edcd
ms.tgt_platform: multiple
title: Hébergement et sécurité du fournisseur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: db6b88a5727f34fbb76baf62dcdf0488e5eb9eb7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106523359"
---
# <a name="provider-hosting-and-security"></a><span data-ttu-id="de46e-104">Hébergement et sécurité du fournisseur</span><span class="sxs-lookup"><span data-stu-id="de46e-104">Provider Hosting and Security</span></span>

<span data-ttu-id="de46e-105">La propriété [**HostingModel**](--win32provider.md) dans l’instance **\_ \_ Win32Provider** qui représente votre fournisseur spécifie le modèle d’hébergement du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="de46e-105">The [**HostingModel**](--win32provider.md) property in the **\_\_Win32Provider** instance that represents your provider specifies the provider hosting model.</span></span> <span data-ttu-id="de46e-106">La définition de cette propriété entraîne le chargement du fournisseur dans un processus hôte partagé qui a un niveau de privilège spécifié.</span><span class="sxs-lookup"><span data-stu-id="de46e-106">Setting this property causes the provider to be loaded into a shared host process that has a specified level of privilege.</span></span>

## <a name="shared-provider-host-process"></a><span data-ttu-id="de46e-107">Processus hôte du fournisseur partagé</span><span class="sxs-lookup"><span data-stu-id="de46e-107">Shared Provider Host Process</span></span>

<span data-ttu-id="de46e-108">WMI réside dans un hôte de service partagé avec plusieurs autres services.</span><span class="sxs-lookup"><span data-stu-id="de46e-108">WMI resides in a shared service host with several other services.</span></span> <span data-ttu-id="de46e-109">Pour éviter d’arrêter tous les services en cas d’échec d’un fournisseur, les fournisseurs sont chargés dans un processus hôte distinct nommé « Wmiprvse.exe ».</span><span class="sxs-lookup"><span data-stu-id="de46e-109">To avoid stopping all the services when a provider fails, providers are loaded into a separate host process named "Wmiprvse.exe".</span></span> <span data-ttu-id="de46e-110">Plusieurs processus portant ce nom peuvent être en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="de46e-110">More than one process with this name can be running.</span></span> <span data-ttu-id="de46e-111">Chaque peut s’exécuter sous un compte différent avec une sécurité variable.</span><span class="sxs-lookup"><span data-stu-id="de46e-111">Each can run under a different account with varying security.</span></span> <span data-ttu-id="de46e-112">N’oubliez pas que, à partir de Windows Vista, utilisez la commande [**winmgmt**](winmgmt.md) pour exécuter WMI dans un processus séparé en lui-même à l’aide d’un port fixe.</span><span class="sxs-lookup"><span data-stu-id="de46e-112">Be aware that, starting with Windows Vista, use the [**winmgmt**](winmgmt.md) command to run WMI in a separate process by itself using a fixed port.</span></span> <span data-ttu-id="de46e-113">Pour plus d’informations, consultez [connexion à WMI à distance à partir de Vista](connecting-to-wmi-remotely-starting-with-vista.md).</span><span class="sxs-lookup"><span data-stu-id="de46e-113">For more information, see [Connecting to WMI Remotely Starting with Vista](connecting-to-wmi-remotely-starting-with-vista.md).</span></span>

<span data-ttu-id="de46e-114">L’hôte partagé peut s’exécuter sous l’un des comptes système suivants dans un processus hôte de Wmiprvse.exe :</span><span class="sxs-lookup"><span data-stu-id="de46e-114">The shared host can run under one of the following system accounts in a Wmiprvse.exe host process:</span></span>

-   [<span data-ttu-id="de46e-115">LocalSystem</span><span class="sxs-lookup"><span data-stu-id="de46e-115">LocalSystem</span></span>](/windows/desktop/Services/localsystem-account)
-   [<span data-ttu-id="de46e-116">NetworkService</span><span class="sxs-lookup"><span data-stu-id="de46e-116">NetworkService</span></span>](/windows/desktop/Services/networkservice-account)
-   [<span data-ttu-id="de46e-117">LocalService</span><span class="sxs-lookup"><span data-stu-id="de46e-117">LocalService</span></span>](/windows/desktop/Services/localservice-account)

<span data-ttu-id="de46e-118">Un fournisseur peut également être un serveur COM local (. exe) ou auto-hébergé, qui ne nécessite pas d’hôte de fournisseur WMI.</span><span class="sxs-lookup"><span data-stu-id="de46e-118">A provider can also be a local COM server (.exe), or self-hosted, which does not require a WMI provider host.</span></span>

## <a name="setting-the-hosting-model"></a><span data-ttu-id="de46e-119">Définition du modèle d’hébergement</span><span class="sxs-lookup"><span data-stu-id="de46e-119">Setting the Hosting Model</span></span>

<span data-ttu-id="de46e-120">Comme LocalSystem est un compte privilégié, il est recommandé de définir [**HostingModel**](--win32provider.md) sur **NetworkServiceHost** lorsqu’un fournisseur s’exécute dans un processus de Wmiprvse.exe.</span><span class="sxs-lookup"><span data-stu-id="de46e-120">Because LocalSystem is a privileged account, it is recommended that you set [**HostingModel**](--win32provider.md) to **NetworkServiceHost** when a provider is running in a Wmiprvse.exe process.</span></span> <span data-ttu-id="de46e-121">Le compte NetworkServiceHost est destiné aux services qui ne nécessitent pas de privilèges étendus, mais qui doivent communiquer à distance avec d’autres systèmes.</span><span class="sxs-lookup"><span data-stu-id="de46e-121">NetworkServiceHost account is for services that do not require extensive privileges, but do need to communicate remotely with other systems.</span></span>

<span data-ttu-id="de46e-122">Si vous ne définissez pas de valeur pour la propriété [**HostingModel**](--win32provider.md) , WMI définit la valeur par défaut **NetworkServiceHostOrSelfHost**.</span><span class="sxs-lookup"><span data-stu-id="de46e-122">If you do not set a value for the [**HostingModel**](--win32provider.md) property, WMI will set a default value of **NetworkServiceHostOrSelfHost**.</span></span> <span data-ttu-id="de46e-123">Si la valeur **HostingModel** est définie sur **LocalSystemHost**, WMI utilise le suivi pour générer les événements 5603 et 5604 dans le journal des événements Windows.</span><span class="sxs-lookup"><span data-stu-id="de46e-123">If the **HostingModel** value is set to **LocalSystemHost**, WMI uses tracing to generate events 5603 and 5604 in the Windows Event Log.</span></span> <span data-ttu-id="de46e-124">Étant donné que le compte [LocalSystem](/windows/desktop/Services/localsystem-account) local est hautement privilégié, ce paramètre n’est pas recommandé.</span><span class="sxs-lookup"><span data-stu-id="de46e-124">Because the local [LocalSystem](/windows/desktop/Services/localsystem-account) account is highly privileged, this setting is not recommended.</span></span> <span data-ttu-id="de46e-125">Vous pouvez afficher ces événements dans la **Observateur d’événements**.</span><span class="sxs-lookup"><span data-stu-id="de46e-125">You can view these events in the **Event Viewer**.</span></span> <span data-ttu-id="de46e-126">Pour plus d’informations, consultez suivi de l' [activité WMI](tracing-wmi-activity.md).</span><span class="sxs-lookup"><span data-stu-id="de46e-126">For more information, see [Tracing WMI Activity](tracing-wmi-activity.md).</span></span>

<span data-ttu-id="de46e-127">Définissez la propriété [**HostingModel**](--win32provider.md) des fournisseurs découplés sur « découplé : com ».</span><span class="sxs-lookup"><span data-stu-id="de46e-127">Set the [**HostingModel**](--win32provider.md) property for decoupled providers as "Decoupled:Com".</span></span> <span data-ttu-id="de46e-128">Les fournisseurs créés en ajoutant des classes d’instrumentation à partir de [**Microsoft. Management. infrastructure**](/previous-versions//hh872326(v=vs.85)) dans le .NET Framework sont des fournisseurs découplés.</span><span class="sxs-lookup"><span data-stu-id="de46e-128">Providers created by adding instrumentation classes from [**Microsoft.Management.Infrastructure**](/previous-versions//hh872326(v=vs.85)) in the .NET Framework are decoupled providers.</span></span> <span data-ttu-id="de46e-129">(**System. Management. Instrumentation** n’est plus pris en charge.) Pour plus d’informations sur la création d’un fournisseur découplé, voir [incorporation d’un fournisseur dans une application](incorporating-a-provider-in-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="de46e-129">(**System.Management.Instrumentation** is no longer supported.) For more information about creating a decoupled provider, see [Incorporating a Provider in an Application](incorporating-a-provider-in-an-application.md).</span></span>

<span data-ttu-id="de46e-130">Le modèle d’hébergement est spécifié dans la propriété [**HostingModel**](--win32provider.md) de l’instance **\_ \_ Win32Provider** qui représente votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="de46e-130">The hosting model is specified in the [**HostingModel**](--win32provider.md) property in the **\_\_Win32Provider** instance that represents your provider.</span></span>

<span data-ttu-id="de46e-131">**Pour définir le modèle d’hébergement d’un fournisseur**</span><span class="sxs-lookup"><span data-stu-id="de46e-131">**To set the hosting model for a provider**</span></span>

1.  <span data-ttu-id="de46e-132">Dans le fichier MOF qui définit votre fournisseur, créez une instance de [**\_ \_ Win32Provider**](--win32provider.md).</span><span class="sxs-lookup"><span data-stu-id="de46e-132">In the MOF file that defines your provider, create an instance of [**\_\_Win32Provider**](--win32provider.md).</span></span>
2.  <span data-ttu-id="de46e-133">Attribuez un nom au fournisseur dans la propriété **Name** et affectez l’identificateur de classe (CLSID) de l’objet com du fournisseur à la propriété **CLSID** .</span><span class="sxs-lookup"><span data-stu-id="de46e-133">Assign a name to the provider in the **Name** property and assign the class identifier (CLSID) of the provider COM object to the **Clsid** property.</span></span>

    <span data-ttu-id="de46e-134">L’exemple de code suivant affecte un nom à la propriété **Name** et le CSLID de l’objet com Provider à la propriété **CLSID** .</span><span class="sxs-lookup"><span data-stu-id="de46e-134">The following code example assigns a name to the **Name** property and the CSLID of the provider COM object to the **Clsid** property.</span></span>

    ``` syntax
    Instance of __Win32Provider as $NewProvider
    {
        Name = "MyProvider";
        Clsid = "{.......}";
    }
    ```

3.  <span data-ttu-id="de46e-135">Assignez la valeur de l’hôte partagé appropriée à la propriété [**HostingModel**](--win32provider.md) .</span><span class="sxs-lookup"><span data-stu-id="de46e-135">Assign the appropriate shared host value to the [**HostingModel**](--win32provider.md) property.</span></span> <span data-ttu-id="de46e-136">Les valeurs de l’hôte partagé, telles que « NetworkServiceHost », sont définies dans la propriété **HostingSpecification** de la classe des [**\_ fournisseurs msft**](/previous-versions/windows/desktop/wmisystemprov/msft-providers) .</span><span class="sxs-lookup"><span data-stu-id="de46e-136">Shared host values such as "NetworkServiceHost" are defined in the **HostingSpecification** property of [**MSFT\_Providers**](/previous-versions/windows/desktop/wmisystemprov/msft-providers) class.</span></span>

    <span data-ttu-id="de46e-137">L’exemple de code suivant affecte une valeur d’hôte partagé à la propriété [**HostingModel**](--win32provider.md) .</span><span class="sxs-lookup"><span data-stu-id="de46e-137">The following code example assigns a shared host value to the [**HostingModel**](--win32provider.md) property.</span></span>

    ``` syntax
    HostingModel = "NetworkServiceHost";
    ```

<span data-ttu-id="de46e-138">L’exemple de code suivant montre comment inscrire un fournisseur dans NetworkServiceHost.</span><span class="sxs-lookup"><span data-stu-id="de46e-138">The following code example shows how to register a provider in NetworkServiceHost.</span></span>

``` syntax
Instance of __Win32Provider as $NewProvider
{
    Name = "MyProvider";
    Clsid = "{.......}";
    HostingModel = "NetworkServiceHost";
}
```

<span data-ttu-id="de46e-139">Si vous avez plusieurs fournisseurs, vous pouvez les regrouper dans un hôte de service spécifique en inscrivant votre fournisseur afin qu’il se trouve dans l’instance spécifique.</span><span class="sxs-lookup"><span data-stu-id="de46e-139">If you have multiple providers, you can group them into a specific service host by registering your provider so that it resides in the specific instance.</span></span>

<span data-ttu-id="de46e-140">L’exemple de code suivant inscrit également un fournisseur dans NetworkServiceHost.</span><span class="sxs-lookup"><span data-stu-id="de46e-140">The following code example also registers a provider in NetworkServiceHost.</span></span> <span data-ttu-id="de46e-141">La [**classe \_ fournisseurs msft**](/previous-versions/windows/desktop/wmisystemprov/msft-providers) définit des valeurs pour les deux valeurs que combine pour créer la propriété **HostingModel** [**\_ \_ Win32Provider**](--win32provider.md) .</span><span class="sxs-lookup"><span data-stu-id="de46e-141">The [**MSFT\_Providers**](/previous-versions/windows/desktop/wmisystemprov/msft-providers) class defines values for the two values that combine to create the [**\_\_Win32Provider**](--win32provider.md) **HostingModel** property.</span></span> <span data-ttu-id="de46e-142">Dans l’exemple, la valeur « NetworkServiceHost » provient de la propriété **HostingSpecification** des **\_ fournisseurs msft** et « LocalServiceHost » provient de la propriété **HostingGroup** .</span><span class="sxs-lookup"><span data-stu-id="de46e-142">In the example, "NetworkServiceHost" value comes from the **HostingSpecification** property of **MSFT\_Providers** and "LocalServiceHost" comes from the **HostingGroup** property.</span></span>

``` syntax
Instance of __Win32Provider as $NewProvider
{
    Name = "MyProvider";
    Clsid = "{.......}";
    HostingModel = "NetworkServiceHost:MySharedHost";
}
```

<span data-ttu-id="de46e-143">Des problèmes de développement spéciaux existent pour les fournisseurs qui ne sont pas découplés et qui sont hébergés dans le processus Wmiprvse.</span><span class="sxs-lookup"><span data-stu-id="de46e-143">Special development issues exist for providers that are not decoupled and are hosted in the Wmiprvse process.</span></span> <span data-ttu-id="de46e-144">Pour plus d’informations, consultez [débogage de fournisseurs](debugging-providers.md).</span><span class="sxs-lookup"><span data-stu-id="de46e-144">For more information, see [Debugging Providers](debugging-providers.md).</span></span>

<span data-ttu-id="de46e-145">Si vous écrivez un fournisseur qui contient la propriété ou l’inscription du fournisseur de classe, tous les modèles de thread ne fonctionnent pas.</span><span class="sxs-lookup"><span data-stu-id="de46e-145">If you are writing a provider that contains property or class provider registration, not all threading models work.</span></span> <span data-ttu-id="de46e-146">Pour plus d’informations, consultez [choix de l’inscription correcte](choosing-correct-registration.md).</span><span class="sxs-lookup"><span data-stu-id="de46e-146">For more information, see [Choosing Correct Registration](choosing-correct-registration.md).</span></span>

## <a name="hostingmodel-values-for-in-process-providers"></a><span data-ttu-id="de46e-147">Valeurs de HostingModel pour les fournisseurs de In-Process</span><span class="sxs-lookup"><span data-stu-id="de46e-147">HostingModel Values for In-Process Providers</span></span>

<span data-ttu-id="de46e-148">La liste suivante répertorie les valeurs de modèle d’hébergement du fournisseur à utiliser dans l’instance [**\_ \_ Win32Provider**](--win32provider.md) pour les fournisseurs qui s’exécutent dans un processus de Wmiprvse.exe.</span><span class="sxs-lookup"><span data-stu-id="de46e-148">The following list lists the provider hosting model values to use in the [**\_\_Win32Provider**](--win32provider.md) instance for providers that run in a Wmiprvse.exe process.</span></span>



| <span data-ttu-id="de46e-149">Valeur dans [ **\_ \_ Win32Provider. HostingModel**](--win32provider.md)</span><span class="sxs-lookup"><span data-stu-id="de46e-149">Value in [**\_\_Win32Provider.HostingModel**](--win32provider.md)</span></span> | <span data-ttu-id="de46e-150">Description</span><span class="sxs-lookup"><span data-stu-id="de46e-150">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|--------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="de46e-151">**SelfHost**</span><span class="sxs-lookup"><span data-stu-id="de46e-151">**SelfHost**</span></span>                                                       | <span data-ttu-id="de46e-152">Le fournisseur commence à utiliser l’implémentation du serveur local au lieu de in-process.</span><span class="sxs-lookup"><span data-stu-id="de46e-152">The provider starts using the local server implementation instead of in-process.</span></span> <span data-ttu-id="de46e-153">Le contexte de sécurité du processus dans lequel le fournisseur s’exécute détermine le contexte de sécurité du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="de46e-153">The security context of the process in which the provider runs determines the provider security context.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="de46e-154">**LocalSystemHost**</span><span class="sxs-lookup"><span data-stu-id="de46e-154">**LocalSystemHost**</span></span>                                                | <span data-ttu-id="de46e-155">Le fournisseur, s’il est implémenté comme in-process, est chargé dans un hôte de fournisseur partagé s’exécutant dans un contexte [LocalSystem](/windows/desktop/Services/localsystem-account) .</span><span class="sxs-lookup"><span data-stu-id="de46e-155">The provider, if implemented as in-process, is loaded into a shared provider host running under [LocalSystem](/windows/desktop/Services/localsystem-account) context.</span></span> <span data-ttu-id="de46e-156">À [**compter de Windows**](--win32provider.md) Vista, **LocalSystemHost** n’est plus le modèle d’hébergement par défaut si le modèle d’hébergement d’un fournisseur WMI (**\_ \_ Win32Provider**.\*\*\*\* La propriété HostingModel) n’est pas spécifiée.</span><span class="sxs-lookup"><span data-stu-id="de46e-156">Starting with Windows Vista, **LocalSystemHost** is no longer the default hosting model if the [**HostingModel**](--win32provider.md) of a WMI provider (**\_\_Win32Provider**.**HostingModel** property) is unspecified.</span></span> <span data-ttu-id="de46e-157">Pour plus d’informations, consultez [sécurité des modèles d’hébergement](#provider-hosting-and-security).</span><span class="sxs-lookup"><span data-stu-id="de46e-157">For more information, see [Security of Hosting Models](#provider-hosting-and-security).</span></span>                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="de46e-158">**LocalSystemHostOrSelfHost**</span><span class="sxs-lookup"><span data-stu-id="de46e-158">**LocalSystemHostOrSelfHost**</span></span>                                      | <span data-ttu-id="de46e-159">Le fournisseur est auto-hébergé ou chargé dans le processus de Wmiprvse.exe s’exécutant sous le compte [LocalSystem](/windows/desktop/Services/localsystem-account) .</span><span class="sxs-lookup"><span data-stu-id="de46e-159">The provider is self-hosted or loaded into the Wmiprvse.exe process running under the [LocalSystem](/windows/desktop/Services/localsystem-account) account.</span></span> <span data-ttu-id="de46e-160">Comme LocalSystem est un compte doté de privilèges élevés, une entrée est générée dans le journal des événements de sécurité NT pour notifier les administrateurs d’un fournisseur s’exécutant dans cet État approuvé.</span><span class="sxs-lookup"><span data-stu-id="de46e-160">Because LocalSystem is a highly privileged account, an entry is generated in the Security NT Event Log to notify administrators of a provider running in this trusted status.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="de46e-161">**NetworkServiceHost**</span><span class="sxs-lookup"><span data-stu-id="de46e-161">**NetworkServiceHost**</span></span>                                             | <span data-ttu-id="de46e-162">Le fournisseur, s’il est implémenté comme in-process, est chargé dans le processus de Wmiprvse.exe s’exécutant sous le compte [NetworkService](/windows/desktop/Services/networkservice-account) .</span><span class="sxs-lookup"><span data-stu-id="de46e-162">The provider, if implemented as in-process, is loaded into the Wmiprvse.exe process running under [NetworkService](/windows/desktop/Services/networkservice-account) account.</span></span> <span data-ttu-id="de46e-163">À [**compter de Windows**](--win32provider.md) Vista, il s’agit du modèle d’hébergement par défaut si le modèle d’hébergement d’un fournisseur WMI (**\_ \_ Win32Provider**.\*\*\*\* La propriété HostingModel) n’est pas spécifiée.</span><span class="sxs-lookup"><span data-stu-id="de46e-163">Starting with Windows Vista, this is the default hosting model if the [**HostingModel**](--win32provider.md) of a WMI provider (**\_\_Win32Provider**.**HostingModel** property) is unspecified.</span></span> <span data-ttu-id="de46e-164">Pour plus d’informations, consultez [sécurité des modèles d’hébergement](#provider-hosting-and-security).</span><span class="sxs-lookup"><span data-stu-id="de46e-164">For more information, see [Security of Hosting Models](#provider-hosting-and-security).</span></span><br/> <span data-ttu-id="de46e-165">**NetworkServiceHost** a des privilèges limités et réduit donc le risque d’une attaque par élévation de privilèges.</span><span class="sxs-lookup"><span data-stu-id="de46e-165">**NetworkServiceHost** has limited privileges and therefore reduces the possibility of an elevation of privilege attack.</span></span> <span data-ttu-id="de46e-166">Si le fournisseur ne fonctionne que sur l’ordinateur local, définissez la propriété [**HostingModel**](--win32provider.md) sur **LocalServiceHost**.</span><span class="sxs-lookup"><span data-stu-id="de46e-166">If the provider only operates within the local computer, then set the [**HostingModel**](--win32provider.md) property to **LocalServiceHost**.</span></span><br/> |
| <span data-ttu-id="de46e-167">**NetworkServiceHostOrSelfHost**</span><span class="sxs-lookup"><span data-stu-id="de46e-167">**NetworkServiceHostOrSelfHost**</span></span>                                   | <span data-ttu-id="de46e-168">Le fournisseur est auto-hébergé ou chargé dans le processus de WmiPrvse.exe s’exécutant sous le compte [NetworkService](/windows/desktop/Services/networkservice-account) .</span><span class="sxs-lookup"><span data-stu-id="de46e-168">The provider is self-hosted or loaded into the WmiPrvse.exe process running under the [NetworkService](/windows/desktop/Services/networkservice-account) account.</span></span> <span data-ttu-id="de46e-169">**NetworkServiceHostOrSelfHost** est la configuration par défaut lorsque la propriété [**HostingModel**](--win32provider.md) dans **\_ \_ Win32Provider** a la **valeur null**.</span><span class="sxs-lookup"><span data-stu-id="de46e-169">**NetworkServiceHostOrSelfHost** is the default configuration when the [**HostingModel**](--win32provider.md) property in **\_\_Win32Provider** is **NULL**.</span></span> <span data-ttu-id="de46e-170">Étant donné que **NetworkServiceHostOrSelfHost** est la valeur par défaut, les fournisseurs de systèmes d’exploitation antérieurs peuvent continuer à fonctionner dans Windows Vista, windows Server 2008 et les systèmes d’exploitation ultérieurs.</span><span class="sxs-lookup"><span data-stu-id="de46e-170">Because **NetworkServiceHostOrSelfHost** is the default, providers from earlier operating systems can continue to work in Windows Vista, Windows Server 2008, and later operating systems.</span></span>                                                                                                                                                                                                                                             |
| <span data-ttu-id="de46e-171">**LocalServiceHost**</span><span class="sxs-lookup"><span data-stu-id="de46e-171">**LocalServiceHost**</span></span>                                               | <span data-ttu-id="de46e-172">Le fournisseur, s’il est implémenté comme in-process, est chargé dans le processus de Wmiprvse.exe s’exécutant sous le compte [LocalService](/windows/desktop/Services/localservice-account) .</span><span class="sxs-lookup"><span data-stu-id="de46e-172">The provider, if implemented as in-process, is loaded into the Wmiprvse.exe process running under the [LocalService](/windows/desktop/Services/localservice-account) account.</span></span> <span data-ttu-id="de46e-173">Il s’agit du modèle d’hébergement recommandé pour les services, car LocalService dispose de privilèges limités.</span><span class="sxs-lookup"><span data-stu-id="de46e-173">This is the recommended hosting model for services because LocalService has limited privileges.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

## <a name="hostingmodel-values-for-decoupled-providers"></a><span data-ttu-id="de46e-174">Valeurs de HostingModel pour les fournisseurs découplés</span><span class="sxs-lookup"><span data-stu-id="de46e-174">HostingModel Values for Decoupled Providers</span></span>

<span data-ttu-id="de46e-175">La liste suivante répertorie les valeurs du modèle d’hébergement du fournisseur pour les fournisseurs découplés.</span><span class="sxs-lookup"><span data-stu-id="de46e-175">The following list lists the provider hosting model values for decoupled providers.</span></span>

<dl> <dt>

<span data-ttu-id="de46e-176"><span id="Decoupled_Com"></span><span id="decoupled_com"></span><span id="DECOUPLED_COM"></span>**Découplé : com**</span><span class="sxs-lookup"><span data-stu-id="de46e-176"><span id="Decoupled_Com"></span><span id="decoupled_com"></span><span id="DECOUPLED_COM"></span>**Decoupled:Com**</span></span>
</dt> <dd>

<span data-ttu-id="de46e-177">Le fournisseur est un fournisseur découplé hébergé dans un processus distinct qui est un client à WMI.</span><span class="sxs-lookup"><span data-stu-id="de46e-177">The provider is a decoupled provider hosted in a separate process that is a client to WMI.</span></span>

<span data-ttu-id="de46e-178">L’exemple suivant montre le spécificateur FoldIdentity pour la propriété [**HostingModel**](--win32provider.md) définie sur **false**, ce qui permet au fournisseur d’emprunter l’identité du client.</span><span class="sxs-lookup"><span data-stu-id="de46e-178">The following example shows the FoldIdentity specifier for the [**HostingModel**](--win32provider.md) property set to **FALSE**, which allows the provider to impersonate the client.</span></span>

``` syntax
Decoupled:Com:FoldIdentity(FALSE)
```

<span data-ttu-id="de46e-179">Si FoldIdentity n’est pas spécifié, la valeur de FoldIdentity est définie par défaut sur **true** .</span><span class="sxs-lookup"><span data-stu-id="de46e-179">If FoldIdentity is not specified, the FoldIdentity value is set to **TRUE** by default.</span></span> <span data-ttu-id="de46e-180">Pour des raisons de sécurité, il est recommandé de ne pas spécifier FoldIdentity (FALSe), car une application non autorisée avec l’emprunt d’identité du délégué peut affecter un domaine entier.</span><span class="sxs-lookup"><span data-stu-id="de46e-180">For security reasons, it is recommended that you not specify FoldIdentity(FALSE) since a rogue application with impersonation of Delegate can affect an entire domain.</span></span>

<span data-ttu-id="de46e-181">L’exemple suivant montre la propriété [**HostingModel**](--win32provider.md) définie dans la méthode recommandée qui est équivalente à la définition de FOLDIDENTITY (true).</span><span class="sxs-lookup"><span data-stu-id="de46e-181">The following example shows the [**HostingModel**](--win32provider.md) property set in the recommended manner that is equivalent to setting FoldIdentity(TRUE).</span></span>

``` syntax
Decoupled:Com
```

</dd> <dt>

<span data-ttu-id="de46e-182"><span id="Decoupled_Noncom"></span><span id="decoupled_noncom"></span><span id="DECOUPLED_NONCOM"></span>**Découplé : noncom**</span><span class="sxs-lookup"><span data-stu-id="de46e-182"><span id="Decoupled_Noncom"></span><span id="decoupled_noncom"></span><span id="DECOUPLED_NONCOM"></span>**Decoupled:Noncom**</span></span>
</dt> <dd>

<span data-ttu-id="de46e-183">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="de46e-183">For internal use only.</span></span> <span data-ttu-id="de46e-184">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="de46e-184">Not supported.</span></span>

</dd> </dl>

## <a name="security-of-hosting-models"></a><span data-ttu-id="de46e-185">Sécurité des modèles d’hébergement</span><span class="sxs-lookup"><span data-stu-id="de46e-185">Security of Hosting Models</span></span>

<span data-ttu-id="de46e-186">Dans la plupart des cas, **LocalSystem** est inutile et le contexte **NetworkServiceHost** est plus approprié.</span><span class="sxs-lookup"><span data-stu-id="de46e-186">For most situations, **LocalSystem** is unnecessary and the **NetworkServiceHost** context is more appropriate.</span></span> <span data-ttu-id="de46e-187">La plupart des fournisseurs WMI doivent emprunter l’identité du contexte de sécurité du client pour effectuer les opérations demandées pour le compte du client WMI.</span><span class="sxs-lookup"><span data-stu-id="de46e-187">Most WMI Providers must impersonate the client security context to perform requested operations on behalf of the WMI client.</span></span> <span data-ttu-id="de46e-188">À compter de Windows Vista, un fournisseur WMI qui ne possède pas de définition de modèle d’hébergement et s’exécute comme s’il s’exécutait sous **LocalSystem** ne fonctionnera pas correctement.</span><span class="sxs-lookup"><span data-stu-id="de46e-188">Starting with Windows Vista, a WMI provider that lacks a hosting model definition and executes as if it is running under **LocalSystem** will not run properly.</span></span> <span data-ttu-id="de46e-189">Pour corriger cette situation, modifiez le modèle d’hébergement attendu et assurez-vous que le code du fournisseur WMI effectue les opérations dans le contexte de sécurité du client en usurpant l’identité du client WMI.</span><span class="sxs-lookup"><span data-stu-id="de46e-189">To correct this situation, change the expected hosting model and ensure that the WMI provider code performs the operations in the client security context by impersonating the WMI client.</span></span> <span data-ttu-id="de46e-190">LocalSystem est rarement une exigence.</span><span class="sxs-lookup"><span data-stu-id="de46e-190">LocalSystem is rarely an requirement.</span></span> <span data-ttu-id="de46e-191">Si votre fournisseur doit avoir ce niveau de privilège, spécifiez le modèle d’hébergement avec l’instruction suivante dans le fichier MOF.</span><span class="sxs-lookup"><span data-stu-id="de46e-191">If your provider must have that level of privilege, specify the hosting model with the following statement in the MOF file.</span></span>

``` syntax
HostingModel=LocalSystemHost
```

## <a name="related-topics"></a><span data-ttu-id="de46e-192">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="de46e-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="de46e-193">Choix de l’inscription correcte</span><span class="sxs-lookup"><span data-stu-id="de46e-193">Choosing Correct Registration</span></span>](choosing-correct-registration.md)
</dt> <dt>

[<span data-ttu-id="de46e-194">Accès aux espaces de noms WMI</span><span class="sxs-lookup"><span data-stu-id="de46e-194">Access to WMI Namespaces</span></span>](access-to-wmi-namespaces.md)
</dt> <dt>

[<span data-ttu-id="de46e-195">Sécurisation des espaces de noms WMI</span><span class="sxs-lookup"><span data-stu-id="de46e-195">Securing WMI Namespaces</span></span>](securing-wmi-namespaces.md)
</dt> <dt>

[<span data-ttu-id="de46e-196">Classes de résolution des problèmes et de configuration du fournisseur</span><span class="sxs-lookup"><span data-stu-id="de46e-196">Provider Configuration and Troubleshooting Classes</span></span>](provider-configuration-and-troubleshooting-classes.md)
</dt> <dt>

[<span data-ttu-id="de46e-197">**\_Fournisseurs msft**</span><span class="sxs-lookup"><span data-stu-id="de46e-197">**MSFT\_Providers**</span></span>](/previous-versions/windows/desktop/wmisystemprov/msft-providers)
</dt> <dt>

[<span data-ttu-id="de46e-198">Maintenance de la sécurité WMI</span><span class="sxs-lookup"><span data-stu-id="de46e-198">Maintaining WMI Security</span></span>](maintaining-wmi-security.md)
</dt> </dl>

 

