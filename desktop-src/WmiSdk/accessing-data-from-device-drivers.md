---
description: Le fournisseur Windows Driver Model (WDM) accorde l’accès aux classes, aux instances, aux méthodes et aux événements des pilotes matériels conformes au modèle WDM.
ms.assetid: 8686a613-0e53-4e6e-b193-7839abfb70de
ms.tgt_platform: multiple
title: Accès aux données à partir des pilotes de périphérique
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72a59b59116ca0f71178fb2faed290d6bc76c9d6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106527712"
---
# <a name="accessing-data-from-device-drivers"></a><span data-ttu-id="eca7a-103">Accès aux données à partir des pilotes de périphérique</span><span class="sxs-lookup"><span data-stu-id="eca7a-103">Accessing Data from Device Drivers</span></span>

<span data-ttu-id="eca7a-104">Le fournisseur Windows Driver Model (WDM) accorde l’accès aux classes, aux instances, aux méthodes et aux événements des pilotes matériels conformes au modèle WDM.</span><span class="sxs-lookup"><span data-stu-id="eca7a-104">The Windows Driver Model (WDM) provider grants access to the classes, instances, methods, and events of hardware drivers that conform to the WDM model.</span></span> <span data-ttu-id="eca7a-105">Les classes pour les pilotes de matériel résident dans l' \\ \\ \\ espace de noms WMI racine.</span><span class="sxs-lookup"><span data-stu-id="eca7a-105">The classes for hardware drivers reside in the \\\\root\\wmi namespace.</span></span>

<span data-ttu-id="eca7a-106">Le fournisseur WDM présente un intérêt pour ceux qui écrivent des pilotes de périphérique et pour les administrateurs qui sont intéressés par les données de pilote de périphérique.</span><span class="sxs-lookup"><span data-stu-id="eca7a-106">The WDM provider is of interest to those who write device drivers and to administrators who are interested in device driver data.</span></span>

<span data-ttu-id="eca7a-107">Les sections suivantes sont présentées dans cette rubrique :</span><span class="sxs-lookup"><span data-stu-id="eca7a-107">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="eca7a-108">Informations pour les writers de pilote de périphérique</span><span class="sxs-lookup"><span data-stu-id="eca7a-108">Information for Device Driver Writers</span></span>](#information-for-device-driver-writers)
-   [<span data-ttu-id="eca7a-109">Informations pour les administrateurs et les utilisateurs des données de pilote</span><span class="sxs-lookup"><span data-stu-id="eca7a-109">Information for Administrators and Users of Driver Data</span></span>](#information-for-administrators-and-users-of-driver-data)
-   [<span data-ttu-id="eca7a-110">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="eca7a-110">Related topics</span></span>](#related-topics)

## <a name="information-for-device-driver-writers"></a><span data-ttu-id="eca7a-111">Informations pour les writers de pilote de périphérique</span><span class="sxs-lookup"><span data-stu-id="eca7a-111">Information for Device Driver Writers</span></span>

<span data-ttu-id="eca7a-112">Les classes WMI associées à un pilote de périphérique spécifique sont créées lorsque le fournisseur WDM extrait le fichier MOF binaire à partir du fichier exécutable du pilote de périphérique.</span><span class="sxs-lookup"><span data-stu-id="eca7a-112">WMI classes related to a specific device driver are created when the WDM provider extracts the binary MOF from the device driver executable file.</span></span> <span data-ttu-id="eca7a-113">Cette opération a lieu chaque fois que WMI est démarré, qu’un nouveau pilote de périphérique est installé ou que l’instance de [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) pour un pilote particulier est supprimée.</span><span class="sxs-lookup"><span data-stu-id="eca7a-113">This takes place whenever WMI is started, a new device driver is installed, or the instance of [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) for a particular driver is deleted.</span></span> <span data-ttu-id="eca7a-114">En consultant wmiprov. log, vous pouvez déterminer si une erreur provoquant un échec s’est produite lors de l’extraction du fichier MOF binaire.</span><span class="sxs-lookup"><span data-stu-id="eca7a-114">By checking Wmiprov.log, you can determine if an error resulting in failure occurred while extracting the binary MOF file.</span></span> <span data-ttu-id="eca7a-115">Les détails des erreurs [mofcomp](mofcomp.md) sont signalés dans mofcomp. log.</span><span class="sxs-lookup"><span data-stu-id="eca7a-115">Details of [mofcomp](mofcomp.md) errors are reported in Mofcomp.log.</span></span> <span data-ttu-id="eca7a-116">Pour plus d’informations, consultez [fichiers journaux WMI](wmi-log-files.md).</span><span class="sxs-lookup"><span data-stu-id="eca7a-116">For more information, see [WMI Log Files](wmi-log-files.md).</span></span> <span data-ttu-id="eca7a-117">Pour des raisons de performances, le fournisseur WDM ne génère pas d’événements lors de la création ou de la suppression de classes en raison du démarrage ou de l’arrêt d’un fournisseur WDM.</span><span class="sxs-lookup"><span data-stu-id="eca7a-117">For performance reasons, the WDM provider does not generate events while creating or deleting classes due to a WDM provider starting or stopping.</span></span>

<span data-ttu-id="eca7a-118">Le fournisseur WDM transforme toutes les données WNODE en informations de classe.</span><span class="sxs-lookup"><span data-stu-id="eca7a-118">The WDM provider transforms all WNODE data into class information.</span></span> <span data-ttu-id="eca7a-119">Si une erreur se produit lors de la transformation des données de WNODE en données de classe, elles sont signalées dans wmiprov. log avec l’en-tête formaté et les octets rendus sous la même forme qu’une image mémoire.</span><span class="sxs-lookup"><span data-stu-id="eca7a-119">If an error is encountered when transforming the data from WNODE to class data, it is reported in Wmiprov.log with the header formatted and bytes rendered in the same form as a memory dump.</span></span>

<span data-ttu-id="eca7a-120">Les modifications apportées aux paramètres de sécurité des pilotes ne prennent effet qu’une fois le fournisseur WDM déchargé et rechargé.</span><span class="sxs-lookup"><span data-stu-id="eca7a-120">Changes made to driver security settings do not take effect until the WDM provider is unloaded and reloaded.</span></span> <span data-ttu-id="eca7a-121">Pour plus d’informations, consultez [déchargement d’un fournisseur](unloading-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eca7a-121">For more information, see [Unloading a Provider](unloading-a-provider.md).</span></span>

<span data-ttu-id="eca7a-122">WMI peut également rendre disponibles des compteurs de performances élevées pour les pilotes matériels.</span><span class="sxs-lookup"><span data-stu-id="eca7a-122">WMI can also make high-performance counters for hardware drivers available.</span></span> <span data-ttu-id="eca7a-123">Pour plus d’informations sur la création de classes à hautes performances et l’affichage des données dans le moniteur système PerfMon, consultez [amélioration de l’efficacité d’un fournisseur d’instances](improving-the-efficiency-of-an-instance-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eca7a-123">For more information about creating high-performance classes and displaying data in Perfmon System Monitor, see [Improving the Efficiency of an Instance Provider](improving-the-efficiency-of-an-instance-provider.md).</span></span> <span data-ttu-id="eca7a-124">Pour plus d’informations sur l’écriture de pilotes de périphérique compatibles WMI, consultez [https://www.microsoft.com/ddk](https://msdn.microsoft.com/library/aa972908.aspx) .</span><span class="sxs-lookup"><span data-stu-id="eca7a-124">For more information about writing WMI-enabled device drivers, see [https://www.microsoft.com/ddk](https://msdn.microsoft.com/library/aa972908.aspx).</span></span> <span data-ttu-id="eca7a-125">Pour plus d’informations sur les qualificateurs spécifiques à WDM dans le fichier MOF, consultez [**qualificateurs spécifiques au fournisseur WDM**](qualifiers-specific-to-the-wdm-provider.md).</span><span class="sxs-lookup"><span data-stu-id="eca7a-125">For more information about WDM specific qualifiers in the MOF file, see [**Qualifiers Specific to the WDM Provider**](qualifiers-specific-to-the-wdm-provider.md).</span></span>

## <a name="information-for-administrators-and-users-of-driver-data"></a><span data-ttu-id="eca7a-126">Informations pour les administrateurs et les utilisateurs des données de pilote</span><span class="sxs-lookup"><span data-stu-id="eca7a-126">Information for Administrators and Users of Driver Data</span></span>

<span data-ttu-id="eca7a-127">Le fait de répertorier les instances de la classe [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) fournit une liste des pilotes du système et des informations indiquant si le fournisseur WDM a réussi à compiler les MOF pour chaque pilote.</span><span class="sxs-lookup"><span data-stu-id="eca7a-127">Listing the instances of the [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) class provides a list of the drivers in the system and information about whether the WDM provider succeeded in compiling the MOFs for each driver.</span></span> <span data-ttu-id="eca7a-128">Vous pouvez forcer le fournisseur à recompiler et à régénérer les classes d’un pilote en supprimant l’instance de WMIBinaryMofResource qui représente ce pilote.</span><span class="sxs-lookup"><span data-stu-id="eca7a-128">You can force the provider to recompile and regenerate the classes for a driver by deleting the instance of WMIBinaryMofResource that represents that driver.</span></span> <span data-ttu-id="eca7a-129">Les détails des erreurs [mofcomp](mofcomp.md) sont signalés dans le fichier mofcomp. log.</span><span class="sxs-lookup"><span data-stu-id="eca7a-129">Details of [mofcomp](mofcomp.md) errors are reported in the Mofcomp.log.</span></span>

<span data-ttu-id="eca7a-130">Si l’espace de noms WMI est endommagé, il peut être supprimé et rouvert pour forcer le WDM à reconstruire les classes du pilote.</span><span class="sxs-lookup"><span data-stu-id="eca7a-130">If the WMI namespace is corrupted, it can be deleted and reopened to force WDM to rebuild the driver classes.</span></span> <span data-ttu-id="eca7a-131">Pour plus d’informations sur l’ouverture d’un espace de noms, consultez [création de hiérarchies dans WMI](creating-hierarchies-within-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="eca7a-131">For more information about opening a namespace, see [Creating Hierarchies Within WMI](creating-hierarchies-within-wmi.md).</span></span>

<span data-ttu-id="eca7a-132">Les classes de pilote peuvent parfois être « bloquées » si le chargement du pilote est interrompu ou si d’autres opérations anormales se produisent.</span><span class="sxs-lookup"><span data-stu-id="eca7a-132">Driver classes can occasionally get "stranded" if driver loading is interrupted or other abnormal operations occur.</span></span> <span data-ttu-id="eca7a-133">Le fournisseur WDM recherche et nettoie uniquement les classes « bloquées » lors de l’installation d’un nouveau pilote ou lorsque la valeur de clé de Registre **WDMProvider du logiciel \\ Microsoft \\ WBEM \\** **ProcessStrandedClasses** est définie sur **true**.</span><span class="sxs-lookup"><span data-stu-id="eca7a-133">The WDM provider will only search for and clean up "stranded" classes when a new driver is installed or when the **Software\\Microsoft\\WBEM\\WDMProvider** registry key value **ProcessStrandedClasses** is set to **TRUE**.</span></span> <span data-ttu-id="eca7a-134">La définition de cette valeur sur **true** ralentit les performances de démarrage de WMI en raison de l’opération de nettoyage.</span><span class="sxs-lookup"><span data-stu-id="eca7a-134">Setting this value to **TRUE** slows WMI startup performance because of the cleanup operation.</span></span> <span data-ttu-id="eca7a-135">La valeur par défaut est **FALSE**.</span><span class="sxs-lookup"><span data-stu-id="eca7a-135">The default value is **FALSE**.</span></span> <span data-ttu-id="eca7a-136">Le fournisseur WDM vérifie cette valeur de Registre uniquement lorsque l' \\ espace de noms WMI racine est ouvert pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="eca7a-136">The WDM provider only checks this registry value when the "Root\\Wmi" namespace is opened for the first time.</span></span>

<span data-ttu-id="eca7a-137">Si des modifications de sécurité sont apportées à un pilote de périphérique WDM, les modifications n’entrent pas en vigueur tant que le fournisseur WDM n’est pas chargé et rechargé.</span><span class="sxs-lookup"><span data-stu-id="eca7a-137">If security changes are made to a WDM device driver, the changes will not go into effect until the WDM provider is unloaded and reloaded.</span></span> <span data-ttu-id="eca7a-138">Pour ce faire, vous devez arrêter et redémarrer le service de gestion Windows.</span><span class="sxs-lookup"><span data-stu-id="eca7a-138">The Windows Management service must be stopped and restarted to accomplish this.</span></span>

## <a name="related-topics"></a><span data-ttu-id="eca7a-139">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="eca7a-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="eca7a-140">Utilisation de WMI</span><span class="sxs-lookup"><span data-stu-id="eca7a-140">Using WMI</span></span>](using-wmi.md)
</dt> </dl>

 

 
