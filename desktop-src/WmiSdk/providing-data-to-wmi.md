---
description: WMI rend les données relatives aux objets gérables de Windows disponibles via des fournisseurs WMI.
ms.assetid: 74558c6e-28b6-479f-9de6-2fbad793ae26
ms.tgt_platform: multiple
title: Fourniture de données à WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60df0384bd6f512b931870775067d9d9e6d4077d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103753684"
---
# <a name="providing-data-to-wmi"></a><span data-ttu-id="83f60-103">Fourniture de données à WMI</span><span class="sxs-lookup"><span data-stu-id="83f60-103">Providing Data to WMI</span></span>

<span data-ttu-id="83f60-104">WMI rend les données relatives aux objets gérables de Windows disponibles via des [*fournisseurs*](gloss-p.md)WMI.</span><span class="sxs-lookup"><span data-stu-id="83f60-104">WMI makes data about Windows manageable objects available through WMI [*providers*](gloss-p.md).</span></span> <span data-ttu-id="83f60-105">Un fournisseur récupère les données d’un composant système, tel qu’un processus, ou une application instrumentée, telle que SNMP ou IIS, et transmet ces données via WMI à une application de gestion.</span><span class="sxs-lookup"><span data-stu-id="83f60-105">A provider retrieves data from a system component, such as a process, or an instrumented application, such as SNMP or IIS, and passes that data through WMI to a management application.</span></span> <span data-ttu-id="83f60-106">Par exemple, lorsqu’une application ou un script demande des informations de traitement à l’aide de la classe de [**\_ processus WMI Win32**](/windows/desktop/CIMWin32Prov/win32-process) , les données sont obtenues de manière dynamique via un fournisseur préinstallé.</span><span class="sxs-lookup"><span data-stu-id="83f60-106">For example, when an application or script requests process information using the WMI [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class, the data is obtained dynamically through a preinstalled provider.</span></span>

<span data-ttu-id="83f60-107">Les sections suivantes sont présentées dans cette rubrique :</span><span class="sxs-lookup"><span data-stu-id="83f60-107">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="83f60-108">Création d’un modèle pour un objet gérable</span><span class="sxs-lookup"><span data-stu-id="83f60-108">Creating a Model for a Manageable Object</span></span>](#creating-a-model-for-a-manageable-object)
-   [<span data-ttu-id="83f60-109">Implémentation d’un modèle pour un objet gérable</span><span class="sxs-lookup"><span data-stu-id="83f60-109">Implementing a Model for a Manageable Object</span></span>](#implementing-a-model-for-a-manageable-object)
-   [<span data-ttu-id="83f60-110">Détermination d’un type de fournisseur à implémenter</span><span class="sxs-lookup"><span data-stu-id="83f60-110">Determining a Provider Type to Implement</span></span>](#determining-a-provider-type-to-implement)
-   [<span data-ttu-id="83f60-111">Détermination d’un modèle d’hébergement (implémentation) pour un fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-111">Determining a Hosting (Implementation) Model for a Provider</span></span>](#determining-a-hosting-implementation-model-for-a-provider)
-   [<span data-ttu-id="83f60-112">Implémentation d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-112">Implementing a Provider</span></span>](#implementing-a-provider)
-   [<span data-ttu-id="83f60-113">Inscription d’un fournisseur avec WMI et le système</span><span class="sxs-lookup"><span data-stu-id="83f60-113">Registering a Provider with WMI and the System</span></span>](#registering-a-provider-with-wmi-and-the-system)
-   [<span data-ttu-id="83f60-114">Test d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-114">Testing a Provider</span></span>](#testing-a-provider)
-   [<span data-ttu-id="83f60-115">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="83f60-115">Related topics</span></span>](#related-topics)

## <a name="creating-a-model-for-a-manageable-object"></a><span data-ttu-id="83f60-116">Création d’un modèle pour un objet gérable</span><span class="sxs-lookup"><span data-stu-id="83f60-116">Creating a Model for a Manageable Object</span></span>

<span data-ttu-id="83f60-117">Avant de développer un fournisseur, créez un modèle de données pour représenter l’objet gérable à exposer via WMI.</span><span class="sxs-lookup"><span data-stu-id="83f60-117">Before developing a provider, create a data model to represent the manageable object to be exposed through WMI.</span></span> <span data-ttu-id="83f60-118">Vous planifiez les objets de données que votre fournisseur exposera.</span><span class="sxs-lookup"><span data-stu-id="83f60-118">You plan which data objects your provider will expose.</span></span> <span data-ttu-id="83f60-119">Par exemple, si vous envisagez de gérer la résolution d’écran de l’arrière-plan du bureau, vous devez décider comment modéliser le bureau dans un fichier de [*format MOF (MOF)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="83f60-119">For example, if you plan to manage the screen resolution of the desktop background, you must decide how to model the Desktop in a [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

<span data-ttu-id="83f60-120">Pour créer un modèle utile :</span><span class="sxs-lookup"><span data-stu-id="83f60-120">To create a useful model:</span></span>

-   <span data-ttu-id="83f60-121">Déterminez les scénarios réels et modélisez les informations qu’un client peut vouloir lire et mettre à jour (par exemple, modifier l’image d’arrière-plan) pour chaque objet gérable.</span><span class="sxs-lookup"><span data-stu-id="83f60-121">Determine real world scenarios and model the information a customer may want to read and update (for example, changing the background image) for each manageable object.</span></span> <span data-ttu-id="83f60-122">Il s’agit des propriétés de votre classe.</span><span class="sxs-lookup"><span data-stu-id="83f60-122">These are your class properties.</span></span>
-   <span data-ttu-id="83f60-123">Déterminez le type d’action qu’un client peut souhaiter effectuer avec chaque objet gérable.</span><span class="sxs-lookup"><span data-stu-id="83f60-123">Determine which kind of actions a customer may want to perform with each manageable object.</span></span> <span data-ttu-id="83f60-124">Il s’agit de vos méthodes.</span><span class="sxs-lookup"><span data-stu-id="83f60-124">These are your methods.</span></span>

## <a name="implementing-a-model-for-a-manageable-object"></a><span data-ttu-id="83f60-125">Implémentation d’un modèle pour un objet gérable</span><span class="sxs-lookup"><span data-stu-id="83f60-125">Implementing a Model for a Manageable Object</span></span>

<span data-ttu-id="83f60-126">Pour implémenter un modèle d’objets gérables, créez un fichier MOF contenant une classe WMI qui représente chaque objet.</span><span class="sxs-lookup"><span data-stu-id="83f60-126">To implement a model for manageable objects, create a MOF file containing a WMI class that represents each object.</span></span> <span data-ttu-id="83f60-127">Pour plus d’informations sur la création d’un fichier MOF pour définir des classes WMI, consultez [conception de classes format MOF (MOF)](designing-managed-object-format--mof--classes.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-127">For more information about creating a MOF file to define WMI classes, see [Designing Managed Object Format (MOF) Classes](designing-managed-object-format--mof--classes.md).</span></span> <span data-ttu-id="83f60-128">L’inscription du fournisseur et de ses classes est généralement incluse dans le fichier MOF, bien qu’il soit possible d’utiliser l' [API com](com-api-for-wmi.md) pour créer des classes et des méthodes.</span><span class="sxs-lookup"><span data-stu-id="83f60-128">The registration of the provider and its classes are usually included in the MOF file, although it is possible to use the [COM API](com-api-for-wmi.md) to create classes and methods.</span></span> <span data-ttu-id="83f60-129">Pour plus d’informations, consultez [développement d’un fournisseur WMI](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-129">For more information, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

> [!Note]  
> <span data-ttu-id="83f60-130">Pour vous assurer que toutes les définitions de classe WMI pour les objets managés sont restaurées dans l' [*espace de stockage WMI*](gloss-w.md) en cas d’échec et de redémarrage de WMI, utilisez l’instruction [**\# pragma AutoRecover**](pragma-autorecover.md) de préprocesseur dans votre fichier [*format MOF (MOF)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="83f60-130">To ensure that all your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

 

<span data-ttu-id="83f60-131">Après avoir créé le fichier MOF, compilez-le à l’aide de l’outil [**Mofcomp.exe**](mofcomp.md) .</span><span class="sxs-lookup"><span data-stu-id="83f60-131">After you create the MOF file, compile it using the [**Mofcomp.exe**](mofcomp.md) tool.</span></span> <span data-ttu-id="83f60-132">Cela vous avertit des erreurs dans votre fichier MOF et ajoute la classe WMI définie dans le fichier MOF à l' [*espace de stockage WMI*](gloss-w.md) afin que la classe puisse être utilisée par un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="83f60-132">This notifies you of errors in your MOF file, and adds the WMI class defined in the MOF file to the [*WMI repository*](gloss-w.md) so that the class can be used by a provider.</span></span>

## <a name="determining-a-provider-type-to-implement"></a><span data-ttu-id="83f60-133">Détermination d’un type de fournisseur à implémenter</span><span class="sxs-lookup"><span data-stu-id="83f60-133">Determining a Provider Type to Implement</span></span>

<span data-ttu-id="83f60-134">WMI prend en charge un certain nombre de types de fournisseurs, ce qui détermine la nature des informations fournies et les opérations prises en charge par les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="83f60-134">WMI supports a certain number of provider types, which determines the nature of the information delivered and operations supported by the providers.</span></span>

<span data-ttu-id="83f60-135">Les types de fournisseurs sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="83f60-135">The provider types are:</span></span>

-   [<span data-ttu-id="83f60-136">*Fournisseur d’instance*</span><span class="sxs-lookup"><span data-stu-id="83f60-136">*Instance provider*</span></span>](gloss-i.md)
-   [<span data-ttu-id="83f60-137">*Fournisseur de méthode*</span><span class="sxs-lookup"><span data-stu-id="83f60-137">*Method provider*</span></span>](gloss-m.md)
-   [<span data-ttu-id="83f60-138">*Fournisseur de propriétés*</span><span class="sxs-lookup"><span data-stu-id="83f60-138">*Property provider*</span></span>](gloss-p.md)
-   <span data-ttu-id="83f60-139">Fournisseur de classes</span><span class="sxs-lookup"><span data-stu-id="83f60-139">Class provider</span></span>
-   [<span data-ttu-id="83f60-140">*Fournisseur d’événements*</span><span class="sxs-lookup"><span data-stu-id="83f60-140">*Event provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="83f60-141">*Fournisseur de consommateur d’événements*</span><span class="sxs-lookup"><span data-stu-id="83f60-141">*Event consumer provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="83f60-142">*Fournisseur d’associations*</span><span class="sxs-lookup"><span data-stu-id="83f60-142">*Association provider*</span></span>](gloss-a.md)

<span data-ttu-id="83f60-143">La plupart des fournisseurs sont des fournisseurs d’instances et des fournisseurs de méthodes.</span><span class="sxs-lookup"><span data-stu-id="83f60-143">The vast majority of providers are instance providers and method providers.</span></span> <span data-ttu-id="83f60-144">Un fournisseur d’instances est le fournisseur le plus courant et fournit les instances d’une classe donnée.</span><span class="sxs-lookup"><span data-stu-id="83f60-144">An instance provider is the most common provider, and it supplies the instances of a given class.</span></span> <span data-ttu-id="83f60-145">Un fournisseur de méthode implémente les méthodes d’une ou plusieurs classes.</span><span class="sxs-lookup"><span data-stu-id="83f60-145">A method provider implements the methods of one or more classes.</span></span> <span data-ttu-id="83f60-146">Pour plus d’informations sur les types de fournisseurs, consultez [développement d’un fournisseur WMI](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-146">For more information about the types of providers, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

## <a name="determining-a-hosting-implementation-model-for-a-provider"></a><span data-ttu-id="83f60-147">Détermination d’un modèle d’hébergement (implémentation) pour un fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-147">Determining a Hosting (Implementation) Model for a Provider</span></span>

<span data-ttu-id="83f60-148">Les fournisseurs WMI sont des binaires implémentés en tant qu’objets COM.</span><span class="sxs-lookup"><span data-stu-id="83f60-148">WMI providers are binaries implemented as COM objects.</span></span> <span data-ttu-id="83f60-149">Cela signifie que chaque fournisseur a un fichier DLL qui peut être exécuté dans un processus et un contexte de sécurité spécifiques.</span><span class="sxs-lookup"><span data-stu-id="83f60-149">This means that each provider has a DLL file which can be executed within a specific process and security context.</span></span> <span data-ttu-id="83f60-150">C’est ce que WMI fait référence en tant que [*modèle d’hébergement*](gloss-h.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-150">This is what WMI refers to as the [*hosting model*](gloss-h.md).</span></span> <span data-ttu-id="83f60-151">WMI offre différentes manières d’héberger des fournisseurs, mais l’approche la plus courante consiste à utiliser le modèle de fournisseur couplé (exécuté sous le processus WMI) dans le contexte de sécurité NetworkServiceHost.</span><span class="sxs-lookup"><span data-stu-id="83f60-151">WMI offers various ways to host providers, but the most common approach is to use the coupled provider model (running under the WMI process) in the NetworkServiceHost security context.</span></span> <span data-ttu-id="83f60-152">Un fournisseur WMI peut être classé comme étant couplé ou [*découplé*](gloss-d.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-152">A WMI provider can be classified as either coupled or [*decoupled*](gloss-d.md).</span></span>

<span data-ttu-id="83f60-153">Le terme fournisseur couplé ou découplé détermine sous quel processus hôte le fournisseur s’exécute en ce qui concerne le processus WMI fourni WMIPRVSE.EXE processus.</span><span class="sxs-lookup"><span data-stu-id="83f60-153">The term coupled or decoupled provider determines under which host process the provider is running with respect to the WMI provided WMIPRVSE.EXE process.</span></span> <span data-ttu-id="83f60-154">Il est recommandé de déterminer si les données de gestion que le fournisseur expose et l’API ou l’application sur laquelle il s’appuie sont toujours disponibles dans le système ou non.</span><span class="sxs-lookup"><span data-stu-id="83f60-154">A best practice is to determine if the management data that the provider exposes and the API or application it relies on are always available in the system or not.</span></span> <span data-ttu-id="83f60-155">Si l’API ou l’application sur laquelle le fournisseur s’appuie est toujours disponible (en cours d’exécution sur le système), le fournisseur doit être un fournisseur couplé, sinon, il doit s’agir d’un fournisseur découplé.</span><span class="sxs-lookup"><span data-stu-id="83f60-155">If the API or application the provider relies on is always available (running on the system), then the provider should be a coupled provider, if not, it must be a decoupled provider.</span></span> <span data-ttu-id="83f60-156">Pour plus d’informations sur les modèles d’hébergement, consultez [hébergement et sécurité du fournisseur](provider-hosting-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-156">For more information about hosting models, see [Provider Hosting and Security](provider-hosting-and-security.md).</span></span>

<span data-ttu-id="83f60-157">Pour plus d’informations sur la création d’un fournisseur couplé, consultez [fourniture de données à WMI en écrivant un fournisseur](supplying-data-to-wmi-by-writing-a-provider.md)et pour plus d’informations sur l’incorporation d’un fournisseur découplé dans une application, consultez [incorporation d’un fournisseur dans une application](incorporating-a-provider-in-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-157">For more information about creating a coupled provider, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md), and for information about incorporating a decoupled provider in an application, see [Incorporating a Provider in an Application](incorporating-a-provider-in-an-application.md).</span></span>

<span data-ttu-id="83f60-158">Les fournisseurs couplés peuvent être décrits comme in-process (in-proc) ou out-of-process (out-of-proc).</span><span class="sxs-lookup"><span data-stu-id="83f60-158">Coupled providers can be described as in-process (in-proc) or out-of-process (out-of-proc).</span></span> <span data-ttu-id="83f60-159">Lorsqu’un fournisseur couplé est un fournisseur in-proc, il s’exécute sous un processus d’hébergement WMIPRVSE.EXE WMI partagé et est implémenté en tant que serveur COM in-proc (. dll).</span><span class="sxs-lookup"><span data-stu-id="83f60-159">When a coupled provider is an in-proc provider, it runs under a shared WMIPRVSE.EXE WMI hosting process and is implemented as a COM in-proc server (.dll).</span></span> <span data-ttu-id="83f60-160">Lorsqu’un fournisseur est un fournisseur hors processus, il est démarré par WMI à la demande d’un client ou d’un événement, mais il s’exécute en tant que processus séparé et est implémenté en tant qu’exécutable (. exe).</span><span class="sxs-lookup"><span data-stu-id="83f60-160">When a provider is an out-of-proc provider, it is started by WMI on request of a client or event, but it runs as a separated process and is implemented as an executable (.exe).</span></span>

## <a name="implementing-a-provider"></a><span data-ttu-id="83f60-161">Implémentation d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-161">Implementing a Provider</span></span>

<span data-ttu-id="83f60-162">Un fournisseur peut être implémenté des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="83f60-162">A provider can be implemented in the following ways:</span></span>

-   <span data-ttu-id="83f60-163">À l’aide de l’Assistant ATL dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="83f60-163">Using the ATL Wizard in Visual Studio.</span></span>

    <span data-ttu-id="83f60-164">L’Assistant ATL génère du code fournisseur qui implémente un fournisseur couplé.</span><span class="sxs-lookup"><span data-stu-id="83f60-164">The ATL Wizard generates provider code that implements a coupled provider.</span></span> <span data-ttu-id="83f60-165">Lors de l’utilisation de l’Assistant ATL, vous pouvez spécifier que vous souhaitez créer un modèle d’exécution de fournisseur in-proc (. dll) ou out-of-proc (. exe).</span><span class="sxs-lookup"><span data-stu-id="83f60-165">While using the ATL Wizard, you can specify that you want to create an in-proc (.dll) or out-of-proc (.exe) provider run-time model.</span></span>

-   <span data-ttu-id="83f60-166">Définition d’un objet COM pour contenir votre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="83f60-166">Defining a COM object to contain your provider.</span></span>

    <span data-ttu-id="83f60-167">Le code du fournisseur est écrit en C++.</span><span class="sxs-lookup"><span data-stu-id="83f60-167">The provider code is written in C++.</span></span> <span data-ttu-id="83f60-168">Pour plus d’informations, consultez [fourniture de données à WMI en écrivant un fournisseur](supplying-data-to-wmi-by-writing-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-168">For more information, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md).</span></span>

-   <span data-ttu-id="83f60-169">Utilisation des classes de l’espace de noms [**Microsoft. Management. infrastructure**](/previous-versions//hh872326(v=vs.85)) dans le .NET Framework pour créer un fournisseur à l’aide de code managé.</span><span class="sxs-lookup"><span data-stu-id="83f60-169">Using the classes in the [**Microsoft.Management.Infrastructure**](/previous-versions//hh872326(v=vs.85)) namespace in the .NET Framework to create a provider using managed code.</span></span> <span data-ttu-id="83f60-170">(L’espace de noms **System. Management. Instrumentation** n’est plus pris en charge.)</span><span class="sxs-lookup"><span data-stu-id="83f60-170">(The **System.Management.Instrumentation** namespace is no longer supported.)</span></span>

    <span data-ttu-id="83f60-171">Ce processus crée un fournisseur découplé.</span><span class="sxs-lookup"><span data-stu-id="83f60-171">This process creates a decoupled provider.</span></span>

## <a name="registering-a-provider-with-wmi-and-the-system"></a><span data-ttu-id="83f60-172">Inscription d’un fournisseur avec WMI et le système</span><span class="sxs-lookup"><span data-stu-id="83f60-172">Registering a Provider with WMI and the System</span></span>

<span data-ttu-id="83f60-173">Avant d’utiliser le fournisseur d’un consommateur, il est important de l’inscrire auprès du système WMI et du sous-système Windows COM.</span><span class="sxs-lookup"><span data-stu-id="83f60-173">Before using the provider from a consumer, it is important to register it with the WMI system and the Windows COM subsystem.</span></span>

<span data-ttu-id="83f60-174">Un fichier MOF peut contenir plusieurs types de fournisseurs pour les mêmes classes.</span><span class="sxs-lookup"><span data-stu-id="83f60-174">A MOF file can contain multiple types of providers for the same classes.</span></span> <span data-ttu-id="83f60-175">Le même nom de fournisseur est enregistré sous la forme, par exemple, d’une instance ou d’un fournisseur de méthode.</span><span class="sxs-lookup"><span data-stu-id="83f60-175">The same provider name is registered as, for example, an instance or a method provider.</span></span> <span data-ttu-id="83f60-176">Pour plus d’informations, consultez [inscription d’un fournisseur](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-176">For more information, see [Registering a Provider](registering-a-provider.md).</span></span>

## <a name="testing-a-provider"></a><span data-ttu-id="83f60-177">Test d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-177">Testing a Provider</span></span>

<span data-ttu-id="83f60-178">Lorsque le code du fournisseur est inscrit, il est important de tester correctement le fournisseur à l’aide du fournisseur de différents consommateurs (par exemple, des scripts, du code managé .NET et des consommateurs C++).</span><span class="sxs-lookup"><span data-stu-id="83f60-178">When the provider code is registered, it is important to properly test the provider by using the provider from different consumers (for example, scripts, .NET managed code, and C++ consumers).</span></span>

<span data-ttu-id="83f60-179">Effectuez les tâches suivantes pour tester votre fournisseur :</span><span class="sxs-lookup"><span data-stu-id="83f60-179">Perform the following tasks to test your provider:</span></span>

-   <span data-ttu-id="83f60-180">Assurez-vous que votre fournisseur se charge correctement en suivant les notifications d’événements [**msft \_ wmiprovider \_ OperationEvent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) .</span><span class="sxs-lookup"><span data-stu-id="83f60-180">Ensure that your provider is loading properly by tracking the [**MSFT\_WmiProvider\_OperationEvent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) event notifications.</span></span> <span data-ttu-id="83f60-181">Ces événements vous informent des échecs de chargement du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="83f60-181">These events will inform you about any provider load failures.</span></span> <span data-ttu-id="83f60-182">Les autres classes de dépannage qui peuvent être utiles sont [**Win32 \_ ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) et [**Win32 \_ ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span><span class="sxs-lookup"><span data-stu-id="83f60-182">Other troubleshooting classes that may be helpful are [**Win32\_ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) and [**Win32\_ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span></span> <span data-ttu-id="83f60-183">Pour plus d’informations sur les fournisseurs de dépannage, consultez [débogage des fournisseurs](debugging-providers.md) et [des classes de dépannage et de configuration du fournisseur](provider-configuration-and-troubleshooting-classes.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-183">For more information about troubleshooting providers, see [Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md).</span></span>
-   <span data-ttu-id="83f60-184">Si le fournisseur est un fournisseur d’instances ou de méthodes, veillez à tester chaque fonctionnalité de fournisseur une par une pour éviter toute confusion dans la logique de votre code.</span><span class="sxs-lookup"><span data-stu-id="83f60-184">If the provider is an instance or method provider, ensure you test each provider capability one-by-one to avoid confusion in following your code logic.</span></span>
-   <span data-ttu-id="83f60-185">Pour un fournisseur d’instance, créez une application cliente ou un script qui appelle chaque interface du fournisseur (énumération, obtenir, placer et supprimer).</span><span class="sxs-lookup"><span data-stu-id="83f60-185">For an instance provider, create a client application or script that invokes every interface of the provider (enumeration, get, put, and delete).</span></span> <span data-ttu-id="83f60-186">Même si le fournisseur n’est pas censé implémenter quoi que ce soit, il doit retourner un message « non pris en charge ».</span><span class="sxs-lookup"><span data-stu-id="83f60-186">Even if the provider is not supposed to implement anything, it should return a "not supported" message.</span></span> <span data-ttu-id="83f60-187">Vous pouvez trouver les valeurs de retour déjà définies dans les [codes de retour WMI](wmi-return-codes.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-187">You can find the return values already defined in [WMI Return Codes](wmi-return-codes.md).</span></span>
-   <span data-ttu-id="83f60-188">Pour vous assurer que le contexte de sécurité souhaité fonctionne comme prévu, appelez les opérations prises en charge par le fournisseur à partir d’un contexte de sécurité non administrateur.</span><span class="sxs-lookup"><span data-stu-id="83f60-188">To ensure that the desired security context is working as planned, invoke the provider supported operations from a nonadministrator security context.</span></span> <span data-ttu-id="83f60-189">Le fournisseur doit prendre en charge l’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="83f60-189">The provider must support impersonation.</span></span> <span data-ttu-id="83f60-190">Si un utilisateur qui ne dispose pas des informations d’identification de sécurité appropriées tente de mettre à jour des données ou d’effectuer une opération qui exécute une méthode, votre fournisseur doit refuser l’accès avec le message d’erreur approprié.</span><span class="sxs-lookup"><span data-stu-id="83f60-190">If a user lacking the correct security credentials tries to update data or perform an operation that executes a method, your provider should deny access with the appropriate error message.</span></span>
-   <span data-ttu-id="83f60-191">Pour plus d’informations sur la sécurité du fournisseur, consultez [sécurisation de votre fournisseur](securing-your-provider.md).</span><span class="sxs-lookup"><span data-stu-id="83f60-191">For more information about provider security, see [Securing Your Provider](securing-your-provider.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="83f60-192">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="83f60-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="83f60-193">Développement d’un fournisseur WMI</span><span class="sxs-lookup"><span data-stu-id="83f60-193">Developing a WMI Provider</span></span>](developing-a-wmi-provider.md)
</dt> <dt>

[<span data-ttu-id="83f60-194">Hébergement et sécurité du fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-194">Provider Hosting and Security</span></span>](provider-hosting-and-security.md)
</dt> <dt>

[<span data-ttu-id="83f60-195">Fourniture de données à WMI en écrivant un fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-195">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)
</dt> <dt>

[<span data-ttu-id="83f60-196">Incorporation d’un fournisseur dans une application</span><span class="sxs-lookup"><span data-stu-id="83f60-196">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)
</dt> <dt>

[<span data-ttu-id="83f60-197">Inscription d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-197">Registering a Provider</span></span>](registering-a-provider.md)
</dt> <dt>

[<span data-ttu-id="83f60-198">Résolution des problèmes des applications clientes WMI</span><span class="sxs-lookup"><span data-stu-id="83f60-198">Troubleshooting WMI Client Applications</span></span>](troubleshooting-wmi-client-applications.md)
</dt> <dt>

[<span data-ttu-id="83f60-199">Sécurisation de votre fournisseur</span><span class="sxs-lookup"><span data-stu-id="83f60-199">Securing Your Provider</span></span>](securing-your-provider.md)
</dt> <dt>

[<span data-ttu-id="83f60-200">Obtention et fourniture de données sur une plateforme 64 bits</span><span class="sxs-lookup"><span data-stu-id="83f60-200">Getting and Providing Data on a 64-bit Platform</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)
</dt> </dl>

 

 
