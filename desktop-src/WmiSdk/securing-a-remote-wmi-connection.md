---
description: Pour vous connecter à un ordinateur distant à l’aide de WMI, vérifiez que les paramètres DCOM et les paramètres de sécurité de l’espace de noms WMI corrects sont activés pour la connexion.
ms.assetid: 96ebaa9b-a062-4300-a637-8eb71cb80d1c
ms.tgt_platform: multiple
title: Sécurisation d’une connexion WMI à distance
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df2a044e49fed5eaa27fbc246dca3306a6c29650
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104528497"
---
# <a name="securing-a-remote-wmi-connection"></a><span data-ttu-id="31c3c-103">Sécurisation d’une connexion WMI à distance</span><span class="sxs-lookup"><span data-stu-id="31c3c-103">Securing a Remote WMI Connection</span></span>

<span data-ttu-id="31c3c-104">Pour vous connecter à un ordinateur distant à l’aide de WMI, vérifiez que les paramètres DCOM et les paramètres de sécurité de l’espace de noms WMI corrects sont activés pour la connexion.</span><span class="sxs-lookup"><span data-stu-id="31c3c-104">To connect to a remote computer using WMI, ensure that the correct DCOM settings and WMI namespace security settings are enabled for the connection.</span></span>

<span data-ttu-id="31c3c-105">WMI possède les paramètres d’emprunt d’identité, d’authentification et de service d’authentification (NTLM ou Kerberos) par défaut requis par l’ordinateur cible dans une connexion à distance.</span><span class="sxs-lookup"><span data-stu-id="31c3c-105">WMI has default impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the target computer in a remote connection requires.</span></span> <span data-ttu-id="31c3c-106">Votre ordinateur local peut utiliser des valeurs par défaut différentes que le système cible n’accepte pas.</span><span class="sxs-lookup"><span data-stu-id="31c3c-106">Your local machine may use different defaults that the target system does not accept.</span></span> <span data-ttu-id="31c3c-107">Vous pouvez modifier ces paramètres dans l’appel de connexion.</span><span class="sxs-lookup"><span data-stu-id="31c3c-107">You can change these settings in the connection call.</span></span>

<span data-ttu-id="31c3c-108">Les sections suivantes sont présentées dans cette rubrique :</span><span class="sxs-lookup"><span data-stu-id="31c3c-108">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="31c3c-109">Paramètres d’emprunt d’identité et d’authentification DCOM pour WMI</span><span class="sxs-lookup"><span data-stu-id="31c3c-109">DCOM Impersonation and Authentication Settings for WMI</span></span>](#dcom-impersonation-and-authentication-settings-for-wmi)
-   [<span data-ttu-id="31c3c-110">Définition de la sécurité DCOM pour autoriser un utilisateur à accéder à distance à un ordinateur</span><span class="sxs-lookup"><span data-stu-id="31c3c-110">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>](#setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely)
-   [<span data-ttu-id="31c3c-111">Autoriser les utilisateurs à accéder à un espace de noms WMI spécifique</span><span class="sxs-lookup"><span data-stu-id="31c3c-111">Allowing Users Access to a Specific WMI Namespace</span></span>](#allowing-users-access-to-a-specific-wmi-namespace)
-   [<span data-ttu-id="31c3c-112">Définition de la sécurité des espaces de noms pour exiger le chiffrement des données pour les connexions à distance</span><span class="sxs-lookup"><span data-stu-id="31c3c-112">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>](#setting-namespace-security-to-require-data-encryption-for-remote-connections)
-   [<span data-ttu-id="31c3c-113">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="31c3c-113">Related topics</span></span>](#related-topics)

## <a name="dcom-impersonation-and-authentication-settings-for-wmi"></a><span data-ttu-id="31c3c-114">Paramètres d’emprunt d’identité et d’authentification DCOM pour WMI</span><span class="sxs-lookup"><span data-stu-id="31c3c-114">DCOM Impersonation and Authentication Settings for WMI</span></span>

<span data-ttu-id="31c3c-115">WMI possède les paramètres d’emprunt d’identité DCOM par défaut, d’authentification et de service d’authentification (NTLM ou Kerberos) requis par le système distant.</span><span class="sxs-lookup"><span data-stu-id="31c3c-115">WMI has default DCOM impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the a remote system requires.</span></span> <span data-ttu-id="31c3c-116">Votre système local peut utiliser des valeurs par défaut différentes de celles que le système distant cible n’accepte pas.</span><span class="sxs-lookup"><span data-stu-id="31c3c-116">Your local system may use different defaults that the target remote system does not accept.</span></span> <span data-ttu-id="31c3c-117">Vous pouvez modifier ces paramètres dans l’appel de connexion.</span><span class="sxs-lookup"><span data-stu-id="31c3c-117">You can change these settings in the connection call.</span></span> <span data-ttu-id="31c3c-118">Pour plus d’informations, consultez Définition de la [sécurité des processus d’application cliente](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="31c3c-118">For more information, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span> <span data-ttu-id="31c3c-119">Toutefois, pour le service d’authentification, il est recommandé de spécifier **la \_ \_ \_ valeur par défaut RPC C Authn** et de permettre à DCOM de choisir le service approprié pour l’ordinateur cible.</span><span class="sxs-lookup"><span data-stu-id="31c3c-119">However, for the authentication service, it is recommended that you specify **RPC\_C\_AUTHN\_DEFAULT** and allow DCOM to choose the appropriate service for the target computer.</span></span>

<span data-ttu-id="31c3c-120">Vous pouvez fournir des paramètres dans les paramètres pour les appels à [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) ou [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) en C++.</span><span class="sxs-lookup"><span data-stu-id="31c3c-120">You can supply settings in parameters for the calls to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) or [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) in C++.</span></span> <span data-ttu-id="31c3c-121">Dans les scripts, vous pouvez établir des paramètres de sécurité dans les appels à [**SWbemLocator. ConnectServer**](swbemlocator-connectserver.md), dans un objet [**SWbemSecurity**](swbemsecurity.md) ou dans la chaîne de [moniker](constructing-a-moniker-string.md) de script.</span><span class="sxs-lookup"><span data-stu-id="31c3c-121">In scripts, you can establish security settings in calls to [**SWbemLocator.ConnectServer**](swbemlocator-connectserver.md), in an [**SWbemSecurity**](swbemsecurity.md) object, or in the scripting [moniker](constructing-a-moniker-string.md) string.</span></span>

<span data-ttu-id="31c3c-122">Pour obtenir la liste de toutes les constantes d’emprunt d’identité C++, consultez [définition du niveau de sécurité de processus par défaut à l’aide de C++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="31c3c-122">For a list of all the C++ impersonation constants, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span> <span data-ttu-id="31c3c-123">Pour plus d’Visual Basic les constantes et les chaînes de script pour l’utilisation de la connexion moniker, consultez [définition du niveau de sécurité de processus par défaut à l’aide de VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="31c3c-123">For the Visual Basic constants and scripting strings for using the moniker connection, see [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

<span data-ttu-id="31c3c-124">Le tableau suivant répertorie les paramètres d’emprunt d’identité, d’authentification et de service d’authentification DCOM par défaut requis par l’ordinateur cible (ordinateur B) dans une connexion à distance.</span><span class="sxs-lookup"><span data-stu-id="31c3c-124">The following table lists the default DCOM impersonation, authentication, and authentication service settings required by the target computer (Computer B) in a remote connection.</span></span> <span data-ttu-id="31c3c-125">Pour plus d’informations, consultez Sécurisation d’une connexion WMI à distance.</span><span class="sxs-lookup"><span data-stu-id="31c3c-125">For more information, see Securing a Remote WMI Connection.</span></span>



| <span data-ttu-id="31c3c-126">Système d’exploitation ordinateur B</span><span class="sxs-lookup"><span data-stu-id="31c3c-126">Computer B operating system</span></span> | <span data-ttu-id="31c3c-127">Chaîne de script de niveau d’emprunt d’identité</span><span class="sxs-lookup"><span data-stu-id="31c3c-127">Impersonation level scripting string</span></span> | <span data-ttu-id="31c3c-128">Chaîne de script de niveau d’authentification</span><span class="sxs-lookup"><span data-stu-id="31c3c-128">Authentication level scripting string</span></span> | <span data-ttu-id="31c3c-129">Service d’authentification</span><span class="sxs-lookup"><span data-stu-id="31c3c-129">Authentication service</span></span> |
|-----------------------------|--------------------------------------|---------------------------------------|------------------------|
| <span data-ttu-id="31c3c-130">Windows Vista ou version ultérieure ;</span><span class="sxs-lookup"><span data-stu-id="31c3c-130">Windows Vista or later</span></span>      | <span data-ttu-id="31c3c-131">Impersonate</span><span class="sxs-lookup"><span data-stu-id="31c3c-131">Impersonate</span></span>                          | <span data-ttu-id="31c3c-132">PKT</span><span class="sxs-lookup"><span data-stu-id="31c3c-132">Pkt</span></span>                                   | <span data-ttu-id="31c3c-133">Kerberos</span><span class="sxs-lookup"><span data-stu-id="31c3c-133">Kerberos</span></span>               |



 

<span data-ttu-id="31c3c-134">Les connexions à distance WMI sont affectées par [le contrôle de compte d’utilisateur (UAC) et le](/previous-versions/aa905108(v=msdn.10)) [pare-feu Windows](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span><span class="sxs-lookup"><span data-stu-id="31c3c-134">WMI remote connections are affected by [User Account Control (UAC)](/previous-versions/aa905108(v=msdn.10)) and [Windows Firewall](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span></span> <span data-ttu-id="31c3c-135">Pour plus d’informations, consultez [connexion à WMI à distance à partir de Vista](connecting-to-wmi-remotely-starting-with-vista.md) et [connexion via le pare-feu Windows](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span><span class="sxs-lookup"><span data-stu-id="31c3c-135">For more information, see [Connecting to WMI Remotely Starting with Vista](connecting-to-wmi-remotely-starting-with-vista.md) and [Connecting Through Windows Firewall](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span></span>

<span data-ttu-id="31c3c-136">N’oubliez pas que la connexion à WMI sur l’ordinateur local a le niveau d’authentification par défaut **PktPrivacy**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-136">Be aware that connecting to WMI on the local computer has a default authentication level of **PktPrivacy**.</span></span>

## <a name="setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely"></a><span data-ttu-id="31c3c-137">Définition de la sécurité DCOM pour autoriser un utilisateur à accéder à distance à un ordinateur</span><span class="sxs-lookup"><span data-stu-id="31c3c-137">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>

<span data-ttu-id="31c3c-138">La sécurité dans WMI est liée à la connexion à un espace de noms WMI.</span><span class="sxs-lookup"><span data-stu-id="31c3c-138">Security in WMI is related to connecting to a WMI namespace.</span></span> <span data-ttu-id="31c3c-139">WMI utilise DCOM pour gérer les appels distants.</span><span class="sxs-lookup"><span data-stu-id="31c3c-139">WMI uses DCOM to handle remote calls.</span></span> <span data-ttu-id="31c3c-140">L’échec de la connexion à un ordinateur distant est dû à une défaillance DCOM (erreur « accès DCOM refusé » décimal-2147024891 ou Hex 0x80070005).</span><span class="sxs-lookup"><span data-stu-id="31c3c-140">One reason for failure to connect to a remote computer is due to a DCOM failure (error "DCOM Access Denied" decimal -2147024891 or hex 0x80070005).</span></span> <span data-ttu-id="31c3c-141">Pour plus d’informations sur la sécurité DCOM dans WMI pour les applications C++, consultez Définition de la [sécurité des processus d’application cliente](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="31c3c-141">For more information about DCOM security in WMI for C++ applications, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span>

<span data-ttu-id="31c3c-142">Vous pouvez configurer les paramètres DCOM pour WMI à l’aide de l’utilitaire de configuration DCOM (**DCOMCnfg.exe**) disponible dans **Outils d’administration** dans le **panneau** de configuration.</span><span class="sxs-lookup"><span data-stu-id="31c3c-142">You can configure DCOM settings for WMI using the DCOM Config utility (**DCOMCnfg.exe**) found in **Administrative Tools** in **Control Panel**.</span></span> <span data-ttu-id="31c3c-143">Cet utilitaire expose les paramètres qui permettent à certains utilisateurs de se connecter à l’ordinateur à distance via DCOM.</span><span class="sxs-lookup"><span data-stu-id="31c3c-143">This utility exposes the settings that enable certain users to connect to the computer remotely through DCOM.</span></span> <span data-ttu-id="31c3c-144">Les membres du groupe administrateurs sont autorisés à se connecter à distance à l’ordinateur par défaut.</span><span class="sxs-lookup"><span data-stu-id="31c3c-144">Members of the Administrators group are allowed to remotely connect to the computer by default.</span></span> <span data-ttu-id="31c3c-145">Avec cet utilitaire, vous pouvez définir la sécurité pour démarrer, accéder et configurer le service WMI.</span><span class="sxs-lookup"><span data-stu-id="31c3c-145">With this utility you can set the security to start, access, and configure the WMI service.</span></span>

<span data-ttu-id="31c3c-146">La procédure suivante décrit comment accorder des autorisations de démarrage et d’activation à distance DCOM pour certains utilisateurs et groupes.</span><span class="sxs-lookup"><span data-stu-id="31c3c-146">The following procedure describes how to grant DCOM remote startup and activation permissions for certain users and groups.</span></span> <span data-ttu-id="31c3c-147">Si l’ordinateur A se connecte à distance à l’ordinateur B, vous pouvez définir ces autorisations sur l’ordinateur B pour autoriser un utilisateur ou un groupe qui ne fait pas partie du groupe Administrateurs sur l’ordinateur B à exécuter les appels de démarrage et d’activation DCOM sur l’ordinateur B.</span><span class="sxs-lookup"><span data-stu-id="31c3c-147">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to execute DCOM startup and activation calls on Computer B.</span></span>

<span data-ttu-id="31c3c-148">**Pour accorder des autorisations d’activation et de lancement à distance DCOM pour un utilisateur ou un groupe**</span><span class="sxs-lookup"><span data-stu-id="31c3c-148">**To grant DCOM remote launch and activation permissions for a user or group**</span></span>

1.  <span data-ttu-id="31c3c-149">Cliquez sur **Démarrer**, sur **exécuter**, tapez **DCOMCNFG**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-149">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="31c3c-150">Dans la boîte de dialogue **services de composants** , développez **services de composants**, développez **ordinateurs**, puis cliquez avec le bouton droit sur **poste de travail** et cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-150">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="31c3c-151">Dans la boîte de dialogue Propriétés de la **poste de travail** , cliquez sur l’onglet **sécurité com** .</span><span class="sxs-lookup"><span data-stu-id="31c3c-151">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="31c3c-152">Sous **Autorisations d'exécution et d'activation**, cliquez sur **Modifier les limites**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-152">Under **Launch and Activation Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="31c3c-153">Dans la boîte de dialogue **autorisation d’exécution** , procédez comme suit si votre nom ou votre groupe n’apparaît pas dans la **Liste groupes ou noms d’utilisateurs**:</span><span class="sxs-lookup"><span data-stu-id="31c3c-153">In the **Launch Permission** dialog box, follow these steps if your name or your group does not appear in the **Groups or user names list**:</span></span>

    1.  <span data-ttu-id="31c3c-154">Dans la boîte de dialogue **autorisation d’exécution** , cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-154">In the **Launch Permission** dialog box, click **Add**.</span></span>
    2.  <span data-ttu-id="31c3c-155">Dans la boîte de dialogue **Sélectionner les utilisateurs, les ordinateurs ou les groupes** , ajoutez votre nom et le groupe dans la zone **Entrez les noms des objets à sélectionner** , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-155">In the **Select Users, Computers, or Groups** dialog box, add your name and the group in the **Enter the object names to select** box, and then click **OK**.</span></span>

6.  <span data-ttu-id="31c3c-156">Dans la boîte de dialogue **autorisation d’exécution** , sélectionnez votre utilisateur et votre groupe dans la zone **noms de groupes ou d’utilisateurs** .</span><span class="sxs-lookup"><span data-stu-id="31c3c-156">In the **Launch Permission** dialog box, select your user and group in the **Group or user names** box.</span></span> <span data-ttu-id="31c3c-157">Dans la **colonne autoriser** , **sous autorisations pour utilisateur**, sélectionnez **exécution à distance** et sélectionnez **activation à distance**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-157">In the **Allow** column under **Permissions for User**, select **Remote Launch** and select **Remote Activation**, and then click **OK**.</span></span>

<span data-ttu-id="31c3c-158">La procédure suivante décrit comment accorder des autorisations d’accès à distance DCOM pour certains utilisateurs et groupes.</span><span class="sxs-lookup"><span data-stu-id="31c3c-158">The following procedure describes how to grant DCOM remote access permissions for certain users and groups.</span></span> <span data-ttu-id="31c3c-159">Si l’ordinateur A se connecte à distance à l’ordinateur B, vous pouvez définir ces autorisations sur l’ordinateur B pour autoriser un utilisateur ou un groupe qui ne fait pas partie du groupe Administrateurs sur l’ordinateur B à se connecter à l’ordinateur B.</span><span class="sxs-lookup"><span data-stu-id="31c3c-159">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to connect to Computer B.</span></span>

<span data-ttu-id="31c3c-160">**Pour accorder des autorisations d’accès à distance DCOM**</span><span class="sxs-lookup"><span data-stu-id="31c3c-160">**To grant DCOM remote access permissions**</span></span>

1.  <span data-ttu-id="31c3c-161">Cliquez sur **Démarrer**, sur **exécuter**, tapez **DCOMCNFG**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-161">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="31c3c-162">Dans la boîte de dialogue **services de composants** , développez **services de composants**, développez **ordinateurs**, puis cliquez avec le bouton droit sur **poste de travail** et cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-162">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="31c3c-163">Dans la boîte de dialogue Propriétés de la **poste de travail** , cliquez sur l’onglet **sécurité com** .</span><span class="sxs-lookup"><span data-stu-id="31c3c-163">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="31c3c-164">Sous **Autorisations d'accès**, cliquez sur **Modifier les limites**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-164">Under **Access Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="31c3c-165">Dans la boîte de dialogue **autorisation d’accès** , sélectionnez nom **d’ouverture de session anonyme** dans la zone **noms de groupes ou d’utilisateurs** .</span><span class="sxs-lookup"><span data-stu-id="31c3c-165">In the **Access Permission** dialog box, select **ANONYMOUS LOGON** name in the **Group or user names** box.</span></span> <span data-ttu-id="31c3c-166">Dans la colonne **autoriser** , sous **autorisations pour utilisateur**, sélectionnez **accès à distance**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-166">In the **Allow** column under **Permissions for User**, select **Remote Access**, and then click **OK**.</span></span>

## <a name="allowing-users-access-to-a-specific-wmi-namespace"></a><span data-ttu-id="31c3c-167">Autoriser les utilisateurs à accéder à un espace de noms WMI spécifique</span><span class="sxs-lookup"><span data-stu-id="31c3c-167">Allowing Users Access to a Specific WMI Namespace</span></span>

<span data-ttu-id="31c3c-168">Vous pouvez autoriser ou interdire l’accès des utilisateurs à un espace de noms WMI spécifique en définissant l’autorisation « accès à distance autorisé » dans le contrôle WMI pour un espace de noms.</span><span class="sxs-lookup"><span data-stu-id="31c3c-168">You can allow or disallow users access to a specific WMI namespace by setting the "Remote Enable" permission in the WMI Control for a namespace.</span></span> <span data-ttu-id="31c3c-169">Si un utilisateur tente de se connecter à un espace de noms auquel il n’est pas autorisé à accéder, il recevra l’erreur 0x80041003.</span><span class="sxs-lookup"><span data-stu-id="31c3c-169">If a user tries to connect to a namespace they are not allowed access to, they will receive error 0x80041003.</span></span> <span data-ttu-id="31c3c-170">Par défaut, cette autorisation est activée uniquement pour les administrateurs.</span><span class="sxs-lookup"><span data-stu-id="31c3c-170">By default, this permission is enabled only for administrators.</span></span> <span data-ttu-id="31c3c-171">Un administrateur peut activer l’accès à distance à des espaces de noms WMI spécifiques pour un utilisateur qui n’est pas administrateur.</span><span class="sxs-lookup"><span data-stu-id="31c3c-171">An administrator can enable remote access to specific WMI namespaces for a nonadministrator user.</span></span>

<span data-ttu-id="31c3c-172">La procédure suivante définit les autorisations d’activation à distance pour un utilisateur non-administrateur.</span><span class="sxs-lookup"><span data-stu-id="31c3c-172">The following procedure sets remote enable permissions for a non-administrator user.</span></span>

<span data-ttu-id="31c3c-173">**Pour définir les autorisations d’activation à distance**</span><span class="sxs-lookup"><span data-stu-id="31c3c-173">**To set remote enable permissions**</span></span>

1.  <span data-ttu-id="31c3c-174">Connectez-vous à l’ordinateur distant à l’aide du contrôle WMI.</span><span class="sxs-lookup"><span data-stu-id="31c3c-174">Connect to the remote computer using the WMI Control.</span></span>

    <span data-ttu-id="31c3c-175">Pour plus d’informations sur le contrôle WMI, consultez Définition de la [sécurité de l’espace de noms avec le contrôle WMI](setting-namespace-security-with-the-wmi-control.md).</span><span class="sxs-lookup"><span data-stu-id="31c3c-175">For more information about the WMI Control, see [Setting Namespace Security with the WMI Control](setting-namespace-security-with-the-wmi-control.md).</span></span>

2.  <span data-ttu-id="31c3c-176">Dans l’onglet **sécurité** , sélectionnez l’espace de noms, puis cliquez sur **sécurité**.</span><span class="sxs-lookup"><span data-stu-id="31c3c-176">In the **Security** tab, select the namespace and click **Security**.</span></span>
3.  <span data-ttu-id="31c3c-177">Localisez le compte approprié et cochez la case **activer à distance** dans la liste des **autorisations** .</span><span class="sxs-lookup"><span data-stu-id="31c3c-177">Locate the appropriate account and check **Remote Enable** in the **Permissions** list.</span></span>

## <a name="setting-namespace-security-to-require-data-encryption-for-remote-connections"></a><span data-ttu-id="31c3c-178">Définition de la sécurité des espaces de noms pour exiger le chiffrement des données pour les connexions à distance</span><span class="sxs-lookup"><span data-stu-id="31c3c-178">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>

<span data-ttu-id="31c3c-179">Un administrateur ou un fichier MOF peut configurer un espace de noms WMI afin qu’aucune donnée ne soit retournée, à moins que vous n’utilisiez la confidentialité du paquet (niveau d’authentification ou **PktPrivacy** en tant que moniker du **niveau d' \_ \_ authentification \_ \_ \_ C RPC** ) dans une connexion à cet espace de noms.</span><span class="sxs-lookup"><span data-stu-id="31c3c-179">An administrator or a MOF file can configure a WMI namespace so that no data is returned unless you use packet privacy (**RPC\_C\_AUTHN\_LEVEL\_PKT\_PRIVACY** or **PktPrivacy** as a moniker in a script) in a connection to that namespace.</span></span> <span data-ttu-id="31c3c-180">Cela permet de s’assurer que les données sont chiffrées lorsqu’elles traversent le réseau.</span><span class="sxs-lookup"><span data-stu-id="31c3c-180">This ensures that data is encrypted as it crosses the network.</span></span> <span data-ttu-id="31c3c-181">Si vous essayez de définir un niveau d’authentification inférieur, vous obtiendrez un message d’accès refusé.</span><span class="sxs-lookup"><span data-stu-id="31c3c-181">If you try to set a lower authentication level, you will get an access denied message.</span></span> <span data-ttu-id="31c3c-182">Pour plus d’informations, consultez [la page exiger une connexion chiffrée à un espace de noms](requiring-an-encrypted-connection-to-a-namespace.md).</span><span class="sxs-lookup"><span data-stu-id="31c3c-182">For more information, see [Requiring an Encrypted Connection to a Namespace](requiring-an-encrypted-connection-to-a-namespace.md).</span></span>

<span data-ttu-id="31c3c-183">L’exemple de code VBScript suivant montre comment se connecter à un espace de noms chiffré à l’aide de « pktPrivacy ».</span><span class="sxs-lookup"><span data-stu-id="31c3c-183">The following VBScript code example shows how to connect to an encrypted namespace using "pktPrivacy".</span></span>


```VB
strComputer = "RemoteComputer"
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" _
                              & strComputer & "\root\EncryptedNamespace")
```



## <a name="related-topics"></a><span data-ttu-id="31c3c-184">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="31c3c-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="31c3c-185">Délégation avec WMI</span><span class="sxs-lookup"><span data-stu-id="31c3c-185">Delegating with WMI</span></span>](connecting-to-a-3rd-computer-delegation.md)
</dt> <dt>

[<span data-ttu-id="31c3c-186">Création de processus à distance avec WMI</span><span class="sxs-lookup"><span data-stu-id="31c3c-186">Creating Processes Remotely with WMI</span></span>](creating-processes-remotely.md)
</dt> <dt>

[<span data-ttu-id="31c3c-187">Sécurisation des clients et des fournisseurs C++</span><span class="sxs-lookup"><span data-stu-id="31c3c-187">Securing C++ Clients and Providers</span></span>](securing-c---clients-and-providers.md)
</dt> <dt>

[<span data-ttu-id="31c3c-188">Sécurisation des clients de script</span><span class="sxs-lookup"><span data-stu-id="31c3c-188">Securing Scripting Clients</span></span>](securing-scripting-clients.md)
</dt> </dl>

 

 
