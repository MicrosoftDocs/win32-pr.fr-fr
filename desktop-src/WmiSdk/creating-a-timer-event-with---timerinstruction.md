---
description: Vous créez un événement de minuterie en créant une instance de classes dérivées de la \_ \_ classe TimerInstruction dans n’importe quel espace de noms WMI.
ms.assetid: 3df2a75a-5231-40d7-ae9d-a7a735fbf316
ms.tgt_platform: multiple
title: Création d’un événement de minuterie avec __TimerInstruction
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e502678525569dae272edb7b03c0916db25edfd0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104210212"
---
# <a name="creating-a-timer-event-with-__timerinstruction"></a><span data-ttu-id="d1ff0-103">Création d’un événement de minuterie avec \_ \_ TimerInstruction</span><span class="sxs-lookup"><span data-stu-id="d1ff0-103">Creating a Timer Event with \_\_TimerInstruction</span></span>

<span data-ttu-id="d1ff0-104">Vous créez un événement de minuterie en créant une instance de classes dérivées de la classe [**\_ \_ TimerInstruction**](--timerinstruction.md) dans n’importe quel espace de noms WMI.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-104">You create a timer event by creating an instance of classes derived from the [**\_\_TimerInstruction**](--timerinstruction.md) class in any WMI namespace.</span></span> <span data-ttu-id="d1ff0-105">WMI génère ensuite l’événement du minuteur au moment approprié.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-105">WMI then generates the timer event at the appropriate time.</span></span> <span data-ttu-id="d1ff0-106">Si vous manquez un événement de minuteur en raison d’un temps d’arrêt de l’ordinateur, WMI vous avertit de l’événement manqué.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-106">If you miss a timer event due to computer downtime, WMI notifies you about the missed event.</span></span> <span data-ttu-id="d1ff0-107">WMI prend en charge les événements de minuteur pour la compatibilité descendante et pour les scénarios où vous devez connaître le nombre d’événements manqués depuis le dernier événement remis.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-107">WMI supports timer events for backward compatibility and for scenarios where you must know how many events you have missed since the last delivered event.</span></span> <span data-ttu-id="d1ff0-108">Toutefois, pour la plupart des événements de minuterie, vous devez créer un filtre d’événements pour [**Win32 \_ localtime**](/previous-versions/windows/desktop/wmitimepprov/win32-localtime) ou [**Win32 \_ UTCTime**](/previous-versions/windows/desktop/wmitimepprov/win32-utctime).</span><span class="sxs-lookup"><span data-stu-id="d1ff0-108">For most timer events, however, you should create an event filter for [**Win32\_LocalTime**](/previous-versions/windows/desktop/wmitimepprov/win32-localtime) or [**Win32\_UTCTime**](/previous-versions/windows/desktop/wmitimepprov/win32-utctime).</span></span> <span data-ttu-id="d1ff0-109">Pour plus d’informations, consultez [création d’un événement de minuterie avec Win32 \_ localtime ou Win32 \_ UTCTime](creating-a-timer-event-with-win32-localtime-or-win32-utctime.md).</span><span class="sxs-lookup"><span data-stu-id="d1ff0-109">For more information, see [Creating a Timer Event with Win32\_LocalTime or Win32\_UTCTime](creating-a-timer-event-with-win32-localtime-or-win32-utctime.md).</span></span>

<span data-ttu-id="d1ff0-110">La procédure suivante décrit comment créer et recevoir un événement de minuterie avec \_ \_ TimerInstruction.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-110">The following procedure describes how to create and receive a timer event with \_\_TimerInstruction.</span></span>

<span data-ttu-id="d1ff0-111">**Pour créer et recevoir un événement de minuterie avec \_ \_ TimerInstruction**</span><span class="sxs-lookup"><span data-stu-id="d1ff0-111">**To create and receive a timer event with \_\_TimerInstruction**</span></span>

1.  <span data-ttu-id="d1ff0-112">Créez une instance des classes [**\_ \_ AbsoluteTimerInstruction**](--absolutetimerinstruction.md) ou [**\_ \_ IntervalTimerInstruction**](--intervaltimerinstruction.md) .</span><span class="sxs-lookup"><span data-stu-id="d1ff0-112">Create an instance of the [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) or [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) classes.</span></span>

    <span data-ttu-id="d1ff0-113">Les classes [**\_ \_ AbsoluteTimerInstruction**](--absolutetimerinstruction.md) et [**\_ \_ IntervalTimerInstruction**](--intervaltimerinstruction.md) sont dérivées de la classe [**\_ \_ TimerInstruction**](--timerinstruction.md) , qui contient une chaîne unique assignée par le développeur qui identifie le type d’événement du minuteur.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-113">The [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) and [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) classes are derived from the [**\_\_TimerInstruction**](--timerinstruction.md) class, which contains a unique developer-assigned string that identifies the type of timer event.</span></span> <span data-ttu-id="d1ff0-114">La classe **\_ \_ TimerInstruction** contient également une valeur qui spécifie si WMI doit envoyer une notification tardive si l’événement du minuteur se produit lorsque WMI n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-114">The **\_\_TimerInstruction** class also contains a value that specifies whether WMI should send a belated notification if the timer event occurs when WMI is unavailable.</span></span>

    <span data-ttu-id="d1ff0-115">Utilisez [**\_ \_ AbsoluteTimerInstruction**](--absolutetimerinstruction.md) pour envoyer des événements de minuteur absolus, qui se produisent à une date spécifique à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-115">Use [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) to send absolute timer events, which occur on a specific date at a specific time.</span></span> <span data-ttu-id="d1ff0-116">Utilisez [**\_ \_ IntervalTimerInstruction**](--intervaltimerinstruction.md) pour envoyer des événements de minuterie d’intervalle, qui se produisent régulièrement.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-116">Use [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) to send interval timer events, which occur on a regular basis.</span></span>

2.  <span data-ttu-id="d1ff0-117">Configurez votre application pour qu’elle reçoive une instance [**\_ \_ TimerEvent**](--timerevent.md) .</span><span class="sxs-lookup"><span data-stu-id="d1ff0-117">Set your application to receive a [**\_\_TimerEvent**](--timerevent.md) instance.</span></span>

    <span data-ttu-id="d1ff0-118">Pour générer un événement, WMI crée une instance de la classe [**\_ \_ TimerEvent**](--timerevent.md) et transmet l’instance à votre consommateur.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-118">To generate an event, WMI creates an instance of the [**\_\_TimerEvent**](--timerevent.md) class and forwards the instance to your consumer.</span></span> <span data-ttu-id="d1ff0-119">L’instance **\_ \_ TimerEvent** contient l’identificateur d’instruction du minuteur du consommateur.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-119">The **\_\_TimerEvent** instance contains the timer instruction identifier from the consumer.</span></span> <span data-ttu-id="d1ff0-120">L’instance contient également une valeur qui spécifie combien de fois WMI doit envoyer la notification d’événement du minuteur pendant un intervalle quelconque lorsque WMI ne peut pas atteindre le consommateur.</span><span class="sxs-lookup"><span data-stu-id="d1ff0-120">The instance also contains a value that specifies how many times WMI should send the timer event notification during any interval when WMI cannot reach the consumer.</span></span>

 

 
