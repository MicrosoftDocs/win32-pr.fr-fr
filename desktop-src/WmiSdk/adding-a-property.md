---
description: Les propriétés des classes WMI décrivent les données relatives à un objet managé.
ms.assetid: 4046bfc7-9528-4737-ad61-bbb8419d0b51
ms.tgt_platform: multiple
title: Ajout d’une propriété WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bba8944da155ca250edfed0c6e9160f555ba9551
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106545087"
---
# <a name="adding-a-wmi-property"></a><span data-ttu-id="c33aa-103">Ajout d’une propriété WMI</span><span class="sxs-lookup"><span data-stu-id="c33aa-103">Adding a WMI Property</span></span>

<span data-ttu-id="c33aa-104">Les propriétés des classes WMI décrivent les données relatives à un objet managé.</span><span class="sxs-lookup"><span data-stu-id="c33aa-104">Properties in WMI classes describe data about a managed object.</span></span> <span data-ttu-id="c33aa-105">Par exemple, **handle**, **ProcessID** et **PageFaults** sont définis en tant que propriétés de la classe de [**\_ processus Win32**](/windows/desktop/CIMWin32Prov/win32-process) et décrivent les aspects d’un processus du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="c33aa-105">For example, **Handle**, **ProcessId**, and **PageFaults** are defined as properties of the [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class and describe aspects of an operating system process.</span></span> <span data-ttu-id="c33aa-106">Pour plus d’informations, consultez [écriture d’un fournisseur de propriétés](writing-a-property-provider.md).</span><span class="sxs-lookup"><span data-stu-id="c33aa-106">For more information, see [Writing a Property Provider](writing-a-property-provider.md).</span></span>

## <a name="defining-a-property-in-mof"></a><span data-ttu-id="c33aa-107">Définition d’une propriété dans MOF</span><span class="sxs-lookup"><span data-stu-id="c33aa-107">Defining a Property in MOF</span></span>

<span data-ttu-id="c33aa-108">Une propriété WMI représente un aspect ou un État dans l’objet.</span><span class="sxs-lookup"><span data-stu-id="c33aa-108">A WMI property represents an aspect or state in the object.</span></span> <span data-ttu-id="c33aa-109">Plutôt que de créer des méthodes qui obtiennent et définissent simplement une valeur, vous pouvez créer une propriété.</span><span class="sxs-lookup"><span data-stu-id="c33aa-109">Rather than create methods that simply get and set a value, you can create a property.</span></span> <span data-ttu-id="c33aa-110">Par exemple, la propriété **Netactived** de [**Win32 \_ NetworkAdapter**](/windows/desktop/CIMWin32Prov/win32-networkadapter) indique si l’état de l’adaptateur est activé ou désactivé.</span><span class="sxs-lookup"><span data-stu-id="c33aa-110">For example, the **NetEnabled** property of [**Win32\_NetworkAdapter**](/windows/desktop/CIMWin32Prov/win32-networkadapter) displays whether the state of the adapter is enabled or disabled.</span></span> <span data-ttu-id="c33aa-111">Toutefois, les méthodes [**Enable**](/windows/desktop/CIMWin32Prov/enable-method-in-class-win32-networkadapter) et [**Disable**](/windows/desktop/CIMWin32Prov/disable-method-in-class-win32-networkadapter) effectuent en fait l’action de modifier l’état de l’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="c33aa-111">However, the [**Enable**](/windows/desktop/CIMWin32Prov/enable-method-in-class-win32-networkadapter) and [**Disable**](/windows/desktop/CIMWin32Prov/disable-method-in-class-win32-networkadapter) methods actually perform the action of changing the adapter state.</span></span>

<span data-ttu-id="c33aa-112">Une propriété doit avoir un type de données.</span><span class="sxs-lookup"><span data-stu-id="c33aa-112">A property must have a data type.</span></span> <span data-ttu-id="c33aa-113">Le type de données du **handle** de propriété du [**\_ processus Win32**](/windows/desktop/CIMWin32Prov/win32-process) est **String** et le type de données de **PageFaults** est **UInt32**.</span><span class="sxs-lookup"><span data-stu-id="c33aa-113">The data type of the [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) property **Handle** is **string** and the data type of **PageFaults** is **uint32**.</span></span> <span data-ttu-id="c33aa-114">Si une propriété ne peut avoir que deux États, le type de données de la propriété est normalement défini sur **booléen**.</span><span class="sxs-lookup"><span data-stu-id="c33aa-114">If a property can have only two states, the data type of the property is normally set to **boolean**.</span></span>

<span data-ttu-id="c33aa-115">La propriété peut également être un tableau.</span><span class="sxs-lookup"><span data-stu-id="c33aa-115">The property may also be an array.</span></span> <span data-ttu-id="c33aa-116">Par exemple, la propriété identificateur de sécurité (**sid**) du [**tiers de \_ confiance Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee) est un tableau d’octets (**UInt8**) qui contient le SID.</span><span class="sxs-lookup"><span data-stu-id="c33aa-116">For example, the security identifier (**SID**) property of [**Win32\_Trustee**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee) is a byte array (**uint8**) that contains the SID.</span></span> <span data-ttu-id="c33aa-117">Les propriétés peuvent contenir des objets incorporés qui sont des références à une ou plusieurs instances d’une autre classe WMI.</span><span class="sxs-lookup"><span data-stu-id="c33aa-117">Properties can contain embedded objects which are references to one or more instances of another WMI class.</span></span> <span data-ttu-id="c33aa-118">La liste de contrôle d’accès discrétionnaire **(DACL)** et les propriétés de liste de contrôle d’accès système **(SACL)** de [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), par exemple, sont des tableaux d’objets [**\_ ACE Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-ace) qui décrivent les groupes et les comptes qui ont accès.</span><span class="sxs-lookup"><span data-stu-id="c33aa-118">The discretionary access control list **(DACL)** and system access control list **(SACL)** properties of [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), for example, are arrays of [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace) objects that describe the groups and accounts that have access.</span></span> <span data-ttu-id="c33aa-119">La propriété **Group** dans **Win32 \_ SecurityDescriptor** contient une référence à une instance unique de **l' \_ approbation Win32**.</span><span class="sxs-lookup"><span data-stu-id="c33aa-119">The **Group** property in **Win32\_SecurityDescriptor** contains a reference to a single instance of **Win32\_Trustee**.</span></span> <span data-ttu-id="c33aa-120">Pour plus d’informations, consultez [incorporation d’objets dans une classe](embedded-objects.md).</span><span class="sxs-lookup"><span data-stu-id="c33aa-120">For more information, see [Embedding Objects in a Class](embedded-objects.md).</span></span>

<span data-ttu-id="c33aa-121">Une propriété peut avoir plusieurs [*qualificateurs*](gloss-q.md).</span><span class="sxs-lookup"><span data-stu-id="c33aa-121">A property may have several [*qualifiers*](gloss-q.md).</span></span> <span data-ttu-id="c33aa-122">Ces [qualificateurs](wmi-qualifiers.md) peuvent être [*Common Information Model (CIM)*](gloss-c.md) ou des qualificateurs WMI, ou peuvent être spécifiques à certains types de classes, par exemple, les qualificateurs de la classe de [compteur de performance](qualifiers-specific-to-wmi-performance-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="c33aa-122">These [qualifiers](wmi-qualifiers.md) may be [*Common Information Model (CIM)*](gloss-c.md) or WMI qualifiers or may be specific to certain types of classes, for example, the [performance Counter](qualifiers-specific-to-wmi-performance-classes.md) class qualifiers.</span></span> <span data-ttu-id="c33aa-123">Les qualificateurs spécifient un aspect de la propriété, par exemple s’il est en lecture seule ou s’il ne peut pas être modifié sans privilège spécifique.</span><span class="sxs-lookup"><span data-stu-id="c33aa-123">Qualifiers specify some aspect of the property, such as if it is read-only or if it cannot be changed without a specific privilege.</span></span> <span data-ttu-id="c33aa-124">Une application qui tente d’écrire dans la propriété **DACL** [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), par exemple, requiert les privilèges **SeSecurityPrivilege** et **SeRestorePrivilege**.</span><span class="sxs-lookup"><span data-stu-id="c33aa-124">An application which attempts to write to the [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor)**DACL** property, for example, requires the privileges **SeSecurityPrivilege** and **SeRestorePrivilege**.</span></span> <span data-ttu-id="c33aa-125">Pour plus d’informations, consultez [Ajout d’un qualificateur](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="c33aa-125">For more information, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

<span data-ttu-id="c33aa-126">Enfin, une propriété doit avoir un nom.</span><span class="sxs-lookup"><span data-stu-id="c33aa-126">Finally, a property must have a name.</span></span> <span data-ttu-id="c33aa-127">Vous pouvez nommer une propriété tout cela dans les limites de la pratique de programmation standard.</span><span class="sxs-lookup"><span data-stu-id="c33aa-127">You may name a property anything within the bounds of standard programming practice.</span></span> <span data-ttu-id="c33aa-128">Toutefois, il existe deux exceptions principales.</span><span class="sxs-lookup"><span data-stu-id="c33aa-128">However, there are two main exceptions.</span></span> <span data-ttu-id="c33aa-129">Tout d’abord, vous ne pouvez pas utiliser de mot clé MOF, tel que « Class », comme nom de propriété.</span><span class="sxs-lookup"><span data-stu-id="c33aa-129">First, you may not use any MOF keyword, such as "class", as a property name.</span></span> <span data-ttu-id="c33aa-130">Deuxièmement, vous ne pouvez pas utiliser de mots clés WQL, tels que « Group », en tant que nom de propriété.</span><span class="sxs-lookup"><span data-stu-id="c33aa-130">Second, you may not use any WQL keywords, such as "group", as a property name either.</span></span> <span data-ttu-id="c33aa-131">Pour plus d’informations sur les mots clés MOF et WQL, consultez [types de données MOF](mof-data-types.md) et [WQL (SQL pour WMI)](wql-sql-for-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="c33aa-131">For more information on MOF and WQL keywords, see [MOF Data Types](mof-data-types.md) and [WQL (SQL for WMI)](wql-sql-for-wmi.md).</span></span>

<span data-ttu-id="c33aa-132">Pour le code C++ et format MOF (MOF), vous déclarez les propriétés d’une classe en même temps que vous déclarez la classe.</span><span class="sxs-lookup"><span data-stu-id="c33aa-132">For both C++ and Managed Object Format (MOF) code, you declare the properties of a class at the same time that you declare the class.</span></span>

<span data-ttu-id="c33aa-133">**Pour définir une propriété**</span><span class="sxs-lookup"><span data-stu-id="c33aa-133">**To define a property**</span></span>

-   <span data-ttu-id="c33aa-134">Incluez le type de données de la propriété, le nom et une valeur par défaut et un qualificateur facultatifs entre les accolades de la description de la classe.</span><span class="sxs-lookup"><span data-stu-id="c33aa-134">Include the property data type, name, and an optional default value and qualifier between the curly braces of the class description.</span></span>

    ``` syntax
    class MyClass 
    {
        [key] string   strProp;
        sint32         dwProp1 = 21;
        uint32         dwProp2;
    };
    ```

    <span data-ttu-id="c33aa-135">La classe MyClass de l’exemple précédent a trois propriétés : une chaîne de caractères, un entier signé 32 bits et un entier 32 bits non signé.</span><span class="sxs-lookup"><span data-stu-id="c33aa-135">The MyClass class in the preceding example has three properties: a character string, a 32-bit signed integer, and a 32-bit unsigned integer.</span></span> <span data-ttu-id="c33aa-136">Un nom ne respectant pas la casse et un type de données MOF sont assignés à chaque propriété.</span><span class="sxs-lookup"><span data-stu-id="c33aa-136">Each property is assigned a case-insensitive name and a MOF data type.</span></span>

    <span data-ttu-id="c33aa-137">Le qualificateur de [**clé**](key-qualifier.md) définit la propriété de type chaîne comme propriété de clé qui identifie de façon unique une instance de la classe.</span><span class="sxs-lookup"><span data-stu-id="c33aa-137">The [**Key**](key-qualifier.md) qualifier defines the string property as the key property that uniquely identifies an instance of the class.</span></span> <span data-ttu-id="c33aa-138">Pour plus d’informations sur les qualificateurs, consultez [Ajout d’un qualificateur](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="c33aa-138">For more information about qualifiers, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c33aa-139">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c33aa-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c33aa-140">Création d’une classe</span><span class="sxs-lookup"><span data-stu-id="c33aa-140">Creating a Class</span></span>](creating-a-class.md)
</dt> </dl>

 

 
