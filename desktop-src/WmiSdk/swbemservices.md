---
description: Vous pouvez utiliser les méthodes d’un objet SWbemServices pour effectuer des opérations sur un espace de noms sur un hôte local ou un hôte distant. Cet objet ne peut pas être créé par l’appel VBScript CreateObject.
ms.assetid: 7fcfa404-2fe6-42e5-85ac-64536f6d2a44
ms.tgt_platform: multiple
title: Objet SWbemServices (wbemdisp. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SWbemServices
- ISWbemServices
api_type:
- COM
api_location:
- Wbemdisp.dll
ms.openlocfilehash: 4303b3226acc6d773ed35e77176e05e3a58c567d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106527386"
---
# <a name="swbemservices-object"></a><span data-ttu-id="d7481-104">Objet SWbemServices</span><span class="sxs-lookup"><span data-stu-id="d7481-104">SWbemServices object</span></span>

<span data-ttu-id="d7481-105">Vous pouvez utiliser les méthodes d’un objet **SWbemServices** pour effectuer des opérations sur un espace de noms sur un hôte local ou un hôte distant.</span><span class="sxs-lookup"><span data-stu-id="d7481-105">You can use the methods of an **SWbemServices** object to perform operations against a namespace on either a local host or a remote host.</span></span> <span data-ttu-id="d7481-106">Cet objet ne peut pas être créé par l’appel VBScript **CreateObject** .</span><span class="sxs-lookup"><span data-stu-id="d7481-106">This object cannot be created by the VBScript **CreateObject** call.</span></span>

## <a name="members"></a><span data-ttu-id="d7481-107">Membres</span><span class="sxs-lookup"><span data-stu-id="d7481-107">Members</span></span>

<span data-ttu-id="d7481-108">L’objet **SWbemServices** possède les types de membres suivants :</span><span class="sxs-lookup"><span data-stu-id="d7481-108">The **SWbemServices** object has these types of members:</span></span>

-   [<span data-ttu-id="d7481-109">Méthodes</span><span class="sxs-lookup"><span data-stu-id="d7481-109">Methods</span></span>](#methods)
-   [<span data-ttu-id="d7481-110">Propriétés</span><span class="sxs-lookup"><span data-stu-id="d7481-110">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="d7481-111">Méthodes</span><span class="sxs-lookup"><span data-stu-id="d7481-111">Methods</span></span>

<span data-ttu-id="d7481-112">L’objet **SWbemServices** possède ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="d7481-112">The **SWbemServices** object has these methods.</span></span>



| <span data-ttu-id="d7481-113">Méthode</span><span class="sxs-lookup"><span data-stu-id="d7481-113">Method</span></span>                                                                         | <span data-ttu-id="d7481-114">Description</span><span class="sxs-lookup"><span data-stu-id="d7481-114">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d7481-115">**AssociatorsOf**</span><span class="sxs-lookup"><span data-stu-id="d7481-115">**AssociatorsOf**</span></span>](swbemservices-associatorsof.md)                           | <span data-ttu-id="d7481-116">Récupère les instances des ressources managées associées à une ressource spécifiée par le biais d’une ou plusieurs classes d’association.</span><span class="sxs-lookup"><span data-stu-id="d7481-116">Retrieves the instances of managed resources that are associated with a specified resource through one or more association classes.</span></span> <span data-ttu-id="d7481-117">Vous fournissez le chemin d’accès de l’objet pour le point de terminaison d’origine, et [**AssociatorsOf**](swbemservices-associatorsof.md) retourne les ressources managées au point de terminaison opposé.</span><span class="sxs-lookup"><span data-stu-id="d7481-117">You provide the object path for the originating endpoint, and [**AssociatorsOf**](swbemservices-associatorsof.md) returns the managed resources at the opposite endpoint.</span></span> <span data-ttu-id="d7481-118">La méthode **AssociatorsOf** effectue la même fonction que celle que la requête WQL « associateurs de » effectue.</span><span class="sxs-lookup"><span data-stu-id="d7481-118">The **AssociatorsOf** method performs the same function that the "ASSOCIATORS OF" WQL query performs.</span></span><br/>                                                                           |
| [<span data-ttu-id="d7481-119">**AssociatorsOfAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-119">**AssociatorsOfAsync**</span></span>](swbemservices-associatorsofasync.md)                 | <span data-ttu-id="d7481-120">Retourne de façon asynchrone une collection d’objets (classes ou instances) associés à un objet spécifié.</span><span class="sxs-lookup"><span data-stu-id="d7481-120">Asynchronously returns a collection of objects (classes or instances) that are associated with a specified object.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="d7481-121">**Supprimer**</span><span class="sxs-lookup"><span data-stu-id="d7481-121">**Delete**</span></span>](swbemservices-delete.md)                                         | <span data-ttu-id="d7481-122">Supprime une instance d’une ressource managée (ou une définition de classe de l’espace de stockage CIM).</span><span class="sxs-lookup"><span data-stu-id="d7481-122">Deletes an instance of a managed resource (or a class definition from the CIM repository).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="d7481-123">**DeleteAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-123">**DeleteAsync**</span></span>](swbemservices-deleteasync.md)                               | <span data-ttu-id="d7481-124">Supprime de façon asynchrone la classe ou l’instance spécifiée dans le chemin d’accès de l’objet.</span><span class="sxs-lookup"><span data-stu-id="d7481-124">Asynchronously deletes the class or instance that is specified in the object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="d7481-125">**ExecMethod**</span><span class="sxs-lookup"><span data-stu-id="d7481-125">**ExecMethod**</span></span>](swbemservices-execmethod.md)                                 | <span data-ttu-id="d7481-126">Fournit une autre façon d’exécuter une méthode définie par une définition de classe de ressource managée.</span><span class="sxs-lookup"><span data-stu-id="d7481-126">Provides an alternative way to execute a method defined by a managed resource class definition.</span></span> <span data-ttu-id="d7481-127">Principalement utilisé dans les situations où le langage de script ne prend pas en charge les paramètres de sortie.</span><span class="sxs-lookup"><span data-stu-id="d7481-127">Primarily used in situations in which the scripting language does not support out parameters.</span></span> <span data-ttu-id="d7481-128">Par exemple, JScript ne prend pas en charge les paramètres out.</span><span class="sxs-lookup"><span data-stu-id="d7481-128">For example, JScript does not support out parameters.</span></span><br/>                                                                                                                                                                                                                                            |
| [<span data-ttu-id="d7481-129">**ExecMethodAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-129">**ExecMethodAsync**</span></span>](swbemservices-execmethodasync.md)                       | <span data-ttu-id="d7481-130">Exécute de façon asynchrone une méthode qui est exportée par un fournisseur de méthode.</span><span class="sxs-lookup"><span data-stu-id="d7481-130">Asynchronously executes a method that is exported by a method provider.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="d7481-131">**ExecNotificationQuery**</span><span class="sxs-lookup"><span data-stu-id="d7481-131">**ExecNotificationQuery**</span></span>](swbemservices-execnotificationquery.md)           | <span data-ttu-id="d7481-132">Exécute une requête d’abonnement aux événements pour recevoir des événements.</span><span class="sxs-lookup"><span data-stu-id="d7481-132">Executes an event subscription query to receive events.</span></span> <span data-ttu-id="d7481-133">Une requête d’abonnement aux événements est une requête qui définit une modification de l’environnement géré que vous souhaitez analyser.</span><span class="sxs-lookup"><span data-stu-id="d7481-133">An event subscription query is a query that defines a change to the managed environment that you want to monitor.</span></span> <span data-ttu-id="d7481-134">Lorsque la modification se produit, l’infrastructure WMI remet un événement décrivant la modification apportée au script appelant.</span><span class="sxs-lookup"><span data-stu-id="d7481-134">When the change occurs, the WMI infrastructure delivers an event describing the change to the calling script.</span></span><br/>                                                                                                                                                                                                        |
| [<span data-ttu-id="d7481-135">**ExecNotificationQueryAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-135">**ExecNotificationQueryAsync**</span></span>](swbemservices-execnotificationqueryasync.md) | <span data-ttu-id="d7481-136">Exécute de façon asynchrone une requête pour recevoir des événements.</span><span class="sxs-lookup"><span data-stu-id="d7481-136">Asynchronously executes a query to receive events.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="d7481-137">**ExecQuery**</span><span class="sxs-lookup"><span data-stu-id="d7481-137">**ExecQuery**</span></span>](swbemservices-execquery.md)                                   | <span data-ttu-id="d7481-138">Exécute une requête pour récupérer une collection d’instances de ressources gérées par WMI (ou définitions de classe).</span><span class="sxs-lookup"><span data-stu-id="d7481-138">Executes a query to retrieve a collection of instances of WMI-managed resources (or class definitions).</span></span> <span data-ttu-id="d7481-139">[**ExecQuery**](swbemservices-execquery.md) peut être utilisé pour récupérer une collection filtrée d’instances qui correspondent aux critères que vous définissez dans la requête transmise à **ExecQuery**.</span><span class="sxs-lookup"><span data-stu-id="d7481-139">[**ExecQuery**](swbemservices-execquery.md) can be used to retrieve a filtered collection of instances that match criteria you define in the query passed to **ExecQuery**.</span></span><br/>                                                                                                                                                                                                           |
| [<span data-ttu-id="d7481-140">**ExecQueryAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-140">**ExecQueryAsync**</span></span>](swbemservices-execqueryasync.md)                         | <span data-ttu-id="d7481-141">Exécute de façon asynchrone une requête pour récupérer des objets.</span><span class="sxs-lookup"><span data-stu-id="d7481-141">Asynchronously executes a query to retrieve objects.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="d7481-142">**Télécharger**</span><span class="sxs-lookup"><span data-stu-id="d7481-142">**Get**</span></span>](swbemservices-get.md)                                               | <span data-ttu-id="d7481-143">Récupère une instance unique d’une ressource managée (ou une définition de classe) en fonction d’un chemin d’accès d’objet.</span><span class="sxs-lookup"><span data-stu-id="d7481-143">Retrieves a single instance of a managed resource (or class definition) based on an object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="d7481-144">**GetAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-144">**GetAsync**</span></span>](swbemservices-getasync.md)                                     | <span data-ttu-id="d7481-145">Récupère de manière asynchrone un objet, qui est soit une définition de classe, soit une instance, en fonction du chemin d’accès de l’objet.</span><span class="sxs-lookup"><span data-stu-id="d7481-145">Asynchronously retrieves an object, that is either a class definition or an instance, based on the object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="d7481-146">**InstancesOf**</span><span class="sxs-lookup"><span data-stu-id="d7481-146">**InstancesOf**</span></span>](swbemservices-instancesof.md)                               | <span data-ttu-id="d7481-147">Récupère toutes les instances d’une ressource managée en fonction d’un nom de classe.</span><span class="sxs-lookup"><span data-stu-id="d7481-147">Retrieves all the instances of a managed resource based on a class name.</span></span> <span data-ttu-id="d7481-148">Par défaut, [**InstancesOf**](swbemservices-instancesof.md) effectue une récupération complète.</span><span class="sxs-lookup"><span data-stu-id="d7481-148">By default, [**InstancesOf**](swbemservices-instancesof.md) performs a deep retrieval.</span></span> <span data-ttu-id="d7481-149">Autrement dit, la méthode **InstancesOf** récupère les instances de la ressource identifiée par le nom de classe passé à la méthode et récupère également toutes les instances de toutes les ressources qui sont des sous-classes (définies sous) de la classe cible.</span><span class="sxs-lookup"><span data-stu-id="d7481-149">That is, **InstancesOf** retrieves the instances of the resource identified by the class name passed to the method and also retrieves all the instances of all the resources that are subclasses (defined beneath) of the target class.</span></span><br/>                                                                                       |
| [<span data-ttu-id="d7481-150">**InstancesOfAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-150">**InstancesOfAsync**</span></span>](swbemservices-instancesofasync.md)                     | <span data-ttu-id="d7481-151">Retourne de façon asynchrone les instances d’une classe spécifiée en fonction des critères de sélection spécifiés par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d7481-151">Asynchronously returns the instances of a specified class according to the user-specified selection criteria.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="d7481-152">**ReferencesTo**</span><span class="sxs-lookup"><span data-stu-id="d7481-152">**ReferencesTo**</span></span>](swbemservices-referencesto.md)                             | <span data-ttu-id="d7481-153">Retourne toutes les associations qui font référence à une ressource spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d7481-153">Returns all of the associations that reference a specified resource.</span></span> <span data-ttu-id="d7481-154">La meilleure façon de comprendre [**ReferencesTo**](swbemservices-referencesto.md) est de le comparer à la méthode [**AssociatorsOf**](swbemservices-associatorsof.md) .</span><span class="sxs-lookup"><span data-stu-id="d7481-154">The best way to understand [**ReferencesTo**](swbemservices-referencesto.md) is to compare it with the [**AssociatorsOf**](swbemservices-associatorsof.md) method.</span></span> <span data-ttu-id="d7481-155">**AssociatorsOf** retourne les ressources dynamiques qui se trouvent à l’extrémité opposée d’une association.</span><span class="sxs-lookup"><span data-stu-id="d7481-155">**AssociatorsOf** returns the dynamic resources that are at the opposite end of an association.</span></span> <span data-ttu-id="d7481-156">**ReferencesTo** retourne l’Association elle-même.</span><span class="sxs-lookup"><span data-stu-id="d7481-156">**ReferencesTo** returns the association itself.</span></span> <span data-ttu-id="d7481-157">La méthode **ReferencesTo** effectue la même fonction que celle exécutée par la requête WQL « références de ».</span><span class="sxs-lookup"><span data-stu-id="d7481-157">The **ReferencesTo** method performs the same function that the "REFERENCES OF" WQL query performs.</span></span><br/> |
| [<span data-ttu-id="d7481-158">**ReferencesToAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-158">**ReferencesToAsync**</span></span>](swbemservices-referencesto.md)                        | <span data-ttu-id="d7481-159">Retourne de façon asynchrone une collection de toutes les classes d’association ou instances qui font référence à une classe ou une instance spécifique.</span><span class="sxs-lookup"><span data-stu-id="d7481-159">Asynchronously returns a collection of all association classes or instances that refer to a specific class or instance.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="d7481-160">**SubclassesOf**</span><span class="sxs-lookup"><span data-stu-id="d7481-160">**SubclassesOf**</span></span>](swbemservices-subclassesof.md)                             | <span data-ttu-id="d7481-161">Récupère toutes les sous-classes d’une classe spécifiée à partir du référentiel CIM.</span><span class="sxs-lookup"><span data-stu-id="d7481-161">Retrieves all the subclasses of a specified class from the CIM repository.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="d7481-162">**SubclassesOfAsync**</span><span class="sxs-lookup"><span data-stu-id="d7481-162">**SubclassesOfAsync**</span></span>](swbemservices-subclassesofasync.md)                   | <span data-ttu-id="d7481-163">Retourne de façon asynchrone une collection de sous-classes pour une classe spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d7481-163">Asynchronously returns a collection of subclasses for a specified class.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                       |



 

### <a name="properties"></a><span data-ttu-id="d7481-164">Propriétés</span><span class="sxs-lookup"><span data-stu-id="d7481-164">Properties</span></span>

<span data-ttu-id="d7481-165">L’objet **SWbemServices** possède ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="d7481-165">The **SWbemServices** object has these properties.</span></span>



| <span data-ttu-id="d7481-166">Propriété</span><span class="sxs-lookup"><span data-stu-id="d7481-166">Property</span></span>                                                 | <span data-ttu-id="d7481-167">Type d’accès</span><span class="sxs-lookup"><span data-stu-id="d7481-167">Access type</span></span>          | <span data-ttu-id="d7481-168">Description</span><span class="sxs-lookup"><span data-stu-id="d7481-168">Description</span></span>                                                                          |
|:---------------------------------------------------------|:---------------------|:-------------------------------------------------------------------------------------|
| [<span data-ttu-id="d7481-169">**Sécurité\_**</span><span class="sxs-lookup"><span data-stu-id="d7481-169">**Security\_**</span></span>](swbemservices-security-.md)<br/> | <span data-ttu-id="d7481-170">Lecture seule</span><span class="sxs-lookup"><span data-stu-id="d7481-170">Read-only</span></span><br/> | <span data-ttu-id="d7481-171">Utilisé pour obtenir ou définir les paramètres de sécurité d’un objet **SWbemServices** .</span><span class="sxs-lookup"><span data-stu-id="d7481-171">Used to get or set the security settings for an **SWbemServices** object.</span></span><br/> |



 

## <a name="remarks"></a><span data-ttu-id="d7481-172">Notes</span><span class="sxs-lookup"><span data-stu-id="d7481-172">Remarks</span></span>

<span data-ttu-id="d7481-173">Les méthodes peuvent être appelées en mode synchrone, en mode asynchrone ou en mode semi-synchrone.</span><span class="sxs-lookup"><span data-stu-id="d7481-173">The methods can be called in either the synchronous mode, the asynchronous mode, or the semisynchronous mode.</span></span> <span data-ttu-id="d7481-174">Pour plus d’informations, consultez [appel d’une méthode](calling-a-method.md).</span><span class="sxs-lookup"><span data-stu-id="d7481-174">For more information see [Calling a Method](calling-a-method.md).</span></span>

<span data-ttu-id="d7481-175">**Vue d’ensemble**</span><span class="sxs-lookup"><span data-stu-id="d7481-175">**Overview**</span></span>

<span data-ttu-id="d7481-176">**SWbemServices** dessert deux rôles principaux.</span><span class="sxs-lookup"><span data-stu-id="d7481-176">**SWbemServices** serves two primary roles.</span></span> <span data-ttu-id="d7481-177">Tout d’abord, l’objet **SWbemServices** représente une connexion authentifiée à un espace de noms WMI sur un ordinateur cible.</span><span class="sxs-lookup"><span data-stu-id="d7481-177">First, the **SWbemServices** object represents an authenticated connection to a WMI namespace on a target computer.</span></span> <span data-ttu-id="d7481-178">Ensuite, **SWbemServices** est l’objet Automation que vous utilisez pour récupérer des ressources gérées par WMI.</span><span class="sxs-lookup"><span data-stu-id="d7481-178">Second, **SWbemServices** is the Automation object you use to retrieve WMI-managed resources.</span></span> <span data-ttu-id="d7481-179">Vous pouvez obtenir une référence à un objet **SWbemServices** de l’une des deux manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="d7481-179">You can obtain a reference to an **SWbemServices** object in either of two ways:</span></span>

-   <span data-ttu-id="d7481-180">Comme illustré dans la plupart des scripts WMI présentés jusqu’à présent, vous pouvez utiliser la fonction VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) en association avec le moniker WMI « winmgmts : ».</span><span class="sxs-lookup"><span data-stu-id="d7481-180">As demonstrated in most of the WMI scripts presented thus far, you can use the VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) function in combination with the WMI moniker "winmgmts:".</span></span> <span data-ttu-id="d7481-181">L’exemple suivant est la forme la plus simple d’une connexion WMI.</span><span class="sxs-lookup"><span data-stu-id="d7481-181">The following example is the simplest form of a WMI connection.</span></span> <span data-ttu-id="d7481-182">L’exemple se connecte à l’espace de noms par défaut (généralement « root \\ cimv2 ») sur l’ordinateur local :</span><span class="sxs-lookup"><span data-stu-id="d7481-182">The example connects to the default namespace (typically "Root\\CIMv2") on the local computer:</span></span>

    `Set objSWbemServices = GetObject("winmgmts:")`

-   <span data-ttu-id="d7481-183">Vous pouvez également utiliser la méthode [**ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) de l’objet [**SWbemLocator**](swbemlocator.md) pour obtenir une référence à un objet **SWbemServices** .</span><span class="sxs-lookup"><span data-stu-id="d7481-183">You can also use the [**SWbemLocator**](swbemlocator.md) object [**ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) method to obtain a reference to an **SWbemServices** object.</span></span>

<span data-ttu-id="d7481-184">Une fois que vous avez obtenu une référence à un objet **SWbemServices** , vous utilisez la référence d’objet pour appeler 1 des 18 méthodes disponibles à l’aide de **SWbemServices**.</span><span class="sxs-lookup"><span data-stu-id="d7481-184">After you obtain a reference to an **SWbemServices** object, you use the object reference to call 1 of 18 methods available using **SWbemServices**.</span></span> <span data-ttu-id="d7481-185">**SWbemServices** peut retourner l’un des trois objets de bibliothèque de script WMI différents ([**SWbemObjectSet**](swbemobjectset.md), [**SWbemObject**](swbemobject.md)ou [**SWbemEventSource**](swbemeventsource.md)), selon la méthode que vous appelez.</span><span class="sxs-lookup"><span data-stu-id="d7481-185">**SWbemServices** can return one of three different WMI scripting library objects ([**SWbemObjectSet**](swbemobjectset.md), [**SWbemObject**](swbemobject.md), or [**SWbemEventSource**](swbemeventsource.md)), depending on the method you call.</span></span> <span data-ttu-id="d7481-186">Si vous connaissez le type d’objet retourné par la méthode, vous pourrez déterminer l’étape suivante que votre script doit effectuer.</span><span class="sxs-lookup"><span data-stu-id="d7481-186">Knowing the type of object each method returns will help you determine the next step your script must take.</span></span> <span data-ttu-id="d7481-187">Par exemple, si vous récupérez une collection **SWbemObjectSet**, vous devez énumérer la collection pour accéder à chaque **SWbemObject** de la collection.</span><span class="sxs-lookup"><span data-stu-id="d7481-187">For example, if you get back an **SWbemObjectSet**, you must enumerate the collection to access each **SWbemObject** in the collection.</span></span> <span data-ttu-id="d7481-188">Si vous récupérez un **SWbemObject**, vous pouvez immédiatement accéder aux méthodes et propriétés de l’objet sans énumérer la collection en premier.</span><span class="sxs-lookup"><span data-stu-id="d7481-188">If you get back an **SWbemObject**, you can immediately access the object methods and properties without enumerating the collection first.</span></span>

<span data-ttu-id="d7481-189">**Modes de fonctionnement**</span><span class="sxs-lookup"><span data-stu-id="d7481-189">**Modes of Operation**</span></span>

<span data-ttu-id="d7481-190">**SWbemServices** prend en charge trois modes de fonctionnement : synchrone, asynchrone et semi-synchrone.</span><span class="sxs-lookup"><span data-stu-id="d7481-190">**SWbemServices** supports three modes of operation: synchronous, asynchronous, and semisynchronous.</span></span>

-   <span data-ttu-id="d7481-191">**Synchrone**.</span><span class="sxs-lookup"><span data-stu-id="d7481-191">**Synchronous**.</span></span> <span data-ttu-id="d7481-192">En mode synchrone, votre script bloque (interrompt) jusqu’à la fin de la méthode **SWbemServices** .</span><span class="sxs-lookup"><span data-stu-id="d7481-192">In synchronous mode, your script blocks (pauses) until the **SWbemServices** method completes.</span></span> <span data-ttu-id="d7481-193">Non seulement votre script est en attente, mais dans les cas où WMI récupère des instances de ressources managées, WMI génère la totalité de la base de données [**SWbemObjectSet**](swbemobjectset.md) en mémoire avant que le premier octet de données ne soit renvoyé au script appelant.</span><span class="sxs-lookup"><span data-stu-id="d7481-193">Not only does your script wait, but in cases in which WMI retrieves instances of managed resources, WMI builds the entire [**SWbemObjectSet**](swbemobjectset.md) in memory before the first byte of data is returned to the calling script.</span></span> <span data-ttu-id="d7481-194">Cela peut avoir un effet néfaste sur les performances du script et sur l’ordinateur exécutant le script.</span><span class="sxs-lookup"><span data-stu-id="d7481-194">This can have an adverse effect on the script performance and on the computer running the script.</span></span> <span data-ttu-id="d7481-195">Par exemple, la récupération synchrone de milliers d’événements à partir des journaux des événements Windows peut prendre beaucoup de temps et utiliser beaucoup de mémoire.</span><span class="sxs-lookup"><span data-stu-id="d7481-195">For example, synchronously retrieving thousands of events from the Windows Event Logs can take a long time and use a lot of memory.</span></span> <span data-ttu-id="d7481-196">Pour ces raisons, les opérations synchrones ne sont pas recommandées, sauf pour les trois méthodes ([**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md)et [**obtenir**](swbemservices-get.md)) qui sont synchrones par défaut.</span><span class="sxs-lookup"><span data-stu-id="d7481-196">For these reasons, synchronous operations are not recommended except for the three methods ([**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), and [**Get**](swbemservices-get.md)) that are synchronous by default.</span></span> <span data-ttu-id="d7481-197">Ces méthodes ne retournent pas de jeux de données volumineux, de sorte que l’opération semi-synchrone n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="d7481-197">These methods do not return large data sets, so semisynchronous operation is not required.</span></span>
-   <span data-ttu-id="d7481-198">**Asynchrone**.</span><span class="sxs-lookup"><span data-stu-id="d7481-198">**Asynchronous**.</span></span> <span data-ttu-id="d7481-199">En mode asynchrone, votre script appelle l’une des neuf méthodes asynchrones et est retourné immédiatement.</span><span class="sxs-lookup"><span data-stu-id="d7481-199">In asynchronous mode, your script calls one of the nine asynchronous methods and returns immediately.</span></span> <span data-ttu-id="d7481-200">Autrement dit, dès que la méthode asynchrone est appelée, votre script reprend l’exécution de la ligne de code suivante.</span><span class="sxs-lookup"><span data-stu-id="d7481-200">That is, as soon as the asynchronous method is called, your script resumes running the next line of code.</span></span> <span data-ttu-id="d7481-201">Pour utiliser une méthode asynchrone, votre script doit d’abord créer un objet [**SWbemSink**](swbemsink.md) et une sous-routine spéciale appelée gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="d7481-201">To use an asynchronous method, your script must first create an [**SWbemSink**](swbemsink.md) object and a special subroutine called an event handler.</span></span> <span data-ttu-id="d7481-202">WMI exécute l’opération asynchrone et notifie le script en appelant la sous-routine du gestionnaire d’événements lorsque l’opération est terminée.</span><span class="sxs-lookup"><span data-stu-id="d7481-202">WMI performs the asynchronous operation and notifies the script by calling the event handler subroutine when the operation is complete.</span></span>
-   <span data-ttu-id="d7481-203">**Semi-synchrone**.</span><span class="sxs-lookup"><span data-stu-id="d7481-203">**Semisynchronous**.</span></span> <span data-ttu-id="d7481-204">Le mode semi-synchrone est un compromis entre synchrone et asynchrone.</span><span class="sxs-lookup"><span data-stu-id="d7481-204">Semisynchronous mode is a compromise between synchronous and asynchronous.</span></span> <span data-ttu-id="d7481-205">Les opérations semi-synchrones offrent de meilleures performances que les opérations synchrones, mais elles ne nécessitent pas les connaissances supplémentaires et les étapes de script nécessaires pour gérer les opérations asynchrones.</span><span class="sxs-lookup"><span data-stu-id="d7481-205">Semisynchronous operations offer better performance than synchronous operations, yet they do not require the extra knowledge and scripting steps necessary to handle asynchronous operations.</span></span> <span data-ttu-id="d7481-206">Il s’agit du type d’opération par défaut pour la plupart des requêtes WMI.</span><span class="sxs-lookup"><span data-stu-id="d7481-206">This is the default operation type for most WMI queries.</span></span>

    <span data-ttu-id="d7481-207">En mode semi-synchrone, votre script appelle l’une des six méthodes de récupération de données et retourne immédiatement.</span><span class="sxs-lookup"><span data-stu-id="d7481-207">In semisynchronous mode, your script calls one of the six data retrieval methods and returns immediately.</span></span> <span data-ttu-id="d7481-208">WMI récupère les ressources managées en arrière-plan à mesure que votre script continue de s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="d7481-208">WMI retrieves the managed resources in the background as your script continues to run.</span></span> <span data-ttu-id="d7481-209">À mesure que les ressources sont récupérées, elles sont immédiatement retournées à votre script par le biais d’une SWbemObjectSet.</span><span class="sxs-lookup"><span data-stu-id="d7481-209">As the resources are retrieved, they are immediately returned to your script by way of an SWbemObjectSet.</span></span> <span data-ttu-id="d7481-210">Vous pouvez commencer à accéder aux ressources managées sans attendre que l’ensemble de la collection soit assemblé.</span><span class="sxs-lookup"><span data-stu-id="d7481-210">You can begin to access the managed resources without waiting for the entire collection to be assembled.</span></span>

    <span data-ttu-id="d7481-211">Il y a un inconvénient pour les opérations semi-synchrones lorsque vous travaillez avec des ressources managées qui ont de nombreuses instances (une signification supérieure à 1 000), telles que le [**\_ fichier de fichier CIM**](/windows/desktop/CIMWin32Prov/cim-datafile) et [**Win32 \_ NTLogEvent**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent).</span><span class="sxs-lookup"><span data-stu-id="d7481-211">There is a caveat to semisynchronous operations when you are working with managed resources that have many instances (many meaning greater than 1,000), such as [**CIM\_DataFile**](/windows/desktop/CIMWin32Prov/cim-datafile) and [**Win32\_NTLogEvent**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent).</span></span> <span data-ttu-id="d7481-212">L’inconvénient est le résultat de la façon dont WMI gère les instances des ressources managées.</span><span class="sxs-lookup"><span data-stu-id="d7481-212">The caveat is a result of how WMI handles instances of managed resources.</span></span> <span data-ttu-id="d7481-213">Pour chaque instance d’une ressource managée, WMI crée et met en cache un objet [**SWbemObject**](swbemobject.md) .</span><span class="sxs-lookup"><span data-stu-id="d7481-213">For each instance of a managed resource, WMI creates and caches an [**SWbemObject**](swbemobject.md) object.</span></span> <span data-ttu-id="d7481-214">Lorsqu’il existe un grand nombre d’instances pour une ressource managée, la récupération de l’instance peut monopoliser les ressources disponibles, ce qui réduit les performances du script et de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="d7481-214">When a large number of instances exist for a managed resource, instance retrieval can monopolize available resources, reducing the performance of both the script and the computer.</span></span>

    <span data-ttu-id="d7481-215">Pour contourner le problème, vous pouvez optimiser les appels de méthode semi-synchrone à l’aide de l’indicateur **wbemFlagForwardOnly** .</span><span class="sxs-lookup"><span data-stu-id="d7481-215">To work around the problem, you can optimize semisynchronous method calls using the **wbemFlagForwardOnly** flag.</span></span> <span data-ttu-id="d7481-216">L’indicateur **wbemFlagForwardOnly** , combiné avec l’indicateur **wbemFlagReturnImmediately** (l’indicateur semi-synchrone par défaut), indique à WMI de retourner une [**SWbemObjectSet**](swbemobjectset.md)avant uniquement, ce qui élimine le problème de performances du jeu de données volumineux.</span><span class="sxs-lookup"><span data-stu-id="d7481-216">The **wbemFlagForwardOnly** flag, combined with the **wbemFlagReturnImmediately** flag (the default semisynchronous flag), tells WMI to return a forward-only [**SWbemObjectSet**](swbemobjectset.md), which eliminates the large data set performance problem.</span></span> <span data-ttu-id="d7481-217">Toutefois, l’utilisation de l’indicateur **wbemFlagForwardOnly** est un coût.</span><span class="sxs-lookup"><span data-stu-id="d7481-217">However, using the **wbemFlagForwardOnly** flag comes with a cost.</span></span> <span data-ttu-id="d7481-218">Une **SWbemObjectSet** avant uniquement ne peut être énumérée qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="d7481-218">A forward-only **SWbemObjectSet** can be enumerated only once.</span></span> <span data-ttu-id="d7481-219">Une fois que vous avez accédé à chaque [**SWbemObject**](swbemobject.md) dans une instance de la version **avant uniquement,** la mémoire allouée à l’instance est libérée.</span><span class="sxs-lookup"><span data-stu-id="d7481-219">After each [**SWbemObject**](swbemobject.md) in a forward-only **SWbemObjectSet** is accessed, the memory allocated to the instance is released.</span></span>

<span data-ttu-id="d7481-220">À l’exception des méthodes asynchrones [**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), [**obten**](swbemservices-get.md)et neuf, semi-synchrone est le mode de fonctionnement par défaut et recommandé.</span><span class="sxs-lookup"><span data-stu-id="d7481-220">With the exception of the [**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), [**Get**](swbemservices-get.md), and nine asynchronous methods, semisynchronous is the default and recommended mode of operation.</span></span>

<span data-ttu-id="d7481-221">**Méthodes couramment utilisées**</span><span class="sxs-lookup"><span data-stu-id="d7481-221">**Commonly-used Methods**</span></span>

<span data-ttu-id="d7481-222">Les méthodes les plus souvent utilisées dans les scripts d’administration de système sont [**InstancesOf**](swbemservices-instancesof.md), [**ExecQuery**](swbemservices-execquery.md), [**obten**](swbemservices-get.md)et [**ExecNotificationQuery**](swbemservices-execnotificationquery.md).</span><span class="sxs-lookup"><span data-stu-id="d7481-222">The methods most often used in system administration scripts are [**InstancesOf**](swbemservices-instancesof.md), [**ExecQuery**](swbemservices-execquery.md), [**Get**](swbemservices-get.md), and [**ExecNotificationQuery**](swbemservices-execnotificationquery.md).</span></span> <span data-ttu-id="d7481-223">Bien que souvent utilisé, **InstancesOf** n’est pas nécessairement la méthode recommandée pour récupérer des informations (même si c’est sans aucun doute le moyen le plus simple).</span><span class="sxs-lookup"><span data-stu-id="d7481-223">Although often used, **InstancesOf** is not necessarily the recommended way to retrieve information (although it is arguably the easiest way).</span></span>

## <a name="requirements"></a><span data-ttu-id="d7481-224">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="d7481-224">Requirements</span></span>



| <span data-ttu-id="d7481-225">Condition requise</span><span class="sxs-lookup"><span data-stu-id="d7481-225">Requirement</span></span> | <span data-ttu-id="d7481-226">Valeur</span><span class="sxs-lookup"><span data-stu-id="d7481-226">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="d7481-227">Client minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="d7481-227">Minimum supported client</span></span><br/> | <span data-ttu-id="d7481-228">Windows Vista</span><span class="sxs-lookup"><span data-stu-id="d7481-228">Windows Vista</span></span><br/>                                                                |
| <span data-ttu-id="d7481-229">Serveur minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="d7481-229">Minimum supported server</span></span><br/> | <span data-ttu-id="d7481-230">Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="d7481-230">Windows Server 2008</span></span><br/>                                                          |
| <span data-ttu-id="d7481-231">En-tête</span><span class="sxs-lookup"><span data-stu-id="d7481-231">Header</span></span><br/>                   | <dl> <span data-ttu-id="d7481-232"><dt>Wbemdisp. h</dt></span><span class="sxs-lookup"><span data-stu-id="d7481-232"><dt>Wbemdisp.h</dt></span></span> </dl>   |
| <span data-ttu-id="d7481-233">Bibliothèque de types</span><span class="sxs-lookup"><span data-stu-id="d7481-233">Type library</span></span><br/>             | <dl> <span data-ttu-id="d7481-234"><dt>Wbemdisp. tlb</dt></span><span class="sxs-lookup"><span data-stu-id="d7481-234"><dt>Wbemdisp.tlb</dt></span></span> </dl> |
| <span data-ttu-id="d7481-235">DLL</span><span class="sxs-lookup"><span data-stu-id="d7481-235">DLL</span></span><br/>                      | <dl> <span data-ttu-id="d7481-236"><dt>Wbemdisp.dll</dt></span><span class="sxs-lookup"><span data-stu-id="d7481-236"><dt>Wbemdisp.dll</dt></span></span> </dl> |
| <span data-ttu-id="d7481-237">CLSID</span><span class="sxs-lookup"><span data-stu-id="d7481-237">CLSID</span></span><br/>                    | <span data-ttu-id="d7481-238">CLSID \_ SWbemServices</span><span class="sxs-lookup"><span data-stu-id="d7481-238">CLSID\_SWbemServices</span></span><br/>                                                         |
| <span data-ttu-id="d7481-239">IID</span><span class="sxs-lookup"><span data-stu-id="d7481-239">IID</span></span><br/>                      | <span data-ttu-id="d7481-240">IID \_ ISWbemServices</span><span class="sxs-lookup"><span data-stu-id="d7481-240">IID\_ISWbemServices</span></span><br/>                                                          |



## <a name="see-also"></a><span data-ttu-id="d7481-241">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d7481-241">See also</span></span>

<dl> <dt>

[<span data-ttu-id="d7481-242">Scripts d’objets d’API</span><span class="sxs-lookup"><span data-stu-id="d7481-242">Scripting API Objects</span></span>](scripting-api-objects.md)
</dt> <dt>

[<span data-ttu-id="d7481-243">Appel d’une méthode</span><span class="sxs-lookup"><span data-stu-id="d7481-243">Calling a Method</span></span>](calling-a-method.md)
</dt> </dl>

 

