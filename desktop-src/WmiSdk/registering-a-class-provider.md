---
description: Pour créer un fournisseur de classe WMI, vous devez inscrire l' \_ \_ instance Win32Provider qui représente votre fournisseur à l’aide d’une instance de \_ \_ ClassProviderRegistration.
ms.assetid: ed834969-47e9-47df-9db8-c805b2eb71da
ms.tgt_platform: multiple
title: Inscription d’un fournisseur de classe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7bc15893e654f96f8c4e476219389a1f8f2c464a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951579"
---
# <a name="registering-a-class-provider"></a><span data-ttu-id="48387-103">Inscription d’un fournisseur de classe</span><span class="sxs-lookup"><span data-stu-id="48387-103">Registering a Class Provider</span></span>

<span data-ttu-id="48387-104">Pour créer un fournisseur de classe WMI, vous devez inscrire l’instance [**\_ \_ Win32Provider**](--win32provider.md) qui représente votre fournisseur à l’aide d’une instance de [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md).</span><span class="sxs-lookup"><span data-stu-id="48387-104">To create a WMI class provider you must register the [**\_\_Win32Provider**](--win32provider.md) instance that represents your provider using an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span> <span data-ttu-id="48387-105">En tant qu’objet COM, votre fournisseur doit s’inscrire auprès du système d’exploitation et de WMI.</span><span class="sxs-lookup"><span data-stu-id="48387-105">As a COM object, your provider must register with the operating system and WMI.</span></span> <span data-ttu-id="48387-106">La procédure suivante suppose que vous avez déjà implémenté le processus d’inscription, comme décrit dans [inscription d’un fournisseur](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="48387-106">The following procedure assumes that you have already implemented the registration process as described in [Registering a Provider](registering-a-provider.md).</span></span> <span data-ttu-id="48387-107">Si votre fournisseur stocke la plupart des données dans l’espace de stockage WMI et que celles-ci sont mises à jour uniquement lors de l’initialisation de WMI, enregistrez votre classe en tant que fournisseur de classe push.</span><span class="sxs-lookup"><span data-stu-id="48387-107">If your provider stores most data in the WMI repository and that data is updated only on WMI initialization, then register your class as a push class provider.</span></span> <span data-ttu-id="48387-108">Si les données que vous fournissez changent fréquemment et sont récupérées dynamiquement par votre code à chaque demande de WMI, inscrivez votre fournisseur en tant que fournisseur de classe pull.</span><span class="sxs-lookup"><span data-stu-id="48387-108">If the data you are providing changes frequently and is retrieved dynamically by your code on every request from WMI, then register your provider as a pull class provider.</span></span>

<span data-ttu-id="48387-109">La procédure suivante décrit comment inscrire un fournisseur de classes push.</span><span class="sxs-lookup"><span data-stu-id="48387-109">The following procedure describes how to register a push class provider.</span></span>

<span data-ttu-id="48387-110">**Pour inscrire un fournisseur de classes Push**</span><span class="sxs-lookup"><span data-stu-id="48387-110">**To register a push class provider**</span></span>

-   <span data-ttu-id="48387-111">Affectez la valeur 1 à la propriété **InteractionType** de l’instance [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) .</span><span class="sxs-lookup"><span data-stu-id="48387-111">Set the **InteractionType** property of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance to 1.</span></span>

    <span data-ttu-id="48387-112">La création d’une instance de [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) fait partie du processus d’inscription.</span><span class="sxs-lookup"><span data-stu-id="48387-112">Creating an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md) is part of the registration process.</span></span>

<span data-ttu-id="48387-113">La procédure suivante décrit comment inscrire un fournisseur de classe pull.</span><span class="sxs-lookup"><span data-stu-id="48387-113">The following procedure describes how to register a pull class provider.</span></span>

<span data-ttu-id="48387-114">**Pour inscrire un fournisseur de classe pull**</span><span class="sxs-lookup"><span data-stu-id="48387-114">**To register a pull class provider**</span></span>

1.  <span data-ttu-id="48387-115">Créez une instance de la classe [**\_ \_ Win32Provider**](--win32provider.md) qui décrit le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="48387-115">Create an instance of the [**\_\_Win32Provider**](--win32provider.md) class that describes the provider.</span></span>
2.  <span data-ttu-id="48387-116">Créez une instance de la classe [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) qui décrit l’ensemble des fonctionnalités du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="48387-116">Create an instance of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class that describes the feature set of the provider.</span></span>

    <span data-ttu-id="48387-117">Dans l’instance [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) :</span><span class="sxs-lookup"><span data-stu-id="48387-117">Within the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance:</span></span>

    1.  <span data-ttu-id="48387-118">Définissez la propriété **InteractionType** pour indiquer si le fournisseur est un fournisseur push ou pull.</span><span class="sxs-lookup"><span data-stu-id="48387-118">Set the **InteractionType** property to indicate whether the provider is a push or pull provider.</span></span>
    2.  <span data-ttu-id="48387-119">Baliser la classe avec les qualificateurs [**Dynamic**](standard-wmi-qualifiers.md) et [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) .</span><span class="sxs-lookup"><span data-stu-id="48387-119">Tag the class with both the [**Dynamic**](standard-wmi-qualifiers.md) and [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifiers.</span></span>

        <span data-ttu-id="48387-120">Le qualificateur [**dynamique**](standard-wmi-qualifiers.md) indique que WMI doit utiliser un fournisseur pour récupérer les instances de classe.</span><span class="sxs-lookup"><span data-stu-id="48387-120">The [**Dynamic**](standard-wmi-qualifiers.md) qualifier signals that WMI should use a provider to retrieve the class instances.</span></span> <span data-ttu-id="48387-121">Le qualificateur du [**fournisseur**](/windows/desktop/api/Provider/nl-provider-provider) spécifie le nom du fournisseur que WMI doit utiliser.</span><span class="sxs-lookup"><span data-stu-id="48387-121">The [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifier specifies the name of the provider that WMI should use.</span></span>

    3.  <span data-ttu-id="48387-122">Définissez les propriétés **ResultSetQueries**, **ReferencedSetQueries** et **UnsupportedQueries** .</span><span class="sxs-lookup"><span data-stu-id="48387-122">Define the **ResultSetQueries**, **ReferencedSetQueries**, and **UnsupportedQueries** properties.</span></span>

        <span data-ttu-id="48387-123">Ces propriétés de requête décrivent des informations détaillées sur la classe prise en charge.</span><span class="sxs-lookup"><span data-stu-id="48387-123">These query properties describe detailed information about the supported class.</span></span>

<span data-ttu-id="48387-124">En plus de décrire les différentes méthodes prises en charge d’une classe, la classe [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) a également trois propriétés qui décrivent une série de requêtes.</span><span class="sxs-lookup"><span data-stu-id="48387-124">In addition to describing the various supported methods of a class, the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class also has three properties that describe a series of queries.</span></span> <span data-ttu-id="48387-125">Lorsqu’elles sont utilisées ensemble, ces trois propriétés décrivent la plage entière des classes fournies par le fournisseur de classe.</span><span class="sxs-lookup"><span data-stu-id="48387-125">When used together, these three properties describe the entire range of classes supplied by the class provider.</span></span> <span data-ttu-id="48387-126">Chaque propriété de requête contient une instruction WQL SELECT, appelée « requête de schéma », pour spécifier les types de classes prises en charge.</span><span class="sxs-lookup"><span data-stu-id="48387-126">Each query property contains a WQL SELECT statement, called a "schema query," to specify the types of supported classes.</span></span> <span data-ttu-id="48387-127">Les requêtes de schéma spécifient un nom de classe spécial appelé méta \_ Class.</span><span class="sxs-lookup"><span data-stu-id="48387-127">Schema queries specify a special class name called meta\_class.</span></span> <span data-ttu-id="48387-128">Le tableau suivant répertorie les propriétés de la requête.</span><span class="sxs-lookup"><span data-stu-id="48387-128">The following table lists the query properties.</span></span>



| <span data-ttu-id="48387-129">Propriété</span><span class="sxs-lookup"><span data-stu-id="48387-129">Property</span></span>                 | <span data-ttu-id="48387-130">Description</span><span class="sxs-lookup"><span data-stu-id="48387-130">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="48387-131">**ResultSetQueries**</span><span class="sxs-lookup"><span data-stu-id="48387-131">**ResultSetQueries**</span></span>     | <span data-ttu-id="48387-132">Contient des informations sur le jeu de résultats fourni par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="48387-132">Contains information about the result set the provider supplies.</span></span> <span data-ttu-id="48387-133">WMI utilise les informations pour déterminer s’il faut appeler le fournisseur pour répondre à une requête à partir d’une application.</span><span class="sxs-lookup"><span data-stu-id="48387-133">WMI uses the information to determine whether to invoke the provider to satisfy a query from an application.</span></span> <span data-ttu-id="48387-134">Cette propriété décrit soit l’ensemble de toutes les classes que le fournisseur peut fournir, soit un sur-ensemble des classes disponibles, mais jamais un sous-ensemble.</span><span class="sxs-lookup"><span data-stu-id="48387-134">This property describes either the set of all classes that the provider can supply or a superset of the available classes, but never a subset.</span></span> <span data-ttu-id="48387-135">WMI requiert qu’un fournisseur spécifie au moins une requête dans cette propriété.</span><span class="sxs-lookup"><span data-stu-id="48387-135">WMI requires a provider to specify at least one query in this property.</span></span><br/> <span data-ttu-id="48387-136">L’exemple suivant montre comment définir **ResultSetQueries** lorsqu’un fournisseur fournit une classe d’association qui référence la [**classe \_ disque logique Win32**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) .</span><span class="sxs-lookup"><span data-stu-id="48387-136">The following example shows how to set **ResultSetQueries** when a provider supplies an association class that references the [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class.</span></span><br/> `SELECT * FROM meta_class WHERE __Class = "Win32_LogicalDisk"`<br/> <span data-ttu-id="48387-137">L’exemple suivant montre comment spécifier une requête générale lorsqu’un fournisseur fournit des classes qui font référence à d’autres classes inconnues.</span><span class="sxs-lookup"><span data-stu-id="48387-137">The following example shows how to specify a general query when a provider supplies classes that reference other unknown classes.</span></span><br/> `SELECT * FROM meta_class`<br/> <span data-ttu-id="48387-138">L’exemple suivant montre comment définir **ResultSetQueries** lorsqu’un fournisseur fournit uniquement des sous-classes, mais pas la classe parente d’une classe donnée.</span><span class="sxs-lookup"><span data-stu-id="48387-138">The following example shows how to set **ResultSetQueries** when a provider supplies only subclasses, but not the parent class of a given class.</span></span><br/> `SELECT * FROM meta_class WHERE __Dynasty = "MyClass"`<br/> <span data-ttu-id="48387-139">L’exemple suivant montre comment utiliser la propriété spéciale \_ \_ this et définir **ResultSetQueries** lorsqu’un fournisseur fournit toutes les classes et les sous-classes.</span><span class="sxs-lookup"><span data-stu-id="48387-139">The following example shows how to use the special \_\_this property and set **ResultSetQueries** when a provider supplies all class and subclasses.</span></span><br/> `SELECT * FROM meta_class WHERE __this ISA "MyClass"`<br/> |
| <span data-ttu-id="48387-140">**ReferencedSetQueries**</span><span class="sxs-lookup"><span data-stu-id="48387-140">**ReferencedSetQueries**</span></span> | <span data-ttu-id="48387-141">Détermine s’il faut ignorer le fournisseur dans les requêtes de schéma où des associations et des références sont demandées.</span><span class="sxs-lookup"><span data-stu-id="48387-141">Determines whether to bypass the provider in schema queries where associations and references are being requested.</span></span> <span data-ttu-id="48387-142">Les fournisseurs qui peuvent fournir des classes d’association doivent inclure au moins une requête dans leur propriété **ReferencedSetQueries** .</span><span class="sxs-lookup"><span data-stu-id="48387-142">Providers that can supply association classes must include at least one query in their **ReferencedSetQueries** property.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="48387-143">**UnsupportedQueries**</span><span class="sxs-lookup"><span data-stu-id="48387-143">**UnsupportedQueries**</span></span>   | <span data-ttu-id="48387-144">Contient des informations sur le jeu de résultats qu’un fournisseur de classe ne fournit pas.</span><span class="sxs-lookup"><span data-stu-id="48387-144">Contains information about the result set that a class provider does not supply.</span></span> <span data-ttu-id="48387-145">WMI utilise cette propriété pour soustraire de l’ensemble de classes impliqué par **ResultSetQueries**.</span><span class="sxs-lookup"><span data-stu-id="48387-145">WMI uses this property to subtract from the set of classes implied by **ResultSetQueries**.</span></span> <span data-ttu-id="48387-146">Par exemple, un fournisseur de classes peut spécifier la prise en charge de **ResultSetQueries** pour toutes les classes dérivées de MyClass et spécifier dans **UnsupportedQueries** un manque de prise en charge pour une classe dérivée particulière.</span><span class="sxs-lookup"><span data-stu-id="48387-146">For example, a class provider can specify in **ResultSetQueries** support for all classes derived from MyClass and specify in **UnsupportedQueries** a lack of support for one particular derived class.</span></span><br/> <span data-ttu-id="48387-147">Plus les informations qu’un fournisseur peuvent inscrire sur ses fonctionnalités de traitement des requêtes, plus l’exécution est rapide.</span><span class="sxs-lookup"><span data-stu-id="48387-147">The more information that a provider can register about its query processing capabilities, the faster it runs.</span></span> <span data-ttu-id="48387-148">La saisie d’une ou plusieurs requêtes dans la propriété **UnsupportedQueries** est une façon d’être spécifique et est particulièrement importante quand un fournisseur s’appuie sur une classe qu’il ne fournit pas.</span><span class="sxs-lookup"><span data-stu-id="48387-148">Entering one or more queries in the **UnsupportedQueries** property is one way to be specific and is particularly important when a provider relies on a class that it does not supply.</span></span> <span data-ttu-id="48387-149">Quand une requête est effectuée pour une classe qui est listée dans une requête de la propriété **UnsupportedQueries** , WMI peut fournir la classe elle-même ou appeler un autre fournisseur pour le fournir.</span><span class="sxs-lookup"><span data-stu-id="48387-149">When a request is made for a class that is listed in a query in the **UnsupportedQueries** property, WMI can supply the class itself or invoke an alternate provider to supply it.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

<span data-ttu-id="48387-150">Comme WMI ne prend pas en charge la clause ou, vous devez créer une requête distincte pour chaque classe.</span><span class="sxs-lookup"><span data-stu-id="48387-150">Because WMI does not support the OR clause, you must create a separate query for each class.</span></span>

<span data-ttu-id="48387-151">Les requêtes suivantes sont spécifiées dans **ResultSetQueries** lorsqu’un fournisseur de classes fournit MyClass1, MyClass2 et MyClass3.</span><span class="sxs-lookup"><span data-stu-id="48387-151">The following queries are specified in **ResultSetQueries** when a class provider supplies MyClass1, MyClass2, and MyClass3.</span></span>


```sql
SELECT * FROM meta_class WHERE __Class = "MyClass1"
SELECT * FROM meta_class WHERE __Class = "MyClass2"
SELECT * FROM meta_class WHERE __Class = "MyClass3"
```



<span data-ttu-id="48387-152">Seuls les administrateurs peuvent inscrire ou supprimer un fournisseur en créant une instance de [**\_ \_ Win32Provider**](--win32provider.md) et [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md).</span><span class="sxs-lookup"><span data-stu-id="48387-152">Only administrators can register or delete a provider by creating an instance of [**\_\_Win32Provider**](--win32provider.md) and [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span>

 

