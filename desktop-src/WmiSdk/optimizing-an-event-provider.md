---
description: Un fournisseur d’événements peut consacrer beaucoup de temps à la création d’événements.
ms.assetid: 5cf414f0-b3a8-4623-9aaa-08e2a28b40c0
ms.tgt_platform: multiple
title: Optimisation d’un fournisseur d’événements
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70eaabfbbd462b831059b10590d7959bdef05cbc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106526932"
---
# <a name="optimizing-an-event-provider"></a><span data-ttu-id="6ea04-103">Optimisation d’un fournisseur d’événements</span><span class="sxs-lookup"><span data-stu-id="6ea04-103">Optimizing an Event Provider</span></span>

<span data-ttu-id="6ea04-104">Un fournisseur d’événements peut consacrer beaucoup de temps à la création d’événements.</span><span class="sxs-lookup"><span data-stu-id="6ea04-104">An event provider may devote a great deal of time to creating events.</span></span> <span data-ttu-id="6ea04-105">Si aucune application cliente n’utilise les événements créés, le fournisseur gaspille les ressources système.</span><span class="sxs-lookup"><span data-stu-id="6ea04-105">If no client applications use the created events, then the provider is wasting system resources.</span></span> <span data-ttu-id="6ea04-106">En outre, WMI passe une quantité considérable de ressources à analyser et à envoyer des requêtes complexes au fournisseur approprié.</span><span class="sxs-lookup"><span data-stu-id="6ea04-106">Further, WMI spends a considerable amount of resources parsing and sending complex queries to the appropriate provider.</span></span> <span data-ttu-id="6ea04-107">Pour éviter le gaspillage des ressources système et améliorer les performances de votre fournisseur d’événements, vous pouvez implémenter l’interface [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) .</span><span class="sxs-lookup"><span data-stu-id="6ea04-107">To avoid the waste of system resources and to improve the performance of your event provider, you can implement the [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) interface.</span></span> <span data-ttu-id="6ea04-108">**IWbemEventProviderQuerySink** surveille les requêtes enregistrées par les applications clientes auprès de WMI à l’aide des méthodes [**newquery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) et [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) .</span><span class="sxs-lookup"><span data-stu-id="6ea04-108">**IWbemEventProviderQuerySink** monitors the queries that client applications register with WMI by using the [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) and [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) methods.</span></span> <span data-ttu-id="6ea04-109">En surveillant les requêtes des clients inscrits, votre fournisseur peut déterminer si des messages doivent être envoyés à WMI.</span><span class="sxs-lookup"><span data-stu-id="6ea04-109">By monitoring the registered client queries, your provider can determine what if any messages must be sent to WMI.</span></span>

<span data-ttu-id="6ea04-110">WMI appelle [**newquery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) sur un fournisseur d’événements lorsqu’un consommateur client inscrit une requête de filtre d’événement qui contient des références aux événements pris en charge par ce fournisseur d’événements.</span><span class="sxs-lookup"><span data-stu-id="6ea04-110">WMI calls [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) on an event provider when a client consumer registers an event filter query that contains references to events supported by that event provider.</span></span> <span data-ttu-id="6ea04-111">Ainsi, le fournisseur d’événements responsable des événements de modification d’instance pour la classe **EmailClass** peut être configuré pour générer des notifications uniquement pour l' **expéditeur**.</span><span class="sxs-lookup"><span data-stu-id="6ea04-111">So the event provider responsible for instance modification events for the **EmailClass** class can be set up to generate notifications only for **sender**.</span></span> <span data-ttu-id="6ea04-112">Lorsque le fournisseur reçoit une requête demandant la notification des modifications apportées à la propriété **Subject** , le fournisseur peut commencer à générer ces notifications.</span><span class="sxs-lookup"><span data-stu-id="6ea04-112">When the provider receives a query requesting notification of changes to the **subject** property, the provider can start generating those notifications.</span></span> <span data-ttu-id="6ea04-113">Dans ce scénario, WMI n’est pas obligé d’ignorer les notifications qui modifient uniquement les **destinataires** du rapport.</span><span class="sxs-lookup"><span data-stu-id="6ea04-113">In this scenario, WMI is not required to discard the notifications that report **recipient** changes only.</span></span>

<span data-ttu-id="6ea04-114">De même, WMI appelle [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) sur un fournisseur d’événements lorsqu’un consommateur client annule l’inscription d’une requête de filtre d’événement qui contient des références aux événements pris en charge par le fournisseur d’événements.</span><span class="sxs-lookup"><span data-stu-id="6ea04-114">Similarly, WMI calls [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) on an event provider when a client consumer deregisters an event filter query that contains references to events supported by the event provider.</span></span> <span data-ttu-id="6ea04-115">L’objectif de **CancelQuery** est que le fournisseur d’événements met à jour la liste des événements à envoyer.</span><span class="sxs-lookup"><span data-stu-id="6ea04-115">The purpose of **CancelQuery** is for the event provider to update the list of what events should be sent out.</span></span>

> [!Note]  
> <span data-ttu-id="6ea04-116">Si votre fournisseur prend en charge à la fois [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) et [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), assurez-vous que votre implémentation de la méthode **IUnknown :: QueryInterface** retourne des pointeurs vers les deux interfaces.</span><span class="sxs-lookup"><span data-stu-id="6ea04-116">If your provider supports both [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) and [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), ensure that your implementation of the **IUnknown::QueryInterface** method returns pointers to both interfaces.</span></span>

 

 

 



