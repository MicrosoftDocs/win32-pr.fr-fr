---
description: Un fournisseur WMI se compose d’un fichier de format MOF (MOF) et d’un fichier DLL. Le fichier MOF définit les classes pour lesquelles l’implémentation du fournisseur fournit des données.
ms.assetid: 20ef6b88-2aaa-4e86-bc4a-bebc34069672
ms.tgt_platform: multiple
title: Conception de classes format MOF (MOF)
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 201f8c45f7a247fbca5695baa6dd440fc5dc323f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104203739"
---
# <a name="designing-managed-object-format-mof-classes"></a><span data-ttu-id="2f23c-104">Conception de classes format MOF (MOF)</span><span class="sxs-lookup"><span data-stu-id="2f23c-104">Designing Managed Object Format (MOF) Classes</span></span>

<span data-ttu-id="2f23c-105">Un [*fournisseur WMI*](gloss-p.md) se compose d’un fichier de format MOF (MOF) et d’un fichier dll.</span><span class="sxs-lookup"><span data-stu-id="2f23c-105">A [*WMI provider*](gloss-p.md) consists of a Managed Object Format (MOF) file and DLL file.</span></span> <span data-ttu-id="2f23c-106">Le fichier MOF définit les classes pour lesquelles l’implémentation du fournisseur fournit des données.</span><span class="sxs-lookup"><span data-stu-id="2f23c-106">The MOF file defines the classes for which the provider implementation supplies data.</span></span>

<span data-ttu-id="2f23c-107">Les définitions de classe MOF sont compilées par l’utilitaire [**mofcomp**](mofcomp.md) et stockées dans le [*référentiel WMI*](gloss-w.md), également connu sous le nom de référentiel Common Information Model (CIM).</span><span class="sxs-lookup"><span data-stu-id="2f23c-107">The MOF class definitions are compiled by the [**mofcomp**](mofcomp.md) utility and stored in the [*WMI repository*](gloss-w.md), also known as the Common Information Model (CIM) repository.</span></span> <span data-ttu-id="2f23c-108">Une façon moins courante de créer des classes consiste à utiliser les méthodes de l' [API com pour WMI](com-api-for-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="2f23c-108">A less common way to create classes is through the methods of the [COM API for WMI](com-api-for-wmi.md).</span></span>

> [!Note]  
> <span data-ttu-id="2f23c-109">Pour vous assurer que toutes les définitions de classe WMI pour les objets managés sont restaurées dans l' [*espace de stockage WMI*](gloss-w.md) en cas d’échec et de redémarrage de WMI, utilisez l’instruction [**\# pragma AutoRecover**](pragma-autorecover.md) de préprocesseur dans votre fichier MOF.</span><span class="sxs-lookup"><span data-stu-id="2f23c-109">To ensure that all your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your MOF file.</span></span>

 

<span data-ttu-id="2f23c-110">Les sections suivantes sont présentées dans cette rubrique :</span><span class="sxs-lookup"><span data-stu-id="2f23c-110">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="2f23c-111">Définition des objets à gérer</span><span class="sxs-lookup"><span data-stu-id="2f23c-111">Defining the Objects to Manage</span></span>](#defining-the-objects-to-manage)
-   [<span data-ttu-id="2f23c-112">Définition des propriétés ou des méthodes</span><span class="sxs-lookup"><span data-stu-id="2f23c-112">Defining Properties or Methods</span></span>](#defining-properties-or-methods)
-   [<span data-ttu-id="2f23c-113">Association d’objets entre eux</span><span class="sxs-lookup"><span data-stu-id="2f23c-113">Relating Objects to Each Other</span></span>](#relating-objects-to-each-other)
-   [<span data-ttu-id="2f23c-114">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="2f23c-114">Related topics</span></span>](#related-topics)

## <a name="defining-the-objects-to-manage"></a><span data-ttu-id="2f23c-115">Définition des objets à gérer</span><span class="sxs-lookup"><span data-stu-id="2f23c-115">Defining the Objects to Manage</span></span>

<span data-ttu-id="2f23c-116">Une fois que vous avez identifié la partie de votre entreprise à gérer, définissez les objets à gérer.</span><span class="sxs-lookup"><span data-stu-id="2f23c-116">After you identify the part of your enterprise to manage, define the objects to manage.</span></span> <span data-ttu-id="2f23c-117">La définition doit inclure les données requises et vous permettre d’implémenter les règles d’entreprise appropriées avec précision.</span><span class="sxs-lookup"><span data-stu-id="2f23c-117">The definition must include the required data, and allow you to implement the relevant business rules accurately.</span></span> <span data-ttu-id="2f23c-118">Vous pouvez définir des objets à un niveau granulaire, mais il est préférable de choisir entre le niveau de détail contenu dans la définition et la nécessité de fournir suffisamment de détails pour être utiles.</span><span class="sxs-lookup"><span data-stu-id="2f23c-118">You can define objects at a granular level, but it is best to decide between the level of detail contained in the definition, and the need to provide enough detail to be useful.</span></span> <span data-ttu-id="2f23c-119">Les raccourcis au début du processus peuvent vous faire gagner du temps, mais peuvent être plus utilisés à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="2f23c-119">Shortcuts early in the process may save time, but may be cause more work in the future.</span></span>

<span data-ttu-id="2f23c-120">Le didacticiel CIM sur le site Web DMTF (Distributed Management Task Force) contient des informations d’excellence sur le processus de conception.</span><span class="sxs-lookup"><span data-stu-id="2f23c-120">The CIM Tutorial at the Distributed Management Task Force (DMTF) website contains excellent information about the design process.</span></span> <span data-ttu-id="2f23c-121">Pour plus d’informations, consultez [www.dmtf.org](https://www.dmtf.org/).</span><span class="sxs-lookup"><span data-stu-id="2f23c-121">For more information, see [www.dmtf.org](https://www.dmtf.org/).</span></span>

<span data-ttu-id="2f23c-122">Tenez compte des facteurs suivants lorsque vous développez et implémentez une conception de schéma :</span><span class="sxs-lookup"><span data-stu-id="2f23c-122">Consider the following factors when you develop and implement a schema design:</span></span>

-   <span data-ttu-id="2f23c-123">Qualificateurs</span><span class="sxs-lookup"><span data-stu-id="2f23c-123">Qualifiers</span></span>

    <span data-ttu-id="2f23c-124">Les qualificateurs fournissent des informations sur la façon de décrire des classes, des objets, des propriétés, des méthodes et des paramètres. et elles sont appliquées aux définitions de classe et de propriété.</span><span class="sxs-lookup"><span data-stu-id="2f23c-124">Qualifiers provide information about how to describe classes, objects, properties, methods, and parameters; and they are applied to class and property definitions.</span></span> <span data-ttu-id="2f23c-125">Dans le code MOF, les qualificateurs sont placés entre crochets et peuvent inclure une \[ clé \] ou une \[ Association \] .</span><span class="sxs-lookup"><span data-stu-id="2f23c-125">In MOF code, qualifiers are enclosed in brackets and may include \[key\] or \[association\].</span></span> <span data-ttu-id="2f23c-126">Pour plus d’informations, consultez [Ajout d’un qualificateur](adding-a-qualifier.md) et [qualificateurs WMI](wmi-qualifiers.md).</span><span class="sxs-lookup"><span data-stu-id="2f23c-126">For more information, see [Adding a Qualifier](adding-a-qualifier.md) and [WMI Qualifiers](wmi-qualifiers.md).</span></span>

-   <span data-ttu-id="2f23c-127">Espace de noms</span><span class="sxs-lookup"><span data-stu-id="2f23c-127">Namespace</span></span>

    <span data-ttu-id="2f23c-128">Un espace de noms est une unité logique pour regrouper des classes et des objets, et pour contrôler la portée et la visibilité.</span><span class="sxs-lookup"><span data-stu-id="2f23c-128">A namespace is a logical unit to group classes and objects, and control scope and visibility.</span></span> <span data-ttu-id="2f23c-129">En général, un espace de noms contient un ensemble de classes et d’objets qui représentent des objets managés dans un environnement spécifique.</span><span class="sxs-lookup"><span data-stu-id="2f23c-129">Typically, a namespace contains a set of classes and objects that represent managed objects in a specific environment.</span></span> <span data-ttu-id="2f23c-130">Pour plus d’informations, consultez [création de hiérarchies dans WMI](creating-hierarchies-within-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="2f23c-130">For more information, see [Creating Hierarchies Within WMI](creating-hierarchies-within-wmi.md).</span></span>

-   <span data-ttu-id="2f23c-131">Object</span><span class="sxs-lookup"><span data-stu-id="2f23c-131">Object</span></span>

    <span data-ttu-id="2f23c-132">Un objet modélisé peut être un élément physique ou logique du schéma.</span><span class="sxs-lookup"><span data-stu-id="2f23c-132">A modeled object might be a physical or logical element of the schema.</span></span> <span data-ttu-id="2f23c-133">Par exemple, vous pouvez modéliser un lecteur de disque physique, tel qu’un disque dur, ou un disque logique qui peut être une partition sur un disque physique.</span><span class="sxs-lookup"><span data-stu-id="2f23c-133">For example, you can model a physical disk drive such as a hard disk drive, or a logical disk that can be a partition on a physical disk.</span></span> <span data-ttu-id="2f23c-134">Une conception qui utilise une classe pour modéliser un lecteur de disque physique, puis étend cette classe pour modéliser un disque logique est plus extensible qu’une conception qui tente de créer une classe distincte pour chaque type de disque.</span><span class="sxs-lookup"><span data-stu-id="2f23c-134">A design that uses a class to model a physical disk drive, and then extends that class to model a logical disk is more extensible than one that attempts to create a separate class for each type of disk.</span></span>

-   <span data-ttu-id="2f23c-135">Données</span><span class="sxs-lookup"><span data-stu-id="2f23c-135">Data</span></span>

    <span data-ttu-id="2f23c-136">Les données peuvent être dynamiques ou statiques.</span><span class="sxs-lookup"><span data-stu-id="2f23c-136">Data may be dynamic or static.</span></span> <span data-ttu-id="2f23c-137">Si les données sont dynamiques, vous devez créer un fournisseur de classes pour celle-ci.</span><span class="sxs-lookup"><span data-stu-id="2f23c-137">If the data is dynamic, you must create a class provider for it.</span></span>

    <span data-ttu-id="2f23c-138">Pour permettre à l’utilisateur de modifier des données, vous devez déterminer si vous souhaitez ou non qu’une propriété soit directement accessible en écriture ou modifiable uniquement à l’aide d’une méthode appelée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2f23c-138">To enable the user to modify data, you must determine whether or not you want a property to be directly writable or modifiable only by using a method that the user calls.</span></span>

## <a name="defining-properties-or-methods"></a><span data-ttu-id="2f23c-139">Définition des propriétés ou des méthodes</span><span class="sxs-lookup"><span data-stu-id="2f23c-139">Defining Properties or Methods</span></span>

<span data-ttu-id="2f23c-140">En règle générale, une propriété de classe WMI est semblable à une propriété dans une classe C++.</span><span class="sxs-lookup"><span data-stu-id="2f23c-140">Generally, a WMI class property is similar to a property in a C++ class.</span></span> <span data-ttu-id="2f23c-141">Si les seules actions que votre code implémente pour l’élément de données est d’obtenir la valeur ou de définir la valeur, les données doivent être définies en tant que propriété de la classe WMI.</span><span class="sxs-lookup"><span data-stu-id="2f23c-141">If the only actions your code implements for the piece of data is to get the value or set the value, then the data should be defined as a property of the WMI class.</span></span>

<span data-ttu-id="2f23c-142">Une méthode WMI effectue généralement une action qui modifie l’état d’un objet managé.</span><span class="sxs-lookup"><span data-stu-id="2f23c-142">A WMI method generally performs an action that changes the state of a managed object.</span></span> <span data-ttu-id="2f23c-143">Par exemple, si l’action consiste à activer ou désactiver l’opération d’un objet matériel, une méthode est probablement préférable à la création d’une propriété en lecture/écriture.</span><span class="sxs-lookup"><span data-stu-id="2f23c-143">For example, if the action is to enable or disable the operation of a hardware object, then a method is probably preferable to creating a read/write property.</span></span> <span data-ttu-id="2f23c-144">Vous pouvez également décider de créer une propriété qui affiche l’état du matériel.</span><span class="sxs-lookup"><span data-stu-id="2f23c-144">You may decide also to create a property that displays the state of the hardware.</span></span>

<span data-ttu-id="2f23c-145">Lorsque vous créez une classe ou une instance, vous pouvez inclure des commentaires.</span><span class="sxs-lookup"><span data-stu-id="2f23c-145">When you create a class or an instance, you can include comments.</span></span> <span data-ttu-id="2f23c-146">Utilisez cette technique pour documenter votre classe ou expliquer vos techniques de programmation.</span><span class="sxs-lookup"><span data-stu-id="2f23c-146">Use this technique to document your class or explain your programming techniques.</span></span> <span data-ttu-id="2f23c-147">Pour plus d’informations, consultez [création d’un commentaire](creating-a-comment.md).</span><span class="sxs-lookup"><span data-stu-id="2f23c-147">For more information, see [Creating a Comment](creating-a-comment.md).</span></span> <span data-ttu-id="2f23c-148">En outre, vous pouvez ajouter des données pour qualifier l’objectif d’un objet de données.</span><span class="sxs-lookup"><span data-stu-id="2f23c-148">In addition, you can add data to qualify the purpose of a data object.</span></span> <span data-ttu-id="2f23c-149">Pour plus d’informations, consultez [Ajout d’un qualificateur](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="2f23c-149">For more information, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

## <a name="relating-objects-to-each-other"></a><span data-ttu-id="2f23c-150">Association d’objets entre eux</span><span class="sxs-lookup"><span data-stu-id="2f23c-150">Relating Objects to Each Other</span></span>

<span data-ttu-id="2f23c-151">Il existe deux façons de lier des objets les uns aux autres : en créant des objets distincts et un objet Association qui les associe, ou en incorporant un objet dans l’autre.</span><span class="sxs-lookup"><span data-stu-id="2f23c-151">There are two ways to relate objects to each other: by creating separate objects and an association object that relates them, or by embedding one object in the other.</span></span> <span data-ttu-id="2f23c-152">CIM ne prend pas en charge les objets incorporés. pour être conforme à la norme CIM, vous devez utiliser la première méthode.</span><span class="sxs-lookup"><span data-stu-id="2f23c-152">CIM does not support embedded objects, so to be CIM-compliant you must use the first method.</span></span> <span data-ttu-id="2f23c-153">Toutefois, WMI prend en charge les objets incorporés. Utilisez l’une ou l’autre méthode pour représenter une relation entre les objets.</span><span class="sxs-lookup"><span data-stu-id="2f23c-153">However, WMI supports embedded objects so use either method to represent a relationship between objects.</span></span> <span data-ttu-id="2f23c-154">Vous trouverez des exemples d’objets incorporés dans les [classes Win32](/windows/desktop/CIMWin32Prov/win32-provider).</span><span class="sxs-lookup"><span data-stu-id="2f23c-154">You can find examples of embedded objects in the [Win32 Classes](/windows/desktop/CIMWin32Prov/win32-provider).</span></span> <span data-ttu-id="2f23c-155">Par exemple, [**le \_ SecurityDescriptor Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) a l’objet incorporé [**Win32 \_ ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace), qui dispose d’un autre objet incorporé, [**Win32 \_ Trusted**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee).</span><span class="sxs-lookup"><span data-stu-id="2f23c-155">For example, [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) has the embedded object [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace), which has another embedded object, [**Win32\_Trustee**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee).</span></span>

<span data-ttu-id="2f23c-156">Tenez compte des éléments suivants lorsque vous décidez de la façon de représenter des relations entre des objets :</span><span class="sxs-lookup"><span data-stu-id="2f23c-156">Consider the following when deciding how to represent relationships between objects:</span></span>

-   <span data-ttu-id="2f23c-157">Si une instance est utile par elle-même, une association fonctionne mieux.</span><span class="sxs-lookup"><span data-stu-id="2f23c-157">If an instance is useful by itself, then an association works best.</span></span> <span data-ttu-id="2f23c-158">Par exemple, [**le \_ processus Win32**](/windows/desktop/CIMWin32Prov/win32-process) et [**Win32 \_ UserAccount**](/windows/desktop/CIMWin32Prov/win32-useraccount).</span><span class="sxs-lookup"><span data-stu-id="2f23c-158">For example, [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) and [**Win32\_UserAccount**](/windows/desktop/CIMWin32Prov/win32-useraccount).</span></span> <span data-ttu-id="2f23c-159">Pour plus d’informations, consultez [déclaration d’une classe d’association](declaring-an-association-class.md).</span><span class="sxs-lookup"><span data-stu-id="2f23c-159">For more information, see [Declaring an Association Class](declaring-an-association-class.md).</span></span>
-   <span data-ttu-id="2f23c-160">Si une instance n’existe pas en dehors de l’objet parent, un objet incorporé fonctionne mieux.</span><span class="sxs-lookup"><span data-stu-id="2f23c-160">If an instance does not exist outside of the parent object, an embedded object works best.</span></span> <span data-ttu-id="2f23c-161">Par exemple, [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) et [**Win32 \_ ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace).</span><span class="sxs-lookup"><span data-stu-id="2f23c-161">For example, [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) and [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace).</span></span> <span data-ttu-id="2f23c-162">Pour plus d’informations, consultez [incorporation d’objets dans une classe](embedded-objects.md).</span><span class="sxs-lookup"><span data-stu-id="2f23c-162">For more information, see [Embedding Objects in a Class](embedded-objects.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="2f23c-163">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="2f23c-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2f23c-164">Développement d’un fournisseur WMI</span><span class="sxs-lookup"><span data-stu-id="2f23c-164">Developing a WMI Provider</span></span>](developing-a-wmi-provider.md)
</dt> <dt>

[<span data-ttu-id="2f23c-165">Fourniture de données à WMI</span><span class="sxs-lookup"><span data-stu-id="2f23c-165">Providing Data to WMI</span></span>](providing-data-to-wmi.md)
</dt> <dt>

[<span data-ttu-id="2f23c-166">Types de données MOF</span><span class="sxs-lookup"><span data-stu-id="2f23c-166">MOF Data Types</span></span>](mof-data-types.md)
</dt> </dl>

 

 
