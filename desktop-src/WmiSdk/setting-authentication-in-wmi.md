---
description: Lorsque vous effectuez des appels en dehors du processus appelant ou à un service WMI distant, WMI utilise la version distribuée du modèle COM (Component Object Model).
ms.assetid: 261b4f18-5de5-4e06-a887-f5afd9c45511
ms.tgt_platform: multiple
title: Configuration de l’authentification dans WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0293d74c528e7c1c0e77a1ffb9f5f9ee7dfd5f00
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104203728"
---
# <a name="setting-authentication-in-wmi"></a><span data-ttu-id="62d9a-103">Configuration de l’authentification dans WMI</span><span class="sxs-lookup"><span data-stu-id="62d9a-103">Setting Authentication in WMI</span></span>

<span data-ttu-id="62d9a-104">Lorsque vous effectuez des appels en dehors du processus appelant ou à un service WMI distant, WMI utilise la version distribuée du modèle COM (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="62d9a-104">When making calls outside of the calling process or to a remote WMI service, WMI uses the distributed version of the Component Object Model (DCOM).</span></span> <span data-ttu-id="62d9a-105">Les appels hors processus et distants sont effectués par le biais de proxies, qui requièrent l’authentification des informations d’identification du processus appelant.</span><span class="sxs-lookup"><span data-stu-id="62d9a-105">Out-of-process and remote calls are made through proxies, which require authentication of the credentials of the calling process.</span></span>

<span data-ttu-id="62d9a-106">Vous définissez le niveau d’authentification lors de la connexion à un ordinateur et à un espace de noms WMI.</span><span class="sxs-lookup"><span data-stu-id="62d9a-106">You set the authentication level when connecting to a computer and WMI namespace.</span></span> <span data-ttu-id="62d9a-107">Pour vous connecter à WMI, appelez [**IWbemLocator :: ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) en C++.</span><span class="sxs-lookup"><span data-stu-id="62d9a-107">To connect to WMI, call [**IWbemLocator::ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) in C++.</span></span> <span data-ttu-id="62d9a-108">Dans les scripts ou les Visual Basic, vous vous connectez à WMI à l’aide de SWbemLocator. ConnectServer ou de la chaîne de [moniker](constructing-a-moniker-string.md) .</span><span class="sxs-lookup"><span data-stu-id="62d9a-108">In scripting or Visual Basic, you connect to WMI using SWbemLocator.ConnectServer or through the [moniker](constructing-a-moniker-string.md) string.</span></span> <span data-ttu-id="62d9a-109">La sécurité DCOM et WMI requièrent tous deux des niveaux d’authentification lors de la connexion entre les ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="62d9a-109">DCOM security and WMI both require certain authentication levels when connecting between computers.</span></span> <span data-ttu-id="62d9a-110">Le niveau requis varie selon le système d’exploitation que vous connectez.</span><span class="sxs-lookup"><span data-stu-id="62d9a-110">The required level differs according to which operating system you are connecting.</span></span> <span data-ttu-id="62d9a-111">Pour plus d’informations, consultez [connexion à WMI sur un ordinateur distant](connecting-to-wmi-on-a-remote-computer.md).</span><span class="sxs-lookup"><span data-stu-id="62d9a-111">For more information, see [Connecting to WMI on a Remote Computer](connecting-to-wmi-on-a-remote-computer.md).</span></span>

<span data-ttu-id="62d9a-112">WMI s’exécute normalement dans un hôte de service partagé et partage la même authentification que les autres processus de l’hôte.</span><span class="sxs-lookup"><span data-stu-id="62d9a-112">WMI normally runs in a shared service host and shares the same authentication as other processes in the host.</span></span> <span data-ttu-id="62d9a-113">Pour exécuter le processus WMI avec un autre niveau d’authentification, exécutez WMI avec la commande [**winmgmt**](winmgmt.md) avec le commutateur **/standalonehost** et définissez le niveau d’authentification pour WMI en général.</span><span class="sxs-lookup"><span data-stu-id="62d9a-113">To run the WMI process with a different level of authentication, run WMI with the [**winmgmt**](winmgmt.md) command with the **/standalonehost** switch and set the authentication level for WMI generally.</span></span> <span data-ttu-id="62d9a-114">Pour plus d’informations, consultez [maintenance de la sécurité WMI](maintaining-wmi-security.md).</span><span class="sxs-lookup"><span data-stu-id="62d9a-114">For more information, see [Maintaining WMI Security](maintaining-wmi-security.md).</span></span>

<span data-ttu-id="62d9a-115">Pour plus d’informations et des exemples de code sur la façon de définir l’authentification pour les connexions WMI, consultez [définition du service d’authentification à l’aide de VBScript](setting-the-authentication-service-using-vbscript.md) et définition de l' [authentification à l’aide de C++](setting-authentication-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="62d9a-115">For more information and code examples of how to set authentication for WMI connections, see [Setting the Authentication Service using VBScript](setting-the-authentication-service-using-vbscript.md) and [Setting Authentication Using C++](setting-authentication-using-c-.md).</span></span> <span data-ttu-id="62d9a-116">Ces rubriques contiennent également des tables qui répertorient les constantes d’authentification pour C++ et les scripts.</span><span class="sxs-lookup"><span data-stu-id="62d9a-116">These topics also contain tables that list the authentication constants for C++ and scripting.</span></span>

## <a name="using-proxies-in-wmi"></a><span data-ttu-id="62d9a-117">Utilisation de proxies dans WMI</span><span class="sxs-lookup"><span data-stu-id="62d9a-117">Using Proxies in WMI</span></span>

<span data-ttu-id="62d9a-118">Pour définir l’authentification d’un proxy, appelez la fonction [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) .</span><span class="sxs-lookup"><span data-stu-id="62d9a-118">To set authentication for a proxy, call the [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) function.</span></span> <span data-ttu-id="62d9a-119">Pour plus d’informations et pour obtenir un exemple de code, consultez [définition de la sécurité sur IWbemServices et d’autres proxies](setting-the-security-on-iwbemservices-and-other-proxies.md).</span><span class="sxs-lookup"><span data-stu-id="62d9a-119">For more information and a code example, see [Setting the Security on IWbemServices and Other Proxies](setting-the-security-on-iwbemservices-and-other-proxies.md).</span></span>

<span data-ttu-id="62d9a-120">L' [API com pour](com-api-for-wmi.md) les objets WMI suivante utilisent des proxys directement en C++ ou C# pour appeler hors processus ou un service WMI distant :</span><span class="sxs-lookup"><span data-stu-id="62d9a-120">The following [COM API for WMI](com-api-for-wmi.md) objects use proxies directly in C++ or C# to call out of process or to a remote WMI service:</span></span>

-   [<span data-ttu-id="62d9a-121">**IWbemServices**</span><span class="sxs-lookup"><span data-stu-id="62d9a-121">**IWbemServices**</span></span>](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices)
-   [<span data-ttu-id="62d9a-122">**IEnumWbemClassObject**</span><span class="sxs-lookup"><span data-stu-id="62d9a-122">**IEnumWbemClassObject**</span></span>](/windows/desktop/api/Wbemcli/nn-wbemcli-ienumwbemclassobject)
-   [<span data-ttu-id="62d9a-123">**IWbemCallResult**</span><span class="sxs-lookup"><span data-stu-id="62d9a-123">**IWbemCallResult**</span></span>](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult)
-   [<span data-ttu-id="62d9a-124">**IWbemRefresher**</span><span class="sxs-lookup"><span data-stu-id="62d9a-124">**IWbemRefresher**</span></span>](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher)

<span data-ttu-id="62d9a-125">Les objets de script, tels que [**SWbemObject**](swbemobject.md), [**SWbemServices**](swbemservices.md)et [**SWbemRefresher**](swbemrefresher.md) , n’utilisent pas directement les proxys.</span><span class="sxs-lookup"><span data-stu-id="62d9a-125">The scripting objects, such as [**SWbemObject**](swbemobject.md), [**SWbemServices**](swbemservices.md), and [**SWbemRefresher**](swbemrefresher.md) do not use proxies directly.</span></span> <span data-ttu-id="62d9a-126">Au lieu de cela, les objets de script représentent un wrapper ou une couche qui appelle l' [API com pour](com-api-for-wmi.md) les objets WMI listés ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="62d9a-126">Instead, the scripting objects represent a wrapper or layer that calls into the [COM API for WMI](com-api-for-wmi.md) objects listed above.</span></span> <span data-ttu-id="62d9a-127">Pour plus d’informations et pour obtenir un exemple de code de configuration de l’authentification dans les scripts, consultez [définition du niveau de sécurité de processus par défaut à l’aide de VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="62d9a-127">For more information and a code example of setting authentication in scripting, see [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

 

 
