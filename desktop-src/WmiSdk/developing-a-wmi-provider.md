---
description: Un fournisseur est un objet COM (Component Object Model) qui joue le rôle d’intermédiaire entre WMI et un objet géré.
ms.assetid: a4f537ba-9081-43b4-acff-4d206de3d9d7
ms.tgt_platform: multiple
title: Développement d’un fournisseur WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9249c251f75f08f9e5142e70a507b0dced8f91df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106519631"
---
# <a name="developing-a-wmi-provider"></a><span data-ttu-id="1a669-103">Développement d’un fournisseur WMI</span><span class="sxs-lookup"><span data-stu-id="1a669-103">Developing a WMI Provider</span></span>

<span data-ttu-id="1a669-104">Un fournisseur est un objet COM (Component Object Model) qui joue le rôle d’intermédiaire entre WMI et un objet géré.</span><span class="sxs-lookup"><span data-stu-id="1a669-104">A provider is a Component Object Model (COM) object that acts as an intermediary between WMI and a managed object.</span></span> <span data-ttu-id="1a669-105">Par exemple, lorsqu’une application ou un script demande des données de disque à l’aide de la classe [**\_ LogicalDisk WMI Win32**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) , les données sont obtenues de manière dynamique via le [fournisseur Win32](/windows/desktop/CIMWin32Prov/win32-provider)préinstallé.</span><span class="sxs-lookup"><span data-stu-id="1a669-105">For example, when an application or script requests disk data using the WMI [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class, the data is obtained dynamically through the preinstalled [Win32 provider](/windows/desktop/CIMWin32Prov/win32-provider).</span></span>

<span data-ttu-id="1a669-106">Si vous souhaitez fournir des données via WMI à d’autres applications, vous pouvez créer un fournisseur de code non géré en écrivant un serveur COM ou via les **assistants WMI ATL** dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1a669-106">If you want to supply data through WMI to other applications, you can create an unmanaged code provider by writing a COM server or through the **WMI ATL wizards** in Visual Studio.</span></span> <span data-ttu-id="1a669-107">Vous pouvez écrire un fournisseur de code managé à l’aide de WMI dans l' .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1a669-107">You can write a managed code provider by using WMI in the .NET Framework.</span></span> <span data-ttu-id="1a669-108">Les rubriques de cette section décrivent le processus d’écriture d’un fournisseur COM non managé.</span><span class="sxs-lookup"><span data-stu-id="1a669-108">The topics in this section describe the process of writing an unmanaged COM provider.</span></span>

> [!Note]  
> <span data-ttu-id="1a669-109">Pour vous assurer que toutes les définitions de classe WMI pour les objets managés sont restaurées dans l' [*espace de stockage WMI*](gloss-w.md) en cas d’échec et de redémarrage de WMI, utilisez l’instruction [**\# pragma AutoRecover**](pragma-autorecover.md) de préprocesseur dans votre fichier format MOF (MOF).</span><span class="sxs-lookup"><span data-stu-id="1a669-109">To ensure that all of your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your Managed Object Format (MOF) file.</span></span>

 

<span data-ttu-id="1a669-110">Un fournisseur se compose de classes définies dans le schéma [*format MOF (MOF)*](gloss-m.md) et d’un fichier dll qui exécute les fonctions du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1a669-110">A provider consists of classes defined in the [*Managed Object Format (MOF)*](gloss-m.md) schema and a DLL file which carries out the functions of the provider.</span></span> <span data-ttu-id="1a669-111">Par exemple, le fichier MOF qui définit les classes du fournisseur Win32 est CIMWin32. mof et la DLL est CIMWin32.dll, tous deux se trouvent dans% windir% \\ system32 \\ WBEM.</span><span class="sxs-lookup"><span data-stu-id="1a669-111">For example, the MOF that defines the classes of the Win32 provider is CIMWin32.mof and the DLL is CIMWin32.dll, both are found in %windir%\\System32\\Wbem.</span></span>

<span data-ttu-id="1a669-112">Le schéma MOF du fournisseur peut contenir plusieurs types de fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="1a669-112">The MOF schema for the provider may contain several provider types.</span></span> <span data-ttu-id="1a669-113">Par exemple, le [fournisseur du journal des événements](/previous-versions/windows/desktop/eventlogprov/event-log-provider) possède des types d’instance, de méthode et de fournisseur d’événements dans un fichier MOF nommé ntevt. mof.</span><span class="sxs-lookup"><span data-stu-id="1a669-113">For example, the [Event Log Provider](/previous-versions/windows/desktop/eventlogprov/event-log-provider) has instance, method, and event provider types in one MOF file named Ntevt.mof.</span></span> <span data-ttu-id="1a669-114">Il est recommandé que toutes les classes et tous les schémas d’inscription des fournisseurs associés soient assemblés dans un seul fichier, plutôt que de créer un fichier par classe.</span><span class="sxs-lookup"><span data-stu-id="1a669-114">It is recommended that all of the classes and registration schema for related providers be assembled in one file, rather than creating one file per class.</span></span>

<span data-ttu-id="1a669-115">En plus d’utiliser des fournisseurs préinstallés, vous pouvez créer votre propre fournisseur pour fournir des informations sur un périphérique matériel ou les opérations du logiciel.</span><span class="sxs-lookup"><span data-stu-id="1a669-115">In addition to using preinstalled providers, you can create your own provider to supply information about a hardware device or the operations of software.</span></span>

<span data-ttu-id="1a669-116">Le tableau suivant répertorie les tâches de base qui créent un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1a669-116">The following table lists the basic tasks that create a provider.</span></span>



| <span data-ttu-id="1a669-117">Tâche</span><span class="sxs-lookup"><span data-stu-id="1a669-117">Task</span></span>                                                                                                                                                            | <span data-ttu-id="1a669-118">Description</span><span class="sxs-lookup"><span data-stu-id="1a669-118">Description</span></span>                                                                                                                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="1a669-119">Conception de classes format MOF (MOF)</span><span class="sxs-lookup"><span data-stu-id="1a669-119">Designing Managed Object Format (MOF) Classes</span></span>](designing-managed-object-format--mof--classes.md)                                                              | <span data-ttu-id="1a669-120">Développez un modèle pour les entités que vous souhaitez gérer via WMI et créez un fichier format MOF (MOF) pour décrire le schéma.</span><span class="sxs-lookup"><span data-stu-id="1a669-120">Develop a model for the entities you want to manage through WMI and create a Managed Object Format (MOF) file to describe the schema.</span></span><br/> |
| [<span data-ttu-id="1a669-121">Fourniture de données à WMI en écrivant un fournisseur</span><span class="sxs-lookup"><span data-stu-id="1a669-121">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)                                                                  | <span data-ttu-id="1a669-122">Créez le fournisseur le plus basique couplé à WMI.</span><span class="sxs-lookup"><span data-stu-id="1a669-122">Create the most basic provider that is coupled to WMI.</span></span><br/>                                                                                |
| [<span data-ttu-id="1a669-123">Incorporation d’un fournisseur dans une application</span><span class="sxs-lookup"><span data-stu-id="1a669-123">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)                                                                    | <span data-ttu-id="1a669-124">Incluez le fournisseur en tant que composant dans une application s’il ne s’exécute pas tout le temps.</span><span class="sxs-lookup"><span data-stu-id="1a669-124">Include the provider as a component within an application if it does not run all of the time.</span></span><br/>                                         |
| [<span data-ttu-id="1a669-125">Inscription d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="1a669-125">Registering a Provider</span></span>](registering-a-provider.md)                                                                                                            | <span data-ttu-id="1a669-126">Inscrivez le fournisseur auprès de COM et WMI.</span><span class="sxs-lookup"><span data-stu-id="1a669-126">Register the provider with COM and WMI.</span></span><br/>                                                                                               |
| [<span data-ttu-id="1a669-127">Initialisation d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="1a669-127">Initializing a Provider</span></span>](initializing-a-provider.md)                                                                                                          | <span data-ttu-id="1a669-128">Implémentez les interfaces [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) et [**IWbemProviderInitSink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) .</span><span class="sxs-lookup"><span data-stu-id="1a669-128">Implement the [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) and [**IWbemProviderInitSink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) interfaces.</span></span><br/>   |
| [<span data-ttu-id="1a669-129">Appels à WMI</span><span class="sxs-lookup"><span data-stu-id="1a669-129">Making Calls to WMI</span></span>](making-calls-to-wmi.md)                                                                                                                  | <span data-ttu-id="1a669-130">Appeler des interfaces WMI à partir d’un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1a669-130">Call WMI interfaces from a provider.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="1a669-131">Emprunt de l’identité d’un client</span><span class="sxs-lookup"><span data-stu-id="1a669-131">Impersonating a Client</span></span>](impersonating-a-client.md)                                                                                                            | <span data-ttu-id="1a669-132">Définir la sécurité pour accéder à une application cliente.</span><span class="sxs-lookup"><span data-stu-id="1a669-132">Set security to access a client application.</span></span><br/>                                                                                          |
| [<span data-ttu-id="1a669-133">Mise à jour d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="1a669-133">Updating a Provider</span></span>](updating-a-provider.md)                                                                                                                  | <span data-ttu-id="1a669-134">Améliorez le fournisseur en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="1a669-134">Improve the provider as needed.</span></span><br/>                                                                                                       |
| [<span data-ttu-id="1a669-135">Déchargement d’un fournisseur</span><span class="sxs-lookup"><span data-stu-id="1a669-135">Unloading a Provider</span></span>](unloading-a-provider.md)                                                                                                                | <span data-ttu-id="1a669-136">Supprimer le fournisseur de la mémoire pendant l’arrêt ou lorsque le fournisseur est inactif.</span><span class="sxs-lookup"><span data-stu-id="1a669-136">Remove the provider from memory during shutdown or when the provider is idle.</span></span><br/>                                                         |
| <span data-ttu-id="1a669-137">[Fournisseurs de débogage](debugging-providers.md) et [classes de dépannage et de configuration du fournisseur](provider-configuration-and-troubleshooting-classes.md)</span><span class="sxs-lookup"><span data-stu-id="1a669-137">[Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md)</span></span> | <span data-ttu-id="1a669-138">Déboguez votre fournisseur à l’aide des fonctionnalités fournies par WMI.</span><span class="sxs-lookup"><span data-stu-id="1a669-138">Debug your provider using facilities supplied by WMI.</span></span><br/>                                                                                 |
| [<span data-ttu-id="1a669-139">Obtention et fourniture de données sur un ordinateur 64 bits</span><span class="sxs-lookup"><span data-stu-id="1a669-139">Getting and Providing Data on a 64-bit Computer</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)                                                          | <span data-ttu-id="1a669-140">Déterminez si vous avez besoin d’un fournisseur de compatibilité des applications 32 bits ou si le fournisseur 64 bits peut fournir des données aux deux clients.</span><span class="sxs-lookup"><span data-stu-id="1a669-140">Evaluate whether you need a 32-bit application compatibility provider or if the 64-bit provider can supply data to both clients.</span></span><br/>      |



 

<span data-ttu-id="1a669-141">Les rubriques suivantes décrivent les étapes nécessaires pour écrire différents types de fournisseurs :</span><span class="sxs-lookup"><span data-stu-id="1a669-141">The following topics discuss the steps needed to write different types of providers:</span></span>

-   [<span data-ttu-id="1a669-142">Écriture d’un fournisseur d’instances</span><span class="sxs-lookup"><span data-stu-id="1a669-142">Writing an Instance Provider</span></span>](writing-an-instance-provider.md)
-   [<span data-ttu-id="1a669-143">Écriture d’un fournisseur de méthode</span><span class="sxs-lookup"><span data-stu-id="1a669-143">Writing a Method Provider</span></span>](writing-a-method-provider.md)
-   [<span data-ttu-id="1a669-144">Écriture d’un fournisseur d’événements</span><span class="sxs-lookup"><span data-stu-id="1a669-144">Writing an Event Provider</span></span>](writing-an-event-provider.md)
-   [<span data-ttu-id="1a669-145">Écriture d’un fournisseur de consommateur d’événements</span><span class="sxs-lookup"><span data-stu-id="1a669-145">Writing an Event Consumer Provider</span></span>](writing-an-event-consumer-provider.md)
-   [<span data-ttu-id="1a669-146">Écriture d’un fournisseur de classe</span><span class="sxs-lookup"><span data-stu-id="1a669-146">Writing a Class Provider</span></span>](writing-a-class-provider.md)
-   [<span data-ttu-id="1a669-147">Écriture d’un fournisseur de propriétés</span><span class="sxs-lookup"><span data-stu-id="1a669-147">Writing a Property Provider</span></span>](writing-a-property-provider.md)
-   [<span data-ttu-id="1a669-148">Création d’un fournisseur d’instances dans un fournisseur de High-Performance</span><span class="sxs-lookup"><span data-stu-id="1a669-148">Making an Instance Provider into a High-Performance Provider</span></span>](making-an-instance-provider-into-a-high-performance-provider.md)

 

