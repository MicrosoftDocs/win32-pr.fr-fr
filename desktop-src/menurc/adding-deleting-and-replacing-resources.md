---
title: Ajout, suppression et remplacement de ressources
description: Cette rubrique explique comment ajouter, supprimer ou remplacer des ressources.
ms.assetid: 15b1086e-e3a2-460a-828b-17db5105309f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 941c12a1531e422efe44cbd0b3deca9f89838698
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "106512458"
---
# <a name="adding-deleting-and-replacing-resources"></a><span data-ttu-id="56abe-103">Ajout, suppression et remplacement de ressources</span><span class="sxs-lookup"><span data-stu-id="56abe-103">Adding, Deleting, and Replacing Resources</span></span>

<span data-ttu-id="56abe-104">Les applications doivent souvent ajouter, supprimer ou remplacer des ressources dans des fichiers exécutables.</span><span class="sxs-lookup"><span data-stu-id="56abe-104">Applications must frequently add, delete, or replace resources in executable files.</span></span> <span data-ttu-id="56abe-105">Vous pouvez utiliser deux méthodes pour accomplir ces tâches.</span><span class="sxs-lookup"><span data-stu-id="56abe-105">Two methods can be used to accomplish these tasks.</span></span> <span data-ttu-id="56abe-106">La première consiste à modifier le fichier de définition de ressource, à recompiler les ressources et à ajouter les ressources recompilées au fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="56abe-106">The first is to edit the resource-definition file, recompile the resources, and add the recompiled resources to the application's executable file.</span></span> <span data-ttu-id="56abe-107">La deuxième méthode consiste à copier les données de ressources directement dans le fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="56abe-107">The second method is to copy the resource data directly into the application's executable file.</span></span>

<span data-ttu-id="56abe-108">Par exemple, pour localiser une application en langue anglaise en vue de son utilisation en Norvège, il peut être nécessaire de remplacer la boîte de dialogue en anglais par une autre à l’aide de norvégien.</span><span class="sxs-lookup"><span data-stu-id="56abe-108">For example, to localize an English-language application for use in Norway, it may be necessary to replace the English dialog box with one using Norwegian.</span></span> <span data-ttu-id="56abe-109">Un développeur crée une boîte de dialogue appropriée à l’aide d’un éditeur de boîtes de dialogue ou en écrivant un modèle dans le fichier de définition de ressource.</span><span class="sxs-lookup"><span data-stu-id="56abe-109">A developer creates an appropriate dialog box by using a dialog box editor or by writing a template in the resource-definition file.</span></span> <span data-ttu-id="56abe-110">Le développeur RECOMPILE ensuite les ressources et ajoute les nouvelles ressources au fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="56abe-110">The developer then recompiles the resources and adds the new resources to the application's executable file.</span></span>

<span data-ttu-id="56abe-111">Toutefois, si une boîte de dialogue appropriée existe sous forme binaire, le développeur peut copier les données directement dans le fichier exécutable localisé à l’aide des fonctions suivantes.</span><span class="sxs-lookup"><span data-stu-id="56abe-111">If an appropriate dialog box exists in binary form, however, the developer can copy the data directly to the executable file being localized by using the following functions.</span></span> <span data-ttu-id="56abe-112">La fonction [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea) crée un descripteur de mise à jour du fichier exécutable dont les ressources doivent être modifiées.</span><span class="sxs-lookup"><span data-stu-id="56abe-112">The [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea) function creates an update handle to the executable file whose resources are to be changed.</span></span> <span data-ttu-id="56abe-113">La fonction [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) utilise ce handle pour ajouter, supprimer ou remplacer une ressource dans le fichier exécutable.</span><span class="sxs-lookup"><span data-stu-id="56abe-113">The [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) function uses this handle to add, delete, or replace a resource in the executable file.</span></span> <span data-ttu-id="56abe-114">La fonction [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) ferme le handle.</span><span class="sxs-lookup"><span data-stu-id="56abe-114">The [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) function closes the handle.</span></span>

<span data-ttu-id="56abe-115">Après la création d’un descripteur de mise à jour d’un fichier exécutable par [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea), une application peut utiliser [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) à plusieurs reprises pour apporter des modifications aux données de ressource.</span><span class="sxs-lookup"><span data-stu-id="56abe-115">After an update handle to an executable file is created by [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea), an application can use [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) repeatedly to make changes to the resource data.</span></span> <span data-ttu-id="56abe-116">Chaque appel à **UpdateResource** contribue à une liste interne d’ajouts, de suppressions et de remplacements, mais n’écrit pas réellement les données dans le fichier exécutable.</span><span class="sxs-lookup"><span data-stu-id="56abe-116">Each call to **UpdateResource** contributes to an internal list of additions, deletions, and replacements but does not actually write the data to the executable file.</span></span> <span data-ttu-id="56abe-117">Juste avant de fermer le descripteur de mise à jour, [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) écrit les modifications accumulées dans le fichier exécutable.</span><span class="sxs-lookup"><span data-stu-id="56abe-117">Immediately before closing the update handle, [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) writes the accumulated changes to the executable file.</span></span>

<span data-ttu-id="56abe-118">Parfois, une application doit copier des ressources à partir d’un autre fichier.</span><span class="sxs-lookup"><span data-stu-id="56abe-118">Sometimes, an application must copy resources from another file.</span></span> <span data-ttu-id="56abe-119">La [mise à jour des ressources](using-resources.md) montre un exemple d’obtention des données de ressources et de leur taille à partir d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="56abe-119">[Updating Resources](using-resources.md) shows an example of obtaining the resource data and its size from a file.</span></span>

 

 




