---
title: Recherche et chargement des ressources
description: Cette rubrique explique comment charger une ressource en mémoire.
ms.assetid: 9e56cfdd-b365-4433-a507-a30220b4a92d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca9590927cad28772a6b4a5b761d74c9ebf101a6
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104462999"
---
# <a name="finding-and-loading-resources"></a><span data-ttu-id="8d5ae-103">Recherche et chargement des ressources</span><span class="sxs-lookup"><span data-stu-id="8d5ae-103">Finding and Loading Resources</span></span>

<span data-ttu-id="8d5ae-104">Avant d’utiliser une ressource, une application doit la charger en mémoire.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-104">Before using a resource, an application must load it into memory.</span></span> <span data-ttu-id="8d5ae-105">Les fonctions [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) et [**FindResourceEx**](/windows/desktop/api/Winbase/nf-winbase-findresourceexa) recherchent une ressource dans un module et retournent un descripteur aux données de ressource binaires.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-105">The [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**FindResourceEx**](/windows/desktop/api/Winbase/nf-winbase-findresourceexa) functions find a resource in a module and return a handle to the binary resource data.</span></span> <span data-ttu-id="8d5ae-106">**FindResource** localise une ressource par type et par nom.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-106">**FindResource** locates a resource by type and name.</span></span> <span data-ttu-id="8d5ae-107">**FindResourceEx** localise la ressource par type, nom et langue.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-107">**FindResourceEx** locates the resource by type, name, and language.</span></span> <span data-ttu-id="8d5ae-108">Les informations sur **FindResource** dans cette rubrique s’appliquent également à **FindResourceEx**.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-108">Information about **FindResource** in this topic also applies to **FindResourceEx**.</span></span>

<span data-ttu-id="8d5ae-109">La fonction [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) utilise le handle de ressource retourné par [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) pour charger la ressource en mémoire.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-109">The [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) function uses the resource handle returned by [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) to load the resource into memory.</span></span> <span data-ttu-id="8d5ae-110">Une fois qu’une application a chargé une ressource à l’aide de **LoadResource**, le système décharge la mémoire associée uniquement lorsque toutes les références à son module sont libérées via [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span><span class="sxs-lookup"><span data-stu-id="8d5ae-110">After an application loads a resource by using **LoadResource**, the system will unload the associated memory only when all references to its module are freed through [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span></span> <span data-ttu-id="8d5ae-111">Les applications qui doivent accéder à plusieurs fois au même ou à de nombreuses ressources au sein d’un module particulier peuvent entraîner des pénalités en matière de performances, car le mappage de mémoire a lieu dans les appels [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) et **FreeLibrary** répétés.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-111">Applications which need to repeatedly access the same or many resources within a particular module may incur performance penalties due to the memory mapping taking place in repeated [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) and **FreeLibrary** calls.</span></span> <span data-ttu-id="8d5ae-112">Les applications doivent stocker un handle de module unique jusqu’à ce que les ressources ne soient plus nécessaires, puis appeler **FreeLibrary**.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-112">Applications should store a single module handle until resources are no longer needed, and then call **FreeLibrary**.</span></span> <span data-ttu-id="8d5ae-113">Une fois qu’un module est déchargé de la mémoire, les handles de ressource deviennent non valides.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-113">After a module is unloaded from memory, resource handles become invalid.</span></span>

<span data-ttu-id="8d5ae-114">Une application peut utiliser [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) et [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) pour rechercher et charger n’importe quel type de ressource, mais ces fonctions ne doivent être utilisées que dans l’une des situations suivantes :</span><span class="sxs-lookup"><span data-stu-id="8d5ae-114">An application can use [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) to find and load any type of resource, but these functions should be used only in one of these situations:</span></span>

-   <span data-ttu-id="8d5ae-115">Lorsque l’application ne peut pas accéder à la ressource à l’aide d’une fonction existante spécifique à une ressource.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-115">When the application cannot access the resource by using an existing resource-specific function.</span></span>
-   <span data-ttu-id="8d5ae-116">Lorsque l’application doit accéder à la ressource en tant que données binaires pour les appels de fonction suivants.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-116">When the application must access the resource as binary data for subsequent function calls.</span></span>

<span data-ttu-id="8d5ae-117">Dans la mesure du possible, une application doit utiliser l’une des fonctions spécifiques aux ressources suivantes pour rechercher et charger des ressources dans un appel :</span><span class="sxs-lookup"><span data-stu-id="8d5ae-117">Whenever possible, an application should instead use one of the following resource-specific functions to find and load resources in one call:</span></span>



| <span data-ttu-id="8d5ae-118">Fonction</span><span class="sxs-lookup"><span data-stu-id="8d5ae-118">Function</span></span>                                     | <span data-ttu-id="8d5ae-119">Action</span><span class="sxs-lookup"><span data-stu-id="8d5ae-119">Action</span></span>                                   | <span data-ttu-id="8d5ae-120">Pour supprimer une ressource</span><span class="sxs-lookup"><span data-stu-id="8d5ae-120">To remove resource</span></span>                                                                                               |
|----------------------------------------------|------------------------------------------|------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8d5ae-121">**FormatMessage**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-121">**FormatMessage**</span></span>](/windows/desktop/api/winbase/nf-winbase-formatmessage)      | <span data-ttu-id="8d5ae-122">Charge et met en forme une entrée de table de messages.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-122">Loads and formats a message-table entry.</span></span> | <span data-ttu-id="8d5ae-123">Aucune action n'est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-123">No action needed.</span></span>                                                                                                |
| [<span data-ttu-id="8d5ae-124">**LoadAccelerators**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-124">**LoadAccelerators**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) | <span data-ttu-id="8d5ae-125">Charge une table d’accélérateurs.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-125">Loads an accelerator table.</span></span>              | [<span data-ttu-id="8d5ae-126">**DestroyAcceleratorTable**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-126">**DestroyAcceleratorTable**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroyacceleratortable)                                                       |
| [<span data-ttu-id="8d5ae-127">**LoadBitmap**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-127">**LoadBitmap**</span></span>](/windows/desktop/api/winuser/nf-winuser-loadbitmapa)             | <span data-ttu-id="8d5ae-128">Charge une ressource bitmap.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-128">Loads a bitmap resource.</span></span>                 | [<span data-ttu-id="8d5ae-129">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-129">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                                                                             |
| [<span data-ttu-id="8d5ae-130">**LoadCursor**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-130">**LoadCursor**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadcursora)             | <span data-ttu-id="8d5ae-131">Charge une ressource de curseur.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-131">Loads a cursor resource.</span></span>                 | [<span data-ttu-id="8d5ae-132">**DestroyCursor**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-132">**DestroyCursor**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroycursor)                                                                           |
| [<span data-ttu-id="8d5ae-133">**LoadIcon**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-133">**LoadIcon**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadicona)                 | <span data-ttu-id="8d5ae-134">Charge une ressource icône.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-134">Loads an icon resource.</span></span>                  | [<span data-ttu-id="8d5ae-135">**DestroyIcon**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-135">**DestroyIcon**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroyicon)                                                                               |
| [<span data-ttu-id="8d5ae-136">**LoadImage**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-136">**LoadImage**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadimagea)               | <span data-ttu-id="8d5ae-137">Charge une icône, un curseur ou une bitmap.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-137">Loads an icon, cursor, or bitmap.</span></span>        | <span data-ttu-id="8d5ae-138">[**DestroyIcon**](/windows/desktop/api/Winuser/nf-winuser-destroyicon), [**DestroyCursor**](/windows/desktop/api/Winuser/nf-winuser-destroycursor), [**SupprimerObjet**](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)</span><span class="sxs-lookup"><span data-stu-id="8d5ae-138">[**DestroyIcon**](/windows/desktop/api/Winuser/nf-winuser-destroyicon), [**DestroyCursor**](/windows/desktop/api/Winuser/nf-winuser-destroycursor), [**DeleteObject**](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)</span></span> |
| [<span data-ttu-id="8d5ae-139">**LoadMenu**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-139">**LoadMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadmenua)                 | <span data-ttu-id="8d5ae-140">Charge une ressource de menu.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-140">Loads a menu resource.</span></span>                   | [<span data-ttu-id="8d5ae-141">**DestroyMenu**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-141">**DestroyMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroymenu)                                                                               |
| [<span data-ttu-id="8d5ae-142">**LoadString**</span><span class="sxs-lookup"><span data-stu-id="8d5ae-142">**LoadString**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadstringa)             | <span data-ttu-id="8d5ae-143">Charge une entrée de table de chaînes.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-143">Loads a string-table entry.</span></span>              | <span data-ttu-id="8d5ae-144">Aucune action n'est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-144">No action needed.</span></span>                                                                                                |



 

<span data-ttu-id="8d5ae-145">Notez les fonctions de publication dans le tableau ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-145">Note the release functions in the table above.</span></span> <span data-ttu-id="8d5ae-146">Avant de se terminer, une application doit libérer la mémoire occupée par les tables, les bitmaps, les curseurs, les icônes et les menus d’accélérateur à l’aide des fonctions appropriées.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-146">Before terminating, an application should release the memory occupied by accelerator tables, bitmaps, cursors, icons, and menus by using the appropriate functions.</span></span>

<span data-ttu-id="8d5ae-147">La mémoire associée aux ressources chargées via [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) et [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) est libérée une fois que le module a été déchargé par un appel à [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span><span class="sxs-lookup"><span data-stu-id="8d5ae-147">Memory associated with resources loaded through [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) will be released once the module has been unloaded by a call to [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span></span> <span data-ttu-id="8d5ae-148">Toutes les ressources qui restent déchargées lors de l’arrêt de l’application sont automatiquement publiées par le système.</span><span class="sxs-lookup"><span data-stu-id="8d5ae-148">Any resources which remain unloaded at application termination will be automatically released by the system.</span></span>

 

 