---
title: Modèle objet du composant OLE
description: Modèle objet du composant OLE
ms.assetid: f3200d81-c2fa-4cc7-bf85-54f6c753a529
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 211c41de8c16eb1cabb1e62f475adbbf603e2c92
ms.sourcegitcommit: 52d79b29f3b9933c8bef43207ff80c668a81cb73
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/20/2020
ms.locfileid: "103941462"
---
# <a name="the-ole-component-object-model"></a><span data-ttu-id="61312-103">Modèle objet du composant OLE</span><span class="sxs-lookup"><span data-stu-id="61312-103">The OLE Component Object Model</span></span>

<span data-ttu-id="61312-104">Les objets utilisés par la bibliothèque AVIFile font tous partie du modèle objet du composant OLE.</span><span class="sxs-lookup"><span data-stu-id="61312-104">The objects used by the AVIFile library are all part of the OLE Component Object Model.</span></span> <span data-ttu-id="61312-105">En premier lieu, cela signifie qu’ils partagent certaines méthodes qui les rendent plus faciles à utiliser, et les valeurs qu’elles renvoient sont communes à la plupart des méthodes d’interface OLE.</span><span class="sxs-lookup"><span data-stu-id="61312-105">Primarily, this means they share certain methods that make them easier to work with, and the values they return are common to most OLE interface methods.</span></span>

<span data-ttu-id="61312-106">Le modèle objet composant OLE des gestionnaires de fichiers et de flux utilise l’interface OLE **IClassFactory** pour créer des instances de leur classe d’objet.</span><span class="sxs-lookup"><span data-stu-id="61312-106">The OLE Component Object Model of the file and stream handlers uses the OLE **IClassFactory** interface to create instances of their object class.</span></span> <span data-ttu-id="61312-107">En tant qu’objets composant, ils implémentent l’interface [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) , qui se compose des méthodes [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)et [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) .</span><span class="sxs-lookup"><span data-stu-id="61312-107">As component objects, they implement the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface, which consists of the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release), and [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) methods.</span></span> <span data-ttu-id="61312-108">L’interface **IUnknown** permet à une application d’obtenir des pointeurs vers d’autres interfaces prises en charge par le même objet.</span><span class="sxs-lookup"><span data-stu-id="61312-108">The **IUnknown** interface lets an application obtain pointers to other interfaces supported by the same object.</span></span>

<span data-ttu-id="61312-109">Vous pouvez déterminer si un objet prend en charge une interface spécifique à l’aide de la méthode **QueryInterface** .</span><span class="sxs-lookup"><span data-stu-id="61312-109">You can determine if an object supports a specific interface by using the **QueryInterface** method.</span></span> <span data-ttu-id="61312-110">Si un objet prend en charge une interface spécifiée, **QueryInterface** retourne un pointeur vers cette interface.</span><span class="sxs-lookup"><span data-stu-id="61312-110">If an object supports a specified interface, **QueryInterface** returns a pointer to that interface.</span></span>

<span data-ttu-id="61312-111">Vous pouvez incrémenter et décrémenter le décompte de références associé à un objet à l’aide des méthodes [**AddRef**](/previous-versions//dd757100(v=vs.85)) et [**Release**](/previous-versions//dd757102(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="61312-111">You can increment and decrement the reference count associated with an object by using the [**AddRef**](/previous-versions//dd757100(v=vs.85)) and [**Release**](/previous-versions//dd757102(v=vs.85)) methods.</span></span> <span data-ttu-id="61312-112">Le nombre de références permet à plusieurs clients d’accéder à un objet.</span><span class="sxs-lookup"><span data-stu-id="61312-112">The reference count lets multiple clients access an object.</span></span> <span data-ttu-id="61312-113">Lorsqu’un objet est utilisé par la première application, son décompte de références a la valeur 1.</span><span class="sxs-lookup"><span data-stu-id="61312-113">When an object is used by the first application, its reference count is set to 1.</span></span> <span data-ttu-id="61312-114">Les applications utilisent ensuite la méthode **AddRef** pour incrémenter le nombre pour permettre à l’objet d’effectuer le suivi du nombre de fois où il fait l’objet d’un accès.</span><span class="sxs-lookup"><span data-stu-id="61312-114">Applications subsequently use the **AddRef** method to increment the count to let the object keep track of the number of times it is accessed.</span></span>

<span data-ttu-id="61312-115">Quand une application est effectuée à l’aide d’un objet, elle appelle la méthode **Release** pour décrémenter le décompte de références.</span><span class="sxs-lookup"><span data-stu-id="61312-115">When an application is done using an object, it calls the **Release** method to decrement the reference count.</span></span> <span data-ttu-id="61312-116">Lorsque le nombre de références est égal à zéro, l’objet n’est plus nécessaire et libère toutes les ressources qu’il **utilise et détruit** l’objet.</span><span class="sxs-lookup"><span data-stu-id="61312-116">When the reference count is zero, the object is no longer needed and **Release** frees any resources it uses and destroys the object.</span></span> <span data-ttu-id="61312-117">Étant donné qu’un objet utilise des ressources internes transparentes pour l’application, l’objet est chargé de les libérer.</span><span class="sxs-lookup"><span data-stu-id="61312-117">Because an object uses internal resources transparent to the application, the object is responsible for freeing them.</span></span> <span data-ttu-id="61312-118">Par exemple, un gestionnaire de fichiers peut avoir besoin de fermer les fichiers disque ouverts et la mémoire tampon libre lorsqu’ils sont libérés.</span><span class="sxs-lookup"><span data-stu-id="61312-118">For example, a file handler might need to close open disk files and free buffer memory when released.</span></span>

<span data-ttu-id="61312-119">La plupart des méthodes d’interface OLE retournent des handles de résultats définis à l’aide du type de données **HRESULT** .</span><span class="sxs-lookup"><span data-stu-id="61312-119">Most OLE interface methods return result handles that are defined by using the **HRESULT** data type.</span></span> <span data-ttu-id="61312-120">Ce type de données est constitué d’un code de gravité, d’informations contextuelles, d’un code d’installation et d’un code d’État.</span><span class="sxs-lookup"><span data-stu-id="61312-120">This data type is made of a severity code, contextual information, a facility code, and a status code.</span></span> <span data-ttu-id="61312-121">Handle de résultat de retour qui indique que la réussite a la valeur zéro.</span><span class="sxs-lookup"><span data-stu-id="61312-121">A return result handle that indicates success has the value zero.</span></span> <span data-ttu-id="61312-122">Une valeur différente de zéro indique un échec et le membre de code d’État du handle de résultat de retour fournit une base pour une interprétation supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="61312-122">A nonzero value indicates failure and the status code member of the return result handle provides a basis for additional interpretation.</span></span> <span data-ttu-id="61312-123">Pour plus d’informations sur les handles de résultats de retour OLE, consultez le *Guide de référence du programmeur OLE*.</span><span class="sxs-lookup"><span data-stu-id="61312-123">For additional information about OLE return result handles, see the *OLE Programmer's Reference*.</span></span>

 

 