---
title: Décompression Image-Data
description: Décompression Image-Data
ms.assetid: 4bff02be-dac8-41f4-a3af-2da6a2693ffe
keywords:
- Video Compression Manager (VCM), décompression des données d’image
- VCM (gestionnaire de compression vidéo), décompression des données d’image
- ICDecompressEx, fonctions
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 25614f157436056f7f24c340f6cc6f4dbc62d9ae
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104314868"
---
# <a name="image-data-decompression"></a><span data-ttu-id="34b8e-106">Décompression Image-Data</span><span class="sxs-lookup"><span data-stu-id="34b8e-106">Image-Data Decompression</span></span>

<span data-ttu-id="34b8e-107">Votre application utilise une série de fonctions [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) pour contrôler le décompresseur.</span><span class="sxs-lookup"><span data-stu-id="34b8e-107">Your application uses a series of [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) functions to control the decompressor.</span></span> <span data-ttu-id="34b8e-108">Les fonctions peuvent vous aider à effectuer les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="34b8e-108">The functions can help you perform the following tasks:</span></span>

-   <span data-ttu-id="34b8e-109">Sélectionnez un décompresseur.</span><span class="sxs-lookup"><span data-stu-id="34b8e-109">Select a decompressor.</span></span>
-   <span data-ttu-id="34b8e-110">Préparez le décompresseur.</span><span class="sxs-lookup"><span data-stu-id="34b8e-110">Prepare the decompressor.</span></span>
-   <span data-ttu-id="34b8e-111">Décompressez les données.</span><span class="sxs-lookup"><span data-stu-id="34b8e-111">Decompress the data.</span></span>
-   <span data-ttu-id="34b8e-112">Fin de la décompression.</span><span class="sxs-lookup"><span data-stu-id="34b8e-112">End decompression.</span></span>

<span data-ttu-id="34b8e-113">Votre application gère la décompression de la même manière qu’elle gère la compression, à la différence près que le format d’entrée est un format compressé et que le format de sortie est affichable.</span><span class="sxs-lookup"><span data-stu-id="34b8e-113">Your application handles decompression similarly to the way it handles compression, except that the input format is a compressed format and the output format is a displayable format.</span></span> <span data-ttu-id="34b8e-114">Le format d’entrée de la décompression est généralement obtenu à partir de l’en-tête de flux.</span><span class="sxs-lookup"><span data-stu-id="34b8e-114">The input format for decompression is usually obtained from the stream header.</span></span> <span data-ttu-id="34b8e-115">Après avoir déterminé le format d’entrée, votre application peut utiliser les fonctions [**ICLocate**](/windows/desktop/api/Vfw/nf-vfw-iclocate) ou [**ICOpen**](/windows/desktop/api/Vfw/nf-vfw-icopen) pour trouver un décompresseur qui peut le gérer.</span><span class="sxs-lookup"><span data-stu-id="34b8e-115">After determining the input format, your application can use the [**ICLocate**](/windows/desktop/api/Vfw/nf-vfw-iclocate) or [**ICOpen**](/windows/desktop/api/Vfw/nf-vfw-icopen) functions to find a decompressor that can handle it.</span></span>

<span data-ttu-id="34b8e-116">Les fonctions et macros [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) sont un sur-ensemble du groupe de fonctions [**ICDecompress**](/windows/desktop/api/Vfw/nf-vfw-icdecompress) et fournissent davantage de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="34b8e-116">The [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) functions and macros are a superset of the [**ICDecompress**](/windows/desktop/api/Vfw/nf-vfw-icdecompress) function group and provide more capabilities.</span></span> <span data-ttu-id="34b8e-117">Les fonctionnalités de **ICDecompressEx**, [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin), [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend)et [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) remplacent celles des fonctions **ICDecompress**, [**ICDecompressBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressbegin), [**ICDecompressEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressend)et [**ICDecompressQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressquery) .</span><span class="sxs-lookup"><span data-stu-id="34b8e-117">The functionality of **ICDecompressEx**, [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin), [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend), and [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) replaces that of the **ICDecompress**, [**ICDecompressBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressbegin), [**ICDecompressEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressend), and [**ICDecompressQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressquery) functions.</span></span> <span data-ttu-id="34b8e-118">Utilisez les fonctions et macros **ICDecompressEx** à la place des équivalents **ICDecompress** .</span><span class="sxs-lookup"><span data-stu-id="34b8e-118">Use the **ICDecompressEx** functions and macros in place of the **ICDecompress** equivalents.</span></span>

## <a name="decompressor-and-decompression-format-selection"></a><span data-ttu-id="34b8e-119">Sélection du format décompresseur et décompression</span><span class="sxs-lookup"><span data-stu-id="34b8e-119">Decompressor and Decompression Format Selection</span></span>

<span data-ttu-id="34b8e-120">Si vous souhaitez décompresser des données et que votre application requiert un format de sortie spécifique, vous pouvez utiliser la fonction [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) pour interroger le décompresseur afin de déterminer s’il prend en charge les formats d’entrée et de sortie.</span><span class="sxs-lookup"><span data-stu-id="34b8e-120">If you want to decompress data and your application requires a specific output format, you can use the [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) function to query the decompressor to determine if it supports the input and output formats.</span></span>

<span data-ttu-id="34b8e-121">Si le format de sortie n’est pas important dans votre application, il vous suffit de trouver un décompresseur pouvant gérer le format d’entrée.</span><span class="sxs-lookup"><span data-stu-id="34b8e-121">If the output format is not important in your application, you need only find a decompressor that can handle the input format.</span></span> <span data-ttu-id="34b8e-122">Pour déterminer si un décompresseur peut gérer le format d’entrée, utilisez [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) et spécifiez **null** pour le paramètre *lpbiDst* .</span><span class="sxs-lookup"><span data-stu-id="34b8e-122">To determine if a decompressor can handle the input format, use [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) and specify **NULL** for the *lpbiDst* parameter.</span></span> <span data-ttu-id="34b8e-123">Votre application peut déterminer la taille de la mémoire tampon nécessaire pour les données qui spécifient le format de décompression en envoyant le message de [**\_ \_ \_ format d’extraction**](icm-decompress-get-format.md) de la décompression ICM (ou en utilisant la macro [**ICDecompressGetFormatSize**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformatsize) ).</span><span class="sxs-lookup"><span data-stu-id="34b8e-123">Your application can determine the buffer size needed for the data specifying the decompression format by sending the [**ICM\_DECOMPRESS\_GET\_FORMAT**](icm-decompress-get-format.md) message (or use the [**ICDecompressGetFormatSize**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformatsize) macro).</span></span> <span data-ttu-id="34b8e-124">Vous pouvez également envoyer **le \_ format d' \_ extraction \_ de décompression ICM** (ou la macro [**ICDecompressGetFormat**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformat) ) pour récupérer les données de format.</span><span class="sxs-lookup"><span data-stu-id="34b8e-124">You can also send **ICM\_DECOMPRESS\_GET\_FORMAT** (or the [**ICDecompressGetFormat**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformat) macro) to retrieve the format data.</span></span> <span data-ttu-id="34b8e-125">Le décompresseur retourne son format suggéré dans une structure [**BITMAPINFO,**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) .</span><span class="sxs-lookup"><span data-stu-id="34b8e-125">The decompressor returns its suggested format in a [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure.</span></span> <span data-ttu-id="34b8e-126">Ce format préserve généralement le plus d’informations lors de la décompression.</span><span class="sxs-lookup"><span data-stu-id="34b8e-126">This format typically preserves the most information during decompression.</span></span> <span data-ttu-id="34b8e-127">Votre application doit s’assurer que le décompresseur est correctement retourné avant de décompresser les informations.</span><span class="sxs-lookup"><span data-stu-id="34b8e-127">Your application should ensure that the decompressor returns successfully before it decompresses the information.</span></span>

<span data-ttu-id="34b8e-128">Étant donné que votre application alloue la mémoire requise pour la décompression, elle doit déterminer la mémoire maximale que le décompresseur peut exiger pour le format de sortie.</span><span class="sxs-lookup"><span data-stu-id="34b8e-128">Because your application allocates the memory required for decompression, it needs to determine the maximum memory the decompressor can require for the output format.</span></span> <span data-ttu-id="34b8e-129">Le message de format d’obtention de la **\_ décompression \_ \_ ICM** obtient le nombre d’octets que le décompresseur utilise pour le format par défaut.</span><span class="sxs-lookup"><span data-stu-id="34b8e-129">The **ICM\_DECOMPRESS\_GET\_FORMAT** message obtains the number of bytes the decompressor uses for the default format.</span></span>

<span data-ttu-id="34b8e-130">Si votre application définit son propre format à l’aide de [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery), elle doit également obtenir une palette pour l’image bitmap. **ICDecompressExQuery** ne fournit pas de définitions de palette.</span><span class="sxs-lookup"><span data-stu-id="34b8e-130">If your application defines its own format by using [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery), it must also obtain a palette for the bitmap; **ICDecompressExQuery** does not provide palette definitions.</span></span> <span data-ttu-id="34b8e-131">(La plupart des applications utilisent des formats standard et n’ont pas besoin d’obtenir une palette.) Votre application peut obtenir la palette en envoyant le message de [**\_ \_ \_ palette de décompression ICM**](icm-decompress-get-palette.md) (ou en utilisant la macro [**ICDecompressGetPalette**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetpalette) ).</span><span class="sxs-lookup"><span data-stu-id="34b8e-131">(Most applications use standard formats and do not need to obtain a palette.) Your application can obtain the palette by sending the [**ICM\_DECOMPRESS\_GET\_PALETTE**](icm-decompress-get-palette.md) message (or use the [**ICDecompressGetPalette**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetpalette) macro).</span></span>

## <a name="decompressor-initialization"></a><span data-ttu-id="34b8e-132">Initialisation du décompresseur</span><span class="sxs-lookup"><span data-stu-id="34b8e-132">Decompressor Initialization</span></span>

<span data-ttu-id="34b8e-133">Une fois que votre application a sélectionné un décompresseur qui peut gérer les formats d’entrée et de sortie dont elle a besoin, vous pouvez initialiser le décompresseur à l’aide de la fonction [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin) .</span><span class="sxs-lookup"><span data-stu-id="34b8e-133">After your application selects a decompressor that can handle the input and output formats it needs, you can initialize the decompressor by using the [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin) function.</span></span> <span data-ttu-id="34b8e-134">Cette fonction requiert le handle de décompresseur et les formats d’entrée et de sortie.</span><span class="sxs-lookup"><span data-stu-id="34b8e-134">This function requires the decompressor handle and the input and output formats.</span></span>

## <a name="data-decompression"></a><span data-ttu-id="34b8e-135">Décompression des données</span><span class="sxs-lookup"><span data-stu-id="34b8e-135">Data Decompression</span></span>

<span data-ttu-id="34b8e-136">Vous pouvez utiliser la fonction [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) pour décompresser un frame.</span><span class="sxs-lookup"><span data-stu-id="34b8e-136">You can use the [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) function to decompress a frame.</span></span> <span data-ttu-id="34b8e-137">Votre application doit utiliser cette fonction à plusieurs reprises jusqu’à ce que tous les frames d’une séquence soient décompressés.</span><span class="sxs-lookup"><span data-stu-id="34b8e-137">Your application must use this function repeatedly until all the frames in a sequence are decompressed.</span></span>

<span data-ttu-id="34b8e-138">Si votre flux vidéo est en retard par rapport à d’autres composants (tels que l’audio) pendant la lecture, votre application peut spécifier l’indicateur **ICDECOMPRESS \_ HURRYUP** pour accélérer la décompression.</span><span class="sxs-lookup"><span data-stu-id="34b8e-138">If your video stream lags behind other components (such as audio) during playback, your application can specify the **ICDECOMPRESS\_HURRYUP** flag to speed decompression.</span></span> <span data-ttu-id="34b8e-139">Pour ce faire, un décompresseur peut extraire uniquement les informations dont il a besoin pour décompresser le frame suivant et ne pas décompresser complètement le frame actuel.</span><span class="sxs-lookup"><span data-stu-id="34b8e-139">To do this, a decompressor might extract only the information it needs to decompress the next frame and not fully decompress the current frame.</span></span> <span data-ttu-id="34b8e-140">Par conséquent, votre application ne doit pas essayer de dessiner les données décompressées lorsqu’elle utilise cet indicateur.</span><span class="sxs-lookup"><span data-stu-id="34b8e-140">Therefore, your application should not try to draw the decompressed data when it uses this flag.</span></span>

<span data-ttu-id="34b8e-141">Une fois que votre application a décompressé les données, elle peut envoyer le message de [**\_ \_ fin DECOMPRESSEX ICM**](icm-decompressex-end.md) (ou utiliser la macro [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend) ) pour notifier le décompresseur qu’il est terminé.</span><span class="sxs-lookup"><span data-stu-id="34b8e-141">After your application has decompressed the data, it can send the [**ICM\_DECOMPRESSEX\_END**](icm-decompressex-end.md) message (or use the [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend) macro) to notify the decompressor that it has finished.</span></span> <span data-ttu-id="34b8e-142">Si vous souhaitez redémarrer la décompression après avoir utilisé cette fonction, votre application doit réinitialiser le décompresseur à l’aide de [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin).</span><span class="sxs-lookup"><span data-stu-id="34b8e-142">If you want to restart decompression after using this function, your application must reinitialize the decompressor by using [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin).</span></span>

## <a name="related-topics"></a><span data-ttu-id="34b8e-143">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="34b8e-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="34b8e-144">Services VCM</span><span class="sxs-lookup"><span data-stu-id="34b8e-144">VCM Services</span></span>](vcm-services.md)
</dt> </dl>

 

 