---
title: Palettes
description: Palettes
ms.assetid: ee048f9a-3036-40dc-a6d7-f612b9ef767c
keywords:
- DrawDib, palettes
- DrawDibRealize fonction)
- DrawDibDraw fonction)
- DrawDibSetPalette fonction)
- DrawDibGetPalette fonction)
- DrawDibChangePalette fonction)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5935831d8996c424a386f86082282f9cf7c1c12
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103940947"
---
# <a name="palettes"></a><span data-ttu-id="16eaa-109">Palettes</span><span class="sxs-lookup"><span data-stu-id="16eaa-109">Palettes</span></span>

<span data-ttu-id="16eaa-110">Les fonctions DrawDib requièrent qu’une application réponde à deux messages orientés palette : [**WM \_ QUERYNEWPALETTE**](/windows/desktop/gdi/wm-querynewpalette) et [**WM \_ PALETTECHANGED**](/windows/desktop/gdi/wm-palettechanged).</span><span class="sxs-lookup"><span data-stu-id="16eaa-110">The DrawDib functions require that an application respond to two palette-oriented messages: [**WM\_QUERYNEWPALETTE**](/windows/desktop/gdi/wm-querynewpalette) and [**WM\_PALETTECHANGED**](/windows/desktop/gdi/wm-palettechanged).</span></span> <span data-ttu-id="16eaa-111">Si votre application ne prend pas en charge la palette, vous devez ajouter un gestionnaire pour chacun de ces messages.</span><span class="sxs-lookup"><span data-stu-id="16eaa-111">If your application is not palette-aware, you will need to add a handler for each of these messages.</span></span> <span data-ttu-id="16eaa-112">Pour plus d’informations sur le traitement des messages **WM \_ QUERYNEWPALETTE** et **WM \_ PALETTECHANGED** , consultez [Ajout de gestionnaires de messages de palette](adding-palette-message-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="16eaa-112">For more information about processing the **WM\_QUERYNEWPALETTE** and **WM\_PALETTECHANGED** messages, see [Adding Palette Message Handlers](adding-palette-message-handlers.md).</span></span>

<span data-ttu-id="16eaa-113">Vous pouvez réaliser la palette DrawDib actuelle sur le contrôleur de l’objet à l’aide de la fonction [**DrawDibRealize**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) .</span><span class="sxs-lookup"><span data-stu-id="16eaa-113">You can realize the current DrawDib palette to the DC by using the [**DrawDibRealize**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) function.</span></span> <span data-ttu-id="16eaa-114">Vous devez vous rendre compte de la palette en réponse au message [**WM \_ QUERYNEWPALETTE**](/windows/desktop/gdi/wm-querynewpalette) ou [**WM \_ PALETTECHANGED**](/windows/desktop/gdi/wm-palettechanged) , ou lorsque vous vous préparez à afficher une séquence d’images à l’aide de la fonction [**DrawDibDraw**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) .</span><span class="sxs-lookup"><span data-stu-id="16eaa-114">You should realize the palette in response to the [**WM\_QUERYNEWPALETTE**](/windows/desktop/gdi/wm-querynewpalette) or [**WM\_PALETTECHANGED**](/windows/desktop/gdi/wm-palettechanged) message, or when you prepare to display an image sequence by using the [**DrawDibDraw**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) function.</span></span>

<span data-ttu-id="16eaa-115">Vous pouvez dessiner une image mappée à une autre palette à l’aide de la fonction [**DrawDibSetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) .</span><span class="sxs-lookup"><span data-stu-id="16eaa-115">You can draw an image mapped to another palette by using the [**DrawDibSetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) function.</span></span> <span data-ttu-id="16eaa-116">Cette fonction force le contrôleur de DrawDib à utiliser la palette spécifiée, ce qui peut affecter la qualité de l’image.</span><span class="sxs-lookup"><span data-stu-id="16eaa-116">This function forces the DrawDib DC to use the specified palette, which can affect the image quality.</span></span> <span data-ttu-id="16eaa-117">Par exemple, une application qui prend en charge la palette peut avoir réalisé une palette et doit empêcher DrawDib de réaliser sa propre palette.</span><span class="sxs-lookup"><span data-stu-id="16eaa-117">For example, an application that is palette-aware might have realized a palette and needs to prevent DrawDib from realizing its own palette.</span></span> <span data-ttu-id="16eaa-118">L’application peut utiliser **DrawDibSetPalette** pour notifier les DrawDib de la palette à utiliser.</span><span class="sxs-lookup"><span data-stu-id="16eaa-118">The application can use **DrawDibSetPalette** to notify DrawDib of the palette to use.</span></span>

<span data-ttu-id="16eaa-119">Vous pouvez obtenir un descripteur de la palette de premier plan actuelle à l’aide de la fonction [**DrawDibGetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibgetpalette) .</span><span class="sxs-lookup"><span data-stu-id="16eaa-119">You can obtain a handle of the current foreground palette by using the [**DrawDibGetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibgetpalette) function.</span></span> <span data-ttu-id="16eaa-120">Si votre application utilise la palette de premier plan actuelle, elle n’utilise pas l’exclusivité de la palette et une autre application peut invalider le handle de palette.</span><span class="sxs-lookup"><span data-stu-id="16eaa-120">If your application uses the current foreground palette, it does not have exclusive use of the palette and another application can invalidate the palette handle.</span></span> <span data-ttu-id="16eaa-121">Votre application ne doit pas libérer la palette lorsque vous avez fini de l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="16eaa-121">Your application should not free the palette when you finish using it.</span></span> <span data-ttu-id="16eaa-122">La libération de la palette pourrait invalider le handle de palette pour une autre application.</span><span class="sxs-lookup"><span data-stu-id="16eaa-122">Freeing the palette could invalidate the palette handle for another application.</span></span>

<span data-ttu-id="16eaa-123">Vous pouvez préparer DrawDib à recevoir de nouvelles valeurs de couleur pour sa palette à l’aide de la fonction [**DrawDibChangePalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibchangepalette) .</span><span class="sxs-lookup"><span data-stu-id="16eaa-123">You can prepare DrawDib to receive new color values for its palette by using the [**DrawDibChangePalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibchangepalette) function.</span></span> <span data-ttu-id="16eaa-124">Dans le code suivant **DrawDibChangePalette**, vous affectez de nouvelles valeurs pour la table des couleurs de la palette.</span><span class="sxs-lookup"><span data-stu-id="16eaa-124">In the code following **DrawDibChangePalette**, you assign new values for the palette color table.</span></span> <span data-ttu-id="16eaa-125">Si l’indicateur d' **\_ animation DDF** n’est pas défini dans le DC DrawDib quand vous appelez **DrawDibChangePalette**, vous pouvez appliquer les modifications de la palette à l’aide de [**DrawDibRealize**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) pour réaliser la palette.</span><span class="sxs-lookup"><span data-stu-id="16eaa-125">If the **DDF\_ANIMATE** flag is not set in the DrawDib DC when you call **DrawDibChangePalette**, you can enact the palette changes by using [**DrawDibRealize**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) to realize the palette.</span></span> <span data-ttu-id="16eaa-126">Vous pouvez ensuite utiliser [**DrawDibDraw**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) pour redessiner l’image.</span><span class="sxs-lookup"><span data-stu-id="16eaa-126">You can then use [**DrawDibDraw**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) to redraw the image.</span></span> <span data-ttu-id="16eaa-127">Si l’indicateur d' **\_ animation DDF** est défini dans le DC DrawDib, vous pouvez animer la palette et les couleurs de la bitmap affichée à l’aide de **DrawDibDraw** ou **DrawDibRealize**.</span><span class="sxs-lookup"><span data-stu-id="16eaa-127">If the **DDF\_ANIMATE** flag is set in the DrawDib DC, you can animate the palette and the colors of the displayed bitmap by using **DrawDibDraw** or **DrawDibRealize**.</span></span> <span data-ttu-id="16eaa-128">Vous pouvez mettre à jour l’indicateur d' **\_ animation DDF** à l’aide des fonctions [**DrawDibEnd**](/windows/desktop/api/Vfw/nf-vfw-drawdibend) et [**DrawDibBegin**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) .</span><span class="sxs-lookup"><span data-stu-id="16eaa-128">You can update the **DDF\_ANIMATE** flag by using the [**DrawDibEnd**](/windows/desktop/api/Vfw/nf-vfw-drawdibend) and [**DrawDibBegin**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) functions.</span></span>

> [!Note]  
> <span data-ttu-id="16eaa-129">Si vous libérez la palette DrawDib alors qu’elle est sélectionnée par un contrôleur de service, une erreur GDI (Graphics Device Interface) peut se produire lorsque le DC utilise la palette.</span><span class="sxs-lookup"><span data-stu-id="16eaa-129">If you free the DrawDib palette while it is selected by a DC, a graphics device interface (GDI) error can result when the DC uses the palette.</span></span> <span data-ttu-id="16eaa-130">Au lieu de cela, votre application doit utiliser [**DrawDibSetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) pour modifier le contrôleur de périphérique DrawDib afin d’utiliser la palette par défaut ou une autre palette.</span><span class="sxs-lookup"><span data-stu-id="16eaa-130">Instead, your application should use [**DrawDibSetPalette**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) to change the DrawDib DC to use the default palette or another palette.</span></span>

 

<span data-ttu-id="16eaa-131">Les fonctions [**DrawDibEnd**](/windows/desktop/api/Vfw/nf-vfw-drawdibend), [**DrawDibClose**](/windows/desktop/api/Vfw/nf-vfw-drawdibclose)et [**DrawDibBegin**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) peuvent libérer la palette DrawDib.</span><span class="sxs-lookup"><span data-stu-id="16eaa-131">The [**DrawDibEnd**](/windows/desktop/api/Vfw/nf-vfw-drawdibend), [**DrawDibClose**](/windows/desktop/api/Vfw/nf-vfw-drawdibclose), and [**DrawDibBegin**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) functions can free the DrawDib palette.</span></span> <span data-ttu-id="16eaa-132">Toutefois, ces fonctions ne doivent être utilisées que lorsque la palette n’a pas été sélectionnée par le contrôleur de périphérique.</span><span class="sxs-lookup"><span data-stu-id="16eaa-132">However, these functions should be used only when the palette has not been selected by the DC.</span></span> <span data-ttu-id="16eaa-133">La fonction DrawDibDraw peut également libérer la palette lorsqu’elle utilise le même DC DrawDib, mais spécifie différents paramètres de dessin (*lpbi*, *dxDst*, *dyDst*, *dxSrc* ou *dySrc*) ou un format différent.</span><span class="sxs-lookup"><span data-stu-id="16eaa-133">The DrawDibDraw function can also free the palette when it uses the same DrawDib DC, but specifies different drawing parameters (*lpbi*, *dxDst*, *dyDst*, *dxSrc*, or *dySrc*) or a different format.</span></span>

## <a name="related-topics"></a><span data-ttu-id="16eaa-134">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="16eaa-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="16eaa-135">Rendu d’image</span><span class="sxs-lookup"><span data-stu-id="16eaa-135">Image Rendering</span></span>](image-rendering.md)
</dt> </dl>

 

 