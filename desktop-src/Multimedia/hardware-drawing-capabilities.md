---
title: Fonctionnalités de dessin matériel
description: Fonctionnalités de dessin matériel
ms.assetid: 3a26de73-cb9e-41a0-8c33-a7cca7d6058e
keywords:
- Gestionnaire de compression vidéo (VCM), dessin
- VCM (gestionnaire de compression vidéo), dessin
- ICGetInfo fonction)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ba7d3af8beb7c4ac676e421fe10d427322470d14
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104029311"
---
# <a name="hardware-drawing-capabilities"></a><span data-ttu-id="46d61-106">Fonctionnalités de dessin matériel</span><span class="sxs-lookup"><span data-stu-id="46d61-106">Hardware Drawing Capabilities</span></span>

<span data-ttu-id="46d61-107">Certains convertisseurs peuvent dessiner directement sur du matériel vidéo au fur et à mesure qu’ils décompressent des images vidéo.</span><span class="sxs-lookup"><span data-stu-id="46d61-107">Some renderers can draw directly to video hardware as they decompress video frames.</span></span> <span data-ttu-id="46d61-108">Ces convertisseurs retournent l' \_ indicateur de dessin VIDCF en réponse à la fonction [**ICGetInfo**](/windows/desktop/api/Vfw/nf-vfw-icgetinfo) .</span><span class="sxs-lookup"><span data-stu-id="46d61-108">These renderers return the VIDCF\_DRAW flag in response to the [**ICGetInfo**](/windows/desktop/api/Vfw/nf-vfw-icgetinfo) function.</span></span> <span data-ttu-id="46d61-109">Lorsque vous utilisez ce type de convertisseur, votre application n’a pas à gérer les données décompressées.</span><span class="sxs-lookup"><span data-stu-id="46d61-109">When using this type of renderer, your application does not have to handle the decompressed data.</span></span> <span data-ttu-id="46d61-110">Elle permet au convertisseur de conserver les données décompressées pour le dessin.</span><span class="sxs-lookup"><span data-stu-id="46d61-110">It lets the renderer retain the decompressed data for drawing.</span></span>

<span data-ttu-id="46d61-111">Si votre application utilise un convertisseur avec des fonctionnalités de dessin, elle doit gérer les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="46d61-111">If your application uses a renderer with drawing capabilities, it must handle the following tasks:</span></span>

-   <span data-ttu-id="46d61-112">Sélectionnez un convertisseur.</span><span class="sxs-lookup"><span data-stu-id="46d61-112">Select a renderer.</span></span>
-   <span data-ttu-id="46d61-113">Spécifiez des formats d’image.</span><span class="sxs-lookup"><span data-stu-id="46d61-113">Specify image formats.</span></span>
-   <span data-ttu-id="46d61-114">Initialisez le convertisseur.</span><span class="sxs-lookup"><span data-stu-id="46d61-114">Initialize the renderer.</span></span>
-   <span data-ttu-id="46d61-115">Dessinez les données.</span><span class="sxs-lookup"><span data-stu-id="46d61-115">Draw the data.</span></span>
-   <span data-ttu-id="46d61-116">Paramètres de dessin de contrôle.</span><span class="sxs-lookup"><span data-stu-id="46d61-116">Control drawing parameters.</span></span>

## <a name="renderer-selection"></a><span data-ttu-id="46d61-117">Sélection du convertisseur</span><span class="sxs-lookup"><span data-stu-id="46d61-117">Renderer Selection</span></span>

<span data-ttu-id="46d61-118">La macro [**ICDrawOpen**](/windows/desktop/api/Vfw/nf-vfw-icdrawopen) ouvre un convertisseur qui peut dessiner des images avec le format spécifié.</span><span class="sxs-lookup"><span data-stu-id="46d61-118">The [**ICDrawOpen**](/windows/desktop/api/Vfw/nf-vfw-icdrawopen) macro opens a renderer that can draw images with the specified format.</span></span> <span data-ttu-id="46d61-119">Elle retourne un handle d’un convertisseur si elle réussit, ou zéro dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="46d61-119">It returns a handle of a renderer if it is successful, or zero otherwise.</span></span> <span data-ttu-id="46d61-120">Cette macro utilise la fonction [**ICLocate**](/windows/desktop/api/Vfw/nf-vfw-iclocate) pour ouvrir le convertisseur.</span><span class="sxs-lookup"><span data-stu-id="46d61-120">This macro uses the [**ICLocate**](/windows/desktop/api/Vfw/nf-vfw-iclocate) function to open the renderer.</span></span>

## <a name="specifying-image-formats"></a><span data-ttu-id="46d61-121">Spécification des formats d’image</span><span class="sxs-lookup"><span data-stu-id="46d61-121">Specifying Image Formats</span></span>

<span data-ttu-id="46d61-122">Étant donné que votre application n’a pas besoin de dessiner les données décompressées, elle n’a pas besoin d’un format de sortie spécifique.</span><span class="sxs-lookup"><span data-stu-id="46d61-122">Because your application does not need to draw the decompressed data, it does not require a specific output format.</span></span> <span data-ttu-id="46d61-123">Toutefois, il doit s’assurer que le convertisseur peut dessiner à l’aide du format d’entrée à l’aide du message de [**\_ \_ requête ICM de dessin**](icm-draw-query.md) (ou de la macro [**ICDrawQuery**](/windows/desktop/api/Vfw/nf-vfw-icdrawquery) ).</span><span class="sxs-lookup"><span data-stu-id="46d61-123">It must, however, ensure that the renderer can draw using the input format by using the [**ICM\_DRAW\_QUERY**](icm-draw-query.md) message (or use the [**ICDrawQuery**](/windows/desktop/api/Vfw/nf-vfw-icdrawquery) macro).</span></span> <span data-ttu-id="46d61-124">Ce message ne peut pas déterminer si un convertisseur peut dessiner une image bitmap.</span><span class="sxs-lookup"><span data-stu-id="46d61-124">This message cannot determine if a renderer can draw a bitmap.</span></span> <span data-ttu-id="46d61-125">Si votre application doit déterminer si le convertisseur peut dessiner la bitmap, utilisez ce message avec la fonction [**ICDrawBegin**](/windows/desktop/api/Vfw/nf-vfw-icdrawbegin) .</span><span class="sxs-lookup"><span data-stu-id="46d61-125">If your application must determine if the renderer can draw the bitmap, use this message with the [**ICDrawBegin**](/windows/desktop/api/Vfw/nf-vfw-icdrawbegin) function.</span></span>

<span data-ttu-id="46d61-126">Votre application peut avoir un convertisseur suggérant un format d’entrée à l’aide de la fonction [**ICDrawSuggestFormat**](/windows/desktop/api/Vfw/nf-vfw-icdrawsuggestformat) .</span><span class="sxs-lookup"><span data-stu-id="46d61-126">Your application can have a renderer suggest an input format by using the [**ICDrawSuggestFormat**](/windows/desktop/api/Vfw/nf-vfw-icdrawsuggestformat) function.</span></span> <span data-ttu-id="46d61-127">Cette fonction est utilisée lorsqu’un convertisseur sépare les fonctionnalités de dessin des fonctionnalités de décompression.</span><span class="sxs-lookup"><span data-stu-id="46d61-127">This function is used when a renderer separates the drawing capabilities from the decompressing capabilities.</span></span> <span data-ttu-id="46d61-128">La plupart des applications qui utilisent les fonctions de dessin n’ont pas besoin de déterminer le format de sortie.</span><span class="sxs-lookup"><span data-stu-id="46d61-128">Most applications using the drawing functions will not need to determine the output format.</span></span>

## <a name="renderer-initialization"></a><span data-ttu-id="46d61-129">Initialisation du convertisseur</span><span class="sxs-lookup"><span data-stu-id="46d61-129">Renderer Initialization</span></span>

<span data-ttu-id="46d61-130">La fonction [**ICDrawBegin**](/windows/desktop/api/Vfw/nf-vfw-icdrawbegin) Initialise un convertisseur et lui indique la destination du dessin.</span><span class="sxs-lookup"><span data-stu-id="46d61-130">The [**ICDrawBegin**](/windows/desktop/api/Vfw/nf-vfw-icdrawbegin) function initializes a renderer and tells it the drawing destination.</span></span> <span data-ttu-id="46d61-131">Cette fonction peut également effectuer les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="46d61-131">This function can also perform the following tasks:</span></span>

-   <span data-ttu-id="46d61-132">Déterminez si le convertisseur prend en charge un format d’entrée spécifique.</span><span class="sxs-lookup"><span data-stu-id="46d61-132">Determine whether the renderer supports a specific input format.</span></span>
-   <span data-ttu-id="46d61-133">Spécifie si l’opération de dessin occupe une fenêtre ou la totalité de l’écran.</span><span class="sxs-lookup"><span data-stu-id="46d61-133">Specify whether the drawing operation occupies a window or the entire screen.</span></span>
-   <span data-ttu-id="46d61-134">Spécifiez la partie de l’image à afficher à l’aide du rectangle source.</span><span class="sxs-lookup"><span data-stu-id="46d61-134">Specify the part of the image to display using the source rectangle.</span></span>
-   <span data-ttu-id="46d61-135">Définissez la vitesse de lecture de la séquence d’images.</span><span class="sxs-lookup"><span data-stu-id="46d61-135">Define the playback rate of the image sequence.</span></span>

<span data-ttu-id="46d61-136">Certains convertisseurs encadrent les données compressées pour fonctionner plus efficacement.</span><span class="sxs-lookup"><span data-stu-id="46d61-136">Some renderers buffer the compressed data to operate more efficiently.</span></span> <span data-ttu-id="46d61-137">Votre application peut envoyer le [**message \_ GETBUFFERSWANTED ICM**](icm-getbufferswanted.md) (ou utiliser la macro [**ICGetBuffersWanted**](/windows/desktop/api/Vfw/nf-vfw-icgetbufferswanted) ) pour déterminer le nombre de mémoires tampons demandées par le convertisseur.</span><span class="sxs-lookup"><span data-stu-id="46d61-137">Your application can send the [**ICM\_GETBUFFERSWANTED**](icm-getbufferswanted.md) message (or use the [**ICGetBuffersWanted**](/windows/desktop/api/Vfw/nf-vfw-icgetbufferswanted) macro) to determine the number of buffers the renderer requests.</span></span> <span data-ttu-id="46d61-138">Votre application doit précharger ces mémoires tampons et les envoyer au convertisseur avant le dessin.</span><span class="sxs-lookup"><span data-stu-id="46d61-138">Your application should preload these buffers and send them to the renderer before drawing.</span></span>

## <a name="drawing-the-data"></a><span data-ttu-id="46d61-139">Dessin des données</span><span class="sxs-lookup"><span data-stu-id="46d61-139">Drawing the Data</span></span>

<span data-ttu-id="46d61-140">Vous pouvez utiliser la fonction [**ICDraw**](/windows/desktop/api/Vfw/nf-vfw-icdraw) pour décompresser les données pour le dessin.</span><span class="sxs-lookup"><span data-stu-id="46d61-140">You can use the [**ICDraw**](/windows/desktop/api/Vfw/nf-vfw-icdraw) function to decompress the data for drawing.</span></span> <span data-ttu-id="46d61-141">Toutefois, le convertisseur ne commence pas à dessiner des données tant que votre application n’a pas envoyé le message de [**\_ \_ début de dessin ICM**](icm-draw-start.md) (ou utilise la macro [**ICDrawStart**](/windows/desktop/api/Vfw/nf-vfw-icdrawstart) ).</span><span class="sxs-lookup"><span data-stu-id="46d61-141">The renderer, however, does not start drawing data until your application sends the [**ICM\_DRAW\_START**](icm-draw-start.md) message (or uses the [**ICDrawStart**](/windows/desktop/api/Vfw/nf-vfw-icdrawstart) macro).</span></span> <span data-ttu-id="46d61-142">Lorsque votre application appelle cette fonction, le convertisseur commence à dessiner les frames à la vitesse spécifiée par le paramètre *dwRate* divisée par le paramètre *dwScale* ; ces paramètres ont été fournis lorsque l’application a initialisé le convertisseur à l’aide de la fonction [**ICDrawBegin**](/windows/desktop/api/Vfw/nf-vfw-icdrawbegin) .</span><span class="sxs-lookup"><span data-stu-id="46d61-142">When your application calls this function, the renderer begins to draw the frames at the rate specified by the *dwRate* parameter divided by the *dwScale* parameter; these parameters were supplied when the application initialized the renderer by using the [**ICDrawBegin**](/windows/desktop/api/Vfw/nf-vfw-icdrawbegin) function.</span></span> <span data-ttu-id="46d61-143">Le dessin continue jusqu’à ce que votre application envoie le message d' [**\_ \_ arrêt du dessin ICM**](icm-draw-stop.md) (ou utilise la macro [**ICDrawStop**](/windows/desktop/api/Vfw/nf-vfw-icdrawstop) ).</span><span class="sxs-lookup"><span data-stu-id="46d61-143">Drawing continues until your application sends the [**ICM\_DRAW\_STOP**](icm-draw-stop.md) message (or uses the [**ICDrawStop**](/windows/desktop/api/Vfw/nf-vfw-icdrawstop) macro).</span></span>

> [!Note]  
> <span data-ttu-id="46d61-144">Si un convertisseur met en mémoire tampon les données avant le dessin, votre application ne doit pas utiliser la macro **ICDrawStart** tant qu’elle n’a pas envoyé le nombre de frames renvoyés par le convertisseur pour la macro **ICGetBuffersWanted** .</span><span class="sxs-lookup"><span data-stu-id="46d61-144">If a renderer buffers the data before drawing, your application should not use the **ICDrawStart** macro until it has sent the number of frames the renderer returned for the **ICGetBuffersWanted** macro.</span></span>

 

<span data-ttu-id="46d61-145">Le paramètre *lTime* de [**ICDraw**](/windows/desktop/api/Vfw/nf-vfw-icdraw) spécifie l’heure de dessin d’une image.</span><span class="sxs-lookup"><span data-stu-id="46d61-145">The *lTime* parameter of [**ICDraw**](/windows/desktop/api/Vfw/nf-vfw-icdraw) specifies the time to draw a frame.</span></span> <span data-ttu-id="46d61-146">Le convertisseur divise cet entier par l’échelle de temps spécifiée avec [**ICDrawBegin**](/windows/desktop/api/Vfw/nf-vfw-icdrawbegin) pour obtenir l’heure réelle.</span><span class="sxs-lookup"><span data-stu-id="46d61-146">The renderer divides this integer by the time scale specified with [**ICDrawBegin**](/windows/desktop/api/Vfw/nf-vfw-icdrawbegin) to obtain the actual time.</span></span> <span data-ttu-id="46d61-147">Les heures pour les fonctions **ICDraw** sont relatives à **ICDrawStart**.</span><span class="sxs-lookup"><span data-stu-id="46d61-147">Times for **ICDraw** functions are relative to **ICDrawStart**.</span></span> <span data-ttu-id="46d61-148">**ICDrawStart** définit l’horloge sur zéro.</span><span class="sxs-lookup"><span data-stu-id="46d61-148">**ICDrawStart** sets the clock to zero.</span></span> <span data-ttu-id="46d61-149">Par exemple, si votre application spécifie 1000 pour l’échelle de temps et 75 pour *lTime*, le convertisseur dessine le frame 75 millisecondes dans la séquence.</span><span class="sxs-lookup"><span data-stu-id="46d61-149">For example, if your application specifies 1000 for the time scale and 75 for *lTime*, the renderer draws the frame 75 milliseconds into the sequence.</span></span>

## <a name="controlling-drawing-parameters"></a><span data-ttu-id="46d61-150">Contrôle des paramètres de dessin</span><span class="sxs-lookup"><span data-stu-id="46d61-150">Controlling Drawing Parameters</span></span>

<span data-ttu-id="46d61-151">Vous pouvez surveiller l’horloge d’un convertisseur en envoyant le message de l’affichage [**ICM de \_ dessin \_**](icm-draw-gettime.md) (ou en utilisant la macro [**ICDrawGetTime**](/windows/desktop/api/Vfw/nf-vfw-icdrawgettime) ) et vous pouvez définir l’horloge d’un convertisseur qui peut dessiner des données en envoyant le message [**ICM \_ Draw \_ setTime**](icm-draw-settime.md) (ou en utilisant la macro [**ICDrawSetTime**](/windows/desktop/api/Vfw/nf-vfw-icdrawsettime) ).</span><span class="sxs-lookup"><span data-stu-id="46d61-151">You can monitor the clock of a renderer by sending the [**ICM\_DRAW\_GETTIME**](icm-draw-gettime.md) message (or use the [**ICDrawGetTime**](/windows/desktop/api/Vfw/nf-vfw-icdrawgettime) macro), and you can set the clock of a renderer that can draw data by sending the [**ICM\_DRAW\_SETTIME**](icm-draw-settime.md) message (or use the [**ICDrawSetTime**](/windows/desktop/api/Vfw/nf-vfw-icdrawsettime) macro).</span></span>

<span data-ttu-id="46d61-152">Pour modifier la position actuelle lors du dessin d’un convertisseur, votre application peut envoyer le message de [**\_ \_ fenêtre de dessin ICM**](icm-draw-window.md) (ou utiliser la macro [**ICDrawWindow**](/windows/desktop/api/Vfw/nf-vfw-icdrawwindow) ) pour repositionner la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="46d61-152">To change the current position while a renderer is drawing, your application can send the [**ICM\_DRAW\_WINDOW**](icm-draw-window.md) message (or use the [**ICDrawWindow**](/windows/desktop/api/Vfw/nf-vfw-icdrawwindow) macro) for repositioning the window.</span></span> <span data-ttu-id="46d61-153">Les applications utilisent généralement ce message à chaque modification de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="46d61-153">Applications typically use this message whenever the window changes.</span></span>

<span data-ttu-id="46d61-154">Si la fenêtre de lecture reçoit un message de génération de palette, votre application doit envoyer le message ICM de réalisation (ou utiliser la macro [**ICDrawRealize**](/windows/desktop/api/Vfw/nf-vfw-icdrawrealize) ) pour que le convertisseur réalise à nouveau la palette pour la lecture. [**\_ \_**](icm-draw-realize.md)</span><span class="sxs-lookup"><span data-stu-id="46d61-154">If the playback window gets a realize-palette message, your application must send the [**ICM\_DRAW\_REALIZE**](icm-draw-realize.md) message (or use the [**ICDrawRealize**](/windows/desktop/api/Vfw/nf-vfw-icdrawrealize) macro) to have the renderer realize the palette again for playback.</span></span> <span data-ttu-id="46d61-155">Les applications peuvent modifier la palette en envoyant le message [**\_ \_ CHANGEPALETTE de dessin ICM**](icm-draw-changepalette.md) (ou en utilisant la macro [**ICDrawChangePalette**](/windows/desktop/api/Vfw/nf-vfw-icdrawchangepalette) ) et obtenir la palette actuelle en envoyant le message d' [**obtention de \_ \_ \_ palette ICM**](icm-draw-get-palette.md) .</span><span class="sxs-lookup"><span data-stu-id="46d61-155">Applications can change the palette by sending the [**ICM\_DRAW\_CHANGEPALETTE**](icm-draw-changepalette.md) message (or use the [**ICDrawChangePalette**](/windows/desktop/api/Vfw/nf-vfw-icdrawchangepalette) macro) and obtain the current palette by sending the [**ICM\_DRAW\_GET\_PALETTE**](icm-draw-get-palette.md) message.</span></span>

<span data-ttu-id="46d61-156">Certains convertisseurs doivent être spécifiquement demandés pour afficher les frames qui leur sont passés.</span><span class="sxs-lookup"><span data-stu-id="46d61-156">Some renderers must be specifically instructed to display frames passed to them.</span></span> <span data-ttu-id="46d61-157">L’envoi du message [**\_ \_ RENDERBUFFER de dessin ICM**](icm-draw-renderbuffer.md) (ou l’utilisation de la macro [**ICDrawRenderBuffer**](/windows/desktop/api/Vfw/nf-vfw-icdrawrenderbuffer) ) entraîne la création du frame par ces convertisseurs.</span><span class="sxs-lookup"><span data-stu-id="46d61-157">Sending the [**ICM\_DRAW\_RENDERBUFFER**](icm-draw-renderbuffer.md) message (or use the [**ICDrawRenderBuffer**](/windows/desktop/api/Vfw/nf-vfw-icdrawrenderbuffer) macro) causes these renderers to draw the frame.</span></span>

 

 




