---
title: Gestion de MIDI via
description: Gestion de MIDI via
ms.assetid: ba03a2a1-d998-498d-ad53-027ba2b6e276
keywords:
- Interface MIDI (Musical Instrument Digital Interface), via le pilote
- MIDI (Musical Instrument Digital Interface), via le pilote
- enregistrement de l’audio MIDI, via le pilote
- Pilote MIDI via
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24214dd3f6cd13ca034b2555398f6055e4ce2da1
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103940883"
---
# <a name="managing-midi-thru"></a><span data-ttu-id="b9823-107">Gestion de MIDI via</span><span class="sxs-lookup"><span data-stu-id="b9823-107">Managing MIDI Thru</span></span>

<span data-ttu-id="b9823-108">Vous pouvez connecter un périphérique d’entrée MIDI directement à un périphérique de sortie MIDI afin que, lorsque l’appareil d’entrée reçoit un message MIM, le système envoie un message avec les mêmes données d’événement MIDI au pilote de périphérique de sortie. [**\_**](mim-data.md)</span><span class="sxs-lookup"><span data-stu-id="b9823-108">You can connect a MIDI input device directly to a MIDI output device so that when the input device receives an [**MIM\_DATA**](mim-data.md) message, the system sends a message with the same MIDI event data to the output device driver.</span></span> <span data-ttu-id="b9823-109">Pour connecter un périphérique de sortie MIDI à un périphérique d’entrée MIDI, utilisez la fonction [**midiConnect**](/windows/win32/api/mmeapi/nf-mmeapi-midiconnect) .</span><span class="sxs-lookup"><span data-stu-id="b9823-109">To connect a MIDI output device to a MIDI input device, use the [**midiConnect**](/windows/win32/api/mmeapi/nf-mmeapi-midiconnect) function.</span></span>

<span data-ttu-id="b9823-110">Pour obtenir les meilleures performances possibles avec plusieurs sorties, une application peut choisir de fournir une forme spéciale de pilote de sortie MIDI, appelée *pilote via*.</span><span class="sxs-lookup"><span data-stu-id="b9823-110">To achieve the best possible performance with multiple outputs, an application can choose to supply a special form of MIDI output driver, called a *thru driver*.</span></span> <span data-ttu-id="b9823-111">Bien que le système autorise un seul périphérique de sortie MIDI à être connecté à un périphérique d’entrée MIDI, plusieurs périphériques de sortie MIDI peuvent être connectés à un pilote via.</span><span class="sxs-lookup"><span data-stu-id="b9823-111">Although the system allows only one MIDI output device to be connected to a MIDI input device, multiple MIDI output devices can be connected to a thru driver.</span></span> <span data-ttu-id="b9823-112">Une application sur un système de ce type peut connecter l’appareil d’entrée MIDI à ce périphérique et connecter l’appareil MIDI à autant d’appareils de sortie MIDI que nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b9823-112">An application on such a system could connect the MIDI input device to this thru device and connect the MIDI thru device to as many MIDI output devices as needed.</span></span> <span data-ttu-id="b9823-113">Pour plus d’informations sur les pilotes, consultez la documentation relative au pilote de périphérique Windows.</span><span class="sxs-lookup"><span data-stu-id="b9823-113">For more information about thru drivers, see the Windows device-driver documentation.</span></span>

## <a name="using-messages-to-manage-midi-recording"></a><span data-ttu-id="b9823-114">Utilisation de messages pour gérer l’enregistrement MIDI</span><span class="sxs-lookup"><span data-stu-id="b9823-114">Using Messages to Manage MIDI Recording</span></span>

<span data-ttu-id="b9823-115">Les messages suivants peuvent être envoyés à une procédure de rappel de fenêtre ou de thread pour la gestion de l’enregistrement MIDI.</span><span class="sxs-lookup"><span data-stu-id="b9823-115">The following messages can be sent to a window or thread callback procedure for managing MIDI recording.</span></span>



| <span data-ttu-id="b9823-116">Valeur</span><span class="sxs-lookup"><span data-stu-id="b9823-116">Value</span></span>                                          | <span data-ttu-id="b9823-117">Signification</span><span class="sxs-lookup"><span data-stu-id="b9823-117">Meaning</span></span>                                                                                                                                |
|------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b9823-118">**MM \_ MIM \_ proche**</span><span class="sxs-lookup"><span data-stu-id="b9823-118">**MM\_MIM\_CLOSE**</span></span>](mm-mim-close.md)         | <span data-ttu-id="b9823-119">Envoyé lorsqu’un périphérique d’entrée MIDI est fermé à l’aide de la fonction [**midiInClose**](/windows/win32/api/mmeapi/nf-mmeapi-midiinclose) .</span><span class="sxs-lookup"><span data-stu-id="b9823-119">Sent when a MIDI input device is closed by using the [**midiInClose**](/windows/win32/api/mmeapi/nf-mmeapi-midiinclose) function.</span></span>                                      |
| [<span data-ttu-id="b9823-120">**MM \_ \_ données MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-120">**MM\_MIM\_DATA**</span></span>](mm-mim-data.md)           | <span data-ttu-id="b9823-121">Envoyé lors de la réception d’un message MIDI complet.</span><span class="sxs-lookup"><span data-stu-id="b9823-121">Sent when a complete MIDI message is received.</span></span> <span data-ttu-id="b9823-122">(Ce message est utilisé pour tous les messages MIDI, à l’exception des messages System-exclusive).</span><span class="sxs-lookup"><span data-stu-id="b9823-122">(This message is used for all MIDI messages except system-exclusive messages.)</span></span>          |
| [<span data-ttu-id="b9823-123">**MM \_ \_ erreur MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-123">**MM\_MIM\_ERROR**</span></span>](mm-mim-error.md)         | <span data-ttu-id="b9823-124">Envoyé lors de la réception d’un message MIDI non valide.</span><span class="sxs-lookup"><span data-stu-id="b9823-124">Sent when an invalid MIDI message is received.</span></span> <span data-ttu-id="b9823-125">(Ce message est utilisé pour tous les messages MIDI, à l’exception des messages System-exclusive).</span><span class="sxs-lookup"><span data-stu-id="b9823-125">(This message is used for all MIDI messages except system-exclusive messages.)</span></span>          |
| [<span data-ttu-id="b9823-126">**MM \_ \_ LONGDATA MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-126">**MM\_MIM\_LONGDATA**</span></span>](mm-mim-longdata.md)   | <span data-ttu-id="b9823-127">Envoyé lorsqu’un message MIDI système exclusif complet est reçu ou lorsqu’une mémoire tampon a été remplie avec des données système exclusives.</span><span class="sxs-lookup"><span data-stu-id="b9823-127">Sent when either a complete MIDI system-exclusive message is received or when a buffer has been filled with system-exclusive data.</span></span>     |
| [<span data-ttu-id="b9823-128">**MM \_ \_ LONGERROR MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-128">**MM\_MIM\_LONGERROR**</span></span>](mm-mim-longerror.md) | <span data-ttu-id="b9823-129">Envoyé lors de la réception d’un message de système d’exclusivité MIDI non valide.</span><span class="sxs-lookup"><span data-stu-id="b9823-129">Sent when an invalid MIDI system-exclusive message is received.</span></span>                                                                        |
| [<span data-ttu-id="b9823-130">**MM \_ \_ MOREDATA MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-130">**MM\_MIM\_MOREDATA**</span></span>](mm-mim-moredata.md)   | <span data-ttu-id="b9823-131">Envoyé lorsqu’une application ne traite pas les messages de [**\_ données MIM**](mim-data.md) suffisamment rapidement pour suivre le pilote de périphérique d’entrée.</span><span class="sxs-lookup"><span data-stu-id="b9823-131">Sent when an application is not processing [**MIM\_DATA**](mim-data.md) messages fast enough to keep up with the input device driver.</span></span> |
| [<span data-ttu-id="b9823-132">**MM \_ MIM \_ ouvert**</span><span class="sxs-lookup"><span data-stu-id="b9823-132">**MM\_MIM\_OPEN**</span></span>](mm-mim-open.md)           | <span data-ttu-id="b9823-133">Envoyé lorsqu’un périphérique d’entrée MIDI est ouvert à l’aide de la fonction [**midiInOpen**](/windows/win32/api/mmeapi/nf-mmeapi-midiinopen) .</span><span class="sxs-lookup"><span data-stu-id="b9823-133">Sent when a MIDI input device is opened by using the [**midiInOpen**](/windows/win32/api/mmeapi/nf-mmeapi-midiinopen) function.</span></span>                                        |



 

<span data-ttu-id="b9823-134">Un paramètre *wParam* et un paramètre *lParam* sont associés à chacun de ces messages.</span><span class="sxs-lookup"><span data-stu-id="b9823-134">A *wParam* parameter and an *lParam* parameter are associated with each of these messages.</span></span> <span data-ttu-id="b9823-135">Le paramètre *wParam* spécifie toujours le descripteur d’un appareil MIDI ouvert.</span><span class="sxs-lookup"><span data-stu-id="b9823-135">The *wParam* parameter always specifies the handle of an open MIDI device.</span></span> <span data-ttu-id="b9823-136">Le paramètre *lParam* n’est pas utilisé pour les messages d’ouverture MIM de [**\_ \_ fermeture**](mm-mim-close.md) et [**mm \_ MIM \_**](mm-mim-open.md) .</span><span class="sxs-lookup"><span data-stu-id="b9823-136">The *lParam* parameter is unused for the [**MM\_MIM\_CLOSE**](mm-mim-close.md) and [**MM\_MIM\_OPEN**](mm-mim-open.md) messages.</span></span>

<span data-ttu-id="b9823-137">Pour le message [**mm \_ MIM \_ LONGDATA**](mm-mim-longdata.md) , *lpMidiHdr* spécifie l’adresse d’une structure [**MIDIHDR**](/windows/win32/api/mmeapi/ns-mmeapi-midihdr) qui identifie la mémoire tampon pour les messages système-exclusifs.</span><span class="sxs-lookup"><span data-stu-id="b9823-137">For the [**MM\_MIM\_LONGDATA**](mm-mim-longdata.md) message, *lpMidiHdr* specifies an address of a [**MIDIHDR**](/windows/win32/api/mmeapi/ns-mmeapi-midihdr) structure that identifies the buffer for system-exclusive messages.</span></span> <span data-ttu-id="b9823-138">La mémoire tampon ne peut pas être complètement remplie, car la taille des messages système exclusifs n’est généralement pas connue avant d’être enregistrée et parce que les tampons dont la taille totale peut contenir le plus grand message attendu doivent être alloués.</span><span class="sxs-lookup"><span data-stu-id="b9823-138">The buffer may not be completely filled, because the size of the system-exclusive messages is usually not known before being recorded and because buffers whose total size can contain the largest expected message must be allocated.</span></span> <span data-ttu-id="b9823-139">Pour déterminer la quantité de données valides présentes dans la mémoire tampon, utilisez le membre **dwBytesRecorded** de la structure **MIDIHDR** .</span><span class="sxs-lookup"><span data-stu-id="b9823-139">To determine the amount of valid data present in the buffer, use the **dwBytesRecorded** member of the **MIDIHDR** structure.</span></span>

## <a name="using-a-callback-function-to-manage-midi-recording"></a><span data-ttu-id="b9823-140">Utilisation d’une fonction de rappel pour gérer l’enregistrement MIDI</span><span class="sxs-lookup"><span data-stu-id="b9823-140">Using a Callback Function to Manage MIDI Recording</span></span>

<span data-ttu-id="b9823-141">Vous pouvez définir votre propre fonction de rappel pour gérer l’enregistrement des périphériques d’entrée MIDI.</span><span class="sxs-lookup"><span data-stu-id="b9823-141">You can define your own callback function to manage recording for MIDI input devices.</span></span> <span data-ttu-id="b9823-142">La fonction de rappel est documentée en tant que [**MidiInProc**](/previous-versions//dd798460(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="b9823-142">The callback function is documented as [**MidiInProc**](/previous-versions//dd798460(v=vs.85)).</span></span>

<span data-ttu-id="b9823-143">Les messages suivants peuvent être envoyés au paramètre *wMsg* de la fonction de rappel **MidiInProc** .</span><span class="sxs-lookup"><span data-stu-id="b9823-143">The following messages can be sent to the *wMsg* parameter of the **MidiInProc** callback function.</span></span>



| <span data-ttu-id="b9823-144">Valeur</span><span class="sxs-lookup"><span data-stu-id="b9823-144">Value</span></span>                                   | <span data-ttu-id="b9823-145">Signification</span><span class="sxs-lookup"><span data-stu-id="b9823-145">Meaning</span></span>                                                                                                                                |
|-----------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b9823-146">**\_fermeture MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-146">**MIM\_CLOSE**</span></span>](mim-close.md)         | <span data-ttu-id="b9823-147">Envoyé lorsque l’appareil est fermé à l’aide de la fonction [**midiInClose**](/windows/win32/api/mmeapi/nf-mmeapi-midiinclose) .</span><span class="sxs-lookup"><span data-stu-id="b9823-147">Sent when the device is closed by using the [**midiInClose**](/windows/win32/api/mmeapi/nf-mmeapi-midiinclose) function.</span></span>                                               |
| [<span data-ttu-id="b9823-148">**\_données MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-148">**MIM\_DATA**</span></span>](mim-data.md)           | <span data-ttu-id="b9823-149">Envoyé lors de la réception d’un message MIDI complet (ce message est utilisé pour tous les messages MIDI, à l’exception des messages System-exclusive).</span><span class="sxs-lookup"><span data-stu-id="b9823-149">Sent when a complete MIDI message is received (this message is used for all MIDI messages except system-exclusive messages).</span></span>           |
| [<span data-ttu-id="b9823-150">**\_erreur MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-150">**MIM\_ERROR**</span></span>](mim-error.md)         | <span data-ttu-id="b9823-151">Envoyé lors de la réception d’un message MIDI non valide (ce message est utilisé pour tous les messages MIDI, à l’exception des messages System-exclusive).</span><span class="sxs-lookup"><span data-stu-id="b9823-151">Sent when an invalid MIDI message is received (this message is used for all MIDI messages except system-exclusive messages).</span></span>           |
| [<span data-ttu-id="b9823-152">**\_LONGDATA MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-152">**MIM\_LONGDATA**</span></span>](mim-longdata.md)   | <span data-ttu-id="b9823-153">Envoyé lorsqu’un message MIDI système exclusif complet est reçu ou lorsqu’une mémoire tampon a été remplie avec des données système exclusives.</span><span class="sxs-lookup"><span data-stu-id="b9823-153">Sent when either a complete MIDI system-exclusive message is received or when a buffer has been filled with system-exclusive data.</span></span>     |
| [<span data-ttu-id="b9823-154">**\_LONGERROR MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-154">**MIM\_LONGERROR**</span></span>](mim-longerror.md) | <span data-ttu-id="b9823-155">Envoyé lors de la réception d’un message de système d’exclusivité MIDI non valide.</span><span class="sxs-lookup"><span data-stu-id="b9823-155">Sent when an invalid MIDI system-exclusive message is received.</span></span>                                                                        |
| [<span data-ttu-id="b9823-156">**\_MOREDATA MIM**</span><span class="sxs-lookup"><span data-stu-id="b9823-156">**MIM\_MOREDATA**</span></span>](mim-moredata.md)   | <span data-ttu-id="b9823-157">Envoyé lorsqu’une application ne traite pas les messages de [**\_ données MIM**](mim-data.md) suffisamment rapidement pour suivre le pilote de périphérique d’entrée.</span><span class="sxs-lookup"><span data-stu-id="b9823-157">Sent when an application is not processing [**MIM\_DATA**](mim-data.md) messages fast enough to keep up with the input device driver.</span></span> |
| [<span data-ttu-id="b9823-158">**MIM \_ ouvert**</span><span class="sxs-lookup"><span data-stu-id="b9823-158">**MIM\_OPEN**</span></span>](mim-open.md)           | <span data-ttu-id="b9823-159">Envoyé lorsque l’appareil d’entrée MIDI est ouvert à l’aide de la fonction [**midiInOpen**](/windows/win32/api/mmeapi/nf-mmeapi-midiinopen) .</span><span class="sxs-lookup"><span data-stu-id="b9823-159">Sent when the MIDI input device is opened by using the [**midiInOpen**](/windows/win32/api/mmeapi/nf-mmeapi-midiinopen) function.</span></span>                                      |



 

<span data-ttu-id="b9823-160">Ces messages sont similaires à ceux envoyés aux fonctions de procédure de fenêtre, mais les paramètres sont différents.</span><span class="sxs-lookup"><span data-stu-id="b9823-160">These messages are similar to those sent to window procedure functions, but the parameters are different.</span></span> <span data-ttu-id="b9823-161">Un handle de l’appareil MIDI ouvert est passé en tant que paramètre à la fonction de rappel, avec le mot double des données d’instance qui a été passé à l’aide de **midiInOpen**.</span><span class="sxs-lookup"><span data-stu-id="b9823-161">A handle of the open MIDI device is passed as a parameter to the callback function, along with the doubleword of instance data that was passed by using **midiInOpen**.</span></span>

<span data-ttu-id="b9823-162">Pour le message [**MIM \_ LONGDATA**](mim-longdata.md) , *lpMidiHdr* spécifie l’adresse d’une structure [**MIDIHDR**](/windows/win32/api/mmeapi/ns-mmeapi-midihdr) qui identifie la mémoire tampon pour les messages System-exclusives.</span><span class="sxs-lookup"><span data-stu-id="b9823-162">For the [**MIM\_LONGDATA**](mim-longdata.md) message, *lpMidiHdr* specifies an address of a [**MIDIHDR**](/windows/win32/api/mmeapi/ns-mmeapi-midihdr) structure that identifies the buffer for system-exclusive messages.</span></span> <span data-ttu-id="b9823-163">La mémoire tampon n’est peut-être pas complètement remplie.</span><span class="sxs-lookup"><span data-stu-id="b9823-163">The buffer might not be completely filled.</span></span> <span data-ttu-id="b9823-164">Pour déterminer la quantité de données valides présentes dans la mémoire tampon, utilisez le membre **dwBytesRecorded** de la structure **MIDIHDR** .</span><span class="sxs-lookup"><span data-stu-id="b9823-164">To determine the amount of valid data present in the buffer, use the **dwBytesRecorded** member of the **MIDIHDR** structure.</span></span>

<span data-ttu-id="b9823-165">Une fois que le pilote de périphérique est terminé par un bloc de données, vous pouvez nettoyer et libérer le bloc de données.</span><span class="sxs-lookup"><span data-stu-id="b9823-165">After the device driver is finished with a data block, you can clean up and free the data block.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b9823-166">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="b9823-166">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b9823-167">Enregistrement d’un fichier audio MIDI</span><span class="sxs-lookup"><span data-stu-id="b9823-167">Recording MIDI Audio</span></span>](recording-midi-audio.md)
</dt> </dl>

 

 