---
title: Capture en continu à partir d’un périphérique MCI
description: Capture en continu à partir d’un périphérique MCI
ms.assetid: 44cbf375-f97e-426a-a703-dfb1b1933138
keywords:
- MCI (Media Control Interface), capture en continu
- Message WM_CAP_SET_MCI_DEVICE
- capSetMCIDeviceName macro)
- Message WM_CAP_GET_MCI_DEVICE
- capGetMCIDeviceName macro)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab8cf358a87a812024328abf7fc1aae0509a126f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104507374"
---
# <a name="streaming-capture-from-an-mci-device"></a><span data-ttu-id="4efdf-108">Capture en continu à partir d’un périphérique MCI</span><span class="sxs-lookup"><span data-stu-id="4efdf-108">Streaming Capture from an MCI Device</span></span>

<span data-ttu-id="4efdf-109">Les périphériques MCI augmentent l’opération de capture en temps réel de capture et de capture de frame.</span><span class="sxs-lookup"><span data-stu-id="4efdf-109">MCI devices augment the capture operation in real-time capture and step-frame capture.</span></span> <span data-ttu-id="4efdf-110">Vous pouvez spécifier l’appareil MCI, tel qu’un enregistreur videodisc ou Video-cassette (VCR), agissant comme source vidéo pour votre opération de capture à l’aide du message de l' [**\_ appareil WM embout \_ Set \_ MCI \_**](wm-cap-set-mci-device.md) (ou de la macro [**capSetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capsetmcidevicename) ) et en spécifiant le nom de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="4efdf-110">You can specify the MCI device, such as a videodisc or video-cassette recorder (VCR), acting as the video source for your capture operation by using the [**WM\_CAP\_SET\_MCI\_DEVICE**](wm-cap-set-mci-device.md) message (or the [**capSetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capsetmcidevicename) macro) and specifying the name of the device.</span></span> <span data-ttu-id="4efdf-111">Vous pouvez également récupérer le nom de l’appareil actuellement défini à l’aide du message [**WM \_ Cap \_ obtenir un \_ \_ appareil MCI**](wm-cap-get-mci-device.md) (ou la macro [**capGetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capgetmcidevicename) ).</span><span class="sxs-lookup"><span data-stu-id="4efdf-111">You can also retrieve the device name currently set by using the [**WM\_CAP\_GET\_MCI\_DEVICE**](wm-cap-get-mci-device.md) message (or the [**capGetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capgetmcidevicename) macro).</span></span>

<span data-ttu-id="4efdf-112">Dans la capture en temps réel, la fenêtre de capture synchronise l’opération de capture et compense les retards associés au positionnement de la source vidéo MCI et à l’initialisation des ressources (telles que les mémoires tampons de capture) requises pour la capture des données.</span><span class="sxs-lookup"><span data-stu-id="4efdf-112">In real-time capture, the capture window synchronizes the capture operation and compensates for delays associated with positioning the MCI video source and initializing the resources (such as capture buffers) required for capturing data.</span></span> <span data-ttu-id="4efdf-113">La fenêtre de capture attend qu’un périphérique vidéo MCI valide soit installé dans le système pour capturer les données de cette manière.</span><span class="sxs-lookup"><span data-stu-id="4efdf-113">The capture window expects a valid MCI video device to be installed in the system for capturing data this way.</span></span>

<span data-ttu-id="4efdf-114">Les spécifications de contrôle d’un périphérique MCI sont stockées dans les membres de la structure [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) .</span><span class="sxs-lookup"><span data-stu-id="4efdf-114">Specifications for controlling an MCI device are stored in the members of the [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) structure.</span></span> <span data-ttu-id="4efdf-115">Les sources vidéo compatibles MCI incluent les magnétoscopes et les LaserDiscs.</span><span class="sxs-lookup"><span data-stu-id="4efdf-115">MCI-compatible video sources include VCRs and laserdiscs.</span></span> <span data-ttu-id="4efdf-116">Si le membre **fMCIControl** de cette structure a la valeur **true**, la fenêtre de capture coordonne l’opération MCI.</span><span class="sxs-lookup"><span data-stu-id="4efdf-116">If the **fMCIControl** member of this structure is set to **TRUE**, the capture window coordinates MCI operation.</span></span> <span data-ttu-id="4efdf-117">La fenêtre de capture utilise les paramètres spécifiés dans les membres **dwMCIStartTime** et **dwMCIStopTime** pour obtenir les positions de départ et d’arrêt, en millisecondes, de la séquence.</span><span class="sxs-lookup"><span data-stu-id="4efdf-117">The capture window uses the parameters specified in the **dwMCIStartTime** and **dwMCIStopTime** members to obtain the starting and stopping positions, in milliseconds, of the sequence.</span></span> <span data-ttu-id="4efdf-118">Si la valeur de **fMCIControl** est **false**, la source vidéo n’est pas traitée comme un périphérique MCI et le contenu de **dwMCIStartTime** et **dwMCIStopTime** est ignoré.</span><span class="sxs-lookup"><span data-stu-id="4efdf-118">If the value of **fMCIControl** is **FALSE**, the video source is not treated as an MCI device and the contents of **dwMCIStartTime** and **dwMCIStopTime** are ignored.</span></span>

<span data-ttu-id="4efdf-119">Vous pouvez utiliser le lecteur multimédia pour vérifier rapidement qu’un périphérique vidéo MCI est correctement connecté au système.</span><span class="sxs-lookup"><span data-stu-id="4efdf-119">You can use Media Player to quickly verify that an MCI video device is properly connected to the system.</span></span> <span data-ttu-id="4efdf-120">La lecture d’un appareil avec le lecteur multimédia vérifie que la configuration MCI pour l’appareil est correcte.</span><span class="sxs-lookup"><span data-stu-id="4efdf-120">Playing a device with Media Player verifies that the MCI configuration for the device is correct.</span></span> <span data-ttu-id="4efdf-121">Si une image apparaît sur l’affichage vidéo, la source vidéo est correctement connectée au matériel de capture.</span><span class="sxs-lookup"><span data-stu-id="4efdf-121">If an image appears on the video display, the video source is connected properly to the capture hardware.</span></span>

<span data-ttu-id="4efdf-122">Dans la capture d’image pas à pas, la fenêtre de capture synchronise l’opération de capture et compense les retards associés à l’emplacement de la source vidéo MCI et à l’initialisation des ressources nécessaires à la capture des données.</span><span class="sxs-lookup"><span data-stu-id="4efdf-122">In step-frame capture, the capture window synchronizes the capture operation and compensates for the delays associated with positioning the MCI video source and initializing the resources required for capturing data.</span></span> <span data-ttu-id="4efdf-123">En outre, la fenêtre de capture garantit qu’aucun frame n’est supprimé. Il parcourt les images vidéo individuellement, garantissant ainsi que le frame est capturé et stocké avant de capturer le cadre suivant dans le flux vidéo.</span><span class="sxs-lookup"><span data-stu-id="4efdf-123">In addition, the capture window ensures that no frames are dropped; it steps through the video frames individually, ensuring that the frame is captured and stored before capturing the next frame in the video stream.</span></span>

<span data-ttu-id="4efdf-124">Les spécifications pour le contrôle de la capture d’image pas à pas sont stockées dans les membres de la structure [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) .</span><span class="sxs-lookup"><span data-stu-id="4efdf-124">Specifications for controlling step-frame capture are stored in the members of the [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) structure.</span></span> <span data-ttu-id="4efdf-125">La capture d’image pas à pas utilise les membres suivants en plus des membres utilisés pour la capture en temps réel : **fStepMCIDevice**, **fStepCaptureAt2x** et **wStepCaptureAverageFrames**.</span><span class="sxs-lookup"><span data-stu-id="4efdf-125">Step-frame capture uses the following members in addition to the members used for real-time capture: **fStepMCIDevice**, **fStepCaptureAt2x**, and **wStepCaptureAverageFrames**.</span></span> <span data-ttu-id="4efdf-126">Si le membre **fStepMCIDevice** a la valeur **true**, la fenêtre de capture coordonne la capture d’image pas à pas.</span><span class="sxs-lookup"><span data-stu-id="4efdf-126">If the **fStepMCIDevice** member is set to **TRUE**, the capture window coordinates step-frame capture.</span></span> <span data-ttu-id="4efdf-127">La fenêtre de capture utilise les paramètres spécifiés dans les membres **dwMCIStartTime** et **dwMCIStopTime** pour les positions de départ et d’arrêt, en millisecondes, de la séquence.</span><span class="sxs-lookup"><span data-stu-id="4efdf-127">The capture window uses the parameters specified in the **dwMCIStartTime** and **dwMCIStopTime** members for the starting and stopping positions, in milliseconds, of the sequence.</span></span> <span data-ttu-id="4efdf-128">La fenêtre de capture utilise **fStepCaptureAt2x** pour déterminer si le matériel de capture doit capturer des images vidéo à deux reprises de la résolution normale et utilise **wStepCaptureAverageFrames** pour spécifier le nombre de fois où chaque trame dans l’opération de capture est échantillonnée.</span><span class="sxs-lookup"><span data-stu-id="4efdf-128">The capture window uses **fStepCaptureAt2x** to determine if the capture hardware should capture video frames at twice the normal resolution and uses **wStepCaptureAverageFrames** to specify the number of times each frame in the capture operation is sampled.</span></span>

<span data-ttu-id="4efdf-129">Si **fStepMCIDevice** a la **valeur false**, la capture en temps réel est utilisée à la place de la capture d’image pas à pas et le contenu de **fStepCaptureAt2x**, et **wStepCaptureAverageFrames** sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="4efdf-129">If **fStepMCIDevice** is **FALSE**, real-time capture is used instead of step-frame capture and the contents of **fStepCaptureAt2x**, and **wStepCaptureAverageFrames** are ignored.</span></span>

<span data-ttu-id="4efdf-130">Si une capture d’image pas à pas est spécifiée et que **fStepCaptureAt2x** est défini sur **true**, le matériel de capture capture à deux reprises la résolution spécifiée.</span><span class="sxs-lookup"><span data-stu-id="4efdf-130">If a step-frame capture is specified and **fStepCaptureAt2x** is set to **TRUE**, the capture hardware captures at twice the specified resolution.</span></span> <span data-ttu-id="4efdf-131">(Les résolutions de la hauteur et de la largeur sont doublées.) Le logiciel interpole les pixels de l’image de résolution supérieure pour produire l’image à la résolution spécifiée.</span><span class="sxs-lookup"><span data-stu-id="4efdf-131">(The resolutions of both the height and width are doubled.) The software interpolates the pixels in the higher resolution image to produce the image at the specified resolution.</span></span> <span data-ttu-id="4efdf-132">Cette forme de moyenne peut améliorer la définition de l’arête des images dans un cadre.</span><span class="sxs-lookup"><span data-stu-id="4efdf-132">This form of averaging can improve the edge definition of images in a frame.</span></span> <span data-ttu-id="4efdf-133">Vous pouvez activer cette option si le matériel ne prend pas en charge la décimalisation basée sur le matériel et que vous capturez le format RVB.</span><span class="sxs-lookup"><span data-stu-id="4efdf-133">You can enable this option if the hardware does not support hardware-based decimation and you are capturing in the RGB format.</span></span>

> [!Note]  
> <span data-ttu-id="4efdf-134">Si votre matériel prend en charge la décimalisation basée sur le matériel, il peut capturer des échantillons à une fréquence supérieure à celle spécifiée et utiliser ces exemples supplémentaires pour obtenir des définitions de couleurs plus cohérentes avec l’image d’origine.</span><span class="sxs-lookup"><span data-stu-id="4efdf-134">If your hardware supports hardware-based decimation, it can capture samples at a higher rate than specified and use these additional samples to obtain color definitions that are more consistent with the original image.</span></span> <span data-ttu-id="4efdf-135">Les exemples supplémentaires sont ignorés une fois qu’ils sont utilisés et le matériel passe des exemples au pilote de capture à la fréquence spécifiée.</span><span class="sxs-lookup"><span data-stu-id="4efdf-135">The additional samples are discarded after they are used, and the hardware passes samples to the capture driver at the specified rate.</span></span>

 

<span data-ttu-id="4efdf-136">Si une capture d’image pas à pas est spécifiée, le membre **wStepCaptureAverageFrames** spécifie le nombre de fois où une image est échantillonnée lors de la création d’un frame basé sur l’échantillon moyen.</span><span class="sxs-lookup"><span data-stu-id="4efdf-136">If a step-frame capture is specified, the **wStepCaptureAverageFrames** member specifies the number of times a frame is sampled when creating a frame based on the average sample.</span></span> <span data-ttu-id="4efdf-137">Cette technique de calcul de la moyenne réduit le bruit de numérisation aléatoire apparaissant dans un cadre.</span><span class="sxs-lookup"><span data-stu-id="4efdf-137">This averaging technique reduces the random digitization noise appearing in a frame.</span></span> <span data-ttu-id="4efdf-138">Une valeur typique pour le nombre de moyennes est 5.</span><span class="sxs-lookup"><span data-stu-id="4efdf-138">A typical value for the number of averages is 5.</span></span>

<span data-ttu-id="4efdf-139">Pour plus d’informations sur MCI, consultez [MCI](mci.md).</span><span class="sxs-lookup"><span data-stu-id="4efdf-139">For more information about MCI, see [MCI](mci.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4efdf-140">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="4efdf-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4efdf-141">Variations de capture</span><span class="sxs-lookup"><span data-stu-id="4efdf-141">Capture Variations</span></span>](capture-variations.md)
</dt> </dl>

 

 




