---
title: Écriture de flux dans un fichier
description: Écriture de flux dans un fichier
ms.assetid: a3766f8c-aaa6-4fc5-a306-54aee71018f1
keywords:
- AVIFileCreateStream fonction)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 370df08534bbdde870f6d28c828d47935abd80db
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103725541"
---
# <a name="writing-streams-to-a-file"></a><span data-ttu-id="f6342-104">Écriture de flux dans un fichier</span><span class="sxs-lookup"><span data-stu-id="f6342-104">Writing Streams to a File</span></span>

<span data-ttu-id="f6342-105">Vous pouvez également créer un fichier contenant des flux de données en écrivant un nouveau flux de données dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="f6342-105">You can also create a file containing data streams by writing a new data stream to a file.</span></span>

<span data-ttu-id="f6342-106">Vous pouvez créer un flux dans un nouveau fichier ou un fichier existant à l’aide de la fonction [**AVIFileCreateStream**](/windows/desktop/api/Vfw/nf-vfw-avifilecreatestream) .</span><span class="sxs-lookup"><span data-stu-id="f6342-106">You can create a new stream in a new or existing file by using the [**AVIFileCreateStream**](/windows/desktop/api/Vfw/nf-vfw-avifilecreatestream) function.</span></span> <span data-ttu-id="f6342-107">Cette fonction définit un nouveau flux en fonction des caractéristiques décrites dans une structure [**AVISTREAMINFO**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) , crée une interface de flux pour le nouveau flux, incrémente le décompte de références du flux et retourne l’adresse du pointeur d’interface de flux.</span><span class="sxs-lookup"><span data-stu-id="f6342-107">This function defines a new stream according to the characteristics described in an [**AVISTREAMINFO**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) structure, creates a stream interface for the new stream, increments the reference count of the stream, and returns the address of the stream-interface pointer.</span></span>

<span data-ttu-id="f6342-108">Avant d’écrire le contenu du flux, vous devez spécifier le format de flux.</span><span class="sxs-lookup"><span data-stu-id="f6342-108">Before you write the content of the stream, you must specify the stream format.</span></span> <span data-ttu-id="f6342-109">Vous pouvez définir le format de flux à l’aide de la fonction [**AVIStreamSetFormat**](/windows/desktop/api/Vfw/nf-vfw-avistreamsetformat) .</span><span class="sxs-lookup"><span data-stu-id="f6342-109">You can set the stream format by using the [**AVIStreamSetFormat**](/windows/desktop/api/Vfw/nf-vfw-avistreamsetformat) function.</span></span> <span data-ttu-id="f6342-110">Lorsque vous définissez le format d’un flux vidéo, vous devez fournir cette fonction avec une structure [**BITMAPINFO,**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) contenant les informations appropriées.</span><span class="sxs-lookup"><span data-stu-id="f6342-110">When setting the format of a video stream, you must supply this function with a [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure containing the appropriate information.</span></span> <span data-ttu-id="f6342-111">Lorsque vous définissez le format d’un flux audio, vous devez fournir une structure [**WaveFormat**](/windows/win32/api/mmreg/ns-mmreg-waveformat) ou [**WAVEFORMATEX**](/windows/win32/api/mmeapi/ns-mmeapi-waveformatex) contenant les informations appropriées.</span><span class="sxs-lookup"><span data-stu-id="f6342-111">When setting the format of an audio stream, you must supply a [**WAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-waveformat) or [**WAVEFORMATEX**](/windows/win32/api/mmeapi/ns-mmeapi-waveformatex) structure containing the appropriate information.</span></span> <span data-ttu-id="f6342-112">Les informations que vous devez fournir à la fonction pour d’autres types de flux dépendent du type de flux et du gestionnaire de flux.</span><span class="sxs-lookup"><span data-stu-id="f6342-112">The information you need to supply to the function for other stream types depends on the stream type and the stream handler.</span></span>

<span data-ttu-id="f6342-113">Vous pouvez écrire le contenu multimédia dans un flux à l’aide de la fonction [**AVIStreamWrite**](/windows/desktop/api/Vfw/nf-vfw-avistreamwrite) .</span><span class="sxs-lookup"><span data-stu-id="f6342-113">You can write the multimedia content in a stream by using the [**AVIStreamWrite**](/windows/desktop/api/Vfw/nf-vfw-avistreamwrite) function.</span></span> <span data-ttu-id="f6342-114">Cette fonction copie les données brutes à partir d’une mémoire tampon fournie par l’application dans le flux spécifié.</span><span class="sxs-lookup"><span data-stu-id="f6342-114">This function copies raw data from an application-supplied buffer into the specified stream.</span></span> <span data-ttu-id="f6342-115">Le gestionnaire de fichiers AVI par défaut ajoute des informations à la fin d’un flux.</span><span class="sxs-lookup"><span data-stu-id="f6342-115">The default AVI file handler appends information to the end of a stream.</span></span> <span data-ttu-id="f6342-116">Le gestionnaire WAVE par défaut peut écrire des données Waveform-Audio dans un flux, ainsi qu’à la fin d’un flux.</span><span class="sxs-lookup"><span data-stu-id="f6342-116">The default WAVE handler can write waveform-audio data within a stream as well as at the end of a stream.</span></span>

<span data-ttu-id="f6342-117">Vous pouvez écrire des informations supplémentaires sur le fichier ou le flux qui n’est pas inclus dans la fonction [**AVIFileCreateStream**](/windows/desktop/api/Vfw/nf-vfw-avifilecreatestream) ou [**AVIStreamSetFormat**](/windows/desktop/api/Vfw/nf-vfw-avistreamsetformat) à l’aide des fonctions [**AVIFileWriteData**](/windows/desktop/api/Vfw/nf-vfw-avifilewritedata) et [**AVIStreamWriteData**](/windows/desktop/api/Vfw/nf-vfw-avistreamwritedata) .</span><span class="sxs-lookup"><span data-stu-id="f6342-117">You can write supplementary information about the file or stream that is not included in the [**AVIFileCreateStream**](/windows/desktop/api/Vfw/nf-vfw-avifilecreatestream) or [**AVIStreamSetFormat**](/windows/desktop/api/Vfw/nf-vfw-avistreamsetformat) function by using the [**AVIFileWriteData**](/windows/desktop/api/Vfw/nf-vfw-avifilewritedata) and [**AVIStreamWriteData**](/windows/desktop/api/Vfw/nf-vfw-avistreamwritedata) functions.</span></span> <span data-ttu-id="f6342-118">Vous pouvez enregistrer les données qui s’appliquent à l’ensemble du fichier, telles que les informations de copyright et l’historique des modifications, à l’aide de **AVIFileWriteData**.</span><span class="sxs-lookup"><span data-stu-id="f6342-118">You can record data that is applicable to the entire file, such as copyright information and modification history, by using **AVIFileWriteData**.</span></span> <span data-ttu-id="f6342-119">Vous pouvez enregistrer des informations spécifiques au flux, telles que les paramètres de compression et de décompression, à l’aide de **AVIStreamWriteData**.</span><span class="sxs-lookup"><span data-stu-id="f6342-119">You can record stream-specific information, such as compression and decompression settings, by using **AVIStreamWriteData**.</span></span> <span data-ttu-id="f6342-120">Les informations supplémentaires sont stockées dans des blocs distincts au sein du fichier.</span><span class="sxs-lookup"><span data-stu-id="f6342-120">The supplementary information is stored in separate chunks within the file.</span></span>

<span data-ttu-id="f6342-121">Vous pouvez fermer le flux une fois que vous avez fini d’écrire dans le nouveau flux à l’aide de la fonction [**AVIStreamRelease**](/windows/desktop/api/Vfw/nf-vfw-avistreamrelease) .</span><span class="sxs-lookup"><span data-stu-id="f6342-121">You can close the stream after you finish writing to the new stream by using the [**AVIStreamRelease**](/windows/desktop/api/Vfw/nf-vfw-avistreamrelease) function.</span></span> <span data-ttu-id="f6342-122">Cette fonction efface les mémoires tampons utilisées pour enregistrer les données de flux, puis termine et ferme tous les blocs de données incomplets dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="f6342-122">This function clears buffers used in recording the stream data, and it completes and closes any incomplete data chunks in the file.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f6342-123">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f6342-123">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f6342-124">Opérations de flux</span><span class="sxs-lookup"><span data-stu-id="f6342-124">Stream Operations</span></span>](stream-operations.md)
</dt> </dl>

 

 