---
title: Inscription d’un appareil hébergé auprès de l’hôte de l’appareil
description: L’inscription d’un appareil hébergé signifie fournir à l’hôte d’appareil la description de l’appareil et son objet de contrôle de l’appareil.
ms.assetid: 1d85b412-9b1b-415d-8664-8d96a6644793
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4a607af4f6ada359a9ee32e98e416d8271fd502
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104196696"
---
# <a name="registering-a-hosted-device-with-the-device-host"></a><span data-ttu-id="dca01-103">Inscription d’un appareil hébergé auprès de l’hôte de l’appareil</span><span class="sxs-lookup"><span data-stu-id="dca01-103">Registering a Hosted Device With the Device Host</span></span>

<span data-ttu-id="dca01-104">L’inscription d’un appareil hébergé signifie fournir à l’hôte d’appareil la description de l’appareil et son objet de contrôle de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-104">Registering a hosted device means providing the device host with the device description and its device control object.</span></span> <span data-ttu-id="dca01-105">L’hôte d’appareil construit ensuite une description complète de l’appareil UPnP, le publie et annonce l’appareil sur le réseau à l’aide du protocole de découverte UPnP.</span><span class="sxs-lookup"><span data-stu-id="dca01-105">The device host then constructs a complete UPnP device description, publishes it, and announces the device on the network using the UPnP discovery protocol.</span></span> <span data-ttu-id="dca01-106">Une fois qu’un appareil est publié, il est disponible pour les points de contrôle.</span><span class="sxs-lookup"><span data-stu-id="dca01-106">Once a device is published, it is available to control points.</span></span>

<span data-ttu-id="dca01-107">Les appareils sont inscrits de deux manières :</span><span class="sxs-lookup"><span data-stu-id="dca01-107">Devices are registered in two ways:</span></span>

-   <span data-ttu-id="dca01-108">Une application crée une instance de l’objet de contrôle de l’appareil et lui transmet un pointeur vers l’hôte de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-108">An application creates an instance of the device control object and passes a pointer to it to the device host.</span></span>
-   <span data-ttu-id="dca01-109">L’application transmet le ProgID d’un objet de contrôle d’appareil inscrit à l’hôte de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-109">The application passes the ProgID for a registered device control object to the device host.</span></span> <span data-ttu-id="dca01-110">L’hôte d’appareil l’instancie lorsque l’hôte de l’appareil reçoit la première demande de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-110">The device host instantiates it when the device host receives the first request for the device.</span></span>

<span data-ttu-id="dca01-111">Quelle que soit la méthode utilisée, l’hôte d’appareil publie et annonce l’appareil dès qu’il est enregistré.</span><span class="sxs-lookup"><span data-stu-id="dca01-111">Regardless of which method is used, the device host publishes and announces the device as soon as it is registered.</span></span> <span data-ttu-id="dca01-112">La différence entre les deux approches concerne le chargement du code de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-112">The difference between the two approaches has to do with when the device code is loaded.</span></span> <span data-ttu-id="dca01-113">Lorsque l’application passe dans un pointeur vers l’objet de contrôle d’appareil, le code de l’appareil est chargé et en cours d’exécution au moment de l’inscription.</span><span class="sxs-lookup"><span data-stu-id="dca01-113">When the application passes in a pointer to the device control object, the device code is loaded and running at the time of registration.</span></span> <span data-ttu-id="dca01-114">Lorsque l’application passe un ProgID, le code de l’appareil n’est chargé qu’au moment de l’appel d’une action, une propriété est interrogée ou une demande d’abonnement à un événement arrive.</span><span class="sxs-lookup"><span data-stu-id="dca01-114">When the application passes a ProgID, the device code is only loaded when an action is invoked, a property is queried, or an event subscription request arrives.</span></span> <span data-ttu-id="dca01-115">La deuxième approche est un peu plus efficace.</span><span class="sxs-lookup"><span data-stu-id="dca01-115">The second approach is slightly more efficient.</span></span> <span data-ttu-id="dca01-116">Toutefois, elle ne convient pas pour les appareils qui doivent être en cours d’exécution avant l’arrivée des demandes d’abonnement de contrôle ou d’événement, car l’utilisation de cette approche ne crée des objets de contrôle de périphérique que lorsqu’ils sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="dca01-116">However, it is not suitable for devices that must be running before any control or event subscription requests arrive, because using this approach, device control objects are only created when they are needed.</span></span> <span data-ttu-id="dca01-117">Cette deuxième méthode peut également créer des problèmes de performances lorsqu’elle reçoit la première demande pour un type d’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-117">This second method can also create performance issues when it receives the first request for a device type.</span></span>

<span data-ttu-id="dca01-118">Si vous souhaitez vous assurer qu’un appareil est annoncé automatiquement par l’hôte d’appareil sur le réseau au démarrage de l’ordinateur, appelez [**IUPnPRegistrar :: RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice).</span><span class="sxs-lookup"><span data-stu-id="dca01-118">If you want to ensure that a device is announced by the device host on the network automatically when the computer is started, invoke [**IUPnPRegistrar::RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice).</span></span> <span data-ttu-id="dca01-119">**RegisterDevice** garantit que le code de votre appareil est uniquement chargé lors de la réception d’une demande de contrôle ou d’abonnement à un événement.</span><span class="sxs-lookup"><span data-stu-id="dca01-119">**RegisterDevice** ensures that your device code is only loaded when a control or event subscription request is received.</span></span>

<span data-ttu-id="dca01-120">Si vos appareils sont temporaires ou pontés, appelez [**IUPnPRegistrar :: RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), et l’appareil n’est pas automatiquement republié lorsque l’ordinateur est redémarré.</span><span class="sxs-lookup"><span data-stu-id="dca01-120">If your devices are transient or bridged, invoke [**IUPnPRegistrar::RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), and the device is not automatically re-advertised when the computer is restarted.</span></span>

## <a name="discovery-announcement-lifetime"></a><span data-ttu-id="dca01-121">Durée de vie de l’annonce de découverte</span><span class="sxs-lookup"><span data-stu-id="dca01-121">Discovery Announcement Lifetime</span></span>

<span data-ttu-id="dca01-122">Chaque appareil inscrit auprès de l’hôte d’appareil est associé à une durée de vie spécifiée par l’appareil lors de l’inscription.</span><span class="sxs-lookup"><span data-stu-id="dca01-122">Each device registered with the device host is associated with a lifetime, which is specified by the device upon registration.</span></span> <span data-ttu-id="dca01-123">La durée de vie de l’appareil correspond à la durée pendant laquelle les annonces de découverte de l’appareil sont valides.</span><span class="sxs-lookup"><span data-stu-id="dca01-123">The lifetime of the device is the period of time for which the device's discovery announcements are valid.</span></span> <span data-ttu-id="dca01-124">La durée de vie est passée au point de contrôle en tant qu’en-tête dans l’annonce de découverte initiale.</span><span class="sxs-lookup"><span data-stu-id="dca01-124">The lifetime is passed to the control point as a header in the initial discovery announcement.</span></span> <span data-ttu-id="dca01-125">L’hôte d’appareil actualise automatiquement l’annonce avant l’heure d’expiration.</span><span class="sxs-lookup"><span data-stu-id="dca01-125">The device host automatically refreshes the announcement prior to the expiration time.</span></span> <span data-ttu-id="dca01-126">Les valeurs de la durée de vie de l’annonce de découverte doivent être de 15 minutes ou plus (la valeur par défaut est 30 minutes).</span><span class="sxs-lookup"><span data-stu-id="dca01-126">The values of the discovery announcement lifetime should be 15 minutes or more (the default is 30 minutes).</span></span>

## <a name="device-identifiers-created-at-registration"></a><span data-ttu-id="dca01-127">Identificateurs de périphérique créés lors de l’inscription</span><span class="sxs-lookup"><span data-stu-id="dca01-127">Device Identifiers Created at Registration</span></span>

<span data-ttu-id="dca01-128">Lorsque vous créez un modèle de description de l’appareil, le développeur de l’appareil doit fournir le chemin d’accès de la ressource à la description du service et les icônes associées.</span><span class="sxs-lookup"><span data-stu-id="dca01-128">When creating a device description template, the device developer must provide the resource path to the service description and associated icons.</span></span> <span data-ttu-id="dca01-129">Le chemin d’accès de la ressource est déterminé par l’application de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-129">The resource path is determined by the device application.</span></span>

<span data-ttu-id="dca01-130">Étant donné que le même appareil peut être inscrit plusieurs fois sur le même ordinateur, le UDN spécifié dans le modèle de description de l’appareil n’est pas suffisant pour identifier un appareil de manière unique.</span><span class="sxs-lookup"><span data-stu-id="dca01-130">Since the same device can be registered multiple times on the same computer, the UDN specified in the device description template is not sufficient to uniquely identify a device.</span></span> <span data-ttu-id="dca01-131">Par conséquent, lorsqu’un appareil est inscrit, l’hôte de l’appareil crée un identificateur d’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-131">Therefore, when a device is registered, the device host creates a device identifier.</span></span> <span data-ttu-id="dca01-132">Cet identificateur d’appareil, en association avec le UDN dans le modèle de description de périphérique, peut être utilisé pour identifier un appareil de manière unique.</span><span class="sxs-lookup"><span data-stu-id="dca01-132">This device identifier, in association with the UDN in the device description template, can be used to uniquely identify a device.</span></span>

<span data-ttu-id="dca01-133">Cet identificateur est également utilisé lorsque l’appareil est provisoirement désinscrit puis réinscrit.</span><span class="sxs-lookup"><span data-stu-id="dca01-133">This identifier is also used when the device is temporarily unregistered and then re-registered.</span></span> <span data-ttu-id="dca01-134">Quand un appareil n’est pas inscrit temporairement, l’hôte de l’appareil ne supprime pas le UDN.</span><span class="sxs-lookup"><span data-stu-id="dca01-134">When a device is unregistered temporarily, the device host does not delete the UDN.</span></span> <span data-ttu-id="dca01-135">Les raisons pour lesquelles il n’est pas supprimé UDN sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="dca01-135">Reasons for not deleting the UDN include:</span></span>

-   <span data-ttu-id="dca01-136">L’appareil est en cours de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="dca01-136">The device is being upgraded.</span></span>
-   <span data-ttu-id="dca01-137">Vous modifiez les propriétés de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-137">You are changing the properties of the device.</span></span>
-   <span data-ttu-id="dca01-138">Un service est temporairement indisponible.</span><span class="sxs-lookup"><span data-stu-id="dca01-138">A service is temporarily unavailable.</span></span>
-   <span data-ttu-id="dca01-139">Vous ajoutez un nouveau service à un appareil.</span><span class="sxs-lookup"><span data-stu-id="dca01-139">You are adding a new service to a device.</span></span>
-   <span data-ttu-id="dca01-140">Vous mettez à jour la DLL.</span><span class="sxs-lookup"><span data-stu-id="dca01-140">You are updating the DLL.</span></span>
-   <span data-ttu-id="dca01-141">L’appareil est en mode veille.</span><span class="sxs-lookup"><span data-stu-id="dca01-141">The device is in stand-by mode.</span></span>

<span data-ttu-id="dca01-142">Pour plus d’informations sur l’inscription, reportez-vous aux sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="dca01-142">Refer to the following sections for further information on registration:</span></span>

-   [<span data-ttu-id="dca01-143">Comment inscrire un appareil auprès de l’hôte de l’appareil</span><span class="sxs-lookup"><span data-stu-id="dca01-143">How to Register a Device with the Device Host</span></span>](how-to-register-a-device-with-the-device-host.md)
-   [<span data-ttu-id="dca01-144">Annulation de l’inscription d’un appareil</span><span class="sxs-lookup"><span data-stu-id="dca01-144">Unregistering a Device</span></span>](unregistering-a-device.md)
-   [<span data-ttu-id="dca01-145">**IUPnPRegistrar::UnregisterDevice**</span><span class="sxs-lookup"><span data-stu-id="dca01-145">**IUPnPRegistrar::UnregisterDevice**</span></span>](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-unregisterdevice)
-   [<span data-ttu-id="dca01-146">**IUPnPReregistrar**</span><span class="sxs-lookup"><span data-stu-id="dca01-146">**IUPnPReregistrar**</span></span>](/windows/desktop/api/Upnphost/nn-upnphost-iupnpreregistrar)

 

 




