---
title: Fournisseurs d’appareils
description: Les fournisseurs d’appareils sont des objets inscrits que l’ordinateur démarre à chaque démarrage du système.
ms.assetid: 80c08993-0a8b-4ee9-93cd-bcc3c00e843b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 67fac270342830045fc3bac9f0573f283d87dc6a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104101752"
---
# <a name="device-providers"></a><span data-ttu-id="0d400-103">Fournisseurs d’appareils</span><span class="sxs-lookup"><span data-stu-id="0d400-103">Device Providers</span></span>

<span data-ttu-id="0d400-104">Les fournisseurs d’appareils sont des objets inscrits que l’ordinateur démarre à chaque démarrage du système.</span><span class="sxs-lookup"><span data-stu-id="0d400-104">Device providers are registered objects that the computer starts on every system startup.</span></span> <span data-ttu-id="0d400-105">Les fournisseurs d’appareils enregistrent et annulent l’inscription des appareils en cours d’exécution avec l’hôte d’appareil en réponse à un événement.</span><span class="sxs-lookup"><span data-stu-id="0d400-105">Device providers register and unregister running devices with the device host in response to some event.</span></span> <span data-ttu-id="0d400-106">Ces appareils sont des appareils qui ont été démarrés automatiquement au moment du démarrage du système.</span><span class="sxs-lookup"><span data-stu-id="0d400-106">These devices are devices that have been automatically started at system startup time.</span></span> <span data-ttu-id="0d400-107">Pour des raisons de sécurité, un fournisseur d’appareil doit généralement s’exécuter en tant que [LocalService](/windows/desktop/Services/localservice-account), plutôt que [LocalSystem](/windows/desktop/Services/localsystem-account).</span><span class="sxs-lookup"><span data-stu-id="0d400-107">For security reasons, a device provider should generally run as [LocalService](/windows/desktop/Services/localservice-account), rather than [LocalSystem](/windows/desktop/Services/localsystem-account).</span></span>

<span data-ttu-id="0d400-108">Les fournisseurs de périphériques peuvent être utilisés pour les appareils temporaires.</span><span class="sxs-lookup"><span data-stu-id="0d400-108">Device providers can be used for transient devices.</span></span> <span data-ttu-id="0d400-109">Les fournisseurs d’appareils peuvent également servir à relier des appareils à des médias interrogés.</span><span class="sxs-lookup"><span data-stu-id="0d400-109">Device providers can also be used to bridge devices to polled media.</span></span> <span data-ttu-id="0d400-110">Par exemple, un périphérique périphérique, tel qu’un lecteur de musique numérique, est connecté à un ordinateur par le biais d’un port série.</span><span class="sxs-lookup"><span data-stu-id="0d400-110">For example, a peripheral device such as a digital music player is connected to a computer via a serial port.</span></span> <span data-ttu-id="0d400-111">Pour exposer le lecteur de musique en tant qu’appareil UPnP, un objet de contrôle de périphérique et un ensemble d’objets de service sont requis.</span><span class="sxs-lookup"><span data-stu-id="0d400-111">To expose the music player as a UPnP-based device, a device control object and a set of service objects are required.</span></span> <span data-ttu-id="0d400-112">Ces objets implémentent les actions de lecteur de musique UPnP en tant que commandes en série.</span><span class="sxs-lookup"><span data-stu-id="0d400-112">These objects implement the UPnP-based music player actions as serial commands.</span></span> <span data-ttu-id="0d400-113">Toutefois, le lecteur de musique doit être connecté au port série et disponible pour le contrôle avant l’inscription de ces objets.</span><span class="sxs-lookup"><span data-stu-id="0d400-113">However, the music player must be plugged into the serial port and available for control before these objects are registered.</span></span>

<span data-ttu-id="0d400-114">Étant donné que le port série n’offre pas de mécanisme de notification explicite lorsque des appareils sont connectés, le code d’interrogation est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="0d400-114">Because the serial port does not offer an explicit notification mechanism when devices are connected, polling code is required.</span></span> <span data-ttu-id="0d400-115">Ce code peut être implémenté dans un objet fournisseur d’appareils, un service ou dans une application autonome.</span><span class="sxs-lookup"><span data-stu-id="0d400-115">This code can be implemented in a device provider object, a service, or in a standalone application.</span></span> <span data-ttu-id="0d400-116">Lorsque l’ordinateur est démarré, l’hôte d’appareil instancie l’objet fournisseur de l’appareil, puis appelle sa méthode [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) .</span><span class="sxs-lookup"><span data-stu-id="0d400-116">When the computer is started, the device host instantiates the device provider object, and then invokes its [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) method.</span></span> <span data-ttu-id="0d400-117">Lorsque le fournisseur de l’appareil détecte la présence d’un périphérique de lecteur de musique, il instancie l’objet de contrôle d’appareil approprié et l’inscrit en appelant [**IUPnPRegistrar :: RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice).</span><span class="sxs-lookup"><span data-stu-id="0d400-117">When the device provider detects the presence of a music player device, it instantiates the appropriate device control object and registers it by calling [**IUPnPRegistrar::RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice).</span></span> <span data-ttu-id="0d400-118">Cette méthode publie l’appareil et l’annonce au réseau UPnP.</span><span class="sxs-lookup"><span data-stu-id="0d400-118">This method publishes the device and announces it to the UPnP-based network.</span></span>

<span data-ttu-id="0d400-119">La même fonctionnalité peut également être obtenue en implémentant un service qui interroge le port série.</span><span class="sxs-lookup"><span data-stu-id="0d400-119">The same functionality can also be achieved by implementing a service that polls the serial port.</span></span> <span data-ttu-id="0d400-120">Toutefois, les fournisseurs d’appareils simplifient les choses en exigeant uniquement les fonctionnalités principales (l’interrogation) à implémenter, car les fournisseurs d’appareils s’appuient sur l’hôte de l’appareil pour les démarrer et les arrêter.</span><span class="sxs-lookup"><span data-stu-id="0d400-120">However, device providers simplify things by requiring only the core functionality—the polling—to be implemented because device providers rely on the device host to start and stop them.</span></span> <span data-ttu-id="0d400-121">L’utilisation de fournisseurs de périphériques est plus simple que l’implémentation d’un service.</span><span class="sxs-lookup"><span data-stu-id="0d400-121">Using device providers is simpler than implementing a service.</span></span>

<span data-ttu-id="0d400-122">Au moment de l’inscription, et à chaque démarrage suivant du système, l’ordinateur instancie l’objet fournisseur de l’appareil, puis appelle sa méthode [**IUPnPDeviceProvider :: Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) , en lui transmettant la chaîne d’initialisation spécifiée lors de l’inscription.</span><span class="sxs-lookup"><span data-stu-id="0d400-122">At registration time, and on every subsequent system startup, the computer instantiates the device provider object, and then invokes its [**IUPnPDeviceProvider::Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) method, passing it the initialization string specified during registration.</span></span>

<span data-ttu-id="0d400-123">Une fois la méthode [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) appelée, le fournisseur de l’appareil effectue le traitement nécessaire et, le cas échéant, le fournisseur de l’appareil inscrit les appareils en appelant [**IUPnPRegistrar :: RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), comme décrit dans la section [inscription d’un appareil hébergé auprès de l’hôte de l’appareil](registering-a-hosted-device-with-the-device-host.md).</span><span class="sxs-lookup"><span data-stu-id="0d400-123">Once the [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) method is called, the device provider performs any necessary processing, and when necessary, the device provider registers devices by calling [**IUPnPRegistrar::RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), as described in the section [Registering a Hosted Device with the Device Host](registering-a-hosted-device-with-the-device-host.md).</span></span>

<span data-ttu-id="0d400-124">Lorsque l’ordinateur est arrêté, l’hôte de l’appareil appelle la méthode [**IUPnPDeviceProvider :: Stop**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-stop) pour indiquer que le fournisseur de l’appareil a terminé ses opérations.</span><span class="sxs-lookup"><span data-stu-id="0d400-124">When the computer is shut down, the device host invokes the [**IUPnPDeviceProvider::Stop**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-stop) method to indicate that the device provider terminate its operations.</span></span>

 

 