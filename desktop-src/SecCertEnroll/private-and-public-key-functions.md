---
description: Implémente les interfaces IX509PrivateKey et IX509PublicKey.
ms.assetid: 1358053e-ed4e-4482-b160-5b9b1024c771
title: Fonctions de clés privées et publiques
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e2c1d8ec481c87337e7d7e56cffee47f1f483b84
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106520588"
---
# <a name="private-and-public-key-functions"></a><span data-ttu-id="8cdab-103">Fonctions de clés privées et publiques</span><span class="sxs-lookup"><span data-stu-id="8cdab-103">Private and Public Key Functions</span></span>

<span data-ttu-id="8cdab-104">CertEnroll.dll implémente les interfaces [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) et [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) .</span><span class="sxs-lookup"><span data-stu-id="8cdab-104">CertEnroll.dll implements the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) and [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) interfaces.</span></span> <span data-ttu-id="8cdab-105">Vous pouvez, par exemple, utiliser l’interface [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) pour effectuer les actions suivantes sur une [*clé privée*](/windows/desktop/SecGloss/p-gly):</span><span class="sxs-lookup"><span data-stu-id="8cdab-105">You can, for example, use the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) interface to perform the following actions on a [*private key*](/windows/desktop/SecGloss/p-gly):</span></span>

-   <span data-ttu-id="8cdab-106">Créer, ouvrir, fermer, importer, exporter et supprimer la clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-106">Create, open, close, import, export, and delete the key.</span></span>
-   <span data-ttu-id="8cdab-107">Spécifiez ou récupérez l' [*algorithme de clé publique*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="8cdab-107">Specify or retrieve the [*public key algorithm*](/windows/desktop/SecGloss/p-gly).</span></span>
-   <span data-ttu-id="8cdab-108">Spécifiez ou récupérez des informations sur le [*fournisseur de services de chiffrement*](/windows/desktop/SecGloss/c-gly) (CSP) disponible qui prend en charge l’algorithme de clé publique.</span><span class="sxs-lookup"><span data-stu-id="8cdab-108">Specify or retrieve information about the available [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP) that support the public key algorithm.</span></span>
-   <span data-ttu-id="8cdab-109">Spécifiez ou récupérez le [*certificat*](/windows/desktop/SecGloss/c-gly) associé à la [*clé privée*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="8cdab-109">Specify or retrieve the [*certificate*](/windows/desktop/SecGloss/c-gly) associated with the [*private key*](/windows/desktop/SecGloss/p-gly).</span></span>
-   <span data-ttu-id="8cdab-110">Spécifiez ou récupérez le nom du [*conteneur de clé*](/windows/desktop/SecGloss/k-gly).</span><span class="sxs-lookup"><span data-stu-id="8cdab-110">Specify or retrieve the name of the [*key container*](/windows/desktop/SecGloss/k-gly).</span></span>
-   <span data-ttu-id="8cdab-111">Spécifiez ou récupérez une description de et un nom d’affichage pour la clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-111">Specify or retrieve a description of and a display name for the key.</span></span>
-   <span data-ttu-id="8cdab-112">Spécifiez ou récupérez les contraintes d’exportation sur une clé privée.</span><span class="sxs-lookup"><span data-stu-id="8cdab-112">Specify or retrieve the export constraints places on a private key.</span></span>
-   <span data-ttu-id="8cdab-113">Spécifiez ou récupérez une valeur booléenne qui indique si la clé existe.</span><span class="sxs-lookup"><span data-stu-id="8cdab-113">Specify or retrieve a Boolean value that indicates whether the key exists.</span></span>
-   <span data-ttu-id="8cdab-114">Spécifiez ou récupérez une valeur qui indique comment la clé est protégée avant son utilisation.</span><span class="sxs-lookup"><span data-stu-id="8cdab-114">Specify or retrieve a value that indicates how the key is protected before use.</span></span>
-   <span data-ttu-id="8cdab-115">Spécifiez ou récupérez une valeur qui indique si la clé peut être utilisée pour la signature, le chiffrement, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="8cdab-115">Specify or retrieve a value that indicates whether the key can be used for signing, encryption, or both.</span></span>
-   <span data-ttu-id="8cdab-116">Spécifiez ou récupérez une valeur qui identifie l’objectif spécifique pour lequel la clé peut être utilisée.</span><span class="sxs-lookup"><span data-stu-id="8cdab-116">Specify or retrieve a value that identifies the specific purpose for which the key can be used.</span></span>
-   <span data-ttu-id="8cdab-117">Spécifiez ou récupérez la longueur de la clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-117">Specify or retrieve the length of the key.</span></span>
-   <span data-ttu-id="8cdab-118">Spécifiez ou récupérez une valeur qui indique si la clé est utilisée ou enregistrée dans le contexte d’un ordinateur ou d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8cdab-118">Specify or retrieve a value that indicates whether the key is used or saved in the context of a computer or user.</span></span>
-   <span data-ttu-id="8cdab-119">Récupérez une valeur booléenne qui spécifie si la clé a été ouverte.</span><span class="sxs-lookup"><span data-stu-id="8cdab-119">Retrieve a Boolean value that specifies whether the key has been opened.</span></span>
-   <span data-ttu-id="8cdab-120">Spécifiez un numéro d’identification personnel pour accéder à une clé privée sur une [*carte à puce*](/windows/desktop/SecGloss/s-gly).</span><span class="sxs-lookup"><span data-stu-id="8cdab-120">Specify a personal identification number to access a private key on a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>
-   <span data-ttu-id="8cdab-121">Spécifiez ou récupérez le nom du fournisseur de services de chiffrement associé à la clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-121">Specify or retrieve the name of the CSP associated with the key.</span></span>
-   <span data-ttu-id="8cdab-122">Spécifiez ou récupérez le [*descripteur de sécurité*](/windows/desktop/SecGloss/s-gly) pour la clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-122">Specify or retrieve the [*security descriptor*](/windows/desktop/SecGloss/s-gly) for the key.</span></span>

<span data-ttu-id="8cdab-123">Chacune des sections suivantes identifie une fonction exportée par Xenroll.dll qui peut être utilisée pour gérer une [*clé de chiffrement*](/windows/desktop/SecGloss/c-gly).</span><span class="sxs-lookup"><span data-stu-id="8cdab-123">Each of the following sections identifies a function exported by Xenroll.dll that can be used to manage a [*cryptographic key*](/windows/desktop/SecGloss/c-gly).</span></span> <span data-ttu-id="8cdab-124">Chaque rubrique explique également comment utiliser CertEnroll.dll pour remplacer la fonction ou indique qu’il n’existe aucun mappage entre les deux bibliothèques :</span><span class="sxs-lookup"><span data-stu-id="8cdab-124">Each topic also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="8cdab-125">ContainerNameWStr</span><span class="sxs-lookup"><span data-stu-id="8cdab-125">ContainerNameWStr</span></span>](#containernamewstr)
-   [<span data-ttu-id="8cdab-126">GenKeyFlags</span><span class="sxs-lookup"><span data-stu-id="8cdab-126">GenKeyFlags</span></span>](#genkeyflags)
-   [<span data-ttu-id="8cdab-127">GetKeyLen</span><span class="sxs-lookup"><span data-stu-id="8cdab-127">GetKeyLen</span></span>](#getkeylenex)
-   [<span data-ttu-id="8cdab-128">GetKeyLenEx</span><span class="sxs-lookup"><span data-stu-id="8cdab-128">GetKeyLenEx</span></span>](#getkeylenex)
-   [<span data-ttu-id="8cdab-129">GetSupportedKeySpec</span><span class="sxs-lookup"><span data-stu-id="8cdab-129">GetSupportedKeySpec</span></span>](#getsupportedkeyspec)
-   [<span data-ttu-id="8cdab-130">KeySpec</span><span class="sxs-lookup"><span data-stu-id="8cdab-130">KeySpec</span></span>](#getsupportedkeyspec)
-   [<span data-ttu-id="8cdab-131">LimitExchangeKeyToEncipherment</span><span class="sxs-lookup"><span data-stu-id="8cdab-131">LimitExchangeKeyToEncipherment</span></span>](#limitexchangekeytoencipherment)
-   [<span data-ttu-id="8cdab-132">PVKFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="8cdab-132">PVKFileNameWStr</span></span>](#pvkfilenamewstr)
-   [<span data-ttu-id="8cdab-133">ReuseHardwareKeyIfUnableToGenNew</span><span class="sxs-lookup"><span data-stu-id="8cdab-133">ReuseHardwareKeyIfUnableToGenNew</span></span>](#reusehardwarekeyifunabletogennew)
-   [<span data-ttu-id="8cdab-134">UseExistingKeySet</span><span class="sxs-lookup"><span data-stu-id="8cdab-134">UseExistingKeySet</span></span>](#useexistingkeyset)
-   [<span data-ttu-id="8cdab-135">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8cdab-135">Related topics</span></span>](#related-topics)

## <a name="containernamewstr"></a><span data-ttu-id="8cdab-136">ContainerNameWStr</span><span class="sxs-lookup"><span data-stu-id="8cdab-136">ContainerNameWStr</span></span>

<span data-ttu-id="8cdab-137">La fonction [**ContainerNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_containernamewstr) dans Xenroll.dll spécifie ou récupère le nom du [*conteneur de clé*](/windows/desktop/SecGloss/k-gly).</span><span class="sxs-lookup"><span data-stu-id="8cdab-137">The [**ContainerNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_containernamewstr) function in Xenroll.dll specifies or retrieves the name of the [*key container*](/windows/desktop/SecGloss/k-gly).</span></span>

<span data-ttu-id="8cdab-138">Lorsque vous utilisez CertEnroll.dll, vous pouvez effectuer les actions suivantes pour récupérer le nom d’un conteneur de clé :</span><span class="sxs-lookup"><span data-stu-id="8cdab-138">When using CertEnroll.dll, you can perform the following actions to retrieve the name of a key container:</span></span>

1.  <span data-ttu-id="8cdab-139">Appelez la propriété [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) sur un objet [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) existant.</span><span class="sxs-lookup"><span data-stu-id="8cdab-139">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="8cdab-140">Appelez la méthode [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) sur la requête retournée à l’étape 1 pour récupérer la requête la plus profonde.</span><span class="sxs-lookup"><span data-stu-id="8cdab-140">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="8cdab-141">Appelez **QueryInterface** sur l’objet [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) retourné à l’étape 2 pour effectuer un cast en un objet [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) .</span><span class="sxs-lookup"><span data-stu-id="8cdab-141">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="8cdab-142">Appelez la propriété [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) sur la \# demande PKCS 10.</span><span class="sxs-lookup"><span data-stu-id="8cdab-142">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="8cdab-143">Appelez la propriété [**containerName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_containername) sur l’objet [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) récupéré à partir de l’étape 4.</span><span class="sxs-lookup"><span data-stu-id="8cdab-143">Call the [**ContainerName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_containername) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object retrieved from step 4.</span></span>

## <a name="genkeyflags"></a><span data-ttu-id="8cdab-144">GenKeyFlags</span><span class="sxs-lookup"><span data-stu-id="8cdab-144">GenKeyFlags</span></span>

<span data-ttu-id="8cdab-145">La fonction [**GenKeyFlags**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_genkeyflags) définie dans Xenroll.dll spécifie ou récupère les indicateurs utilisés pour générer une clé privée ou une [*paire de clés publique/privée*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="8cdab-145">The [**GenKeyFlags**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_genkeyflags) function defined in Xenroll.dll specifies or retrieves flags used to generate a private key or [*public/private key pair*](/windows/desktop/SecGloss/p-gly).</span></span>

<span data-ttu-id="8cdab-146">Lorsque vous utilisez CertEnroll.dll, vous pouvez spécifier un certain nombre de propriétés différentes qui détermineront la façon dont une clé privée sera créée.</span><span class="sxs-lookup"><span data-stu-id="8cdab-146">When using CertEnroll.dll, you can specify a number of different properties that will determine how a private key is created.</span></span> <span data-ttu-id="8cdab-147">Pour plus d’informations, consultez [**créer**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-create).</span><span class="sxs-lookup"><span data-stu-id="8cdab-147">For more information, see [**Create**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-create).</span></span>

## <a name="getkeylen"></a><span data-ttu-id="8cdab-148">GetKeyLen</span><span class="sxs-lookup"><span data-stu-id="8cdab-148">GetKeyLen</span></span>

<span data-ttu-id="8cdab-149">La fonction [**GetKeyLen**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getkeylen) définie dans Xenroll.dll récupère la taille de clé maximale ou minimale d’une clé de chiffrement.</span><span class="sxs-lookup"><span data-stu-id="8cdab-149">The [**GetKeyLen**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getkeylen) function defined in Xenroll.dll retrieves the maximum or minimum key size of an encryption key.</span></span>

<span data-ttu-id="8cdab-150">Lorsque vous utilisez CertEnroll.dll, vous pouvez appeler la propriété [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) sur un objet [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) ou [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) pour récupérer la taille de la clé, en bits.</span><span class="sxs-lookup"><span data-stu-id="8cdab-150">When using CertEnroll.dll, you can call the [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) object to retrieve the key size, in bits.</span></span>

## <a name="getkeylenex"></a><span data-ttu-id="8cdab-151">GetKeyLenEx</span><span class="sxs-lookup"><span data-stu-id="8cdab-151">GetKeyLenEx</span></span>

<span data-ttu-id="8cdab-152">La fonction [**GetKeyLenEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getkeylenex) définie dans Xenroll.dll récupère la taille de clé maximale ou minimale ou la longueur d’incrément d’une clé de chiffrement.</span><span class="sxs-lookup"><span data-stu-id="8cdab-152">The [**GetKeyLenEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getkeylenex) function defined in Xenroll.dll retrieves the maximum or minimum key size or the increment length of an encryption key.</span></span>

<span data-ttu-id="8cdab-153">Lorsque vous utilisez CertEnroll.dll, vous pouvez appeler la propriété [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) sur un objet [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) ou [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) pour récupérer la taille de la clé, en bits.</span><span class="sxs-lookup"><span data-stu-id="8cdab-153">When using CertEnroll.dll, you can call the [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) object to retrieve the key size, in bits.</span></span> <span data-ttu-id="8cdab-154">Si un algorithme prend en charge des longueurs de clé incrémentielles, vous pouvez appeler la propriété [**IncrementLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_incrementlength) sur l’objet [**ICspAlgorithm**](/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithm) pour récupérer la valeur d’incrémentation.</span><span class="sxs-lookup"><span data-stu-id="8cdab-154">If an algorithm supports incremental key lengths, you can call the [**IncrementLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_incrementlength) property on the [**ICspAlgorithm**](/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithm) object to retrieve the increment value.</span></span> <span data-ttu-id="8cdab-155">Vous pouvez également appeler les propriétés [**minLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_minlength) et [**MaxLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_maxlength) pour récupérer les tailles de clé minimale et maximale.</span><span class="sxs-lookup"><span data-stu-id="8cdab-155">You can also call the [**MinLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_minlength) and [**MaxLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_maxlength) properties to retrieve the minimum and maximum key sizes.</span></span>

## <a name="getsupportedkeyspec"></a><span data-ttu-id="8cdab-156">GetSupportedKeySpec</span><span class="sxs-lookup"><span data-stu-id="8cdab-156">GetSupportedKeySpec</span></span>

<span data-ttu-id="8cdab-157">La fonction [**GetSupportedKeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getsupportedkeyspec) définie dans Xenroll.dll récupère une valeur qui indique si un fournisseur de services de chiffrement prend en charge les clés d’échange, les clés de signature ou les deux.</span><span class="sxs-lookup"><span data-stu-id="8cdab-157">The [**GetSupportedKeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getsupportedkeyspec) function defined in Xenroll.dll retrieves a value that indicates whether a CSP supports exchange keys, signing keys, or both.</span></span>

<span data-ttu-id="8cdab-158">Lorsque vous utilisez CertEnroll.dll, vous pouvez appeler la propriété [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) sur les objets [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) ou [**ICspInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation) pour récupérer les opérations prises en charge par la clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-158">When using CertEnroll.dll, you can call the [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**ICspInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation) objects to retrieve the operations supported by the key.</span></span>

## <a name="keyspec"></a><span data-ttu-id="8cdab-159">KeySpec</span><span class="sxs-lookup"><span data-stu-id="8cdab-159">KeySpec</span></span>

<span data-ttu-id="8cdab-160">La fonction [**KeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_keyspec) définie dans Xenroll.dll spécifie ou récupère le type de clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-160">The [**KeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_keyspec) function defined in Xenroll.dll specifies or retrieves the key type.</span></span>

<span data-ttu-id="8cdab-161">Lorsque vous utilisez CertEnroll.dll, vous pouvez appeler la propriété [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) sur un objet [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) pour récupérer les opérations prises en charge par la clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-161">When using CertEnroll.dll, you can call the [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object to retrieve the operations supported by the key.</span></span>

## <a name="limitexchangekeytoencipherment"></a><span data-ttu-id="8cdab-162">LimitExchangeKeyToEncipherment</span><span class="sxs-lookup"><span data-stu-id="8cdab-162">LimitExchangeKeyToEncipherment</span></span>

<span data-ttu-id="8cdab-163">La fonction [**LimitExchangeKeyToEncipherment**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_limitexchangekeytoencipherment) définie dans Xenroll.dll spécifie ou récupère une valeur booléenne qui indique si une clé de chiffrement peut être utilisée uniquement pour les données ou le chiffrement de clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-163">The [**LimitExchangeKeyToEncipherment**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_limitexchangekeytoencipherment) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether an encryption key can be used only for data or key encipherment.</span></span>

<span data-ttu-id="8cdab-164">CertEnroll.dll ne contient pas d’équivalent direct pour cette fonction.</span><span class="sxs-lookup"><span data-stu-id="8cdab-164">CertEnroll.dll does not contain a direct equivalent for this function.</span></span> <span data-ttu-id="8cdab-165">Toutefois, vous pouvez obtenir un résultat quasiment équivalent en spécifiant un objet [**IX509ExtensionKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage) et en l’ajoutant à la demande de certificat.</span><span class="sxs-lookup"><span data-stu-id="8cdab-165">You can, however, achieve a nearly equivalent result by specifying an [**IX509ExtensionKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage) object and adding it to the certificate request.</span></span>

## <a name="pvkfilenamewstr"></a><span data-ttu-id="8cdab-166">PVKFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="8cdab-166">PVKFileNameWStr</span></span>

<span data-ttu-id="8cdab-167">La fonction [**PVKFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_pvkfilenamewstr) définie dans Xenroll.dll spécifie ou récupère le nom d’un fichier qui contient des clés exportées.</span><span class="sxs-lookup"><span data-stu-id="8cdab-167">The [**PVKFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_pvkfilenamewstr) function defined in Xenroll.dll specifies or retrieves the name of a file that contains exported keys.</span></span>

<span data-ttu-id="8cdab-168">Quand vous utilisez CertEnroll.dll, vous pouvez appeler la méthode [**Export**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-export) sur un objet [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) pour exporter une clé vers un **BSTR**.</span><span class="sxs-lookup"><span data-stu-id="8cdab-168">When using CertEnroll.dll, you can call the [**Export**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-export) method on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object to export a key to a **BSTR**.</span></span> <span data-ttu-id="8cdab-169">Vous pouvez appeler la méthode [**ExportPublicKey**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-exportpublickey) pour exporter la partie [*clé publique*](/windows/desktop/SecGloss/p-gly) d’une paire de clés asymétriques.</span><span class="sxs-lookup"><span data-stu-id="8cdab-169">You can call the [**ExportPublicKey**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-exportpublickey) method to export the [*public key*](/windows/desktop/SecGloss/p-gly) portion of an asymmetric key pair.</span></span>

## <a name="reusehardwarekeyifunabletogennew"></a><span data-ttu-id="8cdab-170">ReuseHardwareKeyIfUnableToGenNew</span><span class="sxs-lookup"><span data-stu-id="8cdab-170">ReuseHardwareKeyIfUnableToGenNew</span></span>

<span data-ttu-id="8cdab-171">La fonction [**ReuseHardwareKeyIfUnableToGenNew**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_reusehardwarekeyifunabletogennew) définie dans Xenroll.dll spécifie ou récupère une valeur booléenne qui indique si une clé existante est réutilisée lorsqu’une erreur se produit lors de la génération d’une nouvelle clé.</span><span class="sxs-lookup"><span data-stu-id="8cdab-171">The [**ReuseHardwareKeyIfUnableToGenNew**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_reusehardwarekeyifunabletogennew) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether an existing key is reused when an error is encountered when generating a new key.</span></span>

<span data-ttu-id="8cdab-172">Quand vous utilisez CertEnroll.dll, vous pouvez appeler la méthode [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) sur un objet [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) et spécifier une valeur du type d’énumération [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) pour réutiliser une clé privée existante.</span><span class="sxs-lookup"><span data-stu-id="8cdab-172">When using CertEnroll.dll, you can call the [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) method on an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object and specify a value of the [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) enumeration type to reuse an existing private key.</span></span>

## <a name="useexistingkeyset"></a><span data-ttu-id="8cdab-173">UseExistingKeySet</span><span class="sxs-lookup"><span data-stu-id="8cdab-173">UseExistingKeySet</span></span>

<span data-ttu-id="8cdab-174">La fonction [**UseExistingKeySet**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_useexistingkeyset) définie dans Xenroll.dll spécifie ou récupère une valeur booléenne qui indique s’il faut utiliser des clés existantes.</span><span class="sxs-lookup"><span data-stu-id="8cdab-174">The [**UseExistingKeySet**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_useexistingkeyset) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to use existing keys.</span></span>

<span data-ttu-id="8cdab-175">Lorsque vous utilisez CertEnroll.dll, vous pouvez appeler la méthode [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) sur un objet [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) et spécifier une valeur du type d’énumération [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) pour réutiliser les clés privées et publiques existantes.</span><span class="sxs-lookup"><span data-stu-id="8cdab-175">When using CertEnroll.dll, you can call the [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) method on an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object and specify a value of the [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) enumeration type to reuse existing private and public keys.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8cdab-176">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8cdab-176">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8cdab-177">Mappage de Xenroll.dll à CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="8cdab-177">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> </dl>

 

 
