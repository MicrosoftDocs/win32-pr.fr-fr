---
description: Implémente l’interface IX509Enrollment.
ms.assetid: bcf5c2f0-b99f-4de5-83f4-44f17dc31cd4
title: Fonctions de réponse de certificat
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15eec71d0493fa4961988b86db0397d0fd516508
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106534623"
---
# <a name="certificate-response-functions"></a><span data-ttu-id="24bd8-103">Fonctions de réponse de certificat</span><span class="sxs-lookup"><span data-stu-id="24bd8-103">Certificate Response Functions</span></span>

<span data-ttu-id="24bd8-104">CertEnroll.dll implémente l’interface [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) pour envoyer une demande de certificat client et installer la réponse à partir d’une [*autorité de certification*](/windows/desktop/SecGloss/c-gly) (ca).</span><span class="sxs-lookup"><span data-stu-id="24bd8-104">CertEnroll.dll implements the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) interface to submit a client certificate request and install the response from a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA).</span></span>

<span data-ttu-id="24bd8-105">Le processus d’inscription peut prendre en charge les trois scénarios suivants :</span><span class="sxs-lookup"><span data-stu-id="24bd8-105">The enrollment process can accommodate the following three scenarios:</span></span>

<dl> <span data-ttu-id="24bd8-106">Inscription hors-bande</span><span class="sxs-lookup"><span data-stu-id="24bd8-106">Out-of-band enrollment</span></span>

1.  <span data-ttu-id="24bd8-107">Appelez une méthode d’initialisation implémentée par l’objet [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="24bd8-107">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="24bd8-108">Appelez la méthode [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) pour récupérer la requête.</span><span class="sxs-lookup"><span data-stu-id="24bd8-108">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="24bd8-109">Envoyez la demande hors bande (manuellement ou à l’aide d’un autre processus).</span><span class="sxs-lookup"><span data-stu-id="24bd8-109">Submit the request out of band (manually or by using some other process).</span></span>
4.  <span data-ttu-id="24bd8-110">Recevoir la réponse d’une autorité de certification.</span><span class="sxs-lookup"><span data-stu-id="24bd8-110">Receive the response from a CA.</span></span>
5.  <span data-ttu-id="24bd8-111">Appelez la méthode [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="24bd8-111">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

  
<span data-ttu-id="24bd8-112">Inscription automatique</span><span class="sxs-lookup"><span data-stu-id="24bd8-112">Automatic enrollment</span></span>

1.  <span data-ttu-id="24bd8-113">Appelez une méthode d’initialisation implémentée par l’objet [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="24bd8-113">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="24bd8-114">Appelez la méthode d' [**inscription**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) .</span><span class="sxs-lookup"><span data-stu-id="24bd8-114">Call the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method.</span></span>

  
<span data-ttu-id="24bd8-115">Inscription différée</span><span class="sxs-lookup"><span data-stu-id="24bd8-115">Delayed enrollment</span></span>

1.  <span data-ttu-id="24bd8-116">Appelez une méthode d’initialisation implémentée par l’objet [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="24bd8-116">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="24bd8-117">Appelez la méthode [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) pour récupérer la requête.</span><span class="sxs-lookup"><span data-stu-id="24bd8-117">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="24bd8-118">Stockez la demande jusqu’à ce que vous soyez prêt à la soumettre.</span><span class="sxs-lookup"><span data-stu-id="24bd8-118">Store the request until you are ready to submit it.</span></span>
4.  <span data-ttu-id="24bd8-119">Lorsque vous êtes prêt à procéder à l’inscription, appelez la méthode [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) pour réinitialiser l’objet d’inscription.</span><span class="sxs-lookup"><span data-stu-id="24bd8-119">When you are ready to enroll, call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) method to reinitialize the enrollment object.</span></span>
5.  <span data-ttu-id="24bd8-120">Appelez la méthode [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) lorsque l’autorité de certification retourne un certificat.</span><span class="sxs-lookup"><span data-stu-id="24bd8-120">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method when the CA returns a certificate.</span></span>

  
</dl>

<span data-ttu-id="24bd8-121">Pendant le processus d’inscription, vous pouvez appeler la propriété [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) sur l’objet [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) pour récupérer une valeur d’énumération [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) qui identifie si l’inscription a réussi, si elle est en attente, si elle a été ignorée, a généré une erreur ou si a été refusé.</span><span class="sxs-lookup"><span data-stu-id="24bd8-121">During the enrollment process, you can call the [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve an [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) enumeration value that identifies whether enrollment succeeded, is pending, was skipped, generated an error, or was denied.</span></span>

<span data-ttu-id="24bd8-122">Chacune des sections suivantes identifie une fonction exportée par Xenroll.dll pour installer une réponse de certificat à partir d’une autorité de certification.</span><span class="sxs-lookup"><span data-stu-id="24bd8-122">Each of the following sections identifies a function exported by Xenroll.dll to install a certificate response from a CA.</span></span> <span data-ttu-id="24bd8-123">Chaque section explique également comment utiliser CertEnroll.dll pour remplacer la fonction ou indique qu’il n’existe aucun mappage entre les deux bibliothèques :</span><span class="sxs-lookup"><span data-stu-id="24bd8-123">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="24bd8-124">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="24bd8-124">acceptFilePKCS7WStr</span></span>](#acceptfilepkcs7wstr)
-   [<span data-ttu-id="24bd8-125">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="24bd8-125">acceptFileResponseWStr</span></span>](#acceptfileresponsewstr)
-   [<span data-ttu-id="24bd8-126">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="24bd8-126">acceptPKCS7Blob</span></span>](#acceptpkcs7blob)
-   [<span data-ttu-id="24bd8-127">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="24bd8-127">acceptResponseBlob</span></span>](#acceptresponseblob)
-   [<span data-ttu-id="24bd8-128">getCertContextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="24bd8-128">getCertContextFromFileResponseWStr</span></span>](#getcertcontextfromfileresponsewstr)
-   [<span data-ttu-id="24bd8-129">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="24bd8-129">getCertContextFromPKCS7</span></span>](#getcertcontextfrompkcs7)
-   [<span data-ttu-id="24bd8-130">getCertContextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="24bd8-130">getCertContextFromResponseBlob</span></span>](#getcertcontextfromresponseblob)
-   [<span data-ttu-id="24bd8-131">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="24bd8-131">InstallPKCS7Blob</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="24bd8-132">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="24bd8-132">InstallPKCS7BlobEx</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="24bd8-133">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="24bd8-133">SPCFileNameWStr</span></span>](#spcfilenamewstr)
-   [<span data-ttu-id="24bd8-134">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="24bd8-134">WriteCertToCSP</span></span>](#writecerttocsp)
-   [<span data-ttu-id="24bd8-135">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="24bd8-135">WriteCertToUserDS</span></span>](#writecerttouserds)
-   [<span data-ttu-id="24bd8-136">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="24bd8-136">Related topics</span></span>](#related-topics)

## <a name="acceptfilepkcs7wstr"></a><span data-ttu-id="24bd8-137">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="24bd8-137">acceptFilePKCS7WStr</span></span>

<span data-ttu-id="24bd8-138">La fonction [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) dans Xenroll.dll installe une réponse [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) à partir d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="24bd8-138">The [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) function in Xenroll.dll installs a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) response from a file.</span></span>

<span data-ttu-id="24bd8-139">La bibliothèque CertEnroll.dll n’implémente pas directement les fonctionnalités pour installer une \# réponse de certificat PKCS 7 à partir d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="24bd8-139">The CertEnroll.dll library does not directly implement functionality to install a PKCS \#7 certificate response from a file.</span></span> <span data-ttu-id="24bd8-140">Toutefois, vous pouvez créer une fonction personnalisée pour lire les données de fichier dans un tableau d’octets et appeler [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) pour installer la réponse.</span><span class="sxs-lookup"><span data-stu-id="24bd8-140">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the response.</span></span>

<span data-ttu-id="24bd8-141">Si vous spécifiez la valeur **AllowNoOutstandingRequest** de l’énumération [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) pour le premier paramètre de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), un certificat fictif n’a pas besoin d’exister, ce qui vous permet d’installer un certificat sans appeler d’abord [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="24bd8-141">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="24bd8-142">Toutefois, si vous installez un certificat à l’aide d’un script Web, un certificat factice doit exister dans le magasin de demandes.</span><span class="sxs-lookup"><span data-stu-id="24bd8-142">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="24bd8-143">Vous devez donc spécifier **AllowNone** pour le premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="24bd8-143">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptfileresponsewstr"></a><span data-ttu-id="24bd8-144">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="24bd8-144">acceptFileResponseWStr</span></span>

<span data-ttu-id="24bd8-145">La fonction [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) dans Xenroll.dll installe une \# réponse de certificat PKCS 7 ou CMC à partir d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="24bd8-145">The [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response from a file.</span></span>

<span data-ttu-id="24bd8-146">La bibliothèque CertEnroll.dll n’implémente pas directement les fonctionnalités pour installer une réponse de certificat à partir d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="24bd8-146">The CertEnroll.dll library does not directly implement functionality to install a certificate response from a file.</span></span> <span data-ttu-id="24bd8-147">Toutefois, vous pouvez créer une fonction personnalisée pour lire les données de fichier dans un tableau d’octets et appeler [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) pour installer la \# réponse PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="24bd8-147">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="24bd8-148">Si vous spécifiez la valeur **AllowNoOutstandingRequest** de l’énumération [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) pour le premier paramètre de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), un certificat fictif n’a pas besoin d’exister, ce qui vous permet d’installer un certificat sans appeler d’abord [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="24bd8-148">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="24bd8-149">Toutefois, si vous installez un certificat à l’aide d’un script Web, un certificat factice doit exister dans le magasin de demandes.</span><span class="sxs-lookup"><span data-stu-id="24bd8-149">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="24bd8-150">Vous devez donc spécifier **AllowNone** pour le premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="24bd8-150">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptpkcs7blob"></a><span data-ttu-id="24bd8-151">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="24bd8-151">acceptPKCS7Blob</span></span>

<span data-ttu-id="24bd8-152">La fonction [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) dans Xenroll.dll installe une \# réponse PKCS 7 contenue dans un tableau d’octets.</span><span class="sxs-lookup"><span data-stu-id="24bd8-152">The [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response contained in a byte array.</span></span>

<span data-ttu-id="24bd8-153">Vous pouvez appeler [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) pour installer un \# message PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="24bd8-153">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 message.</span></span> <span data-ttu-id="24bd8-154">Si vous spécifiez la valeur **AllowNoOutstandingRequest** de l’énumération [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) pour le premier paramètre de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), un certificat fictif n’a pas besoin d’exister, ce qui vous permet d’installer la \# réponse PKCS 7 sans appeler d’abord [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="24bd8-154">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the PKCS \#7 response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="24bd8-155">Toutefois, si vous installez un certificat à l’aide d’un script Web, un certificat factice doit exister dans le magasin de demandes.</span><span class="sxs-lookup"><span data-stu-id="24bd8-155">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="24bd8-156">Vous devez donc spécifier **AllowNone** pour le premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="24bd8-156">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptresponseblob"></a><span data-ttu-id="24bd8-157">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="24bd8-157">acceptResponseBlob</span></span>

<span data-ttu-id="24bd8-158">La fonction [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) dans Xenroll.dll installe une \# réponse de certificat PKCS 7 ou CMC contenue dans un tableau d’octets.</span><span class="sxs-lookup"><span data-stu-id="24bd8-158">The [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response contained in a byte array.</span></span>

<span data-ttu-id="24bd8-159">Vous pouvez appeler [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) pour installer une \# réponse PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="24bd8-159">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="24bd8-160">Si vous spécifiez la valeur **AllowNoOutstandingRequest** de l’énumération [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) pour le premier paramètre de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), un certificat factice n’a pas besoin d’exister, ce qui vous permet d’installer la réponse sans appeler d’abord [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="24bd8-160">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="24bd8-161">Toutefois, si vous installez un certificat à l’aide d’un script Web, un certificat factice doit exister dans le magasin de demandes.</span><span class="sxs-lookup"><span data-stu-id="24bd8-161">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="24bd8-162">Vous devez donc spécifier **AllowNone** pour le premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="24bd8-162">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfromfileresponsewstr"></a><span data-ttu-id="24bd8-163">getCertContextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="24bd8-163">getCertContextFromFileResponseWStr</span></span>

<span data-ttu-id="24bd8-164">La fonction [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) dans Xenroll.dll récupère le certificat client à partir d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="24bd8-164">The [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) function in Xenroll.dll retrieves the client certificate from a file.</span></span>

<span data-ttu-id="24bd8-165">La bibliothèque CertEnroll.dll n’implémente pas directement les fonctionnalités permettant de récupérer un certificat à partir d’une réponse de l’autorité de certification enregistrée dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="24bd8-165">The CertEnroll.dll library does not directly implement functionality to retrieve a certificate from a CA response saved in a file.</span></span> <span data-ttu-id="24bd8-166">Toutefois, vous pouvez créer une fonction personnalisée pour lire les données de fichier dans un tableau d’octets et appeler [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) pour installer la \# réponse PKCS 7 ou CMC, et appeler la propriété [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) pour récupérer le certificat.</span><span class="sxs-lookup"><span data-stu-id="24bd8-166">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response, and call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property to retrieve the certificate.</span></span>

<span data-ttu-id="24bd8-167">Si vous spécifiez la valeur **AllowNoOutstandingRequest** de l’énumération [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) pour le premier paramètre de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), un certificat fictif n’a pas besoin d’exister, ce qui vous permet d’installer un certificat sans appeler d’abord [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="24bd8-167">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="24bd8-168">Toutefois, si vous installez un certificat à l’aide d’un script Web, un certificat factice doit exister dans le magasin de demandes.</span><span class="sxs-lookup"><span data-stu-id="24bd8-168">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="24bd8-169">Vous devez donc spécifier **AllowNone** pour le premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="24bd8-169">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfrompkcs7"></a><span data-ttu-id="24bd8-170">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="24bd8-170">getCertContextFromPKCS7</span></span>

<span data-ttu-id="24bd8-171">La fonction [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) dans Xenroll.dll récupère le certificat client à partir d’une \# réponse PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="24bd8-171">The [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) function in Xenroll.dll retrieves the client certificate from a PKCS \#7 response.</span></span>

<span data-ttu-id="24bd8-172">Vous pouvez appeler la propriété [**certificat**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) sur l’objet [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) pour récupérer un certificat après avoir appelé la méthode [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="24bd8-172">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="getcertcontextfromresponseblob"></a><span data-ttu-id="24bd8-173">getCertContextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="24bd8-173">getCertContextFromResponseBlob</span></span>

<span data-ttu-id="24bd8-174">La fonction [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) dans Xenroll.dll récupère un certificat client à partir d’une \# réponse PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="24bd8-174">The [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) function in Xenroll.dll retrieves a client certificate from a PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="24bd8-175">Vous pouvez appeler la propriété [**certificat**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) sur l’objet [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) pour récupérer un certificat après avoir appelé la méthode [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="24bd8-175">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="installpkcs7blob"></a><span data-ttu-id="24bd8-176">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="24bd8-176">InstallPKCS7Blob</span></span>

<span data-ttu-id="24bd8-177">La fonction [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) dans Xenroll.dll installe une \# réponse PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="24bd8-177">The [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response.</span></span>

<span data-ttu-id="24bd8-178">Vous pouvez appeler [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) pour installer une \# réponse PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="24bd8-178">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="24bd8-179">Si vous spécifiez la valeur **AllowNoOutstandingRequest** de l’énumération [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) pour le premier paramètre de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), un certificat factice n’a pas besoin d’exister, ce qui vous permet d’installer la réponse sans appeler d’abord [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="24bd8-179">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="24bd8-180">Toutefois, si vous installez un certificat à l’aide d’un script Web, un certificat factice doit exister dans le magasin de demandes.</span><span class="sxs-lookup"><span data-stu-id="24bd8-180">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="24bd8-181">Vous devez donc spécifier **AllowNone** pour le premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="24bd8-181">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="installpkcs7blobex"></a><span data-ttu-id="24bd8-182">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="24bd8-182">InstallPKCS7BlobEx</span></span>

<span data-ttu-id="24bd8-183">La fonction [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) dans Xenroll.dll installe une \# réponse PKCS 7 et retourne le nombre de certificats installés.</span><span class="sxs-lookup"><span data-stu-id="24bd8-183">The [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) function in Xenroll.dll installs a PKCS \#7 response and returns the number of certificates installed.</span></span>

<span data-ttu-id="24bd8-184">Vous pouvez appeler [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) pour installer une \# réponse PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="24bd8-184">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="24bd8-185">Si vous spécifiez la valeur **AllowNoOutstandingRequest** de l’énumération [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) pour le premier paramètre de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), un certificat factice n’a pas besoin d’exister, ce qui vous permet d’installer la réponse sans appeler d’abord [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="24bd8-185">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="24bd8-186">Toutefois, si vous installez un certificat à l’aide d’un script Web, un certificat factice doit exister dans le magasin de demandes.</span><span class="sxs-lookup"><span data-stu-id="24bd8-186">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="24bd8-187">Vous devez donc spécifier **AllowNone** pour le premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="24bd8-187">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="spcfilenamewstr"></a><span data-ttu-id="24bd8-188">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="24bd8-188">SPCFileNameWStr</span></span>

<span data-ttu-id="24bd8-189">La fonction [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) dans Xenroll.dll spécifie ou récupère le nom du fichier dans lequel enregistrer la réponse du certificat.</span><span class="sxs-lookup"><span data-stu-id="24bd8-189">The [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) function in Xenroll.dll specifies or retrieves the name of the file in which to save the certificate response.</span></span> <span data-ttu-id="24bd8-190">La bibliothèque CertEnroll.dll n’implémente pas les fonctionnalités qui vous permettent de copier un certificat dans un fichier spécifique.</span><span class="sxs-lookup"><span data-stu-id="24bd8-190">The CertEnroll.dll library does not implement functionality that enables you to copy a certificate to a specific file.</span></span> <span data-ttu-id="24bd8-191">Le processus d’inscription installe automatiquement la chaîne de certificats dans des fichiers dans les magasins appropriés.</span><span class="sxs-lookup"><span data-stu-id="24bd8-191">The enrollment process automatically installs the certificate chain into files in the appropriate stores.</span></span>

## <a name="writecerttocsp"></a><span data-ttu-id="24bd8-192">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="24bd8-192">WriteCertToCSP</span></span>

<span data-ttu-id="24bd8-193">La fonction [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) dans Xenroll.dll spécifie ou récupère une valeur booléenne qui indique si un certificat doit être écrit dans un [*fournisseur de services de chiffrement*](/windows/desktop/SecGloss/c-gly) (CSP).</span><span class="sxs-lookup"><span data-stu-id="24bd8-193">The [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be written to a [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP).</span></span> <span data-ttu-id="24bd8-194">En général, si cette fonction est appelée, le fournisseur est une [*carte à puce*](/windows/desktop/SecGloss/s-gly).</span><span class="sxs-lookup"><span data-stu-id="24bd8-194">Typically, if this function is called, the provider is a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>

<span data-ttu-id="24bd8-195">Dans CertEnroll.dll, lorsqu’un client appelle la méthode d' [**inscription**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) pour soumettre une demande de certificat de carte à puce et qu’un certificat est émis, l' [**inscription**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) installe automatiquement le certificat sur la carte à puce en supposant que la carte est installée dans le lecteur.</span><span class="sxs-lookup"><span data-stu-id="24bd8-195">In CertEnroll.dll, when a client calls the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method to submit a request for a smart card certificate and a certificate is issued, [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) automatically installs the certificate on the smart card, assuming that the card is installed in the reader.</span></span> <span data-ttu-id="24bd8-196">La méthode [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) écrit également automatiquement le certificat sur la carte à puce.</span><span class="sxs-lookup"><span data-stu-id="24bd8-196">The [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method also automatically writes the certificate to the smart card.</span></span>

## <a name="writecerttouserds"></a><span data-ttu-id="24bd8-197">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="24bd8-197">WriteCertToUserDS</span></span>

<span data-ttu-id="24bd8-198">La fonction [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) dans Xenroll.dll spécifie ou récupère une valeur booléenne qui indique si un certificat doit être enregistré dans le magasin de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="24bd8-198">The [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be saved in the Active Directory store.</span></span> <span data-ttu-id="24bd8-199">La bibliothèque CertEnroll.dll n’implémente pas les fonctionnalités qui vous permettent de spécifier un magasin vers lequel copier un certificat.</span><span class="sxs-lookup"><span data-stu-id="24bd8-199">The CertEnroll.dll library does not implement functionality that enables you to specify a store to copy a certificate to.</span></span>

## <a name="related-topics"></a><span data-ttu-id="24bd8-200">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="24bd8-200">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="24bd8-201">Mappage de Xenroll.dll à CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="24bd8-201">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="24bd8-202">**IX509Enrollment**</span><span class="sxs-lookup"><span data-stu-id="24bd8-202">**IX509Enrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)
</dt> </dl>

 

 
