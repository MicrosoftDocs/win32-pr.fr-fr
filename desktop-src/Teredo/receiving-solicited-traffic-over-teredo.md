---
title: Réception du trafic sollicité sur Teredo
description: De nombreuses applications, telles que Microsoft Internet Explorer et Microsoft Outlook, initient uniquement des connexions à Internet.
ms.assetid: bff5d65e-050d-4b09-9982-8024612ffa6e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 035d067afeb9c62795efb5acd0bb28adc3afcb16
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/09/2020
ms.locfileid: "104508174"
---
# <a name="receiving-solicited-traffic-over-teredo"></a><span data-ttu-id="40654-103">Réception du trafic sollicité sur Teredo</span><span class="sxs-lookup"><span data-stu-id="40654-103">Receiving Solicited Traffic Over Teredo</span></span>

<span data-ttu-id="40654-104">De nombreuses applications, telles que Microsoft Internet Explorer et Microsoft Outlook, initient uniquement des connexions à Internet.</span><span class="sxs-lookup"><span data-stu-id="40654-104">Many applications such as Microsoft Internet Explorer and Microsoft Outlook only initiate connections to the Internet.</span></span> <span data-ttu-id="40654-105">Pour ces applications, [Teredo](about-teredo.md) peut fournir une connectivité transparente sur IPv6 en l’absence d’autres interfaces IPv6.</span><span class="sxs-lookup"><span data-stu-id="40654-105">For these applications, [Teredo](about-teredo.md) can provide seamless connectivity over IPv6 in the absence of other IPv6 interfaces.</span></span> <span data-ttu-id="40654-106">En outre, le trafic sollicité peut être reçu via l’interface Teredo sur les plateformes Microsoft Windows XP avec Service Pack 2 (SP2) et Windows Server 2003 antérieures.</span><span class="sxs-lookup"><span data-stu-id="40654-106">Additionally, solicited traffic can be received over the Teredo Interface on the earlier Microsoft Windows XP with Service Pack 2 (SP2) and Windows Server 2003 platforms.</span></span>

<span data-ttu-id="40654-107">La documentation suivante explique comment ces applications assurent la connectivité et les circonstances dans lesquelles Teredo est utilisé.</span><span class="sxs-lookup"><span data-stu-id="40654-107">The following documentation explains how these applications achieve connectivity, and the circumstances under which Teredo is used.</span></span>

## <a name="obtaining-a-destination-address"></a><span data-ttu-id="40654-108">Obtention d’une adresse de destination</span><span class="sxs-lookup"><span data-stu-id="40654-108">Obtaining a Destination Address</span></span>

<span data-ttu-id="40654-109">Une application tente d’obtenir l’adresse de destination à l’aide de différentes méthodes, telles que le DNS (Domain Name System) ou le protocole PNRP (Peer Name Resolution Protocol).</span><span class="sxs-lookup"><span data-stu-id="40654-109">An application attempts to obtain the destination address using various methods such as Domain Name System (DNS) or Peer Name Resolution Protocol (PNRP).</span></span> <span data-ttu-id="40654-110">L’application peut obtenir plusieurs adresses IP IPv4 et IPv6 à l’aide de ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="40654-110">It is possible for the application to obtain multiple IPv4 and IPv6 IP addresses using these methods.</span></span> <span data-ttu-id="40654-111">Les API standard utilisées pour obtenir les adresses IP incluent l’API Windows XP [**gethostbyname**](/windows/desktop/api/wsipv6ok/nf-wsipv6ok-gethostbyname) et la nouvelle API Windows Vista [**getaddrinfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo).</span><span class="sxs-lookup"><span data-stu-id="40654-111">The typical APIs used to obtain IP addresses include the Windows XP API [**GetHostByName**](/windows/desktop/api/wsipv6ok/nf-wsipv6ok-gethostbyname) and the new Windows Vista API [**GetAddrInfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo).</span></span> <span data-ttu-id="40654-112">Par exemple, l’utilisation de l’API GetAddrInfo avec le paramètre de la *\_ famille ai* définie sur AF \_ inet6 comme indicateur de addrinfo/protocole permet à l’utilisateur d’interroger les serveurs DNS pour les adresses IPv6, en particulier.</span><span class="sxs-lookup"><span data-stu-id="40654-112">For example, using the GetAddrInfo API with the *ai\_family* parameter set to AF\_INET6 as the addrinfo/protocol hint allows the user to query DNS servers for IPv6 addresses specifically.</span></span> <span data-ttu-id="40654-113">L’API [**DNSQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) avec le type DNS \_ \_ aaaa peut également être utilisée pour interroger les serveurs DNS pour les enregistrements aaaa.</span><span class="sxs-lookup"><span data-stu-id="40654-113">The [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) API with the type DNS\_TYPE\_AAAA can also be used to query the DNS servers for AAAA records.</span></span>

## <a name="establishing-a-connection"></a><span data-ttu-id="40654-114">Établissement d’une connexion</span><span class="sxs-lookup"><span data-stu-id="40654-114">Establishing a Connection</span></span>

<span data-ttu-id="40654-115">Une connexion établie avec Teredo est décrite comme « transparente », car elle est gérée comme toute autre connexion IPv6.</span><span class="sxs-lookup"><span data-stu-id="40654-115">A connection established with Teredo is described as 'seamless' because it is handled like any other IPv6 connection.</span></span> <span data-ttu-id="40654-116">La programmation d’une application ne nécessite pas une attention particulière pour pouvoir utiliser l’interface Teredo.</span><span class="sxs-lookup"><span data-stu-id="40654-116">The programming of an application does not require special consideration to be capable of utilizing the Teredo interface.</span></span> <span data-ttu-id="40654-117">Lorsqu’une connexion est établie entre des interfaces Teredo, il n’est pas nécessaire d’avoir un routeur de relais, typique de 6to4 et d’autres interfaces natives.</span><span class="sxs-lookup"><span data-stu-id="40654-117">When a connection is established between Teredo interfaces, a relay router, typical of 6to4 and other native interfaces, is not required.</span></span> <span data-ttu-id="40654-118">Toutefois, Teredo est conçu comme une technologie de transition en dernier ressort pour la connectivité IPv6.</span><span class="sxs-lookup"><span data-stu-id="40654-118">However, Teredo is designed as a last resort transition technology for IPv6 connectivity.</span></span>

> [!Note]  
> <span data-ttu-id="40654-119">Teredo n’est pas utilisé si le nom d’hôte fourni est résolu en adresses IPv4 uniquement.</span><span class="sxs-lookup"><span data-stu-id="40654-119">Teredo is not utilized if the supplied hostname resolves to IPv4 addresses only.</span></span>

 

<span data-ttu-id="40654-120">Quand une application tente de se connecter à une destination à l’aide d’adresses IPv6, voici ce qui se produit :</span><span class="sxs-lookup"><span data-stu-id="40654-120">When an application attempts to connect to a destination using IPv6 addresses, the following will occur:</span></span>

-   <span data-ttu-id="40654-121">L’application obtient une liste d’adresses IPv6 en appelant l’API [**GetAdaptersAddresses**](/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) .</span><span class="sxs-lookup"><span data-stu-id="40654-121">The application obtains a list of IPv6 addresses by calling the [**GetAdaptersAddresses**](/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) API.</span></span> <span data-ttu-id="40654-122">La pile Windows Vista retourne une liste de toutes les interfaces en fonction de l’ordre de tri spécifié dans le [document RFC 3484](https://www.irt.org/rfc/rfc3484.htm).</span><span class="sxs-lookup"><span data-stu-id="40654-122">The Windows Vista stack returns a list of all interfaces based on the sorting order specified in [RFC 3484](https://www.irt.org/rfc/rfc3484.htm).</span></span> <span data-ttu-id="40654-123">Par conséquent, les interfaces IPv6 et 6to4 IPv6 seront listées avant l’interface Teredo.</span><span class="sxs-lookup"><span data-stu-id="40654-123">As a result, IPv6 and 6to4 IPv6 interfaces will be listed before Teredo interface.</span></span> <span data-ttu-id="40654-124">Toutefois, lorsque la connectivité IPv6 native ou 6to4 n’est pas disponible, Teredo est la seule interface compatible IPv6 listée.</span><span class="sxs-lookup"><span data-stu-id="40654-124">However, when native IPv6 or 6to4 connectivity is not available, Teredo will be the only IPv6 capable interface listed.</span></span>

    <span data-ttu-id="40654-125">Il est important de se souvenir qu’une application peut utiliser n’importe quelle interface fournie par la pile Windows Vista, mais le classement de la liste d’interfaces retournée entraînera généralement la tentative de la dernière tentative de Teredo.</span><span class="sxs-lookup"><span data-stu-id="40654-125">It is important to remember that an application can use any interface provided by the Windows Vista stack, however the ordering of the interface list returned will most often result in Teredo being attempted last.</span></span>

-   <span data-ttu-id="40654-126">Avant que Windows Vista tente une connexion sur l’interface Teredo, le système d’exploitation s’assure que l’adresse IPv6 est stabilisée.</span><span class="sxs-lookup"><span data-stu-id="40654-126">Before Windows Vista attempts a connection over the Teredo interface, the operating system ensures that the IPv6 address has stabilized.</span></span> <span data-ttu-id="40654-127">Cela s’effectue automatiquement pour les connexions sortantes et n’est pas un facteur crucial pour une application.</span><span class="sxs-lookup"><span data-stu-id="40654-127">This is done automatically for outgoing connections and is not a crucial consideration for an application.</span></span> <span data-ttu-id="40654-128">Dans le cas où l’application est requise pour garantir la stabilité des adresses, l’API [**NotifyStableUnicastIpAddressTable**](/windows/desktop/api/netioapi/nf-netioapi-notifystableunicastipaddresstable) peut être appelée pour s’assurer que l’adresse Teredo est stable.</span><span class="sxs-lookup"><span data-stu-id="40654-128">In the event the application is required to guarantee address stability, the [**NotifyStableUnicastIpAddressTable**](/windows/desktop/api/netioapi/nf-netioapi-notifystableunicastipaddresstable) API can be called to ensure that the Teredo address is stable.</span></span>

-   <span data-ttu-id="40654-129">Une interface Teredo tentera de se connecter à une autre interface Teredo à la destination.</span><span class="sxs-lookup"><span data-stu-id="40654-129">A Teredo interface will attempt to connect to another Teredo interface at the destination.</span></span> <span data-ttu-id="40654-130">Si aucune interface Teredo n’est présente, une connexion est établie avec une adresse de destination native ou 6to4 via un relais spécifique à l’hôte.</span><span class="sxs-lookup"><span data-stu-id="40654-130">If a Teredo interface is not present, a connection is established with a native or 6to4 destination address through a host-specific relay.</span></span>

<span data-ttu-id="40654-131">Il est également possible pour les applications qui initient des connexions à Internet de recevoir du trafic non sollicité.</span><span class="sxs-lookup"><span data-stu-id="40654-131">It is also possible for applications that initiate connections to the Internet to receive unsolicited traffic.</span></span> <span data-ttu-id="40654-132">Pour plus d’informations, consultez [réception de trafic non sollicité sur Teredo](receiving-unsolicited-traffic-over-teredo.md).</span><span class="sxs-lookup"><span data-stu-id="40654-132">For more details see [Receiving Unsolicited Traffic Over Teredo](receiving-unsolicited-traffic-over-teredo.md).</span></span>

## <a name="using-the-wsaconnectbyname-api"></a><span data-ttu-id="40654-133">Utilisation de l’API WSAConnectByName</span><span class="sxs-lookup"><span data-stu-id="40654-133">Using the WSAConnectByName API</span></span>

<span data-ttu-id="40654-134">En appelant l’API WSAConnectByName, il est possible pour une application de se connecter à un nom de destination au lieu de spécifier l’adresse IP exacte.</span><span class="sxs-lookup"><span data-stu-id="40654-134">By calling the WSAConnectByName API, it is possible for an application to connect to a destination name instead of specifying the exact IP address.</span></span> <span data-ttu-id="40654-135">La pile Windows Vista préfère IPv6 sur IPv4 et, par conséquent, toutes les tentatives de connexion seront d’abord effectuées sur les adresses IPv6.</span><span class="sxs-lookup"><span data-stu-id="40654-135">The Windows Vista stack prefers IPv6 over IPv4, and as a result any connection attempts will be made to IPv6 addresses first.</span></span>

<span data-ttu-id="40654-136">L’appel de l’API WSAConnectByName trie toutes les adresses IP de destination obtenues dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="40654-136">Calling the WSAConnectByName API will sort all destination IP addresses obtained in the following order:</span></span>

-   <span data-ttu-id="40654-137">Adresse IPv6 native</span><span class="sxs-lookup"><span data-stu-id="40654-137">Native IPv6 address</span></span>
-   <span data-ttu-id="40654-138">adresse IP 6to4</span><span class="sxs-lookup"><span data-stu-id="40654-138">6to4 IP address</span></span>
-   <span data-ttu-id="40654-139">Adresse IPv4</span><span class="sxs-lookup"><span data-stu-id="40654-139">IPv4 address</span></span>
-   <span data-ttu-id="40654-140">Adresse Teredo</span><span class="sxs-lookup"><span data-stu-id="40654-140">Teredo address</span></span>

<span data-ttu-id="40654-141">Une fois les adresses de destination triées en interne, une connexion à la destination est tentée en fonction du meilleur itinéraire disponible sur l’hôte local pour l’adresse de destination.</span><span class="sxs-lookup"><span data-stu-id="40654-141">After the destination addresses are sorted internally, a connection to the destination is attempted based on the best route available on the local host for the destination address.</span></span> <span data-ttu-id="40654-142">Comme indiqué par l’ordre des adresses triées, si le nom de destination correspond à une adresse IPv4 et Teredo, l’adresse IPv4 est utilisée pour établir la connexion.</span><span class="sxs-lookup"><span data-stu-id="40654-142">As indicated by the order of the sorted addresses, if the destination name resolves to a IPv4 and Teredo address, the IPv4 address will be used to establish the connection.</span></span>

<span data-ttu-id="40654-143">L’API WSAConnectByName fonctionne en interne afin de trouver la meilleure correspondance entre les adresses.</span><span class="sxs-lookup"><span data-stu-id="40654-143">The WSAConnectByName API works internally to find the best match between addresses.</span></span> <span data-ttu-id="40654-144">Cette tentative est basée sur les itinéraires disponibles sur l’hôte local et les adresses de destination.</span><span class="sxs-lookup"><span data-stu-id="40654-144">This attempt is based on the routes available on the local host and the destination addresses.</span></span>

<span data-ttu-id="40654-145">En raison de l’absence actuelle de relais Teredo sur Internet, il est peu probable que les connexions aux adresses IPv6 natives aboutissent sur l’interface Teredo.</span><span class="sxs-lookup"><span data-stu-id="40654-145">Due to current absence of Teredo relays on the Internet, connections to native IPv6 addresses are unlikely to succeed over the Teredo interface.</span></span> <span data-ttu-id="40654-146">Si WSAConnectByName est appelé, Windows Vista n’émet pas de requêtes AAAA quand Teredo est la seule interface compatible IPv6 disponible.</span><span class="sxs-lookup"><span data-stu-id="40654-146">If WSAConnectByName is called, Windows Vista will not issue AAAA queries when Teredo is the only IPv6 capable interface available.</span></span> <span data-ttu-id="40654-147">Cela permet de s’assurer que les adresses IPv6 natives ne sont pas obtenues comme destination et que les connexions sont tentées sur IPv4, ce qui a le plus de chances de réussir.</span><span class="sxs-lookup"><span data-stu-id="40654-147">This ensures that native IPv6 addresses are not obtained as a destination and that connections are attempted over IPv4, which has the highest chance of success.</span></span> <span data-ttu-id="40654-148">Pour obtenir des adresses IPv6 quand Teredo est la seule interface compatible IPv6, une application doit utiliser explicitement l’API DnsQuery pour les enregistrements AAAA.</span><span class="sxs-lookup"><span data-stu-id="40654-148">In order to obtain IPv6 addresses when Teredo is the only IPv6 capable interface, an application must explicitly use the DnsQuery API for AAAA records.</span></span>

 

 