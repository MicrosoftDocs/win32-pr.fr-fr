---
description: 'En savoir plus sur : transactions (événements Windows)'
title: Transactions (événements Windows)
TOCTitle: Transactions
ms:assetid: 1ceb362c-1efe-439b-b10a-016c8a54f27b
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269197(v=EXCHG.10)
ms:contentKeyID: 32765500
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 90b5b566f5ff961ce7b0ae3725f580e1f39c041d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104319758"
---
# <a name="transactions-windows-events"></a><span data-ttu-id="68814-103">Transactions (événements Windows)</span><span class="sxs-lookup"><span data-stu-id="68814-103">Transactions (Windows Events)</span></span>


<span data-ttu-id="68814-104">_**S’applique à :** Windows | Serveur Windows_</span><span class="sxs-lookup"><span data-stu-id="68814-104">_**Applies to:** Windows�| Windows Server_</span></span>

## <a name="transactions"></a><span data-ttu-id="68814-105">Transactions</span><span class="sxs-lookup"><span data-stu-id="68814-105">Transactions</span></span>

<span data-ttu-id="68814-106">Les transactions ESE sont des unités logiques de traitement qui contrôlent la façon dont une application visualise et manipule des lignes dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="68814-106">ESE transactions are logical units of processing that control how an application sees and manipulates rows in the database.</span></span> <span data-ttu-id="68814-107">Votre application peut utiliser des points d’enregistrement de transaction pour déterminer s’il faut conserver ou ignorer un ensemble spécifique de modifications apportées à la base de données.</span><span class="sxs-lookup"><span data-stu-id="68814-107">Your application can use transaction save points to determine whether to keep or discard a particular set of changes to the database.</span></span> <span data-ttu-id="68814-108">Toutes les transactions dans ESE sont atomiques, cohérentes, isolées et durables (ACID) comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="68814-108">All transactions in ESE are atomic, consistent, isolated, and durable (ACID) as described below:</span></span>

  - <span data-ttu-id="68814-109">**Atomic :** Toutes les mises à jour de la transaction s’affichent dans la base de données ou elles sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="68814-109">**Atomic:** All the updates in the transaction either appear in the database or they are discarded.</span></span>

<!-- end list -->

  - <span data-ttu-id="68814-110">**Cohérent :** La base de données démarre toujours dans un état légal et se termine toujours par un autre état légal.</span><span class="sxs-lookup"><span data-stu-id="68814-110">**Consistent:** The database will always start in a legal state and will always end in another legal state.</span></span> <span data-ttu-id="68814-111">Pour les applications ESE, le moteur de base de données contrôle certaines contraintes simples, par exemple l’unicité d’un index unique, mais l’application elle-même définit presque tous les autres aspects de ce que cela signifie que la base de données doit être dans un état légal.</span><span class="sxs-lookup"><span data-stu-id="68814-111">For ESE applications, the database engine will control some simple constraints, for example uniqueness of a unique index, but the application itself will define almost all other aspects of what it means for the database to be in a legal state.</span></span>

<!-- end list -->

  - <span data-ttu-id="68814-112">**Isolation :** Les transactions sont isolées des mises à jour par d’autres sessions.</span><span class="sxs-lookup"><span data-stu-id="68814-112">**Isolation:** Transactions are isolated from updates by other sessions.</span></span> <span data-ttu-id="68814-113">Une transaction ne verra jamais un ensemble partiel de modifications apportées par une autre transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-113">A transaction will never see a partial set of changes made by another transaction.</span></span>

<!-- end list -->

  - <span data-ttu-id="68814-114">**Durable :** Une fois que le moteur de base de données a confirmé qu’une transaction a été validée, ses modifications sont persistantes dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="68814-114">**Durable:** After the database engine acknowledges that a transaction has been committed, its changes are persistent in the database.</span></span> <span data-ttu-id="68814-115">La durabilité d’une transaction peut éventuellement être annulée pour des raisons de performances.</span><span class="sxs-lookup"><span data-stu-id="68814-115">The durability of a transaction may be optionally waived for performance reasons.</span></span>

<span data-ttu-id="68814-116">Les transactions sont effectuées dans les limites des appels à [JetBeginTransaction](./jetbegintransaction-function.md) et [JetCommitTransaction](./jetcommittransaction-function.md) ou [JetRollback](./jetrollback-function.md).</span><span class="sxs-lookup"><span data-stu-id="68814-116">Transactions are performed within the bounds of the calls to [JetBeginTransaction](./jetbegintransaction-function.md) and [JetCommitTransaction](./jetcommittransaction-function.md) or [JetRollback](./jetrollback-function.md).</span></span> <span data-ttu-id="68814-117">Lorsque l’application entre dans la transaction, la base de données apparaît figée à l’instance au moment où la transaction commence.</span><span class="sxs-lookup"><span data-stu-id="68814-117">When the application enters the transaction, the database appears frozen at the instance in time that the transaction begins.</span></span> <span data-ttu-id="68814-118">C’est ce qu’on appelle l’isolation d’instantané.</span><span class="sxs-lookup"><span data-stu-id="68814-118">This is called snapshot isolation.</span></span> <span data-ttu-id="68814-119">Si la transaction se termine par l’appel de [JetRollback](./jetrollback-function.md), aucune des opérations effectuées dans la transaction n’est validée dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="68814-119">If the transaction is terminated by calling [JetRollback](./jetrollback-function.md), none of the operations performed in the transaction are committed to the database.</span></span> <span data-ttu-id="68814-120">Si le processus ou l’ordinateur se bloque avant que [JetCommitTransaction](./jetcommittransaction-function.md) ne soit appelé, il revient à appeler [JetRollback](./jetrollback-function.md).</span><span class="sxs-lookup"><span data-stu-id="68814-120">If the process or the machine crashes before [JetCommitTransaction](./jetcommittransaction-function.md) is called, it is the same as calling [JetRollback](./jetrollback-function.md).</span></span>

<span data-ttu-id="68814-121">Cette procédure montre comment démarrer et valider une transaction qui lit et met à jour des données dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="68814-121">This procedure shows how to start and commit a transaction that reads and updates data in a database.</span></span>

### <a name="to-start-and-commit-a-transaction"></a><span data-ttu-id="68814-122">Pour démarrer et valider une transaction</span><span class="sxs-lookup"><span data-stu-id="68814-122">To start and commit a transaction</span></span>

1.  <span data-ttu-id="68814-123">Appelez [JetBeginTransaction](./jetbegintransaction-function.md) ou [JETBEGINTRANSACTION2](./jetbegintransaction2-function.md) avec l’ID de session pour démarrer la transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-123">Call [JetBeginTransaction](./jetbegintransaction-function.md) or [JetBeginTransaction2](./jetbegintransaction2-function.md) with the session ID to start the transaction.</span></span>

2.  <span data-ttu-id="68814-124">Déplacez le curseur vers l’enregistrement souhaité en appelant [JetMove](./jetmove-function.md) avec JET_MoveFirst spécifié dans le paramètre *cRow* .</span><span class="sxs-lookup"><span data-stu-id="68814-124">Move the cursor to the desired record by calling [JetMove](./jetmove-function.md) with JET_MoveFirst specified in the *cRow* parameter.</span></span> <span data-ttu-id="68814-125">Pour plus d’informations sur le déplacement du curseur, consultez la rubrique [indexation dans le tableau](./indexing-in-the-table.md) .</span><span class="sxs-lookup"><span data-stu-id="68814-125">For more information on how to move the cursor, see the [Indexing in the Table](./indexing-in-the-table.md) topic.</span></span>

3.  <span data-ttu-id="68814-126">Appelez [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md) sur l’enregistrement en cours avec JET_ColInfo spécifié dans le paramètre *InfoLevel* pour récupérer l’ID de colonne de la colonne.</span><span class="sxs-lookup"><span data-stu-id="68814-126">Call [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md) on the current record with JET_ColInfo specified in the *InfoLevel* parameter to retrieve the column ID for the column.</span></span> <span data-ttu-id="68814-127">L’ID de colonne est retourné dans la structure [JET_COLUMNDEF](./jet-columndef-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="68814-127">The column ID is returned in the [JET_COLUMNDEF](./jet-columndef-structure.md) structure.</span></span>

4.  <span data-ttu-id="68814-128">Appelez [JetSetColumn](./jetsetcolumn-function.md) avec l’ID de session, l’ID de table et l’ID de colonne de la colonne mise à jour.</span><span class="sxs-lookup"><span data-stu-id="68814-128">Call [JetSetColumn](./jetsetcolumn-function.md) with the session ID, table ID, and column ID of the column that is updated.</span></span> <span data-ttu-id="68814-129">Les données de la colonne sont contenues dans le paramètre *pvData* .</span><span class="sxs-lookup"><span data-stu-id="68814-129">The column data is contained in the *pvData* parameter.</span></span>

5.  <span data-ttu-id="68814-130">Appelez [JetCommitTransaction](./jetcommittransaction-function.md) pour valider la transaction dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="68814-130">Call [JetCommitTransaction](./jetcommittransaction-function.md) to commit the transaction to the database.</span></span>

<span data-ttu-id="68814-131">La façon dont un moteur de base de données ESE implémente l’isolement de capture instantanée présente des différences importantes par rapport aux modèles d’isolation et de verrouillage de base de données relationnelle traditionnels.</span><span class="sxs-lookup"><span data-stu-id="68814-131">The way in which an ESE database engine implements snapshot isolation has some important differences from traditional relational database isolation and locking models.</span></span> <span data-ttu-id="68814-132">Lorsqu’une transaction lit une ligne, elle peut toujours accéder à la ligne sans échec ou en attendant que d’autres sessions libèrent un verrou.</span><span class="sxs-lookup"><span data-stu-id="68814-132">When a transaction reads a row, it can always access the row without failing or waiting for other sessions to release a lock.</span></span> <span data-ttu-id="68814-133">Lorsqu’une transaction tente de mettre à jour une ligne, elle est réussie s’il s’agit de la première session pour mettre à jour cette ligne, c’est-à-dire le premier enregistreur qui gagne.</span><span class="sxs-lookup"><span data-stu-id="68814-133">When a transaction attempts to update a row, it will succeed if it is the first session to update that row, that is the first writer wins.</span></span> <span data-ttu-id="68814-134">Si la session n’est pas le premier enregistreur, elle échoue immédiatement avec une erreur de conflit d’écriture.</span><span class="sxs-lookup"><span data-stu-id="68814-134">If the session is not the first writer then it will immediately fail with a write conflict error.</span></span> <span data-ttu-id="68814-135">La session doit ensuite abandonner sa transaction, attendre (généralement via un délai aléatoire) pour que l’autre transaction valide ses modifications, puis retenter la transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-135">The session must then abort its transaction, wait (usually via a random delay), for the other transaction to commit its changes, and then retry the transaction.</span></span> <span data-ttu-id="68814-136">Le moteur de base de données n’entraîne pas automatiquement l’attente de cette session jusqu’à la fin de la mise à jour de l’autre transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-136">The database engine will not automatically cause that session to wait until the other transaction has finished its update.</span></span> <span data-ttu-id="68814-137">En règle générale, une transaction est testée si elle peut mettre à jour une ligne à l’intérieur de l’appel [JetUpdate](./jetupdate-function.md) .</span><span class="sxs-lookup"><span data-stu-id="68814-137">Usually, a transaction will test if it can update a row inside of the [JetUpdate](./jetupdate-function.md) call.</span></span> <span data-ttu-id="68814-138">S’il ne peut pas verrouiller la ligne pour la mise à jour, [JetUpdate](./jetupdate-function.md) échouera avec JET_errWriteConflict.</span><span class="sxs-lookup"><span data-stu-id="68814-138">If it cannot lock the row for update then [JetUpdate](./jetupdate-function.md) will fail with JET_errWriteConflict.</span></span>

<span data-ttu-id="68814-139">Les sessions sont limitées à un thread à partir du moment où la transaction commence jusqu’à la fin de la transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-139">Sessions are limited to one thread from the time the transaction starts to the end of the transaction.</span></span> <span data-ttu-id="68814-140">Il est recommandé que toutes les opérations de mise à jour et de récupération soient effectuées dans une transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-140">It is recommended that all update and retrieve operations be performed in a transaction.</span></span> <span data-ttu-id="68814-141">ESE prend également en charge les modifications de schéma, telles que la création de tables et l’ajout de colonnes à l’intérieur de la transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-141">ESE also supports schema modifications such as creating tables and adding columns inside the transaction.</span></span> <span data-ttu-id="68814-142">Les modifications de mise à jour et de schéma peuvent être effectuées dans la même transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-142">Both update and schema modifications can be performed in the same transaction.</span></span> <span data-ttu-id="68814-143">Une fois la transaction terminée avec [JetCommitTransaction](./jetcommittransaction-function.md), la mise à jour est consignée dans le fichier journal des transactions.</span><span class="sxs-lookup"><span data-stu-id="68814-143">After the transaction completes with [JetCommitTransaction](./jetcommittransaction-function.md), the update is logged in the transaction log file.</span></span> <span data-ttu-id="68814-144">Ces fichiers peuvent être utilisés pour maintenir un État logiquement cohérent en cas d’arrêt inattendu d’un processus ou d’un arrêt du système.</span><span class="sxs-lookup"><span data-stu-id="68814-144">These files can be used to maintain a logically consistent state in the event of an unexpected process termination or system shutdown.</span></span>

<span data-ttu-id="68814-145">Les transactions peuvent être imbriquées jusqu’à 7 niveaux avec des appels correspondants à [JetBeginTransaction](./jetbegintransaction-function.md) et [JetCommitTransaction](./jetcommittransaction-function.md) ou [JetRollback](./jetrollback-function.md) imbriqués les uns dans les autres.</span><span class="sxs-lookup"><span data-stu-id="68814-145">Transactions may be nested up to 7 levels with matching calls to [JetBeginTransaction](./jetbegintransaction-function.md) and [JetCommitTransaction](./jetcommittransaction-function.md) or [JetRollback](./jetrollback-function.md) nested within each other.</span></span> <span data-ttu-id="68814-146">Cela permet à l’application de restaurer une partie de la transaction sans devoir revenir à la totalité de la transaction.</span><span class="sxs-lookup"><span data-stu-id="68814-146">This allows the application to rollback a part of the transaction without having to back out of the entire transaction.</span></span> <span data-ttu-id="68814-147">L’appel imbriqué à [JetCommitTransaction](./jetcommittransaction-function.md) signifie que ce niveau de traitement est terminé ; Toutefois, la transaction n’est pas validée dans la base de données jusqu’à l’appel externe le plus élevé pour valider la transaction avec [JetCommitTransaction](./jetcommittransaction-function.md).</span><span class="sxs-lookup"><span data-stu-id="68814-147">The nested call to [JetCommitTransaction](./jetcommittransaction-function.md) signifies that this level of processing is complete; however, the transaction is not committed to the database until the outer most call to commit the transaction with [JetCommitTransaction](./jetcommittransaction-function.md).</span></span>

<span data-ttu-id="68814-148">Les colonnes de mise à jour du tiers de confiance peuvent être mises à jour simultanément par plusieurs sessions sans échec avec Jet_errWriteConflict.</span><span class="sxs-lookup"><span data-stu-id="68814-148">Escrow update columns can be updated concurrently by multiple sessions without failing with Jet_errWriteConflict.</span></span> <span data-ttu-id="68814-149">La fonction [JetEscrowUpdate](./jetescrowupdate-function.md) peut uniquement être appelée sur des colonnes de dépôt, colonnes créées avec Jet_bitColumnEscrowUpdate.</span><span class="sxs-lookup"><span data-stu-id="68814-149">The [JetEscrowUpdate](./jetescrowupdate-function.md) function may only be called on escrow columns, columns that were created with Jet_bitColumnEscrowUpdate.</span></span>
