---
description: 'En savoir plus sur les colonnes : version, incrément automatique et tiers de confiance'
title: Colonnes version, incrémentation automatique et tiers de confiance
TOCTitle: Version, Auto-Increment and Escrow Columns
ms:assetid: b12724a4-6846-49a7-9223-43895f91427e
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294059(v=EXCHG.10)
ms:contentKeyID: 32765674
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: e5966990a51e87b90946416161e20d677116f8c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106515881"
---
# <a name="version-auto-increment-and-escrow-columns"></a><span data-ttu-id="f70fe-103">Colonnes version, incrémentation automatique et tiers de confiance</span><span class="sxs-lookup"><span data-stu-id="f70fe-103">Version, Auto-Increment and Escrow Columns</span></span>


<span data-ttu-id="f70fe-104">_**S’applique à :** Windows | Serveur Windows_</span><span class="sxs-lookup"><span data-stu-id="f70fe-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="version-auto-increment-and-escrow-columns"></a><span data-ttu-id="f70fe-105">Colonnes version, incrémentation automatique et tiers de confiance</span><span class="sxs-lookup"><span data-stu-id="f70fe-105">Version, Auto-Increment and Escrow Columns</span></span>

<span data-ttu-id="f70fe-106">ESE offre des types de colonne de mise à jour de version, d’incrémentation automatique et de dépôt qui ont des capacités particulières.</span><span class="sxs-lookup"><span data-stu-id="f70fe-106">ESE provides version, auto-increment, and escrow update column types that have special abilities.</span></span> <span data-ttu-id="f70fe-107">Les options de colonne définies dans le membre **Grbit** de la structure [JET_COLUMNDEF](./jet-columndef-structure.md) utilisée dans l’appel à [JetAddColumn](./jetaddcolumn-function.md) indiquent si la colonne est l’un des types spécialisés indiqués ici.</span><span class="sxs-lookup"><span data-stu-id="f70fe-107">The column options set in the **grbit** member of the [JET_COLUMNDEF](./jet-columndef-structure.md) structure used in the call to [JetAddColumn](./jetaddcolumn-function.md) indicate whether the column is one of the specialized types noted here.</span></span>

### <a name="version-jet_bitcolumnversion"></a><span data-ttu-id="f70fe-108">Version (JET_bitColumnVersion)</span><span class="sxs-lookup"><span data-stu-id="f70fe-108">Version (JET_bitColumnVersion)</span></span>

<span data-ttu-id="f70fe-109">L’option de colonne version, appliquée uniquement aux colonnes JET_coltypLong, indique que la colonne contient des informations de version sur l’enregistrement qui peuvent être utilisées pour déterminer si une copie en mémoire d’un enregistrement donné doit être actualisée.</span><span class="sxs-lookup"><span data-stu-id="f70fe-109">The version column option, applied only to JET_coltypLong columns, indicates that the column contains version information about the record that can be used to determine if an in-memory copy of a given record needs to be refreshed.</span></span> <span data-ttu-id="f70fe-110">Les colonnes de version sont automatiquement incrémentées par ESE lorsque la colonne est modifiée par l’application via [JetUpdate](./jetupdate-function.md).</span><span class="sxs-lookup"><span data-stu-id="f70fe-110">Version columns are automatically incremented by ESE when the column is modified by the application via [JetUpdate](./jetupdate-function.md).</span></span>

### <a name="auto-increment-jet_bitcolumnautoincrement"></a><span data-ttu-id="f70fe-111">Incrément automatique (JET_bitColumnAutoincrement)</span><span class="sxs-lookup"><span data-stu-id="f70fe-111">Auto-Increment (JET_bitColumnAutoincrement)</span></span>

<span data-ttu-id="f70fe-112">Les colonnes d’incrémentation automatique sont automatiquement incrémentées par ESE lorsqu’un nouvel enregistrement est inséré dans la table.</span><span class="sxs-lookup"><span data-stu-id="f70fe-112">Auto increment columns are automatically incremented by ESE when a new record is inserted into the table.</span></span> <span data-ttu-id="f70fe-113">La valeur contenue dans la colonne d’incrémentation automatique est unique pour chaque enregistrement de la table et n’est pas nécessairement continue.</span><span class="sxs-lookup"><span data-stu-id="f70fe-113">The value contained in the auto-increment column is unique for every record in the table and is not guaranteed to be continuous.</span></span> <span data-ttu-id="f70fe-114">Ces valeurs ne sont pas recyclées, mais peuvent être réutilisées dans certains cas.</span><span class="sxs-lookup"><span data-stu-id="f70fe-114">These values are not recycled, but can be reused in certain cases.</span></span> <span data-ttu-id="f70fe-115">Seules les colonnes de type JET_coltypLong et JET_coltypLongLong peuvent être des colonnes d’incrémentation automatique.</span><span class="sxs-lookup"><span data-stu-id="f70fe-115">Only columns of type JET_coltypLong and JET_coltypLongLong may be auto increment columns.</span></span>

### <a name="escrow-jet_bitcolumnescrowupdate"></a><span data-ttu-id="f70fe-116">Tiers de confiance (JET_bitColumnEscrowUpdate)</span><span class="sxs-lookup"><span data-stu-id="f70fe-116">Escrow (JET_bitColumnEscrowUpdate)</span></span>

<span data-ttu-id="f70fe-117">Les colonnes de dépôt peuvent être modifiées dans l’appel à [JetEscrowUpdate](./jetescrowupdate-function.md).</span><span class="sxs-lookup"><span data-stu-id="f70fe-117">Escrow columns can be modified in the call to [JetEscrowUpdate](./jetescrowupdate-function.md).</span></span> <span data-ttu-id="f70fe-118">Les mises à jour dans le tiers de confiance sont des opérations Delta numériques qui ne souffrent pas de conflits d’écriture.</span><span class="sxs-lookup"><span data-stu-id="f70fe-118">Updates in escrow are numeric delta operations that do not suffer from write conflicts.</span></span> <span data-ttu-id="f70fe-119">Cela signifie que tout nombre de sessions peut mettre à jour simultanément une colonne du tiers de confiance dans un enregistrement via [JetEscrowUpdate](./jetescrowupdate-function.md) sans conflits.</span><span class="sxs-lookup"><span data-stu-id="f70fe-119">What this means is that any number of sessions can concurrently update an escrow column in a record via [JetEscrowUpdate](./jetescrowupdate-function.md) without conflicts.</span></span> <span data-ttu-id="f70fe-120">Notez que toute autre opération de mise à jour peut toujours entraîner un conflit d’écriture avec une opération de mise à jour de tiers de confiance.</span><span class="sxs-lookup"><span data-stu-id="f70fe-120">Note that any other update operation may still result in a write conflict with an escrow update operation.</span></span> <span data-ttu-id="f70fe-121">Les mises à jour de tiers de confiance ne peuvent être apportées qu’à des colonnes de type JET_coltypLong qui ont une valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="f70fe-121">Escrow updates can only be made to columns of type JET_coltypLong that have a default value.</span></span> <span data-ttu-id="f70fe-122">Ces colonnes doivent également être ajoutées à une table avant d’être chargées avec des lignes.</span><span class="sxs-lookup"><span data-stu-id="f70fe-122">These columns must also be added to a table before it is loaded with rows.</span></span> <span data-ttu-id="f70fe-123">Enfin, les lignes contenant une colonne de mise à jour de dépôt peuvent être configurées pour prendre en charge un rappel de finalisation de ligne (JET_bitColumnFinalize) ou être automatiquement supprimées si le nombre de références atteint zéro (JET_bitColumnDeleteOnZero).</span><span class="sxs-lookup"><span data-stu-id="f70fe-123">Finally, rows containing an escrow update column may be configured to support a row finalization callback (JET_bitColumnFinalize) or to be automatically deleted if the ref count reaches zero (JET_bitColumnDeleteOnZero).</span></span> <span data-ttu-id="f70fe-124">Pour plus d’informations, consultez la structure [JET_COLUMNDEF](./jet-columndef-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="f70fe-124">For more information, see the [JET_COLUMNDEF](./jet-columndef-structure.md) structure.</span></span>
