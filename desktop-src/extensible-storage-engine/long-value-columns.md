---
description: En savoir plus sur les colonnes de valeur longue
title: Colonnes de valeur longue
TOCTitle: Long Value Columns
ms:assetid: 0690f9d3-1a58-4e53-92e1-213630fc88f4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269179(v=EXCHG.10)
ms:contentKeyID: 32765482
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: bb5618227d49de9e246adf69868a3cb2dc498dca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104033888"
---
# <a name="long-value-columns"></a><span data-ttu-id="bc93f-103">Colonnes de valeur longue</span><span class="sxs-lookup"><span data-stu-id="bc93f-103">Long Value Columns</span></span>


<span data-ttu-id="bc93f-104">_**S’applique à :** Windows | Serveur Windows_</span><span class="sxs-lookup"><span data-stu-id="bc93f-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="long-value-columns"></a><span data-ttu-id="bc93f-105">Colonnes de valeur longue</span><span class="sxs-lookup"><span data-stu-id="bc93f-105">Long Value Columns</span></span>

<span data-ttu-id="bc93f-106">Les types de colonnes ESE JET_coltypLongText et JET_coltypLongBinary sont appelés types de colonne de valeur longue.</span><span class="sxs-lookup"><span data-stu-id="bc93f-106">The ESE column types JET_coltypLongText and JET_coltypLongBinary are called long value column types.</span></span> <span data-ttu-id="bc93f-107">Ces colonnes sont des chaînes volumineuses et des objets binaires volumineux qui peuvent être stockés dans des arborescences B + séparées de l’index primaire.</span><span class="sxs-lookup"><span data-stu-id="bc93f-107">These columns are large string and large binary objects that may be stored in separate B+ trees away from the primary index.</span></span> <span data-ttu-id="bc93f-108">Lorsque des valeurs de type long sont stockées séparément de l’enregistrement principal, elles sont indexées en interne sur un ID de valeur long (couvercle) et un décalage d’octet et sont accessibles sous forme de flux.</span><span class="sxs-lookup"><span data-stu-id="bc93f-108">When long values are stored separate from the primary record, they are internally keyed on a long value ID (LID) and byte offset and accessed as a stream.</span></span> <span data-ttu-id="bc93f-109">Les colonnes de valeur longue sont ajoutées à la table dans l’appel à [JetAddColumn](./jetaddcolumn-function.md) avec le membre **coltyp** de la structure [JET_COLUMNDEF](./jet-columndef-structure.md) définie sur JET_coltypLongText ou JET_coltypLongBinary.</span><span class="sxs-lookup"><span data-stu-id="bc93f-109">Long value columns are added to the table in the call to [JetAddColumn](./jetaddcolumn-function.md) with the **coltyp** member of the [JET_COLUMNDEF](./jet-columndef-structure.md) structure set to either JET_coltypLongText or JET_coltypLongBinary.</span></span> <span data-ttu-id="bc93f-110">La taille maximale d’une longue valeur de colonne binaire ou de texte long est de 2 Go-1.</span><span class="sxs-lookup"><span data-stu-id="bc93f-110">The maximum size of a Long Text or Long Binary column value is 2 GB -1.</span></span>

<span data-ttu-id="bc93f-111">Le moteur ESE prend en charge les opérations d’ajout, de remplacement de plage d’octets et de taille pour les colonnes de valeur longue afin de prendre en charge des implémentations de flux efficaces sur ces types de colonnes.</span><span class="sxs-lookup"><span data-stu-id="bc93f-111">ESE supports append, byte range overwrite, and set size operations for long value columns to support efficient stream implementations on these column types.</span></span> <span data-ttu-id="bc93f-112">Par défaut, les données de valeur long sont stockées dans une arborescence B + distincte si elle est supérieure à 1024 octets, ou si l’enregistrement ne tient pas sur une seule page de base de données lorsque les données de valeur long sont stockées dans l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="bc93f-112">By default, long value data is stored in a separate B+ tree if it is larger than 1024 bytes, or if the record does not fit on a single database page when the long value data is stored in the record.</span></span> <span data-ttu-id="bc93f-113">L’application a la possibilité de remplacer le comportement par défaut en définissant des options pour stocker les données de valeur longue dans l’enregistrement (JET_bitSetIntrinsicLV) ou pour les forcer à les stocker dans l’arborescence B + (JET_bitSetIntrinsicLV) distincte.</span><span class="sxs-lookup"><span data-stu-id="bc93f-113">The application has the option to override the default behavior by setting options to store long value data in the record (JET_bitSetIntrinsicLV) or to force them to be stored in the separate B+ tree (JET_bitSetIntrinsicLV).</span></span> <span data-ttu-id="bc93f-114">Ces valeurs sont définies dans le paramètre *Grbit* dans [JetSetColumn](./jetsetcolumn-function.md), ou le membre **Grbit** [JET_SETCOLUMN](./jet-setcolumn-structure.md) utilisé dans l’appel à [JetSetColumns](./jetsetcolumns-function.md) comme suit :</span><span class="sxs-lookup"><span data-stu-id="bc93f-114">These values are set in the *grbit* parameter in [JetSetColumn](./jetsetcolumn-function.md), or the **grbit** member [JET_SETCOLUMN](./jet-setcolumn-structure.md) used in the call to [JetSetColumns](./jetsetcolumns-function.md) as follows:</span></span>

  - <span data-ttu-id="bc93f-115">Ajouter : (JET_bitSetAppendLV)</span><span class="sxs-lookup"><span data-stu-id="bc93f-115">Append: (JET_bitSetAppendLV)</span></span>

  - <span data-ttu-id="bc93f-116">Remplacement de la plage d’octets : (JET_bitSetOverwriteLV)</span><span class="sxs-lookup"><span data-stu-id="bc93f-116">Byte Range Overwrite: (JET_bitSetOverwriteLV)</span></span>

  - <span data-ttu-id="bc93f-117">Définir la taille : (JET_bitSetSizeLV)</span><span class="sxs-lookup"><span data-stu-id="bc93f-117">Set Size: (JET_bitSetSizeLV)</span></span>

  - <span data-ttu-id="bc93f-118">Forcer la séparation : (JET_bitSetSeparateLV)</span><span class="sxs-lookup"><span data-stu-id="bc93f-118">Force Separate: (JET_bitSetSeparateLV)</span></span>

  - <span data-ttu-id="bc93f-119">Stocker dans l’enregistrement : (JET_bitSetIntrinsicLV)</span><span class="sxs-lookup"><span data-stu-id="bc93f-119">Store In Record: (JET_bitSetIntrinsicLV)</span></span>

<span data-ttu-id="bc93f-120">Les données de valeur long sont définies en indiquant l’offset dans l’objet blob de valeur long et la longueur des données de la valeur de type long dans l’objet BLOB.</span><span class="sxs-lookup"><span data-stu-id="bc93f-120">The long value data is set by indicating the offset into the long value blob, and the length of the long value data in the blob.</span></span> <span data-ttu-id="bc93f-121">Le décalage de l’objet blob de valeur long est défini dans le membre **ibLongValue** de [JET_SETINFO](./jet-setinfo-structure.md) structure (pour [JetSetColumn](./jetsetcolumn-function.md)) ou le membre **IbLongValue** de la structure [JET_SETCOLUMN](./jet-setcolumn-structure.md) (pour [JetSetColumns](./jetsetcolumns-function.md)).</span><span class="sxs-lookup"><span data-stu-id="bc93f-121">The offset to the long value blob is set in the **ibLongValue** member of [JET_SETINFO](./jet-setinfo-structure.md) structure (for [JetSetColumn](./jetsetcolumn-function.md)) or the **ibLongValue** member of the [JET_SETCOLUMN](./jet-setcolumn-structure.md) structure (for [JetSetColumns](./jetsetcolumns-function.md)).</span></span> <span data-ttu-id="bc93f-122">Le membre **pvData** de [JET_SETCOLUMN](./jet-setcolumn-structure.md), et le paramètre *PvData* dans l’appel à [JetSetColumn](./jetsetcolumn-function.md) contient les données de valeur long.</span><span class="sxs-lookup"><span data-stu-id="bc93f-122">The **pvData** member of [JET_SETCOLUMN](./jet-setcolumn-structure.md), and *pvData* parameter in the call to [JetSetColumn](./jetsetcolumn-function.md) contains the long value data.</span></span> <span data-ttu-id="bc93f-123">Les mises à jour des colonnes de valeurs longues doivent être effectuées à l’intérieur d’une transaction.</span><span class="sxs-lookup"><span data-stu-id="bc93f-123">Updates to long value columns must be performed inside a transaction.</span></span>

<span data-ttu-id="bc93f-124">Les données de valeur long sont toujours stockées dans une table distincte lorsque l’application définit la JET_bitSetSeparateLV ou la JET_bitSetIntrinsicLV, sinon elle est décidée de manière heuristique.</span><span class="sxs-lookup"><span data-stu-id="bc93f-124">The long value data is always stored in a separate table is when the application sets the JET_bitSetSeparateLV or JET_bitSetIntrinsicLV, otherwise it is heuristically decided.</span></span> <span data-ttu-id="bc93f-125">Le moteur ESE stocke la valeur long séparée si elle est supérieure à 1024 octets ou si l’enregistrement ne tient pas sur une page de base de données unique si elle est stockée dans l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="bc93f-125">ESE stores the long value separated if it is larger than 1024 bytes or if the record would not fit on a single database page if stored in record.</span></span>

<span data-ttu-id="bc93f-126">Le diagramme suivant montre les données de valeur longue stockées dans une table distincte.</span><span class="sxs-lookup"><span data-stu-id="bc93f-126">The following diagram shows the long value data stored in separate table.</span></span> <span data-ttu-id="bc93f-127">Lorsqu’une valeur long est stockée en dehors de l’enregistrement, un nouvel ID à long terme est créé pour faire référence à sa valeur.</span><span class="sxs-lookup"><span data-stu-id="bc93f-127">When a long value is stored outside the record, a new long valued ID is created to refer to its value.</span></span> <span data-ttu-id="bc93f-128">Cela permet à plusieurs enregistrements de faire référence à la même valeur de colonne.</span><span class="sxs-lookup"><span data-stu-id="bc93f-128">This allows multiple records to refer to the same column value.</span></span> <span data-ttu-id="bc93f-129">Les nombres de références aux données sont augmentés si plus d’un enregistrement dans les données pointe vers les mêmes données de valeur longue.</span><span class="sxs-lookup"><span data-stu-id="bc93f-129">Reference counts to the data are increased if more than one record in the data points to the same long value data.</span></span>

<span data-ttu-id="bc93f-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span><span class="sxs-lookup"><span data-stu-id="bc93f-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span></span>

<span data-ttu-id="bc93f-131">ESE prend également en charge une fonctionnalité de magasin d’instances uniques qui permet à plusieurs enregistrements de référencer le même objet binaire volumineux comme si chaque enregistrement avait sa propre copie des informations. ainsi, vous évitez les copies en double des données de valeur de colonne.</span><span class="sxs-lookup"><span data-stu-id="bc93f-131">ESE also supports a single instance store feature that allows multiple records to reference the same large binary object as though each record had its own copy of the information; thus avoiding duplicate copies of the column value data.</span></span> <span data-ttu-id="bc93f-132">Cette fonctionnalité est activée dans l’appel à [JetPrepareUpdate](./jetprepareupdate-function.md) avec l’option JET_prepInsertCopy définie dans le paramètre *PREP* .</span><span class="sxs-lookup"><span data-stu-id="bc93f-132">This feature is enabled in the call to [JetPrepareUpdate](./jetprepareupdate-function.md) with the JET_prepInsertCopy option set in the *prep* parameter.</span></span>
