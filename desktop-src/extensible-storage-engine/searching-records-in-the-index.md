---
description: 'En savoir plus sur : recherche d’enregistrements dans l’index'
title: Recherche d’enregistrements dans l’index
TOCTitle: Searching Records in the Index
ms:assetid: 9141b1d6-81b6-49ad-a5d4-2409fe0d511a
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269342(v=EXCHG.10)
ms:contentKeyID: 32765631
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 89a4ffe1f1c13280f236442ae218580fa5699741
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106543708"
---
# <a name="searching-records-in-the-index"></a><span data-ttu-id="41261-103">Recherche d’enregistrements dans l’index</span><span class="sxs-lookup"><span data-stu-id="41261-103">Searching Records in the Index</span></span>


<span data-ttu-id="41261-104">_**S’applique à :** Windows | Serveur Windows_</span><span class="sxs-lookup"><span data-stu-id="41261-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="searching-records-in-the-index"></a><span data-ttu-id="41261-105">Recherche d’enregistrements dans l’index</span><span class="sxs-lookup"><span data-stu-id="41261-105">Searching Records in the Index</span></span>

<span data-ttu-id="41261-106">Les clés de recherche sont créées pour rechercher une seule entrée ou un ensemble d’entrées dans un index.</span><span class="sxs-lookup"><span data-stu-id="41261-106">Search keys are created to search for a single entry or a set of entries in an index.</span></span> <span data-ttu-id="41261-107">Les clés de recherche peuvent uniquement être construites pour les colonnes clés de l’index et peuvent contenir une ou plusieurs valeurs de colonne.</span><span class="sxs-lookup"><span data-stu-id="41261-107">Search keys may only be constructed for the key columns in the index, and may contain one or more column values.</span></span> <span data-ttu-id="41261-108">La clé de recherche est construite avec un seul appel ou une série d’appels à [JetMakeKey](./jetmakekey-function.md), et peut être récupérée avec [JetRetrieveKey](./jetretrievekey-function.md) à l’aide de JET_bitRetrieveCopy.</span><span class="sxs-lookup"><span data-stu-id="41261-108">The search key is constructed with a single call or a series of calls to [JetMakeKey](./jetmakekey-function.md), and may be retrieved with [JetRetrieveKey](./jetretrievekey-function.md) using JET_bitRetrieveCopy.</span></span> <span data-ttu-id="41261-109">Une fois la clé de recherche construite, elle peut être utilisée pour déplacer le curseur vers l’enregistrement dans l’index.</span><span class="sxs-lookup"><span data-stu-id="41261-109">After the search key is constructed it can be used to move the cursor to the record in the index.</span></span>

<span data-ttu-id="41261-110">Il existe trois méthodes pour rechercher des enregistrements dans une table :</span><span class="sxs-lookup"><span data-stu-id="41261-110">There are three methods of finding records in a table:</span></span>

1.  <span data-ttu-id="41261-111">Recherchez une seule entrée d’index.</span><span class="sxs-lookup"><span data-stu-id="41261-111">Search for a single index entry.</span></span> <span data-ttu-id="41261-112">Pour ce faire, créez la clé de recherche avec [JetMakeKey](./jetmakekey-function.md), puis accédez à cet enregistrement avec [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-112">To do this, create the search key with [JetMakeKey](./jetmakekey-function.md), and then move to that record with [JetSeek](./jetseek-function.md).</span></span>

2.  <span data-ttu-id="41261-113">Rechercher l’index enregistrement par enregistrement.</span><span class="sxs-lookup"><span data-stu-id="41261-113">Search the index record-by-record.</span></span> <span data-ttu-id="41261-114">Les enregistrements peuvent parcourir un enregistrement à la fois en appelant [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-114">Records can be traversed one record at a time by calling [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="41261-115">Le curseur peut être déplacé vers le premier enregistrement de l’index en spécifiant JET_MoveFirst dans le paramètre *cRow* de [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-115">The cursor can be moved to the first record in the index by specifying JET_MoveFirst in the *cRow* parameter of [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="41261-116">De la même façon, le curseur peut être déplacé vers l’avant, vers l’arrière ou vers la dernière entrée de l’index.</span><span class="sxs-lookup"><span data-stu-id="41261-116">In the same way, the cursor can be moved forward, backward, or to the last entry in the index.</span></span>

3.  <span data-ttu-id="41261-117">Effectuer une recherche dans un jeu d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="41261-117">Search through a set of records.</span></span> <span data-ttu-id="41261-118">Pour ce faire, définissez une plage d’entrées d’index à rechercher, puis parcourez les enregistrements de manière séquentielle.</span><span class="sxs-lookup"><span data-stu-id="41261-118">To do this, set a range of index entries to search, then move through the records sequentially.</span></span> <span data-ttu-id="41261-119">Pour plus d’informations, consultez [la section recherche dans une série d’enregistrements]() de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="41261-119">For more information, see [Searching Through a Set of Records]() section of this topic.</span></span>

### <a name="searching-through-a-set-of-records"></a><span data-ttu-id="41261-120">Recherche dans un ensemble d’enregistrements</span><span class="sxs-lookup"><span data-stu-id="41261-120">Searching Through a Set of Records</span></span>

<span data-ttu-id="41261-121">Le diagramme ci-dessous illustre le déplacement du curseur dans une plage d’entrées d’index définies par des appels à [JetSeek](./jetseek-function.md) et [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-121">The diagram here shows the cursor moving through a range of index entries defined by calls to [JetSeek](./jetseek-function.md) and [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>

<span data-ttu-id="41261-122">Utilisez la procédure suivante pour effectuer une recherche dans un jeu d’enregistrements dans un index.</span><span class="sxs-lookup"><span data-stu-id="41261-122">Use the following procedure to search through a set of records in an index.</span></span>

### <a name="to-search-a-set-of-records-in-an-index"></a><span data-ttu-id="41261-123">Pour rechercher un jeu d’enregistrements dans un index</span><span class="sxs-lookup"><span data-stu-id="41261-123">To search a set of records in an index</span></span>

1.  <span data-ttu-id="41261-124">Créez la clé de recherche pour le premier enregistrement dans le jeu d’enregistrements à rechercher avec [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-124">Create the search key for the first record in the set of records to be searched with [JetMakeKey](./jetmakekey-function.md).</span></span>

2.  <span data-ttu-id="41261-125">Déplacez le curseur vers l’enregistrement indiqué dans la clé de recherche avec [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-125">Move the cursor to the record indicated in the search key with [JetSeek](./jetseek-function.md).</span></span>

3.  <span data-ttu-id="41261-126">Créez une autre clé de recherche pour la dernière entrée d’index de la plage avec [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-126">Create another search key for the last index entry in the range with [JetMakeKey](./jetmakekey-function.md).</span></span>

4.  <span data-ttu-id="41261-127">Définissez la plage d’index avec [JetSetIndexRange](./jetsetindexrange-function.md) à l’aide de la clé créée à l’étape 3.</span><span class="sxs-lookup"><span data-stu-id="41261-127">Set the index range with [JetSetIndexRange](./jetsetindexrange-function.md) using the key created in step 3.</span></span>

5.  <span data-ttu-id="41261-128">Appelez [JetMove](./jetmove-function.md) pour vous déplacer de façon séquentielle dans chaque enregistrement de la plage d’index, comme indiqué dans le diagramme suivant.</span><span class="sxs-lookup"><span data-stu-id="41261-128">Call [JetMove](./jetmove-function.md) to move sequentially through each record in the index range as shown in the following diagram.</span></span>

<span data-ttu-id="41261-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span><span class="sxs-lookup"><span data-stu-id="41261-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span></span>

<span data-ttu-id="41261-130">Le curseur dans le diagramme ici peut uniquement se déplacer dans la plage d’index définie dans l’appel à [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-130">The cursor in the diagram here may only move through the range of indices set in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span> <span data-ttu-id="41261-131">Si l’application tente de déplacer le curseur au-delà de la plage d’index, ESE renvoie une erreur Jet_errNoCurrentRecord à partir de l’appel à [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-131">If the application attempts to move the cursor beyond the index range, ESE returns a Jet_errNoCurrentRecord error from the call to [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="41261-132">Notez que tout type de navigation avec ce curseur autre que le déplacement vers l’enregistrement suivant ou précédent annulera la plage d’index.</span><span class="sxs-lookup"><span data-stu-id="41261-132">Note that any type of navigation with this cursor other than moving to the next or previous record will cancel the index range.</span></span> <span data-ttu-id="41261-133">Pour plus d’informations, consultez [JetSetIndexRange](./jetsetindexrange-function.md) .</span><span class="sxs-lookup"><span data-stu-id="41261-133">See [JetSetIndexRange](./jetsetindexrange-function.md) for more information.</span></span>

<span data-ttu-id="41261-134">Le type de données entré dans le paramètre *pvData* pour [JetMakeKey](./jetmakekey-function.md) doit correspondre au type de données et aux propriétés spécifiées pour la colonne.</span><span class="sxs-lookup"><span data-stu-id="41261-134">The type of data entered in the *pvData* parameter for [JetMakeKey](./jetmakekey-function.md) must match the type of data and properties specified for the column.</span></span> <span data-ttu-id="41261-135">Par exemple, l’appel de [JetMakeKey](./jetmakekey-function.md) avec « Ben Miller » spécifié dans le paramètre *pvData* pour un type de colonne JET_coltypText est une correspondance de type de données valide.</span><span class="sxs-lookup"><span data-stu-id="41261-135">For example, calling [JetMakeKey](./jetmakekey-function.md) with "Ben Miller" specified in the *pvData* parameter for a column type JET_coltypText is a valid data type match.</span></span> <span data-ttu-id="41261-136">Si vous souhaitez créer une clé de recherche pour effectuer une recherche entre les noms « Olivier Miller » et « Max Stevens » dans un index, déplacez le curseur vers l’enregistrement portant le nom « Olivier Miller » en appelant [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-136">If you want to create a search key to search between the names "Ben Miller" and "Max Stevens" in an index, move the cursor to the record with the name "Ben Miller" by calling [JetSeek](./jetseek-function.md).</span></span> <span data-ttu-id="41261-137">Appelez [JetMakeKey](./jetmakekey-function.md) une deuxième fois et spécifiez un pointeur vers une chaîne contenant le nom « Max Stevens ».</span><span class="sxs-lookup"><span data-stu-id="41261-137">Call [JetMakeKey](./jetmakekey-function.md) a second time and specify a pointer to a string containing the name "Max Stevens".</span></span> <span data-ttu-id="41261-138">La plage d’index est définie pour limiter le curseur à déplacer entre les noms « Olivier Miller » et « Max Stevens » dans l’appel à [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="41261-138">The index range is set to limit the cursor to move between the names "Ben Miller" and "Max Stevens" in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>
