---
description: 'En savoir plus sur : création de bases de données'
title: Création de bases de données
TOCTitle: Creating Databases
ms:assetid: d221144d-f777-4f8a-80ca-2ebdb77108dc
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294100(v=EXCHG.10)
ms:contentKeyID: 32765715
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eac708b64837fc79fa8a5060df7deb93ec552e49
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106534377"
---
# <a name="creating-databases"></a><span data-ttu-id="a2073-103">Création de bases de données</span><span class="sxs-lookup"><span data-stu-id="a2073-103">Creating Databases</span></span>


<span data-ttu-id="a2073-104">_**S’applique à :** Windows | Serveur Windows_</span><span class="sxs-lookup"><span data-stu-id="a2073-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="creating-databases"></a><span data-ttu-id="a2073-105">Création de bases de données</span><span class="sxs-lookup"><span data-stu-id="a2073-105">Creating Databases</span></span>

<span data-ttu-id="a2073-106">La base de données ESE comprend une ou plusieurs tables qui organisent les données par colonnes et par lignes.</span><span class="sxs-lookup"><span data-stu-id="a2073-106">The ESE database comprises one or more tables that organize data by columns and rows.</span></span> <span data-ttu-id="a2073-107">La base de données ESE est identifiée par le nom et l’ID de base de données.</span><span class="sxs-lookup"><span data-stu-id="a2073-107">The ESE database is identified by name and database ID.</span></span> <span data-ttu-id="a2073-108">Une base de données ESE ressemble à un fichier unique pour le système d’exploitation Microsoft Windows. Toutefois, en interne, la base de données est stockée sous la forme d’une collection de pages.</span><span class="sxs-lookup"><span data-stu-id="a2073-108">An ESE database looks like a single file to the Microsoft Windows operating system; however, internally the database is stored as a collection of pages.</span></span> <span data-ttu-id="a2073-109">Ces pages contiennent des métadonnées qui décrivent les données de la base de données, les données elles-mêmes et un ou plusieurs index qui stockent différentes commandes des données.</span><span class="sxs-lookup"><span data-stu-id="a2073-109">These pages contain metadata that describe the data in the database, the data itself, and one or more indices that store different orders of the data.</span></span> <span data-ttu-id="a2073-110">La base de données peut contenir jusqu’à 2 ^ 31 pages, ou 16 téraoctets de données pour une base de données avec des pages de 8 Ko.</span><span class="sxs-lookup"><span data-stu-id="a2073-110">The database may contain up to 2^31 pages, or 16 Terabytes of data for a database with 8 KB pages.</span></span>

<span data-ttu-id="a2073-111">L’application crée une instance du moteur de base de données, puis crée une base de données et l’attache à l’instance.</span><span class="sxs-lookup"><span data-stu-id="a2073-111">The application creates an instance of the database engine, then creates a database and attaches it to the instance.</span></span> <span data-ttu-id="a2073-112">Jusqu’à 6 bases de données peuvent être connectées simultanément à une instance avec [JetCreateDatabase](./jetcreatedatabase-function.md) ou [JetAttachDatabase](./jetattachdatabase-function.md).</span><span class="sxs-lookup"><span data-stu-id="a2073-112">Up to 6 databases can be simultaneously attached to an instance with [JetCreateDatabase](./jetcreatedatabase-function.md) or [JetAttachDatabase](./jetattachdatabase-function.md).</span></span> <span data-ttu-id="a2073-113">Une ou plusieurs sessions doivent être démarrées dans la base de données, car toutes les opérations ESE suivantes sont effectuées dans le contexte d’une session.</span><span class="sxs-lookup"><span data-stu-id="a2073-113">One or more sessions should be started within the database, because all subsequent ESE operations are performed in the context of a session.</span></span> <span data-ttu-id="a2073-114">Une session distincte doit être ouverte pour chaque thread à l’aide de ESE.</span><span class="sxs-lookup"><span data-stu-id="a2073-114">A separate session should be opened for each thread using ESE.</span></span>

<span data-ttu-id="a2073-115">Cette procédure permet d’initialiser le moteur ESE et de créer une base de données.</span><span class="sxs-lookup"><span data-stu-id="a2073-115">This procedure will initialize ESE and create a database.</span></span>

### <a name="to-initialize-ese-and-create-a-database"></a><span data-ttu-id="a2073-116">Pour initialiser ESE et créer une base de données</span><span class="sxs-lookup"><span data-stu-id="a2073-116">To initialize ESE and create a database</span></span>

1.  <span data-ttu-id="a2073-117">[JetCreateInstance](./jetcreateinstance-function.md): crée une instance du moteur de base de données.</span><span class="sxs-lookup"><span data-stu-id="a2073-117">[JetCreateInstance](./jetcreateinstance-function.md): Creates an instance of the database engine.</span></span>
    
    <span data-ttu-id="a2073-118">**Windows XP et versions ultérieures :** Cette fonction est disponible dans Windows XP et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="a2073-118">**Windows XP and later:** This function is available in Windows XP and later.</span></span> <span data-ttu-id="a2073-119">Sur Windows 2000, une seule instance est prise en charge et cette instance est créée implicitement</span><span class="sxs-lookup"><span data-stu-id="a2073-119">On Windows 2000, only one instance is supported and that instance is created implicitly</span></span>

2.  <span data-ttu-id="a2073-120">[JetSetSystemParameter](./jetsetsystemparameter-function.md): les paramètres système qui affectent la disposition physique, tels que les JET_paramLogFilePath et JET_paramSystemPath doivent être définis avant d’initialiser l’instance avec [JetInit](./jetinit-function.md).</span><span class="sxs-lookup"><span data-stu-id="a2073-120">[JetSetSystemParameter](./jetsetsystemparameter-function.md): System parameters that the affect the physical layout such as the JET_paramLogFilePath and JET_paramSystemPath must be set before initializing the instance with [JetInit](./jetinit-function.md).</span></span> <span data-ttu-id="a2073-121">Les paramètres définis à cette étape sont définis pour toutes les bases de données créées dans l’instance.</span><span class="sxs-lookup"><span data-stu-id="a2073-121">The parameters set at this stage are set for all databases created in the instance.</span></span> <span data-ttu-id="a2073-122">[JetSetSystemParameter](./jetsetsystemparameter-function.md) est la seule fonction qui peut utiliser l’instance avant qu’elle ne soit initialisée avec [JetInit](./jetinit-function.md).</span><span class="sxs-lookup"><span data-stu-id="a2073-122">[JetSetSystemParameter](./jetsetsystemparameter-function.md) is the only function that can use the instance before it is initialized with [JetInit](./jetinit-function.md).</span></span>

3.  <span data-ttu-id="a2073-123">[JetInit](./jetinit-function.md): Initialise l’instance.</span><span class="sxs-lookup"><span data-stu-id="a2073-123">[JetInit](./jetinit-function.md): Initializes the instance.</span></span> <span data-ttu-id="a2073-124">L’instance doit être initialisée avec [JetInit](./jetinit-function.md) pour pouvoir être utilisée avec d’autres fonctions.</span><span class="sxs-lookup"><span data-stu-id="a2073-124">Instance must be initialized with [JetInit](./jetinit-function.md) before it can be used with any other functions.</span></span>

4.  <span data-ttu-id="a2073-125">[JetBeginSession](./jetbeginsession-function.md): crée la session pour toutes les transactions suivantes.</span><span class="sxs-lookup"><span data-stu-id="a2073-125">[JetBeginSession](./jetbeginsession-function.md): Creates the session for all subsequent transactions.</span></span> <span data-ttu-id="a2073-126">Toutes les transactions de base de données ont lieu dans le contexte de la session ([JET_SESID](./jet-sesid.md)).</span><span class="sxs-lookup"><span data-stu-id="a2073-126">All database transactions take place in the context of the session ([JET_SESID](./jet-sesid.md)).</span></span>

5.  <span data-ttu-id="a2073-127">[JetCreateDatabase](./jetcreatedatabase-function.md): crée la base de données et retourne un descripteur à l’ID de base de données ([JET_DBID](./jet-dbid.md)).</span><span class="sxs-lookup"><span data-stu-id="a2073-127">[JetCreateDatabase](./jetcreatedatabase-function.md): Creates the database and returns a handle to the database ID ([JET_DBID](./jet-dbid.md)).</span></span>
    
    <span data-ttu-id="a2073-128">Si la base de données existe déjà, l’étape 5 ci-dessus est remplacée par les deux étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="a2073-128">If the database already exists, step 5 above is replaced by the following two steps:</span></span>
    
    1.  <span data-ttu-id="a2073-129">[JetAttachDatabase](./jetattachdatabase-function.md): attache la base de données par son nom à la session</span><span class="sxs-lookup"><span data-stu-id="a2073-129">[JetAttachDatabase](./jetattachdatabase-function.md): Attaches the database by name to the session</span></span>
    
    2.  <span data-ttu-id="a2073-130">[JetOpenDatabase](./jetopendatabase-function.md): retourne l’ID de base de données utilisé dans les opérations de base de données suivantes.</span><span class="sxs-lookup"><span data-stu-id="a2073-130">[JetOpenDatabase](./jetopendatabase-function.md): Returns the database ID that is used in subsequent database operations.</span></span>

<span data-ttu-id="a2073-131">Une base de données peut être détachée d’une instance ESE à l’aide de [JetDetachDatabase](./jetdetachdatabase-function.md) et d’une version ultérieure attachée à une autre instance avec [JetAttachDatabase](./jetattachdatabase-function.md).</span><span class="sxs-lookup"><span data-stu-id="a2073-131">A database can be detached from one ESE instance using [JetDetachDatabase](./jetdetachdatabase-function.md) and later attached to another instance with [JetAttachDatabase](./jetattachdatabase-function.md).</span></span> <span data-ttu-id="a2073-132">Lorsque la base de données est détachée, elle peut être copiée sous la forme d’un fichier unique à l’aide des utilitaires Windows standard.</span><span class="sxs-lookup"><span data-stu-id="a2073-132">When the database is detached, it can be copied as a single file using standard Windows utilities.</span></span> <span data-ttu-id="a2073-133">Toutefois, lorsque la base de données est attachée à une instance ESE, elle ne peut pas être copiée, car ESE ouvre les fichiers de base de données en mode exclusif.</span><span class="sxs-lookup"><span data-stu-id="a2073-133">However, when the database is attached to an ESE instance it cannot be copied since ESE opens database files exclusively.</span></span> <span data-ttu-id="a2073-134">En outre, si l’instance se bloque, le fichier de base de données ne peut pas être copié seul parce qu’il a besoin des fichiers journaux des transactions qui lui sont associés pour récupérer à partir de ce blocage.</span><span class="sxs-lookup"><span data-stu-id="a2073-134">Also, if the instance crashes then the database file cannot be copied alone because it needs the transaction log files associated with it to recover from that crash.</span></span>
