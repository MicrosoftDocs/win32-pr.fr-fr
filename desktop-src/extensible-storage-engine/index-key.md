---
description: 'En savoir plus sur : clé d’index'
title: Clé d’index
TOCTitle: Index Key
ms:assetid: 104bdb1c-71ac-44f4-bbda-c553131aaad4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269188(v=EXCHG.10)
ms:contentKeyID: 32765491
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eff0812f363fa83d133ab087140d415d8e2dbad3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104570202"
---
# <a name="index-key"></a><span data-ttu-id="3ebcc-103">Clé d’index</span><span class="sxs-lookup"><span data-stu-id="3ebcc-103">Index Key</span></span>


<span data-ttu-id="3ebcc-104">_**S’applique à :** Windows | Serveur Windows_</span><span class="sxs-lookup"><span data-stu-id="3ebcc-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="index-key"></a><span data-ttu-id="3ebcc-105">Clé d’index</span><span class="sxs-lookup"><span data-stu-id="3ebcc-105">Index Key</span></span>

<span data-ttu-id="3ebcc-106">Un index est créé sur les données de la table avec [JetCreateIndex](./jetcreateindex-function.md) ou il est possible de créer plusieurs index simultanément avec [JetCreateIndex2](./jetcreateindex2-function.md) à l’aide de la structure [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="3ebcc-106">An index is created over data in the table with [JetCreateIndex](./jetcreateindex-function.md) or multiple indexes may be created simultaneously with [JetCreateIndex2](./jetcreateindex2-function.md) using the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="3ebcc-107">L’index est défini en termes de tableau de colonnes, dans l’ordre de priorité.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-107">The index is defined in terms of an array of columns, in precedence order.</span></span> <span data-ttu-id="3ebcc-108">Ce tableau de colonnes est également appelé clé d’index.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-108">This array of columns is also called the index key.</span></span> <span data-ttu-id="3ebcc-109">La clé d’index peut être définie comme index primaire lorsque l’option JET_bitIndexPrimary est définie dans le paramètre *Grbit* de [JetCreateIndex](./jetcreateindex-function.md) ou [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span><span class="sxs-lookup"><span data-stu-id="3ebcc-109">The index key may be defined as the primary index when the JET_bitIndexPrimary option is set in the *grbit* parameter of [JetCreateIndex](./jetcreateindex-function.md) or [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span></span> <span data-ttu-id="3ebcc-110">La clé d’index est une chaîne terminée par le caractère null de jetons se terminant par null, comme indiqué dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="3ebcc-110">The index key is a null terminated string of null terminated tokens as shown in the following example:</span></span>

<span data-ttu-id="3ebcc-111">\+Col1 \\ 0-col2 \\ 0 + COL3 \\ 0 \\ 0</span><span class="sxs-lookup"><span data-stu-id="3ebcc-111">\+Col1\\0-Col2\\0+Col3\\0\\0</span></span>

<span data-ttu-id="3ebcc-112">La clé de l’exemple peut être utilisée pour créer un index sur trois colonnes de la table.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-112">The key in the example may be used to create an index over three columns in the table.</span></span> <span data-ttu-id="3ebcc-113">Chaque colonne spécifiée dans l’index est appelée « segment d’index » ou « colonne clé ».</span><span class="sxs-lookup"><span data-stu-id="3ebcc-113">Each column specified in the index is referred to as the "index segment" or "key column".</span></span> <span data-ttu-id="3ebcc-114">Le segment d’index peut être croissant ou décroissant en termes de contribution à la commande.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-114">The index segment may be either ascending or descending in terms of its ordering contribution.</span></span> <span data-ttu-id="3ebcc-115">Dans l’exemple ci-dessus, le nom de la première colonne de l’index est col1.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-115">In the example above, the name of the first column in the index is Col1.</span></span> <span data-ttu-id="3ebcc-116">Le signe + indique que col1 est indexé dans l’ordre croissant.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-116">The + indicates that Col1 is indexed in ascending order.</span></span> <span data-ttu-id="3ebcc-117">La clause – Before col2 indique qu’elle est indexée dans l’ordre décroissant.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-117">The – before Col2 indicates that it is indexed in descending order.</span></span>

<span data-ttu-id="3ebcc-118">Lorsque des colonnes conditionnelles sont présentes dans l’index, la structure [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) est utilisée pour indiquer la façon dont elles sont indexées.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-118">When conditional columns are present in the index, the [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) structure is used to indicate how they are indexed.</span></span> <span data-ttu-id="3ebcc-119">Une colonne conditionnelle peut être utilisée pour contrôler la présence ou l’absence d’une entrée d’index dans un index en fonction de la valeur dans la colonne conditionnelle correspondante sans affecter l’ordre de tri de l’index.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-119">A conditional column may be used to control the presence or absence of an index entry in an index based on the value in the corresponding conditional column without affecting the sort order of the index.</span></span> <span data-ttu-id="3ebcc-120">Une colonne conditionnelle peut inclure ou exclure une entrée d’index de l’index si la valeur de cette colonne conditionnelle est NULL pour l’enregistrement correspondant.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-120">A conditional column may include or exclude an index entry from the index if the value of that conditional column is NULL for the corresponding record.</span></span>

<span data-ttu-id="3ebcc-121">Par défaut, la taille maximale de la clé d’index est donnée par la constante JET_cbKeyMost qui a toujours été 255 octets de données normalisées (octets de données, y compris la charge de l’indexation).</span><span class="sxs-lookup"><span data-stu-id="3ebcc-121">By default, the maximum size of the index key is given by the JET_cbKeyMost constant which has always been 255 bytes of normalized data (bytes of data including the indexing overhead).</span></span> <span data-ttu-id="3ebcc-122">À compter de Windows Vista, la taille maximale de la clé d’index peut être définie avec la structure [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="3ebcc-122">Starting with Windows Vista, the maximum size of the index key can be set with the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="3ebcc-123">La taille maximale de la clé d’index correspond à la taille de la page de la base de données.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-123">The maximum size of the index key corresponds to the database page size.</span></span> <span data-ttu-id="3ebcc-124">Pour activer une taille de clé maximale personnalisée, spécifiez l’option Jet_bitIndexKeyMost dans le membre grbits de [JET_INDEXCREATE](./jet-indexcreate-structure.md)et définissez le membre **cbKeyMost** sur l’une des valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="3ebcc-124">To enable a custom maximum key size, specify the Jet_bitIndexKeyMost option in the grbits member of [JET_INDEXCREATE](./jet-indexcreate-structure.md), and set the **cbKeyMost** member to one of the following values:</span></span>

  - <span data-ttu-id="3ebcc-125">JET_cbKeyMost2KBytePage : lorsque la taille de la page de la base de données est de 2048 octets, la taille maximale de la clé d’index peut être comprise entre 255 octets minimum et 500 octets au maximum.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-125">JET_cbKeyMost2KBytePage: When the database page size is 2048 bytes, the maximum index key size can be between 255 bytes minimum, and 500 bytes maximum.</span></span>

  - <span data-ttu-id="3ebcc-126">JET_cbKeyMost4KBytePage : lorsque la taille de la page de la base de données est de 4096 octets, la taille maximale de la clé d’index peut être comprise entre 255 octets minimum et 1000 octets au maximum.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-126">JET_cbKeyMost4KBytePage: When the database page size is 4096 bytes, the maximum index key size can be between 255 bytes minimum, and 1000 bytes maximum.</span></span>

  - <span data-ttu-id="3ebcc-127">JET_cbKeyMost8KBytePage : lorsque la taille de la page de la base de données est de 8196 octets, la taille maximale de la clé d’index peut être comprise entre 255 octets minimum et 2000 octets au maximum.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-127">JET_cbKeyMost8KBytePage: When the database page size is 8196 bytes, the maximum index key size can be between 255 bytes minimum, and 2000 bytes maximum.</span></span>

<span data-ttu-id="3ebcc-128">L’exemple indiqué dans le diagramme ci-dessous montre une table contenant des informations sur les employés.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-128">The example in the diagram below shows a table containing employee information.</span></span> <span data-ttu-id="3ebcc-129">La table comporte 6 colonnes, chacune définissant un attribut d’employé spécifique.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-129">The table has 6 columns, each defining a specific employee attribute.</span></span> <span data-ttu-id="3ebcc-130">Un enregistrement de la table contient des valeurs pour un employé, telles que le nom de l’employé dans la colonne 1 et l’ID de l’employé dans la colonne 2.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-130">A record in the table contains values for an employee, such as the employee name in column 1 and employee ID in column 2.</span></span> <span data-ttu-id="3ebcc-131">Un index primaire créé pour cette table organise les données en fonction du nom d’employé en premier, et l’ID d’employé en second.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-131">A primary index created for this table organizes the data according to the employee name first, and the employee ID second.</span></span> <span data-ttu-id="3ebcc-132">Le nom et l’ID sont indexés dans l’ordre croissant.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-132">Both name and ID are indexed in ascending order.</span></span> <span data-ttu-id="3ebcc-133">Par exemple, un enregistrement contenant le nom Johnson et l’ID d’employé 12345 est listé avant un enregistrement avec le nom d’employé Jones et l’ID 10000.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-133">For example, a record containing the name Johnson and employee ID 12345 will be listed before of a record with an employee name Jones and an ID of 10000.</span></span> <span data-ttu-id="3ebcc-134">Tous les enregistrements pour Jones sont stockés ensemble dans la table, avec leurs ID d’employé dans l’ordre croissant, comme indiqué dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-134">All the records for Jones are stored together in the table, with their employee IDs in ascending order as shown in the table.</span></span>

<span data-ttu-id="3ebcc-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span><span class="sxs-lookup"><span data-stu-id="3ebcc-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span></span>

<span data-ttu-id="3ebcc-136">La clé de l’index primaire doit être unique, mais les clés de l’index secondaire peuvent être des doublons.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-136">The key in the primary index must be unique, but the keys in the secondary index can be duplicates.</span></span> <span data-ttu-id="3ebcc-137">Par exemple, si un index est créé sur le nom de famille et qu’il y a deux personnes avec Stevens dans la base de données, ESE renvoie une erreur Jet_errKeyDuplicate à partir de [JetUpdate](./jetupdate-function.md) ou [JetUpdate2](./jetupdate2-function.md), lorsque l’application tente d’insérer le deuxième « Stevens ».</span><span class="sxs-lookup"><span data-stu-id="3ebcc-137">For example, if an index is created over last name, and there are two people with Stevens in the database, ESE returns a Jet_errKeyDuplicate error from [JetUpdate](./jetupdate-function.md) or [JetUpdate2](./jetupdate2-function.md), when the application attempts to insert the second "Stevens".</span></span> <span data-ttu-id="3ebcc-138">Lorsque la clé réelle est supérieure à la taille de clé maximale, la clé est tronquée.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-138">When the actual key is larger than the maximum key size, the key is truncated.</span></span> <span data-ttu-id="3ebcc-139">Les effets de troncation clés de recherche et d’unicité et doivent être gérés par l’application.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-139">Key truncation effects searching and uniqueness and should be managed by the application.</span></span> <span data-ttu-id="3ebcc-140">Par exemple, si « Stevens » et « Stevenson » ont été stockés dans un index sur le nom de famille et que la taille maximale de la clé était trop petite pour stocker la partie « on » de « Stevenson », alors le moteur de base de données déclare que « Stevens » et « Stevenson » sont des doublons, même si ce n’est pas le cas.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-140">For example, if "Stevens" and "Stevenson" were stored in an index over last name and the max key size were too small to store the "on" portion of "Stevenson" then key truncation would result in the database engine declaring that "Stevens" and "Stevenson" are duplicates even though they are not.</span></span> <span data-ttu-id="3ebcc-141">L’application doit être préparée à gérer les cas de ce type lors de la recherche et de la mise à jour si la définition d’index et les valeurs de colonne qu’elle indexe sont telles que la troncation de clé est une possibilité.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-141">The application must be prepared to handle cases like this during search and update if the index definition and the column values it indexes are such that key truncation is a possibility.</span></span> <span data-ttu-id="3ebcc-142">À compter de Windows Vista, les applications peuvent spécifier l’option Jet_bitIndexDisallowTruncation dans [JET_INDEXCREATE](./jet-indexcreate-structure.md) ou [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="3ebcc-142">Starting in Windows Vista, applications can specify the Jet_bitIndexDisallowTruncation option in [JET_INDEXCREATE](./jet-indexcreate-structure.md) or [JetMakeKey](./jetmakekey-function.md).</span></span> <span data-ttu-id="3ebcc-143">Si vous spécifiez cet indicateur, toute mise à jour de l’index entraînant l’échec d’une clé tronquée avec JET_errKeyTruncated.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-143">Specifying this flag will cause any update to the index that would result in a truncated key to fail with JET_errKeyTruncated.</span></span> <span data-ttu-id="3ebcc-144">Dans le cas contraire, les clés sont tronquées en mode silencieux.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-144">Otherwise, keys will be silently truncated.</span></span> <span data-ttu-id="3ebcc-145">Cela permettra à l’application de fonctionner sans problème pour les artefacts provoqués par la troncation de clé précédemment décrite.</span><span class="sxs-lookup"><span data-stu-id="3ebcc-145">This will allow the application to function without concern for the artifacts caused by key truncation that were previously described.</span></span>
