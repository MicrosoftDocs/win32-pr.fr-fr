---
description: Cet article présente les meilleures pratiques et les questions fréquemment posées sur la création et l’inscription de gestionnaires de propriétés pour fonctionner avec le système de propriétés Windows.
ms.assetid: E583A00B-F615-41c8-AECF-061F1396DB9A
title: Meilleures pratiques pour le gestionnaire de propriétés et FAQ
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5605c39f1021fcfe91259405bb99f8981510d3dc
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/19/2021
ms.locfileid: "112405952"
---
# <a name="property-handler-best-practices-and-faq"></a><span data-ttu-id="96e94-103">Meilleures pratiques pour le gestionnaire de propriétés et FAQ</span><span class="sxs-lookup"><span data-stu-id="96e94-103">Property Handler Best Practices and FAQ</span></span>

<span data-ttu-id="96e94-104">Cette rubrique explique comment créer et inscrire des gestionnaires de propriétés pour utiliser le système de propriétés Windows.</span><span class="sxs-lookup"><span data-stu-id="96e94-104">This topic explains how to create and register property handlers to work with the Windows property system.</span></span>

<span data-ttu-id="96e94-105">Cette rubrique est organisée comme suit :</span><span class="sxs-lookup"><span data-stu-id="96e94-105">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="96e94-106">Bonnes pratiques</span><span class="sxs-lookup"><span data-stu-id="96e94-106">Best Practices</span></span>](#property-handler-best-practices-and-faq)
    -   [<span data-ttu-id="96e94-107">Remplacement des propriétés du système de fichiers</span><span class="sxs-lookup"><span data-stu-id="96e94-107">Overriding File System Properties</span></span>](#overriding-file-system-properties)
    -   [<span data-ttu-id="96e94-108">Stockage des propriétés dans des formats de fichier XML</span><span class="sxs-lookup"><span data-stu-id="96e94-108">Storing Properties in XML-based File Formats</span></span>](#storing-properties-in-xml-based-file-formats)
    -   [<span data-ttu-id="96e94-109">Propriétés calculées</span><span class="sxs-lookup"><span data-stu-id="96e94-109">Computed Properties</span></span>](#computed-properties)
-   [<span data-ttu-id="96e94-110">Questions fréquentes (FAQ)</span><span class="sxs-lookup"><span data-stu-id="96e94-110">Frequently Asked Questions</span></span>](#property-handler-best-practices-and-faq)
-   [<span data-ttu-id="96e94-111">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="96e94-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="96e94-112">Bonnes pratiques</span><span class="sxs-lookup"><span data-stu-id="96e94-112">Best Practices</span></span>

<span data-ttu-id="96e94-113">Les meilleures pratiques présentées ici fournissent des conseils d’implémentation utiles.</span><span class="sxs-lookup"><span data-stu-id="96e94-113">The best practices outlined here provide useful implementation tips.</span></span>

### <a name="overriding-file-system-properties"></a><span data-ttu-id="96e94-114">Remplacement des propriétés du système de fichiers</span><span class="sxs-lookup"><span data-stu-id="96e94-114">Overriding File System Properties</span></span>

<span data-ttu-id="96e94-115">Certaines propriétés des fichiers sont fournies par la source de données du système de fichiers, par exemple :</span><span class="sxs-lookup"><span data-stu-id="96e94-115">Some properties for files are provided by the file system data source, such as:</span></span>

-   <span data-ttu-id="96e94-116">\_Nom du fichier</span><span class="sxs-lookup"><span data-stu-id="96e94-116">PKEY\_FileName</span></span>
-   <span data-ttu-id="96e94-117">Extension de la de la de la \_</span><span class="sxs-lookup"><span data-stu-id="96e94-117">PKEY\_Extension</span></span>
-   <span data-ttu-id="96e94-118">ModifiedTime de la \_</span><span class="sxs-lookup"><span data-stu-id="96e94-118">PKEY\_ModifiedTime</span></span>

<span data-ttu-id="96e94-119">En général, les gestionnaires de propriétés ne peuvent pas fournir de valeurs pour ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="96e94-119">In general, property handlers cannot provide values for these properties.</span></span> <span data-ttu-id="96e94-120">Toutefois, dans certains cas, ces propriétés peuvent être remplacées en fonction des informations d’inscription fournies par le gestionnaire de propriétés.</span><span class="sxs-lookup"><span data-stu-id="96e94-120">However, in some cases these properties can be overridden based on registration information provided by the property handler.</span></span> <span data-ttu-id="96e94-121">Les gestionnaires de propriétés remplissent les **\_ classes HKEY \_ racine** \\ **CLSID** \\ *{handler CLSID}* \\ **OverrideFileSystemProperties** avec les noms des propriétés qu’ils souhaitent substituer.</span><span class="sxs-lookup"><span data-stu-id="96e94-121">Property handlers populate **HKEY\_CLASSES\_ROOT**\\**CLSID**\\ *{handler clsid}*\\**OverrideFileSystemProperties** with the names of properties that they want to override.</span></span> <span data-ttu-id="96e94-122">Cela se limite à un ensemble fixe de propriétés présentées dans la liste suivante, dont le système a connaissance.</span><span class="sxs-lookup"><span data-stu-id="96e94-122">This is limited to a fixed set of properties shown in the following list of which the system has knowledge.</span></span>

<span data-ttu-id="96e94-123">La substitution est prise en charge pour les valeurs de propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="96e94-123">Overriding is supported for the following property values:</span></span>

-   [<span data-ttu-id="96e94-124">System. Kind</span><span class="sxs-lookup"><span data-stu-id="96e94-124">System.Kind</span></span>](./props-system-kind.md)
-   [<span data-ttu-id="96e94-125">System. FileName</span><span class="sxs-lookup"><span data-stu-id="96e94-125">System.FileName</span></span>](./props-system-filename.md)
-   [<span data-ttu-id="96e94-126">System. IsPinnedToNameSpaceTree</span><span class="sxs-lookup"><span data-stu-id="96e94-126">System.IsPinnedToNameSpaceTree</span></span>](./props-system-ispinnedtonamespacetree.md)
-   [<span data-ttu-id="96e94-127">System.ItemNameDisplay</span><span class="sxs-lookup"><span data-stu-id="96e94-127">System.ItemNameDisplay</span></span>](./props-system-itemnamedisplay.md)
-   [<span data-ttu-id="96e94-128">System. SFGAOFlags</span><span class="sxs-lookup"><span data-stu-id="96e94-128">System.SFGAOFlags</span></span>](./props-system-sfgaoflags.md)
-   [<span data-ttu-id="96e94-129">System. ItemPathDisplay</span><span class="sxs-lookup"><span data-stu-id="96e94-129">System.ItemPathDisplay</span></span>](./props-system-itempathdisplay.md)
-   [<span data-ttu-id="96e94-130">System. ItemPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="96e94-130">System.ItemPathDisplayNarrow</span></span>](./props-system-itempathdisplaynarrow.md)
-   [<span data-ttu-id="96e94-131">System. ItemFolderNameDisplay</span><span class="sxs-lookup"><span data-stu-id="96e94-131">System.ItemFolderNameDisplay</span></span>](./props-system-itemfoldernamedisplay.md)
-   [<span data-ttu-id="96e94-132">System. ItemFolderPathDisplay</span><span class="sxs-lookup"><span data-stu-id="96e94-132">System.ItemFolderPathDisplay</span></span>](./props-system-itemfolderpathdisplay.md)
-   [<span data-ttu-id="96e94-133">System. ItemFolderPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="96e94-133">System.ItemFolderPathDisplayNarrow</span></span>](./props-system-itemfolderpathdisplaynarrow.md)

<span data-ttu-id="96e94-134">Pour obtenir la liste complète de toutes les propriétés de l’interpréteur de commandes, consultez Propriétés de l' [interpréteur](./props.md).</span><span class="sxs-lookup"><span data-stu-id="96e94-134">For a full list of all Shell properties, see [Shell Properties](./props.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="96e94-135">Les valeurs de propriété remplacées sont utilisées uniquement lorsque les fichiers sont indexés.</span><span class="sxs-lookup"><span data-stu-id="96e94-135">The overridden property values are used only when the files are indexed.</span></span> <span data-ttu-id="96e94-136">Ainsi, l’exploration des fichiers à partir de la source de données du système de fichiers ne révèle pas les valeurs substituées.</span><span class="sxs-lookup"><span data-stu-id="96e94-136">Thus, browsing files from the file system data source does not reveal the overridden values.</span></span>

 

### <a name="storing-properties-in-xml-based-file-formats"></a><span data-ttu-id="96e94-137">Stockage des propriétés dans des formats de fichier XML</span><span class="sxs-lookup"><span data-stu-id="96e94-137">Storing Properties in XML-based File Formats</span></span>

<span data-ttu-id="96e94-138">Deux options de base sont disponibles pour le stockage des propriétés dans des formats de fichier XML :</span><span class="sxs-lookup"><span data-stu-id="96e94-138">There are two basic options available for storing properties in XML-based file formats:</span></span>

-   <span data-ttu-id="96e94-139">Stockez chaque propriété à l’aide d’éléments et d’attributs XML en fonction du schéma XML du document.</span><span class="sxs-lookup"><span data-stu-id="96e94-139">Store each property using XML elements and attributes according to the XML schema of the document.</span></span> <span data-ttu-id="96e94-140">Cette approche est plus « XML convivial ».</span><span class="sxs-lookup"><span data-stu-id="96e94-140">This approach is more "XML friendly".</span></span>
-   <span data-ttu-id="96e94-141">Sérialisez l’ensemble de la Banque de propriétés dans un objet BLOB (Binary Large Object) de mémoire, convertissez l’objet BLOB en une chaîne encodée en base64, puis stockez cette chaîne dans le fichier XML.</span><span class="sxs-lookup"><span data-stu-id="96e94-141">Serialize the entire property store into a memory Binary large object (BLOB), convert the BLOB into a base64-encoded string, and then store that string in the XML.</span></span> <span data-ttu-id="96e94-142">C’est le plus simple des deux approches et peut être utilisé pour offrir un support à des métadonnées ouvertes de façon triviale.</span><span class="sxs-lookup"><span data-stu-id="96e94-142">This is the simpler of the two approaches and can be used to trivially provide support for open metadata.</span></span>

<span data-ttu-id="96e94-143">Certains gestionnaires peuvent combiner ces approches, en stockant des valeurs importantes au format XML standard et en stockant le reste dans un objet BLOB, par exemple.</span><span class="sxs-lookup"><span data-stu-id="96e94-143">Some handlers might combine these approaches, storing some important values in standard XML format and storing the rest in a BLOB, for example.</span></span>

### <a name="computed-properties"></a><span data-ttu-id="96e94-144">Propriétés calculées</span><span class="sxs-lookup"><span data-stu-id="96e94-144">Computed Properties</span></span>

<span data-ttu-id="96e94-145">Certaines propriétés sont dérivées d’attributs spécifiques d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="96e94-145">Some properties are derived from specific attributes of a file.</span></span> <span data-ttu-id="96e94-146">Par exemple, la propriété [System. image. Dimensions](./props-system-image-dimensions.md) est déterminée par les dimensions réelles de l’image dans un fichier image.</span><span class="sxs-lookup"><span data-stu-id="96e94-146">For example, the [System.Image.Dimensions](./props-system-image-dimensions.md) property is determined by the actual dimensions of the image in an image file.</span></span> <span data-ttu-id="96e94-147">Comme ces valeurs de propriété ne peuvent pas être modifiées par le gestionnaire de propriétés, elles sont donc marquées `isInnate="true"` dans la description de la propriété.</span><span class="sxs-lookup"><span data-stu-id="96e94-147">Because such property values cannot be changed by the property handler, they are thus marked `isInnate="true"` in the property description.</span></span> <span data-ttu-id="96e94-148">D’autres propriétés sont calculées à partir d’une partie d’une propriété spécifique ou en agrégeant les valeurs de plusieurs propriétés.</span><span class="sxs-lookup"><span data-stu-id="96e94-148">Other properties are computed from a part of a specific property or by aggregating the values of multiple properties.</span></span> <span data-ttu-id="96e94-149">Étant donné que les mises à jour de ces propriétés « calculées » créeraient une ambiguïté quant à la façon dont les valeurs « sources » doivent être modifiées, les propriétés calculées doivent être marquées `isInnate="true"` dans la description de la propriété ou signalées comme étant en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="96e94-149">Because updates to these "computed" properties would create ambiguity as to how the "source" values should be changed, computed properties should be marked `isInnate="true"` in the property description or reported as read-only.</span></span> <span data-ttu-id="96e94-150">Cette dernière option est disponible en demandant au gestionnaire de retourner S \_ false à partir de [**IPropertyStoreCapabilities :: IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span><span class="sxs-lookup"><span data-stu-id="96e94-150">The latter option is available by instructing the handler to return S\_FALSE from [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="96e94-151">Forum Aux Questions (FAQ)</span><span class="sxs-lookup"><span data-stu-id="96e94-151">Frequently Asked Questions</span></span>

<span data-ttu-id="96e94-152">Cette section fournit des réponses aux questions fréquemment posées sur les propriétés et les gestionnaires de propriétés, ainsi que les réponses qui l’accompagnent.</span><span class="sxs-lookup"><span data-stu-id="96e94-152">This section provides answers to frequently asked questions about properties and property handlers, and accompanying answers.</span></span>

-   <span data-ttu-id="96e94-153">**Question :** Pourquoi le gestionnaire de propriétés n’est-il pas chargé par l’indexeur de recherche Windows ?</span><span class="sxs-lookup"><span data-stu-id="96e94-153">**Question:** Why isn't my property handler being loaded by the Windows Search indexer?</span></span>

    <span data-ttu-id="96e94-154">L’indexeur de recherche Windows s’exécute en tant que service système et ne peut pas charger les dll stockées dans le répertoire du profil utilisateur.</span><span class="sxs-lookup"><span data-stu-id="96e94-154">The Windows Search indexer runs as a system service and cannot load DLLs that are stored in the user profile directory.</span></span> <span data-ttu-id="96e94-155">Si vous générez et déboguez à l’aide de Microsoft Visual Studio, le fichier DLL est placé dans votre profil utilisateur (et par conséquent, il n’est pas chargé par l’indexeur).</span><span class="sxs-lookup"><span data-stu-id="96e94-155">If you are building and debugging using Microsoft Visual Studio, it will place the DLL in your user profile (and therefore it won't be loaded by the indexer).</span></span> <span data-ttu-id="96e94-156">Pour contourner ce contournement, copiez votre DLL en dehors de votre dossier de profil (par exemple, dans **C : \\ Program Files \\ nomapp**) et inscrivez-la à cet emplacement.</span><span class="sxs-lookup"><span data-stu-id="96e94-156">To work around this, copy your DLL outside of your profile folder (for example, into **C:\\Program Files\\YourAppName**) and register it there.</span></span>

    <span data-ttu-id="96e94-157">Pour obtenir des conseils plus spécifiques sur le développement de gestionnaires de propriétés pour travailler avec l’indexeur de recherche Windows, consultez [développement de gestionnaires de propriétés pour Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="96e94-157">For more specific guidance on developing property handlers to work with the Windows Search indexer, see [Developing Property Handlers for Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span></span>

-   <span data-ttu-id="96e94-158">**Question :** Quelles sont les propriétés qui doivent être détectables via les méthodes d’énumération [**IPropertyStore :: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) et [**IPropertyStore :: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) ?</span><span class="sxs-lookup"><span data-stu-id="96e94-158">**Question:** Which properties should be discoverable through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) enumeration methods?</span></span>

    <span data-ttu-id="96e94-159">Les clients des objets de la Banque de propriétés n’utilisent pas ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="96e94-159">Not all clients of property store objects use these methods.</span></span> <span data-ttu-id="96e94-160">Certains clients connaissent les propriétés qu’ils envisagent de demander directement (par nom de la société) ou reçoivent des informations sur les propriétés via une liste de description de propriété.</span><span class="sxs-lookup"><span data-stu-id="96e94-160">Some clients are aware of the properties they plan to request directly (by PKEY name), or receive property information through a property description list.</span></span> <span data-ttu-id="96e94-161">Les méthodes de découverte des propriétés prise en charge plusieurs autres scénarios.</span><span class="sxs-lookup"><span data-stu-id="96e94-161">The property discovery methods suppport several other scenarios.</span></span> <span data-ttu-id="96e94-162">Si une propriété n’a pas besoin de participer à ces scénarios, elle n’a pas besoin d’être énumérée.</span><span class="sxs-lookup"><span data-stu-id="96e94-162">If a property does not need to participate in these scenarios, it does not need to be enumerated.</span></span> <span data-ttu-id="96e94-163">Par conséquent, un gestionnaire de propriétés peut produire une valeur non VT \_ vide pour les propriétés qui ne sont pas découvertes par le biais des méthodes [**IPropertyStore :: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) et [**IPropertyStore :: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="96e94-163">Hence, a property handler can produce a non-VT\_EMPTY value for properties that are not discovered through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span>

    <span data-ttu-id="96e94-164">Toutefois, les propriétés doivent être visibles par le biais de ces méthodes si l’une des conditions suivantes est remplie :</span><span class="sxs-lookup"><span data-stu-id="96e94-164">However, properties should be visible via these methods if any of the following conditions are met:</span></span>

    -   <span data-ttu-id="96e94-165">**Si la propriété est indexée pour pouvoir faire l'** objet d’une recherche : Cela signifie qu’il est inclus dans le magasin de propriétés de recherche Windows (indiqué par `isColumn = "true"` dans le schéma de description de propriété) ou disponible pour les recherches en texte intégral ( `inInvertedIndex = "true"` ).</span><span class="sxs-lookup"><span data-stu-id="96e94-165">**If the property is indexed so that it is searchable:** This means it is included in the Windows Search property store (denoted by `isColumn = "true"` in the property description schema) or available for full text searches (`inInvertedIndex = "true"`).</span></span> <span data-ttu-id="96e94-166">En l’absence de ces indicateurs ou de l’absence d’une description de propriété, les propriétés de type « String » sont ajoutées automatiquement à l’index inversé pour permettre la recherche.</span><span class="sxs-lookup"><span data-stu-id="96e94-166">In the absence of these flags or the absence of a property description, properties of type "string" will be added automatically to the inverted index to enable searching.</span></span> <span data-ttu-id="96e94-167">Étant donné que la liste des propriétés connues (celles avec les descriptions de propriétés installées) dans le système de propriétés est très volumineuse (plus de 800 propriétés), il est peu pratique de demander chaque gestionnaire de propriétés pour chaque propriété enregistrée dans le système de propriétés.</span><span class="sxs-lookup"><span data-stu-id="96e94-167">Because the list of known properties (those with installed property descriptions) in the property system is very large (more than 800 properties), it would be impractical to ask every property handler for every property registered in the property system.</span></span> <span data-ttu-id="96e94-168">Au lieu de cela, le processus d’indexation énumère les propriétés pertinentes du gestionnaire de propriétés pour chaque élément qu’il indexe, et il utilise les valeurs des propriétés énumérées pour créer l’index de recherche en texte intégral.</span><span class="sxs-lookup"><span data-stu-id="96e94-168">Instead, the indexing process enumerates the relevant properties from the property handler for each item it indexes, and it uses the values of the enumerated properties to build the full text index.</span></span>
    -   <span data-ttu-id="96e94-169">**Si la propriété doit être copiée lorsque le jeu de propriétés de l’élément est dupliqué :** Pour implémenter une fonction « copier un jeu de propriétés », l’élément source rend les propriétés qui doivent être copiées à l’aide des méthodes [**IPropertyStore :: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) et [**IPropertyStore :: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="96e94-169">**If the property should be copied when the item's property set is duplicated:** To implement a "copy a property set" function, the source item makes the properties that should be copied visible through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span> <span data-ttu-id="96e94-170">Les propriétés qui n’ont pas besoin d’être copiées ou qui ne sont pas logiquement copiées ne doivent pas être incluses.</span><span class="sxs-lookup"><span data-stu-id="96e94-170">Properties that do not need to be copied or do not make sense being copied should not be included.</span></span>
    -   <span data-ttu-id="96e94-171">**Si la valeur de la propriété n’est pas vide (VT \_ vide) : les** valeurs de propriété qui sont vides ne sont pas utiles pour les clients.</span><span class="sxs-lookup"><span data-stu-id="96e94-171">**If the property value is not empty (VT\_EMPTY):** Property values that are empty are not useful for clients.</span></span> <span data-ttu-id="96e94-172">Lorsque les clients tentent de retourner des valeurs de propriété vides, la valeur VT \_ vide est retournée.</span><span class="sxs-lookup"><span data-stu-id="96e94-172">When clients attempt to return empty property values, a value of VT\_EMPTY is returned.</span></span> <span data-ttu-id="96e94-173">Par conséquent, les propriétés avec des valeurs vides ne doivent pas être énumérées.</span><span class="sxs-lookup"><span data-stu-id="96e94-173">Thus, properties with empty values should not be enumerated.</span></span>
    -   <span data-ttu-id="96e94-174">**Si la propriété doit être supprimée lors de l’appel de la fonction « Remove Properties » :** Cette fonctionnalité existe pour protéger la confidentialité. il découvre toutes les valeurs du gestionnaire de propriétés par le biais de l’énumération et supprime chaque valeur sélectionnée pour la suppression par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="96e94-174">**If the property should be removed when invoking the "remove properties" function:** This feature exists to protect privacy; it discovers all values from the property handler through enumeration and removes each one selected for removal by the user.</span></span>
        > [!Note]  
        > <span data-ttu-id="96e94-175">L’énumération des propriétés ne communique pas l’ensemble des propriétés prises en charge par un gestionnaire de propriétés particulier si le gestionnaire prend en charge un schéma fixe (et non des métadonnées ouvertes).</span><span class="sxs-lookup"><span data-stu-id="96e94-175">Enumerating properties does not communicate the set of properties that a particular property handler supports if the handler supports a fixed schema (and not open metadata).</span></span> <span data-ttu-id="96e94-176">Au lieu de cela, ces gestionnaires doivent documenter l’ensemble de propriétés qu’ils prennent en charge.</span><span class="sxs-lookup"><span data-stu-id="96e94-176">Instead, such handlers should document the set of properties that they support.</span></span>

         

-   <span data-ttu-id="96e94-177">**Question :** Comment faire savez quels formats de fichiers prennent en charge les métadonnées ouvertes ?</span><span class="sxs-lookup"><span data-stu-id="96e94-177">**Question:** How do I know which file formats support open metadata?</span></span>

    <span data-ttu-id="96e94-178">Pour plus d’informations sur la prise en charge des métadonnées ouvertes, consultez « types de fichiers prenant en charge les métadonnées ouvertes » dans [types de fichiers](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="96e94-178">For information about support for open metadata, see "File Types that Support Open Metadata" in [File Types](../shell/fa-file-types.md).</span></span>

-   <span data-ttu-id="96e94-179">**Question :** Les valeurs VT null peuvent- \_ elles être stockées à l’aide d’un gestionnaire de propriétés ?</span><span class="sxs-lookup"><span data-stu-id="96e94-179">**Question:** Can VT\_NULL values be stored using a property handler?</span></span>

    <span data-ttu-id="96e94-180">Non.</span><span class="sxs-lookup"><span data-stu-id="96e94-180">No.</span></span> <span data-ttu-id="96e94-181">\_Les valeurs VT null seront converties en VT \_ vide lors des appels à [**IPropertyStore :: GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) et [**IPropertyStore :: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="96e94-181">VT\_NULL values will be converted to VT\_EMPTY on calls to [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) and [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="96e94-182">**Question :** Quels formats de chaîne de date sont pris en charge par la fonction [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) ?</span><span class="sxs-lookup"><span data-stu-id="96e94-182">**Question:** Which date string formats are supported by the [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) function?</span></span>

    <span data-ttu-id="96e94-183">En règle générale, les propriétés qui représentent des valeurs de date/heure doivent être représentées à l’aide de VT \_ FILETIME.</span><span class="sxs-lookup"><span data-stu-id="96e94-183">Generally, properties that represent date/time values should be represented using VT\_FILETIME.</span></span> <span data-ttu-id="96e94-184">Toutefois, de nombreuses sources de données fournissent ces informations sous forme de chaîne.</span><span class="sxs-lookup"><span data-stu-id="96e94-184">However, many data sources provide this information in string form.</span></span> <span data-ttu-id="96e94-185">L’API d’assistance [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) prend en charge la conversion de certains formats de date de chaîne en valeurs [**fileTime**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) , comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="96e94-185">The [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) helper API supports coercing some string date formats into [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) values, as shown in the following table.</span></span>

    

    | <span data-ttu-id="96e94-186">Format</span><span class="sxs-lookup"><span data-stu-id="96e94-186">Format</span></span>                  | <span data-ttu-id="96e94-187">Windows Vista, Windows XP et Microsoft Windows Desktop Search (WDS)</span><span class="sxs-lookup"><span data-stu-id="96e94-187">Windows Vista, Windows XP, and Microsoft Windows Desktop Search (WDS)</span></span> | <span data-ttu-id="96e94-188">Windows 7</span><span class="sxs-lookup"><span data-stu-id="96e94-188">Windows 7</span></span> | <span data-ttu-id="96e94-189">Notes</span><span class="sxs-lookup"><span data-stu-id="96e94-189">Notes</span></span>                                                                                                                                                                                                 |
    |-------------------------|-----------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="96e94-190">yyyy/mm/jj : HH : mm : SS. uuu</span><span class="sxs-lookup"><span data-stu-id="96e94-190">yyyy/mm/dd:hh:mm:ss.uuu</span></span> | <span data-ttu-id="96e94-191">Oui</span><span class="sxs-lookup"><span data-stu-id="96e94-191">Yes</span></span>                                                                   | <span data-ttu-id="96e94-192">Oui</span><span class="sxs-lookup"><span data-stu-id="96e94-192">Yes</span></span>       | <span data-ttu-id="96e94-193">UNIVERSEL y = année, m = mois, d = date, h = heures (24 heures), m = minutes, s = secondes, u = microsecondes</span><span class="sxs-lookup"><span data-stu-id="96e94-193">UTC; y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds, u=microseconds</span></span>                                                                                                           |
    | <span data-ttu-id="96e94-194">yyyy-mm-ddThh : mm : ssZ</span><span class="sxs-lookup"><span data-stu-id="96e94-194">yyyy-mm-ddThh:mm:ssZ</span></span>    | <span data-ttu-id="96e94-195">Non</span><span class="sxs-lookup"><span data-stu-id="96e94-195">No</span></span>                                                                    | <span data-ttu-id="96e94-196">Oui</span><span class="sxs-lookup"><span data-stu-id="96e94-196">Yes</span></span>       | <span data-ttu-id="96e94-197">**Spécification de format ISO8601** UTC (indiqué par l’indicateur de fuseau horaire’Z'); y = année, m = mois, d = date, h = heures (24 heures), m = minutes, s = secondes ; 'T’est un délimiteur pour la partie heure.</span><span class="sxs-lookup"><span data-stu-id="96e94-197">**ISO8601 format specification** UTC (denoted by 'Z' time zone indicator); y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds; 'T' is a delimiter for the time portion.</span></span><br/> |

    

     

-   <span data-ttu-id="96e94-198">**Question :** Est-il possible de créer un gestionnaire de propriétés en lecture seule ?</span><span class="sxs-lookup"><span data-stu-id="96e94-198">**Question:** Is it possible to create a read-only property handler?</span></span>

    <span data-ttu-id="96e94-199">Oui.</span><span class="sxs-lookup"><span data-stu-id="96e94-199">Yes.</span></span> <span data-ttu-id="96e94-200">Certaines implémentations de gestionnaire de propriétés ne prennent pas en charge l’écriture de valeurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="96e94-200">Some property handler implementations do not support writing of property values.</span></span> <span data-ttu-id="96e94-201">Ces gestionnaires de propriétés doivent retourner STGM \_ E \_ ACCESSDENIED sur les appels à **IInitializeXXX :: Initialize** qui passent STGM \_ ReadWrite, ou à tout appel à [**IPropertyStore :: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="96e94-201">These property handlers should return STGM\_E\_ACCESSDENIED on calls to **IInitializeXXX::Initialize** that pass STGM\_READWRITE, or on any call to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

    <span data-ttu-id="96e94-202">Tous les gestionnaires de propriétés ouverts en \_ mode lecture STGM doivent retourner STGM \_ E \_ ACCESSDENIED sur les appels à [**IPropertyStore :: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="96e94-202">All property handlers opened in STGM\_READ mode should return STGM\_E\_ACCESSDENIED on calls to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="96e94-203">**Question :** Un gestionnaire de propriétés peut-il traiter une propriété en lecture seule, même si le schéma indique que la propriété est accessible en écriture ?</span><span class="sxs-lookup"><span data-stu-id="96e94-203">**Question:** Can a property handler treat a property as read-only, even if the schema indicates that the property is writeable?</span></span>

    <span data-ttu-id="96e94-204">Oui.</span><span class="sxs-lookup"><span data-stu-id="96e94-204">Yes.</span></span> <span data-ttu-id="96e94-205">Dans le système de schéma, les propriétés sont annotées en lecture seule (y compris celles avec `isInnate = "true"` ) ou en lecture/écriture.</span><span class="sxs-lookup"><span data-stu-id="96e94-205">In the schema system, properties are annotated as read-only (including those with `isInnate = "true"`) or read/write.</span></span> <span data-ttu-id="96e94-206">Les gestionnaires de propriétés qui ne prennent pas en charge l’écriture d’une propriété particulière indiquée par le schéma doivent être inscriptibles doivent implémenter [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) et retourner la \_ valeur false sur les appels à [**IPropertyStoreCapabilities :: IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) pour cette propriété.</span><span class="sxs-lookup"><span data-stu-id="96e94-206">Property handlers that do not support writing a particular property that the schema says should be writeable should implement [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) and return S\_FALSE on calls to [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) for that property.</span></span> <span data-ttu-id="96e94-207">Cela indique que dans le contexte de ce gestionnaire et de ce fichier, la propriété n’est pas accessible en écriture.</span><span class="sxs-lookup"><span data-stu-id="96e94-207">This indicates that in the context of this handler and this file, the property is not writeable.</span></span>

    > [!Note]  
    > <span data-ttu-id="96e94-208">L’action inversée n’est pas possible.</span><span class="sxs-lookup"><span data-stu-id="96e94-208">The reverse action is not possible.</span></span> <span data-ttu-id="96e94-209">Vous ne pouvez pas autoriser un gestionnaire de propriétés à écrire une propriété qui est marquée en lecture seule dans le schéma</span><span class="sxs-lookup"><span data-stu-id="96e94-209">You cannot enable a property handler to write a property that is marked as read-only in the schema</span></span>

     

## <a name="related-topics"></a><span data-ttu-id="96e94-210">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="96e94-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="96e94-211">Fonctionnement des gestionnaires de propriétés</span><span class="sxs-lookup"><span data-stu-id="96e94-211">Understanding Property Handlers</span></span>](./building-property-handlers-properties.md)
</dt> <dt>

[<span data-ttu-id="96e94-212">Utilisation des noms de genres</span><span class="sxs-lookup"><span data-stu-id="96e94-212">Using Kind Names</span></span>](./building-property-handlers-user-friendly-kind-names.md)
</dt> <dt>

[<span data-ttu-id="96e94-213">Utilisation des listes de propriétés</span><span class="sxs-lookup"><span data-stu-id="96e94-213">Using Property Lists</span></span>](./building-property-handlers-property-lists.md)
</dt> <dt>

[<span data-ttu-id="96e94-214">Initialisation des gestionnaires de propriétés</span><span class="sxs-lookup"><span data-stu-id="96e94-214">Initializing Property Handlers</span></span>](./building-property-handlers-property-handlers.md)
</dt> <dt>

[<span data-ttu-id="96e94-215">Inscription et distribution des gestionnaires de propriétés</span><span class="sxs-lookup"><span data-stu-id="96e94-215">Registering and Distributing Property Handlers</span></span>](./prophand-reg-dist.md)
</dt> </dl>

 

 
