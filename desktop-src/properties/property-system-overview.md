---
description: Le système de propriétés Windows est un système extensible en lecture/écriture de définitions de données qui offre un moyen uniforme d’exprimer des métadonnées sur les éléments de l’interpréteur de commandes.
ms.assetid: eb2dc2be-fc53-40aa-81f6-f353ab1d3a57
title: Cliquez sur Vue d’ensemble du système de propriétés.
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dab3a17eacdbaa9a5d0255004ba544b7c3f7ff2b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106519619"
---
# <a name="property-system-overview"></a><span data-ttu-id="e3378-103">Cliquez sur Vue d’ensemble du système de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e3378-103">Property System Overview</span></span>

<span data-ttu-id="e3378-104">Le système de propriétés Windows est un système extensible en lecture/écriture de définitions de données qui offre un moyen uniforme d’exprimer des métadonnées sur les éléments de l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="e3378-104">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="e3378-105">Le système de propriétés Windows dans Windows Vista et les versions ultérieures vous permet de stocker et de récupérer des métadonnées pour les éléments de Shell.</span><span class="sxs-lookup"><span data-stu-id="e3378-105">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="e3378-106">Un élément de Shell est un élément de contenu unique, tel qu’un fichier, un dossier, un message électronique ou un contact.</span><span class="sxs-lookup"><span data-stu-id="e3378-106">A Shell item is any single piece of content, such as a file, folder, email, or contact.</span></span> <span data-ttu-id="e3378-107">Une propriété est un élément de métadonnées individuel associé à un élément de Shell.</span><span class="sxs-lookup"><span data-stu-id="e3378-107">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="e3378-108">Les valeurs de propriété sont exprimées sous la forme d’une structure [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="e3378-108">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="e3378-109">Cette rubrique est organisée comme suit :</span><span class="sxs-lookup"><span data-stu-id="e3378-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="e3378-110">Introduction</span><span class="sxs-lookup"><span data-stu-id="e3378-110">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="e3378-111">Scénarios de développement</span><span class="sxs-lookup"><span data-stu-id="e3378-111">Development Scenarios</span></span>](#development-scenarios)
-   [<span data-ttu-id="e3378-112">Propriétés et recherche Windows</span><span class="sxs-lookup"><span data-stu-id="e3378-112">Properties and Windows Search</span></span>](#properties-and-windows-search)
-   [<span data-ttu-id="e3378-113">Remarque à l’attention des implémenteurs</span><span class="sxs-lookup"><span data-stu-id="e3378-113">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="e3378-114">Documentation du système de propriétés Windows</span><span class="sxs-lookup"><span data-stu-id="e3378-114">Windows Property System Documentation</span></span>](#windows-property-system-documentation)
-   [<span data-ttu-id="e3378-115">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="e3378-115">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="e3378-116">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e3378-116">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="e3378-117">Introduction</span><span class="sxs-lookup"><span data-stu-id="e3378-117">Introduction</span></span>

<span data-ttu-id="e3378-118">Les propriétés sont identifiées de manière unique par leur nom canonique (tel que `System.Document.LastAuthor` ) et la clé de propriété (par exemple, `PKEY_Document_LastAuthor` ).</span><span class="sxs-lookup"><span data-stu-id="e3378-118">Properties are uniquely identified by their canonical name (such as `System.Document.LastAuthor`) and property key (such as `PKEY_Document_LastAuthor`).</span></span> <span data-ttu-id="e3378-119">Une clé de propriété (groupe de caractères) est la partie nom d’une paire nom-valeur qui se compose d’un type d’emplacement/de PROPVARIANT ou d’une chaîne/PROPVARIANT, où la chaîne est le nom canonique du groupe de caractères (par exemple `System.Document.LastAuthor` ).</span><span class="sxs-lookup"><span data-stu-id="e3378-119">A property key (PKEY) is the name portion of a name-value pair that consists of a PKEY/PROPVARIANT or a string/PROPVARIANT, where the string is the canonical name of the PKEY (such as `System.Document.LastAuthor`).</span></span> <span data-ttu-id="e3378-120">Un élément de tableau est une définition qui indique au système de propriétés tout ce qu’il doit savoir sur la propriété, tandis que la valeur est une instance réelle de la propriété.</span><span class="sxs-lookup"><span data-stu-id="e3378-120">A PKEY is a definition that tells the property system everything it needs to know about the property, whereas the value is an actual instance of the property.</span></span> <span data-ttu-id="e3378-121">Un groupe de la groupe contient en interne un formatID et un propID.</span><span class="sxs-lookup"><span data-stu-id="e3378-121">A PKEY internally contains a formatID and propID.</span></span>

<span data-ttu-id="e3378-122">Une propriété individuelle se compose des trois éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="e3378-122">An individual property consists of the following three pieces:</span></span>

-   <span data-ttu-id="e3378-123">Nom canonique, tel que `System.Music.Artist` .</span><span class="sxs-lookup"><span data-stu-id="e3378-123">A canonical name, such as `System.Music.Artist`.</span></span>
-   <span data-ttu-id="e3378-124">Description de schéma, spécifiée au format de fichier XML. propDesc et exprimée par programme par le biais de [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span><span class="sxs-lookup"><span data-stu-id="e3378-124">A schema description, which is specified in the .propdesc XML file format and expressed programmatically through [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span></span>
-   <span data-ttu-id="e3378-125">Valeur, telle que le nom d’un singe.</span><span class="sxs-lookup"><span data-stu-id="e3378-125">A value, such as the name of a singer.</span></span>

<span data-ttu-id="e3378-126">La description du schéma se compose d’informations sur la propriété, telles que le nom de la propriété, le type de données, les contraintes, des informations sur la façon dont la propriété interagit avec les vues et le système de recherche, etc.</span><span class="sxs-lookup"><span data-stu-id="e3378-126">The schema description consists of information about the property, such as the property name, data type, constraints, information on how the property interacts with views and the search system, and so forth.</span></span> <span data-ttu-id="e3378-127">Le nom et la description du schéma sont définis globalement, et sont les mêmes pour tous les éléments et types.</span><span class="sxs-lookup"><span data-stu-id="e3378-127">The name and schema description are defined globally, and are the same for all items and types.</span></span> <span data-ttu-id="e3378-128">Une valeur est spécifique à un élément individuel.</span><span class="sxs-lookup"><span data-stu-id="e3378-128">A value is specific to an individual item.</span></span> <span data-ttu-id="e3378-129">Autrement dit, la `System.Music.Artist` propriété est toujours définie comme une chaîne à valeurs multiples, mais elle peut avoir une valeur différente (ou aucune valeur) pour chaque élément.</span><span class="sxs-lookup"><span data-stu-id="e3378-129">That is, the `System.Music.Artist` property is always defined as a multi-value string, but may have a different value (or no value at all) for each item.</span></span>

<span data-ttu-id="e3378-130">Un gestionnaire de propriétés traduit les données stockées dans un fichier dans un schéma structuré qui est reconnu par et qui est accessible par l’Explorateur Windows, la recherche Windows et d’autres applications.</span><span class="sxs-lookup"><span data-stu-id="e3378-130">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="e3378-131">Ces systèmes peuvent ensuite interagir avec le gestionnaire de propriétés pour écrire et lire les propriétés vers et à partir du fichier.</span><span class="sxs-lookup"><span data-stu-id="e3378-131">These systems can then interact with the property handler to write and read properties to and from the file.</span></span> <span data-ttu-id="e3378-132">Les données traduites sont exposées par programme et présentées à l’utilisateur par le biais de l’Explorateur Windows dans divers contextes, notamment le mode Détails, info-bulles, le volet Détails, les pages de propriétés, etc.</span><span class="sxs-lookup"><span data-stu-id="e3378-132">The translated data is exposed programmatically and shown to the user through Windows Explorer in a variety of contexts including details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="e3378-133">Chaque gestionnaire de propriétés est associé à un type de fichier particulier, qui est identifié par l’extension de nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="e3378-133">Each property handler is associated with a particular file type, which is identified by the file name extension.</span></span> <span data-ttu-id="e3378-134">Les développeurs doivent implémenter un gestionnaire de propriétés qui produit et utilise le format natif de son type de fichier, tel que. jpg ou. png, ou utilise le In-Memory magasin de propriétés, qui produit et utilise le format binaire MS-PROPSTORE.</span><span class="sxs-lookup"><span data-stu-id="e3378-134">Developers should implement a property handler that produces and consumes their file type's native format, such as .jpg or .png, or use the In-Memory Property Store, which produces and consumes the MS-PROPSTORE binary format.</span></span>

<span data-ttu-id="e3378-135">Le système de propriétés Windows crée un modèle de données abstrait qui fournit un niveau d’abstraction à partir de formats de fichier individuels.</span><span class="sxs-lookup"><span data-stu-id="e3378-135">The Windows Property System creates an abstract data model that provides a level of abstraction from individual file formats.</span></span> <span data-ttu-id="e3378-136">Le modèle de données abstrait fourni par le système de propriétés Windows est une méthode permettant de lire et d’écrire un ensemble extensible de valeurs nommées associées à un élément de Shell.</span><span class="sxs-lookup"><span data-stu-id="e3378-136">The abstract data model provided by the Windows Property System is a method for reading and writing an extensible set of named values that are associated with a Shell item.</span></span> <span data-ttu-id="e3378-137">L’expression de valeur est flexible, prend en charge de nombreux types de données et est extensible, ce qui permet d’exprimer des données arbitraires (**\_ objet BLOB VT**) et des objets sous la forme d’une valeur.</span><span class="sxs-lookup"><span data-stu-id="e3378-137">The value expression is flexible, supporting many data types, and is extensible, enabling arbitrary data (**VT\_BLOB**) and objects to be expressed as a value.</span></span>

<span data-ttu-id="e3378-138">En raison de l’abstraction, vous pouvez interroger les attributs ou les métadonnées d’un élément.</span><span class="sxs-lookup"><span data-stu-id="e3378-138">Due to the abstraction, you can query the attributes or metadata of any item.</span></span> <span data-ttu-id="e3378-139">Parmi les exemples d’éléments pouvant être abstraits, citons Microsoft Office documents, les balises ID3 et AutoCAD, ainsi que d’autres logiciels propriétaires tiers.</span><span class="sxs-lookup"><span data-stu-id="e3378-139">Examples of items that can be abstracted include Microsoft Office documents, ID3 tags, and AutoCAD and other third-party proprietary software.</span></span> <span data-ttu-id="e3378-140">De même, si vous avez un fichier. jpeg, vous pouvez utiliser les codecs. jpeg et EXIF pour lire les octets du fichier afin de découvrir les dimensions de l’image.</span><span class="sxs-lookup"><span data-stu-id="e3378-140">Similarly, if you have a .jpeg file, you can use the .jpeg and EXIF codecs to read the bytes of the file to discover what the dimensions of the image are.</span></span> <span data-ttu-id="e3378-141">Si vous avez un fichier. png à la place, vous avez besoin d’un codec différent et de code différent pour le faire.</span><span class="sxs-lookup"><span data-stu-id="e3378-141">If you have a .png file instead, you need a different codec and different code to do so.</span></span> <span data-ttu-id="e3378-142">L’utilisation du système de propriétés Windows évite ce type de problème.</span><span class="sxs-lookup"><span data-stu-id="e3378-142">Using the Windows Property System avoids this sort of problem.</span></span> <span data-ttu-id="e3378-143">Si vous implémentez un nouveau type de fichier, vous avez la possibilité de brancher l’abstraction uniforme offerte par le système de propriétés Windows et de spécifier comment rendre vos métadonnées consommables.</span><span class="sxs-lookup"><span data-stu-id="e3378-143">If you implement a new file type, you have the option to plug into the uniform abstraction offered by the Windows Property System and specify how to make your metadata consumable.</span></span> <span data-ttu-id="e3378-144">Pour ces raisons, il est toujours préférable d’utiliser la plateforme commune fournie par le système de propriétés Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-144">For these reasons, it is always preferable to use the common platform provided by the Windows Property System.</span></span>

## <a name="development-scenarios"></a><span data-ttu-id="e3378-145">Scénarios de développement</span><span class="sxs-lookup"><span data-stu-id="e3378-145">Development Scenarios</span></span>

<span data-ttu-id="e3378-146">Les propriétés sont exprimées par les producteurs et par les consommateurs.</span><span class="sxs-lookup"><span data-stu-id="e3378-146">Properties are expressed by producers and by consumers.</span></span> <span data-ttu-id="e3378-147">Dans ce contexte, les producteurs sont les inventeurs de propriétés dans le système de propriétés Windows et les consommateurs sont les applications (et leurs développeurs) qui consomment les informations de propriété de ce système.</span><span class="sxs-lookup"><span data-stu-id="e3378-147">In this context, producers are the inventors of properties in the Windows Property System and consumers are applications (and their developers) that consume property information from this system.</span></span> <span data-ttu-id="e3378-148">Les utilisations de et des participants au système de propriétés Windows sont identifiées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="e3378-148">Uses of and participants in the Windows Property System are identified in the following table.</span></span>



| <span data-ttu-id="e3378-149">Utilisation du système de propriétés Windows</span><span class="sxs-lookup"><span data-stu-id="e3378-149">Use of the Windows Property System</span></span>                                                                                                                                                                                            | <span data-ttu-id="e3378-150">Participant</span><span class="sxs-lookup"><span data-stu-id="e3378-150">Participant</span></span> |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| <span data-ttu-id="e3378-151">Un bloc de construction qui fournit un registre extensible des descriptions de propriété, une implémentation de magasin de propriétés en mémoire et des services pour la liaison à des gestionnaires de propriétés, la conversion de types et la sérialisation des magasins de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e3378-151">A building block that provides an extensible registry of property descriptions, an in-memory property store implementation, and services for binding to property handlers, converting types, and serializing property stores.</span></span> | <span data-ttu-id="e3378-152">Consommateur</span><span class="sxs-lookup"><span data-stu-id="e3378-152">Consumer</span></span>    |
| <span data-ttu-id="e3378-153">Applications qui veulent lire et écrire des propriétés de manière abstraite.</span><span class="sxs-lookup"><span data-stu-id="e3378-153">Applications that want to read and write properties in an abstract way.</span></span>                                                                                                                                                       | <span data-ttu-id="e3378-154">Consommateur</span><span class="sxs-lookup"><span data-stu-id="e3378-154">Consumer</span></span>    |
| <span data-ttu-id="e3378-155">La propriété inventorie qui définit de nouvelles propriétés pour le système de propriétés en définissant des schémas de propriétés personnalisées et en développant leurs propres gestionnaires de propriétés.</span><span class="sxs-lookup"><span data-stu-id="e3378-155">Property inventors who define new properties for the property system by defining custom property schemas and developing their own property handlers.</span></span>                                                                          | <span data-ttu-id="e3378-156">Producer</span><span class="sxs-lookup"><span data-stu-id="e3378-156">Producer</span></span>    |
| <span data-ttu-id="e3378-157">Propriétaires de format de fichier qui souhaitent activer l’accès aux propriétés stockées dans leurs formats de fichiers personnalisés.</span><span class="sxs-lookup"><span data-stu-id="e3378-157">File format owners who want to enable access to the properties stored in their custom file formats.</span></span>                                                                                                                           | <span data-ttu-id="e3378-158">Producer</span><span class="sxs-lookup"><span data-stu-id="e3378-158">Producer</span></span>    |



 

<span data-ttu-id="e3378-159">Les consommateurs utilisent des propriétés, des schémas et des gestionnaires de propriétés existants.</span><span class="sxs-lookup"><span data-stu-id="e3378-159">Consumers consume existing properties, schemas, and property handlers.</span></span> <span data-ttu-id="e3378-160">Les propriétés disponibles pour la consommation incluent les propriétés en lecture/écriture des gestionnaires de propriétés pour les types de fichiers pris en charge et peuvent également inclure des propriétés personnalisées.</span><span class="sxs-lookup"><span data-stu-id="e3378-160">Properties available for consumption include read/write properties from property handlers for supported file types and may also include some custom properties.</span></span> <span data-ttu-id="e3378-161">Les schémas disponibles incluent au moins le schéma système, et parfois d’autres encore.</span><span class="sxs-lookup"><span data-stu-id="e3378-161">Available schemas include at least the system schema, and sometimes others, too.</span></span> <span data-ttu-id="e3378-162">Un consommateur peut créer une application pour consommer les métadonnées et générer une vue basée sur l’artiste, quels que soient les dossiers dans lesquels les éléments sont stockés.</span><span class="sxs-lookup"><span data-stu-id="e3378-162">A consumer can create an application to consume metadata and build a view based on artist, regardless of what folders the items are stored in.</span></span> <span data-ttu-id="e3378-163">La hiérarchie des dossiers de fichiers n’est pas pertinente.</span><span class="sxs-lookup"><span data-stu-id="e3378-163">The file folder hierarchy is irrelevant.</span></span> <span data-ttu-id="e3378-164">Par exemple, vous pouvez spécifier tous les éléments de chanson d’un type d’élément particulier sans vous préoccuper de l’emplacement de ces éléments.</span><span class="sxs-lookup"><span data-stu-id="e3378-164">For example, you can specify all song items by a particular singer without being concerned about the location of such items.</span></span> <span data-ttu-id="e3378-165">Ce scénario complexe de bout en bout n’est pas limité au système de propriétés Windows, mais il implique plusieurs composants différents, tels que les dossiers d’indexation et de recherche.</span><span class="sxs-lookup"><span data-stu-id="e3378-165">This complex, end-to-end scenario is not limited to the Windows Property System, but involves several different components, such as the indexing and search folders.</span></span>

<span data-ttu-id="e3378-166">Les conventes de propriété, ou développeurs tiers, sont des producteurs dans le système de propriétés Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-166">Property inventors, or third-party developers, are producers in the Windows Property System.</span></span> <span data-ttu-id="e3378-167">Lorsque vous préparez la définition d’une nouvelle propriété, inspectez d’abord le jeu de propriétés que Windows définit.</span><span class="sxs-lookup"><span data-stu-id="e3378-167">When preparing to define a new property, first inspect the set of properties that Windows defines.</span></span> <span data-ttu-id="e3378-168">Si vous en trouvez un qui répond à vos besoins, du type et de la sémantique qui correspondent à votre utilisation requise, utilisez cette propriété et n’inventez pas une nouvelle.</span><span class="sxs-lookup"><span data-stu-id="e3378-168">If you find one that meets your needs, of the type and semantics that match your required use, use that property and do not invent a new one.</span></span> <span data-ttu-id="e3378-169">Si vous définissez une nouvelle propriété personnalisée, essayez d’obtenir un accord avec d’autres développeurs qui peuvent l’utiliser et publier le résultat de ce contrat afin qu’ils puissent rejoindre la communauté des utilisateurs de cette propriété.</span><span class="sxs-lookup"><span data-stu-id="e3378-169">If you are defining a new custom property, try to obtain agreement with other developers that might want to use it and publish the result of that agreement so that they can join the community of users of that property.</span></span>

<span data-ttu-id="e3378-170">Les producteurs peuvent tirer parti des fonctionnalités de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-170">Producers can take advantage of Windows Explorer functionality.</span></span> <span data-ttu-id="e3378-171">Par exemple, si vous écrivez un nouveau format d’image et que vous implémentez un gestionnaire de propriétés, votre nouveau format de fichier devient disponible dans l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-171">For example, if you are writing a new image format, and implement a property handler, your new file format becomes available in Windows Explorer.</span></span> <span data-ttu-id="e3378-172">Les utilisateurs peuvent ensuite baliser leurs photographies et faire pivoter leur collection de photographies selon n’importe quelle propriété dans le système de propriétés Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-172">Users can then tag their photographs and pivot their collection of photographs based on any property in the Windows Property System.</span></span> <span data-ttu-id="e3378-173">En fait, tout ce que l’interpréteur de commandes utilise avec les propriétés, les développeurs tiers peuvent le faire dans leurs propres applications.</span><span class="sxs-lookup"><span data-stu-id="e3378-173">In fact, anything that Shell does with properties, third-party developers can do in their own applications.</span></span> <span data-ttu-id="e3378-174">Cela comprend le regroupement, le tri, l’interrogation et l’affichage des propriétés complètes.</span><span class="sxs-lookup"><span data-stu-id="e3378-174">This includes grouping, sorting, querying, and displaying full properties.</span></span> <span data-ttu-id="e3378-175">L’expérience utilisateur fournie par l’Explorateur Windows peut être largement implémentée par des tiers avec des API disponibles publiquement.</span><span class="sxs-lookup"><span data-stu-id="e3378-175">The user experience that Windows Explorer provides can be largely implemented by third parties with publically available APIs.</span></span> <span data-ttu-id="e3378-176">L’Explorateur Windows peut être remplacé ou étendu à l’aide de ces API.</span><span class="sxs-lookup"><span data-stu-id="e3378-176">Windows Explorer can be replaced or extended using these APIs.</span></span>

<span data-ttu-id="e3378-177">Du point de vue d’une application qui utilise le modèle de données Shell, il existe un grand nombre de scénarios qui impliquent l’utilisation du système de propriétés Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-177">From the point of view of an application that uses the Shell data model, there are a huge variety of scenarios that involve the use of the Windows property system.</span></span> <span data-ttu-id="e3378-178">Les applications de gestion des médias sont un exemple évident.</span><span class="sxs-lookup"><span data-stu-id="e3378-178">Media management applications are a prominent example.</span></span> <span data-ttu-id="e3378-179">Les scénarios de système de propriétés principaux incluent des scénarios tels que la lecture de la propriété de mot clé d’une photographie ou la définition de la propriété DateTaken.</span><span class="sxs-lookup"><span data-stu-id="e3378-179">Core property system scenarios include scenarios such as reading the keyword property of a photograph or setting the datetaken property.</span></span> <span data-ttu-id="e3378-180">Exemples de scénarios d’intégration de bout en bout que le système de propriétés Windows active, mais qui requièrent plusieurs autres composants pour fonctionner, incluent l’indication de toutes les images ou la recherche d’un document qui contient un mot clé.</span><span class="sxs-lookup"><span data-stu-id="e3378-180">Examples of end-to-end integration scenarios that the Windows Property System enables, but that require several other components to function, include showing all pictures, or finding a document that contains a keyword.</span></span>

## <a name="properties-and-windows-search"></a><span data-ttu-id="e3378-181">Propriétés et recherche Windows</span><span class="sxs-lookup"><span data-stu-id="e3378-181">Properties and Windows Search</span></span>

<span data-ttu-id="e3378-182">Les propriétés servent les producteurs et les consommateurs lorsqu’ils interagissent avec la recherche Windows et l’indexation.</span><span class="sxs-lookup"><span data-stu-id="e3378-182">Properties serve both producers and consumers when they interface with Windows Search and indexing.</span></span> <span data-ttu-id="e3378-183">Windows Search possède un cache de valeurs de propriétés qui sont utilisées dans l’implémentation de Windows Search Service (WSS).</span><span class="sxs-lookup"><span data-stu-id="e3378-183">Windows Search has a cache of property values that are used in the implementation of the Windows Search Service (WSS).</span></span> <span data-ttu-id="e3378-184">Ces valeurs de propriété peuvent être interrogées par programme à l’aide du fournisseur OLE DB de recherche Windows, ou via [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), qui représente des éléments dans les résultats de recherche et les vues basées sur des requêtes.</span><span class="sxs-lookup"><span data-stu-id="e3378-184">These property values can be programmatically queried by using the Windows Search OLE DB provider, or through [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), which represents items in search results and query-based views.</span></span> <span data-ttu-id="e3378-185">Windows Search collecte et stocke ensuite les propriétés émises par les gestionnaires de filtres ou les gestionnaires de propriétés lorsqu’un élément, tel qu’un document Word, est indexé.</span><span class="sxs-lookup"><span data-stu-id="e3378-185">Windows Search then collects and stores properties emitted by filter handlers or property handlers when an item such as a Word document is indexed.</span></span> <span data-ttu-id="e3378-186">Ce magasin est supprimé et reconstruit lors de la reconstruction de l’index.</span><span class="sxs-lookup"><span data-stu-id="e3378-186">This store is discarded and rebuilt when the index is rebuilt.</span></span>

> [!Note]  
> <span data-ttu-id="e3378-187">N’oubliez pas que lorsque vous réinscrivez un schéma, les modifications apportées aux attributs des propriétés précédemment définies peuvent ne pas être respectées par l’indexeur.</span><span class="sxs-lookup"><span data-stu-id="e3378-187">Remember that when you reregister a schema, changes made to attributes of previously defined properties may not be respected by the indexer.</span></span> <span data-ttu-id="e3378-188">La solution consiste soit à reconstruire l’index, soit à introduire de nouvelles propriétés reflétant les modifications au lieu de mettre à jour les anciennes.</span><span class="sxs-lookup"><span data-stu-id="e3378-188">The solution is either to rebuild the index, or introduce new properties that reflect the changes instead of updating old ones (not recommended).</span></span> <span data-ttu-id="e3378-189">Pour plus d’informations, consultez la section [Remarque à l’attention des implémenteurs](#note-to-implementers) plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="e3378-189">For more information, see [Note to Implementers](#note-to-implementers) later in this topic.</span></span>

 

<span data-ttu-id="e3378-190">Par exemple, un développeur qui crée une application multimédia souhaite montrer aux utilisateurs de l’application toutes les musiques disponibles par un artiste particulier.</span><span class="sxs-lookup"><span data-stu-id="e3378-190">For example, a developer creating a media application wants to show users of the application all available music by a particular artist.</span></span> <span data-ttu-id="e3378-191">L’application fournit à l’utilisateur une liste des artistes disponibles, puis génère une liste de toutes les musiques disponibles par l’artiste que l’utilisateur sélectionne.</span><span class="sxs-lookup"><span data-stu-id="e3378-191">The application would provide the user with a list of available artists, and then generate a list of all available music by the artist that the user selects.</span></span> <span data-ttu-id="e3378-192">Ou un utilisateur final peut vouloir effectuer une requête pour ? Artist : Beethoven ?, et être exposé à la liste complète des propriétés disponibles au cours de la recherche.</span><span class="sxs-lookup"><span data-stu-id="e3378-192">Or an end user might want to do a query for ?artist:Beethoven?, and be exposed to the full list of available properties in the course of their searche.</span></span> <span data-ttu-id="e3378-193">Cet exemple implique l’utilisation de l’espace de noms Shell, des gestionnaires de propriétés et/ou de l’interrogation de l’index par le biais de l’un des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="e3378-193">This example involves the use of the Shell namespace, property handlers, and/or querying the index through one of the following:</span></span>

-   <span data-ttu-id="e3378-194">Source de données Shell.</span><span class="sxs-lookup"><span data-stu-id="e3378-194">A Shell data source.</span></span>
-   <span data-ttu-id="e3378-195">Fournisseur OLE DB.</span><span class="sxs-lookup"><span data-stu-id="e3378-195">An OLE DB provider.</span></span>
-   <span data-ttu-id="e3378-196">Fichier de recherche enregistré (. search-ms) utilisé pour lancer une requête en accédant au fichier de recherche dans l’Explorateur Windows ou en liant la liaison à [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) par programmation.</span><span class="sxs-lookup"><span data-stu-id="e3378-196">A Saved Search file (.search-ms) that is used to initiate a query by navigating to the search file in Windows Explorer or binding to [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) programmatically.</span></span>

> [!Note]  
> <span data-ttu-id="e3378-197">Bien que la `System.Kind` propriété ne participe pas à ce scénario d’application multimédia, elle peut être utilisée pour générer une requête qui retourne tous les fichiers. search-ms dans une étendue particulière.</span><span class="sxs-lookup"><span data-stu-id="e3378-197">Although the `System.Kind` property does not participate in this media application scenario, it could be used to build a query that would return all of the .search-ms files in a particular scope.</span></span>

 

<span data-ttu-id="e3378-198">La meilleure façon d’accéder aux API de recherche et de créer des applications Windows Search consiste à utiliser une source de données Shell.</span><span class="sxs-lookup"><span data-stu-id="e3378-198">The preferred way to access the Search APIs and create Windows Search applications is through a Shell data source.</span></span> <span data-ttu-id="e3378-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) est un composant qui peut créer des instances de la source de données du dossier de recherche, qui est un type de source de données « virtuelles » fourni par le shell qui peut exécuter des requêtes sur d’autres sources de données dans l’espace de noms Shell et énumérer les résultats.</span><span class="sxs-lookup"><span data-stu-id="e3378-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is a component that can create instances of the Search folder data source, which is a sort of "virtual" data source provided by the Shell that can execute queries over other data sources in the Shell namespace and enumerate results.</span></span> <span data-ttu-id="e3378-200">Il peut le faire à l’aide de l’indexeur ou en énumérant manuellement et en inspectant des éléments dans les étendues spécifiées.</span><span class="sxs-lookup"><span data-stu-id="e3378-200">It can do so either by using the indexer, or by manually enumerating and inspecting items in the specified scopes.</span></span>

<span data-ttu-id="e3378-201">Les développeurs tiers peuvent créer des applications qui consomment les données de l’index par le biais de requêtes de programmation et peuvent étendre les données dans l’index pour les types de fichiers et d’éléments personnalisés à indexer par la recherche Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-201">Third-party developers can create applications that consume the data in the index through programmatic queries, and can extend the data in the index for custom file and item types to be indexed by Windows Search.</span></span> <span data-ttu-id="e3378-202">Si vous souhaitez afficher les résultats d’une requête dans l’Explorateur Windows, vous devez implémenter une source de données Shell avant de pouvoir créer un gestionnaire de protocole pour étendre l’index.</span><span class="sxs-lookup"><span data-stu-id="e3378-202">If you want to show query results in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="e3378-203">Toutefois, si toutes les requêtes sont par programmation (par exemple OLE DB) et interprétées par le code de l’application plutôt que par le shell, un espace de noms Shell est toujours préféré, mais pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="e3378-203">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application?s code rather than the Shell, then a Shell namespace is still preferred but not required.</span></span> <span data-ttu-id="e3378-204">Un gestionnaire de protocole est requis pour que Windows obtienne des informations sur le contenu des fichiers, tels que des éléments dans les bases de données ou des types de fichiers personnalisés.</span><span class="sxs-lookup"><span data-stu-id="e3378-204">A protocol handler is required for Windows to obtain information about file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="e3378-205">Alors que Windows Search peut indexer le nom et les propriétés du fichier, Windows ne dispose d’aucune information sur le contenu du fichier.</span><span class="sxs-lookup"><span data-stu-id="e3378-205">While Windows Search can index the name and properties of the file, Windows has no information about the content of the file.</span></span> <span data-ttu-id="e3378-206">Par conséquent, ces éléments ne peuvent pas être indexés ou exposés dans le shell Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-206">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="e3378-207">En implémentant un gestionnaire de protocole personnalisé, vous pouvez exposer ces éléments.</span><span class="sxs-lookup"><span data-stu-id="e3378-207">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="e3378-208">Pour obtenir la liste des gestionnaires identifiés par le scénario de développement que vous essayez d’atteindre, consultez « vue d’ensemble des gestionnaires » dans [Windows Search en tant que plateforme de développement](../search/-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="e3378-208">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](../search/-search-3x-wds-development-ovr.md).</span></span>

> [!Note]  
> <span data-ttu-id="e3378-209">Une source de données Shell est parfois appelée extension d’espace de noms Shell.</span><span class="sxs-lookup"><span data-stu-id="e3378-209">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="e3378-210">Un gestionnaire est parfois appelé extension d’interpréteur de commandes ou gestionnaire d’extensions de Shell.</span><span class="sxs-lookup"><span data-stu-id="e3378-210">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

## <a name="note-to-implementers"></a><span data-ttu-id="e3378-211">Remarque à l’attention des implémenteurs</span><span class="sxs-lookup"><span data-stu-id="e3378-211">Note to Implementers</span></span>

<span data-ttu-id="e3378-212">En raison des problèmes potentiels que l’indexeur peut avoir lors de l’utilisation du schéma du système de propriétés, il est essentiel de définir des attributs avec soin et de façon stratégique pour la première version du schéma.</span><span class="sxs-lookup"><span data-stu-id="e3378-212">Due to potential difficulties that the indexer may have when consuming the property system's schema, it is critical that you define attributes carefully and strategically for the first release of the schema.</span></span> <span data-ttu-id="e3378-213">Toutes les modifications apportées aux attributs (type, largeur de colonne, qu’il s’agisse de indexible) ne seront pas reflétées dans la base de données après l’inscription d’un schéma.</span><span class="sxs-lookup"><span data-stu-id="e3378-213">Any changes to attributes (type, column width, whether indexible) will not be reflected in the database after a schema has been registered.</span></span> <span data-ttu-id="e3378-214">Pour que ces modifications soient reconnues après que le schéma a été inscrit une fois sur un système, il suffit de reconstruire l’index, puis d’inscrire le nouveau schéma, ou d’inscrire le schéma, puis de créer une nouvelle propriété pour chaque version ultérieure. par exemple `PKEY_GroupName_PropertyNameV2` , `PKEY_GroupName_PropertyNameV3` , et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="e3378-214">The only ways to have these changes recognized after the schema has been registered once on a system would be either to rebuild the index and then register the new schema, or to register the schema and then create a new property for each subsequent release; for example `PKEY_GroupName_PropertyNameV2`, `PKEY_GroupName_PropertyNameV3`, and so forth.</span></span> <span data-ttu-id="e3378-215">Nous vous déconseillons de créer de nouvelles propriétés de cette manière, car plusieurs colonnes superflues peuvent avoir un impact sur les performances du système.</span><span class="sxs-lookup"><span data-stu-id="e3378-215">We do not recommend creating new properties in this manner, because multiple extraneous columns may impact system performance.</span></span>

## <a name="windows-property-system-documentation"></a><span data-ttu-id="e3378-216">Documentation du système de propriétés Windows</span><span class="sxs-lookup"><span data-stu-id="e3378-216">Windows Property System Documentation</span></span>

<span data-ttu-id="e3378-217">Le reste de cette documentation contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="e3378-217">The remainder of this documentation contains the following sections:</span></span>

-   [<span data-ttu-id="e3378-218">Guide du développeur du système de propriétés Windows</span><span class="sxs-lookup"><span data-stu-id="e3378-218">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)

    <span data-ttu-id="e3378-219">Décrit en détail comment implémenter les principaux scénarios de développement à l’aide du système de propriétés Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-219">Describes in detail how to implement the main development scenarios using the Windows Property System.</span></span>

-   [<span data-ttu-id="e3378-220">Référence du système de propriétés</span><span class="sxs-lookup"><span data-stu-id="e3378-220">Property System Reference</span></span>](property-system-reference.md)

    <span data-ttu-id="e3378-221">Documente les [Propriétés Windows](props.md), le [schéma de description de propriété](property-description-schema.md), les [interfaces](interfaces.md), les [fonctions](functions.md), les [structures](structures.md), les [constantes, les énumérations et les indicateurs](constants--enumerations--and-flags.md) du système de propriétés Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-221">Documents the [Windows Properties](props.md), [Property Description Schema](property-description-schema.md), [Interfaces](interfaces.md), [Functions](functions.md), [Structures](structures.md), and [Constants, Enumerations, and Flags](constants--enumerations--and-flags.md) of the Windows Property System.</span></span>

-   [<span data-ttu-id="e3378-222">Exemples de code du système de propriétés</span><span class="sxs-lookup"><span data-stu-id="e3378-222">Property System Code Samples</span></span>](property-system-code-samples.md)

    <span data-ttu-id="e3378-223">Décrit des exemples qui montrent comment utiliser le système de propriétés Windows.</span><span class="sxs-lookup"><span data-stu-id="e3378-223">Describes samples that demonstrate how to use the Windows Property System.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="e3378-224">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="e3378-224">Additional Resources</span></span>

-   <span data-ttu-id="e3378-225">Pour plus d’informations sur la réutilisation du magasin de propriétés In-Memory, consultez [initialisation des gestionnaires de propriétés](building-property-handlers-property-handlers.md) et [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span><span class="sxs-lookup"><span data-stu-id="e3378-225">For information about reusing the In-Memory Property Store, see [Initializing Property Handlers](building-property-handlers-property-handlers.md) and [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span></span>
-   <span data-ttu-id="e3378-226">Pour obtenir une spécification du format de fichier binaire de la Banque de propriétés Microsoft, consultez [ \[ MS \_ PROPSTORE \] ](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span><span class="sxs-lookup"><span data-stu-id="e3378-226">For a specification of the Microsoft Property Store Binary File Format, see [\[MS\_PROPSTORE\]](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span></span>
-   <span data-ttu-id="e3378-227">La relation entre la recherche Windows et l’indexation, et l’extension de l’index, sont expliquées dans les rubriques suivantes de la recherche Windows :</span><span class="sxs-lookup"><span data-stu-id="e3378-227">The relationship between Windows Search and indexing, and how to extend the index, are explained in the following topics in Windows Search:</span></span>
    -   [<span data-ttu-id="e3378-228">Développement de gestionnaires de filtres pour Windows Search</span><span class="sxs-lookup"><span data-stu-id="e3378-228">Developing Filter Handlers for Windows Search</span></span>](../search/-search-ifilter-conceptual.md)
    -   [<span data-ttu-id="e3378-229">Développement de gestionnaires de protocole pour Windows Search</span><span class="sxs-lookup"><span data-stu-id="e3378-229">Developing Protocol Handlers for Windows Search</span></span>](../search/-search-3x-wds-phaddins.md)
    -   [<span data-ttu-id="e3378-230">Développement de gestionnaires de propriétés pour Windows Search</span><span class="sxs-lookup"><span data-stu-id="e3378-230">Developing Property Handlers for Windows Search</span></span>](../search/-search-3x-wds-extidx-propertyhandlers.md)
    -   <span data-ttu-id="e3378-231">Pour le téléchargement du kit de développement logiciel (SDK) Windows Vista ou mis à jour, consultez le [SDK Windows](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span><span class="sxs-lookup"><span data-stu-id="e3378-231">For the Windows 7 or updated Windows Vista SDK download, see the [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span></span>

## <a name="related-topics"></a><span data-ttu-id="e3378-232">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e3378-232">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e3378-233">Guide du développeur du système de propriétés Windows</span><span class="sxs-lookup"><span data-stu-id="e3378-233">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)
</dt> <dt>

[<span data-ttu-id="e3378-234">Référence du système de propriétés</span><span class="sxs-lookup"><span data-stu-id="e3378-234">Property System Reference</span></span>](property-system-reference.md)
</dt> <dt>

[<span data-ttu-id="e3378-235">Exemples de code du système de propriétés</span><span class="sxs-lookup"><span data-stu-id="e3378-235">Property System Code Samples</span></span>](property-system-code-samples.md)
</dt> </dl>

 

 
