---
title: Utilisation de WER
description: À compter de Windows Vista, Windows fournit des rapports d’erreurs de panne, de non-réponse et de défaillance du noyau par défaut, sans nécessiter de modifications de votre application.
ms.assetid: c096cd89-e3a7-4959-a35f-40e6168f277e
keywords:
- Rapport d’erreurs Windows Rapport d’erreurs Windows, utilisation
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 655bed6d11757d7d4e08cd00ac47479e1246f96b
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104381773"
---
# <a name="using-wer"></a><span data-ttu-id="b400b-104">Utilisation de WER</span><span class="sxs-lookup"><span data-stu-id="b400b-104">Using WER</span></span>

<span data-ttu-id="b400b-105">À compter de Windows Vista, Windows fournit des rapports d’erreurs de panne, de non-réponse et de défaillance du noyau par défaut, sans nécessiter de modifications de votre application.</span><span class="sxs-lookup"><span data-stu-id="b400b-105">Beginning with Windows Vista, Windows provides crash, non-response, and kernel fault error reporting by default without requiring changes to your application.</span></span> <span data-ttu-id="b400b-106">Le rapport inclut des informations sur le Minidump et le vidage du tas, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b400b-106">The report will include minidump and heap dump information if required.</span></span> <span data-ttu-id="b400b-107">Les applications utilisent à la place l’API WER pour envoyer des rapports de problèmes spécifiques à l’application à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b400b-107">Applications instead use the WER API to send application-specific problem reports to Microsoft.</span></span>

<span data-ttu-id="b400b-108">Étant donné que Windows signale automatiquement les exceptions non gérées, l’application ne doit pas gérer les exceptions irrécupérables.</span><span class="sxs-lookup"><span data-stu-id="b400b-108">Because Windows automatically reports unhandled exceptions, application should not handle fatal exceptions.</span></span> <span data-ttu-id="b400b-109">Si le processus de défaillance ou de non-réponse est interactif, WER affiche une interface utilisateur qui informe l’utilisateur du problème.</span><span class="sxs-lookup"><span data-stu-id="b400b-109">If the faulting or not-responding process is interactive, WER displays a user interface informing the user of the problem.</span></span> <span data-ttu-id="b400b-110">Une application est considérée comme ne répondant pas si elle ne répond pas aux messages Windows pendant cinq secondes alors que l’utilisateur tente d’interagir avec l’application.</span><span class="sxs-lookup"><span data-stu-id="b400b-110">An application is considered unresponsive if it does not respond to Windows messages for five seconds while the user is trying to interact with the application.</span></span>

## <a name="windows-error-reporting-flow-for-crashes-non-response-and-kernel-faults"></a><span data-ttu-id="b400b-111">Rapport d’erreurs Windows le workflow pour les pannes, les non-réponses et les défaillances du noyau</span><span class="sxs-lookup"><span data-stu-id="b400b-111">Windows Error Reporting flow for crashes, non-response, and kernel faults</span></span>

<span data-ttu-id="b400b-112">L’exemple suivant montre les étapes qui se produisent pour un incident d’application, une non-réponse ou une erreur de noyau.</span><span class="sxs-lookup"><span data-stu-id="b400b-112">The following shows the steps that occur for an application crash, non-response, or kernel fault.</span></span>

1.  <span data-ttu-id="b400b-113">L’événement problème se produit.</span><span class="sxs-lookup"><span data-stu-id="b400b-113">The problem event occurs.</span></span>
2.  <span data-ttu-id="b400b-114">Le système d’exploitation appelle le WER.</span><span class="sxs-lookup"><span data-stu-id="b400b-114">The operating system invokes WER.</span></span>
3.  <span data-ttu-id="b400b-115">WER collecte les données, génère un rapport et invite l’utilisateur à donner son consentement (si nécessaire).</span><span class="sxs-lookup"><span data-stu-id="b400b-115">WER collects the data, builds a report, and prompts the user for consent (if needed).</span></span>
4.  <span data-ttu-id="b400b-116">WER envoie le rapport à Microsoft (serveur Watson) si l’utilisateur l’a accepté.</span><span class="sxs-lookup"><span data-stu-id="b400b-116">WER sends the report to Microsoft (Watson Server) if the user consented.</span></span>
5.  <span data-ttu-id="b400b-117">Si le serveur Watson demande des données supplémentaires, WER collecte les données et invite l’utilisateur à donner son consentement (si nécessaire).</span><span class="sxs-lookup"><span data-stu-id="b400b-117">If the Watson server requests additional data, WER collects the data and prompts the user for consent (if needed).</span></span>
6.  <span data-ttu-id="b400b-118">Si l’application s’est inscrite pour la récupération et le redémarrage, WER exécute les fonctions de rappel enregistrées pendant que les données sont compressées et envoyées à Microsoft (si l’utilisateur l’a accepté).</span><span class="sxs-lookup"><span data-stu-id="b400b-118">If the application has registered for recovery and restart, WER executes the registered callback functions while the data is compressed and sent to Microsoft (if the user consented).</span></span>
7.  <span data-ttu-id="b400b-119">Si une réponse au problème est disponible auprès de Microsoft, l’utilisateur est averti.</span><span class="sxs-lookup"><span data-stu-id="b400b-119">If a response to the problem is available from Microsoft, the user is notified.</span></span>

<span data-ttu-id="b400b-120">Les applications peuvent utiliser les fonctions suivantes pour personnaliser le contenu du rapport envoyé à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b400b-120">Applications can use the following functions to customize the contents of the report that is sent to Microsoft.</span></span> <span data-ttu-id="b400b-121">Les fonctions d’inscription indiquent à WER d’inclure les fichiers et blocs de mémoire spécifiques dans le rapport d’erreurs qu’il crée.</span><span class="sxs-lookup"><span data-stu-id="b400b-121">The registration functions tell WER to include the specific files and memory blocks in the error report that it creates.</span></span>

-   [<span data-ttu-id="b400b-122">**WerRegisterFile**</span><span class="sxs-lookup"><span data-stu-id="b400b-122">**WerRegisterFile**</span></span>](/windows/desktop/api/Werapi/nf-werapi-werregisterfile)
-   [<span data-ttu-id="b400b-123">**WerRegisterMemoryBlock**</span><span class="sxs-lookup"><span data-stu-id="b400b-123">**WerRegisterMemoryBlock**</span></span>](/windows/desktop/api/Werapi/nf-werapi-werregistermemoryblock)
-   [<span data-ttu-id="b400b-124">**WerSetFlags**</span><span class="sxs-lookup"><span data-stu-id="b400b-124">**WerSetFlags**</span></span>](/windows/desktop/api/Werapi/nf-werapi-wersetflags)
-   [<span data-ttu-id="b400b-125">**WerUnregisterFile**</span><span class="sxs-lookup"><span data-stu-id="b400b-125">**WerUnregisterFile**</span></span>](/windows/desktop/api/Werapi/nf-werapi-werunregisterfile)
-   [<span data-ttu-id="b400b-126">**WerUnregisterMemoryBlock**</span><span class="sxs-lookup"><span data-stu-id="b400b-126">**WerUnregisterMemoryBlock**</span></span>](/windows/desktop/api/Werapi/nf-werapi-werunregistermemoryblock)
-   [<span data-ttu-id="b400b-127">**WerGetFlags**</span><span class="sxs-lookup"><span data-stu-id="b400b-127">**WerGetFlags**</span></span>](/windows/desktop/api/Werapi/nf-werapi-wergetflags)

## <a name="windows-error-reporting-flow-for-generic-event-reporting"></a><span data-ttu-id="b400b-128">Rapport d’erreurs Windows le Flow pour les rapports d’événements génériques</span><span class="sxs-lookup"><span data-stu-id="b400b-128">Windows Error Reporting flow for generic event reporting</span></span>

<span data-ttu-id="b400b-129">Les étapes suivantes montrent comment les applications peuvent obtenir un rapport d’erreurs pour une condition d’erreur récupérable.</span><span class="sxs-lookup"><span data-stu-id="b400b-129">The following steps show how applications can get an error report for a non-fatal error condition.</span></span>

1.  <span data-ttu-id="b400b-130">L’événement problème non récupérable se produit.</span><span class="sxs-lookup"><span data-stu-id="b400b-130">The non-fatal problem event occurs.</span></span>
2.  <span data-ttu-id="b400b-131">L’application reconnaît l’événement et utilise la séquence suivante d’appels de fonction pour générer le rapport.</span><span class="sxs-lookup"><span data-stu-id="b400b-131">The application recognizes the event and uses the following sequence of function calls to generate the report.</span></span>
    1.  <span data-ttu-id="b400b-132">Appelez la fonction [**WerReportCreate**](/windows/desktop/api/Werapi/nf-werapi-werreportcreate) pour créer le rapport.</span><span class="sxs-lookup"><span data-stu-id="b400b-132">Call the [**WerReportCreate**](/windows/desktop/api/Werapi/nf-werapi-werreportcreate) function to create the report.</span></span>
    2.  <span data-ttu-id="b400b-133">Appelez la fonction [**WerReportSetParameter**](/windows/desktop/api/Werapi/nf-werapi-werreportsetparameter) pour définir les paramètres du rapport.</span><span class="sxs-lookup"><span data-stu-id="b400b-133">Call the [**WerReportSetParameter**](/windows/desktop/api/Werapi/nf-werapi-werreportsetparameter) function to set the report parameters.</span></span>
    3.  <span data-ttu-id="b400b-134">Appelez la fonction [**WerReportAddFile**](/windows/desktop/api/Werapi/nf-werapi-werreportaddfile) pour ajouter des fichiers au rapport.</span><span class="sxs-lookup"><span data-stu-id="b400b-134">Call the [**WerReportAddFile**](/windows/desktop/api/Werapi/nf-werapi-werreportaddfile) function to add files to the report.</span></span>
    4.  <span data-ttu-id="b400b-135">Appelez la fonction [**WerReportAddDump**](/windows/desktop/api/Werapi/nf-werapi-werreportadddump) pour ajouter un minidump au rapport (si nécessaire).</span><span class="sxs-lookup"><span data-stu-id="b400b-135">Call the [**WerReportAddDump**](/windows/desktop/api/Werapi/nf-werapi-werreportadddump) function to add a minidump to the report (if needed).</span></span>
    5.  <span data-ttu-id="b400b-136">Appelez la fonction [**WerReportSubmit**](/windows/desktop/api/Werapi/nf-werapi-werreportsubmit) pour envoyer le rapport.</span><span class="sxs-lookup"><span data-stu-id="b400b-136">Call the [**WerReportSubmit**](/windows/desktop/api/Werapi/nf-werapi-werreportsubmit) function to send the report.</span></span>
    6.  <span data-ttu-id="b400b-137">Appelez [**WerReportCloseHandle**](/windows/desktop/api/Werapi/nf-werapi-werreportclosehandle) pour libérer des ressources.</span><span class="sxs-lookup"><span data-stu-id="b400b-137">Call the [**WerReportCloseHandle**](/windows/desktop/api/Werapi/nf-werapi-werreportclosehandle) to free resources.</span></span>
3.  <span data-ttu-id="b400b-138">Selon les options spécifiques utilisées lors de l’appel des fonctions à l’étape 2, WER termine le rapport d’erreurs.</span><span class="sxs-lookup"><span data-stu-id="b400b-138">Depending on the specific options used when calling the functions in step 2, WER will finish the error reporting.</span></span> <span data-ttu-id="b400b-139">Le rapport d’erreurs Windows garantit que la création de rapports est effectuée conformément aux stratégies définies par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b400b-139">WER will ensure that the reporting is done in accordance with the policies set by the user.</span></span> <span data-ttu-id="b400b-140">Par exemple, WER envoie le rapport à Microsoft, met le rapport en file d’attente et affiche les interfaces utilisateur appropriées pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b400b-140">For example, WER will send the report to Microsoft, queue the report, and show the appropriate user interfaces to the user.</span></span>

## <a name="excluding-an-application-from-windows-error-reporting"></a><span data-ttu-id="b400b-141">Exclusion d’une application de Rapport d’erreurs Windows</span><span class="sxs-lookup"><span data-stu-id="b400b-141">Excluding an application from Windows Error Reporting</span></span>

<span data-ttu-id="b400b-142">Pour exclure votre application du rapport d’erreurs Windows, utilisez la fonction [**WerAddExcludedApplication**](/windows/desktop/api/Werapi/nf-werapi-weraddexcludedapplication) .</span><span class="sxs-lookup"><span data-stu-id="b400b-142">To exclude your application from Windows error reporting, use the [**WerAddExcludedApplication**](/windows/desktop/api/Werapi/nf-werapi-weraddexcludedapplication) function.</span></span> <span data-ttu-id="b400b-143">Pour restaurer les rapports d’erreurs de votre application, utilisez la fonction [**WerRemoveExcludedApplication**](/windows/desktop/api/Werapi/nf-werapi-werremoveexcludedapplication) .</span><span class="sxs-lookup"><span data-stu-id="b400b-143">To restore error reporting for your application, use the [**WerRemoveExcludedApplication**](/windows/desktop/api/Werapi/nf-werapi-werremoveexcludedapplication) function.</span></span>

## <a name="automatically-recovering-data-and-restarting-a-faulted-application"></a><span data-ttu-id="b400b-144">Récupération automatique des données et redémarrage d’une application défaillante</span><span class="sxs-lookup"><span data-stu-id="b400b-144">Automatically recovering data and restarting a faulted application</span></span>

<span data-ttu-id="b400b-145">Une application peut utiliser la récupération et le redémarrage de l’application pour enregistrer les données et les informations d’État avant la fermeture de l’application en raison d’une exception non gérée ou lorsque l’application cesse de répondre.</span><span class="sxs-lookup"><span data-stu-id="b400b-145">An application can use Application Recovery and Restart to save data and state information before the application exits due to an unhandled exception or when the application stops responding.</span></span> <span data-ttu-id="b400b-146">L’application est également redémarrée, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b400b-146">The application is also restarted, if requested.</span></span> <span data-ttu-id="b400b-147">Pour plus d’informations, consultez [récupération et redémarrage](/windows/desktop/Recovery/application-recovery-and-restart-portal)de l’application.</span><span class="sxs-lookup"><span data-stu-id="b400b-147">For details, see [Application Recovery and Restart](/windows/desktop/Recovery/application-recovery-and-restart-portal).</span></span>

## <a name="legacy-api"></a><span data-ttu-id="b400b-148">API héritée</span><span class="sxs-lookup"><span data-stu-id="b400b-148">Legacy API</span></span>

<span data-ttu-id="b400b-149">Une application peut signaler une erreur en appelant la fonction [**ReportFault**](/windows/desktop/api/ErrorRep/nf-errorrep-reportfault) .</span><span class="sxs-lookup"><span data-stu-id="b400b-149">An application can report a fault by calling the [**ReportFault**](/windows/desktop/api/ErrorRep/nf-errorrep-reportfault) function.</span></span> <span data-ttu-id="b400b-150">Toutefois, vous ne devez pas utiliser la fonction **ReportFault** , sauf si vous avez une exigence très spécifique selon laquelle le comportement de rapport d’erreurs par défaut du système d’exploitation ne peut pas être respecté.</span><span class="sxs-lookup"><span data-stu-id="b400b-150">However, you should not use the **ReportFault** function unless you have a very specific requirement that the operating system's default error reporting behavior cannot fulfill.</span></span>

<span data-ttu-id="b400b-151">Si le rapport d’erreurs est activé, le système affiche une boîte de dialogue indiquant à l’utilisateur que l’application a rencontré un problème et se ferme.</span><span class="sxs-lookup"><span data-stu-id="b400b-151">If error reporting is enabled, the system displays a dialog box to the user indicating that the application has encountered a problem and will close.</span></span> <span data-ttu-id="b400b-152">Si un débogueur est configuré dans la clé **HKEY \_ \_ \\ \\ AeDebug CurrentVersion Software Software Microsoft \\ Windows \\ NT \\ CurrentVersion** , l’utilisateur a la possibilité de lancer le débogueur.</span><span class="sxs-lookup"><span data-stu-id="b400b-152">If there is a debugger configured in the **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug** key, the user is given the option to launch the debugger.</span></span> <span data-ttu-id="b400b-153">L’utilisateur a également la possibilité d’envoyer un rapport à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b400b-153">The user is also given the option to send a report to Microsoft.</span></span> <span data-ttu-id="b400b-154">Si l’utilisateur envoie le rapport, le système affiche une autre boîte de dialogue en remerciant l’utilisateur pour le rapport et en fournissant un lien vers des informations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="b400b-154">If the user sends the report, the system displays another dialog box thanking the user for the report and providing a link to more information.</span></span>

<span data-ttu-id="b400b-155">Le système de création de rapports d’erreurs prend en charge les modes d’opération suivants.</span><span class="sxs-lookup"><span data-stu-id="b400b-155">The error reporting system supports the following operation modes.</span></span>



| <span data-ttu-id="b400b-156">Mode d’opération</span><span class="sxs-lookup"><span data-stu-id="b400b-156">Operation mode</span></span>          | <span data-ttu-id="b400b-157">Description</span><span class="sxs-lookup"><span data-stu-id="b400b-157">Description</span></span>                                                                                                                                                                                                                                                                                                                                  |
|-------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b400b-158">Rapport de mémoire partagée</span><span class="sxs-lookup"><span data-stu-id="b400b-158">Shared memory reporting</span></span> | <span data-ttu-id="b400b-159">Si le contexte de sécurité de l’application est le même que le contexte de sécurité de l’utilisateur connecté, le système de création de rapports d’erreurs utilise un bloc de mémoire partagée pour la communication.</span><span class="sxs-lookup"><span data-stu-id="b400b-159">If the application's security context is the same as the security context of the logged-on user, the error reporting system uses a block of shared memory for communication.</span></span> <span data-ttu-id="b400b-160">Ce mode ne peut pas être utilisé avec le mode rapport de manifeste.</span><span class="sxs-lookup"><span data-stu-id="b400b-160">This mode cannot be used with manifest reporting mode.</span></span><br/>                                                                                               |
| <span data-ttu-id="b400b-161">Création de rapports de manifeste</span><span class="sxs-lookup"><span data-stu-id="b400b-161">Manifest reporting</span></span>      | <span data-ttu-id="b400b-162">Si le contexte de sécurité de l’application n’est pas le même que le contexte de sécurité de l’utilisateur connecté, le système de création de rapports d’erreurs utilise un fichier pour la communication.</span><span class="sxs-lookup"><span data-stu-id="b400b-162">If the application's security context is not the same as the security context of the logged-on user, the error reporting system uses a file for communication.</span></span> <span data-ttu-id="b400b-163">Ce mode est également utilisé pour signaler les erreurs de noyau et les applications qui ne répondent pas.</span><span class="sxs-lookup"><span data-stu-id="b400b-163">This mode is also used for reporting unresponsive applications and kernel faults.</span></span> <span data-ttu-id="b400b-164">Ce mode ne peut pas être utilisé avec le mode de création de rapports de la mémoire partagée.</span><span class="sxs-lookup"><span data-stu-id="b400b-164">This mode cannot be used with shared memory reporting mode.</span></span><br/>                      |
| <span data-ttu-id="b400b-165">Rapports Internet</span><span class="sxs-lookup"><span data-stu-id="b400b-165">Internet reporting</span></span>      | <span data-ttu-id="b400b-166">Le système de rapport d’erreurs envoie toutes les données à Microsoft via Internet.</span><span class="sxs-lookup"><span data-stu-id="b400b-166">The error reporting system sends all data to Microsoft through the Internet.</span></span> <span data-ttu-id="b400b-167">Ceci est le mode de fonctionnement par défaut.</span><span class="sxs-lookup"><span data-stu-id="b400b-167">This is the default mode of operation.</span></span> <span data-ttu-id="b400b-168">Elle ne peut pas être utilisée avec le mode de création de rapports d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="b400b-168">It cannot be used with corporate reporting mode.</span></span> <span data-ttu-id="b400b-169">Ce mode est utilisé lorsqu’il n’existe aucun chemin de téléchargement d’entreprise spécifié par l’administrateur.</span><span class="sxs-lookup"><span data-stu-id="b400b-169">This mode is used when there is no corporate upload path specified by the administrator.</span></span><br/>                                                                     |
| <span data-ttu-id="b400b-170">Rapports d’entreprise</span><span class="sxs-lookup"><span data-stu-id="b400b-170">Corporate reporting</span></span>     | <span data-ttu-id="b400b-171">Le système de rapport d’erreurs envoie toutes les données à un partage de fichiers au lieu de les télécharger directement vers Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b400b-171">The error reporting system sends all data to a file share instead of uploading it directly to Microsoft.</span></span> <span data-ttu-id="b400b-172">Cela permet aux responsables informatiques d’entreprise d’examiner les données avant de les envoyer à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b400b-172">This allows corporate IT managers to review data before it is sent to Microsoft.</span></span> <span data-ttu-id="b400b-173">Ce mode est utilisé lorsqu’un chemin de téléchargement d’entreprise est spécifié par l’administrateur.</span><span class="sxs-lookup"><span data-stu-id="b400b-173">This mode is used when there is a corporate upload path specified by the administrator.</span></span> <span data-ttu-id="b400b-174">Elle ne peut pas être utilisée avec le mode de création de rapports Internet.</span><span class="sxs-lookup"><span data-stu-id="b400b-174">It cannot be used with Internet reporting mode.</span></span><br/> |
| <span data-ttu-id="b400b-175">Rapports headless</span><span class="sxs-lookup"><span data-stu-id="b400b-175">Headless reporting</span></span>      | <span data-ttu-id="b400b-176">Le système de rapport d’erreurs n’affiche pas de boîtes de dialogue à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b400b-176">The error reporting system will not display any dialog boxes to the user.</span></span> <span data-ttu-id="b400b-177">Cela permet aux responsables informatiques d’entreprise de collecter des rapports d’erreurs à tout moment auprès de leurs employés.</span><span class="sxs-lookup"><span data-stu-id="b400b-177">This allows corporate IT managers to collect error reports from their employees at all times.</span></span> <span data-ttu-id="b400b-178">Ce mode est utilisé lorsque la création de rapports est activée par l’administrateur, mais la notification est désactivée.</span><span class="sxs-lookup"><span data-stu-id="b400b-178">This mode is used when reporting is enabled by the administrator, but notification is disabled.</span></span> <span data-ttu-id="b400b-179">Il peut être utilisé uniquement avec le mode de création de rapports d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="b400b-179">It can be used only with corporate reporting mode.</span></span><br/>        |



 

<span data-ttu-id="b400b-180">Pour exclure votre application du rapport d’erreurs, utilisez la fonction [**AddERExcludedApplication**](/windows/desktop/api/ErrorRep/nf-errorrep-adderexcludedapplicationa) .</span><span class="sxs-lookup"><span data-stu-id="b400b-180">To exclude your application from error reporting, use the [**AddERExcludedApplication**](/windows/desktop/api/ErrorRep/nf-errorrep-adderexcludedapplicationa) function.</span></span>

 

