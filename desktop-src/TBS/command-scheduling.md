---
title: Planification des commandes
description: Une priorité est associée à chaque commande.
ms.assetid: 63f6ba9d-0b87-403b-916b-aa8550f98a11
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 06512f0748aa88f6b32de3291e2ed1c262212ba2
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "106513470"
---
# <a name="command-scheduling"></a><span data-ttu-id="372eb-103">Planification des commandes</span><span class="sxs-lookup"><span data-stu-id="372eb-103">Command Scheduling</span></span>

## <a name="command-scheduling"></a><span data-ttu-id="372eb-104">Planification des commandes</span><span class="sxs-lookup"><span data-stu-id="372eb-104">Command Scheduling</span></span>

<span data-ttu-id="372eb-105">Les commandes peuvent être envoyées au TBS à partir de plusieurs contextes à tout moment.</span><span class="sxs-lookup"><span data-stu-id="372eb-105">Commands can be submitted to the TBS from multiple contexts at any time.</span></span> <span data-ttu-id="372eb-106">Toutefois, un module de plateforme sécurisée physique ne peut traiter qu’une seule commande à la fois, et certaines commandes peuvent s’exécuter pendant une période de temps considérable.</span><span class="sxs-lookup"><span data-stu-id="372eb-106">However, a physical TPM can only process one command at a time, and some commands can run for a significant period of time.</span></span> <span data-ttu-id="372eb-107">Lorsque plusieurs commandes sont en attente, le TBS décide de la commande à envoyer au module de plateforme sécurisée.</span><span class="sxs-lookup"><span data-stu-id="372eb-107">When multiple commands are pending, the TBS decides which command to send to the TPM.</span></span> <span data-ttu-id="372eb-108">Lorsqu’une commande est envoyée, chaque commande est associée à une priorité.</span><span class="sxs-lookup"><span data-stu-id="372eb-108">When a command is submitted, each command has a priority associated with it.</span></span> <span data-ttu-id="372eb-109">Le TBS utilise ces priorités pour déterminer la commande en attente à envoyer chaque fois que le module de plateforme sécurisée est gratuit.</span><span class="sxs-lookup"><span data-stu-id="372eb-109">The TBS uses these priorities to determine which pending command to submit whenever the TPM is free.</span></span> <span data-ttu-id="372eb-110">Les quatre niveaux de priorité sont faible, normal, élevé et système.</span><span class="sxs-lookup"><span data-stu-id="372eb-110">The four levels of priority are low, normal, high, and system.</span></span> <span data-ttu-id="372eb-111">Les applications doivent utiliser une priorité faible, normale ou élevée.</span><span class="sxs-lookup"><span data-stu-id="372eb-111">Applications should use low, normal, or high priority.</span></span> <span data-ttu-id="372eb-112">Bien que les commandes de priorité élevée soient généralement exécutées avant les commandes de faible priorité, le planificateur de commandes TBS a une stratégie d’antériorité qui finit par donner une priorité très élevée aux commandes qui ont été bloquées pendant de longues périodes.</span><span class="sxs-lookup"><span data-stu-id="372eb-112">Although high-priority commands are usually executed before low-priority commands, the TBS command scheduler has an aging policy that eventually gives very high priority to commands that have been blocked for significant periods of time.</span></span>

## <a name="context-management"></a><span data-ttu-id="372eb-113">Gestion de contexte</span><span class="sxs-lookup"><span data-stu-id="372eb-113">Context Management</span></span>

<span data-ttu-id="372eb-114">Lorsqu’une \_ commande SAVECONTEXT TPM ou TPM2 ContextSave est soumise avec un descripteur virtuel à une ressource gérée par le TBS, le TBS exécute la commande appropriée sur la ressource physique et retourne le résultat à l’appelant si la ressource est physiquement présente dans le module de plateforme sécurisée.</span><span class="sxs-lookup"><span data-stu-id="372eb-114">When a TPM\_SaveContext or TPM2 ContextSave command is submitted with a virtual handle to a resource that the TBS is managing, the TBS executes the appropriate command on the physical resource and returns the result to the caller if the resource is physically present in the TPM.</span></span> <span data-ttu-id="372eb-115">Si la ressource n’est pas physiquement présente dans le module de plateforme sécurisée, le prétraitement de la \_ commande TPM SaveContext ou TPM2 \_ ContextSave entraîne le rechargement de la ressource, auquel cas le contexte est enregistré et retourné à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="372eb-115">If the resource is not physically present in the TPM, the preprocessing of the TPM\_SaveContext or TPM2\_ContextSave command causes the resource to be reloaded, at which point the context will be saved and returned to the caller.</span></span> <span data-ttu-id="372eb-116">Si la ressource enregistrée est d’un type qui est normalement vidé automatiquement du module de plateforme sécurisée après l’enregistrement, le TBS invalide la ressource virtuelle à la fin de cette commande.</span><span class="sxs-lookup"><span data-stu-id="372eb-116">If the resource being saved is of a type that is normally flushed automatically from the TPM after saving, the TBS invalidates the virtual resource upon completion of this command.</span></span> <span data-ttu-id="372eb-117">Lorsqu’une \_ commande TPM LoadContext ou TPM2 \_ ContextLoad est soumise au tbs, le TBS exécute la commande immédiatement.</span><span class="sxs-lookup"><span data-stu-id="372eb-117">When a TPM\_LoadContext or TPM2\_ContextLoad command is submitted to the TBS, the TBS executes the command immediately.</span></span> <span data-ttu-id="372eb-118">Si la commande se termine correctement, le TBS virtualise le handle de ressource et passe le flux d’octets GPC résultant à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="372eb-118">If the command completes successfully, the TBS virtualizes the resource handle and passes the resulting TPM byte stream to the caller.</span></span> <span data-ttu-id="372eb-119">Lorsqu’une \_ commande TPM FlushSpecific ou TPM2 \_ FlushContext est soumise avec un descripteur virtuel à une ressource gérée par le TBS, le TBS exécute une \_ commande TPM FlushSpecific ou TPM2 \_ FlushContext pour supprimer la ressource du module de plateforme sécurisée si elle est physiquement présente.</span><span class="sxs-lookup"><span data-stu-id="372eb-119">When a TPM\_FlushSpecific or TPM2\_FlushContext command is submitted with a virtual handle to a resource that the TBS is managing, the TBS executes a TPM\_FlushSpecific or TPM2\_FlushContext command to evict the resource from the TPM if it is physically present.</span></span> <span data-ttu-id="372eb-120">Dans ce cas, le TBS invalide la ressource virtuelle et retourne le résultat de la commande flush à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="372eb-120">In this case, the TBS invalidates the virtual resource and returns the result of the flush command to the caller.</span></span> <span data-ttu-id="372eb-121">Si la ressource n’est pas physiquement présente dans le module de plateforme sécurisée (TPM), le prétraitement de la \_ commande TPM FlushSpecific ou TPM2 \_ FlushContext chargera la ressource qui correspond au handle virtuel, mais elle sera vidée lors du traitement réel de la commande.</span><span class="sxs-lookup"><span data-stu-id="372eb-121">If the resource is not physically present in the TPM, the preprocessing of the TPM\_FlushSpecific or TPM2\_FlushContext command will load the resource that corresponds to the virtual handle, but it will then be flushed when the command is actually processed.</span></span> <span data-ttu-id="372eb-122">Le service TBS ne prend pas en charge le \_ bit TPM KeyControlOwner ou la fonctionnalité keepHandle de l' \_ opération LoadContext TPM, de sorte qu’il ne donne pas à une ressource le même handle que celui qu’il avait avant l’enregistrement du contexte.</span><span class="sxs-lookup"><span data-stu-id="372eb-122">The TBS does not support the TPM\_KeyControlOwner bit or the keepHandle functionality of the TPM\_LoadContext operation, so it will not give a resource the same handle it had before the context was saved.</span></span>

## <a name="other-commands"></a><span data-ttu-id="372eb-123">Autres commandes</span><span class="sxs-lookup"><span data-stu-id="372eb-123">Other Commands</span></span>

<span data-ttu-id="372eb-124">Les commandes qui ne sont pas mentionnées dans cette documentation sont traitées en remplaçant les handles de clé virtuelle par des handles de clé physique (si nécessaire) et en les envoyant au module de plateforme sécurisée.</span><span class="sxs-lookup"><span data-stu-id="372eb-124">Commands that are not mentioned in this documentation are processed by replacing virtual key handles with physical key handles (if necessary) and submitting them to the TPM.</span></span> <span data-ttu-id="372eb-125">Cette opération est effectuée après avoir effectué les opérations appropriées pour s’assurer que les ressources utilisées sont physiquement présentes sur le module de plateforme sécurisée.</span><span class="sxs-lookup"><span data-stu-id="372eb-125">This is done after performing the appropriate operations to ensure that resources being used are physically present on the TPM.</span></span> <span data-ttu-id="372eb-126">Aucun traitement spécial supplémentaire n’est effectué.</span><span class="sxs-lookup"><span data-stu-id="372eb-126">No additional special processing is performed.</span></span> <span data-ttu-id="372eb-127">Le TBS n’essaie pas d’améliorer la fidélité de la virtualisation en modifiant les données retournées du module de plateforme sécurisée dans le cadre d’une \_ requête TPM GetCapabilities ou TPM2 \_ GetCapability.</span><span class="sxs-lookup"><span data-stu-id="372eb-127">The TBS does not attempt to improve the fidelity of the virtualization by modifying data passed back from the TPM as part of a TPM\_GetCapabilities or TPM2\_GetCapability query.</span></span> <span data-ttu-id="372eb-128">Le TBS prend également en charge les commandes de présence physique TCG.</span><span class="sxs-lookup"><span data-stu-id="372eb-128">The TBS also supports TCG Physical Presence commands.</span></span> <span data-ttu-id="372eb-129">Le TBS agit comme une transmission directe pour les commandes de présence physique ; aucun traitement spécial n’est effectué par le TBS lui-même.</span><span class="sxs-lookup"><span data-stu-id="372eb-129">The TBS acts as a pass-through for Physical Presence commands; no special processing is performed by the TBS itself.</span></span>

## <a name="cleanup"></a><span data-ttu-id="372eb-130">Nettoyage</span><span class="sxs-lookup"><span data-stu-id="372eb-130">Cleanup</span></span>

<span data-ttu-id="372eb-131">Lorsqu’un contexte se termine, toutes les ressources physiques et virtuelles associées sont nettoyées afin qu’elles ne consomment plus de ressources système.</span><span class="sxs-lookup"><span data-stu-id="372eb-131">When a context exits, all physical and virtual resources associated with it are cleaned up so they no longer consume system resources.</span></span>

 

 




