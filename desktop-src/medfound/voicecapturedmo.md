---
description: Objet qui encapsule plusieurs DSP associés à la capture vocale.
ms.assetid: 6c77c8f6-289e-4130-b56a-e1f0bcc40f3e
title: DSP de capture vocale (Wmcodecdsp. h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 6e48c3b3194873008f45ef80ef3a21dad416158b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103755228"
---
# <a name="voice-capture-dsp"></a><span data-ttu-id="189a0-103">DSP de capture vocale</span><span class="sxs-lookup"><span data-stu-id="189a0-103">Voice Capture DSP</span></span>

<span data-ttu-id="189a0-104">Objet qui encapsule plusieurs DSP associés à la capture vocale.</span><span class="sxs-lookup"><span data-stu-id="189a0-104">An object that encapsulates several DSPs related to voice capture.</span></span>

## <a name="clsid"></a><span data-ttu-id="189a0-105">CLSID</span><span class="sxs-lookup"><span data-stu-id="189a0-105">CLSID</span></span>

<span data-ttu-id="189a0-106">CLSID \_ CWMAudioAEC</span><span class="sxs-lookup"><span data-stu-id="189a0-106">CLSID\_CWMAudioAEC</span></span>

## <a name="interfaces"></a><span data-ttu-id="189a0-107">Interfaces</span><span class="sxs-lookup"><span data-stu-id="189a0-107">Interfaces</span></span>

-   [<span data-ttu-id="189a0-108">**IMediaObject**</span><span class="sxs-lookup"><span data-stu-id="189a0-108">**IMediaObject**</span></span>](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject)
-   <span data-ttu-id="189a0-109">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="189a0-109">**IPropertyStore**</span></span>

## <a name="properties"></a><span data-ttu-id="189a0-110">Propriétés</span><span class="sxs-lookup"><span data-stu-id="189a0-110">Properties</span></span>



| <span data-ttu-id="189a0-111">Propriété</span><span class="sxs-lookup"><span data-stu-id="189a0-111">Property</span></span>                                                                                     | <span data-ttu-id="189a0-112">Description</span><span class="sxs-lookup"><span data-stu-id="189a0-112">Description</span></span>                                                                                       |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="189a0-113">\_index d' \_ appareils MFPKEY WMAAECMA \_</span><span class="sxs-lookup"><span data-stu-id="189a0-113">MFPKEY\_WMAAECMA\_DEVICE\_INDEXES</span></span>](mfpkey-wmaaecma-device-indexesproperty.md)              | <span data-ttu-id="189a0-114">Spécifie les périphériques audio utilisés par DMO pour la capture et le rendu audio.</span><span class="sxs-lookup"><span data-stu-id="189a0-114">Specifies which audio devices the DMO uses for capturing and rendering audio.</span></span>                     |
| [<span data-ttu-id="189a0-115">\_GUID MFPKEY WMAAECMA \_ DEVICEPAIR \_</span><span class="sxs-lookup"><span data-stu-id="189a0-115">MFPKEY\_WMAAECMA\_DEVICEPAIR\_GUID</span></span>](mfpkey-wmaaecma-devicepair-guidproperty.md)            | <span data-ttu-id="189a0-116">Identifie la combinaison de périphériques audio actuellement utilisée par l’application.</span><span class="sxs-lookup"><span data-stu-id="189a0-116">Identifies the combination of audio devices that the application is currently using.</span></span>              |
| [<span data-ttu-id="189a0-117">\_ \_ \_ mode Source MFPKEY WMAAECMA \_ DMO</span><span class="sxs-lookup"><span data-stu-id="189a0-117">MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE</span></span>](mfpkey-wmaaecma-dmo-source-modeproperty.md)           | <span data-ttu-id="189a0-118">Spécifie si DMO utilise le mode source ou le mode filtre.</span><span class="sxs-lookup"><span data-stu-id="189a0-118">Specifies whether the DMO uses source mode or filter mode.</span></span>                                        |
| [<span data-ttu-id="189a0-119">MFPKEY \_ WMAAECMA \_ fonceur \_ AES</span><span class="sxs-lookup"><span data-stu-id="189a0-119">MFPKEY\_WMAAECMA\_FEATR\_AES</span></span>](mfpkey-wmaaecma-featr-aesproperty.md)                        | <span data-ttu-id="189a0-120">Spécifie le nombre de fois où DMO effectue la suppression de l’écho acoustique (AES) sur le signal résiduel.</span><span class="sxs-lookup"><span data-stu-id="189a0-120">Specifies how many times the DMO performs acoustic echo suppression (AES) on the residual signal.</span></span> |
| [<span data-ttu-id="189a0-121">MFPKEY \_ WMAAECMA \_ Fonct, \_ AGC</span><span class="sxs-lookup"><span data-stu-id="189a0-121">MFPKEY\_WMAAECMA\_FEATR\_AGC</span></span>](mfpkey-wmaaecma-featr-agcproperty.md)                        | <span data-ttu-id="189a0-122">Spécifie si DMO effectue un contrôle d’augmentation automatique.</span><span class="sxs-lookup"><span data-stu-id="189a0-122">Specifies whether the DMO performs automatic gain control.</span></span>                                        |
| [<span data-ttu-id="189a0-123">\_clip du \_ \_ Centre \_ d’MFPKEY WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="189a0-123">MFPKEY\_WMAAECMA\_FEATR\_CENTER\_CLIP</span></span>](mfpkey-wmaaecma-featr-center-clipproperty.md)       | <span data-ttu-id="189a0-124">Spécifie si DMO effectue un découpage central.</span><span class="sxs-lookup"><span data-stu-id="189a0-124">Specifies whether the DMO performs center clipping.</span></span>                                               |
| [<span data-ttu-id="189a0-125">longueur de l' \_ \_ écho du Feature WMAAECMA MFPKEY \_ \_</span><span class="sxs-lookup"><span data-stu-id="189a0-125">MFPKEY\_WMAAECMA\_FEATR\_ECHO\_LENGTH</span></span>](mfpkey-wmaaecma-featr-echo-lengthproperty.md)       | <span data-ttu-id="189a0-126">Spécifie la durée d’écho que l’algorithme d’annulation de l’écho acoustique (AEC) peut gérer.</span><span class="sxs-lookup"><span data-stu-id="189a0-126">Specifies the duration of echo that the acoustic echo cancellation (AEC) algorithm can handle.</span></span>    |
| [<span data-ttu-id="189a0-127">\_taille du \_ \_ frame \_ de MFPKEY WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="189a0-127">MFPKEY\_WMAAECMA\_FEATR\_FRAME\_SIZE</span></span>](mfpkey-wmaaecma-featr-frame-sizeproperty.md)         | <span data-ttu-id="189a0-128">Spécifie la taille du cadre audio.</span><span class="sxs-lookup"><span data-stu-id="189a0-128">Specifies the audio frame size.</span></span>                                                                   |
| [<span data-ttu-id="189a0-129">MFPKEY \_ WMAAECMA \_ fonceur \_ MICARR \_</span><span class="sxs-lookup"><span data-stu-id="189a0-129">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_BEAM</span></span>](mfpkey-wmaaecma-featr-micarr-beamproperty.md)       | <span data-ttu-id="189a0-130">Spécifie la poutre utilisée par DMO pour le traitement du tableau de microphone.</span><span class="sxs-lookup"><span data-stu-id="189a0-130">Specifies which beam the DMO uses for microphone array processing.</span></span>                                |
| [<span data-ttu-id="189a0-131">\_ \_ \_ mode MICARR MFPKEY WMAAECMA \_</span><span class="sxs-lookup"><span data-stu-id="189a0-131">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_MODE</span></span>](mfpkey-wmaaecma-featr-micarr-modeproperty.md)       | <span data-ttu-id="189a0-132">Spécifie la manière dont DMO effectue le traitement du tableau de microphone.</span><span class="sxs-lookup"><span data-stu-id="189a0-132">Specifies how the DMO performs microphone array processing.</span></span>                                       |
| [<span data-ttu-id="189a0-133">MFPKEY \_ WMAAECMA \_ Feature \_ MICARR \_ préproc</span><span class="sxs-lookup"><span data-stu-id="189a0-133">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_PREPROC</span></span>](mfpkey-wmaaecma-featr-micarr-preprocproperty.md) | <span data-ttu-id="189a0-134">Spécifie si DMO effectue le prétraitement des tableaux de microphones.</span><span class="sxs-lookup"><span data-stu-id="189a0-134">Specifies whether the DMO performs microphone array preprocessing.</span></span>                                |
| [<span data-ttu-id="189a0-135">\_remplissage du \_ \_ bruit \_ du MFPKEY WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="189a0-135">MFPKEY\_WMAAECMA\_FEATR\_NOISE\_FILL</span></span>](mfpkey-wmaaecma-featr-noise-fillproperty.md)         | <span data-ttu-id="189a0-136">Spécifie si DMO effectue un remplissage de bruit.</span><span class="sxs-lookup"><span data-stu-id="189a0-136">Specifies whether the DMO performs noise filling.</span></span>                                                 |
| [<span data-ttu-id="189a0-137">MFPKEY \_ WMAAECMA \_ Feature \_</span><span class="sxs-lookup"><span data-stu-id="189a0-137">MFPKEY\_WMAAECMA\_FEATR\_NS</span></span>](mfpkey-wmaaecma-featr-nsproperty.md)                          | <span data-ttu-id="189a0-138">Spécifie si DMO effectue la suppression du bruit.</span><span class="sxs-lookup"><span data-stu-id="189a0-138">Specifies whether the DMO performs noise suppression.</span></span>                                             |
| [<span data-ttu-id="189a0-139">\_VAD MFPKEY WMAAECMA \_ Fonct \_</span><span class="sxs-lookup"><span data-stu-id="189a0-139">MFPKEY\_WMAAECMA\_FEATR\_VAD</span></span>](mfpkey-wmaaecma-featr-vadproperty.md)                        | <span data-ttu-id="189a0-140">Spécifie le type de détection d’activité vocale effectuée par DMO.</span><span class="sxs-lookup"><span data-stu-id="189a0-140">Specifies the type of voice activity detection that the DMO performs.</span></span>                             |
| [<span data-ttu-id="189a0-141">MODE de fonctionnalité de MFPKEY \_ WMAAECMA \_ \_</span><span class="sxs-lookup"><span data-stu-id="189a0-141">MFPKEY\_WMAAECMA\_FEATURE\_MODE</span></span>](mfpkey-wmaaecma-feature-modeproperty.md)                  | <span data-ttu-id="189a0-142">Permet à l’application de remplacer les paramètres par défaut de différentes propriétés.</span><span class="sxs-lookup"><span data-stu-id="189a0-142">Enables the application to override the default settings on various properties.</span></span>                   |
| [<span data-ttu-id="189a0-143">\_ \_ \_ limiteur de gain MFPKEY WMAAECMA MIC \_</span><span class="sxs-lookup"><span data-stu-id="189a0-143">MFPKEY\_WMAAECMA\_MIC\_GAIN\_BOUNDER</span></span>](mfpkey-wmaaecma-mic-gain-bounderproperty.md)         | <span data-ttu-id="189a0-144">Spécifie si la méthode DMO applique la limite d’augmentation du microphone.</span><span class="sxs-lookup"><span data-stu-id="189a0-144">Specifies whether the DMO applies microphone gain bounding.</span></span>                                       |
| [<span data-ttu-id="189a0-145">MFPKEY \_ WMAAECMA \_ MICARRAY \_ DESCPTR</span><span class="sxs-lookup"><span data-stu-id="189a0-145">MFPKEY\_WMAAECMA\_MICARRAY\_DESCPTR</span></span>](mfpkey-wmaaecma-micarray-descptrproperty.md)          | <span data-ttu-id="189a0-146">Spécifie la géométrie du tableau du microphone.</span><span class="sxs-lookup"><span data-stu-id="189a0-146">Specifies the microphone array geometry.</span></span>                                                          |
| [<span data-ttu-id="189a0-147">\_ \_ métriques de qualité MFPKEY WMAAECMA \_</span><span class="sxs-lookup"><span data-stu-id="189a0-147">MFPKEY\_WMAAECMA\_QUALITY\_METRICS</span></span>](mfpkey-wmaaecma-quality-metricsproperty.md)            | <span data-ttu-id="189a0-148">Récupère les mesures de qualité pour AEC.</span><span class="sxs-lookup"><span data-stu-id="189a0-148">Retrieves quality metrics for AEC.</span></span>                                                                |
| [<span data-ttu-id="189a0-149">MFPKEY \_ WMAAECMA \_ récupérer \_ les \_ statistiques TS</span><span class="sxs-lookup"><span data-stu-id="189a0-149">MFPKEY\_WMAAECMA\_RETRIEVE\_TS\_STATS</span></span>](mfpkey-wmaaecma-retrieve-ts-statsproperty.md)       | <span data-ttu-id="189a0-150">Spécifie si DMO stocke des statistiques de datage dans le registre.</span><span class="sxs-lookup"><span data-stu-id="189a0-150">Specifies whether the DMO stores time stamp statistics in the registry.</span></span>                           |
| [<span data-ttu-id="189a0-151">\_ \_ mode système MFPKEY \_ WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="189a0-151">MFPKEY\_WMAAECMA\_SYSTEM\_MODE</span></span>](mfpkey-wmaaecma-system-modeproperty.md)                    | <span data-ttu-id="189a0-152">Définit le mode de traitement.</span><span class="sxs-lookup"><span data-stu-id="189a0-152">Sets the processing mode.</span></span>                                                                         |



 

## <a name="remarks"></a><span data-ttu-id="189a0-153">Notes</span><span class="sxs-lookup"><span data-stu-id="189a0-153">Remarks</span></span>

<span data-ttu-id="189a0-154">Contrairement aux autres DSP, l’objet de capture vocale encapsule plusieurs DSP dans un objet unique, et l’objet est un objet DMO uniquement (il n’implémente pas [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span><span class="sxs-lookup"><span data-stu-id="189a0-154">Unlike the other DSPs, the voice capture object encapsulates multiple DSPs in a single object, and the object is a DMO object only (it does not implement [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span></span> <span data-ttu-id="189a0-155">La capture vocale DMO comprend les composants DSP suivants :</span><span class="sxs-lookup"><span data-stu-id="189a0-155">The voice capture DMO includes the following DSP components:</span></span>

-   <span data-ttu-id="189a0-156">Annulation de l’écho acoustique (AEC)</span><span class="sxs-lookup"><span data-stu-id="189a0-156">Acoustic echo cancellation (AEC)</span></span>
-   <span data-ttu-id="189a0-157">Traitement du tableau du microphone</span><span class="sxs-lookup"><span data-stu-id="189a0-157">Microphone array processing</span></span>
-   <span data-ttu-id="189a0-158">Suppression du bruit</span><span class="sxs-lookup"><span data-stu-id="189a0-158">Noise suppression</span></span>
-   <span data-ttu-id="189a0-159">Contrôle du gain automatique</span><span class="sxs-lookup"><span data-stu-id="189a0-159">Automatic gain control</span></span>
-   <span data-ttu-id="189a0-160">Détection de l’activité vocale</span><span class="sxs-lookup"><span data-stu-id="189a0-160">Voice activity detection</span></span>

<span data-ttu-id="189a0-161">Les applications peuvent activer et désactiver chaque composant individuellement.</span><span class="sxs-lookup"><span data-stu-id="189a0-161">Applications can turn each component on and off individually.</span></span>

<span data-ttu-id="189a0-162">La capture vocale DMO prend en charge deux modes d’opération : le mode *filtre* et le mode *source* .</span><span class="sxs-lookup"><span data-stu-id="189a0-162">The voice capture DMO supports two modes of operation, *filter* mode and *source* mode.</span></span> <span data-ttu-id="189a0-163">En mode filtre, l’application envoie des échantillons audio à partir du microphone et de la ligne de haut-parleur à la requête DMO, et la requête DMO produit une sortie.</span><span class="sxs-lookup"><span data-stu-id="189a0-163">In filter mode, the application sends audio samples from the microphone and from the speaker line to the DMO, and the DMO produces output.</span></span>

<span data-ttu-id="189a0-164">En mode Source, l’application n’a pas besoin de fournir des exemples à DMO.</span><span class="sxs-lookup"><span data-stu-id="189a0-164">In source mode, the application does not need to deliver samples to the DMO.</span></span> <span data-ttu-id="189a0-165">Au lieu de cela, DMO gère toutes les opérations sur les périphériques audio, y compris l’initialisation des appareils, la capture et la synchronisation des flux audio, le calcul des horodatages et la récupération de la géométrie du tableau du microphone.</span><span class="sxs-lookup"><span data-stu-id="189a0-165">Instead, the DMO manages all of the operations on the audio devices, including initializing the devices, capturing and synchronizing the audio streams, calculating time stamps, and retrieving the geometry of the microphone array.</span></span> <span data-ttu-id="189a0-166">En utilisant le mode Source, l’application configure simplement DMO, et la sortie de l’DMO est un signal de microphone propre et traité.</span><span class="sxs-lookup"><span data-stu-id="189a0-166">Using source mode, the application simply configures the DMO, and the output from the DMO is a clean, processed microphone signal.</span></span> <span data-ttu-id="189a0-167">Le mode source est beaucoup plus facile à utiliser que le mode filtre, et est recommandé pour la plupart des applications.</span><span class="sxs-lookup"><span data-stu-id="189a0-167">Source mode is significantly easier to use than filter mode, and is recommended for most applications.</span></span>

<span data-ttu-id="189a0-168">Actuellement, la capture de voix DMO ne prend en charge que l’annulation de l’écho acoustique (AEC) à canal unique. la sortie de la ligne de haut-parleur doit être monocanal.</span><span class="sxs-lookup"><span data-stu-id="189a0-168">Currently the voice capture DMO supports only single-channel acoustic echo cancellation (AEC), so the output from the speaker line must be single-channel.</span></span> <span data-ttu-id="189a0-169">Si le traitement du tableau de microphone est désactivé, l’entrée multicanal est repliée sur un canal pour le traitement AEC.</span><span class="sxs-lookup"><span data-stu-id="189a0-169">If microphone array processing is disabled, multi-channel input is folded down to one channel for AEC processing.</span></span> <span data-ttu-id="189a0-170">Si le traitement du tableau de microphone et le traitement AEC sont activés, l’AEC est exécuté sur chaque élément de microphone avant le traitement du tableau de microphone.</span><span class="sxs-lookup"><span data-stu-id="189a0-170">If both microphone array processing and AEC processing are enabled, AEC is performed on each microphone element before microphone array processing.</span></span>

### <a name="microphone-array-processing"></a><span data-ttu-id="189a0-171">Traitement du tableau du microphone</span><span class="sxs-lookup"><span data-stu-id="189a0-171">Microphone Array Processing</span></span>

<span data-ttu-id="189a0-172">Un tableau de microphone est un ensemble de microphones étroitement positionnés.</span><span class="sxs-lookup"><span data-stu-id="189a0-172">A microphone array is a set of closely positioned microphones.</span></span> <span data-ttu-id="189a0-173">Les tableaux de microphones offrent une meilleure direction qu’un seul microphone, car les ondes acoustiques arrivent à chaque microphone à une heure légèrement différente.</span><span class="sxs-lookup"><span data-stu-id="189a0-173">Microphone arrays achieve better directionality than a single microphone, because the acoustic waves arrive at each microphone at a slightly different time.</span></span> <span data-ttu-id="189a0-174">Pour plus d’informations sur les tableaux de microphones, consultez les articles Web [prise en charge des tableaux de microphone dans Windows Vista](/windows-hardware/design/component-guidelines/audio) et [comment créer et utiliser des tableaux de microphone pour Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span><span class="sxs-lookup"><span data-stu-id="189a0-174">For more information on microphone arrays see the web articles [Microphone Array Support in Windows Vista](/windows-hardware/design/component-guidelines/audio) and [How to Build and Use Microphone Arrays for Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span></span>

### <a name="using-the-voice-capture-dsp"></a><span data-ttu-id="189a0-175">Utilisation du DSP de capture vocale</span><span class="sxs-lookup"><span data-stu-id="189a0-175">Using the Voice Capture DSP</span></span>

<span data-ttu-id="189a0-176">Pour utiliser le DSP de capture vocale, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="189a0-176">To use the Voice Capture DSP, perform the following steps.</span></span>

### <a name="1-initialize-the-dmo"></a><span data-ttu-id="189a0-177">1. initialiser le DMO</span><span class="sxs-lookup"><span data-stu-id="189a0-177">1. Initialize the DMO</span></span>

<span data-ttu-id="189a0-178">Créez la capture vocale DMO en appelant [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) avec le CLSID **CLSID \_ CWMAudioAEC**.</span><span class="sxs-lookup"><span data-stu-id="189a0-178">Create the voice capture DMO by calling [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) with the CLSID **CLSID\_CWMAudioAEC**.</span></span> <span data-ttu-id="189a0-179">Le DSDP de capture vocale expose uniquement les interfaces [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) et [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) , de sorte qu’il ne peut être utilisé qu’en tant que DMO.</span><span class="sxs-lookup"><span data-stu-id="189a0-179">The voice capture DSDP exposes only the [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) and [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interfaces, so it can only be used as a DMO.</span></span>

<span data-ttu-id="189a0-180">La valeur par défaut d’DMO est le mode Source.</span><span class="sxs-lookup"><span data-stu-id="189a0-180">The DMO defaults to source mode.</span></span> <span data-ttu-id="189a0-181">Pour sélectionner le mode de filtre, affectez à la propriété [ \_ \_ \_ \_ mode Source MFPKEY WMAAECMA DMO](mfpkey-wmaaecma-dmo-source-modeproperty.md) la valeur **Variant \_ false**.</span><span class="sxs-lookup"><span data-stu-id="189a0-181">To select filter mode, set the [MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE](mfpkey-wmaaecma-dmo-source-modeproperty.md) property to **VARIANT\_FALSE**.</span></span>

<span data-ttu-id="189a0-182">Ensuite, configurez les propriétés internes de l’interface DMO à l’aide de l’interface [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) .</span><span class="sxs-lookup"><span data-stu-id="189a0-182">Next, configure the internal properties of the DMO by using the [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interface.</span></span> <span data-ttu-id="189a0-183">La seule propriété qu’une application doit définir est la propriété du [ \_ \_ \_ mode système MFPKEY WMAAECMA](mfpkey-wmaaecma-system-modeproperty.md) .</span><span class="sxs-lookup"><span data-stu-id="189a0-183">The only property that an application must set is the [MFPKEY\_WMAAECMA\_SYSTEM\_MODE](mfpkey-wmaaecma-system-modeproperty.md) property.</span></span> <span data-ttu-id="189a0-184">Cette propriété configure le pipeline de traitement dans DMO.</span><span class="sxs-lookup"><span data-stu-id="189a0-184">This property configures the processing pipeline within the DMO.</span></span> <span data-ttu-id="189a0-185">Les autres propriétés sont facultatives.</span><span class="sxs-lookup"><span data-stu-id="189a0-185">The other properties are optional.</span></span>

### <a name="2-set-the-input-and-output-formats"></a><span data-ttu-id="189a0-186">2. définir les formats d’entrée et de sortie</span><span class="sxs-lookup"><span data-stu-id="189a0-186">2. Set the Input and Output Formats</span></span>

<span data-ttu-id="189a0-187">Si vous utilisez DMO en mode filtre, définissez le format d’entrée en appelant [**IMediaObject :: SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span><span class="sxs-lookup"><span data-stu-id="189a0-187">If you are using the DMO in filter mode, set the input format by calling [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span></span> <span data-ttu-id="189a0-188">Le format d’entrée peut être quasiment n’importe quel type audio à virgule flottante PCM ou IEEE non compressé valide.</span><span class="sxs-lookup"><span data-stu-id="189a0-188">The input format can be almost any valid uncompressed PCM or IEEE floating-point audio type.</span></span> <span data-ttu-id="189a0-189">Si le format d’entrée ne correspond pas au format de sortie, DMO effectue automatiquement la conversion du taux d’échantillonnage.</span><span class="sxs-lookup"><span data-stu-id="189a0-189">If the input format does not match the output format, the DMO automatically performs sample-rate conversion.</span></span>

<span data-ttu-id="189a0-190">Si vous utilisez DMO en mode Source, ne définissez pas le format d’entrée.</span><span class="sxs-lookup"><span data-stu-id="189a0-190">If you are using the DMO in source mode, do not set the input format.</span></span> <span data-ttu-id="189a0-191">DMO configure automatiquement le format d’entrée en fonction des périphériques audio.</span><span class="sxs-lookup"><span data-stu-id="189a0-191">The DMO automatically configures the input format based on the audio devices.</span></span>

<span data-ttu-id="189a0-192">Dans l’un ou l’autre mode, définissez le format de sortie en appelant [**IMediaObject :: SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="189a0-192">In either mode, set the output format by calling [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span></span> <span data-ttu-id="189a0-193">DMO peut accepter les formats de sortie suivants :</span><span class="sxs-lookup"><span data-stu-id="189a0-193">The DMO can accept the following output formats:</span></span>

-   <span data-ttu-id="189a0-194">Sous-type : **MEDIASUBTYPE \_ PCM** ou **MEDIASUBTYPE \_ IEEE \_ float**</span><span class="sxs-lookup"><span data-stu-id="189a0-194">Subtype: **MEDIASUBTYPE\_PCM** or **MEDIASUBTYPE\_IEEE\_FLOAT**</span></span>
-   <span data-ttu-id="189a0-195">Bloc de format : [**WaveFormat**](/windows/win32/api/mmreg/ns-mmreg-waveformat) ou [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="189a0-195">Format block: [**WAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-waveformat) or [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span></span>
-   <span data-ttu-id="189a0-196">Échantillons par seconde : 8 000 ; 11 025 ; 16 000 ; ou 22 050</span><span class="sxs-lookup"><span data-stu-id="189a0-196">Samples per second: 8,000; 11,025; 16,000; or 22,050</span></span>
-   <span data-ttu-id="189a0-197">Canaux : 1 pour le mode AEC uniquement, 2 ou 4 pour le traitement du tableau de microphone</span><span class="sxs-lookup"><span data-stu-id="189a0-197">Channels: 1 for AEC-only mode, 2 or 4 for microphone array processing</span></span>
-   <span data-ttu-id="189a0-198">Bits par échantillon : 16</span><span class="sxs-lookup"><span data-stu-id="189a0-198">Bits per sample: 16</span></span>

<span data-ttu-id="189a0-199">Le code suivant définit le type de sortie sur un audio PCM monocanal 16 bits :</span><span class="sxs-lookup"><span data-stu-id="189a0-199">The following code sets the output type to 16-bit single-channel PCM audio:</span></span>


```
DMO_MEDIA_TYPE mt;  // Media type.
mt.majortype = MEDIATYPE_Audio;
mt.subtype = MEDIASUBTYPE_PCM;
mt.lSampleSize = 0;
mt.bFixedSizeSamples = TRUE;
mt.bTemporalCompression = FALSE;
mt.formattype = FORMAT_WaveFormatEx;

// Allocate the format block to hold the WAVEFORMATEX structure.
hr = MoInitMediaType(&mt, sizeof(WAVEFORMATEX));
if (SUCCEEDED(hr))
{
    WAVEFORMATEX *pwav = (WAVEFORMATEX*)mt.pbFormat;
    pwav->wFormatTag = WAVE_FORMAT_PCM;
    pwav->nChannels = 1;
    pwav->nSamplesPerSec = 16000;
    pwav->nAvgBytesPerSec = 32000;
    pwav->nBlockAlign = 2;
    pwav->wBitsPerSample = 16;
    pwav->cbSize = 0;

    // Set the output type.
    if (SUCCEEDED(hr))
    {
        hr = pDMO->SetOutputType(0, &mt, 0); 
    }
    // Free the format block.
    MoFreeMediaType(&mt);
}
```



### <a name="3-process-data"></a><span data-ttu-id="189a0-200">3. traiter les données</span><span class="sxs-lookup"><span data-stu-id="189a0-200">3. Process Data</span></span>

<span data-ttu-id="189a0-201">Avant de traiter des données, il est recommandé d’appeler [**IMediaObject :: AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span><span class="sxs-lookup"><span data-stu-id="189a0-201">Before processing any data, it is recommended to call [**IMediaObject::AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span></span> <span data-ttu-id="189a0-202">Cette méthode alloue les ressources utilisées en interne par DMO.</span><span class="sxs-lookup"><span data-stu-id="189a0-202">This method allocates the resources used internally by the DMO.</span></span> <span data-ttu-id="189a0-203">Appelez **AllocateStreamingResources** après les étapes indiquées précédemment, pas avant.</span><span class="sxs-lookup"><span data-stu-id="189a0-203">Call **AllocateStreamingResources** after the steps listed previously, not before.</span></span> <span data-ttu-id="189a0-204">Si vous n’appelez pas cette méthode, DMO alloue automatiquement les ressources lors du démarrage du traitement des données.</span><span class="sxs-lookup"><span data-stu-id="189a0-204">If you do not call this method, the DMO automatically allocates resources when data processing starts.</span></span>

<span data-ttu-id="189a0-205">Si vous utilisez DMO en mode filtre, vous devez transmettre les données d’entrée à la requête DMO en appelant [**IMediaObject ::P rocessinput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span><span class="sxs-lookup"><span data-stu-id="189a0-205">If you are using the DMO in filter mode, you must pass input data to the DMO by calling [**IMediaObject::ProcessInput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span></span> <span data-ttu-id="189a0-206">Les données audio du microphone passent à Stream 0, et les données audio de la ligne Speaker sont transmises à Stream 1.</span><span class="sxs-lookup"><span data-stu-id="189a0-206">The audio data from the microphone goes to stream 0, and the audio data from the speaker line goes to stream 1.</span></span> <span data-ttu-id="189a0-207">Si vous utilisez DMO en mode Source, vous n’avez pas besoin d’appeler **ProcessInput**.</span><span class="sxs-lookup"><span data-stu-id="189a0-207">If you are using the DMO in source mode, you do not need to call **ProcessInput**.</span></span>

<span data-ttu-id="189a0-208">Pour récupérer les données de sortie du DSP, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="189a0-208">To get output data from the DSP, perform the following steps:</span></span>

1.  <span data-ttu-id="189a0-209">Créez un objet de mémoire tampon pour stocker les données de sortie.</span><span class="sxs-lookup"><span data-stu-id="189a0-209">Create a buffer object to hold the output data.</span></span> <span data-ttu-id="189a0-210">L’objet buffer doit implémenter l’interface [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) .</span><span class="sxs-lookup"><span data-stu-id="189a0-210">The buffer object must implement the [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) interface.</span></span> <span data-ttu-id="189a0-211">La taille de la mémoire tampon dépend des exigences de votre application.</span><span class="sxs-lookup"><span data-stu-id="189a0-211">The size of the buffer depends on the requirements of your application.</span></span> <span data-ttu-id="189a0-212">L’allocation d’une mémoire tampon plus grande peut réduire les risques de problème.</span><span class="sxs-lookup"><span data-stu-id="189a0-212">Allocating a larger buffer can reduce the chances of glitches occurring.</span></span>
2.  <span data-ttu-id="189a0-213">Déclarez une structure de [**tampon de \_ données de sortie \_ \_ DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) et définissez le membre **pbuffer** pour qu’il pointe vers votre objet buffer.</span><span class="sxs-lookup"><span data-stu-id="189a0-213">Declare a [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure and set the **pBuffer** member to point to your buffer object.</span></span>
3.  <span data-ttu-id="189a0-214">Transmettez la structure de [**\_ tampon de \_ données \_ de sortie DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) à la méthode [**IMediaObject ::P rocessoutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) .</span><span class="sxs-lookup"><span data-stu-id="189a0-214">Pass the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure to the [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) method.</span></span>
4.  <span data-ttu-id="189a0-215">Continuez à appeler cette méthode aussi longtemps que la méthode DMO contient des données de sortie.</span><span class="sxs-lookup"><span data-stu-id="189a0-215">Continue to call this method for as long as the DMO has output data.</span></span> <span data-ttu-id="189a0-216">Le DSP signale qu’il a plus de sortie en définissant l’indicateur de **\_ données de sortie DMO \_ \_ BUFFERF \_ incomplet** dans le membre **dwStatus** de la structure de tampon de [**\_ \_ données \_ de sortie DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) .</span><span class="sxs-lookup"><span data-stu-id="189a0-216">The DSP signals that it has more output by setting the **DMO\_OUTPUT\_DATA\_BUFFERF\_INCOMPLETE** flag in the **dwStatus** member of the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure.</span></span>

## <a name="requirements"></a><span data-ttu-id="189a0-217">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="189a0-217">Requirements</span></span>



| <span data-ttu-id="189a0-218">Condition requise</span><span class="sxs-lookup"><span data-stu-id="189a0-218">Requirement</span></span> | <span data-ttu-id="189a0-219">Valeur</span><span class="sxs-lookup"><span data-stu-id="189a0-219">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="189a0-220">Client minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="189a0-220">Minimum supported client</span></span><br/> | <span data-ttu-id="189a0-221">Applications de \[ Bureau Windows Vista uniquement\]</span><span class="sxs-lookup"><span data-stu-id="189a0-221">Windows Vista \[desktop apps only\]</span></span><br/>                                          |
| <span data-ttu-id="189a0-222">Serveur minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="189a0-222">Minimum supported server</span></span><br/> | <span data-ttu-id="189a0-223">Applications de bureau Windows Server 2008 \[ uniquement\]</span><span class="sxs-lookup"><span data-stu-id="189a0-223">Windows Server 2008 \[desktop apps only\]</span></span><br/>                                    |
| <span data-ttu-id="189a0-224">En-tête</span><span class="sxs-lookup"><span data-stu-id="189a0-224">Header</span></span><br/>                   | <dl> <span data-ttu-id="189a0-225"><dt>Wmcodecdsp. h</dt></span><span class="sxs-lookup"><span data-stu-id="189a0-225"><dt>Wmcodecdsp.h</dt></span></span> </dl> |
| <span data-ttu-id="189a0-226">DLL</span><span class="sxs-lookup"><span data-stu-id="189a0-226">DLL</span></span><br/>                      | <dl> <span data-ttu-id="189a0-227"><dt>Mfwmaaec.dll</dt></span><span class="sxs-lookup"><span data-stu-id="189a0-227"><dt>Mfwmaaec.dll</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="189a0-228">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="189a0-228">See also</span></span>

<dl> <dt>

[<span data-ttu-id="189a0-229">Processeurs de signaux numériques</span><span class="sxs-lookup"><span data-stu-id="189a0-229">Digital Signal Processors</span></span>](windowsmediadigitalsignalprocessors.md)
</dt> </dl>

 

 
