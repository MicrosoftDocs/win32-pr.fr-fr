---
description: Cette rubrique décrit comment la source Sequencer gère les durées de présentation pendant la lecture.
ms.assetid: 0d095e25-5ccf-4319-8767-07b417ed7ee8
title: Durée des présentations de séquence
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d17f5b0ff4bd6f0cfee2b1b461d6fbd11bdbf0fb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104527837"
---
# <a name="sequence-presentation-times"></a><span data-ttu-id="b604b-103">Durée des présentations de séquence</span><span class="sxs-lookup"><span data-stu-id="b604b-103">Sequence Presentation Times</span></span>

<span data-ttu-id="b604b-104">Cette rubrique décrit comment la [source Sequencer](sequencer-source.md) gère les durées de présentation pendant la lecture.</span><span class="sxs-lookup"><span data-stu-id="b604b-104">This topic describes how the [Sequencer Source](sequencer-source.md) handles presentation times during playback.</span></span>

## <a name="overview"></a><span data-ttu-id="b604b-105">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="b604b-105">Overview</span></span>

<span data-ttu-id="b604b-106">La source Sequencer prend en charge deux modes différents : les séquences de sélection et les séquences de modification.</span><span class="sxs-lookup"><span data-stu-id="b604b-106">The sequencer source supports two different modes: playlist sequences and editing sequences.</span></span>

<span data-ttu-id="b604b-107">Dans une séquence d’édition, l’application spécifie la durée de chaque segment à l’avance, avant de commencer la lecture.</span><span class="sxs-lookup"><span data-stu-id="b604b-107">In an editing sequence, the application specifies the duration of each segment in advance, before starting playback.</span></span> <span data-ttu-id="b604b-108">Dans une séquence de sélection, l’application ne spécifie pas la durée à l’avance.</span><span class="sxs-lookup"><span data-stu-id="b604b-108">In a playlist sequence, the application does not specify the duration in advance.</span></span> <span data-ttu-id="b604b-109">(En fait, la durée n’est peut-être pas connue.)</span><span class="sxs-lookup"><span data-stu-id="b604b-109">(In fact, the duration might not be known.)</span></span>

<span data-ttu-id="b604b-110">Dans les deux cas, vous pouvez spécifier le début et l’heure d’arrêt du support d’un segment.</span><span class="sxs-lookup"><span data-stu-id="b604b-110">In both cases, you can specify a segment's media start and media stop time.</span></span> <span data-ttu-id="b604b-111">Ces heures spécifient la position dans le fichier source où le segment commence et se termine.</span><span class="sxs-lookup"><span data-stu-id="b604b-111">These times specify the position in the source file where the segment begins and ends.</span></span> <span data-ttu-id="b604b-112">Par exemple, supposons que le fichier source soit de 90 secondes.</span><span class="sxs-lookup"><span data-stu-id="b604b-112">For example, suppose that the source file is 90 seconds long.</span></span> <span data-ttu-id="b604b-113">Si vous souhaitez supprimer les 10 premières secondes et les 10 dernières secondes, vous devez spécifier les valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="b604b-113">If you wanted to trim the first 10 seconds and the last 10 seconds, you would specify the following values:</span></span>

-   <span data-ttu-id="b604b-114">Début du média : 10 secondes</span><span class="sxs-lookup"><span data-stu-id="b604b-114">Media start: 10 seconds</span></span>
-   <span data-ttu-id="b604b-115">Arrêt du support : 80 secondes</span><span class="sxs-lookup"><span data-stu-id="b604b-115">Media stop: 80 seconds</span></span>

<span data-ttu-id="b604b-116">Pour spécifier l’heure de début du support, définissez l’attribut [MF \_ TOPONODE \_ MEDIASTART](mf-toponode-mediastart-attribute.md) sur le nœud source.</span><span class="sxs-lookup"><span data-stu-id="b604b-116">To specify the media start time, set the [MF\_TOPONODE\_MEDIASTART](mf-toponode-mediastart-attribute.md) attribute on the source node.</span></span> <span data-ttu-id="b604b-117">Pour spécifier l’heure d’arrêt du support, définissez l’attribut [MF \_ TOPONODE \_ MEDIASTOP](mf-toponode-mediastop-attribute.md) sur le nœud source.</span><span class="sxs-lookup"><span data-stu-id="b604b-117">To specify the media stop time, set the [MF\_TOPONODE\_MEDIASTOP](mf-toponode-mediastop-attribute.md) attribute on the source node.</span></span>

<span data-ttu-id="b604b-118">Pour créer une séquence d’édition, définissez l’attribut [ \_ \_ \_ heure globale de session MF](mf-session-global-time-attribute.md) lorsque vous créez la session multimédia.</span><span class="sxs-lookup"><span data-stu-id="b604b-118">To create an editing sequence, set the [MF\_SESSION\_GLOBAL\_TIME](mf-session-global-time-attribute.md) attribute when you create the Media Session.</span></span> <span data-ttu-id="b604b-119">Dans le cas contraire, la session multimédia attend des séquences de sélection.</span><span class="sxs-lookup"><span data-stu-id="b604b-119">Otherwise, the Media Session expects playlist sequences.</span></span> <span data-ttu-id="b604b-120">Dans une séquence d’édition, chaque topologie de segment doit avoir l’attribut [ \_ \_ PROJECTSTART de topologie MF](mf-topology-projectstart-attribute.md) et l’attribut [ \_ \_ PROJECTSTOP de topologie MF](mf-topology-projectstop-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="b604b-120">In an editing sequence, every segment topology must have the [MF\_TOPOLOGY\_PROJECTSTART](mf-topology-projectstart-attribute.md) attribute and the [MF\_TOPOLOGY\_PROJECTSTOP](mf-topology-projectstop-attribute.md) attribute.</span></span>

## <a name="playlist-sequences"></a><span data-ttu-id="b604b-121">Séquences de sélection</span><span class="sxs-lookup"><span data-stu-id="b604b-121">Playlist Sequences</span></span>

<span data-ttu-id="b604b-122">Dans une séquence de sélection, l’horloge de la présentation démarre à zéro et continue à travers les limites du segment.</span><span class="sxs-lookup"><span data-stu-id="b604b-122">In a playlist sequence, the presentation clock starts at zero and continues across segment boundaries.</span></span> <span data-ttu-id="b604b-123">Les sources natives fournissent des exemples avec des horodatages égaux à l’heure du support.</span><span class="sxs-lookup"><span data-stu-id="b604b-123">The native sources deliver samples with time stamps equal to the media time.</span></span> <span data-ttu-id="b604b-124">Le pipeline convertit les horodatages à l’heure de présentation correcte comme suit :</span><span class="sxs-lookup"><span data-stu-id="b604b-124">The pipeline converts the time stamps to the correct presentation time as follows:</span></span>

-   <span data-ttu-id="b604b-125">Nouvel horodatage = durée du média + décalage − début du média</span><span class="sxs-lookup"><span data-stu-id="b604b-125">New time stamp = media time + offset − media start</span></span>

<span data-ttu-id="b604b-126">La valeur de *offset* est l’heure de présentation à laquelle le segment précédent s’est terminé.</span><span class="sxs-lookup"><span data-stu-id="b604b-126">The value of *offset* is the presentation time at which the previous segment ended.</span></span> <span data-ttu-id="b604b-127">Pour le premier segment, le décalage est égal à zéro.</span><span class="sxs-lookup"><span data-stu-id="b604b-127">For the first segment, the offset is zero.</span></span> <span data-ttu-id="b604b-128">Voici deux exemples montrant comment ces conversions de datage sont calculées :</span><span class="sxs-lookup"><span data-stu-id="b604b-128">Here are two examples of how these time-stamp conversions are calculated:</span></span>

-   <span data-ttu-id="b604b-129">Exemple 1 : Supposons que le premier segment (S1) soit de 10 secondes et que le second segment (S2) ait une heure de début de support de zéro.</span><span class="sxs-lookup"><span data-stu-id="b604b-129">Example 1: Suppose the first segment (S1) is 10 seconds long, and the second segment (S2) has a media start time of zero.</span></span> <span data-ttu-id="b604b-130">La source Native utilise l’heure du support pour ses horodatages, donc le premier échantillon de S2 a un horodatage égal à zéro.</span><span class="sxs-lookup"><span data-stu-id="b604b-130">The native source uses the media time for its time stamps, so the first sample from S2 has a time stamp of zero.</span></span> <span data-ttu-id="b604b-131">Le décalage est de 10 secondes (la durée S1). l’horodatage ajusté est donc : 0 + 10 − 0 = 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="b604b-131">The offset is 10 seconds (the duration of S1), so the adjusted time stamp is:0 + 10 − 0 = 10 seconds.</span></span>
-   <span data-ttu-id="b604b-132">Exemple 2 : Supposons que le segment S1 ait une longueur de 10 secondes, tandis que S2 a une heure de début de support de 5 secondes.</span><span class="sxs-lookup"><span data-stu-id="b604b-132">Example 2: Suppose segment S1 is 10 seconds long, and S2 has a media start time of 5 seconds.</span></span> <span data-ttu-id="b604b-133">Le premier échantillon de S2 a un horodatage de 5 secondes (heure du support).</span><span class="sxs-lookup"><span data-stu-id="b604b-133">The first sample from S2 has a time stamp of 5 seconds (media time).</span></span> <span data-ttu-id="b604b-134">Le décalage est de 10 secondes. l’horodatage ajusté est donc : 5 + 10 − 5 = 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="b604b-134">The offset is 10 seconds, so the adjusted time stamp is:5 + 10 − 5 = 10 seconds.</span></span>

<span data-ttu-id="b604b-135">Tous les composants de pipeline en aval des nœuds sources reçoivent des exemples avec les horodatages ajustés.</span><span class="sxs-lookup"><span data-stu-id="b604b-135">All pipeline components downstream from the source nodes receive samples with the adjusted time stamps.</span></span> <span data-ttu-id="b604b-136">Les nœuds sources d’une topologie peuvent avoir des heures de début de support différentes. les ajustements sont donc calculés séparément pour chaque branche de la topologie.</span><span class="sxs-lookup"><span data-stu-id="b604b-136">The source nodes in a topology can have different media start times, so the adjustments are calculated separately for each branch of the topology.</span></span>

<span data-ttu-id="b604b-137">Lorsque la présentation passe au segment suivant, l’horloge de la présentation ne s’arrête pas ou n’est pas réinitialisée, et l’heure de la présentation augmente de façon monotone.</span><span class="sxs-lookup"><span data-stu-id="b604b-137">When the presentation switches to the next segment, the presentation clock does not stop or reset, and the presentation time increases monotonically.</span></span> <span data-ttu-id="b604b-138">Avant le début d’un nouveau segment, la session multimédia envoie un événement [MESessionNotifyPresentationTime](mesessionnotifypresentationtime.md) à l’application.</span><span class="sxs-lookup"><span data-stu-id="b604b-138">Before a new segment starts, the Media Session sends the application an [MESessionNotifyPresentationTime](mesessionnotifypresentationtime.md) event.</span></span> <span data-ttu-id="b604b-139">L’événement spécifie l’heure de début du segment, par rapport à l’horloge de présentation, et la valeur de l’offset.</span><span class="sxs-lookup"><span data-stu-id="b604b-139">The event specifies the starting time of the segment, relative to the presentation clock, and the value of the offset.</span></span> <span data-ttu-id="b604b-140">Lorsqu’un nouveau segment démarre, le pipeline appelle [**Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasource-start) sur la source de Sequencer avec la valeur VT \_ vide.</span><span class="sxs-lookup"><span data-stu-id="b604b-140">When a new segment starts, the pipeline calls [**Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasource-start) on the sequencer source with the value VT\_EMPTY.</span></span> <span data-ttu-id="b604b-141">La source Sequencer envoie un événement [MESourceStarted](mesourcestarted.md) sans heure de début.</span><span class="sxs-lookup"><span data-stu-id="b604b-141">The sequencer source sends an [MESourceStarted](mesourcestarted.md) event with no start time.</span></span>

<span data-ttu-id="b604b-142">Pour rechercher, l’application spécifie un identificateur de segment plus un décalage horaire dans le segment.</span><span class="sxs-lookup"><span data-stu-id="b604b-142">To seek, the application specifies a segment identifier plus a time offset within the segment.</span></span> <span data-ttu-id="b604b-143">Après la recherche, l’horloge de la présentation commence à l’offset du *segment* .</span><span class="sxs-lookup"><span data-stu-id="b604b-143">After the seek, the presentation clock starts at the *segment* offset.</span></span> <span data-ttu-id="b604b-144">Voici un exemple de fonctionnement de ce processus :</span><span class="sxs-lookup"><span data-stu-id="b604b-144">Here is an example of how that process works:</span></span>

-   <span data-ttu-id="b604b-145">Exemple 3 : l’application cherche à segmenter S3, avec un décalage de segment de 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="b604b-145">Example 3: The application seeks to segment S3, with a segment offset of 10 seconds.</span></span> <span data-ttu-id="b604b-146">L’horloge de présentation démarre à 10 secondes (décalage de segment).</span><span class="sxs-lookup"><span data-stu-id="b604b-146">The presentation clock starts at 10 seconds (the segment offset).</span></span> <span data-ttu-id="b604b-147">Le décalage n’inclut pas la durée des segments S1 et S2.</span><span class="sxs-lookup"><span data-stu-id="b604b-147">The offset does not include the duration of segments S1 and S2.</span></span> <span data-ttu-id="b604b-148">La source Sequencer envoie un événement [MESourceStarted](mesourcestarted.md) avec une heure de début égale au décalage de segment, 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="b604b-148">The sequencer source sends an [MESourceStarted](mesourcestarted.md) event with a start time equal to the segment offset, 10 seconds.</span></span>

<span data-ttu-id="b604b-149">Après une recherche, si la lecture continue jusqu’au segment suivant, la transition fonctionne comme les exemples précédents, à ceci près que le décalage n’inclut pas les segments ignorés.</span><span class="sxs-lookup"><span data-stu-id="b604b-149">After a seek, if playback continues to the next segment, the transition works just like the previous examples, except that the offset does not include the skipped segments.</span></span>

<span data-ttu-id="b604b-150">Voici des informations supplémentaires qui affectent la façon dont les exemples sont horodatés :</span><span class="sxs-lookup"><span data-stu-id="b604b-150">Here are some further details that affect how samples are time stamped:</span></span>

-   <span data-ttu-id="b604b-151">Les décodeurs peuvent nécessiter des données au-delà du temps d’arrêt du support.</span><span class="sxs-lookup"><span data-stu-id="b604b-151">Decoders may need data beyond the media stop time.</span></span> <span data-ttu-id="b604b-152">Le pipeline extrait le plus de données de la source que le décodeur requiert, puis supprime les exemples de sortie du décodeur.</span><span class="sxs-lookup"><span data-stu-id="b604b-152">The pipeline pulls as much data from the source as the decoder requires, and then trims the decoder's output samples.</span></span>
-   <span data-ttu-id="b604b-153">Les transformations peuvent mettre des données en mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="b604b-153">Transforms might buffer data.</span></span> <span data-ttu-id="b604b-154">Par exemple, un effet audio peut être nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b604b-154">For example, an audio effect might need to do this.</span></span> <span data-ttu-id="b604b-155">Lorsqu’un segment se termine, l’horodatage du dernier échantillon de la transformation est antérieur à la fin du segment, car la transformation contient des données.</span><span class="sxs-lookup"><span data-stu-id="b604b-155">When a segment ends, the time stamp on the last sample from the transform is earlier than the end of the segment, because the transform is holding back some data.</span></span> <span data-ttu-id="b604b-156">Au démarrage du segment suivant, l’horodatage sur le premier échantillon est légèrement antérieur au début du segment.</span><span class="sxs-lookup"><span data-stu-id="b604b-156">When the next segment starts, the time stamp on the first sample is slightly earlier than the start of the segment.</span></span> <span data-ttu-id="b604b-157">Il n’y a pas d’écart dans les horodatages, donc les données qui atteignent le récepteur multimédia sont continues.</span><span class="sxs-lookup"><span data-stu-id="b604b-157">There is no gap in the time stamps, so the data that reaches the media sink is continuous.</span></span> <span data-ttu-id="b604b-158">Lorsque le segment final se termine, le pipeline draine la transformation, de sorte qu’aucune donnée n’est perdue.</span><span class="sxs-lookup"><span data-stu-id="b604b-158">When the final segment ends, the pipeline drains the transform, so no data is lost.</span></span>
-   <span data-ttu-id="b604b-159">La source doit peut-être démarrer légèrement avant l’heure de début du support, pour sélectionner l’image clé précédente.</span><span class="sxs-lookup"><span data-stu-id="b604b-159">The source may need to start slightly earlier than the media start time, to pick up the previous key frame.</span></span> <span data-ttu-id="b604b-160">Par conséquent, après l’ajustement, le premier exemple peut avoir une heure de présentation négative.</span><span class="sxs-lookup"><span data-stu-id="b604b-160">Therefore, after the adjustment, the first sample might have a negative presentation time.</span></span>

## <a name="editing-sequences"></a><span data-ttu-id="b604b-161">Modification des séquences</span><span class="sxs-lookup"><span data-stu-id="b604b-161">Editing Sequences</span></span>

<span data-ttu-id="b604b-162">Dans une séquence d’édition, l’application spécifie les limites de segment à l’avance, en définissant les attributs de [**\_ topologie MF \_ PROJECTSTART**](mf-topology-projectstart-attribute.md) et de [**\_ topologie MF \_ PROJECTSTOP**](mf-topology-projectstop-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="b604b-162">In an editing sequence, the application specifies the segment boundaries in advance, by setting the [**MF\_TOPOLOGY\_PROJECTSTART**](mf-topology-projectstart-attribute.md) and [**MF\_TOPOLOGY\_PROJECTSTOP**](mf-topology-projectstop-attribute.md) attributes.</span></span> <span data-ttu-id="b604b-163">Le pipeline calcule les ajustements pour les horodatages de la même façon que pour une séquence de sélection :</span><span class="sxs-lookup"><span data-stu-id="b604b-163">The pipeline calculates adjustments for the time stamps in almost the same way as for a playlist sequence:</span></span>

-   <span data-ttu-id="b604b-164">Pour le décalage, elle utilise la valeur de [**la \_ topologie MF \_ PROJECTSTART**](mf-topology-projectstart-attribute.md), au lieu d’utiliser la fin observée du segment.</span><span class="sxs-lookup"><span data-stu-id="b604b-164">For the offset, it uses the value of [**MF\_TOPOLOGY\_PROJECTSTART**](mf-topology-projectstart-attribute.md), instead of using the observed end of the segment.</span></span>

-   <span data-ttu-id="b604b-165">Pour la recherche, le décalage utilise une valeur égale à la valeur [**\_ \_ PROJECTSTART de la topologie MF**](mf-topology-projectstart-attribute.md) du segment plus le décalage de segment.</span><span class="sxs-lookup"><span data-stu-id="b604b-165">For seeking, the offset uses a value equal to the segment's [**MF\_TOPOLOGY\_PROJECTSTART**](mf-topology-projectstart-attribute.md) value plus the segment offset.</span></span>

<span data-ttu-id="b604b-166">Par conséquent, l’heure de présentation dans une séquence de modification est toujours relative au début de la présentation, même si l’application recherche un autre segment.</span><span class="sxs-lookup"><span data-stu-id="b604b-166">Therefore, the presentation time in an editing sequence is always relative to the start of the presentation, even if the application seeks to another segment.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b604b-167">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="b604b-167">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b604b-168">Session multimédia</span><span class="sxs-lookup"><span data-stu-id="b604b-168">Media Session</span></span>](media-session.md)
</dt> <dt>

[<span data-ttu-id="b604b-169">Source de Sequencer</span><span class="sxs-lookup"><span data-stu-id="b604b-169">Sequencer Source</span></span>](sequencer-source.md)
</dt> </dl>

 

 



