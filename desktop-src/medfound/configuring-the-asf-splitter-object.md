---
description: Configuration de l’objet Splitter ASF
ms.assetid: 8e2ba659-e1f6-42be-afd6-21fc841dc8d3
title: Configuration de l’objet Splitter ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14f27885e602dd52012808d330d997f9b7a7e983
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104111842"
---
# <a name="configuring-the-asf-splitter-object"></a><span data-ttu-id="3770a-103">Configuration de l’objet Splitter ASF</span><span class="sxs-lookup"><span data-stu-id="3770a-103">Configuring the ASF Splitter Object</span></span>

<span data-ttu-id="3770a-104">L’objet *séparateur* ASF est un objet de couche WMContainer qui analyse l’objet de données ASF d’un fichier ASF (Advanced Systems Format).</span><span class="sxs-lookup"><span data-stu-id="3770a-104">The ASF *splitter* object is a WMContainer layer object that parses the ASF Data Object of an Advanced Systems Format (ASF) file.</span></span> <span data-ttu-id="3770a-105">Une fois le séparateur créé et initialisé pour analyser l’objet de données ASF d’un fichier multimédia, le séparateur doit être configuré pour générer des échantillons pour des flux spécifiques.</span><span class="sxs-lookup"><span data-stu-id="3770a-105">After the splitter is created and initialized to parse the ASF Data Object of a media file, the splitter must be configured to generate samples for specific streams.</span></span> <span data-ttu-id="3770a-106">Appelez [**IMFASFSplitter :: SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) pour sélectionner les flux requis.</span><span class="sxs-lookup"><span data-stu-id="3770a-106">Call [**IMFASFSplitter::SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) to select the required streams.</span></span>

<span data-ttu-id="3770a-107">Éventuellement, une application peut également la configurer pour générer des échantillons dans l’ordre inverse ou générer des exemples pour le contenu protégé.</span><span class="sxs-lookup"><span data-stu-id="3770a-107">Optionally, an application can also configure it to generate samples in reverse order or generate samples for protected content.</span></span> <span data-ttu-id="3770a-108">Pour définir ces options, appelez [**IMFASFSplitter :: SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) et transmettez la combinaison d’opérations de bits requise des indicateurs pris en charge.</span><span class="sxs-lookup"><span data-stu-id="3770a-108">To set these options, call [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) and pass the required bitwise combination of the supported flags.</span></span> <span data-ttu-id="3770a-109">Avant d’appeler cette méthode, le client doit terminer l’appel [**IMFASFSplitter :: Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) avec succès ; Sinon, **SetFlags** échoue avec le code **d’erreur MF \_ E \_ not \_ Initialized** .</span><span class="sxs-lookup"><span data-stu-id="3770a-109">Before calling this method, the client must complete the [**IMFASFSplitter::Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) call successfully; otherwise, **SetFlags** fails with **MF\_E\_NOT\_INITIALIZED** error code.</span></span> <span data-ttu-id="3770a-110">Pour plus d’informations sur l’initialisation du séparateur, consultez [création de l’objet séparateur ASF](creating-the-asf-splitter-object.md).</span><span class="sxs-lookup"><span data-stu-id="3770a-110">For information about initializing the splitter, see [Creating the ASF Splitter Object](creating-the-asf-splitter-object.md).</span></span>

<span data-ttu-id="3770a-111">Pour vérifier si cet indicateur est actuellement défini sur le séparateur, appelez [**IMFASFSplitter :: GetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getflags).</span><span class="sxs-lookup"><span data-stu-id="3770a-111">To check whether this flag is currently set on the splitter, call [**IMFASFSplitter::GetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getflags).</span></span>

## <a name="selecting-streams-for-parsing"></a><span data-ttu-id="3770a-112">Sélection de flux pour l’analyse</span><span class="sxs-lookup"><span data-stu-id="3770a-112">Selecting Streams for Parsing</span></span>

<span data-ttu-id="3770a-113">Pendant le processus d’initialisation via l’appel [**IMFASFSplitter :: Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) , le séparateur détecte le nombre de flux et les identificateurs de flux dans le fichier ASF.</span><span class="sxs-lookup"><span data-stu-id="3770a-113">During the initialization process through [**IMFASFSplitter::Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) call, the splitter detects the number of streams and the stream identifiers in the ASF file.</span></span> <span data-ttu-id="3770a-114">Par défaut, aucun flux n’est sélectionné par le séparateur.</span><span class="sxs-lookup"><span data-stu-id="3770a-114">By default, no streams are selected by the splitter.</span></span> <span data-ttu-id="3770a-115">L’application doit sélectionner les flux en appelant [**IMFASFSplitter :: SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams).</span><span class="sxs-lookup"><span data-stu-id="3770a-115">The application must select the streams by calling [**IMFASFSplitter::SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams).</span></span> <span data-ttu-id="3770a-116">Cette méthode prend un tableau de nombres de flux.</span><span class="sxs-lookup"><span data-stu-id="3770a-116">This method takes an array of stream numbers.</span></span> <span data-ttu-id="3770a-117">Pour obtenir le numéro de flux d’un flux, appelez [**IMFASFProfile :: GetStream**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfprofile-getstream) sur le profil ASF ou appelez [**IMFStreamDescriptor :: GetStreamIdentifier**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamdescriptor-getstreamidentifier) sur le descripteur de flux.</span><span class="sxs-lookup"><span data-stu-id="3770a-117">To get the stream number for a stream, call [**IMFASFProfile::GetStream**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfprofile-getstream) on the ASF profile or call [**IMFStreamDescriptor::GetStreamIdentifier**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamdescriptor-getstreamidentifier) on the stream descriptor.</span></span> <span data-ttu-id="3770a-118">(Vous pouvez obtenir le profil ASF et le descripteur de flux à partir de l’objet ContentInfo.) Si le client passe un numéro de flux qui n’est pas reconnu par le séparateur, il échoue avec une erreur **MF \_ E \_ INVALIDSTREAMNUMBER** .</span><span class="sxs-lookup"><span data-stu-id="3770a-118">(You can obtain both the ASF profile and the stream descriptor from the ContentInfo object.) If the client passes a stream number that is not recognized by the splitter, it fails with a **MF\_E\_INVALIDSTREAMNUMBER** error.</span></span>

<span data-ttu-id="3770a-119">L’appel de [**SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) efface les sélections précédentes.</span><span class="sxs-lookup"><span data-stu-id="3770a-119">Calling [**SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) clears the previous selections.</span></span> <span data-ttu-id="3770a-120">Tout flux qui n’est pas spécifié dans le tableau n’est pas sélectionné.</span><span class="sxs-lookup"><span data-stu-id="3770a-120">Any stream that is not specified in the array is not selected.</span></span> <span data-ttu-id="3770a-121">Pour obtenir la liste des flux actuellement sélectionnés, appelez [**IMFASFSplitter :: GetSelectedStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getselectedstreams).</span><span class="sxs-lookup"><span data-stu-id="3770a-121">To get a list of streams that are currently selected, call [**IMFASFSplitter::GetSelectedStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getselectedstreams).</span></span> <span data-ttu-id="3770a-122">Cette méthode prend un pointeur vers un tableau, que la méthode remplit avec les numéros de flux.</span><span class="sxs-lookup"><span data-stu-id="3770a-122">This method takes a pointer to an array, which the method fills with the stream numbers.</span></span> <span data-ttu-id="3770a-123">Si la taille du tableau est inférieure au nombre de flux sélectionnés, la méthode échoue avec l’erreur **MF \_ E \_ BUFFERTOOSMALL** .</span><span class="sxs-lookup"><span data-stu-id="3770a-123">If the array size is less than the number of selected streams, the method fails with the **MF\_E\_BUFFERTOOSMALL** error.</span></span> <span data-ttu-id="3770a-124">Dans ce cas, la méthode retourne le nombre de flux sélectionnés dans le paramètre *pwNumStreams* .</span><span class="sxs-lookup"><span data-stu-id="3770a-124">In this case, the method returns the number of selected streams in the *pwNumStreams* parameter.</span></span> <span data-ttu-id="3770a-125">Vous pouvez ensuite utiliser ce nombre pour allouer un tableau de la taille correcte et appeler à nouveau la méthode.</span><span class="sxs-lookup"><span data-stu-id="3770a-125">You can then use this number to allocate an array of the correct size and call the method again.</span></span>

<span data-ttu-id="3770a-126">Pour obtenir un exemple de code, consultez « sélectionner un flux pour l’analyse » dans le [Didacticiel : lecture d’un fichier ASF](tutorial--reading-an-asf-file.md).</span><span class="sxs-lookup"><span data-stu-id="3770a-126">For example code, see "Select a Stream for Parsing" in [Tutorial: Reading an ASF File](tutorial--reading-an-asf-file.md).</span></span>

## <a name="reverse-playback-setting"></a><span data-ttu-id="3770a-127">Paramètre de lecture inversée</span><span class="sxs-lookup"><span data-stu-id="3770a-127">Reverse Playback Setting</span></span>

<span data-ttu-id="3770a-128">Pendant le processus d’initialisation du séparateur, il détermine si le contenu ASF prend en charge la lecture inversée.</span><span class="sxs-lookup"><span data-stu-id="3770a-128">During the initialization process of the splitter, it determines if the ASF content supports reverse playback.</span></span> <span data-ttu-id="3770a-129">Si c’est le cas, le séparateur peut être configuré pour générer des échantillons dans l’ordre inverse, en définissant l’indicateur d' **\_ \_ annulation du séparateur MFASF** .</span><span class="sxs-lookup"><span data-stu-id="3770a-129">If it does, the splitter can be configured to generate samples in reverse order by setting the **MFASF\_SPLITTER\_REVERSE** flag.</span></span> <span data-ttu-id="3770a-130">Si le contenu ne prend pas en charge la lecture inversée, [**IMFASFSplitter :: SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) retourne **MF \_ E \_ INVALIDREQUEST**, mais l’indicateur est défini sur le séparateur.</span><span class="sxs-lookup"><span data-stu-id="3770a-130">If the content does not support reverse playback, the [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) returns **MF\_E\_INVALIDREQUEST**, but the flag is set on the splitter.</span></span>

<span data-ttu-id="3770a-131">Si le séparateur est configuré pour analyser dans le sens inverse, le séparateur commence toujours l’analyse à la fin de la mémoire tampon qui contient l’objet de données ASF.</span><span class="sxs-lookup"><span data-stu-id="3770a-131">If the splitter is configured to parse in the reverse direction, then the splitter always starts parsing at the end of the buffer that contains the ASF Data Object.</span></span> <span data-ttu-id="3770a-132">Par conséquent, pour l’analyse inverse, le décalage des données et la longueur des données à analyser doivent être définis correctement.</span><span class="sxs-lookup"><span data-stu-id="3770a-132">Therefore, for reverse parsing the data offset and the length of the data to parse must be set appropriately.</span></span> <span data-ttu-id="3770a-133">Pour plus d’informations sur la définition des valeurs correctes, consultez [génération d’exemples de flux à partir d’un objet de données ASF existant](generating-stream-samples-from-an-existing-asf-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="3770a-133">For information about setting the correct values, see [Generating Stream Samples from an Existing ASF Data Object](generating-stream-samples-from-an-existing-asf-data-object.md).</span></span>

## <a name="protected-content-setting"></a><span data-ttu-id="3770a-134">Paramètre de contenu protégé</span><span class="sxs-lookup"><span data-stu-id="3770a-134">Protected Content Setting</span></span>

<span data-ttu-id="3770a-135">Le séparateur peut être configuré pour utiliser le contenu de chiffrement au niveau du paquet en définissant le **\_ séparateur MFASF \_ WMDRM** via [**IMFASFSplitter :: SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags).</span><span class="sxs-lookup"><span data-stu-id="3770a-135">The splitter can be configured to work with packet-level encryption content by setting the **MFASF\_SPLITTER\_WMDRM** through [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags).</span></span> <span data-ttu-id="3770a-136">Cela indique au séparateur de fournir des exemples pour le contenu protégé par la Rights Management Windows Media Digital (DRM).</span><span class="sxs-lookup"><span data-stu-id="3770a-136">This instructs the splitter to deliver samples for content that is protected by Windows Media Digital Rights Management (DRM).</span></span> <span data-ttu-id="3770a-137">Lorsque cet indicateur est défini, les exemples générés par le séparateur contiennent les informations requises pour déchiffrer les données multimédia et reconstruire les frames, telles que l’attribut [**MFSampleExtension \_ PacketCrossOffsets**](mfsampleextension-packetcrossoffsets-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="3770a-137">When this flag is set, the samples generated by the splitter contain information required to decrypt media data and reconstruct the frames, such as the [**MFSampleExtension\_PacketCrossOffsets**](mfsampleextension-packetcrossoffsets-attribute.md) attribute.</span></span> <span data-ttu-id="3770a-138">Cet attribut est un objet BLOB qui contient un tableau de **DWORD** s.</span><span class="sxs-lookup"><span data-stu-id="3770a-138">This attribute is a blob that contains an array of **DWORD** s.</span></span> <span data-ttu-id="3770a-139">Chaque **DWORD** vous fournit les limites de charge utile pour le frame par rapport au début du frame.</span><span class="sxs-lookup"><span data-stu-id="3770a-139">Each **DWORD** provides you the payload boundaries for the frame relative to the beginning of the frame.</span></span> <span data-ttu-id="3770a-140">Si cet attribut n’est pas présent, le frame est contenu dans une seule charge utile.</span><span class="sxs-lookup"><span data-stu-id="3770a-140">If this attribute is not present, the frame is contained in a single payload.</span></span> <span data-ttu-id="3770a-141">En règle générale, les exemples générés par le séparateur contiennent plusieurs mémoires tampons de média, l’application peut copier toutes les mémoires tampons dans une mémoire tampon contiguë en appelant [**IMFSample :: ConvertToContiguousBuffer**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-converttocontiguousbuffer).</span><span class="sxs-lookup"><span data-stu-id="3770a-141">Typically, the samples generated by the splitter contain multiple media buffers, the application can copy all the buffers into one contiguous buffer by calling [**IMFSample::ConvertToContiguousBuffer**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-converttocontiguousbuffer).</span></span> <span data-ttu-id="3770a-142">La mémoire tampon résultante contient le frame et la valeur de l’attribut contient des décalages dans cette mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="3770a-142">The resulting buffer contains the frame and the attribute value contains offsets into this buffer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3770a-143">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="3770a-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3770a-144">Séparateur ASF</span><span class="sxs-lookup"><span data-stu-id="3770a-144">ASF Splitter</span></span>](asf-splitter.md)
</dt> </dl>

 

 



