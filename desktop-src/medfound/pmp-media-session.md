---
description: Session média PMP
ms.assetid: CF3A427D-31D2-45FF-BE87-F192B758204E
title: Session média PMP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: abf2cb1ff173d6fd085f6e98dd4608c84ff40200
ms.sourcegitcommit: 95685061d5b0333bbf9e6ebd208dde8190f97005
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2021
ms.locfileid: "108092717"
---
# <a name="pmp-media-session"></a><span data-ttu-id="d9e55-103">Session média PMP</span><span class="sxs-lookup"><span data-stu-id="d9e55-103">PMP Media Session</span></span>

<span data-ttu-id="d9e55-104">Une application peut créer la [session de média](media-session.md) dans un processus distinct appelé le processus PMP ( [protected Media Path](protected-media-path.md) ).</span><span class="sxs-lookup"><span data-stu-id="d9e55-104">An application can create the [Media Session](media-session.md) in a separate process called the [Protected Media Path](protected-media-path.md) (PMP) process.</span></span> <span data-ttu-id="d9e55-105">L’objectif principal du processus PMP est d’activer la lecture de contenu protégé à l’aide de la gestion des droits numériques (DRM).</span><span class="sxs-lookup"><span data-stu-id="d9e55-105">The main purpose of the PMP process is to enable playback of protected content using digital rights management (DRM).</span></span> <span data-ttu-id="d9e55-106">Par défaut, le processus PMP est créé dans un environnement protégé (PE).</span><span class="sxs-lookup"><span data-stu-id="d9e55-106">By default, the PMP process is created inside a Protected Environment (PE).</span></span> <span data-ttu-id="d9e55-107">Seuls les composants signés et approuvés peuvent être chargés dans un PE.</span><span class="sxs-lookup"><span data-stu-id="d9e55-107">Only trusted, signed components can be loaded inside a PE.</span></span> <span data-ttu-id="d9e55-108">L’un des avantages secondaires du processus PMP est qu’il isole le processus d’application du pipeline multimédia.</span><span class="sxs-lookup"><span data-stu-id="d9e55-108">A secondary benefit of the PMP process is that it isolates the application process from the media pipeline.</span></span> <span data-ttu-id="d9e55-109">Pour plus d’informations sur le processus PMP, consultez [chemin d’accès au média protégé](protected-media-path.md).</span><span class="sxs-lookup"><span data-stu-id="d9e55-109">For more information about the PMP process, see [Protected Media Path](protected-media-path.md).</span></span>

<span data-ttu-id="d9e55-110">Pour créer la session multimédia à l’intérieur du processus PMP, appelez la fonction [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) .</span><span class="sxs-lookup"><span data-stu-id="d9e55-110">To create the Media Session inside the PMP process, call the [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function.</span></span> <span data-ttu-id="d9e55-111">Si vous le souhaitez, vous pouvez transmettre l’indicateur de **\_ \_ processus non protégé MFPMPSESSION** .</span><span class="sxs-lookup"><span data-stu-id="d9e55-111">Optionally, you can pass in the **MFPMPSESSION\_UNPROTECTED\_PROCESS** flag.</span></span> <span data-ttu-id="d9e55-112">Si cet indicateur est défini, le processus PMP est créé à l’intérieur d’un processus non protégé, et non d’un processus PE.</span><span class="sxs-lookup"><span data-stu-id="d9e55-112">If this flag is set, the PMP process is created inside an unprotected process, and not a PE process.</span></span> <span data-ttu-id="d9e55-113">Le processus non protégé ne peut pas être utilisé pour la lecture DRM, mais vous offre les avantages de l’isolation des processus.</span><span class="sxs-lookup"><span data-stu-id="d9e55-113">The unprotected process cannot be used for DRM playback, but does give you the benefits of process isolation.</span></span>

<span data-ttu-id="d9e55-114">La fonction [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) retourne un pointeur vers un objet proxy pour la session multimédia.</span><span class="sxs-lookup"><span data-stu-id="d9e55-114">The [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function returns a pointer to a proxy object for the Media Session.</span></span> <span data-ttu-id="d9e55-115">L’application communique avec la session multimédia par le biais du proxy.</span><span class="sxs-lookup"><span data-stu-id="d9e55-115">The application communicates with the Media Session through the proxy.</span></span>

![illustration de la session multimédia à l’intérieur du processus PMP](images/pmp01.png)

<span data-ttu-id="d9e55-117">Par défaut, lorsque l’application crée une topologie, la source du média est créée à l’intérieur du processus d’application.</span><span class="sxs-lookup"><span data-stu-id="d9e55-117">By default, when the application creates a topology, the media source is created inside the application process.</span></span> <span data-ttu-id="d9e55-118">Un proxy vers la source du média est créé à l’intérieur du processus PMP.</span><span class="sxs-lookup"><span data-stu-id="d9e55-118">A proxy to the media source is created inside the PMP process.</span></span> <span data-ttu-id="d9e55-119">La source du média peut créer des objets à l’intérieur du processus PMP à l’aide de l’interface [**IMFPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) .</span><span class="sxs-lookup"><span data-stu-id="d9e55-119">The media source can create objects inside the PMP process by using the [**IMFPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) interface.</span></span> <span data-ttu-id="d9e55-120">Par exemple, pour prendre en charge la gestion des droits numériques (DRM), une source multimédia crée un objet appelé *autorité d’approbation d’entrée* (ITA).</span><span class="sxs-lookup"><span data-stu-id="d9e55-120">For example, to support DRM, a media source creates an object called an *input trust authority* (ITA).</span></span> <span data-ttu-id="d9e55-121">L’ITA doit être créé à l’intérieur du processus PMP.</span><span class="sxs-lookup"><span data-stu-id="d9e55-121">The ITA must be created inside the PMP process.</span></span> <span data-ttu-id="d9e55-122">(Pour plus d’informations sur ITAs, consultez [chemin d’accès au média protégé](protected-media-path.md).) Pour utiliser l’interface [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) , procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="d9e55-122">(For more information about ITAs, see [Protected Media Path](protected-media-path.md).) To use the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface, do the following:</span></span>

1.  <span data-ttu-id="d9e55-123">La source du média doit implémenter l’interface [**IMFPMPClient**](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient) .</span><span class="sxs-lookup"><span data-stu-id="d9e55-123">The media source must implement the [**IMFPMPClient**](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient) interface.</span></span>
2.  <span data-ttu-id="d9e55-124">Pendant la résolution de la topologie, le proxy de session multimédia appelle la méthode [**IMFPMPClient :: SetPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmpclient-setpmphost) sur la source du média.</span><span class="sxs-lookup"><span data-stu-id="d9e55-124">During topology resolution, the Media Session proxy calls the [**IMFPMPClient::SetPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmpclient-setpmphost) method on the media source.</span></span>
3.  <span data-ttu-id="d9e55-125">La source multimédia appelle [**IMFPMPHost :: CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) pour créer l’objet à l’intérieur du processus PMP.</span><span class="sxs-lookup"><span data-stu-id="d9e55-125">The media source calls [**IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) to create the object inside the PMP process.</span></span> <span data-ttu-id="d9e55-126">L’objet doit avoir un CLSID inscrit.</span><span class="sxs-lookup"><span data-stu-id="d9e55-126">The object must have a registered CLSID.</span></span> <span data-ttu-id="d9e55-127">En outre, pour charger dans le PE, l’objet doit être approuvé et signé numériquement.</span><span class="sxs-lookup"><span data-stu-id="d9e55-127">Also, to load inside the PE, the object must be trusted and digitally signed.</span></span> <span data-ttu-id="d9e55-128">Pour plus d’informations sur la signature de code des composants multimédias protégés, consultez le livre blanc [Signing Code Signing for protected Media Components in Windows Vista (en](/windows-hardware/test/hlk/) anglais)</span><span class="sxs-lookup"><span data-stu-id="d9e55-128">For information about code signing protected media components, see the white paper [Code Signing for Protected Media Components in Windows Vista](/windows-hardware/test/hlk/)</span></span>

<span data-ttu-id="d9e55-129">L’illustration suivante montre la source de média créée dans le processus d’application.</span><span class="sxs-lookup"><span data-stu-id="d9e55-129">The following illustration shows the media source created in the application process.</span></span>

![illustration d’une source de média dans le processus d’application.](images/pmp02.png)

<span data-ttu-id="d9e55-131">Une autre solution consiste à créer la source du média à l’intérieur de la session PMP.</span><span class="sxs-lookup"><span data-stu-id="d9e55-131">Another alternative is to create the media source inside the PMP session.</span></span>

1.  <span data-ttu-id="d9e55-132">Définissez l' [**attribut \_ \_ \_ \_ mode Source distant de la session MF**](mf-session-remote-source-mode-attribute.md) lorsque vous créez la session multimédia.</span><span class="sxs-lookup"><span data-stu-id="d9e55-132">Set the [**MF\_SESSION\_REMOTE\_SOURCE\_MODE**](mf-session-remote-source-mode-attribute.md) attribute when you create the Media Session.</span></span> <span data-ttu-id="d9e55-133">Les attributs de configuration sont spécifiés dans le paramètre *pConfiguration* de la fonction [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) .</span><span class="sxs-lookup"><span data-stu-id="d9e55-133">Configuration attributes are specified in the *pConfiguration* parameter of the [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function.</span></span>
2.  <span data-ttu-id="d9e55-134">Appelez [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) sur la session multimédia pour obtenir un pointeur vers l’interface [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) .</span><span class="sxs-lookup"><span data-stu-id="d9e55-134">Call [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) on the Media Session to get a pointer to the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface.</span></span> <span data-ttu-id="d9e55-135">L’identificateur de service est **MF \_ PMP \_ service**.</span><span class="sxs-lookup"><span data-stu-id="d9e55-135">The service identifier is **MF\_PMP\_SERVICE**.</span></span>
3.  <span data-ttu-id="d9e55-136">Appelez [**IMFPMPHost :: CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) avec l’identificateur de classe **CLSID \_ MFSourceResolver** pour créer le programme de résolution source à l’intérieur du processus PMP.</span><span class="sxs-lookup"><span data-stu-id="d9e55-136">Call [**IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) with the class identifier **CLSID\_MFSourceResolver** to create the source resolver inside the PMP process.</span></span> <span data-ttu-id="d9e55-137">La méthode retourne un pointeur vers un proxy pour le programme de résolution source.</span><span class="sxs-lookup"><span data-stu-id="d9e55-137">The method returns a pointer to a proxy for the source resolver.</span></span>
4.  <span data-ttu-id="d9e55-138">Appelez [**IMFSourceResolver :: BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) ou [**IMFSourceResolver :: BeginCreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfrombytestream) pour créer la source du média.</span><span class="sxs-lookup"><span data-stu-id="d9e55-138">Call [**IMFSourceResolver::BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) or [**IMFSourceResolver::BeginCreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfrombytestream) to create the media source.</span></span>
    > [!Note]  
    > <span data-ttu-id="d9e55-139">Dans ce cas, vous devez utiliser les versions asynchrones de ces méthodes, car les versions synchrones ne sont pas accessibles à distance.</span><span class="sxs-lookup"><span data-stu-id="d9e55-139">In this case, you must use the asynchronous versions of these methods, because the synchronous versions are not remotable.</span></span>

     

<span data-ttu-id="d9e55-140">L’illustration suivante montre la source de média créée dans le processus PMP.</span><span class="sxs-lookup"><span data-stu-id="d9e55-140">The following illustration shows the media source created in the PMP process.</span></span>

![illustration d’une source de média dans le processus PMP.](images/pmp03.png)

## <a name="related-topics"></a><span data-ttu-id="d9e55-142">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="d9e55-142">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d9e55-143">Comment lire des fichiers multimédias protégés</span><span class="sxs-lookup"><span data-stu-id="d9e55-143">How to Play Protected Media Files</span></span>](how-to-play-protected-media-files.md)
</dt> <dt>

[<span data-ttu-id="d9e55-144">Session multimédia</span><span class="sxs-lookup"><span data-stu-id="d9e55-144">Media Session</span></span>](media-session.md)
</dt> <dt>

[<span data-ttu-id="d9e55-145">Chemin du média protégé</span><span class="sxs-lookup"><span data-stu-id="d9e55-145">Protected Media Path</span></span>](protected-media-path.md)
</dt> </dl>

 

 
