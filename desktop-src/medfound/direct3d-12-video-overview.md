---
description: Cet article contient des conseils généraux sur l’utilisation des API vidéo Direct3D 12.
ms.assetid: ''
title: Vue d’ensemble vidéo Direct3D 12
ms.topic: article
ms.date: 06/03/2019
ms.openlocfilehash: b21587f2784b34131da9c050655b6f3fbe43582d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104524564"
---
# <a name="direct3d-12-video-overview"></a><span data-ttu-id="02ec3-103">Vue d’ensemble vidéo Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="02ec3-103">Direct3D 12 Video Overview</span></span>

<span data-ttu-id="02ec3-104">Cet article contient des conseils généraux sur l’utilisation des API vidéo Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="02ec3-104">This article contains general guidance for using the Direct3D 12 video APIs.</span></span>

## <a name="about-direct3d-12-video"></a><span data-ttu-id="02ec3-105">À propos de la vidéo Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="02ec3-105">About Direct3D 12 Video</span></span>

<span data-ttu-id="02ec3-106">L’interface vidéo Direct3D 12 offre aux applications une nouvelle façon d’implémenter le décodage et le traitement de vidéos.</span><span class="sxs-lookup"><span data-stu-id="02ec3-106">The Direct3D 12 video interface provides a new way for apps to implement video decoding and process.</span></span> <span data-ttu-id="02ec3-107">L’interface Direct3D 12 est différente de l’interface Direct3D 11 précédente, car elle a été conçue pour être cohérente avec les principes et le style Direct3D 12, qui incluent les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="02ec3-107">The Direct3D 12 interface is different from the previous Direct3D 11 interface because it was designed to be consistent with the Direct3D 12 principles and style, which includes the following:</span></span>

- <span data-ttu-id="02ec3-108">Donnez plus de contrôle aux développeurs</span><span class="sxs-lookup"><span data-stu-id="02ec3-108">Give developers more control</span></span>
 - <span data-ttu-id="02ec3-109">Allocation de mémoire accessible sur le matériel</span><span class="sxs-lookup"><span data-stu-id="02ec3-109">Allocation of hardware-accessible memory</span></span>
 - <span data-ttu-id="02ec3-110">Threads d’UC utilisés pour générer & les commandes Submit</span><span class="sxs-lookup"><span data-stu-id="02ec3-110">CPU threads used to generate & submit commands</span></span>
   - <span data-ttu-id="02ec3-111">Génération et soumission indépendantes</span><span class="sxs-lookup"><span data-stu-id="02ec3-111">Independent generation and submission</span></span>
   - <span data-ttu-id="02ec3-112">Non bloquant</span><span class="sxs-lookup"><span data-stu-id="02ec3-112">Non-blocking</span></span>
 - <span data-ttu-id="02ec3-113">Planification du travail matériel</span><span class="sxs-lookup"><span data-stu-id="02ec3-113">Scheduling of hardware work</span></span>
- <span data-ttu-id="02ec3-114">Aborde les fonctionnalités existantes, y compris la plupart des fonctionnalités vidéo de Direct3D 11, mais en même temps, la simplicité et la facilité d’utilisation sont à l’esprit.</span><span class="sxs-lookup"><span data-stu-id="02ec3-114">Covers existing functionality, including most Direct3D 11 video functionality, but at the same time, keeps simplicity and ease of use in mind</span></span>
- <span data-ttu-id="02ec3-115">Puissance et performances des applications Direct3D 12 principales égales ou supérieures à Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="02ec3-115">Power and performance of main Direct3D 12 applications equal to or better than Direct3D 11</span></span>
- <span data-ttu-id="02ec3-116">Cohérence avec les autres API Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="02ec3-116">Consistency with other Direct3D 12 APIs</span></span>
- <span data-ttu-id="02ec3-117">Interopérabilité avec les API Graphics existantes</span><span class="sxs-lookup"><span data-stu-id="02ec3-117">Interoperability with existing graphics APIs</span></span>


## <a name="video-decoding"></a><span data-ttu-id="02ec3-118">Décodage vidéo</span><span class="sxs-lookup"><span data-stu-id="02ec3-118">Video decoding</span></span>

<span data-ttu-id="02ec3-119">Les sections suivantes décrivent certaines des tâches impliquées dans l’implémentation du décodage vidéo Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="02ec3-119">The following sections describe some of the tasks involved in implementing Direct3D 12 video decoding.</span></span>

### <a name="query-for-decoding-capabilities"></a><span data-ttu-id="02ec3-120">Interroger les fonctionnalités de décodage</span><span class="sxs-lookup"><span data-stu-id="02ec3-120">Query for decoding capabilities</span></span>

<span data-ttu-id="02ec3-121">Appelez [ID3D12VideoDevice :: CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) pour vérifier les détails de prise en charge des opérations de décodage vidéo Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="02ec3-121">Call [ID3D12VideoDevice::CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) to check for the support details for Direct3D 12 video decoding operations.</span></span> <span data-ttu-id="02ec3-122">Transmettez une valeur de l’énumération [D3D12_FEATURE_VIDEO](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) pour spécifier la fonctionnalité pour laquelle vous demandez des informations de support.</span><span class="sxs-lookup"><span data-stu-id="02ec3-122">Pass a value from the [D3D12_FEATURE_VIDEO](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) enumeration to specify the feature for which you are requesting support information.</span></span>

### <a name="create-the-video-decoder"></a><span data-ttu-id="02ec3-123">Créer le décodeur vidéo</span><span class="sxs-lookup"><span data-stu-id="02ec3-123">Create the video decoder</span></span>

<span data-ttu-id="02ec3-124">Appelez [ID3D12VideoDevice :: CreateVideoDecoder](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoder) pour créer une instance de l’interface [ID3D12VideoDecoder](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoder) .</span><span class="sxs-lookup"><span data-stu-id="02ec3-124">Call [ID3D12VideoDevice::CreateVideoDecoder](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoder) to create an instance of the [ID3D12VideoDecoder](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoder) interface.</span></span> <span data-ttu-id="02ec3-125">Le décodeur conserve l’état d’une session de décodage, y compris les données liées à la référence, telles que les vecteurs de mouvement.</span><span class="sxs-lookup"><span data-stu-id="02ec3-125">The decoder holds state for a decode session, including reference-related data such as motion vectors.</span></span>  <span data-ttu-id="02ec3-126">En cas de modification de la résolution ou de modification d’un [MaxDecodePictureBufferCount](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decoder_heap_desc) , l’objet décodeur est recréé.</span><span class="sxs-lookup"><span data-stu-id="02ec3-126">In the event of a resolution change or a [MaxDecodePictureBufferCount](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decoder_heap_desc) change, the decoder object is recreated.</span></span> <span data-ttu-id="02ec3-127">La largeur et la hauteur de décodage spécifient la résolution du flux natif avant toute échelle.</span><span class="sxs-lookup"><span data-stu-id="02ec3-127">The decode width and height specify the native stream resolution before any scale.</span></span>  <span data-ttu-id="02ec3-128">Le nombre maximal de tampons d’images décodés (DPB) spécifie le plus grand nombre de DPB qui peut être utilisé sans recréer le décodeur vidéo.</span><span class="sxs-lookup"><span data-stu-id="02ec3-128">The maximum Decode Picture Buffer (DPB) count specifies the largest DPB count that can be used without recreating the video decoder.</span></span>

<span data-ttu-id="02ec3-129">Le décodeur peut être utilisé pour enregistrer des commandes à partir de plusieurs listes de commandes, mais il ne peut être associé qu’à une seule liste de commandes à la fois.</span><span class="sxs-lookup"><span data-stu-id="02ec3-129">The decoder may be used to record commands from multiple command lists, but may only be associated with one command list at a time.</span></span>  <span data-ttu-id="02ec3-130">L’application est chargée de synchroniser l’accès au décodeur.</span><span class="sxs-lookup"><span data-stu-id="02ec3-130">The application is responsible for synchronizing access to the decoder.</span></span>

### <a name="create-the-video-decoder-heap"></a><span data-ttu-id="02ec3-131">Créer le tas du décodeur vidéo</span><span class="sxs-lookup"><span data-stu-id="02ec3-131">Create the video decoder heap</span></span> 

<span data-ttu-id="02ec3-132">Appelez [ID3D12VideoDevice :: CreateVideoDecoderHeap](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoderheap) pour créer une instance de l’interface [ID3D12VideoDecoderHeap](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoderheap) .</span><span class="sxs-lookup"><span data-stu-id="02ec3-132">Call [ID3D12VideoDevice::CreateVideoDecoderHeap](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoderheap) to create an instance of the [ID3D12VideoDecoderHeap](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoderheap) interface.</span></span> <span data-ttu-id="02ec3-133">Cet objet contient les ressources et l’état des pilotes dépendants de la résolution.</span><span class="sxs-lookup"><span data-stu-id="02ec3-133">This object contains the resolution-dependent driver resources and state.</span></span>

### <a name="decoding-a-frame"></a><span data-ttu-id="02ec3-134">Décodage d’un frame</span><span class="sxs-lookup"><span data-stu-id="02ec3-134">Decoding a frame</span></span>

<span data-ttu-id="02ec3-135">Tous les paramètres d’entrée et de sortie pour les opérations de traitement vidéo sont organisés dans une structure de paramètres d’entrée, [D3D12_VIDEO_DECODE_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_input_stream_arguments)et une structure de paramètre de sortie, [D3D12_VIDEO_DECODE_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_output_stream_arguments).</span><span class="sxs-lookup"><span data-stu-id="02ec3-135">All input and output parameters for the video processing operations are organized into an input parameter structure, [D3D12_VIDEO_DECODE_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_input_stream_arguments), and an output parameter structure, [D3D12_VIDEO_DECODE_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_output_stream_arguments).</span></span>
<span data-ttu-id="02ec3-136">L’application gère les frames de référence et, par conséquent, doit définir les frames de référence pour chaque opération de décodage.</span><span class="sxs-lookup"><span data-stu-id="02ec3-136">The application manages the reference frames, and as such, needs to set the reference frames for every decoding operation.</span></span>
<span data-ttu-id="02ec3-137">Lorsque la liste de commandes est correctement enregistrée, appelez [ID3D12CommandQueue :: ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) dans la file d’attente de commandes vidéo pour envoyer le décodage de trame au GPU.</span><span class="sxs-lookup"><span data-stu-id="02ec3-137">When the command list is properly recorded, call [ID3D12CommandQueue::ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) on the video command queue to submit the frame decoding to the GPU.</span></span>


### <a name="enabling-decoder-output-conversions"></a><span data-ttu-id="02ec3-138">Activation des conversions de sortie du décodeur</span><span class="sxs-lookup"><span data-stu-id="02ec3-138">Enabling decoder output conversions</span></span>
<span data-ttu-id="02ec3-139">Si le décodeur prend en charge la conversion, activez les conversions souhaitées en remplissant correctement la structure [D3D12_VIDEO_DECODE_CONVERSION_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_conversion_arguments) .</span><span class="sxs-lookup"><span data-stu-id="02ec3-139">If the decoder supports conversion, then enable the desired conversions by properly filling the [D3D12_VIDEO_DECODE_CONVERSION_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_conversion_arguments) structure.</span></span> <span data-ttu-id="02ec3-140">Le format et les résolutions de la sortie souhaitée par rapport à la sortie native du décodeur sont communiqués via la différence dans l’espace de couleurs et les résolutions spécifiées dans les paramètres de conversion.</span><span class="sxs-lookup"><span data-stu-id="02ec3-140">The format and resolutions of the desired output versus the native output of the decoder are communicated via the difference in color space and resolutions specified in the conversion parameters.</span></span>

##  <a name="querying-decoding-status"></a><span data-ttu-id="02ec3-141">Interrogation de l’état de décodage</span><span class="sxs-lookup"><span data-stu-id="02ec3-141">Querying decoding status</span></span> 
<span data-ttu-id="02ec3-142">Utilisez les méthodes [ID3D12VideoDecodeCommandList :: BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery) et [ID3D12VideoDecodeCommandList :: EndQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery) pour interroger l’état de l’opération de décodage.</span><span class="sxs-lookup"><span data-stu-id="02ec3-142">Use the methods [ID3D12VideoDecodeCommandList::BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery) and [ID3D12VideoDecodeCommandList::EndQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery) to query the status of the decoding operation.</span></span>

<span data-ttu-id="02ec3-143">La structure [D3D12_QUERY_DATA_VIDEO_DECODE_STATISTICS](/windows/win32/api/d3d12video/ns-d3d12video-d3d12_query_data_video_decode_statistics) est utilisée pour décrire les statistiques de décodage vidéo.</span><span class="sxs-lookup"><span data-stu-id="02ec3-143">The [D3D12_QUERY_DATA_VIDEO_DECODE_STATISTICS](/windows/win32/api/d3d12video/ns-d3d12video-d3d12_query_data_video_decode_statistics) structure is used to describe video decode statistics.</span></span> <span data-ttu-id="02ec3-144">Pour obtenir une instance de cette structure, appelez [ID3D12VideoDecodeCommandList :: EndQuery](/windows/win32/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery), en passant la valeur de type de requête du tas de [D3D12_QUERY_TYPE_VIDEO_DECODE_STATISTIC](/windows/win32/api/d3d12/ne-d3d12-d3d12_query_type).</span><span class="sxs-lookup"><span data-stu-id="02ec3-144">To get an instance of this structure call [ID3D12VideoDecodeCommandList::EndQuery](/windows/win32/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery), passing in the heap query type value of [D3D12_QUERY_TYPE_VIDEO_DECODE_STATISTIC](/windows/win32/api/d3d12/ne-d3d12-d3d12_query_type).</span></span> <span data-ttu-id="02ec3-145">Notez que cette requête n’utilise pas [ID3D12VideoDecodeCommandList :: BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery).</span><span class="sxs-lookup"><span data-stu-id="02ec3-145">Note that this query does not use [ID3D12VideoDecodeCommandList::BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery).</span></span>

## <a name="video-processing"></a><span data-ttu-id="02ec3-146">Traitement vidéo</span><span class="sxs-lookup"><span data-stu-id="02ec3-146">Video processing</span></span>

<span data-ttu-id="02ec3-147">Les API vidéo Direct3D 12 adoptent une approche rationalisée pour le traitement vidéo, en éliminant les fonctionnalités de Direct3D 11 qui n’étaient pas largement utilisées et qui suppriment les vérifications de fonctionnalité pour les fonctionnalités qui sont obligatoires sur les appareils.</span><span class="sxs-lookup"><span data-stu-id="02ec3-147">Direct3D 12 video APIs take a streamlined approach to video processing, eliminating features of Direct3D 11 that weren't widely used and removing capability checks for features that are mandatory across devices.</span></span> <span data-ttu-id="02ec3-148">Le processus d’énumération pour le traitement vidéo est éliminé.</span><span class="sxs-lookup"><span data-stu-id="02ec3-148">The enumeration process for video processing is eliminated.</span></span> <span data-ttu-id="02ec3-149">Au lieu de cela, appelez [ID3D12VideoDevice :: CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) , ce qui permet à une application d’identifier les fonctionnalités du processeur vidéo.</span><span class="sxs-lookup"><span data-stu-id="02ec3-149">Instead, call [ID3D12VideoDevice::CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) which allows an app to identify the capabilities of the video processor.</span></span> <span data-ttu-id="02ec3-150">La vidéo souhaitée, les formats d’entrelacement, les formats stéréo et les tarifs sont fournis comme entrée pour **CheckFeatureSupport**.</span><span class="sxs-lookup"><span data-stu-id="02ec3-150">The desired video, interlace, stereo formats and rates are provided as as input to **CheckFeatureSupport**.</span></span>

### <a name="removed-capabilities"></a><span data-ttu-id="02ec3-151">Fonctionnalités supprimées</span><span class="sxs-lookup"><span data-stu-id="02ec3-151">Removed capabilities</span></span>

<span data-ttu-id="02ec3-152">Les fonctionnalités suivantes de Direct3D 11 ne sont pas prises en charge dans le traitement vidéo Direct3D 12 :</span><span class="sxs-lookup"><span data-stu-id="02ec3-152">The following capabilities from Direct3D 11 are not supported in Direct3D 12 video processing:</span></span>
- <span data-ttu-id="02ec3-153">Tarifs personnalisés.</span><span class="sxs-lookup"><span data-stu-id="02ec3-153">Custom rates.</span></span>  <span data-ttu-id="02ec3-154">Au lieu de cela, il existe un taux d’entrée et de sortie donné lors de l’enregistrement de commande [ID3D12VideoProcessCommandList ::P rocessframes](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) .</span><span class="sxs-lookup"><span data-stu-id="02ec3-154">Instead, there is an input and output rate given during the [ID3D12VideoProcessCommandList::ProcessFrames](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) command recording.</span></span>
- <span data-ttu-id="02ec3-155">Il n’y a que deux modes de désentrelacement disponibles maintenant : [Bob](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags) et [personnalisé](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags).</span><span class="sxs-lookup"><span data-stu-id="02ec3-155">There are just two deinterlacing modes available now: [BOB](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags) and [CUSTOM](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags).</span></span> <span data-ttu-id="02ec3-156">D’autres modes ont été éliminés.</span><span class="sxs-lookup"><span data-stu-id="02ec3-156">Other modes have been eliminated.</span></span> <span data-ttu-id="02ec3-157">PERSONNALISÉ est un mode de désentrelacement de haute qualité fourni par le fournisseur de matériel.</span><span class="sxs-lookup"><span data-stu-id="02ec3-157">CUSTOM is a high-quality deinterlacing mode provided by the hardware vendor.</span></span>
- <span data-ttu-id="02ec3-158">Tous les formats stéréo facultatifs dans [D3D11_VIDEO_PROCESSOR_STEREO_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_stereo_caps) ne sont plus pris en charge.</span><span class="sxs-lookup"><span data-stu-id="02ec3-158">All of the optional stereo formats in [D3D11_VIDEO_PROCESSOR_STEREO_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_stereo_caps) are no longer supported.</span></span> <span data-ttu-id="02ec3-159">Au lieu de cela, [nono](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [horizontal](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [vertical](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format)et [distinct](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format) sont obligatoires pour tous les périphériques matériels si le stéréo est pris en charge.</span><span class="sxs-lookup"><span data-stu-id="02ec3-159">Instead, [nono](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [horizontal](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [vertical](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), and [separate](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format) are mandatory for all hardware devices if stereo is supported.</span></span>
- <span data-ttu-id="02ec3-160">Il n’existe aucun équivalent pour [D3D11_VIDEO_PROCESSOR_FORMAT_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_format_caps) ou [D3D11_VIDEO_PROCESSOR_AUTO_STREAM_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_auto_stream_caps).</span><span class="sxs-lookup"><span data-stu-id="02ec3-160">There is no equivalent for [D3D11_VIDEO_PROCESSOR_FORMAT_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_format_caps) or [D3D11_VIDEO_PROCESSOR_AUTO_STREAM_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_auto_stream_caps).</span></span> <span data-ttu-id="02ec3-161">Au lieu de cela, les formats d’entrée et de sortie sont des arguments pour la création du processeur vidéo et, à ce moment-là, il doit être connu si le processeur vidéo peut ou ne peut pas effectuer l’opération avec le format donné.</span><span class="sxs-lookup"><span data-stu-id="02ec3-161">Instead, input and output formats are arguments to the creation of the video processor, and at that time, it should be known if the video processor can or cannot perform the operation with the given format.</span></span> <span data-ttu-id="02ec3-162">Le [D3D12_VIDEO_PROCESS_AUTO_PROCESSING_FLAGS](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_auto_processing_flags) est utilisé pour indiquer si les fonctionnalités de traitement automatique sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="02ec3-162">The [D3D12_VIDEO_PROCESS_AUTO_PROCESSING_FLAGS](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_auto_processing_flags) is used to indicate if auto processing features are available.</span></span>
- <span data-ttu-id="02ec3-163">Il n’existe aucun équivalent pour [D3D11_VIDEO_PROCESSOR_CAPS_LEGACY](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span><span class="sxs-lookup"><span data-stu-id="02ec3-163">There is no equivalent for [D3D11_VIDEO_PROCESSOR_CAPS_LEGACY](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span></span>
- <span data-ttu-id="02ec3-164">Il n’existe aucun équivalent pour [D3D11_VIDEO_PROCESSOR_CAPS_CONSTRICTION](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span><span class="sxs-lookup"><span data-stu-id="02ec3-164">There is no equivalent for [D3D11_VIDEO_PROCESSOR_CAPS_CONSTRICTION](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span></span>
- <span data-ttu-id="02ec3-165">Lors de la conversion d’un stéréo en mono, nous supposons que la vue de ligne de base est 0.</span><span class="sxs-lookup"><span data-stu-id="02ec3-165">When converting from stereo to mono, we assume the baseline view is 0.</span></span>
- <span data-ttu-id="02ec3-166">Le traitement vidéo Direct3D 12 ne prend pas en charge la conversion de mono en stéréo et il n’existe pas de prise en charge du décalage mono.</span><span class="sxs-lookup"><span data-stu-id="02ec3-166">Direct3D 12 video processing does not support converting mono to stereo and there is no support for mono offset.</span></span> 


### <a name="creating-a-video-processor"></a><span data-ttu-id="02ec3-167">Création d’un processeur vidéo</span><span class="sxs-lookup"><span data-stu-id="02ec3-167">Creating a video processor</span></span>

<span data-ttu-id="02ec3-168">Appelez [ID3D12VideoDevice :: CreateVideoProcessor](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideoprocessor) pour créer une instance du [ID3D12VideoProcessor](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videoprocessor).</span><span class="sxs-lookup"><span data-stu-id="02ec3-168">Call [ID3D12VideoDevice::CreateVideoProcessor](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideoprocessor) to create an instance of the [ID3D12VideoProcessor](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videoprocessor).</span></span> <span data-ttu-id="02ec3-169">Le processeur vidéo conserve l’état d’une session de traitement vidéo, y compris la mémoire intermédiaire requise, les données de traitement mises en cache ou un autre espace de travail temporaire.</span><span class="sxs-lookup"><span data-stu-id="02ec3-169">The video processor holds state for a video processing session, including required intermediate memory, cached processing data, or other temporary working space.</span></span> <span data-ttu-id="02ec3-170">Les arguments de création du processeur vidéo spécifient les opérations qui sont effectuées ou disponibles à [ID3D12VideoProcessCommandList1 ::P rocessframes1](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist1-processframes1) .</span><span class="sxs-lookup"><span data-stu-id="02ec3-170">The video processor creation arguments specify which operations are performed or are available at [ID3D12VideoProcessCommandList1::ProcessFrames1](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist1-processframes1) time.</span></span>  <span data-ttu-id="02ec3-171">Les allocations de pilotes pour effectuer l’opération de traitement vidéo (par exemple, intermédiaires) sont allouées au moment de la création du processeur vidéo.</span><span class="sxs-lookup"><span data-stu-id="02ec3-171">Driver allocations to perform the video process operation (e.g. intermediates) are allocated at video processor creation time.</span></span>  <span data-ttu-id="02ec3-172">Utilisez [D3D12_FEATURE_VIDEO_PROCESSOR_SIZE](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) pour déterminer la taille d’allocation du processeur vidéo à l’avance.</span><span class="sxs-lookup"><span data-stu-id="02ec3-172">Use [D3D12_FEATURE_VIDEO_PROCESSOR_SIZE](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) to determine the allocation size of the video processor in advance.</span></span>

<span data-ttu-id="02ec3-173">Le processeur vidéo peut uniquement être utilisé pour enregistrer des commandes à partir de plusieurs listes de commandes, mais il ne peut être associé qu’à une seule liste de commandes à la fois.</span><span class="sxs-lookup"><span data-stu-id="02ec3-173">The video processor may only be used to record commands from multiple command lists, but may only be associated with one command list at a time.</span></span>  <span data-ttu-id="02ec3-174">L’application est chargée de synchroniser l’accès au processeur vidéo.</span><span class="sxs-lookup"><span data-stu-id="02ec3-174">The application is responsible for synchronizing access to the video processor.</span></span>  <span data-ttu-id="02ec3-175">L’application doit également enregistrer les commandes de traitement vidéo sur la vidéo procoessor dans l’ordre dans lequel elles sont exécutées sur le GPU.</span><span class="sxs-lookup"><span data-stu-id="02ec3-175">The application must also record video processing commands against the video procoessor in the order that they are executed on the GPU.</span></span>

<span data-ttu-id="02ec3-176">Tous les arguments d’entrée et de sortie pour les opérations de traitement vidéo sont organisés dans une structure d’arguments d’entrée, [D3D12_VIDEO_PROCESS_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_input_stream_arguments)et une structure d’argument de sortie, [D3D12_VIDEO_PROCESS_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_output_stream_arguments).</span><span class="sxs-lookup"><span data-stu-id="02ec3-176">All input and output arguments for the video processing operations are organized into an input argument structure, [D3D12_VIDEO_PROCESS_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_input_stream_arguments), and an output argument structure, [D3D12_VIDEO_PROCESS_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_output_stream_arguments).</span></span> <span data-ttu-id="02ec3-177">L’application doit appeler [ID3D12VideoProcessCommandList ::P rocessframes](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) pour enregistrer l’opération de traitement vidéo qu’elle souhaite exécuter.</span><span class="sxs-lookup"><span data-stu-id="02ec3-177">The application must call [ID3D12VideoProcessCommandList::ProcessFrames](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) to record the video processing operation it wants to execute.</span></span> 

<span data-ttu-id="02ec3-178">Lors de l’enregistrement de la liste de commandes, appelez [ID3D12CommandQueue :: ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) dans la file d’attente de commandes vidéo pour envoyer le traitement du frame au GPU.</span><span class="sxs-lookup"><span data-stu-id="02ec3-178">When the command list is recorded, call [ID3D12CommandQueue::ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) on the video command queue to submit the frame processing to the GPU.</span></span>


## <a name="tiers"></a><span data-ttu-id="02ec3-179">Niveaux</span><span class="sxs-lookup"><span data-stu-id="02ec3-179">Tiers</span></span>

<span data-ttu-id="02ec3-180">La vidéo Direct3D 12 définit des niveaux qui regroupent les fonctionnalités des périphériques matériels, afin que l’application puisse avoir moins de chemins de code pour répondre à la variété du matériel.</span><span class="sxs-lookup"><span data-stu-id="02ec3-180">Direct3D 12 video defines tiers that group the capabilities of hardware devices, so that the app can have fewer code paths to cater to the variety of hardware.</span></span> <span data-ttu-id="02ec3-181">Les niveaux sont spécifiés avec l’énumération [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier) .</span><span class="sxs-lookup"><span data-stu-id="02ec3-181">The tiers are specified with the [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier) enumeration.</span></span>

<span data-ttu-id="02ec3-182">Dans tous les niveaux, les éléments suivants sont disponibles :</span><span class="sxs-lookup"><span data-stu-id="02ec3-182">In all the tiers, the following will be available:</span></span>

- <span data-ttu-id="02ec3-183">Vous n’avez pas besoin de recréation de décodeur pour les modifications de résolution.</span><span class="sxs-lookup"><span data-stu-id="02ec3-183">No need for decoder recreation on resolution changes.</span></span> <span data-ttu-id="02ec3-184">Seul le tas du décodeur doit être recréé lors de la modification de la résolution.</span><span class="sxs-lookup"><span data-stu-id="02ec3-184">Only the decoder heap needs to be recreated on resolution change.</span></span>
- <span data-ttu-id="02ec3-185">Tous les frames de référence seront gérés par l’application.</span><span class="sxs-lookup"><span data-stu-id="02ec3-185">All reference frames will be managed by the app.</span></span> <span data-ttu-id="02ec3-186">Cela permet au système d’économiser de la mémoire, car nous n’avons pas besoin d’allouer le nombre maximal de DPBs au moment de la création du décodeur dans certains niveaux, et offre aux applications une plus grande flexibilité dans les scénarios changeants de résolution.</span><span class="sxs-lookup"><span data-stu-id="02ec3-186">This allows the system to save memory since we do not need to allocate the maximum number of DPBs at decoder creation time in some tiers, and gives apps flexibility in resolution changing scenarios.</span></span>

<span data-ttu-id="02ec3-187">Notez que les niveaux sont des superensembles.</span><span class="sxs-lookup"><span data-stu-id="02ec3-187">Note that the tiers are supersets.</span></span> <span data-ttu-id="02ec3-188">Une application peut décider d’effectuer le niveau 1 et ne pas utiliser les fonctionnalités de niveau supérieur, ce qui est autorisé, mais peut ne pas fournir de performances optimales.</span><span class="sxs-lookup"><span data-stu-id="02ec3-188">An app may decide to do tier 1, and not use the higher level features, which is allowed but may not provide optimal performace.</span></span> <span data-ttu-id="02ec3-189">Pour plus d’informations sur les fonctionnalités associées aux différents niveaux de niveau, consultez [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier).</span><span class="sxs-lookup"><span data-stu-id="02ec3-189">For more information on the capabilities associated with different tier levels, see [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier).</span></span>

## <a name="reference-frames"></a><span data-ttu-id="02ec3-190">Frames de référence</span><span class="sxs-lookup"><span data-stu-id="02ec3-190">Reference frames</span></span>

<span data-ttu-id="02ec3-191">Avec Direct3D 12 Video, les frames de référence sont passés explicitement.</span><span class="sxs-lookup"><span data-stu-id="02ec3-191">With Direct3D 12 video, reference frames are passed explicitly.</span></span> <span data-ttu-id="02ec3-192">Cela permet d’effacer l’utilisation d’un tableau de textures ou de tableaux de texture lors du décodage des frames.</span><span class="sxs-lookup"><span data-stu-id="02ec3-192">This allows for clear usage of array of textures or texture arrays when we are decoding frames.</span></span> <span data-ttu-id="02ec3-193">L’application n’est pas obligée de passer exactement le même descripteur de ressource lorsqu’elle est utilisée comme référence. par exemple, il peut décider de copier une ressource dans une autre, puis de la transmettre à la place de la copie d’origine.</span><span class="sxs-lookup"><span data-stu-id="02ec3-193">The app is not required to pass the exact same resource handle when using it as a reference; it may, for instance, decide to copy one resource to another and then pass the copy instead of the original one.</span></span> <span data-ttu-id="02ec3-194">Les index DXVA *RefFrameList* et *CurrPic* sont toujours utilisés par le pilote pour stocker les données pertinentes pour chaque trame décodée.</span><span class="sxs-lookup"><span data-stu-id="02ec3-194">The DXVA *RefFrameList* and *CurrPic* indices are still used by the driver to store relevant data for each decoded frame.</span></span>


## <a name="directx-12-fences"></a><span data-ttu-id="02ec3-195">Limites DirectX 12</span><span class="sxs-lookup"><span data-stu-id="02ec3-195">DirectX 12 fences</span></span>

<span data-ttu-id="02ec3-196">Dans DirectX 12, l’application est chargée de synchroniser l’accès à leurs tampons.</span><span class="sxs-lookup"><span data-stu-id="02ec3-196">In DirectX 12, the app is responsible for synchronizing the access to their buffers.</span></span> <span data-ttu-id="02ec3-197">Pour le cas de décodage, il est nécessaire d’ajouter des délimiteurs aux mémoires tampons d’entrée et aux mémoires tampons de sortie.</span><span class="sxs-lookup"><span data-stu-id="02ec3-197">For the decoding case, there will be the need for adding fences to the input buffers and to the output buffers.</span></span> <span data-ttu-id="02ec3-198">Chaque clôture est associée à une valeur et est utilisée pour la synchronisation de l’UC et des moteurs matériels.</span><span class="sxs-lookup"><span data-stu-id="02ec3-198">Each fence has a value associated with it, and are used for synchronization of the CPU and the hardware engines.</span></span> <span data-ttu-id="02ec3-199">Pour plus d’informations, consultez [utilisation de barrières de ressources pour synchroniser les États des ressources dans Direct3D 12](/windows/desktop/direct3d12/using-resource-barriers-to-synchronize-resource-states-in-direct3d-12).</span><span class="sxs-lookup"><span data-stu-id="02ec3-199">For more information, see [Using Resource Barriers to Synchronize Resource States in Direct3D 12](/windows/desktop/direct3d12/using-resource-barriers-to-synchronize-resource-states-in-direct3d-12).</span></span>

<span data-ttu-id="02ec3-200">Une implémentation classique aura une clôture pour chaque mémoire tampon d’entrée.</span><span class="sxs-lookup"><span data-stu-id="02ec3-200">A typical implementation will have a fence for each input buffer.</span></span> <span data-ttu-id="02ec3-201">Dans le cas des mémoires tampons d’entrée, il est possible que la mémoire tampon soit disponible avant l’exécution de l’ensemble du processus de décodage.</span><span class="sxs-lookup"><span data-stu-id="02ec3-201">In the case of input buffers, it is possible that the buffer may be available before the whole decoding process is done.</span></span> <span data-ttu-id="02ec3-202">Le système ignore ce cas et suppose que la mémoire tampon d’entrée est disponible lorsque le décodage est terminé.</span><span class="sxs-lookup"><span data-stu-id="02ec3-202">The system will ignore this case and assume that the input buffer is available when decoding is done.</span></span>
<span data-ttu-id="02ec3-203">Une implémentation aura également une clôture pour chaque mémoire tampon de sortie.</span><span class="sxs-lookup"><span data-stu-id="02ec3-203">An implementation will also usually have a fence for each output buffer.</span></span> <span data-ttu-id="02ec3-204">Dans le cas de l’envoi de la sortie au compositeur, par exemple, une clôture est signalée lorsque cette présentation de ce frame est terminée, ce qui indique que la sortie est de nouveau disponible pour le décodeur.</span><span class="sxs-lookup"><span data-stu-id="02ec3-204">In the case of sending the output to the compositor, for instance, a fence is needed that is signaled when that presentation of that frame is finally done, indicating that the output is again available for the decoder.</span></span>


## <a name="related-topics"></a><span data-ttu-id="02ec3-205">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="02ec3-205">Related topics</span></span>

<dl> <span data-ttu-id="02ec3-206"><dt>API vidéo Direct3D 
[12](direct3d-12-video-apis.md) 
 [Guide de programmation Media Foundation](media-foundation-programming-guide.md)
</dt> </span><span class="sxs-lookup"><span data-stu-id="02ec3-206"><dt>
[Direct3D 12 Video APIs](direct3d-12-video-apis.md)
[Media Foundation Programming Guide](media-foundation-programming-guide.md)
</dt> </span></span></dl>

 

 
