---
description: Media Foundation fournit la source de média ASF qu’une application peut utiliser pour représenter un fichier ASF dans la couche de pipeline de l’architecture.
ms.assetid: a2d2b382-d666-4a37-a6a9-0b839fbfbec3
title: Source de média ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 75dc682d48339ce4ff707e7859a6962b9f5cfd92
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/03/2021
ms.locfileid: "106539392"
---
# <a name="asf-media-source"></a><span data-ttu-id="45cfc-103">Source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-103">ASF Media Source</span></span>

<span data-ttu-id="45cfc-104">Media Foundation fournit la source de média ASF qu’une application peut utiliser pour représenter un fichier ASF dans la couche de pipeline de l’architecture.</span><span class="sxs-lookup"><span data-stu-id="45cfc-104">Media Foundation provides the ASF media source that an application can use to represent an ASF file in the pipeline layer of the architecture.</span></span>

<span data-ttu-id="45cfc-105">Pour pouvoir lire un fichier ASF, une application peut utiliser la source de média ASF pour alimenter les données dans un pipeline de lecture.</span><span class="sxs-lookup"><span data-stu-id="45cfc-105">In order to play an ASF file, an application can use the ASF media source to feed data into a playback pipeline.</span></span> <span data-ttu-id="45cfc-106">Dans un scénario d’encodage, l’application peut utiliser la source de média ASF comme source pour convertir dans un autre format ou pour convertir un fichier de taux binaire plus élevé en un fichier à vitesse de transmission plus faible sans modifier les formats.</span><span class="sxs-lookup"><span data-stu-id="45cfc-106">In an encoding scenario, application can use the ASF media source as the source to convert into another format or for converting a higher bit-rate file to a lower bit-rate file without changing formats.</span></span> <span data-ttu-id="45cfc-107">La source de média ASF doit être utilisée dans la couche de pipeline, autrement dit, une application doit utiliser la session de média pour contrôler l’opération.</span><span class="sxs-lookup"><span data-stu-id="45cfc-107">The ASF media source must be used in the pipeline layer, that is, an application must use the Media Session to control the operation.</span></span> <span data-ttu-id="45cfc-108">Ce niveau d’accès permet aux applications d’accéder aux événements pendant que la session multimédia est en cours.</span><span class="sxs-lookup"><span data-stu-id="45cfc-108">This level of access allows the applications to get events while the Media Session is in progress.</span></span> <span data-ttu-id="45cfc-109">Pour bénéficier d’un accès de niveau inférieur au contenu ASF, une application doit utiliser les composants ASF de la couche WMContainer.</span><span class="sxs-lookup"><span data-stu-id="45cfc-109">To get lower-level access to the ASF content, an application must use the WMContainer Layer ASF components.</span></span>

<span data-ttu-id="45cfc-110">La source de média ASF implémente l’interface [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) , qui est l’interface générique pour les sources de média dans Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="45cfc-110">The ASF media source implements the [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) interface, which is the generic interface for media sources in Media Foundation.</span></span> <span data-ttu-id="45cfc-111">Comme n’importe quelle autre source multimédia, la source de média ASF fournit un descripteur de présentation qui décrit principalement l’objet d’en-tête ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-111">Like any other media source, the ASF media source provides a presentation descriptor that primarily describes the ASF Header Object.</span></span> <span data-ttu-id="45cfc-112">En outre, la source de média ASF fournit des descripteurs de flux qui représentent chaque flux dans le contenu multimédia.</span><span class="sxs-lookup"><span data-stu-id="45cfc-112">In addition, the ASF media source provides stream descriptors that represent each stream in the media content.</span></span> <span data-ttu-id="45cfc-113">Pour plus d’informations, consultez [structure des fichiers ASF](asf-file-structure.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-113">For more information, see [ASF File Structure](asf-file-structure.md).</span></span>

-   [<span data-ttu-id="45cfc-114">Création de la source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-114">Creating the ASF Media Source</span></span>](#creating-the-asf-media-source)
-   [<span data-ttu-id="45cfc-115">Paramètres de configuration pour la source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-115">Configuration Settings for the ASF Media Source</span></span>](#configuration-settings-for-the-asf-media-source)
-   [<span data-ttu-id="45cfc-116">Modèle objet de source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-116">ASF Media Source Object Model</span></span>](#asf-media-source-object-model)
-   [<span data-ttu-id="45cfc-117">Services source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-117">ASF Media Source Services</span></span>](#asf-media-source-services)
    -   [<span data-ttu-id="45cfc-118">Traduction du code temporel</span><span class="sxs-lookup"><span data-stu-id="45cfc-118">Timecode Translation</span></span>](#timecode-translation)
-   [<span data-ttu-id="45cfc-119">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="45cfc-119">Related topics</span></span>](#related-topics)

## <a name="creating-the-asf-media-source"></a><span data-ttu-id="45cfc-120">Création de la source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-120">Creating the ASF Media Source</span></span>

<span data-ttu-id="45cfc-121">Pour créer la source de média ASF, l’application doit utiliser le programme de [résolution de source](source-resolver.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-121">To create the ASF media source, the application must use the [Source Resolver](source-resolver.md).</span></span> <span data-ttu-id="45cfc-122">Pour créer la source de média ASF, l’application doit fournir la source pour laquelle le programme de résolution source crée la source du média ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-122">In order to create the ASF media source, the application must provide the source for which the source resolver creates the ASF media source.</span></span> <span data-ttu-id="45cfc-123">Les informations sur la source doivent être fournies en spécifiant l’URL du fichier source ou le flux d’octets qui contient le média.</span><span class="sxs-lookup"><span data-stu-id="45cfc-123">The source information must be provided by either specifying the URL of the source file or the byte stream that contains the media.</span></span> <span data-ttu-id="45cfc-124">Si l’application choisit de créer la source du média ASF en spécifiant l’URL, elle doit appeler [**IMFSourceResolver :: CreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfromurl) pour une opération synchrone ou **IMFSourceResolver :: Begin... EndCreateObjectFromURL** pour l’opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="45cfc-124">If the application chooses to create the ASF media source by specifying the URL, it must call either [**IMFSourceResolver::CreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfromurl) for synchronous operation or **IMFSourceResolver::Begin…EndCreateObjectFromURL** for asynchronous operation.</span></span> <span data-ttu-id="45cfc-125">Le processus de création de la source du média à partir d’un flux d’octets est similaire.</span><span class="sxs-lookup"><span data-stu-id="45cfc-125">The process for creating the media source from a byte stream is similar.</span></span> <span data-ttu-id="45cfc-126">L’application doit appeler [**IMFSourceResolver :: CreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfrombytestream) pour une opération synchrone ou **IMFSourceResolver :: Begin... EndCreateObjectFromBytestream** pour l’opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="45cfc-126">The application must call either [**IMFSourceResolver::CreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfrombytestream) for synchronous operation or **IMFSourceResolver::Begin…EndCreateObjectFromBytestream** for asynchronous operation.</span></span> <span data-ttu-id="45cfc-127">Ces appels doivent spécifier le \_ \_ MEDIASOURCE de résolution MF dans le paramètre *dwFlags* .</span><span class="sxs-lookup"><span data-stu-id="45cfc-127">These calls must specify MF\_RESOLUTION\_MEDIASOURCE in *dwFlags* parameter.</span></span> <span data-ttu-id="45cfc-128">Pour plus d’informations sur l’utilisation de cet indicateur, consultez Utilisation du programme de résolution source.</span><span class="sxs-lookup"><span data-stu-id="45cfc-128">For more information about using this flag, see Using the Source Resolver.</span></span>

<span data-ttu-id="45cfc-129">Si l’application spécifie une URL, pour un fichier local, la chaîne d’URL peut contenir le chemin d’accès du fichier multimédia ou peut avoir pour préfixe le schéma « fichier : ».</span><span class="sxs-lookup"><span data-stu-id="45cfc-129">If the application specifies a URL, for a local file, the URL string can contain the path of the media file or can be prefixed with the “file: “scheme.</span></span> <span data-ttu-id="45cfc-130">L’extension de nom de fichier doit être « . ASF », « . WM », L « . WMA » ou « . wmv ».</span><span class="sxs-lookup"><span data-stu-id="45cfc-130">The file name extension must be ".asf", ".wm", L".wma", or ".wmv".</span></span> <span data-ttu-id="45cfc-131">Pour un fichier ASF sur le réseau, le programme de résolution source crée la [source réseau](network-source-features.md), qui utilise la source de média ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-131">For an ASF file on the network, the source resolver creates the [Network Source](network-source-features.md), which uses the ASF media source.</span></span>

<span data-ttu-id="45cfc-132">Pendant le processus de création d’objet, le programme de résolution source recherche la liste des gestionnaires de schémas et les gestionnaires de flux d’octets dans le registre système et charge le gestionnaire correspondant le plus proche qui peut analyser le contenu multimédia et également créer l’objet source du média en dessous.</span><span class="sxs-lookup"><span data-stu-id="45cfc-132">During the object creation process, the source resolver looks up the list of scheme handlers and the byte stream handlers in the system registry and loads the closest matching handler that can parse the media content and also create the media source object underneath.</span></span> <span data-ttu-id="45cfc-133">Quelle que soit la méthode utilisée pour créer la source du média (URL et flux d’octets), le programme de résolution source crée un flux d’octets et lit le contenu du média source dans le flux d’octets.</span><span class="sxs-lookup"><span data-stu-id="45cfc-133">Irrespective of the method used to create the media source (URL and byte stream), the source resolver creates a byte stream and reads the contents of source media into the byte stream.</span></span> <span data-ttu-id="45cfc-134">Pour plus d’informations, consultez [gestionnaires de modèles et gestionnaires de Byte-Stream](scheme-handlers-and-byte-stream-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-134">For more information, see [Scheme Handlers and Byte-Stream Handlers](scheme-handlers-and-byte-stream-handlers.md).</span></span>

<span data-ttu-id="45cfc-135">Pour obtenir un exemple de code sur la création d’une source multimédia, consultez [utilisation du programme de résolution source](using-the-source-resolver.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-135">For code example about how to create a media source, see [Using the Source Resolver](using-the-source-resolver.md).</span></span>

## <a name="configuration-settings-for-the-asf-media-source"></a><span data-ttu-id="45cfc-136">Paramètres de configuration pour la source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-136">Configuration Settings for the ASF Media Source</span></span>

<span data-ttu-id="45cfc-137">Le programme de résolution source interroge les fonctionnalités du flux d’octets sous-jacent et détermine que les opérations sont autorisées sur la source du média nouvellement créée.</span><span class="sxs-lookup"><span data-stu-id="45cfc-137">The source resolver queries for the capabilities of the underlying byte stream and determines the operations are allowed on the newly created media source.</span></span> <span data-ttu-id="45cfc-138">Une de ces fonctionnalités est enquête de recherche.</span><span class="sxs-lookup"><span data-stu-id="45cfc-138">One of such capabilities is seeking.</span></span> <span data-ttu-id="45cfc-139">Si une opération de recherche est autorisée, l’application peut spécifier le mode de recherche utilisé par la source du média lors de la recherche d’un point particulier dans la présentation.</span><span class="sxs-lookup"><span data-stu-id="45cfc-139">If a seek operation is allowed, the application can specify the seeking mode that the media source uses while seeking to a particular point in the presentation.</span></span>

<span data-ttu-id="45cfc-140">Une application peut définir le mode de recherche, pour la source du média, à utiliser lors de la création de l’objet.</span><span class="sxs-lookup"><span data-stu-id="45cfc-140">An application can set the seek mode, for the media source to use, during object creation.</span></span> <span data-ttu-id="45cfc-141">Une fois la source du média ASF créée avec le mode de recherche spécifié, elle ne peut pas être modifiée sur la source du média ou modifiée dynamiquement au cours d’une présentation.</span><span class="sxs-lookup"><span data-stu-id="45cfc-141">After the ASF media source is created with the specified seek mode, it cannot be modified on the media source or dynamically changed during a presentation.</span></span> <span data-ttu-id="45cfc-142">Les préférences de recherche sont spécifiées en tant que propriétés dans l’appel de l’application aux méthodes de programme de résolution source appropriées utilisées pour créer la source du média.</span><span class="sxs-lookup"><span data-stu-id="45cfc-142">Seeking preferences are specified as properties in the application’s call to the relevant source resolver methods that are used to create the media source.</span></span> <span data-ttu-id="45cfc-143">Ces propriétés sont définies dans une banque de propriétés et transmises au paramètre *pProps* .</span><span class="sxs-lookup"><span data-stu-id="45cfc-143">These set of properties are set in a property store and passed to the *pProps* parameter.</span></span> <span data-ttu-id="45cfc-144">Si ces propriétés ne sont pas passées, la source du média fonctionne avec les paramètres par défaut.</span><span class="sxs-lookup"><span data-stu-id="45cfc-144">If these properties are not passed, the media source functions with the default settings.</span></span> <span data-ttu-id="45cfc-145">Pour plus d’informations sur la définition de ces propriétés, consultez [configuration d’une source de média](configuring-a-media-source.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-145">For more information about setting these properties, see [Configuring a Media Source](configuring-a-media-source.md).</span></span>

<span data-ttu-id="45cfc-146">Si la recherche est autorisée, la source du média ASF prend en charge les modes de recherche suivants :</span><span class="sxs-lookup"><span data-stu-id="45cfc-146">If seeking is allowed, the ASF media source supports the following seek modes:</span></span>

-   <span data-ttu-id="45cfc-147">Recherche exacte : dans ce mode, la source du média ASF s’appuie sur l’objet d’index ASF du fichier ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-147">Exact seeking: In this mode, the ASF media source relies on the ASF Index Object of the ASF file.</span></span> <span data-ttu-id="45cfc-148">Si le fichier n’a pas d’objet index, la recherche exacte est désactivée et l’un des autres modes est utilisé en fonction des propriétés spécifiées par l’application définies sur la source du média.</span><span class="sxs-lookup"><span data-stu-id="45cfc-148">If the file does not have the Index Object, exact seeking is disabled and one of the other modes are used depending on the application-specified properties that are set on the media source.</span></span>
-   <span data-ttu-id="45cfc-149">Recherche approximative : ce mode est demandé par l’application en transmettant [**MFPKEY \_ ASFMediaSource \_ ApproxSeek**](mfpkey-asfmediasource-approxseek-property.md) dans la Banque de propriétés aux méthodes de programme de résolution source appropriées.</span><span class="sxs-lookup"><span data-stu-id="45cfc-149">Approximate seeking: This mode is requested by the application by passing [**MFPKEY\_ASFMediaSource\_ApproxSeek**](mfpkey-asfmediasource-approxseek-property.md) in the property store to the relevant source resolver methods.</span></span> <span data-ttu-id="45cfc-150">Toutefois, la recherche approximative n’est utilisée que si le flux d’octets ne prend pas en charge la recherche basée sur le temps.</span><span class="sxs-lookup"><span data-stu-id="45cfc-150">However, approximate seeking is only used if the byte stream does not support time-based seeking.</span></span> <span data-ttu-id="45cfc-151">Dans ce mode, la source du média détermine une heure de début qui est relativement plus proche du temps de recherche.</span><span class="sxs-lookup"><span data-stu-id="45cfc-151">In this mode, the media source determine a start time that is relatively closer to the seek time.</span></span> <span data-ttu-id="45cfc-152">Si le fichier ASF contient un objet d’index ASF, il est utilisé pour calculer l’heure de début.</span><span class="sxs-lookup"><span data-stu-id="45cfc-152">If the ASF file contains an ASF Index Object, it is used to calculate the start time.</span></span> <span data-ttu-id="45cfc-153">La recherche approximative est moins précise mais plus rapide que la recherche exacte, car la durée de rendu du premier échantillon à l’heure de début prédéterminée est plus rapide.</span><span class="sxs-lookup"><span data-stu-id="45cfc-153">Approximate seeking is less accurate but faster than exact seeking because the time taken render the first sample at the predetermined start time is faster.</span></span>
-   <span data-ttu-id="45cfc-154">Recherche itérative : pour définir ce mode, l’application doit définir la propriété [MFPKEY \_ ASFMediaSource \_ IterativeSeekIfNoIndex](mfpkey-asfmediasource-iterativeseekifnoindex.md) .</span><span class="sxs-lookup"><span data-stu-id="45cfc-154">Iterative seeking: To set this mode, the application must set the [MFPKEY\_ASFMediaSource\_IterativeSeekIfNoIndex](mfpkey-asfmediasource-iterativeseekifnoindex.md) property.</span></span> <span data-ttu-id="45cfc-155">La recherche itérative est un algorithme permettant de trouver une position dans un fichier ASF qui ne contient aucun objet d’index ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-155">Iterative seeking is an algorithm to find a position in an ASF file that contains no ASF Index Object.</span></span> <span data-ttu-id="45cfc-156">Dans ce mode, la source du média détermine une estimation approximative du point de recherche en lisant le décalage du flux d’octets.</span><span class="sxs-lookup"><span data-stu-id="45cfc-156">In this mode, the media source determins a rough estimate of the seek point by reading the byte stream offset.</span></span> <span data-ttu-id="45cfc-157">Elle utilise une série de approximations, en fonction de la vitesse de transmission moyenne, pour se rapprocher progressivement du temps de recherche cible.</span><span class="sxs-lookup"><span data-stu-id="45cfc-157">It uses a series of approximations, based on the average bit rate, to get progressively closer to the target seek time.</span></span> <span data-ttu-id="45cfc-158">(L’algorithme est similaire à une recherche binaire.) La recherche itérative peut prendre plus de temps que la recherche à l’aide de l’objet index. elle est donc désactivée par défaut.</span><span class="sxs-lookup"><span data-stu-id="45cfc-158">(The algorithm is similar to a binary search.) Iterative seeking can take longer than seeking by using the Index Object, so it is disabled by default.</span></span> <span data-ttu-id="45cfc-159">Si vous définissez cette propriété, utilisez les propriétés suivantes pour définir les paramètres de recherche : [MFPKEY \_ ASFMediaSource \_ IterativeSeek \_ Max \_ Count](mfpkey-asfmediasource-iterativeseek-max-count.md)[MFPKEY \_ ASFMediaSource \_ IterativeSeek \_ Tolerance \_ en \_ millisecondes](mfpkey-asfmediasource-iterativeseek-tolerance-in-millisecond.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-159">If you set this property, use the following properties to set the search parameters: [MFPKEY\_ASFMediaSource\_IterativeSeek\_Max\_Count](mfpkey-asfmediasource-iterativeseek-max-count.md)[MFPKEY\_ASFMediaSource\_IterativeSeek\_Tolerance\_In\_MilliSecond](mfpkey-asfmediasource-iterativeseek-tolerance-in-millisecond.md).</span></span> <span data-ttu-id="45cfc-160">Ces propriétés définissent respectivement le nombre maximal d’itérations et la tolérance.</span><span class="sxs-lookup"><span data-stu-id="45cfc-160">These properties set the maximum number of iterations and the tolerance, respectively.</span></span> <span data-ttu-id="45cfc-161">L’algorithme s’arrête lorsqu’il atteint le nombre maximal d’itérations, ou lorsqu’il trouve un paquet dont la distance par rapport à l’heure de recherche est comprise dans la tolérance spécifiée.</span><span class="sxs-lookup"><span data-stu-id="45cfc-161">The algorithm halts when it reaches the maximum number of iterations, or when it finds a packet whose distance from the seek time is within the specified tolerance.</span></span>

<span data-ttu-id="45cfc-162">Pour résumer, l’application a la possibilité de choisir une recherche approximative ou itérative lorsque le fichier ASF ne contient pas d’objet d’index ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-162">In a nutshell, the application has the option of choosing approximate or iterative seeking when the ASF file does not contain an ASF Index Object.</span></span>

## <a name="asf-media-source-object-model"></a><span data-ttu-id="45cfc-163">Modèle objet de source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-163">ASF Media Source Object Model</span></span>

<span data-ttu-id="45cfc-164">La source de média ASF implémente l’interface [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) et expose les interfaces suivantes.</span><span class="sxs-lookup"><span data-stu-id="45cfc-164">The ASF media source implements the [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) interface and exposes the following interfaces.</span></span> <span data-ttu-id="45cfc-165">Une application peut obtenir une référence à ces interfaces en appelant **IMFMediaSource :: QueryInterface** sur la source du média ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-165">An application can get a reference to these interfaces by calling **IMFMediaSource::QueryInterface** on the ASF media source.</span></span>



| <span data-ttu-id="45cfc-166">Interface</span><span class="sxs-lookup"><span data-stu-id="45cfc-166">Interface</span></span>                                                | <span data-ttu-id="45cfc-167">Description</span><span class="sxs-lookup"><span data-stu-id="45cfc-167">Description</span></span>                                                                                                                                        |
|----------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="45cfc-168">**IMFMediaSource**</span><span class="sxs-lookup"><span data-stu-id="45cfc-168">**IMFMediaSource**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource)                 | <span data-ttu-id="45cfc-169">Obligatoire pour toutes les sources multimédias.</span><span class="sxs-lookup"><span data-stu-id="45cfc-169">Required for all media sources.</span></span>                                                                                                                    |
| [<span data-ttu-id="45cfc-170">**IMFMediaEventGenerator**</span><span class="sxs-lookup"><span data-stu-id="45cfc-170">**IMFMediaEventGenerator**</span></span>](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) | <span data-ttu-id="45cfc-171">Obligatoire pour toutes les sources multimédias.</span><span class="sxs-lookup"><span data-stu-id="45cfc-171">Required for all media sources.</span></span> <span data-ttu-id="45cfc-172">Permet aux applications d’extraire des événements de la source du média via la session multimédia.</span><span class="sxs-lookup"><span data-stu-id="45cfc-172">Allows applications to get events from the media source through the Media Session.</span></span>                                 |
| [<span data-ttu-id="45cfc-173">**IMFGetService**</span><span class="sxs-lookup"><span data-stu-id="45cfc-173">**IMFGetService**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice)                   | <span data-ttu-id="45cfc-174">Interroge la source du média pour l’interface de service spécifiée.</span><span class="sxs-lookup"><span data-stu-id="45cfc-174">Queries the media source for the specified service interface.</span></span>                                                                                      |
| [<span data-ttu-id="45cfc-175">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="45cfc-175">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)               | <span data-ttu-id="45cfc-176">Définit et obtient les propriétés de la source du média.</span><span class="sxs-lookup"><span data-stu-id="45cfc-176">Sets and gets properties on the media source.</span></span> <span data-ttu-id="45cfc-177">Chaque propriété contient un nom descriptif et une valeur.</span><span class="sxs-lookup"><span data-stu-id="45cfc-177">Each property contains a descriptive name and a value.</span></span>                                               |
| [<span data-ttu-id="45cfc-178">**IMFMetadata**</span><span class="sxs-lookup"><span data-stu-id="45cfc-178">**IMFMetadata**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfmetadata)                       | <span data-ttu-id="45cfc-179">Décrit les métadonnées du fichier ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-179">Describes the metadata for the ASF file.</span></span>                                                                                                           |
| [<span data-ttu-id="45cfc-180">**IMFMetadataProvider**</span><span class="sxs-lookup"><span data-stu-id="45cfc-180">**IMFMetadataProvider**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfmetadataprovider)       | <span data-ttu-id="45cfc-181">Récupère une collection de métadonnées, soit pour une présentation complète, soit pour un flux de la présentation.</span><span class="sxs-lookup"><span data-stu-id="45cfc-181">Retrieves a collection of metadata, either for an entire presentation, or for one stream in the presentation.</span></span>                                      |
| [<span data-ttu-id="45cfc-182">**IMFRateSupport**</span><span class="sxs-lookup"><span data-stu-id="45cfc-182">**IMFRateSupport**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfratesupport)                 | <span data-ttu-id="45cfc-183">Interroge la plage des taux de lecture pris en charge, y compris la lecture inversée.</span><span class="sxs-lookup"><span data-stu-id="45cfc-183">Queries the range of playback rates that are supported, including reverse playback.</span></span>                                                                |
| [<span data-ttu-id="45cfc-184">**IMFRateControl**</span><span class="sxs-lookup"><span data-stu-id="45cfc-184">**IMFRateControl**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol)                 | <span data-ttu-id="45cfc-185">Obtient ou définit la vitesse de lecture.</span><span class="sxs-lookup"><span data-stu-id="45cfc-185">Gets or sets the playback rate.</span></span>                                                                                                                    |
| [<span data-ttu-id="45cfc-186">**IMFTrustedInput**</span><span class="sxs-lookup"><span data-stu-id="45cfc-186">**IMFTrustedInput**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imftrustedinput)               | <span data-ttu-id="45cfc-187">Obtient l’ITA pour chacun des flux ASF contenus dans la source.</span><span class="sxs-lookup"><span data-stu-id="45cfc-187">Gets the ITA for each of the ASF streams contained in the source.</span></span>                                                                                  |
| [<span data-ttu-id="45cfc-188">**IMFPMPClient**</span><span class="sxs-lookup"><span data-stu-id="45cfc-188">**IMFPMPClient**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient)                     | <span data-ttu-id="45cfc-189">Permet à une source de média de recevoir un pointeur vers l’interface [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) , qui est utilisée pour créer des objets dans le processus PMP.</span><span class="sxs-lookup"><span data-stu-id="45cfc-189">Enables a media source to receive a pointer to the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface, which is used to create objects in the PMP process.</span></span> |
| [<span data-ttu-id="45cfc-190">**IMFTimecodeTranslate**</span><span class="sxs-lookup"><span data-stu-id="45cfc-190">**IMFTimecodeTranslate**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate)     | <span data-ttu-id="45cfc-191">Convertit entre les codes de temps de la société d’appareils de télévision et de téléviseurs et les unités de temps de 100 nanosecondes.</span><span class="sxs-lookup"><span data-stu-id="45cfc-191">Converts between Society of Motion Picture and Television Engineers (SMPTE) time codes and 100-nanosecond time units.</span></span>                              |



 

## <a name="asf-media-source-services"></a><span data-ttu-id="45cfc-192">Services source de média ASF</span><span class="sxs-lookup"><span data-stu-id="45cfc-192">ASF Media Source Services</span></span>

<span data-ttu-id="45cfc-193">La source de média ASF fournit différents services dont l’étendue est un fichier ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-193">The ASF media source provides various services that are scoped for ASF file.</span></span> <span data-ttu-id="45cfc-194">Pour obtenir un pointeur vers un service particulier, l’application doit utiliser l’un des identificateurs de service suivants dans son appel à [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice).</span><span class="sxs-lookup"><span data-stu-id="45cfc-194">To get a pointer to a particular service, the application must use one of the following service identifiers in its call to [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice).</span></span> <span data-ttu-id="45cfc-195">Pour plus d’informations, consultez [interfaces de service](service-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-195">For information, see [Service Interfaces](service-interfaces.md).</span></span>



| <span data-ttu-id="45cfc-196">Identificateur de service</span><span class="sxs-lookup"><span data-stu-id="45cfc-196">Service Identifier</span></span>               | <span data-ttu-id="45cfc-197">Description</span><span class="sxs-lookup"><span data-stu-id="45cfc-197">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="45cfc-198">SERVICE de contrôle de la \_ fréquence MF \_ \_</span><span class="sxs-lookup"><span data-stu-id="45cfc-198">MF\_RATE\_CONTROL\_SERVICE</span></span>       | <span data-ttu-id="45cfc-199">À l’aide de cet identificateur, une application peut obtenir un pointeur vers des interfaces [**IMFRateSupport**](/windows/desktop/api/mfidl/nn-mfidl-imfratesupport) ou [**IMFRateControl**](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol) .</span><span class="sxs-lookup"><span data-stu-id="45cfc-199">By using this identifier, an application can get a pointer to either [**IMFRateSupport**](/windows/desktop/api/mfidl/nn-mfidl-imfratesupport) or [**IMFRateControl**](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol) interfaces.</span></span> <span data-ttu-id="45cfc-200">En utilisant l’objet de prise en charge des taux implémenté par la source du média, l’application peut vérifier si un taux particulier est pris en charge par le fichier de média ASF sous-jacent, ce qui permet également d’obtenir le taux le plus rapide et le plus lent.</span><span class="sxs-lookup"><span data-stu-id="45cfc-200">By using the rate support object implemented by the media source, the application can check if a particular rate is supported by the underlying ASF media file also get the fastest and the slowest rate.</span></span> <span data-ttu-id="45cfc-201">En utilisant l’objet de contrôle de fréquence, l’application peut récupérer et définir la vitesse de lecture.</span><span class="sxs-lookup"><span data-stu-id="45cfc-201">By using the rate control object the application can get and set the playback rate.</span></span> <span data-ttu-id="45cfc-202">Si l’application spécifie une vitesse particulière pour la lecture, la source de média ASF vérifie d’abord si le taux demandé est compris dans les limites du taux de transfert (déterminé par les tarifs rapides et les taux les plus lents), puis définit la vitesse.</span><span class="sxs-lookup"><span data-stu-id="45cfc-202">If the application specifies a particular rate for playback, the ASF media source first checks if the requested rate is within the rate limits (determined by fasted and slowest rates) and then sets the rate.</span></span> <span data-ttu-id="45cfc-203">Cela ne vérifie pas les conditions variables, car le débit binaire peut changer à tout moment en fonction de la bande passante réseau.</span><span class="sxs-lookup"><span data-stu-id="45cfc-203">This does not check for variable conditions as the bitrate might change any moment depending on the network bandwidth.</span></span> <span data-ttu-id="45cfc-204">Pour plus d’informations, [le contrôle](rate-control.md)de la fréquence.</span><span class="sxs-lookup"><span data-stu-id="45cfc-204">For more information, [Rate Control](rate-control.md).</span></span> |
| <span data-ttu-id="45cfc-205">\_service de fournisseur de métadonnées MF \_ \_</span><span class="sxs-lookup"><span data-stu-id="45cfc-205">MF\_METADATA\_PROVIDER\_SERVICE</span></span>  | <span data-ttu-id="45cfc-206">À l’aide de cet identificateur, l’application peut obtenir un pointeur vers l’interface [**IMFMetadataProvider**](/windows/desktop/api/mfidl/nn-mfidl-imfmetadataprovider) de la source de média ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-206">By using this identifier, the application can get a pointer to the [**IMFMetadataProvider**](/windows/desktop/api/mfidl/nn-mfidl-imfmetadataprovider) interface of the ASF media source.</span></span> <span data-ttu-id="45cfc-207">Cette interface fournit l’accès aux informations sur le fichier ASF spécifiquement sur les objets d’en-tête ASF et les flux contenus dans le contenu multimédia.</span><span class="sxs-lookup"><span data-stu-id="45cfc-207">This interface provides access to information about ASF file specifically the ASF Header Objects and the streams contained within the media content.</span></span> <span data-ttu-id="45cfc-208">Les informations d’en-tête sont exposées par le biais d’attributs de descripteur de présentation et les informations de flux sont fournies via les attributs de descripteur</span><span class="sxs-lookup"><span data-stu-id="45cfc-208">Header information is exposes through presentation descriptor attributes and stream information is provided through stream descriptor attributes.</span></span> <span data-ttu-id="45cfc-209">Pour plus d’informations sur ces attributs, consultez [Media Foundation attributs pour les objets d’en-tête ASF](media-foundation-attributes-for-asf-header-objects.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-209">For more information about these attributes, see [Media Foundation Attributes for ASF Header Objects](media-foundation-attributes-for-asf-header-objects.md).</span></span> <span data-ttu-id="45cfc-210">En plus des informations qui sont exposées par le biais d’attributs, il existe également des métadonnées descriptives, qui sont définies en tant que propriétés.</span><span class="sxs-lookup"><span data-stu-id="45cfc-210">In addition to information that is exposed through attributes, there also exists descriptive metadata, which are set as properties.</span></span>                                                                                                 |
| <span data-ttu-id="45cfc-211">\_service de \_ Gestionnaire de propriétés MF \_</span><span class="sxs-lookup"><span data-stu-id="45cfc-211">MF\_PROPERTY\_HANDLER\_SERVICE</span></span>   | <span data-ttu-id="45cfc-212">À l’aide de cet identificateur, l’application peut obtenir un pointeur vers l’interface [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) de la source de média ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-212">By using this identifier, the application can get a pointer to the [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interface of the ASF media source.</span></span> <span data-ttu-id="45cfc-213">La Banque de propriétés contient toutes les métadonnées relatives au fichier ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-213">The property store contains all the metadata related to the ASF file.</span></span> <span data-ttu-id="45cfc-214">Cet identificateur est une nouveauté de Windows 7 et remplace le \_ \_ service de fournisseur de métadonnées MF \_ pour l’obtention des propriétés de métadonnées.</span><span class="sxs-lookup"><span data-stu-id="45cfc-214">This identifier is new in Windows 7 and replaces MF\_METADATA\_PROVIDER\_SERVICE for getting metadata properties.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="45cfc-215">\_service de statistiques MFNETSOURCE \_</span><span class="sxs-lookup"><span data-stu-id="45cfc-215">MFNETSOURCE\_STATISTICS\_SERVICE</span></span> | <span data-ttu-id="45cfc-216">Pour plus d’informations, consultez récupération des statistiques réseau dans la [journalisation du client](client-logging.md).</span><span class="sxs-lookup"><span data-stu-id="45cfc-216">For more information, see Retrieving Network Statistics in [Client Logging](client-logging.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="45cfc-217">\_service de code temporel MF \_</span><span class="sxs-lookup"><span data-stu-id="45cfc-217">MF\_TIMECODE\_SERVICE</span></span>            | <span data-ttu-id="45cfc-218">À l’aide de cet identificateur, l’application peut obtenir un pointeur vers l’interface [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) de la source du média.</span><span class="sxs-lookup"><span data-stu-id="45cfc-218">By using this identifier, the application can get a pointer to the media source’s [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) interface.</span></span> <span data-ttu-id="45cfc-219">Cette implémentation peut être utilisée pour effectuer des traductions de code temporel, telles que la conversion du code de temps SMPTE en unités de 100-nano seconde et inversement.</span><span class="sxs-lookup"><span data-stu-id="45cfc-219">This implementation can be used to perform time code translations such as converting SMPTE time code to 100-nano second units and back.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

### <a name="timecode-translation"></a><span data-ttu-id="45cfc-220">Traduction du code temporel</span><span class="sxs-lookup"><span data-stu-id="45cfc-220">Timecode Translation</span></span>

<span data-ttu-id="45cfc-221">La source de média ASF fournit un service de traduction de code d’heure qui permet à votre application de convertir le code de temps SMPTE en heure de présentation la plus proche (en unité de 100 nanosecondes).</span><span class="sxs-lookup"><span data-stu-id="45cfc-221">The ASF media source provides a time code translation service that allows your application to convert SMPTE time code to the closest presentation time (in 100-nanosecond unit).</span></span> <span data-ttu-id="45cfc-222">Inversement, l’application peut également obtenir le code de temps pour l’heure de présentation demandée.</span><span class="sxs-lookup"><span data-stu-id="45cfc-222">Conversely, the application can also get the time code for a requested presentation time.</span></span> <span data-ttu-id="45cfc-223">Le service est disponible via l’interface [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) , que la source de média ASF implémente.</span><span class="sxs-lookup"><span data-stu-id="45cfc-223">The service is available through the [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) interface, which the ASF media source implements.</span></span> <span data-ttu-id="45cfc-224">Les appels de méthode sur ce pointeur d’interface sont asynchrones qui peuvent s’exécuter à partir de votre thread d’application principal sans bloquer l’interface utilisateur de votre application.</span><span class="sxs-lookup"><span data-stu-id="45cfc-224">The method calls on this interface pointer are asynchronous that can run from your main application thread without blocking the user interface of your application.</span></span>

<span data-ttu-id="45cfc-225">Les étapes suivantes résument la procédure de traduction du code temporel :</span><span class="sxs-lookup"><span data-stu-id="45cfc-225">The following steps summarize the procedure for time code translation:</span></span>

1.  <span data-ttu-id="45cfc-226">Accédez à l’interface [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) de la source de média ASF en appelant [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) et en spécifiant l’identificateur de **\_ \_ service de code temporel MF** .</span><span class="sxs-lookup"><span data-stu-id="45cfc-226">Get pointer to the [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) interface of the ASF media source by calling [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) and specifying the **MF\_TIMECODE\_SERVICE** identifier.</span></span>
2.  <span data-ttu-id="45cfc-227">Appelez [**IMFTimecodeTranslate :: BeginConvertTimecodeToHNS**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-beginconverttimecodetohns) ou [**IMFTimecodeTranslate :: BeginConvertHNSToTimecode**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-beginconverthnstotimecode) et spécifiez l’heure à traduire.</span><span class="sxs-lookup"><span data-stu-id="45cfc-227">Call [**IMFTimecodeTranslate::BeginConvertTimecodeToHNS**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-beginconverttimecodetohns) or [**IMFTimecodeTranslate::BeginConvertHNSToTimecode**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-beginconverthnstotimecode) and specify the time that is to be translated..</span></span> <span data-ttu-id="45cfc-228">Pour **BeginConvertTimecodeToHNS** , le code de temps doit être spécifié en tant que variable [**PROPVARIANT**](/windows/win32/api/propidl/ns-propidl-propvariant) avec le type de données **VT \_ i8** .</span><span class="sxs-lookup"><span data-stu-id="45cfc-228">For **BeginConvertTimecodeToHNS** the time code must be specified as a [**PROPVARIANT**](/windows/win32/api/propidl/ns-propidl-propvariant) variable with **VT\_I8** data type.</span></span> <span data-ttu-id="45cfc-229">La méthode **BeginConvertHNSToTimecode** requiert le temps en unités de 100 nanosecondes comme type [**MFTIME**](mftime.md) .</span><span class="sxs-lookup"><span data-stu-id="45cfc-229">The **BeginConvertHNSToTimecode** method requires the time in 100-nanosecond units as the [**MFTIME**](mftime.md) type.</span></span>
3.  <span data-ttu-id="45cfc-230">Terminez l’opération asynchrone en appelant [**IMFTimecodeTranslate :: EndConvertTimecodeToHNS**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-endconverttimecodetohns) ou **IMFTimecodeTranslate :: EndConvertTimecodeToHNS** de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="45cfc-230">Complete the asynchronous operation by calling [**IMFTimecodeTranslate::EndConvertTimecodeToHNS**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-endconverttimecodetohns) or **IMFTimecodeTranslate::EndConvertTimecodeToHNS** appropriately.</span></span>

<span data-ttu-id="45cfc-231">Pendant la création de la source du média, le programme de résolution source crée un flux d’octets pour le fichier à partir duquel la source du média lit le contenu ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-231">During the creation of the media source, the source resolver creates a byte stream for the file from which the media source reads the ASF content.</span></span> <span data-ttu-id="45cfc-232">Pour que les conversions de temps soient réussies, le flux d’octets associé au fichier ASF doit avoir des fonctionnalités de recherche ; dans le cas contraire, l’application obtient l' \_ erreur MF E \_ BYTESTREAM \_ not \_ recherchée à partir de l’appel **Begin...** .</span><span class="sxs-lookup"><span data-stu-id="45cfc-232">In order for the time conversions to be successful, the byte stream associated with the ASF file must have seeking capabilities; otherwise, the application gets the MF\_E\_BYTESTREAM\_NOT\_SEEKABLE error from the **Begin...** call.</span></span> <span data-ttu-id="45cfc-233">Une autre exigence pour les conversions de temps est que le fichier ASF, représenté par la source de média ASF, doit avoir des objets d’index ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-233">Another requirement for time conversions is that the ASF file, represented by the ASF media source, must have ASF Index Objects.</span></span> <span data-ttu-id="45cfc-234">Les heures de présentation et les codes d’heure sont extraits des objets d’index ASF qui maintiennent tous les index et les points de recherche correspondants pour le fichier ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-234">The presentation times and the time codes are extracted from the ASF Index Objects that maintain all the indexes and the corresponding seek- points for the ASF file.</span></span> <span data-ttu-id="45cfc-235">Pour la traduction de code dans le temps, le fichier ASF doit contenir un objet index simple ; pour la traduction du code de temps en présentation, le fichier ASF doit avoir un objet index.</span><span class="sxs-lookup"><span data-stu-id="45cfc-235">For presentation time-to-time code translation, the ASF file must contain a Simple Index Object; for time code-to-presentation time translation, the ASF file must have an Index Object.</span></span> <span data-ttu-id="45cfc-236">Les opérations de conversion s’appuient sur l' *indexeur* sous-jacent (composant WMContainer) pour analyser et lire l’objet index associé au fichier ASF.</span><span class="sxs-lookup"><span data-stu-id="45cfc-236">The conversion operations rely on the underlying *indexer* (WMContainer component) to parse and read the Index Object associated with the ASF file.</span></span> <span data-ttu-id="45cfc-237">Si le fichier ne contient pas d’objet index, l’application reçoit de manière asynchrone le \_ code d’erreur MF E \_ no \_ index.</span><span class="sxs-lookup"><span data-stu-id="45cfc-237">If the file does not contain an Index Object, the application asynchronously receives the MF\_E\_NO\_INDEX error code.</span></span>

<span data-ttu-id="45cfc-238">Pour traduire le temps demandé par l’application, la source du média énumère les flux dans le fichier et recherche le flux qui contient l’objet d’index ASF approprié.</span><span class="sxs-lookup"><span data-stu-id="45cfc-238">To translate the time requested by the application, the media source enumerates the streams within the file and finds the stream that contains the appropriate ASF Index Object.</span></span> <span data-ttu-id="45cfc-239">Si un flux de ce type est trouvé, la source du média analyse les paquets ASF du flux est analysé jusqu’à ce que le code d’heure correct soit atteint.</span><span class="sxs-lookup"><span data-stu-id="45cfc-239">If such a stream is found, the media source parses the stream’s ASF packets are parsed until the correct time code is reached.</span></span> <span data-ttu-id="45cfc-240">Après avoir trouvé l’exemple correct, il récupère l’heure de présentation correspondante ou le code de temps de l’exemple, puis le retourne à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="45cfc-240">After it finds the correct sample it retrieves the corresponding presentation time or the time code from the sample, and returns it to the caller.</span></span>

### <a name="script-command-support"></a><span data-ttu-id="45cfc-241">Prise en charge des commandes de script</span><span class="sxs-lookup"><span data-stu-id="45cfc-241">Script Command Support</span></span>

<span data-ttu-id="45cfc-242">Lorsque vous générez une topologie ASF qui contient un flux de script, un nœud de flux de script est ajouté à la topologie.</span><span class="sxs-lookup"><span data-stu-id="45cfc-242">When you build an ASF topology that contains a script stream a Script Stream node is added to the topology.</span></span> <span data-ttu-id="45cfc-243">Ce nœud enverra IMFSamples à l’heure appropriée.</span><span class="sxs-lookup"><span data-stu-id="45cfc-243">This node will send IMFSamples at the appropriate time.</span></span> <span data-ttu-id="45cfc-244">Le IMFSample fourni par le nœud source du script stocke les données dans le IMFMediaBuffer associé à l’exemple.</span><span class="sxs-lookup"><span data-stu-id="45cfc-244">The IMFSample provided by the script source node stores the data in the IMFMediaBuffer associated with the sample.</span></span> <span data-ttu-id="45cfc-245">Vous pouvez appeler CopyToBuffer sur l’exemple pour récupérer un IMFMediaBuffer, puis appeler Lock sur la mémoire tampon pour récupérer les données.</span><span class="sxs-lookup"><span data-stu-id="45cfc-245">You can call CopyToBuffer on the sample to get an IMFMediaBuffer and then call Lock on the buffer to get the data.</span></span> 

<span data-ttu-id="45cfc-246">Les charges utiles de flux de script sont empaquetées dans la mémoire tampon sous la forme d’une chaîne de type, suivie de NULL, puis de la chaîne de commande, puis de la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="45cfc-246">Script stream payloads are packed into the buffer as a type string, followed by NULL, followed by the command string, followed by NULL.</span></span> <span data-ttu-id="45cfc-247">Les chaînes sont au format ASF Unicode.</span><span class="sxs-lookup"><span data-stu-id="45cfc-247">Strings are Unicode in the ASF format.</span></span>

<span data-ttu-id="45cfc-248">Par exemple, une charge utile peut se présenter comme suit (où \ 0 indique un caractère NULL) :</span><span class="sxs-lookup"><span data-stu-id="45cfc-248">For example, a payload might look like the following (where \0 indicates a NULL character):</span></span>

<span data-ttu-id="45cfc-249">*URL\0http://contoso.com\0*</span><span class="sxs-lookup"><span data-stu-id="45cfc-249">*URL\0http://contoso.com\0*</span></span>

<span data-ttu-id="45cfc-250">*Text\0This est un caption\0*</span><span class="sxs-lookup"><span data-stu-id="45cfc-250">*Text\0This is a caption\0*</span></span>



## <a name="related-topics"></a><span data-ttu-id="45cfc-251">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="45cfc-251">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="45cfc-252">Composants ASF de couche de pipeline</span><span class="sxs-lookup"><span data-stu-id="45cfc-252">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="45cfc-253">Prise en charge ASF dans Media Foundation</span><span class="sxs-lookup"><span data-stu-id="45cfc-253">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 
