---
description: Champ des restrictions d’utilisation
ms.assetid: 36f28e4c-2baf-4618-9935-5d4615f6bc77
title: Champ des restrictions d’utilisation
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b16f57de7642fa789a08c886a32bf906faffb72b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104317965"
---
# <a name="field-of-use-restrictions"></a><span data-ttu-id="b4810-103">Champ des restrictions d’utilisation</span><span class="sxs-lookup"><span data-stu-id="b4810-103">Field of Use Restrictions</span></span>

> [!Note]  
> <span data-ttu-id="b4810-104">Cette rubrique s’applique à Windows 7 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="b4810-104">This topic applies to Windows 7 or later.</span></span>

 

<span data-ttu-id="b4810-105">Une restriction de *champ d’utilisation* est une provision qui limite la manière dont une licence pour une technologie particulière peut être utilisée.</span><span class="sxs-lookup"><span data-stu-id="b4810-105">A *field-of-use* restriction is a provision that limits how a license for a particular technology can be used.</span></span>

<span data-ttu-id="b4810-106">Media Foundation fournit un mécanisme permettant d’appliquer des restrictions de champ d’utilisation sur les transformations de Media Foundation (MFTs), en particulier les codecs.</span><span class="sxs-lookup"><span data-stu-id="b4810-106">Media Foundation provides a mechanism for enforcing field-of-use restrictions on Media Foundation transforms (MFTs), particularly codecs.</span></span> <span data-ttu-id="b4810-107">Ce mécanisme requiert que la table MFT bloque sa propre utilisation par les applications jusqu’à ce que l’application ait effectué une négociation avec la table MFT.</span><span class="sxs-lookup"><span data-stu-id="b4810-107">This mechanism requires the MFT to block its own use by applications until the application has performed a handshake with the MFT.</span></span> <span data-ttu-id="b4810-108">Media Foundation ne définit pas le protocole de transfert, en général, il implique un certain type d’échange de chiffrement.</span><span class="sxs-lookup"><span data-stu-id="b4810-108">Media Foundation does not define the handshake—typically, it would involve some sort of cryptographic exchange.</span></span>

### <a name="registration-and-enumeration"></a><span data-ttu-id="b4810-109">Inscription et énumération</span><span class="sxs-lookup"><span data-stu-id="b4810-109">Registration and Enumeration</span></span>

<span data-ttu-id="b4810-110">Si une table MFT a des restrictions de champ d’utilisation, définissez l’indicateur FIELDOFUSE de l' **\_ \_ indicateur \_ d’énumération MFT** lors de l’inscription de la table MFT.</span><span class="sxs-lookup"><span data-stu-id="b4810-110">If an MFT has field-of-use restrictions, set the **MFT\_ENUM\_FLAG\_FIELDOFUSE** flag when you register the MFT.</span></span> <span data-ttu-id="b4810-111">Cet indicateur s’applique aux API d’inscription MFT suivantes :</span><span class="sxs-lookup"><span data-stu-id="b4810-111">This flag applies to the following MFT registration APIs:</span></span>

-   [<span data-ttu-id="b4810-112">**MFTRegister**</span><span class="sxs-lookup"><span data-stu-id="b4810-112">**MFTRegister**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mftregister)
-   [<span data-ttu-id="b4810-113">**MFTRegisterLocal**</span><span class="sxs-lookup"><span data-stu-id="b4810-113">**MFTRegisterLocal**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mftregisterlocal)
-   [<span data-ttu-id="b4810-114">**MFTRegisterLocalByCLSID**</span><span class="sxs-lookup"><span data-stu-id="b4810-114">**MFTRegisterLocalByCLSID**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mftregisterlocalbyclsid)
-   [<span data-ttu-id="b4810-115">**IMFLocalMFTRegistration::RegisterMFTs**</span><span class="sxs-lookup"><span data-stu-id="b4810-115">**IMFLocalMFTRegistration::RegisterMFTs**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imflocalmftregistration-registermfts)

<span data-ttu-id="b4810-116">Par défaut, les MFTs inscrits avec cet indicateur sont exclus des résultats de l’énumération.</span><span class="sxs-lookup"><span data-stu-id="b4810-116">By default, MFTs registered with this flag are excluded from enumeration results.</span></span> <span data-ttu-id="b4810-117">Pour énumérer les MFTs avec des restrictions de champ d’utilisation, appelez [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) et spécifiez l’indicateur de FIELDOFUSE d' **\_ \_ indicateur \_ d’énumération MFT** dans le paramètre *Flags* .</span><span class="sxs-lookup"><span data-stu-id="b4810-117">To enumerate MFTs with field-of-use restrictions, call [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) and specify the **MFT\_ENUM\_FLAG\_FIELDOFUSE** flag in the *Flags* parameter.</span></span> <span data-ttu-id="b4810-118">Le diagramme suivant illustre ce processus.</span><span class="sxs-lookup"><span data-stu-id="b4810-118">The following diagram illustrates this process.</span></span>

![Diagramme montrant MFT et une application envoyant des données au registre](images/mft-fou01.gif)

<span data-ttu-id="b4810-120">La fonction [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) exclut toujours les MFTS qui ont des restrictions de champ d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="b4810-120">The [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) function always excludes any MFTs that have field-of-use restrictions.</span></span>

### <a name="unlocking-the-mft"></a><span data-ttu-id="b4810-121">Déverrouillage de la MFT</span><span class="sxs-lookup"><span data-stu-id="b4810-121">Unlocking the MFT</span></span>

<span data-ttu-id="b4810-122">Pour utiliser une table MFT avec des restrictions de champ d’utilisation, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="b4810-122">To use an MFT with field-of-use restrictions, perform the following steps:</span></span>

1.  <span data-ttu-id="b4810-123">L’application implémente l’interface [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) .</span><span class="sxs-lookup"><span data-stu-id="b4810-123">The application implements the [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) interface.</span></span>
2.  <span data-ttu-id="b4810-124">La méthode [**IMFFieldOfUseMFTUnlock :: Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) prend un pointeur vers l’interface **IUnknown** de la table MFT.</span><span class="sxs-lookup"><span data-stu-id="b4810-124">The [**IMFFieldOfUseMFTUnlock::Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) method takes a pointer to the **IUnknown** interface of the MFT.</span></span>
3.  <span data-ttu-id="b4810-125">Dans la méthode [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) , l’application exécute le protocole de transfert requis, en utilisant le mécanisme défini par la table MFT.</span><span class="sxs-lookup"><span data-stu-id="b4810-125">In the [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) method, the application performs the required handshake, using whatever mechanism is defined by the MFT.</span></span> <span data-ttu-id="b4810-126">Cette étape n’est pas définie par l’API Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="b4810-126">This step is not defined by Media Foundation API.</span></span>
4.  <span data-ttu-id="b4810-127">Si la méthode [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) est établie, la table MFT se déverrouille.</span><span class="sxs-lookup"><span data-stu-id="b4810-127">If the [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) method succeeds, the MFT unlocks itself.</span></span>

<span data-ttu-id="b4810-128">L’application spécifie le pointeur [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) en définissant l’attribut de [ \_ \_ déverrouillage de l' \_ attribut MFT FIELDOFUSE](mft-fieldofuse-unlock-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="b4810-128">The application specifies the [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) pointer by setting the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) attribute.</span></span> <span data-ttu-id="b4810-129">Il existe différentes façons de définir cet attribut, selon la façon dont votre application crée le décodeur ou le pipeline d’encodage :</span><span class="sxs-lookup"><span data-stu-id="b4810-129">There are several different ways to set this attribute, depending on how your application creates the decoder or encoding pipeline:</span></span>



| <span data-ttu-id="b4810-130">API</span><span class="sxs-lookup"><span data-stu-id="b4810-130">API</span></span>                   | <span data-ttu-id="b4810-131">Comment déverrouiller un champ d’utilisation</span><span class="sxs-lookup"><span data-stu-id="b4810-131">How to Unlock Field-Of-Use</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b4810-132">Lecteur source</span><span class="sxs-lookup"><span data-stu-id="b4810-132">Source Reader</span></span>         | <span data-ttu-id="b4810-133">Si votre application utilise le [lecteur source](source-reader.md) pour décoder un fichier multimédia, définissez l’attribut [MFT \_ FIELDOFUSE \_ Unlock \_ attribute](mft-fieldofuse-unlock-attribute.md) dans les paramètres de configuration.</span><span class="sxs-lookup"><span data-stu-id="b4810-133">If your application uses the [Source Reader](source-reader.md) to decode a media file, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) attribute in the configuration parameters.</span></span> <span data-ttu-id="b4810-134">Consultez [attributs du lecteur source](source-reader-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="b4810-134">See [Source Reader Attributes](source-reader-attributes.md).</span></span>                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="b4810-135">Enregistreur du récepteur</span><span class="sxs-lookup"><span data-stu-id="b4810-135">Sink Writer</span></span>           | <span data-ttu-id="b4810-136">Si votre application utilise le writer de récepteur pour encoder un fichier multimédia, définissez l’attribut [MFT \_ FIELDOFUSE \_ Unlock \_ attribute](mft-fieldofuse-unlock-attribute.md) dans les paramètres de configuration.</span><span class="sxs-lookup"><span data-stu-id="b4810-136">If your application uses the sink writer to encode a media file, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) attribute in the configuration parameters.</span></span> <span data-ttu-id="b4810-137">Consultez [attributs du writer du récepteur](sink-writer-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="b4810-137">See [Sink Writer Attributes](sink-writer-attributes.md).</span></span>                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="b4810-138">Transcodage rapide</span><span class="sxs-lookup"><span data-stu-id="b4810-138">Fast Transcode</span></span>        | <span data-ttu-id="b4810-139">Si votre application utilise la fonctionnalité de transcodage rapide pour créer une topologie d’encodage, définissez l' [ \_ \_ \_ attribut MFT FIELDOFUSE Unlock](mft-fieldofuse-unlock-attribute.md) lorsque vous appelez [**IMFTranscodeProfile :: SetContainerAttributes**](/windows/desktop/api/mfidl/nf-mfidl-imftranscodeprofile-setcontainerattributes).</span><span class="sxs-lookup"><span data-stu-id="b4810-139">If your application uses the Fast Transcode feature to create an encoding topology, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) when you call [**IMFTranscodeProfile::SetContainerAttributes**](/windows/desktop/api/mfidl/nf-mfidl-imftranscodeprofile-setcontainerattributes).</span></span> <span data-ttu-id="b4810-140">Pour plus d’informations sur la fonctionnalité de transcodage rapide, consultez [API de transcodage](transcode-api.md).</span><span class="sxs-lookup"><span data-stu-id="b4810-140">For more information about the Fast Transcode feature, see [Transcode API](transcode-api.md).</span></span>                                                                                                                                                                      |
| <span data-ttu-id="b4810-141">Topologie</span><span class="sxs-lookup"><span data-stu-id="b4810-141">Topology</span></span>              | <span data-ttu-id="b4810-142">Si vous créez une topologie directement, définissez l' [attribut MFT \_ FIELDOFUSE \_ Unlock \_ ](mft-fieldofuse-unlock-attribute.md) en tant qu’attribut sur la topologie.</span><span class="sxs-lookup"><span data-stu-id="b4810-142">If you create a topology directly, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) as an attribute on the topology.</span></span> <span data-ttu-id="b4810-143">Consultez [attributs de topologie](topology-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="b4810-143">See [Topology Attributes](topology-attributes.md).</span></span>                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="b4810-144">Objet d’activation MFT</span><span class="sxs-lookup"><span data-stu-id="b4810-144">MFT Activation Object</span></span> | <span data-ttu-id="b4810-145">Si votre application énumère directement les décodeurs ou les encodeurs qu’elle utilisera, définissez l' [ \_ \_ \_ attribut MFT FIELDOFUSE Unlock](mft-fieldofuse-unlock-attribute.md) sur les pointeurs [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) retournés par la fonction [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) .</span><span class="sxs-lookup"><span data-stu-id="b4810-145">If your application directly enumerates the decoders or encoders that it will use, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) on the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pointers returned by the [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) function.</span></span> <br/> <span data-ttu-id="b4810-146">Définissez l’attribut avant d’appeler [**IMFActivate :: ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) pour créer la table MFT.</span><span class="sxs-lookup"><span data-stu-id="b4810-146">Set the attribute before calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) to create the MFT.</span></span> <span data-ttu-id="b4810-147">L’objet d’activation appelle [**IMFFieldOfUseMFTUnlock :: Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) lorsqu’il crée la table MFT.</span><span class="sxs-lookup"><span data-stu-id="b4810-147">The activation object calls [**IMFFieldOfUseMFTUnlock::Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) when it creates the MFT.</span></span><br/> |



 

<span data-ttu-id="b4810-148">Le diagramme suivant montre la relation entre les objets d’activation MFT et l’interface [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) .</span><span class="sxs-lookup"><span data-stu-id="b4810-148">The following diagram shows the relation between MFT activation objects and the [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) interface.</span></span>

![Diagramme montrant une application, un objet d’activation et une table MFT avec des flèches vers un objet SHA, qui a une flèche de retour à la table MFT](images/mft-fou02.gif)

## <a name="related-topics"></a><span data-ttu-id="b4810-150">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="b4810-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b4810-151">Transformations de Media Foundation</span><span class="sxs-lookup"><span data-stu-id="b4810-151">Media Foundation Transforms</span></span>](media-foundation-transforms.md)
</dt> </dl>

 

 




