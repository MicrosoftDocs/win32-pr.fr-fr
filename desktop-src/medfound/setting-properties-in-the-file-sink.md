---
description: Le récepteur de fichiers ASF est une implémentation de IMFMediaSink fournie par Media Foundation qu’une application peut utiliser pour archiver des données de média ASF dans un fichier. Pour plus d’informations sur le modèle objet des récepteurs de média ASF et l’utilisation générale, consultez récepteurs de média ASF.
ms.assetid: a47caabd-23e3-4d22-b4b6-5fdb79d62ca1
title: Définition des propriétés dans le récepteur de fichiers
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30af39cf13e88f6edf2a6ab68caac27c2400955a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104318737"
---
# <a name="setting-properties-in-the-file-sink"></a><span data-ttu-id="68ce9-104">Définition des propriétés dans le récepteur de fichiers</span><span class="sxs-lookup"><span data-stu-id="68ce9-104">Setting Properties in the File Sink</span></span>

<span data-ttu-id="68ce9-105">Le récepteur de fichiers ASF est une implémentation de [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) fournie par Media Foundation qu’une application peut utiliser pour archiver des données de média ASF dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="68ce9-105">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="68ce9-106">Pour plus d’informations sur le modèle objet et l’utilisation générale des récepteurs de média ASF, consultez [récepteurs de média ASF](asf-media-sinks.md).</span><span class="sxs-lookup"><span data-stu-id="68ce9-106">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="68ce9-107">Une fois [le récepteur de fichiers ASF créé](creating-the-asf-file-sink.md), il doit être configuré avec des informations sur les flux dans le fichier de sortie.</span><span class="sxs-lookup"><span data-stu-id="68ce9-107">After [Creating the ASF file sink](creating-the-asf-file-sink.md), it must be configured with information about the streams in the output file.</span></span> <span data-ttu-id="68ce9-108">Cette procédure est décrite dans [Ajout d’informations de flux au récepteur de fichiers ASF](adding-stream-information-to-the-asf-file-sink.md).</span><span class="sxs-lookup"><span data-stu-id="68ce9-108">This procedure is described in [Adding Stream Information to the ASF File Sink](adding-stream-information-to-the-asf-file-sink.md).</span></span> <span data-ttu-id="68ce9-109">Vous pouvez définir des propriétés supplémentaires sur le récepteur de fichiers en fonction du type d’encodage. compartiments avec fuites ; Propriétés générales du fichier.</span><span class="sxs-lookup"><span data-stu-id="68ce9-109">You can set additional properties on the file sink depending on the type of encoding; leaky buckets; general file properties.</span></span> <span data-ttu-id="68ce9-110">Ces paramètres ne sont pas écrits dans l’objet d’en-tête ASF final.</span><span class="sxs-lookup"><span data-stu-id="68ce9-110">These settings are not written in the final ASF Header Object.</span></span> <span data-ttu-id="68ce9-111">Cette rubrique décrit le processus d’ajout de ces propriétés dans la Banque de propriétés du récepteur de fichiers.</span><span class="sxs-lookup"><span data-stu-id="68ce9-111">This topic describes process of adding these properties in the file sink's property store.</span></span>

<span data-ttu-id="68ce9-112">L’objet ContentInfo gère les propriétés de fichier globales et les propriétés de flux individuelles pour le récepteur de fichiers.</span><span class="sxs-lookup"><span data-stu-id="68ce9-112">The ContentInfo object maintains the global file properties and individual stream properties for the file sink.</span></span> <span data-ttu-id="68ce9-113">Pour plus d’informations sur l’obtention d’une référence à l’objet ASF ContentInfo du récepteur de fichiers, consultez [création du récepteur de fichiers ASF](creating-the-asf-file-sink.md).</span><span class="sxs-lookup"><span data-stu-id="68ce9-113">For information about getting a reference to the file sink's ASF ContentInfo object, see [Creating the ASF File Sink](creating-the-asf-file-sink.md).</span></span>

<span data-ttu-id="68ce9-114">Pour obtenir une référence à la Banque de propriétés du récepteur de fichiers ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)), appelez [**IMFASFContentInfo :: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) sur la référence de l’objet ContentInfo du récepteur de fichiers.</span><span class="sxs-lookup"><span data-stu-id="68ce9-114">To get a reference to the file sink's property store ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)), call [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) on the file sink's ContentInfo object's reference.</span></span>

## <a name="stream-encoding-properties"></a><span data-ttu-id="68ce9-115">Propriétés d’encodage de flux</span><span class="sxs-lookup"><span data-stu-id="68ce9-115">Stream Encoding Properties</span></span>

<span data-ttu-id="68ce9-116">Pour encoder le contenu correctement, le fichier doit connaître certaines informations de codage, telles que le type d’encodage et les paramètres d’encodage associés.</span><span class="sxs-lookup"><span data-stu-id="68ce9-116">To encode content properly the file needs to know certain encoding information such as type of encoding and the related encoding parameters.</span></span> <span data-ttu-id="68ce9-117">Ces valeurs sont définies sur le récepteur de fichiers en tant que valeurs de propriété dans une banque de propriétés gérée par l’objet ASF ContentInfo.</span><span class="sxs-lookup"><span data-stu-id="68ce9-117">These values are set on the file sink as property values in a property store that is maintained by the ASF ContentInfo object.</span></span> <span data-ttu-id="68ce9-118">Si vous configurez le récepteur de fichiers avant d’instancier les encodeurs appropriés, vous pouvez utiliser l’objet ContentInfo avec toutes les propriétés remplies pour créer les encodeurs Windows Media.</span><span class="sxs-lookup"><span data-stu-id="68ce9-118">If you are configuring the file sink before instantiating the relevant encoders, you can use the ContentInfo object with all the populated properties to create the Windows Media encoders.</span></span> <span data-ttu-id="68ce9-119">Dans ce cas, les propriétés sont définies automatiquement sur les encodeurs instanciés.</span><span class="sxs-lookup"><span data-stu-id="68ce9-119">In this case, the properties are automatically set on the instantiated encoders.</span></span> <span data-ttu-id="68ce9-120">À l’inverse, si vous créez les encodeurs avant le récepteur, assurez-vous que les propriétés que vous définissez sur les encodeurs sont copiées dans la Banque de propriétés du récepteur de fichiers.</span><span class="sxs-lookup"><span data-stu-id="68ce9-120">Conversely, if you are creating the encoders before the sink, make sure that the properties that you set on the encoders are copied into the file sink's property store.</span></span>

<span data-ttu-id="68ce9-121">Pour définir les propriétés d’encodage, vous devez avoir accès à la Banque de propriétés au niveau du flux du récepteur de fichiers.</span><span class="sxs-lookup"><span data-stu-id="68ce9-121">To set encoding properties, you need access to the file sink's stream-level property store.</span></span> <span data-ttu-id="68ce9-122">Transmettez le numéro du flux dans le paramètre *wStreamNumber* de la méthode [**IMFASFContentInfo :: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) .</span><span class="sxs-lookup"><span data-stu-id="68ce9-122">Pass the stream number in the *wStreamNumber* parameter of the [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) method.</span></span> <span data-ttu-id="68ce9-123">Les numéros de flux doivent correspondre aux valeurs définies lors de la configuration de chaque flux dans le profil.</span><span class="sxs-lookup"><span data-stu-id="68ce9-123">The stream numbers must match the values set while configuring each stream in the profile.</span></span> <span data-ttu-id="68ce9-124">Les valeurs de propriété sont définies en appelant [**IPropertyStore :: SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="68ce9-124">Property values are set by calling [**IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span> <span data-ttu-id="68ce9-125">Le tableau suivant décrit les propriétés prises en charge.</span><span class="sxs-lookup"><span data-stu-id="68ce9-125">The following table describes the supported properties.</span></span>

<span data-ttu-id="68ce9-126">Les propriétés dépendent du type d’encodage.</span><span class="sxs-lookup"><span data-stu-id="68ce9-126">The properties depend on the type of encoding.</span></span> <span data-ttu-id="68ce9-127">Pour plus d’informations sur les propriétés et les valeurs respectives que vous devez définir, consultez [propriétés d’encodage](configuring-the-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="68ce9-127">For information about the properties and the respective values that you must set, see [Encoding Properties](configuring-the-encoder.md).</span></span>

## <a name="leaky-bucket-property"></a><span data-ttu-id="68ce9-128">Propriété de compartiment avec fuite</span><span class="sxs-lookup"><span data-stu-id="68ce9-128">Leaky Bucket Property</span></span>

<span data-ttu-id="68ce9-129">Les paramètres de compartiment avec fuite déterminent la fenêtre de mémoire tampon réelle utilisée par l’encodeur pour le flux.</span><span class="sxs-lookup"><span data-stu-id="68ce9-129">Leaky bucket parameters determine the actual buffer window used by the encoder for the stream.</span></span> <span data-ttu-id="68ce9-130">La propriété [**\_ LEAKYBUCKET MFPKEY ASFSTREAMSINK \_ corrigée \_**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) du récepteur de fichiers contient les paramètres de compartiment avec fuite, la vitesse de transmission, la fenêtre de mémoire tampon et la saturation de la mémoire tampon initiale. Cette propriété est définie dans la Banque de propriétés de propriété au niveau du flux du récepteur de fichiers et doit être définie après la création et la configuration des encodeurs.</span><span class="sxs-lookup"><span data-stu-id="68ce9-130">The file sink's [**MFPKEY\_ASFSTREAMSINK\_CORRECTED\_LEAKYBUCKET**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) property contains the leaky bucket parameters, bit rate, buffer window, and initial buffer fullness.This property is set in the stream-level property property store for the file sink and must be set after encoders have been created and configured.</span></span> <span data-ttu-id="68ce9-131">Cette valeur est définie dans le.</span><span class="sxs-lookup"><span data-stu-id="68ce9-131">This value is set in the .</span></span> <span data-ttu-id="68ce9-132">Pendant la négociation de type de média, l’encodeur décide la fenêtre de mémoire tampon et la vitesse de transmission à utiliser.</span><span class="sxs-lookup"><span data-stu-id="68ce9-132">During the media type negotiation, the encoder decides the buffer window and the bit rate to use.</span></span> <span data-ttu-id="68ce9-133">Vous pouvez récupérer ces valeurs à l’aide de l’interface **IWMCodecLeakyBucket** , qui est définie dans wmcodecifaces. h et vous devez créer un lien vers wmcodecdspuuid. lib pour appeler ses méthodes.</span><span class="sxs-lookup"><span data-stu-id="68ce9-133">You can get these values by using the **IWMCodecLeakyBucket** interface, which is defined in wmcodecifaces.h and you must link to wmcodecdspuuid.lib to call its methods.</span></span>

<span data-ttu-id="68ce9-134">Les valeurs récupérées peuvent être définies pour cette propriété pour chaque flux du récepteur de fichiers ASF.</span><span class="sxs-lookup"><span data-stu-id="68ce9-134">The retrieved values can be set for this property for each stream in the ASF file sink.</span></span>

## <a name="global-file-sink-properties"></a><span data-ttu-id="68ce9-135">Propriétés globales du récepteur de fichiers</span><span class="sxs-lookup"><span data-stu-id="68ce9-135">Global File Sink Properties</span></span>

<span data-ttu-id="68ce9-136">Pour récupérer la Banque de propriétés globale du récepteur de fichiers, transmettez 0 dans le paramètre *wStreamNumber* de la méthode [**IMFASFContentInfo :: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) .</span><span class="sxs-lookup"><span data-stu-id="68ce9-136">To get the file sink's global property store, pass 0 in the *wStreamNumber* parameter of the [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) method.</span></span> <span data-ttu-id="68ce9-137">Les valeurs de propriété sont définies en appelant [**IPropertyStore :: SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="68ce9-137">Property values are set by calling [**IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span> <span data-ttu-id="68ce9-138">Le tableau suivant décrit les propriétés prises en charge.</span><span class="sxs-lookup"><span data-stu-id="68ce9-138">The following table describes the supported properties.</span></span>

| <span data-ttu-id="68ce9-139">Propriétés au niveau du fichier</span><span class="sxs-lookup"><span data-stu-id="68ce9-139">File-level Properties</span></span>                                                                                | <span data-ttu-id="68ce9-140">Description</span><span class="sxs-lookup"><span data-stu-id="68ce9-140">Description</span></span>                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="68ce9-141">**MFPKEY \_ ASFMEDIASINK \_ base \_ SENDTIME**</span><span class="sxs-lookup"><span data-stu-id="68ce9-141">**MFPKEY\_ASFMEDIASINK\_BASE\_SENDTIME**</span></span>](mfpkey-asfmediasink-base-sendtime-property.md)           | <span data-ttu-id="68ce9-142">L’heure d’envoi indique quand la charge utile dans le compartiment avec fuite est libérée.</span><span class="sxs-lookup"><span data-stu-id="68ce9-142">The send time indicates when the payload inside the leaky bucket will be released.</span></span> <span data-ttu-id="68ce9-143">Cette valeur de propriété indique la première heure d’envoi.</span><span class="sxs-lookup"><span data-stu-id="68ce9-143">This property value indicates the first send time.</span></span> <span data-ttu-id="68ce9-144">Le multiplexeur utilise cette valeur pour calculer les temps d’envoi suivants pour les paquets générés et s’assure que les flux de données transitent régulièrement via le compartiment avec fuite.</span><span class="sxs-lookup"><span data-stu-id="68ce9-144">The multiplexer uses this value to calculate the subsequent send times for the generated packets and ensures that data flows steadily through the leaky bucket.</span></span> |
| [<span data-ttu-id="68ce9-145">**MFPKEY \_ ASFMEDIASINK \_ ajuster la \_ vitesse de transmission**</span><span class="sxs-lookup"><span data-stu-id="68ce9-145">**MFPKEY\_ASFMEDIASINK\_AUTOADJUST\_BITRATE**</span></span>](mfpkey-asfmediasink-autoadjust-bitrate-property.md) | <span data-ttu-id="68ce9-146">Cette valeur BOOL indique si le multiplexeur doit ajuster la vitesse de transmission automatiquement pour s’assurer que les données ne dépassent pas le compartiment avec fuite.</span><span class="sxs-lookup"><span data-stu-id="68ce9-146">This BOOL value indicates whether the multiplexer needs to adjust the bit rate automatically to ensure that data does not overflow the leaky bucket.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="68ce9-147">**MFPKEY \_ ASFMEDIASINK \_ DRMACTION**</span><span class="sxs-lookup"><span data-stu-id="68ce9-147">**MFPKEY\_ASFMEDIASINK\_DRMACTION**</span></span>](mfpkey-asfmediasink-drmaction-property.md)                    | <span data-ttu-id="68ce9-148">Cela indique l’action DRM de récepteur multimédia ASF pour la génération de fichier.</span><span class="sxs-lookup"><span data-stu-id="68ce9-148">This indicates the ASF media sink DRM action for file generation.</span></span> <span data-ttu-id="68ce9-149">Dans cette version, seul le transcodage DRM est pris en charge.</span><span class="sxs-lookup"><span data-stu-id="68ce9-149">In this release, only DRM transcode is supported.</span></span>                                                                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="68ce9-150">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="68ce9-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="68ce9-151">Récepteurs de média ASF</span><span class="sxs-lookup"><span data-stu-id="68ce9-151">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="68ce9-152">Composants ASF de couche de pipeline</span><span class="sxs-lookup"><span data-stu-id="68ce9-152">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="68ce9-153">Prise en charge ASF dans Media Foundation</span><span class="sxs-lookup"><span data-stu-id="68ce9-153">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 
