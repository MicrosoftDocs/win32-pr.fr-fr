---
description: Pour convertir des fichiers multimédias au format ASF, vous pouvez utiliser les encodeurs Windows Media. Pour utiliser ces encodeurs, ceux-ci doivent être inscrits auprès du système.
ms.assetid: 18c26619-6047-4f7f-bb65-ca418f02e5b1
title: Utilisation d’objets d’activation d’encodeurs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bfd44a1b97ad0f133b7215ff4474835ddfba66bb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103863934"
---
# <a name="using-an-encoders-activation-objects"></a><span data-ttu-id="f2775-104">Utilisation des objets d’activation d’un encodeur</span><span class="sxs-lookup"><span data-stu-id="f2775-104">Using an Encoder's Activation Objects</span></span>

<span data-ttu-id="f2775-105">Pour convertir des fichiers multimédias au format ASF, vous pouvez utiliser les encodeurs Windows Media.</span><span class="sxs-lookup"><span data-stu-id="f2775-105">For converting media files into ASF format, you can use Windows Media encoders.</span></span> <span data-ttu-id="f2775-106">Pour utiliser ces encodeurs, ceux-ci doivent être inscrits auprès du système.</span><span class="sxs-lookup"><span data-stu-id="f2775-106">To use these encoders, they must be registered with the system.</span></span>

<span data-ttu-id="f2775-107">Pour plus d’informations sur l’inscription de l’encodeur, consultez [instanciation d’un encodeur MFT](instantiating-the-encoder-mft.md).</span><span class="sxs-lookup"><span data-stu-id="f2775-107">For information about encoder registration, see [Instantiating an Encoder MFT](instantiating-the-encoder-mft.md).</span></span>

-   [<span data-ttu-id="f2775-108">Utilisation des objets d’activation d’un encodeur</span><span class="sxs-lookup"><span data-stu-id="f2775-108">Using an Encoder's Activation Objects</span></span>](#using-an-encoders-activation-objects)
-   [<span data-ttu-id="f2775-109">Énumération d’encodeurs dans Windows 7 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="f2775-109">Encoder Enumeration in Windows 7 and Later</span></span>](#encoder-enumeration-in-windows-7-and-later)
-   [<span data-ttu-id="f2775-110">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f2775-110">Related topics</span></span>](#related-topics)

## <a name="using-an-encoders-activation-objects"></a><span data-ttu-id="f2775-111">Utilisation des objets d’activation d’un encodeur</span><span class="sxs-lookup"><span data-stu-id="f2775-111">Using an Encoder's Activation Objects</span></span>

<span data-ttu-id="f2775-112">En guise d’alternative à l’utilisation de l’interface [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) d’un encodeur (décrite dans [création d’un encodeur à l’aide de CoCreateInstance](using-an-encoder-s-imftransform--interface.md)), vous pouvez créer une instance de l’objet d’activation pour l’encodeur.</span><span class="sxs-lookup"><span data-stu-id="f2775-112">As an alternative to using an encoder's [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) interface (described in [Creating an Encoder by Using CoCreateInstance](using-an-encoder-s-imftransform--interface.md)), you can create an instance of the activation object for the encoder.</span></span> <span data-ttu-id="f2775-113">Les objets d’activation facilitent la création de l’encodeur et Media Foundation fournissent les deux fonctions suivantes pour cette approche :</span><span class="sxs-lookup"><span data-stu-id="f2775-113">Activation objects facilitates encoder creation and Media Foundation provides the following two functions for this approach:</span></span>

-   <span data-ttu-id="f2775-114">[**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) pour l’instanciation de l’encodeur audio Windows Media.</span><span class="sxs-lookup"><span data-stu-id="f2775-114">[**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) for instantiating the Windows Media audio encoder.</span></span>
-   <span data-ttu-id="f2775-115">[**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) pour l’instanciation de l’encodeur vidéo Windows Media.</span><span class="sxs-lookup"><span data-stu-id="f2775-115">[**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) for instantiating the Windows Media video encoder.</span></span>

<span data-ttu-id="f2775-116">Ces deux fonctions nécessitent la création du type de média cible et la définition des propriétés d’encodage avant l’appel de ces fonctions.</span><span class="sxs-lookup"><span data-stu-id="f2775-116">Both these functions require that you create the target media type and set the encoding properties before calling these functions.</span></span> <span data-ttu-id="f2775-117">Si votre application utilise des [composants ASF de couche de pipeline](pipeline-layer-asf-components.md) pour encoder un fichier au format ASF et que vous avez déjà créé et configuré les [récepteurs de média ASF](asf-media-sinks.md), vous pouvez obtenir cet ensemble d’informations à partir du récepteur multimédia ASF.</span><span class="sxs-lookup"><span data-stu-id="f2775-117">If your application is using [Pipeline Layer ASF Components](pipeline-layer-asf-components.md) to encode a file to ASF format, and have already created and configured the [ASF Media Sinks](asf-media-sinks.md), you can get this set of information from the ASF media sink.</span></span>

<span data-ttu-id="f2775-118">[**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) et [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) définissent le type de sortie de l’encodeur sur le type de média spécifié par l’application.</span><span class="sxs-lookup"><span data-stu-id="f2775-118">[**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) and [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) set the output type of the encoder to the media type specified by the application.</span></span>

<span data-ttu-id="f2775-119">**Remarque**  Si vous utilisez [**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) et [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) , vous pouvez activer l’encodeur en appelant [**IMFActivate :: ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) , mais vous ne pouvez pas modifier les types de média d’entrée et de sortie de l’encodeur, ni modifier les propriétés d’encodage.</span><span class="sxs-lookup"><span data-stu-id="f2775-119">**Note**  If you are using [**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) and [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) you can activate the encoder by calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) but you cannot change the input and the output media types of the encoder nor can you change any of the encoding properties.</span></span>

<span data-ttu-id="f2775-120">Pour plus d’informations sur la création d’objets Media Foundation à l’aide d’objets d’activation, consultez [objets d’activation](activation-objects.md).</span><span class="sxs-lookup"><span data-stu-id="f2775-120">For more information about creating Media Foundation objects by using activation objects, see [Activation Objects](activation-objects.md).</span></span>

<span data-ttu-id="f2775-121">**Pour récupérer le type de média cible à partir du récepteur multimédia ASF**</span><span class="sxs-lookup"><span data-stu-id="f2775-121">**To get the target media type from the ASF media sink**</span></span>

1.  <span data-ttu-id="f2775-122">Obtenir un pointeur vers le pointeur [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) du récepteur de média ASF en appelant **IMFMediaSink :: QueryInterface** sur le récepteur de média ASF et en passant **IID \_ IMFASFContentInfo** comme identificateur d’interface.</span><span class="sxs-lookup"><span data-stu-id="f2775-122">Get a pointer to the [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) pointer of the ASF media sink by calling **IMFMediaSink::QueryInterface** on the ASF media sink and passing **IID\_IMFASFContentInfo** as the interface identifier.</span></span>
2.  <span data-ttu-id="f2775-123">Obtient l’objet de profil ASF associé à l’objet ContentInfo.</span><span class="sxs-lookup"><span data-stu-id="f2775-123">Get the ASF profile object associated with the ContentInfo object.</span></span>
3.  <span data-ttu-id="f2775-124">Énumérez les flux dans le profil pour récupérer le type de média du flux.</span><span class="sxs-lookup"><span data-stu-id="f2775-124">Enumerate the streams in the profile to get the stream's media type.</span></span>

<span data-ttu-id="f2775-125">**Pour récupérer les propriétés d’encodage à partir du récepteur multimédia ASF**</span><span class="sxs-lookup"><span data-stu-id="f2775-125">**To get the encoding properties from the ASF media sink**</span></span>

1.  <span data-ttu-id="f2775-126">Si vous avez configuré les [propriétés d’encodage](configuring-the-encoder.md) dans le récepteur multimédia (décrit dans [définition des propriétés dans le récepteur de fichiers](setting-properties-in-the-file-sink.md)), vous pouvez référencer la Banque de propriétés du récepteur en appelant **IMFMediaSink :: QueryInterface** sur le récepteur de média ASF et en passant **IID \_ IPropertyStore** comme identificateur d’interface.</span><span class="sxs-lookup"><span data-stu-id="f2775-126">If you have configured the [Encoding Properties](configuring-the-encoder.md) in the media sink (described in [Setting Properties in the File Sink](setting-properties-in-the-file-sink.md)), you can a reference to the sink's property store by calling **IMFMediaSink::QueryInterface** on the ASF media sink and passing **IID\_IPropertyStore** as the interface identifier.</span></span>
2.  <span data-ttu-id="f2775-127">Si vous avez un pointeur vers l’objet ContentInfo du récepteur, vous pouvez appeler [**IMFASFContentInfo :: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) pour obtenir une référence à la Banque de propriétés du récepteur multimédia.</span><span class="sxs-lookup"><span data-stu-id="f2775-127">If you have a pointer to the sink's ContentInfo object, you can call [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) to get a reference to the media sink's property store.</span></span>

    <span data-ttu-id="f2775-128">Assurez-vous que toutes les propriétés d’encodage définies sur le récepteur de média ASF sont reflétées dans la Banque de propriétés passée à [**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) et [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate).</span><span class="sxs-lookup"><span data-stu-id="f2775-128">Make sure that all of encoding properties that are set on the ASF media sink are reflected in the property store passed to [**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) and [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate).</span></span> <span data-ttu-id="f2775-129">L’encodeur est configuré automatiquement en fonction des paramètres spécifiés par l’application.</span><span class="sxs-lookup"><span data-stu-id="f2775-129">The encoder is configured automatically based on the settings specified by the application.</span></span>

<span data-ttu-id="f2775-130">Lors de la création du nœud transformer dans la topologie d’encodage, vous pouvez définir le type d’objet en tant que pointeur [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) reçu dans ces deux appels.</span><span class="sxs-lookup"><span data-stu-id="f2775-130">While creating the transform node in the encoding topology, you can set the object type as an [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pointer received in these two calls.</span></span> <span data-ttu-id="f2775-131">Lorsque la topologie est résolue, la session multimédia utilise l’objet d’activation pour créer une instance de la MFT de l’encodeur.</span><span class="sxs-lookup"><span data-stu-id="f2775-131">When the topology is resolved, the Media Session uses the activation object to create an instance of the encoder MFT.</span></span>

## <a name="encoder-enumeration-in-windows-7-and-later"></a><span data-ttu-id="f2775-132">Énumération d’encodeurs dans Windows 7 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="f2775-132">Encoder Enumeration in Windows 7 and Later</span></span>

<span data-ttu-id="f2775-133">Pour les applications qui s’exécutent sur Windows 7, en plus de [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) , vous pouvez énumérer l’encodeur MFTS en appelant [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex).</span><span class="sxs-lookup"><span data-stu-id="f2775-133">For applications that are running on Windows 7, in addition to [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) you can enumerate the encoder MFTs by calling [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex).</span></span> <span data-ttu-id="f2775-134">Cette fonction retourne un pointeur vers l’objet d’activation de la table MFT de l’encodeur.</span><span class="sxs-lookup"><span data-stu-id="f2775-134">This function returns a pointer to the activation object of the encoder MFT.</span></span> <span data-ttu-id="f2775-135">La structure de la fonction est très similaire à **MFTEnum** décrite ci-dessus, à l’exception de **MFTEnumEx** retourne un tableau de pointeurs [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pour le MFTS d’encodeur qui correspondent aux critères de recherche.</span><span class="sxs-lookup"><span data-stu-id="f2775-135">The structure of the function is very similar to **MFTEnum** described above except **MFTEnumEx** returns an array of [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pointers for the encoder MFTs that match the search criteria.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f2775-136">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f2775-136">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f2775-137">Instanciation d’une table MFT d’encodeur</span><span class="sxs-lookup"><span data-stu-id="f2775-137">Instantiating an Encoder MFT</span></span>](instantiating-the-encoder-mft.md)
</dt> <dt>

[<span data-ttu-id="f2775-138">Encodeurs Windows Media</span><span class="sxs-lookup"><span data-stu-id="f2775-138">Windows Media Encoders</span></span>](windows-media-encoders.md)
</dt> <dt>

[<span data-ttu-id="f2775-139">Objets d’activation</span><span class="sxs-lookup"><span data-stu-id="f2775-139">Activation Objects</span></span>](activation-objects.md)
</dt> </dl>

 

 



