---
description: Encodage vidéo entrelacé
ms.assetid: 7695d4e3-4a75-4972-ab02-bc532d6a4dce
title: Encodage vidéo entrelacé (Microsoft Media Foundation)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fafacb56f29964e81b040c59cdb75d8ebb35830b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103952838"
---
# <a name="interlaced-video-encoding-microsoft-media-foundation"></a><span data-ttu-id="30bf8-103">Encodage vidéo entrelacé (Microsoft Media Foundation)</span><span class="sxs-lookup"><span data-stu-id="30bf8-103">Interlaced Video Encoding (Microsoft Media Foundation)</span></span>

<span data-ttu-id="30bf8-104">Les données vidéo destinées à être utilisées avec les ordinateurs sont généralement *progressifs*, ce qui signifie que chaque image est encodée sous la forme d’une image unique.</span><span class="sxs-lookup"><span data-stu-id="30bf8-104">Video data intended for use with computers is typically *progressive*, meaning that each frame is encoded as a single image.</span></span> <span data-ttu-id="30bf8-105">Certains appareils, comme les téléviseurs, n’affichent pas de frame en même temps, mais sous forme de deux images.</span><span class="sxs-lookup"><span data-stu-id="30bf8-105">Some devices, like televisions, do not display a frame all at once, but as two images.</span></span> <span data-ttu-id="30bf8-106">L’une des images, ou champs, contient toutes les lignes paires numérotées.</span><span class="sxs-lookup"><span data-stu-id="30bf8-106">One of the images, or fields, contains all of the even numbered rows.</span></span> <span data-ttu-id="30bf8-107">L’autre champ contient les données de toutes les lignes impaires numérotées.</span><span class="sxs-lookup"><span data-stu-id="30bf8-107">The other field contains the data for all of the odd numbered rows.</span></span> <span data-ttu-id="30bf8-108">La vidéo encodée avec plusieurs champs par trame est appelée entrelacée, car elle est rendue en basculant entre le champ pair et le champ impair.</span><span class="sxs-lookup"><span data-stu-id="30bf8-108">Video encoded with more than one field per frame is called interlaced, because it is rendered by switching between the even field and the odd field.</span></span>

<span data-ttu-id="30bf8-109">Dans le passé, le contenu vidéo entrelacé était toujours déentrelacé avant l’encodage avec le codec Windows Media Video.</span><span class="sxs-lookup"><span data-stu-id="30bf8-109">In the past, interlaced video content was always de-interlaced before encoding with the Windows Media Video codec.</span></span> <span data-ttu-id="30bf8-110">À compter de Windows Media 9 Series, toutefois, l’encodeur vidéo prend en charge la compression de contenu entrelacé sans avoir d’abord à le convertir en progressif.</span><span class="sxs-lookup"><span data-stu-id="30bf8-110">Beginning with Windows Media 9 Series, however, the video encoder supports compression of interlaced content without first converting it to progressive.</span></span> <span data-ttu-id="30bf8-111">La conservation de l’entrelacement dans un fichier encodé est importante si le contenu est toujours rendu sur un écran entrelacé, tel qu’une télévision.</span><span class="sxs-lookup"><span data-stu-id="30bf8-111">Maintaining interlacing in an encoded file is important if the content is ever rendered on an interlaced display, such as a television.</span></span> <span data-ttu-id="30bf8-112">Cette fonctionnalité est de plus en plus importante, car la prise en charge de la réplication de contenu Windows Media sur les lecteurs de DVD, les boîtiers décodeurs et les autres appareils électroniques de base.</span><span class="sxs-lookup"><span data-stu-id="30bf8-112">This feature is of increasing importance, as support for Windows Media-based content spreads to DVD players, set-top boxes, and other home electronics.</span></span>

<span data-ttu-id="30bf8-113">Le moyen le plus simple pour encoder et distribuer de la vidéo entrelacée est de développer votre application à l’aide du kit de développement logiciel (SDK) de format Windows Media et de stocker le contenu dans des fichiers ASF.</span><span class="sxs-lookup"><span data-stu-id="30bf8-113">The easiest way to encode and deliver interlaced video is to develop your application using the Windows Media Format SDK and storing the content in ASF files.</span></span> <span data-ttu-id="30bf8-114">Les informations entrelacées sur les frames sont transmises au codec à l’aide d’extensions d’unité de données, qui fonctionnent bien pour le contenu ASF, mais sont un peu plus délicates à prendre en charge dans d’autres conteneurs.</span><span class="sxs-lookup"><span data-stu-id="30bf8-114">The interlaced information about frames is passed to the codec using data unit extensions, which work well for ASF content, but are a little trickier to support in other containers.</span></span> <span data-ttu-id="30bf8-115">Pour plus d’informations sur les extensions d’unité de données, consultez [utilisation des extensions d’unité de données](usingdataunitextensions.md).</span><span class="sxs-lookup"><span data-stu-id="30bf8-115">For more information about data unit extensions, see [Using Data Unit Extensions](usingdataunitextensions.md).</span></span>

<span data-ttu-id="30bf8-116">La prise en charge de l’encodage entrelacé implique deux étapes principales : l’obtention des informations de trame à l’encodeur et la transmission des informations à l’application de rendu.</span><span class="sxs-lookup"><span data-stu-id="30bf8-116">To support interlaced encoding involves two major steps: getting the frame information to the encoder, and delivering the information to the rendering application.</span></span> <span data-ttu-id="30bf8-117">Ces étapes sont décrites dans les paragraphes suivants.</span><span class="sxs-lookup"><span data-stu-id="30bf8-117">These steps are described in the following paragraphs.</span></span>

## <a name="interlaced-video-and-the-encoder"></a><span data-ttu-id="30bf8-118">Vidéo entrelacée et encodeur</span><span class="sxs-lookup"><span data-stu-id="30bf8-118">Interlaced Video and the Encoder</span></span>

<span data-ttu-id="30bf8-119">La première étape de l’encodage d’une vidéo avec entrelacement conservé consiste à configurer l’encodeur pour encoder les champs entrelacés.</span><span class="sxs-lookup"><span data-stu-id="30bf8-119">The first step in encoding video with maintained interlacing is to configure the encoder to encode interlaced fields.</span></span> <span data-ttu-id="30bf8-120">Pour ce faire, affectez la valeur **true** à la propriété [MFPKEY \_ INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) .</span><span class="sxs-lookup"><span data-stu-id="30bf8-120">To do this, set the [MFPKEY\_INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) property to **TRUE**.</span></span> <span data-ttu-id="30bf8-121">Cela prépare l’encodeur pour recevoir des échantillons entrelacés.</span><span class="sxs-lookup"><span data-stu-id="30bf8-121">This prepares the encoder to receive interlaced samples.</span></span> <span data-ttu-id="30bf8-122">Chaque exemple d’entrée doit contenir les deux champs.</span><span class="sxs-lookup"><span data-stu-id="30bf8-122">Each input sample must contain both fields.</span></span>

<span data-ttu-id="30bf8-123">Chaque exemple que vous traitez avec l’encodeur après l’activation de l’encodage entrelacé doit avoir une extension d’unité de données attachée.</span><span class="sxs-lookup"><span data-stu-id="30bf8-123">Each sample that you process with the encoder after activating interlaced encoding should have a data unit extension attached.</span></span> <span data-ttu-id="30bf8-124">Les exemples sans l’extension d’unité de données attendue sont considérés comme progressifs.</span><span class="sxs-lookup"><span data-stu-id="30bf8-124">Samples without the expected data unit extension are assumed to be progressive.</span></span> <span data-ttu-id="30bf8-125">Le GUID identifiant l’extension est D590DC20-07BC-436C-9CF7-F3BBFBF1A4DC.</span><span class="sxs-lookup"><span data-stu-id="30bf8-125">The GUID identifying the extension is D590DC20-07BC-436C-9CF7-F3BBFBF1A4DC.</span></span> <span data-ttu-id="30bf8-126">Les valeurs transmises par les objets du kit de développement logiciel (SDK) du format Windows Media sont définies dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="30bf8-126">The values passed by the objects of the Windows Media Format SDK are defined in the following table.</span></span>



| <span data-ttu-id="30bf8-127">Valeur</span><span class="sxs-lookup"><span data-stu-id="30bf8-127">Value</span></span>      | <span data-ttu-id="30bf8-128">Description</span><span class="sxs-lookup"><span data-stu-id="30bf8-128">Description</span></span>                                                                                                                              |
|------------|------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="30bf8-129">0x00000020</span><span class="sxs-lookup"><span data-stu-id="30bf8-129">0x00000020</span></span> | <span data-ttu-id="30bf8-130">Spécifie que l’échantillon est encodé avec le champ inférieur en premier.</span><span class="sxs-lookup"><span data-stu-id="30bf8-130">Specifies that the sample is encoded with the bottom field first.</span></span> <span data-ttu-id="30bf8-131">Cette valeur est significative uniquement lorsqu’elle est associée à la valeur entrelacée.</span><span class="sxs-lookup"><span data-stu-id="30bf8-131">This value is only meaningful when combined with the interlaced value.</span></span> |
| <span data-ttu-id="30bf8-132">0x00000040</span><span class="sxs-lookup"><span data-stu-id="30bf8-132">0x00000040</span></span> | <span data-ttu-id="30bf8-133">Spécifie que l’échantillon est encodé avec le champ supérieur en premier.</span><span class="sxs-lookup"><span data-stu-id="30bf8-133">Specifies that the sample is encoded with the top field first.</span></span> <span data-ttu-id="30bf8-134">Cette valeur est significative uniquement lorsqu’elle est associée à la valeur entrelacée.</span><span class="sxs-lookup"><span data-stu-id="30bf8-134">This value is only meaningful when combined with the interlaced value.</span></span>    |
| <span data-ttu-id="30bf8-135">0x00000080</span><span class="sxs-lookup"><span data-stu-id="30bf8-135">0x00000080</span></span> | <span data-ttu-id="30bf8-136">Spécifie que l’échantillon est entrelacé.</span><span class="sxs-lookup"><span data-stu-id="30bf8-136">Specifies that the sample is interlaced.</span></span> <span data-ttu-id="30bf8-137">Il s’agit de la seule valeur qui est significative pour le codec DMOs.</span><span class="sxs-lookup"><span data-stu-id="30bf8-137">This is the only value that is meaningful to the codec DMOs.</span></span>                                    |



 

<span data-ttu-id="30bf8-138">L’une des deux premières valeurs est toujours combinée avec 0x80 à l’aide d' **une opération de bits or avant** d’être définie sur l’exemple.</span><span class="sxs-lookup"><span data-stu-id="30bf8-138">One of the first two values is always combined with 0x80 using a bitwise **OR** before being set on the sample.</span></span> <span data-ttu-id="30bf8-139">Toutefois, l’encodeur vérifie uniquement 0x80 et ignore le reste de l’extension.</span><span class="sxs-lookup"><span data-stu-id="30bf8-139">However, the encoder only checks for 0x80 and disregards the rest of the extension.</span></span> <span data-ttu-id="30bf8-140">Si l’extension identifie l’échantillon comme entrelacé, l’encodeur maintient l’entrelacement de l’échantillon dans le flux compressé et incorpore un indicateur d’indication dans le flux afin que le décodeur puisse identifier des frames entrelacés.</span><span class="sxs-lookup"><span data-stu-id="30bf8-140">If the extension identifies the sample as interlaced, the encoder maintains the sample interlacing in the compressed stream, and embeds an indication flag in the stream so that the decoder can identify interlaced frames.</span></span> <span data-ttu-id="30bf8-141">Chaque échantillon entrelacé est marqué, de sorte que le contenu source qui est une combinaison de profondeurs et entrelacés peut être encodé dans un flux.</span><span class="sxs-lookup"><span data-stu-id="30bf8-141">Each interlaced sample is marked, so that source content that is a mix of progressive and interlaced can be encoded into a stream together.</span></span>

<span data-ttu-id="30bf8-142">L’objet enregistreur du SDK Windows Media format comprend les extensions d’unité de données de type de contenu dans les exemples qu’il écrit dans la section de données du conteneur ASF pour une utilisation au moment du rendu.</span><span class="sxs-lookup"><span data-stu-id="30bf8-142">The Windows Media Format SDK writer object includes the content type data unit extensions in the samples that it writes to the data section of the ASF container for use at the time of rendering.</span></span>

## <a name="reading-and-rendering-interlaced-video"></a><span data-ttu-id="30bf8-143">Lecture et rendu de la vidéo entrelacée</span><span class="sxs-lookup"><span data-stu-id="30bf8-143">Reading and Rendering Interlaced Video</span></span>

<span data-ttu-id="30bf8-144">Le décodeur identifie les échantillons entrelacés en fonction de l’indicateur défini dans le flux par l’encodeur.</span><span class="sxs-lookup"><span data-stu-id="30bf8-144">The decoder identifies interlaced samples based on the flag set in the stream by the encoder.</span></span> <span data-ttu-id="30bf8-145">Par défaut, le décodeur réentrelace les exemples et fournit des sorties progressives.</span><span class="sxs-lookup"><span data-stu-id="30bf8-145">As a default, the decoder deinterlaces the samples and delivers progressive outputs.</span></span> <span data-ttu-id="30bf8-146">L’application de lecteur peut configurer le décodeur pour traiter les sorties avec entrelacement géré en définissant la propriété de [ \_ \_ désentrelacement de décodeur MFPKEY](mfpkey-decoder-deinterlacingproperty.md) .</span><span class="sxs-lookup"><span data-stu-id="30bf8-146">The player application can configure the decoder to process outputs with interlacing maintained by setting the [MFPKEY\_DECODER\_DEINTERLACING](mfpkey-decoder-deinterlacingproperty.md) property.</span></span>

<span data-ttu-id="30bf8-147">La difficulté de la lecture vidéo entrelacée se produit après que le décodeur a effectué les exemples.</span><span class="sxs-lookup"><span data-stu-id="30bf8-147">The difficulty in interlaced video playback arises after the decoder delivers the samples.</span></span> <span data-ttu-id="30bf8-148">Le convertisseur (carte vidéo ou puce dans un appareil) ne peut pas afficher correctement le contenu vidéo sans savoir quel champ est.</span><span class="sxs-lookup"><span data-stu-id="30bf8-148">The renderer (video card or chip in a device) cannot properly display the video content without knowing which field is which.</span></span> <span data-ttu-id="30bf8-149">Dans les applications utilisant le kit de développement logiciel (SDK) Windows Media format, l’extension d’unité de données de type de contenu est récupérée à partir des exemples non compressés et peut être transmise à l’appareil.</span><span class="sxs-lookup"><span data-stu-id="30bf8-149">In applications using the Windows Media Format SDK, the content type data unit extension is retrieved from the uncompressed samples, and can be passed to the device.</span></span>

<span data-ttu-id="30bf8-150">Lorsque vous utilisez les objets codec directement, aucun de ces transferts de données n’est automatique.</span><span class="sxs-lookup"><span data-stu-id="30bf8-150">When using the codec objects directly, none of this data transfer is automatic.</span></span> <span data-ttu-id="30bf8-151">Vous devez implémenter la prise en charge de l’extension des unités de données, à la fois dans vos objets de mémoire tampon et dans le conteneur que vous utilisez pour votre contenu encodé.</span><span class="sxs-lookup"><span data-stu-id="30bf8-151">You must implement data-unit-extension support, both in your buffer objects and in the container that you use for your encoded content.</span></span> <span data-ttu-id="30bf8-152">La plupart des types courants de conteneurs multimédias (comme AVI) ne prennent pas en charge les métadonnées au niveau de l’échantillon.</span><span class="sxs-lookup"><span data-stu-id="30bf8-152">Most common types of media containers (like AVI) do not support sample-level metadata.</span></span> <span data-ttu-id="30bf8-153">Vous pouvez implémenter votre propre système pour stocker les données dans le fichier et les associer à des échantillons individuels, mais seul un lecteur personnalisé est en mesure de le récupérer.</span><span class="sxs-lookup"><span data-stu-id="30bf8-153">You can implement your own system to store the data in the file and associate it with individual samples, but only a customized reader would be able to retrieve it.</span></span>

> [!Note]  
> <span data-ttu-id="30bf8-154">Si vous affectez la **valeur true** à la propriété [MFPKEY \_ INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) et que vous n’envoyez pas d’exemples avec l’extension d’unité de données Content-type attachée, l’encodeur risque de se bloquer.</span><span class="sxs-lookup"><span data-stu-id="30bf8-154">Setting the [MFPKEY\_INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) property to **TRUE**, and then not sending any samples with the content-type data-unit extension attached can cause the encoder to crash.</span></span> <span data-ttu-id="30bf8-155">Définissez l’encodeur pour l’encodage entrelacé uniquement si vous avez des échantillons entrelacés à remettre.</span><span class="sxs-lookup"><span data-stu-id="30bf8-155">Set the encoder for interlaced encoding only if you have interlaced samples to deliver.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="30bf8-156">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="30bf8-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="30bf8-157">Utilisation de la vidéo</span><span class="sxs-lookup"><span data-stu-id="30bf8-157">Working with Video</span></span>](workingwithvideo.md)
</dt> </dl>

 

 



