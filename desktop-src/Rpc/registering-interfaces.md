---
title: Inscription des interfaces
description: Inscription d’une interface d’appel de procédure distante (RPC).
ms.assetid: c22e3fa8-98be-461a-b06d-292d3f655ffc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30ea9e851e8c9663c8f66d983d3400b1ee398a9d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104190731"
---
# <a name="registering-interfaces"></a><span data-ttu-id="2228b-103">Inscription des interfaces</span><span class="sxs-lookup"><span data-stu-id="2228b-103">Registering Interfaces</span></span>

<span data-ttu-id="2228b-104">Cette section présente en détail le processus d’inscription d’une interface RPC.</span><span class="sxs-lookup"><span data-stu-id="2228b-104">This section presents a detailed discussion of the process of registering an RPC interface.</span></span>

<span data-ttu-id="2228b-105">Les informations contenues dans cette section sont présentées dans les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="2228b-105">The information in this section is presented in the following topics:</span></span>

-   [<span data-ttu-id="2228b-106">Fonctions d’inscription de l’interface</span><span class="sxs-lookup"><span data-stu-id="2228b-106">Interface Registration Functions</span></span>](#interface-registration-functions)
-   [<span data-ttu-id="2228b-107">Vecteurs de point d’entrée</span><span class="sxs-lookup"><span data-stu-id="2228b-107">Entry-Point Vectors</span></span>](#entry-point-vectors)
-   [<span data-ttu-id="2228b-108">EPVs Manager</span><span class="sxs-lookup"><span data-stu-id="2228b-108">Manager EPVs</span></span>](#manager-epvs)
-   [<span data-ttu-id="2228b-109">Inscription d’une implémentation unique d’une interface</span><span class="sxs-lookup"><span data-stu-id="2228b-109">Registering a Single Implementation of an Interface</span></span>](#registering-a-single-implementation-of-an-interface)
-   [<span data-ttu-id="2228b-110">Inscription de plusieurs implémentations d’une interface</span><span class="sxs-lookup"><span data-stu-id="2228b-110">Registering Multiple Implementations of an Interface</span></span>](#registering-multiple-implementations-of-an-interface)
-   [<span data-ttu-id="2228b-111">Règles d’appel des routines du gestionnaire</span><span class="sxs-lookup"><span data-stu-id="2228b-111">Rules for Invoking Manager Routines</span></span>](#rules-for-invoking-manager-routines)
-   [<span data-ttu-id="2228b-112">Distribution d’un appel de procédure distante à une routine Server-Manager</span><span class="sxs-lookup"><span data-stu-id="2228b-112">Dispatching a Remote Procedure Call to a Server-Manager Routine</span></span>](#dispatching-a-remote-procedure-call-to-a-server-manager-routine)
-   [<span data-ttu-id="2228b-113">Fournir votre propre fonction de Object-Inquiry</span><span class="sxs-lookup"><span data-stu-id="2228b-113">Supplying Your Own Object-Inquiry Function</span></span>](#supplying-your-own-object-inquiry-function)

## <a name="interface-registration-functions"></a><span data-ttu-id="2228b-114">Fonctions d’inscription de l’interface</span><span class="sxs-lookup"><span data-stu-id="2228b-114">Interface Registration Functions</span></span>

<span data-ttu-id="2228b-115">Les serveurs inscrivent leurs interfaces en appelant la fonction [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif) .</span><span class="sxs-lookup"><span data-stu-id="2228b-115">Servers register their interfaces by calling the [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif) function.</span></span> <span data-ttu-id="2228b-116">Les programmes serveur complexes prennent souvent en charge plusieurs interfaces.</span><span class="sxs-lookup"><span data-stu-id="2228b-116">Complex server programs often support more than one interface.</span></span> <span data-ttu-id="2228b-117">Les applications serveur doivent appeler cette fonction une fois pour chaque interface qu’elles prennent en charge.</span><span class="sxs-lookup"><span data-stu-id="2228b-117">Server applications must call this function once for each interface they support.</span></span>

<span data-ttu-id="2228b-118">En outre, les serveurs peuvent prendre en charge plusieurs versions de la même interface, chacune avec sa propre implémentation des fonctions de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-118">Also, servers can support multiple versions of the same interface, each with its own implementation of the interface's functions.</span></span> <span data-ttu-id="2228b-119">Si votre programme serveur effectue cette opération, il doit fournir un ensemble de points d’entrée.</span><span class="sxs-lookup"><span data-stu-id="2228b-119">If your server program does this, it must provide a set of entry points.</span></span> <span data-ttu-id="2228b-120">Un point d’entrée est une routine Manager qui distribue les appels pour une version d’une interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-120">An entry point is a manager routine that dispatches calls for a version of an interface.</span></span> <span data-ttu-id="2228b-121">Il doit y avoir un point d’entrée pour chaque version de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-121">There must be one entry point for each version of the interface.</span></span> <span data-ttu-id="2228b-122">Le groupe de points d’entrée est appelé vecteur de point d’entrée.</span><span class="sxs-lookup"><span data-stu-id="2228b-122">The group of entry points is called an entry point vector.</span></span> <span data-ttu-id="2228b-123">Pour plus d’informations, consultez [vecteurs de point d’entrée](#entry-point-vectors).</span><span class="sxs-lookup"><span data-stu-id="2228b-123">For details, see [Entry-Point Vectors](#entry-point-vectors).</span></span>

<span data-ttu-id="2228b-124">En plus de la fonction standard [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), RPC prend également en charge d’autres fonctions d’inscription d’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-124">In addition to the standard function [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), RPC also supports other interface registration functions.</span></span> <span data-ttu-id="2228b-125">La fonction [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) étend les fonctionnalités de **RpcServerRegisterIf** en vous permettant de spécifier un ensemble d’indicateurs d’inscription (voir [indicateurs d’inscription d’interface](interface-registration-flags.md)), le nombre maximal de demandes d’appel de procédure distante simultanées que le serveur peut accepter et la taille maximale en octets des blocs de données entrants.</span><span class="sxs-lookup"><span data-stu-id="2228b-125">The [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) function extends the capabilities of **RpcServerRegisterIf** by enabling you to specify a set of registration flags (see [Interface Registration Flags](interface-registration-flags.md)), the maximum number of concurrent remote procedure call requests the server can accept, and the maximum size in bytes of incoming data blocks.</span></span>

<span data-ttu-id="2228b-126">La bibliothèque RPC contient également une fonction appelée [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex).</span><span class="sxs-lookup"><span data-stu-id="2228b-126">The RPC library also contains a function called [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex).</span></span> <span data-ttu-id="2228b-127">À l’instar de la fonction [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif) , cette fonction inscrit une interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-127">Like the [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif) function, this function registers an interface.</span></span> <span data-ttu-id="2228b-128">Votre programme serveur peut également utiliser cette fonction pour spécifier un ensemble d’indicateurs d’inscription (voir [indicateurs d’inscription](interface-registration-flags.md)de l’interface), le nombre maximal de demandes simultanées d’appel de procédure distante que le serveur peut accepter et une fonction de rappel de sécurité.</span><span class="sxs-lookup"><span data-stu-id="2228b-128">Your server program can also use this function to specify a set of registration flags (see [Interface Registration Flags](interface-registration-flags.md)), the maximum number of concurrent remote procedure call requests the server can accept, and a security callback function.</span></span>

<span data-ttu-id="2228b-129">Les fonctions [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)et [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) définissent des valeurs dans la table de registre de l’interface interne.</span><span class="sxs-lookup"><span data-stu-id="2228b-129">The [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), and [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) functions set values in the internal interface registry table.</span></span> <span data-ttu-id="2228b-130">Cette table est utilisée pour mapper les UUID d’interface et d’objet à un EPV Manager.</span><span class="sxs-lookup"><span data-stu-id="2228b-130">This table is used to map the interface UUID and object UUIDs to a manager EPV.</span></span> <span data-ttu-id="2228b-131">Le gestionnaire EPV est un tableau de pointeurs de fonction qui contient un seul pointeur de fonction pour chaque prototype de fonction dans l’interface spécifiée dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-131">The manager EPV is an array of function pointers that contains exactly one function pointer for each function prototype in the interface specified in the IDL file.</span></span>

<span data-ttu-id="2228b-132">Pour plus d’informations sur la fourniture de plusieurs EPVs pour fournir plusieurs implémentations de l’interface, consultez [plusieurs implémentations d’interface](#registering-multiple-implementations-of-an-interface).</span><span class="sxs-lookup"><span data-stu-id="2228b-132">For information on supplying multiple EPVs to provide multiple implementations of the interface, see [Multiple Interface Implementations](#registering-multiple-implementations-of-an-interface).</span></span>

<span data-ttu-id="2228b-133">La bibliothèque Runtime utilise la table de registre de l’interface (définie par les appels à la fonction [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2)) et la table de registre des objets (définie par les appels à la fonction [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype)) pour mapper les UUID d’interface et d’objet au pointeur de fonction.</span><span class="sxs-lookup"><span data-stu-id="2228b-133">The run-time library uses the interface registry table (set by calls to the function [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2)) and the object registry table (set by calls to the function [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype)) to map interface and object UUIDs to the function pointer.</span></span>

<span data-ttu-id="2228b-134">Si vous souhaitez que votre programme serveur supprime une interface du registre de la bibliothèque Runtime RPC, appelez la fonction [**RpcServerUnregisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverunregisterif) .</span><span class="sxs-lookup"><span data-stu-id="2228b-134">When you want your server program to remove an interface from the RPC run-time library registry, call the [**RpcServerUnregisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverunregisterif) function.</span></span> <span data-ttu-id="2228b-135">Une fois l’interface supprimée du Registre, la bibliothèque Runtime RPC n’accepte plus de nouveaux appels pour cette interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-135">After the interface is removed from the registry, the RPC run-time library will no longer accept new calls for that interface.</span></span>

## <a name="entry-point-vectors"></a><span data-ttu-id="2228b-136">Vecteurs de point d’entrée</span><span class="sxs-lookup"><span data-stu-id="2228b-136">Entry-point Vectors</span></span>

<span data-ttu-id="2228b-137">Le vecteur de point d’entrée du gestionnaire (EPV) est un tableau de pointeurs de fonction qui pointent vers les implémentations des fonctions spécifiées dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-137">The manager entry-point vector (EPV) is an array of function pointers that point to implementations of the functions specified in the IDL file.</span></span> <span data-ttu-id="2228b-138">Le nombre d’éléments dans le tableau correspond au nombre de fonctions spécifiées dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-138">The number of elements in the array corresponds to the number of functions specified in the IDL file.</span></span> <span data-ttu-id="2228b-139">RPC prend en charge plusieurs vecteurs de point d’entrée représentant plusieurs implémentations des fonctions spécifiées dans l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-139">RPC supports multiple entry-point vectors representing multiple implementations of the functions specified in the interface.</span></span>

<span data-ttu-id="2228b-140">Le compilateur MIDL génère automatiquement un type de données Manager EPV à utiliser lors de la création du gestionnaire EPVs.</span><span class="sxs-lookup"><span data-stu-id="2228b-140">The MIDL compiler automatically generates a manager EPV data type for use in constructing manager EPVs.</span></span> <span data-ttu-id="2228b-141">Le type de données est nommé \* if-name \***\_ Server \_ EPV**, où *-Name* spécifie l’identificateur d’interface dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-141">The data type is named \*if-name\***\_SERVER\_EPV**, where *if-name* specifies the interface identifier in the IDL file.</span></span>

<span data-ttu-id="2228b-142">Le compilateur MIDL crée et initialise automatiquement un EPV Manager par défaut en supposant qu’il existe une routine de gestion portant le même nom pour chaque procédure de l’interface et qu’elle est spécifiée dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-142">The MIDL compiler automatically creates and initializes a default manager EPV on the assumption that a manager routine of the same name exists for each procedure in the interface and is specified in the IDL file.</span></span>

<span data-ttu-id="2228b-143">Lorsqu’un serveur offre plusieurs implémentations de la même interface, le serveur doit créer un EPV Manager supplémentaire pour chaque implémentation.</span><span class="sxs-lookup"><span data-stu-id="2228b-143">When a server offers multiple implementations of the same interface, the server must create one additional manager EPV for each implementation.</span></span> <span data-ttu-id="2228b-144">Chaque EPV doit contenir exactement un point d’entrée (adresse d’une fonction) pour chaque procédure définie dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-144">Each EPV must contain exactly one entry point (address of a function) for each procedure defined in the IDL file.</span></span> <span data-ttu-id="2228b-145">L’application serveur déclare et Initialise une variable Manager EPV de type *si-name \* \* \* \_ Server \_ EPV*\* pour chaque implémentation supplémentaire de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-145">The server application declares and initializes one manager EPV variable of type *if-name\*\*\*\_SERVER\_EPV*\* for each additional implementation of the interface.</span></span> <span data-ttu-id="2228b-146">Pour inscrire le EPVs, il appelle [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) une fois pour chaque type d’objet qu’il prend en charge.</span><span class="sxs-lookup"><span data-stu-id="2228b-146">To register the EPVs it calls [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) once for each object type it supports.</span></span>

<span data-ttu-id="2228b-147">Lorsque le client effectue un appel de procédure distante au serveur, le EPV contenant le pointeur de fonction est sélectionné en fonction de l’UUID de l’interface et du type d’objet.</span><span class="sxs-lookup"><span data-stu-id="2228b-147">When the client makes a remote procedure call to the server, the EPV containing the function pointer is selected based on the interface UUID and the object type.</span></span> <span data-ttu-id="2228b-148">Le type d’objet est dérivé de l’UUID de l’objet par la fonction d’interrogation de l’objet ou le mappage piloté par la table contrôlé par [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype).</span><span class="sxs-lookup"><span data-stu-id="2228b-148">The object type is derived from the object UUID by the object-inquiry function or the table-driven mapping controlled by [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype).</span></span>

## <a name="manager-epvs"></a><span data-ttu-id="2228b-149">EPVs Manager</span><span class="sxs-lookup"><span data-stu-id="2228b-149">Manager EPVs</span></span>

<span data-ttu-id="2228b-150">Par défaut, le compilateur MIDL utilise les noms des procédures du fichier IDL d’une interface pour générer un EPV Manager, que le compilateur place directement dans le stub serveur.</span><span class="sxs-lookup"><span data-stu-id="2228b-150">By default, the MIDL compiler uses the procedure names from an interface's IDL file to generate a manager EPV, which the compiler places directly into the server stub.</span></span> <span data-ttu-id="2228b-151">Ce EPV par défaut est initialisé de manière statique à l’aide des noms de procédure déclarés dans la définition de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-151">This default EPV is statically initialized using the procedure names declared in the interface definition.</span></span>

<span data-ttu-id="2228b-152">Pour inscrire un gestionnaire à l’aide de l’EPV par défaut, spécifiez **null** comme valeur du paramètre *MgrEpv* dans un appel à la fonction [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) .</span><span class="sxs-lookup"><span data-stu-id="2228b-152">To register a manager using the default EPV, specify **NULL** as the value of the *MgrEpv* parameter in a call to either the [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) function.</span></span> <span data-ttu-id="2228b-153">Si les noms de routine utilisés par un gestionnaire correspondent à ceux de la définition d’interface, vous pouvez inscrire ce gestionnaire à l’aide du EPV par défaut de l’interface générée par le compilateur MIDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-153">If the routine names used by a manager correspond to those of the interface definition, you can register this manager using the default EPV of the interface generated by the MIDL compiler.</span></span> <span data-ttu-id="2228b-154">Vous pouvez également inscrire un gestionnaire à l’aide d’un EPV fourni par l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="2228b-154">You can also register a manager using an EPV that the server application supplies.</span></span>

<span data-ttu-id="2228b-155">Un serveur peut (et parfois) créer et inscrire un EPV de gestionnaire non **null** pour une interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-155">A server can (and sometimes must) create and register a non-**null** manager EPV for an interface.</span></span> <span data-ttu-id="2228b-156">Pour sélectionner un EPV fourni par l’application serveur, transmettez l’adresse d’un EPV dont la valeur a été déclarée par le serveur comme valeur de *MgrEpv* un paramètre.</span><span class="sxs-lookup"><span data-stu-id="2228b-156">To select a server application–supplied EPV, pass the address of an EPV whose value has been declared by the server as the value of the *MgrEpv* a parameter.</span></span> <span data-ttu-id="2228b-157">Une valeur non **null** pour le *MgrEpv* un paramètre remplace toujours un EPV par défaut dans le stub serveur.</span><span class="sxs-lookup"><span data-stu-id="2228b-157">A non-**null** value for the *MgrEpv* a parameter always overrides a default EPV in the server stub.</span></span>

<span data-ttu-id="2228b-158">Le compilateur MIDL génère automatiquement un type de données Manager EPV (RPC \_ Mgr \_ EPV) pour une application serveur à utiliser dans la création de EPVs Manager.</span><span class="sxs-lookup"><span data-stu-id="2228b-158">The MIDL compiler automatically generates a manager EPV data type (RPC\_MGR\_EPV) for a server application to use in constructing manager EPVs.</span></span> <span data-ttu-id="2228b-159">Un EPV Manager doit contenir exactement un point d’entrée (adresse de fonction) pour chaque procédure définie dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-159">A manager EPV must contain exactly one entry point (function address) for each procedure defined in the IDL file.</span></span>

<span data-ttu-id="2228b-160">Un serveur doit fournir un EPV non **null** dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="2228b-160">A server must supply a non-**null** EPV in the following cases:</span></span>

-   <span data-ttu-id="2228b-161">Lorsque les noms des routines du gestionnaire diffèrent des noms de procédure déclarés dans la définition de l’interface</span><span class="sxs-lookup"><span data-stu-id="2228b-161">When the names of manager routines differ from the procedure names declared in the interface definition</span></span>
-   <span data-ttu-id="2228b-162">Quand le serveur utilise le EPV par défaut pour inscrire une autre implémentation de l’interface</span><span class="sxs-lookup"><span data-stu-id="2228b-162">When the server uses the default EPV for registering another implementation of the interface</span></span>

<span data-ttu-id="2228b-163">Un serveur déclare un gestionnaire EPV en initialisant une variable de type *si-name \* \* \* \_ Server \_ EPV*\* pour chaque implémentation de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-163">A server declares a manager EPV by initializing a variable of type *if-name\*\*\*\_SERVER\_EPV*\* for each implementation of the interface.</span></span>

## <a name="registering-a-single-implementation-of-an-interface"></a><span data-ttu-id="2228b-164">Inscription d’une implémentation unique d’une interface</span><span class="sxs-lookup"><span data-stu-id="2228b-164">Registering a Single Implementation of an Interface</span></span>

<span data-ttu-id="2228b-165">Lorsqu’un serveur n’offre qu’une seule implémentation d’une interface, le serveur appelle [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) une seule fois.</span><span class="sxs-lookup"><span data-stu-id="2228b-165">When a server offers only one implementation of an interface, the server calls [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) only once.</span></span> <span data-ttu-id="2228b-166">Dans le cas standard, le serveur utilise le EPV Manager par défaut.</span><span class="sxs-lookup"><span data-stu-id="2228b-166">In the standard case, the server uses the default manager EPV.</span></span> <span data-ttu-id="2228b-167">(L’exception est lorsque le gestionnaire utilise des noms de routine qui diffèrent de ceux déclarés dans l’interface.)</span><span class="sxs-lookup"><span data-stu-id="2228b-167">(The exception is when the manager uses routine names that differ from those declared in the interface.)</span></span>

<span data-ttu-id="2228b-168">Pour le cas standard, vous fournissez les valeurs suivantes pour les appels à [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2):</span><span class="sxs-lookup"><span data-stu-id="2228b-168">For the standard case, you supply the following values for calls to [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2):</span></span>

-   <span data-ttu-id="2228b-169">EPVs Manager</span><span class="sxs-lookup"><span data-stu-id="2228b-169">Manager EPVs</span></span>

    <span data-ttu-id="2228b-170">Pour utiliser le EPV par défaut, spécifiez une valeur **null** pour le paramètre *MgrEpv* .</span><span class="sxs-lookup"><span data-stu-id="2228b-170">To use the default EPV, specify a **null** value for the *MgrEpv* a parameter.</span></span>

-   <span data-ttu-id="2228b-171">UUID du type de gestionnaire</span><span class="sxs-lookup"><span data-stu-id="2228b-171">Manager type UUID</span></span>

    <span data-ttu-id="2228b-172">Lorsque vous utilisez le EPV par défaut, inscrivez l’interface avec un UUID de type gestionnaire Nil en fournissant une valeur **null** ou un UUID Nil pour *MgrTypeUuid* un paramètre.</span><span class="sxs-lookup"><span data-stu-id="2228b-172">When using the default EPV, register the interface with a nil manager type UUID by supplying either a **null** value or a nil UUID for the *MgrTypeUuid* a parameter.</span></span> <span data-ttu-id="2228b-173">Dans ce cas, tous les appels de procédure distante, quel que soit l’UUID de l’objet dans leur handle de liaison, sont distribués au EPV par défaut, en supposant qu’aucun appel [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) n’ait été effectué.</span><span class="sxs-lookup"><span data-stu-id="2228b-173">In this case, all remote procedure calls, regardless of the object UUID in their binding handle, are dispatched to the default EPV, assuming no [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) calls have been made.</span></span>

    <span data-ttu-id="2228b-174">Vous pouvez également fournir un UUID de type gestionnaire non Nil.</span><span class="sxs-lookup"><span data-stu-id="2228b-174">You can also provide a non-nil manager type UUID.</span></span> <span data-ttu-id="2228b-175">Dans ce cas, vous devez également appeler la routine [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) .</span><span class="sxs-lookup"><span data-stu-id="2228b-175">In this case, you must also call the [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) routine.</span></span>

## <a name="registering-multiple-implementations-of-an-interface"></a><span data-ttu-id="2228b-176">Inscription de plusieurs implémentations d’une interface</span><span class="sxs-lookup"><span data-stu-id="2228b-176">Registering Multiple Implementations of an Interface</span></span>

<span data-ttu-id="2228b-177">Vous pouvez fournir plusieurs implémentations de la ou des procédures distantes spécifiées dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-177">You can supply more than one implementation of the remote procedure(s) specified in the IDL file.</span></span> <span data-ttu-id="2228b-178">L’application serveur appelle [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) pour mapper les UUID d’objet aux UUID de type et appelle [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) pour associer le gestionnaire EPVs à un UUID de type.</span><span class="sxs-lookup"><span data-stu-id="2228b-178">The server application calls [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) to map object UUIDs to type UUIDs and calls [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) to associate manager EPVs with a type UUID.</span></span> <span data-ttu-id="2228b-179">Lorsqu’un appel de procédure distante arrive avec son UUID d’objet, la bibliothèque Runtime du serveur RPC mappe l’UUID de l’objet à un UUID de type.</span><span class="sxs-lookup"><span data-stu-id="2228b-179">When a remote procedure call arrives with its object UUID, the RPC server run-time library maps the object UUID to a type UUID.</span></span> <span data-ttu-id="2228b-180">L’application serveur utilise ensuite le type UUID et l’UUID de l’interface pour sélectionner le EPV Manager.</span><span class="sxs-lookup"><span data-stu-id="2228b-180">The server application then uses the type UUID and the interface UUID to select the manager EPV.</span></span>

<span data-ttu-id="2228b-181">Vous pouvez également spécifier votre propre fonction pour résoudre le mappage de l’UUID de l’objet à l’UUID du type de gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="2228b-181">You can also specify your own function to resolve the mapping from object UUID to manager type UUID.</span></span> <span data-ttu-id="2228b-182">Vous spécifiez la fonction de mappage lorsque vous appelez [**RpcObjectSetInqFn**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsetinqfn).</span><span class="sxs-lookup"><span data-stu-id="2228b-182">You specify the mapping function when you call [**RpcObjectSetInqFn**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsetinqfn).</span></span>

<span data-ttu-id="2228b-183">Pour offrir plusieurs implémentations d’une interface, un serveur doit inscrire chaque implémentation en appelant [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) séparément.</span><span class="sxs-lookup"><span data-stu-id="2228b-183">To offer multiple implementations of an interface, a server must register each implementation by calling [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) separately.</span></span> <span data-ttu-id="2228b-184">Pour chaque implémentation qu’un serveur inscrit, il fournit le même *IfSpec* un paramètre, mais une autre paire de *MgrTypeUuid* et *MgrEpv* un paramètre.</span><span class="sxs-lookup"><span data-stu-id="2228b-184">For each implementation a server registers, it supplies the same *IfSpec* a parameter, but a different pair of *MgrTypeUuid* and *MgrEpv* a parameters.</span></span>

<span data-ttu-id="2228b-185">Dans le cas de plusieurs gestionnaires, utilisez [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) comme suit :</span><span class="sxs-lookup"><span data-stu-id="2228b-185">In the case of multiple managers, use [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) as follows:</span></span>

-   <span data-ttu-id="2228b-186">EPVs Manager</span><span class="sxs-lookup"><span data-stu-id="2228b-186">Manager EPVs</span></span>

    <span data-ttu-id="2228b-187">Pour offrir plusieurs implémentations d’une interface, un serveur doit :</span><span class="sxs-lookup"><span data-stu-id="2228b-187">To offer multiple implementations of an interface, a server must:</span></span>

    -   <span data-ttu-id="2228b-188">Créez un EPV de gestionnaire non **null** pour chaque implémentation supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="2228b-188">Create a non-**null** manager EPV for each additional implementation.</span></span>
    -   <span data-ttu-id="2228b-189">Spécifiez une valeur non **null** pour *MgrEpv* un paramètre dans [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2).</span><span class="sxs-lookup"><span data-stu-id="2228b-189">Specify a non-**null** value for the *MgrEpv* a parameter in [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2).</span></span>

    <span data-ttu-id="2228b-190">Notez que le serveur peut également s’inscrire auprès du EPV Manager par défaut.</span><span class="sxs-lookup"><span data-stu-id="2228b-190">Please note that the server can also register with the default manager EPV.</span></span>

-   <span data-ttu-id="2228b-191">UUID du type de gestionnaire</span><span class="sxs-lookup"><span data-stu-id="2228b-191">Manager type UUID</span></span>

    <span data-ttu-id="2228b-192">Fournissez un UUID de type de gestionnaire pour chaque EPV de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-192">Provide a manager type UUID for each EPV of the interface.</span></span> <span data-ttu-id="2228b-193">L’UUID du type Nil (ou la valeur **null** ) pour *MgrTypeUuid* un paramètre peut être spécifié pour l’un des EPVs Manager.</span><span class="sxs-lookup"><span data-stu-id="2228b-193">The nil type UUID (or **null** value) for the *MgrTypeUuid* a parameter can be specified for one of the manager EPVs.</span></span> <span data-ttu-id="2228b-194">Chaque UUID de type doit être différent.</span><span class="sxs-lookup"><span data-stu-id="2228b-194">Each type UUID must be different.</span></span>

## <a name="rules-for-invoking-manager-routines"></a><span data-ttu-id="2228b-195">Règles d’appel des routines du gestionnaire</span><span class="sxs-lookup"><span data-stu-id="2228b-195">Rules for Invoking Manager Routines</span></span>

<span data-ttu-id="2228b-196">La bibliothèque Runtime RPC distribue un appel de procédure distante entrant à un responsable qui offre l’interface RPC demandée.</span><span class="sxs-lookup"><span data-stu-id="2228b-196">The RPC run-time library dispatches an incoming remote procedure call to a manager that offers the requested RPC interface.</span></span> <span data-ttu-id="2228b-197">Lorsque plusieurs gestionnaires sont inscrits pour une interface, la bibliothèque Runtime RPC doit en sélectionner une.</span><span class="sxs-lookup"><span data-stu-id="2228b-197">When multiple managers are registered for an interface, the RPC run-time library must select one of them.</span></span> <span data-ttu-id="2228b-198">Pour sélectionner un gestionnaire, la bibliothèque Runtime RPC utilise l’UUID d’objet spécifié par le handle de liaison de l’appel.</span><span class="sxs-lookup"><span data-stu-id="2228b-198">To select a manager, the RPC run-time library uses the object UUID specified by the call's binding handle.</span></span>

<span data-ttu-id="2228b-199">La bibliothèque Runtime applique les règles suivantes lors de l’interprétation de l’UUID de l’objet d’un appel de procédure distante :</span><span class="sxs-lookup"><span data-stu-id="2228b-199">The run-time library applies the following rules when interpreting the object UUID of a remote procedure call:</span></span>

-   <span data-ttu-id="2228b-200">UUID d’objets Nil</span><span class="sxs-lookup"><span data-stu-id="2228b-200">Nil object UUIDs</span></span>

    <span data-ttu-id="2228b-201">L’UUID de type Nil est automatiquement affecté à un UUID d’objet Nil (il est illégal de spécifier un UUID d’objet Nil dans la routine [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) ).</span><span class="sxs-lookup"><span data-stu-id="2228b-201">A nil object UUID is automatically assigned the nil type UUID (it is illegal to specify a nil object UUID in the [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) routine).</span></span> <span data-ttu-id="2228b-202">Par conséquent, un appel de procédure distante dont le handle de liaison contient un UUID d’objet Nil est automatiquement distribué au gestionnaire enregistré avec l’UUID de type Nil, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="2228b-202">Therefore, a remote procedure call whose binding handle contains a nil object UUID is automatically dispatched to the manager registered with the nil type UUID, if any.</span></span>

-   <span data-ttu-id="2228b-203">UUID d’objets non Nil</span><span class="sxs-lookup"><span data-stu-id="2228b-203">Non-nil object UUIDs</span></span>

    <span data-ttu-id="2228b-204">En principe, un appel de procédure distante dont le descripteur de liaison contient un UUID d’objet non Nil doit être traité par un gestionnaire dont le type UUID correspond au type de l’UUID de l’objet.</span><span class="sxs-lookup"><span data-stu-id="2228b-204">In principle, a remote procedure call whose binding handle contains a non-nil object UUID should be processed by a manager whose type UUID matches the type of the object UUID.</span></span> <span data-ttu-id="2228b-205">Toutefois, l’identification du gestionnaire approprié nécessite que le serveur ait spécifié le type de cet UUID d’objet en appelant la routine [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) .</span><span class="sxs-lookup"><span data-stu-id="2228b-205">However, identifying the correct manager requires that the server has specified the type of that object UUID by calling the [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) routine.</span></span>

    <span data-ttu-id="2228b-206">Si un serveur ne parvient pas à appeler la routine [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) pour un UUID d’objet non Nil, un appel de procédure distante pour cet UUID d’objet accède au gestionnaire EPV qui sert les appels de procédure distante avec un UUID d’objet Nil (autrement dit, le type Nil UUID).</span><span class="sxs-lookup"><span data-stu-id="2228b-206">If a server fails to call the [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) routine for a non-nil object UUID, a remote procedure call for that object UUID goes to the manager EPV that services remote procedure calls with a nil object UUID (that is, the nil type UUID).</span></span>

    <span data-ttu-id="2228b-207">Les appels de procédure distante avec un UUID d’objet non Nil dans le handle de liaison ne peuvent pas être exécutés si le serveur affecté à l’UUID d’un objet non Nil est un UUID de type en appelant la routine [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) , mais n’a pas également inscrit un EPV de gestionnaire pour ce type UUID en appelant [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2).</span><span class="sxs-lookup"><span data-stu-id="2228b-207">Remote procedure calls with a non-nil object UUID in the binding handle cannot be executed if the server assigned that non-nil object UUID a type UUID by calling the [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) routine, but did not also register a manager EPV for that type UUID by calling [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2).</span></span>

<span data-ttu-id="2228b-208">Le tableau suivant récapitule les actions que la bibliothèque Runtime utilise pour sélectionner la routine Manager.</span><span class="sxs-lookup"><span data-stu-id="2228b-208">The following table summarizes the actions that the run-time library uses to select the manager routine.</span></span>



| <span data-ttu-id="2228b-209">UUID d’objet de l’appel</span><span class="sxs-lookup"><span data-stu-id="2228b-209">Object UUID of call</span></span> | <span data-ttu-id="2228b-210">Type de l’ensemble de serveurs pour l’UUID de l’objet ?</span><span class="sxs-lookup"><span data-stu-id="2228b-210">Server set type for object UUID?</span></span> | <span data-ttu-id="2228b-211">Type de EPV enregistré sur le serveur ?</span><span class="sxs-lookup"><span data-stu-id="2228b-211">Server registered EPV type?</span></span> | <span data-ttu-id="2228b-212">Action de distribution</span><span class="sxs-lookup"><span data-stu-id="2228b-212">Dispatching action</span></span>                                                                                                                                 |
|---------------------|----------------------------------|-----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2228b-213">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-213">Nil</span></span>                 | <span data-ttu-id="2228b-214">Non applicable</span><span class="sxs-lookup"><span data-stu-id="2228b-214">Not applicable</span></span>                   | <span data-ttu-id="2228b-215">Oui</span><span class="sxs-lookup"><span data-stu-id="2228b-215">Yes</span></span>                         | <span data-ttu-id="2228b-216">Utilise le gestionnaire avec l’UUID de type Nil.</span><span class="sxs-lookup"><span data-stu-id="2228b-216">Uses the manager with the nil type UUID.</span></span>                                                                                                           |
| <span data-ttu-id="2228b-217">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-217">Nil</span></span>                 | <span data-ttu-id="2228b-218">Non applicable</span><span class="sxs-lookup"><span data-stu-id="2228b-218">Not applicable</span></span>                   | <span data-ttu-id="2228b-219">No</span><span class="sxs-lookup"><span data-stu-id="2228b-219">No</span></span>                          | <span data-ttu-id="2228b-220">Error ( \_ type RPC S \_ non pris en charge \_ ); rejette l’appel de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="2228b-220">Error (RPC\_S\_UNSUPPORTED\_TYPE); rejects the remote procedure call.</span></span>                                                                              |
| <span data-ttu-id="2228b-221">Non Nil</span><span class="sxs-lookup"><span data-stu-id="2228b-221">Non-nil</span></span>             | <span data-ttu-id="2228b-222">Oui</span><span class="sxs-lookup"><span data-stu-id="2228b-222">Yes</span></span>                              | <span data-ttu-id="2228b-223">Oui</span><span class="sxs-lookup"><span data-stu-id="2228b-223">Yes</span></span>                         | <span data-ttu-id="2228b-224">Utilise le gestionnaire avec le même UUID de type.</span><span class="sxs-lookup"><span data-stu-id="2228b-224">Uses the manager with the same type UUID.</span></span>                                                                                                          |
| <span data-ttu-id="2228b-225">Non Nil</span><span class="sxs-lookup"><span data-stu-id="2228b-225">Non-nil</span></span>             | <span data-ttu-id="2228b-226">Non </span><span class="sxs-lookup"><span data-stu-id="2228b-226">No</span></span>                               | <span data-ttu-id="2228b-227">Ignoré</span><span class="sxs-lookup"><span data-stu-id="2228b-227">Ignored</span></span>                     | <span data-ttu-id="2228b-228">Utilise le gestionnaire avec l’UUID de type Nil.</span><span class="sxs-lookup"><span data-stu-id="2228b-228">Uses the manager with the nil type UUID.</span></span> <span data-ttu-id="2228b-229">S’il n’existe aucun gestionnaire avec l’UUID de type Nil, Error (RPC \_ S \_ UNSUPPORTEDTYPE); rejette l’appel de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="2228b-229">If no manager with the nil type UUID, error (RPC\_S\_UNSUPPORTEDTYPE); rejects the remote procedure call.</span></span> |
| <span data-ttu-id="2228b-230">Non Nil</span><span class="sxs-lookup"><span data-stu-id="2228b-230">Non-nil</span></span>             | <span data-ttu-id="2228b-231">Oui</span><span class="sxs-lookup"><span data-stu-id="2228b-231">Yes</span></span>                              | <span data-ttu-id="2228b-232">Non</span><span class="sxs-lookup"><span data-stu-id="2228b-232">No</span></span>                          | <span data-ttu-id="2228b-233">Error (RPC \_ S \_ UNSUPPORTEDTYPE); rejette l’appel de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="2228b-233">Error (RPC\_S\_UNSUPPORTEDTYPE); rejects the remote procedure call.</span></span>                                                                                |



 

<span data-ttu-id="2228b-234">L’UUID d’objet de l’appel est l’UUID d’objet trouvé dans un handle de liaison pour un appel de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="2228b-234">The object UUID of the call is the object UUID found in a binding handle for a remote procedure call.</span></span>

<span data-ttu-id="2228b-235">Le serveur définit le type de l’UUID de l’objet en appelant [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) pour spécifier l’UUID de type pour un objet.</span><span class="sxs-lookup"><span data-stu-id="2228b-235">The server sets the type of the object UUID by calling [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) to specify the type UUID for an object.</span></span>

<span data-ttu-id="2228b-236">Le serveur inscrit le type pour le EPV Manager en appelant [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) ou [**RPCSERVERREGISTERIF2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) en utilisant le même UUID de type.</span><span class="sxs-lookup"><span data-stu-id="2228b-236">The server registers the type for the manager EPV by calling [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) using the same type UUID.</span></span>

> [!Note]  
> <span data-ttu-id="2228b-237">L’UUID de l’objet Nil reçoit toujours automatiquement l’UUID de type Nil.</span><span class="sxs-lookup"><span data-stu-id="2228b-237">The nil object UUID is always automatically assigned the nil type UUID.</span></span> <span data-ttu-id="2228b-238">Il est interdit de spécifier un UUID d’objet Nil dans la routine [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) .</span><span class="sxs-lookup"><span data-stu-id="2228b-238">It is illegal to specify a nil object UUID in the [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) routine.</span></span>

 

## <a name="dispatching-a-remote-procedure-call-to-a-server-manager-routine"></a><span data-ttu-id="2228b-239">Distribution d’un appel de procédure distante à une routine de gestion de serveur</span><span class="sxs-lookup"><span data-stu-id="2228b-239">Dispatching a Remote Procedure Call to a Server-manager Routine</span></span>

<span data-ttu-id="2228b-240">Les tableaux suivants présentent les étapes que prend la bibliothèque Runtime RPC pour distribuer un appel de procédure distante à une routine de gestionnaire de serveur.</span><span class="sxs-lookup"><span data-stu-id="2228b-240">The following tables show the steps that the RPC run-time library takes to dispatch a remote procedure call to a server-manager routine.</span></span>

<span data-ttu-id="2228b-241">Un cas simple où le serveur enregistre le EPV Manager par défaut, est décrit dans les tableaux suivants.</span><span class="sxs-lookup"><span data-stu-id="2228b-241">A simple case where the server registers the default manager EPV, is described in the following tables.</span></span>

<span data-ttu-id="2228b-242">**Table de registre de l’interface**</span><span class="sxs-lookup"><span data-stu-id="2228b-242">**Interface Registry Table**</span></span>



| <span data-ttu-id="2228b-243">UUID de l’interface</span><span class="sxs-lookup"><span data-stu-id="2228b-243">Interface UUID</span></span> | <span data-ttu-id="2228b-244">UUID du type de gestionnaire</span><span class="sxs-lookup"><span data-stu-id="2228b-244">Manager type UUID</span></span> | <span data-ttu-id="2228b-245">Vecteur de point d’entrée</span><span class="sxs-lookup"><span data-stu-id="2228b-245">Entry-point vector</span></span> |
|----------------|-------------------|--------------------|
| <span data-ttu-id="2228b-246">*uuid1*</span><span class="sxs-lookup"><span data-stu-id="2228b-246">*uuid1*</span></span>        | <span data-ttu-id="2228b-247">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-247">Nil</span></span>               | <span data-ttu-id="2228b-248">EPV par défaut</span><span class="sxs-lookup"><span data-stu-id="2228b-248">Default EPV</span></span>        |



 

<span data-ttu-id="2228b-249">**Table de registre des objets**</span><span class="sxs-lookup"><span data-stu-id="2228b-249">**Object Registry Table**</span></span>



| <span data-ttu-id="2228b-250">UUID de l’objet</span><span class="sxs-lookup"><span data-stu-id="2228b-250">Object UUID</span></span>             | <span data-ttu-id="2228b-251">Type d'objet</span><span class="sxs-lookup"><span data-stu-id="2228b-251">Object type</span></span> |
|-------------------------|-------------|
| <span data-ttu-id="2228b-252">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-252">Nil</span></span>                     | <span data-ttu-id="2228b-253">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-253">Nil</span></span>         |
| <span data-ttu-id="2228b-254">(Tout autre UUID d’objet)</span><span class="sxs-lookup"><span data-stu-id="2228b-254">(Any other object UUID)</span></span> | <span data-ttu-id="2228b-255">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-255">Nil</span></span>         |



 

<span data-ttu-id="2228b-256">**Mappage du handle de liaison à un vecteur de point d’entrée (EPV)**</span><span class="sxs-lookup"><span data-stu-id="2228b-256">**Mapping the Binding Handle to an Entry-point Vector (EPV)**</span></span>



| <span data-ttu-id="2228b-257">UUID de l’interface (à partir du handle de liaison client)</span><span class="sxs-lookup"><span data-stu-id="2228b-257">Interface UUID (from client binding handle)</span></span> | <span data-ttu-id="2228b-258">UUID d’objet (à partir du handle de liaison client)</span><span class="sxs-lookup"><span data-stu-id="2228b-258">Object UUID (from client binding handle)</span></span> | <span data-ttu-id="2228b-259">Type d’objet (à partir de la table de registre des objets)</span><span class="sxs-lookup"><span data-stu-id="2228b-259">Object type (from object registry table)</span></span> | <span data-ttu-id="2228b-260">Manager EPV (à partir de la table de registre de l’interface)</span><span class="sxs-lookup"><span data-stu-id="2228b-260">Manager EPV (from interface registry table)</span></span> |
|---------------------------------------------|------------------------------------------|------------------------------------------|---------------------------------------------|
| <span data-ttu-id="2228b-261">*uuid1*</span><span class="sxs-lookup"><span data-stu-id="2228b-261">*uuid1*</span></span>                                     | <span data-ttu-id="2228b-262">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-262">Nil</span></span>                                      | <span data-ttu-id="2228b-263">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-263">Nil</span></span>                                      | <span data-ttu-id="2228b-264">EPV par défaut</span><span class="sxs-lookup"><span data-stu-id="2228b-264">Default EPV</span></span>                                 |
| <span data-ttu-id="2228b-265">Identique à ce qui précède</span><span class="sxs-lookup"><span data-stu-id="2228b-265">Same as above</span></span>                               | <span data-ttu-id="2228b-266">*UUID*</span><span class="sxs-lookup"><span data-stu-id="2228b-266">*uuidA*</span></span>                                  | <span data-ttu-id="2228b-267">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-267">Nil</span></span>                                      | <span data-ttu-id="2228b-268">EPV par défaut</span><span class="sxs-lookup"><span data-stu-id="2228b-268">Default EPV</span></span>                                 |



 

<span data-ttu-id="2228b-269">Les étapes suivantes décrivent les actions que la bibliothèque Runtime du serveur RPC prend, comme indiqué dans les tableaux précédents, lorsqu’un client avec l’interface UUID *uuid1* l’appelle.</span><span class="sxs-lookup"><span data-stu-id="2228b-269">The following steps describe the actions that the RPC server's run-time library take, as shown in the preceding tables, when a client with interface UUID *uuid1* calls it.</span></span>

1.  <span data-ttu-id="2228b-270">Le serveur appelle [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) pour associer une interface qu’il propose avec l’UUID de type Manager Nil et avec le EPV du gestionnaire par défaut généré par MIDL.</span><span class="sxs-lookup"><span data-stu-id="2228b-270">The server calls [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) to associate an interface it offers with the nil manager type UUID and with the MIDL-generated default manager EPV.</span></span> <span data-ttu-id="2228b-271">Cet appel ajoute une entrée dans la table de registre de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-271">This call adds an entry in the interface registry table.</span></span> <span data-ttu-id="2228b-272">L’UUID de l’interface est contenu dans le paramètre *IfSpec* a.</span><span class="sxs-lookup"><span data-stu-id="2228b-272">The interface UUID is contained in the *IfSpec* a parameter.</span></span>
2.  <span data-ttu-id="2228b-273">Par défaut, la table de registre des objets associe tous les UUID d’objets à l’UUID de type Nil.</span><span class="sxs-lookup"><span data-stu-id="2228b-273">By default, the object registry table associates all object UUIDs with the nil type UUID.</span></span> <span data-ttu-id="2228b-274">Dans cet exemple, le serveur n’appelle pas [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype).</span><span class="sxs-lookup"><span data-stu-id="2228b-274">In this example, the server does not call [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype).</span></span>
3.  <span data-ttu-id="2228b-275">La bibliothèque Runtime du serveur reçoit un code de procédure distante contenant l’UUID de l’interface auquel appartient l’appel et l’UUID de l’objet à partir du handle de liaison de l’appel.</span><span class="sxs-lookup"><span data-stu-id="2228b-275">The server run-time library receives a remote procedure code containing the interface UUID that the call belongs to and the object UUID from the call's binding handle.</span></span>

    <span data-ttu-id="2228b-276">Pour connaître la façon dont l’UUID d’un objet est défini dans un handle de liaison, consultez les entrées de référence de fonction suivantes :</span><span class="sxs-lookup"><span data-stu-id="2228b-276">See the following function reference entries for discussions of how an object UUID is set into a binding handle:</span></span>

    -   [<span data-ttu-id="2228b-277">**RpcNsBindingImportBegin**</span><span class="sxs-lookup"><span data-stu-id="2228b-277">**RpcNsBindingImportBegin**</span></span>](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindingimportbegina)
    -   [<span data-ttu-id="2228b-278">**RpcNsBindingLookupBegin**</span><span class="sxs-lookup"><span data-stu-id="2228b-278">**RpcNsBindingLookupBegin**</span></span>](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindinglookupbegina)
    -   [<span data-ttu-id="2228b-279">**RpcBindingFromStringBinding**</span><span class="sxs-lookup"><span data-stu-id="2228b-279">**RpcBindingFromStringBinding**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingfromstringbinding)
    -   [<span data-ttu-id="2228b-280">**RpcBindingSetObject**</span><span class="sxs-lookup"><span data-stu-id="2228b-280">**RpcBindingSetObject**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetobject)

4.  <span data-ttu-id="2228b-281">À l’aide de l’UUID de l’interface de l’appel de procédure distante, la bibliothèque Runtime du serveur localise cet UUID d’interface dans la table de registre de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-281">Using the interface UUID from the remote procedure call, the server's run-time library locates that interface UUID in the interface registry table.</span></span>

    <span data-ttu-id="2228b-282">Si le serveur n’a pas inscrit l’interface à l’aide de [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2), l’appel de procédure distante retourne à l’appelant avec un RPC \_ \_ Unknown \_ si le code d’État.</span><span class="sxs-lookup"><span data-stu-id="2228b-282">If the server did not register the interface using [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2), then the remote procedure call returns to the caller with an RPC\_S\_UNKNOWN\_IF status code.</span></span>

5.  <span data-ttu-id="2228b-283">À l’aide de l’UUID d’objet du handle de liaison, la bibliothèque Runtime du serveur localise cet UUID d’objet dans la table de registre des objets.</span><span class="sxs-lookup"><span data-stu-id="2228b-283">Using the object UUID from the binding handle, the server's run-time library locates that object UUID in the object registry table.</span></span> <span data-ttu-id="2228b-284">Dans cet exemple, tous les UUID d’objets sont mappés au type d’objet Nil.</span><span class="sxs-lookup"><span data-stu-id="2228b-284">In this example, all object UUIDs map to the nil object type.</span></span>
6.  <span data-ttu-id="2228b-285">La bibliothèque Runtime du serveur localise le type de gestionnaire Nil dans la table de registre de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-285">The server's run-time library locates the nil manager type in the interface registry table.</span></span>
7.  <span data-ttu-id="2228b-286">La combinaison de l’UUID d’interface et du type Nil dans la table de registre de l’interface correspond à la valeur par défaut de EPV, qui contient les routines du gestionnaire de serveur à exécuter pour l’UUID d’interface figurant dans l’appel de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="2228b-286">Combining the interface UUID and nil type in the interface registry table resolves to the default EPV, which contains the server-manager routines to be executed for the interface UUID found in the remote procedure call.</span></span>

<span data-ttu-id="2228b-287">Supposons que le serveur offre plusieurs interfaces et plusieurs implémentations de chaque interface, comme décrit dans les tableaux suivants.</span><span class="sxs-lookup"><span data-stu-id="2228b-287">Assume that the server offers multiple interfaces and multiple implementations of each interface, as described in the following tables.</span></span>

<span data-ttu-id="2228b-288">**Table de registre de l’interface**</span><span class="sxs-lookup"><span data-stu-id="2228b-288">**Interface Registry Table**</span></span>



| <span data-ttu-id="2228b-289">UUID de l’interface</span><span class="sxs-lookup"><span data-stu-id="2228b-289">Interface UUID</span></span> | <span data-ttu-id="2228b-290">UUID de type responsable</span><span class="sxs-lookup"><span data-stu-id="2228b-290">Manager-type UUID</span></span> | <span data-ttu-id="2228b-291">Vecteur de point d’entrée</span><span class="sxs-lookup"><span data-stu-id="2228b-291">Entry-point vector</span></span> |
|----------------|-------------------|--------------------|
| <span data-ttu-id="2228b-292">*uuid1*</span><span class="sxs-lookup"><span data-stu-id="2228b-292">*uuid1*</span></span>        | <span data-ttu-id="2228b-293">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-293">Nil</span></span>               | <span data-ttu-id="2228b-294">*epv1*</span><span class="sxs-lookup"><span data-stu-id="2228b-294">*epv1*</span></span>             |
| <span data-ttu-id="2228b-295">*uuid1*</span><span class="sxs-lookup"><span data-stu-id="2228b-295">*uuid1*</span></span>        | <span data-ttu-id="2228b-296">*uuid3*</span><span class="sxs-lookup"><span data-stu-id="2228b-296">*uuid3*</span></span>           | <span data-ttu-id="2228b-297">*epv4*</span><span class="sxs-lookup"><span data-stu-id="2228b-297">*epv4*</span></span>             |
| <span data-ttu-id="2228b-298">*uuid2*</span><span class="sxs-lookup"><span data-stu-id="2228b-298">*uuid2*</span></span>        | <span data-ttu-id="2228b-299">*uuid4*</span><span class="sxs-lookup"><span data-stu-id="2228b-299">*uuid4*</span></span>           | <span data-ttu-id="2228b-300">*epv2*</span><span class="sxs-lookup"><span data-stu-id="2228b-300">*epv2*</span></span>             |
| <span data-ttu-id="2228b-301">*uuid2*</span><span class="sxs-lookup"><span data-stu-id="2228b-301">*uuid2*</span></span>        | <span data-ttu-id="2228b-302">*uuid7*</span><span class="sxs-lookup"><span data-stu-id="2228b-302">*uuid7*</span></span>           | <span data-ttu-id="2228b-303">*epv3*</span><span class="sxs-lookup"><span data-stu-id="2228b-303">*epv3*</span></span>             |



 

<span data-ttu-id="2228b-304">**Table de registre des objets**</span><span class="sxs-lookup"><span data-stu-id="2228b-304">**Object Registry Table**</span></span>



| <span data-ttu-id="2228b-305">UUID de l’objet</span><span class="sxs-lookup"><span data-stu-id="2228b-305">Object UUID</span></span>      | <span data-ttu-id="2228b-306">Type d'objet</span><span class="sxs-lookup"><span data-stu-id="2228b-306">Object type</span></span> |
|------------------|-------------|
| <span data-ttu-id="2228b-307">*UUID*</span><span class="sxs-lookup"><span data-stu-id="2228b-307">*uuidA*</span></span>          | <span data-ttu-id="2228b-308">*uuid3*</span><span class="sxs-lookup"><span data-stu-id="2228b-308">*uuid3*</span></span>     |
| <span data-ttu-id="2228b-309">*uuidB*</span><span class="sxs-lookup"><span data-stu-id="2228b-309">*uuidB*</span></span>          | <span data-ttu-id="2228b-310">*uuid7*</span><span class="sxs-lookup"><span data-stu-id="2228b-310">*uuid7*</span></span>     |
| <span data-ttu-id="2228b-311">*uuidC*</span><span class="sxs-lookup"><span data-stu-id="2228b-311">*uuidC*</span></span>          | <span data-ttu-id="2228b-312">*uuid7*</span><span class="sxs-lookup"><span data-stu-id="2228b-312">*uuid7*</span></span>     |
| <span data-ttu-id="2228b-313">*UUID*</span><span class="sxs-lookup"><span data-stu-id="2228b-313">*uuidD*</span></span>          | <span data-ttu-id="2228b-314">*uuid3*</span><span class="sxs-lookup"><span data-stu-id="2228b-314">*uuid3*</span></span>     |
| <span data-ttu-id="2228b-315">*UUID*</span><span class="sxs-lookup"><span data-stu-id="2228b-315">*uuidE*</span></span>          | <span data-ttu-id="2228b-316">*uuid3*</span><span class="sxs-lookup"><span data-stu-id="2228b-316">*uuid3*</span></span>     |
| <span data-ttu-id="2228b-317">*uuidF*</span><span class="sxs-lookup"><span data-stu-id="2228b-317">*uuidF*</span></span>          | <span data-ttu-id="2228b-318">*uuid8*</span><span class="sxs-lookup"><span data-stu-id="2228b-318">*uuid8*</span></span>     |
| <span data-ttu-id="2228b-319">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-319">Nil</span></span>              | <span data-ttu-id="2228b-320">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-320">Nil</span></span>         |
| <span data-ttu-id="2228b-321">(Tout autre UUID)</span><span class="sxs-lookup"><span data-stu-id="2228b-321">(Any other UUID)</span></span> | <span data-ttu-id="2228b-322">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-322">Nil</span></span>         |



 

<span data-ttu-id="2228b-323">**Mappage du handle de liaison à un vecteur de point d’entrée**</span><span class="sxs-lookup"><span data-stu-id="2228b-323">**Mapping the Binding Handle to an Entry-point Vector**</span></span>



| <span data-ttu-id="2228b-324">UUID de l’interface (à partir du handle de liaison client)</span><span class="sxs-lookup"><span data-stu-id="2228b-324">Interface UUID (from client binding handle)</span></span> | <span data-ttu-id="2228b-325">UUID d’objet (à partir du handle de liaison client)</span><span class="sxs-lookup"><span data-stu-id="2228b-325">Object UUID (from client binding handle)</span></span> | <span data-ttu-id="2228b-326">Type d’objet (à partir de la table de registre des objets)</span><span class="sxs-lookup"><span data-stu-id="2228b-326">Object type (from object registry table)</span></span> | <span data-ttu-id="2228b-327">Manager EPV (à partir de la table de registre de l’interface)</span><span class="sxs-lookup"><span data-stu-id="2228b-327">Manager EPV (from interface registry table)</span></span> |
|---------------------------------------------|------------------------------------------|------------------------------------------|---------------------------------------------|
| <span data-ttu-id="2228b-328">*uuid1*</span><span class="sxs-lookup"><span data-stu-id="2228b-328">*uuid1*</span></span>                                     | <span data-ttu-id="2228b-329">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-329">Nil</span></span>                                      | <span data-ttu-id="2228b-330">Pli</span><span class="sxs-lookup"><span data-stu-id="2228b-330">Nil</span></span>                                      | <span data-ttu-id="2228b-331">*epv1*</span><span class="sxs-lookup"><span data-stu-id="2228b-331">*epv1*</span></span>                                      |
| <span data-ttu-id="2228b-332">*uuid1*</span><span class="sxs-lookup"><span data-stu-id="2228b-332">*uuid1*</span></span>                                     | <span data-ttu-id="2228b-333">*UUID*</span><span class="sxs-lookup"><span data-stu-id="2228b-333">*uuidA*</span></span>                                  | <span data-ttu-id="2228b-334">*uuid3*</span><span class="sxs-lookup"><span data-stu-id="2228b-334">*uuid3*</span></span>                                  | <span data-ttu-id="2228b-335">*epv4*</span><span class="sxs-lookup"><span data-stu-id="2228b-335">*epv4*</span></span>                                      |
| <span data-ttu-id="2228b-336">*uuid1*</span><span class="sxs-lookup"><span data-stu-id="2228b-336">*uuid1*</span></span>                                     | <span data-ttu-id="2228b-337">*UUID*</span><span class="sxs-lookup"><span data-stu-id="2228b-337">*uuidD*</span></span>                                  | <span data-ttu-id="2228b-338">*uuid3*</span><span class="sxs-lookup"><span data-stu-id="2228b-338">*uuid3*</span></span>                                  | <span data-ttu-id="2228b-339">*epv4*</span><span class="sxs-lookup"><span data-stu-id="2228b-339">*epv4*</span></span>                                      |
| <span data-ttu-id="2228b-340">*uuid1*</span><span class="sxs-lookup"><span data-stu-id="2228b-340">*uuid1*</span></span>                                     | <span data-ttu-id="2228b-341">*UUID*</span><span class="sxs-lookup"><span data-stu-id="2228b-341">*uuidE*</span></span>                                  | <span data-ttu-id="2228b-342">*uuid3*</span><span class="sxs-lookup"><span data-stu-id="2228b-342">*uuid3*</span></span>                                  | <span data-ttu-id="2228b-343">*epv4*</span><span class="sxs-lookup"><span data-stu-id="2228b-343">*epv4*</span></span>                                      |
| <span data-ttu-id="2228b-344">*uuid2*</span><span class="sxs-lookup"><span data-stu-id="2228b-344">*uuid2*</span></span>                                     | <span data-ttu-id="2228b-345">*uuidB*</span><span class="sxs-lookup"><span data-stu-id="2228b-345">*uuidB*</span></span>                                  | <span data-ttu-id="2228b-346">*uuid7*</span><span class="sxs-lookup"><span data-stu-id="2228b-346">*uuid7*</span></span>                                  | <span data-ttu-id="2228b-347">*epv3*</span><span class="sxs-lookup"><span data-stu-id="2228b-347">*epv3*</span></span>                                      |
| <span data-ttu-id="2228b-348">*uuid2*</span><span class="sxs-lookup"><span data-stu-id="2228b-348">*uuid2*</span></span>                                     | <span data-ttu-id="2228b-349">*uuidC*</span><span class="sxs-lookup"><span data-stu-id="2228b-349">*uuidC*</span></span>                                  | <span data-ttu-id="2228b-350">*uuid7*</span><span class="sxs-lookup"><span data-stu-id="2228b-350">*uuid7*</span></span>                                  | <span data-ttu-id="2228b-351">*epv3*</span><span class="sxs-lookup"><span data-stu-id="2228b-351">*epv3*</span></span>                                      |



 

<span data-ttu-id="2228b-352">Les étapes suivantes décrivent les actions effectuées par la bibliothèque Runtime du serveur, comme indiqué dans les tableaux précédents, lorsqu’un client avec l’interface UUID *uuid2* et l’UUID d’objet *uuidC* l’appelle.</span><span class="sxs-lookup"><span data-stu-id="2228b-352">The following steps describe the actions that the server's run-time library take, as shown in the preceding tables when a client with interface UUID *uuid2* and object UUID *uuidC* calls it.</span></span>

1.  <span data-ttu-id="2228b-353">Le serveur appelle [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) pour associer les interfaces qu’il offre aux différents EPVs Manager.</span><span class="sxs-lookup"><span data-stu-id="2228b-353">The server calls [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) to associate the interfaces it offers with the different manager EPVs.</span></span> <span data-ttu-id="2228b-354">Les entrées de la table de registre de l’interface reflètent quatre appels de [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) pour offrir deux interfaces, avec deux implémentations (EPVs) pour chaque interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-354">The entries in the interface registry table reflect four calls of [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) to offer two interfaces, with two implementations (EPVs) for each interface.</span></span>
2.  <span data-ttu-id="2228b-355">Le serveur appelle [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) pour établir le type de chaque objet qu’il propose.</span><span class="sxs-lookup"><span data-stu-id="2228b-355">The server calls [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) to establish the type of each object it offers.</span></span> <span data-ttu-id="2228b-356">En plus de l’Association par défaut de l’objet Nil à un type Nil, tous les autres UUID d’objets qui ne se trouvent pas explicitement dans la table de registre des objets sont également mappés à l’UUID de type Nil.</span><span class="sxs-lookup"><span data-stu-id="2228b-356">In addition to the default association of the nil object to a nil type, all other object UUIDs not explicitly found in the object registry table also map to the nil type UUID.</span></span>

    <span data-ttu-id="2228b-357">Dans cet exemple, le serveur appelle la routine [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) six fois.</span><span class="sxs-lookup"><span data-stu-id="2228b-357">In this example, the server calls the [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) routine six times.</span></span>

3.  <span data-ttu-id="2228b-358">La bibliothèque Runtime du serveur reçoit un appel de procédure distante contenant l’UUID d’interface auquel appartient l’appel et un UUID d’objet à partir du handle de liaison de l’appel.</span><span class="sxs-lookup"><span data-stu-id="2228b-358">The server run-time library receives a remote procedure call containing the interface UUID that the call belongs to and an object UUID from the call's binding handle.</span></span>
4.  <span data-ttu-id="2228b-359">À l’aide de l’UUID de l’interface de l’appel de procédure distante, la bibliothèque Runtime du serveur localise l’UUID de l’interface dans la table de registre de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-359">Using the interface UUID from the remote procedure call, the server's run-time library locates the interface UUID in the interface registry table.</span></span>
5.  <span data-ttu-id="2228b-360">À l’aide de l’UUID de l’objet *uuidC* du handle de liaison, la bibliothèque Runtime du serveur localise l’UUID de l’objet dans la table de registre des objets et trouve qu’il est mappé au type *uuid7*.</span><span class="sxs-lookup"><span data-stu-id="2228b-360">Using the *uuidC* object UUID from the binding handle, the server's run-time library locates the object UUID in the object registry table and finds that it maps to type *uuid7*.</span></span>
6.  <span data-ttu-id="2228b-361">Pour localiser le type de gestionnaire, la bibliothèque Runtime du serveur combine l’UUID d’interface, *uuid2*, et le type *uuid7* dans la table de registre de l’interface.</span><span class="sxs-lookup"><span data-stu-id="2228b-361">To locate the manager type, the server's run-time library combines the interface UUID, *uuid2*, and type *uuid7* in the interface registry table.</span></span> <span data-ttu-id="2228b-362">Cela correspond à *ePv3*, qui contient la routine du gestionnaire de serveur à exécuter pour l’appel de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="2228b-362">This resolves to *epv3*, which contains the server manager routine to be executed for the remote procedure call.</span></span>

<span data-ttu-id="2228b-363">Les routines dans *epv2* ne seront jamais exécutées, car le serveur n’a pas appelé la routine [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) pour ajouter des objets avec un UUID de type *uuid4* à la table de registre des objets.</span><span class="sxs-lookup"><span data-stu-id="2228b-363">The routines in *epv2* will never be executed because the server has not called the [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) routine to add any objects with a type UUID of *uuid4* to the object registry table.</span></span>

<span data-ttu-id="2228b-364">Un appel de procédure distante avec l’interface UUID *uuid2* et l’UUID d’objet *uuidF* retourne à l’appelant avec un \_ code d’état de \_ type Mgr Unknown RPC, \_ \_ car le serveur n’a pas appelé [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)ou [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) pour inscrire l’interface avec un type de gestionnaire *uuid8*.</span><span class="sxs-lookup"><span data-stu-id="2228b-364">A remote procedure call with interface UUID *uuid2* and object UUID *uuidF* returns to the caller with an RPC\_S\_UNKNOWN\_MGR\_TYPE status code because the server did not call [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif), [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex), or [**RpcServerRegisterIf2**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2) to register the interface with a manager type of *uuid8*.</span></span>

## <a name="return-values"></a><span data-ttu-id="2228b-365">Valeurs de retour</span><span class="sxs-lookup"><span data-stu-id="2228b-365">Return Values</span></span>

<span data-ttu-id="2228b-366">Cette fonction retourne l’une des valeurs suivantes.</span><span class="sxs-lookup"><span data-stu-id="2228b-366">This function returns one of the following values.</span></span>



| <span data-ttu-id="2228b-367">Valeur</span><span class="sxs-lookup"><span data-stu-id="2228b-367">Value</span></span>                             | <span data-ttu-id="2228b-368">Signification</span><span class="sxs-lookup"><span data-stu-id="2228b-368">Meaning</span></span>                      |
|-----------------------------------|------------------------------|
| <span data-ttu-id="2228b-369">RPC \_ S \_ OK</span><span class="sxs-lookup"><span data-stu-id="2228b-369">RPC\_S\_OK</span></span>                        | <span data-ttu-id="2228b-370">Succès</span><span class="sxs-lookup"><span data-stu-id="2228b-370">Success</span></span>                      |
| <span data-ttu-id="2228b-371">\_type RPC \_ S \_ déjà \_ inscrit</span><span class="sxs-lookup"><span data-stu-id="2228b-371">RPC\_S\_TYPE\_ALREADY\_REGISTERED</span></span> | <span data-ttu-id="2228b-372">UUID de type déjà inscrit</span><span class="sxs-lookup"><span data-stu-id="2228b-372">Type UUID already registered</span></span> |



 

## <a name="supplying-your-own-object-inquiry-function"></a><span data-ttu-id="2228b-373">Fournir votre propre fonction de recherche d’objets</span><span class="sxs-lookup"><span data-stu-id="2228b-373">Supplying Your Own Object-inquiry Function</span></span>

<span data-ttu-id="2228b-374">Imaginez un serveur qui gère des milliers d’objets de nombreux types différents.</span><span class="sxs-lookup"><span data-stu-id="2228b-374">Consider a server that manages thousands of objects of many different types.</span></span> <span data-ttu-id="2228b-375">Chaque fois que le serveur a démarré, l’application serveur doit appeler la fonction [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) pour chacun des objets, même si les clients ne peuvent faire référence qu’à quelques-uns d’entre eux (ou prendre beaucoup de temps pour y faire référence).</span><span class="sxs-lookup"><span data-stu-id="2228b-375">Whenever the server started, the server application would have to call the function [**RpcObjectSetType**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype) for every one of the objects, even though clients might refer to only a few of them (or take a long time to refer to them).</span></span> <span data-ttu-id="2228b-376">Ces milliers d’objets sont susceptibles d’être sur le disque, donc la récupération de leurs types prendrait beaucoup de temps.</span><span class="sxs-lookup"><span data-stu-id="2228b-376">These thousands of objects are likely to be on disk, so retrieving their types would be time consuming.</span></span> <span data-ttu-id="2228b-377">En outre, la table interne qui mappe l’UUID de l’objet à l’UUID du type de gestionnaire dupliquerait essentiellement le mappage géré avec les objets eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="2228b-377">Also, the internal table that is mapping the object UUID to the manager type UUID would essentially duplicate the mapping maintained with the objects themselves.</span></span>

<span data-ttu-id="2228b-378">Pour plus de commodité, l’ensemble de fonctions RPC comprend la fonction [**RpcObjectSetInqFn**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsetinqfn).</span><span class="sxs-lookup"><span data-stu-id="2228b-378">For convenience, the RPC function set includes the function [**RpcObjectSetInqFn**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsetinqfn).</span></span> <span data-ttu-id="2228b-379">Avec cette fonction, vous fournissez votre propre fonction d’interrogation d’objet.</span><span class="sxs-lookup"><span data-stu-id="2228b-379">With this function, you provide your own object-inquiry function.</span></span>

<span data-ttu-id="2228b-380">Par exemple, vous pouvez fournir votre propre fonction de recherche d’objets lorsque vous mappez des objets 100 à 199 au type nombre 1, 200 – 299 au type numéro 2, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="2228b-380">As an example, you can supply your own object-inquiry function when you map objects 100–199 to type number 1, 200–299 to type number 2, and so on.</span></span> <span data-ttu-id="2228b-381">La fonction de recherche d’objets peut également être étendue à un système de fichiers distribués, où l’application serveur n’a pas de liste de tous les fichiers (UUID d’objets) disponibles, ou lorsque les UUID d’objet nomment les fichiers dans le système de fichiers et que vous ne souhaitez pas précharger tous les mappages entre les UUID d’objet et les UUID de type.</span><span class="sxs-lookup"><span data-stu-id="2228b-381">The object inquiry function can also be extended to a distributed file system, where the server application does not have a list of all the files (object UUIDs) available, or when object UUIDs name files in the file system and you do not want to preload all of the mappings between object UUIDs and type UUIDs.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2228b-382">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="2228b-382">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2228b-383">**RpcBindingFromStringBinding**</span><span class="sxs-lookup"><span data-stu-id="2228b-383">**RpcBindingFromStringBinding**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingfromstringbinding)
</dt> <dt>

[<span data-ttu-id="2228b-384">**RpcBindingSetObject**</span><span class="sxs-lookup"><span data-stu-id="2228b-384">**RpcBindingSetObject**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetobject)
</dt> <dt>

[<span data-ttu-id="2228b-385">**RpcNsBindingExport**</span><span class="sxs-lookup"><span data-stu-id="2228b-385">**RpcNsBindingExport**</span></span>](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindingexporta)
</dt> <dt>

[<span data-ttu-id="2228b-386">**RpcNsBindingImportBegin**</span><span class="sxs-lookup"><span data-stu-id="2228b-386">**RpcNsBindingImportBegin**</span></span>](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindingimportbegina)
</dt> <dt>

[<span data-ttu-id="2228b-387">**RpcNsBindingLookupBegin**</span><span class="sxs-lookup"><span data-stu-id="2228b-387">**RpcNsBindingLookupBegin**</span></span>](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindinglookupbegina)
</dt> <dt>

[<span data-ttu-id="2228b-388">**RpcObjectSetType**</span><span class="sxs-lookup"><span data-stu-id="2228b-388">**RpcObjectSetType**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcobjectsettype)
</dt> <dt>

[<span data-ttu-id="2228b-389">**RpcServerRegisterIf**</span><span class="sxs-lookup"><span data-stu-id="2228b-389">**RpcServerRegisterIf**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif)
</dt> <dt>

[<span data-ttu-id="2228b-390">**RpcServerRegisterIf2**</span><span class="sxs-lookup"><span data-stu-id="2228b-390">**RpcServerRegisterIf2**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif2)
</dt> <dt>

[<span data-ttu-id="2228b-391">**RpcServerRegisterIfEx**</span><span class="sxs-lookup"><span data-stu-id="2228b-391">**RpcServerRegisterIfEx**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex)
</dt> <dt>

[<span data-ttu-id="2228b-392">**RpcServerUnregisterIf**</span><span class="sxs-lookup"><span data-stu-id="2228b-392">**RpcServerUnregisterIf**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverunregisterif)
</dt> <dt>

[<span data-ttu-id="2228b-393">**RpcServerUnregisterIfEx**</span><span class="sxs-lookup"><span data-stu-id="2228b-393">**RpcServerUnregisterIfEx**</span></span>](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverunregisterifex)
</dt> </dl>

 

 




