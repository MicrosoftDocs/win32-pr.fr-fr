---
title: La théorie de la gestion des versions pour RPC et COM
description: Théorie de la gestion des versions pour l’appel de procédure distante (RPC) et COM.
ms.assetid: c4df0a7b-e1be-481d-9149-317ffc9179b9
keywords:
- RPC appel de procédure distante, meilleures pratiques, contrôle de version
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e03b23c91bf69fbc3c4f72366b80812fd54330d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104102117"
---
# <a name="the-versioning-theory-for-rpc-and-com"></a><span data-ttu-id="3f2e2-104">La théorie de la gestion des versions pour RPC et COM</span><span class="sxs-lookup"><span data-stu-id="3f2e2-104">The Versioning Theory for RPC and COM</span></span>

<span data-ttu-id="3f2e2-105">Seules deux méthodes entièrement infaillibles prennent en charge de nouvelles fonctionnalités sans risque de problèmes de compatibilité de câble :</span><span class="sxs-lookup"><span data-stu-id="3f2e2-105">Only two completely foolproof methods support new functionality without risk of wire compatibility problems:</span></span>

-   <span data-ttu-id="3f2e2-106">Modifiez la version de l’interface en fonction des règles. Cela empêche les nouveaux clients de communiquer avec un ancien serveur et peut ou non empêcher un ancien client de communiquer avec le nouveau serveur.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-106">Change the interface version according to the rules; this prevents new clients from communicating with an old server, and may or may not prevent an old client from communicating with the new server.</span></span> <span data-ttu-id="3f2e2-107">Cela est clarifié plus loin dans cette section.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-107">This is clarified later in this section.</span></span>
-   <span data-ttu-id="3f2e2-108">Introduisez une autre interface pour traiter les nouvelles fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-108">Introduce a different interface dealing with the new functionality.</span></span>

<span data-ttu-id="3f2e2-109">Une interface RPC standard est identifiée par un GUID et une combinaison de numéros de version ; une interface COM est identifiée par son GUID.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-109">A standard RPC interface is identified by a GUID and version number combination; a COM interface is identified by its GUID.</span></span> <span data-ttu-id="3f2e2-110">La version comprend des parties majeures et secondaires.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-110">The version consists of major and minor parts.</span></span> <span data-ttu-id="3f2e2-111">Pour les interfaces standard avec le même GUID et les numéros de version différents, une connexion est possible uniquement lorsque la version principale est la même, et que le client n’est pas supérieur à la version mineure du serveur.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-111">For standard interfaces with the same GUID and different version numbers, a connection is possible only when the major version is the same, and the client is not higher than the minor version of the server.</span></span>

<span data-ttu-id="3f2e2-112">En conséquence, la modification du GUID de l’interface RPC interrompt la compatibilité des câbles, contrairement à la modification du nom de l’interface.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-112">A consequence is that changing the RPC interface GUID breaks wire compatibility, while changing the interface name does not.</span></span>

<span data-ttu-id="3f2e2-113">Dans le protocole RPC standard, un chemin d’accès pour les mises à niveau et les extensions est bien défini, et requiert essentiellement que de nouvelles méthodes soient ajoutées à la fin de l’interface et que les nouveaux types soient utilisés uniquement dans les nouvelles méthodes.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-113">In standard RPC, a path for upgrades and extensions is well defined, and basically requires that new methods only be added at the end of the interface, and new types be used only in the new methods.</span></span> <span data-ttu-id="3f2e2-114">Si de tels ajouts sont nécessaires, la version mineure doit être augmentée.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-114">If such additions are needed, the minor version must be increased.</span></span> <span data-ttu-id="3f2e2-115">Toute autre modification nécessite une modification de la version principale, car le logiciel client et serveur est incompatible avec le réseau.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-115">Any other change requires a change in the major version, because the client and server software would be incompatible on the wire.</span></span> <span data-ttu-id="3f2e2-116">L’adhésion à ces règles garantit qu’à chaque connexion entre un nouveau client et un ancien serveur, ou vice versa, les deux côtés sont entièrement compatibles.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-116">Adhering to these rules assures whenever there is a connection between a new client and old server, or vice-versa, both sides are fully compatible.</span></span>

<span data-ttu-id="3f2e2-117">Pour une interface COM, l’attribut version ne peut pas être utilisé.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-117">For a COM interface, the version attribute cannot be used.</span></span> <span data-ttu-id="3f2e2-118">La création d’interfaces et l’héritage des anciennes interfaces revient à manipuler la version dans RPC.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-118">Creating new interfaces and inheriting from the old interfaces is an equivalent of manipulating the version in RPC.</span></span> <span data-ttu-id="3f2e2-119">En général, la meilleure approche dans COM consiste à créer une nouvelle interface pour les fonctionnalités étendues.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-119">Typically, the best approach in COM is to create a new interface for the expanded functionality.</span></span> <span data-ttu-id="3f2e2-120">L’équivalent de la version mineure est la nouvelle interface qui hérite de l’ancienne.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-120">An equivalent of the minor version is the new interface inheriting from the old one.</span></span> <span data-ttu-id="3f2e2-121">La modification d’anciennes méthodes ou de types de données anciens requiert une interface COM entièrement nouvelle, c’est-à-dire une interface qui n’hérite pas de l’ancienne.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-121">Changing old methods or old data types requires an entirely new COM interface—an interface that does not inherit from the old one.</span></span>

<span data-ttu-id="3f2e2-122">Pour COM, la fonction [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) est une méthode établie permettant de vérifier si un serveur prend en charge une interface ; par conséquent, les situations où un client peut communiquer avec une ancienne et une nouvelle version d’une interface peuvent être facilement résolues.</span><span class="sxs-lookup"><span data-stu-id="3f2e2-122">For COM, the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) function is an established method of checking whether a server supports an interface; hence, the situations where a client can talk to an old or a new version of an interface can be easily resolved.</span></span>

 

 