---
title: Spécification des points de terminaison
description: Spécifiant des points de terminaison connus et dynamiques dans l’appel de procédure distante (RPC).
ms.assetid: fc39b527-11e6-45a7-b3b5-8bcf469633d8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 373fb2818dd14670f5a939aa524c81fcdb05e20b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106522636"
---
# <a name="specifying-endpoints"></a><span data-ttu-id="4a807-103">Spécification des points de terminaison</span><span class="sxs-lookup"><span data-stu-id="4a807-103">Specifying Endpoints</span></span>

<span data-ttu-id="4a807-104">Un point de terminaison est une adresse spécifique au réseau d’un processus serveur pour les appels de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="4a807-104">An endpoint is a network-specific address of a server process for remote procedure calls.</span></span> <span data-ttu-id="4a807-105">Le nom réel du point de terminaison dépend de la séquence de protocole utilisée.</span><span class="sxs-lookup"><span data-stu-id="4a807-105">The actual name of the endpoint depends on the protocol sequence used.</span></span> <span data-ttu-id="4a807-106">Par exemple, les ports TCP, UDP et HTTP use.</span><span class="sxs-lookup"><span data-stu-id="4a807-106">For example, TCP, UDP, and HTTP use ports.</span></span> <span data-ttu-id="4a807-107">Les canaux nommés utilisent un nom de canal nommé.</span><span class="sxs-lookup"><span data-stu-id="4a807-107">Named pipes uses a named pipe name.</span></span> <span data-ttu-id="4a807-108">Les applications client/serveur peuvent utiliser un point de terminaison connu ou dynamique.</span><span class="sxs-lookup"><span data-stu-id="4a807-108">Client/server applications can use a well-known endpoint or a dynamic endpoint.</span></span> <span data-ttu-id="4a807-109">Cette section présente les techniques que les programmes serveur utilisent pour spécifier des points de terminaison connus et dynamiques.</span><span class="sxs-lookup"><span data-stu-id="4a807-109">This section presents the techniques that server programs use to specify well-known and dynamic endpoints.</span></span> <span data-ttu-id="4a807-110">Les informations sont présentées dans les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="4a807-110">The information is discussed in the following topics:</span></span>

-   [<span data-ttu-id="4a807-111">Spécification des points de terminaison connus</span><span class="sxs-lookup"><span data-stu-id="4a807-111">Specifying Well-known Endpoints</span></span>](#specifying-well-known-endpoints)
-   [<span data-ttu-id="4a807-112">Spécification des points de terminaison dynamiques</span><span class="sxs-lookup"><span data-stu-id="4a807-112">Specifying Dynamic Endpoints</span></span>](#specifying-dynamic-endpoints)

## <a name="specifying-well-known-endpoints"></a><span data-ttu-id="4a807-113">Spécification des points de terminaison connus</span><span class="sxs-lookup"><span data-stu-id="4a807-113">Specifying Well-known Endpoints</span></span>

<span data-ttu-id="4a807-114">Lorsque votre serveur utilise un point de terminaison connu, il peut inclure les données de point de terminaison dans le cadre de son entrée de base de données de service de noms.</span><span class="sxs-lookup"><span data-stu-id="4a807-114">When your server uses a well-known endpoint, it can include the endpoint data as part of its name service database entry.</span></span> <span data-ttu-id="4a807-115">Si c’est le cas, le handle de liaison du client contient une adresse de serveur complète qui inclut le point de terminaison connu lorsque le client importe le handle de liaison à partir de l’entrée de serveur.</span><span class="sxs-lookup"><span data-stu-id="4a807-115">If it does, the client's binding handle contains a complete server address that includes the well-known endpoint when the client imports the binding handle from the server entry.</span></span>

<span data-ttu-id="4a807-116">Votre programme serveur peut également spécifier des points de terminaison connus en même temps qu’il spécifie des séquences de protocole.</span><span class="sxs-lookup"><span data-stu-id="4a807-116">Your server program can also specify well-known endpoints at the same time it specifies protocol sequences.</span></span> <span data-ttu-id="4a807-117">Appelez la fonction [**RpcServerUseProtseqEp**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqep) ou [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) .</span><span class="sxs-lookup"><span data-stu-id="4a807-117">Invoke either the [**RpcServerUseProtseqEp**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqep) or [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) function.</span></span> <span data-ttu-id="4a807-118">La différence entre les deux est que la dernière fonction a un paramètre supplémentaire que votre serveur peut utiliser pour contrôler l’allocation de port dynamique.</span><span class="sxs-lookup"><span data-stu-id="4a807-118">The difference between the two is that the latter function has an extra parameter your server can use to control dynamic port allocation.</span></span>

<span data-ttu-id="4a807-119">Si votre programme serveur spécifie ses informations de point de terminaison de cette manière, il doit également appeler la fonction [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) pour inscrire le point de terminaison dans le mappage de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="4a807-119">If your server program specifies its endpoint information in this way, it should also call the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) function to register the endpoint in the endpoint map.</span></span> <span data-ttu-id="4a807-120">Même si le point de terminaison est toujours le même, le client peut utiliser le mappage de point de terminaison pour rechercher le serveur.</span><span class="sxs-lookup"><span data-stu-id="4a807-120">Even though the endpoint is always the same, the client may use the endpoint map to find the server.</span></span>

<span data-ttu-id="4a807-121">À l’instar des séquences de protocole, une application peut spécifier des informations de point de terminaison dans son fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="4a807-121">Like protocol sequences, an application can specify endpoint information in its IDL file.</span></span> <span data-ttu-id="4a807-122">Dans ce cas, il doit inscrire à la fois les séquences de protocole et les points de terminaison en appelant la fonction [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) ou [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) .</span><span class="sxs-lookup"><span data-stu-id="4a807-122">When it does, it should register both the protocol sequences and endpoints at the same time by invoking the [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) or [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) function.</span></span> <span data-ttu-id="4a807-123">Dans ce cas, le client a accès aux informations de point de terminaison par le biais de la spécification d’interface dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="4a807-123">In this case, the client has access to the endpoint information through the interface specification in the IDL file.</span></span> <span data-ttu-id="4a807-124">Par conséquent, il n’est pas nécessaire d’appeler la fonction [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) .</span><span class="sxs-lookup"><span data-stu-id="4a807-124">Therefore, it is not necessary to call the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) function.</span></span>

## <a name="specifying-dynamic-endpoints"></a><span data-ttu-id="4a807-125">Spécification des points de terminaison dynamiques</span><span class="sxs-lookup"><span data-stu-id="4a807-125">Specifying Dynamic Endpoints</span></span>

<span data-ttu-id="4a807-126">Un point de terminaison dynamique est un point de terminaison que l’ordinateur hôte du serveur affecte lorsque l’exécution du serveur commence.</span><span class="sxs-lookup"><span data-stu-id="4a807-126">A dynamic endpoint is an endpoint that the server host computer assigns when the server begins execution.</span></span> <span data-ttu-id="4a807-127">La plupart des applications serveur utilisent des points de terminaison dynamiques pour éviter tout conflit avec d’autres programmes sur le nombre limité de ports disponibles sur le système de l’ordinateur hôte du serveur.</span><span class="sxs-lookup"><span data-stu-id="4a807-127">Most server applications use dynamic endpoints to avoid conflict with other programs over the limited number of ports that are available on the server host computer system.</span></span> <span data-ttu-id="4a807-128">Toutefois, les programmes qui utilisent des canaux nommés ou la séquence de protocole [**Ncalrpc**](/windows/desktop/Midl/ncalrpc) ont un espace de noms de point de terminaison très élevé.</span><span class="sxs-lookup"><span data-stu-id="4a807-128">However, programs using named pipes or the [**ncalrpc**](/windows/desktop/Midl/ncalrpc) protocol sequence have a very large endpoint name space.</span></span> <span data-ttu-id="4a807-129">Ils bénéficient moins des points de terminaison dynamiques que les programmes utilisant d’autres transports.</span><span class="sxs-lookup"><span data-stu-id="4a807-129">They benefit less from dynamic endpoints than programs using other transports.</span></span>

<span data-ttu-id="4a807-130">Les programmes serveur inscrivent des points de terminaison dynamiques dans une base de données de mappage de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="4a807-130">Server programs register dynamic endpoints in an endpoint map database.</span></span> <span data-ttu-id="4a807-131">Si vous souhaitez que le serveur utilise n’importe quel point de terminaison disponible, appelez [**RpcServerUseAllProtSeqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs), [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex), [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) ou [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex).</span><span class="sxs-lookup"><span data-stu-id="4a807-131">If you want the server to use any available endpoint, call [**RpcServerUseAllProtSeqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs), [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex), [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) or [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex).</span></span> <span data-ttu-id="4a807-132">Cela définit la bibliothèque Runtime RPC pour utiliser la totalité ou une ou plusieurs séquences de protocole valides avec des points de terminaison dynamiques.</span><span class="sxs-lookup"><span data-stu-id="4a807-132">This sets the RPC run-time library to use all or one valid protocol sequence(s) with dynamic endpoints.</span></span> <span data-ttu-id="4a807-133">Le serveur doit ensuite appeler [**RpcServerInqBindings**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverinqbindings) pour obtenir un ensemble de handles de liaison valides.</span><span class="sxs-lookup"><span data-stu-id="4a807-133">The server should then call [**RpcServerInqBindings**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverinqbindings) to obtain a set of valid binding handles.</span></span> <span data-ttu-id="4a807-134">Le serveur passe l’ensemble de handles de liaison, ou vecteur de liaison, à la fonction [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) pour inscrire tous les points de terminaison appropriés dans le mappage de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="4a807-134">The server passes the set of binding handles, or binding vector, to the function [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) to register all suitable endpoints in the endpoint map.</span></span> <span data-ttu-id="4a807-135">Pour chaque appel que votre serveur effectue vers **RpcEpRegister**, il doit y avoir un appel correspondant à [**RpcBindingVectorFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingvectorfree) pour libérer la mémoire utilisée par le vecteur de liaison.</span><span class="sxs-lookup"><span data-stu-id="4a807-135">For each call your server makes to **RpcEpRegister**, there should be a corresponding call to [**RpcBindingVectorFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingvectorfree) to release the memory that the binding vector uses.</span></span>

<span data-ttu-id="4a807-136">Notez que les programmes serveur peuvent utiliser la fonction [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) au lieu de [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister).</span><span class="sxs-lookup"><span data-stu-id="4a807-136">Note that server programs can use the [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) function rather than [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister).</span></span> <span data-ttu-id="4a807-137">Les programmes utilisent généralement **RpcEpRegisterNoReplace** quand plusieurs copies d’un programme serveur doivent s’exécuter sur un système hôte serveur.</span><span class="sxs-lookup"><span data-stu-id="4a807-137">Programs typically use **RpcEpRegisterNoReplace** when multiple copies of a server program must run on a server host system.</span></span>

<span data-ttu-id="4a807-138">Les fonctions [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) et [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) ajoutent les interfaces du serveur et les descripteurs de liaison à la base de données du mappeur du point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="4a807-138">Both the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) and [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) functions add the server's interfaces and binding handles to the endpoint mapper database.</span></span> <span data-ttu-id="4a807-139">Lorsque le client effectue un appel de procédure distante à l’aide d’un handle partiellement lié, la bibliothèque Runtime du client demande au mappeur de point de terminaison de l’ordinateur serveur le point de terminaison d’une instance de serveur compatible.</span><span class="sxs-lookup"><span data-stu-id="4a807-139">When the client makes a remote procedure call using a partially bound handle, the client's run-time library asks the server computer's endpoint mapper for the endpoint of a compatible server instance.</span></span> <span data-ttu-id="4a807-140">La bibliothèque cliente fournit l’UUID de l’interface, la séquence de protocole et, le cas échéant, l’UUID de l’objet dans le handle de liaison du client.</span><span class="sxs-lookup"><span data-stu-id="4a807-140">The client library supplies the interface UUID, protocol sequence, and, if present, the object UUID in the client binding handle.</span></span> <span data-ttu-id="4a807-141">Le mappeur de point de terminaison recherche une entrée de base de données qui correspond aux informations du client.</span><span class="sxs-lookup"><span data-stu-id="4a807-141">The endpoint mapper looks for a database entry that matches the client's information.</span></span> <span data-ttu-id="4a807-142">L’UUID de l’interface client/serveur, la version principale de l’interface et la séquence de protocole doivent correspondre exactement.</span><span class="sxs-lookup"><span data-stu-id="4a807-142">The client/server interface UUID, the interface major version, and protocol sequence must all match exactly.</span></span> <span data-ttu-id="4a807-143">En outre, la version mineure de l’interface du serveur doit être supérieure ou égale à la version mineure du client.</span><span class="sxs-lookup"><span data-stu-id="4a807-143">In addition, the server's interface minor version must be greater than or equal to the client's minor version.</span></span>

<span data-ttu-id="4a807-144">Si tous les tests réussissent, le mappeur de point de terminaison retourne le point de terminaison valide et la bibliothèque Runtime cliente met à jour le point de terminaison dans le handle de liaison.</span><span class="sxs-lookup"><span data-stu-id="4a807-144">If all tests are successful, the endpoint mapper returns the valid endpoint and the client run-time library updates the endpoint in the binding handle.</span></span>

<span data-ttu-id="4a807-145">Les points de terminaison dynamiques sont automatiquement purgés de la base de données du mappeur de point de terminaison lorsque le processus serveur s’arrête.</span><span class="sxs-lookup"><span data-stu-id="4a807-145">Dynamic endpoints are automatically purged from the endpoint mapper database when the server process stops running.</span></span> <span data-ttu-id="4a807-146">Vous pouvez supprimer le point de terminaison de la base de données du mappeur de point de terminaison avant de quitter le programme serveur à l’aide de la fonction [**RpcEpUnregister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepunregister) , ou vous pouvez autoriser un nettoyage automatique pour gérer la suppression du point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="4a807-146">You can either remove the endpoint from the endpoint mapper database before the server program exits using the [**RpcEpUnregister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepunregister) function, or you can allow automatic cleanup to manage removal of the endpoint.</span></span>

 

 