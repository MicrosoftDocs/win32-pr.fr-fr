---
title: Spécification de séquences de protocole
description: Les applications serveur doivent sélectionner une ou plusieurs séquences de protocole à utiliser lors de la communication avec le client sur le réseau. Le choix des séquences de protocole dépend du réseau. Consultez interprétation des informations de liaison et sélection d’une séquence de protocole.
ms.assetid: bde26a86-dc4f-4d18-ba51-c6536c62bb75
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a700299e3d2bd98fa5fb0aaebea25e907d85afb0
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315893"
---
# <a name="specifying-protocol-sequences"></a><span data-ttu-id="43055-105">Spécification de séquences de protocole</span><span class="sxs-lookup"><span data-stu-id="43055-105">Specifying Protocol Sequences</span></span>

<span data-ttu-id="43055-106">Les applications serveur doivent sélectionner une ou plusieurs séquences de protocole à utiliser lors de la communication avec le client sur le réseau.</span><span class="sxs-lookup"><span data-stu-id="43055-106">Server applications must select one or more protocol sequences to use when communicating with the client over the network.</span></span> <span data-ttu-id="43055-107">Le choix des séquences de protocole dépend du réseau.</span><span class="sxs-lookup"><span data-stu-id="43055-107">The choice of protocol sequences is network-dependent.</span></span> <span data-ttu-id="43055-108">Consultez [interprétation des informations de liaison](interpreting-binding-information.md) et [sélection d’une séquence de protocole](selecting-a-protocol-sequence.md).</span><span class="sxs-lookup"><span data-stu-id="43055-108">See [Interpreting Binding Information](interpreting-binding-information.md) and [Selecting a Protocol Sequence](selecting-a-protocol-sequence.md).</span></span>

<span data-ttu-id="43055-109">Votre programme serveur peut permettre aux clients de se connecter à l’aide de n’importe quelle séquence de protocole prise en charge par le réseau.</span><span class="sxs-lookup"><span data-stu-id="43055-109">Your server program may allow clients to connect using any protocol sequence that the network supports.</span></span> <span data-ttu-id="43055-110">Pour ce faire, appelez [**RpcServerUseAllProtseqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs) et transmettez RPC \_ C PROTSEQ Max admises \_ \_ \_ \_ default comme premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="43055-110">To do this, invoke [**RpcServerUseAllProtseqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs) and pass RPC\_C\_PROTSEQ\_MAX\_REQS\_DEFAULT as the first parameter.</span></span> <span data-ttu-id="43055-111">Toutefois, il ne s’agit pas de l’approche recommandée.</span><span class="sxs-lookup"><span data-stu-id="43055-111">However, that is not the recommended approach.</span></span> <span data-ttu-id="43055-112">Au lieu de cela, l’utilisation de **Ncalrpc** pour les appels locaux et **ncacn \_ IP \_ TCP** ou **ncacn \_ http** pour les appels distants est généralement suffisante.</span><span class="sxs-lookup"><span data-stu-id="43055-112">Rather, using **ncalrpc** for local calls and **ncacn\_ip\_tcp** or **ncacn\_http** for remote calls is usually sufficient.</span></span> <span data-ttu-id="43055-113">Les réseaux hétérogènes sont rares et pratiquement tous les réseaux prennent en charge TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="43055-113">Heterogenous networks are uncommon, and virtually all networks support TCP/IP.</span></span>

<span data-ttu-id="43055-114">Si vous souhaitez que votre client limite l’allocation de port pour les points de terminaison dynamiques à une plage de ports spécifique, appelez [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex) à la place.</span><span class="sxs-lookup"><span data-stu-id="43055-114">If you want your client to restrict port allocation for dynamic endpoints to a specific port range, call [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex) instead.</span></span> <span data-ttu-id="43055-115">Cette fonction est spécifique à Microsoft RPC et est extrêmement utile pour les appels de procédure distante qui passent par un pare-feu.</span><span class="sxs-lookup"><span data-stu-id="43055-115">This function is specific to Microsoft RPC, and is extremely useful for remote procedure calls that pass through a firewall.</span></span> <span data-ttu-id="43055-116">Elle utilise un paramètre supplémentaire pour passer des indicateurs de contrôle d’allocation de port à la fonction.</span><span class="sxs-lookup"><span data-stu-id="43055-116">It uses an extra parameter to pass port allocation control flags to the function.</span></span> <span data-ttu-id="43055-117">Consultez [configuration du Registre pour les allocations de port et la liaison sélective](configuring-the-windows-xp-2000-nt-registry-for-port-allocations-and-selective-binding.md).</span><span class="sxs-lookup"><span data-stu-id="43055-117">See [Configuring the Registry for Port Allocations and Selective Binding](configuring-the-windows-xp-2000-nt-registry-for-port-allocations-and-selective-binding.md).</span></span>

<span data-ttu-id="43055-118">Vous pouvez spécifier des séquences de protocole et des informations de point de terminaison dans votre fichier MIDL lorsque vous développez les interfaces du serveur.</span><span class="sxs-lookup"><span data-stu-id="43055-118">You can specify protocol sequences and endpoint information in your MIDL file when you develop the server's interfaces.</span></span> <span data-ttu-id="43055-119">Si vous le faites, votre serveur doit utiliser [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) pour inscrire toutes les séquences de protocole et les informations de point de terminaison associées fournies dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="43055-119">If you do, your server should use [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) to register all the protocol sequences and associated endpoint information provided in the IDL file.</span></span> <span data-ttu-id="43055-120">En outre, il existe une fonction [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) correspondante qui permet également au serveur de passer l’allocation de port – indicateurs de contrôle.</span><span class="sxs-lookup"><span data-stu-id="43055-120">In addition, there is a corresponding [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) function that also allows the server to pass port allocation–control flags.</span></span>

<span data-ttu-id="43055-121">Si vous souhaitez configurer vos programmes client et serveur pour qu’ils communiquent avec une séquence de protocole spécifiée, l’application serveur doit appeler [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq).</span><span class="sxs-lookup"><span data-stu-id="43055-121">If you want to configure your client and server programs to communicate with a specified protocol sequence, the server application should call [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq).</span></span> <span data-ttu-id="43055-122">Pour obtenir la liste complète des séquences de protocole RPC Microsoft, consultez la section sur les [constantes de séquence de protocole](protocol-sequence-constants.md).</span><span class="sxs-lookup"><span data-stu-id="43055-122">For a complete list of Microsoft RPC protocol sequences, see [Protocol Sequence Constants](protocol-sequence-constants.md).</span></span>

<span data-ttu-id="43055-123">Microsoft RPC fournit également [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex) pour permettre aux applications de sélectionner des séquences de protocoles spécifiques et de contrôler l’allocation de port dynamique.</span><span class="sxs-lookup"><span data-stu-id="43055-123">Microsoft RPC also provides [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex) to enable applications to select specific protocol sequences and control dynamic port allocation.</span></span>

<span data-ttu-id="43055-124">En plus des protocoles orientés connexion, Microsoft RPC prend également en charge les protocoles de datagramme (sans connexion).</span><span class="sxs-lookup"><span data-stu-id="43055-124">In addition to connection-oriented protocols, Microsoft RPC supports datagram (connectionless) protocols as well.</span></span> <span data-ttu-id="43055-125">Les protocoles orientés connexion sont recommandés. les protocoles de datagramme ont des ensembles de fonctionnalités différents de ceux des protocoles orientés connexion et ne doivent être utilisés que si un développeur de système distribué requiert une fonctionnalité disponible uniquement dans les protocoles de datagramme.</span><span class="sxs-lookup"><span data-stu-id="43055-125">Connection-oriented protocols are recommended; datagram protocols have different feature sets than connection-oriented protocols, and should only be used if a distributed system developer requires a feature available only in datagram protocols.</span></span> <span data-ttu-id="43055-126">Voici quelques-unes des fonctionnalités disponibles lors de l’utilisation des protocoles de datagramme :</span><span class="sxs-lookup"><span data-stu-id="43055-126">Some of the features available when using datagram protocols are:</span></span>

-   <span data-ttu-id="43055-127">Les datagrammes prennent en charge les protocoles de transport UDP et sans connexion IPX.</span><span class="sxs-lookup"><span data-stu-id="43055-127">Datagrams support the UDP and IPX connectionless transport protocols.</span></span>
-   <span data-ttu-id="43055-128">Étant donné qu’il n’est pas nécessaire d’établir et de maintenir une connexion, le protocole RPC du datagramme requiert moins de ressources.</span><span class="sxs-lookup"><span data-stu-id="43055-128">Because it is not necessary to establish and maintain a connection, the datagram RPC protocol requires less resource overhead.</span></span>
-   <span data-ttu-id="43055-129">Les datagrammes permettent une liaison plus rapide.</span><span class="sxs-lookup"><span data-stu-id="43055-129">Datagrams enable faster binding.</span></span>
-   <span data-ttu-id="43055-130">Comme avec RPC orienté connexion, les appels RPC de datagramme sont par défaut *nonidempotent*.</span><span class="sxs-lookup"><span data-stu-id="43055-130">As with connection-oriented RPC, datagram RPC calls are by default *nonidempotent*.</span></span> <span data-ttu-id="43055-131">Cela signifie que l’appel est garanti ne pas être exécuté plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="43055-131">This means the call is guaranteed not to be executed more than once.</span></span> <span data-ttu-id="43055-132">Toutefois, une fonction peut être marquée en tant que idempotent dans le fichier IDL, indiquant à RPC qu’il est inoffensif d’exécuter la fonction plusieurs fois en réponse à une demande client unique.</span><span class="sxs-lookup"><span data-stu-id="43055-132">However, a function can be marked as idempotent in the IDL file telling RPC that it is harmless to execute the function more than once in response to a single, client request.</span></span> <span data-ttu-id="43055-133">Cela permet à l’exécution de conserver un État moins faible sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="43055-133">This allows the run time to maintain less state on the server.</span></span> <span data-ttu-id="43055-134">Notez qu’un appel idempotent est exécuté à nouveau uniquement dans de rares circonstances sur un réseau instable.</span><span class="sxs-lookup"><span data-stu-id="43055-134">Note that an idempotent call would be re-executed only in rare circumstances on an unstable network.</span></span>
-   <span data-ttu-id="43055-135">Le datagramme RPC prend en charge l’attribut IDL de [diffusion](/windows/desktop/Midl/broadcast) .</span><span class="sxs-lookup"><span data-stu-id="43055-135">Datagram RPC supports the [broadcast](/windows/desktop/Midl/broadcast) IDL attribute.</span></span> <span data-ttu-id="43055-136">La diffusion permet à un client d’envoyer des messages à plusieurs serveurs en même temps.</span><span class="sxs-lookup"><span data-stu-id="43055-136">Broadcast enables a client to issue messages to multiple servers at the same time.</span></span> <span data-ttu-id="43055-137">Cela permet au client de localiser l’un des serveurs disponibles sur le réseau ou de contrôler plusieurs serveurs simultanément.</span><span class="sxs-lookup"><span data-stu-id="43055-137">This lets the client locate one of several available servers on the network, or control multiple servers simultaneously.</span></span> <span data-ttu-id="43055-138">Notez que la diffusion du datagramme est valide uniquement dans le lien local, et ne franchit généralement pas de routeurs.</span><span class="sxs-lookup"><span data-stu-id="43055-138">Note that the datagram broadcast is valid only within the local link, and usually does not cross routers.</span></span> <span data-ttu-id="43055-139">Les appels de diffusion sont implicitement idempotent.</span><span class="sxs-lookup"><span data-stu-id="43055-139">Broadcast calls are implicitly idempotent.</span></span> <span data-ttu-id="43055-140">Si l’appel contient \[ **des** \] paramètres out, seule la première réponse du serveur est retournée.</span><span class="sxs-lookup"><span data-stu-id="43055-140">If the call contains \[**out**\] parameters, only the first server response is returned.</span></span> <span data-ttu-id="43055-141">Une fois qu’un serveur répond, tous les RPC ultérieurs sur ce handle de liaison sont envoyés à ce serveur uniquement, y compris les appels avec l’attribut Broadcast.</span><span class="sxs-lookup"><span data-stu-id="43055-141">Once a server responds, all future RPCs over that binding handle will be sent to that server only, including calls with the broadcast attribute.</span></span> <span data-ttu-id="43055-142">Pour envoyer une autre diffusion, créez un nouveau handle de liaison ou appelez [**RpcBindingReset**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingreset) sur le handle existant.</span><span class="sxs-lookup"><span data-stu-id="43055-142">To send another broadcast, create a new binding handle or call [**RpcBindingReset**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingreset) on the existing handle.</span></span>
-   <span data-ttu-id="43055-143">Le datagramme RPC prend en charge l’attribut IDL [peut-être](/windows/desktop/Midl/maybe) .</span><span class="sxs-lookup"><span data-stu-id="43055-143">Datagram RPC supports the [maybe](/windows/desktop/Midl/maybe) IDL attribute.</span></span> <span data-ttu-id="43055-144">Cela permet au client d’envoyer un appel au serveur sans attendre une réponse ou une confirmation.</span><span class="sxs-lookup"><span data-stu-id="43055-144">This lets the client send a call to the server without waiting for a response or confirmation.</span></span> <span data-ttu-id="43055-145">L’appel ne peut pas contenir de paramètres de \[ **sortie** \] .</span><span class="sxs-lookup"><span data-stu-id="43055-145">The call cannot contain \[**out**\] parameters.</span></span> <span data-ttu-id="43055-146">Les appels à l’aide des appels peuvent être implicitement idempotent. **\[ \]**</span><span class="sxs-lookup"><span data-stu-id="43055-146">Calls using the **\[maybe\]** calls are implicitly idempotent.</span></span>

 

 