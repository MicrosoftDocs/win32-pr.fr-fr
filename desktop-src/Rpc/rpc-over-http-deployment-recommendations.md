---
title: Recommandations relatives au déploiement de RPC sur HTTP
description: Cette section décrit les meilleures pratiques et les configurations de déploiement recommandées pour obtenir une sécurité et des performances maximales lors de l’utilisation de RPC sur HTTP.
ms.assetid: 83938a7d-77d0-45e8-b0a3-7b32ef768d83
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8871686d1fc8b87bcd6fb7ac4314b1977252f23a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104029667"
---
# <a name="rpc-over-http-deployment-recommendations"></a><span data-ttu-id="ee10a-103">Recommandations relatives au déploiement de RPC sur HTTP</span><span class="sxs-lookup"><span data-stu-id="ee10a-103">RPC over HTTP Deployment Recommendations</span></span>

<span data-ttu-id="ee10a-104">Cette section décrit les meilleures pratiques et les configurations de déploiement recommandées pour obtenir une sécurité et des performances maximales lors de l’utilisation de RPC sur HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee10a-104">This section documents best practices and recommended deployment configurations for achieving maximum security and performance when using RPC over HTTP.</span></span> <span data-ttu-id="ee10a-105">Les différentes configurations mentionnées ici s’appliquent à différentes organisations en fonction de la taille, du budget et des exigences de sécurité.</span><span class="sxs-lookup"><span data-stu-id="ee10a-105">The various configurations found herein apply do different organizations based on various size, budget, and security requirements.</span></span> <span data-ttu-id="ee10a-106">Chaque configuration fournit également des considérations de déploiement utiles pour déterminer celle qui convient le mieux à un scénario donné.</span><span class="sxs-lookup"><span data-stu-id="ee10a-106">Each configuration also provides deployment considerations useful in determining which is best for a given scenario.</span></span>

<span data-ttu-id="ee10a-107">Pour plus d’informations sur les scénarios RPC sur HTTP volumineux, consultez [équilibrage de charge Microsoft RPC](rpc-load-balancing.md).</span><span class="sxs-lookup"><span data-stu-id="ee10a-107">For information regarding high volume RPC over HTTP scenarios, please see [Microsoft RPC Load Balancing](rpc-load-balancing.md).</span></span>

<span data-ttu-id="ee10a-108">Les recommandations suivantes s’appliquent à toutes les configurations :</span><span class="sxs-lookup"><span data-stu-id="ee10a-108">The following recommendations apply to all configurations:</span></span>

-   <span data-ttu-id="ee10a-109">Utilisez les versions de Windows qui prennent en charge RPC sur HTTP v2.</span><span class="sxs-lookup"><span data-stu-id="ee10a-109">Use versions of Windows that support RPC over HTTP v2.</span></span>
-   <span data-ttu-id="ee10a-110">Mettez les services Internet (IIS) sur l’ordinateur qui exécute le proxy RPC en mode IIS 6,0.</span><span class="sxs-lookup"><span data-stu-id="ee10a-110">Put IIS on the machine that runs the RPC Proxy in IIS 6.0 mode.</span></span>
-   <span data-ttu-id="ee10a-111">Interdire l’accès anonyme au répertoire virtuel du proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="ee10a-111">Disallow anonymous access to the RPC Proxy virtual directory.</span></span>
-   <span data-ttu-id="ee10a-112">N’activez jamais la clé de Registre AllowAnonymous.</span><span class="sxs-lookup"><span data-stu-id="ee10a-112">Never enable the AllowAnonymous registry key.</span></span>
-   <span data-ttu-id="ee10a-113">Faites de votre RPC sur les clients HTTP à l’aide de **CertificateSubjectField** (pour plus d’informations, consultez [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) ) pour vérifier que le proxy RPC auquel vous vous êtes connecté est le proxy RPC attendu.</span><span class="sxs-lookup"><span data-stu-id="ee10a-113">Make your RPC over HTTP clients use the **CertificateSubjectField** (see [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) for more information) to verify that the RPC Proxy you connected to is the RPC Proxy you expect.</span></span>
-   <span data-ttu-id="ee10a-114">Configurez la clé de Registre **ValidPorts** pour qu’elle contienne uniquement les ordinateurs auxquels les clients RPC sur http se connecteront.</span><span class="sxs-lookup"><span data-stu-id="ee10a-114">Configure the **ValidPorts** registry key to contain only machines to which the RPC over HTTP clients will connect.</span></span>
-   <span data-ttu-id="ee10a-115">N’utilisez pas de caractères génériques dans la clé **ValidPorts** ; Cela permet de gagner du temps, mais un ordinateur complètement inattendu peut également s’adapter au caractère générique.</span><span class="sxs-lookup"><span data-stu-id="ee10a-115">Do not use wildcards in the **ValidPorts** key; doing so can save time, but a completely unexpected machine may fit the wildcard as well.</span></span>
-   <span data-ttu-id="ee10a-116">Utilisez SSL sur les clients RPC sur HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee10a-116">Use SSL on RPC over HTTP clients.</span></span> <span data-ttu-id="ee10a-117">Si les instructions énoncées dans ces sections sont suivies, le client RPC sur HTTP ne pourra pas se connecter sans utiliser SSL.</span><span class="sxs-lookup"><span data-stu-id="ee10a-117">If the guidelines set forth in these sections are followed, the RPC over HTTP client will not be able to connect without using SSL.</span></span>
-   <span data-ttu-id="ee10a-118">Configurez RPC sur des clients HTTP pour utiliser le chiffrement RPC en plus de l’utilisation de SSL.</span><span class="sxs-lookup"><span data-stu-id="ee10a-118">Configure RPC over HTTP clients to use RPC Encryption in addition to using SSL.</span></span> <span data-ttu-id="ee10a-119">Si le client RPC sur HTTP ne peut pas accéder au KDC, il peut utiliser uniquement Negotiate et NTLM.</span><span class="sxs-lookup"><span data-stu-id="ee10a-119">If the RPC over HTTP client cannot reach the KDC, it can use only Negotiate and NTLM.</span></span>
-   <span data-ttu-id="ee10a-120">Configurez les ordinateurs clients pour qu’ils utilisent NTLMv2.</span><span class="sxs-lookup"><span data-stu-id="ee10a-120">Configure client machines to use NTLMv2.</span></span> <span data-ttu-id="ee10a-121">Définissez la clé de Registre **LmCompatibilityLevel** sur 2 ou une version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="ee10a-121">Set the **LMCompatibilityLevel** registry key to 2 or higher.</span></span> <span data-ttu-id="ee10a-122">Pour plus d’informations sur la clé **LmCompatibilityLevel** , consultez **msdn.Microsoft.com** .</span><span class="sxs-lookup"><span data-stu-id="ee10a-122">See **msdn.microsoft.com** for more information on the **LMCompatibilityLevel** key.</span></span>
-   <span data-ttu-id="ee10a-123">Exécutez une batterie de serveurs Web de machines proxy RPC avec la configuration décrite ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="ee10a-123">Run a web farm of RPC Proxy machines with the configuration outlined above.</span></span>
-   <span data-ttu-id="ee10a-124">Déployez un pare-feu entre Internet et le proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="ee10a-124">Deploy a firewall between the Internet and the RPC Proxy.</span></span>
-   <span data-ttu-id="ee10a-125">Pour des performances optimales, configurez IIS pour envoyer une réponse rapide pour les codes d’erreur sans succès.</span><span class="sxs-lookup"><span data-stu-id="ee10a-125">For optimal performance, configure IIS to send a short response for non-success error codes.</span></span> <span data-ttu-id="ee10a-126">Étant donné que le consommateur de la réponse IIS est un processus automatisé, il n’est pas nécessaire que des explications conviviales soient envoyées au client. elles seront simplement ignorées par le client RPC sur HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee10a-126">Because the consumer of the IIS response is an automated process, there is no need for user friendly explanations to be sent to the client; they will simply be ignored by the RPC over HTTP client.</span></span>

<span data-ttu-id="ee10a-127">Les objectifs de base du proxy RPC du point de vue de la sécurité, des performances et de la facilité de gestion sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="ee10a-127">The basic goals of the RPC Proxy from a security, performance and manageability perspective are the following:</span></span>

-   <span data-ttu-id="ee10a-128">Fournissez un point unique d’entrée pour le trafic RPC sur HTTP dans le réseau serveur.</span><span class="sxs-lookup"><span data-stu-id="ee10a-128">Provide a single point of entry for RPC over HTTP traffic into the server network.</span></span> <span data-ttu-id="ee10a-129">Le fait de disposer d’un point unique d’entrée pour le trafic RPC sur HTTP dans un réseau serveur présente deux avantages principaux.</span><span class="sxs-lookup"><span data-stu-id="ee10a-129">Having a single point of entry for RPC over HTTP traffic into a server network has two main benefits.</span></span> <span data-ttu-id="ee10a-130">Tout d’abord, puisque le proxy RPC est dirigé vers Internet, la plupart des organisations isolent ces machines dans un réseau spécial appelé réseau de périmètre non approuvé, qui est distinct du réseau d’entreprise normal.</span><span class="sxs-lookup"><span data-stu-id="ee10a-130">First, since the RPC Proxy is facing the Internet, most organizations isolate such machines in a special network called an untrusted perimeter network which is separate from the normal organizational network.</span></span> <span data-ttu-id="ee10a-131">Les serveurs d’un réseau de périmètre non approuvé sont soigneusement gérés, configurés et surveillés pour résister aux attaques provenant d’Internet.</span><span class="sxs-lookup"><span data-stu-id="ee10a-131">Servers in an untrusted perimeter network are very carefully managed, configured and monitored to be able to withstand attacks from the Internet.</span></span> <span data-ttu-id="ee10a-132">Moins il y a de machines dans un réseau de périmètre non approuvé, plus il est facile de configurer, gérer, surveiller et maintenir la sécurité.</span><span class="sxs-lookup"><span data-stu-id="ee10a-132">The fewer machines in an untrusted perimeter network, the easier it is to configure, manage, monitor and keep them secure.</span></span> <span data-ttu-id="ee10a-133">Deuxièmement, étant donné qu’une batterie de serveurs Web unique avec proxys RPC installés peut traiter un nombre quelconque de serveurs RPC sur le réseau d’entreprise, il est logique de séparer le proxy RPC du serveur RPC sur HTTP et de faire en sorte que le proxy RPC réside dans un réseau de périmètre non approuvé.</span><span class="sxs-lookup"><span data-stu-id="ee10a-133">Second, since a single Web Farm with RPC Proxies installed can service any number of RPC over HTTP Servers residing on the corporate network, it makes a lot of sense to separate the RPC Proxy from the RPC over HTTP Server and have the RPC Proxy reside in an untrusted perimeter network.</span></span> <span data-ttu-id="ee10a-134">Si le proxy RPC se trouvait sur le même ordinateur que le serveur RPC sur HTTP, les organisations seraient obligées de placer tous leurs serveurs de back end dans un réseau de périmètre non approuvé, ce qui complique grandement la sécurité du réseau de périmètre non approuvé.</span><span class="sxs-lookup"><span data-stu-id="ee10a-134">If the RPC Proxy was on the same machine as the RPC over HTTP Server, organizations would be forced to put all of their back end servers into an untrusted perimeter network, which would make it much harder to keep the untrusted perimeter network secure.</span></span> <span data-ttu-id="ee10a-135">La séparation du rôle du proxy RPC et du serveur RPC sur HTTP permet aux organisations de maintenir la gestion du nombre d’ordinateurs dans un réseau de périmètre non approuvé, et donc d’en assurer la sécurité.</span><span class="sxs-lookup"><span data-stu-id="ee10a-135">Separating the role of the RPC Proxy and the RPC over HTTP server helps organizations keep the number of machines in an untrusted perimeter network manageable and therefore, more secure.</span></span>
-   <span data-ttu-id="ee10a-136">Servir de fusible de sécurité pour le réseau serveur.</span><span class="sxs-lookup"><span data-stu-id="ee10a-136">Serve as a safety fuse for the server network.</span></span> <span data-ttu-id="ee10a-137">Le proxy RPC est conçu comme un fusible à la une pour le réseau serveur : en cas de problème sur le proxy RPC, il vient simplement de sortir et protège donc le serveur RPC réel sur HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee10a-137">The RPC Proxy is designed as an expendable fuse for the server network – if something goes wrong on the RPC Proxy, it simply goes out and thus protects the real RPC over HTTP server.</span></span> <span data-ttu-id="ee10a-138">Si les meilleures pratiques décrites dans cette section ont été suivies jusqu’à présent, le trafic RPC sur HTTP est chiffré avec le chiffrement RPC en plus de SSL.</span><span class="sxs-lookup"><span data-stu-id="ee10a-138">If the outlined best practices outlined in this section have been followed thus far, the RPC over HTTP traffic is encrypted with RPC encryption in addition to SSL.</span></span> <span data-ttu-id="ee10a-139">Le chiffrement RPC est présent entre le client et le serveur, et non entre le client et le proxy.</span><span class="sxs-lookup"><span data-stu-id="ee10a-139">The RPC Encryption itself is between the client and the server, not between the client and the proxy.</span></span> <span data-ttu-id="ee10a-140">Cela signifie que le proxy ne comprend pas et ne peut pas déchiffrer le trafic RPC qu’il reçoit.</span><span class="sxs-lookup"><span data-stu-id="ee10a-140">This means the proxy does not understand and cannot decrypt the RPC traffic it receives.</span></span> <span data-ttu-id="ee10a-141">Il comprend uniquement certaines séquences de contrôle qui lui sont envoyées par le client qui gère l’établissement de la connexion, le contrôle de Flow et d’autres détails de tunneling.</span><span class="sxs-lookup"><span data-stu-id="ee10a-141">It only understands some control sequences sent to it by the client dealing with connection establishment, flow control and other tunneling details.</span></span> <span data-ttu-id="ee10a-142">Il n’a pas accès aux données que le client RPC sur HTTP envoie au serveur.</span><span class="sxs-lookup"><span data-stu-id="ee10a-142">It has no access to the data the RPC over HTTP client sends to the server.</span></span> <span data-ttu-id="ee10a-143">En outre, le client RPC sur HTTP doit s’authentifier indépendamment auprès du proxy RPC et du serveur RPC sur HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee10a-143">Furthermore, the RPC over HTTP client must independently authenticate to both the RPC Proxy and the RPC over HTTP server.</span></span> <span data-ttu-id="ee10a-144">Cela fournit une défense en profondeur.</span><span class="sxs-lookup"><span data-stu-id="ee10a-144">This provides defense in depth.</span></span> <span data-ttu-id="ee10a-145">Si l’ordinateur proxy RPC est compromis, en raison d’une erreur de configuration ou d’une violation de la sécurité d’un certain type, les données qui transitent par ce dernier sont toujours sécurisées contre toute falsification.</span><span class="sxs-lookup"><span data-stu-id="ee10a-145">If the RPC Proxy machine becomes compromised, due to some configuration error or a security breach of some sort, the data that pass through it are still secure from tampering.</span></span> <span data-ttu-id="ee10a-146">Une personne malveillante qui peut prendre le contrôle du proxy RPC peut au plus interrompre le trafic, mais ne la lit pas ou la falsifie.</span><span class="sxs-lookup"><span data-stu-id="ee10a-146">An attacker that would gain control of the RPC Proxy can at most interrupt the traffic, but not read it or tamper with it.</span></span> <span data-ttu-id="ee10a-147">C’est là que le rôle fusible du proxy RPC entre en lecture, ce qui est plus extensible sans la sécurité du trafic RPC sur HTTP compromis.</span><span class="sxs-lookup"><span data-stu-id="ee10a-147">This is where the fuse role of the RPC Proxy comes into play – it is expendable without the security of the RPC over HTTP traffic being compromised.</span></span>
-   <span data-ttu-id="ee10a-148">Distribuez une partie des vérifications d’accès et du déchiffrement entre plusieurs ordinateurs exécutant le proxy RPC dans une batterie de serveurs Web.</span><span class="sxs-lookup"><span data-stu-id="ee10a-148">Distribute some of the access checks and decryption work among multiple machines running RPC Proxy in a Web Farm.</span></span> <span data-ttu-id="ee10a-149">En fonctionnant correctement dans une batterie de serveurs Web, le proxy RPC permet aux organisations de décharger le déchiffrement SSL et certaines des vérifications d’accès, ce qui libère plus de capacité sur le serveur back end à traiter.</span><span class="sxs-lookup"><span data-stu-id="ee10a-149">By functioning well in a Web Farm, the RPC Proxy enables organizations to offload SSL decryption and some of the access checks, thus freeing more capacity on the back end server for processing.</span></span> <span data-ttu-id="ee10a-150">L’utilisation d’une batterie de serveurs Web de machines proxy RPC permet également à une organisation d’accroître sa capacité à résister à des attaques par déni de service (DoS) en augmentant la capacité sur ses serveurs frontaux.</span><span class="sxs-lookup"><span data-stu-id="ee10a-150">Using a Web Farm of RPC Proxy machines also enables an organization to increase its ability to withstand Denial of Service (DoS) attacks by increasing the capacity on its front end servers.</span></span>

<span data-ttu-id="ee10a-151">Dans les conditions énoncées jusqu’à présent, les organisations ont encore des choix.</span><span class="sxs-lookup"><span data-stu-id="ee10a-151">Within the guidelines set forth thus far, organizations still have choices.</span></span> <span data-ttu-id="ee10a-152">Chaque organisation a des choix et des compromis entre les désagréments des utilisateurs, la sécurité et les coûts :</span><span class="sxs-lookup"><span data-stu-id="ee10a-152">Each organization has choices and compromises between user inconvenience, security and cost:</span></span>

-   <span data-ttu-id="ee10a-153">**Utiliser l’authentification de base ou l’authentification intégrée de Windows pour s’authentifier auprès du proxy RPC**</span><span class="sxs-lookup"><span data-stu-id="ee10a-153">**Use Basic Authentication or Windows Integrated Authentication to authenticate to the RPC Proxy?**</span></span> <span data-ttu-id="ee10a-154">RPC sur HTTP prend actuellement en charge uniquement NTLM : il ne prend pas en charge Kerberos.</span><span class="sxs-lookup"><span data-stu-id="ee10a-154">RPC over HTTP currently supports only NTLM – it doesn't support Kerberos.</span></span> <span data-ttu-id="ee10a-155">De même, s’il existe un proxy HTTP ou un pare-feu entre le client RPC sur HTTP et le proxy RPC qui insère le pragma *via* dans l’en-tête http, l’authentification NTLM ne fonctionnera pas.</span><span class="sxs-lookup"><span data-stu-id="ee10a-155">Also, if there is an HTTP Proxy or a firewall between the RPC over HTTP client and the RPC Proxy which inserts the *via* pragma in the HTTP header, NTLM authentication will not work.</span></span> <span data-ttu-id="ee10a-156">Si ce n’est pas le cas, les organisations peuvent choisir entre l’authentification de base et l’authentification NTLM.</span><span class="sxs-lookup"><span data-stu-id="ee10a-156">When that is not the case, organizations can choose between Basic and NTLM authentication.</span></span> <span data-ttu-id="ee10a-157">L’avantage de l’authentification de base est qu’elle est plus rapide et plus simple et, par conséquent, offre moins de possibilités pour les attaques par déni de service.</span><span class="sxs-lookup"><span data-stu-id="ee10a-157">The advantage of Basic authentication is that it is faster and simpler, and therefore offers less opportunity for denial of service attacks.</span></span> <span data-ttu-id="ee10a-158">Mais NTLM est plus sécurisé.</span><span class="sxs-lookup"><span data-stu-id="ee10a-158">But NTLM is more secure.</span></span> <span data-ttu-id="ee10a-159">En fonction des priorités d’une organisation, il peut choisir de base, NTLM ou permettre à ses utilisateurs de choisir entre les deux.</span><span class="sxs-lookup"><span data-stu-id="ee10a-159">Depending on an organization's priorities, it can choose Basic, NTLM, or allow its users to choose between the two.</span></span> <span data-ttu-id="ee10a-160">Si un seul est choisi, il est préférable de désactiver l’autre dans le répertoire virtuel RPC proxy pour réduire les risques d’attaques.</span><span class="sxs-lookup"><span data-stu-id="ee10a-160">If only one is chosen, it is best to turn off the other from the RPC Proxy virtual directory to reduce risk of attack.</span></span>
-   <span data-ttu-id="ee10a-161">**Utiliser le même jeu d’informations d’identification pour le proxy RPC et le serveur RPC sur HTTP, ou utiliser des informations d’identification différentes pour chacun ?**</span><span class="sxs-lookup"><span data-stu-id="ee10a-161">**Use the same set of credentials for both the RPC Proxy and the RPC over HTTP Server, or use different credentials for each?**</span></span> <span data-ttu-id="ee10a-162">Le compromis pour cette décision est entre la commodité de l’utilisateur et la sécurité.</span><span class="sxs-lookup"><span data-stu-id="ee10a-162">The tradeoff for this decision is between user's convenience and security.</span></span> <span data-ttu-id="ee10a-163">Peu d’utilisateurs aiment entrer plusieurs informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="ee10a-163">Few users like to enter multiple credentials.</span></span> <span data-ttu-id="ee10a-164">Toutefois, si une violation de sécurité se produit dans un réseau de périmètre non approuvé, le fait d’avoir des jeux d’informations d’identification distincts pour le proxy RPC et le serveur RPC sur HTTP fournit une protection supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="ee10a-164">However, if a security breach occurs in an untrusted perimeter network, having separate sets of credentials for the RPC Proxy and the RPC over HTTP Server provides additional protection.</span></span> <span data-ttu-id="ee10a-165">Notez que si des informations d’identification distinctes sont utilisées, et qu’un ensemble d’informations d’identification est celui des informations d’identification de domaine de l’utilisateur, il est recommandé d’utiliser les informations d’identification de domaine de l’utilisateur pour le serveur RPC sur HTTP et non pour le proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="ee10a-165">Note that if separate credentials are used, and one set of credentials is the user's domain credentials, it is advisable to use the user's domain credentials for the RPC over HTTP Server and not for the RPC Proxy.</span></span>

 

 




