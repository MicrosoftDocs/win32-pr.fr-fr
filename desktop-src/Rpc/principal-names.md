---
title: Noms principaux
description: Pour qu’un client crée une session mutuellement authentifiée avec un programme serveur, il doit fournir le nom principal attendu du serveur.
ms.assetid: 4d9977f8-0efb-4559-977e-3eba4e277bc0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 554ffecff6eb019b4712e6b2d9f5c6319db492e7
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104462411"
---
# <a name="principal-names"></a><span data-ttu-id="27997-103">Noms principaux</span><span class="sxs-lookup"><span data-stu-id="27997-103">Principal Names</span></span>

<span data-ttu-id="27997-104">Pour qu’un client crée une session mutuellement authentifiée avec un programme serveur, il doit fournir le nom principal attendu du serveur.</span><span class="sxs-lookup"><span data-stu-id="27997-104">For a client to create a mutually authenticated session with a server program, it must provide the server's expected principal name.</span></span> <span data-ttu-id="27997-105">Certains protocoles, tels que Kerberos, requièrent un nom principal de serveur correct pour toute session authentifiée.</span><span class="sxs-lookup"><span data-stu-id="27997-105">Some protocols, such as Kerberos, require a correct server principal name for any authenticated session.</span></span> <span data-ttu-id="27997-106">Un principal est une entité que le système de sécurité reconnaît.</span><span class="sxs-lookup"><span data-stu-id="27997-106">A principal is an entity that the security system recognizes.</span></span> <span data-ttu-id="27997-107">Cela comprend les utilisateurs humains et les services système.</span><span class="sxs-lookup"><span data-stu-id="27997-107">This includes human users as well as system services.</span></span> <span data-ttu-id="27997-108">Tous les noms principaux prennent le même format pour un fournisseur SSP (Security Support Provider) donné.</span><span class="sxs-lookup"><span data-stu-id="27997-108">All principal names take similar format for a given security support provider (SSP).</span></span> <span data-ttu-id="27997-109">Un SSP est un module logiciel qui effectue la validation de la sécurité.</span><span class="sxs-lookup"><span data-stu-id="27997-109">An SSP is a software module that performs security validation.</span></span> <span data-ttu-id="27997-110">Pour plus d’informations, consultez [vue d’ensemble de l’architecture SSPI](sspi-architectural-overview.md).</span><span class="sxs-lookup"><span data-stu-id="27997-110">For more information, see [SSPI Architectural Overview](sspi-architectural-overview.md).</span></span> <span data-ttu-id="27997-111">Pour assurer l’uniformité, un fournisseur de sécurité fournit généralement des noms de services système similaires à ceux des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="27997-111">To maintain uniformity, a security provider usually gives system services similar names as users.</span></span> <span data-ttu-id="27997-112">Sous certains fournisseurs de sécurité, les services système peuvent ne pas avoir de nom principal.</span><span class="sxs-lookup"><span data-stu-id="27997-112">Under some security providers, system services may not have a principal name.</span></span>

<span data-ttu-id="27997-113">Le serveur inscrit son nom principal pour le fournisseur de sécurité à l’aide de la fonction [**RpcServerRegisterAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterauthinfo) .</span><span class="sxs-lookup"><span data-stu-id="27997-113">The server registers its principal name for the security provider using the [**RpcServerRegisterAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterauthinfo) function.</span></span> <span data-ttu-id="27997-114">Un seul nom de principal du serveur peut être utilisé pour chaque fournisseur de sécurité.</span><span class="sxs-lookup"><span data-stu-id="27997-114">Only one server principal name can be used for each security provider.</span></span> <span data-ttu-id="27997-115">Si plusieurs noms sont inscrits, un nom est choisi et utilisé de manière aléatoire.</span><span class="sxs-lookup"><span data-stu-id="27997-115">If more than one name is registered, one name is randomly chosen and used.</span></span> <span data-ttu-id="27997-116">Le fournisseur de services partagés détermine le format du nom du principal.</span><span class="sxs-lookup"><span data-stu-id="27997-116">The SSP dictates the format of the principal name.</span></span> <span data-ttu-id="27997-117">Par exemple, les SSP Kerberos/Negotiate pour un service système se présentent approximativement comme suit : nom de l’ordinateur \_ $ @childdomain.parentdomain1.parentdomain2.COM .</span><span class="sxs-lookup"><span data-stu-id="27997-117">For example, the Kerberos/Negotiate SSPs for a system service look approximately like the following: machine\_name$@childdomain.parentdomain1.parentdomain2.COM.</span></span>

<span data-ttu-id="27997-118">La procédure recommandée pour générer des noms principaux consiste à utiliser des API documentées (telles que la fonction **DsMakeSpn** ), au lieu de accolant ensemble le nom principal des chaînes.</span><span class="sxs-lookup"><span data-stu-id="27997-118">The recommended procedure for generating principal names is to use documented APIs (such as the **DsMakeSpn** function), rather than piecing together the principal name from strings.</span></span> <span data-ttu-id="27997-119">L’utilisation d’API documentées augmente la portabilité entre les différents environnements de déploiement et élimine les risques d’erreurs.</span><span class="sxs-lookup"><span data-stu-id="27997-119">Using documented APIs increases portability between different deployment environments and eliminates the possibility for errors.</span></span>

<span data-ttu-id="27997-120">La spécification d’un nom de principal incorrect peut empêcher le client et le serveur d’établir une session authentifiée.</span><span class="sxs-lookup"><span data-stu-id="27997-120">Specifying an incorrect principal name may prevent the client and server from establishing an authenticated session.</span></span> <span data-ttu-id="27997-121">Le SSP SCHANNEL prend les noms principaux sous l’une des deux formes suivantes :</span><span class="sxs-lookup"><span data-stu-id="27997-121">The SCHANNEL SSP takes principal names in either of two forms:</span></span>

-   <span data-ttu-id="27997-122">Le premier formulaire de nom de principal SCHANNEL est le formulaire [*msstd*](m-glos.md) .</span><span class="sxs-lookup"><span data-stu-id="27997-122">The first SCHANNEL principal name form is the [*msstd*](m-glos.md) form.</span></span> <span data-ttu-id="27997-123">Les noms sous la forme msstd suivent généralement le modèle msstd:servername@serverdomain.com .</span><span class="sxs-lookup"><span data-stu-id="27997-123">Names in msstd form generally follow the pattern msstd:servername@serverdomain.com.</span></span> <span data-ttu-id="27997-124">C’est ce qu’on appelle une propriété de nom d’adresse de messagerie.</span><span class="sxs-lookup"><span data-stu-id="27997-124">This is referred to as an email name property.</span></span> <span data-ttu-id="27997-125">Si le certificat contient une propriété de nom de messagerie et qu’il contient le signe arobase (@), le nom du principal est msstd : email Name.</span><span class="sxs-lookup"><span data-stu-id="27997-125">If the certificate contains an email name property, and it contains the at sign (@), the principal name is msstd:email name.</span></span> <span data-ttu-id="27997-126">Dans le cas contraire, elle doit contenir la propriété nom commun.</span><span class="sxs-lookup"><span data-stu-id="27997-126">Otherwise it must contain the common name property.</span></span> <span data-ttu-id="27997-127">Les barres obliques inverses internes sont doublées, tout comme dans les liaisons de chaîne.</span><span class="sxs-lookup"><span data-stu-id="27997-127">Internal backslashes are doubled, just as in string bindings.</span></span>
-   <span data-ttu-id="27997-128">Le deuxième formulaire de nom de principal SCHANNEL est le formulaire [*fullsic*](f-glos.md) .</span><span class="sxs-lookup"><span data-stu-id="27997-128">The second SCHANNEL principal name form is the [*fullsic*](f-glos.md) form.</span></span> <span data-ttu-id="27997-129">Il s’agit d’une série de noms conformes RFC1779 délimités par des crochets pointus et séparés par des barres obliques inverses.</span><span class="sxs-lookup"><span data-stu-id="27997-129">This is a series of RFC1779-compliant names bounded by angle brackets and separated by backslashes.</span></span> <span data-ttu-id="27997-130">En règle générale, elle suit le modèle fullsic : \\ < \\ Authority \\ \\ . \\ ... Person> ou fullsic : \\ < \\ autorité de certification \\ \\ ... \\ . ServerProgram>.</span><span class="sxs-lookup"><span data-stu-id="27997-130">It typically follows the pattern fullsic:\\<\\Authority\\SubAuthority\\.....\\Person> or fullsic:\\<\\Authority\\SubAuthority\\.....\\ServerProgram>.</span></span>

<span data-ttu-id="27997-131">Si le nom ne correspond pas au certificat, l’erreur \_ accès \_ refusé est retournée.</span><span class="sxs-lookup"><span data-stu-id="27997-131">If the name does not match the certificate, ERROR\_ACCESS\_DENIED is returned.</span></span> <span data-ttu-id="27997-132">Si le format du nom n’est pas valide, SCHANNEL SSP retourne le \_ paramètre non valide de l’erreur de code \_ .</span><span class="sxs-lookup"><span data-stu-id="27997-132">If the name format is invalid, SCHANNEL SSP returns the code ERROR\_INVALID\_PARAMETER.</span></span>

<span data-ttu-id="27997-133">Pour rechercher le nom principal du serveur, les applications peuvent appeler [**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname).</span><span class="sxs-lookup"><span data-stu-id="27997-133">To query for the server's principal name, applications can call [**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname).</span></span> <span data-ttu-id="27997-134">Cela alloue une chaîne terminée par le caractère null pour contenir le nom du principal.</span><span class="sxs-lookup"><span data-stu-id="27997-134">This allocates a null-terminated string to hold the principal name.</span></span> <span data-ttu-id="27997-135">Avant qu’elle ne se termine, votre application doit appeler [**RpcStringFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcstringfree) pour libérer la mémoire occupée par cette chaîne.</span><span class="sxs-lookup"><span data-stu-id="27997-135">Before it terminates, your application must invoke [**RpcStringFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcstringfree) to release the memory this string occupies.</span></span>

<span data-ttu-id="27997-136">L’interrogation du nom du serveur de cette manière n’est pas sécurisée et doit être évitée.</span><span class="sxs-lookup"><span data-stu-id="27997-136">Querying for the server name in this manner is not secure and should be avoided.</span></span> <span data-ttu-id="27997-137">Pour l’authentification du serveur, le programme client doit connaître le serveur auquel il se connecte et créer le nom principal du serveur à partir de zéro.</span><span class="sxs-lookup"><span data-stu-id="27997-137">For server authentication, the client program should know which server it is connecting to and should create the server principal name from scratch.</span></span>

 

 




