---
title: Gestion des exceptions (RPC)
description: RPC utilise la même approche pour la gestion des exceptions que l’API Windows.
ms.assetid: 7133d3f4-ed84-4cde-bc77-88e73ced9073
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 25de594a648cddb70f26b42e8b0dbf1d6a9dd51d
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/10/2020
ms.locfileid: "104464131"
---
# <a name="exception-handling-rpc"></a><span data-ttu-id="763ef-103">Gestion des exceptions (RPC)</span><span class="sxs-lookup"><span data-stu-id="763ef-103">Exception Handling (RPC)</span></span>

<span data-ttu-id="763ef-104">RPC utilise la même approche pour la gestion des exceptions que l’API Windows.</span><span class="sxs-lookup"><span data-stu-id="763ef-104">RPC uses the same approach to exception handling as the Windows API.</span></span>

<span data-ttu-id="763ef-105">La structure [**RpcTryFinally**](rpctryfinally.md)  /  [**RpcFinally**](/previous-versions/aa375699(v=vs.80))  /  [**RpcEndFinally**](/previous-versions/aa375634(v=vs.80)) est équivalente à l’instruction Windows **try-finally** .</span><span class="sxs-lookup"><span data-stu-id="763ef-105">The [**RpcTryFinally**](rpctryfinally.md) / [**RpcFinally**](/previous-versions/aa375699(v=vs.80)) / [**RpcEndFinally**](/previous-versions/aa375634(v=vs.80)) structure is equivalent to the Windows **try-finally** statement.</span></span> <span data-ttu-id="763ef-106">La construction d’exception RPC [**RpcTryExcept**](rpctryexcept.md)  /  [**RpcExcept**](/windows/desktop/api/Rpc/nf-rpc-rpcexcept)  /  [**RpcEndExcept**](/previous-versions/aa375629(v=vs.80)) est équivalente à l’instruction **try-except** Windows.</span><span class="sxs-lookup"><span data-stu-id="763ef-106">The RPC exception construct [**RpcTryExcept**](rpctryexcept.md) / [**RpcExcept**](/windows/desktop/api/Rpc/nf-rpc-rpcexcept) / [**RpcEndExcept**](/previous-versions/aa375629(v=vs.80)) is equivalent to the Windows **try-except** statement.</span></span>

<span data-ttu-id="763ef-107">Lorsque vous utilisez les gestionnaires d’exceptions RPC, le code source côté client est portable.</span><span class="sxs-lookup"><span data-stu-id="763ef-107">When you use the RPC exception handlers, your client-side source code is portable.</span></span> <span data-ttu-id="763ef-108">Les différents fichiers d’en-tête RPC fournis pour chaque plateforme résolvent les macros **RpcTry** et [**RpcExcept**](/windows/desktop/api/Rpc/nf-rpc-rpcexcept) pour chaque plateforme.</span><span class="sxs-lookup"><span data-stu-id="763ef-108">The different RPC header files provided for each platform resolve the **RpcTry** and [**RpcExcept**](/windows/desktop/api/Rpc/nf-rpc-rpcexcept) macros for each platform.</span></span> <span data-ttu-id="763ef-109">Dans l’environnement Windows, ces macros sont mappées directement aux instructions **try-finally** et **try-except** de Windows.</span><span class="sxs-lookup"><span data-stu-id="763ef-109">In the Windows environment, these macros map directly to the Windows **try-finally** and **try-except** statements.</span></span> <span data-ttu-id="763ef-110">Dans d’autres environnements, ces macros sont mappées à d’autres implémentations spécifiques à la plateforme de gestionnaires d’exceptions.</span><span class="sxs-lookup"><span data-stu-id="763ef-110">In other environments, these macros map to other platform-specific implementations of exception handlers.</span></span>

<span data-ttu-id="763ef-111">Les exceptions potentielles générées par ces structures incluent l’ensemble des codes d’erreur retournés par les fonctions RPC avec les préfixes RPC \_ S \_ et RPC \_ X et l’ensemble des exceptions retournées par Windows.</span><span class="sxs-lookup"><span data-stu-id="763ef-111">Potential exceptions raised by these structures include the set of error codes returned by the RPC functions with the prefixes RPC\_S\_ and RPC\_X and the set of exceptions returned by Windows.</span></span> <span data-ttu-id="763ef-112">Pour plus d’informations, consultez [valeurs de retour RPC](rpc-return-values.md).</span><span class="sxs-lookup"><span data-stu-id="763ef-112">For details, see [RPC Return Values](rpc-return-values.md).</span></span>

<span data-ttu-id="763ef-113">Tandis que les macros **RpcTry** et [**RpcExcept**](/windows/desktop/api/Rpc/nf-rpc-rpcexcept) offrent une méthode personnalisable et indépendante de la plateforme pour gérer les exceptions, dans Windows Vista et les versions ultérieures de Windows, [**RpcExceptionFilter**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcexceptionfilter) est la méthode recommandée pour gérer les exceptions.</span><span class="sxs-lookup"><span data-stu-id="763ef-113">While the **RpcTry** and [**RpcExcept**](/windows/desktop/api/Rpc/nf-rpc-rpcexcept) macros provide a customizable platform-agnostic way to handle exceptions, in Windows Vista and later versions of Windows, [**RpcExceptionFilter**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcexceptionfilter) is the recommended way of handling exceptions.</span></span> <span data-ttu-id="763ef-114">Il n’est pas nécessaire d’écrire des filtres personnalisés pour capturer la plupart des exceptions structurées les plus courantes. Toutefois, les filtres d’exceptions personnalisés requièrent toujours **RpcExcept**.</span><span class="sxs-lookup"><span data-stu-id="763ef-114">It does not require custom filters to be written to capture many of the most common structured exceptions; however, custom exception filters still require **RpcExcept**.</span></span>

<span data-ttu-id="763ef-115">Les exceptions qui se produisent dans l’application serveur, le stub serveur et la bibliothèque Runtime de serveur (au-dessus de la couche de transport) sont propagées au client.</span><span class="sxs-lookup"><span data-stu-id="763ef-115">Exceptions that occur in the server application, server stub, and server run-time library (above the transport layer) are propagated to the client.</span></span> <span data-ttu-id="763ef-116">Aucune exception n’est propagée à partir du niveau de transport serveur.</span><span class="sxs-lookup"><span data-stu-id="763ef-116">No exceptions are propagated from the server-transport level.</span></span> <span data-ttu-id="763ef-117">La méthode recommandée pour qu’une routine de serveur retourne des erreurs au moment de l’exécution RPC consiste à lever une exception.</span><span class="sxs-lookup"><span data-stu-id="763ef-117">The recommended method for a server routine to return errors to the RPC run time is to throw an exception.</span></span> <span data-ttu-id="763ef-118">Une routine de serveur peut utiliser toutes les méthodes appropriées pour la communication des erreurs entre les routines du serveur, mais si elle rencontre une erreur qui l’empêche d’exécuter la procédure distante, elle doit lever une exception après le nettoyage et le retour à l’heure d’exécution RPC, au lieu de retourner une valeur RPC que seule la routine du serveur reconnaît comme une erreur.</span><span class="sxs-lookup"><span data-stu-id="763ef-118">A server routine can use whatever methods is appropriate for communicating errors between server routines, but if it encounters an error that prevents it from executing the remote procedure, it should raise an exception after cleaning up and before returning to the RPC run time, rather than returning a value to RPC that only the server routine recognizes as an error.</span></span>

<span data-ttu-id="763ef-119">L’illustration suivante montre comment les exceptions sont retournées du serveur au client.</span><span class="sxs-lookup"><span data-stu-id="763ef-119">The following figure shows how exceptions are returned from the server to the client.</span></span>

![les exceptions sont retournées du serveur au client par le biais de l’exécution RPC respective de chaque composant](images/prog-a20.png)

<span data-ttu-id="763ef-121">Les gestionnaires d’exceptions RPC diffèrent légèrement des macros de gestion des exceptions (OSF-DCE) Open Software Foundation-Distributed Computing Environment (OSF-ETCD) **try**, **finally** et **catch**.</span><span class="sxs-lookup"><span data-stu-id="763ef-121">The RPC exception handlers differ slightly from the Open Software Foundation-Distributed Computing Environment (OSF-DCE) exception-handling macros **TRY**, **FINALLY**, and **CATCH**.</span></span> <span data-ttu-id="763ef-122">Différents fournisseurs proposent des fichiers include qui mappent les fonctions RPC OSF-DCE aux fonctions RPC de Microsoft, notamment **try**, **catch**, **catch** \_ **All** et **EndTry**.</span><span class="sxs-lookup"><span data-stu-id="763ef-122">Various vendors provide include files that map the OSF-DCE RPC functions to the Microsoft RPC functions, including **TRY**, **CATCH**, **CATCH**\_**ALL**, and **ENDTRY**.</span></span> <span data-ttu-id="763ef-123">Ces fichiers d’en-tête mappent également les \_ \_ \* codes d’erreur s RPC sur les équivalents d’exception OSF-DCE, RPC \_ S \_ \* et mappent les \_ \_ \* codes d’erreur RPC x à RPC \_ x \_ \* .</span><span class="sxs-lookup"><span data-stu-id="763ef-123">These header files also map the RPC\_S\_\* error codes onto the OSF-DCE exception counterparts, rpc\_s\_\*, and map RPC\_X\_\* error codes to rpc\_x\_\*.</span></span> <span data-ttu-id="763ef-124">Pour la portabilité de l’OSF-DCE, utilisez ces fichiers include.</span><span class="sxs-lookup"><span data-stu-id="763ef-124">For OSF-DCE portability, use these include files.</span></span> <span data-ttu-id="763ef-125">Pour plus d’informations sur les gestionnaires d’exceptions RPC, consultez [**RpcExceptionFilter**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcexceptionfilter), [**RpcExcept**](/windows/desktop/api/Rpc/nf-rpc-rpcexcept), [**RpcFinally**](/previous-versions/aa375699(v=vs.80)).</span><span class="sxs-lookup"><span data-stu-id="763ef-125">For more information about the RPC exception handlers, see [**RpcExceptionFilter**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcexceptionfilter), [**RpcExcept**](/windows/desktop/api/Rpc/nf-rpc-rpcexcept), [**RpcFinally**](/previous-versions/aa375699(v=vs.80)).</span></span> <span data-ttu-id="763ef-126">Pour plus d’informations sur les gestionnaires d’exceptions Windows, consultez [gestion structurée des exceptions](/windows/desktop/Debug/structured-exception-handling).</span><span class="sxs-lookup"><span data-stu-id="763ef-126">For more information about the Windows exception handlers, see [Structured Exception Handling](/windows/desktop/Debug/structured-exception-handling).</span></span>

 

 
