---
description: Avant de pouvoir utiliser la routine de rappel de file d’attente par défaut, soit en la spécifiant comme routine de rappel lors de la validation d’une file d’attente de fichiers, soit en l’appelant à partir d’une routine de rappel personnalisée, elle doit être initialisée.
ms.assetid: e25a9787-a4a3-4d06-bf55-f6f7cfb23481
title: Initialisation et fin du contexte de rappel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03cb4c144cb9069d395ccd688e2a172680df8a12
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106521856"
---
# <a name="initializing-and-terminating-the-callback-context"></a><span data-ttu-id="30489-103">Initialisation et fin du contexte de rappel</span><span class="sxs-lookup"><span data-stu-id="30489-103">Initializing and Terminating the Callback Context</span></span>

<span data-ttu-id="30489-104">Avant de pouvoir utiliser la routine de rappel de file d’attente par défaut, soit en la spécifiant comme routine de rappel lors de la validation d’une file d’attente de fichiers, soit en l’appelant à partir d’une routine de rappel personnalisée, elle doit être initialisée.</span><span class="sxs-lookup"><span data-stu-id="30489-104">Before the default queue callback routine can be used, either by specifying it as the callback routine when committing a file queue, or by calling it from a custom callback routine, it must be initialized.</span></span>

<span data-ttu-id="30489-105">La fonction [**SetupInitDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) crée la structure de contexte qui est utilisée par la routine de rappel de file d’attente par défaut.</span><span class="sxs-lookup"><span data-stu-id="30489-105">The [**SetupInitDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) function builds the context structure that is used by the default queue callback routine.</span></span> <span data-ttu-id="30489-106">Elle retourne un pointeur void vers cette structure.</span><span class="sxs-lookup"><span data-stu-id="30489-106">It returns a void pointer to that structure.</span></span> <span data-ttu-id="30489-107">Cette structure est essentielle pour l’opération de la routine de rappel par défaut et doit être passée à la routine de rappel.</span><span class="sxs-lookup"><span data-stu-id="30489-107">This structure is essential for the default callback routine's operation and must be passed to the callback routine.</span></span> <span data-ttu-id="30489-108">Vous pouvez le faire soit en spécifiant le pointeur void comme contexte dans un appel à [**SetupCommitFileQueue**](/windows/desktop/api/Setupapi/nf-setupapi-setupcommitfilequeuea), soit en spécifiant le pointeur void comme paramètre de contexte lors de l’appel de [**SetupDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupdefaultqueuecallbacka) à partir d’une routine de rappel personnalisée.</span><span class="sxs-lookup"><span data-stu-id="30489-108">You do can this either by specifying the void pointer as the context in a call to [**SetupCommitFileQueue**](/windows/desktop/api/Setupapi/nf-setupapi-setupcommitfilequeuea), or by specifying the void pointer as the context parameter when calling [**SetupDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupdefaultqueuecallbacka) from a custom callback routine.</span></span> <span data-ttu-id="30489-109">Cette structure de contexte ne doit pas être modifiée ou référencée par l’application d’installation.</span><span class="sxs-lookup"><span data-stu-id="30489-109">This context structure must not be altered or referenced by the setup application.</span></span>

<span data-ttu-id="30489-110">La fonction [**SetupInitDefaultQueueCallbackEx**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex) initialise également un contexte pour la routine de rappel de file d’attente par défaut, mais elle spécifie une deuxième fenêtre pour recevoir un message de progression spécifié par l’appelant chaque fois que la file d’attente envoie une notification.</span><span class="sxs-lookup"><span data-stu-id="30489-110">The [**SetupInitDefaultQueueCallbackEx**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex) function also initializes a context for the default queue callback routine, but it specifies a second window to receive a caller-specified progress message each time the queue sends a notification.</span></span> <span data-ttu-id="30489-111">Cela vous permet d’utiliser les boîtes de dialogue d’invite et d’erreur de disque par défaut et d’incorporer une barre de progression dans une deuxième fenêtre, par exemple dans une page d’un assistant d’installation.</span><span class="sxs-lookup"><span data-stu-id="30489-111">This enables you to use the default disk prompting and error dialog boxes, and to also embed a progress bar in a second window, for example, in a page of an installation wizard.</span></span>

<span data-ttu-id="30489-112">Que vous ayez initialisé ou non le contexte utilisé par la routine de rappel de file d’attente par défaut avec [**SetupInitDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) ou [**SetupInitDefaultQueueCallbackEx**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex), une fois le traitement des opérations en file d’attente terminé, appelez [**SetupTermDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setuptermdefaultqueuecallback) pour libérer les ressources allouées lors de l’initialisation de la structure de contexte.</span><span class="sxs-lookup"><span data-stu-id="30489-112">Regardless of whether you initialized the context used by the default queue callback routine with [**SetupInitDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) or [**SetupInitDefaultQueueCallbackEx**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex), after the queued operations have finished processing, call [**SetupTermDefaultQueueCallback**](/windows/desktop/api/Setupapi/nf-setupapi-setuptermdefaultqueuecallback) to release the resources allocated in initializing the context structure.</span></span>

 

 



