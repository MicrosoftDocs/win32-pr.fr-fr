---
title: Objets de classe COM et CLSID
description: Un serveur COM est implémenté en tant que classe COM.
ms.assetid: 0073acdf-38a8-4f1a-aa26-379456a95fca
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1bbfde2f379c4c7589db4cde283c8c67d720b21d
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "106542851"
---
# <a name="com-class-objects-and-clsids"></a><span data-ttu-id="92210-103">Objets de classe COM et CLSID</span><span class="sxs-lookup"><span data-stu-id="92210-103">COM Class Objects and CLSIDs</span></span>

<span data-ttu-id="92210-104">Un serveur COM est implémenté en tant que classe COM.</span><span class="sxs-lookup"><span data-stu-id="92210-104">A COM server is implemented as a COM class.</span></span> <span data-ttu-id="92210-105">Une *classe com* est une implémentation d’un groupe d’interfaces dans le code exécuté chaque fois que vous interagissez avec un objet donné.</span><span class="sxs-lookup"><span data-stu-id="92210-105">A *COM class* is an implementation of a group of interfaces in code executed whenever you interact with a given object.</span></span> <span data-ttu-id="92210-106">Il existe une distinction importante entre une classe C++ et une classe COM : en C++, une classe est un type, tandis qu’une classe COM est simplement une définition de l’objet et ne comporte aucun type, bien qu’un programmeur C++ puisse l’implémenter à l’aide d’une classe C++.</span><span class="sxs-lookup"><span data-stu-id="92210-106">There is an important distinction between a C++ class and a COM class: In C++, a class is a type, while a COM class is simply a definition of the object and carries no type, although a C++ programmer might implement it by using a C++ class.</span></span> <span data-ttu-id="92210-107">COM est conçu pour permettre l’utilisation d’une classe par différentes applications, y compris les applications écrites sans connaissance de l’existence de cette classe particulière.</span><span class="sxs-lookup"><span data-stu-id="92210-107">COM is designed to allow a class to be used by different applications, including applications written without knowledge of that particular class's existence.</span></span> <span data-ttu-id="92210-108">Par conséquent, le code de classe pour un type donné d’objet existe dans une bibliothèque liée dynamique (DLL) ou dans une autre application exécutable (EXE).</span><span class="sxs-lookup"><span data-stu-id="92210-108">Therefore, class code for a given type of object exists either in a dynamic linked library (DLL) or in another executable application (EXE).</span></span>

<span data-ttu-id="92210-109">Chaque classe COM est identifiée par un *CLSID*, un GUID 128 bits unique, que le serveur doit inscrire.</span><span class="sxs-lookup"><span data-stu-id="92210-109">Each COM class is identified by a *CLSID*, a unique 128-bit GUID, which the server must register.</span></span> <span data-ttu-id="92210-110">COM utilise ce CLSID, à la demande d’un client, pour associer des données spécifiques à la DLL ou à l’EXE contenant le code qui implémente la classe, créant ainsi une instance de l’objet.</span><span class="sxs-lookup"><span data-stu-id="92210-110">COM uses this CLSID, at the request of a client, to associate specific data with the DLL or EXE containing the code that implements the class, thus creating an instance of the object.</span></span>

<span data-ttu-id="92210-111">Pour les clients et les serveurs situés sur le même ordinateur, le CLSID du serveur est tout ce dont a besoin le client.</span><span class="sxs-lookup"><span data-stu-id="92210-111">For clients and servers on the same computer, the CLSID of the server is all the client ever needs.</span></span> <span data-ttu-id="92210-112">Sur chaque ordinateur, COM gère une base de données (il utilise le registre système sur les plateformes Microsoft Windows et Macintosh) de tous les CLSID pour les serveurs installés sur le système.</span><span class="sxs-lookup"><span data-stu-id="92210-112">On each computer, COM maintains a database (it makes use of the system registry on Microsoft Windows and Macintosh platforms) of all the CLSIDs for the servers installed on the system.</span></span> <span data-ttu-id="92210-113">Il s’agit d’un mappage entre chaque CLSID et l’emplacement de la DLL ou de l’EXE qui héberge le code de ce CLSID.</span><span class="sxs-lookup"><span data-stu-id="92210-113">This is a mapping between each CLSID and the location of the DLL or EXE that houses the code for that CLSID.</span></span> <span data-ttu-id="92210-114">COM consulte cette base de données chaque fois qu’un client souhaite créer une instance d’une classe COM et utiliser ses services, de sorte que le client n’a jamais besoin de connaître l’emplacement absolu du code sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="92210-114">COM consults this database whenever a client wants to create an instance of a COM class and use its services, so the client never needs to know the absolute location of the code on the computer.</span></span>

<span data-ttu-id="92210-115">Pour les systèmes distribués, COM fournit des entrées de Registre qui permettent à un serveur distant de s’inscrire lui-même pour une utilisation par un client.</span><span class="sxs-lookup"><span data-stu-id="92210-115">For distributed systems, COM provides registry entries that allow a remote server to register itself for use by a client.</span></span> <span data-ttu-id="92210-116">Alors que les applications ont besoin de connaître uniquement le CLSID d’un serveur, car elles peuvent s’appuyer sur le registre pour localiser le serveur, COM permet aux clients de remplacer les entrées de Registre et de spécifier des emplacements de serveur, afin de tirer pleinement parti du réseau.</span><span class="sxs-lookup"><span data-stu-id="92210-116">While applications need know only a server's CLSID, because they can rely on the registry to locate the server, COM allows clients to override registry entries and to specify server locations, to take full advantage of the network.</span></span> <span data-ttu-id="92210-117">(Consultez [localisation d’un objet distant](locating-a-remote-object.md).)</span><span class="sxs-lookup"><span data-stu-id="92210-117">(See [Locating a Remote Object](locating-a-remote-object.md).)</span></span>

<span data-ttu-id="92210-118">La méthode de base pour créer une instance d’une classe s’effectue via un *objet de classe* com.</span><span class="sxs-lookup"><span data-stu-id="92210-118">The basic way to create an instance of a class is through a COM *class object*.</span></span> <span data-ttu-id="92210-119">Il s’agit simplement d’un objet intermédiaire qui prend en charge les fonctions communes à la création de nouvelles instances d’une classe donnée.</span><span class="sxs-lookup"><span data-stu-id="92210-119">This is simply an intermediate object that supports functions common to creating new instances of a given class.</span></span> <span data-ttu-id="92210-120">La plupart des objets de classe utilisés pour créer des objets à partir d’un CLSID prennent en charge l’interface [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) , une interface qui comprend la méthode [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) importante.</span><span class="sxs-lookup"><span data-stu-id="92210-120">Most class objects used to create objects from a CLSID support the [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, an interface that includes the important [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) method.</span></span> <span data-ttu-id="92210-121">Vous implémentez une interface **IClassFactory** pour chaque classe d’objet que vous offrez pour être instanciée.</span><span class="sxs-lookup"><span data-stu-id="92210-121">You implement an **IClassFactory** interface for each class of object that you offer to be instantiated.</span></span> <span data-ttu-id="92210-122">(Pour plus d’informations sur l’implémentation de **IClassFactory**, consultez [implémentation de IClassFactory](implementing-iclassfactory.md).)</span><span class="sxs-lookup"><span data-stu-id="92210-122">(For more information about implementing **IClassFactory**, see [Implementing IClassFactory](implementing-iclassfactory.md).)</span></span>

> [!Note]  
> <span data-ttu-id="92210-123">Les serveurs qui prennent en charge une autre interface de fabrique de classes personnalisée ne sont pas requis pour la prise en charge de [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) spécifiquement.</span><span class="sxs-lookup"><span data-stu-id="92210-123">Servers that support some other custom class factory interface are not required to support [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) specifically.</span></span> <span data-ttu-id="92210-124">Toutefois, les appels aux fonctions d’activation autres que [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (par exemple [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) requièrent que le serveur prenne en charge **IClassFactory**.</span><span class="sxs-lookup"><span data-stu-id="92210-124">However, calls to activation functions other than [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (such as [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) require that the server support **IClassFactory**.</span></span>

 

<span data-ttu-id="92210-125">Lorsqu’un client souhaite créer une instance de l’objet du serveur, il utilise le CLSID de l’objet souhaité dans un appel à [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span><span class="sxs-lookup"><span data-stu-id="92210-125">When a client wants to create an instance of the server's object, it uses the desired object's CLSID in a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span></span> <span data-ttu-id="92210-126">(Cet appel peut être direct ou implicite, via l’une des fonctions d’assistance de création d’objet.) Cette fonction localise le code associé au CLSID, crée un objet de classe et fournit un pointeur vers l’interface demandée.</span><span class="sxs-lookup"><span data-stu-id="92210-126">(This call can be either direct or implicit, through one of the object creation helper functions.) This function locates the code associated with the CLSID, and creates a class object, and supplies a pointer to the interface requested.</span></span> <span data-ttu-id="92210-127">(**CoGetClassObject** prend un paramètre *riid* qui spécifie le pointeur d’interface souhaité du client.)</span><span class="sxs-lookup"><span data-stu-id="92210-127">(**CoGetClassObject** takes a *riid* param that specifies the client's desired interface pointer.)</span></span>

> [!Note]  
> <span data-ttu-id="92210-128">COM n’a que quelques fonctions sur lesquelles la plupart des autres sont générées.</span><span class="sxs-lookup"><span data-stu-id="92210-128">COM has just a few functions upon which many of the others are built.</span></span> <span data-ttu-id="92210-129">Les plus importants sont probablement [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), qui sous-tend toutes les fonctions de création d’instance.</span><span class="sxs-lookup"><span data-stu-id="92210-129">The most important of these is probably [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which underlies all of the instance creation functions.</span></span>

 

<span data-ttu-id="92210-130">Avec ce pointeur, l’appelant peut créer une instance de l’objet et récupérer un pointeur vers une interface demandée sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="92210-130">With this pointer, the caller can create an instance of the object and retrieve a pointer to a requested interface on the object.</span></span> <span data-ttu-id="92210-131">Il s’agit généralement d’une interface d’initialisation, utilisée pour activer l’objet (le placer dans l’État en cours d’exécution) afin que le client puisse faire tout ce qu’il veut avec l’objet.</span><span class="sxs-lookup"><span data-stu-id="92210-131">This is usually an initialization interface, used to activate the object (put it in the running state) so that the client can do whatever work with the object that it wants to.</span></span> <span data-ttu-id="92210-132">À l’aide des fonctions de base de COM, le client doit également veiller à libérer tous les pointeurs d’objet.</span><span class="sxs-lookup"><span data-stu-id="92210-132">Using COM's basic functions, the client must also take care to release all object pointers.</span></span>

<span data-ttu-id="92210-133">Un autre mécanisme d’activation d’instances d’objet s’effectue par le biais du moniker de classe.</span><span class="sxs-lookup"><span data-stu-id="92210-133">Another mechanism for activating object instances is through the class moniker.</span></span> <span data-ttu-id="92210-134">Les monikers de classe sont liés à l’objet de classe de la classe pour laquelle ils sont créés.</span><span class="sxs-lookup"><span data-stu-id="92210-134">Class monikers bind to the class object of the class for which they are created.</span></span> <span data-ttu-id="92210-135">Pour plus d’informations, consultez [monikers de classes](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="92210-135">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="92210-136">COM fournit plusieurs fonctions d’assistance qui réduisent le travail de création d’instances d’objet.</span><span class="sxs-lookup"><span data-stu-id="92210-136">COM provides several helper functions that reduce the work of creating object instances.</span></span> <span data-ttu-id="92210-137">Celles-ci sont décrites dans [fonctions d’assistance de création d’instance](instance-creation-helper-functions.md).</span><span class="sxs-lookup"><span data-stu-id="92210-137">These are described in [Instance Creation Helper Functions](instance-creation-helper-functions.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="92210-138">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="92210-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="92210-139">Création d’un objet à l’aide d’un objet de classe</span><span class="sxs-lookup"><span data-stu-id="92210-139">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 