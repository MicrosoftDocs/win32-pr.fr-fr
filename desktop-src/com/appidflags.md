---
title: AppIDFlags
description: Jeu d’indicateurs qui contrôlent le comportement d’activation d’un serveur COM.
ms.assetid: ab98e7d3-85c6-4328-84c4-1d4583df69ce
keywords:
- Valeur de Registre AppIDFlags COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cdad2b80625d6a60460d43f242d7897e0ae7eb40
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "106511515"
---
# <a name="appidflags"></a><span data-ttu-id="9f007-104">AppIDFlags</span><span class="sxs-lookup"><span data-stu-id="9f007-104">AppIDFlags</span></span>

<span data-ttu-id="9f007-105">Jeu d’indicateurs qui contrôlent le comportement d’activation d’un serveur COM.</span><span class="sxs-lookup"><span data-stu-id="9f007-105">A set of flags that control the activation behavior of a COM server.</span></span>

## <a name="registry-entry"></a><span data-ttu-id="9f007-106">Entrée de Registre</span><span class="sxs-lookup"><span data-stu-id="9f007-106">Registry Entry</span></span>

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      AppIDFlags = flags
```

## <a name="remarks"></a><span data-ttu-id="9f007-107">Notes</span><span class="sxs-lookup"><span data-stu-id="9f007-107">Remarks</span></span>

<span data-ttu-id="9f007-108">Il s’agit d’une valeur de **Registre \_ DWORD** .</span><span class="sxs-lookup"><span data-stu-id="9f007-108">This is a **REG\_DWORD** value.</span></span>



| <span data-ttu-id="9f007-109">Valeur de l’indicateur</span><span class="sxs-lookup"><span data-stu-id="9f007-109">Flag Value</span></span> | <span data-ttu-id="9f007-110">Constante</span><span class="sxs-lookup"><span data-stu-id="9f007-110">Constant</span></span>                                              |
|------------|-------------------------------------------------------|
| <span data-ttu-id="9f007-111">0x1</span><span class="sxs-lookup"><span data-stu-id="9f007-111">0x1</span></span>        | <span data-ttu-id="9f007-112">APPIDREGFLAGS \_ activer \_ IUSERVER \_ indesktop</span><span class="sxs-lookup"><span data-stu-id="9f007-112">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP</span></span>          |
| <span data-ttu-id="9f007-113">0x2</span><span class="sxs-lookup"><span data-stu-id="9f007-113">0x2</span></span>        | <span data-ttu-id="9f007-114">APPIDREGFLAGS \_ \_ \_ \_ SD \_ et \_ Bind du processus de serveur sécurisé</span><span class="sxs-lookup"><span data-stu-id="9f007-114">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND</span></span> |
| <span data-ttu-id="9f007-115">0x4</span><span class="sxs-lookup"><span data-stu-id="9f007-115">0x4</span></span>        | <span data-ttu-id="9f007-116">APPIDREGFLAGS \_ problème d' \_ Activation \_ RPC à l' \_ \_ identification</span><span class="sxs-lookup"><span data-stu-id="9f007-116">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY</span></span>   |



 

### <a name="appidregflags_activate_iuserver_indesktop-description"></a><span data-ttu-id="9f007-117">APPIDREGFLAGS \_ activer \_ IUSERVER \_ Description de l’ordinateur de bureau</span><span class="sxs-lookup"><span data-stu-id="9f007-117">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP Description</span></span>

<span data-ttu-id="9f007-118">Si l’indicateur **APPIDREGFLAGS \_ Activate \_ IUSERVER \_ indesktop** est effacé dans **AppIDFlags** ou si **AppIDFlags** n’est pas présent, le client d’une session Terminal Server effectuant une demande d’activation pour un serveur COM [utilisateur interactif](interactive-user.md) , crée une liaison ou lance le serveur com dans le bureau « par défaut » de la session de la [fenêtre](/windows/desktop/winstation/window-stations) « winsta0 » de la session dans la demande d’activation.</span><span class="sxs-lookup"><span data-stu-id="9f007-118">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is cleared in **AppIDFlags** or if **AppIDFlags** is not present, the client in a terminal server session making an activation request for an [Interactive User](interactive-user.md) COM server, will either bind to, or launch and bind to, the COM server in the "default" desktop of the "winsta0" [window station](/windows/desktop/winstation/window-stations) of the session in the activation request.</span></span> <span data-ttu-id="9f007-119">Par exemple, si le client exécute « winsta0 \\ Desktop1 » de la session 3, la demande d’activation pour la session 3 crée une liaison ou un lancement et une liaison avec le serveur com dans « winsta0 \\ default » de la session 3, même si une instance du serveur com est déjà en cours d’exécution dans « winsta0 \\ Desktop1 » de la session 3.</span><span class="sxs-lookup"><span data-stu-id="9f007-119">For example, if the client is running "winsta0\\desktop1" of session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\default" of session 3, even if an instance of the COM server is already running in "winsta0\\desktop1" of session 3.</span></span>

<span data-ttu-id="9f007-120">Si l’indicateur **APPIDREGFLAGS \_ Activate \_ IUSERVER \_** est défini dans la valeur **AppIDFlags** , com crée une liaison avec le processus serveur qui s’exécute sur le Bureau du client et la session dans la demande d’activation, ou le lance et le lie.</span><span class="sxs-lookup"><span data-stu-id="9f007-120">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is set in the **AppIDFlags** value, COM will either bind to, or launch and bind to, the server process running in the client's desktop and the session in the activation request.</span></span> <span data-ttu-id="9f007-121">Par exemple, si le client exécute « winsta0 \\ Desktop1 » dans la session 3, la demande d’activation pour la session 3 crée une liaison, ou lance et crée une liaison avec le serveur com dans « winsta0 \\ Desktop1 » dans la session 3, même si une instance du serveur com est déjà en cours d’exécution dans « winsta0 \\ default » dans la session 3.</span><span class="sxs-lookup"><span data-stu-id="9f007-121">For example, if the client is running "winsta0\\desktop1" in session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\desktop1" in session 3, even if an instance of the COM server is already running in "winsta0\\default" in session 3.</span></span>

<span data-ttu-id="9f007-122">Le client peut utiliser le [moniker de session](/windows/desktop/TermServ/session-monikers) pour spécifier une session différente de la session du client lorsqu’il effectue la demande d’activation.</span><span class="sxs-lookup"><span data-stu-id="9f007-122">The client can use the [session moniker](/windows/desktop/TermServ/session-monikers) to specify a session different than the client's session when it makes the activation request.</span></span>

<span data-ttu-id="9f007-123">L’indicateur **APPIDREGFLAGS \_ Activate \_ IUSERVER \_ indesktop** s’applique uniquement aux serveurs com configurés pour runas «[interactive User](interactive-user.md)».</span><span class="sxs-lookup"><span data-stu-id="9f007-123">The **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag applies only to COM servers that are configured to RunAs "[Interactive User](interactive-user.md)".</span></span>

### <a name="appidregflags_secure_server_process_sd_and_bind-description"></a><span data-ttu-id="9f007-124">\_Description du \_ processus de sécurisation du serveur APPIDREGFLAGS \_ \_ SD \_ et de la \_ liaison</span><span class="sxs-lookup"><span data-stu-id="9f007-124">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND Description</span></span>

<span data-ttu-id="9f007-125">Si l’indicateur de **\_ \_ \_ \_ \_ liaison SD et \_ Bind du processus de serveur APPIDREGFLAGS** est défini dans **AppIDFlags**, les serveurs com configurés pour runas « Activator » seront lancés avec un descripteur de sécurité de processus qui autorise le processus à [ \_ \_ accéder](/windows/desktop/ProcThread/process-security-and-access-rights) au SID LogonID du jeton de processus.</span><span class="sxs-lookup"><span data-stu-id="9f007-125">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "Activator" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) to the LogonID SID of the process token.</span></span> <span data-ttu-id="9f007-126">En outre, le propriétaire du descripteur de sécurité sera défini sur le SID LogonID du jeton de processus.</span><span class="sxs-lookup"><span data-stu-id="9f007-126">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span>

<span data-ttu-id="9f007-127">Si l’indicateur de **\_ \_ \_ \_ \_ liaison SD et \_ Bind du processus de serveur APPIDREGFLAGS** est défini dans **AppIDFlags**, les serveurs com configurés pour runas « cet utilisateur » seront lancés avec un descripteur de sécurité de processus qui autorise le [processus \_ tout \_ accès](/windows/desktop/ProcThread/process-security-and-access-rights) dans le SID LogonID du jeton de processus.</span><span class="sxs-lookup"><span data-stu-id="9f007-127">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "This User" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) in the LogonID SID of the process token.</span></span> <span data-ttu-id="9f007-128">En outre, le propriétaire du descripteur de sécurité sera défini sur le SID LogonID du jeton de processus.</span><span class="sxs-lookup"><span data-stu-id="9f007-128">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span> <span data-ttu-id="9f007-129">En outre, le gestionnaire de contrôle des services COM (SCM) modifie le jeton du processus serveur COM comme suit :</span><span class="sxs-lookup"><span data-stu-id="9f007-129">Further, the COM Service Control Manager (SCM) modifies the token of the COM server process as follows:</span></span>

-   <span data-ttu-id="9f007-130">Elle ajoute un SID APPID au jeton.</span><span class="sxs-lookup"><span data-stu-id="9f007-130">It adds an APPID SID to the token.</span></span> <span data-ttu-id="9f007-131">Elle accorde l’accès complet au SID APPID dans la liste de contrôle d’accès discrétionnaire (DACL, Discretionary Access Control List) du jeton par défaut.</span><span class="sxs-lookup"><span data-stu-id="9f007-131">It grants the APPID SID full access in the token default discretionary access control list (DACL).</span></span> <span data-ttu-id="9f007-132">Dans Windows Vista et les versions ultérieures de Windows, il accorde l’autorisation de contrôle de lecture du SID OwnerRights \_ dans la liste DACL par défaut du jeton.</span><span class="sxs-lookup"><span data-stu-id="9f007-132">In Windows Vista and later versions of Windows, it grants the OwnerRights SID READ\_CONTROL permission in the token default DACL.</span></span> <span data-ttu-id="9f007-133">Dans les versions antérieures à Windows Vista de Windows, il définit le propriétaire du jeton sur le SID APPID.</span><span class="sxs-lookup"><span data-stu-id="9f007-133">In pre-Windows Vista versions of Windows, it sets the token owner to the APPID SID.</span></span>

<span data-ttu-id="9f007-134">Les considérations de sécurité suivantes doivent être prises en compte lors de l’utilisation de l’indicateur **\_ \_ \_ \_ SD \_ et \_ Bind du processus de serveur APPIDREGFLAGS sécurisé** :</span><span class="sxs-lookup"><span data-stu-id="9f007-134">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag:</span></span>

-   <span data-ttu-id="9f007-135">L' **indicateur \_ \_ \_ \_ SD \_ et \_ Bind du processus de serveur sécurisé APPIDREGFLAGS** est destiné à être défini par les serveurs com qui sont lancés sous l’un des contextes de sécurité de service intégrés, à savoir les comptes NetworkService ou LocalService.</span><span class="sxs-lookup"><span data-stu-id="9f007-135">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is meant to be set by COM servers that are launched under one of the built-in service security contexts; either the NetworkService or the LocalService accounts.</span></span> <span data-ttu-id="9f007-136">Si les serveurs empruntent l’identité des clients privilégiés et que l’indicateur de **\_ \_ \_ \_ \_ liaison SD et \_ Bind du processus de serveur APPIDREGFLAGS** n’est pas défini, le code malveillant s’exécutant dans d’autres processus avec le même contexte de sécurité peut élever les privilèges en détournant les jetons d’emprunt d’identité des clients privilégiés à partir du processus serveur com.</span><span class="sxs-lookup"><span data-stu-id="9f007-136">If the servers impersonate privileged clients and if the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is not set, malicious code running in other processes with the same security context can elevate privilege by hijacking the impersonation tokens of the privileged clients from the COM server process.</span></span>
-   <span data-ttu-id="9f007-137">Lorsque l’indicateur de **\_ \_ \_ \_ \_ liaison SD et \_ Bind du processus du serveur APPIDREGFLAGS** est défini, com renforce le descripteur de sécurité de l’objet processus dans le cas de serveurs com « Activator » runas.</span><span class="sxs-lookup"><span data-stu-id="9f007-137">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "Activator" COM servers.</span></span> <span data-ttu-id="9f007-138">Pour ces serveurs, le client COM est supposé renforcer le jeton qu’il utilise pour l’activation COM.</span><span class="sxs-lookup"><span data-stu-id="9f007-138">For such servers, the COM client is expected to harden the token that it uses for the COM activation.</span></span>
-   <span data-ttu-id="9f007-139">Lorsque l’indicateur de **\_ \_ \_ \_ \_ liaison SD et \_ Bind du processus de serveur APPIDREGFLAGS sécurisé** est défini, com renforce le descripteur de sécurité de l’objet processus dans le cas des serveurs com « cet utilisateur » runas.</span><span class="sxs-lookup"><span data-stu-id="9f007-139">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "This User" COM servers.</span></span> <span data-ttu-id="9f007-140">Elle renforce également le jeton de processus du serveur COM puisque le SCM COM est l’entité qui crée le jeton.</span><span class="sxs-lookup"><span data-stu-id="9f007-140">It also hardens the process token of the COM server since the COM SCM is the entity that creates the token.</span></span>

<span data-ttu-id="9f007-141">L' **indicateur \_ \_ \_ \_ SD \_ et \_ Bind du processus de serveur sécurisé APPIDREGFLAGS** est pris en charge dans Windows XP, Windows server 2003, Windows Vista et Windows Server 2008 uniquement lorsque le correctif MSRC8322 ([Bulletin de sécurité MS09-012](https://support.microsoft.com/kb/959454)) est appliqué.</span><span class="sxs-lookup"><span data-stu-id="9f007-141">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is supported in Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008 only when the MSRC8322 patch ([security bulletin MS09-012](https://support.microsoft.com/kb/959454)) is applied.</span></span> <span data-ttu-id="9f007-142">Il est pris en charge en mode natif dans Windows 7 et les versions ultérieures de Windows.</span><span class="sxs-lookup"><span data-stu-id="9f007-142">It is natively supported in Windows 7 and later versions of Windows.</span></span>

<span data-ttu-id="9f007-143">L' **indicateur \_ \_ \_ \_ SD \_ et \_ Bind du processus de serveur sécurisé APPIDREGFLAGS** s’applique uniquement aux serveurs com configurés pour runas « Activator » ou « cet utilisateur ».</span><span class="sxs-lookup"><span data-stu-id="9f007-143">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag applies only to COM servers that are configured to RunAs "Activator" or "This User".</span></span> <span data-ttu-id="9f007-144">Elle ne s’applique pas aux serveurs COM qui sont des services NT.</span><span class="sxs-lookup"><span data-stu-id="9f007-144">It does not apply to COM servers that are NT services.</span></span>

### <a name="appidregflags_issue_activation_rpc_at_identify-description"></a><span data-ttu-id="9f007-145">APPIDREGFLAGS \_ problème d' \_ Activation \_ RPC à la \_ Description de l' \_ identification</span><span class="sxs-lookup"><span data-stu-id="9f007-145">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY Description</span></span>

<span data-ttu-id="9f007-146">Si la **APPIDREGFLAGS d' \_ activation du problème d' \_ Activation \_ RPC \_ à \_** l’indicateur d’identification est définie dans **AppIDFlags**, le SCM com émettra des demandes d’activation d’objet au processus serveur com en utilisant un niveau d’emprunt d’identité de l’identification du [niveau d' \_ \_ IMP \_ \_ RPC C](impersonation-levels.md).</span><span class="sxs-lookup"><span data-stu-id="9f007-146">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is set in **AppIDFlags**, the COM SCM will issue object activation requests to the COM server process using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md).</span></span>

<span data-ttu-id="9f007-147">Si le **APPIDREGFLAGS d' \_ activation du problème \_ \_ RPC \_ à \_** l’indicateur d’identification n’est pas défini, le SCM com émettra des demandes d’activation d’objet aux processus du serveur com en utilisant un niveau d’emprunt d’identité de l' [emprunt d' \_ \_ \_ \_ identité RPC C IMP](impersonation-levels.md).</span><span class="sxs-lookup"><span data-stu-id="9f007-147">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is not set, the COM SCM will issue object activation requests to the COM server processes using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IMPERSONATE](impersonation-levels.md).</span></span>

<span data-ttu-id="9f007-148">Les considérations de sécurité suivantes doivent être prises en compte lors de l’utilisation du **RPC d’activation du problème APPIDREGFLAGS à l’indicateur d' \_ \_ \_ \_ \_ identification** :</span><span class="sxs-lookup"><span data-stu-id="9f007-148">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag:</span></span>

-   <span data-ttu-id="9f007-149">L’activation de l’indicateur **APPIDREGFLAGS \_ \_ Activation \_ RPC \_ à \_** l’indicateur d’identification est destinée à être utilisée par les serveurs com qui n’effectuent pas de travail pour le compte des clients dans les demandes d’activation d’objet.</span><span class="sxs-lookup"><span data-stu-id="9f007-149">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is meant to be used by COM servers that do not perform work on behalf of clients in object activation requests.</span></span> <span data-ttu-id="9f007-150">Pour ces serveurs, le fait d’avoir le SCM COM émettre des demandes d’activation d’objet au [ \_ niveau RPC C \_ IMP \_ Level \_ identifier](impersonation-levels.md) réduit le risque de jetons privilégiés avec le niveau de [**\_ \_ nom emprunter l’identité se**](/windows/desktop/SecAuthZ/privilege-constants) qui apparaît dans le processus.</span><span class="sxs-lookup"><span data-stu-id="9f007-150">For such servers, having the COM SCM issue object activation requests at [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md) minimizes the chances of privileged tokens with [**SE\_IMPERSONATE\_NAME**](/windows/desktop/SecAuthZ/privilege-constants) level appearing in the process.</span></span>

<span data-ttu-id="9f007-151">L' **activation de l' \_ émission \_ \_ RPC \_ à \_** l’indicateur APPIDREGFLAGS dans l’indicateur d’identification est prise en charge dans Windows 7 et les versions ultérieures de Windows.</span><span class="sxs-lookup"><span data-stu-id="9f007-151">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is supported in Windows 7 and later versions of Windows.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9f007-152">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="9f007-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9f007-153">Bureaux</span><span class="sxs-lookup"><span data-stu-id="9f007-153">Desktops</span></span>](/windows/desktop/winstation/desktops)
</dt> <dt>

[<span data-ttu-id="9f007-154">Niveaux d’emprunt d’identité</span><span class="sxs-lookup"><span data-stu-id="9f007-154">Impersonation Levels</span></span>](impersonation-levels.md)
</dt> <dt>

[<span data-ttu-id="9f007-155">Utilisateur interactif</span><span class="sxs-lookup"><span data-stu-id="9f007-155">Interactive User</span></span>](interactive-user.md)
</dt> <dt>

[<span data-ttu-id="9f007-156">Monikers de session</span><span class="sxs-lookup"><span data-stu-id="9f007-156">Session Monikers</span></span>](/windows/desktop/TermServ/session-monikers)
</dt> <dt>

[<span data-ttu-id="9f007-157">Stations Windows</span><span class="sxs-lookup"><span data-stu-id="9f007-157">Window Stations</span></span>](/windows/desktop/winstation/window-stations)
</dt> </dl>

 

 