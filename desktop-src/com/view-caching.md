---
title: Afficher la mise en cache
description: Afficher la mise en cache
ms.assetid: d19c111c-1367-43a2-97a9-35dc0ff5dcc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 592c5bc2555e907cdc4e600465b807387c3a5548
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104382927"
---
# <a name="view-caching"></a><span data-ttu-id="417ae-103">Afficher la mise en cache</span><span class="sxs-lookup"><span data-stu-id="417ae-103">View Caching</span></span>

<span data-ttu-id="417ae-104">Une application conteneur doit être en mesure d’obtenir une présentation d’un objet afin de l’afficher ou de l’imprimer pour les utilisateurs lorsque le document est ouvert, mais que l’application serveur de l’objet n’est pas en cours d’exécution ou n’est pas installée sur l’ordinateur de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="417ae-104">A container application must be able to obtain a presentation of an object for the purpose of displaying or printing it for users when the document is open but the object's server application is not running or is not installed on the user's machine.</span></span> <span data-ttu-id="417ae-105">Toutefois, en supposant que les serveurs pour tous les objets qui peuvent se trouver dans un document sont installés sur l’ordinateur de chaque utilisateur et peuvent toujours s’exécuter à la demande est irréaliste.</span><span class="sxs-lookup"><span data-stu-id="417ae-105">To assume, however, that the servers for all the objects that might conceivably be found in a document are installed on every user's machine and can always run on demand is unrealistic.</span></span> <span data-ttu-id="417ae-106">Le gestionnaire d’objets par défaut, qui est disponible à tout moment, résout ce dilemme en mettant en cache les présentations d’objets dans le stockage du document et en manipulant ces présentations sur n’importe quelle plateforme, quel que soit le disponibilité du serveur d’objets sur une installation particulière du conteneur.</span><span class="sxs-lookup"><span data-stu-id="417ae-106">The default object handler, which is available at all times, solves this dilemma by caching object presentations in the document's storage and manipulating these presentations on any platform regardless of the availablility of the object server on any particular installation of the container.</span></span>

<span data-ttu-id="417ae-107">Les conteneurs peuvent conserver des présentations de dessin pour un ou plusieurs appareils cibles spécifiques en plus de celui requis pour gérer l’objet à l’écran.</span><span class="sxs-lookup"><span data-stu-id="417ae-107">Containers can maintain drawing presentations for one or more specific target devices in addition to the one required to maintain the object on screen.</span></span> <span data-ttu-id="417ae-108">En outre, si vous portez l’objet d’une plateforme à une autre, OLE convertit automatiquement les formats de données de l’objet en ceux pris en charge sur la nouvelle plateforme.</span><span class="sxs-lookup"><span data-stu-id="417ae-108">Moreover, if you port the object from one platform to another, OLE automatically converts the object's data formats to ones supported on the new platform.</span></span> <span data-ttu-id="417ae-109">Par exemple, si vous déplacez un objet de Windows vers le Macintosh, OLE convertit ses présentations de métafichiers au format PICT.</span><span class="sxs-lookup"><span data-stu-id="417ae-109">For example, if you move an object from Windows to the Macintosh, OLE will convert its metafile presentations to PICT formats.</span></span>

<span data-ttu-id="417ae-110">Pour présenter une représentation exacte d’un objet incorporé à l’utilisateur, l’application conteneur de l’objet lance une boîte de dialogue avec le gestionnaire d’objets, en demandant des données et des instructions de dessin.</span><span class="sxs-lookup"><span data-stu-id="417ae-110">In order to present an accurate representation of an embedded object to the user, the object's container application initiates a dialog with the object handler, requesting data and drawing instructions.</span></span> <span data-ttu-id="417ae-111">Pour pouvoir traiter les demandes du conteneur, le gestionnaire doit implémenter les interfaces [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)et [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) .</span><span class="sxs-lookup"><span data-stu-id="417ae-111">To be able to fulfill the container's requests, the handler must implement the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2), and [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) interfaces.</span></span>

<span data-ttu-id="417ae-112">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) permet à une application de conteneur OLE d’extraire et d’envoyer des données à ses objets incorporés ou liés.</span><span class="sxs-lookup"><span data-stu-id="417ae-112">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) enables an OLE container application to get data from and send data to its embedded or linked objects.</span></span> <span data-ttu-id="417ae-113">Lorsque les données sont modifiées dans un objet, cette interface permet à l’objet de rendre ses nouvelles données disponibles à son conteneur et fournit au conteneur un moyen de mettre à jour les données dans sa copie de l’objet.</span><span class="sxs-lookup"><span data-stu-id="417ae-113">When data changes in an object, this interface provides a way for the object to make its new data available to its container and provides the container with a way to update the data in its copy of the object.</span></span> <span data-ttu-id="417ae-114">(Pour plus d’informations sur le transfert de données en général, consultez le chapitre 4, Transfert de données.)</span><span class="sxs-lookup"><span data-stu-id="417ae-114">(For a discussion of data transfer in general, see Chapter 4, Data Transfer.)</span></span>

<span data-ttu-id="417ae-115">L’interface [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) est très similaire à l’interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , à ceci près qu’elle demande à un objet de se dessiner lui-même sur un contexte de périphérique, tel qu’un écran, une imprimante ou un métafichier, plutôt que de déplacer ou de copier ses données vers la mémoire ou un autre moyen de transfert.</span><span class="sxs-lookup"><span data-stu-id="417ae-115">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface is very much like the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface except that it asks an object to draw itself on a device context, such as a screen, printer, or metafile, rather than move or copy its data to memory or some other transfer medium.</span></span> <span data-ttu-id="417ae-116">L’objectif de l’interface est de permettre à un conteneur OLE d’obtenir des représentations graphiques alternatives de ses objets incorporés, dont il possède déjà les données, évitant ainsi la surcharge liée à la nécessité de transférer des instances entièrement nouvelles des mêmes objets de données simplement pour obtenir de nouvelles instructions de dessin.</span><span class="sxs-lookup"><span data-stu-id="417ae-116">The purpose of the interface is to enable an OLE container to obtain alternative pictorial representations of its embedded objects, whose data it already has, thereby avoiding the overhead of having to transfer entirely new instances of the same data objects simply to obtain new drawing instructions.</span></span> <span data-ttu-id="417ae-117">Au lieu de cela, l’interface **IViewObject2** permet au conteneur de demander à un objet de fournir une représentation graphique de lui-même en dessinant sur un contexte de périphérique spécifié par le conteneur.</span><span class="sxs-lookup"><span data-stu-id="417ae-117">Instead, the **IViewObject2** interface enables the container to ask an object to provide a pictorial representation of itself by drawing on a device context specified by the container.</span></span>

<span data-ttu-id="417ae-118">Lors de l’appel de l’interface [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) , une application conteneur peut également spécifier que l’objet se dessine sur un appareil cible différent de celui sur lequel il sera effectivement rendu.</span><span class="sxs-lookup"><span data-stu-id="417ae-118">When calling the [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface, a container application can also specify that the object draw itself on a target device different than the one on which it will actually be rendered.</span></span> <span data-ttu-id="417ae-119">Cela permet au conteneur, si nécessaire, de générer différents rendus à partir d’un seul objet.</span><span class="sxs-lookup"><span data-stu-id="417ae-119">This enables the container, as needed, to generate different renderings from a single object.</span></span> <span data-ttu-id="417ae-120">Par exemple, l’appelant peut demander à l’objet de se composer lui-même pour une imprimante même si le dessin qui en résulte s’affiche à l’écran.</span><span class="sxs-lookup"><span data-stu-id="417ae-120">For example, the caller could ask the object to compose itself for a printer even though the resulting drawing will be rendered on screen.</span></span> <span data-ttu-id="417ae-121">Le résultat, bien sûr, serait un aperçu avant impression de l’objet.</span><span class="sxs-lookup"><span data-stu-id="417ae-121">The result, of course, would be a print-preview of the object.</span></span>

<span data-ttu-id="417ae-122">L’interface [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)fournit également des méthodes qui permettent aux conteneurs de s’inscrire pour les notifications de modification d’affichage.</span><span class="sxs-lookup"><span data-stu-id="417ae-122">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)interface also provides methods that enable containers to register for view-change notifications.</span></span> <span data-ttu-id="417ae-123">Comme avec les données et les avis OLE, une connexion de notification de vue permet à un conteneur de mettre à jour ses rendus d’un objet à sa propre commodité plutôt qu’en réponse à un appel de l’objet.</span><span class="sxs-lookup"><span data-stu-id="417ae-123">As with data and OLE advisories, a view advisory connection enables a container to update its renderings of an object at its own convenience rather than in response to a call from the object.</span></span> <span data-ttu-id="417ae-124">Par exemple, si une nouvelle version de l’application serveur d’un objet devait offrir des vues supplémentaires des mêmes données, le gestionnaire par défaut de l’objet appellera l’implémentation de [**IAdviseSink :: OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) de chaque conteneur pour signaler que les nouvelles présentations étaient disponibles.</span><span class="sxs-lookup"><span data-stu-id="417ae-124">For example, if a new version of an object's server application were to offer additional views of the same data, the object's default handler would call each container's implementation of [**IAdviseSink::OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) to let them know that the new presentations were available.</span></span> <span data-ttu-id="417ae-125">Le conteneur récupère ces informations à partir du récepteur de notifications uniquement lorsque cela est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="417ae-125">The container would retrieve this information from the advise sink only when needed.</span></span>

<span data-ttu-id="417ae-126">Étant donné que les contextes de périphérique Windows ont une signification uniquement au sein d’un processus unique, vous ne pouvez pas passer de pointeurs [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) au-delà des limites de processus.</span><span class="sxs-lookup"><span data-stu-id="417ae-126">Because Windows device contexts have meaning only within a single process, you cannot pass [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) pointers across process boundaries.</span></span> <span data-ttu-id="417ae-127">Par conséquent, les serveurs OLE locaux et distants n’ont pas besoin d’implémenter l’interface, ce qui ne fonctionnerait pas correctement même s’ils l’ont fait.</span><span class="sxs-lookup"><span data-stu-id="417ae-127">As a result, OLE local and remote servers have no need whatsoever to implement the interface, which wouldn't work properly even if they did.</span></span> <span data-ttu-id="417ae-128">Seuls les gestionnaires d’objets et les serveurs in-process implémentent l’interface **IViewObject2**.</span><span class="sxs-lookup"><span data-stu-id="417ae-128">Only object handlers and in-process servers implement the **IViewObject2** interface.</span></span> <span data-ttu-id="417ae-129">OLE fournit une implémentation par défaut, que vous pouvez utiliser dans vos propres serveurs OLE in-process et gestionnaires d’objets en agrégeant simplement le gestionnaire OLE par défaut.</span><span class="sxs-lookup"><span data-stu-id="417ae-129">OLE provides a default implementation, which you can use in your own OLE in-process servers and object handlers simply by aggregating the OLE default handler.</span></span> <span data-ttu-id="417ae-130">Vous pouvez ou écrire votre propre implémentation de **IViewObject2**.</span><span class="sxs-lookup"><span data-stu-id="417ae-130">Or you can write your own implementation of **IViewObject2**.</span></span>

<span data-ttu-id="417ae-131">Un objet implémente l’interface [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) afin de permettre au gestionnaire de connaître les fonctionnalités qu’il doit mettre en cache.</span><span class="sxs-lookup"><span data-stu-id="417ae-131">An object implements the [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) interface in order to let the handler know what capabilities it should cache.</span></span> <span data-ttu-id="417ae-132">Le gestionnaire d’objets possède également le cache et s’assure qu’il est tenu à jour.</span><span class="sxs-lookup"><span data-stu-id="417ae-132">The object handler also owns the cache and ensures it is kept up to date.</span></span> <span data-ttu-id="417ae-133">Lorsque l’objet incorporé passe à l’État en cours d’exécution, le gestionnaire définit des connexions de notifications appropriées sur l’objet serveur, avec lui-même le récepteur.</span><span class="sxs-lookup"><span data-stu-id="417ae-133">As the embedded object enters the running state, the handler sets up appropriate advisory connections on the server object, with itself acting as the sink.</span></span> <span data-ttu-id="417ae-134">Les implémentations de l’interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) et [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)fonctionnent à partir de données mises en cache côté client.</span><span class="sxs-lookup"><span data-stu-id="417ae-134">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)interface implementations operate out of data cached on the client side.</span></span> <span data-ttu-id="417ae-135">L’implémentation du gestionnaire de **IViewObject2** est responsable de la détermination des formats de données à mettre en cache pour répondre aux demandes de dessin du client.</span><span class="sxs-lookup"><span data-stu-id="417ae-135">The handler's implementation of **IViewObject2** is responsible for determining what data formats to cache in order to satisfy client draw requests.</span></span> <span data-ttu-id="417ae-136">L’implémentation de **IDataObject** par le gestionnaire est chargée d’obtenir des données dans différents formats, etc., entre la mémoire et l’instance [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) sous-jacente de l’objet incorporé.</span><span class="sxs-lookup"><span data-stu-id="417ae-136">The handler's implementation of **IDataObject** is responsible for getting data in various formats, etc., between memory and the underlying [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) instance of the embedded object.</span></span> <span data-ttu-id="417ae-137">Les gestionnaires personnalisés peuvent utiliser ces implémentations en regroupant sur le gestionnaire par défaut.</span><span class="sxs-lookup"><span data-stu-id="417ae-137">Custom handlers can use these implementations by aggregating on the default handler.</span></span>

> [!Note]  
> <span data-ttu-id="417ae-138">L’interface [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) est une extension fonctionnelle simple de [**IViewObject**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) et doit être implémentée à la place de la dernière interface, qui est désormais obsolète.</span><span class="sxs-lookup"><span data-stu-id="417ae-138">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface is a simple functional extension of [**IViewObject**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) and should be implemented instead of the latter interface, which is now obsolete.</span></span> <span data-ttu-id="417ae-139">En plus de fournir les méthodes **IViewObject** , l’interface **IViewObject2** fournit un membre supplémentaire unique, [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent), qui permet à une application de conteneur d’obtenir la taille de la présentation d’un objet à partir du cache sans avoir d’abord à déplacer l’objet vers l’État en cours d’exécution avec un appel à [**IOleObject :: GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent).</span><span class="sxs-lookup"><span data-stu-id="417ae-139">In addition to providing the **IViewObject** methods, the **IViewObject2** interface provides a single additional member, [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent), which enables a container application to get the size of an object's presentation from the cache without first having to move the object into the running state with a call to [**IOleObject::GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="417ae-140">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="417ae-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="417ae-141">Documents composés</span><span class="sxs-lookup"><span data-stu-id="417ae-141">Compound Documents</span></span>](compound-documents.md)
</dt> </dl>

 

 