---
title: Structure des codes d’erreur COM
description: Structure des codes d’erreur COM
ms.assetid: 97e68708-eb62-4481-af03-cf8b80304103
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb27143f50028592f6fe0aeb5cab9795dcd10d4a
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/03/2021
ms.locfileid: "104564031"
---
# <a name="structure-of-com-error-codes"></a><span data-ttu-id="bdf77-103">Structure des codes d’erreur COM</span><span class="sxs-lookup"><span data-stu-id="bdf77-103">Structure of COM Error Codes</span></span>

<span data-ttu-id="bdf77-104">L’illustration suivante montre le format d’un [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (ou SCODE); les nombres indiquent des positions de bits :</span><span class="sxs-lookup"><span data-stu-id="bdf77-104">The following illustration shows the format of an [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (or SCODE); the numbers indicate bit positions:</span></span>

![Affiche le format d’un « résultat » ou d’un « CODE » avec des nombres indiquant les positions de bits.](images/a5a947d1-7b5a-4474-afed-2a1c58fe2421.png)

<span data-ttu-id="bdf77-106">Le bit de poids fort dans **HRESULT** ou SCODE indique si la valeur de retour représente une réussite ou un échec.</span><span class="sxs-lookup"><span data-stu-id="bdf77-106">The high-order bit in the **HRESULT** or SCODE indicates whether the return value represents success or failure.</span></span> <span data-ttu-id="bdf77-107">Si la valeur est 0, le niveau de gravité est \_ réussite, la valeur indique réussite.</span><span class="sxs-lookup"><span data-stu-id="bdf77-107">If set to 0, SEVERITY\_SUCCESS, the value indicates success.</span></span> <span data-ttu-id="bdf77-108">Si la valeur est 1, \_ erreur de gravité, elle indique un échec.</span><span class="sxs-lookup"><span data-stu-id="bdf77-108">If set to 1, SEVERITY\_ERROR, it indicates failure.</span></span>

<span data-ttu-id="bdf77-109">Les bits R, C, N et r sont réservés.</span><span class="sxs-lookup"><span data-stu-id="bdf77-109">The R, C, N, and r bits are reserved.</span></span>

<span data-ttu-id="bdf77-110">Le champ installation indique le service système responsable de l’erreur.</span><span class="sxs-lookup"><span data-stu-id="bdf77-110">The facility field indicates the system service responsible for the error.</span></span> <span data-ttu-id="bdf77-111">Microsoft alloue de nouveaux codes d’installation à mesure qu’ils sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="bdf77-111">Microsoft allocates new facility codes as they become necessary.</span></span> <span data-ttu-id="bdf77-112">La plupart des valeurs SCODEs et **HRESULT** définissent le champ Facility sur Facility \_ ITF, indiquant une erreur de méthode d’interface.</span><span class="sxs-lookup"><span data-stu-id="bdf77-112">Most SCODEs and **HRESULT** values set the facility field to FACILITY\_ITF, indicating an interface method error.</span></span>

<span data-ttu-id="bdf77-113">Les champs d’installation courants sont décrits dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="bdf77-113">Common facility fields are described in the following table.</span></span>



| <span data-ttu-id="bdf77-114">Champ d’installation</span><span class="sxs-lookup"><span data-stu-id="bdf77-114">Facility Field</span></span>                | <span data-ttu-id="bdf77-115">Valeur</span><span class="sxs-lookup"><span data-stu-id="bdf77-115">Value</span></span>        | <span data-ttu-id="bdf77-116">Description</span><span class="sxs-lookup"><span data-stu-id="bdf77-116">Description</span></span>                                                                                                                                                                                                                                                                                                              |
|-------------------------------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="bdf77-117">répartition des installations \_</span><span class="sxs-lookup"><span data-stu-id="bdf77-117">FACILITY\_DISPATCH</span></span><br/> | <span data-ttu-id="bdf77-118">2</span><span class="sxs-lookup"><span data-stu-id="bdf77-118">2</span></span><br/> | <span data-ttu-id="bdf77-119">Pour les erreurs d’interface **IDispatch** à liaison tardive.</span><span class="sxs-lookup"><span data-stu-id="bdf77-119">For late-binding **IDispatch** interface errors.</span></span> <br/>                                                                                                                                                                                                                                                             |
| <span data-ttu-id="bdf77-120">ITF de l’installation \_</span><span class="sxs-lookup"><span data-stu-id="bdf77-120">FACILITY\_ITF</span></span><br/>      | <span data-ttu-id="bdf77-121">4</span><span class="sxs-lookup"><span data-stu-id="bdf77-121">4</span></span><br/> | <span data-ttu-id="bdf77-122">Pour la plupart des codes d’État retournés par les méthodes d’interface.</span><span class="sxs-lookup"><span data-stu-id="bdf77-122">For most status codes returned from interface methods.</span></span> <span data-ttu-id="bdf77-123">La signification réelle de l’erreur est définie par l’interface.</span><span class="sxs-lookup"><span data-stu-id="bdf77-123">The actual meaning of the error is defined by the interface.</span></span> <span data-ttu-id="bdf77-124">Autrement dit, deux valeurs **HRESULT** avec exactement la même valeur 32 bits retournée par deux interfaces différentes peuvent avoir des significations différentes.</span><span class="sxs-lookup"><span data-stu-id="bdf77-124">That is, two **HRESULT** s with exactly the same 32-bit value returned from two different interfaces might have different meanings.</span></span> <br/>                                                       |
| <span data-ttu-id="bdf77-125">NULL d’installation \_</span><span class="sxs-lookup"><span data-stu-id="bdf77-125">FACILITY\_NULL</span></span><br/>     | <span data-ttu-id="bdf77-126">0</span><span class="sxs-lookup"><span data-stu-id="bdf77-126">0</span></span><br/> | <span data-ttu-id="bdf77-127">Pour les codes d’État communs largement applicables tels que S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="bdf77-127">For broadly applicable common status codes such as S\_OK.</span></span> <br/>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="bdf77-128">RPC de l’installation \_</span><span class="sxs-lookup"><span data-stu-id="bdf77-128">FACILITY\_RPC</span></span><br/>      | <span data-ttu-id="bdf77-129">1</span><span class="sxs-lookup"><span data-stu-id="bdf77-129">1</span></span><br/> | <span data-ttu-id="bdf77-130">Pour les codes d’État retournés par les appels de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="bdf77-130">For status codes returned from remote procedure calls.</span></span> <br/>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="bdf77-131">stockage des installations \_</span><span class="sxs-lookup"><span data-stu-id="bdf77-131">FACILITY\_STORAGE</span></span><br/>  | <span data-ttu-id="bdf77-132">3</span><span class="sxs-lookup"><span data-stu-id="bdf77-132">3</span></span><br/> | <span data-ttu-id="bdf77-133">Pour les codes d’État renvoyés par les appels de méthode [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) ou [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) relatifs au stockage structuré.</span><span class="sxs-lookup"><span data-stu-id="bdf77-133">For status codes returned from [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) method calls relating to structured storage.</span></span> <span data-ttu-id="bdf77-134">Les codes d’État dont la valeur code (16 bits inférieurs) se trouvent dans la plage de codes d’erreur MS-DOS (autrement dit, inférieure à 256) ont la même signification que l’erreur MS-DOS correspondante.</span><span class="sxs-lookup"><span data-stu-id="bdf77-134">Status codes whose code (lower 16 bits) value is in the range of MS-DOS error codes (that is, less than 256) have the same meaning as the corresponding MS-DOS error.</span></span> <br/> |
| <span data-ttu-id="bdf77-135">INSTALLATION de \_ Win32</span><span class="sxs-lookup"><span data-stu-id="bdf77-135">FACILITY\_WIN32</span></span><br/>    | <span data-ttu-id="bdf77-136">7</span><span class="sxs-lookup"><span data-stu-id="bdf77-136">7</span></span><br/> | <span data-ttu-id="bdf77-137">Utilisé pour fournir un moyen de gérer les codes d’erreur des fonctions dans l’API Windows comme **HRESULT**.</span><span class="sxs-lookup"><span data-stu-id="bdf77-137">Used to provide a means of handling error codes from functions in the Windows API as an **HRESULT**.</span></span> <span data-ttu-id="bdf77-138">Les codes d’erreur dans OLE 16 bits qui dupliquaient les codes d’erreur système ont également été modifiés pour installer \_ Win32.</span><span class="sxs-lookup"><span data-stu-id="bdf77-138">Error codes in 16-bit OLE that duplicated system error codes have also been changed to FACILITY\_WIN32.</span></span> <br/>                                                                                                 |
| <span data-ttu-id="bdf77-139">fenêtres d’installation \_</span><span class="sxs-lookup"><span data-stu-id="bdf77-139">FACILITY\_WINDOWS</span></span><br/>  | <span data-ttu-id="bdf77-140">8</span><span class="sxs-lookup"><span data-stu-id="bdf77-140">8</span></span><br/> | <span data-ttu-id="bdf77-141">Utilisé pour les codes d’erreur supplémentaires des interfaces définies par Microsoft.</span><span class="sxs-lookup"><span data-stu-id="bdf77-141">Used for additional error codes from Microsoft-defined interfaces.</span></span><br/>                                                                                                                                                                                                                                            |



 

<span data-ttu-id="bdf77-142">Le champ de code est un numéro unique qui est assigné pour représenter l’erreur ou l’avertissement.</span><span class="sxs-lookup"><span data-stu-id="bdf77-142">The code field is a unique number that is assigned to represent the error or warning.</span></span>

<span data-ttu-id="bdf77-143">Par Convention, les valeurs **HRESULT** ont généralement des noms au format suivant : raison de la gravité de l' *installation* \_  \_ .</span><span class="sxs-lookup"><span data-stu-id="bdf77-143">By convention, **HRESULT** values generally have names in the following format: *Facility*\_*Severity*\_*Reason*.</span></span>

<span data-ttu-id="bdf77-144">La *fonction* est soit le nom de la fonction, soit un autre identificateur distinctif ; La *gravité* est une seule lettre, S ou E, qui indique si l’appel de fonction a réussi ou a généré une erreur (E). et *reason* est un identificateur qui décrit la signification du code.</span><span class="sxs-lookup"><span data-stu-id="bdf77-144">*Facility* is either the facility name or some other distinguishing identifier; *Severity* is a single letter, S or E, that indicates whether the function call succeeded (S) or produced an error (E); and *Reason* is an identifier that describes the meaning of the code.</span></span> <span data-ttu-id="bdf77-145">Par exemple, le code d’État STG \_ E \_ FILENOTFOUND indique qu’une erreur liée au stockage s’est produite ; plus précisément, un fichier demandé n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="bdf77-145">For example, the status code STG\_E\_FILENOTFOUND indicates a storage-related error has occurred; specifically, a requested file does not exist.</span></span> <span data-ttu-id="bdf77-146">Codes d’état de \_ la fonction null omettre le préfixe de l' *installation* \_ .</span><span class="sxs-lookup"><span data-stu-id="bdf77-146">Status codes from FACILITY\_NULL omit the *Facility*\_ prefix.</span></span>

<span data-ttu-id="bdf77-147">Les codes d’erreur sont définis dans le contexte d’une implémentation d’interface.</span><span class="sxs-lookup"><span data-stu-id="bdf77-147">Error codes are defined within the context of an interface implementation.</span></span> <span data-ttu-id="bdf77-148">Une fois définis, les codes de réussite ne peuvent pas être modifiés ou de nouveaux codes de réussite ont été ajoutés.</span><span class="sxs-lookup"><span data-stu-id="bdf77-148">Once defined, success codes cannot be changed or new success codes added.</span></span> <span data-ttu-id="bdf77-149">Toutefois, de nouveaux codes d’échec peuvent être écrits.</span><span class="sxs-lookup"><span data-stu-id="bdf77-149">However, new failure codes can be written.</span></span> <span data-ttu-id="bdf77-150">Microsoft se réserve le droit de définir de nouveaux codes d’échec (mais pas des codes de réussite) pour les interfaces décrites dans \_ ITF ou dans les nouvelles installations.</span><span class="sxs-lookup"><span data-stu-id="bdf77-150">Microsoft reserves the right to define new failure codes (but not success codes) for the interfaces described in FACILITY\_ITF or in new facilities.</span></span>

## <a name="related-topics"></a><span data-ttu-id="bdf77-151">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="bdf77-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bdf77-152">Gestion des erreurs dans COM</span><span class="sxs-lookup"><span data-stu-id="bdf77-152">Error Handling in COM</span></span>](error-handling-in-com.md)
</dt> <dt>

[<span data-ttu-id="bdf77-153">Protocoles Windows : HRESULT</span><span class="sxs-lookup"><span data-stu-id="bdf77-153">Windows Protocols: HRESULT</span></span>](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a)
</dt> </dl>

 

