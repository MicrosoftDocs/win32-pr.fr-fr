---
title: Représentation visuelle
description: Un contrôle prend en charge le positionnement et l’affichage lui-même dans son conteneur par le biais d’une technologie de document composite et d’une technologie glisser-déplacer OLE qui implique à la fois le contrôle et son conteneur.
ms.assetid: a7940560-360c-4c0d-9ac1-d051adb0b83e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9711dccbc7aa17f0b4a2ff228b2e2e4421e5083b
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103675813"
---
# <a name="visual-representation"></a><span data-ttu-id="fc260-103">Représentation visuelle</span><span class="sxs-lookup"><span data-stu-id="fc260-103">Visual Representation</span></span>

<span data-ttu-id="fc260-104">Un contrôle prend en charge le positionnement et l’affichage lui-même dans son conteneur par le biais d’une technologie de document composite et d’une technologie glisser-déplacer OLE qui implique à la fois le contrôle et son conteneur.</span><span class="sxs-lookup"><span data-stu-id="fc260-104">A control supports positioning and displaying itself within its container through compound document technology and OLE drag and drop technology that involves both the control and its container.</span></span> <span data-ttu-id="fc260-105">Le contrôle doit pouvoir se dessiner lui-même pendant que le conteneur gère la position du contrôle et sa taille.</span><span class="sxs-lookup"><span data-stu-id="fc260-105">The control must be able to draw itself while the container manages the position of the control and its size.</span></span>

<span data-ttu-id="fc260-106">Les contrôles s’ajoutent aux fonctions de base fournies par les documents OLE.</span><span class="sxs-lookup"><span data-stu-id="fc260-106">Controls add to the basic functions provided by OLE documents.</span></span> <span data-ttu-id="fc260-107">Un contrôle appelle la méthode [**IOleClientSite :: RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout) de son client pour indiquer à son conteneur qu’il souhaite modifier sa taille.</span><span class="sxs-lookup"><span data-stu-id="fc260-107">A control calls its client's [**IOleClientSite::RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout) method to tell its container that it wants to change its size.</span></span> <span data-ttu-id="fc260-108">Le client appelle [**IOleObject :: GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent) du contrôle pour récupérer la nouvelle taille et appelle [**IOleInPlaceObject :: SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects) pour définir le contrôle sur sa nouvelle taille.</span><span class="sxs-lookup"><span data-stu-id="fc260-108">The client calls the control's [**IOleObject::GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent) to get the new size and calls [**IOleInPlaceObject::SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects) to set the control to its new size.</span></span>

<span data-ttu-id="fc260-109">Les contrôles qui prennent en charge uniquement [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) ou [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) ne prennent pas en charge la mise en cache via [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) , car le cache requiert la prise en charge de [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage).</span><span class="sxs-lookup"><span data-stu-id="fc260-109">Controls that support only [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) or [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) do not support caching through [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) because the cache requires support for [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage).</span></span> <span data-ttu-id="fc260-110">Toutefois, ces contrôles doivent offrir au client un moyen de restituer le contrôle via [**IDataObject :: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) afin que le client puisse éventuellement créer et gérer son propre cache des données de présentation du contrôle.</span><span class="sxs-lookup"><span data-stu-id="fc260-110">However, these controls should provide a way for the client to render the control through [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) so the client can optionally create and manage its own cache of the presentation data for the control.</span></span>

<span data-ttu-id="fc260-111">Les contrôles utilisent le type HIMETRIC pour ses coordonnées.</span><span class="sxs-lookup"><span data-stu-id="fc260-111">Controls use the HIMETRIC type for its coordinates.</span></span> <span data-ttu-id="fc260-112">Toutefois, différents conteneurs peuvent utiliser des systèmes de coordonnées différents.</span><span class="sxs-lookup"><span data-stu-id="fc260-112">However, different containers can use different coordinate systems.</span></span> <span data-ttu-id="fc260-113">Le conteneur souhaite recevoir des coordonnées dans son propre système, mais le contrôle ne sait pas nécessairement quelles coordonnées son conteneur utilise.</span><span class="sxs-lookup"><span data-stu-id="fc260-113">The container wants to receive coordinates in its own system, but the control does not necessarily know what coordinates its container is using.</span></span> <span data-ttu-id="fc260-114">Pour communiquer avec succès, le contrôle a besoin d’un moyen de convertir des valeurs en coordonnées de conteneur.</span><span class="sxs-lookup"><span data-stu-id="fc260-114">To communicate successfully, the control needs a way to convert values to its container's coordinates.</span></span> <span data-ttu-id="fc260-115">Le conteneur fournit un objet site avec la méthode [**IOleControlSite :: TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) .</span><span class="sxs-lookup"><span data-stu-id="fc260-115">The container provides a site object with the [**IOleControlSite::TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) method.</span></span> <span data-ttu-id="fc260-116">Le contrôle appelle d’abord cette méthode sur le site client de son conteneur pour convertir ses coordonnées en coordonnées appropriées pour le conteneur.</span><span class="sxs-lookup"><span data-stu-id="fc260-116">The control calls this method on its container's client site first to convert its coordinates into the appropriate coordinates for the container.</span></span> <span data-ttu-id="fc260-117">Ensuite, il peut passer les coordonnées converties au conteneur.</span><span class="sxs-lookup"><span data-stu-id="fc260-117">Then, it can pass the converted coordinates to the container.</span></span>

<span data-ttu-id="fc260-118">Les contrôles peuvent appeler [**IOleControlSite :: LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) dans l’objet site du conteneur pour empêcher le conteneur de tenter de rétrograder le contrôle de l’état actif sur place.</span><span class="sxs-lookup"><span data-stu-id="fc260-118">Controls can call [**IOleControlSite::LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) in the container's site object to prevent the container from attempting to demote the control out of the in-place active state.</span></span> <span data-ttu-id="fc260-119">Si vous rétrogradez le contrôle de cette manière, le contrôle est désactivé et sa fenêtre détruite. par conséquent, si le contrôle doit conserver sa fenêtre pendant une durée connue, il peut appeler **LockInPlaceActive** pour garantir son état.</span><span class="sxs-lookup"><span data-stu-id="fc260-119">Demoting the control in this way causes the control to be deactivated and its window destroyed, so if the control must maintain its window for a known duration it can call **LockInPlaceActive** to guarantee its state.</span></span>

## <a name="related-topics"></a><span data-ttu-id="fc260-120">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="fc260-120">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fc260-121">Contrôles ActiveX</span><span class="sxs-lookup"><span data-stu-id="fc260-121">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 




