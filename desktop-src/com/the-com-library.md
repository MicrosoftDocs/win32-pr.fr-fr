---
title: Bibliothèque COM
description: Bibliothèque COM
ms.assetid: 51d4db4a-ad88-4627-8140-2f7906945752
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a285a89ca659907c37f92b7d00f3e3e04d0acf51
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2020
ms.locfileid: "103940743"
---
# <a name="the-com-library"></a><span data-ttu-id="e5f19-103">Bibliothèque COM</span><span class="sxs-lookup"><span data-stu-id="e5f19-103">The COM Library</span></span>

<span data-ttu-id="e5f19-104">Tout processus qui utilise COM doit à la fois initialiser et désinitialiser la bibliothèque COM.</span><span class="sxs-lookup"><span data-stu-id="e5f19-104">Any process that uses COM must both initialize and uninitialize the COM library.</span></span> <span data-ttu-id="e5f19-105">Outre le fait qu’il s’agit d’une spécification, COM implémente également certains services importants dans cette bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="e5f19-105">In addition to being a specification, COM also implements some important services in this library.</span></span> <span data-ttu-id="e5f19-106">Fourni sous la forme d’un ensemble de dll et de fichiers exe (principalement Ole32.dll et Rpcss.exe) dans Microsoft Windows, la bibliothèque COM comprend les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="e5f19-106">Provided as a set of DLLs and EXEs (primarily Ole32.dll and Rpcss.exe) in Microsoft Windows, the COM library includes the following:</span></span>

-   <span data-ttu-id="e5f19-107">Un petit nombre de fonctions fondamentales qui facilitent la création d’applications COM, client et serveur.</span><span class="sxs-lookup"><span data-stu-id="e5f19-107">A small number of fundamental functions that facilitate the creation of COM applications, both client and server.</span></span> <span data-ttu-id="e5f19-108">Pour les clients, COM fournit des fonctions de base pour la création d’objets.</span><span class="sxs-lookup"><span data-stu-id="e5f19-108">For clients, COM supplies basic functions for creating objects.</span></span> <span data-ttu-id="e5f19-109">Pour les serveurs, COM fournit les moyens d’exposer leurs objets.</span><span class="sxs-lookup"><span data-stu-id="e5f19-109">For servers, COM supplies the means of exposing their objects.</span></span>

-   <span data-ttu-id="e5f19-110">Services de localisation de l’implémentation par le biais desquels COM détermine, à partir d’un identificateur de classe unique (CLSID), le serveur qui implémente cette classe et où se trouve ce serveur.</span><span class="sxs-lookup"><span data-stu-id="e5f19-110">Implementation-locator services through which COM determines, from a unique class identifier (CLSID), which server implements that class and where that server is located.</span></span> <span data-ttu-id="e5f19-111">Ce service prend en charge un niveau d’indirection, généralement un registre système, entre l’identité d’une classe d’objet et l’empaquetage de l’implémentation afin que les clients soient indépendants de l’empaquetage, qui peut changer à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="e5f19-111">This service includes support for a level of indirection, usually a system registry, between the identity of an object class and the packaging of the implementation so that clients are independent of the packaging, which can change in the future.</span></span>

-   <span data-ttu-id="e5f19-112">Appels de procédure distante transparents lorsqu’un objet s’exécute sur un serveur local ou distant.</span><span class="sxs-lookup"><span data-stu-id="e5f19-112">Transparent remote procedure calls when an object is running in a local or remote server.</span></span>

-   <span data-ttu-id="e5f19-113">Mécanisme standard pour permettre à une application de contrôler la façon dont la mémoire est allouée dans son processus, en particulier la mémoire qui doit être transmise entre les objets coopérants afin qu’elle puisse être libérée correctement.</span><span class="sxs-lookup"><span data-stu-id="e5f19-113">A standard mechanism to allow an application to control how memory is allocated within its process, particularly memory that needs to be passed between cooperating objects so that it can be freed properly.</span></span>

<span data-ttu-id="e5f19-114">Pour utiliser les services COM de base, tous les threads COM d’exécution dans les clients et les serveurs hors processus doivent appeler la fonction [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) ou [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) avant d’appeler toute autre fonction com à l’exception des appels d’allocation de mémoire.</span><span class="sxs-lookup"><span data-stu-id="e5f19-114">To use basic COM services, all COM threads of execution in clients and out-of-process servers must call either the [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or the [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) function before calling any other COM function except memory allocation calls.</span></span> <span data-ttu-id="e5f19-115">**CoInitializeEx** remplace l’autre fonction, en ajoutant un paramètre qui vous permet de spécifier le modèle de thread du thread : thread cloisonné ou thread libre.</span><span class="sxs-lookup"><span data-stu-id="e5f19-115">**CoInitializeEx** replaces the other function, adding a parameter that allows you to specify the threading model of the thread: either apartment-threaded or free-threaded.</span></span> <span data-ttu-id="e5f19-116">Un appel à **CoInitialize** définit simplement le modèle de thread sur thread cloisonné.</span><span class="sxs-lookup"><span data-stu-id="e5f19-116">A call to **CoInitialize** simply sets the threading model to apartment-threaded.</span></span>

<span data-ttu-id="e5f19-117">Les applications de document composé OLE appellent la fonction [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize) , qui appelle [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) et effectue également une initialisation requise pour les documents composés.</span><span class="sxs-lookup"><span data-stu-id="e5f19-117">OLE compound document applications call the [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize) function, which calls [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) and also does some initialization required for compound documents.</span></span> <span data-ttu-id="e5f19-118">Par conséquent, les threads qui appellent **OleInitialize** ne peuvent pas être libres de thread.</span><span class="sxs-lookup"><span data-stu-id="e5f19-118">Therefore, threads that call **OleInitialize** cannot be free-threaded.</span></span> <span data-ttu-id="e5f19-119">Pour plus d’informations sur les threads dans les clients et les serveurs, consultez [processus, threads et Apartments](processes--threads--and-apartments.md).</span><span class="sxs-lookup"><span data-stu-id="e5f19-119">For information on threading in clients and servers, see [Processes, Threads, and Apartments](processes--threads--and-apartments.md).</span></span>

<span data-ttu-id="e5f19-120">Les serveurs in-process n’appellent pas les fonctions d’initialisation, car ils sont chargés dans un processus qui l’a déjà fait.</span><span class="sxs-lookup"><span data-stu-id="e5f19-120">In-process servers do not call the initialization functions because they are being loaded into a process that has already done so.</span></span> <span data-ttu-id="e5f19-121">Par conséquent, les serveurs in-process doivent définir leur modèle de thread dans le Registre sous la clé [InprocServer32](inprocserver32.md) .</span><span class="sxs-lookup"><span data-stu-id="e5f19-121">As a result, in-process servers must set their threading model in the registry under the [InprocServer32](inprocserver32.md) key.</span></span> <span data-ttu-id="e5f19-122">Pour plus d’informations sur les problèmes de Threading dans les serveurs in-process, consultez [problèmes de Threading du serveur in-process](in-process-server-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="e5f19-122">For detailed information on threading issues in in-process servers, see [In-Process Server Threading Issues](in-process-server-threading-issues.md).</span></span>

<span data-ttu-id="e5f19-123">Il est également important de ne pas initialiser la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="e5f19-123">It is also important to uninitialize the library.</span></span> <span data-ttu-id="e5f19-124">Pour chaque appel à [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) ou [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex), il doit y avoir un appel correspondant à [**CoUninitialize**](/windows/desktop/api/combaseapi/nf-combaseapi-couninitialize).</span><span class="sxs-lookup"><span data-stu-id="e5f19-124">For each call to [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex), there must be a corresponding call to [**CoUninitialize**](/windows/desktop/api/combaseapi/nf-combaseapi-couninitialize).</span></span> <span data-ttu-id="e5f19-125">Pour chaque appel à [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize), il doit y avoir un appel correspondant à [**OleUninitialize**](/windows/desktop/api/Ole2/nf-ole2-oleuninitialize).</span><span class="sxs-lookup"><span data-stu-id="e5f19-125">For each call to [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize), there must be a corresponding call to [**OleUninitialize**](/windows/desktop/api/Ole2/nf-ole2-oleuninitialize).</span></span>

<span data-ttu-id="e5f19-126">Les serveurs in-process peuvent supposer que le processus dans lequel ils sont chargés a déjà effectué ces étapes.</span><span class="sxs-lookup"><span data-stu-id="e5f19-126">In-process servers can assume that the process they are being loaded into has already performed these steps.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e5f19-127">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e5f19-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e5f19-128">COM (Component Object Model)</span><span class="sxs-lookup"><span data-stu-id="e5f19-128">The Component Object Model</span></span>](the-component-object-model.md)
</dt> </dl>

 

 




