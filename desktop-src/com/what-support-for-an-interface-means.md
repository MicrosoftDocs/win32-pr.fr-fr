---
title: Prise en charge d’une interface
description: Prise en charge d’une interface
ms.assetid: fa5eae0f-2252-43bc-b504-de00b213cb2a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 13587bd5ff6391691c0f6bf6e38b59be019dfdb6
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/27/2021
ms.locfileid: "110549054"
---
# <a name="what-support-for-an-interface-means"></a>Prise en charge d’une interface

Outre l’interface [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , un contrôle ActiveX ou un objet com pour ce cas exprime toutes les fonctionnalités facultatives qu’il prend en charge via des interfaces supplémentaires. Cela signifie qu’aucune autre interface n’est requise au-dessus de **IUnknown**. À cette fin, le tableau suivant répertorie les interfaces qu’un contrôle ActiveX peut prendre en charge, et ce que cela signifie pour prendre en charge cette interface.



| Interface                                                                                                                                                                                                                                                                                                                                                                       | Commentaires/ce que signifie la prise en charge de l’interface                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                                                                                                                                                                                                                                                                                     | Si le contrôle requiert la communication avec son site client pour tout autre chose que des événements (consultez [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)), [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) est une nécessité. Lors de l’implémentation de cette interface, le contrôle doit également prendre en charge la sémantique des méthodes suivantes : [**SetHostNames**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-sethostnames), [**Close**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-close), [**EnumVerbs**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumverbs), [**Update**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-update), [**IsUpToDate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-isuptodate), [**GetUserClassID**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getuserclassid), [**GetUserType**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getusertype), [**GetMiscStatus**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmiscstatus)et les méthodes [**Advise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-advise), [**Unadvise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-unadvise)et [**EnumAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumadvise) qui fonctionnent conjointement avec l’implémentation [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) d’un conteneur. Un contrôle qui implémente **IOleObject** doit pouvoir gérer **IAdviseSink** si le conteneur en fournit un ; un conteneur ne peut pas, dans ce cas, un contrôle s’assure, bien sûr, qu’il n’essaie pas d’appeler un récepteur qui n’existe pas.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                                                                                                                                                                                                                                                                                       | Exprime la capacité du contrôle à être activée sur place et éventuellement activée par l’interface utilisateur. Cette interface signifie que le contrôle a une interface utilisateur d’un type qui peut être activé, et que [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject) est également pris en charge. Les méthodes requises sont [**GetWindow**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-getwindow), [**InPlaceDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-inplacedeactivate), [**UIDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-uideactivate), [**SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects)et [**ReactivateAndUndo**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-reactivateandundo). La prise en charge de cette interface requiert la prise en charge de [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)<br/>                                                                                                                                                                                                                                                                                                           | Un objet compatible sur place qui prend en charge [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject) doit également fournir cette interface, bien que le contrôle lui-même n’implémente pas nécessairement l’interface directement.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                                                                                                                                                                                                                                                                                   | Exprime la capacité du contrôle et souhaite traiter les événements mnémoniques (a) (méthodes [**GetControlInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo), [**OnMnemonic**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic) ), (b) les propriétés ambiantes ([**OnAmbientPropertyChange**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onambientpropertychange)) et/ou (c) que le contrôle requiert que le conteneur gère ([**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)). Notez que les mnémoniques sont différents des accélérateurs qui sont gérés via [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject): les mnémoniques ont une interface utilisateur associée et sont actifs même lorsque le contrôle n’est pas activé par l’interface utilisateur. La prise en charge d’un contrôle pour les mnémoniques signifie que le contrôle sait également comment utiliser la méthode [**IOleControlSite :: OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) du conteneur. Étant donné que le contrôle doit connaître le site du conteneur, la prise en charge des mnémoniques signifie également la prise en charge de [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject). En outre, la connaissance des mnémoniques requiert un support sur place et donc [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject).<br/> Si un contrôle utilise des propriétés ambiantes de conteneur, il doit également implémenter cette interface pour recevoir des notifications de modification, comme suit la sémantique des modifications est requise. Étant donné que les propriétés ambiantes sont uniquement disponibles par le biais du **IDispatch** du site conteneur, la prise en charge de la propriété ambiante signifie que le contrôle prend en charge [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) (pour obtenir le site) et peut générer des appels **IDispatch :: Invoke** .<br/> La méthode [**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) est nécessaire pour les contrôles qui doivent savoir quand un conteneur ne va pas gérer un événement. c’est le seul moyen pour le contrôle de connaître cette condition. Si **FreezeEvents** est uniquement nécessaire en isolation, de sorte que les autres méthodes [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol) ne sont pas implémentées, **IOleControl** peut être autonome sans [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) ou [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject).<br/> |
| [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                                                                                                                                                                                                                                   | Indique que le contrôle peut fournir au moins (a) des rendus graphiques du contrôle (CF \_ MetaFilePict est le minimum si le contrôle a des éléments visuels) et/ou (b) jeux de propriétés, si le contrôle possède des propriétés à fournir. Les méthodes [**GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata), [**QueryGetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-querygetdata), [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), [**DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)et [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) sont requises. La prise en charge des formats graphiques autres que CF \_ MetaFilePict est facultative.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                                                                                                                                                                                                                                                                                 | Indique que le contrôle a des visuels intéressants lorsqu’il n’est pas actif sur place. Si elle est implémentée, un contrôle doit prendre en charge les méthodes [**Draw**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-draw), [**GetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-getadvise), [**SetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-setadvise)et [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **IDispatch**<br/>                                                                                                                                                                                                                                                                                                                                                        | Indique que le contrôle a des méthodes personnalisées (a), ou (b) des propriétés personnalisées qui sont toutes les deux disponibles via une liaison tardive via **IDispatch :: Invoke**. Cela requiert également que le contrôle fournisse des informations de type par le biais d’autres méthodes **IDispatch** . Un contrôle peut prendre en charge plusieurs implémentations **IDispatch** où un seul est associé à IID \_ IDispatch. les autres doivent avoir leurs propres identificateurs dispinterface uniques.<br/> Un contrôle est encouragé à fournir des interfaces doubles pour l’accès aux propriétés et aux méthodes personnalisées, mais cela est facultatif si les méthodes et les propriétés existent.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [**Interfaces**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                                                                                                                                                                                                                                                                                       | Indique qu’un contrôle prend en charge au moins une interface sortante, telle que des événements ou des notifications de modification de propriété. Toutes les méthodes de cette interface doivent être implémentées si cette interface est disponible, y compris [**EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints) qui requiert un objet distinct avec [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints).<br/> La prise en charge de [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) signifie que l’objet prend également en charge un ou plusieurs objets connexes avec [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) qui sont disponibles par le biais des méthodes **IConnectionPointContainer** . Chaque objet de point de connexion lui-même doit implémenter l’interface **IConnectionPoint** complète, y compris [**EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections), qui requiert un autre objet énumérateur avec l’interface [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/>                                                                                                                                                                                                                                                           | Indique que l’objet peut fournir ses propres informations de type coclasse directement via [**IProvideClassInfo :: GetClassinfo**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo-getclassinfo). Si le contrôle prend en charge la variation [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)ultérieure, il indique également sa capacité à fournir son IID source principal via [**IProvideClassInfo2 :: GetGuid**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo2-getguid). Toutes les méthodes de cette interface doivent être implémentées.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**ISpecifyPropertyPages**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                                                                                                                                                                                                                                                                               | Indique que le contrôle a des pages de propriétés qu’il peut afficher afin qu’un conteneur puisse coordonner les pages de propriétés de ce contrôle avec les pages d’autres contrôles lorsque les pages de propriétés doivent être affichées pour une sélection de plusieurs contrôles. Toutes les méthodes de cette interface doivent être implémentées lorsque la prise en charge existe.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IPerPropertyBrowsing**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                                                                                                                                                                                                                                                                                 | Indique que la capacité du contrôle à (a) fournir une chaîne d’affichage pour une propriété, (b) fournir des chaînes et des valeurs prédéfinies pour ses propriétés et/ou (c) mapper un dispID de propriété à une page de propriétés spécifique. La prise en charge de cette interface signifie que la prise en charge des propriétés via IDispatch, comme indiqué ci-dessus, est fournie. Si (c) est pris en charge, cela signifie également que les pages de propriétés de l’objet mappées par le biais de [**IPerPropertyBrowsing :: MapPropertyToPage**](/windows/desktop/api/OCIdl/nf-ocidl-iperpropertybrowsing-mappropertytopage) implémentent elles-mêmes [**IPropertyPage2**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage2) , contrairement à l’interface de base [**IPropertyPage**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage) .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream)<br/> [**IPersist**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit)<br/> [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))<br/> [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)<br/> [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))<br/> [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag)<br/> | Consultez [interfaces de persistance](persistence-interfaces.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                                                                                                                                                                                                                                                                           | Indique la prise en charge de la mise en cache des conteneurs des visuels de contrôle. Un contrôle obtient généralement la prise en charge de la mise en cache par le biais de la fonction OLE [**CreateDataCache**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache). Seuls les contrôles avec un contenu statique significatif doivent choisir de le faire (même si ce n’est pas obligatoire). Si un contrôle prend en charge la mise en cache, il doit simplement agréger le cache de données et exposer à la fois les interfaces [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) et [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) à partir du cache de données. Un contrôle qui implémente [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) doit pouvoir gérer [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) si le conteneur en fournit un ; un conteneur ne peut pas, dans ce cas, un contrôle s’assure, bien sûr, qu’il n’essaie pas d’appeler un récepteur qui n’existe pas.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**IExternalConnection**](/windows/win32/api/objidlbase/nn-objidlbase-iexternalconnection)<br/>                                                                                                                                                                                                                                                                                                                   | Indique que le contrôle prend en charge les liens externes vers lui-même ; autrement dit, le contrôle n’est pas marqué avec OLEMISC \_ CANTLINKINSIDE et prend en charge [**IOleObject :: SetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setmoniker) et [**IOleObject :: GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmoniker). Un conteneur n’interrogera jamais cette interface et ne l’appellera pas directement à mesure que des appels sont générés à partir de la couche d’accès distant OLE.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**IRunnableObject**](/windows/desktop/api/ObjIdl/nn-objidl-irunnableobject)<br/>                                                                                                                                                                                                                                                                                                                           | Indique que le contrôle ne fait pas l’objet d’un chargement, comme le font certains objets in-process.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="related-topics"></a>Rubriques connexes

<dl> <dt>

[Contrôles](controls.md)
</dt> </dl>

 

