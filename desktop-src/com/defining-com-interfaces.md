---
title: Définition d’interfaces COM
description: Microsoft définit de nombreuses interfaces COM. Dans la plupart des cas, vous pouvez réutiliser ces interfaces génériques. Toutefois, certaines applications ont des exigences spécifiques qui rendent souhaitable ou nécessaire la définition de vos propres interfaces d’objet.
ms.assetid: 8a94bd7d-d101-411c-97de-9e9a46bf9591
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 516c02a2c337b2c76229094b0e42d75b44f65d16
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104102401"
---
# <a name="defining-com-interfaces"></a><span data-ttu-id="df422-105">Définition d’interfaces COM</span><span class="sxs-lookup"><span data-stu-id="df422-105">Defining COM Interfaces</span></span>

<span data-ttu-id="df422-106">Microsoft définit de nombreuses interfaces COM.</span><span class="sxs-lookup"><span data-stu-id="df422-106">Microsoft defines many COM interfaces.</span></span> <span data-ttu-id="df422-107">Dans la plupart des cas, vous pouvez réutiliser ces interfaces génériques.</span><span class="sxs-lookup"><span data-stu-id="df422-107">In most cases, you can reuse these generic interfaces.</span></span> <span data-ttu-id="df422-108">Toutefois, certaines applications ont des exigences spécifiques qui rendent souhaitable ou nécessaire la définition de vos propres interfaces d’objet.</span><span class="sxs-lookup"><span data-stu-id="df422-108">However, some applications have specific requirements that make it desirable or necessary to define your own object interfaces.</span></span>

<span data-ttu-id="df422-109">Toutes les interfaces COM doivent dériver, directement ou indirectement, de l’interface [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="df422-109">All COM interfaces must derive, directly or indirectly, from the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="df422-110">Dans cette contrainte, votre interface personnalisée peut prendre en charge presque n’importe quelle méthode ou paramètre, y compris les méthodes asynchrones.</span><span class="sxs-lookup"><span data-stu-id="df422-110">Within that constraint, your custom interface can support almost any method or parameter, including asynchronous methods.</span></span> <span data-ttu-id="df422-111">Vous pouvez également générer une bibliothèque de types pour vos interfaces personnalisées afin que les clients puissent accéder aux informations sur les méthodes de votre objet au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="df422-111">You can also generate a type library for your custom interfaces so that clients can access information about your object's methods at run time.</span></span> <span data-ttu-id="df422-112">Après avoir défini une interface, la décrire dans Microsoft Interface Definition Language (MIDL), la compiler et l’inscrire, vous pouvez l’utiliser comme n’importe quelle interface générique.</span><span class="sxs-lookup"><span data-stu-id="df422-112">After you define an interface, describe it in Microsoft Interface Definition Language (MIDL), compile and register it, you use it just like any generic interface.</span></span> <span data-ttu-id="df422-113">Avec COM distribué, les méthodes d’interface sont disponibles à la fois pour les processus distants et pour d’autres processus sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="df422-113">With distributed COM, interface methods are available both to remote processes and to other processes on the same computer.</span></span>

<span data-ttu-id="df422-114">Enfin, la génération d’interfaces COM requiert un environnement de développement qui comprend un compilateur C/C++ et le compilateur Midl.exe.</span><span class="sxs-lookup"><span data-stu-id="df422-114">Finally, building COM interfaces requires a development environment that includes a C/C++ compiler and the Midl.exe compiler.</span></span>

<span data-ttu-id="df422-115">Les étapes de création d’une interface COM sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="df422-115">The steps in creating a COM interface are as follows:</span></span>

-   <span data-ttu-id="df422-116">Décidez de la façon dont vous souhaitez assurer la prise en charge du marshaling pour votre interface ; que ce soit avec un marshaling piloté par la bibliothèque de types ou avec une DLL proxy/stub.</span><span class="sxs-lookup"><span data-stu-id="df422-116">Decide how you want to provide marshaling support for your interface; either with type-library driven marshaling or with a proxy/stub DLL.</span></span> <span data-ttu-id="df422-117">Même les interfaces in-process doivent être marshalées si elles doivent être utilisées dans les limites de cloisonnement.</span><span class="sxs-lookup"><span data-stu-id="df422-117">Even in-process interfaces must be marshaled if they are to be used across apartment boundaries.</span></span> <span data-ttu-id="df422-118">Il est judicieux de créer une prise en charge du marshaling dans chaque interface COM, même si vous ne pensez pas que vous en aurez besoin.</span><span class="sxs-lookup"><span data-stu-id="df422-118">It is a good idea to build marshaling support into every COM interface, even if you don't think you will need it.</span></span> <span data-ttu-id="df422-119">Pour plus d’informations, consultez [marshaling d’interface](interface-marshaling.md) .</span><span class="sxs-lookup"><span data-stu-id="df422-119">See [Interface Marshaling](interface-marshaling.md) for more information.</span></span>
-   <span data-ttu-id="df422-120">Décrivez l’interface ou les interfaces dans un fichier de définition d’interface (IDL).</span><span class="sxs-lookup"><span data-stu-id="df422-120">Describe the interface or interfaces in an interface definition (IDL) file.</span></span> <span data-ttu-id="df422-121">En outre, vous pouvez spécifier certains aspects locaux de votre interface dans un fichier de configuration d’application (ACF).</span><span class="sxs-lookup"><span data-stu-id="df422-121">In addition, you can specify certain local aspects of your interface in an application configuration file (ACF).</span></span> <span data-ttu-id="df422-122">Si vous utilisez le marshaling piloté par bibliothèque de types, ajoutez une instruction de [**bibliothèque**](/windows/desktop/Midl/library) qui référence les interfaces pour lesquelles vous souhaitez générer des informations de type.</span><span class="sxs-lookup"><span data-stu-id="df422-122">If you are using type-library driven marshaling, add a [**library**](/windows/desktop/Midl/library) statement that references the interfaces for which you want to generate type information.</span></span>
-   <span data-ttu-id="df422-123">Utilisez le compilateur MIDL pour générer un fichier de bibliothèque de types et un fichier d’en-tête, ou des fichiers proxy/stub en langage C, un fichier d’identificateur d’interface, un fichier de données DLL et un fichier d’en-tête.</span><span class="sxs-lookup"><span data-stu-id="df422-123">Use the MIDL compiler to generate a type library file and header file, or C-language proxy/stub files, interface identifier file, DLL data file and header file.</span></span> <span data-ttu-id="df422-124">Pour plus d’informations, consultez [compilation MIDL](midl-compilation.md) .</span><span class="sxs-lookup"><span data-stu-id="df422-124">See [MIDL Compilation](midl-compilation.md) for more information.</span></span>
-   <span data-ttu-id="df422-125">Selon la méthode de marshaling choisie, écrivez un fichier de définition de module (DEF), compilez et liez tous les fichiers générés par MIDL dans une DLL de proxy unique, puis inscrivez l’interface dans le registre système ou enregistrez la bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="df422-125">Depending on the marshaling method you chose, write a module definition (DEF) file, compile and link all the MIDL-generated files into a single proxy DLL, and register the interface in the system registry, or register the type library.</span></span> <span data-ttu-id="df422-126">Pour plus d’informations, consultez [chargement et inscription d’une bibliothèque de types](loading-and-registering-a-type-library.md) et [génération et inscription d’une dll proxy](building-and-registering-a-proxy-dll.md) .</span><span class="sxs-lookup"><span data-stu-id="df422-126">See [Loading and Registering a Type Library](loading-and-registering-a-type-library.md) and [Building and Registering a Proxy DLL](building-and-registering-a-proxy-dll.md) for more information.</span></span>

## <a name="related-topics"></a><span data-ttu-id="df422-127">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="df422-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="df422-128">Anatomie d’un fichier IDL</span><span class="sxs-lookup"><span data-stu-id="df422-128">Anatomy of an IDL File</span></span>](anatomy-of-an-idl-file.md)
</dt> <dt>

[<span data-ttu-id="df422-129">Clients et serveurs COM</span><span class="sxs-lookup"><span data-stu-id="df422-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="df422-130">Règles de conception d’interface</span><span class="sxs-lookup"><span data-stu-id="df422-130">Interface Design Rules</span></span>](interface-design-rules.md)
</dt> <dt>

[<span data-ttu-id="df422-131">COM (Component Object Model)</span><span class="sxs-lookup"><span data-stu-id="df422-131">The Component Object Model</span></span>](the-component-object-model.md)
</dt> </dl>

 

 