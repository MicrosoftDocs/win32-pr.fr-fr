---
title: Le gestionnaire OLE
description: Un gestionnaire OLE est une DLL contenant plusieurs composants interactifs utilisés pour la liaison et l’incorporation.
ms.assetid: 5a01b4be-38cf-4019-ba20-ee67b836a3e0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb9579f18b44a36a794ff807d9d616dd3a06dd1b
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104029281"
---
# <a name="the-ole-handler"></a><span data-ttu-id="1d396-103">Le gestionnaire OLE</span><span class="sxs-lookup"><span data-stu-id="1d396-103">The OLE Handler</span></span>

<span data-ttu-id="1d396-104">Un *Gestionnaire OLE* est une DLL contenant plusieurs composants interactifs utilisés pour la liaison et l’incorporation.</span><span class="sxs-lookup"><span data-stu-id="1d396-104">An *OLE handler* is a DLL containing several interacting components used for linking and embedding.</span></span> <span data-ttu-id="1d396-105">Pour éviter les frais de communication interprocessus constante entre un conteneur et son serveur, le gestionnaire est chargé dans l’espace de processus du conteneur pour agir au nom d’un serveur en tant que type de processus de substitution.</span><span class="sxs-lookup"><span data-stu-id="1d396-105">To avoid the expense of constant interprocess communication between a container and its server, the handler is loaded into the container's process space to act on behalf of a server as a sort of surrogate process.</span></span> <span data-ttu-id="1d396-106">Le gestionnaire OLE gère les demandes de conteneur qui ne requièrent pas l’attention de l’application serveur, telles que les demandes de dessin.</span><span class="sxs-lookup"><span data-stu-id="1d396-106">The OLE handler manages container requests that do not require the attention of the server application, such as requests for drawing.</span></span> <span data-ttu-id="1d396-107">Lorsqu’un conteneur demande un objet que le gestionnaire d’objets ne peut pas fournir, le gestionnaire communique avec l’application serveur à l’aide du mécanisme de communication hors processus COM.</span><span class="sxs-lookup"><span data-stu-id="1d396-107">When a container requests something that the object handler cannot provide, the handler communicates with the server application using the COM out-of-process communication mechanism.</span></span>

<span data-ttu-id="1d396-108">Les composants du gestionnaire OLE incluent des éléments de communication à distance pour gérer la communication entre le gestionnaire et son serveur, un cache pour stocker les données d’un objet (ainsi que des informations sur la façon dont ces données doivent être mises en forme et affichées) et un objet de contrôle qui coordonne les activités des autres composants de la DLL.</span><span class="sxs-lookup"><span data-stu-id="1d396-108">The OLE handler components include remoting pieces to manage communication between the handler and its server, a cache for storing an object's data (along with information on how that data should be formatted and displayed), and a controlling object that coordinates the activities of the DLL's other components.</span></span> <span data-ttu-id="1d396-109">En outre, si un objet est un lien, la DLL comprend également un composant de liaison, ou un *objet lié*, qui assure le suivi du nom et de l’emplacement de la source de la liaison.</span><span class="sxs-lookup"><span data-stu-id="1d396-109">In addition, if an object is a link, the DLL also includes a linking component, or *linked object*, which keeps track of the name and location of the link source.</span></span>

<span data-ttu-id="1d396-110">OLE fournit un gestionnaire par défaut que la plupart des applications utilisent pour la liaison et l’incorporation.</span><span class="sxs-lookup"><span data-stu-id="1d396-110">OLE provides a default handler that most applications use for linking and embedding.</span></span> <span data-ttu-id="1d396-111">Si la valeur par défaut ne correspond pas à la configuration requise de votre serveur, vous pouvez soit remplacer complètement le gestionnaire par défaut, soit utiliser des parties de la fonctionnalité qu’il fournit, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="1d396-111">If the default does not match the requirements of your server, you can either completely replace the default handler or use parts of the functionality it provides where appropriate.</span></span> <span data-ttu-id="1d396-112">Dans ce dernier cas, le gestionnaire d’application est implémenté comme un objet d’agrégation composé d’un nouvel objet de contrôle et du gestionnaire par défaut.</span><span class="sxs-lookup"><span data-stu-id="1d396-112">In the latter case, the application handler is implemented as an aggregate object composed of a new control object and the default handler.</span></span> <span data-ttu-id="1d396-113">Les gestionnaires d’applications/par défaut combinés sont également appelés *gestionnaires in-process*.</span><span class="sxs-lookup"><span data-stu-id="1d396-113">Combination application/default handlers are also known as *in-process handlers*.</span></span> <span data-ttu-id="1d396-114">Le *Gestionnaire de communication à distance* est utilisé pour les objets qui ne sont pas affectés à un CLSID dans le registre système ou qui n’ont pas de gestionnaire spécifié.</span><span class="sxs-lookup"><span data-stu-id="1d396-114">The *remoting handler* is used for objects that are not assigned a CLSID in the system registry or that have no specified handler.</span></span> <span data-ttu-id="1d396-115">Tout ce qui est nécessaire à partir d’un gestionnaire pour ces types d’objets est qu’ils passent des informations à travers la limite de processus.</span><span class="sxs-lookup"><span data-stu-id="1d396-115">All that is required from a handler for these types of objects is that they pass information across the process boundary.</span></span> <span data-ttu-id="1d396-116">Pour créer une nouvelle instance du gestionnaire par défaut, appelez [**OleCreateDefaultHandler**](/windows/desktop/api/Ole2/nf-ole2-olecreatedefaulthandler).</span><span class="sxs-lookup"><span data-stu-id="1d396-116">To create a new instance of the default handler, call [**OleCreateDefaultHandler**](/windows/desktop/api/Ole2/nf-ole2-olecreatedefaulthandler).</span></span> <span data-ttu-id="1d396-117">Pour certaines circonstances spéciales, appelez [**OleCreateEmbeddingHelper**](/windows/desktop/api/Ole2/nf-ole2-olecreateembeddinghelper).</span><span class="sxs-lookup"><span data-stu-id="1d396-117">For some special circumstances, call [**OleCreateEmbeddingHelper**](/windows/desktop/api/Ole2/nf-ole2-olecreateembeddinghelper).</span></span>

<span data-ttu-id="1d396-118">Lorsque vous créez une instance d’un gestionnaire pour une classe, vous ne pouvez pas l’utiliser pour une autre.</span><span class="sxs-lookup"><span data-stu-id="1d396-118">When you create an instance of a handler for one class, you cannot use it for another.</span></span> <span data-ttu-id="1d396-119">Lorsqu’il est utilisé pour un document composé, le gestionnaire OLE implémente les structures de données côté conteneur lorsque vous accédez aux objets d’une classe particulière à distance.</span><span class="sxs-lookup"><span data-stu-id="1d396-119">When used for a compound document, the OLE handler implements the container-side data structures when objects of a particular class are accessed remotely.</span></span>

<span data-ttu-id="1d396-120">OLE a défini le gestionnaire par défaut pour les clients de serveurs locaux de documents composés.</span><span class="sxs-lookup"><span data-stu-id="1d396-120">OLE defined the default handler for clients of compound document local servers.</span></span> <span data-ttu-id="1d396-121">Le gestionnaire par défaut implémentait un nombre d’interfaces que le serveur classique n’avait pas.</span><span class="sxs-lookup"><span data-stu-id="1d396-121">The default handler implemented a number of interfaces that the typical server did not.</span></span> <span data-ttu-id="1d396-122">Quand OLE permettait par la suite des serveurs in-process pour des documents composés, ils devaient créer une application auxiliaire d’incorporation qui implémentait ces interfaces supplémentaires afin que les clients puissent travailler en toute transparence avec eux.</span><span class="sxs-lookup"><span data-stu-id="1d396-122">When OLE subsequently allowed in-process servers for compound documents, they had to create an embedding helper that implemented these extra interfaces so that clients could seamlessly work with them.</span></span>

<span data-ttu-id="1d396-123">Les concepteurs de Framework qui définissent et implémentent un gestionnaire côté client doivent tenir compte de ce problème dans leur conception et fournir un programme d’assistance in-process équivalent pour les mêmes raisons.</span><span class="sxs-lookup"><span data-stu-id="1d396-123">Framework designers that define and implement a client-side handler should consider this issue in their design and should provide an equivalent in-process helper for the same reasons.</span></span> <span data-ttu-id="1d396-124">Même si les concepteurs n’implémentent actuellement pas les interfaces sur le gestionnaire que les serveurs n’exposent pas, ils peuvent souhaiter définir une application d’assistance pour qu’ils puissent les ajouter à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="1d396-124">Even if the designers currently don't implement interfaces on the handler that the servers don't expose, they may want to define a helper now so that they can add them in the future.</span></span> <span data-ttu-id="1d396-125">Sinon, il est possible d’implémenter les interfaces supplémentaires sur l’objet serveur lui-même.</span><span class="sxs-lookup"><span data-stu-id="1d396-125">Alternatively, one could implement the extra interfaces on the server object itself.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1d396-126">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1d396-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1d396-127">Gestionnaire de Client-Side léger</span><span class="sxs-lookup"><span data-stu-id="1d396-127">The Lightweight Client-Side Handler</span></span>](the-lightweight-client-side-handler.md)
</dt> </dl>

 

 




