---
title: La structure FORMATETC
description: La structure FORMATETC est un format de presse-papiers généralisé, amélioré pour englober un appareil cible, un aspect ou une vue des données et un support de stockage.
ms.assetid: 46d8988a-4b97-4c86-8b1b-db87044a7e01
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6ece0079cf2c0f07b7356f07ee2c53b1279b7ce7
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730541"
---
# <a name="the-formatetc-structure"></a><span data-ttu-id="4dd08-103">La structure FORMATETC</span><span class="sxs-lookup"><span data-stu-id="4dd08-103">The FORMATETC Structure</span></span>

<span data-ttu-id="4dd08-104">La structure FORMATETC est un format de presse-papiers généralisé, amélioré pour englober un appareil cible, un *aspect* ou une vue des données et un support de stockage.</span><span class="sxs-lookup"><span data-stu-id="4dd08-104">The FORMATETC structure is a generalized clipboard format, enhanced to encompass a target device, an *aspect* or view of the data, and a storage medium.</span></span> <span data-ttu-id="4dd08-105">Un consommateur de données, tel qu’une application de conteneur OLE, passe la structure [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) en tant qu’argument dans les appels à [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pour indiquer le type de données qu’il souhaite à partir d’une source de données, tel qu’un objet de document composé.</span><span class="sxs-lookup"><span data-stu-id="4dd08-105">A data consumer, such as an OLE container application, passes the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as an argument in calls to [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) to indicate the type of data it wants from a data source, such as a compound document object.</span></span> <span data-ttu-id="4dd08-106">La source utilise la structure **FORMATETC** pour décrire les formats qu’elle peut fournir.</span><span class="sxs-lookup"><span data-stu-id="4dd08-106">The source uses the **FORMATETC** structure to describe what formats it can provide.</span></span>

<span data-ttu-id="4dd08-107">[**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) peut décrire pratiquement toutes les données, y compris d’autres objets tels que les monikers.</span><span class="sxs-lookup"><span data-stu-id="4dd08-107">[**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) can describe virtually any data, including other objects such as monikers.</span></span> <span data-ttu-id="4dd08-108">Un conteneur peut demander à l’un de ses objets incorporés de répertorier ses formats de données en appelant [**IDataObject :: EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), qui retourne un objet énumérateur qui implémente l’interface [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) .</span><span class="sxs-lookup"><span data-stu-id="4dd08-108">A container can ask one of its embedded objects to list its data formats by calling [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), which returns an enumerator object that implements the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) interface.</span></span> <span data-ttu-id="4dd08-109">Au lieu de répondre simplement à un « texte et une image bitmap », l’objet peut fournir une description détaillée des données, y compris l’appareil (généralement l’écran ou l’imprimante) pour laquelle il est affiché, l’aspect à présenter à l’utilisateur (contenu complet, miniature, icône ou mise en forme pour l’impression) et le support de stockage contenant les données (mémoire globale, fichier de disque, objet de stockage). ou Stream).</span><span class="sxs-lookup"><span data-stu-id="4dd08-109">Instead of replying merely that it has "text and a bitmap," the object can provide a detailed description of the data, including the device (normally screen or printer) for which it is rendered, the aspect to be presented to the user (full contents, thumbnail, icon, or formatted for printing), and the storage medium containing the data (global memory, disk file, storage object, or stream).</span></span> <span data-ttu-id="4dd08-110">Cette capacité à décrire de manière rigoureuse les données sera, dans le temps, aboutir à une meilleure qualité d’imprimante et de sortie d’écran, ainsi qu’une meilleure efficacité dans l’exploration des données, où une esquisse miniature est beaucoup plus rapide à récupérer et à afficher qu’un rendu entièrement détaillé.</span><span class="sxs-lookup"><span data-stu-id="4dd08-110">This ability to tightly describe data will, in time, result in higher quality printer and screen output as well as more efficiency in data browsing, where a thumbnail sketch is much faster to retrieve and display than a fully detailed rendering.</span></span>

<span data-ttu-id="4dd08-111">Le tableau suivant répertorie les champs de la structure de données [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) et les informations qu’elles spécifient.</span><span class="sxs-lookup"><span data-stu-id="4dd08-111">The following table lists fields of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) data structure and the information that they specify.</span></span>



| <span data-ttu-id="4dd08-112">Champ</span><span class="sxs-lookup"><span data-stu-id="4dd08-112">Field</span></span>                   | <span data-ttu-id="4dd08-113">Spécifie</span><span class="sxs-lookup"><span data-stu-id="4dd08-113">Specifies</span></span>                                                                                                                                                                                                                                                                    |
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4dd08-114">**cfFormat**</span><span class="sxs-lookup"><span data-stu-id="4dd08-114">**cfFormat**</span></span><br/> | <span data-ttu-id="4dd08-115">Format dans lequel les données doivent être restituées, qui peut être un format de presse-papiers standard, un format propriétaire ou un format OLE.</span><span class="sxs-lookup"><span data-stu-id="4dd08-115">The format in which the data is to be rendered, which can be a standard clipboard format, a proprietary format, or an OLE format.</span></span> <span data-ttu-id="4dd08-116">Pour plus d’informations sur les formats OLE, consultez [documents composés](compound-documents.md).</span><span class="sxs-lookup"><span data-stu-id="4dd08-116">For more information on OLE formats, see [Compound Documents](compound-documents.md).</span></span><br/>                                          |
| <span data-ttu-id="4dd08-117">**PTD**</span><span class="sxs-lookup"><span data-stu-id="4dd08-117">**ptd**</span></span><br/>      | <span data-ttu-id="4dd08-118">Une structure [**DVTARGETDEVICE**](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , qui contient suffisamment d’informations sur un appareil cible Windows, tel qu’un écran ou une imprimante, afin qu’un handle vers son contexte de périphérique (HDC) puisse être créé à l’aide de la fonction [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) .</span><span class="sxs-lookup"><span data-stu-id="4dd08-118">A [**DVTARGETDEVICE**](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) structure, which contains enough information about a Windows target device, such as a screen or printer, so that a handle to its device context (hDC) can be created using the [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) function.</span></span> <br/> |
| <span data-ttu-id="4dd08-119">**dwAspect**</span><span class="sxs-lookup"><span data-stu-id="4dd08-119">**dwAspect**</span></span><br/> | <span data-ttu-id="4dd08-120">Aspect ou vue des données à rendre ; peut être le contenu complet, une esquisse miniature, une icône ou un format pour l’impression.</span><span class="sxs-lookup"><span data-stu-id="4dd08-120">The aspect or view of the data to be rendered; can be the full contents, a thumbnail sketch, an icon, or formatted for printing.</span></span><br/>                                                                                                                                  |
| <span data-ttu-id="4dd08-121">**lindex**</span><span class="sxs-lookup"><span data-stu-id="4dd08-121">**lindex**</span></span><br/>   | <span data-ttu-id="4dd08-122">Partie de l’aspect intéressant ; pour le présent, la valeur doit être-1, ce qui indique que l’intégralité de la vue est intéressante.</span><span class="sxs-lookup"><span data-stu-id="4dd08-122">The part of the aspect that is of interest; for the present, the value must be -1, indicating that the entire view is of interest.</span></span><br/>                                                                                                                                |
| <span data-ttu-id="4dd08-123">**TYMED**</span><span class="sxs-lookup"><span data-stu-id="4dd08-123">**tymed**</span></span><br/>    | <span data-ttu-id="4dd08-124">Le support de stockage des données, qui peut être une mémoire globale, un fichier de disque ou une instance de l’une des interfaces de stockage structuré de COM.</span><span class="sxs-lookup"><span data-stu-id="4dd08-124">The data's storage medium, which can be global memory, disk file, or an instance of one of COM's structured-storage interfaces.</span></span><br/>                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="4dd08-125">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="4dd08-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4dd08-126">Formats de données et média de transfert</span><span class="sxs-lookup"><span data-stu-id="4dd08-126">Data Formats and Transfer Media</span></span>](data-formats-and-transfer-media.md)
</dt> </dl>

 

