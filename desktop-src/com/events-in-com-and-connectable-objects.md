---
title: Événements dans les objets COM et connectables
description: Lorsqu’un programme détecte un événement qui s’est produit, il peut notifier ses clients.
ms.assetid: f6ffbd1d-4bc1-4dc2-b3ed-ee12359e3d75
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa5115cfd08d57658eec879d44b4361e88965b3c
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/29/2020
ms.locfileid: "104030724"
---
# <a name="events-in-com-and-connectable-objects"></a><span data-ttu-id="af406-103">Événements dans les objets COM et connectables</span><span class="sxs-lookup"><span data-stu-id="af406-103">Events in COM and Connectable Objects</span></span>

<span data-ttu-id="af406-104">Lorsqu’un programme détecte un événement qui s’est produit, il peut notifier ses clients.</span><span class="sxs-lookup"><span data-stu-id="af406-104">When a program detects something that has happened, it can notify its clients.</span></span> <span data-ttu-id="af406-105">Par exemple, si un programme de cotations boursières détecte une modification du prix d’un stock, il peut informer tous les clients de la modification.</span><span class="sxs-lookup"><span data-stu-id="af406-105">For example, if a stock ticker program detects a change in the price of a stock, it can notify all clients of the change.</span></span> <span data-ttu-id="af406-106">Ce processus de notification est appelé *déclenchement d’un événement*.</span><span class="sxs-lookup"><span data-stu-id="af406-106">This notification process is referred to as *firing an event*.</span></span>

<span data-ttu-id="af406-107">Avec COM, les objets serveur peuvent utiliser des événements COM pour déclencher des événements sans informations sur les objets qui seront avertis.</span><span class="sxs-lookup"><span data-stu-id="af406-107">With COM, server objects can use COM events to fire events without any information about what objects will be notified.</span></span> <span data-ttu-id="af406-108">Les objets peuvent également utiliser des *objets connectables* pour gérer des informations détaillées sur les clients qui ont demandé des notifications.</span><span class="sxs-lookup"><span data-stu-id="af406-108">Objects can also use *connectable objects* to maintain detailed information about clients who have requested notifications.</span></span>

<span data-ttu-id="af406-109">Les objets connectables COM fournissent des interfaces sortantes à leurs clients en plus de leurs interfaces entrantes.</span><span class="sxs-lookup"><span data-stu-id="af406-109">COM connectable objects provide outgoing interfaces to their clients in addition to their incoming interfaces.</span></span> <span data-ttu-id="af406-110">Par conséquent, les objets et leurs clients peuvent être engagés dans une communication bidirectionnelle.</span><span class="sxs-lookup"><span data-stu-id="af406-110">As a result, objects and their clients can engage in bidirectional communication.</span></span> <span data-ttu-id="af406-111">Les interfaces entrantes sont implémentées sur un objet et reçoivent les appels des clients externes d’un objet, tandis que les interfaces sortantes sont implémentées sur le récepteur du client et reçoivent les appels de l’objet.</span><span class="sxs-lookup"><span data-stu-id="af406-111">Incoming interfaces are implemented on an object and receive calls from external clients of an object, while outgoing interfaces are implemented on the client's sink and receive calls from the object.</span></span> <span data-ttu-id="af406-112">L’objet définit une interface qu’il souhaite utiliser, et le client l’implémente.</span><span class="sxs-lookup"><span data-stu-id="af406-112">The object defines an interface it would like to use, and the client implements it.</span></span>

<span data-ttu-id="af406-113">Un objet définit ses interfaces entrantes et fournit des implémentations de ces interfaces.</span><span class="sxs-lookup"><span data-stu-id="af406-113">An object defines its incoming interfaces and provides implementations of these interfaces.</span></span> <span data-ttu-id="af406-114">Les interfaces entrantes sont disponibles pour les clients via la méthode [**IUnknown :: QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) de l’objet.</span><span class="sxs-lookup"><span data-stu-id="af406-114">Incoming interfaces are available to clients through the object's [**IUnknown::QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span> <span data-ttu-id="af406-115">Les clients appellent les méthodes d’une interface entrante sur l’objet, et l’objet effectue les actions souhaitées pour le compte du client.</span><span class="sxs-lookup"><span data-stu-id="af406-115">Clients call the methods of an incoming interface on the object, and the object performs desired actions on behalf of the client.</span></span>

<span data-ttu-id="af406-116">Les interfaces sortantes sont également définies par un objet, mais le client fournit les implémentations des interfaces sortantes sur un objet récepteur créé par le client.</span><span class="sxs-lookup"><span data-stu-id="af406-116">Outgoing interfaces are also defined by an object, but the client provides the implementations of the outgoing interfaces on a sink object that the client creates.</span></span> <span data-ttu-id="af406-117">L’objet appelle ensuite les méthodes de l’interface sortante sur l’objet récepteur pour informer le client des modifications apportées à l’objet, pour déclencher des événements dans le client, pour demander des éléments au client, ou, en fait, pour toutes les finalités du créateur de l’objet.</span><span class="sxs-lookup"><span data-stu-id="af406-117">The object then calls methods of the outgoing interface on the sink object to notify the client of changes in the object, to trigger events in the client, to request something from the client, or, in fact, for any purpose the object creator comes up with.</span></span>

<span data-ttu-id="af406-118">Un exemple d’interface sortante est une interface IButtonSink définie par un contrôle de bouton de commande pour notifier ses clients de ses événements.</span><span class="sxs-lookup"><span data-stu-id="af406-118">An example of an outgoing interface is an IButtonSink interface defined by a push button control to notify its clients of its events.</span></span> <span data-ttu-id="af406-119">Par exemple, l’objet bouton appelle IButtonSink :: OnClick sur l’objet récepteur du client lorsque l’utilisateur clique sur le bouton à l’écran.</span><span class="sxs-lookup"><span data-stu-id="af406-119">For example, the button object calls IButtonSink::OnClick on the client's sink object when the user clicks the button on the screen.</span></span> <span data-ttu-id="af406-120">Le contrôle Button définit l’interface sortante.</span><span class="sxs-lookup"><span data-stu-id="af406-120">The button control defines the outgoing interface.</span></span> <span data-ttu-id="af406-121">Pour qu’un client du bouton gère l’événement, le client doit implémenter cette interface sortante sur un objet récepteur, puis connecter ce récepteur au contrôle bouton.</span><span class="sxs-lookup"><span data-stu-id="af406-121">For a client of the button to handle the event, the client must implement that outgoing interface on a sink object and then connect that sink to the button control.</span></span> <span data-ttu-id="af406-122">Ensuite, lorsque des événements se produisent dans le bouton, le bouton appelle le récepteur, auquel cas le client peut exécuter toutes les actions qu’il souhaite assigner à ce clic de bouton.</span><span class="sxs-lookup"><span data-stu-id="af406-122">Then, when events occur in the button, the button will call the sink, at which time the client can execute whatever action it wishes to assign to that button click.</span></span>

<span data-ttu-id="af406-123">Les objets connectables fournissent un mécanisme général pour la communication entre les clients.</span><span class="sxs-lookup"><span data-stu-id="af406-123">Connectable objects provide a general mechanism for object-to-client communication.</span></span> <span data-ttu-id="af406-124">Tout objet qui souhaite exposer des événements ou des notifications de n’importe quel type peut utiliser cette technologie.</span><span class="sxs-lookup"><span data-stu-id="af406-124">Any object that wishes to expose events or notifications of any kind can use this technology.</span></span> <span data-ttu-id="af406-125">En plus de la technologie générale de l’objet connectable, COM fournit de nombreuses interfaces de site et de récepteur spécialement utilisées par les objets pour informer les clients d’événements spécifiques qui présentent un intérêt pour le client.</span><span class="sxs-lookup"><span data-stu-id="af406-125">In addition to the general connectable object technology, COM provides many special purpose sink and site interfaces used by objects to notify clients of specific events of interest to the client.</span></span> <span data-ttu-id="af406-126">Par exemple, [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) peut être utilisé par des objets pour notifier des clients de données et afficher des modifications dans l’objet.</span><span class="sxs-lookup"><span data-stu-id="af406-126">For example, [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) may be used by objects to notify clients of data and view changes in the object.</span></span>

<span data-ttu-id="af406-127">Pour plus d'informations, voir les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="af406-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="af406-128">Architecture des objets connectables</span><span class="sxs-lookup"><span data-stu-id="af406-128">Architecture of Connectable Objects</span></span>](architecture-of-connectable-objects.md)
-   [<span data-ttu-id="af406-129">Interfaces d’objets connectables</span><span class="sxs-lookup"><span data-stu-id="af406-129">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)

 

 




