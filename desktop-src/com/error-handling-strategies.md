---
title: Stratégies de gestion des erreurs
description: Stratégies de gestion des erreurs
ms.assetid: 8d03ede8-0661-43dc-adaf-3c1f5fc1687e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36c594a8b1e5baf0eab3d928b8f1b861b7f0160d
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/29/2020
ms.locfileid: "104462691"
---
# <a name="error-handling-strategies"></a><span data-ttu-id="d1e33-103">Stratégies de gestion des erreurs</span><span class="sxs-lookup"><span data-stu-id="d1e33-103">Error Handling Strategies</span></span>

<span data-ttu-id="d1e33-104">Étant donné que les méthodes d’interface sont virtuelles, il n’est pas possible pour un appelant de connaître l’ensemble des valeurs qui peuvent être retournées à partir d’un appel quelconque.</span><span class="sxs-lookup"><span data-stu-id="d1e33-104">Because interface methods are virtual, it is not possible for a caller to know the full set of values that may be returned from any one call.</span></span> <span data-ttu-id="d1e33-105">Une implémentation d’une méthode peut retourner cinq valeurs ; un autre peut retourner huit.</span><span class="sxs-lookup"><span data-stu-id="d1e33-105">One implementation of a method may return five values; another may return eight.</span></span>

<span data-ttu-id="d1e33-106">La documentation répertorie les valeurs communes qui peuvent être retournées pour chaque méthode. Il s’agit des valeurs que vous devez vérifier et gérer dans votre code, car elles ont des significations particulières.</span><span class="sxs-lookup"><span data-stu-id="d1e33-106">The documentation lists common values that may be returned for each method; these are the values that you must check for and handle in your code because they have special meanings.</span></span> <span data-ttu-id="d1e33-107">D’autres valeurs peuvent être retournées, mais étant donné qu’elles ne sont pas significatives, vous n’avez pas besoin d’écrire un code spécial pour les gérer.</span><span class="sxs-lookup"><span data-stu-id="d1e33-107">Other values may be returned, but because they are not meaningful, you do not need to write special code to handle them.</span></span> <span data-ttu-id="d1e33-108">Une vérification simple pour zéro ou une valeur différente de zéro est appropriée.</span><span class="sxs-lookup"><span data-stu-id="d1e33-108">A simple check for zero or nonzero is adequate.</span></span>

## <a name="hresult-values"></a><span data-ttu-id="d1e33-109">Valeurs HRESULT</span><span class="sxs-lookup"><span data-stu-id="d1e33-109">HRESULT Values</span></span>

<span data-ttu-id="d1e33-110">La valeur de retour des fonctions et des méthodes COM est un **HRESULT**.</span><span class="sxs-lookup"><span data-stu-id="d1e33-110">The return value of COM functions and methods is an **HRESULT**.</span></span> <span data-ttu-id="d1e33-111">Les valeurs de certains HRESULTs ont été modifiées dans COM pour éliminer toute duplication et se chevaucher avec les codes d’erreur système.</span><span class="sxs-lookup"><span data-stu-id="d1e33-111">The values of some HRESULTs have been changed in COM to eliminate all duplication and overlapping with the system error codes.</span></span> <span data-ttu-id="d1e33-112">Ceux qui dupliquent les codes d’erreur système ont été remplacés par l’installation de \_ Win32, et ceux qui se chevauchent restent \_ null.</span><span class="sxs-lookup"><span data-stu-id="d1e33-112">Those that duplicate system error codes have been changed to FACILITY\_WIN32, and those that overlap remain in FACILITY\_NULL.</span></span> <span data-ttu-id="d1e33-113">Les valeurs **HRESULT** communes et leurs valeurs sont répertoriées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="d1e33-113">Common **HRESULT** values and their values are listed in the following table.</span></span>



| <span data-ttu-id="d1e33-114">HRESULT</span><span class="sxs-lookup"><span data-stu-id="d1e33-114">HRESULT</span></span>                    | <span data-ttu-id="d1e33-115">Valeur</span><span class="sxs-lookup"><span data-stu-id="d1e33-115">Value</span></span>                 | <span data-ttu-id="d1e33-116">Description</span><span class="sxs-lookup"><span data-stu-id="d1e33-116">Description</span></span>                                                                                                                                        |
|----------------------------|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d1e33-117">E \_ Abort</span><span class="sxs-lookup"><span data-stu-id="d1e33-117">E\_ABORT</span></span><br/>        | <span data-ttu-id="d1e33-118">0x80004004</span><span class="sxs-lookup"><span data-stu-id="d1e33-118">0x80004004</span></span><br/> | <span data-ttu-id="d1e33-119">L’opération a été abandonnée en raison d’une erreur non spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d1e33-119">The operation was aborted because of an unspecified error.</span></span><br/>                                                                              |
| <span data-ttu-id="d1e33-120">\_ACCESSDENIED E</span><span class="sxs-lookup"><span data-stu-id="d1e33-120">E\_ACCESSDENIED</span></span><br/> | <span data-ttu-id="d1e33-121">0x80070005</span><span class="sxs-lookup"><span data-stu-id="d1e33-121">0x80070005</span></span><br/> | <span data-ttu-id="d1e33-122">Une erreur générale d’accès refusé.</span><span class="sxs-lookup"><span data-stu-id="d1e33-122">A general access-denied error.</span></span><br/>                                                                                                          |
| <span data-ttu-id="d1e33-123">E \_ échec</span><span class="sxs-lookup"><span data-stu-id="d1e33-123">E\_FAIL</span></span><br/>         | <span data-ttu-id="d1e33-124">0x80004005</span><span class="sxs-lookup"><span data-stu-id="d1e33-124">0x80004005</span></span><br/> | <span data-ttu-id="d1e33-125">Une erreur non spécifiée s’est produite.</span><span class="sxs-lookup"><span data-stu-id="d1e33-125">An unspecified failure has occurred.</span></span><br/>                                                                                                    |
| <span data-ttu-id="d1e33-126">\_handle E</span><span class="sxs-lookup"><span data-stu-id="d1e33-126">E\_HANDLE</span></span><br/>       | <span data-ttu-id="d1e33-127">0x80070006</span><span class="sxs-lookup"><span data-stu-id="d1e33-127">0x80070006</span></span><br/> | <span data-ttu-id="d1e33-128">Un descripteur non valide a été utilisé.</span><span class="sxs-lookup"><span data-stu-id="d1e33-128">An invalid handle was used.</span></span><br/>                                                                                                             |
| <span data-ttu-id="d1e33-129">E \_ INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="d1e33-129">E\_INVALIDARG</span></span><br/>   | <span data-ttu-id="d1e33-130">0x80070057</span><span class="sxs-lookup"><span data-stu-id="d1e33-130">0x80070057</span></span><br/> | <span data-ttu-id="d1e33-131">Un ou plusieurs arguments ne sont pas valides.</span><span class="sxs-lookup"><span data-stu-id="d1e33-131">One or more arguments are invalid.</span></span><br/>                                                                                                      |
| <span data-ttu-id="d1e33-132">E \_ NOinterface</span><span class="sxs-lookup"><span data-stu-id="d1e33-132">E\_NOINTERFACE</span></span><br/>  | <span data-ttu-id="d1e33-133">0x80004002</span><span class="sxs-lookup"><span data-stu-id="d1e33-133">0x80004002</span></span><br/> | <span data-ttu-id="d1e33-134">La méthode [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) n’a pas reconnu l’interface demandée.</span><span class="sxs-lookup"><span data-stu-id="d1e33-134">The [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method did not recognize the requested interface.</span></span> <span data-ttu-id="d1e33-135">L’interface n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="d1e33-135">The interface is not supported.</span></span><br/> |
| <span data-ttu-id="d1e33-136">\_NOTIMPL E</span><span class="sxs-lookup"><span data-stu-id="d1e33-136">E\_NOTIMPL</span></span><br/>      | <span data-ttu-id="d1e33-137">0x80004001</span><span class="sxs-lookup"><span data-stu-id="d1e33-137">0x80004001</span></span><br/> | <span data-ttu-id="d1e33-138">Cette méthode n'est pas implémentée.</span><span class="sxs-lookup"><span data-stu-id="d1e33-138">The method is not implemented.</span></span><br/>                                                                                                          |
| <span data-ttu-id="d1e33-139">\_OUTOFMEMORY E</span><span class="sxs-lookup"><span data-stu-id="d1e33-139">E\_OUTOFMEMORY</span></span><br/>  | <span data-ttu-id="d1e33-140">0x8007000E</span><span class="sxs-lookup"><span data-stu-id="d1e33-140">0x8007000E</span></span><br/> | <span data-ttu-id="d1e33-141">La méthode n’a pas pu allouer la mémoire nécessaire.</span><span class="sxs-lookup"><span data-stu-id="d1e33-141">The method failed to allocate necessary memory.</span></span><br/>                                                                                         |
| <span data-ttu-id="d1e33-142">E \_ en attente</span><span class="sxs-lookup"><span data-stu-id="d1e33-142">E\_PENDING</span></span><br/>      | <span data-ttu-id="d1e33-143">0x8000000A</span><span class="sxs-lookup"><span data-stu-id="d1e33-143">0x8000000A</span></span><br/> | <span data-ttu-id="d1e33-144">Les données nécessaires à l’exécution de l’opération ne sont pas encore disponibles.</span><span class="sxs-lookup"><span data-stu-id="d1e33-144">The data necessary to complete the operation is not yet available.</span></span><br/>                                                                      |
| <span data-ttu-id="d1e33-145">\_pointeur E</span><span class="sxs-lookup"><span data-stu-id="d1e33-145">E\_POINTER</span></span><br/>      | <span data-ttu-id="d1e33-146">0x80004003</span><span class="sxs-lookup"><span data-stu-id="d1e33-146">0x80004003</span></span><br/> | <span data-ttu-id="d1e33-147">Un pointeur non valide a été utilisé.</span><span class="sxs-lookup"><span data-stu-id="d1e33-147">An invalid pointer was used.</span></span><br/>                                                                                                            |
| <span data-ttu-id="d1e33-148">E \_ inattendu</span><span class="sxs-lookup"><span data-stu-id="d1e33-148">E\_UNEXPECTED</span></span><br/>   | <span data-ttu-id="d1e33-149">0x8000FFFF</span><span class="sxs-lookup"><span data-stu-id="d1e33-149">0x8000FFFF</span></span><br/> | <span data-ttu-id="d1e33-150">Une défaillance catastrophique s’est produite.</span><span class="sxs-lookup"><span data-stu-id="d1e33-150">A catastrophic failure has occurred.</span></span><br/>                                                                                                    |
| <span data-ttu-id="d1e33-151">S \_ false</span><span class="sxs-lookup"><span data-stu-id="d1e33-151">S\_FALSE</span></span><br/>        | <span data-ttu-id="d1e33-152">0x00000001</span><span class="sxs-lookup"><span data-stu-id="d1e33-152">0x00000001</span></span><br/> | <span data-ttu-id="d1e33-153">La méthode a réussi et a retourné la valeur booléenne **false**.</span><span class="sxs-lookup"><span data-stu-id="d1e33-153">The method succeeded and returned the boolean value **FALSE**.</span></span><br/>                                                                          |
| <span data-ttu-id="d1e33-154">\_OK</span><span class="sxs-lookup"><span data-stu-id="d1e33-154">S\_OK</span></span><br/>           | <span data-ttu-id="d1e33-155">0x00000000</span><span class="sxs-lookup"><span data-stu-id="d1e33-155">0x00000000</span></span><br/> | <span data-ttu-id="d1e33-156">S_OK</span><span class="sxs-lookup"><span data-stu-id="d1e33-156">The method succeeded.</span></span> <span data-ttu-id="d1e33-157">Si une valeur de retour booléenne est attendue, la valeur retournée est **true**.</span><span class="sxs-lookup"><span data-stu-id="d1e33-157">If a boolean return value is expected, the returned value is **TRUE**.</span></span><br/>                                            |



 

## <a name="network-errors"></a><span data-ttu-id="d1e33-158">Erreurs réseau</span><span class="sxs-lookup"><span data-stu-id="d1e33-158">Network Errors</span></span>

<span data-ttu-id="d1e33-159">Si les quatre premiers chiffres du code d’erreur sont 8007, cela indique une erreur système ou réseau.</span><span class="sxs-lookup"><span data-stu-id="d1e33-159">If the first four digits of the error code are 8007, this indicates a system or network error.</span></span> <span data-ttu-id="d1e33-160">Vous pouvez utiliser la commande **net** pour décoder ces types d’erreurs.</span><span class="sxs-lookup"><span data-stu-id="d1e33-160">You can use the **net** command to decode these types of errors.</span></span> <span data-ttu-id="d1e33-161">Pour décoder l’erreur, commencez par convertir les quatre derniers chiffres du code d’erreur hexadécimal en décimal.</span><span class="sxs-lookup"><span data-stu-id="d1e33-161">To decode the error, first convert the last four digits of the hexadecimal error code to decimal.</span></span> <span data-ttu-id="d1e33-162">Ensuite, à l’invite de commandes, tapez ce qui suit, où le code décimal est remplacé par la valeur de retour que vous souhaitez décoder :</span><span class="sxs-lookup"><span data-stu-id="d1e33-162">Then, at the command prompt, type the following, where decimal code is replaced with the return value you want to decode:</span></span>

<span data-ttu-id="d1e33-163">**net helpmsg <***\_ Code décimal***>**</span><span class="sxs-lookup"><span data-stu-id="d1e33-163">**net helpmsg <***decimal\_code***>**</span></span>

<span data-ttu-id="d1e33-164">La commande net renvoie une description de l’erreur.</span><span class="sxs-lookup"><span data-stu-id="d1e33-164">The net command returns a description of the error.</span></span> <span data-ttu-id="d1e33-165">Par exemple, si COM retourne l’erreur 8007054B, convertissez 054B en Decimal (1355).</span><span class="sxs-lookup"><span data-stu-id="d1e33-165">For example, if COM returns the error 8007054B, convert the 054B to decimal (1355).</span></span> <span data-ttu-id="d1e33-166">Tapez ensuite la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="d1e33-166">Then type the following:</span></span>

<span data-ttu-id="d1e33-167">**net helpmsg 1355**</span><span class="sxs-lookup"><span data-stu-id="d1e33-167">**net helpmsg 1355**</span></span>

<span data-ttu-id="d1e33-168">La commande net retourne la description de l’erreur : « le domaine spécifié n’existe pas ».</span><span class="sxs-lookup"><span data-stu-id="d1e33-168">The net command returns the error description: "The specified domain did not exist".</span></span>

## <a name="related-topics"></a><span data-ttu-id="d1e33-169">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="d1e33-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d1e33-170">Gestion des erreurs dans COM</span><span class="sxs-lookup"><span data-stu-id="d1e33-170">Error Handling in COM</span></span>](error-handling-in-com.md)
</dt> </dl>

 

 





