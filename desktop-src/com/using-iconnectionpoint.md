---
title: Utilisation de IConnectionPoint
description: Utilisation de IConnectionPoint
ms.assetid: afd50b84-1fd6-47ad-a3ef-e8b4a725b72b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe7aa758ec1bd40233b1cc41a6c375ed296fc167
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104031883"
---
# <a name="using-iconnectionpoint"></a><span data-ttu-id="ba146-103">Utilisation de IConnectionPoint</span><span class="sxs-lookup"><span data-stu-id="ba146-103">Using IConnectionPoint</span></span>

<span data-ttu-id="ba146-104">Lorsque le client a un pointeur vers un point de connexion, il peut effectuer les opérations suivantes, comme exprimé par [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint):</span><span class="sxs-lookup"><span data-stu-id="ba146-104">When the client has a pointer to a connection point, it can perform the following operations as expressed through [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint):</span></span>

-   <span data-ttu-id="ba146-105">En premier lieu, [**IConnectionPoint :: GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) récupère l’IID d’interface sortante pris en charge par le point de connexion.</span><span class="sxs-lookup"><span data-stu-id="ba146-105">First, [**IConnectionPoint::GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) retrieves the outgoing interface IID supported by the connection point.</span></span> <span data-ttu-id="ba146-106">Lorsqu’elle est utilisée conjointement avec [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints), cette méthode permet au client d’examiner les IID de toutes les interfaces sortantes prises en charge sur l’objet connectable.</span><span class="sxs-lookup"><span data-stu-id="ba146-106">When used in conjunction with [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints), this method allows the client to examine the IIDs of all outgoing interfaces supported on the connectable object.</span></span>
-   <span data-ttu-id="ba146-107">Deuxièmement, un client peut naviguer à partir du point de connexion vers l’interface [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) de l’objet connectable par le biais de la méthode [**IConnectionPoint :: GetConnectionPointContainer**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectionpointcontainer) .</span><span class="sxs-lookup"><span data-stu-id="ba146-107">Second, a client can navigate from the connection point back to the connectable object's [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) interface through the [**IConnectionPoint::GetConnectionPointContainer**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectionpointcontainer) method.</span></span>
-   <span data-ttu-id="ba146-108">Troisièmement, les méthodes les plus intéressantes pour le client sont [**IConnectionPoint :: Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) et [**IConnectionPoint :: Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise).</span><span class="sxs-lookup"><span data-stu-id="ba146-108">Third, the most interesting methods for the client are [**IConnectionPoint::Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) and [**IConnectionPoint::Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise).</span></span> <span data-ttu-id="ba146-109">Lorsqu’un client souhaite connecter son propre objet récepteur à l’objet connectable, le client passe le pointeur [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) du récepteur (ou tout autre pointeur d’interface sur le même objet) à **conseiller**.</span><span class="sxs-lookup"><span data-stu-id="ba146-109">When a client wishes to connect its own sink object to the connectable object, the client passes the sink's [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) pointer (or any other interface pointer on the same object) to **Advise**.</span></span> <span data-ttu-id="ba146-110">Le point de connexion interroge le récepteur pour l’interface sortante spécifique qui est attendue.</span><span class="sxs-lookup"><span data-stu-id="ba146-110">The connection point queries the sink for the specific outgoing interface that is expected.</span></span> <span data-ttu-id="ba146-111">Si cette interface est disponible sur le récepteur, le point de connexion stocke ensuite le pointeur d’interface.</span><span class="sxs-lookup"><span data-stu-id="ba146-111">If that interface is available on the sink, the connection point then stores the interface pointer.</span></span> <span data-ttu-id="ba146-112">À partir de ce point jusqu’à l’appel de **Unadvise** , l’objet connectable effectue des appels au récepteur via cette interface lorsque des événements se produisent.</span><span class="sxs-lookup"><span data-stu-id="ba146-112">From this point until **Unadvise** is called, the connectable object will make calls to the sink through this interface when events occur.</span></span> <span data-ttu-id="ba146-113">Pour déconnecter le récepteur du point de connexion, le client passe une clé retournée de la part de l' **Avertissement** à la méthode **Unadvise** .</span><span class="sxs-lookup"><span data-stu-id="ba146-113">To disconnect the sink from the connection point, the client passes a key returned from **Advise** to the **Unadvise** method.</span></span> <span data-ttu-id="ba146-114">**Unadvise** doit appeler [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) sur l’interface du récepteur.</span><span class="sxs-lookup"><span data-stu-id="ba146-114">**Unadvise** must call [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) on the sink interface.</span></span>
-   <span data-ttu-id="ba146-115">Enfin, un client peut demander à un point de connexion d’énumérer toutes les connexions qui existent avec [**IConnectionPoint :: EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections).</span><span class="sxs-lookup"><span data-stu-id="ba146-115">Finally, a client can ask a connection point to enumerate all the connections to it that exist through [**IConnectionPoint::EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections).</span></span> <span data-ttu-id="ba146-116">Cette méthode crée un objet énumérateur (avec un nombre de références distinct) qui retourne un pointeur [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) vers celui-ci.</span><span class="sxs-lookup"><span data-stu-id="ba146-116">This method creates an enumerator object (with a separate reference count) returning an [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) pointer to it.</span></span> <span data-ttu-id="ba146-117">Le client doit appeler [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) quand l’énumérateur n’est plus nécessaire.</span><span class="sxs-lookup"><span data-stu-id="ba146-117">The client must call [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) when the enumerator is no longer needed.</span></span> <span data-ttu-id="ba146-118">En outre, l’énumérateur retourne une série de structures [**CONNECTDATA**](/windows/win32/api/ocidl/ns-ocidl-connectdata) , une pour chaque connexion.</span><span class="sxs-lookup"><span data-stu-id="ba146-118">Additionally, the enumerator returns a series of [**CONNECTDATA**](/windows/win32/api/ocidl/ns-ocidl-connectdata) structures, one for each connection.</span></span> <span data-ttu-id="ba146-119">Chaque structure décrit une connexion à l’aide du pointeur [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) du récepteur, ainsi que la clé de connexion initialement retournée par la fonction [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise).</span><span class="sxs-lookup"><span data-stu-id="ba146-119">Each structure describes one connection using the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) pointer of the sink as well as the connection key originally returned from [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise).</span></span> <span data-ttu-id="ba146-120">Lorsque vous avez terminé avec ces pointeurs d’interface sink, le client doit appeler **Release** sur chaque pointeur retourné dans une structure **CONNECTDATA** .</span><span class="sxs-lookup"><span data-stu-id="ba146-120">When done with these sink interface pointers, the client must call **Release** on each pointer returned in a **CONNECTDATA** structure.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ba146-121">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="ba146-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ba146-122">Interfaces d’objets connectables</span><span class="sxs-lookup"><span data-stu-id="ba146-122">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 