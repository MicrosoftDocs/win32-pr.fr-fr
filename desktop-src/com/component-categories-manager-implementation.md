---
title: Implémentation du gestionnaire de catégories de composants
description: À mesure que le nombre de composants disponibles augmente, il devient de plus en plus difficile de gérer ces composants. En ce qui concerne les interfaces qu’ils exposent, ainsi que les tâches qu’ils effectuent, de nombreux composants offrent des fonctionnalités similaires.
ms.assetid: c2c67129-bf19-465b-8354-193922aeafaa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2414567beba159c05ea08b3561f0a97ddda1cb70
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103940316"
---
# <a name="component-categories-manager-implementation"></a><span data-ttu-id="916ae-104">Implémentation du gestionnaire de catégories de composants</span><span class="sxs-lookup"><span data-stu-id="916ae-104">Component Categories Manager Implementation</span></span>

<span data-ttu-id="916ae-105">À mesure que le nombre de composants disponibles augmente, il devient de plus en plus difficile de gérer ces composants.</span><span class="sxs-lookup"><span data-stu-id="916ae-105">As the number of available components grows, it becomes increasingly difficult to manage these components.</span></span> <span data-ttu-id="916ae-106">En ce qui concerne les interfaces qu’ils exposent, ainsi que les tâches qu’ils effectuent, de nombreux composants offrent des fonctionnalités similaires.</span><span class="sxs-lookup"><span data-stu-id="916ae-106">In terms of the interfaces they expose as well as the tasks they perform, many components offer similar functionality.</span></span>

<span data-ttu-id="916ae-107">Il est souvent nécessaire d’énumérer les composants qui peuvent être utilisés dans un certain contexte.</span><span class="sxs-lookup"><span data-stu-id="916ae-107">It is often necessary to enumerate the components that can be used in a certain context.</span></span> <span data-ttu-id="916ae-108">Voici quelques exemples : la boîte de dialogue **Insérer un objet** utilisée dans les documents composés OLE et la boîte de dialogue **Insérer un contrôle** utilisée dans les contrôles OLE.</span><span class="sxs-lookup"><span data-stu-id="916ae-108">Examples of this are the **Insert Object** dialog box used in OLE compound documents and the **Insert Control** dialog box used in OLE controls.</span></span> <span data-ttu-id="916ae-109">Ces boîtes de dialogue répertorient tous les composants qui remplissent (ou revendiquent de satisfaire) les contrats d’interface pour les documents ou les contrôles composés.</span><span class="sxs-lookup"><span data-stu-id="916ae-109">These dialog boxes list all components that fulfill (or claim to fulfill) the interface contracts for compound documents or controls.</span></span> <span data-ttu-id="916ae-110">Ces catégories existantes (document OLE, contrôle OLE) n’impliquent pas une signature d’interface exacte.</span><span class="sxs-lookup"><span data-stu-id="916ae-110">These existing categories (OLE document, OLE control) do not imply an exact interface signature.</span></span> <span data-ttu-id="916ae-111">Les documents OLE doivent exposer un certain ensemble d’interfaces de base (par exemple, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) ou [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)), mais peuvent également exposer des interfaces supplémentaires telles que [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span><span class="sxs-lookup"><span data-stu-id="916ae-111">OLE documents have to expose a certain set of core interfaces (for example, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) or [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)) but can also expose additional interfaces such as [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span></span>

<span data-ttu-id="916ae-112">Dans le passé, les composants ont été balisés en ajoutant un nom explicite (« Insertable », « contrôle », etc.) en tant que sous-clé du **\_ CLSID racine des classes HKEY \_ \\ \\ {...}**</span><span class="sxs-lookup"><span data-stu-id="916ae-112">In the past, components have been tagged by adding a human-readable name ("Insertable", "Control", and so on) as a subkey to the **HKEY\_CLASSES\_ROOT\\CLSID\\{...}**</span></span> <span data-ttu-id="916ae-113">clé de Registre correspondant au composant.</span><span class="sxs-lookup"><span data-stu-id="916ae-113">registry key corresponding to the component.</span></span> <span data-ttu-id="916ae-114">Cela fonctionne bien pour une définition centrale des catégories, mais présente des risques de collisions de noms lorsque de nombreuses parties indépendantes définissent de nouvelles catégories.</span><span class="sxs-lookup"><span data-stu-id="916ae-114">This works well for a central definition of categories but risks name collisions when many independent parties define new categories.</span></span> <span data-ttu-id="916ae-115">Comme dans d’autres domaines de COM, la solution pour fournir un espace de noms extensible réside dans l’utilisation d’identificateurs globaux uniques (GUID).</span><span class="sxs-lookup"><span data-stu-id="916ae-115">As in other areas of COM, the solution to providing an extensible namespace lies in the use of globally unique identifiers (GUIDs).</span></span> <span data-ttu-id="916ae-116">Au lieu d’utiliser un nom explicite, un nombre unique (CATID) est affecté à chaque catégorie.</span><span class="sxs-lookup"><span data-stu-id="916ae-116">Instead of using a human-readable name, a unique number (CATID) is assigned to each category.</span></span>

<span data-ttu-id="916ae-117">Une autre limitation à la catégorisation existante est qu’elle est limitée à l’expression des fonctionnalités du composant lui-même.</span><span class="sxs-lookup"><span data-stu-id="916ae-117">Another limitation with the existing categorization is that it is limited to expressing the capabilities of the component itself.</span></span> <span data-ttu-id="916ae-118">De nombreux composants requièrent certaines fonctionnalités des conteneurs.</span><span class="sxs-lookup"><span data-stu-id="916ae-118">Many components require certain capabilities from the containers.</span></span> <span data-ttu-id="916ae-119">Lorsqu’un tel composant est inséré dans un conteneur, l’insertion peut échouer ou se comporter de manière inattendue, même si le composant respecte les contrats de l’une de ses catégories.</span><span class="sxs-lookup"><span data-stu-id="916ae-119">When such a component is inserted into a container, the insertion can fail or behave unexpectedly, even though the component fulfills the contracts implied by one of its categories.</span></span> <span data-ttu-id="916ae-120">Pour énumérer les composants qui peuvent être utilisés avec succès dans certaines situations, les fonctionnalités du composant et du conteneur doivent être prises en compte.</span><span class="sxs-lookup"><span data-stu-id="916ae-120">To enumerate the components that can be used successfully in certain situations, the capabilities of both the component and the container must be considered.</span></span>

<span data-ttu-id="916ae-121">En raison de ces considérations, les modifications suivantes ont été apportées à la catégorisation existante :</span><span class="sxs-lookup"><span data-stu-id="916ae-121">Because of these considerations, the following changes were made to the existing categorization:</span></span>

-   <span data-ttu-id="916ae-122">Les catégories sont indiquées à l’aide de CATID qui sont des identificateurs globaux uniques.</span><span class="sxs-lookup"><span data-stu-id="916ae-122">Categories are indicated by using CATIDs that are globally unique identifiers.</span></span>
-   <span data-ttu-id="916ae-123">Dans la sous-clé **Components** de la clé de Registre **HKEY \_ classes \_ racine \\ CLSID** , deux sous-clés distinctes, « Categories Implemented » et « categories required », ont été développées.</span><span class="sxs-lookup"><span data-stu-id="916ae-123">Under the **Components** subkey of the **HKEY\_CLASSES\_ROOT\\CLSID** registry key, two separate subkeys, "Implemented Categories" and "Required Categories", were developed.</span></span> <span data-ttu-id="916ae-124">Ces sous-clés contiennent les listes de CATID fournis par le composant ou que le conteneur du composant doit fournir.</span><span class="sxs-lookup"><span data-stu-id="916ae-124">These subkeys contain the lists of CATIDs that are provided by the component or that the container of the component must provide.</span></span>

<span data-ttu-id="916ae-125">Pour faciliter la gestion des catégories de composants, les catégories sont répertoriées à un emplacement central dans le registre : **\_ catégories du \_ \\ composant racine des classes HKEY**.</span><span class="sxs-lookup"><span data-stu-id="916ae-125">To ease managing the component categories, categories are listed in a central place in the registry: **HKEY\_CLASSES\_ROOT\\Component Categories**.</span></span> <span data-ttu-id="916ae-126">Cette clé répertorie les catégories installées avec leur CATID et avec des noms localisés et explicites.</span><span class="sxs-lookup"><span data-stu-id="916ae-126">This key lists the installed categories both with their CATID and with localized, human-readable names.</span></span>

<span data-ttu-id="916ae-127">Pour plus d'informations, voir les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="916ae-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="916ae-128">Catégorisation par fonctionnalités de composant</span><span class="sxs-lookup"><span data-stu-id="916ae-128">Categorizing by Component Capabilities</span></span>](categorizing-by-component-capabilities.md)
-   [<span data-ttu-id="916ae-129">Catégorisation par fonctionnalités de conteneur</span><span class="sxs-lookup"><span data-stu-id="916ae-129">Categorizing by Container Capabilities</span></span>](categorizing-by-container-capabilities.md)
-   [<span data-ttu-id="916ae-130">Gestionnaire de catégories de composants</span><span class="sxs-lookup"><span data-stu-id="916ae-130">The Component Categories Manager</span></span>](the-component-categories-manager.md)
-   [<span data-ttu-id="916ae-131">Classes et associations par défaut</span><span class="sxs-lookup"><span data-stu-id="916ae-131">Default Classes and Associations</span></span>](default-classes-and-associations.md)
-   [<span data-ttu-id="916ae-132">Définition des catégories de composants</span><span class="sxs-lookup"><span data-stu-id="916ae-132">Defining Component Categories</span></span>](defining-component-categories.md)
-   [<span data-ttu-id="916ae-133">Association d’icônes à une catégorie</span><span class="sxs-lookup"><span data-stu-id="916ae-133">Associating Icons with a Category</span></span>](associating-icons-with-a-category.md)

 

 




