---
title: Gestionnaire de Client-Side léger
description: Les gestionnaires légers côté client vous permettent de créer des gestionnaires généraux côté client de toutes tailles, pour vous aider à effectuer n’importe quel type de tâche standard.
ms.assetid: b712237c-55d7-4f52-9cf6-19c6e5fb3182
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f1e8df5be24e8773a660a4d0208b27a2f585e32
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730540"
---
# <a name="the-lightweight-client-side-handler"></a><span data-ttu-id="c8f74-103">Gestionnaire de Client-Side léger</span><span class="sxs-lookup"><span data-stu-id="c8f74-103">The Lightweight Client-Side Handler</span></span>

<span data-ttu-id="c8f74-104">Les gestionnaires légers côté client vous permettent de créer des gestionnaires généraux côté client de toutes tailles, pour vous aider à effectuer n’importe quel type de tâche standard.</span><span class="sxs-lookup"><span data-stu-id="c8f74-104">Lightweight client-side handlers allow you to create general client-side handlers of any size, to help you do any kind of standard task.</span></span> <span data-ttu-id="c8f74-105">En tant que gestionnaires, ceux-ci sont utilisables par plusieurs clients.</span><span class="sxs-lookup"><span data-stu-id="c8f74-105">As handlers, these are usable by more than one client.</span></span> <span data-ttu-id="c8f74-106">Ils diffèrent des gestionnaires OLE en ce qu’ils ne peuvent pas être créés avant le lancement du serveur, et leur durée de vie est liée à celle du gestionnaire proxy, ce qui évite une condition de concurrence potentielle dans laquelle le gestionnaire pourrait autrement être libéré prématurément.</span><span class="sxs-lookup"><span data-stu-id="c8f74-106">They differ from OLE handlers in that they cannot be created before the server is launched, and their lifetime is tied to that of the proxy manager, preventing a possible race condition in which the handler could otherwise be prematurely released.</span></span>

<span data-ttu-id="c8f74-107">Le gestionnaire proxy est l’objet créé par le système qui implémente l’interface [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) .</span><span class="sxs-lookup"><span data-stu-id="c8f74-107">The proxy manager is the system-created object that implements the [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) interface.</span></span> <span data-ttu-id="c8f74-108">Si vous utilisez le marshaling standard, le système le crée pour vous lorsque vous appelez [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (ou [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), pour créer un marshaleur agrégé pour les gestionnaires légers) et implémente également les interfaces [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) et [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="c8f74-108">If you use standard marshaling, the system creates it for you when you call [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (or [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), for creating an aggregated marshaler for lightweight handlers) and also implements the [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) and [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) interfaces on the object.</span></span> <span data-ttu-id="c8f74-109">Côté serveur, il existe un objet système correspondant qui implémente également **IMarshal**.</span><span class="sxs-lookup"><span data-stu-id="c8f74-109">On the server side, there is a corresponding system object that also implements **IMarshal**.</span></span> <span data-ttu-id="c8f74-110">Ces objets gèrent le marshaling pour vous en toute transparence.</span><span class="sxs-lookup"><span data-stu-id="c8f74-110">These objects handle marshaling for you transparently.</span></span>

<span data-ttu-id="c8f74-111">Il existe deux types généraux de gestionnaires que vous pouvez implémenter :</span><span class="sxs-lookup"><span data-stu-id="c8f74-111">There are two general types of these handlers that you may want to implement:</span></span>

-   <span data-ttu-id="c8f74-112">Gestionnaire qui exécute un service qui ne requiert aucune donnée supplémentaire du serveur</span><span class="sxs-lookup"><span data-stu-id="c8f74-112">A handler that performs a service that requires no extra data from the server</span></span>
-   <span data-ttu-id="c8f74-113">Gestionnaire qui utilise des données supplémentaires à partir du serveur</span><span class="sxs-lookup"><span data-stu-id="c8f74-113">A handler that uses extra data from the server</span></span>

<span data-ttu-id="c8f74-114">Voici quelques-unes des utilisations possibles des données supplémentaires dans le flux fourni par le serveur :</span><span class="sxs-lookup"><span data-stu-id="c8f74-114">Some potential uses of the extra data in the stream supplied by the server are as follows:</span></span>

-   <span data-ttu-id="c8f74-115">Données statiques du serveur.</span><span class="sxs-lookup"><span data-stu-id="c8f74-115">Static data from server.</span></span> <span data-ttu-id="c8f74-116">Quelle que soit l’interface particulière en cours de marshaling, le serveur écrit les mêmes données dans le flux.</span><span class="sxs-lookup"><span data-stu-id="c8f74-116">Regardless of the particular interface being marshaled, the server writes the same data into the stream.</span></span>
-   <span data-ttu-id="c8f74-117">Données par interface à partir du serveur.</span><span class="sxs-lookup"><span data-stu-id="c8f74-117">Per-interface data from server.</span></span> <span data-ttu-id="c8f74-118">En fonction de l’interface particulière en cours de marshaling, le serveur peut écrire des données différentes dans le flux.</span><span class="sxs-lookup"><span data-stu-id="c8f74-118">Depending on which particular interface is being marshaled, the server may write different data into the stream.</span></span>
-   <span data-ttu-id="c8f74-119">Assistances par interface.</span><span class="sxs-lookup"><span data-stu-id="c8f74-119">Per-interface helpers.</span></span> <span data-ttu-id="c8f74-120">Les composants COM par interface sont agrégés dans le gestionnaire client et délèguent au proxy standard.</span><span class="sxs-lookup"><span data-stu-id="c8f74-120">Per-interface COM components aggregated into the client handler and delegating to the standard proxy.</span></span> <span data-ttu-id="c8f74-121">Par exemple, pour améliorer les performances du réseau, un composant COM pour [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) peut effectuer la mise en cache côté client des données, la lecture anticipée, l’écriture-behind, le verrouillage de l’opération, etc.</span><span class="sxs-lookup"><span data-stu-id="c8f74-121">For example, to improve network performance, a COM component for [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) could do client-side caching of data, read-ahead, write-behind, op-locking, and so forth.</span></span>
-   <span data-ttu-id="c8f74-122">Version réseau d’une interface.</span><span class="sxs-lookup"><span data-stu-id="c8f74-122">Network version of an interface.</span></span> <span data-ttu-id="c8f74-123">La version réseau de l’interface est différente de l’interface exposée par le client et le code d’application serveur.</span><span class="sxs-lookup"><span data-stu-id="c8f74-123">The network version of the interface is different from the interface exposed by the client and server application code.</span></span> <span data-ttu-id="c8f74-124">Il est possible, par exemple, de multiplexer les interfaces exposées IA et IB sur la même interface réseau INetAB, comme le fait le gestionnaire de serveur d’incorporation.</span><span class="sxs-lookup"><span data-stu-id="c8f74-124">It is possible, for example, to multiplex exposed interfaces IA and IB over the same network interface INetAB, the way the embedding server handler does.</span></span> <span data-ttu-id="c8f74-125">Par exemple, il est possible de convertir une interface de transfert de données en une interface réseau qui utilise des canaux pour un transfert de données efficace.</span><span class="sxs-lookup"><span data-stu-id="c8f74-125">For example, one could convert a data transfer interface into a network interface that uses pipes for efficient data transfer.</span></span>

<span data-ttu-id="c8f74-126">Les clients de niveau inférieure peuvent ne pas avoir la possibilité de démarshaler des interfaces qui ont des gestionnaires personnalisés, pour deux raisons : tout d’abord, ils peuvent ne pas comprendre le CLSID utilisé dans le paquet marshalé personnalisé lorsque le gestionnaire de serveur est agrégé et que l’objet souhaite un gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="c8f74-126">Down-level clients may not have the capability of unmarshaling interfaces that have custom handlers, for two reasons: First, they may not understand the CLSID used in the custom marshaled packet when the server handler is aggregated and the object wants a handler.</span></span> <span data-ttu-id="c8f74-127">Deuxièmement, le code du gestionnaire ne peut même pas s’exécuter côté client s’il requiert de nouvelles fonctionnalités de COM pour créer le marshaleur standard agrégé et pour effectuer des appels [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) distants.</span><span class="sxs-lookup"><span data-stu-id="c8f74-127">Second, the handler code may not even run on the client side if it requires new functionality from COM to create the aggregated standard marshaler and to do remote [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) calls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c8f74-128">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c8f74-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c8f74-129">Le gestionnaire OLE</span><span class="sxs-lookup"><span data-stu-id="c8f74-129">The OLE Handler</span></span>](the-ole-handler.md)
</dt> </dl>

 

 