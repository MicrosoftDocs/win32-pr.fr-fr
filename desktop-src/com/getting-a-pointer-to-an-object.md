---
title: Obtention d’un pointeur vers un objet
description: Obtention d’un pointeur vers un objet
ms.assetid: 4af9d356-402b-4e69-9f6e-8589057d3ac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0476d36390e7077e7fdd75eef8d95e8173683891
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2020
ms.locfileid: "106517997"
---
# <a name="getting-a-pointer-to-an-object"></a><span data-ttu-id="85cb6-103">Obtention d’un pointeur vers un objet</span><span class="sxs-lookup"><span data-stu-id="85cb6-103">Getting a Pointer to an Object</span></span>

<span data-ttu-id="85cb6-104">Comme COM n’a pas de modèle de classe strict, il existe quatre façons pour un client d’instancier ou d’obtenir un pointeur vers une interface sur un objet :</span><span class="sxs-lookup"><span data-stu-id="85cb6-104">Because COM does not have a strict class model, there are four ways that a client can instantiate or get a pointer to an interface on an object:</span></span>

-   <span data-ttu-id="85cb6-105">Appeler une fonction de bibliothèque COM qui crée un objet d’un type prédéterminé ; autrement dit, la fonction retourne un pointeur vers une seule interface spécifique pour une classe d’objet spécifique.</span><span class="sxs-lookup"><span data-stu-id="85cb6-105">Call a COM library function that creates an object of a predetermined type; that is, the function will return a pointer to only one specific interface for a specific object class.</span></span>
-   <span data-ttu-id="85cb6-106">Appelez une fonction de bibliothèque COM qui peut créer un objet basé sur un identificateur de classe (CLSID) et qui retourne tout type de pointeur d’interface demandé.</span><span class="sxs-lookup"><span data-stu-id="85cb6-106">Call a COM library function that can create an object based on a class identifier (CLSID) and that returns any type of interface pointer requested.</span></span>
-   <span data-ttu-id="85cb6-107">Appelez une méthode d’une interface qui crée un autre objet (ou se connecte à une méthode existante) et retourne un pointeur d’interface sur cet objet distinct.</span><span class="sxs-lookup"><span data-stu-id="85cb6-107">Call a method of some interface that creates another object (or connects to an existing one) and returns an interface pointer on that separate object.</span></span>
-   <span data-ttu-id="85cb6-108">Implémentez un objet avec une interface par le biais de laquelle les autres objets transmettent directement leur pointeur d’interface au client.</span><span class="sxs-lookup"><span data-stu-id="85cb6-108">Implement an object with an interface through which other objects pass their interface pointer to the client directly.</span></span>

<span data-ttu-id="85cb6-109">Pour plus d’informations sur l’obtention de pointeurs vers d’autres interfaces sur un objet après le premier, consultez [QueryInterface : navigation dans un objet](queryinterface--navigating-in-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="85cb6-109">For information on getting pointers to other interfaces on an object after you have the first one, see [QueryInterface: Navigating in an Object](queryinterface--navigating-in-an-object.md).</span></span>

## <a name="creating-an-object-of-a-predetermined-type"></a><span data-ttu-id="85cb6-110">Création d’un objet d’un type prédéterminé</span><span class="sxs-lookup"><span data-stu-id="85cb6-110">Creating an Object of a Predetermined Type</span></span>

<span data-ttu-id="85cb6-111">Il existe de nombreuses fonctions COM, telles que [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), qui retournent des pointeurs vers des implémentations d’interface spécifiques.</span><span class="sxs-lookup"><span data-stu-id="85cb6-111">There are numerous COM functions, such as [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), that return pointers to specific interface implementations.</span></span> <span data-ttu-id="85cb6-112">(**CoGetMalloc** récupère un pointeur vers l’allocateur de mémoire com standard.) La plupart d’entre elles sont des fonctions d’assistance, et la plupart de ces fonctions sont décrites dans les sections de référence de cette documentation, sous la zone spécifique à laquelle elles sont associées, telles que le stockage ou le transfert de données.</span><span class="sxs-lookup"><span data-stu-id="85cb6-112">(**CoGetMalloc** retrieves a pointer to the standard COM memory allocator.) Most of these are helper functions, and most of these functions are described in the reference sections of this documentation, under the specific area they are related to, such as storage or data transfer.</span></span>

## <a name="creating-an-object-based-on-a-clsid"></a><span data-ttu-id="85cb6-113">Création d’un objet basé sur un CLSID</span><span class="sxs-lookup"><span data-stu-id="85cb6-113">Creating an Object Based on a CLSID</span></span>

<span data-ttu-id="85cb6-114">Il existe plusieurs fonctions qui, étant donné un CLSID, un client peut appeler pour créer une instance d’objet et obtenir un pointeur vers celle-ci.</span><span class="sxs-lookup"><span data-stu-id="85cb6-114">There are several functions that, given a CLSID, a client can call to create an object instance and get a pointer to it.</span></span> <span data-ttu-id="85cb6-115">Toutes ces fonctions sont basées sur la fonction [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), qui crée un objet de classe et fournit un pointeur vers une interface qui vous permet de créer des instances de cette classe.</span><span class="sxs-lookup"><span data-stu-id="85cb6-115">All of these functions are based on the function [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which creates a class object and supplies a pointer to an interface that allows you to create instances of that class.</span></span> <span data-ttu-id="85cb6-116">Alors qu’il doit y avoir des informations qui indiquent sur quel système se trouve le serveur, il n’est pas nécessaire que ces informations soient contenues dans le client.</span><span class="sxs-lookup"><span data-stu-id="85cb6-116">While there must be information that says which system the server resides on, there is no need for that information to be contained in the client.</span></span> <span data-ttu-id="85cb6-117">Le client doit connaître uniquement le CLSID et jamais le chemin absolu du code du serveur.</span><span class="sxs-lookup"><span data-stu-id="85cb6-117">The client needs to know only the CLSID and never the absolute path of the server code.</span></span> <span data-ttu-id="85cb6-118">Pour plus d’informations, consultez [création d’un objet à l’aide d’un objet de classe](creating-an-object-through-a-class-object.md).</span><span class="sxs-lookup"><span data-stu-id="85cb6-118">For more information, see [Creating an Object Through a Class Object](creating-an-object-through-a-class-object.md).</span></span>

## <a name="returning-a-pointer-to-a-separate-object"></a><span data-ttu-id="85cb6-119">Retour d’un pointeur vers un objet distinct</span><span class="sxs-lookup"><span data-stu-id="85cb6-119">Returning a Pointer to a Separate Object</span></span>

<span data-ttu-id="85cb6-120">Parmi les nombreuses méthodes d’interface qui retournent un pointeur vers un objet distinct, citons plusieurs méthodes qui créent et retournent un pointeur vers un *objet énumérateur*, ce qui vous permet de déterminer le nombre d’éléments d’un type donné géré par un objet.</span><span class="sxs-lookup"><span data-stu-id="85cb6-120">Among the many interface methods that return a pointer to a separate object are several that create and return a pointer to an *enumerator object*, which allows you to determine how many items of a given type an object maintains.</span></span> <span data-ttu-id="85cb6-121">COM définit des interfaces pour énumérer un large éventail d’éléments, tels que des chaînes, des structures importantes, des monikers et des pointeurs d’interface [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="85cb6-121">COM defines interfaces for enumerating a wide variety of items, such as strings, important structures, monikers, and [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface pointers.</span></span> <span data-ttu-id="85cb6-122">Le moyen classique de créer une instance d’énumérateur et d’obtenir un pointeur vers son interface consiste à appeler une méthode à partir d’une autre interface.</span><span class="sxs-lookup"><span data-stu-id="85cb6-122">The typical way to create an enumerator instance and get a pointer to its interface is to call a method from another interface.</span></span> <span data-ttu-id="85cb6-123">Par exemple, l’interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) définit deux méthodes, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) et [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), qui retournent des pointeurs vers des interfaces sur deux objets d’énumération différents.</span><span class="sxs-lookup"><span data-stu-id="85cb6-123">For example, the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface defines two methods, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) and [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), that return pointers to interfaces on two different enumeration objects.</span></span> <span data-ttu-id="85cb6-124">Il existe de nombreux autres exemples dans COM de méthodes qui retournent des pointeurs vers des objets, tels que l’interface de document composé OLE [**IOleObject :: GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), qui, lorsqu’elle est appelée sur l’objet incorporé ou lié, retourne un pointeur vers l’implémentation de l’objet conteneur de [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite).</span><span class="sxs-lookup"><span data-stu-id="85cb6-124">There are many other examples in COM of methods that return pointers to objects, such as the OLE compound document interface [**IOleObject::GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), which, when called on the embedded or linked object, returns a pointer to the container object's implementation of [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite).</span></span>

## <a name="implementing-an-object-through-which-to-pass-an-interface-pointer-directly-to-the-client"></a><span data-ttu-id="85cb6-125">Implémentation d’un objet par le biais duquel passer un pointeur d’interface directement au client</span><span class="sxs-lookup"><span data-stu-id="85cb6-125">Implementing an Object Through Which to Pass an Interface Pointer Directly to the Client</span></span>

<span data-ttu-id="85cb6-126">Lorsque deux objets, tels qu’un conteneur de documents composés OLE et un serveur, ont besoin d’une communication bidirectionnelle, chacun implémente un objet contenant une méthode d’interface par l’intermédiaire de laquelle il peut passer un pointeur d’interface à l’autre objet.</span><span class="sxs-lookup"><span data-stu-id="85cb6-126">When two objects, such as an OLE compound document container and server, need bidirectional communication, each implements an object containing an interface method through which it can pass an interface pointer to the other object.</span></span> <span data-ttu-id="85cb6-127">L’objet qui implémente, qui est également le client de l’objet créé, peut ensuite appeler la méthode et récupérer le pointeur passé.</span><span class="sxs-lookup"><span data-stu-id="85cb6-127">The implementing object, which is also the client of the created object, can then call the method and get the pointer that was passed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="85cb6-128">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="85cb6-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="85cb6-129">Clients et serveurs COM</span><span class="sxs-lookup"><span data-stu-id="85cb6-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="85cb6-130">Responsabilités du serveur COM</span><span class="sxs-lookup"><span data-stu-id="85cb6-130">COM Server Responsibilities</span></span>](com-server-responsibilities.md)
</dt> </dl>

 

 




