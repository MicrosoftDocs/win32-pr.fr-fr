---
title: Définition de la sécurité Process-Wide avec CoInitializeSecurity
description: La fonction CoInitializeSecurity vous permet de contrôler les scénarios de sécurité complexes en définissant la sécurité d’une application par programmation.
ms.assetid: 20b66868-fb9a-489f-97a2-59a8a825c8d9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 567a6dfaf47dbd278fc248558cd25969c733b24a
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104382983"
---
# <a name="setting-process-wide-security-with-coinitializesecurity"></a><span data-ttu-id="1fa06-103">Définition de la sécurité Process-Wide avec CoInitializeSecurity</span><span class="sxs-lookup"><span data-stu-id="1fa06-103">Setting Process-Wide Security with CoInitializeSecurity</span></span>

<span data-ttu-id="1fa06-104">La fonction [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) vous permet de contrôler les scénarios de sécurité complexes en définissant la sécurité d’une application par programmation.</span><span class="sxs-lookup"><span data-stu-id="1fa06-104">The [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) function allows you to control complex security scenarios by setting security for an application programmatically.</span></span> <span data-ttu-id="1fa06-105">Cette rubrique décrit les scénarios dans lesquels vous pouvez utiliser **CoInitializeSecurity** et fournit des détails sur la façon dont vous l’utilisez.</span><span class="sxs-lookup"><span data-stu-id="1fa06-105">This topic describes scenarios when you might use **CoInitializeSecurity** and provides some details on how you use it.</span></span>

<span data-ttu-id="1fa06-106">Il existe plusieurs raisons pour lesquelles vous pouvez souhaiter utiliser [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) pour définir la sécurité au niveau du processus dans votre programme.</span><span class="sxs-lookup"><span data-stu-id="1fa06-106">There are several reasons why you might want to use [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set process-wide security within your program.</span></span> <span data-ttu-id="1fa06-107">Par exemple, bien que vous puissiez définir le niveau d’authentification et les autorisations d’accès de l’application à l’aide de dcomcnfg.exe, le niveau d’emprunt d’identité par défaut de l’ordinateur n’est peut-être pas celui que vous souhaitez pour votre processus.</span><span class="sxs-lookup"><span data-stu-id="1fa06-107">For example, although you can set the authentication level and the access permissions for the application using dcomcnfg.exe, the default impersonation level for the computer might not be the one you want for your process.</span></span> <span data-ttu-id="1fa06-108">La seule façon de modifier ce paramètre pour votre processus consiste à appeler **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="1fa06-108">The only way to change this setting for your process is to call **CoInitializeSecurity**.</span></span>

<span data-ttu-id="1fa06-109">Si vous souhaitez utiliser le fournisseur de sécurité Schannel, vous devez le spécifier en tant que service d’authentification dans un appel à [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity).</span><span class="sxs-lookup"><span data-stu-id="1fa06-109">If you want to use the Schannel security provider, you must specify it as an authentication service in a call to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity).</span></span>

<span data-ttu-id="1fa06-110">Un autre scénario courant dans lequel vous pouvez définir la sécurité au niveau du processus par programmation est lorsque vous souhaitez définir la sécurité par défaut pour l’ensemble du processus, mais que vous avez un ou plusieurs objets au sein de ce processus qui exposent des interfaces avec des exigences de sécurité spéciales.</span><span class="sxs-lookup"><span data-stu-id="1fa06-110">Another common scenario in which you might set process-wide security programmatically is when you would like to set default security for the entire process but you have one or more objects within that process that expose interfaces with special security requirements.</span></span> <span data-ttu-id="1fa06-111">Dans ce cas, vous pouvez appeler [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) pour définir la sécurité du processus, ce qui permet à com de gérer la plupart des vérifications de sécurité, et vous pouvez appeler d’autres méthodes pour définir la sécurité pour les objets avec des besoins de sécurité spéciaux.</span><span class="sxs-lookup"><span data-stu-id="1fa06-111">In this case, you can call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set security for the process, allowing COM to handle most of the security checks, and you can call other methods to set security for the objects with special security needs.</span></span> <span data-ttu-id="1fa06-112">L’appel de ces méthodes et fonctions est décrit dans [définition de la sécurité au niveau du proxy de l’interface](setting-security-at-the-interface-proxy-level.md).</span><span class="sxs-lookup"><span data-stu-id="1fa06-112">Calling these methods and functions is described in [Setting Security at the Interface Proxy Level](setting-security-at-the-interface-proxy-level.md).</span></span>

<span data-ttu-id="1fa06-113">Si votre application a des exigences de sécurité très spécialisées, comme autoriser certains groupes à accéder à différents objets en fonction de l’heure de la journée, vous souhaiterez peut-être gérer l’ensemble de votre sécurité par programme, en veillant à ce que COM n’effectue aucune vérification automatique.</span><span class="sxs-lookup"><span data-stu-id="1fa06-113">If your application has very specialized security requirements, such as allowing certain groups access to different objects depending on the time of day, you might want to handle all of your security programmatically, ensuring that COM does no automatic checking for you at all.</span></span> <span data-ttu-id="1fa06-114">Pour ce faire, vous devez appeler [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity), en affectant la valeur None au paramètre *DwAuthnLevel* et la **valeur null** au paramètre *pVoid* .</span><span class="sxs-lookup"><span data-stu-id="1fa06-114">To do this, you must call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity), setting the *dwAuthnLevel* parameter to none and the *pVoid* parameter to **NULL**.</span></span> <span data-ttu-id="1fa06-115">Si vous disposez de votre propre package de sécurité, vous devez également l’inscrire dans le paramètre *pAuthnSvc* .</span><span class="sxs-lookup"><span data-stu-id="1fa06-115">If you have your own security package you would also need to register it in the *pAuthnSvc* parameter.</span></span> <span data-ttu-id="1fa06-116">Vous pouvez ensuite gérer l’ensemble de votre propre sécurité par programme par le biais d’appels à l’interface de niveau proxy et les fonctions décrites dans [définition de la sécurité au niveau du proxy de l’interface](setting-security-at-the-interface-proxy-level.md).</span><span class="sxs-lookup"><span data-stu-id="1fa06-116">Then you can handle all of your own security programmatically through calls to the proxy-level interface and functions described in [Setting Security at the Interface Proxy Level](setting-security-at-the-interface-proxy-level.md).</span></span>

<span data-ttu-id="1fa06-117">[**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) offre un ensemble complet de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="1fa06-117">[**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) offers a rich set of capabilities.</span></span> <span data-ttu-id="1fa06-118">Si vous appelez **CoInitializeSecurity**, les valeurs de Registre sont ignorées et les valeurs d’initialisation de sécurité que vous transmettez à l’appel sont utilisées à la place.</span><span class="sxs-lookup"><span data-stu-id="1fa06-118">If you call **CoInitializeSecurity**, the registry values are ignored and the security initialization values you pass in to the call are used instead.</span></span> <span data-ttu-id="1fa06-119">Selon le résultat souhaité, le premier paramètre, *pVoid*, peut pointer vers trois types de valeurs différents : un [**\_ descripteur de sécurité**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , un objet [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) ou un pointeur vers une AppID.</span><span class="sxs-lookup"><span data-stu-id="1fa06-119">Depending on the result you want, the first parameter, *pVoid*, can point to three different types of values: a [**SECURITY\_DESCRIPTOR**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object, or a pointer to an AppID.</span></span> <span data-ttu-id="1fa06-120">Dans la plupart des cas, vous allez utiliser des fonctions Windows pour créer un **\_ descripteur de sécurité** auquel *pVoid* pointera.</span><span class="sxs-lookup"><span data-stu-id="1fa06-120">In most cases, you will use Windows functions to create a **SECURITY\_DESCRIPTOR** that *pVoid* will point to.</span></span>

<span data-ttu-id="1fa06-121">Toutefois, *pVoid* peut également pointer vers un objet [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) .</span><span class="sxs-lookup"><span data-stu-id="1fa06-121">However, *pVoid* can also point to an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object.</span></span>

<span data-ttu-id="1fa06-122">Pour indiquer à [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) que vous passez un objet [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) à *pVoid*, vous devez passer la \_ \_ valeur de contrôle d’accès EOAC au paramètre *dwCapabilities* .</span><span class="sxs-lookup"><span data-stu-id="1fa06-122">To indicate to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) that you are passing an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object to *pVoid*, you must pass the EOAC\_ACCESS\_CONTROL value to the *dwCapabilities* parameter.</span></span> <span data-ttu-id="1fa06-123">Dans la mesure où **CoInitializeSecurity** met en cache les résultats des vérifications d’accès, la liste de contrôle d’accès ne doit pas être modifiée après l’appel de **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="1fa06-123">Since **CoInitializeSecurity** caches the results of access checks, the access control list must not be changed after calling **CoInitializeSecurity**.</span></span>

<span data-ttu-id="1fa06-124">Un autre type de valeur que vous pouvez passer au paramètre *pVoid* est un pointeur vers un GUID, qui est l’AppID de votre application.</span><span class="sxs-lookup"><span data-stu-id="1fa06-124">Another type of value you can pass to the *pVoid* parameter is a pointer to a GUID, which is the AppID of your application.</span></span> <span data-ttu-id="1fa06-125">Si *pVoid* est un pointeur vers une AppID, vous devez spécifier EOAC \_ AppID dans le paramètre *pCapabilities* afin que la fonction sache quelle valeur attendre dans *pVoid*.</span><span class="sxs-lookup"><span data-stu-id="1fa06-125">If *pVoid* is a pointer to an AppID, you must specify EOAC\_APPID in the *pCapabilities* parameter so that the function knows what value to expect in *pVoid*.</span></span> <span data-ttu-id="1fa06-126">Si *pVoid* pointe vers une AppID, [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) utilise uniquement le registre pour les valeurs d’authentification et ignore tous les autres paramètres de **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="1fa06-126">If *pVoid* points to an AppID, [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) uses only the registry for authentication values and ignores all other parameters to **CoInitializeSecurity**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1fa06-127">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1fa06-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1fa06-128">Définition de la sécurité Process-Wide</span><span class="sxs-lookup"><span data-stu-id="1fa06-128">Setting Process-Wide Security</span></span>](setting-processwide-security.md)
</dt> </dl>

 

 