---
title: Communication Inter-Object
description: COM est conçu pour permettre aux clients de communiquer de manière transparente avec des objets, quel que soit l’emplacement d’exécution de ces objets dans le même processus, sur le même ordinateur ou sur un autre ordinateur.
ms.assetid: dd4adafb-a7e4-44ba-ae4a-80585875ecb6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9356ba2bcb9dd3a6a56ac16c354f3abcb752d717
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104102385"
---
# <a name="inter-object-communication"></a><span data-ttu-id="03de8-103">Communication Inter-Object</span><span class="sxs-lookup"><span data-stu-id="03de8-103">Inter-Object Communication</span></span>

<span data-ttu-id="03de8-104">COM est conçu pour permettre aux clients de communiquer de manière transparente avec des objets, quel que soit l’emplacement où ces objets sont runningâs, dans le même processus, sur le même ordinateur ou sur un autre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="03de8-104">COM is designed to allow clients to communicate transparently with objects, regardless of where those objects are runningâ€”in the same process, on the same computer, or on a different computer.</span></span> <span data-ttu-id="03de8-105">Cela fournit un modèle de programmation unique pour tous les types d’objets, et pour les clients d’objets et les serveurs d’objets.</span><span class="sxs-lookup"><span data-stu-id="03de8-105">This provides a single programming model for all types of objects, and for both object clients and object servers.</span></span>

<span data-ttu-id="03de8-106">Du point de vue du client, tous les objets sont accessibles par le biais de pointeurs d’interface.</span><span class="sxs-lookup"><span data-stu-id="03de8-106">From a client's point of view, all objects are accessed through interface pointers.</span></span> <span data-ttu-id="03de8-107">Un pointeur doit être in-process.</span><span class="sxs-lookup"><span data-stu-id="03de8-107">A pointer must be in-process.</span></span> <span data-ttu-id="03de8-108">En fait, tout appel à une fonction d’interface atteint toujours un morceau de code in-process.</span><span class="sxs-lookup"><span data-stu-id="03de8-108">In fact, any call to an interface function always reaches some piece of in-process code first.</span></span> <span data-ttu-id="03de8-109">Si l’objet est in-process, l’appel l’atteint directement, sans code d’infrastructure système intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="03de8-109">If the object is in-process, the call reaches it directly, with no intervening system-infrastructure code.</span></span> <span data-ttu-id="03de8-110">Si l’objet est hors processus, l’appel commence par atteindre ce qui est appelé un objet « proxy » fourni par COM ou par l’objet (si le responsable de l’implémentation le souhaite).</span><span class="sxs-lookup"><span data-stu-id="03de8-110">If the object is out-of-process, the call first reaches what is called a "proxy" object provided either by COM or by the object (if the implementor wishes).</span></span> <span data-ttu-id="03de8-111">Les packages de proxy appellent des paramètres (y compris tous les pointeurs d’interface) et génèrent l’appel de procédure distante approprié (ou tout autre mécanisme de communication dans le cas de proxies générés personnalisés) à l’autre processus ou à l’autre ordinateur sur lequel se trouve l’implémentation de l’objet.</span><span class="sxs-lookup"><span data-stu-id="03de8-111">The proxy packages call parameters (including any interface pointers) and generate the appropriate remote procedure call (or other communication mechanism in the case of custom generated proxies) to the other process or the other computer where the object implementation is located.</span></span> <span data-ttu-id="03de8-112">Ce processus d’empaquetage de pointeurs pour la transmission à travers les limites de processus est appelé *marshaling*.</span><span class="sxs-lookup"><span data-stu-id="03de8-112">This process of packaging pointers for transmission across process boundaries is called *marshaling*.</span></span>

<span data-ttu-id="03de8-113">Du point de vue d’un serveur, tous les appels aux fonctions d’interface d’un objet sont effectués à l’aide d’un pointeur vers cette interface.</span><span class="sxs-lookup"><span data-stu-id="03de8-113">From a server's point of view, all calls to an object's interface functions are made through a pointer to that interface.</span></span> <span data-ttu-id="03de8-114">Là encore, un pointeur a un contexte uniquement dans un processus unique, et l’appelant doit toujours être un morceau de code in-process.</span><span class="sxs-lookup"><span data-stu-id="03de8-114">Again, a pointer has context only in a single process, and the caller must always be some piece of in-process code.</span></span> <span data-ttu-id="03de8-115">Si l’objet est in-process, l’appelant est le client lui-même.</span><span class="sxs-lookup"><span data-stu-id="03de8-115">If the object is in-process, the caller is the client itself.</span></span> <span data-ttu-id="03de8-116">Dans le cas contraire, l’appelant est un objet « stub » fourni par COM ou par l’objet lui-même.</span><span class="sxs-lookup"><span data-stu-id="03de8-116">Otherwise, the caller is a "stub" object provided either by COM or by the object itself.</span></span> <span data-ttu-id="03de8-117">Le stub reçoit l’appel de procédure distante (ou un autre mécanisme de communication dans le cas de proxys générés personnalisés) du « proxy » dans le processus client, démarshale les paramètres et appelle l’interface appropriée sur l’objet serveur.</span><span class="sxs-lookup"><span data-stu-id="03de8-117">The stub receives the remote procedure call (or other communication mechanism in the case of custom generated proxies) from the "proxy" in the client process, unmarshals the parameters, and calls the appropriate interface on the server object.</span></span> <span data-ttu-id="03de8-118">Des points de vue des clients et des serveurs, ils communiquent toujours directement avec un autre code in-process.</span><span class="sxs-lookup"><span data-stu-id="03de8-118">From the points of view of both clients and servers, they always communicate directly with some other in-process code.</span></span>

<span data-ttu-id="03de8-119">COM fournit une implémentation du marshaling, appelée *marshaling standard*.</span><span class="sxs-lookup"><span data-stu-id="03de8-119">COM provides an implementation of marshaling, referred to as *standard marshaling*.</span></span> <span data-ttu-id="03de8-120">Cette implémentation fonctionne très bien pour la plupart des objets et réduit considérablement les exigences de programmation, ce qui rend le processus de marshaling effectivement transparent.</span><span class="sxs-lookup"><span data-stu-id="03de8-120">This implementation works very well for most objects and greatly reduces programming requirements, making the marshaling process effectively transparent.</span></span>

<span data-ttu-id="03de8-121">La séparation claire de l’interface par rapport à l’implémentation de la transparence des processus de COM peut toutefois se faire dans certains cas.</span><span class="sxs-lookup"><span data-stu-id="03de8-121">The clear separation of interface from implementation of COM's process transparency can, however, get in the way in some situations.</span></span> <span data-ttu-id="03de8-122">La conception d’une interface qui se concentre sur sa fonction du point de vue du client peut parfois mener à des décisions de conception qui sont en conflit avec une implémentation efficace de cette interface sur un réseau.</span><span class="sxs-lookup"><span data-stu-id="03de8-122">The design of an interface that focuses on its function from the client's point of view can sometimes lead to design decisions that conflict with efficient implementation of that interface across a network.</span></span> <span data-ttu-id="03de8-123">Dans ce type de situation, ce qui est nécessaire n’est pas une transparence de processus pure, mais la transparence de processus, sauf si vous avez besoin de vous en soucier.</span><span class="sxs-lookup"><span data-stu-id="03de8-123">In cases like this, what is needed is not pure process transparency but "process transparency, unless you need to care."</span></span> <span data-ttu-id="03de8-124">COM offre cette fonctionnalité en permettant à un implémenteur d’objet de prendre en charge le *marshaling personnalisé* (également appelé « marshaling de [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) »).</span><span class="sxs-lookup"><span data-stu-id="03de8-124">COM provides this capability by allowing an object implementor to support *custom marshaling* (also called [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) marshaling).</span></span> <span data-ttu-id="03de8-125">Le marshaling standard est, en fait, une instance de marshaling personnalisé ; Il s’agit de l’implémentation par défaut utilisée lorsqu’un objet ne requiert pas de marshaling personnalisé.</span><span class="sxs-lookup"><span data-stu-id="03de8-125">Standard marshaling is, in fact, an instance of custom marshaling; it is the default implementation used when an object does not require custom marshaling.</span></span>

<span data-ttu-id="03de8-126">Vous pouvez implémenter un marshaling personnalisé pour permettre à un objet d’effectuer des actions différentes lorsqu’il est utilisé à partir d’un réseau plutôt qu’à un accès local et qu’il est totalement transparent pour le client.</span><span class="sxs-lookup"><span data-stu-id="03de8-126">You can implement custom marshaling to allow an object to take different actions when used from across a network than it takes under local access and it is completely transparent to the client.</span></span> <span data-ttu-id="03de8-127">Cette architecture permet de concevoir des interfaces client/objet sans tenir compte des problèmes de performances du réseau, puis de résoudre les problèmes de performances du réseau sans interrompre la conception établie.</span><span class="sxs-lookup"><span data-stu-id="03de8-127">This architecture makes it possible to design client/object interfaces without regard to network performance issues and then later to address network performance issues without disrupting the established design.</span></span>

<span data-ttu-id="03de8-128">COM ne spécifie pas la manière dont les composants sont structurés ; Il spécifie la manière dont ils interagissent.</span><span class="sxs-lookup"><span data-stu-id="03de8-128">COM does not specify how components are structured; it specifies how they interact.</span></span> <span data-ttu-id="03de8-129">COM laisse la préoccupation quant à la structure interne d’un composant aux langages de programmation et aux environnements de développement.</span><span class="sxs-lookup"><span data-stu-id="03de8-129">COM leaves the concern about the internal structure of a component to programming languages and development environments.</span></span> <span data-ttu-id="03de8-130">À l’inverse, les environnements de programmation n’ont pas de normes définies pour travailler avec des objets en dehors de l’application immédiate.</span><span class="sxs-lookup"><span data-stu-id="03de8-130">Conversely, programming environments have no set standards for working with objects outside of the immediate application.</span></span> <span data-ttu-id="03de8-131">Microsoft Visual C++, par exemple, fonctionne très bien pour manipuler des objets dans une application, mais ne prend pas en charge l’utilisation d’objets en dehors de l’application.</span><span class="sxs-lookup"><span data-stu-id="03de8-131">Microsoft Visual C++, for example, works extremely well for manipulating objects inside an application but has no support for working with objects outside the application.</span></span> <span data-ttu-id="03de8-132">En règle générale, tous les autres langages de programmation sont les mêmes à cet égard.</span><span class="sxs-lookup"><span data-stu-id="03de8-132">Generally, all other programming languages are the same in this regard.</span></span> <span data-ttu-id="03de8-133">Par conséquent, pour assurer l’interopérabilité des Readiness, COM, via des interfaces indépendantes du langage, reprend là où les langages de programmation restent inactifs.</span><span class="sxs-lookup"><span data-stu-id="03de8-133">Therefore, to provide networkwide interoperability, COM, through language-independent interfaces, picks up where programming languages leave off.</span></span>

<span data-ttu-id="03de8-134">La double indirection de la structure VTBL signifie que les pointeurs dans la table des pointeurs de fonction n’ont pas besoin de pointer directement vers l’implémentation réelle de l’objet réel.</span><span class="sxs-lookup"><span data-stu-id="03de8-134">The double indirection of the vtbl structure means that the pointers in the table of function pointers do not need to point directly to the real implementation in the real object.</span></span> <span data-ttu-id="03de8-135">C’est le cœur de la transparence du processus.</span><span class="sxs-lookup"><span data-stu-id="03de8-135">This is the heart of process transparency.</span></span>

<span data-ttu-id="03de8-136">Pour les serveurs in-process, où l’objet est chargé directement dans le processus client, les pointeurs de fonction dans la table pointent directement vers l’implémentation réelle.</span><span class="sxs-lookup"><span data-stu-id="03de8-136">For in-process servers, where the object is loaded directly into the client process, the function pointers in the table point directly to the actual implementation.</span></span> <span data-ttu-id="03de8-137">Dans ce cas, un appel de fonction du client à une méthode d’interface transfère directement le contrôle d’exécution à la méthode.</span><span class="sxs-lookup"><span data-stu-id="03de8-137">In this case, a function call from the client to an interface method directly transfers execution control to the method.</span></span> <span data-ttu-id="03de8-138">Toutefois, cette opération ne peut pas être utilisée pour les objets locaux et distants autonomes, car les pointeurs vers la mémoire ne peuvent pas être partagés entre les processus.</span><span class="sxs-lookup"><span data-stu-id="03de8-138">However, this cannot work for local, let alone remote, objects because pointers to memory cannot be shared between processes.</span></span> <span data-ttu-id="03de8-139">Néanmoins, le client doit être en mesure d’appeler les méthodes d’interface comme s’il appelait l’implémentation réelle.</span><span class="sxs-lookup"><span data-stu-id="03de8-139">Nevertheless, the client must be able to call interface methods as if it were calling the actual implementation.</span></span> <span data-ttu-id="03de8-140">Ainsi, le client transfère uniformément le contrôle à une méthode dans un objet en effectuant l’appel.</span><span class="sxs-lookup"><span data-stu-id="03de8-140">Thus, the client uniformly transfers control to a method in some object by making the call.</span></span>

<span data-ttu-id="03de8-141">Un client appelle toujours des méthodes d’interface dans un objet in-process.</span><span class="sxs-lookup"><span data-stu-id="03de8-141">A client always calls interface methods in some in-process object.</span></span> <span data-ttu-id="03de8-142">Si l’objet réel est local ou distant, l’appel est effectué à un objet proxy, qui effectue ensuite un appel de procédure distante vers l’objet réel.</span><span class="sxs-lookup"><span data-stu-id="03de8-142">If the actual object is local or remote, the call is made to a proxy object, which then makes a remote procedure call to the actual object.</span></span>

<span data-ttu-id="03de8-143">Quelle est la méthode réellement exécutée ?</span><span class="sxs-lookup"><span data-stu-id="03de8-143">So what method is actually executed?</span></span> <span data-ttu-id="03de8-144">La réponse est qu’à chaque appel à une interface hors processus, chaque méthode d’interface est implémentée par un objet proxy.</span><span class="sxs-lookup"><span data-stu-id="03de8-144">The answer is that whenever there is a call to an out-of-process interface, each interface method is implemented by a proxy object.</span></span> <span data-ttu-id="03de8-145">L’objet proxy est toujours un objet in-process qui agit au nom de l’objet qui est appelé.</span><span class="sxs-lookup"><span data-stu-id="03de8-145">The proxy object is always an in-process object that acts on behalf of the object being called.</span></span> <span data-ttu-id="03de8-146">Cet objet proxy sait que l’objet réel s’exécute sur un serveur local ou distant.</span><span class="sxs-lookup"><span data-stu-id="03de8-146">This proxy object knows that the actual object is running in a local or remote server.</span></span>

<span data-ttu-id="03de8-147">L’objet proxy conditionne les paramètres de fonction dans certains paquets de données et génère un appel RPC à l’objet local ou distant.</span><span class="sxs-lookup"><span data-stu-id="03de8-147">The proxy object packages up the function parameters in some data packets and generates an RPC call to the local or remote object.</span></span> <span data-ttu-id="03de8-148">Ce paquet est récupéré par un objet stub dans le processus du serveur sur l’ordinateur local ou distant, qui décompresse les paramètres et effectue l’appel à l’implémentation réelle de la méthode.</span><span class="sxs-lookup"><span data-stu-id="03de8-148">That packet is picked up by a stub object in the server's process on the local or a remote computer, which unpacks the parameters and makes the call to the real implementation of the method.</span></span> <span data-ttu-id="03de8-149">Lorsque cette fonction retourne, le stub regroupe tous les paramètres de sortie et la valeur de retour, puis les renvoie au proxy, qui les décompresse et les retourne au client d’origine.</span><span class="sxs-lookup"><span data-stu-id="03de8-149">When that function returns, the stub packages up any out-parameters and the return value and sends it back to the proxy, which unpacks them and returns them to the original client.</span></span>

<span data-ttu-id="03de8-150">Ainsi, le client et le serveur communiquent toujours entre eux comme si tout était en cours de traitement.</span><span class="sxs-lookup"><span data-stu-id="03de8-150">Thus, client and server always talk to each other as if everything was in-process.</span></span> <span data-ttu-id="03de8-151">Tous les appels du client et tous les appels au serveur sont, à un moment donné, dans le processus.</span><span class="sxs-lookup"><span data-stu-id="03de8-151">All calls from the client and all calls to the server are, at some point, in-process.</span></span> <span data-ttu-id="03de8-152">Toutefois, étant donné que la structure VTBL permet à un agent, comme COM, d’intercepter tous les appels de fonction et tous les retours des fonctions, cet agent peut rediriger ces appels vers un appel RPC si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="03de8-152">But because the vtbl structure allows some agent, like COM, to intercept all function calls and all returns from functions, that agent can redirect those calls to an RPC call as necessary.</span></span> <span data-ttu-id="03de8-153">Bien que les appels in-process soient plus rapides que les appels out-of-process, les différences de processus sont totalement transparentes au client et au serveur.</span><span class="sxs-lookup"><span data-stu-id="03de8-153">Although in-process calls are faster than out-of-process calls, the process differences are completely transparent to the client and server.</span></span>

<span data-ttu-id="03de8-154">Pour plus d'informations, voir les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="03de8-154">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="03de8-155">Détails du marshaling</span><span class="sxs-lookup"><span data-stu-id="03de8-155">Marshaling Details</span></span>](marshaling-details.md)
-   [<span data-ttu-id="03de8-156">Proxy</span><span class="sxs-lookup"><span data-stu-id="03de8-156">Proxy</span></span>](proxy.md)
-   [<span data-ttu-id="03de8-157">Talon</span><span class="sxs-lookup"><span data-stu-id="03de8-157">Stub</span></span>](stub.md)
-   [<span data-ttu-id="03de8-158">Channel</span><span class="sxs-lookup"><span data-stu-id="03de8-158">Channel</span></span>](channel.md)
-   [<span data-ttu-id="03de8-159">Microsoft RPC</span><span class="sxs-lookup"><span data-stu-id="03de8-159">Microsoft RPC</span></span>](microsoft-rpc.md)

## <a name="related-topics"></a><span data-ttu-id="03de8-160">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="03de8-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="03de8-161">Clients et serveurs COM</span><span class="sxs-lookup"><span data-stu-id="03de8-161">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="03de8-162">Marshaling d’interface</span><span class="sxs-lookup"><span data-stu-id="03de8-162">Interface Marshaling</span></span>](interface-marshaling.md)
</dt> </dl>

 

 