---
title: Interfaces de persistance
description: Interfaces de persistance
ms.assetid: a93582b3-bdbf-430d-b4a6-c0df7bc35dc0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c2e1acbd1074fd5fa4e87e571a1e21ab48d5d075
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/27/2021
ms.locfileid: "110550504"
---
# <a name="persistence-interfaces"></a><span data-ttu-id="19945-103">Interfaces de persistance</span><span class="sxs-lookup"><span data-stu-id="19945-103">Persistence Interfaces</span></span>

<span data-ttu-id="19945-104">Les objets qui ont un état persistant de tout type doivent implémenter au moins une \* interface IPersist et, de préférence, plusieurs interfaces, afin de fournir au conteneur le choix le plus flexible pour enregistrer l’état d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="19945-104">Objects that have a persistent state of any kind must implement at least one IPersist\* interface, and preferably multiple interfaces, in order to provide the container with the most flexible choice of how it wishes to save a control's state.</span></span>

<span data-ttu-id="19945-105">Si un contrôle n’a aucun état persistant, il doit, au minimum, implémenter [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) ou [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) (les deux sont mutuellement exclusifs et ne doivent pas être implémentés ensemble pour la plupart).</span><span class="sxs-lookup"><span data-stu-id="19945-105">If a control has any persistent state whatsoever, it must, as a minimum, implement either [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) or [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) (the two are mutually exclusive and shouldn't be implemented together for the most part).</span></span> <span data-ttu-id="19945-106">Ce dernier est utilisé lorsqu’un contrôle souhaite savoir quand il est créé au lieu d’être rechargé à partir d’un état persistant existant (**IPersistStream** n’a pas la nouvelle fonctionnalité créée).</span><span class="sxs-lookup"><span data-stu-id="19945-106">The latter is used when a control wishes to know when it is created new as opposed to reloaded from an existing persistent state (**IPersistStream** does not have the created new capability).</span></span> <span data-ttu-id="19945-107">L’existence de l’une ou l’autre des interfaces indique que le contrôle peut enregistrer et charger son état persistant dans un flux, autrement dit, une instance de [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span><span class="sxs-lookup"><span data-stu-id="19945-107">The existence of either interface indicates that the control can save and load its persistent state into a stream, that is, an instance of [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span>

<span data-ttu-id="19945-108">Au-delà de ces deux interfaces basées sur le flux, les \* interfaces IPersist listées dans le tableau suivant peuvent éventuellement être fournies afin de prendre en charge la persistance dans des emplacements autres qu’un [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream)extensible.</span><span class="sxs-lookup"><span data-stu-id="19945-108">Beyond these two stream-based interfaces, the IPersist\* interfaces listed in the following table can be optionally provided in order to support persistence to locations other than an expandable [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span>

<span data-ttu-id="19945-109">Un ensemble de catégories de composants est identifié pour couvrir la prise en charge des interfaces persistances, consultez [catégories de composants](component-categories.md).</span><span class="sxs-lookup"><span data-stu-id="19945-109">A set of component categories is identified to cover the support for persistency interfaces see [Component Categories](component-categories.md).</span></span>



| <span data-ttu-id="19945-110">Interface</span><span class="sxs-lookup"><span data-stu-id="19945-110">Interface</span></span>                                                              | <span data-ttu-id="19945-111">Utilisation</span><span class="sxs-lookup"><span data-stu-id="19945-111">Usage</span></span>                                                                                                                                                                                                                                                                                                                                                       |
|------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="19945-112">[**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="19945-112">[**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))</span></span><br/>           | <span data-ttu-id="19945-113">L’objet peut enregistrer et charger son état dans un tableau d’octets séquentiels de longueur fixe (en mémoire).</span><span class="sxs-lookup"><span data-stu-id="19945-113">The object can save and load its state into a fixed-length sequential byte array (in memory).</span></span><br/>                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="19945-114">**IPersistStorage**</span><span class="sxs-lookup"><span data-stu-id="19945-114">**IPersistStorage**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)<br/>                  | <span data-ttu-id="19945-115">L’objet peut enregistrer et charger son état dans une instance [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) .</span><span class="sxs-lookup"><span data-stu-id="19945-115">The object can save and load its state into an [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) instance.</span></span> <span data-ttu-id="19945-116">Les contrôles qui souhaitent être marqués comme pouvant être insérés comme d’autres objets de document composés (pour l’insertion dans des conteneurs ne prenant pas en charge les contrôles) doivent prendre en charge cette interface.</span><span class="sxs-lookup"><span data-stu-id="19945-116">Controls that wish to be marked Insertable as other compound document objects (for insertion into non-control aware containers) must support this interface.</span></span><br/>                                                                                               |
| [<span data-ttu-id="19945-117">**IPersistPropertyBag**</span><span class="sxs-lookup"><span data-stu-id="19945-117">**IPersistPropertyBag**</span></span>](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag)<br/> | <span data-ttu-id="19945-118">L’objet peut enregistrer et charger son état en tant que propriétés individuelles écrites dans IPropertyBag que le conteneur implémente.</span><span class="sxs-lookup"><span data-stu-id="19945-118">The object can save and load its state as individual properties written to IPropertyBag which the container implements.</span></span> <span data-ttu-id="19945-119">Il est utilisé pour la fonctionnalité enregistrer en tant que texte dans certains conteneurs.</span><span class="sxs-lookup"><span data-stu-id="19945-119">This is used for Save As Text functionality in some containers.</span></span><br/>                                                                                                                                                          |
| <span data-ttu-id="19945-120">[**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="19945-120">[**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))</span></span><br/>  | <span data-ttu-id="19945-121">L’objet peut enregistrer et charger son état dans un emplacement nommé par un moniker.</span><span class="sxs-lookup"><span data-stu-id="19945-121">The object can save and load its state to a location named by a moniker.</span></span> <span data-ttu-id="19945-122">Le contrôle appelle [**IMoniker :: BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) pour récupérer l’interface de stockage dont il a besoin, par exemple [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream), [**ILockBytes**](/windows/desktop/api/objidl/nn-objidl-ilockbytes), [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), etc.</span><span class="sxs-lookup"><span data-stu-id="19945-122">The control calls [**IMoniker::BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) to retrieve the storage interface it requires, such as [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream), [**ILockBytes**](/windows/desktop/api/objidl/nn-objidl-ilockbytes), [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), etc.</span></span><br/> |



 

<span data-ttu-id="19945-123">Alors que la prise en charge de [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag) est facultative, il est fortement recommandé d’en faire une optimisation pour les conteneurs avec des fonctionnalités d’enregistrement sous forme de texte, telles que Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="19945-123">While support for [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag) is optional, it is strongly recommended as an optimization for containers with Save As Text features, such as Visual Basic.</span></span>

<span data-ttu-id="19945-124">À l’exception de [**IPersistStream :: GetSizeMax**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststream-getsizemax), [**IPersistStreamInit :: GetSizeMax**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-getsizemax)et [**IPersistMemory :: GetSizeMax**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768208(v=vs.85)), toutes les méthodes de chaque interface doivent être entièrement implémentées.</span><span class="sxs-lookup"><span data-stu-id="19945-124">With the exception of [**IPersistStream::GetSizeMax**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststream-getsizemax), [**IPersistStreamInit::GetSizeMax**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-getsizemax), and [**IPersistMemory::GetSizeMax**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768208(v=vs.85)), all methods of each interface must be fully implemented.</span></span>

## <a name="related-topics"></a><span data-ttu-id="19945-125">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="19945-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="19945-126">Contrôles</span><span class="sxs-lookup"><span data-stu-id="19945-126">Controls</span></span>](controls.md)
</dt> </dl>

 

