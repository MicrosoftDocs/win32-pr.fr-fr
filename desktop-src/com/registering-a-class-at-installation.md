---
title: Inscription d’une classe lors de l’installation
description: Si une classe est destinée à être disponible pour les clients à tout moment, dans la mesure où la plupart des applications sont, vous l’inscrivez généralement par le biais d’un programme d’installation et d’installation.
ms.assetid: 6d78c2ce-56d8-4866-9801-35125ec9cac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4253c40cb3feb7e737368c947c0b20715f5becbd
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104316553"
---
# <a name="registering-a-class-at-installation"></a><span data-ttu-id="81455-103">Inscription d’une classe lors de l’installation</span><span class="sxs-lookup"><span data-stu-id="81455-103">Registering a Class at Installation</span></span>

<span data-ttu-id="81455-104">Si une classe est destinée à être disponible pour les clients à tout moment, dans la mesure où la plupart des applications sont, vous l’inscrivez généralement par le biais d’un programme d’installation et d’installation.</span><span class="sxs-lookup"><span data-stu-id="81455-104">If a class is intended to be available to clients at any time, as most applications are, you usually register it through an installation and setup program.</span></span> <span data-ttu-id="81455-105">Cela implique de placer des informations sur l’application dans le registre, notamment comment et où ses objets doivent être instanciés.</span><span class="sxs-lookup"><span data-stu-id="81455-105">This means putting information about the application into the registry, including how and where its objects are to be instantiated.</span></span> <span data-ttu-id="81455-106">Ces informations doivent être inscrites pour tous les CLSID.</span><span class="sxs-lookup"><span data-stu-id="81455-106">This information must be registered for all CLSIDs.</span></span> <span data-ttu-id="81455-107">D’autres informations sont facultatives.</span><span class="sxs-lookup"><span data-stu-id="81455-107">Other information is optional.</span></span> <span data-ttu-id="81455-108">Les outils tels que regsvr32 facilitent l’écriture d’un programme d’installation qui inscrit des serveurs lors de l’installation.</span><span class="sxs-lookup"><span data-stu-id="81455-108">Tools such as Regsvr32 make it simple to write a setup program that registers servers at installation.</span></span>

<span data-ttu-id="81455-109">Si vous ne vous fiez pas aux valeurs système par défaut, il existe deux clés importantes dans le registre : le CLSID et l’AppID.</span><span class="sxs-lookup"><span data-stu-id="81455-109">If you are not relying on system defaults, there are two important keys in the registry: the CLSID and the AppID.</span></span> <span data-ttu-id="81455-110">Parmi les informations importantes sous ces clés, citons l’instanciation de l’objet.</span><span class="sxs-lookup"><span data-stu-id="81455-110">Among the important pieces of information under these keys is how the object is to be instantiated.</span></span> <span data-ttu-id="81455-111">Les objets peuvent être désignés en tant que in-process, hors processus local ou à distance hors processus.</span><span class="sxs-lookup"><span data-stu-id="81455-111">Objects can be designated as in-process, out-of-process local, or out-of-process remote.</span></span>

<span data-ttu-id="81455-112">Sous la clé AppID se trouvent plusieurs valeurs qui définissent des informations spécifiques à cette application.</span><span class="sxs-lookup"><span data-stu-id="81455-112">Under the AppID key are several values that define information specific to that application.</span></span> <span data-ttu-id="81455-113">Parmi celles-ci, citons [RemoteServerName](remoteservername.md) et [ActivateAtStorage](activateatstorage.md), qui peuvent être utilisées pour permettre à un client de créer un objet, le client n’ayant aucune connaissance intégrée de l’emplacement du serveur.</span><span class="sxs-lookup"><span data-stu-id="81455-113">Among these are [RemoteServerName](remoteservername.md) and [ActivateAtStorage](activateatstorage.md), both of which can be used to permit a client to create an object, with the client having no built-in knowledge of the location of the server.</span></span> <span data-ttu-id="81455-114">(Pour plus d’informations sur l’instanciation distante, consultez [localisation d’un objet distant](locating-a-remote-object.md) et [fonctions d’assistance de création d’instance](instance-creation-helper-functions.md).)</span><span class="sxs-lookup"><span data-stu-id="81455-114">(For more information about remote instantiation, see [Locating a Remote Object](locating-a-remote-object.md) and [Instance Creation Helper Functions](instance-creation-helper-functions.md).)</span></span>

<span data-ttu-id="81455-115">Un serveur peut également être installé en tant que service ou exécuté sous un compte d’utilisateur spécifique.</span><span class="sxs-lookup"><span data-stu-id="81455-115">A server can also be installed as a service, or to run under a specific user account.</span></span> <span data-ttu-id="81455-116">Pour plus d’informations, consultez [installation de en tant qu’application de service](installing-as-a-service-application.md).</span><span class="sxs-lookup"><span data-stu-id="81455-116">For more information, see [Installing as a Service Application](installing-as-a-service-application.md).</span></span>

<span data-ttu-id="81455-117">Un serveur ou un objet ROT qui n’est pas un service ou qui s’exécute sous un compte d’utilisateur spécifique peut être appelé serveur « activer en tant qu’activateur ».</span><span class="sxs-lookup"><span data-stu-id="81455-117">A server or ROT object that is not a service or running under a specific user account can be referred to as an "activate as activator" server.</span></span> <span data-ttu-id="81455-118">Pour ces serveurs, le contexte de sécurité et la station ou le bureau Windows du client doivent correspondre à la version du serveur.</span><span class="sxs-lookup"><span data-stu-id="81455-118">For these servers, the security context and the window station/desktop of the client must match the server's.</span></span> <span data-ttu-id="81455-119">Un client qui tente de se connecter à un serveur distant est considéré comme ayant un bureau ou une station de fenêtre **null** , de sorte que seul le contexte de sécurité du serveur est comparé dans cette instance.</span><span class="sxs-lookup"><span data-stu-id="81455-119">A client attempting to connect to a remote server is considered to have a **NULL** window station/desktop, so only the server security context is compared in this instance.</span></span> <span data-ttu-id="81455-120">(Pour plus d’informations sur les SID, consultez [sécurité dans com](security-in-com.md).) COM met en cache la station ou le bureau Windows d’un processus lorsque le processus se connecte pour la première fois au service COM distribué.</span><span class="sxs-lookup"><span data-stu-id="81455-120">(For more information about SIDs, see [Security in COM](security-in-com.md).) COM caches the window station/desktop of a process when the process first connects to the distributed COM service.</span></span> <span data-ttu-id="81455-121">Par conséquent, les clients et les serveurs COM ne doivent pas modifier leur station Windows ou les bureaux de thread du processus après avoir appelé [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) ou [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span><span class="sxs-lookup"><span data-stu-id="81455-121">Therefore, COM clients and servers should not change their window station or thread desktops of the process after calling [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span></span>

<span data-ttu-id="81455-122">Quand une classe est inscrite en tant que processus in-process, un appel à [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) pour créer son objet de classe est passé automatiquement par com à la fonction [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) , que la classe doit implémenter pour accorder à l’objet appelant un pointeur vers son objet de classe.</span><span class="sxs-lookup"><span data-stu-id="81455-122">When a class is registered as in-process, a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) to create its class object is automatically passed by COM to the [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) function, which the class must implement to give the calling object a pointer to its class object.</span></span>

<span data-ttu-id="81455-123">Les classes implémentées dans des exécutables peuvent spécifier que COM doit exécuter leur processus et attendre que le processus enregistre l’interface [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) de l’objet de classe via un appel à la fonction [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) .</span><span class="sxs-lookup"><span data-stu-id="81455-123">Classes implemented in executables can specify that COM should execute their process and wait for the process to register their class object's [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface through a call to the [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="81455-124">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="81455-124">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="81455-125">Clés de registre COM</span><span class="sxs-lookup"><span data-stu-id="81455-125">COM Registry Keys</span></span>](com-registry-keys.md)
</dt> <dt>

[<span data-ttu-id="81455-126">Installation d’une application en tant que service</span><span class="sxs-lookup"><span data-stu-id="81455-126">Installing as a Service Application</span></span>](installing-as-a-service-application.md)
</dt> <dt>

[<span data-ttu-id="81455-127">Inscription d’un serveur exécutable en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="81455-127">Registering a Running EXE Server</span></span>](registering-a-running-exe-server.md)
</dt> <dt>

[<span data-ttu-id="81455-128">Inscription des composants</span><span class="sxs-lookup"><span data-stu-id="81455-128">Registering Components</span></span>](registering-components.md)
</dt> <dt>

[<span data-ttu-id="81455-129">Inscription d’objets dans le ROT</span><span class="sxs-lookup"><span data-stu-id="81455-129">Registering Objects in the ROT</span></span>](registering-objects-in-the-rot.md)
</dt> <dt>

[<span data-ttu-id="81455-130">Inscription automatique</span><span class="sxs-lookup"><span data-stu-id="81455-130">Self-Registration</span></span>](self-registration.md)
</dt> </dl>

 

 