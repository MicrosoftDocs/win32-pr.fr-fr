---
title: Fonctions d’assistance pour la création d’instances
description: Fonctions d’assistance pour la création d’instances
ms.assetid: 0b9b7bcf-f0f0-42c4-945e-63a532640d4b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84956f6040aaba13b46dea92bea611a49d5d8de3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104031903"
---
# <a name="instance-creation-helper-functions"></a><span data-ttu-id="4fc3e-103">Fonctions d’assistance pour la création d’instances</span><span class="sxs-lookup"><span data-stu-id="4fc3e-103">Instance Creation Helper Functions</span></span>

<span data-ttu-id="4fc3e-104">Dans les versions précédentes de COM, le mécanisme principal utilisé pour créer une instance d’objet était la fonction [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) .</span><span class="sxs-lookup"><span data-stu-id="4fc3e-104">In previous releases of COM, the primary mechanism used to create an object instance was the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function.</span></span> <span data-ttu-id="4fc3e-105">Cette fonction encapsule le processus de création d’un objet de classe, à l’aide de cette fonction pour créer une nouvelle instance et libérer l’objet de classe.</span><span class="sxs-lookup"><span data-stu-id="4fc3e-105">This function encapsulates the process of creating a class object, using that to create a new instance and releasing the class object.</span></span> <span data-ttu-id="4fc3e-106">Une autre fonction de ce type est le [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate)plus spécifique, le programme d’assistance de document composite OLE qui crée un objet de classe et récupère un pointeur vers un objet demandé.</span><span class="sxs-lookup"><span data-stu-id="4fc3e-106">Another function of this kind is the more specific [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate), the OLE compound document helper that creates a class object and retrieves a pointer to a requested object.</span></span>

<span data-ttu-id="4fc3e-107">Pour faciliter le processus de création d’instance sur des systèmes distribués, COM a introduit quatre nouveaux mécanismes de création d’instance importants :</span><span class="sxs-lookup"><span data-stu-id="4fc3e-107">To smooth the process of instance creation on distributed systems, COM has introduced four important new instance creation mechanisms:</span></span>

-   <span data-ttu-id="4fc3e-108">Monikers de classe et [ **IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span><span class="sxs-lookup"><span data-stu-id="4fc3e-108">Class monikers and [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span></span>
-   [<span data-ttu-id="4fc3e-109">**CoCreateInstanceEx**</span><span class="sxs-lookup"><span data-stu-id="4fc3e-109">**CoCreateInstanceEx**</span></span>](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)
-   [<span data-ttu-id="4fc3e-110">**CoGetInstanceFromFile**</span><span class="sxs-lookup"><span data-stu-id="4fc3e-110">**CoGetInstanceFromFile**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile)
-   [<span data-ttu-id="4fc3e-111">**CoGetInstanceFromIStorage**</span><span class="sxs-lookup"><span data-stu-id="4fc3e-111">**CoGetInstanceFromIStorage**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage)

<span data-ttu-id="4fc3e-112">Un moniker de classe vous permet d’identifier la classe d’un objet et est généralement utilisé avec un autre moniker, comme un moniker de fichier, pour indiquer l’emplacement de l’objet.</span><span class="sxs-lookup"><span data-stu-id="4fc3e-112">A class moniker permits you to identify the class of an object and is typically used with another moniker, like a file moniker, to indicate the location of the object.</span></span> <span data-ttu-id="4fc3e-113">Cela vous permet d’effectuer une liaison à un objet et de spécifier le serveur qui doit être lancé pour cet objet.</span><span class="sxs-lookup"><span data-stu-id="4fc3e-113">This permits you to bind to an object and specify the server that is to be launched for that object.</span></span> <span data-ttu-id="4fc3e-114">Les monikers de classes peuvent également être composés à droite des monikers qui prennent en charge la liaison à l’interface [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) .</span><span class="sxs-lookup"><span data-stu-id="4fc3e-114">Class monikers may also be composed to the right of monikers supporting binding to the [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) interface.</span></span> <span data-ttu-id="4fc3e-115">Pour plus d’informations, consultez [monikers de classes](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="4fc3e-115">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="4fc3e-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) étend [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) pour permettre de créer un objet unique non initialisé associé au CLSID donné sur une machine distante spécifiée.</span><span class="sxs-lookup"><span data-stu-id="4fc3e-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) extends [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) to make it possible to create a single uninitialized object associated with the given CLSID on a specified remote machine.</span></span> <span data-ttu-id="4fc3e-117">En outre, au lieu de demander une seule interface et d’obtenir un seul pointeur vers cette interface, **CoCreateInstanceEx** permet d’interroger plusieurs interfaces et (si disponibles) de recevoir des pointeurs vers ces interfaces en un seul aller-retour, ce qui permet de réduire le nombre d’allers-retours entre les machines.</span><span class="sxs-lookup"><span data-stu-id="4fc3e-117">In addition, rather than requesting a single interface and obtaining a single pointer to that interface, **CoCreateInstanceEx** makes it possible to query for multiple interfaces and (if available) receive pointers to them in a single round-trip, thus permitting fewer round-trips between machines.</span></span> <span data-ttu-id="4fc3e-118">Cela peut rendre l’interaction des objets à distance bien plus efficace.</span><span class="sxs-lookup"><span data-stu-id="4fc3e-118">This can make remote object interaction much more efficient.</span></span> <span data-ttu-id="4fc3e-119">Pour ce faire, la fonction utilise un tableau de [**structures \_ Qi multiples**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) .</span><span class="sxs-lookup"><span data-stu-id="4fc3e-119">To do this, the function uses an array of [**MULTI\_QI**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) structures.</span></span>

<span data-ttu-id="4fc3e-120">La création d’un objet via [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) requiert toujours que l’objet soit initialisé via un appel à l’une des interfaces d’initialisation (telle que [**IPersistStorage :: Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span><span class="sxs-lookup"><span data-stu-id="4fc3e-120">Creating an object through [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) still requires that the object be initialized through a call to one of the initialization interfaces (such as [**IPersistStorage::Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span></span> <span data-ttu-id="4fc3e-121">Les fonctions d’assistance [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) et [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulent à la fois la puissance de création d’instance de **CoCreateInstanceEx** et l’initialisation, la première d’un fichier et la dernière à partir d’un stockage.</span><span class="sxs-lookup"><span data-stu-id="4fc3e-121">The helper functions [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) and [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulate both the instance creation power of **CoCreateInstanceEx** and the initialization, the former from a file and the latter from a storage.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4fc3e-122">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="4fc3e-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4fc3e-123">Création d’un objet à l’aide d’un objet de classe</span><span class="sxs-lookup"><span data-stu-id="4fc3e-123">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 