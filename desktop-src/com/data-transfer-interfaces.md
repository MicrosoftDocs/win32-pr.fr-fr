---
title: Interfaces Transfert de données
description: Interfaces Transfert de données
ms.assetid: c42e65a4-7b77-4f39-8323-04fa60c5b140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 448e1a580880c7202ec67d12965f6db7e0be99d0
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "106510710"
---
# <a name="data-transfer-interfaces"></a><span data-ttu-id="1a23d-103">Interfaces Transfert de données</span><span class="sxs-lookup"><span data-stu-id="1a23d-103">Data Transfer Interfaces</span></span>

<span data-ttu-id="1a23d-104">L’interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) fournit aux consommateurs de données des méthodes permettant d’obtenir et de définir les données d’un objet, de déterminer les formats pris en charge par l’objet, ainsi que d’inscrire et de recevoir des notifications lorsque les données de l’objet sont modifiées.</span><span class="sxs-lookup"><span data-stu-id="1a23d-104">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface provides consumers of data with methods for getting and setting an object's data, determining which formats the object supports, and registering for and receiving notifications when data in the object changes.</span></span> <span data-ttu-id="1a23d-105">Quand vous obtenez des données, un appelant peut spécifier le format dans lequel il souhaite afficher les données.</span><span class="sxs-lookup"><span data-stu-id="1a23d-105">When obtaining data, a caller can specify the format in which it wants to render the data.</span></span> <span data-ttu-id="1a23d-106">La source des données, cependant, détermine le support de stockage, qu’elle retourne dans un paramètre de sortie fourni par l’appelant.</span><span class="sxs-lookup"><span data-stu-id="1a23d-106">The source of the data, however, determines the storage medium, which it returns in an out parameter provided by the caller.</span></span>

<span data-ttu-id="1a23d-107">À lui seul, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) fournit tous les outils dont vous avez besoin pour implémenter les transferts du presse-papiers Windows ou les transferts de documents composés dans vos applications.</span><span class="sxs-lookup"><span data-stu-id="1a23d-107">By itself, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) supplies all the tools you need to implement Windows clipboard transfers or compound document transfers in your applications.</span></span> <span data-ttu-id="1a23d-108">Si vous souhaitez également prendre en charge les transferts par glisser-déplacer, vous devez implémenter les interfaces [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) et [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) avec **IDataObject**.</span><span class="sxs-lookup"><span data-stu-id="1a23d-108">If you also want to support drag and drop transfers, you need to implement the [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) and [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) interfaces along with **IDataObject**.</span></span>

<span data-ttu-id="1a23d-109">L’interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) combinée aux API du presse-papiers OLE offre toutes les fonctionnalités des API du presse-papiers Windows.</span><span class="sxs-lookup"><span data-stu-id="1a23d-109">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface combined with OLE clipboard APIs provide all the capabilities of the Windows clipboard APIs.</span></span> <span data-ttu-id="1a23d-110">Il n’est généralement pas nécessaire d’utiliser les deux API du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="1a23d-110">It is not generally necessary to use both clipboard APIs.</span></span> <span data-ttu-id="1a23d-111">Les fournisseurs de données qui prennent en charge les transferts par glisser-déplacer ou les documents composés OLE doivent implémenter l’interface **IDataObject** .</span><span class="sxs-lookup"><span data-stu-id="1a23d-111">Data suppliers that support either drag and drop transfers or OLE compound documents must implement the **IDataObject** interface.</span></span> <span data-ttu-id="1a23d-112">Si votre application ne prend en charge que les transferts du presse-papiers maintenant, mais que vous envisagez d’ajouter des documents de glisser-déplacer ou composés dans des versions ultérieures, vous souhaiterez peut-être implémenter **IDataObject** et les API du presse-papiers OLE maintenant afin de réduire le temps de recodage et de débogage ultérieur.</span><span class="sxs-lookup"><span data-stu-id="1a23d-112">If your application supports only clipboard transfers now, but you intend to add drag and drop or compound documents in later releases, you may want to implement **IDataObject** and the OLE clipboard APIs now in order to minimize the amount of time spent recoding and debugging later.</span></span> <span data-ttu-id="1a23d-113">Vous pouvez également implémenter **IDataObject** afin d’utiliser des médias de transfert autres que la mémoire globale.</span><span class="sxs-lookup"><span data-stu-id="1a23d-113">You may also want to implement **IDataObject** in order to utilize transfer media other than global memory.</span></span>

<span data-ttu-id="1a23d-114">Le tableau suivant résume les types de transferts de données que vous souhaitez prendre en charge :</span><span class="sxs-lookup"><span data-stu-id="1a23d-114">The following table summarizes which ones to use, depending on what types of data transfer you want to support:</span></span>



| <span data-ttu-id="1a23d-115">Pour prendre en charge</span><span class="sxs-lookup"><span data-stu-id="1a23d-115">To support</span></span>                                                                       | <span data-ttu-id="1a23d-116">Utilisation</span><span class="sxs-lookup"><span data-stu-id="1a23d-116">Use</span></span>                                                                                                                                                                         |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1a23d-117">Documents composés</span><span class="sxs-lookup"><span data-stu-id="1a23d-117">Compound documents</span></span><br/>                                                    | [<span data-ttu-id="1a23d-118">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="1a23d-118">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="1a23d-119">Glisser-déplacer les transferts</span><span class="sxs-lookup"><span data-stu-id="1a23d-119">Drag and drop transfers</span></span><br/>                                               | <span data-ttu-id="1a23d-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (ou équivalent)</span><span class="sxs-lookup"><span data-stu-id="1a23d-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (or the equivalent)</span></span><br/> |
| <span data-ttu-id="1a23d-121">Transferts du presse-papiers à l’aide de la mémoire globale exclusivement</span><span class="sxs-lookup"><span data-stu-id="1a23d-121">Clipboard transfers using global memory exclusively</span></span><br/>                   | [<span data-ttu-id="1a23d-122">API du presse-papiers</span><span class="sxs-lookup"><span data-stu-id="1a23d-122">Clipboard API</span></span>](../dataxchg/clipboard.md)<br/>                                                                                                                            |
| <span data-ttu-id="1a23d-123">Les transferts du presse-papiers utilisent des supports Exchange autres que la mémoire globale.</span><span class="sxs-lookup"><span data-stu-id="1a23d-123">Clipboard transfers using exchange mediums other than global memory.</span></span><br/>  | [<span data-ttu-id="1a23d-124">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="1a23d-124">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="1a23d-125">Le presse-papiers transfère maintenant, mais glisser-déposer ou des documents composés ultérieurement</span><span class="sxs-lookup"><span data-stu-id="1a23d-125">Clipboard transfers now but drag and drop or compound documents later</span></span><br/> | <span data-ttu-id="1a23d-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) et les interfaces et fonctions mentionnées ci-dessus pour les « transferts par glisser-déplacer »</span><span class="sxs-lookup"><span data-stu-id="1a23d-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and the interfaces and function listed above for "Drag and drop transfers"</span></span><br/>                                                    |



 

<span data-ttu-id="1a23d-127">Lorsqu’un utilisateur lance une opération de transfert de données, l’application source crée une instance de [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) et le rend les données disponibles dans un ou plusieurs formats.</span><span class="sxs-lookup"><span data-stu-id="1a23d-127">When a user initiates a data transfer operation, the source application creates an instance of [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and through it makes the data available in one or more formats.</span></span> <span data-ttu-id="1a23d-128">Dans un transfert de presse-papiers, l’application appelle la fonction [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) pour passer un pointeur d’objet de données à OLE.</span><span class="sxs-lookup"><span data-stu-id="1a23d-128">In a clipboard transfer, the application calls the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function to pass a data-object pointer to OLE.</span></span> <span data-ttu-id="1a23d-129">(**OleSetClipboard** offre également des formats de données du presse-papiers standard pour les applications OLE version 1 et non-OLE.) Dans un transfert par glisser-déplacer, l’application appelle à la place la fonction [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) .</span><span class="sxs-lookup"><span data-stu-id="1a23d-129">(**OleSetClipboard** also offers standard clipboard data formats for both OLE version 1 and non-OLE applications.) In a drag and drop transfer, the application calls the [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) function instead.</span></span>

<span data-ttu-id="1a23d-130">Du côté réception du transfert, la destination reçoit le pointeur [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) comme argument pour un appel de [**IDropTarget ::D ROP**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) ou en appelant la fonction [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) , selon que le transfert est au moyen d’une opération glisser-déplacer ou du presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="1a23d-130">On the receiving side of the transfer, the destination receives the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer either as an argument to an invocation of [**IDropTarget::Drop**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) or by calling the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function, depending on whether the transfer is by means of drag and drop or the clipboard.</span></span> <span data-ttu-id="1a23d-131">Après avoir obtenu ce pointeur, la destination appelle [**IDataObject :: EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) pour savoir quels formats sont disponibles pour la récupération et sur quels types de supports ils peuvent être obtenus.</span><span class="sxs-lookup"><span data-stu-id="1a23d-131">Having obtained this pointer, the destination calls [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) to learn what formats are available for retrieval and on what types of media they can be obtained.</span></span> <span data-ttu-id="1a23d-132">Avec ces informations, l’application réceptrice demande les données avec un appel à [**IDataObject :: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span><span class="sxs-lookup"><span data-stu-id="1a23d-132">Armed with this information, the receiving application requests the data with a call to [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1a23d-133">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1a23d-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1a23d-134">Transfert de données</span><span class="sxs-lookup"><span data-stu-id="1a23d-134">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

