---
title: Architecture des objets connectables
description: Architecture des objets connectables
ms.assetid: 69949a3b-3ab8-4054-84d8-9256fbf39c7b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e9d8d2909942d1c04aed972e7891a6f4ae3f730
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/03/2021
ms.locfileid: "106538034"
---
# <a name="architecture-of-connectable-objects"></a><span data-ttu-id="89622-103">Architecture des objets connectables</span><span class="sxs-lookup"><span data-stu-id="89622-103">Architecture of Connectable Objects</span></span>

<span data-ttu-id="89622-104">L’objet connectable n’est qu’une partie de l’architecture globale des objets connectables.</span><span class="sxs-lookup"><span data-stu-id="89622-104">The connectable object is only one piece of the overall architecture of connectable objects.</span></span> <span data-ttu-id="89622-105">Cette technologie comprend les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="89622-105">This technology includes the following elements:</span></span>

-   <span data-ttu-id="89622-106">**Objet connectable.**</span><span class="sxs-lookup"><span data-stu-id="89622-106">**Connectable object.**</span></span> <span data-ttu-id="89622-107">Implémente l’interface [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) ; crée au moins un objet de point de connexion ; définit une interface sortante pour le client.</span><span class="sxs-lookup"><span data-stu-id="89622-107">Implements the [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) interface; creates at least one connection point object; defines an outgoing interface for the client.</span></span>
-   <span data-ttu-id="89622-108">**Client.**</span><span class="sxs-lookup"><span data-stu-id="89622-108">**Client.**</span></span> <span data-ttu-id="89622-109">Interroge l’objet pour obtenir des [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) pour déterminer si l’objet est connecté ; crée un objet récepteur pour implémenter l’interface sortante définie par l’objet connectable.</span><span class="sxs-lookup"><span data-stu-id="89622-109">Queries the object for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to determine whether the object is connectable; creates a sink object to implement the outgoing interface defined by the connectable object.</span></span>
-   <span data-ttu-id="89622-110">**Objet récepteur.**</span><span class="sxs-lookup"><span data-stu-id="89622-110">**Sink object.**</span></span> <span data-ttu-id="89622-111">Implémente l’interface sortante ; utilisé pour établir une connexion à l’objet connectable.</span><span class="sxs-lookup"><span data-stu-id="89622-111">Implements the outgoing interface; used to establish a connection to the connectable object.</span></span>
-   <span data-ttu-id="89622-112">**Objet point de connexion.**</span><span class="sxs-lookup"><span data-stu-id="89622-112">**Connection point object.**</span></span> <span data-ttu-id="89622-113">Implémente l’interface [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) et gère la connexion avec le récepteur du client.</span><span class="sxs-lookup"><span data-stu-id="89622-113">Implements the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface and manages connection with the client's sink.</span></span>

<span data-ttu-id="89622-114">Les relations entre le client, l’objet connectable, un point de connexion et un récepteur sont illustrées dans le diagramme suivant :</span><span class="sxs-lookup"><span data-stu-id="89622-114">The relationships between client, connectable object, a connection point, and a sink are illustrated in the following diagram:</span></span>

![Diagramme qui montre les points de connexion entre le client et l’objet connectable.](images/1cd44fec-5d2c-4427-846b-ccab7ec0b08a.png)

<span data-ttu-id="89622-116">Avant que l’objet point de connexion appelle des méthodes dans l’interface du récepteur à l’étape 3 du diagramme précédent, il doit effectuer une opération [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) pour l’interface spécifique requise, même si le pointeur a déjà été passé dans l’appel de l’étape 2 à la méthode [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) .</span><span class="sxs-lookup"><span data-stu-id="89622-116">Before the connection point object calls methods in the sink interface in step 3 in the preceding diagram, it must [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for the specific interface required, even if the pointer was already passed in the step 2 call to the [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) method.</span></span>

<span data-ttu-id="89622-117">Les deux objets Enumerator sont également impliqués dans cette architecture, mais ils ne sont pas affichés dans l’illustration.</span><span class="sxs-lookup"><span data-stu-id="89622-117">Two enumerator objects are also involved in this architecture though not shown in the illustration.</span></span> <span data-ttu-id="89622-118">L’un est créé par une méthode dans [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) pour énumérer les points de connexion dans l’objet connectable.</span><span class="sxs-lookup"><span data-stu-id="89622-118">One is created by a method in [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to enumerate the connection points within the connectable object.</span></span> <span data-ttu-id="89622-119">L’autre est créée par une méthode dans [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) pour énumérer les connexions actuellement établies à ce point de connexion.</span><span class="sxs-lookup"><span data-stu-id="89622-119">The other is created by a method in [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) to enumerate the connections currently established to that connection point.</span></span> <span data-ttu-id="89622-120">Un point de connexion peut prendre en charge plusieurs interfaces de récepteur connecté, et il doit itérer au sein de la liste de connexions chaque fois qu’il effectue un appel de méthode sur cette interface.</span><span class="sxs-lookup"><span data-stu-id="89622-120">One connection point can support multiple connected sink interfaces, and it should iterate through the list of connections each time it makes a method call on that interface.</span></span> <span data-ttu-id="89622-121">Ce processus porte le nom de multidiffusion.</span><span class="sxs-lookup"><span data-stu-id="89622-121">This process is known as multicasting.</span></span>

<span data-ttu-id="89622-122">Lorsque vous travaillez avec des objets connectables, il est important de comprendre que l’objet connectable, chaque point de connexion, chaque récepteur et tous les énumérateurs sont des objets distincts avec des implémentations [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) distinctes, des décomptes de références distincts et des durées de vie distinctes.</span><span class="sxs-lookup"><span data-stu-id="89622-122">When working with connectable objects, it is important to understand that the connectable object, each connection point, each sink, and all enumerators are separate objects with separate [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) implementations, separate reference counts, and separate lifetimes.</span></span> <span data-ttu-id="89622-123">Un client qui utilise ces objets est toujours responsable de la libération de tous les décomptes de références qu’il détient.</span><span class="sxs-lookup"><span data-stu-id="89622-123">A client using these objects is always responsible for releasing all reference counts it owns.</span></span>

> [!Note]  
> <span data-ttu-id="89622-124">Un objet connectable peut prendre en charge plusieurs clients et peut prendre en charge plusieurs récepteurs au sein d’un client.</span><span class="sxs-lookup"><span data-stu-id="89622-124">A connectable object can support more than one client and can support multiple sinks within a client.</span></span> <span data-ttu-id="89622-125">De même, un récepteur peut être connecté à plusieurs objets connectables.</span><span class="sxs-lookup"><span data-stu-id="89622-125">Likewise, a sink can be connected to more than one connectable object.</span></span>

 

<span data-ttu-id="89622-126">Les étapes permettant d’établir une connexion entre un client et un objet connectable sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="89622-126">The steps for establishing a connection between a client and a connectable object are as follows:</span></span>

1.  <span data-ttu-id="89622-127">Le client interroge [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) sur l’objet pour déterminer si l’objet est connectable.</span><span class="sxs-lookup"><span data-stu-id="89622-127">The client queries for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) on the object to determine whether the object is connectable.</span></span> <span data-ttu-id="89622-128">Si cet appel réussit, le client conserve un pointeur vers l’interface **IConnectionPointContainer** sur l’objet connectable et le compteur de référence d’objet connectable a été incrémenté.</span><span class="sxs-lookup"><span data-stu-id="89622-128">If this call is successful, the client holds a pointer to the **IConnectionPointContainer** interface on the connectable object and the connectable object reference counter has been incremented.</span></span> <span data-ttu-id="89622-129">Dans le cas contraire, l’objet n’est pas connectable et ne prend pas en charge les interfaces sortantes.</span><span class="sxs-lookup"><span data-stu-id="89622-129">Otherwise, the object is not connectable and does not support outgoing interfaces.</span></span>
2.  <span data-ttu-id="89622-130">Si l’objet est connectable, le client tente ensuite d’obtenir un pointeur vers l’interface [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) sur un point de connexion dans l’objet connectable.</span><span class="sxs-lookup"><span data-stu-id="89622-130">If the object is connectable, the client next tries to obtain a pointer to the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface on a connection point within the connectable object.</span></span> <span data-ttu-id="89622-131">Il existe deux méthodes pour obtenir ce pointeur, à la fois dans [**IConnectionPointContainer :: FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) et dans [**IConnectionPointContainer :: EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span><span class="sxs-lookup"><span data-stu-id="89622-131">There are two methods for obtaining this pointer, both in [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) and in [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="89622-132">Quelques étapes supplémentaires sont nécessaires si **EnumConnectionPoints** est utilisé.</span><span class="sxs-lookup"><span data-stu-id="89622-132">There are a few additional steps needed if **EnumConnectionPoints** is used.</span></span> <span data-ttu-id="89622-133">(Pour plus d’informations, consultez [utilisation de IConnectionPointContainer](using-iconnectionpointcontainer.md) .) En cas de réussite, l’objet connectable et le client prennent tous les deux en charge la même interface sortante.</span><span class="sxs-lookup"><span data-stu-id="89622-133">(See [Using IConnectionPointContainer](using-iconnectionpointcontainer.md) for more information.) If successful, the connectable object and the client both support the same outgoing interface.</span></span> <span data-ttu-id="89622-134">L’objet connectable le définit et l’appelle, et le client l’implémente.</span><span class="sxs-lookup"><span data-stu-id="89622-134">The connectable object defines it and calls it, and the client implements it.</span></span> <span data-ttu-id="89622-135">Le client peut ensuite communiquer via le point de connexion dans l’objet connectable.</span><span class="sxs-lookup"><span data-stu-id="89622-135">The client can then communicate through the connection point within the connectable object.</span></span>
3.  <span data-ttu-id="89622-136">Le client appelle ensuite [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) sur le point de connexion pour établir une connexion entre son interface de récepteur et le point de connexion de l’objet.</span><span class="sxs-lookup"><span data-stu-id="89622-136">The client then calls [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) on the connection point to establish a connection between its sink interface and the object's connection point.</span></span> <span data-ttu-id="89622-137">Après cet appel, le point de connexion de l’objet contient un pointeur vers l’interface sortante sur le récepteur.</span><span class="sxs-lookup"><span data-stu-id="89622-137">After this call, the object's connection point holds a pointer to the outgoing interface on the sink.</span></span>
4.  <span data-ttu-id="89622-138">Le code à l’intérieur de [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) appelle [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) sur le pointeur d’interface qui est passé, en demandant l’identificateur d’interface spécifique auquel il se connecte.</span><span class="sxs-lookup"><span data-stu-id="89622-138">The code inside [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) calls [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) on the interface pointer that is passed in, asking for the specific interface identifier to which it connects.</span></span>
5.  <span data-ttu-id="89622-139">L’objet appelle des méthodes sur l’interface du récepteur, si nécessaire, à l’aide du pointeur détenu par son point de connexion.</span><span class="sxs-lookup"><span data-stu-id="89622-139">The object calls methods on the sink's interface as needed, using the pointer held by its connection point.</span></span>
6.  <span data-ttu-id="89622-140">Le client appelle [**Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) pour mettre fin à la connexion.</span><span class="sxs-lookup"><span data-stu-id="89622-140">The client calls [**Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) to terminate the connection.</span></span> <span data-ttu-id="89622-141">Ensuite, le client appelle **IConnectionPoint :: Release** pour libérer sa conservation sur le point de connexion et, par conséquent, l’objet connectable principal également.</span><span class="sxs-lookup"><span data-stu-id="89622-141">Then the client calls **IConnectionPoint::Release** to free its hold on the connection point and, therefore, the main connectable object also.</span></span> <span data-ttu-id="89622-142">Le client doit également appeler **IConnectionPointContainer :: Release** pour libérer sa conservation sur l’objet connectable principal.</span><span class="sxs-lookup"><span data-stu-id="89622-142">The client must also call **IConnectionPointContainer::Release** to free its hold on the main connectable object.</span></span>

## <a name="related-topics"></a><span data-ttu-id="89622-143">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="89622-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="89622-144">Interfaces d’objets connectables</span><span class="sxs-lookup"><span data-stu-id="89622-144">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




