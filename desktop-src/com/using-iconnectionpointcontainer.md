---
title: Utilisation de IConnectionPointContainer
description: Utilisation de IConnectionPointContainer
ms.assetid: a87afb25-4d45-4ce2-9b27-840da5107bce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d0b7c691e1ba6a8445af56978b43a2ccbf33e7
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/29/2020
ms.locfileid: "106510662"
---
# <a name="using-iconnectionpointcontainer"></a><span data-ttu-id="88223-103">Utilisation de IConnectionPointContainer</span><span class="sxs-lookup"><span data-stu-id="88223-103">Using IConnectionPointContainer</span></span>

<span data-ttu-id="88223-104">Un objet connectable implémente [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (et l’expose via [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))) pour indiquer l’existence des interfaces sortantes.</span><span class="sxs-lookup"><span data-stu-id="88223-104">A connectable object implements [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (and exposes it through [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))) to indicate the existence of outgoing interfaces.</span></span> <span data-ttu-id="88223-105">Pour chaque interface sortante, l’objet connectable gère un sous-objet de point de connexion qui implémente lui-même un [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="88223-105">For each outgoing interface, the connectable object manages a connection point sub-object, which itself implements [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint).</span></span> <span data-ttu-id="88223-106">L’objet connectable contient donc les points de connexion, par conséquent l’attribution de noms à **IConnectionPointContainer** et à **IConnectionPoint**.</span><span class="sxs-lookup"><span data-stu-id="88223-106">The connectable object therefore contains the connection points, hence the naming of **IConnectionPointContainer** and **IConnectionPoint**.</span></span>

<span data-ttu-id="88223-107">Via [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer), un client peut effectuer deux opérations.</span><span class="sxs-lookup"><span data-stu-id="88223-107">Through [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer), a client can perform two operations.</span></span> <span data-ttu-id="88223-108">Tout d’abord, si le client possède déjà l’IID pour une interface sortante qu’il prend en charge, il peut localiser le point de connexion correspondant pour l’IID à l’aide de [**IConnectionPointContainer :: FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="88223-108">First, if the client already has the IID for an outgoing interface that it supports, it can locate the corresponding connection point for the IID using [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span> <span data-ttu-id="88223-109">Le client ne peut pas interroger directement le point de connexion en raison de la relation conteneur/contenu entre l’objet connectable et ses points de connexion contenus.</span><span class="sxs-lookup"><span data-stu-id="88223-109">The client cannot query for the connection point directly because of the container/contained relationship between the connectable object and its contained connection points.</span></span> <span data-ttu-id="88223-110">Fondamentalement, **FindConnectionPoint** est le [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) pour les interfaces sortantes lorsque l’IID est connu du client.</span><span class="sxs-lookup"><span data-stu-id="88223-110">Basically, **FindConnectionPoint** is the [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for outgoing interfaces when the IID is known to the client.</span></span>

<span data-ttu-id="88223-111">Deuxièmement, le client peut énumérer tous les points de connexion dans l’objet connectable via [**IConnectionPointContainer :: EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span><span class="sxs-lookup"><span data-stu-id="88223-111">Second, the client can enumerate all connection points within the connectable object through [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="88223-112">Cette méthode retourne un pointeur d’interface [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) pour un objet énumérateur séparé.</span><span class="sxs-lookup"><span data-stu-id="88223-112">This method returns an [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) interface pointer for a separate enumerator object.</span></span> <span data-ttu-id="88223-113">Via [**IEnumConnectionPoints :: Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next), le client peut obtenir des pointeurs d’interface [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) vers chaque point de connexion.</span><span class="sxs-lookup"><span data-stu-id="88223-113">Through [**IEnumConnectionPoints::Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next), the client can obtain [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface pointers to each connection point.</span></span>

<span data-ttu-id="88223-114">Une fois que le client a obtenu l’interface [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) , il doit appeler [**IConnectionPoint :: GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) pour déterminer l’IID de l’interface sortante prise en charge par chaque point de connexion.</span><span class="sxs-lookup"><span data-stu-id="88223-114">After the client obtains the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface, it must call [**IConnectionPoint::GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) to determine the IID of the outgoing interface supported by each connection point.</span></span> <span data-ttu-id="88223-115">Si le client prend déjà en charge cette interface sortante, il peut établir une connexion.</span><span class="sxs-lookup"><span data-stu-id="88223-115">If the client already supports that outgoing interface, it can establish a connection.</span></span> <span data-ttu-id="88223-116">Dans le cas contraire, il peut toujours être en mesure de prendre en charge l’interface sortante en utilisant les informations de la bibliothèque de types de l’objet connectable pour assurer la prise en charge au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="88223-116">Otherwise, it may still be able to support the outgoing interface by using information from the connectable object's type library to provide support at run time.</span></span> <span data-ttu-id="88223-117">Cette technique nécessite que l’objet connectable prenne en charge l’interface [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) .</span><span class="sxs-lookup"><span data-stu-id="88223-117">This technique requires that the connectable object support the [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) interface.</span></span> <span data-ttu-id="88223-118">(Consultez [utilisation de IProvideClassInfo](using-iprovideclassinfo.md).)</span><span class="sxs-lookup"><span data-stu-id="88223-118">(See [Using IProvideClassInfo](using-iprovideclassinfo.md).)</span></span>

<span data-ttu-id="88223-119">Étant donné que l’énumérateur est un objet distinct, le client doit appeler **IEnumConnectionPoints :: Release** quand l’énumérateur n’est plus nécessaire.</span><span class="sxs-lookup"><span data-stu-id="88223-119">Because the enumerator is a separate object, the client must call **IEnumConnectionPoints::Release** when the enumerator is no longer needed.</span></span> <span data-ttu-id="88223-120">En outre, chaque point de connexion est un objet avec un nombre de références distinct de l’objet connectable contenant.</span><span class="sxs-lookup"><span data-stu-id="88223-120">In addition, each connection point is an object with a separate reference count from the containing connectable object.</span></span> <span data-ttu-id="88223-121">Par conséquent, le client doit également appeler IConnectionPoint :: Release pour chaque point de connexion accessible via l’énumérateur ou via [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="88223-121">Therefore, the client must also call IConnectionPoint::Release for each connection point accessed either through the enumerator or through [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span>

## <a name="related-topics"></a><span data-ttu-id="88223-122">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="88223-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="88223-123">Interfaces d’objets connectables</span><span class="sxs-lookup"><span data-stu-id="88223-123">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




