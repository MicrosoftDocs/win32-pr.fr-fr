---
title: Notification de données
description: Les objets qui consomment des données provenant d’une source externe doivent parfois être informés lorsque les données de cette source changent.
ms.assetid: 286a1ecf-5255-4443-a17d-5ffa55ed0be1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49df9e6bb7d9b15192473b18114fe7fcd69ecedf
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "106510498"
---
# <a name="data-notification"></a><span data-ttu-id="7b288-103">Notification de données</span><span class="sxs-lookup"><span data-stu-id="7b288-103">Data Notification</span></span>

<span data-ttu-id="7b288-104">Les objets qui consomment des données provenant d’une source externe doivent parfois être informés lorsque les données de cette source changent.</span><span class="sxs-lookup"><span data-stu-id="7b288-104">Objects that consume data from an external source sometimes need to be informed when data in that source changes.</span></span> <span data-ttu-id="7b288-105">Par exemple, une visionneuse de bandes de cotations boursières qui s’appuie sur des données dans une feuille de calcul doit être notifiée lorsque ces données changent afin de pouvoir mettre à jour son affichage.</span><span class="sxs-lookup"><span data-stu-id="7b288-105">For example, a stock ticker tape viewer that relies on data in some spreadsheet needs to be notified when that data changes so it can update its display.</span></span> <span data-ttu-id="7b288-106">De même, un document composé a besoin d’informations sur les modifications de données dans ses objets incorporés afin qu’il puisse mettre à jour ses caches de données.</span><span class="sxs-lookup"><span data-stu-id="7b288-106">Similarly, a compound document needs information about data changes in its embedded objects so that it can update its data caches.</span></span> <span data-ttu-id="7b288-107">Dans ce cas, où la mise à jour dynamique des données est souhaitable, les sources de données requièrent un mécanisme de notification des modifications aux consommateurs de données à mesure qu’elles se produisent sans obliger les consommateurs à supprimer tout afin de mettre à jour leurs données.</span><span class="sxs-lookup"><span data-stu-id="7b288-107">In cases such as this, where dynamic updating of data is desirable, sources of data require some mechanism of notifying data consumers of changes as they occur without obligating the consumers to drop everything in order to update their data.</span></span> <span data-ttu-id="7b288-108">Dans l’idéal, après avoir été informé qu’une modification a eu lieu dans la source de données, un objet consommateur peut demander une copie mise à jour à son gré.</span><span class="sxs-lookup"><span data-stu-id="7b288-108">Ideally, having been notified that a change has occurred in the data source, a consuming object can ask for an updated copy at its leisure.</span></span>

<span data-ttu-id="7b288-109">Le mécanisme de COM pour gérer les notifications asynchrones de ce type est un objet appelé récepteur de notifications, qui est tout simplement un objet COM qui implémente une interface appelée [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span><span class="sxs-lookup"><span data-stu-id="7b288-109">COM's mechanism for handling asynchronous notifications of this type is an object called an advise sink, which is simply any COM object that implements an interface called [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span></span> <span data-ttu-id="7b288-110">Les consommateurs de données implémentent **IAdviseSink**.</span><span class="sxs-lookup"><span data-stu-id="7b288-110">Consumers of data implement the **IAdviseSink**.</span></span> <span data-ttu-id="7b288-111">Ils s’inscrivent pour recevoir des notifications en transmettant un pointeur vers l’objet de données qui nous intéresse.</span><span class="sxs-lookup"><span data-stu-id="7b288-111">They register to receive notifications by handing a pointer to the data object of interest.</span></span>

<span data-ttu-id="7b288-112">Les interfaces [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) exposent les méthodes suivantes pour recevoir des notifications asynchrones :</span><span class="sxs-lookup"><span data-stu-id="7b288-112">The [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interfaces exposes the following methods for receiving asynchronous notifications:</span></span>



| <span data-ttu-id="7b288-113">Méthode</span><span class="sxs-lookup"><span data-stu-id="7b288-113">Method</span></span>                                                      | <span data-ttu-id="7b288-114">Notifie le récepteur de notifications qui</span><span class="sxs-lookup"><span data-stu-id="7b288-114">Notifies the advise sink that</span></span>                                            |
|-------------------------------------------------------------|--------------------------------------------------------------------------|
| [<span data-ttu-id="7b288-115">**N''est**</span><span class="sxs-lookup"><span data-stu-id="7b288-115">**OnDataChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange)<br/> | <span data-ttu-id="7b288-116">Les données de l’objet appelant ont été modifiées.</span><span class="sxs-lookup"><span data-stu-id="7b288-116">The calling object's data has changed.</span></span><br/>                        |
| [<span data-ttu-id="7b288-117">**OnViewChange**</span><span class="sxs-lookup"><span data-stu-id="7b288-117">**OnViewChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange)<br/> | <span data-ttu-id="7b288-118">Les instructions de dessin de l’objet appelant ont changé.</span><span class="sxs-lookup"><span data-stu-id="7b288-118">The instructions for drawing the calling object have changed.</span></span><br/> |
| [<span data-ttu-id="7b288-119">**OnRename**</span><span class="sxs-lookup"><span data-stu-id="7b288-119">**OnRename**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename)<br/>         | <span data-ttu-id="7b288-120">Le moniker de l’objet appelant a changé.</span><span class="sxs-lookup"><span data-stu-id="7b288-120">The calling object's moniker has changed.</span></span><br/>                     |
| [<span data-ttu-id="7b288-121">**OnSave**</span><span class="sxs-lookup"><span data-stu-id="7b288-121">**OnSave**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)<br/>             | <span data-ttu-id="7b288-122">L’objet appelant a été enregistré dans un stockage persistant.</span><span class="sxs-lookup"><span data-stu-id="7b288-122">The calling object has been saved to persistent storage.</span></span><br/>      |
| [<span data-ttu-id="7b288-123">**OnClose**</span><span class="sxs-lookup"><span data-stu-id="7b288-123">**OnClose**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)<br/>           | <span data-ttu-id="7b288-124">L’objet appelant a été fermé.</span><span class="sxs-lookup"><span data-stu-id="7b288-124">The calling object has been closed.</span></span><br/>                           |



 

<span data-ttu-id="7b288-125">Comme le montre le tableau, l’interface [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) expose des méthodes pour notifier le récepteur d’événements autres que les modifications apportées aux données de l’objet appelant.</span><span class="sxs-lookup"><span data-stu-id="7b288-125">As the table indicates, the [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interface exposes methods for notifying the advise sink of events other than changes in the calling object's data.</span></span> <span data-ttu-id="7b288-126">L’objet appelant peut également notifier le récepteur lorsque la manière dont il se dessine lui-même change ou qu’il est renommé, enregistré ou fermé.</span><span class="sxs-lookup"><span data-stu-id="7b288-126">The calling object can also notify the sink when the way in which it draws itself changes, or it is renamed, saved, or closed.</span></span> <span data-ttu-id="7b288-127">Ces autres notifications sont utilisées principalement ou entièrement dans le contexte des documents composés, bien que le mécanisme de notification soit identique.</span><span class="sxs-lookup"><span data-stu-id="7b288-127">These other notifications are used mainly or entirely in the context of compound documents, although the notification mechanism is identical.</span></span> <span data-ttu-id="7b288-128">Pour plus d’informations sur les notifications de documents composés, consultez la section « documents composés ».</span><span class="sxs-lookup"><span data-stu-id="7b288-128">For more information on compound-document notifications, see "Compound Documents."</span></span>

<span data-ttu-id="7b288-129">Pour tirer parti du récepteur de notifications, une source de données doit implémenter [**IDataObject ::D Advise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject ::D Unadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)et [**IDataObject :: EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span><span class="sxs-lookup"><span data-stu-id="7b288-129">In order to take advantage of the advise sink, a data source must implement [**IDataObject::DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise), and [**IDataObject::EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span></span> <span data-ttu-id="7b288-130">Un consommateur de données appelle le mothod **DAdvise** pour notifier un objet de données qu’il souhaite être averti lorsque les données de l’objet sont modifiées.</span><span class="sxs-lookup"><span data-stu-id="7b288-130">A data consumer calls the **DAdvise** mothod to notify a data object that it wishes to be notified when the object's data changes.</span></span> <span data-ttu-id="7b288-131">L’objet consommateur appelle la méthode **DUnadvise** pour détruire cette connexion.</span><span class="sxs-lookup"><span data-stu-id="7b288-131">The consuming object calls the **DUnadvise** method to tear down this connection.</span></span> <span data-ttu-id="7b288-132">Toute partie intéressée peut appeler la méthode **EnumDAdvise** pour connaître le nombre d’objets ayant une connexion consultative avec un objet de données.</span><span class="sxs-lookup"><span data-stu-id="7b288-132">Any interested party can call the **EnumDAdvise** method to learn the number of objects having an advisory connection with a data object.</span></span>

<span data-ttu-id="7b288-133">Lorsque les données sont modifiées au niveau de la source, l’objet de données appelle [**IAdviseSink :: OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) sur tous les consommateurs de données qui se sont inscrits pour recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="7b288-133">When data changes at the source, the data object calls [**IAdviseSink::OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) on all data consumers that have registered to receive notifications.</span></span> <span data-ttu-id="7b288-134">Pour effectuer le suivi des connexions de notifications et gérer la distribution des notifications, les sources de données s’appuient sur un objet appelé détenteur de la notification de *données*.</span><span class="sxs-lookup"><span data-stu-id="7b288-134">To keep track of advisory connections and manage the dispatch of notifications, data sources rely on an object called a *data advise holder*.</span></span> <span data-ttu-id="7b288-135">Vous pouvez créer votre propre propriétaire de notifications de données en implémentant l’interface [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) .</span><span class="sxs-lookup"><span data-stu-id="7b288-135">You can create your own data advise holder by implementing the [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) interface.</span></span> <span data-ttu-id="7b288-136">Ou vous pouvez laisser COM le faire pour vous en appelant la fonction d’assistance [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span><span class="sxs-lookup"><span data-stu-id="7b288-136">Or, you can let COM do it for you by calling the helper function [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span></span>

## <a name="related-topics"></a><span data-ttu-id="7b288-137">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="7b288-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7b288-138">Transfert de données</span><span class="sxs-lookup"><span data-stu-id="7b288-138">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

