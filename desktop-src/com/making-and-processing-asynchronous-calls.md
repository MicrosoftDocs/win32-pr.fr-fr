---
title: Établissement et traitement des appels asynchrones
description: Les objets COM peuvent prendre en charge l’appel asynchrone.
ms.assetid: bf7f9f8e-66ce-41a4-854c-62dbe840a89e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 059f55cc64a70f130e7fb654426803edbe8b7209
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "106509064"
---
# <a name="making-and-processing-asynchronous-calls"></a><span data-ttu-id="0e8b1-103">Établissement et traitement des appels asynchrones</span><span class="sxs-lookup"><span data-stu-id="0e8b1-103">Making and Processing Asynchronous Calls</span></span>

<span data-ttu-id="0e8b1-104">Les objets COM peuvent prendre en charge l’appel asynchrone.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-104">COM objects can support asynchronous calling.</span></span> <span data-ttu-id="0e8b1-105">Lorsqu’un client effectue un appel asynchrone, le contrôle retourne immédiatement au client.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-105">When a client makes an asynchronous call, control returns to the client immediately.</span></span> <span data-ttu-id="0e8b1-106">Pendant que le serveur traite l’appel, le client est libre d’effectuer d’autres tâches.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-106">While the server processes the call, the client is free to do other work.</span></span> <span data-ttu-id="0e8b1-107">Lorsque le client ne peut plus continuer sans les résultats de l’appel, il peut obtenir les résultats de l’appel à ce moment-là.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-107">When the client can no longer proceed without the results of the call, it can get the results of the call at that time.</span></span>

<span data-ttu-id="0e8b1-108">Par exemple, une demande pour un jeu d’enregistrements volumineux ou complexe peut prendre du temps.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-108">For example, a request for a large or complex recordset can be time-consuming.</span></span> <span data-ttu-id="0e8b1-109">Un client peut demander le Recordset par un appel asynchrone, puis effectuer un autre travail.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-109">A client can request the recordset by an asynchronous call and then do other work.</span></span> <span data-ttu-id="0e8b1-110">Lorsque l’ensemble d’enregistrements est disponible, le client peut l’obtenir rapidement sans blocage.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-110">When the recordset is available, the client can obtain it quickly without blocking.</span></span>

<span data-ttu-id="0e8b1-111">Les clients n’effectuent pas d’appels asynchrones directement sur l’objet serveur.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-111">Clients do not make asynchronous calls directly on the server object.</span></span> <span data-ttu-id="0e8b1-112">Au lieu de cela, ils obtiennent un objet d’appel qui implémente une version asynchrone d’une interface synchrone sur l’objet serveur.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-112">Instead, they obtain a call object that implements an asynchronous version of a synchronous interface on the server object.</span></span> <span data-ttu-id="0e8b1-113">L’interface asynchrone de l’objet d’appel a un nom de la forme Async *NomInterface*.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-113">The asynchronous interface on the call object has a name of the form Async *InterfaceName*.</span></span> <span data-ttu-id="0e8b1-114">Par exemple, si un objet serveur implémente une interface synchrone nommée IMyInterface, il y aura un objet d’appel qui implémente une interface asynchrone nommée AsyncIMyInterface.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-114">For example, if a server object implements a synchronous interface named IMyInterface, there will be a call object that implements an asynchronous interface named AsyncIMyInterface.</span></span>

> [!Note]  
> <span data-ttu-id="0e8b1-115">La prise en charge asynchrone n’est pas disponible pour **IDispatch** ou pour les interfaces qui héritent de **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-115">Asynchronous support is not available for **IDispatch** or for interfaces that inherit **IDispatch**.</span></span>

 

<span data-ttu-id="0e8b1-116">Les objets serveur qui prennent en charge les appels asynchrones implémentent l’interface [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) .</span><span class="sxs-lookup"><span data-stu-id="0e8b1-116">Server objects that support asynchronous calls implement the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface.</span></span> <span data-ttu-id="0e8b1-117">Cette interface expose une méthode unique, [**createCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), qui crée une instance d’un objet d’appel spécifié.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-117">This interface exposes a single method, [**CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), which creates an instance of a specified call object.</span></span> <span data-ttu-id="0e8b1-118">Les clients peuvent interroger **ICallFactory** pour déterminer si un objet prend en charge l’appel asynchrone.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-118">Clients can query for **ICallFactory** to determine whether an object supports asynchronous calling.</span></span>

<span data-ttu-id="0e8b1-119">Pour chaque méthode sur une interface synchrone, l’interface asynchrone correspondante implémente deux méthodes.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-119">For each method on a synchronous interface, the corresponding asynchronous interface implements two methods.</span></span> <span data-ttu-id="0e8b1-120">Ces méthodes attachent les préfixes Begin \_ et Finish \_ au nom de la méthode synchrone.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-120">These methods attach the prefixes Begin\_ and Finish\_ to the name of the synchronous method.</span></span> <span data-ttu-id="0e8b1-121">Par exemple, si une interface nommée ISimpleStream a une méthode Read, l’interface AsyncISimpleStream aura une méthode de lecture Begin \_ Read et Finish \_ .</span><span class="sxs-lookup"><span data-stu-id="0e8b1-121">For example, if an interface named ISimpleStream has a Read method, the AsyncISimpleStream interface will have a Begin\_Read and a Finish\_Read method.</span></span> <span data-ttu-id="0e8b1-122">Pour commencer un appel asynchrone, le client appelle la \_ méthode Begin.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-122">To begin an asynchronous call, the client calls the Begin\_ method.</span></span>

<span data-ttu-id="0e8b1-123">Lorsque vous implémentez un objet serveur, il n’est pas nécessaire de fournir un objet d’appel pour chaque interface que l’objet implémente.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-123">When you implement a server object, you do not have to provide a call object for every interface the object implements.</span></span> <span data-ttu-id="0e8b1-124">Si l’objet serveur implémente l’interface [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) et utilise le marshaling standard, un client marshalé peut toujours obtenir un objet proxy d’appel, même s’il n’y a aucun objet d’appel côté serveur.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-124">If the server object implements the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface and uses standard marshaling, a marshaled client can always obtain a proxy call object, even if there is no call object on the server side.</span></span> <span data-ttu-id="0e8b1-125">Ce proxy marshale la \_ méthode Begin comme un appel synchrone, le serveur traite l’appel de façon synchrone et le client peut obtenir les paramètres out en appelant la méthode Finish \_ .</span><span class="sxs-lookup"><span data-stu-id="0e8b1-125">This proxy will marshal the Begin\_ method as a synchronous call, the server will process the call synchronously, and the client can obtain the out parameters by calling the Finish\_ method.</span></span>

<span data-ttu-id="0e8b1-126">À l’inverse, si un client effectue un appel synchrone marshalé sur une interface pour laquelle il existe un objet d’appel côté serveur, le serveur traite toujours l’appel de manière asynchrone.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-126">Conversely, if a client makes a marshaled synchronous call on an interface for which there is a call object on the server side, the server will always process the call asynchronously.</span></span> <span data-ttu-id="0e8b1-127">Ce comportement ne sera pas visible pour le client, car le client recevra les mêmes paramètres de sortie et la même valeur de retour que celle qu’il aurait reçue de la méthode synchrone.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-127">This behavior will not be apparent to the client, because the client will receive the same out parameters and the same return value it would have received from the synchronous method.</span></span>

<span data-ttu-id="0e8b1-128">Dans les deux cas, l’interaction entre le client et le serveur est marshalée comme si l’appel était synchrone : la sortie des proxies synchrones et asynchrones ne peut pas être distinguée, comme c’est le cas de la sortie des stubs correspondants.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-128">In either case, the interaction between client and server is marshaled as if the call were synchronous: The output of synchronous and asynchronous proxies is indistinguishable, as is the output of the corresponding stubs.</span></span> <span data-ttu-id="0e8b1-129">Ce comportement simplifie grandement le modèle de programmation à la fois des clients et des serveurs.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-129">This behavior greatly simplifies the programming model both of clients and of servers.</span></span> <span data-ttu-id="0e8b1-130">Si un objet serveur implémente [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), un client marshalé n’a pas à tenter de créer un objet d’appel qui n’est peut-être pas disponible : pour le client, un objet d’appel est toujours disponible.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-130">If a server object implements [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), a marshaled client does not have to attempt to create a call object that may not be available — to the client, a call object is always available.</span></span>

<span data-ttu-id="0e8b1-131">Lorsque le client et le serveur se trouvent dans le même cloisonnement, l’objet serveur traite l’appel que le client effectue.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-131">When client and server are in the same apartment, the server object will process whichever call the client makes.</span></span> <span data-ttu-id="0e8b1-132">Si un objet d’appel n’est pas disponible, le client doit obtenir explicitement l’interface synchrone et effectuer un appel synchrone.</span><span class="sxs-lookup"><span data-stu-id="0e8b1-132">If a call object is not available, the client must explicitly obtain the synchronous interface and make a synchronous call.</span></span>

<span data-ttu-id="0e8b1-133">Pour plus d'informations, voir les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="0e8b1-133">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="0e8b1-134">Exécution d’un appel asynchrone</span><span class="sxs-lookup"><span data-stu-id="0e8b1-134">Making an Asynchronous Call</span></span>](making-an-asynchronous-call.md)
-   [<span data-ttu-id="0e8b1-135">Annulation d’un appel asynchrone</span><span class="sxs-lookup"><span data-stu-id="0e8b1-135">Canceling an Asynchronous Call</span></span>](canceling-an-asynchronous-call.md)
-   [<span data-ttu-id="0e8b1-136">Annulation des appels de méthode</span><span class="sxs-lookup"><span data-stu-id="0e8b1-136">Canceling Method Calls</span></span>](canceling-method-calls.md)
-   [<span data-ttu-id="0e8b1-137">Synchronisation des appels</span><span class="sxs-lookup"><span data-stu-id="0e8b1-137">Call Synchronization</span></span>](call-synchronization.md)

 

 