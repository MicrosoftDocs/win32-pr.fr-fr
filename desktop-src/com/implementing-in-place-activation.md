---
title: Implémentation de l’activation In-Place
description: Implémentation de l’activation In-Place
ms.assetid: 5fd67d1c-1dc5-4d83-a41e-b64d84cbf212
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c075f143c772fe34de0c494664227e892b998387
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "106510209"
---
# <a name="implementing-in-place-activation"></a><span data-ttu-id="e44f1-103">Implémentation de l’activation In-Place</span><span class="sxs-lookup"><span data-stu-id="e44f1-103">Implementing In-Place Activation</span></span>

<span data-ttu-id="e44f1-104">L’activation sur place permet à un utilisateur d’interagir avec un objet incorporé sans quitter le document conteneur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-104">In-place activation enables a user to interact with an embedded object without leaving the container document.</span></span> <span data-ttu-id="e44f1-105">Lorsqu’un utilisateur active l’objet, une *barre de menus composite* comprenant des éléments des barres de menus de l’application de conteneur et de l’application serveur remplace la barre de menus principale du conteneur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-105">When a user activates the object, a *composite menu bar* comprising elements from both the container application's and server application's menu bars replaces the container's main menu bar.</span></span> <span data-ttu-id="e44f1-106">Les commandes et les fonctionnalités des deux applications sont donc disponibles pour l’utilisateur, y compris l’aide contextuelle pour l’objet actif.</span><span class="sxs-lookup"><span data-stu-id="e44f1-106">Commands and features from both applications are thus available to the user, including context sensitive help for the active object.</span></span> <span data-ttu-id="e44f1-107">Lorsqu’un utilisateur commence à travailler avec une partie non-objet du document, l’objet est désactivé, ce qui amène le menu d’origine du document conteneur à remplacer le menu composite.</span><span class="sxs-lookup"><span data-stu-id="e44f1-107">When a user begins working with some non-object portion of the document, the object is deactivated, causing the container document's original menu to replace the composite menu.</span></span>

<span data-ttu-id="e44f1-108">Cette fonctionnalité s’est déroulée à l’origine par le nom de la *modification sur place*.</span><span class="sxs-lookup"><span data-stu-id="e44f1-108">This capability originally went by the name of *in-place editing*.</span></span> <span data-ttu-id="e44f1-109">Le nom a été modifié, car la modification n’est qu’une des méthodes permettant à un utilisateur d’interagir avec un objet en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="e44f1-109">The name was changed because editing is only one way for a user to interact with a running object.</span></span> <span data-ttu-id="e44f1-110">Par exemple, les clips sonores peuvent être écoutés au lieu d’être modifiés.</span><span class="sxs-lookup"><span data-stu-id="e44f1-110">Sound clips, for example, can be listened to instead of editing.</span></span> <span data-ttu-id="e44f1-111">Les clips vidéo peuvent être affichés au lieu d’être modifiés.</span><span class="sxs-lookup"><span data-stu-id="e44f1-111">Video clips can be viewed instead of editing.</span></span> <span data-ttu-id="e44f1-112">L’activation sur place est particulièrement prévue dans le cas de clips vidéo, car elle leur permet de s’exécuter en place, sans appeler une fenêtre distincte.</span><span class="sxs-lookup"><span data-stu-id="e44f1-112">In-place activation is particularly apt in the case of video clips because it allows them to run in place, without calling up a separate window.</span></span> <span data-ttu-id="e44f1-113">Cela peut être critique si la vidéo devait être affichée, par exemple avec des données texte adjacentes dans le document conteneur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-113">This could be critical if the video were to be viewed, say, in conjunction with adjacent text data in the container document.</span></span>

<span data-ttu-id="e44f1-114">L’implémentation de l’activation sur place est strictement facultative pour les applications conteneur et serveur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-114">Implementing in-place activation is strictly optional for both container and server applications.</span></span> <span data-ttu-id="e44f1-115">OLE prend toujours en charge le modèle dans lequel l’activation d’un objet entraîne l’ouverture d’une fenêtre distincte par l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-115">OLE still supports the model in which activating an object causes the server application to open a separate window.</span></span> <span data-ttu-id="e44f1-116">Les objets liés s’ouvrent toujours dans une fenêtre distincte pour souligner qu’ils se trouvent dans un document distinct.</span><span class="sxs-lookup"><span data-stu-id="e44f1-116">Linked objects always open in a separate window to emphasize that they reside in a separate document.</span></span>

<span data-ttu-id="e44f1-117">L’activation sur place commence par l’objet en réponse à un appel à [**IOleObject ::D overb**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) à partir de son conteneur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-117">In-place activation begins with the object in response to an [**IOleObject::DoVerb**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) call from its container.</span></span> <span data-ttu-id="e44f1-118">Cet appel se produit généralement en réponse à un utilisateur qui double-clique sur l’objet ou sélectionne une commande (verbe) dans le menu Edition de l’application conteneur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-118">This call usually happens in response to a user double-clicking the object or selecting a command (verb) from the container application's Edit menu.</span></span>

<span data-ttu-id="e44f1-119">La fenêtre sur place reçoit l’entrée du clavier et de la souris pendant que l’objet incorporé est actif.</span><span class="sxs-lookup"><span data-stu-id="e44f1-119">The in-place window receives keyboard and mouse input while the embedded object is active.</span></span> <span data-ttu-id="e44f1-120">Quand un utilisateur sélectionne des commandes à partir de la barre de menus composite, la commande et les messages de menu associés sont envoyés à l’application conteneur ou objet, en fonction de l’élément qui possède le menu déroulant particulier sélectionné.</span><span class="sxs-lookup"><span data-stu-id="e44f1-120">When a user selects commands from the composite menu bar, the command and associated menu messages are sent to the container or object application, depending on which owns the particular drop-down menu selected.</span></span> <span data-ttu-id="e44f1-121">Les entrées à l’aide des règles, des barres d’outils ou des ornements de cadre d’un objet accèdent directement à l’objet incorporé, qui possède ces fenêtres.</span><span class="sxs-lookup"><span data-stu-id="e44f1-121">Input by means of an object's rulers, toolbars, or frame adornments go directly to the embedded object, which owns these windows.</span></span>

<span data-ttu-id="e44f1-122">Un objet incorporé activé sur place reste actif jusqu’à ce que le conteneur le désactive en réponse à l’entrée utilisateur ou que l’objet abandonne volontairement l’état actif, comme un clip vidéo peut le faire, par exemple.</span><span class="sxs-lookup"><span data-stu-id="e44f1-122">An in-place-activated embedded object remains active until either the container deactivates it in response to user input or the object voluntarily gives up the active state, as a video clip might do, for example.</span></span> <span data-ttu-id="e44f1-123">Un utilisateur peut désactiver un objet en cliquant dans le document conteneur, mais en dehors de la fenêtre d’activation sur place de l’objet, ou simplement en cliquant sur un autre objet.</span><span class="sxs-lookup"><span data-stu-id="e44f1-123">A user can deactivate an object by clicking inside the container document but outside the object's in-place-activation window, or simply by clicking another object.</span></span> <span data-ttu-id="e44f1-124">Toutefois, un objet activé sur place reste actif si l’utilisateur clique sur la barre de titre du conteneur, sur la barre de défilement ou, en particulier, sur la barre de menus.</span><span class="sxs-lookup"><span data-stu-id="e44f1-124">An in-place-activated object remains active, however, if the user clicks the container's title bar, scroll bar or, in particular, menu bar.</span></span>

<span data-ttu-id="e44f1-125">Vous pouvez implémenter un serveur d’objets d’activation en place en tant que serveur in-process (DLL) ou serveur local (EXE).</span><span class="sxs-lookup"><span data-stu-id="e44f1-125">You can implement an in-place-activation-object server either as an in-process server (DLL) or a local server (EXE).</span></span> <span data-ttu-id="e44f1-126">Dans les deux cas, la barre de menus composite contient des éléments (généralement des menus déroulants) des processus serveur et conteneur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-126">In both cases, the composite menu bar contains items (typically drop-down menus) from both the server and container processes.</span></span> <span data-ttu-id="e44f1-127">Dans le cas d’un serveur in-process, la fenêtre d’activation sur place est simplement une autre fenêtre enfant dans la hiérarchie de fenêtre du conteneur, en recevant son entrée via la pompe de messages de l’application conteneur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-127">In the case of a in-process server, the in-place activation window is simply another child window in the container's window hierarchy, receiving its input through the container application's message pump.</span></span>

<span data-ttu-id="e44f1-128">Dans le cas d’un serveur local, la fenêtre d’activation sur place appartient au processus d’application serveur de l’objet incorporé, mais sa fenêtre parente appartient au conteneur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-128">In the case of a local server, the in-place activation window belongs to the embedded object's server application process, but its parent window belongs to the container.</span></span> <span data-ttu-id="e44f1-129">L’entrée de la fenêtre d’activation sur place apparaît dans la file d’attente de messages du serveur et est distribuée par la boucle de message du serveur.</span><span class="sxs-lookup"><span data-stu-id="e44f1-129">Input for the in-place-activation window appears in the server's message queue and is dispatched by the server's message loop.</span></span> <span data-ttu-id="e44f1-130">Les bibliothèques OLE sont chargées de s’y voir que les commandes de menu et les messages sont distribués correctement.</span><span class="sxs-lookup"><span data-stu-id="e44f1-130">The OLE libraries are responsible for seeing to it that menu commands and messages are dispatched correctly.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e44f1-131">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e44f1-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e44f1-132">Documents composés</span><span class="sxs-lookup"><span data-stu-id="e44f1-132">Compound Documents</span></span>](compound-documents.md)
</dt> </dl>

 

 




