---
title: Événements de contrôle (COM)
description: En plus de fournir des propriétés et des méthodes, un contrôle fournit également des interfaces sortantes pour notifier son client d’événements.
ms.assetid: e7085bc0-c087-4cc8-9c69-ba05b0923b74
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1833e1396847e09366d1e06193196cfcf981d330
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/10/2020
ms.locfileid: "104032211"
---
# <a name="control-events-com"></a><span data-ttu-id="201ba-103">Événements de contrôle (COM)</span><span class="sxs-lookup"><span data-stu-id="201ba-103">Control Events (COM)</span></span>

<span data-ttu-id="201ba-104">En plus de fournir des propriétés et des méthodes, un contrôle fournit également des interfaces sortantes pour notifier son client d’événements.</span><span class="sxs-lookup"><span data-stu-id="201ba-104">In addition to providing properties and methods, a control also provides outgoing interfaces to notify its client of events.</span></span> <span data-ttu-id="201ba-105">Le client doit prendre en charge la gestion de ces événements.</span><span class="sxs-lookup"><span data-stu-id="201ba-105">The client must support handling of these events.</span></span> <span data-ttu-id="201ba-106">Pour plus d’informations sur le fonctionnement des objets connectables, consultez [événements dans com et objets connectables](events-in-com-and-connectable-objects.md) .</span><span class="sxs-lookup"><span data-stu-id="201ba-106">See [Events in COM and Connectable Objects](events-in-com-and-connectable-objects.md) for more information on how connectable objects work.</span></span>

<span data-ttu-id="201ba-107">Un contrôle peut prendre en charge différentes interfaces sortantes à des fins différentes.</span><span class="sxs-lookup"><span data-stu-id="201ba-107">A control can support different outgoing interfaces for different purposes.</span></span> <span data-ttu-id="201ba-108">Toutes les interfaces sortantes sont marquées comme des interfaces sources dans les informations de type du contrôle, mais une seule est marquée default pour indiquer qu’il s’agit de l’interface sortante principale.</span><span class="sxs-lookup"><span data-stu-id="201ba-108">All outgoing interfaces are marked as source interfaces in the control's type information, but only one is marked default to indicate that it is the primary outgoing interface.</span></span>

<span data-ttu-id="201ba-109">Un conteneur peut prendre en charge une ou plusieurs des interfaces sortantes définies par un contrôle.</span><span class="sxs-lookup"><span data-stu-id="201ba-109">A container can support one or more of the outgoing interfaces defined by a control.</span></span> <span data-ttu-id="201ba-110">Le contrôle doit être préparé à traiter les conteneurs qui fournissent uniquement la prise en charge de certaines de leurs interfaces sortantes.</span><span class="sxs-lookup"><span data-stu-id="201ba-110">The control should be prepared to deal with containers that only provide support for some of their outgoing interfaces.</span></span>

<span data-ttu-id="201ba-111">Les contrôles prennent en charge quatre types d’événements :</span><span class="sxs-lookup"><span data-stu-id="201ba-111">Controls support four kinds of events:</span></span>

-   <span data-ttu-id="201ba-112">Événements de requête.</span><span class="sxs-lookup"><span data-stu-id="201ba-112">Request events.</span></span> <span data-ttu-id="201ba-113">Un contrôle demande à son client l’autorisation d’effectuer une opération en appelant une méthode dans l’interface sortante, déclenchant ainsi un événement de requête.</span><span class="sxs-lookup"><span data-stu-id="201ba-113">A control requests permission from its client to do something by calling a method in the outgoing interface, thus triggering a request event.</span></span> <span data-ttu-id="201ba-114">Le client signale le contrôle par le biais d’un paramètre de sortie booléen dans la méthode appelée par le contrôle.</span><span class="sxs-lookup"><span data-stu-id="201ba-114">The client signals the control through a boolean, out-parameter in the method that the control called.</span></span> <span data-ttu-id="201ba-115">Le client peut donc empêcher le contrôle d’exécuter l’action.</span><span class="sxs-lookup"><span data-stu-id="201ba-115">The client can thus prevent the control from performing the action.</span></span>
-   <span data-ttu-id="201ba-116">Avant les événements.</span><span class="sxs-lookup"><span data-stu-id="201ba-116">Before events.</span></span> <span data-ttu-id="201ba-117">Un contrôle avertit son client Hat qu’il va effectuer une opération en appelant une méthode dans l’interface sortante, déclenchant ainsi un événement Before.</span><span class="sxs-lookup"><span data-stu-id="201ba-117">A control notifies its client hat it is going to do something by calling a method in the outgoing interface, thus triggering a before event.</span></span> <span data-ttu-id="201ba-118">Le client n’a pas la possibilité d’empêcher l’action, mais il peut prendre les mesures nécessaires en fonction de l’action qui est sur le lieu de se produire.</span><span class="sxs-lookup"><span data-stu-id="201ba-118">The client does not have the opportunity to prevent the action, but it can take any necessary steps given the action that is about to occur.</span></span>
-   <span data-ttu-id="201ba-119">Événements After.</span><span class="sxs-lookup"><span data-stu-id="201ba-119">After events.</span></span> <span data-ttu-id="201ba-120">Un contrôle notifie à son client qu’il vient d’effectuer une opération en appelant une méthode dans l’interface sortante, déclenchant ainsi un événement after.</span><span class="sxs-lookup"><span data-stu-id="201ba-120">A control notifies its client that it has just done something by calling a method in the outgoing interface, thus triggering an after event.</span></span> <span data-ttu-id="201ba-121">Là encore, le client ne peut pas annuler cette action, mais il peut prendre les mesures nécessaires en fonction de l’action qui s’est produite.</span><span class="sxs-lookup"><span data-stu-id="201ba-121">Again, the client cannot cancel this action, but it can take necessary steps given the action that has occurred.</span></span>
-   <span data-ttu-id="201ba-122">Effectuer des événements.</span><span class="sxs-lookup"><span data-stu-id="201ba-122">Do events.</span></span> <span data-ttu-id="201ba-123">Un contrôle déclenche un événement do pour permettre à son client de remplacer l’action du contrôle et de fournir des actions alternatives ou supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="201ba-123">A control triggers a do event to allow its client to override the control's action and provide some alternative or supplementary actions.</span></span> <span data-ttu-id="201ba-124">En règle générale, la méthode appelée par un contrôle pour un événement do a un certain nombre de paramètres pour négocier avec le client les actions qui se produiront.</span><span class="sxs-lookup"><span data-stu-id="201ba-124">Usually, the method that a control calls for a do event has a number of parameters for negotiating with the client about the actions that will occur.</span></span>

<span data-ttu-id="201ba-125">Les DISPID suivants sont définis pour les événements standard que les contrôles peuvent prendre en charge : Click, DblClick, keyverse, KeyPress, KeyUp, MouseMove, MouseUp et Error.</span><span class="sxs-lookup"><span data-stu-id="201ba-125">The following dispids are defined for standard events that controls can support: Click, DblClick, KeyDown, KeyPress, KeyUp, MouseMove, MouseUp, and Error.</span></span> <span data-ttu-id="201ba-126">Tous ces événements standard ont des valeurs DISPID négatives, indiquant leur état standard.</span><span class="sxs-lookup"><span data-stu-id="201ba-126">All of these standard events have negative DISPID values, indicating their standard status.</span></span>

<span data-ttu-id="201ba-127">La méthode [**IOleControl :: FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) , quand elle est appelée avec la **valeur true**, indique à un contrôle si le conteneur va prendre en charge la gestion des événements du contrôle jusqu’à ce que **FreezeEvents** soit à nouveau appelée avec **false**.</span><span class="sxs-lookup"><span data-stu-id="201ba-127">The [**IOleControl::FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) method, when called with **TRUE**, tells a control whether the container will bother handling events from the control until **FreezeEvents** is again called with **FALSE**.</span></span> <span data-ttu-id="201ba-128">Pendant cette période, le contrôle ne peut pas dépendre du conteneur qui gère réellement les événements.</span><span class="sxs-lookup"><span data-stu-id="201ba-128">During this time control cannot depend on the container actually handling any events.</span></span> <span data-ttu-id="201ba-129">Si un événement doit être géré, le contrôle doit mettre l’événement en file d’attente afin de l’activer quand **FreezeEvents** est appelé avec **false**.</span><span class="sxs-lookup"><span data-stu-id="201ba-129">If an event must be handled, the control should queue the event in order to fire it when **FreezeEvents** is called with **FALSE**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="201ba-130">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="201ba-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="201ba-131">Contrôles ActiveX</span><span class="sxs-lookup"><span data-stu-id="201ba-131">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 




