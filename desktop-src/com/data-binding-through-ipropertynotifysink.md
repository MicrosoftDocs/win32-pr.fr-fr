---
title: Liaison de données via IPropertyNotifySink
description: Liaison de données via IPropertyNotifySink
ms.assetid: 275a84b3-65d8-43de-bfba-72e3e5ee59fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d39c7277d27f0df6c185fc35a926aa98b77b91a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103675709"
---
# <a name="data-binding-through-ipropertynotifysink"></a><span data-ttu-id="a7c70-103">Liaison de données via IPropertyNotifySink</span><span class="sxs-lookup"><span data-stu-id="a7c70-103">Data Binding through IPropertyNotifySink</span></span>

<span data-ttu-id="a7c70-104">Les objets qui prennent en charge des propriétés, par exemple, par le biais d’OLE Automation et de l’interface **IDispatch** , peuvent souhaiter autoriser les clients à être avertis lorsque certaines propriétés changent de valeur.</span><span class="sxs-lookup"><span data-stu-id="a7c70-104">Objects that support properties, for example, through OLE Automation and the **IDispatch** interface, may want to allow clients to be notified when certain properties change value.</span></span> <span data-ttu-id="a7c70-105">Une telle propriété est appelée une propriété pouvant être liée, car les notifications permettent à un client de synchroniser son propre affichage des valeurs de propriété actuelles de l’objet.</span><span class="sxs-lookup"><span data-stu-id="a7c70-105">Such a property is called a bindable property because the notifications allow a client to synchronize its own display of the object's current property values.</span></span> <span data-ttu-id="a7c70-106">En outre, les mêmes objets peuvent permettre à un client de contrôler le moment auquel certaines propriétés peuvent être modifiées.</span><span class="sxs-lookup"><span data-stu-id="a7c70-106">In addition, the same objects may wish to allow a client to control when certain properties are allowed to change.</span></span> <span data-ttu-id="a7c70-107">Ces propriétés sont appelées propriétés de modification de demande.</span><span class="sxs-lookup"><span data-stu-id="a7c70-107">Such properties are called request edit properties.</span></span>

<span data-ttu-id="a7c70-108">[**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) est une interface de notification standard qui prend en charge les propriétés bindables et de modification de requête.</span><span class="sxs-lookup"><span data-stu-id="a7c70-108">The [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) is a standard notification interface that supports bindable and request-edit properties.</span></span> <span data-ttu-id="a7c70-109">**IPropertyNotifySink** est pris en charge à partir d’un objet avec des propriétés en tant qu’interface sortante.</span><span class="sxs-lookup"><span data-stu-id="a7c70-109">**IPropertyNotifySink** is supported from an object with properties as an outgoing interface.</span></span> <span data-ttu-id="a7c70-110">Autrement dit, l’interface elle-même est implémentée par l’objet récepteur d’un client, et le client connecte le récepteur à l’objet de prise en charge via le mécanisme de point de connexion décrit précédemment.</span><span class="sxs-lookup"><span data-stu-id="a7c70-110">That is, the interface itself is implemented by a client's sink object, and the client connects the sink to the supporting object through the connection point mechanism described earlier.</span></span> <span data-ttu-id="a7c70-111">**IPropertyNotifySink** est défini comme suit :</span><span class="sxs-lookup"><span data-stu-id="a7c70-111">The **IPropertyNotifySink** is defined as follows:</span></span>

``` syntax
interface IPropertyNotifySink : IUnknown 
  { 
    HRESULT OnChanged([in] DISPID dispID); 
    HRESULT OnRequestEdit([in] DISPID dispID); 
  } 
 
```

<span data-ttu-id="a7c70-112">Lorsqu’un objet souhaite notifier ses récepteurs connectés qu’une propriété pouvant être liée identifiée par un DISPID donné a changé, il appelle [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="a7c70-112">When an object wishes to notify its connected sinks that a bindable property identified with a given DISPID has changed, it calls [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="a7c70-113">Si un objet modifie plusieurs propriétés à la fois, il peut passer DISPID \_ inconnu à **OnChanged** , auquel cas un client actualise son cache de toutes les valeurs de propriété intéressantes.</span><span class="sxs-lookup"><span data-stu-id="a7c70-113">If an object changes multiple properties at once, it can pass DISPID\_UNKNOWN to **OnChanged** in which case a client refreshes its cache of all property values of interest.</span></span>

<span data-ttu-id="a7c70-114">Quand une propriété de modification de requête est sur le paragraphe de changer, un objet peut demander au client s’il autorise la modification.</span><span class="sxs-lookup"><span data-stu-id="a7c70-114">When a request edit property is about to change, an object can ask the client whether it will allow that change to occur.</span></span> <span data-ttu-id="a7c70-115">L’objet appelle [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) en passant le DISPID de la propriété en question (ou DISPID \_ inconnu pour identifier toutes les propriétés).</span><span class="sxs-lookup"><span data-stu-id="a7c70-115">The object calls [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) passing the DISPID of the property in question (or DISPID\_UNKNOWN to identify all properties).</span></span> <span data-ttu-id="a7c70-116">Le récepteur du client retourne la valeur \_ OK pour indiquer que la modification est autorisée ou \_ false (ou une erreur) pour indiquer que la modification n’est pas autorisée.</span><span class="sxs-lookup"><span data-stu-id="a7c70-116">The client's sink returns S\_OK to indicate that the change is allowed, or S\_FALSE (or an error) to indicate that change is not allowed.</span></span> <span data-ttu-id="a7c70-117">Quand un objet appelle **OnRequestEdit**, il doit respecter les souhaits du client en suivant la sémantique exacte des valeurs de retour de s \_ OK et s \_ false.</span><span class="sxs-lookup"><span data-stu-id="a7c70-117">When an object calls **OnRequestEdit**, it is required to obey the client's wishes by following the exact semantics of S\_OK and S\_FALSE return values.</span></span>

<span data-ttu-id="a7c70-118">Notez que [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) ne peut pas être utilisé pour la validation des données, car au moment de l’appel, la nouvelle valeur de la propriété n’est pas encore disponible.</span><span class="sxs-lookup"><span data-stu-id="a7c70-118">Note that [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) cannot be used for data validation because at the time of the call, the new value of the property is not yet available.</span></span> <span data-ttu-id="a7c70-119">La notification ne peut être utilisée que pour contrôler un État en lecture seule pour une propriété.</span><span class="sxs-lookup"><span data-stu-id="a7c70-119">The notification can only be used to control a read-only state for a property.</span></span>

<span data-ttu-id="a7c70-120">Les objets contrôlent les propriétés qui peuvent être liées et demandent la modification et marquent ces propriétés dans les informations de type de l’objet.</span><span class="sxs-lookup"><span data-stu-id="a7c70-120">Objects control which properties are bindable and request edit and mark such properties in the object's type information.</span></span> <span data-ttu-id="a7c70-121">Dans les informations de type, l’attribut pouvant être lié marque une propriété comme prenant en charge [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="a7c70-121">In the type information, the attribute bindable marks a property as supporting [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="a7c70-122">L’attribut modification marque une propriété en tant que [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit)de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="a7c70-122">The attribute requestedit marks a property as supporting [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span></span>

<span data-ttu-id="a7c70-123">Une propriété peut prendre en charge les deux comportements, dans lesquels cas [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) est appelé en premier, et uniquement si la modification est autorisée est [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) appelée.</span><span class="sxs-lookup"><span data-stu-id="a7c70-123">One property can support both behaviors in which case [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) is called first, and only if change is allowed is [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) called.</span></span>

<span data-ttu-id="a7c70-124">La seule exception au comportement de telles propriétés est qu’aucune notification n’est envoyée à la suite des procédures d’initialisation ou de chargement d’un objet.</span><span class="sxs-lookup"><span data-stu-id="a7c70-124">The one exception to the behavior of such properties is that no notifications are sent as a result of an object's initialization or loading procedures.</span></span> <span data-ttu-id="a7c70-125">À ce moment-là, il est supposé que toutes les propriétés changent et que toutes les modifications doivent être autorisées.</span><span class="sxs-lookup"><span data-stu-id="a7c70-125">At such times, it is assumed that all properties change and that all must be allowed to change.</span></span> <span data-ttu-id="a7c70-126">Les notifications à cette interface sont par conséquent uniquement significatives dans le contexte d’un objet entièrement initialisé/chargé.</span><span class="sxs-lookup"><span data-stu-id="a7c70-126">Notifications to this interface are therefore only meaningful in the context of a fully initialized/loaded object.</span></span>

<span data-ttu-id="a7c70-127">Deux autres attributs peuvent être appliqués aux propriétés dans les informations de type d’un objet.</span><span class="sxs-lookup"><span data-stu-id="a7c70-127">Two other attributes can be applied to properties in an object's type information.</span></span> <span data-ttu-id="a7c70-128">L’attribut defaultbind marque une propriété pouvant être liée comme étant celle qui correspond le mieux à l’état de l’objet dans son ensemble.</span><span class="sxs-lookup"><span data-stu-id="a7c70-128">The defaultbind attribute marks a bindable property as being the one that best represents the state of the object as a whole.</span></span> <span data-ttu-id="a7c70-129">L’attribut DisplayBind marque une propriété pouvant être liée comme pouvant être affichée dans l’interface utilisateur d’un client.</span><span class="sxs-lookup"><span data-stu-id="a7c70-129">The displaybind attribute marks a bindable property as suitable for display in a client's own user interface.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a7c70-130">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="a7c70-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a7c70-131">Pages de propriétés et feuilles de propriétés</span><span class="sxs-lookup"><span data-stu-id="a7c70-131">Property Pages and Property Sheets</span></span>](property-pages-and-property-sheets.md)
</dt> </dl>

 

 




