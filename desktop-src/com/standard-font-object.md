---
title: Objet de police standard
description: Objet de police standard
ms.assetid: f9b54dc4-24d4-4eb7-b43f-c481d64e52df
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bd0fbe2509dd85c1d15b40dc8008dba60d948b5c
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104031894"
---
# <a name="standard-font-object"></a><span data-ttu-id="42772-103">Objet de police standard</span><span class="sxs-lookup"><span data-stu-id="42772-103">Standard Font Object</span></span>

<span data-ttu-id="42772-104">La propriété de police ambiante standard fournie par le conteneur et la propriété de police standard fournie par le contrôle fournissent toutes deux un objet de police standard.</span><span class="sxs-lookup"><span data-stu-id="42772-104">The standard ambient font property supplied by the container and the standard font property supplied by the control both provide a standard font object.</span></span> <span data-ttu-id="42772-105">Autrement dit, ces polices standard fournissent un pointeur **IDispatch** vers un objet de police standard.</span><span class="sxs-lookup"><span data-stu-id="42772-105">That is, these standard fonts supply an **IDispatch** pointer to a standard font object.</span></span>

<span data-ttu-id="42772-106">L’objet font est une implémentation fournie par le système d’un ensemble d’interfaces par-dessus la prise en charge des polices GDI sous-jacentes.</span><span class="sxs-lookup"><span data-stu-id="42772-106">The font object is a system-provided implementation of a set of interfaces on top of the underlying GDI font support.</span></span> <span data-ttu-id="42772-107">Un objet de police est créé via la fonction API [**OleCreateFontIndirect**](/windows/desktop/api/OleCtl/nf-olectl-olecreatefontindirect) à partir d’une structure [**fontdesc**](/windows/win32/api/olectl/ns-olectl-fontdesc) .</span><span class="sxs-lookup"><span data-stu-id="42772-107">A font object is created through the API function [**OleCreateFontIndirect**](/windows/desktop/api/OleCtl/nf-olectl-olecreatefontindirect) given a [**FONTDESC**](/windows/win32/api/olectl/ns-olectl-fontdesc) structure.</span></span> <span data-ttu-id="42772-108">L’objet font prend en charge plusieurs propriétés de lecture/écriture, ainsi que des méthodes personnalisées via son [**IFont interface IFont**](/windows/desktop/api/OCIdl/nn-ocidl-ifont), et prend en charge le même jeu de propriétés (mais pas les méthodes) via une [**IFontDisp**](/windows/win32/api/ocidl/nn-ocidl-ifontdisp)dispinterface.</span><span class="sxs-lookup"><span data-stu-id="42772-108">The font object supports a number of read/write properties as well as custom methods through its interface [**IFont**](/windows/desktop/api/OCIdl/nn-ocidl-ifont), and supports the same set of properties (but not the methods) through a dispinterface [**IFontDisp**](/windows/win32/api/ocidl/nn-ocidl-ifontdisp).</span></span> <span data-ttu-id="42772-109">La dispinterface est utilisée pour les propriétés de police mentionnées précédemment.</span><span class="sxs-lookup"><span data-stu-id="42772-109">The dispinterface is used for the font properties mentioned previously.</span></span> <span data-ttu-id="42772-110">Les propriétés correspondent aux attributs de police GDI qui sont décrits dans la structure [**LOGFONT**](/windows/win32/api/dimm/ns-dimm-logfonta) .</span><span class="sxs-lookup"><span data-stu-id="42772-110">The properties correspond to the GDI font attributes that are described in the [**LOGFONT**](/windows/win32/api/dimm/ns-dimm-logfonta) structure.</span></span>

<span data-ttu-id="42772-111">L’objet font prend également en charge l' [**interface de**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) l’interface de sortie, qui permet à un client de déterminer quand les propriétés de police changent.</span><span class="sxs-lookup"><span data-stu-id="42772-111">The font object also supports the outgoing interface [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) so that a client can determine when font properties change.</span></span> <span data-ttu-id="42772-112">Étant donné que l’objet font prend en charge au moins une interface sortante, il implémente également [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) et un point de connexion pour **IPropertyNotifySink** à cet effet.</span><span class="sxs-lookup"><span data-stu-id="42772-112">Since the font object supports at least one outgoing interface, it also implements [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) and one connection point for **IPropertyNotifySink** for this purpose.</span></span>

<span data-ttu-id="42772-113">L’objet font fournit une propriété hFont qui est un handle de police Windows conforme aux autres attributs spécifiés pour la police.</span><span class="sxs-lookup"><span data-stu-id="42772-113">The font object provides an hFont property that is a Windows font handle that conforms to the other attributes specified for the font.</span></span> <span data-ttu-id="42772-114">L’objet font retarde la réalisation de cette police dans la mesure du possible. par conséquent, la définition consécutive de deux propriétés sur une police n’entraîne pas la mise en place d’une police intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="42772-114">The font object delays realizing this font when possible, so consecutively setting two properties on a font won't cause an intermediate font to be realized.</span></span> <span data-ttu-id="42772-115">En outre, en tant qu’optimisation, l’objet de police standard gère un cache de poignées de police.</span><span class="sxs-lookup"><span data-stu-id="42772-115">In addition, as an optimization, the standard font object maintains a cache of font handles.</span></span> <span data-ttu-id="42772-116">Deux objets de police dans le même processus qui ont des propriétés identiques retournent le même descripteur de police.</span><span class="sxs-lookup"><span data-stu-id="42772-116">Two font objects in the same process that have identical properties will return the same font handle.</span></span> <span data-ttu-id="42772-117">L’objet de police peut supprimer des polices de ce cache à la place, ce qui présente des considérations spéciales pour les clients qui utilisent cette propriété hFont.</span><span class="sxs-lookup"><span data-stu-id="42772-117">The font object can remove fonts from this cache at will, which introduces special considerations for clients using this hFont property.</span></span> <span data-ttu-id="42772-118">Pour plus d’informations, consultez [**IFont :: obtenir \_ Hfont**](/windows/desktop/api/OCIdl/nf-ocidl-ifont-get_hfont) .</span><span class="sxs-lookup"><span data-stu-id="42772-118">See [**IFont::get\_hFont**](/windows/desktop/api/OCIdl/nf-ocidl-ifont-get_hfont) for more details.</span></span>

<span data-ttu-id="42772-119">L’objet de police prend également en charge [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) , de sorte qu’il peut s’enregistrer et se charger à partir d’une instance de [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span><span class="sxs-lookup"><span data-stu-id="42772-119">The font object also supports [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) such that it can save and load itself from an instance of [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span> <span data-ttu-id="42772-120">Tout autre objet qui utilise un objet font en interne enregistre et charge la police dans le cadre de la gestion de la persistance de l’objet.</span><span class="sxs-lookup"><span data-stu-id="42772-120">Any other object that uses a font object internally would normally save and load the font as part of the object's own persistence handling.</span></span>

<span data-ttu-id="42772-121">En outre, l’objet font prend en charge [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) par le biais duquel il fournit un jeu de propriétés contenant des valeurs typées pour chaque propriété font.</span><span class="sxs-lookup"><span data-stu-id="42772-121">In addition, the font object supports [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) through which it provides a property set containing typed values for each font property.</span></span>

## <a name="related-topics"></a><span data-ttu-id="42772-122">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="42772-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="42772-123">Propriétés du contrôle</span><span class="sxs-lookup"><span data-stu-id="42772-123">Control Properties</span></span>](control-properties.md)
</dt> </dl>

 

 