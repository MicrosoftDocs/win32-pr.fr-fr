---
title: Vue d’ensemble des instructions relatives aux conteneurs de contrôle et de contrôle
description: Vue d’ensemble des instructions relatives aux conteneurs de contrôle et de contrôle
ms.assetid: c4cf2409-0085-43e6-afa2-f9c03cc50565
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fd72851775898f4fd140c7d101d72993c34e3eb
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/29/2020
ms.locfileid: "103679566"
---
# <a name="overview-of-control-and-control-container-guidelines"></a><span data-ttu-id="a7a3d-103">Vue d’ensemble des instructions relatives aux conteneurs de contrôle et de contrôle</span><span class="sxs-lookup"><span data-stu-id="a7a3d-103">Overview of Control and Control Container Guidelines</span></span>

<span data-ttu-id="a7a3d-104">Un contrôle ActiveX est essentiellement un objet OLE simple qui prend en charge l’interface [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="a7a3d-104">An ActiveX control is essentially a simple OLE object that supports the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="a7a3d-105">Il prend généralement en charge davantage d’interfaces pour offrir des fonctionnalités, mais toutes les interfaces supplémentaires peuvent être affichées comme facultatives et, par conséquent, un conteneur de contrôle ne doit pas reposer sur les interfaces supplémentaires prises en charge.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-105">It will usually support more interfaces in order to offer functionality, but all additional interfaces may be viewed as optional and as such, a control container should not rely on any additional interfaces being supported.</span></span> <span data-ttu-id="a7a3d-106">En ne spécifiant pas d’interfaces supplémentaires qu’un contrôle doit prendre en charge, un contrôle peut cibler efficacement une zone de fonctionnalités particulière sans avoir à prendre en charge des interfaces particulières pour qualifier comme contrôle.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-106">By not specifying additional interfaces that a control must support, a control may efficiently target a particular area of functionality without having to support particular interfaces to qualify as a control.</span></span> <span data-ttu-id="a7a3d-107">Comme toujours avec OLE, qu’il s’agisse d’un contrôle ou d’un conteneur de contrôle, il ne doit jamais être supposé qu’une interface est disponible et que les conventions de vérification de retour standard doivent toujours être suivies.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-107">As always with OLE, whether in a control or a control container, it should never be assumed that an interface is available and standard return-checking conventions should always be followed.</span></span> <span data-ttu-id="a7a3d-108">Il est important pour un conteneur de contrôle ou de contrôle de se dégrader normalement et d’offrir d’autres fonctionnalités si une interface requise n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-108">It is important for a control or control container to degrade gracefully and offer alternative functionality if an interface required is not available.</span></span>

<span data-ttu-id="a7a3d-109">Un conteneur de contrôles ActiveX doit pouvoir héberger un contrôle ActiveX minimal. Il prend également en charge un certain nombre d’interfaces supplémentaires, comme spécifié dans les [conteneurs](containers.md).</span><span class="sxs-lookup"><span data-stu-id="a7a3d-109">An ActiveX control container must be able to host a minimal ActiveX control; it will also support a number of additional interfaces as specified in [Containers](containers.md).</span></span> <span data-ttu-id="a7a3d-110">Un conteneur peut éventuellement prendre en charge un certain nombre d’interfaces et de méthodes, regroupées dans des domaines fonctionnels appelés *catégories de composants*.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-110">There are a number of interfaces and methods that a container may optionally support, which are grouped into functional areas known as *component categories*.</span></span> <span data-ttu-id="a7a3d-111">Un conteneur peut prendre en charge n’importe quelle combinaison de catégories de composants, par exemple, une catégorie de composant existe pour la liaison de liaison et un conteneur peut ou non prendre en charge la fonctionnalité de liaison de liaison, en fonction des besoins du marché du conteneur.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-111">A container may support any combination of component categories, for example, a component category exists for databinding and a container may or may not support the databinding functionality, depending on the market needs of the container.</span></span> <span data-ttu-id="a7a3d-112">Si un contrôle a besoin de la prise en charge de la liaison de liaison d’un conteneur pour fonctionner, il entre dans le registre.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-112">If a control needs databinding support from a container to function, then it will enter this requirement in the registry.</span></span> <span data-ttu-id="a7a3d-113">Cela permet à un conteneur de contrôle d’insérer uniquement les contrôles qu’il sait qu’il peut héberger avec succès.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-113">This allows a control container to only offer for insertion those controls that it knows it can successfully host.</span></span> <span data-ttu-id="a7a3d-114">Il est important de noter que les catégories de composants sont spécifiées dans le cadre d’OLE et ne sont pas spécifiques aux contrôles ActiveX. l’architecture des contrôles utilise des catégories de composants pour identifier les zones de fonctionnalité qu’un composant OLE peut prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-114">It is important to note that component categories are specified as part of OLE and are not specific to ActiveX controls, the controls architecture uses component categories to identify areas of functionality that an OLE component may support.</span></span> <span data-ttu-id="a7a3d-115">Les catégories de composants ne sont pas cumulatives ou exclusives, donc un conteneur de contrôle peut prendre en charge une catégorie sans nécessairement en prendre en charge une autre.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-115">Component categories are not cumulative or exclusive, so a control container can support one category without necessarily supporting another.</span></span>

<span data-ttu-id="a7a3d-116">Il est important pour les contrôles qui nécessitent des fonctionnalités facultatives, ou les fonctionnalités spécifiques à un certain conteneur d’être clairement empaquetées et commercialisées avec ces exigences.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-116">It is important for controls that require optional features, or features specific to a certain container to be clearly packaged and marketed with those requirements.</span></span> <span data-ttu-id="a7a3d-117">De même, les conteneurs qui offrent certaines fonctionnalités ou catégories de composants doivent être commercialisés et empaquetés pour offrir ces niveaux de prise en charge lors de l’hébergement de contrôles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-117">Similarly containers that offer certain features or component categories must be marketed and packaged as offering those levels of support when hosting ActiveX controls.</span></span> <span data-ttu-id="a7a3d-118">Il est recommandé que les contrôles ciblent et testent avec autant de conteneurs que possible et se dégradent harmonieusement pour offrir des fonctionnalités moins nombreuses ou alternatives si les interfaces ou les méthodes ne sont pas disponibles.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-118">It is recommended that controls target and test with as many containers as possible and degrade gracefully to offer less or alternative functionality if interfaces or methods are not available.</span></span> <span data-ttu-id="a7a3d-119">Dans le cas où un contrôle ne peut pas exécuter sa fonction de travail désignée sans la prise en charge d’une catégorie de composant, cette catégorie doit être entrée en tant qu’exigence dans le registre afin d’empêcher l’insertion du contrôle dans un conteneur inapproprié.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-119">In a situation where a control cannot perform its designated job function without the support of a component category, that category should be entered as a requirement in the registry in order to prevent the control being inserted in an inappropriate container.</span></span>

<span data-ttu-id="a7a3d-120">Ces instructions définissent les interfaces et les méthodes qu’un contrôle peut s’attendre à ce qu’un conteneur de contrôle prenne en charge, même si le contrôle doit toujours vérifier les valeurs de retour lors de l’utilisation de [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) ou d’autres méthodes pour obtenir des pointeurs vers ces interfaces.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-120">These guidelines define those interfaces and methods that a control may expect a control container to support, although as always a control should check the return values when using [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) or other methods to obtain pointers to these interfaces.</span></span> <span data-ttu-id="a7a3d-121">Un conteneur ne doit pas s’attendre à ce qu’un contrôle prenne en charge quelque chose d’autre que l’interface [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , et ces instructions identifient les interfaces qu’un contrôle peut prendre en charge et ce que signifie la présence d’une interface particulière.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-121">A container should not expect a control to support anything more than the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface, and these guidelines identify what interfaces a control may support and what the presence of a particular interface means.</span></span>

## <a name="why-the-activex-control-and-control-container-guidelines-are-important"></a><span data-ttu-id="a7a3d-122">Pourquoi les directives de contrôle ActiveX et de conteneur de contrôle sont-elles importantes ?</span><span class="sxs-lookup"><span data-stu-id="a7a3d-122">Why the ActiveX Control and Control Container Guidelines Are Important</span></span>

<span data-ttu-id="a7a3d-123">Les contrôles ActiveX sont devenus l’architecture principale permettant de développer des composants logiciels programmables pour une utilisation dans différents conteneurs, allant des outils de développement de logiciels aux outils de productivité des utilisateurs finaux.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-123">ActiveX Controls have become the primary architecture for developing programmable software components for use in a variety of different containers ranging from software development tools to end-user productivity tools.</span></span> <span data-ttu-id="a7a3d-124">Pour qu’un contrôle fonctionne correctement dans un grand nombre de conteneurs, le contrôle doit être en mesure de prendre en compte certains niveaux de fonctionnalités minimum sur lesquels il peut reposer dans tous les conteneurs.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-124">In order for a control to operate well in a variety of containers, the control must be able to assume some minimum level of functionality that it can rely on in all containers.</span></span>

<span data-ttu-id="a7a3d-125">En suivant ces directives, les développeurs de contrôle et de conteneur rendent leurs contrôles et leurs conteneurs plus fiables et interopérables, et finalement, de meilleurs et plus de composants utilisables pour la création de solutions basées sur des composants.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-125">By following these guidelines, control and container developers make their controls and containers more reliable and interoperable, and ultimately, better and more usable components for building component-based solutions.</span></span>

## <a name="what-to-do-when-an-interface-you-need-is-not-available"></a><span data-ttu-id="a7a3d-126">Que faire quand une interface dont vous avez besoin n’est pas disponible</span><span class="sxs-lookup"><span data-stu-id="a7a3d-126">What to Do When an Interface You Need Is Not Available</span></span>

<span data-ttu-id="a7a3d-127">Les programmes OLE doivent utiliser [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) pour acquérir des pointeurs d’interface et doivent vérifier la valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-127">OLE programs should use [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) to acquire interface pointers, and must check the return value.</span></span> <span data-ttu-id="a7a3d-128">Les applications OLE ne peuvent pas supposer en toute sécurité que **QueryInterface** fonctionnera correctement.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-128">OLE applications cannot safely assume that **QueryInterface** will succeed.</span></span>

<span data-ttu-id="a7a3d-129">Cette exigence s’applique à toutes les applications OLE.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-129">This requirement applies to all OLE applications.</span></span> <span data-ttu-id="a7a3d-130">Si l’interface demandée n’est pas disponible (autrement dit, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) retourne E \_ nointerface), le contrôle ou le conteneur doit se dégrader normalement, même si cela signifie qu’il ne peut pas exécuter sa fonction de tâche désignée.</span><span class="sxs-lookup"><span data-stu-id="a7a3d-130">If the requested interface is not available (that is, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) returns E\_NOINTERFACE), the control or container must degrade gracefully, even if that means that it cannot perform its designated job function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a7a3d-131">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="a7a3d-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a7a3d-132">Instructions relatives au contrôle ActiveX et au conteneur de contrôles</span><span class="sxs-lookup"><span data-stu-id="a7a3d-132">ActiveX Control and Control Container Guidelines</span></span>](activex-control-and-control-container-guidelines.md)
</dt> </dl>

 

 




