---
title: Monikers composites
description: L’une des fonctionnalités les plus utiles des monikers est que vous pouvez concaténer ou composer des monikers ensemble.
ms.assetid: ea2453f3-7a64-4ce0-87c2-de6224ca71df
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5b5375bb505ff3737fb4e0cdea894790d93c0051
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103675717"
---
# <a name="composite-monikers"></a><span data-ttu-id="7545b-103">Monikers composites</span><span class="sxs-lookup"><span data-stu-id="7545b-103">Composite Monikers</span></span>

<span data-ttu-id="7545b-104">L’une des fonctionnalités les plus utiles des monikers est que vous pouvez concaténer ou composer des monikers ensemble.</span><span class="sxs-lookup"><span data-stu-id="7545b-104">One of the most useful features of monikers is that you can concatenate or compose monikers together.</span></span> <span data-ttu-id="7545b-105">Un *moniker composite* est un moniker qui est une composition d’autres monikers et peut déterminer la relation entre les parties.</span><span class="sxs-lookup"><span data-stu-id="7545b-105">A *composite moniker* is a moniker that is a composition of other monikers and can determine the relation between the parts.</span></span> <span data-ttu-id="7545b-106">Cela vous permet d’assembler le chemin d’accès complet à un objet en fonction de deux monikers ou plus qui sont l’équivalent de chemins d’accès partiels.</span><span class="sxs-lookup"><span data-stu-id="7545b-106">This lets you assemble the complete path to an object given two or more monikers that are the equivalent of partial paths.</span></span> <span data-ttu-id="7545b-107">Vous pouvez composer des monikers de la même classe (tels que deux monikers de fichier) ou de classes différentes (comme un moniker de fichier et un moniker d’élément).</span><span class="sxs-lookup"><span data-stu-id="7545b-107">You can compose monikers of the same class (such as two file monikers) or of different classes (such as a file moniker and an item moniker).</span></span> <span data-ttu-id="7545b-108">Si vous deviez écrire votre propre classe moniker, vous pouvez également composer vos monikers avec des monikers de fichier ou d’élément.</span><span class="sxs-lookup"><span data-stu-id="7545b-108">If you were to write your own moniker class, you could also compose your monikers with file or item monikers.</span></span> <span data-ttu-id="7545b-109">L’avantage fondamental d’un composite est qu’il vous donne un morceau de code pour implémenter chaque moniker possible qui est une combinaison de monikers plus simples.</span><span class="sxs-lookup"><span data-stu-id="7545b-109">The basic advantage of a composite is that it gives you one piece of code to implement every possible moniker that is a combination of simpler monikers.</span></span> <span data-ttu-id="7545b-110">Cela réduit considérablement le besoin de classes de moniker personnalisées spécifiques.</span><span class="sxs-lookup"><span data-stu-id="7545b-110">That significantly reduces the need for specific custom moniker classes.</span></span>

<span data-ttu-id="7545b-111">Étant donné que les monikers de différentes classes peuvent être composés les uns avec les autres, les monikers offrent la possibilité de joindre plusieurs espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="7545b-111">Because monikers of different classes can be composed with one another, monikers provide the ability to join multiple namespaces.</span></span> <span data-ttu-id="7545b-112">Le système de fichiers définit un espace de noms commun pour les objets stockés sous forme de fichiers, car toutes les applications comprennent un nom de chemin d’accès du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="7545b-112">The file system defines a common namespace for objects stored as files because all applications understand a file system path name.</span></span> <span data-ttu-id="7545b-113">De même, un objet conteneur définit également un espace de noms privé pour les objets qu’il contient, car aucun conteneur ne comprend les noms générés par un autre conteneur.</span><span class="sxs-lookup"><span data-stu-id="7545b-113">Similarly, a container object also defines a private namespace for the objects that it contains because no container understands the names generated by another container.</span></span> <span data-ttu-id="7545b-114">Les monikers autorisent la jointure de ces espaces de noms, car les monikers de fichiers et les monikers d’élément peuvent être composés.</span><span class="sxs-lookup"><span data-stu-id="7545b-114">Monikers allow these namespaces to be joined because file monikers and item monikers can be composed.</span></span> <span data-ttu-id="7545b-115">Un client moniker peut rechercher tous les objets dans l’espace de noms à l’aide d’un mécanisme unique.</span><span class="sxs-lookup"><span data-stu-id="7545b-115">A moniker client can search the namespace for all objects using a single mechanism.</span></span> <span data-ttu-id="7545b-116">Le client appelle simplement [**IMoniker :: BindToObject**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtoobject) sur le moniker et le code du moniker gère le reste.</span><span class="sxs-lookup"><span data-stu-id="7545b-116">The client simply calls [**IMoniker::BindToObject**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtoobject) on the moniker, and the moniker code handles the rest.</span></span> <span data-ttu-id="7545b-117">Un appel à [**IMoniker :: GetDisplayName**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-getdisplayname) sur un composite crée un nom à l’aide de la concaténation de tous les noms d’affichage des monikers individuels.</span><span class="sxs-lookup"><span data-stu-id="7545b-117">A call to [**IMoniker::GetDisplayName**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-getdisplayname) on a composite creates a name using the concatenation of all the individual monikers' display names.</span></span>

<span data-ttu-id="7545b-118">En outre, étant donné que vous pouvez écrire votre propre classe moniker, la composition du moniker vous permet d’ajouter des extensions personnalisées à l’espace de noms pour les objets.</span><span class="sxs-lookup"><span data-stu-id="7545b-118">Furthermore, because you can write your own moniker class, moniker composition allows you to add customized extensions to the namespace for objects.</span></span>

<span data-ttu-id="7545b-119">Parfois, deux monikers de classes spécifiques peuvent être combinés de manière spéciale.</span><span class="sxs-lookup"><span data-stu-id="7545b-119">Sometimes two monikers of specific classes can be combined in a special way.</span></span> <span data-ttu-id="7545b-120">Par exemple, un moniker de fichier représentant un chemin d’accès incomplet et un autre moniker de fichier représentant un chemin d’accès relatif peuvent être combinés pour former un moniker de fichier unique représentant le chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="7545b-120">For example, a file moniker representing an incomplete path and another file moniker representing a relative path can be combined to form a single file moniker representing the complete path.</span></span> <span data-ttu-id="7545b-121">Par exemple, les monikers de fichier « c : \\ Work \\ art » peuvent être composés avec le moniker de fichier relatif «». \\ sauvegarde \\myfile.doc « égal à » c : \\ sauvegarde de travail \\ \\myfile.doc».</span><span class="sxs-lookup"><span data-stu-id="7545b-121">For example, the file monikers "c:\\work\\art" could be composed with the relative file moniker "..\\backup\\myfile.doc" to equal "c:\\work\\backup\\myfile.doc".</span></span> <span data-ttu-id="7545b-122">Il s’agit d’un exemple de *composition non générique*.</span><span class="sxs-lookup"><span data-stu-id="7545b-122">This is an example of *nongeneric composition*.</span></span>

<span data-ttu-id="7545b-123">En revanche, la *composition générique* autorise la connexion de deux monikers, quelle que soit leur classe.</span><span class="sxs-lookup"><span data-stu-id="7545b-123">*Generic composition*, on the other hand, permits the connection of any two monikers, no matter what their classes.</span></span> <span data-ttu-id="7545b-124">Par exemple, vous pouvez composer un moniker d’élément sur un moniker de fichier, bien que ce ne soit pas le cas de l’inverse.</span><span class="sxs-lookup"><span data-stu-id="7545b-124">For example, you could compose an item moniker onto a file moniker, although not, of course, the other way around.</span></span>

<span data-ttu-id="7545b-125">Comme une composition non générique dépend de la classe des monikers impliqués, ses détails sont définis par l’implémentation d’une classe de moniker particulière.</span><span class="sxs-lookup"><span data-stu-id="7545b-125">Because a nongeneric composition depends on the class of the monikers involved, its details are defined by the implementation of a particular moniker class.</span></span> <span data-ttu-id="7545b-126">Vous pouvez définir de nouveaux types de compositions non génériques si vous écrivez une nouvelle classe moniker.</span><span class="sxs-lookup"><span data-stu-id="7545b-126">You can define new types of nongeneric compositions if you write a new moniker class.</span></span> <span data-ttu-id="7545b-127">En revanche, les compositions génériques sont définies par OLE.</span><span class="sxs-lookup"><span data-stu-id="7545b-127">By contrast, generic compositions are defined by OLE.</span></span> <span data-ttu-id="7545b-128">Les monikers créés à la suite d’une composition générique sont appelés monikers composites génériques.</span><span class="sxs-lookup"><span data-stu-id="7545b-128">Monikers created as a result of generic composition are called generic composite monikers.</span></span>

<span data-ttu-id="7545b-129">Ces trois classes, les monikers de fichiers, les monikers d’élément et les monikers composites génériques, fonctionnent ensemble et sont les classes de monikers les plus couramment utilisées.</span><span class="sxs-lookup"><span data-stu-id="7545b-129">These three classes, file monikers, item monikers, and generic composite monikers, all work together, and they are the most commonly used classes of monikers.</span></span>

<span data-ttu-id="7545b-130">Les clients moniker doivent appeler [**IMoniker :: ComposeWith**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-composewith) pour créer un composite sur moniker avec un autre.</span><span class="sxs-lookup"><span data-stu-id="7545b-130">Moniker clients should call [**IMoniker::ComposeWith**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-composewith) to create a composite on moniker with another.</span></span> <span data-ttu-id="7545b-131">Le moniker sur lequel il est appelé détermine en interne s’il peut effectuer une composition générique ou non générique.</span><span class="sxs-lookup"><span data-stu-id="7545b-131">The moniker it is called on internally decides whether it can do a generic or nongeneric composition.</span></span> <span data-ttu-id="7545b-132">Si l’implémentation du moniker détermine qu’une composition générique est utilisable, OLE fournit la fonction [**CreateGenericComposite**](/windows/desktop/api/Objbase/nf-objbase-creategenericcomposite) pour faciliter cette tâche.</span><span class="sxs-lookup"><span data-stu-id="7545b-132">If the moniker implementation determines that a generic composition is usable, OLE provides the [**CreateGenericComposite**](/windows/desktop/api/Objbase/nf-objbase-creategenericcomposite) function to facilitate this.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7545b-133">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="7545b-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7545b-134">Anti-monikers</span><span class="sxs-lookup"><span data-stu-id="7545b-134">Anti-Monikers</span></span>](anti-monikers.md)
</dt> <dt>

[<span data-ttu-id="7545b-135">Monikers de classe</span><span class="sxs-lookup"><span data-stu-id="7545b-135">Class Monikers</span></span>](class-monikers.md)
</dt> <dt>

[<span data-ttu-id="7545b-136">Monikers de fichiers</span><span class="sxs-lookup"><span data-stu-id="7545b-136">File Monikers</span></span>](file-monikers.md)
</dt> <dt>

[<span data-ttu-id="7545b-137">Monikers d’élément</span><span class="sxs-lookup"><span data-stu-id="7545b-137">Item Monikers</span></span>](item-monikers.md)
</dt> <dt>

[<span data-ttu-id="7545b-138">Monikers de pointeur</span><span class="sxs-lookup"><span data-stu-id="7545b-138">Pointer Monikers</span></span>](pointer-monikers.md)
</dt> </dl>

 

 




