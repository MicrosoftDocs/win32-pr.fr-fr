---
title: Conception d’interfaces accessibles à distance
description: Avec l’avènement du modèle d’objet de composant distribué, il est important que votre interface personnalisée soit accessible à distance, même si vous envisagez de l’utiliser uniquement dans le processus.
ms.assetid: 2ee4d950-dfd5-4965-bd77-a600e878be59
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3502604d62e6a5129ca3e3538761722909c0198f
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/29/2020
ms.locfileid: "103841838"
---
# <a name="designing-remotable-interfaces"></a><span data-ttu-id="8e4fc-103">Conception d’interfaces accessibles à distance</span><span class="sxs-lookup"><span data-stu-id="8e4fc-103">Designing Remotable Interfaces</span></span>

<span data-ttu-id="8e4fc-104">Avec l’avènement du modèle d’objet de composant distribué, il est important que votre interface personnalisée soit accessible à distance, même si vous envisagez de l’utiliser uniquement dans le processus.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-104">With the advent of the distributed component object model, it is important that your custom interface be remotable, even if you intend to use it in-process only.</span></span>

<span data-ttu-id="8e4fc-105">MIDL est plus qu’un simple moyen de générer des fichiers d’en-tête pour vos interfaces.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-105">MIDL is more than just a way to generate header files for your interfaces.</span></span> <span data-ttu-id="8e4fc-106">Il s’agit d’un langage de programmation pour la communication à distance qui vous permet d’utiliser vos interfaces à travers les limites des ordinateurs, des processus et des threads.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-106">It is a programming language for remoting that allows you to use your interfaces across machine, process, and thread boundaries.</span></span> <span data-ttu-id="8e4fc-107">Cela signifie que vous devez vérifier le comportement de vos interfaces définies par MIDL dans ces conditions avant de publier votre programme pour les clients.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-107">This means that you need to verify the behavior of your MIDL-defined interfaces under those conditions before you release your program to customers.</span></span> <span data-ttu-id="8e4fc-108">Si vous avez commis une erreur dans votre IDL et que l’interface n’est pas correctement mise à distance, il peut être difficile de remédier à cette erreur.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-108">If you made a mistake in your IDL and the interface is not remoted correctly, it can be difficult to remedy that mistake.</span></span> <span data-ttu-id="8e4fc-109">Vous devez modifier votre interface avec un nouvel IID et conserver l’ancienne dans pour des raisons de compatibilité descendante ou vous devez convertir chaque client et chaque ordinateur serveur en même temps.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-109">Either you have to revise your interface with a new IID and leave the old one in for backward compatibility or you have to convert every client and every server machine everywhere at the same time.</span></span>

<span data-ttu-id="8e4fc-110">Même si votre interface ne sera jamais utilisée hors processus, elle peut être utilisée sur plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-110">Even if your interface will never be used out-of-process, it may be used cross-thread.</span></span> <span data-ttu-id="8e4fc-111">Le pire problème pour un fichier IDL non vérifié peut survenir pour les serveurs in-process qui ne prennent pas en charge plusieurs [threads cloisonnés uniques](single-threaded-apartments.md).</span><span class="sxs-lookup"><span data-stu-id="8e4fc-111">The worst problem for an unchecked IDL file can arise for in-process servers that do not support multiple [single-threaded apartments](single-threaded-apartments.md)).</span></span> <span data-ttu-id="8e4fc-112">Un serveur qui ne spécifie pas de modèle de thread est implicitement monothread.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-112">A server that does not specify a threading model is implicitly single-threaded.</span></span> <span data-ttu-id="8e4fc-113">Tout ce qui est marqué d’un thread unique est forcé sur le thread qui a d’abord appelé [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) ou [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span><span class="sxs-lookup"><span data-stu-id="8e4fc-113">Everything marked single-threaded is forced over to the thread that first called [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span></span> <span data-ttu-id="8e4fc-114">Si un autre thread était celui qui a activé l’objet, toutes les interfaces sur ce serveur à thread unique doivent être retransmises au thread d’activation, ce qui peut entraîner un retour de REGDB \_ E \_ IIDNOTREG en réponse à un appel à [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))).</span><span class="sxs-lookup"><span data-stu-id="8e4fc-114">If some other thread was the one that activated the object, all the interfaces on that single-threaded server must be remoted back to the activating thread, which can result in a return of REGDB\_E\_IIDNOTREG in response to a call to [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))).</span></span> <span data-ttu-id="8e4fc-115">À moins que vous ne puissiez absolument affirmer que votre interface est à la fois en cours de traitement et qu’elle va toujours être appelée sur le même thread, vous obtiendrez à distance à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-115">Unless you can absolutely assert that your interface is both in-process and always going to be called on the same thread, you will get remoted at some time.</span></span>

<span data-ttu-id="8e4fc-116">Enfin, en tant que concepteur d’interface, vous devez prendre en compte la façon dont les applications clientes utiliseront votre interface.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-116">Finally, as an interface designer, you need to consider how client applications will use your interface.</span></span> <span data-ttu-id="8e4fc-117">Deux choses, ensemble, déterminent si une interface est efficace au-delà des limites de processus et de machine : la fréquence des appels de méthode à travers la limite de l’interface et la quantité de données à transférer dans un appel de méthode donné.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-117">Two things, together, determine whether an interface will be efficient across process and machine boundaries: the frequency of method calls across the interface boundary, and the amount of data to be transferred in a given method call.</span></span> <span data-ttu-id="8e4fc-118">Bien que COM rende les appels inter-processus et inter-réseaux transparents pour les programmes, il ne peut pas effectuer d’appels à fréquence élevée et à bande passante élevée efficacement dans les espaces d’adressage.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-118">Although COM makes cross-process and cross-network calls transparent to programs, it cannot make high-frequency and high-bandwidth calls efficient across address spaces.</span></span> <span data-ttu-id="8e4fc-119">Dans certains cas, il est plus approprié de concevoir des interfaces qui sont généralement implémentées uniquement comme serveurs in-process, tandis que les autres interfaces sont plus appropriées pour une utilisation à distance.</span><span class="sxs-lookup"><span data-stu-id="8e4fc-119">In some cases, it is more appropriate to design interfaces that will normally be implemented only as in-process servers while other interfaces are more appropriate for remote use.</span></span>

 

 




