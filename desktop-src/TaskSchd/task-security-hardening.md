---
title: Renforcement de la sécurité des tâches
description: L’utilisation de la fonctionnalité de renforcement de la sécurité des tâches permet aux propriétaires de tâches d’exécuter leurs tâches avec les privilèges minimaux requis.
ms.assetid: ba03add5-aa05-4bef-baec-684ca17363bd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ab70679d605a9ad56c6d26116245ae17d41a7a1
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104196793"
---
# <a name="task-security-hardening"></a><span data-ttu-id="06b8e-103">Renforcement de la sécurité des tâches</span><span class="sxs-lookup"><span data-stu-id="06b8e-103">Task Security Hardening</span></span>

<span data-ttu-id="06b8e-104">L’utilisation de la fonctionnalité de renforcement de la sécurité des tâches permet aux propriétaires de tâches d’exécuter leurs tâches avec les privilèges minimaux requis.</span><span class="sxs-lookup"><span data-stu-id="06b8e-104">Using the tasks security hardening feature will allow task owners to run their tasks with minimum required privileges.</span></span> <span data-ttu-id="06b8e-105">Notez que cette fonctionnalité est activée par défaut et que les propriétaires de tâches peuvent effectuer des ajustements supplémentaires à l’aide du tableau des privilèges de type identificateur de sécurité du jeton de processus de tâche et de la tâche requise.</span><span class="sxs-lookup"><span data-stu-id="06b8e-105">Note that this feature is enabled by default and task owners can make further adjustments by using the task process token security identifier type and task required privileges array.</span></span>

## <a name="task-process-token-sid-type-and-task-required-privileges-array"></a><span data-ttu-id="06b8e-106">Type de SID de jeton de processus de tâche et tableau des privilèges requis</span><span class="sxs-lookup"><span data-stu-id="06b8e-106">Task Process Token SID Type and Task Required Privileges Array</span></span>

<span data-ttu-id="06b8e-107">La spécification de **ProcessTokenSidType** au niveau de la définition de tâche permet aux propriétaires de tâches de demander un processus de tâche à exécuter avec le type de sid « aucun » ou le type de sid « illimité ».</span><span class="sxs-lookup"><span data-stu-id="06b8e-107">Specifying **ProcessTokenSidType** at the task definition level allows task owners to request a task process to run with the "none" SID type or the "unrestricted" SID type.</span></span> <span data-ttu-id="06b8e-108">Si le champ est présent dans la définition de tâche, la validation s’assure que la tâche UserId contient le nom ou la chaîne SID correspondante pour l’un de ces comptes de service intégrés de système d’exploitation : « SERVICE réseau » ou « SERVICE LOCAL ».</span><span class="sxs-lookup"><span data-stu-id="06b8e-108">If the field is present in task definition, validation ensures that task UserId contains the name or the corresponding SID string for one of those operating system built-in service accounts: "NETWORK SERVICE" or "LOCAL SERVICE".</span></span>

<span data-ttu-id="06b8e-109">Le type SID « None » signifie que la tâche s’exécute dans un processus qui ne contient pas de SID de jeton de processus (aucune modification n’est apportée à la liste des groupes de jetons de processus).</span><span class="sxs-lookup"><span data-stu-id="06b8e-109">The SID type "none" means that the task runs in a process that does not contain a process token SID (no changes will be made to the process token groups list).</span></span> <span data-ttu-id="06b8e-110">Dans ce cas, le SID de compte du principal de tâche (LocalService/NetworkService) dispose d’un accès complet au jeton de processus.</span><span class="sxs-lookup"><span data-stu-id="06b8e-110">The task principal account SID (LocalService/NetworkService) in that case has full access to the process token.</span></span>

<span data-ttu-id="06b8e-111">Le type de SID « illimité » signifie qu’un SID de tâche sera dérivé du chemin d’accès complet à la tâche et sera ajouté à la liste des groupes de jetons de processus.</span><span class="sxs-lookup"><span data-stu-id="06b8e-111">The "unrestricted" SID type means that a task SID will be derived from the full task path and will be added to the process token groups list.</span></span> <span data-ttu-id="06b8e-112">Par exemple, le \\ \\ RACTask Microsoft Windows \\ RAC \\ qui s’exécute dans le compte de service local, le SID de tâche est dérivé du nom Microsoft-Windows-RAC-RACTask où « - » remplace « \\ », car «» \\ est un caractère de nom d’utilisateur non valide.</span><span class="sxs-lookup"><span data-stu-id="06b8e-112">For example, the \\Microsoft\\Windows\\RAC\\RACTask which runs in the Local Service account, the task SID is derived from the name Microsoft-Windows-RAC-RACTask where a "-" is substituted for a "\\" since "\\" is an invalid user name character.</span></span> <span data-ttu-id="06b8e-113">Le nom de groupe connu pour le SID de tâche serait « NT TASK \\ <modified full task path> » (NomDomaine \\ nom_utilisateur format).</span><span class="sxs-lookup"><span data-stu-id="06b8e-113">The well known group name for the task SID would be "NT TASK\\<modified full task path>" (domainname\\username format).</span></span> <span data-ttu-id="06b8e-114">La liste de contrôle d’accès discrétionnaire (DACL) par défaut du jeton de processus sera également modifiée pour autoriser le contrôle total du SID de tâche et du SID de système local uniquement et le contrôle de lecture du SID de compte de principal de tâche.</span><span class="sxs-lookup"><span data-stu-id="06b8e-114">The process token default discretionary access control list (DACL) will also be modified to allow full control for the task SID and local system SID only and read control to the task principal account SID.</span></span> <span data-ttu-id="06b8e-115">« schtasks.exe/showsid/TN <full task path> » affiche le SID de tâche correspondant à la tâche.</span><span class="sxs-lookup"><span data-stu-id="06b8e-115">"schtasks.exe /showsid /tn <full task path>" will show the task SID that is corresponding to the task.</span></span>

<span data-ttu-id="06b8e-116">Lorsqu’une action de tâche non COM démarre, le moteur de planification se connecte au compte du principal de tâche, obtient le jeton de processus et interroge la liste des privilèges que le jeton a, puis compare celui-ci à la liste des privilèges spécifiée dans RequiredPrivileges.</span><span class="sxs-lookup"><span data-stu-id="06b8e-116">When a non-COM task action starts up, the scheduling engine logs on the task principal account, gets the process token and queries the list of privileges that the token has and then compares that with the privileges list specified in RequiredPrivileges.</span></span> <span data-ttu-id="06b8e-117">Si aucun privilège n’est spécifié dans le second, alors cela est marqué comme privilège de SE \_ \_ supprimé.</span><span class="sxs-lookup"><span data-stu-id="06b8e-117">If a privilege is not specified in the latter, then that is marked as SE\_PRIVILEGE\_REMOVED.</span></span> <span data-ttu-id="06b8e-118">L’action exécutable est ensuite démarrée avec le handle de jeton résultant à l’aide de l’API CreateProcessAsUser.</span><span class="sxs-lookup"><span data-stu-id="06b8e-118">The executable action will then be started with the resulting token handle by using the CreateProcessAsUser API.</span></span>

<span data-ttu-id="06b8e-119">Lorsqu’une action de tâche COM démarre, elle doit être activée par le processus de taskhost.exe.</span><span class="sxs-lookup"><span data-stu-id="06b8e-119">When a COM task action starts up, it must be activated by the taskhost.exe process.</span></span> <span data-ttu-id="06b8e-120">Le moteur de planification interroge le bloc de contexte de chaque taskhost.exe en cours d’exécution avec le même compte que la tâche de démarrage.</span><span class="sxs-lookup"><span data-stu-id="06b8e-120">The scheduling engine queries the context block of each running taskhost.exe with the same account as the starting task.</span></span> <span data-ttu-id="06b8e-121">S’il détecte qu’un processus hôte a démarré avec un sur-ensemble de privilèges dont la tâche de démarrage a besoin, alors cette tâche est hébergée dans ce processus.</span><span class="sxs-lookup"><span data-stu-id="06b8e-121">If it finds that a host process was started with a superset of privileges that the starting task needs, then that task gets hosted in that process.</span></span> <span data-ttu-id="06b8e-122">S’il ne trouve pas un tel processus, il combine les informations de sécurisation renforcée de toutes les tâches qui s’exécutent dans le TaskHosts sous le compte du principal de la tâche avec le masque RequiredPrivileges spécifié, puis démarre une nouvelle instance de taskhost.exe.</span><span class="sxs-lookup"><span data-stu-id="06b8e-122">If it does not find such a process, it combines the hardening info of all the tasks that are running in the taskhosts under the task principal account with the specified RequiredPrivileges mask and then starts up a new instance of taskhost.exe.</span></span>

<span data-ttu-id="06b8e-123">Si RequiredPrivileges n’est pas présent dans la définition de tâche, les privilèges par défaut du compte de principal de tâche sans le SeImpersonatePrivilege sont utilisés pour le processus de tâche.</span><span class="sxs-lookup"><span data-stu-id="06b8e-123">If RequiredPrivileges is not present in the task definition, the default privileges of task principal account without the SeImpersonatePrivilege will be used for task process.</span></span> <span data-ttu-id="06b8e-124">Si **ProcessTokenSidType** n’est pas présent dans la définition de la tâche, la valeur par défaut est « Unrestricted ».</span><span class="sxs-lookup"><span data-stu-id="06b8e-124">If **ProcessTokenSidType** is not present in the task definition, "unrestricted" is used as the default.</span></span>

## <a name="related-topics"></a><span data-ttu-id="06b8e-125">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="06b8e-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="06b8e-126">Informations d’inscription de la tâche</span><span class="sxs-lookup"><span data-stu-id="06b8e-126">Task Registration Information</span></span>](task-registration-information.md)
</dt> <dt>

[<span data-ttu-id="06b8e-127">À propos de l’Planificateur de tâches</span><span class="sxs-lookup"><span data-stu-id="06b8e-127">About The Task Scheduler</span></span>](about-the-task-scheduler.md)
</dt> <dt>

[<span data-ttu-id="06b8e-128">Contextes de sécurité pour les tâches</span><span class="sxs-lookup"><span data-stu-id="06b8e-128">Security Contexts for Tasks</span></span>](security-contexts-for-running-tasks.md)
</dt> </dl>

 

 




