---
description: La nature interactive de la téléphonie nécessite l’utilisation de l’interface TAPI en temps réel.
ms.assetid: b8512588-ec28-4fbe-b47f-b900e2dba1f2
title: Modèle synchrone/asynchrone
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 02b3d3b58e9704719e502fa3efc11bc4dc216479
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106517067"
---
# <a name="synchronousasynchronous-model"></a><span data-ttu-id="8b80a-103">Modèle synchrone/asynchrone</span><span class="sxs-lookup"><span data-stu-id="8b80a-103">Synchronous/Asynchronous Model</span></span>

<span data-ttu-id="8b80a-104">La nature interactive de la téléphonie nécessite l’utilisation de l’interface TAPI en temps réel.</span><span class="sxs-lookup"><span data-stu-id="8b80a-104">The interactive nature of telephony requires TAPI to be a real-time operating environment.</span></span> <span data-ttu-id="8b80a-105">La plupart des fonctions TAPI sont nécessaires pour se terminer rapidement et retourner leurs résultats à l’application de façon synchrone.</span><span class="sxs-lookup"><span data-stu-id="8b80a-105">Many of the TAPI functions are required to complete quickly and return their results to the application synchronously.</span></span> <span data-ttu-id="8b80a-106">D’autres fonctions (telles que la numérotation) peuvent ne pas pouvoir se terminer aussi rapidement et s’exécuter de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8b80a-106">Other functions (such as dialing) may not be able to complete as quickly and therefore operate asynchronously.</span></span>

<span data-ttu-id="8b80a-107">Les opérations de téléphonie s’effectuent de façon synchrone ou asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8b80a-107">Telephony operations complete either synchronously or asynchronously.</span></span> <span data-ttu-id="8b80a-108">Ces deux modèles diffèrent comme suit.</span><span class="sxs-lookup"><span data-stu-id="8b80a-108">These two models differ as follows.</span></span> <span data-ttu-id="8b80a-109">Les *fonctions synchrones* exécutent la requête entière avant que le thread de l’appelant ne soit autorisé à retourner à partir de l’appel de fonction.</span><span class="sxs-lookup"><span data-stu-id="8b80a-109">*Synchronous functions* execute the entire request before the caller's thread is allowed to return from the function call.</span></span> <span data-ttu-id="8b80a-110">Les *fonctions asynchrones* retournent avant l’exécution de la requête dans son intégralité.</span><span class="sxs-lookup"><span data-stu-id="8b80a-110">*Asynchronous functions* return before the request has executed in its entirety.</span></span> <span data-ttu-id="8b80a-111">Lorsque la requête asynchrone se termine par la suite, le fournisseur de services signale la fin de l’opération en appelant une procédure de rappel que TAPI a initialement fournie au début de la séquence d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="8b80a-111">When the asynchronous request later completes, the service provider reports the completion by calling a callback procedure that TAPI originally supplied to it early in the initialization sequence.</span></span>

-   <span data-ttu-id="8b80a-112">Les opérations asynchrones ont un paramètre nommé *dwRequestID* du type défini [DRV \_ REQUESTID](./drv-requestid.md) comme premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="8b80a-112">Asynchronous operations have a parameter named *dwRequestID* of the defined type [DRV\_REQUESTID](./drv-requestid.md) as their first parameter.</span></span> <span data-ttu-id="8b80a-113">Une telle opération effectue une partie de son traitement dans l’appel de fonction et le reste de son traitement dans un thread d’exécution indépendant après le retour de l’appel de fonction.</span><span class="sxs-lookup"><span data-stu-id="8b80a-113">Such an operation performs part of its processing in the function call and the remainder of its processing in an independent execution thread after the function call has returned.</span></span> <span data-ttu-id="8b80a-114">Quand la fonction retourne, elle retourne soit un résultat d’erreur négatif, soit le *dwRequestID* (positif) qui a été passé dans l’appel de fonction.</span><span class="sxs-lookup"><span data-stu-id="8b80a-114">When the function returns, it returns either a negative error result or the (positive) *dwRequestID* that was passed in the function call.</span></span> <span data-ttu-id="8b80a-115">Le résultat d’erreur négatif indique que l’opération est terminée (et a échoué).</span><span class="sxs-lookup"><span data-stu-id="8b80a-115">The negative error result indicates that the operation is complete (and failed).</span></span> <span data-ttu-id="8b80a-116">Le *dwRequestID* positif retourné indique que l’opération continue dans le thread indépendant.</span><span class="sxs-lookup"><span data-stu-id="8b80a-116">The positive *dwRequestID* returned indicates that the operation continues in the independent thread.</span></span> <span data-ttu-id="8b80a-117">Dans ce cas, le fournisseur de services appelle finalement la procédure d' [**\_ achèvement asynchrone**](/windows/win32/api/tspi/nc-tspi-async_completion) , en transmettant le *dwRequestID* et un code de résultat pour indiquer le résultat de l’opération.</span><span class="sxs-lookup"><span data-stu-id="8b80a-117">In such a case, the service provider eventually calls the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) procedure, passing the *dwRequestID* and a result code to indicate the outcome of the operation.</span></span> <span data-ttu-id="8b80a-118">Le code de résultat est zéro en cas de réussite ou un des mêmes jeux de résultats d’erreur (négatifs).</span><span class="sxs-lookup"><span data-stu-id="8b80a-118">The result code is zero for success or one of the same set of (negative) error results.</span></span> <span data-ttu-id="8b80a-119">Dans tous les cas, le fournisseur de services ne doit jamais retourner zéro ou une valeur positive autre que *dwRequestID* à partir d’une fonction désignée comme asynchrone, car cela peut produire des résultats inattendus.</span><span class="sxs-lookup"><span data-stu-id="8b80a-119">In any case, the service provider must never return zero or any positive value other than *dwRequestID* from a function designated as asynchronous because doing so can produce unexpected results.</span></span> <span data-ttu-id="8b80a-120">Les fournisseurs de services doivent toujours copier les données d’entrée de la mémoire de l’application dans la mémoire du fournisseur de services avant de retourner une fonction asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8b80a-120">Service providers should always copy input data from application memory into service provider memory before returning from an asynchronous function.</span></span>
-   <span data-ttu-id="8b80a-121">Les opérations synchrones n’ont pas *dwRequestID* comme premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="8b80a-121">Synchronous operations do not have *dwRequestID* as their first parameter.</span></span> <span data-ttu-id="8b80a-122">Une telle opération effectue tout son traitement dans le thread d’exécution de l’appelant, en retournant le résultat final lorsqu’elle retourne.</span><span class="sxs-lookup"><span data-stu-id="8b80a-122">Such an operation performs all of its processing in the caller's execution thread, returning the final result when it returns.</span></span> <span data-ttu-id="8b80a-123">Le résultat est zéro en cas de réussite ou un code d’erreur négatif pour l’échec.</span><span class="sxs-lookup"><span data-stu-id="8b80a-123">The result is zero for success or a negative error code for failure.</span></span> <span data-ttu-id="8b80a-124">Le fournisseur de services n’appelle pas la [**\_ saisie semi-automatique asynchrone**](/windows/win32/api/tspi/nc-tspi-async_completion) pour les opérations synchrones.</span><span class="sxs-lookup"><span data-stu-id="8b80a-124">The service provider does not call [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) for synchronous operations.</span></span>

<span data-ttu-id="8b80a-125">Il est intéressant de prendre en compte la synchronisation d’un rappel « d’achèvement » par rapport au moment où la demande d’origine est retournée.</span><span class="sxs-lookup"><span data-stu-id="8b80a-125">It is interesting to consider the timing of a "completion" callback relative to when the original request returns.</span></span> <span data-ttu-id="8b80a-126">Une requête asynchrone classique serait implémentée par le fournisseur de services, comme dans le pseudocode suivant :</span><span class="sxs-lookup"><span data-stu-id="8b80a-126">A typical asynchronous request would be implemented by the service provider as in the following pseudocode:</span></span>

``` syntax
Some_request(Request_ID, ...) {
  check parameters for validity
  check device state for validity
  store Request_ID for Completion Interrupt Handler's use
  manipulate device registers to start physical operation
  return Request_ID  // to indicate asynch operation
}
Operation Completion Interrupt Handler: {
  if operation was successful then
    call "completion" callback passing Request_ID and "success"
  else
    call "completion" callback passing Request_ID and "error num"
  endif
}
```

<span data-ttu-id="8b80a-127">Si l’opération se termine très rapidement (ou si la demande d’origine retourne très lentement), il est possible que le gestionnaire d’interruptions qui s’exécute lorsqu’une opération physique se termine peut être déclenché avant que la demande d’origine ne retourne à l’application ou même à l’interface TAPI.</span><span class="sxs-lookup"><span data-stu-id="8b80a-127">If the operation completes very rapidly (or the original request returns very slowly), it is possible that the interrupt handler that runs when a physical operation completes may be triggered before the original request returns to the application or even to TAPI.</span></span> <span data-ttu-id="8b80a-128">Ce comportement est autorisé.</span><span class="sxs-lookup"><span data-stu-id="8b80a-128">This behavior is allowed.</span></span> <span data-ttu-id="8b80a-129">L’interface TAPI garantit que la notification d’achèvement à l’application est remise après le retour de la requête d’origine.</span><span class="sxs-lookup"><span data-stu-id="8b80a-129">TAPI guarantees that the eventual completion notification to the application is delivered after the original request returns.</span></span>

<span data-ttu-id="8b80a-130">**TAPI 2. x :** Répertorie l’État selon lequel chaque fonction se termine de façon synchrone ou asynchrone dans une [référence de fonction rapide TAPI](./tapi-quick-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="8b80a-130">**TAPI 2.x:** Lists which state whether each function completes synchronously or asynchronously appear in [TAPI Quick Function Reference](./tapi-quick-function-reference.md).</span></span>

 

 
