---
description: Lorsqu’un appel est actif dans LINEBEARERMODE \_ passthrough, le fournisseur de services offre un accès direct au matériel attaché pour le contrôle par l’application.
ms.assetid: 75e31241-c782-4d50-9590-cf68c0505add
title: Mode passthrough
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 985e1caf666fcb3278bacf5c5cfe9d8a4e847dbb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106521430"
---
# <a name="passthrough-mode"></a><span data-ttu-id="43be9-103">Mode passthrough</span><span class="sxs-lookup"><span data-stu-id="43be9-103">Passthrough Mode</span></span>

<span data-ttu-id="43be9-104">Lorsqu’un appel est actif dans **LINEBEARERMODE \_ passthrough**, le fournisseur de services offre un accès direct au matériel attaché pour le contrôle par l’application.</span><span class="sxs-lookup"><span data-stu-id="43be9-104">When a call is active in **LINEBEARERMODE\_PASSTHROUGH**, the service provider gives direct access to the attached hardware for control by the application.</span></span> <span data-ttu-id="43be9-105">Les applications peuvent utiliser ce mode pour le contrôle direct temporaire sur les modems asynchrones, accessibles par le biais des [fonctions de communication](/windows/desktop/DevIO/communications-functions), afin de configurer ou d’utiliser des fonctionnalités spéciales non prises en charge par le fournisseur de services, telles que les télécopies (classe 1, 2, etc.).</span><span class="sxs-lookup"><span data-stu-id="43be9-105">Applications can use this mode for temporary direct control over asynchronous modems, accessed through the [communications functions](/windows/desktop/DevIO/communications-functions), for the purpose of configuring or using special features not otherwise supported by the service provider, such as facsimile (Class 1, 2, and so on).</span></span> <span data-ttu-id="43be9-106">Ce mode de support est pris en charge par le fournisseur de services Universal Modem Driver (Unimodem).</span><span class="sxs-lookup"><span data-stu-id="43be9-106">This bearer mode is supported by the Universal Modem Driver (UNIMODEM) service provider.</span></span>

<span data-ttu-id="43be9-107">Les fournisseurs de services qui prennent en charge **LINEBEARERMODE \_ passthrough** l’indiquent dans le membre **DwBearerModes** de la structure [**LINEDEVCAPS**](/windows/desktop/api/Tapi/ns-tapi-linedevcaps) .</span><span class="sxs-lookup"><span data-stu-id="43be9-107">Service providers that support **LINEBEARERMODE\_PASSTHROUGH** indicate it in the **dwBearerModes** member of the [**LINEDEVCAPS**](/windows/desktop/api/Tapi/ns-tapi-linedevcaps) structure.</span></span> <span data-ttu-id="43be9-108">Quand **LINEBEARERMODE \_ passthrough** est indiqué, le fournisseur de services Unimodem inclut également dans la zone **DevSpecific** de la structure **LINEDEVCAPS** la clé de Registre utilisée pour accéder aux données relatives au modem associé au périphérique de ligne, au format suivant :</span><span class="sxs-lookup"><span data-stu-id="43be9-108">When **LINEBEARERMODE\_PASSTHROUGH** is indicated, the Unimodem service provider will also include in the **DevSpecific** area of the **LINEDEVCAPS** structure the registry key used to access data about the modem associated with the line device, in the following format:</span></span>

``` syntax
struct {
    DWORD dwContents;   // Set to 1 (indicates containing key).
    DWORD dwKeyOffset;  // Offset to key from start of this
                        // structure (not from start of
                        // LINEDEVCAPS structure).
                        // 8 in this case. 
    BYTE rgby[...];     // Place that contains null-terminated
                        // registry key. 
}
```

<span data-ttu-id="43be9-109">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="43be9-109">For example:</span></span>

``` syntax
    00000001 00000008 74737953 435c6d65  ........System\C
    65727275 6f43746e 6f72746e 7465536c  urrentControlSet
    7265535c 65636976 6c435c73 5c737361  urrentControlSet
    65646f4d 30305c6d xx003030 xxxxxxxx  Modem\0000.
```

<span data-ttu-id="43be9-110">Cette clé de Registre peut ensuite être ouverte à l’aide de la fonction [**RegOpenKey**](/windows/desktop/api/winreg/nf-winreg-regopenkeya) .</span><span class="sxs-lookup"><span data-stu-id="43be9-110">This registry key could then be opened using the [**RegOpenKey**](/windows/desktop/api/winreg/nf-winreg-regopenkeya) function.</span></span>

<span data-ttu-id="43be9-111">Le mode passthrough est appelé le plus souvent à l’aide de la fonction [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall) , en définissant le bit **LINEBEARERMODE \_ passthrough** dans le membre **dwBearerMode** de la structure [**LINECALLPARAMS**](/windows/desktop/api/Tapi/ns-tapi-linecallparams) vers laquelle pointe le paramètre *lpCallParams* .</span><span class="sxs-lookup"><span data-stu-id="43be9-111">Passthrough mode is invoked most often using the [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall) function, by setting the **LINEBEARERMODE\_PASSTHROUGH** bit in the **dwBearerMode** member of the [**LINECALLPARAMS**](/windows/desktop/api/Tapi/ns-tapi-linecallparams) structure pointed to by the *lpCallParams* parameter.</span></span> <span data-ttu-id="43be9-112">Une fois cette opération effectuée, le fournisseur de services ouvre le port série sur le modem et place immédiatement l’appel dans **LINECALLSTATE \_ connecté**.</span><span class="sxs-lookup"><span data-stu-id="43be9-112">When this is done, the service provider opens the serial port to the modem and immediately place the call into **LINECALLSTATE\_CONNECTED**.</span></span> <span data-ttu-id="43be9-113">L’application peut ensuite utiliser la fonction [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid) avec la classe d’appareil « comm/datamodem » pour obtenir un descripteur de fichier ouvert en lecture et en écriture sur le port comm.</span><span class="sxs-lookup"><span data-stu-id="43be9-113">The application can then use the [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid) function with the device class "comm/datamodem" to obtain an open file handle to read from and write to the comm port.</span></span>

<span data-ttu-id="43be9-114">Le mode passthrough peut être appelé en réponse à un appel entrant.</span><span class="sxs-lookup"><span data-stu-id="43be9-114">Passthrough mode can be invoked in response to an incoming call as well.</span></span> <span data-ttu-id="43be9-115">En règle générale, les applications appellent le mode passthrough pendant que l’appel se trouve dans l' **\_ offre LINECALLSTATE**, avant que l’appel ne soit répondu.</span><span class="sxs-lookup"><span data-stu-id="43be9-115">Generally, applications will invoke passthrough mode while the call is in **LINECALLSTATE\_OFFERING**, before the call has been answered.</span></span> <span data-ttu-id="43be9-116">Au lieu d’appeler [**lineAnswer**](/windows/desktop/api/Tapi/nf-tapi-lineanswer), l’application appelle [**lineSetCallParams**](/windows/desktop/api/Tapi/nf-tapi-linesetcallparams), en transmettant **LINEBEARERMODE \_ passthrough** en tant que paramètre *dwBearerMode* .</span><span class="sxs-lookup"><span data-stu-id="43be9-116">Instead of calling [**lineAnswer**](/windows/desktop/api/Tapi/nf-tapi-lineanswer), the application calls [**lineSetCallParams**](/windows/desktop/api/Tapi/nf-tapi-linesetcallparams), passing **LINEBEARERMODE\_PASSTHROUGH** as the *dwBearerMode* parameter.</span></span> <span data-ttu-id="43be9-117">Lorsque cela est fait, comme avec [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall), l’appel est immédiatement placé dans **LINECALLSTATE \_ connecté** par le fournisseur de services, et l’application peut obtenir un handle vers le port ouvert à l’aide de [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span><span class="sxs-lookup"><span data-stu-id="43be9-117">When this is done, as with [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall), the call is immediately placed into **LINECALLSTATE\_CONNECTED** by the service provider, and the application can obtain a handle to the open port using [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span></span> <span data-ttu-id="43be9-118">La fonction **lineSetCallParams** peut être appelée lorsque l’appel est dans **l' \_ offre LINECALLSTATE**, **LINECALLSTATE \_ accepté** ou **LINECALLSTATE \_ connecté**.</span><span class="sxs-lookup"><span data-stu-id="43be9-118">The **lineSetCallParams** function can be called when the call is in **LINECALLSTATE\_OFFERING**, **LINECALLSTATE\_ACCEPTED**, or **LINECALLSTATE\_CONNECTED**.</span></span>

<span data-ttu-id="43be9-119">Le mode passthrough se termine normalement en appelant [**lineDrop**](/windows/desktop/api/Tapi/nf-tapi-linedrop) sur le descripteur d’appel obtenu à partir de [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall) ou la première [**ligne \_ CALLSTATE**](line-callstate.md) message, si l’appel était un appel entrant.</span><span class="sxs-lookup"><span data-stu-id="43be9-119">Passthrough mode is normally terminated by calling [**lineDrop**](/windows/desktop/api/Tapi/nf-tapi-linedrop) on the call handle obtained from [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall) or the first [**LINE\_CALLSTATE**](line-callstate.md) message, if the call was an incoming call.</span></span> <span data-ttu-id="43be9-120">Le fournisseur de services ferme le port et restaure le modem à son état par défaut.</span><span class="sxs-lookup"><span data-stu-id="43be9-120">The service provider will close the port, and restore the modem to its default state.</span></span> <span data-ttu-id="43be9-121">L’application doit appeler [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) sur le handle qu’elle a reçu de [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span><span class="sxs-lookup"><span data-stu-id="43be9-121">The application must call [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) on the handle it received from [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span></span>

<span data-ttu-id="43be9-122">Le mode passthrough peut également être arrêté en appelant [**lineSetCallParams**](/windows/desktop/api/Tapi/nf-tapi-linesetcallparams) avec le paramètre *DwBearerMode* défini sur **LINEBEARERMODE \_ Voice**.</span><span class="sxs-lookup"><span data-stu-id="43be9-122">Passthrough mode can also be terminated by calling [**lineSetCallParams**](/windows/desktop/api/Tapi/nf-tapi-linesetcallparams) with the *dwBearerMode* parameter set to **LINEBEARERMODE\_VOICE**.</span></span> <span data-ttu-id="43be9-123">Le type de support (mode) défini par [**lineSetMediaMode**](/windows/desktop/api/Tapi/nf-tapi-linesetmediamode) est supposé être en vigueur.</span><span class="sxs-lookup"><span data-stu-id="43be9-123">The media type (mode) set by [**lineSetMediaMode**](/windows/desktop/api/Tapi/nf-tapi-linesetmediamode) is presumed to be in effect.</span></span> <span data-ttu-id="43be9-124">Si **LINEMEDIAMODE \_ DATAMODEM** est actif, le fournisseur de services prend l’appel comme s’il s’agissait d’un appel de modem de données déjà en cours ; si [**lineDrop**](/windows/desktop/api/Tapi/nf-tapi-linedrop) est appelé par la suite, le fournisseur de services émet les commandes de modem appropriées ou les modifications de l’état de l’interface pour supprimer un appel de données.</span><span class="sxs-lookup"><span data-stu-id="43be9-124">If **LINEMEDIAMODE\_DATAMODEM** is active, the service provider will take over the call as though it was a data modem call already in progress; if [**lineDrop**](/windows/desktop/api/Tapi/nf-tapi-linedrop) is subsequently called, the service provider will issue the appropriate modem commands or interface state changes to drop a data call.</span></span>

> [!Note]  
> <span data-ttu-id="43be9-125">Si le mode passthrough est terminé alors que l’appel est en cours, le fournisseur de services TAPI (TSP) de la ligne peut restaurer les paramètres de modem à leur état par défaut.</span><span class="sxs-lookup"><span data-stu-id="43be9-125">If Passthrough mode is terminated while the call is in progress, the TAPI service provider (TSP) for the line may restore the modem settings to their default state.</span></span> <span data-ttu-id="43be9-126">Unimodem est un exemple de TSP qui restaure toujours les paramètres du modem lorsqu’il termine le mode passthrough.</span><span class="sxs-lookup"><span data-stu-id="43be9-126">Unimodem is an example of a TSP that always restores the modem settings when terminating passthrough mode.</span></span> <span data-ttu-id="43be9-127">Pour cette raison, le mode passthrough ne peut pas être utilisé comme méthode pour configurer l’appareil.</span><span class="sxs-lookup"><span data-stu-id="43be9-127">For this reason, Passthrough mode cannot be used as a method to configure the device.</span></span> <span data-ttu-id="43be9-128">Le mode passthrough ne doit être utilisé que pour des activités distinctes qui peuvent être considérées comme terminées lorsque l’exécution de passthrough est terminée.</span><span class="sxs-lookup"><span data-stu-id="43be9-128">Passthrough mode should only be used for distinct activities that can be considered complete when Passthrough is terminated.</span></span> <span data-ttu-id="43be9-129">Les exemples d’activités qui peuvent utiliser le mode passthrough incluent l’envoi d’une télécopie ou la lecture de données audio/Wave via un protocole de modem propriétaire.</span><span class="sxs-lookup"><span data-stu-id="43be9-129">Examples of activities that can use passthrough mode include sending a fax or playing wave/audio data through a proprietary modem protocol.</span></span>

 

 

 
