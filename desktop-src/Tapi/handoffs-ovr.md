---
description: Lorsqu’une application dispose d’un privilège de propriétaire pour une session de communication, l’application peut choisir de transmettre la propriété à une autre application.
ms.assetid: d6d188c9-9cbd-45af-93f0-b78850374919
title: Livraisons
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 343815e35f1fc331c57c4aa2d9d311697cab7022
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106516062"
---
# <a name="handoffs"></a><span data-ttu-id="e36a9-103">Livraisons</span><span class="sxs-lookup"><span data-stu-id="e36a9-103">Handoffs</span></span>

<span data-ttu-id="e36a9-104">Lorsqu’une application dispose d’un [privilège](privilege-ovr.md) de propriétaire pour une session de communication, l’application peut choisir de transmettre la propriété à une autre application.</span><span class="sxs-lookup"><span data-stu-id="e36a9-104">When an application has owner [privilege](privilege-ovr.md) for a communications session, the application may choose to hand off ownership to another application.</span></span> <span data-ttu-id="e36a9-105">L’opération de remise est normalement utilisée pour permettre la modification du type de média de l’appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-105">The handoff operation is normally used to allow the call's media type to be changed.</span></span> <span data-ttu-id="e36a9-106">L’application dont la priorité est la plus élevée pour le nouveau type de média doit prendre et gérer l’appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-106">The highest-priority application for the new media type should take and handle the call.</span></span> <span data-ttu-id="e36a9-107">La modification du type de média se produit généralement pour l’une des raisons suivantes.</span><span class="sxs-lookup"><span data-stu-id="e36a9-107">Media type changing usually occurs for one of the following reasons.</span></span>

<span data-ttu-id="e36a9-108">**Commande utilisateur :** Par le biais d’une interface utilisateur ou de messages de fenêtre, l’application apprend que l’utilisateur local souhaite modifier le type de média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-108">**User command:** Through a user interface or through window messages, the application learns that the local user wants to change media type.</span></span> <span data-ttu-id="e36a9-109">Par exemple, l’utilisateur a indiqué à la nouvelle application cible (qui n’est pas encore un propriétaire) d’obtenir un appel vocal existant pour transmettre des données.</span><span class="sxs-lookup"><span data-stu-id="e36a9-109">For example, the user has told the new target application (which is not yet an owner) to obtain an existing voice call for transmitting data.</span></span> <span data-ttu-id="e36a9-110">L’application cible doit maintenant prendre le contrôle de l’appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-110">The target application must now take control of the call.</span></span> <span data-ttu-id="e36a9-111">Dans ce cas, le propriétaire actuel constate que le nombre de propriétaires augmente, puis abandonne son contrôle de l’appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-111">In this case, the current owner notices the number of owners increase, and then relinquishes its control of the call.</span></span> <span data-ttu-id="e36a9-112">L’utilisateur peut également indiquer au propriétaire actuel de l’appel de le remettre à une application capable de gérer le nouveau type de média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-112">Alternatively, the user could instruct the current owner of the call to hand it off to an application that can handle the new media type.</span></span>

<span data-ttu-id="e36a9-113">**Modification du type de média :** Le fournisseur de services peut détecter une modification de type de média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-113">**Media type change:** The service provider can detect a media type change.</span></span> <span data-ttu-id="e36a9-114">Par exemple, l’application locale lit un message vocal enregistré à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="e36a9-114">For example, the local application is playing a recorded voice message to the caller.</span></span> <span data-ttu-id="e36a9-115">Pendant ce message, l’appelant décide spontanément de transmettre une tonalité d’appel de télécopie, et l’application locale peut répondre en conséquence en modifiant le type de média pour la télécopie et, si nécessaire, en transmettant l’appel à une application de télécopie.</span><span class="sxs-lookup"><span data-stu-id="e36a9-115">During this message, the caller spontaneously decides to transmit a fax calling tone, and the local application can respond accordingly by changing the media type to fax and, if necessary, handing the call off to a fax application.</span></span> <span data-ttu-id="e36a9-116">Cela peut également être fait pour une application de surveillance permettant d’activer la surveillance de type de média et, lorsque le type de support dans lequel elle est intéressée est détecté sur un appel, elle peut demander la propriété de l’appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-116">Another way this can work is for a monitoring application to enable media type monitoring, and, when the media type in which it is interested is detected on a call, it can request ownership of the call.</span></span> <span data-ttu-id="e36a9-117">Ce mécanisme rend inutile que chaque application surveille chaque appel pour chaque type de média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-117">This mechanism makes it unnecessary for every application to monitor every call for every media type.</span></span>

<span data-ttu-id="e36a9-118">**Commande de partie distante :** Le tiers distant peut indiquer de manière interactive une modification des types de média lors d’un appel existant, par exemple si l’application locale surveille l’entrée DTMF par l’appelant distant.</span><span class="sxs-lookup"><span data-stu-id="e36a9-118">**Remote party command:** The remote party can interactively indicate a change in media types during an existing call, such as if the local application is monitoring DTMF input by the remote caller.</span></span> <span data-ttu-id="e36a9-119">Grâce à cette analyse, l’appelant indique, par exemple, qu’une télécopie va être envoyée.</span><span class="sxs-lookup"><span data-stu-id="e36a9-119">Through this monitoring, the caller indicates, for example, that a fax is about to be sent.</span></span> <span data-ttu-id="e36a9-120">Les autres méthodes permettant à l’appelant de contrôler les applications locales sont les commandes reçues sur d’autres connexions de données et les messages d’informations utilisateur de l’utilisateur RNIS.</span><span class="sxs-lookup"><span data-stu-id="e36a9-120">Other ways the caller can control local applications are with commands received on other data connections and through ISDN user-user information messages.</span></span>

<span data-ttu-id="e36a9-121">Un transfert d’appel aura l’un des résultats suivants :</span><span class="sxs-lookup"><span data-stu-id="e36a9-121">A call handoff will have one of these outcomes:</span></span>

-   <span data-ttu-id="e36a9-122">L’appel est donné à une autre application (réussite).</span><span class="sxs-lookup"><span data-stu-id="e36a9-122">The call is given to another application (SUCCESS).</span></span>
-   <span data-ttu-id="e36a9-123">L’application de gestion est elle-même la cible (TARGETSELF).</span><span class="sxs-lookup"><span data-stu-id="e36a9-123">The handing-off application is itself the target (TARGETSELF).</span></span>
-   <span data-ttu-id="e36a9-124">Le transfert échoue (TARGETNOTFOUND).</span><span class="sxs-lookup"><span data-stu-id="e36a9-124">The handoff fails (TARGETNOTFOUND).</span></span>

<span data-ttu-id="e36a9-125">Si l’application qui reçoit l’appel remis a déjà un handle d’appel à l’appel, cet ancien descripteur d’appel est utilisé.</span><span class="sxs-lookup"><span data-stu-id="e36a9-125">If the application that is receiving the handed-off call already has a call handle to the call, this old call handle is used.</span></span> <span data-ttu-id="e36a9-126">Dans le cas contraire, un nouveau descripteur d’appel est créé.</span><span class="sxs-lookup"><span data-stu-id="e36a9-126">Otherwise, a new call handle is created.</span></span> <span data-ttu-id="e36a9-127">Dans les deux cas, l’application finit par disposer des privilèges de propriétaire pour l’appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-127">In either case, the application ends up with owner privileges to the call.</span></span> <span data-ttu-id="e36a9-128">Chaque fois que l’application de gestion des messages n’est pas la même que l’application cible, la cible est informée de la remise dans un message d’état de session comme si elle recevait un nouvel appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-128">Whenever the handing-off application is not the same as the target application, the target is informed about the handoff in a session state message as if it were receiving a new call.</span></span>

<span data-ttu-id="e36a9-129">Si l’application propriétaire en cours est invitée à modifier les types de supports, elle le fait en distribuant l’appel à une application utilisée pour le type de média cible.</span><span class="sxs-lookup"><span data-stu-id="e36a9-129">If the current owner application is told to change media types, it does so by handing off the call to an application used for the target media type.</span></span> <span data-ttu-id="e36a9-130">Les deux types de transferts d’appel sont décrits dans [transferts dirigés](#directed-handoffs) et [transferts de type de média](#media-type-handoffs).</span><span class="sxs-lookup"><span data-stu-id="e36a9-130">The two types of call handoffs are described in [Directed Handoffs](#directed-handoffs) and [Media type Handoffs](#media-type-handoffs).</span></span>

<span data-ttu-id="e36a9-131">Les fournisseurs de services ne prennent pas tous en charge l’utilisation de cette opération.</span><span class="sxs-lookup"><span data-stu-id="e36a9-131">Not all service providers support use of this operation.</span></span>

<span data-ttu-id="e36a9-132">**TAPI 2. x :** Consultez [**lineHandoff**](/windows/win32/api/tapi/nf-tapi-linehandoff), avec *lpszFileName* défini sur le nom de l’application pour un transfert direct ou un *dwMediaMode* défini sur un type de support pour un transfert indirect.</span><span class="sxs-lookup"><span data-stu-id="e36a9-132">**TAPI 2.x:** See [**lineHandoff**](/windows/win32/api/tapi/nf-tapi-linehandoff), with *lpszFileName* set to the application name for a direct handoff or *dwMediaMode* set to one media type for an indirect handoff.</span></span>

<span data-ttu-id="e36a9-133">**TAPI 3. x :** Consultez [**ITBasicCallControl :: HandoffDirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffdirect), [**ITBasicCallControl :: HandoffIndirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffindirect).</span><span class="sxs-lookup"><span data-stu-id="e36a9-133">**TAPI 3.x:** See [**ITBasicCallControl::HandoffDirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffdirect), [**ITBasicCallControl::HandoffIndirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffindirect).</span></span>

## <a name="directed-handoffs"></a><span data-ttu-id="e36a9-134">Transferts dirigés</span><span class="sxs-lookup"><span data-stu-id="e36a9-134">Directed Handoffs</span></span>

<span data-ttu-id="e36a9-135">Une *remise dirigée* a lieu lorsque l’application cible est connue par son nom à l’application d’origine.</span><span class="sxs-lookup"><span data-stu-id="e36a9-135">A *directed handoff* takes place when the target application is known by name to the original application.</span></span> <span data-ttu-id="e36a9-136">Cette situation se produit, par exemple, parmi un ensemble d’applications écrites par le même fournisseur.</span><span class="sxs-lookup"><span data-stu-id="e36a9-136">This situation would occur, for example, among a set of applications written by the same vendor.</span></span> <span data-ttu-id="e36a9-137">L’utilisateur peut généralement configurer le contrôle des transferts dirigés.</span><span class="sxs-lookup"><span data-stu-id="e36a9-137">The user can usually configure control of directed handoffs.</span></span> <span data-ttu-id="e36a9-138">Avec une telle remise, l’appel est donné à l’application spécifiée s’il a ouvert la ligne sur laquelle l’appel existe.</span><span class="sxs-lookup"><span data-stu-id="e36a9-138">With such a handoff, the call is given to the specified application if it has opened the line on which the call exists.</span></span> <span data-ttu-id="e36a9-139">Le type de média spécifié au moment de l’ouverture de la ligne par l’application est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e36a9-139">The media type specified at the time the application opened the line is ignored.</span></span> <span data-ttu-id="e36a9-140">Un exemple courant est un appel vocal suivi d’une transmission de télécopie dans le même appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-140">One common example is a voice call followed by a fax transmission in the same call.</span></span> <span data-ttu-id="e36a9-141">La plupart du temps, le transfert dirigé est utilisé par les applications du même développeur, qui sont également liées par d’autres moyens.</span><span class="sxs-lookup"><span data-stu-id="e36a9-141">Directed handoff would most often be used by applications from the same developer that are linked in other ways as well.</span></span>

<span data-ttu-id="e36a9-142">La remise dirigée peut également être utilisée dans les versions futures dans le cadre du processus d’arbitrage de plusieurs applications en attente d’appels entrants du même type de média, avec la sélection de l’application pour gérer l’appel en fonction de la liaison de données ou de la détection de protocole de niveau supérieur plutôt que du type de média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-142">Directed handoff may also be used in future versions as part of the process of arbitrating multiple applications waiting for incoming calls of the same media type, with the selection of the application to handle the call being based on data-link or higher-level protocol detection rather than media type.</span></span> <span data-ttu-id="e36a9-143">Un exemple de son utilisation est une ligne de modem de données entrant avec des applications telles que la prise en charge à distance, le bulletin d’informations, l’accès réseau à distance et l’accès à la messagerie à distance, tous en attente d’appels simultanés.</span><span class="sxs-lookup"><span data-stu-id="e36a9-143">An example of its use would be an incoming data modem line with applications such as remote takeover, bulletin board, remote network access, and remote e-mail access all waiting for calls simultaneously.</span></span>

## <a name="media-type-handoffs"></a><span data-ttu-id="e36a9-144">Transferts de type de média</span><span class="sxs-lookup"><span data-stu-id="e36a9-144">Media Type Handoffs</span></span>

<span data-ttu-id="e36a9-145">Un *transfert de type de média* a lieu lorsqu’il existe un nouveau type de média ciblé, généralement lorsque l’application propriétaire détermine que le type de média nécessaire pour l’appel n’est pas présent ou est sur le point de changer.</span><span class="sxs-lookup"><span data-stu-id="e36a9-145">A *media type handoff* takes place when there is a new, targeted media type, usually when the owning application determines that the media type needed for the call is not present or is about to change.</span></span>

<span data-ttu-id="e36a9-146">Le processus d’un transfert dépendant du média peut être un processus de sondage si le bit de type de média inconnu est activé.</span><span class="sxs-lookup"><span data-stu-id="e36a9-146">The process for a media-dependent handoff can be a probing process if the media type UNKNOWN bit is on.</span></span> <span data-ttu-id="e36a9-147">Il incombe à l’application propriétaire de parcourir les types de médias pour trouver l’application dont la priorité est la plus élevée.</span><span class="sxs-lookup"><span data-stu-id="e36a9-147">It is the responsibility of the owning application to cycle through media types to find the highest-priority application.</span></span> <span data-ttu-id="e36a9-148">L’interface TAPI effectue ce cycle uniquement sur l’appel entrant initial pour rechercher le premier propriétaire.</span><span class="sxs-lookup"><span data-stu-id="e36a9-148">TAPI does this cycling only on the initial incoming call to find the first owner.</span></span> <span data-ttu-id="e36a9-149">Elle ne le fait pas pour une opération de remise.</span><span class="sxs-lookup"><span data-stu-id="e36a9-149">It does not do this for a handoff operation.</span></span> <span data-ttu-id="e36a9-150">Dans le cas contraire, un transfert est quasiment le même que pour l’affectation initiale d’un appel à une application.</span><span class="sxs-lookup"><span data-stu-id="e36a9-150">Otherwise, a handoff is virtually the same as for the initial assignment of a call to an application.</span></span> <span data-ttu-id="e36a9-151">La différence réside dans le fait qu’un seul type de média peut être défini pour un transfert indirect (type de média).</span><span class="sxs-lookup"><span data-stu-id="e36a9-151">The difference is the fact that only one media type can be set for an indirect (media type) handoff.</span></span>

<span data-ttu-id="e36a9-152">Étant donné qu’un seul bit de type de média peut être spécifié, l’appel est donné à l’application de priorité la plus élevée pour ce type de média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-152">Because only a single media type bit can be specified, the call is given to the highest priority application for that media type.</span></span> <span data-ttu-id="e36a9-153">Toutefois, il est possible que plusieurs types de média soient pris en compte pour la remise.</span><span class="sxs-lookup"><span data-stu-id="e36a9-153">However, it is possible that more than one media type is to be considered for the handoff.</span></span> <span data-ttu-id="e36a9-154">Dans ce cas, l’application de gestion doit spécifier la priorité la plus élevée des types de média possibles en tant que paramètre.</span><span class="sxs-lookup"><span data-stu-id="e36a9-154">In this case, the handing-off application should specify the highest priority of the possible media types as a parameter.</span></span>

<span data-ttu-id="e36a9-155">Si une application spécifie le bit inconnu lors d’un transfert de type média et que la remise échoue, cela signifie qu’une application inconnue capable d’effectuer la détermination du type de média n’est pas en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="e36a9-155">If an application specifies the UNKNOWN bit when performing a media-type handoff and the handoff fails, this means that an unknown application capable of performing media type determination is not currently running.</span></span> <span data-ttu-id="e36a9-156">L’application qui est en cours de transfert doit ensuite tenter de remettre l’appel à l’application dont la priorité est la plus élevée, inscrite pour le type de média supérieur suivant.</span><span class="sxs-lookup"><span data-stu-id="e36a9-156">The application that is handing off should then try to hand the call off to the highest-priority application registered for the next-higher media type.</span></span>

<span data-ttu-id="e36a9-157">L’application réceptrice est désormais responsable de l’appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-157">The receiving application is now responsible for the call.</span></span> <span data-ttu-id="e36a9-158">Il sonde maintenant le type de média réel de l’appel.</span><span class="sxs-lookup"><span data-stu-id="e36a9-158">It now probes for the call's actual media type.</span></span> <span data-ttu-id="e36a9-159">Si l’application peut gérer le type de média de l’appel, elle doit s’assurer qu’il s’agit de l’application dont la priorité est la plus élevée et inscrite pour ce type de média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-159">If the application can handle the call's media type, it must ensure that it is the highest-priority application registered for that media type.</span></span> <span data-ttu-id="e36a9-160">Si c’est le cas, il conserve l’appel et le traite normalement.</span><span class="sxs-lookup"><span data-stu-id="e36a9-160">If so, it keeps the call and processes it normally.</span></span> <span data-ttu-id="e36a9-161">Si ce n’est pas le cas, il transmet l’appel à une autre application inscrite pour ce type de média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-161">If not, it hands the call off to another application registered for that media type.</span></span>

<span data-ttu-id="e36a9-162">Toutefois, si la sonde pour ce type de média échoue, l’application effectue une nouvelle tentative, en tentant les autres possibilités en mode Media.</span><span class="sxs-lookup"><span data-stu-id="e36a9-162">If, however, the probe for that media type fails, the application probes again, attempting the remaining media-mode possibilities.</span></span> <span data-ttu-id="e36a9-163">Il doit d’abord désactiver le bit de type de média actuel, puis essayer une autre remise avec un type différent.</span><span class="sxs-lookup"><span data-stu-id="e36a9-163">It must first turn off the current media type bit, then try another handoff with a different type.</span></span>

<span data-ttu-id="e36a9-164">Ce processus de détection et de remise continue, et les autres types de médias sont éliminés un par un.</span><span class="sxs-lookup"><span data-stu-id="e36a9-164">This process of probing and handing off continues, and the remaining media types are eliminated one by one.</span></span> <span data-ttu-id="e36a9-165">En cours de route, l’une des applications peut voir que le type de média qu’elle gère est sur l’appel et que la remise a réussi.</span><span class="sxs-lookup"><span data-stu-id="e36a9-165">Along the way, one of the applications may see that the media type it handles is on the call, and the handoff is successful.</span></span>

<span data-ttu-id="e36a9-166">L’application doit ensuite définir le type de support approprié et effacer tous les autres bits de type média.</span><span class="sxs-lookup"><span data-stu-id="e36a9-166">The application should then set the correct media type and clear all other media-type bits.</span></span> <span data-ttu-id="e36a9-167">Cela informe les autres applications intéressées du type de média correct.</span><span class="sxs-lookup"><span data-stu-id="e36a9-167">This informs other interested applications of the correct media type.</span></span> <span data-ttu-id="e36a9-168">Ces autres applications reçoivent un message de notification d’événement indiquant que le type de média de l’appel a changé.</span><span class="sxs-lookup"><span data-stu-id="e36a9-168">These other applications receive an event notification message stating that the call's media type has changed.</span></span>

 

 
