---
description: Lorsqu’un appel est à l’État connected, les données peuvent être transmises via l’appel. Le type de média d’appel fournit une indication du type de données (par exemple, son type de données ou un protocole de niveau supérieur) de ce flux de données multimédia.
ms.assetid: 3281387e-3f72-4fda-8199-b3ce6e45e910
title: Surveillance des médias
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb54989306fd80c48c0b99c9f8285a83b40bed25
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/03/2021
ms.locfileid: "106539146"
---
# <a name="media-monitoring"></a><span data-ttu-id="39a70-104">Surveillance des médias</span><span class="sxs-lookup"><span data-stu-id="39a70-104">Media Monitoring</span></span>

<span data-ttu-id="39a70-105">Lorsqu’un appel est à l’état *Connected* , les données peuvent être transmises via l’appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-105">When a call is in the *connected* state, data can be transported over the call.</span></span> <span data-ttu-id="39a70-106">Le type de média d’appel fournit une indication du type de données (par exemple, son type de données ou un protocole de niveau supérieur) de ce flux de données multimédia.</span><span class="sxs-lookup"><span data-stu-id="39a70-106">The call media type provides an indication of the type of data (for example, its datatype, or higher-level protocol) of this media stream.</span></span>

<span data-ttu-id="39a70-107">L’interface TAPI permet aux applications d’être fournies avec une notification concernant les modifications apportées au type de média d’un appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-107">TAPI allows applications to be provided with a notification about changes in a call's media type.</span></span> <span data-ttu-id="39a70-108">La notification fournit une indication du nouveau type de média de l’appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-108">The notification provides an indication of the call's new media type.</span></span> <span data-ttu-id="39a70-109">Le fournisseur de services décide de la manière dont il souhaite effectuer cette détermination.</span><span class="sxs-lookup"><span data-stu-id="39a70-109">The service provider decides how it wants to make this determination.</span></span> <span data-ttu-id="39a70-110">Par exemple, le fournisseur de services peut utiliser le traitement de signal du flux multimédia pour déterminer le type de média, ou il peut s’appuyer sur des modèles de sonnerie distinctifs affectés à différents flux multimédias ou sur des éléments d’information transmis dans un protocole de signalisation hors bande.</span><span class="sxs-lookup"><span data-stu-id="39a70-110">For example, the service provider could use signal processing of the media stream to determine the media type, or it could rely on distinctive ringing patterns assigned to different media streams, or on information elements passed in an out-of-band signaling protocol.</span></span> <span data-ttu-id="39a70-111">Indépendamment de la façon dont la détermination du type de média est effectuée, l’application est simplement informée des modifications de type de média sur un appel existant.</span><span class="sxs-lookup"><span data-stu-id="39a70-111">Independent of how the media type determination is achieved, the application is simply informed about media type changes on an existing call.</span></span>

<span data-ttu-id="39a70-112">Pour plus d’informations et pour obtenir la liste des modes ou types de médias TAPI actuellement définis, consultez [ \_ constantes LINEMEDIAMODE](linemediamode--constants.md).</span><span class="sxs-lookup"><span data-stu-id="39a70-112">For more information and a list of currently defined TAPI media types or modes, see [LINEMEDIAMODE\_ Constants](linemediamode--constants.md).</span></span> <span data-ttu-id="39a70-113">Les fournisseurs de services peuvent implémenter des types de médias spécifiques au fournisseur pour des appareils hautement spécialisés.</span><span class="sxs-lookup"><span data-stu-id="39a70-113">Service providers may implement provider-specific media types for highly specialized devices.</span></span> <span data-ttu-id="39a70-114">Pour plus d’informations, consultez la documentation de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="39a70-114">Information on these will be found in device documentation.</span></span>

<span data-ttu-id="39a70-115">Les types de média définis par TAPI sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="39a70-115">The media types defined by TAPI include:</span></span>

-   <span data-ttu-id="39a70-116">Inconnu.</span><span class="sxs-lookup"><span data-stu-id="39a70-116">Unknown.</span></span> <span data-ttu-id="39a70-117">Le type de média de l’appel n’est pas actuellement connu : l’appel n’est pas classifié.</span><span class="sxs-lookup"><span data-stu-id="39a70-117">The media type of the call is not currently known—the call is unclassified.</span></span>
-   <span data-ttu-id="39a70-118">Voix interactive.</span><span class="sxs-lookup"><span data-stu-id="39a70-118">Interactive voice.</span></span> <span data-ttu-id="39a70-119">L’énergie vocale a été détectée lors de l’appel, et l’appel est traité comme un appel vocal interactif avec une personne à la fin de l’application.</span><span class="sxs-lookup"><span data-stu-id="39a70-119">Voice energy was detected on the call, and the call is handled as an interactive voice call with a person at the application's end.</span></span>
-   <span data-ttu-id="39a70-120">Voix automatique.</span><span class="sxs-lookup"><span data-stu-id="39a70-120">Automated voice.</span></span> <span data-ttu-id="39a70-121">L’énergie vocale a été détectée lors de l’appel, et l’appel est traité comme un appel vocal, mais sans personne à l’extrémité de l’application, par exemple avec une application de machine de réponse.</span><span class="sxs-lookup"><span data-stu-id="39a70-121">Voice energy was detected on the call, and the call is handled as a voice call but with no person at the application's end, such as with an answering machine application.</span></span>
-   <span data-ttu-id="39a70-122">Modem de données.</span><span class="sxs-lookup"><span data-stu-id="39a70-122">Data modem.</span></span> <span data-ttu-id="39a70-123">Une session de modem sur l’appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-123">A modem session on the call.</span></span> <span data-ttu-id="39a70-124">Les protocoles de modem actuels requièrent la station appelée pour initier le protocole de transfert.</span><span class="sxs-lookup"><span data-stu-id="39a70-124">Current modem protocols require the called station to initiate the handshake.</span></span> <span data-ttu-id="39a70-125">Pour un appel de modem de données entrant, l’application ne peut généralement pas effectuer de détection positive.</span><span class="sxs-lookup"><span data-stu-id="39a70-125">For an incoming data modem call, the application can typically make no positive detection.</span></span> <span data-ttu-id="39a70-126">La manière dont le fournisseur de services effectue cette détermination est son choix.</span><span class="sxs-lookup"><span data-stu-id="39a70-126">How the service provider makes this determination is its choice.</span></span> <span data-ttu-id="39a70-127">Par exemple, une période de silence juste après avoir répondu à un appel entrant peut être utilisée comme heuristique pour décider qu’il peut s’agir d’un appel de modem de données.</span><span class="sxs-lookup"><span data-stu-id="39a70-127">For example, a period of silence just after answering an incoming call can be used as a heuristic to decide that this might be a data modem call.</span></span>
-   <span data-ttu-id="39a70-128">Télécopie G3.</span><span class="sxs-lookup"><span data-stu-id="39a70-128">G3 fax.</span></span> <span data-ttu-id="39a70-129">Une session de télécopie de groupe 3 sur l’appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-129">A group 3 fax session on the call.</span></span>
-   <span data-ttu-id="39a70-130">Télécopie G4.</span><span class="sxs-lookup"><span data-stu-id="39a70-130">G4 fax.</span></span> <span data-ttu-id="39a70-131">Une session de télécopie de groupe 4 sur l’appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-131">A group 4 fax session on the call.</span></span>
-   <span data-ttu-id="39a70-132">Piloté.</span><span class="sxs-lookup"><span data-stu-id="39a70-132">TDD.</span></span> <span data-ttu-id="39a70-133">Le flux multimédia de l’appel utilise les périphériques de téléphonie pour le protocole sourd.</span><span class="sxs-lookup"><span data-stu-id="39a70-133">The call's media stream uses the Telephony Devices for the Deaf protocol.</span></span>
-   <span data-ttu-id="39a70-134">Données numériques.</span><span class="sxs-lookup"><span data-stu-id="39a70-134">Digital data.</span></span> <span data-ttu-id="39a70-135">Flux de données numériques d’un format non spécifié.</span><span class="sxs-lookup"><span data-stu-id="39a70-135">A digital data stream of unspecified format.</span></span>
-   <span data-ttu-id="39a70-136">TELETEX, Videotex, télex, mixte.</span><span class="sxs-lookup"><span data-stu-id="39a70-136">Teletex, Videotex, Telex, Mixed.</span></span> <span data-ttu-id="39a70-137">Celles-ci correspondent aux services télématiques portant le même nom.</span><span class="sxs-lookup"><span data-stu-id="39a70-137">These correspond to the telematic services of the same names.</span></span>
-   <span data-ttu-id="39a70-138">Modification.</span><span class="sxs-lookup"><span data-stu-id="39a70-138">ADSI.</span></span> <span data-ttu-id="39a70-139">Session d’interface des services d’affichage analogique sur l’appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-139">An Analog Display Services Interface session on the call.</span></span> <span data-ttu-id="39a70-140">ADSI améliore les appels vocaux avec des informations alphanumériques téléchargées sur le téléphone et l’utilisation de boutons logiciels sur le téléphone.</span><span class="sxs-lookup"><span data-stu-id="39a70-140">ADSI enhances voice calls with alphanumeric information downloaded to the phone and the use of soft buttons on the phone.</span></span>

<span data-ttu-id="39a70-141">Une application peut activer ou désactiver l’analyse des médias sur un appel spécifié avec [**lineMonitorMedia**](/windows/desktop/api/Tapi/nf-tapi-linemonitormedia).</span><span class="sxs-lookup"><span data-stu-id="39a70-141">An application can enable or disable media monitoring on a specified call with [**lineMonitorMedia**](/windows/desktop/api/Tapi/nf-tapi-linemonitormedia).</span></span> <span data-ttu-id="39a70-142">L’application spécifie les types de médias qui doivent être analysés, et lorsque la surveillance du média est activée, la détection d’une modification de type de média entraîne la notification de l’application avec le message [**\_ MONITORMEDIA de ligne**](line-monitormedia.md) .</span><span class="sxs-lookup"><span data-stu-id="39a70-142">The application specifies which media types it is interested in monitoring, and when media monitoring is enabled, the detection of a media type change causes the application to be notified with the [**LINE\_MONITORMEDIA**](line-monitormedia.md) message.</span></span> <span data-ttu-id="39a70-143">Ce message fournit le descripteur d’appel sur lequel la modification du type de média a été détectée, ainsi que le nouveau type de média.</span><span class="sxs-lookup"><span data-stu-id="39a70-143">This message provides the call handle on which the media type change was detected as well as the new media type.</span></span>

<span data-ttu-id="39a70-144">Il existe une distinction entre le type de média d’un appel signalé par [**lineGetCallInfo**](/windows/desktop/api/Tapi/nf-tapi-linegetcallinfo) et les rapports d’événements de type de média par les messages de MONITORMEDIA de ligne \_ .</span><span class="sxs-lookup"><span data-stu-id="39a70-144">There is a distinction between the media type of a call as reported by [**lineGetCallInfo**](/windows/desktop/api/Tapi/nf-tapi-linegetcallinfo) and the media type event reports by LINE\_MONITORMEDIA messages.</span></span> <span data-ttu-id="39a70-145">Le type de média d’un appel est déterminé exclusivement par les applications propriétaires de l’appel et n’est pas automatiquement modifié par les événements de surveillance du support.</span><span class="sxs-lookup"><span data-stu-id="39a70-145">A call's media type is determined exclusively by owner applications of the call and is not automatically changed by media monitoring events.</span></span> <span data-ttu-id="39a70-146">La seule exception est la détermination initiale du type de média qui peut être effectuée par la bibliothèque de liens dynamiques TAPI pour sélectionner le premier propriétaire d’un appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-146">The one exception is the initial media type determination that can be performed by the TAPI dynamic-link library to select the first owner of a call.</span></span> <span data-ttu-id="39a70-147">Il est possible que, dans ce cas, la bibliothèque soit le propriétaire de l’appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-147">One could argue that in this case, the library is the owner of the call.</span></span>

<span data-ttu-id="39a70-148">L’analyse du type de média par défaut est effectuée pour les types de médias pour lesquels le périphérique de ligne a été ouvert.</span><span class="sxs-lookup"><span data-stu-id="39a70-148">Default media type monitoring is performed for the media types for which the line device has been opened.</span></span> <span data-ttu-id="39a70-149">Cela permet de déterminer le type de média d’un appel entrant avant que l’appel ne soit transmis à une application en fonction de ce que l’application demande.</span><span class="sxs-lookup"><span data-stu-id="39a70-149">This allows an incoming call's media type to be determined before the call is handed to an application based on what the application demands.</span></span> <span data-ttu-id="39a70-150">La portée de la surveillance des médias d’un appel est liée par la durée de vie de l’appel.</span><span class="sxs-lookup"><span data-stu-id="39a70-150">The scope of the media monitoring of a call is bound by the lifetime of the call.</span></span> <span data-ttu-id="39a70-151">La surveillance des médias sur un appel se termine dès que l’appel *se déconnecte* ou devient *inactif*.</span><span class="sxs-lookup"><span data-stu-id="39a70-151">Media monitoring on a call ends as soon as the call *disconnects* or goes *idle*.</span></span>

<span data-ttu-id="39a70-152">Une application peut obtenir des identificateurs d’appareil pour différentes classes d’appareils associées à une ligne ouverte en appelant [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span><span class="sxs-lookup"><span data-stu-id="39a70-152">An application can obtain device identifiers for various device classes associated with an opened line by calling [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span></span> <span data-ttu-id="39a70-153">Cette fonction prend un handle de ligne, une adresse ou un handle d’appel et une description de classe d’appareil.</span><span class="sxs-lookup"><span data-stu-id="39a70-153">This function takes a line handle, address, or call handle and a device class description.</span></span> <span data-ttu-id="39a70-154">Elle retourne l’identificateur de l’appareil de la classe d’appareil donnée associée à l’appareil, à l’adresse ou à l’appel de ligne ouverte.</span><span class="sxs-lookup"><span data-stu-id="39a70-154">It returns the device identifier for the device of the given device class that is associated with the open line device, address, or call.</span></span> <span data-ttu-id="39a70-155">Si la classe d’appareil est « TAPI/Line », l’identificateur d’appareil de l’appareil de ligne est retourné.</span><span class="sxs-lookup"><span data-stu-id="39a70-155">If the device class is "tapi/line," then the device identifier of the line device is returned.</span></span> <span data-ttu-id="39a70-156">Si la classe d’appareil est « MCI/Wave », l’identificateur d’appareil d’un appareil WaveAudio MCI est retourné (si pris en charge), ce qui permet des activités telles que l’enregistrement ou la lecture des données audio sur l’appel sur la ligne.</span><span class="sxs-lookup"><span data-stu-id="39a70-156">If the device class is "mci/wave," then the device identifier of an mci waveaudio device is returned (if supported), which allows activities such as the recording or playback of audio over the call on the line.</span></span>

<span data-ttu-id="39a70-157">L’application peut utiliser l’identificateur d’appareil retourné avec l’API multimédia correspondante pour interroger les fonctionnalités de l’appareil et ouvrir par la suite l’appareil multimédia.</span><span class="sxs-lookup"><span data-stu-id="39a70-157">The application can use the returned device identifier with the corresponding media API to query the device's capabilities and subsequently open the media device.</span></span> <span data-ttu-id="39a70-158">Par exemple, si votre application doit utiliser la ligne comme périphérique de forme d’onde, elle doit d’abord appeler [**waveInGetDevCaps**](/windows/win32/api/mmeapi/nf-mmeapi-waveingetdevcaps) et/ou [**waveOutGetDevCaps**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutgetdevcaps) pour déterminer les fonctionnalités de forme d’onde de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="39a70-158">For example, if your application needs to use the line as a waveform device, it must first call [**waveInGetDevCaps**](/windows/win32/api/mmeapi/nf-mmeapi-waveingetdevcaps) and/or [**waveOutGetDevCaps**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutgetdevcaps) to determine the waveform capabilities of the device.</span></span> <span data-ttu-id="39a70-159">Le format de données Waveform standard pris en charge par la téléphonie dans Amérique du Nord est m-Law 8 bits à 8000 échantillons par seconde, bien que le pilote de périphérique Wave puisse convertir ce taux d’échantillonnage et Companding en d’autres formats audio multimédia plus courants.</span><span class="sxs-lookup"><span data-stu-id="39a70-159">The typical waveform data format supported by telephony in North America is 8-bit m-law at 8000 samples per second, although the wave device driver can convert this sample rate and companding to other more common multimedia audio formats.</span></span>

<span data-ttu-id="39a70-160">Pour ouvrir par la suite un appareil de ligne pour la lecture audio à l’aide de l’API Waveform, une application appelle [**waveOutOpen**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutopen).</span><span class="sxs-lookup"><span data-stu-id="39a70-160">To subsequently open a line device for audio playback using the waveform API, an application calls [**waveOutOpen**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutopen).</span></span> <span data-ttu-id="39a70-161">L’implémentation de **waveOutOpen** est spécifique à l’appareil, et il existe de nombreuses options pour l’implémentation de cette fonction.</span><span class="sxs-lookup"><span data-stu-id="39a70-161">The implementation of **waveOutOpen** is device specific, and there are a variety of options for implementing this function.</span></span>

 

 
