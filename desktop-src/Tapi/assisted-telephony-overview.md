---
description: Une fonctionnalité intéressante de la téléphonie est le petit ensemble de fonctions appelées téléphonie assistée.
ms.assetid: 1c41f52b-f8bf-410e-a966-9323a690a4d5
title: Vue d’ensemble de la téléphonie assistée
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b6a8826fd0c273936204d9250fb91504333d807
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103952357"
---
# <a name="assisted-telephony-overview"></a><span data-ttu-id="59bfc-103">Vue d’ensemble de la téléphonie assistée</span><span class="sxs-lookup"><span data-stu-id="59bfc-103">Assisted Telephony Overview</span></span>

<span data-ttu-id="59bfc-104">Une fonctionnalité intéressante de la téléphonie est le petit ensemble de fonctions appelées téléphonie assistée.</span><span class="sxs-lookup"><span data-stu-id="59bfc-104">A valuable feature of telephony is the small set of functions called Assisted Telephony.</span></span> <span data-ttu-id="59bfc-105">La téléphonie assistée est conçue pour créer des appels vocaux et des appels multimédias disponibles pour n’importe quelle application, et pas seulement pour ceux dédiés à la fonctionnalité de téléphonie.</span><span class="sxs-lookup"><span data-stu-id="59bfc-105">Assisted Telephony is designed to make the establishment of voice calls and of media calls available to any application, not just those dedicated to telephonic functionality.</span></span> <span data-ttu-id="59bfc-106">En d’autres termes, la téléphonie assistée permet aux applications d’effectuer des appels téléphoniques sans avoir à connaître les détails des services de l’API de téléphonie complète.</span><span class="sxs-lookup"><span data-stu-id="59bfc-106">In other words, Assisted Telephony lets applications make telephone calls without needing to be aware of the details of the services of the full Telephony API.</span></span> <span data-ttu-id="59bfc-107">Il étend la téléphonie aux applications de traitement de texte, aux feuilles de calcul, aux bases de données, aux gestionnaires d’informations personnelles et à d’autres applications non basées sur la téléphonie.</span><span class="sxs-lookup"><span data-stu-id="59bfc-107">It extends telephony to word-processing applications, spreadsheets, databases, personal information managers, and other non-telephony applications.</span></span>

<span data-ttu-id="59bfc-108">Pour obtenir la liste des fonctions de téléphonie assistée par TAPI 2. x de la téléphonie de base, consultez [référence des fonctions rapides TAPI](./tapi-quick-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="59bfc-108">For a list of TAPI 2.x Assisted Telephony functions of Basic Telephony, see [TAPI Quick Function Reference](./tapi-quick-function-reference.md).</span></span> <span data-ttu-id="59bfc-109">TAPI 3. x prend en charge la téléphonie assistée via l’interface [**ITRequest**](/windows/desktop/api/tapi3if/nn-tapi3if-itrequest) .</span><span class="sxs-lookup"><span data-stu-id="59bfc-109">TAPI 3.x supports assisted telephony through the [**ITRequest**](/windows/desktop/api/tapi3if/nn-tapi3if-itrequest) interface.</span></span>

<span data-ttu-id="59bfc-110">L’exemple suivant illustre l’utilité de la téléphonie assistée.</span><span class="sxs-lookup"><span data-stu-id="59bfc-110">The usefulness of Assisted Telephony can be illustrated by the following example.</span></span> <span data-ttu-id="59bfc-111">Une application de feuille de calcul peut incorporer des fonctions qui composent un numéro de téléphone pour un appel vocal.</span><span class="sxs-lookup"><span data-stu-id="59bfc-111">A spreadsheet application can incorporate functions that dial a telephone number for a speech call.</span></span> <span data-ttu-id="59bfc-112">Tant que l’application n’a besoin d’aucun des contrôles d’appel détaillés fournis par l’API de téléphonie complète, la téléphonie assistée est le moyen le plus simple et le plus efficace de fournir des fonctionnalités de téléphonie.</span><span class="sxs-lookup"><span data-stu-id="59bfc-112">As long as the application needs none of the detailed call control provided by the full Telephony API, Assisted Telephony is the easiest and most efficient way to give it telephonic functionality.</span></span>

![téléphonie assistée avec une application de feuille de calcul](images/assist4.png)

<span data-ttu-id="59bfc-114">La téléphonie assistée et l’API de téléphonie complète sont utilisées et implémentées de différentes façons. il n’est donc pas recommandé de mélanger les appels de fonction de téléphonie assistée et les appels de fonction d’API de téléphonie dans une seule application.</span><span class="sxs-lookup"><span data-stu-id="59bfc-114">Assisted Telephony and the full Telephony API are used and implemented in different ways, so it is not advised to mix Assisted Telephony function calls and Telephony API function calls within a single application.</span></span>

## <a name="using-assisted-telephony"></a><span data-ttu-id="59bfc-115">Utilisation de la téléphonie assistée</span><span class="sxs-lookup"><span data-stu-id="59bfc-115">Using Assisted Telephony</span></span>

<span data-ttu-id="59bfc-116">Les applications qui utilisent des services de téléphonie assistés initialisent uniquement les demandes d’appel qui sont temporairement mises en file d’attente par TAPI.</span><span class="sxs-lookup"><span data-stu-id="59bfc-116">Applications that use Assisted Telephony services only initiate call requests that are temporarily queued by TAPI.</span></span> <span data-ttu-id="59bfc-117">L’application destinataire de la demande récupère ces requêtes et les exécute pour le compte de l’application de téléphonie assistée.</span><span class="sxs-lookup"><span data-stu-id="59bfc-117">The request recipient application retrieves these requests and executes them on behalf of the Assisted Telephony application.</span></span> <span data-ttu-id="59bfc-118">La fonction [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) demande l’établissement d’un appel vocal.</span><span class="sxs-lookup"><span data-stu-id="59bfc-118">The [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) function requests the establishment of a voice call.</span></span> <span data-ttu-id="59bfc-119">L’application qui effectue la demande ne contrôle pas l’appel.</span><span class="sxs-lookup"><span data-stu-id="59bfc-119">The requesting application does not control the call.</span></span>

<span data-ttu-id="59bfc-120">L’interface TAPI permet à l’utilisateur d’établir différentes ou les mêmes applications destinataires de demande pour chacun de ces services.</span><span class="sxs-lookup"><span data-stu-id="59bfc-120">TAPI allows the user to establish different or the same request recipient applications for each of these services.</span></span> <span data-ttu-id="59bfc-121">Une application devient un destinataire de la demande en s’inscrivant auprès de [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), dans laquelle **true** est spécifié comme valeur pour le paramètre *bEnable*.</span><span class="sxs-lookup"><span data-stu-id="59bfc-121">An application becomes a request recipient by registering with [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), in which **TRUE** is specified as the value for the parameter *bEnable*.</span></span> <span data-ttu-id="59bfc-122">(La spécification de la **valeur false** annule l’inscription de l’application en tant que destinataire de la demande, ce qu’elle doit faire lorsqu’elle a déterminé que ses tâches de destinataires sont liées à la session active.) L’application sélectionne les services qu’elle souhaite gérer dans le paramètre *dwRequestMode* de **lineRegisterRequestRecipient**.</span><span class="sxs-lookup"><span data-stu-id="59bfc-122">(Specifying **FALSE** deregisters the application as a request recipient, which it should do when it has determined that its recipient duties are through for the current session.) The application selects the services it wants to handle in the *dwRequestMode* parameter of **lineRegisterRequestRecipient**.</span></span> <span data-ttu-id="59bfc-123">Une valeur possible pour une demande est LINEREQUESTMODE \_ MAKECALL, pour indiquer que l’application doit gérer les demandes [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) .</span><span class="sxs-lookup"><span data-stu-id="59bfc-123">A possible value for a request is LINEREQUESTMODE\_MAKECALL, to show that the application will handle [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) requests.</span></span> <span data-ttu-id="59bfc-124">Si plusieurs applications s’inscrivent pour les mêmes services, un schéma de priorité est utilisé pour permettre à l’utilisateur de sélectionner l’application à privilégier pour gérer les demandes.</span><span class="sxs-lookup"><span data-stu-id="59bfc-124">If multiple applications register for the same services, a priority scheme is used to allow the user to select which application is preferred for handling requests.</span></span> <span data-ttu-id="59bfc-125">Ce schéma de priorité est identique à celui utilisé pour le transfert d’appels et le routage des appels entrants sur la base d’une liste de noms de fichiers dans **HandoffPriorities** dans le registre.</span><span class="sxs-lookup"><span data-stu-id="59bfc-125">This priority scheme is identical to that used for call handoff and the routing of incoming calls based on a list of file names in **HandoffPriorities** in the registry.</span></span>

## <a name="call-requests"></a><span data-ttu-id="59bfc-126">Demandes d’appel</span><span class="sxs-lookup"><span data-stu-id="59bfc-126">Call Requests</span></span>

<span data-ttu-id="59bfc-127">La téléphonie assistée fournit des applications prenant en charge la téléphonie avec un mécanisme facile à utiliser pour passer des appels téléphoniques sans que le développeur n’ait à être entièrement responsable de la téléphonie.</span><span class="sxs-lookup"><span data-stu-id="59bfc-127">Assisted Telephony provides telephony-enabled applications with an easy-to-use mechanism for making phone calls without requiring the developer to become fully literate in telephony.</span></span>

<span data-ttu-id="59bfc-128">La fonction [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) demande un appel vocal entre l’utilisateur et un tiers distant spécifié par son numéro de téléphone.</span><span class="sxs-lookup"><span data-stu-id="59bfc-128">The [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) function requests a voice call between the user and a remote party specified by its phone number.</span></span> <span data-ttu-id="59bfc-129">La demande est transmise à l’interface TAPI, qui la transmet à une application inscrite en tant que destinataire de ces demandes.</span><span class="sxs-lookup"><span data-stu-id="59bfc-129">The request is made to TAPI, which passes it to an application that is registered as a recipient of such requests.</span></span> <span data-ttu-id="59bfc-130">Ce destinataire est une application de gestionnaire d’appels.</span><span class="sxs-lookup"><span data-stu-id="59bfc-130">This recipient is a call manager application.</span></span>

<span data-ttu-id="59bfc-131">Une fois que l’application a effectué la requête, l’appel est entièrement contrôlé à partir de l’application du gestionnaire d’appels, car les applications de téléphonie assistée ne peuvent pas gérer les appels.</span><span class="sxs-lookup"><span data-stu-id="59bfc-131">After the application has made the request, the call is controlled entirely from the call manager application because Assisted Telephony applications cannot manage calls.</span></span> <span data-ttu-id="59bfc-132">Étant donné que les aspects plus complexes de la téléphonie et de toutes les opérations de l’interface utilisateur sont gérés par l’application du gestionnaire d’appels, les applications prenant en charge la téléphonie n’ont pas besoin d’être modifiées de quelque manière que ce soit.</span><span class="sxs-lookup"><span data-stu-id="59bfc-132">Because the more complex aspects of telephony and all user-interface operations are handled by the call manager application, telephony-enabled applications need not be modified in any substantial way.</span></span> <span data-ttu-id="59bfc-133">En fait, les applications qui permettent à cette opération d’être appelées à partir de leur langage de script intégré n’ont peut-être pas besoin d’être modifiées du tout.</span><span class="sxs-lookup"><span data-stu-id="59bfc-133">In fact, applications that allow this operation to be invoked from their built-in script language may not need to be modified at all.</span></span>

<span data-ttu-id="59bfc-134">La fonction [**tapiGetLocationInfo**](/windows/win32/api/tapi/nf-tapi-tapigetlocationinfo) retourne à l’application le code du pays ou de la région et la ville (zone) définis par l’utilisateur dans les paramètres de l’emplacement actuel dans le panneau de configuration de la téléphonie.</span><span class="sxs-lookup"><span data-stu-id="59bfc-134">The [**tapiGetLocationInfo**](/windows/win32/api/tapi/nf-tapi-tapigetlocationinfo) function returns to the application the country or region code and city (area) code that the user has set in the current location parameters in the Telephony Control Panel.</span></span> <span data-ttu-id="59bfc-135">L’application peut utiliser ces informations pour aider l’utilisateur à créer des numéros de téléphone canoniques corrects, par exemple en les proposant par défaut lorsque de nouveaux nombres sont entrés dans une entrée d’annuaire téléphonique ou un enregistrement de base de données.</span><span class="sxs-lookup"><span data-stu-id="59bfc-135">The application can use this information to assist the user in forming proper canonical telephone numbers, such as by offering these as defaults when new numbers are entered in a phone book entry or database record.</span></span>

## <a name="request-recipients"></a><span data-ttu-id="59bfc-136">Destinataires de la demande</span><span class="sxs-lookup"><span data-stu-id="59bfc-136">Request Recipients</span></span>

<span data-ttu-id="59bfc-137">Deux types d’applications sont nécessaires pour exécuter la téléphonie assistée.</span><span class="sxs-lookup"><span data-stu-id="59bfc-137">Two kinds of applications are needed to run Assisted Telephony.</span></span> <span data-ttu-id="59bfc-138">Les *clients* de téléphonie assistée sont des applications qui utilisent la téléphonie assistée en appelant les fonctions qui ont le préfixe « TAPI ».</span><span class="sxs-lookup"><span data-stu-id="59bfc-138">Assisted Telephony *clients* are applications that use Assisted Telephony by calling the functions that have the prefix "tapi."</span></span> <span data-ttu-id="59bfc-139">Un exemple d’une telle application cliente est une feuille de calcul à laquelle une commande de menu ou un bouton de barre d’outils de **numérotation** est ajouté.</span><span class="sxs-lookup"><span data-stu-id="59bfc-139">An example of such a client application would be a spreadsheet to which a **Dial** menu command or toolbar button is added.</span></span>

<span data-ttu-id="59bfc-140">Les *serveurs* de téléphonie assistés sont des applications qui peuvent exécuter des fonctions d’API de téléphonie qui résultent d’un appel d’une autre application à une fonction de préfixe « TAPI ».</span><span class="sxs-lookup"><span data-stu-id="59bfc-140">Assisted Telephony *servers* are applications that can execute Telephony API functions that result from another application's call to a "tapi"-prefixed function.</span></span> <span data-ttu-id="59bfc-141">Pour se faire connaître comme un serveur de téléphonie assisté, une telle application s’inscrit comme un serveur à l’aide de la fonction [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) .</span><span class="sxs-lookup"><span data-stu-id="59bfc-141">To make itself known as an Assisted Telephony server, such an application registers as one using the [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) function.</span></span>

<span data-ttu-id="59bfc-142">Les fonctions de téléphonie assistée (qui commencent par le préfixe « TAPI ») sont appelées *fonctions de requête*.</span><span class="sxs-lookup"><span data-stu-id="59bfc-142">The functions of Assisted Telephony (which begin with the prefix "tapi") are known as *request functions*.</span></span> <span data-ttu-id="59bfc-143">Les applications de téléphonie assistée qui traitent ces demandes (les serveurs de téléphonie assistés) sont appelées *destinataires de demande*.</span><span class="sxs-lookup"><span data-stu-id="59bfc-143">Assisted Telephony applications that process these requests—Assisted Telephony servers—are called *request recipients*.</span></span>

## <a name="processing-assisted-telephony-requests"></a><span data-ttu-id="59bfc-144">Traitement des demandes de téléphonie assistée</span><span class="sxs-lookup"><span data-stu-id="59bfc-144">Processing Assisted Telephony Requests</span></span>

<span data-ttu-id="59bfc-145">Le processus avec lequel les demandes sont remises et traitées est le suivant :</span><span class="sxs-lookup"><span data-stu-id="59bfc-145">The process with which requests are delivered and serviced is as follows:</span></span>

1.  <span data-ttu-id="59bfc-146">Lorsque TAPI reçoit une demande de téléphonie assistée, il recherche un destinataire de demande, c’est-à-dire une application actuellement inscrite pour traiter ce type de demande.</span><span class="sxs-lookup"><span data-stu-id="59bfc-146">When TAPI receives an Assisted Telephony request, it checks for a request recipient, that is, an application currently registered to process that type of request.</span></span> <span data-ttu-id="59bfc-147">S’il existe un destinataire de demande, la demande est mise en file d’attente et l’application de priorité la plus élevée qui a été inscrite pour le service de cette requête reçoit un message de [**\_ demande de ligne**](./line-request.md) .</span><span class="sxs-lookup"><span data-stu-id="59bfc-147">If there is a request recipient, the request is queued, and the highest-priority application that has registered for that request's service is sent a [**LINE\_REQUEST**](./line-request.md) message.</span></span> <span data-ttu-id="59bfc-148">Le message avertit le destinataire de la demande qu’une nouvelle demande est arrivée et contient une indication du mode de la demande.</span><span class="sxs-lookup"><span data-stu-id="59bfc-148">The message notifies the request recipient that a new request has arrived, and it carries an indication of the request's mode.</span></span>
2.  <span data-ttu-id="59bfc-149">Si l’interface TAPI ne parvient pas à trouver une application en cours d’exécution pour traiter une telle requête, elle tente de lancer une application qui a été inscrite comme capable de le faire.</span><span class="sxs-lookup"><span data-stu-id="59bfc-149">If TAPI cannot find a currently running application to process such a request, it tries to launch an application that has been registered as capable of doing so.</span></span> <span data-ttu-id="59bfc-150">Ces informations d’inscription sont enregistrées dans **HandoffPriorities** dans le registre.</span><span class="sxs-lookup"><span data-stu-id="59bfc-150">This registration information is recorded in **HandoffPriorities** in the registry.</span></span> <span data-ttu-id="59bfc-151">L’interface TAPI tente de lancer des applications dans l’ordre dans lequel elles sont répertoriées dans la section **HandoffPriorities** .</span><span class="sxs-lookup"><span data-stu-id="59bfc-151">TAPI tries to launch applications in the order in which they are listed in the **HandoffPriorities** section.</span></span> <span data-ttu-id="59bfc-152">(Voir l’étape suivante.)</span><span class="sxs-lookup"><span data-stu-id="59bfc-152">(See the following step.)</span></span>

    <span data-ttu-id="59bfc-153">Si aucune application n’est actuellement inscrite, TAPI examine la liste des applications de traitement des requêtes sur l’entrée associée dans **HandoffPriorities**.</span><span class="sxs-lookup"><span data-stu-id="59bfc-153">If no application is currently registered, TAPI examines the list of request-processing applications on the associated entry in **HandoffPriorities**.</span></span> <span data-ttu-id="59bfc-154">Si la ligne associée ne figure pas dans le fichier, si aucune application n’est répertoriée sur celle-ci, ou si aucune des applications de la liste ne peut être lancée, la demande est rejetée avec l’erreur TAPIERR \_ NOREQUESTRECIPIENT.</span><span class="sxs-lookup"><span data-stu-id="59bfc-154">If the associated line is missing from the file, if there are no applications listed on it, or if none of the applications in the list can be launched, the request is rejected with the error TAPIERR\_NOREQUESTRECIPIENT.</span></span>

    <span data-ttu-id="59bfc-155">Lorsqu’un destinataire de la demande est lancé (qu’il ait été lancé ou non par TAPI), il doit appeler [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) pendant le processus de démarrage et s’inscrire lui-même en tant que destinataire de la demande.</span><span class="sxs-lookup"><span data-stu-id="59bfc-155">When a request recipient is launched (whether or not it has been launched by TAPI) it is its duty to call [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) during the startup process and register itself as a request recipient.</span></span>

3.  <span data-ttu-id="59bfc-156">Si une ou plusieurs applications sont répertoriées dans l’entrée, TAPI commence par la première application répertoriée (priorité la plus élevée) et tente de la lancer à l’aide de la fonction [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) .</span><span class="sxs-lookup"><span data-stu-id="59bfc-156">If one or more applications are listed in the entry, TAPI begins with the first listed application (highest priority), and attempts to launch it using the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function.</span></span> <span data-ttu-id="59bfc-157">Si la tentative de lancement de l’application échoue, TAPI tente de lancer l’application suivante dans la liste.</span><span class="sxs-lookup"><span data-stu-id="59bfc-157">If the attempt to launch the application fails, TAPI attempts to launch the next application in the list.</span></span> <span data-ttu-id="59bfc-158">Quand une application est lancée avec succès, TAPI met simplement en file d’attente la demande et renvoie une indication de succès à l’application, même si la demande n’a pas encore été signalée au destinataire de la demande.</span><span class="sxs-lookup"><span data-stu-id="59bfc-158">When any application launches successfully, TAPI simply queues the request and returns a success indication to the application even though the request hasn't yet been signaled to the request recipient.</span></span>

    <span data-ttu-id="59bfc-159">Une fois l’application destinataire de la demande lancée, elle appelle [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), ce qui entraîne l’envoi d’un message de [**\_ demande de ligne**](./line-request.md) , signalant que la demande est mise en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="59bfc-159">After the request recipient application is launched, it calls [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), which causes a [**LINE\_REQUEST**](./line-request.md) message to be sent, signaling that the request is queued.</span></span> <span data-ttu-id="59bfc-160">Si, pour une raison quelconque, l’application lancée ne s’inscrit jamais, la demande reste en file d’attente et reste dans la file d’attente indéfiniment jusqu’à ce qu’une application s’inscrive pour ce type de demande.</span><span class="sxs-lookup"><span data-stu-id="59bfc-160">If for some reason the launched application never registers, the request remains queued and remains in the queue indefinitely until an application registers for that type of request.</span></span>

4.  <span data-ttu-id="59bfc-161">Si l’interface TAPI détecte qu’une telle application inscrite est déjà en cours d’exécution ou qu’elle en lance une, elle met la demande en file d’attente, envoie un \_ message de demande de ligne à l’application serveur et retourne une indication de réussite pour l’appel de fonction à l’application de téléphonie assistée.</span><span class="sxs-lookup"><span data-stu-id="59bfc-161">If TAPI finds such a registered application already running or successfully launches one, it queues the request, sending a LINE\_REQUEST message to the server application, and returns a success indication for the function call to the Assisted Telephony application.</span></span> <span data-ttu-id="59bfc-162">Ce message de réussite indique uniquement que la demande a été acceptée et en file d’attente, et non qu’elle a été exécutée avec succès.</span><span class="sxs-lookup"><span data-stu-id="59bfc-162">This success message states only that the request has been accepted and queued, not that it has been successfully executed.</span></span>

<span data-ttu-id="59bfc-163">Lorsque l’application serveur est prête à traiter une demande, elle appelle la fonction [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) .</span><span class="sxs-lookup"><span data-stu-id="59bfc-163">When the server application is ready to process a request, it calls the [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) function.</span></span> <span data-ttu-id="59bfc-164">Cela lui permet de recevoir toutes les informations dont il a besoin, par exemple une adresse à composer.</span><span class="sxs-lookup"><span data-stu-id="59bfc-164">This lets it receive any information it needs, such as an address to dial.</span></span> <span data-ttu-id="59bfc-165">Il traite ensuite la demande, à l’aide des fonctions TAPI (telles que [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) et [**lineDrop**](/windows/win32/api/tapi/nf-tapi-linedrop)) qui seraient autrement utilisées pour passer l’appel.</span><span class="sxs-lookup"><span data-stu-id="59bfc-165">It then processes the request, using the TAPI functions (such as [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) and [**lineDrop**](/windows/win32/api/tapi/nf-tapi-linedrop)) that would otherwise be used to place the call.</span></span> <span data-ttu-id="59bfc-166">L’appel de **lineGetRequest** supprime la requête de l’interface TAPI et les paramètres de la demande sont copiés dans une mémoire tampon de demande allouée par l’application.</span><span class="sxs-lookup"><span data-stu-id="59bfc-166">Invoking **lineGetRequest** removes the request from TAPI, and the request parameters are copied in an application-allocated request buffer.</span></span> <span data-ttu-id="59bfc-167">La taille et l’interprétation du contenu de la mémoire tampon varient en fonction du mode de demande.</span><span class="sxs-lookup"><span data-stu-id="59bfc-167">The size and interpretation of the contents of the buffer depend on the request mode.</span></span>

<span data-ttu-id="59bfc-168">Le serveur doit s’assurer qu’il utilise les paramètres corrects lors de l’exécution des requêtes.</span><span class="sxs-lookup"><span data-stu-id="59bfc-168">The server must ensure that it uses the correct parameters when executing requests.</span></span> <span data-ttu-id="59bfc-169">Lorsque vous procédez ainsi, ces étapes sont suivies :</span><span class="sxs-lookup"><span data-stu-id="59bfc-169">When doing so, these steps are followed:</span></span>

1.  <span data-ttu-id="59bfc-170">Le destinataire de la demande reçoit d’abord un message de [**\_ demande de ligne**](./line-request.md) l’informant que des demandes peuvent exister dans la file d’attente des demandes.</span><span class="sxs-lookup"><span data-stu-id="59bfc-170">The request recipient first receives a [**LINE\_REQUEST**](./line-request.md) message informing it that requests can exist for it in the request queue.</span></span> <span data-ttu-id="59bfc-171">Cela indique à l’application d’appeler [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) et de continuer à l’appeler jusqu’à ce que la file d’attente soit vidée (si la demande est pour effectuer un nouvel appel) ou de supprimer un appel existant.</span><span class="sxs-lookup"><span data-stu-id="59bfc-171">This tells the application to call [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) and keep calling it until the queue is drained (if the request is for making a new call), or to drop an existing call.</span></span> <span data-ttu-id="59bfc-172">Ce message ne contient pas les paramètres de la demande, sauf dans le cas d’une demande de suppression d’un appel existant.</span><span class="sxs-lookup"><span data-stu-id="59bfc-172">This message does not contain the parameters for the request, except in the case of a request to drop an existing call.</span></span>
2.  <span data-ttu-id="59bfc-173">Si la demande consiste à effectuer un nouvel appel, le serveur de téléphonie assisté utilise la fonction [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) pour récupérer la demande complète, qui comprend les paramètres de la demande.</span><span class="sxs-lookup"><span data-stu-id="59bfc-173">If the request is to make a new call, the Assisted Telephony server uses the [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) function to retrieve the full request, which includes the request's parameters.</span></span> <span data-ttu-id="59bfc-174">Le serveur dispose maintenant de toutes les informations dont il a besoin, telles que le numéro de connexion ou l’identification du créateur de la demande.</span><span class="sxs-lookup"><span data-stu-id="59bfc-174">The server now has all the information it needs, such as the number to dial or the identification of the maker of the request.</span></span> <span data-ttu-id="59bfc-175">Toutefois, le serveur doit d’abord allouer la mémoire nécessaire pour stocker ces informations.</span><span class="sxs-lookup"><span data-stu-id="59bfc-175">First, however, the server must allocate the memory needed to store this information.</span></span>
3.  <span data-ttu-id="59bfc-176">Enfin, le serveur exécute la requête en appelant la fonction TAPI appropriée ou le jeu de fonctions approprié.</span><span class="sxs-lookup"><span data-stu-id="59bfc-176">Finally, the server executes the request by invoking the appropriate TAPI function or set of functions.</span></span>

<span data-ttu-id="59bfc-177">Si l’interface TAPI ne peut pas lancer une application pouvant servir de destinataire de demande, l’appel de téléphonie assisté échoue et retourne l’erreur TAPIERR \_ NOREQUESTRECIPIENT.</span><span class="sxs-lookup"><span data-stu-id="59bfc-177">If TAPI cannot launch an application capable of serving as a request recipient, the Assisted Telephony call fails and returns the error TAPIERR\_NOREQUESTRECIPIENT.</span></span>

## <a name="notes-on-request-recipient-operations"></a><span data-ttu-id="59bfc-178">Remarques sur les opérations du destinataire de la demande</span><span class="sxs-lookup"><span data-stu-id="59bfc-178">Notes on Request Recipient Operations</span></span>

<span data-ttu-id="59bfc-179">Les informations suivantes concernent les systèmes sur lesquels les demandes de téléphonie assistée sont traitées :</span><span class="sxs-lookup"><span data-stu-id="59bfc-179">The following information concerns systems on which Assisted Telephony requests are processed:</span></span>

-   <span data-ttu-id="59bfc-180">Le registre par défaut doit répertorier une application de gestionnaire d’appels dans la liste des priorités pour [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall).</span><span class="sxs-lookup"><span data-stu-id="59bfc-180">The default registry should list a call manager application in the priority list for [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall).</span></span> <span data-ttu-id="59bfc-181">Il serait utile, mais pas essentiel, que l’application du gestionnaire d’appels ait une option de menu qui permette aux utilisateurs de définir la priorité la plus élevée.</span><span class="sxs-lookup"><span data-stu-id="59bfc-181">It would be helpful, but not essential, for the call manager application to have a menu option that allows users to set it to the highest priority.</span></span>
-   <span data-ttu-id="59bfc-182">Quand une application de destinataire de téléphonie assistée est lancée automatiquement par TAPI et s’il s’agit de la seule application TAPI dans le système, cette action Initialise l’interface TAPI.</span><span class="sxs-lookup"><span data-stu-id="59bfc-182">When an Assisted Telephony recipient application is launched automatically by TAPI and if it is the only TAPI application in the system, this action initializes TAPI.</span></span> <span data-ttu-id="59bfc-183">Si l’application de destinataire de téléphonie assistée initialise et arrête l’appareil de ligne avant d’inscrire des demandes de téléphonie assistée, TAPI est également arrêté et la demande de téléphonie assistée est perdue.</span><span class="sxs-lookup"><span data-stu-id="59bfc-183">If the Assisted Telephony recipient application initializes and shuts down the line device before registering for Assisted Telephony requests, TAPI is shut down as well, and the Assisted Telephony request is lost.</span></span> <span data-ttu-id="59bfc-184">Les demandes de téléphonie assistée peuvent également être perdues lorsqu’une autre application TAPI lancée exécute un initialisation et un arrêt.</span><span class="sxs-lookup"><span data-stu-id="59bfc-184">Assisted Telephony requests might also be lost when another TAPI application that is launched performs an initialize and shutdown.</span></span>

 

 
