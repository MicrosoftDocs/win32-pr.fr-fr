---
description: L’interface MSPI (Media Service Provider Interface) est un ensemble d’interfaces et de méthodes implémentées par un MSP pour permettre au contrôle de l’application TAPI 3 sur le transport multimédia au cours d’une session de communication.
ms.assetid: 53b7bcbd-571a-44da-a6db-10d4c3e5d30a
title: MSPI (Media Service Provider Interface)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b1ce09e626ede14515c0abbbd5c3a35921026d6
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/03/2021
ms.locfileid: "106522884"
---
# <a name="media-service-provider-interface-mspi"></a><span data-ttu-id="2d421-103">MSPI (Media Service Provider Interface)</span><span class="sxs-lookup"><span data-stu-id="2d421-103">Media Service Provider Interface (MSPI)</span></span>

<span data-ttu-id="2d421-104">L’interface MSPI (Media Service Provider Interface) est un ensemble d’interfaces et de méthodes implémentées par un MSP pour permettre au contrôle de l’application TAPI 3 sur le transport multimédia au cours d’une session de communication.</span><span class="sxs-lookup"><span data-stu-id="2d421-104">The Media Service Provider Interface (MSPI) is a set of interfaces and methods implemented by an MSP to allow a TAPI 3 application control over media transport during a communications session.</span></span> <span data-ttu-id="2d421-105">Un MSP gère les mécanismes spécifiques à l’appareil et spécifiques au protocole nécessaires pour mettre en œuvre ces contrôles, et communique avec son PVC couplé ou une application à l’aide des méthodes fournies dans le MSPI.</span><span class="sxs-lookup"><span data-stu-id="2d421-105">An MSP handles the device-specific and protocol-specific mechanisms needed to enact these controls, and communicates with its paired TSP or an application through use of the methods provided in the MSPI.</span></span>

<span data-ttu-id="2d421-106">La section suivante ( [référence MspI (Media Service Provider Interface)](media-service-provider-interface-mspi-reference.md)) détaille les interfaces qu’un MSP expose afin d’interagir avec l’environnement de téléphonie Microsoft.</span><span class="sxs-lookup"><span data-stu-id="2d421-106">The following section ( [Media Service Provider Interface (MSPI) Reference](media-service-provider-interface-mspi-reference.md)) details the interfaces an MSP exposes in order to interact with the Microsoft Telephony environment.</span></span>

<span data-ttu-id="2d421-107">En outre, un MSP peut exposer des interfaces et des méthodes privées spécifiques au fournisseur pour faciliter le contrôle multimédia.</span><span class="sxs-lookup"><span data-stu-id="2d421-107">In addition, an MSP may expose provider-specific private interfaces and methods to further assist in media control.</span></span> <span data-ttu-id="2d421-108">Par exemple, le [MSP de conférence IP](ipconf-msp.md) expose des interfaces qui fournissent un contrôle de participant.</span><span class="sxs-lookup"><span data-stu-id="2d421-108">For example, the [IP Conference MSP](ipconf-msp.md) exposes interfaces that provide participant control.</span></span> <span data-ttu-id="2d421-109">Pour plus d’informations sur la façon dont les objets privés fonctionnent et les [interfaces MSP ipconf](ipconf-msp-interfaces.md) pour une liste de références de ipconf, consultez [interfaces spécifiques au fournisseur](provider-specific-interfaces.md) .</span><span class="sxs-lookup"><span data-stu-id="2d421-109">See [Provider-Specific Interfaces](provider-specific-interfaces.md) for information on how private objects work and [IPConf MSP Interfaces](ipconf-msp-interfaces.md) for a reference listing of IPConf.</span></span>

<span data-ttu-id="2d421-110">La majeure partie de l’effort de programmation pour la création d’un MSP est très spécifique à une plateforme, un appareil et un protocole de transport donnés, et sort du cadre de ce document.</span><span class="sxs-lookup"><span data-stu-id="2d421-110">The majority of the programming effort in creating an MSP is highly specific to a given platform, device, and transport protocol, and is outside the scope of this document.</span></span> <span data-ttu-id="2d421-111">Toutefois, Microsoft fournit un ensemble de classes de base MSP, qui sera utile pour la plupart des auteurs MSP.</span><span class="sxs-lookup"><span data-stu-id="2d421-111">However, Microsoft supplies a set of MSP base classes, which will be useful to most MSP authors.</span></span> <span data-ttu-id="2d421-112">Pour plus d’informations sur l’utilisation de ces classes, consultez [classes de base TAPI 3 MSP](tapi-3-msp-base-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="2d421-112">See [TAPI 3 MSP Base Classes](tapi-3-msp-base-classes.md) for information on using these classes.</span></span>

<span data-ttu-id="2d421-113">L’interface [**ITMSPAddress**](/windows/desktop/api/msp/nn-msp-itmspaddress) représente un fournisseur de services multimédia pour la dll TAPI.</span><span class="sxs-lookup"><span data-stu-id="2d421-113">The [**ITMSPAddress**](/windows/desktop/api/msp/nn-msp-itmspaddress) interface represents a media service provider to the TAPI DLL.</span></span> <span data-ttu-id="2d421-114">Cette interface n’est pas utilisée par ou exposée à une application d’utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="2d421-114">This interface is not used by or exposed to an end-user application.</span></span> <span data-ttu-id="2d421-115">La DLL TAPI 3 appelle **CoCreateInstance** sur cette interface pour créer l’objet principal MSP.</span><span class="sxs-lookup"><span data-stu-id="2d421-115">The TAPI 3 DLL calls **CoCreateInstance** on this interface to create the main MSP object.</span></span> <span data-ttu-id="2d421-116">Les méthodes de cet objet permettent à une application de charger et décharger le MSP, de recevoir des informations d’un TSP et de créer l’interface [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) , qui est exposée sur l’objet d’appel.</span><span class="sxs-lookup"><span data-stu-id="2d421-116">Methods on this object allow an application to load and unload the MSP, receive information from a TSP, and create the [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) interface, which is exposed on the call object.</span></span>

<span data-ttu-id="2d421-117">Les interfaces [**ITSubStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstreamcontrol) et [**ITSubStream**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstream) fournissent des méthodes parallèles en ce qui concerne les sous-flux.</span><span class="sxs-lookup"><span data-stu-id="2d421-117">The [**ITSubStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstreamcontrol) and [**ITSubStream**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstream) interfaces provide parallel methods with respect to substreams.</span></span> <span data-ttu-id="2d421-118">La prise en charge des sous-flux est facultative.</span><span class="sxs-lookup"><span data-stu-id="2d421-118">Substream support is optional.</span></span> <span data-ttu-id="2d421-119">Toutes les autres interfaces doivent être implémentées par un MSP.</span><span class="sxs-lookup"><span data-stu-id="2d421-119">All other interfaces must be implemented by an MSP.</span></span>

> [!Note]  
> <span data-ttu-id="2d421-120">Les opérations implémentées par une paire TSP/MSP doivent se trouver dans une DLL pour permettre à un utilisateur de mettre à jour le fournisseur de services sans redémarrer son système.</span><span class="sxs-lookup"><span data-stu-id="2d421-120">Operations implemented by a TSP/MSP pair must be located in one DLL to allow a user to update the service provider without rebooting his or her system.</span></span>

 

 

 
