---
description: L’interface IWiaImageFilter est une interface d’extension implémentée par les développeurs de filtre de traitement d’image et appelée par WIA (Windows Image Acquisition) 2,0.
ms.assetid: 2abe913b-bb2b-486d-a3f4-d5932433fc82
title: Interface IWiaImageFilter (WIA. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- IWiaImageFilter
api_type:
- COM
api_location:
- Wia.h
ms.openlocfilehash: 8d859b79d15db627bb09cb60f758791a8b5860f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103865241"
---
# <a name="iwiaimagefilter-interface"></a><span data-ttu-id="eb3c6-103">Interface IWiaImageFilter</span><span class="sxs-lookup"><span data-stu-id="eb3c6-103">IWiaImageFilter interface</span></span>

<span data-ttu-id="eb3c6-104">L’interface **IWiaImageFilter** est une interface d’extension implémentée par les développeurs de filtre de traitement d’image et appelée par WIA (Windows Image Acquisition) 2,0.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-104">The **IWiaImageFilter** interface is an extension interface implemented by image processing filter developers and called by Windows Image Acquisition (WIA) 2.0.</span></span>

## <a name="members"></a><span data-ttu-id="eb3c6-105">Membres</span><span class="sxs-lookup"><span data-stu-id="eb3c6-105">Members</span></span>

<span data-ttu-id="eb3c6-106">L’interface **IWiaImageFilter** hérite de l’interface [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="eb3c6-106">The **IWiaImageFilter** interface inherits from the [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="eb3c6-107">**IWiaImageFilter** a également les types de membres suivants :</span><span class="sxs-lookup"><span data-stu-id="eb3c6-107">**IWiaImageFilter** also has these types of members:</span></span>

-   [<span data-ttu-id="eb3c6-108">Méthodes</span><span class="sxs-lookup"><span data-stu-id="eb3c6-108">Methods</span></span>](#methods)

### <a name="methods"></a><span data-ttu-id="eb3c6-109">Méthodes</span><span class="sxs-lookup"><span data-stu-id="eb3c6-109">Methods</span></span>

<span data-ttu-id="eb3c6-110">L’interface **IWiaImageFilter** possède ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-110">The **IWiaImageFilter** interface has these methods.</span></span>



| <span data-ttu-id="eb3c6-111">Méthode</span><span class="sxs-lookup"><span data-stu-id="eb3c6-111">Method</span></span>                                                                | <span data-ttu-id="eb3c6-112">Description</span><span class="sxs-lookup"><span data-stu-id="eb3c6-112">Description</span></span>                                                                                             |
|:----------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="eb3c6-113">**ApplyProperties**</span><span class="sxs-lookup"><span data-stu-id="eb3c6-113">**ApplyProperties**</span></span>](-wia-iwiaimagefilter-applyproperties.md)       | <span data-ttu-id="eb3c6-114">Permet au filtre de traitement d’image d’écrire des propriétés sur le pilote (et l’appareil).</span><span class="sxs-lookup"><span data-stu-id="eb3c6-114">Enables the image processing filter to write properties back to the driver (and device).</span></span><br/>     |
| [<span data-ttu-id="eb3c6-115">**FilterPreviewImage**</span><span class="sxs-lookup"><span data-stu-id="eb3c6-115">**FilterPreviewImage**</span></span>](-wia-iwiaimagefilter-filterpreviewimage.md) | <span data-ttu-id="eb3c6-116">Filtre l’image d’aperçu.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-116">Filters the preview image.</span></span><br/>                                                                   |
| [<span data-ttu-id="eb3c6-117">**InitializeFilter**</span><span class="sxs-lookup"><span data-stu-id="eb3c6-117">**InitializeFilter**</span></span>](-wia-iwiaimagefilter-initializefilter.md)     | <span data-ttu-id="eb3c6-118">Initialise le filtre.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-118">Initializes the filter.</span></span> <span data-ttu-id="eb3c6-119">Appelée par WIA 2,0 avant chaque téléchargement d’image.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-119">Called by WIA 2.0 before each image download.</span></span> <br/>                       |
| [<span data-ttu-id="eb3c6-120">**SetNewCallback**</span><span class="sxs-lookup"><span data-stu-id="eb3c6-120">**SetNewCallback**</span></span>](-wia-iwiaimagefilter-setnewcallback.md)         | <span data-ttu-id="eb3c6-121">Définit un nouveau rappel d’application pour le filtre de traitement d’image à utiliser pour le transfert des appels.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-121">Sets a new application callback for the image processing filter to use for forwarding calls.</span></span><br/> |



 

## <a name="remarks"></a><span data-ttu-id="eb3c6-122">Notes</span><span class="sxs-lookup"><span data-stu-id="eb3c6-122">Remarks</span></span>

<span data-ttu-id="eb3c6-123">Les développeurs de filtres de traitement d’images doivent implémenter cette interface et l’interface [**IWiaTransferCallback**](-wia-iwiatransfercallback.md) .</span><span class="sxs-lookup"><span data-stu-id="eb3c6-123">Image processing filter developers should implement this interface and the [**IWiaTransferCallback**](-wia-iwiatransfercallback.md) interface.</span></span>

<span data-ttu-id="eb3c6-124">WIA 2,0 appelle des méthodes de filtre.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-124">WIA 2.0 calls filter methods.</span></span> <span data-ttu-id="eb3c6-125">Elles ne sont jamais appelées directement à partir d’une application.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-125">They are never called directly from an application.</span></span>

<span data-ttu-id="eb3c6-126">Microsoft fournit le composant WIA 2,0 Preview, qui met en cache l’image d’aperçu non filtrée d’origine obtenue à partir du scanneur.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-126">Microsoft supplies the WIA 2.0 Preview Component, which caches the original, unfiltered preview image that is acquired from the scanner.</span></span> <span data-ttu-id="eb3c6-127">Une application utilise [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) pour co-créer une instance du composant WIA 2,0 Preview (CLSID \_ WiaPreview), qui charge le filtre à l’aide de [**IWiaItem2 :: GetExtension**](-wia-iwiaitem2-getextension.md).</span><span class="sxs-lookup"><span data-stu-id="eb3c6-127">An application uses [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to co-create an instance of the WIA 2.0 Preview Component (CLSID\_WiaPreview), which loads the filter using [**IWiaItem2::GetExtension**](-wia-iwiaitem2-getextension.md).</span></span> <span data-ttu-id="eb3c6-128">Le filtre est appelé automatiquement quand l’application appelle [**IWiaTransfer ::D lécharger**](-wia-iwiatransfer-download.md).</span><span class="sxs-lookup"><span data-stu-id="eb3c6-128">The filter is called automatically when the application calls [**IWiaTransfer::Download**](-wia-iwiatransfer-download.md).</span></span>

<span data-ttu-id="eb3c6-129">Le filtre de traitement d’image est toujours exécuté lors de l’analyse d’une image.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-129">The image processing filter is always executed when an image is scanned.</span></span> <span data-ttu-id="eb3c6-130">Une application ne peut pas acquérir une image à partir du scanneur sans appliquer d’abord le filtre d’acquisition d’images.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-130">An application cannot acquire an image from the scanner without having the imaging filter applied first.</span></span>

<span data-ttu-id="eb3c6-131">Un filtre doit implémenter une luminosité et un contraste au minimum.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-131">A filter must implement brightness and contrast at a minimum.</span></span> <span data-ttu-id="eb3c6-132">L’interface utilisateur commune, qui fournit des contrôles de luminosité et de contraste à l’utilisateur, peut afficher des aperçus précis de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-132">The common UI, which provides brightness and contrast controls to the user, can display accurate previews to the user.</span></span>

<span data-ttu-id="eb3c6-133">Un filtre de traitement d’image ne doit jamais modifier le membre *lMessage* de la structure [**WiaTransferParams**](-wia-wiatransferparams.md) .</span><span class="sxs-lookup"><span data-stu-id="eb3c6-133">An image processing filter should never modify the *lMessage* member of the [**WiaTransferParams**](-wia-wiatransferparams.md) structure.</span></span>

<span data-ttu-id="eb3c6-134">Pour lire les propriétés requises, le filtre de traitement d’image doit appeler [**IWiaPropertyStorage :: GetPropertyStream**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiapropertystorage-getpropertystream) sur l’interface [**IWiaPropertyStorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) qu’il obtient de l’élément en appelant [IWiaImageFilter :: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="eb3c6-134">To read the required properties the image processing filter should call [**IWiaPropertyStorage::GetPropertyStream**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiapropertystorage-getpropertystream) on the [**IWiaPropertyStorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) interface that it gets from the item by calling [IWiaImageFilter::QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span> <span data-ttu-id="eb3c6-135">Le filtre peut ensuite instancier une instance [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) sur ce flux pour lire les propriétés des éléments.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-135">The filter can then instantiate an [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) instance on this stream to read the items properties.</span></span> <span data-ttu-id="eb3c6-136">Le filtre de traitement d’image ne doit pas appeler [IWiaPropertyStorage :: ReadMultiple](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-readmultiple) directement, car cette méthode appelle le pilote `drvReadItemProperties` , mais le service WIA 2,0 a déjà verrouillé le pilote dans l' `drvAcquireItemData` appel afin que cet appel expire et échoue.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-136">The image processing filter should not call [IWiaPropertyStorage::ReadMultiple](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-readmultiple) directly because this method calls into the driver's `drvReadItemProperties`, but the WIA 2.0 service has already locked the driver in the `drvAcquireItemData` call so this call will timeout and fail.</span></span>

<span data-ttu-id="eb3c6-137">Les propriétés qui intéressent le filtre peuvent, par exemple, être les paramètres de luminosité et de contraste.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-137">The properties that the filter is interested in could for example be the brightness and contrast settings.</span></span> <span data-ttu-id="eb3c6-138">En règle générale, le filtre doit également lire le format d’image, ainsi que la propriété Preview, [**WIA \_ DPS \_ preview**](-wia-wiaitempropscannerdevice.md), à partir de *pWiaItem2*.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-138">The filter typically also needs to read the image format as well as the preview property, [**WIA\_DPS\_PREVIEW**](-wia-wiaitempropscannerdevice.md), from *pWiaItem2*.</span></span> <span data-ttu-id="eb3c6-139">Ces propriétés sont toutes utilisées dans le processus de filtrage.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-139">These properties are all used in the filtering process.</span></span>

<span data-ttu-id="eb3c6-140">Les composants WIA 2,0 écrivent toujours des données non filtrées dans le filtre de traitement d’image.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-140">The WIA 2.0 components always writes unfiltered data into the image processing filter.</span></span> <span data-ttu-id="eb3c6-141">L’algorithme de traitement d’image implémenté par le flux du filtre peut filtrer les données plusieurs fois et n’a pas à se préoccuper de produire les mêmes résultats que de filtrer les données une seule fois.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-141">The image processing algorithm implemented by the filter's stream can filter the data more than once and does not have to be concerned with producing the same results as filtering the data once.</span></span>

<span data-ttu-id="eb3c6-142">Le filtre doit prêter attention à la propriété d' [**\_ \_ Aperçu du DPS WIA**](-wia-wiaitempropscannerdevice.md) , en particulier si certaines tâches liées aux filtres sont gérées dans le matériel.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-142">The filter must pay attention to the [**WIA\_DPS\_PREVIEW**](-wia-wiaitempropscannerdevice.md) property, especially if some filter related tasks are handled in hardware.</span></span> <span data-ttu-id="eb3c6-143">Par exemple, un certain pilote peut modifier la luminosité de la lampe dans le matériel du scanneur en fonction de la façon dont l’application a défini la luminosité dans un élément WIA 2,0.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-143">For example, a certain driver can change the brightness of the lamp in the scanner hardware depending on how the application has set the brightness into a WIA 2.0 item.</span></span> <span data-ttu-id="eb3c6-144">Au cours de la dernière analyse (lorsque l’application appelle [**IWiaTransfer ::D lécharger**](-wia-iwiatransfer-download.md)), le pilote modifie généralement la lampe physique du scanneur.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-144">During the final scan (when the application calls [**IWiaTransfer::Download**](-wia-iwiatransfer-download.md)) the driver would typically modify the physical lamp of the scanner.</span></span> <span data-ttu-id="eb3c6-145">Dans ce cas, il se peut que le filtre de traitement d’image n’ait pas de traitement de luminosité du tout.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-145">In this case the image processing filter may not have to perform any brightness processing at all.</span></span> <span data-ttu-id="eb3c6-146">Toutefois, au cours d’une analyse de préversion, le pilote ne doit pas modifier la luminosité de la lampe. à la place, il convient de prendre en charge uniquement le filtre de traitement d’image.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-146">During a preview scan, however, the driver should not modify the brightness of the lamp—instead this should be taken care of solely in the image processing filter.</span></span> <span data-ttu-id="eb3c6-147">Il est important que le composant WIA 2,0 Preview et le filtre de traitement d’image renvoient des images exactes en fonction des propriétés définies dans l’élément.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-147">It is important that the WIA 2.0 Preview Component and the image processing filter return accurate images based on the properties set into the item.</span></span>

<span data-ttu-id="eb3c6-148">Un filtre de traitement d’image doit prendre en charge tous les formats d’image pris en charge par le pilote.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-148">An image processing filter must support all image formats that the driver supports.</span></span>

<span data-ttu-id="eb3c6-149">Le filtre de traitement d’image reçoit toujours une image correspondant à la zone de sélection définie dans l’élément pour lequel nous obtenons l’image.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-149">The image processing filter is always given an image corresponding to the selection area set into the item for which we are acquiring the image.</span></span> <span data-ttu-id="eb3c6-150">Notez, toutefois, que l’image peut avoir été pivotée par le pilote en cas de prise en charge de la propriété de [**\_ \_ rotation IPS WIA**](-wia-wiaitempropscanneritem.md) .</span><span class="sxs-lookup"><span data-stu-id="eb3c6-150">Note, however, that the image may have been rotated by the driver in case it supports the [**WIA\_IPS\_ROTATION**](-wia-wiaitempropscanneritem.md) property.</span></span>

<span data-ttu-id="eb3c6-151">Le filtre de traitement d’image est créé via [**IWiaItem2 :: GetExtension**](-wia-iwiaitem2-getextension.md), généralement pas par l’application, mais par les composants WIA 2,0 lorsqu’une application appelle [**IWiaPreview :: GetNewPreview**](-wia-iwiapreview-getnewpreview.md) ou [**IWiaTransfer ::D lécharger**](-wia-iwiatransfer-download.md).</span><span class="sxs-lookup"><span data-stu-id="eb3c6-151">The image processing filter is created through [**IWiaItem2::GetExtension**](-wia-iwiaitem2-getextension.md), typically not by the application but by WIA 2.0 components when an application calls [**IWiaPreview::GetNewPreview**](-wia-iwiapreview-getnewpreview.md) or [**IWiaTransfer::Download**](-wia-iwiatransfer-download.md).</span></span>

<span data-ttu-id="eb3c6-152">L’interface **IWiaImageFilter** , comme toutes les interfaces COM (Component Object Model), hérite des méthodes d’interface [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="eb3c6-152">The **IWiaImageFilter** interface, like all Component Object Model (COM) interfaces, inherits the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface methods.</span></span>



| <span data-ttu-id="eb3c6-153">Méthodes IUnknown</span><span class="sxs-lookup"><span data-stu-id="eb3c6-153">IUnknown Methods</span></span>                                        | <span data-ttu-id="eb3c6-154">Description</span><span class="sxs-lookup"><span data-stu-id="eb3c6-154">Description</span></span>                               |
|---------------------------------------------------------|-------------------------------------------|
| <span data-ttu-id="eb3c6-155">[IUnknown :: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q))</span><span class="sxs-lookup"><span data-stu-id="eb3c6-155">[IUnknown::QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q))</span></span> | <span data-ttu-id="eb3c6-156">Retourne des pointeurs aux interfaces prises en charge.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-156">Returns pointers to supported interfaces.</span></span> |
| [<span data-ttu-id="eb3c6-157">IUnknown :: AddRef</span><span class="sxs-lookup"><span data-stu-id="eb3c6-157">IUnknown::AddRef</span></span>](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref)                 | <span data-ttu-id="eb3c6-158">Incrémente le décompte de références.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-158">Increments reference count.</span></span>               |
| [<span data-ttu-id="eb3c6-159">IUnknown :: Release</span><span class="sxs-lookup"><span data-stu-id="eb3c6-159">IUnknown::Release</span></span>](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)               | <span data-ttu-id="eb3c6-160">Décrémente le décompte de références.</span><span class="sxs-lookup"><span data-stu-id="eb3c6-160">Decrements reference count.</span></span>               |



 

## <a name="requirements"></a><span data-ttu-id="eb3c6-161">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="eb3c6-161">Requirements</span></span>



| <span data-ttu-id="eb3c6-162">Condition requise</span><span class="sxs-lookup"><span data-stu-id="eb3c6-162">Requirement</span></span> | <span data-ttu-id="eb3c6-163">Valeur</span><span class="sxs-lookup"><span data-stu-id="eb3c6-163">Value</span></span> |
|-------------------------------------|------------------------------------------------------------------------------------|
| <span data-ttu-id="eb3c6-164">Client minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="eb3c6-164">Minimum supported client</span></span><br/> | <span data-ttu-id="eb3c6-165">Applications de \[ Bureau Windows Vista uniquement\]</span><span class="sxs-lookup"><span data-stu-id="eb3c6-165">Windows Vista \[desktop apps only\]</span></span><br/>                                     |
| <span data-ttu-id="eb3c6-166">Serveur minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="eb3c6-166">Minimum supported server</span></span><br/> | <span data-ttu-id="eb3c6-167">Applications de bureau Windows Server 2008 \[ uniquement\]</span><span class="sxs-lookup"><span data-stu-id="eb3c6-167">Windows Server 2008 \[desktop apps only\]</span></span><br/>                               |
| <span data-ttu-id="eb3c6-168">En-tête</span><span class="sxs-lookup"><span data-stu-id="eb3c6-168">Header</span></span><br/>                   | <dl> <span data-ttu-id="eb3c6-169"><dt>WIA. h</dt></span><span class="sxs-lookup"><span data-stu-id="eb3c6-169"><dt>Wia.h</dt></span></span> </dl>   |
| <span data-ttu-id="eb3c6-170">MIDL</span><span class="sxs-lookup"><span data-stu-id="eb3c6-170">IDL</span></span><br/>                      | <dl> <span data-ttu-id="eb3c6-171"><dt>WIA. idl</dt></span><span class="sxs-lookup"><span data-stu-id="eb3c6-171"><dt>Wia.idl</dt></span></span> </dl> |



 

 
