---
description: Les applications voient les périphériques WIA (Windows Image Acquisition) comme une arborescence hiérarchique d’objets IWiaItem ou IWiaItem2 avec l’élément racine représentant l’appareil lui-même.
ms.assetid: ae4ded93-09be-4caa-ad6e-1a9071fdb4b6
title: Minipilote WIA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5aadaf55cfe2e8102d4e0e02cf9787b9696e327
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526410"
---
# <a name="wia-minidriver"></a><span data-ttu-id="671c4-103">Minipilote WIA</span><span class="sxs-lookup"><span data-stu-id="671c4-103">WIA Minidriver</span></span>

<span data-ttu-id="671c4-104">Les applications voient les périphériques WIA (Windows Image Acquisition) comme une arborescence hiérarchique d’objets [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) avec l’élément racine représentant l’appareil lui-même.</span><span class="sxs-lookup"><span data-stu-id="671c4-104">Applications see Windows Image Acquisition (WIA) devices as a hierarchical tree of [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) objects with the root item representing the device itself.</span></span> <span data-ttu-id="671c4-105">Les appareils WIA peuvent être utilisés simultanément par plusieurs applications.</span><span class="sxs-lookup"><span data-stu-id="671c4-105">WIA devices may be used concurrently by more than one application.</span></span> <span data-ttu-id="671c4-106">C’est pourquoi il est nécessaire que l’affichage de chaque application d’un objet **IWiaItem** ou **IWiaItem2** soit indépendant des vues d’une autre application.</span><span class="sxs-lookup"><span data-stu-id="671c4-106">It is therefore necessary that each application's view of an **IWiaItem** or **IWiaItem2** object be independent of another application's views.</span></span> <span data-ttu-id="671c4-107">Pour ce faire, vous devez disposer de deux objets Item différents.</span><span class="sxs-lookup"><span data-stu-id="671c4-107">This is accomplished by having two different item objects.</span></span> <span data-ttu-id="671c4-108">Le pilote crée l’arborescence d’éléments de pilote des objets d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) , également appelés éléments de pilote, à l’aide des méthodes de services de pilote WIA.</span><span class="sxs-lookup"><span data-stu-id="671c4-108">The driver creates the driver item tree of [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) objects, also called driver items, using the WIA driver services methods.</span></span> <span data-ttu-id="671c4-109">Il s’agit d’objets globaux que le pilote utilise pour représenter les éléments internes de chaque pilote.</span><span class="sxs-lookup"><span data-stu-id="671c4-109">These are global objects that the driver uses to represent each driver's internal items.</span></span> <span data-ttu-id="671c4-110">Quand une application crée un objet **IWiaItem** ou **IWiaItem2** (également appelé élément d’application), cet objet est lié à l' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) correspondante du pilote dans l’arborescence d’éléments du pilote.</span><span class="sxs-lookup"><span data-stu-id="671c4-110">When an application creates an **IWiaItem** or **IWiaItem2** object (also called an application item), this object is linked to the driver's corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) in the driver item tree.</span></span> <span data-ttu-id="671c4-111">Un décompte de références est conservé sur l’objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) en fonction des règles suivantes :</span><span class="sxs-lookup"><span data-stu-id="671c4-111">A reference count is maintained on the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object subject to the following rules:</span></span>

-   <span data-ttu-id="671c4-112">Lorsqu’un pilote ajoute un objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) à l’arborescence des éléments du pilote, le nombre de références de l’objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) est incrémenté.</span><span class="sxs-lookup"><span data-stu-id="671c4-112">When a driver adds an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object to the driver item tree, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is incremented.</span></span> <span data-ttu-id="671c4-113">Cela se produit généralement lors du traitement de [IWiaMiniDrv ::D rvinitializewia](https://msdn.microsoft.com/library/ms794097.aspx) ou lorsqu’une \_ commande WIA cmd \_ Synchronize est traitée.</span><span class="sxs-lookup"><span data-stu-id="671c4-113">This typically takes place during [IWiaMiniDrv::drvInitializeWia](https://msdn.microsoft.com/library/ms794097.aspx) or when a WIA\_CMD\_SYNCHRONIZE command is processed.</span></span>
-   <span data-ttu-id="671c4-114">Lorsqu’un pilote supprime un objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) de l’arborescence d’éléments de pilote, le décompte de références de l’objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) est décrémenté et l’objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) est marqué afin qu’il ne puisse plus accéder à l’appareil.</span><span class="sxs-lookup"><span data-stu-id="671c4-114">When a driver removes an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object from the driver item tree, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is decremented and the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is marked so that it can't access the device again.</span></span> <span data-ttu-id="671c4-115">Cela se produit généralement lorsqu’un appareil est déconnecté ou qu’un élément est supprimé.</span><span class="sxs-lookup"><span data-stu-id="671c4-115">This typically takes place when a device is disconnected or an item is deleted.</span></span> <span data-ttu-id="671c4-116">Les applications sont toujours en mesure de lire des propriétés à partir d’un objet [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) , même lorsque l’objet [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) correspondant a été supprimé de l’arborescence des éléments du pilote.</span><span class="sxs-lookup"><span data-stu-id="671c4-116">Applications are still able to read properties from an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object even when the corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object has been removed from the driver item tree.</span></span>
-   <span data-ttu-id="671c4-117">Lorsqu’un objet [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) est créé, il est lié à un objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) correspondant.</span><span class="sxs-lookup"><span data-stu-id="671c4-117">When an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object is created it is linked to a corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object.</span></span> <span data-ttu-id="671c4-118">Le décompte de références de l’objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) est incrémenté.</span><span class="sxs-lookup"><span data-stu-id="671c4-118">The reference count of the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is incremented.</span></span>
-   <span data-ttu-id="671c4-119">Lorsqu’un objet [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) est libéré, le lien vers l’objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) correspondant est interrompu et le décompte de références de l’objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) est décrémenté.</span><span class="sxs-lookup"><span data-stu-id="671c4-119">When an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object is released, the link to its corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is severed and the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is decremented.</span></span>
-   <span data-ttu-id="671c4-120">Si le décompte de références d’un objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) atteint zéro, l’objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) est supprimé.</span><span class="sxs-lookup"><span data-stu-id="671c4-120">If an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count goes to zero, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is deleted.</span></span> <span data-ttu-id="671c4-121">Cela s’applique à tous les objets d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) , y compris l’élément racine.</span><span class="sxs-lookup"><span data-stu-id="671c4-121">This applies to all [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) objects including the root item.</span></span> <span data-ttu-id="671c4-122">Le décompte de références d’un objet d' [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) passe à zéro uniquement lorsqu’aucun élément d’application ne le référence et qu’il n’est plus lié à l’arborescence d’éléments du pilote.</span><span class="sxs-lookup"><span data-stu-id="671c4-122">An [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count only goes to zero when no application items reference it and it is no longer linked to the driver item tree.</span></span>

<span data-ttu-id="671c4-123">À l’aide de ce schéma de décompte de références, de nombreux objets [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) peuvent être liés à une [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) sans interférence.</span><span class="sxs-lookup"><span data-stu-id="671c4-123">Using this reference counting scheme, many [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) objects may link to one [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) without interference.</span></span> <span data-ttu-id="671c4-124">Étant donné que chaque **IWiaItem** ou **IWiaItem2** contient son propre stockage de propriétés, une application peut continuer à lire les propriétés de l’élément, même après la suppression d’un élément, mais aucune opération nécessitant l’accès à l’appareil ne sera effectuée.</span><span class="sxs-lookup"><span data-stu-id="671c4-124">Because each **IWiaItem** or **IWiaItem2** contains its own property storage, an application can continue to read item properties even after an item has been deleted, but no operation that requires access to the device will succeed.</span></span> <span data-ttu-id="671c4-125">Étant donné que les propriétés de l’élément sont stockées dans l’objet **IWiaItem** ou **IWiaItem2** , le pilote doit définir les propriétés de l’objet **IWiaItem** ou **IWiaItem2** sur l’appareil avant un transfert de données.</span><span class="sxs-lookup"><span data-stu-id="671c4-125">Because item properties are stored in the **IWiaItem** or **IWiaItem2** object, the driver must set the **IWiaItem** or **IWiaItem2** object's properties to the device before a data transfer.</span></span>

 

 



