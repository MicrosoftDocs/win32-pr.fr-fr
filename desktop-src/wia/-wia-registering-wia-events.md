---
description: 'Les applications peuvent s’inscrire pour être avertis des événements d’appareil matériel WIA (Windows Image Acquisition) en appelant l’une des méthodes d’interface IWiaDevMgr ou IWiaDevMgr2 suivantes : IWiaDevMgr :: RegisterEventCallbackCLSID ou IWiaDevMgr2 :: RegisterEventCallbackCLSIDIWiaDevMgr :: RegisterEventCallbackInterface ou IWiaDevMgr2 :: RegisterEventCallbackInterfaceIWiaDevMgr :: RegisterEventCallbackProgram ou IWiaDevMgr2 :: RegisterEventCallbackProgram'
ms.assetid: 0c142083-835f-4bbd-ab32-eb6130f99c59
title: Inscription des événements WIA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa9fc36540a64211428579bc13b84902490ea103
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951212"
---
# <a name="registering-wia-events"></a><span data-ttu-id="fde3f-103">Inscription des événements WIA</span><span class="sxs-lookup"><span data-stu-id="fde3f-103">Registering WIA Events</span></span>

<span data-ttu-id="fde3f-104">Les applications peuvent s’inscrire pour être avertis des événements de périphérique matériel WIA (Windows Image Acquisition) en appelant l’une des méthodes d’interface [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) ou [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) suivantes :</span><span class="sxs-lookup"><span data-stu-id="fde3f-104">Applications can register to be notified of Windows Image Acquisition (WIA) hardware device events by calling one of the following [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface methods:</span></span>

-   <span data-ttu-id="fde3f-105">[**IWiaDevMgr :: RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) ou [ **IWiaDevMgr2 :: RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span><span class="sxs-lookup"><span data-stu-id="fde3f-105">[**IWiaDevMgr::RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) or [**IWiaDevMgr2::RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span></span>
-   <span data-ttu-id="fde3f-106">[**IWiaDevMgr :: RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) ou [ **IWiaDevMgr2 :: RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span><span class="sxs-lookup"><span data-stu-id="fde3f-106">[**IWiaDevMgr::RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) or [**IWiaDevMgr2::RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span></span>
-   <span data-ttu-id="fde3f-107">[**IWiaDevMgr :: RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) ou [ **IWiaDevMgr2 :: RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span><span class="sxs-lookup"><span data-stu-id="fde3f-107">[**IWiaDevMgr::RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) or [**IWiaDevMgr2::RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span></span>

<span data-ttu-id="fde3f-108">Toutes ces méthodes acceptent les paramètres qui spécifient l’événement et le périphérique matériel pour lequel l’application doit être notifiée.</span><span class="sxs-lookup"><span data-stu-id="fde3f-108">All of these methods take parameters that specify the event and the hardware device for which the application is to be notified.</span></span> <span data-ttu-id="fde3f-109">Les applications s’inscrivent pour recevoir un événement pour tous les appareils WIA en passant une valeur **null** pour le paramètre qui spécifie le périphérique matériel.</span><span class="sxs-lookup"><span data-stu-id="fde3f-109">Applications register to receive an event for all WIA devices by passing a **NULL** value for the parameter that specifies the hardware device.</span></span>

<span data-ttu-id="fde3f-110">La méthode **RegisterEventCallbackInterface** inscrit une application pour recevoir un événement de périphérique matériel WIA si l’application est en cours d’exécution au moment où l’événement se produit.</span><span class="sxs-lookup"><span data-stu-id="fde3f-110">The **RegisterEventCallbackInterface** method registers an application to receive a WIA hardware device event if the application is running at the time the event occurs.</span></span> <span data-ttu-id="fde3f-111">Lorsque l’événement pour lequel l’application est inscrite se produit, WIA appelle la méthode [**IWiaEventCallback :: ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) de l’objet fourni par l’application pour transmettre les informations sur l’événement.</span><span class="sxs-lookup"><span data-stu-id="fde3f-111">When the event for which the application is registered occurs, WIA calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of the application-provided object to transmit the event information.</span></span>

<span data-ttu-id="fde3f-112">La méthode **RegisterEventCallbackCLSID** inscrit une application qui est un composant COM (Component Object Model) inscrit pour recevoir un événement de périphérique matériel WIA, même si l’application n’est pas en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="fde3f-112">The **RegisterEventCallbackCLSID** method registers an application that is a registered Component Object Model (COM) component to receive a WIA hardware device event even if the application is not running.</span></span> <span data-ttu-id="fde3f-113">En plus des paramètres mentionnés précédemment, cette méthode prend un paramètre, *pClsID*, qui spécifie l’ID de classe de l’application.</span><span class="sxs-lookup"><span data-stu-id="fde3f-113">In addition to the parameters mentioned previously, this method takes a parameter, *pClsID*, that specifies the class ID of the application.</span></span> <span data-ttu-id="fde3f-114">Lorsque l’événement spécifié se produit, le système WIA utilise la fonction [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) et l’ID de classe spécifié par *pClsID* pour créer une nouvelle instance de l’application, puis appelle la méthode [**IWiaEventCallback :: ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) de cette application pour transmettre les informations sur l’événement.</span><span class="sxs-lookup"><span data-stu-id="fde3f-114">When the specified event occurs, the WIA system uses the [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and the class ID specified by *pClsID* to create a new instance of the application, and calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of that application to transmit the event information.</span></span>

<span data-ttu-id="fde3f-115">La méthode **RegisterEventCallbackProgram** inscrit une application pour recevoir un événement de périphérique matériel WIA, même si l’application n’est pas en cours d’exécution lorsque l’événement se produit.</span><span class="sxs-lookup"><span data-stu-id="fde3f-115">The **RegisterEventCallbackProgram** method registers an application to receive a WIA hardware device event even if the application is not running when the event occurs.</span></span> <span data-ttu-id="fde3f-116">L’application n’a pas besoin d’être un composant COM inscrit.</span><span class="sxs-lookup"><span data-stu-id="fde3f-116">The application need not be a registered COM component.</span></span> <span data-ttu-id="fde3f-117">WIA lance l’application avec une instruction de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="fde3f-117">WIA launches the application with a command line statement.</span></span> <span data-ttu-id="fde3f-118">**RegisterEventCallbackProgram** prend un paramètre, *bstrCommandline*, qui spécifie le chemin d’accès complet et le nom de fichier de l’application exécutable.</span><span class="sxs-lookup"><span data-stu-id="fde3f-118">**RegisterEventCallbackProgram** takes a parameter, *bstrCommandline*, that specifies the full path and filename of the executable application.</span></span> <span data-ttu-id="fde3f-119">**RegisterEventCallbackProgram** existe pour la compatibilité descendante avec les applications qui n’ont pas été écrites pour WIA et qui doivent être évitées.</span><span class="sxs-lookup"><span data-stu-id="fde3f-119">**RegisterEventCallbackProgram** exists for backward compatibility with applications that were not written for WIA, and should be avoided.</span></span> <span data-ttu-id="fde3f-120">Utilisez **RegisterEventCallbackInterface** ou **RegisterEventCallbackCLSID** à la place.</span><span class="sxs-lookup"><span data-stu-id="fde3f-120">Use **RegisterEventCallbackInterface** or **RegisterEventCallbackCLSID** instead.</span></span>

<span data-ttu-id="fde3f-121">Pour déterminer quels gestionnaires sont inscrits pour les événements sur un appareil WIA spécifique, une application appelle une méthode [**IWiaItem :: EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) ou [**IWiaItem2 :: EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) d’un élément racine.</span><span class="sxs-lookup"><span data-stu-id="fde3f-121">To determine which handlers are registered for events on a specific WIA device, an application calls a [**IWiaItem::EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) or [**IWiaItem2::EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) method of a root item.</span></span> <span data-ttu-id="fde3f-122">Cette méthode crée un objet d’énumération pour les informations d’inscription.</span><span class="sxs-lookup"><span data-stu-id="fde3f-122">This method creates an enumeration object for the registration information.</span></span> <span data-ttu-id="fde3f-123">L’application peut ensuite utiliser l’interface [**IEnumWIA \_ dev \_ Caps**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) de cet objet pour énumérer les informations sur les gestionnaires inscrits pour recevoir des événements pour cet appareil.</span><span class="sxs-lookup"><span data-stu-id="fde3f-123">The application can then use the [**IEnumWIA\_DEV\_CAPS**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) interface of that object to enumerate information about the handlers registered to receive events for that device.</span></span>

<span data-ttu-id="fde3f-124">Si un événement se produit pour lequel une application en cours d’exécution est inscrite via **RegisterEventCallbackInterface** et **RegisterEventCallbackCLSID** ou **RegisterEventCallbackProgram**, WIA notifie l’application en cours d’exécution et n’essaie pas de lancer une nouvelle instance de l’application, car l’inscription des événements via **RegisterEventCallbackInterface** est prioritaire sur **RegisterEventCallbackCLSID** et **RegisterEventCallbackProgram**.</span><span class="sxs-lookup"><span data-stu-id="fde3f-124">If an event occurs for which a running application is registered through **RegisterEventCallbackInterface** and either **RegisterEventCallbackCLSID** or **RegisterEventCallbackProgram**, WIA notifies the running application and does not attempt to launch a new instance of the application because event registration through **RegisterEventCallbackInterface** takes precedence over both **RegisterEventCallbackCLSID** and **RegisterEventCallbackProgram**.</span></span>

> [!Note]  
> <span data-ttu-id="fde3f-125">Dans une application multithread, il n’y a aucune garantie que le thread sur lequel le rappel de notification d’événements retourne est le même thread que celui qui a enregistré le rappel.</span><span class="sxs-lookup"><span data-stu-id="fde3f-125">In a multi-threaded application, there is no guarantee that the thread that the event notification callback will return on is the same thread that registered the callback.</span></span>

 

 

 
