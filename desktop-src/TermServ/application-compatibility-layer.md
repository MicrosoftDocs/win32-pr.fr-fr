---
title: Couche de compatibilité des applications
description: Pour exécuter des applications héritées dans un environnement Services Bureau à distance, vous pouvez utiliser la couche de compatibilité des applications Services Bureau à distance.
ms.assetid: 6e61ed45-4fcb-4aee-b8cc-638a9b87ce00
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3e7bbc5867e42951783d3666aa770cdcc45406f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106511704"
---
# <a name="application-compatibility-layer"></a><span data-ttu-id="c5586-103">Couche de compatibilité des applications</span><span class="sxs-lookup"><span data-stu-id="c5586-103">Application compatibility layer</span></span>

<span data-ttu-id="c5586-104">Pour exécuter des applications héritées dans un environnement Services Bureau à distance, vous pouvez utiliser la couche de compatibilité des applications Services Bureau à distance.</span><span class="sxs-lookup"><span data-stu-id="c5586-104">To run legacy applications in a Remote Desktop Services environment you can use the Remote Desktop Services Application Compatibility layer.</span></span> <span data-ttu-id="c5586-105">Lorsque le serveur hôte de session Bureau à distance (hôte de session Bureau à distance) charge une application qui n’est pas Services Bureau à distancee en charge, il charge également une DLL qui contient le code de compatibilité.</span><span class="sxs-lookup"><span data-stu-id="c5586-105">When the Remote Desktop Session Host (RD Session Host) server loads an application that is not Remote Desktop Services aware, it also loads a DLL that contains compatibility code.</span></span> <span data-ttu-id="c5586-106">Pour utiliser la couche de compatibilité des applications Services Bureau à distance, vous pouvez définir l’indicateur NOT TSAWARE lors de la compilation d’une application.</span><span class="sxs-lookup"><span data-stu-id="c5586-106">To use the Remote Desktop Services Application Compatibility layer, you can set the NOT TSAWARE flag when compiling an application.</span></span>

<span data-ttu-id="c5586-107">Si votre application ne prend Services Bureau à distance en charge, vous pouvez éviter la surcharge liée au chargement de cette DLL supplémentaire et à l’exécution du code de compatibilité.</span><span class="sxs-lookup"><span data-stu-id="c5586-107">If your application is Remote Desktop Services aware, you can avoid the overhead of loading this extra DLL and running the compatibility code.</span></span>

<span data-ttu-id="c5586-108">Pour indiquer que votre application n’est Services Bureau à distance prise en charge, définissez l’indicateur de prise en **\_ \_ charge de terminal \_ Server \_ de l’image DLLCHARACTERISTICS** dans l’en-tête facultatif.</span><span class="sxs-lookup"><span data-stu-id="c5586-108">To indicate that your application is Remote Desktop Services aware, set the **IMAGE\_DLLCHARACTERISTICS\_TERMINAL\_SERVER\_AWARE** flag in the optional header.</span></span> <span data-ttu-id="c5586-109">Si vous utilisez l’éditeur de liens fourni avec Microsoft Visual C++, vous pouvez utiliser l’option de l’éditeur de liens **TSAWARE** pour définir cet indicateur.</span><span class="sxs-lookup"><span data-stu-id="c5586-109">If you are using the linker that ships with Microsoft Visual C++, you can use the **TSAWARE** linker option to set this flag.</span></span> <span data-ttu-id="c5586-110">L’outil **DUMPBIN** fourni avec Microsoft Visual C++ fournit l’option */headers* pour déterminer l’état de l’indicateur **TSAWARE** .</span><span class="sxs-lookup"><span data-stu-id="c5586-110">The **DUMPBIN** tool that ships with Microsoft Visual C++ provides the */HEADERS* option to determine the state of the **TSAWARE** flag.</span></span> <span data-ttu-id="c5586-111">Pour plus d’informations sur l’utilisation de l’outil **DUMPBIN** , consultez [Référence DUMPBIN](/cpp/build/reference/dumpbin-reference?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="c5586-111">For more information about using the **DUMPBIN** tool, see [DUMPBIN Reference](/cpp/build/reference/dumpbin-reference?view=vs-2019).</span></span>

<span data-ttu-id="c5586-112">Soyez prudent lorsque vous utilisez l’indicateur **TSAWARE** , car il permet à votre application de contourner toutes les optimisations de compatibilité services Bureau à distance.</span><span class="sxs-lookup"><span data-stu-id="c5586-112">Be careful when you use the **TSAWARE** flag because it enables your application to bypass any Remote Desktop Services compatibility optimizations.</span></span> <span data-ttu-id="c5586-113">L’indicateur **TSAWARE** doit être utilisé uniquement si vous êtes certain que votre application est conçue pour l’environnement services Bureau à distance.</span><span class="sxs-lookup"><span data-stu-id="c5586-113">The **TSAWARE** flag should only be used if you are certain that your application is designed for the Remote Desktop Services environment.</span></span> <span data-ttu-id="c5586-114">Si votre application répond aux critères suivants, vous pouvez utiliser en toute sécurité l’indicateur de **reconnaissance d’image \_ DLLCHARACTERISTICS \_ Terminal \_ Server \_** .</span><span class="sxs-lookup"><span data-stu-id="c5586-114">If your application meets the following criteria, you can safely use the **IMAGE\_DLLCHARACTERISTICS\_TERMINAL\_SERVER\_AWARE** flag.</span></span>

-   <span data-ttu-id="c5586-115">L’application n’utilise pas de fichiers. ini.</span><span class="sxs-lookup"><span data-stu-id="c5586-115">The application does not use .ini files.</span></span>
-   <span data-ttu-id="c5586-116">L’application n’écrit pas dans **HKEY \_ Current \_ User** lors de l’installation.</span><span class="sxs-lookup"><span data-stu-id="c5586-116">The application does not write to **HKEY\_CURRENT\_USER** during setup.</span></span> <span data-ttu-id="c5586-117">Pour plus d’informations, consultez [stockage des informations de User-Specific](storing-user-specific-information.md).</span><span class="sxs-lookup"><span data-stu-id="c5586-117">For more information, see [Storing User-Specific Information](storing-user-specific-information.md).</span></span>
-   <span data-ttu-id="c5586-118">L’application ne s’exécute pas en tant que service système (c’est-à-dire LUID = System).</span><span class="sxs-lookup"><span data-stu-id="c5586-118">The application does not run as a system service (that is, LUID=System).</span></span>
-   <span data-ttu-id="c5586-119">L’application n’attend pas l’accès exclusif aux répertoires Windows ou aux autres répertoires système.</span><span class="sxs-lookup"><span data-stu-id="c5586-119">The application does not expect exclusive access to the Windows or other system directories.</span></span> <span data-ttu-id="c5586-120">Cela signifie que l’application ne stocke pas les données temporaires ou de configuration par utilisateur dans les répertoires système Windows ou autres.</span><span class="sxs-lookup"><span data-stu-id="c5586-120">This means that the application does not store per user temporary or configuration data in the Windows or other system directories.</span></span>
-   <span data-ttu-id="c5586-121">L’application n’écrit pas dans la ruche de Registre **HKEY local machine** pour la configuration ou les données spécifiques à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c5586-121">The application does not write to the **HKEY Local Machine** registry hive for user specific data or configuration.</span></span>
-   <span data-ttu-id="c5586-122">L’application suit les autres instructions de compatibilité Services Bureau à distance mentionnées dans ce document.</span><span class="sxs-lookup"><span data-stu-id="c5586-122">The application follows other Remote Desktop Services compatibility guidelines mentioned in this document.</span></span>

 

 