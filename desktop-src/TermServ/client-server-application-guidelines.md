---
title: Instructions pour les applications client/serveur
description: Les applications client/serveur ne doivent pas supposer qu’une seule connexion d’ordinateur équivaut à une seule session utilisateur.
ms.assetid: 69822ef1-eca8-4302-b014-8e5894d52109
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cd0c1a71256f3ab469bfeb1c08b2d096b56ac1b5
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106512734"
---
# <a name="clientserver-application-guidelines"></a><span data-ttu-id="02755-103">Instructions pour les applications client/serveur</span><span class="sxs-lookup"><span data-stu-id="02755-103">Client/Server application guidelines</span></span>

<span data-ttu-id="02755-104">Les applications client/serveur ne doivent pas supposer qu’une seule connexion d’ordinateur équivaut à une seule session utilisateur.</span><span class="sxs-lookup"><span data-stu-id="02755-104">Client/server applications must not assume that a single computer connection is equivalent to a single user session.</span></span> <span data-ttu-id="02755-105">Il s’agit d’un cas particulier du problème abordé dans [adresses IP et noms d’ordinateurs](ip-addresses-and-computer-names.md).</span><span class="sxs-lookup"><span data-stu-id="02755-105">This is a special case of the issue discussed in [IP Addresses and Computer Names](ip-addresses-and-computer-names.md).</span></span>

<span data-ttu-id="02755-106">Pour identifier de façon unique une connexion client/serveur, chaque module client doit utiliser un nom ou un identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="02755-106">To uniquely identify a client/server connection, each client module must use a unique name or identifier.</span></span> <span data-ttu-id="02755-107">Les applications peuvent utiliser des objets nommés, des canaux, des sockets ou d’autres méthodes IPC.</span><span class="sxs-lookup"><span data-stu-id="02755-107">Applications can use named objects or pipes, sockets, or other IPC methods.</span></span> <span data-ttu-id="02755-108">Pour plus d’informations, consultez [espaces de noms d’objets noyau](kernel-object-namespaces.md).</span><span class="sxs-lookup"><span data-stu-id="02755-108">For more information, see [Kernel Object Namespaces](kernel-object-namespaces.md).</span></span>

<span data-ttu-id="02755-109">Pour être Services Bureau à distance compatible, le module serveur dans une application client/serveur doit être en mesure de gérer plusieurs clients se connectant à partir du même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="02755-109">To be Remote Desktop Services compatible, the server module in a client/server application must be able to handle multiple clients connecting from the same computer.</span></span> <span data-ttu-id="02755-110">Pour ce faire, le module serveur doit accepter les connexions client via une interface globale bien définie, telle que RPC ou canaux nommés.</span><span class="sxs-lookup"><span data-stu-id="02755-110">To accomplish this, the server module must accept client connections through a well-defined global interface, such as RPC or named pipes.</span></span> <span data-ttu-id="02755-111">Le serveur et le client doivent négocier un canal de communication différent pour chaque session utilisateur.</span><span class="sxs-lookup"><span data-stu-id="02755-111">The server and client must negotiate a different communication channel for each user session.</span></span> <span data-ttu-id="02755-112">Le client doit établir une connexion au serveur à l’aide de protocoles qui prennent facilement en charge ce type d’opération, tel que TCP/IP, où une connexion de socket différente peut être utilisée pour chaque application cliente.</span><span class="sxs-lookup"><span data-stu-id="02755-112">The client must establish a connection to the server by using protocols that easily support this type of operation, such as TCP/IP, where a different socket connection can be used for each client application.</span></span>

<span data-ttu-id="02755-113">Le module client peut appeler la fonction [**ProcessIdToSessionId**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-processidtosessionid) pour récupérer l’identificateur de sa session services Bureau à distance.</span><span class="sxs-lookup"><span data-stu-id="02755-113">The client module can call the [**ProcessIdToSessionId**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-processidtosessionid) function to retrieve the identifier of its Remote Desktop Services session.</span></span> <span data-ttu-id="02755-114">Le client utilise ensuite une forme de communication interprocessus pour passer son identificateur de session au module serveur.</span><span class="sxs-lookup"><span data-stu-id="02755-114">The client then uses some form of interprocess communication to pass its session identifier to the server module.</span></span> <span data-ttu-id="02755-115">Les modules client et serveur peuvent ensuite utiliser l’identificateur de session pour configurer un canal de communication privé.</span><span class="sxs-lookup"><span data-stu-id="02755-115">The client and server modules can then use the session identifier to set up a private communication channel.</span></span> <span data-ttu-id="02755-116">Par exemple, le module de serveur peut utiliser un identificateur de session pour accéder aux objets dans l’espace de noms de la session pour les objets de noyau.</span><span class="sxs-lookup"><span data-stu-id="02755-116">For example, the server module can use a session identifier to access objects in the session's namespace for kernel objects.</span></span>

<span data-ttu-id="02755-117">En outre, le module de serveur peut utiliser l’identificateur de session dans un appel [**WTSQuerySessionInformation**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsquerysessioninformationa) pour récupérer des informations supplémentaires sur le client.</span><span class="sxs-lookup"><span data-stu-id="02755-117">Furthermore, the server module can use the session identifier in a [**WTSQuerySessionInformation**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsquerysessioninformationa) call to retrieve additional information about the client.</span></span> <span data-ttu-id="02755-118">Le module de serveur peut également utiliser l’identificateur de session dans un appel [**WTSSendMessage**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea) pour afficher un message sur le terminal client.</span><span class="sxs-lookup"><span data-stu-id="02755-118">The server module can also use the session identifier in a [**WTSSendMessage**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea) call to display a message on the client terminal.</span></span> <span data-ttu-id="02755-119">Le module de serveur peut également créer deux événements pour surveiller la connexion au client et la déconnexion d’une session.</span><span class="sxs-lookup"><span data-stu-id="02755-119">The server module can also create two events to monitor client connection to and disconnection from a session.</span></span> <span data-ttu-id="02755-120">Toutefois, il doit être inscrit sur le serveur de l’hôte de session Bureau à distance (hôte de session Bureau à distance) pour effectuer cette opération.</span><span class="sxs-lookup"><span data-stu-id="02755-120">However, it must be registered on the Remote Desktop Session Host (RD Session Host) server to do this.</span></span> <span data-ttu-id="02755-121">Pour plus d’informations, consultez [surveillance des connexions de session et des déconnexions](monitoring-session-connections-and-disconnections.md).</span><span class="sxs-lookup"><span data-stu-id="02755-121">For more information, see [Monitoring Session Connections and Disconnections](monitoring-session-connections-and-disconnections.md).</span></span>

<span data-ttu-id="02755-122">Les invites de saisie utilisateur constituent une source potentielle de problèmes pour les applications client/serveur.</span><span class="sxs-lookup"><span data-stu-id="02755-122">Prompts for user input are a potential source of problems for client/server applications.</span></span> <span data-ttu-id="02755-123">Par exemple, si un service appelle la fonction [**MessageBox**](/windows/desktop/api/winuser/nf-winuser-messagebox) , la boîte de message s’affiche sur le Bureau du serveur hôte de session Bureau à distance, et non sur le Bureau du client.</span><span class="sxs-lookup"><span data-stu-id="02755-123">For example, if a service calls the [**MessageBox**](/windows/desktop/api/winuser/nf-winuser-messagebox) function, the message box is displayed on the desktop of the RD Session Host server, not on the client desktop.</span></span> <span data-ttu-id="02755-124">Pour afficher un message sur un bureau client, le service peut appeler la fonction [**WtsSendMessage**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea) .</span><span class="sxs-lookup"><span data-stu-id="02755-124">To display a message on a client desktop, the service can call the [**WtsSendMessage**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea) function.</span></span> <span data-ttu-id="02755-125">Le service peut également demander une entrée à partir du module client et le module client peut afficher l’interface utilisateur et renvoyer l’entrée résultante au service.</span><span class="sxs-lookup"><span data-stu-id="02755-125">Alternatively, the service can request input from the client module, and the client module can display the user interface and send the resulting input back to the service.</span></span>

<span data-ttu-id="02755-126">Les processus générés à partir de plusieurs sessions peuvent envoyer et recevoir des données à l’aide de blocs de mémoire partagée.</span><span class="sxs-lookup"><span data-stu-id="02755-126">Processes spawned from multiple sessions can send data to and receive data from each other through the use of shared memory blocks.</span></span> <span data-ttu-id="02755-127">Pour plus d’informations, consultez Création d’une [mémoire partagée nommée](/windows/desktop/Memory/creating-named-shared-memory).</span><span class="sxs-lookup"><span data-stu-id="02755-127">For more information, see [Creating Named Shared Memory](/windows/desktop/Memory/creating-named-shared-memory).</span></span> <span data-ttu-id="02755-128">La mémoire partagée ne peut pas être utilisée dans les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="02755-128">Shared memory cannot be used under the following conditions:</span></span>

-   <span data-ttu-id="02755-129">Les processus qui utilisent le bloc de mémoire partagée ont été générés par plusieurs sessions.</span><span class="sxs-lookup"><span data-stu-id="02755-129">The processes using the shared memory block were spawned by multiple sessions.</span></span>
-   <span data-ttu-id="02755-130">Les sessions partagent les mêmes informations d’identification d’authentification utilisateur.</span><span class="sxs-lookup"><span data-stu-id="02755-130">The sessions share the same user authentication credential.</span></span>

 

 