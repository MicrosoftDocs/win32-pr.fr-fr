---
title: Portage de Direct3D 11 vers Direct3D 12
description: Cette section fournit des conseils sur le portage d’un moteur graphique Direct3D 11 personnalisé vers Direct3D 12.
ms.assetid: 9EB4AC6B-AFDD-4673-8EB3-54272C151784
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14b5bc6784d6f96c3c1599a601a57bf68b0d612d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104548582"
---
# <a name="porting-from-direct3d-11-to-direct3d-12"></a><span data-ttu-id="8e8bf-103">Portage de Direct3D 11 vers Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="8e8bf-103">Porting from Direct3D 11 to Direct3D 12</span></span>

<span data-ttu-id="8e8bf-104">Cette section fournit des conseils sur le portage d’un moteur graphique Direct3D 11 personnalisé vers Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-104">This section provides some guidance on porting from a custom Direct3D 11 graphics engine to Direct3D 12.</span></span>

-   [<span data-ttu-id="8e8bf-105">Création de l’appareil</span><span class="sxs-lookup"><span data-stu-id="8e8bf-105">Device creation</span></span>](#device-creation)
-   [<span data-ttu-id="8e8bf-106">Ressources validées</span><span class="sxs-lookup"><span data-stu-id="8e8bf-106">Committed resources</span></span>](#committed-resources)
-   [<span data-ttu-id="8e8bf-107">Ressources réservées</span><span class="sxs-lookup"><span data-stu-id="8e8bf-107">Reserved resources</span></span>](#reserved-resources)
-   [<span data-ttu-id="8e8bf-108">Téléchargement de données</span><span class="sxs-lookup"><span data-stu-id="8e8bf-108">Uploading data</span></span>](#uploading-data)
-   [<span data-ttu-id="8e8bf-109">Nuanceurs et objets nuanceur</span><span class="sxs-lookup"><span data-stu-id="8e8bf-109">Shaders and shader objects</span></span>](#shaders-and-shader-objects)
-   [<span data-ttu-id="8e8bf-110">Envoi du travail au GPU</span><span class="sxs-lookup"><span data-stu-id="8e8bf-110">Submitting work to the GPU</span></span>](#submitting-work-to-the-gpu)
-   [<span data-ttu-id="8e8bf-111">Synchronisation UC/GPU</span><span class="sxs-lookup"><span data-stu-id="8e8bf-111">CPU/GPU Synchronization</span></span>](#cpugpu-synchronization)
-   [<span data-ttu-id="8e8bf-112">Liaison de ressource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-112">Resource Binding</span></span>](#resource-binding)
-   [<span data-ttu-id="8e8bf-113">État de la ressource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-113">Resource state</span></span>](#resource-state)
-   [<span data-ttu-id="8e8bf-114">Chaînes d’échange</span><span class="sxs-lookup"><span data-stu-id="8e8bf-114">Swapchains</span></span>](#swapchains)
-   [<span data-ttu-id="8e8bf-115">Correction du rendu des fonctions</span><span class="sxs-lookup"><span data-stu-id="8e8bf-115">Fixed function rendering</span></span>](#fixed-function-rendering)
-   [<span data-ttu-id="8e8bf-116">Les chances et les extrémités</span><span class="sxs-lookup"><span data-stu-id="8e8bf-116">Odds and ends</span></span>](#odds-and-ends)
-   [<span data-ttu-id="8e8bf-117">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8e8bf-117">Related topics</span></span>](#related-topics)

## <a name="device-creation"></a><span data-ttu-id="8e8bf-118">Création de l’appareil</span><span class="sxs-lookup"><span data-stu-id="8e8bf-118">Device creation</span></span>

<span data-ttu-id="8e8bf-119">Direct3D 11 et Direct3D 12 partagent un modèle de création d’appareil semblable.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-119">Both Direct3D 11 and Direct3D 12 share a simliar device creation pattern.</span></span> <span data-ttu-id="8e8bf-120">Les pilotes Direct3D 12 existants sont tous **D3D_FEATURE_LEVEL_11_0** ou plus, vous pouvez donc ignorer les anciens niveaux de fonctionnalités et les lmitations associés.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-120">Existing Direct3D 12 drivers are all **D3D_FEATURE_LEVEL_11_0** or better, so you can ignore the older feature levels and associated lmitations.</span></span>

<span data-ttu-id="8e8bf-121">Gardez également à l’esprit qu’avec Direct3D 12, vous devez énumérer explicitement les informations de l’appareil à l’aide des interfaces DXGI.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-121">Also keep in mind that with Direct3D 12, you should explicitly enumerate device information using DXGI interfaces.</span></span> <span data-ttu-id="8e8bf-122">Dans Direct3D 11, vous pouviez *chaîner* à l’appareil dxgi à partir de l’appareil Direct3D, ce qui n’est pas pris en charge pour Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-122">In Direct3D 11, you could *chain back* to the DXGI device from the Direct3D device, and this is not supported for Direct3D 12.</span></span>

<span data-ttu-id="8e8bf-123">La création d’un périphérique logiciel WARP sur Direct3D 12 s’effectue en fournissant un adaptateur explicite obtenu à partir de **IDXGIFcatory4 :: EnumWarpAdapter**.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-123">Creating a WARP software device on Direct3D 12 is done by providing an explicit adapter obtained from **IDXGIFcatory4::EnumWarpAdapter**.</span></span> <span data-ttu-id="8e8bf-124">Le périphérique WARP pour Direct3D 12 est disponible uniquement sur les systèmes sur lesquels la fonctionnalité facultative des **Outils Graphics** est activée.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-124">The WARP device for Direct3D 12 is available only on systems with the **Graphics Tools** optional feature enabled.</span></span>

> [!NOTE]
> <span data-ttu-id="8e8bf-125">Il n’y a pas d’équivalent à **D3D11CreateDeviceAndSwapChain**.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-125">There is no equivalent to **D3D11CreateDeviceAndSwapChain**.</span></span> <span data-ttu-id="8e8bf-126">Même avec Direct3D 11, nous déconseillons l’utilisation de cette fonction, car il est souvent préférable de créer l’appareil et utilise permutation dans des étapes distinctes.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-126">Even with Direct3D 11, we discourage the use of this function as it's often better to create the device and swapchain in distinct steps.</span></span>

## <a name="committed-resources"></a><span data-ttu-id="8e8bf-127">Ressources validées</span><span class="sxs-lookup"><span data-stu-id="8e8bf-127">Committed resources</span></span>

<span data-ttu-id="8e8bf-128">Les objets créés avec les interfaces suivantes dans Direct3D 11, traduisent en ce qui est appelé « ressources validées » dans Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-128">Objects created with the following interfaces in Direct3D 11, translate to what are called "committed resources" in Direct3D 12.</span></span> <span data-ttu-id="8e8bf-129">Une ressource validée est une ressource qui a à la fois un espace d’adressage virtuel et des pages physiques associés.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-129">A committed resource is a resource which has both virtual address space and physical pages associated with it.</span></span> <span data-ttu-id="8e8bf-130">Il s’agit d’un concept du modèle de mémoire Microsoft Windows Device Driver 2 (WDD2) sur lequel Direct3D 12 est basé.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-130">This is a concept of the Microsoft Windows Device Driver 2 (WDD2) Memory Model, on which Direct3D 12 is based.</span></span>

<span data-ttu-id="8e8bf-131">Ressources Direct3D 11 :</span><span class="sxs-lookup"><span data-stu-id="8e8bf-131">Direct3D 11 resources:</span></span>

-   [<span data-ttu-id="8e8bf-132">**ID3D11Resource**</span><span class="sxs-lookup"><span data-stu-id="8e8bf-132">**ID3D11Resource**</span></span>](/windows/win32/api/d3d11/nn-d3d11-id3d11resource)
-   <span data-ttu-id="8e8bf-133">[**ID3D11Buffer**](/windows/win32/api/d3d11/nn-d3d11-id3d11buffer) et [ **ID3D11Device :: CreateBuffer**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createbuffer)</span><span class="sxs-lookup"><span data-stu-id="8e8bf-133">[**ID3D11Buffer**](/windows/win32/api/d3d11/nn-d3d11-id3d11buffer) and [**ID3D11Device::CreateBuffer**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createbuffer)</span></span>
-   <span data-ttu-id="8e8bf-134">[**ID3D11Texture1D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture1d) et [ **ID3D11Device : CreateTexture1D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture1d)</span><span class="sxs-lookup"><span data-stu-id="8e8bf-134">[**ID3D11Texture1D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture1d) and [**ID3D11Device:CreateTexture1D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture1d)</span></span>
-   <span data-ttu-id="8e8bf-135">[**ID3D11Texture2D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture2d) et [ **ID3D11Device :: CreateTexture2D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture2d)</span><span class="sxs-lookup"><span data-stu-id="8e8bf-135">[**ID3D11Texture2D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture2d) and [**ID3D11Device::CreateTexture2D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture2d)</span></span>
-   <span data-ttu-id="8e8bf-136">[**ID3D11Texture3D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture3d) et [ **ID3D11Device :: CreateTexture3D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture3d)</span><span class="sxs-lookup"><span data-stu-id="8e8bf-136">[**ID3D11Texture3D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture3d) and [**ID3D11Device::CreateTexture3D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture3d)</span></span>

<span data-ttu-id="8e8bf-137">Dans Direct3D 12, ceux-ci sont tous représentés par [**ID3D12Resource**](/windows/win32/api/d3d12/nn-d3d12-id3d12resource) et [**ID3D12Device :: CreateCommittedResource**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createcommittedresource).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-137">In Direct3D 12 these are all represented by [**ID3D12Resource**](/windows/win32/api/d3d12/nn-d3d12-id3d12resource) and [**ID3D12Device::CreateCommittedResource**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createcommittedresource).</span></span>

## <a name="reserved-resources"></a><span data-ttu-id="8e8bf-138">Ressources réservées</span><span class="sxs-lookup"><span data-stu-id="8e8bf-138">Reserved resources</span></span>

<span data-ttu-id="8e8bf-139">Les ressources réservées sont des ressources où seul l’espace d’adressage virtuel a été alloué, la mémoire physique n’est pas allouée jusqu’à l’appel de [**ID3D12Device :: CreateHeap**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createheap).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-139">Reserved resources are resources where only virtual address space has been allocated, physical memory is not allocated until there is a call to [**ID3D12Device::CreateHeap**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createheap).</span></span> <span data-ttu-id="8e8bf-140">Il s’agit essentiellement du même concept que les ressources en mosaïque dans Direct3D 11.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-140">This is essentially the same concept as tiled resources in Direct3D 11.</span></span>

<span data-ttu-id="8e8bf-141">Les indicateurs ([**\_ \_ \_ indicateur divers de ressource d3d11**](/windows/win32/api/d3d11/ne-d3d11-d3d11_resource_misc_flag)) utilisés dans Direct3D 11 pour configurer des ressources en mosaïque, puis les mapper à la mémoire physique.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-141">The flags ([**D3D11\_RESOURCE\_MISC\_FLAG**](/windows/win32/api/d3d11/ne-d3d11-d3d11_resource_misc_flag)) used in Direct3D 11 to set up tiled resources, then map them to physical memory.</span></span>

-   <span data-ttu-id="8e8bf-142">\_Ressource d3d11 \_ en \_ mosaïque diverse</span><span class="sxs-lookup"><span data-stu-id="8e8bf-142">D3D11\_RESOURCE\_MISC\_TILED</span></span>
-   <span data-ttu-id="8e8bf-143">\_Pool de \_ \_ mosaïques \_ diverses de la ressource d3d11</span><span class="sxs-lookup"><span data-stu-id="8e8bf-143">D3D11\_RESOURCE\_MISC\_TILE\_POOL</span></span>

## <a name="uploading-data"></a><span data-ttu-id="8e8bf-144">Téléchargement de données</span><span class="sxs-lookup"><span data-stu-id="8e8bf-144">Uploading data</span></span>

<span data-ttu-id="8e8bf-145">Dans Direct3D 11, il existe une seule chronologie (les appels suivant une séquence, tels que les données initialisées avec [**des \_ \_ données**](/windows/win32/api/d3d11/ns-d3d11-d3d11_subresource_data)de sous-ressource d3d11, puis un appel est effectué à [**ID3D11DeviceContext :: UpdateSubresource**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-updatesubresource), puis un appel à [**ID3D11DeviceContext :: Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map)).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-145">In Direct3D 11 there is the appearance of a single timeline (calls following a sequence, such as data initialized with [**D3D11\_SUBRESOURCE\_DATA**](/windows/win32/api/d3d11/ns-d3d11-d3d11_subresource_data), then a call is made to [**ID3D11DeviceContext::UpdateSubresource**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-updatesubresource), and then a call to [**ID3D11DeviceContext::Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map)).</span></span> <span data-ttu-id="8e8bf-146">Le nombre de copies créées des données n’est pas évident pour un développeur Direct3D 11.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-146">The number of copies created of the data is not obvious to a Direct3D 11 developer.</span></span>

<span data-ttu-id="8e8bf-147">Dans Direct3D 12, il existe deux chronologies, la chronologie GPU (configurée par les appels à [**CopyTextureRegion**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-copytextureregion)et [**CopyBufferRegion**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-copybufferregion) à partir de la mémoire mappée) et la chronologie de l’UC (déterminée par les appels à [**Map**](/windows/win32/api/d3d12/nf-d3d12-id3d12resource-map)).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-147">In Direct3D 12 there are two timelines, the GPU timeline (set up by calls to [**CopyTextureRegion**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-copytextureregion), and [**CopyBufferRegion**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-copybufferregion) from mappable memory) and the CPU timeline (determined by calls to [**Map**](/windows/win32/api/d3d12/nf-d3d12-id3d12resource-map)).</span></span> <span data-ttu-id="8e8bf-148">Les fonctions d’assistance sont fournies (dans le fichier d3dx12. h), appelées [**updatesubresources par**](updatesubresources1.md) qui utilisent une chronologie partagée.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-148">Helper functions are provided (in the d3dx12.h file) called [**Updatesubresources**](updatesubresources1.md) that use a shared timeline.</span></span> <span data-ttu-id="8e8bf-149">Il existe plusieurs variantes de cette fonction d’assistance, une qui utilise [**ID3D12Device :: GetCopyableFootprints**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-getcopyablefootprints), une autre qui utilise un mécanisme d’allocation de tas et une autre qui utilise un mécanisme d’allocation de pile.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-149">There are several variations of this helper function, one that uses [**ID3D12Device::GetCopyableFootprints**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-getcopyablefootprints), another that uses a heap-allocating mechanism, and another that uses a stack-allocating mechanism.</span></span> <span data-ttu-id="8e8bf-150">Ces fonctions d’assistance copient les ressources dans le GPU et le processeur, via une zone intermédiaire de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-150">These helper functions copy resources to both the GPU and CPU, via an intermediate staging area of memory.</span></span>

<span data-ttu-id="8e8bf-151">En général, le GPU et le processeur disposent chacun de leur propre copie d’une ressource liée à leur propre chronologie.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-151">Typically the GPU and CPU each have their own copy of a resource tied to their own timeline.</span></span> <span data-ttu-id="8e8bf-152">L’approche de la chronologie partagée gère de la même manière deux copies.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-152">The shared timeline approach similarly maintains two copies.</span></span>

## <a name="shaders-and-shader-objects"></a><span data-ttu-id="8e8bf-153">Nuanceurs et objets nuanceur</span><span class="sxs-lookup"><span data-stu-id="8e8bf-153">Shaders and shader objects</span></span>

<span data-ttu-id="8e8bf-154">Dans Direct3D 11, il y a beaucoup de création d’objets de nuanceur et d’État, et de définir l’état de ces objets, à l’aide des méthodes de création [**ID3D11Device**](/windows/win32/api/d3d11/nn-d3d11-id3d11device) et des méthodes Set [**ID3D11DeviceContext**](/windows/win32/api/d3d11/nn-d3d11-id3d11devicecontext) .</span><span class="sxs-lookup"><span data-stu-id="8e8bf-154">In Direct3D 11 there is a lot of creation of shader and state objects, and setting the state of those objects, using the [**ID3D11Device**](/windows/win32/api/d3d11/nn-d3d11-id3d11device) creation methods and the [**ID3D11DeviceContext**](/windows/win32/api/d3d11/nn-d3d11-id3d11devicecontext) set methods.</span></span> <span data-ttu-id="8e8bf-155">En général, un grand nombre d’appels sont passés à ces méthodes, qui sont ensuite combinés au moment du traçage par le pilote pour définir l’état de pipeline approprié.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-155">Typically a large number of calls are made to these methods, which are then combined at draw time by the driver to set the correct pipeline state.</span></span>

<span data-ttu-id="8e8bf-156">Dans Direct3D 12, ce paramètre de l’état du pipeline a été combiné en un objet unique ([**CreateComputePipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createcomputepipelinestate) pour un moteur de calcul, et [**CreateGraphicsPipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-creategraphicspipelinestate) pour un moteur graphique), qui est ensuite attaché à une liste de commandes avant l’appel de dessin avec un appel à [**SetPipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setpipelinestate).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-156">In Direct3D 12 this setting of pipeline state has been combined into a single object ([**CreateComputePipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createcomputepipelinestate) for a compute engine, and [**CreateGraphicsPipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-creategraphicspipelinestate) for a graphics engine), which is then attached to a command list before the draw call with a call to [**SetPipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setpipelinestate).</span></span>

<span data-ttu-id="8e8bf-157">Ces appels remplacent tous les appels individuels pour définir les nuanceurs, la disposition d’entrée, l’état de fusion, l’état du rastériseur, l’état du stencil de profondeur, etc., dans Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="8e8bf-157">These calls replace all the individual calls to set shaders, input layout, blend state, rasterizer state, depth stencil state, and so on, in Direct3D 11</span></span>

- <span data-ttu-id="8e8bf-158">Méthodes de l’appareil 11 : ``CreateInputLayout`` , ``CreateXShader`` , ``CreateDepthStencilState`` , andd ``CreateRasterizerState`` .</span><span class="sxs-lookup"><span data-stu-id="8e8bf-158">Device 11 methods: ``CreateInputLayout``, ``CreateXShader``, ``CreateDepthStencilState``, andD ``CreateRasterizerState``.</span></span>
- <span data-ttu-id="8e8bf-159">Méthodes du contexte de périphérique 11 :  ``IASetInputLayout`` , ``xxSetShader`` ,, ``OMSetBlendState`` ``OMSetDepthStencilState`` et ``RSSetState`` .</span><span class="sxs-lookup"><span data-stu-id="8e8bf-159">Device Context 11 methods:  ``IASetInputLayout``, ``xxSetShader``, ``OMSetBlendState``, ``OMSetDepthStencilState``, and ``RSSetState``.</span></span>

<span data-ttu-id="8e8bf-160">Alors que Direct3D 12 peut prendre en charge des objets BLOB de nuanceurs compilés plus anciens, les nuanceurs doivent être générés à l’aide du nuanceur 5,1 avec les API FXC/D3DCompile, ou à l’aide du nuanceur modèle 6 à l’aide du compilateur DXC DXIL.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-160">While Direct3D 12 can support older compiled shader blobs, shaders should be built using either Shader Model 5.1 with the FXC/D3DCompile APIs, or using Shader Model 6 using the DXIL DXC compiler.</span></span> <span data-ttu-id="8e8bf-161">Vous devez valider la prise en charge de Shader Model 6 avec [**CheckFeatureSupport**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-checkfeaturesupport) et **D3D12_FEATURE_SHADER_MODEL**.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-161">You should validate Shader Model 6 support with [**CheckFeatureSupport**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-checkfeaturesupport) and **D3D12_FEATURE_SHADER_MODEL**.</span></span>

## <a name="submitting-work-to-the-gpu"></a><span data-ttu-id="8e8bf-162">Envoi du travail au GPU</span><span class="sxs-lookup"><span data-stu-id="8e8bf-162">Submitting work to the GPU</span></span>

<span data-ttu-id="8e8bf-163">dans Direct3D 11, il n’y a que peu de contrôle sur la façon dont le travail est soumis, il est en grande partie géré par le pilote, bien que certains contrôles soient activés via les appels [**ID3D11DeviceContext :: Flush**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-flush) et [**IDXGISwapChain1 ::P resent1**](/windows/win32/api/dxgi1_2/nf-dxgi1_2-idxgiswapchain1-present1) .</span><span class="sxs-lookup"><span data-stu-id="8e8bf-163">in Direct3D 11 there is little control over actually how work is submitted, it is largely handled by the driver, though some control is enabled through the [**ID3D11DeviceContext::Flush**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-flush) and [**IDXGISwapChain1::Present1**](/windows/win32/api/dxgi1_2/nf-dxgi1_2-idxgiswapchain1-present1) calls.</span></span>

<span data-ttu-id="8e8bf-164">Dans Direct3D 12, l’envoi de travail est très explicite et contrôlé par l’application.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-164">In Direct3D 12 work submission is very explicit and controlled by the app.</span></span> <span data-ttu-id="8e8bf-165">La construction principale pour l’envoi de travail est le [**ID3D12GraphicsCommandList**](/windows/win32/api/d3d12/nn-d3d12-id3d12graphicscommandlist), qui est utilisé pour enregistrer toutes les commandes des applications (et est assez similaire au concept du contexte différé ID3D11).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-165">The primary construct for submitting work is the [**ID3D12GraphicsCommandList**](/windows/win32/api/d3d12/nn-d3d12-id3d12graphicscommandlist), which is used to record all the apps commands (and is quite similar in concept to the ID3D11 deferred context).</span></span> <span data-ttu-id="8e8bf-166">Le magasin de stockage pour une liste de commandes est fourni par [**ID3D12CommandAllocator**](/windows/win32/api/d3d12/nn-d3d12-id3d12commandallocator), ce qui permet à l’application de gérer l’utilisation de la mémoire de la liste de commandes en exposant réellement la mémoire que le pilote Direct3D 12 va utiliser pour stocker la liste de commandes.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-166">Backing store for a command list is provided by the [**ID3D12CommandAllocator**](/windows/win32/api/d3d12/nn-d3d12-id3d12commandallocator), which enables the app to manage the memory utilization of the command list by actually exposing the memory that the Direct3D 12 driver is going to use to store the command list.</span></span>

<span data-ttu-id="8e8bf-167">Enfin, [**ID3D12CommandQueue**](/windows/win32/api/d3d12/nn-d3d12-id3d12commandqueue) est une file d’attente premier sorti, qui stocke l’ordre correct des listes de commandes à envoyer au GPU.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-167">Finally the [**ID3D12CommandQueue**](/windows/win32/api/d3d12/nn-d3d12-id3d12commandqueue) is a first-in first-out queue, that stores the correct order of the command lists for submission to the GPU.</span></span> <span data-ttu-id="8e8bf-168">La liste de commandes suivante de la file d’attente est envoyée par le pilote uniquement quand une liste de commandes a terminé l’exécution sur le GPU.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-168">Only when one command list has completed execution on the GPU, will the next command list from the queue be submitted by the driver.</span></span>

<span data-ttu-id="8e8bf-169">Dans Direct3D 11, il n’existe pas de concept explicite de file d’attente de commandes.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-169">In Direct3D 11 there is no explicit concept of a command queue.</span></span> <span data-ttu-id="8e8bf-170">Dans le cadre de l’installation courante de Direct3D 12, la liste des commandes **D3D12_COMMAND_LIST_TYPE_DIRECT** actuellement ouvertes pour le frame actuel peut être considérée comme analogue au contexte immédiat de Direct3D 11.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-170">In the common setup for Direct3D 12, the currently open **D3D12_COMMAND_LIST_TYPE_DIRECT** command list for the current frame can be considered analogous to the Direct3D 11 immediate context.</span></span> <span data-ttu-id="8e8bf-171">Cela fournit la plupart des fonctions.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-171">This provides many of the same functions.</span></span>


| <span data-ttu-id="8e8bf-172">D3D11DeviceContext</span><span class="sxs-lookup"><span data-stu-id="8e8bf-172">D3D11DeviceContext</span></span>                  | <span data-ttu-id="8e8bf-173">Liste ID3D12GraphicsCommand</span><span class="sxs-lookup"><span data-stu-id="8e8bf-173">ID3D12GraphicsCommand List</span></span>     |
|-------------------------------------|--------------------------------|
| <span data-ttu-id="8e8bf-174">ClearDepthStencilView</span><span class="sxs-lookup"><span data-stu-id="8e8bf-174">ClearDepthStencilView</span></span>               | <span data-ttu-id="8e8bf-175">ClearDepthStencilView</span><span class="sxs-lookup"><span data-stu-id="8e8bf-175">ClearDepthStencilView</span></span>          |
| <span data-ttu-id="8e8bf-176">ClearRenderTargetView</span><span class="sxs-lookup"><span data-stu-id="8e8bf-176">ClearRenderTargetView</span></span>               | <span data-ttu-id="8e8bf-177">ClearRenderTargetView</span><span class="sxs-lookup"><span data-stu-id="8e8bf-177">ClearRenderTargetView</span></span>          |
| <span data-ttu-id="8e8bf-178">ClearUnorderedAccess\*</span><span class="sxs-lookup"><span data-stu-id="8e8bf-178">ClearUnorderedAccess\*</span></span>               | <span data-ttu-id="8e8bf-179">ClearUnorderedAccess\*</span><span class="sxs-lookup"><span data-stu-id="8e8bf-179">ClearUnorderedAccess\*</span></span>          |
| <span data-ttu-id="8e8bf-180">Dessin, DrawInstanced</span><span class="sxs-lookup"><span data-stu-id="8e8bf-180">Draw, DrawInstanced</span></span>                 | <span data-ttu-id="8e8bf-181">DrawInstanced</span><span class="sxs-lookup"><span data-stu-id="8e8bf-181">DrawInstanced</span></span>                  |
| <span data-ttu-id="8e8bf-182">DrawIndexed, DrawIndexedInstanced</span><span class="sxs-lookup"><span data-stu-id="8e8bf-182">DrawIndexed, DrawIndexedInstanced</span></span>   | <span data-ttu-id="8e8bf-183">DrawIndexedInstanced</span><span class="sxs-lookup"><span data-stu-id="8e8bf-183">DrawIndexedInstanced</span></span>           |
| <span data-ttu-id="8e8bf-184">Dispatch</span><span class="sxs-lookup"><span data-stu-id="8e8bf-184">Dispatch</span></span>                            | <span data-ttu-id="8e8bf-185">Dispatch</span><span class="sxs-lookup"><span data-stu-id="8e8bf-185">Dispatch</span></span>                       |
| <span data-ttu-id="8e8bf-186">IASetInputLayout, xxSetShader, etc.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-186">IASetInputLayout, xxSetShader, etc.</span></span> | <span data-ttu-id="8e8bf-187">SetPipelineState</span><span class="sxs-lookup"><span data-stu-id="8e8bf-187">SetPipelineState</span></span>               |
| <span data-ttu-id="8e8bf-188">OMSetBlendState</span><span class="sxs-lookup"><span data-stu-id="8e8bf-188">OMSetBlendState</span></span>                     | <span data-ttu-id="8e8bf-189">OMSetBlendFactor</span><span class="sxs-lookup"><span data-stu-id="8e8bf-189">OMSetBlendFactor</span></span>               |
| <span data-ttu-id="8e8bf-190">OMSetDepthStencilState</span><span class="sxs-lookup"><span data-stu-id="8e8bf-190">OMSetDepthStencilState</span></span>              | <span data-ttu-id="8e8bf-191">OMSetStencilRef</span><span class="sxs-lookup"><span data-stu-id="8e8bf-191">OMSetStencilRef</span></span>                |
| <span data-ttu-id="8e8bf-192">OMSetRenderTargets</span><span class="sxs-lookup"><span data-stu-id="8e8bf-192">OMSetRenderTargets</span></span>                  | <span data-ttu-id="8e8bf-193">OMSetRenderTargets</span><span class="sxs-lookup"><span data-stu-id="8e8bf-193">OMSetRenderTargets</span></span>             |
| <span data-ttu-id="8e8bf-194">RSSetViewports</span><span class="sxs-lookup"><span data-stu-id="8e8bf-194">RSSetViewports</span></span>                      | <span data-ttu-id="8e8bf-195">RSSetViewports</span><span class="sxs-lookup"><span data-stu-id="8e8bf-195">RSSetViewports</span></span>                 |
| <span data-ttu-id="8e8bf-196">RSSetScissorRects</span><span class="sxs-lookup"><span data-stu-id="8e8bf-196">RSSetScissorRects</span></span>                   | <span data-ttu-id="8e8bf-197">RSSetScissorRects</span><span class="sxs-lookup"><span data-stu-id="8e8bf-197">RSSetScissorRects</span></span>              |
| <span data-ttu-id="8e8bf-198">IASetPrimitiveTopology</span><span class="sxs-lookup"><span data-stu-id="8e8bf-198">IASetPrimitiveTopology</span></span>              | <span data-ttu-id="8e8bf-199">IASetPrimitiveTopology</span><span class="sxs-lookup"><span data-stu-id="8e8bf-199">IASetPrimitiveTopology</span></span>         |
| <span data-ttu-id="8e8bf-200">IASetVertexBuffers</span><span class="sxs-lookup"><span data-stu-id="8e8bf-200">IASetVertexBuffers</span></span>                  | <span data-ttu-id="8e8bf-201">IASetVertexBuffers</span><span class="sxs-lookup"><span data-stu-id="8e8bf-201">IASetVertexBuffers</span></span>             |
| <span data-ttu-id="8e8bf-202">IASetIndexBuffer</span><span class="sxs-lookup"><span data-stu-id="8e8bf-202">IASetIndexBuffer</span></span>                    | <span data-ttu-id="8e8bf-203">IASetIndexBuffer</span><span class="sxs-lookup"><span data-stu-id="8e8bf-203">IASetIndexBuffer</span></span>               |
| <span data-ttu-id="8e8bf-204">ResolveSubresource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-204">ResolveSubresource</span></span>                  | <span data-ttu-id="8e8bf-205">ResolveSubresource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-205">ResolveSubresource</span></span>             |
| <span data-ttu-id="8e8bf-206">CopySubresourceRegion</span><span class="sxs-lookup"><span data-stu-id="8e8bf-206">CopySubresourceRegion</span></span>               | <span data-ttu-id="8e8bf-207">CopyBufferRegion</span><span class="sxs-lookup"><span data-stu-id="8e8bf-207">CopyBufferRegion</span></span>               |
| <span data-ttu-id="8e8bf-208">UpdateSubresource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-208">UpdateSubresource</span></span>                   | <span data-ttu-id="8e8bf-209">CopyTextureRegion</span><span class="sxs-lookup"><span data-stu-id="8e8bf-209">CopyTextureRegion</span></span>              |
| <span data-ttu-id="8e8bf-210">CopyResource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-210">CopyResource</span></span>                        | <span data-ttu-id="8e8bf-211">CopyResource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-211">CopyResource</span></span>                   |

> [!NOTE]
> <span data-ttu-id="8e8bf-212">Une liste de commandes créée avec **D3D12_COMMAND_LIST_TYPE_BUNDLE** est semblable dans un contexte différé.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-212">A command list created with **D3D12_COMMAND_LIST_TYPE_BUNDLE** is simliar to a deferred context.</span></span> <span data-ttu-id="8e8bf-213">Direct3D 12 prend également en charge le abiilty pour accéder à certaines fonctionnalités d’un *contexte immédiat* , de façon simultanée au rendu via **D3D12_COMMAND_LIST_TYPE_COPY** et **D3D12_COMMAND_LIST_TYPE_COMPUTE** les types de listes de commandes.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-213">Direct3D 12 also supports the abiilty to access some features of an *immediate context* simultaneous to rendering via **D3D12_COMMAND_LIST_TYPE_COPY** and **D3D12_COMMAND_LIST_TYPE_COMPUTE** command list types.</span></span>

## <a name="cpugpu-synchronization"></a><span data-ttu-id="8e8bf-214">Synchronisation UC/GPU</span><span class="sxs-lookup"><span data-stu-id="8e8bf-214">CPU/GPU Synchronization</span></span>

<span data-ttu-id="8e8bf-215">La synchronisation de l’UC/GPU de Direct3D 11 était largement automatique et il n’était pas nécessaire que l’application conserve l’état de la mémoire physique.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-215">In Direct3D 11 CPU/GPU synchronization was largely automatic, and there was no need for the app to maintain the status of physical memory.</span></span>

<span data-ttu-id="8e8bf-216">dans Direct3D 12, l’application doit gérer les deux chronologies (UC et GPU) de manière explicite.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-216">in Direct3D 12 the app must manage the two timelines (CPU and GPU) explicitly.</span></span> <span data-ttu-id="8e8bf-217">Cela implique que les informations doivent être conservées, par l’application, sur les ressources requises par le GPU et sur la durée.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-217">This requires that information needs to be maintained, by the app, on what resources are required by the GPU, and for how long.</span></span> <span data-ttu-id="8e8bf-218">Cela signifie également que l’application est chargée de s’assurer que le contenu des ressources (ressources validées, tas, allocateurs de commandes, par exemple) ne change pas tant que le GPU n’a pas fini de les utiliser.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-218">This also means that the app is responsible for ensuring the contents of resources (committed resources, heaps, command allocators, for example) do not change until the GPU has finished using them.</span></span>

<span data-ttu-id="8e8bf-219">L’objet principal pour la synchronisation des chronologies est l’objet [**ID3D12Fence**](/windows/win32/api/d3d12/nn-d3d12-id3d12fence) .</span><span class="sxs-lookup"><span data-stu-id="8e8bf-219">The main object for synchronizing the timelines is the [**ID3D12Fence**](/windows/win32/api/d3d12/nn-d3d12-id3d12fence) object.</span></span> <span data-ttu-id="8e8bf-220">L’opération des délimitations est simple, car elle permet au GPU de signaler quand il a terminé une tâche.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-220">The operation of fences is failry simple, they enable the GPU to signal when it has completed a task.</span></span> <span data-ttu-id="8e8bf-221">Le GPU et le processeur peuvent tous les deux signaler et peuvent attendre les limites.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-221">The GPU and CPU can both signal, and can both wait on fences.</span></span>

<span data-ttu-id="8e8bf-222">En général, l’approche est que lors de l’envoi d’une liste de commandes pour exécution, un signal de clôture est transmis par le GPU à la fin de l’opération (quand il a terminé la lecture des données), ce qui permet au processeur de réutiliser ou de détruire les ressources.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-222">Typically the approach is that when submitting a command list for execution, a fence signal is transmitted by the GPU on completion (when it has finished reading the data), enabling the CPU to reuse or destroy the resources.</span></span>

<span data-ttu-id="8e8bf-223">Dans Direct3D 11, l’indicateur [**ID3D11DeviceContext :: Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map) indicateur d3d11 \_ \_ Write \_ ignore fondamentalement traité chaque ressource comme une fourniture infinie de mémoire à laquelle l’application pourrait écrire (processus appelé « changement de nom »).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-223">In Direct3D 11 the [**ID3D11DeviceContext::Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map) flag D3D11\_MAP\_WRITE\_DISCARD essentially treated each resource as an endless supply of memory the app could write to (a process known as "renaming").</span></span> <span data-ttu-id="8e8bf-224">Dans Direct3D 12, le processus est explicite : la mémoire supplémentaire doit être allouée et les délimiteurs doivent être utilisés pour synchroniser les opérations.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-224">In Direct3D 12 again the process is explicit: additional memory needs to be allocated, and fences should be used to sync the operations.</span></span> <span data-ttu-id="8e8bf-225">Les mémoires tampons en anneau (comprenant des mémoires tampons volumineuses) peuvent être une bonne technique pour cela, reportez-vous au scénario de mémoire tampon en anneau dans [gestion des ressources basée sur](fence-based-resource-management.md)les délimitations.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-225">Ring buffers (consisting of large buffers) might be a good technique for this, refer to the ring buffer scenario in [Fence-Based Resource Management](fence-based-resource-management.md).</span></span>

![utilisation d’une mémoire tampon en anneau](images/ring-buffer-1.png)

## <a name="resource-binding"></a><span data-ttu-id="8e8bf-227">Liaison de ressource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-227">Resource Binding</span></span>

<span data-ttu-id="8e8bf-228">Les vues dans Direct3D 11 (vues des ressources de nuanceur, vues de cible de rendu, etc.) ont été en grande partie remplacées dans Direct3D 12 par le concept de descripteur.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-228">Views in Direct3D 11 (shader resource views, render target views, and so on), have largely been replaced in Direct3D 12 with the concept of a descriptor.</span></span> <span data-ttu-id="8e8bf-229">Les méthodes de création existent toujours dans Direct3D 12 (comme [**CreateShaderResourceView**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createshaderresourceview) et [**CreateRenderTargetView**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createrendertargetview)), qui sont appelées après la création du tas de descripteur, pour écrire les données dans le tas.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-229">The creation methods still exist in Direct3D 12 (such as [**CreateShaderResourceView**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createshaderresourceview) and [**CreateRenderTargetView**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createrendertargetview)), which are called after the descriptor heap has been created, to write the data into the heap.</span></span> <span data-ttu-id="8e8bf-230">La liaison dans Direct3D 12 est maintenant gérée par les handles de descripteur décrits dans une signature racine et envoyée à l’aide des méthodes [**SetGraphicsRootDescriptorTable**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setgraphicsrootdescriptortable) ou [**SetComputeRootDescriptorTable**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setcomputerootdescriptortable) .</span><span class="sxs-lookup"><span data-stu-id="8e8bf-230">Binding in Direct3D 12 is now handled by descriptor handles described in a root signature, and submitted using the [**SetGraphicsRootDescriptorTable**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setgraphicsrootdescriptortable) or [**SetComputeRootDescriptorTable**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setcomputerootdescriptortable) methods.</span></span>

<span data-ttu-id="8e8bf-231">Les signatures racines détaillent les mappages entre le numéro d’emplacement de signature racine et les tables de descripteurs, où la table de descripteurs peut contenir des références aux ressources disponibles pour les nuanceurs vertex, les nuanceurs de pixels et les autres nuanceurs, tels que les mémoires tampons constantes, les vues de ressources de nuanceur et les échantillonneurs.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-231">Root signatures details mappings between the root signature slot number and descriptor tables, where the descriptor table can contain references to resources available to vertex shaders, pixel shaders, and the other shaders, such as constant buffers, shader resource views and samplers.</span></span> <span data-ttu-id="8e8bf-232">Cette flexibilité déconnecte l’espace de registres HLSL de l’espace de liaison de l’API dans Direct3D 12, contrairement à Direct3D 11, où il existe un mappage un-à-un entre eux.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-232">This flexibility disconnects the HLSL register space from the API binding space in Direct3D 12, unlike Direct3D 11 where there is a one to one mapping between these.</span></span>

<span data-ttu-id="8e8bf-233">L’une des implications de ce système est que l’application est chargée de renommer les tables de descripteurs, ce qui permet aux développeurs de comprendre le coût des performances de la modification d’un seul descripteur par appel de dessin.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-233">One of the implications of this system is that the app is responsible for renaming descriptor tables, which enables developers to understand the performance cost of changing even a single descriptor per draw call.</span></span>

<span data-ttu-id="8e8bf-234">Une nouvelle fonctionnalité de Direct3D 12 est qu’une application peut contrôler quels descripteurs sont partagés entre les différentes étapes du nuanceur.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-234">A new feature of Direct3D 12 is that an app can control which descriptors are shared between which shader stages.</span></span> <span data-ttu-id="8e8bf-235">Dans Direct3D 11, les ressources telles que UAVs sont partagées entre toutes les étapes du nuanceur.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-235">In Direct3D 11 resources such as UAVs are shared between all shader stages.</span></span> <span data-ttu-id="8e8bf-236">En activant la désactivation des descripteurs pour certaines étapes de nuanceur, les registres utilisés par les descripteurs qui ont été désactivés sont disponibles pour être utilisés par les descripteurs activés pour une étape de nuanceur particulière.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-236">By enabling descriptors to be disabled for certain shader stages, the registers used by descriptors that have been disabled are available to be used by descriptors which are enabled for a particular shader stage.</span></span>

<span data-ttu-id="8e8bf-237">Le tableau suivant présente un exemple de signature racine.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-237">The following table shows an example root signature.</span></span>



| <span data-ttu-id="8e8bf-238">Emplacement du paramètre racine</span><span class="sxs-lookup"><span data-stu-id="8e8bf-238">Root Parameter Slot</span></span> | <span data-ttu-id="8e8bf-239">Entrée de table de descripteur</span><span class="sxs-lookup"><span data-stu-id="8e8bf-239">Descriptor Table Entry</span></span>         |
|---------------------|--------------------------------|
| <span data-ttu-id="8e8bf-240">0</span><span class="sxs-lookup"><span data-stu-id="8e8bf-240">0</span></span>                   | <span data-ttu-id="8e8bf-241">Plage du descripteur VS B0-B13</span><span class="sxs-lookup"><span data-stu-id="8e8bf-241">VS Descriptor Range b0-b13</span></span>     |
| <span data-ttu-id="8e8bf-242">1</span><span class="sxs-lookup"><span data-stu-id="8e8bf-242">1</span></span>                   | <span data-ttu-id="8e8bf-243">Plage du descripteur VS T0-T127</span><span class="sxs-lookup"><span data-stu-id="8e8bf-243">VS Descriptor Range t0-t127</span></span>    |
| <span data-ttu-id="8e8bf-244">2</span><span class="sxs-lookup"><span data-stu-id="8e8bf-244">2</span></span>                   | <span data-ttu-id="8e8bf-245">Plage du descripteur VS S0-S16</span><span class="sxs-lookup"><span data-stu-id="8e8bf-245">VS Descriptor Range s0-s16</span></span>     |
| <span data-ttu-id="8e8bf-246">3</span><span class="sxs-lookup"><span data-stu-id="8e8bf-246">3</span></span>                   | <span data-ttu-id="8e8bf-247">Plage du descripteur PS B0-B13</span><span class="sxs-lookup"><span data-stu-id="8e8bf-247">PS Descriptor Range b0-b13</span></span>     |
| <span data-ttu-id="8e8bf-248">...</span><span class="sxs-lookup"><span data-stu-id="8e8bf-248">...</span></span>                 |                                |
| <span data-ttu-id="8e8bf-249">14</span><span class="sxs-lookup"><span data-stu-id="8e8bf-249">14</span></span>                  | <span data-ttu-id="8e8bf-250">Plage de descripteurs DS S0-16</span><span class="sxs-lookup"><span data-stu-id="8e8bf-250">DS Descriptor Range s0-16</span></span>      |
| <span data-ttu-id="8e8bf-251">15</span><span class="sxs-lookup"><span data-stu-id="8e8bf-251">15</span></span>                  | <span data-ttu-id="8e8bf-252">Plage de descripteurs partagés U0-U63</span><span class="sxs-lookup"><span data-stu-id="8e8bf-252">Shared Descriptor Range u0-u63</span></span> |



 

## <a name="resource-state"></a><span data-ttu-id="8e8bf-253">État de la ressource</span><span class="sxs-lookup"><span data-stu-id="8e8bf-253">Resource state</span></span>

<span data-ttu-id="8e8bf-254">Dans Direct3D 11, l’état des ressources n’est pas géré par l’application, mais par le pilote.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-254">In Direct3D 11 resource state is not maintained by the app, but by the driver.</span></span>

<span data-ttu-id="8e8bf-255">Dans Direct3D 12, le maintien de l’état de la ressource devient la responsabilité de l’application, pour activer le parallélisme complet dans l’enregistrement des listes de commandes : l’application doit gérer les chronologies d’enregistrement pour les listes de commandes (qui peuvent être effectuées en parallèle) et les chronologies d’exécution qui doivent être séquentielles.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-255">In Direct3D 12 maintaining resource state becomes the responsibility of the app, to enable full parallelism in the recording of command lists: the app must handle the recording timelines for command lists (which can be done in parallel), and the execution timelines which must be sequential.</span></span>

<span data-ttu-id="8e8bf-256">Une transition d’état de ressource est gérée par la méthode [**ResourceBarrier**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-resourcebarrier) .</span><span class="sxs-lookup"><span data-stu-id="8e8bf-256">A resource state transition is handled by the [**ResourceBarrier**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-resourcebarrier) method.</span></span> <span data-ttu-id="8e8bf-257">En premier lieu, l’application doit informer le pilote lorsque l’utilisation des ressources change.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-257">Primarily the app must inform the driver when resource usage is changing.</span></span> <span data-ttu-id="8e8bf-258">Par exemple, si une ressource est utilisée en tant que cible de rendu, puis qu’elle doit être utilisée comme entrée d’un nuanceur de sommets lors de l’appel de dessin suivant, cela peut nécessiter un léger blocage dans l’opération GPU pour terminer l’opération de la cible de rendu avant de gérer le nuanceur de sommets.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-258">For example if a resource is being used as a render target, and then it is to be used as input to a vertex shader on the next draw call, then this might require a short stall in GPU operation to complete the render target operation before handling the vertex shader.</span></span>

<span data-ttu-id="8e8bf-259">Ce système permet une synchronisation fine des grains (les cabinets GPU) du pipeline graphique, ainsi que des vidages du cache et éventuellement des modifications de la disposition de la mémoire (par exemple, affichage de la cible de rendu sur la décompression de la vue du stencil de profondeur).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-259">This system enables fine grain synchronization (the GPU stalls) of the graphics pipeline, as well as cache flushes and possibly some memory layout changes (such as render target view to depth stencil view decompression).</span></span>

<span data-ttu-id="8e8bf-260">C’est ce qu’on appelle un cloisonnement de transition.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-260">This is known as a transition barrier.</span></span> <span data-ttu-id="8e8bf-261">Il existe d’autres types de barrières, dans Direct3D 11, [**ID3D11DeviceContext2 :: TiledResourceBarrier**](/windows/win32/api/d3d11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier) a activé la même mémoire physique que celle utilisée par deux ressources en mosaïque différentes.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-261">There are other kinds of barriers, in Direct3D 11 the [**ID3D11DeviceContext2::TiledResourceBarrier**](/windows/win32/api/d3d11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier) enabled the same physical memory to be used by two different tiled resources.</span></span> <span data-ttu-id="8e8bf-262">Dans Direct3D 12, on parle de « barrière d’alias ».</span><span class="sxs-lookup"><span data-stu-id="8e8bf-262">In Direct3D 12 this is referred to as an "aliasing barrier".</span></span> <span data-ttu-id="8e8bf-263">Les barrières d’alias peuvent être utilisées pour les ressources en mosaïque et placées dans Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-263">Aliasing barriers can be used for both tiled and placed resources in Direct3D 12.</span></span> <span data-ttu-id="8e8bf-264">En outre, il existe la barrière UAV.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-264">Additionally there is the UAV barrier.</span></span> <span data-ttu-id="8e8bf-265">Dans Direct3D 11, toutes les opérations de distribution et de dessin UAV doivent être sérialisées, même si ces opérations peuvent être canalisées ou fonctionner en parallèle.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-265">In Direct3D 11 all UAV dispatch and draw operations are required to be serialized, even though these operations can be pipelined or work in parallel.</span></span> <span data-ttu-id="8e8bf-266">Pour Direct3D 12, cette restriction est supprimée par l’ajout d’une barrière UAV.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-266">For Direct3D 12 this restriction is removed by the addition of a UAV barrier.</span></span> <span data-ttu-id="8e8bf-267">Une barrière UAV garantit que les opérations UAV sont séquentielles. ainsi, si une deuxième opération requiert que la première soit terminée, la seconde est forcée à attendre par l’ajout du cloisonnement.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-267">A UAV barrier ensures that UAV operations are sequential, so if a second operation requires that the first complete, the second will be forced to wait by the addition of the barrier.</span></span> <span data-ttu-id="8e8bf-268">L’opération par défaut pour UAVs est simplement que les opérations se poursuivent aussi rapidement que possible.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-268">The default operation for UAVs is simply that the operations will proceed as quickly as possible.</span></span>

<span data-ttu-id="8e8bf-269">Il existe clairement des gains de performances si une charge de travail peut être parallélisée.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-269">Clearly there are performance gains if a workload can be parallelized.</span></span>

## <a name="swapchains"></a><span data-ttu-id="8e8bf-270">Chaînes d’échange</span><span class="sxs-lookup"><span data-stu-id="8e8bf-270">Swapchains</span></span>

<span data-ttu-id="8e8bf-271">La chaîne de permutation DXGI est la base des chaînes de permutation dans Direct3D 11 et 12.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-271">The DXGI swap chain is the basis for swap chains in both Direct3D 11 and 12.</span></span> <span data-ttu-id="8e8bf-272">Il existe quelques différences mineures, dans Direct3D 11, les trois types de chaînes de permutation sont séquentiel, ignorer et retourner \_ séquentiellement.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-272">There are some minor differences, in Direct3D 11 the three types of swap chain are SEQUENTIAL, DISCARD, and FLIP\_SEQUENTIAL.</span></span> <span data-ttu-id="8e8bf-273">Pour Direct3D 12, il n’existe que deux types : retournement \_ séquentiel et Flip \_ ignore.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-273">For Direct3D 12 there are just two types: FLIP\_SEQUENTIAL and FLIP\_DISCARD.</span></span> <span data-ttu-id="8e8bf-274">Comme indiqué ci-dessus, vous devez créer explicitement votre utilise permutation via **IDXGIFactory4**, ou une version ultérieure, et utiliser la même interface pour toute énumération d’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-274">As noted above, you should be explicitly creating your swapchain via **IDXGIFactory4**, or later, and using the same interface for any adapter enumeration.</span></span>

<span data-ttu-id="8e8bf-275">Dans Direct3D 11, il existe une rotation automatique de la mémoire tampon d’arrière-plan : seule une vue de cible de rendu est nécessaire pour la mémoire tampon d’arrière-plan 0.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-275">In Direct3D 11 there is automatic backbuffer rotation: only one render target view is needed for back buffer 0.</span></span> <span data-ttu-id="8e8bf-276">Dans la rotation de la mémoire tampon Direct3D 12 est explicite, il doit y avoir une vue de la cible de rendu pour chaque mémoire tampon d’arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-276">In Direct3D 12 buffer rotation is explicit, there needs to be a render target view for each back buffer.</span></span> <span data-ttu-id="8e8bf-277">Utilisez la méthode [**IDXGISwapChain3 :: GetCurrentBackBufferIndex**](/windows/win32/api/dxgi1_4/nf-dxgi1_4-idxgiswapchain3-getcurrentbackbufferindex) pour sélectionner celle vers laquelle effectuer le rendu.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-277">Use the [**IDXGISwapChain3::GetCurrentBackBufferIndex**](/windows/win32/api/dxgi1_4/nf-dxgi1_4-idxgiswapchain3-getcurrentbackbufferindex) method to select which one to render to.</span></span> <span data-ttu-id="8e8bf-278">Là encore, cette flexibilité supplémentaire permet une plus grande parallélisation.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-278">Again this additional flexibility enables greater parallelization.</span></span>

> [!NOTE]
> <span data-ttu-id="8e8bf-279">Bien qu’il existe de nombreuses façons de configurer votre application, en général, les applications ont un **ID3D12CommandAllocator** par mémoire tampon de chaîne d’échange.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-279">While there are numerous ways to set up your application, generally applications have one **ID3D12CommandAllocator** per swap-chain buffer.</span></span> <span data-ttu-id="8e8bf-280">Cela permet à l’application de passer à la création d’un ensemble de commandes pour le frame suivant pendant que le GPU restitue le précédent.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-280">This allows the application to proceed to building up a set of commands for the next frame while the GPU renders the previous.</span></span>

## <a name="fixed-function-rendering"></a><span data-ttu-id="8e8bf-281">Correction du rendu des fonctions</span><span class="sxs-lookup"><span data-stu-id="8e8bf-281">Fixed function rendering</span></span>

<span data-ttu-id="8e8bf-282">Dans Direct3D 11, il existait quelques méthodes qui ont simplifié différentes opérations de niveau supérieur, telles que [**GenerateMips**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-generatemips) (création de chaînes MIP complètes) et [**DrawAuto**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-drawauto) (en utilisant la sortie de flux comme entrée de nuanceur sans autre entrée de l’application).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-282">In Direct3D 11 there were a few methods that simplified various higher level operations, such as [**GenerateMips**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-generatemips) (creating full mip chains) and [**DrawAuto**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-drawauto) (using stream output as shader input without further input from the app).</span></span> <span data-ttu-id="8e8bf-283">Ces méthodes ne sont pas disponibles dans Direct3D 12, l’application doit gérer ces opérations en créant des nuanceurs pour les exécuter.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-283">These methods are not available in Direct3D 12, the app needs to handle these operations by creating shaders to perform them.</span></span>

## <a name="odds-and-ends"></a><span data-ttu-id="8e8bf-284">Les chances et les extrémités</span><span class="sxs-lookup"><span data-stu-id="8e8bf-284">Odds and ends</span></span>

<span data-ttu-id="8e8bf-285">Le tableau suivant présente un certain nombre de fonctionnalités qui sont similaires entre Direct3D 11 et 12, mais ne sont pas identiques.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-285">The following table shows a number of features that are similar between Direct3D 11 and 12, but are not identical.</span></span>



| <span data-ttu-id="8e8bf-286">Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="8e8bf-286">Direct3D 11</span></span>                                                                            | <span data-ttu-id="8e8bf-287">Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="8e8bf-287">Direct3D 12</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                              |
|----------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8e8bf-288">**ID3D11Query**</span><span class="sxs-lookup"><span data-stu-id="8e8bf-288">**ID3D11Query**</span></span>](/windows/win32/api/d3d11/nn-d3d11-id3d11query)                                              | <span data-ttu-id="8e8bf-289">[**ID3D12QueryHeap**](/windows/win32/api/d3d12/nn-d3d12-id3d12queryheap) permet de regrouper les requêtes, réduisant ainsi le coût.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-289">[**ID3D12QueryHeap**](/windows/win32/api/d3d12/nn-d3d12-id3d12queryheap) allows queries to be grouped together, reducing the cost.</span></span>                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8e8bf-290">**ID3D11Predicate**</span><span class="sxs-lookup"><span data-stu-id="8e8bf-290">**ID3D11Predicate**</span></span>](/windows/win32/api/d3d11/nn-d3d11-id3d11predicate)                                      | <span data-ttu-id="8e8bf-291">Le prédicat est désormais activé en faisant en sorte que les données soient dans une mémoire tampon entièrement transparente.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-291">Predication is now enabled by having data in a fully transparent buffer.</span></span> <span data-ttu-id="8e8bf-292">L’objet [**ID3D11Predicate**](/windows/win32/api/d3d11/nn-d3d11-id3d11predicate) de Direct3D 11 est remplacé par [**ID3D12Resource :: Map**](/windows/win32/api/d3d12/nf-d3d12-id3d12resource-map), qui doit suivre un appel à [**ResolveQueryData**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-resolvequerydata) et une opération de synchronisation GPU à l’aide d’une barrière pour attendre que les données soient prêtes.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-292">The Direct3D 11 [**ID3D11Predicate**](/windows/win32/api/d3d11/nn-d3d11-id3d11predicate) object is replaced by [**ID3D12Resource::Map**](/windows/win32/api/d3d12/nf-d3d12-id3d12resource-map), which must follow a call to [**ResolveQueryData**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-resolvequerydata) and a GPU sync operation using a fence to wait for the data to be ready.</span></span> <span data-ttu-id="8e8bf-293">Reportez-vous à [predicate](predication.md).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-293">Refer to [Predication](predication.md).</span></span> |
| <span data-ttu-id="8e8bf-294">Compteur caché UAV/SO</span><span class="sxs-lookup"><span data-stu-id="8e8bf-294">UAV/SO hidden counter</span></span>                                                                  | <span data-ttu-id="8e8bf-295">L’application est responsable de l’allocation et de la gestion des compteurs SO/UAV.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-295">The app is responsible for allocation and management of SO/UAV counters.</span></span> <span data-ttu-id="8e8bf-296">Reportez-vous aux compteurs de [sortie Stream](stream-output-counters.md) et aux [compteurs UAV](uav-counters.md).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-296">Refer to [Stream Output Counters](stream-output-counters.md) and [UAV Counters](uav-counters.md).</span></span>                                                                                                                                                                                                                                                             |
| <span data-ttu-id="8e8bf-297">MinLOD dynamique des ressources (niveau de détail minimal)</span><span class="sxs-lookup"><span data-stu-id="8e8bf-297">Resource dynamic MinLOD (minium level of detail)</span></span>                                       | <span data-ttu-id="8e8bf-298">Cette valeur a été déplacée vers le descripteur SRV static MinLOD.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-298">This has been moved to the SRV descriptor static MinLOD.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="8e8bf-299">Dessin \* indirect/[**DispatchIndirect**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-dispatchindirect)</span><span class="sxs-lookup"><span data-stu-id="8e8bf-299">Draw\*Indirect/[**DispatchIndirect**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-dispatchindirect)</span></span> | <span data-ttu-id="8e8bf-300">Les méthodes indirectes de dessin sont toutes fusionnées dans la méthode à une [**ExecuteIndirect**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-executeindirect) .</span><span class="sxs-lookup"><span data-stu-id="8e8bf-300">Drawing indirect methods are all merged into the one [**ExecuteIndirect**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-executeindirect) method.</span></span>                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="8e8bf-301">Les formats DepthStencil sont entrelacés</span><span class="sxs-lookup"><span data-stu-id="8e8bf-301">DepthStencil formats are interleaved</span></span>                                                   | <span data-ttu-id="8e8bf-302">Les formats DepthStencil sont planaires.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-302">DepthStencil formats are planar.</span></span> <span data-ttu-id="8e8bf-303">Par exemple, un format de 24 bits de profondeur, 8 bits de stencil sont stockés au format 24/8/24/8... etc. dans Direct3D 11, mais en tant que 24/24/24... suivi de 8/8/8... dans Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-303">For example a format of 24 bits of depth, 8 bits of stencil would be stored in the format 24/8/24/8... etc in Direct3D 11, but as 24/24/24... followed by 8/8/8... in Direct3D 12.</span></span> <span data-ttu-id="8e8bf-304">Notez que chaque plan est sa propre sous-ressource dans D3D12 (reportez-vous aux sous- [ressources](subresources.md)).</span><span class="sxs-lookup"><span data-stu-id="8e8bf-304">Note that each plane is its own subresource in D3D12 (refer to [Subresources](subresources.md)).</span></span>                                                                                                                    |
| [<span data-ttu-id="8e8bf-305">**ResizeTilePool**</span><span class="sxs-lookup"><span data-stu-id="8e8bf-305">**ResizeTilePool**</span></span>](/windows/win32/api/d3d11_2/nf-d3d11_2-id3d11devicecontext2-resizetilepool)                   | <span data-ttu-id="8e8bf-306">Les ressources réservées peuvent être mappées à plusieurs tas.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-306">Reserved resources can be mapped to multiple heaps.</span></span> <span data-ttu-id="8e8bf-307">Lorsqu’un pool de mosaïques aurait été augmenté dans D3D11, un segment de mémoire supplémentaire peut être alloué dans D3D12 à la place.</span><span class="sxs-lookup"><span data-stu-id="8e8bf-307">When a tile pool would have been grown in D3D11, an additional heap can be allocated in D3D12 instead.</span></span>                                                                                                                                                                                                                                                                               |



 

## <a name="related-topics"></a><span data-ttu-id="8e8bf-308">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8e8bf-308">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8e8bf-309">Didacticiels vidéo sur DirectX Advanced Learning : Guide de Portage DirectX 11 vers DirectX 12</span><span class="sxs-lookup"><span data-stu-id="8e8bf-309">DirectX advanced learning video tutorials : DirectX 11 to DirectX 12 porting guide</span></span>](https://www.youtube.com/watch?v=BV64mdOCgZo)
</dt> <dt>

[<span data-ttu-id="8e8bf-310">Comprendre Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="8e8bf-310">Understanding Direct3D 12</span></span>](directx-12-getting-started.md)
</dt> <dt>

[<span data-ttu-id="8e8bf-311">Utilisation de Direct3D 11, Direct3D 10 et Direct2D</span><span class="sxs-lookup"><span data-stu-id="8e8bf-311">Working with Direct3D 11, Direct3D 10 and Direct2D</span></span>](direct3d-12-interop.md)
</dt> </dl>