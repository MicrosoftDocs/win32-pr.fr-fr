---
title: Utilisation de Strides pour exprimer le remplissage et la disposition de la mémoire
description: Les dizaines de DirectML sont décrits par des propriétés connues sous le nom de *tailles* et de *Strides* du tenseur.
ms.custom: Windows 10 May 2019 Update
ms.localizationpriority: high
ms.topic: article
ms.date: 04/19/2019
ms.openlocfilehash: b944b1a2600febe27f209bffcc0e355c6a9fc7db
ms.sourcegitcommit: cba7f424a292fd7f3a8518947b9466439b455419
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/23/2019
ms.locfileid: "104548536"
---
# <a name="using-strides-to-express-padding-and-memory-layout"></a><span data-ttu-id="e8796-103">Utilisation de Strides pour exprimer le remplissage et la disposition de la mémoire</span><span class="sxs-lookup"><span data-stu-id="e8796-103">Using strides to express padding and memory layout</span></span>

<span data-ttu-id="e8796-104">Les dizaines &mdash; de DirectML qui sont sauvegardés par les tampons Direct3D 12 &mdash; sont décrits par des propriétés connues sous le nom de *tailles* et de *Strides* du tenseur.</span><span class="sxs-lookup"><span data-stu-id="e8796-104">DirectML tensors&mdash;which are are backed by Direct3D 12 buffers&mdash;are described by properties known as the *sizes* and the *strides* of the tensor.</span></span> <span data-ttu-id="e8796-105">Les *tailles* de tenseur décrivent les dimensions logiques du tenseur.</span><span class="sxs-lookup"><span data-stu-id="e8796-105">The tensor's *sizes* describe the logical dimensions of the tensor.</span></span> <span data-ttu-id="e8796-106">Par exemple, un tenseur 2D peut avoir une hauteur de 2 et une largeur de 3.</span><span class="sxs-lookup"><span data-stu-id="e8796-106">For example, a 2D tensor might have a height of 2 and a width of 3.</span></span> <span data-ttu-id="e8796-107">Logiquement, tenseur a 6 éléments distincts, bien que les tailles ne spécifient pas la manière dont ces éléments sont stockés en mémoire.</span><span class="sxs-lookup"><span data-stu-id="e8796-107">Logically, the tensor has 6 distinct elements, although the sizes don't specify how those elements are stored in memory.</span></span> <span data-ttu-id="e8796-108">Les *Strides* de tenseur décrivent la disposition de la mémoire physique des éléments du tenseur.</span><span class="sxs-lookup"><span data-stu-id="e8796-108">The tensor's *strides* describe the physical memory layout of the tensor's elements.</span></span>

## <a name="two-dimensional-2d-arrays"></a><span data-ttu-id="e8796-109">Tableaux à deux dimensions (2D)</span><span class="sxs-lookup"><span data-stu-id="e8796-109">Two-dimensional (2D) arrays</span></span>

<span data-ttu-id="e8796-110">Prenons un tenseur 2D qui a une hauteur de 2 et une largeur de 3 ; les données comprennent des caractères textuels.</span><span class="sxs-lookup"><span data-stu-id="e8796-110">Consider a 2D tensor that has a height of 2 and a width of 3; the data comprises textual characters.</span></span> <span data-ttu-id="e8796-111">En C/C++, cela peut être exprimé à l’aide d’un tableau multidimensionnel.</span><span class="sxs-lookup"><span data-stu-id="e8796-111">In C/C++, this might be expressed using a multi-dimensional array.</span></span>

```cpp
constexpr int rows = 2;
constexpr int columns = 3;
char tensor[rows][columns];
tensor[0][0] = 'A';
tensor[0][1] = 'B';
tensor[0][2] = 'C';
tensor[1][0] = 'D';
tensor[1][1] = 'E';
tensor[1][2] = 'F';
```

<span data-ttu-id="e8796-112">La vue logique du tenseur ci-dessus est visualisée ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="e8796-112">The logical view of the above tensor is visualized below.</span></span>

```console
A B C
D E F
```

<span data-ttu-id="e8796-113">En C/C++, un tableau multidimensionnel est stocké dans l’ordre ligne-principal.</span><span class="sxs-lookup"><span data-stu-id="e8796-113">In C/C++, a multi-dimensional array is stored in row-major order.</span></span> <span data-ttu-id="e8796-114">En d’autres termes, les éléments consécutifs le long de la dimension de largeur sont stockés de façon contiguë dans l’espace mémoire linéaire.</span><span class="sxs-lookup"><span data-stu-id="e8796-114">In other words, the consecutive elements along the width dimension are stored contiguously in linear memory space.</span></span>

<span data-ttu-id="e8796-115">Décalage :</span><span class="sxs-lookup"><span data-stu-id="e8796-115">Offset:</span></span>|<span data-ttu-id="e8796-116">0</span><span class="sxs-lookup"><span data-stu-id="e8796-116">0</span></span>|<span data-ttu-id="e8796-117">1</span><span class="sxs-lookup"><span data-stu-id="e8796-117">1</span></span>|<span data-ttu-id="e8796-118">2</span><span class="sxs-lookup"><span data-stu-id="e8796-118">2</span></span>|<span data-ttu-id="e8796-119">3</span><span class="sxs-lookup"><span data-stu-id="e8796-119">3</span></span>|<span data-ttu-id="e8796-120">4</span><span class="sxs-lookup"><span data-stu-id="e8796-120">4</span></span>|<span data-ttu-id="e8796-121">5</span><span class="sxs-lookup"><span data-stu-id="e8796-121">5</span></span>
-|-|-|-|-|-|-
<span data-ttu-id="e8796-122">Valeur :</span><span class="sxs-lookup"><span data-stu-id="e8796-122">Value:</span></span>|<span data-ttu-id="e8796-123">Un</span><span class="sxs-lookup"><span data-stu-id="e8796-123">A</span></span>|<span data-ttu-id="e8796-124">B</span><span class="sxs-lookup"><span data-stu-id="e8796-124">B</span></span>|<span data-ttu-id="e8796-125">C</span><span class="sxs-lookup"><span data-stu-id="e8796-125">C</span></span>|<span data-ttu-id="e8796-126">D</span><span class="sxs-lookup"><span data-stu-id="e8796-126">D</span></span>|<span data-ttu-id="e8796-127">E</span><span class="sxs-lookup"><span data-stu-id="e8796-127">E</span></span>|<span data-ttu-id="e8796-128">F</span><span class="sxs-lookup"><span data-stu-id="e8796-128">F</span></span>

<span data-ttu-id="e8796-129">Le *Stride* d’une dimension est le nombre d’éléments à ignorer afin d’accéder à l’élément suivant dans cette dimension.</span><span class="sxs-lookup"><span data-stu-id="e8796-129">The *stride* of a dimension is the number of elements to skip in order to access the next element in that dimension.</span></span> <span data-ttu-id="e8796-130">Strides Express la disposition des tenseur en mémoire.</span><span class="sxs-lookup"><span data-stu-id="e8796-130">Strides express the layout of the tensor in memory.</span></span> <span data-ttu-id="e8796-131">Avec un ordre ligne-grand, le Stride de la dimension width est toujours égal à 1, car les éléments adjacents le long de la dimension sont stockés de façon contiguë.</span><span class="sxs-lookup"><span data-stu-id="e8796-131">With a row-major order, the stride of the width dimension is always 1, since adjacent elements along the dimension are stored contiguously.</span></span> <span data-ttu-id="e8796-132">Le Stride de la dimension de hauteur dépend de la taille de la dimension de largeur ; dans l’exemple ci-dessus, la distance entre les éléments consécutifs le long de la dimension de la hauteur (par exemple, A à D) est égale à la largeur du tenseur (qui est 3 dans cet exemple).</span><span class="sxs-lookup"><span data-stu-id="e8796-132">The stride of the height dimension depends on the size of the width dimension; in the above example, the distance between consecutive elements along the height dimension (for example, A to D) is equal to the width of the tensor (which is 3 in this example).</span></span>

<span data-ttu-id="e8796-133">Pour illustrer une disposition différente, pensez à l’ordre des colonnes.</span><span class="sxs-lookup"><span data-stu-id="e8796-133">To illustrate a different layout, consider column-major order.</span></span> <span data-ttu-id="e8796-134">En d’autres termes, les éléments consécutifs le long de la dimension de hauteur sont stockés de façon contiguë dans l’espace mémoire linéaire.</span><span class="sxs-lookup"><span data-stu-id="e8796-134">In other words, the consecutive elements along the height dimension are stored contiguously in linear memory space.</span></span> <span data-ttu-id="e8796-135">Dans ce cas, la hauteur-Stride est toujours 1 et la largeur-Stride est 2 (la taille de la dimension de hauteur).</span><span class="sxs-lookup"><span data-stu-id="e8796-135">In this case, the height-stride is always 1, and the width-stride is 2 (the size of the height dimension).</span></span>

<span data-ttu-id="e8796-136">Décalage :</span><span class="sxs-lookup"><span data-stu-id="e8796-136">Offset:</span></span>|<span data-ttu-id="e8796-137">0</span><span class="sxs-lookup"><span data-stu-id="e8796-137">0</span></span>|<span data-ttu-id="e8796-138">1</span><span class="sxs-lookup"><span data-stu-id="e8796-138">1</span></span>|<span data-ttu-id="e8796-139">2</span><span class="sxs-lookup"><span data-stu-id="e8796-139">2</span></span>|<span data-ttu-id="e8796-140">3</span><span class="sxs-lookup"><span data-stu-id="e8796-140">3</span></span>|<span data-ttu-id="e8796-141">4</span><span class="sxs-lookup"><span data-stu-id="e8796-141">4</span></span>|<span data-ttu-id="e8796-142">5</span><span class="sxs-lookup"><span data-stu-id="e8796-142">5</span></span>
-|-|-|-|-|-|-
<span data-ttu-id="e8796-143">Valeur :</span><span class="sxs-lookup"><span data-stu-id="e8796-143">Value:</span></span>|<span data-ttu-id="e8796-144">Un</span><span class="sxs-lookup"><span data-stu-id="e8796-144">A</span></span>|<span data-ttu-id="e8796-145">D</span><span class="sxs-lookup"><span data-stu-id="e8796-145">D</span></span>|<span data-ttu-id="e8796-146">B</span><span class="sxs-lookup"><span data-stu-id="e8796-146">B</span></span>|<span data-ttu-id="e8796-147">E</span><span class="sxs-lookup"><span data-stu-id="e8796-147">E</span></span>|<span data-ttu-id="e8796-148">C</span><span class="sxs-lookup"><span data-stu-id="e8796-148">C</span></span>|<span data-ttu-id="e8796-149">F</span><span class="sxs-lookup"><span data-stu-id="e8796-149">F</span></span>

## <a name="higher-dimensions"></a><span data-ttu-id="e8796-150">Dimensions supérieures</span><span class="sxs-lookup"><span data-stu-id="e8796-150">Higher dimensions</span></span>

<span data-ttu-id="e8796-151">Lorsqu’il s’agit de plus de deux dimensions, il est difficile de faire référence à une disposition en tant que ligne-principale ou colonne-majeure.</span><span class="sxs-lookup"><span data-stu-id="e8796-151">When it comes to greater than two dimensions, it's unwieldy to refer to a layout as either row-major or column-major.</span></span> <span data-ttu-id="e8796-152">Ainsi, le reste de cette rubrique utilise des termes et des étiquettes tels que ceux-ci.</span><span class="sxs-lookup"><span data-stu-id="e8796-152">So, the rest of this topic uses terms and labels such as these.</span></span>

- <span data-ttu-id="e8796-153">2D : la hauteur « HW » &mdash; est la dimension de l’ordre le plus élevé (ligne-principale).</span><span class="sxs-lookup"><span data-stu-id="e8796-153">2D: "HW"&mdash;height is the highest-order dimension (row-major).</span></span>
- <span data-ttu-id="e8796-154">2D : la largeur « WH » &mdash; est la dimension de l’ordre le plus élevé (colonne-principale).</span><span class="sxs-lookup"><span data-stu-id="e8796-154">2D: "WH"&mdash;width is the highest-order dimension (column-major).</span></span>
- <span data-ttu-id="e8796-155">3D : la profondeur « DHW » &mdash; est la dimension de l’ordre le plus élevé, suivie de la hauteur, puis de la largeur.</span><span class="sxs-lookup"><span data-stu-id="e8796-155">3D: "DHW"&mdash;depth is the highest-order dimension, followed by height, and then width.</span></span>
- <span data-ttu-id="e8796-156">3D : la largeur de « WHD » &mdash; est la dimension de l’ordre le plus élevé, suivie de la hauteur, puis de la profondeur.</span><span class="sxs-lookup"><span data-stu-id="e8796-156">3D: "WHD"&mdash;width is the highest-order dimension, followed by height, and then depth.</span></span>
- <span data-ttu-id="e8796-157">4D : « NCHW » &mdash; nombre d’images (taille de lot), le nombre de canaux, puis la hauteur, la largeur.</span><span class="sxs-lookup"><span data-stu-id="e8796-157">4D: "NCHW"&mdash;the number of images (batch size), then the number of channels, then height, then width.</span></span>

<span data-ttu-id="e8796-158">En général, le Stride *condensé* d’une dimension est égal au produit de la taille des dimensions de l’ordre inférieur.</span><span class="sxs-lookup"><span data-stu-id="e8796-158">In general, the *packed* stride of a dimension is equal to the product of the sizes of the lower-order dimensions.</span></span> <span data-ttu-id="e8796-159">Par exemple, avec une disposition « DHW », la valeur D-Stride est égale à H \* W ; la valeur H-Stride est égale à W ; et W-Stride est égal à 1.</span><span class="sxs-lookup"><span data-stu-id="e8796-159">For example, with a "DHW" layout, the D-stride is equal to H \* W; the H-stride is equal to W; and the W-stride is equal to 1.</span></span> <span data-ttu-id="e8796-160">Les Strides sont considérés comme *conditionnés* lorsque la taille physique totale du tenseur est égale à la taille logique totale du tenseur ; en d’autres termes, il n’y a pas d’espace supplémentaire ni d’éléments qui se chevauchent.</span><span class="sxs-lookup"><span data-stu-id="e8796-160">Strides are said to be *packed* when the total physical size of the tensor is equal to the total logical size of the tensor; in other words, there's no extra space nor overlapping elements.</span></span>

<span data-ttu-id="e8796-161">Nous allons étendre l’exemple 2D à trois dimensions, afin que nous ayons un tenseur avec la profondeur 2, la hauteur 2 et la largeur 3 (pour un total de 12 éléments logiques).</span><span class="sxs-lookup"><span data-stu-id="e8796-161">Let's extend the 2D example to three dimensions, so that we have a tensor with depth 2, height 2, and width 3 (for a total of 12 logical elements).</span></span>

```console
A B C
D E F

G H I
J K L
```

<span data-ttu-id="e8796-162">Avec une disposition « DHW », ce tenseur est stocké comme suit.</span><span class="sxs-lookup"><span data-stu-id="e8796-162">With a "DHW" layout, this tensor is stored as follows.</span></span>

<span data-ttu-id="e8796-163">Décalage :</span><span class="sxs-lookup"><span data-stu-id="e8796-163">Offset:</span></span>|<span data-ttu-id="e8796-164">0</span><span class="sxs-lookup"><span data-stu-id="e8796-164">0</span></span>|<span data-ttu-id="e8796-165">1</span><span class="sxs-lookup"><span data-stu-id="e8796-165">1</span></span>|<span data-ttu-id="e8796-166">2</span><span class="sxs-lookup"><span data-stu-id="e8796-166">2</span></span>|<span data-ttu-id="e8796-167">3</span><span class="sxs-lookup"><span data-stu-id="e8796-167">3</span></span>|<span data-ttu-id="e8796-168">4</span><span class="sxs-lookup"><span data-stu-id="e8796-168">4</span></span>|<span data-ttu-id="e8796-169">5</span><span class="sxs-lookup"><span data-stu-id="e8796-169">5</span></span>|<span data-ttu-id="e8796-170">6</span><span class="sxs-lookup"><span data-stu-id="e8796-170">6</span></span>|<span data-ttu-id="e8796-171">7</span><span class="sxs-lookup"><span data-stu-id="e8796-171">7</span></span>|<span data-ttu-id="e8796-172">8</span><span class="sxs-lookup"><span data-stu-id="e8796-172">8</span></span>|<span data-ttu-id="e8796-173">9</span><span class="sxs-lookup"><span data-stu-id="e8796-173">9</span></span>|<span data-ttu-id="e8796-174">10</span><span class="sxs-lookup"><span data-stu-id="e8796-174">10</span></span>|<span data-ttu-id="e8796-175">11</span><span class="sxs-lookup"><span data-stu-id="e8796-175">11</span></span>|
-|-|-|-|-|-|-|-|-|-|-|-|-|
<span data-ttu-id="e8796-176">Valeur :</span><span class="sxs-lookup"><span data-stu-id="e8796-176">Value:</span></span>|<span data-ttu-id="e8796-177">Un</span><span class="sxs-lookup"><span data-stu-id="e8796-177">A</span></span>|<span data-ttu-id="e8796-178">B</span><span class="sxs-lookup"><span data-stu-id="e8796-178">B</span></span>|<span data-ttu-id="e8796-179">C</span><span class="sxs-lookup"><span data-stu-id="e8796-179">C</span></span>|<span data-ttu-id="e8796-180">D</span><span class="sxs-lookup"><span data-stu-id="e8796-180">D</span></span>|<span data-ttu-id="e8796-181">E</span><span class="sxs-lookup"><span data-stu-id="e8796-181">E</span></span>|<span data-ttu-id="e8796-182">F</span><span class="sxs-lookup"><span data-stu-id="e8796-182">F</span></span>|<span data-ttu-id="e8796-183">G</span><span class="sxs-lookup"><span data-stu-id="e8796-183">G</span></span>|<span data-ttu-id="e8796-184">H</span><span class="sxs-lookup"><span data-stu-id="e8796-184">H</span></span>|<span data-ttu-id="e8796-185">I</span><span class="sxs-lookup"><span data-stu-id="e8796-185">I</span></span>|<span data-ttu-id="e8796-186">J</span><span class="sxs-lookup"><span data-stu-id="e8796-186">J</span></span>|<span data-ttu-id="e8796-187">K</span><span class="sxs-lookup"><span data-stu-id="e8796-187">K</span></span>|<span data-ttu-id="e8796-188">L</span><span class="sxs-lookup"><span data-stu-id="e8796-188">L</span></span>|

- <span data-ttu-id="e8796-189">D-Stride = hauteur (2) \* largeur (3) = 6 (par exemple, la distance entre « A » et « G »).</span><span class="sxs-lookup"><span data-stu-id="e8796-189">D-stride = height (2) \* width (3) = 6 (for example, the distance between 'A' and 'G').</span></span>
- <span data-ttu-id="e8796-190">H-Stride = Width (3) = 3 (par exemple, la distance entre « A » et « d »).</span><span class="sxs-lookup"><span data-stu-id="e8796-190">H-stride = width (3) = 3 (for example, the distance between 'A' and 'D').</span></span>
- <span data-ttu-id="e8796-191">W-STRIDE = 1 (par exemple, la distance entre « A » et « B »).</span><span class="sxs-lookup"><span data-stu-id="e8796-191">W-stride = 1 (for example, the distance between 'A' and 'B').</span></span>

<span data-ttu-id="e8796-192">Le produit scalaire des index/coordonnées d’un élément et des Strides fournit le décalage vers cet élément dans la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="e8796-192">The dot product of the indices/coordinates of an element and the strides provides the offset to that element in the buffer.</span></span> <span data-ttu-id="e8796-193">Par exemple, le décalage de l’élément H (d = 1, H = 0, w = 1) est 7.</span><span class="sxs-lookup"><span data-stu-id="e8796-193">For example, the offset of the H element (d=1, h=0, w=1) is 7.</span></span>

<span data-ttu-id="e8796-194">{1, 0, 1} ⋅ {6, 3, 1} = 1 \* 6 + 0 \* 3 + 1 \* 1 = 7</span><span class="sxs-lookup"><span data-stu-id="e8796-194">{1, 0, 1} ⋅ {6, 3, 1} = 1 \* 6 + 0 \* 3 + 1 \* 1 = 7</span></span>

## <a name="packed-tensors"></a><span data-ttu-id="e8796-195">Dizaines compressés</span><span class="sxs-lookup"><span data-stu-id="e8796-195">Packed tensors</span></span>

<span data-ttu-id="e8796-196">Les exemples ci-dessus illustrent des dizaines *compressés* .</span><span class="sxs-lookup"><span data-stu-id="e8796-196">The examples above illustrate *packed* tensors.</span></span> <span data-ttu-id="e8796-197">Un tenseur est dit *compressé* lorsque la taille logique du tenseur (dans les éléments) est égale à la taille physique de la mémoire tampon (dans les éléments), et que chaque élément a une adresse/un décalage unique.</span><span class="sxs-lookup"><span data-stu-id="e8796-197">A tensor is said to be *packed* when the logical size of the tensor (in elements) is equal to the physical size of the buffer (in elements), and each element has a unique address/offset.</span></span> <span data-ttu-id="e8796-198">Par exemple, un tenseur 2x2x3 est compressé si la mémoire tampon est de 12 éléments et si aucune paire d’éléments ne partagent le même offset dans la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="e8796-198">For example, a 2x2x3 tensor is packed if the buffer is 12 elements in length and no pair of elements share the same offset in the buffer.</span></span> <span data-ttu-id="e8796-199">Les dizaines compressés sont les cas les plus courants. mais les Strides permettent des dispositions de mémoire plus complexes.</span><span class="sxs-lookup"><span data-stu-id="e8796-199">Packed tensors are the most common case; but strides allow more complex memory layouts.</span></span>

## <a name="broadcasting-with-strides"></a><span data-ttu-id="e8796-200">Diffusion avec Strides</span><span class="sxs-lookup"><span data-stu-id="e8796-200">Broadcasting with strides</span></span>

<span data-ttu-id="e8796-201">Si la taille de mémoire tampon d’un tenseur (dans les éléments) est inférieure au produit de ses dimensions logiques, il doit y avoir un chevauchement d’éléments.</span><span class="sxs-lookup"><span data-stu-id="e8796-201">If a tensor's buffer size (in elements) is smaller than the product of its logical dimensions, then it follows that there must be some overlapping of elements.</span></span> <span data-ttu-id="e8796-202">Le cas habituel est appelé « *diffusion*». où les éléments d’une dimension sont un doublon d’une autre dimension.</span><span class="sxs-lookup"><span data-stu-id="e8796-202">The usual case for this is known as *broadcasting*; where the elements of a dimension are a duplicate of another dimension.</span></span> <span data-ttu-id="e8796-203">Par exemple, revenons à l’exemple 2D.</span><span class="sxs-lookup"><span data-stu-id="e8796-203">For example, let's revisit the 2D example.</span></span> <span data-ttu-id="e8796-204">Supposons que nous voulons un tenseur logiquement 2x3, mais la deuxième ligne est identique à la première ligne.</span><span class="sxs-lookup"><span data-stu-id="e8796-204">Let's say that we want a tensor that is logically 2x3, but the second row is identical to the first row.</span></span> <span data-ttu-id="e8796-205">Voici à quoi cela ressemble.</span><span class="sxs-lookup"><span data-stu-id="e8796-205">Here's how that looks.</span></span>

```console
A B C
A B C
```

<span data-ttu-id="e8796-206">Cela peut être stocké sous la forme d’un tenseur de matériel/ligne-principal compressé.</span><span class="sxs-lookup"><span data-stu-id="e8796-206">This could be stored as a packed HW/row-major tensor.</span></span> <span data-ttu-id="e8796-207">Mais un stockage plus compact contient uniquement 3 éléments (A, B et C) et utilise une hauteur-Stride de 0 au lieu de 3.</span><span class="sxs-lookup"><span data-stu-id="e8796-207">But a more compact storage would contain only 3 elements (A, B, and C) and use a height-stride of 0 instead of 3.</span></span> <span data-ttu-id="e8796-208">Dans ce cas, la taille physique du tenseur est de 3 éléments, mais la taille logique est de 6 éléments.</span><span class="sxs-lookup"><span data-stu-id="e8796-208">In this case, the physical size of the tensor is 3 elements, but the logical size is 6 elements.</span></span>

<span data-ttu-id="e8796-209">En général, si le Stride d’une dimension est égal à 0, tous les éléments dans les dimensions de l’ordre inférieur sont répétés le long de la dimension diffusée. par exemple, si tenseur est NCHW et que C-Stride est égal à 0, chaque canal a les mêmes valeurs le long de H et W.</span><span class="sxs-lookup"><span data-stu-id="e8796-209">In general, if the stride of a dimension is 0, then all elements in the lower-order dimensions are repeated along the broadcasted dimension; for example, if the tensor is NCHW and the C-stride is 0, then each channel has the same values along H and W.</span></span>

## <a name="padding-with-strides"></a><span data-ttu-id="e8796-210">Remplissage avec des Strides</span><span class="sxs-lookup"><span data-stu-id="e8796-210">Padding with strides</span></span>

<span data-ttu-id="e8796-211">Un tenseur est dit *rempli* si sa taille physique est supérieure à la taille minimale requise pour ajuster ses éléments.</span><span class="sxs-lookup"><span data-stu-id="e8796-211">A tensor is said to be *padded* if its physical size is larger than the minimum size needed to fit its elements.</span></span> <span data-ttu-id="e8796-212">Lorsqu’il n’y a pas d’éléments de diffusion ou de chevauchement, la taille minimale du tenseur (dans les éléments) est simplement le produit de ses dimensions.</span><span class="sxs-lookup"><span data-stu-id="e8796-212">When there is no broadcasting nor overlapping elements, the minimum size of the tensor (in elements) is simply the product of its dimensions.</span></span> <span data-ttu-id="e8796-213">Vous pouvez utiliser la fonction d’assistance `DMLCalcBufferTensorSize` (consultez [fonctions d’assistance DirectML](dml-helper-functions.md) pour obtenir une liste de cette fonction) afin de calculer la taille de mémoire tampon *minimale* pour vos dizaines de DirectML.</span><span class="sxs-lookup"><span data-stu-id="e8796-213">You can use the helper function `DMLCalcBufferTensorSize` (see [DirectML helper functions](dml-helper-functions.md) for a listing of that function) to calculate the *minimum* buffer size for your DirectML tensors.</span></span>

<span data-ttu-id="e8796-214">Supposons qu’une mémoire tampon contient les valeurs suivantes (les éléments « x » indiquent des valeurs de remplissage).</span><span class="sxs-lookup"><span data-stu-id="e8796-214">Let's say that a buffer contains the following values (the 'x' elements indicate padding values).</span></span>

<span data-ttu-id="e8796-215">0</span><span class="sxs-lookup"><span data-stu-id="e8796-215">0</span></span>|<span data-ttu-id="e8796-216">1</span><span class="sxs-lookup"><span data-stu-id="e8796-216">1</span></span>|<span data-ttu-id="e8796-217">2</span><span class="sxs-lookup"><span data-stu-id="e8796-217">2</span></span>|<span data-ttu-id="e8796-218">3</span><span class="sxs-lookup"><span data-stu-id="e8796-218">3</span></span>|<span data-ttu-id="e8796-219">4</span><span class="sxs-lookup"><span data-stu-id="e8796-219">4</span></span>|<span data-ttu-id="e8796-220">5</span><span class="sxs-lookup"><span data-stu-id="e8796-220">5</span></span>|<span data-ttu-id="e8796-221">6</span><span class="sxs-lookup"><span data-stu-id="e8796-221">6</span></span>|<span data-ttu-id="e8796-222">7</span><span class="sxs-lookup"><span data-stu-id="e8796-222">7</span></span>|<span data-ttu-id="e8796-223">8</span><span class="sxs-lookup"><span data-stu-id="e8796-223">8</span></span>|<span data-ttu-id="e8796-224">9</span><span class="sxs-lookup"><span data-stu-id="e8796-224">9</span></span>|
-|-|-|-|-|-|-|-|-|-|
<span data-ttu-id="e8796-225">Un</span><span class="sxs-lookup"><span data-stu-id="e8796-225">A</span></span>|<span data-ttu-id="e8796-226">B</span><span class="sxs-lookup"><span data-stu-id="e8796-226">B</span></span>|<span data-ttu-id="e8796-227">C</span><span class="sxs-lookup"><span data-stu-id="e8796-227">C</span></span>|<span data-ttu-id="e8796-228">x</span><span class="sxs-lookup"><span data-stu-id="e8796-228">x</span></span>|<span data-ttu-id="e8796-229">x</span><span class="sxs-lookup"><span data-stu-id="e8796-229">x</span></span>|<span data-ttu-id="e8796-230">D</span><span class="sxs-lookup"><span data-stu-id="e8796-230">D</span></span>|<span data-ttu-id="e8796-231">E</span><span class="sxs-lookup"><span data-stu-id="e8796-231">E</span></span>|<span data-ttu-id="e8796-232">F</span><span class="sxs-lookup"><span data-stu-id="e8796-232">F</span></span>|<span data-ttu-id="e8796-233">x</span><span class="sxs-lookup"><span data-stu-id="e8796-233">x</span></span>|<span data-ttu-id="e8796-234">x</span><span class="sxs-lookup"><span data-stu-id="e8796-234">x</span></span>

<span data-ttu-id="e8796-235">Le tenseur rempli peut être décrit en utilisant une hauteur-Stride de 5 au lieu de 3.</span><span class="sxs-lookup"><span data-stu-id="e8796-235">The padded tensor can be described by using a height-stride of 5 instead of 3.</span></span> <span data-ttu-id="e8796-236">Au lieu d’effectuer un pas à pas de trois éléments pour passer à la ligne suivante, l’étape est de 5 éléments (3 éléments *réels* plus 2 éléments de remplissage).</span><span class="sxs-lookup"><span data-stu-id="e8796-236">Instead of stepping by 3 elements to get to the next row, the step is 5 elements (3 *real* elements plus 2 padding elements).</span></span> <span data-ttu-id="e8796-237">Le remplissage est courant dans les graphiques informatiques, par exemple, pour s’assurer qu’une image a un alignement de puissance de deux.</span><span class="sxs-lookup"><span data-stu-id="e8796-237">Padding is common in computer graphics, for example, to ensure that an image has a power-of-two alignment.</span></span>

```console
A B C
D E F
```

## <a name="directml-buffer-tensor-descriptions"></a><span data-ttu-id="e8796-238">Descriptions des tenseur de tampon DirectML</span><span class="sxs-lookup"><span data-stu-id="e8796-238">DirectML buffer tensor descriptions</span></span>

<span data-ttu-id="e8796-239">DirectML peut fonctionner avec une grande variété de dispositions tenseur physiques, puisque la [structure **DML_BUFFER_TENSOR_DESC**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) a à la fois des `Sizes` `Strides` membres et.</span><span class="sxs-lookup"><span data-stu-id="e8796-239">DirectML can work with a variety of physical tensor layouts, since the [**DML_BUFFER_TENSOR_DESC** structure](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) has both `Sizes` and `Strides` members.</span></span> <span data-ttu-id="e8796-240">Certaines implémentations d’opérateur peuvent être plus efficaces avec une disposition spécifique. il n’est donc pas rare de modifier la façon dont les données tenseur sont stockées pour de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="e8796-240">Some operator implementations might be more efficient with a specific layout, so it's not uncommon to change how tensor data is stored for better performance.</span></span>

<span data-ttu-id="e8796-241">La plupart des opérateurs DirectML requièrent des dizaines 4D ou 5J, et l’ordre des valeurs de tailles et de Strides est fixe.</span><span class="sxs-lookup"><span data-stu-id="e8796-241">Most DirectML operators require either 4D or 5D tensors, and the order of the sizes and strides values is fixed.</span></span> <span data-ttu-id="e8796-242">En résolvant l’ordre des tailles et des valeurs Stride dans une description tenseur, il est possible pour DirectML de déduire différentes dispositions physiques.</span><span class="sxs-lookup"><span data-stu-id="e8796-242">By fixing the order of the sizes and stride values in a tensor description, it's possible for DirectML to infer different physical layouts.</span></span>

<span data-ttu-id="e8796-243">**4D**</span><span class="sxs-lookup"><span data-stu-id="e8796-243">**4D**</span></span>
- <span data-ttu-id="e8796-244">[**DML_BUFFER_TENSOR_DESC :: tailles**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) = {N-Size, C-Size, H-Size, W-Size}</span><span class="sxs-lookup"><span data-stu-id="e8796-244">[**DML_BUFFER_TENSOR_DESC::Sizes**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) = { N-size, C-size, H-size, W-size }</span></span>
- <span data-ttu-id="e8796-245">[**DML_BUFFER_TENSOR_DESC :: Strides**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) = {N-Stride, C-Stride, H-Stride, W-Stride}</span><span class="sxs-lookup"><span data-stu-id="e8796-245">[**DML_BUFFER_TENSOR_DESC::Strides**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) = { N-stride, C-stride, H-stride, W-stride }</span></span>

<span data-ttu-id="e8796-246">**5D**</span><span class="sxs-lookup"><span data-stu-id="e8796-246">**5D**</span></span>
- <span data-ttu-id="e8796-247">**DML_BUFFER_TENSOR_DESC :: tailles** = {N-Size, C-Size, D-size, H-Size, W-Size}</span><span class="sxs-lookup"><span data-stu-id="e8796-247">**DML_BUFFER_TENSOR_DESC::Sizes** = { N-size, C-size, D-size, H-size, W-size }</span></span>
- <span data-ttu-id="e8796-248">**DML_BUFFER_TENSOR_DESC :: Strides** = {N-Stride, C-Stride, D-Stride, H-Stride, W-Stride}</span><span class="sxs-lookup"><span data-stu-id="e8796-248">**DML_BUFFER_TENSOR_DESC::Strides** = { N-stride, C-stride, D-stride, H-stride, W-stride }</span></span>

<span data-ttu-id="e8796-249">Si un opérateur DirectML requiert un tenseur 4D ou un 5D, mais que les données réelles ont un rang inférieur (par exemple, 2D), les dimensions principales doivent être remplies avec 1.</span><span class="sxs-lookup"><span data-stu-id="e8796-249">If a DirectML operator requires a 4D or a 5D tensor, but the actual data has a smaller rank (for example, 2D), then the leading dimensions should be filled with 1s.</span></span> <span data-ttu-id="e8796-250">Par exemple, un tenseur « HW » est défini à l’aide de **DML_BUFFER_TENSOR_DESC :: Sizes** = {1, 1, H, W}.</span><span class="sxs-lookup"><span data-stu-id="e8796-250">For example, an "HW" tensor is set using **DML_BUFFER_TENSOR_DESC::Sizes** = { 1, 1, H, W }.</span></span>

<span data-ttu-id="e8796-251">Si les données tenseur sont stockées dans NCHW/NCDHW, il n’est pas nécessaire de définir **DML_BUFFER_TENSOR_DESC :: Strides**, sauf si vous souhaitez la diffusion ou le remplissage.</span><span class="sxs-lookup"><span data-stu-id="e8796-251">If tensor data is stored in NCHW/NCDHW, then it's not necessary to set **DML_BUFFER_TENSOR_DESC::Strides**, unless you want broadcasting or padding.</span></span> <span data-ttu-id="e8796-252">Vous pouvez définir le champ Strides sur `nullptr` .</span><span class="sxs-lookup"><span data-stu-id="e8796-252">You can set the strides field to `nullptr`.</span></span> <span data-ttu-id="e8796-253">Toutefois, si les données tenseur sont stockées dans une autre mise en page, par exemple NHWC, vous avez besoin de Strides afin d’exprimer la transformation de NCHW à cette disposition.</span><span class="sxs-lookup"><span data-stu-id="e8796-253">However, if the tensor data is stored in another layout, such as NHWC, then you need strides in order to express the transformation from NCHW to that layout.</span></span>

<span data-ttu-id="e8796-254">Pour obtenir un exemple simple, prenez en compte la description d’un tenseur 2D avec la hauteur 3 et la largeur 5.</span><span class="sxs-lookup"><span data-stu-id="e8796-254">For a simple example, consider the description of a 2D tensor with height 3 and width 5.</span></span>

<span data-ttu-id="e8796-255">**NCHW compressés (Strides implicites)**</span><span class="sxs-lookup"><span data-stu-id="e8796-255">**Packed NCHW (implicit strides)**</span></span>
- <span data-ttu-id="e8796-256">**DML_BUFFER_TENSOR_DESC :: tailles** = {1, 1, 3, 5}</span><span class="sxs-lookup"><span data-stu-id="e8796-256">**DML_BUFFER_TENSOR_DESC::Sizes** = { 1, 1, 3, 5 }</span></span>
- <span data-ttu-id="e8796-257">**DML_BUFFER_TENSOR_DESC :: Strides** = `nullptr`</span><span class="sxs-lookup"><span data-stu-id="e8796-257">**DML_BUFFER_TENSOR_DESC::Strides** = `nullptr`</span></span>

<span data-ttu-id="e8796-258">**NCHW compressés (Strides explicites)**</span><span class="sxs-lookup"><span data-stu-id="e8796-258">**Packed NCHW (explicit strides)**</span></span>
- <span data-ttu-id="e8796-259">N-Stride = C-Size \* H-Size \* W-size = 1 \* 3 \* 5 = 15</span><span class="sxs-lookup"><span data-stu-id="e8796-259">N-stride = C-size \* H-size \* W-size = 1 \* 3 \* 5 = 15</span></span>
- <span data-ttu-id="e8796-260">C-Stride = H-Size \* W-size = 3 \* 5 = 15</span><span class="sxs-lookup"><span data-stu-id="e8796-260">C-stride = H-size \* W-size = 3 \* 5 = 15</span></span>
- <span data-ttu-id="e8796-261">H-Stride = W-Size = 5</span><span class="sxs-lookup"><span data-stu-id="e8796-261">H-stride = W-size = 5</span></span>
- <span data-ttu-id="e8796-262">W-STRIDE = 1</span><span class="sxs-lookup"><span data-stu-id="e8796-262">W-stride = 1</span></span>
- <span data-ttu-id="e8796-263">**DML_BUFFER_TENSOR_DESC :: tailles** = {1, 1, 3, 5}</span><span class="sxs-lookup"><span data-stu-id="e8796-263">**DML_BUFFER_TENSOR_DESC::Sizes** = { 1, 1, 3, 5 }</span></span>
- <span data-ttu-id="e8796-264">**DML_BUFFER_TENSOR_DESC :: Strides** = {15, 15, 5, 1}</span><span class="sxs-lookup"><span data-stu-id="e8796-264">**DML_BUFFER_TENSOR_DESC::Strides** = { 15, 15, 5, 1 }</span></span>

<span data-ttu-id="e8796-265">**NHWC condensé**</span><span class="sxs-lookup"><span data-stu-id="e8796-265">**Packed NHWC**</span></span>
- <span data-ttu-id="e8796-266">N-Stride = H-Size \* W-SIZE \* C-size = 3 \* 5 \* 1 = 15</span><span class="sxs-lookup"><span data-stu-id="e8796-266">N-stride = H-size \* W-size \* C-size = 3 \* 5 \* 1 = 15</span></span>
- <span data-ttu-id="e8796-267">H-Stride = W-SIZE \* C-Size = 5 \* 1 = 5</span><span class="sxs-lookup"><span data-stu-id="e8796-267">H-stride = W-size \* C-size = 5 \* 1 = 5</span></span>
- <span data-ttu-id="e8796-268">W-Stride = C-size = 1</span><span class="sxs-lookup"><span data-stu-id="e8796-268">W-stride = C-size = 1</span></span>
- <span data-ttu-id="e8796-269">C-STRIDE = 1</span><span class="sxs-lookup"><span data-stu-id="e8796-269">C-stride = 1</span></span>
- <span data-ttu-id="e8796-270">**DML_BUFFER_TENSOR_DESC :: tailles** = {1, 1, 3, 5}</span><span class="sxs-lookup"><span data-stu-id="e8796-270">**DML_BUFFER_TENSOR_DESC::Sizes** = { 1, 1, 3, 5 }</span></span>
- <span data-ttu-id="e8796-271">**DML_BUFFER_TENSOR_DESC :: Strides** = {15, 1, 5, 1}</span><span class="sxs-lookup"><span data-stu-id="e8796-271">**DML_BUFFER_TENSOR_DESC::Strides** = { 15, 1, 5, 1 }</span></span>

## <a name="see-also"></a><span data-ttu-id="e8796-272">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e8796-272">See also</span></span>

* [<span data-ttu-id="e8796-273">Fonctions d’assistance DirectML</span><span class="sxs-lookup"><span data-stu-id="e8796-273">DirectML helper functions</span></span>](dml-helper-functions.md)
* [<span data-ttu-id="e8796-274">Structure DML_BUFFER_TENSOR_DESC</span><span class="sxs-lookup"><span data-stu-id="e8796-274">DML_BUFFER_TENSOR_DESC structure</span></span>](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc)
