---
title: Alias de mémoire et héritage de données
description: Les ressources placées et réservées peuvent avoir un alias de la mémoire physique dans un segment. Les ressources passées activent davantage de scénarios d’héritage de données que les ressources réservées lorsque l’indicateur partagé est défini pour le tas ou lorsque les ressources avec alias ont des dispositions de mémoire entièrement définies.
ms.assetid: 53C5804B-0F81-41AF-83D2-A96DCDFDC94A
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cace5b5997e2a460406ae72abb247224886f3926
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "74104041"
---
# <a name="memory-aliasing-and-data-inheritance"></a><span data-ttu-id="00ac1-104">Alias de mémoire et héritage de données</span><span class="sxs-lookup"><span data-stu-id="00ac1-104">Memory Aliasing and Data Inheritance</span></span>

<span data-ttu-id="00ac1-105">Les ressources placées et réservées peuvent avoir un alias de la mémoire physique dans un segment.</span><span class="sxs-lookup"><span data-stu-id="00ac1-105">Placed and reserved resource may alias physical memory within a heap.</span></span> <span data-ttu-id="00ac1-106">Les ressources passées activent davantage de scénarios d’héritage de données que les ressources réservées lorsque l’indicateur partagé est défini pour le tas ou lorsque les ressources avec alias ont des dispositions de mémoire entièrement définies.</span><span class="sxs-lookup"><span data-stu-id="00ac1-106">Placed resources enable more data inheritance scenarios than reserved resources when the heap has the shared flag set or when the aliased resources have fully defined memory layouts.</span></span>

-   [<span data-ttu-id="00ac1-107">Alias</span><span class="sxs-lookup"><span data-stu-id="00ac1-107">Aliasing</span></span>](#memory-aliasing-and-data-inheritance)
-   [<span data-ttu-id="00ac1-108">Héritage de données</span><span class="sxs-lookup"><span data-stu-id="00ac1-108">Data Inheritance</span></span>](#data-inheritance)
-   [<span data-ttu-id="00ac1-109">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="00ac1-109">Related topics</span></span>](#related-topics)

## <a name="aliasing"></a><span data-ttu-id="00ac1-110">Alias</span><span class="sxs-lookup"><span data-stu-id="00ac1-110">Aliasing</span></span>

<span data-ttu-id="00ac1-111">Une barrière d’alias doit être émise entre l’utilisation de deux ressources qui partagent la même mémoire physique, même si l’héritage des données n’est pas souhaité.</span><span class="sxs-lookup"><span data-stu-id="00ac1-111">An aliasing barrier must be issued between the usage of two resources that share the same physical memory, even if data inheritance is not desired.</span></span> <span data-ttu-id="00ac1-112">Les modèles d’utilisation simples doivent désigner au moins la ressource de destination impliquée dans une telle opération.</span><span class="sxs-lookup"><span data-stu-id="00ac1-112">Simple usage models must denote, at least, the destination resource involved in such an operation.</span></span> <span data-ttu-id="00ac1-113">Pour plus d’informations et pour obtenir des modèles d’utilisation avancée, consultez [**CreatePlacedResource**](/windows/desktop/api/d3d12/nf-d3d12-id3d12device-createplacedresource) .</span><span class="sxs-lookup"><span data-stu-id="00ac1-113">See [**CreatePlacedResource**](/windows/desktop/api/d3d12/nf-d3d12-id3d12device-createplacedresource) for more details and advanced usage models.</span></span>

<span data-ttu-id="00ac1-114">Après l’accès à une ressource, toutes les ressources qui partagent la mémoire physique avec cette ressource deviennent invalidées, sauf si l’héritage des données est autorisé.</span><span class="sxs-lookup"><span data-stu-id="00ac1-114">After a resource is accessed, any resources which share physical memory with that resource become invalidated, unless data inheritance is allowed to occur.</span></span> <span data-ttu-id="00ac1-115">Les lectures de ressources invalidées entraînent un contenu de ressource non défini.</span><span class="sxs-lookup"><span data-stu-id="00ac1-115">Reads of invalidated resources result in undefined resource contents.</span></span> <span data-ttu-id="00ac1-116">Les écritures dans les ressources invalidées entraînent également un contenu de ressource non défini, à moins que deux conditions ne se produisent :</span><span class="sxs-lookup"><span data-stu-id="00ac1-116">Writes to invalidated resources also result in undefined resource contents, unless two conditions occur:</span></span>

-   <span data-ttu-id="00ac1-117">La ressource ne dispose pas de l’indicateur de \_ ressource D3D12 \_ autoriser le \_ \_ rendu cible ou de l’indicateur de \_ \_ ressource D3D12 autoriser le stencil de \_ \_ \_ profondeur \_ .</span><span class="sxs-lookup"><span data-stu-id="00ac1-117">The resource does not have either the D3D12\_RESOURCE\_FLAG\_ALLOW\_RENDER\_TARGET or D3D12\_RESOURCE\_FLAG\_ALLOW\_DEPTH\_STENCIL.</span></span>
-   <span data-ttu-id="00ac1-118">L’écriture est une opération de copie ou d’effacement d’une sous-ressource ou d’une vignette entière.</span><span class="sxs-lookup"><span data-stu-id="00ac1-118">The write is a copy or clear operation to an entire subresource or tile.</span></span> <span data-ttu-id="00ac1-119">L’initialisation des vignettes est uniquement disponible pour les ressources avec des SWIZZLE de 64 Ko non \_ \_ définis \_ et des SWIZZLE standard de la mosaïque de 64 Ko \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="00ac1-119">Tile-initialization is only available for resources with 64KB\_TILE\_UNDEFINED\_SWIZZLE and 64KB\_TILE\_STANDARD\_SWIZZLE.</span></span>

<span data-ttu-id="00ac1-120">Les invalidations qui se chevauchent sont limitées à des granularité plus petites, lorsque les dispositions fournissent des informations sur l’emplacement des données de Texel et lorsque les ressources se trouvent dans certains États de barrière de transition.</span><span class="sxs-lookup"><span data-stu-id="00ac1-120">Overlapping invalidations are scoped to smaller granularities, when layouts provide information on the location on the location of texel data and when resources are in certain transition barrier states.</span></span> <span data-ttu-id="00ac1-121">Toutefois, les invalidations ne peuvent pas être plus petites que les granularité d’alignement des ressources.</span><span class="sxs-lookup"><span data-stu-id="00ac1-121">But, invalidations cannot go any smaller than resource alignment granularities.</span></span>

<span data-ttu-id="00ac1-122">Une granularité de l’alignement de la mémoire tampon est de 64 Ko, et la granularité d’alignement supérieure est prioritaire.</span><span class="sxs-lookup"><span data-stu-id="00ac1-122">A buffer alignment granularity is 64KB, and larger alignment granularity takes precedence.</span></span> <span data-ttu-id="00ac1-123">Cela est important lorsque vous envisagez des textures de 4 Ko, car il peut se trouver dans une région de 64 Ko.</span><span class="sxs-lookup"><span data-stu-id="00ac1-123">This is important when considering 4KB textures, as multiple 4KB textures can reside in a 64KB region without overlapping each other.</span></span> <span data-ttu-id="00ac1-124">Toutefois, un alias de mémoire tampon de la même région 64 Ko ne peut pas être utilisé conjointement avec ces textures de 4 Ko.</span><span class="sxs-lookup"><span data-stu-id="00ac1-124">But, a buffer aliasing the same 64KB region cannot be used in conjunction with any of those 4KB textures.</span></span> <span data-ttu-id="00ac1-125">L’application ne peut pas empêcher de manière fiable l’accès à la mémoire tampon d’intersecter les textures de 4 Ko, car les GPU sont autorisés à Swizzle 4 Ko de données de texture au sein de la région de 64Ko dans un modèle non défini.</span><span class="sxs-lookup"><span data-stu-id="00ac1-125">The application cannot reliably keep the access to the buffer from intersecting the 4KB textures, as GPUs are allowed to swizzle 4KB texture data within the 64KB region in an undefined pattern.</span></span>

<span data-ttu-id="00ac1-126">\_ \_ \_ les mises en page de texture principale SWIZZLE de 64 Ko non définies, 64 Ko de \_ mosaïque \_ standard \_ SWIZZLE et de ligne \_ principale informent l’application que les granularité d’alignement qui se chevauchent ne sont plus valides.</span><span class="sxs-lookup"><span data-stu-id="00ac1-126">64KB\_TILE\_UNDEFINED\_SWIZZLE, 64KB\_TILE\_STANDARD\_SWIZZLE, and ROW\_MAJOR texture layouts inform the application which overlapping alignment granularities have become invalid.</span></span> <span data-ttu-id="00ac1-127">Par exemple : une application peut créer un tableau de texture de cible de rendu 2D avec 2 tranches de tableau, un niveau MIP unique et une \_ \_ disposition SWIZZLE non définie de mosaïque de 64 Ko \_ .</span><span class="sxs-lookup"><span data-stu-id="00ac1-127">For example: An application can create a 2D render target texture array with 2 array slices, a single mip level, and the 64KB\_TILE\_UNDEFINED\_SWIZZLE layout.</span></span> <span data-ttu-id="00ac1-128">Supposons que l’application comprend que chaque tranche de groupe occupe 100 mosaïques de 64 Ko.</span><span class="sxs-lookup"><span data-stu-id="00ac1-128">Assume the application understands each array slice occupies 100 64KB tiles.</span></span> <span data-ttu-id="00ac1-129">L’application peut renoncer à utiliser la tranche de tableau 0 et réutiliser cette mémoire pour une mémoire tampon d’une valeur de 6 Mo, une texture de ~ 6 Mo avec une disposition non définie, etc. Pour aller plus loin, supposez que l’application n’a plus besoin de la première vignette de la tranche de tableau 1.</span><span class="sxs-lookup"><span data-stu-id="00ac1-129">The application can forgo using array slice 0, and re-use that memory for either a ~6MB buffer, a ~6MB texture with undefined layout, etc. Going further, assume the application no longer required the first tile of array slice 1.</span></span> <span data-ttu-id="00ac1-130">Ensuite, l’application peut également localiser une mémoire tampon de 64 Ko jusqu’à ce que le rendu nécessite à nouveau la première vignette de la tranche de tableau 1.</span><span class="sxs-lookup"><span data-stu-id="00ac1-130">Then, the application could also locate a 64KB buffer there until rendering would again require the first tile of array slice 1.</span></span> <span data-ttu-id="00ac1-131">L’application doit effectuer une suppression de vignette complète ou une copie pour réutiliser la première vignette avec le tableau de texture.</span><span class="sxs-lookup"><span data-stu-id="00ac1-131">The application would have to do a full tile clear or copy in order to re-use the first tile with the texture array again.</span></span>

<span data-ttu-id="00ac1-132">Toutefois, même les textures avec des dispositions définies comportent toujours des cas problématiques.</span><span class="sxs-lookup"><span data-stu-id="00ac1-132">However, even textures with defined layouts still have problematic cases.</span></span> <span data-ttu-id="00ac1-133">Les tailles des ressources de texture peuvent varier considérablement par rapport à ce que l’application peut calculer elle-même, car certaines architectures d’adaptateur allouent de la mémoire supplémentaire pour les textures afin de réduire la bande passante effective pendant les scénarios de rendu courants.</span><span class="sxs-lookup"><span data-stu-id="00ac1-133">Texture resource sizes can significantly differ from what the application can calculate itself, because some adapter architectures allocate extra memory for textures to reduce the effective bandwidth during common rendering scenarios.</span></span> <span data-ttu-id="00ac1-134">Les invalidations dans cette région de mémoire supplémentaire entraînent l’invalidation de la ressource entière.</span><span class="sxs-lookup"><span data-stu-id="00ac1-134">Any invalidations into that extra memory region cause the entire resource to become invalidated.</span></span> <span data-ttu-id="00ac1-135">Pour plus d’informations, consultez [**GetResourceAllocationInfo**](/windows/desktop/api/d3d12/nf-d3d12-id3d12device-getresourceallocationinfo) .</span><span class="sxs-lookup"><span data-stu-id="00ac1-135">See [**GetResourceAllocationInfo**](/windows/desktop/api/d3d12/nf-d3d12-id3d12device-getresourceallocationinfo) for more details.</span></span>

## <a name="data-inheritance"></a><span data-ttu-id="00ac1-136">Héritage de données</span><span class="sxs-lookup"><span data-stu-id="00ac1-136">Data Inheritance</span></span>

<span data-ttu-id="00ac1-137">Les ressources passées activent le plus d’héritage de données pour les textures, même avec des dispositions de mémoire non définies.</span><span class="sxs-lookup"><span data-stu-id="00ac1-137">Placed resources enable the most data inheritance for textures, even with undefined memory layouts.</span></span> <span data-ttu-id="00ac1-138">Les applications peuvent imiter les fonctionnalités d’héritage de données que les ressources validées partagées activent en localisant deux textures avec des propriétés de ressource identiques au même décalage dans un tas partagé.</span><span class="sxs-lookup"><span data-stu-id="00ac1-138">Applications can mimic the data inheritance capabilities that shared committed resources enable by locating two textures with identical resource properties at the same offset in a shared heap.</span></span> <span data-ttu-id="00ac1-139">L’intégralité de la description de la ressource doit être identique, y compris la valeur Clear optimisée et le type de la méthode de création de ressource (placée ou réservée).</span><span class="sxs-lookup"><span data-stu-id="00ac1-139">The entire resource description must be identical, including the optimized clear value and type of resource creation method (placed or reserved).</span></span> <span data-ttu-id="00ac1-140">Toutefois, les deux ressources peuvent avoir des États de cloisonnement de transition initiaux différents.</span><span class="sxs-lookup"><span data-stu-id="00ac1-140">But, both resources may have had different initial transition barrier states.</span></span>

<span data-ttu-id="00ac1-141">Les ressources réservées permettent l’héritage des données par mosaïque ; mais des restrictions existent couramment pour les États de barrière de transition de ressource.</span><span class="sxs-lookup"><span data-stu-id="00ac1-141">Reserved resources enable per-tile data inheritance; but restrictions commonly exist for resource transition barrier states.</span></span>

<span data-ttu-id="00ac1-142">Pour hériter des données, les deux ressources doivent se trouver dans un état de barrière de transition de ressource compatible :</span><span class="sxs-lookup"><span data-stu-id="00ac1-142">To inherit data, both resources must be in a compatible resource transition barrier state:</span></span>

-   <span data-ttu-id="00ac1-143">Pour les mémoires tampons, les textures d’accès simultanées et les textures entre les adaptateurs, l’état de transition des ressources n’est pas important et tous les États sont « compatibles ».</span><span class="sxs-lookup"><span data-stu-id="00ac1-143">For buffers, simultaneous access textures, and cross-adapter textures, the resource transition state is not important and all states are “compatible”.</span></span>
-   <span data-ttu-id="00ac1-144">Pour les textures réservées sans les propriétés précédentes ou pour l’héritage des données par mosaïque par le biais de la mosaïque 64 Ko \_ \_ non définie \_ SWIZZLE ou 64 Ko \_ de la mosaïque \_ standard \_ SWIZZLE, l’état de la barrière de transition des ressources incluant la vignette doit être dans l’État commun.</span><span class="sxs-lookup"><span data-stu-id="00ac1-144">For reserved textures without the previous properties or other per-tile data inheritance through 64KB\_TILE\_UNDEFINED\_SWIZZLE or 64KB\_TILE\_STANDARD\_SWIZZLE, the resource transition barrier state including the tile must be in the common state.</span></span>
-   <span data-ttu-id="00ac1-145">Pour toutes les autres textures, où les descriptions des ressources correspondent exactement, l’état de la barrière de transition des ressources pour chaque paire de sous-ressources correspondante doit :</span><span class="sxs-lookup"><span data-stu-id="00ac1-145">For all other textures, where the resource descriptions match exactly, the resource transition barrier state for each corresponding pair of subresources must:</span></span>
    -   <span data-ttu-id="00ac1-146">Être dans l’État commun.</span><span class="sxs-lookup"><span data-stu-id="00ac1-146">Be in the common state.</span></span>
    -   <span data-ttu-id="00ac1-147">Être égal lorsque l’État a le même indicateur GPU-Write.</span><span class="sxs-lookup"><span data-stu-id="00ac1-147">Be equal when the state has the same GPU-write flag in them.</span></span>

<span data-ttu-id="00ac1-148">Lorsque le GPU prend en charge les Swizzle standard, les mémoires tampons et les textures Swizzle standard peuvent être affectées de la même mémoire et hériter de données.</span><span class="sxs-lookup"><span data-stu-id="00ac1-148">When the GPU supports standard swizzle, buffers and standard swizzle textures may be aliased to the same memory and inherit data between them.</span></span> <span data-ttu-id="00ac1-149">L’application peut manipuler des texels à partir de la représentation de la mémoire tampon, car le modèle Swizzle standard décrit comment les texels sont disposés en mémoire.</span><span class="sxs-lookup"><span data-stu-id="00ac1-149">The application can manipulate texels from the buffer representation, because the standard swizzle pattern describes how texels are laid out in memory.</span></span> <span data-ttu-id="00ac1-150">Le modèle de Swizzle visible par le processeur est équivalent au modèle de Swizzle visible par le GPU vu dans les tampons.</span><span class="sxs-lookup"><span data-stu-id="00ac1-150">The CPU-visible swizzle pattern is equivalent to the GPU-visible swizzle pattern seen in buffers.</span></span>

## <a name="related-topics"></a><span data-ttu-id="00ac1-151">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="00ac1-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="00ac1-152">Sous-allocation au sein des tas</span><span class="sxs-lookup"><span data-stu-id="00ac1-152">Suballocation Within Heaps</span></span>](suballocation-within-heaps.md)
</dt> </dl>

 

 




