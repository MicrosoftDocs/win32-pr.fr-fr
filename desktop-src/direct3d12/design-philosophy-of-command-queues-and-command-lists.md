---
title: Philosophie de conception des files d’attente de commandes et des listes de commandes
description: Les objectifs de la réutilisation du travail de rendu et de la mise à l’échelle multithread requièrent des modifications fondamentales à la façon dont les applications Direct3D soumettent le rendu du travail au GPU.
ms.assetid: C85C8C41-2306-4568-8FAE-F57EDA624298
keywords:
- Liste des commandes
- bundle
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 812275a630464dbe9137d587a672803f4d0c72f9
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "74104901"
---
# <a name="design-philosophy-of-command-queues-and-command-lists"></a><span data-ttu-id="f6f10-105">Philosophie de conception des files d’attente de commandes et des listes de commandes</span><span class="sxs-lookup"><span data-stu-id="f6f10-105">Design Philosophy of Command Queues and Command Lists</span></span>

<span data-ttu-id="f6f10-106">Les objectifs de la réutilisation du travail de rendu et de la mise à l’échelle multithread requièrent des modifications fondamentales à la façon dont les applications Direct3D soumettent le rendu du travail au GPU.</span><span class="sxs-lookup"><span data-stu-id="f6f10-106">The goals of enabling reuse of rendering work and of multi-threaded scaling, required fundamental changes to how Direct3D apps submit rendering work to the GPU.</span></span> <span data-ttu-id="f6f10-107">Dans Direct3D 12, le processus d’envoi du travail de rendu diffère des versions antérieures de trois façons importantes :</span><span class="sxs-lookup"><span data-stu-id="f6f10-107">In Direct3D 12, the process of submitting rendering work differs from earlier versions in three important ways:</span></span>

<dl> 1. <span data-ttu-id="f6f10-108">Élimination du contexte immédiat.</span><span class="sxs-lookup"><span data-stu-id="f6f10-108">Elimination of the immediate context.</span></span> <span data-ttu-id="f6f10-109">Cela permet l’activation de plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="f6f10-109">This enables multi-threading.</span></span>  
2. <span data-ttu-id="f6f10-110">Les applications possèdent désormais la manière dont les appels de rendu sont regroupés dans les éléments de travail de l’unité de traitement graphique (GPU).</span><span class="sxs-lookup"><span data-stu-id="f6f10-110">Apps now own how rendering calls are grouped into graphics processing unit (GPU) work items.</span></span> <span data-ttu-id="f6f10-111">Cela permet la réutilisation.</span><span class="sxs-lookup"><span data-stu-id="f6f10-111">This enables re-use.</span></span>  
3. <span data-ttu-id="f6f10-112">Les applications contrôlent désormais explicitement le moment où le travail est soumis au GPU.</span><span class="sxs-lookup"><span data-stu-id="f6f10-112">Apps now explicitly control when work is submitted to the GPU .</span></span> <span data-ttu-id="f6f10-113">Cela permet d’activer les éléments 1 et 2.</span><span class="sxs-lookup"><span data-stu-id="f6f10-113">This enables items 1 and 2.</span></span>  
</dl>

-   [<span data-ttu-id="f6f10-114">Suppression du contexte immédiat</span><span class="sxs-lookup"><span data-stu-id="f6f10-114">Removal of the immediate context</span></span>](#removal-of-the-immediate-context)
-   [<span data-ttu-id="f6f10-115">Regroupement d’éléments de travail GPU</span><span class="sxs-lookup"><span data-stu-id="f6f10-115">Grouping of GPU work items</span></span>](#grouping-of-gpu-work-items)
-   [<span data-ttu-id="f6f10-116">Envoi de travail GPU</span><span class="sxs-lookup"><span data-stu-id="f6f10-116">GPU work submission</span></span>](#gpu-work-submission)
-   [<span data-ttu-id="f6f10-117">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f6f10-117">Related topics</span></span>](#related-topics)

## <a name="removal-of-the-immediate-context"></a><span data-ttu-id="f6f10-118">Suppression du contexte immédiat</span><span class="sxs-lookup"><span data-stu-id="f6f10-118">Removal of the immediate context</span></span>

<span data-ttu-id="f6f10-119">La plus grande modification entre Microsoft Direct3D 11 et Microsoft Direct3D 12 est qu’il n’y a plus de contexte unique et immédiat associé à un appareil.</span><span class="sxs-lookup"><span data-stu-id="f6f10-119">The largest change from Microsoft Direct3D 11 to Microsoft Direct3D 12 is that there is no longer a single, immediate context associated with a device.</span></span> <span data-ttu-id="f6f10-120">Au lieu de cela, pour le rendu, les applications créent des listes de commandes dans lesquelles les API de rendu traditionnelles peuvent être appelées.</span><span class="sxs-lookup"><span data-stu-id="f6f10-120">Instead, to render, apps create command lists in which traditional rendering APIs can be called.</span></span> <span data-ttu-id="f6f10-121">Une liste de commandes ressemble à la méthode Render d’une application Direct3D 11 qui utilisait le contexte immédiat, car elle contient des appels qui dessinent des primitives ou modifient l’état de rendu.</span><span class="sxs-lookup"><span data-stu-id="f6f10-121">A command list looks similar to the render method of a Direct3D 11 app that used the immediate context in that it contains calls that draw primitives or change the rendering state.</span></span> <span data-ttu-id="f6f10-122">À l’instar des contextes immédiats, chaque liste de commandes n’est pas à thread libre ; Toutefois, plusieurs listes de commandes peuvent être enregistrées simultanément, ce qui tire parti des processeurs multicœurs modernes.</span><span class="sxs-lookup"><span data-stu-id="f6f10-122">Like immediate contexts, each command list is not free-threaded; however, multiple command lists can be recorded concurrently, which takes advantage of modern, multi-core processors.</span></span>

<span data-ttu-id="f6f10-123">Les listes de commandes sont généralement exécutées une seule fois.</span><span class="sxs-lookup"><span data-stu-id="f6f10-123">Command lists are typically executed once.</span></span> <span data-ttu-id="f6f10-124">Toutefois, une liste de commandes peut être exécutée plusieurs fois si l’application s’assure que les exécutions précédentes sont terminées avant d’envoyer de nouvelles exécutions.</span><span class="sxs-lookup"><span data-stu-id="f6f10-124">However, a command list can be executed multiple times if the application ensures that the previous executions are complete before submitting new executions.</span></span> <span data-ttu-id="f6f10-125">Pour plus d’informations sur la synchronisation de la liste de commandes, consultez [exécution et synchronisation de listes de commandes](executing-and-synchronizing-command-lists.md).</span><span class="sxs-lookup"><span data-stu-id="f6f10-125">For more information about command list synchronization, see [Executing and synchronizing command lists](executing-and-synchronizing-command-lists.md).</span></span>

## <a name="grouping-of-gpu-work-items"></a><span data-ttu-id="f6f10-126">Regroupement d’éléments de travail GPU</span><span class="sxs-lookup"><span data-stu-id="f6f10-126">Grouping of GPU work items</span></span>

<span data-ttu-id="f6f10-127">En plus des listes de commandes, Direct3D 12 tire parti des fonctionnalités présentes dans tout le matériel dès aujourd’hui en ajoutant un second niveau de listes de commandes, appelées « *bottes*».</span><span class="sxs-lookup"><span data-stu-id="f6f10-127">In addition to command lists, Direct3D 12 takes advantage of functionality present in all hardware today by adding a second level of command lists, which are called *bundles*.</span></span> <span data-ttu-id="f6f10-128">Pour vous aider à distinguer ces deux types, les listes de commandes de premier niveau peuvent être appelées *listes de commandes directes*.</span><span class="sxs-lookup"><span data-stu-id="f6f10-128">To help to distinguish these two types, the first-level command lists can be referred to as *direct command lists*.</span></span> <span data-ttu-id="f6f10-129">L’objectif des offres groupées est de permettre aux applications de regrouper un petit nombre de commandes API pour une exécution ultérieure et répétée à partir de listes de commandes directes.</span><span class="sxs-lookup"><span data-stu-id="f6f10-129">The purpose of bundles is to allow apps to group a small number of API commands together for later, repeated execution from within direct command lists.</span></span> <span data-ttu-id="f6f10-130">Au moment de la création d’un bundle, le pilote effectue le plus grand traitement possible pour une exécution ultérieure.</span><span class="sxs-lookup"><span data-stu-id="f6f10-130">At the time of creating a bundle, the driver will perform as much pre-processing as possible to make later execution efficient.</span></span> <span data-ttu-id="f6f10-131">Les lots peuvent ensuite être exécutés à partir de plusieurs listes de commandes et plusieurs fois dans la même liste de commandes.</span><span class="sxs-lookup"><span data-stu-id="f6f10-131">Bundles can then be executed from within multiple command lists and multiple times within the same command list.</span></span>

<span data-ttu-id="f6f10-132">La réutilisation des offres groupées est un gros pilote d’efficacité améliorée avec les threads d’UC uniques.</span><span class="sxs-lookup"><span data-stu-id="f6f10-132">The re-use of bundles is a large driver of improved efficiency with single CPU threads.</span></span> <span data-ttu-id="f6f10-133">Étant donné que les offres groupées sont prétraitées et peuvent être envoyées plusieurs fois, il existe certaines restrictions sur les opérations pouvant être effectuées au sein d’un regroupement.</span><span class="sxs-lookup"><span data-stu-id="f6f10-133">Because bundles are pre-processed and can be submitted multiple times, there are certain restrictions on what operations can be performed within a bundle.</span></span> <span data-ttu-id="f6f10-134">Pour plus d’informations, consultez [création et enregistrement des listes de commandes et des offres groupées](recording-command-lists-and-bundles.md).</span><span class="sxs-lookup"><span data-stu-id="f6f10-134">For more information, see [Creating and recording command lists and bundles](recording-command-lists-and-bundles.md).</span></span>

## <a name="gpu-work-submission"></a><span data-ttu-id="f6f10-135">Envoi de travail GPU</span><span class="sxs-lookup"><span data-stu-id="f6f10-135">GPU work submission</span></span>

<span data-ttu-id="f6f10-136">Pour exécuter le travail sur le GPU, une application doit envoyer explicitement une liste de commandes à une file d’attente de commandes associée à l’appareil Direct3D.</span><span class="sxs-lookup"><span data-stu-id="f6f10-136">To execute work on the GPU, an app must explicitly submit a command list to a command queue associated with the Direct3D device.</span></span> <span data-ttu-id="f6f10-137">Une liste de commandes directe peut être soumise à plusieurs reprises pour exécution, mais l’application est chargée de s’assurer que la liste de commandes directe a fini de s’exécuter sur le GPU avant de la soumettre à nouveau.</span><span class="sxs-lookup"><span data-stu-id="f6f10-137">A direct command list can be submitted for execution multiple times, but the app is responsible for ensuring that the direct command list has finished executing on the GPU before submitting it again.</span></span> <span data-ttu-id="f6f10-138">Les offres groupées n’ont pas de restrictions d’utilisation simultanée et peuvent être exécutées plusieurs fois dans plusieurs listes de commandes, mais elles ne peuvent pas être envoyées directement à une file d’attente de commandes en vue de leur exécution.</span><span class="sxs-lookup"><span data-stu-id="f6f10-138">Bundles have no concurrent-use restrictions and can be executed multiple times in multiple command lists, but bundles cannot be directly submitted to a command queue for execution.</span></span>

<span data-ttu-id="f6f10-139">Tout thread peut envoyer une liste de commandes à n’importe quelle file d’attente de commandes à tout moment, et le runtime sérialise automatiquement la soumission de la liste de commandes dans la file d’attente de commandes tout en préservant l’ordre d’envoi.</span><span class="sxs-lookup"><span data-stu-id="f6f10-139">Any thread may submit a command list to any command queue at any time, and the runtime will automatically serialize submission of the command list in the command queue while preserving the submission order.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f6f10-140">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f6f10-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f6f10-141">Envoi de travail dans Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="f6f10-141">Work Submission in Direct3D 12</span></span>](command-queues-and-command-lists.md)
</dt> </dl>

 

 




