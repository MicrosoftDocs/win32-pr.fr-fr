---
description: Couches d’API (Direct3D 10)
ms.assetid: 19c81383-6ac7-49ea-98a3-bf761a32ab40
title: Couches d’API (Direct3D 10)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8b07b33dfd8280af13ea3df74e5e6d0fd040bb2c
ms.sourcegitcommit: ca37395fd832e798375e81142b97cffcffabf184
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/24/2021
ms.locfileid: "110335413"
---
# <a name="api-layers-direct3d-10"></a><span data-ttu-id="f9c85-103">Couches d’API (Direct3D 10)</span><span class="sxs-lookup"><span data-stu-id="f9c85-103">API Layers (Direct3D 10)</span></span>

<span data-ttu-id="f9c85-104">Le runtime Direct3D 10 est construit avec des couches, en commençant par les fonctionnalités de base au cœur et en créant des fonctionnalités facultatives et d’assistance aux développeurs dans les couches externes.</span><span class="sxs-lookup"><span data-stu-id="f9c85-104">The Direct3D 10 runtime is constructed with layers, starting with the basic functionality at the core and building optional and developer-assist functionality in outer layers.</span></span>

## <a name="core-layer"></a><span data-ttu-id="f9c85-105">Couche principale</span><span class="sxs-lookup"><span data-stu-id="f9c85-105">Core Layer</span></span>

<span data-ttu-id="f9c85-106">La couche de base existe par défaut ; en fournissant un mappage très étroit entre l’API et le pilote de périphérique, ce qui minimise la surcharge des appels haute fréquence.</span><span class="sxs-lookup"><span data-stu-id="f9c85-106">The core layer exists by default; providing a very thin mapping between the API and the device driver, minimizing overhead for high-frequency calls.</span></span> <span data-ttu-id="f9c85-107">Étant donné que la couche de base est essentielle pour les performances, elle effectue uniquement une validation critique.</span><span class="sxs-lookup"><span data-stu-id="f9c85-107">As the core layer is essential for performance, it only performs critical validation.</span></span>

<span data-ttu-id="f9c85-108">Les couches restantes sont facultatives.</span><span class="sxs-lookup"><span data-stu-id="f9c85-108">The remaining layers are optional.</span></span> <span data-ttu-id="f9c85-109">En règle générale, les couches ajoutent des fonctionnalités, mais ne modifient pas le comportement existant.</span><span class="sxs-lookup"><span data-stu-id="f9c85-109">As a general rule, layers add functionality, but do not modify existing behavior.</span></span> <span data-ttu-id="f9c85-110">Par exemple, les fonctions de base auront les mêmes valeurs de retour que celles de la couche de débogage en cours d’instanciation, bien qu’une sortie de débogage supplémentaire puisse être fournie si la couche de débogage est instanciée.</span><span class="sxs-lookup"><span data-stu-id="f9c85-110">For example, core functions will have the same return values independent of the debug layer being instantiated, although additional debug output may be provided if the debug layer is instantiated.</span></span>

<span data-ttu-id="f9c85-111">Créez des couches quand un appareil est créé en appelant [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice) et en fournissant une ou plusieurs valeurs d’indicateur de création de l' [**\_ \_ appareil \_ D3D10**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_create_device_flag) .</span><span class="sxs-lookup"><span data-stu-id="f9c85-111">Create layers when a device is created by calling [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice) and supplying one or more [**D3D10\_CREATE\_DEVICE\_FLAG**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_create_device_flag) values.</span></span>

## <a name="debug-layer"></a><span data-ttu-id="f9c85-112">Couche de débogage</span><span class="sxs-lookup"><span data-stu-id="f9c85-112">Debug Layer</span></span>

<span data-ttu-id="f9c85-113">La couche de débogage fournit une validation de paramètres et de cohérence étendues supplémentaires (par exemple, la validation de la liaison de nuanceur et la liaison de ressources, la validation de la cohérence des paramètres et la création de rapports sur les erreurs).</span><span class="sxs-lookup"><span data-stu-id="f9c85-113">The debug layer provides extensive additional parameter and consistency validation (such as validating shader linkage and resource binding, validating parameter consistency, and reporting error descriptions).</span></span> <span data-ttu-id="f9c85-114">La sortie générée par la couche de débogage se compose d’une file d’attente de chaînes qui sont accessibles à l’aide de l' [**interface ID3D10InfoQueue**](/windows/desktop/api/D3D10SDKLayers/nn-d3d10sdklayers-id3d10infoqueue) (consultez [personnaliser la sortie de débogage avec ID3D10InfoQueue (Direct3D 10)](d3d10-graphics-programming-guide-api-features-layers-info-queue.md)).</span><span class="sxs-lookup"><span data-stu-id="f9c85-114">The output generated by the debug layer consists of a queue of strings which are accessible using the [**ID3D10InfoQueue Interface**](/windows/desktop/api/D3D10SDKLayers/nn-d3d10sdklayers-id3d10infoqueue) (see [Customize Debug Output with ID3D10InfoQueue (Direct3D 10)](d3d10-graphics-programming-guide-api-features-layers-info-queue.md)).</span></span> <span data-ttu-id="f9c85-115">Les erreurs générées par la couche de base sont mises en surbrillance avec des avertissements par la couche de débogage.</span><span class="sxs-lookup"><span data-stu-id="f9c85-115">Errors generated by the core layer are highlighted with warnings by the debug layer.</span></span>

<span data-ttu-id="f9c85-116">Pour créer un appareil qui prend en charge la couche de débogage, vous devez installer le kit de développement logiciel (SDK) DirectX (pour obtenir D3D10SDKLayers.DLL), puis spécifier l' \_ indicateur de débogage D3D10 créer un \_ appareil lors de l' \_ appel de [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice).</span><span class="sxs-lookup"><span data-stu-id="f9c85-116">To create a device that supports the debug layer, you must install the DirectX SDK (to get D3D10SDKLayers.DLL), and then specify the D3D10\_CREATE\_DEVICE\_DEBUG flag when calling [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice).</span></span> <span data-ttu-id="f9c85-117">Bien entendu, l’exécution d’une application avec la couche de débogage sera sensiblement plus lente.</span><span class="sxs-lookup"><span data-stu-id="f9c85-117">Of course, running an application with the debug layer will be substantially slower.</span></span> <span data-ttu-id="f9c85-118">Pour activer/désactiver les messages de débogage pour les API D3DX10, appelez [**D3DX10DebugMute**](d3dx10debugmute.md).</span><span class="sxs-lookup"><span data-stu-id="f9c85-118">To enable/disable debug messages for D3DX10 APIs, call [**D3DX10DebugMute**](d3dx10debugmute.md).</span></span>

<span data-ttu-id="f9c85-119">Lorsque la couche de débogage répertorie les fuites de mémoire, elle génère une liste de pointeurs d’interface d’objet avec leurs noms conviviaux.</span><span class="sxs-lookup"><span data-stu-id="f9c85-119">When the debug layer lists memory leaks, it outputs a list of object interface pointers along with their friendly names.</span></span> <span data-ttu-id="f9c85-120">Le nom convivial par défaut est « sans &lt; nom &gt; ».</span><span class="sxs-lookup"><span data-stu-id="f9c85-120">The default friendly name is "&lt;unnamed&gt;".</span></span> <span data-ttu-id="f9c85-121">Vous pouvez définir le nom convivial à l’aide de la méthode [**ID3D10DeviceChild :: SetPrivateData**](/windows/desktop/api/D3D10/nf-d3d10-id3d10devicechild-setprivatedata) et du GUID **WKPDID \_ D3DDebugObjectName** qui se trouve dans D3Dcommon. h.</span><span class="sxs-lookup"><span data-stu-id="f9c85-121">You can set the friendly name by using the [**ID3D10DeviceChild::SetPrivateData**](/windows/desktop/api/D3D10/nf-d3d10-id3d10devicechild-setprivatedata) method and the **WKPDID\_D3DDebugObjectName** GUID that is in D3Dcommon.h.</span></span> <span data-ttu-id="f9c85-122">Par exemple, pour nommer pTexture avec le nom de SDKLayer mytexture.jpg, utilisez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="f9c85-122">For example, to name pTexture with a SDKLayer name of mytexture.jpg, use the following code:</span></span>


```
const char c_szName[] = "mytexture.jpg";
pTexture->SetPrivateData( WKPDID_D3DDebugObjectName, sizeof( c_szName ) - 1, c_szName );
```



<span data-ttu-id="f9c85-123">En règle générale, vous devez compiler ces appels en dehors de votre version de production.</span><span class="sxs-lookup"><span data-stu-id="f9c85-123">Typically, you should compile these calls out of your production version.</span></span>

## <a name="switch-to-reference-layer"></a><span data-ttu-id="f9c85-124">Couche Switch-to-Reference</span><span class="sxs-lookup"><span data-stu-id="f9c85-124">Switch-to-Reference Layer</span></span>

<span data-ttu-id="f9c85-125">Cette couche permet à une application d’effectuer une transition entre un périphérique matériel (HAL) et une référence ou un périphérique logiciel (REF).</span><span class="sxs-lookup"><span data-stu-id="f9c85-125">This layer enables an application to transition between a hardware device (HAL) and a reference or software device (REF).</span></span> <span data-ttu-id="f9c85-126">Pour basculer un appareil, vous devez d’abord créer un appareil qui prend en charge la couche Switch-to-Reference (voir [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice)), puis appeler [**ID3D10SwitchToRef :: SetUseRef**](/windows/desktop/api/D3D10SDKLayers/nf-d3d10sdklayers-id3d10switchtoref-setuseref).</span><span class="sxs-lookup"><span data-stu-id="f9c85-126">To switch a device, you must first create a device that supports the switch-to-reference layer (see [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice)) and then call [**ID3D10SwitchToRef::SetUseRef**](/windows/desktop/api/D3D10SDKLayers/nf-d3d10sdklayers-id3d10switchtoref-setuseref).</span></span>

<span data-ttu-id="f9c85-127">Tous les États, les ressources et les objets des appareils sont gérés par le biais de cette transition d’appareil.</span><span class="sxs-lookup"><span data-stu-id="f9c85-127">All device states, resources and objects are maintained through this device transition.</span></span> <span data-ttu-id="f9c85-128">Toutefois, il est parfois impossible de faire correspondre exactement les données de ressources.</span><span class="sxs-lookup"><span data-stu-id="f9c85-128">However, it is sometimes not possible to exactly match resource data.</span></span> <span data-ttu-id="f9c85-129">Cela est dû au fait que certaines informations sont disponibles pour un périphérique matériel qui n’est pas disponible pour un appareil de référence.</span><span class="sxs-lookup"><span data-stu-id="f9c85-129">This is due to the fact that some information is available to a hardware device that is not available to a reference device.</span></span>

<span data-ttu-id="f9c85-130">Presque toutes les applications en temps réel utilisent l’implémentation HAL du pipeline.</span><span class="sxs-lookup"><span data-stu-id="f9c85-130">Virtually all real-time applications use the HAL implementation of the pipeline.</span></span> <span data-ttu-id="f9c85-131">Lorsque le pipeline est basculé d’un périphérique matériel à un appareil de référence, les opérations de rendu sont effectuées simultanément sur le matériel et les logiciels.</span><span class="sxs-lookup"><span data-stu-id="f9c85-131">When the pipeline is switched from a hardware device to a reference device, rendering operations are done simultaneously in both hardware and software.</span></span> <span data-ttu-id="f9c85-132">Lors du rendu de l’appareil logiciel, les ressources sont téléchargées dans la mémoire système.</span><span class="sxs-lookup"><span data-stu-id="f9c85-132">As the software device is rendering, it will require that resources are downloaded to system memory.</span></span> <span data-ttu-id="f9c85-133">Cela peut nécessiter la suppression d’autres ressources mises en cache dans la mémoire système pour libérer de l’espace.</span><span class="sxs-lookup"><span data-stu-id="f9c85-133">This may require other resources cached in system memory to be evicted to make room.</span></span>

> [!Note]  
> <span data-ttu-id="f9c85-134">Cette fonctionnalité de couche de référence est prise en charge uniquement dans Direct3D 10 et Direct3D 10,1 et n’est plus prise en charge dans Direct3D 11 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="f9c85-134">This switch-to-reference-layer feature is supported only in Direct3D 10 and Direct3D 10.1, and is no longer supported in Direct3D 11 and later versions.</span></span>

 

## <a name="thread-safe-layer"></a><span data-ttu-id="f9c85-135">Couche Thread-Safe</span><span class="sxs-lookup"><span data-stu-id="f9c85-135">Thread-Safe Layer</span></span>

<span data-ttu-id="f9c85-136">Cette couche est conçue pour permettre aux applications multithread d’accéder à l’appareil à partir de plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="f9c85-136">This layer is designed to allow multi-threaded applications to access the device from multiple threads.</span></span>

<span data-ttu-id="f9c85-137">Une application Direct3D 10 peut contrôler une synchronisation d’appareil à l’aide de fonctions d’appareil.</span><span class="sxs-lookup"><span data-stu-id="f9c85-137">A Direct3D 10 application can control a device synchronization using device functions.</span></span> <span data-ttu-id="f9c85-138">Cela permet à une application d’activer/de désactiver les sections critiques (en activant ou désactivant temporairement la protection de multithreading) et de prendre/libérer un verrou de section critique sur plusieurs points d’entrée de l’API Direct3D 10.</span><span class="sxs-lookup"><span data-stu-id="f9c85-138">This enables an application to enable/disable critical sections (temporarily enabling/disabling multithreading protection), and take/release a critical-section lock over multiple Direct3D 10 API entry points.</span></span> <span data-ttu-id="f9c85-139">La couche thread-safe est activée par défaut.</span><span class="sxs-lookup"><span data-stu-id="f9c85-139">The thread-safe layer is enabled by default.</span></span> <span data-ttu-id="f9c85-140">Pour les applications à thread unique, la couche thread-safe n’a aucun impact sur les performances.</span><span class="sxs-lookup"><span data-stu-id="f9c85-140">For single-threaded applications, the thread-safe layer has no impact on performance.</span></span>




<span data-ttu-id="f9c85-141">Différences entre Direct3D 9 et Direct3D 10 :</span><span class="sxs-lookup"><span data-stu-id="f9c85-141">Differences between Direct3D 9 and Direct3D 10:</span></span>

- <span data-ttu-id="f9c85-142">Contrairement à Direct3D 9, l’API Direct3D 10 par défaut est entièrement thread-safe.</span><span class="sxs-lookup"><span data-stu-id="f9c85-142">Unlike Direct3D 9, the Direct3D 10 API defaults to fully thread-safe.</span></span>



 

## <a name="related-topics"></a><span data-ttu-id="f9c85-143">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f9c85-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f9c85-144">Fonctionnalités de l’API (Direct3D 10)</span><span class="sxs-lookup"><span data-stu-id="f9c85-144">API Features (Direct3D 10)</span></span>](d3d10-graphics-programming-guide-api-features.md)
</dt> </dl>

 

 




