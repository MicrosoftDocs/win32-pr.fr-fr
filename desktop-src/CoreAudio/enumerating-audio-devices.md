---
description: Énumération des périphériques audio
ms.assetid: 20110ffc-5eff-4279-abea-53115803b6ee
title: Énumération des périphériques audio
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 707b9a88181c83344757c711af1c0199c19ebc16
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104033707"
---
# <a name="enumerating-audio-devices"></a><span data-ttu-id="ce0ac-103">Énumération des périphériques audio</span><span class="sxs-lookup"><span data-stu-id="ce0ac-103">Enumerating Audio Devices</span></span>

<span data-ttu-id="ce0ac-104">La première tâche d’une application audio client consiste à trouver un périphérique audio approprié à utiliser.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-104">The first task of a client audio application is to find a suitable audio device to use.</span></span> <span data-ttu-id="ce0ac-105">L' [API MMDevice](mmdevice-api.md) permet aux clients de découvrir les [périphériques de point de terminaison audio](audio-endpoint-devices.md) dans le système et de déterminer les appareils qui conviennent à l’application.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-105">The [MMDevice API](mmdevice-api.md) lets clients discover the [audio endpoint devices](audio-endpoint-devices.md) in the system and determine which devices are suitable for the application to use.</span></span> <span data-ttu-id="ce0ac-106">Cette API permet aux clients de récupérer les regroupements des appareils de point de terminaison disponibles et d’obtenir les fonctionnalités de chaque appareil.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-106">This API enables clients to retrieve collections of the available endpoint devices and get the capabilities of each device.</span></span> <span data-ttu-id="ce0ac-107">Le fichier d’en-tête MMDeviceAPI. h définit les interfaces dans l’API MMDevice.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-107">Header file Mmdeviceapi.h defines the interfaces in the MMDevice API.</span></span>

<span data-ttu-id="ce0ac-108">Une carte audio peut contenir plusieurs appareils, par exemple, un périphérique de rendu d’onde et un périphérique de capture d’onde.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-108">An audio adapter might contain several devices—for example, a wave-rendering device and a wave-capture device.</span></span> <span data-ttu-id="ce0ac-109">Il s’agit des périphériques d’adaptateur plutôt que des appareils de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-109">These are adapter devices rather than endpoint devices.</span></span> <span data-ttu-id="ce0ac-110">Comme mentionné précédemment, les périphériques d’adaptateur sont inscrits par le gestionnaire de Plug-and-Play, contrairement aux appareils de point de terminaison qui sont inscrits par le gestionnaire des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-110">As mentioned previously, adapter devices are registered by the Plug and Play manager, in contrast with endpoint devices, which are registered by the endpoint manager.</span></span> <span data-ttu-id="ce0ac-111">Chaque périphérique d’adaptateur prend généralement en charge un ou plusieurs périphériques de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-111">Each adapter device typically supports one or more endpoint devices.</span></span> <span data-ttu-id="ce0ac-112">Un périphérique de point de terminaison de rendu (par exemple, un casque) peut recevoir un flux de données audio à partir d’une application cliente, et un périphérique de point de terminaison de capture (par exemple, un microphone) peut envoyer un flux audio à une application cliente.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-112">A rendering endpoint device (for example, headphones) can receive a stream of audio data from a client application, and a capture endpoint device (for example, a microphone) can send an audio stream to a client application.</span></span>

<span data-ttu-id="ce0ac-113">Avant d’énumérer les appareils de point de terminaison dans le système, le client doit d’abord appeler la fonction [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) Windows pour créer un énumérateur d’appareil.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-113">Before enumerating the endpoint devices in the system, the client must first call the Windows [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to create a device enumerator.</span></span> <span data-ttu-id="ce0ac-114">Un énumérateur d’appareil est un objet avec une interface [**IMMDeviceEnumerator**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) .</span><span class="sxs-lookup"><span data-stu-id="ce0ac-114">A device enumerator is an object with an [**IMMDeviceEnumerator**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) interface.</span></span> <span data-ttu-id="ce0ac-115">Pour plus d’informations sur **CoCreateInstance**, consultez la documentation SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-115">For information about **CoCreateInstance**, see the Windows SDK documentation.</span></span>

<span data-ttu-id="ce0ac-116">Le client appelle la méthode [**IMMDeviceEnumerator :: EnumAudioEndpoints**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) pour créer une collection d’objets de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-116">The client calls the [**IMMDeviceEnumerator::EnumAudioEndpoints**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) method to create a collection of endpoint objects.</span></span> <span data-ttu-id="ce0ac-117">Chaque objet de point de terminaison représente un périphérique de point de terminaison audio dans le système.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-117">Each endpoint object represents an audio endpoint device in the system.</span></span> <span data-ttu-id="ce0ac-118">Dans cet appel, le client spécifie si la collection doit contenir tous les périphériques de rendu du système, tous les périphériques de capture, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-118">In this call, the client specifies whether the collection should contain all of the rendering devices in the system, all of the capture devices, or both.</span></span>

<span data-ttu-id="ce0ac-119">Une collection d’appareils est un objet avec une interface [**IMMDeviceCollection**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) .</span><span class="sxs-lookup"><span data-stu-id="ce0ac-119">A device collection is an object with an [**IMMDeviceCollection**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) interface.</span></span> <span data-ttu-id="ce0ac-120">Chaque élément d’une collection de périphériques est un objet de point de terminaison avec au moins les deux interfaces suivantes :</span><span class="sxs-lookup"><span data-stu-id="ce0ac-120">Each item in a device collection is an endpoint object with at least the following two interfaces:</span></span>

-   <span data-ttu-id="ce0ac-121">Interface [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) .</span><span class="sxs-lookup"><span data-stu-id="ce0ac-121">An [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) interface.</span></span> <span data-ttu-id="ce0ac-122">Un client obtient une référence à l’interface **IMMDevice** d’un objet de point de terminaison dans une collection de périphériques en appelant la méthode [**IMMDeviceCollection :: Item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) .</span><span class="sxs-lookup"><span data-stu-id="ce0ac-122">A client obtains a reference to the **IMMDevice** interface of an endpoint object in a device collection by calling the [**IMMDeviceCollection::Item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) method.</span></span>
-   <span data-ttu-id="ce0ac-123">Interface [**IMMEndpoint**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) .</span><span class="sxs-lookup"><span data-stu-id="ce0ac-123">An [**IMMEndpoint**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) interface.</span></span> <span data-ttu-id="ce0ac-124">Un client obtient une référence à l’interface **IMMEndpoint** d’un objet de point de terminaison en appelant la méthode [**IMMDevice :: QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) .</span><span class="sxs-lookup"><span data-stu-id="ce0ac-124">A client obtains a reference to the **IMMEndpoint** interface of an endpoint object by calling the [**IMMDevice::QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span>

<span data-ttu-id="ce0ac-125">Après avoir récupéré une collection d’appareils de point de terminaison, le client peut interroger les propriétés des différents appareils dans le regroupement afin de déterminer leur aptitude à l’emploi.</span><span class="sxs-lookup"><span data-stu-id="ce0ac-125">After retrieving a collection of endpoint devices, the client can query the properties of the individual devices in the collection to determine their suitability for use.</span></span> <span data-ttu-id="ce0ac-126">Pour obtenir un exemple de code qui montre comment énumérer les appareils de point de terminaison et interroger leurs propriétés, consultez Propriétés de l' [appareil](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="ce0ac-126">For a code example that shows how to enumerate endpoint devices and query their properties, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="ce0ac-127">Après avoir sélectionné un appareil approprié, le client peut appeler la méthode [**IMMDevice :: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) pour activer les interfaces spécifiques à l’appareil dans [WASAPI](wasapi.md), l' [API DeviceTopology](devicetopology-api.md)et l' [API EndpointVolume](endpointvolume-api.md).</span><span class="sxs-lookup"><span data-stu-id="ce0ac-127">After selecting a suitable device, the client can call the [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) method to activate the device-specific interfaces in [WASAPI](wasapi.md), the [DeviceTopology API](devicetopology-api.md), and the [EndpointVolume API](endpointvolume-api.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="ce0ac-128">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="ce0ac-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ce0ac-129">Périphériques de point de terminaison audio</span><span class="sxs-lookup"><span data-stu-id="ce0ac-129">Audio Endpoint Devices</span></span>](audio-endpoint-devices.md)
</dt> </dl>

 

 
