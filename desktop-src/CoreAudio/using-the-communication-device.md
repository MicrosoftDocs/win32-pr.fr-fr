---
description: Dans Windows 7, le panneau de configuration Windows multimédia, Mmsys.cpl, fournit un nouvel onglet communications.
ms.assetid: bec2127d-fb82-436d-beee-d43e8fef5c35
title: Utilisation d’un appareil de communication
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93f677245e650cf11c71c879b2c26d3183ff4a0b
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103861290"
---
# <a name="using-a-communication-device"></a><span data-ttu-id="75d6b-103">Utilisation d’un appareil de communication</span><span class="sxs-lookup"><span data-stu-id="75d6b-103">Using a Communication Device</span></span>

<span data-ttu-id="75d6b-104">Dans Windows 7, le panneau de configuration Windows multimédia, Mmsys.cpl, fournit un nouvel onglet **communications** . Cet onglet contient des options qui permettent à un utilisateur de définir des options qui définissent la façon dont le système gère un *périphérique de communication*.</span><span class="sxs-lookup"><span data-stu-id="75d6b-104">In Windows 7, the Windows multimedia control panel, Mmsys.cpl, provides a new **Communications** tab. This tab contains options that enables a user to set options that defines how the system manages a *communication device*.</span></span> <span data-ttu-id="75d6b-105">Un appareil de communication est principalement utilisé pour le placement ou la réception d’appels téléphoniques sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="75d6b-105">A communication device is used primarily for placing or receiving telephone calls on the computer.</span></span> <span data-ttu-id="75d6b-106">Pour un ordinateur qui n’a qu’un seul périphérique de rendu (conférencier) et un périphérique de capture (microphone), ces périphériques audio jouent également le rôle d’appareils de communication par défaut.</span><span class="sxs-lookup"><span data-stu-id="75d6b-106">For a computer that has only one rendering device (speaker) and one capture device (microphone), these audio devices also act as the default communication devices.</span></span> <span data-ttu-id="75d6b-107">Lorsqu’un utilisateur se connecte à un nouvel appareil, tel qu’un casque USB, le système effectue une détection automatique des rôles d’appareil en recherchant les paramètres de configuration qui sont renseignés par l’OEM.</span><span class="sxs-lookup"><span data-stu-id="75d6b-107">When a user connects a new device, such as a USB headset, the system performs automatic device role detection by looking up the configuration settings that are populated by the OEM.</span></span> <span data-ttu-id="75d6b-108">Si le système détermine qu’un périphérique est le mieux adapté à des fins de communication, le système affecte le rôle **eCommunications** à l’appareil.</span><span class="sxs-lookup"><span data-stu-id="75d6b-108">If the system determines a device to be best suited for communication purposes, the system assigns the **eCommunications** role to the device.</span></span> <span data-ttu-id="75d6b-109">Pour ces appareils, le Mmsys.cpl Windows 7 fournit l’option **appareil de communication par défaut** qui permet à un utilisateur de sélectionner un appareil de communication pour le rendu audio (onglet **lecture** ) et la capture audio (onglet **enregistrement** ).</span><span class="sxs-lookup"><span data-stu-id="75d6b-109">For these devices, the Windows 7 Mmsys.cpl provides the option **Default Communication Device** that enables a user to select a communication device each for audio rendering (**Playback** tab) and audio capturing (**Recording** tab).</span></span> <span data-ttu-id="75d6b-110">Le système effectue une détection automatique des rôles, mais ne définit pas un appareil particulier à utiliser pour les communications.</span><span class="sxs-lookup"><span data-stu-id="75d6b-110">The system performs automatic role detection but does not set a particular device to be used for communications.</span></span> <span data-ttu-id="75d6b-111">Cette opération doit être effectuée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="75d6b-111">This must be done by the user.</span></span> <span data-ttu-id="75d6b-112">Le nouveau rôle **eCommunications** permet à une application de faire la distinction entre un appareil qui est choisi par l’utilisateur pour gérer les appels téléphoniques et un appareil à utiliser comme périphérique multimédia (lecture musicale).</span><span class="sxs-lookup"><span data-stu-id="75d6b-112">The new **eCommunications** role lets an application distinguish between a device that is chosen by the user for handling phone calls and a device to be used as a multimedia device (music playback).</span></span> <span data-ttu-id="75d6b-113">Par exemple, si l’utilisateur a un casque et un conférencier connectés à l’ordinateur, le système affecte le rôle **eConsole** au haut-parleur et le rôle **eCommunications** au casque.</span><span class="sxs-lookup"><span data-stu-id="75d6b-113">For example, if the user has a headset and a speaker connected to the computer, the system assigns the **eConsole** role to the speaker and the **eCommunications** role to the headset.</span></span> <span data-ttu-id="75d6b-114">Une fois que l’utilisateur a sélectionné le casque à utiliser comme périphérique de communication, pour développer une application de communication, vous pouvez cibler le casque en particulier pour le rendu d’un flux audio.</span><span class="sxs-lookup"><span data-stu-id="75d6b-114">After the user selects the headset to be used as the communication device, to develop a communication application, you can target the headset specifically for rendering an audio stream.</span></span> <span data-ttu-id="75d6b-115">Une application l’utilisateur ne peut pas modifier le rôle d’appareil affecté par le système.</span><span class="sxs-lookup"><span data-stu-id="75d6b-115">An application the user cannot change the device role assigned by the system.</span></span> <span data-ttu-id="75d6b-116">Pour plus d’informations sur les rôles d’appareil, consultez [rôles d’appareil](device-roles.md).</span><span class="sxs-lookup"><span data-stu-id="75d6b-116">For more information about device roles, see [Device Roles](device-roles.md).</span></span>

<span data-ttu-id="75d6b-117">Les applications de communication, telles que les applications de communication unifiée et VoIP, placent et reçoivent des appels téléphoniques par le biais d’un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="75d6b-117">Communication applications, such as VoIP and Unified Communication applications, place and receive phone calls through a computer.</span></span> <span data-ttu-id="75d6b-118">Par exemple, une application VoIP peut affecter un flux qui contient la notification de sonnerie au point de terminaison d’un ensemble d’appareils de communication pour le rendu des flux audio.</span><span class="sxs-lookup"><span data-stu-id="75d6b-118">For example, a VoIP application might assign a stream that contains the ring-in notification to the endpoint of a communication device set for rendering audio streams.</span></span> <span data-ttu-id="75d6b-119">En outre, l’application peut ouvrir les flux d’entrée et de sortie vocaux sur les appareils de point de terminaison de capture et de rendu qui sont définis en tant qu’appareils de communication.</span><span class="sxs-lookup"><span data-stu-id="75d6b-119">In addition, the application might open the voice input and output streams on the capture and rendering endpoint devices that are set as communication devices.</span></span>

<span data-ttu-id="75d6b-120">Pour intégrer les fonctionnalités de communication à vos applications, vous pouvez utiliser :</span><span class="sxs-lookup"><span data-stu-id="75d6b-120">To integrate communication capabilities into your applications, you can use:</span></span>

-   <span data-ttu-id="75d6b-121">[API MMDevice](mmdevice-api.md): pour obtenir une référence au point de terminaison de l’appareil de communication.</span><span class="sxs-lookup"><span data-stu-id="75d6b-121">[MMDevice API](mmdevice-api.md)—to get a reference to the endpoint of the communication device.</span></span>
-   <span data-ttu-id="75d6b-122">[WASAPI](wasapi.md): pour afficher et capturer des flux audio via l’appareil de communication.</span><span class="sxs-lookup"><span data-stu-id="75d6b-122">[WASAPI](wasapi.md)—to render and capture audio streams through the communication device.</span></span> <span data-ttu-id="75d6b-123">Le système d’exploitation considère le flux ouvert sur un appareil de communication comme un *flux de communication*.</span><span class="sxs-lookup"><span data-stu-id="75d6b-123">The operating system considers the stream opened on a communication device to be a *communication stream*.</span></span>

<span data-ttu-id="75d6b-124">L’application de communication énumère les appareils et assure la gestion des flux de données pour un flux de communication (rendu ou capture) de la même manière qu’il gère un flux de données de non-communication à l’aide des API audio principales.</span><span class="sxs-lookup"><span data-stu-id="75d6b-124">The communication application enumerates devices and provides stream management for a communication stream (rendering or capture) stream in the same manner as it would manage a non-communication stream by using the Core Audio APIs.</span></span>

<span data-ttu-id="75d6b-125">L’une des fonctionnalités que vous pouvez intégrer dans votre application de communication *est l'* entourage ou l' *atténuation du flux*.</span><span class="sxs-lookup"><span data-stu-id="75d6b-125">One of the features that you can integrate in your communication application is *ducking* or *stream attenuation*.</span></span> <span data-ttu-id="75d6b-126">Ce comportement définit ce qui doit se produire avec d’autres sons lorsqu’un flux de communication est ouvert, par exemple lors de la réception d’un appel téléphonique sur le périphérique de communication.</span><span class="sxs-lookup"><span data-stu-id="75d6b-126">This behavior defines what must happen to other sounds when a communication stream is opened, such as when a phone call is received on the communication device.</span></span> <span data-ttu-id="75d6b-127">Le système peut désactiver ou baisser le volume audio du flux de données de non-communication en fonction du choix de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="75d6b-127">The system might mute or lower the audio volume of the non-communication stream depending on the user's choice.</span></span> <span data-ttu-id="75d6b-128">Le système audio génère des événements de canard lorsqu’un flux de communication est ouvert ou fermé pour les flux de rendu ou de capture.</span><span class="sxs-lookup"><span data-stu-id="75d6b-128">The audio system generates ducking events when a communication stream is opened or closed for rendering or capturing streams.</span></span> <span data-ttu-id="75d6b-129">Par défaut, le système d’exploitation fournit une expérience de l’utilisation de l’interface utilisateur par défaut.</span><span class="sxs-lookup"><span data-stu-id="75d6b-129">By default, the operating system provides a default ducking experience.</span></span> <span data-ttu-id="75d6b-130">Une application multimédia peut remplacer le comportement par défaut et gérer ces événements pour fournir une expérience de canard personnalisée.</span><span class="sxs-lookup"><span data-stu-id="75d6b-130">A media application can replace the default behavior and handle these events itself to provide a customized ducking experience.</span></span>

<span data-ttu-id="75d6b-131">Les sections suivantes décrivent comment utiliser les API audio de base pour fournir une expérience de canard personnalisée.</span><span class="sxs-lookup"><span data-stu-id="75d6b-131">The following sections describe how to use Core Audio APIs to provide a custom ducking experience.</span></span>

-   [<span data-ttu-id="75d6b-132">Expérience de l’utilisation des canards par défaut</span><span class="sxs-lookup"><span data-stu-id="75d6b-132">Default Ducking Experience</span></span>](stream-attenuation.md)
-   [<span data-ttu-id="75d6b-133">Désactivation de l’expérience de l’utilisation des canards par défaut</span><span class="sxs-lookup"><span data-stu-id="75d6b-133">Disabling the Default Ducking Experience</span></span>](disabling-the-ducking-experience.md)
-   [<span data-ttu-id="75d6b-134">Fournir un comportement de canard personnalisé</span><span class="sxs-lookup"><span data-stu-id="75d6b-134">Providing a Custom Ducking Behavior</span></span>](providing-a-custom-ducking-experience.md)
-   [<span data-ttu-id="75d6b-135">Considérations relatives à l’implémentation pour l’installation de notifications</span><span class="sxs-lookup"><span data-stu-id="75d6b-135">Implementation Considerations for Ducking Notifications</span></span>](handling-audio-ducking-events-from-communication-devices.md)
-   [<span data-ttu-id="75d6b-136">Obtention d’événements de canard</span><span class="sxs-lookup"><span data-stu-id="75d6b-136">Getting Ducking Events</span></span>](getting-ducking-events-from-a-communication-device.md)

### <a name="getting-a-reference-to-the-communication-device-endpoint"></a><span data-ttu-id="75d6b-137">Obtention d’une référence au point de terminaison de l’appareil de communication</span><span class="sxs-lookup"><span data-stu-id="75d6b-137">Getting a Reference to the Communication Device Endpoint</span></span>

<span data-ttu-id="75d6b-138">Pour utiliser l’appareil de communication, un client direct WASAPI doit énumérer les appareils à l’aide de l’énumérateur d’appareil.</span><span class="sxs-lookup"><span data-stu-id="75d6b-138">To use the communication device, a direct WASAPI client must enumerate the devices by using the device enumerator.</span></span> <span data-ttu-id="75d6b-139">Obtenir une référence au point de terminaison de l’appareil de communication par défaut en appelant [**IMMDeviceEnumerator :: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span><span class="sxs-lookup"><span data-stu-id="75d6b-139">Get a reference to the endpoint of the default communication device by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="75d6b-140">Dans cet appel, l’application doit spécifier **eCommunications** dans le paramètre *role* pour limiter l’énumération des appareils aux périphériques de communication.</span><span class="sxs-lookup"><span data-stu-id="75d6b-140">In this call, the application must specify **eCommunications** in the *Role* parameter to restrict the device enumeration to communication devices.</span></span> <span data-ttu-id="75d6b-141">Une fois que vous avez obtenu une référence au point de terminaison de périphérique pour l’appareil, vous pouvez activer les services dont la portée est définie pour le point de terminaison en appelant [**IMMDevice :: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span><span class="sxs-lookup"><span data-stu-id="75d6b-141">After you get a reference to the device endpoint for the device, you can activate the services that are scoped for the endpoint by calling [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span></span> <span data-ttu-id="75d6b-142">Par exemple, vous pouvez transmettre l’identificateur de service **\_ IAudioClient IID** pour activer un objet client audio et l’utiliser pour la gestion du flux de données, l’identificateur **IID \_ IAudioEndpointVolume** pour accéder aux contrôles de volume du point de terminaison de périphérique de communication, ou l’identificateur d' **IID \_ IAudioSessionManager** pour activer le gestionnaire de session qui vous permet d’interagir avec le moteur de stratégie du point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="75d6b-142">For example, you can pass the **IID\_IAudioClient** service identifier to activate an audio client object and use it for stream management, the **IID\_IAudioEndpointVolume** identifier to get access to the volume controls of the communication device endpoint, or the **IID\_IAudioSessionManager** identifier to activate the session manager that enables you to interact with the policy engine of the endpoint.</span></span> <span data-ttu-id="75d6b-143">Pour plus d’informations sur les opérations de flux, consultez [gestion des flux](stream-management.md).</span><span class="sxs-lookup"><span data-stu-id="75d6b-143">For information about stream operations, see [Stream Management](stream-management.md).</span></span>

<span data-ttu-id="75d6b-144">À l’aide de la référence [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) , vous pouvez également accéder à la Banque de propriétés pour le point de terminaison de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="75d6b-144">By using the [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) reference, you can also access the property store for the device endpoint.</span></span> <span data-ttu-id="75d6b-145">Ces valeurs de propriété, telles que le nom convivial de l’appareil et le nom du fabricant, sont remplies par l’OEM et permettent à une application de déterminer les caractéristiques d’un appareil de communication.</span><span class="sxs-lookup"><span data-stu-id="75d6b-145">These property values, such as device friendly name and manufacturer name, are populated by the OEM and enable an application to determine the characteristics of a communication device.</span></span> <span data-ttu-id="75d6b-146">Pour plus d’informations, consultez Propriétés de l' [appareil](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="75d6b-146">For more information, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="75d6b-147">L’exemple de code suivant obtient une référence au point de terminaison de l’appareil de communication par défaut pour le rendu d’un flux audio.</span><span class="sxs-lookup"><span data-stu-id="75d6b-147">The following example code gets a reference to the endpoint of the default communication device for rendering an audio stream.</span></span>


```C++
IMMDevice *defaultDevice = NULL;

hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL,
            CLSCTX_INPROC_SERVER, 
            __uuidof(IMMDeviceEnumerator), 
            (LPVOID *)&deviceEnumerator);

hr = deviceEnumerator->GetDefaultAudioEndpoint(eRender, 
            eCommunications, &defaultDevice);
```



## <a name="related-topics"></a><span data-ttu-id="75d6b-148">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="75d6b-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="75d6b-149">Gestion de flux</span><span class="sxs-lookup"><span data-stu-id="75d6b-149">Stream Management</span></span>](stream-management.md)
</dt> </dl>

 

 



