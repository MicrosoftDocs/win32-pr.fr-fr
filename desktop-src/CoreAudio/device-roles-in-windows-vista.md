---
description: Utilisation des rôles d’appareil
ms.assetid: 3b2cb1fe-0f11-4509-a6f3-513d2755cd29
title: Utilisation des rôles d’appareil
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c21ea667a6974634c1f9f0657dd02c13a621641c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103950391"
---
# <a name="working-with-device-roles"></a><span data-ttu-id="e5de7-103">Utilisation des rôles d’appareil</span><span class="sxs-lookup"><span data-stu-id="e5de7-103">Working with Device Roles</span></span>

<span data-ttu-id="e5de7-104">L' [API MMDevice](mmdevice-api.md) prend en charge les rôles d’appareil.</span><span class="sxs-lookup"><span data-stu-id="e5de7-104">The [MMDevice API](mmdevice-api.md) supports device roles.</span></span> <span data-ttu-id="e5de7-105">L’énumération [**ERole**](/windows/win32/api/mmdeviceapi/ne-mmdeviceapi-erole) définit les rôles d’appareil pris en charge par l’API MMDevice.</span><span class="sxs-lookup"><span data-stu-id="e5de7-105">The [**ERole**](/windows/win32/api/mmdeviceapi/ne-mmdeviceapi-erole) enumeration defines the device roles that are supported by the MMDevice API.</span></span>

> [!Note]  
> <span data-ttu-id="e5de7-106">Bien que l' [API MMDevice](mmdevice-api.md) prenne en charge les rôles d’appareil, l’interface utilisateur de Windows Vista n’implémente pas la prise en charge de cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="e5de7-106">Although the [MMDevice API](mmdevice-api.md) supports device roles, the user interface in Windows Vista does not implement support for this feature.</span></span>

 

<span data-ttu-id="e5de7-107">Une application peut utiliser l’API MMDevice pour prendre en charge les [rôles d’appareil](device-roles.md) via les méthodes [**IMMDeviceEnumerator :: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint) et [**IMMNotificationClient :: OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) .</span><span class="sxs-lookup"><span data-stu-id="e5de7-107">An application can use MMDevice API to support [device roles](device-roles.md) through the [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint) and [**IMMNotificationClient::OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) methods.</span></span> <span data-ttu-id="e5de7-108">Toutefois, l’interface utilisateur de Windows Vista ne prend pas en charge l’affectation de rôles individuels à différents appareils.</span><span class="sxs-lookup"><span data-stu-id="e5de7-108">However, the user interface in Windows Vista does not support assignment of individual roles to different devices.</span></span> <span data-ttu-id="e5de7-109">Dans Windows Vista, l’interface utilisateur permet à l’utilisateur de sélectionner un périphérique audio par défaut pour le rendu et un périphérique audio par défaut pour la capture.</span><span class="sxs-lookup"><span data-stu-id="e5de7-109">In Windows Vista, the user interface enables the user to select a default audio device for rendering and a default audio device for capture.</span></span> <span data-ttu-id="e5de7-110">Lorsque l’utilisateur sélectionne un appareil de rendu ou de capture par défaut, le système affecte les trois rôles d’appareil (eConsole, eMultimedia et eCommunications) à cet appareil.</span><span class="sxs-lookup"><span data-stu-id="e5de7-110">When the user selects a default rendering or capture device, the system assigns all three device roles (eConsole, eMultimedia, and eCommunications) to that device.</span></span> <span data-ttu-id="e5de7-111">Les applications ne peuvent pas modifier les rôles affectés aux périphériques de point de terminaison audio.</span><span class="sxs-lookup"><span data-stu-id="e5de7-111">Applications cannot change the roles that are assigned to audio endpoint devices.</span></span> <span data-ttu-id="e5de7-112">Le système d’exploitation permet uniquement à l’utilisateur d’attribuer des rôles d’appareil.</span><span class="sxs-lookup"><span data-stu-id="e5de7-112">The operating system allows only the user to assign device roles.</span></span>

<span data-ttu-id="e5de7-113">Un client peut s’inscrire pour recevoir une notification de l’API MMDevice chaque fois qu’une modification intervient dans l’attribution de rôles aux périphériques de point de terminaison audio.</span><span class="sxs-lookup"><span data-stu-id="e5de7-113">A client can register itself to receive a notification from the MMDevice API each time a change occurs in the assignment of roles to audio endpoint devices.</span></span> <span data-ttu-id="e5de7-114">Lorsqu’un rôle passe d’un appareil à un autre, le client peut choisir de continuer ou d’enregistrer ses flux sur le même appareil ou de basculer les flux vers un autre appareil.</span><span class="sxs-lookup"><span data-stu-id="e5de7-114">When a role shifts from one device to another, the client can choose whether to continue playing (or recording) its streams through the same device or to switch the streams to another device.</span></span> <span data-ttu-id="e5de7-115">Par défaut, les flux continuent à être lus (ou enregistrés) via l’appareil d’origine.</span><span class="sxs-lookup"><span data-stu-id="e5de7-115">By default, the streams continue to play (or be recorded) through the original device.</span></span> <span data-ttu-id="e5de7-116">Dans Windows Vista, pour basculer les flux vers un autre appareil, le client doit supprimer les flux sur l’appareil d’origine et créer des flux de remplacement sur le nouvel appareil.</span><span class="sxs-lookup"><span data-stu-id="e5de7-116">In Windows Vista, to switch the streams to another device, the client must delete the streams on the original device and create replacement streams on the new device.</span></span> <span data-ttu-id="e5de7-117">Dans Windows 7, le client peut écouter les nouvelles notifications pour implémenter un commutateur transparent sans interrompre la lecture ou la session de capture.</span><span class="sxs-lookup"><span data-stu-id="e5de7-117">In Windows 7, the client can listen for new notifications to implement a seamless switch without interrupting the playback or the capture session.</span></span> <span data-ttu-id="e5de7-118">Pour plus d’informations, consultez [routage de flux](stream-routing.md).</span><span class="sxs-lookup"><span data-stu-id="e5de7-118">For more information, see [Stream Routing](stream-routing.md).</span></span>

<span data-ttu-id="e5de7-119">Si vous envisagez d’utiliser Windows Vista pour tester votre application, vous pouvez configurer un environnement de test pour vérifier que l’application se comporte comme prévu lorsque l’utilisateur peut assigner des rôles d’appareil individuels à différents appareils.</span><span class="sxs-lookup"><span data-stu-id="e5de7-119">If you plan to use Windows Vista to test your application, you can set up a test environment to verify that the application behaves as expected when the user can assign individual device roles to different devices.</span></span> <span data-ttu-id="e5de7-120">Pour plus d‘informations, envoyez un e-mail à uaa@microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="e5de7-120">For more information, send email to uaa@microsoft.com.</span></span>

## <a name="communication-devices"></a><span data-ttu-id="e5de7-121">Appareils de communication</span><span class="sxs-lookup"><span data-stu-id="e5de7-121">Communication Devices</span></span>

<span data-ttu-id="e5de7-122">L’interface utilisateur de Windows 7 a la possibilité d’ajouter des *appareils de communication*.</span><span class="sxs-lookup"><span data-stu-id="e5de7-122">The Windows 7 user interface has the capability of adding *communications devices*.</span></span> <span data-ttu-id="e5de7-123">Le panneau de contrôle du **son** permet à l’utilisateur de sélectionner un appareil de communication par défaut pour le rendu et la capture du flux audio.</span><span class="sxs-lookup"><span data-stu-id="e5de7-123">The **Sound** control panel enables the user to select a default communication device each for rendering and capturing audio stream.</span></span> <span data-ttu-id="e5de7-124">Par défaut, lorsqu’un nouvel appareil est connecté à l’ordinateur, le système d’exploitation effectue une détection automatique des rôles et détermine si l’appareil est adapté au rôle eCommunication.</span><span class="sxs-lookup"><span data-stu-id="e5de7-124">By default, when a new device is connected to the computer, the operating system performs automatic role detecting and determines whether the device is suitable for the eCommunication role.</span></span> <span data-ttu-id="e5de7-125">En ciblant les appareils de communication, vous pouvez développer des applications qui utilisent des API audio de base pour implémenter des solutions de communication PC-Phone.</span><span class="sxs-lookup"><span data-stu-id="e5de7-125">By targeting communication devices, you can develop applications that use Core Audio APIs to implement PC-phone communication solutions.</span></span> <span data-ttu-id="e5de7-126">Par exemple, une application VoIP peut affecter ses flux d’entrée et de sortie vocaux aux appareils de point de terminaison de capture et de rendu par défaut avec le rôle eCommunications.</span><span class="sxs-lookup"><span data-stu-id="e5de7-126">For example, a VoIP application might assign its voice input and output streams to the default capture and rendering endpoint devices with the eCommunications role.</span></span> <span data-ttu-id="e5de7-127">Comme tout autre flux, une application de communication doit obtenir une référence au point de terminaison de l’appareil de communication en appelant [**IMMDeviceEnumerator :: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span><span class="sxs-lookup"><span data-stu-id="e5de7-127">Like any other stream, a communication application must get a reference to the communication device's endpoint by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="e5de7-128">Dans cet appel, l’application doit spécifier **eCommunications** dans le paramètre *role* .</span><span class="sxs-lookup"><span data-stu-id="e5de7-128">In this call, the application must specify **eCommunications** in the *Role* parameter.</span></span> <span data-ttu-id="e5de7-129">Les opérations de flux WASAPI sur un flux, ouvertes sur un appareil de communication, sont similaires à tout autre flux audio.</span><span class="sxs-lookup"><span data-stu-id="e5de7-129">The WASAPI stream operations on a stream, opened on a communication device, are similar to any other audio stream.</span></span> <span data-ttu-id="e5de7-130">L’application de communication peut améliorer l’expérience utilisateur en implémentant des comportements tels que l’utilisation de notifications à partir du point de terminaison de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="e5de7-130">The communication application can enhance user experience by implementing behaviors such as ducking by handling notifications from the device endpoint.</span></span> <span data-ttu-id="e5de7-131">Pour plus d’informations, consultez [utilisation d’un appareil de communication](using-the-communication-device.md).</span><span class="sxs-lookup"><span data-stu-id="e5de7-131">For more information, see [Using a Communication Device](using-the-communication-device.md).</span></span>

## <a name="automatic-device-role-detection"></a><span data-ttu-id="e5de7-132">Détection automatique du rôle d’appareil</span><span class="sxs-lookup"><span data-stu-id="e5de7-132">Automatic Device Role Detection</span></span>

<span data-ttu-id="e5de7-133">Prenons l’exemple d’un scénario dans lequel un ordinateur possède un appareil de rendu par défaut, les haut-parleurs et un périphérique de capture par défaut, un microphone.</span><span class="sxs-lookup"><span data-stu-id="e5de7-133">Consider a scenario in which a computer has a default rendering device, the speakers, and a default capture device, a microphone.</span></span> <span data-ttu-id="e5de7-134">L’utilisateur connecte un casque USB à l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e5de7-134">The user connects a USB headset to the computer.</span></span> <span data-ttu-id="e5de7-135">Une fois les pilotes appropriés installés, le système d’exploitation tente de détecter un rôle à attribuer pour le nouveau périphérique audio.</span><span class="sxs-lookup"><span data-stu-id="e5de7-135">After the appropriate drivers are installed, the operating system attempts to detect a role to assign for the new audio device.</span></span>

<span data-ttu-id="e5de7-136">Dans Windows 7, la fonctionnalité de détection des rôles d’appareils a été considérablement améliorée pour déterminer les rôles appropriés adaptés aux périphériques audio.</span><span class="sxs-lookup"><span data-stu-id="e5de7-136">In Windows 7, the device role detection feature has been improved significantly to determine the appropriate roles suited for audio devices.</span></span> <span data-ttu-id="e5de7-137">Tous les périphériques audio contiennent un ensemble de paramètres de configuration remplis par le fabricant de l’appareil, ce qui permet au système de décider de l’utilisation de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="e5de7-137">All audio devices contain a set of configuration settings populated by the device OEM, which help the system decide how to use the device.</span></span> <span data-ttu-id="e5de7-138">Ces paramètres incluent des informations telles que l’emplacement physique du jack audio, le sous-type de prise Jack et les fonctionnalités de détection, afin que le système puisse déterminer si l’appareil est branché.</span><span class="sxs-lookup"><span data-stu-id="e5de7-138">These settings include information such as the physical location of the audio jack the device type, the jack subtype, and detection capabilities so that the system can determine whether the device is plugged in.</span></span> <span data-ttu-id="e5de7-139">En extrayant ces valeurs de l’appareil, le système d’exploitation détermine le rôle à attribuer à l’appareil.</span><span class="sxs-lookup"><span data-stu-id="e5de7-139">By retrieving these values from the device, the operating system determines the role to assign to the device.</span></span> <span data-ttu-id="e5de7-140">Dans ce scénario, le système a interrogé le périphérique du casque USB, a effectué la détection automatique des rôles et a décidé que l’appareil est le mieux adapté pour être un appareil de communication.</span><span class="sxs-lookup"><span data-stu-id="e5de7-140">In this scenario, the system has queried the USB headset device, performed automatic role detection, and decided that the device is best suited to be a communication device.</span></span>

<span data-ttu-id="e5de7-141">Une application peut également recevoir des informations de Jack à l’aide des API audio de base.</span><span class="sxs-lookup"><span data-stu-id="e5de7-141">An application can also get jack information by using the Core Audio APIs.</span></span> <span data-ttu-id="e5de7-142">Pour plus d’informations, consultez [**IKsJackDescription**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription) et [**IKsJackDescription2**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2).</span><span class="sxs-lookup"><span data-stu-id="e5de7-142">For more information, see [**IKsJackDescription**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription) and [**IKsJackDescription2**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2).</span></span>

## <a name="related-topics"></a><span data-ttu-id="e5de7-143">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e5de7-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e5de7-144">Rôles d’appareil</span><span class="sxs-lookup"><span data-stu-id="e5de7-144">Device Roles</span></span>](device-roles.md)
</dt> </dl>

 

 



