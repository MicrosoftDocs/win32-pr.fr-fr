---
description: Implémentation de IWICBitmapEncoder
ms.assetid: b671e941-ded6-4bde-bc4d-461f13feade0
title: Implémentation de IWICBitmapEncoder
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 590dffcf762d22155a89a8143994d9a4d8bcab02
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103867334"
---
# <a name="implementing-iwicbitmapencoder"></a><span data-ttu-id="13f11-103">Implémentation de IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="13f11-103">Implementing IWICBitmapEncoder</span></span>

-   [<span data-ttu-id="13f11-104">IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="13f11-104">IWICBitmapEncoder</span></span>](#implementing-iwicbitmapencoder)
    -   [<span data-ttu-id="13f11-105">Initialiser</span><span class="sxs-lookup"><span data-stu-id="13f11-105">Initialize</span></span>](#initialize)
    -   [<span data-ttu-id="13f11-106">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="13f11-106">GetContainerFormat</span></span>](#getcontainerformat)
    -   [<span data-ttu-id="13f11-107">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="13f11-107">GetEncoderInfo</span></span>](#getencoderinfo)
    -   [<span data-ttu-id="13f11-108">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="13f11-108">CreateNewFrame</span></span>](#createnewframe)
    -   [<span data-ttu-id="13f11-109">Commiter</span><span class="sxs-lookup"><span data-stu-id="13f11-109">Commit</span></span>](#commit)
    -   [<span data-ttu-id="13f11-110">SetPreview</span><span class="sxs-lookup"><span data-stu-id="13f11-110">SetPreview</span></span>](#setpreview)
-   [<span data-ttu-id="13f11-111">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="13f11-111">Related topics</span></span>](#related-topics)

## <a name="iwicbitmapencoder"></a><span data-ttu-id="13f11-112">IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="13f11-112">IWICBitmapEncoder</span></span>

-   [<span data-ttu-id="13f11-113">Initialiser</span><span class="sxs-lookup"><span data-stu-id="13f11-113">Initialize</span></span>](#initialize)
-   [<span data-ttu-id="13f11-114">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="13f11-114">GetContainerFormat</span></span>](#getcontainerformat)
-   [<span data-ttu-id="13f11-115">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="13f11-115">GetEncoderInfo</span></span>](#getencoderinfo)
-   [<span data-ttu-id="13f11-116">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="13f11-116">CreateNewFrame</span></span>](#createnewframe)
-   [<span data-ttu-id="13f11-117">Commiter</span><span class="sxs-lookup"><span data-stu-id="13f11-117">Commit</span></span>](#commit)
-   [<span data-ttu-id="13f11-118">SetPreview</span><span class="sxs-lookup"><span data-stu-id="13f11-118">SetPreview</span></span>](#setpreview)

<span data-ttu-id="13f11-119">Cette interface est l’équivalent de l’interface [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) et est le point de départ pour l’encodage d’un fichier image.</span><span class="sxs-lookup"><span data-stu-id="13f11-119">This interface is the counterpart to the [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) interface and is the starting point for encoding an image file.</span></span> <span data-ttu-id="13f11-120">Tout comme **IWICBitmapDecoder** est utilisé pour récupérer des propriétés au niveau du conteneur et des frames individuels à partir du conteneur d’images, [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) est utilisé pour définir les propriétés au niveau du conteneur et sérialiser les trames d’image individuelles dans le conteneur.</span><span class="sxs-lookup"><span data-stu-id="13f11-120">Just as **IWICBitmapDecoder** is used for retrieving container-level properties and individual frames from the image container, [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) is used for setting container-level properties and serializing individual image frames into the container.</span></span> <span data-ttu-id="13f11-121">Vous implémentez cette interface sur votre classe d’encodeur au niveau du conteneur.</span><span class="sxs-lookup"><span data-stu-id="13f11-121">You implement this interface on your container-level encoder class.</span></span>

``` syntax
interface IWICBitmapEncoder : public IUnknown
{
   // Required methods
   HRESULT Initialize ( IStream *pIStream,
              WICBitmapEncoderCacheOption cacheOption );
   HRESULT GetContainerFormat ( GUID *pguidContainerFormat );
   HRESULT GetEncoderInfo ( IWICBitmapEncoderInfo **pIEncoderInfo );
   HRESULT CreateNewFrame ( IWICBitmapFrameEncode **ppIFrameEncode,
              IPropertyBag2 **ppIEncoderOptions );
   HRESULT Commit ( void );

   // Optional methods
   HRESULT SetPreview ( IWICBitmapSource *pIPreview );
   HRESULT SetThumbnail ( IWICBitmapSource *pIThumbnail );
   HRESULT SetColorContexts ( UINT cCount,
              IWICColorContext **ppIColorContext );
   HRESULT GetMetadataQueryWriter ( IWICMetadataQueryWriter 
              **ppIMetadataQueryWriter );
   HRESULT SetPalette ( IWICPalette *pIPalette);
};
```

<span data-ttu-id="13f11-122">Comme nous l’avons vu dans [implémentation de IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md), certains formats d’image ont des miniatures globales, des contextes de couleur ou des métadonnées, tandis que de nombreux formats d’image les fournissent uniquement pour chaque image.</span><span class="sxs-lookup"><span data-stu-id="13f11-122">As discussed in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md), some image formats have global thumbnails, color contexts, or metadata, while many image formats provide these only on a per-frame basis.</span></span> <span data-ttu-id="13f11-123">Par conséquent, les méthodes de définition de ces options sont facultatives sur [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder), mais elles sont requises sur [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode).</span><span class="sxs-lookup"><span data-stu-id="13f11-123">Therefore, the methods for setting these are optional on [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder), but are required on [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode).</span></span> <span data-ttu-id="13f11-124">Nous allons aborder les méthodes facultatives sur **IWICBitmapEncoder** dans la section sur **IWICBitmapFrameEncode**, où elles sont le plus souvent implémentées.</span><span class="sxs-lookup"><span data-stu-id="13f11-124">We’ll discuss the methods that are optional on **IWICBitmapEncoder** in the section on **IWICBitmapFrameEncode**, where they’re most commonly implemented.</span></span>

<span data-ttu-id="13f11-125">Si vous ne prenez pas en charge les miniatures globales, retournez WINCODEC \_ Err \_ CODECNOTHUMBNAIL à partir de la méthode SetThumbnail sur [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder).</span><span class="sxs-lookup"><span data-stu-id="13f11-125">If you don’t support global thumbnails, return WINCODEC\_ERR\_CODECNOTHUMBNAIL from the SetThumbnail method on [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder).</span></span> <span data-ttu-id="13f11-126">Si vous ne prenez pas en charge une palette au niveau du conteneur, ou si l’image que vous encodez n’a pas de format indexé, retournez WINCODEC \_ Err \_ PALETTEUNAVAILABLE à partir de la méthode SetPalette.</span><span class="sxs-lookup"><span data-stu-id="13f11-126">If you don’t support a container-level palette, or if the image you are encoding doesn’t have an indexed format, return WINCODEC\_ERR\_PALETTEUNAVAILABLE from the SetPalette method.</span></span> <span data-ttu-id="13f11-127">Pour toute autre méthode non prise en charge, retournez WINCODEC \_ Err \_ UNSUPPORTEDOPERATION.</span><span class="sxs-lookup"><span data-stu-id="13f11-127">For any other unsupported methods, return WINCODEC\_ERR\_UNSUPPORTEDOPERATION.</span></span>

### <a name="initialize"></a><span data-ttu-id="13f11-128">Initialiser</span><span class="sxs-lookup"><span data-stu-id="13f11-128">Initialize</span></span>

<span data-ttu-id="13f11-129">[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize) est la première méthode appelée sur un [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) une fois qu’elle a été instanciée.</span><span class="sxs-lookup"><span data-stu-id="13f11-129">[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize) is the first method invoked on an [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) after it has been instantiated.</span></span> <span data-ttu-id="13f11-130">Un flux d’image est passé à l’encodeur et un appelant peut éventuellement spécifier une option de cache.</span><span class="sxs-lookup"><span data-stu-id="13f11-130">An image stream is passed to the encoder, and a caller may optionally specify a cache option.</span></span> <span data-ttu-id="13f11-131">Dans le cas du décodeur, le flux est en lecture seule, mais le flux passé à un encodeur est un flux accessible en écriture, dans lequel l’encodeur sérialise toutes les données et métadonnées de l’image.</span><span class="sxs-lookup"><span data-stu-id="13f11-131">In the case of the decoder, the stream is read-only, but the stream passed to an encoder is a writeable stream, into which the encoder will serialize all of the image data and metadata.</span></span> <span data-ttu-id="13f11-132">Les options de cache sur l’encodeur sont également différentes.</span><span class="sxs-lookup"><span data-stu-id="13f11-132">The cache options on the encoder are different as well.</span></span>

``` syntax
enum WICBitmapEncoderCacheOption
{
   WICBitmapEncoderCacheInMemory,
   WICBitmapEncoderCacheTempFile,
   WICBitmapEncoderNoCache
}
```

<span data-ttu-id="13f11-133">L’application a la possibilité de demander à l’encodeur de mettre en cache les données de l’image en mémoire, de les mettre en cache dans un fichier temporaire ou de les écrire directement dans le fichier de disque sans mise en cache.</span><span class="sxs-lookup"><span data-stu-id="13f11-133">The application has a choice of requesting the encoder to cache the image data in memory, cache it in a temporary file, or to write it directly into the disk file with no caching.</span></span> <span data-ttu-id="13f11-134">Lorsque vous êtes invité à mettre en cache les données dans un fichier temporaire, l’encodeur doit créer un fichier temporaire sur le disque et écrire directement dans ce fichier sans mise en cache en mémoire.</span><span class="sxs-lookup"><span data-stu-id="13f11-134">When asked to cache the data in a temporary file, the encoder should create a temporary file on disk and write directly to that file without caching in memory.</span></span> <span data-ttu-id="13f11-135">Lorsque l’appelant sélectionne l’option no cache, chaque frame doit être validé dans l’ordre avant de pouvoir créer le frame suivant.</span><span class="sxs-lookup"><span data-stu-id="13f11-135">When the caller selects the no cache option, each frame must be committed in order before the next frame can be created.</span></span>

### <a name="getcontainerformat"></a><span data-ttu-id="13f11-136">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="13f11-136">GetContainerFormat</span></span>

<span data-ttu-id="13f11-137">[**GetContainerFormat**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getcontainerformat) est implémenté de la même façon que la méthode [GetContainerFormat](-wic-imp-iwicbitmapdecoder.md) lors de l' [implémentation de IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md).</span><span class="sxs-lookup"><span data-stu-id="13f11-137">[**GetContainerFormat**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getcontainerformat) is implemented the same way as the [GetContainerFormat](-wic-imp-iwicbitmapdecoder.md) method in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md).</span></span>

### <a name="getencoderinfo"></a><span data-ttu-id="13f11-138">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="13f11-138">GetEncoderInfo</span></span>

<span data-ttu-id="13f11-139">[**GetEncoderInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getencoderinfo) retourne un objet [**IWICBitmapEncoderInfo**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapencoderinfo) .</span><span class="sxs-lookup"><span data-stu-id="13f11-139">[**GetEncoderInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getencoderinfo) returns an [**IWICBitmapEncoderInfo**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapencoderinfo) object.</span></span> <span data-ttu-id="13f11-140">Pour obtenir l’objet **IWICBitmapEncoderInfo** , il vous suffit de transmettre le GUID de votre encodeur à la méthode [**CreateComponentInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentinfo) sur [**IWICImagingFactory**](/windows/desktop/api/Wincodec/nn-wincodec-iwicimagingfactory), puis de demander l’interface **IWICBitmapEncoderInfo** .</span><span class="sxs-lookup"><span data-stu-id="13f11-140">To get the **IWICBitmapEncoderInfo** object, just pass the GUID of your encoder to the [**CreateComponentInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentinfo) method on [**IWICImagingFactory**](/windows/desktop/api/Wincodec/nn-wincodec-iwicimagingfactory), and then request the **IWICBitmapEncoderInfo** interface on it.</span></span>

<span data-ttu-id="13f11-141">Consultez l’exemple dans [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md) sous [GetDecoderInfo](-wic-imp-iwicbitmapdecoder.md).</span><span class="sxs-lookup"><span data-stu-id="13f11-141">See the example in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md) under [GetDecoderInfo](-wic-imp-iwicbitmapdecoder.md).</span></span>

### <a name="createnewframe"></a><span data-ttu-id="13f11-142">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="13f11-142">CreateNewFrame</span></span>

<span data-ttu-id="13f11-143">[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) est l’équivalent de l’encodeur de [**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) sur [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder).</span><span class="sxs-lookup"><span data-stu-id="13f11-143">[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) is the encoder counterpart of [**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) on [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder).</span></span> <span data-ttu-id="13f11-144">Cette méthode retourne un objet [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) , qui est l’objet qui sérialise réellement les données d’image pour un frame spécifique dans le conteneur.</span><span class="sxs-lookup"><span data-stu-id="13f11-144">This method returns an [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) object, which is the object that actually serializes the image data for a specific frame within the container.</span></span>

<span data-ttu-id="13f11-145">L’un des avantages de Windows Imaging Component (WIC) est qu’il fournit une couche d’abstraction pour les applications qui leur permet de fonctionner avec tous les formats d’image de la même façon.</span><span class="sxs-lookup"><span data-stu-id="13f11-145">One of the benefits of Windows Imaging Component (WIC) is that it provides a layer of abstraction for applications that enables them to work with all image formats in the same way.</span></span> <span data-ttu-id="13f11-146">Toutefois, tous les formats d’image ne sont pas exactement identiques.</span><span class="sxs-lookup"><span data-stu-id="13f11-146">However, not all image formats are exactly the same.</span></span> <span data-ttu-id="13f11-147">Certains formats d’image ont des fonctionnalités que d’autres n’ont pas.</span><span class="sxs-lookup"><span data-stu-id="13f11-147">Some image formats have capabilities that others don’t have.</span></span> <span data-ttu-id="13f11-148">Pour que les applications puissent tirer parti de ces fonctionnalités uniques, il est nécessaire de fournir un moyen de les exposer au codec.</span><span class="sxs-lookup"><span data-stu-id="13f11-148">For applications to be able to take advantage of those unique capabilities, it’s necessary to provide a way for the codec to expose them.</span></span> <span data-ttu-id="13f11-149">C’est l’objectif des options de l’encodeur.</span><span class="sxs-lookup"><span data-stu-id="13f11-149">This is the purpose of encoder options.</span></span> <span data-ttu-id="13f11-150">Si votre CODEC prend en charge les options de l’encodeur, vous devez créer un objet [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) qui expose les options d’encodeur que vous prenez en charge et le retourner dans le paramètre *ppIEncoderOptions* de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="13f11-150">If your codec supports any encoder options, you should create an [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) object that exposes the encoder options you support, and return it in the *ppIEncoderOptions* parameter of this method.</span></span> <span data-ttu-id="13f11-151">L’appelant peut ensuite utiliser cet objet IPropertyBag2 pour déterminer les options de codeur prises en charge par votre codec.</span><span class="sxs-lookup"><span data-stu-id="13f11-151">The caller can then use this IPropertyBag2 object to determine what encoder options your codec supports.</span></span> <span data-ttu-id="13f11-152">Si l’appelant souhaite spécifier des valeurs pour l’une des options d’encodeur prises en charge, il assignera la valeur à la propriété appropriée dans l’objet IPropertyBag2 et la passera à l’objet [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) nouvellement créé dans sa méthode Initialize.</span><span class="sxs-lookup"><span data-stu-id="13f11-152">If the caller wants to specify values for any of the supported encoder options, they will assign the value to the relevant property in the IPropertyBag2 object and pass it to the newly created [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) object in its Initialize method.</span></span>

<span data-ttu-id="13f11-153">Pour instancier un objet [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) , vous devez d’abord créer un struct PROPBAG2 pour spécifier chaque option d’encodeur prise en charge par votre encodeur et son type de données pour chaque propriété.</span><span class="sxs-lookup"><span data-stu-id="13f11-153">To instantiate an [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) object, you first need to create a PROPBAG2 struct to specify each encoder option your encoder supports and its data type for each property.</span></span> <span data-ttu-id="13f11-154">Vous devez ensuite implémenter un objet IPropertyBag2 qui applique les plages de valeurs pour chaque propriété lors de l’écriture, et rapproche toutes les valeurs en conflit ou en chevauchement.</span><span class="sxs-lookup"><span data-stu-id="13f11-154">Then you must implement an IPropertyBag2 object that enforces the value ranges for each property on write, and reconciles any conflicting or overlapping values.</span></span> <span data-ttu-id="13f11-155">Pour les ensembles simples d’options d’encodeur non conflictuelles, vous pouvez appeler la méthode [**CreateEncoderPropertyBag**](/windows/desktop/api/Wincodecsdk/nf-wincodecsdk-iwiccomponentfactory-createencoderpropertybag) , qui créera un objet IPropertyBag2 simple à l’aide des propriétés que vous spécifiez dans votre struct PROPBAG2.</span><span class="sxs-lookup"><span data-stu-id="13f11-155">For simple sets of non-conflicting encoder options, you can invoke the [**CreateEncoderPropertyBag**](/windows/desktop/api/Wincodecsdk/nf-wincodecsdk-iwiccomponentfactory-createencoderpropertybag) method, which will create a simple IPropertyBag2 object using the properties you specify in your PROPBAG2 struct.</span></span> <span data-ttu-id="13f11-156">Vous devez toujours appliquer les plages de valeurs.</span><span class="sxs-lookup"><span data-stu-id="13f11-156">You must still enforce the value ranges.</span></span> <span data-ttu-id="13f11-157">Pour obtenir des options d’encodeur plus avancées, ou si vous devez rapprocher des valeurs conflictuelles, vous devez écrire votre propre implémentation de IPropertyBag2.</span><span class="sxs-lookup"><span data-stu-id="13f11-157">For more advanced encoder options, or if you need to reconcile conflicting values, you should write your own IPropertyBag2 implementation.</span></span>


```C++
UINT cuiPropertyCount = 0;
IPropertyBag2* pPropertyBag = NULL;
PROPBAG2* pPropBagOptions;
HRESULT hr;

// Insert code here to initialize piPropertyBag with the 
// supported options for your encoder, and to initialize 
// cuiPropertyCount to the number of encoder option properties
// you are exposing.
...

hr = pComponentFactory->CreateEncoderPropertyBag( 
   pPropBagOptions, cuiPropertyCount, &pPropertyBag);
```



<span data-ttu-id="13f11-158">WIC fournit un petit ensemble d’options de codeur canoniques utilisées par certains formats d’image courants.</span><span class="sxs-lookup"><span data-stu-id="13f11-158">WIC provides a small set of canonical encoder options that are used by some of the common image formats.</span></span> <span data-ttu-id="13f11-159">Toutes les options de codeur canoniques sont facultatives, et les codecs ne sont pas nécessaires pour prendre en charge l’un d’eux.</span><span class="sxs-lookup"><span data-stu-id="13f11-159">All of the canonical encoder options are optional, and codecs are not required to support any of them.</span></span> <span data-ttu-id="13f11-160">La raison pour laquelle elles sont fournies en tant qu’options canoniques est que de nombreuses applications exposent l’interface utilisateur pour que les utilisateurs spécifient ces options lors de l’enregistrement d’un fichier image dans un format qui les prend en charge.</span><span class="sxs-lookup"><span data-stu-id="13f11-160">The reason they are provided as canonical options is because many applications expose the user interface for users to specify these options when saving an image file in a format that supports them.</span></span> <span data-ttu-id="13f11-161">Le fait de fournir une méthode canonique de spécification de ces options permet aux applications de les communiquer facilement aux encodeurs de manière cohérente.</span><span class="sxs-lookup"><span data-stu-id="13f11-161">Providing a canonical way to specify these options makes it easy for applications to communicate them to encoders in a consistent way.</span></span> <span data-ttu-id="13f11-162">Les options de codeur canoniques sont répertoriées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="13f11-162">The canonical encoder options are listed in the following table.</span></span>



| <span data-ttu-id="13f11-163">Option d’encodeur</span><span class="sxs-lookup"><span data-stu-id="13f11-163">Encoder Option</span></span>     | <span data-ttu-id="13f11-164">VARTYPE</span><span class="sxs-lookup"><span data-stu-id="13f11-164">VARTYPE</span></span>  | <span data-ttu-id="13f11-165">Plage de valeurs</span><span class="sxs-lookup"><span data-stu-id="13f11-165">Value Range</span></span>               |
|--------------------|----------|---------------------------|
| <span data-ttu-id="13f11-166">Lossless</span><span class="sxs-lookup"><span data-stu-id="13f11-166">Lossless</span></span>           | <span data-ttu-id="13f11-167">VT \_ bool</span><span class="sxs-lookup"><span data-stu-id="13f11-167">VT\_BOOL</span></span> | <span data-ttu-id="13f11-168">Vrai/Faux</span><span class="sxs-lookup"><span data-stu-id="13f11-168">True/False</span></span>                |
| <span data-ttu-id="13f11-169">ImageQuality</span><span class="sxs-lookup"><span data-stu-id="13f11-169">ImageQuality</span></span>       | <span data-ttu-id="13f11-170">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="13f11-170">VT\_R4</span></span>   | <span data-ttu-id="13f11-171">0.0-1.0</span><span class="sxs-lookup"><span data-stu-id="13f11-171">0.0-1.0</span></span>                   |
| <span data-ttu-id="13f11-172">CompressionQuality</span><span class="sxs-lookup"><span data-stu-id="13f11-172">CompressionQuality</span></span> | <span data-ttu-id="13f11-173">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="13f11-173">VT\_R4</span></span>   | <span data-ttu-id="13f11-174">0.0-1.0</span><span class="sxs-lookup"><span data-stu-id="13f11-174">0.0-1.0</span></span>                   |
| <span data-ttu-id="13f11-175">BitmapTransform</span><span class="sxs-lookup"><span data-stu-id="13f11-175">BitmapTransform</span></span>    | <span data-ttu-id="13f11-176">\_UI1 VT</span><span class="sxs-lookup"><span data-stu-id="13f11-176">VT\_UI1</span></span>  | <span data-ttu-id="13f11-177">WICBitmapTransformOptions</span><span class="sxs-lookup"><span data-stu-id="13f11-177">WICBitmapTransformOptions</span></span> |



 

<span data-ttu-id="13f11-178">Si votre CODEC prend en charge l’encodage sans perte, vous devez exposer l’option d’encodeur sans perte comme un moyen pour les applications de demander qu’une image soit encodée sans perte de code.</span><span class="sxs-lookup"><span data-stu-id="13f11-178">If your codec supports lossless encoding, you should expose the Lossless encoder option as a way for applications to request that an image be losslessly encoded.</span></span> <span data-ttu-id="13f11-179">Si un appelant affecte la valeur true à cette propriété, vous devez ignorer l’option ImageQuality et encoder l’image sans perte.</span><span class="sxs-lookup"><span data-stu-id="13f11-179">If a caller sets this property to True, you should ignore the ImageQuality option and encode the image losslessly.</span></span>

<span data-ttu-id="13f11-180">L’option ImageQuality permet à une application de spécifier le degré de fidélité avec lequel encoder l’image.</span><span class="sxs-lookup"><span data-stu-id="13f11-180">The ImageQuality option allows an application to specify the degree of fidelity with which to encode the image.</span></span> <span data-ttu-id="13f11-181">Cette option permet à un utilisateur de faire un compromis entre la qualité de l’image et la vitesse et/ou la taille du fichier.</span><span class="sxs-lookup"><span data-stu-id="13f11-181">This option lets a user make a tradeoff between image quality versus speed and/or file size.</span></span> <span data-ttu-id="13f11-182">JPEG est un exemple de format d’image qui prend en charge ce compromis.</span><span class="sxs-lookup"><span data-stu-id="13f11-182">JPEG is an example of an image format that supports this tradeoff.</span></span> <span data-ttu-id="13f11-183">Une valeur de 0,0 indique que la fidélité est faible et que l’encodeur doit utiliser l’algorithme le plus perdu.</span><span class="sxs-lookup"><span data-stu-id="13f11-183">A value of 0.0 indicates that fidelity is of low importance and the encoder should use its most lossy algorithm.</span></span> <span data-ttu-id="13f11-184">Une valeur de 1,0 indique que la fidélité est la plus importante et que l’encodeur doit préserver la fidélité la plus élevée possible.</span><span class="sxs-lookup"><span data-stu-id="13f11-184">A value of 1.0 indicates that fidelity is the most important and the encoder should preserve the highest fidelity possible.</span></span> <span data-ttu-id="13f11-185">(En fonction de votre codec, cela peut être synonyme de l’option Lossless.</span><span class="sxs-lookup"><span data-stu-id="13f11-185">(Depending on your codec, this may be synonymous with the Lossless option.</span></span> <span data-ttu-id="13f11-186">Toutefois, si votre CODEC prend en charge l’encodage sans perte, et si l’option Lossless est définie sur true, l’option ImageQuality doit être ignorée.)</span><span class="sxs-lookup"><span data-stu-id="13f11-186">However, if your codec supports lossless encoding, and if the Lossless option is set to True, the ImageQuality option should be ignored.)</span></span>

<span data-ttu-id="13f11-187">L’option CompressionQuality permet à une application de spécifier l’efficacité de la compression à utiliser lors de l’encodage de l’image.</span><span class="sxs-lookup"><span data-stu-id="13f11-187">The CompressionQuality option allows an application to specify the efficiency of compression to use when encoding the image.</span></span> <span data-ttu-id="13f11-188">Un algorithme très efficace peut produire un fichier image plus petit avec la même qualité qu’un algorithme de compression moins efficace, mais peut nécessiter plus de temps pour l’encodage.</span><span class="sxs-lookup"><span data-stu-id="13f11-188">A very efficient algorithm may produce a smaller image file with the same quality as a less efficient compression algorithm, but may take longer to encode.</span></span> <span data-ttu-id="13f11-189">Cette option permet à un utilisateur de spécifier un compromis entre la taille de fichier et la vitesse d’encodage, tout en conservant le même niveau de qualité.</span><span class="sxs-lookup"><span data-stu-id="13f11-189">This option lets a user specify a tradeoff between file size versus speed of encoding, while preserving the same level of quality.</span></span> <span data-ttu-id="13f11-190">TIFF est un exemple de format d’image qui prend en charge ce compromis.</span><span class="sxs-lookup"><span data-stu-id="13f11-190">TIFF is an example of an image format that supports this tradeoff.</span></span> <span data-ttu-id="13f11-191">(Notez qu’un format tel que JPEG prend en charge différents niveaux de compression, mais un taux de compression plus élevé entraîne une qualité d’image inférieure.</span><span class="sxs-lookup"><span data-stu-id="13f11-191">(Note that a format such as JPEG supports different levels of compression, but a higher rate of compression results in lower image quality.</span></span> <span data-ttu-id="13f11-192">Par conséquent, un format d’image JPEG expose l’option ImageQuality au lieu de l’option CompressionQuality.) Une valeur de 0,0 pour cette option indique que vous devez compresser l’image aussi rapidement que possible, sans réduire la fidélité, au détriment d’une plus grande taille de fichier.</span><span class="sxs-lookup"><span data-stu-id="13f11-192">Therefore, a JPEG image format would expose the ImageQuality option rather than the CompressionQuality option.) A value of 0.0 for this option indicates that you should compress the image as quickly as possible, without reducing fidelity, at the expense of a larger file size.</span></span> <span data-ttu-id="13f11-193">Une valeur de 1,0 indique que vous devez créer la plus petite taille de fichier possible (au même niveau de qualité), quel que soit le temps qu’il peut prendre pour l’encoder.</span><span class="sxs-lookup"><span data-stu-id="13f11-193">A value of 1.0 indicates that you should create the smallest possible file size (at the same level of quality), regardless of how long it may take to encode it.</span></span> <span data-ttu-id="13f11-194">Un codec peut prendre en charge à la fois l’option ImageQuality et l’option CompressionQuality, où l’option ImageQuality spécifie le degré acceptable de lossiness, tandis que l’option CompressionQuality offre un compromis entre la taille et la vitesse au niveau de qualité spécifié.</span><span class="sxs-lookup"><span data-stu-id="13f11-194">A codec can support both the ImageQuality option and the CompressionQuality option, where the ImageQuality option specifies the acceptable degree of lossiness, and the CompressionQuality option offers a size/speed tradeoff at the specified quality level.</span></span>

<span data-ttu-id="13f11-195">L’option BitmapTransform permet à l’appelant de spécifier un angle de rotation ou un sens de retournement vertical ou horizontal lors de l’encodage.</span><span class="sxs-lookup"><span data-stu-id="13f11-195">The BitmapTransform option provides a way for the caller to specify a rotation angle or vertical or horizontal flip orientation when encoding.</span></span> <span data-ttu-id="13f11-196">L’énumération WICBitmapTransformOptions utilisée pour spécifier la transformation demandée est identique à celle utilisée lors de la demande d’une transformation pendant le décodage via l’interface IWICBitmapSourceTransform.</span><span class="sxs-lookup"><span data-stu-id="13f11-196">The WICBitmapTransformOptions enum used to specify the requested transform is the same enum used when requesting a transform during decoding through the IWICBitmapSourceTransform interface.</span></span>

<span data-ttu-id="13f11-197">Notez que les encodeurs ne sont pas limités aux options d’encodeur canoniques.</span><span class="sxs-lookup"><span data-stu-id="13f11-197">Note that encoders are not limited to the canonical encoder options.</span></span> <span data-ttu-id="13f11-198">L’objectif des options de codeur est de permettre aux encodeurs d’exposer leurs fonctionnalités, et il n’existe aucune limite aux types de fonctionnalités que vous pouvez exposer.</span><span class="sxs-lookup"><span data-stu-id="13f11-198">The purpose of encoder options is to enable encoders to expose their capabilities, and there is no limit to the types of capabilities you can expose.</span></span> <span data-ttu-id="13f11-199">Assurez-vous que les options de votre encodeur sont bien documentées.</span><span class="sxs-lookup"><span data-stu-id="13f11-199">Make sure your encoder options are well-documented.</span></span> <span data-ttu-id="13f11-200">Même si une application peut utiliser le jeu de propriétés que vous retournez à partir de cette méthode pour découvrir les noms, les types et les plages de valeurs pour les options que vous prenez en charge, le seul moyen de déterminer leurs significations, ou comment les exposer dans l’interface utilisateur, provient de votre documentation.</span><span class="sxs-lookup"><span data-stu-id="13f11-200">Even though an application can use the property bag you return from this method to discover the names, types, and value ranges for the options you support, the only way for them to find out their meanings, or how to expose them in the user interface, is from your documentation.</span></span>

### <a name="commit"></a><span data-ttu-id="13f11-201">Commit</span><span class="sxs-lookup"><span data-stu-id="13f11-201">Commit</span></span>

<span data-ttu-id="13f11-202">La [**validation**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit) est la méthode que vous appelez après que toutes les données et métadonnées de l’image ont été sérialisées dans le flux.</span><span class="sxs-lookup"><span data-stu-id="13f11-202">[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit) is the method you call after all the image data and metadata have been serialized into the stream.</span></span> <span data-ttu-id="13f11-203">Vous devez utiliser cette méthode pour sérialiser les données d’image d’aperçu dans le flux, ainsi que les miniatures globales, les métadonnées, la palette ou d’autres éléments, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="13f11-203">You should use this method to serialize the Preview image data into the stream, and any global thumbnails, metadata, palette, or other items, if applicable.</span></span> <span data-ttu-id="13f11-204">Cette méthode ne doit pas fermer le flux de fichier, car l’application qui a ouvert le flux est censée la fermer.</span><span class="sxs-lookup"><span data-stu-id="13f11-204">This method should not close the file stream, because the application that opened the stream is expected to close it.</span></span>

<span data-ttu-id="13f11-205">La section sur la méthode IWICBitmapFrameEncode : Commit contient des détails sur la façon dont les IWICBitmapEncoderCacheOptions affectent le comportement de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="13f11-205">The section on the IWICBitmapFrameEncode:Commit method has details on how the IWICBitmapEncoderCacheOptions affect the behavior of this method.</span></span>

### <a name="setpreview"></a><span data-ttu-id="13f11-206">SetPreview</span><span class="sxs-lookup"><span data-stu-id="13f11-206">SetPreview</span></span>

<span data-ttu-id="13f11-207">[**SetPreview**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-setpreview) est utilisé pour créer un aperçu de l’image.</span><span class="sxs-lookup"><span data-stu-id="13f11-207">[**SetPreview**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-setpreview) is used to create a preview of the image.</span></span> <span data-ttu-id="13f11-208">Bien qu’il ne soit pas strictement nécessaire que chaque image ait une version préliminaire, elle est fortement recommandée.</span><span class="sxs-lookup"><span data-stu-id="13f11-208">While it is not strictly required that every image have a preview, it is highly recommended.</span></span> <span data-ttu-id="13f11-209">Les scanneurs et appareils photo numériques modernes génèrent des images de haute résolution, qui ont tendance à être très volumineuses et, par conséquent, prennent un temps de traitement important pour le décodage.</span><span class="sxs-lookup"><span data-stu-id="13f11-209">Modern digital cameras and scanners generate very high resolution images, which tend to be very large and, consequently, take significant processing time to decode.</span></span> <span data-ttu-id="13f11-210">Les images de la prochaine génération de caméras seront encore plus volumineuses.</span><span class="sxs-lookup"><span data-stu-id="13f11-210">Images from the next generation of cameras will be even larger.</span></span> <span data-ttu-id="13f11-211">Il est judicieux de fournir une version plus petite et plus basse pour une image, généralement au format JPEG, qui peut être rapidement décodée et affichée « instantanément » lorsqu’un utilisateur la demande.</span><span class="sxs-lookup"><span data-stu-id="13f11-211">It’s a good idea to provide a smaller, lower resolution version of an image, typically in JPEG format, that can be quickly decoded and displayed “instantly” when a user requests it.</span></span> <span data-ttu-id="13f11-212">Une application peut demander une préversion avant de demander l’image réelle à décoder pour fournir une meilleure expérience aux utilisateurs, et leur montrer une représentation de la taille de l’image à l’écran pendant que theyare attend de décoder l’image réelle.</span><span class="sxs-lookup"><span data-stu-id="13f11-212">An application may request a preview before requesting the actual image to be decoded to provide a better experience for users, and show them a screen-size representation of the image while theyare waiting to decode the actual image.</span></span> <span data-ttu-id="13f11-213">Bien que les codecs doivent fournir des préversions, les codecs qui ne prennent pas en charge [**IWICBitmapSourceTransform**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsourcetransform) doivent absolument le faire.</span><span class="sxs-lookup"><span data-stu-id="13f11-213">Although codecs should provide previews, codecs that do not support [**IWICBitmapSourceTransform**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsourcetransform) should definitely do so.</span></span>

<span data-ttu-id="13f11-214">Si vous fournissez une version préliminaire JPEG, vous n’êtes pas obligé d’écrire un encodeur JPEG pour l’encoder.</span><span class="sxs-lookup"><span data-stu-id="13f11-214">If you provide a JPEG preview, you don’t have to write a JPEG encoder to encode it.</span></span> <span data-ttu-id="13f11-215">Vous devez déléguer à l’encodeur JPEG fourni avec la plateforme WIC pour encoder les miniatures et les aperçus.</span><span class="sxs-lookup"><span data-stu-id="13f11-215">You should delegate to the JPEG encoder that ships with the WIC platform for encoding both previews and thumbnails.</span></span>

## <a name="related-topics"></a><span data-ttu-id="13f11-216">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="13f11-216">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="13f11-217">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="13f11-217">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="13f11-218">**IWICBitmapEncoder**</span><span class="sxs-lookup"><span data-stu-id="13f11-218">**IWICBitmapEncoder**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)
</dt> <dt>

[<span data-ttu-id="13f11-219">**IWICBitmapFrameEncode**</span><span class="sxs-lookup"><span data-stu-id="13f11-219">**IWICBitmapFrameEncode**</span></span>](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)
</dt> <dt>

<span data-ttu-id="13f11-220">**Méthodologique**</span><span class="sxs-lookup"><span data-stu-id="13f11-220">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="13f11-221">Interfaces d’encodeur</span><span class="sxs-lookup"><span data-stu-id="13f11-221">Encoder Interfaces</span></span>](-wic-encoderinterfaces.md)
</dt> <dt>

[<span data-ttu-id="13f11-222">Implémentation de IWICBitmapCodecProgressNotification (encodeur)</span><span class="sxs-lookup"><span data-stu-id="13f11-222">Implementing IWICBitmapCodecProgressNotification (Encoder)</span></span>](-wic-imp-iwicbitmapcodecprogressnotification-encoder.md)
</dt> <dt>

[<span data-ttu-id="13f11-223">Comment écrire un CODEC WIC-Enabled</span><span class="sxs-lookup"><span data-stu-id="13f11-223">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> <dt>

[<span data-ttu-id="13f11-224">Vue d’ensemble du composant Windows Imaging</span><span class="sxs-lookup"><span data-stu-id="13f11-224">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> </dl>

 

 
