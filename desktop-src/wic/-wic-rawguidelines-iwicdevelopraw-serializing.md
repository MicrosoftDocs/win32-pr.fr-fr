---
description: Instructions d’implémentation pour la sérialisation des paramètres IWICDevelopRaw
ms.assetid: 4ecff5cc-24f3-4b89-b681-85c867b053e7
title: Instructions d’implémentation pour la sérialisation des paramètres IWICDevelopRaw
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 48cdc78f68e6d63ee7870b9296ae4cfa4f85547a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103758295"
---
# <a name="implementation-guidelines-for-serializing-iwicdevelopraw-settings"></a><span data-ttu-id="355ae-103">Instructions d’implémentation pour la sérialisation des paramètres IWICDevelopRaw</span><span class="sxs-lookup"><span data-stu-id="355ae-103">Implementation Guidelines for Serializing IWICDevelopRaw Settings</span></span>

<span data-ttu-id="355ae-104">L’interface [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) expose les paramètres que l’application peut utiliser pour modifier le traitement de l’image brute.</span><span class="sxs-lookup"><span data-stu-id="355ae-104">The [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) interface exposes settings that the application can use to modify the processing of the RAW image.</span></span> <span data-ttu-id="355ae-105">Les paramètres doivent pouvoir être sérialisés afin d’être conservés entre les sessions.</span><span class="sxs-lookup"><span data-stu-id="355ae-105">The settings should be able to be serialized so that they persist across sessions.</span></span> <span data-ttu-id="355ae-106">Bien que cette opération puisse être effectuée de plusieurs façons, il est recommandé d’encoder ces données d’une manière qui est cohérente avec d’autres métadonnées.</span><span class="sxs-lookup"><span data-stu-id="355ae-106">Although this can be done in several ways, it is recommended to encode this data in a manner that is consistent with other metadata.</span></span>

<span data-ttu-id="355ae-107">Voici quelques recommandations générales en matière d’implémentation :</span><span class="sxs-lookup"><span data-stu-id="355ae-107">The following are some general implementation guidelines:</span></span>

-   <span data-ttu-id="355ae-108">Tous les paramètres effectués via [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) (par exemple, rotation ou balance des blancs) doivent éviter le remplacement du paramètre d’appareil photo ou des données « à la capture », sauf si la balise est couramment utilisée comme « paramètre actuel ».</span><span class="sxs-lookup"><span data-stu-id="355ae-108">Any settings made via [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) (such as rotation or white balance) should avoid overwriting camera setting or "as-shot" data unless the tag is commonly used as a "current setting."</span></span> <span data-ttu-id="355ae-109">Par exemple, les balises d’orientation EXIF peuvent être utilisées pour conserver la rotation.</span><span class="sxs-lookup"><span data-stu-id="355ae-109">For example, EXIF orientation tags can be used to persist rotation.</span></span>
-   <span data-ttu-id="355ae-110">Il est préférable de ne pas avoir à enregistrer la totalité du fichier (y compris les données de pixels de la mosaïque) chaque fois que les paramètres [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) sont demandés pour être sérialisés.</span><span class="sxs-lookup"><span data-stu-id="355ae-110">It is preferable not to have to save the entire file (including the mosaic pixel data) each time that the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) settings are asked to be serialized.</span></span>
-   <span data-ttu-id="355ae-111">Le processus de sérialisation des paramètres [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) suit généralement cet ordre d’événements.</span><span class="sxs-lookup"><span data-stu-id="355ae-111">The process of serializing [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) settings will generally follow this order of events.</span></span> <span data-ttu-id="355ae-112">L’application :</span><span class="sxs-lookup"><span data-stu-id="355ae-112">The application:</span></span>

    1.  <span data-ttu-id="355ae-113">Instancie une [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) sur un fichier brut.</span><span class="sxs-lookup"><span data-stu-id="355ae-113">Instantiates an [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) on a RAW file.</span></span>
    2.  <span data-ttu-id="355ae-114">Appelle [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder)::[**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) pour obtenir un [**IWICBitmapFrameDecode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframedecode) pour le frame brut.</span><span class="sxs-lookup"><span data-stu-id="355ae-114">Calls [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder)::[**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) to get an [**IWICBitmapFrameDecode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframedecode) for the RAW frame.</span></span>
    3.  <span data-ttu-id="355ae-115">Appelle QueryInterface sur l’interface IWICBitmapFrameDecode pour l’interface IWICDevelopRaw.</span><span class="sxs-lookup"><span data-stu-id="355ae-115">Calls QueryInterface on the IWICBitmapFrameDecode interface for the IWICDevelopRaw interface.</span></span>
    4.  <span data-ttu-id="355ae-116">Appelle [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**GetCurrentParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-getcurrentparameterset), qui retourne une interface IPropertyBag2 avec toutes les propriétés actuelles stockées dans celui-ci.</span><span class="sxs-lookup"><span data-stu-id="355ae-116">Calls [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**GetCurrentParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-getcurrentparameterset), which returns an IPropertyBag2 interface with all of the current properties stored in it.</span></span>

        <span data-ttu-id="355ae-117">À ce stade du processus, l’objectif est de sérialiser les paramètres de l’interface IPropertyBag2 dans le fichier brut.</span><span class="sxs-lookup"><span data-stu-id="355ae-117">At this point of the process, the goal is to serialize the settings in the IPropertyBag2 interface into the RAW file.</span></span> <span data-ttu-id="355ae-118">Pour ce faire, vous devez utiliser un encodeur, et ainsi de suite, qui est détaillé dans les étapes suivantes.</span><span class="sxs-lookup"><span data-stu-id="355ae-118">To do so requires spinning up an encoder and so on, which is detailed in the following steps.</span></span>

    5.  <span data-ttu-id="355ae-119">Crée un [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) pour le fichier brut.</span><span class="sxs-lookup"><span data-stu-id="355ae-119">Creates an [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) for the RAW file.</span></span>
    6.  <span data-ttu-id="355ae-120">Appelle [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), en passant un nouveau flux (vide) à encoder.</span><span class="sxs-lookup"><span data-stu-id="355ae-120">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), passing in a new (blank) stream to encode.</span></span>
    7.  <span data-ttu-id="355ae-121">Appelle [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) pour créer un IWICBITMAPFRAMEENCODE pour le frame brut.</span><span class="sxs-lookup"><span data-stu-id="355ae-121">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) to create a new IWICBitmapFrameEncode for the RAW frame.</span></span>
    8.  <span data-ttu-id="355ae-122">Appelle [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize)et passe dans l’interface IPropertyBag2 de l’étape 4.</span><span class="sxs-lookup"><span data-stu-id="355ae-122">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), and passes in the IPropertyBag2 interface from step 4.</span></span>
    9.  <span data-ttu-id="355ae-123">Appelle [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**WriteSource**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapframeencode-writesource) avec [**IWICBitmapSource**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsource) à partir du cadre d’image brute du décodeur.</span><span class="sxs-lookup"><span data-stu-id="355ae-123">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**WriteSource**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapframeencode-writesource) with [**IWICBitmapSource**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsource) from decoder's RAW image frame.</span></span>
    10. <span data-ttu-id="355ae-124">Appelle [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span><span class="sxs-lookup"><span data-stu-id="355ae-124">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span></span> <span data-ttu-id="355ae-125">Le codec sérialise ensuite les propriétés dans le IPropertyBag2 de l’étape 8 dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="355ae-125">The codec then serializes the properties in the IPropertyBag2 from step 8 into the file.</span></span> <span data-ttu-id="355ae-126">La méthode la plus courante pour sérialiser les propriétés est supposée être en les écrivant sous forme de métadonnées dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="355ae-126">The most common method of serializing the properties is assumed to be by writing them out as metadata in the file.</span></span>
    11. <span data-ttu-id="355ae-127">Appelle [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span><span class="sxs-lookup"><span data-stu-id="355ae-127">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span></span>
    12. <span data-ttu-id="355ae-128">Appelle IStream :: commit sur le flux à l’étape 6.</span><span class="sxs-lookup"><span data-stu-id="355ae-128">Calls IStream::Commit on the stream in step 6.</span></span>

    <span data-ttu-id="355ae-129">Les paramètres sont sérialisés dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="355ae-129">The settings are serialized in the file.</span></span>

    <span data-ttu-id="355ae-130">Cette méthode entraîne le coût de la réécriture de l’intégralité du fichier brut chaque fois que les paramètres sont sérialisés.</span><span class="sxs-lookup"><span data-stu-id="355ae-130">This method does incur the cost of rewriting the entire RAW file each time the settings are serialized.</span></span> <span data-ttu-id="355ae-131">Cela peut être évité si vous implémentez [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) ou si votre format de fichier image prend en charge XMP ou EXIF, car WIC fournit des [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) pour ces deux formats.</span><span class="sxs-lookup"><span data-stu-id="355ae-131">This can be avoided if you implement [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) or if your image file format supports XMP or EXIF, as WIC provides [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) for both of these formats.</span></span> <span data-ttu-id="355ae-132">En outre, si votre codec écrit des modifications à la fin du fichier image, vous n’aurez pas à réécrire la totalité du fichier image.</span><span class="sxs-lookup"><span data-stu-id="355ae-132">Also, if your codec writes changes to the end of the image file, then you won't end up rewriting the entire image file.</span></span>

-   <span data-ttu-id="355ae-133">Les jeux de paramètres sont chargés à partir de l’État sérialisé lorsque l’application définit l’énumération [**WICRawParameterSet. WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) sur la méthode [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**LoadParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-loadparameterset) .</span><span class="sxs-lookup"><span data-stu-id="355ae-133">Parameter sets are loaded from the serialized state when the application sets the [**WICRawParameterSet.WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) enumeration on the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**LoadParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-loadparameterset) method.</span></span> <span data-ttu-id="355ae-134">L’indicateur [**WICRawParameterSet. WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) fait référence au dernier jeu de paramètres enregistré. par conséquent, une charge avec cet indicateur doit entraîner la restauration des paramètres au dernier état enregistré.</span><span class="sxs-lookup"><span data-stu-id="355ae-134">The [**WICRawParameterSet.WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) flag refers to the last-saved parameter set, so a load with this flag should result in restoring parameters to the last-saved state.</span></span>
-   <span data-ttu-id="355ae-135">Lors du chargement initial, le dernier jeu de paramètres enregistré doit être chargé, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="355ae-135">Upon initial load, the last-saved parameter set should be loaded, if available.</span></span> <span data-ttu-id="355ae-136">Si ce n’est pas le cas, les paramètres « As-Shot » doivent être utilisés comme présélections sur les variables de l’interface [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) .</span><span class="sxs-lookup"><span data-stu-id="355ae-136">If not, then the "as-shot" settings should be used as presets on the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) interface variables.</span></span> <span data-ttu-id="355ae-137">Ces paramètres de prise en charge peuvent également être chargés à l’aide de l’indicateur [**WICRawParameterSet. WICAsShotParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) .</span><span class="sxs-lookup"><span data-stu-id="355ae-137">These as-shot settings can also be loaded by using the [**WICRawParameterSet.WICAsShotParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) flag.</span></span>
-   <span data-ttu-id="355ae-138">L’identificateur [**WICRawParameterSet. WICAutoAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) est destiné à représenter un paramètre « Auto ».</span><span class="sxs-lookup"><span data-stu-id="355ae-138">The identifier [**WICRawParameterSet.WICAutoAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) is meant to represent an "Auto" setting.</span></span> <span data-ttu-id="355ae-139">Le concepteur de codec peut choisir l’une des méthodes suivantes pour définir les paramètres [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) lorsque ce paramètre est défini :</span><span class="sxs-lookup"><span data-stu-id="355ae-139">The codec designer can elect any of the following approaches on how to set [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) parameters when this setting is made:</span></span>

    -   <span data-ttu-id="355ae-140">Effectuez une optimisation algorithmique de certains paramètres, tels que l’exposition ou la couleur.</span><span class="sxs-lookup"><span data-stu-id="355ae-140">Perform an algorithmic optimization of some parameters, such as exposure or color.</span></span> <span data-ttu-id="355ae-141">Il s’agit de la façon dont les fonctions automatiques dans les éditeurs d’images classiques sont basées principalement sur l’analyse des données en pixels.</span><span class="sxs-lookup"><span data-stu-id="355ae-141">This is how Auto functions in typical image editors and is based primarily on pixel data analysis.</span></span>
    -   <span data-ttu-id="355ae-142">Définissez les paramètres de l’appareil photo comme s’il s’agissait d’un paramètre automatique.</span><span class="sxs-lookup"><span data-stu-id="355ae-142">Set camera settings similar to how an Auto setting would have behaved.</span></span> <span data-ttu-id="355ae-143">Cela est utile si l’image a été capturée sur un paramètre manuel et permet à l’utilisateur de remplacer les paramètres manuels.</span><span class="sxs-lookup"><span data-stu-id="355ae-143">This is useful if the image was shot on a Manual setting and allows the user to override manual settings.</span></span>
    -   <span data-ttu-id="355ae-144">Ne rien faire.</span><span class="sxs-lookup"><span data-stu-id="355ae-144">Do nothing.</span></span> <span data-ttu-id="355ae-145">Tous les contrôles ne doivent pas être définis lorsque l’option auto est sélectionnée et il est possible de ne pas modifier les paramètres.</span><span class="sxs-lookup"><span data-stu-id="355ae-145">Not all controls need to be set when Auto is selected, and it is OK to leave settings unchanged.</span></span>

<span data-ttu-id="355ae-146">Les outils de la Galerie de photos Windows Vista et de la Galerie de photos Windows Live, ainsi que d’autres applications de modification, utilisent la charge de paramètre automatique [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) quand l’utilisateur sélectionne la correction automatique pour tous les réglages de contrôle de codec normaux, tels que la couleur et l’exposition, pour obtenir les meilleurs résultats.</span><span class="sxs-lookup"><span data-stu-id="355ae-146">The Windows Vista Photo Gallery and Windows Live Photo Gallery editing tools and other editing applications use the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) Auto parameter load when the user selects Auto Correct for all normal codec control adjustments such as color and exposure to get the best results.</span></span>

## <a name="related-topics"></a><span data-ttu-id="355ae-147">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="355ae-147">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="355ae-148">**Méthodologique**</span><span class="sxs-lookup"><span data-stu-id="355ae-148">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="355ae-149">Vue d’ensemble du composant Windows Imaging</span><span class="sxs-lookup"><span data-stu-id="355ae-149">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> <dt>

[<span data-ttu-id="355ae-150">Recommandations de WIC pour les formats d’image RAW Camera</span><span class="sxs-lookup"><span data-stu-id="355ae-150">WIC Guidelines for Camera RAW Image Formats</span></span>](-wic-rawguidelines.md)
</dt> <dt>

[<span data-ttu-id="355ae-151">Comment écrire un CODEC WIC-Enabled</span><span class="sxs-lookup"><span data-stu-id="355ae-151">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> </dl>

 

 



