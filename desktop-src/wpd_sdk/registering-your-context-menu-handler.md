---
description: Inscription de votre gestionnaire de menu contextuel
ms.assetid: 0023004b-b6b3-486a-8b8c-8e63c5731206
title: Inscription de votre gestionnaire de menu contextuel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aafd2798683b4bc291653bca34996f143fc36842
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106533968"
---
# <a name="registering-your-context-menu-handler"></a><span data-ttu-id="42e4f-103">Inscription de votre gestionnaire de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="42e4f-103">Registering Your Context Menu Handler</span></span>

<span data-ttu-id="42e4f-104">Pour que votre gestionnaire de menu contextuel soit reconnu par l’espace de noms WPD, vous devez l’inscrire correctement dans le Registre Windows.</span><span class="sxs-lookup"><span data-stu-id="42e4f-104">In order for your context menu handler to be recognized by the WPD namespace you must register it properly in the Windows registry.</span></span> <span data-ttu-id="42e4f-105">Les entrées d’inscription pour un gestionnaire de menu contextuel WPD sont similaires à celles de l’interpréteur de commandes, mais elles sont inscrites en tant que types de fichier spéciaux.</span><span class="sxs-lookup"><span data-stu-id="42e4f-105">The registration entries for a WPD context menu handler are similar to those for the shell, but they are registered as special file types.</span></span> <span data-ttu-id="42e4f-106">Les gestionnaires de menus contextuels WPD sont inscrits en fonction du type de contenu qu’ils représentent.</span><span class="sxs-lookup"><span data-stu-id="42e4f-106">WPD context menu handlers are registered according to the content type they represent.</span></span> <span data-ttu-id="42e4f-107">Voici un exemple d’arborescence d’inscription pour un gestionnaire de menu contextuel WPD :</span><span class="sxs-lookup"><span data-stu-id="42e4f-107">Below is a sample registration tree for a WPD context menu handler:</span></span>


```C++
HKEY_CLASSES_ROOT
 \-- WPDContextMenu.Image
      \-- shellex
           \-- ContextMenuHandlers
                \-- ShImageViewer (Default)  REG_SZ {E847DA7C-1D6A-45F6-B725-CB260C236066}

```



<span data-ttu-id="42e4f-108">L’exemple ci-dessus inscrit la visionneuse d’images de Shell avec l’espace de noms WPD.</span><span class="sxs-lookup"><span data-stu-id="42e4f-108">The above example registers the shell image viewer with the WPD namespace.</span></span> <span data-ttu-id="42e4f-109">Quand un utilisateur clique avec le bouton droit ou double-clique sur du contenu sur un appareil via l’interpréteur de commandes Windows Vista, il appelle ce gestionnaire de menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="42e4f-109">When a user right-clicks or double-clicks content on a device through the Windows Vista Shell, it invokes this context menu handler.</span></span> <span data-ttu-id="42e4f-110">L’espace de noms WPD utilise le \_ \_ type de contenu wpd pour déterminer les gestionnaires de menus contextuels à charger.</span><span class="sxs-lookup"><span data-stu-id="42e4f-110">The WPD namespace uses WPD\_CONTENT\_TYPE to determine which context menu handlers to load.</span></span> <span data-ttu-id="42e4f-111">Si le type de contenu wpd \_ \_ est égal au \_ type de contenu wpd \_ \_ non spécifié, le type de contenu wpd \_ ou le \_ \_ \_ \_ programme de type de contenu wpd \_ \_ , l’espace de noms wpd tente de trouver la meilleure correspondance en fonction de l’extension du fichier sélectionné.</span><span class="sxs-lookup"><span data-stu-id="42e4f-111">If WPD\_CONTENT\_TYPE is equal to WPD\_CONTENT\_TYPE\_UNSPECIFIED, WPD\_CONTENT\_TYPE\_GENERIC\_FILE or WPD\_CONTENT\_TYPE\_PROGRAM, then the WPD namespace will try to find the best match based on the extension of the selected file.</span></span> <span data-ttu-id="42e4f-112">Si ni l’extension de fichier ni le type de contenu n’offrent une classification utile, l’espace de noms WPD chargera les gestionnaires de menus contextuels sous la clé de Registre **WPDContextMenu. Generic** .</span><span class="sxs-lookup"><span data-stu-id="42e4f-112">If neither the file extension nor the content type provides a useful classification, the WPD namespace will load the context menu handlers under the **WPDContextMenu.Generic** registry key.</span></span> <span data-ttu-id="42e4f-113">Le tableau suivant répertorie toutes les classes de fichiers disponibles pour un gestionnaire de menu contextuel, ainsi que les types de contenu et les extensions de fichier qu’ils représentent :</span><span class="sxs-lookup"><span data-stu-id="42e4f-113">The following table lists all of the file classes available to a context menu handler and what content types and file extensions they represent:</span></span>



| <span data-ttu-id="42e4f-114">Clé de Registre</span><span class="sxs-lookup"><span data-stu-id="42e4f-114">Registry Key</span></span>                           | <span data-ttu-id="42e4f-115">Type de contenu WPD</span><span class="sxs-lookup"><span data-stu-id="42e4f-115">WPD Content Type</span></span>                                                                                               | <span data-ttu-id="42e4f-116">Extension de fichier</span><span class="sxs-lookup"><span data-stu-id="42e4f-116">File Extension</span></span>                                                                                           |
|----------------------------------------|----------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="42e4f-117">**WPDContextMenu. appareil**</span><span class="sxs-lookup"><span data-stu-id="42e4f-117">**WPDContextMenu.Device**</span></span>              | <span data-ttu-id="42e4f-118">L’inscription sous cette clé active votre gestionnaire de menu contextuel au niveau de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="42e4f-118">Registering under this key enables your context menu handler at the device level.</span></span> <span data-ttu-id="42e4f-119">(Cliquez avec le bouton droit sur un appareil).</span><span class="sxs-lookup"><span data-stu-id="42e4f-119">(Right-click on a device.)</span></span>   | <span data-ttu-id="42e4f-120">(N/A)</span><span class="sxs-lookup"><span data-stu-id="42e4f-120">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="42e4f-121">**WPDContextMenu. Storage**</span><span class="sxs-lookup"><span data-stu-id="42e4f-121">**WPDContextMenu.Storage**</span></span>             | <span data-ttu-id="42e4f-122">L’inscription sous cette clé active votre gestionnaire de menu contextuel au niveau du stockage.</span><span class="sxs-lookup"><span data-stu-id="42e4f-122">Registering under this key enables your context menu handler at the storage level.</span></span> <span data-ttu-id="42e4f-123">(Cliquez avec le bouton droit sur un stockage.)</span><span class="sxs-lookup"><span data-stu-id="42e4f-123">(Right-click on a storage.)</span></span> | <span data-ttu-id="42e4f-124">(N/A)</span><span class="sxs-lookup"><span data-stu-id="42e4f-124">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="42e4f-125">**WPDContextMenu. dossier**</span><span class="sxs-lookup"><span data-stu-id="42e4f-125">**WPDContextMenu.Folder**</span></span>              | <span data-ttu-id="42e4f-126">\_dossier de \_ type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-126">WPD\_CONTENT\_TYPE\_FOLDER</span></span>                                                                                     | <span data-ttu-id="42e4f-127">(N/A)</span><span class="sxs-lookup"><span data-stu-id="42e4f-127">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="42e4f-128">**WPDContextMenu. image**</span><span class="sxs-lookup"><span data-stu-id="42e4f-128">**WPDContextMenu.Image**</span></span>               | <span data-ttu-id="42e4f-129">\_image de \_ type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-129">WPD\_CONTENT\_TYPE\_IMAGE</span></span>                                                                                      | <span data-ttu-id="42e4f-130">.bmp</span><span class="sxs-lookup"><span data-stu-id="42e4f-130">.bmp</span></span> <br/> <span data-ttu-id="42e4f-131">.gif</span><span class="sxs-lookup"><span data-stu-id="42e4f-131">.gif</span></span> <br/> <span data-ttu-id="42e4f-132">.png</span><span class="sxs-lookup"><span data-stu-id="42e4f-132">.png</span></span> <br/> <span data-ttu-id="42e4f-133">.jpg</span><span class="sxs-lookup"><span data-stu-id="42e4f-133">.jpg</span></span> <br/> <span data-ttu-id="42e4f-134">.jpe</span><span class="sxs-lookup"><span data-stu-id="42e4f-134">.jpe</span></span> <br/> <span data-ttu-id="42e4f-135">.jpeg</span><span class="sxs-lookup"><span data-stu-id="42e4f-135">.jpeg</span></span> <br/>   |
| <span data-ttu-id="42e4f-136">**WPDContextMenu. audio**</span><span class="sxs-lookup"><span data-stu-id="42e4f-136">**WPDContextMenu.Audio**</span></span>               | <span data-ttu-id="42e4f-137">\_type de contenu wpd \_ \_ audio</span><span class="sxs-lookup"><span data-stu-id="42e4f-137">WPD\_CONTENT\_TYPE\_AUDIO</span></span>                                                                                      | <span data-ttu-id="42e4f-138">.aiff</span><span class="sxs-lookup"><span data-stu-id="42e4f-138">.aiff</span></span> <br/> <span data-ttu-id="42e4f-139">.mp3</span><span class="sxs-lookup"><span data-stu-id="42e4f-139">.mp3</span></span> <br/> <span data-ttu-id="42e4f-140">.wav</span><span class="sxs-lookup"><span data-stu-id="42e4f-140">.wav</span></span> <br/> <span data-ttu-id="42e4f-141">.wma</span><span class="sxs-lookup"><span data-stu-id="42e4f-141">.wma</span></span> <br/>                                     |
| <span data-ttu-id="42e4f-142">**WPDContextMenu. vidéo**</span><span class="sxs-lookup"><span data-stu-id="42e4f-142">**WPDContextMenu.Video**</span></span>               | <span data-ttu-id="42e4f-143">vidéo sur le \_ type de contenu wpd \_ \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-143">WPD\_CONTENT\_TYPE\_VIDEO</span></span>                                                                                      | <span data-ttu-id="42e4f-144">.asf</span><span class="sxs-lookup"><span data-stu-id="42e4f-144">.asf</span></span><br/> <span data-ttu-id="42e4f-145">.avi</span><span class="sxs-lookup"><span data-stu-id="42e4f-145">.avi</span></span> <br/> <span data-ttu-id="42e4f-146">. DVR-MS</span><span class="sxs-lookup"><span data-stu-id="42e4f-146">.dvr-ms</span></span> <br/> <span data-ttu-id="42e4f-147">. MPEG</span><span class="sxs-lookup"><span data-stu-id="42e4f-147">.mpeg</span></span> <br/> <span data-ttu-id="42e4f-148">.mpg</span><span class="sxs-lookup"><span data-stu-id="42e4f-148">.mpg</span></span> <br/> <span data-ttu-id="42e4f-149">.wmv</span><span class="sxs-lookup"><span data-stu-id="42e4f-149">.wmv</span></span> <br/> |
| <span data-ttu-id="42e4f-150">**WPDContextMenu. playlist**</span><span class="sxs-lookup"><span data-stu-id="42e4f-150">**WPDContextMenu.Playlist**</span></span><br/> | <span data-ttu-id="42e4f-151">\_playlist de \_ type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-151">WPD\_CONTENT\_TYPE\_PLAYLIST</span></span>                                                                                   | <span data-ttu-id="42e4f-152">. wpl</span><span class="sxs-lookup"><span data-stu-id="42e4f-152">.wpl</span></span> <br/> <span data-ttu-id="42e4f-153">.m3u</span><span class="sxs-lookup"><span data-stu-id="42e4f-153">.m3u</span></span> <br/> <span data-ttu-id="42e4f-154">.mpl</span><span class="sxs-lookup"><span data-stu-id="42e4f-154">.mpl</span></span> <br/> <span data-ttu-id="42e4f-155">.asx</span><span class="sxs-lookup"><span data-stu-id="42e4f-155">.asx</span></span> <br/> <span data-ttu-id="42e4f-156">. Patientez</span><span class="sxs-lookup"><span data-stu-id="42e4f-156">.pls</span></span> <br/>                     |
| <span data-ttu-id="42e4f-157">**WPDContextMenu.Document**</span><span class="sxs-lookup"><span data-stu-id="42e4f-157">**WPDContextMenu.Document**</span></span>            | <span data-ttu-id="42e4f-158">\_document de \_ type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-158">WPD\_CONTENT\_TYPE\_DOCUMENT</span></span>                                                                                   | <span data-ttu-id="42e4f-159">.doc</span><span class="sxs-lookup"><span data-stu-id="42e4f-159">.doc</span></span> <br/> <span data-ttu-id="42e4f-160">.txt</span><span class="sxs-lookup"><span data-stu-id="42e4f-160">.txt</span></span> <br/> <span data-ttu-id="42e4f-161">.rtf</span><span class="sxs-lookup"><span data-stu-id="42e4f-161">.rtf</span></span> <br/> <span data-ttu-id="42e4f-162">.xls</span><span class="sxs-lookup"><span data-stu-id="42e4f-162">.xls</span></span> <br/> <span data-ttu-id="42e4f-163">.ppt</span><span class="sxs-lookup"><span data-stu-id="42e4f-163">.ppt</span></span> <br/>                     |
| <span data-ttu-id="42e4f-164">**WPDContextMenu. contact**</span><span class="sxs-lookup"><span data-stu-id="42e4f-164">**WPDContextMenu.Contact**</span></span><br/>  | <span data-ttu-id="42e4f-165">\_contact de \_ type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-165">WPD\_CONTENT\_TYPE\_CONTACT</span></span>                                                                                    | <span data-ttu-id="42e4f-166">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-166">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-167">**WPDContextMenu.Email**</span><span class="sxs-lookup"><span data-stu-id="42e4f-167">**WPDContextMenu.Email**</span></span>               | <span data-ttu-id="42e4f-168">\_e-mail de \_ type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-168">WPD\_CONTENT\_TYPE\_EMAIL</span></span>                                                                                      | <span data-ttu-id="42e4f-169">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-169">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-170">**WPDContextMenu. rendez-vous**</span><span class="sxs-lookup"><span data-stu-id="42e4f-170">**WPDContextMenu.Appointment**</span></span>         | <span data-ttu-id="42e4f-171">\_ \_ rendez-vous de type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-171">WPD\_CONTENT\_TYPE\_APPOINTMENT</span></span>                                                                                | <span data-ttu-id="42e4f-172">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-172">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-173">**WPDContextMenu. tâche**</span><span class="sxs-lookup"><span data-stu-id="42e4f-173">**WPDContextMenu.Task**</span></span>                | <span data-ttu-id="42e4f-174">\_tâche de \_ type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-174">WPD\_CONTENT\_TYPE\_TASK</span></span>                                                                                       | <span data-ttu-id="42e4f-175">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-175">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-176">**WPDContextMenu. MEMO**</span><span class="sxs-lookup"><span data-stu-id="42e4f-176">**WPDContextMenu.Memo**</span></span>                | <span data-ttu-id="42e4f-177">\_mémo de \_ type de contenu wpd \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-177">WPD\_CONTENT\_TYPE\_MEMO</span></span>                                                                                       | <span data-ttu-id="42e4f-178">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-178">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-179">**WPDContextMenu.ImageAlbum**</span><span class="sxs-lookup"><span data-stu-id="42e4f-179">**WPDContextMenu.ImageAlbum**</span></span>          | <span data-ttu-id="42e4f-180">\_album d' \_ images de type de contenu wpd \_ \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-180">WPD\_CONTENT\_TYPE\_IMAGE\_ALBUM</span></span>                                                                               | <span data-ttu-id="42e4f-181">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-181">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-182">**WPDContextMenu.AudioAlbum**</span><span class="sxs-lookup"><span data-stu-id="42e4f-182">**WPDContextMenu.AudioAlbum**</span></span>          | <span data-ttu-id="42e4f-183">TYPE de contenu WPD- \_ \_ \_ \_ album audio</span><span class="sxs-lookup"><span data-stu-id="42e4f-183">WPD\_CONTENT\_TYPE\_AUDIO\_ALBUM</span></span>                                                                               | <span data-ttu-id="42e4f-184">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-184">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-185">**WPDContextMenu.VideoAlbum**</span><span class="sxs-lookup"><span data-stu-id="42e4f-185">**WPDContextMenu.VideoAlbum**</span></span>          | <span data-ttu-id="42e4f-186">\_ \_ album vidéo de type de contenu wpd \_ \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-186">WPD\_CONTENT\_TYPE\_VIDEO\_ALBUM</span></span>                                                                               | <span data-ttu-id="42e4f-187">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-187">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-188">**WPDContextMenu.MixedAlbum**</span><span class="sxs-lookup"><span data-stu-id="42e4f-188">**WPDContextMenu.MixedAlbum**</span></span>          | <span data-ttu-id="42e4f-189">TYPE de contenu WPD- \_ \_ \_ album de \_ contenu mixte \_</span><span class="sxs-lookup"><span data-stu-id="42e4f-189">WPD\_CONTENT\_TYPE\_MIXED\_CONTENT\_ALBUM</span></span>                                                                      | <span data-ttu-id="42e4f-190">Aucun</span><span class="sxs-lookup"><span data-stu-id="42e4f-190">None</span></span>                                                                                                     |
| <span data-ttu-id="42e4f-191">**WPDContextMenu. Generic**</span><span class="sxs-lookup"><span data-stu-id="42e4f-191">**WPDContextMenu.Generic**</span></span>             | <span data-ttu-id="42e4f-192">\_type de contenu wpd \_ \_ non spécifié</span><span class="sxs-lookup"><span data-stu-id="42e4f-192">WPD\_CONTENT\_TYPE\_UNSPECIFIED</span></span>                                                                                | <span data-ttu-id="42e4f-193">Toutes les autres extensions de fichier</span><span class="sxs-lookup"><span data-stu-id="42e4f-193">All other file extensions</span></span>                                                                                |



 

 

 




