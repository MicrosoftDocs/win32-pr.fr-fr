---
description: Les verrous SRW (Slim Reader/Writer) activent les threads d’un processus unique pour accéder aux ressources partagées ; ils sont optimisés pour la vitesse et occupent très peu de mémoire.
ms.assetid: 2d439b21-291f-4ff0-910a-c1c27e800019
title: Verrous SRW (Slim Reader/Writer)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe7d76d956e1425531eae43b0daa6817002a92bc
ms.sourcegitcommit: 663239b4560bfd5314e86901c65805c9bbcab07d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/15/2021
ms.locfileid: "106520208"
---
# <a name="slim-readerwriter-srw-locks"></a><span data-ttu-id="f02df-103">Verrous SRW (Slim Reader/Writer)</span><span class="sxs-lookup"><span data-stu-id="f02df-103">Slim Reader/Writer (SRW) Locks</span></span>

<span data-ttu-id="f02df-104">Les verrous SRW (Slim Reader/Writer) activent les threads d’un processus unique pour accéder aux ressources partagées ; ils sont optimisés pour la vitesse et occupent très peu de mémoire.</span><span class="sxs-lookup"><span data-stu-id="f02df-104">Slim reader/writer (SRW) locks enable the threads of a single process to access shared resources; they are optimized for speed and occupy very little memory.</span></span> <span data-ttu-id="f02df-105">Les verrous SRW Reader-Writer ne peuvent pas être partagés entre les processus.</span><span class="sxs-lookup"><span data-stu-id="f02df-105">Slim reader-writer locks cannot be shared across processes.</span></span>

<span data-ttu-id="f02df-106">Les threads de lecture lisent les données d’une ressource partagée, tandis que les threads d’écriture écrivent des données dans une ressource partagée.</span><span class="sxs-lookup"><span data-stu-id="f02df-106">Reader threads read data from a shared resource whereas writer threads write data to a shared resource.</span></span> <span data-ttu-id="f02df-107">Lorsque plusieurs threads lisent et écrivent à l’aide d’une ressource partagée, des verrous exclusifs tels qu’une section critique ou un mutex peuvent devenir un goulot d’étranglement si les threads de lecteur s’exécutent en continu, mais les opérations d’écriture sont rares.</span><span class="sxs-lookup"><span data-stu-id="f02df-107">When multiple threads are reading and writing using a shared resource, exclusive locks such as a critical section or mutex can become a bottleneck if the reader threads run continuously but write operations are rare.</span></span>

<span data-ttu-id="f02df-108">Les verrous SRW fournissent deux modes dans lesquels les threads peuvent accéder à une ressource partagée :</span><span class="sxs-lookup"><span data-stu-id="f02df-108">SRW locks provide two modes in which threads can access a shared resource:</span></span>

-   <span data-ttu-id="f02df-109">**Mode partagé**, qui accorde un accès en lecture seule partagé à plusieurs threads de lecture, ce qui leur permet de lire les données à partir de la ressource partagée simultanément.</span><span class="sxs-lookup"><span data-stu-id="f02df-109">**Shared mode**, which grants shared read-only access to multiple reader threads, which enables them to read data from the shared resource concurrently.</span></span> <span data-ttu-id="f02df-110">Si les opérations de lecture dépassent les opérations d’écriture, cette concurrence augmente les performances et le débit par rapport aux sections critiques.</span><span class="sxs-lookup"><span data-stu-id="f02df-110">If read operations exceed write operations, this concurrency increases performance and throughput compared to critical sections.</span></span>
    > [!NOTE]
    > <span data-ttu-id="f02df-111">Les verrous SRW en mode partagé ne doivent pas être acquis de manière récursive, car cela peut entraîner des blocages lorsqu’ils sont combinés avec l’acquisition exclusive.</span><span class="sxs-lookup"><span data-stu-id="f02df-111">Shared mode SRW locks should not be acquired recursively as this can lead to deadlocks when combined with exclusive acquisition.</span></span>

-   <span data-ttu-id="f02df-112">**Mode exclusif**, qui accorde un accès en lecture/écriture à un thread d’écriture à la fois.</span><span class="sxs-lookup"><span data-stu-id="f02df-112">**Exclusive mode**, which grants read/write access to one writer thread at a time.</span></span> <span data-ttu-id="f02df-113">Lorsque le verrou a été acquis en mode exclusif, aucun autre thread ne peut accéder à la ressource partagée tant que le Writer n’a pas libéré le verrou.</span><span class="sxs-lookup"><span data-stu-id="f02df-113">When the lock has been acquired in exclusive mode, no other thread can access the shared resource until the writer releases the lock.</span></span>
    > [!NOTE]
    > <span data-ttu-id="f02df-114">Les verrous SRW en mode exclusif ne peuvent pas être obtenus de manière récursive.</span><span class="sxs-lookup"><span data-stu-id="f02df-114">Exclusive mode SRW locks cannot be acquired recursively.</span></span> <span data-ttu-id="f02df-115">Si un thread essaie d’acquérir un verrou qu’il détient déjà, cette tentative échoue (pour [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) ou un blocage (pour [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive))</span><span class="sxs-lookup"><span data-stu-id="f02df-115">If a thread tries to acquire a lock that it already holds, that attempt will fail (for [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) or deadlock (for [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive))</span></span>

<span data-ttu-id="f02df-116">Un seul verrou SRW peut être acquis dans l’un ou l’autre mode. les threads de lecture peuvent l’obtenir en mode partagé, tandis que les threads d’écriture peuvent l’acquérir en mode exclusif.</span><span class="sxs-lookup"><span data-stu-id="f02df-116">A single SRW lock can be acquired in either mode; reader threads can acquire it in shared mode whereas writer threads can acquire it in exclusive mode.</span></span> <span data-ttu-id="f02df-117">Il n’existe aucune garantie quant à l’ordre dans lequel les threads qui demandent la propriété auront la propriété. Les verrous SRW ne sont ni équitables ni FIFO.</span><span class="sxs-lookup"><span data-stu-id="f02df-117">There is no guarantee about the order in which threads that request ownership will be granted ownership; SRW locks are neither fair nor FIFO.</span></span>

<span data-ttu-id="f02df-118">Un verrou SRW est la taille d’un pointeur.</span><span class="sxs-lookup"><span data-stu-id="f02df-118">An SRW lock is the size of a pointer.</span></span> <span data-ttu-id="f02df-119">L’avantage est qu’il est rapide de mettre à jour l’état du verrou.</span><span class="sxs-lookup"><span data-stu-id="f02df-119">The advantage is that it is fast to update the lock state.</span></span> <span data-ttu-id="f02df-120">L’inconvénient est que très peu d’informations d’État peuvent être stockées, de sorte que les verrous SRW ne détectent pas une utilisation récursive incorrecte en mode partagé.</span><span class="sxs-lookup"><span data-stu-id="f02df-120">The disadvantage is that very little state information can be stored, so SRW locks do not detect incorrect recursive use in shared mode.</span></span> <span data-ttu-id="f02df-121">En outre, un thread qui possède un verrou SRW en mode partagé ne peut pas mettre à niveau sa propriété du verrou en mode exclusif.</span><span class="sxs-lookup"><span data-stu-id="f02df-121">In addition, a thread that owns an SRW lock in shared mode cannot upgrade its ownership of the lock to exclusive mode.</span></span>

<span data-ttu-id="f02df-122">L’appelant doit allouer une structure SRWLOCK et l’initialiser en appelant [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (pour initialiser la structure dynamiquement) ou affecter la constante **SRWLock \_ init** à la variable de structure (pour initialiser la structure de manière statique).</span><span class="sxs-lookup"><span data-stu-id="f02df-122">The caller must allocate an SRWLOCK structure and initialize it by either calling [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (to initialize the structure dynamically) or assign the constant **SRWLOCK\_INIT** to the structure variable (to initialize the structure statically).</span></span>

<span data-ttu-id="f02df-123">Vous pouvez utiliser [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) pour Rechercher l’utilisation récursive (réentrante) des verrous SRW.</span><span class="sxs-lookup"><span data-stu-id="f02df-123">You can use [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) to find recursive (reentrant) use of SRW locks.</span></span>

<span data-ttu-id="f02df-124">Voici les fonctions de verrouillage SRW.</span><span class="sxs-lookup"><span data-stu-id="f02df-124">The following are the SRW lock functions.</span></span>

| <span data-ttu-id="f02df-125">Fonction de verrouillage SRW</span><span class="sxs-lookup"><span data-stu-id="f02df-125">SRW lock function</span></span>                                                | <span data-ttu-id="f02df-126">Description</span><span class="sxs-lookup"><span data-stu-id="f02df-126">Description</span></span>                                                                                                                                       |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f02df-127">**AcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="f02df-127">**AcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive)       | <span data-ttu-id="f02df-128">Acquiert un verrou SRW en mode exclusif.</span><span class="sxs-lookup"><span data-stu-id="f02df-128">Acquires an SRW lock in exclusive mode.</span></span>                                                                                                           |
| [<span data-ttu-id="f02df-129">**AcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="f02df-129">**AcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockshared)             | <span data-ttu-id="f02df-130">Acquiert un verrou SRW en mode partagé.</span><span class="sxs-lookup"><span data-stu-id="f02df-130">Acquires an SRW lock in shared mode.</span></span>                                                                                                              |
| [<span data-ttu-id="f02df-131">**InitializeSRWLock**</span><span class="sxs-lookup"><span data-stu-id="f02df-131">**InitializeSRWLock**</span></span>](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock)                   | <span data-ttu-id="f02df-132">Initialise un verrou SRW.</span><span class="sxs-lookup"><span data-stu-id="f02df-132">Initialize an SRW lock.</span></span>                                                                                                                           |
| [<span data-ttu-id="f02df-133">**ReleaseSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="f02df-133">**ReleaseSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockexclusive)       | <span data-ttu-id="f02df-134">Libère un verrou SRW qui a été ouvert en mode exclusif.</span><span class="sxs-lookup"><span data-stu-id="f02df-134">Releases an SRW lock that was opened in exclusive mode.</span></span>                                                                                           |
| [<span data-ttu-id="f02df-135">**ReleaseSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="f02df-135">**ReleaseSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockshared)             | <span data-ttu-id="f02df-136">Libère un verrou SRW qui a été ouvert en mode partagé.</span><span class="sxs-lookup"><span data-stu-id="f02df-136">Releases an SRW lock that was opened in shared mode.</span></span>                                                                                              |
| [<span data-ttu-id="f02df-137">**SleepConditionVariableSRW**</span><span class="sxs-lookup"><span data-stu-id="f02df-137">**SleepConditionVariableSRW**</span></span>](/windows/win32/api/synchapi/nf-synchapi-sleepconditionvariablesrw)   | <span data-ttu-id="f02df-138">Met en veille la variable de condition spécifiée et libère le verrou spécifié sous la forme d’une opération atomique.</span><span class="sxs-lookup"><span data-stu-id="f02df-138">Sleeps on the specified condition variable and releases the specified lock as an atomic operation.</span></span>                                                |
| [<span data-ttu-id="f02df-139">**TryAcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="f02df-139">**TryAcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive) | <span data-ttu-id="f02df-140">Tente d’acquérir un verrou SRW (Slim Reader/Writer) en mode exclusif.</span><span class="sxs-lookup"><span data-stu-id="f02df-140">Attempts to acquire a slim reader/writer (SRW) lock in exclusive mode.</span></span> <span data-ttu-id="f02df-141">Si l’appel réussit, le thread appelant prend la propriété du verrou.</span><span class="sxs-lookup"><span data-stu-id="f02df-141">If the call is successful, the calling thread takes ownership of the lock.</span></span> |
| [<span data-ttu-id="f02df-142">**TryAcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="f02df-142">**TryAcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockshared)       | <span data-ttu-id="f02df-143">Tente d’acquérir un verrou SRW (Slim Reader/Writer) en mode partagé.</span><span class="sxs-lookup"><span data-stu-id="f02df-143">Attempts to acquire a slim reader/writer (SRW) lock in shared mode.</span></span> <span data-ttu-id="f02df-144">Si l’appel réussit, le thread appelant prend la propriété du verrou.</span><span class="sxs-lookup"><span data-stu-id="f02df-144">If the call is successful, the calling thread takes ownership of the lock.</span></span>    |

 
