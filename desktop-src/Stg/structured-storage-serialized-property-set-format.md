---
title: Format du jeu de propriétés sérialisées de stockage structuré
description: Les jeux de propriétés persistantes fournissent une option pour stocker les données dans les entités du système de fichiers. Pour les créer et les gérer, il est recommandé d’utiliser les interfaces IPropertySetStorage et IPropertyStorage décrites dans Propriétés et jeux de propriétés.
ms.assetid: f22abe40-535f-4178-9460-59bbe26ff178
keywords:
- Stockage structuré Strctd STG, principes de base, format de jeu de propriétés sérialisé
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ea03d5ccab337897be801840080e83a6fa86880
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106531604"
---
# <a name="structured-storage-serialized-property-set-format"></a><span data-ttu-id="590a4-105">Format du jeu de propriétés sérialisées de stockage structuré</span><span class="sxs-lookup"><span data-stu-id="590a4-105">Structured Storage Serialized Property Set Format</span></span>

<span data-ttu-id="590a4-106">Les jeux de propriétés persistantes fournissent une option pour stocker les données dans les entités du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="590a4-106">Persistent property sets provide an option to store data within file system entities.</span></span> <span data-ttu-id="590a4-107">Pour les créer et les gérer, il est recommandé d’utiliser les interfaces [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) et [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) décrites dans [Propriétés et jeux](properties-and-property-sets.md)de propriétés.</span><span class="sxs-lookup"><span data-stu-id="590a4-107">It is recommended that, to create and manage them, you use the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces described in [Properties and Property Sets](properties-and-property-sets.md).</span></span>

<span data-ttu-id="590a4-108">Les jeux de propriétés sont composés d’une section avec balises de valeurs, avec la section identifiée de façon unique par un identificateur de format (FMTID).</span><span class="sxs-lookup"><span data-stu-id="590a4-108">Property sets are composed of a tagged section of values, with the section uniquely identified by a format identifier (FMTID).</span></span> <span data-ttu-id="590a4-109">Chaque propriété se compose d’un identificateur de propriété et d’un indicateur de type qui représente une valeur.</span><span class="sxs-lookup"><span data-stu-id="590a4-109">Every property consists of a property identifier and a type indicator that represents a value.</span></span> <span data-ttu-id="590a4-110">Chaque valeur stockée dans un jeu de propriétés a un identificateur de propriété unique qui distingue la propriété.</span><span class="sxs-lookup"><span data-stu-id="590a4-110">Each value stored in a property set has a unique property identifier that distinguishes the property.</span></span> <span data-ttu-id="590a4-111">L’indicateur de type décrit la représentation des données dans la valeur.</span><span class="sxs-lookup"><span data-stu-id="590a4-111">The type indicator describes the representation of the data in the value.</span></span>

<span data-ttu-id="590a4-112">Lorsque vous utilisez les interfaces [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) et [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) , vous n’avez pas à gérer la structure de format du jeu de propriétés sérialisé com.</span><span class="sxs-lookup"><span data-stu-id="590a4-112">When you use the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces, you do not have to handle the COM serialized property set format structure.</span></span> <span data-ttu-id="590a4-113">Pour plus d’informations, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="590a4-113">For more information, see the listed topics:</span></span>

<span data-ttu-id="590a4-114">Tous les éléments de données d’un jeu de propriétés sont stockés dans la représentation Intel (c’est-à-dire, dans l’ordre de primauté des octets de poids faible).</span><span class="sxs-lookup"><span data-stu-id="590a4-114">All data elements within a property set are stored in Intel representation (that is, in little-endian byte order).</span></span>

<span data-ttu-id="590a4-115">COM définit un format de données sérialisé standard pour les jeux de propriétés.</span><span class="sxs-lookup"><span data-stu-id="590a4-115">COM defines a standard, serialized data format for property sets.</span></span> <span data-ttu-id="590a4-116">Lors du traitement du format sérialisé, et non avec les interfaces, les jeux de propriétés présentent les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="590a4-116">When handling the serialized format, and not with the interfaces, property sets have the following characteristics:</span></span>

-   <span data-ttu-id="590a4-117">Les jeux de propriétés permettent à différentes applications de créer leurs propres jeux de propriétés indépendants pour servir l’application.</span><span class="sxs-lookup"><span data-stu-id="590a4-117">Property sets allow for different applications to create their own independent property sets to serve the application.</span></span>
-   <span data-ttu-id="590a4-118">Les jeux de propriétés peuvent être stockés dans une instance [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) unique ou dans une instance [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) qui contient plusieurs flux.</span><span class="sxs-lookup"><span data-stu-id="590a4-118">Property sets can be stored in a single [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance or in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance that contains multiple streams.</span></span> <span data-ttu-id="590a4-119">Les jeux de propriétés sont simplement un autre type de données qui peut être stocké dans de nombreuses formes différentes d’un stockage en mémoire ou sur disque.</span><span class="sxs-lookup"><span data-stu-id="590a4-119">Property sets are simply another data type that can be stored in many different forms of an in-memory or on-disk storage.</span></span> <span data-ttu-id="590a4-120">Pour plus d’informations et pour connaître les conventions recommandées pour la création du nom de chaîne pour l’objet de stockage, consultez [conventions d’affectation de noms aux objets de stockage](storage-object-naming-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="590a4-120">For more information and recommended conventions for creating the string name for the storage object, see [Storage Object Naming Conventions](storage-object-naming-conventions.md).</span></span>
-   <span data-ttu-id="590a4-121">Les jeux de propriétés permettent d’inclure un dictionnaire de noms complets qui décrivent le contenu.</span><span class="sxs-lookup"><span data-stu-id="590a4-121">Property sets allow for a dictionary of display names to be included that describe the contents.</span></span> <span data-ttu-id="590a4-122">Il est recommandé d’avoir un ensemble de conventions pour choisir des noms de propriétés.</span><span class="sxs-lookup"><span data-stu-id="590a4-122">A set of conventions for choosing property names is recommended.</span></span> <span data-ttu-id="590a4-123">Pour plus d’informations sur ce dictionnaire facultatif, consultez [identificateurs de propriété réservés](reserved-property-identifiers.md), y compris l' [ID de propriété 0](/windows/desktop/Stg/reserved-property-identifiers).</span><span class="sxs-lookup"><span data-stu-id="590a4-123">For more information about this optional dictionary, see [Reserved Property Identifiers](reserved-property-identifiers.md), including [Property ID 0](/windows/desktop/Stg/reserved-property-identifiers).</span></span>

<span data-ttu-id="590a4-124">Le flux de jeu de propriétés est divisé en trois parties principales :</span><span class="sxs-lookup"><span data-stu-id="590a4-124">The property set stream is divided into three major parts:</span></span>

-   <span data-ttu-id="590a4-125">En-tête</span><span class="sxs-lookup"><span data-stu-id="590a4-125">Header</span></span>
-   <span data-ttu-id="590a4-126">Paire FORMATID/décalage</span><span class="sxs-lookup"><span data-stu-id="590a4-126">FORMATID/offset pair</span></span>
-   <span data-ttu-id="590a4-127">Section contenant les valeurs réelles du jeu de propriétés</span><span class="sxs-lookup"><span data-stu-id="590a4-127">Section containing the actual property set values</span></span>

<span data-ttu-id="590a4-128">La longueur totale du flux de jeu de propriétés doit être inférieure ou égale à 256 Ko.</span><span class="sxs-lookup"><span data-stu-id="590a4-128">The overall length of the property set stream must be less than or equal to 256K.</span></span> <span data-ttu-id="590a4-129">Les sections suivantes, [en-tête de jeu de propriétés](property-set-header.md), [paire identificateur de format/décalage](format-identifier-offset-pair.md)et [section](section.md) (y compris les [identificateurs de propriété/décalage](property-identifiers-offset-pairs.md)), avec les rubriques de prise en charge, décrivent les composants individuels qui composent le format de données de l’ensemble de propriétés.</span><span class="sxs-lookup"><span data-stu-id="590a4-129">The following sections, [Property Set Header](property-set-header.md), [Format Identifier/Offset Pair](format-identifier-offset-pair.md), and [Section](section.md) (including [Property Identifiers/Offset Pairs](property-identifiers-offset-pairs.md)), with supporting topics, describe the individual components that compose the property-set data format.</span></span>

> [!Note]  
> <span data-ttu-id="590a4-130">Les versions précédentes de ce document décrivaient les extensions du flux de jeu de propriétés avec plusieurs sections autorisées, mais qui ont été révisées pour fournir une section dans le flux de propriété.</span><span class="sxs-lookup"><span data-stu-id="590a4-130">Previous versions of this document described extensions to the property set stream with more than one section allowed, but that has been revised to provide for one section in the property stream.</span></span> <span data-ttu-id="590a4-131">La seule exception concerne [les jeux de propriétés DocumentSummaryInformation et UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="590a4-131">The one exception is [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span>

 

 

 