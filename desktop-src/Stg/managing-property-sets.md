---
title: Gestion des jeux de propriétés
description: Un jeu de propriétés persistantes contient des données associées sous forme de propriétés.
ms.assetid: 19ff2751-87f3-43d8-9307-ce2dd399f694
keywords:
- Gestion des jeux de propriétés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af3f9862d3074a5221bf1d5d975754486a562f87
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106512325"
---
# <a name="managing-property-sets"></a><span data-ttu-id="79b63-104">Gestion des jeux de propriétés</span><span class="sxs-lookup"><span data-stu-id="79b63-104">Managing Property Sets</span></span>

<span data-ttu-id="79b63-105">Un jeu de propriétés persistantes contient des données associées sous forme de propriétés.</span><span class="sxs-lookup"><span data-stu-id="79b63-105">A persistent property set contains related data as properties.</span></span> <span data-ttu-id="79b63-106">Chaque jeu de propriétés est identifié par un FMTID et un identificateur global unique (GUID) qui permet aux applications d’accéder au jeu de propriétés, afin d’identifier le jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="79b63-106">Each property set is identified with an FMTID, and a globally unique identifier (GUID) that enables applications, accessing the property set, to identify the property set.</span></span> <span data-ttu-id="79b63-107">Par le biais de cette identification, l’application interprète les propriétés contenues dans le jeu.</span><span class="sxs-lookup"><span data-stu-id="79b63-107">Through this identification, the application interprets the properties that the set contains.</span></span>

<span data-ttu-id="79b63-108">Par exemple, les propriétés de mise en forme des caractères dans un traitement de texte ou les attributs de rendu d’un élément dans un programme de dessin sont des jeux de propriétés.</span><span class="sxs-lookup"><span data-stu-id="79b63-108">For example, the character-formatting properties in a word processor or the rendering attributes of an element in a drawing program are property sets.</span></span>

<span data-ttu-id="79b63-109">COM définit l’interface [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) pour faciliter la gestion des jeux de propriétés.</span><span class="sxs-lookup"><span data-stu-id="79b63-109">COM defines the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to facilitate management of property sets.</span></span> <span data-ttu-id="79b63-110">À l’aide des méthodes de cette interface, vous pouvez créer un nouveau jeu de propriétés ou ouvrir ou supprimer un jeu de propriétés existant.</span><span class="sxs-lookup"><span data-stu-id="79b63-110">Through the methods of this interface, you can create a new property set, or open or delete an existing property set.</span></span> <span data-ttu-id="79b63-111">En outre, il fournit une méthode qui crée un énumérateur et fournit un pointeur vers son interface [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) .</span><span class="sxs-lookup"><span data-stu-id="79b63-111">In addition, it provides a method that creates an enumerator and supplies a pointer to its [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface.</span></span> <span data-ttu-id="79b63-112">Vous pouvez appeler les méthodes de cette interface pour énumérer les structures [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) sur votre objet, ce qui fournit des informations sur tous les jeux de propriétés de l’objet.</span><span class="sxs-lookup"><span data-stu-id="79b63-112">You can call the methods of this interface to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures on your object, which will provide information about all of the property sets on the object.</span></span>

<span data-ttu-id="79b63-113">Lorsque vous créez ou ouvrez une instance de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), elle est semblable à l’ouverture d’un objet qui prend en charge [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) ou [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), car vous devez spécifier le mode de stockage dans lequel vous ouvrez l’interface.</span><span class="sxs-lookup"><span data-stu-id="79b63-113">When you create or open an instance of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), it is similar to opening an object that supports [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), because you need to specify the storage mode in which you are opening the interface.</span></span> <span data-ttu-id="79b63-114">Pour **IStorage**, ceux-ci incluent le mode de transaction, le mode lecture/écriture et le mode de partage.</span><span class="sxs-lookup"><span data-stu-id="79b63-114">For **IStorage**, these include the transaction mode, the read/write mode, and the sharing mode.</span></span>

<span data-ttu-id="79b63-115">Lorsque vous créez un jeu de propriétés à l’aide d’un appel à [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), spécifiez si le jeu de propriétés doit être simple ou non simple.</span><span class="sxs-lookup"><span data-stu-id="79b63-115">When you create a property set with a call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), specify whether the property set is to be simple or nonsimple.</span></span> <span data-ttu-id="79b63-116">Un jeu de propriétés simple contient des types qui peuvent être écrits entièrement dans le flux de jeu de propriétés, dont la taille est limitée, et ne peut pas être supérieur à 256 Ko dans Windows NT 4,0 et versions antérieures, ou 1 Mo dans Windows 2000, Windows XP et Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="79b63-116">A simple property set contains types that can be written fully within the property set stream, which is intended to be limited in size, and can be no larger than 256 KB in Windows NT 4.0 and earlier, or 1 MB in Windows 2000, Windows XP, and Windows Server 2003.</span></span> <span data-ttu-id="79b63-117">Toutefois, lorsque vous avez besoin de stocker une plus grande quantité d’informations dans le jeu de propriétés, vous pouvez spécifier que le jeu de propriétés n’est pas simple.</span><span class="sxs-lookup"><span data-stu-id="79b63-117">However, when you need to store a larger amount of information in the property set, you can specify that the property set be nonsimple.</span></span> <span data-ttu-id="79b63-118">Cela vous permet d’utiliser un ou plusieurs des types qui spécifient uniquement un pointeur vers un objet de stockage ou de flux.</span><span class="sxs-lookup"><span data-stu-id="79b63-118">This allows you to use one or more of the types that specify only a pointer to a storage or stream object.</span></span> <span data-ttu-id="79b63-119">Ces types sont VT \_ Stream, VT \_ streaming Object, VT \_ Storage et VT \_ Stored \_ Object.</span><span class="sxs-lookup"><span data-stu-id="79b63-119">These types are VT\_STREAM, VT\_STREAMED OBJECT, VT\_STORAGE and VT\_STORED\_OBJECT.</span></span>

<span data-ttu-id="79b63-120">Les données stockées dans ces propriétés ne sont pas comptabilisées par rapport à la limite de taille définie pour la propriété 256 KB dans Windows NT 4,0 ou version antérieure, ou la limite de 1 Mo dans Windows 2000, Windows XP et Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="79b63-120">Data stored in these properties is not counted against the 256 KB property-set size limit in Windows NT 4.0 or earlier, or the 1 MB limit in Windows 2000, Windows XP, and Windows Server 2003.</span></span> <span data-ttu-id="79b63-121">Toutefois, les données relatives à la propriété, telles que son nom, s’appliquent.</span><span class="sxs-lookup"><span data-stu-id="79b63-121">However, data about the property, such as its name, does apply.</span></span> <span data-ttu-id="79b63-122">En outre, si vous avez besoin d’une mise à jour avec transaction, le jeu de propriétés doit être insimple.</span><span class="sxs-lookup"><span data-stu-id="79b63-122">Also, if you need a transacted update, the property set must be nonsimple.</span></span> <span data-ttu-id="79b63-123">Il existe, bien sûr, une certaine baisse des performances pour l’ouverture de ces types, car cela nécessite l’ouverture du flux ou de l’objet de stockage auquel vous avez le pointeur.</span><span class="sxs-lookup"><span data-stu-id="79b63-123">There is, of course, a certain performance penalty for opening these types, because it requires opening the stream or storage object to which you have the pointer.</span></span>

<span data-ttu-id="79b63-124">Si votre application utilise des fichiers composés, vous pouvez utiliser l’implémentation fournie par COM de ces interfaces, qui sont implémentées sur l’objet de stockage de fichiers composés COM.</span><span class="sxs-lookup"><span data-stu-id="79b63-124">If your application uses compound files, you can use the COM-provided implementation of these interfaces, which are implemented on the COM compound file storage object.</span></span>

<span data-ttu-id="79b63-125">Chaque jeu de propriétés se compose principalement d’un groupe de propriétés connecté de manière logique, comme décrit dans [gestion des propriétés](managing-properties.md).</span><span class="sxs-lookup"><span data-stu-id="79b63-125">Each property set consists primarily of a logically connected group of properties, as described in [Managing Properties](managing-properties.md).</span></span>

<span data-ttu-id="79b63-126">Pour plus d’informations sur les jeux de propriétés dans COM, consultez :</span><span class="sxs-lookup"><span data-stu-id="79b63-126">For more information about property sets in COM, see:</span></span>

-   [<span data-ttu-id="79b63-127">Implémentations de jeux de propriétés dans COM</span><span class="sxs-lookup"><span data-stu-id="79b63-127">Property Set Implementations in COM</span></span>](property-set-implementations-in-com.md)
-   [<span data-ttu-id="79b63-128">Considérations relatives aux jeux de propriétés</span><span class="sxs-lookup"><span data-stu-id="79b63-128">Property Set Considerations</span></span>](property-set-considerations.md)
-   [<span data-ttu-id="79b63-129">Considérations relatives à l’implémentation de IPropertySetStorage</span><span class="sxs-lookup"><span data-stu-id="79b63-129">IPropertySetStorage Implementation Considerations</span></span>](ipropertysetstorage-implementation-considerations.md)
-   [<span data-ttu-id="79b63-130">Stockage des jeux de propriétés</span><span class="sxs-lookup"><span data-stu-id="79b63-130">Storing Property Sets</span></span>](storing-property-sets.md)
-   [<span data-ttu-id="79b63-131">Caractéristiques de performances</span><span class="sxs-lookup"><span data-stu-id="79b63-131">Performance Characteristics</span></span>](performance-characteristics.md)
-   [<span data-ttu-id="79b63-132">Implémentation du jeu de propriétés d’informations de résumé</span><span class="sxs-lookup"><span data-stu-id="79b63-132">Implementing the Summary Information Property Set</span></span>](implementing-the-summary-information-property-set.md)

 

 