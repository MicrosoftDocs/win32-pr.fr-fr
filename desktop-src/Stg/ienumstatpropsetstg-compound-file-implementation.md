---
title: Implémentation de fichiers IEnumSTATPROPSETSTG-Compound
description: L’implémentation de fichier composé de l’interface IEnumSTATPROPSETSTG est utilisée pour énumérer un tableau de structures STATPROPSETSTG qui contiennent des données de propriété statistiques.
ms.assetid: 1ce36e40-518c-411b-be5a-835a2dd0995e
keywords:
- IEnumSTATPROPSETSTG Strctd STG, implémentation de fichier composé
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9566af1a1956b3a951a996b6198f4a3161680042
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315335"
---
# <a name="ienumstatpropsetstg-compound-file-implementation"></a><span data-ttu-id="5432c-104">Implémentation de fichiers IEnumSTATPROPSETSTG-Compound</span><span class="sxs-lookup"><span data-stu-id="5432c-104">IEnumSTATPROPSETSTG-Compound File Implementation</span></span>

<span data-ttu-id="5432c-105">L’implémentation de fichier composé de l’interface [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) est utilisée pour énumérer un tableau de structures [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) qui contiennent des données de propriété statistiques.</span><span class="sxs-lookup"><span data-stu-id="5432c-105">The compound file implementation of the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface is used to enumerate an array of [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures that contain statistical property data.</span></span> <span data-ttu-id="5432c-106">L’implémentation [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) gère les données statistiques et est associée à un objet de stockage de fichiers composés actuel.</span><span class="sxs-lookup"><span data-stu-id="5432c-106">The [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) implementation manages the statistical data and is associated with a current compound file storage object.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="5432c-107">Quand l’utiliser</span><span class="sxs-lookup"><span data-stu-id="5432c-107">When to Use</span></span>

<span data-ttu-id="5432c-108">Appelez les méthodes de [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) pour énumérer les structures [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , chacune fournissant des données sur l’un des jeux de propriétés associés à l’objet de stockage de fichiers composés.</span><span class="sxs-lookup"><span data-stu-id="5432c-108">Call the methods of [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures, each of which provide data about one of the property sets associated with the compound file storage object.</span></span>

## <a name="remarks"></a><span data-ttu-id="5432c-109">Notes</span><span class="sxs-lookup"><span data-stu-id="5432c-109">Remarks</span></span>

<dl> <dt>

<span data-ttu-id="5432c-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG :: suivant**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span><span class="sxs-lookup"><span data-stu-id="5432c-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span></span>
</dt> <dd>

<span data-ttu-id="5432c-111">Obtient le suivant d’une ou plusieurs structures [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) (le nombre est spécifié par le paramètre *celt* ).</span><span class="sxs-lookup"><span data-stu-id="5432c-111">Gets the next one or more [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures (the number is specified by the *celt* parameter).</span></span> <span data-ttu-id="5432c-112">Les éléments **STATPROPSETSTG** fournis via un appel à l’implémentation de fichier composé de [**IEnumSTATPROPSETSTG :: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) suivent les règles suivantes :</span><span class="sxs-lookup"><span data-stu-id="5432c-112">The **STATPROPSETSTG** elements provided through a call to the compound file implementation of [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) follow these rules:</span></span>

-   <span data-ttu-id="5432c-113">Si [**IEnumSTATPROPSETSTG :: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) ne peut pas fournir STATPROPSETSTG. fmtid, les zéros sont écrits dans ce membre.</span><span class="sxs-lookup"><span data-stu-id="5432c-113">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.fmtid, zeros are written to that member.</span></span> <span data-ttu-id="5432c-114">Cela se produit lorsque le jeu de propriétés n’a pas de nom prédéfini (tel que \\ 005SummaryInformation) et qu’il ne s’agit pas d’une valeur légale.</span><span class="sxs-lookup"><span data-stu-id="5432c-114">This occurs when the property set does not have a predefined name (such as \\005SummaryInformation) and is not a legal value.</span></span>
-   <span data-ttu-id="5432c-115">Le jeu de propriétés DocumentSummaryInformation et UserDefined est spécial, car il peut avoir deux sections de jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5432c-115">The DocumentSummaryInformation and UserDefined property set is special, in that it may have two property set sections.</span></span> <span data-ttu-id="5432c-116">Ce jeu de propriétés est décrit dans la section [jeux de propriétés DocumentSummaryInformation et UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="5432c-116">This property set is described in the section [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span> <span data-ttu-id="5432c-117">La deuxième section s’appelle les propriétés User-Defined.</span><span class="sxs-lookup"><span data-stu-id="5432c-117">The second section is referred to as the User-Defined Properties.</span></span> <span data-ttu-id="5432c-118">Chaque section est identifiée avec un identificateur de format unique (FMTID).</span><span class="sxs-lookup"><span data-stu-id="5432c-118">Each section is identified with a unique format identifier (FMTID).</span></span> <span data-ttu-id="5432c-119">Quand [**IPropertySetStorage :: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) est utilisé pour énumérer des jeux de propriétés, le jeu de propriétés User-Defined n’est pas énuméré.</span><span class="sxs-lookup"><span data-stu-id="5432c-119">When [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) is used to enumerate property sets, the User-Defined property set will not be enumerated.</span></span>

> [!Note]  
> <span data-ttu-id="5432c-120">Si vous créez toujours un jeu de propriétés à l’aide de [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), alors, étant donné qu’un « GUID de caractère » est créé pour le nom de stockage, [**IEnumSTATPROPSETSTG :: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) retourne un fmtid non nul et valide pour le jeu de propriétés \[ STATPROPSETSTG. fmtid \] .</span><span class="sxs-lookup"><span data-stu-id="5432c-120">If you always create a property set using [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), then, because a "Character GUID" is created for the storage name, [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) will return a nonzero, valid FMTID for the property set \[STATPROPSETSTG.fmtid\].</span></span>

 

-   <span data-ttu-id="5432c-121">Le membre STATPROPSETSTG. grfFlags ne reflète pas nécessairement si le jeu de propriétés est ANSI ou non.</span><span class="sxs-lookup"><span data-stu-id="5432c-121">The STATPROPSETSTG.grfFlags member does not necessarily reflect whether the property set is ANSI or not.</span></span> <span data-ttu-id="5432c-122">Si PROPSETFLAG \_ ANSI est défini, le jeu de propriétés est absolument ANSI.</span><span class="sxs-lookup"><span data-stu-id="5432c-122">If PROPSETFLAG\_ANSI is set, the property set is definitely ANSI.</span></span> <span data-ttu-id="5432c-123">Si PROPSETFLAG \_ ANSI est Clear, le jeu de propriétés peut être Unicode ou non-Unicode, car il n’est pas possible de savoir s’il s’agit d’un ANSI sans l’ouvrir.</span><span class="sxs-lookup"><span data-stu-id="5432c-123">If PROPSETFLAG\_ANSI is clear, the property set could be either Unicode or non-Unicode, because it is not possible to tell whether it is ANSI without opening it.</span></span>
-   <span data-ttu-id="5432c-124">Le membre STATPROPSETSTG. grfFlags indique si le jeu de propriétés est simple ou non. par conséquent, le paramètre de l' \_ indicateur PROPSETFLAG non simple est toujours valide.</span><span class="sxs-lookup"><span data-stu-id="5432c-124">The STATPROPSETSTG.grfFlags member does reflect whether the property set is simple or not, so the setting of the PROPSETFLAG\_NONSIMPLE flag is always valid.</span></span>
-   <span data-ttu-id="5432c-125">Si [**IEnumSTATPROPSETSTG :: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) ne peut pas fournir STATPROPSETSTG. CLSID, il est défini sur tous les zéros (CLSID \_ null).</span><span class="sxs-lookup"><span data-stu-id="5432c-125">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.clsid, it is set to all zeroes (CLSID\_NULL).</span></span> <span data-ttu-id="5432c-126">Dans l’implémentation de fichier composé COM, cela se produit lorsque le jeu de propriétés est simple (l' \_ indicateur PROPSETFLAG non simple n’est pas défini) ou n’est pas simple, mais le CLSID n’a pas été défini explicitement.</span><span class="sxs-lookup"><span data-stu-id="5432c-126">In the COM compound file implementation, this occurs when the property set is simple (the PROPSETFLAG\_NONSIMPLE flag is not set), or is nonsimple, but the CLSID was not explicitly set.</span></span> <span data-ttu-id="5432c-127">Pour les jeux de propriétés non simples, le CLSID reçu est celui qui est géré par le [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage)sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="5432c-127">For nonsimple property sets, the CLSID that is received is the one that is maintained by the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage).</span></span>
-   <span data-ttu-id="5432c-128">Si [**IEnumSTATPROPSETSTG :: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) ne peut pas fournir les champs d’heure \[ **ctime**, **mtime**, **atime** \] , chaque heure non prise en charge sera définie sur zéros.</span><span class="sxs-lookup"><span data-stu-id="5432c-128">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide the time fields \[**ctime**, **mtime**, **atime**\], each non-supported time will be set to zeroes.</span></span> <span data-ttu-id="5432c-129">Dans l’implémentation de fichier composé COM, l’obtention de ces valeurs dépend de leur récupération de l’implémentation [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="5432c-129">In the COM compound file implementation, getting these values depends on retrieving them from the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation.</span></span>

</dd> <dt>

<span data-ttu-id="5432c-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG :: Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="5432c-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG::Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="5432c-131">Ignore le nombre d’éléments spécifiés dans *celt*.</span><span class="sxs-lookup"><span data-stu-id="5432c-131">Skips the number of elements specified in *celt*.</span></span> <span data-ttu-id="5432c-132">Retourne S \_ OK si le nombre d’éléments spécifié est ignoré, retourne la \_ valeur false si moins d’éléments que le nombre demandé sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="5432c-132">Returns S\_OK if the specified number of elements are skipped, returns S\_FALSE if fewer elements than requested are skipped.</span></span> <span data-ttu-id="5432c-133">Dans tous les autres cas, retourne l’erreur appropriée.</span><span class="sxs-lookup"><span data-stu-id="5432c-133">In any other case, returns the appropriate error.</span></span>

</dd> <dt>

<span data-ttu-id="5432c-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG :: Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="5432c-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG::Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="5432c-135">Définit le curseur au début de l’énumération.</span><span class="sxs-lookup"><span data-stu-id="5432c-135">Sets the cursor to the beginning of the enumeration.</span></span> <span data-ttu-id="5432c-136">En cas de réussite, retourne S \_ OK ; sinon, retourne STG \_ E \_ INVALIDHANDLE.</span><span class="sxs-lookup"><span data-stu-id="5432c-136">If successful, returns S\_OK, otherwise, returns STG\_E\_INVALIDHANDLE.</span></span>

</dd> <dt>

<span data-ttu-id="5432c-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG :: Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="5432c-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG::Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="5432c-138">Copie l’état d’énumération actuel de cet énumérateur.</span><span class="sxs-lookup"><span data-stu-id="5432c-138">Copies the current enumeration state of this enumerator.</span></span>

</dd> </dl>

 

 