---
title: Méthodes IPaperSink
description: Le présentateur expose l’interface IConnectionPointContainer afin que les clients puissent se connecter au colivre afin de recevoir des notifications d’événements spécifiés qui se produisent dans le codocument.
ms.assetid: 2466c721-b275-4dbc-a604-2d5e6a29d6a1
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ac8dee615b278c5214ad1efa3c10d22759620103
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104199325"
---
# <a name="ipapersink-methods"></a><span data-ttu-id="24677-103">Méthodes IPaperSink</span><span class="sxs-lookup"><span data-stu-id="24677-103">IPaperSink Methods</span></span>

<span data-ttu-id="24677-104">Le présentateur expose l’interface [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) afin que les clients puissent se connecter au colivre afin de recevoir des notifications d’événements spécifiés qui se produisent dans le codocument.</span><span class="sxs-lookup"><span data-stu-id="24677-104">COPaper exposes the [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) interface so clients can connect to COPaper in order to receive notifications of specified events that occur in COPaper.</span></span> <span data-ttu-id="24677-105">En exposant cette interface, le colivre devient un objet connectable.</span><span class="sxs-lookup"><span data-stu-id="24677-105">By exposing this interface, COPaper becomes a connectable object.</span></span> <span data-ttu-id="24677-106">Un client peut appeler [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) pour cette interface et l’utiliser pour obtenir les points de connexion de l’objet.</span><span class="sxs-lookup"><span data-stu-id="24677-106">A client can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for this interface and use it to obtain the object's connection points.</span></span> <span data-ttu-id="24677-107">La participation du client dans ce schéma est traitée dans l’exemple **StoClien** associé.</span><span class="sxs-lookup"><span data-stu-id="24677-107">The client participation in this scheme is covered in the associated **StoClien** sample.</span></span>

<span data-ttu-id="24677-108">Fondamentalement, le client implémente ce qui est appelé récepteur sous la forme d’un objet récepteur avec une interface de récepteur.</span><span class="sxs-lookup"><span data-stu-id="24677-108">Basically, the client implements what is called a sink in the form of a sink object with a sink interface.</span></span> <span data-ttu-id="24677-109">L’interface du récepteur reçoit les appels de notifications d’événements sortants du codocument une fois que le récepteur est correctement connecté par le client à une instance de codocument.</span><span class="sxs-lookup"><span data-stu-id="24677-109">The sink interface receives outgoing event notification calls from COPaper after the sink is properly connected by the client to a COPaper instance.</span></span> <span data-ttu-id="24677-110">Le client établit la connexion à l’aide d’un objet point de connexion qui est géré par le codocument.</span><span class="sxs-lookup"><span data-stu-id="24677-110">The client makes the connection by using a connection point object that is managed by COPaper.</span></span> <span data-ttu-id="24677-111">Il peut y avoir de nombreux points de connexion sur un seul objet COM connectable.</span><span class="sxs-lookup"><span data-stu-id="24677-111">There can be numerous connection points on a single connectable COM object.</span></span> <span data-ttu-id="24677-112">Dans l’exemple **StoServe** , le colivre n’a qu’un seul point de connexion, qui gère le dessin des événements de papier.</span><span class="sxs-lookup"><span data-stu-id="24677-112">In the **StoServe** sample, COPaper has only one connection point, which handles drawing paper events.</span></span>

<span data-ttu-id="24677-113">Un nombre quelconque de clients peuvent se connecter à un point de connexion unique.</span><span class="sxs-lookup"><span data-stu-id="24677-113">Any number of clients can connect to a single connection point.</span></span> <span data-ttu-id="24677-114">Le \_ point de connexion CONNPOINT PAPERSINK dans le colivre gère un groupe de connexions qui peuvent croître de manière dynamique au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="24677-114">The CONNPOINT\_PAPERSINK connection point in COPaper maintains a group of connections that can grow dynamically at run time.</span></span> <span data-ttu-id="24677-115">Les détails complets sur la prise en charge des objets connectables du codocument sont codés dans fichiers CONNECT. H et CONNECT. CPP et ne seront pas couverts ici.</span><span class="sxs-lookup"><span data-stu-id="24677-115">The full details on COPaper's connectable object support is coded in files CONNECT.H and CONNECT.CPP and will not be covered here.</span></span> <span data-ttu-id="24677-116">La construction est très similaire à ce qui a été étudié dans l’exemple de code de préservation.</span><span class="sxs-lookup"><span data-stu-id="24677-116">The construction is very similar to what was studied in the CONSERVE code sample.</span></span>

<span data-ttu-id="24677-117">Le client **StoClien** implémente les objets récepteurs appropriés pour les points de connexion qu’il s’attend à trouver dans le codocument.</span><span class="sxs-lookup"><span data-stu-id="24677-117">The **StoClien** client implements appropriate sink objects for the connection points it expects to find in COPaper.</span></span> <span data-ttu-id="24677-118">À partir du contexte d’un colivre, l’objet récepteur important que **StoClien** implémente expose l’interface **IPaperSink** .</span><span class="sxs-lookup"><span data-stu-id="24677-118">From the context of COPaper, the important sink object that **StoClien** implements exposes the **IPaperSink** interface.</span></span> <span data-ttu-id="24677-119">Il s’agit de l’interface sortante utilisée par le **StoClien** pour notifier les différents événements du colivre.</span><span class="sxs-lookup"><span data-stu-id="24677-119">This is the outgoing interface used by COPaper to notify **StoClien** of various events in COPaper.</span></span>

<span data-ttu-id="24677-120">Voici un résumé des méthodes dans **IPaperSink** à partir de IPAPER. H dans le \\ répertoire frère Inc.</span><span class="sxs-lookup"><span data-stu-id="24677-120">Here is a summary of the methods in **IPaperSink** from IPAPER.H in the \\INC sibling directory.</span></span>



| <span data-ttu-id="24677-121">Méthode</span><span class="sxs-lookup"><span data-stu-id="24677-121">Method</span></span>   | <span data-ttu-id="24677-122">Description</span><span class="sxs-lookup"><span data-stu-id="24677-122">Description</span></span>                                                   |
|----------|---------------------------------------------------------------|
| <span data-ttu-id="24677-123">Verrouillé</span><span class="sxs-lookup"><span data-stu-id="24677-123">Locked</span></span>   | <span data-ttu-id="24677-124">Un client a pris le contrôle du papier et l’a verrouillé.</span><span class="sxs-lookup"><span data-stu-id="24677-124">A client has taken control of and locked the paper.</span></span>           |
| <span data-ttu-id="24677-125">Accessible</span><span class="sxs-lookup"><span data-stu-id="24677-125">Unlocked</span></span> | <span data-ttu-id="24677-126">Un client a abandonné le contrôle du papier.</span><span class="sxs-lookup"><span data-stu-id="24677-126">A client has relinquished control of the paper.</span></span>               |
| <span data-ttu-id="24677-127">Loaded</span><span class="sxs-lookup"><span data-stu-id="24677-127">Loaded</span></span>   | <span data-ttu-id="24677-128">Un client a chargé du contenu papier à partir de son propre fichier composé.</span><span class="sxs-lookup"><span data-stu-id="24677-128">A client has loaded paper content from its own compound file.</span></span> |
| <span data-ttu-id="24677-129">Enregistré</span><span class="sxs-lookup"><span data-stu-id="24677-129">Saved</span></span>    | <span data-ttu-id="24677-130">Un client a enregistré du contenu papier dans son propre fichier composé.</span><span class="sxs-lookup"><span data-stu-id="24677-130">A client has saved paper content to its own compound file.</span></span>    |
| <span data-ttu-id="24677-131">InkStart</span><span class="sxs-lookup"><span data-stu-id="24677-131">InkStart</span></span> | <span data-ttu-id="24677-132">Un client a démarré une séquence de dessin d’encre couleur sur le papier.</span><span class="sxs-lookup"><span data-stu-id="24677-132">A client started a color ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="24677-133">InkDraw</span><span class="sxs-lookup"><span data-stu-id="24677-133">InkDraw</span></span>  | <span data-ttu-id="24677-134">Un client met des points de données d’encre sur l’aire du papier.</span><span class="sxs-lookup"><span data-stu-id="24677-134">A client is putting ink data points on the paper surface.</span></span>     |
| <span data-ttu-id="24677-135">InkStop</span><span class="sxs-lookup"><span data-stu-id="24677-135">InkStop</span></span>  | <span data-ttu-id="24677-136">Un client a arrêté la séquence de dessin de son entrée manuscrite sur le papier.</span><span class="sxs-lookup"><span data-stu-id="24677-136">A client has stopped its ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="24677-137">Effacé</span><span class="sxs-lookup"><span data-stu-id="24677-137">Erased</span></span>   | <span data-ttu-id="24677-138">Un client a effacé toutes les données d’encre du papier.</span><span class="sxs-lookup"><span data-stu-id="24677-138">A client has erased all ink data from the paper.</span></span>              |
| <span data-ttu-id="24677-139">Redimensionné</span><span class="sxs-lookup"><span data-stu-id="24677-139">Resized</span></span>  | <span data-ttu-id="24677-140">Un client a redimensionné le papier.</span><span class="sxs-lookup"><span data-stu-id="24677-140">A client has resized the paper.</span></span>                               |



 

<span data-ttu-id="24677-141">Ces méthodes sont en grande partie explicites.</span><span class="sxs-lookup"><span data-stu-id="24677-141">These methods are largely self-explanatory.</span></span> <span data-ttu-id="24677-142">Bien que le récepteur doive implémenter toutes ces méthodes d’une certaine manière, un grand nombre sont implémentées en tant que stubs et ne sont pas utilisés dans les exemples **StoServe** / **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="24677-142">Although the sink must implement all these methods in some fashion, many are implemented as stubs and are not used in the **StoServe**/**StoClien** samples.</span></span>

<span data-ttu-id="24677-143">Une méthode importante utilisée dans ces exemples est la méthode chargée.</span><span class="sxs-lookup"><span data-stu-id="24677-143">An important method used in these samples is the Loaded method.</span></span> <span data-ttu-id="24677-144">Lorsque le client est invité à charger un nouveau dessin à partir d’un fichier, il a besoin d’un moyen d’informer le client lorsque les nouvelles données sont chargées.</span><span class="sxs-lookup"><span data-stu-id="24677-144">When COPaper is told by the client to load a new drawing from file, it needs a way to notify the client when the new data is loaded.</span></span> <span data-ttu-id="24677-145">Pour ce faire, le codocument appelle **IPaperSink :: Loaded** sur le récepteur client.</span><span class="sxs-lookup"><span data-stu-id="24677-145">To do this, COPaper Calls **IPaperSink::Loaded** on the client sink.</span></span> <span data-ttu-id="24677-146">Le client peut ensuite appeler [**IPaper :: Redraw**](ipaper--redraw.md) pour demander que le présentateur lise les nouvelles données au client.</span><span class="sxs-lookup"><span data-stu-id="24677-146">The client can then call [**IPaper::Redraw**](ipaper--redraw.md) to request that COPaper play back the new data to the client.</span></span> <span data-ttu-id="24677-147">Redessine provoque la recréation du dessin chargé dans l’affichage du client.</span><span class="sxs-lookup"><span data-stu-id="24677-147">Redraw causes the loaded drawing in the client's display to be repainted.</span></span> <span data-ttu-id="24677-148">Une fois le chargement terminé, le dessin qui vient d’être chargé s’affiche automatiquement dans la fenêtre fournie par le client.</span><span class="sxs-lookup"><span data-stu-id="24677-148">When the load is completed, the newly loaded drawing is displayed automatically in the window provided by the client.</span></span>

<span data-ttu-id="24677-149">Pour obtenir des informations complètes sur la connectivité de cette méthode IPaper à **IPaperSink**, consultez [**IPaper :: Redraw**](ipaper--redraw.md) .</span><span class="sxs-lookup"><span data-stu-id="24677-149">See [**IPaper::Redraw**](ipaper--redraw.md) for complete information of this IPaper method's connectivity to **IPaperSink**.</span></span>

<span data-ttu-id="24677-150">Les  méthodes IPaperSink **InkStart**, **InkDraw** et **InkStop** sont utilisées pour renvoyer des paquets de données d’encre au client.</span><span class="sxs-lookup"><span data-stu-id="24677-150">The **IPaperSink** methods **InkStart**, **InkDraw**, and **InkStop** are used to send individual ink data packets back to the client.</span></span> <span data-ttu-id="24677-151">Lors de la réception, le client les peint dans son affichage de la même manière que lorsqu’il les a envoyés à l’origine sur le codocument.</span><span class="sxs-lookup"><span data-stu-id="24677-151">On reception, the client paints them in its display in the same manner as when it originally sent them to COPaper.</span></span> <span data-ttu-id="24677-152">La logique ci-dessus est suffisamment générale pour permettre à plusieurs clients qui écoutent sur le même \_ point de connexion CONNPOINT PAPERSINK.</span><span class="sxs-lookup"><span data-stu-id="24677-152">The above logic is general enough to allow for multiple clients that are all listening on the same CONNPOINT\_PAPERSINK connection point.</span></span> <span data-ttu-id="24677-153">Si une instance de colivre commun a été partagée par ces clients, elle peut afficher le même dessin en se connectant à ce point de connexion.</span><span class="sxs-lookup"><span data-stu-id="24677-153">If a common COPaper instance was shared by these clients, they could all display the same drawing by connecting to this connection point.</span></span>

 

 