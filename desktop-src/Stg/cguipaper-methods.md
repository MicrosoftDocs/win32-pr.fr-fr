---
title: Méthodes CGuiPaper
description: Les méthodes de CGuiPaper sont résumées comme suit. Ces méthodes sont toutes implémentées dans GUIPAPER. Cotisations.
ms.assetid: 965a60d4-2737-4a2d-8790-bee70bceaeeb
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 1303ca38ffe02da0dc747e1a8834d36419452209
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103671670"
---
# <a name="cguipaper-methods"></a><span data-ttu-id="ecba9-104">Méthodes CGuiPaper</span><span class="sxs-lookup"><span data-stu-id="ecba9-104">CGuiPaper Methods</span></span>

<span data-ttu-id="ecba9-105">Les méthodes de CGuiPaper sont résumées comme suit.</span><span class="sxs-lookup"><span data-stu-id="ecba9-105">CGuiPaper's methods are summarized as follows.</span></span> <span data-ttu-id="ecba9-106">Ces méthodes sont toutes implémentées dans GUIPAPER. Cotisations.</span><span class="sxs-lookup"><span data-stu-id="ecba9-106">These methods are all implemented in GUIPAPER.CPP.</span></span>



| <span data-ttu-id="ecba9-107">Méthode</span><span class="sxs-lookup"><span data-stu-id="ecba9-107">Method</span></span>                                                         | <span data-ttu-id="ecba9-108">Description</span><span class="sxs-lookup"><span data-stu-id="ecba9-108">Description</span></span>                                                                                                           |
|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ecba9-109">BOOL init (HINSTANCE hInst, HWND hWnd, TCHAR \* pszCmdLineFile);</span><span class="sxs-lookup"><span data-stu-id="ecba9-109">BOOL Init(HINSTANCE hInst, HWND hWnd, TCHAR\* pszCmdLineFile);</span></span> | <span data-ttu-id="ecba9-110">Initialise GuiPaper.</span><span class="sxs-lookup"><span data-stu-id="ecba9-110">Initializes the GuiPaper.</span></span> <span data-ttu-id="ecba9-111">Demande au serveur de créer un objet de copapiers.</span><span class="sxs-lookup"><span data-stu-id="ecba9-111">Asks server to create a COPaper object.</span></span>                                                     |
| <span data-ttu-id="ecba9-112">HRESULT DrawOn (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-112">HRESULT DrawOn(void);</span></span>                                          | <span data-ttu-id="ecba9-113">Verrouille le papier pour le dessin exclusif par ce client.</span><span class="sxs-lookup"><span data-stu-id="ecba9-113">Locks paper for drawing exclusively by this client.</span></span>                                                                   |
| <span data-ttu-id="ecba9-114">HRESULT DrawOff (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-114">HRESULT DrawOff(void);</span></span>                                         | <span data-ttu-id="ecba9-115">Déverrouille le papier pour permettre à d’autres clients de dessiner.</span><span class="sxs-lookup"><span data-stu-id="ecba9-115">Unlocks paper to allow other clients to draw.</span></span>                                                                         |
| <span data-ttu-id="ecba9-116">HRESULT ClearWin (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-116">HRESULT ClearWin(void);</span></span>                                        | <span data-ttu-id="ecba9-117">Efface la fenêtre d’affichage, mais conserve les données d’encre.</span><span class="sxs-lookup"><span data-stu-id="ecba9-117">Clears display window but retains ink data.</span></span>                                                                           |
| <span data-ttu-id="ecba9-118">HRESULT PaintWin (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-118">HRESULT PaintWin(void);</span></span>                                        | <span data-ttu-id="ecba9-119">Efface la fenêtre et repeint avec les données d’encre actuelles.</span><span class="sxs-lookup"><span data-stu-id="ecba9-119">Clears window and repaints with current ink data.</span></span>                                                                     |
| <span data-ttu-id="ecba9-120">Effacement HRESULT (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-120">HRESULT Erase(void);</span></span>                                           | <span data-ttu-id="ecba9-121">Efface le contenu de dessin actuel et efface la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="ecba9-121">Erases current drawing content and clears display window.</span></span>                                                             |
| <span data-ttu-id="ecba9-122">HRESULT Resize (WORD wWidth, WORD wHeight);</span><span class="sxs-lookup"><span data-stu-id="ecba9-122">HRESULT Resize(WORD wWidth, WORD wHeight);</span></span>                     | <span data-ttu-id="ecba9-123">Redimensionne la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="ecba9-123">Resizes the display window.</span></span>                                                                                           |
| <span data-ttu-id="ecba9-124">HRESULT InkWidth (SHORT nInkWidth);</span><span class="sxs-lookup"><span data-stu-id="ecba9-124">HRESULT InkWidth(SHORT nInkWidth);</span></span>                             | <span data-ttu-id="ecba9-125">Définit la largeur d’encre actuelle pour le dessin.</span><span class="sxs-lookup"><span data-stu-id="ecba9-125">Sets current ink width for drawing.</span></span>                                                                                   |
| <span data-ttu-id="ecba9-126">HRESULT InkColor (COLORREF crInkColor);</span><span class="sxs-lookup"><span data-stu-id="ecba9-126">HRESULT InkColor(COLORREF crInkColor);</span></span>                         | <span data-ttu-id="ecba9-127">Définit la couleur d’encre actuelle pour le dessin.</span><span class="sxs-lookup"><span data-stu-id="ecba9-127">Sets current ink color for drawing.</span></span>                                                                                   |
| <span data-ttu-id="ecba9-128">HRESULT InkSaving (BOOL bInkSaving);</span><span class="sxs-lookup"><span data-stu-id="ecba9-128">HRESULT InkSaving(BOOL bInkSaving);</span></span>                            | <span data-ttu-id="ecba9-129">Active et désactive l’enregistrement des données manuscrites dans le codocument.</span><span class="sxs-lookup"><span data-stu-id="ecba9-129">Turns ink data saving in COPaper on and off.</span></span>                                                                          |
| <span data-ttu-id="ecba9-130">HRESULT InkStart (SHORT nX, SHORT nY);</span><span class="sxs-lookup"><span data-stu-id="ecba9-130">HRESULT InkStart(SHORT nX, SHORT nY);</span></span>                          | <span data-ttu-id="ecba9-131">Démarre la séquence de dessin de l’encre.</span><span class="sxs-lookup"><span data-stu-id="ecba9-131">Starts ink drawing sequence.</span></span>                                                                                          |
| <span data-ttu-id="ecba9-132">HRESULT InkDraw (SHORT nX, SHORT nY);</span><span class="sxs-lookup"><span data-stu-id="ecba9-132">HRESULT InkDraw(SHORT nX, SHORT nY);</span></span>                           | <span data-ttu-id="ecba9-133">Dessine les données de séquence d’encre.</span><span class="sxs-lookup"><span data-stu-id="ecba9-133">Draws ink sequence data.</span></span>                                                                                              |
| <span data-ttu-id="ecba9-134">HRESULT InkStop (SHORT nX, SHORT nY);</span><span class="sxs-lookup"><span data-stu-id="ecba9-134">HRESULT InkStop(SHORT nX, SHORT nY);</span></span>                           | <span data-ttu-id="ecba9-135">Arrête la séquence de dessin de l’encre.</span><span class="sxs-lookup"><span data-stu-id="ecba9-135">Stops ink drawing sequence.</span></span>                                                                                           |
| <span data-ttu-id="ecba9-136">HRESULT ConnectPaperSink (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-136">HRESULT ConnectPaperSink(void);</span></span>                                | <span data-ttu-id="ecba9-137">Connecte l’objet client PaperSink à la source de l’en-papiers du serveur.</span><span class="sxs-lookup"><span data-stu-id="ecba9-137">Connects the client PaperSink object to the server COPaper source.</span></span>                                                    |
| <span data-ttu-id="ecba9-138">HRESULT DisconnectPaperSink (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-138">HRESULT DisconnectPaperSink(void);</span></span>                             | <span data-ttu-id="ecba9-139">Déconnectez l’objet client PaperSink de la source de l’en-papiers du serveur.</span><span class="sxs-lookup"><span data-stu-id="ecba9-139">Disconnect the client PaperSink object from the server COPaper source.</span></span>                                                |
| <span data-ttu-id="ecba9-140">Chargement HRESULT (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-140">HRESULT Load(void);</span></span>                                            | <span data-ttu-id="ecba9-141">Charge des données manuscrites à partir du fichier composé actuel.</span><span class="sxs-lookup"><span data-stu-id="ecba9-141">Loads ink data from current compound file.</span></span>                                                                            |
| <span data-ttu-id="ecba9-142">HRESULT Save (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-142">HRESULT Save(void);</span></span>                                            | <span data-ttu-id="ecba9-143">Enregistre les données d’encre existantes dans le fichier composé actuel.</span><span class="sxs-lookup"><span data-stu-id="ecba9-143">Saves existing ink data to current compound file.</span></span>                                                                     |
| <span data-ttu-id="ecba9-144">HRESULT AskSave (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-144">HRESULT AskSave(void);</span></span>                                         | <span data-ttu-id="ecba9-145">Vérifie si le dessin a changé.</span><span class="sxs-lookup"><span data-stu-id="ecba9-145">Checks if drawing changed.</span></span> <span data-ttu-id="ecba9-146">Dans ce cas, affiche la boîte de dialogue demandant à l’utilisateur s’il faut enregistrer les modifications et y répondre de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="ecba9-146">If so, displays dialog box asking user whether to save changes and responds appropriately.</span></span> |
| <span data-ttu-id="ecba9-147">HRESULT Open (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-147">HRESULT Open(void);</span></span>                                            | <span data-ttu-id="ecba9-148">Affiche la boîte de dialogue commune Win32.</span><span class="sxs-lookup"><span data-stu-id="ecba9-148">Shows Win32 common dialog box.</span></span> <span data-ttu-id="ecba9-149">Ouvre un fichier de données de papier existant.</span><span class="sxs-lookup"><span data-stu-id="ecba9-149">Opens existing paper data compound file.</span></span>                                               |
| <span data-ttu-id="ecba9-150">HRESULT SaveAs (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-150">HRESULT SaveAs(void);</span></span>                                          | <span data-ttu-id="ecba9-151">Affiche la boîte de dialogue commune Win32.</span><span class="sxs-lookup"><span data-stu-id="ecba9-151">Shows Win32 common dialog box.</span></span> <span data-ttu-id="ecba9-152">Enregistre les données du papier en cours dans le fichier renommé.</span><span class="sxs-lookup"><span data-stu-id="ecba9-152">Saves current paper data in renamed file.</span></span>                                              |
| <span data-ttu-id="ecba9-153">COLORREF PickColor (void);</span><span class="sxs-lookup"><span data-stu-id="ecba9-153">COLORREF PickColor(void);</span></span>                                      | <span data-ttu-id="ecba9-154">Affiche la boîte de dialogue ommuns Win32.</span><span class="sxs-lookup"><span data-stu-id="ecba9-154">Shows Win32 ommon dialog box.</span></span> <span data-ttu-id="ecba9-155">Demande à l’utilisateur de choisir une nouvelle couleur du stylet.</span><span class="sxs-lookup"><span data-stu-id="ecba9-155">Asks user to choose new pen color.</span></span>                                                      |



 

<span data-ttu-id="ecba9-156">La méthode **init** crée l’objet de codocumentation basé sur le serveur et affecte le \_ membre m pIPaper de CGuiPaper.</span><span class="sxs-lookup"><span data-stu-id="ecba9-156">The **Init** method creates the server-based COPaper object and assigns CGuiPaper's m\_pIPaper member.</span></span>

<span data-ttu-id="ecba9-157">Les méthodes **AskSave**, **Open**, **SaveAs** et **PickColor** fournissent un comportement GUI familier à l’aide des boîtes de dialogue courantes Win32.</span><span class="sxs-lookup"><span data-stu-id="ecba9-157">The **AskSave**, **Open**, **SaveAs**, and **PickColor** methods provide familiar GUI behavior using Win32 common dialogs.</span></span> <span data-ttu-id="ecba9-158">Par exemple, la méthode **Open** utilise la boîte de dialogue Win32 Open File Name pour demander à l’utilisateur de spécifier un nom de fichier à ouvrir.</span><span class="sxs-lookup"><span data-stu-id="ecba9-158">For example, the **Open** method uses the Win32 Open File Name dialog box to ask the user to specify a file name for opening.</span></span>

<span data-ttu-id="ecba9-159">Les méthodes de **chargement** et d' **enregistrement** seront traitées en détail plus loin dans cette visite guidée.</span><span class="sxs-lookup"><span data-stu-id="ecba9-159">The **Load** and **Save** methods will be covered in detail later in this tour.</span></span>

<span data-ttu-id="ecba9-160">**InkSaving**, **InkStart**, **InkDraw** et **InkStop** sont les méthodes centrales pour la fonctionnalité de dessin de l’application **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="ecba9-160">**InkSaving**, **InkStart**, **InkDraw**, and **InkStop** are the central methods for the drawing functionality of the **StoClien** application.</span></span> <span data-ttu-id="ecba9-161">**StoClien** utilise ces méthodes CGuiPaper pour capturer, afficher et stocker les données de dessin interactives au fur et à mesure qu’elles se produisent sous le contrôle utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ecba9-161">**StoClien** uses these CGuiPaper methods to capture, display, and store the interactive drawing data as it occurs under user control.</span></span> <span data-ttu-id="ecba9-162">Elles effectuent un double rôle de peinture de l’image dessinée dans la fenêtre du client, ainsi que le passage des données de dessin au codocument sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="ecba9-162">They perform a dual role of painting the drawn image to the client window as well as passing the drawing data to COPaper in the server.</span></span> <span data-ttu-id="ecba9-163">Convertit les données de dessin en paquets de données d’encre pour le stockage.</span><span class="sxs-lookup"><span data-stu-id="ecba9-163">COPaper translates the drawing data into ink data packets for storage.</span></span>

 

 




