---
title: Pages de codes et chaînes Unicode
description: Un autre point à prendre en compte dans l’implémentation de IPropertySetStorage est la façon dont les noms de propriété Unicode sont stockés dans l’ID de propriété 0 (le dictionnaire de noms de propriétés), qui n’utilise pas de chaînes Unicode.
ms.assetid: 830c90c9-d2a5-4ecf-8cb6-9950ed5320bf
keywords:
- Pages de codes et chaînes Unicode
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 508d508ec21e7e763a683e534cf485ebbeec018d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104309401"
---
# <a name="code-pages-and-unicode-strings"></a><span data-ttu-id="12139-104">Pages de codes et chaînes Unicode</span><span class="sxs-lookup"><span data-stu-id="12139-104">Code Pages and Unicode Strings</span></span>

<span data-ttu-id="12139-105">Un autre point à prendre en compte dans l’implémentation de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) est la façon dont les noms de propriété Unicode sont stockés dans l’ID de propriété 0 (le dictionnaire de noms de propriétés), qui n’utilise pas de chaînes Unicode.</span><span class="sxs-lookup"><span data-stu-id="12139-105">Another consideration in implementing [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is how Unicode property names are stored in the property ID 0 (the property name dictionary), which does not use Unicode strings.</span></span>

<span data-ttu-id="12139-106">Unicode a officiellement une valeur de page de codes de 1200.</span><span class="sxs-lookup"><span data-stu-id="12139-106">Unicode officially has a code page value of 1200.</span></span> <span data-ttu-id="12139-107">Pour stocker des valeurs Unicode dans le dictionnaire de noms de propriétés, utilisez la valeur de page de codes 1200 pour le jeu de propriétés entier (dans l’ID de propriété 1), spécifié par l’absence de l’indicateur **\_ ANSI PROPSETFLAG** dans [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="12139-107">To store Unicode values in the property name dictionary, use a code page value of 1200 for the whole property set (in property ID 1), specified by the absence of the **PROPSETFLAG\_ANSI** flag in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="12139-108">N’oubliez pas que cela a pour effet secondaire de stocker toutes les valeurs de chaîne dans le jeu de propriétés Unicode.</span><span class="sxs-lookup"><span data-stu-id="12139-108">Be aware that this has the side effect of storing all string values in the property set in Unicode.</span></span> <span data-ttu-id="12139-109">Dans toutes les pages de codes, le nombre trouvé au début d’un **VT de VT \_** est un nombre d’octets, et non un nombre de caractères.</span><span class="sxs-lookup"><span data-stu-id="12139-109">In all code pages, the count found at the start of a **VT\_LPSTR** is a byte count, not a character count.</span></span> <span data-ttu-id="12139-110">Cela est nécessaire pour assurer la compatibilité avec les clients de version antérieure.</span><span class="sxs-lookup"><span data-stu-id="12139-110">This is necessary to provide for compatibility with earlier-version clients.</span></span>

<span data-ttu-id="12139-111">L’implémentation de fichier composé de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) crée tous les nouveaux jeux de propriétés entièrement en Unicode (page de codes 1200) ou dans la page de codes ANSI du système en cours.</span><span class="sxs-lookup"><span data-stu-id="12139-111">The compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) creates all new property sets completely either in Unicode (code page 1200) or in the current system ANSI code page.</span></span> <span data-ttu-id="12139-112">Cela est contrôlé par l’absence ou la présence de l’indicateur **\_ ANSI PROPSETFLAG** dans le paramètre *grfFlags* de [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="12139-112">This is controlled by the absence or presence of the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span>

<span data-ttu-id="12139-113">Créez et ouvrez les jeux de propriétés au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="12139-113">Create and open property sets as Unicode.</span></span> <span data-ttu-id="12139-114">Pour l’implémenter, ne définissez pas l’indicateur **\_ ANSI PROPSETFLAG** dans le paramètre *grfFlags* de [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="12139-114">To implement this, do not set the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="12139-115">Évitez d’utiliser les valeurs **VT \_ LPSTR** et utilisez à la place des valeurs **VT \_ LPWStr** .</span><span class="sxs-lookup"><span data-stu-id="12139-115">Avoid using **VT\_LPSTR** values, and instead use **VT\_LPWSTR** values.</span></span> <span data-ttu-id="12139-116">Lorsque la page de codes du jeu de propriétés est Unicode, les valeurs de chaîne de **VT \_ LPSTR** sont converties au format Unicode lorsqu’elles sont stockées, et reviennent aux valeurs de chaîne multioctets lors de leur récupération.</span><span class="sxs-lookup"><span data-stu-id="12139-116">When the code page of the property set is Unicode, **VT\_LPSTR** string values are converted to Unicode when stored, and back to multibyte string values when retrieved.</span></span>

<span data-ttu-id="12139-117">La définition de l’indicateur **\_ ANSI PROPSETFLAG** comme signalé par un appel à [**IPropertyStorage :: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) indique si la page de codes sous-jacente est ou n’est pas au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="12139-117">Setting the **PROPSETFLAG\_ANSI** flag as reported through a call to [**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) reflects whether the underlying code page is or is not Unicode.</span></span> <span data-ttu-id="12139-118">N’oubliez pas que l’ID de propriété 1 peut être lu de manière explicite pour apprendre la page de codes.</span><span class="sxs-lookup"><span data-stu-id="12139-118">Be aware that Property ID 1 can be explicitly read to learn the code page.</span></span>

<span data-ttu-id="12139-119">Vous pouvez accéder à l’ID de propriété 1 à l’aide d’un appel à [**IPropertyStorage :: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span><span class="sxs-lookup"><span data-stu-id="12139-119">You can access Property ID 1 through a call to [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span></span> <span data-ttu-id="12139-120">Toutefois, il est en lecture seule et ne peut pas être mis à jour avec [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span><span class="sxs-lookup"><span data-stu-id="12139-120">However, it is read-only, and may not be updated with [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span></span> <span data-ttu-id="12139-121">En outre, il ne peut pas être supprimé avec [**DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span><span class="sxs-lookup"><span data-stu-id="12139-121">Furthermore, it may not be deleted with [**DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span></span>

 

 




