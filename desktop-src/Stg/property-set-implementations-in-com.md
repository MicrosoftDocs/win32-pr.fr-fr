---
title: Implémentations de jeux de propriétés dans COM
description: Implémentations de jeux de propriétés dans COM
ms.assetid: 52d7b534-f81a-4cc9-b5ea-9538bfff056c
keywords:
- Stockage structuré Strctd STG, utilisation de, jeu de propriétés utilise dans COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb8ee68fcd36958e0b7b0648e40f6e3c480f31d3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103941093"
---
# <a name="property-set-implementations-in-com"></a><span data-ttu-id="e03ea-104">Implémentations de jeux de propriétés dans COM</span><span class="sxs-lookup"><span data-stu-id="e03ea-104">Property Set Implementations in COM</span></span>

<span data-ttu-id="e03ea-105">Bien que le potentiel d’utilisation des jeux de propriétés persistantes ne soit pas entièrement exploité, il existe actuellement deux utilisations principales :</span><span class="sxs-lookup"><span data-stu-id="e03ea-105">While the potential for uses of persistent property sets is not fully tapped, there are currently two primary uses:</span></span>

-   <span data-ttu-id="e03ea-106">Stockage d’informations de synthèse avec un objet tel qu’un document</span><span class="sxs-lookup"><span data-stu-id="e03ea-106">Storing summary information with an object such as a document</span></span>
-   <span data-ttu-id="e03ea-107">Transfert de données de propriété entre des objets</span><span class="sxs-lookup"><span data-stu-id="e03ea-107">Transferring property data between objects</span></span>

<span data-ttu-id="e03ea-108">Les jeux de propriétés COM ont été conçus pour stocker des données adaptées à la représentation sous la forme d’une collection de valeurs affinées de taille moyenne.</span><span class="sxs-lookup"><span data-stu-id="e03ea-108">COM property sets were designed to store data that is suited to representation as a moderately sized collection of fine-grained values.</span></span> <span data-ttu-id="e03ea-109">Les jeux de données qui sont trop volumineux pour être réalisables doivent être décomposés en flux, stockages et/ou jeux de propriétés distincts.</span><span class="sxs-lookup"><span data-stu-id="e03ea-109">Data sets that are too large for this to be feasible should be broken into separate streams, storages, and/or property sets.</span></span> <span data-ttu-id="e03ea-110">Le format de données du jeu de propriétés COM n’était pas destiné à fournir un substitut pour une base de données de nombreux objets minuscules.</span><span class="sxs-lookup"><span data-stu-id="e03ea-110">The COM property set data format was not meant to provide a substitute for a database of many tiny objects.</span></span>

<span data-ttu-id="e03ea-111">COM fournit des implémentations des interfaces de jeu de propriétés pour différents objets, ainsi que trois fonctions d’assistance.</span><span class="sxs-lookup"><span data-stu-id="e03ea-111">COM provides implementations of the property set interfaces for various objects, along with three helper functions.</span></span> <span data-ttu-id="e03ea-112">La section suivante décrit certaines caractéristiques de performances de ces implémentations.</span><span class="sxs-lookup"><span data-stu-id="e03ea-112">The following section describes some performance characteristics of these implementations.</span></span> <span data-ttu-id="e03ea-113">Pour plus d’informations sur des interfaces spécifiques et sur la façon d’obtenir un pointeur vers ces interfaces, reportez-vous aux éléments suivants dans la section de référence COM :</span><span class="sxs-lookup"><span data-stu-id="e03ea-113">For more information on specific interfaces and how to get a pointer to these interfaces, refer to the following in the COM reference section:</span></span>

-   [<span data-ttu-id="e03ea-114">IPropertySetStorage : implémentation de fichier composé</span><span class="sxs-lookup"><span data-stu-id="e03ea-114">IPropertySetStorage–Compound File Implementation</span></span>](ipropertysetstorage-compound-file-implementation.md)

    <span data-ttu-id="e03ea-115">L’implémentation de fichier composé, qui fournit les interfaces [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) et [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) , fournit également les interfaces [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) et [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="e03ea-115">The compound file implementation, which provides the [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces, also provides the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces.</span></span> <span data-ttu-id="e03ea-116">En raison de l’implémentation d’un fichier composé de **IStorage**, l’interface **IPropertySetStorage** peut être obtenue en appelant [**IUnknown :: QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="e03ea-116">Given a compound file implementation of **IStorage**, the **IPropertySetStorage** interface can be obtained by calling [**IUnknown::QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span>

-   [<span data-ttu-id="e03ea-117">IPropertySetStorage – implémentation du système de fichiers NTFS</span><span class="sxs-lookup"><span data-stu-id="e03ea-117">IPropertySetStorage–NTFS File System Implementation</span></span>](ipropertysetstorage-ntfs-file-system-implementation.md)

    <span data-ttu-id="e03ea-118">Les interfaces [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) et [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) peuvent également être obtenues pour les fichiers NTFS qui ne sont pas des fichiers composés.</span><span class="sxs-lookup"><span data-stu-id="e03ea-118">The [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces can also be obtained for NTFS files that are not compound files.</span></span> <span data-ttu-id="e03ea-119">Par conséquent, il est possible d’obtenir ces interfaces pour tous les fichiers sur un volume NTFS.</span><span class="sxs-lookup"><span data-stu-id="e03ea-119">Therefore, it is possible to obtain these interfaces for all files on an NTFS volume.</span></span>

-   [<span data-ttu-id="e03ea-120">IPropertySetStorage – implémentation autonome</span><span class="sxs-lookup"><span data-stu-id="e03ea-120">IPropertySetStorage–Stand-alone Implementation</span></span>](ipropertysetstorage-stand-alone-implementation.md)

    <span data-ttu-id="e03ea-121">Lorsque cette implémentation de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) et [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) est instanciée, elle reçoit un pointeur vers un objet qui prend en charge l’interface [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) .</span><span class="sxs-lookup"><span data-stu-id="e03ea-121">When this implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) is instantiated, it is given a pointer to an object that supports the [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface.</span></span> <span data-ttu-id="e03ea-122">Il manipule ensuite les stockages de jeux de propriétés au sein de cet objet de stockage.</span><span class="sxs-lookup"><span data-stu-id="e03ea-122">It then manipulates property set storages within that storage object.</span></span> <span data-ttu-id="e03ea-123">Par conséquent, il est possible d’accéder et de manipuler les jeux de propriétés sur tout objet qui prend en charge.</span><span class="sxs-lookup"><span data-stu-id="e03ea-123">Thus, it is possible to access and manipulate property sets on any object that supports .</span></span>

-   [<span data-ttu-id="e03ea-124">Considérations relatives à l’implémentation de IPropertySetStorage</span><span class="sxs-lookup"><span data-stu-id="e03ea-124">IPropertySetStorage Implementation Considerations</span></span>](ipropertysetstorage-implementation-considerations.md)

    <span data-ttu-id="e03ea-125">Il existe plusieurs problèmes à prendre en compte pour fournir une implémentation de l’interface [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) .</span><span class="sxs-lookup"><span data-stu-id="e03ea-125">There are several issues to consider in providing an implementation of the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span> <span data-ttu-id="e03ea-126">Pour plus d’informations sur ces *considérations d’implémentation* , consultez la section Référence com.</span><span class="sxs-lookup"><span data-stu-id="e03ea-126">Please refer to these *Implementation Considerations* in the COM Reference section.</span></span>

<span data-ttu-id="e03ea-127">En outre, il existe quatre fonctions d’assistance, conçues pour faciliter la gestion des propriétés qui ont été lues à partir d’une propriété définie en mémoire (dans une structure [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) ) :</span><span class="sxs-lookup"><span data-stu-id="e03ea-127">In addition, there are four helper functions, designed to aid in dealing with properties that have been read from a property set into memory (into a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure):</span></span>

-   [<span data-ttu-id="e03ea-128">**PropVariantInit**</span><span class="sxs-lookup"><span data-stu-id="e03ea-128">**PropVariantInit**</span></span>](/windows/desktop/api/PropIdl/nf-propidl-propvariantinit)
-   [<span data-ttu-id="e03ea-129">**PropVariantClear**</span><span class="sxs-lookup"><span data-stu-id="e03ea-129">**PropVariantClear**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-propvariantclear)
-   [<span data-ttu-id="e03ea-130">**FreePropVariantArray**</span><span class="sxs-lookup"><span data-stu-id="e03ea-130">**FreePropVariantArray**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-freepropvariantarray)
-   [<span data-ttu-id="e03ea-131">**PropVariantCopy**</span><span class="sxs-lookup"><span data-stu-id="e03ea-131">**PropVariantCopy**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-propvariantcopy)

<span data-ttu-id="e03ea-132">Les sections suivantes traitent des implémentations de jeux de propriétés dans COM plus en détail :</span><span class="sxs-lookup"><span data-stu-id="e03ea-132">The following sections discuss property set implementations in COM in greater detail:</span></span>

-   [<span data-ttu-id="e03ea-133">Gestion des jeux de propriétés</span><span class="sxs-lookup"><span data-stu-id="e03ea-133">Managing Property Sets</span></span>](managing-property-sets.md)
-   [<span data-ttu-id="e03ea-134">Considérations relatives aux jeux de propriétés</span><span class="sxs-lookup"><span data-stu-id="e03ea-134">Property Set Considerations</span></span>](property-set-considerations.md)
-   [<span data-ttu-id="e03ea-135">Stockage des jeux de propriétés</span><span class="sxs-lookup"><span data-stu-id="e03ea-135">Storing Property Sets</span></span>](storing-property-sets.md)
-   [<span data-ttu-id="e03ea-136">Caractéristiques de performances</span><span class="sxs-lookup"><span data-stu-id="e03ea-136">Performance Characteristics</span></span>](performance-characteristics.md)
-   [<span data-ttu-id="e03ea-137">Implémentation du jeu de propriétés d’informations de résumé</span><span class="sxs-lookup"><span data-stu-id="e03ea-137">Implementing the Summary Information Property Set</span></span>](implementing-the-summary-information-property-set.md)
-   [<span data-ttu-id="e03ea-138">Considérations relatives à l’implémentation de IPropertySetStorage</span><span class="sxs-lookup"><span data-stu-id="e03ea-138">IPropertySetStorage Implementation Considerations</span></span>](ipropertysetstorage-implementation-considerations.md)

 

 