---
title: Stockage des jeux de propriétés
description: Les applications peuvent exposer certaines données d’état de leurs documents afin que d’autres applications puissent les localiser et les lire.
ms.assetid: 2e0b5f6c-da1d-47f2-a50d-1ac7f2f0c45d
keywords:
- Stockage de jeux de propriétés stockage structuré
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60710b84b52fcc709f8ba3ad1e930d6f5a50a4cd
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103839481"
---
# <a name="storing-property-sets"></a><span data-ttu-id="6e3f9-104">Stockage des jeux de propriétés</span><span class="sxs-lookup"><span data-stu-id="6e3f9-104">Storing Property Sets</span></span>

<span data-ttu-id="6e3f9-105">Les applications peuvent exposer certaines données d’état de leurs documents afin que d’autres applications puissent les localiser et les lire.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-105">Applications can expose some of the state data of their documents so that other applications can locate and read that data.</span></span> <span data-ttu-id="6e3f9-106">Certains exemples sont un jeu de propriétés qui décrit l’auteur, le titre et les mots clés d’un document créé avec un traitement de texte, ou la liste des polices utilisées dans un document.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-106">Some examples are a property set describing the author, title, and keywords of a document created with a word processor, or the list of fonts used in a document.</span></span> <span data-ttu-id="6e3f9-107">Cette fonctionnalité n’est pas limitée aux documents ; Il peut également être utilisé sur des objets incorporés.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-107">This facility is not restricted to documents; it can also be used on embedded objects.</span></span> <span data-ttu-id="6e3f9-108">En règle générale, l’accès aux jeux de propriétés doit être via les interfaces [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) et [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) , mais cette section décrit la méthode recommandée précédemment.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-108">Generally, access to property sets should be through the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces, but this section describes the previously recommended way.</span></span>

> [!Note]  
> <span data-ttu-id="6e3f9-109">Si vous stockez un jeu de propriétés qui est interne à votre application, vous pouvez ne pas vouloir suivre les indications ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-109">If storing a property set that is internal to your application, you may not want to use the following guidelines.</span></span> <span data-ttu-id="6e3f9-110">Pour exposer votre propriété à d’autres applications, suivez ces instructions.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-110">To expose your property set to other applications, follow these guidelines.</span></span>

 

<span data-ttu-id="6e3f9-111">**Pour stocker un jeu de propriétés dans un fichier composé**</span><span class="sxs-lookup"><span data-stu-id="6e3f9-111">**To store a property set in a compound file**</span></span>

1.  <span data-ttu-id="6e3f9-112">Créez une instance [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) ou [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) dans le même niveau de la structure de stockage que ses flux de données.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-112">Create an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance in the same level of the storage structure as its data streams.</span></span> <span data-ttu-id="6e3f9-113">Suivez le nom de votre instance **IStorage** ou **IStream** avec « \\ 005 ».</span><span class="sxs-lookup"><span data-stu-id="6e3f9-113">Follow the name of your **IStorage** or **IStream** instance with "\\005."</span></span> <span data-ttu-id="6e3f9-114">Les noms de flux et de stockage qui commencent par 0x05 sont réservés aux jeux de propriétés communes qui peuvent être partagés entre les applications.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-114">Stream and storage names that begin with 0x05 are reserved for common property sets that can be shared among applications.</span></span> <span data-ttu-id="6e3f9-115">En outre, les flux commençant par cette valeur sont limités à 256 Ko.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-115">Also, streams beginning with that value are limited to 256 KB.</span></span> <span data-ttu-id="6e3f9-116">Les noms peuvent être sélectionnés à partir de noms et de formats publiés, ou en affectant la propriété définir un FMTID et en dérivant le nom à partir du FMTID conformément aux conventions décrites dans [conventions d’affectation de noms](storage-object-naming-conventions.md)pour les objets de stockage.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-116">The names can be selected from either published names and formats, or by assigning the property set a FMTID and deriving the name from the FMTID according to the conventions described in [Storage Object Naming Conventions](storage-object-naming-conventions.md).</span></span>
2.  <span data-ttu-id="6e3f9-117">Un jeu de propriétés peut être stocké dans une instance [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) unique ou dans une instance [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) contenant plusieurs flux et stockages.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-117">A property set may be stored in a single [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance or in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance containing multiple streams and storages.</span></span> <span data-ttu-id="6e3f9-118">Dans le cas d’une instance de **IStorage** , le flux de contenu nommé contents est le flux principal contenant des valeurs de propriété, où certaines valeurs peuvent être des noms d’autres flux ou instances de stockage dans le stockage pour ce jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-118">In the case of an **IStorage** instance, the contained stream named Contents is the primary stream containing property values, where some values may be names of other streams or storage instances within the storage for this property set.</span></span>
3.  <span data-ttu-id="6e3f9-119">Spécifiez le CLSID de la classe d’objet qui peut afficher ou fournir un accès par programme aux valeurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-119">Specify the CLSID of the object class that can display or provide programmatic access to the property values.</span></span> <span data-ttu-id="6e3f9-120">S’il n’existe aucune classe de ce type, le CLSID doit être défini sur l’identificateur de format du jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-120">If there is no such class, the CLSID should be set to the format identifier of the property set.</span></span> <span data-ttu-id="6e3f9-121">Pour un jeu de propriétés qui utilise une instance de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) , définissez le CLSID de l’instance de **IStorage** de manière à ce qu’il soit identique à celui stocké dans le flux de contenu ou à **CLSID \_ null**; valeur dans une instance **IStorage** nouvellement créée.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-121">For a property set that uses an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance, either set the CLSID of the **IStorage** instance to be the same as that stored in the Contents stream or to **CLSID\_NULL**; the value in a newly created **IStorage** instance.</span></span>
4.  <span data-ttu-id="6e3f9-122">Vous avez la possibilité de spécifier des noms affichables qui constituent le contenu du dictionnaire.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-122">You have the option of specifying displayable names that form the contents of the dictionary.</span></span>

<span data-ttu-id="6e3f9-123">Certaines applications peuvent lire uniquement des implémentations de jeux de propriétés stockées en tant qu’instances [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) .</span><span class="sxs-lookup"><span data-stu-id="6e3f9-123">Some applications can read only implementations of property sets stored as [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instances.</span></span> <span data-ttu-id="6e3f9-124">Les applications doivent être écrites pour s’attendre à ce qu’un jeu de propriétés puisse être stocké dans une instance [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) ou **IStream** , à moins que la définition du jeu de propriétés indique le contraire.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-124">Applications should be written to expect that a property set may be stored in either an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or **IStream** instance, unless the property set definition indicates otherwise.</span></span> <span data-ttu-id="6e3f9-125">Par exemple, la définition du jeu de propriétés informations de synthèse indique qu’elle peut uniquement être stockée dans une instance **IStream** nommée.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-125">For example, the Summary Information property set definition states that it can only be stored in a named **IStream** instance.</span></span> <span data-ttu-id="6e3f9-126">Dans les cas où vous recherchez un jeu de propriétés et que vous ne savez pas s’il s’agit d’un stockage ou d’un flux, recherchez d’abord une instance **IStream** avec votre nom de jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-126">In cases where you are searching for a property set and do not know whether it is a storage or stream, look for an **IStream** instance with your property set name first.</span></span> <span data-ttu-id="6e3f9-127">En cas d’échec, recherchez une instance **IStorage** .</span><span class="sxs-lookup"><span data-stu-id="6e3f9-127">If that fails, look for an **IStorage** instance.</span></span>

<span data-ttu-id="6e3f9-128">Pour mieux comprendre le stockage des jeux de propriétés dans une implémentation [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) , supposez qu’il existe une classe d’applications qui modifient les informations sur les animaux.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-128">To better understand storing property sets in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation, suppose there is a class of applications that edit information about animals.</span></span> <span data-ttu-id="6e3f9-129">Tout d’abord, un CLSID (CLSID \_ AnimalApp) est défini pour cet ensemble d’applications. ils peuvent donc indiquer qu’ils comprennent les jeux de propriétés qui contiennent des informations animales (**fmtid \_ AnimalInfo**) et d’autres qui contiennent des informations médicales (**fmtid \_ MedicalInfo**).</span><span class="sxs-lookup"><span data-stu-id="6e3f9-129">First, a CLSID (CLSID\_AnimalApp) is defined for this set of applications, so they can indicate that they understand property sets that contain animal information (**FMTID\_AnimalInfo**), and others that contain medical information (**FMTID\_MedicalInfo**).</span></span>

``` syntax
IStorage (File): "C:\OLE\REVO.DOC" 
  IStorage: "\005AnimalInfo", CLSID = CLSID_AnimalApp 
    IStream: "Contents" 
      WORD wByteOrder, WORD wFmtVersion, DWORD dwOSVer, 
      CLSID CLSID_AnimalApp, DWORD cSections... 
      ... 
      FMTID = FMTID_AnimalInfo 
      Property: Type = PID_ANIMALTYPE, Type = VT_LPWSTR, 
              Value = L"Dog" 
      Property: Type = PID_ANIMALNAME, Type = VT_LPWSTR, 
              Value = L"Revo" 
      Property: Type = PID_MEDICALHISTORY, Type = VT_STREAMED_OBJECT, 
              Value = "MedicalInfo" 
      ... 
    IStream: "MedicalInfo" 
      WORD wByteOrder, WORD wFmtVersion, DWORD dwOSVer, 
      CLSID CLSID_AnimalApp, DWORD cSections... 
      ... 
      FMTID = CLSID_MedicalInfo 
      Property: Type = PID_VETNAME, Type = VT_LPWSTR, 
              Value = L"Dr. Woof" 
      Property: Type = PID_LASTEXAM, Type = VT_DATE, Value = ...
```

<span data-ttu-id="6e3f9-130">N’oubliez pas que le CLSID de l’interface [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) et les deux jeux de propriétés sont **CLSID \_ AnimalApp**.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-130">Be aware that the CLSID of the [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface and both property sets is **CLSID\_AnimalApp**.</span></span> <span data-ttu-id="6e3f9-131">Cela identifie toute application qui peut afficher et/ou fournir un accès par programme à ces jeux de propriétés.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-131">This identifies any application that can display and/or provide programmatic access to these property sets.</span></span> <span data-ttu-id="6e3f9-132">Toute application peut lire les données dans les jeux de propriétés (le point derrière les jeux de propriétés), mais seules les applications identifiées avec l’identificateur de classe du CLSID \_ AnimalApp peuvent comprendre la signification des données dans les jeux de propriétés.</span><span class="sxs-lookup"><span data-stu-id="6e3f9-132">Any application can read the data within the property sets (the point behind property sets), but only applications identified with the class identifier of CLSID\_AnimalApp can understand the meaning of the data in the property sets.</span></span>

 

 




