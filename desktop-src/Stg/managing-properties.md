---
title: Gestion des propriétés
description: Chaque propriété se compose d’un identificateur de propriété (unique dans son jeu de propriétés), d’une balise de type Variant (VT ou VarType) qui représente le type d’une valeur et de la valeur elle-même.
ms.assetid: d220ecb4-b014-4ac9-a636-9a493187cc87
keywords:
- Stockage structuré Strctd STG, utilisation, gestion des propriétés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 10dd78a1f8a8484090728dba6fe149840e940461
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103842421"
---
# <a name="managing-properties"></a><span data-ttu-id="58f41-104">Gestion des propriétés</span><span class="sxs-lookup"><span data-stu-id="58f41-104">Managing Properties</span></span>

<span data-ttu-id="58f41-105">Chaque propriété se compose d’un *identificateur de propriété* (unique dans son jeu de propriétés), d’une *balise de type Variant (VT ou VarType)* qui représente le type d’une valeur et de la *valeur* elle-même.</span><span class="sxs-lookup"><span data-stu-id="58f41-105">Every property consists of a *property identifier* (unique within its property set), a *variant type (VT or VarType) tag* that represents the type of a value, and the *value* itself.</span></span> <span data-ttu-id="58f41-106">La balise de type Variant décrit la représentation des données dans la valeur.</span><span class="sxs-lookup"><span data-stu-id="58f41-106">The variant type tag describes the representation of the data in the value.</span></span> <span data-ttu-id="58f41-107">En outre, une propriété peut également se voir attribuer un *nom de chaîne* qui peut être utilisé pour identifier la propriété, plutôt que d’utiliser l’identificateur de propriété numérique (ID) requis.</span><span class="sxs-lookup"><span data-stu-id="58f41-107">In addition, a property may also be assigned a *string name* that can be used to identify the property, rather than using the required numerical property identifier (ID).</span></span> <span data-ttu-id="58f41-108">Pour créer et gérer des propriétés, COM définit l’interface [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="58f41-108">To create and manage properties, COM defines the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface.</span></span>

<span data-ttu-id="58f41-109">L’interface [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) comprend des méthodes permettant de lire et d’écrire des tableaux de propriétés ou de noms de propriétés.</span><span class="sxs-lookup"><span data-stu-id="58f41-109">The [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface includes methods to read and write arrays of either properties or property names.</span></span> <span data-ttu-id="58f41-110">L’interface comprend des méthodes [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) et [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) qui sont similaires aux méthodes [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) du même nom.</span><span class="sxs-lookup"><span data-stu-id="58f41-110">The interface includes [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) and [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) methods that are similar to [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) methods of the same name.</span></span> <span data-ttu-id="58f41-111">Il existe des méthodes utilitaires qui vous permettent de définir l’identificateur de classe (CLSID) du jeu de propriétés, de définir les heures associées à l’ensemble et d’obtenir des statistiques sur le jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="58f41-111">There are utility methods that allow you to set the class identifier (CLSID) of the property set, set the times associated with the set, and get statistics about the property set.</span></span> <span data-ttu-id="58f41-112">Enfin, la méthode [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) crée un énumérateur et retourne un pointeur vers son interface [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) .</span><span class="sxs-lookup"><span data-stu-id="58f41-112">Finally, the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method creates an enumerator and returns a pointer to its [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) interface.</span></span> <span data-ttu-id="58f41-113">Vous pouvez appeler les méthodes de cette interface pour énumérer les structures [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) sur votre objet, ce qui fournit des informations sur toutes les propriétés dans le jeu de propriétés actuel.</span><span class="sxs-lookup"><span data-stu-id="58f41-113">You can call the methods of this interface to enumerate [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures on your object, which will provide information about all of the properties in the current property set.</span></span>

<span data-ttu-id="58f41-114">Voici un exemple de la façon dont les propriétés sont représentées.</span><span class="sxs-lookup"><span data-stu-id="58f41-114">The following is an example of how properties are represented.</span></span> <span data-ttu-id="58f41-115">Si une propriété spécifique dans un jeu de propriétés contient le nom scientifique d’un animal, ce nom peut être stocké sous la forme d’une chaîne se terminant par zéro.</span><span class="sxs-lookup"><span data-stu-id="58f41-115">If a specific property in a property set holds an animal's scientific name, that name could be stored as a zero-terminated string.</span></span> <span data-ttu-id="58f41-116">Stocké avec le nom est un indicateur de type pour indiquer que la valeur est une chaîne se terminant par zéro.</span><span class="sxs-lookup"><span data-stu-id="58f41-116">Stored along with the name would be a type indicator to indicate that the value is a zero-terminated string.</span></span> <span data-ttu-id="58f41-117">Ces propriétés peuvent avoir les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="58f41-117">These properties might have the following characteristics:</span></span>



| <span data-ttu-id="58f41-118">ID de propriété</span><span class="sxs-lookup"><span data-stu-id="58f41-118">Property ID</span></span> | <span data-ttu-id="58f41-119">Identificateur de chaîne</span><span class="sxs-lookup"><span data-stu-id="58f41-119">String identifier</span></span> | <span data-ttu-id="58f41-120">Indicateur de type</span><span class="sxs-lookup"><span data-stu-id="58f41-120">Type indicator</span></span> | <span data-ttu-id="58f41-121">Valeur représentée</span><span class="sxs-lookup"><span data-stu-id="58f41-121">Value represented</span></span>              |
|-------------|-------------------|----------------|--------------------------------|
| <span data-ttu-id="58f41-122">02</span><span class="sxs-lookup"><span data-stu-id="58f41-122">02</span></span>          | <span data-ttu-id="58f41-123">PID \_ ANIMALNAME</span><span class="sxs-lookup"><span data-stu-id="58f41-123">PID\_ANIMALNAME</span></span>   | <span data-ttu-id="58f41-124">\_LPWStr VT</span><span class="sxs-lookup"><span data-stu-id="58f41-124">VT\_LPWSTR</span></span>     | <span data-ttu-id="58f41-125">Chaîne Unicode se terminant par zéro</span><span class="sxs-lookup"><span data-stu-id="58f41-125">Zero-terminated Unicode string</span></span> |
| <span data-ttu-id="58f41-126">03</span><span class="sxs-lookup"><span data-stu-id="58f41-126">03</span></span>          | <span data-ttu-id="58f41-127">PID \_ LEGCOUNT</span><span class="sxs-lookup"><span data-stu-id="58f41-127">PID\_LEGCOUNT</span></span>     | <span data-ttu-id="58f41-128">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="58f41-128">VT\_I2</span></span>         | <span data-ttu-id="58f41-129">WORD</span><span class="sxs-lookup"><span data-stu-id="58f41-129">WORD</span></span>                           |



 

<span data-ttu-id="58f41-130">Toute application qui reconnaît le format du jeu de propriétés, en l’identifiant par son identificateur de format (FMTID), peut examiner la propriété avec un identificateur PID \_ ANIMALNAME, déterminer qu’il s’agit d’une chaîne se terminant par zéro, et lire et écrire la valeur.</span><span class="sxs-lookup"><span data-stu-id="58f41-130">Any application that recognizes the property set format—identifying it through its format identifier (FMTID)—can look at the property with an identifier of PID\_ANIMALNAME, determine that it is a zero-terminated string, and read and write the value.</span></span> <span data-ttu-id="58f41-131">Bien que l’application puisse appeler [**IPropertyStorage :: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) pour lire tout ou partie d’un jeu de propriétés (ayant obtenu d’abord un pointeur), l’application doit savoir comment interpréter le jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="58f41-131">Although the application can call [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) to read any or all of a property set (having first obtained a pointer), the application must know how to interpret the property set.</span></span>

<span data-ttu-id="58f41-132">Une valeur de propriété est passée via des interfaces de propriété en tant qu’instance du type [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span><span class="sxs-lookup"><span data-stu-id="58f41-132">A property value is passed through property interfaces as an instance of the type [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span></span>

<span data-ttu-id="58f41-133">Il est important de faire la distinction entre ces propriétés stockées (persistantes) et les propriétés d’exécution.</span><span class="sxs-lookup"><span data-stu-id="58f41-133">It is important to distinguish between these stored (persistent) properties, and run-time properties.</span></span> <span data-ttu-id="58f41-134">Les constantes de valeur de type Variant portent des noms commençant par VT \_ .</span><span class="sxs-lookup"><span data-stu-id="58f41-134">Variant-type value constants have names beginning with VT\_.</span></span> <span data-ttu-id="58f41-135">Toutefois, l’ensemble des PROPVARIANTs valides n’est pas entièrement équivalent à l’ensemble des VARIANTEs utilisées dans les contrôles ActiveX et Automation.</span><span class="sxs-lookup"><span data-stu-id="58f41-135">The set of valid PROPVARIANTs is, however, not entirely equivalent to the set of VARIANTs used in Automation and ActiveX controls.</span></span>

<span data-ttu-id="58f41-136">La seule différence entre les deux structures est l’ensemble autorisé de \_ balises VT (variant type/VarType) dans chaque.</span><span class="sxs-lookup"><span data-stu-id="58f41-136">The only difference between the two structures is the allowable set of VT\_ (Variant Type / VarType) tags in each.</span></span> <span data-ttu-id="58f41-137">Lorsqu’un type de propriété donné peut être utilisé à la fois dans un VARIANT et un PROPVARIANT, la balise de type (la \_ valeur VT) a toujours une valeur identique.</span><span class="sxs-lookup"><span data-stu-id="58f41-137">Where a certain property type can be used in both a VARIANT and a PROPVARIANT, the type tag (the VT\_ value) always has an identical value.</span></span> <span data-ttu-id="58f41-138">En outre, pour une valeur VT donnée \_ , la représentation en mémoire utilisée dans les variantes et PROPVARIANTs est identique.</span><span class="sxs-lookup"><span data-stu-id="58f41-138">Further, for a given VT\_ value, the in-memory representation used in VARIANTs and PROPVARIANTs is identical.</span></span> <span data-ttu-id="58f41-139">Pris ensemble, cette approche permet au système de type d’intercepter les balises de type non autorisées, tout en permettant à un client compétent d’implémenter une conversion de pointeur quand cela est approprié.</span><span class="sxs-lookup"><span data-stu-id="58f41-139">Taken all together, this approach allows the type system to catch disallowed type tags, while at the same time allowing a knowledgeable client to implement a pointer cast when appropriate.</span></span>

<span data-ttu-id="58f41-140">Pour plus d’informations, consultez la section [Considérations sur le stockage des propriétés](property-storage-considerations.md)dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="58f41-140">For more information, see the following section, [Property Storage Considerations](property-storage-considerations.md).</span></span>

 

 