---
title: Sérialisation du jeu de propriétés
description: Il existe deux versions du format de sérialisation du jeu de propriétés.
ms.assetid: 10544118-5e80-47e2-b75b-c1a43be15b2e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49c635728e169cdddb20437323a49a18496b3459
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104199291"
---
# <a name="property-set-serialization"></a><span data-ttu-id="0f601-103">Sérialisation du jeu de propriétés</span><span class="sxs-lookup"><span data-stu-id="0f601-103">Property Set Serialization</span></span>

<span data-ttu-id="0f601-104">Il existe deux versions du format de sérialisation du jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="0f601-104">There are two versions of the property set serialization format.</span></span> <span data-ttu-id="0f601-105">La spécification d’origine décrit la version 0 du format.</span><span class="sxs-lookup"><span data-stu-id="0f601-105">The original specification describes version 0 of the format.</span></span> <span data-ttu-id="0f601-106">Pour plus d’informations, consultez [format version](format-version.md) .</span><span class="sxs-lookup"><span data-stu-id="0f601-106">See [Format Version](format-version.md) for more information.</span></span> <span data-ttu-id="0f601-107">La version 1 étend la version d’origine.</span><span class="sxs-lookup"><span data-stu-id="0f601-107">Version 1 extends the original version.</span></span> <span data-ttu-id="0f601-108">Tous les jeux de propriétés de la version 0 sont valides en tant que jeux de propriétés version 1.</span><span class="sxs-lookup"><span data-stu-id="0f601-108">All version 0 property sets are valid as version 1 property sets.</span></span> <span data-ttu-id="0f601-109">Le champ **version de format** dans l’en-tête d’un jeu de propriétés sérialisées indique la version.</span><span class="sxs-lookup"><span data-stu-id="0f601-109">The **Format Version** field in the header of a serialized property set indicates the version.</span></span>

<span data-ttu-id="0f601-110">Les éléments suivants identifient les différences entre les formats de sérialisation des jeux de propriétés version 0 et version 1.</span><span class="sxs-lookup"><span data-stu-id="0f601-110">The following items identify the differences between version 0 and version 1 property set serialization formats.</span></span>

-   <span data-ttu-id="0f601-111">Prise en charge des nouvelles valeurs **VarType** .</span><span class="sxs-lookup"><span data-stu-id="0f601-111">Support for new **VARTYPE** values.</span></span> <span data-ttu-id="0f601-112">Pour plus d’informations sur les valeurs **VarType** et leur utilisation, consultez la rubrique [IDispatch Data types and structures]( /previous-versions/ms221600(v=vs.100)) et la structure [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="0f601-112">For more information about **VARTYPE** values and how to use them, see the topic [IDispatch Data Types and Structures]( /previous-versions/ms221600(v=vs.100)) and the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

    <span data-ttu-id="0f601-113">Les valeurs **VarType** suivantes ne sont pas prises en charge dans les jeux de propriétés de la version 0, mais sont prises en charge dans la version 1 :</span><span class="sxs-lookup"><span data-stu-id="0f601-113">The following **VARTYPE** values are not supported in version 0 property sets, but are supported in version 1:</span></span>

    <span data-ttu-id="0f601-114">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="0f601-114">VT\_I1</span></span>

    <span data-ttu-id="0f601-115">\_Vecteur VT \| VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="0f601-115">VT\_VECTOR \| VT\_I1</span></span>

    <span data-ttu-id="0f601-116">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="0f601-116">VT\_INT</span></span>

    <span data-ttu-id="0f601-117">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="0f601-117">VT\_UINT</span></span>

    <span data-ttu-id="0f601-118">\_valeur décimale VT</span><span class="sxs-lookup"><span data-stu-id="0f601-118">VT\_DECIMAL</span></span>

    <span data-ttu-id="0f601-119">En outre, les SAFEARRAY peuvent être sérialisés dans un jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="0f601-119">Additionally, SafeArrays can be serialized in a property set.</span></span> <span data-ttu-id="0f601-120">La présence d’un SafeArray est indiquée par le \_ bit de tableau VT combiné, à l’aide d’une opération **or** , avec les éléments de tableau dans le membre **VT** de la structure [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="0f601-120">The presence of a SafeArray is indicated by the VT\_ARRAY bit combined, using an **OR** operation, with the array elements in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span> <span data-ttu-id="0f601-121">Par exemple, un SafeArray d’entiers signés de 4 octets a un type de \_ tableau VT \| VT \_ I4.</span><span class="sxs-lookup"><span data-stu-id="0f601-121">For example, a SafeArray of 4-byte signed integers has a type of VT\_ARRAY \| VT\_I4.</span></span>

    <span data-ttu-id="0f601-122">Les types d’éléments suivants sont valides pour un SafeArray dans un jeu de propriétés sérialisé :</span><span class="sxs-lookup"><span data-stu-id="0f601-122">The following element types are valid for a SafeArray in a serialized property set:</span></span>



|             |          |             |           |
|-------------|----------|-------------|-----------|
| <span data-ttu-id="0f601-123">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="0f601-123">VT\_I1</span></span>      | <span data-ttu-id="0f601-124">\_UI1 VT</span><span class="sxs-lookup"><span data-stu-id="0f601-124">VT\_UI1</span></span>  | <span data-ttu-id="0f601-125">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="0f601-125">VT\_I2</span></span>      | <span data-ttu-id="0f601-126">\_UI2 VT</span><span class="sxs-lookup"><span data-stu-id="0f601-126">VT\_UI2</span></span>   |
| <span data-ttu-id="0f601-127">VT \_</span><span class="sxs-lookup"><span data-stu-id="0f601-127">VT\_I4</span></span>      | <span data-ttu-id="0f601-128">VT \_ UI4</span><span class="sxs-lookup"><span data-stu-id="0f601-128">VT\_UI4</span></span>  | <span data-ttu-id="0f601-129">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="0f601-129">VT\_INT</span></span>     | <span data-ttu-id="0f601-130">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="0f601-130">VT\_UINT</span></span>  |
| <span data-ttu-id="0f601-131">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="0f601-131">VT\_R4</span></span>      | <span data-ttu-id="0f601-132">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="0f601-132">VT\_R8</span></span>   | <span data-ttu-id="0f601-133">VT \_ ca</span><span class="sxs-lookup"><span data-stu-id="0f601-133">VT\_CY</span></span>      | <span data-ttu-id="0f601-134">\_Date VT</span><span class="sxs-lookup"><span data-stu-id="0f601-134">VT\_DATE</span></span>  |
| <span data-ttu-id="0f601-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="0f601-135">VT\_BSTR</span></span>    | <span data-ttu-id="0f601-136">VT \_ bool</span><span class="sxs-lookup"><span data-stu-id="0f601-136">VT\_BOOL</span></span> | <span data-ttu-id="0f601-137">\_valeur décimale VT</span><span class="sxs-lookup"><span data-stu-id="0f601-137">VT\_DECIMAL</span></span> | <span data-ttu-id="0f601-138">\_erreur VT</span><span class="sxs-lookup"><span data-stu-id="0f601-138">VT\_ERROR</span></span> |
| <span data-ttu-id="0f601-139">\_variante VT</span><span class="sxs-lookup"><span data-stu-id="0f601-139">VT\_VARIANT</span></span> |          |             |           |



 

<span data-ttu-id="0f601-140">Lorsque le type de données de la \_ variante VT est spécifié, il indique que le SAFEARRAY lui-même contient des structures [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="0f601-140">When the VT\_VARIANT data type is specified, it indicates that the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="0f601-141">Les types de ces éléments doivent provenir de la liste précédente, sauf qu’ils ne peuvent pas contenir de types de variantes VT imbriqués \_ .</span><span class="sxs-lookup"><span data-stu-id="0f601-141">The types for these elements must be from the preceding list, except they cannot contain nested VT\_VARIANT types.</span></span>

<span data-ttu-id="0f601-142">Notez que les implémentations de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) doivent être en mesure de récupérer correctement en renvoyant une erreur lorsqu’un nouveau type est rencontré ; par exemple, les types VARENUM.</span><span class="sxs-lookup"><span data-stu-id="0f601-142">Note that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) must be able to recover gracefully by returning an error when a new type is encountered; for example, VARENUM types.</span></span>

-   <span data-ttu-id="0f601-143">Noms des propriétés sensibles à la casse.</span><span class="sxs-lookup"><span data-stu-id="0f601-143">Case sensitive property names.</span></span> <span data-ttu-id="0f601-144">Les noms de propriétés, par exemple ceux qui sont spécifiés dans la méthode [**IPropertyStorage :: WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) , ne respectent pas la casse dans les jeux de propriétés de la version 0.</span><span class="sxs-lookup"><span data-stu-id="0f601-144">Property names, for example those specified in the [**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) method, are not case sensitive in version 0 property sets.</span></span> <span data-ttu-id="0f601-145">Dans les jeux de propriétés de la version 1, les noms de propriété peuvent être sensibles à la casse selon la valeur de la nouvelle propriété de comportement.</span><span class="sxs-lookup"><span data-stu-id="0f601-145">In version 1 property sets, property names can be case-sensitive depending on the value of the new Behavior property.</span></span>

    <span data-ttu-id="0f601-146">La propriété Behavior est l' [ID de propriété 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) avec le type VT \_ UI4.</span><span class="sxs-lookup"><span data-stu-id="0f601-146">The Behavior property is [Property ID 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) with a type of VT\_UI4.</span></span> <span data-ttu-id="0f601-147">Si le bit le plus bas de cette valeur est défini, les noms des jeux de propriétés respectent la casse.</span><span class="sxs-lookup"><span data-stu-id="0f601-147">If the lowest bit of this value is set, the property set names are case sensitive.</span></span> <span data-ttu-id="0f601-148">Définissez l' \_ indicateur de respect de la casse PROPSETFLAG \_ dans le paramètre *grfFlags* de la méthode [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) pour spécifier un jeu de propriétés respectant la casse.</span><span class="sxs-lookup"><span data-stu-id="0f601-148">Set the PROPSETFLAG\_CASE\_SENSITIVE flag in the *grfFlags* parameter of the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method to specify a case-sensitive property set.</span></span>

-   <span data-ttu-id="0f601-149">Noms de propriétés de type long.</span><span class="sxs-lookup"><span data-stu-id="0f601-149">Long property names.</span></span> <span data-ttu-id="0f601-150">Les noms de propriété pour les jeux de propriétés de la version 0 doivent être inférieurs ou égaux à 256 caractères, y compris la marque de fin de chaîne, pour les jeux de propriétés dans la page de codes Unicode.</span><span class="sxs-lookup"><span data-stu-id="0f601-150">Property names for version 0 property sets must be less than or equal to 256 characters, including the string terminator, for property sets in the Unicode code page.</span></span> <span data-ttu-id="0f601-151">Si elle ne figure pas dans la page de codes Unicode, elle doit être inférieure à 256 octets.</span><span class="sxs-lookup"><span data-stu-id="0f601-151">If not in the Unicode code page, they must be less than 256 bytes.</span></span> <span data-ttu-id="0f601-152">En revanche, les jeux de propriétés de la version 1 peuvent avoir des noms de propriété de longueur illimitée, bien qu’ils soient toujours limités par la limite de taille du jeu de propriétés global de 256 kilo-octets (Ko).</span><span class="sxs-lookup"><span data-stu-id="0f601-152">Version 1 property sets, on the other hand, can have property names of unlimited length, although they are still limited by the overall property set size limit of 256 kilobytes (KB).</span></span>

<span data-ttu-id="0f601-153">Il est recommandé que les implémentations de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) créent et maintiennent les jeux de propriétés de la version 0 par défaut.</span><span class="sxs-lookup"><span data-stu-id="0f601-153">It is recommended that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) create and maintain version 0 property sets by default.</span></span> <span data-ttu-id="0f601-154">Si un appelant demande par la suite une fonctionnalité spécifique au format version 1, uniquement si la version du jeu de propriétés doit être mise à jour.</span><span class="sxs-lookup"><span data-stu-id="0f601-154">If a caller subsequently requests a feature specific to the version 1 format, only then should the version of the property set be updated.</span></span> <span data-ttu-id="0f601-155">Par exemple, si une propriété de type VT \_ Array est écrite ou si un nom de propriété long est écrit, l’implémentation doit mettre à jour le format du jeu de propriétés à la version 1.</span><span class="sxs-lookup"><span data-stu-id="0f601-155">For example, if a property of type VT\_ARRAY is written or if a long property name is written, then the implementation should update the property set format to version 1.</span></span> <span data-ttu-id="0f601-156">Une exception à cette règle se produit si la \_ \_ valeur d’énumération sensible à la casse PROPSETFLAG est spécifiée dans l’appel à [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="0f601-156">One exception to this guideline occurs if the PROPSETFLAG\_CASE\_SENSITIVE enumeration value is specified in the call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="0f601-157">Dans ce cas, le jeu de propriétés doit être créé en tant que jeu de propriétés de la version 1.</span><span class="sxs-lookup"><span data-stu-id="0f601-157">In this case, the property set must be created as a version 1 property set.</span></span>

 

 