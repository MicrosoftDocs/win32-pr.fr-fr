---
title: Implémentation de fichiers IPropertyStorage-Compound
description: L’implémentation COM de l’architecture de stockage structurée est appelée fichiers composés.
ms.assetid: c4b4f313-de58-44f2-8ce1-a07cc187d8ca
keywords:
- IPropertyStorage Strctd STG, implémentations, fichier composé
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03d927b0145077f12e5ba508ca65554ca33633a3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103842422"
---
# <a name="ipropertystorage-compound-file-implementation"></a><span data-ttu-id="5f6fe-104">Implémentation de fichiers IPropertyStorage-Compound</span><span class="sxs-lookup"><span data-stu-id="5f6fe-104">IPropertyStorage-Compound File Implementation</span></span>

<span data-ttu-id="5f6fe-105">L’implémentation COM de l’architecture de stockage structurée est appelée [fichiers composés](istorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="5f6fe-105">The COM implementation of the Structured Storage architecture is called [compound files](istorage-compound-file-implementation.md).</span></span> <span data-ttu-id="5f6fe-106">Les objets de stockage tels qu’ils sont implémentés dans les fichiers composés incluent une implémentation de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), l’interface qui gère un jeu de propriétés persistantes unique et [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), l’interface qui gère les groupes de jeux de propriétés persistantes.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-106">Storage objects as implemented in compound files include an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span> <span data-ttu-id="5f6fe-107">Pour plus d’informations sur l’interface **IPropertyStorage** , consultez [considérations relatives au stockage des propriétés](property-storage-considerations.md)et **IPropertyStorage** .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-107">For more information about the **IPropertyStorage** interface, see **IPropertyStorage** and [Property Storage Considerations](property-storage-considerations.md).</span></span>

<span data-ttu-id="5f6fe-108">Pour obtenir un pointeur vers l’implémentation de fichier composé de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), appelez [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) pour créer un objet de fichier composé ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) pour ouvrir un objet de fichier composé créé précédemment.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-108">To get a pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create a new compound file object or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file object.</span></span> <span data-ttu-id="5f6fe-109">Dans le cas de **StgCreateStorageEx**, le paramètre *stgfmt* doit être défini sur \_ stockage stgfmt.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-109">In the case of **StgCreateStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE.</span></span> <span data-ttu-id="5f6fe-110">Dans le cas de **StgOpenStorageEx**, le paramètre *stgfmt* doit être défini sur \_ stockage stgfmt ou stgfmt \_ Any.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-110">In the case of **StgOpenStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE or STGFMT\_ANY.</span></span> <span data-ttu-id="5f6fe-111">Dans les deux cas, le paramètre *riid* doit avoir la valeur IID \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-111">In both cases, the *riid* parameter should be set to IID\_IPropertySetStorage.</span></span> <span data-ttu-id="5f6fe-112">Les deux fonctions fournissent un pointeur vers l’interface de l’objet [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-112">Both functions supply a pointer to the object [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span> <span data-ttu-id="5f6fe-113">En appelant la méthode [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) ou [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) de cette interface, vous obtiendrez un pointeur vers l’interface **IPropertyStorage** , que vous pouvez utiliser pour appeler l’une de ses méthodes.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-113">By calling either the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) or [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method of that interface, you will get a pointer to the **IPropertyStorage** interface, which you can use to call any of its methods.</span></span>

<span data-ttu-id="5f6fe-114">Une autre façon d’obtenir un pointeur vers l’implémentation de fichier composé de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) consiste à appeler les fonctions [**StgCreateDocFile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) et [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) plus anciennes, ou à spécifier un paramètre *riid* d’IID \_ IStorage pour la fonction [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-114">An alternative way to get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is to call the older [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) and [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions, or to specify an *riid* parameter of IID\_IStorage to the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="5f6fe-115">Dans les deux cas, un pointeur vers l’interface [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) de l’objet est retourné.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-115">In either case, a pointer to the object's [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is returned.</span></span> <span data-ttu-id="5f6fe-116">Avec les jeux de propriétés persistants, appelez [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) pour l’interface **IPropertySetStorage** , en spécifiant le nom défini par l’en-tête pour l’IID (identificateur d’interface) IID \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-116">With persistent property sets, call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the **IPropertySetStorage** interface, specifying the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="5f6fe-117">Quand l’utiliser</span><span class="sxs-lookup"><span data-stu-id="5f6fe-117">When to Use</span></span>

<span data-ttu-id="5f6fe-118">Utilisez [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) pour gérer les propriétés dans un même jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) to manage properties within a single property set.</span></span> <span data-ttu-id="5f6fe-119">Ses méthodes prennent en charge la lecture, l’écriture et la suppression des propriétés et des noms de chaînes facultatifs qui peuvent être associés à des identificateurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-119">Its methods support reading, writing, and deleting both properties and the optional string names that can be associated with property identifiers.</span></span> <span data-ttu-id="5f6fe-120">Les autres méthodes prennent en charge la validation standard et les opérations de restauration de stockage.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-120">Other methods support the standard commit and revert storage operations.</span></span> <span data-ttu-id="5f6fe-121">Il existe également une méthode qui vous permet de définir les heures associées au stockage des propriétés, et une autre qui autorise l’attribution d’un CLSID qui peut être utilisé pour associer un autre code, tel que le code de l’interface utilisateur, au jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-121">There is also a method that enables you to set times associated with the property storage, and another that permits the assignment of a CLSID that can be used to associate other code, such as user interface code, with the property set.</span></span> <span data-ttu-id="5f6fe-122">L’appel de la méthode [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) fournit un pointeur vers l’implémentation de fichier composé de [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), qui vous permet d’énumérer les propriétés dans le jeu.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-122">Calling the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method supplies a pointer to the compound file implementation of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), which allows you to enumerate the properties in the set.</span></span>

> [!Note]  
> <span data-ttu-id="5f6fe-123">Si vous obtenez un pointeur vers [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) en appelant [**StgCreateDocFile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) sur un stockage de jeu de propriétés en mode simple, les méthodes **IPropertyStorage** adhèrent aux règles des flux en mode simple.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-123">If you obtain a pointer to [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) by calling [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) on a simple-mode property set storage, the **IPropertyStorage** methods adhere to the rules of simple-mode streams.</span></span> <span data-ttu-id="5f6fe-124">Le stockage de jeu de propriétés est un mode simple s’il a été obtenu pour un fichier qui a été créé ou ouvert avec l' \_ indicateur simple STGM.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-124">The property set storage is simple mode if it was obtained for a file that was created or opened with the STGM\_SIMPLE flag.</span></span> <span data-ttu-id="5f6fe-125">Dans ce cas, il n’est pas toujours possible de rendre le flux sous-jacent plus grand et il n’est pas possible de remplacer des propriétés existantes par des propriétés plus grandes.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-125">In this case, it is not always possible to make the underlying stream larger and it is not possible to replace existing properties with larger properties.</span></span> <span data-ttu-id="5f6fe-126">Pour plus d’informations, consultez [IPropertySetStorage-composed file Implementation](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="5f6fe-126">For more information, see [IPropertySetStorage-Compound File Implementation](ipropertysetstorage-compound-file-implementation.md).</span></span>

 

## <a name="ipropertystorage-and-caching"></a><span data-ttu-id="5f6fe-127">IPropertyStorage et mise en cache</span><span class="sxs-lookup"><span data-stu-id="5f6fe-127">IPropertyStorage and Caching</span></span>

<span data-ttu-id="5f6fe-128">L’implémentation de fichier composé de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) met en cache les jeux de propriétés ouverts en mémoire afin d’améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-128">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) caches open property sets in memory in order to improve performance.</span></span> <span data-ttu-id="5f6fe-129">Par conséquent, les modifications apportées à un jeu de propriétés ne sont pas écrites dans le fichier composé tant que les méthodes [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) ou **Release** (dernière référence) ne sont pas appelées.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-129">As a result, changes to a property set are not written to the compound file until the [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or **Release** (last reference) methods are called.</span></span>

## <a name="simple-mode-property-sets"></a><span data-ttu-id="5f6fe-130">Jeux de propriétés en mode simple</span><span class="sxs-lookup"><span data-stu-id="5f6fe-130">Simple Mode Property Sets</span></span>

<span data-ttu-id="5f6fe-131">Un objet de stockage de propriétés est en mode simple s’il est créé à partir d’un objet de stockage de jeu de propriétés de mode simple.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-131">A property storage object is in simple mode if it is created from a simple mode property set storage object.</span></span> <span data-ttu-id="5f6fe-132">Par exemple, un objet de stockage de jeu de propriétés serait en mode simple s’il a été obtenu à partir de la fonction [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) , avec l' \_ indicateur simple STGM défini dans le paramètre *grfMode* .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-132">For example, a property set storage object would be in simple mode if it were obtained from the [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, with the STGM\_SIMPLE flag set in the *grfMode* parameter.</span></span> <span data-ttu-id="5f6fe-133">Notez que « mode simple » n’est pas lié aux « jeux de propriétés simples ».</span><span class="sxs-lookup"><span data-stu-id="5f6fe-133">Note that "simple mode" is unrelated to "simple property sets".</span></span> <span data-ttu-id="5f6fe-134">Un jeu de propriétés est simple s’il est créé en appelant [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) avec l’indicateur PROPSETFLAG non \_ simple défini dans le paramètre *grfFlags* .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-134">A property set is simple if it is created by calling [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) with the PROPSETFLAG\_NONSIMPLE flag set in the *grfFlags* parameter.</span></span> <span data-ttu-id="5f6fe-135">Pour plus d’informations sur les jeux de propriétés simples et simples, consultez [stockage et objets de flux pour un jeu de propriétés](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="5f6fe-135">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

<span data-ttu-id="5f6fe-136">Lorsqu’un objet de stockage de propriété en mode simple est créé, il n’y a aucune restriction sur son utilisation.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-136">When a simple mode property storage object is created, there are no restrictions on its use.</span></span> <span data-ttu-id="5f6fe-137">Lorsqu’un objet de stockage de propriétés en mode simple existant est ouvert, l’objet de flux sous-jacent qui stocke le jeu de propriétés ne peut pas être augmenté.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-137">When an existing simple-mode property storage object is opened, the underlying stream object that stores the property set cannot be grown.</span></span> <span data-ttu-id="5f6fe-138">Par conséquent, il n’est pas toujours possible de modifier un tel objet de stockage de propriétés si la modification requiert un flux de plus grande taille.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-138">Consequently, it is not always possible to modify such a property storage object if the change requires a larger stream.</span></span>

## <a name="property-set-formats"></a><span data-ttu-id="5f6fe-139">Formats de jeu de propriétés</span><span class="sxs-lookup"><span data-stu-id="5f6fe-139">Property Set Formats</span></span>

<span data-ttu-id="5f6fe-140">L’implémentation de fichier composé de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) prend en charge les formats de sérialisation des jeux de propriétés version 0 et version 1.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-140">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports both the version 0 and the version 1 property set serialization formats.</span></span> <span data-ttu-id="5f6fe-141">Le format version 1 est pris en charge sur les ordinateurs qui exécutent Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-141">The version 1 format is supported on computers running on Windows 2000.</span></span> <span data-ttu-id="5f6fe-142">Pour plus d’informations, consultez [sérialisation du jeu de propriétés](version-0-vs--version-1-property-set-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="5f6fe-142">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span> <span data-ttu-id="5f6fe-143">Les jeux de propriétés sont créés au format version 0 et restent dans ce format, sauf si de nouvelles fonctionnalités sont demandées.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-143">Property sets are created in version 0 format and remain in that format unless new features are requested.</span></span> <span data-ttu-id="5f6fe-144">Lorsque cela se produit, le format est mis à jour vers la version 1.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-144">When that occurs, the format is updated to version 1.</span></span>

<span data-ttu-id="5f6fe-145">Par exemple, si un jeu de propriétés est créé avec l' \_ indicateur par défaut PROPSETFLAG, son format est version 0.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-145">For example, if a property set is created with the PROPSETFLAG\_DEFAULT flag, its format is version 0.</span></span> <span data-ttu-id="5f6fe-146">Tant que les types de propriété conformes au format de version 0 sont écrits et lus à partir de ce jeu de propriétés, le jeu de propriétés reste au format de la version 0.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-146">As long as property types that conform to the version 0 format are written to and read from that property set, the property set remains in version 0 format.</span></span> <span data-ttu-id="5f6fe-147">Si un type de propriété de la version 1 est écrit dans le jeu de propriétés, le jeu de propriétés est automatiquement mis à jour vers la version 1.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-147">If a version 1 property type is written to the property set, the property set is automatically updated to version 1.</span></span> <span data-ttu-id="5f6fe-148">Par la suite, ce jeu de propriétés ne peut plus être lu par les implémentations qui reconnaissent uniquement la version 0.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-148">Subsequently, that property set can no longer be read by implementations that recognize only version 0.</span></span>

## <a name="ipropertystorage-and-variant-types"></a><span data-ttu-id="5f6fe-149">Types IPropertyStorage et variant</span><span class="sxs-lookup"><span data-stu-id="5f6fe-149">IPropertyStorage and Variant Types</span></span>

<span data-ttu-id="5f6fe-150">L’implémentation de fichier composé de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) ne prend pas en charge les types variant VT \_ Unknown ou VT \_ Dispatch dans le membre **VT** de la structure [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-150">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) does not support the variant types VT\_UNKNOWN or VT\_DISPATCH in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="5f6fe-151">Le tableau suivant répertorie les types variant pris en charge dans un SafeArray. autrement dit, ces valeurs peuvent être combinées avec \_ un tableau VT dans le membre **VT** de la structure [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-151">The following table lists variant types that are supported within a SafeArray; that is, these values can be combined with VT\_ARRAY in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>



<span data-ttu-id="5f6fe-152">Types variant pris en charge dans SafeArray par implémentation de fichier composé de IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="5f6fe-152">Variant types supported within SafeArray by compound file implementation of IPropertyStorage</span></span>

<span data-ttu-id="5f6fe-153">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="5f6fe-153">VT\_I1</span></span>

<span data-ttu-id="5f6fe-154">\_UI1 VT</span><span class="sxs-lookup"><span data-stu-id="5f6fe-154">VT\_UI1</span></span>

<span data-ttu-id="5f6fe-155">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="5f6fe-155">VT\_I2</span></span>

<span data-ttu-id="5f6fe-156">\_UI2 VT</span><span class="sxs-lookup"><span data-stu-id="5f6fe-156">VT\_UI2</span></span>

<span data-ttu-id="5f6fe-157">VT \_</span><span class="sxs-lookup"><span data-stu-id="5f6fe-157">VT\_I4</span></span>

<span data-ttu-id="5f6fe-158">VT \_ UI4</span><span class="sxs-lookup"><span data-stu-id="5f6fe-158">VT\_UI4</span></span>

<span data-ttu-id="5f6fe-159">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="5f6fe-159">VT\_INT</span></span>

<span data-ttu-id="5f6fe-160">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="5f6fe-160">VT\_UINT</span></span>

<span data-ttu-id="5f6fe-161">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="5f6fe-161">VT\_R4</span></span>

<span data-ttu-id="5f6fe-162">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="5f6fe-162">VT\_R8</span></span>

<span data-ttu-id="5f6fe-163">VT \_ ca</span><span class="sxs-lookup"><span data-stu-id="5f6fe-163">VT\_CY</span></span>

<span data-ttu-id="5f6fe-164">\_Date VT</span><span class="sxs-lookup"><span data-stu-id="5f6fe-164">VT\_DATE</span></span>

<span data-ttu-id="5f6fe-165">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5f6fe-165">VT\_BSTR</span></span>

<span data-ttu-id="5f6fe-166">VT \_ bool</span><span class="sxs-lookup"><span data-stu-id="5f6fe-166">VT\_BOOL</span></span>

<span data-ttu-id="5f6fe-167">\_valeur décimale VT</span><span class="sxs-lookup"><span data-stu-id="5f6fe-167">VT\_DECIMAL</span></span>

<span data-ttu-id="5f6fe-168">\_erreur VT</span><span class="sxs-lookup"><span data-stu-id="5f6fe-168">VT\_ERROR</span></span>

<span data-ttu-id="5f6fe-169">\_variante VT</span><span class="sxs-lookup"><span data-stu-id="5f6fe-169">VT\_VARIANT</span></span>

 



 

<span data-ttu-id="5f6fe-170">Lorsque VT \_ Variant est combiné avec \_ un tableau VT, le SAFEARRAY lui-même contient des structures [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-170">When VT\_VARIANT is combined with VT\_ARRAY, the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="5f6fe-171">Toutefois, les types de ces éléments doivent être extraits de la liste précédente, ne peuvent pas être des \_ variantes VT et ne peuvent pas inclure les \_ indicateurs de vecteur VT, de \_ matrice VT ou VT \_ .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-171">However, the types of these elements must be taken from the preceding list, cannot be VT\_VARIANT, and cannot include the VT\_VECTOR, VT\_ARRAY, or VT\_BYREF indicators.</span></span>

## <a name="ipropertystorage-methods"></a><span data-ttu-id="5f6fe-172">Méthodes IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="5f6fe-172">IPropertyStorage Methods</span></span>

<span data-ttu-id="5f6fe-173">L’implémentation de fichier composé de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) prend en charge les méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="5f6fe-173">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports the following methods:</span></span>

<dl> <dt>

<span data-ttu-id="5f6fe-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-175">Lit les propriétés spécifiées dans le tableau *rgpspec* et fournit les valeurs de toutes les propriétés valides dans le tableau *rgvar* de PROPVARIANTs.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-175">Reads the properties specified in the *rgpspec* array and supplies the values of all valid properties in the *rgvar* array of PROPVARIANTs.</span></span> <span data-ttu-id="5f6fe-176">Dans l’implémentation de fichier composé COM, les identificateurs de propriété dupliqués qui font référence à des types de flux ou de stockage entraînent plusieurs appels à [**IStorage :: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) ou [**IStorage :: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) et la réussite ou l’échec de **ReadMultiple** dépend de la capacité de l’implémentation de stockage sous-jacente à partager les opérations d’ouverture.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-176">In the COM compound file implementation, duplicate property identifiers that refer to stream or storage types result in multiple calls to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) and the success or failure of **ReadMultiple** depends on the underlying storage implementation's ability to share opening operations.</span></span> <span data-ttu-id="5f6fe-177">Étant donné que dans un fichier composé \_ , le partage STGM \_ exclusif est forcé, le fait que plusieurs tentatives d’ouverture échouent.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-177">Because in a compound file STGM\_SHARE\_EXCLUSIVE is forced, multiple open attempts will fail.</span></span> <span data-ttu-id="5f6fe-178">L’ouverture d’un même objet de stockage plusieurs fois à partir du même stockage parent n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-178">Opening the same storage object more than once from the same parent storage is not supported.</span></span> <span data-ttu-id="5f6fe-179">L' \_ indicateur STGM share \_ exclusive doit être spécifié.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-179">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

<span data-ttu-id="5f6fe-180">En outre, pour garantir une opération thread-safe si la même propriété de flux ou de valeur de stockage est demandée plusieurs fois via le même pointeur [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) dans l’implémentation de fichier composé com, l’opération d’ouverture réussira ou échouera selon que la propriété est déjà ouverte et si le système de fichiers sous-jacent gère plusieurs ouvertures d’un flux ou d’un stockage.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-180">In addition, to ensure thread-safe operation if the same stream- or storage-valued property is requested several times through the same [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) pointer in the COM compound file implementation, the open operation will succeed or fail depending on whether the property is already open and whether the underlying file system handles multiple openings of a stream or storage.</span></span> <span data-ttu-id="5f6fe-181">Ainsi, l’opération **ReadMultiple** sur une propriété de flux ou de valeur de stockage entraîne toujours un appel à [**IStorage :: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)ou [**IStorage :: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), qui passe l’accès (STGM ReadWrite, etc. \_ ) et les indicateurs de partage (STGM \_ share \_ exclusive, etc.) spécifiés lors de l’ouverture ou de la création du jeu de propriétés d’origine.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-181">Thus, the **ReadMultiple** operation on a stream- or storage-valued property always results in a call to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream), or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), which passes the access (STGM\_READWRITE, and so forth) and share flags (STGM\_SHARE\_EXCLUSIVE, and so on) specified when the original property set was opened or created.</span></span>

<span data-ttu-id="5f6fe-182">Si la méthode échoue, les valeurs écrites dans *rgvar* \[ \] ne sont pas définies.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-182">If the method fails, the values written to *rgvar*\[\] are undefined.</span></span> <span data-ttu-id="5f6fe-183">Si certaines propriétés de flux ou de stockage sont ouvertes avec succès mais qu’une erreur se produit avant la fin de l’exécution, celles-ci doivent être libérées avant le retour de la méthode.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-183">If some stream- or storage-valued properties are opened successfully but an error occurs before execution is complete, these should be released before the method returns.</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-185">Écrit les propriétés spécifiées dans le tableau *rgpspec* , en leur \[ \] assignant les balises et les valeurs [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) spécifiées dans *rgvar* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-185">Writes the properties specified in the *rgpspec*\[\] array, assigning them the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) tags and values specified in *rgvar*\[\].</span></span> <span data-ttu-id="5f6fe-186">Les valeurs **PROPVARIANT** spécifiées sont affectées aux propriétés qui existent déjà.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-186">Properties that already exist are assigned the specified **PROPVARIANT** values.</span></span> <span data-ttu-id="5f6fe-187">Les propriétés qui n’existent pas sont créées.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-187">Properties that do not currently exist are created.</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage ::D eleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-189">Supprime les propriétés spécifiées dans *rgpspec* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-189">Deletes the properties specified in the *rgpspec*\[\].</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-191">Lit les noms de chaîne existants associés aux ID de propriété spécifiés dans le tableau *rgpropid* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-191">Reads existing string names associated with the property IDs specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-193">Attribue des noms de chaîne spécifiés dans le tableau *rglpwstrName* aux ID de propriété spécifiés dans le tableau *rgpropid* .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-193">Assigns string names specified in the *rglpwstrName* array to property IDs specified in the *rgpropid* array.</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage ::D eletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::DeletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-195">Supprime les noms de propriété pour les propriétés spécifiées dans le tableau *rgpropid* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-195">Deletes property names for the properties specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-197">Définit le **CLSID** du flux de jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-197">Sets the **CLSID** of the property set stream.</span></span> <span data-ttu-id="5f6fe-198">Dans l’implémentation de fichier composé, la définition du CLSID sur un jeu de propriétés non simple (un qui peut légalement contenir des propriétés de stockage ou de valeur de flux, comme décrit dans [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) définit également le CLSID sur le sous-stockage sous-jacent afin qu’il puisse être obtenu via un appel à [**IStorage :: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span><span class="sxs-lookup"><span data-stu-id="5f6fe-198">In the compound file implementation, setting the CLSID on a nonsimple property set (one that can legally contain storage- or stream-valued properties, as described in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) also sets the CLSID on the underlying substorage so that it can be obtained through a call to [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage :: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-200">Pour les jeux de propriétés simples et simples, vide l’image mémoire du jeu de propriétés sur le stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-200">For both simple and nonsimple property sets, flushes the property set memory image to the underlying storage.</span></span> <span data-ttu-id="5f6fe-201">En outre, pour les jeux de propriétés de mode transactionnel non simple, cette méthode effectue une validation (comme dans [**IStorage :: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) sur le stockage qui contient le jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-201">In addition, for nonsimple transacted-mode property sets, this method performs a commit (as in [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) on the storage which contains the property set.</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage :: Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage::Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-203">Pour les jeux de propriétés qui ne sont pas simples, appelle la méthode [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) du stockage sous-jacent et ouvre à nouveau le flux de contenu.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-203">For nonsimple property sets only, calls the [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) method of the underlying storage and reopens the 'contents' stream.</span></span> <span data-ttu-id="5f6fe-204">Pour les jeux de propriétés simples, cette interface retourne toujours S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-204">For simple property sets, this interface always returns S\_OK.</span></span> <span data-ttu-id="5f6fe-205">Les jeux de propriétés insimples sont ceux qui ont été créés à l’aide de l' \_ indicateur PROPSETFLAG unsimple dans la méthode [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-205">Nonsimple property sets are those which were created using the PROPSETFLAG\_NONSIMPLE flag in the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method.</span></span> <span data-ttu-id="5f6fe-206">Pour plus d’informations, consultez [stockage et objets de flux pour un jeu de propriétés](storage-vs--stream-for-a-property-set.md) .</span><span class="sxs-lookup"><span data-stu-id="5f6fe-206">For more information, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md) .</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage :: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-208">Construit une instance de [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), dont les méthodes peuvent être appelées pour énumérer les structures [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) qui fournissent des informations sur chacune des propriétés de l’ensemble.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-208">Constructs an instance of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), the methods of which can be called to enumerate the [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures that provide information about each of the properties in the set.</span></span> <span data-ttu-id="5f6fe-209">Cette implémentation crée un tableau dans lequel le jeu de propriétés entier est lu et qui peut être partagé quand **IEnumSTATPROPSTG :: Clone** est appelé.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-209">This implementation creates an array into which the entire property set is read and which can be shared when **IEnumSTATPROPSTG::Clone** is called.</span></span> <span data-ttu-id="5f6fe-210">Les modifications apportées au jeu de propriétés ne sont pas reflétées dans une instance **IEnumSTATPROPSTG** ouverte.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-210">Changes to the property set are not reflected in an open **IEnumSTATPROPSTG** instance.</span></span> <span data-ttu-id="5f6fe-211">Pour voir ces modifications, une nouvelle instance de cet énumérateur doit être construite.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-211">To see such changes, a new instance of this enumerator must be constructed.</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage :: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-213">Remplit les membres d’une structure [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , qui contient les données relatives à la propriété définie dans son ensemble.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-213">Fills in the members of a [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure, which contains data about the property set as a whole.</span></span> <span data-ttu-id="5f6fe-214">Au retour, fournit un pointeur vers la structure.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-214">On return, supplies a pointer to the structure.</span></span> <span data-ttu-id="5f6fe-215">Pour les jeux de stockage qui ne sont pas simples, cette implémentation appelle [**IStorage :: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (ou [**IStream :: stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) pour obtenir les heures du flux ou du stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-215">For nonsimple storage sets, this implementation calls [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (or [**IStream::Stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) to get the times from the underlying storage or stream.</span></span> <span data-ttu-id="5f6fe-216">Pour les jeux de stockage simples, aucune heure n’est conservée.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-216">For simple storage sets, no times are maintained.</span></span>

</dd> <dt>

<span data-ttu-id="5f6fe-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span><span class="sxs-lookup"><span data-stu-id="5f6fe-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span></span>
</dt> <dd>

<span data-ttu-id="5f6fe-218">Pour les jeux de propriétés qui ne sont pas simples, définit les heures prises en charge par le stockage sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-218">For nonsimple property sets only, sets the times supported by the underlying storage.</span></span> <span data-ttu-id="5f6fe-219">L’implémentation du stockage de fichiers composés prend en charge les trois éléments suivants : modification, accès et création.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-219">The compound file storage implementation supports all three: modification, access, and creation.</span></span> <span data-ttu-id="5f6fe-220">Cette implémentation de [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) appelle la méthode [**IStorage :: SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) du stockage sous-jacent pour récupérer ces heures.</span><span class="sxs-lookup"><span data-stu-id="5f6fe-220">This implementation of [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) calls the [**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) method of the underlying storage to retrieve these times.</span></span>

</dd> </dl>

## <a name="related-topics"></a><span data-ttu-id="5f6fe-221">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="5f6fe-221">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5f6fe-222">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="5f6fe-222">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="5f6fe-223">**IStorage :: SetElementTimes**</span><span class="sxs-lookup"><span data-stu-id="5f6fe-223">**IStorage::SetElementTimes**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)
</dt> </dl>

 

 