---
title: Caractéristiques de performances
description: Un appel à l’implémentation de fichier composé COM de l’interface IPropertySetStorage pour créer un jeu de propriétés entraîne la création d’un flux ou d’un stockage via un appel à IStorage CreateStream, ou IStorage CreateStorage.
ms.assetid: 7773e649-19a4-4df2-84ed-027d73283140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8597862602a367ed93a3d6e5e0bcac76035c337a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103941141"
---
# <a name="performance-characteristics"></a><span data-ttu-id="354bb-103">Caractéristiques de performances</span><span class="sxs-lookup"><span data-stu-id="354bb-103">Performance Characteristics</span></span>

<span data-ttu-id="354bb-104">Un appel à l’implémentation de fichier composé COM de l’interface [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) pour créer un jeu de propriétés entraîne la création d’un flux ou d’un stockage via un appel à [**IStorage :: CreateStream,**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) ou [**IStorage :: CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span><span class="sxs-lookup"><span data-stu-id="354bb-104">A call to the COM compound file implementation of the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to create a property set causes either a stream or storage to be created through a call to [**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) or [**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span></span> <span data-ttu-id="354bb-105">Un jeu de propriétés par défaut est créé en mémoire, mais il n’est pas vidé sur le disque.</span><span class="sxs-lookup"><span data-stu-id="354bb-105">A default property set is created in memory, but not flushed to disk.</span></span> <span data-ttu-id="354bb-106">Lorsqu’il y a un appel à [**IPropertyStorage :: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), il s’exécute dans la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="354bb-106">When there is a call to [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), it operates within the buffer.</span></span>

<span data-ttu-id="354bb-107">Quand un jeu de propriétés est ouvert, [IStorage :: OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) ou [IStorage :: OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) est utilisé.</span><span class="sxs-lookup"><span data-stu-id="354bb-107">When a property set is opened, [IStorage::OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [IStorage::OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) is used.</span></span> <span data-ttu-id="354bb-108">L’ensemble du flux de propriétés est lu dans la mémoire contiguë.</span><span class="sxs-lookup"><span data-stu-id="354bb-108">The entire property set stream is read into contiguous memory.</span></span> <span data-ttu-id="354bb-109">Les opérations [**IPropertyStorage :: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) fonctionnent alors en lisant la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="354bb-109">[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) operations then operate by reading the memory buffer.</span></span> <span data-ttu-id="354bb-110">Par conséquent, le premier accès est coûteux en termes de temps (en raison des lectures sur le disque), mais les accès ultérieurs sont très efficaces.</span><span class="sxs-lookup"><span data-stu-id="354bb-110">Therefore, the first access is expensive in terms of time (because of disk reads) but subsequent accesses are very efficient.</span></span> <span data-ttu-id="354bb-111">Les écritures peuvent être légèrement plus coûteuses, car les opérations de configuration sur le flux sous-jacent peuvent être nécessaires pour garantir que l’espace disque est disponible si des données sont ajoutées.</span><span class="sxs-lookup"><span data-stu-id="354bb-111">Writes may be slightly more expensive because SetSize operations on the underlying stream may be required to guarantee that disk space is available if data is added.</span></span>

<span data-ttu-id="354bb-112">Aucune garantie n’est faite pour si [**IPropertyStorage :: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) vide les mises à jour.</span><span class="sxs-lookup"><span data-stu-id="354bb-112">No guarantees are made as to whether [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) will flush updates.</span></span> <span data-ttu-id="354bb-113">En général, le client doit supposer que **IPropertyStorage :: WriteMultiple** met à jour uniquement le en mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="354bb-113">In general, the client should assume that **IPropertyStorage::WriteMultiple** only updates the in memory buffer.</span></span> <span data-ttu-id="354bb-114">Pour vider des données, [**IPropertyStorage :: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) ou [**IUnknown :: Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (dernière version) doit être appelé.</span><span class="sxs-lookup"><span data-stu-id="354bb-114">To flush data, [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or [**IUnknown::Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (last release) should be called.</span></span>

<span data-ttu-id="354bb-115">Cette conception signifie que [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) peut aboutir, mais que les données ne sont pas réellement écrites de façon permanente.</span><span class="sxs-lookup"><span data-stu-id="354bb-115">This design means that [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) may succeed but the data is not actually persistently written.</span></span>

> [!Note]  
> <span data-ttu-id="354bb-116">Cette taille du flux de jeu de propriétés ne peut pas dépasser 256 Ko.</span><span class="sxs-lookup"><span data-stu-id="354bb-116">This size of the property set stream cannot exceed 256K bytes.</span></span>

 

 

 