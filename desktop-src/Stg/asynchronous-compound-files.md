---
title: Fichiers composés asynchrones
description: Les fichiers composés asynchrones, l’implémentation fournie par le système du stockage asynchrone, permettent le téléchargement efficace des fichiers composés à partir d’Internet en général et du Web en particulier.
ms.assetid: 6cad074e-07a8-434f-a402-e29cb66a1a18
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 04de2162b50283b12bc8deed6ec908d92e7584d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104382433"
---
# <a name="asynchronous-compound-files"></a><span data-ttu-id="cecb9-103">Fichiers composés asynchrones</span><span class="sxs-lookup"><span data-stu-id="cecb9-103">Asynchronous Compound Files</span></span>

<span data-ttu-id="cecb9-104">Les fichiers composés asynchrones, l’implémentation fournie par le système du stockage asynchrone, permettent le téléchargement efficace des fichiers composés à partir d’Internet en général et du Web en particulier.</span><span class="sxs-lookup"><span data-stu-id="cecb9-104">Asynchronous Compound Files, the system-provided implementation of asynchronous storage, enables the efficient downloading of compound files from the Internet in general and the Web in particular.</span></span> <span data-ttu-id="cecb9-105">L’architecture de base des fichiers composés asynchrones est présentée dans le diagramme suivant.</span><span class="sxs-lookup"><span data-stu-id="cecb9-105">The basic architecture of Asynchronous Compound Files is shown in the following diagram.</span></span>

![architecture de base des fichiers composés asynchrones](images/asy-stor.png)

<span data-ttu-id="cecb9-107">L’implémentation de fichiers composés asynchrones peut fonctionner avec de nouveaux types de moniker asynchrones qui comprennent les protocoles Internet et peuvent établir une liaison à un objet identifié par une URL.</span><span class="sxs-lookup"><span data-stu-id="cecb9-107">The Asynchronous Compound Files implementation can work with new asynchronous moniker types that understand Internet protocols and can bind to an object identified by a URL.</span></span> <span data-ttu-id="cecb9-108">Un tel moniker retourne un pointeur [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) ou [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) asynchrone à partir de l’appel du client à [**IMoniker :: BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage).</span><span class="sxs-lookup"><span data-stu-id="cecb9-108">Such a moniker would return an asynchronous [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) or [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) pointer from the client's call to [**IMoniker::BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage).</span></span>

<span data-ttu-id="cecb9-109">En général, les fichiers composés sont implémentés en plus d’un objet de tableau d’octets, une abstraction d’un fichier qui représente les données d’un objet sous la forme d’un tableau d’octets plat.</span><span class="sxs-lookup"><span data-stu-id="cecb9-109">Compound Files in general are implemented on top of a byte array object, an abstraction of a file that represents an object's data as a flat byte array.</span></span> <span data-ttu-id="cecb9-110">L’objet tableau d’octets expose ses fonctionnalités via l’interface [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) .</span><span class="sxs-lookup"><span data-stu-id="cecb9-110">The byte array object exposes its functionality through the [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) interface.</span></span> <span data-ttu-id="cecb9-111">Si un tableau d’octets prend en charge le stockage asynchrone non bloquant, il retourne E \_ en attente à l’implémentation du fichier composé, qui à son tour propage l’erreur à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="cecb9-111">If a byte array supports nonblocking asynchronous storage, it returns E\_PENDING to the compound-file implementation, which in turn propagates the error back to the caller.</span></span>

<span data-ttu-id="cecb9-112">Pour assurer le suivi des données disponibles pendant un téléchargement, un tableau d’octets qui prend en charge le stockage asynchrone expose l’interface [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) sur un objet wrapper fourni par le système spécifiquement à cet effet.</span><span class="sxs-lookup"><span data-stu-id="cecb9-112">To keep track of the data available during a download, a byte array that supports asynchronous storage exposes the [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) interface on a wrapper object provided by the system specifically for this purpose.</span></span> <span data-ttu-id="cecb9-113">Le code de téléchargement fourni par un moniker asynchrone appelle cette interface pour remplir le tableau d’octets de manière asynchrone, à mesure que les données sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="cecb9-113">The downloading code provided by an asynchronous moniker calls this interface to fill the byte array asynchronously, as data is available.</span></span> <span data-ttu-id="cecb9-114">L’objet wrapper expose également une interface **ILockBytes** , que l’implémentation de fichiers composés asynchrone utilise pour lire et écrire des données depuis et vers le tableau.</span><span class="sxs-lookup"><span data-stu-id="cecb9-114">The wrapper object also exposes an **ILockBytes** interface, which the Asynchronous Compound Files implementation uses to read and write data from and to the array.</span></span>

<span data-ttu-id="cecb9-115">Les objets de flux et de stockage asynchrones fournissent un point de connexion pour l’interface [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) , qui est implémentée par le code de téléchargement du moniker asynchrone.</span><span class="sxs-lookup"><span data-stu-id="cecb9-115">Asynchronous storage and stream objects provide a connection point for the [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) interface, which is implemented by the asynchronous moniker's downloading code.</span></span> <span data-ttu-id="cecb9-116">L’implémentation de fichiers composés asynchrones appelle **IProgressNotify** pour fournir au téléchargeur des informations sur l’état de l’opération de téléchargement.</span><span class="sxs-lookup"><span data-stu-id="cecb9-116">The Asynchronous Compound Files implementation calls **IProgressNotify** to provide the downloader with information about the status of the downloading operation.</span></span>

 

 