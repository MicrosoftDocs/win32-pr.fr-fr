---
title: Objets de stockage et de flux pour un jeu de propriétés
description: Le programmeur spécifie si un jeu de propriétés est stocké dans un stockage ou un flux lorsque le jeu de propriétés est créé.
ms.assetid: d0ca649a-d405-4c34-af02-9c2ca8b2790e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4ebd5d03c3b17e02aa47a7a859576b4cc04607a
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/08/2020
ms.locfileid: "104032013"
---
# <a name="storage-and-stream-objects-for-a-property-set"></a><span data-ttu-id="3e54e-103">Objets de stockage et de flux pour un jeu de propriétés</span><span class="sxs-lookup"><span data-stu-id="3e54e-103">Storage and Stream Objects for a Property Set</span></span>

<span data-ttu-id="3e54e-104">Le programmeur spécifie si un jeu de propriétés est stocké dans un stockage ou un flux lorsque le jeu de propriétés est créé.</span><span class="sxs-lookup"><span data-stu-id="3e54e-104">The programmer specifies whether a property set is stored in a storage or a stream when the property set is created.</span></span> <span data-ttu-id="3e54e-105">La \_ valeur d’énumération PROPSETFLAG insimple, passée dans le paramètre *grfFlags* à la méthode [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) , indique cela.</span><span class="sxs-lookup"><span data-stu-id="3e54e-105">The PROPSETFLAG\_NONSIMPLE enumeration value, passed in the *grfFlags* parameter to the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method, indicates this.</span></span> <span data-ttu-id="3e54e-106">La définition de l’emplacement de stockage du jeu de propriétés fournit des contrôles d’application appropriés pour interagir entièrement via l’interface [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) avec le jeu de propriétés com.</span><span class="sxs-lookup"><span data-stu-id="3e54e-106">Setting where the property set is stored provides proper application controls to fully interoperate through the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface with the COM property set.</span></span>

<span data-ttu-id="3e54e-107">Si l' \_ indicateur PROPSETFLAG non simple est défini, le jeu de propriétés est stocké dans un objet de stockage et des valeurs de propriété non simples peuvent y être écrites.</span><span class="sxs-lookup"><span data-stu-id="3e54e-107">If the PROPSETFLAG\_NONSIMPLE flag is set, the property set is stored in a storage object, and nonsimple property values can be written to it.</span></span> <span data-ttu-id="3e54e-108">Les valeurs qui ne sont pas simples incluent des valeurs avec un **VarType** de \_ stockage VT, un flux VT, un \_ \_ objet stocké VT \_ ou un \_ objet transmis en continu VT \_ .</span><span class="sxs-lookup"><span data-stu-id="3e54e-108">Nonsimple values include values with a **VARTYPE** of VT\_STORAGE, VT\_STREAM, VT\_STORED\_OBJECT, or VT\_STREAMED\_OBJECT.</span></span> <span data-ttu-id="3e54e-109">Pour plus d’informations sur les valeurs **VarType** et leur utilisation, consultez la structure [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="3e54e-109">For more information about **VARTYPE** values and how to use them, see the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="3e54e-110">Si l' \_ indicateur PROPSETFLAG non simple n’est pas défini, seules des valeurs simples peuvent être écrites dans le jeu de propriétés.</span><span class="sxs-lookup"><span data-stu-id="3e54e-110">If the PROPSETFLAG\_NONSIMPLE flag is not set, only simple values can be written to the property set.</span></span>

<span data-ttu-id="3e54e-111">Dans l’objet de stockage d’un jeu de propriétés non simple, un flux est créé nommé contents.</span><span class="sxs-lookup"><span data-stu-id="3e54e-111">In the storage object of a nonsimple property set, a stream is created named Contents.</span></span> <span data-ttu-id="3e54e-112">Il s’agit du flux principal du jeu de propriétés qui contient toutes les valeurs de propriété simples.</span><span class="sxs-lookup"><span data-stu-id="3e54e-112">This is the primary stream of the property set, and holds all simple property values.</span></span> <span data-ttu-id="3e54e-113">Les valeurs de propriété qui ne sont pas simples (flux et stockages) sont stockées sous l’objet de stockage principal de la propriété définie en tant que sous-flux et stockages.</span><span class="sxs-lookup"><span data-stu-id="3e54e-113">Nonsimple property values (streams and storages) are stored under the main storage object of the property set as substreams and storages.</span></span> <span data-ttu-id="3e54e-114">Autrement dit, ces valeurs non simples sont stockées en tant que frères dans le flux de contenu.</span><span class="sxs-lookup"><span data-stu-id="3e54e-114">That is, these nonsimple values are stored as siblings to the Contents stream.</span></span> <span data-ttu-id="3e54e-115">Le nom des flux et des stockages frères est déterminé par l’implémentation et stocké dans le flux de contenu similaire à la façon dont une propriété de chaîne simple est stockée.</span><span class="sxs-lookup"><span data-stu-id="3e54e-115">The name of the sibling streams and storages is determined by the implementation, and stored in the Contents stream similar to the way a simple string property is stored.</span></span>

 

 