---
title: Présentation de StoClien
description: L’exemple StoClien montre comment le client utilise le stockage structuré et comment il dirige un composant serveur pour utiliser ce stockage.
ms.assetid: 1f540e0f-2189-4f45-aad3-9b4b56732907
keywords:
- Présentation de StoClien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee37f6f84cf981bda637abbd96ff8e8f0314d8ee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "106535443"
---
# <a name="stoclien-overview"></a><span data-ttu-id="a858a-104">Présentation de StoClien</span><span class="sxs-lookup"><span data-stu-id="a858a-104">StoClien Overview</span></span>

## <a name="purpose"></a><span data-ttu-id="a858a-105">Objectif</span><span class="sxs-lookup"><span data-stu-id="a858a-105">Purpose</span></span>

<span data-ttu-id="a858a-106">L’objectif principal de l’exemple [StoClien](structured-storage-client-sample--stoclien-.md) est la manière dont le client utilise le stockage structuré et comment il demande à un composant serveur d’utiliser ce stockage.</span><span class="sxs-lookup"><span data-stu-id="a858a-106">The principal focus of the [StoClien](structured-storage-client-sample--stoclien-.md) sample is how the client uses structured storage and how it instructs a server component to use this storage.</span></span> <span data-ttu-id="a858a-107">L’exemple StoClien illustre un modèle de programmation de services de stockage structuré.</span><span class="sxs-lookup"><span data-stu-id="a858a-107">The StoClien sample demonstrates a programming model of structured storage services.</span></span>

## <a name="functionality"></a><span data-ttu-id="a858a-108">Fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="a858a-108">Functionality</span></span>

<span data-ttu-id="a858a-109">La fonctionnalité [StoClien](structured-storage-client-sample--stoclien-.md) est similaire aux exemples « Scribble » dans certaines versions de Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="a858a-109">The [StoClien](structured-storage-client-sample--stoclien-.md) functionality is similar to the "scribble" samples in some versions of Microsoft Visual C++.</span></span> <span data-ttu-id="a858a-110">La différence entre l’exemple StoClien et l’exemple [StoServe](structured-storage-server-sample--stoserve-.md) est une architecture interne basée sur la technologie com.</span><span class="sxs-lookup"><span data-stu-id="a858a-110">The difference between the StoClien sample and the [StoServe](structured-storage-server-sample--stoserve-.md) sample is an internal architecture based on COM technology.</span></span> <span data-ttu-id="a858a-111">Une distinction architecturale claire est conservée entre le client COM et le serveur COM.</span><span class="sxs-lookup"><span data-stu-id="a858a-111">A clear architectural distinction is kept between COM client and COM server.</span></span>

<span data-ttu-id="a858a-112">[StoClien](structured-storage-client-sample--stoclien-.md) charge et enregistre ses dessins dans le stockage structuré des fichiers composés com.</span><span class="sxs-lookup"><span data-stu-id="a858a-112">[StoClien](structured-storage-client-sample--stoclien-.md) loads and saves its drawings in the structured storage of COM compound files.</span></span>

<span data-ttu-id="a858a-113">L’exemple [StoClien](structured-storage-client-sample--stoclien-.md) crée et utilise l’objet com de coalimentation connectable fourni en tant que \_ composant CLSID DllPaper sur le serveur [StoServe](structured-storage-server-sample--stoserve-.md) .</span><span class="sxs-lookup"><span data-stu-id="a858a-113">The [StoClien](structured-storage-client-sample--stoclien-.md) sample creates and uses the connectable COPaper COM object that is provided as the CLSID\_DllPaper component in the [StoServe](structured-storage-server-sample--stoserve-.md) server.</span></span> <span data-ttu-id="a858a-114">Le client StoClien crée un objet coimprimé et le contrôle par le biais de l’interface IPaper exposée par l’objet.</span><span class="sxs-lookup"><span data-stu-id="a858a-114">The StoClien client creates a COPaper object and controls it through the IPaper interface that the object exposes.</span></span> <span data-ttu-id="a858a-115">StoClien obtient des données de dessin de l’utilisateur et les représente sous forme graphique dans une fenêtre qu’il gère.</span><span class="sxs-lookup"><span data-stu-id="a858a-115">StoClien obtains drawing data from the user and graphically represents it in a window that it manages.</span></span> <span data-ttu-id="a858a-116">StoClien utilise l’interface IPaper du copapier pour enregistrer les données de dessin dans un colivre et pour diriger les opérations de stockage de fichiers sur ces données.</span><span class="sxs-lookup"><span data-stu-id="a858a-116">StoClien uses the COPaper IPaper interface to save the drawing data in COPaper and to direct file storage operations on this data.</span></span>

<span data-ttu-id="a858a-117">Un objet COM de type « codocument » encapsule uniquement le stockage serveur des données du papier de dessin : aucun comportement de l’interface graphique utilisateur n’est fourni côté serveur.</span><span class="sxs-lookup"><span data-stu-id="a858a-117">A COPaper COM object encapsulates only the server-based storage of the drawing paper data: No graphical user interface (GUI) behavior is provided on the server side.</span></span> <span data-ttu-id="a858a-118">Tout le comportement de l’interface utilisateur graphique est isolé dans le client.</span><span class="sxs-lookup"><span data-stu-id="a858a-118">All GUI behavior is isolated in the client.</span></span> <span data-ttu-id="a858a-119">Les fonctionnalités de stockage et de gestion des données des objets de codocumentation sont disponibles uniquement via une interface COM personnalisée, IPaper.</span><span class="sxs-lookup"><span data-stu-id="a858a-119">The data management and storage features of COPaper objects are available only through an COM custom interface, IPaper.</span></span>

<span data-ttu-id="a858a-120">[StoClien](structured-storage-client-sample--stoclien-.md) coopère avec le copapier pour charger et enregistrer les données de dessin du plan.</span><span class="sxs-lookup"><span data-stu-id="a858a-120">[StoClien](structured-storage-client-sample--stoclien-.md) cooperates with the COPaper to load and save the COPaper drawing data.</span></span> <span data-ttu-id="a858a-121">StoClien obtient une interface [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) pour l’objet de stockage dans un fichier composé.</span><span class="sxs-lookup"><span data-stu-id="a858a-121">StoClien obtains an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface for the storage object in a compound file.</span></span> <span data-ttu-id="a858a-122">Dans ses opérations de chargement et d’enregistrement, StoClien transmet un pointeur vers l’interface **IStorage** au contours du serveur.</span><span class="sxs-lookup"><span data-stu-id="a858a-122">In its load and save operations, StoClien passes a pointer to the **IStorage** interface to COPaper in the server.</span></span> <span data-ttu-id="a858a-123">Le colivre utilise le **IStorage** fourni pour créer des flux dans le stockage.</span><span class="sxs-lookup"><span data-stu-id="a858a-123">COPaper uses the provided **IStorage** to create streams in the storage.</span></span> <span data-ttu-id="a858a-124">Le colivre peut ensuite utiliser l’interface [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) standard pour lire et écrire les données de dessin qu’il gère.</span><span class="sxs-lookup"><span data-stu-id="a858a-124">COPaper can then use the standard [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interface for reading and writing the drawing data it manages.</span></span>

<span data-ttu-id="a858a-125">Le colivre gère uniquement les données de dessin ; Il n’effectue aucune action de l’interface utilisateur graphique.</span><span class="sxs-lookup"><span data-stu-id="a858a-125">COPaper only manages the drawing data; it performs no GUI actions.</span></span> <span data-ttu-id="a858a-126">[StoClien](structured-storage-client-sample--stoclien-.md) fournit l’interface graphique utilisateur de l’application de dessin.</span><span class="sxs-lookup"><span data-stu-id="a858a-126">[StoClien](structured-storage-client-sample--stoclien-.md) provides the GUI for the drawing application.</span></span> <span data-ttu-id="a858a-127">Il encapsule ce dans un objet C++ central CGuiPaper.</span><span class="sxs-lookup"><span data-stu-id="a858a-127">It encapsulates this in a central CGuiPaper C++ object.</span></span>

<span data-ttu-id="a858a-128">[StoClien](structured-storage-client-sample--stoclien-.md) implémente également l’interface IPaperSink personnalisée dans un objet com COPaperSink et connecte cette interface à un point de connexion approprié dans l’objet de codocumentation de serveur.</span><span class="sxs-lookup"><span data-stu-id="a858a-128">[StoClien](structured-storage-client-sample--stoclien-.md) also implements the custom IPaperSink interface in a COPaperSink COM object and connects this interface to an appropriate connection point in the server COPaper object.</span></span> <span data-ttu-id="a858a-129">Le colivre utilise l’interface IPaperSink connectée pour renvoyer des notifications à StoClien.</span><span class="sxs-lookup"><span data-stu-id="a858a-129">COPaper uses the connected IPaperSink interface to send notifications back to StoClien.</span></span> <span data-ttu-id="a858a-130">L’interface graphique utilisateur normale redessinant les données de dessin du plan est effectuée dans StoClien à l’aide de la technologie d’objets connectable du colivre.</span><span class="sxs-lookup"><span data-stu-id="a858a-130">The normal GUI repainting of the COPaper drawing data is done in StoClien using the COPaper connectable object technology.</span></span>

<span data-ttu-id="a858a-131">[StoClien](structured-storage-client-sample--stoclien-.md) est une application que vous pouvez exécuter directement de manière normale ou à partir de la fenêtre d’invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="a858a-131">[StoClien](structured-storage-client-sample--stoclien-.md) is an application that you can execute directly in the normal manner or from the command prompt window.</span></span> <span data-ttu-id="a858a-132">StoClien accepte un paramètre de nom de fichier facultatif sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="a858a-132">StoClien accepts an optional file name parameter on the command line.</span></span>

<span data-ttu-id="a858a-133">Dans l’exemple suivant, Drawing. PAP est un fichier composé contenant le stockage structuré compatible DllPaper des données de dessin.</span><span class="sxs-lookup"><span data-stu-id="a858a-133">In the following example, Drawing.pap is a compound file containing DllPaper-compatible structured storage of drawing data.</span></span> <span data-ttu-id="a858a-134">Si aucun paramètre de nom de fichier de ligne de commande n’est spécifié, [StoClien](structured-storage-client-sample--stoclien-.md) utilise le nom de fichier par défaut StoClien. PAP et tente de l’ouvrir dans le même répertoire que le Stoclien.exe en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="a858a-134">If no command line file name parameter is specified, [StoClien](structured-storage-client-sample--stoclien-.md) uses the default file name Stoclien.pap and attempts to open it in the same directory as the executing Stoclien.exe.</span></span>

<span data-ttu-id="a858a-135">**StoClien c : \\ dessins \\ dessin. PAP**</span><span class="sxs-lookup"><span data-stu-id="a858a-135">**StoClien c:\\drawings\\drawing.pap**</span></span>

## <a name="support-information"></a><span data-ttu-id="a858a-136">Informations de support</span><span class="sxs-lookup"><span data-stu-id="a858a-136">Support Information</span></span>

<span data-ttu-id="a858a-137">Pour plus d’informations, des descriptions fonctionnelles et un didacticiel de code pour [StoClien](structured-storage-client-sample--stoclien-.md), consultez la section relative à la visite guidée du code dans Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="a858a-137">For more information, functional descriptions and a code tutorial for [StoClien](structured-storage-client-sample--stoclien-.md), see the Code Tour section in Stoclien.htm.</span></span> <span data-ttu-id="a858a-138">Pour plus d’informations sur l’opération utilisateur externe de StoClien, consultez les sections utilisation et opération dans Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="a858a-138">For more information about the external user operation of StoClien, see the Usage and Operation sections in Stoclien.htm.</span></span> <span data-ttu-id="a858a-139">Pour lire Stoclient.htm, exécutez Tutorial.exe dans le répertoire principal du didacticiel, puis cliquez sur la leçon StoClien dans le tableau des leçons.</span><span class="sxs-lookup"><span data-stu-id="a858a-139">To read Stoclient.htm, run Tutorial.exe in the main tutorial directory and click the StoClien lesson in the table of lessons.</span></span> <span data-ttu-id="a858a-140">Vous pouvez également cliquer sur Stoclien.htm après avoir localisé le répertoire principal du didacticiel dans l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="a858a-140">Alternatively, click Stoclien.htm after locating the main tutorial directory in Windows Explorer.</span></span> <span data-ttu-id="a858a-141">Pour plus d’informations sur le fonctionnement de [**StoServe**](structured-storage-server-sample--stoserve-.md) et sur l’exposition de ses services à StoClien, consultez Stoserve.htm dans le répertoire principal du didacticiel.</span><span class="sxs-lookup"><span data-stu-id="a858a-141">For more information about how [**StoServe**](structured-storage-server-sample--stoserve-.md) works and exposes its services to StoClien, see Stoserve.htm in the main tutorial directory.</span></span> <span data-ttu-id="a858a-142">N’oubliez pas que vous devez générer le Stoserve.dll avant de générer StoClien.</span><span class="sxs-lookup"><span data-stu-id="a858a-142">Be aware that you must build the Stoserve.dll before building StoClien.</span></span> <span data-ttu-id="a858a-143">Le makefile pour [**StoServe**](structured-storage-server-sample--stoserve-.md) inscrit ce serveur dans le registre système. vous devez donc générer [**StoServe**](structured-storage-server-sample--stoserve-.md) avant d’exécuter StoClien.</span><span class="sxs-lookup"><span data-stu-id="a858a-143">The makefile for [**StoServe**](structured-storage-server-sample--stoserve-.md) registers that server in the system registry, so you must build [**StoServe**](structured-storage-server-sample--stoserve-.md) before attempting to run StoClien.</span></span>

<span data-ttu-id="a858a-144">Pour plus d’informations sur la configuration d’un système pour générer et tester les exemples de code de cette série de didacticiels COM, consultez [Comment générer des exemples](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="a858a-144">For more information about setting up a system to build and test the code samples in this COM Tutorial series, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="a858a-145">Le Makefile fourni (MAKEFILE) est compatible avec Microsoft NMAKE.</span><span class="sxs-lookup"><span data-stu-id="a858a-145">The supplied makefile (MAKEFILE) is Microsoft NMAKE-compatible.</span></span> <span data-ttu-id="a858a-146">Pour créer une version Debug, émettez la commande NMAKE dans la fenêtre d’invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="a858a-146">To create a debug build, issue the NMAKE command in the command prompt window.</span></span>

<span data-ttu-id="a858a-147">Pour plus de commodité, un fichier projet est fourni pour chaque exemple pour une utilisation dans Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a858a-147">For convenience, a project file is provided for each sample for use in Microsoft Visual Studio.</span></span> <span data-ttu-id="a858a-148">Pour charger le projet de l’exemple [StoClien](structured-storage-client-sample--stoclien-.md) , exécutez Visual Studio à partir de l’invite de commandes dans le répertoire de l’exemple comme suit :</span><span class="sxs-lookup"><span data-stu-id="a858a-148">To load the project for the [StoClien](structured-storage-client-sample--stoclien-.md) sample, run Visual Studio at the command prompt in the sample directory as follows:</span></span>

<span data-ttu-id="a858a-149">MSDEV STOCLIEN. DSP</span><span class="sxs-lookup"><span data-stu-id="a858a-149">MSDEV STOCLIEN.DSP</span></span>

<span data-ttu-id="a858a-150">Vous pouvez également double-cliquer sur le fichier Stoclient. DSP dans l’Explorateur Windows pour charger un exemple de projet dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a858a-150">You can also double-click the Stoclient.dsp file in Windows Explorer to load a sample project into Visual Studio.</span></span> <span data-ttu-id="a858a-151">Dans Visual Studio, vous pouvez parcourir les classes C++ de l’exemple de source et effectuer généralement les autres opérations de modification-compilation-débogage.</span><span class="sxs-lookup"><span data-stu-id="a858a-151">In Visual Studio, you can browse the C++ classes of the sample source and generally perform the other edit-compile-debug operations.</span></span> <span data-ttu-id="a858a-152">N’oubliez pas que, dans le cadre du kit de développement logiciel (SDK) du serveur, la compilation de ces exemples à partir de Visual Studio requiert le paramètre approprié des chemins d’accès aux répertoires dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a858a-152">Be aware that, as part of the Server SDK, the compilation of these samples from within Visual Studio requires the proper setting of directory paths in Visual Studio.</span></span> <span data-ttu-id="a858a-153">Pour plus d’informations, consultez [Comment générer des exemples](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="a858a-153">For more information, see [How to Build Samples](how-to-build-samples.md).</span></span>

## <a name="remarks"></a><span data-ttu-id="a858a-154">Notes</span><span class="sxs-lookup"><span data-stu-id="a858a-154">Remarks</span></span>

<span data-ttu-id="a858a-155">L’exemple de client et d’autres exemples associés doivent être compilés avant que vous puissiez exécuter le client.</span><span class="sxs-lookup"><span data-stu-id="a858a-155">The client sample and other related samples must be compiled before you can run the client.</span></span> <span data-ttu-id="a858a-156">Pour plus d’informations sur la création des exemples, consultez [Comment générer des exemples](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="a858a-156">For more information about building the samples, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="a858a-157">Si vous avez généré les exemples appropriés, Stoclien.exe est l’exécutable client à exécuter pour cet exemple.</span><span class="sxs-lookup"><span data-stu-id="a858a-157">If you have built the appropriate samples, Stoclien.exe is the client executable to run for this sample.</span></span>

<span data-ttu-id="a858a-158">L’application Stoclien.exe fournit l’interface utilisateur de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="a858a-158">The Stoclien.exe application provides the user interface for this tutorial.</span></span> <span data-ttu-id="a858a-159">Elle exerce le Stoserve.dll associé, mais indépendant, pour démontrer l’utilisation par le client et le serveur du stockage structuré COM dans des fichiers composés.</span><span class="sxs-lookup"><span data-stu-id="a858a-159">It exercises the associated, but independent, Stoserve.dll to demonstrate both client and server use of COM structured storage in compound files.</span></span>

 

 




