---
title: IPropertySetStorage-implémentation du système de fichiers NTFS
description: La version NTFS 5,0 fournit une implémentation de IPropertySetStorage pour les fichiers sur un volume NTFS lorsque les fichiers eux-mêmes ne sont pas des fichiers composés.
ms.assetid: cd7290bb-bb4e-4dea-9bf6-2e1fdd0ebae8
keywords:
- IPropertySetStorage Strctd STG, implémentations, système de fichiers NTFS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9b0d647b9cb804376a9efeb687b1524585ee938d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106510072"
---
# <a name="ipropertysetstorage-ntfs-file-system-implementation"></a><span data-ttu-id="3db2f-104">IPropertySetStorage-implémentation du système de fichiers NTFS</span><span class="sxs-lookup"><span data-stu-id="3db2f-104">IPropertySetStorage-NTFS File System Implementation</span></span>

<span data-ttu-id="3db2f-105">La version NTFS 5,0 fournit une implémentation de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) pour les fichiers sur un volume NTFS lorsque les fichiers eux-mêmes ne sont pas des fichiers composés.</span><span class="sxs-lookup"><span data-stu-id="3db2f-105">NTFS version 5.0 provides an implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) for files on an NTFS volume when the files themselves are not compound files.</span></span> <span data-ttu-id="3db2f-106">L’implémentation de NTFS équivaut à l' [implémentation de fichier composé](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="3db2f-106">The NTFS implementation is equivalent to the [compound file implementation](ipropertysetstorage-compound-file-implementation.md).</span></span> <span data-ttu-id="3db2f-107">Pour plus d’informations sur les exceptions, consultez la section Notes.</span><span class="sxs-lookup"><span data-stu-id="3db2f-107">For more information about exceptions, see Remarks.</span></span>

<span data-ttu-id="3db2f-108">**Pour obtenir un pointeur vers l’implémentation NTFS de IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="3db2f-108">**To get a pointer to the NTFS implementation of IPropertySetStorage**</span></span>

1.  <span data-ttu-id="3db2f-109">Appelez [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) et spécifiez le **\_ fichier STGFMT** dans le paramètre *grfFlags* pour créer un nouveau fichier.</span><span class="sxs-lookup"><span data-stu-id="3db2f-109">Call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) and specify **STGFMT\_FILE** in the *grfFlags* parameter to create a new file.</span></span>
2.  <span data-ttu-id="3db2f-110">Appelez [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) et spécifiez le **\_ fichier STGFMT** ou **STGFMT \_ toute** valeur d’énumération dans le paramètre *grfFlags* pour ouvrir un fichier existant.</span><span class="sxs-lookup"><span data-stu-id="3db2f-110">Call [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) and specify either the **STGFMT\_FILE** or **STGFMT\_ANY** enumeration value in the *grfFlags* parameter to open an existing file.</span></span>

<span data-ttu-id="3db2f-111">Toutefois, vous ne pouvez pas obtenir l’implémentation NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) pour un fichier composé.</span><span class="sxs-lookup"><span data-stu-id="3db2f-111">However, you cannot obtain the NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) for a compound file.</span></span> <span data-ttu-id="3db2f-112">Lors de l’ouverture d’un fichier composé avec [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage), la spécification de la valeur d’énumération du **\_ fichier STGFMT** génère une erreur.</span><span class="sxs-lookup"><span data-stu-id="3db2f-112">When opening a compound file with [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage), specifying the **STGFMT\_FILE** enumeration value results in an error.</span></span>

<span data-ttu-id="3db2f-113">En outre, les jeux de propriétés simples ne peuvent pas être traités.</span><span class="sxs-lookup"><span data-stu-id="3db2f-113">Also, simple property sets cannot be transacted.</span></span> <span data-ttu-id="3db2f-114">Autrement dit, vous ne pouvez pas spécifier **STGM \_ traité** dans le paramètre *grfMode* des méthodes [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) et [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) , sauf si vous spécifiez également **PROPSETFLAG \_ unsimple** dans le paramètre *grfFlags* .</span><span class="sxs-lookup"><span data-stu-id="3db2f-114">That is, you cannot specify **STGM\_TRANSACTED** in the *grfmode* parameter of the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) and [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) methods unless you also specify **PROPSETFLAG\_NONSIMPLE** in the *grfFlags* parameter.</span></span> <span data-ttu-id="3db2f-115">L’objet de stockage du jeu de propriétés ne prend pas en charge le traitement des transactions.</span><span class="sxs-lookup"><span data-stu-id="3db2f-115">The property set storage object itself does not support transaction processing.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="3db2f-116">Quand l’utiliser</span><span class="sxs-lookup"><span data-stu-id="3db2f-116">When to Use</span></span>

<span data-ttu-id="3db2f-117">Appelez les méthodes [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) pour créer, ouvrir ou supprimer des jeux de propriétés dans le stockage de jeux de propriétés NTFS actuel.</span><span class="sxs-lookup"><span data-stu-id="3db2f-117">Call the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) methods to create, open, or delete property sets in the current NTFS property set storage.</span></span> <span data-ttu-id="3db2f-118">Il existe également une méthode, [**IPropertySetStorage :: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), qui fournit un pointeur vers un énumérateur qui peut être utilisé pour énumérer les jeux de propriétés dans le stockage.</span><span class="sxs-lookup"><span data-stu-id="3db2f-118">There is also a method, [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), that supplies a pointer to an enumerator that can be used to enumerate the property sets in the storage.</span></span>

## <a name="compatibility"></a><span data-ttu-id="3db2f-119">Compatibilité</span><span class="sxs-lookup"><span data-stu-id="3db2f-119">Compatibility</span></span>

<span data-ttu-id="3db2f-120">Les implémentations NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) et [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) sont disponibles à partir de Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="3db2f-120">The NTFS implementations of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) are available starting with Windows 2000.</span></span> <span data-ttu-id="3db2f-121">Les versions antérieures ne peuvent pas accéder à ces jeux de propriétés.</span><span class="sxs-lookup"><span data-stu-id="3db2f-121">Earlier versions cannot access these property sets.</span></span>

<span data-ttu-id="3db2f-122">L’implémentation NTFS stocke les jeux de propriétés dans les autres flux d’un fichier NTFS.</span><span class="sxs-lookup"><span data-stu-id="3db2f-122">The NTFS implementation stores property sets in alternate streams of an NTFS file.</span></span> <span data-ttu-id="3db2f-123">Les flux de remplacement doivent être copiés lorsque le fichier principal est copié.</span><span class="sxs-lookup"><span data-stu-id="3db2f-123">The alternate streams must be copied when the main file is copied.</span></span>

> [!Caution]  
> <span data-ttu-id="3db2f-124">Tous les systèmes de fichiers ne prennent pas en charge ces flux.</span><span class="sxs-lookup"><span data-stu-id="3db2f-124">Not all file systems support such streams.</span></span> <span data-ttu-id="3db2f-125">Si un fichier NTFS avec des jeux de propriétés est copié sur un volume FAT, seules les données du fichier sont copiées ; le jeu de propriétés est perdu.</span><span class="sxs-lookup"><span data-stu-id="3db2f-125">If an NTFS file with property sets is copied to a FAT volume, only the data in the file is copied; the property set is lost.</span></span> <span data-ttu-id="3db2f-126">Dans ce cas, la fonction [**CopyFile**](/windows/desktop/api/winbase/nf-winbase-copyfile) ne retourne pas d’erreur.</span><span class="sxs-lookup"><span data-stu-id="3db2f-126">The [**CopyFile**](/windows/desktop/api/winbase/nf-winbase-copyfile) function does not return an error in this case.</span></span>

 

> [!Caution]  
> <span data-ttu-id="3db2f-127">Si l’ordinateur qui effectue la copie de fichiers n’est pas un ordinateur exécutant Windows 2000 ou une version ultérieure, les jeux de propriétés peuvent être perdus.</span><span class="sxs-lookup"><span data-stu-id="3db2f-127">If the computer performing the file copy is not a computer running on Windows 2000 or later, the property sets may be lost.</span></span> <span data-ttu-id="3db2f-128">Par exemple, si un ordinateur exécutant le système d’exploitation Windows 95 copie un fichier NTFS, le jeu de propriétés est perdu même si le fichier de destination se trouve également sur un volume NTFS.</span><span class="sxs-lookup"><span data-stu-id="3db2f-128">For example, if a computer running on Windows 95 operating system copies an NTFS file, the property set is lost even if the destination file is also on an NTFS volume.</span></span>

 

## <a name="methods"></a><span data-ttu-id="3db2f-129">Méthodes</span><span class="sxs-lookup"><span data-stu-id="3db2f-129">Methods</span></span>

<span data-ttu-id="3db2f-130">L’implémentation du système de fichiers NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) prend en charge les méthodes suivantes.</span><span class="sxs-lookup"><span data-stu-id="3db2f-130">The NTFS file system implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) supports the following methods.</span></span>

<dl> <dt>

<span data-ttu-id="3db2f-131"><span id="IPropertySetStorage__Create"></span><span id="ipropertysetstorage__create"></span><span id="IPROPERTYSETSTORAGE__CREATE"></span>[**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)</span><span class="sxs-lookup"><span data-stu-id="3db2f-131"><span id="IPropertySetStorage__Create"></span><span id="ipropertysetstorage__create"></span><span id="IPROPERTYSETSTORAGE__CREATE"></span>[**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)</span></span>
</dt> <dd>

<span data-ttu-id="3db2f-132">Crée un nouveau jeu de propriétés dans le stockage de fichiers NTFS actuel et fournit un pointeur d’interface vers l’implémentation de fichier NTFS [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="3db2f-132">Creates a new property set in the current NTFS file storage and, on return, supplies an interface pointer to the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) NTFS file implementation.</span></span> <span data-ttu-id="3db2f-133">Le mode de partage spécifié dans le paramètre *grfMode* doit être **STGM \_ share \_ exclusive**.</span><span class="sxs-lookup"><span data-stu-id="3db2f-133">The sharing mode specified in the *grfmode* parameter must be **STGM\_SHARE\_EXCLUSIVE**.</span></span>

</dd> <dt>

<span data-ttu-id="3db2f-134"><span id="IPropertySetStorage__Open"></span><span id="ipropertysetstorage__open"></span><span id="IPROPERTYSETSTORAGE__OPEN"></span>[**IPropertySetStorage :: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)</span><span class="sxs-lookup"><span data-stu-id="3db2f-134"><span id="IPropertySetStorage__Open"></span><span id="ipropertysetstorage__open"></span><span id="IPROPERTYSETSTORAGE__OPEN"></span>[**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)</span></span>
</dt> <dd>

<span data-ttu-id="3db2f-135">Ouvre un jeu de propriétés existant dans le stockage de propriétés actuel.</span><span class="sxs-lookup"><span data-stu-id="3db2f-135">Opens an existing property set in the current property storage.</span></span> <span data-ttu-id="3db2f-136">Au retour, elle fournit un pointeur d’interface vers l’implémentation de fichier NTFS de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span><span class="sxs-lookup"><span data-stu-id="3db2f-136">On return, it supplies an interface pointer to the NTFS file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span></span> <span data-ttu-id="3db2f-137">Le mode de partage spécifié dans le paramètre *grfMode* doit être **STGM \_ share \_ exclusive**.</span><span class="sxs-lookup"><span data-stu-id="3db2f-137">The sharing mode specified in the *grfmode* parameter must be **STGM\_SHARE\_EXCLUSIVE**.</span></span>

</dd> <dt>

<span data-ttu-id="3db2f-138"><span id="IPropertySetStorage__Delete"></span><span id="ipropertysetstorage__delete"></span><span id="IPROPERTYSETSTORAGE__DELETE"></span>[**IPropertySetStorage ::D supprim**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete)</span><span class="sxs-lookup"><span data-stu-id="3db2f-138"><span id="IPropertySetStorage__Delete"></span><span id="ipropertysetstorage__delete"></span><span id="IPROPERTYSETSTORAGE__DELETE"></span>[**IPropertySetStorage::Delete**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete)</span></span>
</dt> <dd>

<span data-ttu-id="3db2f-139">Supprime un jeu de propriétés dans le stockage de propriétés actuel.</span><span class="sxs-lookup"><span data-stu-id="3db2f-139">Deletes a property set in the current property storage.</span></span>

</dd> <dt>

<span data-ttu-id="3db2f-140"><span id="IPropertySetStorage__Enum"></span><span id="ipropertysetstorage__enum"></span><span id="IPROPERTYSETSTORAGE__ENUM"></span>[**IPropertySetStorage :: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum)</span><span class="sxs-lookup"><span data-stu-id="3db2f-140"><span id="IPropertySetStorage__Enum"></span><span id="ipropertysetstorage__enum"></span><span id="IPROPERTYSETSTORAGE__ENUM"></span>[**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="3db2f-141">Crée un objet utilisé pour énumérer les structures [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) .</span><span class="sxs-lookup"><span data-stu-id="3db2f-141">Creates an object used to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures.</span></span> <span data-ttu-id="3db2f-142">Chaque structure **STATPROPSETSTG** fournit des données relatives à un jeu de propriétés unique.</span><span class="sxs-lookup"><span data-stu-id="3db2f-142">Each **STATPROPSETSTG** structure provides data about a single property set.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="3db2f-143">Notes</span><span class="sxs-lookup"><span data-stu-id="3db2f-143">Remarks</span></span>

<span data-ttu-id="3db2f-144">Les implémentations NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) et [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) stockent des jeux de propriétés dans un fichier sans affecter le contenu de ce fichier.</span><span class="sxs-lookup"><span data-stu-id="3db2f-144">The NTFS implementations of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) store property sets in a file without affecting the contents of that file.</span></span> <span data-ttu-id="3db2f-145">Par exemple, si vous créez un jeu de propriétés dans un fichier HTML nommé Default.htm, ce fichier s’affiche toujours correctement dans un navigateur Web.</span><span class="sxs-lookup"><span data-stu-id="3db2f-145">For example, if you create a property set in an HTML file named Default.htm, that file still displays properly in a Web browser.</span></span> <span data-ttu-id="3db2f-146">Autrement dit, les modifications apportées à un fichier à l’aide de ces deux interfaces ne sont pas détectables lors de l’accès à un fichier avec la fonction [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="3db2f-146">That is, changes to a file using these two interfaces are undetectable when accessing a file with the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

<span data-ttu-id="3db2f-147">L’implémentation NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) fournit une implémentation sécurisée lorsqu’elle est utilisée pour écrire des jeux de propriétés dans un fichier sur un volume NTFS version 5,0.</span><span class="sxs-lookup"><span data-stu-id="3db2f-147">The NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) provides a safe implementation when used to write property sets to a file on an NTFS version 5.0 volume.</span></span> <span data-ttu-id="3db2f-148">Ces jeux de propriétés ne peuvent pas être endommagés par l’implémentation même en cas de défaillance du système.</span><span class="sxs-lookup"><span data-stu-id="3db2f-148">Such property sets cannot be corrupted by the implementation even in the event of a system failure.</span></span> <span data-ttu-id="3db2f-149">Par exemple, si la puissance d’un système échoue pendant un appel à [**IPropertyStorage :: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) alors que le jeu de propriétés est vidé sur le disque, le jeu de propriétés n’est jamais laissé dans un état intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="3db2f-149">For example, if the power to a system fails during a call to [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) while the property set is flushed to the disk, the property set is never left in an intermediate state.</span></span> <span data-ttu-id="3db2f-150">Soit la version précédente du jeu de propriétés est conservée, soit toutes les mises à jour sont enregistrées.</span><span class="sxs-lookup"><span data-stu-id="3db2f-150">Either the previous version of the property set remains or all of the updates are saved.</span></span>

<span data-ttu-id="3db2f-151">L’implémentation NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) diffère de l’implémentation de fichier composé des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="3db2f-151">The NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) differs from the compound file implementation in the following ways:</span></span>

-   <span data-ttu-id="3db2f-152">Une structure [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) obtenue à partir de l’interface [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) contient un membre **CLSID** dont la valeur est toujours égale à zéro (**CLSID \_ null**).</span><span class="sxs-lookup"><span data-stu-id="3db2f-152">A [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure obtained from the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface contains a **clsid** member whose value is always zero (**CLSID\_NULL**).</span></span> <span data-ttu-id="3db2f-153">Avec l’implémentation de fichier composé, le membre **CLSID** correct est retourné pour les jeux de propriétés non simples (voir [objets de stockage et de flux pour un jeu de propriétés](storage-vs--stream-for-a-property-set.md)).</span><span class="sxs-lookup"><span data-stu-id="3db2f-153">With the compound file implementation, the correct **clsid** member is returned for non-simple (see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md)) property sets.</span></span>
-   <span data-ttu-id="3db2f-154">Lors de l’obtention d’une implémentation NTFS du pointeur d’interface [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) à l’aide de la fonction [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) , le paramètre *grfMode* doit suivre les mêmes règles que pour l’implémentation de fichier composé.</span><span class="sxs-lookup"><span data-stu-id="3db2f-154">When obtaining an NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface pointer using the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, the *grfmode* parameter must follow the same rules as for the compound file implementation.</span></span>

    <span data-ttu-id="3db2f-155">En outre, les indicateurs suivants ne peuvent pas être utilisés :</span><span class="sxs-lookup"><span data-stu-id="3db2f-155">In addition, the following flags may not be used:</span></span>

    <span data-ttu-id="3db2f-156">**STGM \_ SIMPLE**, **STGM \_ traité**, **STGM \_ Convert**, **STGM \_ Priority** et **STGM \_ DELETEONRELEASE**.</span><span class="sxs-lookup"><span data-stu-id="3db2f-156">**STGM\_SIMPLE**, **STGM\_TRANSACTED**, **STGM\_CONVERT**, **STGM\_PRIORITY**, and **STGM\_DELETEONRELEASE**.</span></span>

-   <span data-ttu-id="3db2f-157">Lorsqu’une interface [**IPROPERTYSETSTORAGE**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) NTFS est obtenue par les fonctions [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) , les modes de partage s’appliquent principalement à d’autres instances de cette interface, et non à des instances de l’ouverture du fichier lui-même.</span><span class="sxs-lookup"><span data-stu-id="3db2f-157">When an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface is obtained by the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) functions, the sharing modes primarily apply to other instances of that interface, and not to instances of opening the file itself.</span></span> <span data-ttu-id="3db2f-158">Par exemple, si une interface **IPROPERTYSETSTORAGE** NTFS est ouverte en appelant la fonction **StgOpenStorageEx** , avec le paramètre *grfMode* défini sur **STGM \_ ReadWrite \| STGM \_ share \_ exclusive**, il est possible d’ouvrir le fichier avec la fonction [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="3db2f-158">For example, if an NTFS **IPropertySetStorage** interface is opened by calling the **StgOpenStorageEx** function, with the *grfmode* parameter set to **STGM\_READWRITE\|STGM\_SHARE\_EXCLUSIVE**, it is possible to open the file with the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

    <span data-ttu-id="3db2f-159">Ces instances simultanées d’ouverture de cette interface sont soumises aux contraintes suivantes : le paramètre *dwShareMode* dans la fonction [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) doit spécifier l’indicateur de **lecture de \_ partage \_ de fichiers** , et le paramètre *dwAccess* ne doit pas spécifier l’indicateur **Delete** .</span><span class="sxs-lookup"><span data-stu-id="3db2f-159">Such simultaneous instances of opening this interface are subject to the following constraints: the *dwShareMode* parameter in the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function must specify the **FILE\_SHARE\_READ** flag, and the *dwAccess* parameter must not specify the **DELETE** flag.</span></span> <span data-ttu-id="3db2f-160">En outre, les fonctions [**DeleteFile**](/windows/desktop/api/fileapi/nf-fileapi-deletefilea) et [**MoveFile**](/windows/desktop/api/winbase/nf-winbase-movefile) ne doivent pas être appelées sur un fichier pour lequel ces interfaces de jeu de propriétés sont ouvertes, car ces fonctions requièrent l’accès en **suppression** au fichier.</span><span class="sxs-lookup"><span data-stu-id="3db2f-160">Also, the [**DeleteFile**](/windows/desktop/api/fileapi/nf-fileapi-deletefilea) and [**MoveFile**](/windows/desktop/api/winbase/nf-winbase-movefile) functions must not be called on a file for which these property set interfaces are open, as these functions require **DELETE** access to the file.</span></span>

-   <span data-ttu-id="3db2f-161">Si une méthode [**IPROPERTYSETSTORAGE**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) NTFS est ouverte en lecture seule et si le fichier n’a actuellement aucun jeu de propriétés, l’objet retourné ne contient pas réellement l’ouverture du fichier.</span><span class="sxs-lookup"><span data-stu-id="3db2f-161">If an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) method is opened as read-only, and the file currently has no property sets, the object returned will not actually hold open the file.</span></span> <span data-ttu-id="3db2f-162">Par conséquent, d’autres ouvertures de ce fichier échouent, même si le mode de partage de l’opération d’ouverture d’origine le rejette.</span><span class="sxs-lookup"><span data-stu-id="3db2f-162">Consequently, other openings of that file will succeed, even if the sharing mode of the original open operation would otherwise reject it.</span></span>

    <span data-ttu-id="3db2f-163">Tels Si un [**IPROPERTYSETSTORAGE**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) NTFS est ouvert en mode **STGM \_ Read \| STGM \_ share \_ exclusive** et que le fichier n’a pas de jeu de propriétés, il est possible d’ouvrir simultanément le fichier **STGM \_ ReadWrite \| STGM \_ share \_ exclusive**.</span><span class="sxs-lookup"><span data-stu-id="3db2f-163">Example; if an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is opened in the mode **STGM\_READ\|STGM\_SHARE\_EXCLUSIVE**, and the file has no property sets, it will be possible to simultaneously open the file **STGM\_READWRITE\|STGM\_SHARE\_EXCLUSIVE**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3db2f-164">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="3db2f-164">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3db2f-165">IPropertyStorage-implémentation du système de fichiers NTFS</span><span class="sxs-lookup"><span data-stu-id="3db2f-165">IPropertyStorage-NTFS File System Implementation</span></span>](ipropertystorage-ntfs-file-system-implementation.md)
</dt> <dt>

[<span data-ttu-id="3db2f-166">**IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="3db2f-166">**IPropertySetStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)
</dt> <dt>

[<span data-ttu-id="3db2f-167">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="3db2f-167">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="3db2f-168">**IStorage :: EnumElements**</span><span class="sxs-lookup"><span data-stu-id="3db2f-168">**IStorage::EnumElements**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)
</dt> <dt>

[<span data-ttu-id="3db2f-169">**Constantes PROPSETFLAG**</span><span class="sxs-lookup"><span data-stu-id="3db2f-169">**PROPSETFLAG Constants**</span></span>](propsetflag-constants.md)
</dt> <dt>

[<span data-ttu-id="3db2f-170">**STATPROPSETSTG**</span><span class="sxs-lookup"><span data-stu-id="3db2f-170">**STATPROPSETSTG**</span></span>](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)
</dt> </dl>

 

 