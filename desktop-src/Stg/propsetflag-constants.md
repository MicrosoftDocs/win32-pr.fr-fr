---
title: Constantes PROPSETFLAG (Propidl. h)
description: Définir les caractéristiques d’un jeu de propriétés.
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:
- apiref
api_name:
- PROPSETFLAG_DEFAULT
- PROPSETFLAG_NONSIMPLE
- PROPSETFLAG_ANSI
- PROPSETFLAG_UNBUFFERED
- PROPSETFLAG_CASE_SENSITIVE
api_location:
- Propidl.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: e8f31d7b2659eeaa003c1a0d15103e94ad1a5c89
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/12/2020
ms.locfileid: "103942180"
---
# <a name="propsetflag-constants"></a>Constantes PROPSETFLAG

Les constantes PROPSETFLAG définissent les caractéristiques d’un jeu de propriétés. Les valeurs, répertoriées dans le tableau suivant, sont utilisées dans le paramètre *grfFlags* des méthodes [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , la fonction [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) et la fonction [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .



| Constante/valeur                                                                                                                                                                                                                                               | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROPSETFLAG_DEFAULT"></span><span id="propsetflag_default"></span><dl> <dt>**PROPSETFLAG \_ 0 par défaut**</dt> <dt></dt> </dl>                       | Si la valeur n’est pas spécifiée, par défaut, seules des valeurs de propriété simples peuvent être écrites dans le jeu de propriétés. L’utilisation de valeurs de propriété simples empêche les jeux de propriétés d’être traités dans le fichier composé et les implémentations autonomes de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage). Les valeurs de propriété non-e doivent être utilisées à cette fin.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="PROPSETFLAG_NONSIMPLE"></span><span id="propsetflag_nonsimple"></span><dl> <dt>**PROPSETFLAG \_ SIMPLE**</dt> <dt>1</dt> </dl>                 | Si elles sont spécifiées, les valeurs de propriété non simples peuvent être écrites dans le jeu de propriétés et le jeu de propriétés est enregistré dans un objet de stockage. Les valeurs de propriété non simples incluent celles avec un VARTYPE de \_ stockage VT, de flux VT, d’objet de stockage \_ VT \_ ou d’objet de \_ \_ diffusion VT \_ . Si cet indicateur n’est pas spécifié, les types non simples ne peuvent pas être écrits dans le jeu de propriétés. Dans le fichier composé et les implémentations autonomes, les jeux de propriétés peuvent être traités uniquement si **PROPSETFLAG non \_ simple** est spécifié.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="PROPSETFLAG_ANSI"></span><span id="propsetflag_ansi"></span><dl> <dt>**PROPSETFLAG \_ ANSI**</dt> <dt>2</dt> </dl>                                | Si cette valeur est spécifiée, toutes les valeurs de chaîne dans le jeu de propriétés qui ne sont pas explicitement Unicode, autrement dit, celles autres que VT \_ LPWStr, sont stockées avec la page de codes ANSI du système en cours. Pour plus d’informations, consultez [**GetACP**](/windows/desktop/api/winnls/nf-winnls-getacp). L’utilisation de cette valeur n’est pas recommandée. Pour plus d'informations, consultez la section Notes.<br/> Si cette valeur est absente, les valeurs de chaîne dans le nouveau jeu de propriétés sont stockées au format Unicode. Le degré de contrôle fourni par cette valeur est nécessaire pour que les clients qui utilisent les interfaces liées aux propriétés puissent interagir avec les jeux de propriétés standard, tels que les informations de résumé de OLE2, qui peuvent exister dans la page de codes ANSI.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span id="PROPSETFLAG_UNBUFFERED"></span><span id="propsetflag_unbuffered"></span><dl> <dt>**PROPSETFLAG \_ Non mis en mémoire tampon**</dt> <dt>4</dt> </dl>              | Utilisé uniquement avec les fonctions [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) et [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) ; autrement dit, dans les implémentations autonomes des interfaces de jeu de propriétés. Si elles sont spécifiées dans ces fonctions, les modifications apportées au jeu de propriétés ne sont pas mises en mémoire tampon. Au lieu de cela, les modifications sont toujours écrites directement dans le jeu de propriétés. Les appels à une méthode Property Set [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) le modifient. Toutefois, par défaut, les modifications sont mises en mémoire tampon dans un cache de jeu de propriétés interne et sont ensuite écrites dans la propriété définie lors de l’appel de la méthode [**IPropertyStorage :: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) . <br/> La définition de **PROPSETFLAG non \_ mis en mémoire tampon** diminue les performances, car la mémoire tampon interne du jeu de propriétés est vidée automatiquement après chaque modification apportée au jeu de propriétés. Toutefois, l’écriture de modifications directement empêchera les problèmes de coordination. Par exemple, si l’objet de stockage est ouvert en mode traité, et si le jeu de propriétés est mis en mémoire tampon. Ensuite, si vous appelez la méthode [**IStorage :: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) sur l’objet de stockage, les modifications du jeu de propriétés ne sont pas récupérées dans le cadre de la transaction, car elles se trouvent dans une mémoire tampon qui n’a pas encore été vidée. Vous devez appeler [**IPropertyStorage :: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) avant d’appeler **IStorage :: Commit** pour vider la mémoire tampon du jeu de propriétés avant de valider les modifications apportées au stockage. Comme alternative à la création de deux appels, vous pouvez définir **PROPSETFLAG non \_ mis en mémoire tampon** afin que les modifications soient toujours écrites directement dans le jeu de propriétés et ne soient jamais mises en mémoire tampon dans le cache interne de l’ensemble de propriétés. Ensuite, les modifications sont récupérées lorsque le stockage traité est validé.<br/> |
| <span id="PROPSETFLAG_CASE_SENSITIVE"></span><span id="propsetflag_case_sensitive"></span><dl> <dt>**PROPSETFLAG \_ Respect \_**</dt> de la casse <dt>8</dt> </dl> | S’ils sont spécifiés, les noms de propriété respectent la casse. Les noms de propriétés respectant la casse ne sont possibles que dans le format de sérialisation du jeu de propriétés de la version 1. Pour plus d’informations, consultez [sérialisation du jeu de propriétés](version-0-vs--version-1-property-set-serialization.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



## <a name="remarks"></a>Notes

Ces valeurs peuvent être définies et vérifiées à l’aide d’opérations au niveau du bit qui déterminent la façon dont les jeux de propriétés sont créés et ouverts. Les jeux de propriétés sont créés à l’aide de la méthode [**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) ou de la fonction [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) . Ils sont ouverts à l’aide de la méthode [**IPropertySetStorage :: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) ou de la fonction [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .

Il est recommandé de créer les jeux de propriétés en Unicode en ne définissant pas l’indicateur **\_ ANSI PROPSETFLAG** dans le paramètre *grfFlags* . Il est également recommandé d’éviter d’utiliser \_ des valeurs VT LPSTR et d’utiliser à la \_ place des valeurs VT LPWStr. Quand la page de codes du jeu de propriétés est Unicode, les \_ valeurs de chaîne de VT LPSTR sont converties au format Unicode lorsqu’elles sont stockées, puis reconverties en valeurs de chaîne multioctets lors de leur récupération. Lorsque la page de codes du jeu de propriétés n’est pas Unicode, les noms de propriétés, les \_ Chaînes VT BSTR et les valeurs de propriété non simples sont convertis en chaînes multioctets lorsqu’elles sont stockées, puis reconvertis en Unicode lors de leur extraction, le tout à l’aide de la page de codes ANSI du système actuelle.

## <a name="requirements"></a>Configuration requise



| Condition requise | Valeur |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Client minimal pris en charge<br/> | Windows 2000 Professionnel - \[Applications de bureau uniquement\]<br/>                           |
| Serveur minimal pris en charge<br/> | Windows 2000 Server - \[Applications de bureau uniquement\]<br/>                                 |
| En-tête<br/>                   | <dl> <dt>Propidl. h</dt> </dl> |



## <a name="see-also"></a>Voir aussi

<dl> <dt>

[**FmtIdToPropStgName**](/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname)
</dt> <dt>

[**IPropertySetStorage :: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)
</dt> <dt>

[**IPropertySetStorage :: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)
</dt> <dt>

[**PropStgNameToFmtId**](/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid)
</dt> <dt>

[**StgCreatePropSetStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg)
</dt> <dt>

[**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)
</dt> <dt>

[**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)
</dt> </dl>

 

