---
description: La bibliothèque de Registre hors connexion est utilisée pour modifier une ruche de registre en dehors du Registre système actif.
ms.assetid: 61db2804-1b67-473f-8dd7-6be6c6a7184e
title: À propos de la bibliothèque de Registre hors connexion
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7e08b401a4a77f55a54c48ad147bf38c8796472
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104482856"
---
# <a name="about-the-offline-registry-library"></a><span data-ttu-id="21e56-103">À propos de la bibliothèque de Registre hors connexion</span><span class="sxs-lookup"><span data-stu-id="21e56-103">About the Offline Registry Library</span></span>

<span data-ttu-id="21e56-104">La bibliothèque de Registre hors connexion est utilisée pour modifier une ruche de registre en dehors du Registre système actif.</span><span class="sxs-lookup"><span data-stu-id="21e56-104">The offline registry library is used to modify a registry hive outside of the active system registry.</span></span>

<span data-ttu-id="21e56-105">La bibliothèque de Registre hors connexion est conçue pour les scénarios de mise à jour du Registre, tels que la maintenance d’une image de système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="21e56-105">The offline registry library is intended for registry update scenarios such as servicing an operating system image.</span></span> <span data-ttu-id="21e56-106">Les fonctions de Registre hors connexion offrent les fonctionnalités suivantes qui ne sont pas disponibles avec les fonctions de Registre standard :</span><span class="sxs-lookup"><span data-stu-id="21e56-106">The offline registry functions provide the following capabilities that are not available with the standard registry functions:</span></span>

-   <span data-ttu-id="21e56-107">Les fonctions de Registre hors connexion peuvent être utilisées pour modifier une ruche de Registre dans n’importe quel format de Registre pris en charge.</span><span class="sxs-lookup"><span data-stu-id="21e56-107">The offline registry functions can be used to modify a registry hive in any supported registry format.</span></span> <span data-ttu-id="21e56-108">Les fonctions de Registre standard peuvent apporter des modifications uniquement à une ruche de Registre active et les modifications doivent être compatibles avec la version de Windows exécutée sur le système.</span><span class="sxs-lookup"><span data-stu-id="21e56-108">The standard registry functions can make changes only to an active registry hive and the changes must be compatible with the version of Windows running on the system.</span></span>
-   <span data-ttu-id="21e56-109">La bibliothèque de Registre hors connexion requiert uniquement un accès en lecture pour ouvrir un fichier ruche du Registre et un accès en écriture pour enregistrer le fichier.</span><span class="sxs-lookup"><span data-stu-id="21e56-109">The offline registry library requires only read access to open a registry hive file and write access to save the file.</span></span> <span data-ttu-id="21e56-110">Aucune autre vérification d’accès n’est effectuée sur les objets dans Hive, ce qui permet de modifier la ruche avec des privilèges d’utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="21e56-110">No other access checks are performed on objects in the hive, making it possible to modify the hive with standard user privileges.</span></span> <span data-ttu-id="21e56-111">Avec les fonctions de Registre standard, le chargement d’une ruche dans le Registre actif est une opération privilégiée qui nécessite un accès administratif.</span><span class="sxs-lookup"><span data-stu-id="21e56-111">With the standard registry functions, loading a hive into the active registry is a privileged operation that requires administrative access.</span></span>

<span data-ttu-id="21e56-112">Les fonctions de Registre hors connexion ne doivent pas être utilisées comme substituts pour les fonctions de Registre système pour les raisons suivantes :</span><span class="sxs-lookup"><span data-stu-id="21e56-112">The offline registry functions should not be used as a substitute for the system registry functions for the following reasons:</span></span>

-   <span data-ttu-id="21e56-113">Il est impossible de partager les ruches de Registre entre les processus à l’aide des fonctions de Registre hors connexion.</span><span class="sxs-lookup"><span data-stu-id="21e56-113">It is impossible to share registry hives between processes using the offline registry functions.</span></span>
-   <span data-ttu-id="21e56-114">Les fonctions de Registre hors connexion utilisent un verrouillage simple qui peut entraîner une dégradation sérieuse des performances pour les applications multithread.</span><span class="sxs-lookup"><span data-stu-id="21e56-114">The offline registry functions use simple locking that can lead to serious performance degradation for multithreaded applications.</span></span>
-   <span data-ttu-id="21e56-115">Les modifications apportées avec les fonctions de Registre hors connexion ne sont pas enregistrées tant que la fonction [**ORSaveHive**](orsavehive.md) n’est pas appelée.</span><span class="sxs-lookup"><span data-stu-id="21e56-115">Changes made with the offline registry functions are not saved until the [**ORSaveHive**](orsavehive.md) function is called.</span></span>

<span data-ttu-id="21e56-116">Les applications ne doivent pas utiliser les fonctions de Registre hors connexion pour contourner les exigences de sécurité du Registre système.</span><span class="sxs-lookup"><span data-stu-id="21e56-116">Applications should not use the offline registry functions to bypass the security requirements of the system registry.</span></span> <span data-ttu-id="21e56-117">Pour charger une ruche, une application qui s’exécute sans les privilèges spéciaux requis par la fonction [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) peut utiliser la fonction [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) .</span><span class="sxs-lookup"><span data-stu-id="21e56-117">To load a hive, an application running without the special privileges required by the [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) function can use the [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) function.</span></span>

<span data-ttu-id="21e56-118">**Windows Server 2003 et Windows XP :** La fonction [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="21e56-118">**Windows Server 2003 and Windows XP:** The [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) function is not supported.</span></span>

<span data-ttu-id="21e56-119">Une *ruche de Registre hors connexion* est une ruche de Registre qui a été chargée en mémoire à l’aide des fonctions de Registre hors connexion.</span><span class="sxs-lookup"><span data-stu-id="21e56-119">An *offline registry hive* is a registry hive that has been loaded into memory using the offline registry functions.</span></span> <span data-ttu-id="21e56-120">Pour créer une ruche de Registre hors connexion vide, utilisez la fonction [**ORCreateHive**](orcreatehive.md) .</span><span class="sxs-lookup"><span data-stu-id="21e56-120">To create an empty offline registry hive, use the [**ORCreateHive**](orcreatehive.md) function.</span></span> <span data-ttu-id="21e56-121">Pour modifier une ruche de Registre existante, utilisez la fonction [RegSaveKey](/windows/win32/api/winreg/nf-winreg-regsavekeya) ou [RegSaveKeyEx](/windows/win32/api/winreg/nf-winreg-regsavekeyexa) pour enregistrer une ruche du Registre système actif dans un fichier, puis utilisez la fonction [**OROpenHive**](oropenhive.md) pour ouvrir le fichier.</span><span class="sxs-lookup"><span data-stu-id="21e56-121">To modify an existing registry hive, use the [RegSaveKey](/windows/win32/api/winreg/nf-winreg-regsavekeya) or [RegSaveKeyEx](/windows/win32/api/winreg/nf-winreg-regsavekeyexa) function to save a hive from the active system registry to a file, and then use the [**OROpenHive**](oropenhive.md) function to open the file.</span></span>

<span data-ttu-id="21e56-122">Les fonctions [**ORCreateHive**](orcreatehive.md) et [**OROpenHive**](oropenhive.md) retournent un handle vers la clé racine de la ruche de Registre hors connexion.</span><span class="sxs-lookup"><span data-stu-id="21e56-122">The [**ORCreateHive**](orcreatehive.md) and [**OROpenHive**](oropenhive.md) functions return a handle to the root key of the offline registry hive.</span></span> <span data-ttu-id="21e56-123">Ce descripteur peut être utilisé comme un descripteur d’une autre clé de la ruche de Registre hors connexion, avec les exceptions suivantes : les fonctions [**ORCreateKey**](orcreatekey.md) et [**OROpenKey**](oropenkey.md) ne peuvent pas être utilisées pour retourner un handle à la clé racine ; la fonction [**ORCloseKey**](orclosekey.md) ne peut pas être utilisée pour fermer la clé racine ; et la fonction [**ORDeleteKey**](ordeletekey.md) ne peut pas être utilisée pour supprimer la clé racine.</span><span class="sxs-lookup"><span data-stu-id="21e56-123">This handle can be used like a handle to any other key in the offline registry hive with the following exceptions: the [**ORCreateKey**](orcreatekey.md) and [**OROpenKey**](oropenkey.md) functions cannot be used to return a handle to the root key; the [**ORCloseKey**](orclosekey.md) function cannot be used to close the root key; and the [**ORDeleteKey**](ordeletekey.md) function cannot be used to delete the root key.</span></span> <span data-ttu-id="21e56-124">Dans tous ces cas, la fonction échoue avec un **\_ \_ paramètre d’erreur non valide**.</span><span class="sxs-lookup"><span data-stu-id="21e56-124">In all of these cases, the function fails with **ERROR\_INVALID\_PARAMETER**.</span></span>

<span data-ttu-id="21e56-125">Utilisez la fonction [**ORCreateKey**](orcreatekey.md) pour ajouter des clés à une ruche de Registre ouverte en mode hors connexion et la fonction [**ORSetValue**](orsetvalue.md) pour définir les valeurs des clés.</span><span class="sxs-lookup"><span data-stu-id="21e56-125">Use the [**ORCreateKey**](orcreatekey.md) function to add keys to an open offline registry hive and the [**ORSetValue**](orsetvalue.md) function to set the keys' values.</span></span> <span data-ttu-id="21e56-126">La bibliothèque de Registre hors connexion prend en charge d’autres opérations de registre de base, telles que l’énumération, la récupération et la suppression de clés et de valeurs, ainsi que la définition d’attributs clés tels que la sécurité et le comportement de virtualisation.</span><span class="sxs-lookup"><span data-stu-id="21e56-126">The offline registry library supports other basic registry operations such as enumerating, retrieving, and deleting keys and values, and setting key attributes such as security and virtualization behavior.</span></span> <span data-ttu-id="21e56-127">Pour obtenir la liste des fonctions, consultez fonctions de la [bibliothèque de Registre hors connexion](offline-registry-library-functions.md).</span><span class="sxs-lookup"><span data-stu-id="21e56-127">For a list of functions, see [Offline Registry Library Functions](offline-registry-library-functions.md).</span></span>

<span data-ttu-id="21e56-128">Pour enregistrer les modifications apportées à une ruche de Registre hors connexion ouverte, utilisez la fonction [**ORSaveHive**](orsavehive.md) pour enregistrer la ruche dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="21e56-128">To save changes made to an open offline registry hive, use the [**ORSaveHive**](orsavehive.md) function to save the hive to a file.</span></span> <span data-ttu-id="21e56-129">(Les modifications ne sont pas conservées, sauf si **ORSaveHive** est appelé.) Après avoir enregistré la ruche, utilisez la fonction [**ORCloseHive**](orclosehive.md) pour fermer la ruche et libérer les ressources qui lui sont associées.</span><span class="sxs-lookup"><span data-stu-id="21e56-129">(The changes do not persist unless **ORSaveHive** is called.) After saving the hive, use the [**ORCloseHive**](orclosehive.md) function to close the hive and free resources associated with it.</span></span>

<span data-ttu-id="21e56-130">Une ruche de Registre hors connexion est validée uniquement lorsqu’elle est ouverte à l’aide de la fonction [**OROpenHive**](oropenhive.md) .</span><span class="sxs-lookup"><span data-stu-id="21e56-130">An offline registry hive is validated only when it is opened using the [**OROpenHive**](oropenhive.md) function.</span></span> <span data-ttu-id="21e56-131">Si la ruche est endommagée, l’opération échoue simplement ; aucune tentative n’est faite pour réparer la ruche.</span><span class="sxs-lookup"><span data-stu-id="21e56-131">If the hive is corrupt, the operation simply fails; no attempt is made to repair the hive.</span></span> <span data-ttu-id="21e56-132">Les vérifications d’accès sur les objets de la ruche ne sont pas effectuées tant que la ruche n’est pas chargée dans un Registre actif avec la fonction [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) .</span><span class="sxs-lookup"><span data-stu-id="21e56-132">Access checks on objects in the hive are not performed until the hive is loaded into an active registry with the [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) function.</span></span>

<span data-ttu-id="21e56-133">Les fonctions de Registre hors connexion ne prennent pas en charge les [clés prédéfinies](../sysinfo/predefined-keys.md).</span><span class="sxs-lookup"><span data-stu-id="21e56-133">The offline registry functions do not support the [predefined keys](../sysinfo/predefined-keys.md).</span></span>

<span data-ttu-id="21e56-134">Toutes les chaînes de nom de clé et de valeur transmises aux fonctions de Registre hors connexion doivent être au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="21e56-134">All key and value name strings passed to offline registry functions must be Unicode.</span></span>

## <a name="related-topics"></a><span data-ttu-id="21e56-135">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="21e56-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="21e56-136">Fonctions de la bibliothèque de Registre hors connexion \_</span><span class="sxs-lookup"><span data-stu-id="21e56-136">Offline Registry Library\_Functions</span></span>](offline-registry-library-functions.md)
</dt> </dl>

 

 
