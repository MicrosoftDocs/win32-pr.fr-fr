---
title: Structure WM_GET_LICENSE_DATA (Drmexternals. h)
description: La \_ structure de données de licence de l’obtention de la licence WM contient des \_ \_ informations sur l’emplacement d’acquisition d’une licence DRM.
ms.assetid: 7e8053d5-f3f5-4519-97f5-6dbd89982f3a
keywords:
- Structure WM_GET_LICENSE_DATA format Windows Media
topic_type:
- apiref
api_name:
- WM_GET_LICENSE_DATA
api_location:
- Drmexternals.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 4f238bea29ab7271896dc7516b6424e4cc298f5c
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/12/2020
ms.locfileid: "104384644"
---
# <a name="wm_get_license_data-structure"></a><span data-ttu-id="5e8e1-104">WM- \_ recevoir la structure des \_ données de licence \_</span><span class="sxs-lookup"><span data-stu-id="5e8e1-104">WM\_GET\_LICENSE\_DATA structure</span></span>

<span data-ttu-id="5e8e1-105">La structure de données de licence de l’obtention de la **\_ \_ licence \_ WM** contient des informations sur l’emplacement d’acquisition d’une [*licence*](wmformat-glossary.md) [*DRM*](wmformat-glossary.md) .</span><span class="sxs-lookup"><span data-stu-id="5e8e1-105">The **WM\_GET\_LICENSE\_DATA** structure contains information about where to acquire a [*DRM*](wmformat-glossary.md) [*license*](wmformat-glossary.md).</span></span>

## <a name="syntax"></a><span data-ttu-id="5e8e1-106">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="5e8e1-106">Syntax</span></span>


```C++
typedef struct _WMGetLicenseData {
  DWORD   dwSize;
  HRESULT hr;
  WCHAR   *wszURL;
  WCHAR   *wszLocalFilename;
  BYTE    *pbPostData;
  DWORD   dwPostDataSize;
} WM_GET_LICENSE_DATA;
```



## <a name="members"></a><span data-ttu-id="5e8e1-107">Membres</span><span class="sxs-lookup"><span data-stu-id="5e8e1-107">Members</span></span>

<dl> <dt>

<span data-ttu-id="5e8e1-108">**dwSize nul**</span><span class="sxs-lookup"><span data-stu-id="5e8e1-108">**dwSize**</span></span>
</dt> <dd>

<span data-ttu-id="5e8e1-109">**Valeur DWORD** contenant la taille de la structure de données de la **\_ \_ licence \_ WM** , en octets.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-109">**DWORD** containing the size of the **WM\_GET\_LICENSE\_DATA** structure, in bytes.</span></span>

</dd> <dt>

<span data-ttu-id="5e8e1-110">**heure(s)**</span><span class="sxs-lookup"><span data-stu-id="5e8e1-110">**hr**</span></span>
</dt> <dd>

<span data-ttu-id="5e8e1-111">Code de retour **HRESULT** .</span><span class="sxs-lookup"><span data-stu-id="5e8e1-111">**HRESULT** return code.</span></span>

</dd> <dt>

<span data-ttu-id="5e8e1-112">**wszURL**</span><span class="sxs-lookup"><span data-stu-id="5e8e1-112">**wszURL**</span></span>
</dt> <dd>

<span data-ttu-id="5e8e1-113">Chaîne de caractères larges se terminant par un caractère NULL contenant l’URL d’acquisition de licence.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-113">Wide-character null-terminated string containing the license acquisition URL.</span></span> <span data-ttu-id="5e8e1-114">Utilisez cette chaîne et la chaîne **pbPostData** dans l’acquisition de licence non silencieuse.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-114">Use this string and the **pbPostData** string in non-silent license acquisition.</span></span>

</dd> <dt>

<span data-ttu-id="5e8e1-115">**wszLocalFilename**</span><span class="sxs-lookup"><span data-stu-id="5e8e1-115">**wszLocalFilename**</span></span>
</dt> <dd>

<span data-ttu-id="5e8e1-116">Chaîne de caractères larges se terminant par un caractère null qui contient une page HTML locale générée par le composant DRM.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-116">Wide-character null-terminated string containing a local HTML page that is generated by the DRM component.</span></span> <span data-ttu-id="5e8e1-117">Lorsque cette chaîne est chargée dans un navigateur, elle redirige automatiquement la requête HTTP vers l’URL d’acquisition de licence, ainsi que les données de publication nécessaires.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-117">When this string is loaded into a browser, it automatically redirects the HTTP request to the license acquisition URL, along with the necessary post data.</span></span> <span data-ttu-id="5e8e1-118">L’utilisation de cette URL locale est désormais déconseillée.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-118">Use of this local URL is now deprecated.</span></span> <span data-ttu-id="5e8e1-119">L’approche recommandée consiste à utiliser les chaînes **wszURL** et **pbPostData** .</span><span class="sxs-lookup"><span data-stu-id="5e8e1-119">The recommended approach is to use the **wszURL** and **pbPostData** strings.</span></span>

</dd> <dt>

<span data-ttu-id="5e8e1-120">**pbPostData**</span><span class="sxs-lookup"><span data-stu-id="5e8e1-120">**pbPostData**</span></span>
</dt> <dd>

<span data-ttu-id="5e8e1-121">Pointeur vers un tableau d’octets contenant les données à publier dans l’URL d’acquisition de licence.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-121">Pointer to a byte array containing the data to be posted to the license acquisition URL.</span></span> <span data-ttu-id="5e8e1-122">Vous devez ajouter la chaîne suivante au début de la chaîne **pbPostData** : « unsilent = 1&Challenge = ».</span><span class="sxs-lookup"><span data-stu-id="5e8e1-122">You must add the following string to the beginning of the **pbPostData** string: "nonsilent=1&challenge=".</span></span> <span data-ttu-id="5e8e1-123">La chaîne résultante doit ensuite être ajoutée à **wszURL** lorsque vous formez la requête http.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-123">The resulting string should then be appended to **wszURL** when you form the HTTP request.</span></span>

</dd> <dt>

<span data-ttu-id="5e8e1-124">**dwPostDataSize**</span><span class="sxs-lookup"><span data-stu-id="5e8e1-124">**dwPostDataSize**</span></span>
</dt> <dd>

<span data-ttu-id="5e8e1-125">**Valeur DWORD** qui indique la taille de **pbPostData** sans la chaîne « non Silent = 1&Challenge = » référencée dans **pbPostData**.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-125">**DWORD** that indicates the size of **pbPostData** without the "nonsilent=1&challenge=" string referred to in **pbPostData**.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="5e8e1-126">Notes</span><span class="sxs-lookup"><span data-stu-id="5e8e1-126">Remarks</span></span>

<span data-ttu-id="5e8e1-127">Cette structure remplie est retournée dans le paramètre *pValue* de la méthode [**IWMStatusCallback :: OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) si l' **\_ État WMT** est égal à **WMT, \_ aucun \_ droit \_ n'** a été acquis par le biais d’une **\_ \_ licence** WMT.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-127">This filled-in structure is returned in the *pValue* parameter of the [**IWMStatusCallback::OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) method if **WMT\_STATUS** equals **WMT\_NO\_RIGHTS\_EX** or **WMT\_ACQUIRE\_LICENSE**.</span></span> <span data-ttu-id="5e8e1-128">Pour le service WMT \_ \_ , aucun droit \_ ex Events, le membre **HR** est une \_ licence NS e \_ \_ Required, NS \_ e \_ License \_ obsolète ou NS \_ e \_ License \_ incorrect \_ Rights.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-128">For WMT\_NO\_RIGHTS\_EX events, the **hr** member will be NS\_E\_LICENSE\_REQUIRED, NS\_E\_LICENSE\_OUTOFDATE, or NS\_E\_LICENSE\_INCORRECT\_RIGHTS.</span></span> <span data-ttu-id="5e8e1-129">L’une de ces erreurs indique qu’une nouvelle licence doit être acquise en accédant à l’URL dans le membre **wszURL** .</span><span class="sxs-lookup"><span data-stu-id="5e8e1-129">Any of these errors indicates that a new license must be acquired by navigating to the URL in the **wszURL** member.</span></span>

<span data-ttu-id="5e8e1-130">Pour les \_ événements d’acquisition de \_ licence WMT, le membre **RH** passera la macro SUCCEEDED si une licence a été acquise avec succès.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-130">For WMT\_ACQUIRE\_LICENSE events, the **hr** member will pass the SUCCEEDED macro if a license was successfully acquired.</span></span> <span data-ttu-id="5e8e1-131">Si cet événement est reçu après une tentative d’acquisition en mode silencieux et que l' **heure** d’été est égale à \_ \_ \_ la NOTACQUIRED de licence NS E DRM \_ , cela signifie que seule l’acquisition non silencieuse est prise en charge par le serveur de licences pour cette licence.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-131">If this event is received after an attempt at silent acquisition, and **hr** equals NS\_E\_DRM\_LICENSE\_NOTACQUIRED, it indicates that only non-silent acquisition is supported by the license server for this license.</span></span>

<span data-ttu-id="5e8e1-132">L’exemple d’application audioplayer montre comment utiliser correctement les informations retournées dans cette structure.</span><span class="sxs-lookup"><span data-stu-id="5e8e1-132">The Audioplayer sample application demonstrates how to correctly use the information returned in this structure.</span></span>

## <a name="requirements"></a><span data-ttu-id="5e8e1-133">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="5e8e1-133">Requirements</span></span>



| <span data-ttu-id="5e8e1-134">Condition requise</span><span class="sxs-lookup"><span data-stu-id="5e8e1-134">Requirement</span></span> | <span data-ttu-id="5e8e1-135">Valeur</span><span class="sxs-lookup"><span data-stu-id="5e8e1-135">Value</span></span> |
|-------------------------------------|-------------------------------------------------------------------------------------------|
| <span data-ttu-id="5e8e1-136">Client minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="5e8e1-136">Minimum supported client</span></span><br/> | <span data-ttu-id="5e8e1-137">Windows 2000 Professionnel - \[Applications de bureau uniquement\]</span><span class="sxs-lookup"><span data-stu-id="5e8e1-137">Windows 2000 Professional \[desktop apps only\]</span></span><br/>                                |
| <span data-ttu-id="5e8e1-138">Serveur minimal pris en charge</span><span class="sxs-lookup"><span data-stu-id="5e8e1-138">Minimum supported server</span></span><br/> | <span data-ttu-id="5e8e1-139">Windows 2000 Server - \[Applications de bureau uniquement\]</span><span class="sxs-lookup"><span data-stu-id="5e8e1-139">Windows 2000 Server \[desktop apps only\]</span></span><br/>                                      |
| <span data-ttu-id="5e8e1-140">Version</span><span class="sxs-lookup"><span data-stu-id="5e8e1-140">Version</span></span><br/>                  | <span data-ttu-id="5e8e1-141">SDK Windows Media Format 7 ou versions ultérieures du kit de développement logiciel (SDK)</span><span class="sxs-lookup"><span data-stu-id="5e8e1-141">Windows Media Format 7 SDK, or later versions of the SDK</span></span><br/>                       |
| <span data-ttu-id="5e8e1-142">En-tête</span><span class="sxs-lookup"><span data-stu-id="5e8e1-142">Header</span></span><br/>                   | <dl> <span data-ttu-id="5e8e1-143"><dt>Drmexternals. h</dt></span><span class="sxs-lookup"><span data-stu-id="5e8e1-143"><dt>Drmexternals.h</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="5e8e1-144">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5e8e1-144">See also</span></span>

<dl> <dt>

[<span data-ttu-id="5e8e1-145">**IWMDRMReader :: AcquireLicense**</span><span class="sxs-lookup"><span data-stu-id="5e8e1-145">**IWMDRMReader::AcquireLicense**</span></span>](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmreader-acquirelicense)
</dt> <dt>

[<span data-ttu-id="5e8e1-146">**Structures**</span><span class="sxs-lookup"><span data-stu-id="5e8e1-146">**Structures**</span></span>](structures.md)
</dt> </dl>

 

 





