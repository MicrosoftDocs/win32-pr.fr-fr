---
title: Vue d’ensemble des réalisations géométriques
description: Cette rubrique explique comment utiliser la réalisation de la géométrie de Direct2D pour améliorer les performances de rendu de géométrie de votre application dans certains scénarios.
ms.assetid: E8C4C4E5-3102-4F53-847E-A4C2D12A6921
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5b903e047ee58a803a7584aaca407281fc803e30
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106538595"
---
# <a name="geometry-realizations-overview"></a><span data-ttu-id="cd12d-103">Vue d’ensemble des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-103">Geometry Realizations Overview</span></span>

<span data-ttu-id="cd12d-104">Cette rubrique explique comment utiliser la réalisation de la géométrie de [Direct2D](direct2d-portal.md) pour améliorer les performances de rendu de géométrie de votre application dans certains scénarios.</span><span class="sxs-lookup"><span data-stu-id="cd12d-104">This topic describes how to use [Direct2D](direct2d-portal.md) geometry realizations to improve your app’s geometry rendering performance in certain scenarios.</span></span>

<span data-ttu-id="cd12d-105">Il contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="cd12d-105">It contains the following sections:</span></span>

-   [<span data-ttu-id="cd12d-106">Qu’est-ce que la réalisation de géométrie ?</span><span class="sxs-lookup"><span data-stu-id="cd12d-106">What are geometry realizations?</span></span>](#what-are-geometry-realizations)
-   [<span data-ttu-id="cd12d-107">Pourquoi utiliser des réalisations géométriques ?</span><span class="sxs-lookup"><span data-stu-id="cd12d-107">Why use geometry realizations?</span></span>](#why-use-geometry-realizations)
-   [<span data-ttu-id="cd12d-108">Quand utiliser des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-108">When to use geometry realizations</span></span>](#when-to-use-geometry-realizations)
-   [<span data-ttu-id="cd12d-109">Création de réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-109">Creating geometry realizations</span></span>](#creating-geometry-realizations)
-   [<span data-ttu-id="cd12d-110">Dessin des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-110">Drawing geometry realizations</span></span>](#drawing-geometry-realizations)
-   [<span data-ttu-id="cd12d-111">Mise à l’échelle des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-111">Scaling geometry realizations</span></span>](#scaling-geometry-realizations)
    -   [<span data-ttu-id="cd12d-112">Utilisation des réalisations géométriques dans des applications qui ne sont pas mises à l’échelle</span><span class="sxs-lookup"><span data-stu-id="cd12d-112">Using geometry realizations in apps that do not scale</span></span>](#using-geometry-realizations-in-apps-that-do-not-scale)
    -   [<span data-ttu-id="cd12d-113">Utilisation des réalisations géométriques dans les applications qui sont mises à l’échelle d’une petite quantité</span><span class="sxs-lookup"><span data-stu-id="cd12d-113">Using geometry realizations in apps that scale by a small amount</span></span>](#using-geometry-realizations-in-apps-that-scale-by-a-small-amount)
    -   [<span data-ttu-id="cd12d-114">Utilisation des réalisations géométriques dans les applications qui sont mises à l’échelle d’une grande quantité</span><span class="sxs-lookup"><span data-stu-id="cd12d-114">Using geometry realizations in apps that scale by a large amount</span></span>](#using-geometry-realizations-in-apps-that-scale-by-a-large-amount)
-   [<span data-ttu-id="cd12d-115">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="cd12d-115">Related topics</span></span>](#related-topics)

## <a name="what-are-geometry-realizations"></a><span data-ttu-id="cd12d-116">Qu’est-ce que la réalisation de géométrie ?</span><span class="sxs-lookup"><span data-stu-id="cd12d-116">What are geometry realizations?</span></span>

<span data-ttu-id="cd12d-117">Les réalisations géométriques, introduites dans Windows 8.1, sont un nouveau type de primitive de dessin qui permet aux applications [Direct2D](direct2d-portal.md) d’améliorer les performances de rendu de géométrie dans certains cas.</span><span class="sxs-lookup"><span data-stu-id="cd12d-117">Geometry realizations, introduced in Windows 8.1, are a new type of drawing primitive that make it easy for [Direct2D](direct2d-portal.md) apps to improve geometry rendering performance in certain cases.</span></span> <span data-ttu-id="cd12d-118">Les réalisations géométriques sont représentées par l’interface [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) .</span><span class="sxs-lookup"><span data-stu-id="cd12d-118">Geometry realizations are represented by the [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) interface.</span></span>

## <a name="why-use-geometry-realizations"></a><span data-ttu-id="cd12d-119">Pourquoi utiliser des réalisations géométriques ?</span><span class="sxs-lookup"><span data-stu-id="cd12d-119">Why use geometry realizations?</span></span>

<span data-ttu-id="cd12d-120">Lorsque [Direct2D](direct2d-portal.md) rend un objet [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) , il doit convertir cette géométrie en une forme que le matériel graphique comprend à travers un processus appelé pavage.</span><span class="sxs-lookup"><span data-stu-id="cd12d-120">When [Direct2D](direct2d-portal.md) renders an [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) object, it must convert that geometry to a form the graphics hardware understands through a process called tessellation.</span></span> <span data-ttu-id="cd12d-121">En règle générale, Direct2D doit paver Geometry chaque frame qu’il dessine, même si la géométrie ne change pas.</span><span class="sxs-lookup"><span data-stu-id="cd12d-121">Typically, Direct2D must tessellate geometry every frame it is drawn, even if the geometry does not change.</span></span> <span data-ttu-id="cd12d-122">Si votre application restitue la même géométrie à chaque trame, le repavage répété représente un effort de calcul gaspillé.</span><span class="sxs-lookup"><span data-stu-id="cd12d-122">If your app renders the same geometry every frame, then the repeated re-tessellation represents wasted computational effort.</span></span> <span data-ttu-id="cd12d-123">Il est plus efficace en termes de calcul pour mettre en cache le pavage, ou même la pixellisation complète, de la géométrie, et de dessiner cette représentation en cache de chaque image au lieu de rele pavage à plusieurs reprises.</span><span class="sxs-lookup"><span data-stu-id="cd12d-123">It is more computationally efficient to cache the tessellation, or even the full rasterization, of the geometry, and to draw that cached representation each frame instead of repeatedly re-tessellating.</span></span>

<span data-ttu-id="cd12d-124">Un moyen courant pour les développeurs de résoudre ce problème consiste à mettre en cache la pixellisation complète de la géométrie.</span><span class="sxs-lookup"><span data-stu-id="cd12d-124">A common way that developers solve this problem is to cache the full rasterization of the geometry.</span></span> <span data-ttu-id="cd12d-125">En particulier, il est courant de créer une nouvelle bitmap, de pixelliser la géométrie sur cette bitmap, puis de la dessiner sur la scène en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="cd12d-125">In particular, it is common to create a new bitmap, rasterize the geometry to that bitmap, and then draw that bitmap to the scene as needed.</span></span> <span data-ttu-id="cd12d-126">(Cette approche est décrite dans la section de [rendu Geometry](improving-direct2d-performance.md) qui améliore les performances des applications Direct2D.) Bien que cette approche soit très efficace en termes de calcul, elle présente certains inconvénients :</span><span class="sxs-lookup"><span data-stu-id="cd12d-126">(This approach is described in the [Geometry rendering](improving-direct2d-performance.md) section of Improving the performance of Direct2D apps.) While this approach is very computationally efficient, it has some drawbacks:</span></span>

-   <span data-ttu-id="cd12d-127">La bitmap mise en cache est sensible aux modifications apportées à la transformation appliquée à la scène.</span><span class="sxs-lookup"><span data-stu-id="cd12d-127">The cached bitmap is sensitive to changes in the transform applied to the scene.</span></span> <span data-ttu-id="cd12d-128">Par exemple, la mise à l’échelle de la pixellisation peut entraîner des artefacts de mise à l’échelle perceptibles.</span><span class="sxs-lookup"><span data-stu-id="cd12d-128">For example, scaling the rasterization can result in a noticeable scaling artifacts.</span></span> <span data-ttu-id="cd12d-129">L’atténuation de ces artefacts avec des algorithmes de mise à l’échelle de haute qualité peut être coûteuse en ressources informatiques.</span><span class="sxs-lookup"><span data-stu-id="cd12d-129">Mitigating these artifacts with high-quality scaling algorithms can be computationally expensive.</span></span>
-   <span data-ttu-id="cd12d-130">La bitmap mise en cache consomme une quantité importante de mémoire, surtout si elle est pixellisée à une résolution élevée.</span><span class="sxs-lookup"><span data-stu-id="cd12d-130">The cached bitmap consumes a significant amount of memory, especially if it is rasterized at a high resolution.</span></span>

<span data-ttu-id="cd12d-131">Les réalisations de géométrie offrent un autre moyen de mettre en cache la géométrie qui évite les inconvénients ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="cd12d-131">Geometry realizations provide an alternative way to cache geometry that avoids the above drawbacks.</span></span> <span data-ttu-id="cd12d-132">Les réalisations géométriques ne sont pas représentées par des pixels (comme c’est le cas avec une pixellisation complète), mais plutôt par des points sur un plan mathématique.</span><span class="sxs-lookup"><span data-stu-id="cd12d-132">Geometry realizations are represented not by pixels (as is the case with a full rasterization) but instead by points on a mathematical plane.</span></span> <span data-ttu-id="cd12d-133">Pour cette raison, elles sont moins sensibles que les pixellisations complètes pour la mise à l’échelle et d’autres manipulations, et elles consomment beaucoup moins de mémoire.</span><span class="sxs-lookup"><span data-stu-id="cd12d-133">For this reason they are less sensitive than full rasterizations to scaling and other manipulation, and they consume significantly less memory.</span></span>

## <a name="when-to-use-geometry-realizations"></a><span data-ttu-id="cd12d-134">Quand utiliser des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-134">When to use geometry realizations</span></span>

<span data-ttu-id="cd12d-135">Envisagez d’utiliser des réalisations géométriques lorsque votre application restitue des géométries complexes dont les formes changent rarement, mais qui peuvent être sujettes à des transformations modifiées.</span><span class="sxs-lookup"><span data-stu-id="cd12d-135">Consider using geometry realizations when your app renders complex geometries whose shapes change infrequently but which may be subject to changing transforms.</span></span>

<span data-ttu-id="cd12d-136">Par exemple, Imaginez une application de mappage qui montre un mappage statique, mais qui permet à l’utilisateur d’effectuer un zoom avant ou arrière. Cette application peut tirer parti de l’utilisation des réalisations géométriques.</span><span class="sxs-lookup"><span data-stu-id="cd12d-136">For example, consider a mapping application that shows a static map but which allows the user to zoom in and out. This app can benefit from using geometry realizations.</span></span> <span data-ttu-id="cd12d-137">Étant donné que les géométries rendues restent statiques, il est utile de les mettre en cache pour enregistrer le travail de pavage.</span><span class="sxs-lookup"><span data-stu-id="cd12d-137">Since the geometries being rendered remain static, it is useful to cache them in order to save tessellation work.</span></span> <span data-ttu-id="cd12d-138">Toutefois, étant donné que les mappages sont mis à l’échelle lorsque l’utilisateur effectue un zoom, la mise en cache d’une pixellisation complète n’est pas idéale, en raison des artefacts de mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="cd12d-138">But because the maps are scaled when the user zooms, caching a full rasterization is not ideal, due to scaling artifacts.</span></span> <span data-ttu-id="cd12d-139">La mise en cache des réalisations géométriques permet à l’application d’éviter la refacettisation du travail tout en conservant une haute qualité visuelle pendant la mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="cd12d-139">Caching geometry realizations would allow the app to avoid re-tessellation work while maintaining high visual quality during scaling.</span></span>

<span data-ttu-id="cd12d-140">En revanche, Imaginez une application Kaléidoscope avec une géométrie animée qui change continuellement.</span><span class="sxs-lookup"><span data-stu-id="cd12d-140">On the other hand, consider a kaleidoscope app with animated geometry that continually changes.</span></span> <span data-ttu-id="cd12d-141">Cette application n’a probablement pas intérêt à utiliser des réalisations géométriques.</span><span class="sxs-lookup"><span data-stu-id="cd12d-141">This app would probably not benefit from using geometry realizations.</span></span> <span data-ttu-id="cd12d-142">Étant donné que les formes changent d’une image à l’autres, il n’est pas utile de mettre en cache leur pavages.</span><span class="sxs-lookup"><span data-stu-id="cd12d-142">Since the shapes themselves change from frame to frame, it is not useful to cache their tessellations.</span></span> <span data-ttu-id="cd12d-143">La meilleure approche pour cette application est de dessiner des objets [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) directement.</span><span class="sxs-lookup"><span data-stu-id="cd12d-143">The best approach for this app is to draw [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) objects directly.</span></span>

## <a name="creating-geometry-realizations"></a><span data-ttu-id="cd12d-144">Création de réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-144">Creating geometry realizations</span></span>

<span data-ttu-id="cd12d-145">Un objet [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) doit être créé à partir d’un objet [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) existant.</span><span class="sxs-lookup"><span data-stu-id="cd12d-145">An [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) object must be created from an existing [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) object.</span></span> <span data-ttu-id="cd12d-146">Pour créer une réalisation géométrique, appelez la méthode [**CreateFilledGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createfilledgeometryrealization) ou la méthode [**CreateStrokedGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createstrokedgeometryrealization) et transmettez le **ID2D1Geometry** à réaliser.</span><span class="sxs-lookup"><span data-stu-id="cd12d-146">To create a geometry realization, call the [**CreateFilledGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createfilledgeometryrealization) method or the [**CreateStrokedGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createstrokedgeometryrealization) method and pass in the **ID2D1Geometry** to be realized.</span></span>

-   <span data-ttu-id="cd12d-147">[**CreateFilledGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createfilledgeometryrealization) crée une réalisation de l’intérieur de la forme : la région qui serait dessinée en appelant [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry).</span><span class="sxs-lookup"><span data-stu-id="cd12d-147">[**CreateFilledGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createfilledgeometryrealization) creates a realization of the interior of the shape: the region that would be drawn by calling [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry).</span></span>
-   <span data-ttu-id="cd12d-148">[**CreateStrokedGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createstrokedgeometryrealization) crée une réalisation du trait de la forme : la région qui serait dessinée en appelant [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry).</span><span class="sxs-lookup"><span data-stu-id="cd12d-148">[**CreateStrokedGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createstrokedgeometryrealization) creates a realization of the stroke of the shape: the region that would be drawn by calling [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry).</span></span>

<span data-ttu-id="cd12d-149">Les deux types de réalisation géométrique sont représentés par l’interface [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) .</span><span class="sxs-lookup"><span data-stu-id="cd12d-149">Both kinds of geometry realization are represented by the [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) interface.</span></span>

<span data-ttu-id="cd12d-150">Lors de la création d’une réalisation géométrique, [Direct2D](direct2d-portal.md) doit aplatir les courbes de la géométrie fournie en approximations polygonales.</span><span class="sxs-lookup"><span data-stu-id="cd12d-150">When creating a geometry realization, [Direct2D](direct2d-portal.md) must flatten any curves in the provided geometry to polygonal approximations.</span></span> <span data-ttu-id="cd12d-151">Vous devez fournir un paramètre de tolérance de aplatissement à la méthode de création, qui spécifie la distance maximale, en pixels indépendants du périphérique (DIP), entre la courbe vraie de la géométrie et son approximation polygonale.</span><span class="sxs-lookup"><span data-stu-id="cd12d-151">You must provide a flattening tolerance parameter to the creation method—this specifies the maximum distance, in device-independent pixels (DIPs), between the geometry’s true curve and its polygonal approximation.</span></span> <span data-ttu-id="cd12d-152">Plus la tolérance d’aplatissement que vous fournissez est faible, plus la fidélité de l’objet de réalisation géométrique résultant est élevée.</span><span class="sxs-lookup"><span data-stu-id="cd12d-152">The lower the flattening tolerance you provide, the higher the fidelity of the resulting geometry realization object.</span></span> <span data-ttu-id="cd12d-153">De même, si vous fournissez une tolérance plus élevée, la réalisation de la géométrie est plus faible.</span><span class="sxs-lookup"><span data-stu-id="cd12d-153">Similarly, providing a higher flattening tolerance yields a lower-fidelity geometry realization.</span></span> <span data-ttu-id="cd12d-154">Notez que les réalisations de géométrie à fidélité élevée sont plus coûteuses que les plus faibles, mais elles peuvent être mises à l’échelle avant d’introduire des artefacts visibles.</span><span class="sxs-lookup"><span data-stu-id="cd12d-154">Note that higher-fidelity geometry realizations are more expensive to draw than lower-fidelity ones, but they can be scaled further before introducing visible artifacts.</span></span> <span data-ttu-id="cd12d-155">Pour obtenir des conseils sur l’utilisation des tolérances de mise à plat, consultez [mise à l’échelle des réalisations géométriques](#scaling-geometry-realizations) ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="cd12d-155">For guidance on using flattening tolerances, see [Scaling geometry realizations](#scaling-geometry-realizations) below.</span></span>

> [!Note]  
> <span data-ttu-id="cd12d-156">Les objets de réalisation Geometry sont associés à un appareil graphique particulier : il s’agit de ressources dépendantes de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="cd12d-156">Geometry realization objects are associated with a particular graphics device: they are device-dependent resources.</span></span>

 

## <a name="drawing-geometry-realizations"></a><span data-ttu-id="cd12d-157">Dessin des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-157">Drawing geometry realizations</span></span>

<span data-ttu-id="cd12d-158">Le dessin des réalisations géométriques est similaire au dessin d’autres primitives [Direct2D](direct2d-portal.md) , comme les bitmaps.</span><span class="sxs-lookup"><span data-stu-id="cd12d-158">Drawing geometry realizations is similar to drawing other [Direct2D](direct2d-portal.md) primitives, like bitmaps.</span></span> <span data-ttu-id="cd12d-159">Pour ce faire, appelez la méthode [**DrawGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-drawgeometryrealization) et transmettez-lui l’objet de réalisation géométrique à dessiner et le pinceau à utiliser.</span><span class="sxs-lookup"><span data-stu-id="cd12d-159">To do so, call the [**DrawGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-drawgeometryrealization) method and pass it the geometry realization object to be drawn and the brush to use.</span></span> <span data-ttu-id="cd12d-160">Comme pour les autres méthodes de dessin Direct2D, vous devez appeler **DrawGeometryRealization** entre les appels à [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) et [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span><span class="sxs-lookup"><span data-stu-id="cd12d-160">As with other Direct2D drawing methods, you must call **DrawGeometryRealization** between calls to [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) and [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span></span>

## <a name="scaling-geometry-realizations"></a><span data-ttu-id="cd12d-161">Mise à l’échelle des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="cd12d-161">Scaling geometry realizations</span></span>

<span data-ttu-id="cd12d-162">Les réalisations géométriques, comme d’autres primitives [Direct2D](direct2d-portal.md) , respectent le jeu de transformations sur le contexte de périphérique.</span><span class="sxs-lookup"><span data-stu-id="cd12d-162">Geometry realizations, like other [Direct2D](direct2d-portal.md) primitives, respect the transform set on the device context.</span></span> <span data-ttu-id="cd12d-163">Bien que les transformations de translation et de rotation n’aient aucun effet sur la qualité visuelle des réalisations géométriques, les transformations de mise à l’échelle peuvent produire des artefacts visuels.</span><span class="sxs-lookup"><span data-stu-id="cd12d-163">Although translation and rotation transforms have no effect on the visual quality of geometry realizations, scale transforms can produce visual artifacts.</span></span>

<span data-ttu-id="cd12d-164">En particulier, l’application d’une mise à l’échelle suffisamment importante à toute réalisation géométrique peut révéler la approximation polygonale des courbes vraies.</span><span class="sxs-lookup"><span data-stu-id="cd12d-164">In particular, applying a large enough scale to any geometry realization can reveal the polygonal approximation of the true curves.</span></span> <span data-ttu-id="cd12d-165">L’image ci-dessous montre une paire de réalisations de géométries elliptiques (remplissage et trait) qui ont été mises à l’échelle trop loin.</span><span class="sxs-lookup"><span data-stu-id="cd12d-165">The image here shows a pair of elliptical geometry realizations (fill and stroke) that have been scaled up too far.</span></span> <span data-ttu-id="cd12d-166">Les artefacts de mise à plat des courbes sont visibles.</span><span class="sxs-lookup"><span data-stu-id="cd12d-166">Curve-flattening artifacts are visible.</span></span>

![paire de réalisations de géométries elliptiques (remplissage et trait) qui ont été mises à l’échelle trop loin.](images/zoomed-in.png)

<span data-ttu-id="cd12d-169">Les applications qui sont sensibles à la qualité visuelle doivent prendre des mesures pour s’assurer que cela ne se produit pas.</span><span class="sxs-lookup"><span data-stu-id="cd12d-169">Apps that are sensitive to visual quality should take measures to ensure this does not happen.</span></span> <span data-ttu-id="cd12d-170">La façon dont vous gérez la mise à l’échelle dépend des besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="cd12d-170">How you handle scaling depends on the needs of your app.</span></span> <span data-ttu-id="cd12d-171">Voici plusieurs approches recommandées pour plusieurs types d’application différents.</span><span class="sxs-lookup"><span data-stu-id="cd12d-171">Following are several recommended approaches for several different types of app.</span></span>

### <a name="using-geometry-realizations-in-apps-that-do-not-scale"></a><span data-ttu-id="cd12d-172">Utilisation des réalisations géométriques dans des applications qui ne sont pas mises à l’échelle</span><span class="sxs-lookup"><span data-stu-id="cd12d-172">Using geometry realizations in apps that do not scale</span></span>

<span data-ttu-id="cd12d-173">Si votre application n’effectue pas de mise à l’échelle sur les réalisations géométriques, il est possible de créer des réalisations une seule fois à l’aide d’une seule tolérance d’aplatissement.</span><span class="sxs-lookup"><span data-stu-id="cd12d-173">If your app does not perform any scaling on the geometry realizations, then it is safe to create the realizations only once, using a single flattening tolerance.</span></span> <span data-ttu-id="cd12d-174">(Les transformations sans mise à l’échelle n’affectent pas la qualité visuelle des réalisations de géométries rendues.) Utilisez la fonction [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) pour calculer la tolérance d’aplatissement appropriée pour le PPP :</span><span class="sxs-lookup"><span data-stu-id="cd12d-174">(Non-scaling transforms do not affect the visual quality of rendered geometry realizations.) Use the [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) function to calculate the appropriate flattening tolerance for the DPI:</span></span>


```C++
    float dpiX, dpiY;
    deviceContext->GetDpi(&dpiX, &dpiY);

    float flatteningTolerance = D2D1::ComputeFlatteningTolerance(
        D2D1::Matrix3x2F::Identity(),   // apply no additional scaling transform
        dpiX,                           // horizontal DPI
        dpiY                            // vertical DPI
        );
```



### <a name="using-geometry-realizations-in-apps-that-scale-by-a-small-amount"></a><span data-ttu-id="cd12d-175">Utilisation des réalisations géométriques dans les applications qui sont mises à l’échelle d’une petite quantité</span><span class="sxs-lookup"><span data-stu-id="cd12d-175">Using geometry realizations in apps that scale by a small amount</span></span>

<span data-ttu-id="cd12d-176">Si votre application peut mettre à l’échelle une géométrie qui ne se trouve que sur une petite quantité (par exemple, jusqu’à 2x ou 3 fois), il peut être approprié de créer la réalisation de la géométrie une seule fois, à une tolérance d’aplatissement proportionnellement inférieure à la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="cd12d-176">If your app can scale a geometry realization up by only a small amount (for example, up to 2x or 3x), then it may be appropriate simply to create the geometry realization once, at a proportionally lower flattening tolerance than the default.</span></span> <span data-ttu-id="cd12d-177">Cela crée une réalisation plus fidèle qui peut être mise à l’échelle de façon significative avant de générer des artefacts de mise à l’échelle ; le compromis est que la réalisation d’une plus haute fidélité nécessite davantage de travail.</span><span class="sxs-lookup"><span data-stu-id="cd12d-177">This creates a higher-fidelity realization that can be scaled up significantly before incurring scaling artifacts; the trade-off is that drawing the higher-fidelity realization requires more work.</span></span>

<span data-ttu-id="cd12d-178">Par exemple, supposons que vous savez que votre application ne mettra jamais à l’échelle une réalisation géométrique de plus de 2x.</span><span class="sxs-lookup"><span data-stu-id="cd12d-178">For example, suppose you know that your app will never scale a geometry realization by more than 2x.</span></span> <span data-ttu-id="cd12d-179">Votre application peut créer la réalisation géométrique à l’aide d’une tolérance de aplatissement qui est la moitié de la valeur par défaut et faire simplement évoluer la réalisation en fonction des besoins, jusqu’à 2x.</span><span class="sxs-lookup"><span data-stu-id="cd12d-179">Your app can create the geometry realization using a flattening tolerance that’s half the default value and simply scale the realization as needed, up to 2x.</span></span> <span data-ttu-id="cd12d-180">Utilisez la fonction [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) pour calculer la tolérance d’aplatissement appropriée en passant 2,0 comme paramètre *maxZoomFactor* :</span><span class="sxs-lookup"><span data-stu-id="cd12d-180">Use the [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) function to calculate the appropriate flattening tolerance by passing 2.0 as the *maxZoomFactor* parameter:</span></span>


```C++
    float dpiX, dpiY;
    deviceContext->GetDpi(&dpiX, &dpiY);
    
    float flatteningTolerance = D2D1::ComputeFlatteningTolerance(
        D2D1::Matrix3x2F::Identity(),   // apply no additional scaling transform
        dpiX,                           // horizontal DPI
        dpiY,                           // vertical DPI
        2.0f                            // realization can be scaled by an additional 2x
        );
```



### <a name="using-geometry-realizations-in-apps-that-scale-by-a-large-amount"></a><span data-ttu-id="cd12d-181">Utilisation des réalisations géométriques dans les applications qui sont mises à l’échelle d’une grande quantité</span><span class="sxs-lookup"><span data-stu-id="cd12d-181">Using geometry realizations in apps that scale by a large amount</span></span>

<span data-ttu-id="cd12d-182">Si votre application peut mettre à l’échelle une réalisation géométrique vers le haut ou vers le haut (par exemple, d’une taille de 10 ou plus), la gestion de la mise à l’échelle appropriée est plus compliquée.</span><span class="sxs-lookup"><span data-stu-id="cd12d-182">If your app can scale a geometry realization up or down by large amounts (for example, by 10x or more), then handling scaling appropriately is more complicated.</span></span>

<span data-ttu-id="cd12d-183">Pour la plupart de ces applications, l’approche recommandée consiste à recréer la réalisation de la géométrie à des tolérances de aplatissement progressivement plus basses à mesure que la scène est montée en puissance, afin de préserver la fidélité visuelle et d’éviter la mise à l’échelle des artefacts.</span><span class="sxs-lookup"><span data-stu-id="cd12d-183">For most of these apps, the recommended approach is to recreate the geometry realization at progressively lower flattening tolerances as the scene is scaled up, in order to maintain visual fidelity and avoid scaling artifacts.</span></span> <span data-ttu-id="cd12d-184">De même, à mesure que la scène est mise à l’échelle, l’application doit recréer les réalisations géométriques à des tolérances de mise à plat progressive, afin d’éviter un rendu plus lent des détails qui ne sont pas visibles.</span><span class="sxs-lookup"><span data-stu-id="cd12d-184">Similarly, as the scene is scaled down, the app should recreate the geometry realizations at progressively higher flattening tolerances, in order to avoid wastefully rendering details that aren’t visible.</span></span> <span data-ttu-id="cd12d-185">L’application ne doit pas recréer les exécutions géométriques à chaque modification de l’échelle, car cette opération a pour effet de mettre en cache le travail de pavage.</span><span class="sxs-lookup"><span data-stu-id="cd12d-185">The app shouldn’t recreate the geometry realizations every time the scale changes, because doing so defeats the purpose of caching the tessellation work.</span></span> <span data-ttu-id="cd12d-186">Au lieu de cela, l’application doit recréer les réalisations géométriques moins fréquemment : par exemple, après chaque augmentation ou baisse de l’échelle.</span><span class="sxs-lookup"><span data-stu-id="cd12d-186">Instead, the app should recreate the geometry realizations less frequently: for example, after every 2x increase or decrease in scale.</span></span>

<span data-ttu-id="cd12d-187">Chaque fois que la mise à l’échelle change dans une application en réponse à l’interaction de l’utilisateur, l’application peut comparer la nouvelle échelle à l’échelle à laquelle les réalisations de la géométrie ont été créées (stockées, par exemple, dans un membre **m \_ lastScale** ).</span><span class="sxs-lookup"><span data-stu-id="cd12d-187">Each time the scale changes in an app in response to user interaction, the app could compare the new scale against the scale at which the geometry realizations were last created (stored, for example, in an **m\_lastScale** member).</span></span> <span data-ttu-id="cd12d-188">Si les deux valeurs sont proches (dans ce cas, dans le cas d’un facteur de 2), aucune action supplémentaire n’est effectuée.</span><span class="sxs-lookup"><span data-stu-id="cd12d-188">If the two values are close (in this case, within a factor of 2), then no further action is taken.</span></span> <span data-ttu-id="cd12d-189">Toutefois, si les deux valeurs ne sont pas proches, les réalisations de géométrie sont recréées.</span><span class="sxs-lookup"><span data-stu-id="cd12d-189">But if the two values are not close, then the geometry realizations are re-created.</span></span> <span data-ttu-id="cd12d-190">La fonction [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) est utilisée pour calculer une tolérance d’aplatissement appropriée pour la nouvelle échelle, et **m \_ lastScale** est mis à jour avec la nouvelle échelle.</span><span class="sxs-lookup"><span data-stu-id="cd12d-190">The [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) function is used to compute a flattening tolerance appropriate for the new scale, and **m\_lastScale** is updated to the new scale.</span></span>

<span data-ttu-id="cd12d-191">En outre, l’application crée toujours des réalisations à l’aide d’une tolérance plus petite que ce qui serait normalement utilisé pour la nouvelle échelle, en passant une valeur de 2 comme paramètre *maxZoomFactor* à [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="cd12d-191">In addition, the app always creates realizations using a smaller tolerance than what would normally be used for the new scale, by passing a value of 2 as the *maxZoomFactor* parameter to [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)).</span></span> <span data-ttu-id="cd12d-192">Cela permet de mettre à l’échelle les nouvelles réalisations géométriques par un facteur supplémentaire de 2 sans générer d’artefacts de mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="cd12d-192">This allows the new geometry realizations to be scaled up by an additional factor of 2 without incurring scaling artifacts.</span></span>

> [!Note]  
> <span data-ttu-id="cd12d-193">L’approche décrite ici peut ne pas convenir à toutes les applications.</span><span class="sxs-lookup"><span data-stu-id="cd12d-193">The approach described here may not be appropriate for all apps.</span></span> <span data-ttu-id="cd12d-194">Par exemple, si votre application permet la mise à l’échelle de la scène par de très grands facteurs très rapidement (par exemple, si elle contient un curseur « Zoom » qui peut être déplacé de 100% à 1 million% dans l’étendue de quelques frames), cette approche peut entraîner un excès de travail en recréant la géométrie qui effectue chaque trame.</span><span class="sxs-lookup"><span data-stu-id="cd12d-194">For example, if your app allows the scene to be scaled by very large factors very quickly (for example, if it contains a “zoom” slider that can be moved from 100% to 1,000,000% in the span of a few frames) then this approach may result in excess work by recreating the geometry realizations every frame.</span></span> <span data-ttu-id="cd12d-195">Une autre approche consiste à recréer les réalisations géométriques uniquement après que chaque manipulation de l’échelle de la scène est terminée (par exemple, une fois que l’utilisateur a terminé un geste de pincement).</span><span class="sxs-lookup"><span data-stu-id="cd12d-195">An alternative approach is to recreate the geometry realizations only after each manipulation of the scene’s scale has been completed (for example, after the user has completed a pinch gesture).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="cd12d-196">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="cd12d-196">Related topics</span></span>

[<span data-ttu-id="cd12d-197">Vue d’ensemble des géométries</span><span class="sxs-lookup"><span data-stu-id="cd12d-197">Geometries Overview</span></span>](direct2d-geometries-overview.md)

[<span data-ttu-id="cd12d-198">Amélioration des performances des applications Direct2D</span><span class="sxs-lookup"><span data-stu-id="cd12d-198">Improving the performance of Direct2D apps</span></span>](improving-direct2d-performance.md)

[<span data-ttu-id="cd12d-199">Instructions générales pour le rendu de contenu statique complexe</span><span class="sxs-lookup"><span data-stu-id="cd12d-199">General guidelines for rendering complex static content</span></span>](improving-direct2d-performance.md)

[<span data-ttu-id="cd12d-200">**ID2D1DeviceContext1**</span><span class="sxs-lookup"><span data-stu-id="cd12d-200">**ID2D1DeviceContext1**</span></span>](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1devicecontext1)

[<span data-ttu-id="cd12d-201">**ID2D1GeometryRealization**</span><span class="sxs-lookup"><span data-stu-id="cd12d-201">**ID2D1GeometryRealization**</span></span>](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization)

<span data-ttu-id="cd12d-202">[**ComputeFlatteningTolerance fonction)**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="cd12d-202">[**ComputeFlatteningTolerance function**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85))</span></span>