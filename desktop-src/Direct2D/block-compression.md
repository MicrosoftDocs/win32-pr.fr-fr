---
title: Compression de blocs
description: Décrit le fonctionnement de la compression de bloc et comment l’utiliser dans WIC et Direct2D.
ms.assetid: 52AF86A5-16E8-4AC8-BB67-CC2F1A3635B5
ms.topic: article
ms.date: 05/31/2018
ms.custom: seodec18
ms.openlocfilehash: aeb6ba9427a04f7a251a1d59062be508e4249b41
ms.sourcegitcommit: ee06501cc29132927ade9813e0888aaa4decc487
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/28/2021
ms.locfileid: "104530411"
---
# <a name="block-compression"></a><span data-ttu-id="66618-103">Compression de blocs</span><span class="sxs-lookup"><span data-stu-id="66618-103">Block compression</span></span>

<span data-ttu-id="66618-104">À partir de Windows 8.1, Direct2D prend en charge plusieurs formats de pixel compressés en bloc.</span><span class="sxs-lookup"><span data-stu-id="66618-104">Starting with Windows 8.1, Direct2D supports several block compressed pixel formats.</span></span> <span data-ttu-id="66618-105">En outre, Windows 8.1 contient un nouveau codec Windows Imaging Component (WIC) DDS pour permettre le chargement et le stockage d’images compressées de bloc dans le format de fichier DDS.</span><span class="sxs-lookup"><span data-stu-id="66618-105">In addition, Windows 8.1 contains a new Windows Imaging Component (WIC) DDS codec to enable loading and storing block compressed images in the DDS file format.</span></span> <span data-ttu-id="66618-106">La compression de bloc est une technique permettant de réduire la quantité de mémoire graphique consommée par le contenu de la bitmap.</span><span class="sxs-lookup"><span data-stu-id="66618-106">Block compression is a technique for reducing the amount of graphics memory that is consumed by bitmap content.</span></span> <span data-ttu-id="66618-107">En utilisant la compression de bloc, votre application peut réduire la consommation de mémoire et les temps de chargement pour les mêmes images de résolution.</span><span class="sxs-lookup"><span data-stu-id="66618-107">By using block compression, your app can reduce memory consumption and load times for the same resolution images.</span></span> <span data-ttu-id="66618-108">Ou bien, votre application peut utiliser des images de résolution plus ou moins importantes tout en conservant le même encombrement mémoire GPU.</span><span class="sxs-lookup"><span data-stu-id="66618-108">Or, your app can use more or higher resolution images while still consuming the same GPU memory footprint.</span></span>

<span data-ttu-id="66618-109">La compression de bloc a été utilisée par les applications Direct3D depuis longtemps, et avec Windows 8.1 est également disponible pour les développeurs d’applications standard et Direct2D.</span><span class="sxs-lookup"><span data-stu-id="66618-109">Block compression has been used by Direct3D applications for a long time, and with Windows 8.1 is available to mainstream and Direct2D application developers as well.</span></span>

<span data-ttu-id="66618-110">Cette rubrique décrit le fonctionnement de la compression de bloc et comment l’utiliser dans WIC et Direct2D.</span><span class="sxs-lookup"><span data-stu-id="66618-110">This topic describes how block compression works and how to use it in WIC and Direct2D.</span></span>

## <a name="about-block-compression"></a><span data-ttu-id="66618-111">À propos de la compression de bloc</span><span class="sxs-lookup"><span data-stu-id="66618-111">About Block Compression</span></span>

<span data-ttu-id="66618-112">La [compression de bloc](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-resources-block-compression) (BC) fait référence à une classe de techniques de compression pour réduire la taille des textures.</span><span class="sxs-lookup"><span data-stu-id="66618-112">[Block Compression](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-resources-block-compression) (BC) refers to a class of compression techniques for reducing texture sizes.</span></span> <span data-ttu-id="66618-113">Direct3D 11 prend en charge jusqu’à 7 formats BC différents en fonction du niveau de fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="66618-113">Direct3D 11 supports up to 7 different BC formats depending on feature level.</span></span> <span data-ttu-id="66618-114">Dans Windows 8.1 Direct2D introduit la prise en charge des formats BC1, BC2 et BC3 qui sont disponibles dans tous les niveaux de fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="66618-114">In Windows 8.1 Direct2D introduces support for the BC1, BC2 and BC3 formats which are available across all feature levels.</span></span>

### <a name="how-block-compression-works"></a><span data-ttu-id="66618-115">Fonctionnement de la compression de bloc</span><span class="sxs-lookup"><span data-stu-id="66618-115">How Block Compression works</span></span>

<span data-ttu-id="66618-116">Les formats compressés de bloc utilisent tous la même technique de base pour réduire l’espace consommé par les données de couleur.</span><span class="sxs-lookup"><span data-stu-id="66618-116">The block compressed formats all use the same basic technique to reduce the space consumed by color data.</span></span> <span data-ttu-id="66618-117">Cette section résume l’algorithme le plus simple, BC1.</span><span class="sxs-lookup"><span data-stu-id="66618-117">This section summarizes the simplest algorithm, BC1.</span></span> <span data-ttu-id="66618-118">Pour obtenir une explication plus détaillée, consultez [bloquer la compression](/windows/desktop/direct3d11/texture-block-compression-in-direct3d-11).</span><span class="sxs-lookup"><span data-stu-id="66618-118">For a more detailed explanation, see [Block Compression](/windows/desktop/direct3d11/texture-block-compression-in-direct3d-11).</span></span>

<span data-ttu-id="66618-119">Tout d’abord, l’image est divisée en blocs de 4 x 4 pixels.</span><span class="sxs-lookup"><span data-stu-id="66618-119">First, the image is divided into blocks of 4 by 4 pixels.</span></span> <span data-ttu-id="66618-120">Chaque bloc est compressé séparément.</span><span class="sxs-lookup"><span data-stu-id="66618-120">Each block is compressed separately.</span></span>

> [!Note]  
> <span data-ttu-id="66618-121">Cela signifie que la largeur et la hauteur d’une image doivent chacune être un multiple de 4 pixels pour être compressés par blocs.</span><span class="sxs-lookup"><span data-stu-id="66618-121">This means an image’s width and height must each be a multiple of 4 pixel for it to be block compressed.</span></span>

 

<span data-ttu-id="66618-122">Cet exemple d’image montre un bloc de pixels 4x4 dans une image.</span><span class="sxs-lookup"><span data-stu-id="66618-122">This example image shows a 4x4 pixel block within an image.</span></span>

![un exemple d’image montre un bloc de pixels 4x4 dans une image.](images/dds1.png)

<span data-ttu-id="66618-124">Ensuite, dans un bloc de 4 par 4, deux couleurs « référence » sont sélectionnées et sont encodées sous la forme de valeurs de 2 16 bits (5 bits rouges, 6 bits verts, 5 bits bleus).</span><span class="sxs-lookup"><span data-stu-id="66618-124">Next, within a 4 by 4 block, two “reference” colors are selected and are encoded as two 16 bit values (5 bits red, 6 bits green, 5 bits blue).</span></span> <span data-ttu-id="66618-125">Le choix de ces couleurs affecte de manière significative la qualité de l’image et n’est pas trivial.</span><span class="sxs-lookup"><span data-stu-id="66618-125">The choice of these colors significantly affects image quality and is nontrivial.</span></span> <span data-ttu-id="66618-126">Deux couleurs intermédiaires sont calculées en interpolant de manière linéaire entre les deux couleurs de référence dans l’espace de couleurs RVB.</span><span class="sxs-lookup"><span data-stu-id="66618-126">Two intermediate colors are calculated by linearly interpolating between the two reference colors in the RGB color space.</span></span> <span data-ttu-id="66618-127">Cela produit un total de 4 couleurs possibles différentes ; une valeur d’index à deux bits est assignée à chaque couleur.</span><span class="sxs-lookup"><span data-stu-id="66618-127">This produces a total of 4 different possible colors; each color is assigned a two bit index value.</span></span> <span data-ttu-id="66618-128">Toutefois, Notez que seules les deux couleurs de point de terminaison doivent être stockées lorsque l’interpolation est fixe.</span><span class="sxs-lookup"><span data-stu-id="66618-128">However, note that only the two endpoint colors need to be stored as the interpolation is fixed.</span></span>

<span data-ttu-id="66618-129">Dans cette figure, les couleurs 0 et 3 sont sélectionnées en tant que couleurs de « référence » pour le bloc, tandis que les couleurs 1 et 2 sont calculées à l’aide d’une interpolation linéaire.</span><span class="sxs-lookup"><span data-stu-id="66618-129">In this figure, colors 0 and 3 are selected as “reference” colors for the block, while colors 1 and 2 are calculated using linear interpolation.</span></span>

![Diagramme qui montre le calcul de 4 valeurs de couleur pour représenter le bloc.](images/dds2.png)

<span data-ttu-id="66618-131">Enfin, chaque pixel du bloc est mappé à l’une des quatre couleurs calculées précédemment, et chaque pixel est encodé à l’aide de la valeur d’index à deux bits.</span><span class="sxs-lookup"><span data-stu-id="66618-131">Finally, every pixel in the block is mapped to one of the four previously calculated colors, and each pixel is encoded using the two bit index value.</span></span>

<span data-ttu-id="66618-132">La quantité totale de données utilisées pour représenter ces 16 pixels est la suivante :</span><span class="sxs-lookup"><span data-stu-id="66618-132">The total amount of data used to represent these 16 pixels is:</span></span>

`16 bits [to define a reference color] * 2 + 2 bits * 16 [number of pixels]  = 64 bits`

<span data-ttu-id="66618-133">Cela aboutit à une densité moyenne de 4 bits par pixel.</span><span class="sxs-lookup"><span data-stu-id="66618-133">This results in an average density of 4 bits per pixel.</span></span> <span data-ttu-id="66618-134">Pour comparaison, le format DXGI \_ courant \_ B8G8R8A8 \_ UNORM pixel consomme 32 bits par pixel.</span><span class="sxs-lookup"><span data-stu-id="66618-134">For comparison, the common DXGI\_FORMAT\_B8G8R8A8\_UNORM pixel format consumes 32 bits per pixel.</span></span>

<span data-ttu-id="66618-135">Ce diagramme montre que chaque pixel est encodé sous la forme d’un index 2 bits.</span><span class="sxs-lookup"><span data-stu-id="66618-135">This diagram shows that each pixel is encoded as a 2 bit index.</span></span> <span data-ttu-id="66618-136">Le bloc entier est encodé en 64 bits.</span><span class="sxs-lookup"><span data-stu-id="66618-136">The entire block is encoded in 64 bits.</span></span>

![calcul de 4 valeurs de couleur pour représenter le bloc.](images/dds3.png)

<span data-ttu-id="66618-138">Il existe des variantes pour prendre en charge les données alpha et le nombre variable de canaux de couleurs.</span><span class="sxs-lookup"><span data-stu-id="66618-138">There are variations to support alpha data and varying numbers of color channels.</span></span> <span data-ttu-id="66618-139">BC6H et BC7 utilisent des algorithmes très différents afin de prendre en charge le contenu HDR (High dynamique Range) et d’augmenter la qualité de l’image, respectivement.</span><span class="sxs-lookup"><span data-stu-id="66618-139">BC6H and BC7 use significantly different algorithms in order to support high dynamic range (HDR) content and increase image quality, respectively.</span></span>

### <a name="directdraw-surface-dds-file-format"></a><span data-ttu-id="66618-140">Format de fichier de la surface DirectDraw (DDS)</span><span class="sxs-lookup"><span data-stu-id="66618-140">DirectDraw Surface (DDS) file format</span></span>

<span data-ttu-id="66618-141">Les données compressées de bloc sont généralement stockées dans des fichiers de [surface DirectDraw (DDS)](/windows/desktop/direct3ddds/dx-graphics-dds-reference) .</span><span class="sxs-lookup"><span data-stu-id="66618-141">Block compressed data is typically stored in [DirectDraw Surface (DDS)](/windows/desktop/direct3ddds/dx-graphics-dds-reference) files.</span></span> <span data-ttu-id="66618-142">Vous connaissez peut-être les fichiers DDS si vous êtes un développeur Direct3D.</span><span class="sxs-lookup"><span data-stu-id="66618-142">You may be familiar with DDS files if you are a Direct3D developer.</span></span> <span data-ttu-id="66618-143">Notez que Direct2D prend uniquement en charge certaines fonctionnalités DDS. Pour plus d’informations, consultez [spécifications DDS](#dds-requirements).</span><span class="sxs-lookup"><span data-stu-id="66618-143">Note that Direct2D only supports certain DDS features; for more information see [DDS Requirements](#dds-requirements).</span></span>

### <a name="advantages-of-block-compression"></a><span data-ttu-id="66618-144">Avantages de la compression par bloc</span><span class="sxs-lookup"><span data-stu-id="66618-144">Advantages of block compression</span></span>

<span data-ttu-id="66618-145">Les formats compressés de bloc diffèrent des formats de compression d’image d’industrie courants tels que JPEG dans la mesure où les formats BC sont pris en charge en mode natif par les GPU modernes.</span><span class="sxs-lookup"><span data-stu-id="66618-145">Block compressed formats differ from common industry image compression formats such as JPEG in that BC formats are natively supported by modern GPUs.</span></span> <span data-ttu-id="66618-146">Cela signifie que vous pouvez charger directement une image compressée de bloc sur le GPU sans décodage ni décompression.</span><span class="sxs-lookup"><span data-stu-id="66618-146">This means that you can directly load a block compressed image onto the GPU without any decoding or decompression.</span></span> <span data-ttu-id="66618-147">Les formats BC consomment de 4 à 8 bits par pixel en moyenne ; par rapport à une image bitmap BGRA standard non compressée 32 par pixel, cela entraîne des économies de mémoire de 75% à 87,5%.</span><span class="sxs-lookup"><span data-stu-id="66618-147">BC formats consume from 4 to 8 bits per pixel on average; when compared to a typical uncompressed 32 bit per pixel BGRA bitmap, this results in memory savings of 75% to 87.5%.</span></span> <span data-ttu-id="66618-148">En outre, étant donné qu’il n’y a pas d’étape de décodage, le temps nécessaire pour charger une image BC est considérablement réduit par rapport aux formats tels que JPEG.</span><span class="sxs-lookup"><span data-stu-id="66618-148">Also, because there is no decode step, the time to load a BC image is significantly reduced compared to formats like JPEG.</span></span>

### <a name="when-to-use-block-compression"></a><span data-ttu-id="66618-149">Quand utiliser la compression de bloc</span><span class="sxs-lookup"><span data-stu-id="66618-149">When to use Block Compression</span></span>

<span data-ttu-id="66618-150">Vous devez envisager d’utiliser des images compressées de bloc dans votre application au lieu d’autres formats tels que JPEG pour réduire la consommation de mémoire des bitmaps ou pour réduire le décodage et le temps de chargement.</span><span class="sxs-lookup"><span data-stu-id="66618-150">You should consider using block compressed images in your app instead of other formats such as JPEG if you want to reduce the memory consumption of bitmaps or want to reduce decode and load times.</span></span>

<span data-ttu-id="66618-151">Toutefois, la compression de bloc n’est pas appropriée dans tous les cas et nécessite des compromis.</span><span class="sxs-lookup"><span data-stu-id="66618-151">However, block compression is not appropriate for all cases and requires some tradeoffs.</span></span> <span data-ttu-id="66618-152">Tout d’abord, les algorithmes de compression de bloc sont perdus.</span><span class="sxs-lookup"><span data-stu-id="66618-152">First, the block compression algorithms are lossy.</span></span> <span data-ttu-id="66618-153">La compression de bloc fonctionne bien avec le contenu de photographique naturel, mais elle peut introduire des artefacts visuels indésirables dans des images avec des limites nettes et à contraste élevé, telles que des captures d’écran générées par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="66618-153">Block compression works well with natural photographic content but can introduce unwanted visual artifacts into images with sharp, high contrast boundaries, such as computer-generated screenshots.</span></span> <span data-ttu-id="66618-154">Vous devez vous assurer que les ressources de l’image compressée du bloc ont une qualité d’image acceptable avant de les utiliser.</span><span class="sxs-lookup"><span data-stu-id="66618-154">You should ensure that your block compressed image assets have acceptable image quality before using them.</span></span>

<span data-ttu-id="66618-155">Deuxièmement, les fichiers DDS compressés sont généralement consomment plus d’espace sur le disque que les images JPEG comparables.</span><span class="sxs-lookup"><span data-stu-id="66618-155">Second, block compressed DDS files generally consume more space on disk than comparable JPEG images.</span></span> <span data-ttu-id="66618-156">Cela augmentera ensuite la taille du package de votre application et les besoins en bande passante réseau.</span><span class="sxs-lookup"><span data-stu-id="66618-156">This in turn will increase your app’s package size and network bandwidth requirements.</span></span>

## <a name="using-block-compression"></a><span data-ttu-id="66618-157">Utilisation de la compression de bloc</span><span class="sxs-lookup"><span data-stu-id="66618-157">Using Block Compression</span></span>

<span data-ttu-id="66618-158">Cette section explique comment générer et utiliser des éléments multimédias compressés dans une application Direct2D.</span><span class="sxs-lookup"><span data-stu-id="66618-158">This section explains how to generate and use block compressed assets in a Direct2D app.</span></span>

### <a name="overview"></a><span data-ttu-id="66618-159">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="66618-159">Overview</span></span>

<span data-ttu-id="66618-160">Bloquer les fichiers DDS compressés est un format optimisé pour le runtime, ce qui signifie qu’ils sont optimisés pour de bonnes performances au moment de l’exécution de l’application.</span><span class="sxs-lookup"><span data-stu-id="66618-160">Block compressed DDS files are a runtime-optimized format, meaning that they are specifically optimized for good performance at app runtime.</span></span> <span data-ttu-id="66618-161">Nous vous recommandons de continuer à utiliser votre pipeline de création et d’édition de ressources existantes, et de passer uniquement au format compressé de bloc lorsque vous les importez dans votre projet d’application, ou au moment de la génération.</span><span class="sxs-lookup"><span data-stu-id="66618-161">We recommend that you continue to use your existing asset creation and editing pipeline, and only convert to a block compressed format when you import them into your application project, or at build time.</span></span>

### <a name="dds-requirements"></a><span data-ttu-id="66618-162">Configuration de DDS requise</span><span class="sxs-lookup"><span data-stu-id="66618-162">DDS requirements</span></span>

<span data-ttu-id="66618-163">Le format de fichier DDS a été conçu pour prendre en charge un large éventail de fonctionnalités utilisées dans Direct3D.</span><span class="sxs-lookup"><span data-stu-id="66618-163">The DDS file format was designed to support a wide range of features used in Direct3D.</span></span> <span data-ttu-id="66618-164">Direct2D utilise uniquement un sous-ensemble de ces fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="66618-164">Direct2D only uses a subset of these features.</span></span> <span data-ttu-id="66618-165">Par conséquent, lorsque vous créez des images DDS à utiliser avec Direct2D, vous devez garder à l’esprit les restrictions suivantes :</span><span class="sxs-lookup"><span data-stu-id="66618-165">Therefore when you are creating DDS images for use with Direct2D, you must keep in mind the following restrictions:</span></span>

-   <span data-ttu-id="66618-166">Seules les valeurs [**de \_ format dxgi**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) suivantes sont autorisées :</span><span class="sxs-lookup"><span data-stu-id="66618-166">Only the following [**DXGI\_FORMAT**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) values are allowed:</span></span>
    -   <span data-ttu-id="66618-167">DXGI \_ format \_ BC1 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="66618-167">DXGI\_FORMAT\_BC1\_UNORM</span></span>
    -   <span data-ttu-id="66618-168">DXGI \_ format \_ BC2 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="66618-168">DXGI\_FORMAT\_BC2\_UNORM</span></span>
    -   <span data-ttu-id="66618-169">DXGI \_ format \_ BC3 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="66618-169">DXGI\_FORMAT\_BC3\_UNORM</span></span>
-   <span data-ttu-id="66618-170">Les données alpha prémultipliées doivent être utilisées.</span><span class="sxs-lookup"><span data-stu-id="66618-170">Premultiplied alpha data must be used.</span></span> <span data-ttu-id="66618-171">Cela comprend les fichiers DDS hérités utilisant des formats qui définissent explicitement les valeurs alpha prémultipliées (DXT1, DXT2, DXT4), ainsi que les fichiers DDS qui utilisent la \_ structure facilement d’en-tête DDS \_ avec les \_ \_ \_ \_ \_ \_ valeurs prémultipliées en mode Alpha DDS et DDS en mode Alpha.</span><span class="sxs-lookup"><span data-stu-id="66618-171">This includes legacy DDS files using formats that explicitly define premultiplied alpha (DXT1, DXT2, DXT4), as well as DDS files that use the DDS\_HEADER\_DX10 structure with the DDS\_ALPHA\_MODE\_OPAQUE and DDS\_ALPHA\_MODE\_PREMULTIPLIED values.</span></span>
-   <span data-ttu-id="66618-172">Les dimensions X et Y doivent être des multiples de 4 pixels.</span><span class="sxs-lookup"><span data-stu-id="66618-172">The X and Y dimensions must be multiples of 4 pixels.</span></span>
-   <span data-ttu-id="66618-173">Les textures de volume, les cubemaps, les des mipmaps ou les tableaux de texture ne sont pas autorisés.</span><span class="sxs-lookup"><span data-stu-id="66618-173">Volume textures, cubemaps, mipmaps, or texture arrays are not allowed.</span></span> <span data-ttu-id="66618-174">Vous devez uniquement utiliser des images source à image unique.</span><span class="sxs-lookup"><span data-stu-id="66618-174">You should only use single frame source images.</span></span>

### <a name="generating-block-compressed-assets"></a><span data-ttu-id="66618-175">Génération de ressources en bloc compressées</span><span class="sxs-lookup"><span data-stu-id="66618-175">Generating Block Compressed assets</span></span>

<span data-ttu-id="66618-176">Il existe un large éventail d’outils de création de DDS disponibles pour créer ou convertir des fichiers DDS compressés par blocs.</span><span class="sxs-lookup"><span data-stu-id="66618-176">There are a variety of DDS authoring tools available to create or convert block compressed DDS files.</span></span> <span data-ttu-id="66618-177">Remarque tous les outils ne prennent pas en charge la configuration requise pour l’utilisation de fichiers DDS avec Direct2D, comme détaillé dans la section précédente.</span><span class="sxs-lookup"><span data-stu-id="66618-177">Note not all tools support the requirements for using DDS files with Direct2D, as detailed in the previous section.</span></span>

<span data-ttu-id="66618-178">À partir de Visual Studio 2013, vous pouvez faire en sorte que Visual Studio convertisse les ressources visuelles existantes, telles que JPEG et PNG, au format compressé de bloc DDS comme faisant partie intégrante de votre processus de génération.</span><span class="sxs-lookup"><span data-stu-id="66618-178">Beginning with Visual Studio 2013, you can have Visual Studio convert existing visual assets such as JPEG and PNG to the correct DDS block compressed format as an automatic part of your build process.</span></span> <span data-ttu-id="66618-179">Pour ce faire, utilisez l’étape de génération personnalisée de la tâche de contenu d’image.</span><span class="sxs-lookup"><span data-stu-id="66618-179">This is accomplished using the Image Content Task custom build step.</span></span>

<span data-ttu-id="66618-180">Pour plus d’informations sur la configuration de ce pour votre projet, consultez : [Comment : exporter une texture pour une utilisation avec des applications Direct2D ou Direct2D](/previous-versions/visualstudio/visual-studio-2013/dn392693(v=vs.120)).</span><span class="sxs-lookup"><span data-stu-id="66618-180">For information on how to set this up for your project, see: [How to: Export a Texture for Use with Direct2D or Javascipt Apps](/previous-versions/visualstudio/visual-studio-2013/dn392693(v=vs.120)).</span></span>

### <a name="direct2d-apis"></a><span data-ttu-id="66618-181">API Direct2D</span><span class="sxs-lookup"><span data-stu-id="66618-181">Direct2D APIs</span></span>

<span data-ttu-id="66618-182">Direct2D est mis à jour dans Windows 8.1 pour prendre en charge les formats de pixel suivants :</span><span class="sxs-lookup"><span data-stu-id="66618-182">Direct2D is updated in Windows 8.1 to support the following pixel formats:</span></span>

-   <span data-ttu-id="66618-183">DXGI \_ format \_ BC1 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="66618-183">DXGI\_FORMAT\_BC1\_UNORM</span></span>
-   <span data-ttu-id="66618-184">DXGI \_ format \_ BC2 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="66618-184">DXGI\_FORMAT\_BC2\_UNORM</span></span>
-   <span data-ttu-id="66618-185">DXGI \_ format \_ BC3 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="66618-185">DXGI\_FORMAT\_BC3\_UNORM</span></span>

<span data-ttu-id="66618-186">Pour les formats précédents, vous devez utiliser l’alpha prémultiplié.</span><span class="sxs-lookup"><span data-stu-id="66618-186">For the preceding formats, you must use premultiplied alpha.</span></span> <span data-ttu-id="66618-187">En outre, ces formats ne sont valides que pour une utilisation en tant que source, et non comme cible.</span><span class="sxs-lookup"><span data-stu-id="66618-187">In addition, these formats are only valid for use as a source, not a target.</span></span> <span data-ttu-id="66618-188">Par exemple, cela signifie que vous pouvez créer un bitmap Direct2D à l’aide de BC1, mais pas d’un contexte de périphérique.</span><span class="sxs-lookup"><span data-stu-id="66618-188">For example, this means that you can create a Direct2D bitmap using BC1, but not a device context.</span></span>

<span data-ttu-id="66618-189">Les méthodes suivantes sont mises à jour dans Windows 8.1 pour prendre en charge les formats BC :</span><span class="sxs-lookup"><span data-stu-id="66618-189">The following methods are updated in Windows 8.1 to support BC formats:</span></span>

-   [<span data-ttu-id="66618-190">**ID2D1DeviceContext :: IsDxgiFormatSupported**</span><span class="sxs-lookup"><span data-stu-id="66618-190">**ID2D1DeviceContext::IsDxgiFormatSupported**</span></span>](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-isdxgiformatsupported)
-   <span data-ttu-id="66618-191">[**ID2D1DeviceContext :: CreateBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmap(d2d1_size_u_constvoid_uint32_constd2d1_bitmap_properties1__id2d1bitmap1))</span><span class="sxs-lookup"><span data-stu-id="66618-191">[**ID2D1DeviceContext::CreateBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmap(d2d1_size_u_constvoid_uint32_constd2d1_bitmap_properties1__id2d1bitmap1))</span></span>
-   <span data-ttu-id="66618-192">[**ID2D1DeviceContext :: CreateBitmapFromDxgiSurface**](/windows/desktop/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1__id2d1bitmap1))</span><span class="sxs-lookup"><span data-stu-id="66618-192">[**ID2D1DeviceContext::CreateBitmapFromDxgiSurface**](/windows/desktop/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1__id2d1bitmap1))</span></span>
-   [<span data-ttu-id="66618-193">**ID2D1RenderTarget :: CreateSharedBitmap**</span><span class="sxs-lookup"><span data-stu-id="66618-193">**ID2D1RenderTarget::CreateSharedBitmap**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap)
-   [<span data-ttu-id="66618-194">**ID2D1RenderTarget :: CreateBitmapFromWicBitmap**</span><span class="sxs-lookup"><span data-stu-id="66618-194">**ID2D1RenderTarget::CreateBitmapFromWicBitmap**</span></span>](id2d1rendertarget-createbitmapfromwicbitmap.md)
-   [<span data-ttu-id="66618-195">**ID2D1Bitmap::CopyFromMemory**</span><span class="sxs-lookup"><span data-stu-id="66618-195">**ID2D1Bitmap::CopyFromMemory**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrommemory)
-   [<span data-ttu-id="66618-196">**ID2D1Bitmap::CopyFromBitmap**</span><span class="sxs-lookup"><span data-stu-id="66618-196">**ID2D1Bitmap::CopyFromBitmap**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrombitmap)
-   [<span data-ttu-id="66618-197">**ID2D1Bitmap1::GetSurface**</span><span class="sxs-lookup"><span data-stu-id="66618-197">**ID2D1Bitmap1::GetSurface**</span></span>](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1bitmap1-getsurface)

<span data-ttu-id="66618-198">Notez que [**CreateBitmapFromWicBitmap**](id2d1devicecontext-createbitmapfromwicbitmap-overload.md) prend [**IWICBitmapSource**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapsource) en tant qu’interface ; Toutefois, dans Windows 8.1 WIC ne prend pas en charge l’obtention de données de bloc compressées à partir de **IWICBitmapSource**, et il n’existe aucun format de pixel WIC correspondant au \_ format dxgi \_ BC1 \_ UNORM, etc. Au lieu de cela, **CreateBitmapFromWicBitmap** détermine si le **IWICBITMAPSOURCE** est un DDS [**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) valide et charge directement les données compressées du bloc.</span><span class="sxs-lookup"><span data-stu-id="66618-198">Note that [**CreateBitmapFromWicBitmap**](id2d1devicecontext-createbitmapfromwicbitmap-overload.md) takes [**IWICBitmapSource**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapsource) as an interface; however in Windows 8.1 WIC does not support obtaining block compressed data from **IWICBitmapSource**, and there is no WIC pixel format corresponding to DXGI\_FORMAT\_BC1\_UNORM, etc. Instead, **CreateBitmapFromWicBitmap** determines if the **IWICBitmapSource** is a valid DDS [**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) and directly loads the block compressed data.</span></span> <span data-ttu-id="66618-199">Vous pouvez soit spécifier explicitement le format de pixel dans le struct [**d2d1 \_ bitmap \_ PROPERTIES1**](/windows/desktop/api/D2D1_1/ns-d2d1_1-d2d1_bitmap_properties1) , soit autoriser Direct2D à déterminer automatiquement le format correct.</span><span class="sxs-lookup"><span data-stu-id="66618-199">You can either explicitly specify the pixel format in the [**D2D1\_BITMAP\_PROPERTIES1**](/windows/desktop/api/D2D1_1/ns-d2d1_1-d2d1_bitmap_properties1) struct, or allow Direct2D to automatically determine the correct format.</span></span>

### <a name="windows-imaging-component-apis"></a><span data-ttu-id="66618-200">API du composant de création d’images Windows</span><span class="sxs-lookup"><span data-stu-id="66618-200">Windows Imaging Component APIs</span></span>

<span data-ttu-id="66618-201">Le composant WIC (Windows Imaging Component) ajoute un nouveau codec DDS dans Windows 8.1.</span><span class="sxs-lookup"><span data-stu-id="66618-201">The Windows Imaging Component (WIC) adds a new DDS codec in Windows 8.1.</span></span> <span data-ttu-id="66618-202">En outre, il ajoute de nouvelles interfaces qui prennent en charge l’accès aux données spécifiques à DDS, y compris les données de pixels compressées de bloc :</span><span class="sxs-lookup"><span data-stu-id="66618-202">In addition, it adds new interfaces that support accessing DDS-specific data, including block compressed pixel data:</span></span>

-   [<span data-ttu-id="66618-203">**IWICDdsDecoder**</span><span class="sxs-lookup"><span data-stu-id="66618-203">**IWICDdsDecoder**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicddsdecoder)
-   [<span data-ttu-id="66618-204">**IWICDdsEncoder**</span><span class="sxs-lookup"><span data-stu-id="66618-204">**IWICDdsEncoder**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicddsencoder)
-   [<span data-ttu-id="66618-205">**IWICDdsFrameDecode**</span><span class="sxs-lookup"><span data-stu-id="66618-205">**IWICDdsFrameDecode**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicddsframedecode)

### <a name="block-compressed-wic-pixel-formats"></a><span data-ttu-id="66618-206">Bloquer les formats de pixel WIC compressés</span><span class="sxs-lookup"><span data-stu-id="66618-206">Block Compressed WIC pixel formats</span></span>

<span data-ttu-id="66618-207">Il n’existe aucun nouveau format de pixel compressé de bloc WIC dans Windows 8.1.</span><span class="sxs-lookup"><span data-stu-id="66618-207">There are no new WIC block compressed pixel formats in Windows 8.1.</span></span> <span data-ttu-id="66618-208">Au lieu de cela, si vous obtenez un [**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) à partir du décodeur DDS et appelez [**CopyPixels**](/windows/desktop/api/wincodec/nf-wincodec-iwicbitmapsource-copypixels), vous recevrez des pixels non compressés standard tels que WICPixelFormat32bppPBGRA.</span><span class="sxs-lookup"><span data-stu-id="66618-208">Instead, if you obtain an [**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) from the DDS decoder and call [**CopyPixels**](/windows/desktop/api/wincodec/nf-wincodec-iwicbitmapsource-copypixels), you will receive standard uncompressed pixels such as WICPixelFormat32bppPBGRA.</span></span> <span data-ttu-id="66618-209">Vous pouvez utiliser [**IWICDdsFrameDecode :: CopyBlocks**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsframedecode-copyblocks) pour obtenir les données compressées de bloc brutes sous la forme d’une mémoire tampon à partir d’un fichier DDS.</span><span class="sxs-lookup"><span data-stu-id="66618-209">You can use [**IWICDdsFrameDecode::CopyBlocks**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsframedecode-copyblocks) to obtain the raw block compressed data in the form of a memory buffer from a DDS file.</span></span>

### <a name="multi-frame-dds-access"></a><span data-ttu-id="66618-210">Accès DDS multi-Frame</span><span class="sxs-lookup"><span data-stu-id="66618-210">Multi-frame DDS access</span></span>

<span data-ttu-id="66618-211">Le format de fichier DDS permet de stocker plusieurs images associées dans un seul fichier.</span><span class="sxs-lookup"><span data-stu-id="66618-211">The DDS file format allows for multiple related images to be stored in a single file.</span></span> <span data-ttu-id="66618-212">Par exemple, un fichier DDS peut contenir un carte cubique, une texture de volume ou un tableau de textures, qui peuvent tous être mipmapped.</span><span class="sxs-lookup"><span data-stu-id="66618-212">For example, a DDS file may contain a cubemap, volume texture, or texture array, all of which can be mipmapped.</span></span> <span data-ttu-id="66618-213">Dans Direct3D, ces différentes images sont exposées en tant que sous-ressources.</span><span class="sxs-lookup"><span data-stu-id="66618-213">In Direct3D, these multiple images are exposed as subresources.</span></span> <span data-ttu-id="66618-214">Dans WIC, plusieurs images sont exposées en tant que frames ([**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) et [**IWICBitmapFrameEncode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframeencode)).</span><span class="sxs-lookup"><span data-stu-id="66618-214">In WIC, multiple images are exposed as frames ([**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) and [**IWICBitmapFrameEncode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframeencode)).</span></span>

<span data-ttu-id="66618-215">WIC prend uniquement en charge la notion d’un tableau unidimensionnel de frames, tandis que DDS prend en charge trois dimensions indépendantes (même si seulement deux peuvent être utilisées dans un fichier).</span><span class="sxs-lookup"><span data-stu-id="66618-215">WIC only supports the notion of a single dimensional array of frames, while DDS supports three independent dimensions (although only two may be used in any one file).</span></span> <span data-ttu-id="66618-216">WIC fournit des méthodes pratiques pour faciliter le mappage entre une sous-ressource DDS et une trame WIC.</span><span class="sxs-lookup"><span data-stu-id="66618-216">WIC provides convenience methods to assist with mapping between a DDS subresource and WIC frame.</span></span> <span data-ttu-id="66618-217">Pour le décodage, [**IWICDdsDecoder :: GetFrame**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsdecoder-getframe) vous permet de spécifier l’index de tableau, le niveau MIP et l’index de tranche de la sous-ressource, puis renvoie le frame WIC correct.</span><span class="sxs-lookup"><span data-stu-id="66618-217">For decoding, [**IWICDdsDecoder::GetFrame**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsdecoder-getframe) lets you specify the array index, mip level and slice index of the subresource, and returns the correct WIC frame.</span></span>

<span data-ttu-id="66618-218">Pour l’encodage, [**IWICDdsEncoder :: CreateNewFrame**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsencoder-createnewframe) calcule l’index de tableau résultant, le niveau MIP et l’index de découpage lorsque vous créez un nouveau Frame.</span><span class="sxs-lookup"><span data-stu-id="66618-218">For encoding, [**IWICDdsEncoder::CreateNewFrame**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsencoder-createnewframe) computes the resulting array index, mip level and slice index when you create a new frame.</span></span> <span data-ttu-id="66618-219">Vous devez d’abord appeler [**IWICDdsEncoder :: SetParameters**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsencoder-setparameters) pour définir les paramètres de fichier spécifiques au DDS.</span><span class="sxs-lookup"><span data-stu-id="66618-219">You must have first called [**IWICDdsEncoder::SetParameters**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsencoder-setparameters) to define the DDS-specific file parameters.</span></span>

## <a name="related-topics"></a><span data-ttu-id="66618-220">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="66618-220">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="66618-221">[Guide pratique pour exporter une texture pour l’utiliser avec des applications Javascript ou Direct2D](/previous-versions/visualstudio/visual-studio-2013/dn392693(v=vs.120))</span><span class="sxs-lookup"><span data-stu-id="66618-221">[How to: Export a Texture for Use with Direct2D or Javascipt Apps](/previous-versions/visualstudio/visual-studio-2013/dn392693(v=vs.120))</span></span>
</dt> <dt>

[<span data-ttu-id="66618-222">Référence pour DDS</span><span class="sxs-lookup"><span data-stu-id="66618-222">Reference for DDS</span></span>](/windows/desktop/direct3ddds/dx-graphics-dds-reference)
</dt> <dt>

[<span data-ttu-id="66618-223">Compression de bloc</span><span class="sxs-lookup"><span data-stu-id="66618-223">Block Compression</span></span>](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-resources-block-compression)
</dt> </dl>

 

 