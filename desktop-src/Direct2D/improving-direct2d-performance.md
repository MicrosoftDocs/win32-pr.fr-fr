---
title: Amélioration des performances des applications Direct2D
description: Décrit les techniques d’amélioration des performances de Direct2D.
ms.assetid: e6b02925-4e75-42b0-b0c4-00f1ddb85e46
keywords:
- Direct2D, performances
- Direct2D, bitmaps
- Direct2D, utilisation des ressources
- Direct2D, méthode Flush
- Direct2D, contenu statique
- performances pour Direct2D
- bitmaps pour Direct2D
- Direct2D, interopérabilité GDI
- Direct2D, interopérabilité
- interopérabilité, Direct2D
- Graphics Device Interface (GDI)
- GDI (Graphics Device Interface)
- interopérabilité, Graphics Device Interface (GDI)
ms.topic: article
ms.date: 05/31/2018
ms.custom: seodec18
ms.openlocfilehash: 5a413b96e00514b64b3cf1b1ee451a84a9e9ff09
ms.sourcegitcommit: 6eb53540b8d882fd035d428567d7d1c5ec17042c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/12/2020
ms.locfileid: "104463887"
---
# <a name="improving-the-performance-of-direct2d-apps"></a><span data-ttu-id="06f68-116">Amélioration des performances des applications Direct2D</span><span class="sxs-lookup"><span data-stu-id="06f68-116">Improving the performance of Direct2D apps</span></span>

<span data-ttu-id="06f68-117">Bien que [Direct2D](./direct2d-portal.md) soit accéléré par le matériel et soit conçu pour des performances élevées, vous devez utiliser les fonctionnalités correctement pour maximiser le débit.</span><span class="sxs-lookup"><span data-stu-id="06f68-117">Although [Direct2D](./direct2d-portal.md) is hardware accelerated and is meant for high performance, you must use the features correctly to maximize throughput.</span></span> <span data-ttu-id="06f68-118">Les techniques présentées ici sont dérivées de l’étude des scénarios courants et peuvent ne pas s’appliquer à tous les scénarios d’application.</span><span class="sxs-lookup"><span data-stu-id="06f68-118">The techniques we show here are derived from studying common scenarios and might not apply to all app scenarios.</span></span> <span data-ttu-id="06f68-119">Par conséquent, une bonne compréhension du comportement de l’application et des objectifs de performances peut vous aider à obtenir les résultats souhaités.</span><span class="sxs-lookup"><span data-stu-id="06f68-119">Therefore, careful understanding of app behavior and performance goals can help achieve the results that you want.</span></span>

-   [<span data-ttu-id="06f68-120">Utilisation des ressources</span><span class="sxs-lookup"><span data-stu-id="06f68-120">Resource usage</span></span>](#resource-usage)
    -   [<span data-ttu-id="06f68-121">Réutiliser les ressources</span><span class="sxs-lookup"><span data-stu-id="06f68-121">Reuse resources</span></span>](#reuse-resources)
-   [<span data-ttu-id="06f68-122">Limiter l’utilisation du vidage</span><span class="sxs-lookup"><span data-stu-id="06f68-122">Restrict the use of flush</span></span>](#restrict-the-use-of-flush)
-   [<span data-ttu-id="06f68-123">Images bitmap</span><span class="sxs-lookup"><span data-stu-id="06f68-123">Bitmaps</span></span>](#create-large-bitmaps)
    -   [<span data-ttu-id="06f68-124">Créer des bitmaps de grande taille</span><span class="sxs-lookup"><span data-stu-id="06f68-124">Create large bitmaps</span></span>](#create-large-bitmaps)
    -   [<span data-ttu-id="06f68-125">Créer un Atlas de bitmaps</span><span class="sxs-lookup"><span data-stu-id="06f68-125">Create an atlas of bitmaps</span></span>](#create-an-atlas-of-bitmaps)
    -   [<span data-ttu-id="06f68-126">Créer des bitmaps partagées</span><span class="sxs-lookup"><span data-stu-id="06f68-126">Create shared bitmaps</span></span>](#create-shared-bitmaps)
    -   [<span data-ttu-id="06f68-127">Copier des bitmaps</span><span class="sxs-lookup"><span data-stu-id="06f68-127">Copying bitmaps</span></span>](#copying-bitmaps)
-   [<span data-ttu-id="06f68-128">Utiliser une image bitmap en mosaïque sur des tirets</span><span class="sxs-lookup"><span data-stu-id="06f68-128">Use tiled bitmap over dashing</span></span>](#use-tiled-bitmap-over-dashing)
-   [<span data-ttu-id="06f68-129">Instructions générales pour le rendu de contenu statique complexe</span><span class="sxs-lookup"><span data-stu-id="06f68-129">General guidelines for rendering complex static content</span></span>](#general-guidelines-for-rendering-complex-static-content)
    -   [<span data-ttu-id="06f68-130">Mise en cache de scène complète à l’aide d’une bitmap de couleur</span><span class="sxs-lookup"><span data-stu-id="06f68-130">Full scene caching using a color bitmap</span></span>](#full-scene-caching-using-a-color-bitmap)
    -   [<span data-ttu-id="06f68-131">Par mise en cache primitive à l’aide d’une bitmap a8 et de la méthode FillOpacityMask</span><span class="sxs-lookup"><span data-stu-id="06f68-131">Per primitive caching using an A8 bitmap and the FillOpacityMask method</span></span>](#per-primitive-caching-using-an-a8-bitmap-and-the-fillopacitymask-method)
-   [<span data-ttu-id="06f68-132">Mise en cache par primitive utilisant des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="06f68-132">Per-primitive caching using geometry realizations</span></span>](#per-primitive-caching-using-geometry-realizations)
-   [<span data-ttu-id="06f68-133">Rendu de géométrie</span><span class="sxs-lookup"><span data-stu-id="06f68-133">Geometry rendering</span></span>](#geometry-rendering)
    -   [<span data-ttu-id="06f68-134">Utiliser une primitive de dessin spécifique sur la géométrie de dessin</span><span class="sxs-lookup"><span data-stu-id="06f68-134">Use specific draw primitive over draw geometry</span></span>](#use-specific-draw-primitive-over-draw-geometry)
    -   [<span data-ttu-id="06f68-135">Rendu de Geometry statique</span><span class="sxs-lookup"><span data-stu-id="06f68-135">Rendering static geometry</span></span>](#rendering-static-geometry)
    -   [<span data-ttu-id="06f68-136">Utiliser un contexte de périphérique multithread</span><span class="sxs-lookup"><span data-stu-id="06f68-136">Use a multithreaded device context</span></span>](#use-a-multithreaded-device-context)
-   [<span data-ttu-id="06f68-137">Dessiner du texte avec Direct2D</span><span class="sxs-lookup"><span data-stu-id="06f68-137">Drawing text with Direct2D</span></span>](#use-a-multithreaded-device-context)
    -   [<span data-ttu-id="06f68-138">DrawTextLayout et DrawText</span><span class="sxs-lookup"><span data-stu-id="06f68-138">DrawTextLayout Vs. DrawText</span></span>](#drawtextlayout-vs-drawtext)
    -   [<span data-ttu-id="06f68-139">Choix du mode de rendu de texte approprié</span><span class="sxs-lookup"><span data-stu-id="06f68-139">Choosing the right text rendering mode</span></span>](#choosing-the-right-text-rendering-mode)
    -   [<span data-ttu-id="06f68-140">Mise en cache</span><span class="sxs-lookup"><span data-stu-id="06f68-140">Caching</span></span>](#full-scene-caching-using-a-color-bitmap)
-   [<span data-ttu-id="06f68-141">Découpage d’une forme arbitraire</span><span class="sxs-lookup"><span data-stu-id="06f68-141">Clipping an arbitrary shape</span></span>](#clipping-an-arbitrary-shape)
    -   [<span data-ttu-id="06f68-142">PushLayer dans Windows 8</span><span class="sxs-lookup"><span data-stu-id="06f68-142">PushLayer in Windows 8</span></span>](#pushlayer-in-windows-8)
    -   [<span data-ttu-id="06f68-143">Clips alignés sur l’axe</span><span class="sxs-lookup"><span data-stu-id="06f68-143">Axis-aligned clips</span></span>](#axis-aligned-clips)
-   [<span data-ttu-id="06f68-144">Interopérabilité des DXGI : Évitez les commutateurs fréquents</span><span class="sxs-lookup"><span data-stu-id="06f68-144">DXGI interoperability: avoid frequent switches</span></span>](#dxgi-interoperability-avoid-frequent-switches)
-   [<span data-ttu-id="06f68-145">Connaître le format de pixel</span><span class="sxs-lookup"><span data-stu-id="06f68-145">Know Your Pixel Format</span></span>](#know-your-pixel-format)
-   [<span data-ttu-id="06f68-146">Complexité de la scène</span><span class="sxs-lookup"><span data-stu-id="06f68-146">Scene Complexity</span></span>](#scene-complexity)
    -   [<span data-ttu-id="06f68-147">Comprendre la complexité des scènes</span><span class="sxs-lookup"><span data-stu-id="06f68-147">Understand Scene Complexity</span></span>](#understand-scene-complexity)
-   [<span data-ttu-id="06f68-148">Amélioration des performances pour les applications d’impression Direct2D</span><span class="sxs-lookup"><span data-stu-id="06f68-148">Improving performance for Direct2D printing apps</span></span>](#improving-performance-for-direct2d-printing-apps)
    -   [<span data-ttu-id="06f68-149">Définir les valeurs de propriété appropriées lorsque vous créez le contrôle d’impression D2D</span><span class="sxs-lookup"><span data-stu-id="06f68-149">Set the right property values when you create the D2D print control</span></span>](#set-the-right-property-values-when-you-create-the-d2d-print-control)
    -   [<span data-ttu-id="06f68-150">Évitez d’utiliser certains modèles de dessin Direct2D</span><span class="sxs-lookup"><span data-stu-id="06f68-150">Avoid using certain Direct2D drawing patterns</span></span>](#avoid-using-certain-direct2d-drawing-patterns)
    -   [<span data-ttu-id="06f68-151">Dessiner du texte de manière directe et simple</span><span class="sxs-lookup"><span data-stu-id="06f68-151">Draw text in a direct and plain way</span></span>](#draw-text-in-a-direct-and-plain-way)
    -   [<span data-ttu-id="06f68-152">Dessiner les bitmaps d’origine lorsque cela est possible</span><span class="sxs-lookup"><span data-stu-id="06f68-152">Draw the original bitmaps when possible</span></span>](#draw-the-original-bitmaps-when-possible)
-   [<span data-ttu-id="06f68-153">Conclusion</span><span class="sxs-lookup"><span data-stu-id="06f68-153">Conclusion</span></span>](#conclusion)

## <a name="resource-usage"></a><span data-ttu-id="06f68-154">Utilisation des ressources</span><span class="sxs-lookup"><span data-stu-id="06f68-154">Resource usage</span></span>

<span data-ttu-id="06f68-155">Une ressource est une allocation de quelque nature que ce soit dans la mémoire vidéo ou système.</span><span class="sxs-lookup"><span data-stu-id="06f68-155">A resource is an allocation of some kind, either in video or system memory.</span></span> <span data-ttu-id="06f68-156">Les bitmaps et les pinceaux sont des exemples de ressources.</span><span class="sxs-lookup"><span data-stu-id="06f68-156">Bitmaps and brushes are examples of resources.</span></span>

<span data-ttu-id="06f68-157">Dans Direct2D, les ressources peuvent être créées à la fois dans le logiciel et le matériel.</span><span class="sxs-lookup"><span data-stu-id="06f68-157">In Direct2D, resources can be created both in software and hardware.</span></span> <span data-ttu-id="06f68-158">La création et la suppression de ressources sur le matériel sont des opérations coûteuses, car elles nécessitent beaucoup de surcharge pour communiquer avec la carte vidéo.</span><span class="sxs-lookup"><span data-stu-id="06f68-158">Resource creation and deletion on hardware are expensive operations because they require lots of overhead for communicating with the video card.</span></span> <span data-ttu-id="06f68-159">Voyons comment Direct2D rend le contenu dans une cible.</span><span class="sxs-lookup"><span data-stu-id="06f68-159">Let's see how Direct2D renders content to a target.</span></span>

<span data-ttu-id="06f68-160">Dans Direct2D, toutes les commandes de rendu sont comprises entre un appel à [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) et un appel à [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span><span class="sxs-lookup"><span data-stu-id="06f68-160">In Direct2D, all the rendering commands are enclosed between a call to [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) and a call to [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span></span> <span data-ttu-id="06f68-161">Ces appels sont effectués sur une cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="06f68-161">These calls are made to a render target.</span></span> <span data-ttu-id="06f68-162">Vous devez appeler la méthode **BeginDraw** avant d’appeler des opérations de rendu.</span><span class="sxs-lookup"><span data-stu-id="06f68-162">You must call the **BeginDraw** method before you call rendering operations .</span></span> <span data-ttu-id="06f68-163">Une fois que vous avez appelé **BeginDraw** , un contexte génère généralement un lot de commandes de rendu, mais retarde le traitement de ces commandes jusqu’à ce que l’une de ces instructions soit vraie :</span><span class="sxs-lookup"><span data-stu-id="06f68-163">After you call **BeginDraw** , a context typically builds up a batch of rendering commands, but delays processing of these commands until one of these statements is true:</span></span>

-   <span data-ttu-id="06f68-164">[**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw) s’est produit.</span><span class="sxs-lookup"><span data-stu-id="06f68-164">[**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw) occurred.</span></span> <span data-ttu-id="06f68-165">Quand **EndDraw** est appelé, toutes les opérations de dessin par lot sont effectuées et retourne l’état de l’opération.</span><span class="sxs-lookup"><span data-stu-id="06f68-165">When **EndDraw** is called, it causes any batched drawing operations to complete and returns the status of the operation.</span></span>
-   <span data-ttu-id="06f68-166">Vous effectuez un appel explicite à [**flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush): la méthode **flush** provoque le traitement du lot et l’émission de toutes les commandes en attente.</span><span class="sxs-lookup"><span data-stu-id="06f68-166">You make an explicit call to [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush): The **Flush** method causes the batch to be processed and all pending commands to be issued.</span></span>
-   <span data-ttu-id="06f68-167">La mémoire tampon contenant les commandes de rendu est pleine.</span><span class="sxs-lookup"><span data-stu-id="06f68-167">The buffer holding the rendering commands is full.</span></span> <span data-ttu-id="06f68-168">Si cette mémoire tampon est saturée avant que les deux conditions précédentes soient remplies, les commandes de rendu sont vidées.</span><span class="sxs-lookup"><span data-stu-id="06f68-168">If this buffer becomes full before the previous two conditions are fulfilled, the rendering commands are flushed out.</span></span>

<span data-ttu-id="06f68-169">Tant que les primitives n’ont pas été vidées, Direct2D conserve les références internes aux ressources correspondantes, telles que les bitmaps et les pinceaux.</span><span class="sxs-lookup"><span data-stu-id="06f68-169">Until the primitives are flushed, Direct2D keeps internal references to corresponding resources like bitmaps and brushes.</span></span>

### <a name="reuse-resources"></a><span data-ttu-id="06f68-170">Réutiliser les ressources</span><span class="sxs-lookup"><span data-stu-id="06f68-170">Reuse resources</span></span>

<span data-ttu-id="06f68-171">Comme mentionné précédemment, la création et la suppression de ressources sont onéreuses sur le matériel.</span><span class="sxs-lookup"><span data-stu-id="06f68-171">As already mentioned, resource creation and deletion is expensive on hardware.</span></span> <span data-ttu-id="06f68-172">Réutilisez les ressources lorsque cela est possible.</span><span class="sxs-lookup"><span data-stu-id="06f68-172">So reuse resources when possible.</span></span> <span data-ttu-id="06f68-173">Prenons l’exemple de création de bitmaps dans le développement de jeux.</span><span class="sxs-lookup"><span data-stu-id="06f68-173">Take the example of bitmap creation in game development.</span></span> <span data-ttu-id="06f68-174">En règle générale, les bitmaps qui composent une scène dans un jeu sont tous créés en même temps avec toutes les différentes variations requises pour un rendu de trame à image ultérieur.</span><span class="sxs-lookup"><span data-stu-id="06f68-174">Usually, bitmaps that make up a scene in a game are all created at the same time with all the different variations that are required for later frame-to-frame rendering.</span></span> <span data-ttu-id="06f68-175">Au moment du rendu et du rendu de la scène, ces bitmaps sont réutilisés au lieu d’être recréés.</span><span class="sxs-lookup"><span data-stu-id="06f68-175">At the time of actual scene rendering and re-rendering, these bitmaps are reused instead of re-created.</span></span>

> [!Note]  
> <span data-ttu-id="06f68-176">Vous ne pouvez pas réutiliser des ressources pour l’opération de redimensionnement de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="06f68-176">You can't reuse resources for the window resize operation.</span></span> <span data-ttu-id="06f68-177">Quand une fenêtre est redimensionnée, certaines ressources dépendantes de l’échelle, telles que les cibles de rendu compatibles et éventuellement certaines ressources de couche, doivent être recréées, car le contenu de la fenêtre doit être redessiné.</span><span class="sxs-lookup"><span data-stu-id="06f68-177">When a window is resized, some scale-dependent resources such as compatible render targets and possibly some layer resources must be re-created because the window content has to be redrawn.</span></span> <span data-ttu-id="06f68-178">Cela peut être important pour maintenir la qualité globale de la scène rendue.</span><span class="sxs-lookup"><span data-stu-id="06f68-178">This can be important for maintaining the overall quality of the rendered scene.</span></span>

 

## <a name="restrict-the-use-of-flush"></a><span data-ttu-id="06f68-179">Limiter l’utilisation du vidage</span><span class="sxs-lookup"><span data-stu-id="06f68-179">Restrict the use of flush</span></span>

<span data-ttu-id="06f68-180">Étant donné que la méthode [**flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush) entraîne le traitement des commandes de rendu par lot, nous vous recommandons de ne pas les utiliser.</span><span class="sxs-lookup"><span data-stu-id="06f68-180">Because the [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush) method causes the batched rendering commands to be processed, we recommend that you don't use it.</span></span> <span data-ttu-id="06f68-181">Pour les scénarios les plus courants, laissez la gestion des ressources à Direct2D.</span><span class="sxs-lookup"><span data-stu-id="06f68-181">For most common scenarios, leave resource management to Direct2D.</span></span>

## <a name="bitmaps"></a><span data-ttu-id="06f68-182">Images bitmap</span><span class="sxs-lookup"><span data-stu-id="06f68-182">Bitmaps</span></span>

<span data-ttu-id="06f68-183">Comme mentionné précédemment, la création et la suppression de ressources sont des opérations très onéreuses dans le matériel.</span><span class="sxs-lookup"><span data-stu-id="06f68-183">As mentioned earlier, resource creation and deletion are very expensive operations in hardware.</span></span> <span data-ttu-id="06f68-184">Une image bitmap est un type de ressource qui est souvent utilisé.</span><span class="sxs-lookup"><span data-stu-id="06f68-184">A bitmap is a kind of resource that is used often.</span></span> <span data-ttu-id="06f68-185">La création de bitmaps sur la carte vidéo est coûteuse.</span><span class="sxs-lookup"><span data-stu-id="06f68-185">Creating bitmaps on the video card is expensive.</span></span> <span data-ttu-id="06f68-186">Leur réutilisation peut aider à rendre l’application plus rapide.</span><span class="sxs-lookup"><span data-stu-id="06f68-186">Reusing them can help make the application faster.</span></span>

### <a name="create-large-bitmaps"></a><span data-ttu-id="06f68-187">Créer des bitmaps de grande taille</span><span class="sxs-lookup"><span data-stu-id="06f68-187">Create large bitmaps</span></span>

<span data-ttu-id="06f68-188">Les cartes vidéo ont généralement une taille d’allocation de mémoire minimale.</span><span class="sxs-lookup"><span data-stu-id="06f68-188">Video cards typically have a minimum memory allocation size.</span></span> <span data-ttu-id="06f68-189">Si une allocation demandée est inférieure à celle-ci, une ressource de cette taille minimale est allouée et l’excédent de mémoire est perdu et indisponible pour d’autres choses.</span><span class="sxs-lookup"><span data-stu-id="06f68-189">If an allocation is requested that is smaller than this, a resource of this minimum size is allocated and the surplus memory is wasted and unavailable for other things.</span></span> <span data-ttu-id="06f68-190">Si vous avez besoin de plusieurs bitmaps de petite taille, une meilleure technique consiste à allouer une grande bitmap et à stocker tout le contenu de la petite bitmap dans cette grande bitmap.</span><span class="sxs-lookup"><span data-stu-id="06f68-190">If you need many small bitmaps, a better technique is to allocate one large bitmap and store all the small bitmap contents in this large bitmap.</span></span> <span data-ttu-id="06f68-191">Les sous-zones de la plus grande bitmap peuvent être lues là où les plus petites bitmaps sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="06f68-191">Then subareas of the larger bitmap can be read where the smaller bitmaps are needed.</span></span> <span data-ttu-id="06f68-192">Souvent, vous devez inclure le remplissage (pixels noirs transparents) entre les petites bitmaps afin d’éviter toute interaction entre les petites images pendant les opérations.</span><span class="sxs-lookup"><span data-stu-id="06f68-192">Often, you should include padding (transparent black pixels) in between the small bitmaps to avoid any interaction between the smaller images during operations.</span></span> <span data-ttu-id="06f68-193">Il s’agit également d’un *Atlas*, et il présente l’avantage de réduire la surcharge liée à la création de bitmaps et les gaspillages de mémoire des petites allocations de bitmap.</span><span class="sxs-lookup"><span data-stu-id="06f68-193">This is also known as an *atlas*, and it has the benefit of reducing bitmap creation overhead and the memory waste of small bitmap allocations.</span></span> <span data-ttu-id="06f68-194">Nous vous recommandons de conserver la plupart des bitmaps à au moins 64 Ko et de limiter le nombre de bitmaps inférieurs à 4 Ko.</span><span class="sxs-lookup"><span data-stu-id="06f68-194">We recommend that you keep most bitmaps to at least 64 KB and limit the number of bitmaps that are smaller than 4 KB.</span></span>

### <a name="create-an-atlas-of-bitmaps"></a><span data-ttu-id="06f68-195">Créer un Atlas de bitmaps</span><span class="sxs-lookup"><span data-stu-id="06f68-195">Create an atlas of bitmaps</span></span>

<span data-ttu-id="06f68-196">Un Atlas des bitmaps peut être très bien utilisé dans certains scénarios courants.</span><span class="sxs-lookup"><span data-stu-id="06f68-196">There are some common scenarios for which a bitmap atlas can serve very well.</span></span> <span data-ttu-id="06f68-197">Les petites bitmaps peuvent être stockées dans une grande bitmap.</span><span class="sxs-lookup"><span data-stu-id="06f68-197">Small bitmaps can be stored inside a large bitmap.</span></span> <span data-ttu-id="06f68-198">Ces petites bitmaps peuvent être extraites de l’image bitmap la plus grande lorsque vous en avez besoin en spécifiant le rectangle de destination.</span><span class="sxs-lookup"><span data-stu-id="06f68-198">These small bitmaps can be pulled out of the larger bitmap when you need them by specifying the destination rectangle.</span></span> <span data-ttu-id="06f68-199">Par exemple, une application doit dessiner plusieurs icônes.</span><span class="sxs-lookup"><span data-stu-id="06f68-199">For example, an application has to draw multiple icons.</span></span> <span data-ttu-id="06f68-200">Toutes les bitmaps associées aux icônes peuvent être chargées en amont dans une grande bitmap.</span><span class="sxs-lookup"><span data-stu-id="06f68-200">All the bitmaps associated with the icons can be loaded into a large bitmap up front.</span></span> <span data-ttu-id="06f68-201">Et au moment du rendu, elles peuvent être récupérées à partir de la grande bitmap.</span><span class="sxs-lookup"><span data-stu-id="06f68-201">And at rendering time, they can be retrieved from the large bitmap.</span></span>

> [!Note]  
> <span data-ttu-id="06f68-202">Une bitmap Direct2D créée dans la mémoire vidéo est limitée à la taille maximale de bitmap prise en charge par l’adaptateur sur lequel elle est stockée.</span><span class="sxs-lookup"><span data-stu-id="06f68-202">A Direct2D bitmap created in video memory is limited to the maximum bitmap size supported by the adapter on which it is stored.</span></span> <span data-ttu-id="06f68-203">La création d’une bitmap plus grande peut entraîner une erreur.</span><span class="sxs-lookup"><span data-stu-id="06f68-203">Creating a bitmap larger than that might result in an error.</span></span>

 

> [!Note]  
> <span data-ttu-id="06f68-204">À partir de Windows 8, Direct2D comprend un [effet Atlas](atlas.md) qui peut faciliter ce processus.</span><span class="sxs-lookup"><span data-stu-id="06f68-204">Starting in Windows 8, Direct2D includes an [Atlas effect](atlas.md) that can make this process easier.</span></span>

 

### <a name="create-shared-bitmaps"></a><span data-ttu-id="06f68-205">Créer des bitmaps partagées</span><span class="sxs-lookup"><span data-stu-id="06f68-205">Create shared bitmaps</span></span>

<span data-ttu-id="06f68-206">La création de bitmaps partagées permet aux appelants avancés de créer des objets bitmap Direct2D qui sont sauvegardés directement par un objet existant, déjà compatible avec la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="06f68-206">Creating shared bitmaps enables advanced callers to create Direct2D bitmap objects that are backed directly by an existing object, already compatible with the render target.</span></span> <span data-ttu-id="06f68-207">Cela évite de créer plusieurs surfaces et contribue à réduire la surcharge des performances.</span><span class="sxs-lookup"><span data-stu-id="06f68-207">This avoids creating multiple surfaces and helps in reducing performance overhead.</span></span>

> [!Note]  
> <span data-ttu-id="06f68-208">Les bitmaps partagées sont généralement limitées aux cibles logicielles ou aux cibles interopérables avec DXGI.</span><span class="sxs-lookup"><span data-stu-id="06f68-208">Shared bitmaps are usually limited to software targets or to targets interoperable with DXGI.</span></span> <span data-ttu-id="06f68-209">Utilisez les méthodes [**CreateBitmapFromDxgiSurface**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1_id2d1bitmap1)), [**CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1))et [**CreateSharedBitmap**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) pour créer des bitmaps partagées.</span><span class="sxs-lookup"><span data-stu-id="06f68-209">Use the [**CreateBitmapFromDxgiSurface**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1_id2d1bitmap1)), [**CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), and [**CreateSharedBitmap**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) methods to create shared bitmaps.</span></span>

 

### <a name="copying-bitmaps"></a><span data-ttu-id="06f68-210">Copier des bitmaps</span><span class="sxs-lookup"><span data-stu-id="06f68-210">Copying bitmaps</span></span>

<span data-ttu-id="06f68-211">La création d’une surface DXGI est une opération coûteuse, donc réutilisez des surfaces existantes lorsque vous le pouvez.</span><span class="sxs-lookup"><span data-stu-id="06f68-211">Creating a DXGI surface is an expensive operation so reuse existing surfaces when you can.</span></span> <span data-ttu-id="06f68-212">Même dans les logiciels, si une bitmap est principalement sous la forme souhaitée, à l’exception d’une petite partie, il est préférable de mettre à jour cette partie plutôt que de lever l’intégralité de la bitmap et de recréer tout.</span><span class="sxs-lookup"><span data-stu-id="06f68-212">Even in software, if a bitmap is mostly in the form you want except for a small portion, it is better to update that portion than to throw the whole bitmap away and re-create everything.</span></span> <span data-ttu-id="06f68-213">Bien que vous puissiez utiliser [**CreateCompatibleRenderTarget**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) pour obtenir les mêmes résultats, le rendu est généralement une opération beaucoup plus coûteuse que la copie.</span><span class="sxs-lookup"><span data-stu-id="06f68-213">Although you can use [**CreateCompatibleRenderTarget**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) to achieve the same results, rendering is generally a much more expensive operation than copying.</span></span> <span data-ttu-id="06f68-214">Cela est dû au fait que, pour améliorer la localité de cache, le matériel ne stocke pas en fait une image bitmap dans le même ordre de mémoire que l’image bitmap.</span><span class="sxs-lookup"><span data-stu-id="06f68-214">This is because, to improve cache locality, the hardware doesn't actually store a bitmap in the same memory order that the bitmap is addressed.</span></span> <span data-ttu-id="06f68-215">Au lieu de cela, la bitmap peut être swizzled.</span><span class="sxs-lookup"><span data-stu-id="06f68-215">Instead, the bitmap might be swizzled.</span></span> <span data-ttu-id="06f68-216">Le swizzling est masqué du processeur par le pilote (ce qui est lent et utilisé uniquement sur des parties inférieures) ou par le gestionnaire de mémoire sur le GPU.</span><span class="sxs-lookup"><span data-stu-id="06f68-216">The swizzling is hidden from the CPU either by the driver (which is slow and used only on lower-end parts), or by the memory manager on the GPU.</span></span> <span data-ttu-id="06f68-217">En raison de contraintes sur la façon dont les données sont écrites dans une cible de rendu lors du rendu, les cibles de rendu ne sont généralement pas swizzled ou swizzled d’une manière moins optimale que possible si vous savez que vous n’avez jamais besoin d’effectuer un rendu sur la surface.</span><span class="sxs-lookup"><span data-stu-id="06f68-217">Because of constraints on how data is written into a render target when rendering, render targets are typically either not swizzled, or swizzled in a way that is less optimal than can be achieved if you know that you never have to render to the surface.</span></span> <span data-ttu-id="06f68-218">Par conséquent, les méthodes [CopyFrom](/windows/desktop/api/d2d1/nn-d2d1-id2d1bitmap) \* sont fournies pour copier des rectangles d’une source vers la bitmap Direct2D.</span><span class="sxs-lookup"><span data-stu-id="06f68-218">Therefore, the [CopyFrom](/windows/desktop/api/d2d1/nn-d2d1-id2d1bitmap)\* methods are provided for copying rectangles from a source to the Direct2D bitmap.</span></span>

<span data-ttu-id="06f68-219">CopyFrom peut être utilisé dans l’une des trois formes suivantes :</span><span class="sxs-lookup"><span data-stu-id="06f68-219">CopyFrom can be used in any of its three forms:</span></span>

-   [<span data-ttu-id="06f68-220">**CopyFromBitmap**</span><span class="sxs-lookup"><span data-stu-id="06f68-220">**CopyFromBitmap**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrombitmap)
-   [<span data-ttu-id="06f68-221">**CopyFromRenderTarget**</span><span class="sxs-lookup"><span data-stu-id="06f68-221">**CopyFromRenderTarget**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfromrendertarget)
-   [<span data-ttu-id="06f68-222">**CopyFromMemory**</span><span class="sxs-lookup"><span data-stu-id="06f68-222">**CopyFromMemory**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrommemory)

## <a name="use-tiled-bitmap-over-dashing"></a><span data-ttu-id="06f68-223">Utiliser une image bitmap en mosaïque sur des tirets</span><span class="sxs-lookup"><span data-stu-id="06f68-223">Use tiled bitmap over dashing</span></span>

<span data-ttu-id="06f68-224">Le rendu d’une ligne en pointillés est une opération très coûteuse en raison de la haute qualité et de la précision de l’algorithme sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="06f68-224">Rendering a dashed line is a very expensive operation because of the high quality and accuracy of the underlying algorithm.</span></span> <span data-ttu-id="06f68-225">Pour la plupart des cas qui n’impliquent pas de géométries rectilignes, le même effet peut être généré plus rapidement à l’aide de bitmaps en mosaïque.</span><span class="sxs-lookup"><span data-stu-id="06f68-225">For most of the cases not involving rectilinear geometries, the same effect can be generated faster by using tiled bitmaps.</span></span>

## <a name="general-guidelines-for-rendering-complex-static-content"></a><span data-ttu-id="06f68-226">Instructions générales pour le rendu de contenu statique complexe</span><span class="sxs-lookup"><span data-stu-id="06f68-226">General guidelines for rendering complex static content</span></span>

<span data-ttu-id="06f68-227">Mettez en cache le contenu si vous affichez le même frame de contenu sur le frame, en particulier lorsque la scène est complexe.</span><span class="sxs-lookup"><span data-stu-id="06f68-227">Cache content if you render the same content frame over frame, especially when the scene is complex.</span></span>

<span data-ttu-id="06f68-228">Vous pouvez utiliser trois techniques de mise en cache :</span><span class="sxs-lookup"><span data-stu-id="06f68-228">There are three caching techniques that you can use:</span></span>

-   <span data-ttu-id="06f68-229">Mise en cache de scène complète à l’aide d’une bitmap de couleur.</span><span class="sxs-lookup"><span data-stu-id="06f68-229">Full scene caching using a color bitmap.</span></span>
-   <span data-ttu-id="06f68-230">Par mise en cache primitive à l’aide d’une bitmap a8 et de la méthode [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-fillopacitymask(id2d1bitmap_id2d1brush_constd2d1_rect_f_constd2d1_rect_f)) .</span><span class="sxs-lookup"><span data-stu-id="06f68-230">Per primitive caching using an A8 bitmap and the [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-fillopacitymask(id2d1bitmap_id2d1brush_constd2d1_rect_f_constd2d1_rect_f)) method.</span></span>
-   <span data-ttu-id="06f68-231">Mise en cache par primitive utilisant des réalisations géométriques.</span><span class="sxs-lookup"><span data-stu-id="06f68-231">Per-primitive caching using geometry realizations.</span></span>

<span data-ttu-id="06f68-232">Examinons chacun de ces détails plus en détail.</span><span class="sxs-lookup"><span data-stu-id="06f68-232">Let's look at each of these in more detail.</span></span>

### <a name="full-scene-caching-using-a-color-bitmap"></a><span data-ttu-id="06f68-233">Mise en cache de scène complète à l’aide d’une bitmap de couleur</span><span class="sxs-lookup"><span data-stu-id="06f68-233">Full scene caching using a color bitmap</span></span>

<span data-ttu-id="06f68-234">Lorsque vous affichez un contenu statique, dans des scénarios tels que l’animation, créez un autre bitmap de couleur complète au lieu d’écrire directement sur la bitmap d’écran.</span><span class="sxs-lookup"><span data-stu-id="06f68-234">When you render static content, in scenarios like animation, create another full color bitmap instead of writing directly to the screen bitmap.</span></span> <span data-ttu-id="06f68-235">Enregistrez la cible actuelle, définissez la cible sur la bitmap intermédiaire et restituez le contenu statique.</span><span class="sxs-lookup"><span data-stu-id="06f68-235">Save the current target, set target to the intermediate bitmap, and render the static content.</span></span> <span data-ttu-id="06f68-236">Ensuite, revenez à la bitmap d’écran d’origine et dessinez la bitmap intermédiaire dessus.</span><span class="sxs-lookup"><span data-stu-id="06f68-236">Then, switch back to the original screen bitmap and draw the intermediate bitmap on it.</span></span>

<span data-ttu-id="06f68-237">Voici un exemple :</span><span class="sxs-lookup"><span data-stu-id="06f68-237">Here's an example:</span></span>


```C++
// Create a bitmap.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_B8G8R8A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &sceneBitmap);

// Preserve the pre-existing target.
ComPtr<ID2D1Image> oldTarget;
m_d2dContext->GetTarget(&oldTarget);

// Render static content to the sceneBitmap.
m_d2dContext->SetTarget(sceneBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Render sceneBitmap to oldTarget.
m_d2dContext->SetTarget(oldTarget.Get());
m_d2dContext->DrawBitmap(sceneBitmap.Get());
```



<span data-ttu-id="06f68-238">Cet exemple utilise des bitmaps intermédiaires pour la mise en cache et change la bitmap vers laquelle le contexte de périphérique pointe lors du rendu.</span><span class="sxs-lookup"><span data-stu-id="06f68-238">This example uses intermediate bitmaps for caching and switches the bitmap that the device context points to when it renders.</span></span> <span data-ttu-id="06f68-239">Cela évite d’avoir à créer une cible de rendu compatible dans le même but.</span><span class="sxs-lookup"><span data-stu-id="06f68-239">This avoids the need to create a compatible render target for the same purpose.</span></span>

### <a name="per-primitive-caching-using-an-a8-bitmap-and-the-fillopacitymask-method"></a><span data-ttu-id="06f68-240">Par mise en cache primitive à l’aide d’une bitmap a8 et de la méthode FillOpacityMask</span><span class="sxs-lookup"><span data-stu-id="06f68-240">Per primitive caching using an A8 bitmap and the FillOpacityMask method</span></span>

<span data-ttu-id="06f68-241">Lorsque la scène complète n’est pas statique, mais se compose d’éléments tels que geometry ou Text qui sont statiques, vous pouvez utiliser une technique de mise en cache primitive.</span><span class="sxs-lookup"><span data-stu-id="06f68-241">When the full scene is not static, but consists of elements like geometry or text that are static, you can use a per primitive caching technique.</span></span> <span data-ttu-id="06f68-242">Cette technique conserve les caractéristiques d’anticrénelage de la primitive mise en cache et fonctionne avec les types de pinceau modifiés.</span><span class="sxs-lookup"><span data-stu-id="06f68-242">This technique preserves the antialiasing characteristics of the primitive being cached and works with changing brush types.</span></span> <span data-ttu-id="06f68-243">Elle utilise une image bitmap A8, où a8 est un type de format de pixel qui représente un canal alpha avec 8 bits.</span><span class="sxs-lookup"><span data-stu-id="06f68-243">It uses an A8 bitmap where A8 is a kind of pixel format which represents an alpha channel with 8 bits.</span></span> <span data-ttu-id="06f68-244">Les bitmaps a8 sont utiles pour dessiner une géométrie/un texte en tant que masque.</span><span class="sxs-lookup"><span data-stu-id="06f68-244">A8 bitmaps are useful for drawing geometry/text as a mask.</span></span> <span data-ttu-id="06f68-245">Lorsque vous devez manipuler l’opacité d’un contenu statique, au lieu de manipuler le contenu lui-même, vous pouvez translater, faire pivoter, incliner ou mettre à l’échelle l’opacité du masque.</span><span class="sxs-lookup"><span data-stu-id="06f68-245">When you must manipulate the opacity of static content , instead of manipulating the content itself, you can translate, rotate, skew, or scale the opacity of the mask.</span></span>

<span data-ttu-id="06f68-246">Voici un exemple :</span><span class="sxs-lookup"><span data-stu-id="06f68-246">Here's an example:</span></span>


```C++
// Create an opacity bitmap.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &opacityBitmap);

// Preserve the pre-existing target.
ComPtr<ID2D1Image> oldTarget;
m_d2dContext->GetTarget(&oldTarget);

// Render to the opacityBitmap.
m_d2dContext->SetTarget(opacityBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Call the FillOpacityMask method
// Note: for this call to work correctly the anti alias mode must be D2D1_ANTIALIAS_MODE_ALIASED. 
m_d2dContext->SetTarget(oldTarget.Get());
m_d2dContext->FillOpacityMask(
    opacityBitmap.Get(),
    m_contentBrush().Get(),
    D2D1_OPACITY_MASK_CONTENT_GRAPHICS);
```



## <a name="per-primitive-caching-using-geometry-realizations"></a><span data-ttu-id="06f68-247">Mise en cache par primitive utilisant des réalisations géométriques</span><span class="sxs-lookup"><span data-stu-id="06f68-247">Per-primitive caching using geometry realizations</span></span>

<span data-ttu-id="06f68-248">Une autre technique de mise en cache par primitive, appelée réalisation géométrique, offre une plus grande souplesse lors du traitement de Geometry.</span><span class="sxs-lookup"><span data-stu-id="06f68-248">Another per-primitive caching technique, called geometry realizations, provides greater flexibility when dealing with geometry.</span></span> <span data-ttu-id="06f68-249">Lorsque vous souhaitez dessiner de manière répétée des géométries avec ou sans alias, il est plus rapide de les convertir en réalisations géométriques et de dessiner de manière répétée les mesures de réalisation qu’il ne faut dessiner à plusieurs reprises.</span><span class="sxs-lookup"><span data-stu-id="06f68-249">When you want to repeatedly draw aliased or anti-aliased geometries, it is faster to convert them to geometry realizations and repeatedly draw the realizations than it is to repeatedly draw the geometries themselves.</span></span> <span data-ttu-id="06f68-250">Les proportions de géométrie consomment généralement moins de mémoire que les masques d’opacité (surtout pour les géométries volumineuses), et elles sont moins sensibles aux modifications de l’échelle.</span><span class="sxs-lookup"><span data-stu-id="06f68-250">Geometry realizations also generally consume less memory than opacity masks (especially for large geometries), and they are less sensitive to changes in scale.</span></span> <span data-ttu-id="06f68-251">Pour plus d’informations, consultez [vue d’ensemble des réalisations géométriques](geometry-realizations-overview.md).</span><span class="sxs-lookup"><span data-stu-id="06f68-251">For more information, see [Geometry Realizations Overview](geometry-realizations-overview.md).</span></span>

<span data-ttu-id="06f68-252">Voici un exemple :</span><span class="sxs-lookup"><span data-stu-id="06f68-252">Here's an example:</span></span>


```C++
    // Compute a flattening tolerance based on the scales at which the realization will be used.
    float flatteningTolerance = D2D1::ComputeFlatteningTolerance(...);

    ComPtr<ID2D1GeometryRealization> geometryRealization;

    // Create realization of the filled interior of the geometry.
    m_d2dDeviceContext1->CreateFilledGeometryRealization(
        geometry.Get(),
        flatteningTolerance,
        &geometryRealization
        );

    // In your app's rendering code, draw the geometry realization with a brush.
    m_d2dDeviceContext1->BeginDraw();
    m_d2dDeviceContext1->DrawGeometryRealization(
        geometryRealization.Get(),
        m_brush.Get()
        );
    m_d2dDeviceContext1->EndDraw();
```



## <a name="geometry-rendering"></a><span data-ttu-id="06f68-253">Rendu de géométrie</span><span class="sxs-lookup"><span data-stu-id="06f68-253">Geometry rendering</span></span>

### <a name="use-specific-draw-primitive-over-draw-geometry"></a><span data-ttu-id="06f68-254">Utiliser une primitive de dessin spécifique sur la géométrie de dessin</span><span class="sxs-lookup"><span data-stu-id="06f68-254">Use specific draw primitive over draw geometry</span></span>

<span data-ttu-id="06f68-255">Utilisez des appels de dessin *primitif* plus spécifiques comme [**DrawRectangle**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f__id2d1brush_float_id2d1strokestyle)) sur les appels [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry) génériques.</span><span class="sxs-lookup"><span data-stu-id="06f68-255">Use more specific draw *primitive* calls like [**DrawRectangle**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f__id2d1brush_float_id2d1strokestyle)) over generic [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry) calls.</span></span> <span data-ttu-id="06f68-256">En effet, avec **DrawRectangle**, la géométrie est déjà connue afin que le rendu soit plus rapide.</span><span class="sxs-lookup"><span data-stu-id="06f68-256">This is because with **DrawRectangle**, the geometry is already known so rendering is faster.</span></span>

### <a name="rendering-static-geometry"></a><span data-ttu-id="06f68-257">Rendu de Geometry statique</span><span class="sxs-lookup"><span data-stu-id="06f68-257">Rendering static geometry</span></span>

<span data-ttu-id="06f68-258">Dans les scénarios où la géométrie est statique, utilisez les techniques de mise en cache par primitive expliquées ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="06f68-258">In scenarios where the geometry is static, use the per-primitive caching techniques explained above.</span></span> <span data-ttu-id="06f68-259">Les masques d’opacité et les réalisations géométriques peuvent améliorer la vitesse de rendu des scènes qui contiennent une géométrie statique.</span><span class="sxs-lookup"><span data-stu-id="06f68-259">Opacity masks and geometry realizations can greatly improve the rendering speed of scenes that contain static geometry..</span></span>

### <a name="use-a-multithreaded-device-context"></a><span data-ttu-id="06f68-260">Utiliser un contexte de périphérique multithread</span><span class="sxs-lookup"><span data-stu-id="06f68-260">Use a multithreaded device context</span></span>

<span data-ttu-id="06f68-261">Les applications qui s’attendent à afficher des quantités significatives de contenu géométrique complexe doivent envisager de spécifier les [**options de contexte de périphérique d2d1 activer l’indicateur d' \_ \_ \_ \_ \_ \_ \_ optimisations**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_device_context_options) multithread lors de la création d’un contexte de périphérique [Direct2D](./direct2d-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="06f68-261">Applications that expect to render significant amounts of complex geometric content should consider specifying the [**D2D1\_DEVICE\_CONTEXT\_OPTIONS\_ENABLE\_MULTI\_THREADED\_OPTIMIZATIONS**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_device_context_options) flag when creating a [Direct2D](./direct2d-portal.md) device context.</span></span> <span data-ttu-id="06f68-262">Lorsque cet indicateur est spécifié, Direct2D répartit le rendu sur tous les cœurs logiques présents sur le système, ce qui peut réduire considérablement le temps de rendu global.</span><span class="sxs-lookup"><span data-stu-id="06f68-262">When this flag is specified, Direct2D will distribute rendering across all of the logical cores present on the system, which can significantly decrease overall rendering time.</span></span>

<span data-ttu-id="06f68-263">Remarques :</span><span class="sxs-lookup"><span data-stu-id="06f68-263">Notes:</span></span>

-   <span data-ttu-id="06f68-264">À partir de Windows 8.1, cet indicateur affecte uniquement le rendu de la géométrie du chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="06f68-264">As of Windows 8.1, this flag only affects path geometry rendering.</span></span> <span data-ttu-id="06f68-265">Elle n’a aucun impact sur les scènes contenant uniquement d’autres types primitifs (tels que du texte, des bitmaps ou des réalisations géométriques).</span><span class="sxs-lookup"><span data-stu-id="06f68-265">It has no impact on scenes containing only other primitive types (such as text, bitmaps, or geometry realizations).</span></span>
-   <span data-ttu-id="06f68-266">En outre, cet indicateur n’a aucun impact lors du rendu dans le logiciel (par exemple, lors du rendu avec un périphérique Direct3D WARP).</span><span class="sxs-lookup"><span data-stu-id="06f68-266">This flag also has no impact when rendering in software (i.e. when rendering with a WARP Direct3D device).</span></span> <span data-ttu-id="06f68-267">Pour contrôler le multithreading logiciel, les appelants doivent utiliser \_ l' \_ indicateur d3d11 créer \_ un appareil empêcher l' \_ \_ optimisation du Threading interne \_ lors de la création de l’appareil de distorsion Direct3D.</span><span class="sxs-lookup"><span data-stu-id="06f68-267">To control software multithreading, callers should use the D3D11\_CREATE\_DEVICE\_PREVENT\_INTERNAL\_THREADING\_OPTIMIZATIONS flag when creating the WARP Direct3D device.</span></span>
-   <span data-ttu-id="06f68-268">La spécification de cet indicateur peut augmenter le pic du jeu de travail pendant le rendu et peut également augmenter la contention des threads dans les applications qui tirent déjà parti du traitement multithread.</span><span class="sxs-lookup"><span data-stu-id="06f68-268">Specifying this flag can increase peak working set during rendering and can also increase thread contention in applications that already take advantage of multithreaded processing.</span></span>

## <a name="drawing-text-with-direct2d"></a><span data-ttu-id="06f68-269">Dessiner du texte avec Direct2D</span><span class="sxs-lookup"><span data-stu-id="06f68-269">Drawing text with Direct2D</span></span>

<span data-ttu-id="06f68-270">La fonctionnalité de rendu de texte Direct2D est proposée en deux parties.</span><span class="sxs-lookup"><span data-stu-id="06f68-270">Direct2D text rendering functionality is offered in two parts.</span></span> <span data-ttu-id="06f68-271">La première partie, exposée comme la méthode [**ID2D1RenderTarget ::D rawtext**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) et [**ID2D1RenderTarget ::D rawtextlayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) , permet à un appelant de passer une chaîne et des paramètres de mise en forme ou un objet de disposition de texte DWrite pour plusieurs formats.</span><span class="sxs-lookup"><span data-stu-id="06f68-271">The first part, exposed as the [**ID2D1RenderTarget::DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) and [**ID2D1RenderTarget::DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) method, enables a caller to pass either a string and formatting parameters or a DWrite text layout object for multiple formats.</span></span> <span data-ttu-id="06f68-272">Cela doit être adapté à la plupart des appelants.</span><span class="sxs-lookup"><span data-stu-id="06f68-272">This should be suitable for most callers.</span></span> <span data-ttu-id="06f68-273">La deuxième façon de restituer du texte, exposé comme la méthode [**ID2D1RenderTarget ::D rawglyphrun**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawglyphrun) , fournit la pixellisation pour les clients qui connaissent déjà la position des glyphes qu’ils souhaitent afficher.</span><span class="sxs-lookup"><span data-stu-id="06f68-273">The second way to render text, exposed as the [**ID2D1RenderTarget::DrawGlyphRun**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawglyphrun) method, provides rasterization for customers who already know the position of the glyphs they want to render.</span></span> <span data-ttu-id="06f68-274">Les deux règles générales suivantes peuvent aider à améliorer les performances du texte lors du dessin dans Direct2D.</span><span class="sxs-lookup"><span data-stu-id="06f68-274">The following two general rules can help improve text performance when drawing in Direct2D.</span></span>

### <a name="drawtextlayout-vs-drawtext"></a><span data-ttu-id="06f68-275">DrawTextLayout et DrawText</span><span class="sxs-lookup"><span data-stu-id="06f68-275">DrawTextLayout Vs. DrawText</span></span>

<span data-ttu-id="06f68-276">[**DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) et [**DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) permettent à une application de restituer facilement du texte mis en forme par l’API [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) .</span><span class="sxs-lookup"><span data-stu-id="06f68-276">Both [**DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) and [**DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) enable an application to easily render text that is formatted by the [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) API.</span></span> <span data-ttu-id="06f68-277">**DrawTextLayout** dessine un objet [**DWriteTextLayout**](/windows/desktop/api/dwrite/nn-dwrite-idwritetextlayout) existant dans le [**renderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget), et **DrawText** construit une disposition DirectWrite pour l’appelant, en fonction des paramètres transmis.</span><span class="sxs-lookup"><span data-stu-id="06f68-277">**DrawTextLayout** draws an existing [**DWriteTextLayout**](/windows/desktop/api/dwrite/nn-dwrite-idwritetextlayout) object to the [**RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget), and **DrawText** constructs a DirectWrite layout for the caller, based on the parameters that are passed in.</span></span> <span data-ttu-id="06f68-278">Si le même texte doit être restitué plusieurs fois, utilisez **DrawTextLayout** au lieu de **DrawText**, car **DrawText** crée une disposition chaque fois qu’il est appelé.</span><span class="sxs-lookup"><span data-stu-id="06f68-278">If the same text has to be rendered multiple times, use **DrawTextLayout** instead of **DrawText**, because **DrawText** creates a layout every time that it is called.</span></span>

### <a name="choosing-the-right-text-rendering-mode"></a><span data-ttu-id="06f68-279">Choix du mode de rendu de texte approprié</span><span class="sxs-lookup"><span data-stu-id="06f68-279">Choosing the right text rendering mode</span></span>

<span data-ttu-id="06f68-280">Définissez le mode antialias du texte [**sur \_ d2d1 \_ mode antialias du texte \_ en \_ nuances de gris**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) explicitement.</span><span class="sxs-lookup"><span data-stu-id="06f68-280">Set the text antialias mode to [**D2D1\_TEXT\_ANTIALIAS\_MODE\_GRAYSCALE**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) explicitly.</span></span> <span data-ttu-id="06f68-281">La qualité du rendu du texte en nuances de gris est comparable à ClearType mais est beaucoup plus rapide.</span><span class="sxs-lookup"><span data-stu-id="06f68-281">The quality of rendering grayscale text is comparable to ClearType but is much faster.</span></span>

### <a name="caching"></a><span data-ttu-id="06f68-282">Mise en cache</span><span class="sxs-lookup"><span data-stu-id="06f68-282">Caching</span></span>

<span data-ttu-id="06f68-283">Utilisez une scène complète ou par mise en cache de bitmaps primitive comme pour le dessin d’autres Primitives.</span><span class="sxs-lookup"><span data-stu-id="06f68-283">Use full scene or per primitive bitmap caching like with drawing other primitives.</span></span>

## <a name="clipping-an-arbitrary-shape"></a><span data-ttu-id="06f68-284">Découpage d’une forme arbitraire</span><span class="sxs-lookup"><span data-stu-id="06f68-284">Clipping an arbitrary shape</span></span>

<span data-ttu-id="06f68-285">La figure ci-dessous illustre le résultat de l’application d’un clip à une image.</span><span class="sxs-lookup"><span data-stu-id="06f68-285">The figure here shows the result of applying a clip to an image.</span></span>

![image qui montre un exemple d’image avant et après un clip.](images/clip.png)

<span data-ttu-id="06f68-287">Vous pouvez obtenir ce résultat en utilisant des couches avec un masque Geometry ou la méthode [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) avec un pinceau d’opacité.</span><span class="sxs-lookup"><span data-stu-id="06f68-287">You can get this result by using layers with a geometry mask or the [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) method with an opacity brush.</span></span>

<span data-ttu-id="06f68-288">Voici un exemple qui utilise une couche :</span><span class="sxs-lookup"><span data-stu-id="06f68-288">Here's an example that uses a layer:</span></span>


```C++
// Call PushLayer() and pass in the clipping geometry.
m_d2dContext->PushLayer(
    D2D1::LayerParameters(
        boundsRect,
        geometricMask));
```



<span data-ttu-id="06f68-289">Voici un exemple qui utilise la méthode [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) :</span><span class="sxs-lookup"><span data-stu-id="06f68-289">Here's an example that uses the [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) method:</span></span>


```C++
// Create an opacity bitmap and render content.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &opacityBitmap);

m_d2dContext->SetTarget(opacityBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Create an opacity brush from the opacity bitmap.
m_d2dContext->CreateBitmapBrush(opacityBitmap.Get(),
    D2D1::BitmapBrushProperties(),
    D2D1::BrushProperties(),
    &bitmapBrush);

// Call the FillGeometry method and pass in the clip geometry and the opacity brush
m_d2dContext->FillGeometry( 
    clipGeometry.Get(),
    brush.Get(),
    opacityBrush.Get()); 
```



<span data-ttu-id="06f68-290">Dans cet exemple de code, lorsque vous appelez la méthode PushLayer, vous ne transmettez pas de couche créée par une application.</span><span class="sxs-lookup"><span data-stu-id="06f68-290">In this code example, when you call the PushLayer method, you don't pass in an app created layer.</span></span> <span data-ttu-id="06f68-291">Direct2D crée une couche pour vous.</span><span class="sxs-lookup"><span data-stu-id="06f68-291">Direct2D creates a layer for you.</span></span> <span data-ttu-id="06f68-292">Direct2D est en mesure de gérer l’allocation et la destruction de cette ressource sans aucune implication de l’application.</span><span class="sxs-lookup"><span data-stu-id="06f68-292">Direct2D is able to manage the allocation and destruction of this resource without any involvement from the app.</span></span> <span data-ttu-id="06f68-293">Cela permet à Direct2D de réutiliser des couches en interne et d’appliquer des optimisations de gestion des ressources.</span><span class="sxs-lookup"><span data-stu-id="06f68-293">This allows Direct2D to reuse layers internally and apply resource management optimizations.</span></span>

<span data-ttu-id="06f68-294">Dans Windows 8, de nombreuses optimisations ont été apportées à l’utilisation des couches et nous vous recommandons d’essayer d’utiliser les API de couche au lieu de [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) chaque fois que cela est possible.</span><span class="sxs-lookup"><span data-stu-id="06f68-294">In Windows 8 many optimizations have been made to the usage of layers and we recommend you try using layer APIs instead of [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) whenever possible.</span></span>

### <a name="pushlayer-in-windows-8"></a><span data-ttu-id="06f68-295">PushLayer dans Windows 8</span><span class="sxs-lookup"><span data-stu-id="06f68-295">PushLayer in Windows 8</span></span>

<span data-ttu-id="06f68-296">L’interface [**ID2D1DeviceContext**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) est dérivée de l’interface [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) et est la clé de l’affichage du contenu Direct2D dans Windows 8. pour plus d’informations sur cette interface, consultez [contextes de périphériques et](devices-and-device-contexts.md)de périphériques.</span><span class="sxs-lookup"><span data-stu-id="06f68-296">The [**ID2D1DeviceContext**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) interface is derived from the [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) interface and is key to displaying Direct2D content in Windows 8, for more information about this interface see [Devices and Device Contexts](devices-and-device-contexts.md).</span></span> <span data-ttu-id="06f68-297">Avec l’interface de contexte de périphérique, vous pouvez ignorer l’appel de la méthode [**CreateLayer**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createlayer(id2d1layer)) , puis passer la valeur null à la méthode [**ID2D1DeviceContext ::P ushlayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-pushlayer(constd2d1_layer_parameters1_id2d1layer)) .</span><span class="sxs-lookup"><span data-stu-id="06f68-297">With the device context interface, you can skip calling the [**CreateLayer**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createlayer(id2d1layer)) method and then pass NULL to the [**ID2D1DeviceContext::PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-pushlayer(constd2d1_layer_parameters1_id2d1layer)) method.</span></span> <span data-ttu-id="06f68-298">Direct2D gère automatiquement la ressource de couche et peut partager des ressources entre les couches et les graphiques d’effet.</span><span class="sxs-lookup"><span data-stu-id="06f68-298">Direct2D automatically manages the layer resource and can share resources between layers and effect graphs.</span></span>

### <a name="axis-aligned-clips"></a><span data-ttu-id="06f68-299">Clips alignés sur l’axe</span><span class="sxs-lookup"><span data-stu-id="06f68-299">Axis-aligned clips</span></span>

<span data-ttu-id="06f68-300">Si la région à découper est alignée sur l’axe de la surface de dessin, plutôt que arbitraire.</span><span class="sxs-lookup"><span data-stu-id="06f68-300">If the region to be clipped is aligned to the axis of the drawing surface, instead of arbitrary.</span></span> <span data-ttu-id="06f68-301">Ce cas est adapté à l’utilisation d’un rectangle de découpage au lieu d’une couche.</span><span class="sxs-lookup"><span data-stu-id="06f68-301">This case is suited for using a clip rectangle instead of a layer.</span></span> <span data-ttu-id="06f68-302">Le gain de performance est plus pour la géométrie avec alias que la géométrie avec anticrénelage.</span><span class="sxs-lookup"><span data-stu-id="06f68-302">The performance gain is more for aliased geometry than antialiased geometry.</span></span> <span data-ttu-id="06f68-303">Pour plus d’informations sur les clips alignés sur l’axe, consultez la rubrique [**PushAxisAlignedClip**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f__d2d1_antialias_mode)) .</span><span class="sxs-lookup"><span data-stu-id="06f68-303">For more info on axis aligned clips, see the [**PushAxisAlignedClip**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f__d2d1_antialias_mode)) topic.</span></span>

## <a name="dxgi-interoperability-avoid-frequent-switches"></a><span data-ttu-id="06f68-304">Interopérabilité des DXGI : Évitez les commutateurs fréquents</span><span class="sxs-lookup"><span data-stu-id="06f68-304">DXGI interoperability: avoid frequent switches</span></span>

<span data-ttu-id="06f68-305">Direct2D peut interagir de façon transparente avec les surfaces Direct3D.</span><span class="sxs-lookup"><span data-stu-id="06f68-305">Direct2D can interoperate seamlessly with Direct3D surfaces.</span></span> <span data-ttu-id="06f68-306">Cela est très utile pour créer des applications qui restituent un mélange de contenu 2D et 3D.</span><span class="sxs-lookup"><span data-stu-id="06f68-306">This is very useful for creating applications that render a mixture of 2D and 3D content.</span></span> <span data-ttu-id="06f68-307">Mais chaque basculement entre le dessin du contenu Direct2D et Direct3D affecte les performances.</span><span class="sxs-lookup"><span data-stu-id="06f68-307">But each switch between drawing Direct2D and Direct3D content affects performance.</span></span>

<span data-ttu-id="06f68-308">Lors du rendu sur une surface DXGI, Direct2D enregistre l’état des périphériques Direct3D lors du rendu et de sa restauration lorsque le rendu est terminé.</span><span class="sxs-lookup"><span data-stu-id="06f68-308">When rendering to a DXGI surface, Direct2D saves the state of the Direct3D devices while rendering and restores it when rendering is completed.</span></span> <span data-ttu-id="06f68-309">À chaque fois qu’un lot de rendu Direct2D est terminé, le coût de l’enregistrement et de la restauration et le coût du vidage de toutes les opérations 2D sont payants, et pourtant, le périphérique Direct3D n’est pas vidé.</span><span class="sxs-lookup"><span data-stu-id="06f68-309">Every time that a batch of Direct2D rendering is completed, the cost of this save and restore and the cost of flushing all the 2D operations are paid, and yet, the Direct3D device is not flushed.</span></span> <span data-ttu-id="06f68-310">Par conséquent, pour améliorer les performances, limitez le nombre de commutateurs de rendu entre Direct2D et Direct3D.</span><span class="sxs-lookup"><span data-stu-id="06f68-310">Therefore, to increase performance, limit the number of rendering switches between Direct2D and Direct3D.</span></span>

## <a name="know-your-pixel-format"></a><span data-ttu-id="06f68-311">Connaître le format de pixel</span><span class="sxs-lookup"><span data-stu-id="06f68-311">Know Your Pixel Format</span></span>

<span data-ttu-id="06f68-312">Quand vous créez une cible de rendu, vous pouvez utiliser la structure de [**\_ \_ format de pixel d2d1**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) spécifiez le format de pixel et le mode Alpha utilisés par la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="06f68-312">When you create a render target, you can use the [**D2D1\_PIXEL\_FORMAT**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) structure specify the pixel format and alpha mode used by the render target.</span></span> <span data-ttu-id="06f68-313">Un canal alpha fait partie du format de pixel qui spécifie la valeur de couverture ou les informations d’opacité.</span><span class="sxs-lookup"><span data-stu-id="06f68-313">An alpha channel is part of the pixel format that specifies the coverage value or opacity information.</span></span> <span data-ttu-id="06f68-314">Si une cible de rendu n’utilise pas le canal alpha, elle doit être créée à l’aide du mode Alpha [**d2d1 \_ \_ \_ Ignorer**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) le mode Alpha.</span><span class="sxs-lookup"><span data-stu-id="06f68-314">If a render target does not use the alpha channel, it should be created by using the [**D2D1\_ALPHA\_MODE\_IGNORE**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) alpha mode.</span></span> <span data-ttu-id="06f68-315">Cela réserve le temps consacré au rendu d’un canal alpha qui n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="06f68-315">This spares the time that is spent on rendering an alpha channel that is not needed.</span></span>

<span data-ttu-id="06f68-316">Pour plus d’informations sur les formats de pixel et les modes alpha, consultez [formats de pixel pris en charge et modes alpha](supported-pixel-formats-and-alpha-modes.md).</span><span class="sxs-lookup"><span data-stu-id="06f68-316">For more information about pixel formats and alpha modes, see [Supported Pixel Formats and Alpha Modes](supported-pixel-formats-and-alpha-modes.md).</span></span>

## <a name="scene-complexity"></a><span data-ttu-id="06f68-317">Complexité de la scène</span><span class="sxs-lookup"><span data-stu-id="06f68-317">Scene Complexity</span></span>

<span data-ttu-id="06f68-318">Lorsque vous analysez les zones réactives de performances dans une scène qui sera affichée, le fait de savoir si la scène est liée au taux de remplissage ou lié au sommet peut fournir des informations utiles.</span><span class="sxs-lookup"><span data-stu-id="06f68-318">When you analyze performance hot spots in a scene that will be rendered, knowing whether the scene is fill-rate bound or vertex bound can provide useful information.</span></span>

-   <span data-ttu-id="06f68-319">Taux de remplissage : le taux de remplissage fait référence au nombre de pixels qu’une carte graphique peut afficher et à écrire dans la mémoire vidéo par seconde.</span><span class="sxs-lookup"><span data-stu-id="06f68-319">Fill Rate: Fill rate refers to the number of pixels that a graphics card can render and write to video memory per second.</span></span>
-   <span data-ttu-id="06f68-320">Limite de sommet : une scène est liée à un sommet lorsqu’elle contient un grand nombre de géométries complexes.</span><span class="sxs-lookup"><span data-stu-id="06f68-320">Vertex Bound: A scene is vertex bound when it contains lots of complex geometry.</span></span>

### <a name="understand-scene-complexity"></a><span data-ttu-id="06f68-321">Comprendre la complexité des scènes</span><span class="sxs-lookup"><span data-stu-id="06f68-321">Understand Scene Complexity</span></span>

<span data-ttu-id="06f68-322">Vous pouvez analyser la complexité de votre scène en modifiant la taille de la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="06f68-322">You can analyze your scene complexity by altering the size of the render target.</span></span> <span data-ttu-id="06f68-323">Si les gains de performances sont visibles pour une réduction proportionnelle de la taille de la cible de rendu, l’application est liée au taux de remplissage.</span><span class="sxs-lookup"><span data-stu-id="06f68-323">If performance gains are visible for a proportional reduction in size of the render target, then the application is fill-rate bound.</span></span> <span data-ttu-id="06f68-324">Dans le cas contraire, la complexité de la scène est le goulot d’étranglement des performances.</span><span class="sxs-lookup"><span data-stu-id="06f68-324">Otherwise, the scene complexity is the performance bottleneck.</span></span>

<span data-ttu-id="06f68-325">Quand une scène est liée au taux de remplissage, la réduction de la taille de la cible de rendu peut améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="06f68-325">When a scene is fill-rate bound, reducing the size of the render target can improve the performance.</span></span> <span data-ttu-id="06f68-326">Cela est dû au fait que le nombre de pixels à rendre est réduit proportionnellement à la taille de la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="06f68-326">This is because the number of pixels to be rendered will be reduced proportionally with the size of the render target.</span></span>

<span data-ttu-id="06f68-327">Lorsqu’une scène est liée à un sommet, réduisez la complexité de la géométrie.</span><span class="sxs-lookup"><span data-stu-id="06f68-327">When a scene is vertex bound, reduce the complexity of the geometry.</span></span> <span data-ttu-id="06f68-328">Mais souvenez-vous que cette opération est effectuée au détriment de la qualité de l’image.</span><span class="sxs-lookup"><span data-stu-id="06f68-328">But remember that this is done at the expense of image quality.</span></span> <span data-ttu-id="06f68-329">Par conséquent, une décision prudente doit être prise entre la qualité souhaitée et les performances requises.</span><span class="sxs-lookup"><span data-stu-id="06f68-329">Therefore, a careful tradeoff decision should be made between the desired quality and the performance that is required.</span></span>

## <a name="improving-performance-for-direct2d-printing-apps"></a><span data-ttu-id="06f68-330">Amélioration des performances pour les applications d’impression Direct2D</span><span class="sxs-lookup"><span data-stu-id="06f68-330">Improving performance for Direct2D printing apps</span></span>

<span data-ttu-id="06f68-331">[Direct2D](./direct2d-portal.md) offre une compatibilité avec l’impression.</span><span class="sxs-lookup"><span data-stu-id="06f68-331">[Direct2D](./direct2d-portal.md) offers compatibility with printing.</span></span> <span data-ttu-id="06f68-332">Vous pouvez envoyer les mêmes commandes de dessin Direct2D (sous la forme de listes de commandes Direct2D) au contrôle d’impression Direct2D pour l’impression, si vous ne savez pas quels appareils vous dessinez, ou comment le dessin est converti en impression.</span><span class="sxs-lookup"><span data-stu-id="06f68-332">You can send the same Direct2D drawing commands (in the form of Direct2D command lists) to the Direct2D print control for printing, if you don't know what devices you are drawing to, or how the drawing is translated to printing.</span></span>

<span data-ttu-id="06f68-333">Vous pouvez affiner l’utilisation du contrôle d’impression [Direct2D](./direct2d-portal.md) et de vos commandes de dessin Direct2D pour fournir des résultats d’impression avec de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="06f68-333">You can further fine-tune their usage of the [Direct2D](./direct2d-portal.md) print control and your Direct2D drawing commands to deliver printing results with better performance.</span></span>

<span data-ttu-id="06f68-334">Le contrôle d’impression [Direct2D](./direct2d-portal.md) génère des messages de débogage lorsqu’il voit un modèle de code Direct2D qui produit une qualité ou des performances d’impression plus faible (par exemple, des modèles de code listés plus loin dans cette rubrique) pour vous rappeler où vous pouvez éviter les problèmes de performances.</span><span class="sxs-lookup"><span data-stu-id="06f68-334">The [Direct2D](./direct2d-portal.md) print control outputs debug messages when it sees a Direct2D code pattern that leads to lower printing quality or performance (like, code patterns listed later in this topic) to remind you where you can avoid performance problems.</span></span> <span data-ttu-id="06f68-335">Pour afficher ces messages de débogage, vous devez activer la [couche de débogage Direct2D](direct2ddebuglayer-portal.md) dans votre code.</span><span class="sxs-lookup"><span data-stu-id="06f68-335">To see those debug messages, you need to enable [Direct2D Debug Layer](direct2ddebuglayer-portal.md) in your code.</span></span> <span data-ttu-id="06f68-336">Pour obtenir des instructions sur l’activation de la sortie de message de débogage, consultez [messages de débogage](direct2ddebuglayer-debugmessages.md) .</span><span class="sxs-lookup"><span data-stu-id="06f68-336">See [Debug Messages](direct2ddebuglayer-debugmessages.md) for instructions to enable debug message output.</span></span>

### <a name="set-the-right-property-values-when-you-create-the-d2d-print-control"></a><span data-ttu-id="06f68-337">Définir les valeurs de propriété appropriées lorsque vous créez le contrôle d’impression D2D</span><span class="sxs-lookup"><span data-stu-id="06f68-337">Set the right property values when you create the D2D print control</span></span>

<span data-ttu-id="06f68-338">Vous pouvez définir trois propriétés lorsque vous créez le contrôle d’impression [Direct2D](./direct2d-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="06f68-338">There are three properties that you can set when you create the [Direct2D](./direct2d-portal.md) print control.</span></span> <span data-ttu-id="06f68-339">Deux de ces propriétés ont un impact sur la façon dont le contrôle d’impression Direct2D gère certaines commandes Direct2D et, à leur tour, ont un impact sur les performances globales.</span><span class="sxs-lookup"><span data-stu-id="06f68-339">Two of these properties impact how the Direct2D print control handles certain Direct2D commands and in turn impact the overall performance.</span></span>

-   <span data-ttu-id="06f68-340">Mode de sous-ensemble de polices : le contrôle d’impression [Direct2D](./direct2d-portal.md) sous-définit les ressources de police utilisées dans chaque page avant d’envoyer la page à imprimer.</span><span class="sxs-lookup"><span data-stu-id="06f68-340">Font Subset Mode: The [Direct2D](./direct2d-portal.md) print control subsets font resources used in each page before it sends the page to be printed.</span></span> <span data-ttu-id="06f68-341">Ce mode réduit la taille des ressources de page nécessaires à l’impression.</span><span class="sxs-lookup"><span data-stu-id="06f68-341">This mode reduces the size of page resources needed to print.</span></span> <span data-ttu-id="06f68-342">En fonction de l’utilisation de la police dans la page, vous pouvez choisir différents modes de sous-ensemble de polices pour obtenir de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="06f68-342">Depending on font usage on the page, you can choose different font subset modes for the best performance.</span></span>
    -   <span data-ttu-id="06f68-343">[**D2d1 \_ La \_ \_ \_ \_ valeur par défaut du mode imprimer le sous-ensemble de polices**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) fournit les meilleures performances d’impression dans la plupart des cas.</span><span class="sxs-lookup"><span data-stu-id="06f68-343">[**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_DEFAULT**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) provides the best printing performance in most cases.</span></span> <span data-ttu-id="06f68-344">Lorsqu’il est défini sur ce mode, le contrôle d’impression [Direct2D](./direct2d-portal.md) utilise une stratégie heuristique pour décider quand créer des sous-ensembles de polices.</span><span class="sxs-lookup"><span data-stu-id="06f68-344">When set to this mode, the [Direct2D](./direct2d-portal.md) print control uses a heuristic strategy to decide when to subset fonts.</span></span>
    -   <span data-ttu-id="06f68-345">Pour les travaux d’impression courts avec 1 ou 2 pages, nous vous recommandons d’utiliser [**d2d1 \_ mode de \_ sous-ensemble de polices d’impression \_ \_ \_ EACHPAGE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) , où le contrôle d’impression [Direct2D](./direct2d-portal.md) sous-ensemble et incorpore les ressources de police dans chaque page, puis ignore ce sous-ensemble de police après l’impression de la page.</span><span class="sxs-lookup"><span data-stu-id="06f68-345">For short print jobs with 1 or 2 pages, we recommend [**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_EACHPAGE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) , where the [Direct2D](./direct2d-portal.md) print control subsets and embeds font resources in each page, then discards that font subset after the page prints.</span></span> <span data-ttu-id="06f68-346">Cette option permet de s’assurer que chaque page peut être imprimée immédiatement après sa génération, mais augmente légèrement la taille des ressources de page nécessaires à l’impression (avec généralement de grands sous-ensembles de polices).</span><span class="sxs-lookup"><span data-stu-id="06f68-346">This option makes sure each page can be printed immediately after it is generated but slightly increases size of page resources needed for printing (with usually large font subsets).</span></span>
    -   <span data-ttu-id="06f68-347">Pour les travaux d’impression comportant de nombreuses pages de texte et des tailles de police de petite taille (par exemple, des pages de texte 100 qui utilisent une police unique), nous vous recommandons d’utiliser le [**\_ mode de \_ \_ sous-ensemble de police d2d1 \_ \_ aucun**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode), où le contrôle d’impression [Direct2D](./direct2d-portal.md) ne fait pas partie des ressources de police ; à la place, il envoie les ressources de police d’origine, ainsi que la page qui utilise la police pour la première fois, et réutilise les ressources de police pour les pages ultérieures sans les renvoyer.</span><span class="sxs-lookup"><span data-stu-id="06f68-347">For print jobs with many pages of texts and small font sizes (like 100 pages of text that uses a single font), we recommend [**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_NONE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode), where the [Direct2D](./direct2d-portal.md) print control doesn't subset font resources at all; instead, it sends out the original font resources along with the page that first uses the font, and re-uses the font resources for later pages without resending them.</span></span>
-   <span data-ttu-id="06f68-348">PPP de pixellisation : lorsque le contrôle d’impression [Direct2D](./direct2d-portal.md) doit pixelliser les commandes Direct2D pendant la conversion de DIRECT2D-XPS, il utilise cette PPP pour la pixellisation.</span><span class="sxs-lookup"><span data-stu-id="06f68-348">Rasterization DPI: When the [Direct2D](./direct2d-portal.md) print control needs to rasterize Direct2D commands during Direct2D-XPS conversion, it uses this DPI for rasterization.</span></span> <span data-ttu-id="06f68-349">En d’autres termes, si la page n’a pas de contenu pixellisé, la définition de n’importe quelle résolution ne modifiera pas les performances et la qualité.</span><span class="sxs-lookup"><span data-stu-id="06f68-349">In other words, if the page doesn't have any rasterized contents, setting any DPI won't change performance and quality.</span></span> <span data-ttu-id="06f68-350">En fonction de l’utilisation de la pixellisation sur la page, vous pouvez choisir différentes dpi de pixellisation pour obtenir le meilleur équilibre entre la fidélité et les performances.</span><span class="sxs-lookup"><span data-stu-id="06f68-350">Depending on rasterization usage on the page, you can choose different rasterization DPIs for the best balance between fidelity and performance.</span></span>
    -   <span data-ttu-id="06f68-351">150 est la valeur par défaut si vous ne spécifiez pas de valeur quand vous créez le contrôle d’impression [Direct2D](./direct2d-portal.md) , qui est le meilleur équilibre entre qualité d’impression et performances d’impression dans la plupart des cas.</span><span class="sxs-lookup"><span data-stu-id="06f68-351">150 is the default value if you don't specify a value when you create the [Direct2D](./direct2d-portal.md) print control, which is the best balance of printing quality and printing performance in most cases.</span></span>
    -   <span data-ttu-id="06f68-352">Les valeurs PPP supérieures produisent généralement une meilleure qualité d’impression (comme pour plus de détails), mais des performances inférieures en raison des bitmaps plus grandes générées.</span><span class="sxs-lookup"><span data-stu-id="06f68-352">Higher DPI values usually result in better printing quality (as in more details preserved) but lower performance due to the larger bitmaps it generates.</span></span> <span data-ttu-id="06f68-353">Nous ne recommandons aucune valeur DPI supérieure à 300, car cela n’introduira pas d’informations supplémentaires visuellement perceptibles par les yeux humains.</span><span class="sxs-lookup"><span data-stu-id="06f68-353">We don't recommend any DPI value greater than 300 since that won't introduce extra information visually perceivable by human eyes.</span></span>
    -   <span data-ttu-id="06f68-354">Les PPP inférieurs peuvent entraîner de meilleures performances, mais peuvent également produire une qualité inférieure.</span><span class="sxs-lookup"><span data-stu-id="06f68-354">Lower DPI may mean better performance but may also produce lower quality.</span></span>

### <a name="avoid-using-certain-direct2d-drawing-patterns"></a><span data-ttu-id="06f68-355">Évitez d’utiliser certains modèles de dessin Direct2D</span><span class="sxs-lookup"><span data-stu-id="06f68-355">Avoid using certain Direct2D drawing patterns</span></span>

<span data-ttu-id="06f68-356">Il existe des différences entre ce que [Direct2D](./direct2d-portal.md) peut représenter visuellement et ce que le sous-système d’impression peut conserver et transporter le long du pipeline d’impression entier.</span><span class="sxs-lookup"><span data-stu-id="06f68-356">There are differences between what [Direct2D](./direct2d-portal.md) can represent visually and what the print subsystem can maintain and transport along the whole print pipeline.</span></span> <span data-ttu-id="06f68-357">Le contrôle d’impression Direct2D fait combler ces lacunes en rapprochant ou en pixelliser les primitives Direct2D que le sous-système d’impression ne prend pas en charge en mode natif.</span><span class="sxs-lookup"><span data-stu-id="06f68-357">The Direct2D print control bridges those gaps by either approximating or rasterizing Direct2D primitives that the print subsystem doesn't natively support.</span></span> <span data-ttu-id="06f68-358">Une telle approximation entraîne généralement une plus faible fidélité à l’impression, une baisse des performances d’impression, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="06f68-358">Such approximation usually results in lower printing fidelity, lower printing performance, or both.</span></span> <span data-ttu-id="06f68-359">Par conséquent, même si un client peut utiliser les mêmes modèles de dessin pour le rendu à l’écran et à l’impression, il n’est pas idéal dans tous les cas.</span><span class="sxs-lookup"><span data-stu-id="06f68-359">Therefore, even though a customer can use the same drawing patterns for both screen and print rendering, it is not ideal in all cases.</span></span> <span data-ttu-id="06f68-360">Il est préférable de ne pas utiliser autant de primitives et de modèles Direct2D que possible pour le chemin d’impression, ou de procéder à la pixellisation où vous disposez d’un contrôle total sur la qualité et la taille des images pixellisées.</span><span class="sxs-lookup"><span data-stu-id="06f68-360">It's best not to use such Direct2D primitives and patterns as much as possible for the print path, or to do you own rasterization where you have full control of the quality and the size of the rasterized images.</span></span>

<span data-ttu-id="06f68-361">La liste ci-dessous répertorie les cas où les performances et la qualité d’impression ne sont pas idéales et que vous pouvez envisager de faire varier le chemin de code pour optimiser les performances d’impression.</span><span class="sxs-lookup"><span data-stu-id="06f68-361">The here is a list of cases where the print performance and quality won't be ideal and the you might want to consider varying the code path for optimal print performance.</span></span>

-   <span data-ttu-id="06f68-362">Évitez d’utiliser le mode de fusion primitif autre que [**d2d1 \_ primitive \_ Blend \_ SOURCEOVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_primitive_blend).</span><span class="sxs-lookup"><span data-stu-id="06f68-362">Avoid using primitive blend mode other than [**D2D1\_PRIMITIVE\_BLEND\_SOURCEOVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_primitive_blend).</span></span>
-   <span data-ttu-id="06f68-363">Évitez d’utiliser les modes de composition lors du dessin d’une image autre que la [**\_ \_ \_ source en \_**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_composite_mode) mode composite d2d1 sur la **\_ \_ destination en mode \_ \_ composite d2d1**.</span><span class="sxs-lookup"><span data-stu-id="06f68-363">Avoid using Composition Modes when drawing an image other than [**D2D1\_COMPOSITE\_MODE\_SOURCE\_OVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_composite_mode) and **D2D1\_COMPOSITE\_MODE\_DESTINATION\_OVER**.</span></span>
-   <span data-ttu-id="06f68-364">Évitez de dessiner un méta-fichier GDI.</span><span class="sxs-lookup"><span data-stu-id="06f68-364">Avoid drawing a GDI Meta File.</span></span>
-   <span data-ttu-id="06f68-365">Évitez de pousser une ressource de couche qui copie l’arrière-plan source (en appelant [**PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-pushlayer) avec la transmission [**de la \_ couche d2d1 \_ options1 \_ Initialize de l' \_ \_ arrière-plan**](/windows/desktop/api/d2d1_1/ns-d2d1_1-d2d1_layer_parameters1) vers le struct PARAMETERS1 de la **\_ couche \_ d2d1** ).</span><span class="sxs-lookup"><span data-stu-id="06f68-365">Avoid pushing a layer resource that copies the source background (calling [**PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-pushlayer) with passing [**D2D1\_LAYER\_OPTIONS1\_INITIALIZE\_FROM\_BACKGROUND**](/windows/desktop/api/d2d1_1/ns-d2d1_1-d2d1_layer_parameters1) to the **D2D1\_LAYER\_PARAMETERS1** struct).</span></span>
-   <span data-ttu-id="06f68-366">Évitez de créer un pinceau bitmap ou un pinceau d’image avec la \_ \_ pince en mode extension d2d1 \_ .</span><span class="sxs-lookup"><span data-stu-id="06f68-366">Avoid creating Bitmap Brush or Image Brush with D2D1\_EXTEND\_MODE\_CLAMP.</span></span> <span data-ttu-id="06f68-367">Nous vous recommandons d’utiliser \_ le \_ mode \_ miroir du mode d2d1 Extend si vous ne vous souciez pas des pixels en dehors de l’image liée (par exemple, l’image attachée au pinceau est plus importante que la région cible remplie).</span><span class="sxs-lookup"><span data-stu-id="06f68-367">We recommend you use D2D1\_EXTEND\_MODE\_MIRROR if don't care about pixels outside of the image bound at all (like, the image attached to the brush is known to be larger than the filled target region).</span></span>
-   <span data-ttu-id="06f68-368">Évitez de dessiner des bitmaps avec des [transformations de perspective](3d-perspective-transform.md).</span><span class="sxs-lookup"><span data-stu-id="06f68-368">Avoid drawing Bitmaps with [Perspective Transforms](3d-perspective-transform.md).</span></span>

### <a name="draw-text-in-a-direct-and-plain-way"></a><span data-ttu-id="06f68-369">Dessiner du texte de manière directe et simple</span><span class="sxs-lookup"><span data-stu-id="06f68-369">Draw text in a direct and plain way</span></span>

<span data-ttu-id="06f68-370">Direct2D propose plusieurs optimisations lors du rendu de textes à afficher pour de meilleures performances et/ou une meilleure qualité visuelle.</span><span class="sxs-lookup"><span data-stu-id="06f68-370">Direct2D has several optimizations when rendering texts to display for better performance and/or better visual quality.</span></span> <span data-ttu-id="06f68-371">Toutefois, toutes les optimisations améliorent les performances et la qualité d’impression puisque l’impression sur le papier est généralement plus élevée, et l’impression n’a pas besoin de prendre en charge des scénarios tels que l’animation.</span><span class="sxs-lookup"><span data-stu-id="06f68-371">But not all optimizations improve the printing performance and quality since the printing on paper is usually in a much higher DPI, and printing does not need to accommodate scenarios like animation.</span></span> <span data-ttu-id="06f68-372">Nous vous recommandons donc de dessiner directement le texte ou les glyphes d’origine et d’éviter les optimisations suivantes lors de la création de la liste de commandes pour l’impression.</span><span class="sxs-lookup"><span data-stu-id="06f68-372">So, we recommend you draw the original text or glyphs directly and avoid any of the following optimizations when creating the command list for printing.</span></span>

-   <span data-ttu-id="06f68-373">Évitez de dessiner du texte à l’aide de la méthode [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-fillopacitymask) .</span><span class="sxs-lookup"><span data-stu-id="06f68-373">Avoid drawing text with the [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-fillopacitymask) method.</span></span>
-   <span data-ttu-id="06f68-374">Évitez de dessiner du texte en mode alias.</span><span class="sxs-lookup"><span data-stu-id="06f68-374">Avoid drawing text in Aliased Mode.</span></span>

### <a name="draw-the-original-bitmaps-when-possible"></a><span data-ttu-id="06f68-375">Dessiner les bitmaps d’origine lorsque cela est possible</span><span class="sxs-lookup"><span data-stu-id="06f68-375">Draw the original bitmaps when possible</span></span>

<span data-ttu-id="06f68-376">Si la bitmap cible est un fichier JPEG, PNG, TIFF ou JPEG-XR, vous pouvez créer une bitmap WIC à partir d’un fichier de disque ou d’un flux en mémoire, puis créer une bitmap [Direct2D](./direct2d-portal.md) à partir de cette bitmap WIC à l’aide de [**ID2D1DeviceContext :: CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), puis passer directement cette bitmap Direct2D au contrôle d’impression Direct2D sans manipulation supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="06f68-376">If the target bitmap is a JPEG, PNG, TIFF, or JPEG-XR, you can create a WIC bitmap either from a disk file or from an in-memory stream, then create a [Direct2D](./direct2d-portal.md) bitmap from that WIC bitmap using [**ID2D1DeviceContext::CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), and finally directly pass that Direct2D bitmap to the Direct2D print control without further manipulation.</span></span> <span data-ttu-id="06f68-377">En procédant ainsi, le contrôle d’impression Direct2D peut réutiliser le flux bitmap, ce qui entraîne généralement une meilleure impression des performances (en ignorant l’encodage et le décodage des bitmaps redondants) et une meilleure qualité d’impression (lorsque les métadonnées, telles que les profils de couleurs, dans le bitmap sont conservées).</span><span class="sxs-lookup"><span data-stu-id="06f68-377">By doing so, the Direct2D print control is able to reuse the bitmap stream, which usually leads to better printing performance (by skipping redundant bitmap encoding and decoding), and better printing quality (when metadata, such as color profiles, in the bitmap will be preserved).</span></span>

<span data-ttu-id="06f68-378">Le dessin de la bitmap d’origine offre les avantages suivants pour les applications.</span><span class="sxs-lookup"><span data-stu-id="06f68-378">Drawing the original bitmap provides the following benefit for applications.</span></span>

-   <span data-ttu-id="06f68-379">En règle générale, l’impression de [Direct2D](./direct2d-portal.md) conserve les informations d’origine (sans perte ou bruit) jusqu’à la fin du pipeline, en particulier lorsque les applications ne savent pas (ou ne souhaitent pas connaître) les détails du pipeline d’impression (comme l’imprimante sur laquelle il imprime, la résolution de l’imprimante cible, etc.).</span><span class="sxs-lookup"><span data-stu-id="06f68-379">In general, [Direct2D](./direct2d-portal.md) print preserves the original information (without loss or noise) until late in the pipeline, especially when apps don't know (or do not want to know) the details of the print pipeline (like which printer it is printing to, what DPI is the target printer, and so on).</span></span>
-   <span data-ttu-id="06f68-380">Dans de nombreux cas, le retardement de la pixellisation des bitmaps permet d’améliorer les performances (par exemple, lors de l’impression d’une photo 96dpi sur une imprimante 600dpi).</span><span class="sxs-lookup"><span data-stu-id="06f68-380">In many cases, delaying bitmap rasterization means better performance (like when printing an 96dpi photo to a 600dpi printer).</span></span>
-   <span data-ttu-id="06f68-381">Dans certains cas, passer les images d’origine est le seul moyen de respecter la haute fidélité (comme les profils de couleurs incorporés).</span><span class="sxs-lookup"><span data-stu-id="06f68-381">In certain cases, passing the original images is the only way to honor high fidelity (like embedded color profiles).</span></span>

<span data-ttu-id="06f68-382">Toutefois, vous ne pouvez pas opter pour cette optimisation, car :</span><span class="sxs-lookup"><span data-stu-id="06f68-382">However, an you can't opt in such optimization because:</span></span>

-   <span data-ttu-id="06f68-383">En interrogeant les informations d’imprimante et la pixellisation précoce, vous pouvez pixelliser le contenu lui-même avec le contrôle total de l’apparence finale sur le papier.</span><span class="sxs-lookup"><span data-stu-id="06f68-383">By querying printer info and early rasterization, you can rasterize contents themselves with full control of the final appearance on paper.</span></span>
-   <span data-ttu-id="06f68-384">Dans certains cas, la première pixellisation peut en fait améliorer les performances de bout en bout d’une application (comme l’impression des photos de taille).</span><span class="sxs-lookup"><span data-stu-id="06f68-384">In certain cases, early rasterization might actually improves an app’s end-to-end performance (like printing wallets-size photos).</span></span>
-   <span data-ttu-id="06f68-385">Dans certains cas, passer les bitmaps d’origine nécessite un changement important de l’architecture du code existant (comme le chargement différé des images et les chemins de mise à jour des ressources dans certaines applications).</span><span class="sxs-lookup"><span data-stu-id="06f68-385">In certain cases, passing the original bitmaps require significant change of existing code architecture (like image delay loading and resource update paths found in certain applications).</span></span>

## <a name="conclusion"></a><span data-ttu-id="06f68-386">Conclusion</span><span class="sxs-lookup"><span data-stu-id="06f68-386">Conclusion</span></span>

<span data-ttu-id="06f68-387">Bien que Direct2D soit accéléré par le matériel et soit conçu pour des performances élevées, vous devez utiliser les fonctionnalités correctement pour maximiser le débit.</span><span class="sxs-lookup"><span data-stu-id="06f68-387">Although Direct2D is hardware accelerated and is meant for high performance, you must use the features correctly to maximize throughput.</span></span> <span data-ttu-id="06f68-388">Les techniques que nous avons étudiées ici sont dérivées de l’étude des scénarios courants et peuvent ne pas s’appliquer à tous les scénarios d’application.</span><span class="sxs-lookup"><span data-stu-id="06f68-388">The techniques we looked at here are derived from studying common scenarios and might not apply to all application scenarios.</span></span>

 

 
