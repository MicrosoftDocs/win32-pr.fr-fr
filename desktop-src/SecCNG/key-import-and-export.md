---
description: Vous pouvez importer et exporter des clés symétriques et des clés asymétriques avec CNG. Vous pouvez utiliser les fonctionnalités d’exportation et d’importation de clé pour déplacer des clés entre les machines.
ms.assetid: 37bda1e0-5dd2-455c-9627-4e7e1b0e04d3
title: Importation et exportation de clé
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8be59cc5f5c4b3d1a98fa30cf4e967d5469d2f1f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106513343"
---
# <a name="key-import-and-export"></a><span data-ttu-id="0b090-104">Importation et exportation de clé</span><span class="sxs-lookup"><span data-stu-id="0b090-104">Key Import and Export</span></span>

<span data-ttu-id="0b090-105">Vous pouvez importer et exporter des [*clés symétriques*](/windows/desktop/SecGloss/s-gly) et des clés asymétriques avec CNG.</span><span class="sxs-lookup"><span data-stu-id="0b090-105">You can import and export [*symmetric keys*](/windows/desktop/SecGloss/s-gly) and asymmetric keys with CNG.</span></span> <span data-ttu-id="0b090-106">Vous pouvez utiliser les fonctionnalités d’exportation et d’importation de clé pour déplacer des clés entre les machines.</span><span class="sxs-lookup"><span data-stu-id="0b090-106">And you can use key export and import functionality to move keys between machines.</span></span>

## <a name="symmetric-keys"></a><span data-ttu-id="0b090-107">Clés symétriques</span><span class="sxs-lookup"><span data-stu-id="0b090-107">Symmetric keys</span></span>

<span data-ttu-id="0b090-108">Pour importer ou exporter des clés symétriques (ou de session) dans lesquelles la même clé est utilisée pour chiffrer et déchiffrer des données, vous pouvez utiliser les fonctions [**BCryptImportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkey) et [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) .</span><span class="sxs-lookup"><span data-stu-id="0b090-108">To import or export symmetric (or session) keys in which the same key is used to encrypt and decrypt some data, you can use the [**BCryptImportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkey) and [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) functions.</span></span> <span data-ttu-id="0b090-109">En règle générale, vous exportez d’abord une clé à l’aide de la fonction **BCryptExportKey** avant l’importation à l’aide de la fonction **BCryptImportKey** .</span><span class="sxs-lookup"><span data-stu-id="0b090-109">Typically, you first export a key by using the **BCryptExportKey** function before importing by using the **BCryptImportKey** function.</span></span> <span data-ttu-id="0b090-110">Les fonctions sont conçues pour permettre le chiffrement des clés exportées et importées à l’aide des paramètres *hExportKey* et *hImportKey* ; Toutefois, l’implémentation Microsoft de ces fonctions ne prend pas en charge le chiffrement des clés exportées et importées.</span><span class="sxs-lookup"><span data-stu-id="0b090-110">The functions are designed to enable encryption of exported and imported keys by using the *hExportKey* and *hImportKey* parameters; however, the Microsoft implementation of these functions does not support encryption of exported and imported keys.</span></span>

## <a name="asymmetric-keys"></a><span data-ttu-id="0b090-111">Clés asymétriques</span><span class="sxs-lookup"><span data-stu-id="0b090-111">Asymmetric keys</span></span>

<span data-ttu-id="0b090-112">Pour importer les paires de clés asymétriques (ou [*publiques/privées*](/windows/desktop/SecGloss/p-gly)) dans lesquelles une clé est utilisée pour chiffrer et l’autre est utilisée pour déchiffrer des données, vous pouvez utiliser l’une des fonctions [**BCryptImportKeyPair**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkeypair) ou [**NCryptImportKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptimportkey) .</span><span class="sxs-lookup"><span data-stu-id="0b090-112">To import asymmetric (or [*public/private*](/windows/desktop/SecGloss/p-gly)) key pairs in which one key is used to encrypt and the other is used to decrypt some data, you can use either of the [**BCryptImportKeyPair**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkeypair) or [**NCryptImportKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptimportkey) functions.</span></span> <span data-ttu-id="0b090-113">Un fournisseur CNG doit encoder la paire de clés à l’aide d’un type [*blob de clé*](/windows/desktop/SecGloss/k-gly) pris en charge.</span><span class="sxs-lookup"><span data-stu-id="0b090-113">A CNG provider must encode the key pair by using a supported [*key BLOB*](/windows/desktop/SecGloss/k-gly) type.</span></span> <span data-ttu-id="0b090-114">[**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) peut être utilisé pour créer l’objet blob de clé encodé.</span><span class="sxs-lookup"><span data-stu-id="0b090-114">[**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) can be used to create the encoded key BLOB.</span></span> <span data-ttu-id="0b090-115">Les [structures CNG](cng-structures.md) décrivent les types et structures blob de clé pris en charge par le fournisseur de stockage de clés Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0b090-115">[CNG Structures](cng-structures.md) describes the key BLOB types and structures that Microsoft Key Storage Provider supports.</span></span>

<span data-ttu-id="0b090-116">Pour que [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) crée une paire de clés persistante, l’objet blob de clé d’entrée doit contenir une [*clé privée*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="0b090-116">For [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) to create a persisted key pair, the input key BLOB must contain a [*private key*](/windows/desktop/SecGloss/p-gly).</span></span> <span data-ttu-id="0b090-117">Les [*clés publiques*](/windows/desktop/SecGloss/p-gly) ne sont pas rendues persistantes.</span><span class="sxs-lookup"><span data-stu-id="0b090-117">[*Public keys*](/windows/desktop/SecGloss/p-gly) are not persisted.</span></span>

<span data-ttu-id="0b090-118">Le nom de clé et la stratégie d’exportation ne font pas partie de la structure d' [*objets BLOB*](/windows/desktop/SecGloss/b-gly) définie dans les [structures CNG](cng-structures.md).</span><span class="sxs-lookup"><span data-stu-id="0b090-118">The key name and export policy are not part of the [*BLOB*](/windows/desktop/SecGloss/b-gly) structure defined in [CNG Structures](cng-structures.md).</span></span> <span data-ttu-id="0b090-119">Toutefois, si un objet BLOB est d’un type BLOB opaque (tel que l’image mémoire d’un état de clé interne), l’objet BLOB peut contenir les propriétés nom de clé et stratégie d’exportation.</span><span class="sxs-lookup"><span data-stu-id="0b090-119">However, if a BLOB is of an opaque BLOB type (such as the memory image of an internal key state), the BLOB might contain the key name and export-policy properties.</span></span>

<span data-ttu-id="0b090-120">La procédure suivante décrit comment importer une clé privée persistante avec ses propriétés.</span><span class="sxs-lookup"><span data-stu-id="0b090-120">The following procedure describes how to import a persisted private key with its properties.</span></span>

<span data-ttu-id="0b090-121">**Pour importer une clé persistante**</span><span class="sxs-lookup"><span data-stu-id="0b090-121">**To import a persisted key**</span></span>

1.  <span data-ttu-id="0b090-122">Créez une clé persistante à l’aide de la fonction [**NCryptCreatePersistedKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptcreatepersistedkey) .</span><span class="sxs-lookup"><span data-stu-id="0b090-122">Create a persisted key by using the [**NCryptCreatePersistedKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptcreatepersistedkey) function.</span></span>
2.  <span data-ttu-id="0b090-123">Définissez les propriétés souhaitées sur l’objet clé à l’aide de la fonction [**NCryptSetProperty**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptsetproperty) .</span><span class="sxs-lookup"><span data-stu-id="0b090-123">Set any desired properties on the key object by using the [**NCryptSetProperty**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptsetproperty) function.</span></span>
3.  <span data-ttu-id="0b090-124">Définissez l’objet BLOB de clé d’importation en tant que propriété sur la clé, avec le type d’objet BLOB comme nom de propriété.</span><span class="sxs-lookup"><span data-stu-id="0b090-124">Set the import key BLOB as a property on the key, with the BLOB type as the property name.</span></span>
4.  <span data-ttu-id="0b090-125">Finalisez l’importation de la clé rendue persistante à l’aide de la fonction [**NCryptFinalizeKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptfinalizekey) .</span><span class="sxs-lookup"><span data-stu-id="0b090-125">Finalize the persisted key import by using the [**NCryptFinalizeKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptfinalizekey) function.</span></span>

 

 
