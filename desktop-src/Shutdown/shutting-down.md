---
description: 'Il existe trois façons pour une application d’arrêter des ordinateurs locaux ou distants : Arrêtez le systemshut sur le système et redémarrez itshut l’application, arrêtez et redémarrez le système, puis redémarrez toutes les applications qui ont été inscrites pour le redémarrage'
ms.assetid: acadf58f-3f68-4fa1-bdcf-8f85c8479263
title: Arrêt en cours
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e436dd9e3b115112e63b0440b4d51de4c7f9f619
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106519527"
---
# <a name="shutting-down"></a><span data-ttu-id="1addb-103">Arrêt en cours</span><span class="sxs-lookup"><span data-stu-id="1addb-103">Shutting Down</span></span>

<span data-ttu-id="1addb-104">Il existe trois façons pour une application d’arrêter des ordinateurs locaux ou distants :</span><span class="sxs-lookup"><span data-stu-id="1addb-104">There are three ways for an application to shut down local or remote computers:</span></span>

-   <span data-ttu-id="1addb-105">arrêter le système</span><span class="sxs-lookup"><span data-stu-id="1addb-105">shut down the system</span></span>
-   <span data-ttu-id="1addb-106">Arrêtez le système et redémarrez-le.</span><span class="sxs-lookup"><span data-stu-id="1addb-106">shut down the system and restart it</span></span>
-   <span data-ttu-id="1addb-107">Arrêtez l’application, arrêtez et redémarrez le système, puis redémarrez toutes les applications qui ont été inscrites pour le redémarrage</span><span class="sxs-lookup"><span data-stu-id="1addb-107">shut down the application, shut down and restart the system, and restart any applications that have been registered for restart</span></span>

<span data-ttu-id="1addb-108">Pour arrêter le système, utilisez la fonction [**ExitWindowsEx**](/windows/desktop/api/Winuser/nf-winuser-exitwindowsex) avec l’indicateur d' \_ arrêt EWX.</span><span class="sxs-lookup"><span data-stu-id="1addb-108">To shut down the system, use the [**ExitWindowsEx**](/windows/desktop/api/Winuser/nf-winuser-exitwindowsex) function with the EWX\_SHUTDOWN flag.</span></span> <span data-ttu-id="1addb-109">Pour obtenir un exemple, consultez [Comment arrêter le système](how-to-shut-down-the-system.md).</span><span class="sxs-lookup"><span data-stu-id="1addb-109">For an example, see [How to Shut Down the System](how-to-shut-down-the-system.md).</span></span> <span data-ttu-id="1addb-110">Pour arrêter et redémarrer le système, utilisez l’indicateur de \_ redémarrage EWX.</span><span class="sxs-lookup"><span data-stu-id="1addb-110">To shut down and restart the system, use the EWX\_REBOOT flag.</span></span> <span data-ttu-id="1addb-111">Pour redémarrer toutes les applications qui ont été inscrites pour le redémarrage à l’aide de la fonction [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) , utilisez l' \_ indicateur EXW RESTARTAPPS.</span><span class="sxs-lookup"><span data-stu-id="1addb-111">To restart any applications that have been registered for restart using the [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) function, use the EXW\_RESTARTAPPS flag.</span></span>

<span data-ttu-id="1addb-112">Les fonctions [**InitiateShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiateshutdowna), [**InitiateSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdowna)et [**InitiateSystemShutdownEx**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdownexa) démarrent un minuteur et affichent une boîte de dialogue qui invite l’utilisateur à se déconnecter.</span><span class="sxs-lookup"><span data-stu-id="1addb-112">The [**InitiateShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiateshutdowna), [**InitiateSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdowna), and [**InitiateSystemShutdownEx**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdownexa) functions start a timer and display a dialog box that prompts the user to log off.</span></span> <span data-ttu-id="1addb-113">Lorsque cette boîte de dialogue est affichée, la fonction [**AbortSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-abortsystemshutdowna) peut arrêter le minuteur et empêcher l’ordinateur de s’arrêter.</span><span class="sxs-lookup"><span data-stu-id="1addb-113">While this dialog box is displayed, the [**AbortSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-abortsystemshutdowna) function can stop the timer and prevent the computer from shutting down.</span></span> <span data-ttu-id="1addb-114">Toutefois, si le minuteur expire, l’ordinateur est arrêté.</span><span class="sxs-lookup"><span data-stu-id="1addb-114">However, if the timer expires, the computer is shut down.</span></span> <span data-ttu-id="1addb-115">Ces fonctions peuvent également redémarrer l’ordinateur après une opération d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="1addb-115">These functions can also restart the computer following a shutdown operation.</span></span> <span data-ttu-id="1addb-116">Pour plus d’informations, consultez [affichage de la boîte de dialogue d’arrêt](displaying-the-shutdown-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="1addb-116">For more information, see [Displaying the Shutdown Dialog Box](displaying-the-shutdown-dialog-box.md).</span></span>

## <a name="shutdown-notifications"></a><span data-ttu-id="1addb-117">Notifications d’arrêt</span><span class="sxs-lookup"><span data-stu-id="1addb-117">Shutdown Notifications</span></span>

<span data-ttu-id="1addb-118">Les applications avec une fenêtre et la file d’attente de messages reçoivent des notifications d’arrêt par le biais des messages [**WM \_ QUERYENDSESSION**](wm-queryendsession.md) et [**WM \_ ENDSESSION**](wm-endsession.md) .</span><span class="sxs-lookup"><span data-stu-id="1addb-118">Applications with a window and message queue receive shutdown notifications through the [**WM\_QUERYENDSESSION**](wm-queryendsession.md) and [**WM\_ENDSESSION**](wm-endsession.md) messages.</span></span> <span data-ttu-id="1addb-119">Ces applications doivent retourner la **valeur true** pour indiquer qu’elles peuvent être arrêtées.</span><span class="sxs-lookup"><span data-stu-id="1addb-119">These applications should return **TRUE** to indicate that they can be terminated.</span></span> <span data-ttu-id="1addb-120">Les applications ne doivent pas bloquer l’arrêt du système, sauf si cela est absolument nécessaire.</span><span class="sxs-lookup"><span data-stu-id="1addb-120">Applications should not block system shutdown unless it is absolutely necessary.</span></span> <span data-ttu-id="1addb-121">Les applications doivent effectuer tout nettoyage requis lors du traitement de **WM \_ ENDSESSION**.</span><span class="sxs-lookup"><span data-stu-id="1addb-121">Applications should perform any required cleanup while processing **WM\_ENDSESSION**.</span></span> <span data-ttu-id="1addb-122">Les applications qui contiennent des données non enregistrées peuvent enregistrer les données dans un emplacement temporaire et les restaurer lors du prochain démarrage de l’application.</span><span class="sxs-lookup"><span data-stu-id="1addb-122">Applications that have unsaved data could save the data to a temporary location and restore it the next time the application starts.</span></span> <span data-ttu-id="1addb-123">Il est recommandé que les applications enregistrent fréquemment leurs données et leur état ; par exemple, enregistrez automatiquement les données entre les opérations d’enregistrement initiées par l’utilisateur pour réduire la quantité de données à enregistrer lors de l’arrêt.</span><span class="sxs-lookup"><span data-stu-id="1addb-123">It is recommended that applications save their data and state frequently; for example, automatically save data between save operations initiated by the user to reduce the amount of data to be saved at shutdown.</span></span>

<span data-ttu-id="1addb-124">Les applications console reçoivent des notifications d’arrêt dans leurs routines de gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="1addb-124">Console applications receive shutdown notifications in their handler routines.</span></span> <span data-ttu-id="1addb-125">Pour inscrire un gestionnaire de console, utilisez la fonction [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) .</span><span class="sxs-lookup"><span data-stu-id="1addb-125">To register a console handler, use the [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) function.</span></span>

<span data-ttu-id="1addb-126">Les applications de service reçoivent des notifications d’arrêt dans leurs routines de gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="1addb-126">Service applications receive shutdown notifications in their handler routines.</span></span> <span data-ttu-id="1addb-127">Pour inscrire un gestionnaire de contrôle des services, utilisez la fonction [**RegisterServiceCtrlHandlerEx**](/windows/win32/api/winsvc/nf-winsvc-registerservicectrlhandlerexa) .</span><span class="sxs-lookup"><span data-stu-id="1addb-127">To register a service control handler, use the [**RegisterServiceCtrlHandlerEx**](/windows/win32/api/winsvc/nf-winsvc-registerservicectrlhandlerexa) function.</span></span>

## <a name="blocking-shutdown"></a><span data-ttu-id="1addb-128">Blocage de l’arrêt</span><span class="sxs-lookup"><span data-stu-id="1addb-128">Blocking Shutdown</span></span>

<span data-ttu-id="1addb-129">Si une application doit bloquer un éventuel arrêt du système, elle peut appeler la fonction [**ShutdownBlockReasonCreate**](/windows/desktop/api/Winuser/nf-winuser-shutdownblockreasoncreate) .</span><span class="sxs-lookup"><span data-stu-id="1addb-129">If an application must block a potential system shutdown, it can call the [**ShutdownBlockReasonCreate**](/windows/desktop/api/Winuser/nf-winuser-shutdownblockreasoncreate) function.</span></span> <span data-ttu-id="1addb-130">L’appelant fournit une chaîne de raison qui sera affichée à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1addb-130">The caller provides a reason string that will be displayed to the user.</span></span> <span data-ttu-id="1addb-131">La chaîne de raison doit être abrégée et claire, fournissant à l’utilisateur les informations nécessaires pour décider s’il faut poursuivre l’arrêt du système.</span><span class="sxs-lookup"><span data-stu-id="1addb-131">The reason string should be short and clear, providing the user with the information necessary to decide whether to continue shutting down the system.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1addb-132">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1addb-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1addb-133">Comment arrêter le système</span><span class="sxs-lookup"><span data-stu-id="1addb-133">How to Shut Down the System</span></span>](how-to-shut-down-the-system.md)
</dt> </dl>

 

 
