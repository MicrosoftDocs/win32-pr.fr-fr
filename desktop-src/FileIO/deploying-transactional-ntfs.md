---
description: Contrôle de la mise en cache dans le NTFS transactionnel.
ms.assetid: 0fd272ee-cf5f-4ba9-b8aa-ff0016f51d4b
title: Déploiement de NTFS transactionnel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bd7c44e0ad3b83854e56d18171072a7cb4615d5c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951603"
---
# <a name="deploying-transactional-ntfs"></a><span data-ttu-id="539b9-103">Déploiement de NTFS transactionnel</span><span class="sxs-lookup"><span data-stu-id="539b9-103">Deploying Transactional NTFS</span></span>

<span data-ttu-id="539b9-104">Le NTFS transactionnel (TxF), comme la plupart des mécanismes de transaction, dépend du classement correct des écritures de données.</span><span class="sxs-lookup"><span data-stu-id="539b9-104">Transactional NTFS (TxF), like most transaction mechanisms, depends upon correct ordering of data writes.</span></span> <span data-ttu-id="539b9-105">Garantir un classement approprié en écriture nécessite un contrôle explicite de la mise en cache des données.</span><span class="sxs-lookup"><span data-stu-id="539b9-105">Ensuring proper write ordering requires explicit control of data caching.</span></span> <span data-ttu-id="539b9-106">Pour répondre à cette exigence, TxF exige que les lecteurs de disque implémentent les mécanismes de contrôle de mise en cache qui font partie d’interfaces de lecteur standardisées telles que SCSI, SATA et ATA.</span><span class="sxs-lookup"><span data-stu-id="539b9-106">To meet this requirement, TxF requires that disk drives implement the caching control mechanisms that are part of standardized drive interfaces such as SCSI, SATA, and ATA.</span></span>

<span data-ttu-id="539b9-107">Le mécanisme de contrôle de mise en cache utilisé par TxF est un indicateur connu sous le nom de fonction Forced Unit Access (FUA).</span><span class="sxs-lookup"><span data-stu-id="539b9-107">The caching control mechanism used by TxF is a flag known as the Force Unit Access (FUA) function.</span></span> <span data-ttu-id="539b9-108">Cet indicateur spécifie que le lecteur doit écrire les données sur un support de stockage stable avant la fin du signalement.</span><span class="sxs-lookup"><span data-stu-id="539b9-108">This flag specifies that the drive should write the data to stable media storage before signaling complete.</span></span> <span data-ttu-id="539b9-109">À certains points critiques au sein d’une transaction, TxF doit émettre un FUA pour s’assurer que certaines données de contrôle nécessaires à la restauration d’une transaction ne sont pas perdues en cas de panne de courant.</span><span class="sxs-lookup"><span data-stu-id="539b9-109">At certain critical points within a transaction, TxF needs to issue an FUA to ensure that some control data necessary to successfully rollback a transaction is not lost if a power failure occurs.</span></span>

<span data-ttu-id="539b9-110">Les lecteurs de disque de classe serveur (SCSI et Fiber Channel) prennent généralement en charge l’indicateur FUA.</span><span class="sxs-lookup"><span data-stu-id="539b9-110">Server-class disk drives (SCSI and Fiber Channel) generally support the FUA flag.</span></span> <span data-ttu-id="539b9-111">À partir de Vista, Windows prend en charge l’indicateur FUA uniquement pour les disques SCSI et Fiber Channel.</span><span class="sxs-lookup"><span data-stu-id="539b9-111">Starting in Vista, Windows supports the FUA flag only for SCSI and Fiber Channel disks.</span></span>

<span data-ttu-id="539b9-112">Sur les lecteurs de produit (ATA/SATA/USB), TxF présente des périodes de vulnérabilité pendant lesquelles une panne de courant peut entraîner l’incapacité de TxF à restaurer correctement la transaction, laissant ainsi les données dans un état incohérent, sauf si le cache d’écriture du lecteur est désactivé.</span><span class="sxs-lookup"><span data-stu-id="539b9-112">On commodity drives (ATA/SATA/USB), TxF has periods of vulnerability during which a drive power failure can result in TxF being unable to correctly rollback the transaction, thus leaving data in an inconsistent state unless the drive's write cache is disabled.</span></span>

<span data-ttu-id="539b9-113">Certains adaptateurs de bus hôte (HBA) et contrôleurs de stockage (par exemple, les systèmes RAID) disposent de caches intégrés sur batterie.</span><span class="sxs-lookup"><span data-stu-id="539b9-113">Some Host Bus Adapters (HBAs) and storage controllers (for example, RAID systems) have built-in battery-backed caches.</span></span> <span data-ttu-id="539b9-114">Étant donné que ces appareils conservent les données mises en cache en cas de panne de courant, tous les disques qui y sont connectés ne sont pas tenus d’honorer l’indicateur FUA.</span><span class="sxs-lookup"><span data-stu-id="539b9-114">Because these devices preserve cached data if a power fault occurs, any disks connected to them are not required to honor the FUA flag.</span></span> <span data-ttu-id="539b9-115">En outre, un disque dont l’alimentation est protégée par une alimentation sans interruption (UPS) n’a pas besoin d’honorer l’indicateur FUA.</span><span class="sxs-lookup"><span data-stu-id="539b9-115">Further, a disk whose power supply is protected by an uninterruptable power supply (UPS) does not need to honor the FUA flag.</span></span> <span data-ttu-id="539b9-116">Cela est dû au fait que l’onduleur conserve suffisamment de temps pour que le disque vide son cache sur le support.</span><span class="sxs-lookup"><span data-stu-id="539b9-116">This is because the UPS will maintain power long enough for the disk to flush its cache to the media.</span></span>

<span data-ttu-id="539b9-117">La désactivation du cache d’écriture d’un lecteur élimine la nécessité pour le lecteur d’honorer l’indicateur FUA.</span><span class="sxs-lookup"><span data-stu-id="539b9-117">Disabling a drive's write cache eliminates the requirement for the drive to honor the FUA flag.</span></span> <span data-ttu-id="539b9-118">Vous pouvez désactiver la mise en cache d’écriture d’un disque en émettant le code de contrôle d' [**informations du cache du \_ jeu de disques \_ \_ \_ IOCTL**](/windows/desktop/api/WinIoCtl/ni-winioctl-ioctl_disk_set_cache_information) sur le disque.</span><span class="sxs-lookup"><span data-stu-id="539b9-118">You can disable a disk's write caching by issuing the [**IOCTL\_DISK\_SET\_CACHE\_INFORMATION**](/windows/desktop/api/WinIoCtl/ni-winioctl-ioctl_disk_set_cache_information) control code to the disk.</span></span> <span data-ttu-id="539b9-119">L’état du cache d’écriture (activé/désactivé) est conservé entre les redémarrages du système.</span><span class="sxs-lookup"><span data-stu-id="539b9-119">The state of the write cache (on/off) will be preserved across system reboots.</span></span> <span data-ttu-id="539b9-120">L’émission de ce code de contrôle aura des conséquences significatives sur les performances de toutes les e/s émises sur ce disque, ce qui sera probablement une dégradation notable des performances.</span><span class="sxs-lookup"><span data-stu-id="539b9-120">Issuing this control code will have very significant performance consequences for all I/O issued to that disk, which will most likely be a noticeable performance degradation.</span></span> <span data-ttu-id="539b9-121">L’utilisation de ce code de contrôle doit être soigneusement envisagée avant le déploiement.</span><span class="sxs-lookup"><span data-stu-id="539b9-121">Use of this control code should be carefully considered prior to deployment.</span></span>

> [!Note]  
> <span data-ttu-id="539b9-122">Pour que TxF puisse protéger de manière cohérente l’intégrité de vos données par le biais de pannes de courant, le système doit satisfaire au moins l’un des critères suivants :</span><span class="sxs-lookup"><span data-stu-id="539b9-122">For TxF to be capable of consistently protecting your data's integrity through power faults, the system must satisfy at least one of the following criteria:</span></span>
>
> -   <span data-ttu-id="539b9-123">Utilisez des disques de classe serveur (SCSI, Fiber Channel).</span><span class="sxs-lookup"><span data-stu-id="539b9-123">Use server-class disks (SCSI, Fiber Channel).</span></span>
> -   <span data-ttu-id="539b9-124">Assurez-vous que les disques sont connectés à un adaptateur de bus hôte avec mise en cache avec batterie de secours.</span><span class="sxs-lookup"><span data-stu-id="539b9-124">Make sure the disks are connected to a battery-backed caching HBA.</span></span>
> -   <span data-ttu-id="539b9-125">Utilisez un contrôleur de stockage (par exemple, système RAID) comme unité de stockage.</span><span class="sxs-lookup"><span data-stu-id="539b9-125">Use a storage controller (for example, RAID system) as the storage device.</span></span>
> -   <span data-ttu-id="539b9-126">Assurez-vous que l’alimentation du disque est protégée par un onduleur.</span><span class="sxs-lookup"><span data-stu-id="539b9-126">Ensure power to the disk is protected by a UPS.</span></span>
> -   <span data-ttu-id="539b9-127">Vérifiez que la fonctionnalité de mise en cache d’écriture du disque est désactivée.</span><span class="sxs-lookup"><span data-stu-id="539b9-127">Ensure that the disk's write caching feature is disabled.</span></span>

 

 

 



