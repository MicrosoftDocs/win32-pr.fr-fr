---
description: Le système de fichiers NTFS associe un identificateur non signé 64 bits à chaque journal des modifications.
ms.assetid: 5ae79460-b69a-4901-a417-1d5358dcba29
title: Utilisation de l’identificateur du journal des modifications
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 692acf98403e45b6bdafd3cd4791a64dd1beb532
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106527795"
---
# <a name="using-the-change-journal-identifier"></a><span data-ttu-id="25181-103">Utilisation de l’identificateur du journal des modifications</span><span class="sxs-lookup"><span data-stu-id="25181-103">Using the Change Journal Identifier</span></span>

<span data-ttu-id="25181-104">Le système de fichiers NTFS associe un identificateur non signé 64 bits à chaque journal des modifications.</span><span class="sxs-lookup"><span data-stu-id="25181-104">The NTFS file system associates an unsigned 64-bit identifier with each change journal.</span></span> <span data-ttu-id="25181-105">Le journal est marqué avec cet identificateur lors de sa création.</span><span class="sxs-lookup"><span data-stu-id="25181-105">The journal is stamped with this identifier when it is created.</span></span> <span data-ttu-id="25181-106">Le système de fichiers marque le journal avec un nouvel identificateur dans lequel les enregistrements de numéro de séquence de mise à jour (USN) existants sont ou peuvent être inutilisables.</span><span class="sxs-lookup"><span data-stu-id="25181-106">The file system stamps the journal with a new identifier where the existing update sequence number (USN) records either are or may be unusable.</span></span>

<span data-ttu-id="25181-107">Par exemple, le système de fichiers NTFS réestampille un journal des modifications avec un nouvel identificateur lorsqu’un volume est déplacé d’une version de NTFS vers une autre, puis de nouveau.</span><span class="sxs-lookup"><span data-stu-id="25181-107">For example, the NTFS file system restamps a change journal with a new identifier when a volume is moved from one version of NTFS to another and then back.</span></span> <span data-ttu-id="25181-108">Un tel déplacement peut se produire dans un environnement à double démarrage ou lors de l’utilisation d’un support amovible.</span><span class="sxs-lookup"><span data-stu-id="25181-108">Such a move can happen in a dual-boot environment or when working with removable media.</span></span>

<span data-ttu-id="25181-109">Pour obtenir l’identificateur du journal des modifications actuel sur un volume spécifié, utilisez le code de contrôle du [**\_ \_ \_ journal USN de la requête FSCTL**](/windows/win32/api/winioctl/ni-winioctl-fsctl_query_usn_journal) .</span><span class="sxs-lookup"><span data-stu-id="25181-109">To obtain the identifier of the current change journal on a specified volume, use the [**FSCTL\_QUERY\_USN\_JOURNAL**](/windows/win32/api/winioctl/ni-winioctl-fsctl_query_usn_journal) control code.</span></span> <span data-ttu-id="25181-110">Pour effectuer cette opération et toutes les autres opérations de journal des modifications, vous devez disposer de privilèges d’administrateur système.</span><span class="sxs-lookup"><span data-stu-id="25181-110">To perform this and all other change journal operations, you must have system administrator privileges.</span></span> <span data-ttu-id="25181-111">Autrement dit, vous devez être membre du groupe administrateurs.</span><span class="sxs-lookup"><span data-stu-id="25181-111">That is, you must be a member of the Administrators group.</span></span>

<span data-ttu-id="25181-112">Lorsqu’un administrateur supprime et recrée le journal des modifications, par exemple lorsque la valeur USN actuelle approche la valeur USN maximale possible, les valeurs USN redémarrent à partir de zéro.</span><span class="sxs-lookup"><span data-stu-id="25181-112">When an administrator deletes and re-creates the change journal, for example when the current USN value approaches the maximum possible USN value, the USN values begin again from zero.</span></span> <span data-ttu-id="25181-113">Lorsque le système de fichiers NTFS marque un journal avec un nouvel identificateur plutôt que de recréer le journal, il ne réinitialise pas l’USN à zéro, mais continue à partir de l’USN actuel.</span><span class="sxs-lookup"><span data-stu-id="25181-113">When the NTFS file system stamps a journal with a new identifier rather than re-creating the journal, it does not reset the USN to zero but continues from the current USN.</span></span> <span data-ttu-id="25181-114">Dans les deux cas, toutes les USN existants sont moins que les futurs USN.</span><span class="sxs-lookup"><span data-stu-id="25181-114">In either case, all existing USNs are less than any future USNs.</span></span>

<span data-ttu-id="25181-115">Lorsque vous avez besoin d’informations sur un ensemble spécifique d’enregistrements, utilisez le code de contrôle du [**\_ \_ \_ journal USN de la requête FSCTL**](/windows/win32/api/winioctl/ni-winioctl-fsctl_query_usn_journal) pour obtenir l’identificateur du journal des modifications.</span><span class="sxs-lookup"><span data-stu-id="25181-115">When you need information on a specific set of records, use the [**FSCTL\_QUERY\_USN\_JOURNAL**](/windows/win32/api/winioctl/ni-winioctl-fsctl_query_usn_journal) control code to obtain the change journal identifier.</span></span> <span data-ttu-id="25181-116">Ensuite, utilisez le code de contrôle [**\_ \_ \_ journal USN de lecture FSCTL**](/windows/win32/api/winioctl/ni-winioctl-fsctl_read_usn_journal) pour lire les enregistrements de journal qui vous intéressent.</span><span class="sxs-lookup"><span data-stu-id="25181-116">Then use the [**FSCTL\_READ\_USN\_JOURNAL**](/windows/win32/api/winioctl/ni-winioctl-fsctl_read_usn_journal) control code to read the journal records of interest.</span></span> <span data-ttu-id="25181-117">Le système de fichiers NTFS retourne uniquement les enregistrements qui sont valides pour le journal spécifié par l’identificateur.</span><span class="sxs-lookup"><span data-stu-id="25181-117">The NTFS file system only returns records that are valid for the journal specified by the identifier.</span></span>

<span data-ttu-id="25181-118">Votre application a besoin des USN des enregistrements et de l’identificateur pour lire le journal.</span><span class="sxs-lookup"><span data-stu-id="25181-118">Your application needs both the records' USNs and the identifier to read the journal.</span></span> <span data-ttu-id="25181-119">Cette exigence fournit un contrôle d’intégrité dans les cas où votre application doit ignorer les enregistrements existants dans le fichier et où les enregistrements ont été écrits dans des instances précédentes du journal pour le même volume.</span><span class="sxs-lookup"><span data-stu-id="25181-119">This requirement provides an integrity check for cases where your application should ignore the existing records in the file and where records were written in previous instances of the journal for the same volume.</span></span>

<span data-ttu-id="25181-120">Pour obtenir les enregistrements qui vous intéressent, vous devez commencer à l’enregistrement le plus ancien (c’est-à-dire avec le numéro USN le plus bas) et effectuer une analyse directe jusqu’à ce que vous trouviez le premier enregistrement qui vous intéresse.</span><span class="sxs-lookup"><span data-stu-id="25181-120">To obtain the records in which you are interested, you must start at the oldest record (that is, with the lowest USN) and scan forward until you locate the first record of interest.</span></span>

 

 
