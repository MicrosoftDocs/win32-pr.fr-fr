---
description: Étant donné que les fichiers sont des objets sécurisables, leur accès est régi par le modèle de contrôle d’accès qui régit l’accès à tous les autres objets sécurisables dans Windows.
ms.assetid: 991d7d94-fae7-406f-b2e3-dee811279366
title: Sécurité des fichiers et droits d’accès
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b161dd78c7585cf6de2781d7339787a22bde95dc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106534438"
---
# <a name="file-security-and-access-rights"></a><span data-ttu-id="3a063-103">Sécurité des fichiers et droits d’accès</span><span class="sxs-lookup"><span data-stu-id="3a063-103">File Security and Access Rights</span></span>

<span data-ttu-id="3a063-104">Étant donné que les fichiers sont des [objets sécurisables](/windows/desktop/SecAuthZ/securable-objects), leur accès est régi par le modèle de contrôle d’accès qui régit l’accès à tous les autres objets sécurisables dans Windows.</span><span class="sxs-lookup"><span data-stu-id="3a063-104">Because files are [securable objects](/windows/desktop/SecAuthZ/securable-objects), access to them is regulated by the access-control model that governs access to all other securable objects in Windows.</span></span> <span data-ttu-id="3a063-105">Pour obtenir une explication détaillée de ce modèle, consultez [Access Control](/windows/desktop/SecAuthZ/access-control).</span><span class="sxs-lookup"><span data-stu-id="3a063-105">For a detailed explanation of this model, see [Access Control](/windows/desktop/SecAuthZ/access-control).</span></span>

<span data-ttu-id="3a063-106">Vous pouvez spécifier un [descripteur de sécurité](/windows/desktop/api/winnt/ns-winnt-security_descriptor) pour un fichier ou un répertoire lorsque vous appelez la fonction [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea), [**CreateDirectory**](/windows/desktop/api/FileAPI/nf-fileapi-createdirectorya)ou [**CreateDirectoryEx**](/windows/desktop/api/WinBase/nf-winbase-createdirectoryexa) .</span><span class="sxs-lookup"><span data-stu-id="3a063-106">You can specify a [security descriptor](/windows/desktop/api/winnt/ns-winnt-security_descriptor) for a file or directory when you call the [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea), [**CreateDirectory**](/windows/desktop/api/FileAPI/nf-fileapi-createdirectorya), or [**CreateDirectoryEx**](/windows/desktop/api/WinBase/nf-winbase-createdirectoryexa) function.</span></span> <span data-ttu-id="3a063-107">Si vous spécifiez **null** pour le paramètre *lpSecurityAttributes* , le fichier ou le répertoire obtient un descripteur de sécurité par défaut.</span><span class="sxs-lookup"><span data-stu-id="3a063-107">If you specify **NULL** for the *lpSecurityAttributes* parameter, the file or directory gets a default security descriptor.</span></span> <span data-ttu-id="3a063-108">Les listes de contrôle d’accès (ACL) dans le descripteur de sécurité par défaut pour un fichier ou un répertoire sont héritées de son répertoire parent.</span><span class="sxs-lookup"><span data-stu-id="3a063-108">The access control lists (ACL) in the default security descriptor for a file or directory are inherited from its parent directory.</span></span> <span data-ttu-id="3a063-109">Notez qu’un descripteur de sécurité par défaut est affecté uniquement lorsqu’un fichier ou un répertoire est nouvellement créé, et non lorsqu’il est renommé ou déplacé.</span><span class="sxs-lookup"><span data-stu-id="3a063-109">Note that a default security descriptor is assigned only when a file or directory is newly created, and not when it is renamed or moved.</span></span>

<span data-ttu-id="3a063-110">Pour récupérer le descripteur de sécurité d’un objet de fichier ou de répertoire, appelez la fonction [**GetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa) ou [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) .</span><span class="sxs-lookup"><span data-stu-id="3a063-110">To retrieve the security descriptor of a file or directory object, call the [**GetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa) or [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) function.</span></span> <span data-ttu-id="3a063-111">Pour modifier le descripteur de sécurité d’un objet de fichier ou de répertoire, appelez la fonction [**SetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setnamedsecurityinfoa) ou [**SetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) .</span><span class="sxs-lookup"><span data-stu-id="3a063-111">To change the security descriptor of a file or directory object, call the [**SetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setnamedsecurityinfoa) or [**SetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) function.</span></span>

<span data-ttu-id="3a063-112">Les droits d’accès valides pour les fichiers et les répertoires sont les suivants : **supprimer**, lire le contrôle, **écrire \_ DAC**, écrire **\_ le** **\_ propriétaire** et **synchroniser** les [droits d’accès standard](/windows/desktop/SecAuthZ/standard-access-rights).</span><span class="sxs-lookup"><span data-stu-id="3a063-112">The valid access rights for files and directories include the **DELETE**, **READ\_CONTROL**, **WRITE\_DAC**, **WRITE\_OWNER**, and **SYNCHRONIZE** [standard access rights](/windows/desktop/SecAuthZ/standard-access-rights).</span></span> <span data-ttu-id="3a063-113">La table dans les [**constantes de droits d’accès aux**](file-access-rights-constants.md) fichiers répertorie les droits d’accès spécifiques aux fichiers et aux répertoires.</span><span class="sxs-lookup"><span data-stu-id="3a063-113">The table in [**File Access Rights Constants**](file-access-rights-constants.md) lists the access rights that are specific to files and directories.</span></span>

<span data-ttu-id="3a063-114">Bien que le droit d’accès **Synchronize** soit défini dans la liste des [droits d’accès standard](/windows/desktop/SecAuthZ/standard-access-rights) à la place d’un descripteur de fichier dans une des fonctions Wait, lors de l’utilisation d’opérations d’e/s de fichier asynchrones, vous devez attendre le handle d’événement contenu dans une structure [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) correctement configurée plutôt que d’utiliser le descripteur de fichier avec le droit d’accès **Synchronize** pour</span><span class="sxs-lookup"><span data-stu-id="3a063-114">Although the **SYNCHRONIZE** access right is defined within the [standard access rights](/windows/desktop/SecAuthZ/standard-access-rights) list as the right to specify a file handle in one of the wait functions, when using asynchronous file I/O operations you should wait on the event handle contained in a properly configured [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure rather than using the file handle with the **SYNCHRONIZE** access right for synchronization.</span></span>

<span data-ttu-id="3a063-115">Vous trouverez ci-dessous les [droits d’accès génériques](/windows/desktop/SecAuthZ/generic-access-rights) pour les fichiers et les répertoires.</span><span class="sxs-lookup"><span data-stu-id="3a063-115">The following are the [generic access rights](/windows/desktop/SecAuthZ/generic-access-rights) for files and directories.</span></span>



<table>
<thead>
<tr class="header">
<th><span data-ttu-id="3a063-116">Droit d’accès</span><span class="sxs-lookup"><span data-stu-id="3a063-116">Access right</span></span></th>
<th><span data-ttu-id="3a063-117">Description</span><span class="sxs-lookup"><span data-stu-id="3a063-117">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="3a063-118"><strong>FILE_GENERIC_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-118"><strong>FILE_GENERIC_EXECUTE</strong></span></span></td>
<td><dl> <span data-ttu-id="3a063-119"><strong>FILE_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-119"><strong>FILE_EXECUTE</strong></span></span><br /><span data-ttu-id="3a063-120">
<strong>FILE_READ_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-120">
<strong>FILE_READ_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="3a063-121">
<strong>STANDARD_RIGHTS_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-121">
<strong>STANDARD_RIGHTS_EXECUTE</strong></span></span><br /><span data-ttu-id="3a063-122">
<strong>SYNCHRONIZE</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-122">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
<tr class="even">
<td><span data-ttu-id="3a063-123"><strong>FILE_GENERIC_READ</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-123"><strong>FILE_GENERIC_READ</strong></span></span></td>
<td><dl> <span data-ttu-id="3a063-124"><strong>FILE_READ_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-124"><strong>FILE_READ_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="3a063-125">
<strong>FILE_READ_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-125">
<strong>FILE_READ_DATA</strong></span></span><br /><span data-ttu-id="3a063-126">
<strong>FILE_READ_EA</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-126">
<strong>FILE_READ_EA</strong></span></span><br /><span data-ttu-id="3a063-127">
<strong>STANDARD_RIGHTS_READ</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-127">
<strong>STANDARD_RIGHTS_READ</strong></span></span><br /><span data-ttu-id="3a063-128">
<strong>SYNCHRONIZE</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-128">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="3a063-129"><strong>FILE_GENERIC_WRITE</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-129"><strong>FILE_GENERIC_WRITE</strong></span></span></td>
<td><dl> <span data-ttu-id="3a063-130"><strong>FILE_APPEND_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-130"><strong>FILE_APPEND_DATA</strong></span></span><br /><span data-ttu-id="3a063-131">
<strong>FILE_WRITE_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-131">
<strong>FILE_WRITE_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="3a063-132">
<strong>FILE_WRITE_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-132">
<strong>FILE_WRITE_DATA</strong></span></span><br /><span data-ttu-id="3a063-133">
<strong>FILE_WRITE_EA</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-133">
<strong>FILE_WRITE_EA</strong></span></span><br /><span data-ttu-id="3a063-134">
<strong>STANDARD_RIGHTS_WRITE</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-134">
<strong>STANDARD_RIGHTS_WRITE</strong></span></span><br /><span data-ttu-id="3a063-135">
<strong>SYNCHRONIZE</strong></span><span class="sxs-lookup"><span data-stu-id="3a063-135">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="3a063-136">Windows compare les droits d’accès demandés et les informations contenues dans le jeton d’accès du thread aux informations contenues dans le descripteur de sécurité de l’objet de fichier ou de répertoire.</span><span class="sxs-lookup"><span data-stu-id="3a063-136">Windows compares the requested access rights and the information in the thread's access token with the information in the file or directory object's security descriptor.</span></span> <span data-ttu-id="3a063-137">Si la comparaison n’interdit pas l’octroi de tous les droits d’accès demandés, un descripteur de l’objet est renvoyé au thread et les droits d’accès sont accordés.</span><span class="sxs-lookup"><span data-stu-id="3a063-137">If the comparison does not prohibit all of the requested access rights from being granted, a handle to the object is returned to the thread and the access rights are granted.</span></span> <span data-ttu-id="3a063-138">Pour plus d’informations sur ce processus, consultez [interaction entre les threads et les objets sécurisables](/windows/desktop/SecAuthZ/interaction-between-threads-and-securable-objects).</span><span class="sxs-lookup"><span data-stu-id="3a063-138">For more information about this process, see [Interaction between Threads and Securable Objects](/windows/desktop/SecAuthZ/interaction-between-threads-and-securable-objects).</span></span>

<span data-ttu-id="3a063-139">Par défaut, l’autorisation d’accès à un fichier ou à un répertoire est contrôlée exclusivement par les listes de contrôle d’accès dans le descripteur de sécurité associé à ce fichier ou répertoire.</span><span class="sxs-lookup"><span data-stu-id="3a063-139">By default, authorization for access to a file or directory is controlled strictly by the ACLs in the security descriptor associated with that file or directory.</span></span> <span data-ttu-id="3a063-140">En particulier, le descripteur de sécurité d’un répertoire parent n’est pas utilisé pour contrôler l’accès aux fichiers ou répertoires enfants.</span><span class="sxs-lookup"><span data-stu-id="3a063-140">In particular, the security descriptor of a parent directory is not used to control access to any child file or directory.</span></span> <span data-ttu-id="3a063-141">Le [droit d’accès](/windows/desktop/SecAuthZ/access-rights-and-access-masks) au **\_ parcours du fichier** peut être appliqué en supprimant le [privilège](/windows/desktop/SecAuthZ/privileges) de **contournement du \_ \_ contrôle de parcours** des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="3a063-141">The **FILE\_TRAVERSE** [access right](/windows/desktop/SecAuthZ/access-rights-and-access-masks) can be enforced by removing the **BYPASS\_TRAVERSE\_CHECKING** [privilege](/windows/desktop/SecAuthZ/privileges) from users.</span></span> <span data-ttu-id="3a063-142">Cela n’est pas recommandé dans le cas général, car de nombreux programmes ne gèrent pas correctement les erreurs de traversée de répertoire.</span><span class="sxs-lookup"><span data-stu-id="3a063-142">This is not recommended in the general case, as many programs do not correctly handle directory traversal errors.</span></span> <span data-ttu-id="3a063-143">L’utilisation principale du droit d’accès au **\_ parcours des fichiers** sur les répertoires consiste à activer la conformité à certaines normes POSIX IEEE et ISO lorsque l’interopérabilité avec les systèmes UNIX est requise.</span><span class="sxs-lookup"><span data-stu-id="3a063-143">The primary use for the **FILE\_TRAVERSE** access right on directories is to enable conformance to certain IEEE and ISO POSIX standards when interoperability with Unix systems is a requirement.</span></span>

<span data-ttu-id="3a063-144">Le modèle de sécurité Windows permet à un répertoire enfant d’hériter d’une ou de plusieurs des entrées du descripteur de sécurité du répertoire parent ou de l’empêcher d’en hériter.</span><span class="sxs-lookup"><span data-stu-id="3a063-144">The Windows security model provides a way for a child directory to inherit, or to be prevented from inheriting, one or more of the ACEs in the parent directory's security descriptor.</span></span> <span data-ttu-id="3a063-145">Chaque entrée du contrôle d’accès contient des informations qui déterminent la façon dont elle peut être héritée, et si elle a un effet sur l’objet de l’annuaire qui hérite.</span><span class="sxs-lookup"><span data-stu-id="3a063-145">Each ACE contains information that determines how it can be inherited, and whether it will have an effect on the inheriting directory object.</span></span> <span data-ttu-id="3a063-146">Par exemple, certaines ACE héritées contrôlent l’accès à l’objet d’annuaire hérité, et celles-ci sont appelées *ACE effectives*.</span><span class="sxs-lookup"><span data-stu-id="3a063-146">For example, some inherited ACEs control access to the inherited directory object, and these are called *effective ACEs*.</span></span> <span data-ttu-id="3a063-147">Toutes les autres entrées de du même nom sont appelées *ACE d’héritage uniquement*.</span><span class="sxs-lookup"><span data-stu-id="3a063-147">All other ACEs are called *inherit-only ACEs*.</span></span>

<span data-ttu-id="3a063-148">Le modèle de sécurité Windows applique également l’héritage automatique des entrées de contrôle d’accès (ACE) aux objets enfants en fonction des [règles d’héritage ACE](/windows/desktop/SecAuthZ/ace-inheritance-rules).</span><span class="sxs-lookup"><span data-stu-id="3a063-148">The Windows security model also enforces the automatic inheritance of ACEs to child objects according to the [ACE inheritance rules](/windows/desktop/SecAuthZ/ace-inheritance-rules).</span></span> <span data-ttu-id="3a063-149">Cet héritage automatique, ainsi que les informations d’héritage de chaque ACE, déterminent la façon dont les restrictions de sécurité sont transmises dans la hiérarchie de répertoires.</span><span class="sxs-lookup"><span data-stu-id="3a063-149">This automatic inheritance, along with the inheritance information in each ACE, determines how security restrictions are passed down the directory hierarchy.</span></span>

<span data-ttu-id="3a063-150">Notez que vous ne pouvez pas utiliser une entrée du contrôle d’accès refusé pour refuser uniquement l’accès **\_ en** **\_ écriture** générique ou générique à un fichier.</span><span class="sxs-lookup"><span data-stu-id="3a063-150">Note that you cannot use an access-denied ACE to deny only **GENERIC\_READ** or only **GENERIC\_WRITE** access to a file.</span></span> <span data-ttu-id="3a063-151">En effet, pour les objets file, les mappages génériques pour **la \_ lecture générique** ou l' **\_ écriture générique** incluent le droit d’accès **Synchronize** .</span><span class="sxs-lookup"><span data-stu-id="3a063-151">This is because for file objects, the generic mappings for both **GENERIC\_READ** or **GENERIC\_WRITE** include the **SYNCHRONIZE** access right.</span></span> <span data-ttu-id="3a063-152">Si une entrée de contrôle d’accès refuse l’accès en **\_ écriture générique** à un tiers de confiance et que le tiers de confiance demande l’accès **\_ en lecture générique** , la demande échoue, car la demande comprend implicitement l’accès de **synchronisation** qui est implicitement refusé par l’entrée du contrôle d’accès, et vice versa.</span><span class="sxs-lookup"><span data-stu-id="3a063-152">If an ACE denies **GENERIC\_WRITE** access to a trustee, and the trustee requests **GENERIC\_READ** access, the request will fail because the request implicitly includes **SYNCHRONIZE** access which is implicitly denied by the ACE, and vice versa.</span></span> <span data-ttu-id="3a063-153">Au lieu d’utiliser des ACE d’accès refusé, utilisez des ACE access-allowed pour accorder explicitement les droits d’accès autorisés.</span><span class="sxs-lookup"><span data-stu-id="3a063-153">Instead of using access-denied ACEs, use access-allowed ACEs to explicitly allow the permitted access rights.</span></span>

<span data-ttu-id="3a063-154">Le chiffrement est un autre moyen de gérer l’accès aux objets de stockage.</span><span class="sxs-lookup"><span data-stu-id="3a063-154">Another means of managing access to storage objects is encryption.</span></span> <span data-ttu-id="3a063-155">L’implémentation du chiffrement du système de fichiers dans Windows est le système de fichiers chiffré ou EFS.</span><span class="sxs-lookup"><span data-stu-id="3a063-155">The implementation of file system encryption in Windows is the Encrypted File System, or EFS.</span></span> <span data-ttu-id="3a063-156">EFS chiffre uniquement les fichiers et non les répertoires.</span><span class="sxs-lookup"><span data-stu-id="3a063-156">EFS encrypts only files and not directories.</span></span> <span data-ttu-id="3a063-157">L’avantage du chiffrement est qu’il offre une protection supplémentaire aux fichiers qui sont appliqués sur le support et non par le biais du système de fichiers et de l’architecture de contrôle d’accès Windows standard.</span><span class="sxs-lookup"><span data-stu-id="3a063-157">The advantage of encryption is that it provides additional protection to files that is applied on the media and not through the file system and the standard Windows access control architecture.</span></span> <span data-ttu-id="3a063-158">Pour plus d’informations sur le chiffrement des fichiers, consultez [chiffrement de fichier](file-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="3a063-158">For more information on file encryption, see [File Encryption](file-encryption.md).</span></span>

<span data-ttu-id="3a063-159">Dans la plupart des cas, la capacité de lire et d’écrire les paramètres de sécurité d’un objet de fichier ou de répertoire est limitée aux processus en mode noyau.</span><span class="sxs-lookup"><span data-stu-id="3a063-159">In most cases, the ability to read and write the security settings of a file or directory object is restricted to kernel-mode processes.</span></span> <span data-ttu-id="3a063-160">En clair, vous ne souhaitez pas que le processus utilisateur soit en mesure de modifier la propriété ou la restriction d’accès sur votre fichier ou Répertoire privé.</span><span class="sxs-lookup"><span data-stu-id="3a063-160">Clearly, you would not want any user process to be able to change the ownership or access restriction on your private file or directory.</span></span> <span data-ttu-id="3a063-161">Toutefois, une application de sauvegarde ne peut pas terminer son travail de sauvegarde de votre fichier si les restrictions d’accès que vous avez placées sur votre fichier ou répertoire n’autorisent pas le processus en mode utilisateur de l’application à le lire.</span><span class="sxs-lookup"><span data-stu-id="3a063-161">However, a backup application would not be able to complete its job of backing up your file if the access restrictions you have placed on your file or directory does not allow the application's user-mode process to read it.</span></span> <span data-ttu-id="3a063-162">Les applications de sauvegarde doivent être en mesure de remplacer les paramètres de sécurité des objets de fichier et d’annuaire pour garantir une sauvegarde complète.</span><span class="sxs-lookup"><span data-stu-id="3a063-162">Backup applications must be able to override the security settings of file and directory objects to ensure a complete backup.</span></span> <span data-ttu-id="3a063-163">De même, si une application de sauvegarde tente d’écrire une copie de sauvegarde de votre fichier sur la copie résidant sur le disque, et que vous refusez explicitement des privilèges d’écriture au processus de l’application de sauvegarde, l’opération de restauration ne peut pas se terminer.</span><span class="sxs-lookup"><span data-stu-id="3a063-163">Similarly, if a backup application attempts to write a backup copy of your file over the disk-resident copy, and you explicitly deny write privileges to the backup application process, the restore operation cannot complete.</span></span> <span data-ttu-id="3a063-164">Dans ce cas également, l’application de sauvegarde doit être en mesure de remplacer les paramètres de contrôle d’accès de votre fichier.</span><span class="sxs-lookup"><span data-stu-id="3a063-164">In this case also, the backup application must be able to override the access control settings of your file.</span></span>

<span data-ttu-id="3a063-165">Le **\_ \_ nom** de la sauvegarde de se et les privilèges d’accès au nom de la **\_ restauration \_ se** ont été créés spécifiquement pour fournir cette possibilité de sauvegarder des applications.</span><span class="sxs-lookup"><span data-stu-id="3a063-165">The **SE\_BACKUP\_NAME** and **SE\_RESTORE\_NAME** access privileges were specifically created to provide this ability to backup applications.</span></span> <span data-ttu-id="3a063-166">Si ces privilèges ont été accordés et activés dans le jeton d’accès du processus d’application de sauvegarde, il peut appeler [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) pour ouvrir votre fichier ou répertoire pour la sauvegarde, en spécifiant le droit d’accès de **\_ contrôle de lecture** standard comme valeur du paramètre *dwDesiredAccess* .</span><span class="sxs-lookup"><span data-stu-id="3a063-166">If these privileges have been granted and enabled in the access token of the backup application process, it can then call [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) to open your file or directory for backup, specifying the standard **READ\_CONTROL** access right as the value of the *dwDesiredAccess* parameter.</span></span> <span data-ttu-id="3a063-167">Toutefois, pour identifier le processus appelant comme un processus de sauvegarde, l’appel à **CreateFile** doit inclure l’indicateur de sémantique de sauvegarde de l' **\_ indicateur de \_ \_ fichier** dans le paramètre *dwFlagsAndAttributes* .</span><span class="sxs-lookup"><span data-stu-id="3a063-167">However, to identify the calling process as a backup process, the call to **CreateFile** must include the **FILE\_FLAG\_BACKUP\_SEMANTICS** flag in the *dwFlagsAndAttributes* parameter.</span></span> <span data-ttu-id="3a063-168">La syntaxe complète de l’appel de fonction est la suivante :</span><span class="sxs-lookup"><span data-stu-id="3a063-168">The full syntax of the function call is the following:</span></span>


```C++
HANDLE hFile = CreateFile( fileName,                   // lpFileName
                           READ_CONTROL,               // dwDesiredAccess
                           0,                          // dwShareMode
                           NULL,                       // lpSecurityAttributes
                           OPEN_EXISTING,              // dwCreationDisposition
                           FILE_FLAG_BACKUP_SEMANTICS, // dwFlagsAndAttributes
                           NULL );                     // hTemplateFile
```



<span data-ttu-id="3a063-169">Cela permettra au processus de l’application de sauvegarde d’ouvrir votre fichier et de remplacer la vérification de sécurité standard.</span><span class="sxs-lookup"><span data-stu-id="3a063-169">This will allow the backup application process to open your file and override the standard security checking.</span></span> <span data-ttu-id="3a063-170">Pour restaurer votre fichier, l’application de sauvegarde utilise la syntaxe d’appel [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) suivante lors de l’ouverture de votre fichier à écrire.</span><span class="sxs-lookup"><span data-stu-id="3a063-170">To restore your file, the backup application would use the following [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) call syntax when opening your file to be written.</span></span>


```C++
HANDLE hFile = CreateFile( fileName,                   // lpFileName
                           WRITE_OWNER | WRITE_DAC,    // dwDesiredAccess
                           0,                          // dwShareMode
                           NULL,                       // lpSecurityAttributes
                           CREATE_ALWAYS,              // dwCreationDisposition
                           FILE_FLAG_BACKUP_SEMANTICS, // dwFlagsAndAttributes
                           NULL );                     // hTemplateFile
```



<span data-ttu-id="3a063-171">Dans certaines situations, une application de sauvegarde doit être en mesure de modifier les paramètres de contrôle d’accès d’un fichier ou d’un répertoire.</span><span class="sxs-lookup"><span data-stu-id="3a063-171">There are situations when a backup application must be able to change the access control settings of a file or directory.</span></span> <span data-ttu-id="3a063-172">C’est le cas, par exemple, lorsque les paramètres de contrôle d’accès de la copie résidant sur le disque d’un fichier ou d’un répertoire sont différents de la copie de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="3a063-172">An example is when the access control settings of the disk-resident copy of a file or directory is different from the backup copy.</span></span> <span data-ttu-id="3a063-173">Cela se produit si ces paramètres ont été modifiés après la sauvegarde du fichier ou du répertoire, ou s’ils ont été endommagés.</span><span class="sxs-lookup"><span data-stu-id="3a063-173">This would happen if these settings were changed after the file or directory was backed up, or if it was corrupted.</span></span>

<span data-ttu-id="3a063-174">L’indicateur de la sémantique de sauvegarde de l’indicateur de fichier spécifié dans l’appel à [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) donne au processus d’application de sauvegarde l’autorisation de lire les paramètres de contrôle d’accès du fichier ou du répertoire. **\_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="3a063-174">The **FILE\_FLAG\_BACKUP\_SEMANTICS** flag specified in the call to [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) gives the backup application process permission to read the access-control settings of the file or directory.</span></span> <span data-ttu-id="3a063-175">Avec cette autorisation, le processus d’application de sauvegarde peut ensuite appeler [**GetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getkernelobjectsecurity) et [**SetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-setkernelobjectsecurity) pour lire et réinitialiser les paramètres de contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="3a063-175">With this permission, the backup application process can then call [**GetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getkernelobjectsecurity) and [**SetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-setkernelobjectsecurity) to read and than reset the access-control settings.</span></span>

<span data-ttu-id="3a063-176">Si une application de sauvegarde doit avoir accès aux [paramètres de contrôle d’accès](/windows/desktop/SecAuthZ/access-control-lists)au niveau système, l’indicateur d’accès de **\_ \_ sécurité système** doit être spécifié dans la valeur de paramètre *dwDesiredAccess* transmise à [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea).</span><span class="sxs-lookup"><span data-stu-id="3a063-176">If a backup application must have access to the system-level [access control settings](/windows/desktop/SecAuthZ/access-control-lists), the **ACCESS\_SYSTEM\_SECURITY** flag must be specified in the *dwDesiredAccess* parameter value passed to [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea).</span></span>

<span data-ttu-id="3a063-177">Les applications de sauvegarde appellent [**BackupRead**](/windows/desktop/api/winbase/nf-winbase-backupread) pour lire les fichiers et répertoires spécifiés pour l’opération de restauration, et [**BackupWrite**](/windows/desktop/api/winbase/nf-winbase-backupwrite) pour les écrire.</span><span class="sxs-lookup"><span data-stu-id="3a063-177">Backup applications call [**BackupRead**](/windows/desktop/api/winbase/nf-winbase-backupread) to read the files and directories specified for the restore operation, and [**BackupWrite**](/windows/desktop/api/winbase/nf-winbase-backupwrite) to write them.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3a063-178">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="3a063-178">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3a063-179">droits d’accès standard</span><span class="sxs-lookup"><span data-stu-id="3a063-179">standard access rights</span></span>](/windows/desktop/SecAuthZ/standard-access-rights)
</dt> </dl>

 

 
