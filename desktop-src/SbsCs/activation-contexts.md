---
description: Les contextes d’activation sont des structures de données en mémoire qui contiennent des informations que le système peut utiliser pour rediriger une application afin de charger une version de DLL particulière, une instance d’objet COM ou une version de fenêtre personnalisée.
ms.assetid: 5416f8c0-d99b-4a5d-a689-a47bd0cf1a88
title: Contextes d’activation
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f1f20d747f63ba71eee73fc17c0d5543003e5f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104319109"
---
# <a name="activation-contexts"></a><span data-ttu-id="10b66-103">Contextes d’activation</span><span class="sxs-lookup"><span data-stu-id="10b66-103">Activation Contexts</span></span>

<span data-ttu-id="10b66-104">Les [*contextes d’activation*](a-sbscs-gly.md) sont des structures de données en mémoire qui contiennent des informations que le système peut utiliser pour rediriger une application afin de charger une version de dll particulière, une instance d’objet com ou une version de fenêtre personnalisée.</span><span class="sxs-lookup"><span data-stu-id="10b66-104">[*Activation contexts*](a-sbscs-gly.md) are data structures in memory containing information that the system can use to redirect an application to load a particular DLL version, COM object instance, or custom window version.</span></span> <span data-ttu-id="10b66-105">Une section du contexte d’activation peut contenir des informations de redirection de DLL qui sont utilisées par le chargeur de DLL. une autre section peut contenir des informations sur le serveur COM.</span><span class="sxs-lookup"><span data-stu-id="10b66-105">One section of the activation context may contain DLL redirection information which is used by the DLL loader; another section may contain COM server information.</span></span> <span data-ttu-id="10b66-106">Les fonctions de contexte d’activation utilisent, créent, activent et désactivent des contextes d’activation.</span><span class="sxs-lookup"><span data-stu-id="10b66-106">The activation context functions use, create, activate, and deactivate activation contexts.</span></span> <span data-ttu-id="10b66-107">Les fonctions d’activation peuvent rediriger la liaison d’une application vers des objets de version nommée qui spécifient des versions de DLL, des classes de fenêtre, des serveurs COM, des bibliothèques de types et des interfaces spécifiques.</span><span class="sxs-lookup"><span data-stu-id="10b66-107">The activation functions can redirect the binding of an application to version-named objects that specify particular DLL versions, window classes, COM servers, type libraries, and interfaces.</span></span> <span data-ttu-id="10b66-108">Pour plus d’informations sur les structures et les fonctions de contexte d’activation, consultez la [Référence du contexte d’activation](activation-context-reference.md).</span><span class="sxs-lookup"><span data-stu-id="10b66-108">For more information about the activation context functions and structures, see the [Activation Context Reference](activation-context-reference.md).</span></span>

<span data-ttu-id="10b66-109">À partir de Windows XP, les fonctions de contexte d’activation permettent à Windows d’utiliser des informations dans les [manifestes](manifests.md) pour créer des objets de nom de version.</span><span class="sxs-lookup"><span data-stu-id="10b66-109">Beginning with Windows XP, activation context functions enable Windows to use information in [manifests](manifests.md) to create version-named objects.</span></span> <span data-ttu-id="10b66-110">Si une application crée un processus en appelant [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows vérifie l’existence d’un [manifeste d’application](application-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="10b66-110">If an application creates a process by calling [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows checks for the existence of an [application manifest](application-manifests.md).</span></span> <span data-ttu-id="10b66-111">Si un manifeste existe, Windows utilise les informations du manifeste pour remplir le contexte d’activation.</span><span class="sxs-lookup"><span data-stu-id="10b66-111">If a manifest exists, Windows uses the information in the manifest to populate the activation context.</span></span> <span data-ttu-id="10b66-112">Étant donné que les manifestes décrivent la dépendance d’une application vis-à-vis des versions d' [assembly côte à côte](about-side-by-side-assemblies-.md) , les objets spécifiés sans versions dans le manifeste sont mappés aux objets de version nommée.</span><span class="sxs-lookup"><span data-stu-id="10b66-112">Because manifests describe an application's dependence on [side-by-side assembly](about-side-by-side-assemblies-.md) versions, objects specified without versions in the manifest are mapped to version-named objects.</span></span> <span data-ttu-id="10b66-113">Par exemple, le manifeste peut décrire des dll, des fichiers, des classes de fenêtre, des serveurs COM, des bibliothèques de types et des interfaces.</span><span class="sxs-lookup"><span data-stu-id="10b66-113">For example, the manifest may describe DLLs, files, window classes, COM servers, type libraries, and interfaces.</span></span>

<span data-ttu-id="10b66-114">Lorsqu’un objet global est créé dans le contexte d’activation, le système attribue automatiquement à l’objet un nom spécifique à la version en consultant le manifeste.</span><span class="sxs-lookup"><span data-stu-id="10b66-114">When a global object is created within the activation context, the system automatically gives the object a version-specific name by consulting the manifest.</span></span> <span data-ttu-id="10b66-115">Lorsque l’application s’exécute et demande un objet nommé, elle obtient l’objet de nom de version.</span><span class="sxs-lookup"><span data-stu-id="10b66-115">When the application executes and requests a named object, it gets the version-named object.</span></span> <span data-ttu-id="10b66-116">Cela permet à plusieurs versions d’un module de code de s’exécuter sur le système en même temps sans interférer entre eux.</span><span class="sxs-lookup"><span data-stu-id="10b66-116">This enables multiple versions of a code module to run on the system at the same time without interfering with each other.</span></span> <span data-ttu-id="10b66-117">Par exemple, le [shell Windows](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) utilise un manifeste pour décrire une dépendance à la version 6,0 de ComCtl32 et pour créer des versions de classes de fenêtres.</span><span class="sxs-lookup"><span data-stu-id="10b66-117">For example, [Windows Shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) uses a manifest to describe a dependence on version 6.0 of COMCTL32 and to create versions of window classes.</span></span>

<span data-ttu-id="10b66-118">Si une application crée une ressource en appelant [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), le processus spécifie un nom de classe pour cette fonction.</span><span class="sxs-lookup"><span data-stu-id="10b66-118">If an application creates a resource by calling [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), the process specifies a class name to that function.</span></span> <span data-ttu-id="10b66-119">L’appel à [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) obtient le contexte d’activation actuel et vérifie s’il existe un mappage pour le nom de classe donné.</span><span class="sxs-lookup"><span data-stu-id="10b66-119">The call to [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) gets the current activation context and checks to see if a mapping exists for the given class name.</span></span> <span data-ttu-id="10b66-120">Si un mappage existe, il utilise cette version du processus appelant pour résoudre le mappage et fournir le nom de classe spécifique à la version.</span><span class="sxs-lookup"><span data-stu-id="10b66-120">If a mapping exists, it will use that version of the calling process to resolve the mapping and provide the version-specific class name.</span></span> <span data-ttu-id="10b66-121">Windows crée une fenêtre avec la procédure de fenêtre, les styles et d’autres attributs associés à ce nom de classe et à cette version.</span><span class="sxs-lookup"><span data-stu-id="10b66-121">Windows creates a window with the window procedure, styles, and other attributes associated with that class name and version.</span></span>

<span data-ttu-id="10b66-122">Le contexte d’activation est géré par le système dans la plupart des cas.</span><span class="sxs-lookup"><span data-stu-id="10b66-122">The activation context is managed by the system in most cases.</span></span> <span data-ttu-id="10b66-123">Les développeurs d’applications et les fournisseurs d’assemblys n’ont généralement pas besoin d’effectuer des appels à la pile.</span><span class="sxs-lookup"><span data-stu-id="10b66-123">Application developers and assembly providers do not commonly need to make calls to the stack.</span></span> <span data-ttu-id="10b66-124">Les applications peuvent gérer un contexte d’activation en appelant directement le contexte d’activation.</span><span class="sxs-lookup"><span data-stu-id="10b66-124">Applications can manage an activation context by directly calling the activation context.</span></span> <span data-ttu-id="10b66-125">Pour plus d’informations, consultez [utilisation de l’API de contexte d’activation](using-the-activation-context-api.md).</span><span class="sxs-lookup"><span data-stu-id="10b66-125">For more information, see [Using the Activation Context API](using-the-activation-context-api.md).</span></span>

 

 
