---
description: La redirection DLL/COM est une stratégie d’isolation d’application utilisée par les administrateurs d’entreprise sur Windows XP.
ms.assetid: 5bbb0bee-d457-4dfa-93a0-82537fe11f2d
title: Redirection DLL/COM sur Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e356c7b4cc6e5616a03eba60439c7478d65e626a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103867269"
---
# <a name="dllcom-redirection-on-windows"></a><span data-ttu-id="6df26-103">Redirection DLL/COM sur Windows</span><span class="sxs-lookup"><span data-stu-id="6df26-103">DLL/COM Redirection on Windows</span></span>

<span data-ttu-id="6df26-104">La redirection DLL/COM est une stratégie d’isolation d’application utilisée par les administrateurs d’entreprise sur Windows XP.</span><span class="sxs-lookup"><span data-stu-id="6df26-104">DLL/COM redirection is an application isolation strategy employed by corporate administrators on Windows XP.</span></span>

<span data-ttu-id="6df26-105">\* \* Windows Server 2008, Windows Vista, Windows Server 2003 et Windows XP avec SP2 : \* \* l’utilisation de stratégies de redirection DLL/COM n’est pas recommandée, car les applications isolées qui utilisent des manifestes et des [assemblys côte à côte](about-side-by-side-assemblies-.md) peuvent être plus faciles à mettre à jour et à traiter.</span><span class="sxs-lookup"><span data-stu-id="6df26-105">\*\*Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP with SP2:  \*\* The use of DLL/COM redirection strategies is not recommended because isolated applications that use manifests and [side-by-side assemblies](about-side-by-side-assemblies-.md) can be easier to update and service.</span></span> <span data-ttu-id="6df26-106">La présence d’un fichier. local est ignorée si un manifeste est présent.</span><span class="sxs-lookup"><span data-stu-id="6df26-106">The presence of a .local file is ignored if a manifest is present.</span></span> <span data-ttu-id="6df26-107">La stratégie de redirection DLL/COM à l’aide des fichiers. local fonctionne si l’application n’a pas de manifeste.</span><span class="sxs-lookup"><span data-stu-id="6df26-107">The DLL/COM Redirection strategy using .local files works if the application does not have a manifest.</span></span>

<span data-ttu-id="6df26-108">La redirection DLL/COM lie une application à une version locale d’un composant.</span><span class="sxs-lookup"><span data-stu-id="6df26-108">DLL/COM redirection binds an application to a local version of a component.</span></span> <span data-ttu-id="6df26-109">Les fichiers du composant local peuvent être conservés séparément de la version du système du composant à un emplacement privé pour l’application.</span><span class="sxs-lookup"><span data-stu-id="6df26-109">The local component's files can be kept separate from the system's version of the component in a location that is private to the application.</span></span> <span data-ttu-id="6df26-110">La version du système du composant est inscrite globalement et disponible pour toutes les autres applications qui y sont liées.</span><span class="sxs-lookup"><span data-stu-id="6df26-110">The system's version of the component is globally registered and available to any other applications that bind to it.</span></span> <span data-ttu-id="6df26-111">La version locale du composant est réservée à l’utilisation exclusive de l’application.</span><span class="sxs-lookup"><span data-stu-id="6df26-111">The local version of the component is reserved for the exclusive use of the application.</span></span> <span data-ttu-id="6df26-112">Si nécessaire, les fichiers de composants utilisés par l’application peuvent être chargés en mémoire en même temps que les fichiers de composants du système.</span><span class="sxs-lookup"><span data-stu-id="6df26-112">If necessary, the component files used by the application can be loaded into memory at the same time as the system's component files.</span></span>

<span data-ttu-id="6df26-113">La redirection DLL/COM est activée en installant un fichier spécial avec une copie du fichier de composant local dans le même répertoire que le fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="6df26-113">DLL/COM redirection is activated by installing a special file along with a copy of the local component file into the same directory as the application's executable file.</span></span> <span data-ttu-id="6df26-114">Le fichier spécial est un fichier vide nommé d’après le nom de fichier de l’exécutable de l’application et ajouté avec. local.</span><span class="sxs-lookup"><span data-stu-id="6df26-114">The special file is an empty file named after the application executable's file name and appended with .local.</span></span> <span data-ttu-id="6df26-115">Par exemple, pour activer la redirection DLL/COM pour une application nommée MyApp, la version locale du composant et un fichier vide nommé Myapp.exe. local doivent être copiés dans le dossier contenant Myapp.exe.</span><span class="sxs-lookup"><span data-stu-id="6df26-115">For example, to activate DLL/COM redirection for an application named Myapp, the local version of the component and an empty file named Myapp.exe.local must be copied into the folder containing Myapp.exe.</span></span> <span data-ttu-id="6df26-116">Cela permet de lier l’application à la version locale du composant plutôt qu’à la version globale partagée du composant.</span><span class="sxs-lookup"><span data-stu-id="6df26-116">This binds the application to the local version of the component rather than the globally shared version of the component.</span></span>

<span data-ttu-id="6df26-117">Quand une application charge un fichier de composant, tel qu’un fichier DLL ou. ocx, Windows commence par la recherche dans le dossier où le fichier. local et exécutable de l’application est installé.</span><span class="sxs-lookup"><span data-stu-id="6df26-117">When an application loads a component file, such as a DLL or .ocx file, Windows first searches for it in the folder where the application's .local and executable file is installed.</span></span> <span data-ttu-id="6df26-118">S’il est trouvé, l’application utilise ce fichier de composant quel que soit le chemin de recherche de répertoire défini dans l’application ou le registre.</span><span class="sxs-lookup"><span data-stu-id="6df26-118">If found, the application uses that component file regardless of any directory search path defined in the application or the registry.</span></span> <span data-ttu-id="6df26-119">S’il est introuvable, le fichier composant dans le chemin de recherche défini est utilisé.</span><span class="sxs-lookup"><span data-stu-id="6df26-119">If not found, the component file in the defined search path is used.</span></span>

<span data-ttu-id="6df26-120">L’utilitaire d’installation doit effectuer les opérations suivantes pour installer l’application à l’aide de la redirection DLL/COM :</span><span class="sxs-lookup"><span data-stu-id="6df26-120">The installation utility must do the following to install the application with DLL/COM redirection:</span></span>

-   <span data-ttu-id="6df26-121">Un fichier. local vide doit être copié dans le même dossier que le fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="6df26-121">An empty .local file must be copied into the same folder as the application's executable file.</span></span>
-   <span data-ttu-id="6df26-122">Tous les composants, DLL et fichiers. ocx utilisés par l’application doivent être copiés dans le même dossier que le fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="6df26-122">All of the components, DLL, and .ocx files used by the application must be copied into the same folder as the application's executable file.</span></span>
-   <span data-ttu-id="6df26-123">Les composants COM isolés doivent être inscrits auprès de Windows afin que les différentes versions de l’assembly n’entrent pas en conflit les unes avec les autres lorsqu’elles sont chargées en mémoire en même temps.</span><span class="sxs-lookup"><span data-stu-id="6df26-123">Isolated COM components must be registered with Windows so that different versions of the assembly will not conflict with each other when loaded into memory at the same time.</span></span> <span data-ttu-id="6df26-124">Le processus d’inscription requiert que, bien que l’implémentation du composant puisse changer d’une version à l’autre, certaines métadonnées COM telles que le CLSID, le ProgID, la bibliothèque de types et le modèle de thread ne peuvent pas.</span><span class="sxs-lookup"><span data-stu-id="6df26-124">The registration process requires that, while the implementation of the component can change between versions, certain COM metadata such as CLSID, ProgID, Type Library, and Threading Model cannot.</span></span>
-   <span data-ttu-id="6df26-125">Si l’application est installée à l’aide de la Windows Installer, le répertoire de l’application peut être sécurisé à l’aide de la table LockPermissions.</span><span class="sxs-lookup"><span data-stu-id="6df26-125">If the application is installed using the Windows Installer, then the application directory can be secured by using the LockPermissions table.</span></span> <span data-ttu-id="6df26-126">En règle générale, le système reçoit un accès en lecture, écriture et exécution ; tous les autres processus sont fournis uniquement pour l’accès en lecture et en lecture.</span><span class="sxs-lookup"><span data-stu-id="6df26-126">Typically, the system is given read, write, and execute access; all other processes are given only execute and read access.</span></span>

 

 



