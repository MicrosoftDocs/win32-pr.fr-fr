---
description: Les contextes d’activation sont visibles tout au long du processus.
ms.assetid: 6eda00d5-9dac-4267-bf61-b481814201f8
title: Threads, procédures asynchrones et messages de fenêtre
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e615eb9795ba32bcf4bd227a4933e890e9b89055
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103862329"
---
# <a name="using-threads-asynchronous-procedures-and-window-messages"></a><span data-ttu-id="1853f-103">Utilisation de threads, de procédures asynchrones et de messages de fenêtre</span><span class="sxs-lookup"><span data-stu-id="1853f-103">Using Threads, Asynchronous Procedures, and Window Messages</span></span>

<span data-ttu-id="1853f-104">Les contextes d’activation sont visibles tout au long du processus.</span><span class="sxs-lookup"><span data-stu-id="1853f-104">Activation contexts are visible throughout the entire process.</span></span> <span data-ttu-id="1853f-105">Les piles de contexte d’activation sont toutefois par thread, et deux threads dans le même processus peuvent avoir des piles d’activation différentes.</span><span class="sxs-lookup"><span data-stu-id="1853f-105">The activation context stacks are however per-thread, and two threads in the same process can have different activation stacks.</span></span> <span data-ttu-id="1853f-106">[**CreateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread) place automatiquement le contexte d’activation actuel en haut de la pile d’activation du nouveau thread.</span><span class="sxs-lookup"><span data-stu-id="1853f-106">[**CreateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread) automatically puts the current activation context at the top of the new thread's activation stack.</span></span> <span data-ttu-id="1853f-107">Cela peut faciliter la mise à niveau du code existant pour utiliser des composants côte à côte, car le nouveau thread peut s’exécuter immédiatement dans le contexte d’activation actuel.</span><span class="sxs-lookup"><span data-stu-id="1853f-107">This can facilitate upgrading existing code to use side-by-side components because the new thread can run immediately in the current activation context.</span></span>

<span data-ttu-id="1853f-108">Les appels de procédure asynchrone, les rappels de port de terminaison et tous les autres rappels sur d’autres threads obtiennent automatiquement le contexte d’activation de la source.</span><span class="sxs-lookup"><span data-stu-id="1853f-108">Asynchronous procedure calls, completion port callbacks, and any other callbacks on other threads automatically get the activation context of the source.</span></span> <span data-ttu-id="1853f-109">Lorsque le rappel est appelé, la pile d’activation est nettoyée.</span><span class="sxs-lookup"><span data-stu-id="1853f-109">When the callback is called, the activation stack is cleaned up.</span></span> <span data-ttu-id="1853f-110">Cela signifie que votre application peut utiliser des appels de procédure asynchrones et des rappels sans activer explicitement les contextes, car la gestion du contexte est effectuée par l’infrastructure côte à côte sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="1853f-110">This means that your application can use asynchronous procedure calls and callbacks without explicitly activating any contexts because context management will be done by the underlying side-by-side infrastructure.</span></span> <span data-ttu-id="1853f-111">Pour que d’autres contextes soient actifs pendant un rappel ou un nouveau thread, votre application peut effectuer sa propre gestion de contexte.</span><span class="sxs-lookup"><span data-stu-id="1853f-111">To make other contexts active during a callback or new thread, your application can do its own context management.</span></span> <span data-ttu-id="1853f-112">Dans ce cas, votre programme doit utiliser la séquence correcte des fonctions activation du contexte d’activation et désactiver les fonctions.</span><span class="sxs-lookup"><span data-stu-id="1853f-112">In this case your program must use the proper sequence of activation context activate functions and deactivate functions.</span></span>

<span data-ttu-id="1853f-113">Les contextes d’activation sont indépendants du thread.</span><span class="sxs-lookup"><span data-stu-id="1853f-113">Activation contexts are thread-neutral.</span></span> <span data-ttu-id="1853f-114">L’activation d’un contexte modifie uniquement la pile du thread actuel et vous ne pouvez pas activer un contexte entre les threads.</span><span class="sxs-lookup"><span data-stu-id="1853f-114">Activating a context only changes the current thread's stack, and you cannot activate a context across threads.</span></span> <span data-ttu-id="1853f-115">Le thread A ne peut pas forcer un contexte sur le thread B. Les fonctions de l’API de contexte d’activation prennent également en charge les threads.</span><span class="sxs-lookup"><span data-stu-id="1853f-115">Thread A cannot force a context onto thread B. The functions of the activation context API are also threading-aware.</span></span>

<span data-ttu-id="1853f-116">Quand vous utilisez [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) ou [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) pour envoyer un message de fenêtre à une autre procédure de fenêtre dans votre processus, le contexte d’activation actuel est activé avant que le message ne soit passé à la procédure cible.</span><span class="sxs-lookup"><span data-stu-id="1853f-116">When you use [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) or [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) to send a window message to another window procedure in your process, the current activation context is activated before the message is passed on to the target procedure.</span></span> <span data-ttu-id="1853f-117">Le contexte d’activation actuel est associé au message.</span><span class="sxs-lookup"><span data-stu-id="1853f-117">The current activation context goes along with the message.</span></span> <span data-ttu-id="1853f-118">Cela permet de s’assurer que les messages qui font référence à des objets COM, aux noms de DLL ou à d’autres ressources côte à côte conservent leurs informations de contexte correctes.</span><span class="sxs-lookup"><span data-stu-id="1853f-118">This ensures that messages that refer to COM objects, DLL names, or other side-by-side resources retain their correct context information.</span></span>

 

 
