---
description: Les contextes d’activation permettent d’utiliser des objets COM sans qu’il soit nécessaire de les inscrire.
ms.assetid: e6ec7b8b-8032-4dff-8f96-07ae3ffc286d
title: Création d’objets Registration-Free COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70e377a04f44e6624294116b8274a8dcc1e82b8e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106544928"
---
# <a name="creating-registration-free-com-objects"></a><span data-ttu-id="64292-103">Création d’objets Registration-Free COM</span><span class="sxs-lookup"><span data-stu-id="64292-103">Creating Registration-Free COM Objects</span></span>

<span data-ttu-id="64292-104">Les contextes d’activation permettent d’utiliser des objets COM sans qu’il soit nécessaire de les inscrire.</span><span class="sxs-lookup"><span data-stu-id="64292-104">Activation contexts enable COM objects to be used without requiring that they be registered.</span></span> <span data-ttu-id="64292-105">Cela permet à votre application d’avoir plusieurs composants avec des fonctionnalités différentes en fonction de leur version plutôt que de leurs informations de registre.</span><span class="sxs-lookup"><span data-stu-id="64292-105">This enables your application to have multiple components with different functionality based upon their version rather than their registry information.</span></span> <span data-ttu-id="64292-106">Plusieurs composants peuvent exposer le même objet COM avec le même GUID, mais ont des fonctionnalités différentes en fonction de la version.</span><span class="sxs-lookup"><span data-stu-id="64292-106">Multiple components can expose the same COM object with the same GUID but have different functionality based on the version.</span></span>

<span data-ttu-id="64292-107">Quand une application demande un GUID à partir de [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid), com commence par Rechercher le mappage du ProgID au CLSID dans le contexte d’activation actif.</span><span class="sxs-lookup"><span data-stu-id="64292-107">When an application requests a GUID from [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid), COM first searches for the mapping from progid to CLSID in the active activation context.</span></span> <span data-ttu-id="64292-108">Quand une application utilise [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) pour obtenir un pointeur d’interface d’instance, com recherche dans le contexte d’activation actif pour déterminer quelle dll hébergera le CLSID.</span><span class="sxs-lookup"><span data-stu-id="64292-108">When an application uses [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to obtain an instance interface pointer, COM searches in the active activation context to find which DLL will host the CLSID.</span></span> <span data-ttu-id="64292-109">Si le contexte d’activation ne contient pas les informations requises, COM recherche les informations dans le registre à l’aide de la méthode habituelle.</span><span class="sxs-lookup"><span data-stu-id="64292-109">If the activation context does not contain the required information, COM then searches for the information in the registry using the usual method.</span></span>

<span data-ttu-id="64292-110">Notez que, étant donné que les contextes d’activation sont par thread, COM marshale le contexte d’activation du thread de création sur le thread hôte et l’active avant d’appeler [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) ou [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) sur le thread hôte.</span><span class="sxs-lookup"><span data-stu-id="64292-110">Note that because activation contexts are per-thread, COM marshals the activation context of the creating thread over to the host thread and activates it before calling [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) on the host thread.</span></span> <span data-ttu-id="64292-111">Cette fonctionnalité est déjà présente dans Windows, le code client n’est pas obligé de faire quoi que ce soit pour l’implémenter.</span><span class="sxs-lookup"><span data-stu-id="64292-111">This functionality is already present in Windows, client code is not required to do anything to implement this.</span></span>

<span data-ttu-id="64292-112">Les classes COM peuvent être exportées par des composants hébergés sans passer par le registre.</span><span class="sxs-lookup"><span data-stu-id="64292-112">COM classes can be exported by hosted components without going through the registry.</span></span> <span data-ttu-id="64292-113">Plusieurs composants peuvent exposer le même ProgID pour différents objets COM, et votre application d’hébergement doit uniquement trouver le contexte d’activation approprié, puis utiliser [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid) et [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) pour obtenir les pointeurs d’interface de l’objet hébergé.</span><span class="sxs-lookup"><span data-stu-id="64292-113">Multiple components can expose the same ProgID for different COM objects, and your hosting application should only find the proper activation context and then use [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid) and [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to get the hosted object's interface pointers.</span></span>

 

 
