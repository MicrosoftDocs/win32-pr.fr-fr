---
description: Lorsque vous créez vos propres assemblys côte à côte, suivez les instructions relatives à la création d’assemblys côte à côte.
ms.assetid: e5fc3bae-0646-4418-a8f7-369856f03cd5
title: Création de dll pour les assemblys côte à côte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa15f3876c60ce55be00d60d8f417eb0c2cbf6ec
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104203385"
---
# <a name="authoring-dlls-for-side-by-side-assemblies"></a><span data-ttu-id="8f774-103">Création de dll pour les assemblys côte à côte</span><span class="sxs-lookup"><span data-stu-id="8f774-103">Authoring DLLs for Side-by-side Assemblies</span></span>

<span data-ttu-id="8f774-104">Lorsque vous créez vos propres assemblys côte à côte, suivez les [instructions relatives à la création d’assemblys côte à côte](guidelines-for-creating-side-by-side-assemblies.md) et créez les DLL utilisées dans l’assembly conformément aux indications suivantes :</span><span class="sxs-lookup"><span data-stu-id="8f774-104">When creating your own side-by-side assemblies, follow the [Guidelines for Creating Side-by-side Assemblies](guidelines-for-creating-side-by-side-assemblies.md) and author any DLLs used in the assembly according to the following guidelines:</span></span>

-   <span data-ttu-id="8f774-105">Vos dll doivent être conçues de manière à ce que plusieurs versions puissent s’exécuter en même temps et dans le même processus sans interférer les unes avec les autres.</span><span class="sxs-lookup"><span data-stu-id="8f774-105">Your DLLs should be designed so that multiple versions can run at the same time and in the same process without interfering with each other.</span></span> <span data-ttu-id="8f774-106">Par exemple, de nombreuses applications hébergent plusieurs plug-ins qui requièrent chacun une version différente d’un composant.</span><span class="sxs-lookup"><span data-stu-id="8f774-106">For example, many applications host multiple plug-ins that each require a different version of one component.</span></span> <span data-ttu-id="8f774-107">Le développeur doit concevoir et tester l’assembly côte à côte pour s’assurer que plusieurs versions du composant fonctionnent correctement lorsqu’elles sont exécutées en même temps dans le même processus.</span><span class="sxs-lookup"><span data-stu-id="8f774-107">The developer the side-by-side assembly needs to design and test to ensure that multiple versions of the component work correctly when run at the same time in the same process.</span></span>

-   <span data-ttu-id="8f774-108">Si vous envisagez de fournir votre composant en tant que composant partagé sur des systèmes antérieurs à Windows XP, vous devez continuer à installer le composant sur ces systèmes en tant que composant partagé d’instance unique.</span><span class="sxs-lookup"><span data-stu-id="8f774-108">If you plan to provide your component as a shared component on systems earlier than Windows XP, you need to continue to install the component on these systems as a single-instance shared component.</span></span> <span data-ttu-id="8f774-109">Dans ce cas, vous devez vous assurer que votre composant est à compatibilité descendante.</span><span class="sxs-lookup"><span data-stu-id="8f774-109">In this case, you need to ensure your component is backward compatible.</span></span>

-   <span data-ttu-id="8f774-110">Évaluer l’utilisation des objets quand plusieurs versions de votre assembly sont exécutées sur le système.</span><span class="sxs-lookup"><span data-stu-id="8f774-110">Evaluate the use of objects when more than one version of your assembly is run on the system.</span></span> <span data-ttu-id="8f774-111">Déterminez si les différentes versions de l’assembly nécessitent des structures de données distinctes, telles que les fichiers mappés en mémoire, les canaux nommés, les messages Windows inscrits et les classes, la mémoire partagée, les sémaphores, les mutex et les pilotes matériels.</span><span class="sxs-lookup"><span data-stu-id="8f774-111">Determine whether different versions of the assembly require separate data structures, such as memory-mapped files, named pipes, registered Windows messages and classes, shared memory, semaphores, mutexes, and hardware drivers.</span></span> <span data-ttu-id="8f774-112">Toutes les structures de données utilisées dans les versions d’assembly doivent être à compatibilité descendante.</span><span class="sxs-lookup"><span data-stu-id="8f774-112">Any data structures used across assembly versions must be backward-compatible.</span></span> <span data-ttu-id="8f774-113">Déterminez les structures de données qui peuvent être utilisées dans les différentes versions et les structures de données qui doivent être privées pour une version.</span><span class="sxs-lookup"><span data-stu-id="8f774-113">Decide which data structures can be used across versions, and which data structures must be private to a version.</span></span> <span data-ttu-id="8f774-114">Déterminez si les structures de données partagées nécessitent des objets de synchronisation distincts, tels que des sémaphores et des mutex.</span><span class="sxs-lookup"><span data-stu-id="8f774-114">Determine whether shared data structures require separate synchronization objects, such as semaphores and mutexes.</span></span>

-   <span data-ttu-id="8f774-115">Certains objets, tels que les classes de fenêtre et les atomes, sont nommés de manière unique pour chaque processus.</span><span class="sxs-lookup"><span data-stu-id="8f774-115">Some objects, such as window classes and Atoms, are uniquely named for each process.</span></span> <span data-ttu-id="8f774-116">Les objets tels que les classes de fenêtre doivent être dotés d’un contrôle de version pour chaque assembly utilisant le manifeste.</span><span class="sxs-lookup"><span data-stu-id="8f774-116">Objects such as window classes should be versioned for each assembly using the manifest.</span></span> <span data-ttu-id="8f774-117">Pour les objets tels que les atomes, utilisez des identificateurs spécifiques à la version, sauf si vous envisagez de partager entre les versions.</span><span class="sxs-lookup"><span data-stu-id="8f774-117">For objects such as Atoms, use version-specific identifiers unless you plan to share across versions.</span></span> <span data-ttu-id="8f774-118">Si vous utilisez des identificateurs spécifiques à la version, utilisez le numéro de version en quatre parties.</span><span class="sxs-lookup"><span data-stu-id="8f774-118">If you use version-specific identifiers, use the four-part versioning number.</span></span>

-   <span data-ttu-id="8f774-119">N’incluez pas de code auto-inscrit dans une DLL.</span><span class="sxs-lookup"><span data-stu-id="8f774-119">Include no self-registering code in any DLL.</span></span> <span data-ttu-id="8f774-120">Une DLL dans un assembly côte à côte ne peut pas s’inscrire automatiquement.</span><span class="sxs-lookup"><span data-stu-id="8f774-120">A DLL in a side-by-side assembly cannot be self-registering.</span></span>

-   <span data-ttu-id="8f774-121">Définissez tous les noms spécifiques à la version dans votre DLL avec des \# instructions define.</span><span class="sxs-lookup"><span data-stu-id="8f774-121">Define all version-specific names in your DLL with \#define statements.</span></span> <span data-ttu-id="8f774-122">Cela permet de modifier toutes les clés de Registre à partir d’un emplacement.</span><span class="sxs-lookup"><span data-stu-id="8f774-122">This enables all registry keys to be changed from one location.</span></span> <span data-ttu-id="8f774-123">Lorsque vous publiez une nouvelle version de votre assembly, il vous suffit de modifier cette \# instruction de définition.</span><span class="sxs-lookup"><span data-stu-id="8f774-123">When you release a new version of your assembly, you only need to change this \#define statement.</span></span> <span data-ttu-id="8f774-124">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="8f774-124">For example:</span></span>

    `#define MyRegistryKey "MyAssembly1.0.0.0"`

-   <span data-ttu-id="8f774-125">Stockez les données non persistantes dans le répertoire Temp.</span><span class="sxs-lookup"><span data-stu-id="8f774-125">Store any nonpersistent data in the Temp directory.</span></span>

-   <span data-ttu-id="8f774-126">Ne placez pas de données utilisateur dans des emplacements globaux.</span><span class="sxs-lookup"><span data-stu-id="8f774-126">Do not put user data into global locations.</span></span> <span data-ttu-id="8f774-127">Conserver les données d’application séparées des données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8f774-127">Keep application data separate from user data.</span></span>

-   <span data-ttu-id="8f774-128">Affectez à tous les fichiers partagés une version de fichier qui dépend du nom de l’application.</span><span class="sxs-lookup"><span data-stu-id="8f774-128">Assign all shared files a file version that depends upon the application's name.</span></span>

-   <span data-ttu-id="8f774-129">Affectez à tous les messages et toutes les structures de données utilisés dans les processus une version pour empêcher le partage interprocessus accidentel.</span><span class="sxs-lookup"><span data-stu-id="8f774-129">Assign all messages and data structures used across processes a version to prevent unintentional cross-process sharing.</span></span>

-   <span data-ttu-id="8f774-130">Votre DLL ne doit pas dépendre du partage entre les versions qui n’existent pas, telles que les sections de mémoire partagée qui ne sont pas partagées entre différentes versions de votre assembly.</span><span class="sxs-lookup"><span data-stu-id="8f774-130">Your DLL should not depend upon sharing across versions that may not exist, such as shared memory sections that are not shared across different versions of your assembly.</span></span>

-   <span data-ttu-id="8f774-131">Si vous ajoutez de nouvelles fonctionnalités qui ne suivent pas le contrat de compatibilité avec l’interface binaire de la DLL d’origine, vous devez assigner un nouveau CLSID, ProgId et nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="8f774-131">If you add new functionality that does not follow the binary interface compatibility contract of the original DLL, you must assign a new CLSID, ProgId, and file name.</span></span> <span data-ttu-id="8f774-132">Les futures versions de votre assembly côte à côte sont alors requises pour utiliser ce CLSID, ce ProgId et ce nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="8f774-132">Future versions of your side-by-side assembly is then required to use this CLSID, ProgId, and file name.</span></span> <span data-ttu-id="8f774-133">Cela empêche un conflit quand une version de la DLL qui n’est pas côte à côte est inscrite sur une version côte à côte.</span><span class="sxs-lookup"><span data-stu-id="8f774-133">This prevents a conflict when a version of the DLL that is not side-by-side is registered over a side-by-side version.</span></span>

-   <span data-ttu-id="8f774-134">Si vous réutilisez le même CLSID ou ProgId, effectuez un test pour vérifier que l’assembly est à compatibilité descendante.</span><span class="sxs-lookup"><span data-stu-id="8f774-134">If you reuse the same CLSID or ProgId, test to ensure that the assembly is backward compatible.</span></span>

-   <span data-ttu-id="8f774-135">Initialisez et définissez les paramètres par défaut de l’assembly dans le code de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="8f774-135">Initialize and set the default settings for the assembly in the assembly code.</span></span> <span data-ttu-id="8f774-136">N’enregistrez pas les paramètres par défaut dans le registre.</span><span class="sxs-lookup"><span data-stu-id="8f774-136">Do not save the defaults settings in the registry.</span></span>

-   <span data-ttu-id="8f774-137">Assignez des versions à toutes les structures de données.</span><span class="sxs-lookup"><span data-stu-id="8f774-137">Assign versions to all data structures.</span></span>

-   <span data-ttu-id="8f774-138">Votre DLL doit stocker l’état de l’assembly côte à côte comme décrit dans [création du stockage d’État pour les assemblys côte à côte](authoring-state-storage-for-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="8f774-138">Your DLL should store the state of the side-by-side assembly as described in [Authoring State Storage for Side-by-Side Assemblies](authoring-state-storage-for-side-by-side-assemblies.md).</span></span>

 

 



