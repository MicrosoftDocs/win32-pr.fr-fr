---
description: Un assembly privé est un assembly qui est déployé avec une application et qui est disponible pour l’utilisation exclusive de cette application.
ms.assetid: 5E0E7423-85BD-4ED0-9149-9541F4D2371F
title: À propos des assemblys privés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7c7ccfe8c63a8435a33085f607c2040a0a42345c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106517828"
---
# <a name="about-private-assemblies"></a><span data-ttu-id="dc566-103">À propos des assemblys privés</span><span class="sxs-lookup"><span data-stu-id="dc566-103">About Private Assemblies</span></span>

<span data-ttu-id="dc566-104">Un assembly privé est un assembly qui est déployé avec une application et qui est disponible pour l’utilisation exclusive de cette application.</span><span class="sxs-lookup"><span data-stu-id="dc566-104">A private assembly is an assembly that is deployed with an application and is available for the exclusive use of that application.</span></span> <span data-ttu-id="dc566-105">Autrement dit, les autres applications ne partagent pas l’assembly privé.</span><span class="sxs-lookup"><span data-stu-id="dc566-105">That is, other applications do not share the private assembly.</span></span> <span data-ttu-id="dc566-106">Les assemblys privés sont l’une des méthodes qui peuvent être utilisées pour créer des [applications isolées](isolated-applications.md).</span><span class="sxs-lookup"><span data-stu-id="dc566-106">Private assemblies are one of the methods that can be used to create [isolated applications](isolated-applications.md).</span></span> <span data-ttu-id="dc566-107">Pour plus d’informations, consultez [à propos des applications isolées et des assemblys côte à côte](about-isolated-applications-and-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="dc566-107">For more information, see [About Isolated Applications and Side-by-Side Assemblies](about-isolated-applications-and-side-by-side-assemblies.md).</span></span>

<span data-ttu-id="dc566-108">Les assemblys privés doivent être conçus pour fonctionner côte à côte avec d’autres versions de l’assembly sur le système.</span><span class="sxs-lookup"><span data-stu-id="dc566-108">Private assemblies must be designed to work side-by-side with other versions of the assembly on the system.</span></span> <span data-ttu-id="dc566-109">Pour plus d’informations, consultez [instructions relatives à la création d’assemblys côte à côte](guidelines-for-creating-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="dc566-109">For more information, see [Guidelines for Creating Side-by-side Assemblies](guidelines-for-creating-side-by-side-assemblies.md).</span></span>

<span data-ttu-id="dc566-110">Les assemblys privés doivent être accompagnés d’un [manifeste d’assembly](assembly-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="dc566-110">Private assemblies must be accompanied by an [assembly manifest](assembly-manifests.md).</span></span> <span data-ttu-id="dc566-111">Notez que des restrictions de nom s’appliquent lors de l’empaquetage d’une DLL en tant qu’assembly privé pour s’adapter à la manière dont Windows recherche les assemblys privés.</span><span class="sxs-lookup"><span data-stu-id="dc566-111">Note that name restrictions apply when packaging a DLL as a private assembly to accommodate the way in which Windows searches for private assemblies.</span></span> <span data-ttu-id="dc566-112">Lors de la recherche d’assemblys privés, la méthode recommandée consiste à inclure le manifeste d’assembly dans la DLL en tant que ressource.</span><span class="sxs-lookup"><span data-stu-id="dc566-112">When searching for private assemblies, the recommended method is to include the assembly manifest in the DLL as a resource.</span></span> <span data-ttu-id="dc566-113">Dans ce cas, l’ID de ressource doit être égal à 1 et le nom de l’assembly privé peut être le même que le nom de la DLL.</span><span class="sxs-lookup"><span data-stu-id="dc566-113">In this case, the resource ID must equal 1 and the name of the private assembly may be the same as the name of the DLL.</span></span> <span data-ttu-id="dc566-114">Par exemple, si le nom de la DLL est MICROSOFT.WINDOWS.MYSAMPLE.DLL, la valeur de l’attribut Name utilisé dans l’élément **assemblyIdentity** du manifeste peut également être Microsoft. Windows. MySample.</span><span class="sxs-lookup"><span data-stu-id="dc566-114">For example, if the name of the DLL is MICROSOFT.WINDOWS.MYSAMPLE.DLL, the value of the name attribute used in the **assemblyIdentity** element of the manifest may also be Microsoft.Windows.mysample.</span></span> <span data-ttu-id="dc566-115">Une autre méthode de recherche d’assemblys privés consiste à fournir le manifeste de l’assembly dans un fichier séparé.</span><span class="sxs-lookup"><span data-stu-id="dc566-115">An alternate method of searching for private assemblies is to provide the assembly manifest in a separate file.</span></span> <span data-ttu-id="dc566-116">Dans ce cas, le nom de l’assembly et son manifeste doivent être différents du nom de la DLL.</span><span class="sxs-lookup"><span data-stu-id="dc566-116">In this case, the name of the assembly and its manifest must be different than the name of the DLL.</span></span> <span data-ttu-id="dc566-117">Par exemple, Microsoft. Windows. mysampleAsm, Microsoft. Windows. mysampleAsm. manifest et Microsoft.Windows.mysample.dll.</span><span class="sxs-lookup"><span data-stu-id="dc566-117">For example, Microsoft.Windows.mysampleAsm, Microsoft.Windows.mysampleAsm.manifest, and Microsoft.Windows.mysample.dll.</span></span> <span data-ttu-id="dc566-118">Pour plus d’informations sur la façon dont les recherches côte à côte pour les assemblys privés, consultez [séquence de recherche](assembly-searching-sequence.md)d’assemblys.</span><span class="sxs-lookup"><span data-stu-id="dc566-118">For more information about how side-by-side searches for private assemblies see [Assembly Searching Sequence](assembly-searching-sequence.md).</span></span>

<span data-ttu-id="dc566-119">Les assemblys privés sont installés dans un dossier de la structure de répertoires de l’application.</span><span class="sxs-lookup"><span data-stu-id="dc566-119">Private assemblies are installed in a folder of the application's directory structure.</span></span> <span data-ttu-id="dc566-120">En règle générale, il s’agit du dossier contenant le fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="dc566-120">Typically, this is the folder containing the application's executable file.</span></span> <span data-ttu-id="dc566-121">Les assemblys privés peuvent être déployés dans le même dossier que l’application, dans un dossier portant le même nom que l’assembly, ou dans un sous-dossier spécifique à une langue portant le même nom que l’assembly.</span><span class="sxs-lookup"><span data-stu-id="dc566-121">Private assemblies may be deployed in the same folder as the application, in a folder with the same name as the assembly, or in a language specific subfolder with the same name as the assembly.</span></span> <span data-ttu-id="dc566-122">Par exemple, utilisez l’une des structures de répertoire suivantes pour déployer un assembly privé, Microsoft. Tools. pop, sans langue spécifiée.</span><span class="sxs-lookup"><span data-stu-id="dc566-122">For example, use one of the following directory structures to deploy a private assembly, Microsoft.tools.pop, with no language specified.</span></span>



| <span data-ttu-id="dc566-123">Structure de répertoires</span><span class="sxs-lookup"><span data-stu-id="dc566-123">Directory structure</span></span>                                       | <span data-ttu-id="dc566-124">Description</span><span class="sxs-lookup"><span data-stu-id="dc566-124">Description</span></span>                                                                                            |
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="dc566-125">APPDIR \\MICROSOFT.TOOLS.POP.DLL</span><span class="sxs-lookup"><span data-stu-id="dc566-125">APPDIR\\MICROSOFT.TOOLS.POP.DLL</span></span>                           | <span data-ttu-id="dc566-126">Le manifeste est déployé en tant que ressource dans la DLL.</span><span class="sxs-lookup"><span data-stu-id="dc566-126">The manifest is deployed as a resource in the DLL.</span></span>                                                     |
| <span data-ttu-id="dc566-127">Appdir \\ Microsoft. Tools. pop. manifest</span><span class="sxs-lookup"><span data-stu-id="dc566-127">Appdir\\Microsoft.Tools.Pop.MANIFEST</span></span>                      | <span data-ttu-id="dc566-128">Le manifeste est déployé en tant que fichier distinct.</span><span class="sxs-lookup"><span data-stu-id="dc566-128">The manifest is deployed as a separate file.</span></span>                                                           |
| <span data-ttu-id="dc566-129">APPDIR \\ Microsoft. Tools. \\MICROSOFT.TOOLS.POP.DLL pop</span><span class="sxs-lookup"><span data-stu-id="dc566-129">APPDIR\\MICROSOFT.TOOLS.POP\\MICROSOFT.TOOLS.POP.DLL</span></span>      | <span data-ttu-id="dc566-130">Le manifeste est déployé en tant que ressource dans la DLL, qui se trouve dans un sous-dossier portant le nom de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="dc566-130">The manifest is deployed as a resource in the DLL, which is in a subfolder having the assembly's name.</span></span> |
| <span data-ttu-id="dc566-131">Appdir \\ Microsoft. Tools. pop \\ Microsoft. Tools. pop. manifest</span><span class="sxs-lookup"><span data-stu-id="dc566-131">Appdir\\Microsoft.Tools.Pop\\Microsoft.Tools.Pop.MANIFEST</span></span> | <span data-ttu-id="dc566-132">Le manifeste est déployé en tant que fichier distinct dans un sous-dossier portant le nom de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="dc566-132">The manifest is deployed as a separate file in a subfolder having the assembly's name.</span></span>                 |



 

> [!IMPORTANT]
>
> <span data-ttu-id="dc566-133">Pour les versions du système d’exploitation Windows antérieures à Windows 7 et Windows Server 2008 R2, les assemblys privés natifs doivent être déployés dans le dossier qui contient le fichier exécutable de l’application.</span><span class="sxs-lookup"><span data-stu-id="dc566-133">For versions of the Windows operating system before Windows 7 and Windows Server 2008 R2, native private assemblies must be deployed in the folder that contains the application's executable file.</span></span> <span data-ttu-id="dc566-134">L’installation dans un dossier spécifique à une langue ou dans le dossier portant le même nom que l’assembly n’est pas prise en charge pour les assemblys privés natifs.</span><span class="sxs-lookup"><span data-stu-id="dc566-134">Installation in a language specific folder or in the folder with same name as assembly is not supported for native private assemblies.</span></span>

 

<span data-ttu-id="dc566-135">Utilisez l’une des structures de répertoire suivantes pour déployer un assembly privé, Microsoft. Tools. pop, avec la langue spécifiée.</span><span class="sxs-lookup"><span data-stu-id="dc566-135">Use one of the following directory structures to deploy a private assembly, Microsoft.tools.pop, with a specified language.</span></span> <span data-ttu-id="dc566-136">Dans l’exemple suivant, la langue utilisée par Microsoft. Tools. pop est l’anglais (États-Unis) et le code de langue est en-US.</span><span class="sxs-lookup"><span data-stu-id="dc566-136">In the following example, the language used by Microsoft.Tools.Pop is English (United States) and the language code is en-us.</span></span> <span data-ttu-id="dc566-137">Vous devez substituer le code de langue DHTML approprié à votre assembly.</span><span class="sxs-lookup"><span data-stu-id="dc566-137">You should substitute the correct DHTML language code for your assembly.</span></span>

``` syntax
appdir\en-us\Microsoft.tools.pop.DLL
appdir\en-us\Microsoft.tools.pop.MANIFEST
appdir\en-us\Microsoft.tools.pop\Microsoft.tools.pop.DLL
appdir\en-us\Microsoft.tools.pop\Microsoft.tools.pop.MANIFEST
```

<span data-ttu-id="dc566-138">Les assemblys privés peuvent être installés par n’importe quelle méthode d’installation qui peut copier le fichier de l’assembly dans ce dossier, tel que la commande **xcopy** .</span><span class="sxs-lookup"><span data-stu-id="dc566-138">Private assemblies can be installed by any installation method that can copy the assembly's file into this folder, such as the **xcopy** command.</span></span> <span data-ttu-id="dc566-139">Pour plus d’informations sur l’installation d’assemblys privés à l’aide de la Windows Installer, consultez [installation d’assemblys Win32](../msi/installation-of-win32-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="dc566-139">For more information about how to install private assemblies using the Windows Installer, see [Installation of Win32 Assemblies](../msi/installation-of-win32-assemblies.md).</span></span>

<span data-ttu-id="dc566-140">Les assemblys privés peuvent également être installés sur des systèmes d’exploitation antérieurs à Windows XP.</span><span class="sxs-lookup"><span data-stu-id="dc566-140">Private assemblies can also be installed on operating systems earlier than Windows XP.</span></span> <span data-ttu-id="dc566-141">Dans ce cas, l’assembly doit être enregistré et, sur ces systèmes d’exploitation, le manifeste n’est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="dc566-141">In this case, the assembly must be registered and on these operating systems the manifest is not used.</span></span> <span data-ttu-id="dc566-142">Une copie de l’assembly privé est installée dans un dossier privé pour l’utilisation exclusive de l’application.</span><span class="sxs-lookup"><span data-stu-id="dc566-142">A copy of the private assembly is installed into a private folder for the exclusive use of the application.</span></span> <span data-ttu-id="dc566-143">Une autre version de l’assembly peut être inscrite globalement sur le système et disponible pour toutes les applications qui y sont liées.</span><span class="sxs-lookup"><span data-stu-id="dc566-143">Another version of the assembly can be globally registered on the system and available to any application that binds to it.</span></span> <span data-ttu-id="dc566-144">La version globale de l’assembly peut être la version installée avec l’application ou une version antérieure.</span><span class="sxs-lookup"><span data-stu-id="dc566-144">The global version of the assembly may be the version installed with the application or an earlier version.</span></span> <span data-ttu-id="dc566-145">Pour plus d’informations, consultez [redirection DLL/com sur Windows](dll-com-redirection-on-windows.md).</span><span class="sxs-lookup"><span data-stu-id="dc566-145">For more information, see [DLL/COM Redirection on Windows](dll-com-redirection-on-windows.md).</span></span> <span data-ttu-id="dc566-146">Un assembly peut également être installé en tant qu’assembly partagé pour une utilisation par plusieurs applications.</span><span class="sxs-lookup"><span data-stu-id="dc566-146">An assembly can also be installed as a shared assembly for use by multiple applications.</span></span> <span data-ttu-id="dc566-147">Pour plus d’informations, consultez [assemblys partagés](/windows/desktop/Msi/shared-assemblies).</span><span class="sxs-lookup"><span data-stu-id="dc566-147">For more information, see [Shared Assemblies](/windows/desktop/Msi/shared-assemblies).</span></span>

<span data-ttu-id="dc566-148">Notez que les étapes de création d’un assembly privé sont identiques à celles de la création d’un assembly partagé, à deux exceptions près :</span><span class="sxs-lookup"><span data-stu-id="dc566-148">Note that the steps for creating a private assembly are identical to those for creating a shared assembly with two exceptions:</span></span>

-   <span data-ttu-id="dc566-149">Un assembly privé n’a pas besoin d’être signé et **publickeyToken** n’est pas requis dans l’élément **assemblyIdentity** du manifeste de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="dc566-149">A private assembly is not required to be signed, and **publickeyToken** is not required in the **assemblyIdentity** element of the assembly manifest.</span></span>
-   <span data-ttu-id="dc566-150">Les assemblys privés peuvent être installés dans le dossier de l’application à l’aide de n’importe quelle technologie d’installation.</span><span class="sxs-lookup"><span data-stu-id="dc566-150">Private assemblies can be installed into the application's folder using any installation technology.</span></span> <span data-ttu-id="dc566-151">Il n’est pas nécessaire d’installer les assemblys privés à l’aide de l’Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="dc566-151">Private assemblies are not required to be installed using the Windows Installer.</span></span>

 

 
