---
description: Spécification d’un contexte d’activation par défaut
ms.assetid: 4d9a8552-7098-458d-a592-45524871cce5
title: Spécification d’un contexte d’activation par défaut
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 32cf0225a8e4290a09f7e6524a4b3ef47f9c4c4e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103952798"
---
# <a name="specifying-a-default-activation-context"></a><span data-ttu-id="e71d3-103">Spécification d’un contexte d’activation par défaut</span><span class="sxs-lookup"><span data-stu-id="e71d3-103">Specifying a Default Activation Context</span></span>

<span data-ttu-id="e71d3-104">Lorsque votre application ou composant crée un nouveau processus, Windows recherche un manifeste d’application par défaut.</span><span class="sxs-lookup"><span data-stu-id="e71d3-104">When your application or component creates a new process, Windows searches for a default application manifest.</span></span> <span data-ttu-id="e71d3-105">Notez qu’un manifeste inclus en tant que ressource dans l’application est prioritaire par rapport à un manifeste externe.</span><span class="sxs-lookup"><span data-stu-id="e71d3-105">Note that a manifest included as a resource in the application takes precedence over an external manifest.</span></span> <span data-ttu-id="e71d3-106">Le contexte d’activation par défaut est le premier contexte d’activation qui est actif avant l’activation d’un autre contexte d’activation.</span><span class="sxs-lookup"><span data-stu-id="e71d3-106">The default activation context is the first activation context that is active before any other activation context has been activated.</span></span> <span data-ttu-id="e71d3-107">Ce contexte d’activation est toujours actif, sauf si vous activez d’autres contextes.</span><span class="sxs-lookup"><span data-stu-id="e71d3-107">This activation context is always active unless you activate other contexts.</span></span> <span data-ttu-id="e71d3-108">Si vous définissez \_ la prise \_ en charge de l’isolation activée quand vous compilez votre application ou composant, les appels tels que [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)et [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) peuvent effectuer la gestion de contexte automatique.</span><span class="sxs-lookup"><span data-stu-id="e71d3-108">If you define ISOLATION\_AWARE\_ENABLED when you compile your application or component, calls like [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), and [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) can perform automatic context management.</span></span>

<span data-ttu-id="e71d3-109">Le chargeur permet à une application de spécifier son contexte d’activation par défaut à l’aide de deux méthodes.</span><span class="sxs-lookup"><span data-stu-id="e71d3-109">The loader allows an application to specify its default activation context by two methods.</span></span> <span data-ttu-id="e71d3-110">Vous pouvez placer le fichier manifeste dans les ressources de l’exécutable et le chargeur le trouvera.</span><span class="sxs-lookup"><span data-stu-id="e71d3-110">You can put the manifest file in the resources of the executable and the loader will find it.</span></span> <span data-ttu-id="e71d3-111">Cela revient à placer le fichier manifeste dans la table de ressources de l’exécutable.</span><span class="sxs-lookup"><span data-stu-id="e71d3-111">This is the same as putting the manifest file in the executable's resource table.</span></span> <span data-ttu-id="e71d3-112">Vous pouvez placer le manifeste dans un fichier nommé *MyApp*. exe. Manifeste dans le même répertoire que *MyApp*. exe, et le chargeur le trouve lors de la recherche de *MyApp*. exe.</span><span class="sxs-lookup"><span data-stu-id="e71d3-112">You can place the manifest in a file named *Myapp*.exe.Manifest in the same directory as *Myapp*.exe, and the loader finds it while looking for *Myapp*.exe.</span></span>

<span data-ttu-id="e71d3-113">Si vous n’utilisez aucune de ces méthodes, l’application démarre avec le contexte d’activation par défaut du système, qui contient un ensemble minimal d’assemblys.</span><span class="sxs-lookup"><span data-stu-id="e71d3-113">If you use none of these methods, the application starts with the system default activation context, which contains a minimal set of assemblies.</span></span>

<span data-ttu-id="e71d3-114">Une meilleure façon d’utiliser la gestion de contexte automatique consiste à compiler votre application avec la prise en charge de l’ISOLATION \_ \_ activée définie.</span><span class="sxs-lookup"><span data-stu-id="e71d3-114">A better way of using automatic context management is by compiling your application with ISOLATION\_AWARE\_ENABLED defined.</span></span> <span data-ttu-id="e71d3-115">La méthode recommandée consiste à définir cela sur la ligne de commande du compilateur pour l’ensemble du projet en cours de génération, plutôt que de les définir dans des en-têtes ou des fichiers sources individuels.</span><span class="sxs-lookup"><span data-stu-id="e71d3-115">The recommended method is to set this on the compiler's command line for the entire project being built rather than being set in individual source files or headers.</span></span> <span data-ttu-id="e71d3-116">Cela permet à la plupart des API Win32 d’être conscientes des contextes d’activation et de savoir comment les gérer.</span><span class="sxs-lookup"><span data-stu-id="e71d3-116">This makes most Win32 APIs aware of activation contexts and how to manage them.</span></span> <span data-ttu-id="e71d3-117">Au lieu d’avoir à effectuer votre propre gestion du contexte d’activation, vous devez simplement placer un manifeste dans votre table de ressources au niveau de l’ID de ressource ISOLATIONAWARE \_ manifeste \_ \_ ID de ressource (valeur numérique 2), de type RT \_ Manifest (valeur numérique 24). Des fonctions telles que [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance)et [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) activent ensuite automatiquement ce contexte avant d’effectuer l’appel réel.</span><span class="sxs-lookup"><span data-stu-id="e71d3-117">Instead of having to do your own activation context management, you simply need to place a manifest in your resource table at resource ID ISOLATIONAWARE\_MANIFEST\_RESOURCE\_ID (numeric value 2), of type RT\_MANIFEST (numeric value 24.) Functions such as [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), and [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) then automatically activate this context before making the actual call.</span></span>

<span data-ttu-id="e71d3-118">Notez que si vous compilez avec la prise en \_ charge de \_ l’isolation activée, vous ne pouvez pas également effectuer votre propre gestion du contexte d’activation.</span><span class="sxs-lookup"><span data-stu-id="e71d3-118">Note that if you compile with ISOLATION\_AWARE\_ENABLED defined, you cannot also do your own activation context management.</span></span> <span data-ttu-id="e71d3-119">Lorsque l' \_ option prise en charge de \_ l’isolation est définie, Windows ignore toute création de contexte d’activation dynamique que votre application peut tenter d’effectuer entre les appels [**ActivateActCtx**](/windows/desktop/api/Winbase/nf-winbase-activateactctx) et [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) .</span><span class="sxs-lookup"><span data-stu-id="e71d3-119">With ISOLATION\_AWARE\_ENABLED defined, Windows ignores any dynamic activation context creation your application may attempt to do between [**ActivateActCtx**](/windows/desktop/api/Winbase/nf-winbase-activateactctx) and [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) calls.</span></span> <span data-ttu-id="e71d3-120">Cela signifie que lorsque votre application utilise la prise en charge de l’ISOLATION \_ \_ activée, vous devez vous assurer que le manifeste contient une liste complète de tous les assemblys requis par votre composant.</span><span class="sxs-lookup"><span data-stu-id="e71d3-120">This means that when your application uses ISOLATION\_AWARE\_ENABLED you must make sure that the manifest contains a complete list of all assemblies that your component requires.</span></span>

 

 
