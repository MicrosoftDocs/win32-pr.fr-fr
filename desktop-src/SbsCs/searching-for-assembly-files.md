---
description: Recherche de fichiers d’assembly
ms.assetid: 6e6c1104-5cde-4c07-9ee2-d87062675dac
title: Recherche de fichiers d’assembly
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2d7be73b162ea41fd9eeb0a042a1fc2e202b8115
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104210039"
---
# <a name="searching-for-assembly-files"></a><span data-ttu-id="5184a-103">Recherche de fichiers d’assembly</span><span class="sxs-lookup"><span data-stu-id="5184a-103">Searching for Assembly Files</span></span>

<span data-ttu-id="5184a-104">Les contextes d’activation peuvent aider le chargeur à rechercher des fichiers d’assembly.</span><span class="sxs-lookup"><span data-stu-id="5184a-104">Activation contexts can help the loader find assembly files.</span></span> <span data-ttu-id="5184a-105">Lorsque le chargeur recherche un fichier à charger par nom, il recherche d’abord des fichiers portant le nom spécifié qui sont référencés par des assemblys qui sont membres du contexte d’activation actuellement actif.</span><span class="sxs-lookup"><span data-stu-id="5184a-105">When the loader searches for a file to load by name, it first searches for files with the specified name that are referenced by assemblies that are members of the currently active activation context.</span></span> <span data-ttu-id="5184a-106">Un appel à [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) localise également ces fichiers en premier.</span><span class="sxs-lookup"><span data-stu-id="5184a-106">A call to [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) also locates these files first.</span></span> <span data-ttu-id="5184a-107">Les fichiers ayant le nom spécifié et le contexte d’activation actuel sont trouvés et chargés avant les fichiers portant le nom dans le répertoire local ou dans la variable d’environnement PATH.</span><span class="sxs-lookup"><span data-stu-id="5184a-107">Files having the specified name and the current activation context are found and loaded before files with the name in the local directory or in the PATH environment variable.</span></span> <span data-ttu-id="5184a-108">Cela signifie que lorsque vous créez des manifestes, vous devez répertorier tous les fichiers que vous prévoyez d’utiliser avec **SearchPath**, [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)ou les importations statiques.</span><span class="sxs-lookup"><span data-stu-id="5184a-108">This means that when you create manifests you need to list all files you plan to use with **SearchPath**, [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), or static imports.</span></span>

<span data-ttu-id="5184a-109">Notez que ces fichiers ne sont pas automatiquement localisés lors de l’utilisation de [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) ou d’autres fonctions qui ne recherchent pas de fichiers.</span><span class="sxs-lookup"><span data-stu-id="5184a-109">Note that these files are not automatically located when using [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) or other functions that do not search for files.</span></span> <span data-ttu-id="5184a-110">Pour utiliser ces fichiers avec **CreateFile**, utilisez d’abord [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) pour rechercher le chemin d’accès au fichier isolé, puis utilisez **CreateFile** sur le chemin d’accès retourné.</span><span class="sxs-lookup"><span data-stu-id="5184a-110">To use these files with **CreateFile**, use [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) first to find the path to the isolated file, and then use **CreateFile** on the returned path.</span></span>

<span data-ttu-id="5184a-111">Cette méthode de recherche de fichiers permet de séparer les applications isolées, car plusieurs fichiers portant le même nom peuvent différer uniquement par leur association à des assemblys de numéros de version différents.</span><span class="sxs-lookup"><span data-stu-id="5184a-111">This method of file searching helps to keep isolated applications separate because multiple files with the same name can then differ only by their association with assemblies of different version numbers.</span></span> <span data-ttu-id="5184a-112">Le système d’exploitation peut trouver le fichier approprié à utiliser pendant les opérations sur les fichiers.</span><span class="sxs-lookup"><span data-stu-id="5184a-112">The operating system can find the correct file to use during file operations.</span></span>

<span data-ttu-id="5184a-113">Si une DLL est chargée de cette manière à l’aide de [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), le point d’entrée de cette dll (DllMain) est appelé alors que le contexte d’activation d’origine est maintenu actif, sauf si la dll elle-même contient un manifeste à un ID de ressource spécifique ( \_ ID de ressource de manifeste ISOLATIONAWARE \_ \_ , ou 2)</span><span class="sxs-lookup"><span data-stu-id="5184a-113">If a DLL is loaded in this manner using [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), that DLL's entry point (DllMain) is called while the original activation context is kept active, except if the DLL itself contains a manifest at a certain resource ID (ISOLATIONAWARE\_MANIFEST\_RESOURCE\_ID, or 2)</span></span>

 

 
