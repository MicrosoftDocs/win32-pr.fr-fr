---
title: Création d’une application Windows Media Gestionnaire de périphériques
description: Création d’une application Windows Media Gestionnaire de périphériques
ms.assetid: 6a200bd9-19dd-4130-acb4-e038b469c334
keywords:
- Gestionnaire de périphériques Windows Media, création d’applications
- Gestionnaire de périphériques, création d’applications
- Gestionnaire de périphériques Windows Media, Guide de programmation
- Gestionnaire de périphériques, Guide de programmation
- Guide de programmation, applications de bureau
- Guide de programmation, Windows Media Gestionnaire de périphériques
- Guide de programmation, plug-ins
- Guide de programmation, création d’applications
- Windows Media Gestionnaire de périphériques, applications de bureau
- Gestionnaire de périphériques, applications de bureau
- Gestionnaire de périphériques Windows Media, plug-ins
- Gestionnaire de périphériques, plug-INSP
- plug-ins, création
- plug-ins, Guide de programmation
- applications de bureau, création
- création d’applications Windows Media Gestionnaire de périphériques, à propos de
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b50a2dfce057b993f84c0aca4c8f45796f67ba8
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "106511817"
---
# <a name="creating-a-windows-media-device-manager-application"></a><span data-ttu-id="7289e-119">Création d’une application Windows Media Gestionnaire de périphériques</span><span class="sxs-lookup"><span data-stu-id="7289e-119">Creating a Windows Media Device Manager Application</span></span>

<span data-ttu-id="7289e-120">Cette section décrit comment utiliser les Gestionnaire de périphériques Windows Media dans votre application.</span><span class="sxs-lookup"><span data-stu-id="7289e-120">This section describes how to use Windows Media Device Manager in your application.</span></span> <span data-ttu-id="7289e-121">Le terme « application » désigne ici un fichier exécutable, tel qu’un lecteur multimédia, ou un plug-in COM, tel qu’un plug-in de contrôle.</span><span class="sxs-lookup"><span data-stu-id="7289e-121">The term "application" here means either an executable, such as a media player, or a COM plug-in, such as a metering plug-in.</span></span>

<span data-ttu-id="7289e-122">Microsoft inclut plusieurs fournisseurs de services avec Windows XP et le lecteur Windows Media 10, y compris un fournisseur de services MTP, un fournisseur de services de Windows CE (pour les appareils exécutant Windows CE et utilisant le protocole RAPI, tels que Pocket PC) et un fournisseur de services pour les appareils de catégorie de stockage de masse (MSC).</span><span class="sxs-lookup"><span data-stu-id="7289e-122">Microsoft includes several service providers with Windows XP and Windows Media Player 10, including an MTP service provider, a Windows CE service provider (for devices running Windows CE and using the RAPI protocol, such as the Pocket PC), and a service provider for mass-storage category (MSC) devices.</span></span> <span data-ttu-id="7289e-123">Vous pouvez également créer votre propre fournisseur de service pour garantir la communication avec votre propre appareil. Pour plus d’informations, consultez [création d’un fournisseur de services](creating-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-123">You can also create your own service provider to ensure communication with your own device; for more information, see [Creating a Service Provider](creating-a-service-provider.md).</span></span>

<span data-ttu-id="7289e-124">Il existe un certain nombre de fournisseurs de services hérités tiers qui concernent l’appareil non MTP, non-RAPI ou non-MTP d’un fabricant particulier.</span><span class="sxs-lookup"><span data-stu-id="7289e-124">There are a number of third-party legacy service providers that address a particular manufacturer's non-MTP, non-RAPI, or non-MSC device.</span></span> <span data-ttu-id="7289e-125">Ces fournisseurs de services sont inclus sur le disque de pilote fourni avec ces appareils.</span><span class="sxs-lookup"><span data-stu-id="7289e-125">These service providers are included on the driver disk shipped with these devices.</span></span>

<span data-ttu-id="7289e-126">Une application qui utilise Windows Media Gestionnaire de périphériques doit effectuer les étapes suivantes.</span><span class="sxs-lookup"><span data-stu-id="7289e-126">An application that uses Windows Media Device Manager must perform the following steps.</span></span>

1.  <span data-ttu-id="7289e-127">**Soyez conscient des problèmes de confidentialité liés au développement d’une application.**</span><span class="sxs-lookup"><span data-stu-id="7289e-127">**Become aware of privacy issues involved with developing an application.**</span></span> <span data-ttu-id="7289e-128">Consultez la [déclaration de confidentialité](privacy-statement.md) pour en savoir plus sur certains problèmes de confidentialité impliquant le développement d’une application Windows Media gestionnaire de périphériques.</span><span class="sxs-lookup"><span data-stu-id="7289e-128">See [Privacy Statement](privacy-statement.md) to learn about some privacy issues involving developing a Windows Media Device Manager application.</span></span>
2.  <span data-ttu-id="7289e-129">**Incluez les fichiers d’en-tête et de bibliothèque requis pour votre application.**</span><span class="sxs-lookup"><span data-stu-id="7289e-129">**Include the required library and header files for your application.**</span></span> <span data-ttu-id="7289e-130">Consultez [fichiers d’en-tête et de bibliothèque requis pour une application](required-library-and-header-files-for-an-application.md) afin d’en savoir plus sur les fichiers que vous devez inclure dans votre projet.</span><span class="sxs-lookup"><span data-stu-id="7289e-130">See [Required Library and Header Files for an Application](required-library-and-header-files-for-an-application.md) to learn what files you will need to include in your project.</span></span>
3.  <span data-ttu-id="7289e-131">**Authentifiez l’application et obtenez l’interface IWMDMDevice racine.**</span><span class="sxs-lookup"><span data-stu-id="7289e-131">**Authenticate the application and acquire the root IWMDMDevice interface.**</span></span> <span data-ttu-id="7289e-132">La première tâche qu’une application doit effectuer pour utiliser Windows Media Gestionnaire de périphériques consiste à s’authentifier.</span><span class="sxs-lookup"><span data-stu-id="7289e-132">The first task an application must do to use Windows Media Device Manager is to authenticate itself.</span></span> <span data-ttu-id="7289e-133">Ce processus vérifie l’identité de l’application auprès de Windows Media Gestionnaire de périphériques à l’aide d’un certificat factice pour la fonctionnalité Windows Media Gestionnaire de périphériques limitée, ou à l’aide d’un certificat officiel pour des fonctionnalités complètes.</span><span class="sxs-lookup"><span data-stu-id="7289e-133">This process verifies the identity of the application to Windows Media Device Manager using a dummy certificate for limited Windows Media Device Manager functionality, or using an official certificate for full functionality.</span></span> <span data-ttu-id="7289e-134">Pour plus d’informations, consultez [authentification de l’application](authenticating-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-134">For more information, see [Authenticating the Application](authenticating-the-application.md).</span></span>
4.  <span data-ttu-id="7289e-135">**Énumérer les appareils connectés.**</span><span class="sxs-lookup"><span data-stu-id="7289e-135">**Enumerate the connected devices.**</span></span> <span data-ttu-id="7289e-136">La première étape de la communication avec les appareils consiste à déterminer quels appareils sont connectés et accessibles aux Gestionnaire de périphériques Windows Media.</span><span class="sxs-lookup"><span data-stu-id="7289e-136">The first step in communicating with devices is to find out what devices are connected and accessible to Windows Media Device Manager.</span></span> <span data-ttu-id="7289e-137">Pour plus d’informations, consultez [énumération des appareils](enumerating-devices.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-137">For more information, see [Enumerating Devices](enumerating-devices.md).</span></span>
5.  <span data-ttu-id="7289e-138">**Vérifiez l’état des composants DRM de l’appareil.**</span><span class="sxs-lookup"><span data-stu-id="7289e-138">**Check the status of the device's DRM components.**</span></span> <span data-ttu-id="7289e-139">Pour utiliser des fichiers protégés par DRM, un appareil doit être créé sur une version de Windows Media DRM pour les appareils mobiles, et les composants DRM doivent être à jour.</span><span class="sxs-lookup"><span data-stu-id="7289e-139">To use DRM-protected files, a device must be built on some version of Windows Media DRM for Portable Devices, and the DRM components must be up to date.</span></span> <span data-ttu-id="7289e-140">Avant de commencer à gérer des fichiers sur l’appareil, il est préférable de voir si l’appareil prend en charge les fichiers protégés par DRM et si l’appareil doit être mis à jour.</span><span class="sxs-lookup"><span data-stu-id="7289e-140">Before you begin handling files on the device, it is best to see if the device supports DRM-protected files, and whether the device needs to be updated.</span></span> <span data-ttu-id="7289e-141">Pour plus d’informations, consultez [gestion du contenu protégé dans l’application](handling-protected-content-in-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-141">For more information, see [Handling Protected Content in the Application](handling-protected-content-in-the-application.md).</span></span>
6.  <span data-ttu-id="7289e-142">**Explorez un appareil.**</span><span class="sxs-lookup"><span data-stu-id="7289e-142">**Explore a device.**</span></span> <span data-ttu-id="7289e-143">Une fois que vous avez trouvé l’appareil souhaité, vous pouvez explorer le contenu de cet appareil.</span><span class="sxs-lookup"><span data-stu-id="7289e-143">After you have found the device you want, you can explore the contents of that device.</span></span> <span data-ttu-id="7289e-144">Pour plus d’informations, consultez [exploration d’un appareil](exploring-a-device.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-144">For more information, see [Exploring a Device](exploring-a-device.md).</span></span>
7.  <span data-ttu-id="7289e-145">**Lire des fichiers à partir de l’appareil et écrire des fichiers sur l’appareil.**</span><span class="sxs-lookup"><span data-stu-id="7289e-145">**Read files from the device, and write files to the device.**</span></span> <span data-ttu-id="7289e-146">Une fois que vous connaissez la disposition de l’appareil, vous pouvez commencer à transférer des fichiers vers et depuis l’appareil.</span><span class="sxs-lookup"><span data-stu-id="7289e-146">After you know about the layout of the device, you can begin transferring files to and from the device.</span></span> <span data-ttu-id="7289e-147">Pour plus d’informations, consultez [lecture de fichiers à partir de l’appareil](reading-files-from-the-device.md) et [écriture de fichiers sur l’appareil](writing-files-to-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-147">For more information, see [Reading Files from the Device](reading-files-from-the-device.md) and [Writing Files to the Device](writing-files-to-the-device.md).</span></span>
8.  <span data-ttu-id="7289e-148">**Créer des sélections sur l’appareil.**</span><span class="sxs-lookup"><span data-stu-id="7289e-148">**Create playlists on the device.**</span></span> <span data-ttu-id="7289e-149">Un type de fichier que vous pouvez écrire sur l’appareil est un fichier abstrait, qui est une collection de références à d’autres fichiers.</span><span class="sxs-lookup"><span data-stu-id="7289e-149">One kind of file you can write to the device is an abstract file, which is a collection of references to other files.</span></span> <span data-ttu-id="7289e-150">Bien que la possibilité d’écrire des fichiers abstraits sur un appareil dépende du fournisseur de services et de l’appareil, en général, seuls les appareils MTP disposent de cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="7289e-150">Although the ability to write abstract files to a device depends on the service provider and the device, generally only MTP devices have this capability.</span></span> <span data-ttu-id="7289e-151">Pour plus d’informations, consultez [création d’une sélection sur l’appareil](creating-a-playlist-on-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-151">For more information, see [Creating a Playlist on the Device](creating-a-playlist-on-the-device.md).</span></span>

<span data-ttu-id="7289e-152">En plus de ces étapes, vous pouvez activer plusieurs autres fonctionnalités dans votre application :</span><span class="sxs-lookup"><span data-stu-id="7289e-152">In addition to these steps, there are several more features that you can enable in your application:</span></span>

-   <span data-ttu-id="7289e-153">Des **notifications.**</span><span class="sxs-lookup"><span data-stu-id="7289e-153">**Notifications.**</span></span> <span data-ttu-id="7289e-154">Vous pouvez autoriser votre application à recevoir des notifications lorsque des appareils se connectent ou se déconnectent de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="7289e-154">You can enable your application to receive notifications when devices connect or disconnect from the computer.</span></span> <span data-ttu-id="7289e-155">Pour plus d’informations, consultez [activation des notifications](enabling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-155">For more information, see [Enabling Notifications](enabling-notifications.md).</span></span>
-   <span data-ttu-id="7289e-156">**Journalisation.**</span><span class="sxs-lookup"><span data-stu-id="7289e-156">**Logging.**</span></span> <span data-ttu-id="7289e-157">Windows Media Gestionnaire de périphériques utilise un objet de journalisation qui enregistre un enregistrement de ses actions dans un fichier texte local.</span><span class="sxs-lookup"><span data-stu-id="7289e-157">Windows Media Device Manager uses a logging object that saves a record of its actions to a local text file.</span></span> <span data-ttu-id="7289e-158">Vous pouvez ajouter des messages à ce journal pour vous aider à analyser les erreurs ou les performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="7289e-158">You can add messages to this log to help you analyze errors or performance in your application.</span></span> <span data-ttu-id="7289e-159">Pour plus d’informations, consultez Activation de la [journalisation](enabling-logging.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-159">For more information, see [Enabling Logging](enabling-logging.md).</span></span>
-   <span data-ttu-id="7289e-160">**Contrôle de l’utilisation du contenu.**</span><span class="sxs-lookup"><span data-stu-id="7289e-160">**Metering content usage.**</span></span> <span data-ttu-id="7289e-161">Vous pouvez récupérer des statistiques d’utilisation de contenu pour les licences qui accordent ce droit.</span><span class="sxs-lookup"><span data-stu-id="7289e-161">You can retrieve content usage statistics for licenses that grant this right.</span></span> <span data-ttu-id="7289e-162">Ces statistiques peuvent ensuite être envoyées à un serveur Web pour calculer les paiements de droits d’accès aux propriétaires du contenu.</span><span class="sxs-lookup"><span data-stu-id="7289e-162">These statistics can then be sent up to a Web server to calculate royalty payments to content owners.</span></span> <span data-ttu-id="7289e-163">Pour plus d’informations, consultez [contrôle de l’utilisation du contenu](metering-content-usage.md).</span><span class="sxs-lookup"><span data-stu-id="7289e-163">For more information, see [Metering Content Usage](metering-content-usage.md).</span></span>

<span data-ttu-id="7289e-164">**Note de prudence**</span><span class="sxs-lookup"><span data-stu-id="7289e-164">**A note of caution**</span></span>

<span data-ttu-id="7289e-165">Il se peut que votre application doive fonctionner avec un grand nombre d’appareils, y compris certains que vous n’avez pas développés et que vous n’avez jamais testé votre code.</span><span class="sxs-lookup"><span data-stu-id="7289e-165">Your application may need to work with a variety of devices, including some that you have not developed and have never tested your code against.</span></span> <span data-ttu-id="7289e-166">Ces appareils peuvent ou non répondre avec précision à des requêtes et des commandes, ou implémenter MTP ou d’autres spécifications.</span><span class="sxs-lookup"><span data-stu-id="7289e-166">These devices might or might not accurately respond to queries and commands, or implement MTP or other specifications.</span></span> <span data-ttu-id="7289e-167">Veillez à inclure des fonctionnalités robustes de vérification des erreurs et de secours pour gérer les erreurs inattendues.</span><span class="sxs-lookup"><span data-stu-id="7289e-167">Be sure to include robust error checking and fallback functionality to deal with the unexpected.</span></span> <span data-ttu-id="7289e-168">Programmez de façon défensive.</span><span class="sxs-lookup"><span data-stu-id="7289e-168">Program defensively.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7289e-169">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="7289e-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7289e-170">**Guide de programmation**</span><span class="sxs-lookup"><span data-stu-id="7289e-170">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 




