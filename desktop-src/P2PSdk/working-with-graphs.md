---
description: Lorsque vous travaillez avec des graphiques homologues, les fonctions doivent être appelées dans un ordre spécifique. Le déroulement des appels varie selon que vous créez ou que vous ouvrez un graphique homologue. Cette rubrique identifie le déroulement des appels de fonction dans une application graphique d’homologue simple.
ms.assetid: cb4f48d0-d1e2-4a4b-bd5a-6e8f66d03806
title: Utilisation des graphiques
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b4328b7a0109139421cf03c72a7228a3dc17e375
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106521572"
---
# <a name="working-with-graphs"></a><span data-ttu-id="70ca9-105">Utilisation des graphiques</span><span class="sxs-lookup"><span data-stu-id="70ca9-105">Working with Graphs</span></span>

<span data-ttu-id="70ca9-106">Lorsque vous travaillez avec des graphiques homologues, les fonctions doivent être appelées dans un ordre spécifique.</span><span class="sxs-lookup"><span data-stu-id="70ca9-106">When working with peer graphs, functions must be called in a specific order.</span></span> <span data-ttu-id="70ca9-107">Le déroulement des appels varie selon que vous créez ou que vous ouvrez un graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-107">The flow of calls depends on whether you are creating or opening a peer graph.</span></span> <span data-ttu-id="70ca9-108">Cette rubrique identifie le déroulement des appels de fonction dans une application graphique d’homologue simple.</span><span class="sxs-lookup"><span data-stu-id="70ca9-108">This topic identifies the flow of function calls in a simple peer graph application.</span></span>

## <a name="starting-up-a-graph"></a><span data-ttu-id="70ca9-109">Démarrage d’un graphique</span><span class="sxs-lookup"><span data-stu-id="70ca9-109">Starting Up a Graph</span></span>

<span data-ttu-id="70ca9-110">Avant qu’une application appelle une fonction dans l’API de représentation graphique d’homologue, [**PeerGraphStartup**](/windows/desktop/api/P2P/nf-p2p-peergraphstartup) doit être appelé pour initialiser l’API de représentation graphique des homologues pour une application, puis définir la version prise en charge.</span><span class="sxs-lookup"><span data-stu-id="70ca9-110">Before an application calls a function in the Peer Graphing API, [**PeerGraphStartup**](/windows/desktop/api/P2P/nf-p2p-peergraphstartup) must be called to initialize the Peer Graphing API for an application, and then set the supported version.</span></span>

## <a name="creating-a-peer-graph"></a><span data-ttu-id="70ca9-111">Création d’un graphique homologue</span><span class="sxs-lookup"><span data-stu-id="70ca9-111">Creating a Peer Graph</span></span>

<span data-ttu-id="70ca9-112">La procédure suivante identifie le déroulement des appels pour la création d’un graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-112">The following procedure identifies the flow of calls for creating a peer graph.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="70ca9-113">Un seul homologue doit appeler [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span><span class="sxs-lookup"><span data-stu-id="70ca9-113">Only one peer should call [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span></span> <span data-ttu-id="70ca9-114">Tous les autres pairs doivent appeler [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="70ca9-114">All other peers should call [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span> <span data-ttu-id="70ca9-115">Plusieurs appels à **PeerGraphCreate** invalident un graphique.</span><span class="sxs-lookup"><span data-stu-id="70ca9-115">Multiple calls to **PeerGraphCreate** invalidate a graph.</span></span>

 

-   <span data-ttu-id="70ca9-116">Créez un graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-116">Create a peer graph.</span></span> <span data-ttu-id="70ca9-117">Appelez [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span><span class="sxs-lookup"><span data-stu-id="70ca9-117">Call [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span></span>
-   <span data-ttu-id="70ca9-118">Inscrivez-vous aux événements homologues.</span><span class="sxs-lookup"><span data-stu-id="70ca9-118">Register for peer events.</span></span> <span data-ttu-id="70ca9-119">Appelez [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="70ca9-119">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="70ca9-120">Pour plus d’informations sur l’inscription des événements homologues, consultez [infrastructure des événements](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="70ca9-120">For more information about registering for peer events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="70ca9-121">Écouter les connexions à un graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-121">Listen for connections to a peer graph.</span></span> <span data-ttu-id="70ca9-122">Appelez [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="70ca9-122">Call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>
-   <span data-ttu-id="70ca9-123">Exécuter des fonctions dépendantes de l’application pour le reste du temps d’exécution, par exemple, traiter des événements homologues et utiliser des connexions.</span><span class="sxs-lookup"><span data-stu-id="70ca9-123">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections.</span></span>
-   <span data-ttu-id="70ca9-124">Fermez la connexion à un graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-124">Close the connection to a peer graph.</span></span> <span data-ttu-id="70ca9-125">Appelez [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="70ca9-125">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

## <a name="opening-a-peer-graph"></a><span data-ttu-id="70ca9-126">Ouverture d’un graphique homologue</span><span class="sxs-lookup"><span data-stu-id="70ca9-126">Opening a Peer Graph</span></span>

<span data-ttu-id="70ca9-127">Le déroulement des appels de fonction pour ouvrir un graphique homologue dépend de la valeur de retour de l’appel à [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="70ca9-127">The flow of function calls to open a peer graph depends on the return value of the call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span> <span data-ttu-id="70ca9-128">Les valeurs les plus importantes sont **s \_ OK** et les **données d’homologue \_ \_ \_ créées**, qui sont décrites dans les sections suivantes de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="70ca9-128">The most important values are **S\_OK** and **PEER\_S\_DATA\_CREATED**, which are explained in the following sections of this topic.</span></span>

> [!Note]  
> <span data-ttu-id="70ca9-129">Si un appel à [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) ne retourne pas les données **s \_ OK** ou **Peer \_ s \_ \_ créées**, gérez l’erreur.</span><span class="sxs-lookup"><span data-stu-id="70ca9-129">If a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) does not return **S\_OK** or **PEER\_S\_DATA\_CREATED**, handle the error.</span></span>

 

## <a name="when-peergraphopen-returns-s_ok"></a><span data-ttu-id="70ca9-130">Quand PeerGraphOpen retourne S \_ OK</span><span class="sxs-lookup"><span data-stu-id="70ca9-130">When PeerGraphOpen Returns S\_OK</span></span>

<span data-ttu-id="70ca9-131">Lorsqu’un appel à [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) retourne la valeur **\_ OK**, un graphique homologue et une base de données existante ont été ouverts.</span><span class="sxs-lookup"><span data-stu-id="70ca9-131">When a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **S\_OK**, a peer graph and an existing database have been opened.</span></span> <span data-ttu-id="70ca9-132">La procédure suivante identifie ce que vous pouvez faire pour ouvrir un graphique homologue lorsqu’un appel à **PeerGraphOpen** retourne **S \_ OK**</span><span class="sxs-lookup"><span data-stu-id="70ca9-132">The following procedure identifies what you can do to open a peer graph when a call to **PeerGraphOpen** returns **S\_OK**</span></span>

-   <span data-ttu-id="70ca9-133">Inscrivez-vous aux événements homologues.</span><span class="sxs-lookup"><span data-stu-id="70ca9-133">Register for peer events.</span></span> <span data-ttu-id="70ca9-134">Appelez [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="70ca9-134">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="70ca9-135">Pour plus d’informations sur l’inscription des événements, consultez [infrastructure des événements](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="70ca9-135">For more information about registering for events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="70ca9-136">Localisez un nœud.</span><span class="sxs-lookup"><span data-stu-id="70ca9-136">Locate a node.</span></span> <span data-ttu-id="70ca9-137">Il s’agit d’un processus exécuté en dehors de l’infrastructure de représentation graphique des pairs, à l’aide d’une méthode ou d’une application que vous identifiez.</span><span class="sxs-lookup"><span data-stu-id="70ca9-137">This is a process performed outside of the Peer Graphing Infrastructure, by using a method or application that you identify.</span></span> <span data-ttu-id="70ca9-138">L’API graphique d’homologue ne fournit pas de mécanisme spécifique pour rechercher un nœud de graphique initial auquel se connecter.</span><span class="sxs-lookup"><span data-stu-id="70ca9-138">The Peer Graphing API does not provide a specific mechanism to find an initial graph node to connect to.</span></span> <span data-ttu-id="70ca9-139">Une application doit utiliser un autre mécanisme, tel que l’API [PNRP (Peer Name Resolution Protocol)](pnrp-namespace-provider-api.md) , pour localiser le nœud initial.</span><span class="sxs-lookup"><span data-stu-id="70ca9-139">An application must use another mechanism, such as the [Peer Name Resolution Protocol (PNRP)](pnrp-namespace-provider-api.md) API, to locate the initial node.</span></span>
-   <span data-ttu-id="70ca9-140">Si un nœud est trouvé, connectez-vous à celui-ci.</span><span class="sxs-lookup"><span data-stu-id="70ca9-140">If a node is found, connect to it.</span></span> <span data-ttu-id="70ca9-141">Appelez [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect), puis appelez [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) pour écouter les connexions au graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-141">Call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect), then call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) to listen for connections to the peer graph.</span></span>
    > [!Note]  
    > <span data-ttu-id="70ca9-142">Si un nœud est introuvable, n’appelez pas [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) et [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="70ca9-142">If a node is not found, do not call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) and [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>

     

-   <span data-ttu-id="70ca9-143">Exécuter des fonctions dépendantes de l’application pour le reste du temps d’exécution, par exemple, traiter des événements homologues et utiliser des connexions, selon que le nœud est connecté ou non au graphique d’homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-143">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections, depending on whether the node is connected to the peer graph or not.</span></span> <span data-ttu-id="70ca9-144">Par exemple, l’application peut choisir d’effectuer un délai d’expiration ou de procéder périodiquement à la détection d’un nœud actif dans le graphique.</span><span class="sxs-lookup"><span data-stu-id="70ca9-144">For example, the application can choose to timeout or periodically perform discovery for an active node in the graph.</span></span>
-   <span data-ttu-id="70ca9-145">Fermez la connexion au graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-145">Close the connection to the peer graph.</span></span> <span data-ttu-id="70ca9-146">Appelez [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="70ca9-146">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

## <a name="when-peergraphopen-returns-peer_s_data_created"></a><span data-ttu-id="70ca9-147">Quand PeerGraphOpen retourne les données de l’HOMOLOGUe \_ \_ \_ créées</span><span class="sxs-lookup"><span data-stu-id="70ca9-147">When PeerGraphOpen Returns PEER\_S\_DATA\_CREATED</span></span>

<span data-ttu-id="70ca9-148">Quand [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) retourne les **données d’homologue \_ \_ \_ créées**, cela signifie qu’une base de données pour un graphique homologue est introuvable, une nouvelle base de données est créée et c’est la première fois qu’elle est ouverte.</span><span class="sxs-lookup"><span data-stu-id="70ca9-148">When [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **PEER\_S\_DATA\_CREATED**, it means that an existing database for a peer graph is not found, a new database is created, and this is the first time it is opened.</span></span> <span data-ttu-id="70ca9-149">Pour utiliser ou écouter un graphique homologue, un homologue doit être connecté à un graphique homologue et être synchronisé avec celui-ci.</span><span class="sxs-lookup"><span data-stu-id="70ca9-149">To use or listen on a peer graph, a peer must be connected to and synchronized with a peer graph.</span></span>

<span data-ttu-id="70ca9-150">La procédure suivante identifie ce que vous pouvez faire pour ouvrir un graphique homologue lorsqu’un appel à [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) retourne les données de l' **homologue \_ \_ \_ créées**.</span><span class="sxs-lookup"><span data-stu-id="70ca9-150">The following procedure identifies what you can do to open a peer graph when a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **PEER\_S\_DATA\_CREATED**.</span></span>

-   <span data-ttu-id="70ca9-151">Ouvrez un graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-151">Open a peer graph.</span></span> <span data-ttu-id="70ca9-152">Appelez [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="70ca9-152">Call [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span>
-   <span data-ttu-id="70ca9-153">Inscrivez-vous aux événements homologues.</span><span class="sxs-lookup"><span data-stu-id="70ca9-153">Register for peer events.</span></span> <span data-ttu-id="70ca9-154">Appelez [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="70ca9-154">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="70ca9-155">Pour plus d’informations sur l’inscription des événements homologues, consultez [infrastructure des événements](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="70ca9-155">For more information about registering for peer events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="70ca9-156">Localisez un nœud.</span><span class="sxs-lookup"><span data-stu-id="70ca9-156">Locate a node.</span></span> <span data-ttu-id="70ca9-157">Il s’agit d’un processus exécuté en dehors de l’infrastructure de représentation graphique des pairs, à l’aide d’une méthode ou d’une application que vous identifiez.</span><span class="sxs-lookup"><span data-stu-id="70ca9-157">This is a process performed outside of the Peer Graphing Infrastructure, by using a method or application that you identify.</span></span> <span data-ttu-id="70ca9-158">L’API graphique d’homologue ne fournit pas de mécanisme spécifique pour rechercher un nœud de graphique initial auquel se connecter.</span><span class="sxs-lookup"><span data-stu-id="70ca9-158">The Peer Graphing API does not provide a specific mechanism to find an initial graph node to connect to.</span></span> <span data-ttu-id="70ca9-159">Une application doit utiliser un autre mécanisme, tel que l’API [PNRP (Peer Name Resolution Protocol)](pnrp-namespace-provider-api.md) , pour localiser le nœud initial.</span><span class="sxs-lookup"><span data-stu-id="70ca9-159">An application must use another mechanism, such as the [Peer Name Resolution Protocol (PNRP)](pnrp-namespace-provider-api.md) API, to locate the initial node.</span></span>
-   <span data-ttu-id="70ca9-160">Si un nœud est trouvé, connectez-vous à celui-ci.</span><span class="sxs-lookup"><span data-stu-id="70ca9-160">If a node is found, connect to it.</span></span> <span data-ttu-id="70ca9-161">Appelez [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect), puis appelez [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) pour écouter les connexions au graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-161">Call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect), then call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) to listen for connections to the peer graph.</span></span>
    > [!Note]  
    > <span data-ttu-id="70ca9-162">Si un nœud est introuvable, n’appelez pas [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) et [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="70ca9-162">If a node is not found, do not call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) and [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>

     

-   <span data-ttu-id="70ca9-163">Exécuter des fonctions dépendantes de l’application pour le reste du temps d’exécution, par exemple, traiter des événements homologues et utiliser des connexions, selon que le nœud est connecté ou non au graphique d’homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-163">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections, depending on whether the node is connected to the peer graph or not.</span></span> <span data-ttu-id="70ca9-164">Par exemple, l’application peut choisir d’effectuer un délai d’expiration ou de procéder périodiquement à la détection d’un nœud actif dans le graphique.</span><span class="sxs-lookup"><span data-stu-id="70ca9-164">For example, the application can choose to timeout or periodically perform discovery for an active node in the graph.</span></span>
-   <span data-ttu-id="70ca9-165">Fermez la connexion au graphique homologue.</span><span class="sxs-lookup"><span data-stu-id="70ca9-165">Close the connection to the peer graph.</span></span> <span data-ttu-id="70ca9-166">Appelez [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="70ca9-166">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

 

 



