---
description: Le regroupement d’égal à égal est une technologie qui permet à un développeur de créer un réseau pair à pair sécurisé rapidement et efficacement.
ms.assetid: ee72f60b-1e5b-4b69-bda0-2ae80734c144
title: Utilisation des groupes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7bebf958d0c3fdee6ad0dc400d495c54ec2e6fe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104529127"
---
# <a name="how-to-work-with-groups"></a><span data-ttu-id="7c92f-103">Utilisation des groupes</span><span class="sxs-lookup"><span data-stu-id="7c92f-103">How to Work With Groups</span></span>

<span data-ttu-id="7c92f-104">Le regroupement d’égal à égal est une technologie qui permet à un développeur de créer un réseau pair à pair sécurisé rapidement et efficacement.</span><span class="sxs-lookup"><span data-stu-id="7c92f-104">Peer-to-peer Grouping is a technology that allows a developer to create a secure peer network quickly and effectively.</span></span> <span data-ttu-id="7c92f-105">La liste suivante identifie les principales considérations à prendre en compte lors de la création d’une application de regroupement pair.</span><span class="sxs-lookup"><span data-stu-id="7c92f-105">The following list identifies the major considerations in creating a peer grouping application.</span></span>

-   [<span data-ttu-id="7c92f-106">Obtention d’une identité d’homologue</span><span class="sxs-lookup"><span data-stu-id="7c92f-106">Obtaining a Peer Identity</span></span>](#obtaining-a-peer-identity)
-   [<span data-ttu-id="7c92f-107">Démarrage d’un groupe homologue</span><span class="sxs-lookup"><span data-stu-id="7c92f-107">Starting Up a Peer Group</span></span>](#starting-up-the-peer-grouping-infrastructure)
-   [<span data-ttu-id="7c92f-108">Inscription pour les événements de regroupement</span><span class="sxs-lookup"><span data-stu-id="7c92f-108">Registering for Grouping Events</span></span>](#registering-for-peer-grouping-events)
-   [<span data-ttu-id="7c92f-109">Connexion à un groupe</span><span class="sxs-lookup"><span data-stu-id="7c92f-109">Connecting to a Group</span></span>](#obtaining-a-group-handle)
-   [<span data-ttu-id="7c92f-110">Création de rôles d’administrateur et de membre</span><span class="sxs-lookup"><span data-stu-id="7c92f-110">Creating Administrator and Member Roles</span></span>](#creating-administrator-and-member-roles)
-   [<span data-ttu-id="7c92f-111">Recherche d’un homologue</span><span class="sxs-lookup"><span data-stu-id="7c92f-111">Finding a Peer</span></span>](#finding-a-peer)
-   [<span data-ttu-id="7c92f-112">Connexion directe à un homologue</span><span class="sxs-lookup"><span data-stu-id="7c92f-112">Connecting Directly to a Peer</span></span>](#connecting-directly-to-a-peer)
-   [<span data-ttu-id="7c92f-113">Fermeture et arrêt d’un groupe</span><span class="sxs-lookup"><span data-stu-id="7c92f-113">Closing and Shutting Down a Group</span></span>](#closing-and-shutting-down-a-peer-group)

## <a name="obtaining-a-peer-identity"></a><span data-ttu-id="7c92f-114">Obtention d’une identité d’homologue</span><span class="sxs-lookup"><span data-stu-id="7c92f-114">Obtaining a Peer Identity</span></span>

<span data-ttu-id="7c92f-115">Avant de créer ou de vous connecter à un groupe, un homologue doit obtenir une identité d’homologue, qui est un nom utilisé pour identifier de manière unique un pair à un groupe.</span><span class="sxs-lookup"><span data-stu-id="7c92f-115">Before creating or connecting to a group, a peer must obtain a peer identity, which is a name used to uniquely identify a peer to a group.</span></span> <span data-ttu-id="7c92f-116">Pour obtenir une liste énumérée de toutes les identités d’homologue définies sur l’homologue, appelez [**PeerEnumIdentities**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities), qui retourne un handle vers l’énumération.</span><span class="sxs-lookup"><span data-stu-id="7c92f-116">To obtain an enumerated list of all peer identities defined on the peer, call [**PeerEnumIdentities**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities), which returns a handle to the enumeration.</span></span> <span data-ttu-id="7c92f-117">Pour obtenir les identités d’homologue, appelez [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) avec le handle d’énumération et le nombre de membres à récupérer.</span><span class="sxs-lookup"><span data-stu-id="7c92f-117">To obtain the peer identities, call [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) with the enumeration handle and the number of members to retrieve.</span></span> <span data-ttu-id="7c92f-118">Poursuivez l’appel de **PeerGetNextItem** jusqu’à ce que le paramètre *pCount* retourne une valeur inférieure au nombre d’identités d’homologues demandées.</span><span class="sxs-lookup"><span data-stu-id="7c92f-118">Continue calling **PeerGetNextItem** until the *pCount* parameter returns a value less than the number of peer identities requested.</span></span>

<span data-ttu-id="7c92f-119">Si une identité d’homologue pour l’homologue n’existe pas, elle peut être créée en appelant [**PeerIdentityCreate**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).</span><span class="sxs-lookup"><span data-stu-id="7c92f-119">If a peer identity for the peer does not exist, it can be created by calling [**PeerIdentityCreate**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).</span></span> <span data-ttu-id="7c92f-120">Après la création d’une identité d’homologue, l’homologue génère un objet BLOB XML d’identité qui contient la clé publique qui lui est assignée.</span><span class="sxs-lookup"><span data-stu-id="7c92f-120">After creating a peer identity, the peer generates an identity XML blob that contains the public key assigned to it</span></span>

<span data-ttu-id="7c92f-121">Les informations d’identité de l’homologue sont obtenues en appelant [**PeerIdentityGetXML**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml).</span><span class="sxs-lookup"><span data-stu-id="7c92f-121">The peer identity information is obtained by calling [**PeerIdentityGetXML**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml).</span></span> <span data-ttu-id="7c92f-122">Les informations d’identité de l’homologue sont utilisées par le créateur du groupe ou un administrateur pour émettre les informations d’identification nécessaires pour joindre le groupe, en tant qu’objet BLOB XML d’invitation.</span><span class="sxs-lookup"><span data-stu-id="7c92f-122">This peer identity information is used by the group creator or an administrator to issue the credentials needed to join the group, as an invitation XML blob.</span></span>

<span data-ttu-id="7c92f-123">Pour plus d’informations sur les identités d’homologues, consultez la documentation de l' [API Identity Manager](identity-manager-api.md) .</span><span class="sxs-lookup"><span data-stu-id="7c92f-123">For more information on peer identities, please refer to the [Identity Manager API](identity-manager-api.md) documentation</span></span>

## <a name="starting-up-the-peer-grouping-infrastructure"></a><span data-ttu-id="7c92f-124">Démarrage de l’infrastructure de regroupement d’homologues</span><span class="sxs-lookup"><span data-stu-id="7c92f-124">Starting Up the Peer Grouping Infrastructure</span></span>

<span data-ttu-id="7c92f-125">Avant qu’une fonction de l’API de regroupement pair ne soit appelée par une application, [**PeerGroupStartup**](/windows/desktop/api/P2P/nf-p2p-peergroupstartup) doit être appelé.</span><span class="sxs-lookup"><span data-stu-id="7c92f-125">Before any function in the Peer Grouping API is called by an application, [**PeerGroupStartup**](/windows/desktop/api/P2P/nf-p2p-peergroupstartup) must be called.</span></span> <span data-ttu-id="7c92f-126">Cette fonction initialise l’infrastructure de regroupement de pairs pour l’application et définit la version prise en charge.</span><span class="sxs-lookup"><span data-stu-id="7c92f-126">This function initializes the Peer Grouping Infrastructure for the application and sets the supported version.</span></span>

## <a name="obtaining-a-group-handle"></a><span data-ttu-id="7c92f-127">Obtention d’un descripteur de groupe</span><span class="sxs-lookup"><span data-stu-id="7c92f-127">Obtaining a Group Handle</span></span>

<span data-ttu-id="7c92f-128">Pour vous connecter à un groupe et commencer à participer, vous devez obtenir un handle vers un groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-128">To connect to a group and begin participating, a handle to a peer group must be obtained.</span></span> <span data-ttu-id="7c92f-129">La liste suivante identifie les trois manières de se connecter à un groupe homologue :</span><span class="sxs-lookup"><span data-stu-id="7c92f-129">The following list identifies the three ways to connect to a peer group:</span></span>

-   <span data-ttu-id="7c92f-130">Création d’un groupe homologue en appelant [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), qui initialise un nouveau groupe homologue et retourne un handle valide avec l’homologue comme propriétaire et administrateur unique.</span><span class="sxs-lookup"><span data-stu-id="7c92f-130">Creating a peer group by calling [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), which initializes a new peer group and returns a valid handle with the peer as the owner and sole administrator.</span></span>
-   <span data-ttu-id="7c92f-131">Joindre un groupe homologue en appelant [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin).</span><span class="sxs-lookup"><span data-stu-id="7c92f-131">Joining a peer group by calling [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin).</span></span> <span data-ttu-id="7c92f-132">Pour joindre un groupe homologue, un homologue doit recevoir une invitation d’un administrateur de groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-132">To join a peer group, a peer must receive an invitation from a peer group administrator.</span></span> <span data-ttu-id="7c92f-133">Pour obtenir une invitation, envoyez l’objet BLOB XML des informations d’identité à l’administrateur qui crée une invitation et vous l’envoie par un mécanisme externe, tel que la messagerie électronique ou FTP.</span><span class="sxs-lookup"><span data-stu-id="7c92f-133">To obtain an invitation, send the identity information XML blob to the administrator who creates an invitation and sends it to you by an external mechanism, such as email or FTP.</span></span> <span data-ttu-id="7c92f-134">L’invitation et l’identité de l’homologue sont passées à **PeerGroupJoin**, qui retourne un handle valide pour le groupe.</span><span class="sxs-lookup"><span data-stu-id="7c92f-134">The invitation and peer identity are passed to **PeerGroupJoin**, which returns a valid handle to the group.</span></span>
-   <span data-ttu-id="7c92f-135">Ouverture d’un groupe homologue qu’un homologue a rejoint précédemment en appelant [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).</span><span class="sxs-lookup"><span data-stu-id="7c92f-135">Opening a peer group that a peer has joined previously by calling [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).</span></span> <span data-ttu-id="7c92f-136">Dans ce cas, l’obtention d’une invitation n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="7c92f-136">In this situation, obtaining an invitation is not necessary.</span></span>

<span data-ttu-id="7c92f-137">Une fois que vous avez obtenu un handle de groupe homologue valide à partir de l’une des fonctions ci-dessus, vous pouvez vous connecter à un groupe homologue en appelant [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) avec le nouveau handle.</span><span class="sxs-lookup"><span data-stu-id="7c92f-137">After you obtain a valid peer group handle from one of the above functions, you can connect to a peer group by calling [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) with the new handle.</span></span>

> [!Note]  
> <span data-ttu-id="7c92f-138">Si la connexion à un groupe homologue échoue, l’événement échec de la connexion à un événement de groupe HOMOLOGUe \_ \_ \_ \_ se produit.</span><span class="sxs-lookup"><span data-stu-id="7c92f-138">If the connection to a peer group fails, the PEER\_GROUP\_EVENT\_CONNECTION\_FAILED event occurs.</span></span> <span data-ttu-id="7c92f-139">Le gestionnaire peut tenter de rétablir la connexion au groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-139">The handler can attempt to reestablish the connection to the peer group.</span></span>

 

## <a name="registering-for-peer-grouping-events"></a><span data-ttu-id="7c92f-140">Inscription pour les événements de regroupement d’homologues</span><span class="sxs-lookup"><span data-stu-id="7c92f-140">Registering for Peer Grouping Events</span></span>

<span data-ttu-id="7c92f-141">Avant qu’un homologue ne participe à un groupe homologue, l’homologue doit s’inscrire pour les événements de groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-141">Before a peer participates in a peer group, the peer must register for peer group events.</span></span> <span data-ttu-id="7c92f-142">Pour s’inscrire à des événements homologues spécifiques, appelez [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent)et transmettez un ou plusieurs des types d’événements homologues définis dans \_ type d’événement de groupe pair \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="7c92f-142">To register for specific peer events, call [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent), and pass in one or more of the peer event types defined in PEER\_GROUP\_EVENT\_TYPE.</span></span> <span data-ttu-id="7c92f-143">Vous devez vous inscrire pour chaque événement homologue qui s’applique à votre application. par exemple, pour recevoir des données via une connexion directe, inscrivez-vous \_ aux \_ événements de connexion directe d’événement de groupe pair \_ et de \_ \_ \_ \_ données entrantes d’événement de groupe pair \_ .</span><span class="sxs-lookup"><span data-stu-id="7c92f-143">You must register for each peer event that applies to your application; for example, to receive data over a direct connection, register for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION and PEER\_GROUP\_EVENT\_INCOMING\_DATA events.</span></span> <span data-ttu-id="7c92f-144">Chaque appel prend un handle d’événement et retourne un handle **HPEEREVENT** pour cet événement homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-144">Each call takes an event handle and returns an **HPEEREVENT** handle for that peer event.</span></span>

<span data-ttu-id="7c92f-145">Les gestionnaires d’événements peuvent obtenir les données associées à un événement homologue en passant le handle aux événements homologues inscrits dans [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="7c92f-145">Event handlers can obtain the data associated with a peer event by passing the handle to registered peer events to [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="7c92f-146">Ces données d’événement homologues sont retournées sous la forme d’une Union de données d’événement de groupe HOMOLOGUe \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="7c92f-146">This peer event data is returned as a PEER\_GROUP\_EVENT\_DATA union.</span></span> <span data-ttu-id="7c92f-147">Si la file d’attente d’événements homologues est vide, cette fonction retourne l’HOMOLOGUe \_ S \_ sans \_ données d’événement \_ .</span><span class="sxs-lookup"><span data-stu-id="7c92f-147">If the peer event queue is empty, this function returns PEER\_S\_NO\_EVENT\_DATA.</span></span>

<span data-ttu-id="7c92f-148">Vous pouvez annuler l’inscription des événements homologues en appelant [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent) et en fournissant le descripteur de l’événement homologue dont vous souhaitez annuler l’inscription.</span><span class="sxs-lookup"><span data-stu-id="7c92f-148">You can unregister for peer events by calling [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent) and providing the handle for the peer event you want to unregister.</span></span> <span data-ttu-id="7c92f-149">Une fois la fonction appelée, les événements homologues associés au descripteur ne sont plus inscrits.</span><span class="sxs-lookup"><span data-stu-id="7c92f-149">After the function is called, the peer events associated with the handle are no longer registered.</span></span>

## <a name="creating-administrator-and-member-roles"></a><span data-ttu-id="7c92f-150">Création de rôles d’administrateur et de membre</span><span class="sxs-lookup"><span data-stu-id="7c92f-150">Creating Administrator and Member Roles</span></span>

<span data-ttu-id="7c92f-151">L’homologue qui crée le groupe homologue est appelé le créateur du groupe homologue et possède le rôle administrateur par défaut.</span><span class="sxs-lookup"><span data-stu-id="7c92f-151">The peer who creates the peer group is known as the peer group creator, and has the administrator role by default.</span></span> <span data-ttu-id="7c92f-152">Seul le créateur du groupe homologue peut définir les propriétés du groupe.</span><span class="sxs-lookup"><span data-stu-id="7c92f-152">Only the peer group creator can set the group properties.</span></span>

<span data-ttu-id="7c92f-153">Les pairs invités au groupe homologue peuvent être un administrateur ou un membre.</span><span class="sxs-lookup"><span data-stu-id="7c92f-153">Peers invited to the peer group can be either an administrator or a member.</span></span> <span data-ttu-id="7c92f-154">S’ils se voient attribuer un rôle d’administrateur par l’administrateur émettant l’invitation, ils peuvent inviter de nouveaux membres sur le groupe homologue, et également attribuer le rôle d’administrateur à d’autres membres.</span><span class="sxs-lookup"><span data-stu-id="7c92f-154">If they are assigned an administrator role by the administrator issuing the invitation, they can invite new members to the peer group, and likewise assign the administrator role to other members.</span></span>

<span data-ttu-id="7c92f-155">Les rôles des membres du groupe homologue sont définis dans les invitations que l’administrateur donne à un membre.</span><span class="sxs-lookup"><span data-stu-id="7c92f-155">The roles of peer group members are set in the invitations the administrator gives to a member.</span></span> <span data-ttu-id="7c92f-156">Pour ajouter d’autres administrateurs, définissez la valeur du paramètre *pRoles* de [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) sur administrateur de rôle de groupe homologue lors de la \_ \_ \_ création d’une invitation.</span><span class="sxs-lookup"><span data-stu-id="7c92f-156">To add more administrators, set the value of the *pRoles* parameter of [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) to PEER\_GROUP\_ROLE\_ADMIN when creating an invitation.</span></span>

<span data-ttu-id="7c92f-157">Les membres peuvent participer à un groupe homologue, mais ils ne peuvent pas inviter et autoriser de nouveaux membres, définir des propriétés de groupe ou mettre à jour ou supprimer des enregistrements de groupe qu’ils ne créent pas spécifiquement.</span><span class="sxs-lookup"><span data-stu-id="7c92f-157">Members can participate in a peer group, but cannot invite and authorize new members, set group properties, or update or delete group records that they do not specifically create.</span></span> <span data-ttu-id="7c92f-158">Pour affecter l’état d’un membre à un homologue participant, définissez la valeur du paramètre **pRoles** de [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) sur le membre du rôle de groupe homologue \_ \_ \_ lorsque vous créez une invitation pour cet homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-158">To assign member status to a participating peer, set the value of the **pRoles** parameter of [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) to PEER\_GROUP\_ROLE\_MEMBER when you create an invitation for that peer.</span></span>

<span data-ttu-id="7c92f-159">Pour modifier le rôle d’un membre, les nouvelles informations d’identification contenant le nouveau rôle doivent être délivrées à ce membre.</span><span class="sxs-lookup"><span data-stu-id="7c92f-159">To change the role of a member, new credentials containing the new role must be issued to that member.</span></span> <span data-ttu-id="7c92f-160">Pour ce faire, obtenez la structure des [**\_ \_ informations d’identification de l’homologue**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) pour ce membre à partir de la structure de membre homologue \_ retournée par [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers).</span><span class="sxs-lookup"><span data-stu-id="7c92f-160">To accomplish this, obtain the [**PEER\_CREDENTIAL\_INFO**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) structure for this member from the PEER\_MEMBER structure returned by [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers).</span></span> <span data-ttu-id="7c92f-161">Remplacez le champ **pRoles** dans **\_ \_ informations d’identification de l’homologue** par le nouveau rôle et passez la structure à [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials).</span><span class="sxs-lookup"><span data-stu-id="7c92f-161">Change the **pRoles** field in **PEER\_CREDENTIAL\_INFO** to the new role, and pass the structure to [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials).</span></span>

<span data-ttu-id="7c92f-162">Les nouvelles informations d’identification n’entrent pas en vigueur pour l’homologue jusqu’à ce qu’elles se connectent au groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-162">The new credentials will not go into effect for the peer until they connect to the peer group.</span></span> <span data-ttu-id="7c92f-163">S’ils sont actuellement connectés, ils doivent fermer le groupe et se reconnecter pour obtenir les informations d’identification mises à jour.</span><span class="sxs-lookup"><span data-stu-id="7c92f-163">If they are currently connected, they must close the group and reconnect to obtain the updated credentials.</span></span>

## <a name="finding-a-peer"></a><span data-ttu-id="7c92f-164">Recherche d’un homologue</span><span class="sxs-lookup"><span data-stu-id="7c92f-164">Finding a Peer</span></span>

<span data-ttu-id="7c92f-165">Pour obtenir une liste énumérée de tous les pairs qui participent au groupe pair, appelez [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers) avec le descripteur de groupe, qui retourne un handle à l’énumération.</span><span class="sxs-lookup"><span data-stu-id="7c92f-165">To obtain an enumerated list of all peers participating in the peer group, call [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers) with the group handle, which returns a handle to the enumeration.</span></span> <span data-ttu-id="7c92f-166">Pour obtenir les membres, appelez [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) avec le handle enum et le nombre de membres à récupérer.</span><span class="sxs-lookup"><span data-stu-id="7c92f-166">To obtain the members, call [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) with the enum handle and the number of members to retrieve.</span></span> <span data-ttu-id="7c92f-167">Continue d’appeler **PeerGetNextItem** jusqu’à ce que le paramètre *pCount* retourne une valeur inférieure au nombre de membres demandés.</span><span class="sxs-lookup"><span data-stu-id="7c92f-167">Continue calling **PeerGetNextItem** until the *pCount* parameter returns a value less than the number of members requested.</span></span> <span data-ttu-id="7c92f-168">Notez que la liste complète des membres disponibles ne peut pas être retournée.</span><span class="sxs-lookup"><span data-stu-id="7c92f-168">Note that the complete list of available members may not be returned.</span></span>

<span data-ttu-id="7c92f-169">Chaque membre est représenté sous la forme d’une structure de [**\_ membre homologue**](/windows/desktop/api/P2P/ns-p2p-peer_member) , qui contient l’identité de l’homologue, les ID de nœud et les adresses IP des homologues actifs.</span><span class="sxs-lookup"><span data-stu-id="7c92f-169">Each member is represented as a [**PEER\_MEMBER**](/windows/desktop/api/P2P/ns-p2p-peer_member) structure, which contains the identity of the peer, node IDs, and IP addresses for active peers.</span></span>

<span data-ttu-id="7c92f-170">Lorsque vous avez terminé, fermez l’énumération et libérez la mémoire associée en appelant [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span><span class="sxs-lookup"><span data-stu-id="7c92f-170">When finished, close the enumeration and release the associated memory by calling [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span></span>

## <a name="connecting-directly-to-a-peer"></a><span data-ttu-id="7c92f-171">Connexion directe à un homologue</span><span class="sxs-lookup"><span data-stu-id="7c92f-171">Connecting Directly to a Peer</span></span>

<span data-ttu-id="7c92f-172">Lorsqu’un homologue est connecté à un groupe homologue, les échanges de type un-à-un avec d’autres membres connectés sont initiés en appelant [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) et en fournissant l’identité de l’autre homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-172">When a peer is connected to a peer group, direct one-to-one exchanges with other connected members are initiated by calling [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) and supplying the identity of the other peer.</span></span> <span data-ttu-id="7c92f-173">Cet appel est asynchrone et retourne un ID de connexion 64 bits.</span><span class="sxs-lookup"><span data-stu-id="7c92f-173">This call is asynchronous, and returns a 64-bit connection ID.</span></span> <span data-ttu-id="7c92f-174">Si l’appel réussit, vous recevez l' \_ \_ \_ \_ \_ événement homologue d’événement de connexion directe d’événement de groupe homologue pour indiquer que la connexion a réussi.</span><span class="sxs-lookup"><span data-stu-id="7c92f-174">If the call is successful, you receive the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION\_EVENT peer event to indicate that the connection is successful.</span></span> <span data-ttu-id="7c92f-175">Si la connexion réussit, l’ID de connexion est valide et peut être utilisé pour envoyer et recevoir des données via la connexion directe.</span><span class="sxs-lookup"><span data-stu-id="7c92f-175">If the connection is successful, the connection ID is valid and can be used to send and receive data through the direct connection.</span></span>

<span data-ttu-id="7c92f-176">Pour pouvoir recevoir des connexions directes, l’autre homologue doit également avoir été précédemment inscrit pour l' \_ \_ événement d' \_ homologue de connexion directe d’événement de groupe pair \_ .</span><span class="sxs-lookup"><span data-stu-id="7c92f-176">To be able to receive direct connections, the other peer must also have previously registered for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION peer event.</span></span>

<span data-ttu-id="7c92f-177">Pour envoyer des données à un homologue, appelez [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata) avec un ID de connexion valide.</span><span class="sxs-lookup"><span data-stu-id="7c92f-177">To send data to a peer, call [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata) with a valid connection ID.</span></span> <span data-ttu-id="7c92f-178">Pour recevoir des données, l’autre homologue doit être inscrit pour \_ l' \_ \_ \_ événement homologue des données entrantes de l’événement de groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-178">To receive data, the other peer must be registered for the PEER\_GROUP\_EVENT\_INCOMING\_DATA peer event.</span></span> <span data-ttu-id="7c92f-179">De même, si l’homologue expéditeur souhaite recevoir des données à son tour, il doit également être inscrit pour l' \_ \_ \_ \_ événement homologue des données entrantes de l’événement de groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="7c92f-179">Likewise, if the sending peer wants to receive data in turn, it also must be registered for the PEER\_GROUP\_EVENT\_INCOMING\_DATA peer event.</span></span>

<span data-ttu-id="7c92f-180">Pour recevoir le jeu total de connexions directes actuellement actives avec d’autres pairs dans un groupe, appelez [**PeerGroupEnumConnections**](/windows/desktop/api/P2P/nf-p2p-peergroupenumconnections) pour ouvrir l’énumération et itérer dans la liste des connexions à l’aide de [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem).</span><span class="sxs-lookup"><span data-stu-id="7c92f-180">To receive the total set of currently active direct connections with other peers in a group, call [**PeerGroupEnumConnections**](/windows/desktop/api/P2P/nf-p2p-peergroupenumconnections) to open the enumeration and iterate through the list of connections by using [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem).</span></span>

<span data-ttu-id="7c92f-181">Pour fermer une connexion directe, appelez [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) et transmettez l’ID de connexion.</span><span class="sxs-lookup"><span data-stu-id="7c92f-181">To close a direct connection, call [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) and pass in the connection ID.</span></span>

## <a name="closing-and-shutting-down-a-peer-group"></a><span data-ttu-id="7c92f-182">Fermeture et arrêt d’un groupe homologue</span><span class="sxs-lookup"><span data-stu-id="7c92f-182">Closing and Shutting Down a Peer Group</span></span>

<span data-ttu-id="7c92f-183">Pour fermer une connexion à un groupe homologue, appelez [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), qui invalide le descripteur de groupe, mais n’arrête pas l’infrastructure de regroupement d’homologues.</span><span class="sxs-lookup"><span data-stu-id="7c92f-183">To close a connection to a peer group, call [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), which invalidates the group handle, but does not shut down the Peer Grouping Infrastructure.</span></span> <span data-ttu-id="7c92f-184">Les données de groupe d’égal à égal sont supprimées en appelant [**PeerGroupDelete**](/windows/desktop/api/P2P/nf-p2p-peergroupdelete).</span><span class="sxs-lookup"><span data-stu-id="7c92f-184">Peer-to-peer group data is deleted by calling [**PeerGroupDelete**](/windows/desktop/api/P2P/nf-p2p-peergroupdelete).</span></span>

<span data-ttu-id="7c92f-185">Lorsque l’application a terminé d’utiliser l’infrastructure de regroupement d’homologues, elle doit appeler [**PeerGroupShutdown**](/windows/desktop/api/P2P/nf-p2p-peergroupshutdown).</span><span class="sxs-lookup"><span data-stu-id="7c92f-185">When the application is finished using the Peer Grouping Infrastructure, it must call [**PeerGroupShutdown**](/windows/desktop/api/P2P/nf-p2p-peergroupshutdown).</span></span>

 

 



