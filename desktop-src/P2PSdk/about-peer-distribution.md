---
description: L’API de distribution d’homologue, qui prend en charge la fonctionnalité Branch cache dans Windows 7, Windows Server 2008 R2, Windows 8 et Windows Server 2012, offre un ensemble d’API de plateforme qui peuvent augmenter la réactivité du réseau des applications centralisées quand elles sont accessibles à partir de bureaux distants et aident à réduire l’utilisation globale du réseau étendu sans interférer avec les technologies de sécurité
ms.assetid: feb9666e-563a-49f4-ad1c-f166a0faff31
title: À propos de la distribution d’homologue
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b5b9a99a65ea2cfda6dc8ad9accd4d881529e87
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103865181"
---
# <a name="about-peer-distribution"></a><span data-ttu-id="5cdfa-103">À propos de la distribution d’homologue</span><span class="sxs-lookup"><span data-stu-id="5cdfa-103">About Peer Distribution</span></span>

<span data-ttu-id="5cdfa-104">L’API de distribution d’homologue, qui prend en charge la fonctionnalité Branch cache dans Windows 7, Windows Server 2008 R2, Windows 8 et Windows Server 2012, offre un ensemble d’API de plateforme qui peuvent augmenter la réactivité du réseau des applications centralisées quand elles sont accessibles à partir de bureaux distants et aident à réduire l’utilisation globale du réseau étendu sans interférer avec les technologies de sécurité</span><span class="sxs-lookup"><span data-stu-id="5cdfa-104">The Peer Distribution API, which supports the Branch Cache feature in Windows 7, Windows Server 2008 R2, Windows 8, and Windows Server 2012 offers a set of platform APIs that can increase network responsiveness of centralized applications when accessed from remote offices and aid in reducing overall wide area network (WAN) utilization without interfering with the network security technologies.</span></span>

<span data-ttu-id="5cdfa-105">Le système de distribution d’homologue offre un ensemble d’API de plateforme utilisées par les serveurs de publication qui fournissent du contenu numérique et des consommateurs qui le demandent.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-105">The Peer Distribution system offers a set of platform APIs utilized by both the publishers that provide digital content and consumers that request it.</span></span> <span data-ttu-id="5cdfa-106">Pour distinguer facilement ces rôles, il peut être plus facile de considérer l’éditeur dans un rôle de serveur et le consommateur dans un rôle de client.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-106">To easily differentiate these roles, it may be easier to think of the publisher in a server role and the consumer in a client role.</span></span> <span data-ttu-id="5cdfa-107">Là encore, il est important de garder à l’esprit qu’en dehors de ces rôles conceptuels, le service de distribution pair à pair est un véritable système pair, comme indiqué par la capacité de n’importe quel nœud de distribution pair à publier et à consommer du contenu numérique.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-107">That aside, it is important to remember that aside from these conceptual roles, the Peer Distribution service is a true peer system, as indicated by the ability for any Peer Distribution node to both publish and consume digital content.</span></span> <span data-ttu-id="5cdfa-108">Les API de plateforme de distribution d’homologue sont exposées aux éditeurs et aux consommateurs par une bibliothèque d’importation Win32 (**PeerDist. lib**).</span><span class="sxs-lookup"><span data-stu-id="5cdfa-108">The Peer Distribution platform APIs are exposed to publishers and consumers by a Win32 import library (**PeerDist.Lib**).</span></span>

<span data-ttu-id="5cdfa-109">Le cycle de vie du contenu fourni par un serveur de publication et récupéré par un consommateur avec le service de distribution pair à pair se compose des opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="5cdfa-109">The lifecycle of content supplied by a publisher and retrieved by a consumer with the Peer Distribution service is composed of the following operations:</span></span>



|                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5cdfa-110">**Publication de contenu**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-110">**Content Publication**</span></span> | <span data-ttu-id="5cdfa-111">La publication est effectuée pour obtenir une description des informations de contenu de termes de contenu ou des **informations** de **contenu** pour Short.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-111">Publishing is done to produce a description of content termed **Content Information**, or **Content Info** for short.</span></span> <span data-ttu-id="5cdfa-112">Ces informations de contenu peuvent ensuite être utilisées par une instance du service de distribution d’homologue pour authentifier et reconstruire le contenu.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-112">This Content Info can then be used by an instance of the Peer Distribution service to authenticate and rebuild the content.</span></span> <span data-ttu-id="5cdfa-113">Lorsque le contenu est publié par une application dans le service de distribution d’homologue, qui est conceptuellement une opération côté serveur, ce contenu est associé à l’identité de l’éditeur, qui est basé sur le SID de l’utilisateur associé au jeton d’accès au thread.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-113">When content is published by an application into the Peer Distribution service, which is conceptually a server-side operation, that content becomes associated with the Publisher Identity, which is based on the SID of the user associated with the thread access token.</span></span> <span data-ttu-id="5cdfa-114">Cette liaison est effectuée pour limiter l’accès au contenu par des entités non autorisées.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-114">This binding is done to limit access to content by unauthorized entities.</span></span> <span data-ttu-id="5cdfa-115">Toutefois, il est important de noter que l’accès aux informations de contenu est équivalent à l’accès au contenu proprement dit, car les informations de contenu peuvent être utilisées pour obtenir le contenu à partir d’homologues ou d’un cache hébergé.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-115">However, it is important to note that access to the content information is equivalent to access to the content itself, as the content information can be used to obtain the content from peers or a hosted cache.</span></span><br/> <span data-ttu-id="5cdfa-116">Il existe une nouvelle version de la structure de données d’informations de contenu dans Windows 8 ; Toutefois, la version précédente est toujours prise en charge.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-116">There is a new version of the content information data structure in Windows 8; however, the previous version is still supported.</span></span> <span data-ttu-id="5cdfa-117">Pour interagir avec les clients Windows 7, un administrateur peut configurer le service de distribution d’homologues pour utiliser la version précédente de la structure de données d’informations de contenu.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-117">To interoperate with Windows 7 clients, an administrator may configure the Peer Distribution service to use the previous version of the content information data structure.</span></span><br/> |
| <span data-ttu-id="5cdfa-118">**Récupération du contenu**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-118">**Content Retrieval**</span></span>   | <span data-ttu-id="5cdfa-119">Pour qu’un consommateur récupère du contenu à partir du service de distribution d’homologue, l’accès doit être fourni aux informations de contenu publiées associées à ce contenu.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-119">For a consumer to retrieve content from the Peer Distribution service, access must be provided to the published Content Info associated with that content.</span></span> <span data-ttu-id="5cdfa-120">Le service de distribution d’homologue utilisé pour publier le contenu peut fournir les informations de contenu associées.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-120">The Peer Distribution service used to publish the content can provide the associated Content Info.</span></span> <span data-ttu-id="5cdfa-121">Une fois que le consommateur dispose des informations de contenu, d’autres API de distribution d’homologue peuvent être utilisées pour demander du contenu auprès du service de distribution d’homologue.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-121">Once the consumer has the Content Info, other Peer Distribution APIs can be used to request content from the Peer Distribution service.</span></span> <span data-ttu-id="5cdfa-122">Le service de distribution d’homologue va tenter de récupérer le contenu à partir du réseau local.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-122">The Peer Distribution service will attempt to retrieve the content from the local network.</span></span> <span data-ttu-id="5cdfa-123">Si le contenu n’est pas disponible, l’application cliente est chargée de récupérer le contenu à partir du serveur source.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-123">If the content is not available, the client application is responsible for retrieving the content from the source server.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="5cdfa-124">**Suppression de la publication**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-124">**Publication Removal**</span></span> | <span data-ttu-id="5cdfa-125">Pour les applications qui ont publié du contenu dans le service de distribution d’homologue, la fonction [**PeerDistServerUnpublish**](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverunpublish) a été fournie pour permettre l’annulation de la publication du contenu.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-125">For applications that have published content into the Peer Distribution service, the [**PeerDistServerUnpublish**](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverunpublish) function has been provided to allow content to be unpublished.</span></span> <span data-ttu-id="5cdfa-126">Une fois que le contenu n’a pas été publié, le service de distribution d’homologue local ne fournit plus les informations de contenu associées à ce contenu.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-126">Once content has been unpublished, the local Peer Distribution service will no longer provide the content info associated with that content.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="asynchronous-completions"></a><span data-ttu-id="5cdfa-127">Saisie semi-automatique asynchrone</span><span class="sxs-lookup"><span data-stu-id="5cdfa-127">Asynchronous Completions</span></span>

<span data-ttu-id="5cdfa-128">L’API de distribution d’homologue prend en charge un modèle d’API asynchrone et, en tant que résultat, les API de distribution d’homologue permettent d’utiliser des ports de terminaison d’e/s ou des événements comme mécanismes de signalisation pour traiter les saisies semi-automatiques des opérations de distribution d’homologue asynchrones.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-128">The Peer Distribution API supports an asynchronous API model, and as a result Peer Distribution APIs allow for the use of either I/O Completion Ports or Events as the signaling mechanisms for processing asynchronous Peer Distribution operation completions.</span></span> <span data-ttu-id="5cdfa-129">Pour les deux mécanismes, la distribution d’homologue utilise une structure [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) .</span><span class="sxs-lookup"><span data-stu-id="5cdfa-129">For either mechanism, Peer Distribution uses an [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure.</span></span> <span data-ttu-id="5cdfa-130">En général, la distribution d’homologue prend la propriété d’une structure **OVERLAPPED** et de tous les paramètres de sortie que le client passe aux fonctions API asynchrones.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-130">In general, Peer Distribution takes the ownership of an **OVERLAPPED** structure and any out parameters that the Client passes to asynchronous API functions.</span></span> <span data-ttu-id="5cdfa-131">Le client ne doit pas accéder à ces ressources tant que la fonction asynchrone particulière n’est pas terminée.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-131">The Client must not access these resources until the particular asynchronous function completes.</span></span> <span data-ttu-id="5cdfa-132">Dès que les fonctions asynchrones sont terminées, le service de distribution d’homologue n’a plus besoin d’accéder à ces ressources et elles peuvent être réutilisées à mesure que l’application appelante s’affiche.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-132">As soon as the asynchronous functions completes, the Peer Distribution service will no longer require access to these resources and they may be reused as the calling application sees fit.</span></span>

<span data-ttu-id="5cdfa-133">Il n’y aura pas de saisie semi-automatique asynchrone si la fonction retourne un code d’erreur autre que des **\_ e/s d’erreur \_ en attente**.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-133">There will not be any asynchronous completion if the function returns any error code other than **ERROR\_IO\_PENDING**.</span></span> <span data-ttu-id="5cdfa-134">Le retour d’une valeur autre que l' **erreur d' \_ e/s \_ en attente** signifie que l’appel a échoué de façon synchrone.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-134">The return of a value other than **ERROR\_IO\_PENDING** means that the call has failed synchronously.</span></span> <span data-ttu-id="5cdfa-135">Si l’API de distribution d’homologue retourne des **\_ e/s d’erreur \_ en attente**, l’appelant doit attendre la fin asynchrone.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-135">If the Peer Distribution API returns **ERROR\_IO\_PENDING**, the caller must wait for asynchronous completion.</span></span>

<span data-ttu-id="5cdfa-136">Le code d’erreur de la saisie semi-automatique asynchrone peut être récupéré de l’une des deux manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="5cdfa-136">The error code of the asynchronous completion can be retrieved in one of two ways:</span></span>

<span data-ttu-id="5cdfa-137">**Achèvement basé sur le port de terminaison d’e/s**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-137">**I/O Completion Port Based Completion**</span></span>

<span data-ttu-id="5cdfa-138">L’utilisateur appelle le mécanisme de port de terminaison d’e/s en fournissant un handle de port d’achèvement et une clé de fin aux fonctions d’API suivantes :</span><span class="sxs-lookup"><span data-stu-id="5cdfa-138">User invokes the I/O completion port mechanism by providing a completion port handle and completion key to the following API functions:</span></span>

<dl>

[<span data-ttu-id="5cdfa-139">**PeerDistRegisterForStatusChangeNotification**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-139">**PeerDistRegisterForStatusChangeNotification**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistregisterforstatuschangenotification)  
[<span data-ttu-id="5cdfa-140">**PeerDistServerPublishStream**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-140">**PeerDistServerPublishStream**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverpublishstream)  
[<span data-ttu-id="5cdfa-141">**PeerDistServerOpenContentInformation**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-141">**PeerDistServerOpenContentInformation**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserveropencontentinformation)  
[<span data-ttu-id="5cdfa-142">**PeerDistClientOpenContent**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-142">**PeerDistClientOpenContent**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistclientopencontent)  
</dl>

<span data-ttu-id="5cdfa-143">L’utilisateur crée un port de terminaison en appelant [**CreateIoCompletionPort**](/windows/desktop/FileIO/createiocompletionport).</span><span class="sxs-lookup"><span data-stu-id="5cdfa-143">The User creates a completion port by calling [**CreateIoCompletionPort**](/windows/desktop/FileIO/createiocompletionport).</span></span> <span data-ttu-id="5cdfa-144">Ce handle de port d’achèvement peut être utilisé simultanément pour d’autres opérations d’e/s asynchrones, ainsi que pour des opérations spécifiques de distribution d’homologue.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-144">This completion port handle can be simultaneously used for other asynchronous I/O operations as well as Peer Distribution specific operations.</span></span>

<span data-ttu-id="5cdfa-145">L’appelant doit utiliser la fonction [**GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) pour gérer la saisie semi-automatique asynchrone.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-145">The caller should use [**GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) function to manage asynchronous completion.</span></span> <span data-ttu-id="5cdfa-146">Si l’opération asynchrone échoue, la fonction **GetQueuedCompletionStatus** retourne la **valeur false** et [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) retourne le code d’erreur approprié.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-146">If the asynchronous operation fails the **GetQueuedCompletionStatus** function will return **FALSE** and [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) will return the appropriate error code.</span></span> <span data-ttu-id="5cdfa-147">L’appelant doit ignorer tous les champs de la structure [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) si le code d’erreur est différent du **\_ succès** de l’erreur.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-147">The caller should ignore all the fields of the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure if the error code is anything other than **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="5cdfa-148">L’opération asynchrone est réussie si la fonction **GetQueuedCompletionStatus** retourne la **valeur true**.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-148">The asynchronous operation succeeds if the **GetQueuedCompletionStatus** function returns **TRUE**.</span></span>

<span data-ttu-id="5cdfa-149">Pour plus d’informations, consultez [ports de terminaison d’e/s](/windows/desktop/FileIO/i-o-completion-ports).</span><span class="sxs-lookup"><span data-stu-id="5cdfa-149">For more information see [I/O Completion Ports](/windows/desktop/FileIO/i-o-completion-ports).</span></span>

<span data-ttu-id="5cdfa-150">**Achèvement basé sur les événements**</span><span class="sxs-lookup"><span data-stu-id="5cdfa-150">**Event Based Completion**</span></span>

<span data-ttu-id="5cdfa-151">Si l’appelant définit un handle d’événement valide pour le champ *hEvent* de la structure [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) , la distribution d’homologue l’utilise pour signaler que l’opération d’e/s asynchrone associée est terminée.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-151">If the caller sets a valid Event handle to the *hEvent* field of [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure, Peer Distribution uses it to signal that the associated asynchronous I/O operation has completed.</span></span>

<span data-ttu-id="5cdfa-152">Un appelant de thread peut gérer des opérations avec chevauchement en spécifiant un handle vers l’objet d’événement de réinitialisation manuelle de la structure [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) dans l’une des fonctions d’attente.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-152">A thread caller can manage overlapped operations by specifying a handle to the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure's manual-reset event object in one of the wait functions.</span></span> <span data-ttu-id="5cdfa-153">Une fois l’événement signalé, l’appelant doit appeler [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**) en passant la structure **OVERLAPPED** appropriée.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-153">After the Event is signaled the caller must call [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**) passing in the appropriate **OVERLAPPED** structure.</span></span> <span data-ttu-id="5cdfa-154">**PeerGetOverlappedResult** retourne la **valeur false** et l’appelant doit appeler [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) pour récupérer le code d’erreur.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-154">**PeerGetOverlappedResult** will return **FALSE** and the caller must call [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) in order to retrieve the error code.</span></span> <span data-ttu-id="5cdfa-155">L’appelant doit ignorer tous les champs de la structure **OVERLAPPED** si le code d’erreur est différent du **\_ succès** de l’erreur.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-155">The caller should ignore all the fields of the **OVERLAPPED** structure if the error code is anything other than **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="5cdfa-156">L’opération asynchrone est réussie si la fonction **PeerGetOverlappedResult** retourne la **valeur true**.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-156">The asynchronous operation succeeds if the **PeerGetOverlappedResult** function returns **TRUE**.</span></span>

<span data-ttu-id="5cdfa-157">Si l’appelant fournit un port de terminaison avec un événement, l’événement sera utilisé comme mécanisme de terminaison.</span><span class="sxs-lookup"><span data-stu-id="5cdfa-157">If the caller provides a completion port along with an event, the event will be used as the completion mechanism.</span></span>

<span data-ttu-id="5cdfa-158">**Windows 7 :** Utilisez la fonction [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) à la place de [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**).</span><span class="sxs-lookup"><span data-stu-id="5cdfa-158">**Windows 7:** Use the [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) function instead of [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5cdfa-159">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="5cdfa-159">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5cdfa-160">Informations de référence sur l’API de distribution d’homologue</span><span class="sxs-lookup"><span data-stu-id="5cdfa-160">Peer Distribution API Reference</span></span>](peer-distribution-api-reference.md)
</dt> </dl>

 

