---
description: Un enregistrement de groupe est une donnée spécifique publiée à tous les membres actifs d’un groupe homologue, par exemple un message de conversation ou une mise à jour d’état spécifique à l’application.
ms.assetid: 073ee4e9-0e97-451a-a808-8265575d073c
title: Gestion des enregistrements de groupe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3b6d9e3257cc597b715dc9c65eb5945c00c15286
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106536368"
---
# <a name="managing-group-records"></a><span data-ttu-id="2626b-103">Gestion des enregistrements de groupe</span><span class="sxs-lookup"><span data-stu-id="2626b-103">Managing Group Records</span></span>

<span data-ttu-id="2626b-104">Un enregistrement de groupe est une donnée spécifique publiée à tous les membres actifs d’un groupe homologue, par exemple un message de conversation ou une mise à jour d’état spécifique à l’application.</span><span class="sxs-lookup"><span data-stu-id="2626b-104">A group record is specific data published to all active members of a peer group, for example, a chat message or an application-specific status update.</span></span> <span data-ttu-id="2626b-105">Un enregistrement est représenté par la structure de l' [**\_ enregistrement homologue**](/windows/desktop/api/P2P/ns-p2p-peer_record) et contient les informations suivantes sur un homologue :</span><span class="sxs-lookup"><span data-stu-id="2626b-105">A record is represented by the [**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record) structure, and contains the following information about a peer:</span></span>

-   <span data-ttu-id="2626b-106">L’ID d’enregistrement est une valeur qui identifie de façon unique un enregistrement dans le groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="2626b-106">The record ID is a value that uniquely identifies a record in the peer group.</span></span>
-   <span data-ttu-id="2626b-107">GUID qui spécifie le type d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2626b-107">A GUID that specifies the record type.</span></span> <span data-ttu-id="2626b-108">Les applications peuvent prendre en charge différents types d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="2626b-108">Applications can support different record types.</span></span> <span data-ttu-id="2626b-109">Une application interprète le champ de **données** d’un enregistrement en fonction du type d’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2626b-109">An application interprets the **data** field of a record based on the record type.</span></span> <span data-ttu-id="2626b-110">Certains GUID sont réservés, et l’appel d’API retourne l' **homologue \_ E \_ non \_ autorisé** lorsque l’application tente de les utiliser.</span><span class="sxs-lookup"><span data-stu-id="2626b-110">Some GUIDs are reserved, and the API call returns **PEER\_E\_NOT\_AUTHORIZED** when the application attempts to use them.</span></span>
-   <span data-ttu-id="2626b-111">Ensemble d’attributs d’enregistrement décrits comme une chaîne XML.</span><span class="sxs-lookup"><span data-stu-id="2626b-111">A set of record attributes described as an XML string.</span></span> <span data-ttu-id="2626b-112">Les attributs sont utilisés lors de la recherche d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="2626b-112">The attributes are used when searching records.</span></span> <span data-ttu-id="2626b-113">Pour plus d’informations sur les attributs, consultez [enregistrement du schéma d’attribut](record-attribute-schema.md).</span><span class="sxs-lookup"><span data-stu-id="2626b-113">For more information about attributes, see [Record Attribute Schema](record-attribute-schema.md).</span></span>
-   <span data-ttu-id="2626b-114">Heure d’homologue à laquelle un enregistrement est créé.</span><span class="sxs-lookup"><span data-stu-id="2626b-114">The peer time that a record is created.</span></span>
-   <span data-ttu-id="2626b-115">Temps d’homologation d’expiration d’un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2626b-115">The peer time that a record expires.</span></span>
-   <span data-ttu-id="2626b-116">Temps d’attente de modification d’un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2626b-116">The peer time that a record is modified.</span></span>
-   <span data-ttu-id="2626b-117">Créateur d’un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2626b-117">The creator of a record.</span></span>
-   <span data-ttu-id="2626b-118">Membre qui modifie un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2626b-118">The member who modifies a record.</span></span>
-   <span data-ttu-id="2626b-119">Structure [**de \_ données d’homologue**](/windows/desktop/api/P2P/ns-p2p-peer_data) qui contient la signature de chiffrement pour tous les champs de cette structure d' [**\_ enregistrement d’homologue**](/windows/desktop/api/P2P/ns-p2p-peer_record) .</span><span class="sxs-lookup"><span data-stu-id="2626b-119">A [**PEER\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_data) structure that contains the cryptographic signature for all of the fields in this [**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record) structure.</span></span> <span data-ttu-id="2626b-120">Ce champ ne peut pas être directement mis à jour ou modifié par un homologue.</span><span class="sxs-lookup"><span data-stu-id="2626b-120">This field cannot be directly updated or altered by a peer.</span></span>
-   <span data-ttu-id="2626b-121">Structure [**de \_ données d’homologue**](/windows/desktop/api/P2P/ns-p2p-peer_data) qui contient les données spécifiques à l’application associées à cet enregistrement sous la forme d’un tableau d’octets.</span><span class="sxs-lookup"><span data-stu-id="2626b-121">A [**PEER\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_data) structure that contains the application-specific data associated with this record as an array of bytes.</span></span> <span data-ttu-id="2626b-122">Le type de données présent dans ce champ est déterminé par le type d’enregistrement défini par l’application.</span><span class="sxs-lookup"><span data-stu-id="2626b-122">The type of data present in this field is determined by application-defined record type.</span></span>

## <a name="obtaining-peer-group-records"></a><span data-ttu-id="2626b-123">Obtention d’enregistrements de groupe homologue</span><span class="sxs-lookup"><span data-stu-id="2626b-123">Obtaining Peer Group Records</span></span>

<span data-ttu-id="2626b-124">Les enregistrements individuels sont obtenus en appelant [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) avec l’ID de l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2626b-124">Individual records are obtained by calling [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) with the ID of the record.</span></span> <span data-ttu-id="2626b-125">Lors du traitement de tous les enregistrements d’un type spécifique, l’ensemble énuméré de tous les enregistrements du groupe homologue actuel est obtenu en appelant [**PeerGroupEnumRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupenumrecords) pour ouvrir l’énumération, puis en appelant de manière itérative [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) jusqu’à ce que tous les enregistrements soient récupérés.</span><span class="sxs-lookup"><span data-stu-id="2626b-125">When processing all records of a specific type, the enumerated set of all current peer group records is obtained by first calling [**PeerGroupEnumRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupenumrecords) to open the enumeration and then iteratively calling [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) until all records are retrieved.</span></span> <span data-ttu-id="2626b-126">Lorsque vous avez terminé, fermez l’énumération et libérez la mémoire qui lui est associée en appelant [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span><span class="sxs-lookup"><span data-stu-id="2626b-126">When finished, close the enumeration and release the memory associated with it by calling [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span></span>

<span data-ttu-id="2626b-127">Lorsqu’un enregistrement est créé, supprimé ou mis à jour par un homologue, l’enregistrement affecté est publié sur tous les membres du groupe homologue par le biais de l’événement de modification de l' **\_ enregistrement d’événement du groupe \_ \_ \_ pair** .</span><span class="sxs-lookup"><span data-stu-id="2626b-127">When a record is created, deleted, or updated by a peer, the affected record is published to all members of the peer group by way of the **PEER\_GROUP\_EVENT\_RECORD\_CHANGE** event.</span></span> <span data-ttu-id="2626b-128">Notez que si un homologue n’est pas connecté au groupe, il recevra l’enregistrement mis à jour, puis la prochaine fois qu’il se connectera.</span><span class="sxs-lookup"><span data-stu-id="2626b-128">Note that if a peer is not connected to the group, it will receive the updated record then next time it connects.</span></span> <span data-ttu-id="2626b-129">Il est important de s’inscrire à cet événement avec [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) si votre application gère ou gère les enregistrements de manière explicite.</span><span class="sxs-lookup"><span data-stu-id="2626b-129">It is important to register for this event with [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) if your application maintains or manages records in any meaningful way.</span></span> <span data-ttu-id="2626b-130">L’application peut également interroger la base de données d’enregistrement à la demande à l’aide de [**PeerGroupSearchRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupsearchrecords).</span><span class="sxs-lookup"><span data-stu-id="2626b-130">Alternatively, the application can query the record database on demand using [**PeerGroupSearchRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupsearchrecords).</span></span>

<span data-ttu-id="2626b-131">Lorsque l’événement de **modification d’enregistrement d' \_ événement de groupe \_ \_ \_ pair** est déclenché, l’ID d’enregistrement et le type spécifiques, ainsi que le type de modification (ajout, mise à jour, suppression) sont reçus comme une structure de [**données de modification d' \_ enregistrement d’événement \_ \_ \_ homologue**](/windows/desktop/api/P2P/ns-p2p-peer_event_record_change_data) .</span><span class="sxs-lookup"><span data-stu-id="2626b-131">When the **PEER\_GROUP\_EVENT\_RECORD\_CHANGE** event is raised, the specific record ID and type as well as the type of change (add, update, delete) is received as a [**PEER\_EVENT\_RECORD\_CHANGE\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_event_record_change_data) structure.</span></span> <span data-ttu-id="2626b-132">Cette structure est obtenue à l’aide d’un appel à [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="2626b-132">This structure is obtained with a call to [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="2626b-133">Si la modification est un ajout ou une mise à jour, vous devez utiliser [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) pour obtenir l’enregistrement avec l’ID fourni.</span><span class="sxs-lookup"><span data-stu-id="2626b-133">If the change is an add or an update, you should use [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) to obtain the record with the supplied ID.</span></span> <span data-ttu-id="2626b-134">La base de données d’enregistrement locale pour l’infrastructure est mise à jour automatiquement.</span><span class="sxs-lookup"><span data-stu-id="2626b-134">The local record database for the infrastructure is updated automatically.</span></span>

<span data-ttu-id="2626b-135">Vous pouvez également rechercher des enregistrements spécifiques en fonction d’attributs personnalisés spécifiques fournis dans le champ **pwzAttributes** de l' [**\_ enregistrement homologue**](/windows/desktop/api/P2P/ns-p2p-peer_record), ainsi que de tous les attributs prédéfinis.</span><span class="sxs-lookup"><span data-stu-id="2626b-135">You can also search for specific records based on specific custom attributes supplied in the **pwzAttributes** field of [**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record), as well as any predefined attributes.</span></span> <span data-ttu-id="2626b-136">Pour ce faire, utilisez la fonction [**PeerGroupSearchRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupsearchrecords) avec une requête de recherche XML mise en forme comme spécifié dans la rubrique [format de requête de recherche d’enregistrements](record-search-query-format.md) .</span><span class="sxs-lookup"><span data-stu-id="2626b-136">To accomplish this, use the [**PeerGroupSearchRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupsearchrecords) function with an XML search query formatted as specified in the [Record Search Query Format](record-search-query-format.md) topic.</span></span>

<span data-ttu-id="2626b-137">Pour plus d’informations sur l’utilisation des enregistrements dans l’infrastructure homologue, reportez-vous à la rubrique relative aux [enregistrements](records.md) dans [utilisation de l’infrastructure homologue](using-the-peer-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="2626b-137">For more details on working with records in the Peer Infrastructure, please refer to the [Records](records.md) topic in [Using the Peer Infrastructure](using-the-peer-infrastructure.md).</span></span>

## <a name="administration-of-peer-group-records"></a><span data-ttu-id="2626b-138">Administration des enregistrements de groupe homologue</span><span class="sxs-lookup"><span data-stu-id="2626b-138">Administration of Peer Group Records</span></span>

<span data-ttu-id="2626b-139">Lorsque les invitations initiales sont émises par le créateur du groupe pair, il peut spécifier que certains membres jouent un rôle d’administrateur (administrateur du rôle de groupe HOMOLOGUe \_ \_ \_ ) chaque fois qu’il envoie de nouvelles informations d’identification à l’utilisateur (via [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) ou [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials)).</span><span class="sxs-lookup"><span data-stu-id="2626b-139">When the initial invitations are issued by the peer group's creator, it can specify that certain members serve in an administrative role (PEER\_GROUP\_ROLE\_ADMIN) whenever it issues new credentials to the user (via either [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) or [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials)).</span></span> <span data-ttu-id="2626b-140">Un administrateur a la possibilité d’ajouter, de supprimer et de mettre à jour directement les enregistrements de groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="2626b-140">An administrator has the ability to directly add, delete, and update any peer group records.</span></span> <span data-ttu-id="2626b-141">À l’inverse, un membre du groupe homologue dont le rôle est défini sur membre du **\_ rôle de groupe \_ \_ homologue** ou **membre d’invitation du \_ \_ rôle de \_ \_ groupe** pair peut uniquement ajouter, mettre à jour et supprimer ses propres enregistrements.</span><span class="sxs-lookup"><span data-stu-id="2626b-141">Conversely, a peer group member with it's role set to either **PEER\_GROUP\_ROLE\_MEMBER** or **PEER\_GROUP\_ROLE\_INVITING\_MEMBER** can only add, update, and delete its own record(s).</span></span>

<span data-ttu-id="2626b-142">Le créateur a le rôle d’administrateur par défaut.</span><span class="sxs-lookup"><span data-stu-id="2626b-142">The creator has the administrator role by default.</span></span>

<span data-ttu-id="2626b-143">Pour mettre à jour un enregistrement, obtenez l’enregistrement avec [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) ou [**PeerGroupEnumRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupenumrecords), effectuez les modifications et transmettez l’enregistrement mis à jour à [**PeerGroupUpdateRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupupdaterecord).</span><span class="sxs-lookup"><span data-stu-id="2626b-143">To update a record, obtain the record with [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) or [**PeerGroupEnumRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupenumrecords), make the changes, and pass the updated record to [**PeerGroupUpdateRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupupdaterecord).</span></span>

<span data-ttu-id="2626b-144">Pour supprimer un enregistrement, transmettez l’ID d’enregistrement à supprimer à [**PeerGroupDeleteRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupdeleterecord).</span><span class="sxs-lookup"><span data-stu-id="2626b-144">To delete a record, pass the record ID to delete to [**PeerGroupDeleteRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupdeleterecord).</span></span>

<span data-ttu-id="2626b-145">Pour ajouter un enregistrement, créez une nouvelle structure d' [**\_ enregistrement d’homologue**](/windows/desktop/api/P2P/ns-p2p-peer_record) et remplissez les champs suivants :</span><span class="sxs-lookup"><span data-stu-id="2626b-145">To add a record, create a new [**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record) structure and populate the following fields:</span></span>

-   <span data-ttu-id="2626b-146">**dwSize nul**.</span><span class="sxs-lookup"><span data-stu-id="2626b-146">**dwSize**.</span></span> <span data-ttu-id="2626b-147">Ce champ contient la valeur de **sizeof**([**\_ enregistrement d’homologue**](/windows/desktop/api/P2P/ns-p2p-peer_record)).</span><span class="sxs-lookup"><span data-stu-id="2626b-147">This field contains the value of **sizeof**([**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record)).</span></span>
-   <span data-ttu-id="2626b-148">**ftExpiration**.</span><span class="sxs-lookup"><span data-stu-id="2626b-148">**ftExpiration**.</span></span> <span data-ttu-id="2626b-149">Ce champ contient la date et l’heure d’expiration de cet enregistrement, exprimées en temps d’homologation sous la forme d’une structure **fileTime** .</span><span class="sxs-lookup"><span data-stu-id="2626b-149">This field contains the expiration date and time of this record, expressed in peer time as a **FILETIME** structure.</span></span>
-   <span data-ttu-id="2626b-150">**tapez**.</span><span class="sxs-lookup"><span data-stu-id="2626b-150">**type**.</span></span> <span data-ttu-id="2626b-151">Ce champ contient une valeur **GUID** qui identifie le type d’enregistrement à l’application.</span><span class="sxs-lookup"><span data-stu-id="2626b-151">This field contains a **GUID** value that identifies the record type to the application.</span></span> <span data-ttu-id="2626b-152">Si ce type est personnalisé pour votre infrastructure d’application, vous devez également renseigner le champ de **données** .</span><span class="sxs-lookup"><span data-stu-id="2626b-152">If this type is custom to your application infrastructure, you should also populate the **data** field.</span></span>

<span data-ttu-id="2626b-153">Les champs suivants sont remplis par l’infrastructure et sont ignorés s’ils sont définis par l’application :</span><span class="sxs-lookup"><span data-stu-id="2626b-153">The following fields are populated by the infrastructure, and will be ignored if set by the application:</span></span>

-   <span data-ttu-id="2626b-154">**id**</span><span class="sxs-lookup"><span data-stu-id="2626b-154">**id**</span></span>
-   <span data-ttu-id="2626b-155">**pwzCreatorId**</span><span class="sxs-lookup"><span data-stu-id="2626b-155">**pwzCreatorId**</span></span>
-   <span data-ttu-id="2626b-156">**pwzLastModifiedById**</span><span class="sxs-lookup"><span data-stu-id="2626b-156">**pwzLastModifiedById**</span></span>
-   <span data-ttu-id="2626b-157">**ftCreation**</span><span class="sxs-lookup"><span data-stu-id="2626b-157">**ftCreation**</span></span>
-   <span data-ttu-id="2626b-158">**ftLastModified**</span><span class="sxs-lookup"><span data-stu-id="2626b-158">**ftLastModified**</span></span>
-   <span data-ttu-id="2626b-159">**securityData**</span><span class="sxs-lookup"><span data-stu-id="2626b-159">**securityData**</span></span>

<span data-ttu-id="2626b-160">Les champs restants sont facultatifs.</span><span class="sxs-lookup"><span data-stu-id="2626b-160">The remaining fields are optional.</span></span> <span data-ttu-id="2626b-161">Pour ajouter ce nouvel enregistrement au groupe homologue, transmettez-le à [**PeerGroupAddRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupaddrecord).</span><span class="sxs-lookup"><span data-stu-id="2626b-161">To add this new record to the peer group, pass it to [**PeerGroupAddRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupaddrecord).</span></span>

## <a name="importing-and-exporting-records"></a><span data-ttu-id="2626b-162">Importation et exportation d’enregistrements</span><span class="sxs-lookup"><span data-stu-id="2626b-162">Importing and Exporting Records</span></span>

<span data-ttu-id="2626b-163">Les enregistrements de groupe d’égal à égal sont conservés localement en tant que base de données.</span><span class="sxs-lookup"><span data-stu-id="2626b-163">Peer-to-peer group records are maintained locally as a database.</span></span> <span data-ttu-id="2626b-164">Pour enregistrer un instantané actuel de la base de données de l’enregistrement du groupe homologue dans un fichier local, appelez [**PeerGroupExportDatabase**](/windows/desktop/api/P2P/nf-p2p-peergroupexportdatabase)et transmettez-lui le descripteur du groupe homologue.</span><span class="sxs-lookup"><span data-stu-id="2626b-164">To save a current snapshot of the peer group record database to a local file, call [**PeerGroupExportDatabase**](/windows/desktop/api/P2P/nf-p2p-peergroupexportdatabase), and pass it the handle to the peer group.</span></span> <span data-ttu-id="2626b-165">Ce fichier peut ensuite être transporté vers un autre ordinateur ou une autre application, qui peut extraire et utiliser cette base de données d’enregistrement en appelant [**PeerGroupImportDatabase**](/windows/desktop/api/P2P/nf-p2p-peergroupimportdatabase).</span><span class="sxs-lookup"><span data-stu-id="2626b-165">This file can then be transported to a different computer or application, which can extract and use this record database by calling [**PeerGroupImportDatabase**](/windows/desktop/api/P2P/nf-p2p-peergroupimportdatabase).</span></span>

 

 



