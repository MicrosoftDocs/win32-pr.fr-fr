---
description: Pour qu’une application puisse effectuer une recherche dans la table de routage distribué (DRT), une requête de recherche doit être créée.
ms.assetid: b3403a64-128c-461e-9384-8e62c03322e1
title: Recherche dans une table de routage distribuée
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c9977ca395393cef09198182fb8790738d2b00c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106529334"
---
# <a name="searching-a-distributed-routing-table"></a><span data-ttu-id="e35f3-103">Recherche dans une table de routage distribuée</span><span class="sxs-lookup"><span data-stu-id="e35f3-103">Searching a Distributed Routing Table</span></span>

<span data-ttu-id="e35f3-104">Pour qu’une application puisse effectuer une recherche dans la table de routage distribué (DRT), une requête de recherche doit être créée.</span><span class="sxs-lookup"><span data-stu-id="e35f3-104">Before an application can search the Distributed Routing Table (DRT), a search query must be created.</span></span> <span data-ttu-id="e35f3-105">La valeur de clé souhaitée est spécifiée par l’application lorsque la fonction [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) est appelée.</span><span class="sxs-lookup"><span data-stu-id="e35f3-105">The desired key value is specified by the application when the [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) function is called.</span></span> <span data-ttu-id="e35f3-106">Le comportement de la recherche est déterminé par les informations spécifiées par l’application dans la structure d' [**\_ \_ informations de recherche DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info) .</span><span class="sxs-lookup"><span data-stu-id="e35f3-106">The behavior of the search is determined by information specified by the application in the [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info) structure.</span></span>

<span data-ttu-id="e35f3-107">En règle générale, un événement d’application est signalé lorsque la recherche Découvre les résultats et un autre à la fin de la recherche.</span><span class="sxs-lookup"><span data-stu-id="e35f3-107">Typically, an application event is signaled when the search discovers results and another at the conclusion of the search.</span></span> <span data-ttu-id="e35f3-108">Toutefois, si **fIterative** est défini dans [**\_ \_ informations de recherche DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info), un événement d’application peut être signalé lorsque le contact est établi avec chaque nœud en cours de route.</span><span class="sxs-lookup"><span data-stu-id="e35f3-108">However, if **fIterative** is set in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info), an application event can be signaled when contact is made with each node along the way.</span></span>

<span data-ttu-id="e35f3-109">Une fois qu’un événement est signalé, l’application appelle ensuite la fonction [**DrtGetSearchResult**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) pour obtenir les résultats.</span><span class="sxs-lookup"><span data-stu-id="e35f3-109">After an event is signaled, the application then calls the [**DrtGetSearchResult**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) function for the results.</span></span> <span data-ttu-id="e35f3-110">Si le code retourné est **S \_ OK**, les résultats sont signalés dans la structure de [**\_ \_ résultat de recherche DRT**](/windows/desktop/api/drt/ns-drt-drt_search_result) retournée par l’API.</span><span class="sxs-lookup"><span data-stu-id="e35f3-110">If the returned code is **S\_OK**, the results are pointed to in the [**DRT\_SEARCH\_RESULT**](/windows/desktop/api/drt/ns-drt-drt_search_result) structure returned by the API.</span></span> <span data-ttu-id="e35f3-111">Les résultats retournés sont dans la plage de valeurs spécifiée dans [**\_ \_ informations de recherche DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span><span class="sxs-lookup"><span data-stu-id="e35f3-111">The returned results fall into the range of values specified in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span></span> <span data-ttu-id="e35f3-112">Si la recherche ne trouve aucune correspondance, seule la valeur **DRT \_ E n' \_ est \_ pas** retournée à la fin des retours de résultats.</span><span class="sxs-lookup"><span data-stu-id="e35f3-112">In the event that the search finds no matches, only the **DRT\_E\_NO\_MORE** value will be returned at the conclusion of result returns.</span></span>

<span data-ttu-id="e35f3-113">Les informations suivantes détaillent comment les membres contenus dans les [**\_ \_ informations de recherche DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info) permettent à une application de dicter spécifiquement le comportement de recherche de l’infrastructure DRT :</span><span class="sxs-lookup"><span data-stu-id="e35f3-113">The following information details how the members contained in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info) allow an application to specifically dictate the search behavior of the DRT infrastructure:</span></span>

## <a name="fallowcurrentinstancematch"></a><span data-ttu-id="e35f3-114">fAllowCurrentInstanceMatch</span><span class="sxs-lookup"><span data-stu-id="e35f3-114">fAllowCurrentInstanceMatch</span></span>

<span data-ttu-id="e35f3-115">Par défaut, les résultats de la recherche DRT incluent uniquement les correspondances trouvées en dehors du nœud local.</span><span class="sxs-lookup"><span data-stu-id="e35f3-115">By default, DRT search results include only matches found outside of the local node.</span></span> <span data-ttu-id="e35f3-116">La définition de **fAllowCurrentInstanceMatch** spécifie que les résultats de la recherche incluent également les correspondances trouvées dans l’instance DRT locale.</span><span class="sxs-lookup"><span data-stu-id="e35f3-116">Setting **fAllowCurrentInstanceMatch** specifies that the search results also include matches found in the local DRT instance.</span></span>

## <a name="cmaxendpoints"></a><span data-ttu-id="e35f3-117">cMaxEndpoints</span><span class="sxs-lookup"><span data-stu-id="e35f3-117">cMaxEndpoints</span></span>

<span data-ttu-id="e35f3-118">La quantité et la plage des résultats retournés par la recherche sont spécifiées par l’application avec les valeurs **cMaxEndpoints** (Quantity) et **pMinimumKey** et **pMaximumKey** (Range), et référencées par les [**\_ \_ informations de recherche DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span><span class="sxs-lookup"><span data-stu-id="e35f3-118">The quantity and range of the results returned by the search are specified by the application with the **cMaxEndpoints** (quantity) and the **pMinimumKey** and **pMaximumKey** (range) values, and referenced by [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span></span>

<span data-ttu-id="e35f3-119">Lorsque **cMaxEndpoints = 1**, l’infrastructure DRT recherche une clé, en retournant une correspondance dans la plage spécifiée par les valeurs **pMinimumKey** et **pMaximumKey** dans les [**\_ \_ informations de recherche DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span><span class="sxs-lookup"><span data-stu-id="e35f3-119">When **cMaxEndpoints = 1**, the DRT infrastructure searches for a key, returning one match within the range specified by the **pMinimumKey** and **pMaximumKey** values in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span></span> <span data-ttu-id="e35f3-120">Cette correspondance peut être une correspondance exacte ou la correspondance la plus proche dans la plage.</span><span class="sxs-lookup"><span data-stu-id="e35f3-120">This match can be either an exact match or the nearest match within range.</span></span> <span data-ttu-id="e35f3-121">Si aucune correspondance n’est trouvée, le **DRT \_ E \_ n' \_** est pas retourné.</span><span class="sxs-lookup"><span data-stu-id="e35f3-121">If a match is not found, **DRT\_E\_NO\_MORE** is returned.</span></span>

<span data-ttu-id="e35f3-122">Si **cMaxEndpoints > 1**, l’infrastructure DRT retourne des correspondances dans la plage jusqu’à la valeur de **cMaxEndpoints**.</span><span class="sxs-lookup"><span data-stu-id="e35f3-122">If **cMaxEndpoints > 1**, the DRT infrastructure will return matches within the range up to the value of **cMaxEndpoints**.</span></span> <span data-ttu-id="e35f3-123">Les correspondances retournées peuvent contenir une correspondance exacte ou les résultats de correspondance les plus proches dans la plage.</span><span class="sxs-lookup"><span data-stu-id="e35f3-123">The returned matches can contain an exact match or the nearest match results within range.</span></span> <span data-ttu-id="e35f3-124">En outre, si **pMinimumKey** et **pMaximumKey** sont définis sur la même valeur, une recherche est effectuée uniquement pour cette valeur, en renvoyant le **DRT \_ E \_ \_** uniquement s’il est introuvable.</span><span class="sxs-lookup"><span data-stu-id="e35f3-124">Additionally, if **pMinimumKey** and **pMaximumKey** are set to the same value, a search is carried out only for that value, returning **DRT\_E\_NO\_MORE** if it is not found.</span></span>

## <a name="fanymatchinrange"></a><span data-ttu-id="e35f3-125">fAnyMatchInRange</span><span class="sxs-lookup"><span data-stu-id="e35f3-125">fAnyMatchInRange</span></span>

<span data-ttu-id="e35f3-126">Le membre **fAnyMatchInRange** indique si la recherche s’arrêtera une fois la première correspondance trouvée dans la plage spécifiée, ou si la recherche se poursuivra pour la correspondance la plus proche de la clé spécifiée dans l’API [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) .</span><span class="sxs-lookup"><span data-stu-id="e35f3-126">The **fAnyMatchInRange** member indicates whether the search will stop after the first match is located within the specified range, or if the search will continue for the closest match to the key specified in the [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) API.</span></span> <span data-ttu-id="e35f3-127">Lorsque **fAnyMatchInRange** est défini, la recherche est effectuée avec **cMaxEndpoints = 1** , quelle que soit la valeur spécifiée de **cMaxEndpoints** dans les [**\_ \_ informations de recherche DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span><span class="sxs-lookup"><span data-stu-id="e35f3-127">When **fAnyMatchInRange** is set, the search is carried out with **cMaxEndpoints = 1** regardless of the specified value of **cMaxEndpoints** in [**DRT\_SEARCH\_INFO**](/windows/desktop/api/drt/ns-drt-drt_search_info).</span></span>

## <a name="fiterative"></a><span data-ttu-id="e35f3-128">fIterative</span><span class="sxs-lookup"><span data-stu-id="e35f3-128">fIterative</span></span>

<span data-ttu-id="e35f3-129">Le membre **fIterative** spécifie si chaque nœud contacté par l’infrastructure DRT pendant la recherche aura les données de clé/point de terminaison qui lui sont associées, accessibles à l’application via le résultat de la [**\_ recherche \_ DRT**](/windows/desktop/api/drt/ns-drt-drt_search_result).</span><span class="sxs-lookup"><span data-stu-id="e35f3-129">The **fIterative** member specifies if each node contacted by the DRT infrastructure during the search will have the key/endpoint data associated with it made available to the application via [**DRT\_SEARCH\_RESULT**](/windows/desktop/api/drt/ns-drt-drt_search_result).</span></span> <span data-ttu-id="e35f3-130">En affectant à **fIterative** la valeur **true**, la valeur de **cMaxEndpoints = 1** est forcée.</span><span class="sxs-lookup"><span data-stu-id="e35f3-130">By setting **fIterative** to **TRUE**, the value of **cMaxEndpoints = 1** will be forced.</span></span> <span data-ttu-id="e35f3-131">Lorsque **fIterative** a la valeur **true** dans une requête de recherche pour l’objet DRT, l’application est rappelée après le contact avec chaque nœud ou « tronçon ».</span><span class="sxs-lookup"><span data-stu-id="e35f3-131">When **fIterative** is set to **TRUE** within a search query for the DRT, the application is called back after contact with each node or "hop."</span></span> <span data-ttu-id="e35f3-132">Chaque résultat de tronçon contient une clé indiquant le nœud que le DRT recherchera ensuite.</span><span class="sxs-lookup"><span data-stu-id="e35f3-132">Each hop result contains a key indicating which node the DRT will search next.</span></span> <span data-ttu-id="e35f3-133">Un résultat de tronçon est retourné via [**DrtGetSearchResult**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) sous la forme d’un résultat **\_ \_ intermédiaire de correspondance DRT** .</span><span class="sxs-lookup"><span data-stu-id="e35f3-133">A hop result is returned via [**DrtGetSearchResult**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) as a **DRT\_MATCH\_INTERMEDIATE** result.</span></span>

## <a name="pminimumkey-and-pmaximumkey"></a><span data-ttu-id="e35f3-134">pMinimumKey et pMaximumKey</span><span class="sxs-lookup"><span data-stu-id="e35f3-134">pMinimumKey and pMaximumKey</span></span>

<span data-ttu-id="e35f3-135">Les membres **pMinimumKey** et **pMaximumKey** peuvent être utilisés pour rechercher des clés comprises dans une plage.</span><span class="sxs-lookup"><span data-stu-id="e35f3-135">The **pMinimumKey** and **pMaximumKey** members can be used to search for keys falling within a range.</span></span> <span data-ttu-id="e35f3-136">Si le membre **fAnyMatchInRange** a la valeur **false**, l’objet DRT retourne la ou les clés les plus proches à la cible de recherche (spécifiée à l’aide de l’argument de la clé de page passée dans la fonction [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) ) comprise dans la plage.</span><span class="sxs-lookup"><span data-stu-id="e35f3-136">If the **fAnyMatchInRange** member is set to **FALSE**, the DRT will return the closest key(s) to the search target (specified using the pKey argument passed in the [**DrtStartSearch**](/windows/desktop/api/drt/nf-drt-drtstartsearch) function) falling within the range.</span></span> <span data-ttu-id="e35f3-137">Notez que l' *argument de* grand-groupe transmis à **DrtStartSearch** doit être compris dans la plage définie par **pMinimumKey** et **pMaximumKey**.</span><span class="sxs-lookup"><span data-stu-id="e35f3-137">Note that the *pKey* argument passed to **DrtStartSearch** must fall within the range defined by **pMinimumKey** and **pMaximumKey**.</span></span> <span data-ttu-id="e35f3-138">Pour rechercher une clé précise, attribuez la même valeur à **pMinimumKey**, **pMaximumKey** *et au* jeu de clés.</span><span class="sxs-lookup"><span data-stu-id="e35f3-138">To search for a precise key, set **pMinimumKey**, **pMaximumKey** and *pKey* to the same value.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e35f3-139">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e35f3-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e35f3-140">Inscription et annulation de l’inscription des clés</span><span class="sxs-lookup"><span data-stu-id="e35f3-140">Registering and Deregistering Keys</span></span>](registering-and-deregistering-keys.md)
</dt> <dt>

[<span data-ttu-id="e35f3-141">À propos des tables de routage distribuées</span><span class="sxs-lookup"><span data-stu-id="e35f3-141">About Distributed Routing Tables</span></span>](about-distributed-routing-tables.md)
</dt> <dt>

[<span data-ttu-id="e35f3-142">Référence de API Table de routage distribué</span><span class="sxs-lookup"><span data-stu-id="e35f3-142">Distributed Routing Table API Reference</span></span>](distributed-routing-table-api-reference.md)
</dt> </dl>

 

 



