---
description: Les gestionnaires de filtres, qui sont des implémentations de l’interface IFilter, recherchent du texte et des propriétés dans les documents.
ms.assetid: 2ee9ea19-ae03-4f14-8f06-f8aa670e204e
title: Fonctionnement des gestionnaires de filtres dans la recherche Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e49cc1d3e479ae03645665618c60a33bdcfe19ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104525521"
---
# <a name="understanding-filter-handlers-in-windows-search"></a><span data-ttu-id="8cf9b-103">Fonctionnement des gestionnaires de filtres dans la recherche Windows</span><span class="sxs-lookup"><span data-stu-id="8cf9b-103">Understanding Filter Handlers in Windows Search</span></span>

<span data-ttu-id="8cf9b-104">Les gestionnaires de filtres, qui sont des implémentations de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) , recherchent du texte et des propriétés dans les documents.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-104">Filter handlers, which are implementations of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface, scan documents for text and properties.</span></span> <span data-ttu-id="8cf9b-105">Les gestionnaires de filtres extraient les blocs de texte de ces éléments, en filtrant la mise en forme incorporée et en conservant les informations relatives à la position du texte.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-105">Filter handlers extract chunks of text from these items, filtering out embedded formatting and retaining information about the position of the text.</span></span> <span data-ttu-id="8cf9b-106">Elles extraient également des blocs de valeurs, qui sont des propriétés de document.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-106">They also extract chunks of values, which are document properties.</span></span> <span data-ttu-id="8cf9b-107">**IFilter** est la base de la création d’applications de niveau supérieur, telles que les indexeurs de documents et les visionneuses indépendantes des applications.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-107">**IFilter** is the foundation for building higher-level applications such as document indexers and application-independent viewers.</span></span>

<span data-ttu-id="8cf9b-108">Cette rubrique est organisée comme suit :</span><span class="sxs-lookup"><span data-stu-id="8cf9b-108">This topic is organized as follows:</span></span>

- [<span data-ttu-id="8cf9b-109">À propos de l’interface IFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-109">About the IFilter Interface</span></span>](#about-the-ifilter-interface)
  - [<span data-ttu-id="8cf9b-110">Processus d’isolation</span><span class="sxs-lookup"><span data-stu-id="8cf9b-110">Isolation Process</span></span>](#isolation-process)
  - [<span data-ttu-id="8cf9b-111">DLL IFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-111">IFilter DLLs</span></span>](#ifilter-dlls)
  - [<span data-ttu-id="8cf9b-112">Structure IFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-112">IFilter Structure</span></span>](#ifilter-structure)
  - [<span data-ttu-id="8cf9b-113">Code natif</span><span class="sxs-lookup"><span data-stu-id="8cf9b-113">Native Code</span></span>](#native-code)
- [<span data-ttu-id="8cf9b-114">Recherche de l’identificateur de classe IFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-114">Finding the IFilter Class Identifier</span></span>](#finding-the-ifilter-class-identifier)
  - [<span data-ttu-id="8cf9b-115">IFilter :: GetChunk et identificateurs de code de paramètres régionaux</span><span class="sxs-lookup"><span data-stu-id="8cf9b-115">IFilter::GetChunk and Locale Code Identifiers</span></span>](#ifiltergetchunk-and-locale-code-identifiers)
- [<span data-ttu-id="8cf9b-116">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="8cf9b-116">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="8cf9b-117">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8cf9b-117">Related topics</span></span>](#related-topics)

## <a name="about-the-ifilter-interface"></a><span data-ttu-id="8cf9b-118">À propos de l’interface IFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-118">About the IFilter Interface</span></span>

<span data-ttu-id="8cf9b-119">Microsoft Windows Search utilise des filtres pour extraire le contenu des éléments à inclure dans un index de recherche en texte intégral.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-119">Microsoft Windows Search uses filters to extract the content of items for inclusion in a full-text index.</span></span> <span data-ttu-id="8cf9b-120">Vous pouvez étendre Windows Search pour indexer les types de fichiers nouveaux ou propriétaires en écrivant des filtres pour extraire le contenu et les gestionnaires de propriétés pour extraire les propriétés des fichiers.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-120">You can extend Windows Search to index new or proprietary file types by writing filters to extract the content, and property handlers to extract the properties of files.</span></span>

<span data-ttu-id="8cf9b-121">L’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) est conçue pour répondre aux besoins spécifiques des moteurs de recherche en texte intégral.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-121">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface is designed to meet the specific needs of full-text search engines.</span></span> <span data-ttu-id="8cf9b-122">Les moteurs de recherche en texte intégral tels que Windows Search appellent les méthodes **IFilter** pour extraire des informations de texte et de propriété et les ajouter à un index.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-122">Full-text search engines like Windows Search call the **IFilter** methods to extract text and property information and add them to an index.</span></span> <span data-ttu-id="8cf9b-123">Windows Search divise les résultats de la méthode [**IFilter :: gettext**](/windows/win32/api/filter/nf-filter-ifilter-gettext) retournée en mots, les normalise et les enregistre dans un index.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-123">Windows Search breaks the results of the returned [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext) method into words, normalizes them, and saves them in an index.</span></span> <span data-ttu-id="8cf9b-124">S’il est disponible, le moteur de recherche utilise l’identificateur de code de langue (LCID) d’un segment de texte pour effectuer une césure et une normalisation des mots propres à la langue.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-124">If available, the search engine uses the language code identifier (LCID) of a text chunk to perform language-specific word breaking and normalization.</span></span>

<span data-ttu-id="8cf9b-125">Windows Search utilise trois fonctions, décrites dans le tableau suivant, pour accéder aux gestionnaires de filtres enregistrés (implémentations de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ).</span><span class="sxs-lookup"><span data-stu-id="8cf9b-125">Windows Search uses three functions, described in the following table, to access registered filter handlers (implementations of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span> <span data-ttu-id="8cf9b-126">Ces fonctions sont particulièrement utiles lors du chargement et de la liaison au gestionnaire de filtres d’un objet incorporé.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-126">These functions are especially useful when loading and binding to an embedded object's filter handler.</span></span>

| <span data-ttu-id="8cf9b-127">Fonction</span><span class="sxs-lookup"><span data-stu-id="8cf9b-127">Function</span></span>               | <span data-ttu-id="8cf9b-128">Description</span><span class="sxs-lookup"><span data-stu-id="8cf9b-128">Description</span></span>                                                                                                                                                                                               |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8cf9b-129">LoadIFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-129">LoadIFilter</span></span>            | <span data-ttu-id="8cf9b-130">Obtient un pointeur vers le [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) qui est le plus approprié pour le type de contenu spécifié.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-130">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for the specified content type.</span></span>                                                                                            |
| <span data-ttu-id="8cf9b-131">BindIFilterFromStorage</span><span class="sxs-lookup"><span data-stu-id="8cf9b-131">BindIFilterFromStorage</span></span> | <span data-ttu-id="8cf9b-132">Obtient un pointeur vers le [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) le plus approprié pour le contenu d’un objet d' [interface IStorage](/windows/win32/api/objidl/nn-objidl-istorage) .</span><span class="sxs-lookup"><span data-stu-id="8cf9b-132">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for the content contained in an [IStorage Interface](/windows/win32/api/objidl/nn-objidl-istorage) object.</span></span> |
| <span data-ttu-id="8cf9b-133">BindIFilterFromStream</span><span class="sxs-lookup"><span data-stu-id="8cf9b-133">BindIFilterFromStream</span></span>  | <span data-ttu-id="8cf9b-134">Obtient un pointeur vers le [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) qui est le plus approprié pour un identificateur de classe (CLSID) spécifié récupéré d’une variable de flux.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-134">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for a specified class identifier (CLSID) retrieved from a stream variable.</span></span>                                                 |

<span data-ttu-id="8cf9b-135">L’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) a cinq méthodes, décrites dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-135">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface has five methods, described in the following table.</span></span>

| <span data-ttu-id="8cf9b-136">Méthode</span><span class="sxs-lookup"><span data-stu-id="8cf9b-136">Method</span></span>                                                    | <span data-ttu-id="8cf9b-137">Description</span><span class="sxs-lookup"><span data-stu-id="8cf9b-137">Description</span></span>                                                                                                        |
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8cf9b-138">**IFilter :: init**</span><span class="sxs-lookup"><span data-stu-id="8cf9b-138">**IFilter::Init**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-init)          | <span data-ttu-id="8cf9b-139">Initialise une session de filtrage.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-139">Initializes a filtering session.</span></span>                                                                                   |
| [<span data-ttu-id="8cf9b-140">**IFilter :: GetChunk**</span><span class="sxs-lookup"><span data-stu-id="8cf9b-140">**IFilter::GetChunk**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getchunk)     | <span data-ttu-id="8cf9b-141">Positionne [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) au début du premier segment ou du prochain bloc et retourne un descripteur.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-141">Positions [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) at the beginning of the first or next chunk and returns a descriptor.</span></span> |
| [<span data-ttu-id="8cf9b-142">**IFilter :: GetText**</span><span class="sxs-lookup"><span data-stu-id="8cf9b-142">**IFilter::GetText**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-gettext)       | <span data-ttu-id="8cf9b-143">Récupère le texte du bloc actuel.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-143">Retrieves text from the current chunk.</span></span>                                                                             |
| [<span data-ttu-id="8cf9b-144">**IFilter :: GetValue**</span><span class="sxs-lookup"><span data-stu-id="8cf9b-144">**IFilter::GetValue**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getvalue)     | <span data-ttu-id="8cf9b-145">Récupère les valeurs du bloc actuel.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-145">Retrieves values from the current chunk.</span></span>                                                                           |
| [<span data-ttu-id="8cf9b-146">**IFilter :: BindRegion**</span><span class="sxs-lookup"><span data-stu-id="8cf9b-146">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="8cf9b-147">Récupère une interface représentant la partie spécifiée de l’objet.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-147">Retrieves an interface representing the specified portion of object.</span></span> <span data-ttu-id="8cf9b-148">Réservé pour un usage futur.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-148">Reserved for future use.</span></span>                      |

### <a name="isolation-process"></a><span data-ttu-id="8cf9b-149">Processus d’isolation</span><span class="sxs-lookup"><span data-stu-id="8cf9b-149">Isolation Process</span></span>

<span data-ttu-id="8cf9b-150">Windows Search exécute les IFilters dans le contexte de sécurité du système local avec des droits restreints.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-150">Windows Search runs IFilters in the Local System security context with restricted rights.</span></span> <span data-ttu-id="8cf9b-151">Dans ce processus d’isolation d’hôte [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) , un certain nombre de droits sont supprimés :</span><span class="sxs-lookup"><span data-stu-id="8cf9b-151">In this [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) host isolation process, a number of rights are removed:</span></span>

- <span data-ttu-id="8cf9b-152">Code restreint</span><span class="sxs-lookup"><span data-stu-id="8cf9b-152">Restricted Code</span></span>
- <span data-ttu-id="8cf9b-153">Tout le monde</span><span class="sxs-lookup"><span data-stu-id="8cf9b-153">Everyone</span></span>
- <span data-ttu-id="8cf9b-154">Local</span><span class="sxs-lookup"><span data-stu-id="8cf9b-154">Local</span></span>
- <span data-ttu-id="8cf9b-155">Interactive</span><span class="sxs-lookup"><span data-stu-id="8cf9b-155">Interactive</span></span>
- <span data-ttu-id="8cf9b-156">Utilisateurs authentifiés</span><span class="sxs-lookup"><span data-stu-id="8cf9b-156">Authenticated Users</span></span>
- <span data-ttu-id="8cf9b-157">Utilisateurs intégrés</span><span class="sxs-lookup"><span data-stu-id="8cf9b-157">Built-in Users</span></span>
- <span data-ttu-id="8cf9b-158">Identificateur de sécurité (SID) des utilisateurs</span><span class="sxs-lookup"><span data-stu-id="8cf9b-158">Users' security identifier (SID)</span></span>

<span data-ttu-id="8cf9b-159">La suppression de ces droits signifie que l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) n’a pas accès au système de disque ou au réseau ou à une interface utilisateur ou à une fonction de presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-159">The removal of these rights means the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface does not have access to the disk system or network or to any user interface or clipboard functions.</span></span> <span data-ttu-id="8cf9b-160">En outre, le processus d’isolation s’exécute sous un objet de traitement qui empêche la création de processus enfants et impose une limite de 100 Mo à la plage de travail.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-160">Furthermore, the isolation process runs under a job object that prevents child processes from being created and imposes a 100 MB limit on the working set.</span></span> <span data-ttu-id="8cf9b-161">le processus d’isolation de l’hôte de l’interface **IFilter** augmente la stabilité de la plateforme d’indexation, en raison de la possibilité d’implémenter des filtres tiers de manière incorrecte.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-161">the **IFilter** interface host isolation process increases the stability of the indexing platform, due to the possibility of incorrectly implemented third-party filters.</span></span>

> [!NOTE]  
> <span data-ttu-id="8cf9b-162">Les gestionnaires de filtres doivent être écrits pour gérer les mémoires tampons et s’empiler correctement.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-162">Filter handlers must be written to manage buffers, and stack correctly.</span></span> <span data-ttu-id="8cf9b-163">Toutes les copies de chaînes doivent avoir des vérifications explicites pour se protéger contre les dépassements de mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-163">All string copies must have explicit checks to guard against buffer overruns.</span></span> <span data-ttu-id="8cf9b-164">Vous devez toujours vérifier la taille allouée de la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-164">You should always verify the allocated size of the buffer.</span></span> <span data-ttu-id="8cf9b-165">Vous devez toujours tester la taille des données par rapport à la taille de la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-165">You should always test the size of the data against the size of the buffer.</span></span>

### <a name="ifilter-dlls"></a><span data-ttu-id="8cf9b-166">DLL IFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-166">IFilter DLLs</span></span>

<span data-ttu-id="8cf9b-167">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) Les dll implémentent l’interface **IFilter** pour permettre à un client d’extraire des informations de texte et de valeur de propriété à partir d’un type de fichier, d’une classe ou d’un type perçu.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-167">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLLs implement the **IFilter** interface to enable a client to extract text and property value information from a file type, class, or perceived type.</span></span> <span data-ttu-id="8cf9b-168">Le processus de filtrage de Windows Search **SearchFilterHost.exe** se lie au **IFilter** qui est inscrit pour la classe, le type perçu ou l’extension de nom de l’élément.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-168">The Windows Search filtering process **SearchFilterHost.exe** binds to the **IFilter** that is registered for the class, perceived type, or name extension of the item.</span></span>

### <a name="ifilter-structure"></a><span data-ttu-id="8cf9b-169">Structure IFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-169">IFilter Structure</span></span>

<span data-ttu-id="8cf9b-170">Chaque [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) est un fichier dll qui implémente un serveur COM (Component Object Model) in-process pour fournir les fonctionnalités de filtrage spécifiées.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-170">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) is a DLL file that implements an in-process Component Object Model (COM) server to supply the specified filtering capabilities.</span></span> <span data-ttu-id="8cf9b-171">La figure ci-dessous illustre la structure globale d’une dll **IFilter** classique.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-171">The following figure illustrates shows the overall structure of a typical **IFilter** DLLs.</span></span> <span data-ttu-id="8cf9b-172">Un exemple plus complexe peut implémenter plusieurs classes **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="8cf9b-172">A more complex example could implement more than one **IFilter** class.</span></span>

![diagramme de la structure d’une DLL IFilter classique](images/ifilter-structure.png)

### <a name="native-code"></a><span data-ttu-id="8cf9b-174">Code natif</span><span class="sxs-lookup"><span data-stu-id="8cf9b-174">Native Code</span></span>

<span data-ttu-id="8cf9b-175">Les filtres doivent être écrits en code natif en raison de problèmes potentiels de contrôle de version du common language runtime (CLR) avec le processus dans lequel plusieurs compléments s’exécutent.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-175">Filters must be written in native code due to potential common language runtime (CLR) versioning issues with the process that multiple add-ins run in.</span></span> <span data-ttu-id="8cf9b-176">Dans Windows 7 et versions ultérieures et versions ultérieures, les filtres écrits en code managé sont bloqués explicitement.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-176">In Windows 7 and later and later, filters written in managed code are explicitly blocked.</span></span>

## <a name="finding-the-ifilter-class-identifier"></a><span data-ttu-id="8cf9b-177">Recherche de l’identificateur de classe IFilter</span><span class="sxs-lookup"><span data-stu-id="8cf9b-177">Finding the IFilter Class Identifier</span></span>

<span data-ttu-id="8cf9b-178">La classe de la dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) est inscrite sous la clé de Registre PersistentHandler</span><span class="sxs-lookup"><span data-stu-id="8cf9b-178">The class of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL is registered under the PersistentHandler registry key.</span></span> <span data-ttu-id="8cf9b-179">L’exemple suivant, pour les fichiers HTML, illustre la recherche de la dll **IFilter** pour un document HTML.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-179">The following example, for HTML files, illustrates how to find the **IFilter** DLL for an HTML document.</span></span> <span data-ttu-id="8cf9b-180">Cet exemple suit une logique similaire à celle utilisée par le système pour rechercher le **IFilter** associé à un élément.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-180">This example follows logic similar to that used by the system to find the **IFilter** associated with an item.</span></span>

1. <span data-ttu-id="8cf9b-181">Vérifiez si l’extension pour le type de fichiers que la DLL filtre a un PersistentHandler inscrit sous l’entrée de Registre \\ HKEY \_ local \_ machine \\ Software \\ classes.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-181">Check whether the extension for the type of files that the DLL filters has a PersistentHandler registered under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes.</span></span> <span data-ttu-id="8cf9b-182">Laissez cette clé `Value1` .</span><span class="sxs-lookup"><span data-stu-id="8cf9b-182">Let this key be `Value1`.</span></span> <span data-ttu-id="8cf9b-183">Si cette entrée existe déjà, passez à l’étape 4 de cette procédure et utilisez-la `Value1` dans cette clé.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-183">If that entry already exists, then skip to step 4 of this procedure and use `Value1` in that key.</span></span> <span data-ttu-id="8cf9b-184">Les valeurs sont de type REG \_ sz.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-184">The values are of type REG\_SZ.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             .htm
                PersistentHandler
                   {EEC97550-47A9-11CF-B952-00AA0051FE20}
```

2. <span data-ttu-id="8cf9b-185">Sinon, si aucun PersistentHandler n’est inscrit pour l’extension, recherchez le CLSID associé au type de document sous l’entrée de Registre \\ HKEY \_ local \_ machine \\ Software \\ classes.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-185">Alternatively, if there is not a PersistentHandler registered for the extension, find the CLSID associated with the document type under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes.</span></span> <span data-ttu-id="8cf9b-186">Laissez cette clé `Value2` .</span><span class="sxs-lookup"><span data-stu-id="8cf9b-186">Let this key be `Value2`.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             htmlfile
                 = Class for WWW HTML files
                CLSID
                   {25336920-03F9-11CF-8FD0-00AA00686F13}
```

3. <span data-ttu-id="8cf9b-187">Déterminez si un PersistentHandler est inscrit pour le CLSID.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-187">Determine whether a PersistentHandler is registered for the CLSID.</span></span> <span data-ttu-id="8cf9b-188">À l’aide `Value2` de déterminé à l’étape 2, recherchez le PersistentHandler pour l' \\ \_ entrée HKEY local \_ machine \\ Software \\ classes \\ CLSID \\ value2.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-188">Using `Value2` determined in step 2, find the PersistentHandler for the \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CLSID\\Value2 entry.</span></span> <span data-ttu-id="8cf9b-189">Laissez cette clé `Value3` .</span><span class="sxs-lookup"><span data-stu-id="8cf9b-189">Let this key be `Value3`.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             htmlfile
                 = Class for WWW HTML files
                PersistentHandler
                   {EEC97550-47A9-11CF-B952-00AA0051FE20}
```

4. <span data-ttu-id="8cf9b-190">Déterminez le GUID du gestionnaire persistant [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="8cf9b-190">Determine the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) persistent handler GUID.</span></span> <span data-ttu-id="8cf9b-191">À l’aide `Value1` de et de `Value3` , recherchez le GUID du gestionnaire persistant **IFilter** pour le type de document.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-191">Using `Value1` and `Value3`, find the **IFilter** Persistent Handler GUID for the document type.</span></span> <span data-ttu-id="8cf9b-192">La valeur sous l’entrée de Registre \\ HKEY \_ local \_ machine \\ Software \\ classes \\ CLSID \\ Value1 ou 3 \\ PersistentAddinsRegistered \\ 89BCB740-6119-101A-BCB7-00DD010655AF "/> produit le GUID PersistentHandler **IFilter** pour ce type de document.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-192">The value under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CLSID\\Value1 or 3\\PersistentAddinsRegistered\\ 89BCB740-6119-101A-BCB7-00DD010655AF"/> yields the **IFilter** PersistentHandler GUID for this document type.</span></span> <span data-ttu-id="8cf9b-193">Laissez cette clé `Value4` .</span><span class="sxs-lookup"><span data-stu-id="8cf9b-193">Let this key be `Value4`.</span></span> <span data-ttu-id="8cf9b-194">Dans cet exemple, le GUID d’interface **IFilter** est 89BCB740-6119-101A-BCB7-00DD010655AF.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-194">In this example, the **IFilter** interface GUID is 89BCB740-6119-101A-BCB7-00DD010655AF.</span></span>

```
    HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             {EEC97550-47A9-11CF-B952-00AA0051FE20}
                 = HTML File Persistent Handler
                    Data type         REG_SZ
                        PersistentAddinsRegistered
                        {89BCB740-6119-101A-BCB7-00DD010655AF}

                    Data type         REG_SZ
                        default = {E0CA5340-4534-11CF-B952-00AA0051FE20}
```

> [!NOTE]  
> <span data-ttu-id="8cf9b-195">Dans cet exemple, la dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) pour les documents HTML est nlhtml.dll.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-195">In this example, the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL for HTML documents is nlhtml.dll.</span></span>

### <a name="ifiltergetchunk-and-locale-code-identifiers"></a><span data-ttu-id="8cf9b-196">IFilter :: GetChunk et identificateurs de code de paramètres régionaux</span><span class="sxs-lookup"><span data-stu-id="8cf9b-196">IFilter::GetChunk and Locale Code Identifiers</span></span>

<span data-ttu-id="8cf9b-197">Le LCID de texte peut être modifié dans un fichier unique.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-197">The LCID of text can change within a single file.</span></span> <span data-ttu-id="8cf9b-198">Par exemple, le texte d’un manuel d’instruction peut alterner entre l’anglais (en-US) et l’espagnol (es), ou le texte peut inclure un mot unique dans une langue autre que la langue principale.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-198">For example, the text of an instruction manual might alternate between English (en-us) and Spanish (es) or the text may include a single word in a language other than the primary language.</span></span> <span data-ttu-id="8cf9b-199">Dans les deux cas, votre [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) doit commencer un nouveau bloc chaque fois que le LCID change.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-199">In either case, your [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) must begin a new chunk each time the LCID changes.</span></span> <span data-ttu-id="8cf9b-200">Étant donné que le LCID est utilisé pour choisir un analyseur lexical approprié, il est très important que vous l’identifiiez correctement.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-200">Because the LCID is used to choose an appropriate word breaker, it is very important that you correctly identify it.</span></span> <span data-ttu-id="8cf9b-201">Si le **IFilter** ne peut pas déterminer les paramètres régionaux du texte, il doit retourner un LCID de zéro avec le segment.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-201">If the **IFilter** cannot determine the locale of the text, then it should return an LCID of zero with the chunk.</span></span> <span data-ttu-id="8cf9b-202">Si vous renvoyez un LCID égal à zéro, Windows Search utilise la technologie de détection automatique de langue (diagnostic Linux) pour déterminer l’ID de paramètres régionaux du bloc.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-202">Returning an LCID of zero causes Windows Search to use Language Auto-Detection (LAD) technology to determine the locale ID of the chunk.</span></span> <span data-ttu-id="8cf9b-203">Si la recherche Windows ne peut pas trouver de correspondance, elle est définie par défaut sur les paramètres régionaux par défaut du système (en appelant la fonction [GetSystemDefaultLocaleName](/windows/win32/api/winnls/nf-winnls-getsystemdefaultlocalename) Function).</span><span class="sxs-lookup"><span data-stu-id="8cf9b-203">If Windows Search cannot find a match, it defaults to the system default locale (by calling the [GetSystemDefaultLocaleName Function](/windows/win32/api/winnls/nf-winnls-getsystemdefaultlocalename) function).</span></span> <span data-ttu-id="8cf9b-204">Pour plus d’informations, consultez [**IFilter :: GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**Chunk \_ BREAKTYPE**](/windows/win32/api/filter/ne-filter-chunk_breaktype), [**CHUNKSTATE**](/windows/win32/api/filter/ne-filter-chunkstate)et [**Stat \_**](/windows/win32/api/filter/ns-filter-stat_chunk).</span><span class="sxs-lookup"><span data-stu-id="8cf9b-204">For more information, see [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**CHUNK\_BREAKTYPE**](/windows/win32/api/filter/ne-filter-chunk_breaktype), [**CHUNKSTATE**](/windows/win32/api/filter/ne-filter-chunkstate), and [**STAT\_CHUNK**](/windows/win32/api/filter/ns-filter-stat_chunk).</span></span>

<span data-ttu-id="8cf9b-205">Si vous contrôlez le format de fichier et qu’il ne contient pas d’informations de paramètres régionaux, vous devez ajouter une fonctionnalité utilisateur pour permettre l’identification des paramètres régionaux appropriés.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-205">If you control the file format and it currently does not contain locale information, you should add a user feature to enable proper locale identification.</span></span> <span data-ttu-id="8cf9b-206">L’utilisation d’un analyseur lexical incompatible peut entraîner une mauvaise expérience de requête pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-206">Using a mismatched word breaker can result in a poor query experience for the user.</span></span> <span data-ttu-id="8cf9b-207">Pour plus d’informations, consultez [**IWordBreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span><span class="sxs-lookup"><span data-stu-id="8cf9b-207">For more information, see [**IWordBreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span></span>

> [!NOTE]  
> <span data-ttu-id="8cf9b-208">Les filtres sont associés à des types de fichiers, tels qu’ils sont dénotés par des extensions de nom de fichier, des types MIME ou des CLSID.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-208">Filters are associated with file types, as denoted by file name extensions, MIME types or CLSIDs.</span></span> <span data-ttu-id="8cf9b-209">Alors qu’un filtre peut gérer plusieurs types de fichiers, chaque type fonctionne avec un seul filtre.</span><span class="sxs-lookup"><span data-stu-id="8cf9b-209">While one filter can handle multiple file types, each type works with only one filter.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="8cf9b-210">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="8cf9b-210">Additional Resources</span></span>

- <span data-ttu-id="8cf9b-211">L’exemple de code [IFilterSample](-search-sample-ifiltersample.md) , disponible sur [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample7), montre comment créer une classe de base IFilter pour l’implémentation de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="8cf9b-211">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample7), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="8cf9b-212">Pour obtenir une vue d’ensemble du processus d’indexation, consultez [processus d’indexation](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="8cf9b-212">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="8cf9b-213">Pour obtenir une vue d’ensemble des types de fichiers, consultez [types de fichiers](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="8cf9b-213">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="8cf9b-214">Pour interroger des attributs d’association de fichiers pour un type de fichier, consultez [PerceivedTypes, SystemFileAssociations et inscription d’application](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="8cf9b-214">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8cf9b-215">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8cf9b-215">Related topics</span></span>

[<span data-ttu-id="8cf9b-216">Développement de gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="8cf9b-216">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="8cf9b-217">Meilleures pratiques pour la création de gestionnaires de filtres dans Windows Search</span><span class="sxs-lookup"><span data-stu-id="8cf9b-217">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="8cf9b-218">Retour des propriétés d’un gestionnaire de filtres</span><span class="sxs-lookup"><span data-stu-id="8cf9b-218">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="8cf9b-219">Gestionnaires de filtres fournis avec Windows</span><span class="sxs-lookup"><span data-stu-id="8cf9b-219">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="8cf9b-220">Implémentation de gestionnaires de filtres dans Windows Search</span><span class="sxs-lookup"><span data-stu-id="8cf9b-220">Implementing Filter Handlers in Windows Search</span></span>](-search-ifilter-constructing-filters.md)

[<span data-ttu-id="8cf9b-221">Inscription des gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="8cf9b-221">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="8cf9b-222">Test des gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="8cf9b-222">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
