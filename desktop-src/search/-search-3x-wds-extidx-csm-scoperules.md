---
description: Le gestionnaire de portée d’analyse (CSM) vous permet de définir des règles d’étendue qui incluent ou excluent des URL de la portée de l’analyse de Windows Search.
ms.assetid: 132a55f9-680d-438e-b983-f5ce4cf66a41
title: Gestion des règles d’étendue
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20d45199726cfe36dc1c4936e9ac7699a288c3ea
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104112498"
---
# <a name="managing-scope-rules"></a><span data-ttu-id="d8490-103">Gestion des règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-103">Managing Scope Rules</span></span>

<span data-ttu-id="d8490-104">Le gestionnaire de portée d’analyse (CSM) vous permet de définir des règles d’étendue qui incluent ou excluent des URL de la portée de l’analyse de Windows Search.</span><span class="sxs-lookup"><span data-stu-id="d8490-104">The Crawl Scope Manager (CSM) enables you define scope rules that include or exclude URLs from the Windows Search crawl scope.</span></span>

<span data-ttu-id="d8490-105">CSM vous permet d’effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="d8490-105">The CSM lets you do the following:</span></span>

-   <span data-ttu-id="d8490-106">Ajouter de nouvelles règles d’étendue à l’ensemble de règles de travail</span><span class="sxs-lookup"><span data-stu-id="d8490-106">Add new scope rules to the working rule set</span></span>
-   <span data-ttu-id="d8490-107">Supprimer les règles d’étendue existantes</span><span class="sxs-lookup"><span data-stu-id="d8490-107">Remove existing scope rules</span></span>
-   <span data-ttu-id="d8490-108">Énumérer les règles d’étendue par défaut</span><span class="sxs-lookup"><span data-stu-id="d8490-108">Enumerate default scope rules</span></span>
-   <span data-ttu-id="d8490-109">Déterminer si une URL particulière est incluse ou exclue de l’étendue de l’analyse ou si elle a une règle d’étendue parente ou enfant</span><span class="sxs-lookup"><span data-stu-id="d8490-109">Discover whether a particular URL is included or excluded from the crawl scope or has a parent or child scope rule</span></span>

 

<span data-ttu-id="d8490-110">Cette rubrique traite des sujets suivants :</span><span class="sxs-lookup"><span data-stu-id="d8490-110">This topic includes the following subjects:</span></span>

-   [<span data-ttu-id="d8490-111">À propos des règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-111">About Scope Rules</span></span>](#about-scope-rules)
-   [<span data-ttu-id="d8490-112">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="d8490-112">Before You Begin</span></span>](#before-you-begin)
-   [<span data-ttu-id="d8490-113">Ajout de règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-113">Adding Scope Rules</span></span>](#adding-scope-rules)
    -   [<span data-ttu-id="d8490-114">Remarques sur les règles utilisateur</span><span class="sxs-lookup"><span data-stu-id="d8490-114">Notes on User Rules</span></span>](#notes-on-user-rules)
-   [<span data-ttu-id="d8490-115">Suppression des règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-115">Removing Scope Rules</span></span>](#removing-scope-rules)
-   [<span data-ttu-id="d8490-116">Rétablissement des règles par défaut</span><span class="sxs-lookup"><span data-stu-id="d8490-116">Reverting to Default Rules</span></span>](#reverting-to-default-rules)
-   [<span data-ttu-id="d8490-117">Énumération des règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-117">Enumerating Scope Rules</span></span>](#enumerating-scope-rules)
-   [<span data-ttu-id="d8490-118">Règles d’étendue de suivi</span><span class="sxs-lookup"><span data-stu-id="d8490-118">Tracing Scope Rules</span></span>](#tracing-scope-rules)
-   [<span data-ttu-id="d8490-119">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="d8490-119">Related topics</span></span>](#related-topics)

## <a name="about-scope-rules"></a><span data-ttu-id="d8490-120">À propos des règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-120">About Scope Rules</span></span>

<span data-ttu-id="d8490-121">Une règle d’étendue est une règle qui inclut ou exclut de l’analyse et de l’indexation des URL d’une racine de recherche.</span><span class="sxs-lookup"><span data-stu-id="d8490-121">A scope rule is a rule that includes or excludes URLs within a search root from being crawled and indexed.</span></span> <span data-ttu-id="d8490-122">Les règles d’inclusion obligent l’indexeur à inclure cette URL dans l’étendue Scrawl, et les règles d’exclusion provoquent l’exclusion de l’indexeur de cette URL (et de ses enfants) de la portée de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="d8490-122">Inclusion rules cause the indexer to include that URL in the scrawl scope, and exclusion rules cause the indexer exclude that URL (and its children) from the crawl scope.</span></span>

<span data-ttu-id="d8490-123">Par exemple, supposons que vous avez installé une nouvelle application dont les fichiers de données se trouvent dans le dossier WorkteamA \\ ProjectFiles sur un ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="d8490-123">For example, suppose you've installed a new application whose data files are located in the folder WorkteamA\\ProjectFiles on a local computer.</span></span> <span data-ttu-id="d8490-124">Supposons que vous souhaitiez que tout le contenu du dossier ProjectFiles soit indexé, à l’exception des éléments dans les prototypes de sous-dossier.</span><span class="sxs-lookup"><span data-stu-id="d8490-124">Suppose you want everything within the ProjectFiles folder indexed except for items in the subfolder Prototypes.</span></span> <span data-ttu-id="d8490-125">Dans ce cas, vous avez besoin d’une règle d’inclusion pour myPH:///C : \\ WorkteamA \\ ProjectFiles \\ et d’une règle d’exclusion pour myph:///C : \\ WorkteamA \\ ProjectFiles \\ prototypes \\ .</span><span class="sxs-lookup"><span data-stu-id="d8490-125">In this situation, you would need an inclusion rule for myPH:///C:\\WorkteamA\\ProjectFiles\\ and an exclusion rule for myPH:///C:\\WorkteamA\\ProjectFiles\\Prototypes\\.</span></span>

<span data-ttu-id="d8490-126">Il existe trois types de règles, avec l’ordre de priorité suivant :</span><span class="sxs-lookup"><span data-stu-id="d8490-126">There are three types of rules, with the following order of precedence:</span></span>

1.  <span data-ttu-id="d8490-127">Les règles de stratégie de groupe sont définies par les administrateurs et peuvent remplacer toutes les autres règles.</span><span class="sxs-lookup"><span data-stu-id="d8490-127">Group Policy rules are set by administrators and can override all other rules.</span></span>
2.  <span data-ttu-id="d8490-128">Les règles utilisateur sont définies par les utilisateurs qui modifient l’étendue dans l’interface utilisateur des options de recherche Windows.</span><span class="sxs-lookup"><span data-stu-id="d8490-128">User rules are set by users modifying the scope in the Windows Search options user interface.</span></span> <span data-ttu-id="d8490-129">Les utilisateurs ou d’autres applications peuvent supprimer toutes les règles utilisateur et rétablir les règles par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8490-129">Users or other applications can remove all user rules and revert to default rules.</span></span>
3.  <span data-ttu-id="d8490-130">Les règles par défaut sont généralement définies par une application pour définir une étendue par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8490-130">Default rules are typically set by an application to define a default scope.</span></span> <span data-ttu-id="d8490-131">Par exemple, les règles par défaut peuvent être définies lors de l’ajout d’un nouveau gestionnaire de protocole ou d’un conteneur au système.</span><span class="sxs-lookup"><span data-stu-id="d8490-131">For example, default rules might be set when a new protocol handler or container is added to the system.</span></span>

<span data-ttu-id="d8490-132">Ensemble, ces types de règles comprennent l’ensemble de règles de *travail* à partir duquel le gestionnaire de portée d’analyse (CSM) génère la liste complète des URL à analyser.</span><span class="sxs-lookup"><span data-stu-id="d8490-132">Together, these types of rules comprise the *working rule set* from which the Crawl Scope Manager (CSM) generates the full list of URLs to crawl.</span></span> <span data-ttu-id="d8490-133">Alors que les règles par défaut peuvent être remplacées par les règles de stratégie de groupe et par les règles de l’utilisateur, elles sont conservées dans leur propre ensemble de règles par défaut, que vous pouvez restaurer à tout moment.</span><span class="sxs-lookup"><span data-stu-id="d8490-133">While default rules can be overridden by group policy rules and by user rules, they are maintained in their own default rule set, which you can revert to at any time.</span></span> <span data-ttu-id="d8490-134">L’indexeur analyse les URL de l’ensemble de règles de travail et ajoute des éléments, des propriétés et du contenu au catalogue.</span><span class="sxs-lookup"><span data-stu-id="d8490-134">The indexer crawls the URLs from the working rule set and adds items, properties, and content to the catalog.</span></span>

> [!Note]  
> <span data-ttu-id="d8490-135">Les utilisateurs ayant accès au panneau de configuration peuvent modifier les règles via cette interface.</span><span class="sxs-lookup"><span data-stu-id="d8490-135">Users with access to Control Panel can modify the rules through that interface.</span></span> <span data-ttu-id="d8490-136">Par conséquent, les applications qui offrent la gestion des étendues doivent toujours obtenir les règles directement à partir du CSM en utilisant les méthodes d’énumération au lieu de s’appuyer sur une copie enregistrée des règles utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d8490-136">Therefore, applications offering scope management should always get the rules directly from the CSM by using the enumeration methods instead of relying on a saved copy of user rules.</span></span>

 

<span data-ttu-id="d8490-137">Les règles d’exclusion peuvent définir des URL de modèle avec le caractère générique « \* », par exemple : file:///C : \\ ProjectA \\ \* \\ .</span><span class="sxs-lookup"><span data-stu-id="d8490-137">Exclusion rules can define pattern URLs with the wildcard character '\*'; for example: file:///C:\\ProjectA\\\*\\.</span></span> <span data-ttu-id="d8490-138">Une règle d’exclusion utilisant ce modèle empêche l’indexeur d’analyser les dossiers situés sous le répertoire ProjectA.</span><span class="sxs-lookup"><span data-stu-id="d8490-138">An exclusion rule using this pattern prevents the indexer from crawling any folders under the ProjectA directory.</span></span> <span data-ttu-id="d8490-139">Pour obtenir un exemple plus complexe, supposez qu’il existe une règle d’inclusion pour file:///C : \\ ProjectA \\ et une règle de modèle d’exclusion pour file:///C : \\ ProjectA \\ \* \\ Data \\ \* .</span><span class="sxs-lookup"><span data-stu-id="d8490-139">For a more complicated example, suppose there is an inclusion rule for file:///C:\\ProjectA\\ and an exclusion pattern rule for file:///C:\\ProjectA\\\*\\data\\\*.</span></span> <span data-ttu-id="d8490-140">Dans ce cas, l’indexeur analyse les éléments dans :</span><span class="sxs-lookup"><span data-stu-id="d8490-140">In this case, the indexer would crawl items in:</span></span>

-   <span data-ttu-id="d8490-141">C : \\ ProjectA</span><span class="sxs-lookup"><span data-stu-id="d8490-141">C:\\ProjectA</span></span>\\
-   <span data-ttu-id="d8490-142">C : \\ projeta \\ **version1** \\ testfiles</span><span class="sxs-lookup"><span data-stu-id="d8490-142">C:\\ProjectA\\**version1**\\testfiles</span></span>\\
-   <span data-ttu-id="d8490-143">C : \\ ProjectA \\ **version1 \\**- \\ données temporaires</span><span class="sxs-lookup"><span data-stu-id="d8490-143">C:\\ProjectA\\**version1\\temp**\\data</span></span>\\

<span data-ttu-id="d8490-144">Mais l’indexeur n’analyse pas les éléments dans :</span><span class="sxs-lookup"><span data-stu-id="d8490-144">But the indexer would not crawl items in:</span></span>

-   <span data-ttu-id="d8490-145">C : \\ ProjectA \\ **version1** \\ données</span><span class="sxs-lookup"><span data-stu-id="d8490-145">C:\\ProjectA\\**version1**\\data</span></span>\\

 

## <a name="before-you-begin"></a><span data-ttu-id="d8490-146">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="d8490-146">Before You Begin</span></span>

<span data-ttu-id="d8490-147">Avant d’utiliser l’une des interfaces du gestionnaire d’étendues d’analyse, vous devez effectuer les étapes préalables suivantes :</span><span class="sxs-lookup"><span data-stu-id="d8490-147">Before you use any of the Crawl Scope Manager interfaces, you must perform the following prerequisite steps:</span></span>

1.  <span data-ttu-id="d8490-148">Créez l’objet **CSearchManager** et obtenez son interface **ISearchManager** .</span><span class="sxs-lookup"><span data-stu-id="d8490-148">Create the **CSearchManager** object and obtain its **ISearchManager** interface.</span></span>
2.  <span data-ttu-id="d8490-149">Appelez **ISearchManager :: getCatalog,** pour « SystemIndex » pour obtenir une instance de l’interface **ISearchCatalogManager** .</span><span class="sxs-lookup"><span data-stu-id="d8490-149">Call **ISearchManager::GetCatalog** for "SystemIndex" to obtain an instance of the **ISearchCatalogManager** interface.</span></span>
3.  <span data-ttu-id="d8490-150">Appelez **ISearchCatalogManager :: GetCrawlScopeManager** pour obtenir une instance de l’interface **ISearchCrawlScopeManager** .</span><span class="sxs-lookup"><span data-stu-id="d8490-150">Call **ISearchCatalogManager::GetCrawlScopeManager** to obtain an instance of the **ISearchCrawlScopeManager** interface.</span></span>

<span data-ttu-id="d8490-151">Après avoir apporté des modifications au gestionnaire de l’étendue de l’analyse, vous devez appeler la méthode [**ISearchCrawlScopeManager ::**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-saveall) saproduction.</span><span class="sxs-lookup"><span data-stu-id="d8490-151">After making any changes to the Crawl Scope Manager, you must call the [**ISearchCrawlScopeManager::SaveAll**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-saveall) method.</span></span> <span data-ttu-id="d8490-152">Cette méthode ne prend pas de paramètres et retourne S \_ OK en cas de réussite.</span><span class="sxs-lookup"><span data-stu-id="d8490-152">This method takes no parameters and returns S\_OK on success.</span></span>

 

## <a name="adding-scope-rules"></a><span data-ttu-id="d8490-153">Ajout de règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-153">Adding Scope Rules</span></span>

<span data-ttu-id="d8490-154">Les règles de travail définies pour le CSM incluent les règles utilisateur et par défaut, ainsi que toutes les règles imposées par la stratégie de groupe.</span><span class="sxs-lookup"><span data-stu-id="d8490-154">The working rules set for the CSM includes user and default rules, as well as any rules forced by group policy.</span></span> <span data-ttu-id="d8490-155">Les règles utilisateur sont configurées par les utilisateurs dans une interface utilisateur, et les règles par défaut peuvent être définies par l’un des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="d8490-155">User rules are set up by users in a user interface, and default rules can be set by any of the following:</span></span>

-   <span data-ttu-id="d8490-156">Stratégies de groupe implémentées par un administrateur système (celles-ci n’utilisent pas l’interface [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) .)</span><span class="sxs-lookup"><span data-stu-id="d8490-156">Group policies implemented by a system administrator (These do not use the [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) interface.)</span></span>
-   <span data-ttu-id="d8490-157">Installation ou mise à jour d’une application telle que Windows Search ou un gestionnaire de protocole</span><span class="sxs-lookup"><span data-stu-id="d8490-157">The installation or update of an application like Windows Search or a protocol handler</span></span>
-   <span data-ttu-id="d8490-158">Une application d’installation pour l’ajout d’une nouvelle banque de données ou d’un nouveau conteneur</span><span class="sxs-lookup"><span data-stu-id="d8490-158">A setup application for the addition of a new data store or container</span></span>

<span data-ttu-id="d8490-159">Le [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) fournit deux méthodes pour ajouter de nouvelles règles d’étendue, comme décrit dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="d8490-159">The [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) provides two methods for adding new scope rules, as described in the following table.</span></span> <span data-ttu-id="d8490-160">Les chemins d’accès pour les règles d’inclusion du système de fichiers doivent se terminer par une barre oblique inverse « \\ » (par exemple, file:///C : \\ Files \\ ), et les chemins d’accès des règles d’exclusion doivent se terminer par un astérisque (par exemple, file:///c : \\ Files \\ \* ).</span><span class="sxs-lookup"><span data-stu-id="d8490-160">Paths for inclusion rules for the file system must end with a backslash '\\' (for example, file:///C:\\files\\), and paths for exclusion rules must end with an asterisk (for example, file:///c:\\files\\\*).</span></span> <span data-ttu-id="d8490-161">Seules les règles d’exclusion peuvent contenir des URL de modèle.</span><span class="sxs-lookup"><span data-stu-id="d8490-161">Only exclusion rules can contain pattern URLs.</span></span> <span data-ttu-id="d8490-162">En outre, nous vous recommandons d’inclure les identificateurs de sécurité (SID) des utilisateurs dans les chemins d’accès, pour une meilleure sécurité.</span><span class="sxs-lookup"><span data-stu-id="d8490-162">Furthermore, we recommend including users' security identifiers (SIDs) in paths, for better security.</span></span> <span data-ttu-id="d8490-163">Les chemins d’accès par utilisateur sont plus sécurisés, car les requêtes s’exécutent dans un processus par utilisateur, ce qui garantit qu’un utilisateur ne peut pas voir les éléments indexés à partir de la boîte de réception d’un autre utilisateur, par exemple.</span><span class="sxs-lookup"><span data-stu-id="d8490-163">Per-user paths are more secure as queries would then run in a per-user process, ensuring that one user cannot see items indexed from another user's inbox, for example.</span></span>

<span data-ttu-id="d8490-164">Le tableau suivant décrit les méthodes de l’interface ISearchCrawlScopeManager utilisée pour ajouter de nouvelles règles d’étendue.</span><span class="sxs-lookup"><span data-stu-id="d8490-164">The following table describes the methods of the ISearchCrawlScopeManager interface used for adding new scope rules.</span></span>



| <span data-ttu-id="d8490-165">Méthode</span><span class="sxs-lookup"><span data-stu-id="d8490-165">Method</span></span>                                                                              | <span data-ttu-id="d8490-166">Description</span><span class="sxs-lookup"><span data-stu-id="d8490-166">Description</span></span>                                                                                                                                                                                                                  |
|-------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d8490-167">**AddUserScopeRule**</span><span class="sxs-lookup"><span data-stu-id="d8490-167">**AddUserScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-adduserscoperule)       | <span data-ttu-id="d8490-168">Ajoute une règle pour une URL, telle que spécifiée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d8490-168">Adds a rule for a URL, as specified by the user.</span></span> <span data-ttu-id="d8490-169">Ces règles remplacent les règles par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8490-169">These rules override default rules.</span></span> <span data-ttu-id="d8490-170">Utilisez cette méthode si vous avez implémenté une interface utilisateur qui permet aux utilisateurs de gérer leurs propres règles d’étendue et URL.</span><span class="sxs-lookup"><span data-stu-id="d8490-170">Use this method if you have implemented a user interface that lets users manage their own scope rules and URLs.</span></span>                         |
| [<span data-ttu-id="d8490-171">**AddDefaultScopeRule**</span><span class="sxs-lookup"><span data-stu-id="d8490-171">**AddDefaultScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-adddefaultscoperule) | <span data-ttu-id="d8490-172">Ajoute une règle pour une URL, telle que spécifiée par une autre application, comme un gestionnaire de protocole.</span><span class="sxs-lookup"><span data-stu-id="d8490-172">Adds a rule for a URL, as specified by another application like a protocol handler.</span></span> <span data-ttu-id="d8490-173">Utilisez cette méthode lorsque vous avez implémenté un nouveau gestionnaire de protocole ou ajouté un nouveau magasin de données.</span><span class="sxs-lookup"><span data-stu-id="d8490-173">Use this method when you have implemented a new protocol handler or added a new data store.</span></span> <span data-ttu-id="d8490-174">Ces règles peuvent être remplacées par des règles utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d8490-174">These rules can be overridden by user rules.</span></span> |



 

<span data-ttu-id="d8490-175">Chaque méthode prend une URL vers un emplacement indexable et des indicateurs qui déterminent si l’URL doit être incluse ou exclue.</span><span class="sxs-lookup"><span data-stu-id="d8490-175">Each method takes a URL to an indexable location and flags that determine whether the URL should be included or excluded.</span></span> <span data-ttu-id="d8490-176">Le paramètre *fFollowFlags* est réservé pour une utilisation ultérieure.</span><span class="sxs-lookup"><span data-stu-id="d8490-176">The *fFollowFlags* parameter is reserved for future use.</span></span> <span data-ttu-id="d8490-177">Lorsque vous ajoutez une nouvelle règle d’étendue et que le gestionnaire de l’étendue de l’analyse détermine que la règle existe déjà (en fonction de l’URL ou du modèle fourni), l’ensemble de règles de travail est mis à jour. ainsi, (1) l’ancienne règle est remplacée par la nouvelle règle et (2) toutes les règles utilisateur qui contredisent celle-ci sont supprimées.</span><span class="sxs-lookup"><span data-stu-id="d8490-177">When you add a new scope rule and the Crawl Scope Manager determines that the rule already exists (based on the URL or the pattern provided), the working rule set is updated so that (1) the old rule is replaced by the new rule and (2) any user rules that contradict it are removed.</span></span>

<span data-ttu-id="d8490-178">**Conseil :** La racine file://est incluse par défaut dans l’étendue de l’analyse, mais les fichiers programme ne sont pas indexés par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8490-178">**Tip:** While the file:// root is included by default in the crawl scope, Program Files is not indexed by default.</span></span> <span data-ttu-id="d8490-179">Par conséquent, les applications avec des données enregistrées dans le répertoire Program Files doivent ajouter leur emplacement en tant que règle par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8490-179">Therefore, applications with data saved to their Program Files directory need to add their location as a default rule.</span></span>

### <a name="notes-on-user-rules"></a><span data-ttu-id="d8490-180">Remarques sur les règles utilisateur</span><span class="sxs-lookup"><span data-stu-id="d8490-180">Notes on User Rules</span></span>

<span data-ttu-id="d8490-181">Si une nouvelle règle d’utilisateur est identique à une règle par défaut existante, la nouvelle règle utilisateur remplace la règle par défaut dans l’ensemble de règles de travail.</span><span class="sxs-lookup"><span data-stu-id="d8490-181">If a new user rule is the same as an existing default rule, the new user rule overrides the default rule in the working rule set.</span></span> <span data-ttu-id="d8490-182">Si la nouvelle règle utilisateur est identique à une règle d’utilisateur existante, l’ancienne règle utilisateur est remplacée.</span><span class="sxs-lookup"><span data-stu-id="d8490-182">If the new user rule is the same as an existing user rule, the old user rule is replaced.</span></span>

<span data-ttu-id="d8490-183">La définition de l’indicateur *fOverrideChildren* a les résultats suivants dans l’ensemble de règles de travail :</span><span class="sxs-lookup"><span data-stu-id="d8490-183">Setting the flag *fOverrideChildren* has the following results in the working rule set:</span></span>

-   <span data-ttu-id="d8490-184">**True** entraîne la suppression de toutes les règles enfants de l’ensemble de règles de travail (règles d’utilisateur et règles par défaut).</span><span class="sxs-lookup"><span data-stu-id="d8490-184">**TRUE** results in the removal of all child rules from the working rule set (both user rules and default rules).</span></span>
-   <span data-ttu-id="d8490-185">La valeur FALSe entraîne l’ajout à nouveau des règles de travail à l’ensemble des règles par défaut qui sont des enfants de la nouvelle règle utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d8490-185">FALSE results in re-adding to the working rules set all the default rules that are children of the new user rule.</span></span> <span data-ttu-id="d8490-186">Si une règle enfant par défaut est une inclusion et que la nouvelle règle utilisateur est une exclusion, la règle par défaut est remplacée par une règle d’inclusion d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d8490-186">If a child default rule is an inclusion and the new user rule is an exclusion, the default rule is changed to an inclusion user rule.</span></span>

 

## <a name="removing-scope-rules"></a><span data-ttu-id="d8490-187">Suppression des règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-187">Removing Scope Rules</span></span>

<span data-ttu-id="d8490-188">Vous pouvez utiliser l’interface [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) pour supprimer une règle d’étendue de l’ensemble de règles de travail.</span><span class="sxs-lookup"><span data-stu-id="d8490-188">You can use the [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) interface to remove a scope rule from the working rule set.</span></span> <span data-ttu-id="d8490-189">Cette interface fournit les deux méthodes suivantes pour supprimer des règles d’étendue.</span><span class="sxs-lookup"><span data-stu-id="d8490-189">This interface provides the following two methods for removing scope rules.</span></span>



| <span data-ttu-id="d8490-190">Méthode</span><span class="sxs-lookup"><span data-stu-id="d8490-190">Method</span></span>                                                                                    | <span data-ttu-id="d8490-191">Description</span><span class="sxs-lookup"><span data-stu-id="d8490-191">Description</span></span>                                                                                                                                                                                           |
|-------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d8490-192">**RemoveScopeRule**</span><span class="sxs-lookup"><span data-stu-id="d8490-192">**RemoveScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-removescoperule)               | <span data-ttu-id="d8490-193">Supprime une règle utilisateur pour une URL spécifiée de l’ensemble de règles de travail.</span><span class="sxs-lookup"><span data-stu-id="d8490-193">Removes a user rule for a specified URL from the working rule set.</span></span> <span data-ttu-id="d8490-194">Si la règle utilisateur est un doublon de ou remplace une règle par défaut, la règle par défaut reste dans l’ensemble de règles de travail.</span><span class="sxs-lookup"><span data-stu-id="d8490-194">If the user rule is a duplicate of or overrides a default rule, the default rule remains in the working rule set.</span></span>                  |
| [<span data-ttu-id="d8490-195">**RemoveDefaultScopeRule**</span><span class="sxs-lookup"><span data-stu-id="d8490-195">**RemoveDefaultScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-removedefaultscoperule) | <span data-ttu-id="d8490-196">Supprime une règle par défaut pour une URL spécifiée de l’ensemble de règles de travail et de l’ensemble de règles par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8490-196">Removes a default rule for a specified URL from both the working rule set and the default rule set.</span></span> <span data-ttu-id="d8490-197">Après avoir appelé cette méthode, vous ne pouvez pas revenir à cette règle par défaut à l’aide de RevertToDefaultScopes.</span><span class="sxs-lookup"><span data-stu-id="d8490-197">After calling this method, you cannot revert to this default rule by using RevertToDefaultScopes.</span></span> |



 

<span data-ttu-id="d8490-198">Chaque méthode prend une URL et un indicateur qui spécifie si la règle à supprimer est une règle d’inclusion ou d’exclusion.</span><span class="sxs-lookup"><span data-stu-id="d8490-198">Each method takes a URL and a flag indicating whether the rule to be removed is an inclusion or exclusion rule.</span></span> <span data-ttu-id="d8490-199">Ces méthodes renvoient une erreur si une règle avec cette URL et l’indicateur d’inclusion/exclusion est introuvable.</span><span class="sxs-lookup"><span data-stu-id="d8490-199">These methods returns an error if a rule with that URL and inclusion/exclusion flag is not found.</span></span>

<span data-ttu-id="d8490-200">**Conseil :** Si vous souhaitez supprimer entièrement une étendue de l’étendue de l’analyse, utilisez la méthode [**RemoveRoot**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-removeroot) , qui supprime la racine de recherche et toutes les règles d’étendue associées.</span><span class="sxs-lookup"><span data-stu-id="d8490-200">**Tip:** If you want to remove a scope from the crawl scope entirely, use the [**RemoveRoot**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-removeroot) method, which removes the search root and all associated scope rules.</span></span> <span data-ttu-id="d8490-201">Le fait de désinstaller, par exemple, est considéré comme une bonne pratique.</span><span class="sxs-lookup"><span data-stu-id="d8490-201">Doing this while uninstalling, for example, is considered best practice.</span></span>

<span data-ttu-id="d8490-202">Il est également possible de supprimer tous les remplacements définis par l’utilisateur d’une racine de recherche et de rétablir la racine de recherche d’origine et les règles d’étendue par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8490-202">It is also possible to remove all user-set overrides of a search root and revert to the original search root and default scope rules.</span></span> <span data-ttu-id="d8490-203">Pour plus d’informations, reportez-vous à la section suivante.</span><span class="sxs-lookup"><span data-stu-id="d8490-203">For more information, refer to the next section.</span></span>

> [!Note]  
> <span data-ttu-id="d8490-204">Sur Windows Vista, si les utilisateurs sont supprimés par le biais de profils utilisateur dans le panneau de configuration, CSM supprime toutes les règles et toutes les racines qui incluent leur SID et supprime leurs éléments indexés du catalogue.</span><span class="sxs-lookup"><span data-stu-id="d8490-204">On Windows Vista, if users are removed through User Profiles in Control Panel, CSM removes all rules and roots that include their SID and removes their indexed items from the catalog.</span></span> <span data-ttu-id="d8490-205">Sur Windows XP, vous devez supprimer manuellement les racines et les règles des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="d8490-205">On Windows XP, you must remove the users' roots and rules manually.</span></span>

 

 

## <a name="reverting-to-default-rules"></a><span data-ttu-id="d8490-206">Rétablissement des règles par défaut</span><span class="sxs-lookup"><span data-stu-id="d8490-206">Reverting to Default Rules</span></span>

<span data-ttu-id="d8490-207">Le rétablissement des règles par défaut supprime toutes les règles utilisateur pour une URL ou la racine et restaure toutes les règles par défaut dans l’ensemble de règles de travail.</span><span class="sxs-lookup"><span data-stu-id="d8490-207">Reverting to default rules removes all user rules for a URL or root and restores all default rules to the working rule set.</span></span> <span data-ttu-id="d8490-208">Toutefois, elle ne supprime pas les règles définies par la stratégie de groupe.</span><span class="sxs-lookup"><span data-stu-id="d8490-208">It does not, however, remove rules set by group policy.</span></span> <span data-ttu-id="d8490-209">La méthode [**RevertToDefaultScopes**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-reverttodefaultscopes) n’accepte aucun paramètre et retourne un code d’erreur s’il ne peut pas rétablir les règles par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8490-209">The [**RevertToDefaultScopes**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-reverttodefaultscopes) method takes no parameters and returns an error code if it is unable to revert to default rules.</span></span>

 

## <a name="enumerating-scope-rules"></a><span data-ttu-id="d8490-210">Énumération des règles d’étendue</span><span class="sxs-lookup"><span data-stu-id="d8490-210">Enumerating Scope Rules</span></span>

<span data-ttu-id="d8490-211">CSM énumère les règles de portée à l’aide d’une interface d’énumérateur de style COM standard, [**IEnumSearchScopeRules**](/windows/desktop/api/Searchapi/nn-searchapi-ienumsearchscoperules) .</span><span class="sxs-lookup"><span data-stu-id="d8490-211">The CSM enumerates scope rules by using a standard COM-style enumerator interface, [**IEnumSearchScopeRules**](/windows/desktop/api/Searchapi/nn-searchapi-ienumsearchscoperules) .</span></span> <span data-ttu-id="d8490-212">Vous pouvez utiliser cette interface pour énumérer les règles d’étendue à plusieurs fins.</span><span class="sxs-lookup"><span data-stu-id="d8490-212">You can use this interface to enumerate scope rules for several purposes.</span></span> <span data-ttu-id="d8490-213">Par exemple, vous souhaiterez peut-être afficher l’ensemble des règles de travail dans une interface utilisateur, ou déterminer si une règle ou l’enfant d’une règle figure déjà dans l’étendue de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="d8490-213">For example, you might want to display the entire working rule set in a user interface, or discover whether a rule or the child of a rule is already in the crawl scope.</span></span>

 

## <a name="tracing-scope-rules"></a><span data-ttu-id="d8490-214">Règles d’étendue de suivi</span><span class="sxs-lookup"><span data-stu-id="d8490-214">Tracing Scope Rules</span></span>

<span data-ttu-id="d8490-215">Le CSM vous permet également de déterminer si une URL spécifiée est incluse dans la portée de l’analyse et si elle a une règle d’étendue parente ou enfant.</span><span class="sxs-lookup"><span data-stu-id="d8490-215">The CSM also enables you to determine whether a specified URL is included in the crawl scope and whether it has a parent or child scope rule.</span></span> <span data-ttu-id="d8490-216">Vous pouvez également déterminer la raison pour laquelle une URL est incluse ou exclue de l’étendue de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="d8490-216">You can also find out why a URL is included or excluded from the crawl scope.</span></span> <span data-ttu-id="d8490-217">Ces méthodes ne sont pas destinées à être utilisées avec des URL de modèle.</span><span class="sxs-lookup"><span data-stu-id="d8490-217">These methods are not intended to be used with pattern URLs.</span></span>

<span data-ttu-id="d8490-218">Le tableau suivant décrit les méthodes de [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) utilisées pour l’ajout de nouvelles règles d’étendue.</span><span class="sxs-lookup"><span data-stu-id="d8490-218">The following table describes the methods of [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) used for adding new scope rules.</span></span>



| <span data-ttu-id="d8490-219">Méthode</span><span class="sxs-lookup"><span data-stu-id="d8490-219">Method</span></span>                                                                                      | <span data-ttu-id="d8490-220">Description</span><span class="sxs-lookup"><span data-stu-id="d8490-220">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|---------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d8490-221">**GetParentScopeVersionId**</span><span class="sxs-lookup"><span data-stu-id="d8490-221">**GetParentScopeVersionId**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-getparentscopeversionid) | <span data-ttu-id="d8490-222">Obtient l’ID de version de l’URL d’inclusion parente.</span><span class="sxs-lookup"><span data-stu-id="d8490-222">Gets the version ID of the parent inclusion URL.</span></span> <span data-ttu-id="d8490-223">Vous pouvez utiliser cette méthode pour voir si l’étendue du parent a changé depuis la dernière fois que vous l’avez vérifiée.</span><span class="sxs-lookup"><span data-stu-id="d8490-223">You can use this method to see if the parent scope has changed since the last time you checked it.</span></span><br/> <span data-ttu-id="d8490-224">Exemple : si une application de messagerie utilise des notifications gérées par le fournisseur, elle peut obtenir la version de l’étendue parente avant qu’elle ne se ferme et vérifier à nouveau la version lorsqu’elle s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="d8490-224">Example: If a mail application uses provider-managed notifications, it might get the parent scope version before it closes and check the version again when it opens.</span></span> <span data-ttu-id="d8490-225">L’application peut ensuite déterminer si elle doit envoyer un nouvel ensemble de notifications à l’indexeur.</span><span class="sxs-lookup"><span data-stu-id="d8490-225">Then the application can determine whether it needs to push a new set of notifications to the indexer.</span></span><br/> |
| [<span data-ttu-id="d8490-226">**HasChildScopeRule**</span><span class="sxs-lookup"><span data-stu-id="d8490-226">**HasChildScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-haschildscoperule)             | <span data-ttu-id="d8490-227">Retourne la **valeur true** si l’URL spécifiée a une règle enfant (une règle s’appliquant à un enfant à n’importe quel niveau au sein de sa hiérarchie d’URL).</span><span class="sxs-lookup"><span data-stu-id="d8490-227">Returns **TRUE** if the specified URL has a child rule (a rule applying to a child at any level within its URL hierarchy).</span></span> <br/> <span data-ttu-id="d8490-228">Exemple : si l’URL est file:///C : \\ Folder \\ , cette méthode renvoie la **valeur true** si le CSM possède une règle d’étendue spécifique pour file:///C : \\ \\ subfolder \\ .</span><span class="sxs-lookup"><span data-stu-id="d8490-228">Example: If the URL is file:///C:\\Folder\\, this method returns **TRUE** if the CSM has a scope rule specifically for file:///C:\\Folder\\Subfolder\\.</span></span><br/>                                                                                                                                              |
| [<span data-ttu-id="d8490-229">**HasParentScopeRule**</span><span class="sxs-lookup"><span data-stu-id="d8490-229">**HasParentScopeRule**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-hasparentscoperule)           | <span data-ttu-id="d8490-230">Retourne la **valeur true** si l’URL spécifiée a une règle parente (une règle s’appliquant à un parent à n’importe quel niveau de la hiérarchie d’URL).</span><span class="sxs-lookup"><span data-stu-id="d8490-230">Returns **TRUE** if the specified URL has a parent rule (a rule applying to a parent at any level in the URL hierarchy).</span></span><br/> <span data-ttu-id="d8490-231">Exemple : si l’URL est file:///C : \\ dossier sous \\ -dossier, cette méthode renvoie la **valeur true** si le CSM a une règle d’étendue spécifique pour file:///C : \\ Folder \\ .</span><span class="sxs-lookup"><span data-stu-id="d8490-231">Example: If the URL is file:///C:\\Folder\\Subfolder, this method returns **TRUE** if the CSM has a scope rule specifically for file:///C:\\Folder\\.</span></span><br/>                                                                                                                                                   |
| [<span data-ttu-id="d8490-232">**IncludedInCrawlScope**</span><span class="sxs-lookup"><span data-stu-id="d8490-232">**IncludedInCrawlScope**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscope)       | <span data-ttu-id="d8490-233">Retourne la **valeur true** si l’URL spécifiée est incluse dans la portée de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="d8490-233">Returns **TRUE** if the specified URL is included in the crawl scope.</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="d8490-234">**IncludedInCrawlScopeEx**</span><span class="sxs-lookup"><span data-stu-id="d8490-234">**IncludedInCrawlScopeEx**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscopeex)   | <span data-ttu-id="d8490-235">Retourne une valeur de l’énumération [**\_ raison clusion**](/windows/win32/api/searchapi/ne-searchapi-clusion_reason) qui explique pourquoi l’URL est incluse dans la portée de l’analyse ou en est exclue, et récupère la valeur **true** si l’URL est incluse dans la portée de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="d8490-235">Returns a value from the [**CLUSION\_REASON**](/windows/win32/api/searchapi/ne-searchapi-clusion_reason) enumeration explaining why the URL is included in or excluded from the crawl scope, and retrieves the value **TRUE** if the URL is included in the crawl scope.</span></span> <span data-ttu-id="d8490-236">Cette méthode peut vous aider à identifier les conflits dans votre ensemble de règles de travail.</span><span class="sxs-lookup"><span data-stu-id="d8490-236">This method can help you identify conflicts in your working rule set.</span></span>                                                                                                                                       |



 

 

> [!Note]  
> <span data-ttu-id="d8490-237">Les méthodes [**IncludedInCrawlScope**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscope) et [**IncludedInCrawlScopeEx**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscopeex) déterminent si l’URL sera analysée uniquement en fonction des règles du CSM.</span><span class="sxs-lookup"><span data-stu-id="d8490-237">The [**IncludedInCrawlScope**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscope) and [**IncludedInCrawlScopeEx**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcrawlscopemanager-includedincrawlscopeex) methods determine whether the URL will be crawled based solely on the rules in the CSM.</span></span> <span data-ttu-id="d8490-238">Il peut y avoir d’autres raisons pour lesquelles une URL n’est pas analysée, telle que le bit FANCI en cours de définition (autrement dit, un utilisateur n’a pas autorisé l’indexation rapide dans la boîte de dialogue des propriétés du dossier).</span><span class="sxs-lookup"><span data-stu-id="d8490-238">There can be other reasons that a URL is not crawled, such as the FANCI bit being set (that is, a user has disallowed fast indexing in the folder's Property dialog box.)</span></span>

 

<span data-ttu-id="d8490-239">Si vous pensez qu’un chemin d’accès de fichier doit être exclu, mais qu’il est répertorié comme étant inclus, assurez-vous que les règles d’exclusion se terminent par « <path> \\ \* ».</span><span class="sxs-lookup"><span data-stu-id="d8490-239">If you believe that a file path should be excluded, but it is listed as included, be sure that exclusion rules end with "<path>\\\*".</span></span> <span data-ttu-id="d8490-240">Si vous pensez qu’un fichier ou un chemin d’accès de fichier doit être inclus, mais que ce n’est pas le cas, veillez à vérifier le paramètre de bit FANCI du fichier ou du chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="d8490-240">If you believe that a file or file path should be included but it is not, be sure to check the FANCI bit setting for the file or path.</span></span> <span data-ttu-id="d8490-241">Pour ce faire, cliquez avec le bouton droit sur le chemin d’accès du fichier ou du fichier et sélectionnez **Propriétés**, puis vérifiez que la case à cocher **pour la recherche rapide, autoriser le service d’indexation à indexer ce dossier** est activée.</span><span class="sxs-lookup"><span data-stu-id="d8490-241">You can do this by right-clicking the file or file path and selecting **Properties**, then be sure the **For fast searching, allow Indexing Service to index this folder** checkbox is selected.</span></span> <span data-ttu-id="d8490-242">Si le chemin d’accès au fichier ou au fichier n’est pas marqué pour l’indexation ici, il ne sera pas indexé même s’il se trouve dans une règle d’inclusion.</span><span class="sxs-lookup"><span data-stu-id="d8490-242">If the file or file path is not marked for indexing here, it will not be indexed even if it is in an inclusion rule.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d8490-243">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="d8490-243">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="d8490-244">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="d8490-244">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="d8490-245">**ISearchCrawlScopeManager**</span><span class="sxs-lookup"><span data-stu-id="d8490-245">**ISearchCrawlScopeManager**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager)
</dt> <dt>

[<span data-ttu-id="d8490-246">**ISearchCrawlScopeManager2**</span><span class="sxs-lookup"><span data-stu-id="d8490-246">**ISearchCrawlScopeManager2**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager2)
</dt> <dt>

[<span data-ttu-id="d8490-247">**ISearchScopeRule**</span><span class="sxs-lookup"><span data-stu-id="d8490-247">**ISearchScopeRule**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchscoperule)
</dt> <dt>

[<span data-ttu-id="d8490-248">**IEnumSearchScopeRules**</span><span class="sxs-lookup"><span data-stu-id="d8490-248">**IEnumSearchScopeRules**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-ienumsearchscoperules)
</dt> <dt>

<span data-ttu-id="d8490-249">**Méthodologique**</span><span class="sxs-lookup"><span data-stu-id="d8490-249">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="d8490-250">Gestion des racines de recherche</span><span class="sxs-lookup"><span data-stu-id="d8490-250">Managing Search Roots</span></span>](-search-3x-wds-extidx-csm-searchroots.md)
</dt> </dl>

 

 




