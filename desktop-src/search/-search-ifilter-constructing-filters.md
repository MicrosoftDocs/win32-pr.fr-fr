---
description: Il est important de comprendre la structure de DLL requise d’un gestionnaire de filtres (une implémentation de l’interface IFilter).
ms.assetid: a2b5a813-573a-44d3-8780-99603e3246c1
title: Implémentation de gestionnaires de filtres dans Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc5f326440b31b62ff5697274962f4d4a2cfe7c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106515214"
---
# <a name="implementing-filter-handlers-in-windows-search"></a><span data-ttu-id="aff1d-103">Implémentation de gestionnaires de filtres dans Windows Search</span><span class="sxs-lookup"><span data-stu-id="aff1d-103">Implementing Filter Handlers in Windows Search</span></span>

<span data-ttu-id="aff1d-104">Il est important de comprendre la structure de DLL requise d’un gestionnaire de filtres (une implémentation de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ).</span><span class="sxs-lookup"><span data-stu-id="aff1d-104">It is important that you understand the required DLL structure of a filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span>

<span data-ttu-id="aff1d-105">Cette rubrique est organisée comme suit :</span><span class="sxs-lookup"><span data-stu-id="aff1d-105">This topic is organized as follows:</span></span>

- [<span data-ttu-id="aff1d-106">Implémentation et exportation des points d’entrée de DLL</span><span class="sxs-lookup"><span data-stu-id="aff1d-106">Implementing and Exporting the DLL Entry Points</span></span>](#implementing-and-exporting-the-dll-entry-points)
- [<span data-ttu-id="aff1d-107">Implémentation de la classe IFilter et de la fabrique de classes</span><span class="sxs-lookup"><span data-stu-id="aff1d-107">Implementing the IFilter Class and Class Factory</span></span>](#implementing-the-ifilter-class-and-class-factory)
- [<span data-ttu-id="aff1d-108">Héritage des interfaces COM</span><span class="sxs-lookup"><span data-stu-id="aff1d-108">Inheriting the COM Interfaces</span></span>](#inheriting-the-com-interfaces)
- [<span data-ttu-id="aff1d-109">Implémentation des méthodes de l’interface COM</span><span class="sxs-lookup"><span data-stu-id="aff1d-109">Implementing the COM Interface Methods</span></span>](#implementing-the-com-interface-methods)
  - [<span data-ttu-id="aff1d-110">Méthodes COM non implémentées</span><span class="sxs-lookup"><span data-stu-id="aff1d-110">COM Methods that are not Implemented</span></span>](#com-methods-that-are-not-implemented)
- [<span data-ttu-id="aff1d-111">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="aff1d-111">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="aff1d-112">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="aff1d-112">Related topics</span></span>](#related-topics)

## <a name="implementing-and-exporting-the-dll-entry-points"></a><span data-ttu-id="aff1d-113">Implémentation et exportation des points d’entrée de DLL</span><span class="sxs-lookup"><span data-stu-id="aff1d-113">Implementing and Exporting the DLL Entry Points</span></span>

<span data-ttu-id="aff1d-114">Chaque dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) (dénotée par Ifilter.dll dans cette section) doit implémenter et exporter les points d’entrée suivants.</span><span class="sxs-lookup"><span data-stu-id="aff1d-114">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL (denoted by Ifilter.dll in this section) must implement and export the following entry points.</span></span> <span data-ttu-id="aff1d-115">Ces points d’entrée sont généralement exportés à l’aide d’un fichier de définition de module (. def) pour l’interface **IFilter** ou à l’aide du mot clé **\_ \_ declspec (dllexport)** .</span><span class="sxs-lookup"><span data-stu-id="aff1d-115">These entry points are typically exported using a module-definition (.def) file for the **IFilter** interface or by using the **\_\_declspec(dllexport)** keyword.</span></span> <span data-ttu-id="aff1d-116">Le fichier DLL peut être inscrit dans n’importe quel dossier, mais il se trouve généralement dans le dossier% SystemRoot% \\ system32.</span><span class="sxs-lookup"><span data-stu-id="aff1d-116">The DLL file can be registered to be in any folder, but it usually resides in the %SystemRoot%\\system32 folder.</span></span>

<span data-ttu-id="aff1d-117">Les points d’entrée de DLL sont répertoriés et décrits dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="aff1d-117">DLL entry points are listed and described in the following table.</span></span>

| <span data-ttu-id="aff1d-118">Nom de la DLL</span><span class="sxs-lookup"><span data-stu-id="aff1d-118">DLL name</span></span>                                                                                     | <span data-ttu-id="aff1d-119">Description de la DLL</span><span class="sxs-lookup"><span data-stu-id="aff1d-119">DLL description</span></span>                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="aff1d-120">Accompli</span><span class="sxs-lookup"><span data-stu-id="aff1d-120">DllRegisterServer</span></span>](/windows/win32/api/olectl/nf-olectl-dllregisterserver)            | <span data-ttu-id="aff1d-121">Le point d’entrée [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) inscrit la dll en tant que filtre dans le registre.</span><span class="sxs-lookup"><span data-stu-id="aff1d-121">The [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) entry point registers the DLL as a filter in the registry.</span></span> <span data-ttu-id="aff1d-122">Vous inscrivez la DLL en exécutant le programme regsvr32.exe avec le nom de fichier DLL de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) en tant qu’argument : `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="aff1d-122">You register the DLL by running the regsvr32.exe program with the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface DLL file name as an argument: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span></span>                                              |
| [<span data-ttu-id="aff1d-123">Fonction DllUnregisterServer</span><span class="sxs-lookup"><span data-stu-id="aff1d-123">DllUnregisterServer Function</span></span>](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) | <span data-ttu-id="aff1d-124">Le point d’entrée de la [fonction DllUnregisterServer](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) supprime la dll en tant que gestionnaire persistant dans le registre.</span><span class="sxs-lookup"><span data-stu-id="aff1d-124">The [DllUnregisterServer Function](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) entry point removes the DLL as a persistent handler in the registry.</span></span> <span data-ttu-id="aff1d-125">Pour annuler l’inscription de la DLL, exécutez le programme regsvr32.exe avec l' `/u` indicateur : `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="aff1d-125">You unregister the DLL by running the regsvr32.exe program with the `/u` flag: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span></span>                                                                                    |
| [<span data-ttu-id="aff1d-126">DllGetClassObject, fonction</span><span class="sxs-lookup"><span data-stu-id="aff1d-126">DllGetClassObject Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)   | <span data-ttu-id="aff1d-127">Le client d’indexation de contenu appelle le point d’entrée de la [fonction DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) , par le biais du modèle COM (Component Object Model), pour créer un objet de fabrique de classes pour l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) et obtenir un pointeur vers l’interface de fabrique de classes de cet objet.</span><span class="sxs-lookup"><span data-stu-id="aff1d-127">The content indexing client calls the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point, through Component Object Model (COM), to create a class factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface and to get a pointer to the class factory interface of that object.</span></span>                                               |
| [<span data-ttu-id="aff1d-128">DllCanUnloadNow, fonction</span><span class="sxs-lookup"><span data-stu-id="aff1d-128">DllCanUnloadNow Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)     | <span data-ttu-id="aff1d-129">Le client d’indexation de contenu appelle le point d’entrée de la [fonction DllCanUnloadNow](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) via com pour déterminer s’il est possible de décharger la dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  .</span><span class="sxs-lookup"><span data-stu-id="aff1d-129">The content-indexing client calls the [DllCanUnloadNow Function](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) entry point, through COM, to determine whether it is possible to unload the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  DLL.</span></span> <span data-ttu-id="aff1d-130">L’interface **IFilter** est déchargée une fois qu’elle est inutilisée pendant un intervalle de temps, comme spécifié par la valeur de Registre FilterIdleTimeOut.</span><span class="sxs-lookup"><span data-stu-id="aff1d-130">The **IFilter** interface is unloaded after it is unused for an interval of time, as specified by the FilterIdleTimeOut registry value.</span></span> |

## <a name="implementing-the-ifilter-class-and-class-factory"></a><span data-ttu-id="aff1d-131">Implémentation de la classe IFilter et de la fabrique de classes</span><span class="sxs-lookup"><span data-stu-id="aff1d-131">Implementing the IFilter Class and Class Factory</span></span>

<span data-ttu-id="aff1d-132">Au moins deux classes, telles que CFilter et CFilterCF, sont généralement implémentées par chaque dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="aff1d-132">At least two classes, such as CFilter and CFilterCF, are typically implemented by each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL.</span></span> <span data-ttu-id="aff1d-133">La classe CFilter produit l’objet interface **IFilter** qui implémente la fonctionnalité de filtrage de contenu.</span><span class="sxs-lookup"><span data-stu-id="aff1d-133">The CFilter class produces the **IFilter** interface object that implements the content-filtering functionality.</span></span> <span data-ttu-id="aff1d-134">Ses fonctions membres implémentent les méthodes d’interface de l’interface **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="aff1d-134">Its member functions implement the interface methods of the **IFilter** interface.</span></span> <span data-ttu-id="aff1d-135">Chaque classe **IFilter** requiert un identificateur de classe unique (CLSID), généré par l’implémentation de l’interface **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="aff1d-135">Each **IFilter** class requires a unique class identifier (CLSID), which the **IFilter** interface implementer generates.</span></span>

<span data-ttu-id="aff1d-136">La classe CFilterCF produit l’objet de fabrique de classe pour l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="aff1d-136">The CFilterCF class produces the class-factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="aff1d-137">La fabrique de classes est appelée, via son interface d' [interface IClassFactory](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) , par le point d’entrée de la [fonction DLLGETCLASSOBJECT](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) de la dll.</span><span class="sxs-lookup"><span data-stu-id="aff1d-137">The class factory is called, through its [IClassFactory Interface](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, by the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point of the DLL.</span></span> <span data-ttu-id="aff1d-138">La classe CFilterCF crée l’objet CFilter et retourne un pointeur vers [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="aff1d-138">The CFilterCF class creates the CFilter object and returns a pointer to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="aff1d-139">Dans les cas plus complexes, un **IFilter** peut implémenter une hiérarchie de classes à la place de la classe cfilter unique.</span><span class="sxs-lookup"><span data-stu-id="aff1d-139">In more complex cases, an **IFilter** can implement a class hierarchy in place of the single CFilter class.</span></span>

## <a name="inheriting-the-com-interfaces"></a><span data-ttu-id="aff1d-140">Héritage des interfaces COM</span><span class="sxs-lookup"><span data-stu-id="aff1d-140">Inheriting the COM Interfaces</span></span>

<span data-ttu-id="aff1d-141">Windows Search 3,0 et versions ultérieures requièrent que vous utilisiez [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) pour les raisons suivantes :</span><span class="sxs-lookup"><span data-stu-id="aff1d-141">Windows Search 3.0 and later require that you use [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) for the following reasons:</span></span>

- <span data-ttu-id="aff1d-142">Pour garantir les performances et la compatibilité future.</span><span class="sxs-lookup"><span data-stu-id="aff1d-142">To ensure performance and future compatibility.</span></span>
- <span data-ttu-id="aff1d-143">Pour renforcer la sécurité.</span><span class="sxs-lookup"><span data-stu-id="aff1d-143">To help increase security.</span></span> <span data-ttu-id="aff1d-144">Les IFilters implémentés avec [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) sont plus sécurisées, car le contexte dans lequel l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) s’exécute n’a pas besoin des droits pour ouvrir des fichiers sur le disque ou sur le réseau.</span><span class="sxs-lookup"><span data-stu-id="aff1d-144">IFilters implemented with [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) are more secure because the context in which the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface runs does not need the rights to open files on the disk or over the network.</span></span>
- <span data-ttu-id="aff1d-145">Alors que Windows Search utilise uniquement [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), la classe d’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) peut également hériter de l' [interface IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) et/ou des implémentations de l’interface d’interface [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) pour la compatibilité descendante.</span><span class="sxs-lookup"><span data-stu-id="aff1d-145">While Windows Search uses only [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface class can also inherit the [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) and/or [IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) interface implementations for backward compatibility.</span></span>

<span data-ttu-id="aff1d-146">Ces interfaces sont déclarées dans des fichiers inclus dans le \\ répertoire include Mssdk et ont des identificateurs d’interface prédéfinis (IID).</span><span class="sxs-lookup"><span data-stu-id="aff1d-146">These interfaces are declared in files included from the mssdk\\include directory and have pre-defined interface identifiers (IIDs).</span></span> <span data-ttu-id="aff1d-147">Le client d’indexation du contenu interroge l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) via [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) pour déterminer les interfaces à utiliser lors du filtrage du contenu.</span><span class="sxs-lookup"><span data-stu-id="aff1d-147">The content-indexing client queries the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface through [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) to determine which of these interfaces to use when filtering content.</span></span>

## <a name="implementing-the-com-interface-methods"></a><span data-ttu-id="aff1d-148">Implémentation des méthodes de l’interface COM</span><span class="sxs-lookup"><span data-stu-id="aff1d-148">Implementing the COM Interface Methods</span></span>

<span data-ttu-id="aff1d-149">L’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implémente les méthodes [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) pour la classe d’interface **IFilter** et la fabrique de classe d’interface **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="aff1d-149">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface implements the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) methods for both the **IFilter** interface class and the **IFilter** interface-class factory.</span></span> <span data-ttu-id="aff1d-150">Le tableau suivant répertorie, dans l’ordre vtable, les interfaces et les méthodes spécifiques à l’interface **IFilter** que l’interface **IFilter** doit implémenter.</span><span class="sxs-lookup"><span data-stu-id="aff1d-150">The following table lists, in vtable order, the **IFilter** interface-specific interfaces and methods that the **IFilter** interface should implement.</span></span> <span data-ttu-id="aff1d-151">L’interface **IFilter** doit implémenter au moins [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), mais peut implémenter des interfaces supplémentaires dérivées de IPersist.</span><span class="sxs-lookup"><span data-stu-id="aff1d-151">The **IFilter** interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but can implement additional IPersist-derived interfaces.</span></span>

| <span data-ttu-id="aff1d-152">Interface COM</span><span class="sxs-lookup"><span data-stu-id="aff1d-152">COM interface</span></span>                                                                             | <span data-ttu-id="aff1d-153">Méthode</span><span class="sxs-lookup"><span data-stu-id="aff1d-153">Method</span></span>                                                                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="aff1d-154">IClassFactory, interface</span><span class="sxs-lookup"><span data-stu-id="aff1d-154">IClassFactory Interface</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)   | <span data-ttu-id="aff1d-155">CreateInstance, LockServer,</span><span class="sxs-lookup"><span data-stu-id="aff1d-155">CreateInstance, LockServer</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="aff1d-156">Interface IClassFactory2</span><span class="sxs-lookup"><span data-stu-id="aff1d-156">IClassFactory2 Interface</span></span>](/windows/win32/api/ocidl/nn-ocidl-iclassfactory2)  | <span data-ttu-id="aff1d-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span><span class="sxs-lookup"><span data-stu-id="aff1d-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span></span>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="aff1d-158">**Filtres**</span><span class="sxs-lookup"><span data-stu-id="aff1d-158">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)                                                        | <span data-ttu-id="aff1d-159">[**IFilter :: init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter :: GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter :: gettext**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter :: GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter :: BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span><span class="sxs-lookup"><span data-stu-id="aff1d-159">[**IFilter::Init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter::GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter::BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span></span> |
| [<span data-ttu-id="aff1d-160">Interface IPersist</span><span class="sxs-lookup"><span data-stu-id="aff1d-160">IPersist Interface</span></span>](/windows/desktop/api/objidl/nn-objidl-ipersist)               | <span data-ttu-id="aff1d-161">GetClassID</span><span class="sxs-lookup"><span data-stu-id="aff1d-161">GetClassID</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="aff1d-162">IPersistFile, interface</span><span class="sxs-lookup"><span data-stu-id="aff1d-162">IPersistFile Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersistfile)    | <span data-ttu-id="aff1d-163">IsDirty, Load, Save, SaveCompleted, GetCurFile</span><span class="sxs-lookup"><span data-stu-id="aff1d-163">IsDirty, Load, Save, SaveCompleted, GetCurFile</span></span>                                                                                                                                                                                                                                 |
| [<span data-ttu-id="aff1d-164">IPersistStorage, interface</span><span class="sxs-lookup"><span data-stu-id="aff1d-164">IPersistStorage Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststorage) | <span data-ttu-id="aff1d-165">IsDirty, charger, enregistrer, GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="aff1d-165">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="aff1d-166">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="aff1d-166">IPersistStream</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststream)            | <span data-ttu-id="aff1d-167">IsDirty, charger, enregistrer, GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="aff1d-167">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |

<span data-ttu-id="aff1d-168">La page de référence de chaque méthode spécifie les paramètres et le comportement fonctionnel de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="aff1d-168">The reference page for each method specifies the parameters and functional behavior for that method.</span></span> <span data-ttu-id="aff1d-169">Chaque page de référence donne également les codes de résultat à implémenter pour cette méthode.</span><span class="sxs-lookup"><span data-stu-id="aff1d-169">Each reference page also gives the result codes to implement for that method.</span></span> <span data-ttu-id="aff1d-170">Les pages de référence pour les méthodes [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) fournissent les codes spécifiques à l’interface dans les codes de résultats [ \_ ITF d’installation](../com/codes-in-facility-itf.md) à implémenter, et le client d’indexation du contenu peut également gérer tous les codes de résultat génériques, tels que la valeur null de l’installation \_ et la fonction \_ Win32.</span><span class="sxs-lookup"><span data-stu-id="aff1d-170">The reference pages for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) methods give the interface-specific [Codes in FACILITY\_ITF](../com/codes-in-facility-itf.md) result codes to be implemented, and the content-indexing client can also handle any of the generic result codes, such as FACILITY\_NULL and FACILITY\_WIN32.</span></span> <span data-ttu-id="aff1d-171">Pour plus d’informations, consultez [structure of com Error Codes](../com/structure-of-com-error-codes.md).</span><span class="sxs-lookup"><span data-stu-id="aff1d-171">For more information, see [Structure of COM Error Codes](../com/structure-of-com-error-codes.md).</span></span>

### <a name="com-methods-that-are-not-implemented"></a><span data-ttu-id="aff1d-172">Méthodes COM non implémentées</span><span class="sxs-lookup"><span data-stu-id="aff1d-172">COM Methods that are not Implemented</span></span>

<span data-ttu-id="aff1d-173">L’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) doit implémenter au moins [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), mais elle n’a pas besoin d’implémenter des interfaces dérivées de IPersist supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="aff1d-173">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but does not need to implement additional IPersist-derived interfaces.</span></span>

<span data-ttu-id="aff1d-174">Windows Search n’a pas besoin d’implémenter les méthodes COM listées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="aff1d-174">Windows Search does not need to implement the COM methods listed in the following table.</span></span>

| <span data-ttu-id="aff1d-175">Méthode non requise</span><span class="sxs-lookup"><span data-stu-id="aff1d-175">Method that is not required</span></span>                               | <span data-ttu-id="aff1d-176">Description</span><span class="sxs-lookup"><span data-stu-id="aff1d-176">Description</span></span>                       |
|-----------------------------------------------------------|-----------------------------------|
| <span data-ttu-id="aff1d-177">IPersistStream :: IsDirty</span><span class="sxs-lookup"><span data-stu-id="aff1d-177">IPersistStream::IsDirty</span></span>                                   | <span data-ttu-id="aff1d-178">Les filtres doivent retourner E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="aff1d-178">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="aff1d-179">IPersistStream :: Save</span><span class="sxs-lookup"><span data-stu-id="aff1d-179">IPersistStream::Save</span></span>                                      | <span data-ttu-id="aff1d-180">Les filtres doivent retourner E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="aff1d-180">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="aff1d-181">IPersistStream :: GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="aff1d-181">IPersistStream::GetSizeMax</span></span>                                | <span data-ttu-id="aff1d-182">Les filtres doivent retourner E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="aff1d-182">Filters should return E\_NOTIMPL.</span></span> |
| [<span data-ttu-id="aff1d-183">**IFilter :: BindRegion**</span><span class="sxs-lookup"><span data-stu-id="aff1d-183">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="aff1d-184">Les filtres doivent retourner E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="aff1d-184">Filters should return E\_NOTIMPL.</span></span> |

## <a name="additional-resources"></a><span data-ttu-id="aff1d-185">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="aff1d-185">Additional Resources</span></span>

- <span data-ttu-id="aff1d-186">L’exemple de code [IFilterSample](-search-sample-ifiltersample.md) , disponible sur [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), montre comment créer une classe de base IFilter pour l’implémentation de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="aff1d-186">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="aff1d-187">Pour obtenir une vue d’ensemble du processus d’indexation, consultez [processus d’indexation](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="aff1d-187">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="aff1d-188">Pour obtenir une vue d’ensemble des types de fichiers, consultez [types de fichiers](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="aff1d-188">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="aff1d-189">Pour interroger des attributs d’association de fichiers pour un type de fichier, consultez [PerceivedTypes, SystemFileAssociations et inscription d’application](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="aff1d-189">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="aff1d-190">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="aff1d-190">Related topics</span></span>

[<span data-ttu-id="aff1d-191">Développement de gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="aff1d-191">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="aff1d-192">Fonctionnement des gestionnaires de filtres dans la recherche Windows</span><span class="sxs-lookup"><span data-stu-id="aff1d-192">Understanding Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="aff1d-193">Meilleures pratiques pour la création de gestionnaires de filtres dans Windows Search</span><span class="sxs-lookup"><span data-stu-id="aff1d-193">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="aff1d-194">Retour des propriétés d’un gestionnaire de filtres</span><span class="sxs-lookup"><span data-stu-id="aff1d-194">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="aff1d-195">Gestionnaires de filtres fournis avec Windows</span><span class="sxs-lookup"><span data-stu-id="aff1d-195">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="aff1d-196">Inscription des gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="aff1d-196">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="aff1d-197">Test des gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="aff1d-197">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
