---
description: Les utilisateurs Windows peuvent enregistrer les recherches dans un dossier de recherche généré par un fichier XML qui stocke la requête dans un formulaire qui peut être utilisé par le sous-système de recherche Windows.
ms.assetid: 1c73e220-a999-4243-879c-ac7310151def
title: Format de fichier de recherche enregistré
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d19cf936f78b045814bf7cba31a123c40d61927a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104525497"
---
# <a name="saved-search-file-format"></a><span data-ttu-id="81b18-103">Format de fichier de recherche enregistré</span><span class="sxs-lookup"><span data-stu-id="81b18-103">Saved Search File Format</span></span>

<span data-ttu-id="81b18-104">Dans Windows Vista et les versions ultérieures, les utilisateurs peuvent enregistrer les recherches sous forme de dossier de recherche, qui est généré par un fichier XML qui stocke la requête dans un format qui peut être utilisé par le sous-système de recherche Windows.</span><span class="sxs-lookup"><span data-stu-id="81b18-104">In Windows Vista and later, users can save searches as a Search Folder which is generated by an XML file that stores the query in a form that can be used by the Windows search subsystem.</span></span> <span data-ttu-id="81b18-105">Cette rubrique décrit le format de fichier ( \* . search-ms) et comprend les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="81b18-105">This topic describes the file format (\*.search-ms) and includes the following sections:</span></span>

- [<span data-ttu-id="81b18-106">Vue d’ensemble des recherches enregistrées</span><span class="sxs-lookup"><span data-stu-id="81b18-106">Overview of Saved Searches</span></span>](#overview-of-saved-searches)
- [<span data-ttu-id="81b18-107">\<viewInfo> Appartient</span><span class="sxs-lookup"><span data-stu-id="81b18-107">\<viewInfo> Element</span></span>](/windows)
  - [<span data-ttu-id="81b18-108">\<viewInfo> Attributs</span><span class="sxs-lookup"><span data-stu-id="81b18-108">\<viewInfo> Attributes</span></span>](/windows)
  - [<span data-ttu-id="81b18-109">\<viewInfo> Éléments enfants</span><span class="sxs-lookup"><span data-stu-id="81b18-109">\<viewInfo> Child Elements</span></span>](/windows)
- [<span data-ttu-id="81b18-110">\<query> Appartient</span><span class="sxs-lookup"><span data-stu-id="81b18-110">\<query> Element</span></span>](/windows)
  - [<span data-ttu-id="81b18-111">\<query> Éléments enfants</span><span class="sxs-lookup"><span data-stu-id="81b18-111">\<query> Child Elements</span></span>](/windows)
- [<span data-ttu-id="81b18-112">\<properties> Appartient</span><span class="sxs-lookup"><span data-stu-id="81b18-112">\<properties> Element</span></span>](/windows)
- [<span data-ttu-id="81b18-113">Spécification complète de la recherche-format de fichier MS</span><span class="sxs-lookup"><span data-stu-id="81b18-113">Full Specification of the search-ms File Format</span></span>](#full-specification-of-the-search-ms-file-format)
- [<span data-ttu-id="81b18-114">Exemples de recherches enregistrées</span><span class="sxs-lookup"><span data-stu-id="81b18-114">Examples of Saved Searches</span></span>](#examples-of-saved-searches)

## <a name="overview-of-saved-searches"></a><span data-ttu-id="81b18-115">Vue d’ensemble des recherches enregistrées</span><span class="sxs-lookup"><span data-stu-id="81b18-115">Overview of Saved Searches</span></span>

<span data-ttu-id="81b18-116">Les utilisateurs peuvent enregistrer une requête de recherche en tant que dossier de recherche, un dossier virtuel affiché dans l’Explorateur Windows sous le dossier recherches.</span><span class="sxs-lookup"><span data-stu-id="81b18-116">Users can save a search query as a Search Folder, a virtual folder displayed in Windows Explorer under the Searches folder.</span></span> <span data-ttu-id="81b18-117">L’ouverture d’un dossier de recherche exécute la recherche enregistrée et affiche les résultats mis à jour.</span><span class="sxs-lookup"><span data-stu-id="81b18-117">Opening a Search Folder runs the saved search and displays up-to-date results.</span></span> <span data-ttu-id="81b18-118">Le fichier de recherche enregistré stocke la requête dans un format dans lequel Windows Search peut agir, en spécifiant les éléments à rechercher, l’emplacement de la recherche et la manière de présenter les résultats.</span><span class="sxs-lookup"><span data-stu-id="81b18-118">The saved search file stores the query in a format Windows Search can act on, specifying what to search for, where to search, and how to present the results.</span></span>

<span data-ttu-id="81b18-119">La recherche enregistrée est générée à partir d’un fichier XML ( \* . search-ms) dans le dossier% UserProfile% \\ Searches.</span><span class="sxs-lookup"><span data-stu-id="81b18-119">The saved search is generated from an XML file (\*.search-ms) in the %userprofile%\\Searches folder.</span></span> <span data-ttu-id="81b18-120">Les données sont divisées en trois éléments principaux dans le fichier XML :</span><span class="sxs-lookup"><span data-stu-id="81b18-120">The data is divided into three primary elements in the XML file:</span></span>

- <span data-ttu-id="81b18-121">\<viewInfo> spécifie les informations de présentation</span><span class="sxs-lookup"><span data-stu-id="81b18-121">\<viewInfo> specifies presentation information</span></span>
- <span data-ttu-id="81b18-122">\<query> spécifie (Rechercher les informations de requête</span><span class="sxs-lookup"><span data-stu-id="81b18-122">\<query> specifies (search query information</span></span>
- <span data-ttu-id="81b18-123">\<properties> spécifie les propriétés du \* fichier. search-ms lui-même</span><span class="sxs-lookup"><span data-stu-id="81b18-123">\<properties> specifies properties of the \*.search-ms file itself</span></span>

<span data-ttu-id="81b18-124">L’exemple suivant illustre la structure de haut niveau d’un fichier de recherche enregistré.</span><span class="sxs-lookup"><span data-stu-id="81b18-124">The following example shows the high-level structure of a saved search file.</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">

    <viewInfo ...>
        ...
    </viewInfo>

    <query>
        ...
    </query>

    <properties>
        ...
    </properties>

</persistedQuery>
```

## <a name="viewinfo-element"></a><span data-ttu-id="81b18-125">Élément \<viewInfo></span><span class="sxs-lookup"><span data-stu-id="81b18-125">\<viewInfo> Element</span></span>

<span data-ttu-id="81b18-126">L' \<viewInfo> élément spécifie la façon dont les résultats sont présentés à l’utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="81b18-126">The \<viewInfo> element specifies how the results are presented to the end user.</span></span> <span data-ttu-id="81b18-127">L’exemple suivant illustre la structure de l’élément.</span><span class="sxs-lookup"><span data-stu-id="81b18-127">The following example shows the structure of the element.</span></span>

```XML
...
    <viewInfo viewMode=""
              iconSize=""
              stackIconSize=""
              autoListFlags=""
              folderFlags=""
              taskFlags=""
              displayName="">

        <visibleColumns>
            <column viewField=""/>
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/>
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>
        </columnChooserColumns >

        <groupBy viewField=""
                 direction=""/>

        <stackList>
            <stack viewField=""/>
        </stackList>

        <sortList>
            <sort viewField=""
                  direction=""/>
        </sortList>
    </viewInfo>
...
```

### <a name="viewinfo-attributes"></a><span data-ttu-id="81b18-128">\<viewInfo> Attributs</span><span class="sxs-lookup"><span data-stu-id="81b18-128">\<viewInfo> Attributes</span></span>

<span data-ttu-id="81b18-129">Le tableau suivant décrit les attributs d’un de l’élément \<viewInfo>.</span><span class="sxs-lookup"><span data-stu-id="81b18-129">The following table describes the attributes of the \<viewInfo> element.</span></span>

| <span data-ttu-id="81b18-130">Attribut</span><span class="sxs-lookup"><span data-stu-id="81b18-130">Attribute</span></span>     | <span data-ttu-id="81b18-131">Description</span><span class="sxs-lookup"><span data-stu-id="81b18-131">Description</span></span>                                                                     | <span data-ttu-id="81b18-132">Valeurs</span><span class="sxs-lookup"><span data-stu-id="81b18-132">Values</span></span>                     |
|---------------|---------------------------------------------------------------------------------|----------------------------|
| <span data-ttu-id="81b18-133">viewMode</span><span class="sxs-lookup"><span data-stu-id="81b18-133">viewMode</span></span>      | <span data-ttu-id="81b18-134">Spécifie l’affichage des dossiers.</span><span class="sxs-lookup"><span data-stu-id="81b18-134">Specifies the folder view.</span></span>                                                      | <span data-ttu-id="81b18-135">\|Vignettes des icônes de détails \|</span><span class="sxs-lookup"><span data-stu-id="81b18-135">Details \| Icons \| Tiles</span></span>  |
| <span data-ttu-id="81b18-136">iconSize</span><span class="sxs-lookup"><span data-stu-id="81b18-136">iconSize</span></span>      | <span data-ttu-id="81b18-137">Contrôle la taille par défaut des icônes et des miniatures des éléments en l’absence de pile.</span><span class="sxs-lookup"><span data-stu-id="81b18-137">Controls the default size of the icons and thumbnails for items when not stack.</span></span> | <span data-ttu-id="81b18-138">Entier compris entre 16 et 256</span><span class="sxs-lookup"><span data-stu-id="81b18-138">Integer between 16 and 256</span></span> |
| <span data-ttu-id="81b18-139">stackIconSize</span><span class="sxs-lookup"><span data-stu-id="81b18-139">stackIconSize</span></span> | <span data-ttu-id="81b18-140">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-140">For internal use only.</span></span> <span data-ttu-id="81b18-141">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-141">Do not use.</span></span>                                              | <span data-ttu-id="81b18-142">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-142">n/a</span></span>                        |
| <span data-ttu-id="81b18-143">displayName</span><span class="sxs-lookup"><span data-stu-id="81b18-143">displayName</span></span>   | <span data-ttu-id="81b18-144">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-144">For internal use only.</span></span> <span data-ttu-id="81b18-145">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-145">Do not use.</span></span>                                              | <span data-ttu-id="81b18-146">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-146">n/a</span></span>                        |
| <span data-ttu-id="81b18-147">autoListFlags</span><span class="sxs-lookup"><span data-stu-id="81b18-147">autoListFlags</span></span> | <span data-ttu-id="81b18-148">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-148">For internal use only.</span></span> <span data-ttu-id="81b18-149">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-149">Do not use.</span></span>                                              | <span data-ttu-id="81b18-150">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-150">n/a</span></span>                        |
| <span data-ttu-id="81b18-151">folderFlags</span><span class="sxs-lookup"><span data-stu-id="81b18-151">folderFlags</span></span>   | <span data-ttu-id="81b18-152">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-152">For internal use only.</span></span> <span data-ttu-id="81b18-153">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-153">Do not use.</span></span>                                              | <span data-ttu-id="81b18-154">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-154">n/a</span></span>                        |
| <span data-ttu-id="81b18-155">taskFlags</span><span class="sxs-lookup"><span data-stu-id="81b18-155">taskFlags</span></span>     | <span data-ttu-id="81b18-156">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-156">For internal use only.</span></span> <span data-ttu-id="81b18-157">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-157">Do not use.</span></span>                                              | <span data-ttu-id="81b18-158">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-158">n/a</span></span>                        |

### <a name="viewinfo-child-elements"></a><span data-ttu-id="81b18-159">\<viewInfo> Éléments enfants</span><span class="sxs-lookup"><span data-stu-id="81b18-159">\<viewInfo> Child Elements</span></span>

<span data-ttu-id="81b18-160">Les éléments enfants de l' \<viewInfo> élément spécifient les colonnes qui s’affichent dans les résultats de recherche de l’Explorateur Windows et la façon dont les résultats sont regroupés et triés.</span><span class="sxs-lookup"><span data-stu-id="81b18-160">The child elements of the \<viewInfo> element specify which columns appear in the Windows Explorer search results and how the results are grouped and sorted.</span></span> <span data-ttu-id="81b18-161">Chaque élément enfant contient un ensemble ordonné de colonnes, identifiées par des noms canoniques de propriétés système (par exemple, System. DisplayName).</span><span class="sxs-lookup"><span data-stu-id="81b18-161">Each child element contains an ordered set of columns, identified by canonical names of system properties (for example, System.DisplayName).</span></span> <span data-ttu-id="81b18-162">S’ils ne sont pas définis dans le fichier de recherche enregistré, les résultats de la recherche sont présentés avec un ensemble de colonnes par défaut approprié pour les types de fichiers affichés.</span><span class="sxs-lookup"><span data-stu-id="81b18-162">If not defined in the saved search file, the search results are presented with a default set of columns appropriate for the file types displayed.</span></span>

| <span data-ttu-id="81b18-163">Élément</span><span class="sxs-lookup"><span data-stu-id="81b18-163">Element</span></span>               | <span data-ttu-id="81b18-164">Description</span><span class="sxs-lookup"><span data-stu-id="81b18-164">Description</span></span>                                                                                        | <span data-ttu-id="81b18-165">Valeurs</span><span class="sxs-lookup"><span data-stu-id="81b18-165">Values</span></span>                                                       |
|-----------------------|----------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| <span data-ttu-id="81b18-166">visibleColumns</span><span class="sxs-lookup"><span data-stu-id="81b18-166">visibleColumns</span></span>        | <span data-ttu-id="81b18-167">Spécifie une liste triée de colonnes à afficher dans la vue résultats.</span><span class="sxs-lookup"><span data-stu-id="81b18-167">Specifies an ordered list of columns to appear in the results view.</span></span> <span data-ttu-id="81b18-168">L’utilisateur peut modifier cette liste.</span><span class="sxs-lookup"><span data-stu-id="81b18-168">The user can change this list.</span></span> | <span data-ttu-id="81b18-169">Toute propriété système.</span><span class="sxs-lookup"><span data-stu-id="81b18-169">Any system property.</span></span>                                         |
| <span data-ttu-id="81b18-170">frequentlyUsedColumns</span><span class="sxs-lookup"><span data-stu-id="81b18-170">frequentlyUsedColumns</span></span> | <span data-ttu-id="81b18-171">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-171">For internal use only.</span></span> <span data-ttu-id="81b18-172">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-172">Do not use.</span></span>                                                                 | <span data-ttu-id="81b18-173">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-173">n/a</span></span>                                                          |
| <span data-ttu-id="81b18-174">columnChooserColumns</span><span class="sxs-lookup"><span data-stu-id="81b18-174">columnChooserColumns</span></span>  | <span data-ttu-id="81b18-175">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-175">For internal use only.</span></span> <span data-ttu-id="81b18-176">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-176">Do not use.</span></span>                                                                 | <span data-ttu-id="81b18-177">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-177">n/a</span></span>                                                          |
| <span data-ttu-id="81b18-178">Comportant</span><span class="sxs-lookup"><span data-stu-id="81b18-178">groupBy</span></span>               | <span data-ttu-id="81b18-179">Spécifie une propriété système unique par laquelle grouper les résultats.</span><span class="sxs-lookup"><span data-stu-id="81b18-179">Specifies a single system property by which to group the results.</span></span> <span data-ttu-id="81b18-180">L’utilisateur peut modifier cette valeur.</span><span class="sxs-lookup"><span data-stu-id="81b18-180">The user can change this value.</span></span>  | <span data-ttu-id="81b18-181">Toute propriété système.</span><span class="sxs-lookup"><span data-stu-id="81b18-181">Any system property.</span></span>                                         |
| <span data-ttu-id="81b18-182">sortList</span><span class="sxs-lookup"><span data-stu-id="81b18-182">sortList</span></span>              | <span data-ttu-id="81b18-183">Spécifie une liste triée des colonnes par lesquelles trier les résultats.</span><span class="sxs-lookup"><span data-stu-id="81b18-183">Specifies an ordered list of columns to sort the results by.</span></span>                                       | <span data-ttu-id="81b18-184">Jusqu’à quatre propriétés système.</span><span class="sxs-lookup"><span data-stu-id="81b18-184">Up to four system properties.</span></span> <span data-ttu-id="81b18-185">L’utilisateur peut modifier cette liste.</span><span class="sxs-lookup"><span data-stu-id="81b18-185">The user can change this list.</span></span> |
| <span data-ttu-id="81b18-186">stackList</span><span class="sxs-lookup"><span data-stu-id="81b18-186">stackList</span></span>             | <span data-ttu-id="81b18-187">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-187">For internal use only.</span></span> <span data-ttu-id="81b18-188">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-188">Do not use.</span></span>                                                                 | <span data-ttu-id="81b18-189">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-189">n/a</span></span>                                                          |

## <a name="query-element"></a><span data-ttu-id="81b18-190">Élément \<query></span><span class="sxs-lookup"><span data-stu-id="81b18-190">\<query> Element</span></span>

<span data-ttu-id="81b18-191">L' \<query> élément spécifie les attributs qui définissent la façon dont les résultats sont interrogés.</span><span class="sxs-lookup"><span data-stu-id="81b18-191">The \<query> element specifies the attributes which define how the results are queried.</span></span> <span data-ttu-id="81b18-192">L’exemple suivant illustre la structure de l’élément.</span><span class="sxs-lookup"><span data-stu-id="81b18-192">The following example shows the structure of the element.</span></span>

```XML
...
    <query>
        <providers>
            <provider clsid=""/>    <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

### <a name="query-child-elements"></a><span data-ttu-id="81b18-193">\<query> Éléments enfants</span><span class="sxs-lookup"><span data-stu-id="81b18-193">\<query> Child Elements</span></span>

<span data-ttu-id="81b18-194">La table suivante décrit les éléments enfants de l’élément \<scope>.</span><span class="sxs-lookup"><span data-stu-id="81b18-194">The following table describes the child elements of the \<scope> element.</span></span>

| <span data-ttu-id="81b18-195">Élément</span><span class="sxs-lookup"><span data-stu-id="81b18-195">Element</span></span>    | <span data-ttu-id="81b18-196">Description</span><span class="sxs-lookup"><span data-stu-id="81b18-196">Description</span></span>                                                                                                               | <span data-ttu-id="81b18-197">Valeur</span><span class="sxs-lookup"><span data-stu-id="81b18-197">Value</span></span>                                                                                                                                                                                                                                                          |
|------------|---------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="81b18-198">fournisseurs</span><span class="sxs-lookup"><span data-stu-id="81b18-198">providers</span></span>  | <span data-ttu-id="81b18-199">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-199">For internal use only.</span></span> <span data-ttu-id="81b18-200">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-200">Do not use.</span></span>                                                                                        | <span data-ttu-id="81b18-201">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-201">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="81b18-202">Sous-requêtes</span><span class="sxs-lookup"><span data-stu-id="81b18-202">subQueries</span></span> | <span data-ttu-id="81b18-203">À usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-203">For internal use only.</span></span> <span data-ttu-id="81b18-204">Ne pas utiliser.</span><span class="sxs-lookup"><span data-stu-id="81b18-204">Do not use.</span></span>                                                                                        | <span data-ttu-id="81b18-205">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-205">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="81b18-206">Étendue</span><span class="sxs-lookup"><span data-stu-id="81b18-206">Scope</span></span>      | <span data-ttu-id="81b18-207">Identifie les emplacements à inclure ou exclure dans la recherche.</span><span class="sxs-lookup"><span data-stu-id="81b18-207">Identifies locations to include or exclude in the search.</span></span>                                                                 | <span data-ttu-id="81b18-208">Un chemin d’accès ou un [ID de dossier connu](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) de l’emplacement à inclure ou à exclure.</span><span class="sxs-lookup"><span data-stu-id="81b18-208">Either a path or a [known folder ID](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) of the location to be included or excluded.</span></span> <span data-ttu-id="81b18-209">Cet élément peut également spécifier si la recherche doit inclure ou exclure des chemins enfants (une recherche superficielle ou profonde).</span><span class="sxs-lookup"><span data-stu-id="81b18-209">This element can also specify whether the search should include/exclude child paths (a shallow or deep search).</span></span> |
| <span data-ttu-id="81b18-210">kindList</span><span class="sxs-lookup"><span data-stu-id="81b18-210">kindList</span></span>   | <span data-ttu-id="81b18-211">Identifie le type de fichier (s) à rechercher.</span><span class="sxs-lookup"><span data-stu-id="81b18-211">Identifies the kind of file(s) to search for.</span></span>                                                                             | <span data-ttu-id="81b18-212">Toute valeur System. Kind.</span><span class="sxs-lookup"><span data-stu-id="81b18-212">Any System.Kind value.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="81b18-213">conditions</span><span class="sxs-lookup"><span data-stu-id="81b18-213">conditions</span></span> | <span data-ttu-id="81b18-214">Spécifie les règles de filtrage des résultats.</span><span class="sxs-lookup"><span data-stu-id="81b18-214">Specifies rules for filtering results.</span></span> <span data-ttu-id="81b18-215">Par exemple, les résultats peuvent être limités aux e-mails envoyés par ou à une personne particulière.</span><span class="sxs-lookup"><span data-stu-id="81b18-215">For example, results could be limited to emails sent by or to a particular person.</span></span> | <span data-ttu-id="81b18-216">andCondition, orCondition, notCondition, leafCondition.</span><span class="sxs-lookup"><span data-stu-id="81b18-216">andCondition, orCondition, notCondition, leafCondition.</span></span>                                                                                                                                                                                                        |

### <a name="scope-element"></a><span data-ttu-id="81b18-217">Élément \<scope></span><span class="sxs-lookup"><span data-stu-id="81b18-217">\<scope> Element</span></span>

<span data-ttu-id="81b18-218">L' \<scope> élément identifie les emplacements à inclure ou à exclure de la recherche.</span><span class="sxs-lookup"><span data-stu-id="81b18-218">The \<scope> element identifies the locations to include or exclude from the search.</span></span> <span data-ttu-id="81b18-219">L' \<scope> élément doit contenir au moins un \<include> élément enfant présent et zéro, un ou plusieurs \<exclude> éléments.</span><span class="sxs-lookup"><span data-stu-id="81b18-219">The \<scope> element must contain at least one \<include> child element present and zero or more \<exclude> elements.</span></span> <span data-ttu-id="81b18-220">Les emplacements peuvent être spécifiés en tant que chemin d’accès (les variables d’environnement sont prises en charge) ou en tant qu' [identificateur de dossier connu](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span><span class="sxs-lookup"><span data-stu-id="81b18-220">The locations can be specified as either a path (environment variables are supported) or as a [known folder identifier](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span></span> <span data-ttu-id="81b18-221">En outre, chacun de ces emplacements peut être spécifié pour être recherché en profondeur ou superficielle en affectant à la valeur « true » ou « false » (valeur par défaut).</span><span class="sxs-lookup"><span data-stu-id="81b18-221">Furthermore, each of these locations can be specified to be searched deep or shallow by setting the nonRecursive to "true" or "false" (default is recursive).</span></span> <span data-ttu-id="81b18-222">Les parties de la liste d’emplacements incluse peuvent être exclues en spécifiant des éléments d’exclusion.</span><span class="sxs-lookup"><span data-stu-id="81b18-222">Parts of the included list of locations can be excluded by specifying exclude elements.</span></span>

<span data-ttu-id="81b18-223">L’exemple suivant montre un \<scope> élément qui recherche le dossier spécial documents, mais pas ses enfants, le volume « e : » et ses enfants, mais pas le répertoire « e : \\ Windows » ou l’un de ses enfants :</span><span class="sxs-lookup"><span data-stu-id="81b18-223">The following shows a \<scope> element that will search the documents special folder, but not its children, the "E:" volume and its children, but not "E:\\windows" directory or any of its children:</span></span>

```XML
...
    <query>
        ...
        <scope>
            <include knownFolder="{FDD39AD0-238F-46AF-ADB4-6C85480369C7}" nonRecursive="true"/>
            <include path="E:\"/>
            <exclude path="E:\Windows" nonRecursive="false"/>
        </scope>
        ...
    </query>
...
```

### <a name="kindlist-element"></a><span data-ttu-id="81b18-224">Élément \<kindList></span><span class="sxs-lookup"><span data-stu-id="81b18-224">\<kindList> Element</span></span>

<span data-ttu-id="81b18-225">Ces éléments définissent l’Union du « genre » d’éléments qui doivent apparaître dans la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="81b18-225">These elements define the union of the "kind" of items that should appear in the library.</span></span> <span data-ttu-id="81b18-226">Les valeurs valides sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="81b18-226">The valid values are:</span></span>

- <span data-ttu-id="81b18-227">calendrier</span><span class="sxs-lookup"><span data-stu-id="81b18-227">calendar</span></span>
- <span data-ttu-id="81b18-228">communication</span><span class="sxs-lookup"><span data-stu-id="81b18-228">communication</span></span>
- <span data-ttu-id="81b18-229">contact</span><span class="sxs-lookup"><span data-stu-id="81b18-229">contact</span></span>
- <span data-ttu-id="81b18-230">document</span><span class="sxs-lookup"><span data-stu-id="81b18-230">document</span></span>
- <span data-ttu-id="81b18-231">email</span><span class="sxs-lookup"><span data-stu-id="81b18-231">email</span></span>
- <span data-ttu-id="81b18-232">feed</span><span class="sxs-lookup"><span data-stu-id="81b18-232">feed</span></span>
- <span data-ttu-id="81b18-233">dossier</span><span class="sxs-lookup"><span data-stu-id="81b18-233">folder</span></span>
- <span data-ttu-id="81b18-234">SideWinder</span><span class="sxs-lookup"><span data-stu-id="81b18-234">game</span></span>
- <span data-ttu-id="81b18-235">instantmessage</span><span class="sxs-lookup"><span data-stu-id="81b18-235">instantmessage</span></span>
- <span data-ttu-id="81b18-236">journaux</span><span class="sxs-lookup"><span data-stu-id="81b18-236">journal</span></span>
- <span data-ttu-id="81b18-237">link</span><span class="sxs-lookup"><span data-stu-id="81b18-237">link</span></span>
- <span data-ttu-id="81b18-238">film</span><span class="sxs-lookup"><span data-stu-id="81b18-238">movie</span></span>
- <span data-ttu-id="81b18-239">music</span><span class="sxs-lookup"><span data-stu-id="81b18-239">music</span></span>
- <span data-ttu-id="81b18-240">remarque</span><span class="sxs-lookup"><span data-stu-id="81b18-240">note</span></span>
- <span data-ttu-id="81b18-241">picture</span><span class="sxs-lookup"><span data-stu-id="81b18-241">picture</span></span>
- <span data-ttu-id="81b18-242">programme</span><span class="sxs-lookup"><span data-stu-id="81b18-242">program</span></span>
- <span data-ttu-id="81b18-243">recordedtv</span><span class="sxs-lookup"><span data-stu-id="81b18-243">recordedtv</span></span>
- <span data-ttu-id="81b18-244">SearchFolder</span><span class="sxs-lookup"><span data-stu-id="81b18-244">searchfolder</span></span>
- <span data-ttu-id="81b18-245">tâche</span><span class="sxs-lookup"><span data-stu-id="81b18-245">task</span></span>
- <span data-ttu-id="81b18-246">video</span><span class="sxs-lookup"><span data-stu-id="81b18-246">video</span></span>
- <span data-ttu-id="81b18-247">webhistory</span><span class="sxs-lookup"><span data-stu-id="81b18-247">webhistory</span></span>
- <span data-ttu-id="81b18-248">item</span><span class="sxs-lookup"><span data-stu-id="81b18-248">item</span></span>
- <span data-ttu-id="81b18-249">autre</span><span class="sxs-lookup"><span data-stu-id="81b18-249">other</span></span>

### <a name="conditions-element"></a><span data-ttu-id="81b18-250">Élément \<conditions></span><span class="sxs-lookup"><span data-stu-id="81b18-250">\<conditions> Element</span></span>

<span data-ttu-id="81b18-251">Les conditions sont des filtres par rapport auxquels les résultats de recherche sont comparés.</span><span class="sxs-lookup"><span data-stu-id="81b18-251">Conditions are filters against which search results are compared.</span></span> <span data-ttu-id="81b18-252">Par exemple, vous pouvez filtrer les résultats qui répondent à certains critères, tels que le nom de l’auteur ou la taille du fichier.</span><span class="sxs-lookup"><span data-stu-id="81b18-252">For example, you can filter results that meet certain criteria, like author name or file size.</span></span> <span data-ttu-id="81b18-253">L’ensemble de conditions est intégré à une arborescence de condition unique avec des branches logiques AND, OR et NOT.</span><span class="sxs-lookup"><span data-stu-id="81b18-253">The set of conditions are built into a single condition tree with logical AND, OR and NOT branches.</span></span>

<span data-ttu-id="81b18-254">L’exemple suivant illustre la structure de l' \<condition> élément.</span><span class="sxs-lookup"><span data-stu-id="81b18-254">The following example shows the structure of the \<condition> element.</span></span>

```XML
...
    <query>
        ...
        <conditions>
            <condition type="" ...>
                <attributes>
                    <attribute attributeID="" .../>
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

<span data-ttu-id="81b18-255">Le type de condition peut être l’un des suivants :</span><span class="sxs-lookup"><span data-stu-id="81b18-255">The condition type can be one of the following:</span></span>

| <span data-ttu-id="81b18-256">Type</span><span class="sxs-lookup"><span data-stu-id="81b18-256">Type</span></span>          | <span data-ttu-id="81b18-257">Description</span><span class="sxs-lookup"><span data-stu-id="81b18-257">Description</span></span>                                 | <span data-ttu-id="81b18-258">Attributs disponibles</span><span class="sxs-lookup"><span data-stu-id="81b18-258">Available Attributes</span></span>                               |
|---------------|---------------------------------------------|----------------------------------------------------|
| <span data-ttu-id="81b18-259">andCondition</span><span class="sxs-lookup"><span data-stu-id="81b18-259">andCondition</span></span>  | <span data-ttu-id="81b18-260">Combinaison de deux ou plusieurs conditions enfants</span><span class="sxs-lookup"><span data-stu-id="81b18-260">Conjunction of two or more child conditions</span></span> | <span data-ttu-id="81b18-261">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-261">n/a</span></span>                                                |
| <span data-ttu-id="81b18-262">orCondition</span><span class="sxs-lookup"><span data-stu-id="81b18-262">orCondition</span></span>   | <span data-ttu-id="81b18-263">Disjonction de deux autres conditions enfants</span><span class="sxs-lookup"><span data-stu-id="81b18-263">Disjunction of two of more child conditions</span></span> | <span data-ttu-id="81b18-264">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-264">n/a</span></span>                                                |
| <span data-ttu-id="81b18-265">notCondition</span><span class="sxs-lookup"><span data-stu-id="81b18-265">notCondition</span></span>  | <span data-ttu-id="81b18-266">Négation d’une condition enfant</span><span class="sxs-lookup"><span data-stu-id="81b18-266">Negation of a child condition</span></span>               | <span data-ttu-id="81b18-267">n/a</span><span class="sxs-lookup"><span data-stu-id="81b18-267">n/a</span></span>                                                |
| <span data-ttu-id="81b18-268">leafCondition</span><span class="sxs-lookup"><span data-stu-id="81b18-268">leafCondition</span></span> | <span data-ttu-id="81b18-269">Compare une propriété à la valeur</span><span class="sxs-lookup"><span data-stu-id="81b18-269">Compares a property to value</span></span>                | <span data-ttu-id="81b18-270">Property, propertyType, Operator, value, ValueType</span><span class="sxs-lookup"><span data-stu-id="81b18-270">property, propertyType, operator, value, valuetype</span></span> |

<span data-ttu-id="81b18-271">Les \<leafCondition> attributs de l’élément identifient les propriétés et les valeurs par rapport auxquelles les résultats sont filtrés.</span><span class="sxs-lookup"><span data-stu-id="81b18-271">The \<leafCondition> element's attributes identify the properties and values the results are filtered against.</span></span>

### <a name="example-conditions-element"></a><span data-ttu-id="81b18-272">Exemple : \<conditions> élément</span><span class="sxs-lookup"><span data-stu-id="81b18-272">Example: \<conditions> Element</span></span>

<span data-ttu-id="81b18-273">L’exemple suivant filtre les résultats pour tous les éléments non lus créés par John.</span><span class="sxs-lookup"><span data-stu-id="81b18-273">The following example filters results for all unread items authored by John.</span></span> <span data-ttu-id="81b18-274">Autrement dit, la propriété System. IsRead a la valeur false et la chaîne « John » apparaît dans les propriétés System. Author ou System. ItemAuthors.</span><span class="sxs-lookup"><span data-stu-id="81b18-274">That is, the System.IsRead property is false and the string "john" appears in the System.Author or System.ItemAuthors properties.</span></span>

```XML
...
    <query>
        ...
        <conditions>

            <condition type="andCondition">

                <condition type="leafCondition"
                           property="System.IsRead"
                           operator="eq"
                           value="FALSE"/>

                <condition type="orCondition">

                    <condition type="leafCondition"
                               property="System.Author"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                    <condition type="leafCondition"
                               property="System.ItemAuthors"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                </condition>

            </condition>

        </conditions>

    </query>
...
```

## <a name="properties-element"></a><span data-ttu-id="81b18-275">Élément \<properties></span><span class="sxs-lookup"><span data-stu-id="81b18-275">\<properties> Element</span></span>

<span data-ttu-id="81b18-276">L' \<properties> élément décrit les propriétés de la recherche enregistrée elle-même.</span><span class="sxs-lookup"><span data-stu-id="81b18-276">The \<properties> element describes the properties of the saved search itself.</span></span> <span data-ttu-id="81b18-277">Les fichiers de recherche enregistrés prennent en charge quatre propriétés : \<author> ,, \<kind> \<description> et \<tags> .</span><span class="sxs-lookup"><span data-stu-id="81b18-277">Saved search files support four properties: \<author>, \<kind>, \<description>, and \<tags>.</span></span> <span data-ttu-id="81b18-278">Ils sont destinés à un usage interne uniquement.</span><span class="sxs-lookup"><span data-stu-id="81b18-278">These are for internal use only.</span></span>

## <a name="full-specification-of-the-search-ms-file-format"></a><span data-ttu-id="81b18-279">Spécification complète de la recherche-format de fichier MS</span><span class="sxs-lookup"><span data-stu-id="81b18-279">Full Specification of the search-ms File Format</span></span>

<span data-ttu-id="81b18-280">Voici un exemple de code XML complet pour un fichier de recherche enregistré.</span><span class="sxs-lookup"><span data-stu-id="81b18-280">The following is an example of the full XML for a saved search file.</span></span>

```XML
<?xml version="1.0"?>

<persistedQuery version="1.0">

    <!-- The viewInfo section defines how results are displayed to the end user -->
    <viewInfo viewMode=""       <!-- details | icons | tiles -->
              iconSize=""       <!-- Integer -->
              stackIconSize=""  <!-- Do not use -->
              displayName=""    <!-- Do not use -->
              folderFlags=""    <!-- Do not use -->
              taskFlags=""      <!-- Do not use -->
              autoListFlags=""> <!-- Do not use -->

        <visibleColumns>
            <column viewField=""/>  <!-- System.[propertyname] -->
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/> <!-- Do not use -->
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>  <!-- Do not use -->
        </columnChooserColumns >

        <groupBy viewField=""       <!-- System.[propertyname] -->
                 direction=""/>     <!-- ascending | descending -->

        <stackList>
            <stack viewField=""/>   <!-- Do not use -->
        </stackList>

        <sortList>
            <sort viewField=""      <!-- System.[propertyname] -->
                  direction=""/>    <!-- ascending | descending -->
        </sortList>
    </viewInfo>

    <!-- The query section defines what gets searched (locations, file kinds) -->
    <query>
        <providers>
            <provider clsid=""/>          <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>

    <!-- The properties section identifies properties of the saved search file itself. -->
    <properties>
        ...             <!-- Do not use -->
    </properties>

</persistedQuery>
```

## <a name="examples-of-saved-searches"></a><span data-ttu-id="81b18-281">Exemples de recherches enregistrées</span><span class="sxs-lookup"><span data-stu-id="81b18-281">Examples of Saved Searches</span></span>

<span data-ttu-id="81b18-282">Voici des exemples de \* fichiers. search-ms.</span><span class="sxs-lookup"><span data-stu-id="81b18-282">The following are examples of \*.search-ms files.</span></span>

### <a name="recent-documentssearch-ms"></a><span data-ttu-id="81b18-283">Documents récents. search-ms</span><span class="sxs-lookup"><span data-stu-id="81b18-283">Recent Documents.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUZZXD-30NU" propertyType="wstr" />
        </conditions>
        <kindList>
            <kind name="Document"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recent-musicsearch-ms"></a><span data-ttu-id="81b18-284">Musique récente. search-ms</span><span class="sxs-lookup"><span data-stu-id="81b18-284">Recent Music.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUW-1WNNU" propertyType="wstr"/>
        </conditions>
        <kindList>
            <kind name="Music"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recently-shared-by-mesearch-ms"></a><span data-ttu-id="81b18-285">Récemment partagés par moi. search-ms</span><span class="sxs-lookup"><span data-stu-id="81b18-285">Recently Shared by Me.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <visibleColumns>
            <column viewField="System.ItemNameDisplay"/>
            <column viewField="System.DateModified"/>
            <column viewField="System.Keywords"/>
            <column viewField="System.SharedWith"/>
            <column viewField="System.ItemFolderPathDisplayNarrow"/>
        </visibleColumns>
        <frequentlyUsedColumns>
            <column viewField="System.Author"/>
            <column viewField="System.Kind"/>
            <column viewField="System.Size"/>
            <column viewField="System.Title"/>
            <column viewField="System.Rating"/>
        </frequentlyUsedColumns>
        <sortList>
            <sort viewField="System.SharedWith" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="andCondition">
                <condition type="leafCondition" property="System.IsShared" operator="eq" value="true"/>
                <condition type="leafCondition" property="System.FileOwner" operator="eq" value="[Me]"/>
            </condition>
        </conditions>
        <kindList>
            <kind name="item"/>
        </kindList>
        <scope>
            <include knownFolder="{5E6C858F-0E22-4760-9AFE-EA3317B67173}"/>
            <include knownFolder="{DFDF76A2-C82A-4D63-906A-5644AC457385}"/>
        </scope>
    </query>
</persistedQuery>
```
