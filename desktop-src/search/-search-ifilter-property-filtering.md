---
description: Les propriétés sont extraites d’éléments à l’aide de gestionnaires de propriétés inscrits ou à l’aide de filtres inscrits pour des types de fichiers spécifiques. Un gestionnaire de filtres (implémentation de l’interface IFilter) peut interpréter le contenu d’un type de fichier de plusieurs façons.
ms.assetid: 6701d151-c36f-43e5-929b-9831c5ce5823
title: Retour des propriétés d’un gestionnaire de filtres
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4df0bfc811176e9b0672dbcbe4ef4f04f3c3a6f2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106514156"
---
# <a name="returning-properties-from-a-filter-handler"></a><span data-ttu-id="58cc9-104">Retour des propriétés d’un gestionnaire de filtres</span><span class="sxs-lookup"><span data-stu-id="58cc9-104">Returning Properties from a Filter Handler</span></span>

<span data-ttu-id="58cc9-105">Les propriétés sont extraites d’éléments à l’aide de gestionnaires de propriétés inscrits ou à l’aide de filtres inscrits pour des types de fichiers spécifiques.</span><span class="sxs-lookup"><span data-stu-id="58cc9-105">Properties are extracted from items using registered property handlers, or using filters registered for specific file types.</span></span> <span data-ttu-id="58cc9-106">Un gestionnaire de filtres (implémentation de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) peut interpréter le contenu d’un type de fichier de plusieurs façons.</span><span class="sxs-lookup"><span data-stu-id="58cc9-106">A filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface) can interpret the contents of a file type in any number of ways.</span></span>

<span data-ttu-id="58cc9-107">Cette rubrique est organisée comme suit :</span><span class="sxs-lookup"><span data-stu-id="58cc9-107">This topic is organized as follows:</span></span>

- [<span data-ttu-id="58cc9-108">Filtrage des propriétés</span><span class="sxs-lookup"><span data-stu-id="58cc9-108">Property Filtering</span></span>](#returning-properties-from-a-filter-handler)
  - [<span data-ttu-id="58cc9-109">Limitations de la taille des propriétés</span><span class="sxs-lookup"><span data-stu-id="58cc9-109">Property Size Limitations</span></span>](#property-size-limitations)
- [<span data-ttu-id="58cc9-110">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="58cc9-110">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="58cc9-111">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="58cc9-111">Related topics</span></span>](#related-topics)

## <a name="property-filtering"></a><span data-ttu-id="58cc9-112">Filtrage des propriétés</span><span class="sxs-lookup"><span data-stu-id="58cc9-112">Property Filtering</span></span>

<span data-ttu-id="58cc9-113">Les meilleures pratiques pour le filtrage de propriétés sont répertoriées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="58cc9-113">Best practices for property filtering are listed in the following table.</span></span>

| <span data-ttu-id="58cc9-114">Méthode</span><span class="sxs-lookup"><span data-stu-id="58cc9-114">Method</span></span>                                                | <span data-ttu-id="58cc9-115">Description</span><span class="sxs-lookup"><span data-stu-id="58cc9-115">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="58cc9-116">**IFilter :: init**</span><span class="sxs-lookup"><span data-stu-id="58cc9-116">**IFilter::Init**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-init)      | <span data-ttu-id="58cc9-117">Retourne l’énumération d' [**\_ indicateurs IFilter**](/windows/win32/api/filter/ne-filter-ifilter_flags) .</span><span class="sxs-lookup"><span data-stu-id="58cc9-117">Returns the [**IFILTER\_FLAGS**](/windows/win32/api/filter/ne-filter-ifilter_flags) enumeration.</span></span> <span data-ttu-id="58cc9-118">Si le membre des *\_ \_ \_ propriétés OLE Flags IFilter* de cette énumération a la valeur 1, Windows Search utilise les interfaces des interfaces [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) et [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) pour énumérer et accéder aux propriétés de type valeur externe.</span><span class="sxs-lookup"><span data-stu-id="58cc9-118">If the *IFILTER\_FLAGS\_OLE\_PROPERTIES* member of this enumeration is set to one, then Windows Search uses the [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) and [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) interfaces interfaces to enumerate and access external value-type properties.</span></span> |
| [<span data-ttu-id="58cc9-119">**IFilter :: GetChunk**</span><span class="sxs-lookup"><span data-stu-id="58cc9-119">**IFilter::GetChunk**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getchunk) | <span data-ttu-id="58cc9-120">Retourne des informations à partir d’un document dans des « segments » avec le type de bloc (texte ou valeur), le nom et les paramètres régionaux.</span><span class="sxs-lookup"><span data-stu-id="58cc9-120">Returns information from a document in "chunks" with chunk type (text or value), name, and locale.</span></span> <span data-ttu-id="58cc9-121">Un segment contient une propriété de document.</span><span class="sxs-lookup"><span data-stu-id="58cc9-121">A chunk contains one document property.</span></span>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="58cc9-122">**IFilter :: GetText**</span><span class="sxs-lookup"><span data-stu-id="58cc9-122">**IFilter::GetText**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-gettext)   | <span data-ttu-id="58cc9-123">Obtient une propriété de type texte à partir d’un segment.</span><span class="sxs-lookup"><span data-stu-id="58cc9-123">Gets a text-type property from a chunk.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="58cc9-124">**IFilter :: GetValue**</span><span class="sxs-lookup"><span data-stu-id="58cc9-124">**IFilter::GetValue**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getvalue) | <span data-ttu-id="58cc9-125">Obtient une propriété de type valeur à partir d’un segment.</span><span class="sxs-lookup"><span data-stu-id="58cc9-125">Gets a value-type property from a chunk.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                        |

<span data-ttu-id="58cc9-126">L’illustration suivante montre un exemple de document.</span><span class="sxs-lookup"><span data-stu-id="58cc9-126">The following illustration shows an example document.</span></span> <span data-ttu-id="58cc9-127">La propriété de type valeur externe `DocTitle` (obtenue à l’aide de méthodes des interfaces [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) et [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) ) et la propriété de type valeur interne `Book` (obtenue à la suite d’une implémentation [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) personnalisée) décrivent le document dans son ensemble.</span><span class="sxs-lookup"><span data-stu-id="58cc9-127">The external value-type property `DocTitle` (obtained using methods of the [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) and [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) interfaces) and the internal value-type property `Book` (obtained as a result of a custom [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementation) describe the document as a whole.</span></span> <span data-ttu-id="58cc9-128">Les propriétés de type texte `Contents` et `Chapter` décrivent le contenu du document.</span><span class="sxs-lookup"><span data-stu-id="58cc9-128">The text-type properties `Contents` and `Chapter` describe the content of the document.</span></span> <span data-ttu-id="58cc9-129">Lors du traitement de ce document, le gestionnaire de filtre (une implémentation de l’interface **IFilter** ) identifie et extrait ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="58cc9-129">When processing this document, the filter handler (an implementation of the **IFilter** interface) identifies and extracts these properties.</span></span>

![Diagramme montrant les éléments d’un document standard](images/ifilterpropertyextraction.png)

### <a name="property-size-limitations"></a><span data-ttu-id="58cc9-131">Limitations de la taille des propriétés</span><span class="sxs-lookup"><span data-stu-id="58cc9-131">Property Size Limitations</span></span>

<span data-ttu-id="58cc9-132">Il existe deux limitations potentielles à la taille des propriétés :</span><span class="sxs-lookup"><span data-stu-id="58cc9-132">There are two potential limitations to property size:</span></span>

- <span data-ttu-id="58cc9-133">Taille maximale des données que Windows Search accepte par fichier.</span><span class="sxs-lookup"><span data-stu-id="58cc9-133">The maximum size of data that Windows Search accepts per file.</span></span>
- <span data-ttu-id="58cc9-134">Taille maximale par propriété telle que définie dans le fichier de description de la propriété.</span><span class="sxs-lookup"><span data-stu-id="58cc9-134">The maximum size per property as defined in the property description file.</span></span>

<span data-ttu-id="58cc9-135">Actuellement, Windows Search n’utilise pas la taille de propriété définie lors du calcul de la quantité de données qu’il accepte à partir d’un élément.</span><span class="sxs-lookup"><span data-stu-id="58cc9-135">Currently, Windows Search does not use the defined property size when calculating the amount of data it accepts from an item.</span></span> <span data-ttu-id="58cc9-136">Au lieu de cela, la limite d’utilisation de la recherche Windows est le produit de la taille du fichier et le `MaxGrowFactor` (taille de fichier N \* MaxGrowFactor) lu à partir du Registre.</span><span class="sxs-lookup"><span data-stu-id="58cc9-136">Instead, the limit Windows Search uses is the product of the size of the file and the `MaxGrowFactor` (file size N \* MaxGrowFactor) read from the registry.</span></span> <span data-ttu-id="58cc9-137">La valeur par défaut `MaxGrowFactor` est quatre.</span><span class="sxs-lookup"><span data-stu-id="58cc9-137">The default `MaxGrowFactor` is four.</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Gathering Manager
            MaxGrowFactor
```

<span data-ttu-id="58cc9-138">Par conséquent, si la taille totale de votre type de fichier est faible, mais que les propriétés sont plus volumineuses, la recherche Windows peut ne pas accepter toutes les données de propriété que vous souhaitez émettre.</span><span class="sxs-lookup"><span data-stu-id="58cc9-138">Consequently, if your file type tends to be small in total size but have larger properties, Windows Search may not accept all the property data you want to emit.</span></span> <span data-ttu-id="58cc9-139">Toutefois, vous pouvez augmenter le `MaxGrowFactor` en fonction de vos besoins.</span><span class="sxs-lookup"><span data-stu-id="58cc9-139">However, you can increase the `MaxGrowFactor` to suit your needs.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="58cc9-140">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="58cc9-140">Additional Resources</span></span>

- <span data-ttu-id="58cc9-141">L’exemple de code [IFilterSample](-search-sample-ifiltersample.md) , disponible sur [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), montre comment créer une classe de base IFilter pour l’implémentation de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="58cc9-141">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="58cc9-142">Pour obtenir une vue d’ensemble du processus d’indexation, consultez [processus d’indexation](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="58cc9-142">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="58cc9-143">Pour obtenir une vue d’ensemble des types de fichiers, consultez [types de fichiers](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="58cc9-143">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="58cc9-144">Pour interroger des attributs d’association de fichiers pour un type de fichier, consultez [PerceivedTypes, SystemFileAssociations et inscription d’application](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="58cc9-144">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>
- <span data-ttu-id="58cc9-145">Pour obtenir une vue d’ensemble des propriétés et des gestionnaires de propriétés, ainsi qu’une liste des propriétés système que vous pouvez utiliser pour vos formats de fichier, consultez [développement de gestionnaires de propriétés pour Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="58cc9-145">For an overview of properties and property handlers, and a list of system properties that you can use for your file formats, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="58cc9-146">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="58cc9-146">Related topics</span></span>

[<span data-ttu-id="58cc9-147">Développement de gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="58cc9-147">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="58cc9-148">À propos des gestionnaires de filtres dans Windows Search</span><span class="sxs-lookup"><span data-stu-id="58cc9-148">About Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="58cc9-149">Meilleures pratiques pour la création de gestionnaires de filtres dans Windows Search</span><span class="sxs-lookup"><span data-stu-id="58cc9-149">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="58cc9-150">Gestionnaires de filtres fournis avec Windows</span><span class="sxs-lookup"><span data-stu-id="58cc9-150">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="58cc9-151">Implémentation de gestionnaires de filtres dans Windows Search</span><span class="sxs-lookup"><span data-stu-id="58cc9-151">Implementing Filter Handlers in Windows Search</span></span>](-search-ifilter-constructing-filters.md)

[<span data-ttu-id="58cc9-152">Inscription des gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="58cc9-152">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="58cc9-153">Test des gestionnaires de filtres</span><span class="sxs-lookup"><span data-stu-id="58cc9-153">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
