---
description: Certaines applications stockent leurs éléments dans des bases de données ou des types de fichiers personnalisés.
ms.assetid: 0e2b7b4b-ae87-4092-b924-6191cdf42c9b
title: Fonctionnement des gestionnaires de protocole
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28c171c5790e47bbf624d9107a5ca5b3dc0b9fd4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106516844"
---
# <a name="understanding-protocol-handlers"></a><span data-ttu-id="1723d-103">Fonctionnement des gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-103">Understanding Protocol Handlers</span></span>

<span data-ttu-id="1723d-104">Certaines applications stockent leurs éléments dans des bases de données ou des types de fichiers personnalisés.</span><span class="sxs-lookup"><span data-stu-id="1723d-104">Some applications store their items in databases or custom file types.</span></span> <span data-ttu-id="1723d-105">Alors que Windows Search peut indexer le nom et les propriétés du fichier, Windows n’a aucune connaissance du contenu du fichier.</span><span class="sxs-lookup"><span data-stu-id="1723d-105">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="1723d-106">Par conséquent, ces éléments ne peuvent pas être indexés ou exposés dans le shell Windows.</span><span class="sxs-lookup"><span data-stu-id="1723d-106">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="1723d-107">En créant un gestionnaire de protocole, vous pouvez rendre ces éléments disponibles pour l’indexation.</span><span class="sxs-lookup"><span data-stu-id="1723d-107">By creating a protocol handler you can make these items available for indexing.</span></span> <span data-ttu-id="1723d-108">Vous pouvez également indexer un format de fichier composé, tel qu’un fichier. zip.</span><span class="sxs-lookup"><span data-stu-id="1723d-108">You can also index a compound file format such as a .zip file.</span></span>

<span data-ttu-id="1723d-109">Cette rubrique est organisée comme suit :</span><span class="sxs-lookup"><span data-stu-id="1723d-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="1723d-110">Indexation des magasins de données à l’aide de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-110">Indexing Data Stores with Protocol Handlers</span></span>](#indexing-data-stores-with-protocol-handlers)
    -   [<span data-ttu-id="1723d-111">Magasins de données Shell</span><span class="sxs-lookup"><span data-stu-id="1723d-111">Shell Data Stores</span></span>](#shell-data-stores)
    -   [<span data-ttu-id="1723d-112">Gestionnaires de protocoles</span><span class="sxs-lookup"><span data-stu-id="1723d-112">Protocol Handlers</span></span>](#protocol-handlers)
    -   [<span data-ttu-id="1723d-113">Filtres et gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-113">Filters and Protocol Handlers</span></span>](#filters-and-protocol-handlers)
-   [<span data-ttu-id="1723d-114">Indexation d’un format de fichier composé</span><span class="sxs-lookup"><span data-stu-id="1723d-114">Indexing a Compound File Format</span></span>](#indexing-a-compound-file-format)
-   [<span data-ttu-id="1723d-115">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1723d-115">Related topics</span></span>](#related-topics)

## <a name="indexing-data-stores-with-protocol-handlers"></a><span data-ttu-id="1723d-116">Indexation des magasins de données à l’aide de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-116">Indexing Data Stores with Protocol Handlers</span></span>

<span data-ttu-id="1723d-117">Lorsque les utilisateurs doivent effectuer des recherches dans les bases de données héritées, les magasins de courrier électronique ou d’autres structures de données qui ne sont pas prises en charge par Windows Search, vous devez d’abord déterminer si un gestionnaire de protocole existe déjà pour ce magasin de données, peut-être pour une utilisation avec une autre application telle que SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="1723d-117">When users need to search legacy databases, email stores or other data structures that are not supported by Windows Search, you should first determine whether a protocol handler already exists for that data store, perhaps for use with another application such as SharePoint Server.</span></span> <span data-ttu-id="1723d-118">Dans ce cas, vous pouvez installer ce gestionnaire de protocole sur le système.</span><span class="sxs-lookup"><span data-stu-id="1723d-118">If so, you can install that protocol handler on the system.</span></span> <span data-ttu-id="1723d-119">Les gestionnaires de protocoles de recherche Windows utilisent des spécifications de conception similaires à celles de SharePoint Server, et ils peuvent souvent être utilisés de manière interchangeable.</span><span class="sxs-lookup"><span data-stu-id="1723d-119">Windows Search protocol handlers use design specifications similar to SharePoint Server, and they can often be used interchangeably.</span></span>

<span data-ttu-id="1723d-120">Pour plus d’informations sur le déploiement du serveur de recherche 2008 avec Office SharePoint Server 2007, consultez recherche [fédérée Search \[ Server \] 2008](/previous-versions/office/bb931109(v=office.14)).</span><span class="sxs-lookup"><span data-stu-id="1723d-120">For more information about Search Server 2008 deployment with Office SharePoint Server 2007, see [Federated Search \[Search Server 2008\]](/previous-versions/office/bb931109(v=office.14)).</span></span>

### <a name="shell-data-stores"></a><span data-ttu-id="1723d-121">Magasins de données Shell</span><span class="sxs-lookup"><span data-stu-id="1723d-121">Shell Data Stores</span></span>

<span data-ttu-id="1723d-122">Pour qu’un développeur tiers de nouveaux formats de fichier et de magasins de données puisse faire apparaître ces formats et magasins dans les résultats de requête de l’Explorateur Windows, le développeur doit implémenter une source de données Shell.</span><span class="sxs-lookup"><span data-stu-id="1723d-122">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must implement a Shell data source.</span></span> <span data-ttu-id="1723d-123">Une source de données Shell est un composant qui est utilisé pour étendre l’espace de noms de l’interpréteur de commandes et exposer des éléments dans un magasin de données.</span><span class="sxs-lookup"><span data-stu-id="1723d-123">A Shell data source is a component that is used to extend the Shell namespace and expose items in a data store.</span></span> <span data-ttu-id="1723d-124">Un magasin de données est un référentiel de données.</span><span class="sxs-lookup"><span data-stu-id="1723d-124">A data store is a repository of data.</span></span> <span data-ttu-id="1723d-125">Un magasin de données peut être exposé au modèle de programmation de l’interpréteur de commandes en tant que conteneur qui utilise une source de données Shell.</span><span class="sxs-lookup"><span data-stu-id="1723d-125">A data store can be exposed to the Shell programming model as a container that uses a Shell data source.</span></span> <span data-ttu-id="1723d-126">Les éléments d’un magasin de données peuvent être indexés par le système de recherche Windows à l’aide d’un gestionnaire de protocole.</span><span class="sxs-lookup"><span data-stu-id="1723d-126">The items in a data store can be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="1723d-127">Le gestionnaire de protocole implémente le protocole d’accès à une source de contenu dans son format natif.</span><span class="sxs-lookup"><span data-stu-id="1723d-127">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="1723d-128">Les interfaces [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) et [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2) permettent d’implémenter un gestionnaire de protocole personnalisé pour développer les sources de données qui peuvent être indexées.</span><span class="sxs-lookup"><span data-stu-id="1723d-128">The [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span>

<span data-ttu-id="1723d-129">Si vous souhaitez que les résultats de la requête s’affichent dans l’Explorateur Windows, vous devez implémenter une source de données Shell avant de pouvoir créer un gestionnaire de protocole pour étendre l’index.</span><span class="sxs-lookup"><span data-stu-id="1723d-129">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="1723d-130">Toutefois, si toutes les requêtes sont par programmation (par exemple OLE DB) et interprétées par le code de l’application plutôt que par l’interpréteur de commandes, un espace de noms de Shell, alors que préféré n’est pas strictement requis.</span><span class="sxs-lookup"><span data-stu-id="1723d-130">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace while still preferred is not strictly required.</span></span>

> [!Note]  
> <span data-ttu-id="1723d-131">Une source de données Shell est parfois appelée extension d’espace de noms Shell.</span><span class="sxs-lookup"><span data-stu-id="1723d-131">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="1723d-132">Un gestionnaire est parfois appelé extension d’interpréteur de commandes ou gestionnaire d’extensions de Shell.</span><span class="sxs-lookup"><span data-stu-id="1723d-132">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

<span data-ttu-id="1723d-133">Si vous souhaitez que les utilisateurs affichent leurs résultats de recherche dans l’Explorateur Windows, vous devez créer un gestionnaire de protocole et un ou plusieurs des compléments suivants :</span><span class="sxs-lookup"><span data-stu-id="1723d-133">If you want users to view their search results from within Windows Explorer, then you must create a protocol handler and one or more of the following add-ins:</span></span>

-   <span data-ttu-id="1723d-134">Gestionnaire de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="1723d-134">Shortcut menu handler</span></span>
-   <span data-ttu-id="1723d-135">Gestionnaire d’icône</span><span class="sxs-lookup"><span data-stu-id="1723d-135">Icon handler</span></span>
-   <span data-ttu-id="1723d-136">Tout autre type de gestionnaire de fichiers</span><span class="sxs-lookup"><span data-stu-id="1723d-136">Some other type of file handler</span></span>

<span data-ttu-id="1723d-137">Pour obtenir la liste des gestionnaires identifiés par le scénario de développement que vous essayez d’atteindre, consultez « vue d’ensemble des gestionnaires » dans [Windows Search en tant que plateforme de développement](-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="1723d-137">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](-search-3x-wds-development-ovr.md).</span></span> <span data-ttu-id="1723d-138">Pour plus d’informations sur la création de gestionnaires, consultez [inscription d’extensions de Shell](../shell/reg-shell-exts.md), [menu contextuel](/previous-versions/windows/desktop/legacy/cc144169(v=vs.85))et [gestionnaires de types de fichiers](../shell/fa-file-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="1723d-138">For information on creating handlers, see [Registering Shell Extensions](../shell/reg-shell-exts.md), [Context Menu](/previous-versions/windows/desktop/legacy/cc144169(v=vs.85)), and [File Type Handlers](../shell/fa-file-extensions.md).</span></span>

### <a name="protocol-handlers"></a><span data-ttu-id="1723d-139">Gestionnaires de protocoles</span><span class="sxs-lookup"><span data-stu-id="1723d-139">Protocol Handlers</span></span>

<span data-ttu-id="1723d-140">Si le magasin de données est également un conteneur (tel qu’un dossier de système de fichiers), vous devez implémenter un filtre pour énumérer les URL dans le conteneur.</span><span class="sxs-lookup"><span data-stu-id="1723d-140">If the data store is also a container (such as a file system folder), you must implement a filter to enumerate the URLs in the container.</span></span> <span data-ttu-id="1723d-141">Si le magasin de données contient des données ou des types de fichier autres que l’un des types de fichiers 200 pris en charge par Windows Search, vous devez implémenter un filtre pour accéder au contenu des éléments du magasin et l’indexer.</span><span class="sxs-lookup"><span data-stu-id="1723d-141">If the data store contains data or file types other than one of the 200 file types supported by Windows Search, you must implement a filter to access and index the contents of items in the store.</span></span> <span data-ttu-id="1723d-142">Windows Search utilise un gestionnaire de protocole et une technologie [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) similaires à ceux utilisés par SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="1723d-142">Windows Search uses protocol handler and [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) technology similar to that used by SharePoint Server.</span></span> <span data-ttu-id="1723d-143">Si vous avez déjà des filtres pour un magasin et un type de fichier spécifiques installés sur le système indexé, Windows Search peut être en mesure d’utiliser les interfaces existantes pour indexer ces données.</span><span class="sxs-lookup"><span data-stu-id="1723d-143">If you already have filters for a specific store and file type installed on the system being indexed, Windows Search may be able to use the existing interfaces to index this data.</span></span>

<span data-ttu-id="1723d-144">Pour obtenir une vue d’ensemble du processus d’indexation, consultez [processus d’indexation](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1723d-144">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span> <span data-ttu-id="1723d-145">Pour obtenir des informations conceptuelles sur les gestionnaires de filtres, consultez [développement de gestionnaires de filtres](-search-ifilter-conceptual.md).</span><span class="sxs-lookup"><span data-stu-id="1723d-145">For conceptual information on filter handlers, see [Developing Filter Handlers](-search-ifilter-conceptual.md).</span></span>

### <a name="filters-and-protocol-handlers"></a><span data-ttu-id="1723d-146">Filtres et gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-146">Filters and Protocol Handlers</span></span>

<span data-ttu-id="1723d-147">Les gestionnaires de protocole accordent à l’indexeur de recherche Windows l’accès aux magasins de données, ce qui permet à l’indexeur d’analyser les nœuds d’un magasin de données et d’extraire les informations pertinentes vers l’index.</span><span class="sxs-lookup"><span data-stu-id="1723d-147">Protocol handlers give the Windows Search indexer access to data stores, enabling the indexer to crawl the nodes of a data store and extract relevant information to index.</span></span> <span data-ttu-id="1723d-148">Windows Search, par exemple, est fourni avec des gestionnaires de protocole pour les magasins de système de fichiers et pour certaines versions des deux banques de données Microsoft Outlook.</span><span class="sxs-lookup"><span data-stu-id="1723d-148">Windows Search, for example, ships with protocol handlers for file system stores and for some versions of both Microsoft Outlook data stores.</span></span> <span data-ttu-id="1723d-149">Lors de l’indexation de la messagerie Outlook, le gestionnaire de protocole analyse tous les messages d’un ensemble de dossiers Outlook et extrait des informations de chaque message et pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="1723d-149">When indexing Outlook email, the protocol handler crawls all messages in a set of Outlook folders and extracts information from each message and attachment.</span></span> <span data-ttu-id="1723d-150">Ces informations sont transmises à l’indexeur pour inclusion dans le catalogue de recherche Windows.</span><span class="sxs-lookup"><span data-stu-id="1723d-150">This information is passed to the indexer for inclusion in the Windows Search catalog.</span></span>

<span data-ttu-id="1723d-151">Pour obtenir une vue d’ensemble du gestionnaire de catalogues et du gestionnaire de portée d’analyse (CSM), consultez [utilisation du gestionnaire de catalogues](-search-3x-wds-mngidx-catalog-manager.md) et [utilisation du gestionnaire de portée d’analyse](-search-3x-wds-extidx-csm.md).</span><span class="sxs-lookup"><span data-stu-id="1723d-151">For overviews of the Catalog Manager and Crawl Scope Manager (CSM), see [Using the Catalog Manager](-search-3x-wds-mngidx-catalog-manager.md) and [Using the Crawl Scope Manager](-search-3x-wds-extidx-csm.md).</span></span>

## <a name="indexing-a-compound-file-format"></a><span data-ttu-id="1723d-152">Indexation d’un format de fichier composé</span><span class="sxs-lookup"><span data-stu-id="1723d-152">Indexing a Compound File Format</span></span>

<span data-ttu-id="1723d-153">Un format de fichier composé peut être indexé afin que les éléments individuels du fichier puissent être retournés en tant que résultats individuels.</span><span class="sxs-lookup"><span data-stu-id="1723d-153">A compound file format can be indexed so that individual items in the file can can be returned as individual results.</span></span> <span data-ttu-id="1723d-154">Un format de fichier composé, tel qu’un fichier compressé avec une extension de nom de fichier. zip, est essentiellement un magasin de données et peut être traité comme tel à des fins d’indexation.</span><span class="sxs-lookup"><span data-stu-id="1723d-154">A compound file format such as a compressed file with a .zip file name extension is essentially a data store and can be treated as such for indexing purposes.</span></span> <span data-ttu-id="1723d-155">L’exemple suivant affiche un fichier. zip dans l’espace de noms du système de fichiers (FILE://c:/test/test.zip) dans lequel se trouvent à la fois des sous-dossiers et des éléments individuels.</span><span class="sxs-lookup"><span data-stu-id="1723d-155">The following example displays a .zip file in the file system namespace (FILE://c:/test/test.zip) in which there are both subfolders and individual items.</span></span>

``` syntax
Test.zip 

    |-folder1 

    |    |-folder2 

    |           |- FileX.txt 

    |- FileY.doc
```

<span data-ttu-id="1723d-156">Le gestionnaire de protocole de fichier Découvre quand FILE://c:/test/test.zip change en surveillant les journaux de modification du système de fichiers, et il appelle un [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) inscrit pour les fichiers. zip sur ce fichier lorsque le fichier est modifié, mais il n’a aucune connaissance de la structure interne du fichier. zip lui-même.</span><span class="sxs-lookup"><span data-stu-id="1723d-156">The FILE protocol handler discovers when FILE://c:/test/test.zip changes by monitoring file system change logs, and it will invoke an [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) registered for .zip files on that file when the file changes, but it has no knowledge of the internal structure of the .zip file itself.</span></span>

<span data-ttu-id="1723d-157">Vous devez informer l’indexeur que le format de fichier composé est un magasin de données.</span><span class="sxs-lookup"><span data-stu-id="1723d-157">You must inform the indexer that the compound file format is a data store.</span></span> <span data-ttu-id="1723d-158">Cela est nécessaire pour que les éléments individuels soient indexés et récupérés en tant qu’entités uniques.</span><span class="sxs-lookup"><span data-stu-id="1723d-158">It is necessary to do so for individual items to be indexed and retrieved as unique entities.</span></span> <span data-ttu-id="1723d-159">Une fois que vous avez implémenté une source de données Shell et effectué les étapes suivantes, vous disposerez d’un gestionnaire de protocole capable de traiter et d’exposer les données à partir d’un format de fichier composé (fichier. zip) en tant qu’éléments individuels.</span><span class="sxs-lookup"><span data-stu-id="1723d-159">After you have implemented a Shell data source and performed the following steps, you will have a protocol handler that can process and expose the data from a compound file format (a .zip file) as individual items.</span></span>

<span data-ttu-id="1723d-160">**Pour informer l’indexeur qu’un fichier composé est un magasin de données :**</span><span class="sxs-lookup"><span data-stu-id="1723d-160">**To inform the indexer that a compound file is a data store:**</span></span>

1.  <span data-ttu-id="1723d-161">Créez un gestionnaire de protocole (à l’aide de [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) ou [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)) pour les fichiers. zip ayant la possibilité d’établir une liaison avec le fichier source.</span><span class="sxs-lookup"><span data-stu-id="1723d-161">Create a protocol handler (using [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) or [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)) for .zip files that has the ability bind to the source file.</span></span> <span data-ttu-id="1723d-162">Pour plus d’informations, consultez [installation et inscription de gestionnaires de protocole](-search-3x-wds-ph-install-registration.md).</span><span class="sxs-lookup"><span data-stu-id="1723d-162">For more information, see [Installing and Registering Protocol Handlers](-search-3x-wds-ph-install-registration.md).</span></span>

    <span data-ttu-id="1723d-163">Par exemple, vous pouvez utiliser un chemin d’échappement du fichier. zip comme nom de dossier racine, puis utiliser une syntaxe de hiérarchie comme tout autre format de fichier.</span><span class="sxs-lookup"><span data-stu-id="1723d-163">For example, you could use an escaped path to the .zip file as the root folder name and then use a hierarchy syntax like any other file format.</span></span>

    ``` syntax
    .zip:///escapedPathTo.zipFile/.zipfolder/.../.zipfile
    ```

    <span data-ttu-id="1723d-164">À l’aide des exemples de données ci-dessus pour c : \\ test \\test.zip, les URL uniques sont les suivantes.</span><span class="sxs-lookup"><span data-stu-id="1723d-164">Using the above sample data for c:\\test\\test.zip, the unique URLs would be as follows.</span></span> <span data-ttu-id="1723d-165">Avec ces URL, le gestionnaire de protocole a les informations nécessaires pour établir une liaison au fichier. zip et énumérer les URL enfants, y compris les fichiers internes, afin qu’ils puissent être liés et indexés par les filtres. doc et. txt.</span><span class="sxs-lookup"><span data-stu-id="1723d-165">With these URLs the protocol handler has the information necessary to bind to the .zip file and enumerate the child URLs including the inner files so that they can be bound to and indexed by the .doc and .txt filters.</span></span>

    ``` syntax
      

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/ 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/FileY.Doc 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1/folder2 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1/folder2/FileX.txt
    ```

2.  <span data-ttu-id="1723d-166">Assurez-vous que votre gestionnaire de protocole respecte les deux conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="1723d-166">Ensure that your protocol handler meets the following two conditions:</span></span>
    -   <span data-ttu-id="1723d-167">Les URL racines d’un fichier. zip doivent émettre des \_ \_ IsClosedDirectory de recherche de code de fonction ([System. Search. IsClosedDirectory](../properties/props-system-search-iscloseddirectory.md)) sur les URL qui sont les URL du fichier. zip racine.</span><span class="sxs-lookup"><span data-stu-id="1723d-167">The root URLs for a .zip file should emit PKEY\_Search\_IsClosedDirectory ([System.Search.IsClosedDirectory](../properties/props-system-search-iscloseddirectory.md)) on the URLs that are the root .zip file URLs.</span></span> <span data-ttu-id="1723d-168">Par exemple,. zip:///FILE :%2f%2f%2fc :%2ftest% 2ftest.zip/doit émettre IsClosedDirectory = **true**.</span><span class="sxs-lookup"><span data-stu-id="1723d-168">For example, .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/ should emit IsClosedDirectory = **TRUE**.</span></span> <span data-ttu-id="1723d-169">Cela indique à l’indexeur que si la date sur cette URL n’a pas changé, il n’est pas nécessaire de traiter les URL enfants.</span><span class="sxs-lookup"><span data-stu-id="1723d-169">This tells the indexer that if the date on this URL has not changed, it does not need to process any of the child URLs.</span></span>
    -   <span data-ttu-id="1723d-170">Chaque URL enfant pour cette URL doit émettre un IsFullyContained de recherche de code de \_ \_ fonction ([System. Search. IsFullyContained](../properties/props-system-search-isfullycontained.md)) sur les URL enfants de l’URL. zip racine.</span><span class="sxs-lookup"><span data-stu-id="1723d-170">Every child URL for that URL should emit PKEY\_Search\_IsFullyContained ([System.Search.IsFullyContained](../properties/props-system-search-isfullycontained.md)) on the child URLs of the root .zip URL.</span></span> <span data-ttu-id="1723d-171">Normalement à la fin d’une analyse incrémentielle, l’indexeur traite toutes les URL non visitées comme des éléments qui doivent être supprimés.</span><span class="sxs-lookup"><span data-stu-id="1723d-171">Normally at the end of an incremental crawl, the indexer treats all unvisited URLs as items that should be deleted.</span></span> <span data-ttu-id="1723d-172">Toutefois, le fichier. zip racine ne doit pas traiter les URL racines, car rien n’a changé.</span><span class="sxs-lookup"><span data-stu-id="1723d-172">But the root .zip file should not process root URLs because nothing has changed.</span></span> <span data-ttu-id="1723d-173">L’émission de cette propriété avec la **valeur true** indique à l’indexeur que si cette URL n’a pas été traitée à la fin d’une analyse incrémentielle, elle ne doit pas être supprimée.</span><span class="sxs-lookup"><span data-stu-id="1723d-173">Emitting this property as **TRUE** tells the indexer that if this URL has not been processed at the end of an incremental crawl, it should not be deleted.</span></span> <span data-ttu-id="1723d-174">Elle sera supprimée uniquement si l’élément racine a été modifié et qu’il n’est pas visité.</span><span class="sxs-lookup"><span data-stu-id="1723d-174">It will only be deleted if the root item has changed and it is not visited.</span></span>

<span data-ttu-id="1723d-175">Windows Search requiert une page de démarrage pour un protocole afin de savoir quelles URL analyser de façon incrémentielle et quelles URL doivent être ignorées lorsqu’elles sont trouvées.</span><span class="sxs-lookup"><span data-stu-id="1723d-175">Windows Search requires a start page for a protocol in order to know what URLs to crawl incrementally and which URLs should be ignored when they are found.</span></span> <span data-ttu-id="1723d-176">Toutefois, nous ne pouvons pas démarrer avec une URL pour chaque fichier. zip, car nous ne savons pas où se trouve chaque fichier. zip.</span><span class="sxs-lookup"><span data-stu-id="1723d-176">But we can't start with a URL for each .zip file, because we don't know where each .zip file is.</span></span> <span data-ttu-id="1723d-177">Par conséquent, l’URL de la page de démarrage du gestionnaire de protocole. zip doit être en mesure d’énumérer tout ce qui se trouve à la racine des chemins d’échappement de tous les fichiers. zip.</span><span class="sxs-lookup"><span data-stu-id="1723d-177">Hence, the .zip protocol handler's start page URL must be able to enumerate everything at the root of the escaped paths of all of the .zip files.</span></span> <span data-ttu-id="1723d-178">Ces fichiers. zip ne sont pas nécessairement dans le fichier : namespace et peuvent être une URL de type MAPI qui pointe vers un fichier. zip en tant que pièce jointe, par exemple.</span><span class="sxs-lookup"><span data-stu-id="1723d-178">Those .zip files are not necessarily in the FILE: namespace and could be a MAPI type URL that points to a .zip file as an attachment, for example.</span></span>

<span data-ttu-id="1723d-179">**Pour inscrire une racine comme page de démarrage :**</span><span class="sxs-lookup"><span data-stu-id="1723d-179">**To register a root as a start page:**</span></span>

1.  <span data-ttu-id="1723d-180">Inscrivez une racine telle que. zip:///comme page de démarrage afin que tous les fichiers. zip y démarrent, en effet.</span><span class="sxs-lookup"><span data-stu-id="1723d-180">Register a root such as .zip:/// as a start page so that all .zip files start there, in effect.</span></span> <span data-ttu-id="1723d-181">Lors du traitement de l’URL root. zip :, votre gestionnaire de protocole doit générer la liste des URL enfants à émettre en interrogeant Windows Search pour toutes les URL avec System. FileExtension = ". zip".</span><span class="sxs-lookup"><span data-stu-id="1723d-181">When processing the root .zip: URL, your protocol handler should generate the list of child URLs to emit by querying Windows Search for all of the URLs with System.FileExtension = ".zip".</span></span>
2.  <span data-ttu-id="1723d-182">Échapper ces URL pour supprimer les barres obliques et les retourner en tant qu’URL enfants.</span><span class="sxs-lookup"><span data-stu-id="1723d-182">Escape those URLs to remove the slashes and return them as child URLs.</span></span> <span data-ttu-id="1723d-183">Voici un exemple de requête pour récupérer les types souhaités.</span><span class="sxs-lookup"><span data-stu-id="1723d-183">An example query to retrieve the types you want might look as follows.</span></span>

    ``` syntax
    SELECT system.itemurl, System.DateModified FROM SystemIndex 
    WHERE System.FileExtension='.zip' OR System.MimeType='mimetypefor.zip'
    ```

3.  <span data-ttu-id="1723d-184">Lorsque Windows Search effectue régulièrement une analyse incrémentielle sur votre URL racine. zip:///, vous devez refléter la liste des URL que la recherche Windows gère déjà et qui sont des URL. zip.</span><span class="sxs-lookup"><span data-stu-id="1723d-184">When Windows Search periodically does an incremental crawl on your .zip:/// root URL, you must reflect back the list of URLs that Windows Search is already maintaining that are .zip URLs.</span></span> <span data-ttu-id="1723d-185">Si une suppression est détectée dans le magasin natif où le fichier. zip est stocké, elle n’apparaît pas dans votre énumération et cette branche de l’arborescence dans le fichier. zip est supprimée.</span><span class="sxs-lookup"><span data-stu-id="1723d-185">If a deletion is discovered in the native store where the .zip file is stored, it does not appear in your enumeration, and that branch of the tree in the .zip is removed.</span></span>
4.  <span data-ttu-id="1723d-186">Pour créer une liaison avec les données. zip d’un autre gestionnaire de protocole, vous devez idéalement parcourir le [IShellFolder](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) pour cette URL afin d’établir une liaison avec le stockage de l’objet et ne pas supposer qu’il s’agit toujours d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="1723d-186">To bind to the .zip data for another protocol handler, you should ideally go through the [IShellFolder](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) for that URL to bind to the storage of the object, and not assume it is always a file.</span></span> <span data-ttu-id="1723d-187">Cela vous permet de travailler avec des pièces jointes dans des magasins de courrier électronique, par exemple.</span><span class="sxs-lookup"><span data-stu-id="1723d-187">Doing so affords you the flexibility to work with attachments in mail stores, for example.</span></span>
5.  <span data-ttu-id="1723d-188">Lors de l’émission d’URL enfants pour chaque fichier. zip, vous devez \_ utiliser \_ la recherche de UrlToIndexWithModificationTime ([System. Search. UrlToIndexWithModificationTime](../properties/props-system-search-urltoindexwithmodificationtime.md)) pour transmettre le fichier. zip \_ de la file d’envoi ([System. DateModified](../properties/props-system-datemodified.md)) du fichier. zip réel afin que l’indexeur analyse le fichier. zip uniquement s’il a changé.</span><span class="sxs-lookup"><span data-stu-id="1723d-188">When emitting child URLs for each .zip file, you should use PKEY\_Search\_UrlToIndexWithModificationTime ([System.Search.UrlToIndexWithModificationTime](../properties/props-system-search-urltoindexwithmodificationtime.md)) to pass PKEY\_DateModified ([System.DateModified](../properties/props-system-datemodified.md)) of the actual .zip file so that the indexer crawls the .zip file only if it has changed.</span></span>

<span data-ttu-id="1723d-189">Pour que vos URL. zip soient indexées immédiatement après leur création ou leur modification, et qu’il n’est pas nécessaire d’attendre qu’une analyse incrémentielle Découvre leur nouvel État, vous pouvez surveiller le système de fichiers vous-même pour les modifications de fichier. zip.</span><span class="sxs-lookup"><span data-stu-id="1723d-189">To have your .zip URLs indexed immediately after they are created or modified, and not have to wait for an incremental crawl to discover their new state, you could conceivably monitor the file system yourself for .zip file changes.</span></span> <span data-ttu-id="1723d-190">Toutefois, une telle approche ne fonctionnerait pas pour d’autres magasins de données tels que MAPI.</span><span class="sxs-lookup"><span data-stu-id="1723d-190">However, such an approach would not work for other data stores such as MAPI.</span></span>

<span data-ttu-id="1723d-191">**Pour que vos URL. zip soient indexées lorsqu’elles sont créées ou modifiées :**</span><span class="sxs-lookup"><span data-stu-id="1723d-191">**To have your .zip urls indexed when they are created or modified:**</span></span>

1.  <span data-ttu-id="1723d-192">Créez un filtre (et l’implémentation de l’interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) pour le type de fichier. zip.</span><span class="sxs-lookup"><span data-stu-id="1723d-192">Create a filter (and implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface) for the .zip file type.</span></span> <span data-ttu-id="1723d-193">Pour plus d’informations, consultez [développement de gestionnaires de propriétés pour Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="1723d-193">For more information, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>
2.  <span data-ttu-id="1723d-194">Chaque fois que votre implémentation [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) est appelée, cela est dû au fait que l’URL a été découverte ou modifiée.</span><span class="sxs-lookup"><span data-stu-id="1723d-194">Whenever your [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementation is called, it is because that URL has been discovered or changed.</span></span> <span data-ttu-id="1723d-195">Ensuite, générez un événement pour l’URL. zip appropriée pour l’URL source, via l’interface [**IGatherNotifyInline**](/previous-versions/windows/desktop/legacy/bb231470(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="1723d-195">Then, generate an event for the .zip URL appropriate for the source URL, through the [**IGatherNotifyInline**](/previous-versions/windows/desktop/legacy/bb231470(v=vs.85)) interface.</span></span> <span data-ttu-id="1723d-196">Cela vous donne la possibilité d’indiquer immédiatement à l’indexeur qu’il existe de nouvelles données à indexer sans devoir attendre l’analyse incrémentielle.</span><span class="sxs-lookup"><span data-stu-id="1723d-196">Doing so gives you the ability to immediately tell the indexer that there is new data to be indexed without having to wait for the incremental crawl.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1723d-197">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1723d-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1723d-198">Développement de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-198">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)
</dt> <dt>

[<span data-ttu-id="1723d-199">Installation et inscription de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-199">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="1723d-200">Notification de l’index des modifications</span><span class="sxs-lookup"><span data-stu-id="1723d-200">Notifying the Index of Changes</span></span>](-search-3x-wds-notifyingofchanges.md)
</dt> <dt>

[<span data-ttu-id="1723d-201">Ajout d’icônes et de menus contextuels</span><span class="sxs-lookup"><span data-stu-id="1723d-201">Adding Icons and Context Menus</span></span>](-search-3x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="1723d-202">Exemple de code : extensions de Shell pour les gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-202">Code Sample: Shell Extensions for Protocol Handlers</span></span>](-search-3x-wds-ph-ui-samplecode.md)
</dt> <dt>

[<span data-ttu-id="1723d-203">Installation et inscription de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-203">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="1723d-204">Création d’un connecteur de recherche pour un gestionnaire de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-204">Creating a Search Connector for a Protocol Handler</span></span>](-search-3x-wds-ph-search-connector.md)
</dt> <dt>

[<span data-ttu-id="1723d-205">Débogage de gestionnaires de protocole</span><span class="sxs-lookup"><span data-stu-id="1723d-205">Debugging Protocol Handlers</span></span>](-search-ws-protocolhandlertesting.md)
</dt> </dl>

 

 
