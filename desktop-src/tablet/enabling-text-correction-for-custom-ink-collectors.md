---
description: Le panneau de saisie de Microsoft Tablet PC est un outil puissant pour entrer du texte manuscrit avec un stylet et corriger du texte sans utiliser de clavier.
ms.assetid: c45ac1b5-7713-4bcb-a130-4692cff99aa2
title: Activation de la correction de texte pour les collecteurs d’encre personnalisés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb4dee4c7dfee1489cd002848c496be41f73d953
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104559664"
---
# <a name="enabling-text-correction-for-custom-ink-collectors"></a>Activation de la correction de texte pour les collecteurs d’encre personnalisés

Le panneau de saisie de Microsoft Tablet PC est un outil puissant pour entrer du texte manuscrit avec un stylet et corriger du texte sans utiliser de clavier. Lorsque vous utilisez le panneau de saisie, un utilisateur entre du texte par écriture manuscrite sur les surfaces d’encrage du panneau de saisie, ce qui amène le panneau de saisie à reconnaître l’écriture manuscrite de l’utilisateur sous forme de texte. Une fois le texte reconnu, l’utilisateur clique sur insérer dans le panneau de saisie pour insérer le texte dans une application ou un document. Avant d’insérer le texte, un utilisateur a accès à un ensemble d’outils de correction dans le panneau de saisie. Il peut s’agir de la sélection d’un autre résultat de reconnaissance, de la possibilité de réécrire un caractère unique, voire d’un effacement du mot entier et de la réécriture. Ces outils de correction permettent à un utilisateur de corriger à la fois les erreurs de reconnaissance et les erreurs humaines.

Une fois que le texte entré à l’aide du panneau de saisie se trouve dans le document, les utilisateurs ont accès aux mêmes fonctionnalités de correction disponibles avant l’insertion dans les applications Windows [Text Services Framework](/windows/desktop/TSF/text-services-framework)et les services de texte. À compter de Microsoft Windows XP Service Pack 2 Tablet PC Edition, toutes les applications RichEdit sont des services de texte activés par défaut, et à partir de Windows Vista, les applications HTML sont compatibles avec les services de texte par défaut. La correction dans le document est uniquement disponible dans les applications basées sur le service de texte et les applications activées ; Cela est dû au fait que le panneau de saisie dépend de la capacité du service de texte à stocker les propriétés de texte associées, y compris les objets d’encre et les alternatives de reconnaissance, afin de fournir une correction de document.

![panneau de saisie Tablet PC avec correction de texte](images/a0dced5e-16de-410b-965f-5d97d297cee5.jpg)

Toutefois, il existe de nombreux scénarios, notamment la correction de la reconnaissance vocale ou la correction du texte tapé en déplacement, qui ne commencent pas par une entrée de texte à l’aide du panneau de saisie, mais dans laquelle la correction dans le document peut être extrêmement utile pour les utilisateurs de Tablet PC. Un exemple premier se trouve dans les applications qui fournissent des surfaces d’encrage personnalisées pour l’entrée de texte à l’aide d’un stylet. Les surfaces d’encrage personnalisées sont un excellent moyen pour les applications de fournir des fonctionnalités personnalisées propres aux tâches de saisie de texte de chaque application. En outre, les surfaces d’encrage personnalisées fournissent une expérience utilisateur Tablet PC entièrement intégrée, ce qui en fait clair, le stylet est un appareil d’entrée de première classe dans les applications qui les contiennent. Toutefois, les applications qui fournissent des surfaces d’encrage personnalisées peuvent ne pas autoriser ou ne pas être en mesure de fournir le même niveau de prise en charge de correction disponible à partir du panneau de saisie correction dans le document.

![collecteur d’encre personnalisé](images/b6797b12-dda6-44c4-87f4-570fe0c23f3a.jpg)

Les applications basées sur les services de texte ou les applications activées dans lesquelles la correction dans le document est utile pour corriger le texte non entré à l’aide du panneau de saisie peuvent utiliser l’API [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) du panneau de saisie ([Microsoft. TextInput. HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) dans le code managé) pour activer la correction du texte entré par d’autres moyens. De cette façon, les applications peuvent ajouter de manière économique une prise en charge de correction puissante à leurs surfaces d’encrage personnalisées ou d’autres scénarios de saisie de texte, et arrondir leur histoire de saisie de texte Tablet PC. L’API IHandWrittenTextInsertion du panneau de saisie est incluse dans le cadre du système d’exploitation Windows Vista et dans le cadre du kit de développement logiciel (SDK) de plateforme Tablet 1,9 ou version ultérieure. Une version .NET et COM de l’API est incluse. L’activation de la correction dans le document pour le texte non entré à l’aide du panneau de saisie est prise en charge sur Windows Vista et les versions ultérieures. La correction dans le document est uniquement disponible pour les langues latines et n’est pas en mesure d’afficher un caractère en dehors du jeu de caractères latin.

## <a name="how-to-use-the-handwrittentextinsertion-api-in-an-application"></a>Utilisation de l’API HandwrittenTextInsertion dans une application

Les modifications requises pour une application afin d’intégrer le panneau de saisie à la correction des documents non entrés à l’aide du panneau de saisie et à l’aide de l’API [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) sont simples. Tout le code d’entrée de texte personnalisé de l’application reste inchangé, à l’exception de la dernière étape. À l’endroit où le texte entré à l’aide d’une surface d’encrage personnalisée, d’une reconnaissance vocale ou d’un autre moyen doit être affiché dans un champ de texte avec les services de texte, l’application envoie le texte à l’interface **IHandWrittenTextInsertion** au lieu de l’envoyer directement au champ de texte. Le composant de programmabilité du panneau de saisie gère alors l’insertion du texte dans le champ de texte et dans le magasin de stockage des services de texte. Lors de l’ajout du texte au magasin de stockage des services de texte, le composant de programmabilité du panneau de saisie gère la définition des propriétés de texte requises par le panneau de saisie pour que la correction dans le document soit activée pour ce texte.

La section suivante décrit ce processus en détail pour une application C++ qui utilise la version COM de l’API [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) . Les étapes d’utilisation de la version .NET Framework de l’API en C \# diffèrent pour l’utilisation de la version com en C++. L’API **HandwrittenTextInsertion** managée comprend une seule interface com, **IHandwrittenTextInsertion**. La définition de cette interface se trouve dans PenInputPanel. h et PenInputPanel \_ i.c.

Tout d’abord, l’application doit utiliser la fonction [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) pour produire une instance de [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) avec l’ID de classe **CLSID \_ HandwrittenTextInsertion**. Notez que la création d’un **objet \_ HandwrittenTextInsertion CLSID** échouera uniquement après la création d’une fenêtre et le focus, car jusqu’à ce que le magasin de stockage des services de texte ne soit pas activé. En outre, si tiptsf.dll n’est pas présent sur le système, la fonction **CoCreateInstance** échoue et retourne **RegDB \_ E \_ CLASSNOTREG**, ce qui indique que la correction dans le document du panneau de saisie n’est pas prise en charge sur le système. À ce stade, l’application doit se poursuivre sans essayer d’activer la correction de document dans le panneau de saisie. L’instance de **HandwrittenTextInsertion** doit être accessible à partir du code de l’application qui gère l’insertion de texte dans un champ de texte.

> [!Note]  
> Lorsque vous utilisez la version .NET Framework de l’API, l’application doit ajouter une instruction using pour autoriser l’accès à l’espace de noms [Microsoft. Ink. TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) , puis créer l’objet directement.

 

Deuxièmement, le code de l’application responsable de l’insertion de texte dans un champ de texte doit être modifié de sorte qu’il n’insère plus de texte dans un champ de texte directement, mais appelle à la place l’une ou l’autre des deux méthodes d’insertion de [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion). La possibilité pour les applications de choisir d’appeler [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) ou [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) varie selon que l’application a ou non la reconnaissance pour le texte stocké en tant que tableau ou comme objet [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) .

> [!Note]  
> Lorsque vous travaillez dans du code managé, l’objet de reconnaissance correspondant consommé par InsertRecognitionResultsArray est [RecognitionResult](/previous-versions/ms552537(v=vs.100)). Les deux méthodes consomment les trois paramètres suivants :

 

-   *autres* Est une collection de chaînes à deux dimensions, stockée en tant que tableau de tableaux ou en tant qu’objet [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (ou [RecognitionResult](/previous-versions/ms552537(v=vs.100))). Si les alternatives sont stockées sous la forme d’un tableau de tableaux, ils doivent être passés comme un pointeur de tableau sécurisé. Chaque entrée du tableau de niveau supérieur est une liste d’alternatives pour un mot unique dans l’insertion. L’entrée à la position zéro dans les sous-tableaux de remplaçants est le texte inséré dans le champ de texte. Les autres alternatives (index 1 à n dans chaque sous-tableau) sont stockées dans le magasin de stockage services de texte et sont proposées à l’utilisateur en tant que choix dans le cadre de la correction dans le document. Si des remplacements ne sont pas inclus, l’utilisateur voit « aucune suggestion » à la place de la liste des alternatives. Si une insertion contient plusieurs mots avec des espaces entre eux, chaque espace doit être inclus en tant qu’entrée dans le tableau de niveau supérieur.
-   *langue* [LCID](/previous-versions/ms221397(v=vs.71)) de la langue d’entrée qui correspond au texte contenu dans le paramètre de *remplacement* . Dans le cas où le contenu de *alternatifs* a été généré par un module de reconnaissance vocale ou d’écriture manuscrite, il s’agit également de la propriété [**languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) associée au module de reconnaissance utilisé.
-   *fLatticeContainsAutoSpacingInformation* Indicateur qui spécifie si le texte contenu dans le paramètre de *remplacements* a été généré par un module de reconnaissance avec l’espacement automatique activé. Si l’espacement automatique a été activé, l’indicateur doit avoir la valeur **true**. Si l’espacement automatique a été désactivé, l’indicateur doit être défini sur **false**. Dans le cas où le contenu de *alternatifs* a été généré par un module de reconnaissance qui ne prend pas en charge l’espacement automatique, ou n’a pas été généré par un module de reconnaissance, l’indicateur doit être défini sur **false**.

Le modèle de programmabilité du panneau de saisie peut insérer le texte dans le document ou l’application à partir de la position du signe insertion du système.

Les deux méthodes retournent **S \_ OK** si l’insertion est réussie. Elles retournent **e \_ nointerface** si l’application n’est pas basée sur les services de texte ou si elle est activée, et **e \_ INVALIDARG** si la mise en forme ou l’inaccessibilité des *alternatives* est incorrecte. Ils peuvent également retourner **E \_ OUTOFMEMORY** s’il n’y a pas suffisamment de mémoire disponible sur le système, ou **e \_ échoue** après une défaillance catastrophique telle que Text Services Framework n’est pas activé.

### <a name="conclusion"></a>Conclusion

L’activation de la correction dans le document du panneau de saisie pour le texte non entré à l’aide du panneau de saisie est un moyen économique et facile pour une application de type services de texte ou activé de compléter une méthode d’entrée manuscrite ou d’entrée personnalisée avec une fonctionnalité de correction à l’aide d’un stylet puissant. Sur Windows Vista, toutes les applications Edit et Trident les plus riches sont compatibles avec les services de texte. Bien que les surfaces intégrées d’encrage constituent une option intéressante pour l’ajout d’une expérience utilisateur de Tablet PC personnalisée à une application, elles prennent uniquement en charge la moitié de l’entrée de texte si elles n’incluent pas de fonctionnalités de correction. La correction dans le document fournit aux utilisateurs l’autre moitié de l’histoire en ajoutant la possibilité de permuter une sélection d’un autre élément de reconnaissance ou de réécrire une partie ou l’ensemble de la sélection.

## <a name="related-topics"></a>Rubriques connexes

<dl> <dt>

[Programmation du panneau de saisie de texte](programming-the-text-input-panel.md)
</dt> </dl>

 

 
