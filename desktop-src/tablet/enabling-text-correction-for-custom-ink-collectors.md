---
description: Le panneau de saisie de Microsoft Tablet PC est un outil puissant pour entrer du texte manuscrit avec un stylet et corriger du texte sans utiliser de clavier.
ms.assetid: c45ac1b5-7713-4bcb-a130-4692cff99aa2
title: Activation de la correction de texte pour les collecteurs d’encre personnalisés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb4dee4c7dfee1489cd002848c496be41f73d953
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104559664"
---
# <a name="enabling-text-correction-for-custom-ink-collectors"></a><span data-ttu-id="9147e-103">Activation de la correction de texte pour les collecteurs d’encre personnalisés</span><span class="sxs-lookup"><span data-stu-id="9147e-103">Enabling Text Correction for Custom Ink Collectors</span></span>

<span data-ttu-id="9147e-104">Le panneau de saisie de Microsoft Tablet PC est un outil puissant pour entrer du texte manuscrit avec un stylet et corriger du texte sans utiliser de clavier.</span><span class="sxs-lookup"><span data-stu-id="9147e-104">Microsoft Tablet PC Input Panel is a powerful tool for entering handwritten text with a pen and correcting text without the use of a keyboard.</span></span> <span data-ttu-id="9147e-105">Lorsque vous utilisez le panneau de saisie, un utilisateur entre du texte par écriture manuscrite sur les surfaces d’encrage du panneau de saisie, ce qui amène le panneau de saisie à reconnaître l’écriture manuscrite de l’utilisateur sous forme de texte.</span><span class="sxs-lookup"><span data-stu-id="9147e-105">When using Input Panel, a user enters text by handwriting onto Input Panel's inking surfaces, which causes Input Panel to recognize the user's handwriting as text.</span></span> <span data-ttu-id="9147e-106">Une fois le texte reconnu, l’utilisateur clique sur insérer dans le panneau de saisie pour insérer le texte dans une application ou un document.</span><span class="sxs-lookup"><span data-stu-id="9147e-106">Once the text has been recognized, the user taps Insert on Input Panel to insert the text into an application or document.</span></span> <span data-ttu-id="9147e-107">Avant d’insérer le texte, un utilisateur a accès à un ensemble d’outils de correction dans le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9147e-107">Prior to inserting the text, a user has access to a set of correction tools in Input Panel.</span></span> <span data-ttu-id="9147e-108">Il peut s’agir de la sélection d’un autre résultat de reconnaissance, de la possibilité de réécrire un caractère unique, voire d’un effacement du mot entier et de la réécriture.</span><span class="sxs-lookup"><span data-stu-id="9147e-108">These include the selection of an alternative recognition result, the ability to rewrite a single character, or even to scratch-out the entire word and rewrite.</span></span> <span data-ttu-id="9147e-109">Ces outils de correction permettent à un utilisateur de corriger à la fois les erreurs de reconnaissance et les erreurs humaines.</span><span class="sxs-lookup"><span data-stu-id="9147e-109">These correction tools enable a user to correct both recognition errors and human errors.</span></span>

<span data-ttu-id="9147e-110">Une fois que le texte entré à l’aide du panneau de saisie se trouve dans le document, les utilisateurs ont accès aux mêmes fonctionnalités de correction disponibles avant l’insertion dans les applications Windows [Text Services Framework](/windows/desktop/TSF/text-services-framework)et les services de texte.</span><span class="sxs-lookup"><span data-stu-id="9147e-110">Once the text entered using Input Panel is in the document, users have access to the same correction functionality that is available prior to insertion in Windows [Text Services Framework](/windows/desktop/TSF/text-services-framework)-based and Text Services-enabled applications.</span></span> <span data-ttu-id="9147e-111">À compter de Microsoft Windows XP Service Pack 2 Tablet PC Edition, toutes les applications RichEdit sont des services de texte activés par défaut, et à partir de Windows Vista, les applications HTML sont compatibles avec les services de texte par défaut.</span><span class="sxs-lookup"><span data-stu-id="9147e-111">Starting in Microsoft Windows XP Service Pack 2 Tablet PC Edition all Rich Edit applications are Text Services-enabled by default, and starting in Windows Vista, HTML applications are Text Services-enabled by default.</span></span> <span data-ttu-id="9147e-112">La correction dans le document est uniquement disponible dans les applications basées sur le service de texte et les applications activées ; Cela est dû au fait que le panneau de saisie dépend de la capacité du service de texte à stocker les propriétés de texte associées, y compris les objets d’encre et les alternatives de reconnaissance, afin de fournir une correction de document.</span><span class="sxs-lookup"><span data-stu-id="9147e-112">In-document correction is only available in Text Service based and enabled applications; this is because Input Panel is dependent on Text Service's capability to store associated text properties, including ink objects and recognition alternates, in order to provide in-document correction.</span></span>

![panneau de saisie Tablet PC avec correction de texte](images/a0dced5e-16de-410b-965f-5d97d297cee5.jpg)

<span data-ttu-id="9147e-114">Toutefois, il existe de nombreux scénarios, notamment la correction de la reconnaissance vocale ou la correction du texte tapé en déplacement, qui ne commencent pas par une entrée de texte à l’aide du panneau de saisie, mais dans laquelle la correction dans le document peut être extrêmement utile pour les utilisateurs de Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="9147e-114">There are, however, numerous scenarios, including correcting speech recognition or correcting typed text on the go, that do not start with text entry using Input Panel but in which in-document correction can be extremely useful for Tablet PC users.</span></span> <span data-ttu-id="9147e-115">Un exemple premier se trouve dans les applications qui fournissent des surfaces d’encrage personnalisées pour l’entrée de texte à l’aide d’un stylet.</span><span class="sxs-lookup"><span data-stu-id="9147e-115">A prime example is in applications that provide custom inking surfaces for entering text using a pen.</span></span> <span data-ttu-id="9147e-116">Les surfaces d’encrage personnalisées sont un excellent moyen pour les applications de fournir des fonctionnalités personnalisées propres aux tâches de saisie de texte de chaque application.</span><span class="sxs-lookup"><span data-stu-id="9147e-116">Custom inking surfaces are a great way for applications to provide uniquely tailored functionality specific to the text entry tasks of each application.</span></span> <span data-ttu-id="9147e-117">En outre, les surfaces d’encrage personnalisées fournissent une expérience utilisateur Tablet PC entièrement intégrée, ce qui en fait clair, le stylet est un appareil d’entrée de première classe dans les applications qui les contiennent.</span><span class="sxs-lookup"><span data-stu-id="9147e-117">Additionally, custom inking surfaces provide a fully integrated Tablet PC user experience, which makes it clear the pen is a first class input device in applications that contain them.</span></span> <span data-ttu-id="9147e-118">Toutefois, les applications qui fournissent des surfaces d’encrage personnalisées peuvent ne pas autoriser ou ne pas être en mesure de fournir le même niveau de prise en charge de correction disponible à partir du panneau de saisie correction dans le document.</span><span class="sxs-lookup"><span data-stu-id="9147e-118">However, applications that provide custom inking surfaces may not allow or may not be able to provide the same level of correction support that is available from Input Panel in-document correction.</span></span>

![collecteur d’encre personnalisé](images/b6797b12-dda6-44c4-87f4-570fe0c23f3a.jpg)

<span data-ttu-id="9147e-120">Les applications basées sur les services de texte ou les applications activées dans lesquelles la correction dans le document est utile pour corriger le texte non entré à l’aide du panneau de saisie peuvent utiliser l’API [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) du panneau de saisie ([Microsoft. TextInput. HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) dans le code managé) pour activer la correction du texte entré par d’autres moyens.</span><span class="sxs-lookup"><span data-stu-id="9147e-120">Text Services based or enabled applications in which in-document correction is useful for correction of text not entered using Input Panel are able to use Input Panel's [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API ([Microsoft.TextInput.HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) class in managed code)to enable in-document correction for text entered by other means.</span></span> <span data-ttu-id="9147e-121">De cette façon, les applications peuvent ajouter de manière économique une prise en charge de correction puissante à leurs surfaces d’encrage personnalisées ou d’autres scénarios de saisie de texte, et arrondir leur histoire de saisie de texte Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="9147e-121">In this way, applications can cheaply add powerful correction support to their custom inking surfaces or other text entry scenarios, and round out their Tablet PC text entry story.</span></span> <span data-ttu-id="9147e-122">L’API IHandWrittenTextInsertion du panneau de saisie est incluse dans le cadre du système d’exploitation Windows Vista et dans le cadre du kit de développement logiciel (SDK) de plateforme Tablet 1,9 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="9147e-122">The Input Panel IHandWrittenTextInsertion API is included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or newer.</span></span> <span data-ttu-id="9147e-123">Une version .NET et COM de l’API est incluse.</span><span class="sxs-lookup"><span data-stu-id="9147e-123">Both a .NET and COM based version of the API are included.</span></span> <span data-ttu-id="9147e-124">L’activation de la correction dans le document pour le texte non entré à l’aide du panneau de saisie est prise en charge sur Windows Vista et les versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="9147e-124">Enabling in-document correction for text not entered using Input Panel is supported on Windows Vista and newer.</span></span> <span data-ttu-id="9147e-125">La correction dans le document est uniquement disponible pour les langues latines et n’est pas en mesure d’afficher un caractère en dehors du jeu de caractères latin.</span><span class="sxs-lookup"><span data-stu-id="9147e-125">In-document correction is only available for Latin languages and is unable to display any character outside the Latin character set.</span></span>

## <a name="how-to-use-the-handwrittentextinsertion-api-in-an-application"></a><span data-ttu-id="9147e-126">Utilisation de l’API HandwrittenTextInsertion dans une application</span><span class="sxs-lookup"><span data-stu-id="9147e-126">How to Use the HandwrittenTextInsertion API in an Application</span></span>

<span data-ttu-id="9147e-127">Les modifications requises pour une application afin d’intégrer le panneau de saisie à la correction des documents non entrés à l’aide du panneau de saisie et à l’aide de l’API [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) sont simples.</span><span class="sxs-lookup"><span data-stu-id="9147e-127">The required changes to an application in order to integrate Input Panel in-document correction for text not entered using Input Panel and using the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API are straightforward.</span></span> <span data-ttu-id="9147e-128">Tout le code d’entrée de texte personnalisé de l’application reste inchangé, à l’exception de la dernière étape.</span><span class="sxs-lookup"><span data-stu-id="9147e-128">All of the application's custom text entry code remains unchanged except for the last step.</span></span> <span data-ttu-id="9147e-129">À l’endroit où le texte entré à l’aide d’une surface d’encrage personnalisée, d’une reconnaissance vocale ou d’un autre moyen doit être affiché dans un champ de texte avec les services de texte, l’application envoie le texte à l’interface **IHandWrittenTextInsertion** au lieu de l’envoyer directement au champ de texte.</span><span class="sxs-lookup"><span data-stu-id="9147e-129">At the point at which text entered using a custom inking surface, speech recognition, or other means is to be displayed in a text services enabled text field, the application sends the text to the **IHandWrittenTextInsertion** interface instead of sending it directly to the text field.</span></span> <span data-ttu-id="9147e-130">Le composant de programmabilité du panneau de saisie gère alors l’insertion du texte dans le champ de texte et dans le magasin de stockage des services de texte.</span><span class="sxs-lookup"><span data-stu-id="9147e-130">The Input Panel programmability component then handles inserting the text into both the text field and the Text Services backing-store.</span></span> <span data-ttu-id="9147e-131">Lors de l’ajout du texte au magasin de stockage des services de texte, le composant de programmabilité du panneau de saisie gère la définition des propriétés de texte requises par le panneau de saisie pour que la correction dans le document soit activée pour ce texte.</span><span class="sxs-lookup"><span data-stu-id="9147e-131">When adding the text to the Text Services backing-store, the Input Panel programmability component handles setting the text properties that are required by Input Panel for in-document correction to be enabled for that text.</span></span>

<span data-ttu-id="9147e-132">La section suivante décrit ce processus en détail pour une application C++ qui utilise la version COM de l’API [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) .</span><span class="sxs-lookup"><span data-stu-id="9147e-132">The following section walks through this process in detail for a C++ application using the COM version of the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API.</span></span> <span data-ttu-id="9147e-133">Les étapes d’utilisation de la version .NET Framework de l’API en C \# diffèrent pour l’utilisation de la version com en C++.</span><span class="sxs-lookup"><span data-stu-id="9147e-133">There are notes anywhere the steps for using the .NET Framework version of the API in C\# differ for the using COM version in C++.</span></span> <span data-ttu-id="9147e-134">L’API **HandwrittenTextInsertion** managée comprend une seule interface com, **IHandwrittenTextInsertion**.</span><span class="sxs-lookup"><span data-stu-id="9147e-134">The managed **HandwrittenTextInsertion** API includes a single COM interface, **IHandwrittenTextInsertion**.</span></span> <span data-ttu-id="9147e-135">La définition de cette interface se trouve dans PenInputPanel. h et PenInputPanel \_ i.c.</span><span class="sxs-lookup"><span data-stu-id="9147e-135">The definition for this interface is located in PenInputPanel.h and PenInputPanel\_i.c.</span></span>

<span data-ttu-id="9147e-136">Tout d’abord, l’application doit utiliser la fonction [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) pour produire une instance de [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) avec l’ID de classe **CLSID \_ HandwrittenTextInsertion**.</span><span class="sxs-lookup"><span data-stu-id="9147e-136">First, the application should use the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) with class id **CLSID\_HandwrittenTextInsertion**.</span></span> <span data-ttu-id="9147e-137">Notez que la création d’un **objet \_ HandwrittenTextInsertion CLSID** échouera uniquement après la création d’une fenêtre et le focus, car jusqu’à ce que le magasin de stockage des services de texte ne soit pas activé.</span><span class="sxs-lookup"><span data-stu-id="9147e-137">Note that the creation of a **CLSID\_HandwrittenTextInsertion** object will succeed only after a window is created and given focus, because until then the Text Services backing-store is not activated.</span></span> <span data-ttu-id="9147e-138">En outre, si tiptsf.dll n’est pas présent sur le système, la fonction **CoCreateInstance** échoue et retourne **RegDB \_ E \_ CLASSNOTREG**, ce qui indique que la correction dans le document du panneau de saisie n’est pas prise en charge sur le système.</span><span class="sxs-lookup"><span data-stu-id="9147e-138">Additionally, if tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**, indicating that Input Panel in-document correction is not supported on the system.</span></span> <span data-ttu-id="9147e-139">À ce stade, l’application doit se poursuivre sans essayer d’activer la correction de document dans le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9147e-139">At this point the application should proceed without trying to enable Input Panel in-document correction.</span></span> <span data-ttu-id="9147e-140">L’instance de **HandwrittenTextInsertion** doit être accessible à partir du code de l’application qui gère l’insertion de texte dans un champ de texte.</span><span class="sxs-lookup"><span data-stu-id="9147e-140">The instance of **HandwrittenTextInsertion** must be accessible from the application's code that handles inserting text into a text field.</span></span>

> [!Note]  
> <span data-ttu-id="9147e-141">Lorsque vous utilisez la version .NET Framework de l’API, l’application doit ajouter une instruction using pour autoriser l’accès à l’espace de noms [Microsoft. Ink. TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) , puis créer l’objet directement.</span><span class="sxs-lookup"><span data-stu-id="9147e-141">When working with the .NET Framework version of the API, the application should add a using statement to allow access to the [Microsoft.Ink.TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) namespace and then create the object directly.</span></span>

 

<span data-ttu-id="9147e-142">Deuxièmement, le code de l’application responsable de l’insertion de texte dans un champ de texte doit être modifié de sorte qu’il n’insère plus de texte dans un champ de texte directement, mais appelle à la place l’une ou l’autre des deux méthodes d’insertion de [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion).</span><span class="sxs-lookup"><span data-stu-id="9147e-142">Second, the application's code that is responsible for inserting text into a text field must be altered so that it no longer inserts text into a text field directly, but calls one or the other of [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)'s two insertion methods instead.</span></span> <span data-ttu-id="9147e-143">La possibilité pour les applications de choisir d’appeler [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) ou [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) varie selon que l’application a ou non la reconnaissance pour le texte stocké en tant que tableau ou comme objet [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) .</span><span class="sxs-lookup"><span data-stu-id="9147e-143">Whether the applications should choose to call [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) or [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) depends on whether the application has the recognition alternates for the text stored as an array or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) object.</span></span>

> [!Note]  
> <span data-ttu-id="9147e-144">Lorsque vous travaillez dans du code managé, l’objet de reconnaissance correspondant consommé par InsertRecognitionResultsArray est [RecognitionResult](/previous-versions/ms552537(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="9147e-144">When working in managed code, the corresponding recognition object consumed by InsertRecognitionResultsArray is [RecognitionResult](/previous-versions/ms552537(v=vs.100)).</span></span> <span data-ttu-id="9147e-145">Les deux méthodes consomment les trois paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="9147e-145">Both methods consume the following three parameters:</span></span>

 

-   <span data-ttu-id="9147e-146">*autres* Est une collection de chaînes à deux dimensions, stockée en tant que tableau de tableaux ou en tant qu’objet [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (ou [RecognitionResult](/previous-versions/ms552537(v=vs.100))).</span><span class="sxs-lookup"><span data-stu-id="9147e-146">*alternates* Is a two dimensional collection of strings, stored either as an array of arrays or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (or [RecognitionResult](/previous-versions/ms552537(v=vs.100))) object.</span></span> <span data-ttu-id="9147e-147">Si les alternatives sont stockées sous la forme d’un tableau de tableaux, ils doivent être passés comme un pointeur de tableau sécurisé.</span><span class="sxs-lookup"><span data-stu-id="9147e-147">If the alternates are stored as an array of arrays, then it should be passed as a safe array pointer.</span></span> <span data-ttu-id="9147e-148">Chaque entrée du tableau de niveau supérieur est une liste d’alternatives pour un mot unique dans l’insertion.</span><span class="sxs-lookup"><span data-stu-id="9147e-148">Each entry in the top level array is a list of alternates for a single word in the insertion.</span></span> <span data-ttu-id="9147e-149">L’entrée à la position zéro dans les sous-tableaux de remplaçants est le texte inséré dans le champ de texte.</span><span class="sxs-lookup"><span data-stu-id="9147e-149">The entry at position zero in the sub-arrays of alternates is the text that is inserted into the text field.</span></span> <span data-ttu-id="9147e-150">Les autres alternatives (index 1 à n dans chaque sous-tableau) sont stockées dans le magasin de stockage services de texte et sont proposées à l’utilisateur en tant que choix dans le cadre de la correction dans le document.</span><span class="sxs-lookup"><span data-stu-id="9147e-150">The additional alternates (indices 1 through n in each sub-array) are stored in the Text Services backing-store and offered to the user as choices as part of in-document correction.</span></span> <span data-ttu-id="9147e-151">Si des remplacements ne sont pas inclus, l’utilisateur voit « aucune suggestion » à la place de la liste des alternatives.</span><span class="sxs-lookup"><span data-stu-id="9147e-151">If alternates are not included, then the user sees 'No suggestion' in place of the list of alternates.</span></span> <span data-ttu-id="9147e-152">Si une insertion contient plusieurs mots avec des espaces entre eux, chaque espace doit être inclus en tant qu’entrée dans le tableau de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="9147e-152">If an insertion contains multiple words with spaces between them, then each space must be included as an entry in the top level array.</span></span>
-   <span data-ttu-id="9147e-153">*langue* [LCID](/previous-versions/ms221397(v=vs.71)) de la langue d’entrée qui correspond au texte contenu dans le paramètre de *remplacement* .</span><span class="sxs-lookup"><span data-stu-id="9147e-153">*language* The Input Language [LCID](/previous-versions/ms221397(v=vs.71)) that corresponds to the text contained in the *alternates* parameter.</span></span> <span data-ttu-id="9147e-154">Dans le cas où le contenu de *alternatifs* a été généré par un module de reconnaissance vocale ou d’écriture manuscrite, il s’agit également de la propriété [**languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) associée au module de reconnaissance utilisé.</span><span class="sxs-lookup"><span data-stu-id="9147e-154">In the case in which the contents of *alternates* was generated by a handwriting or speech recognizer, this is also the [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) property associated with the recognizer used.</span></span>
-   <span data-ttu-id="9147e-155">*fLatticeContainsAutoSpacingInformation* Indicateur qui spécifie si le texte contenu dans le paramètre de *remplacements* a été généré par un module de reconnaissance avec l’espacement automatique activé.</span><span class="sxs-lookup"><span data-stu-id="9147e-155">*fLatticeContainsAutoSpacingInformation* A flag indicating whether the text contained in the *alternates* parameter was generated by a recognizer with auto-spacing enabled.</span></span> <span data-ttu-id="9147e-156">Si l’espacement automatique a été activé, l’indicateur doit avoir la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="9147e-156">If auto-spacing was enabled, then the flag should be set to **TRUE**.</span></span> <span data-ttu-id="9147e-157">Si l’espacement automatique a été désactivé, l’indicateur doit être défini sur **false**.</span><span class="sxs-lookup"><span data-stu-id="9147e-157">If auto-spacing was disabled, then the flag should be set to **FALSE**.</span></span> <span data-ttu-id="9147e-158">Dans le cas où le contenu de *alternatifs* a été généré par un module de reconnaissance qui ne prend pas en charge l’espacement automatique, ou n’a pas été généré par un module de reconnaissance, l’indicateur doit être défini sur **false**.</span><span class="sxs-lookup"><span data-stu-id="9147e-158">In the case in which the contents of *alternates* was generated by a recognizer that does not support auto-spacing, or was not generated by a recognizer at all, then the flag should be set to **FALSE**.</span></span>

<span data-ttu-id="9147e-159">Le modèle de programmabilité du panneau de saisie peut insérer le texte dans le document ou l’application à partir de la position du signe insertion du système.</span><span class="sxs-lookup"><span data-stu-id="9147e-159">Input Panel's programmability model is able to insert the text in the document or application from the position of the system caret.</span></span>

<span data-ttu-id="9147e-160">Les deux méthodes retournent **S \_ OK** si l’insertion est réussie.</span><span class="sxs-lookup"><span data-stu-id="9147e-160">Both methods return **S\_OK** if the insertion succeeds.</span></span> <span data-ttu-id="9147e-161">Elles retournent **e \_ nointerface** si l’application n’est pas basée sur les services de texte ou si elle est activée, et **e \_ INVALIDARG** si la mise en forme ou l’inaccessibilité des *alternatives* est incorrecte.</span><span class="sxs-lookup"><span data-stu-id="9147e-161">They return **E\_NOINTERFACE** if the application is not Text Services based or enabled, and **E\_INVALIDARG** if *alternates* is improperly formatted or inaccessible.</span></span> <span data-ttu-id="9147e-162">Ils peuvent également retourner **E \_ OUTOFMEMORY** s’il n’y a pas suffisamment de mémoire disponible sur le système, ou **e \_ échoue** après une défaillance catastrophique telle que Text Services Framework n’est pas activé.</span><span class="sxs-lookup"><span data-stu-id="9147e-162">They may also return **E\_OUTOFMEMORY** if there is not enough memory available on the system, or **E\_FAIL** after a catastrophic failure such as the Text Services Framework not being enabled.</span></span>

### <a name="conclusion"></a><span data-ttu-id="9147e-163">Conclusion</span><span class="sxs-lookup"><span data-stu-id="9147e-163">Conclusion</span></span>

<span data-ttu-id="9147e-164">L’activation de la correction dans le document du panneau de saisie pour le texte non entré à l’aide du panneau de saisie est un moyen économique et facile pour une application de type services de texte ou activé de compléter une méthode d’entrée manuscrite ou d’entrée personnalisée avec une fonctionnalité de correction à l’aide d’un stylet puissant.</span><span class="sxs-lookup"><span data-stu-id="9147e-164">Enabling Input Panel in-document correction for text not entered using Input Panel is a cheap and easy way for a Text Services based or enabled application to supplement a custom inking or input method with powerful pen-based correction functionality.</span></span> <span data-ttu-id="9147e-165">Sur Windows Vista, toutes les applications Edit et Trident les plus riches sont compatibles avec les services de texte.</span><span class="sxs-lookup"><span data-stu-id="9147e-165">On Windows Vista, all Rich Edit and Trident applications are Text Services enabled.</span></span> <span data-ttu-id="9147e-166">Bien que les surfaces intégrées d’encrage constituent une option intéressante pour l’ajout d’une expérience utilisateur de Tablet PC personnalisée à une application, elles prennent uniquement en charge la moitié de l’entrée de texte si elles n’incluent pas de fonctionnalités de correction.</span><span class="sxs-lookup"><span data-stu-id="9147e-166">While integrated inking surfaces are a great option for adding a custom Tablet PC user experience to an application, they only support half of text entry if they do not include correction capabilities.</span></span> <span data-ttu-id="9147e-167">La correction dans le document fournit aux utilisateurs l’autre moitié de l’histoire en ajoutant la possibilité de permuter une sélection d’un autre élément de reconnaissance ou de réécrire une partie ou l’ensemble de la sélection.</span><span class="sxs-lookup"><span data-stu-id="9147e-167">In-document correction provides users with the other half of the story by adding the ability to swap a selection for a recognition alternate, or to rewrite part or all of the selection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9147e-168">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="9147e-168">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9147e-169">Programmation du panneau de saisie de texte</span><span class="sxs-lookup"><span data-stu-id="9147e-169">Programming the Text Input Panel</span></span>](programming-the-text-input-panel.md)
</dt> </dl>

 

 
