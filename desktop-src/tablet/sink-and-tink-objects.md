---
description: Pour faciliter la prise en charge de l’encre dans les applications, il existe deux objets, qui peuvent être incorporés et pris en charge par n’importe quel conteneur OLE.
ms.assetid: fbd7bdf0-63b4-48d1-be91-eabbbb3f1618
title: Objets sInk et tInk
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4ef7ed1c06d256fe8eda9fad4bf15afa19fcb833
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106529469"
---
# <a name="sink-and-tink-objects"></a><span data-ttu-id="c3620-103">Objets sInk et tInk</span><span class="sxs-lookup"><span data-stu-id="c3620-103">sInk and tInk Objects</span></span>

<span data-ttu-id="c3620-104">Pour faciliter la prise en charge de l’encre dans les applications, il existe deux objets, qui peuvent être incorporés et pris en charge par n’importe quel conteneur OLE.</span><span class="sxs-lookup"><span data-stu-id="c3620-104">To aid the support of ink in applications, there are two objects, both of which can be embedded and are supported by any OLE container.</span></span> <span data-ttu-id="c3620-105">Ils sont générés en appelant la **méthode Ink. ClipboardCopy (Rectangle, InkClipboardFormats, InkClipboardModes)** ou la méthode **Ink. ClipboardCopy, méthode (Strokes, InkClipboardFormats, InkClipboardModes)** et sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="c3620-105">They are produced by calling either the **Ink.ClipboardCopy Method (Rectangle, InkClipboardFormats, InkClipboardModes)** or the **Ink.ClipboardCopy Method (Strokes, InkClipboardFormats, InkClipboardModes)** method and are:</span></span>

-   <span data-ttu-id="c3620-106">Objet texte Ink (tInk).</span><span class="sxs-lookup"><span data-stu-id="c3620-106">Text ink object (tInk).</span></span> <span data-ttu-id="c3620-107">Il s’agit d’un objet OLE représentant l’encre supposée former des mots.</span><span class="sxs-lookup"><span data-stu-id="c3620-107">This is an OLE object representing ink that is expected to form words.</span></span> <span data-ttu-id="c3620-108">Un objet tInk permet de convertir l’encre manuscrite en texte, soit en tant que texte retourné par un module de reconnaissance, soit en choisissant un choix dans une liste de substituts de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="c3620-108">A tInk object allows the handwritten ink to be converted to text, either as the text returned by a recognizer or the choice taken from a list of recognition alternates.</span></span> <span data-ttu-id="c3620-109">La couleur et la taille de l’encre peuvent être définies par programme et peuvent être basées sur les attributs du texte autour de l’objet.</span><span class="sxs-lookup"><span data-stu-id="c3620-109">The color and size of the ink can be set programmatically and can be based on the attributes of the text around the object.</span></span> <span data-ttu-id="c3620-110">L’objet tInk est destiné à contenir un mot unique. L’objet tInk est un petit objet léger qui peut effectuer des opérations simples telles que le rendu (à partir d’un handle vers un contexte de périphérique (HDC) et un RECT) et le rendre persistant (à partir d’un flux).</span><span class="sxs-lookup"><span data-stu-id="c3620-110">The tInk object is intended to contain a single word.The tInk object is a small, lightweight object that can perform simple operations like rendering (given a handle to a device context (HDC) and a RECT), and persisting itself (given a stream).</span></span> <span data-ttu-id="c3620-111">L’utilisation d’un objet tInk permet une expérience utilisateur transparente quand vous travaillez dans une application qui utilise l’entrée de l’écriture manuscrite et du texte.</span><span class="sxs-lookup"><span data-stu-id="c3620-111">Using a tInk object allows a seamless user experience when working in an application that uses input of both handwriting and text.</span></span>
-   <span data-ttu-id="c3620-112">Esquissez un objet d’encre (récepteur).</span><span class="sxs-lookup"><span data-stu-id="c3620-112">Sketch ink object (sInk).</span></span> <span data-ttu-id="c3620-113">Il s’agit d’un objet OLE représentant une entrée qui n’est pas censée former des mots.</span><span class="sxs-lookup"><span data-stu-id="c3620-113">This is an OLE object representing ink that is not expected to form words.</span></span> <span data-ttu-id="c3620-114">Un objet récepteur est interprété comme un dessin.</span><span class="sxs-lookup"><span data-stu-id="c3620-114">A sInk object is interpreted as a drawing.</span></span> <span data-ttu-id="c3620-115">Un objet récepteur est également utile pour représenter plusieurs mots.</span><span class="sxs-lookup"><span data-stu-id="c3620-115">A sInk object is also useful for representing multiple words.</span></span>

<span data-ttu-id="c3620-116">Ces objets peuvent être utilisés pour l’interopérabilité entre les applications, soit en les plaçant à l’emplacement de l’objet OLE dans le presse-papiers, soit en les incorporant au format RTF (Rich Text Format).</span><span class="sxs-lookup"><span data-stu-id="c3620-116">These objects can be used for interoperability between applications, either by placing them in the OLE object slot on the Clipboard or by embedding them in Rich Text Format (RTF).</span></span>

<span data-ttu-id="c3620-117">Vous pouvez utiliser les objets tInk et sInk des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="c3620-117">You can use tInk and sInk objects in the following ways:</span></span>

-   <span data-ttu-id="c3620-118">Les objets tInk et sInk sont pris en charge dans Microsoft Word 2002.</span><span class="sxs-lookup"><span data-stu-id="c3620-118">Both tInk and sInk objects are supported in Microsoft Word 2002.</span></span> <span data-ttu-id="c3620-119">Les utilisateurs peuvent insérer de l’encre dans un document Word à l’aide des panneaux de saisie de texte d’écriture et de dessin fournis dans Word 2002.</span><span class="sxs-lookup"><span data-stu-id="c3620-119">Users can insert ink into a Word document by using the writing and drawing text input panels provided in Word 2002.</span></span> <span data-ttu-id="c3620-120">Cette encre est incorporée dans le fichier Word en tant qu’objet OLE avec le CLSID de l’objet récepteur ou tInk.</span><span class="sxs-lookup"><span data-stu-id="c3620-120">This ink is embedded into the Word file as an OLE object with the CLSID of either the sInk or tInk object.</span></span>
-   <span data-ttu-id="c3620-121">Le contrôle de Tablet PC [InkEdit](/previous-versions/ms552265(v=vs.100)) utilise l’objet Tink.</span><span class="sxs-lookup"><span data-stu-id="c3620-121">The Tablet PC [InkEdit](/previous-versions/ms552265(v=vs.100)) control makes use of the tInk object.</span></span> <span data-ttu-id="c3620-122">Le contrôle InkEdit est une sous-classe du contrôle [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) standard.</span><span class="sxs-lookup"><span data-stu-id="c3620-122">The InkEdit control is a subclass of the standard [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) control.</span></span> <span data-ttu-id="c3620-123">L’entrée manuscrite est insérée dans le flux RTF du contrôle InkEdit en tant qu’objet tInk.</span><span class="sxs-lookup"><span data-stu-id="c3620-123">Ink is inserted into the InkEdit control's RTF stream as a tInk object.</span></span>
-   <span data-ttu-id="c3620-124">Lorsqu’une application déplace un objet [Ink](/previous-versions/aa515768(v=msdn.10)) sélectionné dans le presse-papiers, l’emplacement OLE Object Clipboard contient un objet OLE TInk ou sInk.</span><span class="sxs-lookup"><span data-stu-id="c3620-124">When an application moves a selected [Ink](/previous-versions/aa515768(v=msdn.10)) object onto the Clipboard, the OLE object Clipboard slot contains a tInk or sInk OLE object.</span></span>

<span data-ttu-id="c3620-125">Par exemple, votre application peut reconnaître l’écriture manuscrite et marquer tout objet [Ink](/previous-versions/aa515768(v=msdn.10)) comme objet Tink.</span><span class="sxs-lookup"><span data-stu-id="c3620-125">For example, your application can recognize handwriting and mark any [Ink](/previous-versions/aa515768(v=msdn.10)) object as a tInk object.</span></span> <span data-ttu-id="c3620-126">Ensuite, si vous sélectionnez un mot dans l’encre, puis le copiez et collez-le dans Word, des variantes de ce mot s’affichent dans Word 2002.</span><span class="sxs-lookup"><span data-stu-id="c3620-126">Then, if you select a word in ink and copy and paste it to Word, alternates for that word are shown in Word 2002.</span></span>

> [!Note]  
> <span data-ttu-id="c3620-127">La prise en charge du presse-papiers de la plateforme Tablet PC sélectionne automatiquement l’indicateur EMF (Enhanced Metafile) quand vous placez un objet récepteur ou tInk dans le presse-papiers en tant qu’objet OLE.</span><span class="sxs-lookup"><span data-stu-id="c3620-127">The Tablet PC Platform's Clipboard support automatically selects the Enhanced Metafile (EMF) flag for you when you place a sInk or tInk object on the Clipboard as an OLE object.</span></span> <span data-ttu-id="c3620-128">L’objet lui-même est stocké dans le presse-papiers dans les emplacements incorporer la source et le descripteur d’objet.</span><span class="sxs-lookup"><span data-stu-id="c3620-128">The object itself is stored on the Clipboard in the embed source and object descriptor slots.</span></span>

 

<span data-ttu-id="c3620-129">Autre exemple, en utilisant l’objet récepteur, vous pouvez dessiner une esquisse manuscrite dans une application, copier et coller l’esquisse dans Word 2002, puis modifier le dessin à l’aide du panneau de saisie Tablet PC dans Word.</span><span class="sxs-lookup"><span data-stu-id="c3620-129">As another example, by using the sInk object, you can draw an ink sketch in an application, copy and paste the sketch to Word 2002, and then edit the drawing by using Tablet PC Input Panel in Word.</span></span>

<span data-ttu-id="c3620-130">Pour pouvoir contenir des objets tInk, une application doit implémenter la prise en charge des conteneurs OLE pour les objets incorporés.</span><span class="sxs-lookup"><span data-stu-id="c3620-130">In order to successfully contain tInk objects, an application must implement OLE container support for embedded objects.</span></span> <span data-ttu-id="c3620-131">Ensuite, pour que le conteneur prenne entièrement en charge tInk, vous devez ester :</span><span class="sxs-lookup"><span data-stu-id="c3620-131">Then, to make the container fully support tInk, you must institute:</span></span>

-   <span data-ttu-id="c3620-132">Modifications apportées au code pour rechercher et remplacer.</span><span class="sxs-lookup"><span data-stu-id="c3620-132">Modifications to the code for Find and Replace.</span></span> <span data-ttu-id="c3620-133">Au lieu d’ignorer les objets incorporés dans la recherche, ces objets doivent être interrogés pour le type.</span><span class="sxs-lookup"><span data-stu-id="c3620-133">Instead of skipping embedded objects in the search, these objects must be interrogated for type.</span></span> <span data-ttu-id="c3620-134">S’il s’agit d’un objet tInk, ils doivent être instanciés et interrogés pour le texte correspondant.</span><span class="sxs-lookup"><span data-stu-id="c3620-134">If they are a tInk object, they must be instantiated and queried for their corresponding text.</span></span>
-   <span data-ttu-id="c3620-135">Modifications du comportement de la sélection.</span><span class="sxs-lookup"><span data-stu-id="c3620-135">Modifications to selection behavior.</span></span> <span data-ttu-id="c3620-136">La sélection d’objets tInk ne doit jamais apparaître avec des poignées de redimensionnement.</span><span class="sxs-lookup"><span data-stu-id="c3620-136">Selection of tInk objects should never appear with sizing handles.</span></span> <span data-ttu-id="c3620-137">Elles doivent être sélectionnées de la même façon que le texte est sélectionné dans le document.</span><span class="sxs-lookup"><span data-stu-id="c3620-137">They should be selected in the same way that text is selected in the document.</span></span> <span data-ttu-id="c3620-138">Le code de sélection des objets doit détecter si le type est tInk et afficher la sélection de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="c3620-138">Selection code for objects must detect if the type is tInk and display the selection appropriately.</span></span>
-   <span data-ttu-id="c3620-139">Utilisation des propriétés ambiantes.</span><span class="sxs-lookup"><span data-stu-id="c3620-139">Use of ambient properties.</span></span> <span data-ttu-id="c3620-140">Les propriétés ambiantes telles que la taille de la police, la couleur et la mise en forme en gras doivent être transmises à l’objet tInk.</span><span class="sxs-lookup"><span data-stu-id="c3620-140">Ambient properties such as font size, color, and bold formatting need to be transmitted to the tInk object.</span></span> <span data-ttu-id="c3620-141">L’application de ces propriétés modifie la largeur de l’encre manuscrite. une mise à jour de la taille est donc requise en appelant la méthode [**GetInkExtent**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) ou [IOleObject :: GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) .</span><span class="sxs-lookup"><span data-stu-id="c3620-141">Application of these properties changes the width of the handwritten ink, so a size update is required by calling the [**GetInkExtent Method**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) or [IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) method.</span></span>
-   <span data-ttu-id="c3620-142">Remplacez le traitement par défaut de la méthode [IOleObject ::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) .</span><span class="sxs-lookup"><span data-stu-id="c3620-142">Override the default [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) method processing.</span></span> <span data-ttu-id="c3620-143">Cela permet la conversion en texte pour transmettre un lot d’objets tInk au module de reconnaissance, qui peut ensuite décomposer les mots en segments de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="c3620-143">This allows conversion to text to pass a batch of tInk objects to the recognizer, which can then break the words into recognition segments.</span></span>

<span data-ttu-id="c3620-144">Pour plus d’informations sur la césure des mots dans des segments de reconnaissance, consultez [segments de reconnaissance](recognition-segments.md).</span><span class="sxs-lookup"><span data-stu-id="c3620-144">For more information about breaking words into recognition segments, see [Recognition Segments](recognition-segments.md).</span></span>

 

 
