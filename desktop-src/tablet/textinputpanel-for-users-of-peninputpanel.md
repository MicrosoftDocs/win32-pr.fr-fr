---
description: La version de Windows Vista inclut un nouvel objet de programmabilité pour le panneau de saisie Tablet PC qui offre une nouvelle plage de possibilités quant à la façon dont une application peut utiliser et interagir avec le panneau de saisie.
ms.assetid: 539f41d3-5fb8-4e20-99ba-0d5af1f0cc54
title: TextInputPanel pour les utilisateurs de PenInputPanel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14ed213db49427d997f0ea1dda414cf1a6a0c2d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104320606"
---
# <a name="textinputpanel-for-users-of-peninputpanel"></a>TextInputPanel pour les utilisateurs de PenInputPanel

La version de Windows Vista inclut un nouvel objet de programmabilité pour le panneau de saisie Tablet PC qui offre une nouvelle plage de possibilités quant à la façon dont une application peut utiliser et interagir avec le panneau de saisie. Pour la première fois, les développeurs d’applications peuvent positionner le In-Place icône du panneau de saisie pour les aligner avec une zone de texte ou les placer dans le coin d’une surface d’encrage de client pour offrir l’accès à un autre mode de saisie. Les développeurs ont le même contrôle sur le positionnement une fois que l’icône du panneau de saisie est développée dans le In-Place panneau de saisie. Cela permet de s’assurer que le In-Place panneau de saisie ne chevauche jamais les éléments clés de l’interface utilisateur dans la disposition d’une application, ou même de redistribuer l’interface utilisateur d’une application pour libérer de l’espace pour le panneau de saisie In-Place, puis le placer dans l’espace réservé. Le nouveau modèle de programmabilité offre une prise en charge plus qu’un simple positionnement. Toutefois, les développeurs peuvent également personnaliser la zone d’entrée, le mode de correction et de nombreuses autres propriétés du panneau de saisie pour adapter l’expérience de saisie du texte dans une application. Enfin, pour la première fois, il est possible pour une application de recevoir l’encre de l’utilisateur, en plus du texte reconnu, associée à des insertions de texte à partir du panneau de saisie. Cela permet de créer de nouveaux scénarios d’application, y compris l’encre dans les journaux de suivi des modifications et de permettre aux utilisateurs de modifier ou d’afficher l’encre dans l’application. Ces nouvelles fonctionnalités de programmabilité sont le résultat direct des commentaires que Microsoft a reçus de l’histoire du développeur du panneau de saisie et représentent la première étape vers une intégration plus étroite des applications et du panneau de saisie.

Pour fournir ce modèle de programmabilité du panneau de saisie enrichi, le mécanisme existant pour interagir par programmation avec le panneau de saisie, l’objet [**PenInputPanel**](peninputpanel-class.md) , est déconseillé et remplacé par le nouvel objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) . En plus de fournir de nouvelles fonctionnalités de programmabilité, l’objet **TextInputPanel** fournit également une approche proche de toutes les fonctionnalités de programmation de l’objet **PenInputPanel** . L’objet **TextInputPanel** est inclus à la fois dans Windows Vista et dans le kit de développement logiciel Windows Vista. L’objet **TextInputPanel** est uniquement compatible avec le panneau de saisie Windows Vista et ne peut pas être utilisé avec le panneau de saisie Windows XP Service Pack 2 ou une version antérieure. L’application précédemment écrite pour utiliser l’objet **PenInputPanel** continuera à fonctionner avec le panneau de saisie Windows Vista. Toutefois, lors de l’écriture de nouvelles applications Tablet, les développeurs sont fortement encouragés à utiliser le nouvel objet **TextInputPanel** au lieu de l’objet **PenInputPanel** déconseillé.

Chacune des options de programmabilité de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) peut être appliquée pour chaque champ de texte. Pour ce faire, attachez une instance de l’objet **TextInputPanel** à l’aide de la propriété [**AttachedEditWindow**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_attachededitwindow) . La propriété doit être définie sur le handle de fenêtre pour le champ de texte.

> [!Note]  
> : Plusieurs des propriétés et méthodes décrites ci-dessous s’appliquent lorsque le panneau de saisie est en mode d’interaction sur place et non lorsque le panneau de saisie est en mode d’interaction flottant ou ancré. Le mode d’interaction sur place est le comportement du panneau de saisie où placer le focus dans un champ modifiable provoque l’affichage de l’icône du panneau de saisie en regard du champ, et le fait de cliquer sur l’icône du panneau de saisie provoque le développement du panneau de saisie. Les méthodes et les propriétés qui s’appliquent uniquement lorsque le panneau de saisie est dans le mode d’interaction sur place contiennent toutes « InPlace » dans le nom de la méthode ou de la propriété.

 

## <a name="control-of-input-panel-icon-and-input-panel-visibility"></a>Contrôle de l’icône du panneau de saisie et de la visibilité du panneau de saisie

Le premier aspect du panneau de saisie dans lequel les développeurs d’applications ont plus de contrôle dans Windows Vista est sa visibilité. À l’aide de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) , il est possible de contrôler la visibilité du panneau de saisie In-Place de trois façons. Avec une combinaison de propriétés et de méthodes, une application peut déterminer si le In-Place panneau de saisie s’affiche, lorsque le panneau de saisie In-Place affiche et s’il apparaît en premier en tant qu’icône du panneau de saisie ou s’il affiche immédiatement le développement. En combinant ces techniques pour contrôler la visibilité avec les techniques permettant de contrôler le positionnement abordé dans la section suivante, les développeurs d’applications peuvent créer des points de lancement personnalisés et des flux de travail personnalisés à l’aide du panneau de saisie In-Place dans une application.

> [!Note]  
> Les propriétés et les méthodes décrites dans cette section s’appliquent uniquement lorsque le panneau de saisie est en mode d’interaction In-Place.

 

Tout d’abord, il est possible d’empêcher l’affichage de la In-Place panneau de saisie et de l’icône du panneau de saisie en affectant à la propriété [**InPlaceVisibleOnFocus**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplacevisibleonfocus) la **valeur false**. Si elle est définie sur **true** , elle revient à la valeur par défaut du système qui s’affiche lorsque cela est possible, à condition qu’elle n’ait pas été désactivée par l’utilisateur ou le stratégie de groupe. Cette option est utile pour les applications qui incluent des solutions d’entrée de texte personnalisées comme alternative au panneau de saisie.

Deuxièmement, en définissant la propriété [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) , un développeur peut spécifier l’État sur place, comme spécifié par l’énumération [**InPlaceState**](/windows/win32/api/peninputpanel/ne-peninputpanel-inplacestate) , le panneau de saisie In-Place s’affiche dans lorsque le focus est placé dans un champ de texte. La valeur système par défaut est que le panneau de saisie In-Place s’affiche dans l’état de survol, à moins que le panneau de saisie soit déjà visible dans l’état développé, auquel cas le panneau de saisie reste développé. La définition de la propriété **DefaultInPlaceState** sur InPlaceState a pour effet de faire en sorte que le panneau de saisie In-Place s’affiche toujours en premier, plutôt que l’icône du panneau de saisie apparaissant en premier, puis en demandant à l’utilisateur d’appuyer sur l’icône du panneau de saisie avant le développement du panneau de saisie. **\_** Les deux autres options sont **InPlaceState \_ auto**, qui est le comportement par défaut du système et **InPlaceState \_ HoverTarget** , qui provoque toujours l’affichage de l’icône du panneau de saisie. La possibilité de spécifier que le panneau de saisie In-Place apparaît toujours développé est une nouveauté avec l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) et n’est pas possible à l’aide de l’objet [**PenInputPanel**](peninputpanel-class.md) . L’illustration suivante montre les In-Place icône du panneau de saisie et les États développés du panneau.

![icône du panneau de saisie sur place et États développés](images/8ce866b6-9a45-499f-a3d1-95a1d34d6402.jpg)

En plus de pouvoir contrôler l’État sur place, il est également possible pour un développeur de déterminer l’État sur place à un moment donné en obtenant la propriété [**CurrentInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) . **CurrentInPlaceState** est égal à [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) lorsque le panneau de saisie n’est pas visible, sauf lorsque le **DefaultInPlaceState** est **InPlaceState \_ auto** , auquel cas le **CurrentInPlaceState** devient **InPlaceState \_ HoverTarget**. Les [](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  événements [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged) InPlaceVisibilityChanging peuvent être utilisés pour effectuer le suivi de l’état de visibilité du panneau de saisie In-Place.

Enfin, un développeur peut forcer le In-Place panneau de saisie à masquer ou à afficher à l’aide de la méthode [**SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) . Si le développeur a défini précédemment la propriété [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) , le panneau de saisie s’affiche dans l’état spécifié quand l’affichage est forcé. Une application est uniquement autorisée à masquer ou afficher le In-Place panneau de saisie lorsque le focus est actuellement dans la fenêtre à laquelle l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) est attaché, et lorsque l’utilisateur n’a pas de panneau de saisie ouvert dans un autre mode d’interaction, tel que ancré ou flottant. La possibilité de forcer le In-Place panneau de saisie pour masquer ou afficher est également une nouveauté avec l’objet **TextInputPanel** et n’est pas possible à l’aide de l’objet [**PenInputPanel**](peninputpanel-class.md) .

Ces options offrent aux développeurs d’applications un contrôle affiné sur le moment où s’affiche l' In-Place panneau de saisie et dans quel état. En personnalisant l’État sur place par défaut et en contrôlant la visibilité sur place indépendamment des modifications de focus, un développeur d’applications peut créer un workflow personnalisé lorsque le panneau de saisie répond à des paramètres d’application ou à une entrée utilisateur dans une application.

## <a name="absolute-positioning-of-input-panel-icon-and-input-panel"></a>Positionnement absolu de l’icône du panneau de saisie et du panneau de saisie

La nouvelle fonctionnalité la plus intéressante de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) est probablement le positionnement absolu du panneau de saisie In-Place. Avec cette nouvelle fonctionnalité, un développeur d’applications peut s’assurer que le In-Place panneau de saisie ne se chevauche pas avec un ou plusieurs éléments visuels clés dans la disposition d’une application. À l’aide de l’objet [**PenInputPanel**](peninputpanel-class.md) , il était possible de positionner le In-Place panneau de saisie par rapport à un champ de texte en fonction d’un décalage. Toutefois, le panneau de saisie s’ajuste toujours pour rester à l’écran. Pour la première fois dans Vista, une application peut positionner le In-Place panneau de saisie à une position absolue à l’aide des coordonnées d’écran. En outre, la responsabilité de conserver le panneau de saisie sur l’écran est laissée au développeur de l’application, ce qui supprime le risque de repositionnement automatique du panneau de saisie et apparemment aléatoire.

> [!Note]  
> Les propriétés et les méthodes décrites dans cette section s’appliquent uniquement lorsque le panneau de saisie est en mode d’interaction In-Place.

 

Les deux principales méthodes nécessaires pour positionner de manière absolue le In-Place panneau de saisie sont [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) et [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition). Le premier est utilisé pour spécifier l’emplacement du In-Place panneau de saisie et le second est utilisé pour spécifier l’emplacement de l’icône du panneau de saisie pour le panneau de saisie In-Place. Si une application choisit de définir uniquement l’emplacement de l’icône du panneau de saisie et non l’emplacement du panneau de saisie In-Place, le panneau de saisie In-Place apparaît dans l’emplacement par défaut déterminé par le système. De même, si une application repositionne le In-Place panneau de saisie mais pas l’icône du panneau de saisie, l’icône du panneau de saisie apparaît à l’emplacement par défaut. L’emplacement est spécifié en coordonnées d’écran. Le point réel positionné est le coin supérieur gauche de l’icône du panneau de saisie ou du panneau de saisie, sans peigne de correction développé. Lorsque le peigne de correction est développé, le point positionné ne change pas. (Voir figure 2 ci-dessous) Il n’existe aucune restriction sur l’emplacement où le In-Place panneau de saisie et l’icône du panneau de saisie In-Place peuvent être des emplacements et c’est la responsabilité des applications qui appellent ces méthodes pour les conserver à l’écran. Les deux méthodes sont synchrones, ce qui signifie que le positionnement se produit avant le retour de la méthode. Dans le cas où le panneau de saisie est déjà ouvert en mode d’interaction flottant ou ancré, une tentative de positionnement du In-Place panneau de saisie ou de l' In-Place icône du panneau de saisie échoue. En outre, les méthodes échouent si la fenêtre attachée à l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) n’a pas le focus actuellement.

Un appel à [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) ou [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition) n’entraîne pas automatiquement l’affichage du panneau de saisie In-Place ou de l’icône du panneau de saisie, il définit simplement la position pour la prochaine fois qu’ils sont affichés. L’appel de [**SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) peut être utilisé pour les forcer à s’afficher immédiatement.

![mesures du panneau de saisie sur place](images/0c67a77a-5d2f-489f-9357-b8a168d024d3.jpg)

Lorsque vous positionnez le In-Place panneau de saisie en calculant s’il s’éloigne de l’écran, cela peut être un peu délicat. Pour faciliter ce processus, plusieurs propriétés de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) peuvent être utilisées pour simplifier ce processus. Ces propriétés et cet événement peuvent être utilisés pour déterminer la taille exacte du In-Place panneau de saisie dans tous ses États :

-   [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle): cette propriété fournit le rectangle englobant pour le panneau de saisie In-Place lorsque la plus grande zone d’entrée pour la langue d’entrée en cours est affichée. Si le pavé d’écriture ou le caractère est déterminé par la plus grande zone d’entrée, la hauteur du bouton Insérer est incluse. Elle n’inclut pas la hauteur du peigne de correction. Lorsque le In-Place panneau de saisie croît automatiquement, la paire d’événements [**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)  /  [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged) est déclenchée et la valeur de cette propriété est mise à jour pour inclure la zone d’écriture supplémentaire ou la ligne d’écriture.
-   [**PopUpCorrectionHeight**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_popupcorrectionheight): cette propriété spécifie la hauteur du peigne de correction après insertion lorsqu’elle est positionnée au-dessus du panneau de saisie. Pour obtenir la hauteur complète du panneau de saisie In-Place avec le peigne de correction postérieur à l’insertion, ajoutez la hauteur du [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) au **PopUpCorrectionHeight**.

En guise d’alternative plus simple à la définition de la position absolue du In-Place panneau de saisie et de l’icône du panneau de saisie, une application peut simplement spécifier si le panneau de saisie In-Place par défaut s’affiche au-dessus ou en dessous d’un champ d’entrée de texte. De cette façon, il est possible d’éviter le chevauchement des éléments dans la disposition de l’application de manière plus souple. Pour ce faire, l’application définit [**PreferredInPlaceDirection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_preferredinplacedirection) sur **InPlaceDirection \_ Bottom** ou **InPlaceDirection \_ Top**. La propriété est une préférence, car le In-Place panneau de saisie remplace la préférence définie par l’application, si nécessaire, pour conserver le panneau de saisie à l’écran. La valeur système par défaut consiste à positionner le In-Place panneau de saisie sous un champ de texte lorsque cela est possible et à le placer au-dessus. La définition de **PreferredInPlaceDirection** sur InPlaceDirection restaure **\_ automatiquement** les valeurs par défaut du système.

Ensemble, les propriétés, les méthodes et les événements de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) offrent aux développeurs le contrôle nécessaire sur le In-Place panneau de saisie pour pouvoir positionner intelligemment l' In-Place panneau de saisie et l’icône du panneau de saisie dans une disposition d’application afin qu’ils n’interrompent pas le déroulement de la disposition et, dans certains cas, peuvent être intégrés. Ce nouveau niveau de contrôle est un grand gain pour la conception d’applications de tablette.

## <a name="access-to-the-three-input-panel-areas-writing-pad-character-pad-and-keyboard"></a>Accès aux trois zones du panneau de saisie : pavé d’écriture, pavé de caractères et clavier

Le panneau de saisie comporte trois zones d’entrée : le pavé d’écriture, le pavé de caractères et le clavier. À l’aide de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) , une application peut spécifier la zone d’entrée par défaut qui est présentée à l’utilisateur lorsque le panneau de saisie s’ouvre. La raison principale pour laquelle une application doit le faire consiste à coupler la zone d’entrée au type d’entrée d’un champ spécifique. Par exemple, le bloc d’écriture est probablement mieux adapté au remplissage d’un champ de commentaires, mais il peut être plus commode d’entrer un numéro de série de produit contenant à la fois des chiffres et des lettres. Pour spécifier la zone d’entrée par défaut, une application définit la propriété [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) sur l’une des trois zones d’entrée comme défini par l’énumération [**PanelInputArea**](/windows/win32/api/peninputpanel/ne-peninputpanel-panelinputarea) . L’illustration suivante montre les trois zones d’entrée.

![écriture, caractère et panneau de saisie du clavier](images/3f1e3d03-88b9-478c-b12d-00d341bc8d5c.jpg)

La zone d’entrée par défaut du système est le bloc d’écriture pour l’anglais, le français, l’allemand, l’espagnol, l’italien, le portugais, le néerlandais et toutes les autres langues d’entrée latines. Pour les langues d’entrée de l’Asie de l’est, y compris le japonais, le chinois et le coréen, la zone d’entrée par défaut est le pavé de caractères. Toutefois, lorsque l’utilisateur modifie la zone d’entrée, il remplace la zone d’entrée par défaut pour la langue d’entrée actuelle et est stockée en tant que nouvelle valeur par défaut pour cette langue d’entrée. Le clavier est la zone d’entrée par défaut pour les champs de mot de passe, quelle que soit la langue d’entrée, sauf si la sécurité du mot de passe a été désactivée par l’utilisateur ou la stratégie de groupe. Dans tous les cas, la définition par programmation de la zone de texte par défaut remplace la valeur système par défaut, sauf si le champ actuel est un champ de mot de passe ou si le module de reconnaissance de l’écriture manuscrite pour la langue d’entrée actuelle ne prend pas en charge la zone d’entrée sélectionnée par programmation. La définition de la propriété [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) sur InPlaceDirection restaure **\_ automatiquement** les paramètres par défaut du système.

Que la zone du panneau de saisie par défaut ait été définie par programme ou non, l’utilisateur a la possibilité de modifier la zone du panneau de saisie en cours lorsque le panneau de saisie est ouvert. Une fois que l’utilisateur a modifié la zone d’entrée actuelle, la sélection de l’utilisateur persiste jusqu’à ce que le panneau de saisie se ferme ou que l’utilisateur modifie à nouveau la sélection. Après la fermeture et la réouverture du panneau de saisie, la zone d’entrée par défaut définie par programmation est réaffichée.

Étant donné que la zone du panneau de saisie en cours peut être différente de la zone du panneau de saisie par défaut, une application peut interroger la propriété [**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea) pour déterminer quelle zone d’entrée est actuellement visible. Si le panneau de saisie n’est pas visible actuellement, la zone d’entrée actuelle est égale à la zone d’entrée par défaut. La propriété **CurrentInputArea** n’est jamais égale à **PanelInputArea \_ auto**. Si [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) est égal à **PanelInputArea \_ auto**, le **CurrentInputArea** est égal à la dernière zone d’entrée indiquée ou la valeur système par défaut pour la langue d’entrée actuelle si le panneau de saisie n’a jamais été affiché.

La principale différence entre la prise en charge de la zone d’entrée dans l’objet [**PenInputPanel**](peninputpanel-class.md) et celle de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) est le fait que l’application a désormais la possibilité de définir la zone d’entrée par défaut sur le caractère, en plus du pavé d’écriture et du clavier.

À l’aide des propriétés ci-dessus, une application peut contrôler la zone d’entrée du panneau de saisie affichée dans différents champs et optimiser l’expérience d’entrée de texte de l’utilisateur. En outre, l’application peut tenir à jour la connaissance de la zone d’entrée actuelle et prendre des décisions conditionnelles en fonction de la zone d’entrée la plus adaptée à la tâche utilisateur actuelle.

## <a name="detailed-information-about-input-panels-interaction-mode"></a>Informations détaillées sur le mode d’interaction du panneau de saisie

En plus de pouvoir détecter la zone d’entrée actuelle du panneau de saisie, il est également possible de détecter le mode d’interaction actuel : sur place, ancré ou flottant. Il peut être important pour l’application de connaître le mode d’interaction actuel pour comprendre comment l’utilisateur interagit avec l’application ou parce que certaines méthodes et propriétés de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) s’appliquent uniquement au mode d’interaction In-Place. Par exemple, dans une application, le rechargement des éléments d’interface utilisateur existants, puis positionne le In-Place panneau de saisie sur une zone vide dans ses interfaces utilisateur doit vérifier que le mode d’interaction actuel est sur place avant d’effectuer des ajustements.

![modes des panneaux de saisie ancré, flottant et à la vitesse](images/98c8e96b-99b2-477a-9843-33b1fae7e75b.jpg)

La propriété [**CurrentInteractionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinteractionmode) de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) stocke le mode d’interaction actuel tel qu’il est choisi par l’utilisateur. Les modes possibles sont définis par l’énumération [**InteractionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-interactionmode) comme suit :

**InteractionMode \_ InPlace**: dans le In-Place panneau de saisie mode d’interaction apparaît en regard du champ d’entrée de texte qui a actuellement le focus. Par défaut, l' In-Place icône du panneau de saisie apparaît lorsqu’un point d’insertion est placé dans un champ d’entrée de texte. Le fait de cliquer sur l’icône du panneau de saisie provoque le développement du panneau de saisie. Le panneau de saisie In-Place est visible uniquement lorsqu’un point d’insertion se trouve dans un champ modifiable.

InteractionMode \_ float : le mode d’interaction flottante est semblable au mode d’interaction InPlace, à ceci près qu’il n’est pas lié à un point d’insertion. Pour ouvrir le panneau de saisie flottant, appuyez sur l’onglet du panneau de saisie qui s’affiche par défaut sur le bord gauche de l’écran. Le panneau de saisie flottant et l’onglet du panneau de saisie peuvent être déplacés et repositionnés par l’utilisateur. Dans, le positionnement en mode flottant et le contrôle du panneau de saisie sont entièrement laissés à l’utilisateur.

InteractionMode \_ DockedTop : dans le Docked-Top panneau de saisie en mode interaction apparaît en haut de l’écran et le bureau active est redimensionné de sorte que le panneau de saisie ne chevauche pas les autres éléments Windows ou d’interface utilisateur. Vous ne pouvez pas faire glisser ou déplacer le panneau de saisie en mode ancré.

InteractionMode \_ DockedBottom : le mode d’interaction Docked-Bottom est le même que le mode de Docked-Top, à l’exception du panneau de saisie qui apparaît en bas de l’écran.

Lorsque le panneau de saisie n’est pas visible, le mode d’interaction actuel est sur place.

La publication du modèle d’interaction actuel est une autre façon dont l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) fournit plus d’informations sur l’état du panneau de saisie que celui disponible dans les versions précédentes.

## <a name="detailed-information-about-input-panels-correction-mode"></a>Informations détaillées sur le mode de correction du panneau de saisie

L’aspect final du panneau de saisie que l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) vous donne des informations détaillées sur et le contrôle de est le mode de correction. La connaissance du mode de correction permet aux applications de déterminer la taille actuelle du panneau de saisie. Le contrôle de l’extension de la correction après insertion dans une application est un moyen de personnaliser l’expérience de correction dans une application.

Le peigne de correction peut apparaître dans deux modes de base : la pré-insertion et l’insertion. Le peigne correction de pré-insertion est utilisé pour corriger le texte avant de l’insérer dans une application. Elle est activée en appuyant sur le texte en attente qui apparaît sous la ligne de base dans le bloc d’écriture en tant qu’encres utilisateur. Le peigne de correction après insertion est utilisé pour corriger le texte après qu’il a été inséré dans une application. Elle est activée en plaçant le point d’insertion dans ou en sélectionnant du texte qui a été précédemment inséré. Au-delà des deux modes de base, il existe plusieurs variantes de la façon dont le peigne correction après insertion peut apparaître. Tout d’abord, il peut apparaître au-dessus ou au-dessous du panneau de saisie et le second peut apparaître réduit ou développé. Dans l’État réduit, le peigne correction après insertion affiche uniquement une liste de remplacements. Dans l’état développé, il comprend à la fois les alternatives et une zone pour réécrire le mot.

![panneau de saisie du peigne de correction, du pré et du billet](images/6cc627de-fc15-4721-9f6a-7e1517d9e650.jpg)

La propriété [**CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) permet à une application de déterminer la configuration actuelle du peigne de correction. Les valeurs possibles de cette propriété, telles que définies par les énumérations [**correctionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-correctionmode) , sont les suivantes : **NotVisible**, **preinsert**, **PostInsertionCollapsed** et **PostInsertionExpanded**. Quand aucun panneau de saisie ou peigne de correction n’est visible, **CurrentCorrectionMode** est **NotVisible**.

Par défaut, le système affiche le peigne de correction après insertion lorsque le sélectionne du texte correct et l’affiche réduit lorsque le point d’insertion est placé dans du texte correct. Une application peut spécifier où le peigne de correction après insertion doit toujours être développé en affectant à la propriété [**ExpandPostInsertionCorrection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_expandpostinsertioncorrection) la **valeur true**. La valeur par défaut du système est **false**. Lorsque la propriété **ExpandPostInsertionCorrection** est utilisée conjointement avec l’interface [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) , un développeur d’applications peut ajouter de façon économique la prise en charge de la correction aux applications qui ne l’obtiendraient pas automatiquement.

Le suivi et le contrôle de l’état de correction du panneau de saisie constituent l’une des nombreuses nouvelles fonctionnalités de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) qui rendent le panneau de saisie plus étroit et l’intégration d’applications possible.

## <a name="event-notification-before-and-after-the-event-occurs"></a>Notification d’événement avant et après l’événement

Un autre aspect de la programmabilité du panneau de saisie qui est beaucoup amélioré dans l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) est le modèle d’événement. Maintenant, au lieu de déclencher uniquement des événements signalant une modification de l’état du panneau de saisie après la modification, des événements distincts sont envoyés avant et après la modification. Les événements signalant le début d’un événement contiennent des verbes de dizaines de temps, tels que « modification » ou « insertion », tandis que les événements signalant la conclusion d’un événement contiennent des verbes passés tels que « modifié » ou « inséré ».

Ce modèle d’événement permet à une application de réagir à une modification avant ou à ce qu’elle se produise. Le panneau de saisie est bloqué en cas de modification ou de reprise après modification jusqu’à ce que les gestionnaires d’événements pour tous les événements soient terminés. Ces événements sont synchrones et de cette façon, une application peut retarder une modification jusqu’à ce qu’elle ait fini de réagir. Toutefois, l’heure à laquelle un gestionnaire d’événements exécute le panneau de saisie devient inaccessible à l’utilisateur et peut sembler bloquée. il est donc important que le gestionnaire d’événements fonctionne correctement. Toutefois, il n’est pas possible pour une application d’empêcher ou d’annuler un événement. Tous les paramètres d’événement sont en lecture seule. Vous trouverez ci-dessous une description des six paires d’événements de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) :

-   [**InPlaceStateChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanging)  /  [**InPlaceStateChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanged): notification selon laquelle l’État sur place est sur le point d’être basculé de pointer vers le mode étendu, ou vice versa. Les paramètres sont le nouvel et l’ancien État sur place. La valeur de la propriété [**CurrentInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) est modifiée.
-   [**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)  /  [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged): indique quand le In-Place taille du panneau de saisie est sur le point de changer ou a été modifié en raison d’un changement de taille d’utilisateur, d’une croissance automatique ou d’une modification de la zone d’entrée. Les paramètres sont les nouveaux et anciens rectangle englobant. La valeur de la propriété [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) est modifiée.
-   [**InputAreaChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanging)  /  [**InputAreaChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanged): signale que la zone d’entrée du panneau de saisie est sur le point de changer ou qu’elle est passée de à l’autre des trois zones d’entrée possibles : le pavé d’écriture, le pavé de caractères ou le clavier. Les paramètres sont les nouvelles et anciennes zones d’entrée. Coïncide avec une modification de la valeur de la propriété [**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea)
-   [**CorrectionModeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanging)  /  [**CorrectionModeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanged): notification indiquant que le mode de correction va être modifié ou a changé. Les modes de correction possibles sont : non visible, avant insertion, après insertion réduite et développé après l’insertion. Les paramètres sont le nouveau et l’ancien mode de correction. Coïncide avec une modification de la valeur de la propriété [**CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) .
-   [**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged): indique quand le In-Place visibilité du panneau de saisie est sur le ou modifié. Les paramètres sont la nouvelle et l’ancienne visibilité. Une nouvelle visibilité de la **valeur false** signifie que le In-Place panneau de saisie n’est pas ouvert, mais n’empêche pas le panneau de saisie d’être visible dans le mode d’interaction flottant ou ancré.
-   [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting)  /  [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted): indique quand le texte est sur le ou inséré à partir du panneau de saisie. Le paramètre est un tableau d’objets [**InkDisp**](inkdisp-class.md) , chacun contenant une ligne de l’encre et du texte qui composent l’insertion. En savoir plus sur cet événement dans la section suivante.

Ces événements fournissent aux applications des informations essentielles sur les modifications apportées au panneau de saisie et les autorisent à réagir en conséquence. Là encore, la modification apportée au modèle d’événement du panneau de saisie représente une étape vers une meilleure interaction entre les applications et le panneau de saisie.

## <a name="support-for-collecting-the-ink-and-text-entered-in-input-panel"></a>Prise en charge de la collecte de l’encre et du texte entrés dans le panneau de saisie

Enfin, la dernière fonctionnalité très puissante de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) est la capacité à obtenir l’objet Ink pour le texte entré par le biais du panneau de saisie à partir du panneau de saisie au moment où le texte est inséré dans une application. Il s’agit d’une fonctionnalité souvent demandée dans le cadre du suivi des modifications et de la conservation des enregistrements. Il permet également aux applications d’utiliser l’encre dans leur interface utilisateur en tant qu’élément statique ou à l’aide d’une surface d’entrée manuscrite personnalisée.

Pour recevoir l’objet [**InkDisp**](inkdisp-class.md) pour le texte entré par le biais du panneau de saisie, une application doit s’inscrire pour recevoir les événements [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting) ou [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted) générés par l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) . L’événement **TextInserting** est déclenché immédiatement avant que le texte soit inséré à partir du panneau de saisie dans une application et que le texte ne s’insère pas tant que tous les gestionnaires d’événements ne sont pas terminés. L’événement **TextInserted** se déclenche immédiatement après l’insertion du test. Le seul paramètre pour l’événement **TextInserting** et **TextInserted** est un tableau d’objets **InkDisp** qui comprend un objet **InkDisp** pour chaque ligne de texte insérée à partir du panneau de saisie. Remarque : le panneau de saisie est inactif pendant que les gestionnaires d’événements sont en cours d’exécution et peuvent sembler bloqués à l’utilisateur. il est donc important de définir ces gestionnaires d’événements en clair et de s’assurer qu’ils s’exécutent rapidement. En outre, une application ne doit pas créer de gestionnaire pour cet événement, sauf si elle a une utilisation spécifique pour les informations dans la mesure où il y a un coût de performances associé. Le panneau de saisie marshale uniquement les données manuscrites si une application demande les données. dans le cas contraire, le panneau de saisie peut ignorer cette opération coûteuse. Les paramètres des événements **TextInserting** et **TextInserted** sont en lecture seule, ce qui signifie qu’il n’est pas possible pour les applications de modifier le texte inséré avant qu’il ne soit inséré dans l’application.

Les possibilités offertes par les applications avec cette nouvelle fonctionnalité sont nombreuses et elles ne peuvent pas être plus simples à utiliser. Autoriser le texte reconnu et l’entrée manuscrite entrés via le panneau de saisie à collecter par les applications n’est qu’une autre façon dont les développeurs du panneau de saisie sont améliorés dans Windows Vista.

## <a name="conclusion"></a>Conclusion

Globalement, le scénario de programmabilité pour le panneau de saisie Tablet PC est beaucoup amélioré avec l’introduction de l’objet [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) dans Windows Vista. À l’aide de l’objet **TextInputPanel** , les développeurs d’applications ont un meilleur contrôle et plus d’informations sur le panneau de saisie d’État dans la version précédente. Par conséquent, les développeurs d’applications qui créent de nouvelles applications Tablet PC ou qui mettent à jour des applications existantes sont fortement encouragés à utiliser l’objet **TextInputPanel** à la place de l’objet [**PenInputPanel**](peninputpanel-class.md) désormais déconseillé. En outre, la prise en charge de nouvelles fonctionnalités, telles que le positionnement absolu du panneau de saisie et l’icône du panneau de saisie, ainsi que la possibilité pour l’application de recevoir le texte et l’encre du module de reconnaissance entrés via le panneau de saisie permettent de créer de nouveaux scénarios et fonctionnalités d’application. L’inclusion de ces fonctionnalités et plusieurs autres sont en réponse directe aux commentaires des développeurs et marquent les premières étapes vers l’intégration complète du panneau de saisie avec les applications Tablet PC. Enfin, le développement de la fonctionnalité d’application Tablet PC est un grand avantage pour les développeurs d’applications et la plateforme Tablet PC.

 

 



