---
description: L’exemple de reconnaissance avancée illustre des fonctionnalités avancées de l’interface de programmation d’applications (API) d’automatisation de Microsoft Tablet PC utilisée pour la reconnaissance de l’écriture manuscrite.
ms.assetid: 4c9b9f31-c317-43fd-8404-35295b41d093
title: Exemple de reconnaissance avancée
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e23a078ded9c6967f8e45780f8cb3a739b246f6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103749117"
---
# <a name="advanced-recognition-sample"></a><span data-ttu-id="9962a-103">Exemple de reconnaissance avancée</span><span class="sxs-lookup"><span data-stu-id="9962a-103">Advanced Recognition Sample</span></span>

<span data-ttu-id="9962a-104">L’exemple de reconnaissance avancée illustre des fonctionnalités avancées de l’interface de programmation d’applications (API) d’automatisation de Microsoft Tablet PC utilisée pour la reconnaissance de l’écriture manuscrite.</span><span class="sxs-lookup"><span data-stu-id="9962a-104">The advanced recognition sample demonstrates advanced features of the Microsoft Tablet PC Automation application programming interface (API) used for handwriting recognition.</span></span>

<span data-ttu-id="9962a-105">Microsoft System Center ASP.NET 2.0 2007 offre les fonctionnalités suivantes :</span><span class="sxs-lookup"><span data-stu-id="9962a-105">It includes the following features:</span></span>

-   <span data-ttu-id="9962a-106">Énumération du module de reconnaissance installé</span><span class="sxs-lookup"><span data-stu-id="9962a-106">Enumerating the installed recognizer</span></span>
-   <span data-ttu-id="9962a-107">Création d’un contexte de module de reconnaissance avec un langage spécifique</span><span class="sxs-lookup"><span data-stu-id="9962a-107">Creating a recognizer context with a specific language</span></span>
-   <span data-ttu-id="9962a-108">Utilisation de l’objet Recognizer</span><span class="sxs-lookup"><span data-stu-id="9962a-108">Using the recognizer object</span></span>
-   <span data-ttu-id="9962a-109">Définition des Factoid de reconnaissance et des listes de mots</span><span class="sxs-lookup"><span data-stu-id="9962a-109">Setting recognition factoid and word lists</span></span>
-   <span data-ttu-id="9962a-110">Utilisation de guides pour améliorer la qualité de la reconnaissance</span><span class="sxs-lookup"><span data-stu-id="9962a-110">Using guides to improve the recognition quality</span></span>
-   <span data-ttu-id="9962a-111">Reconnaissance dynamique en arrière-plan</span><span class="sxs-lookup"><span data-stu-id="9962a-111">Dynamic background recognition</span></span>
-   <span data-ttu-id="9962a-112">Reconnaissance de mouvement</span><span class="sxs-lookup"><span data-stu-id="9962a-112">Gesture recognition</span></span>

<span data-ttu-id="9962a-113">Les interfaces utilisées sont les suivantes : [**IInkRecognizer**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognizer), **IInkRecoContext**, [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult), **IInkRecognitionGuide**, **IInkWordList**, [**IInkGesture**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkgesture), **IInkCollector**, **IInkDisp**, **IInkRenderer**, **IInkDrawingAttributes**, **IInkStrokes** et **IInkStroke**.</span><span class="sxs-lookup"><span data-stu-id="9962a-113">The interfaces used are: [**IInkRecognizer**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognizer), **IInkRecoContext**, [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult), **IInkRecognitionGuide**, **IInkWordList**, [**IInkGesture**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkgesture), **IInkCollector**, **IInkDisp**, **IInkRenderer**, **IInkDrawingAttributes**, **IInkStrokes**, and **IInkStroke**.</span></span>

## <a name="ink-and-project-headers"></a><span data-ttu-id="9962a-114">En-têtes d’encre et de projet</span><span class="sxs-lookup"><span data-stu-id="9962a-114">Ink and Project Headers</span></span>

<span data-ttu-id="9962a-115">Tout d’abord, incluez les en-têtes pour les interfaces d’automatisation Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="9962a-115">First, include the headers for Tablet PC Automation interfaces.</span></span> <span data-ttu-id="9962a-116">Celles-ci sont installées avec le kit de développement logiciel (SDK) de plateforme Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="9962a-116">These are installed with the Tablet PC Platform SDK.</span></span> <span data-ttu-id="9962a-117">Le fichier TpcError. h contient les définitions des codes d’erreur de l’API Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="9962a-117">The TpcError.h file contains the Tablet PC API Error Code definitions.</span></span>


```C++
#include <msinkaut.h>
#include <msinkaut_i.c>
#include <TpcError.h>
```



<span data-ttu-id="9962a-118">Le fichier EventSinks. h définit les interfaces **IInkEventsImpl** et **IInkRecognitionEventsImpl** , et configure les événements [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md), [**Stroke**](inkcollector-stroke.md)et [**geste**](inkcollector-gesture.md) .</span><span class="sxs-lookup"><span data-stu-id="9962a-118">The EventSinks.h file defines the **IInkEventsImpl** and **IInkRecognitionEventsImpl** interfaces, and sets up the [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md), [**Stroke**](inkcollector-stroke.md), and [**Gesture**](inkcollector-gesture.md) events.</span></span>


```C++
#include "EventSinks.h"
```



<span data-ttu-id="9962a-119">Le fichier ChildWnds. h contient les définitions des classes **CInkInputWnd** et **CRecoOutputWnd**, qui sont dérivées de CWindowImpl d’ATL et utilisées pour créer les fenêtres enfants de l’exemple.</span><span class="sxs-lookup"><span data-stu-id="9962a-119">The ChildWnds.h file contains the definitions of the classes **CInkInputWnd** and **CRecoOutputWnd**, which are derived from the ATL's CWindowImpl and used for creating the sample's child windows.</span></span>


```C++
#include "ChildWnds.h"
```



<span data-ttu-id="9962a-120">Le fichier AdvReco. h déclare la classe **CAdvRecoApp** , qui est la classe de fenêtre d’application pour cet exemple.</span><span class="sxs-lookup"><span data-stu-id="9962a-120">The AdvReco.h file declares the **CAdvRecoApp** class, which is the application window class for this sample.</span></span>


```C++
#include "AdvReco.h"
```



## <a name="initializing-the-application-window"></a><span data-ttu-id="9962a-121">Initialisation de la fenêtre d’application</span><span class="sxs-lookup"><span data-stu-id="9962a-121">Initializing the Application Window</span></span>

<span data-ttu-id="9962a-122">La méthode de la fenêtre `Run` configure l’objet **CAdvRecoApp** , charge le menu et l’icône de la fenêtre, crée un objet [**InkRecognizerContext**](inkrecognizercontext-class.md) pour le module de reconnaissance par défaut et démarre la boucle de message de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="9962a-122">The window's `Run` method sets up the **CAdvRecoApp** object, loads the menu and icon for the window, creates an [**InkRecognizerContext**](inkrecognizercontext-class.md) object for the default recognizer, and starts the window's message loop.</span></span>

<span data-ttu-id="9962a-123">La méthode **OnCreate** de la fenêtre gère l’événement **WM \_ Create** et crée les fenêtres enfants.</span><span class="sxs-lookup"><span data-stu-id="9962a-123">The window's **OnCreate** method handles the **WM\_CREATE** event and creates the child windows.</span></span> <span data-ttu-id="9962a-124">Un objet [**InkCollector**](inkcollector-class.md) se connecte à la source de l’événement du collecteur d’encre et active l’entrée d’encre dans la fenêtre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="9962a-124">An [**InkCollector**](inkcollector-class.md) object connects to the ink collector's event source, and enables ink input on the input window.</span></span> <span data-ttu-id="9962a-125">Ensuite, il crée un objet [**InkRecognizerGuide**](inkrecognizerguide-class.md) et utilise la propriété [**Renderer**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_renderer) du collecteur d’encre pour convertir les rectangles de la boîte du repère de reconnaissance en espace d’encre.</span><span class="sxs-lookup"><span data-stu-id="9962a-125">Then it creates an [**InkRecognizerGuide**](inkrecognizerguide-class.md) object and uses the ink collector's [**Renderer**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_renderer) property to convert the recognition guide box rectangles to ink space.</span></span> <span data-ttu-id="9962a-126">Enfin, la méthode **OnCreate** crée un objet [**InkWordList**](inkwordlist-class.md) .</span><span class="sxs-lookup"><span data-stu-id="9962a-126">Finally, the **OnCreate** method creates an [**InkWordList**](inkwordlist-class.md) object.</span></span>

## <a name="handling-ink-collector-events"></a><span data-ttu-id="9962a-127">Gestion des événements du collecteur d’encre</span><span class="sxs-lookup"><span data-stu-id="9962a-127">Handling Ink Collector Events</span></span>

<span data-ttu-id="9962a-128">La méthode **OnStroke** de la fenêtre gère l’événement [**Stroke**](inkcollector-stroke.md) du collecteur d’encre.</span><span class="sxs-lookup"><span data-stu-id="9962a-128">The window's **OnStroke** method handles the ink collector's [**Stroke**](inkcollector-stroke.md) event.</span></span> <span data-ttu-id="9962a-129">Le nouvel objet [**IInkStrokeDisp**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkstrokedisp) est ajouté au [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) de la propriété [**Ink**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink) du collecteur Ink.</span><span class="sxs-lookup"><span data-stu-id="9962a-129">The new [**IInkStrokeDisp**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkstrokedisp) object is added to the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector's [**Ink**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink) property.</span></span>

<span data-ttu-id="9962a-130">La méthode **OnGesture** de la fenêtre gère l’événement de [**mouvement**](inkcollector-gesture.md) du collecteur d’encre.</span><span class="sxs-lookup"><span data-stu-id="9962a-130">The window's **OnGesture** method handles the ink collector's [**Gesture**](inkcollector-gesture.md) event.</span></span> <span data-ttu-id="9962a-131">La méthode **OnGesture** identifie le mouvement, en commençant par le geste de confiance le plus élevé, et vérifie si la fenêtre prend en charge ce geste particulier.</span><span class="sxs-lookup"><span data-stu-id="9962a-131">The **OnGesture** method identifies the gesture, using the highest confidence gesture first, and checks if the window supports this particular gesture.</span></span> <span data-ttu-id="9962a-132">Si le mouvement est pris en charge, la zone englobante du geste est invalidée, car le mouvement est supprimé de la collection de traits.</span><span class="sxs-lookup"><span data-stu-id="9962a-132">If the gesture is supported, the gesture's bounding box is invalidated, as the gesture is removed from the strokes collection.</span></span> <span data-ttu-id="9962a-133">Si le mouvement n’est pas pris en charge, l’événement de **mouvement** est annulé, ce qui amène le collecteur d’encre à déclencher un événement [**Stroke**](inkcollector-stroke.md) .</span><span class="sxs-lookup"><span data-stu-id="9962a-133">If the gesture is not supported, the **Gesture** event is canceled, which causes the ink collector to raise a [**Stroke**](inkcollector-stroke.md) event.</span></span> <span data-ttu-id="9962a-134">Enfin, la fenêtre résultats est mise à jour.</span><span class="sxs-lookup"><span data-stu-id="9962a-134">Finally, the results window is updated.</span></span>

## <a name="handling-recognizer-context-events"></a><span data-ttu-id="9962a-135">Gestion des événements de contexte de reconnaissance</span><span class="sxs-lookup"><span data-stu-id="9962a-135">Handling Recognizer Context Events</span></span>

<span data-ttu-id="9962a-136">La méthode **OnRecognitionWithAlternates** de la fenêtre gère l’événement [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md) du contexte du module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-136">The window's **OnRecognitionWithAlternates** method handles the recognizer context's [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md) event.</span></span> <span data-ttu-id="9962a-137">La méthode **OnRecognitionWithAlternates** affiche les résultats de la reconnaissance dans la fenêtre résultats.</span><span class="sxs-lookup"><span data-stu-id="9962a-137">The **OnRecognitionWithAlternates** method displays the recognition results in the results window.</span></span>

## <a name="handling-menu-commands"></a><span data-ttu-id="9962a-138">Gestion des commandes de menu</span><span class="sxs-lookup"><span data-stu-id="9962a-138">Handling Menu Commands</span></span>

<span data-ttu-id="9962a-139">La méthode **OnRecognizer** de la fenêtre gère les commandes dans le menu du module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-139">The window's **OnRecognizer** method handles the commands on the Recognizer menu.</span></span> <span data-ttu-id="9962a-140">Si la commande **par défaut** a été sélectionnée, la méthode [**GetDefaultRecognizer**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizers-getdefaultrecognizer) de [InkRecognizers](/previous-versions/windows/desktop/legacy/ms702438(v=vs.85)) est utilisée pour récupérer le module de reconnaissance par défaut ; dans le cas contraire, le module de reconnaissance sélectionné est récupéré.</span><span class="sxs-lookup"><span data-stu-id="9962a-140">If the **Default** command was selected, the [**GetDefaultRecognizer**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizers-getdefaultrecognizer) method of the [InkRecognizers](/previous-versions/windows/desktop/legacy/ms702438(v=vs.85)) is used to retrieve the default recognizer; otherwise, the selected recognizer is retrieved.</span></span> <span data-ttu-id="9962a-141">Ensuite, un contexte de module de reconnaissance est créé et utilisé, et le menu et la barre d’État sont mis à jour.</span><span class="sxs-lookup"><span data-stu-id="9962a-141">Then, a recognizer context is created and used, and menu and status bar are updated.</span></span>

<span data-ttu-id="9962a-142">La méthode **OnFactoidWordlist** de la fenêtre gère la commande **use** de la personne dans le menu **Factoid** .</span><span class="sxs-lookup"><span data-stu-id="9962a-142">The window's **OnFactoidWordlist** method handles the **Use Wordlist** command on the **Factoid** menu.</span></span> <span data-ttu-id="9962a-143">La propriété [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) du contexte du module de reconnaissance est définie sur **null** pour réinitialiser le contexte du module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-143">The recognizer context's [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) property is set to **NULL** to reset the recognizer context.</span></span> <span data-ttu-id="9962a-144">Si vous désactivez l’option **utiliser** la balise de [**la personne,**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_wordlist) la propriété texte du contexte du module de reconnaissance est définie sur **null**. Sinon, **la propriété de** la balise de contexte du module de reconnaissance est définie sur le [**InkWordList**](inkwordlist-class.md) qui a été créé dans la méthode **OnCreate** .</span><span class="sxs-lookup"><span data-stu-id="9962a-144">If the **Use Wordlist** option is turned off, the recognizer context's [**WordList**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_wordlist) property is set to **NULL**; otherwise, the recognizer context's **WordList** property is set to the [**InkWordList**](inkwordlist-class.md) that was created in the **OnCreate** method.</span></span> <span data-ttu-id="9962a-145">Enfin, le [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) du collecteur d’encres est rattaché au contexte du module de reconnaissance, la méthode [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) du contexte du module de reconnaissance est appelée et le menu est mis à jour.</span><span class="sxs-lookup"><span data-stu-id="9962a-145">Finally, the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector is reattached to the recognizer context, the recognizer context's [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) method is called, and the menu is updated.</span></span>

<span data-ttu-id="9962a-146">La méthode **OnFactoid** de la fenêtre gère les commandes Factoid dans le menu **Factoid** .</span><span class="sxs-lookup"><span data-stu-id="9962a-146">The window's **OnFactoid** method handles the factoid commands on the **Factoid** menu.</span></span> <span data-ttu-id="9962a-147">Il définit d’abord la propriété [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) du contexte du module de reconnaissance sur la **valeur null**, définit la propriété [**Factoid**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_factoid) du contexte du module de reconnaissance sur le Factoid sélectionné et réaffecte le [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) du collecteur d’encre au contexte du module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-147">It first sets the recognizer context's [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) property to **NULL**, sets the recognizer context's [**Factoid**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_factoid) property to the selected factoid, and reassigns the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector to the recognizer context.</span></span> <span data-ttu-id="9962a-148">Si l’objet [Factoid](factoid-constants.md) est pris en charge par le contexte du module de reconnaissance, la méthode [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) du contexte du module de reconnaissance est appelée ; dans le cas contraire, un message d’erreur s’affiche.</span><span class="sxs-lookup"><span data-stu-id="9962a-148">If the [Factoid](factoid-constants.md) object is supported by the recognizer context, the recognizer context's [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) method is called; otherwise, an error message is displayed.</span></span> <span data-ttu-id="9962a-149">Enfin, le menu et la barre d’État sont mis à jour.</span><span class="sxs-lookup"><span data-stu-id="9962a-149">Finally, the menu and status bar are updated.</span></span>

<span data-ttu-id="9962a-150">La méthode **OnGuide** de la fenêtre gère les commandes dans le menu du **repère** .</span><span class="sxs-lookup"><span data-stu-id="9962a-150">The window's **OnGuide** method handles the commands on the **Guide** menu.</span></span> <span data-ttu-id="9962a-151">Si le contexte du [**module de reconnaissance**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) prend en charge les options du repère, la méthode **OnGuide** affecte la **valeur null** au contexte du contexte du module de reconnaissance, définit [**la propriété du repère du**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_guide) contexte du module de reconnaissance sur le paramètre du repère sélectionné, réaffecte le [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) du collecteur d’encre au contexte du module de reconnaissance et appelle la méthode [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) du contexte du module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-151">If the recognizer context supports the guide options, the **OnGuide** method sets the recognizer context's [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) property to **NULL**, sets the recognizer context's [**Guide**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_guide) property to the selected guide setting, reassigns the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector to the recognizer context, and calls the recognizer context's [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) method.</span></span> <span data-ttu-id="9962a-152">Dans le cas contraire, un message d’erreur s’affiche.</span><span class="sxs-lookup"><span data-stu-id="9962a-152">Otherwise, an error message is displayed.</span></span> <span data-ttu-id="9962a-153">Enfin, la fenêtre d’entrée, le menu et la barre d’État sont mis à jour.</span><span class="sxs-lookup"><span data-stu-id="9962a-153">Finally, the input window, menu, and status bar are updated.</span></span>

<span data-ttu-id="9962a-154">La méthode **OnMode** de la fenêtre gère les commandes du menu **mode** .</span><span class="sxs-lookup"><span data-stu-id="9962a-154">The window's **OnMode** method handles the commands on the **Mode** menu.</span></span> <span data-ttu-id="9962a-155">Il désactive le collecteur d’encres, met à jour la propriété [**CollectionMode**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_collectionmode) du collecteur d’encre, met à jour le menu et affiche ou masque les listes de mouvements.</span><span class="sxs-lookup"><span data-stu-id="9962a-155">It disables the ink collector, updates the ink collector's [**CollectionMode**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_collectionmode) property, updates the menu, and shows or hides the gesture lists.</span></span> <span data-ttu-id="9962a-156">Enfin, le collecteur d’encre est activé.</span><span class="sxs-lookup"><span data-stu-id="9962a-156">Finally, the ink collector is enabled.</span></span>

<span data-ttu-id="9962a-157">La méthode **OnRecognize** de la fenêtre gère la commande **Recognize** dans le menu Ink.</span><span class="sxs-lookup"><span data-stu-id="9962a-157">The window's **OnRecognize** method handles the **Recognize** command on the Ink menu.</span></span> <span data-ttu-id="9962a-158">Elle appelle la méthode [**EndInkInput**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-endinkinput) du contexte de reconnaissance pour empêcher l’ajout de l’encre au contexte du module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-158">It calls the recognizer context's [**EndInkInput**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-endinkinput) method to keep ink from being added to the recognizer context.</span></span> <span data-ttu-id="9962a-159">Cela est parfois nécessaire, car tous les identifiants ne prennent pas en charge la reconnaissance partielle.</span><span class="sxs-lookup"><span data-stu-id="9962a-159">This is sometimes necessary, as not all recognizers support partial recognition.</span></span> <span data-ttu-id="9962a-160">Elle appelle ensuite la méthode [**Recognize**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-recognize) du contexte de reconnaissance et transmet les résultats à la méthode **OnRecognitionWithAlternates** de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="9962a-160">Then it calls the recognizer context's [**Recognize**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-recognize) method, and passes the results to the window's **OnRecognitionWithAlternates** method.</span></span> <span data-ttu-id="9962a-161">Enfin, le [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) du collecteur d’encres est réaffecté au contexte du module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-161">Finally, the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector is reassigned to the recognizer context.</span></span>

<span data-ttu-id="9962a-162">La méthode **OnClear** de la fenêtre gère la commande **Clear** dans le menu **Ink** .</span><span class="sxs-lookup"><span data-stu-id="9962a-162">The window's **OnClear** method handles the **Clear** command on the **Ink** menu.</span></span> <span data-ttu-id="9962a-163">Elle supprime les traits de la propriété [**Ink**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink) du collecteur d’encre, libère l’ancienne collection Strokes et en crée une pour la propriété **Ink** du collecteur d’encre, puis attache la nouvelle collection Strokes au contexte de module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-163">It deletes the strokes from the ink collector's [**Ink**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink) property, releases the old strokes collection and creates a new one for the ink collector's **Ink** property, and attaches the new strokes collection to the recognizer context.</span></span>

<span data-ttu-id="9962a-164">La méthode **OnExit** de la fenêtre gère la commande **quitter** dans le menu **Ink** et déclenche l' \_ événement WM Close.</span><span class="sxs-lookup"><span data-stu-id="9962a-164">The window's **OnExit** method handles the **Exit** command on the **Ink** menu, and raises the WM\_CLOSE event.</span></span>

## <a name="helper-methods"></a><span data-ttu-id="9962a-165">Méthodes d'assistance</span><span class="sxs-lookup"><span data-stu-id="9962a-165">Helper Methods</span></span>

<span data-ttu-id="9962a-166">La méthode **LoadMenu** de la fenêtre est appelée à partir de la méthode **Run** de la fenêtre et ajoute la liste des module de reconnaissance pris en charge et la liste des Factoids prises en charge au menu.</span><span class="sxs-lookup"><span data-stu-id="9962a-166">The window's **LoadMenu** method is called from the window's **Run** method, and adds the list of supported recognizers and the list of supported factoids to the menu.</span></span> <span data-ttu-id="9962a-167">Tout d’abord, elle récupère [InkRecognizers](/previous-versions/windows/desktop/legacy/ms702438(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="9962a-167">First, it retrieves the [InkRecognizers](/previous-versions/windows/desktop/legacy/ms702438(v=vs.85)).</span></span> <span data-ttu-id="9962a-168">Il itère ensuite au sein des module de reconnaissance disponibles et sélectionne uniquement ceux qui ont une liste de langues dans la propriété **languages** , qu’il ajoute au menu du module de **reconnaissance** .</span><span class="sxs-lookup"><span data-stu-id="9962a-168">Then it iterates through the available recognizers and only selects ones that have a list of languages in the **Languages** property, which it adds to the **Recognizer** menu.</span></span> <span data-ttu-id="9962a-169">Enfin, il remplit le menu **Factoid** avec la liste de Factoids définie en tant que constante globale.</span><span class="sxs-lookup"><span data-stu-id="9962a-169">Finally, it populates the **Factoid** menu with the list of factoids defined as a global constant.</span></span>

<span data-ttu-id="9962a-170">La méthode **UseRecognizer** de la fenêtre est appelée à partir de la méthode **OnRecognizer** de la fenêtre lorsque l’utilisateur sélectionne un nouveau module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-170">The window's **UseRecognizer** method is called from the window's **OnRecognizer** method when the user selects a new recognizer.</span></span> <span data-ttu-id="9962a-171">Il crée un contexte de module de reconnaissance, détache l’ancien contexte du récepteur d’événements de reconnaissance, efface et libère l’ancien contexte et attache le nouveau contexte au récepteur d’événements de la reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-171">It creates a recognizer context, detaches the old context from the recognizer event sink, clears and releases the old context, and attaches the new context to the recognizer event sink.</span></span>

<span data-ttu-id="9962a-172">Ensuite, la méthode **UseRecognizer** vérifie la propriété des [**capacités**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_capabilities) du module de reconnaissance, qui retourne une valeur [**InkRecognizerCapabilities**](/windows/desktop/api/msinkaut/ne-msinkaut-inkrecognizercapabilities) .</span><span class="sxs-lookup"><span data-stu-id="9962a-172">Then, the **UseRecognizer** method checks the recognizer's [**Capabilities**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_capabilities) property, which returns an [**InkRecognizerCapabilities**](/windows/desktop/api/msinkaut/ne-msinkaut-inkrecognizercapabilities) value.</span></span> <span data-ttu-id="9962a-173">Si le module de reconnaissance prend en charge l’entrée en ligne, la commande **lignes** du menu du **repère** est activée.</span><span class="sxs-lookup"><span data-stu-id="9962a-173">If the recognizer supports lined input, the **Lines** command on the **Guide** menu is enabled.</span></span> <span data-ttu-id="9962a-174">Si le module de reconnaissance prend en charge les entrées boxed, la commande **cases** est activée.</span><span class="sxs-lookup"><span data-stu-id="9962a-174">If the recognizer supports boxed input, the **Boxes** command is enabled.</span></span> <span data-ttu-id="9962a-175">Si le module de reconnaissance ne prend pas en charge l’entrée libre, la commande **None** est désactivée.</span><span class="sxs-lookup"><span data-stu-id="9962a-175">If the recognizer does not support free input, the **None** command is disabled.</span></span> <span data-ttu-id="9962a-176">Si la sélection du repère en cours n’est pas prise en charge, la propriété [**Guide**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_guide) du contexte de module de reconnaissance et le menu sont mis à jour.</span><span class="sxs-lookup"><span data-stu-id="9962a-176">If the current guide selection is not supported, both the [**Guide**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_guide) property of the recognizer context and the menu are updated.</span></span>

<span data-ttu-id="9962a-177">Ensuite, la méthode **UseRecognizer** tente de définir les propriétés [**de la recherche et de**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_wordlist) la [**Factoid**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_factoid) du contexte du module de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-177">Then, the **UseRecognizer** method attempts to set the [**WordList**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_wordlist) and [**Factoid**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_factoid) properties of the recognizer context.</span></span> <span data-ttu-id="9962a-178">Si l’un des paramètres n’est pas pris en charge par le module de reconnaissance, la valeur par défaut est utilisée et le menu est mis à jour.</span><span class="sxs-lookup"><span data-stu-id="9962a-178">If either setting is not supported by the recognizer, then the default value is used and the menu is updated.</span></span>

<span data-ttu-id="9962a-179">Enfin, la méthode **UseRecognizer** attache la propriété [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) de l’objet [**InkDisp**](inkdisp-class.md) du collecteur Ink au contexte du module de reconnaissance, modifie la police de la fenêtre de sortie en une valeur prise en charge par la langue du module de reconnaissance, réinitialise la fenêtre de sortie et met à jour les résultats de la reconnaissance en appelant la méthode [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) du contexte de reconnaissance.</span><span class="sxs-lookup"><span data-stu-id="9962a-179">Finally, the **UseRecognizer** method attaches the [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) property of the ink collector's [**InkDisp**](inkdisp-class.md) object to the recognizer context, changes the output window's font to one supported by the language of the recognizer, resets the output window, and updates the recognition results by calling the recognizer context's [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) method.</span></span>

<span data-ttu-id="9962a-180">La méthode **GetGestureName** de la fenêtre est appelée à partir de la méthode **OnGesture** de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="9962a-180">The window's **GetGestureName** method is called from the window's **OnGesture** method.</span></span> <span data-ttu-id="9962a-181">Elle recherche le mouvement et retourne un index au nom du geste, qui est stocké dans une table de chaînes du fichier AdvReco. rc.</span><span class="sxs-lookup"><span data-stu-id="9962a-181">It searches for the gesture and returns an index to the gesture's name, which is stored in a string table in the AdvReco.rc file.</span></span>

 

 
