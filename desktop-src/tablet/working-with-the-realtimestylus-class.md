---
description: La classe RealTimeStylus fait partie des interfaces de programmation d’applications (API) StylusInput. Les sections suivantes décrivent les éléments clés de la classe RealTimeStylus et les API StylusInput.
ms.assetid: 6385c387-5b11-4719-a6ec-e0bebe875348
title: Utilisation de la classe RealTimeStylus
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 919c4de38cb0835996928c877ca4c42faf6a5f96
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103752429"
---
# <a name="working-with-the-realtimestylus-class"></a><span data-ttu-id="5206c-104">Utilisation de la classe RealTimeStylus</span><span class="sxs-lookup"><span data-stu-id="5206c-104">Working with the RealTimeStylus Class</span></span>

<span data-ttu-id="5206c-105">La classe [**RealTimeStylus**](realtimestylus-class.md) fait partie des interfaces de programmation d’applications (API) StylusInput.</span><span class="sxs-lookup"><span data-stu-id="5206c-105">The [**RealTimeStylus**](realtimestylus-class.md) class is part of the StylusInput application programming interfaces (APIs).</span></span> <span data-ttu-id="5206c-106">Les sections suivantes décrivent les éléments clés de la classe **RealTimeStylus** et les API StylusInput.</span><span class="sxs-lookup"><span data-stu-id="5206c-106">The following sections describe key elements of the **RealTimeStylus** class and the StylusInput APIs.</span></span>

## <a name="instantiating-the-realtimestylus-class"></a><span data-ttu-id="5206c-107">Instanciation de la classe RealTimeStylus</span><span class="sxs-lookup"><span data-stu-id="5206c-107">Instantiating the RealTimeStylus Class</span></span>

<span data-ttu-id="5206c-108">Lorsque vous créez un objet [**RealTimeStylus**](realtimestylus-class.md) , vous avez la possibilité de l’attacher à un handle de fenêtre ou à un contrôle.</span><span class="sxs-lookup"><span data-stu-id="5206c-108">When you create a [**RealTimeStylus**](realtimestylus-class.md) object, you have the option of attaching it to a window handle or to a control.</span></span> <span data-ttu-id="5206c-109">L’attachement de l’objet **RealTimeStylus** à un handle de fenêtre requiert des autorisations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="5206c-109">Attaching the **RealTimeStylus** object to a window handle requires additional permissions.</span></span> <span data-ttu-id="5206c-110">Pour plus d’informations sur ces autorisations, consultez [considérations relatives à la confiance partielle pour les API StylusInput](partial-trust-considerations-for-the-stylusinput-apis.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-110">For more information about these permissions, see [Partial Trust Considerations for the StylusInput APIs](partial-trust-considerations-for-the-stylusinput-apis.md).</span></span>

> [!Note]  
> <span data-ttu-id="5206c-111">Vous ne pouvez pas attacher l’objet [**RealTimeStylus**](realtimestylus-class.md) à une fenêtre ou à un contrôle dans un processus différent.</span><span class="sxs-lookup"><span data-stu-id="5206c-111">You cannot attach the [**RealTimeStylus**](realtimestylus-class.md) object to a window or control in a different process.</span></span>

 

<span data-ttu-id="5206c-112">Si vous utilisez le constructeur par défaut, vous créez un objet [**RealTimeStylus**](realtimestylus-class.md) qui peut uniquement accepter l’entrée d’un autre objet **RealTimeStylus** .</span><span class="sxs-lookup"><span data-stu-id="5206c-112">If you use the default constructor, you create a [**RealTimeStylus**](realtimestylus-class.md) object that can only accept input from another **RealTimeStylus** object.</span></span> <span data-ttu-id="5206c-113">Pour plus d’informations sur la connexion de deux objets **RealTimeStylus** , consultez [le modèle RealTimeStylus monté en cascade](the-cascaded-realtimestylus-model.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-113">For more information about connecting two **RealTimeStylus** objects, see [The Cascaded RealTimeStylus Model](the-cascaded-realtimestylus-model.md).</span></span>

<span data-ttu-id="5206c-114">L’objet [**RealTimeStylus**](realtimestylus-class.md) implémente l’interface [IDisposable](/dotnet/api/system.idisposable) .</span><span class="sxs-lookup"><span data-stu-id="5206c-114">The [**RealTimeStylus**](realtimestylus-class.md) object implements the [IDisposable](/dotnet/api/system.idisposable) interface.</span></span>

## <a name="extending-the-realtimestylus-class"></a><span data-ttu-id="5206c-115">Extension de la classe RealTimeStylus</span><span class="sxs-lookup"><span data-stu-id="5206c-115">Extending the RealTimeStylus Class</span></span>

<span data-ttu-id="5206c-116">Pour permettre à vos plug-ins d’interagir avec le flux de données à partir du stylet, l’objet [**RealTimeStylus**](realtimestylus-class.md) gère deux collections de plug-in, qui sont accessibles par les méthodes [**GetStylusSyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylussyncplugin) et [**GetStylusAsyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylusasyncplugin) en C++ et par les propriétés [SyncPluginCollection](/previous-versions/ms824833(v=msdn.10)) et [AsyncPluginCollection](/previous-versions/ms824831(v=msdn.10)) en code managé.</span><span class="sxs-lookup"><span data-stu-id="5206c-116">To allow your plug-ins to interact with the data stream from the tablet pen, the [**RealTimeStylus**](realtimestylus-class.md) object maintains two plug-in collections, which are accessible by the [**GetStylusSyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylussyncplugin) and the [**GetStylusAsyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylusasyncplugin) methods in C++ and by the [SyncPluginCollection](/previous-versions/ms824833(v=msdn.10)) and [AsyncPluginCollection](/previous-versions/ms824831(v=msdn.10)) properties in managed code.</span></span> <span data-ttu-id="5206c-117">Vous pouvez ajouter un plug-in en appelant la méthode [**AddStylusSyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylussyncplugin) ou [**AddStylusAsyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylusasyncplugin) de la collection dans la propriété appropriée.</span><span class="sxs-lookup"><span data-stu-id="5206c-117">You can add a plug-in by calling either the [**AddStylusSyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylussyncplugin) or the [**AddStylusAsyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylusasyncplugin) method of the collection within the appropriate property.</span></span> <span data-ttu-id="5206c-118">Pour plus d’informations sur la création et l’utilisation de plug-ins, consultez [plug-ins et la classe RealTimeStylus](plug-ins-and-the-realtimestylus-class.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-118">For more information about creating and using plug-ins, see [Plug-ins and the RealTimeStylus Class](plug-ins-and-the-realtimestylus-class.md).</span></span> <span data-ttu-id="5206c-119">Pour plus d’informations sur la création d’un plug-in synchrone ou asynchrone pour une tâche particulière, consultez [Considérations sur les threads pour les API StylusInput](threading-considerations-for-the-stylusinput-apis.md) et [Considérations sur les performances pour les API StylusInput](performance-considerations-for-the-stylusinput-apis.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-119">For information about deciding whether to create a synchronous or asynchronous plug-in for a particular task, see [Threading Considerations for the StylusInput APIs](threading-considerations-for-the-stylusinput-apis.md) and [Performance Considerations for the StylusInput APIs](performance-considerations-for-the-stylusinput-apis.md).</span></span>

<span data-ttu-id="5206c-120">Les plug-ins synchrones doivent implémenter l’interface [**IStylusSyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin) , et les plug-ins asynchrones doivent implémenter l’interface [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) .</span><span class="sxs-lookup"><span data-stu-id="5206c-120">Synchronous plug-ins must implement the [**IStylusSyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin) interface, and asynchronous plug-ins must implement the [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) interface.</span></span> <span data-ttu-id="5206c-121">Chaque plug-in a une propriété [**IStylusSyncPlugin. DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) ou [**IStylusAsyncPlugin. DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) .</span><span class="sxs-lookup"><span data-stu-id="5206c-121">Each plug-in has a [**IStylusSyncPlugin.DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) or [**IStylusAsyncPlugin.DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) property.</span></span> <span data-ttu-id="5206c-122">L’objet [**RealTimeStylus**](realtimestylus-class.md) appelle uniquement les méthodes de notification du plug-in pour les méthodes auxquelles le plug-in s’est abonné.</span><span class="sxs-lookup"><span data-stu-id="5206c-122">The [**RealTimeStylus**](realtimestylus-class.md) object calls only the notification methods of the plug-in for methods in which the plug-in has subscribed.</span></span> <span data-ttu-id="5206c-123">Pour plus d’informations sur les méthodes de notification, consultez [données de plug-in et classe RealTimeStylus](plug-in-data-and-the-realtimestylus-class.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-123">For more information about the notification methods, see [Plug-in Data and the RealTimeStylus Class](plug-in-data-and-the-realtimestylus-class.md).</span></span>

<span data-ttu-id="5206c-124">L’objet [**RealTimeStylus**](realtimestylus-class.md) implémente l’interface [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) .</span><span class="sxs-lookup"><span data-stu-id="5206c-124">The [**RealTimeStylus**](realtimestylus-class.md) object implements the [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) interface.</span></span> <span data-ttu-id="5206c-125">La seule façon d’instancier un objet **RealTimeStylus** qui accepte l’entrée d’un autre objet **RealTimeStylus** consiste à utiliser le constructeur par défaut et à implémenter le modèle **RealTimeStylus** monté en cascade.</span><span class="sxs-lookup"><span data-stu-id="5206c-125">The only way to instantiate a **RealTimeStylus** object that accepts input from another **RealTimeStylus** object is to use the default constructor and implement the cascaded **RealTimeStylus** model.</span></span> <span data-ttu-id="5206c-126">Pour plus d’informations sur la connexion de deux objets **RealTimeStylus** , consultez [le modèle RealTimeStylus monté en cascade](the-cascaded-realtimestylus-model.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-126">For more information about connecting two **RealTimeStylus** objects see [The Cascaded RealTimeStylus Model](the-cascaded-realtimestylus-model.md).</span></span>

<span data-ttu-id="5206c-127">L’objet [**RealTimeStylus**](realtimestylus-class.md) possède deux files d’attente internes qui contiennent les données du stylet de tablette, la file d’attente d’entrée et la file d’attente de sortie.</span><span class="sxs-lookup"><span data-stu-id="5206c-127">The [**RealTimeStylus**](realtimestylus-class.md) object has two internal queues that carry the tablet pen data, the input queue and the output queue.</span></span> <span data-ttu-id="5206c-128">Les données de stylet sont converties en instances des classes de l’espace de noms [Microsoft. StylusInput. PluginData](/previous-versions/ms574862(v=vs.100)) .</span><span class="sxs-lookup"><span data-stu-id="5206c-128">The pen data is converted into instances of the classes in the [Microsoft.StylusInput.PluginData](/previous-versions/ms574862(v=vs.100)) namespace.</span></span> <span data-ttu-id="5206c-129">La liste suivante décrit comment l’objet **RealTimeStylus** gère les données du stylet de tablette.</span><span class="sxs-lookup"><span data-stu-id="5206c-129">The following list describes how the **RealTimeStylus** object handles the tablet pen data.</span></span>

1.  <span data-ttu-id="5206c-130">L’objet [**RealTimeStylus**](realtimestylus-class.md) recherche d’abord les objets de données de plug-in dans sa file d’attente d’entrée, puis à partir du flux de données de stylet de tablette.</span><span class="sxs-lookup"><span data-stu-id="5206c-130">The [**RealTimeStylus**](realtimestylus-class.md) object checks for plug-in data objects first on its input queue and then from the tablet pen data stream.</span></span>
2.  <span data-ttu-id="5206c-131">L’objet [**RealTimeStylus**](realtimestylus-class.md) envoie un objet de données de plug-in aux objets dans sa collection de plug-ins synchrone.</span><span class="sxs-lookup"><span data-stu-id="5206c-131">The [**RealTimeStylus**](realtimestylus-class.md) object sends one plug-in data object to the objects in its synchronous plug-in collection.</span></span> <span data-ttu-id="5206c-132">Chaque plug-in synchrone peut ajouter des données à la file d’attente d’entrée ou de sortie.</span><span class="sxs-lookup"><span data-stu-id="5206c-132">Each synchronous plug-in can add data to either the input or output queue.</span></span>
3.  <span data-ttu-id="5206c-133">Une fois que l’objet de données de plug-in a été envoyé à tous les membres de la collection de plug-ins synchrone, l’objet de données de plug-in est placé dans la file d’attente de sortie de l’objet [**RealTimeStylus**](realtimestylus-class.md) .</span><span class="sxs-lookup"><span data-stu-id="5206c-133">Once the plug-in data object has been sent to all members of the synchronous plug-in collection, the plug-in data object is placed on the [**RealTimeStylus**](realtimestylus-class.md) object's output queue.</span></span>
4.  <span data-ttu-id="5206c-134">L’objet [**RealTimeStylus**](realtimestylus-class.md) recherche ensuite l’objet de données de plug-in suivant à traiter.</span><span class="sxs-lookup"><span data-stu-id="5206c-134">The [**RealTimeStylus**](realtimestylus-class.md) object then checks for the next plug-in data object to process.</span></span>
5.  <span data-ttu-id="5206c-135">Alors que la file d’attente de sortie de l’objet [**RealTimeStylus**](realtimestylus-class.md) contient des données, l’objet **RealTimeStylus** envoie un objet de données de plug-in à partir de sa file d’attente de sortie aux objets de sa collection de plug-ins asynchrone.</span><span class="sxs-lookup"><span data-stu-id="5206c-135">While the [**RealTimeStylus**](realtimestylus-class.md) object's output queue contains data, the **RealTimeStylus** object sends one plug-in data object from its output queue to the objects in its asynchronous plug-in collection.</span></span> <span data-ttu-id="5206c-136">Chaque plug-in asynchrone peut ajouter des données à la file d’attente d’entrée ou de sortie, mais étant donné que les plug-ins asynchrones s’exécutent sur le thread d’interface utilisateur, les données sont ajoutées à la file d’attente par rapport aux données de stylet actuelles que l’objet **RealTimeStylus** traite, et non par rapport aux données traitées par le plug-in asynchrone.</span><span class="sxs-lookup"><span data-stu-id="5206c-136">Each asynchronous plug-in can add data to either the input or output queue, but since the asynchronous plug-ins run on the user interface (UI) thread, the data is added to the queue in relation to the current pen data the **RealTimeStylus** object is processing, and not in relation to the data that the asynchronous plug-in is processing.</span></span>

<span data-ttu-id="5206c-137">Le diagramme suivant illustre le déroulement des données du stylet de tablette par le biais de l’objet [**RealTimeStylus**](realtimestylus-class.md) et de ses collections de plug-ins.</span><span class="sxs-lookup"><span data-stu-id="5206c-137">The following diagram illustrates the flow of tablet pen data through the [**RealTimeStylus**](realtimestylus-class.md) object and its plug-in collections.</span></span>

![illustratiom présentant le flot de données de stylet Tablet PC](images/5a698bc9-833b-4b24-9fa2-70be0ca61032.gif)

<span data-ttu-id="5206c-139">Dans ce diagramme, les cercles « A » et « B » représentent les données du stylet de tablette qui ont déjà été ajoutées à la file d’attente de sortie de l’objet [**RealTimeStylus**](realtimestylus-class.md) et qui n’ont pas encore été envoyées à la collection de plug-in asynchrone.</span><span class="sxs-lookup"><span data-stu-id="5206c-139">In this diagram the circles lettered "A" and "B" represent tablet pen data that has already been added to the [**RealTimeStylus**](realtimestylus-class.md) object's output queue and that has not yet been sent to the asynchronous plug-in collection.</span></span> <span data-ttu-id="5206c-140">Le cercle « C » indique les données du stylet du Tablet PC actuellement traitées par l’objet **RealTimeStylus** .</span><span class="sxs-lookup"><span data-stu-id="5206c-140">The circle lettered "C" represents the tablet pen data that the **RealTimeStylus** object is currently processing.</span></span> <span data-ttu-id="5206c-141">Il est envoyé à la collection de plug-ins synchrone et placé dans la file d’attente de sortie.</span><span class="sxs-lookup"><span data-stu-id="5206c-141">It is sent to the synchronous plug-in collection and placed on the output queue.</span></span> <span data-ttu-id="5206c-142">Le cercle vide représente la position dans la file d’attente de sortie où les futures données de stylet du Tablet PC sont ajoutées.</span><span class="sxs-lookup"><span data-stu-id="5206c-142">The empty circle represents the position in the output queue where future tablet pen data is added.</span></span>

<span data-ttu-id="5206c-143">Pour plus d’informations sur la façon dont des données spécifiques sont ajoutées à la file d’attente et traitées, consultez [données de plug-in et classe RealTimeStylus](plug-in-data-and-the-realtimestylus-class.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-143">For more information about how specific data is added to the queue and processed, see [Plug-in Data and the RealTimeStylus Class](plug-in-data-and-the-realtimestylus-class.md).</span></span>

<span data-ttu-id="5206c-144">Voici un scénario minimal pour l’utilisation de l’objet [**RealTimeStylus**](realtimestylus-class.md) sur un formulaire qui collecte de l’encre.</span><span class="sxs-lookup"><span data-stu-id="5206c-144">The following is a minimal scenario for using the [**RealTimeStylus**](realtimestylus-class.md) object on a form that collects ink.</span></span>

1.  <span data-ttu-id="5206c-145">Créez un formulaire qui implémente l’interface [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) .</span><span class="sxs-lookup"><span data-stu-id="5206c-145">Create a form that implements the [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) interface.</span></span>
2.  <span data-ttu-id="5206c-146">Créez un objet [**RealTimeStylus**](realtimestylus-class.md) attaché à un contrôle du formulaire.</span><span class="sxs-lookup"><span data-stu-id="5206c-146">Create a [**RealTimeStylus**](realtimestylus-class.md) object attached to a control on the form.</span></span>
3.  <span data-ttu-id="5206c-147">Définissez l’intérêt pour les notifications StylusDown, paquets et StylusUp dans la propriété [**IStylusAsyncPlugin. DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) du formulaire.</span><span class="sxs-lookup"><span data-stu-id="5206c-147">Set interest in the StylusDown, Packets, and StylusUp notifications in the form's [**IStylusAsyncPlugin.DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) property.</span></span>
4.  <span data-ttu-id="5206c-148">Dans les méthodes [**StylusDown**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusdown), [**Packets**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-packets)et [**StylusUp**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusup) du formulaire, ajoutez du code pour gérer les notifications de stylet, de paquets et de stylet qui sont envoyées à partir de l’objet [**RealTimeStylus**](realtimestylus-class.md) du formulaire.</span><span class="sxs-lookup"><span data-stu-id="5206c-148">In the form's [**StylusDown**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusdown), [**Packets**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-packets), and [**StylusUp**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusup) methods, add code to handle the stylus down, packets, and stylus up notifications that are sent from the form's [**RealTimeStylus**](realtimestylus-class.md) object.</span></span>

<span data-ttu-id="5206c-149">Pour obtenir un exemple d’une telle application, consultez l’exemple d’une [collection d’encres RealTimeStylus](realtimestylus-ink-collection-sample.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-149">For a sample of such an application, see the [RealTimeStylus Ink Collection Sample](realtimestylus-ink-collection-sample.md).</span></span>

## <a name="working-with-tablet-objects"></a><span data-ttu-id="5206c-150">Utilisation des objets tablette</span><span class="sxs-lookup"><span data-stu-id="5206c-150">Working with Tablet Objects</span></span>

<span data-ttu-id="5206c-151">Chaque objet [**RealTimeStylus**](realtimestylus-class.md) activé gère une liste d’identificateurs uniques pour les objets [**tablette**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) avec lesquels il peut interagir.</span><span class="sxs-lookup"><span data-stu-id="5206c-151">Each enabled [**RealTimeStylus**](realtimestylus-class.md) object maintains a list of unique identifiers for the [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) objects it can interact with.</span></span> <span data-ttu-id="5206c-152">L’objet **RealTimeStylus** expose deux méthodes pour la traduction entre l’identificateur unique et l’objet **Tablet** : les méthodes [**GetTabletContextIdFromTablet**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletcontextidfromtablet) et [**GetTabletFromTabletContextId**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletfromtabletcontextid) .</span><span class="sxs-lookup"><span data-stu-id="5206c-152">The **RealTimeStylus** object exposes two methods for translating between the unique identifier and the **Tablet** object: the [**GetTabletContextIdFromTablet**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletcontextidfromtablet) and [**GetTabletFromTabletContextId**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletfromtabletcontextid) methods.</span></span>

<span data-ttu-id="5206c-153">L’objet [TabletPropertyDescription](/previous-versions/ms827769(v=msdn.10)) (en code managé) contient une propriété [PacketPropertyId](/previous-versions/ms827780(v=msdn.10)) et une structure [TabletPropertyMetrics](/previous-versions/ms827781(v=msdn.10)) qui décrit la plage, la résolution et les unités de la propriété pour un objet [**tablette**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) spécifique.</span><span class="sxs-lookup"><span data-stu-id="5206c-153">The [TabletPropertyDescription](/previous-versions/ms827769(v=msdn.10)) object (in managed code) contains a [PacketPropertyId](/previous-versions/ms827780(v=msdn.10)) property and a [TabletPropertyMetrics](/previous-versions/ms827781(v=msdn.10)) structure that describes the range, resolution, and units of the property for a specific [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object.</span></span> <span data-ttu-id="5206c-154">La méthode [**GetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription) de l’objet [**RealTimeStylus**](realtimestylus-class.md) retourne un tableau d’identificateurs globaux uniques (Guid) pour les propriétés de paquet que l’objet **RealTimeStylus** transfère à ses plug-ins lorsque ces propriétés de paquet sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="5206c-154">The [**RealTimeStylus**](realtimestylus-class.md) object's [**GetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription) method returns an array of globally unique identifiers (GUIDs) for the packet properties that the **RealTimeStylus** object forwards to its plug-ins when those packet properties are available.</span></span> <span data-ttu-id="5206c-155">Pour modifier le jeu de propriétés de paquet que l’objet **RealTimeStylus** transmet à ses plug-ins, appelez la méthode [**SetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription) de l’objet **RealTimeStylus** .</span><span class="sxs-lookup"><span data-stu-id="5206c-155">To modify the set of packet properties the **RealTimeStylus** object passes to its plug-ins, call the **RealTimeStylus** object's [**SetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription) method.</span></span> <span data-ttu-id="5206c-156">La méthode [GetTabletPropertyDescriptionCollection](/previous-versions/ms825935(v=msdn.10)) (dans le code managé) de l’objet **RealTimeStylus** prend un identificateur de tablette unique et retourne une collection d’objets [TabletPropertyDescription](/previous-versions/ms827760(v=msdn.10)) .</span><span class="sxs-lookup"><span data-stu-id="5206c-156">The [GetTabletPropertyDescriptionCollection](/previous-versions/ms825935(v=msdn.10)) method (in managed code) of the **RealTimeStylus** object takes a unique tablet identifier and returns a collection of [TabletPropertyDescription](/previous-versions/ms827760(v=msdn.10)) objects.</span></span> <span data-ttu-id="5206c-157">Ces propriétés de paquet représentent le sous-ensemble de propriétés prises en charge par la tablette qui sont retournées par la méthode **GetDesiredPacketDescription** .</span><span class="sxs-lookup"><span data-stu-id="5206c-157">These packet properties represent the subset of properties supported by the tablet that are returned by the **GetDesiredPacketDescription** method.</span></span>

<span data-ttu-id="5206c-158">Pour obtenir la liste des GUID de propriété de paquet standard, consultez la classe [constantes PacketPropertyGuids](packetpropertyguids-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="5206c-158">For a list of the standard packet property GUIDs, see the [PacketPropertyGuids Constants](packetpropertyguids-constants.md) class.</span></span>

## <a name="special-considerations"></a><span data-ttu-id="5206c-159">Considérations spéciales</span><span class="sxs-lookup"><span data-stu-id="5206c-159">Special Considerations</span></span>

<span data-ttu-id="5206c-160">La liste suivante décrit d’autres points à prendre en compte lors de l’utilisation de l’objet [**RealTimeStylus**](realtimestylus-class.md) avec un objet [**tablette**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) .</span><span class="sxs-lookup"><span data-stu-id="5206c-160">The following list describes other points to take into consideration when using the [**RealTimeStylus**](realtimestylus-class.md) object with a [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object.</span></span>

-   <span data-ttu-id="5206c-161">La méthode [**SetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription) peut uniquement être appelée lorsque l’objet [**tablette**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) est désactivé.</span><span class="sxs-lookup"><span data-stu-id="5206c-161">The [**SetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription) method can only be called while the [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object is disabled.</span></span> <span data-ttu-id="5206c-162">L’objet [**RealTimeStylus**](realtimestylus-class.md) peut modifier la liste des propriétés de paquet souhaitées ; par conséquent, appelez la méthode [**GetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription) après l’appel à la méthode **SetDesiredPacketDescription** pour déterminer les propriétés de paquet que l’objet **RealTimeStylus** peut transférer à ses plug-ins. Une tablette n’est garantie que pour prendre en charge les valeurs **X**, **Y** et **PacketStatus** pour le [PacketProperty](packetproperty-guids.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-162">The [**RealTimeStylus**](realtimestylus-class.md) object may modify the list of desired packet properties; therefore, call the [**GetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription) method after the call to the **SetDesiredPacketDescription** method to determine which packet properties the **RealTimeStylus** object can forward to its plug-ins. A tablet is only guaranteed to support the **X**, **Y**, and **PacketStatus** values for the [PacketProperty](packetproperty-guids.md).</span></span> <span data-ttu-id="5206c-163">Par conséquent, votre conception de plug-in peut être amenée à tenir compte de la réception de propriétés de paquet moins nombreuses que vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="5206c-163">Therefore, your plug-in design may need to account for receiving fewer packet properties than desired.</span></span>
-   <span data-ttu-id="5206c-164">La méthode [GetTabletPropertyDescriptionCollection](/previous-versions/ms825935(v=msdn.10)) (pour le code managé) peut être appelée uniquement lorsque l’objet [**RealTimeStylus**](realtimestylus-class.md) est activé.</span><span class="sxs-lookup"><span data-stu-id="5206c-164">The [GetTabletPropertyDescriptionCollection](/previous-versions/ms825935(v=msdn.10)) method (for managed code) can only be called while the [**RealTimeStylus**](realtimestylus-class.md) object is enabled.</span></span> <span data-ttu-id="5206c-165">Étant donné que la notification peut être envoyée aux plug-ins Async après la désactivation de l’objet **RealTimeStylus** , vous devrez peut-être mettre en cache les informations pour chaque objet [**tablette**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) .</span><span class="sxs-lookup"><span data-stu-id="5206c-165">Because notification can be sent to the async plug-ins after the **RealTimeStylus** object has been disabled, you may need to cache the information for each [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object.</span></span> <span data-ttu-id="5206c-166">La méthode GetTabletPropertyDescriptionCollection retourne une liste des propriétés de paquet souhaitées prises en charge par la tablette spécifiée.</span><span class="sxs-lookup"><span data-stu-id="5206c-166">The GetTabletPropertyDescriptionCollection method returns a list of the desired packet properties that are supported by the specified tablet.</span></span>
-   <span data-ttu-id="5206c-167">Lorsque l’objet [**RealTimeStylus**](realtimestylus-class.md) est activé, chaque plug-in reçoit un appel à sa méthode [**RealTimeStylusEnabled**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-realtimestylusenabled) .</span><span class="sxs-lookup"><span data-stu-id="5206c-167">When the [**RealTimeStylus**](realtimestylus-class.md) object is enabled, each plug-in receives a call to its [**RealTimeStylusEnabled**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-realtimestylusenabled) method.</span></span> <span data-ttu-id="5206c-168">L’objet [RealTimeStylusEnabledData](/previous-versions/ms824229(v=msdn.10)) passé dans la notification contient une collection d’identificateurs de contexte pour les tablettes disponibles au moment où l’objet **RealTimeStylus** est activé.</span><span class="sxs-lookup"><span data-stu-id="5206c-168">The [RealTimeStylusEnabledData](/previous-versions/ms824229(v=msdn.10)) object passed in the notification contains a collection of the context identifiers for the available tablets at the time the **RealTimeStylus** object is enabled.</span></span>
-   <span data-ttu-id="5206c-169">Quand une tablette que l’objet [**RealTimeStylus**](realtimestylus-class.md) peut utiliser est ajoutée ou supprimée du Tablet PC pendant que l’objet **RealTimeStylus** est activé, l’objet **RealTimeStylus** notifie ses plug-ins qu’un objet [**tablette**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) a été ajouté ou supprimé.</span><span class="sxs-lookup"><span data-stu-id="5206c-169">When a tablet that the [**RealTimeStylus**](realtimestylus-class.md) object can use is added to or removed from the Tablet PC while the **RealTimeStylus** object is enabled, the **RealTimeStylus** object notifies its plug-ins that a [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object has been added or removed.</span></span> <span data-ttu-id="5206c-170">Pour plus d’informations, consultez [données de plug-in et classe RealTimeStylus](plug-in-data-and-the-realtimestylus-class.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-170">For more information, see [Plug-in Data and the RealTimeStylus Class](plug-in-data-and-the-realtimestylus-class.md).</span></span>

## <a name="working-with-tablet-pens"></a><span data-ttu-id="5206c-171">Utilisation des stylets de tablette</span><span class="sxs-lookup"><span data-stu-id="5206c-171">Working with Tablet Pens</span></span>

<span data-ttu-id="5206c-172">L’objet [**RealTimeStylus**](realtimestylus-class.md) passe des informations sur le stylet de tablette à ses plug-ins dans un certain nombre de méthodes de notification.</span><span class="sxs-lookup"><span data-stu-id="5206c-172">The [**RealTimeStylus**](realtimestylus-class.md) object passes information about the tablet pen to its plug-ins in a number of the notification methods.</span></span> <span data-ttu-id="5206c-173">Les informations sur le stylet du Tablet PC sont représentées par un objet de [stylet](/previous-versions/ms824824(v=msdn.10)) , obtenu via la méthode [**GetStyluses**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses) .</span><span class="sxs-lookup"><span data-stu-id="5206c-173">Information about the tablet pen is represented by a [Stylus](/previous-versions/ms824824(v=msdn.10)) object, gotten through the [**GetStyluses**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses) method.</span></span> <span data-ttu-id="5206c-174">Cet objet est une représentation du stylet au moment où les données ont été rassemblées.</span><span class="sxs-lookup"><span data-stu-id="5206c-174">This object is a representation of the tablet pen at the time the data was gathered.</span></span> <span data-ttu-id="5206c-175">Étant donné que les plug-ins reçoivent les données du stylet dans le flux de données du stylet, les plug-ins doivent utiliser les informations de l’objet stylet au lieu de vérifier l’état actuel d’un stylet de tablette particulier à l’aide de la classe [**Cursor**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor) .</span><span class="sxs-lookup"><span data-stu-id="5206c-175">Because plug-ins receive the tablet pen data as part of the tablet pen data stream, the plug-ins should use the information in the Stylus object instead of checking for the current state of a particular tablet pen through the [**Cursor**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor) class.</span></span> <span data-ttu-id="5206c-176">Pour plus d’informations sur la façon dont les données du stylet du Tablet PC et du stylet sont transmises aux plug-ins, consultez [données de plug-in et classe RealTimeStylus](plug-in-data-and-the-realtimestylus-class.md).</span><span class="sxs-lookup"><span data-stu-id="5206c-176">For information about how tablet pen and tablet pen button data is passed to plug-ins, see [Plug-in Data and the RealTimeStylus Class](plug-in-data-and-the-realtimestylus-class.md).</span></span>

<span data-ttu-id="5206c-177">Pour récupérer un tableau des objets [Stylus](/previous-versions/ms824824(v=msdn.10)) que l’objet [**RealTimeStylus**](realtimestylus-class.md) a rencontrés depuis sa dernière activation, utilisez la méthode [**GetStyluses**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses) de l’objet **RealTimeStylus** .</span><span class="sxs-lookup"><span data-stu-id="5206c-177">To get an array of the [Stylus](/previous-versions/ms824824(v=msdn.10)) objects that the [**RealTimeStylus**](realtimestylus-class.md) object has encountered since it was last enabled, use the **RealTimeStylus** object's [**GetStyluses**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5206c-178">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="5206c-178">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="5206c-179">[Microsoft. Ink. Tablet](/previous-versions/ms827783(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="5206c-179">[Microsoft.Ink.Tablet](/previous-versions/ms827783(v=msdn.10))</span></span>
</dt> <dt>

<span data-ttu-id="5206c-180">[Microsoft. StylusInput. RealTimeStylus](/previous-versions/ms585724(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="5206c-180">[Microsoft.StylusInput.RealTimeStylus](/previous-versions/ms585724(v=vs.100))</span></span>
</dt> <dt>

[<span data-ttu-id="5206c-181">Modèle RealTimeStylus monté en cascade</span><span class="sxs-lookup"><span data-stu-id="5206c-181">The Cascaded RealTimeStylus Model</span></span>](the-cascaded-realtimestylus-model.md)
</dt> <dt>

[<span data-ttu-id="5206c-182">Considérations relatives à la confiance partielle pour les API StylusInput</span><span class="sxs-lookup"><span data-stu-id="5206c-182">Partial Trust Considerations for the StylusInput APIs</span></span>](partial-trust-considerations-for-the-stylusinput-apis.md)
</dt> <dt>

[<span data-ttu-id="5206c-183">Données de plug-in et classe RealTimeStylus</span><span class="sxs-lookup"><span data-stu-id="5206c-183">Plug-in Data and the RealTimeStylus Class</span></span>](plug-in-data-and-the-realtimestylus-class.md)
</dt> <dt>

[<span data-ttu-id="5206c-184">Considérations relatives aux threads pour les API StylusInput</span><span class="sxs-lookup"><span data-stu-id="5206c-184">Threading Considerations for the StylusInput APIs</span></span>](threading-considerations-for-the-stylusinput-apis.md)
</dt> </dl>

 

 
