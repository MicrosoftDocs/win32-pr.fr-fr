---
description: Dans Windows Vista, le panneau de saisie Tablet PC intègre de nouvelles fonctionnalités de saisie semi-automatique qui permettent à la liste de saisie semi-automatique d’une application d’être mise à jour en temps réel lorsque l’encre d’un utilisateur est reconnue dans le panneau de saisie.
ms.assetid: 0f01f546-f76b-4c61-a204-2a06079a374a
title: Utilisation de la saisie semi-automatique du panneau de saisie
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c9e7f108631eb2723b71bf8ed919c17a0eabff5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104112878"
---
# <a name="using-input-panel-autocomplete"></a><span data-ttu-id="9e8d7-103">Utilisation de la saisie semi-automatique du panneau de saisie</span><span class="sxs-lookup"><span data-stu-id="9e8d7-103">Using Input Panel AutoComplete</span></span>

<span data-ttu-id="9e8d7-104">Dans Windows Vista, le panneau de saisie Tablet PC intègre de nouvelles fonctionnalités de saisie semi-automatique qui permettent à la liste de saisie semi-automatique d’une application d’être mise à jour en temps réel lorsque l’encre d’un utilisateur est reconnue dans le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-104">In Windows Vista, Tablet PC Input Panel integrates new Autocomplete capabilities that enable an application's Autocomplete list to update in real time as a user's ink is recognized in Input Panel.</span></span> <span data-ttu-id="9e8d7-105">En outre, la liste de saisie semi-automatique de l’application est positionnée dans un emplacement pratique pour les utilisateurs du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-105">Additionally, the application's Autocomplete list is positioned in a convenient location for users of Input Panel.</span></span> <span data-ttu-id="9e8d7-106">Sans la saisie semi-automatique du panneau de saisie, l’utilisation des fonctionnalités de saisie semi-automatique avec le panneau de saisie est un processus difficile, qui oblige les utilisateurs à insérer un caractère à la fois et à déplacer le panneau de saisie pour accéder aux suggestions de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-106">Without Input Panel Autocomplete, using Autocomplete features with Input Panel is a difficult process, requiring users to insert one character at a time and move Input Panel in order to access Autocomplete suggestions.</span></span> <span data-ttu-id="9e8d7-107">Avec l’intégration, la saisie semi-automatique est un outil puissant pour les utilisateurs de Tablet PC qui accélère et augmente la facilité d’entrée de texte avec le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-107">With integration, Autocomplete is a powerful tool for Tablet PC users that speeds up and increases the ease of entering text with Input Panel.</span></span>

![panneau de saisie avec la liste de saisie semi-automatique IE](images/9e769482-543a-4e29-b274-8f19ae10250d.jpg)

<span data-ttu-id="9e8d7-109">Il existe trois options pour la façon dont une application peut tirer parti de l’intégration de la saisie semi-automatique du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-109">There are three options for how an application can take advantage of Input Panel Autocomplete integration.</span></span> <span data-ttu-id="9e8d7-110">Les applications qui contiennent la fonctionnalité de saisie semi-automatique construite à l’aide de la saisie semi-automatique de l’interpréteur de commandes (via l’interface [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) ) ou .NET Framework la saisie semi-automatique (via l’énumération [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) ) reçoivent l’intégration de la saisie semi-automatique du panneau de saisie sans</span><span class="sxs-lookup"><span data-stu-id="9e8d7-110">Applications that contain Autocomplete functionality built using Shell Autocomplete (through the [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) interface) or .NET Framework Autocomplete (through the [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) Enumeration) receive Input Panel Autocomplete integration without the need for code changes.</span></span> <span data-ttu-id="9e8d7-111">Les applications qui incluent des champs de texte de saisie semi-automatique personnalisés peuvent utiliser l’API de saisie semi-automatique du panneau de saisie pour obtenir la même fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-111">Applications that include custom Autocomplete text fields can use the Input Panel Autocomplete API to get the same functionality.</span></span>

<span data-ttu-id="9e8d7-112">Dans tous les cas, vous pouvez apporter ces modifications à la liste de saisie semi-automatique de l’application sans dupliquer ni modifier l’interface utilisateur ou la logique de prédiction utilisée par une application pour générer une liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-112">In all cases, you can make these modifications to the application's Autocomplete list without duplicating or modifying the UI or prediction logic used by an application to generate an Autocomplete list.</span></span> <span data-ttu-id="9e8d7-113">La liste de saisie semi-automatique continue d’être propriétaire de l’application et le contenu de la liste de saisie semi-automatique est le même que si le texte a été tapé directement dans le champ d’édition.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-113">The Autocomplete list continues to be owner drawn by the application and the contents of the Autocomplete list are the same as if the text were typed directly into the edit field.</span></span>

<span data-ttu-id="9e8d7-114">L’intégration de la saisie semi-automatique du panneau de saisie est prise en charge sur le système d’exploitation Windows Vista ou versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-114">Input Panel Autocomplete integration is supported on the Windows Vista operating system or later versions.</span></span> <span data-ttu-id="9e8d7-115">L’intégration de la saisie semi-automatique du panneau de saisie est intégrée à la saisie semi-automatique de l’interpréteur de commandes à partir de Windows Vista et dans Windows Forms développement à partir de .NET Framework version 3,0</span><span class="sxs-lookup"><span data-stu-id="9e8d7-115">Input Panel Autocomplete integration is built into Shell Autocomplete starting with Windows Vista and into Windows Forms development starting with .NET Framework version 3.0.</span></span> <span data-ttu-id="9e8d7-116">Tandis que [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) et [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) sont exécutés sur des versions antérieures de Windows, l’intégration de la saisie semi-automatique du panneau de saisie n’est pas prise en charge sur Microsoft Windows XP Tablet PC Edition ou les systèmes d’exploitation antérieurs.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-116">While [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) and [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) both run on earlier versions of Windows, Input Panel Autocomplete integration is not supported on Microsoft Windows XP Tablet PC Edition or earlier operating systems.</span></span> <span data-ttu-id="9e8d7-117">Si vous exécutez la saisie semi-automatique du panneau de saisie sur des versions antérieures de Tablet PC, les applications reprennent le comportement de pré-intégration.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-117">If you run Input Panel Autocomplete on earlier versions of Tablet PC, applications revert to the pre-integration behavior.</span></span>

## <a name="reasons-to-integrate-application-autocomplete-lists-with-input-panel"></a><span data-ttu-id="9e8d7-118">Raisons pour intégrer les listes de saisie semi-automatique des applications au panneau de saisie</span><span class="sxs-lookup"><span data-stu-id="9e8d7-118">Reasons to Integrate Application Autocomplete Lists with Input Panel</span></span>

<span data-ttu-id="9e8d7-119">L’intégration de la liste de saisie semi-automatique d’une application permet d’accélérer et de réduire la vitesse d’entrée pour les utilisateurs qui entrent du texte dans un champ de texte qui comprend la fonctionnalité de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-119">Integration of an application's Autocomplete list enables the maximum ease and speed of input for users who are entering text into a text field that includes Autocomplete functionality.</span></span> <span data-ttu-id="9e8d7-120">En outre, une application qui comprend l’intégration de la saisie semi-automatique du panneau de saisie apparaît immédiatement comme si elle avait été développée avec le Tablet PC à l’esprit, ce qui rend l’application plus attrayante pour les utilisateurs de Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-120">Furthermore, an application that includes Input Panel Autocomplete integration immediately appears as if it were developed with the Tablet PC in mind, making the application more appealing to Tablet PC users.</span></span>

### <a name="how-input-panel-and-autocomplete-list-interact-without-integration"></a><span data-ttu-id="9e8d7-121">Interaction entre le panneau de saisie et la liste de saisie semi-automatique sans intégration</span><span class="sxs-lookup"><span data-stu-id="9e8d7-121">How Input Panel and Autocomplete List Interact without Integration</span></span>

<span data-ttu-id="9e8d7-122">Utilisation du panneau de saisie pour entrer du texte dans un champ de texte qui comprend une liste de saisie semi-automatique mais qui n’est pas intégré au panneau de saisie :</span><span class="sxs-lookup"><span data-stu-id="9e8d7-122">Using Input Panel to enter text into a text field that includes an Autocomplete list but that is not integrated with Input Panel:</span></span>

1.  <span data-ttu-id="9e8d7-123">L’utilisateur place le focus dans le champ de texte et ouvre le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-123">The user places focus in the text field and opens Input Panel.</span></span>
2.  <span data-ttu-id="9e8d7-124">L’utilisateur écrit un ou deux caractères.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-124">The user writes one or two characters.</span></span>
3.  <span data-ttu-id="9e8d7-125">L’utilisateur appuie sur **Inser**.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-125">The user taps **Insert**.</span></span> <span data-ttu-id="9e8d7-126">Le panneau de saisie entre le texte dans le champ de texte de l’application.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-126">Input Panel enters the text into the application's text field.</span></span> <span data-ttu-id="9e8d7-127">La liste de saisie semi-automatique de l’application s’affiche et est probablement partiellement ou complètement masquée par le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-127">The application's Autocomplete list appears and is most likely partially or completely obscured by Input Panel.</span></span>
4.  <span data-ttu-id="9e8d7-128">L’utilisateur fait glisser le panneau de saisie pour découvrir la liste de saisie semi-automatique de l’application.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-128">The user drags Input Panel to uncover the application's Autocomplete list.</span></span>
5.  <span data-ttu-id="9e8d7-129">En supposant que l’entrée correcte est incluse dans la liste de saisie semi-automatique, l’utilisateur peut maintenant sélectionner cette entrée. dans le cas contraire, l’utilisateur doit répéter les étapes 2 et 3.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-129">Assuming the correct entry is included in the Autocomplete list, the user can now select that entry; otherwise the user must repeat steps 2 and 3.</span></span>

<span data-ttu-id="9e8d7-130">Ce processus est clairement fastidieux.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-130">This is clearly a cumbersome process.</span></span> <span data-ttu-id="9e8d7-131">Les attentes de l’utilisateur quant à la façon dont une liste de saisie semi-automatique doit fonctionner sont en tirets et leur capacité à effectuer des tâches en pâtit.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-131">The user's expectations of how an Autocomplete list should work are dashed, and their ability to perform tasks suffers.</span></span>

### <a name="how-input-panel-and-autocomplete-list-interaction-improves-with-integration"></a><span data-ttu-id="9e8d7-132">Amélioration de l’interaction entre le panneau de saisie et la liste de saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="9e8d7-132">How Input Panel and Autocomplete List Interaction Improves with Integration</span></span>

<span data-ttu-id="9e8d7-133">Utilisation du panneau de saisie pour entrer du texte dans un champ de texte qui comprend une liste de saisie semi-automatique intégrée au panneau de saisie :</span><span class="sxs-lookup"><span data-stu-id="9e8d7-133">Using Input Panel to enter text into a text field that includes an Autocomplete list that is integrated with Input Panel:</span></span>

1.  <span data-ttu-id="9e8d7-134">L’utilisateur place le focus dans le champ de texte et ouvre le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-134">The user places focus in the text field and opens Input Panel.</span></span>
2.  <span data-ttu-id="9e8d7-135">L’utilisateur écrit un ou deux caractères.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-135">The user writes one or two characters.</span></span> <span data-ttu-id="9e8d7-136">La liste de saisie semi-automatique de l’application apparaît juste au-dessus ou directement sous le panneau de saisie lorsque l’utilisateur écrit du texte.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-136">The application's Autocomplete list appears directly above or directly below Input Panel as the user writes text.</span></span>
3.  <span data-ttu-id="9e8d7-137">L’utilisateur sélectionne l’entrée dans la liste de saisie semi-automatique. l’entrée est insérée directement dans le champ de texte de l’application, ou l’utilisateur répète l’étape 2 jusqu’à ce que l’entrée correcte apparaisse.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-137">The user selects the entry from the Autocomplete list; the entry is inserted directly into the application's text field, or the user repeats step 2 until the correct entry appears.</span></span>

<span data-ttu-id="9e8d7-138">En raison de l’intégration, la liste de saisie semi-automatique s’affiche et est mise à jour pendant que l’utilisateur écrit dans le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-138">Due to the integration, the Autocomplete list appears and updates while the user is writing in Input Panel.</span></span> <span data-ttu-id="9e8d7-139">En outre, la liste est positionnée de manière à ce qu’elle soit à la fois pratique pour l’utilisateur et pour l’accès en écriture et non masquée par le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-139">Additionally, the list is positioned so that it is both convenient for the user to access while writing and not obscured by Input Panel.</span></span> <span data-ttu-id="9e8d7-140">Enfin, lorsque l’utilisateur sélectionne un élément dans une liste de saisie semi-automatique, l’élément est inséré directement dans le champ d’entrée de texte de l’application, ce qui permet à l’utilisateur de contourner l’étape d’insertion du texte à partir du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-140">Lastly, when the user selects an item from an Autocomplete list the item is inserted directly into the application's text entry field, thus enabling the user to bypass the step of inserting text from Input Panel.</span></span>

![panneau de saisie avec la liste de saisie semi-automatique Outlook Express](images/ba59a513-e538-4092-89a6-6d691424dc3d.jpg)

## <a name="standard-autocomplete-components-that-include-input-panel-autocomplete-integration"></a><span data-ttu-id="9e8d7-142">Composants de saisie semi-automatique standard incluant l’intégration de la saisie semi-automatique du panneau de saisie</span><span class="sxs-lookup"><span data-stu-id="9e8d7-142">Standard Autocomplete Components that include Input Panel Autocomplete Integration</span></span>

<span data-ttu-id="9e8d7-143">[**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) et [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) incluent une intégration intégrée de la saisie semi-automatique du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-143">Both [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) and [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) include built-in integration of Input Panel Autocomplete.</span></span> <span data-ttu-id="9e8d7-144">Les applications utilisant l’un de ces composants standard de saisie semi-automatique peuvent tirer parti de la fonctionnalité de saisie semi-automatique du panneau de saisie, avec peu de travail supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-144">Applications using either of these standard Autocomplete components can take advantage of Input Panel Autocomplete functionality with little to no additional work.</span></span> <span data-ttu-id="9e8d7-145">En outre, alors que la saisie semi-automatique du panneau de saisie est uniquement prise en charge sur Windows Vista ou les nouvelles versions du système d’exploitation Windows, les applications qui ont été créées à l’aide de **IAutoComplete** avant la sortie de Windows Vista bénéficient automatiquement de l’intégration de la saisie semi-automatique du panneau de saisie lorsqu’elles sont exécutées sur Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-145">Additionally, while Input Panel Autocomplete is only supported on Windows Vista or new versions of the Windows operating system, applications that were built using **IAutoComplete** prior to the release of Windows Vista get Input Panel Autocomplete integration automatically when run on Windows Vista.</span></span> <span data-ttu-id="9e8d7-146">Les sections suivantes contiennent des informations supplémentaires sur les éléments **IAutoComplete** et AutoCompleteMode spécifiques qui incluent l’intégration de la saisie semi-automatique du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-146">The following sections contain more information about the specific **IAutoComplete** and AutoCompleteMode elements that include Input Panel Autocomplete integration.</span></span>

### <a name="shell-autocomplete-with-input-panel-autocomplete-integration"></a><span data-ttu-id="9e8d7-147">Saisie semi-automatique du shell avec intégration de la saisie semi-automatique du panneau de saisie</span><span class="sxs-lookup"><span data-stu-id="9e8d7-147">Shell Autocomplete with Input Panel Autocomplete Integration</span></span>

<span data-ttu-id="9e8d7-148">Les applications qui utilisent [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) bénéficient de l’intégration de la saisie semi-automatique du panneau de saisie gratuitement.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-148">Applications that use [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) get Input Panel Autocomplete integration for free.</span></span> <span data-ttu-id="9e8d7-149">Si les API de saisie semi-automatique de l’interpréteur de commandes sont incluses dans Windows 2000, l’intégration de la saisie semi-automatique du panneau de saisie ne prend en charge que sur Windows Vista et les versions plus récentes</span><span class="sxs-lookup"><span data-stu-id="9e8d7-149">While the Shell Autocomplete APIs are included in Windows 2000 onward, Input Panel Autocomplete integration is only support on Windows Vista and newer versions.</span></span> <span data-ttu-id="9e8d7-150">Toutefois, les applications créées avant la sortie de Windows Vista qui utilisent **IAutoComplete** bénéficient automatiquement de l’intégration de la saisie semi-automatique du panneau de saisie lorsqu’elles sont exécutées sur Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-150">However, applications built prior to the release of Windows Vista that use **IAutoComplete** automatically get Input Panel Autocomplete integration when run on Windows Vista.</span></span>

<span data-ttu-id="9e8d7-151">Pour tirer parti de la saisie semi-automatique des tablettes de cette façon, vous devez utiliser l’objet de saisie semi-automatique (**\_ saisie semi**-automatique CLSID).</span><span class="sxs-lookup"><span data-stu-id="9e8d7-151">In order to take advantage of Tablet Autocomplete in this way, you must use the autocomplete object (**CLSID\_Autocomplete**).</span></span> <span data-ttu-id="9e8d7-152">Si vous souhaitez fournir une fonctionnalité de saisie semi-automatique pour les URL ou les noms de fichiers, utilisez la fonction [**SHAutoComplete**](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete) pour créer l’objet de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-152">If you wish to provide autocomplete functionality for URLs or file names, use the [**SHAutoComplete**](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete) function to create the autocomplete object.</span></span>

<span data-ttu-id="9e8d7-153">En plus de [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete), vous pouvez implémenter [**IAutoComplete2**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete2) ou [**IAutoCompleteDropDown**](/windows/win32/api/shobjidl/nn-shobjidl-iautocompletedropdown)s directement, tout en continuant à bénéficier automatiquement de l’intégration de la saisie semi-automatique du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-153">In addition to [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete), you can implement [**IAutoComplete2**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete2) or [**IAutoCompleteDropDown**](/windows/win32/api/shobjidl/nn-shobjidl-iautocompletedropdown)s directly and still get Input Panel Autocomplete integration automatically.</span></span>

### <a name="input-panel-autocomplete-integration-with-net-framework-applications"></a><span data-ttu-id="9e8d7-154">Intégration de la saisie semi-automatique du panneau de saisie avec les applications .NET Framework</span><span class="sxs-lookup"><span data-stu-id="9e8d7-154">Input Panel Autocomplete Integration with .NET Framework Applications</span></span>

<span data-ttu-id="9e8d7-155">À partir de .NET Framework 3,0, Windows Forms zones de texte incluent la saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-155">Starting in .NET Framework 3.0, Windows Forms textboxes include Autocomplete.</span></span> <span data-ttu-id="9e8d7-156">Windows Forms la saisie semi-automatique de zone de texte repose sur la saisie semi-automatique du shell, ce qui signifie également que l’intégration de la saisie semi-automatique du panneau de saisie est également intégrée.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-156">Windows Forms textbox Autocomplete is built on top of Shell Autocomplete, which means Input Panel Autocomplete integration is built in, too.</span></span> <span data-ttu-id="9e8d7-157">.NET Framework 3,0 est pris en charge sur les éditions Windows antérieures à Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-157">.NET Framework 3.0 is supported down level on Windows editions released prior to Windows Vista.</span></span> <span data-ttu-id="9e8d7-158">Toutefois, étant donné que l’intégration de la saisie semi-automatique du panneau de saisie est uniquement prise en charge sur Windows Vista ou versions ultérieures, l’intégration de la saisie semi-automatique du panneau de saisie ne fonctionne que dans une application .NET Framework 3,0 quand elle est installée sur Windows Vista ou versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-158">However, because Input Panel Autocomplete integration is only supported on Windows Vista or later versions, Input Panel Autocomplete integration only works in a .NET Framework 3.0 application when it is installed on Windows Vista or later versions.</span></span>

<span data-ttu-id="9e8d7-159">Les applications qui souhaitent tirer parti de l’intégration de la saisie semi-automatique du panneau de saisie dans .NET Framework 3,0 doivent utiliser une [zone de texte](/dotnet/api/system.windows.forms.textbox?view=netcore-3.1) Windows Forms avec la propriété [AutoCompleteMode](/dotnet/api/system.windows.forms.textbox.autocompletemode?view=netcore-3.1) activée.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-159">Applications wishing to take advantage of Input Panel Autocomplete integration in .NET Framework 3.0 must use a Windows Forms [TextBox](/dotnet/api/system.windows.forms.textbox?view=netcore-3.1) with the [AutoCompleteMode](/dotnet/api/system.windows.forms.textbox.autocompletemode?view=netcore-3.1) property enabled.</span></span> <span data-ttu-id="9e8d7-160">Vous n’avez pas besoin d’effectuer d’autres tâches en plus de Windows Forms la saisie semi-automatique pour travailler pour tirer parti de l’intégration de la saisie semi-automatique du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-160">You need not do any additional work beyond getting Windows Forms Autocomplete to work to take advantage of Input Panel Autocomplete integration.</span></span>

## <a name="using-input-panel-autocomplete-apis-directly"></a><span data-ttu-id="9e8d7-161">Utilisation directe des API de saisie semi-automatique du panneau de saisie</span><span class="sxs-lookup"><span data-stu-id="9e8d7-161">Using Input Panel Autocomplete APIs Directly</span></span>

<span data-ttu-id="9e8d7-162">Les développeurs de zones de texte à saisie semi-automatique personnalisée doivent travailler directement avec les API de saisie semi-automatique du panneau de saisie pour obtenir une expérience d’entrée de texte améliorée que l’intégration de la saisie semi-automatique du panneau de saisie permet dans leurs applications.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-162">Developers of custom Autocomplete textboxes need to work with the Input Panel Autocomplete APIs directly in order to get the improved text input experience that Input Panel Autocomplete integration enables in their applications.</span></span> <span data-ttu-id="9e8d7-163">Les API de saisie semi-automatique du panneau de saisie sont incluses dans le cadre du système d’exploitation Windows Vista et dans le cadre du kit de développement logiciel (SDK) de plateforme Tablet 1,9 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-163">The Input Panel Autocomplete APIs are included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or later.</span></span> <span data-ttu-id="9e8d7-164">Les interfaces de saisie semi-automatique du panneau de saisie sont des interfaces basées sur COM.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-164">The Input Panel Autocomplete interfaces are COM-based interfaces.</span></span>

<span data-ttu-id="9e8d7-165">La section suivante décrit l’utilisation de ces interfaces en détail pour une application C++.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-165">The following section describes working these interfaces in detail for a C++ application.</span></span> <span data-ttu-id="9e8d7-166">Toutefois, ces interfaces COM peuvent être implémentées dans la plupart des langages, y compris C \# , via l’utilisation de COM Interop.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-166">However, these COM interfaces can be implemented in most languages, including C\#, through the use of COM Interop.</span></span>

<span data-ttu-id="9e8d7-167">Afin d’implémenter l’intégration de la saisie semi-automatique du panneau de saisie dans une zone de texte de saisie semi-automatique personnalisée, les deux interfaces requises sont l' [**interface ITipAutocompleteProvider**](itipautocompleteprovider.md) et l' [**interface ITipAutocompleteClient**](itipautocompleteclient.md).</span><span class="sxs-lookup"><span data-stu-id="9e8d7-167">In order to implement Input Panel Autocomplete integration in a custom Autocomplete text box, the two required interfaces are the [**ITipAutocompleteProvider Interface**](itipautocompleteprovider.md) and the [**ITipAutocompleteClient Interface**](itipautocompleteclient.md).</span></span> <span data-ttu-id="9e8d7-168">Les définitions de ces interfaces se trouvent dans TipAutoComplete. h et TipAutoComplete \_ i.c.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-168">The definitions for these interfaces are found in TipAutoComplete.h and TipAutoComplete\_i.c.</span></span>

<span data-ttu-id="9e8d7-169">Tout d’abord, une application doit définir et instancier une classe de fournisseur de saisie semi-automatique, qui implémente [**ITipAutocompleteProvider**](itipautocompleteprovider.md) pour chaque champ d’entrée de texte qui comprend une liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-169">First, an application must define and instantiate an Autocomplete provider class, which implements [**ITipAutocompleteProvider**](itipautocompleteprovider.md) for each text entry field that includes an Autocomplete list.</span></span> <span data-ttu-id="9e8d7-170">Cette classe gère le côté de l’application de l’intégration de la saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-170">This class manages the application's side of the Autocomplete integration.</span></span> <span data-ttu-id="9e8d7-171">Toutes les demandes de saisie semi-automatique à partir du panneau de saisie sont effectuées du client de saisie semi-automatique à l’application via le fournisseur de saisie semi-automatique de l’application.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-171">All Autocomplete requests from Input Panel are made from the Autocomplete client to the application via the application's Autocomplete provider.</span></span> <span data-ttu-id="9e8d7-172">Le fournisseur de saisie semi-automatique de l’application doit avoir accès à la fois à HWND pour la liste de saisie semi-automatique de l’application et à HWIND pour le champ d’entrée de texte associé.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-172">The application's Autocomplete provider must have access to both the HWND for the application's Autocomplete list and the HWIND for the associated text entry field.</span></span> <span data-ttu-id="9e8d7-173">En outre, les méthodes suivantes de **ITipAutocompleteProvider** doivent être implémentées :</span><span class="sxs-lookup"><span data-stu-id="9e8d7-173">Additionally, the following methods of **ITipAutocompleteProvider** must be implemented:</span></span>

-   <span data-ttu-id="9e8d7-174">[**ITipAutocompleteProvider :: UpdatePendingText, méthode**](itipautocompleteprovider-updatependingtext.md): cette méthode est utilisée par le client de saisie semi-automatique pour notifier l’application du texte qu’un utilisateur a écrit dans le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-174">[**ITipAutocompleteProvider::UpdatePendingText Method**](itipautocompleteprovider-updatependingtext.md): This method is used by the Autocomplete client to notify the application of the text a user has written into Input Panel.</span></span> <span data-ttu-id="9e8d7-175">Lors de la réception de cette notification, le fournisseur est responsable de la génération d’une liste de saisie semi-automatique comme si le texte avait été tapé dans le champ d’entrée de texte de l’application.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-175">Upon receiving this notification, the provider is responsible for generating an Autocomplete list as if the text had been typed into the application's text entry field.</span></span> <span data-ttu-id="9e8d7-176">La chaîne transmise au fournisseur de saisie semi-automatique au moyen de la **méthode ITipAutocompleteProvider :: UpdatePendingText** comprend uniquement le texte actuellement dans le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-176">The string pass to the Autocomplete provider by means of **ITipAutocompleteProvider::UpdatePendingText Method** only includes the text currently in Input Panel.</span></span> <span data-ttu-id="9e8d7-177">Par conséquent, s’il y a du texte supplémentaire dans le champ d’entrée de texte, il incombe au fournisseur de l’ajouter correctement au texte envoyé par le client.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-177">Therefore, if there is additional text in the text entry field, it is the responsibility of the provider to properly append it to the text sent by the client.</span></span> <span data-ttu-id="9e8d7-178">Le passage de chaîne par la **méthode ITipAutocompleteProvider :: UpdatePendingText** doit être traité comme un remplacement de la sélection actuelle dans le champ.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-178">The string pass by **ITipAutocompleteProvider::UpdatePendingText Method** should be treated as a replacement for the current selection in the field.</span></span> <span data-ttu-id="9e8d7-179">S’il n’y a aucune sélection actuelle, elle doit être placée à la position du point d’insertion actuel.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-179">If there is no current selection, it should be placed at the position of the current insertion point.</span></span> <span data-ttu-id="9e8d7-180">Une fois la liste de saisie semi-automatique générée, le fournisseur doit appeler la [**méthode ITipAutocompleteProvider :: Show**](itipautocompleteprovider-show.md) en passant la **valeur true** pour afficher la liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-180">Once the Autocomplete list is generated, the provider should call the [**ITipAutocompleteProvider::Show Method**](itipautocompleteprovider-show.md) passing in **TRUE** to display the Autocomplete list.</span></span> <span data-ttu-id="9e8d7-181">L’application ne doit pas mettre en cache les appels à **UpdatePendingText** , mais traiter chaque appel supplémentaire à **UpdatePendingText** en tant qu’annulation de l’appel précédent afin d’éviter le clignotement d’une interface utilisateur de liste de saisie semi-automatique obsolète. L’exemple de code suivant illustre ces pratiques.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-181">The application should not cache calls to **UpdatePendingText** but rather treat each additional call to **UpdatePendingText** as a cancellation of the previous call to avoid flashing an out-of-date Autocomplete list UI.The following example code illustrates these practices.</span></span>

    ```C++
    HRESULT SampleProvider::UpdatePendingText(BSTR bstrPendingText)
    {
       //Discard previously cached pending text from Input Panel
       m_bstrPending.Empty();
        //Store the new pending text from Input Panel as m_bstrPending
    m_bstrPending = bstrPendingText;

        //Get the text from the field in two chunks. The characters to
    //the left of the selection and the characters to the right.
    CComBSTR bstrLeftContext = //Text to the left of the selection
            CComBSTR bstrRightContext = //Text to the right of the selection

    //Discard previously cached complete text
        m_bstrCompleteText.Empty();
        //Append to the field text from the left of the selection
        //the text from Input Panel and then append to that
        //the field text to the right of the selection
        m_bstrCompleteText.Append(bstrLeftContext);
        m_bstrCompleteText.Append(m_bstrPending);
        m_bstrCompleteText.Append(bstrRigtContext);

        //Update the app's AC list based on m_bstrCompleteText
        //...

        //Show the updated AC list by calling the provider's Show method
       Show(true);
       return S_OK;
    }
    ```

    

-   <span data-ttu-id="9e8d7-182">[**ITipAutocompleteProvider :: Show, méthode**](itipautocompleteprovider-show.md): cette méthode est appelée à partir de [**UpdatePendingText**](itipautocompleteprovider-updatependingtext.md), mais elle peut également être appelée par le client de saisie semi-automatique à tout moment.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-182">[**ITipAutocompleteProvider::Show Method**](itipautocompleteprovider-show.md): This method is called from [**UpdatePendingText**](itipautocompleteprovider-updatependingtext.md), but also can be called by the Autocomplete client at anytime.</span></span> <span data-ttu-id="9e8d7-183">Lors de la réception de cet appel, le fournisseur de saisie semi-automatique doit masquer ou afficher le fournisseur de saisie semi-automatique comme indiqué par le paramètre.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-183">Upon receiving this call, the Autocomplete provider must hide or show the Autocomplete provider as indicated by the parameter.</span></span> <span data-ttu-id="9e8d7-184">Avant d’afficher la liste de saisie semi-automatique, le fournisseur de saisie semi-automatique est censé consulter le client de saisie semi-automatique concernant l’emplacement de la liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-184">Prior to showing the Autocomplete list the Autocomplete provider is expected to consult the Autocomplete client about where to position the Autocomplete list.</span></span> <span data-ttu-id="9e8d7-185">Plus d’informations sur le positionnement de la liste de saisie semi-automatique apparaissent plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-185">More information about positioning the Autocomplete list appears later in this article.</span></span>

<span data-ttu-id="9e8d7-186">Ensuite, l’application doit utiliser la fonction [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) Active Template Library (ATL) pour produire une instance de l' [**interface ITipAutocompleteClient**](itipautocompleteclient.md) avec l’ID de classe **CLSID \_ TipAutoCompleteClient** en tant que serveur in-process, puis inscrire le fournisseur auprès du client.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-186">Next, the application should use the Active Template Library (ATL) [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of the [**ITipAutocompleteClient Interface**](itipautocompleteclient.md) with class id **CLSID\_TipAutoCompleteClient** as an in-process server, and then register the provider with the client.</span></span> <span data-ttu-id="9e8d7-187">La [**méthode ITipAutocompleteClient :: AdviseProvider**](itipautocompleteclient-adviseprovider.md) du client de saisie semi-automatique inscrit le fournisseur auprès du client pour permettre au client d’appeler l’objet fournisseur de saisie semi-automatique de l’application.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-187">The Autocomplete client [**ITipAutocompleteClient::AdviseProvider Method**](itipautocompleteclient-adviseprovider.md) registers the provider with the client to enable the client to call the application's Autocomplete provider object.</span></span> <span data-ttu-id="9e8d7-188">Si tiptsf.dll n’est pas présent sur le système, la fonction **CoCreateInstance** échoue et retourne **RegDB \_ E \_ CLASSNOTREG**.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-188">If tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**.</span></span> <span data-ttu-id="9e8d7-189">À ce stade, l’application peut ignorer son objet [**ITipAutocompleteProvider**](itipautocompleteprovider.md) et se poursuivre comme si le panneau de saisie n’existait pas, car il ne s’agit pas d’un système de ce type.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-189">At this point the application can discard its [**ITipAutocompleteProvider**](itipautocompleteprovider.md) object and proceed as if Input Panel does not exist, because it does not on such a system.</span></span>

<span data-ttu-id="9e8d7-190">L’application peut choisir de créer une instance de [**ITipAutocompleteClient**](itipautocompleteclient.md) ou une instance par champ de texte.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-190">The application can choose to create one instance of [**ITipAutocompleteClient**](itipautocompleteclient.md) or one instance per text field.</span></span> <span data-ttu-id="9e8d7-191">La première option requiert l’annulation de l’inscription et de l’inscription du fournisseur chaque fois que le focus est modifié.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-191">The first option requires the provider to be unregistered and registered each time the focus is changed.</span></span> <span data-ttu-id="9e8d7-192">Pour plus d’informations sur l’annulation de l’inscription du fournisseur de saisie semi-automatique, plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-192">More information about unregistering the Autocomplete provider appears later in this topic.</span></span>

<span data-ttu-id="9e8d7-193">Plusieurs étapes sont nécessaires pour positionner la liste de saisie semi-automatique qui doit être coordonnée entre le fournisseur de saisie semi-automatique (application) et le client de saisie semi-automatique (panneau de saisie).</span><span class="sxs-lookup"><span data-stu-id="9e8d7-193">There are several steps involved in positioning the Autocomplete list that must be coordinated between the Autocomplete provider (application) and the Autocomplete client (Input Panel).</span></span> <span data-ttu-id="9e8d7-194">Avant que la liste de saisie semi-automatique ne soit affichée, à la suite d’un appel à la méthode [**Show**](itipautocompleteprovider-show.md) du fournisseur de saisie semi-automatique ou en raison de l’entrée de texte par l’utilisateur à l’aide du clavier, le fournisseur est tenu de consulter le client sur l’emplacement de la liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-194">Before the Autocomplete list is shown, either as a result of a call to the Autocomplete provider's [**Show**](itipautocompleteprovider-show.md) method or due to the user entering text using the keyboard, the provider is required to consult the client about where to position the Autocomplete list.</span></span> <span data-ttu-id="9e8d7-195">Le fournisseur doit effectuer les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="9e8d7-195">The provider should take the following steps:</span></span>

-   <span data-ttu-id="9e8d7-196">Utilisez la [**méthode ITipAutocompleteClient :: RequestShowUI**](itipautocompleteclient-requestshowui.md) du client de saisie semi-automatique pour déterminer si le panneau de saisie est prêt à afficher la liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-196">Use the Autocomplete client's [**ITipAutocompleteClient::RequestShowUI Method**](itipautocompleteclient-requestshowui.md) to determine whether Input Panel is ready to have the Autocomplete list shown.</span></span> <span data-ttu-id="9e8d7-197">**RequestShowUI** prend le paramètre *HWND* qui est le HWND de la fenêtre Liste de saisie semi-automatique, et la méthode retourne **true** ou **false** pour indiquer s’il s’agit de l’État dans lequel la liste de saisie semi-automatique peut être affichée.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-197">**RequestShowUI** takes the *HWND* parameter that is the HWND for the Autocomplete list window, and the method returns **TRUE** or **FALSE** to indicate if it is the state in which the Autocomplete list can be shown.</span></span> <span data-ttu-id="9e8d7-198">Si le client retourne la **valeur false**, le fournisseur ne doit pas tenter d’afficher la liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-198">If the client returns **FALSE**, the provider should not attempt to show the Autocomplete list.</span></span>
-   <span data-ttu-id="9e8d7-199">Appelez [**RequestShowUI**](itipautocompleteclient-requestshowui.md) pour définir le handle de fenêtre de la liste de saisie semi-automatique des fenêtres contextuelles avant d’appeler la [**méthode ITipAutocompleteClient ::P referredrects**](itipautocompleteclient-preferredrects.md).</span><span class="sxs-lookup"><span data-stu-id="9e8d7-199">Call [**RequestShowUI**](itipautocompleteclient-requestshowui.md) to set the popup Autocomplete list window handle before you call the [**ITipAutocompleteClient::PreferredRects Method**](itipautocompleteclient-preferredrects.md).</span></span> <span data-ttu-id="9e8d7-200">Dans le cas contraire, une erreur d' **E \_ INVALIDARG** se produira lors de l’appel de **PreferredRects**.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-200">Failure to do so will cause an **E\_INVALIDARG** error when calling **PreferredRects**.</span></span>
-   <span data-ttu-id="9e8d7-201">Si [**RequestShowUI**](itipautocompleteclient-requestshowui.md) retourne la **valeur true**, le fournisseur doit calculer le rectangle de coordonnée d’écran par défaut de la liste de saisie semi-automatique en fonction de l’emplacement du champ d’entrée de texte, puis appeler la [**méthode ITipAutocompleteClient ::P referredrects**](itipautocompleteclient-preferredrects.md)du client de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-201">If [**RequestShowUI**](itipautocompleteclient-requestshowui.md) returns **TRUE**, the provider should calculate the default screen coordinate rectangle of the Autocomplete list based on the location of the text entry field, and then call the Autocomplete client's [**ITipAutocompleteClient::PreferredRects Method**](itipautocompleteclient-preferredrects.md).</span></span> <span data-ttu-id="9e8d7-202">Cela permet au client de saisie semi-automatique d’ajuster le rectangle pour éviter que la liste de saisie semi-automatique se chevauche avec le panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-202">This allows the Autocomplete client to adjust the rectangle to avoid the Autocomplete list overlapping with Input Panel.</span></span> <span data-ttu-id="9e8d7-203">La méthode **PreferredRects** accepte quatre paramètres :</span><span class="sxs-lookup"><span data-stu-id="9e8d7-203">The **PreferredRects** method takes four parameters:</span></span>

    -   <span data-ttu-id="9e8d7-204">RECT *rcACList*: rectangle de coordonnée d’écran par défaut de la liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-204">RECT *rcACList*: The default screen coordinate rectangle of the Autocomplete list.</span></span>
    -   <span data-ttu-id="9e8d7-205">RECT *rcField*: rectangle de la coordonnée d’écran du champ d’entrée de texte correspondant.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-205">RECT *rcField*: The screen coordinate rectangle of the corresponding text entry field.</span></span>
    -   <span data-ttu-id="9e8d7-206">RECT *\* prcModifiedACList*: rectangle de coordonnées d’écran ajusté pour la saisie semi-automatique</span><span class="sxs-lookup"><span data-stu-id="9e8d7-206">RECT *\*prcModifiedACList*: The adjusted screen coordinate rectangle for the Autocomplete</span></span>
    -   <span data-ttu-id="9e8d7-207">BOOL *\* pfShowAbove*: ce paramètre indique au fournisseur si le rectangle *prcModifiedACList* place la liste de saisie semi-automatique au-dessus ou en dessous du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-207">BOOL *\*pfShowAbove*: This parameter indicates to the provider whether the *prcModifiedACList* rectangle positions the Autocomplete list above or below Input Panel.</span></span> <span data-ttu-id="9e8d7-208">L’application peut utiliser ces informations pour dessiner correctement les éléments d’interface utilisateur tels que les poignées de redimensionnement et les barres de défilement.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-208">The application can use this information to correctly draw UI elements such as resize handles and scroll bars.</span></span> <span data-ttu-id="9e8d7-209">Le fournisseur doit passer initialement dans la direction selon laquelle la liste de saisie semi-automatique est positionnée par rapport au champ d’entrée de texte par *rcACList*.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-209">The provider should initially pass in the direction that the Autocomplete list would be positioned relative to the text entry field by *rcACList*.</span></span> <span data-ttu-id="9e8d7-210">Le client ne change pas *pfShowAbove* s’il définit *PrcModifiedACList* égal à *rcACList*.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-210">The client does not change *pfShowAbove* if it sets *prcModifiedACList* equal to *rcACList*.</span></span>

    <span data-ttu-id="9e8d7-211">Utilisez les valeurs de retour des arguments *prcModifiedACList* et *pfShowAbove* out pour positionner et afficher la fenêtre Liste de saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-211">Use the return values of the *prcModifiedACList* and *pfShowAbove* out arguments to position and show the Autocomplete list window.</span></span> <span data-ttu-id="9e8d7-212">Si le panneau de saisie n’est pas utilisé, [**RequestShowUI**](itipautocompleteclient-requestshowui.md) retourne toujours **true** et *PrcModifiedACList* est toujours identique à *rcACList*.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-212">If Input Panel is not in use, [**RequestShowUI**](itipautocompleteclient-requestshowui.md) always returns **TRUE** and *prcModifiedACList* is always the same as *rcACList*.</span></span> <span data-ttu-id="9e8d7-213">*pfShowAbove* est également inchangé, le résultat est que les appels n’ont aucun effet sur le comportement de l’application.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-213">*pfShowAbove* is also unchanged, the result being that the calls have no affect on the application behavior.</span></span> <span data-ttu-id="9e8d7-214">L’exemple de code suivant illustre ces pratiques.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-214">The following example code illustrates these practices.</span></span>


```C++
HRESULT SampleProvider::Show(BOOL fShow)
{
    //Ask the AC client if it is OK to show the Autocomplete list.
    BOOL fAllowShowing = FALSE;
    m_spACClient->RequestShowUI(m_hWndList, &fAllowShowing);

    if (fShow && fAllowingShowing)
        {
            // Create the parameters required to call PreferredRects
            RECT rcField = //Rectangle for app's text field
            RECT rcACList = //Default rectangle for app's AC list
            RECT rcModifiedACList = {0, 0, 0, 0};
            BOOL fShowAbove = TRUE;

//Ask the AC client to modify the position of the AC list
m_spACClient->PreferredRects(&rcACList, &rcField,
&rcModifiedACList, &fShowAbove);

            //Show the Autocomplete UI at the modified preferred rectangle
            //from rcModifiedACList and the directional info provide by
//fShowAbove
            //...
        }
    else
        {
        //Hide the Autocomplete list and clean up
        //...
        }
    return S_OK;
}
```



<span data-ttu-id="9e8d7-215">Lorsque l’utilisateur sélectionne un élément dans la liste de saisie semi-automatique, le fournisseur doit appeler la [**méthode ITipAutocompleteClient :: UserSelection**](itipautocompleteclient-userselection.md) du client en plus de l’insertion du texte de l’élément sélectionné dans le champ d’entrée de texte.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-215">When the user selects an item in the Autocomplete list, the provider needs to call the client's [**ITipAutocompleteClient::UserSelection Method**](itipautocompleteclient-userselection.md) in addition to inserting the selected item text into the text entry field.</span></span> <span data-ttu-id="9e8d7-216">Le panneau de saisie utilise cette notification pour ignorer tout le texte restant qui n’a pas encore été inséré à partir du panneau de saisie.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-216">Input Panel uses this notification to discard all remaining text that has not yet been inserted from Input Panel.</span></span>

<span data-ttu-id="9e8d7-217">Enfin, lorsque le fournisseur n’est plus nécessaire, le fournisseur doit être dissocié du client de saisie semi-automatique en appelant la [**méthode ITipAutocompleteClient :: UnadviseProvider**](itipautocompleteclient-unadviseprovider.md) du client de saisie semi-automatique pour annuler l’inscription du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-217">Finally, when the provider is no longer necessary, the provider should be unlinked from the Autocomplete client by calling the Autocomplete client's [**ITipAutocompleteClient::UnadviseProvider Method**](itipautocompleteclient-unadviseprovider.md) to unregister the provider.</span></span> <span data-ttu-id="9e8d7-218">Il peut être nécessaire d’annuler l’inscription du fournisseur pour l’une des deux raisons suivantes : étant donné que le champ d’entrée de texte auquel le fournisseur est associé a été détruit, ou parce que l’application choisit de créer un seul client de saisie semi-automatique par champ d’entrée de texte.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-218">The provider may need to be unregistered for one of two reasons: because the text entry field the provider is associated with has been destroyed, or because the application chooses to create only one Autocomplete client, instead of one per text entry field.</span></span> <span data-ttu-id="9e8d7-219">Dans cette instance, le fournisseur doit être désinscrit chaque fois que le focus est éloigné du champ de texte.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-219">In this instance the provider must be unregistered every time that focus is switched away from the text field.</span></span>

## <a name="conclusion"></a><span data-ttu-id="9e8d7-220">Conclusion</span><span class="sxs-lookup"><span data-stu-id="9e8d7-220">Conclusion</span></span>

<span data-ttu-id="9e8d7-221">L’intégration de la saisie semi-automatique du panneau de saisie est un outil puissant pour améliorer l’expérience utilisateur dans les applications Windows qui incluent des listes de saisie semi-automatique sur les Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-221">Input Panel Autocomplete integration is a powerful tool for improving the user experience in Windows applications that include Autocomplete lists on Tablet PCs.</span></span> <span data-ttu-id="9e8d7-222">Sans intégration, les utilisateurs du panneau de saisie doivent suivre un processus fastidieux d’insertion du texte un caractère à la fois et de repositionner le panneau de saisie pour pouvoir utiliser la saisie semi-automatique.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-222">Without integration, Input Panel users are required to go through a tedious process of inserting text one character at a time and repositioning Input Panel in order to use Autocomplete.</span></span> <span data-ttu-id="9e8d7-223">Avec l’intégration, les listes de saisie semi-automatique s’affichent à un emplacement pratique en tant qu’utilisateurs manuscrits dans le panneau de saisie, ce qui améliore la vitesse et la facilité d’entrée de texte.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-223">With integration, Autocomplete lists appear in a convenient location as users ink in Input Panel, increasing both the speed and the ease of text entry.</span></span> <span data-ttu-id="9e8d7-224">Dans les applications qui incluent une fonctionnalité de saisie semi-automatique basée sur la saisie semi-automatique du shell ou la saisie semi-automatique .NET Framework 3,0, l’intégration de la saisie semi-automatique du panneau de saisie est une fonctionnalité gratuite et attrayante.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-224">In applications that include Autocomplete functionality built on top of Shell Autocomplete or .NET Framework 3.0 Autocomplete, Input Panel Autocomplete integration is a free and compelling feature.</span></span> <span data-ttu-id="9e8d7-225">En outre, un ensemble simple d’interfaces basées sur COM est fourni pour activer la même expérience intégrée pour les applications qui choisissent d’utiliser des contrôles de saisie semi-automatique personnalisés.</span><span class="sxs-lookup"><span data-stu-id="9e8d7-225">Furthermore, a simple set of COM-based interfaces are provided to enable the same integrated experience for applications that choose to use custom Autocomplete controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9e8d7-226">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="9e8d7-226">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9e8d7-227">Référence du panneau de saisie de texte</span><span class="sxs-lookup"><span data-stu-id="9e8d7-227">Text Input Panel Reference</span></span>](text-input-panel-reference.md)
</dt> </dl>

 

 
