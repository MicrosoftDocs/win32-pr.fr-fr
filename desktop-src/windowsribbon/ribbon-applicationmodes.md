---
title: Reconfiguration du ruban avec les modes d’application
description: L’infrastructure de ruban Windows prend en charge la reconfiguration et l’exposition dynamiques des éléments principaux de l’interface ruban au moment de l’exécution, en fonction de l’état de l’application (également appelé contexte).
ms.assetid: 8e9d85c5-33e4-4212-b9e4-2fc3b492c273
keywords:
- Ruban Windows, reconfiguration avec les modes d’application
- Ruban, reconfiguration avec les modes d’application
- reconfiguration du ruban Windows avec les modes d’application
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83d206c238e6fe7463562077daaa52a5522a79d9
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104381973"
---
# <a name="reconfiguring-the-ribbon-with-application-modes"></a><span data-ttu-id="224cf-106">Reconfiguration du ruban avec les modes d’application</span><span class="sxs-lookup"><span data-stu-id="224cf-106">Reconfiguring the Ribbon with Application Modes</span></span>

<span data-ttu-id="224cf-107">L’infrastructure de ruban Windows prend en charge la reconfiguration et l’exposition dynamiques des éléments principaux de l’interface ruban au moment de l’exécution, en fonction de l’état de l’application (également appelé contexte).</span><span class="sxs-lookup"><span data-stu-id="224cf-107">The Windows Ribbon framework supports the dynamic reconfiguring and exposing of core elements of the Ribbon UI at run time, based on the application's state (also referred to as context).</span></span> <span data-ttu-id="224cf-108">Déclarés et associés à des éléments spécifiques dans le balisage, les différents États pris en charge par une application sont appelés modes d’application.</span><span class="sxs-lookup"><span data-stu-id="224cf-108">Declared and associated with specific elements in markup, the various states supported by an application are referred to as application modes.</span></span>

-   [<span data-ttu-id="224cf-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="224cf-109">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="224cf-110">Interface utilisateur contextuelle</span><span class="sxs-lookup"><span data-stu-id="224cf-110">Contextual User Interface</span></span>](#contextual-user-interface)
    -   [<span data-ttu-id="224cf-111">Scénario simple en mode application</span><span class="sxs-lookup"><span data-stu-id="224cf-111">A Simple Application Mode Scenario</span></span>](#a-simple-application-mode-scenario)
-   [<span data-ttu-id="224cf-112">Implémentation des modes d’application</span><span class="sxs-lookup"><span data-stu-id="224cf-112">Implementing Application Modes</span></span>](#implementing-application-modes)
    -   [<span data-ttu-id="224cf-113">Identifier les modes</span><span class="sxs-lookup"><span data-stu-id="224cf-113">Identify the Modes</span></span>](#identify-the-modes)
    -   [<span data-ttu-id="224cf-114">Assigner des contrôles aux modes d’application</span><span class="sxs-lookup"><span data-stu-id="224cf-114">Assign Controls to Application Modes</span></span>](#assign-controls-to-application-modes)
    -   [<span data-ttu-id="224cf-115">Basculer les modes au moment de l’exécution</span><span class="sxs-lookup"><span data-stu-id="224cf-115">Switch Modes at Runtime</span></span>](#switch-modes-at-runtime)
-   [<span data-ttu-id="224cf-116">Remarques</span><span class="sxs-lookup"><span data-stu-id="224cf-116">Remarks</span></span>](#remarks)
-   [<span data-ttu-id="224cf-117">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="224cf-117">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="224cf-118">Introduction</span><span class="sxs-lookup"><span data-stu-id="224cf-118">Introduction</span></span>

<span data-ttu-id="224cf-119">Les modes d’application se composent de groupes logiques de contrôles qui exposent certaines fonctionnalités d’application principales dans l’interface ruban.</span><span class="sxs-lookup"><span data-stu-id="224cf-119">Application modes consist of logical groups of controls that expose some core application functionality in the Ribbon UI.</span></span> <span data-ttu-id="224cf-120">Ces modes sont activés ou désactivés dynamiquement par l’application via un appel à la méthode Framework [**IUIFramework :: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes), qui active ou désactive la visibilité d’un ou plusieurs modes d’application.</span><span class="sxs-lookup"><span data-stu-id="224cf-120">These modes are dynamically enabled or disabled by the application through a call to the framework method [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes), which turns the visibility of one or more application modes on or off.</span></span>

## <a name="contextual-user-interface"></a><span data-ttu-id="224cf-121">Interface utilisateur contextuelle</span><span class="sxs-lookup"><span data-stu-id="224cf-121">Contextual User Interface</span></span>

<span data-ttu-id="224cf-122">L’infrastructure du ruban offre une expérience utilisateur riche en incorporant des contrôles dynamiques qui répondent en toute transparence à l’interaction de l’utilisateur et au contexte de l’application.</span><span class="sxs-lookup"><span data-stu-id="224cf-122">The Ribbon framework provides rich user experience by incorporating dynamic controls that respond seamlessly to user interaction and application context.</span></span> <span data-ttu-id="224cf-123">Cette interface utilisateur contextuelle riche est fournie grâce à une combinaison des mécanismes suivants :</span><span class="sxs-lookup"><span data-stu-id="224cf-123">This rich contextual UI is delivered through a combination of the following mechanisms:</span></span>

-   <span data-ttu-id="224cf-124">Galeries-contrôles basés sur des collections qui prennent en charge la manipulation dynamique de leurs collections d’éléments.</span><span class="sxs-lookup"><span data-stu-id="224cf-124">Galleries - collection-based controls that support the dynamic manipulation of their item collections.</span></span>
-   <span data-ttu-id="224cf-125">Onglets contextuels : onglets du ruban dont la visibilité est déterminée par une modification du contexte de l’espace de travail, telle que la sélection d’une image dans un document.</span><span class="sxs-lookup"><span data-stu-id="224cf-125">Contextual tabs - ribbon tabs that have their visibility determined by a change in workspace context, such as the selection of an image in a document.</span></span>
-   <span data-ttu-id="224cf-126">Modes d’application-fonctionnalités d’application principales qui dépendent du contexte de l’application.</span><span class="sxs-lookup"><span data-stu-id="224cf-126">Application modes - core application functionality that is dependent on application context.</span></span>

<span data-ttu-id="224cf-127">À certains égards, les modes d’application s’affichent de façon fonctionnelle, à l’instar des onglets contextuels.</span><span class="sxs-lookup"><span data-stu-id="224cf-127">In some respects, application modes appear functionally similar to contextual tabs.</span></span> <span data-ttu-id="224cf-128">Toutefois, la distinction fondamentale réside dans l’objectif et l’étendue de chaque.</span><span class="sxs-lookup"><span data-stu-id="224cf-128">However, the fundamental distinction lies in the intent and scope of each.</span></span>

<span data-ttu-id="224cf-129">Les contrôles contextuels sont activés en réponse à un changement de contexte dans une application.</span><span class="sxs-lookup"><span data-stu-id="224cf-129">Contextual controls are activated in response to a change of context within an application.</span></span> <span data-ttu-id="224cf-130">Par exemple, dans Microsoft Paint pour Windows 7, un onglet contextuel qui contient des groupes de commandes liées au texte s’affiche lorsqu’un utilisateur insère une zone de texte dans l’espace de travail.</span><span class="sxs-lookup"><span data-stu-id="224cf-130">For example, in Microsoft Paint for Windows 7, a contextual tab that contains groups of text-related commands is displayed when a user inserts a text area into the workspace.</span></span> <span data-ttu-id="224cf-131">Cet onglet contextuel ne contient pas de commandes de base pour l’application et n’est exposé dans l’interface utilisateur que si le contexte *de* l’application a changé.</span><span class="sxs-lookup"><span data-stu-id="224cf-131">This contextual tab does not contain core commands for the application and is only exposed in the UI because the context *within* the application has changed.</span></span> <span data-ttu-id="224cf-132">Les fonctionnalités principales de l’application (commandes de modification d’image) sont toujours pertinentes et disponibles pour l’utilisateur, même si l’onglet contextuel est visible.</span><span class="sxs-lookup"><span data-stu-id="224cf-132">The core functionality of the application (the image editing commands) is still relevant and available to the user, even with the contextual tab visible.</span></span>

<span data-ttu-id="224cf-133">Les modes d’application diffèrent des contrôles contextuels dans le fait qu’ils reconfigurent les fonctionnalités en réponse à des modifications dans le contexte dans lequel l’application fonctionne.</span><span class="sxs-lookup"><span data-stu-id="224cf-133">Application modes differ from contextual controls in that they reconfigure functionality in response to changes in the context that the application is operating in.</span></span> <span data-ttu-id="224cf-134">Les modes d’application se trouvent à un niveau supérieur d’abstraction. ils offrent un moyen de reconfigurer la fonctionnalité de base d’une application au lieu d’exposer temporairement des fonctionnalités qui ne sont pas un composant fondamental de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="224cf-134">Application modes sit at a higher level of abstraction; they provide a way to reconfigure the core functionality of an application instead of temporarily exposing functionality that is not a core component of the UI.</span></span> <span data-ttu-id="224cf-135">Par exemple, dans Microsoft Paint pour Windows 7, un commutateur en mode application se produit lorsque la commande **Aperçu avant impression** est appelée.</span><span class="sxs-lookup"><span data-stu-id="224cf-135">For example, in Microsoft Paint for Windows 7, a switch in application mode occurs when the **Print preview** command is invoked.</span></span> <span data-ttu-id="224cf-136">Lorsque Microsoft Paint bascule en mode **Aperçu avant impression**, le contexte dans lequel l’application est en cours de modification passe de la modification à l’aperçu.</span><span class="sxs-lookup"><span data-stu-id="224cf-136">When Microsoft Paint switches to **Print preview**, the context that the application is operating in changes from editing to previewing.</span></span> <span data-ttu-id="224cf-137">Par conséquent, la fonctionnalité de base de l’application change jusqu’à ce que l' **Aperçu avant impression** soit annulé et que l’application entre à nouveau dans le contexte d’édition.</span><span class="sxs-lookup"><span data-stu-id="224cf-137">As a result, the core functionality of the application changes until the **Print preview** is canceled and the application enters the editing context again.</span></span>

### <a name="a-simple-application-mode-scenario"></a><span data-ttu-id="224cf-138">Scénario simple en mode application</span><span class="sxs-lookup"><span data-stu-id="224cf-138">A Simple Application Mode Scenario</span></span>

<span data-ttu-id="224cf-139">Le scénario suivant montre comment les modes d’application sont utilisés, dans une application appelée RibbonApp, pour exposer des aspects discrets de la fonctionnalité de base.</span><span class="sxs-lookup"><span data-stu-id="224cf-139">The following scenario demonstrates how application modes are used, in an application called RibbonApp, to expose discrete aspects of core functionality.</span></span>

<span data-ttu-id="224cf-140">Deux modes d’application sont définis dans RibbonApp :</span><span class="sxs-lookup"><span data-stu-id="224cf-140">Two application modes are defined in RibbonApp:</span></span>

-   <span data-ttu-id="224cf-141">Le mode **simple** expose les commandes de base dans l’ensemble de l’interface ruban.</span><span class="sxs-lookup"><span data-stu-id="224cf-141">**Simple** mode exposes basic commands throughout the Ribbon UI.</span></span> <span data-ttu-id="224cf-142">Ces commandes s’affichent à tout moment, quel que soit le mode d’application actif.</span><span class="sxs-lookup"><span data-stu-id="224cf-142">These commands appear at all times, no matter which application mode is active.</span></span>
-   <span data-ttu-id="224cf-143">Le mode **avancé** expose des commandes complexes destinées aux utilisateurs expérimentés de l’application.</span><span class="sxs-lookup"><span data-stu-id="224cf-143">**Advanced** mode exposes complex commands intended for expert users of the application.</span></span> <span data-ttu-id="224cf-144">Ces commandes avancées s’affichent dans l’interface ruban, en plus des commandes simples.</span><span class="sxs-lookup"><span data-stu-id="224cf-144">These advanced commands appear throughout the Ribbon UI, in addition to the simple commands.</span></span>

<span data-ttu-id="224cf-145">Par défaut, RibbonApp est défini pour s’ouvrir en mode **simple** , et les commandes requises par les utilisateurs débutants sont affichées dans le menu de l' **application** et dans l’onglet dossier de **démarrage** . Les captures d’écran suivantes montrent le menu de l' **application** RibbonApp et l’onglet **Accueil** en mode **simple** , en mettant en surbrillance les contrôles modaux.</span><span class="sxs-lookup"><span data-stu-id="224cf-145">By default, RibbonApp is set to open in **Simple** mode, and the commands required by novice users are displayed in the **Application Menu** and the **Home** tab. The following screen shots show the RibbonApp **Application Menu** and **Home** tab in **Simple** mode, highlighting the modal controls.</span></span>

![capture d’écran montrant un onglet pour le mode d’application simple.](images/overviews/appmode-hometab.png)![capture d’écran montrant le menu de l’application pour le mode d’application simple.](images/overviews/appmode-simpleappmenu.png)

<span data-ttu-id="224cf-148">Bien que ces commandes soient suffisantes pour les utilisateurs débutants, RibbonApp prend également en charge les utilisateurs experts via un mode **avancé** qui, lorsqu’ils sont activés en cliquant sur le bouton **basculer en mode avancé** dans le **menu application**, affiche des fonctionnalités de base supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="224cf-148">While these commands may be sufficient for novice users, the RibbonApp also supports expert users through an **Advanced** mode that, when activated by clicking the **Switch to Advanced Mode** button in the **Application Menu**, displays additional core functionality.</span></span>

<span data-ttu-id="224cf-149">Ce scénario est facilement implémenté par la liaison de différents éléments dans le balisage à des modes d’application discrets qui peuvent être activés et désactivés selon les besoins.</span><span class="sxs-lookup"><span data-stu-id="224cf-149">This scenario is easily implemented by binding various elements in markup to discrete application modes that can be turned on and off as required.</span></span> <span data-ttu-id="224cf-150">Les captures d’écran suivantes montrent le menu de l' **application** RibbonApp et l’onglet **Accueil** en mode **avancé** , en mettant en surbrillance les contrôles modaux.</span><span class="sxs-lookup"><span data-stu-id="224cf-150">The following screen shots show the RibbonApp **Application Menu** and **Home** tab in **Advanced** mode, highlighting the modal controls.</span></span>

![capture d’écran montrant un onglet pour le mode d’application avancé.](images/overviews/appmode-advancedtab.png)![capture d’écran montrant le menu de l’application pour le mode d’application avancé.](images/overviews/appmode-advancedappmenu.png)

## <a name="implementing-application-modes"></a><span data-ttu-id="224cf-153">Implémentation des modes d’application</span><span class="sxs-lookup"><span data-stu-id="224cf-153">Implementing Application Modes</span></span>

<span data-ttu-id="224cf-154">Cette section décrit les trois étapes généralement requises pour l’implémentation des modes d’application de l’infrastructure du ruban.</span><span class="sxs-lookup"><span data-stu-id="224cf-154">This section outlines the three steps typically required for the implementation of Ribbon framework application modes.</span></span> <span data-ttu-id="224cf-155">RibbonApp est utilisé pour fournir un exemple pour chaque étape.</span><span class="sxs-lookup"><span data-stu-id="224cf-155">RibbonApp is used to provide an example for each step.</span></span>

### <a name="identify-the-modes"></a><span data-ttu-id="224cf-156">Identifier les modes</span><span class="sxs-lookup"><span data-stu-id="224cf-156">Identify the Modes</span></span>

<span data-ttu-id="224cf-157">Chaque mode dans une application doit représenter un ensemble logique de fonctionnalités qui dépendent du contexte dans lequel une application peut fonctionner.</span><span class="sxs-lookup"><span data-stu-id="224cf-157">Each mode in an application should represent a logical set of functionality that depends on the context an application is able to operate in.</span></span> <span data-ttu-id="224cf-158">Par exemple, si une application affiche des contrôles qui ne sont pertinents que lorsqu’une connexion réseau est détectée, ces contrôles opèrent dans un contexte réseau qui peut justifier la création d’un mode **réseau** .</span><span class="sxs-lookup"><span data-stu-id="224cf-158">For example, if an application displays controls that are only relevant when a network connection is detected, those controls operate within a networking context that might justify the creation of a **Network** mode.</span></span>

<span data-ttu-id="224cf-159">RibbonApp a deux contextes qui peuvent être actifs à un moment donné : **simple** et **avancé**.</span><span class="sxs-lookup"><span data-stu-id="224cf-159">RibbonApp has two contexts that can be active at any given time: **Simple** and **Advanced**.</span></span> <span data-ttu-id="224cf-160">Par conséquent, RibbonApp requiert deux modes : **simple** et **avancé**.</span><span class="sxs-lookup"><span data-stu-id="224cf-160">Therefore, RibbonApp requires two modes: **Simple** and **Advanced**.</span></span>

### <a name="assign-controls-to-application-modes"></a><span data-ttu-id="224cf-161">Assigner des contrôles aux modes d’application</span><span class="sxs-lookup"><span data-stu-id="224cf-161">Assign Controls to Application Modes</span></span>

<span data-ttu-id="224cf-162">Une fois les modes d’application identifiés, assignez chaque contrôle de ruban à un mode en déclarant un attribut *ApplicationModes* dans le balisage pour les éléments de contrôle qui prennent en charge les modes d’application.</span><span class="sxs-lookup"><span data-stu-id="224cf-162">Once the application modes have been identified, assign each Ribbon control to a mode by declaring an *ApplicationModes* attribute in markup for those control elements that support application modes.</span></span>

<span data-ttu-id="224cf-163">La vue du ruban permet de spécifier des modes sur les éléments de contrôle suivants :</span><span class="sxs-lookup"><span data-stu-id="224cf-163">The Ribbon View allows modes to be specified on the following control elements:</span></span>

-   <span data-ttu-id="224cf-164">Éléments de l' [**onglet**](windowsribbon-element-tab.md) principal.</span><span class="sxs-lookup"><span data-stu-id="224cf-164">Core [**Tab**](windowsribbon-element-tab.md) elements.</span></span>
-   <span data-ttu-id="224cf-165">[**Regroupez**](windowsribbon-element-group.md) les éléments enfants d’un élément d' [**onglet**](windowsribbon-element-tab.md) principal.</span><span class="sxs-lookup"><span data-stu-id="224cf-165">[**Group**](windowsribbon-element-group.md) elements that are child elements of a core [**Tab**](windowsribbon-element-tab.md) element.</span></span>
-   <span data-ttu-id="224cf-166">Éléments [**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md)et [**DropDownButton**](windowsribbon-element-dropdownbutton.md) affectés à un [**MenuGroup**](windowsribbon-element-menugroup.md) dans le menu de l' [application](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="224cf-166">[**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md), and [**DropDownButton**](windowsribbon-element-dropdownbutton.md) elements assigned to a [**MenuGroup**](windowsribbon-element-menugroup.md) within the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>
    > [!Note]  
    > <span data-ttu-id="224cf-167">Les éléments [**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md)et [**DropDownButton**](windowsribbon-element-dropdownbutton.md) ne peuvent pas être assignés à un mode, sauf s’ils sont hébergés dans le menu de l' [application](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="224cf-167">[**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md), and [**DropDownButton**](windowsribbon-element-dropdownbutton.md) elements cannot be assigned to a mode unless hosted in the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>

     

<span data-ttu-id="224cf-168">Dans l’infrastructure du ruban, ces éléments de contrôle sont appelés contrôles modaux.</span><span class="sxs-lookup"><span data-stu-id="224cf-168">In the Ribbon framework, these control elements are referred to as modal controls.</span></span> <span data-ttu-id="224cf-169">Elles s’affichent uniquement si un mode auquel elles sont liées est actif dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="224cf-169">They appear only if a mode to which they are bound is active in the UI.</span></span>

<span data-ttu-id="224cf-170">Les éléments de contrôle contenus dans un contrôle modal héritent du comportement du mode d’application.</span><span class="sxs-lookup"><span data-stu-id="224cf-170">Control elements that are contained within a modal control inherit the application mode behavior.</span></span> <span data-ttu-id="224cf-171">Par exemple, si un contrôle modal de [**groupe**](windowsribbon-element-group.md) est affecté à un mode **avancé** et que le mode **avancé** n’est pas actif, alors ce **groupe** et les contrôles qu’il contient, modaux ou non, ne sont pas visibles dans l’interface utilisateur du ruban.</span><span class="sxs-lookup"><span data-stu-id="224cf-171">For example, if a [**Group**](windowsribbon-element-group.md) modal control is assigned to an **Advanced** mode and the **Advanced** mode is not active, then that **Group** and any controls in it, modal or otherwise, will not be visible in the Ribbon UI.</span></span>

<span data-ttu-id="224cf-172">Avec l’utilisation de l’attribut *ApplicationModes* , les modes sont assignés aux contrôles modaux dans une relation 1 : N (un-à-plusieurs), où un seul contrôle modal peut être associé à plusieurs modes.</span><span class="sxs-lookup"><span data-stu-id="224cf-172">With the use of the *ApplicationModes* attribute, modes are assigned to modal controls in a 1:N (one-to-many) relationship, where a single modal control can be associated with several modes.</span></span>

<span data-ttu-id="224cf-173">L’infrastructure du ruban fait référence aux modes numériques, de 0 à 31, le mode 0 étant considéré comme le mode par défaut qui est activé automatiquement au démarrage d’une application de ruban.</span><span class="sxs-lookup"><span data-stu-id="224cf-173">The Ribbon framework refers to modes numerically, from 0 to 31, with mode 0 considered the default mode that is automatically activated when a Ribbon application starts.</span></span> <span data-ttu-id="224cf-174">Tout contrôle modal qui ne spécifie pas d’attribut *ApplicationModes* est considéré comme un membre du mode par défaut.</span><span class="sxs-lookup"><span data-stu-id="224cf-174">Any modal control that does not specify an *ApplicationModes* attribute is considered to be a member of the default mode.</span></span>

<span data-ttu-id="224cf-175">Dans RibbonApp, **simple** est le mode par défaut, avec les fonctionnalités du mode **avancé** affichées uniquement lorsqu’il est lancé par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="224cf-175">In RibbonApp, **Simple** is the default mode, with **Advanced** mode functionality displayed only when it is initiated by the user.</span></span>

<span data-ttu-id="224cf-176">L’exemple suivant illustre le balisage requis pour RibbonApp.</span><span class="sxs-lookup"><span data-stu-id="224cf-176">The following example demonstrates the markup required for RibbonApp.</span></span>


```C++
<Application.Views>
  <Ribbon>

    <!--Application Menu-->
    <Ribbon.ApplicationMenu>
      <ApplicationMenu CommandName='cmdAppMenu'>                    
        <MenuGroup>
          <Button CommandName='cmdSave'/>                        
          <Button CommandName='cmdExportMetadata' ApplicationModes='1'/>                   
        </MenuGroup>              
        <MenuGroup>
          <Button CommandName='cmdSwitchModes' ApplicationModes ='0,1'/>
          <Button CommandName='cmdExit'/>
        </MenuGroup>
      </ApplicationMenu>
    </Ribbon.ApplicationMenu>
            
    <!--Tabs-->
    <Ribbon.Tabs>
      <!--Home Tab-->
      <Tab CommandName='cmdHomeTab'>
                    
        <!--Scaling Policy for Home tab-->
        <Tab.ScalingPolicy>
          <ScalingPolicy>
            <ScalingPolicy.IdealSizes>
              <Scale Group='cmdSimpleControlsGroup' Size='Medium'/>                                
            </ScalingPolicy.IdealSizes>                     
          </ScalingPolicy>
        </Tab.ScalingPolicy>     
                    
        <!--Simple Controls Group-->
        <Group CommandName='cmdSimpleControlsGroup' SizeDefinition='ThreeButtons-OneBigAndTwoSmall'>                        
          <Button CommandName="cmdPaste" />
          <Button CommandName='cmdCut'/>                        
          <Button CommandName='cmdCopy'/>                        
        </Group>
      </Tab>
                
      <!--Advanced Tab-->
      <Tab CommandName='cmdAdvancedTab' ApplicationModes='1'>
        <!--Advanced Controls Group-->
        <Group CommandName='cmdMetadataGroup' ApplicationModes='1' SizeDefinition='TwoButtons'>
          <Button CommandName='cmdEditMetadata' />
          <Button CommandName='cmdCheckErrors' />
        </Group>
      </Tab>
    </Ribbon.Tabs>                   
                             
  </Ribbon>         
</Application.Views>
```



<span data-ttu-id="224cf-177">Cet exemple illustre les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="224cf-177">This example demonstrates the following:</span></span>

-   <span data-ttu-id="224cf-178">Le mode par défaut 0 n’a pas besoin d’être explicitement déclaré.</span><span class="sxs-lookup"><span data-stu-id="224cf-178">Default mode 0 does not need to be explicitly declared.</span></span> <span data-ttu-id="224cf-179">Étant donné que les contrôles modaux qui ne spécifient pas l’attribut *ApplicationModes* sont automatiquement liés au mode 0 (mode **simple** dans l’exemple RibbonApp), il n’est pas nécessaire de déclarer explicitement l’attribut pour les contrôles modaux par défaut.</span><span class="sxs-lookup"><span data-stu-id="224cf-179">Because modal controls that do not specify the *ApplicationModes* attribute are automatically bound to mode 0 (**Simple** mode in the RibbonApp example), there is no need to explicitly declare the attribute for default modal controls.</span></span>
-   <span data-ttu-id="224cf-180">Les contrôles peuvent être liés à plusieurs modes.</span><span class="sxs-lookup"><span data-stu-id="224cf-180">Controls can be bound to multiple modes.</span></span> <span data-ttu-id="224cf-181">Pour RibbonApp, le seul besoin de l’attribut *ApplicationModes* dans un contrôle en mode **simple** est le `cmdSwitchModes` bouton, car il fait partie des modes **simple** et **avancé** .</span><span class="sxs-lookup"><span data-stu-id="224cf-181">For RibbonApp, the only need for the *ApplicationModes* attribute in a **Simple** mode control is the `cmdSwitchModes` button , since it is a part of both **Simple** and **Advanced** modes.</span></span> <span data-ttu-id="224cf-182">Si l’un des deux modes est actif, ce contrôle s’affiche dans le menu de l' [application](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="224cf-182">If either mode is active, this control will appear in the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>
-   <span data-ttu-id="224cf-183">Les contrôles modaux n’héritent pas de leurs parents.</span><span class="sxs-lookup"><span data-stu-id="224cf-183">Modal controls do not inherit from their parents.</span></span> <span data-ttu-id="224cf-184">L’onglet **avancé** de RibbonApp contient un groupe de **métadonnées** ; ces deux contrôles modaux sont assignés au mode 1 (mode **avancé** ).</span><span class="sxs-lookup"><span data-stu-id="224cf-184">The **Advanced** tab of RibbonApp contains a **Metadata** group; both of these modal controls are assigned to mode 1 (**Advanced** mode).</span></span> <span data-ttu-id="224cf-185">L’affectation de l’onglet **avancé** au mode 1 n’affecte pas automatiquement les contrôles enfants, tels que le groupe de **métadonnées** , au mode 1.</span><span class="sxs-lookup"><span data-stu-id="224cf-185">Assigning the **Advanced** tab to mode 1 does not automatically assign child controls, such as the **Metadata** group, to mode 1.</span></span> <span data-ttu-id="224cf-186">Cela permet à n’importe quel groupe d’un onglet d’être activé ou désactivé indépendamment au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="224cf-186">This allows any group within a tab to be independently enabled or disabled at runtime.</span></span>
-   <span data-ttu-id="224cf-187">Les contrôles non modaux peuvent toujours reposer sur des commutateurs de mode.</span><span class="sxs-lookup"><span data-stu-id="224cf-187">Non-modal controls can still rely on mode switches.</span></span> <span data-ttu-id="224cf-188">Les boutons **modifier les métadonnées** et **vérifier les erreurs** de RibbonApp sont destinés aux utilisateurs avancés et sont disponibles uniquement lorsque l’utilisateur bascule en mode **avancé** .</span><span class="sxs-lookup"><span data-stu-id="224cf-188">The **Edit Metadata** and **Check for Errors** buttons of RibbonApp are for advanced users and available only when the user switches to **Advanced** mode.</span></span> <span data-ttu-id="224cf-189">Les contrôles bouton qui ne sont pas hébergés dans le menu de l' [application](windowsribbon-controls-applicationmenu.md) ne sont pas modaux ; Toutefois, étant donné que ces boutons sont hébergés à l’intérieur d’un contrôle modal (le groupe de **métadonnées** ), ils sont visibles lorsque le groupe est visible.</span><span class="sxs-lookup"><span data-stu-id="224cf-189">Button controls that are not hosted inside the [Application Menu](windowsribbon-controls-applicationmenu.md) are non-modal; however, because these buttons are hosted inside a modal control (the **Metadata** group), they are visible when the group is visible.</span></span> <span data-ttu-id="224cf-190">Par conséquent, ces boutons apparaissent lorsque le mode avancé est activé et que le groupe de **métadonnées** est exposé dans l’interface ruban.</span><span class="sxs-lookup"><span data-stu-id="224cf-190">Therefore, these buttons appear when the advanced mode is activated and the **Metadata** group is exposed in the Ribbon UI.</span></span>

### <a name="switch-modes-at-runtime"></a><span data-ttu-id="224cf-191">Basculer les modes au moment de l’exécution</span><span class="sxs-lookup"><span data-stu-id="224cf-191">Switch Modes at Runtime</span></span>

<span data-ttu-id="224cf-192">Une fois les modes définis dans le balisage, ils peuvent être facilement activés ou désactivés en réponse à des événements contextuels.</span><span class="sxs-lookup"><span data-stu-id="224cf-192">After modes are defined in markup, they can be easily enabled or disabled in response to contextual events.</span></span> <span data-ttu-id="224cf-193">Comme mentionné précédemment, les applications de ruban démarrent toujours en mode par défaut 0.</span><span class="sxs-lookup"><span data-stu-id="224cf-193">As mentioned previously, Ribbon applications always start in the default mode 0.</span></span> <span data-ttu-id="224cf-194">Une fois que l’application a été initialisée et que le mode 0 est actif, l’ensemble de modes actifs peut être modifié en appelant la fonction [**IUIFramework :: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) .</span><span class="sxs-lookup"><span data-stu-id="224cf-194">After the application has initialized and mode 0 is active, the set of active modes can be changed by calling the [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) function.</span></span> <span data-ttu-id="224cf-195">Cette fonction accepte un entier 32 bits comme représentation au niveau du bit des modes qui doivent être actifs ; le bit de poids faible représente le mode 0 et le bit le plus significatif représente le mode 31.</span><span class="sxs-lookup"><span data-stu-id="224cf-195">This function takes a 32-bit integer as a bitwise representation of the modes that should be active; the least significant bit represents mode 0 and the most significant bit represents mode 31.</span></span> <span data-ttu-id="224cf-196">Si un bit est défini sur zéro, le mode n’est pas actif dans l’interface ruban.</span><span class="sxs-lookup"><span data-stu-id="224cf-196">If a bit is set to zero, the mode is not active in the Ribbon UI.</span></span>

<span data-ttu-id="224cf-197">Dans RibbonApp, quand un utilisateur active le mode **avancé** , les commandes avancées s’affichent en même temps que les commandes simples.</span><span class="sxs-lookup"><span data-stu-id="224cf-197">In RibbonApp, when a user enables **Advanced** mode, the advanced commands are displayed alongside the simple commands.</span></span> <span data-ttu-id="224cf-198">Le gestionnaire de commandes pour le bouton **basculer vers le mode avancé** appelle [**IUIFramework :: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) pour définir les modes 0 (**simple**) et 1 (**avancé**) comme étant actifs dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="224cf-198">The command handler for the **Switch to Advanced Mode** button calls [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) in order to set modes 0 (**Simple**) and 1 (**Advanced**) as active in the UI.</span></span> <span data-ttu-id="224cf-199">L’exemple suivant est le code RibbonApp pour cet appel de fonction :</span><span class="sxs-lookup"><span data-stu-id="224cf-199">The following example is the RibbonApp code for this function call :</span></span>


```C++
const int SIMPLE_MODE = 0;
const int ADVANCED_MODE = 1;
pFramework->SetModes( UI_MAKEAPPMODE(SIMPLE_MODE) | UI_MAKEAPPMODE(ADVANCED_MODE) );
```



> [!Note]  
> <span data-ttu-id="224cf-200">La macro MAKEAPPMODE de l’interface utilisateur de l’infrastructure du ruban \_ simplifie la définition de ces bits correctement en préparation de l’appel à [**IUIFramework :: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes).</span><span class="sxs-lookup"><span data-stu-id="224cf-200">The Ribbon framework UI\_MAKEAPPMODE macro simplifies the task of setting these bits correctly in preparation for the call to [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes).</span></span>

 

<span data-ttu-id="224cf-201">Cet exemple illustre les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="224cf-201">This example demonstrates the following:</span></span>

-   <span data-ttu-id="224cf-202">Utilisez la \_ macro MAKEAPPMODE de l’interface utilisateur pour générer un jeu de modes.</span><span class="sxs-lookup"><span data-stu-id="224cf-202">Use the UI\_MAKEAPPMODE macro to build a mode set.</span></span>
-   <span data-ttu-id="224cf-203">Les modes sont définis explicitement et atomiquement.</span><span class="sxs-lookup"><span data-stu-id="224cf-203">Modes are set explicitly and atomically.</span></span> <span data-ttu-id="224cf-204">La valeur entière transmise à [**IUIFramework :: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) représente les modes qui seront actifs après le retour de la fonction.</span><span class="sxs-lookup"><span data-stu-id="224cf-204">The integer value that is passed to [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) represents the modes that will be active after the function returns.</span></span> <span data-ttu-id="224cf-205">Bien que le mode **simple** soit précédemment actif, **IUIFramework :: SetModes** doit indiquer que le mode **simple** reste actif lorsque le mode **avancé** est activé.</span><span class="sxs-lookup"><span data-stu-id="224cf-205">Although the **Simple** mode was previously active, **IUIFramework::SetModes** must indicate that the **Simple** mode remain active when the **Advanced** mode is activated.</span></span>
-   <span data-ttu-id="224cf-206">Le mode par défaut peut être supprimé.</span><span class="sxs-lookup"><span data-stu-id="224cf-206">The default mode can be removed.</span></span> <span data-ttu-id="224cf-207">Même si, dans RibbonApp, le mode par défaut (mode 0) n’est jamais supprimé, il peut être supprimé à l’aide de l’appel suivant : `g_pFramework->SetModes(UI_MAKEAPPMODE(ADVANCED_MODE))` , en exposant uniquement les commandes avancées dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="224cf-207">Although in RibbonApp the default mode (mode 0) is never removed, it can be removed with the following call: `g_pFramework->SetModes(UI_MAKEAPPMODE(ADVANCED_MODE))`, exposing only the advanced commands in the UI.</span></span>

> [!Note]  
> <span data-ttu-id="224cf-208">Lorsque les modes d’une application sont reconfigurés, le ruban tente de conserver l’onglet précédemment sélectionné dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="224cf-208">When the modes of an application are reconfigured, the Ribbon will attempt to preserve the previously selected tab in the UI.</span></span> <span data-ttu-id="224cf-209">Si le nouvel ensemble de modes ne contient plus l’onglet sélectionné avant l’appel, le ruban sélectionne l’onglet dans sa disposition qui est le plus proche du menu de l' [application](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="224cf-209">If the new set of modes no longer contains the tab that was selected before the call, the Ribbon will select the tab in its layout that is closest to the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span> <span data-ttu-id="224cf-210">Cet onglet est destiné à contenir les commandes les plus pertinentes pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="224cf-210">This tab is meant to contain the commands that are most relevant to the user.</span></span> <span data-ttu-id="224cf-211">Pour plus d’informations, consultez [instructions relatives à l’expérience utilisateur du ruban](https://msdn.microsoft.com/library/cc872782.aspx).</span><span class="sxs-lookup"><span data-stu-id="224cf-211">For more information, see [Ribbon User Experience Guidelines](https://msdn.microsoft.com/library/cc872782.aspx).</span></span>

 

## <a name="remarks"></a><span data-ttu-id="224cf-212">Notes</span><span class="sxs-lookup"><span data-stu-id="224cf-212">Remarks</span></span>

<span data-ttu-id="224cf-213">Le ruban doit avoir au moins un mode actif à tout moment.</span><span class="sxs-lookup"><span data-stu-id="224cf-213">The Ribbon must have at least one active mode at all times.</span></span> <span data-ttu-id="224cf-214">Si une application tente de désactiver tous les modes en appelant [**IUIFramework :: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) avec une valeur de mode de 0, E \_ Fail est retourné et le mode actif reste inchangé.</span><span class="sxs-lookup"><span data-stu-id="224cf-214">If an application attempts to deactivate all modes by calling [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) with a mode value of 0, E\_FAIL is returned and the active mode set remains unchanged.</span></span>

<span data-ttu-id="224cf-215">L’infrastructure requiert à tout moment qu’au moins un onglet existe dans l’interface ruban.</span><span class="sxs-lookup"><span data-stu-id="224cf-215">The framework requires that at least one tab exist in the Ribbon UI at all times.</span></span> <span data-ttu-id="224cf-216">Par conséquent, il doit y avoir au moins un onglet exposé par le mode par défaut (mode 0) et après chaque commutateur de mode.</span><span class="sxs-lookup"><span data-stu-id="224cf-216">As a result, there must be at least one tab exposed by the default mode (mode 0) and after each mode switch.</span></span>

<span data-ttu-id="224cf-217">Toutes les zones de l’interface utilisateur du ruban ne sont pas affectées par les modes d’application.</span><span class="sxs-lookup"><span data-stu-id="224cf-217">Not all areas of the Ribbon UI are affected by application modes.</span></span> <span data-ttu-id="224cf-218">Par exemple, si la désactivation d’un mode provoque la disparition des boutons du ruban qui ont été précédemment ajoutés à la [barre d’outils accès rapide](windowsribbon-controls-quickaccesstoolbar.md), ces boutons restent dans la barre d’outils accès rapide, ce qui permet aux utilisateurs d’exécuter les commandes liées aux boutons.</span><span class="sxs-lookup"><span data-stu-id="224cf-218">For example, if disabling a mode causes the disappearance of buttons from the Ribbon that were previously added to the [Quick Access Toolbar](windowsribbon-controls-quickaccesstoolbar.md), those buttons remain in the Quick Access Toolbar, allowing users to execute the Commands bound to the buttons.</span></span> <span data-ttu-id="224cf-219">En règle générale, si une commande appartient à un ou plusieurs modes inactifs, elle doit également être désactivée en affectant à la propriété de l' [interface utilisateur \_ \_ activée](windowsribbon-reference-properties-uipkey-enabled.md) la valeur 0 (variante \_ false).</span><span class="sxs-lookup"><span data-stu-id="224cf-219">As a general rule, if a Command belongs to one or more inactive modes, then that Command should also be disabled by setting the [UI\_PKEY\_Enabled](windowsribbon-reference-properties-uipkey-enabled.md) property to 0 (VARIANT\_FALSE) .</span></span>

## <a name="related-topics"></a><span data-ttu-id="224cf-220">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="224cf-220">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="224cf-221">Instructions relatives à l’expérience utilisateur du ruban</span><span class="sxs-lookup"><span data-stu-id="224cf-221">Ribbon User Experience Guidelines</span></span>](https://msdn.microsoft.com/library/cc872782.aspx)
</dt> <dt>

[<span data-ttu-id="224cf-222">Affichage des onglets contextuels</span><span class="sxs-lookup"><span data-stu-id="224cf-222">Displaying Contextual Tabs</span></span>](ribbon-contextualtabs.md)
</dt> </dl>

 

 