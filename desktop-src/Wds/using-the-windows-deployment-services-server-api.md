---
title: Utilisation de l’API du serveur des Services de déploiement Windows
description: Dans les environnements où la solution standard des services de déploiement Windows (WDS) ne peut pas être utilisée, le serveur WDS expose une API qui permet aux développeurs d’écrire des plug-ins, appelés fournisseurs, pour gérer les demandes d’environnement d’exécution de prédémarrage (PXE).
ms.assetid: 5e25654a-33c6-4c0f-acc3-e938d1f4a4e7
keywords:
- Services de déploiement Windows (services de déploiement Windows) à l’aide de l’API serveur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d3634dffa73eddc9b5db92be6bc807cccbc5248f
ms.sourcegitcommit: c2a1c4314550ea9bd202d28adfcc7bfe6180932f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2020
ms.locfileid: "103724255"
---
# <a name="using-the-windows-deployment-services-server-api"></a><span data-ttu-id="f90e6-104">Utilisation de l’API du serveur des Services de déploiement Windows</span><span class="sxs-lookup"><span data-stu-id="f90e6-104">Using the Windows Deployment Services Server API</span></span>

<span data-ttu-id="f90e6-105">Dans les environnements où la solution standard des services de déploiement Windows (WDS) ne peut pas être utilisée, le serveur WDS expose une API qui permet aux développeurs d’écrire des plug-ins, appelés fournisseurs, pour gérer les demandes d’environnement d’exécution de prédémarrage (PXE).</span><span class="sxs-lookup"><span data-stu-id="f90e6-105">In environments where the standard Windows Deployment Services (WDS) solution cannot be used, the WDS server exposes an API that enables developers to write plug-ins, referred to as providers, to handle preboot execution environment (PXE) requests.</span></span> <span data-ttu-id="f90e6-106">Les développeurs doivent respecter les consignes suivantes lors de l’écriture de fournisseurs PXE pour WDS.</span><span class="sxs-lookup"><span data-stu-id="f90e6-106">Developers should adhere to the following guidelines when writing PXE providers for WDS.</span></span>

## <a name="install-the-wds-role-on-the-server"></a><span data-ttu-id="f90e6-107">Installer le rôle WDS sur le serveur</span><span class="sxs-lookup"><span data-stu-id="f90e6-107">Install the WDS Role on the Server</span></span>

-   <span data-ttu-id="f90e6-108">Les services de déploiement Windows (WDS) sont la version révisée des services d’installation à distance (RIS). vous aurez besoin du rôle serveur WDS pour implémenter le serveur et les fournisseurs PXE WDS.</span><span class="sxs-lookup"><span data-stu-id="f90e6-108">Windows Deployment Services (WDS) is the revised version of Remote Installation Services (RIS), you will need the WDS server role to implement the WDS PXE server and providers.</span></span>
-   <span data-ttu-id="f90e6-109">WDS remplace RIS comme composant standard à partir de Windows Server 2008 et Windows Server 2003 avec Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="f90e6-109">WDS replaces RIS as the standard component starting with Windows Server 2008 and Windows Server 2003 with Service Pack 2 (SP2).</span></span>
-   <span data-ttu-id="f90e6-110">Vous devez mettre à jour le serveur RIS vers WDS sur Windows Server 2003 avec Service Pack 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="f90e6-110">You must update the RIS server to WDS on Windows Server 2003 with Service Pack 1 (SP1).</span></span> <span data-ttu-id="f90e6-111">Vous pouvez installer le rôle serveur WDS avec le [Kit d’installation automatisée (Windows AIK) (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span><span class="sxs-lookup"><span data-stu-id="f90e6-111">You can install the WDS server role with the [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span></span>

## <a name="register-providers"></a><span data-ttu-id="f90e6-112">Inscrire des fournisseurs</span><span class="sxs-lookup"><span data-stu-id="f90e6-112">Register Providers</span></span>

-   <span data-ttu-id="f90e6-113">Enregistrez la bibliothèque de liens dynamiques (DLL) du fournisseur pendant son installation et insérez le fournisseur dans la liste ordonnée des fournisseurs inscrits.</span><span class="sxs-lookup"><span data-stu-id="f90e6-113">Register the provider dynamic-link library (DLL) during its installation and insert the provider into the ordered list of registered providers.</span></span>
    > [!Note]  
    > <span data-ttu-id="f90e6-114">Lorsque vous installez un fournisseur nouveau ou modifié, vous devrez redémarrer le service PXE WDS pour que les modifications prennent effet.</span><span class="sxs-lookup"><span data-stu-id="f90e6-114">When you install a new or modified provider, you will need to restart WDS PXE service for the changes to take effect.</span></span>

     

-   <span data-ttu-id="f90e6-115">Utilisez la fonction [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister) pour inscrire le fournisseur et l’ajouter à la liste.</span><span class="sxs-lookup"><span data-stu-id="f90e6-115">Use the [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister) function to register the provider and add it to the list.</span></span> <span data-ttu-id="f90e6-116">Utilisez la fonction [**PxeProviderUnRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderunregister) pour annuler l’inscription d’un fournisseur inscrit et le supprimer de la liste.</span><span class="sxs-lookup"><span data-stu-id="f90e6-116">Use the [**PxeProviderUnRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderunregister) function to unregister a registered provider and remove it from the list.</span></span>
-   <span data-ttu-id="f90e6-117">Spécifiez la séquence du fournisseur dans la liste triée.</span><span class="sxs-lookup"><span data-stu-id="f90e6-117">Specify the sequence of the provider in the ordered list.</span></span> <span data-ttu-id="f90e6-118">L’index d’un fournisseur dans la liste ne peut pas être garanti, car un autre fournisseur peut être inscrit plus tard.</span><span class="sxs-lookup"><span data-stu-id="f90e6-118">The index of a provider in the list cannot be guaranteed because another provider may later be registered before it.</span></span> <span data-ttu-id="f90e6-119">Pour insérer le fournisseur dans la liste avant ou après un autre fournisseur inscrit, utilisez d’abord la fonction [**PxeProviderQueryIndex**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderqueryindex) pour obtenir l’index du fournisseur inscrit, puis enregistrez le nouveau fournisseur tout en spécifiant une valeur d’index plus grande ou plus petite.</span><span class="sxs-lookup"><span data-stu-id="f90e6-119">To insert the provider in the list before or after another registered provider, first use the [**PxeProviderQueryIndex**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderqueryindex) function to get the index of the registered provider and then register the new provider while specifying a larger or smaller index value.</span></span>
-   <span data-ttu-id="f90e6-120">L’installation peut stocker les informations de configuration du fournisseur sous la clé de Registre retournée lors de l’inscription du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="f90e6-120">The installation can store provider configuration information under the registry key returned when the provider is registered.</span></span> <span data-ttu-id="f90e6-121">L’adresse de la clé de Registre est reçue par le *phProviderKey* de [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister).</span><span class="sxs-lookup"><span data-stu-id="f90e6-121">The address of the registry key is received by the *phProviderKey* of [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister).</span></span> <span data-ttu-id="f90e6-122">Le fournisseur reçoit un descripteur de cette même clé que le paramètre *hProviderKey* pour son rappel [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-122">The provider receives a handle to this same key as the *hProviderKey* parameter to its [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span> <span data-ttu-id="f90e6-123">Le fournisseur doit stocker l’adresse de cette clé.</span><span class="sxs-lookup"><span data-stu-id="f90e6-123">The provider should store the address of this key.</span></span>
-   <span data-ttu-id="f90e6-124">Installez toujours la bibliothèque de liens dynamiques (DLL) du fournisseur dans le dossier Program Files du serveur.</span><span class="sxs-lookup"><span data-stu-id="f90e6-124">Always install the provider dynamic-link library (DLL) in the server's Program Files folder.</span></span>

## <a name="initialize"></a><span data-ttu-id="f90e6-125">Initialiser</span><span class="sxs-lookup"><span data-stu-id="f90e6-125">Initialize</span></span>

-   <span data-ttu-id="f90e6-126">Incluez une DLL qui exporte la fonction de rappel [*PxeProviderInitialize*](pxeproviderinitialize.md) dans le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="f90e6-126">Include a DLL that exports the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback function in the provider.</span></span> <span data-ttu-id="f90e6-127">Chaque fournisseur requiert un rappel *PxeProviderInitialize* .</span><span class="sxs-lookup"><span data-stu-id="f90e6-127">Every provider requires a *PxeProviderInitialize* callback.</span></span> <span data-ttu-id="f90e6-128">Lorsque WDS charge un fournisseur, il appelle la fonction *PxeProviderInitialize* du fournisseur et passe un handle à la même clé que celle utilisée pour stocker les informations de configuration pendant l’inscription du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="f90e6-128">When WDS loads a provider, it calls the provider's *PxeProviderInitialize* function and passes a handle to the same key that is used to store configuration information during provider registration.</span></span>
-   <span data-ttu-id="f90e6-129">Lorsque le rappel [*PxeProviderInitialize*](pxeproviderinitialize.md) retourne et réussit, le fournisseur doit être entièrement initialisé et prêt à traiter les demandes.</span><span class="sxs-lookup"><span data-stu-id="f90e6-129">When the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback returns and is successful, the provider should be fully initialized and ready to process requests.</span></span>
-   <span data-ttu-id="f90e6-130">Inscrivez chaque rappel dans le fournisseur pendant le traitement de la fonction [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-130">Register every callback in the provider during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) function.</span></span> <span data-ttu-id="f90e6-131">Les rappels doivent être inscrits avec la fonction [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-131">Callbacks should be registered with the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function.</span></span>
-   <span data-ttu-id="f90e6-132">Initialiser toutes les ressources internes du fournisseur dans le traitement de sa fonction [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-132">Initialize all the provider's internal resources within the processing of its [*PxeProviderInitialize*](pxeproviderinitialize.md) function.</span></span>

## <a name="shutdown"></a><span data-ttu-id="f90e6-133">Éteindre</span><span class="sxs-lookup"><span data-stu-id="f90e6-133">Shutdown</span></span>

-   <span data-ttu-id="f90e6-134">Implémentez le rappel [*PxeProviderShutdown*](pxeprovidershutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-134">Implement the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback.</span></span> <span data-ttu-id="f90e6-135">Chaque fournisseur doit avoir un rappel *PxeProviderShutdown*.</span><span class="sxs-lookup"><span data-stu-id="f90e6-135">Every provider is required to have a *PxeProviderShutdown* callback.</span></span>
-   <span data-ttu-id="f90e6-136">La fonction de rappel [*PxeProviderShutdown*](pxeprovidershutdown.md) doit arrêter complètement le fournisseur et libérer toutes ses ressources.</span><span class="sxs-lookup"><span data-stu-id="f90e6-136">The [*PxeProviderShutdown*](pxeprovidershutdown.md) callback function should fully shut down the provider and release all its resources.</span></span>
-   <span data-ttu-id="f90e6-137">Une fois le rappel [*PxeProviderShutdown*](pxeprovidershutdown.md) retourné, le descripteur *hProvider* passé à la fonction [*PxeProviderInitialize*](pxeproviderinitialize.md) n’est plus valide et ne doit pas être utilisé pour appeler WDS.</span><span class="sxs-lookup"><span data-stu-id="f90e6-137">After the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback returns, the *hProvider* handle passed to the [*PxeProviderInitialize*](pxeproviderinitialize.md) function is no longer valid and should not be used to call WDS.</span></span>
-   <span data-ttu-id="f90e6-138">Inscrivez le rappel [*PxeProviderShutdown*](pxeprovidershutdown.md) en appelant la fonction [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) avec **l' \_ \_ arrêt du rappel PXE** pendant le traitement du rappel [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-138">Register the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_SHUTDOWN** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span> <span data-ttu-id="f90e6-139">N’appelez pas le rappel *PxeProviderShutdown* en cas d’échec de la fonction *PxeProviderInitialize* .</span><span class="sxs-lookup"><span data-stu-id="f90e6-139">Do not call the *PxeProviderShutdown* callback if the *PxeProviderInitialize* function fails.</span></span>

## <a name="handle-request-packet"></a><span data-ttu-id="f90e6-140">Traiter le paquet de demande</span><span class="sxs-lookup"><span data-stu-id="f90e6-140">Handle Request Packet</span></span>

<span data-ttu-id="f90e6-141">Implémentez le rappel [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) pour le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="f90e6-141">Implement the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback for the provider.</span></span> <span data-ttu-id="f90e6-142">Chaque fournisseur doit avoir un rappel *PxeProviderRecvRequest* .</span><span class="sxs-lookup"><span data-stu-id="f90e6-142">Every provider is required to have a *PxeProviderRecvRequest* callback.</span></span> <span data-ttu-id="f90e6-143">Lorsque WDS reçoit une demande, il appelle le rappel *PxeProviderRecvRequest* pour le premier fournisseur dans la liste des fournisseurs inscrits.</span><span class="sxs-lookup"><span data-stu-id="f90e6-143">When WDS receives a request, it calls the *PxeProviderRecvRequest* callback for the first provider in the registered provider list.</span></span>

-   <span data-ttu-id="f90e6-144">Si le fournisseur traitera cette demande de manière synchrone, la fonction [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) doit retourner une valeur **de \_ succès d’erreur**.</span><span class="sxs-lookup"><span data-stu-id="f90e6-144">If the provider will process this request synchronously, the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) function should return a value of **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="f90e6-145">Si et seulement si le fournisseur traitera cette demande de manière asynchrone, le rappel *PxeProviderRecvRequest* doit retourner des **\_ e/s d’erreur \_ en attente** et appeler la fonction [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) lorsque la requête a été traitée.</span><span class="sxs-lookup"><span data-stu-id="f90e6-145">If and only if the provider will process this request asynchronously, the *PxeProviderRecvRequest* callback should return **ERROR\_IO\_PENDING** and call the [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) function when the request has been processed.</span></span>
-   <span data-ttu-id="f90e6-146">Le rappel [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) et la fonction [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) renvoient l’adresse d’une énumération d' **\_ \_ action de démarrage PXE** qui décrit l’action effectuée par le fournisseur pour traiter la demande.</span><span class="sxs-lookup"><span data-stu-id="f90e6-146">The [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback and the [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) function returns the address of a **PXE\_BOOT\_ACTION** enum that describes the action taken by the provider to handle the request.</span></span>

    <span data-ttu-id="f90e6-147">Un fournisseur peut gérer une requête de quatre façons :</span><span class="sxs-lookup"><span data-stu-id="f90e6-147">There are four ways for a provider to handle a request:</span></span>

    -   <span data-ttu-id="f90e6-148">Le fournisseur répond au client avec un paquet de réponse DHCP standard qui contient un chemin d’accès au programme de démarrage réseau.</span><span class="sxs-lookup"><span data-stu-id="f90e6-148">The provider replies to the client with a standard DHCP response packet that contains a path to the Network Boot Program.</span></span> <span data-ttu-id="f90e6-149">Le renvoi de la valeur du **\_ \_ NBP PXE BA** pour l’énumération signifie que le fournisseur a réussi à traiter le paquet de demande et a terminé la demande en envoyant un paquet de réponse en appelant les fonctions [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) et [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-149">Returning the **PXE\_BA\_NBP** value for the enum means that the provider has successfully processed the request packet and completed the request by sending a response packet by calling the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) and [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) functions.</span></span>
    -   <span data-ttu-id="f90e6-150">Le fournisseur répond au client avec un paquet de réponse personnalisé qui n’est pas conforme au protocole DHCP.</span><span class="sxs-lookup"><span data-stu-id="f90e6-150">The provider replies to the client with a custom response packet that does not conform to DHCP.</span></span> <span data-ttu-id="f90e6-151">Si vous renvoyez la valeur **\_ \_ personnalisée PXE BA** pour l’énumération, le fournisseur a réussi à traiter le paquet de demande et a terminé la demande en envoyant un paquet de réponse personnalisé en appelant les fonctions [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) et [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-151">Returning the **PXE\_BA\_CUSTOM** value for the enum means that the provider has successfully processed the request packet and completed the request by sending a custom response packet by calling the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) and [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) functions.</span></span>
    -   <span data-ttu-id="f90e6-152">Le fournisseur détermine que la requête doit être ignorée.</span><span class="sxs-lookup"><span data-stu-id="f90e6-152">The provider determines the request should be ignored.</span></span> <span data-ttu-id="f90e6-153">Le renvoi de la valeur d' **\_ \_ ignore PXE BA** pour l’énumération signifie que le fournisseur a libéré toutes les ressources associées à la demande et que la demande n’est pas transmise au fournisseur suivant dans la liste des fournisseurs inscrits.</span><span class="sxs-lookup"><span data-stu-id="f90e6-153">Returning the **PXE\_BA\_IGNORE** value for the enum means the provider has released all resources associated with the request and the request is not passed to the next provider in the list of registered providers.</span></span> <span data-ttu-id="f90e6-154">Les fournisseurs peuvent utiliser cette option s’ils détectent qu’un paquet de demande n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="f90e6-154">Providers may use this option if they detect that a request packet is invalid.</span></span>
    -   <span data-ttu-id="f90e6-155">Le fournisseur refuse de traiter la demande.</span><span class="sxs-lookup"><span data-stu-id="f90e6-155">The provider declines to service the request.</span></span> <span data-ttu-id="f90e6-156">Le retour de la valeur de **\_ \_ rejet PXE BA** pour l’énumération indique au système de transmettre la demande au fournisseur suivant dans la liste des fournisseurs inscrits.</span><span class="sxs-lookup"><span data-stu-id="f90e6-156">Returning the **PXE\_BA\_REJECT** value for the enum instructs the system to pass the request to the next provider in the list of registered providers.</span></span> <span data-ttu-id="f90e6-157">S’il s’agit du dernier fournisseur dans la liste, cela libère toutes les ressources associées à la demande et la demande est ignorée.</span><span class="sxs-lookup"><span data-stu-id="f90e6-157">If this were the last provider in the list, this releases all resources associated with the request and the request is ignored.</span></span>
    -   <span data-ttu-id="f90e6-158">Inscrivez le rappel [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) en appelant la fonction [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) avec **la \_ \_ \_ demande de rappel PXE** lors du traitement du rappel [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-158">Register the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_RECV\_REQUEST** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span>

## <a name="generate-response-packet"></a><span data-ttu-id="f90e6-159">Générer un paquet de réponse</span><span class="sxs-lookup"><span data-stu-id="f90e6-159">Generate Response Packet</span></span>

-   <span data-ttu-id="f90e6-160">Utilisez l’API pour écrire des fournisseurs afin de gérer les demandes DHCP et de générer des paquets de réponse.</span><span class="sxs-lookup"><span data-stu-id="f90e6-160">Use the API to write providers to handle DHCP request and generate response packets.</span></span>
-   <span data-ttu-id="f90e6-161">La fonction [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) spécifie les attributs utilisés par le fournisseur pour filtrer les paquets.</span><span class="sxs-lookup"><span data-stu-id="f90e6-161">The [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) function specifies the attributes used by the provider to filter packets.</span></span> <span data-ttu-id="f90e6-162">Les attributs du fournisseur peuvent être spécifiés pour que le fournisseur puisse voir tous les paquets, le fournisseur ne voit que les paquets DHCP, ou le fournisseur voit uniquement les paquets DHCP qui spécifient l’option d’identificateur de classe du fournisseur DHCP (60) comme « PXEClient ».</span><span class="sxs-lookup"><span data-stu-id="f90e6-162">The attributes of the provider can be specified so that the provider see all packets, the provider sees only DHCP packets, or the provider sees only DHCP packets that specify the DHCP Vendor Class Identifier option (60) as "PXEClient".</span></span>
-   <span data-ttu-id="f90e6-163">La fonction [**PxeDhcpIsValid**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpisvalid) vérifie qu’un paquet est un paquet DHCP valide.</span><span class="sxs-lookup"><span data-stu-id="f90e6-163">The [**PxeDhcpIsValid**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpisvalid) function checks that a packet is a valid DHCP packet.</span></span> <span data-ttu-id="f90e6-164">Les fournisseurs peuvent utiliser la fonction **PxeDhcpIsValid** pour vérifier si un paquet du client est un paquet DHCP lorsque le filtre défini avec la fonction [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) est défini de façon à recevoir tous les paquets pour déterminer si un paquet spécifié est un paquet DHCP valide.</span><span class="sxs-lookup"><span data-stu-id="f90e6-164">Providers can use the **PxeDhcpIsValid** function to check whether a packet from the client is a DHCP packet when the filter set with the [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) function is set to receive all packets to determine if a specified packet is a valid DHCP packet.</span></span>
-   <span data-ttu-id="f90e6-165">La fonction [**PxeDhcpInitialize**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpinitialize) Initialise un paquet de réponse en tant que paquet de réponse DHCP basé sur les informations contenues dans un paquet reçu du client.</span><span class="sxs-lookup"><span data-stu-id="f90e6-165">The [**PxeDhcpInitialize**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpinitialize) function initializes a response packet as a DHCP reply packet that is based on the information in a packet received from the client.</span></span> <span data-ttu-id="f90e6-166">La fonction [*PxeProviderInitialize*](pxeproviderinitialize.md) prend l’adresse d’un paquet DHCP valide reçu du client dans le rappel [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-166">The [*PxeProviderInitialize*](pxeproviderinitialize.md) function takes the address of a valid DHCP packet received from the client in the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback.</span></span> <span data-ttu-id="f90e6-167">La fonction **PxeDhcpInitialize** prend un pointeur vers un paquet de réponse alloué avec la fonction [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-167">The **PxeDhcpInitialize** function takes a pointer to a reply packet allocated with the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) function.</span></span>
-   <span data-ttu-id="f90e6-168">La fonction [**PxeDhcpGetOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetoptionvalue) récupère une valeur d’option à partir d’un paquet DHCP.</span><span class="sxs-lookup"><span data-stu-id="f90e6-168">The [**PxeDhcpGetOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetoptionvalue) function retrieves an option value from a DHCP packet.</span></span> <span data-ttu-id="f90e6-169">La fonction [**PxeDhcpGetVendorOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetvendoroptionvalue) récupère une valeur d’option à partir du champ informations spécifiques au fournisseur (43) d’un paquet DHCP.</span><span class="sxs-lookup"><span data-stu-id="f90e6-169">The [**PxeDhcpGetVendorOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetvendoroptionvalue) function retrieves an option value from the Vendor Specific Information field (43) of a DHCP packet.</span></span>
-   <span data-ttu-id="f90e6-170">Le fournisseur peut ensuite remplir le paquet de réponse avec les informations et utiliser la fonction [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) pour envoyer le paquet de réponse au client.</span><span class="sxs-lookup"><span data-stu-id="f90e6-170">The provider can then populate the reply packet with information and use the [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) function to send the reply packet to the client.</span></span> <span data-ttu-id="f90e6-171">La fonction [**PxeDhcpAppendOption**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpappendoption) ajoute une option DHCP au paquet de réponse.</span><span class="sxs-lookup"><span data-stu-id="f90e6-171">The [**PxeDhcpAppendOption**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpappendoption) function appends a DHCP option to the reply packet.</span></span>
-   <span data-ttu-id="f90e6-172">Un fournisseur qui répond aux demandes des clients en envoyant un paquet doit allouer le paquet de réponse à l’aide de la fonction [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-172">A provider that replies to client requests by sending a packet must allocate the response packet using the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) function.</span></span> <span data-ttu-id="f90e6-173">Le fournisseur peut ensuite remplir le paquet de réponse avec les informations et utiliser la fonction [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) pour envoyer le paquet de réponse au client.</span><span class="sxs-lookup"><span data-stu-id="f90e6-173">The provider can then populate the reply packet with information and use the [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) function to send the reply packet to the client.</span></span>
-   <span data-ttu-id="f90e6-174">Lorsque la mémoire allouée n’est plus nécessaire, le fournisseur doit la libérer à l’aide de la fonction [**PxePacketFree**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketfree) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-174">When the allocated memory is no longer needed, the provider should release it using the [**PxePacketFree**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketfree) function.</span></span>

## <a name="enumerate-registered-providers"></a><span data-ttu-id="f90e6-175">Énumérer les fournisseurs inscrits</span><span class="sxs-lookup"><span data-stu-id="f90e6-175">Enumerate Registered Providers</span></span>

-   <span data-ttu-id="f90e6-176">Utilisez l’API pour écrire des fournisseurs qui énumèrent et vérifient d’autres fournisseurs inscrits dans la liste.</span><span class="sxs-lookup"><span data-stu-id="f90e6-176">Use the API to write providers that enumerate and check other registered providers in the list.</span></span>
-   <span data-ttu-id="f90e6-177">La fonction [**PxeGetServerInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxegetserverinfo) retourne des informations sur le serveur PXE.</span><span class="sxs-lookup"><span data-stu-id="f90e6-177">The [**PxeGetServerInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxegetserverinfo) function returns information about the PXE server.</span></span> <span data-ttu-id="f90e6-178">La fonction **PxeGetServerInfo** retourne une valeur **booléenne** qui indique si le suivi est activé pour le serveur.</span><span class="sxs-lookup"><span data-stu-id="f90e6-178">The **PxeGetServerInfo** function returns a **BOOL** that indicates whether tracing is enabled for the server.</span></span> <span data-ttu-id="f90e6-179">**True** indique que le suivi est activé.</span><span class="sxs-lookup"><span data-stu-id="f90e6-179">**TRUE** indicates that tracing is enabled.</span></span>
-   <span data-ttu-id="f90e6-180">La fonction [**PxeProviderEnumFirst**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumfirst) démarre un fournisseur enumerationof dans la liste des fournisseurs inscrits.</span><span class="sxs-lookup"><span data-stu-id="f90e6-180">The [**PxeProviderEnumFirst**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumfirst) function starts an enumerationof providers in the registered provider list.</span></span> <span data-ttu-id="f90e6-181">La fonction **PxeProviderEnumFirst** démarre l’énumération et retourne l’adresse du handle qui doit être utilisé lors de l’appel de la fonction [**PxeProviderEnumNext**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumnext) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-181">The **PxeProviderEnumFirst** function starts the enumeration and returns the address of the handle that should be used when calling the [**PxeProviderEnumNext**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumnext) function.</span></span> <span data-ttu-id="f90e6-182">La fonction **PxeProviderEnumNext** retourne une structure de [**\_ fournisseur PXE**](/windows/win32/api/wdspxe/ns-wdspxe-pxe_provider) contenant les informations relatives au fournisseur.</span><span class="sxs-lookup"><span data-stu-id="f90e6-182">The **PxeProviderEnumNext** function returns a [**PXE\_PROVIDER**](/windows/win32/api/wdspxe/ns-wdspxe-pxe_provider) structure containing the information about the provider.</span></span> <span data-ttu-id="f90e6-183">La fonction [**PxeProviderFreeInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderfreeinfo) libère la mémoire qui a été allouée pour la structure du **\_ fournisseur PXE** par la fonction **PxeProviderEnumNext** .</span><span class="sxs-lookup"><span data-stu-id="f90e6-183">The [**PxeProviderFreeInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderfreeinfo) function frees the memory that has been allocated for the **PXE\_PROVIDER** structure by the **PxeProviderEnumNext** function.</span></span> <span data-ttu-id="f90e6-184">La fonction [**PxeProviderEnumClose**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumclose) ferme l’énumération des fournisseurs dans la liste des fournisseurs inscrits.</span><span class="sxs-lookup"><span data-stu-id="f90e6-184">The [**PxeProviderEnumClose**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumclose) function closes the enumeration of providers in the registered providers list.</span></span>

## <a name="handle-service-control-codes"></a><span data-ttu-id="f90e6-185">Gérer les codes de contrôle de service</span><span class="sxs-lookup"><span data-stu-id="f90e6-185">Handle Service Control Codes</span></span>

-   <span data-ttu-id="f90e6-186">Lorsqu’un message de contrôle de service est reçu, WDS appelle le rappel [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-186">When a service control message is received, WDS calls the [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback.</span></span>
-   <span data-ttu-id="f90e6-187">Le fournisseur peut définir une fonction de rappel [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) pour gérer les messages de contrôle de service.</span><span class="sxs-lookup"><span data-stu-id="f90e6-187">The provider can define a [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback function to handle service control messages.</span></span>
-   <span data-ttu-id="f90e6-188">Inscrivez le rappel [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) en appelant la fonction [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) avec **le \_ \_ \_ contrôle du service de rappel PXE** pendant le traitement du rappel [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="f90e6-188">Register the [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_SERVICE\_CONTROL** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span>

## <a name="add-trace-entries-to-pxe-log"></a><span data-ttu-id="f90e6-189">Ajouter des entrées de trace au Journal PXE</span><span class="sxs-lookup"><span data-stu-id="f90e6-189">Add Trace Entries to PXE Log</span></span>

-   <span data-ttu-id="f90e6-190">La fonction [**PxeTrace**](/windows/win32/api/WdsPxe/nf-wdspxe-pxetrace) ajoute une entrée de trace au Journal PXE.</span><span class="sxs-lookup"><span data-stu-id="f90e6-190">The [**PxeTrace**](/windows/win32/api/WdsPxe/nf-wdspxe-pxetrace) function adds a trace entry to the PXE log.</span></span> <span data-ttu-id="f90e6-191">WDSPXE fournit un suivi pour aider les administrateurs à résoudre les problèmes.</span><span class="sxs-lookup"><span data-stu-id="f90e6-191">WDSPXE provides tracing to help administrators in troubleshooting.</span></span> <span data-ttu-id="f90e6-192">Les fournisseurs peuvent enregistrer des entrées de suivi de différents niveaux de gravité.</span><span class="sxs-lookup"><span data-stu-id="f90e6-192">Providers can log trace entries of different severity levels.</span></span> <span data-ttu-id="f90e6-193">Les administrateurs peuvent configurer WDSPXE pour qu’il consigne uniquement les entrées de certains niveaux de gravité.</span><span class="sxs-lookup"><span data-stu-id="f90e6-193">The administrators can configure WDSPXE to only log entries for certain severity levels.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f90e6-194">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f90e6-194">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f90e6-195">À propos de l’API des services de déploiement Windows</span><span class="sxs-lookup"><span data-stu-id="f90e6-195">About the Windows Deployment Services API</span></span>](about-the-windows-deployment-services-api.md)
</dt> <dt>

[<span data-ttu-id="f90e6-196">Utilisation de l’API du client des Services de déploiement Windows</span><span class="sxs-lookup"><span data-stu-id="f90e6-196">Using the Windows Deployment Services Client API</span></span>](using-the-windows-deployment-services-client-api.md)
</dt> </dl>

 

 




