---
description: Chaque fenêtre est un membre d’une classe de fenêtre particulière. La classe de fenêtre détermine la procédure de fenêtre par défaut utilisée par une fenêtre individuelle pour traiter ses messages.
ms.assetid: 3a8e8f4e-910d-4863-a4a7-dd37c2dfa402
title: À propos des procédures de fenêtre
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1f63586b9ca4ac6fe8486ba112316174533b44e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106522450"
---
# <a name="about-window-procedures"></a><span data-ttu-id="40882-104">À propos des procédures de fenêtre</span><span class="sxs-lookup"><span data-stu-id="40882-104">About Window Procedures</span></span>

<span data-ttu-id="40882-105">Chaque fenêtre est un membre d’une classe de fenêtre particulière.</span><span class="sxs-lookup"><span data-stu-id="40882-105">Each window is a member of a particular window class.</span></span> <span data-ttu-id="40882-106">La classe de fenêtre détermine la procédure de fenêtre par défaut utilisée par une fenêtre individuelle pour traiter ses messages.</span><span class="sxs-lookup"><span data-stu-id="40882-106">The window class determines the default window procedure that an individual window uses to process its messages.</span></span> <span data-ttu-id="40882-107">Toutes les fenêtres appartenant à la même classe utilisent la même procédure de fenêtre par défaut.</span><span class="sxs-lookup"><span data-stu-id="40882-107">All windows belonging to the same class use the same default window procedure.</span></span> <span data-ttu-id="40882-108">Par exemple, le système définit une procédure de fenêtre pour la classe de zone de liste déroulante (**ComboBox**); toutes les zones de liste déroulante utilisent ensuite cette procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-108">For example, the system defines a window procedure for the combo box class (**COMBOBOX**); all combo boxes then use that window procedure.</span></span>

<span data-ttu-id="40882-109">Une application inscrit généralement au moins une nouvelle classe de fenêtre et la procédure de fenêtre qui lui est associée.</span><span class="sxs-lookup"><span data-stu-id="40882-109">An application typically registers at least one new window class and its associated window procedure.</span></span> <span data-ttu-id="40882-110">Après l’inscription d’une classe, l’application peut créer de nombreuses fenêtres de cette classe, qui utilisent toutes la même procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-110">After registering a class, the application can create many windows of that class, all of which use the same window procedure.</span></span> <span data-ttu-id="40882-111">Comme cela signifie que plusieurs sources peuvent appeler simultanément le même morceau de code, vous devez faire attention lorsque vous modifiez des ressources partagées à partir d’une procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-111">Because this means several sources could simultaneously call the same piece of code, you must be careful when modifying shared resources from a window procedure.</span></span> <span data-ttu-id="40882-112">Pour plus d’informations, consultez [classes de fenêtre](window-classes.md).</span><span class="sxs-lookup"><span data-stu-id="40882-112">For more information, see [Window Classes](window-classes.md).</span></span>

<span data-ttu-id="40882-113">Les procédures de fenêtre pour les boîtes de dialogue (appelées procédures de boîte de dialogue) ont une structure et une fonction similaires à celles des procédures de fenêtre normales.</span><span class="sxs-lookup"><span data-stu-id="40882-113">Window procedures for dialog boxes (called dialog box procedures) have a similar structure and function as regular window procedures.</span></span> <span data-ttu-id="40882-114">Tous les points faisant référence aux procédures de fenêtre dans cette section s’appliquent également aux procédures de boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="40882-114">All points referring to window procedures in this section also apply to dialog box procedures.</span></span> <span data-ttu-id="40882-115">Pour plus d’informations, consultez [boîtes de dialogue](/windows/desktop/dlgbox/dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="40882-115">For more information, see [Dialog Boxes](/windows/desktop/dlgbox/dialog-boxes).</span></span>

<span data-ttu-id="40882-116">Cette section décrit les rubriques suivantes.</span><span class="sxs-lookup"><span data-stu-id="40882-116">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="40882-117">Structure d’une procédure de fenêtre</span><span class="sxs-lookup"><span data-stu-id="40882-117">Structure of a Window Procedure</span></span>](#structure-of-a-window-procedure)
-   [<span data-ttu-id="40882-118">Procédure de fenêtre par défaut</span><span class="sxs-lookup"><span data-stu-id="40882-118">Default Window Procedure</span></span>](#default-window-procedure)
-   [<span data-ttu-id="40882-119">Sous-classe de procédure de fenêtre</span><span class="sxs-lookup"><span data-stu-id="40882-119">Window Procedure Subclassing</span></span>](#window-procedure-subclassing)
    -   [<span data-ttu-id="40882-120">Sous-classe d’instance</span><span class="sxs-lookup"><span data-stu-id="40882-120">Instance Subclassing</span></span>](#instance-subclassing)
    -   [<span data-ttu-id="40882-121">Sous-classement global</span><span class="sxs-lookup"><span data-stu-id="40882-121">Global Subclassing</span></span>](#global-subclassing)
-   [<span data-ttu-id="40882-122">Superclassement de la procédure de fenêtre</span><span class="sxs-lookup"><span data-stu-id="40882-122">Window Procedure Superclassing</span></span>](#window-procedure-superclassing)

## <a name="structure-of-a-window-procedure"></a><span data-ttu-id="40882-123">Structure d’une procédure de fenêtre</span><span class="sxs-lookup"><span data-stu-id="40882-123">Structure of a Window Procedure</span></span>

<span data-ttu-id="40882-124">Une procédure de fenêtre est une fonction qui a quatre paramètres et retourne une valeur signée.</span><span class="sxs-lookup"><span data-stu-id="40882-124">A window procedure is a function that has four parameters and returns a signed value.</span></span> <span data-ttu-id="40882-125">Les paramètres se composent d’un handle de fenêtre, d’un identificateur de message **uint** et de deux paramètres de message déclarés avec les types de données **wParam** et **lParam** .</span><span class="sxs-lookup"><span data-stu-id="40882-125">The parameters consist of a window handle, a **UINT** message identifier, and two message parameters declared with the **WPARAM** and **LPARAM** data types.</span></span> <span data-ttu-id="40882-126">Pour plus d’informations, consultez [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="40882-126">For more information, see [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)).</span></span>

<span data-ttu-id="40882-127">Les paramètres de message contiennent souvent des informations à la fois dans leurs mots de poids faible et de poids fort.</span><span class="sxs-lookup"><span data-stu-id="40882-127">Message parameters often contain information in both their low-order and high-order words.</span></span> <span data-ttu-id="40882-128">Une application peut utiliser plusieurs macros pour extraire des informations à partir des paramètres de message.</span><span class="sxs-lookup"><span data-stu-id="40882-128">There are several macros an application can use to extract information from the message parameters.</span></span> <span data-ttu-id="40882-129">La macro [**LOWORD**](/previous-versions/windows/desktop/legacy/ms632659(v=vs.85)) , par exemple, extrait le mot de poids faible (bits de 0 à 15) à partir d’un paramètre de message.</span><span class="sxs-lookup"><span data-stu-id="40882-129">The [**LOWORD**](/previous-versions/windows/desktop/legacy/ms632659(v=vs.85)) macro, for example, extracts the low-order word (bits 0 through 15) from a message parameter.</span></span> <span data-ttu-id="40882-130">Les autres macros incluent [**HIWORD**](/previous-versions/windows/desktop/legacy/ms632657(v=vs.85)), [**LOBYTE**](/previous-versions/windows/desktop/legacy/ms632658(v=vs.85))et [**HIBYTE**](/previous-versions/windows/desktop/legacy/ms632656(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="40882-130">Other macros include [**HIWORD**](/previous-versions/windows/desktop/legacy/ms632657(v=vs.85)), [**LOBYTE**](/previous-versions/windows/desktop/legacy/ms632658(v=vs.85)), and [**HIBYTE**](/previous-versions/windows/desktop/legacy/ms632656(v=vs.85)).</span></span>

<span data-ttu-id="40882-131">L’interprétation de la valeur de retour dépend du message en question.</span><span class="sxs-lookup"><span data-stu-id="40882-131">The interpretation of the return value depends on the particular message.</span></span> <span data-ttu-id="40882-132">Consultez la description de chaque message pour déterminer la valeur de retour appropriée.</span><span class="sxs-lookup"><span data-stu-id="40882-132">Consult the description of each message to determine the appropriate return value.</span></span>

<span data-ttu-id="40882-133">Étant donné qu’il est possible d’appeler une procédure de fenêtre de manière récursive, il est important de réduire le nombre de variables locales qu’il utilise.</span><span class="sxs-lookup"><span data-stu-id="40882-133">Because it is possible to call a window procedure recursively, it is important to minimize the number of local variables that it uses.</span></span> <span data-ttu-id="40882-134">Lors du traitement de messages individuels, une application doit appeler des fonctions en dehors de la procédure de fenêtre pour éviter une utilisation excessive des variables locales, ce qui peut provoquer un dépassement de capacité de la pile pendant une récurrence profonde.</span><span class="sxs-lookup"><span data-stu-id="40882-134">When processing individual messages, an application should call functions outside the window procedure to avoid excessive use of local variables, possibly causing the stack to overflow during deep recursion.</span></span>

## <a name="default-window-procedure"></a><span data-ttu-id="40882-135">Procédure de fenêtre par défaut</span><span class="sxs-lookup"><span data-stu-id="40882-135">Default Window Procedure</span></span>

<span data-ttu-id="40882-136">La fonction de la procédure de fenêtre par défaut, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) définit certains comportements fondamentaux partagés par toutes les fenêtres.</span><span class="sxs-lookup"><span data-stu-id="40882-136">The default window procedure function, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) defines certain fundamental behavior shared by all windows.</span></span> <span data-ttu-id="40882-137">La procédure de fenêtre par défaut fournit les fonctionnalités minimales pour une fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-137">The default window procedure provides the minimal functionality for a window.</span></span> <span data-ttu-id="40882-138">Une procédure de fenêtre définie par l’application doit passer tous les messages qu’elle ne traite pas à la fonction **DefWindowProc** pour le traitement par défaut.</span><span class="sxs-lookup"><span data-stu-id="40882-138">An application-defined window procedure should pass any messages that it does not process to the **DefWindowProc** function for default processing.</span></span>

## <a name="window-procedure-subclassing"></a><span data-ttu-id="40882-139">Sous-classe de procédure de fenêtre</span><span class="sxs-lookup"><span data-stu-id="40882-139">Window Procedure Subclassing</span></span>

<span data-ttu-id="40882-140">Quand une application crée une fenêtre, le système alloue un bloc de mémoire pour stocker des informations spécifiques à la fenêtre, y compris l’adresse de la procédure de fenêtre qui traite les messages pour la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-140">When an application creates a window, the system allocates a block of memory for storing information specific to the window, including the address of the window procedure that processes messages for the window.</span></span> <span data-ttu-id="40882-141">Lorsque le système doit transmettre un message à la fenêtre, il recherche les informations spécifiques à la fenêtre pour l’adresse de la procédure de fenêtre et transmet le message à cette procédure.</span><span class="sxs-lookup"><span data-stu-id="40882-141">When the system needs to pass a message to the window, it searches the window-specific information for the address of the window procedure and passes the message to that procedure.</span></span>

<span data-ttu-id="40882-142">Le *sous-classing* est une technique qui permet à une application d’intercepter et de traiter les messages envoyés ou publiés dans une fenêtre particulière avant que la fenêtre n’ait la possibilité de les traiter.</span><span class="sxs-lookup"><span data-stu-id="40882-142">*Subclassing* is a technique that allows an application to intercept and process messages sent or posted to a particular window before the window has a chance to process them.</span></span> <span data-ttu-id="40882-143">En sous-classant une fenêtre, une application peut augmenter, modifier ou surveiller le comportement de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-143">By subclassing a window, an application can augment, modify, or monitor the behavior of the window.</span></span> <span data-ttu-id="40882-144">Une application peut sous-classe une fenêtre appartenant à une classe globale système, telle qu’un contrôle d’édition ou une zone de liste.</span><span class="sxs-lookup"><span data-stu-id="40882-144">An application can subclass a window belonging to a system global class, such as an edit control or a list box.</span></span> <span data-ttu-id="40882-145">Par exemple, une application peut sous-définir un contrôle d’édition pour empêcher le contrôle d’accepter certains caractères.</span><span class="sxs-lookup"><span data-stu-id="40882-145">For example, an application could subclass an edit control to prevent the control from accepting certain characters.</span></span> <span data-ttu-id="40882-146">Toutefois, vous ne pouvez pas sous-classe une fenêtre ou une classe qui appartient à une autre application.</span><span class="sxs-lookup"><span data-stu-id="40882-146">However, you cannot subclass a window or class that belongs to another application.</span></span> <span data-ttu-id="40882-147">Toutes les sous-classes doivent être exécutées dans le même processus.</span><span class="sxs-lookup"><span data-stu-id="40882-147">All subclassing must be performed within the same process.</span></span>

<span data-ttu-id="40882-148">Une application sous-classe une fenêtre en remplaçant l’adresse de la procédure de fenêtre d’origine de la fenêtre par l’adresse d’une nouvelle procédure de fenêtre, appelée *procédure de sous-classe*.</span><span class="sxs-lookup"><span data-stu-id="40882-148">An application subclasses a window by replacing the address of the window's original window procedure with the address of a new window procedure, called the *subclass procedure*.</span></span> <span data-ttu-id="40882-149">Par la suite, la procédure de sous-classe reçoit tous les messages envoyés ou publiés dans la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-149">Thereafter, the subclass procedure receives any messages sent or posted to the window.</span></span>

<span data-ttu-id="40882-150">La procédure de sous-classe peut effectuer trois actions lors de la réception d’un message : elle peut passer le message à la procédure de fenêtre d’origine, modifier le message et le passer à la procédure de fenêtre d’origine, ou traiter le message et ne pas le passer à la procédure de fenêtre d’origine.</span><span class="sxs-lookup"><span data-stu-id="40882-150">The subclass procedure can take three actions upon receiving a message: it can pass the message to the original window procedure, modify the message and pass it to the original window procedure, or process the message and not pass it to the original window procedure.</span></span> <span data-ttu-id="40882-151">Si la procédure de sous-classe traite un message, elle peut le faire avant, après ou avant et après la transmission du message à la procédure de fenêtre d’origine.</span><span class="sxs-lookup"><span data-stu-id="40882-151">If the subclass procedure processes a message, it can do so before, after, or both before and after it passes the message to the original window procedure.</span></span>

<span data-ttu-id="40882-152">Le système fournit deux types de sous-classes : [instance](#instance-subclassing) et [Global](#global-subclassing).</span><span class="sxs-lookup"><span data-stu-id="40882-152">The system provides two types of subclassing: [instance](#instance-subclassing) and [global](#global-subclassing).</span></span> <span data-ttu-id="40882-153">Dans le sous-processus d' *instance*, une application remplace l’adresse de la procédure de fenêtre d’une seule instance d’une fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-153">In *instance subclassing*, an application replaces the window procedure address of a single instance of a window.</span></span> <span data-ttu-id="40882-154">Une application doit utiliser la sous-classe d’instance pour la sous-classe d’une fenêtre existante.</span><span class="sxs-lookup"><span data-stu-id="40882-154">An application must use instance subclassing to subclass an existing window.</span></span> <span data-ttu-id="40882-155">Dans le sous-modèle *Global*, une application remplace l’adresse de la procédure de fenêtre dans la structure [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) d’une classe de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-155">In *global subclassing*, an application replaces the address of the window procedure in the [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) structure of a window class.</span></span> <span data-ttu-id="40882-156">Toutes les fenêtres suivantes créées avec la classe ont l’adresse de la procédure de sous-classe, mais les fenêtres existantes de la classe ne sont pas affectées.</span><span class="sxs-lookup"><span data-stu-id="40882-156">All subsequent windows created with the class have the address of the subclass procedure, but existing windows of the class are not affected.</span></span>

### <a name="instance-subclassing"></a><span data-ttu-id="40882-157">Sous-classe d’instance</span><span class="sxs-lookup"><span data-stu-id="40882-157">Instance Subclassing</span></span>

<span data-ttu-id="40882-158">Une application sous-classe une instance d’une fenêtre à l’aide de la fonction [**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) .</span><span class="sxs-lookup"><span data-stu-id="40882-158">An application subclasses an instance of a window by using the [**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) function.</span></span> <span data-ttu-id="40882-159">L’application transmet l' **indicateur \_ WNDPROC GWL** , le handle de la fenêtre à la sous-classe et l’adresse de la procédure de sous-classe à **SetWindowLong**.</span><span class="sxs-lookup"><span data-stu-id="40882-159">The application passes the **GWL\_WNDPROC** flag, the handle to the window to subclass, and the address of the subclass procedure to **SetWindowLong**.</span></span> <span data-ttu-id="40882-160">La procédure de sous-classe peut résider dans l’exécutable de l’application ou dans une DLL.</span><span class="sxs-lookup"><span data-stu-id="40882-160">The subclass procedure can reside in either the application's executable or a DLL.</span></span>

<span data-ttu-id="40882-161">[**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) retourne l’adresse de la procédure de fenêtre d’origine de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-161">[**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) returns the address of the window's original window procedure.</span></span> <span data-ttu-id="40882-162">L’application doit enregistrer l’adresse, en l’utilisant dans les appels suivants à la fonction [**CallWindowProc**](/windows/win32/api/winuser/nf-winuser-callwindowproca) , pour transmettre les messages interceptés à la procédure de fenêtre d’origine.</span><span class="sxs-lookup"><span data-stu-id="40882-162">The application must save the address, using it in subsequent calls to the [**CallWindowProc**](/windows/win32/api/winuser/nf-winuser-callwindowproca) function, to pass intercepted messages to the original window procedure.</span></span> <span data-ttu-id="40882-163">L’application doit également avoir l’adresse de la procédure de fenêtre d’origine pour supprimer la sous-classe de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-163">The application must also have the original window procedure address to remove the subclass from the window.</span></span> <span data-ttu-id="40882-164">Pour supprimer la sous-classe, l’application appelle à nouveau **SetWindowLong** , en passant l’adresse de la procédure de fenêtre d’origine avec l’indicateur **\_ WNDPROC GWL** et le handle à la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-164">To remove the subclass, the application calls **SetWindowLong** again, passing the address of the original window procedure with the **GWL\_WNDPROC** flag and the handle to the window.</span></span>

<span data-ttu-id="40882-165">Le système est propriétaire des classes globales du système et les aspects des contrôles peuvent passer d’une version du système à l’autre.</span><span class="sxs-lookup"><span data-stu-id="40882-165">The system owns the system global classes, and aspects of the controls might change from one version of the system to the next.</span></span> <span data-ttu-id="40882-166">Si l’application doit sous-classe une fenêtre qui appartient à une classe globale système, le développeur peut avoir besoin de mettre à jour l’application lorsqu’une nouvelle version du système est publiée.</span><span class="sxs-lookup"><span data-stu-id="40882-166">If the application must subclass a window that belongs to a system global class, the developer may need to update the application when a new version of the system is released.</span></span>

<span data-ttu-id="40882-167">Dans la mesure où la sous-classe d’instance se produit après la création d’une fenêtre, vous ne pouvez pas ajouter d’octets supplémentaires à la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-167">Because instance subclassing occurs after a window is created, you cannot add any extra bytes to the window.</span></span> <span data-ttu-id="40882-168">Les applications qui sous-classent une fenêtre doivent utiliser la liste de propriétés de la fenêtre pour stocker toutes les données nécessaires pour une instance de la fenêtre sous-classée.</span><span class="sxs-lookup"><span data-stu-id="40882-168">Applications that subclass a window should use the window's property list to store any data needed for an instance of the subclassed window.</span></span> <span data-ttu-id="40882-169">Pour plus d’informations, consultez Propriétés de la [fenêtre](window-properties.md).</span><span class="sxs-lookup"><span data-stu-id="40882-169">For more information, see [Window Properties](window-properties.md).</span></span>

<span data-ttu-id="40882-170">Lorsqu’une application sous-classe une fenêtre sous-classée, elle doit supprimer les sous-classes dans l’ordre inverse dans lequel elles ont été exécutées.</span><span class="sxs-lookup"><span data-stu-id="40882-170">When an application subclasses a subclassed window, it must remove the subclasses in the reverse order they were performed.</span></span> <span data-ttu-id="40882-171">Si l’ordre de suppression n’est pas inversé, une erreur système irrécupérable peut se produire.</span><span class="sxs-lookup"><span data-stu-id="40882-171">If the removal order is not reversed, an unrecoverable system error may occur.</span></span>

### <a name="global-subclassing"></a><span data-ttu-id="40882-172">Sous-classement global</span><span class="sxs-lookup"><span data-stu-id="40882-172">Global Subclassing</span></span>

<span data-ttu-id="40882-173">Pour une sous-classe globale d’une classe de fenêtre, l’application doit avoir un handle vers une fenêtre de la classe.</span><span class="sxs-lookup"><span data-stu-id="40882-173">To globally subclass a window class, the application must have a handle to a window of the class.</span></span> <span data-ttu-id="40882-174">L’application a également besoin du handle pour supprimer la sous-classe.</span><span class="sxs-lookup"><span data-stu-id="40882-174">The application also needs the handle to remove the subclass.</span></span> <span data-ttu-id="40882-175">Pour obtenir le descripteur, une application crée généralement une fenêtre masquée de la classe à sous-classée.</span><span class="sxs-lookup"><span data-stu-id="40882-175">To get the handle, an application typically creates a hidden window of the class to be subclassed.</span></span> <span data-ttu-id="40882-176">Une fois le descripteur obtenu, l’application appelle la fonction [**SetClassLong**](/windows/win32/api/winuser/nf-winuser-setclasslonga) , en spécifiant le descripteur, l’indicateur **\_ WNDPROC GCL** et l’adresse de la procédure de sous-classe.</span><span class="sxs-lookup"><span data-stu-id="40882-176">After obtaining the handle, the application calls the [**SetClassLong**](/windows/win32/api/winuser/nf-winuser-setclasslonga) function, specifying the handle, the **GCL\_WNDPROC** flag, and the address of the subclass procedure.</span></span> <span data-ttu-id="40882-177">**SetClassLong** retourne l’adresse de la procédure de fenêtre d’origine pour la classe.</span><span class="sxs-lookup"><span data-stu-id="40882-177">**SetClassLong** returns the address of the original window procedure for the class.</span></span>

<span data-ttu-id="40882-178">L’adresse de la procédure de fenêtre d’origine est utilisée dans le sous-processus global de la même façon que dans le sous-processus d’instance.</span><span class="sxs-lookup"><span data-stu-id="40882-178">The original window procedure address is used in global subclassing in the same way it is used in instance subclassing.</span></span> <span data-ttu-id="40882-179">La procédure de sous-classe transmet les messages à la procédure de fenêtre d’origine en appelant [**CallWindowProc**](/windows/win32/api/winuser/nf-winuser-callwindowproca).</span><span class="sxs-lookup"><span data-stu-id="40882-179">The subclass procedure passes messages to the original window procedure by calling [**CallWindowProc**](/windows/win32/api/winuser/nf-winuser-callwindowproca).</span></span> <span data-ttu-id="40882-180">L’application supprime la sous-classe de la classe de fenêtre en appelant à nouveau [**SetClassLong**](/windows/win32/api/winuser/nf-winuser-setclasslonga) , en spécifiant l’adresse de la procédure de fenêtre d’origine, l’indicateur **\_ WNDPROC GCL** et le handle d’une fenêtre de la classe en cours de sous-classe.</span><span class="sxs-lookup"><span data-stu-id="40882-180">The application removes the subclass from the window class by calling [**SetClassLong**](/windows/win32/api/winuser/nf-winuser-setclasslonga) again, specifying the address of the original window procedure, the **GCL\_WNDPROC** flag, and the handle to a window of the class being subclassed.</span></span> <span data-ttu-id="40882-181">Une application qui sous-classe globalement une classe de contrôle doit supprimer la sous-classe lorsque l’application se termine ; dans le cas contraire, une erreur système irrécupérable peut se produire.</span><span class="sxs-lookup"><span data-stu-id="40882-181">An application that globally subclasses a control class must remove the subclass when the application terminates; otherwise, an unrecoverable system error may occur.</span></span>

<span data-ttu-id="40882-182">Le sous-classement global présente les mêmes limitations que le sous-modèle d’instance, ainsi que quelques restrictions supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="40882-182">Global subclassing has the same limitations as instance subclassing, plus some additional restrictions.</span></span> <span data-ttu-id="40882-183">Une application ne doit pas utiliser les octets supplémentaires pour la classe ou l’instance de fenêtre sans connaître exactement la manière dont la procédure de fenêtre d’origine les utilise.</span><span class="sxs-lookup"><span data-stu-id="40882-183">An application should not use the extra bytes for either the class or the window instance without knowing exactly how the original window procedure uses them.</span></span> <span data-ttu-id="40882-184">Si l’application doit associer des données à une fenêtre, elle doit utiliser les propriétés de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-184">If the application must associate data with a window, it should use window properties.</span></span>

## <a name="window-procedure-superclassing"></a><span data-ttu-id="40882-185">Superclassement de la procédure de fenêtre</span><span class="sxs-lookup"><span data-stu-id="40882-185">Window Procedure Superclassing</span></span>

<span data-ttu-id="40882-186">La *superclassement* est une technique qui permet à une application de créer une nouvelle classe de fenêtre avec les fonctionnalités de base de la classe existante, ainsi que les améliorations fournies par l’application.</span><span class="sxs-lookup"><span data-stu-id="40882-186">*Superclassing* is a technique that allows an application to create a new window class with the basic functionality of the existing class, plus enhancements provided by the application.</span></span> <span data-ttu-id="40882-187">Une superclasse est basée sur une classe de fenêtre existante appelée *classe de base*.</span><span class="sxs-lookup"><span data-stu-id="40882-187">A superclass is based on an existing window class called the *base class*.</span></span> <span data-ttu-id="40882-188">Souvent, la classe de base est une classe de fenêtre globale système telle qu’un contrôle d’édition, mais il peut s’agir de n’importe quelle classe de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="40882-188">Frequently, the base class is a system global window class such as an edit control, but it can be any window class.</span></span>

<span data-ttu-id="40882-189">Une superclasse a sa propre procédure de fenêtre, appelée procédure de superclasse.</span><span class="sxs-lookup"><span data-stu-id="40882-189">A superclass has its own window procedure, called the superclass procedure.</span></span> <span data-ttu-id="40882-190">La *procédure de superclasse* peut prendre trois actions lors de la réception d’un message : elle peut passer le message à la procédure de fenêtre d’origine, modifier le message et le passer à la procédure de fenêtre d’origine, ou traiter le message et ne pas le passer à la procédure de fenêtre d’origine.</span><span class="sxs-lookup"><span data-stu-id="40882-190">The *superclass procedure* can take three actions upon receiving a message: It can pass the message to the original window procedure, modify the message and pass it to the original window procedure, or process the message and not pass it to the original window procedure.</span></span> <span data-ttu-id="40882-191">Si la procédure de superclasse traite un message, elle peut le faire avant, après ou avant et après la transmission du message à la procédure de fenêtre d’origine.</span><span class="sxs-lookup"><span data-stu-id="40882-191">If the superclass procedure processes a message, it can do so before, after, or both before and after it passes the message to the original window procedure.</span></span>

<span data-ttu-id="40882-192">Contrairement à une procédure de sous-classe, une procédure de superclasse peut traiter les messages de création de fenêtre ([**WM \_ NCCREATE**](wm-nccreate.md), [**WM \_ Create**](wm-create.md), etc.), mais elle doit également les transmettre à la procédure de fenêtre de la classe de base d’origine afin que la procédure de fenêtre de la classe de base puisse exécuter sa procédure d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="40882-192">Unlike a subclass procedure, a superclass procedure can process window creation messages ([**WM\_NCCREATE**](wm-nccreate.md), [**WM\_CREATE**](wm-create.md), and so on), but it must also pass them to the original base-class window procedure so that the base-class window procedure can perform its initialization procedure.</span></span>

<span data-ttu-id="40882-193">Pour superclasser une classe de fenêtre, une application appelle d’abord la fonction [**GetClassinfo**](/windows/win32/api/winuser/nf-winuser-getclassinfoa) pour récupérer des informations sur la classe de base.</span><span class="sxs-lookup"><span data-stu-id="40882-193">To superclass a window class, an application first calls the [**GetClassInfo**](/windows/win32/api/winuser/nf-winuser-getclassinfoa) function to retrieve information about the base class.</span></span> <span data-ttu-id="40882-194">**GetClassinfo** remplit une structure [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) avec les valeurs de la structure **WNDCLASS** de la classe de base.</span><span class="sxs-lookup"><span data-stu-id="40882-194">**GetClassInfo** fills a [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) structure with the values from the **WNDCLASS** structure of the base class.</span></span> <span data-ttu-id="40882-195">Ensuite, l’application copie son propre handle d’instance dans le membre **HINSTANCE** de la structure **WNDCLASS** et copie le nom de la superclasse dans le membre **lpszClassName** .</span><span class="sxs-lookup"><span data-stu-id="40882-195">Next, the application copies its own instance handle into the **hInstance** member of the **WNDCLASS** structure and copies the name of the superclass into the **lpszClassName** member.</span></span> <span data-ttu-id="40882-196">Si la classe de base a un menu, l’application doit fournir un nouveau menu avec les mêmes identificateurs de menu et copier le nom de menu dans le membre **lpszMenuName** .</span><span class="sxs-lookup"><span data-stu-id="40882-196">If the base class has a menu, the application must provide a new menu with the same menu identifiers and copy the menu name into the **lpszMenuName** member.</span></span> <span data-ttu-id="40882-197">Si la procédure de superclasse traite le message de [**\_ commande WM**](/windows/desktop/menurc/wm-command) et ne la passe pas à la procédure de fenêtre de la classe de base, il n’est pas nécessaire que le menu ait des identificateurs correspondants.</span><span class="sxs-lookup"><span data-stu-id="40882-197">If the superclass procedure processes the [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message and does not pass it to the window procedure of the base class, the menu need not have corresponding identifiers.</span></span> <span data-ttu-id="40882-198">**GetClassinfo** ne retourne pas le membre **lpszMenuName**, **lpszClassName** ou **HINSTANCE** de la structure **WNDCLASS** .</span><span class="sxs-lookup"><span data-stu-id="40882-198">**GetClassInfo** does not return the **lpszMenuName**, **lpszClassName**, or **hInstance** member of the **WNDCLASS** structure.</span></span>

<span data-ttu-id="40882-199">Une application doit également définir le membre **lpfnWndProc** de la structure [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) .</span><span class="sxs-lookup"><span data-stu-id="40882-199">An application must also set the **lpfnWndProc** member of the [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) structure.</span></span> <span data-ttu-id="40882-200">La fonction [**GetClassinfo**](/windows/win32/api/winuser/nf-winuser-getclassinfoa) remplit ce membre avec l’adresse de la procédure de fenêtre d’origine pour la classe.</span><span class="sxs-lookup"><span data-stu-id="40882-200">The [**GetClassInfo**](/windows/win32/api/winuser/nf-winuser-getclassinfoa) function fills this member with the address of the original window procedure for the class.</span></span> <span data-ttu-id="40882-201">L’application doit enregistrer cette adresse, transmettre les messages à la procédure de fenêtre d’origine, puis copier l’adresse de la procédure de superclasse dans le membre **lpfnWndProc** .</span><span class="sxs-lookup"><span data-stu-id="40882-201">The application must save this address, to pass messages to the original window procedure, and then copy the address of the superclass procedure into the **lpfnWndProc** member.</span></span> <span data-ttu-id="40882-202">L’application peut, si nécessaire, modifier tous les autres membres de la structure **WNDCLASS** .</span><span class="sxs-lookup"><span data-stu-id="40882-202">The application can, if necessary, modify any other members of the **WNDCLASS** structure.</span></span> <span data-ttu-id="40882-203">Après avoir rempli la structure **WNDCLASS** , l’application inscrit la superclasse en passant l’adresse de la structure à la fonction [**registerClass**](/windows/win32/api/winuser/nf-winuser-registerclassa) .</span><span class="sxs-lookup"><span data-stu-id="40882-203">After it fills the **WNDCLASS** structure, the application registers the superclass by passing the address of the structure to the [**RegisterClass**](/windows/win32/api/winuser/nf-winuser-registerclassa) function.</span></span> <span data-ttu-id="40882-204">La superclasse peut ensuite être utilisée pour créer des fenêtres.</span><span class="sxs-lookup"><span data-stu-id="40882-204">The superclass can then be used to create windows.</span></span>

<span data-ttu-id="40882-205">Étant donné que la superclasse enregistre une nouvelle classe de fenêtre, une application peut ajouter à la fois les octets de classe supplémentaires et les octets de fenêtre supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="40882-205">Because superclassing registers a new window class, an application can add to both the extra class bytes and the extra window bytes.</span></span> <span data-ttu-id="40882-206">La superclasse ne doit pas utiliser les octets supplémentaires originaux pour la classe de base ou la fenêtre pour les mêmes raisons qu’une sous-classe d’instance ou une sous-classe globale ne doit pas les utiliser.</span><span class="sxs-lookup"><span data-stu-id="40882-206">The superclass must not use the original extra bytes for the base class or the window for the same reasons that an instance subclass or a global subclass should not use them.</span></span> <span data-ttu-id="40882-207">En outre, si l’application ajoute des octets supplémentaires pour son utilisation à la classe ou à l’instance de fenêtre, elle doit référencer les octets supplémentaires par rapport au nombre d’octets supplémentaires utilisés par la classe de base d’origine.</span><span class="sxs-lookup"><span data-stu-id="40882-207">Also, if the application adds extra bytes for its use to either the class or the window instance, it must reference the extra bytes relative to the number of extra bytes used by the original base class.</span></span> <span data-ttu-id="40882-208">Étant donné que le nombre d’octets utilisés par la classe de base peut varier d’une version de la classe de base à l’autre, le décalage de départ pour les octets supplémentaires de la superclasse peut également varier d’une version de la classe de base à la suivante.</span><span class="sxs-lookup"><span data-stu-id="40882-208">Because the number of bytes used by the base class may vary from one version of the base class to the next, the starting offset for the superclass's own extra bytes may also vary from one version of the base class to the next.</span></span>

 

 
