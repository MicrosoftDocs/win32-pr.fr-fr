---
title: Mise en cache des propriétés UI Automation et des modèles de contrôle
description: Lorsque vous utilisez l’automatisation d’interface utilisateur de Microsoft, les clients doivent souvent récupérer plusieurs propriétés pour plusieurs éléments Automation.
ms.assetid: 948b3bb9-75a9-4197-9680-e6fe7bb86feb
keywords:
- mise en cache, propriétés UI Automation
- mise en cache, propriétés
- mise en cache, modèles de contrôle UI Automation
- mise en cache, modèles de contrôle
- UI Automation, propriétés de mise en cache
- UI Automation, mise en cache des propriétés
- clients, mise en cache des propriétés UI Automation
- clients, mise en cache des modèles de contrôle UI Automation
- UI Automation, mise en cache des modèles de contrôle
- UI Automation, mise en cache du modèle de contrôle
- modèles de contrôle, mise en cache
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 69f75a7dc9491565fdfdc0ecc73808c2fb6a9d82
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104379756"
---
# <a name="caching-ui-automation-properties-and-control-patterns"></a><span data-ttu-id="43af7-114">Mise en cache des propriétés UI Automation et des modèles de contrôle</span><span class="sxs-lookup"><span data-stu-id="43af7-114">Caching UI Automation Properties and Control Patterns</span></span>

<span data-ttu-id="43af7-115">Lorsque vous utilisez l’automatisation d’interface utilisateur de Microsoft, les clients doivent souvent récupérer plusieurs propriétés pour plusieurs éléments Automation.</span><span class="sxs-lookup"><span data-stu-id="43af7-115">When using Microsoft UI Automation, clients often need to retrieve multiple properties for multiple automation elements.</span></span> <span data-ttu-id="43af7-116">Un client peut récupérer des propriétés individuelles un élément à la fois à l’aide des méthodes de récupération de propriété telles que [**IUIAutomationElement :: CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) ou [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span><span class="sxs-lookup"><span data-stu-id="43af7-116">A client could retrieve individual properties one element at a time by using the property retrieval methods such as [**IUIAutomationElement::CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) or [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span></span> <span data-ttu-id="43af7-117">Toutefois, cette méthode est lente et inefficace, car elle nécessite un appel inter-processus pour chaque propriété en cours de récupération.</span><span class="sxs-lookup"><span data-stu-id="43af7-117">However, this method is slow and inefficient because it requires a cross-process call for each property being retrieved.</span></span> <span data-ttu-id="43af7-118">Pour améliorer les performances, les clients peuvent utiliser les fonctionnalités de mise en cache (également appelées extraction en bloc) d’UI Automation.</span><span class="sxs-lookup"><span data-stu-id="43af7-118">To improve performance, clients can use the caching (also called bulk fetching) capabilities of UI Automation.</span></span> <span data-ttu-id="43af7-119">La mise en cache permet à un client de récupérer toutes les propriétés souhaitées pour tous les éléments souhaités à l’aide d’un seul appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="43af7-119">Caching enables a client to retrieve all of the desired properties for all of the desired elements with a single method call.</span></span> <span data-ttu-id="43af7-120">Le client peut ensuite récupérer les propriétés individuelles du cache en fonction des besoins et peut obtenir régulièrement un nouvel instantané du cache, généralement en réponse à des événements qui indiquent des modifications dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="43af7-120">The client can then retrieve the individual properties from the cache as needed, and can get a new snapshot of the cache periodically, generally in response to events that signify changes in the UI.</span></span>

<span data-ttu-id="43af7-121">L’application peut demander la mise en cache lorsqu’elle récupère un élément UI Automation à l’aide d’une méthode, telle que [**IUIAutomation :: ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker :: GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache)ou [**IUIAutomationElement :: FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span><span class="sxs-lookup"><span data-stu-id="43af7-121">The application can request caching when it retrieves a UI Automation element by using a method, such as [**IUIAutomation::ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker::GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache), or [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span></span>

<span data-ttu-id="43af7-122">La mise en cache se produit également lorsque vous spécifiez une requête de cache lors de l’abonnement à des événements.</span><span class="sxs-lookup"><span data-stu-id="43af7-122">Caching also occurs when you specify a cache request while subscribing to events.</span></span> <span data-ttu-id="43af7-123">L’élément UI Automation passé à votre gestionnaire d’événements comme source d’un événement contient les propriétés mises en cache et les modèles de contrôle spécifiés par la requête de cache.</span><span class="sxs-lookup"><span data-stu-id="43af7-123">The UI Automation element passed to your event handler as the source of an event contains the cached properties and control patterns that are specified by the cache request.</span></span> <span data-ttu-id="43af7-124">Toute modification apportée à la demande de cache après vous être abonné à l’événement n’a aucun effet.</span><span class="sxs-lookup"><span data-stu-id="43af7-124">Any changes made to the cache request after you subscribe to the event have no effect.</span></span>

<span data-ttu-id="43af7-125">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="43af7-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="43af7-126">Demandes de cache</span><span class="sxs-lookup"><span data-stu-id="43af7-126">Cache Requests</span></span>](#cache-requests)
    -   [<span data-ttu-id="43af7-127">Spécification de la propriété et des modèles de contrôle à mettre en cache</span><span class="sxs-lookup"><span data-stu-id="43af7-127">Specifying Property and Control Patterns to Cache</span></span>](#specifying-property-and-control-patterns-to-cache)
    -   [<span data-ttu-id="43af7-128">Spécification de l’étendue et du filtrage d’une demande de mise en cache</span><span class="sxs-lookup"><span data-stu-id="43af7-128">Specifying the Scoping and Filtering of a Caching Request</span></span>](#specifying-the-scoping-and-filtering-of-a-caching-request)
    -   [<span data-ttu-id="43af7-129">Force des références d’élément</span><span class="sxs-lookup"><span data-stu-id="43af7-129">Strength of Element References</span></span>](#strength-of-element-references)
-   [<span data-ttu-id="43af7-130">Récupération des enfants et des parents mis en cache</span><span class="sxs-lookup"><span data-stu-id="43af7-130">Retrieving Cached Children and Parents</span></span>](#retrieving-cached-children-and-parents)
-   [<span data-ttu-id="43af7-131">Récupération d’un nouvel instantané du cache</span><span class="sxs-lookup"><span data-stu-id="43af7-131">Retrieving a New Snapshot of the Cache</span></span>](#retrieving-a-new-snapshot-of-the-cache)
-   [<span data-ttu-id="43af7-132">Exemples</span><span class="sxs-lookup"><span data-stu-id="43af7-132">Examples</span></span>](#examples)
-   [<span data-ttu-id="43af7-133">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="43af7-133">Related topics</span></span>](#related-topics)

## <a name="cache-requests"></a><span data-ttu-id="43af7-134">Demandes de cache</span><span class="sxs-lookup"><span data-stu-id="43af7-134">Cache Requests</span></span>

<span data-ttu-id="43af7-135">La mise en cache implique de déterminer les propriétés à récupérer et les éléments à partir desquels les récupérer, puis d’utiliser ces informations pour créer une demande de cache.</span><span class="sxs-lookup"><span data-stu-id="43af7-135">Caching involves determining which properties to retrieve and which elements to retrieve them from, and then using this information to create a cache request.</span></span> <span data-ttu-id="43af7-136">Chaque fois que le client obtient une interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) pour l’élément d’interface utilisateur, UI Automation met en cache les informations spécifiées dans la requête de cache.</span><span class="sxs-lookup"><span data-stu-id="43af7-136">Whenever the client obtains an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for UI item, UI Automation caches the information that is specified in the cache request.</span></span>

<span data-ttu-id="43af7-137">Pour créer une demande de cache, commencez par utiliser la méthode [**IUIAutomation :: CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) pour récupérer un pointeur d’interface [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) .</span><span class="sxs-lookup"><span data-stu-id="43af7-137">To create a cache request, begin by using the [**IUIAutomation::CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) method to retrieve an [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) interface pointer.</span></span> <span data-ttu-id="43af7-138">Ensuite, configurez la demande de cache à l’aide des méthodes de **IUIAutomationCacheRequest**.</span><span class="sxs-lookup"><span data-stu-id="43af7-138">Next, configure the cache request by using the methods of **IUIAutomationCacheRequest**.</span></span>

### <a name="specifying-property-and-control-patterns-to-cache"></a><span data-ttu-id="43af7-139">Spécification de la propriété et des modèles de contrôle à mettre en cache</span><span class="sxs-lookup"><span data-stu-id="43af7-139">Specifying Property and Control Patterns to Cache</span></span>

<span data-ttu-id="43af7-140">Vous pouvez spécifier des propriétés à mettre en cache en appelant [**IUIAutomationCacheRequest :: AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span><span class="sxs-lookup"><span data-stu-id="43af7-140">You can specify properties to cache by calling [**IUIAutomationCacheRequest::AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span></span> <span data-ttu-id="43af7-141">Vous pouvez spécifier des modèles de contrôle à mettre en cache en appelant [**IUIAutomationCacheRequest :: AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span><span class="sxs-lookup"><span data-stu-id="43af7-141">You can specify control patterns to cache by calling [**IUIAutomationCacheRequest::AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span></span> <span data-ttu-id="43af7-142">Lorsqu’un modèle de contrôle est mis en cache, ses propriétés ne sont pas automatiquement mises en cache ; vous devez spécifier les propriétés que vous souhaitez mettre en cache à l’aide de **AddProperty**.</span><span class="sxs-lookup"><span data-stu-id="43af7-142">When a control pattern is cached, its properties are not automatically cached; you must specify the properties you want to cache by using **AddProperty**.</span></span>

<span data-ttu-id="43af7-143">Vous pouvez récupérer une propriété de modèle de contrôle (par exemple, la propriété Value du modèle de contrôle [value](uiauto-implementingvalue.md) ), sans avoir à récupérer le modèle de contrôle entier dans le cache.</span><span class="sxs-lookup"><span data-stu-id="43af7-143">You can retrieve a control pattern property (for example, the Value property of the [Value](uiauto-implementingvalue.md) control pattern), without having to retrieve the entire control pattern into the cache.</span></span> <span data-ttu-id="43af7-144">Vous devez récupérer le modèle de contrôle uniquement si vous devez utiliser une méthode de modèle de contrôle.</span><span class="sxs-lookup"><span data-stu-id="43af7-144">You must retrieve the control pattern only if you need to use a control pattern method.</span></span>

### <a name="specifying-the-scoping-and-filtering-of-a-caching-request"></a><span data-ttu-id="43af7-145">Spécification de l’étendue et du filtrage d’une demande de mise en cache</span><span class="sxs-lookup"><span data-stu-id="43af7-145">Specifying the Scoping and Filtering of a Caching Request</span></span>

<span data-ttu-id="43af7-146">Vous pouvez spécifier les éléments dont vous souhaitez mettre en cache les propriétés et les modèles de contrôle en définissant la propriété [**IUIAutomationCacheRequest :: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) avant d’utiliser la requête.</span><span class="sxs-lookup"><span data-stu-id="43af7-146">You can specify the elements whose properties and control patterns you want to cache by setting the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property before using the request.</span></span> <span data-ttu-id="43af7-147">La portée est relative aux éléments qui sont récupérés par la méthode à laquelle la demande de cache est passée.</span><span class="sxs-lookup"><span data-stu-id="43af7-147">The scope is relative to the elements that are retrieved by the method to which the cache request is passed.</span></span> <span data-ttu-id="43af7-148">Par exemple, si vous définissez uniquement [**les \_ enfants TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope), puis récupérez un élément UI Automation, les propriétés et les modèles de contrôle des enfants de cet élément sont mis en cache, mais les propriétés et les modèles de contrôle de l’élément lui-même ne sont pas mis en cache.</span><span class="sxs-lookup"><span data-stu-id="43af7-148">For example, if you set only [**TreeScope\_Children**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope), and then retrieve a UI Automation element, the properties and control patterns of children of that element are cached, but the properties and control patterns of the element itself are not cached.</span></span> <span data-ttu-id="43af7-149">Pour vous assurer que la mise en cache est effectuée pour l’élément récupéré lui-même, vous devez inclure l' **\_ élément TreeScope** dans la propriété **IUIAutomationCacheRequest :: TreeScope** .</span><span class="sxs-lookup"><span data-stu-id="43af7-149">To ensure that caching is done for the retrieved element itself, you must include **TreeScope\_Element** in the **IUIAutomationCacheRequest::TreeScope** property.</span></span> <span data-ttu-id="43af7-150">Il n’est pas possible de définir l’étendue sur **TreeScope \_ parent** ou l' **\_ ancêtre de TreeScope**.</span><span class="sxs-lookup"><span data-stu-id="43af7-150">It is not possible to set the scope to **TreeScope\_Parent** or **TreeScope\_Ancestors**.</span></span> <span data-ttu-id="43af7-151">Toutefois, un élément parent peut être mis en cache lorsqu’un élément enfant est mis en cache. Dans cette rubrique, consultez la section Récupération des enfants et des parents mis en cache.</span><span class="sxs-lookup"><span data-stu-id="43af7-151">However, a parent element can be cached when a child element is cached; see Retrieving Cached Children and Parents in this topic.</span></span>

<span data-ttu-id="43af7-152">L’étendue de la mise en cache est également affectée par la propriété [**IUIAutomationCacheRequest :: TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) .</span><span class="sxs-lookup"><span data-stu-id="43af7-152">The extent of caching is also affected by the [**IUIAutomationCacheRequest::TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) property.</span></span> <span data-ttu-id="43af7-153">Par défaut, la mise en cache est effectuée uniquement pour les éléments qui apparaissent dans l’affichage de contrôle de l’arborescence UI Automation.</span><span class="sxs-lookup"><span data-stu-id="43af7-153">By default, caching is performed only for elements that appear in the control view of the UI Automation tree.</span></span> <span data-ttu-id="43af7-154">Vous pouvez toutefois modifier cette propriété pour appliquer la mise en cache à tous les éléments ou uniquement aux éléments qui apparaissent dans la vue de contenu.</span><span class="sxs-lookup"><span data-stu-id="43af7-154">However, you can change this property to apply caching to all elements, or only to elements that appear in the content view.</span></span>

### <a name="strength-of-element-references"></a><span data-ttu-id="43af7-155">Force des références d’élément</span><span class="sxs-lookup"><span data-stu-id="43af7-155">Strength of Element References</span></span>

<span data-ttu-id="43af7-156">Lorsque vous récupérez un élément Automation, par défaut, vous avez accès à toutes les propriétés et à tous les modèles de contrôle de cet élément, y compris les propriétés et les modèles de contrôle qui n’ont pas été mis en cache.</span><span class="sxs-lookup"><span data-stu-id="43af7-156">When you retrieve an automation element, by default you have access to all properties and control patterns of that element, including those properties and control patterns that were not cached.</span></span> <span data-ttu-id="43af7-157">Toutefois, vous pouvez spécifier que la référence à l’élément fait référence aux données mises en cache uniquement, en affectant à la propriété [**IUIAutomationCacheRequest :: AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) la valeur **AutomationElementMode \_ None**.</span><span class="sxs-lookup"><span data-stu-id="43af7-157">However, you can specify that the reference to the element refers to cached data only, by setting the [**IUIAutomationCacheRequest::AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) property to **AutomationElementMode\_None**.</span></span> <span data-ttu-id="43af7-158">Dans ce cas, vous n’avez pas accès aux propriétés et aux modèles de contrôle non mis en cache des éléments récupérés.</span><span class="sxs-lookup"><span data-stu-id="43af7-158">In this case, you do not have access to any uncached properties and control patterns of retrieved elements.</span></span> <span data-ttu-id="43af7-159">Cela signifie que vous ne pouvez pas accéder à des propriétés actuelles telles que [**IUIAutomationElement :: CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) ou récupérer un modèle de contrôle à l’aide de [**IUIAutomationElement :: GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span><span class="sxs-lookup"><span data-stu-id="43af7-159">This means that you cannot access any current properties such as [**IUIAutomationElement::CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) or retrieve a control pattern by using [**IUIAutomationElement::GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span></span> <span data-ttu-id="43af7-160">Sur les modèles de contrôle mis en cache, vous ne pouvez pas appeler des méthodes qui effectuent des actions sur le contrôle, telles que [**IUIAutomationInvokePattern :: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="43af7-160">On cached control patterns, you cannot call methods that perform actions on the control, such as [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="43af7-161">Un lecteur d’écran est un exemple d’application qui n’a peut-être pas besoin de références complètes aux objets. il peut prérécupérer les propriétés de nom et de type de contrôle des éléments dans une fenêtre sans avoir besoin des objets d’élément Automation eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="43af7-161">An example of an application that might not need full references to objects is a screen reader, which might prefetch the name and control type properties of elements in a window without needing the automation element objects themselves.</span></span>

## <a name="retrieving-cached-children-and-parents"></a><span data-ttu-id="43af7-162">Récupération des enfants et des parents mis en cache</span><span class="sxs-lookup"><span data-stu-id="43af7-162">Retrieving Cached Children and Parents</span></span>

<span data-ttu-id="43af7-163">Lorsque vous récupérez un élément Automation et demandez la mise en cache pour les enfants de cet élément via la propriété [**IUIAutomationCacheRequest :: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) de la requête, il est possible d’obtenir les éléments enfants en appelant [**IUIAutomationElement :: GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) sur l’élément que vous avez récupéré.</span><span class="sxs-lookup"><span data-stu-id="43af7-163">When you retrieve an automation element and request caching for children of that element through the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property of the request, it is possible to get the child elements by calling [**IUIAutomationElement::GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) on the element you retrieved.</span></span>

<span data-ttu-id="43af7-164">Si [**l' \_ élément TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) est inclus dans l’étendue de la demande de cache, l’élément racine de la requête peut être récupéré en appelant [**IUIAutomationElement :: GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) sur l’un des éléments enfants.</span><span class="sxs-lookup"><span data-stu-id="43af7-164">If [**TreeScope\_Element**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) was included in the scope of the cache request, the root element of the request can be retrieved by calling [**IUIAutomationElement::GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) on any of the child elements.</span></span>

> [!Note]  
> <span data-ttu-id="43af7-165">Vous ne pouvez pas mettre en cache les parents ou les ancêtres de l’élément racine de la requête.</span><span class="sxs-lookup"><span data-stu-id="43af7-165">You cannot cache parents or ancestors of the root element of the request.</span></span>

 

## <a name="retrieving-a-new-snapshot-of-the-cache"></a><span data-ttu-id="43af7-166">Récupération d’un nouvel instantané du cache</span><span class="sxs-lookup"><span data-stu-id="43af7-166">Retrieving a New Snapshot of the Cache</span></span>

<span data-ttu-id="43af7-167">Le cache est valide uniquement tant que rien ne change dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="43af7-167">The cache is valid only as long as nothing changes in the UI.</span></span> <span data-ttu-id="43af7-168">Votre application est chargée de récupérer un nouvel instantané du cache, en général, en réponse aux événements.</span><span class="sxs-lookup"><span data-stu-id="43af7-168">Your application is responsible for retrieving a new snapshot of the cache, typically, in response to events.</span></span>

<span data-ttu-id="43af7-169">Si vous vous abonnez à un événement à l’aide d’une requête de cache, vous obtenez un nouvel instantané [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) du cache comme source de l’événement chaque fois que votre gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="43af7-169">If you subscribe to an event with a cache request, you obtain an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) new snapshot of the cache as the source of the event whenever your event handler is called.</span></span> <span data-ttu-id="43af7-170">Vous pouvez également récupérer un nouvel instantané des informations mises en cache pour un élément en appelant [**IUIAutomationElement :: BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span><span class="sxs-lookup"><span data-stu-id="43af7-170">You can also retrieve a new snapshot of cached information for an element by calling [**IUIAutomationElement::BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span></span> <span data-ttu-id="43af7-171">Vous pouvez transmettre le [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) d’origine pour obtenir un nouvel instantané de toutes les informations précédemment mises en cache.</span><span class="sxs-lookup"><span data-stu-id="43af7-171">You can pass in the original [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) to get a new snapshot of all information that was previously cached.</span></span>

<span data-ttu-id="43af7-172">La récupération d’un nouvel instantané du cache ne modifie pas les propriétés des références [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) existantes.</span><span class="sxs-lookup"><span data-stu-id="43af7-172">Retrieving a new snapshot of the cache does not modify the properties of any existing [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) references.</span></span>

## <a name="examples"></a><span data-ttu-id="43af7-173">Exemples</span><span class="sxs-lookup"><span data-stu-id="43af7-173">Examples</span></span>

<span data-ttu-id="43af7-174">Pour obtenir des exemples de code qui montrent comment utiliser les fonctionnalités de mise en cache d’UI Automation, consultez Utilisation de la [mise en cache](uiauto-howto-use-caching.md).</span><span class="sxs-lookup"><span data-stu-id="43af7-174">For code examples that show how to use the caching capabilities of UI Automation, see [How to Use Caching](uiauto-howto-use-caching.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="43af7-175">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="43af7-175">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="43af7-176">**Méthodologique**</span><span class="sxs-lookup"><span data-stu-id="43af7-176">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="43af7-177">Vue d'ensemble des modèles de contrôle UI Automation</span><span class="sxs-lookup"><span data-stu-id="43af7-177">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="43af7-178">Obtention d'éléments UI Automation</span><span class="sxs-lookup"><span data-stu-id="43af7-178">Obtaining UI Automation Elements</span></span>](uiauto-obtainingelements.md)
</dt> <dt>

[<span data-ttu-id="43af7-179">Vue d'ensemble des propriétés UI Automation</span><span class="sxs-lookup"><span data-stu-id="43af7-179">UI Automation Properties Overview</span></span>](uiauto-propertiesoverview.md)
</dt> </dl>

 

 




