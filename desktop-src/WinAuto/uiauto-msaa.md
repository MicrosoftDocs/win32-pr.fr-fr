---
title: UI Automation et Active Accessibility
description: Microsoft Active Accessibility est l’API héritée qui a été introduite dans Windows 95 et qui a été conçue pour rendre les applications Windows accessibles.
ms.assetid: 6fc92e67-b94b-4ba3-9f5d-42be6072f110
keywords:
- UI Automation, Microsoft Active Accessibility
- UI Automation, accessibilité
- UI Automation, Active Accessibility
- Automation d’interface utilisateur, langages de programmation
- UI Automation, arborescences
- UI Automation, navigation
- UI Automation, types de contrôles
- accessibilité
- Active Accessibility
- Microsoft Active Accessibility
- types de contrôle, à propos de
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20a784a6537a3206f32c1299342a521de01d60fab2968294a067f8cc1f7e6dff
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/11/2021
ms.locfileid: "118564380"
---
# <a name="ui-automation-and-active-accessibility"></a>UI Automation et Active Accessibility

Microsoft Active Accessibility est l’API héritée qui a été introduite dans Windows 95 et qui a été conçue pour rendre les applications Windows accessibles. l’automatisation d’interface utilisateur de Microsoft est le nouveau modèle d’accessibilité pour Windows et est destiné à répondre aux besoins des produits de technologie d’assistance et des outils de test automatisés. UI Automation offre de nombreuses améliorations par rapport à Microsoft Active Accessibility. Cette rubrique explique les différences entre les deux technologies.

Cette rubrique contient les sections suivantes.

-   [Langages de programmation](#programming-languages)
-   [Serveurs et clients](#servers-and-clients)
-   [Éléments d’interface utilisateur](#ui-elements)
-   [Arborescences et navigation](#tree-views-and-navigation)
-   [Rôles et types de contrôle](#roles-and-control-types)
-   [États et propriétés](#states-and-properties)
-   [Événements](#events)
-   [Accès aux propriétés et objets Active Accessibility à partir d’UI Automation](#accessing-active-accessibility-properties-and-objects-from-ui-automation)
-   [Rubriques connexes](#related-topics)

## <a name="programming-languages"></a>Langages de programmation

Microsoft Active Accessibility est basé sur le modèle COM (Component Object Model) avec prise en charge des interfaces doubles et, par conséquent, est programmable en C/C++ et en langages de script.

Lorsque l’automatisation d’interface utilisateur a été introduite, l’API cliente était limitée au code managé, tandis que l’API du fournisseur incluait à la fois des implémentations managées et non managées. avec Windows 7, une nouvelle API client COM a été introduite pour faciliter le programme des applications clientes UI Automation en C/C++.

## <a name="servers-and-clients"></a>Serveurs et clients

Dans Microsoft Active Accessibility, les serveurs et les clients communiquent directement, en grande partie via l’implémentation serveur de l’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .

Dans UI Automation, un service principal se trouve entre le serveur (fournisseur) et le client. Le service principal effectue des appels aux interfaces implémentées par les fournisseurs et fournit des services supplémentaires, tels que la génération d’identificateurs d’exécution uniques pour les éléments d’interface utilisateur. Les applications clientes accèdent à ce service principal en créant un objet [**CUIAutomation**](/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)) . Cet objet prend en charge un ensemble d’interfaces clientes qui sont séparées des interfaces du fournisseur. Pour plus d’informations, consultez [création de l’objet CUIAutomation](uiauto-creatingcuiautomation.md).

Les fournisseurs UI Automation peuvent fournir des informations aux clients Microsoft Active Accessibility, et les serveurs Microsoft Active Accessibility peuvent fournir des informations aux applications clientes UI Automation. Toutefois, étant donné que Microsoft Active Accessibility n’expose pas autant d’informations que l’Automation d’interface utilisateur, les deux modèles ne sont pas entièrement compatibles.

## <a name="ui-elements"></a>Éléments de l'interface utilisateur

Microsoft Active Accessibility présente un élément d’interface utilisateur sous la forme d’une interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) associée à un identificateur enfant. Il est difficile de comparer deux pointeurs **IAccessible** pour déterminer s’ils font référence au même élément.

Dans UI Automation, chaque élément est représenté sous la forme d’un objet qui expose l’interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) aux clients. Les éléments peuvent être comparés par leurs identificateurs au moment de l’exécution, qui sont récupérés à l’aide de [**IUIAutomationElement :: GetRuntimeId**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getruntimeid).

## <a name="tree-views-and-navigation"></a>Arborescences et navigation

Les éléments d’interface utilisateur de l’écran peuvent être considérés comme une arborescence avec le bureau comme racine, les fenêtres d’application comme enfants immédiats et les éléments dans les applications comme descendants supplémentaires.

Dans Microsoft Active Accessibility, de nombreux éléments d’interface utilisateur qui ne sont pas pertinents pour les utilisateurs finaux sont exposés dans l’arborescence. Les applications clientes doivent examiner tous les éléments de l’arborescence pour déterminer les éléments qui sont significatifs.

Les applications clientes UI Automation voient l’interface utilisateur via une vue filtrée. La vue contient uniquement les éléments qui fournissent des informations à l’utilisateur ou pour lesquels l’utilisateur peut interagir. Les vues prédéfinies qui incluent uniquement les éléments de contrôle et uniquement les éléments de contenu sont disponibles, et les applications clientes peuvent définir des vues personnalisées. UI Automation facilite la description de l’interface utilisateur pour l’utilisateur et pour aider l’utilisateur à interagir avec les applications.

Dans Microsoft Active Accessibility, la navigation entre les éléments est spatiale, par exemple, en passant à l’élément qui se trouve à gauche sur l’écran, logique, par exemple, en passant à l’élément de menu suivant ou à l’élément suivant dans l’ordre de tabulation dans une boîte de dialogue, ou hiérarchique, par exemple en passant au premier élément enfant dans un conteneur ou d’un élément enfant à son élément La navigation hiérarchique est compliquée par le fait que les éléments enfants ne sont pas toujours des objets qui implémentent [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).

Dans UI Automation, tous les éléments d’interface utilisateur sont des objets COM qui exposent l’interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) et prennent en charge les mêmes fonctionnalités de base. Du point de vue du fournisseur, les objets COM implémentent une interface héritée de [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple). La navigation est principalement hiérarchique ; autrement dit, des parents aux enfants, et d’un frère au suivant. Toutefois, la navigation entre frères a un élément logique, car elle peut suivre l’ordre de tabulation. Un client peut naviguer à partir de n’importe quel point de départ, à l’aide de n’importe quelle vue filtrée de l’arborescence, à l’aide de [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker). Un client peut également accéder à des enfants ou descendants particuliers à l’aide de [**IUIAutomationElement :: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) et [**IUIAutomationElement :: FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall). Par exemple, il est facile de récupérer tous les éléments d’une boîte de dialogue qui prennent en charge un modèle de contrôle spécifié.

La navigation dans UI Automation est plus cohérente que dans Microsoft Active Accessibility. Certains éléments, tels que les listes déroulantes et les fenêtres indépendantes, apparaissent deux fois dans l’arborescence de Active Accessibility Microsoft, et la navigation à partir de ces éléments peut avoir des résultats inattendus. Il est difficile d’implémenter Microsoft Active Accessibility correctement pour un contrôle rebar. UI Automation permet le reparentage et le repositionnement, afin qu’un élément puisse être placé n’importe où dans l’arborescence, en dépit de la hiérarchie imposée par la propriété de Windows.

## <a name="roles-and-control-types"></a>Rôles et types de contrôle

Microsoft Active Accessibility utilise la propriété accRole ([**IAccessible :: obtenir \_ accRole**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole)) pour récupérer une description du rôle d’élément dans l’interface utilisateur, telle que le [**\_ \_ curseur système de rôle**](object-roles.md) ou le [**système de rôle \_ \_ MenuItem**](object-roles.md). Le rôle d’un élément est l’indice principal pour connaître ses fonctionnalités disponibles. L’interaction avec un contrôle est obtenue à l’aide de méthodes fixes telles que [**IAccessible :: accSelect**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accselect) et [**IAccessible :: accDoDefaultAction**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction). L’interaction entre l’application cliente et l’interface utilisateur est limitée à ce qui peut être effectué par le biais de [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).

En revanche, UI Automation dissocie le type de contrôle de l’élément, qui est décrit par la propriété [**IUIAutomationElement :: CurrentControlType**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentcontroltype) (ou [**IUIAutomationElement :: CachedControlType**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_cachedcontroltype)), à partir de ses fonctionnalités attendues. Les fonctionnalités sont déterminées par les modèles de contrôle pris en charge par le fournisseur via son implémentation d’interfaces spécialisées. Les modèles de contrôle peuvent être combinés pour décrire l’ensemble complet des fonctionnalités prises en charge par un élément d’interface utilisateur particulier. Certains fournisseurs sont requis pour prendre en charge un modèle de contrôle particulier. Par exemple, le fournisseur d’une case à cocher doit prendre en charge le modèle de contrôle [Toggle](uiauto-implementingtoggle.md) . D’autres fournisseurs sont requis pour prendre en charge un ou plusieurs modèles de contrôle. Par exemple, un bouton doit prendre en charge le modèle de contrôle Toggle ou [Invoke](uiauto-implementinginvoke.md) . D’autres encore ne prennent en charge aucun modèle de contrôle. Par exemple, un volet qui ne peut pas être déplacé, redimensionné ou ancré n’a pas de modèles de contrôle.

UI Automation prend en charge les contrôles personnalisés, qui sont identifiés par la constante [**UIA \_ CustomControlTypeId**](uiauto-controltype-ids.md) et peuvent être décrits par la propriété [**IUIAutomationElement :: CurrentLocalizedControlType**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentlocalizedcontroltype) (ou [**IUIAutomationElement :: CachedLocalizedControlType**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_cachedlocalizedcontroltype)).

Le tableau suivant mappe les[rôles d’objet](object-roles.md) Microsoft Active Accessibility aux types de contrôle UI Automation.



| Rôle Active Accessibility                                                   | Type de contrôle UI Automation                                                                     |
|-----------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
| [**\_PUSHBUTTON système de rôle \_**](object-roles.md)     | [Button](uiauto-supportbuttoncontroltype.md)                                                  |
| [**\_client du système de rôle \_**](object-roles.md)             | [Calendrier](uiauto-supportcalendarcontroltype.md)                                              |
| [**système de rôle \_ \_ CHECKBUTTON**](object-roles.md)   | [CheckBox](uiauto-supportcheckboxcontroltype.md)                                              |
| [**\_ComboBox système de rôle \_**](object-roles.md)         | [ComboBox](uiauto-supportcomboboxcontroltype.md)                                              |
| [**\_client du système de rôle \_**](object-roles.md)             | Consultez [types de contrôles personnalisés](uiauto-designingcustompropseventpatterns.md). |
| [**\_liste des systèmes de rôles \_**](object-roles.md)                 | [DataGrid](uiauto-supportdatagridcontroltype.md)                                              |
| [**\_ListItem du système de rôle \_**](object-roles.md)         | [DataItem](uiauto-supportdataitemcontroltype.md)                                              |
| [**\_document système de rôle \_**](object-roles.md)         | [Document](uiauto-supportdocumentcontroltype.md)                                              |
| [**\_texte du système de rôle \_**](object-roles.md)                 | [Modifier](uiauto-supporteditcontroltype.md)                                                      |
| [**\_regroupement du système de rôle \_**](object-roles.md)         | [Groupe](uiauto-supportgroupcontroltype.md)                                                    |
| [**\_liste des systèmes de rôles \_**](object-roles.md)                 | [En-tête](uiauto-supportheadercontroltype.md)                                                  |
| [**système de rôle \_ \_ COLUMNHEADER**](object-roles.md) | [HeaderItem](uiauto-supportheaderitemcontroltype.md)                                          |
| [**\_lien système de rôle \_**](object-roles.md)                 | [Lien hypertexte](uiauto-supporthyperlinkcontroltype.md)                                            |
| [**\_graphique du système de rôle \_**](object-roles.md)           | [Image](uiauto-supportimagecontroltype.md)                                                    |
| [**\_liste des systèmes de rôles \_**](object-roles.md)                 | [Liste](uiauto-supportlistcontroltype.md)                                                      |
| [**\_ListItem du système de rôle \_**](object-roles.md)         | [ListItem](uiauto-supportlistitemcontroltype.md)                                              |
| [**système de rôle \_ \_ MENUPOPUP**](object-roles.md)       | [Menu](uiauto-supportmenucontroltype.md)                                                      |
| [**barre de menus du \_ système de rôle \_**](object-roles.md)           | [MenuBar](uiauto-supportmenubarcontroltype.md)                                                |
| [**système de rôle \_ \_ MenuItem**](object-roles.md)         | [MenuItem](uiauto-supportmenuitemcontroltype.md)                                              |
| [**\_volet système de rôle \_**](object-roles.md)                 | [Volet](uiauto-supportpanecontroltype.md)                                                      |
| [**\_PROGRESSBAR du système de rôle \_**](object-roles.md)   | [ProgressBar](uiauto-supportprogressbarcontroltype.md)                                        |
| [**RadioButton du système de rôle \_ \_**](object-roles.md)   | [RadioButton](uiauto-supportradiobuttoncontroltype.md)                                        |
| [**\_ScrollBar système de rôle \_**](object-roles.md)       | [ScrollBar](uiauto-supportscrollbarcontroltype.md)                                            |
| [**\_séparateur système de rôle \_**](object-roles.md)       | [Séparateur](uiauto-supportseparatorcontroltype.md)                                            |
| [**\_curseur système de rôle \_**](object-roles.md)             | [Curseur](uiauto-supportslidercontroltype.md)                                                  |
| [**\_SPINBUTTON du système de rôle \_**](object-roles.md)     | [Spinner](uiauto-supportspinnercontroltype.md)                                                |
| [**système de rôle \_ \_ SPLITBUTTON**](object-roles.md)   | [SplitButton](uiauto-supportsplitbuttoncontroltype.md)                                        |
| [**\_STATUSBAR du système de rôle \_**](object-roles.md)       | [StatusBar](uiauto-supportstatusbarcontroltype.md)                                            |
| [**système de rôle \_ \_ PAGETABLIST**](object-roles.md)   | [Tab](uiauto-supporttabcontroltype.md)                                                        |
| [**système de rôle \_ \_ PAGETAB**](object-roles.md)           | [TabItem](uiauto-supporttabitemcontroltype.md)                                                |
| [**\_table système des rôles \_**](object-roles.md)               | [Table](uiauto-supporttablecontroltype.md)                                                    |
| [**système de rôle \_ \_ STATICTEXT**](object-roles.md)     | [Text](uiauto-supporttextcontroltype.md)                                                      |
| [**\_indicateur de système de rôle \_**](object-roles.md)       | [Flash](uiauto-supportthumbcontroltype.md)                                                    |
| [**\_TITLEBAR système de rôle \_**](object-roles.md)         | [Spreadsheet](uiauto-supporttitlebarcontroltype.md)                                              |
| [**\_ \_ barre d’outils système de rôle**](object-roles.md)           | [Barre](uiauto-supporttoolbarcontroltype.md)                                                |
| [**\_ \_ info-bulle du système de rôle**](object-roles.md)           | [ToolTip](uiauto-supporttooltipcontroltype.md)                                                |
| [**\_structure du système de rôle \_**](object-roles.md)           | [Arbres](uiauto-supporttreecontroltype.md)                                                      |
| [**système de rôle \_ \_ OUTLINEITEM**](object-roles.md)   | [TreeItem](uiauto-supporttreeitemcontroltype.md)                                              |
| [**\_fenêtre système de rôle \_**](object-roles.md)             | [Window](uiauto-supportwindowcontroltype.md)                                                  |



 

## <a name="states-and-properties"></a>États et propriétés

Les éléments Microsoft Active Accessibility prennent en charge un ensemble commun de propriétés. Certaines propriétés, telles que accState, doivent décrire des conditions différentes, en fonction du rôle de l’élément. Les serveurs doivent implémenter toutes les méthodes de [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) qui retournent une propriété, y compris les propriétés qui ne sont pas pertinentes pour l’élément.

UI Automation définit des propriétés supplémentaires, dont certaines correspondent aux États dans Microsoft Active Accessibility. Certaines propriétés sont communes à tous les éléments, mais les autres propriétés sont spécifiques aux types de contrôle et aux modèles de contrôle. Un fournisseur UI Automation n’a pas à implémenter des propriétés non pertinentes, mais peut retourner une valeur null pour toutes les propriétés qu’il ne prend pas en charge. Le service noyau UI Automation peut obtenir des propriétés à partir du fournisseur de fenêtre par défaut, et il s’agit de fusionnées avec des propriétés implémentées explicitement par le fournisseur.

Outre la prise en charge de nombreuses autres propriétés, UI Automation permet de meilleures performances en autorisant la mise en cache des propriétés.

Le tableau suivant montre la correspondance entre certaines propriétés dans les deux modèles. Pour obtenir une description des ID de propriété UI Automation, consultez [identificateurs de propriété d’élément Automation](uiauto-automation-element-propids.md).



| Accesseur de propriété Active Accessibility                                               | ID de propriété UI Automation                                                                                                                                                                                | Remarques                                                                                                                                                                                                                                                                                                                                     |
|--------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Obtient \_ accKeyboardShortcut**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acckeyboardshortcut) | [**UIA \_ AccessKeyPropertyId**](uiauto-automation-element-propids.md) ou [ **UIA \_ AcceleratorKeyPropertyId**](uiauto-automation-element-propids.md) | [**UIA \_ AccessKeyPropertyId**](uiauto-automation-element-propids.md) est prioritaire si les deux sont présents.                                                                                                                                                                                                         |
| [**Obtient \_ accName**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname)                         | [**UIA \_ NamePropertyId**](uiauto-automation-element-propids.md)                                                                                                                      |                                                                                                                                                                                                                                                                                                                                             |
| [**Obtient \_ accRole**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole)                         | [**UIA \_ ControlTypePropertyId**](uiauto-automation-element-propids.md)                                                                                                        | Consultez le tableau précédent pour mapper des rôles à des types de contrôle.                                                                                                                                                                                                                                                                                  |
| [**Obtient \_ accValue**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accvalue)                       | [**UIA \_ ValueValuePropertyId**](uiauto-control-pattern-propids.md) ou [ **UIA \_ RangeValueValuePropertyId**](uiauto-control-pattern-propids.md)   | Valide uniquement pour les types de contrôle qui prennent en charge [**IUIAutomationValuePattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvaluepattern) ou [**IUIAutomationRangeValuePattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationrangevaluepattern). Les valeurs de plage sont normalisées à 0-100, afin d’être cohérentes avec le comportement de Microsoft Active Accessibility. Les valeurs sont représentées sous forme de chaînes. |
| [**Obtient \_ accHelp**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelp)                         | [**UIA \_ HelpTextPropertyId**](uiauto-automation-element-propids.md)                                                                                                              |                                                                                                                                                                                                                                                                                                                                             |
| [**accLocation**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation)                          | [**UIA \_ BoundingRectanglePropertyId**](uiauto-automation-element-propids.md)                                                                                            |                                                                                                                                                                                                                                                                                                                                             |
| [**Obtient \_ accDescription**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdescription)           | Non pris en charge.                                                                                                                                                                                           | accDescription n’avait pas de spécification claire dans Microsoft Active Accessibility, ce qui a permis aux serveurs de placer différentes informations dans cette propriété.                                                                                                                                                                    |
| [**Obtient \_ accHelpTopic**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelptopic)               | Non pris en charge.                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                             |



 

Le tableau suivant répertorie les ID de propriété UI Automation qui correspondent aux [constantes d’état d’objet](object-state-constants.md)de Microsoft Active Accessibility.



| État de l’Active Accessibility                                                                    | Propriété UI Automation                                                                                                                                                                                                                                                                                                                                                               | Déclenche la modification de l’état de WinEvent ? |
|-----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| [**système d’état \_ \_ vérifié**](object-state-constants.md)                 | [**UIA \_ ToggleToggleStatePropertyId**](uiauto-control-pattern-propids.md) pour la case à cocher. [**UIA \_ SelectionItemIsSelectedPropertyId**](uiauto-control-pattern-propids.md) pour case d’option.                                                                                                                   | O                               |
| [**système d’état \_ \_ réduit**](object-state-constants.md)             | [**UIA \_ ExpandCollapseExpandCollapseStatePropertyId**](uiauto-control-pattern-propids.md) (valeur = [**ExpandCollapseState \_ réduit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate)).                                                                                                                         | O                               |
| [**système d’état \_ \_ développé**](object-state-constants.md)               | [**UIA \_ ExpandCollapseExpandCollapseStatePropertyId**](uiauto-control-pattern-propids.md) (valeur = [**ExpandCollapseState \_ développée**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate) ou [**ExpandCollapseState \_ PartiallyExpanded**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate)). | O                               |
| [**système d’État pouvant être \_ \_ actif**](object-state-constants.md)             | [**UIA \_ IsKeyboardFocusablePropertyId**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                   | N                               |
| [**système d’état \_ \_ concentré**](object-state-constants.md)                 | [**UIA \_ HasKeyboardFocusPropertyId**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                         | N                               |
| [**\_HASPOPUP système d’état \_**](object-state-constants.md)               | [**UIA \_ ExpandCollapseExpandCollapseStatePropertyId**](uiauto-control-pattern-propids.md) pour les éléments de menu.                                                                                                                                                                                                                           | N                               |
| [**système d’état \_ \_ invisible**](object-state-constants.md)             | [**UIA \_ IsOffscreenPropertyId**](uiauto-automation-element-propids.md) (valeur = true et [**IUIAutomationElement :: GetClickablePoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getclickablepoint) échoue).                                                                                                                                                         | N                               |
| [**système d’état \_ \_ lié**](object-state-constants.md)                   | [**UIA \_ ControlTypePropertyId**](uiauto-automation-element-propids.md) (valeur = [**UIA \_ HyperlinkControlTypeId**](uiauto-controltype-ids.md)).                                                                                                                                                                                | N                               |
| [**système d’état \_ \_ mixte**](object-state-constants.md)                     | [**UIA \_ ToggleToggleStatePropertyId**](uiauto-control-pattern-propids.md) (valeur = [**ToggleState \_ indéterminé**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-togglestate).                                                                                                                                                                              | N                               |
| [**système d’état \_ \_ mobile**](object-state-constants.md)               | [**UIA \_ TransformCanMovePropertyId**](uiauto-control-pattern-propids.md).                                                                                                                                                                                                                                                                            | N                               |
| [**système d’état \_ \_ multisélectionnable**](object-state-constants.md) | [**UIA \_ SelectionCanSelectMultiplePropertyId**](uiauto-control-pattern-propids.md).                                                                                                                                                                                                                                                        | N                               |
| [**système d’état \_ \_ hors écran**](object-state-constants.md)             | [**UIA \_ IsOffscreenPropertyId**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                                   | N                               |
| [**système d’état \_ \_ protégé**](object-state-constants.md)             | [**UIA \_ IsPasswordPropertyId**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                                     | N                               |
| [**système d’État en \_ \_ lecture seule**](object-state-constants.md)               | [**UIA \_ RangeValueIsReadOnlyPropertyId**](uiauto-control-pattern-propids.md) et [**UIA \_ ValueIsReadOnlyPropertyId**](uiauto-control-pattern-propids.md).                                                                                                                                                         | N                               |
| [**système d’état \_ \_ sélectionnable**](object-state-constants.md)           | [**UIA \_ IsSelectionItemPatternAvailablePropertyId**](uiauto-control-pattern-availability-propids.md) .                                                                                                                                                                                                                                | N                               |
| [**système d’état \_ \_ sélectionné**](object-state-constants.md)               | [**UIA \_ SelectionItemIsSelectedPropertyId**](uiauto-control-pattern-propids.md).                                                                                                                                                                                                                                                              | N                               |
| [**système d’état \_ \_ dimensionnable**](object-state-constants.md)               | [**UIA \_ TransformCanResizePropertyId**](uiauto-control-pattern-propids.md).                                                                                                                                                                                                                                                                        | N                               |
| [**système d’état \_ \_ non disponible**](object-state-constants.md)         | [**UIA \_ IsEnabledPropertyId**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                                       | O                               |



 

Pour obtenir la liste complète des ID de propriété, consultez [identificateurs de propriété](uiauto-entry-propids.md).

## <a name="events"></a>Événements

contrairement à Microsoft Active Accessibility, le mécanisme d’événement dans UI Automation ne repose pas sur Windows le routage d’événements, qui est étroitement lié aux handles de fenêtre, et ne nécessite pas que l’application cliente configure des hooks. Les abonnements aux événements peuvent être ajustés à des parties spécifiques de l’arborescence, et pas seulement à des événements particuliers. Les fournisseurs peuvent également affiner le déclenchement des événements en assurant le suivi des événements qui sont écoutés.

Il est également plus facile pour les clients de récupérer les éléments qui déclenchent des événements, car ils sont passés directement au rappel d’événement. Les propriétés de l’élément sont automatiquement prérécupérées, si une demande de cache a été fournie lorsque le client s’est abonné à l’événement.

Le tableau suivant montre la correspondance entre les [constantes d’événement](event-constants.md) Microsoft Active Accessibility et les ID d’événement UI Automation.



| WinEvent                                                                                   | ID d’événement UI Automation                                                                                                                                                                                                                                                                                              |
|--------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**ACCELERATORCHANGE de l’objet d’événement \_ \_**](event-constants.md) | [**UIA \_**](uiauto-automation-element-propids.md) Modification de la propriété AcceleratorKeyPropertyId.                                                                                                                                                                                            |
| [**CONTENTSCROLLED de l’objet d’événement \_ \_**](event-constants.md)     | [**UIA \_**](uiauto-control-pattern-propids.md) La propriété ScrollVerticalScrollPercentPropertyId ou [**UIA \_ ScrollHorizontalScrollPercentPropertyId**](uiauto-control-pattern-propids.md) change sur les barres de défilement associées. |
| [**\_création d’objet d’événement \_**](event-constants.md)                       | [**UIA \_ StructureChangedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**DEFACTIONCHANGE de l’objet d’événement \_ \_**](event-constants.md)     | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**DESCRIPTIONCHANGE de l’objet d’événement \_ \_**](event-constants.md) | Pas d’équivalent exact ; peut-être la modification de la propriété [**UIA \_ HelpTextPropertyId**](uiauto-automation-element-propids.md) ou [**UIA \_ LocalizedControlTypePropertyId**](uiauto-automation-element-propids.md) .                                                    |
| [**destruction de l’objet d’événement \_ \_**](event-constants.md)                     | [**UIA \_ StructureChangedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**Focus de l' \_ objet événement \_**](event-constants.md)                         | [**UIA \_ AutomationFocusChangedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                   |
| [**HELPCHANGE de l’objet d’événement \_ \_**](event-constants.md)               | [**UIA \_**](uiauto-automation-element-propids.md) Modification de HelpTextPropertyId.                                                                                                                                                                                                                 |
| [**\_masquer l’objet d’événement \_**](event-constants.md)                           | [**UIA \_ StructureChangedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**LOCATIONCHANGE de l’objet d’événement \_ \_**](event-constants.md)       | [**UIA \_**](uiauto-automation-element-propids.md) Modification de la propriété BoundingRectanglePropertyId.                                                                                                                                                                                      |
| [**NameChange, de l’objet d’événement \_ \_**](event-constants.md)               | [**UIA \_**](uiauto-automation-element-propids.md) Modification de la propriété NamePropertyId.                                                                                                                                                                                                                |
| [**PARENTCHANGE de l’objet d’événement \_ \_**](event-constants.md)           | [**UIA \_ StructureChangedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**réorganisation de l’objet d’événement \_ \_**](event-constants.md)                     | N’est pas utilisé de manière cohérente dans Microsoft Active Accessibility. Aucun événement directement correspondant n’est défini dans UI Automation.                                                                                                                                                                                               |
| [**sélection de l’objet d’événement \_ \_**](event-constants.md)                 | [**UIA \_ SelectionItem \_ ElementSelectedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                    |
| [**SELECTIONADD de l’objet d’événement \_ \_**](event-constants.md)           | [**UIA \_ SelectionItem \_ ElementAddedToSelectionEventId**](uiauto-event-ids.md).                                                                                                                                                                                    |
| [**SELECTIONREMOVE de l’objet d’événement \_ \_**](event-constants.md)     | [**UIA \_ SelectionItem \_ ElementRemovedFromSelectionEventId**](uiauto-event-ids.md).                                                                                                                                                                            |
| [**SELECTIONWITHIN de l’objet d’événement \_ \_**](event-constants.md)     | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**affichage de l’objet d’événement \_ \_**](event-constants.md)                           | [**UIA \_ StructureChangedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**EVENT, \_ objet \_ STATECHANGE**](event-constants.md)             | Différents événements de modification de propriété.                                                                                                                                                                                                                                                                                    |
| [**VALUECHANGE de l’objet d’événement \_ \_**](event-constants.md)             | [**UIA \_ RangeValueValuePropertyId**](uiauto-control-pattern-propids.md) et [**UIA \_ ValueValuePropertyId**](uiauto-control-pattern-propids.md) modifiés.                                                                                                    |
| [**\_alerte du système d’événements \_**](event-constants.md)                         | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**\_CAPTUREEND du système d’événements \_**](event-constants.md)               | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**\_CAPTURESTART du système d’événements \_**](event-constants.md)           | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**\_CONTEXTHELPEND du système d’événements \_**](event-constants.md)       | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**\_CONTEXTHELPSTART du système d’événements \_**](event-constants.md)   | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**\_DIALOGEND du système d’événements \_**](event-constants.md)                 | [**UIA \_ Fenêtre \_ WindowClosedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                        |
| [**\_DIALOGSTART du système d’événements \_**](event-constants.md)             | [**UIA \_ Fenêtre \_ WindowOpenedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                        |
| [**\_DRAGDROPEND du système d’événements \_**](event-constants.md)             | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**\_DRAGDROPSTART du système d’événements \_**](event-constants.md)         | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**\_premier plan du système d’événements \_**](event-constants.md)               | [**UIA \_ AutomationFocusChangedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                   |
| [**\_MENUEND du système d’événements \_**](event-constants.md)                     | [**UIA \_ MenuModeEndEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                                         |
| [**\_MENUPOPUPEND du système d’événements \_**](event-constants.md)           | [**UIA \_ MenuClosedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                                           |
| [**\_MENUPOPUPSTART du système d’événements \_**](event-constants.md)       | [**UIA \_ MenuOpenedEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                                           |
| [**\_MENUSTART du système d’événements \_**](event-constants.md)                 | [**UIA \_ MenuModeStartEventId**](uiauto-event-ids.md).                                                                                                                                                                                                                                     |
| [**\_MINIMIZEEND du système d’événements \_**](event-constants.md)             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété WindowWindowVisualStatePropertyId.                                                                                                                                                                             |
| [**\_MINIMIZESTART du système d’événements \_**](event-constants.md)         | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété WindowWindowVisualStatePropertyId.                                                                                                                                                                             |
| [**\_MOVESIZEEND du système d’événements \_**](event-constants.md)             | [**UIA \_**](uiauto-automation-element-propids.md) Modification de la propriété BoundingRectanglePropertyId.                                                                                                                                                                                      |
| [**\_MOVESIZESTART du système d’événements \_**](event-constants.md)         | [**UIA \_**](uiauto-automation-element-propids.md) Modification de la propriété BoundingRectanglePropertyId.                                                                                                                                                                                      |
| [**\_SCROLLINGEND du système d’événements \_**](event-constants.md)           | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ScrollVerticalScrollPercentPropertyId ou [**UIA \_ ScrollHorizontalScrollPercentPropertyId**](uiauto-control-pattern-propids.md) .                               |
| [**\_SCROLLINGSTART du système d’événements \_**](event-constants.md)       | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ScrollVerticalScrollPercentPropertyId ou [**UIA \_ ScrollHorizontalScrollPercentPropertyId**](uiauto-control-pattern-propids.md) .                               |
| [**\_son du système d’événements \_**](event-constants.md)                         | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| [**\_SWITCHEND du système d’événements \_**](event-constants.md)                 | Aucun équivalent, mais un événement [**UIA \_ AutomationFocusChangedEventId**](uiauto-event-ids.md) signale qu’une nouvelle application a reçu le focus.                                                                                                                                  |
| [**\_SWITCHSTART du système d’événements \_**](event-constants.md)             | Aucun équivalent.                                                                                                                                                                                                                                                                                                      |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété MultipleViewCurrentViewPropertyId.                                                                                                                                                                             |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ScrollHorizontallyScrollablePropertyId.                                                                                                                                                                   |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ScrollVerticallyScrollablePropertyId.                                                                                                                                                                       |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ScrollHorizontalScrollPercentPropertyId.                                                                                                                                                                 |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ScrollVerticalScrollPercentPropertyId.                                                                                                                                                                     |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ScrollHorizontalViewSizePropertyId.                                                                                                                                                                           |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ScrollVerticalViewSizePropertyId.                                                                                                                                                                               |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété ToggleToggleStatePropertyId.                                                                                                                                                                                         |
| Aucun équivalent.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Modification de la propriété WindowWindowVisualStatePropertyId                                                                                                                                                                              |
| Aucun équivalent.                                                                             | [**UIA \_ Événement AsyncContentLoadedEventId**](uiauto-event-ids.md) .                                                                                                                                                                                                                     |
| Aucun équivalent.                                                                             | [**UIA \_ Événement ToolTipOpenedEventId**](uiauto-event-ids.md) .                                                                                                                                                                                                                               |



 

## <a name="accessing-active-accessibility-properties-and-objects-from-ui-automation"></a>Accès aux propriétés et objets Active Accessibility à partir d’UI Automation

L’une des fonctionnalités clés d’UI Automation qui n’est pas disponible dans Microsoft Active Accessibility est la possibilité de récupérer plusieurs propriétés avec une seule opération interprocessus.

Les clients Microsoft Active Accessibility existants peuvent tirer parti de cette capacité à l’aide de l’interface [**IUIAutomationLegacyIAccessiblePattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern) . Cette interface représente un *modèle de contrôle* qui expose les propriétés et méthodes de Microsoft Active Accessibility sur les éléments d’interface utilisateur. Lors de l’extraction d’éléments, une application peut demander que ce modèle de contrôle et ses propriétés soient mis en cache.

[**IUIAutomationLegacyIAccessiblePattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern) permet également aux clients d’obtenir des propriétés de Active Accessibility Microsoft à partir d’éléments qui n’ont pas de prise en charge native pour [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).

Les modifications apportées aux propriétés d’un [**IUIAutomationLegacyIAccessiblePattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern) ne déclenchent pas d’événements UI Automation.

## <a name="related-topics"></a>Rubriques connexes

<dl> <dt>

[Ajout de la fonctionnalité UI Automation aux serveurs Active Accessibility](uiauto-usingiaccessibleex.md)
</dt> <dt>

[Vue d’ensemble de l’arborescence UI Automation](uiauto-treeoverview.md)
</dt> <dt>

[Vue d'ensemble des propriétés UI Automation](uiauto-propertiesoverview.md)
</dt> <dt>

[Vue d'ensemble des types de contrôle UI Automation](uiauto-controltypesoverview.md)
</dt> <dt>

[Vue d'ensemble des événements UI Automation](uiauto-eventsoverview.md)
</dt> <dt>

[Microsoft Active Accessibility](microsoft-active-accessibility.md)
</dt> </dl>

 

 
