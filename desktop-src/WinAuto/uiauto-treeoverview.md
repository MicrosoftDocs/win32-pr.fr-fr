---
title: Vue d’ensemble de l’arborescence UI Automation
description: Les produits de technologie d’assistance et les scripts de test parcourent l’arborescence Microsoft UI Automation pour recueillir des informations sur l’interface utilisateur et ses éléments.
ms.assetid: f3afe258-baa7-41b5-a27e-cdc94b467d73
keywords:
- UI Automation, vue d’ensemble de l’arborescence
- UI Automation, vue de l’arborescence
- UI Automation, vue brute de l’arborescence
- UI Automation, affichage des contrôles de l’arborescence
- UI Automation, affichage du contenu de l’arborescence
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c76bc9aa6568a3f4d63194d35ff0c7d8f59510c3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103839822"
---
# <a name="ui-automation-tree-overview"></a><span data-ttu-id="1363c-108">Vue d’ensemble de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="1363c-108">UI Automation Tree Overview</span></span>

<span data-ttu-id="1363c-109">Les produits de technologie d’assistance et les scripts de test parcourent l’arborescence Microsoft UI Automation pour recueillir des informations sur l’interface utilisateur et ses éléments.</span><span class="sxs-lookup"><span data-stu-id="1363c-109">Assistive technology products and test scripts navigate the Microsoft UI Automation tree to gather information about the UI and its elements.</span></span>

<span data-ttu-id="1363c-110">L’arborescence UI Automation est un élément racine qui représente la fenêtre du bureau Windows (« le bureau ») et dont les éléments enfants représentent des fenêtres d’application.</span><span class="sxs-lookup"><span data-stu-id="1363c-110">In the UI Automation tree is a root element that represents the Windows desktop window ("the desktop") and whose child elements represent application windows.</span></span> <span data-ttu-id="1363c-111">Chacun de ces éléments enfants peut contenir des éléments qui représentent des éléments de l’interface utilisateur, tels que des menus, des boutons, des barres d’outils et des zones de liste.</span><span class="sxs-lookup"><span data-stu-id="1363c-111">Each of these child elements can contain elements that represent pieces of the UI, such as menus, buttons, toolbars, and list boxes.</span></span> <span data-ttu-id="1363c-112">Ces éléments peuvent contenir des éléments, tels que des éléments de liste.</span><span class="sxs-lookup"><span data-stu-id="1363c-112">These elements can contain elements, such as list items.</span></span>

<span data-ttu-id="1363c-113">L’arborescence UI Automation n’est pas une structure fixe.</span><span class="sxs-lookup"><span data-stu-id="1363c-113">The UI Automation tree is not a fixed structure.</span></span> <span data-ttu-id="1363c-114">Elle est rarement perçue dans son total, car elle peut contenir des milliers d’éléments.</span><span class="sxs-lookup"><span data-stu-id="1363c-114">It is seldom seen in its totality because it might contain thousands of elements.</span></span> <span data-ttu-id="1363c-115">Les parties de l’arborescence UI Automation sont générées lorsqu’un client en a besoin, et la structure de l’arborescence change à mesure que des éléments sont ajoutés, déplacés ou supprimés.</span><span class="sxs-lookup"><span data-stu-id="1363c-115">Parts of the UI Automation tree are built as a client needs them, and the structure of the tree changes as elements are added, moved, or removed.</span></span>

<span data-ttu-id="1363c-116">Les fournisseurs UI Automation prennent en charge l’arborescence UI Automation en implémentant la navigation entre les éléments d’un fragment.</span><span class="sxs-lookup"><span data-stu-id="1363c-116">UI Automation providers support the UI Automation tree by implementing navigation among items in a fragment.</span></span> <span data-ttu-id="1363c-117">Un fragment est une sous-arborescence complète d’éléments d’une infrastructure particulière et a un élément racine (appelé *racine de fragment*) qui est généralement hébergé dans une fenêtre.</span><span class="sxs-lookup"><span data-stu-id="1363c-117">A fragment is a complete subtree of elements from a particular framework, and has a root element (called the *fragment root*) that is typically hosted in a window.</span></span>

<span data-ttu-id="1363c-118">Les fournisseurs ne sont pas concernés par la navigation d’un contrôle à un autre.</span><span class="sxs-lookup"><span data-stu-id="1363c-118">Providers are not concerned with navigation from one control to another.</span></span> <span data-ttu-id="1363c-119">Cela est géré par le noyau UI Automation, qui utilise les informations des fournisseurs de fenêtres par défaut.</span><span class="sxs-lookup"><span data-stu-id="1363c-119">This is managed by the UI Automation core, which uses information from the default window providers.</span></span>

<span data-ttu-id="1363c-120">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="1363c-120">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="1363c-121">Affichages de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="1363c-121">Views of the UI Automation Tree</span></span>](#views-of-the-ui-automation-tree)
    -   [<span data-ttu-id="1363c-122">Affichage brut</span><span class="sxs-lookup"><span data-stu-id="1363c-122">Raw View</span></span>](#raw-view)
    -   [<span data-ttu-id="1363c-123">Vue de contrôle</span><span class="sxs-lookup"><span data-stu-id="1363c-123">Control View</span></span>](#control-view)
    -   [<span data-ttu-id="1363c-124">Affichage du contenu</span><span class="sxs-lookup"><span data-stu-id="1363c-124">Content View</span></span>](#content-view)
-   [<span data-ttu-id="1363c-125">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1363c-125">Related topics</span></span>](#related-topics)

## <a name="views-of-the-ui-automation-tree"></a><span data-ttu-id="1363c-126">Affichages de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="1363c-126">Views of the UI Automation Tree</span></span>

<span data-ttu-id="1363c-127">L’arborescence UI Automation peut être filtrée pour créer des affichages qui contiennent uniquement les éléments UI Automation pertinents pour un client particulier.</span><span class="sxs-lookup"><span data-stu-id="1363c-127">The UI Automation tree can be filtered to create views that contain only those UI Automation elements that are relevant for a particular client.</span></span> <span data-ttu-id="1363c-128">Cette approche permet aux clients de personnaliser la structure présentée par le biais d’UI Automation en fonction de leurs besoins spécifiques.</span><span class="sxs-lookup"><span data-stu-id="1363c-128">This approach allows clients to customize the structure that is presented through UI Automation to their particular needs.</span></span>

<span data-ttu-id="1363c-129">Le client peut personnaliser la vue en étendue et en filtrant.</span><span class="sxs-lookup"><span data-stu-id="1363c-129">The client can customize the view by scoping and by filtering.</span></span> <span data-ttu-id="1363c-130">La portée définit l’étendue de la vue, à partir d’un élément de base.</span><span class="sxs-lookup"><span data-stu-id="1363c-130">Scoping is defining the extent of the view, starting from a base element.</span></span> <span data-ttu-id="1363c-131">Par exemple, l’application peut souhaiter Rechercher uniquement les enfants directs du bureau, ou tous les descendants d’une fenêtre d’application.</span><span class="sxs-lookup"><span data-stu-id="1363c-131">For example, the application might want to find only direct children of the desktop, or all descendants of an application window.</span></span> <span data-ttu-id="1363c-132">Le filtrage définit les types d’éléments inclus dans la vue.</span><span class="sxs-lookup"><span data-stu-id="1363c-132">Filtering is defining the types of elements that are included in the view.</span></span>

<span data-ttu-id="1363c-133">Les fournisseurs UI Automation prennent en charge le filtrage en définissant des propriétés sur les éléments, y compris les propriétés [**IUIAutomationElement :: IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) et [**IUIAutomationElement :: IsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) .</span><span class="sxs-lookup"><span data-stu-id="1363c-133">UI Automation providers support filtering by defining properties on elements, including the [**IUIAutomationElement::IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) and [**IUIAutomationElement::IsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="1363c-134">UI Automation fournit trois vues par défaut : affichage brut, vue de contrôle et affichage du contenu.</span><span class="sxs-lookup"><span data-stu-id="1363c-134">UI Automation provides three default views: raw view, control view, and content view.</span></span> <span data-ttu-id="1363c-135">Ces vues sont définies par le type de filtrage effectué.</span><span class="sxs-lookup"><span data-stu-id="1363c-135">These views are defined by the type of filtering performed.</span></span> <span data-ttu-id="1363c-136">L’étendue d’une vue est définie par l’application.</span><span class="sxs-lookup"><span data-stu-id="1363c-136">The scope of any view is defined by the application.</span></span> <span data-ttu-id="1363c-137">L’application peut appliquer d’autres filtres sur les propriétés. par exemple, pour inclure uniquement des contrôles activés dans une vue de contrôle.</span><span class="sxs-lookup"><span data-stu-id="1363c-137">The application can apply other filters on properties; for example, to include only enabled controls in a control view.</span></span>

### <a name="raw-view"></a><span data-ttu-id="1363c-138">Affichage brut</span><span class="sxs-lookup"><span data-stu-id="1363c-138">Raw View</span></span>

<span data-ttu-id="1363c-139">L’affichage brut de l’arborescence UI Automation est l’arborescence complète des éléments Automation pour lesquels le bureau est la racine.</span><span class="sxs-lookup"><span data-stu-id="1363c-139">The raw view of the UI Automation tree is the full tree of automation elements for which the desktop is the root.</span></span> <span data-ttu-id="1363c-140">L’affichage brut suit étroitement la structure de programmation native d’une application et est la vue la plus détaillée disponible.</span><span class="sxs-lookup"><span data-stu-id="1363c-140">The raw view closely follows the native programmatic structure of an application, and is the most detailed view available.</span></span> <span data-ttu-id="1363c-141">C’est aussi la base sur laquelle reposent les autres affichages de l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="1363c-141">It is also the base on which the other views of the tree are built.</span></span> <span data-ttu-id="1363c-142">Étant donné que cette vue dépend de l’infrastructure d’interface utilisateur sous-jacente, l’affichage brut d’un bouton Windows Presentation Foundation (WPF) a une vue brute différente de celle d’un bouton Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="1363c-142">Because this view depends on the underlying UI framework, the raw view of a Windows Presentation Foundation (WPF) button has a different raw view than a Microsoft Win32 button.</span></span>

<span data-ttu-id="1363c-143">La vue brute est obtenue en recherchant des éléments sans spécifier de propriétés ou à l’aide de [**IUIAutomation :: RawViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker) pour obtenir une interface [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) pour naviguer dans l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="1363c-143">The raw view is obtained by searching for elements without specifying properties or by using the [**IUIAutomation::RawViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker) to get an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface for navigating the tree.</span></span>

### <a name="control-view"></a><span data-ttu-id="1363c-144">Affichage de contrôle</span><span class="sxs-lookup"><span data-stu-id="1363c-144">Control View</span></span>

<span data-ttu-id="1363c-145">L’affichage de contrôle est un sous-ensemble de l’affichage brut.</span><span class="sxs-lookup"><span data-stu-id="1363c-145">The control view is a subset of the raw view.</span></span> <span data-ttu-id="1363c-146">Il comprend uniquement les éléments d’interface utilisateur dont la propriété [**IUIAutomationElement :: IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) a la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="1363c-146">It includes only those UI items that have the [**IUIAutomationElement::IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property set to **TRUE**.</span></span>

<span data-ttu-id="1363c-147">L’affichage de contrôle comprend les éléments d’interface utilisateur qui fournissent des informations à l’utilisateur ou qui permettent à l’utilisateur d’effectuer une action.</span><span class="sxs-lookup"><span data-stu-id="1363c-147">The control view includes the UI items that provide information to the user or enable the user to perform an action.</span></span> <span data-ttu-id="1363c-148">Il s’agit des éléments d’interface utilisateur les plus intéressants pour les applications de tests automatisés.</span><span class="sxs-lookup"><span data-stu-id="1363c-148">These are the UI items that are most interesting to automated testing applications.</span></span>

<span data-ttu-id="1363c-149">L’affichage de contrôle comprend également des éléments d’interface utilisateur non interactifs qui contribuent à la structure logique de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1363c-149">The control view also includes noninteractive UI items that contribute to the logical structure of the UI.</span></span> <span data-ttu-id="1363c-150">Celles-ci incluent des conteneurs d’éléments tels que les en-têtes de vue de liste, les barres d’outils, les menus et la barre d’État.</span><span class="sxs-lookup"><span data-stu-id="1363c-150">These include item containers such as list view headers, toolbars, menus, and the status bar.</span></span> <span data-ttu-id="1363c-151">Les autres éléments non interactifs qui apparaissent dans l’affichage de contrôle sont des graphiques avec des informations et du texte statique dans une boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="1363c-151">Other noninteractive items that appear in the control view are graphics with information and static text in a dialog box.</span></span>

<span data-ttu-id="1363c-152">Les éléments non interactifs utilisés uniquement à des fins de disposition ou décoratives, tels que les panneaux utilisés pour disposer les contrôles dans une boîte de dialogue, n’apparaissent pas dans l’affichage de contrôle.</span><span class="sxs-lookup"><span data-stu-id="1363c-152">Noninteractive items used only for layout or decorative purposes, such as panels used to lay out controls in a dialog box, do not appear in the control view.</span></span>

<span data-ttu-id="1363c-153">L’affichage de contrôle de l’arborescence UI Automation correspond étroitement à la structure d’interface utilisateur perçue par un utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="1363c-153">The control view of the UI Automation tree closely maps to the UI structure perceived by an end user.</span></span> <span data-ttu-id="1363c-154">Cela permet au produit de technologie d’assistance de décrire plus facilement l’interface utilisateur à l’utilisateur final et d’aider l’utilisateur final à interagir avec l’application.</span><span class="sxs-lookup"><span data-stu-id="1363c-154">This makes it easier for the assistive technology product to describe the UI to the end user and help that end user interact with the application.</span></span>

<span data-ttu-id="1363c-155">L’affichage de contrôle est obtenu en recherchant des éléments dont la propriété [**IUIAutomationElement :: IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) a la valeur true, ou en utilisant [**ControlViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) pour obtenir une interface [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) pour naviguer dans l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="1363c-155">The control view is obtained by searching for elements that have the [**IUIAutomationElement::IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property set to true, or by using [**ControlViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) to get an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface for navigating the tree.</span></span>

### <a name="content-view"></a><span data-ttu-id="1363c-156">Affichage de contenu</span><span class="sxs-lookup"><span data-stu-id="1363c-156">Content View</span></span>

<span data-ttu-id="1363c-157">L’affichage de contenu de l’arborescence UI Automation est un sous-ensemble de l’affichage de contrôle.</span><span class="sxs-lookup"><span data-stu-id="1363c-157">The content view of the UI Automation tree is a subset of the control view.</span></span> <span data-ttu-id="1363c-158">Il comprend uniquement les éléments d’interface utilisateur dont la propriété [**IUIAutomationElement :: IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) et la propriété [**IUIAutomationElement :: IsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) ont la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="1363c-158">It includes only those UI items that have both the [**IUIAutomationElement::IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) and the [**IUIAutomationElement::IsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property set to **TRUE**.</span></span>

<span data-ttu-id="1363c-159">L’affichage de contenu contient des éléments d’interface utilisateur qui communiquent les informations réelles dans une interface utilisateur, y compris les éléments d’interface utilisateur qui peuvent recevoir le focus clavier et du texte qui n’est pas une étiquette sur un élément d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1363c-159">The content view contains UI items that convey the actual information in a user interface, including UI items that can receive keyboard focus and some text that is not a label on a UI item.</span></span> <span data-ttu-id="1363c-160">Il s’agit des éléments d’interface utilisateur les plus intéressants pour une application de lecteur d’écran.</span><span class="sxs-lookup"><span data-stu-id="1363c-160">These are the UI items that are most interesting to a screen reader application.</span></span> <span data-ttu-id="1363c-161">Par exemple, les valeurs d’une zone de liste déroulante déroulante s’affichent dans l’affichage du contenu, car les valeurs représentent les informations utilisées par un utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="1363c-161">For example, the values in a drop-down combo box appear in the content view because the values represent information being used by an end user.</span></span>

<span data-ttu-id="1363c-162">Dans l’affichage de contenu, une zone de liste déroulante et une zone de liste sont toutes deux représentées sous la forme d’un ensemble d’éléments d’interface utilisateur dans lesquels un ou plusieurs éléments peuvent être sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="1363c-162">In the content view, a combo box and a list box are both represented as a collection of UI items where one, or more than one, item can be selected.</span></span> <span data-ttu-id="1363c-163">Le fait qu’un élément soit toujours ouvert et un élément peut être développé et réduit n’est pas pertinent dans l’affichage du contenu, car il est conçu pour afficher les données, ou le contenu, qui sont présentées à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1363c-163">The fact that one item is always open and one item can expand and collapse is irrelevant in the content view because it is designed to show the data, or content, that is being presented to the user.</span></span>

<span data-ttu-id="1363c-164">L’affichage du contenu est obtenu en recherchant des éléments dont la propriété [**IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) et [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) a la valeur **true**, ou à l’aide de [**IUIAutomation :: ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) pour obtenir une interface [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) pour naviguer dans l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="1363c-164">The content view is obtained by searching for elements that have both the [**IsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) and the [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property set to **TRUE**, or by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) to get an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface for navigating the tree.</span></span>

<span data-ttu-id="1363c-165">Les images suivantes montrent les différences entre l’affichage de contrôle et l’affichage de contenu.</span><span class="sxs-lookup"><span data-stu-id="1363c-165">The following images show the differences between the control view and content view.</span></span> <span data-ttu-id="1363c-166">La première image montre une zone de liste modifiable simple avec trois éléments dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="1363c-166">The first image shows a simple combo box with three items in the dropdown list.</span></span> <span data-ttu-id="1363c-167">La deuxième image montre comment les éléments d’interface utilisateur de la zone de liste déroulante apparaissent dans les affichages de contrôle et de contenu de l’application UISpy.exe.</span><span class="sxs-lookup"><span data-stu-id="1363c-167">The second image shows how the combo box UI items appear in the control and content views of the UISpy.exe application.</span></span>

![capture d’écran d’une zone de liste modifiable simple avec trois éléments déroulants](images/combobox.png)

![capture d’écran de l’application UISpy avec affichages de contrôle et de contenu des éléments de zone de liste déroulante](images/treeviews.jpg)

## <a name="related-topics"></a><span data-ttu-id="1363c-170">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1363c-170">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="1363c-171">**Méthodologique**</span><span class="sxs-lookup"><span data-stu-id="1363c-171">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="1363c-172">Création de l’objet CUIAutomation</span><span class="sxs-lookup"><span data-stu-id="1363c-172">Creating the CUIAutomation Object</span></span>](uiauto-creatingcuiautomation.md)
</dt> <dt>

[<span data-ttu-id="1363c-173">Obtention d'éléments UI Automation</span><span class="sxs-lookup"><span data-stu-id="1363c-173">Obtaining UI Automation Elements</span></span>](uiauto-obtainingelements.md)
</dt> <dt>

[<span data-ttu-id="1363c-174">Notions de base d’UI Automation</span><span class="sxs-lookup"><span data-stu-id="1363c-174">UI Automation Fundamentals</span></span>](entry-uiautocore-overview.md)
</dt> </dl>

 

 




