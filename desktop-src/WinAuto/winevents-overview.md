---
title: Vue d’ensemble de WinEvents et Active Accessibility
description: Les serveurs Microsoft Active Accessibility déclenchent WinEvents pour notifier les clients lorsqu’un objet accessible change.
ms.assetid: a2d486ee-84ef-4c44-a832-dbc0dae81542
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b351b1ce7b6337c4ca0ac0827daff2978c6611af
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/29/2020
ms.locfileid: "103940633"
---
# <a name="winevents-and-active-accessibility"></a><span data-ttu-id="0e3a3-103">WinEvents et Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="0e3a3-103">WinEvents and Active Accessibility</span></span>

<span data-ttu-id="0e3a3-104">Les serveurs Microsoft Active Accessibility déclenchent *winEvents* pour notifier les clients lorsqu’un objet accessible change.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-104">Microsoft Active Accessibility servers raise *WinEvents* to notify clients when an accessible object changes.</span></span> <span data-ttu-id="0e3a3-105">Dans de nombreuses conditions, un serveur avertit un client qu’une modification a été apportée.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-105">There are numerous conditions in which a server notifies a client of a change.</span></span> <span data-ttu-id="0e3a3-106">Chaque [constante d’événement](event-constants.md) définie par Microsoft Active Accessibility décrit une condition relative à la notification d’un client.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-106">Each [event constant](event-constants.md) defined by Microsoft Active Accessibility describes a condition about which a client is notified.</span></span> <span data-ttu-id="0e3a3-107">Par exemple, WinEvents peut signaler :</span><span class="sxs-lookup"><span data-stu-id="0e3a3-107">For example, WinEvents can signal:</span></span>

- <span data-ttu-id="0e3a3-108">Lorsqu’un objet est créé ou détruit.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-108">When an object is created or destroyed.</span></span>
- <span data-ttu-id="0e3a3-109">Lorsqu’un objet reçoit ou perd le focus.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-109">When an object receives or loses focus.</span></span>
- <span data-ttu-id="0e3a3-110">Lorsque l’État ou l’emplacement d’un objet change.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-110">When the state or location of an object changes.</span></span>
- <span data-ttu-id="0e3a3-111">Lorsqu’une propriété d’un objet change.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-111">When any property of an object changes.</span></span>

<span data-ttu-id="0e3a3-112">Les applications clientes ne reçoivent pas automatiquement les notifications d’événements ; ils doivent spécifier les événements qu’ils souhaitent recevoir en appelant la fonction [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) .</span><span class="sxs-lookup"><span data-stu-id="0e3a3-112">Client applications do not receive event notifications automatically; they must specify which events they want to receive by calling the [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) function.</span></span> <span data-ttu-id="0e3a3-113">Avec **SetWinEventHook**, un client s’inscrit pour recevoir un ou plusieurs événements et définit une fonction de raccordement pour gérer les événements spécifiés.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-113">With **SetWinEventHook**, a client registers to receive one or more events and sets a hook function to handle the specified events.</span></span> <span data-ttu-id="0e3a3-114">Les clients peuvent utiliser la même fonction de raccordement pour gérer plusieurs types d’événements, ou il peut utiliser des fonctions de raccordement multipe.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-114">Clients can use the same hook function to handle multiple types of events, or it can use multipe hook functions.</span></span> <span data-ttu-id="0e3a3-115">Les clients appellent le **SetWinEventHook** une fois pour chaque fonction de raccordement qu’il doit inscrire.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-115">Clients call the **SetWinEventHook** once for each hook function it needs to register.</span></span>

<span data-ttu-id="0e3a3-116">Les fonctions de raccordement sont situées dans le corps du code du client, dans une DLL mappée au processus du client ou dans une DLL mappée dans le processus du serveur.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-116">Hook functions are located within the client's code body, in a DLL mapped into the client's process, or in a DLL mapped into the server's process.</span></span> <span data-ttu-id="0e3a3-117">Chacune de ces méthodes présente des avantages et des inconvénients.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-117">Each of these methods has advantages and disadvantages.</span></span> <span data-ttu-id="0e3a3-118">Pour plus d’informations, consultez [fonctions de raccordement in-context et hors contexte](in-context-and-out-of-context-hook-functions.md).</span><span class="sxs-lookup"><span data-stu-id="0e3a3-118">For more information, see [In-Context and Out-of-Context Hook Functions](in-context-and-out-of-context-hook-functions.md).</span></span>

<span data-ttu-id="0e3a3-119">Pour informer les clients d’une occurrence d’événement, les serveurs appellent [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span><span class="sxs-lookup"><span data-stu-id="0e3a3-119">To notify clients of an event occurrence, servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span></span> <span data-ttu-id="0e3a3-120">Le système vérifie si des applications clientes ont des fonctions de raccordement définies pour l’événement et appelle les fonctions de raccordement appropriées si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-120">The system checks whether any client applications have set hook functions for the event and calls the appropriate hook functions as necessary.</span></span>

<span data-ttu-id="0e3a3-121">Quand la fonction de raccordement du client est appelée, elle reçoit un certain nombre de paramètres qui décrivent l’événement et l’objet qui a généré l’événement.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-121">When the client's hook function is called, it receives a number of parameters that describe the event and the object that generated the event.</span></span> <span data-ttu-id="0e3a3-122">Pour accéder à l’objet qui a généré l’événement, la fonction de raccordement client appelle [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span><span class="sxs-lookup"><span data-stu-id="0e3a3-122">To gain access to the object that generated the event, the client hook function calls [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span></span>

> [!NOTE]
> <span data-ttu-id="0e3a3-123">Si aucun client n’est inscrit pour la réception de WinEvents, l’impact sur les performances sur un serveur pour appeler [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) est négligeable.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-123">If no clients have registered to receive WinEvents, the performance impact on a server for calling [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) is negligible.</span></span>
>
> <span data-ttu-id="0e3a3-124">Les serveurs appellent [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) pour les modifications uniquement dans leurs propres objets accessibles. ils n’appellent pas **NotifyWinEvent** pour les modifications apportées aux éléments d’interface utilisateur fournis par le système.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-124">Servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) for changes only in their own accessible objects; they do not call **NotifyWinEvent** for changes in system-provided user interface elements.</span></span>

## <a name="event-driven-communication"></a><span data-ttu-id="0e3a3-125">Communication Event-Driven</span><span class="sxs-lookup"><span data-stu-id="0e3a3-125">Event-Driven Communication</span></span>

<span data-ttu-id="0e3a3-126">Les clients doivent inscrire un hook WinEvent avant de pouvoir recevoir des notifications WinEvent.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-126">Clients must register a WinEvent hook before they can receive WinEvent notifications.</span></span> <span data-ttu-id="0e3a3-127">Pour éviter les rappels inutiles et améliorer les performances, il est conseillé aux clients de s’inscrire uniquement pour les événements qu’ils doivent recevoir.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-127">To avoid unnecessary callbacks and improve performance, clients are advised to register only for the events they need to receive.</span></span>

<span data-ttu-id="0e3a3-128">À l’intérieur de la procédure de Hook, le client peut appeler [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) pour récupérer un objet [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) pour l’élément auquel l’événement s’applique.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-128">Inside the hook procedure, the client can call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) to retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object for the element to which the event applies.</span></span> <span data-ttu-id="0e3a3-129">Avec cet objet, le client peut commencer à appeler des méthodes **IAccessible** pour récupérer des informations ou interagir avec l’élément d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0e3a3-129">With this object, the client can begin calling **IAccessible** methods to retrieve information or interact with the UI element.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0e3a3-130">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="0e3a3-130">Related topics</span></span>

[<span data-ttu-id="0e3a3-131">WinEvents</span><span class="sxs-lookup"><span data-stu-id="0e3a3-131">WinEvents</span></span>](winevents-infrastructure.md)
