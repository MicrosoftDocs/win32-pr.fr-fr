---
title: Modèle de contrôle ExpandCollapse
description: Fournit des instructions et des conventions pour l’implémentation de IExpandCollapseProvider, y compris des informations sur les propriétés, les méthodes et les événements.
ms.assetid: 0ffc26c3-8696-44f9-b463-902a69e06d21
keywords:
- UI Automation, implémentation du modèle de contrôle ExpandCollapse
- UI Automation, modèle de contrôle ExpandCollapse
- UI Automation, IExpandCollapseProvider
- IExpandCollapseProvider
- implémentation des modèles de contrôle ExpandCollapse d’UI Automation
- Modèles de contrôle ExpandCollapse
- modèles de contrôle, IExpandCollapseProvider
- modèles de contrôle, implémenter des ExpandCollapse UI Automation
- modèles de contrôle, ExpandCollapse
- interfaces, IExpandCollapseProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45bd28ddcc201dcff0a4811a1eb8e04670f93091
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104028974"
---
# <a name="expandcollapse-control-pattern"></a><span data-ttu-id="77548-113">Modèle de contrôle ExpandCollapse</span><span class="sxs-lookup"><span data-stu-id="77548-113">ExpandCollapse Control Pattern</span></span>

<span data-ttu-id="77548-114">Fournit des instructions et des conventions pour l’implémentation de [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider), y compris des informations sur les propriétés, les méthodes et les événements.</span><span class="sxs-lookup"><span data-stu-id="77548-114">Describes guidelines and conventions for implementing [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider), including information about properties, methods, and events.</span></span> <span data-ttu-id="77548-115">Le modèle de contrôle **ExpandCollapse** est utilisé pour prendre en charge les contrôles qui se développent visuellement pour afficher davantage de contenu et réduire pour masquer le contenu.</span><span class="sxs-lookup"><span data-stu-id="77548-115">The **ExpandCollapse** control pattern is used to support controls that visually expand to display more content and collapse to hide content.</span></span>

<span data-ttu-id="77548-116">Pour obtenir des exemples de contrôles qui implémentent ce modèle de contrôle, consultez [types de contrôle et leurs modèles de contrôle pris en charge](uiauto-controlpatternmapping.md).</span><span class="sxs-lookup"><span data-stu-id="77548-116">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

<span data-ttu-id="77548-117">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="77548-117">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="77548-118">Conventions et directives d'implémentation</span><span class="sxs-lookup"><span data-stu-id="77548-118">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="77548-119">Membres requis pour **IExpandCollapseProvider**</span><span class="sxs-lookup"><span data-stu-id="77548-119">Required Members for **IExpandCollapseProvider**</span></span>](#required-members-for-iexpandcollapseprovider)
-   [<span data-ttu-id="77548-120">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="77548-120">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="77548-121">Conventions et directives d'implémentation</span><span class="sxs-lookup"><span data-stu-id="77548-121">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="77548-122">Lorsque vous implémentez le modèle de contrôle **ExpandCollapse** , notez les conventions et recommandations suivantes :</span><span class="sxs-lookup"><span data-stu-id="77548-122">When implementing the **ExpandCollapse** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="77548-123">Les contrôles d’agrégat, générés avec des objets enfants qui fournissent l’interface utilisateur avec des fonctionnalités de développement/réduction, doivent prendre en charge le modèle de contrôle **ExpandCollapse** , contrairement à leurs éléments enfants.</span><span class="sxs-lookup"><span data-stu-id="77548-123">Aggregate controls, built with child objects that provide the UI with expand/collapse functionality, must support the **ExpandCollapse** control pattern whereas their child elements do not.</span></span> <span data-ttu-id="77548-124">Par exemple, un contrôle de zone de liste déroulante est généré avec une combinaison de contrôles de zone de liste, de bouton et d’édition, mais seule la zone de liste déroulante parente doit prendre en charge le modèle de contrôle **ExpandCollapse** .</span><span class="sxs-lookup"><span data-stu-id="77548-124">For example, a combo box control is built with a combination of list box, button, and edit controls, but it is only the parent combo box that must support the **ExpandCollapse** control pattern.</span></span>
    > [!Note]  
    > <span data-ttu-id="77548-125">Une exception est le contrôle Menu, qui est un agrégat d’objets d’élément de menu individuels.</span><span class="sxs-lookup"><span data-stu-id="77548-125">An exception is the menu control, which is an aggregate of individual menu item objects.</span></span> <span data-ttu-id="77548-126">Les objets d’élément de menu peuvent prendre en charge le modèle de contrôle **ExpandCollapse** , mais le contrôle menu parent ne le peut pas.</span><span class="sxs-lookup"><span data-stu-id="77548-126">The menu item objects can support the **ExpandCollapse** control pattern, but the parent menu control cannot.</span></span> <span data-ttu-id="77548-127">Une exception similaire s’applique aux contrôles d’arborescence et d’élément d’arborescence.</span><span class="sxs-lookup"><span data-stu-id="77548-127">A similar exception applies to the tree and tree item controls.</span></span>

     

-   <span data-ttu-id="77548-128">Lorsque [**IExpandCollapseProvider :: ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) d’un contrôle a la valeur **ExpandCollapseState \_ leafnode**, toute fonctionnalité **ExpandCollapse** est actuellement inactive pour le contrôle et la seule information qui peut être obtenue à l’aide de ce modèle de contrôle est la **ExpandCollapseState**.</span><span class="sxs-lookup"><span data-stu-id="77548-128">When the [**IExpandCollapseProvider::ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) of a control is set to **ExpandCollapseState\_LeafNode**, any **ExpandCollapse** functionality is currently inactive for the control and the only information that can be obtained using this control pattern is the **ExpandCollapseState**.</span></span> <span data-ttu-id="77548-129">Si des objets enfants sont ajoutés par la suite, les modifications apportées à **ExpandCollapseState** et à la fonctionnalité **ExpandCollapse** sont activées.</span><span class="sxs-lookup"><span data-stu-id="77548-129">If any child objects are subsequently added, the **ExpandCollapseState** changes and **ExpandCollapse** functionality is activated.</span></span>
-   <span data-ttu-id="77548-130">[**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) fait référence uniquement à la visibilité des objets enfants immédiats ; elle ne fait pas référence à la visibilité de tous les objets descendants.</span><span class="sxs-lookup"><span data-stu-id="77548-130">[**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) refers to the visibility of immediate child objects only; it does not refer to the visibility of all descendant objects.</span></span>
-   <span data-ttu-id="77548-131">Les fonctionnalités [**IExpandCollapseProvider :: Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) et [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) sont spécifiques au contrôle.</span><span class="sxs-lookup"><span data-stu-id="77548-131">[**IExpandCollapseProvider::Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) and [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) functionality is control-specific.</span></span> <span data-ttu-id="77548-132">Voici des exemples de ce comportement.</span><span class="sxs-lookup"><span data-stu-id="77548-132">The following are examples of this behavior.</span></span>
    -   <span data-ttu-id="77548-133">Le menu personnel d’Office peut être un élément de menu à trois États (« développé », « réduit » et « PartiallyExpanded ») où le contrôle spécifie l’État à adopter quand l’option [**développer**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) ou [**réduire**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) est appelée.</span><span class="sxs-lookup"><span data-stu-id="77548-133">The Office Personal Menu can be a three-state menu item ("Expanded", "Collapsed" and "PartiallyExpanded") where the control specifies the state to adopt when [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) or [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) is called.</span></span>
    -   <span data-ttu-id="77548-134">L’appel de [**expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) sur un élément d’arborescence peut afficher tous les descendants ou seulement les enfants immédiats.</span><span class="sxs-lookup"><span data-stu-id="77548-134">Calling [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) on a tree item may display all descendants or only immediate children.</span></span>
    -   <span data-ttu-id="77548-135">Si l’appel de [**expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) ou [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) sur un contrôle conserve l’état de ses descendants, un événement de modification de visibilité doit être envoyé, et non un événement de changement d’État.</span><span class="sxs-lookup"><span data-stu-id="77548-135">If calling [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) or [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) on a control maintains the state of its descendants, a visibility change event should be sent, not a state change event.</span></span> <span data-ttu-id="77548-136">Si le contrôle parent ne conserve pas l’état de ses descendants lorsqu’il est réduit, le contrôle peut détruire tous les descendants qui ne sont plus visibles et déclencher un événement détruit ; elle peut également modifier les [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) pour chaque descendant et déclencher un événement de modification de visibilité.</span><span class="sxs-lookup"><span data-stu-id="77548-136">If the parent control does not maintain the state of its descendants when collapsed, the control may destroy all the descendants that are no longer visible and raise a destroyed event; or it may change the [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) for each descendant and raise a visibility change event.</span></span>
-   <span data-ttu-id="77548-137">Pour garantir la navigation, il est souhaitable qu’un objet se trouve dans l’arborescence Microsoft UI Automation (avec un état de visibilité approprié), quel que soit le [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate)de ses parents.</span><span class="sxs-lookup"><span data-stu-id="77548-137">To guarantee navigation, it is desirable for an object to be in the Microsoft UI Automation tree (with appropriate visibility state) regardless of its parents [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate).</span></span> <span data-ttu-id="77548-138">Si des descendants sont générés à la demande, ils peuvent uniquement apparaître dans l’arborescence UI Automation après avoir été affichés pour la première fois ou uniquement lorsqu’ils sont visibles.</span><span class="sxs-lookup"><span data-stu-id="77548-138">If descendants are generated on demand, they may only appear in the UI Automation tree after being displayed for the first time or only while they are visible.</span></span>

## <a name="required-members-for-iexpandcollapseprovider"></a><span data-ttu-id="77548-139">Membres requis pour **IExpandCollapseProvider**</span><span class="sxs-lookup"><span data-stu-id="77548-139">Required Members for **IExpandCollapseProvider**</span></span>

<span data-ttu-id="77548-140">Les propriétés, méthodes et événements suivants sont requis pour implémenter l’interface [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) .</span><span class="sxs-lookup"><span data-stu-id="77548-140">The following properties, methods, and events are required for implementing the [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) interface.</span></span>



| <span data-ttu-id="77548-141">Membres nécessaires</span><span class="sxs-lookup"><span data-stu-id="77548-141">Required members</span></span>                                                                                    | <span data-ttu-id="77548-142">Type de membre</span><span class="sxs-lookup"><span data-stu-id="77548-142">Member type</span></span> | <span data-ttu-id="77548-143">Notes</span><span class="sxs-lookup"><span data-stu-id="77548-143">Notes</span></span>                                                                  |
|-----------------------------------------------------------------------------------------------------|-------------|------------------------------------------------------------------------|
| [<span data-ttu-id="77548-144">**ExpandCollapseState**</span><span class="sxs-lookup"><span data-stu-id="77548-144">**ExpandCollapseState**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate)                   | <span data-ttu-id="77548-145">Propriété</span><span class="sxs-lookup"><span data-stu-id="77548-145">Property</span></span>    | <span data-ttu-id="77548-146">Aucun</span><span class="sxs-lookup"><span data-stu-id="77548-146">None</span></span>                                                                   |
| [<span data-ttu-id="77548-147">**Développez**</span><span class="sxs-lookup"><span data-stu-id="77548-147">**Expand**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand)                                             | <span data-ttu-id="77548-148">Méthode</span><span class="sxs-lookup"><span data-stu-id="77548-148">Method</span></span>      | <span data-ttu-id="77548-149">Aucun</span><span class="sxs-lookup"><span data-stu-id="77548-149">None</span></span>                                                                   |
| [<span data-ttu-id="77548-150">**Réduire**</span><span class="sxs-lookup"><span data-stu-id="77548-150">**Collapse**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse)                                         | <span data-ttu-id="77548-151">Méthode</span><span class="sxs-lookup"><span data-stu-id="77548-151">Method</span></span>      | <span data-ttu-id="77548-152">Aucun</span><span class="sxs-lookup"><span data-stu-id="77548-152">None</span></span>                                                                   |
| [<span data-ttu-id="77548-153">**IUIAutomationPropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="77548-153">**IUIAutomationPropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationpropertychangedeventhandler) | <span data-ttu-id="77548-154">Événement</span><span class="sxs-lookup"><span data-stu-id="77548-154">Event</span></span>       | <span data-ttu-id="77548-155">Ce contrôle n’a pas d’événements associés ; Utilisez ce gestionnaire d’événements générique.</span><span class="sxs-lookup"><span data-stu-id="77548-155">This control has no associated events; use this generic event handler.</span></span> |



 

## <a name="related-topics"></a><span data-ttu-id="77548-156">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="77548-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="77548-157">Types de contrôle et leurs modèles de contrôle pris en charge</span><span class="sxs-lookup"><span data-stu-id="77548-157">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="77548-158">Vue d'ensemble des modèles de contrôle UI Automation</span><span class="sxs-lookup"><span data-stu-id="77548-158">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="77548-159">Vue d’ensemble de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="77548-159">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 




