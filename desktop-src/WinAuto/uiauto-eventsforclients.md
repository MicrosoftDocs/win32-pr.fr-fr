---
title: Abonnement à des événements UI Automation
description: Microsoft UI Automation permet aux clients de s’abonner à des événements intéressants. Cette fonctionnalité améliore les performances en éliminant la nécessité d’interroger continuellement les éléments de l’interface utilisateur du système pour voir si des informations, une structure ou un État ont été modifiés.
ms.assetid: 7019ecb8-6123-4e00-926c-6725d7e71385
keywords:
- clients, événements UI Automation
- clients, événements pour UI Automation
- UI Automation, événements pour les clients
- UI Automation, événements clients
- UI Automation, abonnement à des événements
- UI Automation, méthodes d’abonnement
- UI Automation, exemples de code
- UI Automation, exemples
- UI Automation, exemples
- s'abonner à des événements UI Automation
- événements, abonnement UI Automation
- Exemples
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d9a89df1b9d2afc401e07b6cd77d1307d912f11
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104310221"
---
# <a name="subscribing-to-ui-automation-events"></a><span data-ttu-id="1a9de-116">Abonnement à des événements UI Automation</span><span class="sxs-lookup"><span data-stu-id="1a9de-116">Subscribing to UI Automation Events</span></span>

<span data-ttu-id="1a9de-117">Microsoft UI Automation permet aux clients de s’abonner à des événements intéressants.</span><span class="sxs-lookup"><span data-stu-id="1a9de-117">Microsoft UI Automation allows clients to subscribe to events of interest.</span></span> <span data-ttu-id="1a9de-118">Cette fonctionnalité améliore les performances en éliminant la nécessité d’interroger continuellement les éléments de l’interface utilisateur du système pour voir si des informations, une structure ou un État ont été modifiés.</span><span class="sxs-lookup"><span data-stu-id="1a9de-118">This capability improves performance by eliminating the need to continually poll the UI elements in the system to see if any information, structure, or state has changed.</span></span>

<span data-ttu-id="1a9de-119">L’efficacité est également améliorée par la possibilité d’écouter des événements uniquement dans une portée définie.</span><span class="sxs-lookup"><span data-stu-id="1a9de-119">Efficiency is also improved by the ability to listen for events only within a defined scope.</span></span> <span data-ttu-id="1a9de-120">Par exemple, un client peut écouter les modifications de sélection d’un élément dans une liste, dans la liste elle-même ou dans une boîte de dialogue entière.</span><span class="sxs-lookup"><span data-stu-id="1a9de-120">For example, a client can listen for selection changes on an item in a list, on the list itself, or on an entire dialog box.</span></span>

> [!Note]  
> <span data-ttu-id="1a9de-121">Ne partez pas du principe que tous les événements possibles sont déclenchés par un fournisseur UI Automation.</span><span class="sxs-lookup"><span data-stu-id="1a9de-121">Do not assume that all possible events are raised by a UI Automation provider.</span></span> <span data-ttu-id="1a9de-122">Par exemple, toutes les modifications de propriété n’entraînent pas le déclenchement d’événements par les fournisseurs de proxy standard pour Windows Forms et les contrôles Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="1a9de-122">For example, not all property changes cause events to be raised by the standard proxy providers for Windows Forms and Microsoft Win32 controls.</span></span>

 

<span data-ttu-id="1a9de-123">Pour obtenir une vue plus large des événements UI Automation, consultez [UI Automation Events Overview](uiauto-eventsoverview.md).</span><span class="sxs-lookup"><span data-stu-id="1a9de-123">For a broader view of UI Automation events, see [UI Automation Events Overview](uiauto-eventsoverview.md).</span></span>

> [!Note]  
> <span data-ttu-id="1a9de-124">Avant d’implémenter un gestionnaire d’événements, vous devez vous familiariser avec les problèmes de Threading décrits dans la rubrique [compréhension des problèmes de Threading](uiauto-threading.md).</span><span class="sxs-lookup"><span data-stu-id="1a9de-124">Before implementing an event handler, you should be familiar with the threading issues described in [Understanding Threading Issues](uiauto-threading.md).</span></span>

 

<span data-ttu-id="1a9de-125">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="1a9de-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="1a9de-126">Inscription des gestionnaires d’événements</span><span class="sxs-lookup"><span data-stu-id="1a9de-126">Registering Event Handlers</span></span>](#registering-event-handlers)
-   [<span data-ttu-id="1a9de-127">Exemples</span><span class="sxs-lookup"><span data-stu-id="1a9de-127">Examples</span></span>](#examples)
-   [<span data-ttu-id="1a9de-128">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1a9de-128">Related topics</span></span>](#related-topics)

## <a name="registering-event-handlers"></a><span data-ttu-id="1a9de-129">Inscription des gestionnaires d’événements</span><span class="sxs-lookup"><span data-stu-id="1a9de-129">Registering Event Handlers</span></span>

<span data-ttu-id="1a9de-130">Les applications clientes s’abonnent à des événements d’un genre particulier en inscrivant un gestionnaire d’événements, à l’aide de l’une des méthodes [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) suivantes.</span><span class="sxs-lookup"><span data-stu-id="1a9de-130">Client applications subscribe to events of a particular kind by registering an event handler, using one of the following [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) methods.</span></span>



| <span data-ttu-id="1a9de-131">Méthode d’abonnement</span><span class="sxs-lookup"><span data-stu-id="1a9de-131">Subscription Method</span></span>                                                                                                                                                                                                | <span data-ttu-id="1a9de-132">Type d'événement</span><span class="sxs-lookup"><span data-stu-id="1a9de-132">Event Type</span></span>       | <span data-ttu-id="1a9de-133">Interface de rappel</span><span class="sxs-lookup"><span data-stu-id="1a9de-133">Callback Interface</span></span>                                                                                    |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|-------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="1a9de-134">**AddFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-134">**AddFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler)                                                                                                                            | <span data-ttu-id="1a9de-135">Modification du focus</span><span class="sxs-lookup"><span data-stu-id="1a9de-135">Focus change</span></span>     | [<span data-ttu-id="1a9de-136">**IUIAutomationFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-136">**IUIAutomationFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler)         |
| <span data-ttu-id="1a9de-137">[**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler), [ **AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray)</span><span class="sxs-lookup"><span data-stu-id="1a9de-137">[**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler), [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray)</span></span> | <span data-ttu-id="1a9de-138">Modification de propriété</span><span class="sxs-lookup"><span data-stu-id="1a9de-138">Property change</span></span>  | [<span data-ttu-id="1a9de-139">**IUIAutomationPropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-139">**IUIAutomationPropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationpropertychangedeventhandler)   |
| [<span data-ttu-id="1a9de-140">**AddStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-140">**AddStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler)                                                                                                                    | <span data-ttu-id="1a9de-141">Modification de la structure</span><span class="sxs-lookup"><span data-stu-id="1a9de-141">Structure change</span></span> | [<span data-ttu-id="1a9de-142">**IUIAutomationStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-142">**IUIAutomationStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationstructurechangedeventhandler) |
| [<span data-ttu-id="1a9de-143">**AddNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-143">**AddNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler)                                                                                                                           | <span data-ttu-id="1a9de-144">Notification</span><span class="sxs-lookup"><span data-stu-id="1a9de-144">Notification</span></span>     | [<span data-ttu-id="1a9de-145">**IUIAutomationNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-145">**IUIAutomationNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationnotificationeventhandler)         |
| [<span data-ttu-id="1a9de-146">**AddAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-146">**AddAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler)                                                                                                                                | <span data-ttu-id="1a9de-147">Autres événements</span><span class="sxs-lookup"><span data-stu-id="1a9de-147">Other events</span></span>     | [<span data-ttu-id="1a9de-148">**IUIAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-148">**IUIAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationeventhandler)                                 |



 

<span data-ttu-id="1a9de-149">Lorsqu’un client ajoute un gestionnaire d’événements pour tous les descendants ([**TreeScope \_ descendants**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)), UI Automation ajoute un seul gestionnaire pour la racine de la sous-arborescence, et le gestionnaire écoute tous les descendants.</span><span class="sxs-lookup"><span data-stu-id="1a9de-149">When a client adds an event handler for all descendants ([**TreeScope\_Descendants**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)), UI Automation adds only one handler for the root of sub-tree, and the handler listens across all descendents.</span></span> <span data-ttu-id="1a9de-150">UI Automation n’ajoute pas de gestionnaires d’événements de manière récursive.</span><span class="sxs-lookup"><span data-stu-id="1a9de-150">UI Automation does not add event handlers recursively.</span></span>

<span data-ttu-id="1a9de-151">Lorsqu’un client appelle la méthode [**IUIAutomation :: RemoveAllEventHandlers**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers) , UI Automation supprime tous les gestionnaires d’événements du processus client.</span><span class="sxs-lookup"><span data-stu-id="1a9de-151">When a client calls the [**IUIAutomation::RemoveAllEventHandlers**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers) method, UI Automation removes all event handlers from the client process.</span></span>

<span data-ttu-id="1a9de-152">Pour recevoir et gérer des événements, vous implémentez un objet de gestion d’événements qui expose une interface de rappel, et vous devez inscrire l’objet en appelant une méthode d’inscription d’événement telle que [**IUIAutomation :: AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1a9de-152">To receive and handle events, you implement an event-handling object that exposes a callback interface, and you must register the object by calling an event registration method such as [**IUIAutomation::AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler).</span></span> <span data-ttu-id="1a9de-153">L’interface de rappel a une seule méthode ; UI Automation appelle cette méthode lorsque l’événement est traité.</span><span class="sxs-lookup"><span data-stu-id="1a9de-153">The callback interface has a single method; UI Automation calls this method when the event is processed.</span></span>

<span data-ttu-id="1a9de-154">Lors de l’arrêt, ou lorsque les événements UI Automation ne sont plus intéressants pour l’application, les clients UI Automation doivent appeler une ou plusieurs des méthodes [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) suivantes.</span><span class="sxs-lookup"><span data-stu-id="1a9de-154">On shutdown, or when UI Automation events are no longer of interest to the application, UI Automation clients should call one or more of the following [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) methods.</span></span>

> [!Note]  
> <span data-ttu-id="1a9de-155">Un client UI Automation ne doit pas utiliser plusieurs threads pour ajouter ou supprimer des gestionnaires d’événements.</span><span class="sxs-lookup"><span data-stu-id="1a9de-155">A UI Automation client should not use multiple threads to add or remove event handlers.</span></span> <span data-ttu-id="1a9de-156">Un comportement inattendu peut se produire si un gestionnaire d’événements est ajouté ou supprimé alors qu’un autre est ajouté ou supprimé dans le même processus client.</span><span class="sxs-lookup"><span data-stu-id="1a9de-156">Unexpected behavior can result if one event handler is being added or removed while another is being added or removed in the same client process.</span></span>

 



| <span data-ttu-id="1a9de-157">Méthode</span><span class="sxs-lookup"><span data-stu-id="1a9de-157">Method</span></span>                                                                                                | <span data-ttu-id="1a9de-158">Description</span><span class="sxs-lookup"><span data-stu-id="1a9de-158">Description</span></span>                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="1a9de-159">**RemoveAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-159">**RemoveAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removeautomationeventhandler)             | <span data-ttu-id="1a9de-160">Annule l’inscription d’un gestionnaire d’événements qui a été inscrit à l’aide de [**AddAutomationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1a9de-160">Unregisters an event handler that was registered by using [**AddAutomationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler).</span></span>                                                                                                                                  |
| [<span data-ttu-id="1a9de-161">**RemoveFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-161">**RemoveFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removefocuschangedeventhandler)         | <span data-ttu-id="1a9de-162">Annule l’inscription d’un gestionnaire d’événements qui a été inscrit à l’aide de [**AddFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1a9de-162">Unregisters an event handler that was registered by using [**AddFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler).</span></span>                                                                                                                              |
| [<span data-ttu-id="1a9de-163">**RemovePropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-163">**RemovePropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removepropertychangedeventhandler)   | <span data-ttu-id="1a9de-164">Annule l’inscription d’un gestionnaire d’événements qui a été inscrit à l’aide de [**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler) ou [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray).</span><span class="sxs-lookup"><span data-stu-id="1a9de-164">Unregisters an event handler that was registered by using [**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler) or [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray).</span></span> |
| [<span data-ttu-id="1a9de-165">**RemoveStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-165">**RemoveStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removestructurechangedeventhandler) | <span data-ttu-id="1a9de-166">Annule l’inscription d’un gestionnaire d’événements qui a été inscrit à l’aide de [**AddStructureChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1a9de-166">Unregisters an event handler that was registered by using [**AddStructureChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler).</span></span>                                                                                                                      |
| [<span data-ttu-id="1a9de-167">**RemoveNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1a9de-167">**RemoveNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-removenotificationeventhandler)        | <span data-ttu-id="1a9de-168">Annule l’inscription d’un gestionnaire d’événements qui Weas inscrit à l’aide de [**AddNotificationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1a9de-168">Unregisters an event handler that weas registered by using [**AddNotificationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler).</span></span>                                                                                                                            |
| [<span data-ttu-id="1a9de-169">**RemoveAllEventHandlers**</span><span class="sxs-lookup"><span data-stu-id="1a9de-169">**RemoveAllEventHandlers**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers)                         | <span data-ttu-id="1a9de-170">Annule l’inscription de tous les gestionnaires d’événements inscrits.</span><span class="sxs-lookup"><span data-stu-id="1a9de-170">Unregisters all registered event handlers.</span></span>                                                                                                                                                                                                                                      |



 

<span data-ttu-id="1a9de-171">Il est possible qu’un événement soit remis à un gestionnaire d’événements après l’annulation de l’abonnement au gestionnaire, si l’événement est reçu simultanément avec la demande d’annulation de l’abonnement à l’événement.</span><span class="sxs-lookup"><span data-stu-id="1a9de-171">It is possible for an event to be delivered to an event handler after the handler has been unsubscribed, if the event is received simultaneously with the request to unsubscribe the event.</span></span> <span data-ttu-id="1a9de-172">La meilleure pratique consiste à suivre la norme COM (Component Object Model) et à éviter de détruire l’objet de gestionnaire d’événements jusqu’à ce que son décompte de références ait atteint zéro.</span><span class="sxs-lookup"><span data-stu-id="1a9de-172">The best practice is to follow the Component Object Model (COM) standard and avoid destroying the event handler object until its reference count has reached zero.</span></span> <span data-ttu-id="1a9de-173">La destruction d’un gestionnaire d’événements immédiatement après l’annulation de l’abonnement à des événements peut entraîner une violation d’accès si un événement est remis en retard.</span><span class="sxs-lookup"><span data-stu-id="1a9de-173">Destroying an event handler immediately after unsubscribing for events may result in an access violation if an event is delivered late.</span></span>

## <a name="examples"></a><span data-ttu-id="1a9de-174">Exemples</span><span class="sxs-lookup"><span data-stu-id="1a9de-174">Examples</span></span>

<span data-ttu-id="1a9de-175">Pour obtenir des exemples de code qui montrent comment gérer des événements UI Automation, consultez [comment implémenter des gestionnaires d’événements](uiauto-howto-implement-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="1a9de-175">For code examples that show how to handle UI Automation events, see [How to Implement Event Handlers](uiauto-howto-implement-event-handlers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1a9de-176">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="1a9de-176">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="1a9de-177">**Méthodologique**</span><span class="sxs-lookup"><span data-stu-id="1a9de-177">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="1a9de-178">Vue d'ensemble des événements UI Automation</span><span class="sxs-lookup"><span data-stu-id="1a9de-178">UI Automation Events Overview</span></span>](uiauto-eventsoverview.md)
</dt> <dt>

[<span data-ttu-id="1a9de-179">Compréhension des problèmes liés aux threads</span><span class="sxs-lookup"><span data-stu-id="1a9de-179">Understanding Threading Issues</span></span>](uiauto-threading.md)
</dt> </dl>

 

 




