---
title: Utiliser QueryService pour récupérer une interface native pour un objet IAccessible
description: Les développeurs de serveurs peuvent utiliser cette technique pour exposer un pointeur vers un nœud de document personnalisé pour un objet IAccessible. Cela suppose que vous exposez déjà des objets IAccessible. Cette technique permet aux clients d’obtenir un objet personnalisé à partir d’un objet IAccessible.
ms.assetid: aaa0e840-f8c2-4f3d-9d97-1910f00c1041
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 29d971462154eb12789a74e8cc6edb5aed68c84b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031536"
---
# <a name="use-queryservice-to-retrieve-a-native-interface-for-an-iaccessible-object"></a><span data-ttu-id="4284d-105">Utiliser QueryService pour récupérer une interface native pour un objet IAccessible</span><span class="sxs-lookup"><span data-stu-id="4284d-105">Use QueryService to retrieve a native interface for an IAccessible object</span></span>

<span data-ttu-id="4284d-106">Les développeurs de serveurs peuvent utiliser cette technique pour exposer un pointeur vers un nœud de document personnalisé pour un objet [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="4284d-106">Server developers can use this technique to expose a pointer to a custom document node for an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object.</span></span> <span data-ttu-id="4284d-107">Cela suppose que vous exposez déjà des objets **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="4284d-107">This assumes that you already expose **IAccessible** objects.</span></span> <span data-ttu-id="4284d-108">Cette technique permet aux clients d’obtenir un objet personnalisé à partir d’un objet **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="4284d-108">This technique allows clients to get a custom object from an **IAccessible** object.</span></span>

<span data-ttu-id="4284d-109">**Pour exposer un modèle objet natif pour un IAccessible (serveurs)**</span><span class="sxs-lookup"><span data-stu-id="4284d-109">**To expose a native object model for an IAccessible (servers)**</span></span>

1.  <span data-ttu-id="4284d-110">Ajoutez la prise en charge de l’interface **IServiceProvider** sur votre objet [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="4284d-110">Add support for the **IServiceProvider** interface on your [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object.</span></span>
2.  <span data-ttu-id="4284d-111">Définissez un GUID qui représente les fonctionnalités d’obtention de l’interface personnalisée à partir d’un objet [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="4284d-111">Define a GUID that represents the functionality of obtaining the custom interface from an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) objects.</span></span> <span data-ttu-id="4284d-112">C’est ce que l’on appelle un ID de service.</span><span class="sxs-lookup"><span data-stu-id="4284d-112">This is called a service ID.</span></span> <span data-ttu-id="4284d-113">Vous pouvez utiliser GUIDGEN.EXE pour générer un ID de service, ou réutiliser l’ID d’interface si vous disposez d’une interface personnalisée.</span><span class="sxs-lookup"><span data-stu-id="4284d-113">You can use GUIDGEN.EXE to generate a service ID, or reuse the interface ID if you have a custom interface.</span></span>
3.  <span data-ttu-id="4284d-114">Implémentez la méthode **IServiceProvider :: QueryService** afin qu’elle retourne un pointeur vers l’interface personnalisée quand elle est appelée avec l’ID de service défini précédemment dans cette procédure.</span><span class="sxs-lookup"><span data-stu-id="4284d-114">Implement the **IServiceProvider::QueryService** method so that it returns a pointer to the custom interface when called with the service ID defined earlier in this procedure.</span></span> <span data-ttu-id="4284d-115">**QueryService** doit retourner la **valeur null** pour toutes les autres valeurs d’ID de service.</span><span class="sxs-lookup"><span data-stu-id="4284d-115">**QueryService** should return **NULL** for all other service ID values.</span></span>
4.  <span data-ttu-id="4284d-116">Publiez l’ID de service afin que les clients puissent l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="4284d-116">Publish the service ID so that clients can use it.</span></span>

<span data-ttu-id="4284d-117">Les clients peuvent utiliser cette fonctionnalité pour obtenir un pointeur vers l’objet personnalisé à partir d’un objet [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="4284d-117">Clients can use this functionality to obtain a pointer to the custom object from an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object.</span></span>

<span data-ttu-id="4284d-118">**Pour obtenir un pointeur vers un objet personnalisé à partir d’un IAccessible (clients)**</span><span class="sxs-lookup"><span data-stu-id="4284d-118">**To obtain a pointer to a custom object from an IAccessible (clients)**</span></span>

1.  <span data-ttu-id="4284d-119">Appelez [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q))(IID \_ IServiceProvider) sur un pointeur d’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) pour obtenir un pointeur d’interface **IServiceProvider** .</span><span class="sxs-lookup"><span data-stu-id="4284d-119">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q))(IID\_IServiceProvider) on an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to obtain an **IServiceProvider** interface pointer.</span></span>
2.  <span data-ttu-id="4284d-120">Appelez **IServiceProvider :: QueryService** avec l’ID de service publié pour obtenir un pointeur vers l’objet personnalisé pour [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).</span><span class="sxs-lookup"><span data-stu-id="4284d-120">Call **IServiceProvider::QueryService** with the published service ID to obtain a pointer to the custom object for the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).</span></span>
3.  <span data-ttu-id="4284d-121">Libérez l’interface **IServiceProvider** si elle n’est plus nécessaire.</span><span class="sxs-lookup"><span data-stu-id="4284d-121">Release the **IServiceProvider** interface if it is no longer needed.</span></span>

<span data-ttu-id="4284d-122">Pour être utilisables dans plusieurs processus, les serveurs devront peut-être inscrire l’interface retournée avec le modèle COM (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="4284d-122">To be usable across processes, servers might need to register the returned interface with Component Object Model (COM).</span></span>

<span data-ttu-id="4284d-123">Cette technique est utilisée par Microsoft Internet Explorer 4,0 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="4284d-123">This technique is used by Microsoft Internet Explorer 4.0 and later.</span></span> <span data-ttu-id="4284d-124">Elle permet aux clients d’obtenir un pointeur d’interface **IHTMLElement2** qui correspond à un objet [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="4284d-124">It allows clients to obtain an **IHTMLElement2** interface pointer that corresponds to an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object.</span></span>

 

 