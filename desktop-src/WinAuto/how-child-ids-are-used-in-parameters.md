---
title: Utilisation des ID enfants dans les paramètres
description: Cette rubrique décrit les paramètres d’entrée, les paramètres de sortie et les cas spéciaux d’interprétation des ID enfants retournés par les méthodes IAccessible.
ms.assetid: 051ec5ba-540c-4ae1-b917-4c229557ca2f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c03026e6abf769efab95cc513231fad3af64511f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104382203"
---
# <a name="how-child-ids-are-used-in-parameters"></a><span data-ttu-id="6c94f-103">Utilisation des ID enfants dans les paramètres</span><span class="sxs-lookup"><span data-stu-id="6c94f-103">How Child IDs Are Used in Parameters</span></span>

<span data-ttu-id="6c94f-104">Cette rubrique décrit les paramètres d’entrée, les paramètres de sortie et les cas spéciaux d’interprétation des ID enfants retournés par les méthodes [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="6c94f-104">This topic describes input parameters, output parameters, and special cases for interpreting child IDs returned from [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) methods.</span></span>

## <a name="input-parameters"></a><span data-ttu-id="6c94f-105">Paramètres d’entrée</span><span class="sxs-lookup"><span data-stu-id="6c94f-105">Input Parameters</span></span>

<span data-ttu-id="6c94f-106">La plupart des fonctions de Active Accessibility de Microsoft et la plupart des propriétés [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) prennent une structure de [**variante**](/windows/win32/api/oaidl/ns-oaidl-variant) comme paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="6c94f-106">Many of the Microsoft Active Accessibility functions and most of the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties take a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) structure as an input parameter.</span></span> <span data-ttu-id="6c94f-107">Pour la plupart des propriétés **IAccessible** , ce paramètre permet aux développeurs clients de spécifier s’ils souhaitent des informations sur l’objet lui-même ou sur l’un des éléments simples de l’objet.</span><span class="sxs-lookup"><span data-stu-id="6c94f-107">For most of the **IAccessible** properties, this parameter allows client developers to specify whether they want information about the object itself or about one of the object's simple elements.</span></span>

<span data-ttu-id="6c94f-108">Microsoft Active Accessibility fournit la constante **CHILDID \_ Self** pour indiquer que des informations sont nécessaires sur l’objet lui-même.</span><span class="sxs-lookup"><span data-stu-id="6c94f-108">Microsoft Active Accessibility provides the constant **CHILDID\_SELF** to indicate that information is needed about the object itself.</span></span> <span data-ttu-id="6c94f-109">Pour obtenir des informations sur un élément simple, les développeurs clients spécifient son ID enfant dans le paramètre [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .</span><span class="sxs-lookup"><span data-stu-id="6c94f-109">To obtain information about a simple element, client developers specify its child ID in the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter.</span></span>

<span data-ttu-id="6c94f-110">Lors de l’initialisation d’un paramètre [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) , veillez à spécifier **VT \_ I4** dans le membre **VT** en plus de spécifier la valeur de l’ID enfant (ou **CHILDID \_ Self**) dans le membre **lVal** .</span><span class="sxs-lookup"><span data-stu-id="6c94f-110">When initializing a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter, be sure to specify **VT\_I4** in the **vt** member in addition to specifying the child ID value (or **CHILDID\_SELF**) in the **lVal** member.</span></span>

<span data-ttu-id="6c94f-111">Par exemple, pour obtenir le nom d’un objet, et non l’un des éléments enfants de l’objet, initialisez le [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) pour le premier paramètre de [**IAccessible :: obtenir \_ accName**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname) ( **CHILDID \_ Self** dans le membre **lVal** et **VT \_ I4** dans le membre **VT** ), puis appelez **IAccessible :: obtenir \_ accName**.</span><span class="sxs-lookup"><span data-stu-id="6c94f-111">For example, to get the name of an object, and not one of the object's child elements, initialize the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) for the first parameter of [**IAccessible::get\_accName**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname) ( **CHILDID\_SELF** in the **lVal** member and **VT\_I4** in the **vt** member), and then call **IAccessible::get\_accName**.</span></span>

## <a name="output-parameters"></a><span data-ttu-id="6c94f-112">Paramètres de sortie</span><span class="sxs-lookup"><span data-stu-id="6c94f-112">Output Parameters</span></span>

<span data-ttu-id="6c94f-113">Plusieurs fonctions et méthodes [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) ont un [](/windows/win32/api/oaidl/ns-oaidl-variant) \* paramètre de sortie variant qui contient un ID enfant ou un pointeur d’interface [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) vers un objet enfant.</span><span class="sxs-lookup"><span data-stu-id="6c94f-113">Several [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) functions and methods have a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant)\* output parameter that contains a child ID or an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer to a child object.</span></span> <span data-ttu-id="6c94f-114">Un client doit suivre différentes étapes, selon qu’il reçoit un ID enfant **VT \_ I4** (élément simple) ou un pointeur d’interface **IDispatch** avec **CHILDID \_ Self** (objet complet).</span><span class="sxs-lookup"><span data-stu-id="6c94f-114">There are different steps that a client must take depending on whether they receive a **VT\_I4** child ID (simple element) or an **IDispatch** interface pointer with **CHILDID\_SELF** (full object).</span></span> <span data-ttu-id="6c94f-115">Les étapes suivantes fournissent un pointeur d’interface **IAccessible** et un ID enfant qui, ensemble, permettent aux clients d’utiliser les méthodes et propriétés **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="6c94f-115">Following these steps will provide an **IAccessible** interface pointer and child ID that together allow clients to use the **IAccessible** methods and properties.</span></span> <span data-ttu-id="6c94f-116">Ces étapes s’appliquent aux méthodes [**IAccessible :: accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest), [**\_ accFocus**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus)et [**\_ accSelection**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection) .</span><span class="sxs-lookup"><span data-stu-id="6c94f-116">These steps apply to the [**IAccessible::accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest), [**get\_accFocus**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus), and [**get\_accSelection**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection) methods.</span></span> <span data-ttu-id="6c94f-117">Elles s’appliquent également aux fonctions du client [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)et [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) .</span><span class="sxs-lookup"><span data-stu-id="6c94f-117">They also apply to the [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) client functions.</span></span>

<span data-ttu-id="6c94f-118">Le tableau suivant répertorie les résultats possibles retournés et les étapes de retraitement requises pour que les clients aient un pointeur d’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) et un ID enfant.</span><span class="sxs-lookup"><span data-stu-id="6c94f-118">The following table lists the possible result returned and the required post-processing steps so that clients will have an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer and child ID.</span></span>



| <span data-ttu-id="6c94f-119">Résultat retourné</span><span class="sxs-lookup"><span data-stu-id="6c94f-119">Result returned</span></span>                                      | <span data-ttu-id="6c94f-120">Après le traitement de la valeur de retour</span><span class="sxs-lookup"><span data-stu-id="6c94f-120">Post-processing for the return value</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6c94f-121">Pointeur d’interface [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch)</span><span class="sxs-lookup"><span data-stu-id="6c94f-121">[**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer</span></span> | <span data-ttu-id="6c94f-122">Il s’agit d’un objet complet. Appelez [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) pour accéder au pointeur d’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="6c94f-122">This is a full object.Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to access the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer.</span></span><br/> <span data-ttu-id="6c94f-123">Utilisez le pointeur d’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) avec **CHILDID \_ Self** pour accéder aux méthodes et propriétés **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="6c94f-123">Use the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer with **CHILDID\_SELF** to access **IAccessible** methods and properties.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="6c94f-124">\_ID enfant VT I4</span><span class="sxs-lookup"><span data-stu-id="6c94f-124">VT\_I4 child ID</span></span>                                      | <span data-ttu-id="6c94f-125">Appelez [**IAccessible :: obtenir \_ accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) à l’aide de l’ID enfant pour déterminer si vous disposez d’un pointeur d’interface [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) . Si vous recevez un pointeur d’interface [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) , utilisez-le avec **CHILDID \_ Self** pour accéder aux méthodes et propriétés de l’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="6c94f-125">Call [**IAccessible::get\_accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) using the child ID to see if you have an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer.If you get an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer, use it with **CHILDID\_SELF** to access [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface methods and properties.</span></span><br/> <span data-ttu-id="6c94f-126">Si l’appel à la méthode [**obtenir \_ accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) échoue, vous avez un élément simple.</span><span class="sxs-lookup"><span data-stu-id="6c94f-126">If the call to [**get\_accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) fails, you have a simple element.</span></span> <span data-ttu-id="6c94f-127">Utilisez le pointeur d’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) d’origine (celui que vous avez utilisé dans votre appel à la méthode ou la fonction mentionnée ci-dessus) avec l’ID de l’enfant **VT \_ I4** renvoyé par l’appel.</span><span class="sxs-lookup"><span data-stu-id="6c94f-127">Use the original [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer (the one you used in your call to the method or function mentioned above) with the **VT\_I4** child ID that the call returned.</span></span><br/> |



 

<span data-ttu-id="6c94f-128">Avant de pouvoir utiliser un paramètre [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) , vous devez l’initialiser en appelant la fonction com (Component Object Model) [**VariantInit**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit) .</span><span class="sxs-lookup"><span data-stu-id="6c94f-128">Before you can use a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter, you must initialize it by calling the [**VariantInit**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit) Component Object Model (COM) function.</span></span> <span data-ttu-id="6c94f-129">Lorsque vous avez terminé avec la structure, appelez [**VariantClear**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear) pour libérer la mémoire réservée pour cette **variante**.</span><span class="sxs-lookup"><span data-stu-id="6c94f-129">When finished with the structure, call [**VariantClear**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear) to free the memory reserved for that **VARIANT**.</span></span>

## <a name="special-cases"></a><span data-ttu-id="6c94f-130">Cas particuliers</span><span class="sxs-lookup"><span data-stu-id="6c94f-130">Special Cases</span></span>

<span data-ttu-id="6c94f-131">Il existe des exceptions aux instructions dans le tableau ci-dessus, par exemple lorsqu’un ID enfant est retourné par la méthode [**IAccessible :: accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest) .</span><span class="sxs-lookup"><span data-stu-id="6c94f-131">There are exceptions to the guidelines in the above table, such as when a child ID is returned by the [**IAccessible::accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest) method.</span></span> <span data-ttu-id="6c94f-132">Les serveurs doivent retourner une interface [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) si l’enfant est un objet accessible.</span><span class="sxs-lookup"><span data-stu-id="6c94f-132">Servers must return an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface if the child is an accessible object.</span></span> <span data-ttu-id="6c94f-133">Si un ID enfant est retourné par **IAccessible :: accHitTest**, l’enfant est un élément simple.</span><span class="sxs-lookup"><span data-stu-id="6c94f-133">If a child ID is returned by **IAccessible::accHitTest**, the child is a simple element.</span></span>

<span data-ttu-id="6c94f-134">En outre, il existe des cas spéciaux pour [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate).</span><span class="sxs-lookup"><span data-stu-id="6c94f-134">In addition, there are special cases for [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate).</span></span> <span data-ttu-id="6c94f-135">Pour plus d’informations, consultez **IAccessible :: accNavigate** et [navigation spatiale et logique](spatial-and-logical-navigation.md).</span><span class="sxs-lookup"><span data-stu-id="6c94f-135">For more information, see **IAccessible::accNavigate** and [Spatial and Logical Navigation](spatial-and-logical-navigation.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="6c94f-136">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="6c94f-136">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="6c94f-137">**Méthodologique**</span><span class="sxs-lookup"><span data-stu-id="6c94f-137">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="6c94f-138">Interface IDispatch</span><span class="sxs-lookup"><span data-stu-id="6c94f-138">IDispatch Interface</span></span>](idispatch-interface.md)
</dt> <dt>

[<span data-ttu-id="6c94f-139">Structure de variante</span><span class="sxs-lookup"><span data-stu-id="6c94f-139">VARIANT Structure</span></span>](variant-structure.md)
</dt> </dl>

 

