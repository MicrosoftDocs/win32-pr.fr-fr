---
title: Proxys IAccessible
description: Les proxys IAccessible fournissent des informations d’accessibilité par défaut pour les éléments d’interface utilisateur standard, les menus utilisateur et les contrôles communs de COMCTL et COMCTL32.
ms.assetid: 236c2064-de44-4021-8825-f1519312dbfc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53dcb4cae8980e4003d9915c6783e4ddb043a8c8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315677"
---
# <a name="iaccessible-proxies"></a><span data-ttu-id="18bc8-103">Proxys IAccessible</span><span class="sxs-lookup"><span data-stu-id="18bc8-103">IAccessible Proxies</span></span>

<span data-ttu-id="18bc8-104">Les proxys [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) fournissent des informations d’accessibilité par défaut pour les éléments d’interface utilisateur standard : les contrôles utilisateur, les menus utilisateur et les contrôles communs de COMCTL et Comctl32.</span><span class="sxs-lookup"><span data-stu-id="18bc8-104">[**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) proxies provide default accessibility information for standard UI elements: USER controls, USER menus, and common controls from COMCTL and COMCTL32.</span></span> <span data-ttu-id="18bc8-105">Cette prise en charge par défaut est exposée par le biais d’objets **IAccessible** créés par Oleacc.dll et fournit la prise en charge de Microsoft Active Accessibility sans travail supplémentaire de développement serveur.</span><span class="sxs-lookup"><span data-stu-id="18bc8-105">This default support is exposed through **IAccessible** objects created by Oleacc.dll and delivers Microsoft Active Accessibility support without additional server development work.</span></span> <span data-ttu-id="18bc8-106">Le serveur peut ensuite utiliser l' [API d’annotation dynamique](dynamic-annotation-api.md) pour modifier la plupart des informations exposées par Oleacc.dll, mais il n’a pas de contrôle total.</span><span class="sxs-lookup"><span data-stu-id="18bc8-106">The server can then use the [Dynamic Annotation API](dynamic-annotation-api.md) to modify much of the information exposed by Oleacc.dll, but it does not have complete control.</span></span>

## <a name="creating-a-proxy"></a><span data-ttu-id="18bc8-107">Création d’un proxy</span><span class="sxs-lookup"><span data-stu-id="18bc8-107">Creating a Proxy</span></span>

<span data-ttu-id="18bc8-108">Pour déterminer si un élément d’interface utilisateur prend en charge l’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) en mode natif, Oleacc.dll lui envoie un message [**WM \_**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="18bc8-108">To determine whether a UI element natively supports the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface, Oleacc.dll sends it a [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="18bc8-109">Une valeur de retour différente de zéro signifie que l’élément prend en charge en mode natif Microsoft Active Accessibility et fournit sa propre prise en charge de **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="18bc8-109">A nonzero return value means the element natively supports Microsoft Active Accessibility and provides its own **IAccessible** support.</span></span> <span data-ttu-id="18bc8-110">Toutefois, si la valeur de retour est égale à zéro, Oleacc.dll fournit un objet proxy pour l’élément d’interface utilisateur et tente de retourner des informations significatives en son nom.</span><span class="sxs-lookup"><span data-stu-id="18bc8-110">However, if the return value is zero, Oleacc.dll provides a proxy object for the UI element and attempts to return meaningful information on its behalf.</span></span> <span data-ttu-id="18bc8-111">Pour plus d’informations sur **WM \_ GetObject**, consultez fonctionnement de l’utilisation de [la fonction \_ GetObject](how-wm-getobject-works.md).</span><span class="sxs-lookup"><span data-stu-id="18bc8-111">For more information about **WM\_GETOBJECT**, see [How WM\_GETOBJECT Works](how-wm-getobject-works.md).</span></span>

## <a name="what-information-is-exposed"></a><span data-ttu-id="18bc8-112">Informations exposées</span><span class="sxs-lookup"><span data-stu-id="18bc8-112">What Information Is Exposed</span></span>

<span data-ttu-id="18bc8-113">Oleacc.dll utilise le nom de classe Windows de l’élément d’interface utilisateur pour déterminer les informations qui doivent être exposées pour chacune de ses propriétés [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) et Comment collecter ces informations.</span><span class="sxs-lookup"><span data-stu-id="18bc8-113">Oleacc.dll uses the UI element's Windows class name to determine what information should be exposed for each of its [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties and how to collect that information.</span></span> <span data-ttu-id="18bc8-114">Par exemple, Oleacc.dll appelle la fonction [**GetWindowText**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) pour récupérer la propriété [**Name**](name-property.md) d’un bouton de commande standard, mais appelle cette même fonction pour récupérer la propriété [**value**](value-property.md) d’un contrôle d’édition standard.</span><span class="sxs-lookup"><span data-stu-id="18bc8-114">For example, Oleacc.dll calls the [**GetWindowText**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) function to retrieve the [**Name**](name-property.md) property for a standard push button, but calls this same function to retrieve the [**Value**](value-property.md) property for a standard edit control.</span></span> <span data-ttu-id="18bc8-115">En effet, Oleacc.dll mappe chaque méthode **IAccessible** à un appel de fonction ou de message spécifique à Microsoft Win32 ou spécifique au contrôle.</span><span class="sxs-lookup"><span data-stu-id="18bc8-115">In effect, Oleacc.dll is mapping each **IAccessible** method to an appropriate Microsoft Win32 or control-specific message or function call.</span></span> <span data-ttu-id="18bc8-116">En utilisant cette casse spéciale basée sur le nom de la classe, il peut retourner des informations significatives via les proxys **IAccessible** sans la prise en charge de Microsoft Active Accessibility sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="18bc8-116">By using this class name-based special casing, it can return meaningful information through **IAccessible** proxies without any Microsoft Active Accessibility support in the server.</span></span>

<span data-ttu-id="18bc8-117">Les applications générées avec des éléments d’interface utilisateur standard bénéficient en général de la prise en charge complète de Microsoft Active Accessibility sans travail supplémentaire de développement.</span><span class="sxs-lookup"><span data-stu-id="18bc8-117">Applications built with standard UI elements typically get full Microsoft Active Accessibility support without additional development work.</span></span> <span data-ttu-id="18bc8-118">Les exceptions à cette règle sont des contrôles qui ont été sous-classés, qui ne stockent pas leurs propres chaînes (absence du style **HASSTRINGS** ) ou qui sont owner-drawn.</span><span class="sxs-lookup"><span data-stu-id="18bc8-118">The exceptions to this rule are controls that have been subclassed, that do not store their own strings (absence of the **HASSTRINGS** style), or that are owner-drawn.</span></span> <span data-ttu-id="18bc8-119">Dans ces cas, Oleacc.dll ne peut pas collecter les informations dont il a besoin car les informations sont stockées en dehors du contrôle.</span><span class="sxs-lookup"><span data-stu-id="18bc8-119">In these cases, Oleacc.dll cannot gather the information it needs because the information is stored outside the control.</span></span> <span data-ttu-id="18bc8-120">Toutefois, dans la plupart de ces scénarios, les solutions de contournement établies ou l’utilisation de l’annotation dynamique permettent au serveur de coopérer avec les proxies fournis par Oleacc.dll.</span><span class="sxs-lookup"><span data-stu-id="18bc8-120">However in many of these scenarios, established workarounds, or the use of Dynamic Annotation, allow the server to cooperate with the proxies provided by Oleacc.dll.</span></span>

## <a name="generic-proxy-objects"></a><span data-ttu-id="18bc8-121">Objets proxy génériques</span><span class="sxs-lookup"><span data-stu-id="18bc8-121">Generic Proxy Objects</span></span>

<span data-ttu-id="18bc8-122">Si Oleacc.dll ne reconnaît pas le nom de classe de l’élément d’interface utilisateur, il crée un proxy générique qui expose le plus d’informations possible.</span><span class="sxs-lookup"><span data-stu-id="18bc8-122">If Oleacc.dll does not recognize the class name of the UI element, it creates a generic proxy that exposes as much information as possible.</span></span> <span data-ttu-id="18bc8-123">Au plus, cela comprend le rectangle englobant de l’objet, l’objet parent, le nom (de [**WM \_ GETTEXT**](/windows/desktop/winmsg/wm-gettext)) et tous les enfants de la hiérarchie de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="18bc8-123">At most, this includes the object's bounding rectangle, parent object, name (from [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext)), and any children in the window hierarchy.</span></span>

 

 