---
title: Utilisation d’éléments virtualisés
description: Cette rubrique explique comment utiliser les fonctionnalités fournies par les modèles de contrôle ItemContainer et VirtualizedItem pour rechercher et récupérer des informations sur les éléments virtualisés.
ms.assetid: e1898ba0-5ffa-4c61-b378-c7ef7c4a2c52
keywords:
- clients, éléments virtualisés UI Automation
- clients, éléments virtualisés
- clients, modèles de contrôle
- clients, modèles de contrôle VirtualizedItem
- clients, modèles de contrôle ItemContainer
- clients, modèles de contrôle VirtualizedItem UI Automation
- clients, modèles de contrôle UI Automation
- clients, modèles de contrôle ItemContainer UI Automation
- UI Automation, éléments virtualisés
- UI Automation, modèles de contrôle
- UI Automation, modèles de contrôle VirtualizedItem
- UI Automation, modèles de contrôle ItemContainer
- Modèles de contrôle VirtualizedItem
- Modèles de contrôle ItemContainer
- modèles de contrôle, VirtualizedItem
- modèles de contrôle, ItemContainer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb29232b06304079ad5b9dfdfb589ad510a5b51f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104310742"
---
# <a name="working-with-virtualized-items"></a><span data-ttu-id="0dfa7-119">Utilisation d’éléments virtualisés</span><span class="sxs-lookup"><span data-stu-id="0dfa7-119">Working with Virtualized Items</span></span>

<span data-ttu-id="0dfa7-120">Cette rubrique explique comment utiliser les fonctionnalités fournies par les modèles de contrôle [ItemContainer](uiauto-implementingitemcontainer.md) et [VirtualizedItem](uiauto-implementingvirtualizeditem.md) pour rechercher et récupérer des informations sur les éléments virtualisés.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-120">This topic describes how to use functionality provided by the [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control patterns to find and retrieve information about virtualized items.</span></span>

-   [<span data-ttu-id="0dfa7-121">Vue d’ensemble de la virtualisation</span><span class="sxs-lookup"><span data-stu-id="0dfa7-121">Overview of Virtualization</span></span>](#overview-of-virtualization)
-   [<span data-ttu-id="0dfa7-122">Comment un contrôle prend en charge la virtualisation</span><span class="sxs-lookup"><span data-stu-id="0dfa7-122">How a Control Supports Virtualization</span></span>](#how-a-control-supports-virtualization)
-   [<span data-ttu-id="0dfa7-123">Comment les clients recherchent et réalisent des éléments virtualisés</span><span class="sxs-lookup"><span data-stu-id="0dfa7-123">How Clients Find and Realize Virtualized Items</span></span>](#how-clients-find-and-realize-virtualized-items)
-   [<span data-ttu-id="0dfa7-124">Exemple</span><span class="sxs-lookup"><span data-stu-id="0dfa7-124">Example</span></span>](#example)
-   [<span data-ttu-id="0dfa7-125">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="0dfa7-125">Related topics</span></span>](#related-topics)

## <a name="overview-of-virtualization"></a><span data-ttu-id="0dfa7-126">Vue d’ensemble de la virtualisation</span><span class="sxs-lookup"><span data-stu-id="0dfa7-126">Overview of Virtualization</span></span>

<span data-ttu-id="0dfa7-127">Les contrôles qui contiennent un grand nombre d’éléments enfants peuvent utiliser la virtualisation pour gérer efficacement les éléments.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-127">Controls that contain a large number of child items can use virtualization to efficiently manage the items.</span></span> <span data-ttu-id="0dfa7-128">Avec la virtualisation, le contrôle conserve les informations complètes en mémoire pour un sous-ensemble d’éléments à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-128">With virtualization, the control maintains full information in memory for only a subset of items at any given time.</span></span> <span data-ttu-id="0dfa7-129">En règle générale, le sous-ensemble comprend uniquement les éléments qui sont actuellement visibles pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-129">Typically, the subset includes only those items that are currently visible to the user.</span></span> <span data-ttu-id="0dfa7-130">Les informations complètes sur les autres éléments virtualisés sont conservées dans le stockage et sont chargées en mémoire, ou réalisées, car le contrôle en a besoin, par exemple, lorsque de nouveaux éléments sont visibles par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-130">Full information about the remaining virtualized items is kept in storage and is loaded into memory, or realized, as the control needs it, for example, as new items become visible to the user.</span></span>

<span data-ttu-id="0dfa7-131">Les contrôles qui utilisent la virtualisation représentent un défi, car seuls les éléments réalisés sont entièrement disponibles sous forme d’éléments Microsoft UI Automation dans l’arborescence UI Automation.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-131">Controls that use virtualization represent a challenge because only realized items are fully available as Microsoft UI Automation elements in the UI Automation tree.</span></span> <span data-ttu-id="0dfa7-132">Les éléments virtualisés n’existent pas dans l’arborescence, donc les informations les concernant ne sont pas disponibles pour les clients.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-132">Virtualized items do not exist in the tree, so information about them is not available to clients.</span></span> <span data-ttu-id="0dfa7-133">Pour récupérer des informations sur les éléments virtualisés, les clients ont besoin d’un moyen de forcer l’automatisation de l’interface utilisateur à transmettre la demande pour réaliser les éléments du contrôle.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-133">To retrieve information about virtualized items, clients need a way to force UI Automation to pass the request to realize the items to the control.</span></span> <span data-ttu-id="0dfa7-134">Une fois les éléments réalisés, UI Automation peut créer des éléments UI Automation pour eux.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-134">After the items have been realized, UI Automation can create UI Automation elements for them.</span></span> <span data-ttu-id="0dfa7-135">UI Automation comprend deux modèles de contrôle pour permettre aux clients de travailler avec des éléments virtualisés : [ItemContainer](uiauto-implementingitemcontainer.md) et [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span><span class="sxs-lookup"><span data-stu-id="0dfa7-135">UI Automation includes two control patterns to enable clients to work with virtualized items: [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span></span>

## <a name="how-a-control-supports-virtualization"></a><span data-ttu-id="0dfa7-136">Comment un contrôle prend en charge la virtualisation</span><span class="sxs-lookup"><span data-stu-id="0dfa7-136">How a Control Supports Virtualization</span></span>

<span data-ttu-id="0dfa7-137">Tout contrôle pouvant contenir des éléments virtualisés doit prendre en charge le modèle de contrôle [ItemContainer](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="0dfa7-137">Any control that can contain virtualized items must support the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="0dfa7-138">En outre, tout élément qui peut être virtualisé doit prendre en charge le modèle de contrôle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="0dfa7-138">Further, any item that can be virtualized must support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="0dfa7-139">Les fonctionnalités exposées par les modèles de contrôle ItemContainer et VirtualizedItem sont accessibles aux clients via les interfaces [**IUIAutomationItemContainerPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) et [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .</span><span class="sxs-lookup"><span data-stu-id="0dfa7-139">The functionality that is exposed by the ItemContainer and VirtualizedItem control patterns is accessible to clients through the [**IUIAutomationItemContainerPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) and [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interfaces.</span></span>

## <a name="how-clients-find-and-realize-virtualized-items"></a><span data-ttu-id="0dfa7-140">Comment les clients recherchent et réalisent des éléments virtualisés</span><span class="sxs-lookup"><span data-stu-id="0dfa7-140">How Clients Find and Realize Virtualized Items</span></span>

<span data-ttu-id="0dfa7-141">Les clients peuvent utiliser la méthode [**IUIAutomationItemContainerPattern :: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) pour rechercher des éléments enfants dans le conteneur en fonction de la valeur d’une propriété particulière.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-141">Clients can use the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method to search for child items in the container based on the value of a particular property.</span></span> <span data-ttu-id="0dfa7-142">La méthode peut également récupérer le premier élément dans le conteneur ou l’élément qui suit l’élément spécifié.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-142">The method can also retrieve the first item in the container or the item that follows the specified item.</span></span> <span data-ttu-id="0dfa7-143">Si un élément enfant correspondant est trouvé, **FindItemByProperty** récupère une interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) pour l’élément.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-143">If a matching child item is found, the **FindItemByProperty** retrieves an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for the item.</span></span> <span data-ttu-id="0dfa7-144">Toutefois, si l’élément enfant est virtualisé, l’interface **IUIAutomationElement** est un espace réservé.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-144">However, if the child item is virtualized, the **IUIAutomationElement** interface is a placeholder.</span></span> <span data-ttu-id="0dfa7-145">L’erreur [**UIA \_ E \_ ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) se produit lorsque le client tente d’utiliser l’interface **IUIAutomationElement** pour récupérer des valeurs de propriété ou appeler des méthodes qui ne sont pas encore disponibles.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-145">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error occurs when the client attempts to use the **IUIAutomationElement** interface to retrieve property values or call methods that are not yet available.</span></span> <span data-ttu-id="0dfa7-146">Les propriétés ou méthodes disponibles via un espace réservé dépendent de l’implémentation du contrôle.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-146">Which properties or methods are available through a placeholder depends on the control implementation.</span></span> <span data-ttu-id="0dfa7-147">La seule exigence pour un espace réservé consiste à prendre en charge l’interface [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .</span><span class="sxs-lookup"><span data-stu-id="0dfa7-147">The only requirement for a placeholder is to support the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface.</span></span>

<span data-ttu-id="0dfa7-148">L’erreur [**UIA \_ E \_ ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) indique au client qu’un élément peut être virtualisé.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-148">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error is an indication to the client that an item may be virtualized.</span></span> <span data-ttu-id="0dfa7-149">Le client doit répondre en récupérant l’interface [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) pour l’élément, puis en réalisant l’élément en appelant la méthode [**IUIAutomationVirtualizedItemPattern :: réalise**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) .</span><span class="sxs-lookup"><span data-stu-id="0dfa7-149">The client should respond by retrieving the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface for the item, and then realizing the item by calling the [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method.</span></span> <span data-ttu-id="0dfa7-150">Si cela se déroule correctement, l’interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) est entièrement fonctionnelle avec toutes les propriétés appropriées disponibles.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-150">If this succeeds, the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface is fully functional with all appropriate properties available.</span></span>

<span data-ttu-id="0dfa7-151">En fonction de l’implémentation du contrôle, l’appel de [**IUIAutomationVirtualizedItemPattern ::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) provision peut entraîner le défilement de l’élément par le contrôle.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-151">Depending on the control implementation, calling [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) may cause the control to scroll the item into view.</span></span> <span data-ttu-id="0dfa7-152">Toutefois, un client ne doit pas s’appuyer sur l’élément qui fait défiler l’affichage ou le rendre visible.</span><span class="sxs-lookup"><span data-stu-id="0dfa7-152">However, a client should not rely on the item scrolling into view or made visible.</span></span> <span data-ttu-id="0dfa7-153">Pour vous assurer que l’élément est visible, le client peut utiliser la méthode [**IUIAutomationScrollItemPattern :: ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) .</span><span class="sxs-lookup"><span data-stu-id="0dfa7-153">To ensure that the item is visible, the client can use the [**IUIAutomationScrollItemPattern::ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) method.</span></span>

## <a name="example"></a><span data-ttu-id="0dfa7-154">Exemple</span><span class="sxs-lookup"><span data-stu-id="0dfa7-154">Example</span></span>

<span data-ttu-id="0dfa7-155">Pour obtenir un exemple de code qui montre comment utiliser la prise en charge d’UI Automation pour la virtualisation, consultez [Comment récupérer un élément virtualisé](uiauto-howto-retrieve-virtualized-item.md).</span><span class="sxs-lookup"><span data-stu-id="0dfa7-155">For example code that shows how to use the UI Automation support for virtualization, see [How to Retrieve a Virtualized Item](uiauto-howto-retrieve-virtualized-item.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="0dfa7-156">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="0dfa7-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0dfa7-157">Vue d'ensemble des modèles de contrôle UI Automation</span><span class="sxs-lookup"><span data-stu-id="0dfa7-157">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> </dl>

 

 




