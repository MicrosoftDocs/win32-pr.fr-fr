---
title: Comment interroger un élément virtualisé dans la vue éléments
description: Cette rubrique explique comment utiliser l’automatisation de l’interface utilisateur de Microsoft pour récupérer des informations d’interface utilisateur sur les éléments virtualisés dans l’affichage des éléments Windows 7.
ms.assetid: a0bff8a1-47b1-4750-8086-e2e65a79099e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a098635d6e1045c6ff4573de088d8455685014d3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104380282"
---
# <a name="how-to-query-a-virtualized-item-in-items-view"></a><span data-ttu-id="8ab31-103">Comment interroger un élément virtualisé dans la vue éléments</span><span class="sxs-lookup"><span data-stu-id="8ab31-103">How to Query a Virtualized Item in Items View</span></span>

<span data-ttu-id="8ab31-104">Cette rubrique explique comment utiliser l’automatisation de l’interface utilisateur de Microsoft pour récupérer des informations d’interface utilisateur sur les éléments virtualisés dans l’affichage des éléments Windows 7.</span><span class="sxs-lookup"><span data-stu-id="8ab31-104">This topic describes how to use Microsoft UI Automation to retrieve UI information about virtualized items in the Windows 7 Items View.</span></span> <span data-ttu-id="8ab31-105">Cette rubrique comprend les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="8ab31-105">This topic includes the following sections.</span></span>

> [!Note]  
> <span data-ttu-id="8ab31-106">Cette rubrique s’applique uniquement à Windows 7.</span><span class="sxs-lookup"><span data-stu-id="8ab31-106">This topic applies to Windows 7 only.</span></span> <span data-ttu-id="8ab31-107">Sachez que les fonctionnalités d’accessibilité décrites dans cette rubrique peuvent changer dans les versions futures de Windows.</span><span class="sxs-lookup"><span data-stu-id="8ab31-107">Be aware that the accessibility features described in this topic may change in future versions of Windows.</span></span>

 

-   [<span data-ttu-id="8ab31-108">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="8ab31-108">Overview</span></span>](#overview)
-   [<span data-ttu-id="8ab31-109">Arborescence de la vue éléments, structure</span><span class="sxs-lookup"><span data-stu-id="8ab31-109">Items View Tree Structure</span></span>](#items-view-tree-structure)
-   [<span data-ttu-id="8ab31-110">Virtualisation</span><span class="sxs-lookup"><span data-stu-id="8ab31-110">Virtualization</span></span>](#virtualization)
-   [<span data-ttu-id="8ab31-111">Obtention du décompte de tous les éléments</span><span class="sxs-lookup"><span data-stu-id="8ab31-111">Obtaining a Count of All Items</span></span>](#obtaining-a-count-of-all-items)
-   [<span data-ttu-id="8ab31-112">Obtention d’un index d’élément par rapport à tous les éléments</span><span class="sxs-lookup"><span data-stu-id="8ab31-112">Obtaining an Item Index with Respect to All Items</span></span>](#obtaining-an-item-index-with-respect-to-all-items)
-   [<span data-ttu-id="8ab31-113">Obtention d’une référence à un élément Vitualized</span><span class="sxs-lookup"><span data-stu-id="8ab31-113">Obtaining a Reference to a Vitualized Item</span></span>](#obtaining-a-reference-to-a-vitualized-item)
-   [<span data-ttu-id="8ab31-114">Défilement d’un élément virtualisé à l’écran</span><span class="sxs-lookup"><span data-stu-id="8ab31-114">Scrolling a Virtualized Item on Screen</span></span>](#scrolling-a-virtualized-item-on-screen)
-   [<span data-ttu-id="8ab31-115">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8ab31-115">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="8ab31-116">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="8ab31-116">Overview</span></span>

<span data-ttu-id="8ab31-117">La vue éléments est un composant d’interface utilisateur qui permet aux utilisateurs d’afficher et d’interagir avec des fichiers et d’autres éléments.</span><span class="sxs-lookup"><span data-stu-id="8ab31-117">Items View is a user interface component that enables users to view and interact with files and other items.</span></span> <span data-ttu-id="8ab31-118">Dans Windows 7, la vue éléments remplace le contrôle List-View pour présenter des éléments dans la vue par défaut de l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="8ab31-118">In Windows 7, Items View replaces the list-view control for presenting items in the default view of Windows Explorer.</span></span> <span data-ttu-id="8ab31-119">La vue éléments est également utilisée dans la boîte de dialogue élément commun, les résultats de la recherche dans le menu Démarrer et d’autres éléments d’interface utilisateur Windows 7 qui utilisent le contrôle navigateur de l’Explorateur.</span><span class="sxs-lookup"><span data-stu-id="8ab31-119">Items View is also used in the Common Item Dialog, Start menu search results, and other Windows 7 UI elements that use the Explorer Browser control.</span></span> <span data-ttu-id="8ab31-120">Par rapport au contrôle List-View, la vue items offre les avantages suivants aux utilisateurs :</span><span class="sxs-lookup"><span data-stu-id="8ab31-120">Compared to the list-view control, Items View offers the following advantages to users:</span></span>

-   <span data-ttu-id="8ab31-121">La vue éléments peut présenter des éléments qui sont plus utiles, souhaitables et pertinents, ce qui permet aux utilisateurs de rechercher et d’organiser des éléments plus simplement, rapidement et facilement.</span><span class="sxs-lookup"><span data-stu-id="8ab31-121">Items View can present items in ways that are more useful, desirable, and relevant, enabling users to find and organize items more simply, quickly, and enjoyably.</span></span>
-   <span data-ttu-id="8ab31-122">La vue éléments peut afficher de grands ensembles d’éléments à partir de sources de données qui ont des caractéristiques de performances différentes, ce qui permet aux utilisateurs de parcourir et de rechercher la totalité de leur collection d’éléments dans plusieurs sources.</span><span class="sxs-lookup"><span data-stu-id="8ab31-122">Items View can display large sets of items from data sources that have different performance characteristics, enabling users to browse and search their entire collection of items across multiple sources.</span></span>

<span data-ttu-id="8ab31-123">L’illustration suivante montre la vue éléments dans l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="8ab31-123">The following image shows the Items View in Windows Explorer.</span></span>

![capture d’écran montrant l’Explorateur Windows avec le composant vue éléments](images/itemsview.gif)

<span data-ttu-id="8ab31-125">Du point de vue d’un développeur, la structure générale et les fonctionnalités de la vue éléments sont similaires à celles du contrôle List-View.</span><span class="sxs-lookup"><span data-stu-id="8ab31-125">From a developer's perspective, the general structure and functionality of Items View is similar to that of the list-view control.</span></span> <span data-ttu-id="8ab31-126">La principale différence réside dans le fait que la vue items prend en charge la virtualisation, contrairement au contrôle List-View.</span><span class="sxs-lookup"><span data-stu-id="8ab31-126">The main difference is that Items View supports virtualization, whereas the list-view control does not.</span></span> <span data-ttu-id="8ab31-127">En outre, la vue éléments utilise deux nouvelles interfaces UI Automation pour garantir que le contenu virtualisé fourni par la vue éléments est accessible.</span><span class="sxs-lookup"><span data-stu-id="8ab31-127">Also, Items View uses two new UI Automation interfaces to ensure that virtualized content provided by Items View is accessible.</span></span> <span data-ttu-id="8ab31-128">Ces interfaces sont décrites dans les sections suivantes de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="8ab31-128">These interfaces are described in the following sections of this topic.</span></span>

<span data-ttu-id="8ab31-129">Pour obtenir des informations générales sur la virtualisation dans UI Automation, consultez [utilisation des éléments virtualisés](uiauto-workingwithvirtualizeditems.md).</span><span class="sxs-lookup"><span data-stu-id="8ab31-129">For general information about virtualization in UI Automation, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="items-view-tree-structure"></a><span data-ttu-id="8ab31-130">Arborescence de la vue éléments, structure</span><span class="sxs-lookup"><span data-stu-id="8ab31-130">Items View Tree Structure</span></span>

<span data-ttu-id="8ab31-131">Dans l’arborescence UI Automation, l’élément UI Automation de niveau supérieur de la vue éléments a le nom « ItemsView » et le type de contrôle « List ».</span><span class="sxs-lookup"><span data-stu-id="8ab31-131">In the UI Automation tree, the top level UI Automation element of Items View has the name "ItemsView" and the control type "list".</span></span> <span data-ttu-id="8ab31-132">Dans l’image précédente, l’élément UI Automation ItemsView est souligné en rouge.</span><span class="sxs-lookup"><span data-stu-id="8ab31-132">In the previous image, the ItemsView UI Automation element is outlined in red.</span></span> <span data-ttu-id="8ab31-133">Différents éléments UI Automation se trouvent sous le niveau supérieur de ItemsView, mais seuls deux autres éléments UI Automation sont référencés dans ce document : éléments de groupe et éléments de liste.</span><span class="sxs-lookup"><span data-stu-id="8ab31-133">Various UI Automation elements exist below the top level of ItemsView, but only two other UI Automation elements are referenced in this document: group items and list items.</span></span>

<span data-ttu-id="8ab31-134">Les éléments de groupe sont les éléments UI Automation qui contiennent tous les éléments de liste de ce groupe : leur type de contrôle est « groupe » et leurs noms varient en fonction du nom du groupe.</span><span class="sxs-lookup"><span data-stu-id="8ab31-134">The group items are the UI Automation elements that contain all of the list items of that group—their control type is "Group" and their names vary depending on the group name.</span></span> <span data-ttu-id="8ab31-135">Dans l’image précédente, le premier élément de groupe contient à la fois l’en-tête « A-H (1) » et l’élément de liste « dossier », et son nom est « A-H ».</span><span class="sxs-lookup"><span data-stu-id="8ab31-135">In the previous image, the first group item contains both the "A-H (1)" header and the "Folder" list item, and its name is "A-H".</span></span>

<span data-ttu-id="8ab31-136">Les éléments de liste sont les éléments UI Automation qui représentent les éléments feuille de la vue : leur type de contrôle est « ListItem » et leurs noms varient en fonction du nom de l’élément.</span><span class="sxs-lookup"><span data-stu-id="8ab31-136">The list items are the UI Automation elements that represent the leaf items in the view—their control type is "ListItem" and their names vary depending on the item name.</span></span> <span data-ttu-id="8ab31-137">Dans l’image précédente, les éléments de liste sont les éléments feuilles tels que « Folder », « Music » et « Picture ».</span><span class="sxs-lookup"><span data-stu-id="8ab31-137">In the previous image, the list elements are the leaf elements such as "Folder", "Music", and "Picture".</span></span> <span data-ttu-id="8ab31-138">Ces trois éléments UI Automation sont référencés par les termes ItemsView ELEMENT, Group Element et ListItem dans le reste de ce document.</span><span class="sxs-lookup"><span data-stu-id="8ab31-138">These three UI Automation elements are referred to by the terms ItemsView element, Group element, and ListItem element in the remainder of this document.</span></span>

## <a name="virtualization"></a><span data-ttu-id="8ab31-139">Virtualisation</span><span class="sxs-lookup"><span data-stu-id="8ab31-139">Virtualization</span></span>

<span data-ttu-id="8ab31-140">La vue éléments utilise la virtualisation, ce qui signifie que les éléments en dehors de la zone visible de la vue ne sont pas extraits du système et que la représentation de l’interface utilisateur n’est pas créée.</span><span class="sxs-lookup"><span data-stu-id="8ab31-140">Items View uses virtualization, which means that items outside the visible area of the view are not fetched from the system, and the UI representation of them is not created.</span></span> <span data-ttu-id="8ab31-141">Ces éléments sont appelés *éléments virtualisés*.</span><span class="sxs-lookup"><span data-stu-id="8ab31-141">These items are called *virtualized items*.</span></span> <span data-ttu-id="8ab31-142">Étant donné qu’ils ne sont pas créés, les éléments virtualisés n’ont pas d’éléments UI Automation et, par conséquent, n’apparaissent pas dans l’arborescence UI Automation lorsqu’un client UI Automation énumère l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="8ab31-142">Because they are not created, virtualized items do not have UI Automation elements and therefore do not appear in the UI Automation tree when a UI Automation client enumerates the tree.</span></span> <span data-ttu-id="8ab31-143">En outre, les modèles de contrôle UI Automation fonctionnent uniquement sur les éléments visibles.</span><span class="sxs-lookup"><span data-stu-id="8ab31-143">Also, UI Automation control patterns operate only on visible elements.</span></span> <span data-ttu-id="8ab31-144">Par exemple, le modèle de contrôle [Selection](uiauto-implementingselection.md) ne retourne que les éléments sélectionnés visibles lorsqu’un client appelle la méthode [**IUIAutomationSelectionPattern :: GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) .</span><span class="sxs-lookup"><span data-stu-id="8ab31-144">For example, the [Selection](uiauto-implementingselection.md) control pattern returns only the visible selected items when a client calls the [**IUIAutomationSelectionPattern::GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) method.</span></span>

<span data-ttu-id="8ab31-145">La vue items prend en charge la possibilité de récupérer les informations suivantes sur les éléments virtualisés :</span><span class="sxs-lookup"><span data-stu-id="8ab31-145">Items View supports the ability to retrieve the following information about virtualized items:</span></span>

-   <span data-ttu-id="8ab31-146">Nombre total d’éléments, y compris les éléments virtualisés</span><span class="sxs-lookup"><span data-stu-id="8ab31-146">A count of the total number of items, including virtualized items</span></span>
-   <span data-ttu-id="8ab31-147">Éléments UI Automation pour les éléments virtualisés</span><span class="sxs-lookup"><span data-stu-id="8ab31-147">UI Automation elements for virtualized items</span></span>
-   <span data-ttu-id="8ab31-148">Éléments UI Automation pour les éléments virtualisés sélectionnés</span><span class="sxs-lookup"><span data-stu-id="8ab31-148">UI Automation elements for the virtualized items that are selected</span></span>

## <a name="obtaining-a-count-of-all-items"></a><span data-ttu-id="8ab31-149">Obtention du décompte de tous les éléments</span><span class="sxs-lookup"><span data-stu-id="8ab31-149">Obtaining a Count of All Items</span></span>

<span data-ttu-id="8ab31-150">Un client peut utiliser l’élément ItemsView pour obtenir le nombre total d’éléments, ainsi que le nombre d’éléments sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="8ab31-150">A client can use the ItemsView element to get a count of all items, as well as a count of the selected items.</span></span> <span data-ttu-id="8ab31-151">L’élément ItemsView fournit deux façons d’effectuer ces nombres.</span><span class="sxs-lookup"><span data-stu-id="8ab31-151">The ItemsView element provides two ways to get these counts.</span></span> <span data-ttu-id="8ab31-152">La première consiste à obtenir la propriété ItemStatus de l’élément ItemsView, tandis que la seconde consiste à obtenir des propriétés personnalisées à partir de l’élément ItemsView.</span><span class="sxs-lookup"><span data-stu-id="8ab31-152">The first is by getting the ItemStatus property of the ItemsView element, and the second is by getting custom properties from the ItemsView element.</span></span>

<span data-ttu-id="8ab31-153">La propriété ItemStatus est une chaîne qui spécifie le nombre total d’éléments et le nombre d’éléments sélectionnés, séparés par une virgule.</span><span class="sxs-lookup"><span data-stu-id="8ab31-153">The ItemStatus property is a string that specifies a count of the total number of items and a count of the selected items, separated by a comma.</span></span> <span data-ttu-id="8ab31-154">Par exemple : « 3 éléments, 1 élément sélectionné ».</span><span class="sxs-lookup"><span data-stu-id="8ab31-154">For example: "3 items, 1 item selected".</span></span> <span data-ttu-id="8ab31-155">Cette chaîne est localisée et peut être communiquée directement à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8ab31-155">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="8ab31-156">Les propriétés personnalisées de l’élément ItemsView incluent une propriété pour le nombre d’éléments, et une autre pour le nombre de sélections.</span><span class="sxs-lookup"><span data-stu-id="8ab31-156">The custom properties of the ItemsView element include one property for the item count, and another for the selection count.</span></span> <span data-ttu-id="8ab31-157">Ils comprennent :</span><span class="sxs-lookup"><span data-stu-id="8ab31-157">They include:</span></span>

-   <span data-ttu-id="8ab31-158">ItemCount \_ Property \_ GUID (ABBF5C45-5CCC-47B7-BB4E-87CB87BBD162) : nombre de tous les éléments uniques dans la vue.</span><span class="sxs-lookup"><span data-stu-id="8ab31-158">ItemCount\_Property\_GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162)—The count of all unique items in the view.</span></span> <span data-ttu-id="8ab31-159">S’ils sont regroupés par une propriété à valeurs multiples (MVP) afin qu’un seul élément puisse apparaître plusieurs fois, chaque élément n’est compté qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="8ab31-159">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="8ab31-160">(UIAutomationType : [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nom de programmation : "ItemCount")</span><span class="sxs-lookup"><span data-stu-id="8ab31-160">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemCount")</span></span>

-   <span data-ttu-id="8ab31-161">\_ \_ GUID de la propriété SELECTEDITEMCOUNT (92A053DA-2969-4021-BF27-514CFC2E4A69) : nombre de tous les éléments uniques sélectionnés dans la vue.</span><span class="sxs-lookup"><span data-stu-id="8ab31-161">SelectedItemCount\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The count of all unique items selected in the view.</span></span> <span data-ttu-id="8ab31-162">S’ils sont regroupés par une propriété à valeurs multiples (MVP) afin qu’un seul élément puisse apparaître plusieurs fois, chaque élément n’est compté qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="8ab31-162">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="8ab31-163">(UIAutomationType : [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nom de programmation : "SelectedItemCount")</span><span class="sxs-lookup"><span data-stu-id="8ab31-163">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "SelectedItemCount")</span></span>

<span data-ttu-id="8ab31-164">Ces propriétés personnalisées sont définies dans shlguid. h, qui est inclus dans le kit de développement logiciel (SDK) Windows, et ces propriétés sont inscrites via la méthode [**IUIAutomationRegistrar :: RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="8ab31-164">These custom properties are defined in Shlguid.h, which is included in the Windows Software Development Kit (SDK), and these properties are registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="8ab31-165">Les clients UI Automation utilisent **RegisterProperty** pour récupérer les identificateurs de propriété (connaître) pour les propriétés personnalisées.</span><span class="sxs-lookup"><span data-stu-id="8ab31-165">UI Automation clients use **RegisterProperty** to retrieve property identifiers (PROPERTYIDs) for the custom properties.</span></span>

## <a name="obtaining-an-item-index-with-respect-to-all-items"></a><span data-ttu-id="8ab31-166">Obtention d’un index d’élément par rapport à tous les éléments</span><span class="sxs-lookup"><span data-stu-id="8ab31-166">Obtaining an Item Index with Respect to All Items</span></span>

<span data-ttu-id="8ab31-167">Un client peut obtenir l’index d’un élément soit en obtenant la propriété ItemStatus d’un élément ListItem, soit en obtenant une propriété personnalisée d’un élément ListItem.</span><span class="sxs-lookup"><span data-stu-id="8ab31-167">A client can obtain the index of an item either by getting the ItemStatus property of a ListItem element, or by getting a custom property of a ListItem element.</span></span>

<span data-ttu-id="8ab31-168">La propriété ItemStatus est une chaîne qui contient l’index d’un élément par rapport au nombre total d’éléments.</span><span class="sxs-lookup"><span data-stu-id="8ab31-168">The ItemStatus property is a string that contains the index of an item with respect to the total number of items.</span></span> <span data-ttu-id="8ab31-169">Par exemple : « élément 1 sur 3 ».</span><span class="sxs-lookup"><span data-stu-id="8ab31-169">For example: "item 1 of 3".</span></span> <span data-ttu-id="8ab31-170">Cette chaîne est localisée et peut être communiquée directement à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8ab31-170">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="8ab31-171">La propriété personnalisée suivante obtient l’index d’élément d’un élément ListItem :</span><span class="sxs-lookup"><span data-stu-id="8ab31-171">The following custom property gets the item index of a ListItem element:</span></span>

-   <span data-ttu-id="8ab31-172">\_Propriété ItemIndex \_ GUID (92A053DA-2969-4021-BF27-514CFC2E4A69) : index absolu de base 1 d’un élément.</span><span class="sxs-lookup"><span data-stu-id="8ab31-172">ItemIndex\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The 1-based absolute index of an item.</span></span> <span data-ttu-id="8ab31-173">S’ils sont regroupés par une propriété à valeurs multiples (MVP) afin qu’un seul élément puisse apparaître deux fois, chaque apparence de l’élément obtient un index séparé.</span><span class="sxs-lookup"><span data-stu-id="8ab31-173">If grouped by a multi-value property (MVP) so that a single item can appear twice, each appearance of the item gets a separate index.</span></span>

    <span data-ttu-id="8ab31-174">(UIAutomationType : [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nom de programmation : "ItemIndex")</span><span class="sxs-lookup"><span data-stu-id="8ab31-174">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemIndex")</span></span>

<span data-ttu-id="8ab31-175">Cette propriété personnalisée est définie dans shlguid. h, qui est inclus dans le SDK Windows, et est inscrite via la méthode [**IUIAutomationRegistrar :: RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="8ab31-175">This custom property is defined in Shlguid.h, which is included in the Windows SDK, and is registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="8ab31-176">Les clients UI Automation utilisent **RegisterProperty** pour récupérer un identificateur de propriété (connaître) pour la propriété personnalisée.</span><span class="sxs-lookup"><span data-stu-id="8ab31-176">UI Automation clients use **RegisterProperty** to retrieve a property identifier (PROPERTYIDs) for the custom property.</span></span>

## <a name="obtaining-a-reference-to-a-vitualized-item"></a><span data-ttu-id="8ab31-177">Obtention d’une référence à un élément Vitualized</span><span class="sxs-lookup"><span data-stu-id="8ab31-177">Obtaining a Reference to a Vitualized Item</span></span>

<span data-ttu-id="8ab31-178">Un élément ItemsView implémente le modèle de contrôle [ItemContainer](uiauto-implementingitemcontainer.md) (interface [**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) ), qui permet à un client d’obtenir un élément UI Automation pour un élément virtualisé (un élément qui se trouve en dehors de la zone visible).</span><span class="sxs-lookup"><span data-stu-id="8ab31-178">An ItemsView element implements the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) interface), which allows a client to get a UI Automation element for a virtualized item (an item that is outside the visible area).</span></span> <span data-ttu-id="8ab31-179">ItemsView permet au client de rechercher un élément ListItem en effectuant une recherche sur les propriétés Name et Selection : la tentative de recherche sur une autre propriété échoue.</span><span class="sxs-lookup"><span data-stu-id="8ab31-179">ItemsView allows the client to find a ListItem element by searching on the Name and Selection properties—attempting to search on any other property will fail.</span></span>

<span data-ttu-id="8ab31-180">Un élément virtuel implémente uniquement le modèle de contrôle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) (interface [**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) ).</span><span class="sxs-lookup"><span data-stu-id="8ab31-180">A virtual element implements only the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) interface).</span></span> <span data-ttu-id="8ab31-181">Étant donné que l’élément représenté par un élément UI Automation virtualisé n’existe pas encore, toute tentative d’obtenir un autre modèle de contrôle ou une autre propriété de l’élément échoue.</span><span class="sxs-lookup"><span data-stu-id="8ab31-181">Because the item that is represented by a virtualized UI Automation element does not exist yet, attempting to get any other control pattern or property of the element will fail.</span></span>

<span data-ttu-id="8ab31-182">Les éléments ListItem et Group sont virtualisés, mais seuls les éléments ListItem peuvent être retournés à partir du modèle de contrôle [ItemContainer](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="8ab31-182">Both ListItem and Group elements are virtualized, but only ListItem elements can be returned from the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="8ab31-183">Étant donné que l’appel à la méthode [**IUIAutomationItemContainerPattern :: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) s’exécute sur le thread d’interface utilisateur et qu’il bloque, la vue ne répond pas tant que **FindItemByProperty** n’est pas retourné, et tout autre appel de méthode sur le fournisseur doit attendre la fin de **FindItemByProperty** .</span><span class="sxs-lookup"><span data-stu-id="8ab31-183">Because the call to the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method runs on the UI thread and is blocking, the view will not respond until **FindItemByProperty** returns, and any other method calls on the provider must wait until **FindItemByProperty** finishes.</span></span> <span data-ttu-id="8ab31-184">Dans certains cas, **FindItemByProperty** doit traiter l’ensemble du jeu de données avant de retourner, ce qui peut nécessiter de nombreuses ressources.</span><span class="sxs-lookup"><span data-stu-id="8ab31-184">In some instances, **FindItemByProperty** must process the entire data set before returning, which can be resource-intensive.</span></span> <span data-ttu-id="8ab31-185">Si vous spécifiez **null** comme élément de départ, **FindItemByProperty** commence la recherche par le premier élément de la vue.</span><span class="sxs-lookup"><span data-stu-id="8ab31-185">Specifying **NULL** as the starting element causes **FindItemByProperty** to begin the search with the first item in the view.</span></span>

<span data-ttu-id="8ab31-186">ItemsView prend en charge les propriétés suivantes pour [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span><span class="sxs-lookup"><span data-stu-id="8ab31-186">ItemsView supports the following properties for [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span></span>

-   <span data-ttu-id="8ab31-187">Name (UIA \_ NamePropertyId) : recherche le premier élément dont le nom correspond entièrement à la chaîne spécifiée.</span><span class="sxs-lookup"><span data-stu-id="8ab31-187">Name (UIA\_NamePropertyId)—Searches for the first item whose name fully matches the specified string.</span></span> <span data-ttu-id="8ab31-188">La recherche ne respecte pas la casse.</span><span class="sxs-lookup"><span data-stu-id="8ab31-188">The search is not case sensitive.</span></span> <span data-ttu-id="8ab31-189">Les caractères génériques ou la correspondance partielle ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="8ab31-189">Wildcard characters or partial matching is not supported.</span></span> <span data-ttu-id="8ab31-190">Si un nom **null** est spécifié, l’élément suivant après l’élément de départ est retourné.</span><span class="sxs-lookup"><span data-stu-id="8ab31-190">If a **NULL** name is specified, the next item after the starting element is returned.</span></span> <span data-ttu-id="8ab31-191">La spécification de noms **null** permet à un client UI Automation d’énumérer tous les éléments de la vue ; Toutefois, l’énumération de tous les éléments est déconseillée, car elle entraîne la réalisation de tous les éléments de la vue.</span><span class="sxs-lookup"><span data-stu-id="8ab31-191">Specifying **NULL** names allows a UI Automation client to enumerate all items in the view; however, enumerating all items is discouraged because it causes all items in the view to be realized.</span></span>
-   <span data-ttu-id="8ab31-192">SelectionItem \_ IsSelected (UIA \_ SelectionItemIsSelectedPropertyId) : recherche le premier élément dont \_ la propriété IsSelected SelectionItem correspond à la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="8ab31-192">SelectionItem\_IsSelected (UIA\_SelectionItemIsSelectedPropertyId)—Searches for the first item whose SelectionItem\_IsSelected property matches the specified value.</span></span> <span data-ttu-id="8ab31-193">Spécifiez **true** pour rechercher le premier élément sélectionné, ou **false** pour rechercher le premier élément non sélectionné.</span><span class="sxs-lookup"><span data-stu-id="8ab31-193">Specify **TRUE** to find the first selected item, or **FALSE** to find the first non-selected item.</span></span> <span data-ttu-id="8ab31-194">Soyez prudent lors de l’énumération de tous les éléments sélectionnés, car le nombre d’éléments sélectionnés peut être très élevé, en particulier si l’utilisateur a sélectionné tous les éléments.</span><span class="sxs-lookup"><span data-stu-id="8ab31-194">Be careful when enumerating all selected items because the number of selected items can be very large, especially if the user has selected all items.</span></span>

## <a name="scrolling-a-virtualized-item-on-screen"></a><span data-ttu-id="8ab31-195">Défilement d’un élément virtualisé à l’écran</span><span class="sxs-lookup"><span data-stu-id="8ab31-195">Scrolling a Virtualized Item on Screen</span></span>

<span data-ttu-id="8ab31-196">Après avoir obtenu une référence à un élément UI Automation pour un élément virtualisé (hors de l’écran), le client peut faire défiler l’élément dans l’affichage à l’aide de la méthode [**IUIAutomationVirtualizeItemPattern :: réalise**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) du modèle de contrôle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="8ab31-196">After obtaining a reference to a UI Automation element for a virtualized (off-screen) item, the client can scroll the item into view by using the [**IUIAutomationVirtualizeItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method of the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="8ab31-197">Une fois l’élément réalisé, il est visible et toutes les propriétés et les modèles de contrôle normalement associés à un élément ListItem sont disponibles pour le client.</span><span class="sxs-lookup"><span data-stu-id="8ab31-197">After the item is realized, it is visible, and all properties and control patterns normally associated with a ListItem element are available to the client.</span></span>

<span data-ttu-id="8ab31-198">Seuls les éléments ListItem obtenus par la méthode [**IUIAutomationItemContainerPattern :: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) exposent le modèle de contrôle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="8ab31-198">Only ListItem elements obtained by the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method expose the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="8ab31-199">Lorsqu’un élément à l’écran est défilant hors de l’écran, l’élément devient non valide et le client doit appeler **FindItemByProperty** pour accéder à la référence hors écran.</span><span class="sxs-lookup"><span data-stu-id="8ab31-199">When an on-screen element is scrolled off-screen, the element becomes invalid and the client must call **FindItemByProperty** to get the off-screen reference.</span></span>

<span data-ttu-id="8ab31-200">Il est également possible de déplacer des éléments dans et hors de l’affichage à l’aide du modèle de contrôle [Scroll](uiauto-implementingscroll.md) (ou à l’aide des barres de défilement).</span><span class="sxs-lookup"><span data-stu-id="8ab31-200">It is also possible to move items into and out of view by using the [Scroll](uiauto-implementingscroll.md) control pattern (or by using the scroll bars).</span></span> <span data-ttu-id="8ab31-201">Les éléments et les groupes sont réalisés au fur et à mesure qu’ils font défiler la vue et sont virtualisés à mesure qu’ils défilent hors de l’affichage.</span><span class="sxs-lookup"><span data-stu-id="8ab31-201">Items and groups are realized as they scroll into view, and are virtualized as they scroll out of view.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8ab31-202">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="8ab31-202">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8ab31-203">Utilisation d’éléments virtualisés</span><span class="sxs-lookup"><span data-stu-id="8ab31-203">Working with Virtualized Items</span></span>](uiauto-workingwithvirtualizeditems.md)
</dt> </dl>

 

 




