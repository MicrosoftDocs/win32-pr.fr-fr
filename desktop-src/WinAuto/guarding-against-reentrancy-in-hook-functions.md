---
title: Protection contre la réentrance dans les fonctions de raccordement
description: Lorsqu’une fonction de raccordement traite un événement, des événements supplémentaires peuvent être déclenchés, ce qui peut entraîner la réentrée de la fonction de raccordement avant la fin du traitement de l’événement d’origine.
ms.assetid: 2382e7a4-82df-423a-8479-66e28baf8105
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 74e2b0dc6f8951bf48ce3fecabd3a81bd345388d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104382416"
---
# <a name="guarding-against-reentrancy-in-hook-functions"></a><span data-ttu-id="9970c-103">Protection contre la réentrance dans les fonctions de raccordement</span><span class="sxs-lookup"><span data-stu-id="9970c-103">Guarding Against Reentrancy in Hook Functions</span></span>

<span data-ttu-id="9970c-104">Lorsqu’une fonction de raccordement traite un événement, des événements supplémentaires peuvent être déclenchés, ce qui peut entraîner la réentrée de la fonction de raccordement avant la fin du traitement de l’événement d’origine.</span><span class="sxs-lookup"><span data-stu-id="9970c-104">While a hook function processes an event, additional events may be triggered, which may cause the hook function to reenter before the processing for the original event is finished.</span></span> <span data-ttu-id="9970c-105">Le problème de la réentrance dans les fonctions de raccordement est que les événements sont terminés hors séquence, sauf si la fonction de raccordement gère cette situation.</span><span class="sxs-lookup"><span data-stu-id="9970c-105">The problem with reentrancy in hook functions is that events are completed out of sequence unless the hook function handles this situation.</span></span>

<span data-ttu-id="9970c-106">Par exemple, considérez un cas où une fonction de raccordement dans un programme de lecture d’écran traite l’événement [**\_ \_ VALUECHANGE**](event-constants.md) de l’objet d’événement pour un contrôle d’édition.</span><span class="sxs-lookup"><span data-stu-id="9970c-106">For example, consider a case where a hook function in a screen reader program is processing the [**EVENT\_OBJECT\_VALUECHANGE**](event-constants.md) event for an edit control.</span></span> <span data-ttu-id="9970c-107">Si, lors du traitement du premier événement de modification de valeur, la fonction de raccordement est réentrée pour traiter un événement de modification de valeur subséquent, le deuxième événement est terminé avant le premier événement.</span><span class="sxs-lookup"><span data-stu-id="9970c-107">If, while processing the first value change event the hook function is reentered to process a subsequent value change event, the second event is completed before the first event.</span></span> <span data-ttu-id="9970c-108">Dans ce cas, le lecteur d’écran transmet des informations inexactes à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9970c-108">This situation results in the screen reader conveying inaccurate information to the user.</span></span>

<span data-ttu-id="9970c-109">Étant donné que le traitement des événements est interrompu, des événements supplémentaires peuvent être reçus chaque fois que la fonction de raccordement appelle une fonction qui entraîne la vérification de la file d’attente de messages du thread propriétaire.</span><span class="sxs-lookup"><span data-stu-id="9970c-109">Because event processing is interrupted, additional events might be received any time the hook function calls a function that causes the owning thread's message queue to get checked.</span></span> <span data-ttu-id="9970c-110">Cela se produit quand l’un des éléments suivants est appelé dans la fonction de raccordement :</span><span class="sxs-lookup"><span data-stu-id="9970c-110">This happens when any of the following are called within the hook function:</span></span>

-   <span data-ttu-id="9970c-111">Fonction Windows [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), [**GetMessage**](/windows/desktop/api/winuser/nf-winuser-getmessage), [**PeekMessage**](/windows/desktop/api/winuser/nf-winuser-peekmessagea), [**DialogBox**](/windows/desktop/api/winuser/nf-winuser-dialogboxa)ou [**MessageBox**](/windows/desktop/api/winuser/nf-winuser-messagebox)</span><span class="sxs-lookup"><span data-stu-id="9970c-111">The Windows [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), [**GetMessage**](/windows/desktop/api/winuser/nf-winuser-getmessage), [**PeekMessage**](/windows/desktop/api/winuser/nf-winuser-peekmessagea), [**DialogBox**](/windows/desktop/api/winuser/nf-winuser-dialogboxa), or [**MessageBox**](/windows/desktop/api/winuser/nf-winuser-messagebox) function</span></span>
-   <span data-ttu-id="9970c-112">Microsoft Active Accessibility Functions [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)</span><span class="sxs-lookup"><span data-stu-id="9970c-112">The Microsoft Active Accessibility functions [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)</span></span>
-   <span data-ttu-id="9970c-113">Une interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) ou une autre propriété ou méthode com (Component Object Model) qui traverse les limites de processus</span><span class="sxs-lookup"><span data-stu-id="9970c-113">An [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface or other Component Object Model (COM) property or method that crosses process boundaries</span></span>

<span data-ttu-id="9970c-114">Étant donné que les fonctions de raccordement appellent les propriétés et les méthodes [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) et [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , il n’est pas possible d’empêcher la réentrance.</span><span class="sxs-lookup"><span data-stu-id="9970c-114">Because hook functions call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) and [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties and methods, it is not possible to prevent reentrancy.</span></span> <span data-ttu-id="9970c-115">La seule solution est que les développeurs de clients ajoutent du code dans la fonction de raccordement qui détecte la réentrance et prennent les mesures appropriées si la fonction de raccordement est réentrée.</span><span class="sxs-lookup"><span data-stu-id="9970c-115">The only solution is for client developers to add code in the hook function that detects reentrancy and take appropriate action if the hook function is reentered.</span></span>

 

 