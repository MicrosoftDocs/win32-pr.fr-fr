---
title: À propos des modèles de contrôle Text et TextRange
description: Le contenu textuel d’un contrôle est exposé à l’aide du modèle de contrôle Text, qui représente le contenu d’un conteneur de texte sous la forme d’un flux de texte.
ms.assetid: acc2b513-9367-416a-b0d9-3c2bcc14a8a7
keywords:
- UI Automation, prise en charge du contenu textuel
- UI Automation, vue d’ensemble du modèle de texte
- UI Automation, vue d’ensemble des contrôles de texte
- UI Automation, modèle de contrôle de texte
- UI Automation, Text Services Framework (TSF)
- UI Automation, TSF
- UI Automation, performances
- modèles de texte, à propos de
- modèles de texte, Text Services Framework (TSF)
- contrôles de texte, à propos de
- contenu textuel, prise en charge de
- contrôles de texte, performances
- Text (modèle de contrôle)
- modèles de contrôle, texte
- Text Services Framework (TSF)
- TSF (Text Services Framework)
- performances
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb9ff1eb75227454e3e9df6035798a304096a958
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106511316"
---
# <a name="about-the-text-and-textrange-control-patterns"></a><span data-ttu-id="c7cc5-120">À propos des modèles de contrôle Text et TextRange</span><span class="sxs-lookup"><span data-stu-id="c7cc5-120">About the Text and TextRange Control Patterns</span></span>

<span data-ttu-id="c7cc5-121">Le contenu textuel d’un contrôle est exposé à l’aide du modèle de contrôle [Text](uiauto-implementingtextandtextrange.md) , qui représente le contenu d’un conteneur de texte sous la forme d’un flux de texte.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-121">The textual content of a control is exposed by using the [Text](uiauto-implementingtextandtextrange.md) control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="c7cc5-122">Le modèle de contrôle Text requiert la prise en charge du modèle de contrôle TextRange pour exposer les attributs de mise en forme et de style.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-122">The Text control pattern requires the support of the TextRange control pattern to expose format and style attributes.</span></span> <span data-ttu-id="c7cc5-123">Le modèle de contrôle TextRange prend en charge le modèle de contrôle Text en représentant des étendues de texte disjointes contiguës ou multiples dans un conteneur de texte avec une collection de points de terminaison de début et de fin.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-123">The TextRange control pattern supports the Text control pattern by representing contiguous or multiple, disjoint text spans (or ranges) in a text container with a collection of start and end endpoints.</span></span> <span data-ttu-id="c7cc5-124">Le modèle de contrôle TextRange prend en charge des fonctionnalités telles que la sélection, la comparaison, la récupération et la traversée.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-124">The TextRange control pattern supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!Note]  
> <span data-ttu-id="c7cc5-125">Le modèle de contrôle [Text](uiauto-implementingtextandtextrange.md) ne permet pas d’insérer ou de modifier du texte.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-125">The [Text](uiauto-implementingtextandtextrange.md) control pattern does not provide a means to insert or modify text.</span></span> <span data-ttu-id="c7cc5-126">Toutefois, en fonction du contrôle, cela peut être accompli à l’aide du modèle de contrôle [value](uiauto-implementingvalue.md) d’UI Automation de Microsoft ou via une entrée directe au clavier.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-126">However, depending on the control, this may be accomplished by using the Microsoft UI Automation [Value](uiauto-implementingvalue.md) control pattern or through direct keyboard input.</span></span> <span data-ttu-id="c7cc5-127">Il y a également un modèle [**TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) qui prend en charge la modification par programmation en texte.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-127">There's also a [**TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) pattern that supports programmatic change to text.</span></span>

 

<span data-ttu-id="c7cc5-128">Les fonctionnalités décrites dans cette rubrique sont essentielles pour les fournisseurs de technologies d’assistance et leurs utilisateurs finaux.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-128">The functionality described in this topic is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="c7cc5-129">Les technologies d’assistance peuvent utiliser UI Automation pour collecter des informations complètes sur la mise en forme du texte pour l’utilisateur et fournir une navigation par programmation et une sélection de texte par [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (caractère, mot, ligne ou paragraphe).</span><span class="sxs-lookup"><span data-stu-id="c7cc5-129">Assistive technologies can use UI Automation to gather complete text formatting information for the user and provide programmatic navigation and selection of text by [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (character, word, line, or paragraph).</span></span>

<span data-ttu-id="c7cc5-130">Cette rubrique contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="c7cc5-130">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="c7cc5-131">UI Automation TextPattern et l’infrastructure de services de texte</span><span class="sxs-lookup"><span data-stu-id="c7cc5-131">UI Automation TextPattern and the Text Services Framework</span></span>](#ui-automation-textpattern-and-the-text-services-framework)
-   [<span data-ttu-id="c7cc5-132">Types de contrôles</span><span class="sxs-lookup"><span data-stu-id="c7cc5-132">Control Types</span></span>](#control-types)
-   [<span data-ttu-id="c7cc5-133">Interfaces de fournisseur</span><span class="sxs-lookup"><span data-stu-id="c7cc5-133">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="c7cc5-134">Interfaces clientes</span><span class="sxs-lookup"><span data-stu-id="c7cc5-134">Client Interfaces</span></span>](#client-interfaces)
-   [<span data-ttu-id="c7cc5-135">Performances</span><span class="sxs-lookup"><span data-stu-id="c7cc5-135">Performance</span></span>](#performance)
-   [<span data-ttu-id="c7cc5-136">Modèle de texte et objets incorporés virtualisés</span><span class="sxs-lookup"><span data-stu-id="c7cc5-136">Text Pattern and Virtualized Embedded Objects</span></span>](#text-pattern-and-virtualized-embedded-objects)
-   [<span data-ttu-id="c7cc5-137">Utilisation du type de contrôle personnalisé avec le modèle de contrôle Text</span><span class="sxs-lookup"><span data-stu-id="c7cc5-137">Using the Custom Control Type with the Text Control Pattern</span></span>](#using-the-custom-control-type-with-the-text-control-pattern)
-   [<span data-ttu-id="c7cc5-138">Durée de vie d’une plage de texte</span><span class="sxs-lookup"><span data-stu-id="c7cc5-138">Lifetime of a Text Range</span></span>](#lifetime-of-a-text-range)
-   [<span data-ttu-id="c7cc5-139">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c7cc5-139">Related topics</span></span>](#related-topics)

## <a name="ui-automation-textpattern-and-the-text-services-framework"></a><span data-ttu-id="c7cc5-140">UI Automation TextPattern et l’infrastructure de services de texte</span><span class="sxs-lookup"><span data-stu-id="c7cc5-140">UI Automation TextPattern and the Text Services Framework</span></span>

<span data-ttu-id="c7cc5-141">Text Services Framework (TSF) est une infrastructure système simple et évolutive qui permet les services de langage naturel et l’entrée de texte avancée sur le bureau et dans les applications.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-141">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and in applications.</span></span> <span data-ttu-id="c7cc5-142">En plus de fournir des interfaces permettant aux applications d’exposer leur magasin de texte, il prend également en charge les métadonnées pour le magasin de texte.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-142">In addition to providing interfaces for applications to expose their text store, it also supports metadata for the text store.</span></span>

<span data-ttu-id="c7cc5-143">TSF a été conçu pour les applications qui doivent injecter des entrées dans des scénarios contextuels.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-143">TSF was designed for applications that need to inject input into context-aware scenarios.</span></span> <span data-ttu-id="c7cc5-144">Le modèle de contrôle [Text](uiauto-implementingtextandtextrange.md) , toutefois, est une solution en lecture seule destinée à fournir un accès optimisé à un magasin de texte pour les lecteurs d’écran et les appareils en braille.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-144">The [Text](uiauto-implementingtextandtextrange.md) control pattern, however, is a read-only solution that is intended to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="c7cc5-145">Les technologies accessibles qui requièrent un accès en lecture seule à un magasin de texte peuvent utiliser le modèle de contrôle Text, mais elles auront besoin des fonctionnalités de TSF pour les entrées contextuelles.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-145">Accessible technologies that require read-only access to a text store can use the Text control pattern, but will need the functionality of TSF for context-aware input.</span></span>

<span data-ttu-id="c7cc5-146">Pour plus d’informations, consultez [Text Services Framework](/windows/desktop/TSF/text-services-framework).</span><span class="sxs-lookup"><span data-stu-id="c7cc5-146">For more information, see [Text Services Framework](/windows/desktop/TSF/text-services-framework).</span></span>

## <a name="control-types"></a><span data-ttu-id="c7cc5-147">Types de contrôles</span><span class="sxs-lookup"><span data-stu-id="c7cc5-147">Control Types</span></span>

<span data-ttu-id="c7cc5-148">Le type de contrôle d' [édition](uiauto-supporteditcontroltype.md) UI Automation et le type de contrôle [document](uiauto-supportdocumentcontroltype.md) doivent prendre en charge le modèle de contrôle [Text](uiauto-implementingtextandtextrange.md) .</span><span class="sxs-lookup"><span data-stu-id="c7cc5-148">The UI Automation [Edit](uiauto-supporteditcontroltype.md) control type and [Document](uiauto-supportdocumentcontroltype.md) control type must support the [Text](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="c7cc5-149">Pour une meilleure accessibilité, Microsoft recommande que les types de contrôle d' [info-bulle](uiauto-supporttooltipcontroltype.md) et de texte prennent également en charge le modèle de contrôle Text, mais ce n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-149">For improved accessibility, Microsoft recommends that the [ToolTip](uiauto-supporttooltipcontroltype.md) and Text control types also support the Text control pattern, but it is not required.</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="c7cc5-150">Interfaces de fournisseur</span><span class="sxs-lookup"><span data-stu-id="c7cc5-150">Provider Interfaces</span></span>

<span data-ttu-id="c7cc5-151">Les fournisseurs UI Automation prennent en charge le modèle de contrôle [Text](uiauto-implementingtextandtextrange.md) pour un contrôle en implémentant les interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) et [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="c7cc5-151">UI Automation providers support the [Text](uiauto-implementingtextandtextrange.md) control pattern for a control by implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interfaces.</span></span> <span data-ttu-id="c7cc5-152">Ces interfaces exposent des informations d’attribut détaillées pour le texte dans le contrôle et fournissent des fonctionnalités de navigation robustes.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-152">These interfaces expose detailed attribute information for text in the control and provide robust navigational capabilities.</span></span>

<span data-ttu-id="c7cc5-153">Un fournisseur n’a pas besoin de prendre en charge tous les attributs de texte si le contrôle ne prend pas en charge un attribut particulier.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-153">A provider does not need to support all text attributes if the control lacks support for any particular attribute.</span></span>

<span data-ttu-id="c7cc5-154">Un fournisseur doit prendre en charge les méthodes [**ITextProvider :: GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) et [**ITextRangeProvider :: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) si le contrôle prend en charge la sélection de texte ou le positionnement du curseur de texte (ou signe insertion de système) dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-154">A provider must support the [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) and [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) methods if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="c7cc5-155">Si le contrôle ne prend pas en charge cette fonctionnalité, il n’a pas besoin de prendre en charge l’une de ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-155">If the control does not support this functionality, it does not need to support either of these methods.</span></span> <span data-ttu-id="c7cc5-156">Toutefois, le contrôle doit exposer le type de sélection de texte qu’il prend en charge en implémentant la propriété [**ITextProvider :: SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) .</span><span class="sxs-lookup"><span data-stu-id="c7cc5-156">However, the control must expose the type of text selection it supports by implementing the [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property.</span></span>

<span data-ttu-id="c7cc5-157">Un fournisseur doit toujours prendre en charge les constantes [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) , le **\_ caractère TextUnit** et le **\_ document TextUnit**, ainsi que les autres éléments qu’il est en mesure de prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-157">A provider must always support the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) constants, **TextUnit\_Character** and **TextUnit\_Document**, as well as any others it is capable of supporting.</span></span>

> [!Note]  
> <span data-ttu-id="c7cc5-158">Le fournisseur peut ignorer la prise en charge d’un [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) spécifique en reportant à la plus grande unité prise en charge dans l’ordre suivant : **TextUnit \_ character**, **TextUnit \_ format**, **TextUnit \_ Word**, **TextUnit \_ line**, **TextUnit \_ paragraphe**, **TextUnit \_ page** et TextUnit **\_ document**.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-158">The provider may skip support for a specific [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) by deferring to the next largest unit supported in the following order: **TextUnit\_Character**, **TextUnit\_Format**, **TextUnit\_Word**, **TextUnit\_Line**, **TextUnit\_Paragraph**, **TextUnit\_Page**, and **TextUnit\_Document**.</span></span>

 

## <a name="client-interfaces"></a><span data-ttu-id="c7cc5-159">Interfaces clientes</span><span class="sxs-lookup"><span data-stu-id="c7cc5-159">Client Interfaces</span></span>

<span data-ttu-id="c7cc5-160">Les applications clientes UI Automation utilisent les interfaces [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) et [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) pour accéder au contenu textuel d’un contrôle de texte.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-160">UI Automation client applications use the [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) and [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interfaces to access the textual content of a text control.</span></span> <span data-ttu-id="c7cc5-161">Les clients utilisent **IUIAutomationTextPattern** pour sélectionner des étendues de texte appelées *plages de texte* et pour récupérer des pointeurs vers des interfaces **IUIAutomationTextRange** pour les plages.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-161">Clients use **IUIAutomationTextPattern** to select spans of text called *text ranges*, and to retrieve pointers to **IUIAutomationTextRange** interfaces for the ranges.</span></span> <span data-ttu-id="c7cc5-162">L’interface **IUIAutomationTextRange** permet aux clients de manipuler la plage de texte et de récupérer des informations sur le texte de la plage, y compris des attributs tels que le nom de la police, la couleur de premier plan, le style de soulignement, etc.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-162">The **IUIAutomationTextRange** interface enables clients to manipulate the text range, and to retrieve information about the text in the range, including attributes such as font name, foreground color, underline style, and so on.</span></span> <span data-ttu-id="c7cc5-163">Pour plus d’informations, consultez [identificateurs d’attribut de texte](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="c7cc5-163">For more information, see [Text Attribute Identifiers](uiauto-textattribute-ids.md).</span></span>

## <a name="performance"></a><span data-ttu-id="c7cc5-164">Performances</span><span class="sxs-lookup"><span data-stu-id="c7cc5-164">Performance</span></span>

<span data-ttu-id="c7cc5-165">Le modèle de contrôle **Text** s’appuie sur des appels interprocessus pour la plupart de ses fonctionnalités, il ne fournit donc pas de mécanisme de mise en cache pour améliorer les performances lors du traitement du contenu.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-165">The **Text** control pattern relies on cross-process calls for most of its functionality, so it does not provide a caching mechanism to improve performance when it processes content.</span></span> <span data-ttu-id="c7cc5-166">D’autres modèles de contrôle de Microsoft UI Automation sont accessibles à l’aide de la méthode [**IUIAutomationElement :: GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) .</span><span class="sxs-lookup"><span data-stu-id="c7cc5-166">Other control patterns in Microsoft UI Automation can be accessed by using the [**IUIAutomationElement::GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) method.</span></span>

<span data-ttu-id="c7cc5-167">Une technique pour améliorer les performances consiste à s’assurer que les clients UI Automation tentent de récupérer des blocs de texte de taille modérée à l’aide de la méthode [**IUIAutomationTextRange :: gettext**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) .</span><span class="sxs-lookup"><span data-stu-id="c7cc5-167">One technique for improving performance is to ensure that UI Automation clients attempt to retrieve moderately sized blocks of text by using the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) method.</span></span> <span data-ttu-id="c7cc5-168">Par exemple, l’utilisation de **gettext** pour récupérer des caractères uniques entraînera des accès interprocessus pour chaque caractère, alors que la spécification d’une longueur maximale lors de l’appel de **gettext** entraînera un accès inter-processus, mais peut présenter une latence élevée selon la taille de la plage de texte.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-168">For example, using **GetText** to retrieve single characters will incur cross-process hits for each character, whereas not specifying a maximum length when calling **GetText** will incur one cross-process hit, but can have high latency depending on the size of the text range.</span></span>

## <a name="text-pattern-and-virtualized-embedded-objects"></a><span data-ttu-id="c7cc5-169">Modèle de texte et objets incorporés virtualisés</span><span class="sxs-lookup"><span data-stu-id="c7cc5-169">Text Pattern and Virtualized Embedded Objects</span></span>

<span data-ttu-id="c7cc5-170">Dans la mesure du possible, une implémentation de fournisseur de [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) et [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) doit prendre en charge l’intégralité du texte d’un document, y compris tout texte en dehors de la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-170">Whenever possible, a provider implementation of [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) should support the entire text of a document, including any text outside of the viewport.</span></span> <span data-ttu-id="c7cc5-171">Pour le texte hors écran ou les objets incorporés qui sont virtualisés, les fournisseurs doivent prendre en charge le [modèle de contrôle VirtualizedItem](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span><span class="sxs-lookup"><span data-stu-id="c7cc5-171">For off-screen text or embedded objects that are virtualized, providers should support the [VirtualizedItem control pattern](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span></span>

<span data-ttu-id="c7cc5-172">Si un document est virtualisé alors que le flux de texte entier est toujours disponible, la propriété [**ITextProvider ::D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) récupère une plage de texte qui comprend le document entier.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-172">If a document is virtualized while the entire text stream is still available, the [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property will retrieve a text range that includes the entire document.</span></span> <span data-ttu-id="c7cc5-173">Toutefois, l’appel de la méthode [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) permet de récupérer une collection d’objets virtualisés représentant tous les objets incorporés dans le document.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-173">However, calling the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method will retrieve a collection of virtualized objects that represent all embedded objects in the document.</span></span> <span data-ttu-id="c7cc5-174">Pour interagir avec un objet incorporé virtualisé, les clients doivent appeler la méthode [**IVirtualizedItemProvider :: réalise**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) , qui rend les éléments entièrement accessibles en tant qu’éléments UI Automation.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-174">To interact with a virtualized embedded object, clients must call the [**IVirtualizedItemProvider::Realize**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) method, which makes the items fully accessible as UI Automation elements.</span></span> <span data-ttu-id="c7cc5-175">Les clients doivent suivre un processus similaire pour travailler avec des éléments de grille dans une table incorporée dans laquelle une partie de la table est déconnectée de l’écran et virtualisée.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-175">Clients must follow a similar process to work with grid elements in an embedded table where a portion of the table is off-screen and virtualized.</span></span>

## <a name="using-the-custom-control-type-with-the-text-control-pattern"></a><span data-ttu-id="c7cc5-176">Utilisation du type de contrôle personnalisé avec le modèle de contrôle Text</span><span class="sxs-lookup"><span data-stu-id="c7cc5-176">Using the Custom Control Type with the Text Control Pattern</span></span>

<span data-ttu-id="c7cc5-177">Alors que le modèle de contrôle [Text](uiauto-implementingtextandtextrange.md) prend en charge de nombreux attributs de texte et objets incorporés, il n’est pas possible de définir à l’avance tous les éléments de document et types de présentation possibles.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-177">While the [Text](uiauto-implementingtextandtextrange.md) control pattern supports many text attributes and embedded objects, it is not possible to define in advance all possible document elements and presentation types.</span></span> <span data-ttu-id="c7cc5-178">Pour les éléments de document qui ne sont pas pris en charge par les attributs ou les types de contrôles standard existants, les fournisseurs peuvent utiliser les fonctionnalités d’extensibilité fournies par le type de contrôle **personnalisé** UI Automation.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-178">For document elements that are not supported by the existing attributes or standard control types, providers can use the extensibility features provided by the UI Automation **Custom** control type.</span></span>

<span data-ttu-id="c7cc5-179">Pour les applications et les interfaces utilisateur basées sur des présentations de page, la présentation de la limite et de la disposition de la « page » peut également être exprimée sous la forme d’un objet incorporé qui a un type de contrôle personnalisé (autrement dit, `LocalizedControlType="page"` ).</span><span class="sxs-lookup"><span data-stu-id="c7cc5-179">For applications and user interfaces that are based on page presentations, the boundary and layout presentation of "page" can also be expressed as an embedded object that has a custom control type (that is, `LocalizedControlType="page"`).</span></span> <span data-ttu-id="c7cc5-180">De cette façon, l’objet incorporé peut héberger d’autres éléments de page qui ne peuvent pas facilement faire partie du flux de texte du document, tels que les champs d’en-tête et de pied de page de chaque page, en tant qu’enfants de l’objet incorporé « page ».</span><span class="sxs-lookup"><span data-stu-id="c7cc5-180">That way, the embedded object can host other page elements that cannot easily be part of the document text stream, such as the header and footer fields of each page, as children of the "page" embedded object.</span></span> <span data-ttu-id="c7cc5-181">Chaque objet « page » peut également prendre en charge le modèle de contrôle [Text](uiauto-implementingtextandtextrange.md) de manière indépendante, ce qui fonctionne bien pour les applications telles que les outils de création pour les présentations de diaporama ou les environnements de publication de bureau basés sur une page.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-181">Alternatively, each "page" object can support the [Text](uiauto-implementingtextandtextrange.md) control pattern independently, which works well for applications such as authoring tools for slide show presentations, or page-based desktop publishing environments.</span></span>

## <a name="lifetime-of-a-text-range"></a><span data-ttu-id="c7cc5-182">Durée de vie d’une plage de texte</span><span class="sxs-lookup"><span data-stu-id="c7cc5-182">Lifetime of a Text Range</span></span>

<span data-ttu-id="c7cc5-183">Si possible, un fournisseur doit s’assurer que toutes les modifications de texte, telles que les suppressions, les insertions et les déplacements, sont reflétées dans la plage de texte associée.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-183">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range.</span></span> <span data-ttu-id="c7cc5-184">Si la mise à jour de la plage de texte n’est pas possible, le fournisseur doit déclencher un événement [**\_ \_ TextChangedEventId de texte UIA**](uiauto-event-ids.md) pour informer les clients que la plage de texte n’est plus valide et qu’une nouvelle doit être récupérée.</span><span class="sxs-lookup"><span data-stu-id="c7cc5-184">If updating the text range is not possible, the provider should raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event to notify clients that the text range is no longer valid and a new one must be retrieved.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c7cc5-185">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c7cc5-185">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="c7cc5-186">**Méthodologique**</span><span class="sxs-lookup"><span data-stu-id="c7cc5-186">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="c7cc5-187">Comment UI Automation prend en charge les objets incorporés</span><span class="sxs-lookup"><span data-stu-id="c7cc5-187">How UI Automation Supports Embedded Objects</span></span>](uiauto-textpattern-and-embedded-objects-overview.md)
</dt> <dt>

[<span data-ttu-id="c7cc5-188">Vue d'ensemble des modèles de contrôle UI Automation</span><span class="sxs-lookup"><span data-stu-id="c7cc5-188">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="c7cc5-189">Prise en charge d’UI Automation pour le contenu textuel</span><span class="sxs-lookup"><span data-stu-id="c7cc5-189">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="c7cc5-190">Utilisation de contrôles textuels</span><span class="sxs-lookup"><span data-stu-id="c7cc5-190">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)
</dt> <dt>

<span data-ttu-id="c7cc5-191">**Autres ressources**</span><span class="sxs-lookup"><span data-stu-id="c7cc5-191">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="c7cc5-192">Text Services Framework</span><span class="sxs-lookup"><span data-stu-id="c7cc5-192">Text Services Framework</span></span>](/windows/desktop/TSF/text-services-framework)
</dt> </dl>

 

 