---
title: Faire glisser le modèle de contrôle
description: Fournit des recommandations et des conventions pour implémenter le modèle de contrôle Drag à l’aide de IDragProvider, y compris des informations sur les propriétés et les méthodes. Le modèle de contrôle Drag est utilisé pour prendre en charge les contrôles glissables ou les contrôles avec des éléments glissables.
ms.assetid: 9853E9CB-D04B-4F67-8E9E-7F1F99BACEA7
keywords:
- UI Automation, implémenter le modèle de contrôle Drag
- UI Automation, faire glisser le modèle de contrôle
- UI Automation, IDragProvider
- IDragProvider
- implémentation des modèles de contrôle Drag d’UI Automation
- Faire glisser les modèles de contrôle
- modèles de contrôle, IDragProvider
- modèles de contrôle, implémenter UI Automation faire glisser
- modèles de contrôle, faites glisser
- interfaces, IDragProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548f0212eca37e1890596143f27e9af70e1fb19a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031461"
---
# <a name="drag-control-pattern"></a><span data-ttu-id="2ad6d-114">Faire glisser le modèle de contrôle</span><span class="sxs-lookup"><span data-stu-id="2ad6d-114">Drag Control Pattern</span></span>

<span data-ttu-id="2ad6d-115">Fournit des recommandations et des conventions pour implémenter le modèle de contrôle **Drag** à l’aide de [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), y compris des informations sur les propriétés et les méthodes.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-115">Provides guidelines and conventions for implementing the **Drag** control pattern by using [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), including information about properties and methods.</span></span> <span data-ttu-id="2ad6d-116">Le modèle de contrôle **Drag** est utilisé pour prendre en charge les contrôles glissables ou les contrôles avec des éléments glissables.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-116">The **Drag** control pattern is used to support draggable controls, or controls with draggable items.</span></span>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="2ad6d-117">Conventions et directives d'implémentation</span><span class="sxs-lookup"><span data-stu-id="2ad6d-117">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="2ad6d-118">Lorsque vous implémentez le modèle de contrôle **Drag** , utilisez les conventions et recommandations suivantes :</span><span class="sxs-lookup"><span data-stu-id="2ad6d-118">When implementing the **Drag** control pattern, use these guidelines and conventions:</span></span>

-   <span data-ttu-id="2ad6d-119">L’interface [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) prend en charge deux styles de glissement différents : le style source/cible et le style source uniquement.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-119">The [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) interface supports two different dragging styles: the source/target style, and the source-only style.</span></span> <span data-ttu-id="2ad6d-120">Vous devez choisir le style qui convient le mieux à vos scénarios de glisser-déplacer :</span><span class="sxs-lookup"><span data-stu-id="2ad6d-120">You need to choose the style that works best for your drag-and-drop scenarios:</span></span>
    -   <span data-ttu-id="2ad6d-121">**Style source/cible :** Chaque cible de déplacement possible est représentée par un élément qui implémente l’interface [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) .</span><span class="sxs-lookup"><span data-stu-id="2ad6d-121">**Source/target style:** Each possible drop target is represented by an element that implements the [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) interface.</span></span> <span data-ttu-id="2ad6d-122">Pendant une opération glisser, les événements Microsoft UI Automation proviennent de l’élément qui est glissé, et des éléments de la cible de déplacement.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-122">During a drag operation, Microsoft UI Automation events originate from the element that is being dragged, and from the drop-target elements.</span></span>
    -   <span data-ttu-id="2ad6d-123">**Style de la source uniquement :** Les cibles de dépôt ne sont pas représentées par les éléments UI Automation.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-123">**Source-only style:** Drop targets are not represented by UI Automation elements.</span></span> <span data-ttu-id="2ad6d-124">Pendant une opération glisser, les événements proviennent uniquement de l’élément qui est glissé.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-124">During a drag operation, events originate only from the element that is being dragged.</span></span>
-   <span data-ttu-id="2ad6d-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) est une interface en lecture seule destinée à la surveillance des opérations de glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) is a read-only interface intended for monitoring drag operations.</span></span> <span data-ttu-id="2ad6d-126">Vous ne pouvez pas l’utiliser pour contrôler une opération glisser.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-126">You cannot use it to control a drag operation.</span></span> <span data-ttu-id="2ad6d-127">Vous pouvez automatiser les opérations glisser-déplacer en envoyant une entrée de souris à un contrôle.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-127">You can automate drag operations by sending mouse input to a control.</span></span>
-   <span data-ttu-id="2ad6d-128">La propriété [**IDragProvider :: IsGrabbed**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) est requise.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-128">The [**IDragProvider::IsGrabbed**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) property is required.</span></span>
-   <span data-ttu-id="2ad6d-129">Les propriétés [**IDragProvider ::D ropeffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) et [**IDragProvider ::D ropeffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) sont requises pour une implémentation de style source uniquement et interdites pour une implémentation de style source/cible.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-129">The [**IDragProvider::DropEffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) and [**IDragProvider::DropEffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) properties are required for a source-only style implementation, and prohibited for a source/target style implementation.</span></span> <span data-ttu-id="2ad6d-130">Dans une implémentation de style source/cible, les éléments de cible de déplacement peuvent être interrogés pour leurs effets de suppression.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-130">In a source/target style implementation, drop-target elements can be queried for their drop effects.</span></span>
-   <span data-ttu-id="2ad6d-131">La propriété [**IDragProvider :: GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) représente le déplacement de plusieurs éléments.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-131">The [**IDragProvider::GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) property represents the dragging of multiple items.</span></span> <span data-ttu-id="2ad6d-132">Lorsque l’utilisateur commence l’opération glisser, vous devez créer un nouvel élément UI Automation pour servir d’élément source d’événement.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-132">When the user begins the drag operation, you need to create a new UI Automation element to serve as the event source element.</span></span> <span data-ttu-id="2ad6d-133">Ce nouvel élément déclenche tous les événements que l’élément source aurait déclenchés en mode source/cible ou source uniquement, alors qu’aucun des éléments en cours de glissement ne déclenche aucun événement.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-133">This new element fires all events that the source element would have fired in either the source/target or source-only mode, while none of the elements that are actually being dragged fire any events.</span></span> <span data-ttu-id="2ad6d-134">Lorsque l’opération glisser est terminée, détruisez l’élément source de l’événement.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-134">When the drag operation is complete, destroy the event source element.</span></span>
-   <span data-ttu-id="2ad6d-135">L’élément doit déclencher des événements de modification de propriété pour les propriétés **DropEffect** ([**UIA \_ DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) et **DropEffects** ([**UIA \_ DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) lorsqu’elles changent.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-135">The element must fire property-changed events for the **DropEffect** ([**UIA\_DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) and **DropEffects** ([**UIA\_DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) properties when they change.</span></span> <span data-ttu-id="2ad6d-136">Les événements de modification de propriété pour les autres propriétés sont autorisés, mais peuvent être déduits à partir des événements requis **DragStart** ([**UIA \_ Drag \_ DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA \_ Drag \_ DragCancelEventId**](uiauto-event-ids.md)) et **DragComplete** ([**UIA \_ Drag \_ DragCompleteEventId**](uiauto-event-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="2ad6d-136">Property-changed events for the other properties are allowed, but can be inferred from the required **DragStart** ([**UIA\_Drag\_DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA\_Drag\_DragCancelEventId**](uiauto-event-ids.md)), and **DragComplete** ([**UIA\_Drag\_DragCompleteEventId**](uiauto-event-ids.md)) events.</span></span>
-   

## <a name="required-members-for-idragprovider"></a><span data-ttu-id="2ad6d-137">Membres requis pour **IDragProvider**</span><span class="sxs-lookup"><span data-stu-id="2ad6d-137">Required Members for **IDragProvider**</span></span>

<span data-ttu-id="2ad6d-138">Les propriétés et méthodes suivantes sont requises pour implémenter l’interface [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) .</span><span class="sxs-lookup"><span data-stu-id="2ad6d-138">The following properties and methods are required for implementing the [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) interface.</span></span>



| <span data-ttu-id="2ad6d-139">Membres nécessaires</span><span class="sxs-lookup"><span data-stu-id="2ad6d-139">Required members</span></span>                                                                        | <span data-ttu-id="2ad6d-140">Type de membre</span><span class="sxs-lookup"><span data-stu-id="2ad6d-140">Member type</span></span> | <span data-ttu-id="2ad6d-141">Notes</span><span class="sxs-lookup"><span data-stu-id="2ad6d-141">Notes</span></span>                                                                         |
|-----------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------|
| [<span data-ttu-id="2ad6d-142">**IsGrabbed**</span><span class="sxs-lookup"><span data-stu-id="2ad6d-142">**IsGrabbed**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed)                                     | <span data-ttu-id="2ad6d-143">Propriété</span><span class="sxs-lookup"><span data-stu-id="2ad6d-143">Property</span></span>    | <span data-ttu-id="2ad6d-144">Aucun</span><span class="sxs-lookup"><span data-stu-id="2ad6d-144">None</span></span>                                                                          |
| [<span data-ttu-id="2ad6d-145">**DropEffect**</span><span class="sxs-lookup"><span data-stu-id="2ad6d-145">**DropEffect**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect)                                   | <span data-ttu-id="2ad6d-146">Propriété</span><span class="sxs-lookup"><span data-stu-id="2ad6d-146">Property</span></span>    | <span data-ttu-id="2ad6d-147">Requis pour une implémentation du style source uniquement.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-147">Required for an implementation of the source-only style.</span></span>                      |
| [<span data-ttu-id="2ad6d-148">**DropEffects**</span><span class="sxs-lookup"><span data-stu-id="2ad6d-148">**DropEffects**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects)                                 | <span data-ttu-id="2ad6d-149">Propriété</span><span class="sxs-lookup"><span data-stu-id="2ad6d-149">Property</span></span>    | <span data-ttu-id="2ad6d-150">Obligatoire s’il y a plus d’un effet de dépôt possible pour l’élément retiré.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-150">Required if there is more than one possible drop effect for the grabbed item.</span></span> |
| [<span data-ttu-id="2ad6d-151">**GetGrabbedItems**</span><span class="sxs-lookup"><span data-stu-id="2ad6d-151">**GetGrabbedItems**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems)                         | <span data-ttu-id="2ad6d-152">Méthode</span><span class="sxs-lookup"><span data-stu-id="2ad6d-152">Method</span></span>      | <span data-ttu-id="2ad6d-153">Requis pour une opération glisser sur plusieurs éléments.</span><span class="sxs-lookup"><span data-stu-id="2ad6d-153">Required for a multiple-item drag operation.</span></span>                                  |
| [<span data-ttu-id="2ad6d-154">**UIA \_ faire glisser \_ DragStartEventId**</span><span class="sxs-lookup"><span data-stu-id="2ad6d-154">**UIA\_Drag\_DragStartEventId**</span></span>](uiauto-event-ids.md)       | <span data-ttu-id="2ad6d-155">Événement</span><span class="sxs-lookup"><span data-stu-id="2ad6d-155">Event</span></span>       | <span data-ttu-id="2ad6d-156">Aucun</span><span class="sxs-lookup"><span data-stu-id="2ad6d-156">None</span></span>                                                                          |
| [<span data-ttu-id="2ad6d-157">**UIA \_ faire glisser \_ DragCancelEventId**</span><span class="sxs-lookup"><span data-stu-id="2ad6d-157">**UIA\_Drag\_DragCancelEventId**</span></span>](uiauto-event-ids.md)     | <span data-ttu-id="2ad6d-158">Événement</span><span class="sxs-lookup"><span data-stu-id="2ad6d-158">Event</span></span>       | <span data-ttu-id="2ad6d-159">Aucun</span><span class="sxs-lookup"><span data-stu-id="2ad6d-159">None</span></span>                                                                          |
| [<span data-ttu-id="2ad6d-160">**UIA \_ faire glisser \_ DragCompleteEventId**</span><span class="sxs-lookup"><span data-stu-id="2ad6d-160">**UIA\_Drag\_DragCompleteEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="2ad6d-161">Événement</span><span class="sxs-lookup"><span data-stu-id="2ad6d-161">Event</span></span>       | <span data-ttu-id="2ad6d-162">Aucun</span><span class="sxs-lookup"><span data-stu-id="2ad6d-162">None</span></span>                                                                          |



 

## <a name="related-topics"></a><span data-ttu-id="2ad6d-163">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="2ad6d-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2ad6d-164">Types de contrôle et leurs modèles de contrôle pris en charge</span><span class="sxs-lookup"><span data-stu-id="2ad6d-164">Control Types and their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="2ad6d-165">Modèle de contrôle DropTarget</span><span class="sxs-lookup"><span data-stu-id="2ad6d-165">DropTarget Control Pattern</span></span>](/windows/desktop/WinAuto/uiauto-implementingdroptarget)
</dt> <dt>

[<span data-ttu-id="2ad6d-166">Vue d'ensemble des modèles de contrôle UI Automation</span><span class="sxs-lookup"><span data-stu-id="2ad6d-166">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="2ad6d-167">Vue d’ensemble de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="2ad6d-167">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> <dt>

[<span data-ttu-id="2ad6d-168">Prise en charge d’UI Automation pour le glisser-déplacer</span><span class="sxs-lookup"><span data-stu-id="2ad6d-168">UI Automation Support for Drag-and-Drop</span></span>](ui-automation-support-for-drag-and-drop.md)
</dt> </dl>

 

 