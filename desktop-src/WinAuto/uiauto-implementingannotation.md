---
title: Annotation (modèle de contrôle)
description: Fournit des instructions et des conventions pour l’implémentation de IAnnotationProvider, y compris des informations sur les propriétés et les méthodes. Le modèle de contrôle d’annotation est utilisé pour exposer les propriétés d’une annotation dans un document.
ms.assetid: 5A334991-66AF-4A82-9A09-09D5BDAAA771
keywords:
- UI Automation, implémenter le modèle de contrôle d’annotation
- UI Automation, modèle de contrôle d’annotation
- UI Automation, IAnnotationProvider
- IAnnotationProvider
- implémentation du modèle de contrôle d’annotation UI Automation
- annotation (modèle de contrôle)
- modèles de contrôle, IAnnotationProvider
- modèles de contrôle, implémenter une annotation UI Automation
- modèles de contrôle, annotation
- interfaces, IAnnotationProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c1a0441816e548faaa9076b3a9717c0aa76f08a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106509268"
---
# <a name="annotation-control-pattern"></a><span data-ttu-id="4ba68-114">Annotation (modèle de contrôle)</span><span class="sxs-lookup"><span data-stu-id="4ba68-114">Annotation Control Pattern</span></span>

<span data-ttu-id="4ba68-115">Fournit des instructions et des conventions pour l’implémentation de [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), y compris des informations sur les propriétés et les méthodes.</span><span class="sxs-lookup"><span data-stu-id="4ba68-115">Describes guidelines and conventions for implementing [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), including information about properties and methods.</span></span> <span data-ttu-id="4ba68-116">Le modèle de contrôle d' **annotation** est utilisé pour exposer les propriétés d’une annotation dans un document.</span><span class="sxs-lookup"><span data-stu-id="4ba68-116">The **Annotation** control pattern is used to expose the properties of an annotation in a document.</span></span>

<span data-ttu-id="4ba68-117">Par exemple, une bulle de commentaire se trouve dans la marge d’un document et est connectée à un texte de document ou à une cellule de feuille de calcul.</span><span class="sxs-lookup"><span data-stu-id="4ba68-117">One example is a comment balloon that is in the margin of a document and is connected to some document text or a spreadsheet cell.</span></span>

<span data-ttu-id="4ba68-118">L’illustration suivante montre un exemple d’annotation.</span><span class="sxs-lookup"><span data-stu-id="4ba68-118">The following illustration shows an example of an annotation.</span></span> <span data-ttu-id="4ba68-119">Pour obtenir des exemples de contrôles qui implémentent ce modèle de contrôle, consultez [types de contrôle et leurs modèles de contrôle pris en charge](uiauto-controlpatternmapping.md).</span><span class="sxs-lookup"><span data-stu-id="4ba68-119">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

![capture d’écran montrant un commentaire baloon dans un document](images/annotation.png)

<span data-ttu-id="4ba68-121">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="4ba68-121">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="4ba68-122">Conventions et directives d'implémentation</span><span class="sxs-lookup"><span data-stu-id="4ba68-122">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="4ba68-123">Membres requis pour **IAnnotationProvider**</span><span class="sxs-lookup"><span data-stu-id="4ba68-123">Required Members for **IAnnotationProvider**</span></span>](#required-members-for-iannotationprovider)
-   [<span data-ttu-id="4ba68-124">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="4ba68-124">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="4ba68-125">Conventions et directives d'implémentation</span><span class="sxs-lookup"><span data-stu-id="4ba68-125">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="4ba68-126">Lorsque vous implémentez le modèle de contrôle d' **annotation** , notez les conventions et recommandations suivantes :</span><span class="sxs-lookup"><span data-stu-id="4ba68-126">When implementing the **Annotation** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="4ba68-127">Il existe de nombreux types d’annotations.</span><span class="sxs-lookup"><span data-stu-id="4ba68-127">There are many different kinds of annotations.</span></span> <span data-ttu-id="4ba68-128">Le fichier d’en-tête UIAutomationClient. h définit un ensemble de valeurs constantes nommées qui identifient les types d’annotations pris en charge par Microsoft UI Automation.</span><span class="sxs-lookup"><span data-stu-id="4ba68-128">The UIAutomationClient.h header file defines a set of named constant values that identify the types of annotations that Microsoft UI Automation supports.</span></span> <span data-ttu-id="4ba68-129">Pour plus d’informations, consultez [**identificateurs de type d’annotation**](uiauto-annotation-type-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="4ba68-129">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>
-   <span data-ttu-id="4ba68-130">Si vous utilisez [**AnnotationType \_ Unknown**](uiauto-annotation-type-identifiers.md), vous devez implémenter la propriété [**IAnnotationProvider :: AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) pour permettre aux clients de découvrir le nom du type d’annotation.</span><span class="sxs-lookup"><span data-stu-id="4ba68-130">If you use [**AnnotationType\_Unknown**](uiauto-annotation-type-identifiers.md), you must implement the [**IAnnotationProvider::AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) property to enable clients to discover the name of the annotation type.</span></span> <span data-ttu-id="4ba68-131">Vous n’avez pas besoin d’implémenter **AnnotationTypeName** pour un type d’annotation standard, car UI Automation fournit un nom par défaut, mais vous pouvez l’implémenter si vous devez remplacer le nom par défaut.</span><span class="sxs-lookup"><span data-stu-id="4ba68-131">You do not need to implement **AnnotationTypeName** for a standard annotation type because UI Automation provides a default name, but you can implement it if you need to override the default name.</span></span>
-   <span data-ttu-id="4ba68-132">La propriété [**IAnnotationProvider :: Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) est facultative.</span><span class="sxs-lookup"><span data-stu-id="4ba68-132">The [**IAnnotationProvider::Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) property is optional.</span></span>
-   <span data-ttu-id="4ba68-133">La propriété [**IAnnotationProvider ::D atetime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) est facultative.</span><span class="sxs-lookup"><span data-stu-id="4ba68-133">The [**IAnnotationProvider::DateTime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) property is optional.</span></span>
-   <span data-ttu-id="4ba68-134">La propriété [**IAnnotationProvider :: target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) est obligatoire, car elle lie une annotation à un élément d’interface utilisateur, ce qui permet à un client de naviguer de l’annotation vers l’élément d’interface utilisateur auquel l’annotation fait référence.</span><span class="sxs-lookup"><span data-stu-id="4ba68-134">The [**IAnnotationProvider::Target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) property is required because it links an annotation to a UI element, enabling a client to navigate from the annotation back to the UI element to which the annotation refers.</span></span>
-   <span data-ttu-id="4ba68-135">Étant donné que les annotations peuvent prendre de nombreuses formes, l’interface [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) ne définit pas de propriété pour stocker la valeur ou le texte d’une annotation.</span><span class="sxs-lookup"><span data-stu-id="4ba68-135">Because annotations can take many different forms, the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface does not define a property for storing the value or text of an annotation.</span></span> <span data-ttu-id="4ba68-136">Une annotation simple doit exposer l’interface [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) , et la propriété [**IValueProvider :: value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) doit retourner une valeur en lecture seule qui spécifie le texte de l’annotation.</span><span class="sxs-lookup"><span data-stu-id="4ba68-136">A simple annotation should expose the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface, and the [**IValueProvider::Value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) property should return a read-only value that specifies the annotation text.</span></span> <span data-ttu-id="4ba68-137">Une annotation plus riche doit exposer l’interface [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) pour fournir du texte plus riche aux clients.</span><span class="sxs-lookup"><span data-stu-id="4ba68-137">A richer annotation should expose the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface to provide richer text to clients.</span></span>
-   <span data-ttu-id="4ba68-138">La navigation à partir d’un élément d’interface utilisateur vers une annotation sur l’élément dépend du type d’élément qui est annoté, comme suit :</span><span class="sxs-lookup"><span data-stu-id="4ba68-138">Navigating from a UI element to an annotation on the element depends on the kind of element being annotated, as follows:</span></span>
    -   <span data-ttu-id="4ba68-139">Pour les cellules de feuille de calcul, implémentez la méthode [**ISpreadsheetItemProvider :: GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) pour faire référence à l’annotation.</span><span class="sxs-lookup"><span data-stu-id="4ba68-139">For spreadsheet cells, implement the [**ISpreadsheetItemProvider::GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) method to refer to the annotation.</span></span>
    -   <span data-ttu-id="4ba68-140">Pour le contenu textuel, implémentez l’attribut de texte [**AnnotationObjects**](uiauto-textattribute-ids.md) sur l’interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) pour faire référence à l’annotation.</span><span class="sxs-lookup"><span data-stu-id="4ba68-140">For textual content, implement the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute on the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface to refer to the annotation.</span></span>
-   <span data-ttu-id="4ba68-141">Certains types d’annotations ne nécessitent pas une implémentation complète de l’interface [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) .</span><span class="sxs-lookup"><span data-stu-id="4ba68-141">Some kinds of annotations do not require a full implementation of the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span> <span data-ttu-id="4ba68-142">Par exemple, un indicateur d’erreur orthographique simple peut être représenté en faisant en sorte que l’interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) retourne un attribut [**AnnotationTypes**](uiauto-textattribute-ids.md) Text de [**AnnotationType \_ SpellingError**](uiauto-annotation-type-identifiers.md)et une valeur null pour l’attribut Text [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="4ba68-142">For example, a simple spelling-error indicator could be represented by having the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface return an [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute of [**AnnotationType\_SpellingError**](uiauto-annotation-type-identifiers.md), and a null value for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
-   <span data-ttu-id="4ba68-143">Il peut être utile d’implémenter l’interface [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) sur un élément d’interface utilisateur qui n’est pas visible.</span><span class="sxs-lookup"><span data-stu-id="4ba68-143">It can be useful to implement the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface on a UI element that is not visible.</span></span> <span data-ttu-id="4ba68-144">Par exemple, vous pouvez créer un élément UI Automation non visible qui implémente **IAnnotationProvider** pour fournir des informations étendues sur une erreur de grammaire.</span><span class="sxs-lookup"><span data-stu-id="4ba68-144">For example, you could create a non-visible UI Automation element that implements **IAnnotationProvider** to provide extended information about a grammar error.</span></span>
-   <span data-ttu-id="4ba68-145">Les annotations dans un contrôle textuel peuvent être complexes si le contrôle contient des commentaires qui se chevauchent.</span><span class="sxs-lookup"><span data-stu-id="4ba68-145">Annotations in a text-based control can be complex if the control contains overlapping comments.</span></span> <span data-ttu-id="4ba68-146">Utilisez les instructions suivantes pour gérer les annotations complexes :</span><span class="sxs-lookup"><span data-stu-id="4ba68-146">Use the following guidelines to handle complex annotations:</span></span>
    -   <span data-ttu-id="4ba68-147">Une plage de texte sans annotations doit retourner un tableau vide pour l’attribut de texte [**AnnotationTypes**](uiauto-textattribute-ids.md) et un tableau vide pour l’attribut de texte [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="4ba68-147">A text range with no annotations should return an empty array for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an empty array for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="4ba68-148">Une plage de texte avec une annotation doit retourner un tableau d’une valeur entière pour l’attribut [**AnnotationTypes**](uiauto-textattribute-ids.md) Text et un tableau d’une interface [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) pour l’attribut Text [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="4ba68-148">A text range with one annotation should return an array of one integer value for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of one [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="4ba68-149">Une plage de texte avec plusieurs annotations doit retourner un tableau de plusieurs valeurs entières pour l’attribut [**AnnotationTypes**](uiauto-textattribute-ids.md) Text et un tableau d’un nombre correspondant d’interfaces [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) pour l’attribut Text [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="4ba68-149">A text range with multiple annotations should return an array of multiple integer values for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of a matching number of [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interfaces for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="4ba68-150">Une plage de texte avec des annotations variables, telle qu’une plage avec du texte annoté et non annoté, doit retourner la propriété [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) pour [**AnnotationTypes**](uiauto-textattribute-ids.md) et [**AnnotationObjects**](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="4ba68-150">A text range with varying annotations, such as a range with both annotated and non-annotated text, should return the [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) property for both [**AnnotationTypes**](uiauto-textattribute-ids.md) and [**AnnotationObjects**](uiauto-textattribute-ids.md).</span></span> <span data-ttu-id="4ba68-151">Un client recevant cette réponse peut subdiviser la plage de texte pour Rechercher l’endroit où les annotations commencent et se terminent.</span><span class="sxs-lookup"><span data-stu-id="4ba68-151">A client receiving this response can subdivide the text range to find where the annotations begin and end.</span></span>

## <a name="required-members-for-iannotationprovider"></a><span data-ttu-id="4ba68-152">Membres requis pour **IAnnotationProvider**</span><span class="sxs-lookup"><span data-stu-id="4ba68-152">Required Members for **IAnnotationProvider**</span></span>

<span data-ttu-id="4ba68-153">Les propriétés suivantes sont requises pour implémenter l’interface [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) .</span><span class="sxs-lookup"><span data-stu-id="4ba68-153">The following properties are required for implementing the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span>



| <span data-ttu-id="4ba68-154">Membres nécessaires</span><span class="sxs-lookup"><span data-stu-id="4ba68-154">Required members</span></span>                                                                | <span data-ttu-id="4ba68-155">Type de membre</span><span class="sxs-lookup"><span data-stu-id="4ba68-155">Member type</span></span> | <span data-ttu-id="4ba68-156">Notes</span><span class="sxs-lookup"><span data-stu-id="4ba68-156">Notes</span></span> |
|---------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="4ba68-157">**AnnotationTypeId**</span><span class="sxs-lookup"><span data-stu-id="4ba68-157">**AnnotationTypeId**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypeid)     | <span data-ttu-id="4ba68-158">Propriété</span><span class="sxs-lookup"><span data-stu-id="4ba68-158">Property</span></span>    | <span data-ttu-id="4ba68-159">Aucun</span><span class="sxs-lookup"><span data-stu-id="4ba68-159">None.</span></span> |
| [<span data-ttu-id="4ba68-160">**AnnotationTypeName**</span><span class="sxs-lookup"><span data-stu-id="4ba68-160">**AnnotationTypeName**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) | <span data-ttu-id="4ba68-161">Propriété</span><span class="sxs-lookup"><span data-stu-id="4ba68-161">Property</span></span>    | <span data-ttu-id="4ba68-162">Aucun</span><span class="sxs-lookup"><span data-stu-id="4ba68-162">None.</span></span> |
| [<span data-ttu-id="4ba68-163">**Auteur**</span><span class="sxs-lookup"><span data-stu-id="4ba68-163">**Author**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author)                         | <span data-ttu-id="4ba68-164">Propriété</span><span class="sxs-lookup"><span data-stu-id="4ba68-164">Property</span></span>    | <span data-ttu-id="4ba68-165">Aucun</span><span class="sxs-lookup"><span data-stu-id="4ba68-165">None.</span></span> |
| [<span data-ttu-id="4ba68-166">**DateTime**</span><span class="sxs-lookup"><span data-stu-id="4ba68-166">**DateTime**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime)                     | <span data-ttu-id="4ba68-167">Propriété</span><span class="sxs-lookup"><span data-stu-id="4ba68-167">Property</span></span>    | <span data-ttu-id="4ba68-168">Aucun</span><span class="sxs-lookup"><span data-stu-id="4ba68-168">None.</span></span> |
| [<span data-ttu-id="4ba68-169">**Indicatif**</span><span class="sxs-lookup"><span data-stu-id="4ba68-169">**Target**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target)                         | <span data-ttu-id="4ba68-170">Propriété</span><span class="sxs-lookup"><span data-stu-id="4ba68-170">Property</span></span>    | <span data-ttu-id="4ba68-171">Aucun</span><span class="sxs-lookup"><span data-stu-id="4ba68-171">None.</span></span> |



 

<span data-ttu-id="4ba68-172">Ce modèle de contrôle n’est associé aucun événement.</span><span class="sxs-lookup"><span data-stu-id="4ba68-172">This control pattern has no associated events.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4ba68-173">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="4ba68-173">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4ba68-174">Types de contrôle et leurs modèles de contrôle pris en charge</span><span class="sxs-lookup"><span data-stu-id="4ba68-174">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="4ba68-175">Vue d'ensemble des modèles de contrôle UI Automation</span><span class="sxs-lookup"><span data-stu-id="4ba68-175">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="4ba68-176">Vue d’ensemble de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="4ba68-176">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 