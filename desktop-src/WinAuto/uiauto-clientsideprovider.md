---
title: Implémentation d’un fournisseur UI Automation Client-Side (proxy)
description: Cette rubrique explique comment écrire un fournisseur proxy pour un contrôle non pris en charge et l’ajouter à la liste des proxies utilisés par les applications clientes.
ms.assetid: c66f4a7b-0a12-4c65-a3e9-1c826d54ac6b
keywords:
- UI Automation, implémentation du fournisseur côté client
- UI Automation, implémentation du fournisseur
- UI Automation, implémentation de fournisseurs côté client
- UI Automation, implémenter des fournisseurs
- UI Automation, proxies
- proxies
- fournisseurs côté client
- fournisseurs, implémenter
- implémentation des fournisseurs côté client
- implémenter des fournisseurs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e2bdb4a94ba6e693792508de5c573317299b0d3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031328"
---
# <a name="implementing-a-client-side-proxy-ui-automation-provider"></a><span data-ttu-id="6d23a-113">Implémentation d’un fournisseur UI Automation Client-Side (proxy)</span><span class="sxs-lookup"><span data-stu-id="6d23a-113">Implementing a Client-Side (Proxy) UI Automation Provider</span></span>

<span data-ttu-id="6d23a-114">Microsoft UI Automation fournit un ensemble de proxies pour la plupart des contrôles standard, tels que ceux utilisés dans les applications Microsoft Win32, Windows Forms et Windows Presentation Foundation (WPF).</span><span class="sxs-lookup"><span data-stu-id="6d23a-114">Microsoft UI Automation supplies a set of proxies for most standard controls, such as those used in Microsoft Win32, Windows Forms, and Windows Presentation Foundation (WPF) applications.</span></span> <span data-ttu-id="6d23a-115">Toutefois, de nombreux contrôles personnalisés et contrôles tiers n’implémentent pas les fournisseurs UI Automation natifs.</span><span class="sxs-lookup"><span data-stu-id="6d23a-115">However, many custom controls and third party controls do not implement native UI Automation providers.</span></span> <span data-ttu-id="6d23a-116">Pour être accessibles aux applications clientes UI Automation, ces contrôles doivent être fournis avec les fournisseurs côté client, également appelés *fournisseurs proxy* *ou* proxys.</span><span class="sxs-lookup"><span data-stu-id="6d23a-116">To be accessible to UI Automation client applications, these controls must be furnished with client-side providers, also known as *proxy providers*, or *proxies*.</span></span>

<span data-ttu-id="6d23a-117">Cette rubrique explique comment écrire un fournisseur proxy pour un contrôle non pris en charge et l’ajouter à la liste des proxies utilisés par les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="6d23a-117">This topic describes how to write a proxy provider for an unsupported control and add it to the list of proxies used by client applications.</span></span> <span data-ttu-id="6d23a-118">Il contient les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="6d23a-118">It includes the following topics:</span></span>

-   [<span data-ttu-id="6d23a-119">Qu’est-ce qu’un proxy ?</span><span class="sxs-lookup"><span data-stu-id="6d23a-119">What is a Proxy?</span></span>](#what-is-a-proxy)
-   [<span data-ttu-id="6d23a-120">Qu’est-ce qu’une fabrique de proxy ?</span><span class="sxs-lookup"><span data-stu-id="6d23a-120">What is a Proxy Factory?</span></span>](#what-is-a-proxy-factory)
-   [<span data-ttu-id="6d23a-121">Mappage de la fabrique proxy</span><span class="sxs-lookup"><span data-stu-id="6d23a-121">Proxy Factory Mapping</span></span>](#proxy-factory-mapping)
-   [<span data-ttu-id="6d23a-122">Gestion des proxies par défaut</span><span class="sxs-lookup"><span data-stu-id="6d23a-122">Managing Default Proxies</span></span>](#managing-default-proxies)
-   [<span data-ttu-id="6d23a-123">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="6d23a-123">Related topics</span></span>](#related-topics)

<span data-ttu-id="6d23a-124">Pour obtenir des exemples de code qui montrent comment implémenter des fournisseurs de proxy, consultez [les rubriques de procédures pour les fournisseurs UI Automation](uiauto-howto-topics-for-uiautomation-providers.md).</span><span class="sxs-lookup"><span data-stu-id="6d23a-124">For code examples that show how to implement proxy providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="what-is-a-proxy"></a><span data-ttu-id="6d23a-125">Qu’est-ce qu’un proxy ?</span><span class="sxs-lookup"><span data-stu-id="6d23a-125">What is a Proxy?</span></span>

<span data-ttu-id="6d23a-126">Un fournisseur côté client, ou proxy, est un objet qui implémente l’interface [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) pour le compte d’un contrôle qui n’a pas d’implémentation **IRawElementProviderSimple** propre.</span><span class="sxs-lookup"><span data-stu-id="6d23a-126">A client-side provider, or proxy, is an object that implements the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface on behalf of a control that does not have an **IRawElementProviderSimple** implementation of its own.</span></span> <span data-ttu-id="6d23a-127">Sans proxy, ce type de contrôle est largement opaque pour l’Automation d’interface utilisateur, qui peut fournir uniquement les informations de base disponibles à partir du handle de fenêtre (**HWND**), telles que l’emplacement du contrôle.</span><span class="sxs-lookup"><span data-stu-id="6d23a-127">Without a proxy, such a control is largely opaque to UI Automation, which can supply only basic information available from the window handle (**HWND**), such as the control location.</span></span>

## <a name="what-is-a-proxy-factory"></a><span data-ttu-id="6d23a-128">Qu’est-ce qu’une fabrique de proxy ?</span><span class="sxs-lookup"><span data-stu-id="6d23a-128">What is a Proxy Factory?</span></span>

<span data-ttu-id="6d23a-129">Chaque proxy requiert une *fabrique de proxy* correspondante, qui est un objet qui expose l’interface [**IUIAutomationProxyFactory**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactory) .</span><span class="sxs-lookup"><span data-stu-id="6d23a-129">Each proxy requires a corresponding *proxy factory*, which is an object that exposes the [**IUIAutomationProxyFactory**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactory) interface.</span></span> <span data-ttu-id="6d23a-130">UI Automation gère une table interne d' *entrées de fabrique proxy*, chacune contenant une référence à la fabrique de proxy pour chaque proxy et un ensemble de conditions.</span><span class="sxs-lookup"><span data-stu-id="6d23a-130">UI Automation maintains an internal table of *proxy factory entries*, each of which contains a reference to the proxy factory for each proxy, and a set of conditions.</span></span> <span data-ttu-id="6d23a-131">Quand UI Automation rencontre un contrôle qui n’a pas d’implémentation [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) native, il recherche une entrée de fabrique proxy dont les conditions indiquent qu’il prend en charge le contrôle.</span><span class="sxs-lookup"><span data-stu-id="6d23a-131">When UI Automation encounters a control that does not have a native [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) implementation, it searches for a proxy factory entry whose conditions indicate that it supports the control.</span></span> <span data-ttu-id="6d23a-132">UI Automation effectue des recherches dans la table à partir du début et, lorsqu’il trouve une entrée correspondante, UI Automation appelle la méthode [**IUIAutomationProxyFactory :: CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider) de la fabrique.</span><span class="sxs-lookup"><span data-stu-id="6d23a-132">UI Automation searches the table from the beginning, and when it finds a matching entry, UI Automation calls the factory's [**IUIAutomationProxyFactory::CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider) method.</span></span> <span data-ttu-id="6d23a-133">Si le proxy correspondant est correctement créé, UI Automation arrête la recherche et utilise l’objet proxy nouvellement créé. dans le cas contraire, UI Automation continue la recherche.</span><span class="sxs-lookup"><span data-stu-id="6d23a-133">If the matching proxy is successfully created, the UI Automation stops searching and uses the newly created proxy object; otherwise, UI Automation continues searching.</span></span>

<span data-ttu-id="6d23a-134">Une application cliente crée une instance d’une entrée de fabrique proxy à l’aide de la méthode [**IUIAutomation :: CreateProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createproxyfactoryentry) , qui retourne un pointeur d’interface [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) .</span><span class="sxs-lookup"><span data-stu-id="6d23a-134">A client application creates an instance of a proxy factory entry by using the [**IUIAutomation::CreateProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createproxyfactoryentry) method, which returns an [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) interface pointer.</span></span> <span data-ttu-id="6d23a-135">Les clients utilisent des méthodes exposées par **IUIAutomationProxyFactoryEntry** pour spécifier l’ensemble de conditions que la fabrique de proxy utilise pour créer le proxy.</span><span class="sxs-lookup"><span data-stu-id="6d23a-135">Clients use methods exposed by **IUIAutomationProxyFactoryEntry** to specify the set of conditions that the proxy factory uses for creating the proxy.</span></span>

<span data-ttu-id="6d23a-136">Quand il appelle [**IUIAutomationProxyFactory :: CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider), UI Automation transmet les paramètres que l’objet de fabrique proxy peut utiliser pour déterminer si le proxy prend correctement en charge le contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d23a-136">When it calls [**IUIAutomationProxyFactory::CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider), UI Automation passes parameters that the proxy factory object can use to determine whether the proxy adequately supports the custom control.</span></span> <span data-ttu-id="6d23a-137">Si c’est le cas, la fabrique de proxy crée une instance du proxy et retourne le pointeur d’interface [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) ; Sinon, elle retourne un pointeur **null** .</span><span class="sxs-lookup"><span data-stu-id="6d23a-137">If so, the proxy factory creates an instance of the proxy and returns the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface pointer; otherwise, it returns a **NULL** pointer.</span></span>

## <a name="proxy-factory-mapping"></a><span data-ttu-id="6d23a-138">Mappage de la fabrique proxy</span><span class="sxs-lookup"><span data-stu-id="6d23a-138">Proxy Factory Mapping</span></span>

<span data-ttu-id="6d23a-139">Par défaut, UI Automation effectue une recherche dans la table de fabrique de proxy dans l’ordre suivant.</span><span class="sxs-lookup"><span data-stu-id="6d23a-139">By default, UI Automation searches through the proxy factory table in the following order.</span></span>



| <span data-ttu-id="6d23a-140">Commande</span><span class="sxs-lookup"><span data-stu-id="6d23a-140">Order</span></span> | <span data-ttu-id="6d23a-141">Proxy</span><span class="sxs-lookup"><span data-stu-id="6d23a-141">Proxy</span></span>                        | <span data-ttu-id="6d23a-142">Description</span><span class="sxs-lookup"><span data-stu-id="6d23a-142">Description</span></span>                                                                      |
|-------|------------------------------|----------------------------------------------------------------------------------|
| <span data-ttu-id="6d23a-143">1</span><span class="sxs-lookup"><span data-stu-id="6d23a-143">1</span></span>     | <span data-ttu-id="6d23a-144">Microsoft : proxy sans contrôle</span><span class="sxs-lookup"><span data-stu-id="6d23a-144">Microsoft: Non-Control Proxy</span></span> | <span data-ttu-id="6d23a-145">Pour Windows avec le nom de classe exact ou le nom de la classe de base « ComboBoxEx32 ».</span><span class="sxs-lookup"><span data-stu-id="6d23a-145">For windows with the exact class name or base class name "ComboBoxEx32".</span></span>         |
| <span data-ttu-id="6d23a-146">2</span><span class="sxs-lookup"><span data-stu-id="6d23a-146">2</span></span>     | <span data-ttu-id="6d23a-147">Microsoft : proxy sans contrôle</span><span class="sxs-lookup"><span data-stu-id="6d23a-147">Microsoft: Non-Control Proxy</span></span> | <span data-ttu-id="6d23a-148">Pour Windows avec le nom de classe exact ou le nom de la classe de base « WorkerW ».</span><span class="sxs-lookup"><span data-stu-id="6d23a-148">For windows with the exact class name or base class name "WorkerW".</span></span>              |
| <span data-ttu-id="6d23a-149">3</span><span class="sxs-lookup"><span data-stu-id="6d23a-149">3</span></span>     | <span data-ttu-id="6d23a-150">Microsoft : proxy sans contrôle</span><span class="sxs-lookup"><span data-stu-id="6d23a-150">Microsoft: Non-Control Proxy</span></span> | <span data-ttu-id="6d23a-151">Pour Windows avec le nom de classe exact ou le nom de la classe de base « SHELLDLL \_ DefView ».</span><span class="sxs-lookup"><span data-stu-id="6d23a-151">For windows with the exact class name or base class name "SHELLDLL\_DefView".</span></span>    |
| <span data-ttu-id="6d23a-152">4</span><span class="sxs-lookup"><span data-stu-id="6d23a-152">4</span></span>     | <span data-ttu-id="6d23a-153">Microsoft : conteneur proxy</span><span class="sxs-lookup"><span data-stu-id="6d23a-153">Microsoft: Container Proxy</span></span>   | <span data-ttu-id="6d23a-154">Pour Windows avec le nom de classe ou le nom de classe de base exact « \# 32770 ».</span><span class="sxs-lookup"><span data-stu-id="6d23a-154">For windows with the exact class name or base class name "\#32770".</span></span>              |
| <span data-ttu-id="6d23a-155">5</span><span class="sxs-lookup"><span data-stu-id="6d23a-155">5</span></span>     | <span data-ttu-id="6d23a-156">Microsoft : conteneur proxy</span><span class="sxs-lookup"><span data-stu-id="6d23a-156">Microsoft: Container Proxy</span></span>   | <span data-ttu-id="6d23a-157">Pour Windows avec un nom de classe ou un nom de classe de base contenant « AfxControlBar ».</span><span class="sxs-lookup"><span data-stu-id="6d23a-157">For windows with a class name or base class name containing "AfxControlBar".</span></span>     |
| <span data-ttu-id="6d23a-158">6</span><span class="sxs-lookup"><span data-stu-id="6d23a-158">6</span></span>     | <span data-ttu-id="6d23a-159">Microsoft : proxy TreeView</span><span class="sxs-lookup"><span data-stu-id="6d23a-159">Microsoft: TreeView Proxy</span></span>    | <span data-ttu-id="6d23a-160">Pour Windows avec un nom de classe ou un nom de classe de base contenant « SysTreeView32 ».</span><span class="sxs-lookup"><span data-stu-id="6d23a-160">For windows with a class name or base class name containing "SysTreeView32".</span></span>     |
| <span data-ttu-id="6d23a-161">7</span><span class="sxs-lookup"><span data-stu-id="6d23a-161">7</span></span>     | <span data-ttu-id="6d23a-162">Microsoft : proxy ListView</span><span class="sxs-lookup"><span data-stu-id="6d23a-162">Microsoft: ListView Proxy</span></span>    | <span data-ttu-id="6d23a-163">Pour Windows avec un nom de classe ou un nom de classe de base contenant « SysListView32 » (1).</span><span class="sxs-lookup"><span data-stu-id="6d23a-163">For windows with a class name or base class name containing "SysListView32" (1).</span></span> |
| <span data-ttu-id="6d23a-164">8</span><span class="sxs-lookup"><span data-stu-id="6d23a-164">8</span></span>     | <span data-ttu-id="6d23a-165">Microsoft : proxy ListView</span><span class="sxs-lookup"><span data-stu-id="6d23a-165">Microsoft: ListView Proxy</span></span>    | <span data-ttu-id="6d23a-166">Pour Windows avec un nom de classe ou un nom de classe de base contenant « SysListView32 » (2).</span><span class="sxs-lookup"><span data-stu-id="6d23a-166">For windows with a class name or base class name containing "SysListView32" (2).</span></span> |
| <span data-ttu-id="6d23a-167">9</span><span class="sxs-lookup"><span data-stu-id="6d23a-167">9</span></span>     | <span data-ttu-id="6d23a-168">Microsoft : proxy MSAA</span><span class="sxs-lookup"><span data-stu-id="6d23a-168">Microsoft: MSAA Proxy</span></span>        | <span data-ttu-id="6d23a-169">Pour n’importe quelle fenêtre.</span><span class="sxs-lookup"><span data-stu-id="6d23a-169">For any window.</span></span>                                                                  |



 

<span data-ttu-id="6d23a-170">Les proxies 7 et 8 sont des entrées en double pour le contrôle SysListView32.</span><span class="sxs-lookup"><span data-stu-id="6d23a-170">Proxies 7 and 8 are duplicate entries for the SysListView32 control.</span></span> <span data-ttu-id="6d23a-171">Sans modification, le proxy 7 est toujours utilisé pour le contrôle SysListView32 et proxy 8 n’est jamais utilisé.</span><span class="sxs-lookup"><span data-stu-id="6d23a-171">Without modification, the proxy 7 is always used for the SysListView32 control, and proxy 8 is never used.</span></span> <span data-ttu-id="6d23a-172">Proxy 8 est utilisé uniquement pour les éléments de liste visibles, et est généralement utilisé par les applications clientes qui fonctionnent uniquement avec les éléments visibles, ou qui ont des exigences de performances strictes.</span><span class="sxs-lookup"><span data-stu-id="6d23a-172">Proxy 8 is used only for visible list items, and is typically used by client applications that work only with visible elements, or that have strict performance requirements.</span></span> <span data-ttu-id="6d23a-173">Ces clients peuvent supprimer le proxy 7.</span><span class="sxs-lookup"><span data-stu-id="6d23a-173">These clients can remove proxy 7.</span></span>

<span data-ttu-id="6d23a-174">Proxy 9, le Active Accessibility Microsoft pour le proxy UI Automation, doit toujours être la dernière entrée de la table.</span><span class="sxs-lookup"><span data-stu-id="6d23a-174">Proxy 9, the Microsoft Active Accessibility to UI Automation proxy, should always be the last entry in the table.</span></span> <span data-ttu-id="6d23a-175">Cela permet à Microsoft Active Accessibility la fonctionnalité de secours pour les contrôles qui implémentent Microsoft Active Accessibility, mais pas UI Automation.</span><span class="sxs-lookup"><span data-stu-id="6d23a-175">This enables Microsoft Active Accessibility fallback functionality for controls that implement Microsoft Active Accessibility, but not UI Automation.</span></span>

<span data-ttu-id="6d23a-176">Lorsque vous modifiez des entrées dans la table de fabrique de proxy, vous devez évaluer avec soin la nouvelle position des entrées.</span><span class="sxs-lookup"><span data-stu-id="6d23a-176">When modifying entries in the proxy factory table, you should carefully evaluate the new position of the entries.</span></span> <span data-ttu-id="6d23a-177">Nous vous recommandons de placer les entrées de proxys personnalisés après les proxys de conteneur et de non-contrôle, mais avant le Active Accessibility Microsoft pour le proxy UI Automation.</span><span class="sxs-lookup"><span data-stu-id="6d23a-177">We recommend that entries for custom proxies be placed after the non-control and container proxies, but before the Microsoft Active Accessibility to UI Automation proxy.</span></span> <span data-ttu-id="6d23a-178">En outre, bien qu’il soit possible d’avoir du code dans l’appel à [**CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider) pour déterminer s’il doit prendre en charge un handle de fenêtre (**HWND**) donné, il est plus efficace de laisser UI Automation sélectionner le proxy en fonction du nom de la classe, et conserver le code conditionnel dans la méthode **CreateProvider** au minimum.</span><span class="sxs-lookup"><span data-stu-id="6d23a-178">Also, while it is possible to have code in the call to [**CreateProvider**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationproxyfactory-createprovider) determine whether it should support a given window handle (**HWND**), it is more efficient to let UI Automation select the proxy based on the class name, and keep conditional code in the **CreateProvider** method to a minimum.</span></span>

<span data-ttu-id="6d23a-179">UI Automation gère une table de fabrique de proxy distincte pour chaque client.</span><span class="sxs-lookup"><span data-stu-id="6d23a-179">UI Automation maintains a separate proxy factory table for each client.</span></span> <span data-ttu-id="6d23a-180">Lorsqu’un client modifie sa table proxy, les modifications affectent uniquement le client lui-même. les autres clients ne sont pas affectés.</span><span class="sxs-lookup"><span data-stu-id="6d23a-180">When a client changes its proxy table, the changes affect only the client itself; other clients are not affected.</span></span>

## <a name="managing-default-proxies"></a><span data-ttu-id="6d23a-181">Gestion des proxies par défaut</span><span class="sxs-lookup"><span data-stu-id="6d23a-181">Managing Default Proxies</span></span>

<span data-ttu-id="6d23a-182">Lorsqu’une application cliente crée l’objet [**CUIAutomation**](/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)) , la table de fabrique proxy contient initialement des entrées uniquement pour les fournisseurs de proxy par défaut pour les contrôles standard.</span><span class="sxs-lookup"><span data-stu-id="6d23a-182">When a client application creates the [**CUIAutomation**](/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)) object, the proxy factory table initially contains entries only for the default proxy providers for standard controls.</span></span> <span data-ttu-id="6d23a-183">À l’aide de l’interface [**IUIAutomationProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactorymapping) , les clients peuvent ajouter de nouvelles entrées, supprimer des entrées indésirables, modifier l’ordre des entrées, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="6d23a-183">By using the [**IUIAutomationProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactorymapping) interface, clients can add new entries, remove unwanted entries, change the order of entries, and so on.</span></span> <span data-ttu-id="6d23a-184">Un client peut récupérer un pointeur d’interface **IUIAutomationProxyFactoryMapping** en appelant la méthode [**IUIAutomation ::P roxyfactorymapping**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_proxyfactorymapping) .</span><span class="sxs-lookup"><span data-stu-id="6d23a-184">A client can retrieve an **IUIAutomationProxyFactoryMapping** interface pointer by calling the [**IUIAutomation::ProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_proxyfactorymapping) method.</span></span>

<span data-ttu-id="6d23a-185">La table des proxies disponibles contient une interface [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) pour chaque proxy.</span><span class="sxs-lookup"><span data-stu-id="6d23a-185">The table of available proxies contains an [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) interface for each proxy.</span></span> <span data-ttu-id="6d23a-186">Chaque **IUIAutomationProxyFactoryEntry** spécifie le [**IUIAutomationProxyFactory**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactory) et la classe de contrôle que le proxy sert, et définit la manière dont les événements doivent être gérés.</span><span class="sxs-lookup"><span data-stu-id="6d23a-186">Each **IUIAutomationProxyFactoryEntry** specifies the [**IUIAutomationProxyFactory**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactory) and the control class that the proxy serves, and defines how events are to be handled.</span></span>

<span data-ttu-id="6d23a-187">La table des proxies est représentée par une interface [**IUIAutomationProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactorymapping) , qui peut être obtenue à partir de la propriété [**IUIAutomation ::P roxyfactorymapping**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_proxyfactorymapping) .</span><span class="sxs-lookup"><span data-stu-id="6d23a-187">The table of proxies is represented by an [**IUIAutomationProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactorymapping) interface, which can be obtained from the [**IUIAutomation::ProxyFactoryMapping**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_proxyfactorymapping) property.</span></span> <span data-ttu-id="6d23a-188">Une application peut utiliser des méthodes **IUIAutomationProxyFactoryMapping** pour ajouter et supprimer des proxies.</span><span class="sxs-lookup"><span data-stu-id="6d23a-188">An application can use **IUIAutomationProxyFactoryMapping** methods to add and delete proxies.</span></span> <span data-ttu-id="6d23a-189">Pour créer une nouvelle entrée à ajouter à cette table, utilisez [**IUIAutomation :: CreateProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createproxyfactoryentry) pour obtenir l’interface, puis utilisez les méthodes [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) pour définir la classe de contrôle applicable et le comportement du proxy.</span><span class="sxs-lookup"><span data-stu-id="6d23a-189">To create a new entry to add to this table, use [**IUIAutomation::CreateProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createproxyfactoryentry) to obtain the interface, and then use the [**IUIAutomationProxyFactoryEntry**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationproxyfactoryentry) methods to define the applicable control class and the behavior of the proxy.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6d23a-190">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="6d23a-190">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6d23a-191">Comment créer un fournisseur UI Automation Client-Side (proxy)</span><span class="sxs-lookup"><span data-stu-id="6d23a-191">How to Create a Client-Side (Proxy) UI Automation Provider</span></span>](uiauto-howto-create-clientside-provider.md)
</dt> <dt>

[<span data-ttu-id="6d23a-192">Guide du programmeur du fournisseur UI Automation</span><span class="sxs-lookup"><span data-stu-id="6d23a-192">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 