---
title: Utilisation de l’annotation de serveur
description: Cette rubrique fournit des informations sur l’utilisation de l’annotation de serveur pour spécifier un objet de rappel.
ms.assetid: eeeebddc-2752-4d8f-b4fa-38ce156acc08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb545cd4dd016901d69f67d5ab5cab15dda08875
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106513532"
---
# <a name="using-server-annotation"></a><span data-ttu-id="1f601-103">Utilisation de l’annotation de serveur</span><span class="sxs-lookup"><span data-stu-id="1f601-103">Using Server Annotation</span></span>

<span data-ttu-id="1f601-104">Cette rubrique fournit des informations sur l’utilisation de l’annotation de serveur pour spécifier un objet de rappel.</span><span class="sxs-lookup"><span data-stu-id="1f601-104">This topic provides information about using server annotation to specify a callback object.</span></span>

<span data-ttu-id="1f601-105">**Pour substituer une propriété qui spécifie un objet de rappel**</span><span class="sxs-lookup"><span data-stu-id="1f601-105">**To override a property that specifies a callback object**</span></span>

1.  <span data-ttu-id="1f601-106">Obtient un pointeur d’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) vers l’élément accessible qui doit être annoté.</span><span class="sxs-lookup"><span data-stu-id="1f601-106">Obtain an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to the accessible element that is to be annotated.</span></span>
2.  <span data-ttu-id="1f601-107">Appelez [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) sur l’élément accessible pour recevoir un pointeur d’interface [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) .</span><span class="sxs-lookup"><span data-stu-id="1f601-107">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the accessible element to get an [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer.</span></span>
3.  <span data-ttu-id="1f601-108">Appelez [**IAccIdentity :: GetIdentityString ()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) sur le pointeur d’interface [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) pour obtenir une chaîne qui identifie de façon unique l’élément accessible qui doit être annoté.</span><span class="sxs-lookup"><span data-stu-id="1f601-108">Call [**IAccIdentity::GetIdentityString()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) on the [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer to obtain a string that uniquely identifies the accessible element that is to be annotated.</span></span>
4.  <span data-ttu-id="1f601-109">Utilisez [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) ou [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) pour créer l’objet [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) .</span><span class="sxs-lookup"><span data-stu-id="1f601-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) to create the [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) object.</span></span>
5.  <span data-ttu-id="1f601-110">Créez un objet COM (Component Object Model) qui implémente [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span><span class="sxs-lookup"><span data-stu-id="1f601-110">Create a Component Object Model (COM) object that implements [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span></span>
6.  <span data-ttu-id="1f601-111">Appelez [**IAccPropServices :: SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), en passant la chaîne d’identité, un GUID indiquant la propriété à substituer et un pointeur vers l’objet de rappel [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) .</span><span class="sxs-lookup"><span data-stu-id="1f601-111">Call [**IAccPropServices::SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passing the identity string, a GUID indicating the property to be overridden, and a pointer to the [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) callback object.</span></span>
7.  <span data-ttu-id="1f601-112">Libère les pointeurs d’interface et la mémoire libre.</span><span class="sxs-lookup"><span data-stu-id="1f601-112">Release interface pointers and free memory.</span></span>

<span data-ttu-id="1f601-113">Lorsqu’un client demande la propriété de l’élément accessible, l’objet de rappel sera appelé et renverra la valeur au client.</span><span class="sxs-lookup"><span data-stu-id="1f601-113">When a client requests the property of the accessible element, the callback object will be called and will return the value to the client.</span></span>

<span data-ttu-id="1f601-114">Comme lorsque vous spécifiez une valeur, les développeurs de serveurs peuvent également utiliser la méthode [**IAccPropServices :: ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) pour obtenir une chaîne d’identité ; ils peuvent utiliser la méthode [**IAccPropServices :: SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) et spécifier les paramètres *HWND*, *idObject* ou *idChild* au lieu d’une chaîne d’identité.</span><span class="sxs-lookup"><span data-stu-id="1f601-114">As when specifying a value, server developers can alternatively use the [**IAccPropServices::ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) method to obtain an identity string; or they can use the [**IAccPropServices::SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) method and specify the *hwnd*, *idObject*, or *idChild* parameters instead of an identity string.</span></span>

<span data-ttu-id="1f601-115">Lors de l’utilisation de [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) ou [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) sur un objet conteneur, les développeurs de serveurs peuvent éventuellement spécifier que les informations de substitution doivent également s’appliquer à tous les éléments enfants de ce conteneur.</span><span class="sxs-lookup"><span data-stu-id="1f601-115">When using either [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) or [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) on a container object, server developers can optionally specify that the overriding information should also apply to all element children of that container.</span></span>

<span data-ttu-id="1f601-116">Les serveurs peuvent effacer explicitement l’annotation à tout moment à l’aide de [**IAccPropServices :: ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span><span class="sxs-lookup"><span data-stu-id="1f601-116">Servers can explicitly clear the annotation at any time by using [**IAccPropServices::ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span></span> <span data-ttu-id="1f601-117">Cela n’est généralement pas nécessaire, car le service d’annotation nettoie automatiquement et libère les informations d’annotation lorsque l’élément accessible annoté disparaît.</span><span class="sxs-lookup"><span data-stu-id="1f601-117">This is usually not required, as the annotation service will automatically clean up and release annotation information when the accessible element being annotated disappears.</span></span>

<span data-ttu-id="1f601-118">Vous trouverez ci-dessous une liste des propriétés qui peuvent être annotées à l’aide de cette procédure.</span><span class="sxs-lookup"><span data-stu-id="1f601-118">Below is a list of properties that can be annotated using this procedure.</span></span>

## <a name="properties-supported-when-specifying-a-callback"></a><span data-ttu-id="1f601-119">Propriétés prises en charge lors de la spécification d’un rappel</span><span class="sxs-lookup"><span data-stu-id="1f601-119">Properties Supported When Specifying a Callback</span></span>

<span data-ttu-id="1f601-120">Lorsque vous spécifiez un rappel, les propriétés suivantes peuvent être annotées.</span><span class="sxs-lookup"><span data-stu-id="1f601-120">When specifying a callback, the following properties can be annotated.</span></span> <span data-ttu-id="1f601-121">Actuellement, ces propriétés ne peuvent pas être annotées directement en spécifiant une valeur.</span><span class="sxs-lookup"><span data-stu-id="1f601-121">Currently these properties cannot be annotated directly by specifying a value.</span></span>



| <span data-ttu-id="1f601-122">Propriété</span><span class="sxs-lookup"><span data-stu-id="1f601-122">Property</span></span>                      | <span data-ttu-id="1f601-123">Type</span><span class="sxs-lookup"><span data-stu-id="1f601-123">Type</span></span>                                                             |
|-------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="1f601-124">\_nom du compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-124">PROPID\_ACC\_NAME</span></span>             | <span data-ttu-id="1f601-125">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="1f601-125">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="1f601-126">\_Description du compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-126">PROPID\_ACC\_DESCRIPTION</span></span>      | <span data-ttu-id="1f601-127">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="1f601-127">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="1f601-128">\_rôle de compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-128">PROPID\_ACC\_ROLE</span></span>             | <span data-ttu-id="1f601-129">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-129">VT\_I4</span></span>                                                           |
| <span data-ttu-id="1f601-130">\_État du compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-130">PROPID\_ACC\_STATE</span></span>            | <span data-ttu-id="1f601-131">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-131">VT\_I4</span></span>                                                           |
| <span data-ttu-id="1f601-132">\_aide sur le compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-132">PROPID\_ACC\_HELP</span></span>             | <span data-ttu-id="1f601-133">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="1f601-133">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="1f601-134">\_KEYBOARDSHORTCUT de compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-134">PROPID\_ACC\_KEYBOARDSHORTCUT</span></span> | <span data-ttu-id="1f601-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="1f601-135">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="1f601-136">ID de l' \_ \_ DefaultAction ACC</span><span class="sxs-lookup"><span data-stu-id="1f601-136">PROPID\_ACC\_DEFAULTACTION</span></span>    | <span data-ttu-id="1f601-137">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="1f601-137">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="1f601-138">PROPID \_ compte \_ VALUEMAP</span><span class="sxs-lookup"><span data-stu-id="1f601-138">PROPID\_ACC\_VALUEMAP</span></span>         | <span data-ttu-id="1f601-139">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="1f601-139">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="1f601-140">\_ROLEMAP de compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-140">PROPID\_ACC\_ROLEMAP</span></span>          | <span data-ttu-id="1f601-141">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="1f601-141">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="1f601-142">\_STATEMAP de compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-142">PROPID\_ACC\_STATEMAP</span></span>         | <span data-ttu-id="1f601-143">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="1f601-143">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="1f601-144">\_focus du compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-144">PROPID\_ACC\_FOCUS</span></span>            | <span data-ttu-id="1f601-145">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-145">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-146">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-146">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="1f601-147">\_sélection du compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-147">PROPID\_ACC\_SELECTION</span></span>        | <span data-ttu-id="1f601-148">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-148">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-149">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-149">VT\_I4</span></span><br/> <span data-ttu-id="1f601-150">VT \_ inconnu</span><span class="sxs-lookup"><span data-stu-id="1f601-150">VT\_UNKNOWN</span></span><br/> |
| <span data-ttu-id="1f601-151">PROP \_ . \_ parent du compte</span><span class="sxs-lookup"><span data-stu-id="1f601-151">PROPID\_ACC\_PARENT</span></span>           | <span data-ttu-id="1f601-152">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-152">VT\_DISPATCH</span></span>                                                     |
| <span data-ttu-id="1f601-153">point \_ d' \_ accès au compte propid \_</span><span class="sxs-lookup"><span data-stu-id="1f601-153">PROPID\_ACC\_NAV\_UP</span></span>          | <span data-ttu-id="1f601-154">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-154">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-155">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-155">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="1f601-156">décompte de \_ la fenêtre de \_ navigation \_</span><span class="sxs-lookup"><span data-stu-id="1f601-156">PROPID\_ACC\_NAV\_DOWN</span></span>        | <span data-ttu-id="1f601-157">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-157">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-158">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-158">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="1f601-159">décompte du point d’approp \_ \_ \_ gauche</span><span class="sxs-lookup"><span data-stu-id="1f601-159">PROPID\_ACC\_NAV\_LEFT</span></span>        | <span data-ttu-id="1f601-160">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-160">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-161">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-161">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="1f601-162">décompte du point d’approp \_ \_ \_ droit</span><span class="sxs-lookup"><span data-stu-id="1f601-162">PROPID\_ACC\_NAV\_RIGHT</span></span>       | <span data-ttu-id="1f601-163">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-163">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-164">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-164">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="1f601-165">PROP \_ . \_ \_</span><span class="sxs-lookup"><span data-stu-id="1f601-165">PROPID\_ACC\_NAV\_PREV</span></span>        | <span data-ttu-id="1f601-166">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-166">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-167">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-167">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="1f601-168">ID d’en-dessous du compte d’prop \_ \_ \_</span><span class="sxs-lookup"><span data-stu-id="1f601-168">PROPID\_ACC\_NAV\_NEXT</span></span>        | <span data-ttu-id="1f601-169">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-169">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-170">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-170">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="1f601-171">ID de la la firstChild du point PROPID \_ \_ \_</span><span class="sxs-lookup"><span data-stu-id="1f601-171">PROPID\_ACC\_NAV\_FIRSTCHILD</span></span>  | <span data-ttu-id="1f601-172">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-172">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-173">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-173">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="1f601-174">ID de l' \_ \_ \_ LastChild du point propid</span><span class="sxs-lookup"><span data-stu-id="1f601-174">PROPID\_ACC\_NAV\_LASTCHILD</span></span>   | <span data-ttu-id="1f601-175">\_distribution vt</span><span class="sxs-lookup"><span data-stu-id="1f601-175">VT\_DISPATCH</span></span><br/> <span data-ttu-id="1f601-176">VT \_</span><span class="sxs-lookup"><span data-stu-id="1f601-176">VT\_I4</span></span><br/>                        |



 

 

