---
title: Modèles de contrôle Text et TextRange
description: Fournit des instructions et des conventions pour l’implémentation de ITextProvider, ITextProvider2 et ITextRangeProvider, y compris des informations sur les propriétés et les méthodes.
ms.assetid: 4d541c31-11f7-4d7e-a0e0-9ed1da873d07
keywords:
- UI Automation, implémenter le modèle de contrôle Text
- UI Automation, implémenter le modèle de contrôle TextRange
- UI Automation, modèle de contrôle de texte
- UI Automation, modèle de contrôle TextRange
- UI Automation, ITextProvider
- UI Automation, ITextRangeProvider
- ITextProvider
- ITextRangeProvider
- implémentation du modèle de contrôle Text d’UI Automation
- implémentation du modèle de contrôle TextRange d’UI Automation
- Text (modèle de contrôle)
- TextRange (modèle de contrôle)
- modèles de contrôle, ITextProvider
- modèles de contrôle, ITextRangeProvider
- modèles de contrôle, implémenter du texte UI Automation
- modèles de contrôle, implémentation d’UI Automation TextRange
- modèles de contrôle, texte
- modèles de contrôle, TextRange
- interfaces, ITextProvider
- interfaces, ITextRangeProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f53429dc8ec137a83b6a40db377b5c84aeb36120
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104550592"
---
# <a name="text-and-textrange-control-patterns"></a><span data-ttu-id="9ac78-123">Modèles de contrôle Text et TextRange</span><span class="sxs-lookup"><span data-stu-id="9ac78-123">Text and TextRange Control Patterns</span></span>

<span data-ttu-id="9ac78-124">Fournit des instructions et des conventions pour l’implémentation de [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2)et [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), y compris des informations sur les propriétés et les méthodes.</span><span class="sxs-lookup"><span data-stu-id="9ac78-124">Describes guidelines and conventions for implementing [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2), and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), including information about properties and methods.</span></span> <span data-ttu-id="9ac78-125">Le modèle de contrôle **Text** permet aux applications et aux contrôles d’exposer un modèle d’objet de texte simple, permettant ainsi aux clients d’extraire du contenu textuel, des attributs de texte et des objets incorporés à partir de contrôles textuels.</span><span class="sxs-lookup"><span data-stu-id="9ac78-125">The **Text** control pattern enables applications and controls to expose a simple text object model, enabling clients to retrieve textual content, text attributes, and embedded objects from text-based controls.</span></span>

<span data-ttu-id="9ac78-126">Pour prendre en charge le modèle de contrôle **Text** , les contrôles implémentent les interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) et [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-126">To support the **Text** control pattern, controls implement the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces.</span></span> <span data-ttu-id="9ac78-127">Les types de contrôle qui doivent prendre en charge le modèle de contrôle **Text** incluent les types de contrôle de [modification](uiauto-supporteditcontroltype.md) et de [document](uiauto-supportdocumentcontroltype.md) , ainsi que tout autre type de contrôle qui permet à l’utilisateur d’entrer du texte ou de sélectionner du texte en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="9ac78-127">Control types that should support the **Text** control pattern include the [Edit](uiauto-supporteditcontroltype.md) and [Document](uiauto-supportdocumentcontroltype.md) control types, and any other control type that enables the user to enter text or select read-only text.</span></span>

<span data-ttu-id="9ac78-128">Le modèle de contrôle **Text** peut être utilisé avec d’autres modèles de contrôle Microsoft UI Automation pour prendre en charge plusieurs types d’objets incorporés dans le texte, y compris les tables, les liens hypertexte et les boutons de commande.</span><span class="sxs-lookup"><span data-stu-id="9ac78-128">The **Text** control pattern can be used with other Microsoft UI Automation control patterns to support several types of embedded objects in the text, including tables, hyperlinks, and command buttons.</span></span>

<span data-ttu-id="9ac78-129">Les interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) et [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) incluent un certain nombre de méthodes pour acquérir des plages de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-129">The [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces include a number of methods for acquiring text ranges.</span></span> <span data-ttu-id="9ac78-130">Une *plage de texte* est un objet qui représente une étendue contiguë de texte, ou plusieurs étendues disjointes de texte, dans un conteneur de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-130">A *text range* is an object that represents a contiguous span of text—or multiple, disjoint spans of text—in a text container.</span></span> <span data-ttu-id="9ac78-131">Une méthode **ITextProvider** acquiert une plage de texte qui représente l’intégralité du document, tandis que d’autres acquièrent des plages de texte qui représentent une partie du document, telles que le texte sélectionné, le texte visible ou un objet incorporé dans le texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-131">One **ITextProvider** method acquires a text range that represents the entire document, while others acquire text ranges that represent some portion of the document, such as the selected text, the visible text, or an object embedded in the text.</span></span>

<span data-ttu-id="9ac78-132">Un objet de plage de texte est représenté par le modèle de contrôle **TextRange** , qui est implémenté par le biais de l’interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-132">A text range object is represented by the **TextRange** control pattern, which is implemented through the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span> <span data-ttu-id="9ac78-133">Le modèle de contrôle **TextRange** fournit des méthodes et des propriétés utilisées pour exposer des informations sur le texte de la plage, déplacer les points de terminaison de la plage, sélectionner ou désélectionner du texte, faire défiler la plage dans la vue, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="9ac78-133">The **TextRange** control pattern provides methods and properties used to expose information about the text in the range, move the endpoints of the range, select or deselect text, scroll the range into view, and so on.</span></span>

<span data-ttu-id="9ac78-134">Pour plus d’informations sur les modèles de contrôle **Text** et **TextRange** , consultez [prise en charge d’UI Automation pour le contenu textuel](uiauto-ui-automation-textpattern-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9ac78-134">For more information about the **Text** and **TextRange** control patterns, see [UI Automation Support for Textual Content](uiauto-ui-automation-textpattern-overview.md).</span></span>

<span data-ttu-id="9ac78-135">À partir de Windows 8.1 fournisseurs peuvent implémenter l’interface [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-135">Starting with Windows 8.1 providers can implement the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span> <span data-ttu-id="9ac78-136">Cela permet d’appeler des menus contextuels associés à une plage de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-136">This enables invoking context menus that are associated with a text range.</span></span> <span data-ttu-id="9ac78-137">Cela prend en charge des scénarios tels que la correction automatique de texte ou la sélection de candidat de l’éditeur de méthode d’entrée (IME).</span><span class="sxs-lookup"><span data-stu-id="9ac78-137">This supports scenarios such as text autocorrection or Input Method Editor (IME) candidate selection.</span></span>

<span data-ttu-id="9ac78-138">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="9ac78-138">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="9ac78-139">Conventions et directives d'implémentation</span><span class="sxs-lookup"><span data-stu-id="9ac78-139">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="9ac78-140">Membres requis pour **ITextProvider**</span><span class="sxs-lookup"><span data-stu-id="9ac78-140">Required Members for **ITextProvider**</span></span>](#required-members-for-itextprovider)
-   [<span data-ttu-id="9ac78-141">Membres requis pour **ITextRangeProvider**</span><span class="sxs-lookup"><span data-stu-id="9ac78-141">Required Members for **ITextRangeProvider**</span></span>](#required-members-for-itextrangeprovider)
-   [<span data-ttu-id="9ac78-142">Prise en charge des plages de texte</span><span class="sxs-lookup"><span data-stu-id="9ac78-142">Supporting Text Ranges</span></span>](#supporting-text-ranges)
    -   [<span data-ttu-id="9ac78-143">Manipulation d’une plage de texte par unité de texte</span><span class="sxs-lookup"><span data-stu-id="9ac78-143">Manipulating a Text Range by Text Unit</span></span>](#manipulating-a-text-range-by-text-unit)
    -   [<span data-ttu-id="9ac78-144">Sélection de texte dans une plage de texte</span><span class="sxs-lookup"><span data-stu-id="9ac78-144">Selecting Text in a Text Range</span></span>](#selecting-text-in-a-text-range)
    -   [<span data-ttu-id="9ac78-145">Acquisition de texte à partir d’une plage de texte</span><span class="sxs-lookup"><span data-stu-id="9ac78-145">Acquiring Text from a Text Range</span></span>](#acquiring-text-from-a-text-range)
    -   [<span data-ttu-id="9ac78-146">Implémentation de ShowContextMenu</span><span class="sxs-lookup"><span data-stu-id="9ac78-146">Implementing ShowContextMenu</span></span>](#implementing-showcontextmenu)
-   [<span data-ttu-id="9ac78-147">Interopérabilité avec le signe insertion du système</span><span class="sxs-lookup"><span data-stu-id="9ac78-147">Interoperability with the System Caret</span></span>](#interoperability-with-the-system-caret)
-   [<span data-ttu-id="9ac78-148">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="9ac78-148">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="9ac78-149">Conventions et directives d'implémentation</span><span class="sxs-lookup"><span data-stu-id="9ac78-149">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="9ac78-150">Lorsque vous implémentez le modèle de contrôle **Text** , notez les conventions et recommandations suivantes :</span><span class="sxs-lookup"><span data-stu-id="9ac78-150">When implementing the **Text** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="9ac78-151">Tout contrôle qui permet d’accéder à du texte (par exemple, en entrant du texte ou en sélectionnant du texte en lecture seule) doit prendre en charge le modèle de contrôle **Text** .</span><span class="sxs-lookup"><span data-stu-id="9ac78-151">Any control that enables access to text (for example, entering text or selecting read-only text) should support the **Text** control pattern.</span></span>
-   <span data-ttu-id="9ac78-152">Le modèle de contrôle **Text** peut être utilisé avec n’importe quel élément d’interface utilisateur qui présente du texte, même une étiquette statique sur un contrôle bouton standard.</span><span class="sxs-lookup"><span data-stu-id="9ac78-152">The **Text** control pattern can be used with any UI element that presents text, even a static label on a standard button control.</span></span> <span data-ttu-id="9ac78-153">Toutefois, il n’est pas obligatoire sur les contrôles de texte statiques qui ne peuvent pas être sélectionnés ou qui n’ont pas de point d’insertion.</span><span class="sxs-lookup"><span data-stu-id="9ac78-153">However, it is not required on static text controls that cannot be selected or do not have an insertion point.</span></span>
-   <span data-ttu-id="9ac78-154">Pour vous assurer que le texte est entièrement accessible, les contrôles qui implémentent [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) doivent également prendre en charge l’interface [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-154">To ensure that text is fully accessible, controls that implement [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) should also support the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface.</span></span> <span data-ttu-id="9ac78-155">**IValueProvider** complète **ITextProvider** en fournissant un moyen par programmation de modifier le texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-155">**IValueProvider** complements **ITextProvider** by providing a programmatic way to change the text.</span></span> <span data-ttu-id="9ac78-156">Il offre également une meilleure compatibilité avec les applications clientes de technologie d’assistance, y compris celles basées sur des technologies héritées telles que Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="9ac78-156">It also offers greater compatibility with assistive technology client applications, including those based on legacy technologies such as Microsoft Active Accessibility.</span></span> <span data-ttu-id="9ac78-157">Lorsque les deux modèles de contrôle sont implémentés, l’événement **TextChanged** ([**UIA \_ Text \_ TextChangedEventId**](uiauto-event-ids.md)) et **AutomationPropertyChanged** ([**UIA \_ AutomationPropertyChangedEventId**](uiauto-event-ids.md)) sont équivalents pour la propriété **value** ([**UIA \_ ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span><span class="sxs-lookup"><span data-stu-id="9ac78-157">When both control patterns are implemented, the **TextChanged** event ([**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md)) and **AutomationPropertyChanged** event ([**UIA\_AutomationPropertyChangedEventId**](uiauto-event-ids.md)) are equivalent for the **Value** property ([**UIA\_ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span></span> <span data-ttu-id="9ac78-158">Les deux événements doivent être pris en charge.</span><span class="sxs-lookup"><span data-stu-id="9ac78-158">Both events must be supported.</span></span>
-   <span data-ttu-id="9ac78-159">Le modèle de contrôle **Text** ne prend en charge qu’un seul flux de texte et une seule fenêtre d’affichage par contrôle.</span><span class="sxs-lookup"><span data-stu-id="9ac78-159">The **Text** control pattern supports only one stream of text and one viewport per control.</span></span> <span data-ttu-id="9ac78-160">Si l’application propose plusieurs vues de document dans des volets, chaque vue (contrôle) doit prendre en charge [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) indépendamment.</span><span class="sxs-lookup"><span data-stu-id="9ac78-160">If the application offers multiple views of document in panes, each view (control) should support [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) independently.</span></span>
-   <span data-ttu-id="9ac78-161">La méthode [**ITextProvider :: GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) peut retourner une seule plage de texte représentant le texte actuellement sélectionné.</span><span class="sxs-lookup"><span data-stu-id="9ac78-161">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method may return a single text range representing the currently selected text.</span></span> <span data-ttu-id="9ac78-162">Si un contrôle prend en charge la sélection de plusieurs étendues non contiguës de texte, la méthode **GetSelection** doit retourner un tableau qui contient une interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) pour chaque étendue de texte sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="9ac78-162">If a control supports the selection of multiple, noncontiguous spans of text, the **GetSelection** method should return an array that contains one [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface for each selected span of text.</span></span>
-   <span data-ttu-id="9ac78-163">Le modèle de contrôle **Text** représente le point d’insertion sous la forme d’une plage de texte dégénérée (vide).</span><span class="sxs-lookup"><span data-stu-id="9ac78-163">The **Text** control pattern represents the insertion point as a degenerate (empty) text range.</span></span> <span data-ttu-id="9ac78-164">La méthode [**ITextProvider :: GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) doit retourner une plage de texte dégénérée lorsque le point d’insertion existe et qu’aucun texte n’est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="9ac78-164">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method should return a degenerate text range when the insertion point exists and no text is selected.</span></span> <span data-ttu-id="9ac78-165">Pour plus d’informations, consultez [interopérabilité avec le signe insertion du système](#interoperability-with-the-system-caret).</span><span class="sxs-lookup"><span data-stu-id="9ac78-165">For more information, see [Interoperability with the System Caret](#interoperability-with-the-system-caret).</span></span>
-   <span data-ttu-id="9ac78-166">La méthode [**ITextProvider :: GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) peut retourner une seule plage de texte si une plage contiguë de texte est visible dans la fenêtre d’affichage, ou elle peut retourner un tableau de plages de texte disjointes représentant plusieurs lignes de texte partiellement visibles.</span><span class="sxs-lookup"><span data-stu-id="9ac78-166">The [**ITextProvider::GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) method may return a single text range if a contiguous range of text is visible in the viewport, or it may return an array of disjoint text ranges representing multiple, partially visible lines of text.</span></span>
-   <span data-ttu-id="9ac78-167">La méthode [**ITextProvider :: RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) doit retourner une plage dégénérée si l’élément enfant ne contient pas de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-167">The [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method should return a degenerate range if the child element contains no text.</span></span> <span data-ttu-id="9ac78-168">Comme un objet incorporé peut inclure du texte, la méthode **RangeFromChild** ne retourne pas toujours une plage de texte dégénérée.</span><span class="sxs-lookup"><span data-stu-id="9ac78-168">Because an embedded object can include text, the **RangeFromChild** method may not always return a degenerate text range.</span></span> <span data-ttu-id="9ac78-169">Pour plus d’informations, consultez [Comment UI Automation expose des objets incorporés](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9ac78-169">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>
-   <span data-ttu-id="9ac78-170">La méthode [**ITextProvider :: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) effectue un test de positionnement dans la zone de document à l’aide des coordonnées d’écran spécifiées.</span><span class="sxs-lookup"><span data-stu-id="9ac78-170">The [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) method performs hit testing in the document area using the specified screen coordinates.</span></span> <span data-ttu-id="9ac78-171">La plage de texte résultante doit être cohérente avec le point d’insertion ou la sélection qui résulterait d’un clic sur l’emplacement aux coordonnées d’écran spécifiées.</span><span class="sxs-lookup"><span data-stu-id="9ac78-171">The resulting text range should be consistent with the insertion point or selection that would result from clicking the location at the specified screen coordinates.</span></span> <span data-ttu-id="9ac78-172">Par exemple, si une image réside aux coordonnées d’écran spécifiées, la plage de texte résultante doit être la même que la plage de texte que la méthode [**ITextProvider :: RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) obtient pour l’image.</span><span class="sxs-lookup"><span data-stu-id="9ac78-172">For example, if an image resides at the specified screen coordinates, the resulting text range should be the same as the text range that the [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method would acquire for the image.</span></span> <span data-ttu-id="9ac78-173">De même, si une application cliente demande une plage de texte pour l’emplacement au centre du signe insertion du système (point d’insertion), la plage de texte résultante doit être identique à l’emplacement du signe insertion du système.</span><span class="sxs-lookup"><span data-stu-id="9ac78-173">Similarly, if a client application requests a text range for the location at the center of the system caret (the insertion point), the resulting text range should be the same as the system caret location.</span></span>
-   <span data-ttu-id="9ac78-174">La propriété [**ITextProvider ::D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) doit toujours fournir une plage de texte qui comprend tout le texte pris en charge par l’implémentation [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) correspondante.</span><span class="sxs-lookup"><span data-stu-id="9ac78-174">The [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property should always provide a text range that includes all of the text supported by the corresponding [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) implementation.</span></span>
-   <span data-ttu-id="9ac78-175">L' [**événement \_ \_ TextChangedEventId de texte UIA**](uiauto-event-ids.md) doit être déclenché après toute modification de texte, même si la modification n’est pas visible dans la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="9ac78-175">The [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event must be raised after any text change occurs, even if the change is not visible in the viewport.</span></span> <span data-ttu-id="9ac78-176">Par exemple, le fournisseur doit déclencher l’événement même si l’utilisateur colle exactement le même texte sur le texte sélectionné.</span><span class="sxs-lookup"><span data-stu-id="9ac78-176">For example, the provider should raise the event even if the user pastes the exact same text over the selected text.</span></span>
-   <span data-ttu-id="9ac78-177">Le [**\_ \_ TextSelectionChangedEventId de texte UIA**](uiauto-event-ids.md) doit être déclenché chaque fois que la sélection de texte change, ou chaque fois que le point d’insertion (signe insertion) se déplace entre le texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-177">The [**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md) must be raised whenever the selection of text changes, or whenever the insertion point (caret) moves among the text.</span></span>

<span data-ttu-id="9ac78-178">Lorsque vous implémentez le modèle de contrôle **TextRange** , notez les conventions et recommandations suivantes :</span><span class="sxs-lookup"><span data-stu-id="9ac78-178">When implementing the **TextRange** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="9ac78-179">Toutes les méthodes du modèle de contrôle **TextRange** doivent effectuer des opérations de texte indépendamment de l’état de visibilité du texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-179">All methods of the **TextRange** control pattern should perform text operations regardless of the visibility state of the text.</span></span> <span data-ttu-id="9ac78-180">La visibilité d’une plage de texte peut toujours être déterminée en interrogeant l’attribut de texte **IsHidden** ([**UIA \_ IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="9ac78-180">The visibility of a text range can always be determined by querying the **IsHidden** text attribute ([**UIA\_IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span></span>
-   <span data-ttu-id="9ac78-181">Si possible, un fournisseur doit s’assurer que les modifications de texte, telles que les suppressions, les insertions et les déplacements, sont reflétées dans les objets de la plage de texte associée (instances de l’interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) ) et déclencher un événement de [**\_ \_ TextChangedEventId de texte UIA**](uiauto-event-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-181">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range objects (instances of [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface) and raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event.</span></span> <span data-ttu-id="9ac78-182">Les clients peuvent utiliser l’événement comme indication pour confirmer les modifications éditoriales apportées au texte d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="9ac78-182">Clients may use the event as a hint to confirm editorial changes made to the text of a control.</span></span>
-   <span data-ttu-id="9ac78-183">Tous les objets de la plage de texte utilisés par les méthodes [**ITextRangeProvider :: compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**compareEndPoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)et [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) doivent être des homologues de la même implémentation du modèle de contrôle de **texte** .</span><span class="sxs-lookup"><span data-stu-id="9ac78-183">All of the text range objects used by the [**ITextRangeProvider::Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints), and [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) methods must be peers of the same **Text** control pattern implementation.</span></span>
-   <span data-ttu-id="9ac78-184">Bien que cela ne soit pas obligatoire, la valeur *pRetVal* récupérée par la méthode [**ITextRangeProvider :: CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) peut indiquer la distance, en caractères ([**\_ caractère TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), entre les deux points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="9ac78-184">Although not required, the *pRetVal* value retrieved by the [**ITextRangeProvider::CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) method can indicate the distance, in characters ([**TextUnit\_Character**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), between the two endpoints.</span></span> <span data-ttu-id="9ac78-185">Toutefois, les applications clientes ne doivent pas dépendre de la précision de *pRetVal* au-delà de sa valeur positive ou négative.</span><span class="sxs-lookup"><span data-stu-id="9ac78-185">However, client applications should not depend on the accuracy of *pRetVal* beyond its positive or negative value.</span></span>
-   <span data-ttu-id="9ac78-186">Les méthodes [**ITextRangeProvider :: ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)et [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) requièrent une attention particulière pour l’unité de texte spécifiée.</span><span class="sxs-lookup"><span data-stu-id="9ac78-186">The [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), and [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) methods require careful consideration of the specified text unit.</span></span> <span data-ttu-id="9ac78-187">Pour plus d’informations, consultez manipulation d’un TextRange par unité de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-187">For more information, see Manipulating a TextRange by Text Unit.</span></span>
-   <span data-ttu-id="9ac78-188">Pour connaître les conditions d’implémentation liées aux méthodes [**ITextRangeProvider :: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)et [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) , consultez sélection de texte dans une plage de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-188">For implementation requirements related to the [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection), and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods, see Selecting Text in a Text Range.</span></span>
-   <span data-ttu-id="9ac78-189">Les méthodes [**ITextRangeProvider :: FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) et [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) effectuent une recherche vers l’avant ou vers l’arrière pour une chaîne de texte ou un attribut de texte correspondant unique.</span><span class="sxs-lookup"><span data-stu-id="9ac78-189">The [**ITextRangeProvider::FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) and [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) methods search forward or backward for a single matching text string or text attribute.</span></span> <span data-ttu-id="9ac78-190">Ils doivent retourner la **valeur null** si aucune correspondance n’est trouvée.</span><span class="sxs-lookup"><span data-stu-id="9ac78-190">They should return **NULL** if no match is found.</span></span>
-   <span data-ttu-id="9ac78-191">La méthode [**ITextRangeProvider :: GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) doit retourner l’adresse acquise à partir de la fonction [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) ou [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) si l’attribut associé varie dans la plage, ou si l’attribut n’est pas pris en charge par le contrôle de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-191">The [**ITextRangeProvider::GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) method must return the address acquired from the [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) or [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) function if the associated attribute varies in the range, or if the attribute is not supported by the text control.</span></span> <span data-ttu-id="9ac78-192">La spécification du modèle de contrôle **TextRange** n’autorise pas l’ajout de nouveaux identificateurs d’attribut de texte ni la modification de la façon dont les attributs existants sont définis.</span><span class="sxs-lookup"><span data-stu-id="9ac78-192">The **TextRange** control pattern specification does not allow adding new text-attribute identifiers or changing how the existing attributes are defined.</span></span>
-   <span data-ttu-id="9ac78-193">Si possible, la méthode [**ITextRangeProvider :: GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) doit retourner un tableau qui contient un rectangle englobant pour chaque ligne de texte complètement ou partiellement visible dans une plage de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-193">If possible, the [**ITextRangeProvider::GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) method should return an array that contains one bounding rectangle for each fully or partially visible line of text in a text range.</span></span> <span data-ttu-id="9ac78-194">Si ce n’est pas possible, le fournisseur peut retourner un tableau qui contient les rectangles englobants de lignes entièrement visibles uniquement ; Toutefois, cela limite la capacité d’une application cliente à décrire avec précision le mode de présentation du texte à l’écran.</span><span class="sxs-lookup"><span data-stu-id="9ac78-194">If this is not possible, the provider can return an array that contains the bounding rectangles of only fully visible lines; however, this limits a client application's ability to accurately describe how the text is being presented on the screen.</span></span>
-   <span data-ttu-id="9ac78-195">La méthode [**ITextRangeProvider :: GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) doit retourner tous les éléments enfants incorporés dans une plage de texte, mais elle n’a pas besoin de retourner des enfants des éléments enfants.</span><span class="sxs-lookup"><span data-stu-id="9ac78-195">The [**ITextRangeProvider::GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method should return all child elements embedded in a text range, but it does not need to return any children of the child elements.</span></span> <span data-ttu-id="9ac78-196">Par exemple, si une plage de texte contient une table qui a plusieurs cellules enfants, la méthode **GetChildren** peut retourner uniquement l’élément de table et non les éléments de cellule.</span><span class="sxs-lookup"><span data-stu-id="9ac78-196">For example, if a text range contains a table that has a number of child cells, the **GetChildren** method may return just the table element and not the cell elements.</span></span> <span data-ttu-id="9ac78-197">Pour des raisons de performances ou d’architecture, un fournisseur peut ne pas être en mesure d’exposer tous les objets incorporés qui sont hébergés dans un document de l’arborescence Automation.</span><span class="sxs-lookup"><span data-stu-id="9ac78-197">For performance or architectural reasons, a provider may not be able to expose all embedded objects that are hosted in a document in the automation tree.</span></span> <span data-ttu-id="9ac78-198">Dans ce cas, le fournisseur doit au moins prendre en charge l’énumération d’objets enfants par le biais de la méthode **GetChildren** et, en guise d’option, prendre en charge le modèle de contrôle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) pour la prise en charge de la dévirtualisation.</span><span class="sxs-lookup"><span data-stu-id="9ac78-198">In this case, the provider should at least support the enumerating of child objects through the **GetChildren** method and, as an option, support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern for de-virtualization support.</span></span>
-   <span data-ttu-id="9ac78-199">La méthode [**ITextRangeProvider :: GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) retourne généralement le fournisseur de texte qui fournit la plage de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-199">The [**ITextRangeProvider::GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) method typically returns the text provider that supplies the text range.</span></span> <span data-ttu-id="9ac78-200">Toutefois, si le fournisseur de texte prend en charge des objets enfants tels que des tables ou des liens hypertexte, l’élément englobant peut être un descendant du fournisseur de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-200">However, if the text provider supports child objects such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</span></span> <span data-ttu-id="9ac78-201">L’élément retourné par **GetEnclosingElement** doit être l’élément le plus proche de la plage de texte spécifiée.</span><span class="sxs-lookup"><span data-stu-id="9ac78-201">The element returned by **GetEnclosingElement** should be the element closest to the given text range.</span></span> <span data-ttu-id="9ac78-202">Par exemple, si la plage de texte se trouve dans une cellule d’une table, **GetEnclosingElement** doit retourner la cellule conteneur au lieu de l’élément de table.</span><span class="sxs-lookup"><span data-stu-id="9ac78-202">For example, if the text range is in a cell of a table, **GetEnclosingElement** should return the containing cell instead of the table element.</span></span>
-   <span data-ttu-id="9ac78-203">La méthode [**ITextRangeProvider :: gettext**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) doit retourner le texte brut de la plage.</span><span class="sxs-lookup"><span data-stu-id="9ac78-203">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text in the range.</span></span> <span data-ttu-id="9ac78-204">Pour plus d’informations, consultez acquisition de texte à partir d’une plage de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-204">For more information, see Acquiring Text from a Text Range.</span></span>
-   <span data-ttu-id="9ac78-205">L’appel de [**ITextRangeProvider :: ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) doit aligner le texte dans la fenêtre d’affichage du contrôle de texte comme spécifié par le paramètre *alignToTop* .</span><span class="sxs-lookup"><span data-stu-id="9ac78-205">Calling [**ITextRangeProvider::ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) should align the text in the viewport of the text control as specified by the *alignToTop* parameter.</span></span> <span data-ttu-id="9ac78-206">Bien qu’il n’y ait aucune exigence en termes d’alignement horizontal, la plage de texte doit être visible à la fois horizontalement et verticalement.</span><span class="sxs-lookup"><span data-stu-id="9ac78-206">Although there is no requirement in terms of horizontal alignment, the text range should be visible both horizontally and vertically.</span></span> <span data-ttu-id="9ac78-207">Lors de l’évaluation du paramètre *alignToTop* , un fournisseur doit prendre en compte l’orientation du contrôle Text et le sens du déroulement du texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-207">When evaluating the *alignToTop* parameter, a provider must take into account the orientation of the text control and the flow direction of the text.</span></span> <span data-ttu-id="9ac78-208">Par exemple, si *alignToTop* a la **valeur true** pour un contrôle de texte orienté verticalement contenant du texte qui se lit de droite à gauche, le fournisseur doit aligner la plage de texte sur le côté droit de la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="9ac78-208">For example, if *alignToTop* is **TRUE** for a vertically oriented text control containing text that flows from right to left, the provider should align the text range with the right side of the viewport.</span></span>
-   <span data-ttu-id="9ac78-209">Lors du déplacement d’un document [**par \_ ligne TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), si la plage de texte entre dans une table incorporée, chaque ligne de texte dans une cellule doit être traitée comme une ligne.</span><span class="sxs-lookup"><span data-stu-id="9ac78-209">When moving through a document by [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), if the text range enters an embedded table, each line of text in a cell should be treated as a line.</span></span>

## <a name="required-members-for-itextprovider"></a><span data-ttu-id="9ac78-210">Membres requis pour **ITextProvider**</span><span class="sxs-lookup"><span data-stu-id="9ac78-210">Required Members for **ITextProvider**</span></span>

<span data-ttu-id="9ac78-211">Les propriétés et méthodes suivantes sont requises pour implémenter l’interface [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-211">The following properties and methods are required for implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface.</span></span>



| <span data-ttu-id="9ac78-212">Membres nécessaires</span><span class="sxs-lookup"><span data-stu-id="9ac78-212">Required members</span></span>                                                                                        | <span data-ttu-id="9ac78-213">Type de membre</span><span class="sxs-lookup"><span data-stu-id="9ac78-213">Member type</span></span> | <span data-ttu-id="9ac78-214">Notes</span><span class="sxs-lookup"><span data-stu-id="9ac78-214">Notes</span></span> |
|---------------------------------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="9ac78-215">**DocumentRange**</span><span class="sxs-lookup"><span data-stu-id="9ac78-215">**DocumentRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange)                                             | <span data-ttu-id="9ac78-216">Propriété</span><span class="sxs-lookup"><span data-stu-id="9ac78-216">Property</span></span>    | <span data-ttu-id="9ac78-217">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-217">None</span></span>  |
| [<span data-ttu-id="9ac78-218">**SupportedTextSelection**</span><span class="sxs-lookup"><span data-stu-id="9ac78-218">**SupportedTextSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection)                           | <span data-ttu-id="9ac78-219">Propriété</span><span class="sxs-lookup"><span data-stu-id="9ac78-219">Property</span></span>    | <span data-ttu-id="9ac78-220">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-220">None</span></span>  |
| [<span data-ttu-id="9ac78-221">**GetSelection**</span><span class="sxs-lookup"><span data-stu-id="9ac78-221">**GetSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection)                                               | <span data-ttu-id="9ac78-222">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-222">Method</span></span>      | <span data-ttu-id="9ac78-223">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-223">None</span></span>  |
| [<span data-ttu-id="9ac78-224">**GetVisibleRanges**</span><span class="sxs-lookup"><span data-stu-id="9ac78-224">**GetVisibleRanges**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges)                                       | <span data-ttu-id="9ac78-225">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-225">Method</span></span>      | <span data-ttu-id="9ac78-226">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-226">None</span></span>  |
| [<span data-ttu-id="9ac78-227">**RangeFromChild**</span><span class="sxs-lookup"><span data-stu-id="9ac78-227">**RangeFromChild**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild)                                           | <span data-ttu-id="9ac78-228">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-228">Method</span></span>      | <span data-ttu-id="9ac78-229">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-229">None</span></span>  |
| [<span data-ttu-id="9ac78-230">**Telle**</span><span class="sxs-lookup"><span data-stu-id="9ac78-230">**RangeFromPoint**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint)                                           | <span data-ttu-id="9ac78-231">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-231">Method</span></span>      | <span data-ttu-id="9ac78-232">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-232">None</span></span>  |
| [<span data-ttu-id="9ac78-233">**\_TextChangedEventId de texte UIA \_**</span><span class="sxs-lookup"><span data-stu-id="9ac78-233">**UIA\_Text\_TextChangedEventId**</span></span>](uiauto-event-ids.md)                   | <span data-ttu-id="9ac78-234">Événement</span><span class="sxs-lookup"><span data-stu-id="9ac78-234">Event</span></span>       | <span data-ttu-id="9ac78-235">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-235">None</span></span>  |
| [<span data-ttu-id="9ac78-236">**\_TextSelectionChangedEventId de texte UIA \_**</span><span class="sxs-lookup"><span data-stu-id="9ac78-236">**UIA\_Text\_TextSelectionChangedEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="9ac78-237">Événement</span><span class="sxs-lookup"><span data-stu-id="9ac78-237">Event</span></span>       | <span data-ttu-id="9ac78-238">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-238">None</span></span>  |



 

<span data-ttu-id="9ac78-239">Les propriétés et méthodes supplémentaires suivantes sont requises pour implémenter l’interface [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-239">The following additional properties and methods are required for implementing the [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interface.</span></span>



| <span data-ttu-id="9ac78-240">Membres nécessaires</span><span class="sxs-lookup"><span data-stu-id="9ac78-240">Required members</span></span>                                                         | <span data-ttu-id="9ac78-241">Type de membre</span><span class="sxs-lookup"><span data-stu-id="9ac78-241">Member type</span></span> | <span data-ttu-id="9ac78-242">Notes</span><span class="sxs-lookup"><span data-stu-id="9ac78-242">Notes</span></span> |
|--------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="9ac78-243">**GetCaretRange**</span><span class="sxs-lookup"><span data-stu-id="9ac78-243">**GetCaretRange**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange)         | <span data-ttu-id="9ac78-244">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-244">Method</span></span>      | <span data-ttu-id="9ac78-245">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-245">None</span></span>  |
| [<span data-ttu-id="9ac78-246">**RangeFromAnnotation**</span><span class="sxs-lookup"><span data-stu-id="9ac78-246">**RangeFromAnnotation**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) | <span data-ttu-id="9ac78-247">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-247">Method</span></span>      | <span data-ttu-id="9ac78-248">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-248">None</span></span>  |



 

## <a name="required-members-for-itextrangeprovider"></a><span data-ttu-id="9ac78-249">Membres requis pour **ITextRangeProvider**</span><span class="sxs-lookup"><span data-stu-id="9ac78-249">Required Members for **ITextRangeProvider**</span></span>

<span data-ttu-id="9ac78-250">Les propriétés et méthodes suivantes sont requises pour implémenter l’interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-250">The following properties and methods are required for implementing the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span>



| <span data-ttu-id="9ac78-251">Membres nécessaires</span><span class="sxs-lookup"><span data-stu-id="9ac78-251">Required members</span></span>                                                                 | <span data-ttu-id="9ac78-252">Type de membre</span><span class="sxs-lookup"><span data-stu-id="9ac78-252">Member type</span></span> | <span data-ttu-id="9ac78-253">Notes</span><span class="sxs-lookup"><span data-stu-id="9ac78-253">Notes</span></span> |
|----------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="9ac78-254">**AddToSelection**</span><span class="sxs-lookup"><span data-stu-id="9ac78-254">**AddToSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)               | <span data-ttu-id="9ac78-255">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-255">Method</span></span>      | <span data-ttu-id="9ac78-256">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-256">None</span></span>  |
| [<span data-ttu-id="9ac78-257">**Répliqué**</span><span class="sxs-lookup"><span data-stu-id="9ac78-257">**Clone**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-clone)                                 | <span data-ttu-id="9ac78-258">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-258">Method</span></span>      | <span data-ttu-id="9ac78-259">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-259">None</span></span>  |
| [<span data-ttu-id="9ac78-260">**Comparer**</span><span class="sxs-lookup"><span data-stu-id="9ac78-260">**Compare**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare)                             | <span data-ttu-id="9ac78-261">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-261">Method</span></span>      | <span data-ttu-id="9ac78-262">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-262">None</span></span>  |
| [<span data-ttu-id="9ac78-263">**CompareEndpoints**</span><span class="sxs-lookup"><span data-stu-id="9ac78-263">**CompareEndpoints**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)           | <span data-ttu-id="9ac78-264">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-264">Method</span></span>      | <span data-ttu-id="9ac78-265">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-265">None</span></span>  |
| [<span data-ttu-id="9ac78-266">**ExpandToEnclosingUnit**</span><span class="sxs-lookup"><span data-stu-id="9ac78-266">**ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) | <span data-ttu-id="9ac78-267">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-267">Method</span></span>      | <span data-ttu-id="9ac78-268">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-268">None</span></span>  |
| [<span data-ttu-id="9ac78-269">**FindAttribute**</span><span class="sxs-lookup"><span data-stu-id="9ac78-269">**FindAttribute**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute)                 | <span data-ttu-id="9ac78-270">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-270">Method</span></span>      | <span data-ttu-id="9ac78-271">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-271">None</span></span>  |
| [<span data-ttu-id="9ac78-272">**FindText**</span><span class="sxs-lookup"><span data-stu-id="9ac78-272">**FindText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext)                           | <span data-ttu-id="9ac78-273">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-273">Method</span></span>      | <span data-ttu-id="9ac78-274">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-274">None</span></span>  |
| [<span data-ttu-id="9ac78-275">**GetAttributeValue**</span><span class="sxs-lookup"><span data-stu-id="9ac78-275">**GetAttributeValue**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue)         | <span data-ttu-id="9ac78-276">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-276">Method</span></span>      | <span data-ttu-id="9ac78-277">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-277">None</span></span>  |
| [<span data-ttu-id="9ac78-278">**GetBoundingRectangles**</span><span class="sxs-lookup"><span data-stu-id="9ac78-278">**GetBoundingRectangles**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) | <span data-ttu-id="9ac78-279">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-279">Method</span></span>      | <span data-ttu-id="9ac78-280">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-280">None</span></span>  |
| [<span data-ttu-id="9ac78-281">**GetChildren**</span><span class="sxs-lookup"><span data-stu-id="9ac78-281">**GetChildren**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren)                     | <span data-ttu-id="9ac78-282">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-282">Method</span></span>      | <span data-ttu-id="9ac78-283">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-283">None</span></span>  |
| [<span data-ttu-id="9ac78-284">**GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="9ac78-284">**GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement)     | <span data-ttu-id="9ac78-285">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-285">Method</span></span>      | <span data-ttu-id="9ac78-286">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-286">None</span></span>  |
| [<span data-ttu-id="9ac78-287">**GetText**</span><span class="sxs-lookup"><span data-stu-id="9ac78-287">**GetText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext)                             | <span data-ttu-id="9ac78-288">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-288">Method</span></span>      | <span data-ttu-id="9ac78-289">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-289">None</span></span>  |
| [<span data-ttu-id="9ac78-290">**Activer**</span><span class="sxs-lookup"><span data-stu-id="9ac78-290">**Move**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)                                   | <span data-ttu-id="9ac78-291">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-291">Method</span></span>      | <span data-ttu-id="9ac78-292">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-292">None</span></span>  |
| [<span data-ttu-id="9ac78-293">**MoveEndpointByUnit**</span><span class="sxs-lookup"><span data-stu-id="9ac78-293">**MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)       | <span data-ttu-id="9ac78-294">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-294">Method</span></span>      | <span data-ttu-id="9ac78-295">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-295">None</span></span>  |
| [<span data-ttu-id="9ac78-296">**MoveEndpointByRange**</span><span class="sxs-lookup"><span data-stu-id="9ac78-296">**MoveEndpointByRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange)     | <span data-ttu-id="9ac78-297">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-297">Method</span></span>      | <span data-ttu-id="9ac78-298">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-298">None</span></span>  |
| [<span data-ttu-id="9ac78-299">**Sélectionner**</span><span class="sxs-lookup"><span data-stu-id="9ac78-299">**Select**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select)                               | <span data-ttu-id="9ac78-300">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-300">Method</span></span>      | <span data-ttu-id="9ac78-301">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-301">None</span></span>  |
| [<span data-ttu-id="9ac78-302">**ScrollIntoView**</span><span class="sxs-lookup"><span data-stu-id="9ac78-302">**ScrollIntoView**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview)               | <span data-ttu-id="9ac78-303">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-303">Method</span></span>      | <span data-ttu-id="9ac78-304">Aucun</span><span class="sxs-lookup"><span data-stu-id="9ac78-304">None</span></span>  |



 

<span data-ttu-id="9ac78-305">Les propriétés et méthodes supplémentaires suivantes sont requises pour implémenter l’interface [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-305">The following additional properties and methods are required for implementing the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span>



| <span data-ttu-id="9ac78-306">Membres nécessaires</span><span class="sxs-lookup"><span data-stu-id="9ac78-306">Required members</span></span>                                                      | <span data-ttu-id="9ac78-307">Type de membre</span><span class="sxs-lookup"><span data-stu-id="9ac78-307">Member type</span></span> | <span data-ttu-id="9ac78-308">Notes</span><span class="sxs-lookup"><span data-stu-id="9ac78-308">Notes</span></span>                                      |
|-----------------------------------------------------------------------|-------------|--------------------------------------------|
| [<span data-ttu-id="9ac78-309">**ShowContextMenu**</span><span class="sxs-lookup"><span data-stu-id="9ac78-309">**ShowContextMenu**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) | <span data-ttu-id="9ac78-310">Méthode</span><span class="sxs-lookup"><span data-stu-id="9ac78-310">Method</span></span>      | <span data-ttu-id="9ac78-311">Consultez la section « implémentation de ShowContextMenu ».</span><span class="sxs-lookup"><span data-stu-id="9ac78-311">See "Implementing ShowContextMenu" section</span></span> |



 

<span data-ttu-id="9ac78-312">Le modèle de contrôle **TextRange** n’a pas d’événements associés.</span><span class="sxs-lookup"><span data-stu-id="9ac78-312">The **TextRange** control pattern has no associated events.</span></span>

## <a name="supporting-text-ranges"></a><span data-ttu-id="9ac78-313">Prise en charge des plages de texte</span><span class="sxs-lookup"><span data-stu-id="9ac78-313">Supporting Text Ranges</span></span>

<span data-ttu-id="9ac78-314">Cette section décrit comment un fournisseur doit implémenter différentes méthodes des interfaces [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) et [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) pour prendre en charge le modèle de contrôle **TextRange** .</span><span class="sxs-lookup"><span data-stu-id="9ac78-314">This section describes how a provider should implement various methods of the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) and [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interfaces to support the **TextRange** control pattern.</span></span>

### <a name="manipulating-a-text-range-by-text-unit"></a><span data-ttu-id="9ac78-315">Manipulation d’une plage de texte par unité de texte</span><span class="sxs-lookup"><span data-stu-id="9ac78-315">Manipulating a Text Range by Text Unit</span></span>

<span data-ttu-id="9ac78-316">L’interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) fournit plusieurs méthodes pour manipuler et parcourir les plages de texte dans un contrôle textuel.</span><span class="sxs-lookup"><span data-stu-id="9ac78-316">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface provides several methods for manipulating and navigating text ranges in a text-based control.</span></span> <span data-ttu-id="9ac78-317">Les méthodes [**ITextRangeProvider :: Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)et [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) déplacent une plage de texte ou l’un de ses points de terminaison à l’aide de l’unité de texte spécifiée, telle que caractère, mot, paragraphe, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="9ac78-317">The [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit), and [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on.</span></span> <span data-ttu-id="9ac78-318">Pour plus d’informations, consultez [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span><span class="sxs-lookup"><span data-stu-id="9ac78-318">For more information, see [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span></span>

<span data-ttu-id="9ac78-319">En dépit de son nom, la méthode [**ITextRangeProvider :: ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) ne développe pas nécessairement une plage de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-319">Despite its name, the [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method does not necessarily expand a text range.</span></span> <span data-ttu-id="9ac78-320">Au lieu de cela, il « normalise » une plage de texte en déplaçant les points de terminaison afin que la plage englobe l’unité de texte spécifiée.</span><span class="sxs-lookup"><span data-stu-id="9ac78-320">Instead, it "normalizes" a text range by moving the endpoints so that the range encompasses the specified text unit.</span></span> <span data-ttu-id="9ac78-321">La plage est développée si elle est inférieure à l’unité spécifiée, ou réduite si elle est plus longue que l’unité spécifiée.</span><span class="sxs-lookup"><span data-stu-id="9ac78-321">The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit.</span></span> <span data-ttu-id="9ac78-322">Il est essentiel que la méthode **ExpandToEnclosingUnit** normalise toujours les plages de texte de manière cohérente ; dans le cas contraire, d’autres aspects de la manipulation de la plage de texte par unité de texte seraient imprévisibles.</span><span class="sxs-lookup"><span data-stu-id="9ac78-322">It is critical that the **ExpandToEnclosingUnit** method always normalizes text ranges in a consistent manner; otherwise, other aspects of text range manipulation by text unit would be unpredictable.</span></span> <span data-ttu-id="9ac78-323">Le diagramme suivant montre comment **ExpandToEnclosingUnit** normalise une plage de texte en déplaçant les points de terminaison de la plage.</span><span class="sxs-lookup"><span data-stu-id="9ac78-323">The following diagram shows how **ExpandToEnclosingUnit** normalizes a text range by moving the endpoints of the range.</span></span>

![Diagramme montrant les positions des points de terminaison de plage de texte avant et après un appel à ExpandToEnclosingUnit](images/expandtoenclosingunit.jpg)

<span data-ttu-id="9ac78-325">Si la plage de texte commence au début d’une unité de texte et se termine au début de la limite d’unité de texte suivante, ou avant, le point de terminaison de fin est déplacé vers la limite d’unité de texte suivante (voir 1 et 2 dans le diagramme précédent).</span><span class="sxs-lookup"><span data-stu-id="9ac78-325">If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous diagram).</span></span>

<span data-ttu-id="9ac78-326">Si la plage de texte commence au début d’une unité de texte et se termine à, ou après, la limite d’unité suivante, le point de terminaison de fin reste ou est déplacé vers la limite d’unité suivante après le point de terminaison de départ (voir 3 et 4 dans l’illustration précédente).</span><span class="sxs-lookup"><span data-stu-id="9ac78-326">If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration).</span></span> <span data-ttu-id="9ac78-327">S’il existe plusieurs limites d’unité de texte entre les points de terminaison de début et de fin, le point de terminaison de fin est déplacé vers la limite d’unité suivante après le point de terminaison de départ, ce qui a pour résultat une plage de texte d’une longueur d’une unité de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-327">If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</span></span>

<span data-ttu-id="9ac78-328">Si la plage de texte commence au milieu de l’unité de texte, le point de terminaison de départ est déplacé vers le début de l’unité de texte, et le point de terminaison de fin est déplacé vers l’avant ou vers l’arrière, le cas échéant, vers la limite d’unité suivante après le point de terminaison de départ (voir 5 à 8 dans le schéma précédent).</span><span class="sxs-lookup"><span data-stu-id="9ac78-328">If the text range starts in a middle of the text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous diagram).</span></span>

<span data-ttu-id="9ac78-329">Quand la méthode [**ITextRangeProvider :: Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) est appelée, le fournisseur normalise la plage de texte par l’unité de texte spécifiée, en utilisant la même logique de normalisation que la méthode [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-329">When the [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) method is called, the provider normalizes the text range by the specified text unit, using the same normalization logic as the [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method.</span></span> <span data-ttu-id="9ac78-330">Ensuite, le fournisseur déplace la plage vers l’arrière ou vers l’avant par le nombre spécifié d’unités de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-330">Then, the provider moves the range backward or forward by the specified number of text units.</span></span> <span data-ttu-id="9ac78-331">Lors du déplacement de la plage, le fournisseur doit ignorer les limites des objets incorporés dans le texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-331">When moving the range, the provider should ignore the boundaries of any embedded objects in the text.</span></span> <span data-ttu-id="9ac78-332">(Toutefois, la limite d’unité elle-même peut être affectée par l’existence d’un objet incorporé).</span><span class="sxs-lookup"><span data-stu-id="9ac78-332">(However, the unit boundary itself may be affected by the existence of an embedded object).</span></span> <span data-ttu-id="9ac78-333">Le diagramme suivant montre comment la méthode **Move** déplace une plage de texte, Unit by Unit, sur des objets incorporés et des limites d’unité de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-333">The following diagram demonstrates how the **Move** method moves a text range, unit by unit, across embedded objects and text unit boundaries.</span></span>

![Diagramme montrant comment la méthode Move déplace les points de terminaison de plage entre les limites d’unités d’objet et de texte](images/move.jpg)

<span data-ttu-id="9ac78-335">La méthode [**ITextRangeProvider :: MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) déplace l’un des points de terminaison vers l’avant ou vers l’arrière selon l’unité de texte spécifiée, comme le montre l’illustration suivante.</span><span class="sxs-lookup"><span data-stu-id="9ac78-335">The [**ITextRangeProvider::MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) method moves one of the endpoints forward or backward by specified text unit, as the following illustration shows.</span></span>

![Diagramme montrant comment MoveEndpointByUnit déplace le point de terminaison d’une plage](images/moveendpointbyunit.gif)

<span data-ttu-id="9ac78-337">La méthode [**ITextRangeProvider :: MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) permet à une application cliente de définir un point de terminaison d’une plage de texte au même emplacement que le point de terminaison spécifié d’une deuxième plage de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-337">The [**ITextRangeProvider::MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</span></span>

### <a name="selecting-text-in-a-text-range"></a><span data-ttu-id="9ac78-338">Sélection de texte dans une plage de texte</span><span class="sxs-lookup"><span data-stu-id="9ac78-338">Selecting Text in a Text Range</span></span>

<span data-ttu-id="9ac78-339">L’interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) comprend plusieurs méthodes pour contrôler la sélection de texte dans un contrôle textuel.</span><span class="sxs-lookup"><span data-stu-id="9ac78-339">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface includes several methods for controlling the selection of text in a text-based control.</span></span>

<span data-ttu-id="9ac78-340">La méthode [**ITextRangeProvider :: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) doit sélectionner le texte qui correspond à une plage de texte et supprimer la sélection précédente, le cas échéant, du contrôle de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-340">The [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) method should select the text that corresponds to a text range, and remove the previous selection, if any, from the text control.</span></span> <span data-ttu-id="9ac78-341">Si **Select** est appelé sur une plage de texte dégénérée, le fournisseur doit déplacer le point d’insertion vers l’emplacement de la plage de texte sans sélectionner de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-341">If **Select** is called on a degenerate text range, the provider should move the insertion point to the location of the text range without selecting any text.</span></span>

<span data-ttu-id="9ac78-342">Si un contrôle prend en charge la sélection de plusieurs étendues de texte disjointes, les méthodes [**ITextRangeProvider :: AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) et [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) ajoutent des plages de texte à, et les suppriment de, la collection de plages de texte sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="9ac78-342">If a control supports the selection of multiple, disjoint spans of text, the [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods add text ranges to, and remove them from, the collection of selected text ranges.</span></span> <span data-ttu-id="9ac78-343">Si le contrôle ne prend en charge qu’une plage de texte sélectionnée à la fois, mais que l’opération de sélection entraînerait la sélection de plusieurs plages de texte disjointes, le fournisseur doit retourner une erreur d' **E \_ INVALIDOPERATION** ou étendre ou tronquer la sélection actuelle.</span><span class="sxs-lookup"><span data-stu-id="9ac78-343">If the control only supports one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the provider should either return an **E\_INVALIDOPERATION** error, or should extend or truncate the current selection.</span></span> <span data-ttu-id="9ac78-344">La propriété [**ITextProvider :: SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) doit indiquer si un contrôle prend en charge la sélection d’une ou plusieurs étendues de texte, ou aucune.</span><span class="sxs-lookup"><span data-stu-id="9ac78-344">The [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property should indicate whether a control supports the selection of single or multiple spans of text, or none at all.</span></span>

<span data-ttu-id="9ac78-345">Si un contrôle textuel prend en charge les insertions de texte, l’appel de [**ITextRangeProvider :: AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) ou [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) sur une plage de texte dégénérée dans le contrôle doit déplacer le point d’insertion, mais ne doit pas sélectionner de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-345">If a text-based control supports text insertions, calling [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) or [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) on a degenerate text range in the control should move the insertion point but should not select any text.</span></span>

### <a name="acquiring-text-from-a-text-range"></a><span data-ttu-id="9ac78-346">Acquisition de texte à partir d’une plage de texte</span><span class="sxs-lookup"><span data-stu-id="9ac78-346">Acquiring Text from a Text Range</span></span>

<span data-ttu-id="9ac78-347">La méthode [**ITextRangeProvider :: gettext**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) doit retourner le texte brut d’une plage de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-347">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text of a text range.</span></span> <span data-ttu-id="9ac78-348">Le texte brut doit inclure tous les caractères de contrôle trouvés dans le texte source, tels que les retours chariot et la marque Unicode de gauche à droite (LRM).</span><span class="sxs-lookup"><span data-stu-id="9ac78-348">The plain text should include all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM).</span></span> <span data-ttu-id="9ac78-349">Le texte brut ne doit pas inclure de balises de balisage telles que du code HTML qui peuvent être présentes dans le texte source.</span><span class="sxs-lookup"><span data-stu-id="9ac78-349">The plain text should not include any markup tags such as HTML that may be present in the source text.</span></span> <span data-ttu-id="9ac78-350">En outre, tous les codes d’échappement du texte source doivent être convertis en équivalents en texte brut.</span><span class="sxs-lookup"><span data-stu-id="9ac78-350">Also, any escape codes in the source text should be converted to the plain text equivalents.</span></span> <span data-ttu-id="9ac78-351">Par exemple, " &nbsp; " doit être converti en un caractère d’espace simple.</span><span class="sxs-lookup"><span data-stu-id="9ac78-351">For example, "&nbsp;" should be converted to a simple space character.</span></span>

<span data-ttu-id="9ac78-352">Si un objet incorporé s’étend à une plage de texte, le texte brut doit inclure le texte interne de l’objet, mais pas le texte de remplacement (la propriété Name de l’objet incorporé), car il peut être incohérent avec le texte interne descriptif.</span><span class="sxs-lookup"><span data-stu-id="9ac78-352">If an embedded object spans a range of text, the plain text should include the inner text of the object, but not the alternative text (the name property of the embedded object) because it might be inconsistent with the descriptive inner text.</span></span> <span data-ttu-id="9ac78-353">Pour plus d’informations, consultez [Comment UI Automation expose des objets incorporés](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9ac78-353">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>

### <a name="implementing-showcontextmenu"></a><span data-ttu-id="9ac78-354">Implémentation de ShowContextMenu</span><span class="sxs-lookup"><span data-stu-id="9ac78-354">Implementing ShowContextMenu</span></span>

<span data-ttu-id="9ac78-355">[**ITextRangeProvider2 :: ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) doit toujours afficher le menu contextuel au point de terminaison de début de la plage.</span><span class="sxs-lookup"><span data-stu-id="9ac78-355">[**ITextRangeProvider2::ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) should always show the context menu at the beginning end point of the range.</span></span> <span data-ttu-id="9ac78-356">Cela doit être équivalent à ce qui se passerait si l’utilisateur a appuyé sur la touche de menu contextuel ou MAJ + F10 avec le point d’insertion au début de la plage.</span><span class="sxs-lookup"><span data-stu-id="9ac78-356">This should be equivalent to what would happen if the user pressed the context menu key or SHIFT + F10 with the insertion point at the beginning of the range.</span></span>

<span data-ttu-id="9ac78-357">Si l’indication du menu contextuel entraîne généralement le déplacement du point d’insertion vers un emplacement donné, vous devez le faire pour appeler par programmation [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) pour la prise en charge d’UI Automation.</span><span class="sxs-lookup"><span data-stu-id="9ac78-357">If showing the context menu would typically result in the insertion point moving to a given location, then it should do so for programmatically invoking [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) for UI Automation support also.</span></span>

## <a name="interoperability-with-the-system-caret"></a><span data-ttu-id="9ac78-358">Interopérabilité avec le signe insertion du système</span><span class="sxs-lookup"><span data-stu-id="9ac78-358">Interoperability with the System Caret</span></span>

<span data-ttu-id="9ac78-359">La prise en charge correcte du point d’insertion est essentielle pour de nombreuses applications clientes, notamment celles qui ne sont pas basées sur UI Automation.</span><span class="sxs-lookup"><span data-stu-id="9ac78-359">Correctly supporting the insertion point is critical to many client applications, including those not based on UI Automation.</span></span> <span data-ttu-id="9ac78-360">Dans le modèle de contrôle **Text** , le point d’insertion est représenté par une plage de texte dégénérée (vide) à la position du signe insertion du système.</span><span class="sxs-lookup"><span data-stu-id="9ac78-360">In the **Text** control pattern, the insertion point is represented by a degenerate (empty) text range at the position of the system caret.</span></span> <span data-ttu-id="9ac78-361">Lorsque le point d’insertion se déplace, un contrôle doit déclencher l’événement **TextSelectionChanged** ([**UIA \_ Text \_ TextSelectionChangedEventId**](uiauto-event-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="9ac78-361">When the insertion point moves, a control should raise the **TextSelectionChanged** event ([**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md)).</span></span> <span data-ttu-id="9ac78-362">Certaines applications clientes dépendent de cet événement pour surveiller l’emplacement du point d’insertion et pour effectuer le suivi de la sélection de texte.</span><span class="sxs-lookup"><span data-stu-id="9ac78-362">Some client applications depend on this event to monitor the location of the insertion point, and to keep track of the text selection.</span></span>

<span data-ttu-id="9ac78-363">Lorsqu’un contrôle contient du texte sélectionné, la conception actuelle du modèle de contrôle **Text** ne permet pas d’associer directement l’emplacement du point d’insertion à une plage de texte particulière.</span><span class="sxs-lookup"><span data-stu-id="9ac78-363">When a control contains selected text, the current design of the **Text** control pattern does not provide a way to directly associate the location of the insertion point with a particular text range.</span></span> <span data-ttu-id="9ac78-364">Le fournisseur doit effectuer le suivi de la sélection de texte et définir l’emplacement du point d’insertion de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="9ac78-364">The provider must keep track of the text selection and set the location of the insertion point appropriately.</span></span> <span data-ttu-id="9ac78-365">Étant donné que la sélection de texte s’effectue généralement en déplaçant le point d’insertion tout en maintenant la touche Maj ou CTRL enfoncée, ou les deux, un fournisseur peut effectuer le suivi de la sélection de texte en vérifiant l’état de ces clés à chaque modification de la sélection.</span><span class="sxs-lookup"><span data-stu-id="9ac78-365">Because selecting text is typically done by moving the insertion point while holding down the SHIFT or CTRL key, or both, a provider can track the text selection by checking the state of these keys whenever the selection changes.</span></span>

<span data-ttu-id="9ac78-366">Étant donné que l’infrastructure d’accessibilité offre une prise en charge intégrée du signe insertion du système mais pas d’un signe insertion personnalisé, les contrôles textuels doivent utiliser le signe insertion du système chaque fois que cela est possible.</span><span class="sxs-lookup"><span data-stu-id="9ac78-366">Because the accessibility framework provides built-in support for the system caret but not for a custom caret, text-based controls should use the system caret whenever possible.</span></span> <span data-ttu-id="9ac78-367">Les contrôles qui utilisent un signe insertion personnalisé peuvent garantir que le signe insertion est accessible en créant un signe insertion système qui a les mêmes dimensions que le signe insertion personnalisé et le positionnement du signe insertion système au même emplacement dans l’interface utilisateur du contrôle que le signe insertion personnalisé, c’est-à-dire au point d’insertion.</span><span class="sxs-lookup"><span data-stu-id="9ac78-367">Controls that use a custom caret can ensure that the caret is accessible by creating a system caret that has the same dimensions as the custom caret, and positioning the system caret at the same location in the UI of the control as the custom caret—that is, at the insertion point.</span></span> <span data-ttu-id="9ac78-368">En guise d’alternative, un contrôle qui utilise un signe insertion personnalisé peut implémenter un fournisseur Microsoft Active Accessibility pour le [**\_ signe insertion objid**](object-identifiers.md) pour fournir les informations d’accessibilité directement pour votre signe insertion personnalisé.</span><span class="sxs-lookup"><span data-stu-id="9ac78-368">As an alternative, a control that uses a custom caret can implement a Microsoft Active Accessibility provider for [**OBJID\_CARET**](object-identifiers.md) to provide accessibility information directly for your custom caret.</span></span>

<span data-ttu-id="9ac78-369">Pour plus d’informations sur le signe insertion du système, consultez les [signes](/windows/desktop/menurc/carets).</span><span class="sxs-lookup"><span data-stu-id="9ac78-369">For more information about the system caret, see [Carets](/windows/desktop/menurc/carets).</span></span>

<span data-ttu-id="9ac78-370">Pour tester si votre contrôle expose correctement l’emplacement du signe insertion du système, utilisez les outils [inspecter](inspect-objects.md) et [Observateur d’événements accessibles](accessible-event-watcher.md) .</span><span class="sxs-lookup"><span data-stu-id="9ac78-370">To test whether your control properly exposes the location of the system caret, use the [Inspect](inspect-objects.md) and [Accessible Event Watcher](accessible-event-watcher.md) tools.</span></span>

<span data-ttu-id="9ac78-371">Les coordonnées d’écran du centre de la bitmap du signe insertion du système doivent toujours correspondre à l’emplacement du point d’insertion.</span><span class="sxs-lookup"><span data-stu-id="9ac78-371">The screen coordinates of the center of the system caret bitmap should always match the location of the insertion point.</span></span> <span data-ttu-id="9ac78-372">De cette façon, un client peut utiliser les coordonnées d’écran du signe insertion dans un appel à [**ITextProvider :: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) pour récupérer une plage de texte qui représente précisément l’emplacement du point d’insertion.</span><span class="sxs-lookup"><span data-stu-id="9ac78-372">That way, a client can use the caret screen coordinates in a call to [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) to retrieve a text range that accurately represents the location of the insertion point.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9ac78-373">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="9ac78-373">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9ac78-374">Types de contrôle et leurs modèles de contrôle pris en charge</span><span class="sxs-lookup"><span data-stu-id="9ac78-374">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="9ac78-375">Text (type de contrôle)</span><span class="sxs-lookup"><span data-stu-id="9ac78-375">Text Control Type</span></span>](uiauto-supporttextcontroltype.md)
</dt> <dt>

[<span data-ttu-id="9ac78-376">TextEdit (modèle de contrôle)</span><span class="sxs-lookup"><span data-stu-id="9ac78-376">TextEdit Control Pattern</span></span>](textedit-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="9ac78-377">Modèle de contrôle TextChild</span><span class="sxs-lookup"><span data-stu-id="9ac78-377">TextChild Control Pattern</span></span>](textchild-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="9ac78-378">Vue d'ensemble des modèles de contrôle UI Automation</span><span class="sxs-lookup"><span data-stu-id="9ac78-378">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="9ac78-379">Prise en charge d’UI Automation pour le contenu textuel</span><span class="sxs-lookup"><span data-stu-id="9ac78-379">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="9ac78-380">Vue d’ensemble de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="9ac78-380">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 