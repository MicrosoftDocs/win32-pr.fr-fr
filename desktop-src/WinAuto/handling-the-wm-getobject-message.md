---
title: Gestion du message de WM_GETOBJECT
description: Microsoft Active Accessibility et Microsoft UI Automation envoient le \_ message WM GETOBJECT à une application serveur ou fournisseur pour extraire des informations sur un objet accessible pris en charge par le serveur ou le fournisseur.
ms.assetid: 4b8e551f-aba7-4a89-8874-ba690175f525
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 695fad8f050606f0a95a1780551d35499e39d166
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106511508"
---
# <a name="handling-the-wm_getobject-message"></a><span data-ttu-id="4b0b2-103">Gestion du message WM de \_ GETOBJECT</span><span class="sxs-lookup"><span data-stu-id="4b0b2-103">Handling the WM\_GETOBJECT Message</span></span>

<span data-ttu-id="4b0b2-104">Microsoft Active Accessibility et Microsoft UI Automation envoient le message [**WM \_ GETOBJECT**](wm-getobject.md) à une application serveur ou fournisseur pour extraire des informations sur un objet accessible pris en charge par le serveur ou le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-104">Both Microsoft Active Accessibility and Microsoft UI Automation send the [**WM\_GETOBJECT**](wm-getobject.md) message to a server or provider application to retrieve information about an accessible object supported by the server or provider.</span></span> <span data-ttu-id="4b0b2-105">Les clients n’envoient jamais de **WM \_ GETOBJECT** directement.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-105">Clients never send **WM\_GETOBJECT** directly.</span></span> <span data-ttu-id="4b0b2-106">Au lieu de cela, Microsoft Active Accessibility envoie ce message lorsqu’un client appelle les fonctions [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent)et [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) .</span><span class="sxs-lookup"><span data-stu-id="4b0b2-106">Instead, Microsoft Active Accessibility sends this message when a client calls the [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) functions.</span></span> <span data-ttu-id="4b0b2-107">UI Automation envoie **WM \_ GETOBJECT** lorsqu’un client appelle [**IUIAutomation :: ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint)et [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), et lors de la gestion des événements pour lesquels le client s’est inscrit.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-107">UI Automation sends **WM\_GETOBJECT** when a client calls [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint), and [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), and when handling events for which the client has registered.</span></span>

<span data-ttu-id="4b0b2-108">Microsoft Active Accessibility ou UI Automation spécifie le type d’objet pour lequel il a besoin d’informations en passant une valeur appelée *identificateur d’objet* avec le message [**WM \_ GETOBJECT**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="4b0b2-108">Microsoft Active Accessibility or UI Automation specifies the type of object it needs information for by passing a valued called an *object identifier* with the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="4b0b2-109">Lorsqu’il reçoit le message, le serveur ou le fournisseur examine l’identificateur d’objet pour déterminer comment répondre au message.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-109">When it receives the message, the server or provider examines the object identifier to determine how to respond to the message.</span></span> <span data-ttu-id="4b0b2-110">La réponse varie selon que l’application réceptrice implémente Microsoft Active Accessibility (un serveur), UI Automation (fournisseur), ou aucun des autres, pour l’objet spécifié.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-110">The response depends on whether the receiving application implements Microsoft Active Accessibility (a server), UI Automation (a provider), or neither, for the specified object.</span></span>

-   <span data-ttu-id="4b0b2-111">Si l’application réceptrice est un serveur Microsoft Active Accessibility et que le message [**WM \_ GETOBJECT**](wm-getobject.md) comprend un identificateur d’objet [**du \_ client objid**](object-identifiers.md), le serveur doit retourner la valeur obtenue en passant l’interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) de l’objet à la fonction [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) .</span><span class="sxs-lookup"><span data-stu-id="4b0b2-111">If the receiving application is an Microsoft Active Accessibility server and the [**WM\_GETOBJECT**](wm-getobject.md) message includes an object identifier of [**OBJID\_CLIENT**](object-identifiers.md), the server should return the value obtained by passing the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface of the object to the [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) function.</span></span>
-   <span data-ttu-id="4b0b2-112">Si l’application réceptrice est fournisseur d’Automation aUI et que l’identificateur d’objet est **UiaRootObjectId**, le fournisseur doit retourner l’interface [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) de l’objet.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-112">If the receiving application is aUI Automation provider and the object identifier is **UiaRootObjectId**, the provider should return the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface of the object.</span></span> <span data-ttu-id="4b0b2-113">Le fournisseur obtient l’interface en appelant la fonction [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) .</span><span class="sxs-lookup"><span data-stu-id="4b0b2-113">The provider obtains the interface by calling the [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) function.</span></span>
-   <span data-ttu-id="4b0b2-114">Si l’application réceptrice n’implémente ni Microsoft Active Accessibility ni UI Automation, elle doit transmettre le message [**WM \_**](wm-getobject.md) à la fonction [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="4b0b2-114">If the receiving application implements neither Microsoft Active Accessibility nor UI Automation, it should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="4b0b2-115">Le passage du message permet à l’infrastructure d’accessibilité de déterminer si un proxy est disponible pour l’objet spécifié.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-115">Passing the message enables the accessibility framework to determine if a proxy is available for the specified object.</span></span>
-   <span data-ttu-id="4b0b2-116">Si l’identificateur d’objet n’est ni [**objID \_ client**](object-identifiers.md) ni UiaRootObjectId, l’application de réception doit transmettre le message [**WM \_**](wm-getobject.md) de la fonction [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="4b0b2-116">If the object identifier is neither [**OBJID\_CLIENT**](object-identifiers.md) nor UiaRootObjectId, the receiving application should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="4b0b2-117">Le passage du message permet à l’infrastructure d’accessibilité d’utiliser les fournisseurs par défaut pour les éléments d’interface utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-117">Passing the message enables the accessibility framework to use the default providers for standard UI elements.</span></span>

<span data-ttu-id="4b0b2-118">Microsoft Active Accessibility et UI Automation peuvent transmettre des identificateurs d’objet personnalisés [**dans \_ un message WM**](wm-getobject.md) pour récupérer des valeurs ou des objets définis par l’application à partir d’un serveur ou d’un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-118">Microsoft Active Accessibility and UI Automation can pass custom object identifiers in a [**WM\_GETOBJECT**](wm-getobject.md) message to retrieve application-defined values or objects from a server or provider.</span></span> <span data-ttu-id="4b0b2-119">L’identificateur d’objet [**objID \_ NATIVEOM**](object-identifiers.md) ou [**objID \_ QUERYCLASSNAMEIDX**](object-identifiers.md) peut être utilisé pour récupérer une interface de modèle objet natif, ou pour demander un objet proxy spécifique qui est pris en charge par Oleacc.dll.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-119">The [**OBJID\_NATIVEOM**](object-identifiers.md) or [**OBJID\_QUERYCLASSNAMEIDX**](object-identifiers.md) object identifier can be used to retrieve a native Object Model interface, or to request a specific proxy object that is supported by Oleacc.dll.</span></span>

<span data-ttu-id="4b0b2-120">En gérant à la fois les identificateurs d’objet [**\_ client objid**](object-identifiers.md) et **UiaRootObjectId** , une implémentation de serveur Microsoft Active Accessibility peut coexister avec une implémentation de fournisseur UI Automation.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-120">By handling both the [**OBJID\_CLIENT**](object-identifiers.md) and **UiaRootObjectId** object identifiers, a Microsoft Active Accessibility server implementation can co-exist alongside a UI Automation provider implementation.</span></span> <span data-ttu-id="4b0b2-121">Étant donné que la plupart des contrôles Windows standard et des contrôles communs implémentés par la bibliothèque de contrôles communs (ComCtl32.dll) n’implémentent pas Microsoft Active Accessibility ou UI Automation, ces contrôles ne gèrent généralement pas le message [**WM \_ GETOBJECT**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="4b0b2-121">Because most standard Windows controls and common controls implemented by the common control library (ComCtl32.dll) do not implement either Microsoft Active Accessibility or UI Automation, these controls typically do not handle the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="4b0b2-122">Au lieu de cela, l’infrastructure Microsoft Active Accessibility ou UI Automation vérifie si un objet proxy est disponible pour un élément d’interface utilisateur particulier.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-122">Instead, the Microsoft Active Accessibility or UI Automation framework checks if a proxy object is available for a particular UI element.</span></span> <span data-ttu-id="4b0b2-123">Dans le cas contraire, il fournit l’objet proxy par défaut pour l’objet de fenêtre hôte.</span><span class="sxs-lookup"><span data-stu-id="4b0b2-123">Otherwise, it provides the default proxy object for the host window object.</span></span>

 

 