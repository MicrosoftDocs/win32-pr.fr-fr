---
title: Implémenter un fournisseur UI Automation Server-Side
description: Cette rubrique explique comment implémenter un fournisseur UI Automation côté serveur pour un contrôle personnalisé écrit en C++.
ms.assetid: c3a919b2-8b8c-4dde-ad71-587f3845a9f5
keywords:
- UI Automation, implémentation du fournisseur côté serveur
- UI Automation, implémentation du fournisseur
- UI Automation, implémenter des fournisseurs côté serveur
- UI Automation, implémenter des fournisseurs
- fournisseurs côté serveur, implémentation
- fournisseurs côté serveur, interfaces
- fournisseurs côté serveur, valeurs de propriété
- fournisseurs côté serveur, événements
- fournisseurs côté serveur, affectation d’un nouveau parent
- événements, fournisseurs côté serveur
- interfaces, fournisseurs côté serveur
- fournisseurs, implémenter
- implémentation de fournisseurs côté serveur
- implémenter des fournisseurs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7fafbb9d03a25eb2e4713330c0622c25d17f9ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "106510697"
---
# <a name="implement-a-server-side-ui-automation-provider"></a><span data-ttu-id="5d74d-117">Implémenter un fournisseur UI Automation Server-Side</span><span class="sxs-lookup"><span data-stu-id="5d74d-117">Implement a Server-Side UI Automation Provider</span></span>

<span data-ttu-id="5d74d-118">Cette rubrique explique comment implémenter un fournisseur UI Automation côté serveur pour un contrôle personnalisé écrit en C++.</span><span class="sxs-lookup"><span data-stu-id="5d74d-118">This topic describes how to implement a server-side Microsoft UI Automation provider for a custom control written in C++.</span></span> <span data-ttu-id="5d74d-119">Il contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="5d74d-119">It contains the following sections:</span></span>

-   [<span data-ttu-id="5d74d-120">Interfaces de fournisseur</span><span class="sxs-lookup"><span data-stu-id="5d74d-120">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="5d74d-121">Fonctionnalités requises pour les fournisseurs UI Automation</span><span class="sxs-lookup"><span data-stu-id="5d74d-121">Required Functionality for UI Automation Providers</span></span>](#required-functionality-for-ui-automation-providers)
-   [<span data-ttu-id="5d74d-122">Valeurs de propriété</span><span class="sxs-lookup"><span data-stu-id="5d74d-122">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="5d74d-123">Événements des fournisseurs</span><span class="sxs-lookup"><span data-stu-id="5d74d-123">Events from Providers</span></span>](#events-from-providers)
-   [<span data-ttu-id="5d74d-124">Navigation du fournisseur</span><span class="sxs-lookup"><span data-stu-id="5d74d-124">Provider Navigation</span></span>](#provider-navigation)
-   [<span data-ttu-id="5d74d-125">Affectation d’un nouveau parent</span><span class="sxs-lookup"><span data-stu-id="5d74d-125">Assigning a New Parent</span></span>](#assigning-a-new-parent)
-   [<span data-ttu-id="5d74d-126">Repositionnement du fournisseur</span><span class="sxs-lookup"><span data-stu-id="5d74d-126">Provider Repositioning</span></span>](#provider-repositioning)
-   [<span data-ttu-id="5d74d-127">Déconnexion des fournisseurs</span><span class="sxs-lookup"><span data-stu-id="5d74d-127">Disconnecting Providers</span></span>](#disconnecting-providers)
-   [<span data-ttu-id="5d74d-128">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="5d74d-128">Related topics</span></span>](#related-topics)

<span data-ttu-id="5d74d-129">Pour obtenir des exemples de code qui montrent comment implémenter des fournisseurs côté serveur, consultez [les rubriques de procédures pour les fournisseurs UI Automation](uiauto-howto-topics-for-uiautomation-providers.md).</span><span class="sxs-lookup"><span data-stu-id="5d74d-129">For code examples that show how to implement server-side providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="5d74d-130">Interfaces de fournisseur</span><span class="sxs-lookup"><span data-stu-id="5d74d-130">Provider Interfaces</span></span>

<span data-ttu-id="5d74d-131">Les interfaces COM (Component Object Model) suivantes fournissent des fonctionnalités pour les contrôles personnalisés.</span><span class="sxs-lookup"><span data-stu-id="5d74d-131">The following Component Object Model (COM) interfaces provide functionality for custom controls.</span></span> <span data-ttu-id="5d74d-132">Pour fournir des fonctionnalités de base, chaque fournisseur UI Automation doit implémenter au moins l’interface [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) .</span><span class="sxs-lookup"><span data-stu-id="5d74d-132">To provide basic functionality, every UI Automation provider must implement at least the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface.</span></span> <span data-ttu-id="5d74d-133">Les interfaces [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) et [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) sont facultatives, mais doivent être implémentées pour les éléments d’un contrôle complexe afin de fournir des fonctionnalités supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="5d74d-133">The [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) and [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) interfaces are optional, but should be implemented for elements in a complex control to provide additional functionality.</span></span>



| <span data-ttu-id="5d74d-134">Interface</span><span class="sxs-lookup"><span data-stu-id="5d74d-134">Interface</span></span>                                                                         | <span data-ttu-id="5d74d-135">Description</span><span class="sxs-lookup"><span data-stu-id="5d74d-135">Description</span></span>                                                                                                                                                                   |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5d74d-136">**IRawElementProviderSimple**</span><span class="sxs-lookup"><span data-stu-id="5d74d-136">**IRawElementProviderSimple**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)             | <span data-ttu-id="5d74d-137">Fournit des fonctionnalités de base pour un contrôle hébergé dans une fenêtre, notamment la prise en charge des modèles de contrôle et des propriétés.</span><span class="sxs-lookup"><span data-stu-id="5d74d-137">Provides basic functionality for a control hosted in a window, including support for control patterns and properties.</span></span>                                                         |
| [<span data-ttu-id="5d74d-138">**IRawElementProviderFragment**</span><span class="sxs-lookup"><span data-stu-id="5d74d-138">**IRawElementProviderFragment**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment)         | <span data-ttu-id="5d74d-139">Ajoute des fonctionnalités pour un élément dans un contrôle complexe, notamment la navigation dans le fragment, la définition du focus et le retour du rectangle englobant de l’élément.</span><span class="sxs-lookup"><span data-stu-id="5d74d-139">Adds functionality for an element in a complex control, including navigating in the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>             |
| [<span data-ttu-id="5d74d-140">**IRawElementProviderFragmentRoot**</span><span class="sxs-lookup"><span data-stu-id="5d74d-140">**IRawElementProviderFragmentRoot**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) | <span data-ttu-id="5d74d-141">Ajoute des fonctionnalités pour l'élément racine d'un contrôle complexe, y compris la localisation d'un élément enfant à des coordonnées spécifiées et la définition de l'état du focus pour l'ensemble du contrôle.</span><span class="sxs-lookup"><span data-stu-id="5d74d-141">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span> |



 

> [!Note]  
> <span data-ttu-id="5d74d-142">Dans l’API UI Automation pour le code managé, ces interfaces forment une hiérarchie d’héritage.</span><span class="sxs-lookup"><span data-stu-id="5d74d-142">In the UI Automation API for managed code, these interfaces form an inheritance hierarchy.</span></span> <span data-ttu-id="5d74d-143">Ce n’est pas le cas en C++, où les interfaces sont complètement séparées.</span><span class="sxs-lookup"><span data-stu-id="5d74d-143">This is not the case in C++, where the interfaces are completely separate.</span></span>

 

<span data-ttu-id="5d74d-144">Les interfaces suivantes fournissent des fonctionnalités supplémentaires, mais l’implémentation est facultative.</span><span class="sxs-lookup"><span data-stu-id="5d74d-144">The following interfaces provide added functionality but implementation is optional.</span></span>



| <span data-ttu-id="5d74d-145">Interface</span><span class="sxs-lookup"><span data-stu-id="5d74d-145">Interface</span></span>                                                                         | <span data-ttu-id="5d74d-146">Description</span><span class="sxs-lookup"><span data-stu-id="5d74d-146">Description</span></span>                                                                             |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="5d74d-147">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="5d74d-147">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="5d74d-148">Permet au fournisseur de suivre des demandes pour des événements.</span><span class="sxs-lookup"><span data-stu-id="5d74d-148">Enables the provider to track requests for events.</span></span>                                      |
| [<span data-ttu-id="5d74d-149">**IRawElementProviderHwndOverride**</span><span class="sxs-lookup"><span data-stu-id="5d74d-149">**IRawElementProviderHwndOverride**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) | <span data-ttu-id="5d74d-150">Active le repositionnement d’éléments basés sur une fenêtre dans l’arborescence UI Automation d’un fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-150">Enables repositioning of window-based elements in the UI Automation tree of a fragment.</span></span> |



 

## <a name="required-functionality-for-ui-automation-providers"></a><span data-ttu-id="5d74d-151">Fonctionnalités requises pour les fournisseurs UI Automation</span><span class="sxs-lookup"><span data-stu-id="5d74d-151">Required Functionality for UI Automation Providers</span></span>

<span data-ttu-id="5d74d-152">Pour communiquer avec UI Automation, votre contrôle doit implémenter les principaux domaines de fonctionnalités décrits dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="5d74d-152">To communicate with UI Automation, your control must implement the main areas of functionality described in the following table.</span></span>



| <span data-ttu-id="5d74d-153">Fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="5d74d-153">Functionality</span></span>                                              | <span data-ttu-id="5d74d-154">Implémentation</span><span class="sxs-lookup"><span data-stu-id="5d74d-154">Implementation</span></span>                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5d74d-155">Exposer le fournisseur à UI Automation.</span><span class="sxs-lookup"><span data-stu-id="5d74d-155">Expose the provider to UI Automation.</span></span>                      | <span data-ttu-id="5d74d-156">En réponse à un message [**WM \_ GETOBJECT**](wm-getobject.md) envoyé à la fenêtre de contrôle, retournez l’objet qui implémente [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span><span class="sxs-lookup"><span data-stu-id="5d74d-156">In response to a [**WM\_GETOBJECT**](wm-getobject.md) message sent to the control window, return the object that implements [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span></span> <span data-ttu-id="5d74d-157">Pour les fragments, il doit s’agir du fournisseur pour la racine du fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-157">For fragments, this must be the provider for the fragment root.</span></span>                                           |
| <span data-ttu-id="5d74d-158">Fournissez des valeurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="5d74d-158">Provide property values.</span></span>                                   | <span data-ttu-id="5d74d-159">Implémentez [**IRawElementProviderSimple :: GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) pour fournir ou substituer des valeurs.</span><span class="sxs-lookup"><span data-stu-id="5d74d-159">Implement [**IRawElementProviderSimple::GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) to provide or override values.</span></span>                                                                                                                                                             |
| <span data-ttu-id="5d74d-160">Permet au client d’interagir avec le contrôle.</span><span class="sxs-lookup"><span data-stu-id="5d74d-160">Enable the client to interact with the control.</span></span>            | <span data-ttu-id="5d74d-161">Implémentez des interfaces qui prennent en charge chaque modèle de contrôle approprié, tel que [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span><span class="sxs-lookup"><span data-stu-id="5d74d-161">Implement interfaces that support each appropriate control pattern, such as [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span></span> <span data-ttu-id="5d74d-162">Retournez ces fournisseurs de modèles de contrôle dans votre implémentation de [**IRawElementProviderSimple :: GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span><span class="sxs-lookup"><span data-stu-id="5d74d-162">Return these control pattern providers in your implementation of [**IRawElementProviderSimple::GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span></span> |
| <span data-ttu-id="5d74d-163">Déclencher des événements.</span><span class="sxs-lookup"><span data-stu-id="5d74d-163">Raise events.</span></span>                                              | <span data-ttu-id="5d74d-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), méthodes de [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span><span class="sxs-lookup"><span data-stu-id="5d74d-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), methods of [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span></span>                                                                                                                                                |
| <span data-ttu-id="5d74d-165">Activer la navigation et le focus dans un fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-165">Enable navigating and focusing in a fragment.</span></span>              | <span data-ttu-id="5d74d-166">Implémentez [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) pour chaque élément du fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-166">Implement [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) for each element within the fragment.</span></span> <span data-ttu-id="5d74d-167">Non nécessaire pour les éléments qui ne font pas partie d’un fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-167">Not necessary for elements that are not part of a fragment.</span></span>                                                                                                                         |
| <span data-ttu-id="5d74d-168">Activer le focus et la localisation des éléments enfants dans un fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-168">Enable focusing and locating child elements in a fragment.</span></span> | <span data-ttu-id="5d74d-169">Implémentez [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span><span class="sxs-lookup"><span data-stu-id="5d74d-169">Implement [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span></span> <span data-ttu-id="5d74d-170">Non nécessaire pour les éléments qui ne sont pas des racines de fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-170">Not necessary for elements that are not fragment roots.</span></span>                                                                                                                                                          |



 

## <a name="property-values"></a><span data-ttu-id="5d74d-171">Valeurs de la propriété</span><span class="sxs-lookup"><span data-stu-id="5d74d-171">Property Values</span></span>

<span data-ttu-id="5d74d-172">Les fournisseurs UI Automation pour les contrôles personnalisés doivent prendre en charge certaines propriétés qui peuvent être utilisées par UI Automation et par les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="5d74d-172">UI Automation providers for custom controls must support certain properties that can be used by UI Automation and by client applications.</span></span> <span data-ttu-id="5d74d-173">Pour les éléments hébergés dans Windows, UI Automation peut récupérer certaines propriétés du fournisseur de fenêtre par défaut, mais doit en obtenir d’autres à partir du fournisseur personnalisé.</span><span class="sxs-lookup"><span data-stu-id="5d74d-173">For elements that are hosted in windows, UI Automation can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="5d74d-174">En règle générale, les fournisseurs pour les contrôles basés sur des fenêtres n’ont pas besoin de fournir les propriétés suivantes qui sont identifiées par **PROPERTYID**:</span><span class="sxs-lookup"><span data-stu-id="5d74d-174">Typically, providers for window-based controls do not need to provide the following properties that are identified by **PROPERTYID**:</span></span>

-   [<span data-ttu-id="5d74d-175">**UIA \_ BoundingRectanglePropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-175">**UIA\_BoundingRectanglePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-176">**UIA \_ ClickablePointPropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-176">**UIA\_ClickablePointPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-177">**UIA \_ ProcessIdPropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-177">**UIA\_ProcessIdPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-178">**UIA \_ ClassNamePropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-178">**UIA\_ClassNamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-179">**UIA \_ HasKeyboardFocusPropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-179">**UIA\_HasKeyboardFocusPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-180">**UIA \_ IsEnabledPropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-180">**UIA\_IsEnabledPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-181">**UIA \_ IsKeyboardFocusablePropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-181">**UIA\_IsKeyboardFocusablePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-182">**UIA \_ IsPasswordPropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-182">**UIA\_IsPasswordPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-183">**UIA \_ NamePropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-183">**UIA\_NamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="5d74d-184">**UIA \_ RuntimeIdPropertyId**</span><span class="sxs-lookup"><span data-stu-id="5d74d-184">**UIA\_RuntimeIdPropertyId**</span></span>](uiauto-automation-element-propids.md)

<span data-ttu-id="5d74d-185">La propriété RuntimeId d’un élément simple ou d’une racine de fragment hébergée dans une fenêtre est obtenue à partir de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="5d74d-185">The RuntimeId property of a simple element or fragment root hosted in a window is obtained from the window.</span></span> <span data-ttu-id="5d74d-186">Toutefois, les éléments fragments situés sous la racine, tels que les éléments de liste dans une zone de liste, doivent fournir leurs propres identificateurs.</span><span class="sxs-lookup"><span data-stu-id="5d74d-186">However, fragment elements below the root, such as list items in a list box, must provide their own identifiers.</span></span> <span data-ttu-id="5d74d-187">Pour plus d’informations, consultez [**IRawElementProviderFragment :: GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span><span class="sxs-lookup"><span data-stu-id="5d74d-187">For more information, see [**IRawElementProviderFragment::GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span></span>

<span data-ttu-id="5d74d-188">La propriété IsKeyboardFocusable doit être retournée pour les fournisseurs hébergés dans un contrôle Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="5d74d-188">The IsKeyboardFocusable property should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="5d74d-189">Dans ce cas, le fournisseur de fenêtre par défaut ne pourra peut-être pas récupérer la bonne valeur.</span><span class="sxs-lookup"><span data-stu-id="5d74d-189">In this case, the default window provider may be unable to retrieve the correct value.</span></span>

<span data-ttu-id="5d74d-190">La propriété Name est généralement fournie par le fournisseur hôte.</span><span class="sxs-lookup"><span data-stu-id="5d74d-190">The Name property is usually supplied by the host provider.</span></span>

## <a name="events-from-providers"></a><span data-ttu-id="5d74d-191">Événements des fournisseurs</span><span class="sxs-lookup"><span data-stu-id="5d74d-191">Events from Providers</span></span>

<span data-ttu-id="5d74d-192">Les fournisseurs UI Automation doivent déclencher des événements pour informer les applications clientes des modifications de l’état de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5d74d-192">UI Automation providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="5d74d-193">Les fonctions suivantes sont utilisées pour déclencher des événements.</span><span class="sxs-lookup"><span data-stu-id="5d74d-193">The following functions are used to raise events.</span></span>



| <span data-ttu-id="5d74d-194">Fonction</span><span class="sxs-lookup"><span data-stu-id="5d74d-194">Function</span></span>                                                                                   | <span data-ttu-id="5d74d-195">Description</span><span class="sxs-lookup"><span data-stu-id="5d74d-195">Description</span></span>                                                                                                              |
|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5d74d-196">**UiaRaiseAutomationEvent**</span><span class="sxs-lookup"><span data-stu-id="5d74d-196">**UiaRaiseAutomationEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent)                  | <span data-ttu-id="5d74d-197">Déclenche différents événements, y compris les événements déclenchés par les modèles de contrôle.</span><span class="sxs-lookup"><span data-stu-id="5d74d-197">Raises various events, including events triggered by control patterns.</span></span>                                                   |
| [<span data-ttu-id="5d74d-198">**UiaRaiseAutomationPropertyChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="5d74d-198">**UiaRaiseAutomationPropertyChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationpropertychangedevent) | <span data-ttu-id="5d74d-199">Déclenche un événement lorsqu’une propriété UI Automation a changé.</span><span class="sxs-lookup"><span data-stu-id="5d74d-199">Raises an event when a UI Automation property has changed.</span></span>                                                               |
| [<span data-ttu-id="5d74d-200">**UiaRaiseStructureChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="5d74d-200">**UiaRaiseStructureChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraisestructurechangedevent)      | <span data-ttu-id="5d74d-201">Déclenche un événement lorsque la structure de l’arborescence UI Automation a changé, par exemple en supprimant ou en ajoutant un élément.</span><span class="sxs-lookup"><span data-stu-id="5d74d-201">Raises an event when the structure of the UI Automation tree has changed, for example, by removing or adding an element.</span></span> |



 

<span data-ttu-id="5d74d-202">L’objectif d’un événement est d’informer le client d’un événement qui se produit dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5d74d-202">The purpose of an event is to notify the client of something taking place in the UI.</span></span> <span data-ttu-id="5d74d-203">Les fournisseurs doivent déclencher un événement que la modification ait été déclenchée par l’utilisateur ou par une application cliente à l’aide d’UI Automation.</span><span class="sxs-lookup"><span data-stu-id="5d74d-203">Providers should raise an event regardless of whether the change was triggered by user input or by a client application using UI Automation.</span></span> <span data-ttu-id="5d74d-204">Par exemple, l’événement identifié par [**UIA \_ Invoke \_ InvokedEventId**](uiauto-event-ids.md) doit être déclenché chaque fois que le contrôle est appelé, via une entrée d’utilisateur directe ou par l’application cliente appelant [**IUIAutomationInvokePattern :: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="5d74d-204">For example, the event identified by [**UIA\_Invoke\_InvokedEventId**](uiauto-event-ids.md) should be raised whenever the control is invoked, either through direct user input or by the client application calling [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="5d74d-205">Pour optimiser les performances, un fournisseur peut déclencher des événements de manière sélective ou ne pas en déclencher du tout si aucune application cliente n'est enregistrée pour les recevoir.</span><span class="sxs-lookup"><span data-stu-id="5d74d-205">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="5d74d-206">Les éléments d’API suivants sont utilisés pour l’optimisation.</span><span class="sxs-lookup"><span data-stu-id="5d74d-206">The following API elements are used for optimization.</span></span>



| <span data-ttu-id="5d74d-207">Élément API</span><span class="sxs-lookup"><span data-stu-id="5d74d-207">API Element</span></span>                                                                       | <span data-ttu-id="5d74d-208">Description</span><span class="sxs-lookup"><span data-stu-id="5d74d-208">Description</span></span>                                                                                                                                                       |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5d74d-209">**UiaClientsAreListening**</span><span class="sxs-lookup"><span data-stu-id="5d74d-209">**UiaClientsAreListening**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening)           | <span data-ttu-id="5d74d-210">Cette fonction vérifie si des applications clientes sont abonnées à des événements UI Automation.</span><span class="sxs-lookup"><span data-stu-id="5d74d-210">This function ascertains whether any client applications have subscribed to UI Automation events.</span></span>                                                                 |
| [<span data-ttu-id="5d74d-211">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="5d74d-211">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="5d74d-212">L’implémentation de cette interface sur une racine de fragment permet au fournisseur d’être informé lorsque les clients enregistrent et annulent l’inscription des gestionnaires d’événements pour les événements sur le fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-212">Implementing this interface on a fragment root enables the provider to be advised when clients register and unregister event handlers for events on the fragment.</span></span> |



 

> [!Note]  
> <span data-ttu-id="5d74d-213">À l’instar de l’implémentation du décompte de références dans la programmation COM, il est important que les fournisseurs UI Automation traitent les méthodes [**IRawElementProviderAdviseEvents :: AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) et [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) comme les méthodes [**IUnknown :: AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) et [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) de l’interface [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="5d74d-213">Similar to implementing reference counting in COM programming, it is important for UI Automation providers to treat the [**IRawElementProviderAdviseEvents::AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) and [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) methods like the [**IUnknown::AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) and [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) methods of the [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="5d74d-214">Tant que **AdviseEventAdded** a été appelé plus de fois que **AdviseEventRemoved** pour un événement ou une propriété spécifique, le fournisseur doit continuer à déclencher des événements correspondants, car certains clients continuent d’écouter.</span><span class="sxs-lookup"><span data-stu-id="5d74d-214">As long as **AdviseEventAdded** has been called more times than **AdviseEventRemoved** for a specific event or property, the provider should continue to raise corresponding events, because some clients are still listening.</span></span> <span data-ttu-id="5d74d-215">Les fournisseurs UI Automation peuvent également utiliser la fonction [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) pour déterminer si au moins un client écoute et, le cas échéant, déclencher tous les événements appropriés.</span><span class="sxs-lookup"><span data-stu-id="5d74d-215">Alternatively, UI Automation providers can use the [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) function to determine whether at least one client is listening and, if so, raise all appropriate events.</span></span>

 

## <a name="provider-navigation"></a><span data-ttu-id="5d74d-216">Navigation du fournisseur</span><span class="sxs-lookup"><span data-stu-id="5d74d-216">Provider Navigation</span></span>

<span data-ttu-id="5d74d-217">Les fournisseurs pour les contrôles simples, tels qu’un bouton personnalisé hébergé dans une fenêtre, n’ont pas besoin de prendre en charge la navigation dans l’arborescence UI Automation.</span><span class="sxs-lookup"><span data-stu-id="5d74d-217">Providers for simple controls, such as a custom button hosted in a window, do not need to support navigation in the UI Automation tree.</span></span> <span data-ttu-id="5d74d-218">La navigation vers et depuis l’élément est gérée par le fournisseur par défaut de la fenêtre hôte, qui est spécifié dans l’implémentation de [**IRawElementProviderSimple :: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span><span class="sxs-lookup"><span data-stu-id="5d74d-218">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span></span> <span data-ttu-id="5d74d-219">Quand vous implémentez un fournisseur pour un contrôle personnalisé complexe, vous devez toutefois prendre en charge la navigation entre le nœud racine du fragment et ses descendants, et entre nœuds frères.</span><span class="sxs-lookup"><span data-stu-id="5d74d-219">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!Note]  
> <span data-ttu-id="5d74d-220">Les éléments d’un fragment autre que la racine doivent retourner la **valeur null** à partir de [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), car ils ne sont pas hébergés directement dans une fenêtre et aucun fournisseur par défaut ne peut prendre en charge la navigation vers et à partir de ceux-ci.</span><span class="sxs-lookup"><span data-stu-id="5d74d-220">Elements of a fragment other than the root must return **NULL** from [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

 

<span data-ttu-id="5d74d-221">La structure du fragment est déterminée par votre implémentation de [**IRawElementProviderFragment :: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span><span class="sxs-lookup"><span data-stu-id="5d74d-221">The structure of the fragment is determined by your implementation of [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span></span> <span data-ttu-id="5d74d-222">Pour chaque direction possible à partir de chaque fragment, cette méthode retourne l'objet fournisseur de l'élément dans cette direction.</span><span class="sxs-lookup"><span data-stu-id="5d74d-222">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="5d74d-223">S’il n’y a aucun élément dans cette direction, la méthode retourne la **valeur null**.</span><span class="sxs-lookup"><span data-stu-id="5d74d-223">If there is no element in that direction, the method returns **NULL**.</span></span>

<span data-ttu-id="5d74d-224">La racine du fragment ne prend en charge la navigation que vers les éléments enfants.</span><span class="sxs-lookup"><span data-stu-id="5d74d-224">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="5d74d-225">Par exemple, une zone de liste retourne le premier élément de la liste lorsque la direction est **NavigateDirection \_ firstChild**, et retourne le dernier élément lorsque la direction est **NavigateDirection \_ LastChild**.</span><span class="sxs-lookup"><span data-stu-id="5d74d-225">For example, a list box returns the first item in the list when the direction is **NavigateDirection\_FirstChild**, and returns the last item when the direction is **NavigateDirection\_LastChild**.</span></span> <span data-ttu-id="5d74d-226">La racine du fragment ne prend pas en charge la navigation vers un parent ou des frères. Cela est géré par le fournisseur de fenêtre hôte.</span><span class="sxs-lookup"><span data-stu-id="5d74d-226">The fragment root does not support navigation to a parent or to siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="5d74d-227">Les éléments d'un fragment qui ne sont pas la racine doivent prendre en charge la navigation vers le parent et tous leurs frères et enfants.</span><span class="sxs-lookup"><span data-stu-id="5d74d-227">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

## <a name="assigning-a-new-parent"></a><span data-ttu-id="5d74d-228">Affectation d’un nouveau parent</span><span class="sxs-lookup"><span data-stu-id="5d74d-228">Assigning a New Parent</span></span>

<span data-ttu-id="5d74d-229">Les fenêtres indépendantes sont en fait des fenêtres de niveau supérieur et, par défaut, s’affichent dans l’arborescence UI Automation en tant qu’enfants du bureau.</span><span class="sxs-lookup"><span data-stu-id="5d74d-229">Pop-up windows are actually top-level windows, and by default, appear in the UI Automation tree as children of the desktop.</span></span> <span data-ttu-id="5d74d-230">Dans de nombreux cas, toutefois, les fenêtres indépendantes sont logiquement des enfants d'autres contrôles.</span><span class="sxs-lookup"><span data-stu-id="5d74d-230">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="5d74d-231">Par exemple, la liste déroulante d'une zone de liste modifiable est logiquement un enfant de la zone de liste modifiable.</span><span class="sxs-lookup"><span data-stu-id="5d74d-231">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="5d74d-232">De la même façon, une fenêtre indépendante de menu est logiquement un enfant du menu.</span><span class="sxs-lookup"><span data-stu-id="5d74d-232">Similarly, a menu pop-up window is logically a child of the menu.</span></span> <span data-ttu-id="5d74d-233">UI Automation fournit la prise en charge pour assigner un nouveau parent à une fenêtre indépendante afin qu’il semble être un enfant du contrôle associé.</span><span class="sxs-lookup"><span data-stu-id="5d74d-233">UI Automation provides support to assign a new parent to a pop-up window so that it appears to be a child of the associated control.</span></span>

<span data-ttu-id="5d74d-234">Pour assigner un nouveau parent à une fenêtre indépendante :</span><span class="sxs-lookup"><span data-stu-id="5d74d-234">To assign a new parent to a pop-up window:</span></span>

1.  <span data-ttu-id="5d74d-235">Créez un fournisseur pour la fenêtre indépendante.</span><span class="sxs-lookup"><span data-stu-id="5d74d-235">Create a provider for the pop-up window.</span></span> <span data-ttu-id="5d74d-236">Cela requiert que la classe de la fenêtre indépendante soit connue à l’avance.</span><span class="sxs-lookup"><span data-stu-id="5d74d-236">This requires that the class of the pop-up window be known in advance.</span></span>
2.  <span data-ttu-id="5d74d-237">Implémentez toutes les propriétés et tous les modèles de contrôle comme d’habitude pour cette fenêtre contextuelle, comme s’il s’agissait d’un contrôle dans son propre droit.</span><span class="sxs-lookup"><span data-stu-id="5d74d-237">Implement all properties and control patterns as usual for that pop-up, as though it were a control in its own right.</span></span>
3.  <span data-ttu-id="5d74d-238">Implémentez la propriété [**IRawElementProviderSimple :: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) pour qu’elle retourne la valeur obtenue à partir de [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), où le paramètre est le handle de fenêtre de la fenêtre indépendante.</span><span class="sxs-lookup"><span data-stu-id="5d74d-238">Implement the [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) property so that it returns the value obtained from [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), where the parameter is the window handle of the pop-up window.</span></span>
4.  <span data-ttu-id="5d74d-239">Implémentez [**IRawElementProviderFragment :: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) pour la fenêtre indépendante et son parent afin que la navigation soit gérée correctement du parent logique aux enfants logiques, et entre les enfants frères.</span><span class="sxs-lookup"><span data-stu-id="5d74d-239">Implement [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="5d74d-240">Quand UI Automation rencontre la fenêtre indépendante, il reconnaît que la navigation est remplacée par rapport à la valeur par défaut et ignore la fenêtre indépendante lorsqu’elle est rencontrée en tant qu’enfant du bureau.</span><span class="sxs-lookup"><span data-stu-id="5d74d-240">When UI Automation encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="5d74d-241">Au lieu de cela, le nœud est accessible uniquement via le fragment.</span><span class="sxs-lookup"><span data-stu-id="5d74d-241">Instead, the node is reachable only through the fragment.</span></span>

<span data-ttu-id="5d74d-242">L’attribution d’un nouveau parent n’est pas appropriée dans les cas où un contrôle peut héberger une fenêtre de n’importe quelle classe.</span><span class="sxs-lookup"><span data-stu-id="5d74d-242">Assigning a new parent is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="5d74d-243">Par exemple, un contrôle rebar peut héberger n’importe quel type de fenêtre dans ses bandes.</span><span class="sxs-lookup"><span data-stu-id="5d74d-243">For example, a rebar control can host any type of window in its bands.</span></span> <span data-ttu-id="5d74d-244">Pour gérer ces cas, UI Automation prend en charge une autre forme de réadressage de fenêtre, comme décrit dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="5d74d-244">To handle these cases, UI Automation supports an alternative form of window relocation, as described in the next section.</span></span>

## <a name="provider-repositioning"></a><span data-ttu-id="5d74d-245">Repositionnement du fournisseur</span><span class="sxs-lookup"><span data-stu-id="5d74d-245">Provider Repositioning</span></span>

<span data-ttu-id="5d74d-246">Les fragments UI Automation peuvent contenir deux éléments ou plus qui sont tous contenus dans une fenêtre.</span><span class="sxs-lookup"><span data-stu-id="5d74d-246">UI Automation fragments may contain two or more elements that are each contained in a window.</span></span> <span data-ttu-id="5d74d-247">Étant donné que chaque fenêtre possède son propre fournisseur par défaut qui considère que la fenêtre est un enfant d’une fenêtre conteneur, l’arborescence UI Automation par défaut affiche les fenêtres dans le fragment en tant qu’enfants de la fenêtre parente.</span><span class="sxs-lookup"><span data-stu-id="5d74d-247">Because each window has its own default provider that considers the window to be a child of a containing window, the UI Automation tree by default, will show the windows in the fragment as children of the parent window.</span></span> <span data-ttu-id="5d74d-248">Dans la plupart des cas, ce comportement est souhaitable, mais il peut parfois entraîner une confusion, car il ne correspond pas à la structure logique de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5d74d-248">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the UI.</span></span>

<span data-ttu-id="5d74d-249">Le contrôle rebar en est un bon exemple.</span><span class="sxs-lookup"><span data-stu-id="5d74d-249">A good example of this is a rebar control.</span></span> <span data-ttu-id="5d74d-250">Un contrôle rebar contient des bandes, qui peuvent à leur tour contenir un contrôle basé sur une fenêtre, tel qu’une barre d’outils, une zone d’édition ou une zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="5d74d-250">A rebar control contains bands, each of which can in turn contain a window-based control, such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="5d74d-251">Le fournisseur de fenêtre par défaut pour la fenêtre Rebar voit les fenêtres de contrôle de bande comme enfants et le fournisseur Rebar voit les bandes comme des enfants.</span><span class="sxs-lookup"><span data-stu-id="5d74d-251">The default window provider for the rebar window sees the band control windows as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="5d74d-252">Étant donné que le fournisseur de fenêtre et le fournisseur Rebar travaillent en tandem et qu’ils combinent leurs enfants, les bandes et les contrôles basés sur des fenêtres apparaissent en tant qu’enfants du contrôle rebar.</span><span class="sxs-lookup"><span data-stu-id="5d74d-252">Because the window provider and the rebar provider are working in tandem and combining their children, both the bands and the window-based controls appear as children of the rebar control.</span></span> <span data-ttu-id="5d74d-253">Toutefois, seules les bandes doivent apparaître en tant qu’enfants du contrôle rebar, et chaque fournisseur de bandes doit être associé au fournisseur de fenêtre par défaut pour le contrôle qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="5d74d-253">Logically, however, only the bands should appear as children of the rebar control, and each band provider should be coupled with the default window provider for the control it contains.</span></span>

<span data-ttu-id="5d74d-254">Pour ce faire, le fournisseur de la racine du fragment pour le contrôle rebar expose un jeu d’enfants représentant les bandes.</span><span class="sxs-lookup"><span data-stu-id="5d74d-254">To accomplish this, the fragment root provider for the rebar control exposes a set of children representing the bands.</span></span> <span data-ttu-id="5d74d-255">Chaque bande possède un seul fournisseur qui peut exposer des propriétés et des modèles de contrôle.</span><span class="sxs-lookup"><span data-stu-id="5d74d-255">Each band has a single provider that may expose properties and control patterns.</span></span> <span data-ttu-id="5d74d-256">Dans son implémentation de [**IRawElementProviderSimple :: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), le fournisseur de bandes retourne le fournisseur de fenêtre par défaut pour la fenêtre de contrôle, qu’il obtient en appelant [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), en passant le handle de fenêtre (**HWND**) du contrôle.</span><span class="sxs-lookup"><span data-stu-id="5d74d-256">In its implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), the band provider returns the default window provider for the control window, which it obtains by calling [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passing in the control's window handle (**HWND**).</span></span> <span data-ttu-id="5d74d-257">Enfin, le fournisseur de la racine du fragment pour le rebar implémente l’interface [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) et, dans son implémentation de [**IRawElementProviderHwndOverride :: GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), il retourne le fournisseur de bandes approprié pour le contrôle contenu dans la fenêtre spécifiée.</span><span class="sxs-lookup"><span data-stu-id="5d74d-257">Finally, the fragment root provider for the rebar implements the [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) interface, and in its implementation of [**IRawElementProviderHwndOverride::GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), it returns the appropriate band provider for the control contained in the specified window.</span></span>

## <a name="disconnecting-providers"></a><span data-ttu-id="5d74d-258">Déconnexion des fournisseurs</span><span class="sxs-lookup"><span data-stu-id="5d74d-258">Disconnecting Providers</span></span>

<span data-ttu-id="5d74d-259">Les applications créent généralement des contrôles tels qu’ils sont nécessaires et les détruisent par la suite.</span><span class="sxs-lookup"><span data-stu-id="5d74d-259">Applications typically create controls as they are needed and destroy them afterward.</span></span> <span data-ttu-id="5d74d-260">Après la destruction d’un contrôle, les ressources du fournisseur UI Automation associées au contrôle doivent être libérées en appelant [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span><span class="sxs-lookup"><span data-stu-id="5d74d-260">After destroying a control, the UI Automation provider resources associated with the control should be released by calling the [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span></span>

<span data-ttu-id="5d74d-261">De même, une application doit utiliser la fonction [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) pour libérer toutes les ressources UI Automation détenues par tous les fournisseurs dans l’application avant l’arrêt.</span><span class="sxs-lookup"><span data-stu-id="5d74d-261">Similarly, an application should use the [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) function to release all UI Automation resources held by all providers in the application before shutting down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5d74d-262">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="5d74d-262">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5d74d-263">Guide du programmeur du fournisseur UI Automation</span><span class="sxs-lookup"><span data-stu-id="5d74d-263">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 