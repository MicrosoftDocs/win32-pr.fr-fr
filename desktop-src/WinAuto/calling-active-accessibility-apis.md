---
title: Appel d’API Active Accessibility
description: Microsoft Active Accessibility fournit des interfaces de programmation d’applications (API) pour les clients et les serveurs.
ms.assetid: c40441d2-7294-4c76-8b42-08ed66eccb7e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 209a239495fddbcaf2275f095abc889295568b3c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031383"
---
# <a name="calling-active-accessibility-apis"></a><span data-ttu-id="3f114-103">Appel d’API Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="3f114-103">Calling Active Accessibility APIs</span></span>

<span data-ttu-id="3f114-104">Microsoft Active Accessibility fournit des interfaces de programmation d’applications (API) pour les clients et les serveurs.</span><span class="sxs-lookup"><span data-stu-id="3f114-104">Microsoft Active Accessibility provides application programming interfaces (APIs) for both clients and servers.</span></span> <span data-ttu-id="3f114-105">La plupart d’entre elles sont implémentées dans la bibliothèque de liens dynamiques de Microsoft Active Accessibility, Oleacc.dll, mais [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook)et [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) sont implémentées dans user32.dll, qui est un composant fondamental du système d’exploitation Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="3f114-105">Most are implemented in the Microsoft Active Accessibility dynamic-link library, Oleacc.dll, but [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook), and [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) are implemented in user32.dll, which is a core component of the Microsoft Windows operating system.</span></span>

<span data-ttu-id="3f114-106">Les ordinateurs qui exécutent Windows 95 ou Microsoft Windows NT 4,0 ne disposent pas de Oleacc.dll et de la version correcte de user32.dll installée, car Microsoft Active Accessibility a été incorporé dans les versions suivantes de Windows.</span><span class="sxs-lookup"><span data-stu-id="3f114-106">Computers running Windows 95 or Microsoft Windows NT 4.0 do not have Oleacc.dll and the correct version of user32.dll installed because Microsoft Active Accessibility was incorporated in stages into succeeding versions of Windows.</span></span> <span data-ttu-id="3f114-107">Par conséquent, les applications qui s’exécutent sur ces plateformes sont explicitement liées à Oleacc.dll au moment de l’exécution à l’aide de la fonction [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) au lieu de s’appuyer sur les bibliothèques d’importation.</span><span class="sxs-lookup"><span data-stu-id="3f114-107">As a result, applications that run on these platforms explicitly link to Oleacc.dll at run time using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function instead of relying on import libraries.</span></span> <span data-ttu-id="3f114-108">Active Accessibility 1,3 prend en charge Windows 95 et Microsoft Windows NT 4,0.</span><span class="sxs-lookup"><span data-stu-id="3f114-108">Active Accessibility 1.3 supports Windows 95 and Microsoft Windows NT 4.0.</span></span> <span data-ttu-id="3f114-109">Les versions antérieures de Windows ne sont pas prises en charge par Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="3f114-109">Earlier versions of Windows are not supported by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="3f114-110">Les applications serveur utilisent la fonction [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) pour récupérer l’adresse d’une fonction de Active Accessibility Microsoft, puis effectuer l’appel via un pointeur de fonction.</span><span class="sxs-lookup"><span data-stu-id="3f114-110">Server applications use the [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) function to retrieve the address of an Microsoft Active Accessibility function and then make the call through a function pointer.</span></span> <span data-ttu-id="3f114-111">Si vous appelez une fonction implémentée dans Oleacc.dll, les applications serveur utilisent le handle retourné par [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) dans l’appel à **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="3f114-111">If calling a function that was implemented in Oleacc.dll, server applications use the handle returned from [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) in the call to **GetProcAddress**.</span></span> <span data-ttu-id="3f114-112">Si vous appelez une fonction définie dans user32.dll, les applications serveur appellent [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) en spécifiant « User32 » et utilisent le handle de module retourné dans l’appel à **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="3f114-112">If calling a function defined in user32.dll, server applications call [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) specifying "USER32" and use the returned module handle in the call to **GetProcAddress**.</span></span>

<span data-ttu-id="3f114-113">Par exemple, si une application utilise [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), elle appelle [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) à l’aide du handle de module de user32.dll pour obtenir l’adresse de la fonction.</span><span class="sxs-lookup"><span data-stu-id="3f114-113">For example, if an application uses [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), it calls [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) using the module handle of user32.dll to get the address of the function.</span></span> <span data-ttu-id="3f114-114">Si l’appel réussit (ce qui signifie que cette version de Windows prend en charge Microsoft Active Accessibility), l’application définit un indicateur qui indique qu’il est possible d’appeler **NotifyWinEvent** en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="3f114-114">If the call is successful (meaning that this version of Windows supports Microsoft Active Accessibility), then the application sets a flag that indicates that it is safe to call **NotifyWinEvent**.</span></span> <span data-ttu-id="3f114-115">L’adresse reçue de **GetProcAddress** est stockée dans une variable de pointeur de fonction et utilisée dans le code.</span><span class="sxs-lookup"><span data-stu-id="3f114-115">The address received from **GetProcAddress** is stored in a function pointer variable and used throughout the code.</span></span>

 

 