---
title: Exposer des éléments de la zone de liste Owner-Drawn
description: Les développeurs d’applications n’ont pas besoin d’implémenter IAccessible pour exposer les éléments d’une zone de liste owner-drawn dont le style est LBS \_ HASSTRINGS car Microsoft Active Accessibility expose les éléments dans les zones de liste avec ce style.
ms.assetid: d54ce297-ce8a-46c0-a86d-4acffa1eda27
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2fbb72285f55796a285cd6e1a8838a629218659b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104382417"
---
# <a name="exposing-owner-drawn-list-box-items"></a><span data-ttu-id="10f87-103">Exposer des éléments de la zone de liste Owner-Drawn</span><span class="sxs-lookup"><span data-stu-id="10f87-103">Exposing Owner-Drawn List Box Items</span></span>

<span data-ttu-id="10f87-104">Les développeurs d’applications n’ont pas besoin d’implémenter [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) pour exposer les éléments d’une zone de liste owner-drawn dont le style est **lbs \_ HASSTRINGS** car Microsoft Active Accessibility expose les éléments dans les zones de liste avec ce style.</span><span class="sxs-lookup"><span data-stu-id="10f87-104">Application developers do not need to implement [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) to expose the items in an owner-drawn list box that has the style **LBS\_HASSTRINGS** because Microsoft Active Accessibility exposes the items in list boxes with this style.</span></span> <span data-ttu-id="10f87-105">Les éléments d’une zone de liste owner-drawn avec le style **\_ HASSTRINGS** s’affichent sous forme de texte.</span><span class="sxs-lookup"><span data-stu-id="10f87-105">The items in an owner-drawn list box with the **LBS\_HASSTRINGS** style are displayed as text.</span></span> <span data-ttu-id="10f87-106">Toutefois, ce style est également utilisé avec les zones de liste owner-drawn qui n’affichent pas de texte afin que les éléments de la zone de liste soient exposés par Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="10f87-106">However, this style is also used with owner-drawn list boxes that do not display text so that the list box items are exposed by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="10f87-107">Pour permettre à Microsoft Active Accessibility d’exposer les éléments d’une zone de liste owner-drawn qui n’affiche pas de texte :</span><span class="sxs-lookup"><span data-stu-id="10f87-107">To allow Microsoft Active Accessibility to expose the items in an owner-drawn list box that does not display text:</span></span>

-   <span data-ttu-id="10f87-108">Utilisez le style **lbs \_ HASSTRINGS** lors de la création de la zone de liste.</span><span class="sxs-lookup"><span data-stu-id="10f87-108">Use the **LBS\_HASSTRINGS** style when creating the list box.</span></span>
-   <span data-ttu-id="10f87-109">Créez un équivalent textuel qui nomme ou décrit chaque élément de la zone de liste.</span><span class="sxs-lookup"><span data-stu-id="10f87-109">Create a textual counterpart that names or describes each item in the list box.</span></span>
-   <span data-ttu-id="10f87-110">Lorsque vous ajoutez des éléments à la zone de liste owner-drawn, utilisez le message [lb \_ ADDSTRING](../controls/lb-addstring.md) pour ajouter le texte que vous souhaitez que Microsoft Active Accessibility exposer.</span><span class="sxs-lookup"><span data-stu-id="10f87-110">When adding items to the owner-drawn list box, use the [LB\_ADDSTRING](../controls/lb-addstring.md) message to add the text that you want Microsoft Active Accessibility to expose.</span></span> <span data-ttu-id="10f87-111">Ce texte n’est pas affiché, donc il ne fait pas partie des données owner-drawn.</span><span class="sxs-lookup"><span data-stu-id="10f87-111">This text is not displayed, so it is not part of the owner-drawn data.</span></span> <span data-ttu-id="10f87-112">Ajoutez les données de l’élément owner-drawn à l’aide du message [lb \_ SETITEMDATA](../controls/lb-setitemdata.md) .</span><span class="sxs-lookup"><span data-stu-id="10f87-112">Add the owner-drawn item data using the [LB\_SETITEMDATA](../controls/lb-setitemdata.md) message.</span></span>

<span data-ttu-id="10f87-113">Lorsque vous utilisez la méthode ci-dessus, notez les points suivants :</span><span class="sxs-lookup"><span data-stu-id="10f87-113">When using the above method, note the following:</span></span>

-   <span data-ttu-id="10f87-114">Si vous utilisez le style de **\_ Tri lbs** , la zone de liste est triée à l’aide des chaînes fournies et non de la procédure de rappel [WM \_ COMPAREITEM](../controls/wm-compareitem.md) .</span><span class="sxs-lookup"><span data-stu-id="10f87-114">If you use the **LBS\_SORT** style, the list box is sorted using the supplied strings and not the [WM\_COMPAREITEM](../controls/wm-compareitem.md) callback procedure.</span></span>
-   <span data-ttu-id="10f87-115">Avec les zones de liste de variables owner-drawn créées avec le style **lbs \_ OWNERDRAWVARIABLE**, utilisez une variable globale ou un autre mécanisme pour suivre le moment où le **membre ItemData** du [measureitemstruct,](/windows/win32/api/winuser/ns-winuser-measureitemstruct) est valide.</span><span class="sxs-lookup"><span data-stu-id="10f87-115">With owner-drawn variable list boxes created with the style **LBS\_OWNERDRAWVARIABLE**, use a global variable or some other mechanism to keep track of when the **itemData member** of the [MEASUREITEMSTRUCT](/windows/win32/api/winuser/ns-winuser-measureitemstruct) is valid.</span></span> <span data-ttu-id="10f87-116">La variable globale est nécessaire car le système envoie le message [WM \_ MEASUREITEM](../controls/wm-measureitem.md) dès que la chaîne est ajoutée, mais avant que les données d’élément soient attachées, et à ce stade, le membre **ItemData** n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="10f87-116">The global variable is needed because the system sends the [WM\_MEASUREITEM](../controls/wm-measureitem.md) message as soon as the string is added but before the item data is attached, and at this point the **itemData** member is not valid.</span></span>
-   <span data-ttu-id="10f87-117">Pour modifier la chaîne d’un élément dans une zone de liste avec le style **\_ HASSTRINGS lbs** , supprimez l’élément avec le message [lb \_ DELETESTRING](../controls/lb-deletestring.md) et ajoutez la nouvelle chaîne avec le \_ message lb ADDSTRING.</span><span class="sxs-lookup"><span data-stu-id="10f87-117">To change the string for an item in a list box with the **LBS\_HASSTRINGS** style, delete the item with the [LB\_DELETESTRING](../controls/lb-deletestring.md) message and add the new string with the LB\_ADDSTRING message.</span></span>

 

 