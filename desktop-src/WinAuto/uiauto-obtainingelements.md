---
title: Obtention d'éléments UI Automation
description: Cette rubrique décrit les différentes façons d’obtenir des interfaces IUIAutomationElement pour les éléments d’interface utilisateur.
ms.assetid: 8675851a-4a72-4cbe-ab71-ed6fc891be17
keywords:
- clients, obtention d’éléments UI Automation
- clients, éléments UI Automation
- clients, éléments racines
- clients, étendue de la recherche
- UI Automation, obtenir des éléments
- UI Automation, éléments
- UI Automation, éléments racine
- UI Automation, conditions
- UI Automation, zone de recherche
- obtention d’éléments UI Automation
- éléments racines
- étendue de recherche
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: a1adbcea5cea81f97350ef15c491b289e07d3ee6
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/20/2021
ms.locfileid: "106539487"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="6f89e-115">Obtention d'éléments UI Automation</span><span class="sxs-lookup"><span data-stu-id="6f89e-115">Obtaining UI Automation Elements</span></span>

<span data-ttu-id="6f89e-116">Cette rubrique décrit les différentes façons d’obtenir des interfaces [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) pour les éléments d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6f89e-116">This topic describes various ways to obtain [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interfaces for UI elements.</span></span>

<span data-ttu-id="6f89e-117">**IUIAutomationElement** est utilisé dans l' [exemple d’application cliente de contenu de document UI Automation](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span><span class="sxs-lookup"><span data-stu-id="6f89e-117">**IUIAutomationElement** is used in the [UI Automation document content client sample app](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span></span>

## <a name="root-element"></a><span data-ttu-id="6f89e-118">Élément racine</span><span class="sxs-lookup"><span data-stu-id="6f89e-118">Root Element</span></span>

<span data-ttu-id="6f89e-119">Bien que les éléments puissent être récupérés directement à l’aide de méthodes, telles que [**IUIAutomation :: GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), certaines applications clientes requièrent une vue de la structure hiérarchique des éléments, appelée arborescence UI Automation.</span><span class="sxs-lookup"><span data-stu-id="6f89e-119">Although elements can be retrieved directly by using methods, such as [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), some client applications require a view of the hierarchical structure of elements, known as the UI Automation tree.</span></span> <span data-ttu-id="6f89e-120">L’élément racine de cette hiérarchie est le bureau.</span><span class="sxs-lookup"><span data-stu-id="6f89e-120">The root element of this hierarchy is the desktop.</span></span> <span data-ttu-id="6f89e-121">Vous pouvez obtenir cet élément à l’aide de la méthode [**IUIAutomation :: GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) ou de la méthode [**IUIAutomation :: GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-121">You can obtain this element by using the [**IUIAutomation::GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) method or the [**IUIAutomation::GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) method.</span></span> <span data-ttu-id="6f89e-122">Ces deux méthodes récupèrent un pointeur d’interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-122">Both these methods retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer.</span></span> <span data-ttu-id="6f89e-123">Vous pouvez rechercher des éléments descendants à l’aide de méthodes, telles que [**IUIAutomationElement :: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) et [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span><span class="sxs-lookup"><span data-stu-id="6f89e-123">You can search for descendant elements by using methods, such as [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) and [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span></span>

> [!Note]  
> <span data-ttu-id="6f89e-124">En général, vous devez essayer d’obtenir uniquement les enfants directs de l’élément racine.</span><span class="sxs-lookup"><span data-stu-id="6f89e-124">In general, you should try to obtain only direct children of the root element.</span></span> <span data-ttu-id="6f89e-125">Une recherche de descendants peut itérer au sein de centaines ou de milliers d’éléments.</span><span class="sxs-lookup"><span data-stu-id="6f89e-125">A search for descendants may iterate through hundreds or thousands of elements.</span></span> <span data-ttu-id="6f89e-126">Si vous tentez d’obtenir un élément spécifique de niveau inférieur, vous devez commencer votre recherche à partir de la fenêtre d’application ou d’un conteneur de niveau inférieur.</span><span class="sxs-lookup"><span data-stu-id="6f89e-126">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>

 

## <a name="conditions"></a><span data-ttu-id="6f89e-127">Conditions</span><span class="sxs-lookup"><span data-stu-id="6f89e-127">Conditions</span></span>

<span data-ttu-id="6f89e-128">Pour la plupart des techniques que vous utilisez pour récupérer des éléments UI Automation, vous devez spécifier une condition.</span><span class="sxs-lookup"><span data-stu-id="6f89e-128">For most techniques you use to retrieve UI Automation elements, you must specify a condition.</span></span> <span data-ttu-id="6f89e-129">Une condition est un ensemble de critères définissant les éléments que vous souhaitez récupérer.</span><span class="sxs-lookup"><span data-stu-id="6f89e-129">A condition is a set of criteria that defines the elements that you want to retrieve.</span></span> <span data-ttu-id="6f89e-130">Une condition est représentée par l’interface [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-130">A condition is represented by the [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) interface.</span></span>

<span data-ttu-id="6f89e-131">La condition la plus simple est la vraie condition, qui est un objet prédéfini qui spécifie que tous les éléments de la zone de recherche doivent être retournés.</span><span class="sxs-lookup"><span data-stu-id="6f89e-131">The simplest condition is the true condition, which is a predefined object that specifies that all elements in the search scope are to be returned.</span></span> <span data-ttu-id="6f89e-132">La fausse condition est l’inverse de la condition vraie et est moins utile, car elle empêche la recherche d’éléments.</span><span class="sxs-lookup"><span data-stu-id="6f89e-132">The false condition is the inverse of the true condition and is less useful, because it would prevent any elements from being found.</span></span> <span data-ttu-id="6f89e-133">Vous pouvez obtenir une interface pour la vraie condition à l’aide de [**IUIAutomation :: CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span><span class="sxs-lookup"><span data-stu-id="6f89e-133">You can obtain an interface to the true condition by using [**IUIAutomation::CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span></span>

<span data-ttu-id="6f89e-134">Trois autres conditions prédéfinies, disponibles en tant que propriétés sur l’objet [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) , peuvent être utilisées seules ou associées à d’autres conditions : [**IUIAutomation :: ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition)et [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span><span class="sxs-lookup"><span data-stu-id="6f89e-134">Three other predefined conditions, available as properties on the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) object, can be used alone or in combination with other conditions: [**IUIAutomation::ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition), and [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span></span> <span data-ttu-id="6f89e-135">**RawViewCondition**, utilisé par lui-même, est équivalent à la condition true, car il ne filtre pas les éléments par les propriétés [**IUIAutomationElement :: CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) ou [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-135">**RawViewCondition**, used by itself, is equivalent to the true condition, because it does not filter elements by the [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) or [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="6f89e-136">D’autres conditions sont générées à partir d’objets condition, chacun d’entre eux spécifiant une valeur de propriété.</span><span class="sxs-lookup"><span data-stu-id="6f89e-136">Other conditions are built from condition objects, each of which specifies a property value.</span></span> <span data-ttu-id="6f89e-137">Par exemple, une condition de propriété peut spécifier que l’élément est activé ou qu’il prend en charge un certain modèle de contrôle.</span><span class="sxs-lookup"><span data-stu-id="6f89e-137">For example, a property condition might specify that the element is enabled or that it supports a certain control pattern.</span></span>

<span data-ttu-id="6f89e-138">Les conditions qui utilisent une logique booléenne peuvent être combinées en appelant [**IUIAutomation :: CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition)et les méthodes associées.</span><span class="sxs-lookup"><span data-stu-id="6f89e-138">Conditions that use Boolean logic can be combined by calling [**IUIAutomation::CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition), and related methods.</span></span>

## <a name="search-scope"></a><span data-ttu-id="6f89e-139">Étendue de recherche</span><span class="sxs-lookup"><span data-stu-id="6f89e-139">Search Scope</span></span>

<span data-ttu-id="6f89e-140">Les recherches effectuées à l’aide de [**IUIAutomationElement :: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) ou [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) doivent avoir une étendue et un emplacement de départ.</span><span class="sxs-lookup"><span data-stu-id="6f89e-140">Searches that are performed by using [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) or [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) must have a scope and a starting place.</span></span>

> [!Note]  
> <span data-ttu-id="6f89e-141">Les commentaires sur ces deux méthodes s’appliquent également à [**IUIAutomationElement :: FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) et [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span><span class="sxs-lookup"><span data-stu-id="6f89e-141">Any commentary about these two methods also applies to [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) and [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span></span>

 

<span data-ttu-id="6f89e-142">L’étendue définit l’espace autour de l’emplacement de départ dans lequel effectuer la recherche.</span><span class="sxs-lookup"><span data-stu-id="6f89e-142">The scope defines the space around the starting place that is to be searched.</span></span> <span data-ttu-id="6f89e-143">Cela peut inclure l’élément lui-même, ses frères, son parent, ses enfants immédiats et ses descendants.</span><span class="sxs-lookup"><span data-stu-id="6f89e-143">This might include the element itself, its siblings, its parent, its immediate children, and its descendants.</span></span> <span data-ttu-id="6f89e-144">N’oubliez pas que les méthodes **Find** ne prennent pas en charge la recherche dans l’arborescence Microsoft UI Automation. autrement dit, la recherche d’éléments ancêtres n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="6f89e-144">Be aware that the **Find** methods do not support searching up the Microsoft UI Automation tree; that is, searching for ancestor elements is not supported.</span></span>

<span data-ttu-id="6f89e-145">La portée d’une recherche est définie par une combinaison d’opérations de bits de valeurs à partir du type énuméré [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-145">The scope of a search is defined by a bitwise combination of values from the [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) enumerated type.</span></span>

## <a name="finding-a-known-element"></a><span data-ttu-id="6f89e-146">Recherche d’un élément connu</span><span class="sxs-lookup"><span data-stu-id="6f89e-146">Finding a Known Element</span></span>

<span data-ttu-id="6f89e-147">Pour rechercher un élément connu identifié par un nom, un ID Automation ou une autre propriété ou combinaison de propriétés, il est plus facile d’utiliser la méthode [**IUIAutomationElement :: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-147">To find a known element that is identified by name, automation ID, or some other property or combination of properties, it is easiest to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) method.</span></span> <span data-ttu-id="6f89e-148">Si l’élément recherché est une fenêtre d’application, le point de départ de la recherche peut être l’élément racine.</span><span class="sxs-lookup"><span data-stu-id="6f89e-148">If the element sought is an application window, the starting point of the search can be the root element.</span></span>

<span data-ttu-id="6f89e-149">Cette façon de rechercher des éléments UI Automation est particulièrement utile dans les scénarios de tests automatisés.</span><span class="sxs-lookup"><span data-stu-id="6f89e-149">This way of finding UI Automation elements is most useful in automated testing scenarios.</span></span>

<span data-ttu-id="6f89e-150">Pour obtenir un exemple de code qui montre comment rechercher un élément connu, consultez [recherche d’un élément par nom](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="6f89e-150">For a code example that shows how to find a know element, see [Finding an Element by Name](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="6f89e-151">Recherche d’éléments dans une sous-arborescence</span><span class="sxs-lookup"><span data-stu-id="6f89e-151">Finding Elements in a Subtree</span></span>

<span data-ttu-id="6f89e-152">Pour rechercher tous les éléments qui répondent à des critères spécifiques et qui sont liés à un élément connu, vous pouvez appeler [**IUIAutomationElement :: FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) sur l’élément connu.</span><span class="sxs-lookup"><span data-stu-id="6f89e-152">To find all elements that meet specific criteria and are related to a known element, you can call [**IUIAutomationElement::FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) on the known element.</span></span> <span data-ttu-id="6f89e-153">Par exemple, utilisez cette méthode pour récupérer des éléments de liste ou des éléments de menu à partir d’une liste ou d’un menu, ou pour identifier tous les contrôles dans une boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="6f89e-153">For example, use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>

<span data-ttu-id="6f89e-154">Pour obtenir un exemple de code qui montre comment rechercher des éléments dans une sous-arborescence, consultez [recherche d’éléments associés](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="6f89e-154">For a code example that shows how to find elements in a subtree, see [Finding Related Elements](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="walking-a-subtree"></a><span data-ttu-id="6f89e-155">Parcourir une sous-arborescence</span><span class="sxs-lookup"><span data-stu-id="6f89e-155">Walking a Subtree</span></span>

<span data-ttu-id="6f89e-156">Si vous n’avez aucune connaissance préalable des applications avec lesquelles votre client peut être utilisé, vous pouvez construire une sous-arborescence de tous les éléments d’intérêt à l’aide de [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span><span class="sxs-lookup"><span data-stu-id="6f89e-156">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span></span> <span data-ttu-id="6f89e-157">Votre client peut effectuer cette opération, par exemple, en réponse à un événement de modification de focus. autrement dit, lorsqu’une application ou un contrôle reçoit le focus d’entrée, le client UI Automation examine les enfants, voire tous les descendants de l’élément ayant le focus.</span><span class="sxs-lookup"><span data-stu-id="6f89e-157">Your client might do this, for example, in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>

<span data-ttu-id="6f89e-158">Sachez que le parcours de l’arborescence UI Automation est gourmand en ressources.</span><span class="sxs-lookup"><span data-stu-id="6f89e-158">Be aware that walking the UI Automation tree is resource-intensive.</span></span> <span data-ttu-id="6f89e-159">Parcourez l’arborescence uniquement lorsqu’il n’est pas possible d’utiliser les méthodes [**IUIAutomationElement :: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall)ou [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-159">Walk the tree only when it is not feasible to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall), or [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) methods.</span></span>

<span data-ttu-id="6f89e-160">Vous pouvez définir votre propre Explorateur d’arborescence en passant une condition personnalisée à [**IUIAutomation :: CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), ou vous pouvez utiliser l’un des objets prédéfinis suivants qui sont définis en tant que propriétés du [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation)de base.</span><span class="sxs-lookup"><span data-stu-id="6f89e-160">You can define your own tree walker by passing a custom condition to [**IUIAutomation::CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), or you can use one of the following predefined objects that are defined as properties of the base [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation).</span></span>



| <span data-ttu-id="6f89e-161">Object</span><span class="sxs-lookup"><span data-stu-id="6f89e-161">Object</span></span>                                                              | <span data-ttu-id="6f89e-162">Objectif</span><span class="sxs-lookup"><span data-stu-id="6f89e-162">Purpose</span></span>                                                                                                                                                      |
|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6f89e-163">**ContentViewWalker**</span><span class="sxs-lookup"><span data-stu-id="6f89e-163">**ContentViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) | <span data-ttu-id="6f89e-164">Recherche uniquement les éléments dont la propriété [**IUIAutomationElement :: CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) a la **valeur true**.</span><span class="sxs-lookup"><span data-stu-id="6f89e-164">Finds only elements whose [**IUIAutomationElement::CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="6f89e-165">**ControlViewWalker**</span><span class="sxs-lookup"><span data-stu-id="6f89e-165">**ControlViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) | <span data-ttu-id="6f89e-166">Recherche uniquement les éléments dont la propriété [**IUIAutomationElement :: CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) a la **valeur true**.</span><span class="sxs-lookup"><span data-stu-id="6f89e-166">Finds only elements whose [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="6f89e-167">**RawViewWalker**</span><span class="sxs-lookup"><span data-stu-id="6f89e-167">**RawViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker)         | <span data-ttu-id="6f89e-168">Recherche tous les éléments.</span><span class="sxs-lookup"><span data-stu-id="6f89e-168">Finds all elements.</span></span>                                                                                                                                          |



 

<span data-ttu-id="6f89e-169">Après avoir obtenu un [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), appelez les méthodes **IUIAutomationTreeWalker :: GetXxx** pour naviguer parmi les éléments de la sous-arborescence, en passant l’élément à partir duquel commencer à parcourir.</span><span class="sxs-lookup"><span data-stu-id="6f89e-169">After you obtain an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), call the **IUIAutomationTreeWalker::GetXxx** methods to navigate elements of the subtree, passing in the element from which to start walking.</span></span>

<span data-ttu-id="6f89e-170">La méthode [**IUIAutomationTreeWalker :: Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) peut être utilisée pour naviguer vers un élément dans la sous-arborescence à partir d’un autre élément qui ne fait pas partie de la vue.</span><span class="sxs-lookup"><span data-stu-id="6f89e-170">The [**IUIAutomationTreeWalker::Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="6f89e-171">Par exemple, supposons que vous créez une vue d’une sous-arborescence à l’aide de [**IUIAutomation :: ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span><span class="sxs-lookup"><span data-stu-id="6f89e-171">For example, suppose you create a view of a subtree by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span></span> <span data-ttu-id="6f89e-172">Votre application reçoit une notification indiquant qu’une barre de défilement a reçu le focus d’entrée.</span><span class="sxs-lookup"><span data-stu-id="6f89e-172">Your application receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="6f89e-173">Comme une barre de défilement n’est pas un élément de contenu, elle n’est pas présente dans l’affichage de la sous-arborescence.</span><span class="sxs-lookup"><span data-stu-id="6f89e-173">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="6f89e-174">Toutefois, vous pouvez passer le [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) qui représente la barre de défilement à **IUIAutomationTreeWalker :: Normalize** et récupérer l’ancêtre le plus proche qui se trouve dans l’affichage de contenu.</span><span class="sxs-lookup"><span data-stu-id="6f89e-174">However, you can pass the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the scroll bar to **IUIAutomationTreeWalker::Normalize** and retrieve the nearest ancestor that is in the content view.</span></span>

<span data-ttu-id="6f89e-175">Pour obtenir des exemples de code qui montrent comment utiliser l’interface [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) , consultez [Guide pratique pour parcourir l’arborescence UI Automation](uiauto-howto-walk-uiautomation-tree.md).</span><span class="sxs-lookup"><span data-stu-id="6f89e-175">For code examples that show how to use the [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface, see [How to Walk the UI Automation Tree](uiauto-howto-walk-uiautomation-tree.md).</span></span>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="6f89e-176">Autres moyens de récupérer un élément</span><span class="sxs-lookup"><span data-stu-id="6f89e-176">Other Ways to Retrieve an Element</span></span>

<span data-ttu-id="6f89e-177">Outre les recherches et la navigation, vous pouvez récupérer un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) de l’une des manières suivantes.</span><span class="sxs-lookup"><span data-stu-id="6f89e-177">In addition to searches and navigation, you can retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) in the following ways.</span></span>

### <a name="from-an-event"></a><span data-ttu-id="6f89e-178">À partir d’un événement</span><span class="sxs-lookup"><span data-stu-id="6f89e-178">From an Event</span></span>

<span data-ttu-id="6f89e-179">Lorsque votre application reçoit un événement UI Automation, l’objet source passé à votre gestionnaire d’événements est représenté par un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span><span class="sxs-lookup"><span data-stu-id="6f89e-179">When your application receives a UI Automation event, the source object passed to your event handler is represented by an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span></span> <span data-ttu-id="6f89e-180">Par exemple, si vous vous abonnez à des événements de modification du focus, la source passée à votre [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) est l’élément qui a reçu le focus.</span><span class="sxs-lookup"><span data-stu-id="6f89e-180">For example, if you subscribe to focus-changed events, the source passed to your [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) is the element that received the focus.</span></span> <span data-ttu-id="6f89e-181">Pour plus d’informations, consultez [abonnement à des événements UI Automation](uiauto-eventsforclients.md).</span><span class="sxs-lookup"><span data-stu-id="6f89e-181">For more information, see [Subscribing to UI Automation Events](uiauto-eventsforclients.md).</span></span>

### <a name="from-a-point"></a><span data-ttu-id="6f89e-182">À partir d’un point</span><span class="sxs-lookup"><span data-stu-id="6f89e-182">From a Point</span></span>

<span data-ttu-id="6f89e-183">Pour récupérer un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) à partir de coordonnées d’écran, par exemple, une position de curseur, utilisez la méthode [**IUIAutomation :: ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-183">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from screen coordinates, for example, a cursor position, use the [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) method.</span></span>

### <a name="from-a-window-handle"></a><span data-ttu-id="6f89e-184">À partir d’un handle de fenêtre</span><span class="sxs-lookup"><span data-stu-id="6f89e-184">From a Window Handle</span></span>

<span data-ttu-id="6f89e-185">Pour récupérer un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) à partir d’un **HWND**, utilisez la méthode [**IUIAutomation :: ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-185">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from an **HWND**, use the [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) method.</span></span>

### <a name="from-the-focused-control"></a><span data-ttu-id="6f89e-186">À partir du contrôle ayant le focus</span><span class="sxs-lookup"><span data-stu-id="6f89e-186">From the Focused Control</span></span>

<span data-ttu-id="6f89e-187">Pour récupérer un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) qui représente le contrôle ayant le focus, utilisez la méthode [**IUIAutomation :: GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) .</span><span class="sxs-lookup"><span data-stu-id="6f89e-187">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the focused control, use the [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6f89e-188">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="6f89e-188">Related topics</span></span>

[<span data-ttu-id="6f89e-189">Vue d’ensemble de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="6f89e-189">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)

[<span data-ttu-id="6f89e-190">Exemple d’application de client de contenu de document UI Automation</span><span class="sxs-lookup"><span data-stu-id="6f89e-190">UI Automation document content client sample app</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)
