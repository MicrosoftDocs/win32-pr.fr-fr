---
description: La prévention de l’exécution des données (DEP) est une fonctionnalité de protection de la mémoire au niveau du système qui est intégrée au système d’exploitation à partir de Windows XP et de Windows Server 2003.
ms.assetid: 75cd83a5-4b77-4ca9-b595-e32d0dd609d0
title: Prévention de l’exécution des données
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bc53febb383ef2789c2798b091960c2d20856d0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106534503"
---
# <a name="data-execution-prevention"></a><span data-ttu-id="e28ec-103">Prévention de l’exécution des données</span><span class="sxs-lookup"><span data-stu-id="e28ec-103">Data Execution Prevention</span></span>

<span data-ttu-id="e28ec-104">La prévention de l’exécution des données (DEP) est une fonctionnalité de protection de la mémoire au niveau du système qui est intégrée au système d’exploitation à partir de Windows XP et de Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="e28ec-104">Data Execution Prevention (DEP) is a system-level memory protection feature that is built into the operating system starting with Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="e28ec-105">DEP permet au système de marquer une ou plusieurs pages de mémoire comme non exécutables.</span><span class="sxs-lookup"><span data-stu-id="e28ec-105">DEP enables the system to mark one or more pages of memory as non-executable.</span></span> <span data-ttu-id="e28ec-106">Le marquage de régions de mémoire comme non exécutables signifie que le code ne peut pas être exécuté à partir de cette région de mémoire, ce qui complique l’exploitation des dépassements de mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="e28ec-106">Marking memory regions as non-executable means that code cannot be run from that region of memory, which makes it harder for the exploitation of buffer overruns.</span></span>

<span data-ttu-id="e28ec-107">DEP empêche l’exécution de code à partir de pages de données telles que le tas par défaut, les piles et les pools de mémoire.</span><span class="sxs-lookup"><span data-stu-id="e28ec-107">DEP prevents code from being run from data pages such as the default heap, stacks, and memory pools.</span></span> <span data-ttu-id="e28ec-108">Si une application tente d’exécuter du code à partir d’une page de données protégée, une exception de violation d’accès à la mémoire se produit et, si l’exception n’est pas gérée, le processus appelant se termine.</span><span class="sxs-lookup"><span data-stu-id="e28ec-108">If an application attempts to run code from a data page that is protected, a memory access violation exception occurs, and if the exception is not handled, the calling process is terminated.</span></span>

<span data-ttu-id="e28ec-109">DEP n’est pas conçu pour être une protection complète contre toutes les attaques. Il s’agit d’un autre outil que vous pouvez utiliser pour sécuriser votre application.</span><span class="sxs-lookup"><span data-stu-id="e28ec-109">DEP is not intended to be a comprehensive defense against all exploits; it is intended to be another tool that you can use to secure your application.</span></span>

## <a name="how-data-execution-prevention-works"></a><span data-ttu-id="e28ec-110">Fonctionnement de la prévention de l’exécution des données</span><span class="sxs-lookup"><span data-stu-id="e28ec-110">How Data Execution Prevention Works</span></span>

<span data-ttu-id="e28ec-111">Si une application tente d’exécuter du code à partir d’une page protégée, l’application reçoit une exception avec **la \_ \_ violation d’accès État** du code d’État.</span><span class="sxs-lookup"><span data-stu-id="e28ec-111">If an application attempts to run code from a protected page, the application receives an exception with the status code **STATUS\_ACCESS\_VIOLATION**.</span></span> <span data-ttu-id="e28ec-112">Si votre application doit exécuter du code à partir d’une page de mémoire, elle doit allouer et définir les attributs de protection de la [mémoire](memory-protection.md) virtuelle appropriés.</span><span class="sxs-lookup"><span data-stu-id="e28ec-112">If your application must run code from a memory page, it must allocate and set the proper virtual [memory protection](memory-protection.md) attributes.</span></span> <span data-ttu-id="e28ec-113">La mémoire allouée doit être marquée **page \_ Execute**, **page \_ Execute \_ Read**, **page \_ Execute \_ ReadWrite** ou **page \_ Execute \_ WRITECOPY** lors de l’allocation de mémoire.</span><span class="sxs-lookup"><span data-stu-id="e28ec-113">The allocated memory must be marked **PAGE\_EXECUTE**, **PAGE\_EXECUTE\_READ**, **PAGE\_EXECUTE\_READWRITE**, or **PAGE\_EXECUTE\_WRITECOPY** when allocating memory.</span></span> <span data-ttu-id="e28ec-114">Les allocations de tas effectuées en appelant les fonctions **malloc** et [**HeapAlloc**](/windows/desktop/api/HeapApi/nf-heapapi-heapalloc) ne sont pas exécutables.</span><span class="sxs-lookup"><span data-stu-id="e28ec-114">Heap allocations made by calling the **malloc** and [**HeapAlloc**](/windows/desktop/api/HeapApi/nf-heapapi-heapalloc) functions are non-executable.</span></span>

<span data-ttu-id="e28ec-115">Les applications ne peuvent pas exécuter le code à partir du tas de processus par défaut ou de la pile.</span><span class="sxs-lookup"><span data-stu-id="e28ec-115">Applications cannot run code from the default process heap or the stack.</span></span>

<span data-ttu-id="e28ec-116">DEP est configuré au démarrage du système en fonction du paramètre de stratégie de protection des pages non exécutées dans les données de configuration de démarrage.</span><span class="sxs-lookup"><span data-stu-id="e28ec-116">DEP is configured at system boot according to the no-execute page protection policy setting in the boot configuration data.</span></span> <span data-ttu-id="e28ec-117">Une application peut récupérer le paramètre de stratégie actuel en appelant la fonction [**GetSystemDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-getsystemdeppolicy) .</span><span class="sxs-lookup"><span data-stu-id="e28ec-117">An application can get the current policy setting by calling the [**GetSystemDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-getsystemdeppolicy) function.</span></span> <span data-ttu-id="e28ec-118">Selon le paramètre de stratégie, une application peut modifier le paramètre DEP du processus en cours en appelant la fonction [**SetProcessDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-setprocessdeppolicy) .</span><span class="sxs-lookup"><span data-stu-id="e28ec-118">Depending on the policy setting, an application can change the DEP setting for the current process by calling the [**SetProcessDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-setprocessdeppolicy) function.</span></span>

## <a name="programming-considerations"></a><span data-ttu-id="e28ec-119">Éléments de programmation à prendre en considération</span><span class="sxs-lookup"><span data-stu-id="e28ec-119">Programming Considerations</span></span>

<span data-ttu-id="e28ec-120">Une application peut utiliser la fonction [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) pour allouer de la mémoire exécutable avec les options de protection de la mémoire appropriées.</span><span class="sxs-lookup"><span data-stu-id="e28ec-120">An application can use the [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) function to allocate executable memory with the appropriate memory protection options.</span></span> <span data-ttu-id="e28ec-121">Il est suggéré qu’une application ait défini au minimum l’option de protection **page \_ Execute** Memory.</span><span class="sxs-lookup"><span data-stu-id="e28ec-121">It is suggested that an application set, at a minimum, the **PAGE\_EXECUTE** memory protection option.</span></span> <span data-ttu-id="e28ec-122">Une fois le code exécutable généré, il est recommandé que l’application définisse des protections de mémoire pour interdire l’accès en écriture à la mémoire allouée.</span><span class="sxs-lookup"><span data-stu-id="e28ec-122">After the executable code is generated, it is recommended that the application set memory protections to disallow write access to the allocated memory.</span></span> <span data-ttu-id="e28ec-123">Les applications peuvent interdire l’accès en écriture à la mémoire allouée à l’aide de la fonction [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) .</span><span class="sxs-lookup"><span data-stu-id="e28ec-123">Applications can disallow write access to allocated memory by using the [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) function.</span></span> <span data-ttu-id="e28ec-124">Interdire l’accès en écriture garantit une protection maximale pour les régions exécutables de l’espace d’adressage de processus.</span><span class="sxs-lookup"><span data-stu-id="e28ec-124">Disallowing write access ensures maximum protection for executable regions of process address space.</span></span> <span data-ttu-id="e28ec-125">Vous devez essayer de créer des applications qui utilisent le plus petit espace d’adressage exécutable possible, ce qui réduit la quantité de mémoire exposée à l’exploitation de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="e28ec-125">You should attempt to create applications that use the smallest executable address space possible, which minimizes the amount of memory that is exposed to memory exploitation.</span></span>

<span data-ttu-id="e28ec-126">Vous devez également essayer de contrôler la disposition de la mémoire virtuelle de votre application et de créer des régions exécutables.</span><span class="sxs-lookup"><span data-stu-id="e28ec-126">You should also attempt to control the layout of your application's virtual memory and create executable regions.</span></span> <span data-ttu-id="e28ec-127">Ces régions exécutables doivent se trouver dans un espace mémoire inférieur à celui des régions non exécutables.</span><span class="sxs-lookup"><span data-stu-id="e28ec-127">These executable regions should be located in a lower memory space than non-executable regions.</span></span> <span data-ttu-id="e28ec-128">En localisant les régions exécutables sous des régions non exécutables, vous pouvez empêcher un dépassement de capacité de la mémoire tampon de déborder dans la zone exécutable de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="e28ec-128">By locating executable regions below non-executable regions, you can help prevent a buffer overflow from overflowing into the executable area of memory.</span></span>

## <a name="application-compatibility"></a><span data-ttu-id="e28ec-129">Compatibilité des applications</span><span class="sxs-lookup"><span data-stu-id="e28ec-129">Application Compatibility</span></span>

<span data-ttu-id="e28ec-130">Certaines fonctionnalités de l’application sont incompatibles avec DEP.</span><span class="sxs-lookup"><span data-stu-id="e28ec-130">Some application functionality is incompatible with DEP.</span></span> <span data-ttu-id="e28ec-131">Les applications qui effectuent la génération de code dynamique (par exemple, la génération de code juste-à-temps) et ne marquent pas explicitement le code généré avec l’autorisation EXECUTE peuvent avoir des problèmes de compatibilité sur les ordinateurs qui utilisent DEP.</span><span class="sxs-lookup"><span data-stu-id="e28ec-131">Applications that perform dynamic code generation (such as Just-In-Time code generation) and do not explicitly mark generated code with execute permission may have compatibility issues on computers that are using DEP.</span></span> <span data-ttu-id="e28ec-132">Les applications écrites dans le Active Template Library (ATL) version 7,1 et les versions antérieures peuvent tenter d’exécuter du code sur des pages marquées comme non exécutables, ce qui déclenche une erreur NX et met fin à l’application. Pour plus d’informations, consultez [**SetProcessDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-setprocessdeppolicy).</span><span class="sxs-lookup"><span data-stu-id="e28ec-132">Applications written to the Active Template Library (ATL) version 7.1 and earlier can attempt to execute code on pages marked as non-executable, which triggers an NX fault and terminates the application; for more information, see [**SetProcessDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-setprocessdeppolicy).</span></span> <span data-ttu-id="e28ec-133">La plupart des applications qui effectuent des actions incompatibles avec DEP doivent être mises à jour pour fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="e28ec-133">Most applications that perform actions incompatible with DEP must be updated to function properly.</span></span>

<span data-ttu-id="e28ec-134">Un petit nombre de fichiers exécutables et de bibliothèques peuvent contenir du code exécutable dans la section des données d’un fichier image.</span><span class="sxs-lookup"><span data-stu-id="e28ec-134">A small number of executable files and libraries may contain executable code in the data section of an image file.</span></span> <span data-ttu-id="e28ec-135">Dans certains cas, les applications peuvent placer de petits segments de code (communément appelés thunks) dans les sections de données.</span><span class="sxs-lookup"><span data-stu-id="e28ec-135">In some cases, applications may place small segments of code (commonly referred to as thunks) in the data sections.</span></span> <span data-ttu-id="e28ec-136">Toutefois, DEP marque les sections du fichier image chargées en mémoire comme étant non exécutables, sauf si l’attribut Executable est appliqué à la section.</span><span class="sxs-lookup"><span data-stu-id="e28ec-136">However, DEP marks sections of the image file that is loaded in memory as non-executable unless the section has the executable attribute applied.</span></span>

<span data-ttu-id="e28ec-137">Par conséquent, le code exécutable dans les sections de données doit être migré vers une section de code, ou la section de données qui contient le code exécutable doit être explicitement marquée comme exécutable.</span><span class="sxs-lookup"><span data-stu-id="e28ec-137">Therefore, executable code in data sections should be migrated to a code section, or the data section that contains the executable code should be explicitly marked as executable.</span></span> <span data-ttu-id="e28ec-138">L’attribut exécutable, l' **image \_ SCN \_ MEM \_ Execute**, doit être ajouté au champ **caractéristiques** de l’en-tête de la section correspondante pour les sections qui contiennent du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="e28ec-138">The executable attribute, **IMAGE\_SCN\_MEM\_EXECUTE**, should be added to the **Characteristics** field of the corresponding section header for sections that contain executable code.</span></span> <span data-ttu-id="e28ec-139">Pour plus d’informations sur l’ajout d’attributs à une section, consultez la documentation fournie avec votre éditeur de liens.</span><span class="sxs-lookup"><span data-stu-id="e28ec-139">For more information about adding attributes to a section, see the documentation included with your linker.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e28ec-140">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e28ec-140">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="e28ec-141">[Prévention de l’exécution des données (TechNet)](/previous-versions/windows/it-pro/windows-xp/bb457155(v=technet.10))</span><span class="sxs-lookup"><span data-stu-id="e28ec-141">[Data Execution Prevention (TechNet)](/previous-versions/windows/it-pro/windows-xp/bb457155(v=technet.10))</span></span>
</dt> <dt>

[<span data-ttu-id="e28ec-142">Comment configurer la protection de la mémoire</span><span class="sxs-lookup"><span data-stu-id="e28ec-142">How to Configure Memory Protection</span></span>](https://www.microsoft.com/technet/security/prodtech/windowsxp/depcnfxp.mspx)
</dt> <dt>

[<span data-ttu-id="e28ec-143">Article 875352 de la base de connaissances</span><span class="sxs-lookup"><span data-stu-id="e28ec-143">KB Article 875352</span></span>](https://support.microsoft.com/kb/875352)
</dt> </dl>

 

 
