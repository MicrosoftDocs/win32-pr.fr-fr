---
description: Le mappage de fichier est l’Association du contenu d’un fichier avec une partie de l’espace d’adressage virtuel d’un processus.
ms.assetid: 86a8bc81-914d-46a2-99fd-65dfd03bbcdd
title: Mappage de fichiers
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7f49162a4545d0e087e6b291e429d89049dbf57
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526368"
---
# <a name="file-mapping"></a><span data-ttu-id="31946-103">Mappage de fichiers</span><span class="sxs-lookup"><span data-stu-id="31946-103">File Mapping</span></span>

<span data-ttu-id="31946-104">Le *mappage de fichier* est l’Association du contenu d’un fichier avec une partie de l’espace d’adressage virtuel d’un processus.</span><span class="sxs-lookup"><span data-stu-id="31946-104">*File mapping* is the association of a file's contents with a portion of the virtual address space of a process.</span></span> <span data-ttu-id="31946-105">Le système crée un *objet de mappage de fichier* (également appelé *objet de section*) pour maintenir cette association.</span><span class="sxs-lookup"><span data-stu-id="31946-105">The system creates a *file mapping object* (also known as a *section object*) to maintain this association.</span></span> <span data-ttu-id="31946-106">Un *affichage des fichiers* est la partie de l’espace d’adressage virtuel utilisée par un processus pour accéder au contenu du fichier.</span><span class="sxs-lookup"><span data-stu-id="31946-106">A *file view* is the portion of virtual address space that a process uses to access the file's contents.</span></span> <span data-ttu-id="31946-107">Le mappage de fichiers permet au processus d’utiliser à la fois les entrées et sorties aléatoires (e/s) et les e/s séquentielles.</span><span class="sxs-lookup"><span data-stu-id="31946-107">File mapping allows the process to use both random input and output (I/O) and sequential I/O.</span></span> <span data-ttu-id="31946-108">Il permet également au processus de fonctionner efficacement avec un fichier de données volumineux, tel qu’une base de données, sans avoir à mapper l’ensemble du fichier en mémoire.</span><span class="sxs-lookup"><span data-stu-id="31946-108">It also allows the process to work efficiently with a large data file, such as a database, without having to map the whole file into memory.</span></span> <span data-ttu-id="31946-109">Plusieurs processus peuvent également utiliser des fichiers mappés en mémoire pour partager des données.</span><span class="sxs-lookup"><span data-stu-id="31946-109">Multiple processes can also use memory-mapped files to share data.</span></span>

<span data-ttu-id="31946-110">Les processus lisent et écrivent dans la vue de fichier à l’aide de pointeurs, exactement comme ils le font avec la mémoire allouée dynamiquement.</span><span class="sxs-lookup"><span data-stu-id="31946-110">Processes read from and write to the file view using pointers, just as they would with dynamically allocated memory.</span></span> <span data-ttu-id="31946-111">L’utilisation du mappage de fichiers améliore l’efficacité, car le fichier réside sur le disque, mais la vue de fichier réside en mémoire.</span><span class="sxs-lookup"><span data-stu-id="31946-111">The use of file mapping improves efficiency because the file resides on disk, but the file view resides in memory.</span></span> <span data-ttu-id="31946-112">Les processus peuvent également manipuler la vue de fichier avec la fonction [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) .</span><span class="sxs-lookup"><span data-stu-id="31946-112">Processes can also manipulate the file view with the [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) function.</span></span>

<span data-ttu-id="31946-113">L’illustration suivante montre la relation entre le fichier sur le disque, un objet de mappage de fichier et un affichage des fichiers.</span><span class="sxs-lookup"><span data-stu-id="31946-113">The following illustration shows the relationship between the file on disk, a file mapping object, and a file view.</span></span>

![relation entre le fichier sur le disque, un objet de mappage de fichier et un affichage des fichiers.](images/fmap.png)

<span data-ttu-id="31946-115">Le fichier sur le disque peut être n’importe quel fichier que vous souhaitez mapper en mémoire, ou il peut s’agir du fichier d’échange de pages système.</span><span class="sxs-lookup"><span data-stu-id="31946-115">The file on disk can be any file that you want to map into memory, or it can be the system page file.</span></span> <span data-ttu-id="31946-116">L’objet de mappage de fichier peut être constitué de tout ou partie du fichier.</span><span class="sxs-lookup"><span data-stu-id="31946-116">The file mapping object can consist of all or only part of the file.</span></span> <span data-ttu-id="31946-117">Elle est sauvegardée par le fichier sur le disque.</span><span class="sxs-lookup"><span data-stu-id="31946-117">It is backed by the file on disk.</span></span> <span data-ttu-id="31946-118">Cela signifie que lorsque le système permute des pages de l’objet de mappage de fichier, toutes les modifications apportées à l’objet de mappage de fichier sont écrites dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="31946-118">This means that when the system swaps out pages of the file mapping object, any changes made to the file mapping object are written to the file.</span></span> <span data-ttu-id="31946-119">Lorsque les pages de l’objet de mappage de fichier sont à nouveau échangées, elles sont restaurées à partir du fichier.</span><span class="sxs-lookup"><span data-stu-id="31946-119">When the pages of the file mapping object are swapped back in, they are restored from the file.</span></span>

<span data-ttu-id="31946-120">Une vue de fichier peut être constituée de tout ou partie de l’objet de mappage de fichier.</span><span class="sxs-lookup"><span data-stu-id="31946-120">A file view can consist of all or only part of the file mapping object.</span></span> <span data-ttu-id="31946-121">Un processus manipule le fichier par le biais des vues de fichiers.</span><span class="sxs-lookup"><span data-stu-id="31946-121">A process manipulates the file through the file views.</span></span> <span data-ttu-id="31946-122">Un processus peut créer plusieurs vues pour un objet de mappage de fichier.</span><span class="sxs-lookup"><span data-stu-id="31946-122">A process can create multiple views for a file mapping object.</span></span> <span data-ttu-id="31946-123">Les vues de fichiers créées par chaque processus résident dans l’espace d’adressage virtuel de ce processus.</span><span class="sxs-lookup"><span data-stu-id="31946-123">The file views created by each process reside in the virtual address space of that process.</span></span> <span data-ttu-id="31946-124">Quand le processus a besoin de données provenant d’une partie du fichier autre que celle de l’affichage des fichiers en cours, il peut annuler le mappage de l’affichage des fichiers en cours, puis créer une nouvelle vue de fichier.</span><span class="sxs-lookup"><span data-stu-id="31946-124">When the process needs data from a portion of the file other than what is in the current file view, it can unmap the current file view, then create a new file view.</span></span>

<span data-ttu-id="31946-125">Lorsque plusieurs processus utilisent le même objet de mappage de fichier pour créer des vues pour un fichier local, les données sont cohérentes.</span><span class="sxs-lookup"><span data-stu-id="31946-125">When multiple processes use the same file mapping object to create views for a local file, the data is coherent.</span></span> <span data-ttu-id="31946-126">Autrement dit, les vues contiennent des copies identiques du fichier sur le disque.</span><span class="sxs-lookup"><span data-stu-id="31946-126">That is, the views contain identical copies of the file on disk.</span></span> <span data-ttu-id="31946-127">Le fichier ne peut pas résider sur un ordinateur distant si vous souhaitez partager la mémoire entre plusieurs processus.</span><span class="sxs-lookup"><span data-stu-id="31946-127">The file cannot reside on a remote computer if you want to share memory between multiple processes.</span></span>

<span data-ttu-id="31946-128">Pour plus d'informations, voir les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="31946-128">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="31946-129">Création d’un objet de mappage de fichier</span><span class="sxs-lookup"><span data-stu-id="31946-129">Creating a File Mapping Object</span></span>](creating-a-file-mapping-object.md)
-   [<span data-ttu-id="31946-130">Création d’un affichage des fichiers</span><span class="sxs-lookup"><span data-stu-id="31946-130">Creating a File View</span></span>](creating-a-file-view.md)
-   [<span data-ttu-id="31946-131">Partage de fichiers et de mémoire</span><span class="sxs-lookup"><span data-stu-id="31946-131">Sharing Files and Memory</span></span>](sharing-files-and-memory.md)
-   [<span data-ttu-id="31946-132">Lecture et écriture à partir d’un affichage des fichiers</span><span class="sxs-lookup"><span data-stu-id="31946-132">Reading and Writing From a File View</span></span>](reading-and-writing-from-a-file-view.md)
-   [<span data-ttu-id="31946-133">Fermeture d’un objet de mappage de fichier</span><span class="sxs-lookup"><span data-stu-id="31946-133">Closing a File Mapping Object</span></span>](closing-a-file-mapping-object.md)
-   [<span data-ttu-id="31946-134">Sécurité du mappage de fichiers et droits d’accès</span><span class="sxs-lookup"><span data-stu-id="31946-134">File Mapping Security and Access Rights</span></span>](file-mapping-security-and-access-rights.md)
-   [<span data-ttu-id="31946-135">Utilisation du mappage de fichiers</span><span class="sxs-lookup"><span data-stu-id="31946-135">Using File Mapping</span></span>](using-file-mapping.md)

 

 
