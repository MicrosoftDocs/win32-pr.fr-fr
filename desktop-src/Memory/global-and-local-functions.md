---
description: Les fonctions globales et locales sont prises en charge pour le portage à partir de code 16 bits ou pour la gestion de la compatibilité du code source avec Windows 16 bits.
ms.assetid: 97707ce7-4c65-4d0e-ba69-47fdaee73a9b
title: Fonctions globales et locales
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cf356647f92f0e7d82e914a91020c438363ff082
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103862425"
---
# <a name="global-and-local-functions"></a><span data-ttu-id="097bd-103">Fonctions globales et locales</span><span class="sxs-lookup"><span data-stu-id="097bd-103">Global and Local Functions</span></span>

<span data-ttu-id="097bd-104">Les fonctions globales et locales sont prises en charge pour le portage à partir de code 16 bits ou pour la gestion de la compatibilité du code source avec Windows 16 bits.</span><span class="sxs-lookup"><span data-stu-id="097bd-104">The global and local functions are supported for porting from 16-bit code, or for maintaining source code compatibility with 16-bit Windows.</span></span> <span data-ttu-id="097bd-105">À partir de Windows 32 bits, les fonctions locales et globales sont implémentées en tant que fonctions wrapper qui appellent les [fonctions de tas](heap-functions.md) correspondantes à l’aide d’un handle vers le tas par défaut du processus.</span><span class="sxs-lookup"><span data-stu-id="097bd-105">Starting with 32-bit Windows, the global and local functions are implemented as wrapper functions that call the corresponding [heap functions](heap-functions.md) using a handle to the process's default heap.</span></span> <span data-ttu-id="097bd-106">Par conséquent, les fonctions globales et locales ont une surcharge supérieure à celle des autres fonctions de gestion de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="097bd-106">Therefore, the global and local functions have greater overhead than other memory management functions.</span></span>

<span data-ttu-id="097bd-107">Les [fonctions de tas](heap-functions.md) offrent plus de fonctionnalités et de contrôle que les fonctions globales et locales.</span><span class="sxs-lookup"><span data-stu-id="097bd-107">The [heap functions](heap-functions.md) provide more features and control than the global and local functions.</span></span> <span data-ttu-id="097bd-108">Les nouvelles applications doivent utiliser les fonctions de tas, sauf si la documentation stipule spécifiquement qu’une fonction globale ou locale doit être utilisée.</span><span class="sxs-lookup"><span data-stu-id="097bd-108">New applications should use the heap functions unless documentation specifically states that a global or local function should be used.</span></span> <span data-ttu-id="097bd-109">Par exemple, certaines fonctions Windows allouent de la mémoire qui doit être libérée avec [**LocalFree**](/windows/desktop/api/WinBase/nf-winbase-localfree), et les fonctions globales sont toujours utilisées avec échange dynamique de données (DDE), les fonctions du presse-papiers et les objets de données OLE.</span><span class="sxs-lookup"><span data-stu-id="097bd-109">For example, some Windows functions allocate memory that must be freed with [**LocalFree**](/windows/desktop/api/WinBase/nf-winbase-localfree), and the global functions are still used with Dynamic Data Exchange (DDE), the clipboard functions, and OLE data objects.</span></span> <span data-ttu-id="097bd-110">Pour obtenir la liste complète des fonctions locales et globales, consultez le tableau dans [fonctions de gestion](memory-management-functions.md)de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="097bd-110">For a complete list of global and local functions, see the table in [Memory Management Functions](memory-management-functions.md).</span></span>

<span data-ttu-id="097bd-111">La gestion de la mémoire Windows ne fournit pas de segment de mémoire local et de tas global distincts, comme le fait Windows 16 bits.</span><span class="sxs-lookup"><span data-stu-id="097bd-111">Windows memory management does not provide a separate local heap and global heap, as 16-bit Windows does.</span></span> <span data-ttu-id="097bd-112">Par conséquent, les familles de fonctions globales et locales sont équivalentes et le choix entre elles est une question de préférence personnelle.</span><span class="sxs-lookup"><span data-stu-id="097bd-112">As a result, the global and local families of functions are equivalent and choosing between them is a matter of personal preference.</span></span> <span data-ttu-id="097bd-113">Notez que le changement d’un modèle de mémoire segmentée 16 bits à un modèle de mémoire virtuelle 32 bits a rendu les fonctions globales et locales associées et leurs options inutiles ou non significatives.</span><span class="sxs-lookup"><span data-stu-id="097bd-113">Note that the change from a 16-bit segmented memory model to a 32-bit virtual memory model has made some of the related global and local functions and their options unnecessary or meaningless.</span></span> <span data-ttu-id="097bd-114">Par exemple, il n’y a plus de pointeurs near et Far, car les allocations locales et globales retournent des adresses virtuelles de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="097bd-114">For example, there are no longer near and far pointers, because both local and global allocations return 32-bit virtual addresses.</span></span>

<span data-ttu-id="097bd-115">Les objets mémoire alloués par [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc) et [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc) se trouvent dans des pages privées et validées avec un accès en lecture/écriture qui ne sont pas accessibles par d’autres processus.</span><span class="sxs-lookup"><span data-stu-id="097bd-115">Memory objects allocated by [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc) and [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc) are in private, committed pages with read/write access that cannot be accessed by other processes.</span></span> <span data-ttu-id="097bd-116">La mémoire allouée à l’aide de **GlobalAlloc** avec **GMEM \_ DDESHARE** n’est pas réellement partagée globalement, comme c’est le cas dans Windows 16 bits.</span><span class="sxs-lookup"><span data-stu-id="097bd-116">Memory allocated by using **GlobalAlloc** with **GMEM\_DDESHARE** is not actually shared globally as it is in 16-bit Windows.</span></span> <span data-ttu-id="097bd-117">Cette valeur n’a aucun effet et n’est disponible que pour la compatibilité.</span><span class="sxs-lookup"><span data-stu-id="097bd-117">This value has no effect and is available only for compatibility.</span></span> <span data-ttu-id="097bd-118">Les applications nécessitant une mémoire partagée à d’autres fins doivent utiliser des objets de mappage de fichiers.</span><span class="sxs-lookup"><span data-stu-id="097bd-118">Applications requiring shared memory for other purposes must use file-mapping objects.</span></span> <span data-ttu-id="097bd-119">Plusieurs processus peuvent mapper une vue du même objet de mappage de fichiers pour fournir la mémoire partagée nommée.</span><span class="sxs-lookup"><span data-stu-id="097bd-119">Multiple processes can map a view of the same file-mapping object to provide named shared memory.</span></span> <span data-ttu-id="097bd-120">Pour plus d’informations, consultez [mappage de fichiers](file-mapping.md).</span><span class="sxs-lookup"><span data-stu-id="097bd-120">For more information, see [File Mapping](file-mapping.md).</span></span>

<span data-ttu-id="097bd-121">Les allocations de mémoire sont limitées uniquement par la mémoire physique disponible, y compris le stockage dans le fichier d’échange sur le disque.</span><span class="sxs-lookup"><span data-stu-id="097bd-121">Memory allocations are limited only by the available physical memory, including storage in the paging file on disk.</span></span> <span data-ttu-id="097bd-122">Lorsque vous allouez de la mémoire fixe, [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc) et [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc) retournent un pointeur que le processus appelant peut utiliser immédiatement pour accéder à la mémoire.</span><span class="sxs-lookup"><span data-stu-id="097bd-122">When you allocate fixed memory, [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc) and [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc) return a pointer that the calling process can immediately use to access the memory.</span></span> <span data-ttu-id="097bd-123">Lorsque vous allouez de la mémoire mobile, la valeur de retour est un handle.</span><span class="sxs-lookup"><span data-stu-id="097bd-123">When you allocate moveable memory, the return value is a handle.</span></span> <span data-ttu-id="097bd-124">Pour obtenir un pointeur vers un objet mémoire mobile, utilisez les fonctions [**GlobalLock**](/windows/desktop/api/WinBase/nf-winbase-globallock) et [**LocalLock**](/windows/desktop/api/WinBase/nf-winbase-locallock) .</span><span class="sxs-lookup"><span data-stu-id="097bd-124">To get a pointer to a movable memory object, use the [**GlobalLock**](/windows/desktop/api/WinBase/nf-winbase-globallock) and [**LocalLock**](/windows/desktop/api/WinBase/nf-winbase-locallock) functions.</span></span>

<span data-ttu-id="097bd-125">La taille réelle de la mémoire allouée peut être supérieure à la taille demandée.</span><span class="sxs-lookup"><span data-stu-id="097bd-125">The actual size of the memory allocated can be larger than the requested size.</span></span> <span data-ttu-id="097bd-126">Pour déterminer le nombre réel d’octets alloués, utilisez la fonction [**GlobalSize**](/windows/desktop/api/WinBase/nf-winbase-globalsize) ou [**LocalSize**](/windows/desktop/api/WinBase/nf-winbase-localsize) .</span><span class="sxs-lookup"><span data-stu-id="097bd-126">To determine the actual number of bytes allocated, use the [**GlobalSize**](/windows/desktop/api/WinBase/nf-winbase-globalsize) or [**LocalSize**](/windows/desktop/api/WinBase/nf-winbase-localsize) function.</span></span> <span data-ttu-id="097bd-127">Si la quantité allouée est supérieure à la quantité demandée, le processus peut utiliser la totalité du montant.</span><span class="sxs-lookup"><span data-stu-id="097bd-127">If the amount allocated is greater than the amount requested, the process can use the entire amount.</span></span>

<span data-ttu-id="097bd-128">Les fonctions [**GlobalReAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalrealloc) et [**LocalReAlloc**](/windows/desktop/api/WinBase/nf-winbase-localrealloc) modifient la taille ou les attributs d’un objet mémoire alloué par [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc) et [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc).</span><span class="sxs-lookup"><span data-stu-id="097bd-128">The [**GlobalReAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalrealloc) and [**LocalReAlloc**](/windows/desktop/api/WinBase/nf-winbase-localrealloc) functions change the size or the attributes of a memory object allocated by [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc) and [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc).</span></span> <span data-ttu-id="097bd-129">La taille peut augmenter ou diminuer.</span><span class="sxs-lookup"><span data-stu-id="097bd-129">The size can increase or decrease.</span></span>

<span data-ttu-id="097bd-130">Les fonctions [**GlobalFree**](/windows/desktop/api/WinBase/nf-winbase-globalfree) et [**LocalFree**](/windows/desktop/api/WinBase/nf-winbase-localfree) libèrent la mémoire allouée par [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc), [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc), [**GlobalReAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalrealloc)ou [**LocalReAlloc**](/windows/desktop/api/WinBase/nf-winbase-localrealloc).</span><span class="sxs-lookup"><span data-stu-id="097bd-130">The [**GlobalFree**](/windows/desktop/api/WinBase/nf-winbase-globalfree) and [**LocalFree**](/windows/desktop/api/WinBase/nf-winbase-localfree) functions release memory allocated by [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc), [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc), [**GlobalReAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalrealloc), or [**LocalReAlloc**](/windows/desktop/api/WinBase/nf-winbase-localrealloc).</span></span> <span data-ttu-id="097bd-131">Pour ignorer l’objet mémoire spécifié sans invalider le handle, utilisez la fonction [**GlobalDiscard**](/windows/desktop/api/WinBase/nf-winbase-globaldiscard) ou [**LocalDiscard**](/windows/win32/api/minwinbase/nf-minwinbase-localdiscard) .</span><span class="sxs-lookup"><span data-stu-id="097bd-131">To discard the specified memory object without invalidating the handle, use the [**GlobalDiscard**](/windows/desktop/api/WinBase/nf-winbase-globaldiscard) or [**LocalDiscard**](/windows/win32/api/minwinbase/nf-minwinbase-localdiscard) function.</span></span> <span data-ttu-id="097bd-132">Le descripteur peut être utilisé ultérieurement par **GlobalReAlloc** ou **LocalReAlloc** pour allouer un nouveau bloc de mémoire associé au même handle.</span><span class="sxs-lookup"><span data-stu-id="097bd-132">The handle can be used later by **GlobalReAlloc** or **LocalReAlloc** to allocate a new block of memory associated with the same handle.</span></span>

<span data-ttu-id="097bd-133">Pour retourner des informations sur un objet mémoire spécifié, utilisez la fonction [**GlobalFlags**](/windows/desktop/api/WinBase/nf-winbase-globalflags) ou [**LocalFlags**](/windows/desktop/api/WinBase/nf-winbase-localflags) .</span><span class="sxs-lookup"><span data-stu-id="097bd-133">To return information about a specified memory object, use the [**GlobalFlags**](/windows/desktop/api/WinBase/nf-winbase-globalflags) or [**LocalFlags**](/windows/desktop/api/WinBase/nf-winbase-localflags) function.</span></span> <span data-ttu-id="097bd-134">Les informations incluent le nombre de verrous de l’objet et indiquent si l’objet est supprimé ou a déjà été ignoré.</span><span class="sxs-lookup"><span data-stu-id="097bd-134">The information includes the object's lock count and indicates whether the object is discardable or has already been discarded.</span></span> <span data-ttu-id="097bd-135">Pour retourner un handle à l’objet mémoire associé à un pointeur spécifié, utilisez la fonction [**GlobalHandle**](/windows/desktop/api/WinBase/nf-winbase-globalhandle) ou [**LocalHandle**](/windows/desktop/api/WinBase/nf-winbase-localhandle) .</span><span class="sxs-lookup"><span data-stu-id="097bd-135">To return a handle to the memory object associated with a specified pointer, use the [**GlobalHandle**](/windows/desktop/api/WinBase/nf-winbase-globalhandle) or [**LocalHandle**](/windows/desktop/api/WinBase/nf-winbase-localhandle) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="097bd-136">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="097bd-136">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="097bd-137">Comparaison des méthodes d’allocation de mémoire</span><span class="sxs-lookup"><span data-stu-id="097bd-137">Comparing Memory Allocation Methods</span></span>](comparing-memory-allocation-methods.md)
</dt> </dl>

 

 
