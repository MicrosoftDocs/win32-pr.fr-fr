---
description: 'Réglage à 4 gigaoctets : BCDEdit et Boot.ini'
ms.assetid: 991eb86f-9e6f-4084-8b6f-f979e42104b5
title: 'Réglage à 4 gigaoctets : BCDEdit et Boot.ini'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f997ae09748370d5ec8ec246da80b6440d7aaf45
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104202752"
---
# <a name="4-gigabyte-tuning-bcdedit-and-bootini"></a><span data-ttu-id="70153-103">Réglage à 4 gigaoctets : BCDEdit et Boot.ini</span><span class="sxs-lookup"><span data-stu-id="70153-103">4-Gigabyte Tuning: BCDEdit and Boot.ini</span></span>

<span data-ttu-id="70153-104">Sur les éditions 32 bits de Windows, 4 gigaoctets (Go) d’espace d’adressage virtuel sont disponibles pour les applications.</span><span class="sxs-lookup"><span data-stu-id="70153-104">On 32-bit editions of Windows, applications have 4 gigabyte (GB) of virtual address space available.</span></span> <span data-ttu-id="70153-105">L’espace d’adressage virtuel est divisé de manière à ce que 2 Go soient disponibles pour l’application et les 2 Go sont uniquement disponibles pour le système.</span><span class="sxs-lookup"><span data-stu-id="70153-105">The virtual address space is divided so that 2 GB is available to the application and the other 2 GB is available only to the system.</span></span> <span data-ttu-id="70153-106">La fonctionnalité de réglage à 4 gigaoctets (réglage de RAM 4GT ou 4GT), activée avec la commande *bcdedit/set increaseuserva* , augmente l’espace d’adressage virtuel disponible pour l’application jusqu’à 3 Go, et réduit la quantité disponible sur le système entre 1 et 2 Go.</span><span class="sxs-lookup"><span data-stu-id="70153-106">The 4-gigabyte tuning (4GT or 4GT RAM Tuning) feature, enabled with the *BCDEdit /set increaseuserva* command, increases the virtual address space that is available to the application up to 3 GB, and reduces the amount available to the system to between 1 and 2 GB.</span></span>

<span data-ttu-id="70153-107">Pour les applications gourmandes en mémoire, telles que les systèmes de gestion de base de données (SGBD), l’utilisation d’un espace d’adressage virtuel plus important peut offrir des avantages considérables en matière de performances et d’évolutivité.</span><span class="sxs-lookup"><span data-stu-id="70153-107">For applications that are memory-intensive, such as database management systems (DBMS), the use of a larger virtual address space can provide considerable performance and scalability benefits.</span></span> <span data-ttu-id="70153-108">Toutefois, le cache de fichiers, le pool paginé et la réserve non paginée sont plus petits, ce qui peut nuire aux applications avec une mise en réseau lourde ou des e/s.</span><span class="sxs-lookup"><span data-stu-id="70153-108">However, the file cache, paged pool, and nonpaged pool are smaller, which can adversely affect applications with heavy networking or I/O.</span></span> <span data-ttu-id="70153-109">Par conséquent, vous pouvez tester votre application sous charge et examiner les compteurs de performance pour déterminer si votre application tire parti de l’espace d’adressage plus grand.</span><span class="sxs-lookup"><span data-stu-id="70153-109">Therefore, you might want to test your application under load, and examine the performance counters to determine whether your application benefits from the larger address space.</span></span>

<span data-ttu-id="70153-110">Pour activer 4GT, utilisez la commande [bcdedit/set](/windows-hardware/drivers/devtest/bcdedit--set) pour définir l’option d’entrée de démarrage **increaseuserva** sur une valeur comprise entre 2048 (2 Go) et 3072 (3 Go).</span><span class="sxs-lookup"><span data-stu-id="70153-110">To enable 4GT, use the [BCDEdit /set](/windows-hardware/drivers/devtest/bcdedit--set) command to set the **increaseuserva** boot entry option to a value between 2048 (2 GB) and 3072 (3 GB).</span></span>

<span data-ttu-id="70153-111">**Windows Server 2003 et versions antérieures :** Pour activer 4GT, ajoutez le commutateur **/3GB** au fichier Boot.ini.</span><span class="sxs-lookup"><span data-stu-id="70153-111">**Windows Server 2003 and earlier:** To enable 4GT, add the **/3GB** switch to the Boot.ini file.</span></span> <span data-ttu-id="70153-112">Le commutateur **/3GB** est pris en charge sur les systèmes suivants :</span><span class="sxs-lookup"><span data-stu-id="70153-112">The **/3GB** switch is supported on the following systems:</span></span>

-   <span data-ttu-id="70153-113">Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="70153-113">Windows Server 2003</span></span>
-   <span data-ttu-id="70153-114">Windows XP Professionnel</span><span class="sxs-lookup"><span data-stu-id="70153-114">Windows XP Professional</span></span>

<span data-ttu-id="70153-115">Le commutateur **/3GB** permet aux applications d’accéder à 3 Go d’espace d’adressage virtuel complet et réduit la quantité de mémoire disponible pour le système à 1 Go.</span><span class="sxs-lookup"><span data-stu-id="70153-115">The **/3GB** switch makes a full 3 GB of virtual address space available to applications and reduces the amount available to the system to 1 GB.</span></span> <span data-ttu-id="70153-116">Sur Windows Server 2003, la quantité d’espace d’adressage disponible pour les applications peut être ajustée en définissant le commutateur **/USERVA** dans Boot.ini sur une valeur comprise entre 2048 et 3072, ce qui augmente la quantité d’espace d’adressage disponible pour le système.</span><span class="sxs-lookup"><span data-stu-id="70153-116">On Windows Server 2003, the amount of address space available to applications can be adjusted by setting the **/USERVA** switch in Boot.ini to a value between 2048 and 3072, which increases the amount of address space available to the system.</span></span> <span data-ttu-id="70153-117">Cela peut aider à maintenir les performances globales du système lorsque l’application nécessite plus de 2 Go mais moins de 3 Go d’espace d’adressage.</span><span class="sxs-lookup"><span data-stu-id="70153-117">This can help maintain overall system performance when the application requires more than 2 GB but less than 3 GB of address space.</span></span>

<span data-ttu-id="70153-118">Pour permettre à une application d’utiliser l’espace d’adressage le plus grand, définissez l’indicateur de prise en [**\_ \_ \_ \_ charge d’adresses volumineuses du fichier image**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) dans l’en-tête d’image.</span><span class="sxs-lookup"><span data-stu-id="70153-118">To enable an application to use the larger address space, set the [**IMAGE\_FILE\_LARGE\_ADDRESS\_AWARE**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) flag in the image header.</span></span> <span data-ttu-id="70153-119">L’éditeur de liens inclus avec Microsoft Visual C++ prend en charge le commutateur **/LARGEADDRESSAWARE** pour définir cet indicateur.</span><span class="sxs-lookup"><span data-stu-id="70153-119">The linker included with Microsoft Visual C++ supports the **/LARGEADDRESSAWARE** switch to set this flag.</span></span> <span data-ttu-id="70153-120">La définition de cet indicateur, puis l’exécution de l’application sur un système qui ne dispose pas de la prise en charge de 4GT, ne doit pas affecter l’application.</span><span class="sxs-lookup"><span data-stu-id="70153-120">Setting this flag and then running the application on a system that does not have 4GT support should not affect the application.</span></span>

<span data-ttu-id="70153-121">Sur les éditions 64 bits de Windows, les applications 32 bits marquées avec l’indicateur de [**\_ \_ \_ \_ reconnaissance d’adresse volumineux du fichier image**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) disposent de 4 Go d’espace d’adressage disponibles.</span><span class="sxs-lookup"><span data-stu-id="70153-121">On 64-bit editions of Windows, 32-bit applications marked with the [**IMAGE\_FILE\_LARGE\_ADDRESS\_AWARE**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) flag have 4 GB of address space available.</span></span>

<span data-ttu-id="70153-122">**Éditions Itanium de Windows Server 2003 :** Avant SP1, les processus 32 bits ne disposent que de 2 Go d’espace d’adressage disponibles.</span><span class="sxs-lookup"><span data-stu-id="70153-122">**Itanium editions of Windows Server 2003:** Prior to SP1, 32-bit processes have only 2 GB of address space available.</span></span>

<span data-ttu-id="70153-123">Utilisez les instructions suivantes pour prendre en charge 4GT dans les applications :</span><span class="sxs-lookup"><span data-stu-id="70153-123">Use the following guidelines to support 4GT in applications:</span></span>

-   <span data-ttu-id="70153-124">Les adresses proches de la limite de 2 Go sont généralement utilisées par différentes DLL système.</span><span class="sxs-lookup"><span data-stu-id="70153-124">Addresses near the 2-GB boundary are typically used by various system DLLs.</span></span> <span data-ttu-id="70153-125">Par conséquent, un processus 32 bits ne peut pas allouer plus de 2 Go de mémoire contiguë, même si la totalité de l’espace d’adressage de 4 Go est disponible.</span><span class="sxs-lookup"><span data-stu-id="70153-125">Therefore, a 32-bit process cannot allocate more than 2 GB of contiguous memory, even if the entire 4-GB address space is available.</span></span>
-   <span data-ttu-id="70153-126">Pour récupérer la quantité d’espace virtuel utilisateur total, utilisez la fonction [**GlobalMemoryStatusEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) .</span><span class="sxs-lookup"><span data-stu-id="70153-126">To retrieve the amount of total user virtual space, use the [**GlobalMemoryStatusEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) function.</span></span> <span data-ttu-id="70153-127">Pour récupérer l’adresse utilisateur la plus élevée possible, utilisez la fonction [**GetSystemInfo**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) .</span><span class="sxs-lookup"><span data-stu-id="70153-127">To retrieve the highest possible user address, use the [**GetSystemInfo**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function.</span></span> <span data-ttu-id="70153-128">Détectez toujours la valeur réelle au moment de l’exécution et évitez d’utiliser des définitions constantes câblées telles que : `#define HIGHEST_USER_ADDRESS 0xC0000000` .</span><span class="sxs-lookup"><span data-stu-id="70153-128">Always detect the real value at runtime, and avoid using hard-wired constant definitions such as: `#define HIGHEST_USER_ADDRESS 0xC0000000`.</span></span>
-   <span data-ttu-id="70153-129">Évitez les comparaisons signées avec des pointeurs, car ils peuvent provoquer le blocage des applications sur un système compatible 4GT.</span><span class="sxs-lookup"><span data-stu-id="70153-129">Avoid signed comparisons with pointers, because they might cause applications to crash on a 4GT-enabled system.</span></span> <span data-ttu-id="70153-130">Une condition telle que la suivante est false pour un pointeur qui est au-dessus de 2 Go : `if (pointer > 40000000)` .</span><span class="sxs-lookup"><span data-stu-id="70153-130">A condition such as the following is false for a pointer that is above 2 GB: `if (pointer > 40000000)`.</span></span>
-   <span data-ttu-id="70153-131">Le code qui utilise le bit le plus élevé d’un pointeur pour une fonction définie par l’application échouera quand 4GT sera activé.</span><span class="sxs-lookup"><span data-stu-id="70153-131">Code that uses the highest bit of a pointer for an application-defined purpose will fail when 4GT is enabled.</span></span> <span data-ttu-id="70153-132">Par exemple, un mot de 32 bits peut être considéré comme une adresse en mode utilisateur s’il est inférieur à 0x80000000 et un code d’erreur s’il est indiqué ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="70153-132">For example, a 32-bit word might be considered a user-mode address if it is below 0x80000000, and an error code if above.</span></span> <span data-ttu-id="70153-133">Ce n’est pas le cas avec 4GT.</span><span class="sxs-lookup"><span data-stu-id="70153-133">This is not true with 4GT.</span></span>

<span data-ttu-id="70153-134">[**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) retourne généralement des adresses faibles avant les adresses haute.</span><span class="sxs-lookup"><span data-stu-id="70153-134">[**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) usually returns low addresses before high addresses.</span></span> <span data-ttu-id="70153-135">Par conséquent, votre processus peut ne pas utiliser des adresses très élevées, sauf s’il alloue beaucoup de mémoire ou a un espace d’adressage virtuel fragmenté.</span><span class="sxs-lookup"><span data-stu-id="70153-135">Therefore, your process may not use very high addresses unless it allocates a lot of memory or has a fragmented virtual address space.</span></span> <span data-ttu-id="70153-136">Pour forcer les allocations à allouer à partir d’adresses supérieures avant des adresses plus basses à des fins de test, spécifiez mem de haut en bas lors de l’appel de **VirtualAlloc** ou définissez la valeur de Registre suivante sur **\_ \_ la** valeur égale à égale à</span><span class="sxs-lookup"><span data-stu-id="70153-136">To force allocations to allocate from higher addresses before lower addresses for testing purposes, specify **MEM\_TOP\_DOWN** when calling **VirtualAlloc** or set the following registry value to 0x100000:</span></span>

<span data-ttu-id="70153-137">**HKEY \_ Gestion \_** de la \\  \\  \\  \\ mémoire du gestionnaire de session du **Gestionnaire de session** \\  \\  du système d’ordinateur local AllocationPreference</span><span class="sxs-lookup"><span data-stu-id="70153-137">**HKEY\_LOCAL\_MACHINE**\\**System**\\**CurrentControlSet**\\**Control**\\**Session Manager**\\**Memory Management**\\**AllocationPreference**</span></span>

## <a name="related-topics"></a><span data-ttu-id="70153-138">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="70153-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="70153-139">Limites de mémoire pour les versions de Windows</span><span class="sxs-lookup"><span data-stu-id="70153-139">Memory Limits for Windows Releases</span></span>](memory-limits-for-windows-releases.md)
</dt> <dt>

[<span data-ttu-id="70153-140">Extension d’adresse physique</span><span class="sxs-lookup"><span data-stu-id="70153-140">Physical Address Extension</span></span>](physical-address-extension.md)
</dt> <dt>

<span data-ttu-id="70153-141">[informations techniques de référence sur 4GT](/previous-versions/windows/it-pro/windows-server-2003/cc778496(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="70153-141">[4GT Technical Reference](/previous-versions/windows/it-pro/windows-server-2003/cc778496(v=ws.10))</span></span>
</dt> </dl>

 

 
