---
description: Pour éviter les attaques malveillantes, déterminez si votre application requiert des privilèges d’administrateur. Pour les fonctions qui nécessitent des autorisations d’administrateur, créez une application distincte et utilisez la commande de ligne de commande Windows RunAs.
ms.assetid: afa520fc-c206-49de-8d73-8f6566ec4fb6
title: Exécution avec des privilèges d’administrateur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc28843195e9b5cabadc13aa2317b0bdd8058ef8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106518909"
---
# <a name="running-with-administrator-privileges"></a><span data-ttu-id="2e7bf-104">Exécution avec des privilèges d’administrateur</span><span class="sxs-lookup"><span data-stu-id="2e7bf-104">Running with Administrator Privileges</span></span>

<span data-ttu-id="2e7bf-105">La première étape pour déterminer le type de compte que votre application doit exécuter consiste à examiner les ressources que l’application utilisera et les API privilégiées qu’elle appellera.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-105">The first step in establishing which type of account your application needs to run under is to examine what resources the application will use and what privileged APIs it will call.</span></span> <span data-ttu-id="2e7bf-106">Vous constaterez peut-être que l’application, ou ses grandes parties, ne nécessitent pas de privilèges d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-106">You may find that the application, or large parts of it, do not require administrator privileges.</span></span> <span data-ttu-id="2e7bf-107">L' *écriture de code sécurisé*, par Michael Howard et David LeBlanc, offre une excellente description de la façon d’effectuer cette évaluation et est fortement recommandée.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-107">*Writing Secure Code*, by Michael Howard and David LeBlanc offers an excellent description of how to carry out this assessment and is highly recommended.</span></span> <span data-ttu-id="2e7bf-108">(Cette ressource n’est peut-être pas disponible dans certaines langues et certains pays.)</span><span class="sxs-lookup"><span data-stu-id="2e7bf-108">(This resource may not be available in some languages and countries.)</span></span>

<span data-ttu-id="2e7bf-109">Vous pouvez fournir les privilèges dont votre application a besoin pour réduire les risques d’attaques malveillantes en utilisant l’une des approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="2e7bf-109">You can provide the privileges your application needs with less exposure to malicious attack by using one of the following approaches:</span></span>

-   <span data-ttu-id="2e7bf-110">Exécutez sous un compte avec moins de privilèges.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-110">Run under an account with less privilege.</span></span> <span data-ttu-id="2e7bf-111">Pour ce faire, vous pouvez utiliser [**PrivilegeCheck**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-privilegecheck) pour déterminer les privilèges qui sont activés dans un jeton.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-111">One way to do this is to use [**PrivilegeCheck**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-privilegecheck) to determine what privileges are enabled in a token.</span></span> <span data-ttu-id="2e7bf-112">Si les privilèges disponibles ne sont pas adaptés à l’opération en cours, vous pouvez désactiver ce code et demander à l’utilisateur de se connecter à un compte disposant de privilèges d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-112">If the available privileges are not adequate for the current operation, you can disable that code and ask the user to logon to an account with administrator privileges.</span></span>
-   <span data-ttu-id="2e7bf-113">S’arrêter dans des fonctions d’application distinctes qui nécessitent des autorisations d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-113">Break into a separate application functions that require administrator permissions.</span></span> <span data-ttu-id="2e7bf-114">Vous pouvez fournir à l’utilisateur un raccourci qui exécute la commande RunAs.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-114">You can provide for the user a shortcut that executes the RunAs command.</span></span> <span data-ttu-id="2e7bf-115">Pour obtenir des instructions détaillées sur la façon de configurer le raccourci, recherchez « runas » dans l’aide.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-115">For detailed instructions on how to set up the shortcut, search for "runas" in Help.</span></span> <span data-ttu-id="2e7bf-116">Par programme, vous pouvez configurer la commande [runas](/windows/desktop/com/runas) sous la clé de registre de la [clé AppID](/windows/desktop/com/appid-key) pour votre application.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-116">Programmatically, you can configure the [RunAs](/windows/desktop/com/runas) command under the [AppId Key](/windows/desktop/com/appid-key) registry key for your application.</span></span>
-   <span data-ttu-id="2e7bf-117">Authentifiez l’utilisateur en appelant [**CredUIPromptForCredentials**](/windows/desktop/api/wincred/nf-wincred-creduipromptforcredentialsa) (GUI) ou [**CredUICmdLinePromptForCredentials**](/windows/desktop/api/wincred/nf-wincred-creduicmdlinepromptforcredentialsa) (ligne de commande) pour obtenir le nom d’utilisateur et le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-117">Authenticate the user by calling [**CredUIPromptForCredentials**](/windows/desktop/api/wincred/nf-wincred-creduipromptforcredentialsa) (GUI) or [**CredUICmdLinePromptForCredentials**](/windows/desktop/api/wincred/nf-wincred-creduicmdlinepromptforcredentialsa) (command line) to obtain user name and password.</span></span> <span data-ttu-id="2e7bf-118">Pour obtenir un exemple, consultez [demande d’informations d’identification à l’utilisateur](asking-the-user-for-credentials.md).</span><span class="sxs-lookup"><span data-stu-id="2e7bf-118">For an example, see [Asking the User for Credentials](asking-the-user-for-credentials.md).</span></span>
-   <span data-ttu-id="2e7bf-119">Emprunter l’identité de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-119">Impersonate the user.</span></span> <span data-ttu-id="2e7bf-120">Un processus qui démarre sous un compte à privilèges élevés comme System peut emprunter l’identité d’un compte d’utilisateur en appelant [**ImpersonateLoggedOnUser**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser) ou des fonctions d’emprunt d’identité similaires, réduisant ainsi le niveau de privilège.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-120">A process that starts under a highly privileged account like System can impersonate a user account by calling [**ImpersonateLoggedOnUser**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser) or similar Impersonate functions, thus reducing privilege level.</span></span> <span data-ttu-id="2e7bf-121">Toutefois, si un appel à [**RevertToSelf**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-reverttoself) est injecté dans le thread, le processus revient aux privilèges système d’origine.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-121">However, if a call to [**RevertToSelf**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-reverttoself) is injected into the thread, the process returns to the original System privileges.</span></span>

<span data-ttu-id="2e7bf-122">Si vous avez déterminé que votre application doit s’exécuter sous un compte disposant de privilèges d’administrateur et qu’un mot de passe d’administrateur doit être stocké dans le système logiciel, consultez [gestion des mots de passe](handling-passwords.md) pour les méthodes de ce faire en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="2e7bf-122">If you have determined that your application must run under an account with administrator privileges and that an administrator password must be stored in the software system, see [Handling Passwords](handling-passwords.md) for methods of doing this safely.</span></span>

 

 
