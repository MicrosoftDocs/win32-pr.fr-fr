---
description: Avec un objet de traitement, des groupes de processus peuvent être gérés en tant qu’unité. Les objets de traitement sont des objets namable, sécurisables et partageables qui contrôlent les attributs des processus qui leur sont associés.
ms.assetid: 59296384-5e78-44dd-8019-f1df6668928b
title: Objets de traitement
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 07e6d9758faf2b66f047ca60dbba91601b202b4c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104319165"
---
# <a name="job-objects"></a><span data-ttu-id="7f751-104">Objets de traitement</span><span class="sxs-lookup"><span data-stu-id="7f751-104">Job Objects</span></span>

<span data-ttu-id="7f751-105">Un *objet de traitement* permet de gérer des groupes de processus en tant qu’unité.</span><span class="sxs-lookup"><span data-stu-id="7f751-105">A *job object* allows groups of processes to be managed as a unit.</span></span> <span data-ttu-id="7f751-106">Les objets de traitement sont des objets namable, sécurisables et partageables qui contrôlent les attributs des processus qui leur sont associés.</span><span class="sxs-lookup"><span data-stu-id="7f751-106">Job objects are namable, securable, sharable objects that control attributes of the processes associated with them.</span></span> <span data-ttu-id="7f751-107">Les opérations effectuées sur un objet de traitement affectent tous les processus associés à cet objet.</span><span class="sxs-lookup"><span data-stu-id="7f751-107">Operations performed on a job object affect all processes associated with the job object.</span></span> <span data-ttu-id="7f751-108">Les exemples incluent des limites d’application, telles que la taille de la plage de travail et la priorité du processus, ou l’arrêt de tous les processus associés à un travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-108">Examples include enforcing limits such as working set size and process priority or terminating all processes associated with a job.</span></span>

-   [<span data-ttu-id="7f751-109">Création de travaux</span><span class="sxs-lookup"><span data-stu-id="7f751-109">Creating Jobs</span></span>](#creating-jobs)
-   [<span data-ttu-id="7f751-110">Gestion des processus dans les travaux</span><span class="sxs-lookup"><span data-stu-id="7f751-110">Managing Processes in Jobs</span></span>](#managing-processes-in-jobs)
-   [<span data-ttu-id="7f751-111">Limites du travail et notifications</span><span class="sxs-lookup"><span data-stu-id="7f751-111">Job Limits and Notifications</span></span>](#job-limits-and-notifications)
-   [<span data-ttu-id="7f751-112">Comptabilisation des ressources pour les travaux</span><span class="sxs-lookup"><span data-stu-id="7f751-112">Resource Accounting for Jobs</span></span>](#resource-accounting-for-jobs)
-   [<span data-ttu-id="7f751-113">Gestion des objets de traitement</span><span class="sxs-lookup"><span data-stu-id="7f751-113">Managing Job Objects</span></span>](#managing-job-objects)
-   [<span data-ttu-id="7f751-114">Gestion d’une arborescence de processus qui utilise des objets de traitement</span><span class="sxs-lookup"><span data-stu-id="7f751-114">Managing a Process Tree that Uses Job Objects</span></span>](#managing-a-process-tree-that-uses-job-objects)

## <a name="creating-jobs"></a><span data-ttu-id="7f751-115">Création de travaux</span><span class="sxs-lookup"><span data-stu-id="7f751-115">Creating Jobs</span></span>

<span data-ttu-id="7f751-116">Pour créer un objet de traitement, utilisez la fonction [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) .</span><span class="sxs-lookup"><span data-stu-id="7f751-116">To create a job object, use the [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) function.</span></span> <span data-ttu-id="7f751-117">Lorsque le travail est créé, aucun processus n’est associé à ce travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-117">When the job is created, no processes are associated with the job.</span></span>

<span data-ttu-id="7f751-118">Pour associer un processus à un travail, utilisez la fonction [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) .</span><span class="sxs-lookup"><span data-stu-id="7f751-118">To associate a process with a job, use the [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) function.</span></span> <span data-ttu-id="7f751-119">Une fois qu’un processus est associé à un travail, l’Association ne peut pas être interrompue.</span><span class="sxs-lookup"><span data-stu-id="7f751-119">After a process is associated with a job, the association cannot be broken.</span></span> <span data-ttu-id="7f751-120">Un processus peut être associé à plusieurs travaux dans une hiérarchie de travaux imbriqués.</span><span class="sxs-lookup"><span data-stu-id="7f751-120">A process can be associated with more than one job in a hierarchy of nested jobs.</span></span> <span data-ttu-id="7f751-121">Pour plus d’informations, consultez [tâches imbriquées](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="7f751-121">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="7f751-122">**Windows 7, Windows server 2008 R2, Windows XP avec SP3, Windows server 2008, Windows Vista et Windows server 2003 :** Un processus ne peut être associé qu’à un seul travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-122">**Windows 7, Windows Server 2008 R2, Windows XP with SP3, Windows Server 2008, Windows Vista and Windows Server 2003:** A process can be associated with only one job.</span></span> <span data-ttu-id="7f751-123">Les travaux ne peuvent pas être imbriqués.</span><span class="sxs-lookup"><span data-stu-id="7f751-123">Jobs cannot be nested.</span></span> <span data-ttu-id="7f751-124">La capacité à imbriquer des travaux a été ajoutée dans Windows 8 et Windows Server 2012.</span><span class="sxs-lookup"><span data-stu-id="7f751-124">The ability to nest jobs was added in Windows 8 and Windows Server 2012.</span></span>

<span data-ttu-id="7f751-125">Vous pouvez spécifier un descripteur de sécurité pour un objet de traitement lorsque vous appelez la fonction [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) .</span><span class="sxs-lookup"><span data-stu-id="7f751-125">You can specify a security descriptor for a job object when you call the [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) function.</span></span> <span data-ttu-id="7f751-126">Pour plus d’informations, consultez [sécurité et droits d’accès à l’objet de traitement](job-object-security-and-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="7f751-126">For more information, see [Job Object Security and Access Rights](job-object-security-and-access-rights.md).</span></span>

## <a name="managing-processes-in-jobs"></a><span data-ttu-id="7f751-127">Gestion des processus dans les travaux</span><span class="sxs-lookup"><span data-stu-id="7f751-127">Managing Processes in Jobs</span></span>

<span data-ttu-id="7f751-128">Une fois qu’un processus est associé à un travail, par défaut, tous les processus enfants qu’il crée à l’aide de [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) sont également associés à ce travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-128">After a process is associated with a job, by default any child processes it creates using [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) are also associated with the job.</span></span> <span data-ttu-id="7f751-129">(Les processus enfants créés à l’aide du [**\_ processus Win32. Create**](../cimwin32prov/create-method-in-class-win32-process.md) ne sont pas associés au travail.) Vous pouvez modifier ce comportement par défaut en définissant la \_ \_ dissociation limite de l’objet de tâche de limite étendue \_ \_ OK ou \_ \_ \_ \_ la dissociation silencieuse \_ de limite d’objet de traitement OK pour le travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-129">(Child processes created using [**Win32\_Process.Create**](../cimwin32prov/create-method-in-class-win32-process.md) are not associated with the job.) This default behavior can be changed by setting the extended limit JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK or JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK for the job.</span></span>

-   <span data-ttu-id="7f751-130">Si la limite de la limite de l’objet de tâche de limite étendue est définie \_ \_ \_ \_ sur OK et que le processus parent a été créé avec l’indicateur créer une \_ dissociation \_ à partir d’une \_ tâche, les processus enfants du processus parent ne sont pas associés au travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-130">If the job has the extended limit JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK and the parent process was created with the CREATE\_BREAKAWAY\_FROM\_JOB flag, then child processes of the parent process are not associated with the job.</span></span>
-   <span data-ttu-id="7f751-131">Si la \_ \_ dissociation silencieuse de la limite de l’objet de tâche limite étendue est \_ \_ \_ OK, les processus enfants d’un processus parent associé au travail ne sont pas associés à ce travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-131">If the job has the extended limit JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK, then child processes of any parent process associated with the job are not associated with the job.</span></span> <span data-ttu-id="7f751-132">Il n’est pas nécessaire de créer des processus parents avec l’indicateur CREATe \_ dissociation \_ from \_ Job.</span><span class="sxs-lookup"><span data-stu-id="7f751-132">It is not necessary for parent processes to be created with the CREATE\_BREAKAWAY\_FROM\_JOB flag.</span></span>

<span data-ttu-id="7f751-133">Si le travail est imbriqué, les paramètres de dissociation des travaux parents dans la hiérarchie déterminent si les processus enfants sont associés à un autre travail dans la hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="7f751-133">If the job is nested, the breakaway settings of parent jobs in the hierarchy affect whether child processes are associated with another job in the hierarchy.</span></span> <span data-ttu-id="7f751-134">Pour plus d’informations, consultez [tâches imbriquées](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="7f751-134">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="7f751-135">Pour déterminer si un processus s’exécute dans un travail, utilisez la fonction [**IsProcessInJob**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob) .</span><span class="sxs-lookup"><span data-stu-id="7f751-135">To determine if a process is running in a job, use the [**IsProcessInJob**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob) function.</span></span>

<span data-ttu-id="7f751-136">Pour mettre fin à tous les processus actuellement associés à un objet de traitement, utilisez la fonction [**TerminateJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-terminatejobobject) .</span><span class="sxs-lookup"><span data-stu-id="7f751-136">To terminate all processes currently associated with a job object, use the [**TerminateJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-terminatejobobject) function.</span></span>

## <a name="job-limits-and-notifications"></a><span data-ttu-id="7f751-137">Limites du travail et notifications</span><span class="sxs-lookup"><span data-stu-id="7f751-137">Job Limits and Notifications</span></span>

<span data-ttu-id="7f751-138">Un travail peut appliquer des limites telles que la taille de la plage de travail, la priorité du processus et la limite de temps de fin de travail sur chaque processus associé au travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-138">A job can enforce limits such as working set size, process priority, and end-of-job time limit on each process that is associated with the job.</span></span> <span data-ttu-id="7f751-139">Si un processus associé à un travail tente d’augmenter sa taille de jeu de travail ou sa priorité de processus à partir de la limite établie par le travail, les appels de fonction réussissent mais sont ignorés en mode silencieux.</span><span class="sxs-lookup"><span data-stu-id="7f751-139">If a process associated with a job attempts to increase its working set size or process priority from the limit established by the job, the function calls succeed but are silently ignored.</span></span> <span data-ttu-id="7f751-140">Un travail peut également définir des limites qui déclenchent une notification lorsqu’elles sont dépassées, mais autorisent la poursuite de l’exécution du travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-140">A job can also set limits that trigger a notification when they are exceeded but allow the job to continue to run.</span></span>

<span data-ttu-id="7f751-141">Pour définir les limites d’un travail, utilisez la fonction [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) .</span><span class="sxs-lookup"><span data-stu-id="7f751-141">To set limits for a job, use the [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function.</span></span> <span data-ttu-id="7f751-142">Pour obtenir la liste des limites possibles qui peuvent être définies pour un travail, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="7f751-142">For a list of possible limits that can be set for a job, see the following topics:</span></span>

-   [<span data-ttu-id="7f751-143">**\_ \_ informations sur les limites de base de JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="7f751-143">**JOBOBJECT\_BASIC\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_limit_information)
-   [<span data-ttu-id="7f751-144">**JOBOBJECT \_ \_ restrictions de l’interface utilisateur de base \_**</span><span class="sxs-lookup"><span data-stu-id="7f751-144">**JOBOBJECT\_BASIC\_UI\_RESTRICTIONS**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_ui_restrictions)
-   [<span data-ttu-id="7f751-145">**informations de contrôle de la \_ \_ fréquence de l’UC JOBOBJECT \_ \_**</span><span class="sxs-lookup"><span data-stu-id="7f751-145">**JOBOBJECT\_CPU\_RATE\_CONTROL\_INFORMATION**</span></span>](/windows/desktop/api/Winnt/ns-winnt-jobobject_cpu_rate_control_information)
-   [<span data-ttu-id="7f751-146">**\_ \_ informations sur la limite étendue JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="7f751-146">**JOBOBJECT\_EXTENDED\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_extended_limit_information)
-   [<span data-ttu-id="7f751-147">**\_ \_ informations sur les limites de notification JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="7f751-147">**JOBOBJECT\_NOTIFICATION\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_notification_limit_information)

<span data-ttu-id="7f751-148">Les limites de sécurité doivent être définies individuellement pour chaque processus associé à un objet de traitement.</span><span class="sxs-lookup"><span data-stu-id="7f751-148">Security limits must be set individually for each process associated with a job object.</span></span> <span data-ttu-id="7f751-149">Pour plus d’informations, consultez [sécurité des processus et droits d’accès](process-security-and-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="7f751-149">For more information, see [Process Security and Access Rights](process-security-and-access-rights.md).</span></span>

<span data-ttu-id="7f751-150">**Windows XP avec SP3 et Windows Server 2003 :** La fonction [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) peut être utilisée pour définir des limites de sécurité pour tous les processus associés à un objet de traitement.</span><span class="sxs-lookup"><span data-stu-id="7f751-150">**Windows XP with SP3 and Windows Server 2003:** The [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function can be used to set security limitations for all processes associated with a job object.</span></span> <span data-ttu-id="7f751-151">À compter de Windows Vista, les limites de sécurité doivent être définies individuellement pour chaque processus associé à un objet de traitement.</span><span class="sxs-lookup"><span data-stu-id="7f751-151">Starting with Windows Vista, security limits must be set individually for each process associated with a job object.</span></span>

<span data-ttu-id="7f751-152">Si le travail est imbriqué, les travaux parents dans la hiérarchie influencent la limite appliquée pour le travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-152">If the job is nested, parent jobs in the hierarchy influence the limit that is enforced for the job.</span></span> <span data-ttu-id="7f751-153">Pour plus d’informations, consultez [tâches imbriquées](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="7f751-153">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="7f751-154">Si le travail est associé à un port de terminaison d’e/s, il peut recevoir des notifications lorsque certaines limites de travail sont dépassées.</span><span class="sxs-lookup"><span data-stu-id="7f751-154">If the job has an associated I/O completion port, it can receive notifications when certain job limits are exceeded.</span></span> <span data-ttu-id="7f751-155">Le système envoie des messages au port de terminaison lorsqu’une limite est dépassée ou que certains autres événements se produisent.</span><span class="sxs-lookup"><span data-stu-id="7f751-155">The system sends messages to the completion port when a limit is exceeded or certain other events occur.</span></span> <span data-ttu-id="7f751-156">Pour associer un port de terminaison à un travail, utilisez la fonction [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) avec la classe d’informations de l’objet de traitement **JobObjectAssociateCompletionPortInformation** et un pointeur vers une structure de [**\_ \_ \_ port d’achèvement Associate JOBOBJECT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port) .</span><span class="sxs-lookup"><span data-stu-id="7f751-156">To associate a completion port with a job, use the [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function with the job object information class **JobObjectAssociateCompletionPortInformation** and a pointer to a [**JOBOBJECT\_ASSOCIATE\_COMPLETION\_PORT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port) structure.</span></span> <span data-ttu-id="7f751-157">Il est préférable de le faire lorsque le travail est inactif, afin de réduire le risque de notifications manquantes pour les processus dont les États changent au cours de l’Association du port de terminaison.</span><span class="sxs-lookup"><span data-stu-id="7f751-157">It is best to do this when the job is inactive, to reduce the chance of missing notifications for processes whose states change during the association of the completion port.</span></span>

<span data-ttu-id="7f751-158">Tous les messages sont envoyés directement à partir du travail comme si le travail avait appelé la fonction [**PostQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-postqueuedcompletionstatus) .</span><span class="sxs-lookup"><span data-stu-id="7f751-158">All messages are sent directly from the job as if the job had called the [**PostQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-postqueuedcompletionstatus) function.</span></span> <span data-ttu-id="7f751-159">Un thread doit surveiller le port de terminaison à l’aide de la fonction [**GetQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) pour récupérer les messages.</span><span class="sxs-lookup"><span data-stu-id="7f751-159">A thread must monitor the completion port using the [**GetQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) function to pick up the messages.</span></span> <span data-ttu-id="7f751-160">Notez que, à l’exception des limites définies avec la classe d’informations **JobObjectNotificationLimitInformation** , la remise de messages au port de terminaison n’est pas garantie ; l’échec de l’arrivée d’un message ne signifie pas nécessairement que l’événement ne s’est pas produit.</span><span class="sxs-lookup"><span data-stu-id="7f751-160">Note that, with the exception of limits set with the **JobObjectNotificationLimitInformation** information class, delivery of messages to the completion port is not guaranteed; failure of a message to arrive does not necessarily mean that the event did not occur.</span></span> <span data-ttu-id="7f751-161">Les notifications pour les limites définies avec **JobObjectNotificationLimitInformation** sont assurées d’arriver sur le port de terminaison.</span><span class="sxs-lookup"><span data-stu-id="7f751-161">Notifications for limits set with **JobObjectNotificationLimitInformation** are guaranteed to arrive at the completion port.</span></span> <span data-ttu-id="7f751-162">Pour obtenir la liste des messages possibles, consultez [**JOBOBJECT \_ Associate \_ Complete \_ port**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span><span class="sxs-lookup"><span data-stu-id="7f751-162">For a list of possible messages, see [**JOBOBJECT\_ASSOCIATE\_COMPLETION\_PORT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span></span>

## <a name="resource-accounting-for-jobs"></a><span data-ttu-id="7f751-163">Comptabilisation des ressources pour les travaux</span><span class="sxs-lookup"><span data-stu-id="7f751-163">Resource Accounting for Jobs</span></span>

<span data-ttu-id="7f751-164">L’objet de traitement enregistre les informations de comptabilité de base pour tous les processus associés, y compris ceux qui se sont terminés.</span><span class="sxs-lookup"><span data-stu-id="7f751-164">The job object records basic accounting information for all its associated processes, including those that have terminated.</span></span> <span data-ttu-id="7f751-165">Pour récupérer ces informations de comptabilité, utilisez la fonction [**QueryInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-queryinformationjobobject) .</span><span class="sxs-lookup"><span data-stu-id="7f751-165">To retrieve this accounting information, use the [**QueryInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-queryinformationjobobject) function.</span></span> <span data-ttu-id="7f751-166">Pour obtenir la liste des informations de comptabilité qui sont conservées pour un travail, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="7f751-166">For a list of the accounting information that is maintained for a job, see the following topics:</span></span>

-   [<span data-ttu-id="7f751-167">**\_informations de \_ comptabilité de base JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="7f751-167">**JOBOBJECT\_BASIC\_ACCOUNTING\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_accounting_information)
-   [<span data-ttu-id="7f751-168">**JOBOBJECT \_ \_ les informations de gestion de base et d' \_ e/s \_ \_**</span><span class="sxs-lookup"><span data-stu-id="7f751-168">**JOBOBJECT\_BASIC\_AND\_IO\_ACCOUNTING\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_and_io_accounting_information)

<span data-ttu-id="7f751-169">Si l’objet de traitement est imbriqué, les informations de comptabilité de chaque travail enfant sont agrégées dans son travail parent.</span><span class="sxs-lookup"><span data-stu-id="7f751-169">If the job object is nested, accounting information for each child job is aggregated in its parent job.</span></span> <span data-ttu-id="7f751-170">Pour plus d’informations, consultez [tâches imbriquées](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="7f751-170">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

## <a name="managing-job-objects"></a><span data-ttu-id="7f751-171">Gestion des objets de traitement</span><span class="sxs-lookup"><span data-stu-id="7f751-171">Managing Job Objects</span></span>

<span data-ttu-id="7f751-172">L’état d’un objet de traitement est défini sur signalé lorsque tous ses processus sont terminés, car la limite de durée de fin de travail spécifiée a été dépassée.</span><span class="sxs-lookup"><span data-stu-id="7f751-172">The state of a job object is set to signaled when all of its processes are terminated because the specified end-of-job time limit has been exceeded.</span></span> <span data-ttu-id="7f751-173">Utilisez [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) ou [**WaitForSingleObjectEx**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobjectex) pour surveiller l’objet de traitement de cet événement.</span><span class="sxs-lookup"><span data-stu-id="7f751-173">Use [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) or [**WaitForSingleObjectEx**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobjectex) to monitor the job object for this event.</span></span>

<span data-ttu-id="7f751-174">Pour obtenir un handle pour un objet de traitement existant, utilisez la fonction [**OpenJobObject**](/windows/desktop/api/WinBase/nf-winbase-openjobobjecta) et spécifiez le nom donné à l’objet lors de sa création.</span><span class="sxs-lookup"><span data-stu-id="7f751-174">To obtain a handle for an existing job object, use the [**OpenJobObject**](/windows/desktop/api/WinBase/nf-winbase-openjobobjecta) function and specify the name given to the object when it was created.</span></span> <span data-ttu-id="7f751-175">Seuls les objets de travail nommés peuvent être ouverts.</span><span class="sxs-lookup"><span data-stu-id="7f751-175">Only named job objects can be opened.</span></span>

<span data-ttu-id="7f751-176">Pour fermer un handle d’objet de traitement, utilisez la fonction [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="7f751-176">To close a job object handle, use the [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) function.</span></span> <span data-ttu-id="7f751-177">Le travail est détruit lorsque son dernier descripteur a été fermé et que tous les processus associés ont été arrêtés.</span><span class="sxs-lookup"><span data-stu-id="7f751-177">The job is destroyed when its last handle has been closed and all associated processes have been terminated.</span></span> <span data-ttu-id="7f751-178">Toutefois, si le travail a l' \_ \_ indicateur de fin de la limite des objets de tâche sur la fermeture du travail \_ \_ \_ \_ spécifié, la fermeture du dernier descripteur d’objet de travail met fin à tous les processus associés, puis détruit l’objet de traitement lui-même.</span><span class="sxs-lookup"><span data-stu-id="7f751-178">However, if the job has the JOB\_OBJECT\_LIMIT\_KILL\_ON\_JOB\_CLOSE flag specified, closing the last job object handle terminates all associated processes and then destroys the job object itself.</span></span> <span data-ttu-id="7f751-179">Si une tâche imbriquée a l' \_ \_ \_ \_ indicateur de fin de la limite des objets de tâche sur la \_ fermeture du travail \_ spécifié, la fermeture du dernier descripteur d’objet de travail met fin à tous les processus associés au travail et à ses tâches enfants dans la hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="7f751-179">If a nested job has the JOB\_OBJECT\_LIMIT\_KILL\_ON\_JOB\_CLOSE flag specified, closing the last job object handle terminates all processes associated with the job and its child jobs in the hierarchy.</span></span>

## <a name="managing-a-process-tree-that-uses-job-objects"></a><span data-ttu-id="7f751-180">Gestion d’une arborescence de processus qui utilise des objets de traitement</span><span class="sxs-lookup"><span data-stu-id="7f751-180">Managing a Process Tree that Uses Job Objects</span></span>

<span data-ttu-id="7f751-181">À compter de Windows 8 et de Windows Server 2012, une application peut utiliser des [tâches imbriquées](nested-jobs.md) pour gérer une arborescence de processus qui utilise plus d’un objet de traitement.</span><span class="sxs-lookup"><span data-stu-id="7f751-181">Starting with Windows 8 and Windows Server 2012, an application can use [nested jobs](nested-jobs.md) to manage a process tree that uses more than one job object.</span></span> <span data-ttu-id="7f751-182">Toutefois, une application qui doit s’exécuter sur Windows 7, Windows Server 2008 R2 ou des versions antérieures de Windows qui ne prennent pas en charge les travaux imbriqués doit gérer l’arborescence de processus d’une autre manière.</span><span class="sxs-lookup"><span data-stu-id="7f751-182">However, an application that must run on Windows 7, Windows Server 2008 R2, or earlier versions of Windows that do not support nested jobs must manage the process tree in other ways.</span></span>

<span data-ttu-id="7f751-183">Si un outil doit gérer une arborescence de processus qui utilise des objets de traitement et qu’il n’est pas possible d’utiliser des tâches imbriquées, l’outil et les membres de l’arborescence de processus doivent coopérer.</span><span class="sxs-lookup"><span data-stu-id="7f751-183">If a tool must manage a process tree that uses job objects and it is not possible to use nested jobs, both the tool and the members of the process tree must cooperate.</span></span> <span data-ttu-id="7f751-184">Utilisez l’une des options suivantes :</span><span class="sxs-lookup"><span data-stu-id="7f751-184">Use one of the following options:</span></span>

-   <span data-ttu-id="7f751-185">Utilisez la limite de la \_ \_ dissociation silencieuse limite de l’objet de traitement \_ \_ \_ OK.</span><span class="sxs-lookup"><span data-stu-id="7f751-185">Use the JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="7f751-186">Si l’outil utilise cette limite, il ne peut pas surveiller l’intégralité de l’arborescence d’un processus.</span><span class="sxs-lookup"><span data-stu-id="7f751-186">If the tool uses this limit, it cannot monitor an entire process tree.</span></span> <span data-ttu-id="7f751-187">L’outil peut surveiller uniquement les processus qu’il ajoute au travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-187">The tool can monitor only the processes it adds to the job.</span></span> <span data-ttu-id="7f751-188">Si ces processus créent des processus enfants, ils ne sont pas associés au travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-188">If these processes create child processes, they are not associated with the job.</span></span> <span data-ttu-id="7f751-189">Dans cette option, les processus enfants peuvent être associés à d’autres objets de travail.</span><span class="sxs-lookup"><span data-stu-id="7f751-189">In this option, child processes can be associated with other job objects.</span></span>
-   <span data-ttu-id="7f751-190">Utilisez la limite de limite d’objet de traitement \_ \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="7f751-190">Use the JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="7f751-191">Si l’outil utilise cette limite, il peut surveiller l’intégralité de l’arborescence des processus, à l’exception des processus qu’un membre de l’arborescence sépare explicitement de l’arborescence.</span><span class="sxs-lookup"><span data-stu-id="7f751-191">If the tool uses this limit, it can monitor the entire process tree, except for those processes that any member of the tree explicitly breaks away from the tree.</span></span> <span data-ttu-id="7f751-192">Un membre de l’arborescence peut créer un processus enfant dans un nouvel objet de traitement en appelant la fonction [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) avec l' \_ indicateur Create dissociation \_ from \_ Job, puis en appelant la fonction [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) .</span><span class="sxs-lookup"><span data-stu-id="7f751-192">A member of the tree can create a child process in a new job object by calling the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function with the CREATE\_BREAKAWAY\_FROM\_JOB flag, then calling the [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) function.</span></span> <span data-ttu-id="7f751-193">Dans le cas contraire, le membre doit gérer les cas dans lesquels **AssignProcessToJobObject** échoue.</span><span class="sxs-lookup"><span data-stu-id="7f751-193">Otherwise, the member must handle cases in which **AssignProcessToJobObject** fails.</span></span>

    <span data-ttu-id="7f751-194">L’indicateur CREATe \_ dissociation \_ from \_ Job n’a aucun effet si l’arborescence n’est pas surveillée par l’outil.</span><span class="sxs-lookup"><span data-stu-id="7f751-194">The CREATE\_BREAKAWAY\_FROM\_JOB flag has no effect if the tree is not being monitored by the tool.</span></span> <span data-ttu-id="7f751-195">Par conséquent, il s’agit de l’option par défaut, mais elle nécessite une connaissance approfondie des processus surveillés.</span><span class="sxs-lookup"><span data-stu-id="7f751-195">Therefore, this is the preferred option, but it requires advance knowledge of the processes being monitored.</span></span>

-   <span data-ttu-id="7f751-196">Évitez les dissociations de tout type en ne définissant ni la limite d’objets de tâche \_ \_ OK, ni la limite de \_ \_ \_ \_ \_ \_ dissociation silencieuse \_ de limite d’objet de traitement.</span><span class="sxs-lookup"><span data-stu-id="7f751-196">Prevent breakaways of any kind by setting neither the JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK nor the JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="7f751-197">Dans cette option, l’outil peut surveiller l’intégralité de l’arborescence des processus.</span><span class="sxs-lookup"><span data-stu-id="7f751-197">In this option, the tool can monitor the entire process tree.</span></span> <span data-ttu-id="7f751-198">Toutefois, si un processus enfant tente de s’associer lui-même ou un autre processus enfant à un travail en appelant [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject), l’appel échoue.</span><span class="sxs-lookup"><span data-stu-id="7f751-198">However, if a child process attempts to associate itself or another child process with a job by calling [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject), the call will fail.</span></span> <span data-ttu-id="7f751-199">Si le processus a été conçu pour être associé à un travail spécifique, cet échec peut empêcher le processus de fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="7f751-199">If the process was designed to be associated with a specific job, this failure may prevent the process from working properly.</span></span>

 

 
