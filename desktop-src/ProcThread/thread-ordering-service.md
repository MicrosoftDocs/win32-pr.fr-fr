---
description: Le service de classement des threads contrôle l’exécution d’un ou plusieurs threads clients. Il garantit que chaque thread client s’exécute une fois pendant la période spécifiée et dans l’ordre relatif.
ms.assetid: 5c37873a-ced4-447e-a6e1-55cfa8ab24b4
title: Service de classement des threads
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72b3cd12b26124b47d506585425388a4542a70df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106527887"
---
# <a name="thread-ordering-service"></a><span data-ttu-id="ebbec-104">Service de classement des threads</span><span class="sxs-lookup"><span data-stu-id="ebbec-104">Thread Ordering Service</span></span>

<span data-ttu-id="ebbec-105">Le *service de classement des threads* contrôle l’exécution d’un ou plusieurs threads clients.</span><span class="sxs-lookup"><span data-stu-id="ebbec-105">The *thread ordering service* controls the execution of one or more client threads.</span></span> <span data-ttu-id="ebbec-106">Il garantit que chaque thread client s’exécute une fois pendant la période spécifiée et dans l’ordre relatif.</span><span class="sxs-lookup"><span data-stu-id="ebbec-106">It ensures that each client thread runs once during the specified period and in relative order.</span></span>

<span data-ttu-id="ebbec-107">**Windows Server 2003 et Windows XP :** Le service de classement des threads est disponible à partir de Windows Vista et de Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ebbec-107">**Windows Server 2003 and Windows XP:** The thread ordering service is available starting with Windows Vista and Windows Server 2008.</span></span>

<span data-ttu-id="ebbec-108">Le service de classement des threads est désactivé par défaut et doit être démarré par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebbec-108">The thread ordering service is off by default and must be started by the user.</span></span> <span data-ttu-id="ebbec-109">Pendant que le service de classement des threads est en cours d’exécution, il est activé toutes les 5 secondes pour vérifier s’il existe une nouvelle demande, même si le système est inactif.</span><span class="sxs-lookup"><span data-stu-id="ebbec-109">While the thread ordering service is running, it is activated every 5 seconds to check whether there is a new request, even if the system is idle.</span></span> <span data-ttu-id="ebbec-110">Cela empêche le système de se mettre en veille pendant plus de 5 secondes, ce qui a pour effet de consommer davantage d’énergie.</span><span class="sxs-lookup"><span data-stu-id="ebbec-110">This prevents the system from sleeping for longer than 5 seconds, causing the system to consume more power.</span></span> <span data-ttu-id="ebbec-111">Si l’efficacité énergétique est essentielle pour l’application, il est préférable de ne pas utiliser le service de classement des threads et d’autoriser à la place le planificateur système à gérer l’exécution des threads.</span><span class="sxs-lookup"><span data-stu-id="ebbec-111">If energy efficiency is critical to the application, it is better not to use the thread ordering service and instead allow the system scheduler to manage execution of threads.</span></span>

<span data-ttu-id="ebbec-112">Chaque thread client appartient à un *groupe d’ordonnancement des threads*.</span><span class="sxs-lookup"><span data-stu-id="ebbec-112">Each client thread belongs to a *thread ordering group*.</span></span> <span data-ttu-id="ebbec-113">Le *thread parent* crée un ou plusieurs groupes d’ordonnancement de thread en appelant la fonction [**AvRtCreateThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtcreatethreadorderinggroup) .</span><span class="sxs-lookup"><span data-stu-id="ebbec-113">The *parent thread* creates one or more thread ordering groups by calling the [**AvRtCreateThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtcreatethreadorderinggroup) function.</span></span> <span data-ttu-id="ebbec-114">Le thread parent utilise cette fonction pour spécifier la période pour le groupe d’ordonnancement de thread et un intervalle de délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="ebbec-114">The parent thread uses this function to specify the period for the thread ordering group and a time-out interval.</span></span>

<span data-ttu-id="ebbec-115">Des threads clients supplémentaires appellent la fonction [**AvRtJoinThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtjointhreadorderinggroup) pour joindre un groupe d’ordonnancement de thread existant.</span><span class="sxs-lookup"><span data-stu-id="ebbec-115">Additional client threads call the [**AvRtJoinThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtjointhreadorderinggroup) function to join an existing thread ordering group.</span></span> <span data-ttu-id="ebbec-116">Ces threads indiquent s’ils doivent être un prédécesseur ou un successeur du thread parent dans l’ordre d’exécution.</span><span class="sxs-lookup"><span data-stu-id="ebbec-116">These threads indicate whether they are to be a predecessor or successor to the parent thread in the execution order.</span></span> <span data-ttu-id="ebbec-117">Chaque thread client est censé effectuer une certaine quantité de traitement chaque période.</span><span class="sxs-lookup"><span data-stu-id="ebbec-117">Each client thread is expected to complete a certain amount of processing each period.</span></span> <span data-ttu-id="ebbec-118">Tous les threads du groupe doivent exécuter leur exécution dans la période plus l’intervalle de délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="ebbec-118">All threads within the group should complete their execution within the period plus the time-out interval.</span></span>

<span data-ttu-id="ebbec-119">Les threads d’un groupe d’ordonnancement de threads encadrent leur code de traitement dans une boucle contrôlée par la fonction [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) .</span><span class="sxs-lookup"><span data-stu-id="ebbec-119">The threads of a thread ordering group enclose their processing code within a loop that is controlled by the [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) function.</span></span> <span data-ttu-id="ebbec-120">Tout d’abord, les threads prédécesseurs sont exécutés un par un, dans l’ordre dans lequel ils ont rejoint le groupe, tandis que les threads parents et successeurs sont bloqués lors de leurs appels à **AvRtWaitOnThreadOrderingGroup**.</span><span class="sxs-lookup"><span data-stu-id="ebbec-120">First, the predecessor threads are executed one at a time in the order that they joined the group, while the parent and successor threads are blocked on their calls to **AvRtWaitOnThreadOrderingGroup**.</span></span> <span data-ttu-id="ebbec-121">Lorsque chaque thread prédécesseur a fini son traitement, le contrôle de l’exécution retourne au sommet de sa boucle de traitement et le thread appelle à nouveau **AvRtWaitOnThreadOrderingGroup** pour se bloquer jusqu’à son tour suivant.</span><span class="sxs-lookup"><span data-stu-id="ebbec-121">When each predecessor thread is finished with its processing, control of execution returns to the top of its processing loop and the thread calls **AvRtWaitOnThreadOrderingGroup** again to block until its next turn.</span></span> <span data-ttu-id="ebbec-122">Une fois que tous les threads précédents ont appelé cette fonction, le service de classement des threads peut planifier le thread parent.</span><span class="sxs-lookup"><span data-stu-id="ebbec-122">After all predecessor threads have called this function, the thread ordering service can schedule the parent thread.</span></span> <span data-ttu-id="ebbec-123">Enfin, lorsque le thread parent termine son traitement et appelle à nouveau **AvRtWaitOnThreadOrderingGroup** , le service de classement des threads peut planifier les threads successeurs un par un dans l’ordre dans lequel ils ont rejoint le groupe.</span><span class="sxs-lookup"><span data-stu-id="ebbec-123">Finally, when the parent thread finishes its processing and calls **AvRtWaitOnThreadOrderingGroup** again, the thread ordering service can schedule the successor threads one at a time in the order that they joined the group.</span></span> <span data-ttu-id="ebbec-124">Si tous les threads terminent leur exécution avant la fin d’une période, tous les threads attendent jusqu’à ce que le reste de la période s’arrête avant que les autres soient exécutés à nouveau.</span><span class="sxs-lookup"><span data-stu-id="ebbec-124">If all threads complete their execution before a period ends, all threads wait until the remainder of the period elapses before any are executed again.</span></span>

<span data-ttu-id="ebbec-125">Lorsque le client n’a plus besoin de s’exécuter dans le cadre du groupe d’ordonnancement des threads, il appelle la fonction [**AvRtLeaveThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtleavethreadorderinggroup) pour se supprimer du groupe.</span><span class="sxs-lookup"><span data-stu-id="ebbec-125">When the client need no longer run as part of the thread ordering group, it calls the [**AvRtLeaveThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtleavethreadorderinggroup) function to remove itself from the group.</span></span> <span data-ttu-id="ebbec-126">Notez que le thread parent ne doit pas se supprimer lui-même d’un groupe d’ordonnancement des threads.</span><span class="sxs-lookup"><span data-stu-id="ebbec-126">Note that the parent thread should not remove itself from a thread ordering group.</span></span> <span data-ttu-id="ebbec-127">Si un thread ne termine pas son exécution avant que le délai n’expire, il est supprimé du groupe.</span><span class="sxs-lookup"><span data-stu-id="ebbec-127">If a thread does not complete its execution before the period plus the time-out interval elapses, then it is deleted from the group.</span></span>

<span data-ttu-id="ebbec-128">Le thread parent appelle la fonction [**AvRtDeleteThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtdeletethreadorderinggroup) pour supprimer le groupe d’ordonnancement des threads.</span><span class="sxs-lookup"><span data-stu-id="ebbec-128">The parent thread calls the [**AvRtDeleteThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtdeletethreadorderinggroup) function to delete the thread ordering group.</span></span> <span data-ttu-id="ebbec-129">Le groupe d’ordonnancement des threads est également détruit si le thread parent n’effectue pas son exécution avant le délai écoulé.</span><span class="sxs-lookup"><span data-stu-id="ebbec-129">The thread ordering group is also destroyed if the parent thread does not complete its execution before the period plus the time-out interval elapses.</span></span> <span data-ttu-id="ebbec-130">Lorsque le groupe d’ordonnancement des threads est détruit, tous les appels à [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) à partir de threads de ce groupe échouent ou expirent.</span><span class="sxs-lookup"><span data-stu-id="ebbec-130">When the thread ordering group is destroyed, any calls to [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) from threads of that group fail or time out.</span></span>

 

 



