---
description: Cette rubrique n’est pas à jour. Pour obtenir les informations les plus récentes, consultez la spécification du schéma d’impression.
ms.assetid: 296255b8-fe5c-46dd-b717-487aaae0db80
title: Gestion des couleurs et schéma d’impression
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 134a598466fd52c66d632a28c750840d4123f529
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/05/2021
ms.locfileid: "103869653"
---
# <a name="color-management-and-the-print-schema"></a><span data-ttu-id="5c741-104">Gestion des couleurs et schéma d’impression</span><span class="sxs-lookup"><span data-stu-id="5c741-104">Color Management and the Print Schema</span></span>

<span data-ttu-id="5c741-105">Cette rubrique n’est pas à jour.</span><span class="sxs-lookup"><span data-stu-id="5c741-105">This topic is not current.</span></span> <span data-ttu-id="5c741-106">Pour obtenir les informations les plus récentes, consultez la [spécification du schéma d’impression](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span><span class="sxs-lookup"><span data-stu-id="5c741-106">For the most current information, see the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="5c741-107">Les mots clés d’éléments configurables par l’utilisateur peuvent être spécifiques au XPS ou non à XPS.</span><span class="sxs-lookup"><span data-stu-id="5c741-107">User Configurable Element keywords may either be XPS specific or non-XPS specific.</span></span> <span data-ttu-id="5c741-108">Dans le cas où elles ne sont pas spécifiques à XPS, le mot clé peut être utilisé pour l’impression héritée basée sur GDI.</span><span class="sxs-lookup"><span data-stu-id="5c741-108">In the case where they are not XPS specific, the keyword may be used for Legacy GDI-based printing.</span></span> <span data-ttu-id="5c741-109">Si une application décide de définir ces mots clés dans un PrintTicket, il revient au pilote de déterminer l’action et le comportement appropriés à prendre en fonction des définitions présentées dans le schéma d’impression.</span><span class="sxs-lookup"><span data-stu-id="5c741-109">If an application decides to set these keywords in a PrintTicket, it is up to the driver to determine the proper action and behavior to take based on the definitions presented in the Print Schema.</span></span> <span data-ttu-id="5c741-110">L’un de ces mots clés peut être utilisé dans le contexte d’ICM.</span><span class="sxs-lookup"><span data-stu-id="5c741-110">Any of these keywords may be used in the context of ICM.</span></span> <span data-ttu-id="5c741-111">Pour plus d’informations, consultez le kit de développement logiciel (SDK) Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="5c741-111">For more information, please see the Windows Vista SDK.</span></span>



| <span data-ttu-id="5c741-112">Schéma d’impression-mot clé configurable utilisateur</span><span class="sxs-lookup"><span data-stu-id="5c741-112">Print Schema User Configurable Keyword</span></span>       | <span data-ttu-id="5c741-113">Équivalent DEVMODE</span><span class="sxs-lookup"><span data-stu-id="5c741-113">DEVMODE Equivalent</span></span>     | <span data-ttu-id="5c741-114">Spécifique à XPS</span><span class="sxs-lookup"><span data-stu-id="5c741-114">XPS Specific</span></span>   |
|----------------------------------------------|------------------------|----------------|
| <span data-ttu-id="5c741-115">PageColorManagement</span><span class="sxs-lookup"><span data-stu-id="5c741-115">PageColorManagement</span></span><br/>               | <span data-ttu-id="5c741-116">dmICMMethod</span><span class="sxs-lookup"><span data-stu-id="5c741-116">dmICMMethod</span></span><br/> | <span data-ttu-id="5c741-117">Non</span><span class="sxs-lookup"><span data-stu-id="5c741-117">No</span></span><br/>  |
| <span data-ttu-id="5c741-118">PageBlackGenerationProcessing</span><span class="sxs-lookup"><span data-stu-id="5c741-118">PageBlackGenerationProcessing</span></span><br/>     | <span data-ttu-id="5c741-119">Aucun</span><span class="sxs-lookup"><span data-stu-id="5c741-119">None</span></span><br/>        | <span data-ttu-id="5c741-120">Oui</span><span class="sxs-lookup"><span data-stu-id="5c741-120">Yes</span></span><br/> |
| <span data-ttu-id="5c741-121">PageBlendColorSpace</span><span class="sxs-lookup"><span data-stu-id="5c741-121">PageBlendColorSpace</span></span><br/>               | <span data-ttu-id="5c741-122">Aucun</span><span class="sxs-lookup"><span data-stu-id="5c741-122">None</span></span><br/>        | <span data-ttu-id="5c741-123">Oui</span><span class="sxs-lookup"><span data-stu-id="5c741-123">Yes</span></span><br/> |
| <span data-ttu-id="5c741-124">PageSourceColorProfile</span><span class="sxs-lookup"><span data-stu-id="5c741-124">PageSourceColorProfile</span></span><br/>            | <span data-ttu-id="5c741-125">Aucun</span><span class="sxs-lookup"><span data-stu-id="5c741-125">None</span></span><br/>        | <span data-ttu-id="5c741-126">Non</span><span class="sxs-lookup"><span data-stu-id="5c741-126">No</span></span><br/>  |
| <span data-ttu-id="5c741-127">PageDestinationColorProfile</span><span class="sxs-lookup"><span data-stu-id="5c741-127">PageDestinationColorProfile</span></span><br/>       | <span data-ttu-id="5c741-128">Aucun</span><span class="sxs-lookup"><span data-stu-id="5c741-128">None</span></span><br/>        | <span data-ttu-id="5c741-129">Non</span><span class="sxs-lookup"><span data-stu-id="5c741-129">No</span></span><br/>  |
| <span data-ttu-id="5c741-130">PageICMRenderingIntent</span><span class="sxs-lookup"><span data-stu-id="5c741-130">PageICMRenderingIntent</span></span><br/>            | <span data-ttu-id="5c741-131">dmICMIntent</span><span class="sxs-lookup"><span data-stu-id="5c741-131">dmICMIntent</span></span><br/> | <span data-ttu-id="5c741-132">Non</span><span class="sxs-lookup"><span data-stu-id="5c741-132">No</span></span><br/>  |
| <span data-ttu-id="5c741-133">JobOptimalDestinationColorProfile</span><span class="sxs-lookup"><span data-stu-id="5c741-133">JobOptimalDestinationColorProfile</span></span><br/> | <span data-ttu-id="5c741-134">Aucun</span><span class="sxs-lookup"><span data-stu-id="5c741-134">None</span></span><br/>        | <span data-ttu-id="5c741-135">Non</span><span class="sxs-lookup"><span data-stu-id="5c741-135">No</span></span><br/>  |
| <span data-ttu-id="5c741-136">PageDeviceColorSpaceUsage</span><span class="sxs-lookup"><span data-stu-id="5c741-136">PageDeviceColorSpaceUsage</span></span><br/>         | <span data-ttu-id="5c741-137">Aucun</span><span class="sxs-lookup"><span data-stu-id="5c741-137">None</span></span><br/>        | <span data-ttu-id="5c741-138">Oui</span><span class="sxs-lookup"><span data-stu-id="5c741-138">Yes</span></span><br/> |



 

## <a name="pagecolormanagement-system-handling"></a><span data-ttu-id="5c741-139">Gestion du système PageColorManagement</span><span class="sxs-lookup"><span data-stu-id="5c741-139">PageColorManagement System Handling</span></span>

<span data-ttu-id="5c741-140">Pour PageColorManagement, le système assure la gestion automatique de PrintTicket à DEVMODE ou DEVMODE à la conversion PrintTicket, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="5c741-140">For PageColorManagement, the system provides automatic handling of PrintTicket to DEVMODE or DEVMODE to PrintTicket conversion if necessary.</span></span> <span data-ttu-id="5c741-141">Cela dépend du chemin d’impression spécifique entre l’application (Win32 ou WPF) et le pilote (GDI ou XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="5c741-141">This depends on the specific print path between the application (Win32 or WPF)and the driver (GDI-based or XPSDrv).</span></span> <span data-ttu-id="5c741-142">Dans le cas d’une impression à partir d’une application Windows Presentation Foundation sur un pilote d’impression Microsoft XPSDrv, une option publique PageColorManagement du système ne doit pas être publiée dans le document PrintTicket ou PrintCapabilities. dans ce cas, la gestion des couleurs ne peut pas être gérée automatiquement par le système.</span><span class="sxs-lookup"><span data-stu-id="5c741-142">In the case of printing from a Windows Presentation Foundation application to a Microsoft XPSDrv print driver, a PageColorManagement public option of System SHOULD NOT be advertised in either the PrintTicket or PrintCapabilities document; in this case, color management cannot be handled automatically by the system.</span></span> <span data-ttu-id="5c741-143">L’impression à partir d’une application Win32 sur un pilote d’impression Microsoft XPSDrv peut entraîner la gestion des couleurs entre l’application et GDI, toutefois, après la conversion au format XPS, il n’y aura pas de traitement automatique du système de gestion des couleurs entre le document XPS et le pilote et/ou le périphérique, car le format XPS-met en forme chaque élément avec des informations de couleur complètes, et il appartient au pilote ou à l’appareil de traiter ces informations.</span><span class="sxs-lookup"><span data-stu-id="5c741-143">Printing from a Win32 application to a Microsoft XPSDrv print driver may result in color management between the application and GDI, however after conversion to XPS-format, there will be no automatic system handling of color management between the XPS document and the driver and/or device, because the XPS-format tags each element with complete color information, and it is up to the driver or the device to process this information.</span></span>



| <span data-ttu-id="5c741-144">Options publiques PageColorManagement</span><span class="sxs-lookup"><span data-stu-id="5c741-144">PageColorManagement Public Options</span></span> | <span data-ttu-id="5c741-145">Valeur DEVMODE</span><span class="sxs-lookup"><span data-stu-id="5c741-145">DEVMODE Value</span></span>                  |
|------------------------------------|--------------------------------|
| <span data-ttu-id="5c741-146">Aucun</span><span class="sxs-lookup"><span data-stu-id="5c741-146">None</span></span><br/>                    | <span data-ttu-id="5c741-147">DMICMMETHOD \_ aucun</span><span class="sxs-lookup"><span data-stu-id="5c741-147">DMICMMETHOD\_NONE</span></span><br/>   |
| <span data-ttu-id="5c741-148">Appareil</span><span class="sxs-lookup"><span data-stu-id="5c741-148">Device</span></span><br/>                  | <span data-ttu-id="5c741-149">\_appareil DMICMMETHOD</span><span class="sxs-lookup"><span data-stu-id="5c741-149">DMICMMETHOD\_DEVICE</span></span><br/> |
| <span data-ttu-id="5c741-150">Pilote</span><span class="sxs-lookup"><span data-stu-id="5c741-150">Driver</span></span><br/>                  | <span data-ttu-id="5c741-151">\_pilote DMICMMETHOD</span><span class="sxs-lookup"><span data-stu-id="5c741-151">DMICMMETHOD\_DRIVER</span></span><br/> |
| <span data-ttu-id="5c741-152">Système</span><span class="sxs-lookup"><span data-stu-id="5c741-152">System</span></span><br/>                  | <span data-ttu-id="5c741-153">\_système DMICMMETHOD</span><span class="sxs-lookup"><span data-stu-id="5c741-153">DMICMMETHOD\_SYSTEM</span></span><br/> |



 

## <a name="pageicmrenderingintent-system-handling"></a><span data-ttu-id="5c741-154">Gestion du système PageICMRenderingIntent</span><span class="sxs-lookup"><span data-stu-id="5c741-154">PageICMRenderingIntent System Handling</span></span>

<span data-ttu-id="5c741-155">Pour PageICMRenderingIntent, le système assure la gestion automatique de PrintTicket à DEVMODE ou DEVMODE à la conversion PrintTicket, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="5c741-155">For PageICMRenderingIntent, the system provides automatic handling of PrintTicket to DEVMODE or DEVMODE to PrintTicket conversion if necessary.</span></span> <span data-ttu-id="5c741-156">Cela dépend du chemin d’impression spécifique entre l’application (Win32 ou Windows Presentation Foundation) et le pilote (GDI ou XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="5c741-156">This depends on the specific print path between the application (Win32 or Windows Presentation Foundation) and the driver (GDI-based or XPSDrv).</span></span>



| <span data-ttu-id="5c741-157">Options publiques PageICMRenderingIntent</span><span class="sxs-lookup"><span data-stu-id="5c741-157">PageICMRenderingIntent Public Options</span></span> | <span data-ttu-id="5c741-158">Valeur DEVMODE</span><span class="sxs-lookup"><span data-stu-id="5c741-158">DEVMODE Value</span></span>                       |
|---------------------------------------|-------------------------------------|
| <span data-ttu-id="5c741-159">AbsoluteColorimetric</span><span class="sxs-lookup"><span data-stu-id="5c741-159">AbsoluteColorimetric</span></span><br/>       | <span data-ttu-id="5c741-160">\_COLORIMÉTRIE DMICM ABS \_</span><span class="sxs-lookup"><span data-stu-id="5c741-160">DMICM\_ABS\_COLORIMETRIC</span></span><br/> |
| <span data-ttu-id="5c741-161">RelativeColorimetric</span><span class="sxs-lookup"><span data-stu-id="5c741-161">RelativeColorimetric</span></span><br/>       | <span data-ttu-id="5c741-162">\_COLORIMÉTRIE DMICM</span><span class="sxs-lookup"><span data-stu-id="5c741-162">DMICM\_COLORIMETRIC</span></span><br/>      |
| <span data-ttu-id="5c741-163">Photos</span><span class="sxs-lookup"><span data-stu-id="5c741-163">Photographs</span></span><br/>                | <span data-ttu-id="5c741-164">\_contraste DMICM</span><span class="sxs-lookup"><span data-stu-id="5c741-164">DMICM\_CONTRAST</span></span><br/>          |
| <span data-ttu-id="5c741-165">BusinessGraphics</span><span class="sxs-lookup"><span data-stu-id="5c741-165">BusinessGraphics</span></span><br/>           | <span data-ttu-id="5c741-166">\_saturation DMICM</span><span class="sxs-lookup"><span data-stu-id="5c741-166">DMICM\_SATURATE</span></span><br/>          |



 

<span data-ttu-id="5c741-167">Tous les autres mots clés liés à la gestion des couleurs (autres que PageColorManagement ou PageICMRenderingIntent) ne disposent pas de ce type de gestion automatique.</span><span class="sxs-lookup"><span data-stu-id="5c741-167">All other Color Management related keywords (besides PageColorManagement or PageICMRenderingIntent) do not have such automatic handling.</span></span>

## <a name="joboptimaldestinationcolorprofile-and-pagedestinationcolorprofile-usage"></a><span data-ttu-id="5c741-168">Utilisation de JobOptimalDestinationColorProfile et de PageDestinationColorProfile</span><span class="sxs-lookup"><span data-stu-id="5c741-168">JobOptimalDestinationColorProfile and PageDestinationColorProfile Usage</span></span>

<span data-ttu-id="5c741-169">Une application peut décider d’interroger le document PrintCapabilities pour JobOptimalDestinationColorProfile.</span><span class="sxs-lookup"><span data-stu-id="5c741-169">An application MAY decide to query PrintCapabilities document for JobOptimalDestinationColorProfile.</span></span> <span data-ttu-id="5c741-170">Cela peut permettre à une application d’obtenir le profil de couleurs optimal en fonction de la configuration actuelle de l’appareil, tel que défini dans le document PrintCapabilities.</span><span class="sxs-lookup"><span data-stu-id="5c741-170">This could give an application the optimal color profile given the current device configuration as defined in the PrintCapabilities document.</span></span> <span data-ttu-id="5c741-171">Si l’application décide qu’elle souhaiterait que le pilote effectue la gestion des couleurs sur le profil de couleurs de destination spécifié par JobOptimalDestinationColorProfile, PageColorManagement et PageDestinationColorProfile sont respectivement définis sur Driver et DriverConfiguration dans PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="5c741-171">If the application decides it would like the driver to perform color management to the destination color profile specified by JobOptimalDestinationColorProfile, then PageColorManagement and PageDestinationColorProfile would be set to Driver and DriverConfiguration in the PrintTicket respectively.</span></span> <span data-ttu-id="5c741-172">Si l’application ne souhaite pas utiliser le JobOptionalDestinationColorProfile et choisit d’utiliser sa propre valeur, elle doit définir PageColorManagement sur None et définir PageDestinationColorProfile sur application dans PrintTicket pour indiquer que l’application a déjà effectué la gestion des couleurs à son profil de couleurs de destination spécifié.</span><span class="sxs-lookup"><span data-stu-id="5c741-172">If the application does not want to use the JobOptionalDestinationColorProfile and chooses to use its own, it SHOULD set PageColorManagement to None and also set the PageDestinationColorProfile to Application in the PrintTicket to convey that the application has already performed color management to its specified destination color profile.</span></span> <span data-ttu-id="5c741-173">Un autre scénario peut se produire lorsque l’application choisit d’utiliser le profil de couleur de destination optimal renvoyé par les pilotes PrintCapabilities, mais décide de procéder à la gestion des couleurs.</span><span class="sxs-lookup"><span data-stu-id="5c741-173">Another scenario may occur when the application chooses to use the optimal destination color profile returned by the drivers PrintCapabilities but decides to do color management on its own.</span></span> <span data-ttu-id="5c741-174">Dans ce cas, PageColorManagement est défini sur None et PageDestinationColorProfile est défini sur application.</span><span class="sxs-lookup"><span data-stu-id="5c741-174">In this case, PageColorManagement would be set to None and PageDestinationColorProfile would be set to Application.</span></span>

## <a name="pagesourcecolorprofile-usage"></a><span data-ttu-id="5c741-175">Utilisation de PageSourceColorProfile</span><span class="sxs-lookup"><span data-stu-id="5c741-175">PageSourceColorProfile Usage</span></span>

<span data-ttu-id="5c741-176">Pour PageSourceColorProfile, une application peut spécifier un profil de couleurs source pour chaque page dans le PrintTicket, quelle que soit l’option sélectionnée pour PageColorManagement.</span><span class="sxs-lookup"><span data-stu-id="5c741-176">For PageSourceColorProfile, an application MAY specify a source color profile for each page in the PrintTicket, regardless of the option selected for PageColorManagement.</span></span> <span data-ttu-id="5c741-177">Qu’il soit présent ou non, il revient au pilote de déterminer le comportement de chaque cas en fonction des définitions présentées dans le schéma d’impression.</span><span class="sxs-lookup"><span data-stu-id="5c741-177">Whether it is present or not, it is up to the driver to decide the behavior for each case based on the definitions presented in the Print Schema.</span></span> <span data-ttu-id="5c741-178">Par exemple, une application peut affecter la valeur None à PageColorManagement, puis ne pas définir PageSourceColorProfile dans PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="5c741-178">For example, an application may set PageColorManagement to None, and then not set PageSourceColorProfile in the PrintTicket.</span></span> <span data-ttu-id="5c741-179">Il est également possible pour une application de définir PageColorManagement sur Driver, puis de définir PageSourceColorProfile dans PrintTicket. dans ce cas, le pilote est chargé de déterminer le comportement dans les instructions du PrintSchema.</span><span class="sxs-lookup"><span data-stu-id="5c741-179">It is also possible for an application to set PageColorManagement to Driver, and then set PageSourceColorProfile in the PrintTicket; the driver in this case is responsible for determining the behavior within the guidelines of the PrintSchema.</span></span>

## <a name="pagedevicecolorspaceusage"></a><span data-ttu-id="5c741-180">PageDeviceColorSpaceUsage</span><span class="sxs-lookup"><span data-stu-id="5c741-180">PageDeviceColorSpaceUsage</span></span>

<span data-ttu-id="5c741-181">PageDeviceColorSpaceUsage est un élément configurable par l’utilisateur spécifique à XPS défini par l’application.</span><span class="sxs-lookup"><span data-stu-id="5c741-181">PageDeviceColorSpaceUsage is an XPS specific user configurable element that is set by the application.</span></span> <span data-ttu-id="5c741-182">Il fournit des instructions pour l’appareil en définissant l’option appropriée dans PrintTicket, pour la gestion des profils d’espace colorimétrique associés dans un document XPS.</span><span class="sxs-lookup"><span data-stu-id="5c741-182">It provides instructions for the device by setting the appropriate option in the PrintTicket, for color space profile handling associated within an XPS document.</span></span> <span data-ttu-id="5c741-183">L’application et/ou le PrintTicket existant peut spécifier ce mot clé dans un PrintTicket envoyé à l’appareil.</span><span class="sxs-lookup"><span data-stu-id="5c741-183">The application and/or existing PrintTicket MAY specify this keyword in a PrintTicket sent to the device.</span></span> <span data-ttu-id="5c741-184">Qu’il soit présent ou non, il revient au pilote de déterminer le comportement de chaque cas, en fonction des définitions présentées dans le schéma d’impression.</span><span class="sxs-lookup"><span data-stu-id="5c741-184">Whether it is present or not, it is up to the driver to decide the behavior for each case, based on the definitions presented in the Print Schema.</span></span>

## <a name="print-schema-color-management-example-flow"></a><span data-ttu-id="5c741-185">Exemple de workflow de gestion des couleurs du schéma d’impression</span><span class="sxs-lookup"><span data-stu-id="5c741-185">Print Schema Color Management Example Flow</span></span>

<span data-ttu-id="5c741-186">Le diagramme suivant illustre le déroulement des scénarios les plus probables pour l’utilisation de la gestion des couleurs et du schéma d’impression.</span><span class="sxs-lookup"><span data-stu-id="5c741-186">The following diagram illustrates flow for the most likely scenarios for using Color Management and the Print Schema.</span></span> <span data-ttu-id="5c741-187">Pour des raisons de simplicité et de lisibilité, seuls les mots clés de schéma d’impression configurables suivants ont été utilisés pour illustrer leur utilisation : PageColorManagement, JobOptimalDestinaionColorProfile, PageSourceColorProfile et PageDestinationColorProfile.</span><span class="sxs-lookup"><span data-stu-id="5c741-187">For simplicity and readability, only the following user configurable Print Schema keywords were used to demonstrate their usage: PageColorManagement, JobOptimalDestinaionColorProfile, PageSourceColorProfile, and PageDestinationColorProfile.</span></span> <span data-ttu-id="5c741-188">Une ligne pleine représente une action qui doit se produire et une ligne en pointillés représente une action qui peut se produire.</span><span class="sxs-lookup"><span data-stu-id="5c741-188">A solid line represents an action that SHOULD occur and a dashed line represents an action that MAY occur.</span></span> <span data-ttu-id="5c741-189">Le scénario suivant n’est pas l’interaction garantie qui se traduira par l’application, le pilote et le système. Toutefois, il représente le cas d’utilisation le plus courant.</span><span class="sxs-lookup"><span data-stu-id="5c741-189">The following scenario is not the guaranteed interaction that will result between the application, driver, and system, however, it represents the most common usage case that will occur.</span></span>

![diagramme qui montre comment les paramètres de gestion des couleurs sont traités](images/local-1992284846-colormanagementtest3.png)

## <a name="related-topics"></a><span data-ttu-id="5c741-191">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="5c741-191">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5c741-192">Spécification du schéma d’impression</span><span class="sxs-lookup"><span data-stu-id="5c741-192">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> </dl>

 

 




