---
description: L’interface IXpsOMPackageWriter crée un fichier de document XPS dans lequel les applications peuvent écrire le contenu des interfaces IXpsOMPage d’un modèle OM XPS.
ms.assetid: eff1ab1e-2205-4f5c-9e32-199e073f5dbf
title: Utilisation de l’interface IXpsOMPackageWriter
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1e8a34a0538ff09cc050ac287d5314be93f0da8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106528316"
---
# <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="f7a57-103">Utilisation de l’interface IXpsOMPackageWriter</span><span class="sxs-lookup"><span data-stu-id="f7a57-103">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="f7a57-104">L’interface [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) crée un fichier de document XPS dans lequel les applications peuvent écrire le contenu des interfaces [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) d’un modèle OM XPS.</span><span class="sxs-lookup"><span data-stu-id="f7a57-104">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an XPS document file into which applications can write the contents of the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interfaces of an XPS OM.</span></span> <span data-ttu-id="f7a57-105">L’interface [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) est particulièrement utile lorsque le contenu du document est traité ou créé de manière séquentielle.</span><span class="sxs-lookup"><span data-stu-id="f7a57-105">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface is most useful when document contents are being processed or created sequentially.</span></span> <span data-ttu-id="f7a57-106">Contrairement aux méthodes [**WritetoFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) et [**WriteToStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) de l’interface [**IXpsOMPackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) , pour que l’interface **IXpsOMPackageWriter** soit utilisée, l’intégralité du FixedDocument et du FixedDocumentSequence ne doit pas être terminée.</span><span class="sxs-lookup"><span data-stu-id="f7a57-106">Unlike the [**WriteToFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) and [**WriteToStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) methods of the [**IXpsOMPackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) interface, for the **IXpsOMPackageWriter** interface to be used neither the entire FixedDocument nor the FixedDocumentSequence has to be finished.</span></span>

## <a name="overview"></a><span data-ttu-id="f7a57-107">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="f7a57-107">Overview</span></span>

<span data-ttu-id="f7a57-108">L’interface [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) écrit une page à la fois, de la première page d’un document XPS au dernier.</span><span class="sxs-lookup"><span data-stu-id="f7a57-108">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface writes one page at a time, from the first page of an XPS document to the last.</span></span> <span data-ttu-id="f7a57-109">L’interface peut être utilisée pour créer des fichiers de document XPS simples, ainsi que des fichiers de document XPS complexes contenant plus d’un FixedDocument dans le FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="f7a57-109">The interface can be used to create simple XPS document files and also complex XPS document files that contain more than one FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="f7a57-110">Dans les fichiers de document XPS complexes, les FixedDocuments sont également créés en séquence, en commençant par le premier FixedDocument dans le FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="f7a57-110">In complex XPS document files, the FixedDocuments are also created in sequence, starting with the first FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="f7a57-111">L’interface **IXpsOMPackageWriter** ne prend pas en charge la création de contenu de document dans un ordre aléatoire.</span><span class="sxs-lookup"><span data-stu-id="f7a57-111">The **IXpsOMPackageWriter** interface does not support the creation of document contents in random order.</span></span> <span data-ttu-id="f7a57-112">Utilisez-la, par exemple, pour créer un rapport séquentiel ou pour effectuer un traitement dans un filtre de pilote de périphérique dans lequel le contenu du document est transmis au pilote en séquence.</span><span class="sxs-lookup"><span data-stu-id="f7a57-112">Use it, for example, to create a sequential report or to perform processing in a device driver filter where the document contents are fed to the driver in sequence.</span></span>

## <a name="terminology-review"></a><span data-ttu-id="f7a57-113">Revue terminologique</span><span class="sxs-lookup"><span data-stu-id="f7a57-113">Terminology Review</span></span>

<span data-ttu-id="f7a57-114">Un *fichier de document XPS* est un package OPC (Open Packaging Conventions) qui est conforme à la spécification Paper XML.</span><span class="sxs-lookup"><span data-stu-id="f7a57-114">An *XPS document file* is an Open Packaging Conventions (OPC) package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="f7a57-115">Techniquement, l’interface [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) crée un *package OPC*, mais il s’agit d’un package OPC conforme à la spécification Paper XML.</span><span class="sxs-lookup"><span data-stu-id="f7a57-115">So, technically, the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an *OPC package*, but it is an OPC package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="f7a57-116">C’est pourquoi, dans les discussions sur les documents XPS, les termes *document XPS* et *package* sont souvent utilisés indifféremment.</span><span class="sxs-lookup"><span data-stu-id="f7a57-116">For this reason, in discussions about XPS documents, the terms *XPS document* and *package* are often used interchangeably.</span></span>

<span data-ttu-id="f7a57-117">Le *package* créé par l’interface [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) contient les composants de document XPS requis : un FixedDocumentSequence, au moins un FixedDocument et au moins un FixedPage.</span><span class="sxs-lookup"><span data-stu-id="f7a57-117">The *package* created by the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface will contain the required XPS document components: a FixedDocumentSequence, at least one FixedDocument, and at least one FixedPage.</span></span> <span data-ttu-id="f7a57-118">Le FixedDocumentSequence est créé lors de l’instanciation de l’interface **IXpsOMPackageWriter** .</span><span class="sxs-lookup"><span data-stu-id="f7a57-118">The FixedDocumentSequence is created when the **IXpsOMPackageWriter** interface is instantiated.</span></span> <span data-ttu-id="f7a57-119">Un FixedDocument est créé chaque fois que [**IXpsOMPackageWriter :: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) est appelé, et un FixedPage est créé chaque fois que [**IXpsOMPackageWriter :: AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) est appelé.</span><span class="sxs-lookup"><span data-stu-id="f7a57-119">A FixedDocument is created every time [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) is called, and a FixedPage is created every time [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) is called.</span></span> <span data-ttu-id="f7a57-120">Étant donné que l’interface écrit le contenu du document de manière séquentielle, la méthode **AddPage** ajoute la page au dernier créé.</span><span class="sxs-lookup"><span data-stu-id="f7a57-120">Because the interface writes the document contents sequentially, the **AddPage** method adds the page to the most recently created FixedDocument.</span></span>

## <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="f7a57-121">Utilisation de l’interface IXpsOMPackageWriter</span><span class="sxs-lookup"><span data-stu-id="f7a57-121">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="f7a57-122">La procédure suivante décrit comment créer un fichier de document XPS à l’aide de l’interface [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) .</span><span class="sxs-lookup"><span data-stu-id="f7a57-122">The following procedure describes how to create an XPS document file by using the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span> <span data-ttu-id="f7a57-123">La procédure ne décrit pas comment instancier une interface [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) et son contenu.</span><span class="sxs-lookup"><span data-stu-id="f7a57-123">The procedure does not describe how to instantiate an [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface and its contents.</span></span> <span data-ttu-id="f7a57-124">Pour plus d’informations sur **IXpsOMPage** et l’ajout de contenu à une page, consultez [interfaces de page OM XPS](xps-object-model-page-interfaces.md) et les rubriques figurant dans la section Voir aussi.</span><span class="sxs-lookup"><span data-stu-id="f7a57-124">For more information about **IXpsOMPage** and adding content to a page, see [XPS OM Page Interfaces](xps-object-model-page-interfaces.md) and the topics listed in the See Also section.</span></span>

 <span data-ttu-id="f7a57-125">**Création d’un document**</span><span class="sxs-lookup"><span data-stu-id="f7a57-125">**Creating a document**</span></span>

1.  <span data-ttu-id="f7a57-126">Instanciez une interface [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) .</span><span class="sxs-lookup"><span data-stu-id="f7a57-126">Instantiate an [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span>

    <span data-ttu-id="f7a57-127">Cela crée un FixedDocumentSequence vide dans le package.</span><span class="sxs-lookup"><span data-stu-id="f7a57-127">This creates an empty FixedDocumentSequence in the package.</span></span>

    -   <span data-ttu-id="f7a57-128">Pour créer un document XPS dans un fichier, appelez [**IXpsOMObjectFactory :: CreatePackageWriterOnFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span><span class="sxs-lookup"><span data-stu-id="f7a57-128">To create an XPS document in a file, call [**IXpsOMObjectFactory::CreatePackageWriterOnFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span></span>
    -   <span data-ttu-id="f7a57-129">Pour créer un document XPS dans un flux, appelez [**IXpsOMObjectFactory :: CreatePackageWriterOnStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span><span class="sxs-lookup"><span data-stu-id="f7a57-129">To create an XPS document in a stream, call [**IXpsOMObjectFactory::CreatePackageWriterOnStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span></span>

2.  <span data-ttu-id="f7a57-130">Démarrez un nouveau document dans le package en appelant [**IXpsOMPackageWriter :: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span><span class="sxs-lookup"><span data-stu-id="f7a57-130">Start a new document in the package by calling [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>

    <span data-ttu-id="f7a57-131">Avant d’ajouter une page, appelez [**IXpsOMPackageWriter :: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) pour ajouter un FixedDocument au FixedDocumentSequence créé à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="f7a57-131">Before adding a page, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) to add a FixedDocument to the FixedDocumentSequence that was created in step 1.</span></span>

3.  <span data-ttu-id="f7a57-132">Ajoutez du contenu.</span><span class="sxs-lookup"><span data-stu-id="f7a57-132">Add content.</span></span>
    -   <span data-ttu-id="f7a57-133">Pour ajouter un nouvel FixedPage au document, appelez [**IXpsOMPackageWriter :: AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), en lui transmettant un pointeur vers l’interface [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) dont vous souhaitez ajouter le contenu de FixedPage.</span><span class="sxs-lookup"><span data-stu-id="f7a57-133">To add a new FixedPage to the document, call [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), passing it a pointer to the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface that has the contents of the FixedPage that you want to add.</span></span>
    -   <span data-ttu-id="f7a57-134">Pour créer un FixedDocument dans le FixedDocumentSequence, appelez [**IXpsOMPackageWriter :: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span><span class="sxs-lookup"><span data-stu-id="f7a57-134">To create a new FixedDocument in the FixedDocumentSequence, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>
4.  <span data-ttu-id="f7a57-135">Fermez le package et son contenu en appelant [**IXpsOMPackageWriter :: Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span><span class="sxs-lookup"><span data-stu-id="f7a57-135">Close the package and its contents by calling [**IXpsOMPackageWriter::Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span></span>

## <a name="advanced-features"></a><span data-ttu-id="f7a57-136">Fonctionnalités avancées</span><span class="sxs-lookup"><span data-stu-id="f7a57-136">Advanced Features</span></span>

<span data-ttu-id="f7a57-137">Les méthodes de l’interface [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) prennent également en charge l’ajout de ressources, de miniatures et de tickets d’impression.</span><span class="sxs-lookup"><span data-stu-id="f7a57-137">The methods of the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface also support the adding of resources, thumbnails, and print tickets.</span></span> <span data-ttu-id="f7a57-138">Ces composants de document peuvent être ajoutés aux niveaux package, FixedDocumentSequence, FixedDocument et FixedPage.</span><span class="sxs-lookup"><span data-stu-id="f7a57-138">These document components can be added at the package, FixedDocumentSequence, FixedDocument, and FixedPage levels.</span></span> <span data-ttu-id="f7a57-139">Pour plus d’informations sur l’utilisation de cette interface pour l’impression, consultez [imprimer un modèle OM XPS](print-an-xps-om.md).</span><span class="sxs-lookup"><span data-stu-id="f7a57-139">For more information about using this interface for printing, see [Print an XPS OM](print-an-xps-om.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="f7a57-140">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f7a57-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f7a57-141">Utilisation de l’API de signature numérique XPS</span><span class="sxs-lookup"><span data-stu-id="f7a57-141">Using XPS Digital Signature API</span></span>](using-digital-signatures-in-xps-documents.md)
</dt> <dt>

[<span data-ttu-id="f7a57-142">Interfaces de page OM XPS</span><span class="sxs-lookup"><span data-stu-id="f7a57-142">XPS OM Page Interfaces</span></span>](xps-object-model-page-interfaces.md)
</dt> <dt>

[<span data-ttu-id="f7a57-143">Naviguer dans le modèle d’objet XPS</span><span class="sxs-lookup"><span data-stu-id="f7a57-143">Navigate the XPS OM</span></span>](navigate-the-xps-om.md)
</dt> <dt>

[<span data-ttu-id="f7a57-144">Utilisation d’une zone de dessin et d’interfaces visuels XPS OM</span><span class="sxs-lookup"><span data-stu-id="f7a57-144">Working with XPS OM Canvas and Visual Interfaces</span></span>](working-with-xpsomcanvas-interfaces.md)
</dt> <dt>

[<span data-ttu-id="f7a57-145">Utilisation des interfaces de chemin d’accès OM XPS</span><span class="sxs-lookup"><span data-stu-id="f7a57-145">Working with XPS OM Path Interfaces</span></span>](working-with-xps-object-model-path-interfaces.md)
</dt> <dt>

[<span data-ttu-id="f7a57-146">Utilisation du texte, des graphiques et des interfaces d’images XPS OM</span><span class="sxs-lookup"><span data-stu-id="f7a57-146">Working with XPS OM Text, Graphics, and Image Interfaces</span></span>](working-with-xps-object-model-text-and-image-interfaces.md)
</dt> <dt>

[<span data-ttu-id="f7a57-147">Interfaces du ticket d’impression XPS OM</span><span class="sxs-lookup"><span data-stu-id="f7a57-147">XPS OM Print Ticket Interfaces</span></span>](xps-object-model-print-ticket-interfaces.md)
</dt> <dt>

[<span data-ttu-id="f7a57-148">**IXpsOMThumbnailGenerator**</span><span class="sxs-lookup"><span data-stu-id="f7a57-148">**IXpsOMThumbnailGenerator**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomthumbnailgenerator)
</dt> <dt>

[<span data-ttu-id="f7a57-149">Informations de référence sur l’API de document XPS</span><span class="sxs-lookup"><span data-stu-id="f7a57-149">XPS Document API Reference</span></span>](xps-programming-reference.md)
</dt> <dt>

[<span data-ttu-id="f7a57-150">XML Paper Specification</span><span class="sxs-lookup"><span data-stu-id="f7a57-150">XML Paper Specification</span></span>](https://www.ecma-international.org/activities/XML%20Paper%20Specification/XPS%20Standard%20WD%201.6.pdf)
</dt> </dl>

 

 



