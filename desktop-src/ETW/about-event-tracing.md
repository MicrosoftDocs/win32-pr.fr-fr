---
description: Suivi d’v nements pour Windows (ETW) est une fonctionnalité de traçage efficace au niveau du noyau qui vous permet d’enregistrer des événements de noyau ou définis par l’application dans un fichier journal.
ms.assetid: 0eaa7bd3-8537-483a-b0d6-db3b790a6f3d
title: À propos du suivi d’événements
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3a2f13284cec1d9300c23241fafe154f277f72a3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951333"
---
# <a name="about-event-tracing"></a><span data-ttu-id="01d56-103">À propos du suivi d’événements</span><span class="sxs-lookup"><span data-stu-id="01d56-103">About Event Tracing</span></span>

<span data-ttu-id="01d56-104">Suivi d’v nements pour Windows (ETW) est une fonctionnalité de traçage efficace au niveau du noyau qui vous permet d’enregistrer des événements de noyau ou définis par l’application dans un fichier journal.</span><span class="sxs-lookup"><span data-stu-id="01d56-104">Event Tracing for Windows (ETW) is an efficient kernel-level tracing facility that lets you log kernel or application-defined events to a log file.</span></span> <span data-ttu-id="01d56-105">Vous pouvez consommer les événements en temps réel ou à partir d’un fichier journal et les utiliser pour déboguer une application ou pour déterminer où les problèmes de performances se produisent dans l’application.</span><span class="sxs-lookup"><span data-stu-id="01d56-105">You can consume the events in real time or from a log file and use them to debug an application or to determine where performance issues are occurring in the application.</span></span>

<span data-ttu-id="01d56-106">ETW vous permet d’activer ou de désactiver le suivi des événements de manière dynamique, ce qui vous permet d’effectuer un suivi détaillé dans un environnement de production sans nécessiter le redémarrage de l’ordinateur ou de l’application.</span><span class="sxs-lookup"><span data-stu-id="01d56-106">ETW lets you enable or disable event tracing dynamically, allowing you to perform detailed tracing in a production environment without requiring computer or application restarts.</span></span>

<span data-ttu-id="01d56-107">L’API de suivi d’événements est divisée en trois composants distincts :</span><span class="sxs-lookup"><span data-stu-id="01d56-107">The Event Tracing API is broken into three distinct components:</span></span>

-   <span data-ttu-id="01d56-108">[Contrôleurs](#controllers), qui démarrent et arrêtent une session de suivi d’événements et activent les fournisseurs</span><span class="sxs-lookup"><span data-stu-id="01d56-108">[Controllers](#controllers), which start and stop an event tracing session and enable providers</span></span>
-   <span data-ttu-id="01d56-109">[Fournisseurs](#providers), qui fournissent les événements</span><span class="sxs-lookup"><span data-stu-id="01d56-109">[Providers](#providers), which provide the events</span></span>
-   <span data-ttu-id="01d56-110">[Consommateurs](#consumers), qui consomment les événements</span><span class="sxs-lookup"><span data-stu-id="01d56-110">[Consumers](#consumers), which consume the events</span></span>

<span data-ttu-id="01d56-111">Le diagramme suivant illustre le modèle de suivi d’événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-111">The following diagram shows the event tracing model.</span></span>

![modèle de suivi d’événements](images/etdiag2.png)

## <a name="controllers"></a><span data-ttu-id="01d56-113">Controllers</span><span class="sxs-lookup"><span data-stu-id="01d56-113">Controllers</span></span>

<span data-ttu-id="01d56-114">Les contrôleurs sont des applications qui définissent la taille et l’emplacement du fichier journal, démarrent et arrêtent les [sessions de suivi des événements](event-tracing-sessions.md), activent les fournisseurs afin de pouvoir consigner les événements dans la session, gérer la taille du pool de mémoires tampons et obtenir des statistiques d’exécution pour les sessions.</span><span class="sxs-lookup"><span data-stu-id="01d56-114">Controllers are applications that define the size and location of the log file, start and stop [event tracing sessions](event-tracing-sessions.md), enable providers so they can log events to the session, manage the size of the buffer pool, and obtain execution statistics for sessions.</span></span> <span data-ttu-id="01d56-115">Les statistiques de session incluent le nombre de mémoires tampons utilisées, le nombre de mémoires tampons livrées et le nombre d’événements et de tampons perdus.</span><span class="sxs-lookup"><span data-stu-id="01d56-115">Session statistics include the number of buffers used, the number of buffers delivered, and the number of events and buffers lost.</span></span> 

<span data-ttu-id="01d56-116">Pour plus d’informations, consultez [contrôle des sessions de suivi d’événements](controlling-event-tracing-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="01d56-116">For more information, see [Controlling Event Tracing Sessions](controlling-event-tracing-sessions.md).</span></span>

## <a name="providers"></a><span data-ttu-id="01d56-117">Fournisseurs</span><span class="sxs-lookup"><span data-stu-id="01d56-117">Providers</span></span>

<span data-ttu-id="01d56-118">Les fournisseurs sont des applications qui contiennent l’instrumentation de traçage d’événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-118">Providers are applications that contain event tracing instrumentation.</span></span> <span data-ttu-id="01d56-119">Une fois qu’un fournisseur s’est inscrit lui-même, un contrôleur peut ensuite activer ou désactiver le suivi des événements dans le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="01d56-119">After a provider registers itself, a controller can then enable or disable event tracing in the provider.</span></span> <span data-ttu-id="01d56-120">Le fournisseur définit son interprétation de l’activation ou de la désactivation.</span><span class="sxs-lookup"><span data-stu-id="01d56-120">The provider defines its interpretation of being enabled or disabled.</span></span> <span data-ttu-id="01d56-121">En règle générale, un fournisseur activé génère des événements, contrairement à un fournisseur désactivé.</span><span class="sxs-lookup"><span data-stu-id="01d56-121">Generally, an enabled provider generates events, while a disabled provider does not.</span></span> <span data-ttu-id="01d56-122">Cela vous permet d’ajouter le suivi d’événements à votre application sans qu’il ne soit nécessaire de générer des événements en permanence.</span><span class="sxs-lookup"><span data-stu-id="01d56-122">This lets you add event tracing to your application without requiring that it generate events all the time.</span></span> 

<span data-ttu-id="01d56-123">Bien que le modèle ETW sépare le contrôleur et le fournisseur en applications distinctes, une application peut inclure les deux composants.</span><span class="sxs-lookup"><span data-stu-id="01d56-123">Although the ETW model separates the controller and provider into separate applications, an application can include both components.</span></span>

<span data-ttu-id="01d56-124">Pour plus d’informations, consultez [fourniture d’événements](providing-events.md).</span><span class="sxs-lookup"><span data-stu-id="01d56-124">For more information, see [Providing Events](providing-events.md).</span></span>

### <a name="types-of-providers"></a><span data-ttu-id="01d56-125">Types de fournisseurs</span><span class="sxs-lookup"><span data-stu-id="01d56-125">Types of Providers</span></span>

<span data-ttu-id="01d56-126">Il existe quatre types principaux de fournisseurs : fournisseurs MOF (Classic), fournisseurs WPP, fournisseurs basés sur un manifeste et fournisseurs TraceLogging.</span><span class="sxs-lookup"><span data-stu-id="01d56-126">There are four main types of providers: MOF (classic) providers, WPP providers, manifest-based providers, and TraceLogging providers.</span></span> <span data-ttu-id="01d56-127">Vous devez utiliser un fournisseur basé sur un manifeste ou un fournisseur TraceLogging si vous écrivez des applications pour Windows Vista ou version ultérieure qui n’ont pas besoin de prendre en charge les systèmes hérités.</span><span class="sxs-lookup"><span data-stu-id="01d56-127">You should use a manifest-based provider or a TraceLogging provider if you are writing applications for Windows Vista or later that do not need to support legacy systems.</span></span>

#### <a name="mof-classic-providers"></a><span data-ttu-id="01d56-128">Fournisseurs MOF (classiques) :</span><span class="sxs-lookup"><span data-stu-id="01d56-128">MOF (classic) providers:</span></span>

-   <span data-ttu-id="01d56-129">Utilisez les fonctions [RegisterTraceGuids](/windows/win32/api/evntrace/nf-evntrace-registertraceguidsa) et [TraceEvent](/windows/win32/api/evntrace/nf-evntrace-traceevent) pour inscrire et écrire des événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-129">Use the [RegisterTraceGuids](/windows/win32/api/evntrace/nf-evntrace-registertraceguidsa) and [TraceEvent](/windows/win32/api/evntrace/nf-evntrace-traceevent) functions to register and write events.</span></span>
-   <span data-ttu-id="01d56-130">Utilisez les classes MOF pour définir des événements afin que les consommateurs sachent comment les utiliser.</span><span class="sxs-lookup"><span data-stu-id="01d56-130">Use MOF classes to define events so that consumers know how to consume them.</span></span>
-   <span data-ttu-id="01d56-131">Ne peut être activé que par une seule session de suivi à la fois.</span><span class="sxs-lookup"><span data-stu-id="01d56-131">Can be enabled by only one trace session at a time.</span></span>

#### <a name="wpp-providers"></a><span data-ttu-id="01d56-132">Fournisseurs WPP :</span><span class="sxs-lookup"><span data-stu-id="01d56-132">WPP providers:</span></span>

-   <span data-ttu-id="01d56-133">Utilisez les fonctions [RegisterTraceGuids](/windows/win32/api/evntrace/nf-evntrace-registertraceguidsa) et [TraceEvent](/windows/win32/api/evntrace/nf-evntrace-traceevent) pour inscrire et écrire des événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-133">Use the [RegisterTraceGuids](/windows/win32/api/evntrace/nf-evntrace-registertraceguidsa) and [TraceEvent](/windows/win32/api/evntrace/nf-evntrace-traceevent) functions to register and write events.</span></span>
-   <span data-ttu-id="01d56-134">Avoir des fichiers TMF associés (compilés dans le fichier. pdb d’un binaire) qui contiennent des informations de décodage déduites de l’analyse du préprocesseur de l’instrumentation WPP dans le code source.</span><span class="sxs-lookup"><span data-stu-id="01d56-134">Have associated TMF files (compiled into a binary's .pdb) containing decoding information inferred from the preprocessor's scan of WPP instrumentation in source code.</span></span>
-   <span data-ttu-id="01d56-135">Ne peut être activé que par une seule session de suivi à la fois.</span><span class="sxs-lookup"><span data-stu-id="01d56-135">Can be enabled by only one trace session at a time.</span></span>

#### <a name="manifest-based-providers"></a><span data-ttu-id="01d56-136">Fournisseurs basés sur un manifeste :</span><span class="sxs-lookup"><span data-stu-id="01d56-136">Manifest-based providers:</span></span>

-   <span data-ttu-id="01d56-137">Utilisez [EventRegister](/windows/desktop/api/Evntprov/nf-evntprov-eventregister) et [EventWrite](/windows/desktop/api/Evntprov/nf-evntprov-eventwrite) pour inscrire et écrire des événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-137">Use [EventRegister](/windows/desktop/api/Evntprov/nf-evntprov-eventregister) and [EventWrite](/windows/desktop/api/Evntprov/nf-evntprov-eventwrite) to register and write events.</span></span>
-   <span data-ttu-id="01d56-138">Utilisez un manifeste pour définir des événements afin que les consommateurs sachent comment les utiliser.</span><span class="sxs-lookup"><span data-stu-id="01d56-138">Use a manifest to define events so that consumers know how to consume them.</span></span>
-   <span data-ttu-id="01d56-139">Peut être activée simultanément jusqu’à huit sessions de suivi.</span><span class="sxs-lookup"><span data-stu-id="01d56-139">Can be enabled by up to eight trace sessions simultaneously.</span></span>

#### <a name="tracelogging-providers"></a><span data-ttu-id="01d56-140">Fournisseurs [TraceLogging](/windows/desktop/tracelogging/trace-logging-about) :</span><span class="sxs-lookup"><span data-stu-id="01d56-140">[TraceLogging](/windows/desktop/tracelogging/trace-logging-about) providers:</span></span>

-   <span data-ttu-id="01d56-141">Utilisez [TraceLoggingRegister](/windows/desktop/api/traceloggingprovider/nf-traceloggingprovider-traceloggingregister) et [TraceLoggingWrite](/windows/desktop/api/traceloggingprovider/nf-traceloggingprovider-traceloggingwrite) pour inscrire et écrire des événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-141">Use [TraceLoggingRegister](/windows/desktop/api/traceloggingprovider/nf-traceloggingprovider-traceloggingregister) and [TraceLoggingWrite](/windows/desktop/api/traceloggingprovider/nf-traceloggingprovider-traceloggingwrite) to register and write events.</span></span>
-   <span data-ttu-id="01d56-142">Utilisez des événements auto-descriptifs afin que les événements eux-mêmes contiennent toutes les informations requises pour les consommer.</span><span class="sxs-lookup"><span data-stu-id="01d56-142">Use self-describing events so that the events themselves contain all required information for consuming them.</span></span>
-   <span data-ttu-id="01d56-143">Peut être activée simultanément jusqu’à huit sessions de suivi.</span><span class="sxs-lookup"><span data-stu-id="01d56-143">Can be enabled by up to eight trace sessions simultaneously.</span></span>

<span data-ttu-id="01d56-144">Tous les fournisseurs d’événements utilisent fondamentalement la famille d’API de suivi d’événements ([TraceEvent](/windows/win32/api/evntrace/nf-evntrace-traceevent) pour les technologies héritées et [EventWrite](/windows/desktop/api/Evntprov/nf-evntprov-eventwrite) / [EventWriteEx](/windows/desktop/api/Evntprov/nf-evntprov-eventwriteex) pour les versions plus récentes).</span><span class="sxs-lookup"><span data-stu-id="01d56-144">All event providers fundamentally use the Event Tracing family of APIs ([TraceEvent](/windows/win32/api/evntrace/nf-evntrace-traceevent) for legacy technologies and [EventWrite](/windows/desktop/api/Evntprov/nf-evntprov-eventwrite)/[EventWriteEx](/windows/desktop/api/Evntprov/nf-evntprov-eventwriteex) for newer ones).</span></span> <span data-ttu-id="01d56-145">Les fournisseurs d’événements diffèrent simplement dans les types de champs qu’ils stockent dans les charges utiles d’événement et où ils stockent les informations de décodage d’événements associées.</span><span class="sxs-lookup"><span data-stu-id="01d56-145">Event providers simply differ in what field types they store in event payloads and where they store the associated event decoding information.</span></span>

## <a name="consumers"></a><span data-ttu-id="01d56-146">Consommateurs</span><span class="sxs-lookup"><span data-stu-id="01d56-146">Consumers</span></span>

<span data-ttu-id="01d56-147">Les consommateurs sont des applications qui sélectionnent une ou plusieurs sessions de suivi d’événements comme source d’événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-147">Consumers are applications that select one or more event tracing sessions as a source of events.</span></span> <span data-ttu-id="01d56-148">Un consommateur peut demander simultanément des événements de plusieurs sessions de suivi d’événements ; le système remet les événements dans l’ordre chronologique.</span><span class="sxs-lookup"><span data-stu-id="01d56-148">A consumer can request events from multiple event tracing sessions simultaneously; the system delivers the events in chronological order.</span></span> <span data-ttu-id="01d56-149">Les consommateurs peuvent recevoir des événements stockés dans des fichiers journaux ou des sessions qui délivrent des événements en temps réel.</span><span class="sxs-lookup"><span data-stu-id="01d56-149">Consumers can receive events stored in log files, or from sessions that deliver events in real time.</span></span> <span data-ttu-id="01d56-150">Lors du traitement des événements, un consommateur peut spécifier des heures de début et de fin, et seuls les événements qui se produisent dans le laps de temps spécifié sont remis.</span><span class="sxs-lookup"><span data-stu-id="01d56-150">When processing events, a consumer can specify start and end times, and only events that occur in the specified time frame will be delivered.</span></span> 

<span data-ttu-id="01d56-151">Pour plus d’informations, consultez [consommation d’événements](consuming-events.md).</span><span class="sxs-lookup"><span data-stu-id="01d56-151">For more information, see [Consuming Events](consuming-events.md).</span></span>

## <a name="missing-events"></a><span data-ttu-id="01d56-152">Événements manquants</span><span class="sxs-lookup"><span data-stu-id="01d56-152">Missing Events</span></span>

<span data-ttu-id="01d56-153">Perfmon, diagnostics du système et d’autres outils système peuvent signaler des événements manquants dans le journal des événements et indiquer que les paramètres de Suivi d’v nements pour Windows (ETW) peuvent ne pas être optimaux.</span><span class="sxs-lookup"><span data-stu-id="01d56-153">Perfmon, System Diagnostics, and other system tools may report on missing events in the Event Log and indicate that the settings for Event Tracing for Windows (ETW) may not be optimal.</span></span> <span data-ttu-id="01d56-154">Les événements peuvent être perdus pour plusieurs raisons :</span><span class="sxs-lookup"><span data-stu-id="01d56-154">Events can be lost for a number of reasons:</span></span>

-   <span data-ttu-id="01d56-155">La taille totale de l’événement est supérieure à 64 Ko.</span><span class="sxs-lookup"><span data-stu-id="01d56-155">The total event size is greater than 64K.</span></span> <span data-ttu-id="01d56-156">Cela comprend l’en-tête ETW plus les données ou la charge utile.</span><span class="sxs-lookup"><span data-stu-id="01d56-156">This includes the ETW header plus the data or payload.</span></span> <span data-ttu-id="01d56-157">Un utilisateur n’a aucun contrôle sur ces événements manquants, car la taille de l’événement est configurée par l’application.</span><span class="sxs-lookup"><span data-stu-id="01d56-157">A user has no control over these missing events since the event size is configured by the application.</span></span>

-   <span data-ttu-id="01d56-158">La taille de la mémoire tampon ETW est inférieure à la taille totale de l’événement.</span><span class="sxs-lookup"><span data-stu-id="01d56-158">The ETW buffer size is smaller than the total event size.</span></span> <span data-ttu-id="01d56-159">Un utilisateur n’a aucun contrôle sur ces événements manquants, car la taille de l’événement est configurée par l’application consignant les événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-159">A user has no control over these missing events since the event size is configured by the application logging the events.</span></span>

-   <span data-ttu-id="01d56-160">Pour la journalisation en temps réel, le consommateur en temps réel ne consomme pas d’événements assez rapidement ou n’est pas entièrement présent, puis le fichier de sauvegarde est saturé.</span><span class="sxs-lookup"><span data-stu-id="01d56-160">For real-time logging, the real-time consumer is not consuming events fast enough or is not present altogether and then the backing file is filling up.</span></span> <span data-ttu-id="01d56-161">Cela peut se produire si le service journal des événements est arrêté et démarré lors de la journalisation des événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-161">This can result if the Event Log service is stopped and started when events are being logged.</span></span> <span data-ttu-id="01d56-162">Un utilisateur n’a aucun contrôle sur ces événements manquants.</span><span class="sxs-lookup"><span data-stu-id="01d56-162">A user has no control over these missing events.</span></span>

-   <span data-ttu-id="01d56-163">Lors de la journalisation dans un fichier, le disque est trop lent pour suivre le taux de journalisation.</span><span class="sxs-lookup"><span data-stu-id="01d56-163">When logging to a file, the disk is too slow to keep up with the logging rate.</span></span>

<span data-ttu-id="01d56-164">Pour l’une de ces raisons, veuillez signaler ces problèmes au fournisseur de l’application ou du service qui génère les événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-164">For any of these reasons, please report these problems to the provider of the application or service that is generating the events.</span></span> <span data-ttu-id="01d56-165">Ces problèmes peuvent être résolus uniquement par le développeur de l’application ou le service qui journalise les événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-165">These issues can only be fixed by the application developer or the service logging the events.</span></span> <span data-ttu-id="01d56-166">Si les événements manquants sont signalés dans le service journal des événements, cela peut indiquer un problème avec la configuration du service journal des événements.</span><span class="sxs-lookup"><span data-stu-id="01d56-166">If the missing events are being reported in the Event Log Service, this may indicate a problem with the configuration of the Event Log service.</span></span> <span data-ttu-id="01d56-167">L’utilisateur peut avoir une capacité limitée à augmenter l’espace disque maximal à utiliser par le service journal des événements, ce qui peut réduire le nombre d’événements manquants.</span><span class="sxs-lookup"><span data-stu-id="01d56-167">The user may have some limited ability to increase the maximum disk space to be used by the Event Log Service which may reduce the number of missing events.</span></span>

 

 
