---
description: La plupart des compteurs requièrent deux exemples de valeurs pour calculer une valeur affichable.
ms.assetid: 75e45baf-51c5-400c-a31f-92bdab4ee492
title: Affichage des données de performances
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22d913474b794585dd557fae2b1fc232336b637d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106527895"
---
# <a name="displaying-performance-data"></a><span data-ttu-id="b6cfd-103">Affichage des données de performances</span><span class="sxs-lookup"><span data-stu-id="b6cfd-103">Displaying Performance Data</span></span>

<span data-ttu-id="b6cfd-104">La plupart des compteurs requièrent deux exemples de valeurs pour calculer une valeur affichable.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-104">Most counters require two sample values in order to compute a displayable value.</span></span> <span data-ttu-id="b6cfd-105">La formule de chaque compteur détermine si le compteur requiert deux échantillons.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-105">The formula for each counter determines if the counter requires two samples.</span></span> <span data-ttu-id="b6cfd-106">Pour obtenir la liste des compteurs et leurs formules, consultez la section types de compteurs du [Kit de déploiement de Windows Server 2003](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="b6cfd-106">For a list of counters and their formulas, see the Counter Types section of the [Windows Server 2003 Deployment Kit](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10)).</span></span>

<span data-ttu-id="b6cfd-107">La [collecte des données de performances](collecting-performance-data.md) montre comment récupérer des exemples de données.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-107">[Collecting Performance Data](collecting-performance-data.md) shows how to retrieve sample data.</span></span> <span data-ttu-id="b6cfd-108">Une fois que vous avez les exemples, vous appelez généralement [**PdhGetFormattedCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue) pour calculer une valeur affichable.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-108">Once you have the samples, you typically call [**PdhGetFormattedCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue) to calculate a displayable value.</span></span>

<span data-ttu-id="b6cfd-109">Si vous devez mettre à l’échelle la valeur du compteur vers le haut ou vers le haut pour afficher la valeur, appelez la fonction [**PdhSetCounterScaleFactor**](/windows/desktop/api/Pdh/nf-pdh-pdhsetcounterscalefactor) avant d’appeler [**PdhGetFormattedCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue).</span><span class="sxs-lookup"><span data-stu-id="b6cfd-109">If you need to scale the counter value up or down in order to display the value, call the [**PdhSetCounterScaleFactor**](/windows/desktop/api/Pdh/nf-pdh-pdhsetcounterscalefactor) function before calling [**PdhGetFormattedCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue).</span></span> <span data-ttu-id="b6cfd-110">Les valeurs de compteur peuvent être mises à l’échelle d’une puissance de dix d’un facteur de-7 à 7.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-110">Counter values can be scaled by a power of ten from a factor of -7 to 7.</span></span>

<span data-ttu-id="b6cfd-111">Si le chemin d’accès au compteur contient un caractère générique pour le nom de l’instance, appelez [**PdhGetFormattedCounterArray**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcounterarraya) pour récupérer un tableau de valeurs de compteur mises en forme pour chaque instance collectée.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-111">If the counter path contains a wildcard character for the instance name, call [**PdhGetFormattedCounterArray**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcounterarraya) to retrieve an array of formatted counter values for each instance collected.</span></span>

<span data-ttu-id="b6cfd-112">Vous pouvez également utiliser les fonctions [**PdhCalculateCounterFromRawValue**](/windows/desktop/api/Pdh/nf-pdh-pdhcalculatecounterfromrawvalue) et [**PdhFormatFromRawValue**](/windows/desktop/api/Pdh/nf-pdh-pdhformatfromrawvalue) pour calculer une valeur affichable.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-112">You can also use the [**PdhCalculateCounterFromRawValue**](/windows/desktop/api/Pdh/nf-pdh-pdhcalculatecounterfromrawvalue) and [**PdhFormatFromRawValue**](/windows/desktop/api/Pdh/nf-pdh-pdhformatfromrawvalue) functions to compute a displayable value.</span></span> <span data-ttu-id="b6cfd-113">Pour utiliser ces fonctions, vous devez récupérer l’exemple collecté après chaque appel [**PdhCollectQueryData**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) et stocker l’exemple vous-même.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-113">To use these functions, you must retrieve the collected sample after each [**PdhCollectQueryData**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) call and store the sample yourself.</span></span> <span data-ttu-id="b6cfd-114">Pour récupérer l’exemple, appelez la fonction [**PdhGetRawCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcountervalue) ou [**PdhGetRawCounterArray**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcounterarraya) .</span><span class="sxs-lookup"><span data-stu-id="b6cfd-114">To retrieve the sample, call the [**PdhGetRawCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcountervalue) or [**PdhGetRawCounterArray**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcounterarraya) function.</span></span> <span data-ttu-id="b6cfd-115">Pour les valeurs de compteur basées sur le temps, appelez [**PdhGetCounterTimeBase**](/windows/desktop/api/Pdh/nf-pdh-pdhgetcountertimebase) avant **PdhFormatFromRawValue** pour récupérer la base de temps du compteur.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-115">For time-based counter values, call [**PdhGetCounterTimeBase**](/windows/desktop/api/Pdh/nf-pdh-pdhgetcountertimebase) before **PdhFormatFromRawValue** to retrieve the counter's time base.</span></span>

<span data-ttu-id="b6cfd-116">Si vous effectuez des calculs à l’aide des données brutes, vérifiez toujours le membre **CStatus** de la structure de [**\_ \_ compteur brut PDH**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) avant d’utiliser l’exemple.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-116">If you perform calculations using the raw data, always check the **CStatus** member of the [**PDH\_RAW\_COUNTER**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) structure before using the sample.</span></span> <span data-ttu-id="b6cfd-117">L’exemple n’est pas valide si la valeur de **CStatus** n’est pas PDH \_ CStatus \_ New \_ Data ou PDH \_ CStatus des \_ données valides \_ .</span><span class="sxs-lookup"><span data-stu-id="b6cfd-117">The sample is not valid if the value of **CStatus** is not PDH\_CSTATUS\_NEW\_DATA or PDH\_CSTATUS\_VALID\_DATA.</span></span>

## <a name="displaying-statistics-for-a-counter"></a><span data-ttu-id="b6cfd-118">Affichage des statistiques d’un compteur</span><span class="sxs-lookup"><span data-stu-id="b6cfd-118">Displaying statistics for a counter</span></span>

<span data-ttu-id="b6cfd-119">Si vous souhaitez calculer les valeurs minimale, maximale et moyenne d’un compteur, appelez la fonction [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) .</span><span class="sxs-lookup"><span data-stu-id="b6cfd-119">If you want to compute the minimum, maximum, and mean values of a counter, call the [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) function.</span></span> <span data-ttu-id="b6cfd-120">Lorsque vous collectez des exemples, stockez les structures de [**\_ \_ compteur bruts PDH**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) dans un tableau que vous transmettez à **PdhComputeCounterStatistics**.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-120">When you collect samples, store the [**PDH\_RAW\_COUNTER**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) structures in an array that you pass to **PdhComputeCounterStatistics**.</span></span> <span data-ttu-id="b6cfd-121">La fonction retourne les valeurs statistiques dans une structure de [**\_ statistiques PDH**](/windows/desktop/api/Pdh/ns-pdh-pdh_statistics) .</span><span class="sxs-lookup"><span data-stu-id="b6cfd-121">The function returns the statistical values in a [**PDH\_STATISTICS**](/windows/desktop/api/Pdh/ns-pdh-pdh_statistics) structure.</span></span>

<span data-ttu-id="b6cfd-122">Vous pouvez également utiliser cette fonction pour compresser un fichier journal.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-122">You can also use this function to compress a log file.</span></span> <span data-ttu-id="b6cfd-123">Par exemple, lisez dix enregistrements dans un fichier journal, appelez [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) pour calculer la valeur moyenne, puis écrivez la valeur moyenne dans un fichier journal de sortie.</span><span class="sxs-lookup"><span data-stu-id="b6cfd-123">For example, read ten records from a log file, call [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) to compute the mean value and then write the mean value to an output log file.</span></span>

 

 
