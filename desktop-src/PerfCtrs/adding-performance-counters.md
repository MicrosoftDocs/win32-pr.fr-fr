---
description: Les compteurs de performances spécifiques à votre application peuvent vous aider à optimiser les performances lors du développement et du débogage de l’application.
ms.assetid: 016386f6-4675-409e-8446-599e4ff96109
title: Ajout de compteurs de performances
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8660af9406de4dedec3ecbd76169a23b342aa7d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106544860"
---
# <a name="adding-performance-counters"></a><span data-ttu-id="e9206-103">Ajout de compteurs de performances</span><span class="sxs-lookup"><span data-stu-id="e9206-103">Adding Performance Counters</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e9206-104">En raison des limitations de performances et de fiabilité significatives, la méthode permettant de fournir des données de compteurs de performances que cette rubrique décrit peut être modifiée ou non disponible à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="e9206-104">Due to significant performance and reliability limitations, the method for providing performance counter data that this topic describes may be altered or unavailable in the future.</span></span> <span data-ttu-id="e9206-105">Au lieu de cela, Microsoft vous recommande d’utiliser la méthode décrite dans la rubrique [fourniture de données de compteur à l’aide de la Version 2,0](providing-counter-data-using-version-2-0.md) pour la création de nouveaux compteurs de performances et la migration des compteurs de performances existants pour utiliser également cette méthode.</span><span class="sxs-lookup"><span data-stu-id="e9206-105">Instead, Microsoft recommends that you use the method described in [Providing Counter Data Using Version 2.0](providing-counter-data-using-version-2-0.md) for creating new performance counters, and that you migrate existing performance counters to use that method as well.</span></span>

<span data-ttu-id="e9206-106">Les compteurs de performances spécifiques à votre application peuvent vous aider à optimiser les performances lors du développement et du débogage de l’application.</span><span class="sxs-lookup"><span data-stu-id="e9206-106">Performance counters specific to your application can help you tune performance while you develop and debug the application.</span></span> <span data-ttu-id="e9206-107">Une fois votre application terminée et installée sur les systèmes cibles, les compteurs peuvent aider les administrateurs système à ajuster les paramètres configurables pour votre application.</span><span class="sxs-lookup"><span data-stu-id="e9206-107">After your application is complete and installed on target systems, the counters can help system administrators adjust configurable settings for your application.</span></span>

## <a name="adding-a-performance-object-and-its-counters"></a><span data-ttu-id="e9206-108">Ajout d’un objet de performance et de ses compteurs</span><span class="sxs-lookup"><span data-stu-id="e9206-108">Adding a performance object and its counters</span></span>

1. <span data-ttu-id="e9206-109">Concevez les types d’objets et les compteurs pour l’application.</span><span class="sxs-lookup"><span data-stu-id="e9206-109">Design the object types and counters for the application.</span></span> <span data-ttu-id="e9206-110">Pour plus d’informations, consultez [conception d’objets et de compteurs](object-and-counter-design.md).</span><span class="sxs-lookup"><span data-stu-id="e9206-110">For details, see [Object and Counter Design](object-and-counter-design.md).</span></span>
2. <span data-ttu-id="e9206-111">Créez un fichier d’initialisation (. ini) contenant les noms et les descriptions des objets et des compteurs de performance que vous fournissez.</span><span class="sxs-lookup"><span data-stu-id="e9206-111">Create an initialization (.ini) file containing the names and descriptions of the performance objects and counters that you provide.</span></span> <span data-ttu-id="e9206-112">Pour plus d’informations, consultez [Ajout de noms de compteur et de descriptions au registre](adding-counter-names-and-descriptions-to-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="e9206-112">For details, see [Adding Counter Names and Descriptions to the Registry](adding-counter-names-and-descriptions-to-the-registry.md).</span></span>
3. <span data-ttu-id="e9206-113">Créez un fichier d’en-tête (. h) contenant les décalages relatifs auxquels les objets de compteur et les compteurs seront installés dans le registre.</span><span class="sxs-lookup"><span data-stu-id="e9206-113">Create a header (.h) file containing the relative offsets at which the counter objects and counters will be installed in the registry.</span></span> <span data-ttu-id="e9206-114">Pour plus d’informations, consultez [Ajout de noms de compteur et de descriptions au registre](adding-counter-names-and-descriptions-to-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="e9206-114">For details, see [Adding Counter Names and Descriptions to the Registry](adding-counter-names-and-descriptions-to-the-registry.md).</span></span>
4. <span data-ttu-id="e9206-115">Configurez les entrées d’analyse des performances nécessaires dans le registre.</span><span class="sxs-lookup"><span data-stu-id="e9206-115">Set up the necessary performance monitoring entries in the registry.</span></span> <span data-ttu-id="e9206-116">Cela comprend les étapes suivantes.</span><span class="sxs-lookup"><span data-stu-id="e9206-116">This includes the following steps.</span></span>
    1. <span data-ttu-id="e9206-117">Créez une clé de Registre dans la clé **services** de l’application.</span><span class="sxs-lookup"><span data-stu-id="e9206-117">Create a registry key in the **Services** key for the application.</span></span> <span data-ttu-id="e9206-118">Si vous n’avez pas ce type de nœud, créez-le sous la clé de Registre suivante : `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services` .</span><span class="sxs-lookup"><span data-stu-id="e9206-118">If you do not have such a node, create it under the following registry key: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services`.</span></span> <span data-ttu-id="e9206-119">Pour plus d’informations, consultez [création de la clé de performance de l’application](creating-the-applications-performance-key.md).</span><span class="sxs-lookup"><span data-stu-id="e9206-119">For details, see [Creating the Application's Performance Key](creating-the-applications-performance-key.md).</span></span>
    2. <span data-ttu-id="e9206-120">Utilisez l’utilitaire **lodctr** avec les fichiers. ini et. h pour installer les informations dans le registre.</span><span class="sxs-lookup"><span data-stu-id="e9206-120">Use the **lodctr** utility with the .ini and .h files to install the information in the registry.</span></span> <span data-ttu-id="e9206-121">Cet utilitaire ne fonctionne que si une clé de performance existe dans la clé des **services** de l’application.</span><span class="sxs-lookup"><span data-stu-id="e9206-121">This utility succeeds only if a performance key exists in the **Services** key for the application.</span></span> <span data-ttu-id="e9206-122">Pour plus d’informations, consultez [Ajout de noms de compteur et de descriptions au registre](adding-counter-names-and-descriptions-to-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="e9206-122">For details, see [Adding Counter Names and Descriptions to the Registry](adding-counter-names-and-descriptions-to-the-registry.md).</span></span>
5. <span data-ttu-id="e9206-123">Créez une DLL de performance contenant un ensemble de fonctions exportées qui fournissent les données de compteur interrogées au consommateur.</span><span class="sxs-lookup"><span data-stu-id="e9206-123">Create a performance DLL containing a set of exported functions that provide the queried counter data to the consumer.</span></span> <span data-ttu-id="e9206-124">Pour plus d’informations, consultez [création d’une DLL d’extension de performance](creating-a-performance-extension-dll.md).</span><span class="sxs-lookup"><span data-stu-id="e9206-124">For details, see [Creating a Performance Extension DLL](creating-a-performance-extension-dll.md).</span></span>
6. <span data-ttu-id="e9206-125">Modifiez le fichier d’installation de l’application pour automatiser l’ajout d’informations au registre (comme décrit à l’étape 4), puis copiez votre DLL de performance dans le répertoire de votre application lors de l’installation.</span><span class="sxs-lookup"><span data-stu-id="e9206-125">Modify the application's setup file to automate adding information to the registry (as described in step 4) and copy your performance DLL to your application's directory at setup.</span></span>

<span data-ttu-id="e9206-126">Pour plus d’informations sur les entrées de Registre supplémentaires, consultez [création d’autres entrées de Registre](creating-other-registry-entries.md).</span><span class="sxs-lookup"><span data-stu-id="e9206-126">For information about additional registry entries, see [Creating Other Registry Entries](creating-other-registry-entries.md).</span></span>
