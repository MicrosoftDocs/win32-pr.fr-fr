---
title: Mappages dans un pool de vignettes
description: Lorsqu’une ressource est créée avec l' \_ indicateur de mosaïque diverse de la ressource d3d11 \_ \_ , les vignettes qui composent la ressource proviennent d’un pointage sur des emplacements d’un pool de mosaïques.
ms.assetid: 1DBE23B2-A1E6-4491-9B74-4E92508A68FC
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1537113d6685e39cab94445c8d3f16d406638820
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104990908"
---
# <a name="mappings-are-into-a-tile-pool"></a><span data-ttu-id="4af15-103">Mappages dans un pool de vignettes</span><span class="sxs-lookup"><span data-stu-id="4af15-103">Mappings are into a tile pool</span></span>

<span data-ttu-id="4af15-104">Lorsqu’une ressource est créée avec l’indicateur de [**\_ \_ \_ mosaïque diverse de la ressource d3d11**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag) , les vignettes qui composent la ressource proviennent d’un pointage sur des emplacements d’un pool de mosaïques.</span><span class="sxs-lookup"><span data-stu-id="4af15-104">When a resource is created with the [**D3D11\_RESOURCE\_MISC\_TILED**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag) flag, the tiles that make up the resource come from pointing at locations in a tile pool.</span></span> <span data-ttu-id="4af15-105">Un pool de mosaïques est un pool de mémoire (sauvegardé par une ou plusieurs allocations en arrière-plan, non visible par l’application).</span><span class="sxs-lookup"><span data-stu-id="4af15-105">A tile pool is a pool of memory (backed by one or more allocations behind the scenes - unseen by the application).</span></span> <span data-ttu-id="4af15-106">Le système d’exploitation et le pilote d’affichage gèrent ce pool de mémoire, et l’encombrement mémoire est facilement compréhensible par une application.</span><span class="sxs-lookup"><span data-stu-id="4af15-106">The operating system and display driver manage this pool of memory, and the memory footprint is easily understood by an application.</span></span> <span data-ttu-id="4af15-107">Les ressources en mosaïque mappent des régions de 64 Ko en pointant sur des emplacements dans un pool de mosaïques.</span><span class="sxs-lookup"><span data-stu-id="4af15-107">Tiled resources map 64KB regions by pointing to locations in a tile pool.</span></span> <span data-ttu-id="4af15-108">Un Fallout de cette installation permet à plusieurs ressources de partager et réutiliser les mêmes vignettes, et également de réutiliser les mêmes vignettes à différents emplacements au sein d’une ressource, si vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="4af15-108">One fallout of this setup is it allows multiple resources to share and reuse the same tiles, and also for the same tiles to be reused at different locations within a resource if desired.</span></span>

<span data-ttu-id="4af15-109">Le coût de la flexibilité de remplissage des vignettes pour une ressource à partir d’un pool de mosaïques est que la ressource doit effectuer la définition et la maintenance du mappage des vignettes dans le pool de mosaïques pour représenter les vignettes nécessaires pour la ressource.</span><span class="sxs-lookup"><span data-stu-id="4af15-109">The cost for the flexibility of populating the tiles for a resource out of a tile pool is that the resource has to do the work of defining and maintaining the mapping of which tiles in the tile pool represent the tiles needed for the resource.</span></span> <span data-ttu-id="4af15-110">Les mappages de vignette peuvent être modifiés.</span><span class="sxs-lookup"><span data-stu-id="4af15-110">Tile mappings can be changed.</span></span> <span data-ttu-id="4af15-111">En outre, toutes les vignettes d’une ressource n’ont pas besoin d’être mappées à la fois ; une ressource peut avoir des mappages **null** .</span><span class="sxs-lookup"><span data-stu-id="4af15-111">Also, not all tiles in a resource need to be mapped at a time; a resource can have **NULL** mappings.</span></span> <span data-ttu-id="4af15-112">Un mappage **null** définit une vignette comme n’étant pas disponible du point de vue de la ressource qui y accède.</span><span class="sxs-lookup"><span data-stu-id="4af15-112">A **NULL** mapping defines a tile as not being available from the point of view of the resource accessing it.</span></span>

<span data-ttu-id="4af15-113">Vous pouvez créer plusieurs pools de mosaïques, et n’importe quel nombre de ressources en mosaïque peut être mappé à un pool de mosaïques donné en même temps.</span><span class="sxs-lookup"><span data-stu-id="4af15-113">Multiple tile pools can be created, and any number of tiled resources can map into any given tile pool at the same time.</span></span> <span data-ttu-id="4af15-114">Les pools de vignettes peuvent également être développés ou réduits.</span><span class="sxs-lookup"><span data-stu-id="4af15-114">Tile pools can also be grown or shrunk.</span></span> <span data-ttu-id="4af15-115">Pour plus d’informations, consultez [redimensionnement de pool de mosaïques](tile-pool-resizing.md).</span><span class="sxs-lookup"><span data-stu-id="4af15-115">For more info, see [Tile pool resizing](tile-pool-resizing.md).</span></span> <span data-ttu-id="4af15-116">Une contrainte qui existe pour simplifier l’implémentation du pilote d’affichage et du runtime est qu’une ressource en mosaïque donnée ne peut avoir que des mappages dans un seul pool de mosaïques à la fois (par opposition à un mappage simultané à plusieurs pools de mosaïques).</span><span class="sxs-lookup"><span data-stu-id="4af15-116">One constraint that exists to simplify display driver and runtime implementation is that a given tiled resource can only have mappings into at most one tile pool at a time (as opposed to having simultaneous mapping to multiple tile pools).</span></span>

<span data-ttu-id="4af15-117">La quantité de stockage associée à une ressource en mosaïque proprement dite (autrement dit, la mémoire de pool de mosaïques indépendante) est à peu près proportionnelle au nombre de vignettes réellement mappées au pool à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="4af15-117">The amount of storage that is associated with a tiled resource itself (that is, independent tile-pool memory) is roughly proportional to the number of tiles actually mapped to the pool at any given time.</span></span> <span data-ttu-id="4af15-118">Dans le matériel, cela se résume à la mise à l’échelle de l’empreinte mémoire pour le stockage des tables de pages avec la quantité de vignettes mappées (par exemple, en utilisant un modèle de table de pages à plusieurs niveaux, le cas échéant).</span><span class="sxs-lookup"><span data-stu-id="4af15-118">In hardware, this fact boils down to scaling the memory footprint for page table storage roughly with the amount of tiles that are mapped (for example, using a multilevel page table scheme as appropriate).</span></span>

<span data-ttu-id="4af15-119">Le pool de mosaïques peut être considéré comme une abstraction logicielle complète qui permet aux applications Direct3D de programmer efficacement les tables de pages sur l’unité de traitement graphique (GPU) sans avoir à connaître les détails d’implémentation de bas niveau (ou gérer directement les adresses de pointeur).</span><span class="sxs-lookup"><span data-stu-id="4af15-119">The tile pool can be thought of as an entirely software abstraction that enables Direct3D applications to effectively be able to program the page tables on the graphics processing unit (GPU) without having to know the low level implementation details (or deal with pointer addresses directly).</span></span> <span data-ttu-id="4af15-120">Les pools de mosaïques n’appliquent pas d’autres niveaux d’indirection dans le matériel.</span><span class="sxs-lookup"><span data-stu-id="4af15-120">Tile pools don't apply any additional levels of indirection in hardware.</span></span> <span data-ttu-id="4af15-121">Les optimisations d’une table de page de niveau unique à l’aide de constructions telles que des répertoires de pages sont indépendantes du concept de pool de mosaïques.</span><span class="sxs-lookup"><span data-stu-id="4af15-121">Optimizations of a single level page table using constructs like page directories are independent of the tile pool concept.</span></span>

<span data-ttu-id="4af15-122">Examinons le stockage que la table de page lui-même peut nécessiter dans le pire des cas (Toutefois, dans les implémentations de la pratique, vous n’avez besoin que d’un stockage à peu près proportionnel à ce qui est mappé).</span><span class="sxs-lookup"><span data-stu-id="4af15-122">Let us explore what storage the page table itself could require in the worst case (though in practice implementations only require storage roughly proportional to what is mapped).</span></span>

<span data-ttu-id="4af15-123">Supposons que chaque entrée de table de pages soit 64 bits.</span><span class="sxs-lookup"><span data-stu-id="4af15-123">Suppose each page table entry is 64 bits.</span></span>

<span data-ttu-id="4af15-124">Pour l’accès à la taille de la table de pages le plus défavorable pour une seule surface, étant donné les limites de ressources dans Direct3D 11, supposons qu’une ressource en mosaïque est créée avec un format de bit par élément de 128 (par exemple, un nombre maximal de bits), de sorte qu’une vignette de 64 Ko ne contient que 4096 pixels.</span><span class="sxs-lookup"><span data-stu-id="4af15-124">For the worst-case page table size hit for a single surface, given the resource limits in Direct3D 11, suppose a tiled resource is created with a 128 bit-per-element format (for example, a RGBA float), so a 64KB tile contains only 4096 pixels.</span></span> <span data-ttu-id="4af15-125">La taille de [**Texture2DArray**](/windows/desktop/direct3dhlsl/sm5-object-texture2darray) maximale prise en charge de 16384 \* 16384 \* 2048 (mais avec un seul mipmap) nécessite environ 1 Go de stockage dans la table de page en cas de remplissage complet (à l’exception de des mipmaps) à l’aide des entrées de table de bits 64.</span><span class="sxs-lookup"><span data-stu-id="4af15-125">The maximum supported [**Texture2DArray**](/windows/desktop/direct3dhlsl/sm5-object-texture2darray) size of 16384\*16384\*2048 (but with only a single mipmap) would require about 1GB of storage in the page table if fully populated (not including mipmaps) using 64 bit table entries.</span></span> <span data-ttu-id="4af15-126">L’ajout de des mipmaps augmenterait le stockage de table de pages entièrement mappé (cas le plus défavorable) d’une troisième, à environ 1,3 Go.</span><span class="sxs-lookup"><span data-stu-id="4af15-126">Adding mipmaps would grow the fully-mapped (worst case) page table storage by about a third, to about 1.3GB.</span></span>

<span data-ttu-id="4af15-127">Ce cas donne accès à environ 10,6 téraoctets de mémoire adressable.</span><span class="sxs-lookup"><span data-stu-id="4af15-127">This case would give access to about 10.6 terabytes of addressable memory.</span></span> <span data-ttu-id="4af15-128">Toutefois, il peut y avoir une limite sur la quantité de mémoire adressable, ce qui réduirait éventuellement les limites de la plage de téraoctets.</span><span class="sxs-lookup"><span data-stu-id="4af15-128">There might be a limit on the amount of addressable memory however, which would reduce these amounts, perhaps to around the terabyte range.</span></span>

<span data-ttu-id="4af15-129">Un autre cas à prendre en compte est une ressource en mosaïque [**Texture2D**](/windows/desktop/direct3dhlsl/sm5-object-texture2d) unique de 16384 \* 16384 avec un format binaire par élément de 32, y compris des mipmaps.</span><span class="sxs-lookup"><span data-stu-id="4af15-129">Another case to consider is a single [**Texture2D**](/windows/desktop/direct3dhlsl/sm5-object-texture2d) tiled resource of 16384\*16384 with a 32 bit-per-element format, including mipmaps.</span></span> <span data-ttu-id="4af15-130">L’espace nécessaire dans une table de pages entièrement remplie serait 170KB à peu près avec des entrées de table de bits 64.</span><span class="sxs-lookup"><span data-stu-id="4af15-130">The space needed in a fully populated page table would be roughly 170KB with 64 bit table entries.</span></span>

<span data-ttu-id="4af15-131">Enfin, prenons un exemple utilisant un format BC, par exemple BC7 avec 128 bits par mosaïque de 4 x 4.</span><span class="sxs-lookup"><span data-stu-id="4af15-131">Finally, consider an example using a BC format, say BC7 with 128 bits per tile of 4x4 pixels.</span></span> <span data-ttu-id="4af15-132">Il s’agit d’un octet par pixel.</span><span class="sxs-lookup"><span data-stu-id="4af15-132">That is one byte per pixel.</span></span> <span data-ttu-id="4af15-133">Un [**Texture2DArray**](/windows/desktop/direct3dhlsl/sm5-object-texture2darray) de 16384 \* 16384 \* 2048, y compris des MIPMAPS, nécessite environ 85MB pour remplir entièrement cette mémoire dans une table de pages.</span><span class="sxs-lookup"><span data-stu-id="4af15-133">A [**Texture2DArray**](/windows/desktop/direct3dhlsl/sm5-object-texture2darray) of 16384\*16384\*2048 including mipmaps would require roughly 85MB to fully populate this memory in a page table.</span></span> <span data-ttu-id="4af15-134">Cela n’est pas une mauvaise considération. cela permet à une ressource en mosaïque de s’étendre sur 550 gigapixels (512 Go de mémoire dans ce cas).</span><span class="sxs-lookup"><span data-stu-id="4af15-134">That is not bad considering this allows one tiled resource to span 550 gigapixels (512 GB of memory in this case).</span></span>

<span data-ttu-id="4af15-135">Dans la pratique, rien près de ces mappages complets serait défini, étant donné que la quantité de mémoire physique disponible ne permettrait pas à quelque point près qu’il soit possible de le mapper et de le référencer à la fois.</span><span class="sxs-lookup"><span data-stu-id="4af15-135">In practice, nowhere near these full mappings would be defined given that the amount of physical memory available wouldn't allow anywhere near that much to be mapped and referenced at a time.</span></span> <span data-ttu-id="4af15-136">Toutefois, avec un pool de mosaïques, les applications peuvent choisir de réutiliser les vignettes (en guise d’exemple simple, en réutilisant efficacement une vignette de couleur noire pour les grandes régions noires dans une image), en utilisant efficacement le pool de mosaïques (autrement dit, les mappages de tables de pages) comme un outil pour la compression de mémoire.</span><span class="sxs-lookup"><span data-stu-id="4af15-136">But with a tile pool, applications could choose to reuse tiles (as a simple example, reusing a "black" colored tile for large black regions in an image) - effectively using the tile pool (that is, page table mappings) as a tool for memory compression.</span></span>

<span data-ttu-id="4af15-137">Le contenu initial de la table de page a la **valeur null** pour toutes les entrées.</span><span class="sxs-lookup"><span data-stu-id="4af15-137">The initial contents of the page table are **NULL** for all entries.</span></span> <span data-ttu-id="4af15-138">Les applications ne peuvent pas non plus transmettre des données initiales pour le contenu de la mémoire de l’aire, car elles démarrent sans stockage de mémoire.</span><span class="sxs-lookup"><span data-stu-id="4af15-138">Applications also can't pass initial data for the memory contents of the surface since it starts off with no memory backing.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="4af15-139">Contenu de cette section</span><span class="sxs-lookup"><span data-stu-id="4af15-139">In this section</span></span>



| <span data-ttu-id="4af15-140">Rubrique</span><span class="sxs-lookup"><span data-stu-id="4af15-140">Topic</span></span>                                                                                                   | <span data-ttu-id="4af15-141">Description</span><span class="sxs-lookup"><span data-stu-id="4af15-141">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                |
|---------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="4af15-142">Création d’un pool de vignettes</span><span class="sxs-lookup"><span data-stu-id="4af15-142">Tile pool creation</span></span>](tile-pool-creation.md)<br/>                                                 | <span data-ttu-id="4af15-143">Un pool de mosaïques est créé via l’API [**ID3D11Device :: CreateBuffer**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createbuffer) en passant l’indicateur de [**\_ \_ \_ \_ pool de mosaïques divers de la ressource d3d11**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag) dans le membre **MiscFlags** de  la structure [**\_ \_ desc de mémoire tampon d3d11**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_buffer_desc) vers laquelle pointe le paramètre pDesc.</span><span class="sxs-lookup"><span data-stu-id="4af15-143">A tile pool is created via the [**ID3D11Device::CreateBuffer**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createbuffer) API by passing the [**D3D11\_RESOURCE\_MISC\_TILE\_POOL**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag) flag in the **MiscFlags** member of the [**D3D11\_BUFFER\_DESC**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_buffer_desc) structure that the *pDesc* parameter points to.</span></span> <br/> |
| [<span data-ttu-id="4af15-144">Redimensionnement d’un pool de vignettes</span><span class="sxs-lookup"><span data-stu-id="4af15-144">Tile pool resizing</span></span>](tile-pool-resizing.md)<br/>                                                 | <span data-ttu-id="4af15-145">Utilisez l’API [**ID3D11DeviceContext2 :: ResizeTilePool**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-resizetilepool) pour augmenter un pool de mosaïques si l’application a besoin d’une plus grande plage de travail pour le mappage des ressources en mosaïque, ou pour réduire l’espace nécessaire.</span><span class="sxs-lookup"><span data-stu-id="4af15-145">Use the [**ID3D11DeviceContext2::ResizeTilePool**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-resizetilepool) API to grow a tile pool if the application needs more working set for the tiled resources mapping into it or to shrink if less space is needed.</span></span> <br/>                                                                                                                    |
| [<span data-ttu-id="4af15-146">Suivi des risques ou ressources d’un pool de vignettes</span><span class="sxs-lookup"><span data-stu-id="4af15-146">Hazard tracking versus tile pool resources</span></span>](hazard-tracking-versus-tile-pool-resources.md)<br/> | <span data-ttu-id="4af15-147">Pour les ressources qui ne sont pas en mosaïque, Direct3D peut empêcher certaines conditions de danger pendant le rendu, mais comme le suivi des risques se trouve au niveau de la mosaïque pour les ressources en mosaïque, le suivi des conditions de danger lors du rendu des ressources en mosaïque peut être trop onéreux.</span><span class="sxs-lookup"><span data-stu-id="4af15-147">For non-tiled resources, Direct3D can prevent certain hazard conditions during rendering, but because hazard tracking would be at a tile level for tiled resources, tracking hazard conditions during rendering of tiled resources might be too expensive.</span></span> <br/>                                                                                                     |



 

## <a name="related-topics"></a><span data-ttu-id="4af15-148">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="4af15-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4af15-149">Création de ressources en mosaïque</span><span class="sxs-lookup"><span data-stu-id="4af15-149">Creating tiled resources</span></span>](creating-tiled-resources.md)
</dt> </dl>

 

