---
title: Restrictions d’accès aux vignettes avec des mappages en double
description: Cette section décrit les limitations d’accès aux vignettes avec des mappages en double.
ms.assetid: 7A498E0D-9151-4A89-B7C3-C4F476457D17
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0909b0d10e286e5f774f6893b692abdeb19d3ef7
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104028732"
---
# <a name="tile-access-limitations-with-duplicate-mappings"></a><span data-ttu-id="df11b-103">Restrictions d’accès aux vignettes avec des mappages en double</span><span class="sxs-lookup"><span data-stu-id="df11b-103">Tile access limitations with duplicate mappings</span></span>

<span data-ttu-id="df11b-104">Cette section décrit les limitations d’accès aux vignettes avec des mappages en double.</span><span class="sxs-lookup"><span data-stu-id="df11b-104">This section describes tile access limitations with duplicate mappings.</span></span>

## <a name="copying-tiled-resources-with-overlapping-source-and-destination"></a><span data-ttu-id="df11b-105">Copie de ressources en mosaïque avec la source et la destination qui se chevauchent</span><span class="sxs-lookup"><span data-stu-id="df11b-105">Copying tiled resources with overlapping source and destination</span></span>

<span data-ttu-id="df11b-106">Si les vignettes de la zone source et de destination d’une opération de copie \* ont des mappages dupliqués dans la zone de copie qui auraient été chevauchés même si les deux ressources n’étaient pas des ressources en mosaïque et que l’opération de copie \* prend en charge les copies qui se chevauchent, l’opération de copie \* se comportera comme si la source était copiée dans un emplacement temporaire avant</span><span class="sxs-lookup"><span data-stu-id="df11b-106">If tiles in the source and destination area of a Copy\* operation have duplicated mappings in the copy area that would have overlapped even if both resources were not tiled resources and the Copy\* operation supports overlapping copies, the Copy\* operation will behave fine (as if the source is copied to a temporary location before going to the destination).</span></span> <span data-ttu-id="df11b-107">Toutefois, si le chevauchement n’est pas évident (comme les ressources source et de destination diffèrent, mais que les mappages de partage ou les mappages sont dupliqués sur une surface donnée), les résultats de l’opération de copie sur les vignettes partagées ne sont pas définis.</span><span class="sxs-lookup"><span data-stu-id="df11b-107">But if the overlap is not obvious (like the source and destination resources are different but share mappings or mappings are duplicated over a given surface), results of the copy operation on the tiles that are shared are undefined.</span></span>

## <a name="copying-to-tiled-resource-with-duplicated-tiles-in-destination-area"></a><span data-ttu-id="df11b-108">Copie vers une ressource en mosaïque avec des vignettes dupliquées dans la zone de destination</span><span class="sxs-lookup"><span data-stu-id="df11b-108">Copying to tiled resource with duplicated tiles in destination area</span></span>

<span data-ttu-id="df11b-109">La copie vers une ressource en mosaïque avec des vignettes en double dans la zone de destination produit des résultats non définis dans ces vignettes, sauf si les données elles-mêmes sont identiques ; différentes vignettes peuvent écrire les vignettes dans des ordres différents.</span><span class="sxs-lookup"><span data-stu-id="df11b-109">Copying to a tiled resource with duplicated tiles in the destination area produces undefined results in these tiles unless the data itself is identical; different tiles might write the tiles in different orders.</span></span>

## <a name="uav-accesses-to-duplicate-tiles-mappings"></a><span data-ttu-id="df11b-110">UAV accède aux mappages de vignettes dupliquées</span><span class="sxs-lookup"><span data-stu-id="df11b-110">UAV accesses to duplicate tiles mappings</span></span>

<span data-ttu-id="df11b-111">Supposons qu’une vue d’accès non ordonnée (UAV) sur une ressource en mosaïque possède des mappages de vignettes en double dans sa zone ou avec d’autres ressources liées au pipeline.</span><span class="sxs-lookup"><span data-stu-id="df11b-111">Suppose an unordered access view (UAV) on a tiled resource has duplicate tile mappings in its area or with other resources bound to the pipeline.</span></span> <span data-ttu-id="df11b-112">Le classement des accès à ces vignettes dupliquées n’est pas défini si elle est effectuée par différents threads, tout comme n’importe quel ordre d’accès mémoire à UAVs en général n’est pas ordonné.</span><span class="sxs-lookup"><span data-stu-id="df11b-112">Ordering of accesses to these duplicated tiles is undefined if performed by different threads, just as any ordering of memory access to UAVs in general is unordered.</span></span>

## <a name="rendering-after-tile-mapping-changes-or-content-updates-from-outside-mappings"></a><span data-ttu-id="df11b-113">Rendu après modification du mappage des vignettes ou mises à jour du contenu à partir des mappages externes</span><span class="sxs-lookup"><span data-stu-id="df11b-113">Rendering after tile mapping changes or content updates from outside mappings</span></span>

<span data-ttu-id="df11b-114">Si les mappages de vignette d’une ressource en mosaïque ont changé ou que le contenu des vignettes de pool en mosaïque mappées a été modifié par le biais de mappages d’une autre ressource en mosaïque, et la ressource en mosaïque va être rendue via la vue de la cible de rendu ou la vue du stencil de profondeur, l’application doit effacer (à l’aide des API de suppression de fonction fixe) ou copier entièrement à l’aide des API de copie \* /Update \* les vignettes qui ont changé dans la zone rendue (mappée ou non).</span><span class="sxs-lookup"><span data-stu-id="df11b-114">If a tiled resource's tile mappings have changed or content in mapped tiled pool tiles have changed via another tiled resource's mappings, and the tiled resource is going to be rendered via render target view or depth stencil view, the application must Clear (using the fixed function Clear APIs) or fully copy over using Copy\*/Update\* APIs the tiles that have changed within the area being rendered (mapped or not).</span></span> <span data-ttu-id="df11b-115">Si une application ne peut pas être effacée ou copiée dans ces cas de figure, les structures d’optimisation matérielle de la vue de cible de rendu donnée ou de la vue du stencil de profondeur sont obsolètes, ce qui entraîne un rendu du garbage collector sur un matériel et une incohérence sur différents matériels.</span><span class="sxs-lookup"><span data-stu-id="df11b-115">Failure of an application to clear or copy in these cases results in hardware optimization structures for the given render target view or depth stencil view being stale and will result in garbage rendering results on some hardware and inconsistency across different hardware.</span></span> <span data-ttu-id="df11b-116">Ces structures de données d’optimisation masquées utilisées par le matériel peuvent être locales à des mappages individuels et ne pas être visibles par d’autres mappages dans la même mémoire.</span><span class="sxs-lookup"><span data-stu-id="df11b-116">These hidden optimization data structures used by hardware might be local to individual mappings and not visible to other mappings to the same memory.</span></span>

<span data-ttu-id="df11b-117">L’opération [**ID3D11DeviceContext1 :: Clearview**](/windows/desktop/api/D3D11_1/nf-d3d11_1-id3d11devicecontext1-clearview) prend en charge l’effacement des vues de cible de rendu avec des rectangles.</span><span class="sxs-lookup"><span data-stu-id="df11b-117">The [**ID3D11DeviceContext1::ClearView**](/windows/desktop/api/D3D11_1/nf-d3d11_1-id3d11devicecontext1-clearview) operation supports clearing render target views with rectangles.</span></span> <span data-ttu-id="df11b-118">Pour le matériel qui prend en charge les ressources en mosaïque, **Clearview** doit également prendre en charge l’effacement des vues de stencil de profondeur avec des rectangles, pour des surfaces de profondeur uniquement (sans stencil).</span><span class="sxs-lookup"><span data-stu-id="df11b-118">For hardware that supports tiled resources, **ClearView** must also support clearing of depth stencil views with rectangles, for depth only surfaces (without stencil).</span></span> <span data-ttu-id="df11b-119">Cette opération permet aux applications d’effacer uniquement la zone nécessaire d’une surface.</span><span class="sxs-lookup"><span data-stu-id="df11b-119">This operation allows applications to clear only the necessary area of a surface.</span></span>

<span data-ttu-id="df11b-120">Si une application doit conserver le contenu existant de la mémoire des zones d’une ressource en mosaïque dans laquelle les mappages ont changé, cette application doit contourner l’exigence évidente.</span><span class="sxs-lookup"><span data-stu-id="df11b-120">If an application needs to preserve existing memory contents of areas in a tiled resource where mappings have changed, that application must work around the clear requirement.</span></span> <span data-ttu-id="df11b-121">L’application peut effectuer cette opération en enregistrant d’abord le contenu dans lequel les mappages de vignettes ont changé (en les copiant sur une surface temporaire, par exemple, à l’aide de [**ID3D11DeviceContext2 :: CopyTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles)), en émettant la commande Clear requise, puis en recopiant le contenu.</span><span class="sxs-lookup"><span data-stu-id="df11b-121">The application can accomplish this work-around by first saving the contents where tile mappings have changed (by copying them to a temporary surface, for example, by using [**ID3D11DeviceContext2::CopyTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles)), issuing the required clear command and then copying the contents back.</span></span> <span data-ttu-id="df11b-122">Bien que cela accomplisse la tâche de préservation du contenu de surface pour le rendu incrémentiel, l’inconvénient est que les performances de rendu suivantes sur la surface peuvent être affectées, car les optimisations de rendu peuvent être perdues.</span><span class="sxs-lookup"><span data-stu-id="df11b-122">While this would accomplish the task of preserving surface contents for incremental rendering, the downside is that subsequent rendering performance on the surface might suffer because rendering optimizations might be lost.</span></span>

<span data-ttu-id="df11b-123">Si une vignette est mappée en plusieurs ressources en mosaïque en même temps et que le contenu de la mosaïque est manipulé par quelque moyen que ce soit (rendu, copie, etc.) via l’une des ressources en mosaïque, si la même vignette doit être restituée par le biais d’une autre ressource en mosaïque, la vignette doit être effacée en premier, comme décrit précédemment.</span><span class="sxs-lookup"><span data-stu-id="df11b-123">If a tile is mapped into multiple tiled resources at the same time and tile contents are manipulated by any means (render, copy, and so on) via one of the tiled resources, if the same tile is to be rendered via any other tiled resource, the tile must be cleared first as previously described.</span></span>

## <a name="rendering-to-tiles-shared-outside-render-area"></a><span data-ttu-id="df11b-124">Rendu sur des vignettes partagées en dehors de la zone de rendu</span><span class="sxs-lookup"><span data-stu-id="df11b-124">Rendering to tiles shared outside render area</span></span>

<span data-ttu-id="df11b-125">Supposons qu’une zone d’une ressource en mosaïque soit rendue et que les vignettes du pool de mosaïques référencées par la zone de rendu soient également mappées à depuis l’extérieur de la zone de rendu (y compris via d’autres ressources en mosaïque, en même temps ou non).</span><span class="sxs-lookup"><span data-stu-id="df11b-125">Suppose an area in a tiled resource is being rendered to and the tile pool tiles referenced by the render area are also mapped to from outside the render area (including via other tiled resources, at the same time or not).</span></span> <span data-ttu-id="df11b-126">Il n’est pas garanti que les données rendues à ces vignettes s’affichent correctement quand elles sont consultées via les autres mappages, même si la disposition de mémoire sous-jacente est compatible.</span><span class="sxs-lookup"><span data-stu-id="df11b-126">Data rendered to these tiles isn't guaranteed to appear correctly when viewed through the other mappings, even though the underlying memory layout is compatible.</span></span> <span data-ttu-id="df11b-127">Ce fait est dû à des structures de données d’optimisation qui peuvent être utilisées en local pour les mappages individuels des surfaces pouvant être rendues et non visibles par d’autres mappages vers le même emplacement de mémoire.</span><span class="sxs-lookup"><span data-stu-id="df11b-127">This fact is due to optimization data structures some hardware use that can be local to individual mappings for renderable surfaces and not visible to other mappings to the same memory location.</span></span> <span data-ttu-id="df11b-128">Vous pouvez contourner cette restriction en copiant le mappage rendu à tous les autres mappages dans la même mémoire que celle qui est accessible (ou en effaçant cette mémoire ou en copiant d’autres données vers celle-ci si l’ancien contenu n’est plus nécessaire).</span><span class="sxs-lookup"><span data-stu-id="df11b-128">You can work around this restriction by copying from the rendered mapping to all the other mappings to the same memory that might be accessed (or clearing that memory or copying other data to it if the old contents are no longer needed).</span></span> <span data-ttu-id="df11b-129">Bien que cette solution semble redondante, elle permet à tous les autres mappages de la même mémoire de comprendre correctement comment accéder à son contenu, et au moins l’économie de mémoire qui consiste à avoir une seule sauvegarde de mémoire physique reste intacte.</span><span class="sxs-lookup"><span data-stu-id="df11b-129">While this work-around seems redundant, it makes all other mappings to the same memory correctly understand how to access its contents, and at least the memory savings of having only a single physical memory backing remains intact.</span></span> <span data-ttu-id="df11b-130">En outre, lorsque vous basculez entre l’utilisation de différentes ressources en mosaïque qui partagent des mappages (sauf lecture uniquement), vous devez appeler l’API [**ID3D11DeviceContext2 :: TiledResourceBarrier**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier) dans entre les commutateurs.</span><span class="sxs-lookup"><span data-stu-id="df11b-130">Also, when you switch between using different tiled resources that share mappings (unless only reading), you must call the [**ID3D11DeviceContext2::TiledResourceBarrier**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier) API in between the switches.</span></span>

## <a name="rendering-to-tiles-shared-within-render-area"></a><span data-ttu-id="df11b-131">Rendu des vignettes partagées dans la zone de rendu</span><span class="sxs-lookup"><span data-stu-id="df11b-131">Rendering to tiles shared within render area</span></span>

<span data-ttu-id="df11b-132">Si une zone d’une ressource en mosaïque est rendue dans et dans la zone de rendu, plusieurs mosaïques sont mappées au même emplacement du pool de mosaïques, les résultats de rendu ne sont pas définis sur ces vignettes.</span><span class="sxs-lookup"><span data-stu-id="df11b-132">If an area in a tiled resource is being rendered to and within the render area multiple tiles are mapped to the same tile pool location, rendering results are undefined on those tiles.</span></span>

## <a name="data-compatibility-across-tiled-resources-sharing-tiles"></a><span data-ttu-id="df11b-133">Compatibilité des données sur des ressources en mosaïque partageant des vignettes</span><span class="sxs-lookup"><span data-stu-id="df11b-133">Data compatibility across tiled resources sharing tiles</span></span>

<span data-ttu-id="df11b-134">Supposons que plusieurs ressources en mosaïque ont des mappages aux mêmes emplacements de pool de mosaïques et que chaque ressource est utilisée pour accéder aux mêmes données.</span><span class="sxs-lookup"><span data-stu-id="df11b-134">Suppose multiple tiled resources have mappings to the same tile pool locations and each resource is used to access the same data.</span></span> <span data-ttu-id="df11b-135">Ce scénario n’est valide que si les autres règles relatives à l’évitement des problèmes avec les structures d’optimisation matérielle sont évitées, les appels appropriés à [**ID3D11DeviceContext2 :: TiledResourceBarrier**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier) sont effectués et les ressources en mosaïque sont compatibles les unes avec les autres.</span><span class="sxs-lookup"><span data-stu-id="df11b-135">This scenario is only valid if the other rules about avoiding problems with hardware optimization structures are avoided, appropriate calls to [**ID3D11DeviceContext2::TiledResourceBarrier**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier) are made, and the tiled resources are compatible with each other.</span></span> <span data-ttu-id="df11b-136">Ce dernier est décrit ici en ce qui concerne les ressources en mosaïque partageant des vignettes pour être incompatibles.</span><span class="sxs-lookup"><span data-stu-id="df11b-136">The latter is described here in terms of what it means for tiled resources sharing tiles to be incompatible.</span></span> <span data-ttu-id="df11b-137">Les conditions d’incompatibilité d’accès aux mêmes données sur les mappages de vignettes dupliquées sont l’utilisation de différentes dimensions ou de différents formats de surface, ou de différences en présence d’indicateurs de liaison de cible de rendu ou de stencil de profondeur sur les ressources.</span><span class="sxs-lookup"><span data-stu-id="df11b-137">The incompatibility conditions of accessing the same data across duplicate tile mappings are the use of different surface dimensions or format, or differences in the presence of render target or depth stencil bind flags on the resources.</span></span> <span data-ttu-id="df11b-138">L’écriture dans la mémoire avec un type de mappage produit des résultats non définis si, par la suite, vous lisez ou effectuez le rendu via un mappage à partir d’une ressource incompatible.</span><span class="sxs-lookup"><span data-stu-id="df11b-138">Writing to the memory with one type of mapping produces undefined results if you subsequently read or render via a mapping from an incompatible resource.</span></span> <span data-ttu-id="df11b-139">Si les autres mappages de partage de ressources sont d’abord initialisés avec de nouvelles données (en recyclant la mémoire à un autre usage), l’opération de lecture ou de rendu suivante est correcte, car les données ne sont pas réparties sur les interprétations non compatibles.</span><span class="sxs-lookup"><span data-stu-id="df11b-139">If the other resource sharing mappings are first initialized with new data (recycling the memory for a different purpose), the subsequent read or render operation is fine since data isn't bleeding across incompatible interpretations.</span></span> <span data-ttu-id="df11b-140">Toutefois, vous devez appeler l’API **TiledResourceBarrier** quand vous basculez entre l’accès aux mappages non compatibles comme celui-ci.</span><span class="sxs-lookup"><span data-stu-id="df11b-140">But, you must call the **TiledResourceBarrier** API when you switch between accessing incompatible mappings like this.</span></span>

<span data-ttu-id="df11b-141">Si l’indicateur de liaison de la cible de rendu ou du stencil de profondeur n’est défini sur aucune des ressources partageant les mappages entre eux, il y a beaucoup moins de restrictions.</span><span class="sxs-lookup"><span data-stu-id="df11b-141">If the render target or depth stencil bind flag isn't set on any of the resources sharing mappings with each other, there are far fewer restrictions.</span></span> <span data-ttu-id="df11b-142">Tant que les types de format et de surface (par exemple, Texture2D) sont identiques, les vignettes peuvent être partagées.</span><span class="sxs-lookup"><span data-stu-id="df11b-142">As long as the format and surface types (for example, Texture2D) are the same, tiles can be shared.</span></span> <span data-ttu-id="df11b-143">Les différents formats compatibles sont des cas tels que \* les surfaces BC et la taille équivalente non compressée 32 bits ou 16 bits par composant, comme BC6H et R32G32B32A32.</span><span class="sxs-lookup"><span data-stu-id="df11b-143">Different formats being compatible are cases such as BC\* surfaces and the equivalent sized uncompressed 32 bit or 16 bit per component format, like BC6H and R32G32B32A32.</span></span> <span data-ttu-id="df11b-144">Un grand nombre de formats de 32 bits par élément peuvent également être associés à R32 \_ \* (R10G10B10A2 \_ \* , R8G8B8A8 \_ \* , B8G8R8A8 \_ \* , B8G8R8X8 \_ \* , R16G16 \_ \* ); cette opération a toujours été autorisée pour les ressources qui ne sont pas en mosaïque.</span><span class="sxs-lookup"><span data-stu-id="df11b-144">Many 32 bit per element formats can be aliased with R32\_\* as well (R10G10B10A2\_\*, R8G8B8A8\_\*, B8G8R8A8\_\*,B8G8R8X8\_\*,R16G16\_\*); this operation has always been allowed for non-tiled resources.</span></span>

<span data-ttu-id="df11b-145">Le partage entre les vignettes compressées et non compressées est parfait si les formats sont compatibles et les vignettes sont remplies avec une couleur unie.</span><span class="sxs-lookup"><span data-stu-id="df11b-145">Sharing between packed and non-packed tiles is fine if the formats are compatible and the tiles are filled with solid color.</span></span>

<span data-ttu-id="df11b-146">Enfin, si rien n’est courant concernant les ressources partageant les mappages de vignette, sauf qu’aucun n’a de cibles de rendu ou d’indicateurs de liaison de stencil de profondeur, seule la mémoire remplie avec 0 peut être partagée en toute sécurité ; le mappage apparaît comme un décodage de 0 pour la définition du format de ressource donné (en général, il s’agit simplement de 0).</span><span class="sxs-lookup"><span data-stu-id="df11b-146">Finally, if nothing is common about the resources sharing tile mappings except that none have render target or depth stencil bind flags, only memory filled with 0 can be shared safely; the mapping will appear as whatever 0 decodes to for the definition of the given resource format (typically just 0).</span></span>

## <a name="related-topics"></a><span data-ttu-id="df11b-147">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="df11b-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="df11b-148">Accès du pipeline aux ressources en mosaïque</span><span class="sxs-lookup"><span data-stu-id="df11b-148">Pipeline access to tiled resources</span></span>](pipeline-access-to-tiled-resources.md)
</dt> </dl>

 

 




