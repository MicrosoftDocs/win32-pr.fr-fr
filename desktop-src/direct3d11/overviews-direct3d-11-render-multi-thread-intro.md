---
title: Introduction au multithreading dans Direct3D 11
description: Le multithreading est conçu pour améliorer les performances en effectuant un travail à l’aide d’un ou plusieurs threads en même temps.
ms.assetid: b4bef1e4-8d34-455c-8aed-01af974c66c8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 527b78d8b29a507247c8eb067c20739004ace687
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315198"
---
# <a name="introduction-to-multithreading-in-direct3d-11"></a><span data-ttu-id="d1399-103">Introduction au multithreading dans Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="d1399-103">Introduction to Multithreading in Direct3D 11</span></span>

<span data-ttu-id="d1399-104">Le multithreading est conçu pour améliorer les performances en effectuant un travail à l’aide d’un ou plusieurs threads en même temps.</span><span class="sxs-lookup"><span data-stu-id="d1399-104">Multithreading is designed to improve performance by performing work using one or more threads at the same time.</span></span>

<span data-ttu-id="d1399-105">Dans le passé, cela a souvent été fait en générant un seul thread principal pour le rendu et un ou plusieurs threads pour effectuer des tâches de préparation telles que la création d’objets, le chargement, le traitement, etc.</span><span class="sxs-lookup"><span data-stu-id="d1399-105">In the past, this has often been done by generating a single main thread for rendering and one or more threads for doing preparation work such as object creation, loading, processing, and so on.</span></span> <span data-ttu-id="d1399-106">Toutefois, avec la synchronisation intégrée dans Direct3D 11, l’objectif de l’utilisation de multithreads est d’utiliser tous les PROCESSEURs et tous les cycles GPU sans qu’un processeur n’attende un autre processeur (en particulier, le GPU n’est pas en attente, car il a un impact direct sur la fréquence d’images).</span><span class="sxs-lookup"><span data-stu-id="d1399-106">However, with the built in synchronization in Direct3D 11, the goal behind multithreading is to utilize every CPU and GPU cycle without making a processor wait for another processor (particularly not making the GPU wait because it directly impacts frame rate).</span></span> <span data-ttu-id="d1399-107">En procédant ainsi, vous pouvez générer la plus grande quantité de travail tout en conservant la meilleure fréquence d’images.</span><span class="sxs-lookup"><span data-stu-id="d1399-107">By doing so, you can generate the most amount of work while maintaining the best frame rate.</span></span> <span data-ttu-id="d1399-108">Le concept d’une trame unique pour le rendu n’est plus nécessaire, car l’API implémente la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="d1399-108">The concept of a single frame for rendering is no longer as necessary since the API implements synchronization.</span></span>

<span data-ttu-id="d1399-109">Le multithreading requiert une certaine forme de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="d1399-109">Multithreading requires some form of synchronization.</span></span> <span data-ttu-id="d1399-110">Par exemple, si plusieurs threads qui s’exécutent dans une application doivent accéder à un seul contexte de périphérique ([**ID3D11DeviceContext**](/windows/desktop/api/D3D11/nn-d3d11-id3d11devicecontext)), cette application doit utiliser un mécanisme de synchronisation, tel que les sections critiques, pour synchroniser l’accès à ce contexte de périphérique.</span><span class="sxs-lookup"><span data-stu-id="d1399-110">For example, if multiple threads that run in an application must access a single device context ([**ID3D11DeviceContext**](/windows/desktop/api/D3D11/nn-d3d11-id3d11devicecontext)), that application must use some synchronization mechanism, such as critical sections, to synchronize access to that device context.</span></span> <span data-ttu-id="d1399-111">Cela est dû au fait que le traitement des commandes de rendu (généralement effectuées sur le GPU) et la génération des commandes de rendu (effectuées généralement sur le processeur via la création d’objets, le chargement des données, la modification d’État, le traitement des données) utilisent souvent les mêmes ressources (textures, nuanceurs, état du pipeline, etc.).</span><span class="sxs-lookup"><span data-stu-id="d1399-111">This is because processing of the render commands (generally done on the GPU) and generating the render commands (generally done on the CPU through object creation, data loading, state changing, data processing) often use the same resources (textures, shaders, pipeline state, and so on).</span></span> <span data-ttu-id="d1399-112">L’organisation du travail entre plusieurs threads nécessite une synchronisation pour empêcher un thread de modifier ou de lire des données qui sont modifiées par un autre thread.</span><span class="sxs-lookup"><span data-stu-id="d1399-112">Organizing the work across multiple threads requires synchronization to prevent one thread from modifying or reading data that is being modified by another thread.</span></span>

<span data-ttu-id="d1399-113">Alors que l’utilisation d’un contexte de périphérique ([**ID3D11DeviceContext**](/windows/desktop/api/D3D11/nn-d3d11-id3d11devicecontext)) n’est pas thread-safe, l’utilisation d’un appareil Direct3D 11 ([**ID3D11Device**](/windows/desktop/api/D3D11/nn-d3d11-id3d11device)) est thread-safe.</span><span class="sxs-lookup"><span data-stu-id="d1399-113">While the use of a device context ([**ID3D11DeviceContext**](/windows/desktop/api/D3D11/nn-d3d11-id3d11devicecontext)) is not thread-safe, the use of a Direct3D 11 device ([**ID3D11Device**](/windows/desktop/api/D3D11/nn-d3d11-id3d11device)) is thread-safe.</span></span> <span data-ttu-id="d1399-114">Étant donné que chaque **ID3D11DeviceContext** est mono-thread, un seul thread peut appeler un **ID3D11DeviceContext** à la fois.</span><span class="sxs-lookup"><span data-stu-id="d1399-114">Because each **ID3D11DeviceContext** is single threaded, only one thread can call a **ID3D11DeviceContext** at a time.</span></span> <span data-ttu-id="d1399-115">Si plusieurs threads doivent accéder à un seul **ID3D11DeviceContext**, ils doivent utiliser un mécanisme de synchronisation, tel que les sections critiques, pour synchroniser l’accès à ce **ID3D11DeviceContext**.</span><span class="sxs-lookup"><span data-stu-id="d1399-115">If multiple threads must access a single **ID3D11DeviceContext**, they must use some synchronization mechanism, such as critical sections, to synchronize access to that **ID3D11DeviceContext**.</span></span> <span data-ttu-id="d1399-116">Toutefois, plusieurs threads ne sont pas tenus d’utiliser des sections critiques ou des primitives de synchronisation pour accéder à un seul **ID3D11Device**.</span><span class="sxs-lookup"><span data-stu-id="d1399-116">However, multiple threads are not required to use critical sections or synchronization primitives to access a single **ID3D11Device**.</span></span> <span data-ttu-id="d1399-117">Par conséquent, si une application utilise **ID3D11Device** pour créer des objets de ressource, cette application n’est pas obligée d’utiliser la synchronisation pour créer plusieurs objets de ressource en même temps.</span><span class="sxs-lookup"><span data-stu-id="d1399-117">Therefore, if an application uses **ID3D11Device** to create resource objects, that application is not required to use synchronization to create multiple resource objects at the same time.</span></span>

<span data-ttu-id="d1399-118">La prise en charge du multithreading divise l’API en deux zones fonctionnelles distinctes :</span><span class="sxs-lookup"><span data-stu-id="d1399-118">Multithreading support divides the API into two distinct functional areas:</span></span>

-   [<span data-ttu-id="d1399-119">Création d’objets avec multithread</span><span class="sxs-lookup"><span data-stu-id="d1399-119">Object Creation with Multithreading</span></span>](overviews-direct3d-11-render-multi-thread-create.md)
-   [<span data-ttu-id="d1399-120">Rendu immédiat et différé</span><span class="sxs-lookup"><span data-stu-id="d1399-120">Immediate and Deferred Rendering</span></span>](overviews-direct3d-11-render-multi-thread-render.md)

<span data-ttu-id="d1399-121">Les performances du multithreading dépendent de la prise en charge du pilote.</span><span class="sxs-lookup"><span data-stu-id="d1399-121">Multithreading performance depends on the driver support.</span></span> <span data-ttu-id="d1399-122">[Procédure : vérifier la prise en charge des pilotes](overviews-direct3d-11-render-multi-thread-support.md) fournit plus d’informations sur l’interrogation du pilote et sur la signification des résultats.</span><span class="sxs-lookup"><span data-stu-id="d1399-122">[How To: Check for Driver Support](overviews-direct3d-11-render-multi-thread-support.md) provides more information about querying the driver and what the results mean.</span></span>

<span data-ttu-id="d1399-123">Direct3D 11 a été conçu dès le départ pour prendre en charge le multithreading.</span><span class="sxs-lookup"><span data-stu-id="d1399-123">Direct3D 11 has been designed from the ground up to support multithreading.</span></span> <span data-ttu-id="d1399-124">Direct3D 10 implémente une prise en charge limitée du multithreading à l’aide de la [couche thread-safe](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-api-features-layers).</span><span class="sxs-lookup"><span data-stu-id="d1399-124">Direct3D 10 implements limited support for multithreading using the [thread-safe layer](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-api-features-layers).</span></span> <span data-ttu-id="d1399-125">Cette page répertorie les différences de comportement entre les deux versions de DirectX : [différences de Threading entre les versions Direct3D](overviews-direct3d-11-render-multi-thread-differences.md).</span><span class="sxs-lookup"><span data-stu-id="d1399-125">This page lists the behavior differences between the two versions of DirectX: [Threading Differences between Direct3D Versions](overviews-direct3d-11-render-multi-thread-differences.md).</span></span>

## <a name="multithreading-and-dxgi"></a><span data-ttu-id="d1399-126">Multithread et DXGI</span><span class="sxs-lookup"><span data-stu-id="d1399-126">Multithreading and DXGI</span></span>

<span data-ttu-id="d1399-127">Un seul thread à la fois doit utiliser le contexte immédiat.</span><span class="sxs-lookup"><span data-stu-id="d1399-127">Only one thread at a time should use the immediate context.</span></span> <span data-ttu-id="d1399-128">Toutefois, votre application doit également utiliser ce même thread pour les opérations Microsoft DirectX Graphics infrastructure (DXGI), surtout lorsque l’application effectue des appels à la méthode [**IDXGISwapChain ::P**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present) revertie.</span><span class="sxs-lookup"><span data-stu-id="d1399-128">However, your application should also use that same thread for Microsoft DirectX Graphics Infrastructure (DXGI) operations, especially when the application makes calls to the [**IDXGISwapChain::Present**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present) method.</span></span>

> [!Note]  
> <span data-ttu-id="d1399-129">L’utilisation simultanée d’un contexte immédiat avec la plupart des fonctions d’interface DXGI n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="d1399-129">It is invalid to use an immediate context concurrently with most of the DXGI interface functions.</span></span> <span data-ttu-id="d1399-130">Pour les SDK DirectX de mars 2009 et versions ultérieures, les seules fonctions DXGI sécurisées sont [**AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref), [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release)et [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="d1399-130">For the March 2009 and later DirectX SDKs, the only DXGI functions that are safe are [**AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref), [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release), and [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span>

 

<span data-ttu-id="d1399-131">Pour plus d’informations sur l’utilisation de DXGI avec plusieurs threads, consultez [considérations multithread](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi).</span><span class="sxs-lookup"><span data-stu-id="d1399-131">For more info about using DXGI with multiple threads, see [Multithread Considerations](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d1399-132">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="d1399-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d1399-133">Traitement multithread</span><span class="sxs-lookup"><span data-stu-id="d1399-133">Multithreading</span></span>](overviews-direct3d-11-render-multi-thread.md)
</dt> </dl>

 

 