---
title: API de ressources en mosaïque
description: Les API décrites dans cette section fonctionnent avec les ressources en mosaïque et le pool de mosaïques.
ms.assetid: 02DCF9BA-F9EA-4176-AD6F-AA620CE968BA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a0d97f5272f4f96db56e6e89b871951de035105
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104379664"
---
# <a name="tiled-resource-apis"></a><span data-ttu-id="43046-103">API de ressources en mosaïque</span><span class="sxs-lookup"><span data-stu-id="43046-103">Tiled Resource APIs</span></span>

<span data-ttu-id="43046-104">Les API décrites dans cette section fonctionnent avec les ressources en mosaïque et le pool de mosaïques.</span><span class="sxs-lookup"><span data-stu-id="43046-104">The APIs described in this section work with tiled resources and tile pool.</span></span>

-   [<span data-ttu-id="43046-105">Affectation de vignettes à partir d’un pool de mosaïques à une ressource</span><span class="sxs-lookup"><span data-stu-id="43046-105">Assigning tiles from a tile pool to a resource</span></span>](#assigning-tiles-from-a-tile-pool-to-a-resource)
-   [<span data-ttu-id="43046-106">Interrogation de la mosaïque et du support des ressources</span><span class="sxs-lookup"><span data-stu-id="43046-106">Querying resource tiling and support</span></span>](#querying-resource-tiling-and-support)
-   [<span data-ttu-id="43046-107">Copie de données en mosaïque</span><span class="sxs-lookup"><span data-stu-id="43046-107">Copying tiled data</span></span>](#copying-tiled-data)
-   [<span data-ttu-id="43046-108">Redimensionnement du pool de mosaïques</span><span class="sxs-lookup"><span data-stu-id="43046-108">Resizing tile pool</span></span>](#resizing-tile-pool)
-   [<span data-ttu-id="43046-109">Barrière des ressources en mosaïque</span><span class="sxs-lookup"><span data-stu-id="43046-109">Tiled resource barrier</span></span>](#tiled-resource-barrier)
-   [<span data-ttu-id="43046-110">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="43046-110">Related topics</span></span>](#related-topics)

## <a name="assigning-tiles-from-a-tile-pool-to-a-resource"></a><span data-ttu-id="43046-111">Affectation de vignettes à partir d’un pool de mosaïques à une ressource</span><span class="sxs-lookup"><span data-stu-id="43046-111">Assigning tiles from a tile pool to a resource</span></span>

<span data-ttu-id="43046-112">Les API [**ID3D11DeviceContext2 :: UpdateTileMappings**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetilemappings) et [**ID3D11DeviceContext2 :: CopyTileMappings**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytilemappings) manipulent et interrogent les mappages de vignettes.</span><span class="sxs-lookup"><span data-stu-id="43046-112">The [**ID3D11DeviceContext2::UpdateTileMappings**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetilemappings) and [**ID3D11DeviceContext2::CopyTileMappings**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytilemappings) APIs manipulate and query tile mappings.</span></span> <span data-ttu-id="43046-113">Les appels de mise à jour affectent uniquement les vignettes identifiées dans l’appel, tandis que d’autres sont laissés comme défini précédemment.</span><span class="sxs-lookup"><span data-stu-id="43046-113">Update calls only affect the tiles identified in the call, and others are left as defined previously.</span></span>

<span data-ttu-id="43046-114">Toute vignette donnée à partir d’un pool de mosaïques peut être mappée à plusieurs emplacements dans une ressource, voire à plusieurs ressources.</span><span class="sxs-lookup"><span data-stu-id="43046-114">Any given tile from a tile pool can be mapped to multiple locations in a resource and even multiple resources.</span></span> <span data-ttu-id="43046-115">Ce mappage comprend des vignettes dans une ressource qui ont une mise en page choisie par l’implémentation ([compression mipmap](mipmap-packing.md)) où plusieurs des mipmaps sont regroupés dans une seule vignette.</span><span class="sxs-lookup"><span data-stu-id="43046-115">This mapping includes tiles in a resource that have an implementation-chosen layout ([Mipmap packing](mipmap-packing.md)) where multiple mipmaps are packed together into a single tile.</span></span> <span data-ttu-id="43046-116">Le résultat est que si les données sont écrites dans la vignette via un mappage, mais lues via un mappage configuré différemment, les résultats ne sont pas définis.</span><span class="sxs-lookup"><span data-stu-id="43046-116">The catch is that if data is written to the tile via one mapping, but read via a differently configured mapping, the results are undefined.</span></span> <span data-ttu-id="43046-117">Une utilisation soigneuse de cette flexibilité peut toujours être utile pour une application, comme le partage d’une vignette entre des ressources qui ne seront pas utilisées simultanément, où le contenu de la vignette est toujours initialisé par le même mappage de ressources, car il sera lu par la suite.</span><span class="sxs-lookup"><span data-stu-id="43046-117">Careful use of this flexibility can still be useful for an application though, like sharing a tile between resources that will not be used simultaneously, where the contents of the tile are always initialized through the same resource mapping as they will be subsequently read from.</span></span> <span data-ttu-id="43046-118">De même, une vignette mappée pour contenir les des mipmaps compressés de plusieurs ressources différentes avec les mêmes dimensions de surface fonctionnera correctement. les données apparaîtront de la même façon dans les deux mappages.</span><span class="sxs-lookup"><span data-stu-id="43046-118">Similarly, a tile mapped to hold the packed mipmaps of multiple different resources with the same surface dimensions will work fine - the data will appear the same in both mappings.</span></span>

<span data-ttu-id="43046-119">Les modifications apportées aux affectations de vignettes pour une ressource peuvent être effectuées à tout moment dans un contexte immédiat ou différé.</span><span class="sxs-lookup"><span data-stu-id="43046-119">Changes to tile assignments for a resource can be made at any time in an immediate or deferred context.</span></span>

## <a name="querying-resource-tiling-and-support"></a><span data-ttu-id="43046-120">Interrogation de la mosaïque et du support des ressources</span><span class="sxs-lookup"><span data-stu-id="43046-120">Querying resource tiling and support</span></span>

<span data-ttu-id="43046-121">Pour interroger la mosaïque des ressources, utilisez [**ID3D11Device2 :: GetResourceTiling**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11device2-getresourcetiling).</span><span class="sxs-lookup"><span data-stu-id="43046-121">To query resource tiling, use [**ID3D11Device2::GetResourceTiling**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11device2-getresourcetiling).</span></span>

<span data-ttu-id="43046-122">Pour la prise en charge de la mosaïque des ressources, utilisez [**ID3D11Device2 :: CheckMultisampleQualityLevels1**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11device2-checkmultisamplequalitylevels1).</span><span class="sxs-lookup"><span data-stu-id="43046-122">For other resource tiling support, use [**ID3D11Device2::CheckMultisampleQualityLevels1**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11device2-checkmultisamplequalitylevels1).</span></span>

## <a name="copying-tiled-data"></a><span data-ttu-id="43046-123">Copie de données en mosaïque</span><span class="sxs-lookup"><span data-stu-id="43046-123">Copying tiled data</span></span>

<span data-ttu-id="43046-124">Toutes les méthodes dans Direct3D pour déplacer des données autour du travail avec des ressources en mosaïque comme si elles n’étaient pas en mosaïque, à l’exception du fait que les écritures dans les zones non mappées sont supprimées et que les lectures des zones non mappées produisent 0.</span><span class="sxs-lookup"><span data-stu-id="43046-124">Any methods in Direct3D for moving data around work with tiled resources just as if they are not tiled, except that writes to unmapped areas are dropped and reads from unmapped areas produce 0.</span></span> <span data-ttu-id="43046-125">Si une opération de copie implique l’écriture à plusieurs reprises dans le même emplacement de mémoire, car plusieurs emplacements de la ressource de destination sont mappés à la même mémoire de vignettes, les écritures obtenues dans les vignettes multimappées sont non déterministes et non reproductibles.</span><span class="sxs-lookup"><span data-stu-id="43046-125">If a copy operation involves writing to the same memory location multiple times because multiple locations in the destination resource are mapped to the same tile memory, the resulting writes to multi-mapped tiles are non-deterministic and non-repeatable.</span></span> <span data-ttu-id="43046-126">Autrement dit, les accès se produisent dans le même ordre que celui où se trouve le matériel pour exécuter la copie.</span><span class="sxs-lookup"><span data-stu-id="43046-126">That is, accesses happen in whatever order the hardware happens to execute the copy.</span></span>

<span data-ttu-id="43046-127">Direct3D 11,2 introduit des méthodes pour ces méthodes supplémentaires pour copier :</span><span class="sxs-lookup"><span data-stu-id="43046-127">Direct3D 11.2 introduces methods for these additional ways to copy:</span></span>

-   <span data-ttu-id="43046-128">Copie entre les vignettes d’une ressource en mosaïque (avec une granularité de mosaïque de 64 Ko) et (vers/à partir de) une mémoire tampon dans la mémoire de l’unité de traitement graphique (GPU) (ou ressource intermédiaire)- [ **ID3D11DeviceContext2 :: CopyTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles)</span><span class="sxs-lookup"><span data-stu-id="43046-128">Copy between tiles in a tiled resource (at 64KB tile granularity) and (to/from) a buffer in graphics processing unit (GPU) memory (or staging resource) - [**ID3D11DeviceContext2::CopyTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles)</span></span>
-   <span data-ttu-id="43046-129">Copier à partir de la mémoire fournie par l’application vers des vignettes dans une ressource en mosaïque- [ **ID3D11DeviceContext2 :: UpdateTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetiles)</span><span class="sxs-lookup"><span data-stu-id="43046-129">Copy from application-provided memory to tiles in a tiled resource - [**ID3D11DeviceContext2::UpdateTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetiles)</span></span>

<span data-ttu-id="43046-130">Ces méthodes Swizzle/deswizzle en fonction des besoins, et permettent à une vignette de D3D11 de \_ \_ copier \_ aucun \_ indicateur de remplacement lorsque l’appelant promet la mémoire de destination n’est pas référencée par le travail GPU qui est en vol.</span><span class="sxs-lookup"><span data-stu-id="43046-130">These methods swizzle/deswizzle as needed, and allow a D3D11\_TILE\_COPY\_NO\_OVERWRITE flag when the caller promises the destination memory is not referenced by GPU work that is in flight.</span></span>

<span data-ttu-id="43046-131">Les vignettes impliquées dans la copie ne peuvent pas inclure des vignettes qui contiennent des des mipmaps compressés ou qui ont des résultats qui ne sont pas définis.</span><span class="sxs-lookup"><span data-stu-id="43046-131">The tiles involved in the copy can't include tiles that contain packed mipmaps or that have results that are undefined.</span></span> <span data-ttu-id="43046-132">Pour transférer des données vers/à partir de des mipmaps que les packages matériels dans une vignette, vous devez utiliser les API de copie/mise à jour standard (non spécifiques à une mosaïque) ou [**ID3D11DeviceContext :: GenerateMips**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips) pour l’ensemble de la chaîne MIP.</span><span class="sxs-lookup"><span data-stu-id="43046-132">To transfer data to/from mipmaps that the hardware packs into one tile, you must use the standard (non-tile specific) Copy/Update APIs or [**ID3D11DeviceContext::GenerateMips**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips) for the whole mip chain.</span></span>

<span data-ttu-id="43046-133">**Remarque sur [**GenerateMips**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips):** l’utilisation de [**ID3D11DeviceContext :: GenerateMips**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips) sur une ressource avec des vignettes partiellement mappées produit des résultats qui suivent simplement les règles de lecture et d’écriture de la **valeur null** appliquée à l’algorithme que le matériel et le pilote d’affichage sont utilisés pour **GenerateMips**.</span><span class="sxs-lookup"><span data-stu-id="43046-133">**Note on [**GenerateMips**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips):** Using [**ID3D11DeviceContext::GenerateMips**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips) on a resource with partially mapped tiles will produce results that simply follow the rules for reading and writing **NULL** applied to whatever algorithm the hardware and display driver happen to use to **GenerateMips**.</span></span> <span data-ttu-id="43046-134">Par conséquent, il n’est pas particulièrement utile pour une application de procéder à cette opération, sauf si les zones avec des mappages **null** (et leur effet sur d’autres mips pendant la phase de génération) n’ont aucune conséquence sur les parties de la surface qui intéressent l’application.</span><span class="sxs-lookup"><span data-stu-id="43046-134">So, it is not particularly useful for an application to bother doing this unless somehow the areas with **NULL** mappings (and their effect on other mips during the generation phase) will have no consequence on the parts of the surface the application does care about.</span></span>

<span data-ttu-id="43046-135">La copie de données de vignette à partir d’une surface intermédiaire ou de la mémoire de l’application est le moyen de charger des vignettes qui ont pu être diffusées en continu, par exemple.</span><span class="sxs-lookup"><span data-stu-id="43046-135">Copying tile data from a staging surface or from application memory would be the way to upload tiles that may have been streamed off disk, for example.</span></span> <span data-ttu-id="43046-136">Une variation lors de la diffusion en continu sur le disque consiste à charger un certain type de données compressées dans la mémoire GPU, puis à décoder sur le GPU.</span><span class="sxs-lookup"><span data-stu-id="43046-136">A variation when streaming off disk is uploading some sort of compressed data to GPU memory and then decoding on the GPU.</span></span> <span data-ttu-id="43046-137">La cible Decode peut être une ressource de mémoire tampon dans la mémoire du GPU, à partir de laquelle [**CopyTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles) est ensuite copiée dans la ressource en mosaïque réelle.</span><span class="sxs-lookup"><span data-stu-id="43046-137">The decode target could be a buffer resource in GPU memory, from which [**CopyTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles) then copies to the actual tiled resource.</span></span> <span data-ttu-id="43046-138">Cette étape de copie permet au GPU de Swizzle lorsque le modèle Swizzle n’est pas connu.</span><span class="sxs-lookup"><span data-stu-id="43046-138">This copy step allows the GPU to swizzle when the swizzle pattern is not known.</span></span> <span data-ttu-id="43046-139">Swizzling n’est pas nécessaire si la ressource en mosaïque elle-même est une ressource tampon (par exemple, par opposition à une texture).</span><span class="sxs-lookup"><span data-stu-id="43046-139">Swizzling is not needed if the tiled resource itself is a buffer resource (for example, as opposed to a Texture).</span></span>

<span data-ttu-id="43046-140">La disposition de la mémoire des vignettes dans le côté ressource de mémoire tampon non en mosaïque de la copie est simplement linéaire en mémoire dans les mosaïques de 64 Ko, que le pilote matériel et le pilote d’affichage Swizzle/deswizzle par vignette, le cas échéant, lors du transfert vers/à partir d’une ressource en mosaïque.</span><span class="sxs-lookup"><span data-stu-id="43046-140">The memory layout of the tiles in the non-tiled buffer resource side of the copy is simply linear in memory within 64KB tiles, which the hardware and display driver would swizzle/deswizzle per tile as appropriate when transferring to/from a tiled resource.</span></span> <span data-ttu-id="43046-141">Pour les surfaces MSAA (multiéchantillonner l’anticrénelage), chaque échantillon de pixel est parcouru dans un exemple d’ordre d’index avant de passer au pixel suivant.</span><span class="sxs-lookup"><span data-stu-id="43046-141">For multisample antialiasing (MSAA) surfaces, each pixel's samples are traversed in sample-index order before moving to the next pixel.</span></span> <span data-ttu-id="43046-142">Pour les vignettes qui sont partiellement remplies sur le côté droit (pour une surface dont la largeur n’est pas un multiple de la largeur de la mosaïque en pixels), le tangage/Stride pour descendre dans une ligne correspond à la taille totale, en octets, du nombre de pixels qui correspondrait à la vignette si la vignette était pleine.</span><span class="sxs-lookup"><span data-stu-id="43046-142">For tiles that are partially filled on the right side (for a surface that has a width not a multiple of tile width in pixels), the pitch/stride to move down a row is the full size in bytes of the number pixels that would fit across the tile if the tile was full.</span></span> <span data-ttu-id="43046-143">Par conséquent, il peut y avoir un intervalle entre chaque ligne de pixels en mémoire.</span><span class="sxs-lookup"><span data-stu-id="43046-143">So, there can be a gap between each row of pixels in memory.</span></span> <span data-ttu-id="43046-144">Pour simplifier la spécification, les des mipmaps plus petits qu’une vignette ne sont pas regroupés dans la disposition linéaire.</span><span class="sxs-lookup"><span data-stu-id="43046-144">For specification simplicity, mipmaps smaller than a tile are not packed together in the linear layout.</span></span> <span data-ttu-id="43046-145">Cela semble être un gaspillage de l’espace mémoire, mais comme indiqué lors de la copie vers des mips, les packs matériels ne sont pas autorisés via [**CopyTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles) ou [**UpdateTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetiles).</span><span class="sxs-lookup"><span data-stu-id="43046-145">This seems to be a waste of memory space, but as mentioned copying to mips that the hardware packs together is not allowed via [**CopyTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles) or [**UpdateTiles**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetiles).</span></span> <span data-ttu-id="43046-146">L’application peut simplement utiliser \* des API UpdateSubresource () ou CopySubresource () génériques \* pour copier des petits mips individuellement, bien que dans le cas de CopySubresource \* (), cela signifie que la mémoire linéaire doit être la même dimension que la ressource en mosaïque-CopySubresource \* () ne peut pas copier à partir d’une ressource de mémoire tampon vers une Texture2D par exemple.</span><span class="sxs-lookup"><span data-stu-id="43046-146">The application can just use generic UpdateSubresource\*() or CopySubresource\*() APIs to copy small mips individually, though in the case of CopySubresource\*() that means the linear memory has to be the same dimension as the tiled resource - CopySubresource\*() can't copy from a buffer resource to a Texture2D for instance.</span></span>

<span data-ttu-id="43046-147">Si un Swizzle matériel standard est défini, des indicateurs peuvent être ajoutés pour indiquer que les données de la mémoire tampon doivent être interprétées dans ce format (pas d’Swizzle nécessaire lors du transfert), bien que d’autres approches de chargement des données peuvent également être utiles dans ce cas, par exemple autoriser les applications à accéder directement à la mémoire du pool de mosaïques.</span><span class="sxs-lookup"><span data-stu-id="43046-147">If a hardware standard swizzle is defined, flags could be added to indicate that the data in the buffer is to be interpreted in that format (no swizzle necessary on transfer), though alternative approaches to uploading data may also make sense in that case such as allowing applications direct access to tile pool memory.</span></span>

<span data-ttu-id="43046-148">Les opérations de copie peuvent être effectuées sur un contexte immédiat ou différé.</span><span class="sxs-lookup"><span data-stu-id="43046-148">Copying operations can be done on an immediate or deferred context.</span></span>

## <a name="resizing-tile-pool"></a><span data-ttu-id="43046-149">Redimensionnement du pool de mosaïques</span><span class="sxs-lookup"><span data-stu-id="43046-149">Resizing tile pool</span></span>

<span data-ttu-id="43046-150">Pour redimensionner un pool de mosaïques, utilisez [**ID3D11DeviceContext2 :: ResizeTilePool**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-resizetilepool).</span><span class="sxs-lookup"><span data-stu-id="43046-150">To resize a tile pool, use [**ID3D11DeviceContext2::ResizeTilePool**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-resizetilepool).</span></span>

## <a name="tiled-resource-barrier"></a><span data-ttu-id="43046-151">Barrière des ressources en mosaïque</span><span class="sxs-lookup"><span data-stu-id="43046-151">Tiled resource barrier</span></span>

<span data-ttu-id="43046-152">Pour spécifier une contrainte de classement d’accès aux données entre plusieurs ressources en mosaïque, utilisez [**ID3D11DeviceContext2 :: TiledResourceBarrier**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier).</span><span class="sxs-lookup"><span data-stu-id="43046-152">To specify a data access ordering constraint between multiple tiled resources, use [**ID3D11DeviceContext2::TiledResourceBarrier**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier).</span></span>

## <a name="related-topics"></a><span data-ttu-id="43046-153">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="43046-153">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="43046-154">Ressources en mosaïque</span><span class="sxs-lookup"><span data-stu-id="43046-154">Tiled resources</span></span>](tiled-resources.md)
</dt> </dl>

 

 




