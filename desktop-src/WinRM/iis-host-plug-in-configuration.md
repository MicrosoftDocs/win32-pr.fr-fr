---
title: Configuration du plug-in hôte IIS
description: La configuration du plug-in hôte Internet Information Services (IIS) du Windows Remote Management (WinRM) fournit un mécanisme d’hébergement qui permet aux plug-ins WinRM tiers d’exposer des données de gestion dans l’infrastructure WinRM.
ms.assetid: 234e6f7b-310f-499a-83e4-699ecf3816f0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 714139c25836f5929ca6cfa3fe6797a90e80dde8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103941024"
---
# <a name="iis-host-plug-in-configuration"></a>Configuration du plug-in hôte IIS

La configuration du plug-in hôte Internet Information Services (IIS) du Windows Remote Management (WinRM) fournit un mécanisme d’hébergement qui permet aux plug-ins WinRM tiers d’exposer des données de gestion dans l’infrastructure WinRM.

Les sections suivantes décrivent la configuration du plug-in hôte IIS :

-   [Détails de l’hébergement IIS](#iis-hosting-details)
-   [Modèle de configuration d’hôte IIS](#iis-host-configuration-model)
-   [Configuration et détails de la configuration de l’hôte IIS (WinRM)](/windows)
-   [Lecture de la configuration d’hôte IIS](#reading-iis-host-configuration)
-   [Énumération des plug-ins sur le service WinRM](#enumerating-plug-ins-on-the-winrm-service)

## <a name="iis-hosting-details"></a>Détails de l’hébergement IIS

Une application qui configure et initialise le processeur SOAP WinRM dans IIS reçoit les demandes directement d’un client WinRM sur un autre ordinateur à l’aide du protocole WS-Management. L’application doit également configurer un point de terminaison HTTP qui identifie l’application pour s’assurer que toutes les demandes sont acheminées directement vers les plug-ins spécifiques à l’application. L’application doit également configurer les plug-ins à charger dans l’hôte IIS et les mécanismes d’autorisation et d’authentification nécessaires. Lors de l’utilisation du service WinRM dans IIS, les facteurs suivants doivent être pris en compte :

-   IIS ne prend pas en charge l’authentification Kerberos par défaut. Toutefois, un module IIS peut être créé pour prendre en charge l’authentification Kerberos.
-   Le service IIS n’accepte pas les demandes de service WinRM chiffrées sur HTTP.
-   Une fois que vous avez configuré un point de terminaison IIS, la première requête que vous envoyez avec des informations d’identification implicites échouera. Toutefois, toutes les demandes suivantes sont effectuées. Il s’agit d’un problème connu avec un site IIS configuré avec l’authentification par défaut en mode noyau. S’il s’agit d’un problème bloquant, il est recommandé de désactiver l’authentification en mode noyau.

## <a name="iis-host-configuration-model"></a>Modèle de configuration d’hôte IIS

Toutes les applications qui hébergent un processeur SOAP (Simple Object Access Protocol) WinRM dans IIS requièrent une configuration pour pouvoir fonctionner.

Chaque configuration d’application est distincte de celle d’autres applications. Les ensembles de configurations suivants sont nécessaires, même si toutes les configurations n’ont pas besoin d’être modifiées et qu’elles sont effectuées par le biais du service WinRM principal :

-   Configuration générale de l’application, y compris les délais d’expiration de l’opération.
-   Un plug-in d’autorisation pour autoriser les demandes LiveID ou mapper le compte d’utilisateur Windows à un compte de service plus générique.
-   Les plug-ins d’opération doivent être hébergés et utilisés par le processeur SOAP WinRM pour exécuter les demandes réelles.

Les configurations suivantes doivent peut-être être configurées dans IIS :

-   Les informations de point de terminaison de l' [*écouteur*](windows-remote-management-glossary.md) qui définissent les ports et les adresses qui écoutent les requêtes, ainsi que tous les certificats SSL (Secure Sockets Layer) (SSL).
-   Mappage de certificat client pour mapper les certificats clients aux comptes d’utilisateur.
-   Configuration d’autorisation pour limiter l’accès au site virtuel.

Le service WinRM inscrit le port 5985 avec le préfixe « WSMan » par défaut. Si l’écouteur HTTP de compatibilité est activé, le service WinRM inscrit le port 80 avec le préfixe « WSMan » par défaut. Étant donné qu’IIS écoute également sur le port 80 par défaut, il est recommandé que les services d’hôte IIS créent des [*écouteurs*](windows-remote-management-glossary.md) sur un port différent.

Si les services IIS et WinRM partagent le port 80, la configuration suivante est nécessaire pour partager le port :

-   Le service hôte IIS doit activer WinRM sur une application sous le site.
-   Le nom de l’application doit être ajouté à l’URI. Par exemple : https://servername/myapplication.

Chaque application hôte IIS est stockée dans la configuration IIS sous la forme d’un fichier web.config résidant dans le répertoire physique correspondant au répertoire virtuel configuré. La section suivante décrit le fonctionnement du système de configuration IIS et comment il peut être étendu pour prendre en charge la configuration de l’hôte WinRM IIS.

### <a name="how-iis-configuration-works"></a>Fonctionnement de la configuration d’IIS

L’infrastructure de configuration IIS se compose d’un ensemble de fichiers XML utilisés pour stocker les données de configuration et d’un ensemble de fichiers de schéma permettant de valider les données écrites ou lues dans les API d’administration IIS. Au niveau de la racine se trouve un fichier ApplicationHost.config dans le même répertoire qu’IIS (généralement,% windir% \\ system32 \\ inetsrv \\ config). Il s’agit du fichier de configuration principal pour IIS, où sont stockées la liste des sites, des applications, des répertoires virtuels, des paramètres généraux, de la journalisation, de la mise en cache, etc. Les données de configuration sont divisées et accessibles en tant qu’entités indépendantes appelées **sections**.

Par exemple, il existe des **sections** distinctes pour les sites, la journalisation, la mise en cache, etc. Toutes les données de configuration contenues dans ApplicationHost.config sont appliquées à tous les sites, applications et répertoires virtuels configurés dans IIS. Au niveau du répertoire virtuel, un fichier de web.config définit des données de configuration spécifiques à l’application, éventuellement en remplaçant d’autres données déjà définies dans ApplicationHost.config. Les fichiers de Web.config sont stockés à la racine (répertoire physique) correspondant au site, à l’application ou au répertoire virtuel auquel la configuration s’applique.

Pour plus d’informations sur la configuration d’IIS, consultez les rubriques suivantes :

-   [Schéma des paramètres IIS 7,0](/previous-versions/iis/settings-schema/aa347559(v=vs.90))
-   [/archive/blogs/carlosag/](/archive/blogs/carlosag/)
-   [https://www.iis.net/articles/view.aspx/IIS7/Use-IIS7-Administration-Tools/Using-XML-Configuration/Deep-Dive-into-IIS7](https://www.iis.net/learn/get-started/planning-your-iis-architecture/deep-dive-into-iis-configuration-with-iis-7-and-iis-8)

Le schéma de configuration IIS utilisé pour valider les données de configuration IIS est un fichier XML stocké dans le répertoire de schéma IIS (en général, le schéma de configuration% windir% \\ system32 \\ inetsrv \\ \\ ). Le schéma de configuration IIS n’est pas XSD. La configuration IIS prend en charge l’extensibilité. Les nouvelles sections de configuration peuvent être intégrées directement dans le système de configuration IIS et les paramètres du système de configuration IIS peuvent être manipulés à l’aide des API d’administration existantes.

Voici les principales étapes à suivre :

-   Définissez une nouvelle section de configuration dans un fichier de schéma XML.
-   Placez le fichier dans le répertoire de schéma IIS 7 (schéma de configuration% windir% \\ system32 \\ inetsrv \\ \\ ).
-   Enregistrez la nouvelle section dans le fichier de configuration global IIS (ApplicationHost.config).

## <a name="iis-host-winrm-configuration-setup-and-details"></a>Configuration et détails de la configuration de l’hôte IIS (WinRM)

Cette section décrit les étapes à suivre lors de l’installation pour intégrer et initialiser la configuration d’hôte IIS. Ici, la configuration d’hôte IIS fait référence aux données de configuration requises pour exécuter le service WinRM dans IIS. Le module d’extension IIS WinRM est un composant facultatif qui est installé à l’aide de l' **Gestionnaire de serveur**.

La section de configuration IIS qui définit la configuration requise est appelée **system.management.wsmanagement.config**. En règle générale, la configuration de l’hôte IIS est définie lors de l’installation. Pour ce faire, vous pouvez créer un fichier de web.config et ajouter le code XML approprié. Toute modification apportée au fichier web.config nécessite le redémarrage du site qui héberge le service WinRM.

La procédure suivante décrit la configuration de l’extension WinRM IIS en détail.

**Pour installer l’extension WinRM IIS**

1.  Dans la section **Résumé des fonctionnalités** de la **Gestionnaire de serveur**, cliquez sur Ajouter des **fonctionnalités**.
2.  Dans l’Assistant Ajout de fonctionnalités, sélectionnez Extension WinRM IIS.
3.  Suivez les instructions de l’Assistant, y compris l’installation des logiciels requis, le cas échéant. Pour plus d’informations sur l’utilisation de l’Assistant Ajout de fonctionnalités, reportez-vous à l’aide en ligne de **Gestionnaire de serveur** .

### <a name="initializing-winrm-configuration-for-the-hosted-application"></a>Initialisation de la configuration de WinRM pour l’application hébergée

Cette étape implique la définition du fichier XML de configuration d’hôte IIS dans le fichier web.config. Ce fichier se trouve dans le répertoire physique correspondant au répertoire virtuel dans lequel l’application hébergée est configurée. Le contenu XML de la section **system.management.wsmanagement.config** doit se conformer au schéma défini dans WSManConfig \_schema.xml ; sinon, les API d’administration IIS ne pourront pas le traiter. Voici un exemple de contenu XML qui peut être contenu dans le fichier web.config :


```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
 <system.webServer>
  <system.management.wsmanagement.config>
   <OperationsConfiguration MaxEnvelopeSizeKB="150" 
                            MaxOperationTimeoutSeconds="60"  
                            MaxEnumerateIdleTimeoutSeconds="60"  
                            MaxSubscribeIdleTimeoutSeconds="60"  
                            MaxShellIdleTimeoutMinutes="15"
                            QuotaRefreshIntervalSeconds="900"
                            QuotaSystemWindowSeconds="2"
                            QuotaSystemWindowOperations-"1000"/>
    <PluginModules>
     <AuthorizationPlugin Name="Auth1" Filename="Auth.dll" SDKVersion="1" SupportsQuota="true"/>
     <OperationsPlugins>
      <Plugin Name="PL1" Filename="PL1.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters>
        <Param name="myParam1" value="myValue1"/>
       </InitializationParameters>
       <Resources>
        <Resource ResourceUri="myUri1">
        <Capability Type="Shell"/>
        </Resource>
       </Resources>
      </Plugin>
      <Plugin Name="PL2" Filename="PL2.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters/>
       <Resources>
        <Resource ResourceUri="myUri1">
         <Capability Type="Get"/>
         <Capability Type="Put"/>
         <Capability Type="Delete"/>
        </Resource>
       </Resources>
      </Plugin>
     </OperationsPlugins>
    </PluginModules>
   </OperationsConfiguration>
  </system.management.wsmanagement.config>
 </system.webServer>
</configuration>
```



La liste suivante décrit les éléments XML plus en détail et est suivie d’un exemple de fichier WSManConfig \_schema.xml.



| Élément                                                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OperationsConfiguration/MaxEnvelopeSizeKB                      | Taille maximale des paquets SOAP que le service WinRM traitera. La valeur par défaut est 150 Ko.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OperationsConfiguration/MaxOperationTimeoutSeconds             | Intervalle de délai d’attente maximal pour toutes les opérations. Cette valeur remplace toute valeur reçue dans un paquet SOAP. Si un fournisseur dépasse cette valeur, un délai d’attente est envoyé au client et l’opération est annulée. (Certaines opérations, comme les énumérations, peuvent conserver une énumération ouverte après un délai d’attente.) La valeur par défaut est 60 secondes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| OperationsConfiguration/MaxEnumerationIdleTimeoutSeconds       | Intervalle de délai d’attente maximal pour les énumérations. Si le délai entre les demandes d’énumération est supérieur à cette valeur, l’énumération est annulée et le contexte d’énumération précédemment émis n’est plus valide. La valeur par défaut est 60 secondes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/MaxSubscribeIdleTimeoutSeconds         | Intervalle de délai d’attente maximal pour les opérations d’abonnement. La valeur par défaut est 60 secondes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/MaxShellIdleTimeoutMinutes             | Durée maximale (en minutes) avant la suppression d’un shell distant inactif. La valeur par défaut est 15 minutes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/QuotaRefreshIntervalSeconds            | Intervalle avant l’actualisation des informations de quota pour un utilisateur. Les demandes en attente pour l’utilisateur spécifié continuent de s’exécuter dans le contexte d’autorisation et de quota précédent jusqu’à ce que l’actualisation soit terminée. La valeur par défaut est 900 secondes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowSeconds               | Durée de la fenêtre glissante de limitation du système. La valeur par défaut est 2 secondes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowOperations            | Nombre d’opérations qui sont admises par le biais de la limitation du système au cours de la fenêtre glissante. La valeur par défaut est 1000 opérations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/AuthorizationPlugin                              | Ce nœud est facultatif. Un plug-in d’autorisation permet d’accepter ou de rejeter un utilisateur entrant en fonction de différents schémas d’authentification.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/AuthorizationPlugin/nom                         | Spécifie le nom complet à utiliser pour le plug-in. Si une erreur est retournée par le plug-in, ce nom est placé dans le code XML d’erreur renvoyé à l’application cliente. Le nom n'est pas spécifique aux paramètres régionaux.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/AuthorizationPlugin/nom de fichier                     | Spécifie le nom de fichier du plug-in d’autorisation. Toutes les variables d’environnement qui sont placées dans cette entrée seront étendues en fonction de l’identité sous laquelle l’hôte IIS s’exécute, par exemple service réseau. La valeur par défaut de cette entrée est vide, ce qui signifie qu’aucun plug-in d’autorisation n’est utilisé.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| PlugInModules/AuthorizationPlugin/SDKVersion                   | Spécifie la version du kit de développement logiciel (SDK) pour laquelle un plug-in particulier a été écrit. Cet élément doit avoir la valeur 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| PlugInModules/AuthorizationPlugin/SupportsQuota                | Spécifie si le plug-in d’autorisation prend en charge les quotas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| PlugInModules/OperationsPlugins/nom                           | Spécifie le nom complet à utiliser pour le plug-in. Si une erreur est retournée par le plug-in, ce nom est placé dans le code XML d’erreur renvoyé à l’application cliente. Le nom n'est pas spécifique aux paramètres régionaux.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/nom de fichier                       | Spécifie le nom de fichier du plug-in d’opération. Toutes les variables d’environnement qui sont placées dans cette entrée sont développées dans le contexte de l’utilisateur lorsqu’une demande arrive. Chaque utilisateur peut avoir une version différente de la même variable d’environnement, afin que chaque utilisateur puisse se retrouver avec un autre plug-in. Cette entrée ne peut pas être vide et doit pointer vers un plug-in valide.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| PlugInModules/OperationsPlugins/SDKVersion                     | Spécifie la version du kit de développement logiciel (SDK) pour lequel un plug-in particulier a été écrit. Cet élément doit avoir la valeur 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| PlugInModules/OperationsPlugins/XmlRenderingType               | Configure le format dans lequel le code XML est transmis aux plug-ins via l’objet de [**\_ données WSMan**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) . **XmlRenderingType** est défini sur Text. Les données XML entrantes sont contenues dans une \_ structure de type de données WSMan \_ \_ , qui représente le XML sous la forme d’une mémoire tampon **PCWSTR** .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/InitializationParameters       | Ce nœud est facultatif et permet à un plug-in de configurer du code XML supplémentaire qui sera transmis à la méthode [**WSManPluginStartup**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) . La plupart des plug-ins n’ont pas besoin de ces informations supplémentaires, mais si un plug-in doit être utilisé dans plusieurs scénarios qui nécessitent une sémantique d’exécution différente, ce code XML offre au plug-in la flexibilité.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/OperationsPlugins/ressources                      | Spécifie la liste des [*URI de ressource*](windows-remote-management-glossary.md) que ce plug-in prend en charge. Au moins une entrée **resourceuri** doit être spécifiée ; dans le cas contraire, le code XML sera rejeté.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PlugInModules/OperationsPlugins/Resources/Resource             | Représente une configuration d' [*URI de ressource*](windows-remote-management-glossary.md) unique.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| PlugInModules/OperationsPlugins/Resources/Ressources/ResourceUri | Spécifie un [*URI de ressource*](windows-remote-management-glossary.md) unique complet ou une chaîne de correspondance partielle basée sur l’attribut **ExactMatch** . Si **ExactMatch** n’est pas présent, la valeur par défaut est **false**, ce qui signifie que le processeur SOAP WinRM effectue une correspondance partielle avec le début de l' *URI de ressource* et, s’il existe une correspondance, la passe au plug-in. L’attribut **SupportsOptions** peut être spécifié si des options sont autorisées pour cet *URI de ressource* . Par défaut, aucune option n’est prise en charge et, si elle est présente dans la demande du client, une erreur est retournée. Si les options sont prises en charge par le plug-in, il est important que le plug-in retourne l’erreur correcte si le plug-in n’est pas compris lorsque l’indicateur **MustUnderstand** a la valeur **true**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/OperationsPlugins/ressource/capacité            | Spécifie une fonctionnalité disponible sur cet [*URI de ressource*](windows-remote-management-glossary.md). Il y aura une entrée pour chaque type d’opération qu’elle prend en charge. Les options suivantes sont disponibles :<br/> <dl> <dt><span id="Get"></span><span id="get"></span><span id="GET"></span>Télécharger</dt> <dd> Les opérations d’extraction sont prises en charge sur l' [*URI de ressource*](windows-remote-management-glossary.md). L’attribut **SupportFragment** est utilisé si l’opération d’extraction prend en charge le concept. L’attribut **SupportFiltering** n’est pas valide et doit avoir la valeur **false**. Cette fonctionnalité n’est pas valide pour un *URI de ressource* si les opérations de l’interpréteur de commandes sont également prises en charge.<br/> </dd> <dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>Posé</dt> <dd> Les opérations put sont prises en charge sur l' [*URI de ressource*](windows-remote-management-glossary.md). L’attribut **SupportFragment** est utilisé si l’opération put prend en charge le concept. L’attribut **SupportFiltering** n’est pas valide et doit avoir la valeur **false**. Cette fonctionnalité n’est pas valide pour un *URI de ressource* si les opérations de l’interpréteur de commandes sont également prises en charge.<br/> </dd> <dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>Créés</dt> <dd> Les opérations Create sont prises en charge sur l' [*URI de ressource*](windows-remote-management-glossary.md). L’attribut **SupportFragment** est utilisé si l’opération de création prend en charge le concept. L’attribut **SupportFiltering** n’est pas valide et doit avoir la valeur **false**. Cette fonctionnalité n’est pas valide pour un *URI de ressource* si les opérations de l’interpréteur de commandes sont également prises en charge.<br/> </dd> <dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>Supprimer</dt> <dd> Les opérations de suppression sont prises en charge sur l' [*URI de ressource*](windows-remote-management-glossary.md). L’attribut **SupportFragment** est utilisé si l’opération de suppression prend en charge le concept. L’attribut **SupportFiltering** n’est pas valide et doit avoir la valeur **false**. Cette fonctionnalité n’est pas valide pour un *URI de ressource* si les opérations de l’interpréteur de commandes sont également prises en charge.<br/> </dd> <dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>Appeler</dt> <dd> Les opérations d’appel sont prises en charge sur l' [*URI de ressource*](windows-remote-management-glossary.md). L’attribut **SupportFragment** n’est pas pris en charge pour les opérations d’appel et doit avoir la valeur **false**. L’attribut **SupportFiltering** n’est pas valide et doit avoir la valeur **false**. Cette fonctionnalité n’est pas valide pour un *URI de ressource* si les opérations de l’interpréteur de commandes sont également prises en charge.<br/> </dd> <dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>Énumérer</dt> <dd> Les opérations d’énumération sont prises en charge sur l' [*URI de ressource*](windows-remote-management-glossary.md). L’attribut **SupportFragment** n’est pas pris en charge pour les opérations d’énumération et doit avoir la valeur **false**. L’attribut **SupportFiltering** est valide, et si le plug-in prend en charge le filtrage, cet attribut doit avoir la valeur **true**. Cette fonctionnalité n’est pas valide pour un *URI de ressource* si les opérations de l’interpréteur de commandes sont également prises en charge.<br/> </dd> <dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>S’abonner</dt> <dd> Les opérations d’abonnement sont prises en charge sur l' [*URI de ressource*](windows-remote-management-glossary.md). L’attribut **SupportFragment** n’est pas pris en charge pour les opérations subscribe et doit être défini sur **false**. L’attribut **SupportFiltering** n’est pas valide et doit avoir la valeur **false**. Cette fonctionnalité n’est pas valide pour un *URI de ressource* si les opérations de l’interpréteur de commandes sont également prises en charge.<br/> </dd> <dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>Shell</dt> <dd> Les opérations de Shell sont prises en charge sur l' [*URI de ressource*](windows-remote-management-glossary.md). L’attribut **SupportFragment** n’est pas pris en charge pour les opérations de Shell et doit avoir la valeur **false**. L’attribut **SupportFiltering** n’est pas valide et doit avoir la valeur **false**. Cette fonctionnalité n’est pas valide pour un *URI de ressource* si une autre fonction d’opération est également prise en charge. Si une fonctionnalité de l’interpréteur de commandes est configurée pour un *URI de ressource*, les opérations obtenir, placer, créer, supprimer, appeler et énumérer sont traitées en interne dans le service WinRM pour gérer les interpréteurs de commandes. Par conséquent, le plug-in ne peut pas traiter les opérations elles-mêmes.<br/> </dd> </dl> |



 

### <a name="example-wsmanconfig_schemaxml-file"></a>Exemple de \_ fichier deschema.xml WSManConfig

Au cours de la configuration, un fichier XML appelé WSManConfig \_schema.xml contenant le contenu suivant est supprimé dans le répertoire de schéma IIS :


```XML
<configSchema>
 <sectionSchema name="system.webServer/system.management.wsmanagement.config">
  <element name="OperationsConfiguration">
   <attribute name="MaxEnvelopeSizeKB" 
              type="uint" 
              defaultValue="150" 
              validationType="integerRange" 
              validationParameter="32,4294967295"/>
   <attribute name="MaxOperationTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxEnumerateIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxSubscribeIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxShellIdleTimeoutMinutes" 
              type="uint" 
              defaultValue="15" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaRefreshIntervalSeconds" 
              type="uint" 
              defaultValue="900" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowSeconds" 
              type="uint" 
              defaultValue="2" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowOperations" 
              type="uint" 
              defaultValue="1000" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
  </element>
  <element name="PluginModules">
   <collection addElement="AuthorizationPlugin">
    <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
    <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
    <attribute name="SDKVersion" type="uint" required="true"/>
    <attribute name="SupportsQuota" type="bool" defaultValue="false"/>
   </collection>
   <element name="OperationsPlugins">
    <collection addElement="Plugin">
     <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
     <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
     <attribute name="SDKVersion" type="uint" required="true"/>
     <attribute name="XmlRenderingType" type="enum" defaultValue="text">
      <enum name="text" value="1"/>
      <enum name="XmlReader" value="2"/>
     </attribute>
     <attribute name="Enabled" type="bool" defaultValue="true"/>
     <element name="InitializationParameters">
      <collection addElement="Param">
       <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="Value" type="string" required="true" validationType="nonEmptyString"/>
      </collection>
     </element>
     <element name="Resources">
      <collection addElement="Resource">
       <attribute name="ResourceUri" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="SupportsOptions" type="bool" defaultValue="false"/>
       <attribute name="ExactMatch" type="bool" defaultValue="false"/>
       <collection addElement="Capability">
        <attribute name="Type" type="enum" isUniqueKey="true" required="true">
         <enum name="Get" value="1"/>
         <enum name="Put" value="2"/>
         <enum name="Create" value="3"/>
         <enum name="Delete" value="4"/>
         <enum name="Invoke" value="5"/>
         <enum name="Enumerate" value="6"/>
         <enum name="Subscribe" value="7"/>
         <enum name="Shell" value="8"/>
        </attribute>
        <attribute name="SupportsFragment" type="bool" default="false"/>
        <attribute name="SupportsFiltering" type="bool" default="false"/>
       </collection>
      </collection>
     </element>
    </collection>
   </element>
  </element>
 </sectionSchema>
</configSchema>
```



## <a name="reading-iis-host-configuration"></a>Lecture de la configuration d’hôte IIS

La configuration d’hôte IIS est lue pendant le processus de démarrage du processeur SOAP dans l’application hébergée. Étant donné que les fichiers de web.config peuvent être modifiés manuellement et, par conséquent, sujets aux erreurs de validation de schéma, il peut y avoir des problèmes lors de la lecture d’une configuration. Lors d’un échec de lecture ou de validation de la configuration, l’application hébergée ne démarrera pas et renverra un message d’erreur approprié au client. Un événement est enregistré, contenant une description détaillée de l’origine de l’échec.

Les défaillances courantes sont les suivantes :

-   accès refusé
-   Fichier XML de configuration non valide
-   Aucun plug-in n’est configuré (au moins un plug-in est requis)

Les plug-ins standard ne sont pas configurés par défaut. Ils doivent être configurés explicitement dans le fichier web.config avant de commencer à recevoir des demandes.

## <a name="enumerating-plug-ins-on-the-winrm-service"></a>Énumération des plug-ins sur le service WinRM

La commande suivante montre comment utiliser l’utilitaire WinRM pour déterminer les plug-ins disponibles sur le service WinRM : **WinRM Enumerate winrm/config/plugin-format : joli**.

 

