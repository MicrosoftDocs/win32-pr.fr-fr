---
title: COM, DCOM et les bibliothèques de types
description: Le modèle COM (Component Object Model) et le modèle DCOM (Distributed Component Object Model) utilisent des appels de procédure distante (RPC) pour permettre aux objets de composants distribués de communiquer entre eux.
ms.assetid: 7bade397-676e-43be-82f4-b23cd768fd16
keywords:
- interfaces MIDL, COM
- interfaces MIDL, DCOM
- interfaces MIDL, bibliothèques de types
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4f0b21aad9f88f02d8029d478eead50f5501ecc
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103842221"
---
# <a name="com-dcom-and-type-libraries"></a><span data-ttu-id="7b2de-106">COM, DCOM et les bibliothèques de types</span><span class="sxs-lookup"><span data-stu-id="7b2de-106">COM, DCOM, and Type Libraries</span></span>

<span data-ttu-id="7b2de-107">Le modèle COM (Component Object Model) et le modèle DCOM (Distributed Component Object Model) utilisent des appels de procédure distante (RPC) pour permettre aux objets de composants distribués de communiquer entre eux.</span><span class="sxs-lookup"><span data-stu-id="7b2de-107">Component Object Model (COM) and Distributed Component Object Model (DCOM) use Remote Procedure Calls (RPC) to enable distributed component objects to communicate with each other.</span></span> <span data-ttu-id="7b2de-108">Par conséquent, une interface COM ou DCOM définit l’identité et les caractéristiques externes d’un objet COM.</span><span class="sxs-lookup"><span data-stu-id="7b2de-108">Thus, a COM or DCOM interface defines the identity and external characteristics of a COM object.</span></span> <span data-ttu-id="7b2de-109">Il forme les moyens par lesquels les clients peuvent accéder aux méthodes et aux données d’un objet.</span><span class="sxs-lookup"><span data-stu-id="7b2de-109">It forms the means by which clients can gain access to an object's methods and data.</span></span> <span data-ttu-id="7b2de-110">Avec DCOM, cet accès est possible, que les objets existent dans le même processus, que des processus différents sur le même ordinateur ou sur des ordinateurs différents.</span><span class="sxs-lookup"><span data-stu-id="7b2de-110">With DCOM, this access is possible regardless of whether the objects exist in the same process, different processes on the same machine, or on different machines.</span></span> <span data-ttu-id="7b2de-111">Comme avec les interfaces client/serveur RPC, un objet COM ou DCOM peut exposer ses fonctionnalités de différentes façons et via plusieurs interfaces.</span><span class="sxs-lookup"><span data-stu-id="7b2de-111">As with RPC client/server interfaces, a COM or DCOM object can expose its functionality in a number of different ways and through multiple interfaces.</span></span>

## <a name="type-library"></a><span data-ttu-id="7b2de-112">Bibliothèque de types</span><span class="sxs-lookup"><span data-stu-id="7b2de-112">Type Library</span></span>

<span data-ttu-id="7b2de-113">Une bibliothèque de types (. tlb) est un fichier binaire qui stocke des informations sur les propriétés et méthodes d’un objet COM ou DCOM dans un formulaire accessible à d’autres applications au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="7b2de-113">A type library (.tlb) is a binary file that stores information about a COM or DCOM object's properties and methods in a form that is accessible to other applications at runtime.</span></span> <span data-ttu-id="7b2de-114">À l’aide d’une bibliothèque de types, une application ou un navigateur peut déterminer les interfaces prises en charge par un objet et appeler les méthodes d’interface d’un objet.</span><span class="sxs-lookup"><span data-stu-id="7b2de-114">Using a type library, an application or browser can determine which interfaces an object supports, and invoke an object's interface methods.</span></span> <span data-ttu-id="7b2de-115">Cela peut se produire même si l’objet et les applications clientes ont été écrits dans des langages de programmation différents.</span><span class="sxs-lookup"><span data-stu-id="7b2de-115">This can occur even if the object and client applications were written in different programming languages.</span></span> <span data-ttu-id="7b2de-116">L’environnement d’exécution COM/DCOM peut également utiliser une bibliothèque de types pour fournir un marshaling automatique inter-cloisonnement, inter-processus et inter-ordinateurs pour les interfaces décrites dans les bibliothèques de types.</span><span class="sxs-lookup"><span data-stu-id="7b2de-116">The COM/DCOM run-time environment can also use a type library to provide automatic cross-apartment, cross-process, and cross-machine marshaling for interfaces described in type libraries.</span></span>

## <a name="characteristics-of-an-interface"></a><span data-ttu-id="7b2de-117">Caractéristiques d’une interface</span><span class="sxs-lookup"><span data-stu-id="7b2de-117">Characteristics of an Interface</span></span>

<span data-ttu-id="7b2de-118">Vous définissez les caractéristiques d’une interface dans un fichier de définition d’interface (IDL) et un fichier de configuration d’application facultatif (ACF) :</span><span class="sxs-lookup"><span data-stu-id="7b2de-118">You define the characteristics of an interface in an interface definition (IDL) file and an optional application configuration file (ACF):</span></span>

-   <span data-ttu-id="7b2de-119">Le fichier IDL spécifie les caractéristiques des interfaces de l’application sur le câble, c’est-à-dire la façon dont les données doivent être transmises entre le client et le serveur, ou entre les objets COM.</span><span class="sxs-lookup"><span data-stu-id="7b2de-119">The IDL file specifies the characteristics of the application's interfaces on the wire — that is, how data is to be transmitted between client and server, or between COM objects.</span></span>
-   <span data-ttu-id="7b2de-120">Le fichier ACF spécifie les caractéristiques de l’interface, telles que les handles de liaison, qui se rapportent uniquement à l’environnement d’exploitation local.</span><span class="sxs-lookup"><span data-stu-id="7b2de-120">The ACF file specifies interface characteristics, such as binding handles, that pertain only to the local operating environment.</span></span> <span data-ttu-id="7b2de-121">Le fichier ACF peut également spécifier comment marshaler et transmettre une structure de données complexe dans un format indépendant de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="7b2de-121">The ACF file can also specify how to marshal and transmit a complex data structure in a machine-independent form.</span></span>

<span data-ttu-id="7b2de-122">Pour plus d’informations sur les fichiers IDL et ACF, consultez [les fichiers IDL et ACF](/windows/desktop/Rpc/the-idl-and-acf-files).</span><span class="sxs-lookup"><span data-stu-id="7b2de-122">For more information on IDL and ACF files, see [The IDL and ACF Files](/windows/desktop/Rpc/the-idl-and-acf-files).</span></span>

<span data-ttu-id="7b2de-123">Les fichiers IDL et ACF sont des scripts écrits en Microsoft Interface Definition Language (MIDL), qui est l’implémentation Microsoft et l’extension du langage IDL (Interface Definition Language) OSF-DCE.</span><span class="sxs-lookup"><span data-stu-id="7b2de-123">The IDL and ACF files are scripts written in Microsoft Interface Definition Language (MIDL), which is the Microsoft implementation and extension of the OSF-DCE interface definition language (IDL).</span></span> <span data-ttu-id="7b2de-124">Les extensions Microsoft du langage IDL vous permettent de créer des interfaces COM et des bibliothèques de types.</span><span class="sxs-lookup"><span data-stu-id="7b2de-124">The Microsoft extensions to the IDL language enable you to create COM interfaces and type libraries.</span></span> <span data-ttu-id="7b2de-125">Le compilateur, Midl.exe, utilise ces scripts pour générer des stubs et des fichiers d’en-tête de langage C, ainsi que des fichiers de bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="7b2de-125">The compiler, Midl.exe, uses these scripts to generate C-language stubs and header files as well as type library files.</span></span>

## <a name="the-midl-compiler"></a><span data-ttu-id="7b2de-126">Compilateur MIDL</span><span class="sxs-lookup"><span data-stu-id="7b2de-126">The MIDL Compiler</span></span>

<span data-ttu-id="7b2de-127">En fonction du contenu de votre fichier IDL, le compilateur MIDL génère l’un des fichiers suivants.</span><span class="sxs-lookup"><span data-stu-id="7b2de-127">Depending on the contents of your IDL file, the MIDL compiler will generate any of the following files.</span></span>

<span data-ttu-id="7b2de-128">Un fichier proxy/stub en langage C, un fichier d’identificateur d’interface, un fichier de données DLL et un fichier d’en-tête associé pour une interface COM personnalisée.</span><span class="sxs-lookup"><span data-stu-id="7b2de-128">A C-language proxy/stub file, an interface identifier file, a DLL data file, and a related header file for a custom COM interface.</span></span> <span data-ttu-id="7b2de-129">Le compilateur MIDL génère ces fichiers lorsqu’il rencontre l’attribut d’objet dans une liste d’attributs d’interface.</span><span class="sxs-lookup"><span data-stu-id="7b2de-129">The MIDL compiler generates these files when it encounters the object attribute in an interface attribute list.</span></span> <span data-ttu-id="7b2de-130">Pour plus d’informations sur ces fichiers, consultez [fichiers générés pour une interface com](files-generated-for-a-com-interface.md).</span><span class="sxs-lookup"><span data-stu-id="7b2de-130">For more detailed information on these files, see [Files Generated for a COM Interface](files-generated-for-a-com-interface.md).</span></span>

<span data-ttu-id="7b2de-131">Fichier de bibliothèque de types compilé (. tlb) et fichier d’en-tête associé.</span><span class="sxs-lookup"><span data-stu-id="7b2de-131">A compiled type library (.tlb) file and related header file.</span></span> <span data-ttu-id="7b2de-132">MIDL génère ces fichiers lorsqu’il rencontre une instruction [**Library**](library.md) dans le fichier IDL.</span><span class="sxs-lookup"><span data-stu-id="7b2de-132">MIDL generates these files when it encounters a [**library**](library.md) statement in the IDL file.</span></span> <span data-ttu-id="7b2de-133">Pour obtenir des informations générales sur les bibliothèques de types, consultez le [contenu d’une bibliothèque de types](/previous-versions/windows/desktop/automat/contents-of-a-type-library)dans le Guide de référence du programmeur Automation.</span><span class="sxs-lookup"><span data-stu-id="7b2de-133">For general information about type libraries, see [Contents of a Type Library](/previous-versions/windows/desktop/automat/contents-of-a-type-library), in the Automation Programmer's Reference.</span></span>

<span data-ttu-id="7b2de-134">C/C++-fichiers du client et du serveur stub du langage et fichier d’en-tête associé pour une interface RPC.</span><span class="sxs-lookup"><span data-stu-id="7b2de-134">C/C++-language client and server stub files and related header file for an RPC interface.</span></span> <span data-ttu-id="7b2de-135">Ces fichiers sont générés lorsque des interfaces dans le fichier IDL n’ont pas l’attribut d' [**objet**](object.md) .</span><span class="sxs-lookup"><span data-stu-id="7b2de-135">These files are generated when there are interfaces in the IDL file that do not have the [**object**](object.md) attribute.</span></span> <span data-ttu-id="7b2de-136">Pour obtenir une vue d’ensemble des fichiers stub et d’en-tête, consultez [procédure de génération générale](/windows/desktop/Rpc/general-build-procedure).</span><span class="sxs-lookup"><span data-stu-id="7b2de-136">For an overview of the stub and header files, see [General Build Procedure](/windows/desktop/Rpc/general-build-procedure).</span></span> <span data-ttu-id="7b2de-137">Pour plus d’informations, consultez [fichiers générés pour une interface RPC](files-generated-for-an-rpc-interface.md).</span><span class="sxs-lookup"><span data-stu-id="7b2de-137">For more detailed information, see [Files Generated for an RPC Interface](files-generated-for-an-rpc-interface.md).</span></span>

 

 