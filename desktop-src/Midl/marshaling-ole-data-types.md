---
title: Marshaling des types de données OLE
description: Marshaling des types de données Automation et OLE.
ms.assetid: 0cab4208-d40d-40a1-88f2-4933b52c0c29
keywords:
- MIDL et COM MIDL, marshaling de types de données OLE
- marshaling MIDL
- MIDL de données OLE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5970c6e0fef9d0fc88b8a0a11a087fa4396d7a7c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103725156"
---
# <a name="marshaling-ole-data-types"></a><span data-ttu-id="7d1ec-106">Marshaling des types de données OLE</span><span class="sxs-lookup"><span data-stu-id="7d1ec-106">Marshaling OLE Data Types</span></span>

<span data-ttu-id="7d1ec-107">Pour faciliter l’utilisation de certains types de données Automation et OLE, ainsi que certains Handles système fréquemment utilisés dans COM, les typedefs pour ces types de données et leurs fonctions d’assistance associées sont disponibles en important des fichiers IDL Windows et en établissant une liaison avec les fichiers DLL OLE et Automation.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-107">To make it easier to use certain Automation and OLE data types, as well as some system handles frequently used in COM, typedefs for these data types and their related helper functions are available by importing Windows IDL files and linking to the OLE and Automation DLL files.</span></span> <span data-ttu-id="7d1ec-108">Ces fichiers sont automatiquement installés sur votre système.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-108">These files are automatically installed on your system.</span></span>

-   <span data-ttu-id="7d1ec-109">Pour utiliser le type de données [**BSTR**](/previous-versions/windows/desktop/automat/bstr) dans les appels de procédure distante, importez le fichier Wtypes. idl dans votre fichier de définition d’interface (IDL) et liez-le à oleaut32. lib lors de la génération de votre application distribuée.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-109">To use the [**BSTR**](/previous-versions/windows/desktop/automat/bstr) data type in remote procedure calls, import the wtypes.idl file into your interface definition (IDL) file and link to Oleaut32.lib when building your distributed application.</span></span> <span data-ttu-id="7d1ec-110">Cela permet à vos stubs d’utiliser les fonctions d’assistance prêtes à l’emploi **BSTR \_ Users**, BSTR **\_ UserMarshal**, **BSTR \_ UserUnmarshal** et **BSTR \_ UserFree**.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-110">This will let your stubs use the ready-made helper functions **BSTR\_UserSize**, **BSTR\_UserMarshal**, **BSTR\_UserUnmarshal**, and **BSTR\_UserFree**.</span></span>
-   <span data-ttu-id="7d1ec-111">Pour utiliser d’autres types de données Automation, comme [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) et [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray), ou des types qui utilisent ces types (par exemple, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) et [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), importez le fichier objidl. idl dans votre fichier IDL et liez-le à oleaut32. lib au moment de la génération.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-111">To use other Automation data types, such as [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) and [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray), or types that use those types (for example, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) and [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), import the objidl.idl file into your IDL file and link to the oleaut32.lib at build time.</span></span> <span data-ttu-id="7d1ec-112">Cela vous permettra d’utiliser les routines d’assistance appropriées.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-112">This will allow you to use the appropriate helper routines.</span></span>
-   <span data-ttu-id="7d1ec-113">Pour utiliser des types de données OLE (tels que CLIPFORMAT, SNB, STGMEDIUM, ASYNC \_ STGMEDIUM) ou des handles du système (tels que HMETAFILE \_ PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE et HGLOBAL), importez le fichier objidl. idl dans votre fichier de définition d’interface et liez-le au moment de la génération.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-113">To use OLE data types (such as CLIPFORMAT, SNB, STGMEDIUM, ASYNC\_STGMEDIUM), or system handles (such as HMETAFILE\_PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE, and HGLOBAL), import the objidl.idl file into your interface definition file and link to the ole32.lib at build time.</span></span>
-   <span data-ttu-id="7d1ec-114">Les handles OLE suivants sont également définis avec l’attribut **\[ Wire \_ Marshal \]** , mais uniquement en tant que handles dans un ordinateur, car ils ne peuvent pas être utilisés dans les appels de procédure distante à d’autres ordinateurs à l’heure actuelle : HWND, HMENU, HACCEL, HDC, Hfont, HICON, HBRUSH.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-114">The following OLE handles are also defined with the **\[wire\_marshal\]** attribute, but only as handles within a computer since they cannot be used in remote procedure calls to other computers at this time: HWND, HMENU, HACCEL, HDC, HFONT, HICON, HBRUSH.</span></span> <span data-ttu-id="7d1ec-115">Importez le fichier objidl. idl dans votre fichier IDL et liez-le à ole32. lib au moment de la génération pour utiliser ces handles dans la communication entre processus sur un ordinateur unique.</span><span class="sxs-lookup"><span data-stu-id="7d1ec-115">Import the objidl.idl file into your IDL file and link to ole32.lib at build time to use these handles in interprocess communication on a single computer.</span></span>

<span data-ttu-id="7d1ec-116">Pour plus d’informations, [consultez l' \_ attribut Wire Marshal](/windows/desktop/Rpc/the-wire-marshal-attribute), [la \_ fonction Users type](/windows/desktop/Rpc/the-type-usersize-function), [la fonction \_ UserMarshal](/windows/desktop/Rpc/the-type-usermarshal-function)de type, [la fonction \_ UserUnmarshal](/windows/desktop/Rpc/the-type-userunmarshal-function)de type, [la fonction \_ UserFree de type](/windows/desktop/Rpc/the-type-userfree-function)et les [stubs ciblant des plateformes 32 bits ou 64 bits spécifiques](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span><span class="sxs-lookup"><span data-stu-id="7d1ec-116">For more information, see [The wire\_marshal Attribute](/windows/desktop/Rpc/the-wire-marshal-attribute), [The type\_UserSize Function](/windows/desktop/Rpc/the-type-usersize-function), [The type\_UserMarshal Function](/windows/desktop/Rpc/the-type-usermarshal-function), [The type\_UserUnmarshal Function](/windows/desktop/Rpc/the-type-userunmarshal-function), [The type\_UserFree Function](/windows/desktop/Rpc/the-type-userfree-function), and [Targeting Stubs for Specific 32-bit or 64-bit Platforms](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span></span>

 

 