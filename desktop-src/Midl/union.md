---
title: attribut Union
description: Le mot clé Union apparaît dans les fonctions qui se rapportent aux unions discriminées.
ms.assetid: 135a6581-e03e-4b90-9fd8-15690820dbd0
keywords:
- MIDL (MIDL), attribut d’Union
topic_type:
- apiref
api_name:
- union
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: bc683472d67775c4a2900695246d5f9ca920ca32
ms.sourcegitcommit: 57758ecb246c84d65e6e0e4bd5570d9176fa39cd
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/25/2019
ms.locfileid: "104507590"
---
# <a name="union-attribute"></a><span data-ttu-id="04315-104">attribut Union</span><span class="sxs-lookup"><span data-stu-id="04315-104">union attribute</span></span>

<span data-ttu-id="04315-105">Le mot clé **Union** apparaît dans les fonctions qui se rapportent aux unions discriminées.</span><span class="sxs-lookup"><span data-stu-id="04315-105">The **union** keyword appears in functions that relate to discriminated unions.</span></span>

``` syntax
/* Encapsulated union*/
typedef [[ [type-attribute-list] ]] union [[ struct-name ]] switch (switch-type switch-name) [[ union-name ]] 
{
  C-style-case-list 
  [[ [ field-attribute-list <> ] ]] type-specifier <> declarator-list <>;

        ...
}

/* Non-encapsulated union*/
typedef [switch_type(switch-type) [[ , type-attr-list ]] ] union [[ tag ]] 
{ 
    [ case ( limited-expr-list) ]
  [[ [ field-attribute-list ] ]] type-specifier declarator-list;
  [[ [ default ]
  [[ [ field-attribute-list ] ]] type-specifier declarator-list;
  ]]
}
```

## <a name="parameters"></a><span data-ttu-id="04315-106">Paramètres</span><span class="sxs-lookup"><span data-stu-id="04315-106">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="04315-107">*type-attribut-List*</span><span class="sxs-lookup"><span data-stu-id="04315-107">*type-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-108">Spécifie zéro, un ou plusieurs attributs qui s’appliquent au type d’Union.</span><span class="sxs-lookup"><span data-stu-id="04315-108">Specifies zero or more attributes that apply to the union type.</span></span> <span data-ttu-id="04315-109">Les attributs de type valides incluent **\[** [**handle**](handle.md) **\]** , **\[** [**transmettre \_ en tant que**](transmit-as.md) **\]** ; attribut de pointeur **\[** [**unique**](unique.md) **\]** ou **\[** [**ptr**](ptr.md) **\]** ; et les attributs d’utilisation **\[** [**\_ handle de contexte**](context-handle.md) **\]** et **\[** [**Ignorer**](ignore.md) **\]** .</span><span class="sxs-lookup"><span data-stu-id="04315-109">Valid type attributes include **\[**[**handle**](handle.md)**\]**, **\[**[**transmit\_as**](transmit-as.md)**\]**; the pointer attribute **\[**[**unique**](unique.md)**\]**, or **\[**[**ptr**](ptr.md)**\]**; and the usage attributes **\[**[**context\_handle**](context-handle.md)**\]** and **\[**[**ignore**](ignore.md)**\]**.</span></span> <span data-ttu-id="04315-110">Les unions encapsulées peuvent également avoir l' **\[** [](ref.md) **\]** attribut de type de pointeur Ref.</span><span class="sxs-lookup"><span data-stu-id="04315-110">Encapsulated unions can also have the **\[**[**ref**](ref.md)**\]** pointer type attribute.</span></span> <span data-ttu-id="04315-111">Séparez plusieurs attributs par des virgules.</span><span class="sxs-lookup"><span data-stu-id="04315-111">Separate multiple attributes with commas.</span></span>

</dd> <dt>

<span data-ttu-id="04315-112">*nom du struct*</span><span class="sxs-lookup"><span data-stu-id="04315-112">*struct-name*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-113">Spécifie une balise facultative qui nomme la structure générée par le compilateur MIDL.</span><span class="sxs-lookup"><span data-stu-id="04315-113">Specifies an optional tag that names the structure generated by the MIDL compiler.</span></span>

</dd> <dt>

<span data-ttu-id="04315-114">*type de commutateur*</span><span class="sxs-lookup"><span data-stu-id="04315-114">*switch-type*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-115">Spécifie un type [**int**](int.md), [**char**](char-idl.md), [**enum**](enum.md) ou un identificateur qui correspond à l’un de ces types.</span><span class="sxs-lookup"><span data-stu-id="04315-115">Specifies an [**int**](int.md), [**char**](char-idl.md), [**enum**](enum.md) type, or an identifier that resolves to one of these types.</span></span>

</dd> <dt>

<span data-ttu-id="04315-116">*nom du commutateur*</span><span class="sxs-lookup"><span data-stu-id="04315-116">*switch-name*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-117">Spécifie le nom de la variable de type *switch-type* qui agit en tant que discriminante d’Union.</span><span class="sxs-lookup"><span data-stu-id="04315-117">Specifies the name of the variable of type *switch-type* that acts as the union discriminant.</span></span>

</dd> <dt>

<span data-ttu-id="04315-118">*nom d’Union*</span><span class="sxs-lookup"><span data-stu-id="04315-118">*union-name*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-119">Spécifie un identificateur facultatif qui nomme l’Union dans la structure, générée par le compilateur MIDL, qui contient l’Union et le discriminante.</span><span class="sxs-lookup"><span data-stu-id="04315-119">Specifies an optional identifier that names the union in the structure, generated by the MIDL compiler, that contains the union and the discriminant.</span></span>

</dd> <dt>

<span data-ttu-id="04315-120">*C-style-case-liste*</span><span class="sxs-lookup"><span data-stu-id="04315-120">*C-style-case-list*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-121">Liste de «**case** *const-expr* : »</span><span class="sxs-lookup"><span data-stu-id="04315-121">List of "**case** *const-expr* :"</span></span>

</dd> <dt>

<span data-ttu-id="04315-122">*Limited-expression-List*</span><span class="sxs-lookup"><span data-stu-id="04315-122">*limited-expression-list*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-123">Spécifie une ou plusieurs expressions en langage C.</span><span class="sxs-lookup"><span data-stu-id="04315-123">Specifies one or more C-language expressions.</span></span> <span data-ttu-id="04315-124">Le compilateur MIDL prend en charge les expressions conditionnelles, les expressions logiques, les expressions relationnelles et les expressions arithmétiques.</span><span class="sxs-lookup"><span data-stu-id="04315-124">The MIDL compiler supports conditional expressions, logical expressions, relational expressions, and arithmetic expressions.</span></span> <span data-ttu-id="04315-125">MIDL n’autorise pas les appels de fonction dans les expressions et n’autorise pas les opérateurs d’incrémentation et de décrémentation.</span><span class="sxs-lookup"><span data-stu-id="04315-125">MIDL does not allow function invocations in expressions and does not allow increment and decrement operators.</span></span> <span data-ttu-id="04315-126">Les expressions individuelles de la liste doivent être séparées par une virgule.</span><span class="sxs-lookup"><span data-stu-id="04315-126">Individual expressions in the list should be separated by a comma.</span></span>

</dd> <dt>

<span data-ttu-id="04315-127">*Field-attribute-List*</span><span class="sxs-lookup"><span data-stu-id="04315-127">*field-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-128">Spécifie zéro, un ou plusieurs attributs de champ qui s’appliquent au membre Union.</span><span class="sxs-lookup"><span data-stu-id="04315-128">Specifies zero or more field attributes that apply to the union member.</span></span> <span data-ttu-id="04315-129">Les attributs de champ valides sont **\[** [**First \_**](first-is.md)is, **\]** **\[** [**Last \_ is**](last-is.md), **\]** **\[** [**Length \_ is**](length-is.md) **\]** , **\[** [**Max \_ is**](max-is.md) **\]** , **\[** [**size \_ is**](size-is.md) **\]** ; the usage Attributes **\[** [**String**](string.md) **\]** , **\[** [**ignore**](ignore.md) **\]** et **\[** [**Context \_ handle**](context-handle.md) **\]** ; l’attribut de pointeur **\[** [**unique**](unique.md) **\]** ou **\[** [**ptr**](ptr.md) **\]** ; et, pour les membres qui sont des unions non encapsulées, le **\[** [**\_ type de commutateur**](switch-type.md)d’attribut Union **\]** .</span><span class="sxs-lookup"><span data-stu-id="04315-129">Valid field attributes include **\[**[**first\_is**](first-is.md)**\]**, **\[**[**last\_is**](last-is.md)**\]**, **\[**[**length\_is**](length-is.md)**\]**, **\[**[**max\_is**](max-is.md)**\]**, **\[**[**size\_is**](size-is.md)**\]**; the usage attributes **\[**[**string**](string.md)**\]**, **\[**[**ignore**](ignore.md)**\]**, and **\[**[**context\_handle**](context-handle.md)**\]**; the pointer attribute **\[**[**unique**](unique.md)**\]** or **\[**[**ptr**](ptr.md)**\]**; and, for members that are nonencapsulated unions, the union attribute **\[**[**switch\_type**](switch-type.md)**\]**.</span></span> <span data-ttu-id="04315-130">Les unions sans encapsulées peuvent également utiliser l’attribut de champ de pointeur de **\[** [**référence**](ref.md) **\]** .</span><span class="sxs-lookup"><span data-stu-id="04315-130">Nonencapsulated unions can also use the **\[**[**ref**](ref.md)**\]** pointer field attribute.</span></span> <span data-ttu-id="04315-131">Séparez plusieurs attributs de champ par des virgules.</span><span class="sxs-lookup"><span data-stu-id="04315-131">Separate multiple field attributes with commas.</span></span>

</dd> <dt>

<span data-ttu-id="04315-132">*spécificateur de type*</span><span class="sxs-lookup"><span data-stu-id="04315-132">*type-specifier*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-133">Spécifie un [type de base](midl-base-types.md), un [**struct**](struct.md), une **Union**, un type [**enum**](enum.md) ou un identificateur de type.</span><span class="sxs-lookup"><span data-stu-id="04315-133">Specifies a [base type](midl-base-types.md), [**struct**](struct.md), **union**, [**enum**](enum.md) type, or type identifier.</span></span> <span data-ttu-id="04315-134">Une spécification de stockage facultative peut précéder *le type-specifier*.</span><span class="sxs-lookup"><span data-stu-id="04315-134">An optional storage specification can precede *type-specifier*.</span></span>

</dd> <dt>

<span data-ttu-id="04315-135">*déclarateur-liste*</span><span class="sxs-lookup"><span data-stu-id="04315-135">*declarator-list*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-136">Un ou plusieurs déclarateurs C standard, tels que les identificateurs, les déclarateurs de pointeurs et les déclarateurs de tableau.</span><span class="sxs-lookup"><span data-stu-id="04315-136">One or more standard C declarators, such as identifiers, pointer declarators, and array declarators.</span></span> <span data-ttu-id="04315-137">(Les déclarateurs de fonction et les déclarations de champ de bits ne sont pas autorisés dans les unions transmises dans les appels de procédure distante.</span><span class="sxs-lookup"><span data-stu-id="04315-137">(Function declarators and bit-field declarations are not allowed in unions that are transmitted in remote procedure calls.</span></span> <span data-ttu-id="04315-138">Sauf quand vous utilisez le commutateur de compilateur MIDL [**/OSF**](-osf.md), ces déclarateurs sont autorisés dans les unions qui ne sont pas transmises. Séparez plusieurs déclarateurs par des virgules.</span><span class="sxs-lookup"><span data-stu-id="04315-138">Except when you use the MIDL compiler switch [**/osf**](-osf.md), these declarators are allowed in unions that are not transmitted.) Separate multiple declarators with commas.</span></span>

</dd> <dt>

<span data-ttu-id="04315-139">*tag*</span><span class="sxs-lookup"><span data-stu-id="04315-139">*tag*</span></span> 
</dt> <dd>

<span data-ttu-id="04315-140">Spécifie une balise facultative.</span><span class="sxs-lookup"><span data-stu-id="04315-140">Specifies an optional tag.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="04315-141">Notes</span><span class="sxs-lookup"><span data-stu-id="04315-141">Remarks</span></span>

<span data-ttu-id="04315-142">MIDL prend en charge deux types d’unions discriminées : les [unions encapsulées](encapsulated-unions.md) et les unions qui ne sont pas [encapsulées](nonencapsulated-unions.md).</span><span class="sxs-lookup"><span data-stu-id="04315-142">MIDL supports two types of discriminated unions: [encapsulated unions](encapsulated-unions.md) and [nonencapsulated unions](nonencapsulated-unions.md).</span></span> <span data-ttu-id="04315-143">L’Union encapsulée est compatible avec les implémentations précédentes de RPC (NCA version 1).</span><span class="sxs-lookup"><span data-stu-id="04315-143">The encapsulated union is compatible with previous implementations of RPC (NCA version 1).</span></span> <span data-ttu-id="04315-144">L’Union non encapsulée élimine certaines des restrictions de l’Union encapsulée et fournit un discriminante plus visible que l’Union encapsulée.</span><span class="sxs-lookup"><span data-stu-id="04315-144">The nonencapsulated union eliminates some of the restrictions of the encapsulated union and provides a more visible discriminant than the encapsulated union.</span></span>

<span data-ttu-id="04315-145">L’Union encapsulée est identifiée par le mot clé [**switch**](switch.md) et l’absence d’autres mots clés liés à l’Union.</span><span class="sxs-lookup"><span data-stu-id="04315-145">The encapsulated union is identified by the [**switch**](switch.md) keyword and the absence of other union-related keywords.</span></span>

<span data-ttu-id="04315-146">L’Union non encapsulée, également appelée « Union », est identifiée par la présence du **\[** [**commutateur \_**](switch-is.md) **\]** et les **\[** Mots clés de [**\_ type de commutateur**](switch-type.md) **\]** , qui identifient le discriminante et son type.</span><span class="sxs-lookup"><span data-stu-id="04315-146">The nonencapsulated union, also known as a union, is identified by the presence of the **\[**[**switch\_is**](switch-is.md)**\]** and **\[**[**switch\_type**](switch-type.md)**\]** keywords, which identify the discriminant and its type.</span></span>

<span data-ttu-id="04315-147">Quand vous utilisez **\[** [**dans**](in.md), [**les**](out-idl.md) **\]** unions out, sachez que la modification de la valeur du commutateur d’Union au cours de l’appel peut faire en sorte que l’appel distant se comporte différemment d’un appel local.</span><span class="sxs-lookup"><span data-stu-id="04315-147">When you use **\[**[**in**](in.md), [**out**](out-idl.md)**\]** unions, be aware that changing the value of the union switch during the call can make the remote call behave differently from a local call.</span></span> <span data-ttu-id="04315-148">Au retour, les stubs copient le paramètre **\[ in**, **out \]** dans la mémoire déjà présente sur le client.</span><span class="sxs-lookup"><span data-stu-id="04315-148">On return, the stubs copy the **\[in**, **out\]** parameter into memory that is already present on the client.</span></span> <span data-ttu-id="04315-149">Lorsque la procédure distante modifie la valeur du commutateur d’Union et modifie donc la taille de l’objet de données, les stubs peuvent remplacer la mémoire valide par la valeur **\[ out \]** .</span><span class="sxs-lookup"><span data-stu-id="04315-149">When the remote procedure modifies the value of the union switch and consequently changes the data object's size, the stubs can overwrite valid memory with the **\[out\]** value.</span></span> <span data-ttu-id="04315-150">Quand le commutateur d’Union modifie l’objet de données d’un type de base en un type pointeur, les stubs peuvent remplacer la mémoire valide lorsqu’ils copient le référent du pointeur dans l’emplacement de mémoire indiqué par la valeur de **\[ dans \]** un type de base.</span><span class="sxs-lookup"><span data-stu-id="04315-150">When the union switch changes the data object from a base type to a pointer type, the stubs can overwrite valid memory when they copy the pointer referent into the memory location indicated by the **\[in\]** value of a base type.</span></span>

<span data-ttu-id="04315-151">La forme des unions doit être identique sur les plateformes pour garantir l’interconnexion.</span><span class="sxs-lookup"><span data-stu-id="04315-151">The shape of unions must be identical across platforms to ensure interconnectivity.</span></span>

## <a name="see-also"></a><span data-ttu-id="04315-152">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="04315-152">See also</span></span>

<dl> <dt>

[<span data-ttu-id="04315-153">Unions encapsulées</span><span class="sxs-lookup"><span data-stu-id="04315-153">Encapsulated Unions</span></span>](encapsulated-unions.md)
</dt> <dt>

[<span data-ttu-id="04315-154">Fichier de définition d’interface (IDL)</span><span class="sxs-lookup"><span data-stu-id="04315-154">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="04315-155">**in**</span><span class="sxs-lookup"><span data-stu-id="04315-155">**in**</span></span>](in.md)
</dt> <dt>

[<span data-ttu-id="04315-156">Unions qui ne sont pas encapsulées</span><span class="sxs-lookup"><span data-stu-id="04315-156">Nonencapsulated Unions</span></span>](nonencapsulated-unions.md)
</dt> <dt>

[<span data-ttu-id="04315-157">**à**</span><span class="sxs-lookup"><span data-stu-id="04315-157">**out**</span></span>](out-idl.md)
</dt> <dt>

[<span data-ttu-id="04315-158">**le commutateur \_ est**</span><span class="sxs-lookup"><span data-stu-id="04315-158">**switch\_is**</span></span>](switch-is.md)
</dt> <dt>

[<span data-ttu-id="04315-159">**type de commutateur \_**</span><span class="sxs-lookup"><span data-stu-id="04315-159">**switch\_type**</span></span>](switch-type.md)
</dt> </dl>

 

 




