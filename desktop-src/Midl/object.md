---
title: attribut d'objet
description: L’attribut \ Object \ interface identifie une interface COM.
ms.assetid: 51e34ef3-eea7-45f4-b961-a9f742700fe5
keywords:
- MIDL (attribut d’objet)
topic_type:
- apiref
api_name:
- object
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: cb2c21246282646dcf6ae488411316e07ab62b2f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103726333"
---
# <a name="object-attribute"></a><span data-ttu-id="ace69-104">attribut d'objet</span><span class="sxs-lookup"><span data-stu-id="ace69-104">object attribute</span></span>

<span data-ttu-id="ace69-105">L’attribut d’interface de l' **\[ objet \]** identifie une interface com.</span><span class="sxs-lookup"><span data-stu-id="ace69-105">The **\[object\]** interface attribute identifies a COM interface.</span></span> <span data-ttu-id="ace69-106">(Une liste d’attributs d’interface qui n’inclut pas l’attribut d' **\[ objet \]** indique une interface RPC DCE.)</span><span class="sxs-lookup"><span data-stu-id="ace69-106">(An interface attribute list that does not include the **\[object\]** attribute indicates a DCE RPC interface.)</span></span>

``` syntax
[ 
    object, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
...    
}
```

## <a name="parameters"></a><span data-ttu-id="ace69-107">Paramètres</span><span class="sxs-lookup"><span data-stu-id="ace69-107">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="ace69-108">*chaîne-UUID*</span><span class="sxs-lookup"><span data-stu-id="ace69-108">*string-uuid*</span></span> 
</dt> <dd>

<span data-ttu-id="ace69-109">Chaîne UUID générée par l’utilitaire uuidgen.</span><span class="sxs-lookup"><span data-stu-id="ace69-109">A UUID string generated by the Uuidgen utility.</span></span> <span data-ttu-id="ace69-110">Vous pouvez placer la chaîne UUID entre guillemets.</span><span class="sxs-lookup"><span data-stu-id="ace69-110">You can enclose the UUID string in quotes.</span></span>

</dd> <dt>

<span data-ttu-id="ace69-111">*interface-attribut-List*</span><span class="sxs-lookup"><span data-stu-id="ace69-111">*interface-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="ace69-112">Autres attributs qui s’appliquent à l’ensemble de l’interface.</span><span class="sxs-lookup"><span data-stu-id="ace69-112">Other attributes that apply to the interface as a whole.</span></span>

</dd> <dt>

<span data-ttu-id="ace69-113">*nom de l’interface*</span><span class="sxs-lookup"><span data-stu-id="ace69-113">*interface-name*</span></span> 
</dt> <dd>

<span data-ttu-id="ace69-114">Nom de l’interface.</span><span class="sxs-lookup"><span data-stu-id="ace69-114">The name of the interface.</span></span>

</dd> <dt>

<span data-ttu-id="ace69-115">*interface de base*</span><span class="sxs-lookup"><span data-stu-id="ace69-115">*base-interface*</span></span> 
</dt> <dd>

<span data-ttu-id="ace69-116">Interface COM dérivée de cette interface.</span><span class="sxs-lookup"><span data-stu-id="ace69-116">The COM interface from which this interface derives.</span></span> <span data-ttu-id="ace69-117">L’interface de base doit être [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)ou une autre interface com qui dérive, directement ou indirectement, de **IUnknown** ou **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="ace69-117">The base interface must be [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch), or another COM interface that derives, either directly or indirectly, from **IUnknown** or **IDispatch**.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="ace69-118">Notes</span><span class="sxs-lookup"><span data-stu-id="ace69-118">Remarks</span></span>

<span data-ttu-id="ace69-119">Une liste d’attributs d’interface pour une interface COM doit inclure l' **\[** attribut [**UUID**](uuid.md) **\]** , mais elle ne peut pas inclure l' **\[** attribut [**version**](version.md) **\]** .</span><span class="sxs-lookup"><span data-stu-id="ace69-119">An interface attribute list for a COM interface must include the **\[**[**uuid**](uuid.md)**\]** attribute, but it cannot include the **\[**[**version**](version.md)**\]** attribute.</span></span>

<span data-ttu-id="ace69-120">Par défaut, la compilation d’une interface COM avec le compilateur MIDL génère les fichiers nécessaires à la génération d’une DLL de proxy.</span><span class="sxs-lookup"><span data-stu-id="ace69-120">By default, compiling a COM interface with the MIDL compiler generates the files needed to build a proxy DLL.</span></span> <span data-ttu-id="ace69-121">Cette DLL contient le code permettant de prendre en charge l’utilisation de l’interface COM personnalisée à la fois par les applications clientes et les serveurs d’objets.</span><span class="sxs-lookup"><span data-stu-id="ace69-121">This DLL contains the code to support the use of the custom COM interface by both client applications and object servers.</span></span> <span data-ttu-id="ace69-122">Toutefois, si la liste d’attributs d’interface d’une interface COM spécifie l' **\[** [](local.md) **\]** attribut local, le compilateur MIDL génère uniquement le fichier d’en-tête d’interface.</span><span class="sxs-lookup"><span data-stu-id="ace69-122">However, if the interface attribute list for a COM interface specifies the **\[**[**local**](local.md)**\]** attribute, the MIDL compiler generates only the interface header file.</span></span>

<span data-ttu-id="ace69-123">Le compilateur MIDL génère automatiquement un type de données d’interface pour une interface COM.</span><span class="sxs-lookup"><span data-stu-id="ace69-123">The MIDL compiler automatically generates an interface data type for a COM interface.</span></span> <span data-ttu-id="ace69-124">Vous pouvez également utiliser [**typedef**](typedef.md) avec le mot clé [**interface**](interface.md) pour définir explicitement un type de données d’interface.</span><span class="sxs-lookup"><span data-stu-id="ace69-124">As an alternative, you can use [**typedef**](typedef.md) with the [**interface**](interface.md) keyword to explicitly define an interface data type.</span></span> <span data-ttu-id="ace69-125">La spécification de l’interface peut ensuite utiliser le type de données de l’interface dans les paramètres de fonction et les valeurs de retour, les membres de [**struct**](struct.md) et d' [**Union**](union.md) et d’autres déclarations de type.</span><span class="sxs-lookup"><span data-stu-id="ace69-125">The interface specification can then use the interface data type in function parameters and return values, [**struct**](struct.md) and [**union**](union.md) members, and other type declarations.</span></span> <span data-ttu-id="ace69-126">L’exemple suivant illustre l’utilisation d’un type de données [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) généré automatiquement :</span><span class="sxs-lookup"><span data-stu-id="ace69-126">The following example illustrates the use of an automatically generated [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) data type:</span></span>

``` syntax
[
    object, 
    uuid (ABCDEFOO-1234-1234-5678-ABCDEF123456)
] 
interface IStream : IUnknown
{ 
    typedef IStream * LPSTREAM; 
    // Other interface definition statements.
}
```

<span data-ttu-id="ace69-127">Dans une interface COM, toutes les fonctions membres d’interface sont supposées être des fonctions virtuelles.</span><span class="sxs-lookup"><span data-stu-id="ace69-127">In a COM interface, all the interface member functions are assumed to be virtual functions.</span></span> <span data-ttu-id="ace69-128">Une fonction virtuelle a un pointeur **This** implicite en tant que premier paramètre.</span><span class="sxs-lookup"><span data-stu-id="ace69-128">A virtual function has an implicit **this** pointer as the first parameter.</span></span> <span data-ttu-id="ace69-129">La table de fonctions virtuelles contient une entrée pour chaque fonction membre d’interface.</span><span class="sxs-lookup"><span data-stu-id="ace69-129">The virtual function table contains an entry for each interface member function.</span></span>

<span data-ttu-id="ace69-130">Les **\[** [](local.md) **\]** fonctions membres de l’interface d’objet non locale doivent avoir une valeur de retour de HRESULT ou SCODE.</span><span class="sxs-lookup"><span data-stu-id="ace69-130">Non-**\[**[**local**](local.md)**\]** object interface member functions must have a return value of HRESULT or SCODE.</span></span> <span data-ttu-id="ace69-131">(Notez que les versions antérieures de MIDL permettaient aux fonctions membres de retourner [**void**](void.md).</span><span class="sxs-lookup"><span data-stu-id="ace69-131">(Note that earlier versions of MIDL allowed member functions to return [**void**](void.md).</span></span> <span data-ttu-id="ace69-132">Toutefois, à partir de la version 3,0 de MIDL, le retour de **void** génère une erreur du compilateur.) Avoir une valeur de retour HRESULT ou SCODE signifie que si une exception est générée pendant un appel distant, les proxies générés interceptent l’exception et retournent le code d’exception dans la valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="ace69-132">However, beginning with MIDL version 3.0, returning **void** generates a compiler error.) Having a return value of HRESULT or SCODE means that if an exception is generated during a remote call, the generated proxies catch the exception and return the exception code in the return value.</span></span> <span data-ttu-id="ace69-133">Si votre application peut se permettre d’ignorer les erreurs qui se produisent pendant un appel de procédure distante, vous pouvez spécifier HRESULT comme type de retour sans vérifier la valeur de retour après l’appel.</span><span class="sxs-lookup"><span data-stu-id="ace69-133">If your application can afford to ignore errors that occur during a remote procedure call, you can specify HRESULT as the return type without checking the return value after the call.</span></span>

<span data-ttu-id="ace69-134">Si vous recompilez une ancienne application, la modification des types de retour peut introduire des problèmes de compatibilité descendante lorsque le serveur envoie le résultat nouvellement introduit au client.</span><span class="sxs-lookup"><span data-stu-id="ace69-134">If you are recompiling an old application, changing the return types can introduce backward compatibility problems when the server sends the newly introduced result to the client.</span></span> <span data-ttu-id="ace69-135">Comme alternative à la modification du type de retour, vous pouvez étiqueter la fonction qui retourne [**void**](void.md) avec l' **\[** [**appel \_ comme**](call-as.md) attribut, ce qui en **\]** fait une fonction locale.</span><span class="sxs-lookup"><span data-stu-id="ace69-135">As an alternative to changing the return type, you can label the function that returns [**void**](void.md) with the **\[**[**call\_as**](call-as.md)**\]** attribute, thus making it a local function.</span></span> <span data-ttu-id="ace69-136">Définissez ensuite une fonction distante associée avec les mêmes paramètres, mais avec le type de retour HRESULT.</span><span class="sxs-lookup"><span data-stu-id="ace69-136">Then define a related remote function with the same parameters but with the return type of HRESULT.</span></span> <span data-ttu-id="ace69-137">La fonction locale peut lever une exception en fonction de cette valeur HRESULT, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="ace69-137">The local function can raise an exception based on that HRESULT value, if necessary.</span></span>

<span data-ttu-id="ace69-138">L’attribut d' **\[ \] objet** n’est pas disponible quand vous compilez à l’aide du commutateur [**/OSF**](-osf.md) du compilateur MIDL.</span><span class="sxs-lookup"><span data-stu-id="ace69-138">The **\[object\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.</span></span>

## <a name="examples"></a><span data-ttu-id="ace69-139">Exemples</span><span class="sxs-lookup"><span data-stu-id="ace69-139">Examples</span></span>

``` syntax
[
    uuid(12345678-1234-1234-1234-123456789ABC), 
    object
] 
interface IMyInterface : IUnknown
{
    // Interface definition statements.
}

[
    uuid(87654321-1234-1234-1234-123456789ABC), 
    object, 
    local
] 
interface ILocalInterface : ISomeOldCOMInterface
{
    // Interface definition statements.
}
```

## <a name="see-also"></a><span data-ttu-id="ace69-140">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ace69-140">See also</span></span>

<dl> <dt>

[<span data-ttu-id="ace69-141">**appeler \_ en tant que**</span><span class="sxs-lookup"><span data-stu-id="ace69-141">**call\_as**</span></span>](call-as.md)
</dt> <dt>

[<span data-ttu-id="ace69-142">Fichier de définition d’interface (IDL)</span><span class="sxs-lookup"><span data-stu-id="ace69-142">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="ace69-143">**IID \_ est**</span><span class="sxs-lookup"><span data-stu-id="ace69-143">**iid\_is**</span></span>](iid-is.md)
</dt> <dt>

[<span data-ttu-id="ace69-144">**interface**</span><span class="sxs-lookup"><span data-stu-id="ace69-144">**interface**</span></span>](interface.md)
</dt> <dt>

[<span data-ttu-id="ace69-145">**localisé**</span><span class="sxs-lookup"><span data-stu-id="ace69-145">**local**</span></span>](local.md)
</dt> <dt>

[<span data-ttu-id="ace69-146">**/osf**</span><span class="sxs-lookup"><span data-stu-id="ace69-146">**/osf**</span></span>](-osf.md)
</dt> <dt>

[<span data-ttu-id="ace69-147">**typedef**</span><span class="sxs-lookup"><span data-stu-id="ace69-147">**typedef**</span></span>](typedef.md)
</dt> <dt>

[<span data-ttu-id="ace69-148">**universel**</span><span class="sxs-lookup"><span data-stu-id="ace69-148">**uuid**</span></span>](uuid.md)
</dt> <dt>

[<span data-ttu-id="ace69-149">**Version**</span><span class="sxs-lookup"><span data-stu-id="ace69-149">**version**</span></span>](version.md)
</dt> </dl>

 

 