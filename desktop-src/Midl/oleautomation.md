---
title: oleautomation (attribut)
description: Attribut de MIDL oleautomation et compatibilité avec Automation.
ms.assetid: 4a1c9a02-d637-4595-87b3-5fe903149357
keywords:
- attribut oleautomation MIDL
topic_type:
- apiref
api_name:
- oleautomation
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: b827aba4cb0871f7130e658299c6d8836557a156
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104031221"
---
# <a name="oleautomation-attribute"></a><span data-ttu-id="b19a7-104">oleautomation (attribut)</span><span class="sxs-lookup"><span data-stu-id="b19a7-104">oleautomation attribute</span></span>

<span data-ttu-id="b19a7-105">L’attribut **oleautomation** indique qu’une interface est compatible avec Automation.</span><span class="sxs-lookup"><span data-stu-id="b19a7-105">The **oleautomation** attribute indicates that an interface is compatible with Automation.</span></span>

``` syntax
[ 
    oleautomation, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
    ...
}
```

## <a name="parameters"></a><span data-ttu-id="b19a7-106">Paramètres</span><span class="sxs-lookup"><span data-stu-id="b19a7-106">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="b19a7-107">*chaîne-UUID*</span><span class="sxs-lookup"><span data-stu-id="b19a7-107">*string-uuid*</span></span> 
</dt> <dd>

<span data-ttu-id="b19a7-108">Spécifie une chaîne UUID générée par l’utilitaire uuidgen.</span><span class="sxs-lookup"><span data-stu-id="b19a7-108">Specifies a UUID string generated by the Uuidgen utility.</span></span>

</dd> <dt>

<span data-ttu-id="b19a7-109">*interface-attribut-List*</span><span class="sxs-lookup"><span data-stu-id="b19a7-109">*interface-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="b19a7-110">Spécifie d’autres attributs qui s’appliquent à l’ensemble de l’interface.</span><span class="sxs-lookup"><span data-stu-id="b19a7-110">Specifies other attributes that apply to the interface as a whole.</span></span>

</dd> <dt>

<span data-ttu-id="b19a7-111">*nom de l’interface*</span><span class="sxs-lookup"><span data-stu-id="b19a7-111">*interface-name*</span></span> 
</dt> <dd>

<span data-ttu-id="b19a7-112">Spécifie le nom de l’interface.</span><span class="sxs-lookup"><span data-stu-id="b19a7-112">Specifies the name of the interface.</span></span>

</dd> <dt>

<span data-ttu-id="b19a7-113">*interface de base*</span><span class="sxs-lookup"><span data-stu-id="b19a7-113">*base-interface*</span></span> 
</dt> <dd>

<span data-ttu-id="b19a7-114">Spécifie le nom d’une interface Automation à partir de laquelle cette interface dérivée hérite des fonctions membres, des codes d’État et des attributs d’interface.</span><span class="sxs-lookup"><span data-stu-id="b19a7-114">Specifies the name of an Automation interface from which this derived interface inherits member functions, status codes, and interface attributes.</span></span> <span data-ttu-id="b19a7-115">Toutes les interfaces d’automatisation sont dérivées de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) ou [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span><span class="sxs-lookup"><span data-stu-id="b19a7-115">All Automation interfaces are derived from [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) or [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="b19a7-116">Notes</span><span class="sxs-lookup"><span data-stu-id="b19a7-116">Remarks</span></span>

<span data-ttu-id="b19a7-117">Les paramètres et les types de retour spécifiés pour les membres d’une interface **\[ oleautomation \]** doivent être compatibles Automation, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="b19a7-117">The parameters and return types specified for the members of an **\[oleautomation\]** interface must be Automation-compatible, as listed in the following table.</span></span>



| <span data-ttu-id="b19a7-118">Type</span><span class="sxs-lookup"><span data-stu-id="b19a7-118">Type</span></span>                                            | <span data-ttu-id="b19a7-119">Description</span><span class="sxs-lookup"><span data-stu-id="b19a7-119">Description</span></span>                                                                                                                                                                                                   |
|-------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b19a7-120">**boolean**</span><span class="sxs-lookup"><span data-stu-id="b19a7-120">**boolean**</span></span>                                     | <span data-ttu-id="b19a7-121">Élément de données qui peut avoir la valeur VARIANT \_ true ou variant \_ false.</span><span class="sxs-lookup"><span data-stu-id="b19a7-121">Data item that can have the value VARIANT\_TRUE or VARIANT\_FALSE.</span></span> <span data-ttu-id="b19a7-122">La taille correspond à VARIANT \_ bool.</span><span class="sxs-lookup"><span data-stu-id="b19a7-122">The size corresponds to VARIANT\_BOOL.</span></span>                                                                                                     |
| <span data-ttu-id="b19a7-123">**unsigned char**</span><span class="sxs-lookup"><span data-stu-id="b19a7-123">**unsigned char**</span></span>                               | <span data-ttu-id="b19a7-124">élément de données non signées 8 bits.</span><span class="sxs-lookup"><span data-stu-id="b19a7-124">8-bit unsigned data item.</span></span>                                                                                                                                                                                     |
| <span data-ttu-id="b19a7-125">**double**</span><span class="sxs-lookup"><span data-stu-id="b19a7-125">**double**</span></span>                                      | <span data-ttu-id="b19a7-126">nombre à virgule flottante IEEE 64 bits.</span><span class="sxs-lookup"><span data-stu-id="b19a7-126">64-bit IEEE floating-point number.</span></span>                                                                                                                                                                            |
| <span data-ttu-id="b19a7-127">**float**</span><span class="sxs-lookup"><span data-stu-id="b19a7-127">**float**</span></span>                                       | <span data-ttu-id="b19a7-128">nombre à virgule flottante IEEE 32 bits.</span><span class="sxs-lookup"><span data-stu-id="b19a7-128">32-bit IEEE floating-point number.</span></span>                                                                                                                                                                            |
| <span data-ttu-id="b19a7-129">**int**</span><span class="sxs-lookup"><span data-stu-id="b19a7-129">**int**</span></span>                                         | <span data-ttu-id="b19a7-130">Entier signé dont la taille dépend du système.</span><span class="sxs-lookup"><span data-stu-id="b19a7-130">Signed integer, whose size is system dependent.</span></span> <span data-ttu-id="b19a7-131">Sur les plateformes 32 bits, MIDL traite [**int**](int.md) comme un entier signé 32 bits.</span><span class="sxs-lookup"><span data-stu-id="b19a7-131">On 32-bit platforms, MIDL treats [**int**](int.md) as a 32-bit signed integer.</span></span>                                                                               |
| <span data-ttu-id="b19a7-132">**long**</span><span class="sxs-lookup"><span data-stu-id="b19a7-132">**long**</span></span>                                        | <span data-ttu-id="b19a7-133">Entier signé 32 bits.</span><span class="sxs-lookup"><span data-stu-id="b19a7-133">32-bit signed integer.</span></span>                                                                                                                                                                                        |
| <span data-ttu-id="b19a7-134">**short**</span><span class="sxs-lookup"><span data-stu-id="b19a7-134">**short**</span></span>                                       | <span data-ttu-id="b19a7-135">entier signé 16 bits.</span><span class="sxs-lookup"><span data-stu-id="b19a7-135">16-bit signed integer.</span></span>                                                                                                                                                                                        |
| <span data-ttu-id="b19a7-136">**BSTR**</span><span class="sxs-lookup"><span data-stu-id="b19a7-136">**BSTR**</span></span>                                        | <span data-ttu-id="b19a7-137">Chaîne préfixée par sa longueur, comme décrit dans la rubrique d’automatisation [BSTR](/previous-versions/windows/desktop/automat/bstr).</span><span class="sxs-lookup"><span data-stu-id="b19a7-137">Length-prefixed string, as described in the Automation topic [BSTR](/previous-versions/windows/desktop/automat/bstr).</span></span>                                                                                                    |
| <span data-ttu-id="b19a7-138">**CURRENCY**</span><span class="sxs-lookup"><span data-stu-id="b19a7-138">**CURRENCY**</span></span>                                    | <span data-ttu-id="b19a7-139">nombre à virgule flottante fixe sur 8 octets.</span><span class="sxs-lookup"><span data-stu-id="b19a7-139">8-byte, fixed floating-point number.</span></span>                                                                                                                                                                          |
| <span data-ttu-id="b19a7-140">**DATE**</span><span class="sxs-lookup"><span data-stu-id="b19a7-140">**DATE**</span></span>                                        | <span data-ttu-id="b19a7-141">64 bits, nombre de jours fractionnaires à virgule flottante depuis le 30 décembre 1899.</span><span class="sxs-lookup"><span data-stu-id="b19a7-141">64-bit, floating point fractional number of days since December 30, 1899.</span></span>                                                                                                                                     |
| <span data-ttu-id="b19a7-142">**SCODE**</span><span class="sxs-lookup"><span data-stu-id="b19a7-142">**SCODE**</span></span>                                       | <span data-ttu-id="b19a7-143">Pour les systèmes 16 bits : type d’erreur intégré qui correspond à l' \_ erreur VT.</span><span class="sxs-lookup"><span data-stu-id="b19a7-143">For 16-bit systems–built-in error type that corresponds to VT\_ERROR.</span></span>                                                                                                                                         |
| <span data-ttu-id="b19a7-144">**Enum typedef** Â  *MyEnum*</span><span class="sxs-lookup"><span data-stu-id="b19a7-144">**Typedef enum** Â *myenum*</span></span>                      | <span data-ttu-id="b19a7-145">Entier signé dont la taille dépend du système.</span><span class="sxs-lookup"><span data-stu-id="b19a7-145">Signed integer, whose size is system dependent.</span></span>                                                                                                                                                               |
| <span data-ttu-id="b19a7-146">**Interface IDispatch \***</span><span class="sxs-lookup"><span data-stu-id="b19a7-146">**Interface IDispatch \***</span></span>                      | <span data-ttu-id="b19a7-147">Pointeur vers l’interface [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) ( \_ Dispatch VT).</span><span class="sxs-lookup"><span data-stu-id="b19a7-147">Pointer to the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface (VT\_DISPATCH).</span></span>                                                                                                                |
| <span data-ttu-id="b19a7-148">**Interface IUnknown \***</span><span class="sxs-lookup"><span data-stu-id="b19a7-148">**Interface IUnknown \***</span></span>                       | <span data-ttu-id="b19a7-149">Pointeur vers une interface qui ne dérive pas de [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT \_ inconnu).</span><span class="sxs-lookup"><span data-stu-id="b19a7-149">Pointer to an interface that does not derive from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT\_UNKNOWN).</span></span> <span data-ttu-id="b19a7-150">(Toute interface OLE peut être représentée par son interface [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) .)</span><span class="sxs-lookup"><span data-stu-id="b19a7-150">(Any OLE interface can be represented by its [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface.)</span></span> |
| <span data-ttu-id="b19a7-151">**dispinterface** Â  *TypeName \**</span><span class="sxs-lookup"><span data-stu-id="b19a7-151">**dispinterface** Â *Typename \**</span></span>                | <span data-ttu-id="b19a7-152">Pointeur vers une interface dérivée de [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) ( \_ distribution vt).</span><span class="sxs-lookup"><span data-stu-id="b19a7-152">Pointer to an interface derived from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT\_DISPATCH).</span></span>                                                                                                    |
| <span data-ttu-id="b19a7-153">**Coclasse** Â  *TypeName \**</span><span class="sxs-lookup"><span data-stu-id="b19a7-153">**Coclass** Â *Typename \**</span></span>                      | <span data-ttu-id="b19a7-154">Pointeur vers un nom de coclasse (VT \_ inconnu).</span><span class="sxs-lookup"><span data-stu-id="b19a7-154">Pointer to a coclass name (VT\_UNKNOWN).</span></span>                                                                                                                                                                      |
| <span data-ttu-id="b19a7-155">**\[ oleautomation, \] interface** Â   *TypeName \**</span><span class="sxs-lookup"><span data-stu-id="b19a7-155">**\[oleautomation\] interface** Â  *Typename \**</span></span> | <span data-ttu-id="b19a7-156">Pointeur vers une interface qui dérive de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="b19a7-156">Pointer to an interface that derives from [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span>                                                                                                                                      |
| <span data-ttu-id="b19a7-157">**SAFEARRAY**(*TypeName*)</span><span class="sxs-lookup"><span data-stu-id="b19a7-157">**SAFEARRAY**(*TypeName*)</span></span>                       | <span data-ttu-id="b19a7-158">*TypeName* est l’un des types ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="b19a7-158">*TypeName* is any of the above types.</span></span> <span data-ttu-id="b19a7-159">Tableau de ces types.</span><span class="sxs-lookup"><span data-stu-id="b19a7-159">Array of these types.</span></span>                                                                                                                                                   |
| <span data-ttu-id="b19a7-160">**TypeName \***</span><span class="sxs-lookup"><span data-stu-id="b19a7-160">**TypeName \***</span></span>                                 | <span data-ttu-id="b19a7-161">*TypeName* est l’un des types ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="b19a7-161">*TypeName* is any of the above types.</span></span> <span data-ttu-id="b19a7-162">Pointeur vers un type.</span><span class="sxs-lookup"><span data-stu-id="b19a7-162">Pointer to a type.</span></span>                                                                                                                                                      |
| <span data-ttu-id="b19a7-163">**Décimal**</span><span class="sxs-lookup"><span data-stu-id="b19a7-163">**Decimal**</span></span>                                     | <span data-ttu-id="b19a7-164">entier binaire non signé 96 bits mis à l’échelle par une puissance variable de 10.</span><span class="sxs-lookup"><span data-stu-id="b19a7-164">96-bit unsigned binary integer scaled by a variable power of 10.</span></span> <span data-ttu-id="b19a7-165">Type de données décimal qui fournit une taille et une échelle pour un nombre (comme en coordonnées).</span><span class="sxs-lookup"><span data-stu-id="b19a7-165">A decimal data type that provides a size and a scale for a number (as in coordinates).</span></span>                                                       |



 

<span data-ttu-id="b19a7-166">Un paramètre est compatible avec Automation si son type est un type compatible Automation, un pointeur vers un type compatible Automation ou un SAFEARRAY d’un type compatible Automation.</span><span class="sxs-lookup"><span data-stu-id="b19a7-166">A parameter is compatible with Automation if its type is an Automation-compatible type, a pointer to an Automation-compatible type, or a SAFEARRAY of an Automation-compatible type.</span></span>

<span data-ttu-id="b19a7-167">Un type de retour est compatible avec Automation si son type est un HRESULT, SCODE ou [**void**](void.md).</span><span class="sxs-lookup"><span data-stu-id="b19a7-167">A return type is compatible with Automation if its type is an HRESULT, SCODE or [**void**](void.md).</span></span> <span data-ttu-id="b19a7-168">Toutefois, MIDL requiert que les méthodes d’interface retournent HRESULT ou SCODE.</span><span class="sxs-lookup"><span data-stu-id="b19a7-168">However, MIDL requires that interface methods return either HRESULT or SCODE.</span></span> <span data-ttu-id="b19a7-169">Le retour de **void** génère une erreur du compilateur.</span><span class="sxs-lookup"><span data-stu-id="b19a7-169">Returning **void** generates a compiler error.</span></span>

<span data-ttu-id="b19a7-170">Un membre est compatible avec Automation si son type de retour et tous ses paramètres sont compatibles avec Automation.</span><span class="sxs-lookup"><span data-stu-id="b19a7-170">A member is compatible with Automation if its return type and all its parameters are Automation compatible.</span></span>

<span data-ttu-id="b19a7-171">Une interface est compatible avec l’Automation si elle est dérivée de [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) ou [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), elle a l’attribut **\[ OLEAUTOMATION \]** , et toutes ses entrées VTBL sont compatibles Automation.</span><span class="sxs-lookup"><span data-stu-id="b19a7-171">An interface is compatible with Automation if it is derived from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) or [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), it has the **\[oleautomation\]** attribute, and all of its VTBL entries are Automation compatible.</span></span> <span data-ttu-id="b19a7-172">Pour les plateformes 32 bits, la Convention d’appel pour toutes les méthodes dans l’interface doit être STDCALL.</span><span class="sxs-lookup"><span data-stu-id="b19a7-172">For 32-bit platforms, the calling convention for all methods in the interface must be STDCALL.</span></span> <span data-ttu-id="b19a7-173">Pour les systèmes 16 bits, toutes les méthodes doivent avoir la Convention d’appel CDECL.</span><span class="sxs-lookup"><span data-stu-id="b19a7-173">For 16-bit systems, all methods must have the CDECL calling convention.</span></span>

<span data-ttu-id="b19a7-174">Chaque [**dispinterface**](dispinterface.md) est implicitement compatible avec Automation.</span><span class="sxs-lookup"><span data-stu-id="b19a7-174">Every [**dispinterface**](dispinterface.md) is implicitly Automation-compatible.</span></span> <span data-ttu-id="b19a7-175">Par conséquent, vous ne devez pas utiliser l’attribut **\[ \] oleautomation** sur **dispinterface**.</span><span class="sxs-lookup"><span data-stu-id="b19a7-175">Therefore you should not use the **\[oleautomation\]** attribute on **dispinterface**.</span></span>

<span data-ttu-id="b19a7-176">L’attribut **\[ \] oleautomation** n’est pas disponible quand vous compilez à l’aide du commutateur [**/OSF**](-osf.md) du compilateur MIDL.</span><span class="sxs-lookup"><span data-stu-id="b19a7-176">The **\[oleautomation\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.</span></span>

### <a name="flags"></a><span data-ttu-id="b19a7-177">Indicateurs</span><span class="sxs-lookup"><span data-stu-id="b19a7-177">Flags</span></span>

<span data-ttu-id="b19a7-178">TYPEFLAG \_ FOLEAUTOMATION</span><span class="sxs-lookup"><span data-stu-id="b19a7-178">TYPEFLAG\_FOLEAUTOMATION</span></span>

## <a name="examples"></a><span data-ttu-id="b19a7-179">Exemples</span><span class="sxs-lookup"><span data-stu-id="b19a7-179">Examples</span></span>

``` syntax
library Hello
{
    importlib("stdole32.tlb");
    [
        uuid(12345678-1234-1234-1234-123456789ABC),
        helpstring("Application object for the Hello application."),
        oleautomation,
        dual
    ]
    interface IHello : IDispatch
    {
        // Interface definition statements.
    }

    // Other library definition statements.
}
```

## <a name="see-also"></a><span data-ttu-id="b19a7-180">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b19a7-180">See also</span></span>

<dl> <dt>

[<span data-ttu-id="b19a7-181">Fichier de définition d’interface (IDL)</span><span class="sxs-lookup"><span data-stu-id="b19a7-181">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="b19a7-182">Génération d’une bibliothèque de types avec MIDL</span><span class="sxs-lookup"><span data-stu-id="b19a7-182">Generating a Type Library With MIDL</span></span>](generating-a-type-library-with-midl-2.md)
</dt> <dt>

[<span data-ttu-id="b19a7-183">Exemple de fichier ODL</span><span class="sxs-lookup"><span data-stu-id="b19a7-183">ODL File Example</span></span>](/previous-versions/windows/desktop/automat/odl-file-example)
</dt> <dt>

[<span data-ttu-id="b19a7-184">Syntaxe du fichier ODL</span><span class="sxs-lookup"><span data-stu-id="b19a7-184">ODL File Syntax</span></span>](/previous-versions/windows/desktop/automat/odl-file-syntax)
</dt> <dt>

[<span data-ttu-id="b19a7-185">**/osf**</span><span class="sxs-lookup"><span data-stu-id="b19a7-185">**/osf**</span></span>](-osf.md)
</dt> <dt>

[<span data-ttu-id="b19a7-186">**universel**</span><span class="sxs-lookup"><span data-stu-id="b19a7-186">**uuid**</span></span>](uuid.md)
</dt> </dl>

 

 