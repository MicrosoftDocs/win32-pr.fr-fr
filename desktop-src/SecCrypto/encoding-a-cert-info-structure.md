---
description: Le processus d’encodage est l’inverse du processus de décodage décrit dans décoder une structure d’informations de certificat \_ .
ms.assetid: 5d3311e5-a2fb-46f7-aa76-f232b39b34fd
title: Encodage d’une structure CERT_INFO
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 645a1d3054546a7b11c57d4f515dc7d3e26b5fe0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106530272"
---
# <a name="encoding-a-cert_info-structure"></a><span data-ttu-id="01806-103">Encodage d’une structure d’informations de certificat \_</span><span class="sxs-lookup"><span data-stu-id="01806-103">Encoding a CERT\_INFO Structure</span></span>

<span data-ttu-id="01806-104">Le processus d’encodage est l’inverse du processus de décodage décrit dans [décoder une \_ structure d’informations de certificat](decoding-a-cert-info-structure.md).</span><span class="sxs-lookup"><span data-stu-id="01806-104">The encoding process is the reverse of the decoding process described in [Decoding a CERT\_INFO Structure](decoding-a-cert-info-structure.md).</span></span> <span data-ttu-id="01806-105">Par exemple, la procédure suivante ajoute un **émetteur** encodé à une structure d’informations de [**certificat \_**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) .</span><span class="sxs-lookup"><span data-stu-id="01806-105">For example, the following procedure would add an encoded **Issuer** to a [**CERT\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) structure.</span></span> <span data-ttu-id="01806-106">Consultez également l’illustration qui suit la procédure.</span><span class="sxs-lookup"><span data-stu-id="01806-106">Also see the illustration that follows the procedure.</span></span>

<span data-ttu-id="01806-107">**Pour ajouter un émetteur encodé à une structure d’informations de certificat \_**</span><span class="sxs-lookup"><span data-stu-id="01806-107">**To add an encoded Issuer to a CERT\_INFO structure**</span></span>

1.  <span data-ttu-id="01806-108">Créez une chaîne contenant le nom de l’émetteur à utiliser.</span><span class="sxs-lookup"><span data-stu-id="01806-108">Create a string containing the issuer name to be used.</span></span>
2.  <span data-ttu-id="01806-109">Créez un tableau de [**structures \_ \_ attr RDN de CERT**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) , qui seront initialisées pour contenir les informations appropriées sur la chaîne de nom d’émetteur que vous venez de créer.</span><span class="sxs-lookup"><span data-stu-id="01806-109">Create an array of [**CERT\_RDN\_ATTR**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) structures, which will be initialized to contain the proper information about the issuer name string just created.</span></span>
3.  <span data-ttu-id="01806-110">Créez un tableau de structures de compte [**\_ RDN de certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) , dont l’une contient les informations sur le tableau de structures [**\_ \_ attr RDN de CERT**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) qui vient d’être initialisé.</span><span class="sxs-lookup"><span data-stu-id="01806-110">Create an array of [**CERT\_RDN**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) structures, one of which has the information about the array of [**CERT\_RDN\_ATTR**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) structures just initialized.</span></span>
4.  <span data-ttu-id="01806-111">Créez une structure d' [**\_ \_ informations de nom de certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) qui a un pointeur vers le tableau de structures de nom [**\_ RDN de certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) que vous venez de créer.</span><span class="sxs-lookup"><span data-stu-id="01806-111">Create a [**CERT\_NAME\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) structure that has a pointer to the array of [**CERT\_RDN**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) structures that just created.</span></span>
5.  <span data-ttu-id="01806-112">Appelez [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) pour connaître la taille de l’objet BLOB encodé de sortie, en lui transmettant l’adresse de la structure d' [**\_ \_ informations du nom de certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) que vous venez de créer.</span><span class="sxs-lookup"><span data-stu-id="01806-112">Call [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) to get the size of the output encoded BLOB, passing it the address of the [**CERT\_NAME\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) structure that you just created.</span></span>
6.  <span data-ttu-id="01806-113">Allouez de la mémoire pour l’objet BLOB encodé de sortie.</span><span class="sxs-lookup"><span data-stu-id="01806-113">Allocate memory for the output encoded BLOB.</span></span>
7.  <span data-ttu-id="01806-114">Appelez à nouveau [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) , en lui transmettant les mêmes informations, mais en lui transmettant à présent l’adresse de la mémoire qui vient d’être allouée.</span><span class="sxs-lookup"><span data-stu-id="01806-114">Call [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) again, passing it the same information, but now passing it the address of the memory just allocated.</span></span>
8.  <span data-ttu-id="01806-115">Définissez le membre **Issuer. cbData** de la structure des [**\_ informations de certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) sur la taille retournée à l’étape 5 et le membre **émetteur. pbData** sur l’adresse obtenue à l’étape 6.</span><span class="sxs-lookup"><span data-stu-id="01806-115">Set the **Issuer.cbData** member of the [**CERT\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) structure to the size returned in step 5, and the **Issuer.pbData** member to the address obtained in step 6.</span></span> <span data-ttu-id="01806-116">L’objet blob d' **émetteur** encodé se trouve maintenant ici.</span><span class="sxs-lookup"><span data-stu-id="01806-116">The encoded **Issuer** BLOB now resides there.</span></span>

![Ajout d’un émetteur encodé à une structure d’informations de certificat \-](images/encflow.png)

<span data-ttu-id="01806-118">Pour initialiser et encoder certaines informations d’extension de certificat, utilisez la procédure suivante.</span><span class="sxs-lookup"><span data-stu-id="01806-118">To initialize and encode some certificate extension information, use the following procedure.</span></span> <span data-ttu-id="01806-119">Consultez également l’illustration qui suit la procédure.</span><span class="sxs-lookup"><span data-stu-id="01806-119">Also see the illustration that follows the procedure.</span></span>

<span data-ttu-id="01806-120">**Pour ajouter des informations d’extension encodées à une structure d’informations de certificat \_**</span><span class="sxs-lookup"><span data-stu-id="01806-120">**To add encoded extension information to a CERT\_INFO structure**</span></span>

1.  <span data-ttu-id="01806-121">Créer et initialiser une structure d’informations d’extension : pour cet exemple, il s’agit d’une structure d’informations de [**\_ contraintes de base \_ \_ CERT**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_basic_constraints_info) .</span><span class="sxs-lookup"><span data-stu-id="01806-121">Create and initialize an extension information structure—for this example, it is a [**CERT\_BASIC\_CONSTRAINTS\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_basic_constraints_info) structure.</span></span>
2.  <span data-ttu-id="01806-122">Appelez [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject), en lui transmettant l’adresse de la structure que vous venez de créer, pour connaître la taille de l’objet BLOB encodé de sortie.</span><span class="sxs-lookup"><span data-stu-id="01806-122">Call [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject), passing it the address of the structure just created, to get the size of the output encoded BLOB.</span></span>
3.  <span data-ttu-id="01806-123">Allouez de la mémoire pour l’objet BLOB encodé de sortie.</span><span class="sxs-lookup"><span data-stu-id="01806-123">Allocate memory for the output encoded BLOB.</span></span>
4.  <span data-ttu-id="01806-124">Appelez à nouveau [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) , en passant les mêmes informations, à l’exception de Pass à présent dans l’adresse de la mémoire allouée.</span><span class="sxs-lookup"><span data-stu-id="01806-124">Call [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) again, passing the same information, except now pass in the address of the allocated memory.</span></span>
5.  <span data-ttu-id="01806-125">Créez un tableau de structures d' [**\_ extension de certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) .</span><span class="sxs-lookup"><span data-stu-id="01806-125">Create an array of [**CERT\_EXTENSION**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) structures.</span></span>
6.  <span data-ttu-id="01806-126">Initialisez une des structures [**d' \_ extension du certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) afin que **pszObjId** soit la chaîne appropriée pour les données contenues dans la **valeur**, et cette **valeur** contient l’objet blob de données chiffrées qui a été généré à partir de l’appel à [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject).</span><span class="sxs-lookup"><span data-stu-id="01806-126">Initialize one of the [**CERT\_EXTENSION**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) structures so that the **pszObjId** is the proper string for the data contained in **Value**, and that **Value** contains the encrypted data BLOB that was output from the call to [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject).</span></span>
7.  <span data-ttu-id="01806-127">Initialisez le membre **rgExtension** de la structure d' [**\_ informations de certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) pour qu’il pointe vers le tableau de structures d' [**\_ extension de certificat**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) .</span><span class="sxs-lookup"><span data-stu-id="01806-127">Initialize the **rgExtension** member of the [**CERT\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) structure to point to the array of [**CERT\_EXTENSION**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) structures.</span></span>

![Ajout d’informations d’extension encodées à une structure d’informations de certificat \-](images/xtenflow.png)

 

 



