---
description: Les applications qui utilisent des objets CAPICOM doivent être créées à l’aide de CAPICOM.dll. CAPICOM.dll doit également être présente et inscrite au moment de l’exécution pour utiliser les objets CAPICOM.
ms.assetid: 69de5232-e2f9-4aed-935d-5fbcd7998cc9
title: Préparation à l’utilisation de CAPICOM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f6fc1ad0dbfe3d4f8c4dae3286eb3ffa5e1ae03d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106521892"
---
# <a name="getting-ready-to-use-capicom"></a><span data-ttu-id="ee613-104">Préparation à l’utilisation de CAPICOM</span><span class="sxs-lookup"><span data-stu-id="ee613-104">Getting Ready to Use CAPICOM</span></span>

<span data-ttu-id="ee613-105">\[CAPICOM est un composant uniquement de 32 bits qui peut être utilisé dans les systèmes d’exploitation suivants : Windows Server 2008, Windows Vista et Windows XP.</span><span class="sxs-lookup"><span data-stu-id="ee613-105">\[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows Server 2008, Windows Vista, and Windows XP.</span></span> <span data-ttu-id="ee613-106">Utilisez plutôt le .NET Framework pour implémenter des fonctionnalités de sécurité.</span><span class="sxs-lookup"><span data-stu-id="ee613-106">Instead, use the .NET Framework to implement security features.</span></span> <span data-ttu-id="ee613-107">Pour plus d’informations, consultez [alternatives à l’utilisation de](alternatives-to-using-capicom.md)CAPICOM.\]</span><span class="sxs-lookup"><span data-stu-id="ee613-107">For more information, see [Alternatives to Using CAPICOM](alternatives-to-using-capicom.md).\]</span></span>

<span data-ttu-id="ee613-108">Les applications qui utilisent des objets CAPICOM doivent être créées à l’aide de CAPICOM.dll.</span><span class="sxs-lookup"><span data-stu-id="ee613-108">Applications that use CAPICOM objects must be created by using CAPICOM.dll.</span></span> <span data-ttu-id="ee613-109">CAPICOM.dll doit également être présente et inscrite au moment de l’exécution pour utiliser les objets CAPICOM.</span><span class="sxs-lookup"><span data-stu-id="ee613-109">CAPICOM.dll must also be present and registered at run time to use CAPICOM objects.</span></span> <span data-ttu-id="ee613-110">CAPICOM.dll doit être ajouté aux références de projets Visual Basic pour utiliser les objets CAPICOM.</span><span class="sxs-lookup"><span data-stu-id="ee613-110">CAPICOM.dll should be added to Visual Basic projects references to use CAPICOM objects.</span></span>

<span data-ttu-id="ee613-111">CAPICOM est disponible sous la forme d’un fichier redistribuable qui peut être téléchargé à partir de [Platform SDK Redistributable : CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span><span class="sxs-lookup"><span data-stu-id="ee613-111">CAPICOM is available as a redistributable file that can be downloaded from [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span></span> <span data-ttu-id="ee613-112">Pour plus d’informations sur les versions de CAPICOM, consultez [CAPICOM versions](capicom-versions.md).</span><span class="sxs-lookup"><span data-stu-id="ee613-112">For information about CAPICOM versions, see [CAPICOM Versions](capicom-versions.md).</span></span>

<span data-ttu-id="ee613-113">**Pour inscrire CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="ee613-113">**To register CAPICOM.dll**</span></span>

-   <span data-ttu-id="ee613-114">À l’invite de commandes, accédez au répertoire dans lequel CAPICOM.dll est stocké, puis entrez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="ee613-114">At a command prompt, change the directory to the directory where CAPICOM.dll is stored, and then enter the following command:</span></span>

    <span data-ttu-id="ee613-115">**CAPICOM.dllregsvr32**</span><span class="sxs-lookup"><span data-stu-id="ee613-115">**regsvr32 CAPICOM.dll**</span></span>

## <a name="example-code-limitations"></a><span data-ttu-id="ee613-116">Exemples de limitations de code</span><span class="sxs-lookup"><span data-stu-id="ee613-116">Example Code Limitations</span></span>

<span data-ttu-id="ee613-117">Pour fournir un code plus concis et plus lisible, les principes d’une bonne pratique de programmation ne sont pas toujours suivis dans ces exemples.</span><span class="sxs-lookup"><span data-stu-id="ee613-117">To provide more concise, more readable code, principles of good programming practice are not always followed in these examples.</span></span> <span data-ttu-id="ee613-118">En particulier, seules des réponses d’erreur limitées sont affichées.</span><span class="sxs-lookup"><span data-stu-id="ee613-118">In particular, only limited error responses are shown.</span></span> <span data-ttu-id="ee613-119">Les applications de travail doivent toujours vérifier les codes d’erreur renvoyés et effectuer les actions appropriées lorsqu’une erreur est rencontrée.</span><span class="sxs-lookup"><span data-stu-id="ee613-119">Working applications should always check returned error codes and perform appropriate actions when an error is encountered.</span></span>

## <a name="necessary-key-containers-keys-and-certificates-in-capicom"></a><span data-ttu-id="ee613-120">Conteneurs de clés, clés et certificats nécessaires dans CAPICOM</span><span class="sxs-lookup"><span data-stu-id="ee613-120">Necessary Key Containers, Keys, and Certificates in CAPICOM</span></span>

<span data-ttu-id="ee613-121">Alors que certaines opérations avec des objets CAPICOM peuvent être effectuées sur n’importe quel ordinateur par un utilisateur, la création de [*signatures numériques*](../secgloss/d-gly.md) et la récupération du contenu en texte en clair d’un message enveloppé à l’aide d’objets CAPICOM sont des opérations basées sur les certificats.</span><span class="sxs-lookup"><span data-stu-id="ee613-121">While some operations with CAPICOM objects can be done on any computer by any user, creating [*digital signatures*](../secgloss/d-gly.md) and retrieving the plaintext content of an enveloped message using CAPICOM objects are certificate-based operations.</span></span> <span data-ttu-id="ee613-122">L’utilisateur qui crée une signature numérique et l’utilisateur qui récupère le contenu chiffré d’un message enveloppé doit avoir un certificat numérique avec une clé privée associée disponible.</span><span class="sxs-lookup"><span data-stu-id="ee613-122">The user who creates a digital signature and the user who retrieves the encrypted contents of an enveloped message must have a digital certificate with an available associated private key.</span></span> <span data-ttu-id="ee613-123">Si un certificat avec une clé privée associée n’est pas présent, l’opération de chiffrement échoue.</span><span class="sxs-lookup"><span data-stu-id="ee613-123">If a certificate with an associated private key is not present, the cryptographic operation will fail.</span></span> <span data-ttu-id="ee613-124">Les utilisateurs des applications CAPICOM doivent s’assurer qu’ils disposent du certificat approprié et de la clé privée disponible lorsque les applications sont en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="ee613-124">Users of CAPICOM applications must ensure that they have the appropriate certificate and available private key when the applications are running.</span></span>

<span data-ttu-id="ee613-125">Certains exemples des sections suivantes effectuent des opérations qui nécessitent une [*paire de clés publique/privée*](../secgloss/p-gly.md) disponible pour le chiffrement et le déchiffrement des fichiers, des messages et des signatures.</span><span class="sxs-lookup"><span data-stu-id="ee613-125">Some examples in the following sections perform operations that require an available [*public/private key pair*](../secgloss/p-gly.md) for encrypting and decrypting files, messages, and signatures.</span></span> <span data-ttu-id="ee613-126">La plupart de ces programmes se compilent et s’exécutent mais échouent au moment de l’exécution sans l’existence de [*conteneurs de clés*](../secgloss/k-gly.md), de clés, de magasins de certificats et de [*certificats*](../secgloss/c-gly.md) appropriés dans ces magasins.</span><span class="sxs-lookup"><span data-stu-id="ee613-126">Many of these programs will compile and run but fail at run time without the existence of proper [*key containers*](../secgloss/k-gly.md), keys, certificate stores, and [*certificates*](../secgloss/c-gly.md) in those stores.</span></span>

<span data-ttu-id="ee613-127">**Pour créer un certificat auto-signé**</span><span class="sxs-lookup"><span data-stu-id="ee613-127">**To create a self-signed certificate**</span></span>

1.  <span data-ttu-id="ee613-128">Installez les outils de signature.</span><span class="sxs-lookup"><span data-stu-id="ee613-128">Install the signing tools.</span></span> <span data-ttu-id="ee613-129">Celles-ci sont installées dans le cadre du kit de développement logiciel (SDK) de Microsoft Windows, du kit de développement logiciel (SDK) de la plateforme ou du kit de développement logiciel (SDK) .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ee613-129">These are installed as part of the Microsoft Windows Software Development Kit (SDK), the Platform Software Development Kit (SDK), or the .NET Framework SDK.</span></span>
2.  <span data-ttu-id="ee613-130">Après avoir téléchargé Makecert.exe, exécutez la commande suivante à partir d’une invite de commandes, en remplaçant le nom d’utilisateur par un nom *d'* utilisateur, le nom de l’organisation par *Nom_organisation* et le nom de société *CompanyName*:</span><span class="sxs-lookup"><span data-stu-id="ee613-130">After Makecert.exe is downloaded, run the following command at a command prompt, substituting a user name for *UserName*, an organization name for *OrganizationName*, and a company name for *CompanyName*:</span></span>

    <span data-ttu-id="ee613-131">**Makecert-r-n "CN =**_username_*_, ou =_*_Nom_organisation_*_, o =_*_CompanyName_*_"-SS My_*</span><span class="sxs-lookup"><span data-stu-id="ee613-131">**makecert -r -n "cn=**_UserName_*_, ou=_*_OrganizationName_*_, o=_*_CompanyName_*_" -ss my_*</span></span>

3.  <span data-ttu-id="ee613-132">Le certificat peut être placé dans le magasin My de l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="ee613-132">The certificate can be placed in the My store of the current user.</span></span> <span data-ttu-id="ee613-133">Importez le certificat créé dans le magasin racine afin qu’il soit approuvé.</span><span class="sxs-lookup"><span data-stu-id="ee613-133">Import the certificate created into the root store so that it is trusted.</span></span>

 

 
