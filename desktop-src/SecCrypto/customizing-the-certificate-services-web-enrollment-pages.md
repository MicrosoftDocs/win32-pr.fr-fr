---
description: Les services de certificats fournissent des pages d’inscription par le Web qui peuvent être utilisées pour demander des certificats.
ms.assetid: 1e198bc8-c712-4d0f-9e3a-35a295445acf
title: Personnalisation des pages d’inscription par le Web des services de certificats
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4eb2fbf421eceb1ebf0b15379aca5d0788a992ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103868429"
---
# <a name="customizing-certificate-services-web-enrollment-pages"></a><span data-ttu-id="1c441-103">Personnalisation des pages d’inscription par le Web des services de certificats</span><span class="sxs-lookup"><span data-stu-id="1c441-103">Customizing Certificate Services Web Enrollment Pages</span></span>

<span data-ttu-id="1c441-104">Les [*services de certificats*](../secgloss/c-gly.md) fournissent des pages d’inscription par le Web qui peuvent être utilisées pour demander des certificats.</span><span class="sxs-lookup"><span data-stu-id="1c441-104">[*Certificate Services*](../secgloss/c-gly.md) provides web enrollment pages that can be used to request certificates.</span></span> <span data-ttu-id="1c441-105">Un administrateur peut personnaliser certains des éléments qui peuvent être affichés dans les pages d’inscription par le Web. Toutefois, vous devez être familiarisé avec les pages d’inscription par le Web et les scripts Web avant d’apporter des modifications.</span><span class="sxs-lookup"><span data-stu-id="1c441-105">An administrator can customize some of the items that can be viewed in the web enrollment pages; however, you should be familiar with the web enrollment pages and web scripting before making any changes.</span></span> <span data-ttu-id="1c441-106">Pour plus d’informations sur les scripts Web, consultez [Scripting](/previous-versions/ms950396(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="1c441-106">For more information about web scripting, see [Scripting](/previous-versions/ms950396(v=msdn.10)).</span></span>

<span data-ttu-id="1c441-107">Les valeurs par défaut des champs nom unique pour organisation, unité d’organisation, localité, État et pays/région correspondent aux valeurs spécifiées pour l' [*autorité de certification*](../secgloss/c-gly.md) (ca) lors de l’installation des services de certificats.</span><span class="sxs-lookup"><span data-stu-id="1c441-107">The default values for the Distinguished Name fields for Organization, Organizational Unit, Locality, State, and Country/Region are the values specified for the [*certification authority*](../secgloss/c-gly.md) (CA) when Certificate Services is installed.</span></span> <span data-ttu-id="1c441-108">Ces valeurs par défaut apparaissent dans les pages Web et peuvent être modifiées par l’utilisateur pendant le processus d’inscription de certificats.</span><span class="sxs-lookup"><span data-stu-id="1c441-108">These default values appear in the webpages and can be changed by the user during the certificate enrollment process.</span></span> <span data-ttu-id="1c441-109">Toutefois, si vous souhaitez que d’autres valeurs par défaut apparaissent dans les pages Web, vous pouvez modifier le fichier Certdat. Inc (dans le chemin d’accès \\ *WindowsDirectory* \\ system32 \\ certsrv \\ ); plus précisément, vous pouvez assigner des valeurs personnalisées aux variables suivantes fournies pour la personnalisation.</span><span class="sxs-lookup"><span data-stu-id="1c441-109">However, if you want other default values to appear in the webpages, you can edit the Certdat.inc file (in the path \\*WindowsDirectory*\\System32\\Certsrv\\); specifically, you can assign custom values to the following variables provided for customization.</span></span>



| <span data-ttu-id="1c441-110">Variable</span><span class="sxs-lookup"><span data-stu-id="1c441-110">Variable</span></span>            | <span data-ttu-id="1c441-111">Description</span><span class="sxs-lookup"><span data-stu-id="1c441-111">Description</span></span>                                                                                                                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1c441-112">sDefaultCompany</span><span class="sxs-lookup"><span data-stu-id="1c441-112">sDefaultCompany</span></span>     | <span data-ttu-id="1c441-113">Société par défaut (apparaît dans la [*demande de certificat*](../secgloss/c-gly.md) en tant que champ d’organisation [*X. 509*](../secgloss/x-gly.md) ).</span><span class="sxs-lookup"><span data-stu-id="1c441-113">Default company (appears in the [*certificate request*](../secgloss/c-gly.md) as the [*X.509*](../secgloss/x-gly.md) Organization field).</span></span> |
| <span data-ttu-id="1c441-114">sDefaultOrgUnit</span><span class="sxs-lookup"><span data-stu-id="1c441-114">sDefaultOrgUnit</span></span>     | <span data-ttu-id="1c441-115">Service par défaut (apparaît dans la demande de certificat en tant que champ d’unité d’organisation X. 509).</span><span class="sxs-lookup"><span data-stu-id="1c441-115">Default department (appears in the certificate request as the X.509 Organizational Unit field).</span></span>                                                                                                                                           |
| <span data-ttu-id="1c441-116">sDefaultLocality</span><span class="sxs-lookup"><span data-stu-id="1c441-116">sDefaultLocality</span></span>    | <span data-ttu-id="1c441-117">Ville par défaut (apparaît dans la demande de certificat en tant que champ d’emplacement X. 509).</span><span class="sxs-lookup"><span data-stu-id="1c441-117">Default city (appears in the certificate request as the X.509 Location field).</span></span>                                                                                                                                                            |
| <span data-ttu-id="1c441-118">sDefaultState</span><span class="sxs-lookup"><span data-stu-id="1c441-118">sDefaultState</span></span>       | <span data-ttu-id="1c441-119">État/province par défaut (apparaît dans la demande de certificat en tant que champ d’État X. 509).</span><span class="sxs-lookup"><span data-stu-id="1c441-119">Default state/province (appears in the certificate request as the X.509 State field).</span></span>                                                                                                                                                     |
| <span data-ttu-id="1c441-120">sDefaultCountry</span><span class="sxs-lookup"><span data-stu-id="1c441-120">sDefaultCountry</span></span>     | <span data-ttu-id="1c441-121">Pays/région par défaut (apparaît dans la demande de certificat comme le champ pays/région X. 509).</span><span class="sxs-lookup"><span data-stu-id="1c441-121">Default country/region (appears in the certificate request as the X.509 Country/Region field).</span></span>                                                                                                                                            |
| <span data-ttu-id="1c441-122">nPendingTimeoutDays</span><span class="sxs-lookup"><span data-stu-id="1c441-122">nPendingTimeoutDays</span></span> | <span data-ttu-id="1c441-123">Nombre de jours pendant lesquels l’utilisateur peut récupérer un certificat en attente une fois qu’il a été demandé.</span><span class="sxs-lookup"><span data-stu-id="1c441-123">Number of days in which the user can retrieve a pending certificate after it has been requested.</span></span>                                                                                                                                          |



 

<span data-ttu-id="1c441-124">Aucune autre variable ne doit être modifiée dans le fichier Certdat. Inc.</span><span class="sxs-lookup"><span data-stu-id="1c441-124">No other variables should be changed in the Certdat.inc file.</span></span>

<span data-ttu-id="1c441-125">L’exemple suivant définit l’unité d’organisation par défaut sur « marketing ».</span><span class="sxs-lookup"><span data-stu-id="1c441-125">The following example sets the default Organizational Unit to "Marketing".</span></span>


```VB
sDefaultOrgUnit="Marketing"
```



<span data-ttu-id="1c441-126">En outre, vous pouvez modifier le fichier Certrqtp. Inc pour ajouter, modifier ou supprimer des [*modèles de certificat*](../secgloss/c-gly.md) ou des types disponibles pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1c441-126">Additionally, you can edit the Certrqtp.inc file to add, change, or remove [*certificate templates*](../secgloss/c-gly.md) or types available to the user.</span></span> <span data-ttu-id="1c441-127">Ces modèles et types, ainsi que les informations connexes, sont contenus dans un tableau dimensionné appelé rgAvailReqTypes (*m*, 5).</span><span class="sxs-lookup"><span data-stu-id="1c441-127">These templates and types, as well as related information, are contained in a dimensioned array called rgAvailReqTypes(*m*,5).</span></span>

<span data-ttu-id="1c441-128">Ce tableau, comme tous les tableaux Visual Basic Scripting Edition, est basé sur zéro et, par conséquent, la première dimension du tableau, *m*, alloue de la mémoire pour les éléments *m*+ 1.</span><span class="sxs-lookup"><span data-stu-id="1c441-128">This array, like all Visual Basic Scripting Edition arrays, is zero based, and as a result, the array's first dimension, *m*, allocates memory for *m*+1 items.</span></span> <span data-ttu-id="1c441-129">Par conséquent, si vous personnalisez les pages Web dans, vous devez modifier le nombre d’éléments dans le tableau rgAvailReqTypes, définir la dimension *m* sur une valeur inférieure au nombre total d’éléments dont vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="1c441-129">Therefore, if in customizing the webpages, you need to modify the number of items in the rgAvailReqTypes array, set the *m* dimension to one less than the total number of items you need.</span></span> <span data-ttu-id="1c441-130">Par exemple, si vous avez sept modèles de certificat, modifiez la déclaration de rgAvailReqTypes comme indiqué dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="1c441-130">For example, if you will have seven certificate templates, change the declaration of rgAvailReqTypes as shown in the following example.</span></span>


```VB
Dim rgAvailReqTypes(6,5)
```



<span data-ttu-id="1c441-131">La deuxième dimension du tableau, qui a toujours la valeur 5, alloue les six champs qui composent chaque élément.</span><span class="sxs-lookup"><span data-stu-id="1c441-131">The array's second dimension, which always has the value five, allocates the six fields that compose each item.</span></span> <span data-ttu-id="1c441-132">Ces six champs représentent le type ou le modèle de certificat, le nom complet associé à ce modèle ou type, et si le modèle requiert des extensions S/MIME ( [*Secure/Multipurpose Internet Mail Extensions*](../secgloss/s-gly.md) ).</span><span class="sxs-lookup"><span data-stu-id="1c441-132">These six fields represent the certificate template or type, the display name associated with this template or type, and whether the template requires [*Secure/Multipurpose Internet Mail Extensions*](../secgloss/s-gly.md) (S/MIME).</span></span>

<span data-ttu-id="1c441-133">Pour faciliter la compréhension de l’accès à ces champs, Certrqtp. Inc fournit également les constantes suivantes que vous pouvez utiliser lors de la définition des valeurs de champ.</span><span class="sxs-lookup"><span data-stu-id="1c441-133">To make it easier to understand which of these fields is being accessed, Certrqtp.inc also provides the following constants you can use when setting field values.</span></span>



| <span data-ttu-id="1c441-134">Constante</span><span class="sxs-lookup"><span data-stu-id="1c441-134">Constant</span></span>                              | <span data-ttu-id="1c441-135">Description</span><span class="sxs-lookup"><span data-stu-id="1c441-135">Description</span></span>                                                                                                                                                                                                                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1c441-136">**OID du champ \_**</span><span class="sxs-lookup"><span data-stu-id="1c441-136">**FIELD\_OID**</span></span>                        | <span data-ttu-id="1c441-137">(S’applique aux autorités de certification autonomes) Index du premier champ de l’élément ; représente un [*identificateur d’objet*](../secgloss/o-gly.md) (OID) pour un type de certificat.</span><span class="sxs-lookup"><span data-stu-id="1c441-137">(Applies to stand-alone CAs) Index to the item's first field; represents an [*object identifier*](../secgloss/o-gly.md) (OID) for a certificate type.</span></span><br/>                                                                                                           |
| <span data-ttu-id="1c441-138">**modèle de champ \_**</span><span class="sxs-lookup"><span data-stu-id="1c441-138">**FIELD\_TEMPLATE**</span></span>                   | <span data-ttu-id="1c441-139">(S’applique aux autorités de certification d’entreprise) Index du premier champ de l’élément ; représente un modèle de certificat.</span><span class="sxs-lookup"><span data-stu-id="1c441-139">(Applies to enterprise CAs) Index to the item's first field; represents a certificate template.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="1c441-140">**CHAMP \_ FRIENDLYNAME**</span><span class="sxs-lookup"><span data-stu-id="1c441-140">**FIELD\_FRIENDLYNAME**</span></span>               | <span data-ttu-id="1c441-141">Index du deuxième champ de l’élément ; représente le nom complet (que l’utilisateur verra lors de l’inscription) de l’élément dans le premier champ.</span><span class="sxs-lookup"><span data-stu-id="1c441-141">Index to the item's second field; represents the display name (which the user will see when enrolling) of the item in the first field.</span></span>                                                                                                                                                                                               |
| <span data-ttu-id="1c441-142">**CHAMP \_ CSPLIST**</span><span class="sxs-lookup"><span data-stu-id="1c441-142">**FIELD\_CSPLIST**</span></span>                    | <span data-ttu-id="1c441-143">Indexez le troisième champ de l’élément.</span><span class="sxs-lookup"><span data-stu-id="1c441-143">Index to the item's third field.</span></span> <span data-ttu-id="1c441-144">Liste des noms de [*fournisseurs de services de chiffrement*](../secgloss/c-gly.md) autorisés par le modèle.</span><span class="sxs-lookup"><span data-stu-id="1c441-144">A list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="1c441-145">Chaque nom de la liste est séparé par un point d’interrogation ( ?).</span><span class="sxs-lookup"><span data-stu-id="1c441-145">Each name in the list is separated by a question mark (?).</span></span>                                                    |
| <span data-ttu-id="1c441-146">**CHAMP \_ CSPLIST2**</span><span class="sxs-lookup"><span data-stu-id="1c441-146">**FIELD\_CSPLIST2**</span></span>                   | <span data-ttu-id="1c441-147">Indexez le quatrième champ de l’élément.</span><span class="sxs-lookup"><span data-stu-id="1c441-147">Index to the item's fourth field.</span></span> <span data-ttu-id="1c441-148">Liste secondaire de noms de [*fournisseur de services de chiffrement*](../secgloss/c-gly.md) autorisés par le modèle.</span><span class="sxs-lookup"><span data-stu-id="1c441-148">A secondary list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="1c441-149">Chaque nom de la liste est séparé par un point d’interrogation ( ?).</span><span class="sxs-lookup"><span data-stu-id="1c441-149">Each name in the list is separated by a question mark (?).</span></span> <span data-ttu-id="1c441-150">Cette liste fournit une valeur par défaut différente.</span><span class="sxs-lookup"><span data-stu-id="1c441-150">This list provides a different default.</span></span> |
| <span data-ttu-id="1c441-151">**CHAMP \_ EXportable**</span><span class="sxs-lookup"><span data-stu-id="1c441-151">**FIELD\_EXPORTABLE**</span></span>                 | <span data-ttu-id="1c441-152">Indexez le cinquième champ de l’élément.</span><span class="sxs-lookup"><span data-stu-id="1c441-152">Index to the item's fifth field.</span></span> <span data-ttu-id="1c441-153">Indique si le modèle spécifie que la clé doit être exportable.</span><span class="sxs-lookup"><span data-stu-id="1c441-153">Indicates whether the template specifies that the key should be exportable.</span></span> <span data-ttu-id="1c441-154">Si ce champ contient la valeur « true », la clé peut être exportée.</span><span class="sxs-lookup"><span data-stu-id="1c441-154">If this field contains "True", the key is exportable.</span></span> <span data-ttu-id="1c441-155">Si ce champ contient « false », la clé ne peut pas être exportée.</span><span class="sxs-lookup"><span data-stu-id="1c441-155">If this field contains "False", the key is not exportable.</span></span>                                                                                                        |
| <span data-ttu-id="1c441-156">**le champ \_ a besoin de \_ \_ fonctionnalités SMIME**</span><span class="sxs-lookup"><span data-stu-id="1c441-156">**FIELD\_NEEDS\_SMIME\_CAPABILITIES**</span></span> | <span data-ttu-id="1c441-157">Cette constante n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="1c441-157">This constant is not supported.</span></span>                                                                                                                                                                                                                                                                                                      |



 

<span data-ttu-id="1c441-158">Par exemple, les expressions suivantes affectent l’OID de 1.3.6.1.5.5.7.3.2 au premier champ de l’élément et affectent « certificat de navigateur Web » au deuxième champ de l’élément (la valeur de tableau de zéro indexe le premier élément).</span><span class="sxs-lookup"><span data-stu-id="1c441-158">For example, the following expressions assign the OID of 1.3.6.1.5.5.7.3.2 to the first item's first field and assign "Web Browser Certificate" to the first item's second field (the array value of zero indexes the first item).</span></span>


```VB
rgAvailReqTypes(0, FIELD_OID) = "1.3.6.1.5.5.7.3.2"
rgAvailReqTypes(0, FIELD_FRIENDLYNAME) = "Web Browser Certificate"
```



<span data-ttu-id="1c441-159">Le résultat de ces attributions est que l’utilisateur verra le texte du **certificat de navigateur Web** lors de l’inscription, et si l’utilisateur sélectionne le **certificat de navigateur Web**, la [*demande de certificat*](../secgloss/c-gly.md) contiendra l’OID 1.3.6.1.5.5.7.3.2.</span><span class="sxs-lookup"><span data-stu-id="1c441-159">The result of these assignments is that the user will see the text **Web Browser Certificate** when enrolling, and if the user selects **Web Browser Certificate**, the [*certificate request*](../secgloss/c-gly.md) will contain the OID 1.3.6.1.5.5.7.3.2.</span></span>

<span data-ttu-id="1c441-160">Le fichier Certrqtp. Inc contient également des constantes qui sont utilisées pour les noms d’affichage des modèles ou des types de certificats.</span><span class="sxs-lookup"><span data-stu-id="1c441-160">The Certrqtp.inc file also contains constants that are used for the display names of the certificate templates or types.</span></span> <span data-ttu-id="1c441-161">L’exemple suivant illustre le format.</span><span class="sxs-lookup"><span data-stu-id="1c441-161">The following example shows the format.</span></span>


```VB
' Strings for localization.
Const L_WebBrowserCert_Text="Web Browser Certificate"
Const L_EmailProtectionCert_Text="E-Mail Protection Certificate"
Const L_UserTemplateCert_Text="User Certificate"
```



<span data-ttu-id="1c441-162">Ces constantes sont définies dans un bloc dans le fichier Certrqtp. Inc, et ce regroupement facilite l’affectation d’une valeur personnalisée à chacune d’elles.</span><span class="sxs-lookup"><span data-stu-id="1c441-162">These constants are defined in a block in the Certrqtp.inc file, and this grouping makes it easier to assign each of them a custom value.</span></span> <span data-ttu-id="1c441-163">Cela s’avère particulièrement utile lorsque vous localisez les noms complets des versions internationales des pages Web.</span><span class="sxs-lookup"><span data-stu-id="1c441-163">This is particularly helpful when you localize the display names for international versions of the webpages.</span></span>

<span data-ttu-id="1c441-164">Enfin, le fichier Certrqtp. Inc contient une variable qui représente le nombre de modèles ou de types de certificats dans le tableau rgAvailReqTypes.</span><span class="sxs-lookup"><span data-stu-id="1c441-164">Finally, the Certrqtp.inc file contains a variable that represents the number of certificate templates or types in the rgAvailReqTypes array.</span></span> <span data-ttu-id="1c441-165">Contrairement à la dimension *m* du tableau, définissez la valeur de la variable nAvailReqTypes sur le nombre réel de modèles de certificats ou de types que votre installation utilisera ; Cette valeur ne doit pas être supérieure à *m*+ 1.</span><span class="sxs-lookup"><span data-stu-id="1c441-165">In contrast to the *m* dimension of the array, set the value of the nAvailReqTypes variable to the actual number of certificate templates or types that your installation will use; this value must be no larger than *m*+1.</span></span> <span data-ttu-id="1c441-166">Bien qu’elle soit déclarée en haut du fichier Certrqtp. Inc, une valeur est assignée à nAvailReqTypes après le remplissage du tableau rgAvailReqTypes, ce qui permet de voir plus facilement le nombre d’éléments réellement utilisés par le tableau.</span><span class="sxs-lookup"><span data-stu-id="1c441-166">Although declared near the top of the Certrqtp.inc file, nAvailReqTypes is assigned a value after the rgAvailReqTypes array is populated, making it easier to see how many elements are actually used by the array.</span></span> <span data-ttu-id="1c441-167">La valeur nAvailReqTypes est utilisée dans une itération ailleurs dans les pages d’inscription par le Web. il est donc important que cette variable reflète précisément le nombre de modèles de certificat ou de types que vous souhaitez afficher pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1c441-167">The nAvailReqTypes value is used in an iteration elsewhere in the web enrollment pages, so it is important that this variable accurately reflect the number of certificate templates or types that you want to be viewable to the user.</span></span>

<span data-ttu-id="1c441-168">Notez que l’ajout simple de [*modèles de certificat*](../secgloss/c-gly.md) et de types au fichier Certrqtp. Inc ne garantit pas que l’utilisateur sera en mesure d’obtenir un certificat avec ces traits ; l’autorité de certification doit être autorisée à émettre un certificat pour le type ou le modèle de certificat spécifié.</span><span class="sxs-lookup"><span data-stu-id="1c441-168">Note that merely adding [*certificate templates*](../secgloss/c-gly.md) and types to the Certrqtp.inc file does not guarantee that the user will be able to get a certificate with those traits; the CA must be authorized to issue a certificate for the specified certificate template or type.</span></span>

<span data-ttu-id="1c441-169">Les installations peuvent créer leurs propres applications ou pages Web pour demander et recevoir un certificat.</span><span class="sxs-lookup"><span data-stu-id="1c441-169">Installations can create their own applications or webpages to request and receive a certificate.</span></span> <span data-ttu-id="1c441-170">Les objets [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) et [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) autorisent les programmeurs ou les scripteurs à créer des applications de [*demande de certificat*](../secgloss/c-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="1c441-170">The [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) and [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) objects allow programmers or scripters to build [*certificate request*](../secgloss/c-gly.md) applications.</span></span>

<span data-ttu-id="1c441-171">Pour demander l’émission d’un certificat sur une [*carte à puce*](../secgloss/s-gly.md), vous pouvez utiliser le contrôle d’inscription de carte à puce.</span><span class="sxs-lookup"><span data-stu-id="1c441-171">To request a certificate to be issued on a [*smart card*](../secgloss/s-gly.md), you can use the Smart Card Enrollment Control.</span></span> <span data-ttu-id="1c441-172">Pour plus d’informations et pour obtenir un exemple de code, consultez [**ISCrdEnr**](iscrdenr.md).</span><span class="sxs-lookup"><span data-stu-id="1c441-172">For details and example code, see [**ISCrdEnr**](iscrdenr.md).</span></span>

 

 
