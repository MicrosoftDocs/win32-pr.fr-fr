---
description: L’horodatage Authenticode est basé sur les contre- \# signatures PKCS 9 standard. Les outils de signature de Microsoft permettent aux développeurs d’apposer des horodatages en même temps qu’ils apposeront des signatures Authenticode.
ms.assetid: d0bd3e2f-1eee-4f71-9467-974994f720d5
title: Horodatage des signatures Authenticode
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3631d402da56d4078cecce65075c92dff0ec7e1c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104203036"
---
# <a name="time-stamping-authenticode-signatures"></a><span data-ttu-id="3ede2-104">Horodatage des signatures Authenticode</span><span class="sxs-lookup"><span data-stu-id="3ede2-104">Time Stamping Authenticode Signatures</span></span>

<span data-ttu-id="3ede2-105">Les signatures Microsoft Authenticode fournissent des garanties en matière d’autorisation et d’intégrité pour les données binaires.</span><span class="sxs-lookup"><span data-stu-id="3ede2-105">Microsoft Authenticode signatures provide authorship and integrity guarantees for binary data.</span></span> <span data-ttu-id="3ede2-106">L’horodatage Authenticode est basé sur les contre- \# signatures PKCS 9 standard.</span><span class="sxs-lookup"><span data-stu-id="3ede2-106">Authenticode time stamping is based on standard PKCS \#9 countersignatures.</span></span> <span data-ttu-id="3ede2-107">Les outils de signature de Microsoft permettent aux développeurs d’apposer des horodatages en même temps qu’ils apposeront des signatures Authenticode.</span><span class="sxs-lookup"><span data-stu-id="3ede2-107">Signing tools from Microsoft allow developers to affix time stamps at the same time as they affix Authenticode signatures.</span></span> <span data-ttu-id="3ede2-108">L’horodatage permet de vérifier la validité des signatures Authenticode même après l’expiration des certificats utilisés pour la signature.</span><span class="sxs-lookup"><span data-stu-id="3ede2-108">Time stamping allows Authenticode signatures to be verifiable even after the certificates used for signature have expired.</span></span>

## <a name="a-brief-introduction-to-authenticode"></a><span data-ttu-id="3ede2-109">Brève présentation d’Authenticode</span><span class="sxs-lookup"><span data-stu-id="3ede2-109">A Brief Introduction to Authenticode</span></span>

<span data-ttu-id="3ede2-110">[*Authenticode*](../secgloss/a-gly.md) applique la technologie de signature numérique pour garantir la création et l’intégrité des données binaires telles que les logiciels installables.</span><span class="sxs-lookup"><span data-stu-id="3ede2-110">[*Authenticode*](../secgloss/a-gly.md) applies digital signature technology to guarantee the authorship and integrity of binary data such as installable software.</span></span> <span data-ttu-id="3ede2-111">Un navigateur Web client ou d’autres composants système peuvent utiliser les signatures Authenticode pour vérifier l’intégrité des données lors du téléchargement ou de l’installation du logiciel.</span><span class="sxs-lookup"><span data-stu-id="3ede2-111">A client web browser, or other system components, can use the Authenticode signatures to verify the integrity of the data when the software is downloaded or installed.</span></span> <span data-ttu-id="3ede2-112">Les signatures Authenticode peuvent être utilisées avec de nombreux formats de logiciel, notamment. cab,. exe,. ocx et. dll.</span><span class="sxs-lookup"><span data-stu-id="3ede2-112">Authenticode signatures can be used with many software formats, including .cab, .exe, .ocx, and .dll.</span></span>

<span data-ttu-id="3ede2-113">Microsoft gère une liste d' [*autorités de certification*](/security/trusted-root/participants-list) publiques (ca).</span><span class="sxs-lookup"><span data-stu-id="3ede2-113">Microsoft maintains a list of public [*certification authorities*](/security/trusted-root/participants-list) (CAs).</span></span> <span data-ttu-id="3ede2-114">Les émetteurs de certificats Authenticode incluent actuellement [SSL.com](https://www.ssl.com/), [DigiCert](https://www.digicert.com/), [Sectigo (Comodo)](https://www.sectigo.com/)et [GlobalSign](https://www.globalsign.com/).</span><span class="sxs-lookup"><span data-stu-id="3ede2-114">Issuers of Authenticode certificates currently include [SSL.com](https://www.ssl.com/), [Digicert](https://www.digicert.com/), [Sectigo(Comodo)](https://www.sectigo.com/), and [GlobalSign](https://www.globalsign.com/).</span></span>

## <a name="about-cryptographic-time-stamping"></a><span data-ttu-id="3ede2-115">À propos de l’horodatage de chiffrement</span><span class="sxs-lookup"><span data-stu-id="3ede2-115">About Cryptographic Time Stamping</span></span>

<span data-ttu-id="3ede2-116">Par le passé, une variété de méthodes d’horodatage de chiffrement ont été proposées.</span><span class="sxs-lookup"><span data-stu-id="3ede2-116">In the past, a variety of cryptographic time stamping methods have been proposed.</span></span> <span data-ttu-id="3ede2-117">Consultez, par exemple, Haber et Stornetta « Guide pratique pour Time-Stamp un document numérique » dans le *Journal de Cryptology* (1991) et Benaloh et de la prémare « cumuls à sens unique : une alternative décentralisée aux signatures numériques » dans *Springer Link-Verlag des notes de cours en informatique* vol. 765 (EUROCRYPT» 93).</span><span class="sxs-lookup"><span data-stu-id="3ede2-117">See, for example, Haber and Stornetta "How to Time-Stamp a Digital Document" in the *Journal of Cryptology* (1991) and Benaloh and de Mare "One-Way Accumulators: A Decentralized Alternative to Digital Signatures" in *Springer-Verlag Lecture Notes in Computer Science* vol. 765 (EUROCRYPT '93).</span></span> <span data-ttu-id="3ede2-118">Un résumé étendu de cet article est disponible auprès de [Microsoft Research](https://research.microsoft.com/research/pubs/view.aspx?id=233&type=Publication&0sr=a).</span><span class="sxs-lookup"><span data-stu-id="3ede2-118">An extended abstract of this article is available from [Microsoft Research](https://research.microsoft.com/research/pubs/view.aspx?id=233&type=Publication&0sr=a).</span></span> <span data-ttu-id="3ede2-119">(Ces ressources peuvent ne pas être disponibles dans certaines langues et pays ou régions.) Étant donné que le temps est un physique, plutôt qu’une quantité mathématique, ces méthodes concernent généralement la façon de lier des objets afin que leur ordre de création puisse être déterminé ou comment regrouper efficacement des objets qui peuvent tous être décrits comme ayant été créés simultanément.</span><span class="sxs-lookup"><span data-stu-id="3ede2-119">(These resources may not be available in some languages and countries or regions.) Because time is a physical, rather than a mathematical, quantity, these methods generally concern how to link objects so that their order of creation can be determined or how to efficiently group objects that can all be described as having been created concurrently.</span></span>

<span data-ttu-id="3ede2-120">Les systèmes qui prétendent le temps d’authentification en tant que quantité nécessitent toujours une certaine forme de confiance.</span><span class="sxs-lookup"><span data-stu-id="3ede2-120">Systems that purport to authenticate time as a quantity always require some form of trust.</span></span> <span data-ttu-id="3ede2-121">Dans un paramètre fortement conflictuelle, les protocoles complexes peuvent être utilisés pour garantir un certain degré de synchronisés.</span><span class="sxs-lookup"><span data-stu-id="3ede2-121">In a strongly adversarial setting, complex protocols can be used to ensure some degree of synchrony.</span></span> <span data-ttu-id="3ede2-122">Toutefois, ces protocoles nécessitent une interaction complète entre les parties concernées.</span><span class="sxs-lookup"><span data-stu-id="3ede2-122">However, these protocols require extensive interaction between affected parties.</span></span> <span data-ttu-id="3ede2-123">Dans la pratique, si vous avez uniquement besoin de la certification du temps d’une source approuvée, la source peut tout simplement agir comme un notaire en fournissant une instruction signée (certification) à laquelle l’objet a été présenté pour la signature à l’heure indiquée.</span><span class="sxs-lookup"><span data-stu-id="3ede2-123">In practice, if one only needs certification of time from a trusted source, the source can simply act as a notary by providing a signed statement (certification) that the object was presented for signature at the indicated time.</span></span>

<span data-ttu-id="3ede2-124">La méthode contre-signature d’horodatage implémentée ci-dessous permet de vérifier les signatures même après l’expiration ou la révocation du certificat de signature.</span><span class="sxs-lookup"><span data-stu-id="3ede2-124">The countersignature method of time stamping implemented below allows for signatures to be verified even after the signing certificate has expired or been revoked.</span></span> <span data-ttu-id="3ede2-125">L’horodatage permet au vérificateur de connaître de manière fiable l’heure à laquelle la signature a été apposée et de faire confiance à la signature si elle était valide à ce moment-là.</span><span class="sxs-lookup"><span data-stu-id="3ede2-125">The time stamp allows the verifier to reliably know the time that the signature was affixed and thereby trust the signature if it was valid at that time.</span></span> <span data-ttu-id="3ede2-126">La matrice temporelle doit avoir une source de temps fiable et protégée.</span><span class="sxs-lookup"><span data-stu-id="3ede2-126">The time stamper should have a reliable and protected time source.</span></span>

## <a name="pkcs-7-signed-documents-and-countersignatures"></a><span data-ttu-id="3ede2-127">\#Documents et contre-signatures PKCS 7 signés</span><span class="sxs-lookup"><span data-stu-id="3ede2-127">PKCS \#7 Signed Documents and Countersignatures</span></span>

<span data-ttu-id="3ede2-128">PKCS \# 7 est un format standard pour les données de chiffrement, y compris les données signées, les certificats et les [*listes de révocation de certificats*](../secgloss/c-gly.md) (CRL).</span><span class="sxs-lookup"><span data-stu-id="3ede2-128">PKCS \#7 is a standard format for cryptographic data, including signed data, certificates, and [*certificate revocation lists*](../secgloss/c-gly.md) (CRLs).</span></span> <span data-ttu-id="3ede2-129">Le \# type d’intérêt PKCS 7 particulier dans le contexte de l’horodatage est les données signées, correspondant au \# type de contenu [**SIGNEDDATA**](signeddata.md) défini par PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="3ede2-129">The particular PKCS \#7 type of interest in the context of time stamping is signed data, corresponding to the PKCS \#7 defined [**SignedData**](signeddata.md) content type.</span></span>

<span data-ttu-id="3ede2-130">Le \# package PKCS 7 comprend des [**SignedData**](signeddata.md) qui identifient le contenu réel et certaines informations à son sujet, ainsi que des blocs de signature signataires.</span><span class="sxs-lookup"><span data-stu-id="3ede2-130">The PKCS \#7 package consists of [**SignedData**](signeddata.md) that identifies the actual content and certain information about it and SignerInfo signature blocks.</span></span> <span data-ttu-id="3ede2-131">Un signataires peut lui-même contenir une contre-signature, qui est, de manière récursive, un autre signataires.</span><span class="sxs-lookup"><span data-stu-id="3ede2-131">A SignerInfo may itself contain a countersignature, which recursively is another SignerInfo.</span></span> <span data-ttu-id="3ede2-132">En principe, une séquence de ces contre-signatures peut être présente.</span><span class="sxs-lookup"><span data-stu-id="3ede2-132">In principle, a sequence of such countersignatures may be present.</span></span> <span data-ttu-id="3ede2-133">La contre-signature est un attribut non authentifié par rapport à la signature dans le signataires ; autrement dit, il peut être apposé après la signature d’origine.</span><span class="sxs-lookup"><span data-stu-id="3ede2-133">The countersignature is an unauthenticated attribute with respect to the signature in the SignerInfo; that is, it may be affixed subsequent to the original signature.</span></span> <span data-ttu-id="3ede2-134">Sous forme de plan :</span><span class="sxs-lookup"><span data-stu-id="3ede2-134">In outline form:</span></span>

<span data-ttu-id="3ede2-135">[**SignedData**](signeddata.md) (PKCS \# 7)</span><span class="sxs-lookup"><span data-stu-id="3ede2-135">[**SignedData**](signeddata.md) (PKCS \#7)</span></span>

-   <span data-ttu-id="3ede2-136">Version (de PKCS \# 7, en général version 1)</span><span class="sxs-lookup"><span data-stu-id="3ede2-136">Version (of PKCS \#7, generally version 1)</span></span>
-   <span data-ttu-id="3ede2-137">DigestAlgorithms (collection de tous les algorithmes utilisés par les blocs de signature signataires, pour un traitement optimisé)</span><span class="sxs-lookup"><span data-stu-id="3ede2-137">DigestAlgorithms (collection of all algorithms used by SignerInfo signature blocks, for optimized processing)</span></span>
-   <span data-ttu-id="3ede2-138">ContentInfo (contentType est égal à [**SignedData**](signeddata.md), plus contenu ou référence au contenu)</span><span class="sxs-lookup"><span data-stu-id="3ede2-138">ContentInfo (contentType equals [**SignedData**](signeddata.md), plus content or reference to content)</span></span>
-   <span data-ttu-id="3ede2-139">Certificats FACULTATIFs (collection de tous les certificats utilisés)</span><span class="sxs-lookup"><span data-stu-id="3ede2-139">OPTIONAL Certificates (collection of all certificates used)</span></span>
-   <span data-ttu-id="3ede2-140">Listes CRL FACULTATIVEs (regroupement de toutes les listes de révocation de certificats)</span><span class="sxs-lookup"><span data-stu-id="3ede2-140">OPTIONAL CRLs (collection of all CRLs)</span></span>
-   <span data-ttu-id="3ede2-141">Signataires des blocs de signature (la signature réelle, composée d’un ou de plusieurs blocs de signature signataires)</span><span class="sxs-lookup"><span data-stu-id="3ede2-141">SignerInfo signature blocks (the actual signature, composed of one or more SignerInfo signature blocks)</span></span>

<span data-ttu-id="3ede2-142">Signataires (le bloc de signature)</span><span class="sxs-lookup"><span data-stu-id="3ede2-142">SignerInfo (the signature block)</span></span>

-   <span data-ttu-id="3ede2-143">Version (de PKCS \# 7, en général version 1)</span><span class="sxs-lookup"><span data-stu-id="3ede2-143">Version (of PKCS \#7, generally version 1)</span></span>
-   <span data-ttu-id="3ede2-144">Certificat (émetteur et numéro de série pour identifier de manière unique le certificat du signataire dans [**SignedData**](signeddata.md))</span><span class="sxs-lookup"><span data-stu-id="3ede2-144">Certificate (issuer and serial number to uniquely identify of signer's certificate in [**SignedData**](signeddata.md))</span></span>
-   <span data-ttu-id="3ede2-145">DigestAlgorithm plus le DigestEncryptionAlgorithm plus le Digest (hachage), plus le EncryptedDigest (signature réelle)</span><span class="sxs-lookup"><span data-stu-id="3ede2-145">DigestAlgorithm plus the DigestEncryptionAlgorithm plus the Digest (hash), plus the EncryptedDigest (actual signature)</span></span>
-   <span data-ttu-id="3ede2-146">AuthenticatedAttributes facultatif (par exemple, signé par ce signataire)</span><span class="sxs-lookup"><span data-stu-id="3ede2-146">OPTIONAL AuthenticatedAttributes (for example, signed by this signer)</span></span>
-   <span data-ttu-id="3ede2-147">UnauthenticatedAttributes facultatif (par exemple, non signé par ce signataire)</span><span class="sxs-lookup"><span data-stu-id="3ede2-147">OPTIONAL UnauthenticatedAttributes (for example, not signed by this signer)</span></span>

<span data-ttu-id="3ede2-148">Un exemple d’attribut authentifié est le temps de signature (OID 1.2.840.113549.1.9.5), car il fait partie de ce que le service d’horodatage signe.</span><span class="sxs-lookup"><span data-stu-id="3ede2-148">An example of an authenticated attribute is the signing time (OID 1.2.840.113549.1.9.5) because it is part of what the time stamp service signs.</span></span> <span data-ttu-id="3ede2-149">La contre-signature (OID 1.2.840.113549.1.9.6) est un exemple d’attribut non authentifié, car elle peut être apposée après la signature.</span><span class="sxs-lookup"><span data-stu-id="3ede2-149">An example of an unauthenticated attribute is the countersignature (OID 1.2.840.113549.1.9.6) because it can be affixed after signing.</span></span> <span data-ttu-id="3ede2-150">Dans ce cas, le signataires lui-même contient un signataires (la contre-signature).</span><span class="sxs-lookup"><span data-stu-id="3ede2-150">In this case, the SignerInfo itself contains a SignerInfo (the Countersignature).</span></span>

> [!Note]  
> <span data-ttu-id="3ede2-151">L’objet qui est signé dans la contre-signature est la signature d’origine (autrement dit, le EncryptedDigest du signataires d’origine).</span><span class="sxs-lookup"><span data-stu-id="3ede2-151">The object that is signed in the countersignature is the original signature (that is, the EncryptedDigest of the original SignerInfo).</span></span>

 

## <a name="signtool-and-the-authenticode-process"></a><span data-ttu-id="3ede2-152">SignTool et le processus Authenticode</span><span class="sxs-lookup"><span data-stu-id="3ede2-152">SignTool and the Authenticode Process</span></span>

<span data-ttu-id="3ede2-153">[SignTool](signtool.md) est disponible pour la signature Authenticode et l’horodatage des données binaires.</span><span class="sxs-lookup"><span data-stu-id="3ede2-153">[SignTool](signtool.md) is available for Authenticode signing and time stamping binary data.</span></span> <span data-ttu-id="3ede2-154">L’outil est installé dans le \\ dossier bin du chemin d’installation du kit de développement logiciel (SDK) Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="3ede2-154">The tool is installed in the \\Bin folder of the Microsoft Windows Software Development Kit (SDK) installation path.</span></span>

<span data-ttu-id="3ede2-155">La signature et l’horodatage des données binaires sont relativement simples à l’aide de [SignTool](signtool.md).</span><span class="sxs-lookup"><span data-stu-id="3ede2-155">Signing and time stamping binary data is relatively straightforward using [SignTool](signtool.md).</span></span> <span data-ttu-id="3ede2-156">Le serveur de publication doit obtenir un certificat de signature de code d’une autorité de certification de signature de code commercial.</span><span class="sxs-lookup"><span data-stu-id="3ede2-156">The publisher must get a code signing certificate from a commercial code signing CA.</span></span> <span data-ttu-id="3ede2-157">Pour plus de commodité, Microsoft publie et met à jour une liste des autorités de certification publiques, y compris celles qui émettent des certificats Authenticode.</span><span class="sxs-lookup"><span data-stu-id="3ede2-157">For convenience, Microsoft publishes and updates a list of public CAs, including those that issue Authenticode certificates.</span></span> <span data-ttu-id="3ede2-158">Lorsqu’ils sont prêts à être publiés, les fichiers objets sont signés et l’horodatage est indiqué à l’aide des paramètres de ligne de commande appropriés avec l’outil SignTool.</span><span class="sxs-lookup"><span data-stu-id="3ede2-158">When ready to publish, the object files are signed and time stamped using appropriate command line parameters with the SignTool tool.</span></span> <span data-ttu-id="3ede2-159">Le résultat d’une opération SignTool est toujours \# au format PKCS 7 [**SignedData**](signeddata.md).</span><span class="sxs-lookup"><span data-stu-id="3ede2-159">The result of any SignTool operation is always a PKCS \#7 format [**SignedData**](signeddata.md).</span></span>

<span data-ttu-id="3ede2-160">SignTool accepte comme entrée les données binaires brutes à signer et les informations d’horodatage, ou les données binaires précédemment signées pour l’horodatage.</span><span class="sxs-lookup"><span data-stu-id="3ede2-160">SignTool accepts as input either raw binary data to be signed and time stamped, or previously signed binary data to be time stamped.</span></span> <span data-ttu-id="3ede2-161">Les données qui ont été signées précédemment peuvent être horodatées à l’aide de la commande d' **horodatage SignTool** .</span><span class="sxs-lookup"><span data-stu-id="3ede2-161">Data that has previously been signed can be time stamped by using the **signtool timestamp** command.</span></span>



| <span data-ttu-id="3ede2-162">Argument</span><span class="sxs-lookup"><span data-stu-id="3ede2-162">Argument</span></span>             | <span data-ttu-id="3ede2-163">Description</span><span class="sxs-lookup"><span data-stu-id="3ede2-163">Description</span></span>                                                                                                                                                                                                    |
|----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="3ede2-164">**/T** *HTTPAddress*</span><span class="sxs-lookup"><span data-stu-id="3ede2-164">**/t** *HTTPAddress*</span></span> | <span data-ttu-id="3ede2-165">Indique que le fichier doit être horodaté.</span><span class="sxs-lookup"><span data-stu-id="3ede2-165">Indicates that the file is to be time stamped.</span></span> <span data-ttu-id="3ede2-166">Une URL qui spécifie une adresse d’un serveur d’horodatage doit être fournie.</span><span class="sxs-lookup"><span data-stu-id="3ede2-166">A URL that specifies an address of a time stamping server must be provided.</span></span> <span data-ttu-id="3ede2-167">**/t** peut être utilisé avec les commandes de **signature SignTool** et d' **horodatage SignTool** .</span><span class="sxs-lookup"><span data-stu-id="3ede2-167">**/t** can be used with both **signtool sign** and **signtool timestamp** commands.</span></span> |



 

<span data-ttu-id="3ede2-168">Pour plus d’informations sur les outils qui peuvent être utiles dans ce contexte, consultez [outils de chiffrement](cryptography-tools.md) et [SignTool](signtool.md).</span><span class="sxs-lookup"><span data-stu-id="3ede2-168">For more information about tools that may be useful in this context, see [Cryptography Tools](cryptography-tools.md) and [SignTool](signtool.md).</span></span>

## <a name="implementation-details-and-wire-format"></a><span data-ttu-id="3ede2-169">Détails de l’implémentation et format de câble</span><span class="sxs-lookup"><span data-stu-id="3ede2-169">Implementation Details and Wire Format</span></span>

<span data-ttu-id="3ede2-170">[SignTool](signtool.md) s’appuie sur l’implémentation de Windows Authenticode pour créer des signatures d’horodatage.</span><span class="sxs-lookup"><span data-stu-id="3ede2-170">[SignTool](signtool.md) relies on the Windows Authenticode implementation to create and time stamp signatures.</span></span> <span data-ttu-id="3ede2-171">[*Authenticode*](../secgloss/a-gly.md) fonctionne sur les fichiers binaires, par exemple. cab,. exe,. dll ou. ocx.</span><span class="sxs-lookup"><span data-stu-id="3ede2-171">[*Authenticode*](../secgloss/a-gly.md) operates on binary files, for example .cab, .exe, .dll, or .ocx.</span></span> <span data-ttu-id="3ede2-172">Authenticode crée d’abord la signature, en produisant \# un [**SignedData**](signeddata.md)PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="3ede2-172">Authenticode first creates the signature, producing a PKCS \#7 [**SignedData**](signeddata.md).</span></span> <span data-ttu-id="3ede2-173">C’est ce **SignedData** qui doit être contresigné, comme décrit dans PKCS \# 9.</span><span class="sxs-lookup"><span data-stu-id="3ede2-173">It is this **SignedData** that must be countersigned, as described in PKCS \#9.</span></span>

<span data-ttu-id="3ede2-174">Le processus de contre-signature a lieu en quatre étapes :</span><span class="sxs-lookup"><span data-stu-id="3ede2-174">The countersignature process takes place in four steps:</span></span>

1.  <span data-ttu-id="3ede2-175">Copiez la signature (autrement dit, encryptedDigest) à partir du signataires du \# [**SignedData**](signeddata.md)PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="3ede2-175">Copy the signature (that is, the encryptedDigest) from the SignerInfo of the PKCS \#7 [**SignedData**](signeddata.md).</span></span>
2.  <span data-ttu-id="3ede2-176">Construisez une demande d’horodatage dont le contenu est la signature d’origine.</span><span class="sxs-lookup"><span data-stu-id="3ede2-176">Construct a time stamp request whose content is the original signature.</span></span> <span data-ttu-id="3ede2-177">Envoyez ce code au serveur d’horodatage [*notation de syntaxe abstract One*](../secgloss/a-gly.md) (ASN. 1) encodé en tant que TimeStampRequest.</span><span class="sxs-lookup"><span data-stu-id="3ede2-177">Send this to the time stamp server [*Abstract Syntax Notation One*](../secgloss/a-gly.md) (ASN.1) encoded as a TimeStampRequest.</span></span>
3.  <span data-ttu-id="3ede2-178">Recevoir un horodatage, mis en forme en tant que \# deuxième [**SignedData**](signeddata.md)PKCS 7, retourné à partir du serveur d’horodatage.</span><span class="sxs-lookup"><span data-stu-id="3ede2-178">Receive a time stamp, formatted as a second PKCS \#7 [**SignedData**](signeddata.md), returned from the time stamp server.</span></span>
4.  <span data-ttu-id="3ede2-179">Copiez le signataires à partir de l’horodatage directement dans le \# [**SignedData**](signeddata.md)PKCS 7 d’origine, sous la forme d’une contre- \# signature PKCS 9 (autrement dit, un attribut non authentifié dans le signataires d’origine).</span><span class="sxs-lookup"><span data-stu-id="3ede2-179">Copy the SignerInfo from the time stamp directly into the original PKCS \#7 [**SignedData**](signeddata.md), as a PKCS \#9 countersignature (that is, an unauthenticated attribute in the SignerInfo of the original).</span></span>

## <a name="time-stamp-request"></a><span data-ttu-id="3ede2-180">Demande d’horodatage</span><span class="sxs-lookup"><span data-stu-id="3ede2-180">Time Stamp Request</span></span>

<span data-ttu-id="3ede2-181">La demande d’horodatage est envoyée dans un message HTTP 1,1 postal.</span><span class="sxs-lookup"><span data-stu-id="3ede2-181">The time stamp request is sent within an HTTP 1.1 POST message.</span></span> <span data-ttu-id="3ede2-182">Dans l’en-tête HTTP, la directive CacheControl est définie sur no-cache, et la directive Content-type est définie sur application/octet-stream.</span><span class="sxs-lookup"><span data-stu-id="3ede2-182">In the HTTP header, the CacheControl directive is set to no-cache, and the Content-Type directive is set to application/octet-stream.</span></span> <span data-ttu-id="3ede2-183">Le corps du message HTTP est un encodage Base64 de [*Distinguished Encoding Rules*](../secgloss/d-gly.md) (der) de la demande d’horodatage.</span><span class="sxs-lookup"><span data-stu-id="3ede2-183">The body of the HTTP message is a base64 encoding of [*Distinguished Encoding Rules*](../secgloss/d-gly.md) (DER) encoding of the time stamp request.</span></span>

<span data-ttu-id="3ede2-184">Bien qu’il ne soit pas actuellement utilisé, la directive Content-Length doit également être utilisée lors de la construction du message HTTP, car elle permet au serveur d’horodatage de localiser l’emplacement où la requête se trouve dans le HTTP.</span><span class="sxs-lookup"><span data-stu-id="3ede2-184">Although not currently used, the Content-Length directive should also be used in constructing the HTTP message because it helps the time stamp server locate where the request is within the HTTP POST.</span></span>

<span data-ttu-id="3ede2-185">D’autres en-têtes HTTP peuvent également être présents et doivent être ignorés s’ils ne sont pas compris par le demandeur ou le serveur d’horodatage.</span><span class="sxs-lookup"><span data-stu-id="3ede2-185">Other HTTP headers may also be present and should be ignored if they are not understood by the requestor or time stamp server.</span></span>

<span data-ttu-id="3ede2-186">La demande d’horodatage est un message encodé ASN. 1.</span><span class="sxs-lookup"><span data-stu-id="3ede2-186">The time stamp request is an ASN.1 encoded message.</span></span> <span data-ttu-id="3ede2-187">Le format de la demande est le suivant.</span><span class="sxs-lookup"><span data-stu-id="3ede2-187">The format of the request is as follows.</span></span>

``` syntax
TimeStampRequest ::= SEQUENCE {
   countersignatureType OBJECT IDENTIFIER,
   attributes Attributes OPTIONAL, 
   content  ContentInfo
}
```

<span data-ttu-id="3ede2-188">Le countersignatureType est l' [*identificateur d’objet*](../secgloss/o-gly.md) (OID) qui identifie cela comme une contre-signature d’horodatage et doit être le 1.3.6.1.4.1.311.3.2.1 d’OID exact.</span><span class="sxs-lookup"><span data-stu-id="3ede2-188">The countersignatureType is the [*object identifier*](../secgloss/o-gly.md) (OID) that identifies this as a time stamp countersignature and should be the exact OID 1.3.6.1.4.1.311.3.2.1.</span></span>

<span data-ttu-id="3ede2-189">Aucun attribut n’est actuellement inclus dans la demande d’horodatage.</span><span class="sxs-lookup"><span data-stu-id="3ede2-189">No attributes are currently included in the time stamp request.</span></span>

<span data-ttu-id="3ede2-190">Le contenu est un ContentInfo tel que défini par PKCS \# 7.</span><span class="sxs-lookup"><span data-stu-id="3ede2-190">The content is a ContentInfo as defined by PKCS \#7.</span></span> <span data-ttu-id="3ede2-191">Le contenu correspond aux données à signer.</span><span class="sxs-lookup"><span data-stu-id="3ede2-191">The content is the data to be signed.</span></span> <span data-ttu-id="3ede2-192">Pour l’horodatage de la signature, le ContentType doit être Data, et le contenu doit être le encryptedDigest (signature) à partir du signataires du \# contenu PKCS 7 pour qu’il soit horodaté.</span><span class="sxs-lookup"><span data-stu-id="3ede2-192">For signature time stamping, the ContentType should be Data, and the content should be the encryptedDigest (signature) from the SignerInfo of the PKCS \#7 content to be time stamped.</span></span>

## <a name="time-stamp-response"></a><span data-ttu-id="3ede2-193">Réponse d’horodatage</span><span class="sxs-lookup"><span data-stu-id="3ede2-193">Time Stamp Response</span></span>

<span data-ttu-id="3ede2-194">La réponse d’horodatage est également envoyée dans un message HTTP 1,1.</span><span class="sxs-lookup"><span data-stu-id="3ede2-194">The time stamp response is also sent within an HTTP 1.1 message.</span></span> <span data-ttu-id="3ede2-195">Dans l’en-tête HTTP, la directive Content-type est également définie sur application/octet-stream.</span><span class="sxs-lookup"><span data-stu-id="3ede2-195">In the HTTP header, the Content-Type directive is also set to application/octet-stream.</span></span> <span data-ttu-id="3ede2-196">Le corps du message HTTP est un encodage Base64 de l’encodage DER de la réponse d’horodatage.</span><span class="sxs-lookup"><span data-stu-id="3ede2-196">The body of the HTTP message is a base64 encoding of DER encoding of the time stamp response.</span></span>

<span data-ttu-id="3ede2-197">La réponse d’horodatage est un \# message signé PKCS 7 signé par l’horodateur horaire.</span><span class="sxs-lookup"><span data-stu-id="3ede2-197">The time stamp response is a PKCS \#7 signed message signed by the time stamper.</span></span> <span data-ttu-id="3ede2-198">Le fichier ContentInfo du \# message PKCS 7 est identique à la valeur ContentInfo reçue dans l’horodatage.</span><span class="sxs-lookup"><span data-stu-id="3ede2-198">The ContentInfo of the PKCS \#7 message is identical to the ContentInfo received in the time stamp.</span></span> <span data-ttu-id="3ede2-199">Le \# contenu PKCS 7 contient l’attribut authentifié de l’heure de signature (défini dans PKCS \# 99, OID 1.2.840.113549.9.5).</span><span class="sxs-lookup"><span data-stu-id="3ede2-199">The PKCS \#7 content contains the signing time authenticated attribute (defined in PKCS \#99, OID 1.2.840.113549.9.5).</span></span>

<span data-ttu-id="3ede2-200">Une fois que Authenticode a reçu l’horodatage du serveur, Authenticode incorpore l’horodatage dans le SignedData PKCS 7 d’origine comme contre- \# signature. [](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="3ede2-200">After Authenticode receives the time stamp from the server, Authenticode incorporates the time stamp into the original PKCS \#7 [**SignedData**](signeddata.md) as a countersignature.</span></span> <span data-ttu-id="3ede2-201">Pour ce faire, le ContentInfo du \# **SignedData** PKCS 7 renvoyé est ignoré, et le signataires de l’horodatage renvoyé est copié sous la forme d’une contre-signature dans le signataires du SignedData PKCS \# 7 d’origine.</span><span class="sxs-lookup"><span data-stu-id="3ede2-201">To accomplish this, the ContentInfo of the returned PKCS \#7 **SignedData** is discarded, and the SignerInfo of the returned time stamp is copied as a countersignature into the SignerInfo of the original PKCS \#7 **SignedData**.</span></span> <span data-ttu-id="3ede2-202">La chaîne de certificats de la matrice temporelle est également copiée dans les certificats de l’original PKCS \# 7 **SignedData** comme attribut non authentifié du signataire d’origine.</span><span class="sxs-lookup"><span data-stu-id="3ede2-202">The certificate chain of the time stamper is also copied into Certificates in the original PKCS \#7 **SignedData** as an unauthenticated attribute of the original signer.</span></span>

<span data-ttu-id="3ede2-203">Pour plus d’informations sur PKCS et d’autres sujets relatifs à la sécurité, consultez la [bibliothèque de contenu du site Web RSA](https://www.rsa.com/content_library.aspx).</span><span class="sxs-lookup"><span data-stu-id="3ede2-203">For more information about PKCS and other security subjects, see the [content library of the RSA website](https://www.rsa.com/content_library.aspx).</span></span>

 

 
