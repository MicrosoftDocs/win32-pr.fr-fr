---
description: L’interface ICertView est utilisée par les clients autorisés correctement pour afficher la base de données des services de certificats.
ms.assetid: c8f316dd-186b-4e4a-b0ce-561a23b266cb
title: Affichage de la base de données des services de certificats
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43c553cee2f64c3096e733d588c9e0ad3d08ceb4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104115607"
---
# <a name="viewing-the-certificate-services-database"></a><span data-ttu-id="a83eb-103">Affichage de la base de données des services de certificats</span><span class="sxs-lookup"><span data-stu-id="a83eb-103">Viewing the Certificate Services Database</span></span>

<span data-ttu-id="a83eb-104">L’interface [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) est utilisée par les clients autorisés correctement pour afficher la base de données des services de certificats.</span><span class="sxs-lookup"><span data-stu-id="a83eb-104">The [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) interface is used by properly authorized clients to view the Certificate Services database.</span></span> <span data-ttu-id="a83eb-105">Il convient de noter que, dans le cadre du produit expédié, le composant logiciel enfichable MMC de l’autorité de certification peut être utilisé pour afficher la base de données des services de certificats.</span><span class="sxs-lookup"><span data-stu-id="a83eb-105">It should be noted that, as part of the shipped product, the Certification Authority MMC snap-in can be used to view the Certificate Services database.</span></span> <span data-ttu-id="a83eb-106">[**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) est fourni pour l’affichage de la base de données par programmation.</span><span class="sxs-lookup"><span data-stu-id="a83eb-106">[**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) is provided for programmatically viewing the database.</span></span> <span data-ttu-id="a83eb-107">La prise en charge de l’interface **ICertView** commence par Windows XP.</span><span class="sxs-lookup"><span data-stu-id="a83eb-107">Support for the **ICertView** interface begins with Windows XP.</span></span>

<span data-ttu-id="a83eb-108">Un client correctement autorisé signifie un utilisateur qui a reçu l’autorisation d’afficher la base de données des services de certificats. le composant logiciel enfichable MMC de l’autorité de certification peut être utilisé pour accorder ou limiter l’accès à l’affichage de la base de données (sous **Propriétés** de l' [*autorité de certification*](../secgloss/c-gly.md), cliquez sur l’onglet **sécurité** ).</span><span class="sxs-lookup"><span data-stu-id="a83eb-108">A properly authorized client means a user who has been granted permission to view the Certificate Services database; the Certification Authority MMC snap-in can be used to grant or restrict access to view the database (under **Properties** for the [*certification authority*](../secgloss/c-gly.md), click the **Security** tab).</span></span> <span data-ttu-id="a83eb-109">En outre, pour utiliser l’objet [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) , la station de travail cliente doit avoir installé les composants du client des services de certificats.</span><span class="sxs-lookup"><span data-stu-id="a83eb-109">Additionally, to use the [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) object, the client workstation is required to have installed the Certificate Services client components.</span></span>

<span data-ttu-id="a83eb-110">Bien qu’il existe différents scénarios pour l’utilisation de [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) et de ses interfaces associées, l’exemple suivant illustre une séquence possible pour le développement d’une application cliente basée sur **ICertView**:</span><span class="sxs-lookup"><span data-stu-id="a83eb-110">Although there are various scenarios for using [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) and its related interfaces, the following depicts one possible sequence for developing a client application based on **ICertView**:</span></span>

<span data-ttu-id="a83eb-111">**Pour afficher la base de données des services de certificats**</span><span class="sxs-lookup"><span data-stu-id="a83eb-111">**To view the Certificate Services database**</span></span>

1.  <span data-ttu-id="a83eb-112">Après avoir obtenu une instance de l’objet [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) , appelez [**ICertView :: OpenConnection**](/windows/desktop/api/Certview/nf-certview-icertview-openconnection) pour communiquer avec une [*autorité de certification*](../secgloss/c-gly.md) sur un ordinateur spécifique.</span><span class="sxs-lookup"><span data-stu-id="a83eb-112">After obtaining an instance of the [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) object, call [**ICertView::OpenConnection**](/windows/desktop/api/Certview/nf-certview-icertview-openconnection) to communicate with a [*certification authority*](../secgloss/c-gly.md) on a specific computer.</span></span>
2.  <span data-ttu-id="a83eb-113">Appelez [**ICertView :: SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) pour spécifier le nombre de colonnes dans la vue ; Cet appel est également utilisé pour spécifier une vue par défaut.</span><span class="sxs-lookup"><span data-stu-id="a83eb-113">Call [**ICertView::SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) to specify the number of columns in the view; this call is also used to specify a default view.</span></span> <span data-ttu-id="a83eb-114">Si une vue par défaut n’est pas spécifiée dans l’appel, l’appelant doit appeler [**ICertView :: SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn) pour chacune des colonnes à contenu dans la vue.</span><span class="sxs-lookup"><span data-stu-id="a83eb-114">If a default view is not specified in the call, the caller must call [**ICertView::SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn) for each of the columns to be contained in the view.</span></span>
3.  <span data-ttu-id="a83eb-115">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="a83eb-115">Optional.</span></span> <span data-ttu-id="a83eb-116">Spécifiez des critères de tri et/ou des critères de qualification pour la requête de base de données en appelant la fonction [**ICertView :: SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) .</span><span class="sxs-lookup"><span data-stu-id="a83eb-116">Specify sorting criteria and/or qualifying criteria for the database query by calling the [**ICertView::SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) function.</span></span> <span data-ttu-id="a83eb-117">Les critères d’inclusion consistent à informer la vue de récupérer des données en fonction de qualificateurs tels que supérieur à, inférieur à, égal à, etc.</span><span class="sxs-lookup"><span data-stu-id="a83eb-117">Qualifying criteria consists of informing the view to retrieve data based on qualifiers such as Greater Than, Less Than, Equal To, and so on.</span></span>
4.  <span data-ttu-id="a83eb-118">Appelez [**ICertView :: OpenView**](/windows/desktop/api/Certview/nf-certview-icertview-openview) pour récupérer les données dans la vue ; les données de la vue se composent des colonnes demandées au moyen de [**ICertView :: SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) (et si aucune vue par défaut n’a été spécifiée, [**ICertView :: SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn)).</span><span class="sxs-lookup"><span data-stu-id="a83eb-118">Call [**ICertView::OpenView**](/windows/desktop/api/Certview/nf-certview-icertview-openview) to retrieve the data in the view; the view's data will consist of the columns requested by means of [**ICertView::SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) (and if a default view was not specified, [**ICertView::SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn)).</span></span> <span data-ttu-id="a83eb-119">Si [**ICertView :: SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) a été appelé, les données des colonnes sont triées et/ou qualifiées.</span><span class="sxs-lookup"><span data-stu-id="a83eb-119">If [**ICertView::SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) was called, data in the columns will be sorted and/or qualified.</span></span> <span data-ttu-id="a83eb-120">**ICertView :: OpenView** crée un objet [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) , qui peut être utilisé pour énumérer les lignes de la vue.</span><span class="sxs-lookup"><span data-stu-id="a83eb-120">**ICertView::OpenView** creates a [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) object, which can be used to enumerate the view's rows.</span></span>
5.  <span data-ttu-id="a83eb-121">Utilisez les [](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) méthodes IEnumCERTVIEWROW [**IEnumCERTVIEWROW :: EnumCertViewAttribute**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewattribute), [**IEnumCERTVIEWROW :: EnumCertViewColumn**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewcolumn)et [**IEnumCERTVIEWROW :: EnumCertViewExtension**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewextension) pour récupérer les données d’attribut, de colonne et d’extension comme vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="a83eb-121">Use the [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) methods [**IEnumCERTVIEWROW::EnumCertViewAttribute**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewattribute), [**IEnumCERTVIEWROW::EnumCertViewColumn**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewcolumn), and [**IEnumCERTVIEWROW::EnumCertViewExtension**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewextension) to retrieve attribute, column, and extension data as desired.</span></span>

 

 
