---
description: Comment générer, récupérer et exporter des clés RSA/Schannel.
ms.assetid: 3069232f-d016-4973-ae39-89b0e2a03cd7
title: Clés RSA/Schannel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93c9d23de40f32a499013928086ccb52fc1d1e67
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526326"
---
# <a name="rsaschannel-keys"></a><span data-ttu-id="63763-103">Clés RSA/Schannel</span><span class="sxs-lookup"><span data-stu-id="63763-103">RSA/Schannel Keys</span></span>

## <a name="generating-and-retrieving-rsaschannel-keys"></a><span data-ttu-id="63763-104">Génération et récupération des clés RSA/Schannel</span><span class="sxs-lookup"><span data-stu-id="63763-104">Generating and Retrieving RSA/Schannel Keys</span></span>

<span data-ttu-id="63763-105">[*RSA*](../secgloss/r-gly.md) / Les clés [*Schannel*](../secgloss/s-gly.md) peuvent être générées en appelant la fonction [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey) .</span><span class="sxs-lookup"><span data-stu-id="63763-105">[*RSA*](../secgloss/r-gly.md)/[*Schannel*](../secgloss/s-gly.md) keys can be generated by calling the [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey) function.</span></span> <span data-ttu-id="63763-106">L’appel à **CryptGenKey** nécessite un \_ identificateur d’algorithme at KeyExchange passé dans le paramètre *algid* .</span><span class="sxs-lookup"><span data-stu-id="63763-106">The call to **CryptGenKey** requires an AT\_KEYEXCHANGE algorithm identifier passed in the *Algid* parameter.</span></span>

<span data-ttu-id="63763-107">**Pour générer une paire de clés publique/privée RSA/Schannel**</span><span class="sxs-lookup"><span data-stu-id="63763-107">**To generate an RSA/Schannel public/private key pair**</span></span>

1.  <span data-ttu-id="63763-108">Appelez la fonction [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) pour obtenir un descripteur du [fournisseur de services de chiffrement Microsoft RSA/SChannel](microsoft-rsa-schannel-cryptographic-provider.md).</span><span class="sxs-lookup"><span data-stu-id="63763-108">Call the [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) function to get a handle to the [Microsoft RSA/Schannel Cryptographic Provider](microsoft-rsa-schannel-cryptographic-provider.md).</span></span>
2.  <span data-ttu-id="63763-109">Appelez la fonction [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey) pour générer les clés.</span><span class="sxs-lookup"><span data-stu-id="63763-109">Call the [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey) function to generate the keys.</span></span> <span data-ttu-id="63763-110">La \_ valeur de KeyExchange doit être transmise pour le paramètre *algid* , et les 16 bits supérieurs du paramètre *dwFlags* doivent avoir la taille de clé souhaitée (512 bits).</span><span class="sxs-lookup"><span data-stu-id="63763-110">AT\_KEYEXCHANGE must be passed in for the *Algid* parameter, and the upper 16 bits of the *dwFlags* parameter must be set to the desired key size (512 bits).</span></span> <span data-ttu-id="63763-111">Un handle de structure [**HCRYPTKEY**](hcryptkey.md) est retourné dans le paramètre *HKEY* .</span><span class="sxs-lookup"><span data-stu-id="63763-111">An [**HCRYPTKEY**](hcryptkey.md) structure handle is returned in the *hKey* parameter.</span></span>

<span data-ttu-id="63763-112">**Pour récupérer un pointeur vers des clés d’utilisateur RSA/SChannel générées précédemment**</span><span class="sxs-lookup"><span data-stu-id="63763-112">**To retrieve a pointer to previously generated RSA/Schannel user keys**</span></span>

1.  <span data-ttu-id="63763-113">Appelez la fonction [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) pour obtenir un descripteur du [fournisseur de services de chiffrement Microsoft RSA/SChannel](microsoft-rsa-schannel-cryptographic-provider.md).</span><span class="sxs-lookup"><span data-stu-id="63763-113">Call the [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) function to get a handle to the [Microsoft RSA/Schannel Cryptographic Provider](microsoft-rsa-schannel-cryptographic-provider.md).</span></span>
2.  <span data-ttu-id="63763-114">Appelez la fonction [**CryptGetUserKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetuserkey) , avec le paramètre *dwKeySpec* défini sur \_ KeyExchange.</span><span class="sxs-lookup"><span data-stu-id="63763-114">Call the [**CryptGetUserKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetuserkey) function, with the *dwKeySpec* parameter set to AT\_KEYEXCHANGE.</span></span>

## <a name="exporting-rsaschannel-keys"></a><span data-ttu-id="63763-115">Exportation des clés RSA/Schannel</span><span class="sxs-lookup"><span data-stu-id="63763-115">Exporting RSA/Schannel Keys</span></span>

<span data-ttu-id="63763-116">Les [*clés principales*](../secgloss/m-gly.md) peuvent être exportées dans des structures blob de clé simple.</span><span class="sxs-lookup"><span data-stu-id="63763-116">[*Master keys*](../secgloss/m-gly.md) can be exported into simple key BLOB structures.</span></span> <span data-ttu-id="63763-117">Cela doit être implémenté de la même façon que l’exportation de [*clés de chiffrement en bloc*](../secgloss/b-gly.md) [*RC4*](../secgloss/r-gly.md) ou [*Data Encryption Standard*](../secgloss/d-gly.md) (des) normales, comme décrit dans [simple blob de clé](https://www.bing.com/search?q=Simple+Key+BLOB).</span><span class="sxs-lookup"><span data-stu-id="63763-117">This should be implemented the same way as the export of normal [*RC4*](../secgloss/r-gly.md) or [*Data Encryption Standard*](../secgloss/d-gly.md) (DES) [*bulk encryption keys*](../secgloss/b-gly.md), as described in [Simple Key BLOB](https://www.bing.com/search?q=Simple+Key+BLOB).</span></span> <span data-ttu-id="63763-118">Le membre **aiKeyAlg** de la structure [**PUBLICKEYSTRUC**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) est défini sur l’identificateur d’algorithme de la clé principale (CALG \_ PCT1 \_ maître, CALG \_ SSL2 \_ Master, CALG \_ SSL3 \_ maître ou CALG \_ TLS1 \_ Master).</span><span class="sxs-lookup"><span data-stu-id="63763-118">The **aiKeyAlg** member of the [**PUBLICKEYSTRUC**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) structure is set to the algorithm identifier of the master key (CALG\_PCT1\_MASTER, CALG\_SSL2\_MASTER, CALG\_SSL3\_MASTER, or CALG\_TLS1\_MASTER).</span></span>

<span data-ttu-id="63763-119">Si la fonction [**CPExportKey**](https://www.bing.com/search?q=**CPExportKey**) exporte une clé principale SSL2 et que l' \_ indicateur de secours crypt SSL2 \_ est défini, afin d’éviter les attaques par restauration de version, définissez les huit premiers octets du [*remplissage*](../secgloss/p-gly.md) du bloc de chiffrement sur 0x03 et non sur les données aléatoires.</span><span class="sxs-lookup"><span data-stu-id="63763-119">If the [**CPExportKey**](https://www.bing.com/search?q=**CPExportKey**) function is exporting an SSL2 master key and the CRYPT\_SSL2\_FALLBACK flag is set, then, to help prevent version rollback attacks, set the first eight bytes of the encryption block [*padding*](../secgloss/p-gly.md) to 0x03 rather than to random data.</span></span>

<span data-ttu-id="63763-120">Si la **constante \_ DESTROYKEY** de chiffrement est spécifiée dans le paramètre *DwFlags* de la fonction [**CPExportKey**](https://www.bing.com/search?q=**CPExportKey**) , le CSP détruit la clé ou le handle de clé après l’exportation de la clé.</span><span class="sxs-lookup"><span data-stu-id="63763-120">If the **CRYPT\_DESTROYKEY** constant is specified in the *dwFlags* parameter of the [**CPExportKey**](https://www.bing.com/search?q=**CPExportKey**) function, the CSP destroys the key or key handle after exporting the key.</span></span> <span data-ttu-id="63763-121">Cet indicateur est destiné à être utilisé uniquement avec des [*objets BLOB opaques*](../secgloss/o-gly.md).</span><span class="sxs-lookup"><span data-stu-id="63763-121">This flag is intended for use only with [*opaque BLOBs*](../secgloss/o-gly.md).</span></span>

 

 
