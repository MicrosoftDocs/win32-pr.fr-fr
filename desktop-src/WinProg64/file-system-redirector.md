---
title: Redirecteur de système de fichiers
description: Le \\ répertoire windir system32 est réservé aux applications 64 bits sur Windows 64 bits.
ms.assetid: b4d36fe8-8bbb-469b-8ad1-650d559a4c75
keywords:
- redirecteur du système de fichiers 64 bits, programmation Windows
- Guide de programmation Windows 64 bits-programmation Windows 64 bits, redirecteur de système de fichiers
- WOW64 64 bits Windows, redirecteur de système de fichiers
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 561d03c8da51bd37a2d97746296bc74e24e43154
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031570"
---
# <a name="file-system-redirector"></a><span data-ttu-id="bcca9-106">Redirecteur de système de fichiers</span><span class="sxs-lookup"><span data-stu-id="bcca9-106">File System Redirector</span></span>

<span data-ttu-id="bcca9-107">Le répertoire% windir% \\ system32 est réservé aux applications 64 bits sur Windows 64 bits.</span><span class="sxs-lookup"><span data-stu-id="bcca9-107">The %windir%\\System32 directory is reserved for 64-bit applications on 64-bit Windows.</span></span> <span data-ttu-id="bcca9-108">La plupart des noms de fichiers DLL n’ont pas été modifiés lors de la création de versions 64 bits des dll. par conséquent, les versions 32 bits des dll sont stockées dans un répertoire différent.</span><span class="sxs-lookup"><span data-stu-id="bcca9-108">Most DLL file names were not changed when 64-bit versions of the DLLs were created, so 32-bit versions of the DLLs are stored in a different directory.</span></span> <span data-ttu-id="bcca9-109">WOW64 masque cette différence à l’aide d’un *redirecteur de système de fichiers*.</span><span class="sxs-lookup"><span data-stu-id="bcca9-109">WOW64 hides this difference by using a *file system redirector*.</span></span>

<span data-ttu-id="bcca9-110">Dans la plupart des cas, chaque fois qu’une application 32 bits tente d’accéder à% windir% \\ system32,% windir% \\ LastGood \\ system32 ou% windir% \\regedit.exe, l’accès est redirigé vers un chemin d’accès spécifique à l’architecture.</span><span class="sxs-lookup"><span data-stu-id="bcca9-110">In most cases, whenever a 32-bit application attempts to access %windir%\\System32, %windir%\\lastgood\\system32, or %windir%\\regedit.exe, the access is redirected to an architecture-specific path.</span></span>

> [!Note]  
> <span data-ttu-id="bcca9-111">Ces chemins d’accès sont fournis à des fins de référence uniquement.</span><span class="sxs-lookup"><span data-stu-id="bcca9-111">These paths are provided for reference only.</span></span> <span data-ttu-id="bcca9-112">Pour des fins de compatibilité, les applications ne doivent pas utiliser ces chemins directement.</span><span class="sxs-lookup"><span data-stu-id="bcca9-112">For compatibility, applications should not use these paths directly.</span></span> <span data-ttu-id="bcca9-113">Au lieu de cela, ils doivent appeler les API décrites ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="bcca9-113">Instead, they should call the APIs described below.</span></span>

 



|                              |                                          |                                          |
|------------------------------|------------------------------------------|------------------------------------------|
| <span data-ttu-id="bcca9-114">Chemin d’accès d’origine</span><span class="sxs-lookup"><span data-stu-id="bcca9-114">Original Path</span></span>                | <span data-ttu-id="bcca9-115">Chemin Redirigé pour les processus x86 32 bits</span><span class="sxs-lookup"><span data-stu-id="bcca9-115">Redirected Path for 32-bit x86 Processes</span></span> | <span data-ttu-id="bcca9-116">Chemin Redirigé pour les processus ARM 32 bits</span><span class="sxs-lookup"><span data-stu-id="bcca9-116">Redirected Path for 32-bit ARM Processes</span></span> |
| <span data-ttu-id="bcca9-117">% windir% \\ system32</span><span class="sxs-lookup"><span data-stu-id="bcca9-117">%windir%\\System32</span></span>           | <span data-ttu-id="bcca9-118">% windir% \\ SysWOW64</span><span class="sxs-lookup"><span data-stu-id="bcca9-118">%windir%\\SysWOW64</span></span>                       | <span data-ttu-id="bcca9-119">% windir% \\ SysArm32</span><span class="sxs-lookup"><span data-stu-id="bcca9-119">%windir%\\SysArm32</span></span>                       |
| <span data-ttu-id="bcca9-120">% windir% \\ LastGood \\ system32</span><span class="sxs-lookup"><span data-stu-id="bcca9-120">%windir%\\lastgood\\system32</span></span> | <span data-ttu-id="bcca9-121">% windir% \\ LastGood \\ SysWOW64</span><span class="sxs-lookup"><span data-stu-id="bcca9-121">%windir%\\lastgood\\SysWOW64</span></span>             | <span data-ttu-id="bcca9-122">% windir% \\ LastGood \\ SysArm32</span><span class="sxs-lookup"><span data-stu-id="bcca9-122">%windir%\\lastgood\\SysArm32</span></span>             |
| <span data-ttu-id="bcca9-123">% windir% \\regedit.exe</span><span class="sxs-lookup"><span data-stu-id="bcca9-123">%windir%\\regedit.exe</span></span>        | <span data-ttu-id="bcca9-124">% windir% \\ SysWOW64 \\regedit.exe</span><span class="sxs-lookup"><span data-stu-id="bcca9-124">%windir%\\SysWOW64\\regedit.exe</span></span>          | <span data-ttu-id="bcca9-125">% windir% \\ SysArm32 \\regedit.exe</span><span class="sxs-lookup"><span data-stu-id="bcca9-125">%windir%\\ SysArm32\\regedit.exe</span></span>         |



 

<span data-ttu-id="bcca9-126">Si l’accès amène le système à afficher l’invite du contrôle de compte d’utilisateur, la redirection n’a pas lieu.</span><span class="sxs-lookup"><span data-stu-id="bcca9-126">If the access causes the system to display the UAC prompt, redirection does not occur.</span></span> <span data-ttu-id="bcca9-127">Au lieu de cela, la version 64 bits du fichier demandé est lancée.</span><span class="sxs-lookup"><span data-stu-id="bcca9-127">Instead, the 64-bit version of the requested file is launched.</span></span> <span data-ttu-id="bcca9-128">Pour éviter ce problème, spécifiez le répertoire SysWOW64 pour éviter la redirection et assurez-vous d’accéder à la version 32 bits du fichier, ou exécutez l’application 32 bits avec des privilèges d’administrateur pour que l’invite UAC ne s’affiche pas.</span><span class="sxs-lookup"><span data-stu-id="bcca9-128">To prevent this problem, either specify the SysWOW64 directory to avoid redirection and ensure access to the 32-bit version of the file, or run the 32-bit application with administrator privileges so the UAC prompt is not displayed.</span></span>

<span data-ttu-id="bcca9-129">**Windows Server 2003 et Windows XP :  ** UAC n’est pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="bcca9-129">**Windows Server 2003 and Windows XP:  ** UAC is not supported.</span></span>

<span data-ttu-id="bcca9-130">Certains sous-répertoires sont exempts de redirection.</span><span class="sxs-lookup"><span data-stu-id="bcca9-130">Certain subdirectories are exempt from redirection.</span></span> <span data-ttu-id="bcca9-131">L’accès à ces sous-répertoires n’est pas redirigé vers% windir% \\ SysWOW64 :</span><span class="sxs-lookup"><span data-stu-id="bcca9-131">Access to these subdirectories is not redirected to %windir%\\SysWOW64:</span></span> <dl> <span data-ttu-id="bcca9-132">% windir% \\ system32 \\ CatRoot</span><span class="sxs-lookup"><span data-stu-id="bcca9-132">%windir%\\system32\\catroot</span></span>  
<span data-ttu-id="bcca9-133">% windir% \\ system32 \\ Catroot2</span><span class="sxs-lookup"><span data-stu-id="bcca9-133">%windir%\\system32\\catroot2</span></span>  
<span data-ttu-id="bcca9-134">% windir% \\ system32 \\ DriverStore</span><span class="sxs-lookup"><span data-stu-id="bcca9-134">%windir%\\system32\\driverstore</span></span>  
<span data-ttu-id="bcca9-135">% windir% \\ system32 \\ drivers, \\ etc.</span><span class="sxs-lookup"><span data-stu-id="bcca9-135">%windir%\\system32\\drivers\\etc</span></span>  
<span data-ttu-id="bcca9-136">% windir% \\ system32 \\ LogFiles</span><span class="sxs-lookup"><span data-stu-id="bcca9-136">%windir%\\system32\\logfiles</span></span>  
<span data-ttu-id="bcca9-137">% windir% \\ system32 \\ spool</span><span class="sxs-lookup"><span data-stu-id="bcca9-137">%windir%\\system32\\spool</span></span>  
</dl>

<span data-ttu-id="bcca9-138">**Windows server 2008, Windows Vista, Windows server 2003 et Windows XP :  **% windir% \\ system32 \\ DriverStore est redirigé.</span><span class="sxs-lookup"><span data-stu-id="bcca9-138">**Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP:  **%windir%\\system32\\driverstore is redirected.</span></span>

<span data-ttu-id="bcca9-139">Pour récupérer le nom du répertoire système 32 bits, les applications 64 bits doivent utiliser la fonction [**GetSystemWow64Directory2**](/windows/desktop/api/wow64apiset/nf-wow64apiset-getsystemwow64directory2a) (Windows 10, version 1511) ou la fonction [**GetSystemWow64Directory**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath) .</span><span class="sxs-lookup"><span data-stu-id="bcca9-139">To retrieve the name of the 32-bit system directory, 64-bit applications should use the [**GetSystemWow64Directory2**](/windows/desktop/api/wow64apiset/nf-wow64apiset-getsystemwow64directory2a) function (Windows 10, version 1511) or the [**GetSystemWow64Directory**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath) function.</span></span>

<span data-ttu-id="bcca9-140">Les applications doivent utiliser la fonction [**SHGetKnownFolderPath**](https://www.bing.com/search?q=**SHGetKnownFolderPath**) pour déterminer le nom du répertoire% ProgramFiles%.</span><span class="sxs-lookup"><span data-stu-id="bcca9-140">Applications should use the [**SHGetKnownFolderPath**](https://www.bing.com/search?q=**SHGetKnownFolderPath**) function to determine the %ProgramFiles% directory name.</span></span>

<span data-ttu-id="bcca9-141">**Windows Server 2003 et Windows XP :** Les applications doivent utiliser la fonction [**SHGetSpecialFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetspecialfolderpatha) pour déterminer le nom du répertoire% ProgramFiles%.</span><span class="sxs-lookup"><span data-stu-id="bcca9-141">**Windows Server 2003 and Windows XP:** Applications should use the [**SHGetSpecialFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetspecialfolderpatha) function to determine the %ProgramFiles% directory name.</span></span>

<span data-ttu-id="bcca9-142">Les applications peuvent contrôler le redirecteur du système de fichiers WOW64 à l’aide des fonctions [**Wow64DisableWow64FsRedirection**](/windows/desktop/api/wow64apiset/nf-wow64apiset-wow64disablewow64fsredirection), [**Wow64EnableWow64FsRedirection**](/windows/desktop/api/winbase/nf-winbase-wow64enablewow64fsredirection)et [**Wow64RevertWow64FsRedirection**](/windows/desktop/api/wow64apiset/nf-wow64apiset-wow64revertwow64fsredirection) .</span><span class="sxs-lookup"><span data-stu-id="bcca9-142">Applications can control the WOW64 file system redirector using the [**Wow64DisableWow64FsRedirection**](/windows/desktop/api/wow64apiset/nf-wow64apiset-wow64disablewow64fsredirection), [**Wow64EnableWow64FsRedirection**](/windows/desktop/api/winbase/nf-winbase-wow64enablewow64fsredirection), and [**Wow64RevertWow64FsRedirection**](/windows/desktop/api/wow64apiset/nf-wow64apiset-wow64revertwow64fsredirection) functions.</span></span> <span data-ttu-id="bcca9-143">La désactivation de la redirection du système de fichiers affecte toutes les opérations de fichier effectuées par le thread appelant, donc elle doit être désactivée uniquement lorsqu’elle est nécessaire pour un seul appel [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) et réactivée immédiatement après le retour de la fonction.</span><span class="sxs-lookup"><span data-stu-id="bcca9-143">Disabling file system redirection affects all file operations performed by the calling thread, so it should be disabled only when necessary for a single [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) call and re-enabled again immediately after the function returns.</span></span> <span data-ttu-id="bcca9-144">La désactivation de la redirection du système de fichiers pour des périodes plus longues peut empêcher des applications 32 bits de charger des DLL système, provoquant ainsi l’échec des applications.</span><span class="sxs-lookup"><span data-stu-id="bcca9-144">Disabling file system redirection for longer periods can prevent 32-bit applications from loading system DLLs, causing the applications to fail.</span></span>

<span data-ttu-id="bcca9-145">les applications 32 bits peuvent accéder au répertoire système natif en remplaçant% windir% \\ SysNative pour% windir% \\ system32.</span><span class="sxs-lookup"><span data-stu-id="bcca9-145">32-bit applications can access the native system directory by substituting %windir%\\Sysnative for %windir%\\System32.</span></span> <span data-ttu-id="bcca9-146">WOW64 reconnaît SysNative comme un alias spécial utilisé pour indiquer que le système de fichiers ne doit pas rediriger l’accès.</span><span class="sxs-lookup"><span data-stu-id="bcca9-146">WOW64 recognizes Sysnative as a special alias used to indicate that the file system should not redirect the access.</span></span> <span data-ttu-id="bcca9-147">Ce mécanisme est flexible et facile à utiliser. c’est pourquoi il est recommandé de contourner la redirection du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="bcca9-147">This mechanism is flexible and easy to use, therefore, it is the recommended mechanism to bypass file system redirection.</span></span> <span data-ttu-id="bcca9-148">Notez que les applications 64 bits ne peuvent pas utiliser l’alias SysNative, car il s’agit d’un répertoire virtuel qui n’est pas un réel.</span><span class="sxs-lookup"><span data-stu-id="bcca9-148">Note that 64-bit applications cannot use the Sysnative alias as it is a virtual directory not a real one.</span></span>

<span data-ttu-id="bcca9-149">**Windows Server 2003 et Windows XP :** L’alias SysNative a été ajouté à partir de Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="bcca9-149">**Windows Server 2003 and Windows XP:** The Sysnative alias was added starting with Windows Vista.</span></span>

 

 