---
title: Utiliser un réseau hébergé sans fil, partage de connexion Internet
description: Utilisation du partage de connexion Internet et d’un réseau hébergé sans fil
ms.assetid: 56e86ef8-f759-4e56-a591-74e03430125a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 972774e921199e32eb70841c74c7478e2178cda9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103951898"
---
# <a name="use-wireless-hosted-network-internet-connection-sharing"></a><span data-ttu-id="a677e-103">Utiliser un réseau hébergé sans fil, partage de connexion Internet</span><span class="sxs-lookup"><span data-stu-id="a677e-103">Use Wireless Hosted Network, Internet Connection Sharing</span></span>

<span data-ttu-id="a677e-104">Le réseau hébergé sans fil est une nouvelle fonctionnalité WLAN prise en charge sur Windows 7 et Windows 8.</span><span class="sxs-lookup"><span data-stu-id="a677e-104">The Wireless Hosted Network is a new WLAN feature supported on Windows 7 and Windows 8.</span></span> <span data-ttu-id="a677e-105">Il est également pris en charge sur Windows Server 2012 et Windows Server 2008 R2 avec le service de réseau local sans fil installé.</span><span class="sxs-lookup"><span data-stu-id="a677e-105">It is also supported on Windows Server 2012 and Windows Server 2008 R2 with the Wireless LAN Service installed.</span></span> <span data-ttu-id="a677e-106">Cette fonctionnalité implémente deux fonctions principales :</span><span class="sxs-lookup"><span data-stu-id="a677e-106">This feature implements two major functions:</span></span>

-   <span data-ttu-id="a677e-107">La virtualisation d’un adaptateur sans fil physique dans plusieurs cartes sans fil virtuelles, parfois appelées « Wi-Fi virtuel ».</span><span class="sxs-lookup"><span data-stu-id="a677e-107">The virtualization of a physical wireless adapter into more than one virtual wireless adapter sometimes referred to as Virtual Wi-Fi.</span></span>
-   <span data-ttu-id="a677e-108">Un point d’accès sans fil (AP) basé sur des logiciels, parfois appelé SoftAP qui utilise un adaptateur sans fil virtuel désigné.</span><span class="sxs-lookup"><span data-stu-id="a677e-108">A software-based wireless access point (AP) sometimes referred to as a SoftAP that uses a designated virtual wireless adapter.</span></span>

<span data-ttu-id="a677e-109">Le partage de connexion Internet (ICS) est une fonctionnalité de Windows fournie par le biais du service SharedAccess.</span><span class="sxs-lookup"><span data-stu-id="a677e-109">Internet Connection Sharing (ICS) is a feature in Windows provided through the SharedAccess Service.</span></span> <span data-ttu-id="a677e-110">À proprement parler, SharedAccess autorise le partage réseau via un ordinateur où l’accès réseau partagé ne fournit pas nécessairement un accès à Internet.</span><span class="sxs-lookup"><span data-stu-id="a677e-110">Strictly speaking, SharedAccess enables network sharing through a computer where the shared network access does not necessarily provide access to the Internet.</span></span> <span data-ttu-id="a677e-111">Nous utilisons le terme ICS et SharedAccess de manière interchangeable dans cette section, puisque le partage de connexion Internet est un scénario majeur pour le réseau hébergé sans fil et le terme ICS est mieux connu de la communauté des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="a677e-111">We use the term ICS and SharedAccess interchangeably in this section, since Internet Connection Sharing is a major scenario for the wireless Hosted Network and the ICS term is better known to the user community.</span></span>

<span data-ttu-id="a677e-112">Le réseau hébergé sans fil est étroitement lié à ICS pour activer à la fois le réseau personnel sans fil et les scénarios de partage Internet.</span><span class="sxs-lookup"><span data-stu-id="a677e-112">Wireless Hosted Network is closely tied to ICS to enable both the wireless personal area network (PAN) and the Internet sharing scenarios.</span></span> <span data-ttu-id="a677e-113">Cette section fournit des recommandations générales aux développeurs d’applications sur la façon d’intégrer un réseau et un partage de connexion Internet hébergés à l’aide du réseau public sans fil hébergé et des API ICS.</span><span class="sxs-lookup"><span data-stu-id="a677e-113">This section provides general recommendations to application developers on how to integrate wireless Hosted Network and ICS using the public wireless Hosted Network and ICS APIs.</span></span>

## <a name="internet-connection-sharing"></a><span data-ttu-id="a677e-114">Partage de connexion Internet</span><span class="sxs-lookup"><span data-stu-id="a677e-114">Internet Connection Sharing</span></span>

<span data-ttu-id="a677e-115">Le service ICS fonctionne dans l’un des deux modes possibles :</span><span class="sxs-lookup"><span data-stu-id="a677e-115">The ICS Service operates in one of the two possible modes:</span></span>

-   <span data-ttu-id="a677e-116">Mode autonome</span><span class="sxs-lookup"><span data-stu-id="a677e-116">Standalone mode</span></span>

    <span data-ttu-id="a677e-117">Seule la fonction serveur DHCPv4 fonctionne lorsque le service ICS est appelé.</span><span class="sxs-lookup"><span data-stu-id="a677e-117">Only the DHCPv4 server function is operating when the ICS service is invoked.</span></span> <span data-ttu-id="a677e-118">Il s’agit d’un mode d’opération spécial pour le partage de connexion Internet et n’est disponible que par le biais du réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-118">This is a special operation mode for ICS and is only made available through the wireless Hosted Network.</span></span> <span data-ttu-id="a677e-119">Un utilisateur ou une application n’est pas en mesure de démarrer et d’arrêter directement le partage de connexion Internet autonome via des API de partage de connexion Internet publiques ou des commandes **netsh** .</span><span class="sxs-lookup"><span data-stu-id="a677e-119">A user or application is not able to directly start and stop standalone ICS through public ICS APIs or **netsh** commands.</span></span> <span data-ttu-id="a677e-120">Le démarrage du réseau hébergé sans fil implique généralement le démarrage du partage de connexion Internet en mode autonome pour utiliser la fonction de serveur DHCPv4 afin de fournir des adresses IPv4 privées pour les appareils connectés.</span><span class="sxs-lookup"><span data-stu-id="a677e-120">Starting the wireless Hosted Network typically involves starting ICS in standalone mode to use the DHCPv4 server function to provide private IPv4 addresses for connected devices.</span></span> <span data-ttu-id="a677e-121">La communication réseau pour les appareils connectés est limitée à l’envoi et à la réception de paquets réseau entre un appareil connecté et l’ordinateur local qui héberge le réseau sans fil hébergé et entre les appareils connectés eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="a677e-121">Network communication for the connected devices is limited to sending and receiving network packets between a connected device and the local computer hosting the wireless Hosted Network and among the connected devices themselves.</span></span> <span data-ttu-id="a677e-122">Cela active efficacement le scénario Wireless Personal Area Network pour le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-122">This effectively enables the wireless personal area network scenario for the wireless Hosted Network.</span></span>

-   <span data-ttu-id="a677e-123">Mode complet</span><span class="sxs-lookup"><span data-stu-id="a677e-123">Full mode</span></span>

    <span data-ttu-id="a677e-124">Toutes les fonctionnalités de l’ICS fonctionnent lorsque le service est appelé, comme la traduction d’adresses réseau et les fonctions de serveur DHCP pour IPv4 et IPv6.</span><span class="sxs-lookup"><span data-stu-id="a677e-124">All the features of ICS are operating when the service is invoked, such as network address translation and DHCP server functions for both IPv4 and IPv6.</span></span> <span data-ttu-id="a677e-125">Il s’agit du mode de fonctionnement normal pour le partage de connexion Internet.</span><span class="sxs-lookup"><span data-stu-id="a677e-125">This is the normal mode of operation for ICS.</span></span> <span data-ttu-id="a677e-126">Un utilisateur ou une application peut démarrer et arrêter le mode ICS complet via des API publiques ou des commandes NetShell.</span><span class="sxs-lookup"><span data-stu-id="a677e-126">A user or application may start and stop full ICS mode through public APIs or netshell commands.</span></span> <span data-ttu-id="a677e-127">Par exemple, ce service peut être arrêté à l’aide de net stop SharedAccess à partir d’une invite de commandes avec élévation de privilèges.</span><span class="sxs-lookup"><span data-stu-id="a677e-127">For example, this service can be stopped using net stop sharedaccess from an elevated command prompt.</span></span> <span data-ttu-id="a677e-128">En associant un réseau hébergé sans fil à un partage de connexion complet, la communication réseau pour les appareils connectés n’est pas limitée au PAN sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-128">Combining wireless Hosted Network with full ICS, Network communication for the connected devices is not limited to the wireless PAN.</span></span> <span data-ttu-id="a677e-129">Tout appareil connecté a accès au réseau (par exemple, Internet) via la connexion réseau partagée de l’ordinateur qui exécute le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-129">Any connected device has access to network (such as the Internet) through the shared network connection from the computer running the wireless Hosted Network.</span></span> <span data-ttu-id="a677e-130">Cela active efficacement le scénario de partage réseau pour le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-130">This effectively enables the Network sharing scenario for the wireless Hosted Network.</span></span>

<span data-ttu-id="a677e-131">Dans cette section, nous utilisons le terme de partage de la connexion Internet (ICS) pour signifier le cas où toutes les fonctions de partage de connexion Internet sont appelées dans le service ICS pour fournir l’accès à toutes les fonctionnalités de l’ICS complet avec le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-131">In this section, we use the term full ICS to mean the case where all the ICS functions are invoked in ICS Service to provide access to all the full ICS features with the wireless Hosted Network.</span></span>

<span data-ttu-id="a677e-132">Les deux modes d’opération ICS s’excluent mutuellement avec une priorité plus élevée pour le partage de connexion Internet.</span><span class="sxs-lookup"><span data-stu-id="a677e-132">The two ICS operation modes are mutually exclusive with full ICS taking higher precedence.</span></span> <span data-ttu-id="a677e-133">Le service ICS peut passer du mode autonome au mode complet, mais pas du mode plein au mode autonome.</span><span class="sxs-lookup"><span data-stu-id="a677e-133">The ICS Service may transition from standalone mode to full mode, but not from full mode to standalone mode.</span></span> <span data-ttu-id="a677e-134">Le mode autonome ICS a été introduit dans Windows 7 et sur Windows Server 2008 R2 avec le service de réseau local sans fil installé conjointement avec la fonctionnalité de réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-134">The ICS standalone mode was introduced in Windows 7 and on Windows Server 2008 R2 with the Wireless LAN Service installed in conjunction with the wireless Hosted Network feature.</span></span> <span data-ttu-id="a677e-135">Elle n’est pas disponible dans les versions précédentes de Windows.</span><span class="sxs-lookup"><span data-stu-id="a677e-135">It is not available in previous versions of Windows.</span></span>

<span data-ttu-id="a677e-136">Toute opération ICS complète implique deux cartes réseau différentes dans le système :</span><span class="sxs-lookup"><span data-stu-id="a677e-136">Any full ICS operation involves two different network adapters in the system:</span></span>

-   <span data-ttu-id="a677e-137">Interface publique.</span><span class="sxs-lookup"><span data-stu-id="a677e-137">The public interface.</span></span> <span data-ttu-id="a677e-138">Il s’agit de l’interface réseau avec accès à Internet.</span><span class="sxs-lookup"><span data-stu-id="a677e-138">This is the network interface with access to the Internet.</span></span> <span data-ttu-id="a677e-139">C’est cette interface que l’ordinateur local qui exécute ICS utilise pour partager Internet avec les clients et les appareils qui se connectent à ce dernier via SoftAP.</span><span class="sxs-lookup"><span data-stu-id="a677e-139">It is this interface that the local computer running ICS uses to share the Internet with clients and devices connecting to it via SoftAP.</span></span>
-   <span data-ttu-id="a677e-140">Interface privée.</span><span class="sxs-lookup"><span data-stu-id="a677e-140">The private interface.</span></span> <span data-ttu-id="a677e-141">Il s’agit de l’interface réseau que d’autres appareils utilisent pour se connecter à l’ordinateur local qui exécute le partage de connexion Internet.</span><span class="sxs-lookup"><span data-stu-id="a677e-141">This is the network interface that other devices use to connect to the local computer that is running ICS.</span></span> <span data-ttu-id="a677e-142">Un serveur DHCPv4 s’exécute sur cette interface privée pour fournir des adresses IP locales privées aux autres ordinateurs distants.</span><span class="sxs-lookup"><span data-stu-id="a677e-142">A DHCPv4 server is running on this private interface to provide private local IP addresses to the other remote computers.</span></span>

<span data-ttu-id="a677e-143">Lorsque l’interface publique n’a pas accès à Internet, le serveur DHCP sur l’interface privée continue de fournir des adresses IP locales aux appareils connectés.</span><span class="sxs-lookup"><span data-stu-id="a677e-143">When the public interface does not have Internet access, the DHCP server on the private interface continues to provide local IP addresses to the connected devices.</span></span> <span data-ttu-id="a677e-144">Le partage de connexion Internet autonome implique uniquement l’interface privée sur laquelle SoftAP est exécuté ; elle n’implique aucune interface publique.</span><span class="sxs-lookup"><span data-stu-id="a677e-144">Standalone ICS only involves the private interface on which SoftAP is running; it does not involve any public interface.</span></span>

<span data-ttu-id="a677e-145">À tout moment, il y a au plus une instance de l’intégralité du partage de connexion Internet en cours d’exécution sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="a677e-145">At any time, there is at most one instance of full ICS running on the local computer.</span></span> <span data-ttu-id="a677e-146">Si le partage de connexion Internet complet est déjà en cours d’exécution sur l’ordinateur local, le démarrage d’un autre partage de connexion Internet présente les comportements fonctionnels suivants :</span><span class="sxs-lookup"><span data-stu-id="a677e-146">If full ICS is already running on the local computer, starting another full ICS exhibits the following functional behaviors:</span></span>

-   <span data-ttu-id="a677e-147">Si les interfaces publiques et privées du nouveau partage de partage de la connexion (ICS) complète sont identiques à celles du partage de connexion Internet complet existant, le fait de démarrer la deuxième ICS complète équivaut à une absence d’opération.</span><span class="sxs-lookup"><span data-stu-id="a677e-147">If the public and private interfaces of the new full ICS are the same as the existing full ICS, starting the second full ICS is equivalent to a no-op.</span></span>
-   <span data-ttu-id="a677e-148">Si la nouvelle interface publique est différente de l’ancienne interface publique, mais que la nouvelle interface privée est la même que l’ancienne interface privée, le démarrage d’un deuxième partage de connexion Internet n’a que peu d’impact sur les périphériques connectés sur la même interface privée.</span><span class="sxs-lookup"><span data-stu-id="a677e-148">If the new public interface is different from the old public interface, but the new private interface is the same as the old private interface, starting a second full ICS has little impact on the connected devices on the same private interface.</span></span> <span data-ttu-id="a677e-149">La possibilité d’accéder à Internet peut changer avec la nouvelle interface publique.</span><span class="sxs-lookup"><span data-stu-id="a677e-149">The ability to access the Internet may change with the new public interface.</span></span>
-   <span data-ttu-id="a677e-150">Si la nouvelle interface privée est différente de l’ancienne interface privée, les fonctions ICS cesseront de fonctionner sur l’ancienne interface privée et commenceront à s’appliquer à la nouvelle interface privée.</span><span class="sxs-lookup"><span data-stu-id="a677e-150">If the new private interface is different than the old private interface, ICS functions will stop working on the old private interface and start applying to the new private interface.</span></span> <span data-ttu-id="a677e-151">Tout appareil distant qui se connecte à l’ordinateur local à l’aide de l’ancienne interface privée perd la connectivité IP à l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="a677e-151">Any remote device connecting to the local computer using the old private interface will lose IP connectivity to the local computer.</span></span>

<span data-ttu-id="a677e-152">Lorsque le partage de connexion Internet complet est déjà en cours d’exécution, l’appel d’un deuxième partage de connexion Internet complet entraîne une interruption des appareils connectés à distance à l’aide de l’ancienne interface privée, à condition que la deuxième intégration ICS utilise une nouvelle interface privée différente.</span><span class="sxs-lookup"><span data-stu-id="a677e-152">When full ICS is already running, invoking a second full ICS is disruptive to remotely connected devices using the old private interface as long as the second ICS integration uses a different new private interface.</span></span>

<span data-ttu-id="a677e-153">Pour gérer et utiliser le service ICS afin de prendre en charge l’intégration du partage de connexion Internet avec un réseau hébergé sans fil, une application logicielle doit d’abord obtenir une interface [**INetSharingManager**](/windows/win32/api/netcon/nn-netcon-inetsharingmanager) .</span><span class="sxs-lookup"><span data-stu-id="a677e-153">To manage and use the ICS service to support ICS integration with wireless Hosted Network, a software application must first obtain an [**INetSharingManager**](/windows/win32/api/netcon/nn-netcon-inetsharingmanager) interface.</span></span> <span data-ttu-id="a677e-154">L’interface **INetSharingManager** fournit l’accès directement ou indirectement à toutes les autres interfaces COM de l’API ICS.</span><span class="sxs-lookup"><span data-stu-id="a677e-154">The **INetSharingManager** interface provides access directly or indirectly to all the other COM interfaces in the ICS API.</span></span> <span data-ttu-id="a677e-155">La [**méthode \_ SharingInstalled**](/windows/win32/api/netcon/nf-netcon-inetsharingmanager-get_sharinginstalled) sur l’interface **INetSharingManager** indique si l’ordinateur local prend en charge le partage de connexion.</span><span class="sxs-lookup"><span data-stu-id="a677e-155">The [**get\_SharingInstalled**](/windows/win32/api/netcon/nf-netcon-inetsharingmanager-get_sharinginstalled) method on the **INetSharingManager** interface reports whether the local computer supports connection sharing.</span></span> <span data-ttu-id="a677e-156">La méthode [**obtenir \_ EnumEveryConnection**](/windows/win32/api/netcon/nf-netcon-inetsharingmanager-get_enumeveryconnection) sur l’interface **INetSharingManager** récupère une interface d’énumération pour toutes les connexions dans le dossier connexions.</span><span class="sxs-lookup"><span data-stu-id="a677e-156">The [**get\_EnumEveryConnection**](/windows/win32/api/netcon/nf-netcon-inetsharingmanager-get_enumeveryconnection) method on the **INetSharingManager** interface retrieves an enumeration interface for all connections in the connections folder.</span></span> <span data-ttu-id="a677e-157">La méthode [**obtenir \_ INetSharingConfigurationForINetConnection**](/windows/win32/api/netcon/nf-netcon-inetsharingmanager-get_inetsharingconfigurationforinetconnection) récupère une interface [**INetSharingConfiguration**](/windows/win32/api/netcon/nn-netcon-inetsharingconfiguration) pour la connexion spécifiée.</span><span class="sxs-lookup"><span data-stu-id="a677e-157">The [**get\_INetSharingConfigurationForINetConnection**](/windows/win32/api/netcon/nf-netcon-inetsharingmanager-get_inetsharingconfigurationforinetconnection) method retrieves an [**INetSharingConfiguration**](/windows/win32/api/netcon/nn-netcon-inetsharingconfiguration) interface for the specified connection.</span></span> <span data-ttu-id="a677e-158">Les méthodes de l’interface **INetSharingConfiguration** peuvent être utilisées pour interroger et modifier les paramètres du partage de connexion Internet.</span><span class="sxs-lookup"><span data-stu-id="a677e-158">Methods on the **INetSharingConfiguration** interface can be used to query and change ICS settings.</span></span>

<span data-ttu-id="a677e-159">Le réseau hébergé sans fil doit être démarré avant d’appeler la méthode [**\_ EnumEveryConnection**](/windows/win32/api/netcon/nf-netcon-inetsharingmanager-get_enumeveryconnection) sur l’interface [**INetSharingManager**](/windows/win32/api/netcon/nn-netcon-inetsharingmanager) pour énumérer toutes les connexions dans le dossier connexions.</span><span class="sxs-lookup"><span data-stu-id="a677e-159">The wireless Hosted Network must be started before calling the [**get\_EnumEveryConnection**](/windows/win32/api/netcon/nf-netcon-inetsharingmanager-get_enumeveryconnection) method on the [**INetSharingManager**](/windows/win32/api/netcon/nn-netcon-inetsharingmanager) interface to enumerate all connections in the connections folder.</span></span>

<span data-ttu-id="a677e-160">Pour plus d’informations sur le partage de connexion Internet et les interfaces et méthodes publiques qui peuvent être utilisées pour interroger et modifier les paramètres ICS, consultez la documentation sur le [partage de connexion Internet et le pare-feu de connexion Internet](/previous-versions/windows/desktop/ics/about-internet-connection-sharing-and-internet-connection-firewall).</span><span class="sxs-lookup"><span data-stu-id="a677e-160">For information on ICS and the public interfaces and methods that can be used to query and change ICS settings, please see the documentation on [About Internet Connection Sharing and Internet Connection Firewall](/previous-versions/windows/desktop/ics/about-internet-connection-sharing-and-internet-connection-firewall).</span></span>

## <a name="hosted-network-and-ics-integration"></a><span data-ttu-id="a677e-161">Intégration du réseau hébergé et du partage de connexion Internet</span><span class="sxs-lookup"><span data-stu-id="a677e-161">Hosted Network and ICS Integration</span></span>

<span data-ttu-id="a677e-162">Lorsque le partage de connexion Internet complet n’est pas en cours d’exécution, le démarrage d’un réseau hébergé sans fil démarre également en interne le service ICS en mode autonome avec uniquement la fonction serveur DHCPv4 pour allouer des adresses IP pour les appareils connectés sur l’interface réseau hébergée sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-162">When full ICS is not running, starting a wireless Hosted Network also internally starts the ICS Service in standalone mode with only the DHCPv4 server function to allocate IP addresses for the connected devices on the wireless Hosted Network interface.</span></span> <span data-ttu-id="a677e-163">La plage d’adresses de sous-réseau pour le serveur DHCPv4 autonome est 192.168.173.0/24.</span><span class="sxs-lookup"><span data-stu-id="a677e-163">The subnet address range for the standalone DHCPv4 server is 192.168.173.0/24.</span></span> <span data-ttu-id="a677e-164">Cela diffère de la plage de sous-réseau de 192.168.137.0/24 qui est utilisée avec le partage de connexion Internet complet.</span><span class="sxs-lookup"><span data-stu-id="a677e-164">This is different from the subnet range of 192.168.137.0/24 that is used with full ICS.</span></span>

<span data-ttu-id="a677e-165">Le démarrage d’un réseau hébergé sans fil avec l’accès au partage de la connexion complète utilise la logique suivante :</span><span class="sxs-lookup"><span data-stu-id="a677e-165">Starting a wireless Hosted Network with full ICS employs the following logic:</span></span>

-   <span data-ttu-id="a677e-166">Si le partage de connexion Internet complet n’est pas déjà en cours d’exécution, le démarrage d’un réseau hébergé sans fil démarre également le service ICS avec un serveur DHCPv4 autonome.</span><span class="sxs-lookup"><span data-stu-id="a677e-166">If full ICS is not already running, starting a wireless Hosted Network also starts the ICS Service with standalone DHCPv4 server.</span></span>
-   <span data-ttu-id="a677e-167">Si le partage de connexion Internet complet est déjà en cours d’exécution et que l’interface privée est l’interface réseau hébergée sans fil, démarrez simplement le réseau sans fil hébergé.</span><span class="sxs-lookup"><span data-stu-id="a677e-167">If full ICS is already running and the private interface is the wireless Hosted Network interface, just start the wireless Hosted Network.</span></span>
-   <span data-ttu-id="a677e-168">Si le partage de connexion Internet complet est déjà en cours d’exécution mais que l’interface privée n’est pas l’interface réseau hébergée sans fil, le réseau sans fil hébergé est démarré sans la fonction serveur DHCPv4 sur l’interface réseau hébergée sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-168">If full ICS is already running but the private interface is not the wireless Hosted Network interface, the wireless Hosted Network will be started without the DHCPv4 server function on the wireless Hosted Network interface.</span></span>

<span data-ttu-id="a677e-169">L’impact de la logique ci-dessus met en évidence les faits suivants :</span><span class="sxs-lookup"><span data-stu-id="a677e-169">The impact of the logic above highlights the following facts:</span></span>

-   <span data-ttu-id="a677e-170">Le partage de connexion Internet ne passe pas du mode plein au mode autonome.</span><span class="sxs-lookup"><span data-stu-id="a677e-170">ICS does not transition from full mode to standalone mode.</span></span>
-   <span data-ttu-id="a677e-171">Le mode autonome ne peut être appelé que par le réseau hébergé sans fil lorsque le partage de connexion Internet n’est pas exécuté en mode complet.</span><span class="sxs-lookup"><span data-stu-id="a677e-171">Standalone mode can only be invoked by the wireless Hosted Network when ICS is not running in full mode.</span></span>
-   <span data-ttu-id="a677e-172">Si le partage de connexion Internet s’exécute en mode autonome, il est reporté en mode complet si un utilisateur ou une application démarre ICS en mode complet.</span><span class="sxs-lookup"><span data-stu-id="a677e-172">If ICS is running in standalone mode, it will be preempted into full mode if a user or application starts ICS in full mode.</span></span>
-   <span data-ttu-id="a677e-173">La transition du mode autonome vers le mode plein dans le partage de connexion Internet entraîne une interruption des appareils connectés dans le PAN sans fil si l’interface privée de l’accès à Internet complet n’est pas la même que celle de SoftAP.</span><span class="sxs-lookup"><span data-stu-id="a677e-173">Transitioning from standalone mode to full mode in ICS will be disruptive to connected devices in the wireless PAN if the private interface of full ICS is not the same as the one for SoftAP.</span></span>

<span data-ttu-id="a677e-174">Il faut du temps pour démarrer ou arrêter le service ICS sur l’ordinateur local en mode complet ou autonome.</span><span class="sxs-lookup"><span data-stu-id="a677e-174">It takes time to start or stop the ICS Service on the local computer in either full or standalone mode.</span></span> <span data-ttu-id="a677e-175">Une application doit vérifier l’état du service ICS à l’aide de la fonction **NotifyServiceStatusChange** pour s’assurer que le service ICS n’est pas dans l’état d’attente démarrer/arrêter avant de démarrer ou d’arrêter le réseau sans fil hébergé pour une utilisation avec l’intégration ICS.</span><span class="sxs-lookup"><span data-stu-id="a677e-175">An application should check the state of ICS Service using the **NotifyServiceStatusChange** function to make sure that the ICS Service is not in the start/stop pending state before starting or stopping the wireless Hosted Network for use with ICS integration.</span></span>

## <a name="starting-and-stopping-the-wireless-hosted-network"></a><span data-ttu-id="a677e-176">Démarrage et arrêt du réseau hébergé sans fil</span><span class="sxs-lookup"><span data-stu-id="a677e-176">Starting and Stopping the Wireless Hosted Network</span></span>

<span data-ttu-id="a677e-177">Windows fournit une plateforme où plusieurs applications simultanées sont autorisées à gérer un réseau hébergé sans fil en même temps.</span><span class="sxs-lookup"><span data-stu-id="a677e-177">Windows provides a platform where more than one concurrent application is allowed to manage a wireless Hosted Network at the same time.</span></span> <span data-ttu-id="a677e-178">Plus précisément, chaque application peut démarrer et arrêter le réseau hébergé sans fil proprement dit, sans connaissance préalable des autres applications.</span><span class="sxs-lookup"><span data-stu-id="a677e-178">Specifically each application can start and stop the wireless Hosted Network on its own, without prior knowledge about other applications.</span></span>

<span data-ttu-id="a677e-179">Il existe deux ensembles de fonctions permettant de démarrer et d’arrêter un réseau hébergé.</span><span class="sxs-lookup"><span data-stu-id="a677e-179">There are two sets of functions to start and stop a Hosted Network.</span></span>

<span data-ttu-id="a677e-180">Plusieurs applications peuvent nécessiter l’utilisation du réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-180">Multiple applications may require the use of the wireless Hosted Network.</span></span> <span data-ttu-id="a677e-181">Les fonctions [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) et [**WlanHostedNetworkStopUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing) démarrent et arrêtent une entrée réseau hébergée sans fil d’une manière compatible avec d’autres applications simultanées.</span><span class="sxs-lookup"><span data-stu-id="a677e-181">The [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) and [**WlanHostedNetworkStopUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing) functions start and stop a wireless Hosted Network in a way that is compatible with other concurrent applications.</span></span> <span data-ttu-id="a677e-182">Les fonctions **WlanHostedNetworkStartUsing** et **WlanHostedNetworkStopUsing** permettent à une application d’avoir une référence au réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-182">The **WlanHostedNetworkStartUsing** and **WlanHostedNetworkStopUsing** functions allow an application to have a reference to the wireless Hosted Network.</span></span> <span data-ttu-id="a677e-183">Ce mécanisme maintient le réseau hébergé sans fil en cours d’exécution, à condition qu’au moins une autre application ait une référence actuelle au réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-183">This mechanism keeps the wireless Hosted Network running provided that at least one other application has a current reference to the wireless Hosted Network.</span></span> <span data-ttu-id="a677e-184">N’importe quel utilisateur peut appeler ces fonctions.</span><span class="sxs-lookup"><span data-stu-id="a677e-184">Any user can call these functions.</span></span> <span data-ttu-id="a677e-185">Les appels réussis à **WlanHostedNetworkStartUsing** doivent être mis en correspondance par des appels à la fonction **WlanHostedNetworkStopUsing** .</span><span class="sxs-lookup"><span data-stu-id="a677e-185">Successful calls to **WlanHostedNetworkStartUsing** must be matched by calls to the **WlanHostedNetworkStopUsing** function.</span></span> <span data-ttu-id="a677e-186">Toute modification de l’état du réseau hébergé provoquée par la fonction **WlanHostedNetworkStartUsing** est automatiquement annulée si l’application appelante ferme son handle appelant (en appelant [**WlanCloseHandle**](/windows/desktop/api/wlanapi/nf-wlanapi-wlanclosehandle) avec le même paramètre *hClientHandle* passé à **WlanHostedNetworkStartUsing**) ou si le processus se termine.</span><span class="sxs-lookup"><span data-stu-id="a677e-186">Any Hosted Network state change caused by the **WlanHostedNetworkStartUsing** function would be automatically undone if the calling application closes its calling handle (by calling [**WlanCloseHandle**](/windows/desktop/api/wlanapi/nf-wlanapi-wlanclosehandle) with the same *hClientHandle* parameter passed to **WlanHostedNetworkStartUsing**) or if the process ends.</span></span>

<span data-ttu-id="a677e-187">Les fonctions [**WlanHostedNetworkForceStart**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart) et [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) forcent le démarrage et l’arrêt d’un réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-187">The [**WlanHostedNetworkForceStart**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart) and [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) functions force start and stop a wireless Hosted Network.</span></span> <span data-ttu-id="a677e-188">Ces fonctions ne peuvent être appelées que si l’utilisateur dispose des privilèges élevés appropriés.</span><span class="sxs-lookup"><span data-stu-id="a677e-188">These functions can only be called if the user has the appropriate elevated privilege.</span></span> <span data-ttu-id="a677e-189">Les appels réussis à **WlanHostedNetworkForceStart** peuvent éventuellement être mis en correspondance par un appel à la fonction **WlanHostedNetworkForceStop** , selon la conception de l’application.</span><span class="sxs-lookup"><span data-stu-id="a677e-189">Successful calls to **WlanHostedNetworkForceStart** may eventually be matched by a call to the **WlanHostedNetworkForceStop** function, depending on the application design.</span></span> <span data-ttu-id="a677e-190">Ces fonctions migrent l’état du réseau hébergé sans fil sans associer la demande au descripteur appelant de l’application.</span><span class="sxs-lookup"><span data-stu-id="a677e-190">These functions transition the wireless Hosted Network state without associating the request with the application's calling handle.</span></span> <span data-ttu-id="a677e-191">Toute modification de l’état du réseau hébergé provoquée par la fonction **WlanHostedNetworkForceStart** n’est pas automatiquement annulée si l’application appelante ferme son handle appelant (en appelant [**WlanCloseHandle**](/windows/desktop/api/wlanapi/nf-wlanapi-wlanclosehandle) avec le même paramètre *hClientHandle* passé à [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing)) ou si le processus se termine.</span><span class="sxs-lookup"><span data-stu-id="a677e-191">Any Hosted Network state change caused by the **WlanHostedNetworkForceStart** function would not be automatically undone if the calling application closes its calling handle (by calling [**WlanCloseHandle**](/windows/desktop/api/wlanapi/nf-wlanapi-wlanclosehandle) with the same *hClientHandle* parameter passed to [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing)) or if the process ends.</span></span> <span data-ttu-id="a677e-192">Si l’application qui a appelé la fonction **WlanHostedNetworkForceStart** se ferme sans appeler l’une des fonctions pour arrêter le réseau hébergé sans fil, le réseau hébergé reste en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="a677e-192">If the application that called the **WlanHostedNetworkForceStart** function closes without calling one of the functions to stop the wireless Hosted Network, then Hosted Network is left running.</span></span> <span data-ttu-id="a677e-193">Une application peut appeler la fonction **WlanHostedNetworkForceStart** après avoir vérifié qu’un utilisateur système avec des privilèges élevés accepte les exigences d’alimentation accrues inhérentes à l’exécution du réseau hébergé sans fil pendant des périodes prolongées.</span><span class="sxs-lookup"><span data-stu-id="a677e-193">An application might call the **WlanHostedNetworkForceStart** function after ensuring that an elevated system user accepts the increased power requirements involved in running the wireless Hosted Network for extended periods of time.</span></span>

<span data-ttu-id="a677e-194">Les recommandations générales sur les fonctions à appeler pour démarrer et arrêter un réseau hébergé sans fil sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="a677e-194">The general recommendations on which functions to call to start and stop a wireless Hosted Network are as follows:</span></span>

-   <span data-ttu-id="a677e-195">Utilisez les fonctions [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) et [**WlanHostedNetworkStopUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing) dans une application pour démarrer et arrêter un réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-195">Use the [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) and [**WlanHostedNetworkStopUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing) functions within an application to start and stop a wireless Hosted Network.</span></span>
-   <span data-ttu-id="a677e-196">N’utilisez pas la fonction [**WlanHostedNetworkForceStart**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart) pour démarrer un réseau hébergé sans fil à moins qu’il soit absolument requis par l’application.</span><span class="sxs-lookup"><span data-stu-id="a677e-196">Do not use the [**WlanHostedNetworkForceStart**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart) function to start a wireless Hosted Network unless it is absolutely required by the application.</span></span> <span data-ttu-id="a677e-197">La fonction **WlanHostedNetworkForceStart** nécessite également des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="a677e-197">The **WlanHostedNetworkForceStart** function also requires elevated privileges.</span></span>
-   <span data-ttu-id="a677e-198">Utilisez uniquement la fonction [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) comme méthode de récupération.</span><span class="sxs-lookup"><span data-stu-id="a677e-198">Only use the [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) function as a recovery method.</span></span> <span data-ttu-id="a677e-199">La fonction **WlanHostedNetworkForceStop** provoque l’arrêt immédiat d’un réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-199">The **WlanHostedNetworkForceStop** function causes a wireless Hosted Network to stop immediately.</span></span> <span data-ttu-id="a677e-200">D’autres applications qui écoutent les notifications de réseau hébergé sans fil peuvent avoir besoin de prendre des mesures de récupération.</span><span class="sxs-lookup"><span data-stu-id="a677e-200">Other applications that listen for wireless Hosted Network notifications may need to take recovery actions.</span></span> <span data-ttu-id="a677e-201">Pour plus d’informations, consultez la discussion ci-dessous sur la séquence de récupération pour un réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-201">For more information, see the discussion below on the recovery sequence for wireless Hosted Network.</span></span>

## <a name="start-sequence-for-wireless-hosted-network"></a><span data-ttu-id="a677e-202">Démarrer la séquence pour un réseau hébergé sans fil</span><span class="sxs-lookup"><span data-stu-id="a677e-202">Start Sequence for Wireless Hosted Network</span></span>

<span data-ttu-id="a677e-203">Pour une application qui démarre un réseau hébergé sans fil avec un partage de connexion complet, il est recommandé de démarrer le réseau sans fil hébergé, puis de démarrer le partage de connexion Internet complet.</span><span class="sxs-lookup"><span data-stu-id="a677e-203">For an application that starts a wireless Hosted Network with full ICS, the recommendation is to start the wireless Hosted Network, then start full ICS.</span></span> <span data-ttu-id="a677e-204">Si un réseau hébergé sans fil est déjà en cours d’exécution, une application doit utiliser la fonction [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) pour arrêter le réseau sans fil hébergé uniquement si le partage de connexion Internet complet est requis mais n’a pas été activé avant le démarrage du réseau hébergé.</span><span class="sxs-lookup"><span data-stu-id="a677e-204">If a wireless Hosted Network is already running, an application should use the [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) function to stop the wireless Hosted Network only if full ICS is required but has not been enabled before the Hosted Network was started.</span></span> <span data-ttu-id="a677e-205">Cela permettra à d’autres applications de récupérer des interruptions potentielles provoquées par le démarrage du partage de connexion Internet complet.</span><span class="sxs-lookup"><span data-stu-id="a677e-205">This will allow other applications to recover from potential disruptions caused by the start of full ICS.</span></span> <span data-ttu-id="a677e-206">Pour plus d’informations, consultez la discussion ci-dessous sur la séquence de récupération pour un réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-206">For more information, see the discussion below on the recovery sequence for wireless Hosted Network.</span></span> <span data-ttu-id="a677e-207">L’opération combinée doit réussir et échouer dans son ensemble.</span><span class="sxs-lookup"><span data-stu-id="a677e-207">The combined operation should succeed and fail as a whole.</span></span>

> [!Note]  
> <span data-ttu-id="a677e-208">Le réseau hébergé sans fil doit être démarré avant toute tentative d’énumération de l’adaptateur correspondant à l’aide de l’interface [**IEnumNetSharingEveryConnection**](/windows/win32/api/netcon/nn-netcon-ienumnetsharingeveryconnection) .</span><span class="sxs-lookup"><span data-stu-id="a677e-208">The wireless Hosted Network must be started before attempting to enumerate the corresponding adapter using the [**IEnumNetSharingEveryConnection**](/windows/win32/api/netcon/nn-netcon-ienumnetsharingeveryconnection) interface.</span></span>

 

<span data-ttu-id="a677e-209">Les étapes ordonnées suivantes sont la séquence de démarrage recommandée dans une application utilisant un réseau hébergé sans fil avec le partage de connexion Internet complet :</span><span class="sxs-lookup"><span data-stu-id="a677e-209">The following ordered steps are the recommended start sequence in an application using wireless Hosted Network with full ICS:</span></span>

-   <span data-ttu-id="a677e-210">Appelez la fonction [**WlanHostedNetworkInitSettings**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkinitsettings) pour vous assurer que le réseau hébergé sans fil est configuré et prêt à être utilisé.</span><span class="sxs-lookup"><span data-stu-id="a677e-210">Call the [**WlanHostedNetworkInitSettings**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkinitsettings) function to make sure wireless Hosted Network is configured and ready to be used.</span></span>
-   <span data-ttu-id="a677e-211">Appelez les fonctions [**WlanHostedNetworkQueryStatus**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkquerystatus) et [**WlanHostedNetworkQueryProperty**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkqueryproperty) pour déterminer si le réseau hébergé sans fil est autorisé et disponible.</span><span class="sxs-lookup"><span data-stu-id="a677e-211">Call the [**WlanHostedNetworkQueryStatus**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkquerystatus) and [**WlanHostedNetworkQueryProperty**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkqueryproperty) functions to determine if the wireless Hosted Network is allowed and available.</span></span> <span data-ttu-id="a677e-212">Si le réseau hébergé sans fil n’est pas autorisé et n’est pas disponible, retourne une erreur.</span><span class="sxs-lookup"><span data-stu-id="a677e-212">If the wireless Hosted Network is not allowed and not available, return an error.</span></span>
-   <span data-ttu-id="a677e-213">Vérifiez si le service ICS utilisé pour le partage de connexion Internet complet est autorisé.</span><span class="sxs-lookup"><span data-stu-id="a677e-213">Test to see if the ICS Service used for full ICS is allowed.</span></span> <span data-ttu-id="a677e-214">Si le service ICS ne peut pas être démarré, retourne une erreur.</span><span class="sxs-lookup"><span data-stu-id="a677e-214">If the ICS service cannot be started, return an error.</span></span>
-   <span data-ttu-id="a677e-215">Appelez la fonction [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) pour forcer l’arrêt du réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-215">Call the [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) function to force a stop of the wireless Hosted Network.</span></span>
-   <span data-ttu-id="a677e-216">Appelez la fonction [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) pour démarrer le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-216">Call the [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) function to start the wireless Hosted Network.</span></span>
-   <span data-ttu-id="a677e-217">Si le réseau hébergé sans fil ne parvient pas à démarrer, retournez une erreur.</span><span class="sxs-lookup"><span data-stu-id="a677e-217">If the wireless Hosted Network fails to start, return an error.</span></span>
-   <span data-ttu-id="a677e-218">Si le partage de connexion Internet complet est déjà en cours d’exécution et que l’interface publique ou privée actuelle est différente de la nouvelle interface à utiliser, mettez en cache les interfaces publiques et privées actuelles.</span><span class="sxs-lookup"><span data-stu-id="a677e-218">If full ICS is already running and the current public or private interface is different from the new interface to be used, cache the current public and private interfaces.</span></span> <span data-ttu-id="a677e-219">Une application peut également choisir de retourner une erreur ou d’inviter l’utilisateur si l’intégration ICS est déjà en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="a677e-219">An application may also choose to return an error or prompt the user if ICS integration is already running.</span></span>
-   <span data-ttu-id="a677e-220">Démarrez le partage de connexion Internet complet avec les nouveaux paramètres pour les interfaces publiques et privées.</span><span class="sxs-lookup"><span data-stu-id="a677e-220">Start full ICS with the new settings for the public and private interfaces.</span></span>
-   <span data-ttu-id="a677e-221">Si le partage de connexion Internet complet ne parvient pas à démarrer avec ces paramètres, essayez de démarrer le service ICS complet avec les interfaces publiques et privées mises en cache si le partage de connexion Internet complet était en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="a677e-221">If full ICS fails to start with these settings, try to start full ICS service with the cached public and private interfaces if full ICS was running before.</span></span> <span data-ttu-id="a677e-222">Appelez la fonction [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) pour arrêter le réseau hébergé sans fil et retourner une erreur.</span><span class="sxs-lookup"><span data-stu-id="a677e-222">Call the [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) function to stop the wireless Hosted Network and return an error.</span></span>
-   <span data-ttu-id="a677e-223">Retourne la réussite du succès du réseau hébergé sans fil et du partage de connexion Internet complet.</span><span class="sxs-lookup"><span data-stu-id="a677e-223">Return success that the wireless Hosted Network and full ICS succeed.</span></span>

## <a name="stop-sequence-for-wireless-hosted-network"></a><span data-ttu-id="a677e-224">Arrêter la séquence pour le réseau hébergé sans fil</span><span class="sxs-lookup"><span data-stu-id="a677e-224">Stop Sequence for Wireless Hosted Network</span></span>

<span data-ttu-id="a677e-225">Lorsque vous utilisez un réseau hébergé sans fil avec un partage de connexion Internet complet, une application qui a terminé son travail peut arrêter le réseau hébergé sans fil et le service ICS utilisé pour le partage de connexion Internet complet.</span><span class="sxs-lookup"><span data-stu-id="a677e-225">When using wireless Hosted Network with full ICS, an application that has finished its work may want to stop the wireless Hosted Network and the ICS service used for full ICS.</span></span> <span data-ttu-id="a677e-226">Dans ce cas, il est recommandé d’appeler la fonction [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) pour arrêter le réseau hébergé au lieu d’appeler la fonction [**WlanHostedNetworkStopUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing) .</span><span class="sxs-lookup"><span data-stu-id="a677e-226">In this case, it is recommended that the [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) function be called to stop the Hosted Network rather than calling the [**WlanHostedNetworkStopUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing) function.</span></span> <span data-ttu-id="a677e-227">La fonction **WlanHostedNetworkForceStop** arrête le réseau hébergé sans fil et sert également à permettre à d’autres applications de récupérer.</span><span class="sxs-lookup"><span data-stu-id="a677e-227">The **WlanHostedNetworkForceStop** function stops the wireless Hosted Network and also serves to allow other applications to recover.</span></span> <span data-ttu-id="a677e-228">Pour plus d’informations, consultez la discussion ci-dessous sur la séquence de récupération pour un réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-228">For more information, see the discussion below on the recovery sequence for wireless Hosted Network.</span></span>

<span data-ttu-id="a677e-229">Les étapes ordonnées suivantes sont la séquence d’arrêt recommandée dans une application utilisant un réseau hébergé sans fil et le partage de connexion Internet complet :</span><span class="sxs-lookup"><span data-stu-id="a677e-229">The following ordered steps are the recommended stop sequence in an application using wireless Hosted Network and full ICS:</span></span>

-   <span data-ttu-id="a677e-230">Arrêtez le partage de connexion Internet complet.</span><span class="sxs-lookup"><span data-stu-id="a677e-230">Stop full ICS.</span></span>
-   <span data-ttu-id="a677e-231">Appelez la fonction [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) pour arrêter le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-231">Call the [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) function to stop the wireless Hosted Network.</span></span>

<span data-ttu-id="a677e-232">Une application qui utilise un réseau hébergé sans fil sans partage de connexion Internet complet avec son travail doit simplement appeler la fonction [**WlanHostedNetworkStopUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing) ou [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) pour arrêter le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-232">An application using wireless Hosted Network without full ICS that is finished with its work just needs to call the [**WlanHostedNetworkStopUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing) or [**WlanHostedNetworkForceStop**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestop) function to stop the wireless Hosted Network.</span></span> <span data-ttu-id="a677e-233">Si la fonction [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) a été appelée pour démarrer le réseau hébergé sans fil, l’application doit appeler la fonction **WlanHostedNetworkStopUsing** pour arrêter le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-233">If the [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) function was called to start the wireless Hosted Network, then the application should call the **WlanHostedNetworkStopUsing** function to stop the wireless Hosted Network.</span></span> <span data-ttu-id="a677e-234">Si le réseau hébergé sans fil a déjà été démarré avant que l’application ou l’application a appelé la fonction [**WlanHostedNetworkForceStart**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart) pour forcer le démarrage du réseau hébergé sans fil, l’application peut appeler la fonction **WlanHostedNetworkForceStop** pour arrêter le réseau hébergé sans fil ou ne rien faire (laissez le réseau hébergé sans fil démarré) en fonction du scénario.</span><span class="sxs-lookup"><span data-stu-id="a677e-234">If the wireless Hosted Network was was already started before the application or the application called the [**WlanHostedNetworkForceStart**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart) function to force start the wireless Hosted Network, then the application can call the **WlanHostedNetworkForceStop** function to stop the wireless Hosted Network or do nothing (leave wireless Hosted Network started) depending on the scenario.</span></span>

## <a name="recovery-sequence-for-wireless-hosted-network"></a><span data-ttu-id="a677e-235">Séquence de récupération pour un réseau hébergé sans fil</span><span class="sxs-lookup"><span data-stu-id="a677e-235">Recovery Sequence for Wireless Hosted Network</span></span>

<span data-ttu-id="a677e-236">Une application utilisant le réseau hébergé sans fil peut être affectée par les actions d’autres applications.</span><span class="sxs-lookup"><span data-stu-id="a677e-236">An application using the wireless Hosted Network may be affected by the actions of other applications.</span></span> <span data-ttu-id="a677e-237">Le service ICS et les interfaces de gestion du partage de connexion Internet ne fournissent aucune méthode permettant à une application de s’inscrire pour les notifications de modification ICS.</span><span class="sxs-lookup"><span data-stu-id="a677e-237">The ICS service and the interfaces for managing ICS provide no method for an application to register for ICS change notifications.</span></span> <span data-ttu-id="a677e-238">Si une autre application appelle les méthodes [**EnableSharing**](/windows/win32/api/netcon/nf-netcon-inetsharingconfiguration-enablesharing) ou [**DisableSharing**](/windows/win32/api/netcon/nf-netcon-inetsharingconfiguration-disablesharing) sur l’interface [**INetSharingConfiguration**](/windows/win32/api/netcon/nn-netcon-inetsharingconfiguration) pour activer ou désactiver le partage sur une connexion, un message est envoyé à l’interface utilisateur (l’écran) sur l’ordinateur local et non à d’autres applications.</span><span class="sxs-lookup"><span data-stu-id="a677e-238">If another application calls the [**EnableSharing**](/windows/win32/api/netcon/nf-netcon-inetsharingconfiguration-enablesharing) or the [**DisableSharing**](/windows/win32/api/netcon/nf-netcon-inetsharingconfiguration-disablesharing) methods on the [**INetSharingConfiguration**](/windows/win32/api/netcon/nn-netcon-inetsharingconfiguration) interface to enable or disable sharing on a connection, a message is sent to the user interface (the screen) on the local computer not to other applications.</span></span> <span data-ttu-id="a677e-239">Par conséquent, une application doit s’appuyer sur les notifications de réseau hébergé sans fil pour effectuer des actions de récupération lorsque des modifications de réseau sans fil ou d’ICS sont effectuées.</span><span class="sxs-lookup"><span data-stu-id="a677e-239">So an application needs to rely on the wireless Hosted Network notifications to perform recovery actions when ICS or wireless Hosted Network changes occur.</span></span>

<span data-ttu-id="a677e-240">Une application utilisant le réseau hébergé sans fil doit s’inscrire pour les notifications de réseau hébergé sans fil en appelant [**WlanRegisterNotification**](/windows/desktop/api/wlanapi/nf-wlanapi-wlanregisternotification).</span><span class="sxs-lookup"><span data-stu-id="a677e-240">An application using the wireless Hosted Network should register for wireless Hosted Network notifications by calling the [**WlanRegisterNotification**](/windows/desktop/api/wlanapi/nf-wlanapi-wlanregisternotification).</span></span> <span data-ttu-id="a677e-241">Si vous avez besoin de notifications uniquement pour un réseau hébergé sans fil, l’application doit transmettre la **\_ source de notification WLAN \_ \_ HNWK** dans le paramètre *dwNotifSource* passé à **WlanRegisterNotification**.</span><span class="sxs-lookup"><span data-stu-id="a677e-241">If notifications for only wireless Hosted Network are needed, then the application should pass **WLAN\_NOTIFICATION\_SOURCE\_HNWK** in the *dwNotifSource* parameter passed to the **WlanRegisterNotification**.</span></span> <span data-ttu-id="a677e-242">Si d’autres notifications sans fil sont également nécessaires, la **\_ source de notification WLAN \_ \_ HNWK** doit être associée aux constantes de la source de notification pour d’autres types de notifications sans fil souhaitées et transmettre cette valeur dans le paramètre *dwNotifSource* .</span><span class="sxs-lookup"><span data-stu-id="a677e-242">If other wireless notications are also needed, then **WLAN\_NOTIFICATION\_SOURCE\_HNWK** should be combined with the notification source constants for other types of wireless notifications desired and pass this value in the *dwNotifSource* parameter.</span></span>

<span data-ttu-id="a677e-243">La séquence de récupération est la même pour les applications avec ou sans partage de connexion Internet complet, en supposant que les applications ne souhaitent pas redémarrer le service ICS.</span><span class="sxs-lookup"><span data-stu-id="a677e-243">The recovery sequence is the same for applications with or without full ICS, assuming that applications don’t want to start ICS service again.</span></span> <span data-ttu-id="a677e-244">Lors de la réception d’une notification de réseau hébergé sans fil que le réseau hébergé a arrêté, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="a677e-244">Upon receiving a wireless Hosted Network notification that the Hosted Network has stopped, do the following:</span></span>

-   <span data-ttu-id="a677e-245">Si l’application appelée [**WlanHostedNetworkForceStart**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart) démarre le réseau hébergé sans fil, redémarrez le réseau hébergé en appelant **WlanHostedNetworkForceStart**.</span><span class="sxs-lookup"><span data-stu-id="a677e-245">If the application called [**WlanHostedNetworkForceStart**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart) to start the wireless Hosted Network, then restart the Hosted Network by calling **WlanHostedNetworkForceStart**.</span></span> <span data-ttu-id="a677e-246">Sinon, appelez [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) pour redémarrer le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-246">Otherwise, call [**WlanHostedNetworkStartUsing**](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing) to restart the wireless Hosted Network.</span></span>

## <a name="recovery-sequence-for-connected-devices"></a><span data-ttu-id="a677e-247">Séquence de récupération pour les appareils connectés</span><span class="sxs-lookup"><span data-stu-id="a677e-247">Recovery Sequence for Connected Devices</span></span>

<span data-ttu-id="a677e-248">Les appareils distants ou les ordinateurs connectés au réseau hébergé sans fil peuvent être affectés par les actions d’autres applications qui ont un impact sur le partage de connexion Internet et le réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-248">Remote devices or computers connected to the wireless Hosted Network may be affected by the actions of other applications that impact ICS and the wireless Hosted Network.</span></span> <span data-ttu-id="a677e-249">Heureusement, la plupart des appareils ont une logique de nouvelle tentative intégrée dans l’application de l’appareil pour traiter une perte temporaire de signal ou d’itinérance.</span><span class="sxs-lookup"><span data-stu-id="a677e-249">Fortunately, most devices have built in retry logic in the device application to deal with a temporary loss of signal or roaming.</span></span>

<span data-ttu-id="a677e-250">Une séquence de récupération possible pour les appareils ou les ordinateurs connectés au réseau sans fil hébergé qui perdent le contact est la suivante :</span><span class="sxs-lookup"><span data-stu-id="a677e-250">A possible recovery sequence for devices or computers connected to the wireless Hosted Network that lose contact is the following:</span></span>

-   <span data-ttu-id="a677e-251">Le pilote de périphérique sans fil indique qu’un support se déconnecte aux couches supérieures de la pile réseau sur l’appareil.</span><span class="sxs-lookup"><span data-stu-id="a677e-251">The wireless device driver indicates a media disconnect to the upper layers of the network stack on the device.</span></span>
-   <span data-ttu-id="a677e-252">L’application de l’appareil démarre des vérifications périodiques pour la disponibilité du réseau hébergé sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-252">The device application starts periodic checks for the availability of the wireless Hosted Network.</span></span>
-   <span data-ttu-id="a677e-253">Une fois que l’application de l’appareil détecte à nouveau le réseau hébergé sans fil, l’appareil établit une connexion sans fil.</span><span class="sxs-lookup"><span data-stu-id="a677e-253">Once the device application again detects the wireless Hosted Network, the device initiates a wireless connection.</span></span>
-   <span data-ttu-id="a677e-254">Une fois la connexion établie avec le réseau hébergé sans fil, l’application de l’appareil met à jour ses paramètres IP en conséquence.</span><span class="sxs-lookup"><span data-stu-id="a677e-254">Upon a successful connection with the wireless Hosted Network, the device application updates its IP settings accordingly.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a677e-255">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="a677e-255">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a677e-256">À propos du réseau hébergé sans fil</span><span class="sxs-lookup"><span data-stu-id="a677e-256">About the Wireless Hosted Network</span></span>](about-the-wireless-hosted-network.md)
</dt> <dt>

[<span data-ttu-id="a677e-257">Exemple de réseau hébergé sans fil</span><span class="sxs-lookup"><span data-stu-id="a677e-257">Wireless Hosted Network Sample</span></span>](wireless-hosted-network-sample.md)
</dt> <dt>

[<span data-ttu-id="a677e-258">**WlanHostedNetworkForceStart**</span><span class="sxs-lookup"><span data-stu-id="a677e-258">**WlanHostedNetworkForceStart**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkforcestart)
</dt> <dt>

[<span data-ttu-id="a677e-259">**WlanHostedNetworkInitSettings**</span><span class="sxs-lookup"><span data-stu-id="a677e-259">**WlanHostedNetworkInitSettings**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkinitsettings)
</dt> <dt>

[<span data-ttu-id="a677e-260">**WlanHostedNetworkQueryProperty**</span><span class="sxs-lookup"><span data-stu-id="a677e-260">**WlanHostedNetworkQueryProperty**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkqueryproperty)
</dt> <dt>

[<span data-ttu-id="a677e-261">**WlanHostedNetworkQuerySecondaryKey**</span><span class="sxs-lookup"><span data-stu-id="a677e-261">**WlanHostedNetworkQuerySecondaryKey**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkquerysecondarykey)
</dt> <dt>

[<span data-ttu-id="a677e-262">**WlanHostedNetworkQueryStatus**</span><span class="sxs-lookup"><span data-stu-id="a677e-262">**WlanHostedNetworkQueryStatus**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkquerystatus)
</dt> <dt>

[<span data-ttu-id="a677e-263">**WlanHostedNetworkRefreshSecuritySettings**</span><span class="sxs-lookup"><span data-stu-id="a677e-263">**WlanHostedNetworkRefreshSecuritySettings**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkrefreshsecuritysettings)
</dt> <dt>

[<span data-ttu-id="a677e-264">**WlanHostedNetworkSetProperty**</span><span class="sxs-lookup"><span data-stu-id="a677e-264">**WlanHostedNetworkSetProperty**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworksetproperty)
</dt> <dt>

[<span data-ttu-id="a677e-265">**WlanHostedNetworkSetSecondaryKey**</span><span class="sxs-lookup"><span data-stu-id="a677e-265">**WlanHostedNetworkSetSecondaryKey**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworksetsecondarykey)
</dt> <dt>

[<span data-ttu-id="a677e-266">**WlanHostedNetworkStartUsing**</span><span class="sxs-lookup"><span data-stu-id="a677e-266">**WlanHostedNetworkStartUsing**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstartusing)
</dt> <dt>

[<span data-ttu-id="a677e-267">**WlanHostedNetworkStopUsing**</span><span class="sxs-lookup"><span data-stu-id="a677e-267">**WlanHostedNetworkStopUsing**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanhostednetworkstopusing)
</dt> <dt>

[<span data-ttu-id="a677e-268">**WlanRegisterVirtualStationNotification**</span><span class="sxs-lookup"><span data-stu-id="a677e-268">**WlanRegisterVirtualStationNotification**</span></span>](/windows/desktop/api/Wlanapi/nf-wlanapi-wlanregistervirtualstationnotification)
</dt> </dl>

 

 
