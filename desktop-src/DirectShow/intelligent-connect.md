---
description: Connexion intelligente
ms.assetid: 938ba1b0-822e-4871-8786-b7eeee243867
title: Connexion intelligente
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 12aead305867ccec1f1f1f0cbd76c652ba3ec412
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104482304"
---
# <a name="intelligent-connect"></a><span data-ttu-id="35d94-103">Connexion intelligente</span><span class="sxs-lookup"><span data-stu-id="35d94-103">Intelligent Connect</span></span>

<span data-ttu-id="35d94-104">Intelligent Connect est le mécanisme utilisé par le gestionnaire de graphique de filtre pour créer des graphiques de filtres.</span><span class="sxs-lookup"><span data-stu-id="35d94-104">Intelligent Connect is the mechanism the Filter Graph Manager uses to build filter graphs.</span></span> <span data-ttu-id="35d94-105">Il se compose de plusieurs algorithmes associés qui sélectionnent des filtres et les ajoutent au graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="35d94-105">It consists of several related algorithms that select filters and add them to the filter graph.</span></span>

<span data-ttu-id="35d94-106">Lisez cette rubrique si vous avez des difficultés à créer un graphique de filtre et que vous souhaitez résoudre le problème, ou si vous écrivez votre propre filtre et que vous souhaitez le rendre disponible pour la génération automatique de graphiques.</span><span class="sxs-lookup"><span data-stu-id="35d94-106">Read this topic if you are having trouble building a certain filter graph and want to troubleshoot the problem, or if you are writing your own filter and want to make it available for automatic graph building.</span></span>

<span data-ttu-id="35d94-107">La connexion intelligente implique les méthodes [**IGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) suivantes :</span><span class="sxs-lookup"><span data-stu-id="35d94-107">Intelligent Connect involves the following [**IGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) methods:</span></span>

-   [<span data-ttu-id="35d94-108">**IGraphBuilder::AddSourceFilter**</span><span class="sxs-lookup"><span data-stu-id="35d94-108">**IGraphBuilder::AddSourceFilter**</span></span>](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-addsourcefilter)
-   [<span data-ttu-id="35d94-109">**IGraphBuilder :: Render**</span><span class="sxs-lookup"><span data-stu-id="35d94-109">**IGraphBuilder::Render**</span></span>](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render)
-   [<span data-ttu-id="35d94-110">**IGraphBuilder :: RenderFile**</span><span class="sxs-lookup"><span data-stu-id="35d94-110">**IGraphBuilder::RenderFile**</span></span>](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile)
-   [<span data-ttu-id="35d94-111">**IGraphBuilder :: Connect**</span><span class="sxs-lookup"><span data-stu-id="35d94-111">**IGraphBuilder::Connect**</span></span>](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect)

### <a name="igraphbuilderaddsourcefilter"></a><span data-ttu-id="35d94-112">IGraphBuilder::AddSourceFilter</span><span class="sxs-lookup"><span data-stu-id="35d94-112">IGraphBuilder::AddSourceFilter</span></span>

<span data-ttu-id="35d94-113">La méthode [**IGraphBuilder :: AddSourceFilter**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-addsourcefilter) ajoute un filtre source qui peut restituer un fichier spécifié.</span><span class="sxs-lookup"><span data-stu-id="35d94-113">The [**IGraphBuilder::AddSourceFilter**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-addsourcefilter) method adds a source filter that can render a specified file.</span></span> <span data-ttu-id="35d94-114">Tout d’abord, il consulte le registre et les correspondances avec le protocole (par exemple `https://` ,), l’extension de nom de fichier ou un ensemble d' *octets de vérification* prédéterminés, qui sont des octets à des décalages particuliers dans le fichier qui correspondent à certains modèles.</span><span class="sxs-lookup"><span data-stu-id="35d94-114">First it looks in the registry and matches against the protocol (such as `https://`), the file name extension, or a set of predetermined *check bytes*, which are bytes at particular offsets in the file that match certain patterns.</span></span> <span data-ttu-id="35d94-115">Pour plus d’informations, consultez [inscription d’un type de fichier personnalisé](registering-a-custom-file-type.md).</span><span class="sxs-lookup"><span data-stu-id="35d94-115">For details, see [Registering a Custom File Type](registering-a-custom-file-type.md).</span></span> <span data-ttu-id="35d94-116">En supposant que la méthode localise un filtre source approprié, elle crée ensuite une instance de ce filtre, l’ajoute au graphique et appelle la méthode [**IFileSourceFilter :: Load**](/windows/desktop/api/Strmif/nf-strmif-ifilesourcefilter-load) du filtre avec le nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="35d94-116">Assuming that the method locates an appropriate source filter, it then creates an instance of that filter, adds it to the graph, and calls the filter's [**IFileSourceFilter::Load**](/windows/desktop/api/Strmif/nf-strmif-ifilesourcefilter-load) method with the file name.</span></span>

### <a name="igraphbuilderrender"></a><span data-ttu-id="35d94-117">IGraphBuilder :: Render</span><span class="sxs-lookup"><span data-stu-id="35d94-117">IGraphBuilder::Render</span></span>

<span data-ttu-id="35d94-118">La méthode [**IGraphBuilder :: Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) génère une sous-section d’un graphique.</span><span class="sxs-lookup"><span data-stu-id="35d94-118">The [**IGraphBuilder::Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) method builds a subsection of a graph.</span></span> <span data-ttu-id="35d94-119">Il démarre à partir d’une broche de sortie non connectée et fonctionne en aval, en ajoutant de nouveaux filtres en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="35d94-119">It starts from an unconnected output pin and works downstream, adding new filters as needed.</span></span> <span data-ttu-id="35d94-120">Le filtre de départ doit déjà figurer dans le graphique.</span><span class="sxs-lookup"><span data-stu-id="35d94-120">The starting filter must already be in the graph.</span></span> <span data-ttu-id="35d94-121">À chaque étape, la méthode **Render** recherche un filtre qui peut se connecter au filtre précédent.</span><span class="sxs-lookup"><span data-stu-id="35d94-121">At each step, the **Render** method searches for a filter that can connect to the previous filter.</span></span> <span data-ttu-id="35d94-122">Le flux peut créer une branche si un filtre de connexion a plusieurs broches de sortie.</span><span class="sxs-lookup"><span data-stu-id="35d94-122">The stream can branch if a connecting filter has multiple output pins.</span></span> <span data-ttu-id="35d94-123">La recherche s’arrête lorsque chaque flux a un convertisseur.</span><span class="sxs-lookup"><span data-stu-id="35d94-123">The search stops when every stream has a renderer.</span></span> <span data-ttu-id="35d94-124">Si la méthode **Render** est bloquée, elle peut être sauvegardée et réessayer, à l’aide d’un autre jeu de filtres.</span><span class="sxs-lookup"><span data-stu-id="35d94-124">If the **Render** method gets stuck, it might back up and try again, using a different set of filters.</span></span>

<span data-ttu-id="35d94-125">Pour connecter chaque broche de sortie, la méthode [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) effectue les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="35d94-125">To connect each output pin, the [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) method does the following:</span></span>

1.  <span data-ttu-id="35d94-126">Si le code PIN prend en charge l’interface [**IStreamBuilder**](/windows/desktop/api/Strmif/nn-strmif-istreambuilder) , le gestionnaire de graphique de filtre délègue l’ensemble du processus à la méthode [**IStreamBuilder :: Render**](/windows/desktop/api/Strmif/nf-strmif-istreambuilder-render) du pin.</span><span class="sxs-lookup"><span data-stu-id="35d94-126">If the pin supports the [**IStreamBuilder**](/windows/desktop/api/Strmif/nn-strmif-istreambuilder) interface, the Filter Graph Manager delegates the entire process to the pin's [**IStreamBuilder::Render**](/windows/desktop/api/Strmif/nf-strmif-istreambuilder-render) method.</span></span> <span data-ttu-id="35d94-127">En exposant cette interface, le code PIN assume la responsabilité de la création du reste du graphique, vers le convertisseur.</span><span class="sxs-lookup"><span data-stu-id="35d94-127">By exposing this interface, the pin assumes responsibility for building the remainder of the graph, down to the renderer.</span></span> <span data-ttu-id="35d94-128">Toutefois, très peu de pin prennent en charge cette interface.</span><span class="sxs-lookup"><span data-stu-id="35d94-128">However, very few pins support this interface.</span></span>
2.  <span data-ttu-id="35d94-129">Le gestionnaire de graphes de filtre tente d’utiliser les filtres qui sont mis en cache dans la mémoire, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="35d94-129">The Filter Graph Manager tries to use filters that are cached in memory, if any.</span></span> <span data-ttu-id="35d94-130">Tout au long du processus de connexion intelligent, le gestionnaire de graphes de filtre peut mettre en cache les filtres des étapes précédentes du processus.</span><span class="sxs-lookup"><span data-stu-id="35d94-130">Throughout the Intelligent Connect process, the Filter Graph Manager may cache filters from earlier steps in the process.</span></span> <span data-ttu-id="35d94-131">(Consultez également [génération de graphiques dynamiques](dynamic-graph-building.md).)</span><span class="sxs-lookup"><span data-stu-id="35d94-131">(Also, see [Dynamic Graph Building](dynamic-graph-building.md).)</span></span>
3.  <span data-ttu-id="35d94-132">Si le graphique de filtre contient des filtres avec des broches d’entrée non connectées, le gestionnaire de graphes de filtre les essaie ensuite.</span><span class="sxs-lookup"><span data-stu-id="35d94-132">If the filter graph contains any filters with unconnected input pins, the Filter Graph Manager tries them next.</span></span> <span data-ttu-id="35d94-133">Vous pouvez forcer la méthode [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) à essayer un filtre particulier en ajoutant ce filtre au graphique avant d’appeler **Render**.</span><span class="sxs-lookup"><span data-stu-id="35d94-133">You can force the [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) method to try a particular filter by adding that filter to the graph before calling **Render**.</span></span>
4.  <span data-ttu-id="35d94-134">À compter de Windows 7, DirectShow dispose d’une liste de filtres préférés pour certains sous-types de médias.</span><span class="sxs-lookup"><span data-stu-id="35d94-134">Starting in Windows 7, DirectShow has a list of preferred filters for certain media subtypes.</span></span> <span data-ttu-id="35d94-135">S’il existe un filtre par défaut pour le type de média qui est affiché, le gestionnaire de graphes de filtre tente de le filtrer à la suite.</span><span class="sxs-lookup"><span data-stu-id="35d94-135">If there is a preferred filter for the media type that is being rendered, the Filter Graph Manager tries that filter next.</span></span> <span data-ttu-id="35d94-136">Une application peut modifier la liste des filtres préférés à l’aide de l’interface [**IAMPluginControl**](/windows/desktop/api/Strmif/nn-strmif-iamplugincontrol) .</span><span class="sxs-lookup"><span data-stu-id="35d94-136">An application can modify the list of preferred filters by using the [**IAMPluginControl**](/windows/desktop/api/Strmif/nn-strmif-iamplugincontrol) interface.</span></span> <span data-ttu-id="35d94-137">Les modifications apportées à la liste affectent le processus actuel de l’application et sont ignorées une fois le processus terminé.</span><span class="sxs-lookup"><span data-stu-id="35d94-137">Changes to the list affect the application's current process, and are discarded after the process ends.</span></span>
5.  <span data-ttu-id="35d94-138">Enfin, si aucun filtre approprié n’a été trouvé, le gestionnaire de graphes de filtre recherche le registre à l’aide de la méthode [**IFilterMapper2 :: EnumMatchingFilters**](/windows/desktop/api/Strmif/nf-strmif-ifiltermapper2-enummatchingfilters) .</span><span class="sxs-lookup"><span data-stu-id="35d94-138">Finally, if no suitable filter has been found, the Filter Graph Manager searches the registry, using the [**IFilterMapper2::EnumMatchingFilters**](/windows/desktop/api/Strmif/nf-strmif-ifiltermapper2-enummatchingfilters) method.</span></span> <span data-ttu-id="35d94-139">Il tente de faire correspondre les types de média préférés du pin de sortie par rapport aux types de média indiqués dans le registre.</span><span class="sxs-lookup"><span data-stu-id="35d94-139">It tries to match the output pin's preferred media types against media types listed in the registry.</span></span>

    <span data-ttu-id="35d94-140">Chaque filtre est inscrit avec un *mérite*, une valeur numérique qui indique le degré de préférence du filtre par rapport à d’autres filtres.</span><span class="sxs-lookup"><span data-stu-id="35d94-140">Each filter is registered with a *merit*, a numerical value that indicates how preferable the filter is, relative to other filters.</span></span> <span data-ttu-id="35d94-141">La méthode [**EnumMatchingFilters**](/windows/desktop/api/Strmif/nf-strmif-ifiltermapper2-enummatchingfilters) retourne des filtres par ordre de mérite, avec un mérite minimal de **mérite \_ n' \_ \_ utilise pas** + 1.</span><span class="sxs-lookup"><span data-stu-id="35d94-141">The [**EnumMatchingFilters**](/windows/desktop/api/Strmif/nf-strmif-ifiltermapper2-enummatchingfilters) method returns filters in order of merit, with a minimum merit of **MERIT\_DO\_NOT\_USE** + 1.</span></span> <span data-ttu-id="35d94-142">Il ignore les filtres avec un mérite **de \_ mérite \_ n' \_ utilise pas** ou moins.</span><span class="sxs-lookup"><span data-stu-id="35d94-142">It ignores filters with a merit of **MERIT\_DO\_NOT\_USE** or less.</span></span> <span data-ttu-id="35d94-143">Les filtres sont également regroupés en catégories, définies par GUID.</span><span class="sxs-lookup"><span data-stu-id="35d94-143">Filters are also grouped into categories, defined by GUID.</span></span> <span data-ttu-id="35d94-144">Les catégories elles-mêmes ont un mérite, et la méthode **EnumMatchingFilters** ignore toute catégorie avec un mérite de **mérite \_ n' \_ \_ utilise pas** ou moins, même si les filtres de cette catégorie ont des valeurs de mérite plus élevées.</span><span class="sxs-lookup"><span data-stu-id="35d94-144">Categories themselves have merit, and the **EnumMatchingFilters** method ignores any category with a merit of **MERIT\_DO\_NOT\_USE** or less, even if the filters in that category have higher merit values.</span></span>

    <span data-ttu-id="35d94-145">À compter de Windows 7, DirectShow dispose d’une liste de filtres bloqués pour certains sous-types de médias.</span><span class="sxs-lookup"><span data-stu-id="35d94-145">Starting in Windows 7, DirectShow has a list of blocked filters for certain media subtypes.</span></span> <span data-ttu-id="35d94-146">Le gestionnaire de graphes de filtres ignore les filtres de cette liste.</span><span class="sxs-lookup"><span data-stu-id="35d94-146">The Filter Graph Manager skips filters on this list.</span></span> <span data-ttu-id="35d94-147">Une application peut modifier la liste des filtres bloqués à l’aide de l’interface [**IAMPluginControl**](/windows/desktop/api/Strmif/nn-strmif-iamplugincontrol) .</span><span class="sxs-lookup"><span data-stu-id="35d94-147">An application can modify the list of blocked filters by using the [**IAMPluginControl**](/windows/desktop/api/Strmif/nn-strmif-iamplugincontrol) interface.</span></span> <span data-ttu-id="35d94-148">Les modifications apportées à cette liste affectent le processus en cours de l’application et sont ignorées une fois le processus terminé.</span><span class="sxs-lookup"><span data-stu-id="35d94-148">Changes to this list affect the application's current process, and are discarded after the process ends.</span></span>

<span data-ttu-id="35d94-149">Pour résumer, la méthode [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) tente des filtres dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="35d94-149">To summarize, the [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) method tries filters in the following order:</span></span>

1.  <span data-ttu-id="35d94-150">Utilisez [**IStreamBuilder**](/windows/desktop/api/Strmif/nn-strmif-istreambuilder).</span><span class="sxs-lookup"><span data-stu-id="35d94-150">Use [**IStreamBuilder**](/windows/desktop/api/Strmif/nn-strmif-istreambuilder).</span></span>
2.  <span data-ttu-id="35d94-151">Essayez les filtres mis en cache.</span><span class="sxs-lookup"><span data-stu-id="35d94-151">Try cached filters.</span></span>
3.  <span data-ttu-id="35d94-152">Essayez des filtres dans le graphique.</span><span class="sxs-lookup"><span data-stu-id="35d94-152">Try filters in the graph.</span></span>
4.  <span data-ttu-id="35d94-153">Windows 7 ou version ultérieure : essayez le filtre par défaut pour le type de média, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="35d94-153">Windows 7 or later: Try the preferred filter for the media type, if any.</span></span>
5.  <span data-ttu-id="35d94-154">Recherchez des filtres dans le registre.</span><span class="sxs-lookup"><span data-stu-id="35d94-154">Look up filters in the registry.</span></span>

### <a name="igraphbuilderrenderfile"></a><span data-ttu-id="35d94-155">IGraphBuilder :: RenderFile</span><span class="sxs-lookup"><span data-stu-id="35d94-155">IGraphBuilder::RenderFile</span></span>

<span data-ttu-id="35d94-156">La méthode [**IGraphBuilder :: RenderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile) crée un graphique de lecture par défaut à partir d’un nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="35d94-156">The [**IGraphBuilder::RenderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile) method builds a default playback graph from a file name.</span></span> <span data-ttu-id="35d94-157">En interne, cette méthode utilise [**AddSourceFilter**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-addsourcefilter) pour localiser le filtre source correct, et [**restituer**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) pour générer le reste du graphique.</span><span class="sxs-lookup"><span data-stu-id="35d94-157">Internally, this method uses [**AddSourceFilter**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-addsourcefilter) to locate the correct source filter, and [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) to build the rest of the graph.</span></span>

### <a name="igraphbuilderconnect"></a><span data-ttu-id="35d94-158">IGraphBuilder :: Connect</span><span class="sxs-lookup"><span data-stu-id="35d94-158">IGraphBuilder::Connect</span></span>

<span data-ttu-id="35d94-159">La méthode [**IGraphBuilder :: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) connecte une broche de sortie à une broche d’entrée.</span><span class="sxs-lookup"><span data-stu-id="35d94-159">The [**IGraphBuilder::Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) method connects an output pin to an input pin.</span></span> <span data-ttu-id="35d94-160">Cette méthode ajoute des filtres intermédiaires, si nécessaire, à l’aide d’une variation de l’algorithme décrit pour la méthode [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) :</span><span class="sxs-lookup"><span data-stu-id="35d94-160">This method adds intermediate filters if needed, using a variation of the algorithm described for the [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) method:</span></span>

1.  <span data-ttu-id="35d94-161">Essayez une connexion directe entre les filtres, sans filtres intermédiaires.</span><span class="sxs-lookup"><span data-stu-id="35d94-161">Try a direct connection between the filters, with no intermediate filters.</span></span>
2.  <span data-ttu-id="35d94-162">Essayez les filtres mis en cache.</span><span class="sxs-lookup"><span data-stu-id="35d94-162">Try cached filters.</span></span>
3.  <span data-ttu-id="35d94-163">Essayez des filtres dans le graphique.</span><span class="sxs-lookup"><span data-stu-id="35d94-163">Try filters in the graph.</span></span>
4.  <span data-ttu-id="35d94-164">Windows 7 ou version ultérieure : essayez le filtre par défaut pour le type de média, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="35d94-164">Windows 7 or later: Try the preferred filter for the media type, if any.</span></span>
5.  <span data-ttu-id="35d94-165">Recherchez des filtres dans le registre.</span><span class="sxs-lookup"><span data-stu-id="35d94-165">Look up filters in the registry.</span></span>

## <a name="related-topics"></a><span data-ttu-id="35d94-166">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="35d94-166">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="35d94-167">Filtrer les catégories</span><span class="sxs-lookup"><span data-stu-id="35d94-167">Filter Categories</span></span>](filter-categories.md)
</dt> <dt>

[<span data-ttu-id="35d94-168">Mérite</span><span class="sxs-lookup"><span data-stu-id="35d94-168">Merit</span></span>](merit.md)
</dt> <dt>

[<span data-ttu-id="35d94-169">Simulation de la génération de graphiques avec GraphEdit</span><span class="sxs-lookup"><span data-stu-id="35d94-169">Simulating Graph Building with GraphEdit</span></span>](simulating-graph-building-with-graphedit.md)
</dt> <dt>

[<span data-ttu-id="35d94-170">Génération du graphique de filtre</span><span class="sxs-lookup"><span data-stu-id="35d94-170">Building the Filter Graph</span></span>](building-the-filter-graph.md)
</dt> </dl>

 

 



