---
description: Introduction à la programmation d’applications DirectShow
ms.assetid: 21a72efa-95df-4754-8304-ad56965a914d
title: Introduction à la programmation d’applications DirectShow
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f6218a346a7eb9711259c025aef09133ef2e58f6
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104392556"
---
# <a name="introduction-to-directshow-application-programming"></a><span data-ttu-id="465e7-103">Introduction à la programmation d’applications DirectShow</span><span class="sxs-lookup"><span data-stu-id="465e7-103">Introduction to DirectShow Application Programming</span></span>

<span data-ttu-id="465e7-104">Cet article présente la terminologie et les concepts de base utilisés dans DirectShow.</span><span class="sxs-lookup"><span data-stu-id="465e7-104">This article introduces the basic terminology and concepts that are used in DirectShow.</span></span> <span data-ttu-id="465e7-105">Après avoir lu cette section, vous serez prêt à écrire votre première application DirectShow.</span><span class="sxs-lookup"><span data-stu-id="465e7-105">After reading this section, you will be ready to write your first DirectShow application.</span></span>

<span data-ttu-id="465e7-106">**Filtres et graphiques de filtre**</span><span class="sxs-lookup"><span data-stu-id="465e7-106">**Filters and Filter Graphs**</span></span>

<span data-ttu-id="465e7-107">Le bloc de construction de DirectShow est un composant logiciel appelé « *filtre*».</span><span class="sxs-lookup"><span data-stu-id="465e7-107">The building block of DirectShow is a software component called a *filter*.</span></span> <span data-ttu-id="465e7-108">Un filtre est un composant logiciel qui effectue une opération sur un flux multimédia.</span><span class="sxs-lookup"><span data-stu-id="465e7-108">A filter is a software component that performs some operation on a multimedia stream.</span></span> <span data-ttu-id="465e7-109">Par exemple, les filtres DirectShow peuvent</span><span class="sxs-lookup"><span data-stu-id="465e7-109">For example, DirectShow filters can</span></span>

-   <span data-ttu-id="465e7-110">lire les fichiers</span><span class="sxs-lookup"><span data-stu-id="465e7-110">read files</span></span>
-   <span data-ttu-id="465e7-111">obtenir de la vidéo à partir d’un appareil de capture vidéo</span><span class="sxs-lookup"><span data-stu-id="465e7-111">get video from a video capture device</span></span>
-   <span data-ttu-id="465e7-112">décoder divers formats de flux, tels que MPEG-1 Video</span><span class="sxs-lookup"><span data-stu-id="465e7-112">decode various stream formats, such as MPEG-1 video</span></span>
-   <span data-ttu-id="465e7-113">transmettre des données à la carte graphique ou audio</span><span class="sxs-lookup"><span data-stu-id="465e7-113">pass data to the graphics or sound card</span></span>

<span data-ttu-id="465e7-114">Les filtres reçoivent une entrée et produisent une sortie.</span><span class="sxs-lookup"><span data-stu-id="465e7-114">Filters receive input and produce output.</span></span> <span data-ttu-id="465e7-115">Par exemple, si un filtre décode une vidéo MPEG-1, l’entrée est le flux codé en MPEG et la sortie est une série de trames vidéo non compressées.</span><span class="sxs-lookup"><span data-stu-id="465e7-115">For example, if a filter decodes MPEG-1 video, the input is the MPEG-encoded stream and the output is a series of uncompressed video frames.</span></span>

<span data-ttu-id="465e7-116">Dans DirectShow, une application effectue une tâche en connectant des chaînes de filtres ensemble, de sorte que la sortie d’un filtre devient l’entrée d’une autre.</span><span class="sxs-lookup"><span data-stu-id="465e7-116">In DirectShow, an application performs any task by connecting chains of filters together, so that the output from one filter becomes the input for another.</span></span> <span data-ttu-id="465e7-117">Un ensemble de filtres connectés est appelé un *graphique de filtre*.</span><span class="sxs-lookup"><span data-stu-id="465e7-117">A set of connected filters is called a *filter graph*.</span></span> <span data-ttu-id="465e7-118">Par exemple, le diagramme suivant montre un graphique de filtre pour la diffusion d’un fichier AVI.</span><span class="sxs-lookup"><span data-stu-id="465e7-118">For example, the following diagram shows a filter graph for playing an AVI file.</span></span>

![filtrer le graphique pour lire un fichier AVI](images/avi-filter-graph.png)

<span data-ttu-id="465e7-120">Le filtre de source de fichier lit le fichier AVI à partir du disque dur.</span><span class="sxs-lookup"><span data-stu-id="465e7-120">The File Source filter reads the AVI file from the hard disk.</span></span> <span data-ttu-id="465e7-121">Le filtre de séparateur AVI analyse le fichier en deux flux, un flux vidéo compressé et un flux audio.</span><span class="sxs-lookup"><span data-stu-id="465e7-121">The AVI Splitter filter parses the file into two streams, a compressed video stream and an audio stream.</span></span> <span data-ttu-id="465e7-122">Le filtre de décompresseur AVI décode les images vidéo.</span><span class="sxs-lookup"><span data-stu-id="465e7-122">The AVI Decompressor filter decodes the video frames.</span></span> <span data-ttu-id="465e7-123">Le filtre de convertisseur vidéo dessine les frames à l’écran à l’aide de DirectDraw ou GDI.</span><span class="sxs-lookup"><span data-stu-id="465e7-123">The Video Renderer filter draws the frames to the display, using DirectDraw or GDI.</span></span> <span data-ttu-id="465e7-124">Le filtre de périphérique DirectSound par défaut lit le flux audio, à l’aide de DirectSound.</span><span class="sxs-lookup"><span data-stu-id="465e7-124">The Default DirectSound Device filter plays the audio stream, using DirectSound.</span></span>

<span data-ttu-id="465e7-125">L’application n’a pas à gérer l’ensemble de ce Workflow.</span><span class="sxs-lookup"><span data-stu-id="465e7-125">The application does not have to manage all of this data flow.</span></span> <span data-ttu-id="465e7-126">Au lieu de cela, les filtres sont contrôlés par un composant de niveau supérieur appelé gestionnaire de graphes de filtres.</span><span class="sxs-lookup"><span data-stu-id="465e7-126">Instead, the filters are controlled by a high-level component called the Filter Graph Manager.</span></span> <span data-ttu-id="465e7-127">L’application effectue des appels d’API de haut niveau tels que « exécuter » (pour déplacer des données par le biais du graphique) ou « arrêter » (pour arrêter le workflow de données).</span><span class="sxs-lookup"><span data-stu-id="465e7-127">The application makes high-level API calls such as "Run" (to move data through the graph) or "Stop" (to stop the flow of data).</span></span> <span data-ttu-id="465e7-128">Si vous avez besoin de davantage de contrôle sur les opérations de flux, vous pouvez accéder aux filtres directement par le biais des interfaces COM.</span><span class="sxs-lookup"><span data-stu-id="465e7-128">If you require more control over the stream operations, you can access the filters directly through COM interfaces.</span></span> <span data-ttu-id="465e7-129">Le gestionnaire de graphes de filtre transmet également les notifications d’événements à l’application.</span><span class="sxs-lookup"><span data-stu-id="465e7-129">The Filter Graph Manager also passes event notifications to the application.</span></span>

<span data-ttu-id="465e7-130">Le gestionnaire de graphes de filtre a également une autre fonction : il fournit des méthodes permettant à l’application de générer le graphique de filtre, en connectant les filtres ensemble.</span><span class="sxs-lookup"><span data-stu-id="465e7-130">The Filter Graph Manager serves another purpose as well: It provides methods for the application to build the filter graph, by connecting the filters together.</span></span> <span data-ttu-id="465e7-131">(DirectShow fournit également divers objets d’assistance qui simplifient ce processus.</span><span class="sxs-lookup"><span data-stu-id="465e7-131">(DirectShow also provides various helper objects that simplify this process.</span></span> <span data-ttu-id="465e7-132">Celles-ci sont décrites en détail dans la documentation.)</span><span class="sxs-lookup"><span data-stu-id="465e7-132">These are thoroughly described in the documentation.)</span></span>

<span data-ttu-id="465e7-133">**Écriture d’une application DirectShow**</span><span class="sxs-lookup"><span data-stu-id="465e7-133">**Writing a DirectShow Application**</span></span>

<span data-ttu-id="465e7-134">En général, il existe trois tâches que toute application DirectShow doit effectuer.</span><span class="sxs-lookup"><span data-stu-id="465e7-134">In broad terms, there are three tasks that any DirectShow application must perform.</span></span> <span data-ttu-id="465e7-135">Ceux-ci sont illustrés dans le diagramme suivant.</span><span class="sxs-lookup"><span data-stu-id="465e7-135">These are illustrated in the following diagram.</span></span>

![application DirectShow classique](images/fgm.png)

1.  <span data-ttu-id="465e7-137">L’application crée une instance du gestionnaire de graphes de filtre.</span><span class="sxs-lookup"><span data-stu-id="465e7-137">The application creates an instance of the Filter Graph Manager.</span></span>
2.  <span data-ttu-id="465e7-138">L’application utilise le gestionnaire de graphe de filtre pour générer un graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="465e7-138">The application uses the Filter Graph Manager to build a filter graph.</span></span> <span data-ttu-id="465e7-139">L’ensemble exact de filtres dans le graphique dépend de l’application.</span><span class="sxs-lookup"><span data-stu-id="465e7-139">The exact set of filters in the graph will depend on the application.</span></span>
3.  <span data-ttu-id="465e7-140">L’application utilise le gestionnaire de graphe de filtre pour contrôler le graphique de filtre et diffuser les données en continu via les filtres.</span><span class="sxs-lookup"><span data-stu-id="465e7-140">The application uses the Filter Graph Manager to control the filter graph and stream data through the filters.</span></span> <span data-ttu-id="465e7-141">Tout au long de ce processus, l’application répond également aux événements du gestionnaire de graphes de filtre.</span><span class="sxs-lookup"><span data-stu-id="465e7-141">Throughout this process, the application will also respond to events from the Filter Graph Manager.</span></span>

<span data-ttu-id="465e7-142">Une fois le traitement terminé, l’application libère le gestionnaire de graphique de filtre et tous les filtres.</span><span class="sxs-lookup"><span data-stu-id="465e7-142">When processing is completed, the application releases the Filter Graph Manager and all of the filters.</span></span>

<span data-ttu-id="465e7-143">DirectShow est basé sur COM ; le gestionnaire de graphique de filtre et les filtres sont tous des objets COM.</span><span class="sxs-lookup"><span data-stu-id="465e7-143">DirectShow is based on COM; the Filter Graph Manager and the filters are all COM objects.</span></span> <span data-ttu-id="465e7-144">Vous devez avoir une compréhension générale de la programmation du client COM avant de commencer à programmer DirectShow.</span><span class="sxs-lookup"><span data-stu-id="465e7-144">You should have a general understanding of COM client programming before you begin programming DirectShow.</span></span> <span data-ttu-id="465e7-145">De nombreux ouvrages sur la programmation COM sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="465e7-145">Many books about COM programming are available.</span></span>

<span data-ttu-id="465e7-146">Pour commencer à utiliser DirectShow, lisez l’article [Comment lire un fichier](how-to-play-a-file.md), qui présente une application console simple pour lire un fichier vidéo.</span><span class="sxs-lookup"><span data-stu-id="465e7-146">To get started with DirectShow, read the article [How To Play a File](how-to-play-a-file.md), which presents a simple console application to play a video file.</span></span> <span data-ttu-id="465e7-147">La section [relative à DirectShow](about-directshow.md) explique plus en détail l’architecture DirectShow, tandis que la section [utilisation de DirectShow](using-directshow.md) examine les principaux scénarios pris en charge par DirectShow, tels que la capture, la modification vidéo, la lecture de DVD et la télévision.</span><span class="sxs-lookup"><span data-stu-id="465e7-147">The section [About DirectShow](about-directshow.md) explains the DirectShow architecture in more detail, while the section [Using DirectShow](using-directshow.md) examines the major scenarios that are supported by DirectShow, such as capture, video editing, DVD playback, and television.</span></span>

 

 



