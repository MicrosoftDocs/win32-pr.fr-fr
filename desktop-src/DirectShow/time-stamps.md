---
description: Horodatages
ms.assetid: 445fe6b9-9d5b-45fd-9c9e-8c632c5228ae
title: Horodatages
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 855d2c472d7964ccad6ec8bbc87efd39b1c4cdd6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106538392"
---
# <a name="time-stamps"></a><span data-ttu-id="2ac70-103">Horodatages</span><span class="sxs-lookup"><span data-stu-id="2ac70-103">Time Stamps</span></span>

<span data-ttu-id="2ac70-104">L' *horodatage* définit les heures de début et de fin d’un échantillon de support, mesurée en temps de flux.</span><span class="sxs-lookup"><span data-stu-id="2ac70-104">The *time stamp* defines a media sample's start and finish times, measured in stream time.</span></span> <span data-ttu-id="2ac70-105">L’horodatage est parfois appelé heure de *Présentation*.</span><span class="sxs-lookup"><span data-stu-id="2ac70-105">The time stamp is sometimes called the *presentation time*.</span></span> <span data-ttu-id="2ac70-106">Lorsque vous lisez le reste de cet article, il est important de se souvenir que tous les formats n’utilisent pas les horodatages de la même façon.</span><span class="sxs-lookup"><span data-stu-id="2ac70-106">When reading the rest of this article, it is important to remember that not all formats use time stamps in the same way.</span></span> <span data-ttu-id="2ac70-107">Par exemple, tous les exemples MPEG ne sont pas horodatés.</span><span class="sxs-lookup"><span data-stu-id="2ac70-107">For example, not all MPEG samples are time stamped.</span></span> <span data-ttu-id="2ac70-108">Dans les graphiques de filtre MPEG, l’horodatage n’est pas appliqué à chaque frame tant qu’il n’est pas sorti du décodeur.</span><span class="sxs-lookup"><span data-stu-id="2ac70-108">In MPEG filter graphs, the time stamp is not applied to each frame until they are output from the decoder.</span></span>

<span data-ttu-id="2ac70-109">Lorsqu’un filtre de convertisseur reçoit un exemple, il planifie le rendu en fonction de l’horodatage.</span><span class="sxs-lookup"><span data-stu-id="2ac70-109">When a renderer filter receives a sample, it schedules rendering based on the time stamp.</span></span> <span data-ttu-id="2ac70-110">Si l’exemple arrive en retard ou n’a pas d’horodatage, le filtre restitue l’exemple immédiatement.</span><span class="sxs-lookup"><span data-stu-id="2ac70-110">If the sample arrives late, or has no time stamp, the filter renders the sample immediately.</span></span> <span data-ttu-id="2ac70-111">Dans le cas contraire, le filtre attend l’heure de début de l’exemple avant d’afficher l’exemple.</span><span class="sxs-lookup"><span data-stu-id="2ac70-111">Otherwise, the filter waits until the sample's start time before it renders the sample.</span></span> <span data-ttu-id="2ac70-112">(Elle attend l’heure de début en appelant la méthode [**IReferenceClock :: AdviseTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-advisetime) .)</span><span class="sxs-lookup"><span data-stu-id="2ac70-112">(It waits for the start time by calling the [**IReferenceClock::AdviseTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-advisetime) method.)</span></span>

<span data-ttu-id="2ac70-113">Les filtres sources et les filtres de l’analyseur sont chargés de définir les horodatages corrects sur les exemples qu’ils traitent.</span><span class="sxs-lookup"><span data-stu-id="2ac70-113">Source filters and parser filters are responsible for setting the correct time stamps on the samples they process.</span></span> <span data-ttu-id="2ac70-114">Suivez les instructions ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="2ac70-114">Use the following guidelines.</span></span>

-   <span data-ttu-id="2ac70-115">Lecture de fichier : le premier exemple est horodaté avec une heure de début égale à zéro.</span><span class="sxs-lookup"><span data-stu-id="2ac70-115">File playback: The first sample is time stamped with a start time of zero.</span></span> <span data-ttu-id="2ac70-116">Les horodatages suivants sont déterminés par la longueur de l’échantillon et la vitesse de lecture, qui est elle-même déterminée par le format de fichier.</span><span class="sxs-lookup"><span data-stu-id="2ac70-116">Subsequent time stamps are determined by the sample length and the playback rate, which itself is determined by the file format.</span></span> <span data-ttu-id="2ac70-117">Le filtre qui analyse le fichier est chargé de calculer les horodatages appropriés (par exemple, le [séparateur AVI](avi-splitter-filter.md)).</span><span class="sxs-lookup"><span data-stu-id="2ac70-117">The filter that parses the file is responsible for calculating the correct time stamps (for example, the [AVI Splitter](avi-splitter-filter.md)).</span></span>
-   <span data-ttu-id="2ac70-118">Capture vidéo et audio : chaque exemple est horodaté avec une heure de début égale à la durée du flux de données lors de la capture, avec les restrictions suivantes :</span><span class="sxs-lookup"><span data-stu-id="2ac70-118">Video and audio capture: Every sample is time stamped with a start time equal to the stream time when it was captured, with the following caveats:</span></span>
    -   <span data-ttu-id="2ac70-119">Les images vidéo d’un code confidentiel d’aperçu (par opposition à un code confidentiel de capture) ne sont pas horodatées.</span><span class="sxs-lookup"><span data-stu-id="2ac70-119">Video frames from a preview pin (as opposed to a capture pin) are not time stamped.</span></span> <span data-ttu-id="2ac70-120">En raison de la latence de graphique, une image vidéo qui est marquée avec le temps de capture est toujours retardée au niveau du convertisseur vidéo.</span><span class="sxs-lookup"><span data-stu-id="2ac70-120">Because of graph latency, a video frame that is stamped with the capture time will always arrive late at the video renderer.</span></span> <span data-ttu-id="2ac70-121">Cela peut amener le convertisseur à déposer des frames, en tentant de contrôler la qualité.</span><span class="sxs-lookup"><span data-stu-id="2ac70-121">This may cause the renderer to drop frames, in an attempt at quality control.</span></span> <span data-ttu-id="2ac70-122">Pour plus d’informations sur le contrôle qualité, consultez [gestion du contrôle qualité](quality-control-management.md).</span><span class="sxs-lookup"><span data-stu-id="2ac70-122">For information about quality control, see [Quality-Control Management](quality-control-management.md).</span></span>
    -   <span data-ttu-id="2ac70-123">Capture audio : le filtre de capture audio utilise son propre ensemble de mémoires tampons, qui sont différentes de celles utilisées par le pilote audio.</span><span class="sxs-lookup"><span data-stu-id="2ac70-123">Audio capture: The audio capture filter uses its own set of buffers, which are separate from those used by the audio driver.</span></span> <span data-ttu-id="2ac70-124">Le pilote audio remplit les tampons du filtre de capture à intervalles fixes.</span><span class="sxs-lookup"><span data-stu-id="2ac70-124">The audio driver fills the capture filter's buffers at fixed intervals.</span></span> <span data-ttu-id="2ac70-125">L’intervalle dépend du pilote, mais n’est généralement pas supérieur à 10 millisecondes.</span><span class="sxs-lookup"><span data-stu-id="2ac70-125">The interval depends on the driver, but generally is not more than 10 milliseconds.</span></span> <span data-ttu-id="2ac70-126">Les horodatages des échantillons audio reflètent l’heure à laquelle le pilote a rempli les tampons du filtre de capture audio.</span><span class="sxs-lookup"><span data-stu-id="2ac70-126">The time stamps on the audio samples reflect the time when the driver filled the audio capture filter's buffers.</span></span> <span data-ttu-id="2ac70-127">Ces heures peuvent être légèrement inexactes, en particulier si l’application utilise une très petite taille de mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="2ac70-127">These times can be slightly inaccurate, especially if the application is using a very small buffer size.</span></span> <span data-ttu-id="2ac70-128">Toutefois, les temps de support reflètent avec précision le nombre d’échantillons audio dans la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="2ac70-128">However, the media times will accurately reflect the number audio samples in the buffer.</span></span>
-   <span data-ttu-id="2ac70-129">Filtres Mux : selon le format de sortie, un filtre MUX peut avoir besoin de générer des horodatages, ou ce n’est peut-être pas le cas.</span><span class="sxs-lookup"><span data-stu-id="2ac70-129">Mux filters: Depending on the output format, a mux filter may need to generate time stamps, or it may not.</span></span> <span data-ttu-id="2ac70-130">Par exemple, le format de fichier AVI utilise une fréquence d’images fixe sans horodatage. le filtre [multiplex MUX](avi-mux-filter.md) suppose donc que les échantillons arrivent à peu près au bon moment.</span><span class="sxs-lookup"><span data-stu-id="2ac70-130">For example, the AVI file format uses a fixed frame rate with no time stamps, so the [AVI Mux](avi-mux-filter.md) filter assumes that samples are arriving at approximately the right time.</span></span> <span data-ttu-id="2ac70-131">Toutefois, si les horodatages entrants indiquent un intervalle supérieur à un cadre, le multiplexeur de contrôle d’accès (AVI) enregistre une entrée d’index avec la taille zéro pour indiquer un frame déplacé.</span><span class="sxs-lookup"><span data-stu-id="2ac70-131">If the incoming time stamps show a gap larger than one frame, however, the AVI Mux writes an index entry with size zero, to indicate a dropped frame.</span></span> <span data-ttu-id="2ac70-132">Lors de la lecture du fichier, de nouveaux horodatages sont générés au moment de l’exécution, comme décrit précédemment.</span><span class="sxs-lookup"><span data-stu-id="2ac70-132">On file playback, new time stamps are generated at run time, as described previously.</span></span>

<span data-ttu-id="2ac70-133">Pour définir l’horodatage sur un exemple, appelez la méthode [**IMediaSample :: setTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-settime) .</span><span class="sxs-lookup"><span data-stu-id="2ac70-133">To set the time stamp on a sample, call the [**IMediaSample::SetTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-settime) method.</span></span>

<span data-ttu-id="2ac70-134">**Temps de support**</span><span class="sxs-lookup"><span data-stu-id="2ac70-134">**Media Times**</span></span>

<span data-ttu-id="2ac70-135">Le cas échéant, le filtre peut également spécifier un *temps de support* pour l’exemple.</span><span class="sxs-lookup"><span data-stu-id="2ac70-135">Optionally, the filter can also specify a *media time* for the sample.</span></span> <span data-ttu-id="2ac70-136">Dans un flux vidéo, l’heure du média représente le numéro de la trame.</span><span class="sxs-lookup"><span data-stu-id="2ac70-136">In a video stream, media time represents the frame number.</span></span> <span data-ttu-id="2ac70-137">Dans un flux audio, l’heure du média représente le numéro de l’échantillon dans le paquet.</span><span class="sxs-lookup"><span data-stu-id="2ac70-137">In an audio stream, media time represents the sample number in the packet.</span></span> <span data-ttu-id="2ac70-138">Par exemple, si chaque paquet contient une seconde de l’audio 44,1 kilohertz (kHz), le premier paquet a une heure de début de support de zéro et une heure d’arrêt de support de 44100.</span><span class="sxs-lookup"><span data-stu-id="2ac70-138">For example, if each packet contains one second of 44.1 kilohertz (kHz) audio, the first packet has a media start time of zero and a media stop time of 44100.</span></span> <span data-ttu-id="2ac70-139">Dans un flux de recherche, l’heure du média est toujours relative à l’heure de début du flux.</span><span class="sxs-lookup"><span data-stu-id="2ac70-139">In a seekable stream, the media time is always relative to the start time of the stream.</span></span> <span data-ttu-id="2ac70-140">Supposons, par exemple, que vous recherchez 2 secondes à partir du début d’un flux vidéo de 15 i/s.</span><span class="sxs-lookup"><span data-stu-id="2ac70-140">For example, suppose you seek to 2 seconds from the start of a 15-fps video stream.</span></span> <span data-ttu-id="2ac70-141">Le premier exemple de support après la recherche a un horodatage de zéro, mais un temps de support de 30.</span><span class="sxs-lookup"><span data-stu-id="2ac70-141">The first media sample after the seek has a time stamp of zero but a media time of 30.</span></span>

<span data-ttu-id="2ac70-142">Les filtres de convertisseur et de multiplexeur peuvent utiliser l’heure du média pour déterminer si des images ou des échantillons ont été supprimés, en vérifiant les lacunes.</span><span class="sxs-lookup"><span data-stu-id="2ac70-142">Renderer and mux filters can use the media time to determine whether frames or samples have been dropped, by checking for gaps.</span></span> <span data-ttu-id="2ac70-143">Toutefois, les filtres ne sont pas requis pour définir l’heure du support.</span><span class="sxs-lookup"><span data-stu-id="2ac70-143">However, filters are not required to set the media time.</span></span> <span data-ttu-id="2ac70-144">Pour définir l’heure du média sur un exemple, appelez la méthode [**IMediaSample :: SetMediaTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-setmediatime) .</span><span class="sxs-lookup"><span data-stu-id="2ac70-144">To set the media time on a sample, call the [**IMediaSample::SetMediaTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-setmediatime) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2ac70-145">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="2ac70-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2ac70-146">Temps et horloges dans DirectShow</span><span class="sxs-lookup"><span data-stu-id="2ac70-146">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



