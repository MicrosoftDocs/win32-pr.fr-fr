---
description: Serveurs de distribution de plug-in
ms.assetid: 80ff713d-f704-40d3-9317-cbf33d932207
title: Serveurs de distribution de plug-in
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7817e5e31b29444cc596b0be583be2198adc018
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "106513888"
---
# <a name="plug-in-distributors"></a><span data-ttu-id="b8a87-103">Serveurs de distribution de plug-in</span><span class="sxs-lookup"><span data-stu-id="b8a87-103">Plug-in Distributors</span></span>

<span data-ttu-id="b8a87-104">Les serveurs de distribution de plug-in (PID) permettent d’étendre les fonctionnalités du gestionnaire de graphes de filtre.</span><span class="sxs-lookup"><span data-stu-id="b8a87-104">Plug-in distributors (PIDs) are a way to extend the functionality of the filter graph manager.</span></span> <span data-ttu-id="b8a87-105">Un serveur de distribution de plug-in est un objet COM que le gestionnaire de graphique de filtre agrège au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="b8a87-105">A plug-in distributor is a COM object that the filter graph manager aggregates at run time.</span></span> <span data-ttu-id="b8a87-106">Les applications obtiennent l’accès au PID via le gestionnaire de graphes de filtre.</span><span class="sxs-lookup"><span data-stu-id="b8a87-106">Applications obtain access to the PID through the filter graph manager.</span></span>

<span data-ttu-id="b8a87-107">Lorsque le gestionnaire de graphique de filtre est interrogé pour une interface qu’il ne prend pas en charge, il recherche une clé dans le registre, sous la forme suivante :</span><span class="sxs-lookup"><span data-stu-id="b8a87-107">When the filter graph manager is queried for an interface that it does not support, it searches the registry for a key with the following form:</span></span>


```C++
HKEY_CLASSES_ROOT\Interface\IID\Distributor
```



<span data-ttu-id="b8a87-108">`IID` chaîne contenant l’identificateur d’interface.</span><span class="sxs-lookup"><span data-stu-id="b8a87-108">`IID` is a string containing the interface identifier.</span></span> <span data-ttu-id="b8a87-109">Si l’entrée de Registre existe, la valeur de l’entrée définit l’identificateur de classe (CLSID) d’un PID qui prend en charge l’interface.</span><span class="sxs-lookup"><span data-stu-id="b8a87-109">If the registry entry exists, the value of the entry defines the class identifier (CLSID) of a PID that supports the interface.</span></span> <span data-ttu-id="b8a87-110">Le gestionnaire de graphique de filtre agrège le PID et retourne un pointeur d’interface, agissant ainsi comme **IUnknown** externe pour le PID.</span><span class="sxs-lookup"><span data-stu-id="b8a87-110">The filter graph manager aggregates the PID and returns an interface pointer, thereby acting as the outer **IUnknown** for the PID.</span></span> <span data-ttu-id="b8a87-111">Lorsque l’application appelle des méthodes sur l’interface, elle les appelle en fait sur le PID.</span><span class="sxs-lookup"><span data-stu-id="b8a87-111">When the application calls methods on the interface, it is actually calling them on the PID.</span></span> <span data-ttu-id="b8a87-112">Toutefois, l’existence du PID est transparente pour l’application.</span><span class="sxs-lookup"><span data-stu-id="b8a87-112">However, the existence of the PID is transparent to the application.</span></span>

<span data-ttu-id="b8a87-113">Le terme « *distributeur* » vient du fait qu’un PID peut interroger son pointeur **IUnknown** externe pour les interfaces sur le gestionnaire de graphes de filtre.</span><span class="sxs-lookup"><span data-stu-id="b8a87-113">The term *distributor* stems from the fact that a PID can query its outer **IUnknown** pointer for interfaces on the filter graph manager.</span></span> <span data-ttu-id="b8a87-114">En appelant la méthode [**IFilterGraph :: EnumFilters**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-enumfilters) , le PID peut énumérer les filtres dans le graphique et distribuer les appels de méthode à ces filtres.</span><span class="sxs-lookup"><span data-stu-id="b8a87-114">By calling the [**IFilterGraph::EnumFilters**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-enumfilters) method, the PID can enumerate the filters in the graph and distribute method calls to those filters.</span></span> <span data-ttu-id="b8a87-115">De cette façon, un PID peut servir de point de contrôle unique pour que l’application puisse appeler des méthodes sur des filtres.</span><span class="sxs-lookup"><span data-stu-id="b8a87-115">In this way, a PID can serve as a single control point for the application to call methods on filters.</span></span>

<span data-ttu-id="b8a87-116">Lorsque le gestionnaire de graphique de filtre agrège un PID, il interroge le PID de l’interface [**IDistributorNotify**](/windows/desktop/api/Strmif/nn-strmif-idistributornotify) .</span><span class="sxs-lookup"><span data-stu-id="b8a87-116">When the filter graph manager aggregates a PID, it queries the PID for the [**IDistributorNotify**](/windows/desktop/api/Strmif/nn-strmif-idistributornotify) interface.</span></span> <span data-ttu-id="b8a87-117">Si le PID prend en charge cette interface, le gestionnaire de graphes de filtres l’utilise pour informer le PID des modifications apportées au graphique :</span><span class="sxs-lookup"><span data-stu-id="b8a87-117">If the PID supports this interface, the filter graph manager uses it to notify the PID about changes in the graph:</span></span>

-   <span data-ttu-id="b8a87-118">Lorsque le graphique de filtre bascule entre les États d’exécution, suspendus et arrêtés, il appelle [**IDistributorNotify :: Run**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-run), [**IDistributorNotify ::P ause**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-pause)ou [**IDistributorNotify :: Stop**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-stop).</span><span class="sxs-lookup"><span data-stu-id="b8a87-118">When the filter graph switches between run, paused, and stopped states, it calls [**IDistributorNotify::Run**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-run), [**IDistributorNotify::Pause**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-pause), or [**IDistributorNotify::Stop**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-stop).</span></span>
-   <span data-ttu-id="b8a87-119">Quand une horloge de référence est définie, le gestionnaire de graphique de filtre appelle [**IDistributorNotify :: SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-setsyncsource).</span><span class="sxs-lookup"><span data-stu-id="b8a87-119">When a reference clock is set, the filter graph manager calls [**IDistributorNotify::SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-setsyncsource).</span></span>
-   <span data-ttu-id="b8a87-120">Lorsque vous ajoutez ou supprimez des filtres, ou si les connexions d’épinglage sont modifiées, le gestionnaire de graphique de filtre appelle [**IDistributorNotify :: NotifyGraphChange**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-notifygraphchange).</span><span class="sxs-lookup"><span data-stu-id="b8a87-120">When filters are added or removed, or pin connections are changed, the filter graph manager calls [**IDistributorNotify::NotifyGraphChange**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-notifygraphchange).</span></span>

<span data-ttu-id="b8a87-121">Pour implémenter un PID personnalisé, créez un objet COM qui prend en charge l’agrégation.</span><span class="sxs-lookup"><span data-stu-id="b8a87-121">To implement a custom PID, create a COM object that supports aggregation.</span></span> <span data-ttu-id="b8a87-122">Il doit prendre en charge une interface que le gestionnaire de graphique de filtre ne prend pas encore en charge.</span><span class="sxs-lookup"><span data-stu-id="b8a87-122">It must support an interface that the filter graph manager does not already support.</span></span> <span data-ttu-id="b8a87-123">Le cas échéant, il peut prendre en charge l’interface **IDistributorNotify** .</span><span class="sxs-lookup"><span data-stu-id="b8a87-123">Optionally, it can support the **IDistributorNotify** interface.</span></span>

<span data-ttu-id="b8a87-124">Si le PID obtient des pointeurs d’interface à partir du gestionnaire de graphes de filtre, il doit les libérer immédiatement.</span><span class="sxs-lookup"><span data-stu-id="b8a87-124">If the PID obtains any interface pointers from the filter graph manager, it should release them immediately.</span></span> <span data-ttu-id="b8a87-125">Dans le cas contraire, il peut créer un nombre de références circulaires, ce qui peut empêcher la destruction du gestionnaire de graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="b8a87-125">Otherwise, it might create a circular reference count, which could prevent the filter graph manager from being destroyed.</span></span> <span data-ttu-id="b8a87-126">Le maintien d’un décompte de références sur le gestionnaire de graphique de filtre n’est pas nécessaire dans tous les cas, car le gestionnaire de graphique de filtre contrôle la durée de vie du PID.</span><span class="sxs-lookup"><span data-stu-id="b8a87-126">Holding a reference count on the filter graph manager is unnecessary in any case, because the filter graph manager controls the PID's lifetime.</span></span>

<span data-ttu-id="b8a87-127">Comme un PID est conçu spécifiquement pour l’agrégation par le gestionnaire de graphes de filtre, vous souhaiterez peut-être l’appliquer dans la méthode du constructeur du PID.</span><span class="sxs-lookup"><span data-stu-id="b8a87-127">Because a PID is designed specifically for aggregation by the filter graph manager, you might want to enforce this in the PID's constructor method.</span></span> <span data-ttu-id="b8a87-128">Vérifiez si le pointeur **IUnknown** externe a la **valeur null** et, si tel est le cas, retournez le code d’erreur VFW E a besoin d’un \_ \_ \_ propriétaire.</span><span class="sxs-lookup"><span data-stu-id="b8a87-128">Check whether the outer **IUnknown** pointer is **NULL**, and if so, return the error code VFW\_E\_NEED\_OWNER.</span></span> <span data-ttu-id="b8a87-129">(Voir [les codes d’erreur et de réussite](error-and-success-codes.md).) En outre, pour empêcher d’autres objets d’agréger le PID, vous pouvez interroger le pointeur **IUnknown** externe pour l’interface [**IGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) .</span><span class="sxs-lookup"><span data-stu-id="b8a87-129">(See [Error and Success Codes](error-and-success-codes.md).) Also, to prevent other objects from aggregating the PID, you can query the outer **IUnknown** pointer for the [**IGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) interface.</span></span> <span data-ttu-id="b8a87-130">Retourne un code d’erreur si l’objet n’expose pas **IGraphBuilder**.</span><span class="sxs-lookup"><span data-stu-id="b8a87-130">Return an error code if the object does not expose **IGraphBuilder**.</span></span>

 

 



