---
description: Génération du graphique de filtre de DVD
ms.assetid: 1d2f8284-2deb-4207-b067-24a54d6b286c
title: Génération du graphique de filtre de DVD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 96d15c7d84ec138771e1f5da8be4270faae049cc
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104109710"
---
# <a name="building-the-dvd-filter-graph"></a><span data-ttu-id="3ccdf-103">Génération du graphique de filtre de DVD</span><span class="sxs-lookup"><span data-stu-id="3ccdf-103">Building the DVD Filter Graph</span></span>

<span data-ttu-id="3ccdf-104">Comme pour toute application DirectShow, une application de lecture de DVD commence par créer un graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-104">As with any DirectShow application, a DVD playback application starts by building a filter graph.</span></span> <span data-ttu-id="3ccdf-105">DirectShow fournit les composants suivants pour la lecture de DVD :</span><span class="sxs-lookup"><span data-stu-id="3ccdf-105">DirectShow provides the following components for DVD playback:</span></span>

-   <span data-ttu-id="3ccdf-106">[Générateur de graphiques DVD](dvd-graph-builder.md).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-106">[DVD Graph Builder](dvd-graph-builder.md).</span></span> <span data-ttu-id="3ccdf-107">Objet d’assistance qui construit le graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-107">A helper object that constructs the filter graph.</span></span> <span data-ttu-id="3ccdf-108">Il expose l’interface [**IDvdGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-idvdgraphbuilder) .</span><span class="sxs-lookup"><span data-stu-id="3ccdf-108">It exposes the [**IDvdGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-idvdgraphbuilder) interface.</span></span>
-   <span data-ttu-id="3ccdf-109">Filtre de [navigateur DVD](dvd-navigator-filter.md) .</span><span class="sxs-lookup"><span data-stu-id="3ccdf-109">[DVD Navigator](dvd-navigator-filter.md) filter.</span></span> <span data-ttu-id="3ccdf-110">Filtre DirectShow qui gère la lecture des DVD, la navigation et d’autres commandes.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-110">A DirectShow filter that handles DVD playback, navigation, and other commands.</span></span>

<span data-ttu-id="3ccdf-111">La lecture des DVD nécessite également un décodeur MPEG-2.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-111">DVD playback also requires an MPEG-2 decoder.</span></span> <span data-ttu-id="3ccdf-112">Les décodeurs MPEG-2 matériels et logiciels sont disponibles auprès de tiers.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-112">Hardware and software MPEG-2 decoders are available from third parties.</span></span> <span data-ttu-id="3ccdf-113">Tout d’abord, créez une instance de l’objet DVD Graph Builder.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-113">First, create an instance of the DVD Graph Builder object.</span></span>


```C++
IDvdGraphBuilder *pBuild = NULL;
hr = CoCreateInstance(CLSID_DvdGraphBuilder, NULL, 
    CLSCTX_INPROC_SERVER, IID_IDvdGraphBuilder, (void **)&pBuild);
```



<span data-ttu-id="3ccdf-114">À ce stade, vous pouvez sélectionner et configurer le convertisseur vidéo avant de générer le reste du graphique.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-114">At this point, you can select and configure the video renderer before you build the rest of the graph.</span></span> <span data-ttu-id="3ccdf-115">Cette étape, qui est facultative, est décrite plus en détail dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-115">This step, which is optional, is described in more detail in the next section.</span></span> <span data-ttu-id="3ccdf-116">Si vous omettez cette étape, le générateur de graphiques de DVD sélectionne un convertisseur par défaut.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-116">If you omit this step, the DVD Graph Builder selects a default renderer.</span></span> <span data-ttu-id="3ccdf-117">Ensuite, générez le graphique en appelant la méthode [**IDvdGraphBuilder :: RenderDvdVideoVolume**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-renderdvdvideovolume) .</span><span class="sxs-lookup"><span data-stu-id="3ccdf-117">Next, build the graph by calling the [**IDvdGraphBuilder::RenderDvdVideoVolume**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-renderdvdvideovolume) method.</span></span>


```C++
AM_DVD_RENDERSTATUS buildStatus;
hr = pBuild->RenderDvdVideoVolume(L"Z:\\video_ts", 0, &buildStatus);
```



<span data-ttu-id="3ccdf-118">Le premier paramètre est le nom d’un répertoire qui contient les fichiers de DVD.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-118">The first parameter is the name of a directory that contains the DVD files.</span></span> <span data-ttu-id="3ccdf-119">Sur un disque DVD, ces fichiers résident dans un répertoire nommé VIDEO \_ TS.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-119">On a DVD disc, these files reside in a directory named VIDEO\_TS.</span></span> <span data-ttu-id="3ccdf-120">Si le premier paramètre est **null**, le générateur de graphiques de DVD utilise le premier lecteur qui contient un volume DVD.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-120">If the first parameter is **NULL**, the DVD Graph Builder uses the first drive that contains a DVD volume.</span></span>

<span data-ttu-id="3ccdf-121">Le deuxième paramètre contient différents indicateurs facultatifs permettant de choisir le type de décodeur (matériel ou logiciel) et d’autres options.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-121">The second parameter contains various optional flags for choosing the type of decoder (hardware or software) and other options.</span></span>

<span data-ttu-id="3ccdf-122">Le troisième paramètre est une [**structure \_ \_ RENDERSTATUS de DVD am**](/windows/win32/api/strmif/ns-strmif-am_dvd_renderstatus) qui reçoit des informations d’État.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-122">The third parameter is an [**AM\_DVD\_RENDERSTATUS**](/windows/win32/api/strmif/ns-strmif-am_dvd_renderstatus) structure that receives status information.</span></span> <span data-ttu-id="3ccdf-123">Si la méthode [**RenderDvdVideoVolume**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-renderdvdvideovolume) retourne S \_ false, cela signifie que l’appel a été partiellement réussi (ou partiellement échoué, si vous êtes un pessimiste).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-123">If the [**RenderDvdVideoVolume**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-renderdvdvideovolume) method returns S\_FALSE, it means the call partially succeeded (or partially failed, if you're a pessimist).</span></span> <span data-ttu-id="3ccdf-124">Par exemple, la méthode peut ne pas réussir à restituer le flux de sous-image, même si les autres flux ont été restitués avec succès.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-124">For example, the method might fail to render the subpicture stream, even though the other streams rendered successfully.</span></span> <span data-ttu-id="3ccdf-125">Si la méthode **RenderDvdVideoVolume** retourne un code d’erreur ou si la valeur S \_ est false, vous pouvez examiner la structure **am \_ DVD \_ RENDERSTATUS** pour plus d’informations sur l’erreur.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-125">If the **RenderDvdVideoVolume** method returns an error code or the value S\_FALSE, you can examine the **AM\_DVD\_RENDERSTATUS** structure for details about the error.</span></span>

<span data-ttu-id="3ccdf-126">Ensuite, récupérez un pointeur vers le gestionnaire du graphique de filtre en appelant [**IDvdGraphBuilder :: GetFiltergraph**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-getfiltergraph).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-126">Next, get a pointer to the Filter Graph Manager by calling [**IDvdGraphBuilder::GetFiltergraph**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-getfiltergraph).</span></span> <span data-ttu-id="3ccdf-127">Cette méthode retourne un pointeur vers l’interface [**IGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) du gestionnaire de graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-127">This method returns a pointer to the Filter Graph Manager's [**IGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) interface.</span></span>


```C++
IGraphBuilder *pGraph = NULL;
hr =  pBuild->GetFiltergraph(&m_pGraph);
```



<span data-ttu-id="3ccdf-128">Utilisez la méthode [**IDvdGraphBuilder :: GetDvdInterface**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-getdvdinterface) pour récupérer des interfaces relatives aux DVD, y compris les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="3ccdf-128">Use the [**IDvdGraphBuilder::GetDvdInterface**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-getdvdinterface) method to retrieve DVD-related interfaces, including the following:</span></span>

-   <span data-ttu-id="3ccdf-129">[**IDvdControl2**](/windows/desktop/api/Strmif/nn-strmif-idvdcontrol2).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-129">[**IDvdControl2**](/windows/desktop/api/Strmif/nn-strmif-idvdcontrol2).</span></span> <span data-ttu-id="3ccdf-130">Contrôle les commandes de lecture et de DVD</span><span class="sxs-lookup"><span data-stu-id="3ccdf-130">Controls playback and DVD commands</span></span>
-   <span data-ttu-id="3ccdf-131">[**IDvdInfo2**](/windows/desktop/api/Strmif/nn-strmif-idvdinfo2).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-131">[**IDvdInfo2**](/windows/desktop/api/Strmif/nn-strmif-idvdinfo2).</span></span> <span data-ttu-id="3ccdf-132">Retourne des informations sur l’état actuel du navigateur DVD.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-132">Returns information about the DVD Navigator's current state.</span></span>
-   <span data-ttu-id="3ccdf-133">[**IAMLine21Decoder**](/previous-versions/windows/desktop/api/il21dec/nn-il21dec-iamline21decoder).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-133">[**IAMLine21Decoder**](/previous-versions/windows/desktop/api/il21dec/nn-il21dec-iamline21decoder).</span></span> <span data-ttu-id="3ccdf-134">Contrôle l’affichage de la légende fermée.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-134">Controls closed caption display.</span></span> <span data-ttu-id="3ccdf-135">L’affichage des sous-titres est activé par défaut.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-135">Closed caption display is enabled by default.</span></span> <span data-ttu-id="3ccdf-136">Pour le désactiver, appelez [**IAMLine21Decoder :: SetServiceState**](/previous-versions/windows/desktop/api/il21dec/nf-il21dec-iamline21decoder-setservicestate) avec l' \_ indicateur AM L21 \_ CCSTATE \_ off.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-136">To disable it, call [**IAMLine21Decoder::SetServiceState**](/previous-versions/windows/desktop/api/il21dec/nf-il21dec-iamline21decoder-setservicestate) with the AM\_L21\_CCSTATE\_Off flag.</span></span>
-   <span data-ttu-id="3ccdf-137">[**IBasicAudio**](/windows/desktop/api/Control/nn-control-ibasicaudio).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-137">[**IBasicAudio**](/windows/desktop/api/Control/nn-control-ibasicaudio).</span></span> <span data-ttu-id="3ccdf-138">Contrôle le volume audio et l’équilibre.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-138">Controls audio volume and balance.</span></span>

<span data-ttu-id="3ccdf-139">Par exemple, le code suivant retourne l’interface [**IDvdControl2**](/windows/desktop/api/Strmif/nn-strmif-idvdcontrol2) .</span><span class="sxs-lookup"><span data-stu-id="3ccdf-139">For example, the following code returns the [**IDvdControl2**](/windows/desktop/api/Strmif/nn-strmif-idvdcontrol2) interface.</span></span>


```C++
IDvdControl2 *pDvdControl = NULL;
hr = pBuild->GetDvdInterface(IID_IDvdControl2, (void**)&pDvdControl);
```



<span data-ttu-id="3ccdf-140">La méthode recommandée pour générer le graphique de filtre de lecture de DVD consiste à avoir un objet [Générateur de graphiques DVD](dvd-graph-builder.md) pour vous automatiquement.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-140">The recommended way to build the DVD playback filter graph is to have a [DVD Graph Builder](dvd-graph-builder.md) object do it for you automatically.</span></span> <span data-ttu-id="3ccdf-141">Cette approche est illustrée ci-dessous et dans l’exemple d’application de DVD.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-141">This approach is demonstrated below and in the DVD sample application.</span></span> <span data-ttu-id="3ccdf-142">Si vous avez besoin de créer votre graphique de filtre de DVD manuellement, vous pouvez le faire en suivant les règles de base de la création de graphiques présentées ailleurs dans la documentation DirectShow.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-142">If you need to build your DVD filter graph manually, you can do so by following the basic rules of graph building discussed elsewhere in the DirectShow documentation.</span></span> <span data-ttu-id="3ccdf-143">En règle générale, vous ne devez pas ajouter, supprimer, connecter ou déconnecter manuellement des filtres individuels dans le graphique créé par le générateur de graphiques DVD, car cela peut entraîner une confusion dans le code de nettoyage.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-143">Generally, you should not manually add, remove, connect, or disconnect individual filters in the graph created by the DVD Graph Builder, because doing so might confuse the cleanup code.</span></span>

<span data-ttu-id="3ccdf-144">Configuration du convertisseur vidéo</span><span class="sxs-lookup"><span data-stu-id="3ccdf-144">Configuring the Video Renderer</span></span>

<span data-ttu-id="3ccdf-145">DirectShow fournit plusieurs filtres de convertisseur vidéo.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-145">DirectShow provides several video renderer filters.</span></span> <span data-ttu-id="3ccdf-146">Avant de générer le graphique, vous pouvez choisir le convertisseur vidéo que vous préférez.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-146">Before you build the graph, you can chose which video renderer you prefer.</span></span> <span data-ttu-id="3ccdf-147">Sélectionnez le convertisseur en appelant [**IDvdGraphBuilder :: GetDvdInterface**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-getdvdinterface) et en demandant une interface spécifique à ce convertisseur :</span><span class="sxs-lookup"><span data-stu-id="3ccdf-147">Select the renderer by calling [**IDvdGraphBuilder::GetDvdInterface**](/windows/desktop/api/Strmif/nf-strmif-idvdgraphbuilder-getdvdinterface) and requesting an interface that is specific to that renderer:</span></span>

-   <span data-ttu-id="3ccdf-148">Filtre de mixage de superposition : [**IDDrawExclModeVideo**](/windows/desktop/api/Strmif/nn-strmif-iddrawexclmodevideo).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-148">Overlay Mixer Filter: [**IDDrawExclModeVideo**](/windows/desktop/api/Strmif/nn-strmif-iddrawexclmodevideo).</span></span>
-   <span data-ttu-id="3ccdf-149">Convertisseur de mixage vidéo 7 (VMR-7) : [**IVMRFilterConfig**](/windows/desktop/api/Strmif/nn-strmif-ivmrfilterconfig).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-149">Video Mixing Renderer 7 (VMR-7): [**IVMRFilterConfig**](/windows/desktop/api/Strmif/nn-strmif-ivmrfilterconfig).</span></span>
-   <span data-ttu-id="3ccdf-150">Convertisseur de mixage vidéo 9 (VMR-9) : [**IVMRFilterConfig9**](/previous-versions/windows/desktop/api/Vmr9/nn-vmr9-ivmrfilterconfig9).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-150">Video Mixing Renderer 9 (VMR-9): [**IVMRFilterConfig9**](/previous-versions/windows/desktop/api/Vmr9/nn-vmr9-ivmrfilterconfig9).</span></span>
-   <span data-ttu-id="3ccdf-151">Rendu vidéo amélioré (EVR) : [**IEVRFilterConfig**](/windows/desktop/api/evr/nn-evr-ievrfilterconfig).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-151">Enhanced Video Renderer (EVR): [**IEVRFilterConfig**](/windows/desktop/api/evr/nn-evr-ievrfilterconfig).</span></span>

<span data-ttu-id="3ccdf-152">Si vous demandez l’une de ces interfaces avant de générer le graphique de filtre, le générateur de graphiques DVD crée le convertisseur vidéo correspondant.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-152">If you request any of these interfaces before building the filter graph, the DVD Graph Builder creates the corresponding video renderer.</span></span> <span data-ttu-id="3ccdf-153">Plus tard, lorsque vous générerez le graphique, le générateur de graphiques DVD essaiera d’utiliser ce convertisseur.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-153">Later, when you build the graph, the DVD Graph Builder will try to use that renderer.</span></span> <span data-ttu-id="3ccdf-154">Toutefois, s’il ne peut pas générer le graphique à l’aide du convertisseur que vous avez sélectionné, il peut basculer vers un autre convertisseur.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-154">But if it cannot build the graph using the renderer you selected, it may switch to another renderer.</span></span> <span data-ttu-id="3ccdf-155">Par exemple, votre décodeur MPEG-2 peut ne pas être compatible avec le filtre VMR. dans ce cas, le générateur de graphiques DVD est défini par défaut sur le mélangeur de superposition.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-155">For example, your MPEG-2 decoder might not be compatible with the VMR filter, in which case the DVD Graph Builder would default to the Overlay Mixer.</span></span>

<span data-ttu-id="3ccdf-156">Ces interfaces vous donnent également la possibilité de configurer le convertisseur avant qu’il ne soit connecté au décodeur.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-156">These interfaces also give you a chance to configure the renderer before it is connected to the decoder.</span></span> <span data-ttu-id="3ccdf-157">Par exemple, vous pouvez configurer VMR pour utiliser le mode sans fenêtre au lieu du mode fenêtre par défaut.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-157">For example, you can set the VMR to use windowless mode instead of the default windowed mode.</span></span> <span data-ttu-id="3ccdf-158">Pour plus d’informations sur les convertisseurs vidéo, consultez la rubrique [à propos du rendu vidéo dans DirectShow](about-video-rendering-in-directshow.md).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-158">For more information about video renderers, see the topic [About Video Rendering in DirectShow](about-video-rendering-in-directshow.md).</span></span>

<span data-ttu-id="3ccdf-159">Sur Windows XP et versions ultérieures, le générateur de graphiques de DVD utilise toujours le [convertisseur de mixage vidéo 7](video-mixing-renderer-filter-7.md) (VMR-7), à moins que :</span><span class="sxs-lookup"><span data-stu-id="3ccdf-159">On Windows XP and later, the DVD Graph Builder always uses the [Video Mixing Renderer 7](video-mixing-renderer-filter-7.md) (VMR-7), unless:</span></span>

-   <span data-ttu-id="3ccdf-160">L’appelant interroge les interfaces qui ont trouvé uniquement le [mélangeur de superposition](overlay-mixer-filter.md), tel que [**IMixerPinConfig2**](/windows/desktop/api/Mpconfig/nn-mpconfig-imixerpinconfig2).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-160">The caller queries interfaces found only the [Overlay Mixer](overlay-mixer-filter.md), such as [**IMixerPinConfig2**](/windows/desktop/api/Mpconfig/nn-mpconfig-imixerpinconfig2).</span></span> <span data-ttu-id="3ccdf-161">Une indication est alors envoyée au générateur de graphiques DVD pour que l’application veuille utiliser le mélangeur de superposition et non VMR.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-161">This sends a hint to the DVD Graph Builder that the application wants to use the Overlay Mixer and not the VMR.</span></span> <span data-ttu-id="3ccdf-162">Le lecteur Windows Media dispose également d’une option de boîte de dialogue pour forcer l’utilisation du mélangeur de superposition.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-162">Windows Media Player also has a dialog box option to force the use of the Overlay Mixer.</span></span>
-   <span data-ttu-id="3ccdf-163">Le décodeur installé n’est pas compatible avec VMR.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-163">The installed decoder is not VMR-compatible.</span></span> <span data-ttu-id="3ccdf-164">Lors de la génération du graphique, la nouvelle interface [**IAMDecoderCaps**](/windows/desktop/api/Strmif/nn-strmif-iamdecodercaps) est utilisée pour vérifier la prise en charge VMR du décodeur.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-164">During graph building, the new [**IAMDecoderCaps**](/windows/desktop/api/Strmif/nn-strmif-iamdecodercaps) interface is used to check for the decoder's VMR support.</span></span> <span data-ttu-id="3ccdf-165">Si ce n’est pas le cas, le générateur de graphiques de DVD utilise le mélangeur de superposition.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-165">If that is not present, the DVD Graph Builder will use the Overlay Mixer.</span></span>
-   <span data-ttu-id="3ccdf-166">Lors de l’utilisation d’un décodeur matériel, le décodeur ne peut pas se connecter au [Gestionnaire de port vidéo](video-port-manager.md) (VPM).</span><span class="sxs-lookup"><span data-stu-id="3ccdf-166">While using a hardware decoder, the decoder cannot connect to the [Video Port Manager](video-port-manager.md) (VPM).</span></span> <span data-ttu-id="3ccdf-167">Si un décodeur matériel ne peut pas utiliser le VPM, il ne peut pas utiliser VMR, et par conséquent, le générateur de graphiques de DVD tente alors de créer un graphique à l’aide du mélangeur de superposition.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-167">If a hardware decoder cannot use the VPM, then it cannot use the VMR, and so the DVD Graph Builder then tries to build a graph using the Overlay Mixer.</span></span>
-   <span data-ttu-id="3ccdf-168">Les ressources et/ou les fonctionnalités de la carte d’affichage sont insuffisantes pour prendre en charge VMR, mais elles ne sont pas signalées correctement dans le pilote.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-168">The display card is known to have insufficient resources and/or capabilities to support the VMR but does not correctly report this in the driver.</span></span> <span data-ttu-id="3ccdf-169">(Certains cas connus sont spécifiquement exclus par le générateur de graphiques DVD.)</span><span class="sxs-lookup"><span data-stu-id="3ccdf-169">(Some known cases are specifically excluded by the DVD Graph Builder.)</span></span>
-   <span data-ttu-id="3ccdf-170">La connexion entre le décodeur et VMR échoue pour une raison quelconque, généralement en raison d’un manque de VRAM pour créer les surfaces nécessaires.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-170">The connection between the decoder and the VMR fails for any reason, usually due to a lack of VRAM to create the necessary surfaces.</span></span> <span data-ttu-id="3ccdf-171">Dans ce cas, le générateur de graphiques de DVD désactive l’utilisation de VMR et tente d’utiliser le mélangeur de superposition pour créer un graphique.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-171">In these cases, the DVD Graph Builder switches off VMR use and tries to use the Overlay Mixer to build a graph.</span></span>

<span data-ttu-id="3ccdf-172">Mode fenêtre</span><span class="sxs-lookup"><span data-stu-id="3ccdf-172">Windowed Mode</span></span>

<span data-ttu-id="3ccdf-173">En mode fenêtre (superposition mixer ou VMR), le convertisseur crée sa propre fenêtre vidéo.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-173">In windowed mode (Overlay Mixer or VMR), the renderer creates its own video window.</span></span> <span data-ttu-id="3ccdf-174">Pour faire de cette fenêtre un enfant de la fenêtre d’application, appelez [**IVideoWindow ::p ut \_ propriétaire**](/windows/desktop/api/Control/nf-control-ivideowindow-put_owner) avec un handle pour l’application.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-174">To make this window a child of the application window, call [**IVideoWindow::put\_Owner**](/windows/desktop/api/Control/nf-control-ivideowindow-put_owner) with a handle to the application.</span></span> <span data-ttu-id="3ccdf-175">Appelez également [**IVideoWindow ::p ut \_ WindowStyle**](/windows/desktop/api/Control/nf-control-ivideowindow-put_windowstyle) pour définir les \_ styles WS Child et WS \_ CLIPSIBLINGS dans la fenêtre vidéo du convertisseur.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-175">Also call [**IVideoWindow::put\_WindowStyle**](/windows/desktop/api/Control/nf-control-ivideowindow-put_windowstyle) to set the WS\_CHILD and WS\_CLIPSIBLINGS styles on the renderer's video window.</span></span> <span data-ttu-id="3ccdf-176">Pour obtenir des messages de souris à partir de la fenêtre vidéo du convertisseur, appelez [**IVideoWindow ::p ut \_ MessageDrain**](/windows/desktop/api/Control/nf-control-ivideowindow-put_messagedrain) avec un handle vers la fenêtre d’application.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-176">To get mouse messages from the renderer's video window, call [**IVideoWindow::put\_MessageDrain**](/windows/desktop/api/Control/nf-control-ivideowindow-put_messagedrain) with a handle to the application window.</span></span> <span data-ttu-id="3ccdf-177">Cette méthode configure un « drain de message »; la fenêtre vidéo transfère tous les messages de souris qu’elle reçoit vers la fenêtre drain de message.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-177">This method sets up a "message drain" — the video window forwards any mouse messages it receives to the message drain window.</span></span>


```C++
pVideoWindow->put_Owner((OAHWND)hwnd);
pVideoWindow->put_WindowStyle(WS_CHILD | WS_CLIPSIBLINGS);
pVideoWindow->put_MessageDrain((OAHWND)hwnd) ;
```



<span data-ttu-id="3ccdf-178">Le vidage des messages permet de sélectionner des boutons de menu DVD quelque peu compliqués.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-178">The message drain makes selecting DVD menu buttons somewhat complicated.</span></span> <span data-ttu-id="3ccdf-179">En supposant que la fenêtre vidéo ne remplit pas l’intégralité de la zone cliente de l’application, certains événements de souris se situent en dehors de la fenêtre vidéo.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-179">Assuming the video window does not fill the application's entire client area, some mouse events will fall outside the video window.</span></span> <span data-ttu-id="3ccdf-180">Quand vous recevez un événement de souris *à partir de* la fenêtre vidéo, vous devez le traiter pour la navigation dans les menus DVD.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-180">When you get a mouse event from *inside* the video window, you should process it for DVD menu navigation.</span></span> <span data-ttu-id="3ccdf-181">Les événements de souris *en dehors* de la fenêtre vidéo ne doivent pas être traités.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-181">Mouse events from *outside* the video window should not be processed.</span></span> <span data-ttu-id="3ccdf-182">Avec la vidange de message, il n’existe aucun moyen de faire la distinction entre les deux.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-182">With the message drain, there is no way to distinguish between the two.</span></span> <span data-ttu-id="3ccdf-183">En outre, les coordonnées des événements de souris de la fenêtre vidéo sont relatives à la zone cliente de la fenêtre vidéo. Toutefois, les événements de souris en dehors de la fenêtre vidéo sont relatifs à la zone cliente de l’application.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-183">Furthermore, the coordinates for mouse events from the video window are relative to the video window's client area; but mouse events from outside the video window are relative to the application's client area.</span></span>

<span data-ttu-id="3ccdf-184">Mode sans fenêtre</span><span class="sxs-lookup"><span data-stu-id="3ccdf-184">Windowless Mode</span></span>

<span data-ttu-id="3ccdf-185">Le mode sans fenêtre évite les problèmes liés aux messages de la souris.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-185">Windowless mode avoids the problems with mouse messages altogether.</span></span> <span data-ttu-id="3ccdf-186">Vous n’avez pas besoin d’un drain de message, car VMR (ou EVR) ne crée pas sa propre fenêtre en mode sans fenêtre.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-186">You do not need a message drain, because the VMR (or EVR) does not create its own window in windowless mode.</span></span> <span data-ttu-id="3ccdf-187">Au lieu de cela, il crée directement dans la fenêtre de votre application.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-187">Instead, it draws directly onto your application window.</span></span> <span data-ttu-id="3ccdf-188">Si le rectangle de destination est plus petit que la zone cliente de l’application, le navigateur DVD prend cela en compte lorsqu’il calcule les positions du bouton DVD.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-188">If the destination rectangle is smaller than the application client area, the DVD Navigator takes this into account when it calculates the DVD button positions.</span></span> <span data-ttu-id="3ccdf-189">Par conséquent, lorsque vous recevez un message de souris, vous pouvez transmettre les coordonnées directement au navigateur DVD, comme décrit dans la section navigation dans les menus.</span><span class="sxs-lookup"><span data-stu-id="3ccdf-189">Therefore, when you get a mouse message, you can pass the coordinates directly to the DVD Navigator, as described in the section Menu Navigation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3ccdf-190">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="3ccdf-190">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3ccdf-191">Applications DVD</span><span class="sxs-lookup"><span data-stu-id="3ccdf-191">DVD Applications</span></span>](dvd-applications.md)
</dt> </dl>

 

 
