---
description: VMR avec plusieurs flux (mode de mixage)
ms.assetid: 053edb70-8631-4fe4-a137-2fe54e02ab9e
title: VMR avec plusieurs flux (mode de mixage)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a21a954b0ad78afbceabf0fde493f920961b90dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106543514"
---
# <a name="vmr-with-multiple-streams-mixing-mode"></a><span data-ttu-id="b2335-103">VMR avec plusieurs flux (mode de mixage)</span><span class="sxs-lookup"><span data-stu-id="b2335-103">VMR with Multiple Streams (Mixing Mode)</span></span>

<span data-ttu-id="b2335-104">VMR peut afficher plusieurs flux d’entrée.</span><span class="sxs-lookup"><span data-stu-id="b2335-104">The VMR can render multiple input streams.</span></span> <span data-ttu-id="b2335-105">Dans cette configuration, appelée mode de mixage, VMR charge son mélangeur et son compositeur pour effectuer le mixage et la fusion avant le rendu.</span><span class="sxs-lookup"><span data-stu-id="b2335-105">In this configuration, called mixing mode, the VMR loads its mixer and compositor to perform the mixing and blending prior to rendering.</span></span> <span data-ttu-id="b2335-106">Le mode de mixage peut être utilisé soit lorsque VMR est en mode fenêtre, soit en mode sans fenêtre.</span><span class="sxs-lookup"><span data-stu-id="b2335-106">Mixing mode can be used either while the VMR is in windowed mode or windowless mode.</span></span>

<span data-ttu-id="b2335-107">Le mode de mixage requiert que le pilote Graphics prenne en charge les \_ indicateurs de capacité DDCAPS BLTFOURCC et DDCAPS \_ BLTSTRETCH (respectivement la conversion d’espace colorimétrique et l’étirement blitting).</span><span class="sxs-lookup"><span data-stu-id="b2335-107">Mixing mode requires that the graphics driver supports the DDCAPS\_BLTFOURCC and DDCAPS\_BLTSTRETCH capability flags (color space conversion and stretch blitting, respectively).</span></span> <span data-ttu-id="b2335-108">Presque tous les nouveaux pilotes graphiques ont ces fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="b2335-108">Almost all new graphics drivers have those capabilities.</span></span> <span data-ttu-id="b2335-109">En outre, le pilote doit prendre en charge la création de cibles de rendu Direct3D pour la profondeur de pixel d’affichage actuelle.</span><span class="sxs-lookup"><span data-stu-id="b2335-109">In addition, the driver must support the creation of Direct3D render targets for the current display pixel depth.</span></span> <span data-ttu-id="b2335-110">Certains appareils ne prennent pas en charge les opérations Direct3D lorsque l’affichage est défini sur 24 bits par pixel.</span><span class="sxs-lookup"><span data-stu-id="b2335-110">Some devices do not support Direct3D operations when the display is set to 24 bits per pixel.</span></span> <span data-ttu-id="b2335-111">Pour plus d’informations, consultez la documentation du kit SDK DirectX Graphics.</span><span class="sxs-lookup"><span data-stu-id="b2335-111">For more information, see the DirectX Graphics SDK documentation.</span></span>

> [!Note]  
> <span data-ttu-id="b2335-112">Lorsque VMR mélange plusieurs flux vidéo, le graphique de filtre ne se recherche pas correctement.</span><span class="sxs-lookup"><span data-stu-id="b2335-112">When the VMR mixes multiple video streams, the filter graph does not seek correctly.</span></span> <span data-ttu-id="b2335-113">Si vous avez besoin de Rechercher plusieurs flux vidéo, vous devez créer des graphiques de filtres distincts qui partagent le même objet Allocator-Presenter personnalisé.</span><span class="sxs-lookup"><span data-stu-id="b2335-113">If you need to seek multiple video streams, you must create separate filter graphs that share the same custom allocator-presenter object.</span></span>

 

<span data-ttu-id="b2335-114">**Configuration de VMR-7 pour plusieurs flux**</span><span class="sxs-lookup"><span data-stu-id="b2335-114">**Configuring the VMR-7 for Multiple Streams**</span></span>

<span data-ttu-id="b2335-115">Pour afficher plusieurs flux d’entrée avec VMR-7, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="b2335-115">To render multiple input streams with the VMR-7, do the following:</span></span>

1.  <span data-ttu-id="b2335-116">Avant de connecter les broches d’entrée de VMR, appelez la méthode [**IVMRFilterConfig :: SetNumberOfStreams**](/windows/desktop/api/Strmif/nf-strmif-ivmrfilterconfig-setnumberofstreams) avec le nombre de flux.</span><span class="sxs-lookup"><span data-stu-id="b2335-116">Before connecting any of the VMR's input pins, call the [**IVMRFilterConfig::SetNumberOfStreams**](/windows/desktop/api/Strmif/nf-strmif-ivmrfilterconfig-setnumberofstreams) method with the number of streams.</span></span> <span data-ttu-id="b2335-117">Ainsi, VMR charge le mélangeur et le compositeur et crée le nombre spécifié de broches d’entrée.</span><span class="sxs-lookup"><span data-stu-id="b2335-117">This causes the VMR to load the mixer and compositor and to create the specified number of input pins.</span></span>
2.  <span data-ttu-id="b2335-118">Appelez [**IVMRFilterConfig :: SetRenderingPrefs**](/windows/desktop/api/Strmif/nf-strmif-ivmrfilterconfig-setrenderingprefs) pour spécifier diverses préférences de rendu.</span><span class="sxs-lookup"><span data-stu-id="b2335-118">Call [**IVMRFilterConfig::SetRenderingPrefs**](/windows/desktop/api/Strmif/nf-strmif-ivmrfilterconfig-setrenderingprefs) to specify various rendering preferences.</span></span>
3.  <span data-ttu-id="b2335-119">Connectez les broches aux filtres en amont.</span><span class="sxs-lookup"><span data-stu-id="b2335-119">Connect the pins to the upstream filters.</span></span> <span data-ttu-id="b2335-120">Le moyen le plus simple consiste à appeler [**IGraphBuilder :: RenderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile) pour chaque flux d’entrée.</span><span class="sxs-lookup"><span data-stu-id="b2335-120">The easiest way to do this is to call [**IGraphBuilder::RenderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile) for each input stream.</span></span> <span data-ttu-id="b2335-121">Si la broche de sortie sur le filtre amont (généralement un décodeur) et que la broche d’entrée sur VMR ne peut pas s’accorder sur une connexion, une nouvelle instance de VMR avec les paramètres par défaut est créée.</span><span class="sxs-lookup"><span data-stu-id="b2335-121">If the output pin on the upstream filter (usually a decoder) and the input pin on the VMR cannot agree on a connection, then a new instance of the VMR with default settings will be created.</span></span> <span data-ttu-id="b2335-122">Cela génère une nouvelle fenêtre avec « ActiveMovie » dans la barre de titre.</span><span class="sxs-lookup"><span data-stu-id="b2335-122">This will result in a new window with "ActiveMovie" in the title bar.</span></span> <span data-ttu-id="b2335-123">Pour éviter ce problème, l’application doit toujours vérifier que l’instance appropriée de VMR est utilisée en appelant une méthode telle que [**IPIN :: ConnectedTo**](/windows/desktop/api/Strmif/nf-strmif-ipin-connectedto).</span><span class="sxs-lookup"><span data-stu-id="b2335-123">To prevent this from happening, the application should always verify that the correct instance of the VMR is being used by calling a method such as [**IPin::ConnectedTo**](/windows/desktop/api/Strmif/nf-strmif-ipin-connectedto).</span></span> <span data-ttu-id="b2335-124">Une autre option consiste à ajouter le filtre source, puis à connecter les codes confidentiels à l’aide de **IGraphBuilder :: Connect**.</span><span class="sxs-lookup"><span data-stu-id="b2335-124">Another option is to add the source filter and then connect the pins using **IGraphBuilder::Connect**.</span></span>
4.  <span data-ttu-id="b2335-125">Utilisez l’interface [**IVMRMixerControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) sur VMR pour contrôler les paramètres de chaque flux, tels que la valeur alpha, l’ordre de plan et le rectangle de sortie.</span><span class="sxs-lookup"><span data-stu-id="b2335-125">Use the [**IVMRMixerControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) interface on the VMR to control parameters for each stream, such as the alpha value, the Z-ordering, and the output rectangle.</span></span>
5.  <span data-ttu-id="b2335-126">Exécutez le graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="b2335-126">Run the filter graph.</span></span>

<span data-ttu-id="b2335-127">**Configuration de VMR-9 pour plusieurs flux**</span><span class="sxs-lookup"><span data-stu-id="b2335-127">**Configuring the VMR-9 for Multiple Streams**</span></span>

<span data-ttu-id="b2335-128">Par défaut, VMR-9 crée quatre broches d’entrée.</span><span class="sxs-lookup"><span data-stu-id="b2335-128">By default, the VMR-9 creates four input pins.</span></span> <span data-ttu-id="b2335-129">Si vous souhaitez mélanger plus de quatre flux vidéo, appelez [**IVMRFilterConfig9 :: SetNumberOfStreams**](/previous-versions/windows/desktop/api/Vmr9/nf-vmr9-ivmrfilterconfig9-setnumberofstreams) avant de connecter des broches d’entrée.</span><span class="sxs-lookup"><span data-stu-id="b2335-129">If you want to mix more than four video streams, call [**IVMRFilterConfig9::SetNumberOfStreams**](/previous-versions/windows/desktop/api/Vmr9/nf-vmr9-ivmrfilterconfig9-setnumberofstreams) before connecting any input pins.</span></span> <span data-ttu-id="b2335-130">Utilisez l’interface [**IVMRMixerControl9**](/previous-versions/windows/desktop/api/Vmr9/nn-vmr9-ivmrmixercontrol9) pour définir les paramètres de flux, tels que alpha, ordre de plan et position.</span><span class="sxs-lookup"><span data-stu-id="b2335-130">Use the [**IVMRMixerControl9**](/previous-versions/windows/desktop/api/Vmr9/nn-vmr9-ivmrmixercontrol9) interface to set the stream parameters, such as alpha, Z-order, and position.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b2335-131">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="b2335-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b2335-132">Utilisation du mode de mixage VMR</span><span class="sxs-lookup"><span data-stu-id="b2335-132">Using VMR Mixing Mode</span></span>](using-vmr-mixing-mode.md)
</dt> </dl>

 

 



