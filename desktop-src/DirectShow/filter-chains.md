---
description: Chaînes de filtre
ms.assetid: c17b3b58-65ab-4e83-91f2-54a995f22ddf
title: Chaînes de filtre
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d46e374aca71b024773e4177d09e67c7ee6034ac
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "103846598"
---
# <a name="filter-chains"></a><span data-ttu-id="e7bf0-103">Chaînes de filtre</span><span class="sxs-lookup"><span data-stu-id="e7bf0-103">Filter Chains</span></span>

<span data-ttu-id="e7bf0-104">Une *chaîne de filtre* est une séquence de filtres qui remplit les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="e7bf0-104">A *filter chain* is a sequence of filters that meets the following conditions:</span></span>

-   <span data-ttu-id="e7bf0-105">Chaque filtre de la chaîne a au plus une broche d’entrée connectée et une broche de sortie connectée.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-105">Each filter in the chain has at most one connected input pin and one connected output pin.</span></span>
-   <span data-ttu-id="e7bf0-106">Il est possible de traverser chaque filtre de la chaîne sans traverser les filtres en dehors de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-106">It is possible to traverse every filter in the chain without traversing filters outside the chain.</span></span>

<span data-ttu-id="e7bf0-107">Par exemple, dans le diagramme suivant, les filtres A – B, C – D et F – G-H sont des chaînes de filtre.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-107">For example, in the following diagram, filters A–B, C–D, and F–G–H are filter chains.</span></span> <span data-ttu-id="e7bf0-108">Chaque sous-chaîne dans F – G – H (F – G et G – H) est également une chaîne de filtres.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-108">Each subchain in F–G–H (F–G and G–H) is also a filter chain.</span></span> <span data-ttu-id="e7bf0-109">Une chaîne de filtres peut se composer d’un filtre unique. les filtres A, B, C, D, F, G et H sont donc également des chaînes de filtre distinctes.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-109">A filter chain can consist of a single filter, so filters A, B, C, D, F, G, and H are also distinct filter chains.</span></span> <span data-ttu-id="e7bf0-110">Le filtre E a deux connexions d’entrée, donc toute séquence de filtres incluant le filtre E n’est pas une chaîne de filtres.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-110">Filter E has two input connections, so any sequence of filters that includes filter E is not a filter chain.</span></span>

![chaîne de filtre (exemple 1)](images/filter-chain1.png)

<span data-ttu-id="e7bf0-112">L’interface [**IFilterChain**](/windows/desktop/api/Strmif/nn-strmif-ifilterchain) fournit les méthodes suivantes pour contrôler les chaînes de filtre :</span><span class="sxs-lookup"><span data-stu-id="e7bf0-112">The [**IFilterChain**](/windows/desktop/api/Strmif/nn-strmif-ifilterchain) interface provides the following methods for controlling filter chains:</span></span>



|                                                               |                                 |
|---------------------------------------------------------------|---------------------------------|
| [<span data-ttu-id="e7bf0-113">**IFilterChain::StartChain**</span><span class="sxs-lookup"><span data-stu-id="e7bf0-113">**IFilterChain::StartChain**</span></span>](/windows/desktop/api/Strmif/nf-strmif-ifilterchain-startchain)   | <span data-ttu-id="e7bf0-114">Démarre une chaîne.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-114">Starts a chain.</span></span>                 |
| [<span data-ttu-id="e7bf0-115">**IFilterChain::StopChain**</span><span class="sxs-lookup"><span data-stu-id="e7bf0-115">**IFilterChain::StopChain**</span></span>](/windows/desktop/api/Strmif/nf-strmif-ifilterchain-stopchain)     | <span data-ttu-id="e7bf0-116">Arrête une chaîne.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-116">Stops a chain.</span></span>                  |
| [<span data-ttu-id="e7bf0-117">**IFilterChain ::P auseChain**</span><span class="sxs-lookup"><span data-stu-id="e7bf0-117">**IFilterChain::PauseChain**</span></span>](/windows/desktop/api/Strmif/nf-strmif-ifilterchain-pausechain)   | <span data-ttu-id="e7bf0-118">Suspend une chaîne.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-118">Pauses a chain.</span></span>                 |
| [<span data-ttu-id="e7bf0-119">**IFilterChain::RemoveChain**</span><span class="sxs-lookup"><span data-stu-id="e7bf0-119">**IFilterChain::RemoveChain**</span></span>](/windows/desktop/api/Strmif/nf-strmif-ifilterchain-removechain) | <span data-ttu-id="e7bf0-120">Supprime une chaîne du graphique.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-120">Removes a chain from the graph.</span></span> |



 

<span data-ttu-id="e7bf0-121">Il n’existe aucune méthode spécifique pour ajouter une chaîne.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-121">There is no specific method for adding a chain.</span></span> <span data-ttu-id="e7bf0-122">Pour ajouter une chaîne, insérez les nouveaux filtres à l’aide de la méthode [**IFilterGraph :: AddFilter**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-addfilter) .</span><span class="sxs-lookup"><span data-stu-id="e7bf0-122">To add a chain, insert the new filters using the [**IFilterGraph::AddFilter**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-addfilter) method.</span></span> <span data-ttu-id="e7bf0-123">Ensuite, connectez les filtres en appelant [**IGraphBuilder :: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect), [**IGraphBuilder :: Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render)ou des méthodes similaires.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-123">Then connect the filters by calling [**IGraphBuilder::Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect), [**IGraphBuilder::Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render), or similar methods.</span></span>

<span data-ttu-id="e7bf0-124">Lorsque le graphique est en cours d’exécution, une chaîne de filtres peut basculer entre l’exécution et l’arrêt.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-124">When the graph is running, a filter chain can switch between running and stopped.</span></span> <span data-ttu-id="e7bf0-125">Lorsque le graphique est suspendu, il peut passer de l’état suspendu à l’état arrêté.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-125">When the graph is paused, it can switch between paused and stopped.</span></span> <span data-ttu-id="e7bf0-126">Il s’agit des seules transitions d’État possibles avec les chaînes de filtre.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-126">These are the only state transitions possible with filter chains.</span></span>

## <a name="filter-chain-guidelines"></a><span data-ttu-id="e7bf0-127">Instructions relatives à la chaîne de filtre</span><span class="sxs-lookup"><span data-stu-id="e7bf0-127">Filter Chain Guidelines</span></span>

<span data-ttu-id="e7bf0-128">Lorsque vous utilisez des méthodes **IFilterChain** , il est important de s’assurer que les filtres du graphique peuvent prendre en charge les opérations de chaînage de filtres.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-128">When you use **IFilterChain** methods, it is important to make sure that the filters in the graph can support filter chaining operations.</span></span> <span data-ttu-id="e7bf0-129">Dans le cas contraire, vous risquez de provoquer des blocages ou des erreurs de graphe.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-129">Otherwise, you might cause deadlocks or graph errors.</span></span> <span data-ttu-id="e7bf0-130">Les filtres connectés à la chaîne doivent fonctionner correctement après la modification de l’état de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-130">Filters connected to the chain must function correctly after the chain changes state.</span></span>

<span data-ttu-id="e7bf0-131">La meilleure façon d’utiliser **IFilterChain** est d’utiliser un ensemble de filtres que vous avez spécifiquement conçus pour le chaînage.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-131">The best way to use **IFilterChain** is with a set of filters that you have designed specifically for chaining.</span></span> <span data-ttu-id="e7bf0-132">Suivez les indications ci-dessous pour vous assurer que vos filtres sont sécurisés pour les opérations de chaîne de filtre.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-132">Use the following guidelines to ensure that your filters are safe for filter chain operations.</span></span> <span data-ttu-id="e7bf0-133">Ces points font référence au diagramme suivant.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-133">These points refer to the following diagram.</span></span>

![chaîne de filtre (exemple 2)](images/filter-chain2.png)

-   <span data-ttu-id="e7bf0-135">Avant la modification de l’état de la chaîne de filtre, tous les appels de traitement des données à la limite de la chaîne de filtre doivent être terminés.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-135">Before the filter chain's state changes, all data processing calls at the boundary of the filter chain must be completed.</span></span> <span data-ttu-id="e7bf0-136">Cette règle s’applique aux méthodes [**IMemInputPin :: Receive**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receive), [**IPIN :: NewSegment**](/windows/desktop/api/Strmif/nf-strmif-ipin-newsegment)et [**IPIN :: EndOfStream**](/windows/desktop/api/Strmif/nf-strmif-ipin-endofstream).</span><span class="sxs-lookup"><span data-stu-id="e7bf0-136">This rule applies to the methods [**IMemInputPin::Receive**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receive), [**IPin::NewSegment**](/windows/desktop/api/Strmif/nf-strmif-ipin-newsegment), and [**IPin::EndOfStream**](/windows/desktop/api/Strmif/nf-strmif-ipin-endofstream).</span></span> <span data-ttu-id="e7bf0-137">Les filtres de la chaîne doivent retourner des appels à ces méthodes effectuées par les filtres en dehors de la chaîne ; les filtres en dehors de la chaîne doivent retourner des appels effectués par des filtres au sein de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-137">Filters in the chain must return from calls to these methods made by filters outside the chain; and filters outside the chain must return from calls made by filters within the chain.</span></span>

<span data-ttu-id="e7bf0-138">Par exemple, dans le diagramme précédent, le filtre B doit effectuer tous les appels de traitement de données à partir du filtre A, et le filtre E doit terminer tous les appels du filtre D. Si les codes confidentiels exposent les interfaces [**IPinFlowControl**](/windows/desktop/api/Strmif/nn-strmif-ipinflowcontrol) et [**IPinConnection**](/windows/desktop/api/Strmif/nn-strmif-ipinconnection) , vous pouvez envoyer les données à travers le graphique en appelant les méthodes [**IPinFlowControl :: Block**](/windows/desktop/api/Strmif/nf-strmif-ipinflowcontrol-block) et [**IGraphConfig ::P Ushthroughdata**](/windows/desktop/api/Strmif/nf-strmif-igraphconfig-pushthroughdata) , comme décrit dans [reconnexion dynamique](dynamic-reconnection.md).</span><span class="sxs-lookup"><span data-stu-id="e7bf0-138">For example, in the previous diagram, filter B must complete any data processing calls from filter A, and filter E must finish any calls from filter D. If the pins expose the [**IPinFlowControl**](/windows/desktop/api/Strmif/nn-strmif-ipinflowcontrol) and [**IPinConnection**](/windows/desktop/api/Strmif/nn-strmif-ipinconnection) interfaces, you can push the data through the graph by calling the [**IPinFlowControl::Block**](/windows/desktop/api/Strmif/nf-strmif-ipinflowcontrol-block) and [**IGraphConfig::PushThroughData**](/windows/desktop/api/Strmif/nf-strmif-igraphconfig-pushthroughdata) methods, as described in [Dynamic Reconnection](dynamic-reconnection.md).</span></span> <span data-ttu-id="e7bf0-139">Les filtres peuvent également prendre en charge des méthodes privées pour le push des données.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-139">Filters might also support private methods for pushing the data.</span></span>

-   <span data-ttu-id="e7bf0-140">Les filtres en amont doivent s’attendre à ce que l’état de la chaîne change.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-140">Upstream filters must expect the chain's state to change.</span></span> <span data-ttu-id="e7bf0-141">Par exemple, dans le diagramme précédent, supposons que la chaîne soit arrêtée mais filtre un appel à **IMemInputPin :: Receive**.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-141">For example, in the previous diagram, suppose the chain is stopped but filter A calls **IMemInputPin::Receive**.</span></span> <span data-ttu-id="e7bf0-142">L’appel échoue et la réponse du filtre A consiste à arrêter la diffusion en continu.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-142">The call fails and the response of filter A is to stop streaming.</span></span> <span data-ttu-id="e7bf0-143">Lorsque l’application redémarre la chaîne, elle n’a aucun effet, car le filtre A ne diffuse plus de données.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-143">When the application restarts the chain, it has no effect because filter A is no longer streaming data.</span></span>
-   <span data-ttu-id="e7bf0-144">Les filtres en aval doivent également s’attendre à ce que l’état de la chaîne change.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-144">Downstream filters must also expect the chain's state to change.</span></span> <span data-ttu-id="e7bf0-145">Si ce n’est pas le cas, le filtre en aval peut se bloquer pendant qu’il attend des exemples qui n’arrivent jamais.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-145">If not, the downstream filter might block while it waits for samples that never arrive.</span></span> <span data-ttu-id="e7bf0-146">Par exemple, les filtres multiplexeur (MUX) requièrent souvent des données provenant de toutes leurs broches d’entrée.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-146">For example, multiplexer (MUX) filters often require data from all of their input pins.</span></span> <span data-ttu-id="e7bf0-147">L’arrêt du flux de données à partir d’une broche d’entrée peut empêcher le traitement des autres flux.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-147">Halting the flow of data from one input pin might block the other streams from processing.</span></span> <span data-ttu-id="e7bf0-148">Cela peut entraîner un blocage du graphique.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-148">This can cause the graph to deadlock.</span></span>
-   <span data-ttu-id="e7bf0-149">Chaque connexion de code confidentiel d’un filtre en dehors de la chaîne à un filtre au sein de la chaîne doit avoir son propre allocateur, qui n’est pas partagé par d’autres connexions.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-149">Each pin connection from a filter outside the chain to a filter within the chain should have its own allocator, which is not shared by other connections.</span></span> <span data-ttu-id="e7bf0-150">Lorsque la chaîne change d’État ou est supprimée du graphique, l’allocateur peut être dévalidée.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-150">When the chain changes state or is removed from the graph, the allocator might be decommitted.</span></span> <span data-ttu-id="e7bf0-151">Si d’autres connexions utilisent le même allocateur, elles ne peuvent plus traiter des exemples.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-151">If other connections were using the same allocator, they can no longer process samples.</span></span>
-   <span data-ttu-id="e7bf0-152">Ne supprimez pas une chaîne à moins que les filtres connectés à la chaîne ne prennent en charge la déconnexion dynamique.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-152">Do not remove a chain unless the filters connected to the chain support dynamic disconnection.</span></span> <span data-ttu-id="e7bf0-153">En règle générale, les filtres connectés prennent en charge l’interface **IPinConnection** ou **IPinFlowControl** , mais peuvent prendre en charge des interfaces privées à la place.</span><span class="sxs-lookup"><span data-stu-id="e7bf0-153">Typically, the connected filters will support the **IPinConnection** or **IPinFlowControl** interface, but might support private interfaces instead.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e7bf0-154">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e7bf0-154">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e7bf0-155">Génération de graphiques dynamiques</span><span class="sxs-lookup"><span data-stu-id="e7bf0-155">Dynamic Graph Building</span></span>](dynamic-graph-building.md)
</dt> </dl>

 

 



