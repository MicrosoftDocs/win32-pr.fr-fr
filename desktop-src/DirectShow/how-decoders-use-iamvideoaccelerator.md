---
description: Comment les décodeurs utilisent IAMVideoAccelerator
ms.assetid: 0bc6b65b-4502-4c6f-a0f2-82a2bd444d1d
title: Comment les décodeurs utilisent IAMVideoAccelerator
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 436768b3561a999f6708ef4f6438b816e0ad303b
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "103949963"
---
# <a name="how-decoders-use-iamvideoaccelerator"></a><span data-ttu-id="729bc-103">Comment les décodeurs utilisent IAMVideoAccelerator</span><span class="sxs-lookup"><span data-stu-id="729bc-103">How Decoders Use IAMVideoAccelerator</span></span>

<span data-ttu-id="729bc-104">L’interface [**IAMVideoAccelerator**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator) active les opérations d’accélération vidéo génériques, y compris l’accélération vidéo DirectX (va).</span><span class="sxs-lookup"><span data-stu-id="729bc-104">The [**IAMVideoAccelerator**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator) interface enables generic video acceleration operations, including DirectX Video Acceleration (VA).</span></span> <span data-ttu-id="729bc-105">Pour l’accélération non DirectX VA, le décodeur et le pilote vidéo doivent tous deux adhérer à un protocole commun.</span><span class="sxs-lookup"><span data-stu-id="729bc-105">For non-DirectX VA acceleration, the decoder and video driver must both adhere to a common protocol.</span></span>

<span data-ttu-id="729bc-106">Cette section décrit l’ordre général des opérations que tout décodeur doit suivre lors de l’utilisation de cette interface.</span><span class="sxs-lookup"><span data-stu-id="729bc-106">This section describes the general order of operations that any decoder should follow when using this interface.</span></span> <span data-ttu-id="729bc-107">Pour plus d’informations sur les décodeurs DirectX basés sur VA, consultez [mappage de l’accélération vidéo DirectX à IAMVideoAccelerator](mapping-directx-video-acceleration-to-iamvideoaccelerator.md).</span><span class="sxs-lookup"><span data-stu-id="729bc-107">Further information specific to DirectX VA-based decoders can be found in [Mapping DirectX Video Acceleration to IAMVideoAccelerator](mapping-directx-video-acceleration-to-iamvideoaccelerator.md).</span></span>

> [!Note]  
> <span data-ttu-id="729bc-108">Cette interface est disponible dans Windows 2000 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="729bc-108">This interface is available in Windows 2000 and later.</span></span>

 

<span data-ttu-id="729bc-109">L’interface [**IAMVideoAccelerator**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator) est exposée sur la broche d’entrée du [mélangeur de superposition](overlay-mixer-filter.md) ou du convertisseur de mixage vidéo (VMR).</span><span class="sxs-lookup"><span data-stu-id="729bc-109">The [**IAMVideoAccelerator**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator) interface is exposed on the input pin of the [Overlay Mixer](overlay-mixer-filter.md) or Video Mixing Renderer (VMR).</span></span> <span data-ttu-id="729bc-110">L’interface [**IAMVideoAcceleratorNotify**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoacceleratornotify) est exposée sur la broche de sortie du décodeur.</span><span class="sxs-lookup"><span data-stu-id="729bc-110">The [**IAMVideoAcceleratorNotify**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoacceleratornotify) interface is exposed on the decoder's output pin.</span></span> <span data-ttu-id="729bc-111">La séquence d’événements pour la connexion des codes confidentiels du filtre est la suivante :</span><span class="sxs-lookup"><span data-stu-id="729bc-111">The sequence of events for connecting the filter pins is as follows:</span></span>

1.  <span data-ttu-id="729bc-112">Le gestionnaire de graphique de filtre appelle [**IPIN :: Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) sur la broche de sortie du filtre de décodeur.</span><span class="sxs-lookup"><span data-stu-id="729bc-112">The Filter Graph Manager calls [**IPin::Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) on the decoder filter's output pin.</span></span> <span data-ttu-id="729bc-113">Un [**\_ \_ type de média am**](/windows/win32/api/strmif/ns-strmif-am_media_type) est un paramètre facultatif.</span><span class="sxs-lookup"><span data-stu-id="729bc-113">An [**AM\_MEDIA\_TYPE**](/windows/win32/api/strmif/ns-strmif-am_media_type) is an optional parameter.</span></span>
    -   <span data-ttu-id="729bc-114">[**Am \_ Le \_ type de média**](/windows/win32/api/strmif/ns-strmif-am_media_type) est une structure de données qui décrit un type de média.</span><span class="sxs-lookup"><span data-stu-id="729bc-114">[**AM\_MEDIA\_TYPE**](/windows/win32/api/strmif/ns-strmif-am_media_type) is a data structure that describes a type of media.</span></span> <span data-ttu-id="729bc-115">Il contient un GUID MajorType (qui, dans notre cas, doit être une \_ vidéo MediaType), un GUID de sous-type (qui, dans notre cas, doit être un GUID d’accélérateur vidéo) et un grand nombre d’autres choses.</span><span class="sxs-lookup"><span data-stu-id="729bc-115">It contains a majortype GUID (which in our case should be MEDIATYPE\_Video), a subtype GUID (which in our case should be a video accelerator GUID), and a variety of other things.</span></span> <span data-ttu-id="729bc-116">L’un de ces éléments est un GUID de type de format contenant des informations sur le support, y compris dans notre cas la largeur et la hauteur d’une image vidéo non compressée, le plus souvent dans une structure [**MPEG1VIDEOINFO**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-mpeg1videoinfo), [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader), [**MPEG2VIDEOINFO**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-mpeg2videoinfo)ou [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) .</span><span class="sxs-lookup"><span data-stu-id="729bc-116">One of those things is a format type GUID containing information about the media, including in our case the width and height of an uncompressed video picture, most likely in an [**MPEG1VIDEOINFO**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-mpeg1videoinfo), [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader), [**MPEG2VIDEOINFO**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-mpeg2videoinfo), or [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) structure.</span></span>
    -   <span data-ttu-id="729bc-117">Le cas échéant, la structure du [**\_ \_ type de média**](/windows/win32/api/strmif/ns-strmif-am_media_type) indique au décodeur qu’il doit fonctionner à l’aide du type de média spécifié, qui peut être « entièrement spécifié » ou « partiellement spécifié ».</span><span class="sxs-lookup"><span data-stu-id="729bc-117">The [**AM\_MEDIA\_TYPE**](/windows/win32/api/strmif/ns-strmif-am_media_type) structure, if present, tells the decoder to operate using the specified media type, which may be "fully specified" or "partially specified".</span></span> <span data-ttu-id="729bc-118">Si « entièrement spécifié », le décodeur tente normalement de fonctionner avec ce type de média.</span><span class="sxs-lookup"><span data-stu-id="729bc-118">If "fully specified," the decoder would normally simply attempt to operate with that media type.</span></span> <span data-ttu-id="729bc-119">Si « partiellement spécifié », il tente de trouver un mode d’opération compatible « entièrement spécifié » qu’il peut utiliser pour se connecter de manière cohérente avec le type de média « partiellement spécifié ».</span><span class="sxs-lookup"><span data-stu-id="729bc-119">If "partially specified," it will attempt to find a "fully-specified" compatible mode of operation that it can use to connect in a manner consistent with the "partially-specified" media type.</span></span>
    -   <span data-ttu-id="729bc-120">Pour tenter de trouver un type de média « entièrement spécifié » à utiliser pour une connexion, il suffit d’exécuter une liste de chaque type de média « entièrement spécifié » que la broche de sortie prend en charge, ce qui est compatible avec le type de média « partiellement spécifié » et de tenter de se connecter à chacun d’eux jusqu’à ce qu’il réussisse.</span><span class="sxs-lookup"><span data-stu-id="729bc-120">The ordinary manner for attempting to find a "fully-specified" media type to use for a connection is to simply run through a list of every "fully-specified" media type that the output pin supports which is compatible with the "partially-specified" media type and attempt to connect with each of them until successful.</span></span> <span data-ttu-id="729bc-121">Le processus est normalement similaire si aucun \_ \_ type de média am n’est contenu dans l’appel de [**IPIN :: Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) , mais avec la broche de sortie qui doit vérifier tous ses types de média.</span><span class="sxs-lookup"><span data-stu-id="729bc-121">The process would normally be similar if no AM\_MEDIA\_TYPE is contained in the [**IPin::Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) call, but with the output pin needing to check all of its media types.</span></span>
2.  <span data-ttu-id="729bc-122">Si le décodeur souhaite vérifier si un [**\_ \_ type de média am**](/windows/win32/api/strmif/ns-strmif-am_media_type) spécifique (y compris un GUID d’accélérateur vidéo) est pris en charge par la broche d’entrée en aval, il peut appeler [**IPIN :: QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) (avec le GUID de l’accélérateur vidéo comme sous-type du **\_ média am \_**) ou il peut simplement essayer de se connecter à ce code confidentiel comme décrit dans le point 5 ci-dessous</span><span class="sxs-lookup"><span data-stu-id="729bc-122">If the decoder wants to check whether a specific [**AM\_MEDIA\_TYPE**](/windows/win32/api/strmif/ns-strmif-am_media_type) (including a video accelerator GUID) is supported by the downstream input pin, it can call that pin's [**IPin::QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) (with the video accelerator GUID as the subtype of the **AM\_MEDIA\_TYPE**) or it can simply attempt to connect to that pin as described in item 5 below.</span></span>
3.  <span data-ttu-id="729bc-123">Si le décodeur ne connaît pas les GUID d’accélérateur vidéo pris en charge par la broche d’entrée en aval et ne souhaite pas proposer simplement un GUID d’accélérateur vidéo particulier en appelant le [**IPIN :: QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept)du pin d’entrée en aval, le décodeur peut appeler [**IAMVideoAccelerator :: GetVideoAcceleratorGUIDs**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getvideoacceleratorguids) pour obtenir une liste des GUID d’accélérateur vidéo pris en charge par le pin.</span><span class="sxs-lookup"><span data-stu-id="729bc-123">If the decoder does not know which video accelerator GUIDs the downstream input pin supports and does not wish to propose just some particular candidate video accelerator GUID by calling the downstream input pin's [**IPin::QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept), the decoder can call [**IAMVideoAccelerator::GetVideoAcceleratorGUIDs**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getvideoacceleratorguids) to get a list of the video accelerator GUIDs the pin supports.</span></span>
4.  <span data-ttu-id="729bc-124">Pour certains GUID d’accélérateur vidéo particuliers, le décodeur peut appeler la [**IAMVideoAccelerator :: GetUncompFormatsSupported**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getuncompformatssupported) du pin d’entrée en aval pour obtenir une liste des formats de pixel **DDPIXELFORMAT** qui peuvent être utilisés pour afficher un GUID d’accélérateur vidéo spécifique.</span><span class="sxs-lookup"><span data-stu-id="729bc-124">For some particular video accelerator GUIDs, the decoder can call the downstream input pin's [**IAMVideoAccelerator::GetUncompFormatsSupported**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getuncompformatssupported) to get a list of the **DDPIXELFORMAT** pixel formats that can be used to render a specific video accelerator GUID.</span></span> <span data-ttu-id="729bc-125">La liste renvoyée doit être considérée comme étant dans un ordre de préférence décroissant (c’est-à-dire, avec le format le plus préféré répertorié en premier).</span><span class="sxs-lookup"><span data-stu-id="729bc-125">The list returned should be considered to be in decreasing preference order (that is, with the most preferred format listed first).</span></span>
5.  <span data-ttu-id="729bc-126">Le décodeur appelle le [**IPIN :: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection)du pin d’entrée en aval, en lui transmettant un [**\_ \_ type de média am**](/windows/win32/api/strmif/ns-strmif-am_media_type) avec le GUID d’accélérateur vidéo approprié comme sous-type du type de média.</span><span class="sxs-lookup"><span data-stu-id="729bc-126">The decoder calls the downstream input pin's [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection), passing it an [**AM\_MEDIA\_TYPE**](/windows/win32/api/strmif/ns-strmif-am_media_type) with the proper video accelerator GUID as the subtype of the media type.</span></span> <span data-ttu-id="729bc-127">Cela configure la connexion pour l’opération, y compris la création des surfaces de sortie non compressées (qui sont allouées à l’aide de la largeur et de la hauteur trouvées dans le **\_ \_ type de média am**, et le nombre de surfaces à allouer trouvées par un appel décrit ci-dessous, et toutes les autres informations que l’accélérateur vidéo a disponibles et qui souhaite l’utiliser à cette</span><span class="sxs-lookup"><span data-stu-id="729bc-127">This sets up the connection for operation, including the creation of the uncompressed output surfaces (which are allocated using the width and height found in **AM\_MEDIA\_TYPE**, and the number of surfaces to allocate found by a call described below, and whatever other information the video accelerator has available and wishes to use for that purpose—such as the video accelerator GUID itself).</span></span> <span data-ttu-id="729bc-128">Si la broche d’entrée en aval rejette le GUID de l’accélérateur vidéo ou un autre aspect de la connexion, cela peut entraîner l’échec de **IPIN :: ReceiveConnection** .</span><span class="sxs-lookup"><span data-stu-id="729bc-128">If the downstream input pin rejects the video accelerator GUID or some other aspect of the connection, this can cause the **IPin::ReceiveConnection** to fail.</span></span> <span data-ttu-id="729bc-129">Si **IPIN :: ReceiveConnection** échoue, cela est indiqué dans un **HRESULT** retourné et le décodeur peut tenter à nouveau d’effectuer l’appel, par exemple avec un nouveau GUID d’accélérateur vidéo dans la structure du **\_ \_ type de média am** .</span><span class="sxs-lookup"><span data-stu-id="729bc-129">If **IPin::ReceiveConnection** fails, this is indicated in a returned **HRESULT**, and the decoder can try to make the call again, for example, with a new video accelerator GUID in the **AM\_MEDIA\_TYPE** structure.</span></span>
    -   [!Note]  
        > <span data-ttu-id="729bc-130">Il s’agit d’une autre méthode (et la méthode la plus définitive) pour le décodeur afin de déterminer ce qui est pris en charge par la broche d’entrée en aval, en appelant simplement [**IPIN :: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) et en tentant de se connecter, puis en vérifiant si la tentative de connexion a réussi.</span><span class="sxs-lookup"><span data-stu-id="729bc-130">This is another way (and the most definitive way) for the decoder to determine what is supported by the downstream input pin—simply calling [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) and trying to connect, and then checking whether the connection attempt was successful.</span></span>

         

    -   <span data-ttu-id="729bc-131">Pendant le [**IPIN :: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection), le convertisseur appelle le [**IAMVideoAcceleratorNotify :: GetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getuncompsurfacesinfo)du décodeur, en lui transmettant le GUID de l’accélérateur vidéo et une structure [**AMVAUncompBufferInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvauncompbufferinfo) , afin de déterminer le nombre de surfaces non compressées à allouer.</span><span class="sxs-lookup"><span data-stu-id="729bc-131">During the [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection), the renderer calls the decoder's [**IAMVideoAcceleratorNotify::GetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getuncompsurfacesinfo), passing it the video accelerator GUID and an [**AMVAUncompBufferInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvauncompbufferinfo) structure, in order to figure out how many uncompressed surfaces to allocate.</span></span> <span data-ttu-id="729bc-132">Le décodeur remplit et retourne la structure, qui contient le nombre minimal et maximal de surfaces à allouer du type particulier, et une structure **DDPIXELFORMAT** décrivant le format de pixel des surfaces à allouer.</span><span class="sxs-lookup"><span data-stu-id="729bc-132">The decoder fills in and returns the structure, which contains the minimum and maximum number of surfaces to be allocated of the particular type, and a **DDPIXELFORMAT** structure describing the pixel format of the surfaces to be allocated.</span></span>
    -   [!Note]  
        > <span data-ttu-id="729bc-133">Rien n’est réellement passé au décodeur dans l’appel à [**IAMVideoAcceleratorNotify :: GetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getuncompsurfacesinfo) autre que le GUID de l’accélérateur vidéo.</span><span class="sxs-lookup"><span data-stu-id="729bc-133">Nothing is actually passed in to the decoder in the call to [**IAMVideoAcceleratorNotify::GetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getuncompsurfacesinfo) other than the video accelerator GUID.</span></span>

         

6.  <span data-ttu-id="729bc-134">Le convertisseur appelle le [**IAMVideoAcceleratorNotify :: SetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-setuncompsurfacesinfo)du décodeur, en passant au décodeur le nombre réel de surfaces non compressées qui ont été allouées.</span><span class="sxs-lookup"><span data-stu-id="729bc-134">The renderer calls the decoder's [**IAMVideoAcceleratorNotify::SetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-setuncompsurfacesinfo), passing to the decoder the actual number of uncompressed surfaces that were allocated.</span></span>
7.  <span data-ttu-id="729bc-135">Le convertisseur appelle le [**IAMVideoAcceleratorNotify :: GetCreateVideoAcceleratorData**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getcreatevideoacceleratordata) du décodeur pour obtenir toutes les données nécessaires pour initialiser l’accélérateur vidéo.</span><span class="sxs-lookup"><span data-stu-id="729bc-135">The renderer calls the decoder's [**IAMVideoAcceleratorNotify::GetCreateVideoAcceleratorData**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getcreatevideoacceleratordata) to get any data needed to initialize the video accelerator.</span></span>
8.  <span data-ttu-id="729bc-136">Le décodeur appelle [**IAMVideoAccelerator :: GetCompBufferInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getcompbufferinfo), en lui transmettant un GUID d’accélérateur vidéo, une structure [**AMVAUncompDataInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvauncompdatainfo) et le nombre de types de tampons compressés, pour obtenir un ensemble de structures de données [**AMVACompBufferInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvacompbufferinfo) , l’une correspondant à chaque type de mémoire tampon de données COMpressées utilisé par le GUID de l’accélérateur vidéo.</span><span class="sxs-lookup"><span data-stu-id="729bc-136">The decoder calls [**IAMVideoAccelerator::GetCompBufferInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getcompbufferinfo), passing it a video accelerator GUID, an [**AMVAUncompDataInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvauncompdatainfo) structure, and the number of compressed buffer types, to get in return a set of [**AMVACompBufferInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvacompbufferinfo) data structures, one corresponding to each type of compressed data buffer used by the video accelerator GUID.</span></span>
    -   <span data-ttu-id="729bc-137">La structure [**AMVAUncompDataInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvauncompdatainfo) contient la largeur et la hauteur des données décompressées décodées (en pixels) et le DDPIXELFORMAT de l’image non compressée.</span><span class="sxs-lookup"><span data-stu-id="729bc-137">The [**AMVAUncompDataInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvauncompdatainfo) structure contains the width and height of the decoded uncompressed data (in pixels) and the DDPIXELFORMAT of the uncompressed picture.</span></span>
    -   <span data-ttu-id="729bc-138">Les structures de données [**AMVACompBufferInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvacompbufferinfo) retournées chaque contiennent :</span><span class="sxs-lookup"><span data-stu-id="729bc-138">The [**AMVACompBufferInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvacompbufferinfo) data structures returned each contain:</span></span>
        -   <span data-ttu-id="729bc-139">Nombre de mémoires tampons compressées nécessaires du type spécifique.</span><span class="sxs-lookup"><span data-stu-id="729bc-139">The number of compressed buffers needed of the specific type.</span></span>
        -   <span data-ttu-id="729bc-140">La largeur et la hauteur de la surface à créer (champs qui peuvent avoir ou non une signification réelle).</span><span class="sxs-lookup"><span data-stu-id="729bc-140">The width and height of the surface to create (fields which may or may not have any actual meaning).</span></span>
            > [!Note]  
            > <span data-ttu-id="729bc-141">L’opération d’allocation de surface DirectDraw pour les mémoires tampons compressées ne fournit pas actuellement la largeur ou la hauteur de ces surfaces pour être supérieures ou égales à 2 ^ 15, bien que l’appel d’allocation de surface puisse ne pas échouer si cette limite n’est pas respectée.</span><span class="sxs-lookup"><span data-stu-id="729bc-141">The DirectDraw surface allocation operation for the compressed buffers does not currently provide for the width or height of these surfaces to be greater than or equal to 2^15, although the surface allocation call may not overtly fail if this limit is violated.</span></span> <span data-ttu-id="729bc-142">Par conséquent, le pilote peut structurer ses demandes de mémoire tampon compressée afin d’éviter des tailles extrêmes.</span><span class="sxs-lookup"><span data-stu-id="729bc-142">Therefore, the driver could structure its requests for compressed buffer memory to avoid such extreme sizes.</span></span> <span data-ttu-id="729bc-143">Par exemple, au lieu de demander une mémoire tampon avec width = "1" et Height = "65536", le pilote doit demander une mémoire tampon de width = "1024" et Height = "64".</span><span class="sxs-lookup"><span data-stu-id="729bc-143">For example, rather than requesting a buffer with width="1" and height="65536", the driver should request a buffer of width="1024" and height="64".</span></span>

             

        -   <span data-ttu-id="729bc-144">Nombre total d’octets à utiliser par l’aire.</span><span class="sxs-lookup"><span data-stu-id="729bc-144">The total number of bytes to be used by the surface.</span></span>
        -   <span data-ttu-id="729bc-145">Structure de type **DDSCAPS2** définissant un objet DirectDrawSurface, décrivant les fonctionnalités permettant de créer des surfaces pour stocker des données compressées.</span><span class="sxs-lookup"><span data-stu-id="729bc-145">A structure of type **DDSCAPS2** defining a DirectDrawSurface object, describing the capabilities to create surfaces to store compressed data.</span></span>
        -   <span data-ttu-id="729bc-146">DDPIXELFORMAT, décrivant le format de pixel utilisé pour créer des surfaces pour stocker des données compressées (un champ qui peut avoir ou non une signification réelle).</span><span class="sxs-lookup"><span data-stu-id="729bc-146">A DDPIXELFORMAT, describing the pixel format used to create surfaces to store compressed data (a field which may or may not have any actual meaning).</span></span>

> [!Note]  
> <span data-ttu-id="729bc-147">Les appels du convertisseur à certaines méthodes d’interface [**IAMVideoAcceleratorNotify**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoacceleratornotify) du décodeur peuvent (et normalement) se produire à l’intérieur de l’appel du décodeur à [**IPIN :: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection)du convertisseur.</span><span class="sxs-lookup"><span data-stu-id="729bc-147">The renderer's calls to some of the decoder's [**IAMVideoAcceleratorNotify**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoacceleratornotify) interface methods may (and normally would) occur inside of the decoder's call to the renderer's [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection).</span></span> <span data-ttu-id="729bc-148">Plus précisément, cela s’applique aux éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="729bc-148">Specifically, this applies to the following:</span></span>
>
> -   <span data-ttu-id="729bc-149">[**IAMVideoAcceleratorNotify :: GetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getuncompsurfacesinfo),</span><span class="sxs-lookup"><span data-stu-id="729bc-149">[**IAMVideoAcceleratorNotify::GetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getuncompsurfacesinfo),</span></span>
> -   <span data-ttu-id="729bc-150">[**IAMVideoAcceleratorNotify :: SetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-setuncompsurfacesinfo)et</span><span class="sxs-lookup"><span data-stu-id="729bc-150">[**IAMVideoAcceleratorNotify::SetUncompSurfacesInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-setuncompsurfacesinfo), and</span></span>
> -   <span data-ttu-id="729bc-151">[**IAMVideoAcceleratorNotify :: GetCreateVideoAcceleratorData**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getcreatevideoacceleratordata).</span><span class="sxs-lookup"><span data-stu-id="729bc-151">[**IAMVideoAcceleratorNotify::GetCreateVideoAcceleratorData**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoacceleratornotify-getcreatevideoacceleratordata).</span></span>

 

> [!Note]  
> <span data-ttu-id="729bc-152">Pour prendre en charge les modifications de format dynamiques, le décodeur peut également appeler [**IPIN :: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) et d’autres méthodes par dessus, alors que les filtres sont connectés et en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="729bc-152">To support dynamic format changes, the decoder may also call [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) and other methods per above while the filters are connected and running.</span></span> <span data-ttu-id="729bc-153">Cette fonctionnalité est fournie pour prendre en charge les modifications de format dynamiques (bien qu’elles ne soient pas dans le H. 263, annexe P, sens, car tous les jeux de données sont redémarrés à partir de zéro et toutes les informations de l’image de référence sont donc perdues).</span><span class="sxs-lookup"><span data-stu-id="729bc-153">This capability is provided in order to support dynamic format changes (although not in the H.263, Annex P, sense - as all data sets are started up again from scratch and any reference picture information is therefore lost).</span></span>

 

<span data-ttu-id="729bc-154">Vous trouverez ci-dessous une description de l’utilisation de [**IAMVideoAccelerator**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator) lors de l’opération après l’initialisation :</span><span class="sxs-lookup"><span data-stu-id="729bc-154">The following is a description of [**IAMVideoAccelerator**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator) use during operation after initialization:</span></span>

1.  <span data-ttu-id="729bc-155">Pour chaque surface non compressée, le décodeur appelle [**IAMVideoAccelerator :: BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) pour commencer le traitement de la création de l’image de sortie.</span><span class="sxs-lookup"><span data-stu-id="729bc-155">For each uncompressed surface, the decoder calls [**IAMVideoAccelerator::BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) to begin the processing to create the output picture.</span></span> <span data-ttu-id="729bc-156">Dans ce cas, le décodeur envoie une structure [**AMVABeginFrameInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvabeginframeinfo) .</span><span class="sxs-lookup"><span data-stu-id="729bc-156">When it does this, the decoder sends an [**AMVABeginFrameInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvabeginframeinfo) structure.</span></span>
    -   <span data-ttu-id="729bc-157">La structure [**AMVABeginFrameInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvabeginframeinfo) contient un index pour une mémoire tampon de destination, un pointeur vers certaines données à envoyer en aval et un pointeur vers un emplacement où l’accélérateur peut placer des données pour le décodeur à lire.</span><span class="sxs-lookup"><span data-stu-id="729bc-157">The [**AMVABeginFrameInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvabeginframeinfo) structure contains an index for a destination buffer, a pointer to some data to send downstream, and a pointer to a place where the accelerator can put some data for the decoder to read.</span></span>
    -   <span data-ttu-id="729bc-158">Remarque 1 : l’accélérateur ne reçoit pas réellement l’index de la mémoire tampon de destination, car il est traduit par le convertisseur avant de passer en aval.</span><span class="sxs-lookup"><span data-stu-id="729bc-158">NOTE 1: The accelerator does not actually receive the destination buffer index, as it is translated by the renderer before going downstream.</span></span>
    -   <span data-ttu-id="729bc-159">Remarque 2 : [**IAMVideoAccelerator :: BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) peut être appelé plusieurs fois entre des appels à [**IAMVideoAccelerator :: EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe).</span><span class="sxs-lookup"><span data-stu-id="729bc-159">NOTE 2: [**IAMVideoAccelerator::BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) can be called more than once between calls to [**IAMVideoAccelerator::EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe).</span></span>
    -   <span data-ttu-id="729bc-160">Remarque 3 : il n’existe aucune hypothèse dans l’opération d’interface que [**IAMVideoAccelerator :: BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) et [**IAMVideoAccelerator :: EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe) doivent être appelées pour le traitement de chaque image individuelle dans le flux binaire.</span><span class="sxs-lookup"><span data-stu-id="729bc-160">NOTE 3: There is no assumption within the interface operation that [**IAMVideoAccelerator::BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) and [**IAMVideoAccelerator::EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe) need to be called for the processing of every individual picture in the bitstream.</span></span>

        <span data-ttu-id="729bc-161">Ce que [**IAMVideoAccelerator :: BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) fait, en ce qui concerne l’interface, crée une association dans le convertisseur entre un index et une surface non compressée.</span><span class="sxs-lookup"><span data-stu-id="729bc-161">What [**IAMVideoAccelerator::BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) does, as far as the interface is concerned, is create an association within the renderer between an index and an uncompressed surface.</span></span> <span data-ttu-id="729bc-162">Il fournit également un moyen d’appeler une fonction spécifique dans un pilote de périphérique (avec la prise en charge d’un moyen de passer des données arbitraires entre le décodeur et le pilote de périphérique).</span><span class="sxs-lookup"><span data-stu-id="729bc-162">It also provides a means to call a specific function in a device driver (with support of a means of passing arbitrary data back and forth between the decoder and the device driver).</span></span>

        <span data-ttu-id="729bc-163">(Toutefois, dans l’opération DirectX VA, il existe une spécification décrite ci-dessous : [**IAMVideoAccelerator :: BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) et [**IAMVideoAccelerator :: EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe) doivent être appelés pour le traitement de chaque image individuelle dans le flux binaire.)</span><span class="sxs-lookup"><span data-stu-id="729bc-163">(However, in DirectX VA operation there is a requirement described below that [**IAMVideoAccelerator::BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) and [**IAMVideoAccelerator::EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe) do need to be called for the processing of every individual picture in the bitstream.)</span></span>

2.  <span data-ttu-id="729bc-164">Pour envoyer des données non compressées à l’accélérateur, le décodeur appelle :</span><span class="sxs-lookup"><span data-stu-id="729bc-164">For sending uncompressed data to the accelerator, the decoder calls:</span></span>
    -   <span data-ttu-id="729bc-165">[**IAMVideoAccelerator :: QueryRenderStatus**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-queryrenderstatus) pour déterminer si une mémoire tampon est sécurisée pour la lecture ou l’écriture dans.</span><span class="sxs-lookup"><span data-stu-id="729bc-165">[**IAMVideoAccelerator::QueryRenderStatus**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-queryrenderstatus) to determine whether a buffer is safe for reading from or writing to.</span></span>
    -   <span data-ttu-id="729bc-166">[**IAMVideoAccelerator :: GetBuffer**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getbuffer) pour verrouiller et obtenir l’accès à une mémoire tampon spécifiée (si elle ne l’a pas précédemment appelée pour obtenir cet accès).</span><span class="sxs-lookup"><span data-stu-id="729bc-166">[**IAMVideoAccelerator::GetBuffer**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getbuffer) to lock and obtain access to a specified buffer (if it has not previously called this to get that access).</span></span> <span data-ttu-id="729bc-167">**GetBuffer** peut également être utilisé pour obtenir une copie du contenu de la dernière image de sortie non compressée pour laquelle [**IAMVideoAccelerator :: BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) a été appelé, en fournissant [**IAMVideoAccelerator :: EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe) n’a pas été appelé pour cet index de tampon de destination.</span><span class="sxs-lookup"><span data-stu-id="729bc-167">**GetBuffer** can also be used to get a copy of the contents of the last uncompressed output picture for which [**IAMVideoAccelerator::BeginFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-beginframe) was called, providing [**IAMVideoAccelerator::EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe) has not been called for that destination buffer index.</span></span> <span data-ttu-id="729bc-168">Si la DDI retourne un état de rendu de DDERR \_ WASSTILLDRAWING pour la mémoire tampon demandée, une boucle de mise en veille est traitée dans **GetBuffer** jusqu’à ce que cette condition soit désactivée.</span><span class="sxs-lookup"><span data-stu-id="729bc-168">If the DDI returns a render status of DDERR\_WASSTILLDRAWING for the requested buffer, a sleep loop will be operated within **GetBuffer** until this condition is cleared.</span></span> <span data-ttu-id="729bc-169">Pour appeler **GetBuffer**, le décodeur aura besoin de certaines informations d’une structure de données [**AMVACompBufferInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvacompbufferinfo) qui est obtenue en appelant [**IAMVideoAccelerator :: GetCompBufferInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getcompbufferinfo).</span><span class="sxs-lookup"><span data-stu-id="729bc-169">In order to call **GetBuffer**, the decoder will need some information from an [**AMVACompBufferInfo**](/previous-versions/windows/desktop/api/amva/ns-amva-amvacompbufferinfo) data structure which is obtained by calling [**IAMVideoAccelerator::GetCompBufferInfo**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getcompbufferinfo).</span></span>
    -   <span data-ttu-id="729bc-170">[**IAMVideoAccelerator :: Execute**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-execute) pour indiquer que les données d’un ensemble de mémoires tampons compressées, comme indiqué dans un tableau de structures de données [**AMVABUFFERINFO**](/previous-versions/windows/desktop/api/amva/ns-amva-amvabufferinfo) , doivent être traitées.</span><span class="sxs-lookup"><span data-stu-id="729bc-170">[**IAMVideoAccelerator::Execute**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-execute) to indicate that the data in a set of compressed buffers as indicated in an array of [**AMVABUFFERINFO**](/previous-versions/windows/desktop/api/amva/ns-amva-amvabufferinfo) data structures should be processed.</span></span> <span data-ttu-id="729bc-171">Un code de fonction dwFunction est passé au pilote dans cet appel.</span><span class="sxs-lookup"><span data-stu-id="729bc-171">A function code dwFunction is passed to the driver in this call.</span></span> <span data-ttu-id="729bc-172">Un pointeur lpPrivateInputData est également passé à certaines données à envoyer en aval, et un pointeur lpPrivateOutputData est passé à un emplacement où le processus en aval peut placer des données pour le décodeur à lire.</span><span class="sxs-lookup"><span data-stu-id="729bc-172">A lpPrivateInputData pointer is also passed to some data to send downstream, and a lpPrivateOutputData pointer is passed to a place where the downstream process can put some data for the decoder to read.</span></span>
    -   <span data-ttu-id="729bc-173">[**IAMVideoAccelerator :: ReleaseBuffer**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-releasebuffer) pour indiquer que le décodeur a terminé l’utilisation d’une mémoire tampon spécifiée pendant le moment et n’a plus besoin d’un accès verrouillé à la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="729bc-173">[**IAMVideoAccelerator::ReleaseBuffer**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-releasebuffer) to indicate that the decoder has completed use of a specified buffer for the moment and no longer needs locked access to the buffer.</span></span> <span data-ttu-id="729bc-174">(Si le décodeur souhaite continuer à utiliser la mémoire tampon, il peut simplement ne pas appeler **IAMVideoAccelerator :: ReleaseBuffer** pour le moment, ce qui évite d’avoir à appeler [**IAMVideoAccelerator :: GetBuffer**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getbuffer) jusqu’à ce qu’il envisage vraiment de ne pas utiliser la mémoire tampon.) Le décodeur ne doit pas écrire dans la mémoire tampon après l’appel de la méthode [**Execute**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-execute) jusqu’à ce que [**QueryRenderStatus**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-queryrenderstatus) indique que la mémoire tampon est sécurisée pour l’écriture.</span><span class="sxs-lookup"><span data-stu-id="729bc-174">(If the decoder wishes to continue to use the buffer, it can simply not call **IAMVideoAccelerator::ReleaseBuffer** for the moment, thus avoiding the need to call [**IAMVideoAccelerator::GetBuffer**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-getbuffer) until it really intends to not use the buffer anymore.) The decoder should not write into the buffer after [**Execute**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-execute) is called until [**QueryRenderStatus**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-queryrenderstatus) indicates that the buffer is safe for writing.</span></span>
3.  <span data-ttu-id="729bc-175">Pour terminer le traitement de sortie pour une mémoire tampon de destination, le décodeur appelle [**IAMVideoAccelerator :: EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe).</span><span class="sxs-lookup"><span data-stu-id="729bc-175">To complete output processing for a destination buffer, the decoder calls [**IAMVideoAccelerator::EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe).</span></span> <span data-ttu-id="729bc-176">Il peut passer des données arbitraires en aval avec cet appel, et c’est essentiellement tout ce qui se produit à la suite de cet appel.</span><span class="sxs-lookup"><span data-stu-id="729bc-176">It can pass some arbitrary data downstream with this call, and that's essentially all that happens as a result of this call.</span></span> <span data-ttu-id="729bc-177">Il n’envoie pas d’index de tampon de destination dans cet appel. il ne peut donc pas indiquer précisément la mémoire tampon de destination qui est terminée, sauf si cette indication est contenue dans les données arbitraires transmises.</span><span class="sxs-lookup"><span data-stu-id="729bc-177">It doesn't send a destination buffer index in this call, so it can't indicate to the accelerator precisely what destination buffer is completed unless this indication is contained in the arbitrary data that is passed.</span></span>
4.  <span data-ttu-id="729bc-178">Pour afficher un frame, le décodeur appelle [**IAMVideoAccelerator ::D isplayframe**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-displayframe) avec l’index du frame à afficher et une structure [**IMediaSample**](/windows/desktop/api/Strmif/nn-strmif-imediasample) contenant les horodatages de début et de fin, ainsi que les indicateurs pertinents tels que **dwTypeSpecificFlags** dans la structure des [**\_ \_ Propriétés am SAMPLE2**](/windows/win32/api/strmif/ns-strmif-am_sample2_properties) et **dwInterlaceFlags** dans la structure [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) .</span><span class="sxs-lookup"><span data-stu-id="729bc-178">To display a frame, the decoder calls [**IAMVideoAccelerator::DisplayFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-displayframe) with the index of the frame to display and a [**IMediaSample**](/windows/desktop/api/Strmif/nn-strmif-imediasample) structure containing start and stop time stamps and relevant flags such as **dwTypeSpecificFlags** in the [**AM\_SAMPLE2\_PROPERTIES**](/windows/win32/api/strmif/ns-strmif-am_sample2_properties) structure, and **dwInterlaceFlags** in the [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) structure.</span></span> <span data-ttu-id="729bc-179">Le décodeur doit vérifier que toutes les opérations de décompression qui affectent le contenu du frame se sont terminées avant d’appeler **DisplayFrame**.</span><span class="sxs-lookup"><span data-stu-id="729bc-179">The decoder must verify that all decompression operations that affect the content of the frame have completed before calling **DisplayFrame**.</span></span>
5.  <span data-ttu-id="729bc-180">Enfin, le décodeur doit, à la fin de tout le traitement, indiquer la fin de tous les autres frames de sortie commencés en appelant [**IAMVideoAccelerator :: EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe) et libérer toutes ses mémoires tampons verrouillées en appelant [**IAMVideoAccelerator :: ReleaseBuffer**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-releasebuffer) pour chaque mémoire tampon non publiée.</span><span class="sxs-lookup"><span data-stu-id="729bc-180">Finally, the decoder should, upon completion of all processing, indicate completion of all remaining begun output frames by calling [**IAMVideoAccelerator::EndFrame**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-endframe) and release all of its locked buffers by calling [**IAMVideoAccelerator::ReleaseBuffer**](/previous-versions/windows/desktop/api/videoacc/nf-videoacc-iamvideoaccelerator-releasebuffer) for each unreleased buffer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="729bc-181">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="729bc-181">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="729bc-182">Interfaces et spécifications du décodeur</span><span class="sxs-lookup"><span data-stu-id="729bc-182">Decoder Interfaces and Specifications</span></span>](decoder-interfaces-and-specifications.md)
</dt> </dl>

 

 



