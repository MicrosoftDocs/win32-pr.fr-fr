---
description: Reconnexion des broches
ms.assetid: 34b3e4de-e4eb-48c5-aaef-fc99b63e8691
title: Reconnexion des broches
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9fc71b4d5a62ee066edaa5f97b4cc3332b2231d
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104521319"
---
# <a name="reconnecting-pins"></a><span data-ttu-id="188be-103">Reconnexion des broches</span><span class="sxs-lookup"><span data-stu-id="188be-103">Reconnecting Pins</span></span>

<span data-ttu-id="188be-104">Pendant une connexion de code confidentiel, un filtre peut se déconnecter et reconnecter l’un de ses autres broches, comme suit :</span><span class="sxs-lookup"><span data-stu-id="188be-104">During a pin connection, a filter can disconnect and reconnect one of its other pins, as follows:</span></span>

1.  <span data-ttu-id="188be-105">Le filtre appelle [**IPIN :: QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) sur le code confidentiel de l’autre filtre et spécifie le nouveau type de média.</span><span class="sxs-lookup"><span data-stu-id="188be-105">The filter calls [**IPin::QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) on the other filter's pin, and specifies the new media type.</span></span>
2.  <span data-ttu-id="188be-106">Si **QueryAccept** retourne S \_ OK, le filtre appelle [**IFilterGraph2 :: ReconnectEx**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph2-reconnectex) pour reconnecter les broches.</span><span class="sxs-lookup"><span data-stu-id="188be-106">If **QueryAccept** returns S\_OK, the filter calls [**IFilterGraph2::ReconnectEx**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph2-reconnectex) to reconnect the pins.</span></span>

<span data-ttu-id="188be-107">Voici quelques exemples de cas où un filtre peut avoir besoin de reconnecter des broches :</span><span class="sxs-lookup"><span data-stu-id="188be-107">The following are some examples of when a filter might need to reconnect pins:</span></span>

-   <span data-ttu-id="188be-108">**Filtres tee.**</span><span class="sxs-lookup"><span data-stu-id="188be-108">**Tee filters.**</span></span> <span data-ttu-id="188be-109">Un *filtre tee* fractionne un flux d’entrée en plusieurs sorties sans modifier les données dans le flux.</span><span class="sxs-lookup"><span data-stu-id="188be-109">A *tee filter* splits an input stream into multiple outputs without changing the data in the stream.</span></span> <span data-ttu-id="188be-110">Un filtre tee peut accepter une plage de types de médias, mais les types doivent correspondre sur toutes les connexions de code confidentiel.</span><span class="sxs-lookup"><span data-stu-id="188be-110">A tee filter can accept a range of media types, but the types must match across all pin connections.</span></span> <span data-ttu-id="188be-111">Par conséquent, lorsque la broche d’entrée se connecte, il se peut que le filtre doive renégocier toutes les connexions existantes sur les broches de sortie, et vice versa.</span><span class="sxs-lookup"><span data-stu-id="188be-111">Therefore, when the input pin connects, the filter might need to renegotiate any existing connections on the output pins, and vice versa.</span></span> <span data-ttu-id="188be-112">Pour obtenir un exemple, consultez l' [exemple de filtre InfTee](inftee-filter-sample.md).</span><span class="sxs-lookup"><span data-stu-id="188be-112">For an example, see the [InfTee Filter Sample](inftee-filter-sample.md).</span></span>
-   <span data-ttu-id="188be-113">**Filtres de transfert en place.**</span><span class="sxs-lookup"><span data-stu-id="188be-113">**Trans-in-place filters.**</span></span> <span data-ttu-id="188be-114">Un filtre *de transfert sur place* modifie les données d’entrée dans la mémoire tampon d’origine au lieu de copier les données dans une mémoire tampon de sortie distincte.</span><span class="sxs-lookup"><span data-stu-id="188be-114">A *trans-in-place* filter modifies the input data in the original buffer instead of copying the data to a separate output buffer.</span></span> <span data-ttu-id="188be-115">Un filtre de transfert sur place doit utiliser le même allocateur pour les connexions en amont et en aval.</span><span class="sxs-lookup"><span data-stu-id="188be-115">A trans-in-place filter must use the same allocator for both the upstream and the downstream connections.</span></span> <span data-ttu-id="188be-116">Le premier code PIN pour la connexion (entrée ou sortie) négocie une allocation de la manière habituelle.</span><span class="sxs-lookup"><span data-stu-id="188be-116">The first pin to connect (input or output) negotiates an allocator in the usual way.</span></span> <span data-ttu-id="188be-117">Toutefois, lorsque l’autre code pin se connecte, le premier allocateur peut ne pas être acceptable.</span><span class="sxs-lookup"><span data-stu-id="188be-117">When the other pin connects, however, the first allocator might not be acceptable.</span></span> <span data-ttu-id="188be-118">Dans ce cas, la deuxième broche choisit un allocateur différent et le premier code confidentiel se reconnecte à l’aide du nouvel allocateur.</span><span class="sxs-lookup"><span data-stu-id="188be-118">In that case, the second pin chooses a different allocator, and the first pin reconnects using the new allocator.</span></span> <span data-ttu-id="188be-119">Pour obtenir un exemple d’implémentation, consultez la classe [**CTransInPlaceFilter**](ctransinplacefilter.md) .</span><span class="sxs-lookup"><span data-stu-id="188be-119">For an example implementation, see the [**CTransInPlaceFilter**](ctransinplacefilter.md) class.</span></span>

<span data-ttu-id="188be-120">Dans la méthode **ReconnectEx** , le gestionnaire de graphique de filtre se déconnecte de façon asynchrone et reconnecte les broches.</span><span class="sxs-lookup"><span data-stu-id="188be-120">In the **ReconnectEx** method, the Filter Graph Manager asynchronously disconnects and reconnects the pins.</span></span> <span data-ttu-id="188be-121">Le filtre ne doit pas tenter la reconnexion à moins que **QueryAccept** retourne la valeur S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="188be-121">The filter must not attempt the reconnection unless **QueryAccept** returns S\_OK.</span></span> <span data-ttu-id="188be-122">Dans le cas contraire, le code PIN restera déconnecté, provoquant des erreurs de graphique.</span><span class="sxs-lookup"><span data-stu-id="188be-122">Otherwise, the pin will be left disconnected, causing graph errors.</span></span> <span data-ttu-id="188be-123">En outre, le filtre doit demander la reconnexion à l’intérieur de la méthode [**IPIN :: Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) , sur le même thread.</span><span class="sxs-lookup"><span data-stu-id="188be-123">Also, the filter should request the reconnection from inside the [**IPin::Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) method, on the same thread.</span></span> <span data-ttu-id="188be-124">Si la méthode **Connect** retourne sur un thread, alors qu’un autre thread effectue la demande de reconnexion, le gestionnaire de graphique de filtre peut exécuter le graphique avant de procéder à la reconnexion, ce qui entraîne des erreurs de graphique.</span><span class="sxs-lookup"><span data-stu-id="188be-124">If the **Connect** method returns on one thread, while another thread makes the reconnection request, the Filter Graph Manager might run the graph before it makes the reconnection, causing graph errors.</span></span>

 

 



