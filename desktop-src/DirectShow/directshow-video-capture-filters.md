---
description: Filtres de capture vidéo DirectShow
ms.assetid: e4d1452d-ceac-4b5c-b9ba-ad4722ecff76
title: Filtres de capture vidéo DirectShow
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 238f18dd77bc40011fa9fc0dbab3192ea81a223f
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104480873"
---
# <a name="directshow-video-capture-filters"></a><span data-ttu-id="a215e-103">Filtres de capture vidéo DirectShow</span><span class="sxs-lookup"><span data-stu-id="a215e-103">DirectShow Video Capture Filters</span></span>

<span data-ttu-id="a215e-104">Les filtres de capture dans DirectShow disposent de certaines fonctionnalités qui les distinguent des autres types de filtres.</span><span class="sxs-lookup"><span data-stu-id="a215e-104">Capture filters in DirectShow have some features that distinguish them from other kinds of filters.</span></span> <span data-ttu-id="a215e-105">Bien que le [Générateur de graphiques de capture](capture-graph-builder.md) masque un grand nombre de détails, il est judicieux de lire cette section afin d’avoir une compréhension générale des graphiques de capture DirectShow.</span><span class="sxs-lookup"><span data-stu-id="a215e-105">Although the [Capture Graph Builder](capture-graph-builder.md) hides many of the details, it is a good idea to read this section, in order to have a general understanding of DirectShow capture graphs.</span></span>

<span data-ttu-id="a215e-106">**Épingler les catégories**</span><span class="sxs-lookup"><span data-stu-id="a215e-106">**Pin Categories**</span></span>

<span data-ttu-id="a215e-107">Un filtre de capture possède souvent au moins deux broches de sortie qui fournissent le même type de données (par exemple, un code confidentiel d’aperçu et un code PIN de capture).</span><span class="sxs-lookup"><span data-stu-id="a215e-107">A capture filter often has two or more output pins that deliver the same kind of data—for example, a preview pin and a capture pin.</span></span> <span data-ttu-id="a215e-108">Par conséquent, les types de média ne sont pas un bon moyen de distinguer les codes confidentiels.</span><span class="sxs-lookup"><span data-stu-id="a215e-108">Therefore, media types are not a good way to distinguish the pins.</span></span> <span data-ttu-id="a215e-109">Au lieu de cela, les codes confidentiels se distinguent par leur fonctionnalité, qui est identifiée à l’aide d’un GUID, appelé *catégorie de code confidentiel*.</span><span class="sxs-lookup"><span data-stu-id="a215e-109">Instead, the pins are distinguished by their functionality, which is identified using a GUID, called the *pin category*.</span></span>

<span data-ttu-id="a215e-110">Pour plus d’informations sur la façon d’interroger des codes confidentiels pour leur catégorie, consultez [utilisation des catégories de code confidentiel](working-with-pin-categories.md).</span><span class="sxs-lookup"><span data-stu-id="a215e-110">For a discussion of how to query pins for their category, see [Working with Pin Categories](working-with-pin-categories.md).</span></span> <span data-ttu-id="a215e-111">Toutefois, pour la plupart des applications, vous n’aurez pas à interroger directement les broches.</span><span class="sxs-lookup"><span data-stu-id="a215e-111">For most applications, however, you will not have to query pins directly.</span></span> <span data-ttu-id="a215e-112">Au lieu de cela, différentes méthodes [**ICaptureGraphBuilder2**](/windows/desktop/api/Strmif/nn-strmif-icapturegraphbuilder2) prennent des paramètres qui spécifient la catégorie de code confidentiel sur laquelle opérer.</span><span class="sxs-lookup"><span data-stu-id="a215e-112">Instead, various [**ICaptureGraphBuilder2**](/windows/desktop/api/Strmif/nn-strmif-icapturegraphbuilder2) methods take parameters that specify the pin category on which to operate.</span></span> <span data-ttu-id="a215e-113">Le générateur de graphiques de capture localise automatiquement le code confidentiel correct.</span><span class="sxs-lookup"><span data-stu-id="a215e-113">The Capture Graph Builder automatically locates the correct pin.</span></span>

<span data-ttu-id="a215e-114">**Prévisualiser les broches et les broches de capture**</span><span class="sxs-lookup"><span data-stu-id="a215e-114">**Preview Pins and Capture Pins**</span></span>

<span data-ttu-id="a215e-115">Certains périphériques de capture vidéo ont des broches de sortie distinctes pour l’aperçu et la capture.</span><span class="sxs-lookup"><span data-stu-id="a215e-115">Some video capture devices have separate output pins for preview and capture.</span></span> <span data-ttu-id="a215e-116">La broche d’aperçu est utilisée pour afficher la vidéo à l’écran, tandis que le code confidentiel de capture est utilisé pour écrire la vidéo dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="a215e-116">The preview pin is used to render video to the screen, while the capture pin is used to write video to a file.</span></span>

<span data-ttu-id="a215e-117">Un pin de préversion et un code PIN de capture présentent les différences suivantes :</span><span class="sxs-lookup"><span data-stu-id="a215e-117">A preview pin and a capture pin have the following differences:</span></span>

-   <span data-ttu-id="a215e-118">Un pin de préversion supprime les frames en fonction des besoins pour maintenir le débit sur le code confidentiel de capture.</span><span class="sxs-lookup"><span data-stu-id="a215e-118">A preview pin drops frames as needed to maintain throughput on the capture pin.</span></span>
-   <span data-ttu-id="a215e-119">Chaque frame d’un code PIN de capture est horodaté avec l’heure de la séquence de flux de la trame.</span><span class="sxs-lookup"><span data-stu-id="a215e-119">Each frame from a capture pin is time-stamped with the stream time when the frame was captured.</span></span> <span data-ttu-id="a215e-120">Un pin d’aperçu n’horodatage pas les exemples qu’il livre.</span><span class="sxs-lookup"><span data-stu-id="a215e-120">A preview pin does not time stamp the samples it delivers.</span></span>

<span data-ttu-id="a215e-121">La raison pour laquelle les images d’aperçu n’ont pas de datage est que le graphique de filtre introduit une faible latence dans le flux.</span><span class="sxs-lookup"><span data-stu-id="a215e-121">The reason that preview frames do not have time stamps is that the filter graph introduces a small amount of latency into the stream.</span></span> <span data-ttu-id="a215e-122">Si l’heure de la capture est utilisée comme heure de présentation, le convertisseur vidéo traite chaque échantillon comme un peu plus tard.</span><span class="sxs-lookup"><span data-stu-id="a215e-122">If the capture time is used as the presentation time, the video renderer treats every sample as being slightly late.</span></span> <span data-ttu-id="a215e-123">Cela peut amener le convertisseur vidéo à déposer des frames pendant qu’il essaie de rattraper son retard.</span><span class="sxs-lookup"><span data-stu-id="a215e-123">This can cause the video renderer to drop frames while it tries to catch up.</span></span> <span data-ttu-id="a215e-124">La suppression des horodatages garantit que le convertisseur présente chaque échantillon lorsqu’il arrive, sans supprimer les frames.</span><span class="sxs-lookup"><span data-stu-id="a215e-124">Removing the time stamps ensures that the renderer presents each sample when it arrives, without dropping frames.</span></span>

<span data-ttu-id="a215e-125">La catégorie de code confidentiel pour les codes confidentiels de l’aperçu est l’aperçu de la catégorie d’ÉPINGLe \_ \_</span><span class="sxs-lookup"><span data-stu-id="a215e-125">The pin category for preview pins is PIN\_CATEGORY\_PREVIEW.</span></span> <span data-ttu-id="a215e-126">La catégorie des broches de capture est la \_ capture de catégorie pin \_ .</span><span class="sxs-lookup"><span data-stu-id="a215e-126">The category for capture pins is PIN\_CATEGORY\_CAPTURE.</span></span>

<span data-ttu-id="a215e-127">**Broches de port vidéo**</span><span class="sxs-lookup"><span data-stu-id="a215e-127">**Video Port Pins**</span></span>

<span data-ttu-id="a215e-128">Un port vidéo est une connexion matérielle entre un périphérique vidéo (par exemple, un tuner TV analogique) et la carte vidéo.</span><span class="sxs-lookup"><span data-stu-id="a215e-128">A video port is a hardware connection between a video device (such as an analog TV tuner) and the video card.</span></span> <span data-ttu-id="a215e-129">Un port vidéo permet à l’appareil d’envoyer des données vidéo directement à la carte graphique.</span><span class="sxs-lookup"><span data-stu-id="a215e-129">A video port enables the device to send video data directly to the graphics card.</span></span> <span data-ttu-id="a215e-130">La vidéo est affichée à l’écran à l’aide d’une superposition matérielle.</span><span class="sxs-lookup"><span data-stu-id="a215e-130">The video is displayed on the screen using a hardware overlay.</span></span> <span data-ttu-id="a215e-131">Un port vidéo peut être un câble réel qui connecte deux appareils sur des cartes distinctes. Il peut également s’agir d’une connexion câblée sur la même carte.</span><span class="sxs-lookup"><span data-stu-id="a215e-131">A video port might be an actual cable that connects two devices on separate cards; or it might be a hard-wired connection on the same card.</span></span>

<span data-ttu-id="a215e-132">L’avantage d’un port vidéo est que la vidéo passe directement en mémoire vidéo, sans qu’il y ait de travail par le processeur.</span><span class="sxs-lookup"><span data-stu-id="a215e-132">The advantage of a video port is that the video goes directly into video memory, without any work by the CPU.</span></span> <span data-ttu-id="a215e-133">Toutefois, les ports vidéo présentent certains inconvénients :</span><span class="sxs-lookup"><span data-stu-id="a215e-133">However, video ports have some drawbacks:</span></span>

-   <span data-ttu-id="a215e-134">Un port vidéo utilise toujours la surface de recouvrement pendant la capture, que vous souhaitiez ou non afficher un aperçu de la vidéo.</span><span class="sxs-lookup"><span data-stu-id="a215e-134">A video port always uses the overlay surface during capture, regardless of whether you want to preview the video.</span></span>
-   <span data-ttu-id="a215e-135">Le basculement entre les frames se produit automatiquement, ce qui complique la synchronisation du retournement avec d’autres opérations vidéo.</span><span class="sxs-lookup"><span data-stu-id="a215e-135">Flipping between frames occurs automatically, which makes it difficult to synchronize the flip with other video operations.</span></span>

<span data-ttu-id="a215e-136">Si un périphérique de capture utilise un port vidéo, le filtre de capture a une broche de port vidéo au lieu d’un code confidentiel d’aperçu.</span><span class="sxs-lookup"><span data-stu-id="a215e-136">If a capture device uses a video port, the capture filter has a video port pin instead of a preview pin.</span></span> <span data-ttu-id="a215e-137">La catégorie de code confidentiel pour les broches de port vidéo est broche \_ catégorie \_ VIDEOPORT.</span><span class="sxs-lookup"><span data-stu-id="a215e-137">The pin category for video port pins is PIN\_CATEGORY\_VIDEOPORT.</span></span>

<span data-ttu-id="a215e-138">Chaque filtre de capture a au moins un code PIN de capture.</span><span class="sxs-lookup"><span data-stu-id="a215e-138">Every capture filter has at least one capture pin.</span></span> <span data-ttu-id="a215e-139">En outre, il peut avoir un code PIN de préversion ou un code PIN de port vidéo, mais jamais les deux à la fois.</span><span class="sxs-lookup"><span data-stu-id="a215e-139">In addition it might have a preview pin or a video port pin, but never both.</span></span> <span data-ttu-id="a215e-140">Les filtres peuvent avoir plusieurs broches de capture et des codes confidentiels, chacun disposant d’un type de support distinct.</span><span class="sxs-lookup"><span data-stu-id="a215e-140">Filters can have multiple capture pins and preview pins, each delivering a separate media type.</span></span> <span data-ttu-id="a215e-141">Par conséquent, un filtre unique peut avoir un code PIN de capture vidéo, un code confidentiel vidéo, un code confidentiel de capture audio et un code confidentiel audio preview.</span><span class="sxs-lookup"><span data-stu-id="a215e-141">Thus, a single filter could have a video capture pin, a video preview pin, an audio capture pin, and an audio preview pin.</span></span> <span data-ttu-id="a215e-142">(Toutefois, il n’y a rien d’équivalent à un port vidéo pour l’audio.)</span><span class="sxs-lookup"><span data-stu-id="a215e-142">(There is nothing equivalent to a video port for audio, however.)</span></span>

<span data-ttu-id="a215e-143">**Filtres WDM en amont**</span><span class="sxs-lookup"><span data-stu-id="a215e-143">**Upstream WDM Filters**</span></span>

<span data-ttu-id="a215e-144">Les périphériques Windows Driver Model (WDM) peuvent nécessiter des filtres supplémentaires en amont du filtre de capture.</span><span class="sxs-lookup"><span data-stu-id="a215e-144">Windows Driver Model (WDM) devices may require some additional filters upstream from the capture filter.</span></span> <span data-ttu-id="a215e-145">Ces filtres sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="a215e-145">These filters include the following:</span></span>

-   <span data-ttu-id="a215e-146">[Filtre Tuner TV](tv-tuner-filter.md).</span><span class="sxs-lookup"><span data-stu-id="a215e-146">[TV Tuner Filter](tv-tuner-filter.md).</span></span> <span data-ttu-id="a215e-147">Contrôle le paramétrage des tuners TV analogiques.</span><span class="sxs-lookup"><span data-stu-id="a215e-147">Controls tuning for analog TV tuners.</span></span>
-   <span data-ttu-id="a215e-148">[Filtre audio TV](tv-audio-filter.md).</span><span class="sxs-lookup"><span data-stu-id="a215e-148">[TV Audio Filter](tv-audio-filter.md).</span></span> <span data-ttu-id="a215e-149">Contrôle les paramètres audio pour les tuners TV analogiques.</span><span class="sxs-lookup"><span data-stu-id="a215e-149">Controls audio settings for analog TV tuners.</span></span>
-   <span data-ttu-id="a215e-150">[Filtre de distributeur vidéo analogique](analog-video-crossbar-filter.md).</span><span class="sxs-lookup"><span data-stu-id="a215e-150">[Analog Video Crossbar Filter](analog-video-crossbar-filter.md).</span></span> <span data-ttu-id="a215e-151">Achemine les signaux audio et vidéo via le périphérique matériel.</span><span class="sxs-lookup"><span data-stu-id="a215e-151">Routes video and audio signals through the hardware device.</span></span> <span data-ttu-id="a215e-152">Par exemple, un appareil peut avoir plusieurs entrées, telles que S-Video et vidéo composite.</span><span class="sxs-lookup"><span data-stu-id="a215e-152">For example, a device might have multiple inputs, such as S-Video and composite video.</span></span> <span data-ttu-id="a215e-153">Le filtre de distributeur permet à l’application de sélectionner l’entrée.</span><span class="sxs-lookup"><span data-stu-id="a215e-153">The crossbar filter enables the application to select the input.</span></span>

<span data-ttu-id="a215e-154">Bien qu’il s’agisse de filtres distincts dans DirectShow, ils représentent généralement le même périphérique matériel.</span><span class="sxs-lookup"><span data-stu-id="a215e-154">Although these are separate filters in DirectShow, they typically represent the same hardware device.</span></span> <span data-ttu-id="a215e-155">Chaque filtre contrôle une fonction différente de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="a215e-155">Each filter controls a different function of the device.</span></span> <span data-ttu-id="a215e-156">Les filtres sont connectés par des broches, mais aucune donnée multimédia n’est déplacée sur les connexions de code confidentiel.</span><span class="sxs-lookup"><span data-stu-id="a215e-156">The filters are connected by pins, but no media data moves across the pin connections.</span></span> <span data-ttu-id="a215e-157">Par conséquent, les codes confidentiels sur ces filtres ne se connectent pas en établissant un type de média.</span><span class="sxs-lookup"><span data-stu-id="a215e-157">Therefore, the pins on these filters do not connect by establishing a media type.</span></span> <span data-ttu-id="a215e-158">Au lieu de cela, ils utilisent des valeurs GUID appelées *moyennes*.</span><span class="sxs-lookup"><span data-stu-id="a215e-158">Instead, they use GUID values called *mediums*.</span></span> <span data-ttu-id="a215e-159">Les GUID moyens sont définis de manière unique pour un minipilote de périphérique donné.</span><span class="sxs-lookup"><span data-stu-id="a215e-159">Medium GUIDs are uniquely defined for a given device minidriver.</span></span> <span data-ttu-id="a215e-160">Par exemple, le filtre Tuner TV et le filtre de capture vidéo pour la même carte TV prennent tous deux en charge le même support, ce qui permet à l’application de générer le graphique correctement.</span><span class="sxs-lookup"><span data-stu-id="a215e-160">For example, the TV Tuner filter and the Video Capture filter for the same TV card will both support the same medium, which enables the application to build the graph correctly.</span></span>

<span data-ttu-id="a215e-161">Dans la pratique, à condition que vous utilisiez **ICaptureGraphBuilder2** pour créer vos graphiques de capture, ces filtres sont ajoutés automatiquement au graphique.</span><span class="sxs-lookup"><span data-stu-id="a215e-161">In practice, as long as you are using **ICaptureGraphBuilder2** to build your capture graphs, these filters are added to the graph automatically.</span></span> <span data-ttu-id="a215e-162">Pour plus d’informations, consultez [filtres de pilote de classe WDM](wdm-class-driver-filters.md).</span><span class="sxs-lookup"><span data-stu-id="a215e-162">For a more detailed discussion, see [WDM Class Driver Filters](wdm-class-driver-filters.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="a215e-163">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="a215e-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a215e-164">À propos de la capture vidéo dans DirectShow</span><span class="sxs-lookup"><span data-stu-id="a215e-164">About Video Capture in DirectShow</span></span>](about-video-capture-in-directshow.md)
</dt> </dl>

 

 



