---
description: Utilisation de flux multimédias dans les applications
ms.assetid: 73cfe89b-df46-445a-92c7-2f7323672441
title: Utilisation de flux multimédias dans les applications
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f30dab204bc7b0bddbdc293708daecbe0558e8f9
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/03/2021
ms.locfileid: "103953411"
---
# <a name="using-multimedia-streams-in-applications"></a><span data-ttu-id="76c7d-103">Utilisation de flux multimédias dans les applications</span><span class="sxs-lookup"><span data-stu-id="76c7d-103">Using Multimedia Streams in Applications</span></span>

> [!Note]  
> <span data-ttu-id="76c7d-104">Ces API sont déconseillées.</span><span class="sxs-lookup"><span data-stu-id="76c7d-104">These APIs are deprecated.</span></span> <span data-ttu-id="76c7d-105">Les applications doivent utiliser le filtre d' [**accrochage d’exemple**](sample-grabber-filter.md) ou implémenter un filtre personnalisé pour obtenir des données à partir d’un graphique de filtre DirectShow.</span><span class="sxs-lookup"><span data-stu-id="76c7d-105">Applications should use the [**Sample Grabber**](sample-grabber-filter.md) filter or implement a custom filter to get data from a DirectShow filter graph.</span></span>

 

<span data-ttu-id="76c7d-106">Les interfaces de diffusion multimédia en continu simplifient radicalement le processus de manipulation des données multimédias en supprimant la dépendance sur des caractéristiques spécifiques de la source matérielle ou logicielle et en fournissant la prise en charge de tous les formats Microsoft DirectX® Media.</span><span class="sxs-lookup"><span data-stu-id="76c7d-106">The multimedia streaming interfaces greatly simplify the process of manipulating multimedia data by removing the dependency on specific characteristics of the hardware or software source and providing support for all Microsoft DirectX® media formats.</span></span> <span data-ttu-id="76c7d-107">Les flux extraient les données à un niveau très élevé ; les applications peuvent même déplacer des données d’un flux à un autre sans connaître le format des données.</span><span class="sxs-lookup"><span data-stu-id="76c7d-107">Streams abstract the data to a very high level; applications can even move data from one stream to another without knowing anything about the data's format.</span></span>

<span data-ttu-id="76c7d-108">Pour créer un flux multimédia, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="76c7d-108">Perform the following steps to create a multimedia stream.</span></span>

1.  <span data-ttu-id="76c7d-109">Créez le flux multimédia.</span><span class="sxs-lookup"><span data-stu-id="76c7d-109">Create the multimedia stream.</span></span> <span data-ttu-id="76c7d-110">La méthode de création et d’initialisation du flux est spécifique à l’architecture.</span><span class="sxs-lookup"><span data-stu-id="76c7d-110">The method of creation and initialization of the stream is architecture specific.</span></span> <span data-ttu-id="76c7d-111">DirectShow prend en charge l’interface [**IAMMultiMediaStream**](/previous-versions/windows/desktop/api/amstream/nn-amstream-iammultimediastream) , qui est utilisée pour initialiser le flux.</span><span class="sxs-lookup"><span data-stu-id="76c7d-111">DirectShow supports the [**IAMMultiMediaStream**](/previous-versions/windows/desktop/api/amstream/nn-amstream-iammultimediastream) interface, which is used to initialize the stream.</span></span> <span data-ttu-id="76c7d-112">D’autres implémentations de serveur in-process de [**IMultiMediaStream**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-imultimediastream) seront créées et initialisées à l’aide de différents mécanismes.</span><span class="sxs-lookup"><span data-stu-id="76c7d-112">Other in-process server implementations of [**IMultiMediaStream**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-imultimediastream) will be created and initialized using different mechanisms.</span></span>
2.  <span data-ttu-id="76c7d-113">Après l’initialisation de l’objet de flux multimédia, l’application utilise **QueryInterface** pour récupérer l’interface **IMultiMediaStream** pour l’objet.</span><span class="sxs-lookup"><span data-stu-id="76c7d-113">After the multimedia stream object is initialized, the application will use **QueryInterface** to retrieve the **IMultiMediaStream** interface for the object.</span></span> <span data-ttu-id="76c7d-114">Utilisez cette interface pour déterminer les propriétés du flux et énumérer les flux eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="76c7d-114">Use this interface to determine the stream's properties and enumerate the streams themselves.</span></span> <span data-ttu-id="76c7d-115">Vous pouvez récupérer un flux spécifique en appelant la méthode [**IMultiMediaStream :: GetMediaStream**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) avec un ID d’objet spécifique.</span><span class="sxs-lookup"><span data-stu-id="76c7d-115">You can retrieve a specific stream by calling the [**IMultiMediaStream::GetMediaStream**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) method with a specific purpose ID.</span></span> <span data-ttu-id="76c7d-116">MSPID \_ PrimaryVideo et MSPID \_ PrimaryAudio, qui représentent les flux vidéo et audio principaux, sont les ID d’objet les plus couramment utilisés.</span><span class="sxs-lookup"><span data-stu-id="76c7d-116">MSPID\_PrimaryVideo and MSPID\_PrimaryAudio, which represent the primary video and audio streams, are the most commonly used purpose IDs.</span></span>
3.  <span data-ttu-id="76c7d-117">Appelez **IUnknown :: QueryInterface** pour une interface spécifique au type de média du flux.</span><span class="sxs-lookup"><span data-stu-id="76c7d-117">Call **IUnknown::QueryInterface** for an interface specific to the stream's media type.</span></span> <span data-ttu-id="76c7d-118">Si vous souhaitez afficher un flux vidéo, par exemple, récupérez son interface [**IDirectDrawMediaStream**](/previous-versions/windows/desktop/api/ddstream/nn-ddstream-idirectdrawmediastream) .</span><span class="sxs-lookup"><span data-stu-id="76c7d-118">If you want to render a video stream, for example, retrieve its [**IDirectDrawMediaStream**](/previous-versions/windows/desktop/api/ddstream/nn-ddstream-idirectdrawmediastream) interface.</span></span> <span data-ttu-id="76c7d-119">Les interfaces spécifiques aux médias définissent des méthodes supplémentaires nécessaires pour tirer pleinement parti des fonctionnalités d’un format.</span><span class="sxs-lookup"><span data-stu-id="76c7d-119">Media-specific interfaces define additional methods necessary for taking full advantage of a format's capabilities.</span></span>
4.  <span data-ttu-id="76c7d-120">Créez un ou plusieurs exemples à partir des données de flux.</span><span class="sxs-lookup"><span data-stu-id="76c7d-120">Create one or more samples from the stream data.</span></span> <span data-ttu-id="76c7d-121">Chaque flux multimédia prend en charge la méthode [**IMediaStream :: CreateSharedSample**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample) pour l’exemple de création.</span><span class="sxs-lookup"><span data-stu-id="76c7d-121">Every media stream supports the [**IMediaStream::CreateSharedSample**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample) method for sample creation.</span></span> <span data-ttu-id="76c7d-122">L’exemple qui en résulte prend en charge l’interface [**IStreamSample**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-istreamsample) , qui permet de contrôler l’échantillon et ses caractéristiques.</span><span class="sxs-lookup"><span data-stu-id="76c7d-122">The resulting sample supports the [**IStreamSample**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-istreamsample) interface, which provides control over the sample and its characteristics.</span></span> <span data-ttu-id="76c7d-123">En règle générale, le flux multimédia prend en charge une méthode spécifique au format d’exemple de création, qui est plus puissante que les méthodes **IStreamSample** mentionnées ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="76c7d-123">Typically, the media stream supports a format-specific method of sample creation that is more powerful than the aforementioned **IStreamSample** methods.</span></span> <span data-ttu-id="76c7d-124">**IDirectDrawMediaStream**, par exemple, peut créer des échantillons attachés à une surface DirectDraw souhaitée et un rectangle de découpage.</span><span class="sxs-lookup"><span data-stu-id="76c7d-124">**IDirectDrawMediaStream**, for example, can create samples attached to a desired DirectDraw surface and clipping rectangle.</span></span> <span data-ttu-id="76c7d-125">Toutefois, dans certaines situations, vous devez gérer les données sans connaître leur format de données.</span><span class="sxs-lookup"><span data-stu-id="76c7d-125">In some situations, however, you must handle data without knowing about its data format.</span></span> <span data-ttu-id="76c7d-126">Si vous souhaitez diffuser en continu des données indépendantes de leur format, utilisez la méthode **IMediaStream :: CreateSharedSample** pour créer les exemples de données.</span><span class="sxs-lookup"><span data-stu-id="76c7d-126">If you want to stream data independent of its format, use the **IMediaStream::CreateSharedSample** method to create the data samples.</span></span>
5.  <span data-ttu-id="76c7d-127">Après avoir créé tous les exemples de flux souhaités, démarrez le flux en appelant la méthode [**IMultiMediaStream :: SetState**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-setstate) et transmettez l' \_ indicateur d’exécution STREAMSTATE en tant que paramètre.</span><span class="sxs-lookup"><span data-stu-id="76c7d-127">After creating all desired stream samples, start the stream by calling the [**IMultiMediaStream::SetState**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-setstate) method and pass in the STREAMSTATE\_RUN flag as its parameter.</span></span>
6.  <span data-ttu-id="76c7d-128">Appelez [**IStreamSample :: Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) pour mettre à jour l’exemple de flux.</span><span class="sxs-lookup"><span data-stu-id="76c7d-128">Call [**IStreamSample::Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) to update the stream sample.</span></span> <span data-ttu-id="76c7d-129">Quand la méthode **IStreamSample :: Update** se termine, vous pouvez accéder aux données de l’exemple.</span><span class="sxs-lookup"><span data-stu-id="76c7d-129">When the **IStreamSample::Update** method exits, you can access the sample's data.</span></span> <span data-ttu-id="76c7d-130">Si vous souhaitez déclencher un événement ou un appel de fonction spécifique lorsque la mise à jour est retournée, transmettez les pointeurs appropriés à la méthode **IStreamSample :: Update** .</span><span class="sxs-lookup"><span data-stu-id="76c7d-130">If you want a trigger a specific event or function call when the update returns, pass the appropriate pointers to the **IStreamSample::Update** method.</span></span>

<span data-ttu-id="76c7d-131">Pour plus d’informations sur les interfaces de diffusion multimédia en continu, consultez [diffusion multimédia en continu](multimedia-streaming.md).</span><span class="sxs-lookup"><span data-stu-id="76c7d-131">For more information on the multimedia streaming interfaces, see [Multimedia Streaming](multimedia-streaming.md).</span></span>

 

 



