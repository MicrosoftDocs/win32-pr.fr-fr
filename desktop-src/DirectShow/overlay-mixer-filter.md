---
description: Filtre du mixeur de superposition
ms.assetid: e80938b7-31f0-467b-a3fa-c4511d14758d
title: Filtre du mixeur de superposition
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d26ad8ba8a41a1cdb94eec0f4406c4845f25cda5
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "103845745"
---
# <a name="overlay-mixer-filter"></a><span data-ttu-id="bd58b-103">Filtre du mixeur de superposition</span><span class="sxs-lookup"><span data-stu-id="bd58b-103">Overlay Mixer Filter</span></span>

<span data-ttu-id="bd58b-104">Le filtre de mixage de superposition est un convertisseur vidéo conçu spécifiquement pour la lecture de DVD et la diffusion de flux vidéo avec un sous-titrage de ligne-21.</span><span class="sxs-lookup"><span data-stu-id="bd58b-104">The Overlay Mixer filter is a video renderer designed specifically for DVD playback and broadcast video streams with line-21 closed captioning.</span></span> <span data-ttu-id="bd58b-105">Le mélangeur de superposition prend également en charge les extensions de port vidéo (VPEs), ce qui lui permet de fonctionner avec des décodeurs matériels MPEG-2 ou des tuners TV analogiques qui envoient des vidéos directement à la carte graphique, plutôt que via le bus PCI.</span><span class="sxs-lookup"><span data-stu-id="bd58b-105">The Overlay Mixer also supports Video Port Extensions (VPEs), enabling it to work with hardware MPEG-2 decoders or analog TV tuners that send video directly to the graphics card, rather than over the PCI bus.</span></span>

> [!Note]  
> <span data-ttu-id="bd58b-106">Le [convertisseur de mixage vidéo 9](video-mixing-renderer-filter-9.md) est maintenant préféré par rapport au filtre de mixage de superposition, sauf dans les scénarios VPE.</span><span class="sxs-lookup"><span data-stu-id="bd58b-106">The [Video Mixing Renderer 9](video-mixing-renderer-filter-9.md) is now preferred over the Overlay Mixer filter, except in VPE scenarios.</span></span>

 

<span data-ttu-id="bd58b-107">Le mélangeur de superposition utilise DirectDraw pour le rendu.</span><span class="sxs-lookup"><span data-stu-id="bd58b-107">The Overlay Mixer uses DirectDraw for rendering.</span></span> <span data-ttu-id="bd58b-108">Elle nécessite une surface de recouvrement sur la carte graphique.</span><span class="sxs-lookup"><span data-stu-id="bd58b-108">It requires an overlay surface on the graphics card.</span></span> <span data-ttu-id="bd58b-109">Le flux vidéo principal doit être connecté à la broche 0.</span><span class="sxs-lookup"><span data-stu-id="bd58b-109">The primary video stream should be connected to pin 0.</span></span> <span data-ttu-id="bd58b-110">Les flux secondaires (graphiques de sous-titres ou sous-images de DVD) sont connectés aux broches 1 et ultérieure.</span><span class="sxs-lookup"><span data-stu-id="bd58b-110">Secondary streams (closed caption graphics or DVD subpictures) are connected to pins 1 and higher.</span></span> <span data-ttu-id="bd58b-111">Le mélangeur de superposition BLITS les flux secondaires directement sur le aire principal ; Il n’effectue pas de mélange ou d’alpha.</span><span class="sxs-lookup"><span data-stu-id="bd58b-111">The Overlay Mixer blits the secondary streams directly onto the primary suface; it does not mix or alpha blend them.</span></span>

<span data-ttu-id="bd58b-112">Le mélangeur de superposition utilise le convertisseur vidéo pour la gestion des fenêtres.</span><span class="sxs-lookup"><span data-stu-id="bd58b-112">The Overlay Mixer uses the Video Renderer for window management.</span></span> <span data-ttu-id="bd58b-113">Le convertisseur vidéo se connecte à la broche de sortie du mixer de superposition.</span><span class="sxs-lookup"><span data-stu-id="bd58b-113">The Video Renderer connects to the Overlay Mixer's output pin.</span></span>

<span data-ttu-id="bd58b-114">Ce filtre est automatiquement ajouté au graphique de filtre lorsque les applications utilisent les interfaces [**IDvdGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-idvdgraphbuilder) et [**ICaptureGraphBuilder2**](/windows/desktop/api/Strmif/nn-strmif-icapturegraphbuilder2) pour créer le graphique.</span><span class="sxs-lookup"><span data-stu-id="bd58b-114">This filter is added to the filter graph automatically when applications use the [**IDvdGraphBuilder**](/windows/desktop/api/Strmif/nn-strmif-idvdgraphbuilder) and [**ICaptureGraphBuilder2**](/windows/desktop/api/Strmif/nn-strmif-icapturegraphbuilder2) interfaces to create the graph.</span></span> <span data-ttu-id="bd58b-115">Le gestionnaire de graphes de filtre n’ajoute pas automatiquement le mélangeur de superposition au graphique.</span><span class="sxs-lookup"><span data-stu-id="bd58b-115">The Filter Graph Manager will not automatically add the Overlay Mixer to the graph.</span></span>

> [!Note]  
> <span data-ttu-id="bd58b-116">Dans le tableau suivant, les sous-types de médias acceptés sur la broche d’entrée 0 sont dépendants du matériel.</span><span class="sxs-lookup"><span data-stu-id="bd58b-116">In the following table, the media subtypes accepted on input pin 0 are hardware dependent.</span></span> <span data-ttu-id="bd58b-117">Le mélangeur de superposition ne peut pas déterminer si un sous-type particulier est pris en charge jusqu’à ce qu’il crée la surface DirectDraw.</span><span class="sxs-lookup"><span data-stu-id="bd58b-117">The Overlay Mixer cannot determine whether a particular subtype is supported until it creates the DirectDraw surface.</span></span> <span data-ttu-id="bd58b-118">Par conséquent, le seul moyen pour un filtre en amont de déterminer si un sous-type est pris en charge consiste à tenter une connexion avec ce sous-type.</span><span class="sxs-lookup"><span data-stu-id="bd58b-118">Therefore, the only way for an upstream filter to determine whether a subtype is supported is to attempt a connection with that subtype.</span></span>

 



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><span data-ttu-id="bd58b-119">Interfaces de filtre</span><span class="sxs-lookup"><span data-stu-id="bd58b-119">Filter Interfaces</span></span></td>
<td><span data-ttu-id="bd58b-120"><a href="/windows/desktop/api/Strmif/nn-strmif-iamoverlayfx"><strong>IAMOverlayFX</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iamvideodecimationproperties"><strong>IAMVideoDecimationProperties</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ibasefilter"><strong>IBaseFilter</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iddrawexclmodevideo"><strong>IDDrawExclModeVideo</strong></a>, <a href="ikspropertyset.md"><strong>IKsPropertySet</strong></a>, <a href="/windows/desktop/api/Control/nn-control-imediaposition"><strong>IMediaPosition</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-imediaseeking"><strong>IMediaSeeking</strong></a>, <a href="/previous-versions/windows/desktop/api/Mixerocx/nn-mixerocx-imixerocx"><strong>IMixerOCX</strong></a>, <a href="/previous-versions/windows/desktop/api/Amvideo/nn-amvideo-iqualprop"><strong>IQualProp</strong></a>, <a href="/previous-versions/windows/desktop/api/Vpnotify/nn-vpnotify-ivpnotify"><strong>IVPNotify</strong></a>, <a href="/previous-versions/windows/desktop/api/vpnotify/nn-vpnotify-ivpnotify2"><strong>IVPNotify2</strong></a></span><span class="sxs-lookup"><span data-stu-id="bd58b-120"><a href="/windows/desktop/api/Strmif/nn-strmif-iamoverlayfx"><strong>IAMOverlayFX</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iamvideodecimationproperties"><strong>IAMVideoDecimationProperties</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ibasefilter"><strong>IBaseFilter</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iddrawexclmodevideo"><strong>IDDrawExclModeVideo</strong></a>, <a href="ikspropertyset.md"><strong>IKsPropertySet</strong></a>, <a href="/windows/desktop/api/Control/nn-control-imediaposition"><strong>IMediaPosition</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-imediaseeking"><strong>IMediaSeeking</strong></a>, <a href="/previous-versions/windows/desktop/api/Mixerocx/nn-mixerocx-imixerocx"><strong>IMixerOCX</strong></a>, <a href="/previous-versions/windows/desktop/api/Amvideo/nn-amvideo-iqualprop"><strong>IQualProp</strong></a>, <a href="/previous-versions/windows/desktop/api/Vpnotify/nn-vpnotify-ivpnotify"><strong>IVPNotify</strong></a>, <a href="/previous-versions/windows/desktop/api/vpnotify/nn-vpnotify-ivpnotify2"><strong>IVPNotify2</strong></a></span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bd58b-121">Types de média de broche d’entrée</span><span class="sxs-lookup"><span data-stu-id="bd58b-121">Input Pin Media Types</span></span></td>
<td><span data-ttu-id="bd58b-122">Type majeur : MEDIATYPE_Video</span><span class="sxs-lookup"><span data-stu-id="bd58b-122">Major Type: MEDIATYPE_Video</span></span><br/> <span data-ttu-id="bd58b-123">Sous-types</span><span class="sxs-lookup"><span data-stu-id="bd58b-123">Subtypes:</span></span><br/>
<ul>
<li><span data-ttu-id="bd58b-124">MEDIASUBTYPE_Overlay (broche 0 uniquement)</span><span class="sxs-lookup"><span data-stu-id="bd58b-124">MEDIASUBTYPE_Overlay (pin 0 only)</span></span></li>
<li><span data-ttu-id="bd58b-125">Formats YUV DirectDraw (broche 0 uniquement)</span><span class="sxs-lookup"><span data-stu-id="bd58b-125">DirectDraw YUV formats (pin 0 only)</span></span></li>
<li><span data-ttu-id="bd58b-126">Formats d’accélération vidéo DirectDraw (broche 0 uniquement)</span><span class="sxs-lookup"><span data-stu-id="bd58b-126">DirectDraw Video Acceleration formats (pin 0 only)</span></span></li>
<li><span data-ttu-id="bd58b-127">Formats RVB DirectDraw (toutes les broches d’entrée)</span><span class="sxs-lookup"><span data-stu-id="bd58b-127">DirectDraw RGB formats (all input pins)</span></span></li>
</ul>
<span data-ttu-id="bd58b-128">Types de format :</span><span class="sxs-lookup"><span data-stu-id="bd58b-128">Format Types:</span></span><br/>
<ul>
<li><span data-ttu-id="bd58b-129">Format_VIDEOINFO</span><span class="sxs-lookup"><span data-stu-id="bd58b-129">Format_VIDEOINFO</span></span></li>
<li><span data-ttu-id="bd58b-130">Format_VIDEOINFO2</span><span class="sxs-lookup"><span data-stu-id="bd58b-130">Format_VIDEOINFO2</span></span></li>
</ul></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bd58b-131">Interfaces pin d’entrée</span><span class="sxs-lookup"><span data-stu-id="bd58b-131">Input Pin Interfaces</span></span></td>
<td><span data-ttu-id="bd58b-132"><a href="/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator"><strong>IAMVideoAccelerator</strong></a>, <a href="ikspin.md"><strong>IKsPin</strong></a>, <a href="ikspropertyset.md"><strong>IKsPropertySet</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-imeminputpin"><strong>IMemInputPin</strong></a>, <a href="/windows/desktop/api/Mpconfig/nn-mpconfig-imixerpinconfig"><strong>IMixerPinConfig</strong></a>, <a href="/windows/desktop/api/Mpconfig/nn-mpconfig-imixerpinconfig2"><strong>IMixerPinConfig2</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ioverlay"><strong>IOverlay</strong></a> (broche 0 uniquement), <a href="/windows/desktop/api/Strmif/nn-strmif-ipin"><strong>IPIN</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ipinconnection"><strong>IPinConnection, IQualityControl</strong></a>, <a href="/previous-versions/windows/desktop/api/Vpnotify/nn-vpnotify-ivpnotify"><strong>IVPNotify</strong></a>, <a href="/previous-versions/windows/desktop/api/vpnotify/nn-vpnotify-ivpnotify2"><strong>IVPNotify2</strong></a> <a href="/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol"><strong></strong></a></span><span class="sxs-lookup"><span data-stu-id="bd58b-132"><a href="/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator"><strong>IAMVideoAccelerator</strong></a>, <a href="ikspin.md"><strong>IKsPin</strong></a>, <a href="ikspropertyset.md"><strong>IKsPropertySet</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-imeminputpin"><strong>IMemInputPin</strong></a>, <a href="/windows/desktop/api/Mpconfig/nn-mpconfig-imixerpinconfig"><strong>IMixerPinConfig</strong></a>, <a href="/windows/desktop/api/Mpconfig/nn-mpconfig-imixerpinconfig2"><strong>IMixerPinConfig2</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ioverlay"><strong>IOverlay</strong></a> (pin 0 only), <a href="/windows/desktop/api/Strmif/nn-strmif-ipin"><strong>IPin</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ipinconnection"><strong>IPinConnection</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol"><strong>IQualityControl</strong></a>, <a href="/previous-versions/windows/desktop/api/Vpnotify/nn-vpnotify-ivpnotify"><strong>IVPNotify</strong></a>, <a href="/previous-versions/windows/desktop/api/vpnotify/nn-vpnotify-ivpnotify2"><strong>IVPNotify2</strong></a></span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bd58b-133">Types de média de broche de sortie</span><span class="sxs-lookup"><span data-stu-id="bd58b-133">Output Pin Media Types</span></span></td>
<td><span data-ttu-id="bd58b-134">MEDIATYPE_Video, MEDIASUBTYPE_Overlay</span><span class="sxs-lookup"><span data-stu-id="bd58b-134">MEDIATYPE_Video, MEDIASUBTYPE_Overlay</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bd58b-135">Interfaces de broche de sortie</span><span class="sxs-lookup"><span data-stu-id="bd58b-135">Output Pin Interfaces</span></span></td>
<td><span data-ttu-id="bd58b-136"><a href="/windows/desktop/api/Control/nn-control-imediaposition"><strong>IMediaPosition</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-imediaseeking"><strong>IMediaSeeking</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ipin"><strong>IPIN</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol"><strong>IQualityControl</strong></a></span><span class="sxs-lookup"><span data-stu-id="bd58b-136"><a href="/windows/desktop/api/Control/nn-control-imediaposition"><strong>IMediaPosition</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-imediaseeking"><strong>IMediaSeeking</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-ipin"><strong>IPin</strong></a>, <a href="/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol"><strong>IQualityControl</strong></a></span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bd58b-137">CLSID du filtre</span><span class="sxs-lookup"><span data-stu-id="bd58b-137">Filter CLSID</span></span></td>
<td><span data-ttu-id="bd58b-138">CLSID_OverlayMixer</span><span class="sxs-lookup"><span data-stu-id="bd58b-138">CLSID_OverlayMixer</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bd58b-139">CLSID de page de propriétés</span><span class="sxs-lookup"><span data-stu-id="bd58b-139">Property Page CLSID</span></span></td>
<td><span data-ttu-id="bd58b-140">Aucune page de propriétés.</span><span class="sxs-lookup"><span data-stu-id="bd58b-140">No property page.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bd58b-141">Exécutable</span><span class="sxs-lookup"><span data-stu-id="bd58b-141">Executable</span></span></td>
<td><span data-ttu-id="bd58b-142">qdvd.dll</span><span class="sxs-lookup"><span data-stu-id="bd58b-142">qdvd.dll</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bd58b-143"><a href="merit.md">Mérite</a></span><span class="sxs-lookup"><span data-stu-id="bd58b-143"><a href="merit.md">Merit</a></span></span></td>
<td><span data-ttu-id="bd58b-144">MERIT_DO_NOT_USE</span><span class="sxs-lookup"><span data-stu-id="bd58b-144">MERIT_DO_NOT_USE</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bd58b-145"><a href="filter-categories.md">Catégorie de filtre</a></span><span class="sxs-lookup"><span data-stu-id="bd58b-145"><a href="filter-categories.md">Filter Category</a></span></span></td>
<td><span data-ttu-id="bd58b-146">CLSID_LegacyAmFilterCategory</span><span class="sxs-lookup"><span data-stu-id="bd58b-146">CLSID_LegacyAmFilterCategory</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="remarks"></a><span data-ttu-id="bd58b-147">Notes</span><span class="sxs-lookup"><span data-stu-id="bd58b-147">Remarks</span></span>

<span data-ttu-id="bd58b-148">Le mélangeur de superposition utilise la clé de couleur de destination pour mélanger des surfaces vidéo avec des superpositions.</span><span class="sxs-lookup"><span data-stu-id="bd58b-148">The Overlay Mixer uses destination color keying to mix video surfaces with overlays.</span></span> <span data-ttu-id="bd58b-149">Elle BLITS la clé de couleur et la vidéo secondaire à la surface primaire, puis envoie la vidéo principale à la surface de recouvrement.</span><span class="sxs-lookup"><span data-stu-id="bd58b-149">It blits the color key and the secondary video to the primary surface, and sends the primary video to the overlay surface.</span></span> <span data-ttu-id="bd58b-150">La carte graphique compose ensuite les deux surfaces dans sa mémoire tampon de trame.</span><span class="sxs-lookup"><span data-stu-id="bd58b-150">The graphics card then composites the two surfaces into its frame buffer.</span></span>

<span data-ttu-id="bd58b-151">Pour vérifier si le pilote Graphics prend en charge la superposition matérielle, appelez **IDirectDraw7 :: GetCaps**.</span><span class="sxs-lookup"><span data-stu-id="bd58b-151">To test whether the graphics driver supports hardware overlay, call **IDirectDraw7::GetCaps**.</span></span> <span data-ttu-id="bd58b-152">Si le champ **dwMaxVisibleOverlays** de la structure **DDCAPS** est supérieur à zéro, le pilote prend en charge la superposition matérielle.</span><span class="sxs-lookup"><span data-stu-id="bd58b-152">If the **dwMaxVisibleOverlays** field in the **DDCAPS** structure is greater than zero, the driver supports hardware overlay.</span></span>

<span data-ttu-id="bd58b-153">Les applications peuvent contrôler certains comportements sur le mélangeur de superposition par le biais de l’interface [**IMixerPinConfig2**](/windows/desktop/api/Mpconfig/nn-mpconfig-imixerpinconfig2) .</span><span class="sxs-lookup"><span data-stu-id="bd58b-153">Applications can control some behaviors on the Overlay Mixer through the [**IMixerPinConfig2**](/windows/desktop/api/Mpconfig/nn-mpconfig-imixerpinconfig2) interface.</span></span> <span data-ttu-id="bd58b-154">Les développeurs de jeux peuvent utiliser le mélangeur de superposition pour afficher des vidéos en mode exclusif DirectDraw, comme décrit plus loin dans cette section.</span><span class="sxs-lookup"><span data-stu-id="bd58b-154">Game developers can use the Overlay Mixer to display video in DirectDraw Exclusive Mode, as described later in this section.</span></span> <span data-ttu-id="bd58b-155">Le [filtre de convertisseur de mixage vidéo 9](video-mixing-renderer-filter-9.md) (VMR-9) offre désormais une meilleure prise en charge de la vidéo dans les jeux.</span><span class="sxs-lookup"><span data-stu-id="bd58b-155">The [Video Mixing Renderer Filter 9](video-mixing-renderer-filter-9.md) (VMR-9) now provides better support for video in games, however.</span></span> <span data-ttu-id="bd58b-156">Pour plus d’informations, consultez [utilisation du convertisseur de mixage vidéo](using-the-video-mixing-renderer.md).</span><span class="sxs-lookup"><span data-stu-id="bd58b-156">For more information, see [Using the Video Mixing Renderer](using-the-video-mixing-renderer.md).</span></span>

<span data-ttu-id="bd58b-157">Les informations suivantes sont fournies à l’avantage des développeurs de filtres et des développeurs de jeux qui souhaitent utiliser le mélangeur de recouvrement en mode exclusif DirectDraw.</span><span class="sxs-lookup"><span data-stu-id="bd58b-157">The following information is provided for the benefit of filter developers, and game developers who want to use the Overlay Mixer in DirectDraw Exclusive Mode.</span></span>

<span data-ttu-id="bd58b-158">**Opérations internes du mélangeur de superposition**</span><span class="sxs-lookup"><span data-stu-id="bd58b-158">**Overlay Mixer Internal Operations**</span></span>

<span data-ttu-id="bd58b-159">Le mélangeur de superposition expose une broche d’entrée pour chaque flux entrant.</span><span class="sxs-lookup"><span data-stu-id="bd58b-159">The Overlay Mixer exposes an input pin for each incoming stream.</span></span> <span data-ttu-id="bd58b-160">En règle générale, il existe trois broches d’entrée : le code confidentiel 0 pour les données vidéo et les broches 1 et 2 pour les données de sous-image de ligne 21 et de DVD.</span><span class="sxs-lookup"><span data-stu-id="bd58b-160">Typically, there are three input pins: pin 0 for video data, and pins 1 and 2 for line 21 and DVD subpicture data.</span></span> <span data-ttu-id="bd58b-161">En interne, le mélangeur de superposition crée un objet DirectDraw avec une surface principale comprenant l’intégralité du bureau, plus une surface de recouvrement dont le rectangle est défini par la taille du flux vidéo sur la broche 0.</span><span class="sxs-lookup"><span data-stu-id="bd58b-161">Internally, the Overlay Mixer creates a DirectDraw object with a primary surface comprising the entire desktop, plus an overlay surface whose rectangle is defined by the size of the video stream on Pin 0.</span></span> <span data-ttu-id="bd58b-162">Si le décodeur ne spécifie pas de clé de couleur, le mélangeur de superposition utilise des clés de couleur par défaut : gris foncé pour les cartes graphiques plus récentes et le magenta pour les plus anciennes cartes de couleur 256.</span><span class="sxs-lookup"><span data-stu-id="bd58b-162">If the decoder does not specify a color key, the Overlay Mixer uses default color keys: dark gray for more recent graphics cards and magenta for older 256-color cards.</span></span>

> [!Note]  
> <span data-ttu-id="bd58b-163">Les résultats ne sont pas définis si le décodeur remet deux flux vidéo secondaires simultanément à la même place sur la surface de recouvrement.</span><span class="sxs-lookup"><span data-stu-id="bd58b-163">The results are undefined if the decoder delivers two secondary video streams simultaneously in the same place on the overlay surface.</span></span> <span data-ttu-id="bd58b-164">(Cela se produit parfois avec les DVD qui contiennent des flux de sous-image et de ligne 21.) La vidéo peut scintiller ou n’afficher qu’un seul flux.</span><span class="sxs-lookup"><span data-stu-id="bd58b-164">(This sometimes occurs with DVDs that contain subpicture and line 21 streams.) The video might flicker, or display only one of the streams.</span></span>

 

<span data-ttu-id="bd58b-165">Sur Windows Vista ou version ultérieure, le mélangeur de superposition désactive la composition du Gestionnaire de fenêtrage (DWM) si le pilote d’affichage prend en charge la superposition matérielle.</span><span class="sxs-lookup"><span data-stu-id="bd58b-165">On Windows Vista or later, the Overlay Mixer disables Desktop Window Manager (DWM) composition if the display driver supports hardware overlay.</span></span> <span data-ttu-id="bd58b-166">Les applications doivent éviter d’utiliser le filtre de mixage de superposition ; Utilisez VMR-9 ou le convertisseur vidéo amélioré (EVR) à la place.</span><span class="sxs-lookup"><span data-stu-id="bd58b-166">Applications should avoid using the Overlay Mixer filter; use the VMR-9 or the Enhanced Video Renderer (EVR) instead.</span></span>

<span data-ttu-id="bd58b-167">**Connexion amont avec le décodeur vidéo**</span><span class="sxs-lookup"><span data-stu-id="bd58b-167">**Upstream Connection with the Video Decoder**</span></span>

<span data-ttu-id="bd58b-168">En général, les broches d’entrée du mélangeur de superposition se connectent à un décodeur vidéo en amont.</span><span class="sxs-lookup"><span data-stu-id="bd58b-168">Typically the Overlay Mixer's input pins connect to an upstream video decoder.</span></span> <span data-ttu-id="bd58b-169">Le flux vidéo principal doit se connecter à la broche 0.</span><span class="sxs-lookup"><span data-stu-id="bd58b-169">The primary video stream must connect to the pin 0.</span></span> <span data-ttu-id="bd58b-170">La ligne 21 ou les flux de sous-image se connectent à la broche 1 ou supérieure.</span><span class="sxs-lookup"><span data-stu-id="bd58b-170">The line 21 or subpicture streams connect to pin 1 or greater.</span></span> <span data-ttu-id="bd58b-171">Si le décodeur est un décodeur logiciel qui utilise exclusivement le processeur hôte, la connexion entre le décodeur et la broche 0 est une connexion [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin) .</span><span class="sxs-lookup"><span data-stu-id="bd58b-171">If the decoder is a software decoder that uses the host CPU exclusively, the connection between the decoder and the Pin 0 is an [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin) connection.</span></span> <span data-ttu-id="bd58b-172">Si le décodeur utilise l’accélération matérielle, la connexion à la broche 0 doit utiliser le inferface [**IAMVideoAccelerator**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator) .</span><span class="sxs-lookup"><span data-stu-id="bd58b-172">If the decoder uses hardware acceleration, the connection to Pin 0 must use the [**IAMVideoAccelerator**](/previous-versions/windows/desktop/api/videoacc/nn-videoacc-iamvideoaccelerator) inferface.</span></span> <span data-ttu-id="bd58b-173">Ces deux types de connexions s’excluent mutuellement.</span><span class="sxs-lookup"><span data-stu-id="bd58b-173">These two types of connections are mutually exclusive.</span></span>

<span data-ttu-id="bd58b-174">Si le décodeur crée directement sur la surface de recouvrement, il doit utiliser l’interface [**IOverlay**](/windows/desktop/api/Strmif/nn-strmif-ioverlay) sur le pin 0 et implémenter l’interface [**IOverlayNotify**](/windows/desktop/api/Strmif/nn-strmif-ioverlaynotify) .</span><span class="sxs-lookup"><span data-stu-id="bd58b-174">If the decoder draws directly onto the overlay surface, it should use the [**IOverlay**](/windows/desktop/api/Strmif/nn-strmif-ioverlay) interface on pin 0 and implement the [**IOverlayNotify**](/windows/desktop/api/Strmif/nn-strmif-ioverlaynotify) interface.</span></span>

<span data-ttu-id="bd58b-175">Les filtres qui encapsulent un décodeur matériel et se connectent au mélangeur de superposition via un port vidéo doivent implémenter l’interface [**IVPConfig**](/previous-versions/windows/desktop/api/Vpconfig/nn-vpconfig-ivpconfig) .</span><span class="sxs-lookup"><span data-stu-id="bd58b-175">Filters that wrap a hardware decoder and connect to the Overlay Mixer through a video port must implement the [**IVPConfig**](/previous-versions/windows/desktop/api/Vpconfig/nn-vpconfig-ivpconfig) interface.</span></span> <span data-ttu-id="bd58b-176">Le mélangeur de superposition implémente l’interface [**IVPNotify**](/previous-versions/windows/desktop/api/Vpnotify/nn-vpnotify-ivpnotify) .</span><span class="sxs-lookup"><span data-stu-id="bd58b-176">The Overlay Mixer implements the [**IVPNotify**](/previous-versions/windows/desktop/api/Vpnotify/nn-vpnotify-ivpnotify) interface.</span></span> <span data-ttu-id="bd58b-177">Ces deux interfaces permettent au décodeur de spécifier les surfaces de recouvrement nécessaires, et elles permettent au mélangeur de superpositions d’informer le décodeur de l’emplacement de ces surfaces dans la mémoire vidéo.</span><span class="sxs-lookup"><span data-stu-id="bd58b-177">These two interfaces enable the decoder to specify the overlay surfaces it requires, and they enable the Overlay Mixer to inform the decoder of the location of those surfaces in video memory.</span></span>

<span data-ttu-id="bd58b-178">Le mélangeur de superposition garantit également que le rectangle vidéo est correctement mis à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="bd58b-178">The Overlay Mixer also ensures that the video rectangle is scaled correctly.</span></span> <span data-ttu-id="bd58b-179">La capture vidéo implique certains problèmes relatifs à la mise à l’échelle de l’image d’aperçu et à la capture d’images vidéo entrelacées.</span><span class="sxs-lookup"><span data-stu-id="bd58b-179">Video capture involves certain issues with respect to scaling the preview image and capturing interleaved video frames.</span></span> <span data-ttu-id="bd58b-180">Si vous développez un filtre ou un pilote WDM pour un périphérique de capture vidéo matérielle, reportez-vous aux pages de référence [**IVPConfig**](/previous-versions/windows/desktop/api/Vpconfig/nn-vpconfig-ivpconfig) et [**IVPNotify**](/previous-versions/windows/desktop/api/Vpnotify/nn-vpnotify-ivpnotify) pour plus d’informations sur ces rubriques.</span><span class="sxs-lookup"><span data-stu-id="bd58b-180">If you are developing a filter or WDM driver for a hardware video capture device, refer to the [**IVPConfig**](/previous-versions/windows/desktop/api/Vpconfig/nn-vpconfig-ivpconfig) and [**IVPNotify**](/previous-versions/windows/desktop/api/Vpnotify/nn-vpnotify-ivpnotify) reference pages for more information on these topics.</span></span>

<span data-ttu-id="bd58b-181">Le mélangeur de superposition n’est pas utilisé dans les scénarios de capture 1394 ou USB.</span><span class="sxs-lookup"><span data-stu-id="bd58b-181">The Overlay Mixer is not used in 1394 or USB capture scenarios.</span></span> <span data-ttu-id="bd58b-182">Il est utilisé lors de la capture vidéo sur le bus PCI.</span><span class="sxs-lookup"><span data-stu-id="bd58b-182">It is used in video capture over the PCI bus.</span></span>

<span data-ttu-id="bd58b-183">**Connexion en aval avec le convertisseur vidéo**</span><span class="sxs-lookup"><span data-stu-id="bd58b-183">**Downstream Connection with the Video Renderer**</span></span>

<span data-ttu-id="bd58b-184">Le mélangeur de superposition a une broche de sortie qui se connecte au filtre de [convertisseur vidéo](video-renderer-filter.md) .</span><span class="sxs-lookup"><span data-stu-id="bd58b-184">The Overlay Mixer has an output pin that connects to the [Video Renderer](video-renderer-filter.md) filter.</span></span> <span data-ttu-id="bd58b-185">Dans ce cas, le convertisseur vidéo n’affiche pas la vidéo ; Il gère simplement la fenêtre vidéo.</span><span class="sxs-lookup"><span data-stu-id="bd58b-185">The Video Renderer in this case does not render the video; it simply manages the video window.</span></span>

<span data-ttu-id="bd58b-186">La connexion de code confidentiel utilise l’interface [**IOverlay**](/windows/desktop/api/Strmif/nn-strmif-ioverlay) plutôt que l’interface [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin) .</span><span class="sxs-lookup"><span data-stu-id="bd58b-186">The pin connection uses the [**IOverlay**](/windows/desktop/api/Strmif/nn-strmif-ioverlay) interface rather than the [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin) interface.</span></span> <span data-ttu-id="bd58b-187">Le convertisseur vidéo passe son handle de fenêtre par le biais du mélangeur de superposition à DirectDraw, qui gère le découpage de rectangle.</span><span class="sxs-lookup"><span data-stu-id="bd58b-187">The Video Renderer passes its window handle through the Overlay Mixer to DirectDraw, which manages the rectangle clipping.</span></span> <span data-ttu-id="bd58b-188">Les applications peuvent contrôler le convertisseur vidéo par le biais des interfaces [**IVideoWindow**](/windows/desktop/api/Control/nn-control-ivideowindow) et [**IBasicVideo2**](/windows/desktop/api/Control/nn-control-ibasicvideo2) sur le gestionnaire de graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="bd58b-188">Applications can control the Video Renderer through the [**IVideoWindow**](/windows/desktop/api/Control/nn-control-ivideowindow) and [**IBasicVideo2**](/windows/desktop/api/Control/nn-control-ibasicvideo2) interfaces on the Filter Graph Manager.</span></span>

<span data-ttu-id="bd58b-189">**Mode exclusif DirectDraw**</span><span class="sxs-lookup"><span data-stu-id="bd58b-189">**DirectDraw Exclusive Mode**</span></span>

<span data-ttu-id="bd58b-190">Le mode DirectDraw en mode exclusif de mixer de superposition permet aux jeux d’afficher des vidéos sur une partie de l’écran.</span><span class="sxs-lookup"><span data-stu-id="bd58b-190">The Overlay Mixer's DirectDraw exclusive mode enables games to display video on some part of the screen.</span></span> <span data-ttu-id="bd58b-191">Dans ce mode, le mélangeur de superposition affiche la vidéo directement sur une surface DirectDraw créée par l’application de jeu, plutôt que sur une fenêtre fournie par le convertisseur vidéo.</span><span class="sxs-lookup"><span data-stu-id="bd58b-191">In this mode, the Overlay Mixer renders the video directly to a DirectDraw surface created by the game application, rather than to a window provided by the Video Renderer.</span></span> <span data-ttu-id="bd58b-192">Cela permet aux jeux de contrôler la clé de couleur.</span><span class="sxs-lookup"><span data-stu-id="bd58b-192">This enables games to control the color key.</span></span> <span data-ttu-id="bd58b-193">Le mélangeur de superposition n’affiche qu’une seule broche d’entrée en mode exclusif DirectDraw, ce qui signifie qu’aucune combinaison de la ligne 21 ou de la sous-image de DVD ne peut être effectuée dans ce mode.</span><span class="sxs-lookup"><span data-stu-id="bd58b-193">The Overlay Mixer exposes only one input pin in DirectDraw exclusive mode, which means that no mixing of Line 21 or DVD subpicture can be performed in this mode.</span></span>

<span data-ttu-id="bd58b-194">Pour utiliser le mélangeur de superposition en mode exclusif DirectDraw, créez une instance du mélangeur de superposition et interrogez-le pour l’interface [**IDDrawExclModeVideo**](/windows/desktop/api/Strmif/nn-strmif-iddrawexclmodevideo) avant de générer le graphique de filtre.</span><span class="sxs-lookup"><span data-stu-id="bd58b-194">To use the Overlay Mixer in DirectDraw exclusive mode, create an instance of the Overlay Mixer and query it for the [**IDDrawExclModeVideo**](/windows/desktop/api/Strmif/nn-strmif-iddrawexclmodevideo) interface before building the filter graph.</span></span> <span data-ttu-id="bd58b-195">Appelez ensuite [**IDDrawExclModeVideo :: SetDDrawSurface**](/windows/desktop/api/Strmif/nf-strmif-iddrawexclmodevideo-setddrawsurface) pour spécifier la surface DirectDraw pour le rendu.</span><span class="sxs-lookup"><span data-stu-id="bd58b-195">Then call [**IDDrawExclModeVideo::SetDDrawSurface**](/windows/desktop/api/Strmif/nf-strmif-iddrawexclmodevideo-setddrawsurface) to specify the DirectDraw surface for rendering.</span></span> <span data-ttu-id="bd58b-196">Une limitation significative de ce mode est que le jeu n’obtient pas l’accès aux bits vidéo réels.</span><span class="sxs-lookup"><span data-stu-id="bd58b-196">One significant limitation of this mode is that the game does not get access to the actual video bits.</span></span> <span data-ttu-id="bd58b-197">Si vous utilisez **IDDrawExclModeVideo**, votre application crée la surface principale et le mélangeur de superposition crée la surface de recouvrement.</span><span class="sxs-lookup"><span data-stu-id="bd58b-197">If you use **IDDrawExclModeVideo**, your application creates the primary surface, and the Overlay Mixer creates the overlay surface.</span></span>

<span data-ttu-id="bd58b-198">Vous pouvez également utiliser le mode exclusif DirectDraw pour effectuer un rendu sans fenêtre (par exemple, dans une page Web), mais cela n’est pas recommandé, car le mélangeur de superposition n’effectue pas de mélange dans ce mode.</span><span class="sxs-lookup"><span data-stu-id="bd58b-198">You can also use DirectDraw exclusive mode to perform windowless rendering—for example, in a Web page—but this is not recommended, because the Overlay Mixer does not perform any mixing in this mode.</span></span> <span data-ttu-id="bd58b-199">Cela signifie qu’aucune donnée de ligne 21 ou de sous-image ne peut être affichée.</span><span class="sxs-lookup"><span data-stu-id="bd58b-199">This means that no line 21 or subpicture data can be displayed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="bd58b-200">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="bd58b-200">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bd58b-201">Filtres DirectShow</span><span class="sxs-lookup"><span data-stu-id="bd58b-201">DirectShow Filters</span></span>](directshow-filters.md)
</dt> </dl>

 

 




