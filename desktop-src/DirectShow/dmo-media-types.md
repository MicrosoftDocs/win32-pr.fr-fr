---
description: Types de médias DMO
ms.assetid: 40958e12-09c7-4ce5-aa4d-5ed8b1f40aa3
title: Types de médias DMO
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1997abb1cc3c8eb10301778982ef7a46690855ed
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/03/2021
ms.locfileid: "104530550"
---
# <a name="dmo-media-types"></a><span data-ttu-id="00bb7-103">Types de médias DMO</span><span class="sxs-lookup"><span data-stu-id="00bb7-103">DMO Media Types</span></span>

<span data-ttu-id="00bb7-104">Un type de média décrit le format associé à un flux de données multimédias.</span><span class="sxs-lookup"><span data-stu-id="00bb7-104">A media type describes the format associated with a stream of media data.</span></span> <span data-ttu-id="00bb7-105">Cet article explique comment DMOs gère les types de médias.</span><span class="sxs-lookup"><span data-stu-id="00bb7-105">This article describes how DMOs handle media types.</span></span> <span data-ttu-id="00bb7-106">Il est principalement destiné aux développeurs qui écrivent leur propre DMOs personnalisé.</span><span class="sxs-lookup"><span data-stu-id="00bb7-106">It is primarily intended for developers who are writing their own custom DMOs.</span></span>

<span data-ttu-id="00bb7-107">Les types de média sont définis à l’aide de la structure de [**\_ \_ type de média DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) .</span><span class="sxs-lookup"><span data-stu-id="00bb7-107">Media types are defined using the [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure.</span></span> <span data-ttu-id="00bb7-108">Cette structure comprend les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="00bb7-108">This structure includes the following information:</span></span>

-   <span data-ttu-id="00bb7-109">Le *type principal* est un identificateur global unique (Guid) qui définit une catégorie étendue, telle que l’audio ou la vidéo.</span><span class="sxs-lookup"><span data-stu-id="00bb7-109">The *major type* is a globally unique identifier (GUID) that defines a broad category, such as audio or video.</span></span>
-   <span data-ttu-id="00bb7-110">Le *sous-type* est un GUID qui définit des aspects plus spécifiques du type.</span><span class="sxs-lookup"><span data-stu-id="00bb7-110">The *subtype* is a GUID that defines more specific aspects of the type.</span></span> <span data-ttu-id="00bb7-111">Par exemple, dans la vidéo, les sous-types sont les suivants : RVB 16 bits, RVB 24 bits, UYVY, vidéo encodée au format DV, etc.</span><span class="sxs-lookup"><span data-stu-id="00bb7-111">For example, within video, the subtypes include 16-bit RGB, 24-bit RGB, UYVY, DV-encoded video, and so forth.</span></span>
-   <span data-ttu-id="00bb7-112">Le *bloc de format* est une structure secondaire qui spécifie le format de manière complète.</span><span class="sxs-lookup"><span data-stu-id="00bb7-112">The *format block* is a secondary structure that fully specifies the format.</span></span> <span data-ttu-id="00bb7-113">La disposition du bloc de format dépend du type de données.</span><span class="sxs-lookup"><span data-stu-id="00bb7-113">The layout of the format block depends on the type of data.</span></span> <span data-ttu-id="00bb7-114">Par exemple, le son PCM utilise la structure **WAVEFORMATEX** .</span><span class="sxs-lookup"><span data-stu-id="00bb7-114">For example, PCM audio uses the **WAVEFORMATEX** structure.</span></span> <span data-ttu-id="00bb7-115">La vidéo utilise diverses autres structures, notamment **VIDEOINFOHEADER** et **VIDEOINFOHEADER2**.</span><span class="sxs-lookup"><span data-stu-id="00bb7-115">Video uses various other structures, including **VIDEOINFOHEADER** and **VIDEOINFOHEADER2**.</span></span> <span data-ttu-id="00bb7-116">La disposition du bloc de format est identifiée par un GUID de type de format.</span><span class="sxs-lookup"><span data-stu-id="00bb7-116">The layout of the format block is identified by a format type GUID.</span></span> <span data-ttu-id="00bb7-117">Par exemple, \_ le format WaveFormatEx spécifie une structure **WaveFormatEx** .</span><span class="sxs-lookup"><span data-stu-id="00bb7-117">For example, FORMAT\_WaveFormatEx specifies a **WAVEFORMATEX** structure.</span></span>

<span data-ttu-id="00bb7-118">Lors de la création d’un DMO, les flux n’ont pas de type de média.</span><span class="sxs-lookup"><span data-stu-id="00bb7-118">When a DMO is first created, the streams do not have a media type.</span></span> <span data-ttu-id="00bb7-119">Pour que la méthode DMO puisse traiter des données, le client doit définir un type de support pour chaque flux.</span><span class="sxs-lookup"><span data-stu-id="00bb7-119">Before the DMO can process any data, the client must set a media type for each stream.</span></span> <span data-ttu-id="00bb7-120">Ce processus est décrit du point de vue du client dans la [définition des types de média sur un DMO](setting-media-types-on-a-dmo.md).</span><span class="sxs-lookup"><span data-stu-id="00bb7-120">This process is described from the client's perspective in [Setting Media Types on a DMO](setting-media-types-on-a-dmo.md).</span></span>

<span data-ttu-id="00bb7-121">**Types de médias dans le registre**</span><span class="sxs-lookup"><span data-stu-id="00bb7-121">**Media Types in the Registry**</span></span>

<span data-ttu-id="00bb7-122">Un DMO peut ajouter une liste de types de médias qu’il prend en charge au registre, en appelant la fonction [**DMORegister**](/previous-versions/windows/desktop/api/Dmoreg/nf-dmoreg-dmoregister) .</span><span class="sxs-lookup"><span data-stu-id="00bb7-122">A DMO can add a list of media types that it supports to the registry, by calling the [**DMORegister**](/previous-versions/windows/desktop/api/Dmoreg/nf-dmoreg-dmoregister) function.</span></span> <span data-ttu-id="00bb7-123">Une application peut utiliser ces informations pour rechercher des DMOs qui correspondent à un format particulier.</span><span class="sxs-lookup"><span data-stu-id="00bb7-123">An application can use this information to search for DMOs that match a particular format.</span></span> <span data-ttu-id="00bb7-124">Les informations du registre ne sont pas destinées à être complètes.</span><span class="sxs-lookup"><span data-stu-id="00bb7-124">The information in the registry is not meant to be comprehensive.</span></span> <span data-ttu-id="00bb7-125">En règle générale, vous n’incluez que les principaux types pris en charge par DMO.</span><span class="sxs-lookup"><span data-stu-id="00bb7-125">Typically, you would include only the main types that the DMO supports.</span></span> <span data-ttu-id="00bb7-126">L’entrée de registre a des clés distinctes pour les types d’entrée et de sortie, mais elle ne fait pas la distinction entre les flux individuels.</span><span class="sxs-lookup"><span data-stu-id="00bb7-126">The registry entry has separate keys for input and output types, but does not distinguish among individual streams.</span></span>

<span data-ttu-id="00bb7-127">La fonction **DMORegister** utilise la structure de [**\_ \_ MediaType partielle DMO**](/previous-versions/windows/desktop/api/Dmoreg/ns-dmoreg-dmo_partial_mediatype) pour décrire les types de médias.</span><span class="sxs-lookup"><span data-stu-id="00bb7-127">The **DMORegister** function uses the [**DMO\_PARTIAL\_MEDIATYPE**](/previous-versions/windows/desktop/api/Dmoreg/ns-dmoreg-dmo_partial_mediatype) structure to describe media types.</span></span> <span data-ttu-id="00bb7-128">Cette structure contient un sous-ensemble des informations trouvées dans la structure de **\_ \_ type de média DMO** , à savoir le type principal et le sous-type.</span><span class="sxs-lookup"><span data-stu-id="00bb7-128">This structure contains a subset of the information found in the **DMO\_MEDIA\_TYPE** structure—namely the major type and the subtype.</span></span> <span data-ttu-id="00bb7-129">Il n’inclut pas de bloc de format, car le bloc de format contient généralement des informations qui sont trop précises pour être incluses dans le registre, telles que la hauteur et la largeur d’une image vidéo.</span><span class="sxs-lookup"><span data-stu-id="00bb7-129">It does not include a format block, because the format block typically contains information that is too granular to include in the registry, such as the height and width of a video image.</span></span>

<span data-ttu-id="00bb7-130">**Types de médias préférés**</span><span class="sxs-lookup"><span data-stu-id="00bb7-130">**Preferred Media Types**</span></span>

<span data-ttu-id="00bb7-131">Une fois que l’application a créé un DMO, il peut interroger le module DMO pour obtenir les types de médias pris en charge.</span><span class="sxs-lookup"><span data-stu-id="00bb7-131">After the application has created a DMO, it can query the DMO for the media types it supports.</span></span> <span data-ttu-id="00bb7-132">Pour chaque flux, DMO crée une liste de types de médias (éventuellement vides), classée par ordre de préférence.</span><span class="sxs-lookup"><span data-stu-id="00bb7-132">For each stream, the DMO creates a list of media types (possibly empty), ranked in order of preference.</span></span> <span data-ttu-id="00bb7-133">Les méthodes [**IMediaObject :: GetInputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputtype) et [**IMediaObject :: GetOutputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputtype) énumèrent les types préférés.</span><span class="sxs-lookup"><span data-stu-id="00bb7-133">The [**IMediaObject::GetInputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputtype) and [**IMediaObject::GetOutputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputtype) methods enumerate the preferred types.</span></span> <span data-ttu-id="00bb7-134">Les types préférés d’un flux peuvent changer dynamiquement lorsque l’application définit des types de média sur d’autres flux.</span><span class="sxs-lookup"><span data-stu-id="00bb7-134">A stream's preferred types can change dynamically when the application sets media types on other streams.</span></span> <span data-ttu-id="00bb7-135">Par exemple, la liste des types de sortie préférés peut changer une fois que le type d’entrée est défini, ou vice versa.</span><span class="sxs-lookup"><span data-stu-id="00bb7-135">For example, the list of preferred output types might change after the input type is set, or vice versa.</span></span> <span data-ttu-id="00bb7-136">Toutefois, la solution DMO n’est pas requise pour mettre à jour les types préférés de manière dynamique.</span><span class="sxs-lookup"><span data-stu-id="00bb7-136">However, the DMO is not required to update its preferred types dynamically.</span></span> <span data-ttu-id="00bb7-137">L’application ne peut pas supposer que chaque type qu’elle reçoit est valide.</span><span class="sxs-lookup"><span data-stu-id="00bb7-137">The application cannot assume that every type it receives is valid.</span></span> <span data-ttu-id="00bb7-138">Pour cette raison, les méthodes [**IMediaObject :: SetInputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-setinputtype) et [**IMediaObject :: SetOutputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-setoutputtype) prennent en charge un indicateur pour tester un type spécifique.</span><span class="sxs-lookup"><span data-stu-id="00bb7-138">For this reason, the [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-setinputtype) and [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-setoutputtype) methods support a flag for testing a specific type.</span></span>

<span data-ttu-id="00bb7-139">Les méthodes **GetInputType** et **GetOutputType** retournent toutes deux une structure de **\_ \_ type de média DMO** .</span><span class="sxs-lookup"><span data-stu-id="00bb7-139">The **GetInputType** and **GetOutputType** methods both return a **DMO\_MEDIA\_TYPE** structure.</span></span> <span data-ttu-id="00bb7-140">La DMO peut laisser une partie des informations de cette structure vide pour indiquer une plage de types.</span><span class="sxs-lookup"><span data-stu-id="00bb7-140">The DMO can leave some of the information in this structure blank, to indicate a range of types.</span></span> <span data-ttu-id="00bb7-141">Le type ou sous-type principal peut être un GUID \_ null, et le bloc de format peut être vide (zéro octet).</span><span class="sxs-lookup"><span data-stu-id="00bb7-141">The major type or subtype can be GUID\_NULL, and the format block can be empty (zero bytes).</span></span> <span data-ttu-id="00bb7-142">Si le bloc de format est vide, le type de format doit être GUID \_ null.</span><span class="sxs-lookup"><span data-stu-id="00bb7-142">If the format block is empty, the format type must be GUID\_NULL.</span></span>

<span data-ttu-id="00bb7-143">Une fois que l’application a défini tous les types d’entrée d’DMO, DMO doit généralement retourner au moins un type complet pour chaque flux de sortie.</span><span class="sxs-lookup"><span data-stu-id="00bb7-143">After the application sets all of a DMO's input types, the DMO should generally return at least one complete type for each output stream.</span></span> <span data-ttu-id="00bb7-144">Un type de sortie complet facilite les tests, et les applications peuvent l’utiliser comme valeur par défaut raisonnable.</span><span class="sxs-lookup"><span data-stu-id="00bb7-144">A complete output type facilitates testing, and applications can use it as a reasonable default.</span></span> <span data-ttu-id="00bb7-145">L’application de test DMO s’appuie sur ce comportement.</span><span class="sxs-lookup"><span data-stu-id="00bb7-145">The DMO test application relies on this behavior.</span></span> <span data-ttu-id="00bb7-146">(Consultez [utilisation de l’application DMOTest](using-the-dmotest-application.md).)</span><span class="sxs-lookup"><span data-stu-id="00bb7-146">(See [Using the DMOTest Application](using-the-dmotest-application.md).)</span></span>

<span data-ttu-id="00bb7-147">**Définition des types de médias**</span><span class="sxs-lookup"><span data-stu-id="00bb7-147">**Setting the Media Types**</span></span>

<span data-ttu-id="00bb7-148">Les applications utilisent les méthodes **SetInputType** et **SetOutputType** pour tester, définir ou effacer des types dans un flux spécifié.</span><span class="sxs-lookup"><span data-stu-id="00bb7-148">Applications use the **SetInputType** and **SetOutputType** methods to test, set, or clear types on a specified stream.</span></span> <span data-ttu-id="00bb7-149">L’application doit spécifier entièrement le type.</span><span class="sxs-lookup"><span data-stu-id="00bb7-149">The application must fully specify the type.</span></span> <span data-ttu-id="00bb7-150">Le DMO vérifie s’il peut accepter le type proposé.</span><span class="sxs-lookup"><span data-stu-id="00bb7-150">The DMO verifies whether it can accept the proposed type.</span></span> <span data-ttu-id="00bb7-151">La réponse peut dépendre des types qui ont été définis sur d’autres flux.</span><span class="sxs-lookup"><span data-stu-id="00bb7-151">The answer may depend on which types have been set on other streams.</span></span> <span data-ttu-id="00bb7-152">L' \_ indicateur DMO Set \_ TYPEF \_ Clear efface le type d’un flux, de sorte que l’application peut « revenir en arrière » et essayer une autre combinaison.</span><span class="sxs-lookup"><span data-stu-id="00bb7-152">The DMO\_SET\_TYPEF\_CLEAR flag clears a stream's type, so the application can "back out" and try another combination.</span></span>

<span data-ttu-id="00bb7-153">**Exemples de scénarios**</span><span class="sxs-lookup"><span data-stu-id="00bb7-153">**Example Scenarios**</span></span>

<span data-ttu-id="00bb7-154">Les exemples suivants décrivent certains scénarios typiques, afin d’illustrer les points des sections précédentes.</span><span class="sxs-lookup"><span data-stu-id="00bb7-154">The following examples describe some typical scenarios, to illustrate the points made in the previous sections.</span></span>

-   <span data-ttu-id="00bb7-155">**Décodeurs vidéo.**</span><span class="sxs-lookup"><span data-stu-id="00bb7-155">**Video Decoders.**</span></span> <span data-ttu-id="00bb7-156">Dans un décodeur vidéo classique, le type d’entrée détermine en partie le type de sortie.</span><span class="sxs-lookup"><span data-stu-id="00bb7-156">In a typical video decoder, the input type partly determines the output type.</span></span> <span data-ttu-id="00bb7-157">Par exemple, les deux flux doivent généralement avoir la même fréquence d’images et les mêmes dimensions d’image.</span><span class="sxs-lookup"><span data-stu-id="00bb7-157">For example, usually both streams must have the same frame rate and image dimensions.</span></span> <span data-ttu-id="00bb7-158">L’une des options consiste à ne pas définir de types de sortie préférés tant que le type d’entrée n’est pas défini.</span><span class="sxs-lookup"><span data-stu-id="00bb7-158">One option is not to define any preferred output types until the input type is set.</span></span> <span data-ttu-id="00bb7-159">Une autre option consiste à énumérer un ensemble de types incomplets, en omettant le bloc de format.</span><span class="sxs-lookup"><span data-stu-id="00bb7-159">Another option is to enumerate a set of incomplete types, omitting the format block.</span></span> <span data-ttu-id="00bb7-160">Utilisez le sous-type pour indiquer les types non compressés pris en charge, tels que RVB 16 bits, RVB 24 bits, etc.</span><span class="sxs-lookup"><span data-stu-id="00bb7-160">Use the subtype to indicate the supported uncompressed types, such as 16-bit RGB, 24-bit RGB, and so forth.</span></span> <span data-ttu-id="00bb7-161">En outre, les décodeurs vidéo ne prennent généralement pas en charge la définition du type de sortie avant le type d’entrée.</span><span class="sxs-lookup"><span data-stu-id="00bb7-161">Also, video decoders generally do not support setting the output type before the input type.</span></span> <span data-ttu-id="00bb7-162">Le scénario habituel consiste à décoder à partir d’un format d’entrée connu. cette limitation est donc raisonnable.</span><span class="sxs-lookup"><span data-stu-id="00bb7-162">The usual scenario is to decode from a known input format, so this limitation is reasonable.</span></span>
-   <span data-ttu-id="00bb7-163">**Décodeurs audio.**</span><span class="sxs-lookup"><span data-stu-id="00bb7-163">**Audio Decoders.**</span></span> <span data-ttu-id="00bb7-164">Un décodeur audio peut prendre en charge un ensemble limité de formats de sortie.</span><span class="sxs-lookup"><span data-stu-id="00bb7-164">An audio decoder might support a limited, fixed set of output formats.</span></span> <span data-ttu-id="00bb7-165">Dans ce cas, il peut être en mesure de créer une liste de formats de sortie préférés avant que le format d’entrée soit connu.</span><span class="sxs-lookup"><span data-stu-id="00bb7-165">In that case, it may be able to create a list of preferred output formats before the input format is known.</span></span>
-   <span data-ttu-id="00bb7-166">**Compresseurs.**</span><span class="sxs-lookup"><span data-stu-id="00bb7-166">**Compressors.**</span></span> <span data-ttu-id="00bb7-167">Dans la plupart des cas, un compresseur vidéo ne peut pas spécifier entièrement ses formats de sortie préférés tant que l’application n’a pas défini le format d’entrée, et vice versa.</span><span class="sxs-lookup"><span data-stu-id="00bb7-167">In most cases, a video compressor cannot fully specify its preferred output formats until the application sets the input format, and vice versa.</span></span> <span data-ttu-id="00bb7-168">Au lieu de cela, DMO doit retourner un type incomplet sans bloc de format.</span><span class="sxs-lookup"><span data-stu-id="00bb7-168">Instead, the DMO should return an incomplete type with no format block.</span></span> <span data-ttu-id="00bb7-169">Pour la compression audio et vidéo, l’application doit généralement définir différents paramètres de sortie, tels que la vitesse de transmission.</span><span class="sxs-lookup"><span data-stu-id="00bb7-169">For both audio and video compression, the application usually needs to set various output parameters, such as the bit rate.</span></span> <span data-ttu-id="00bb7-170">Toutefois, une fois que le type d’entrée est défini, le compresseur doit retourner au moins un type de sortie complet, pour les raisons mentionnées précédemment.</span><span class="sxs-lookup"><span data-stu-id="00bb7-170">However, after the input type is set, the compressor should return at least one complete output type, for the reasons mentioned previously.</span></span>

## <a name="related-topics"></a><span data-ttu-id="00bb7-171">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="00bb7-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="00bb7-172">Écriture d’un DMO</span><span class="sxs-lookup"><span data-stu-id="00bb7-172">Writing a DMO</span></span>](writing-a-dmo.md)
</dt> </dl>

 

 



