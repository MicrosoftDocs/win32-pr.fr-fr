---
title: Présentation de l’architecture
description: Cette vue d’ensemble de l’architecture fournit un contexte pour l’API tactile Windows pour les technologies tablette et Touch et explique comment elle s’intègre à l’architecture Windows 7 plus grande.
ms.assetid: b284e96f-0998-408c-ae84-92a3acdc3014
keywords:
- Windows Touch, vue d’ensemble de l’architecture
- Tactile Windows, manipulations
- Tactile Windows, messages
- Tactile Windows, inertie
- Tactile Windows, gestes
- mouvements, à propos de
- manipulations, à propos de
- inertie, à propos de
- processeur de manipulation, vue d’ensemble de l’architecture
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b807113211d77f0aad0ed01fc24570d033063474
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103941007"
---
# <a name="architectural-overview"></a><span data-ttu-id="cbe85-112">Présentation de l’architecture</span><span class="sxs-lookup"><span data-stu-id="cbe85-112">Architectural Overview</span></span>

<span data-ttu-id="cbe85-113">Cette vue d’ensemble de l’architecture fournit un contexte pour l’API tactile Windows pour les technologies tablette et Touch et explique comment elle s’intègre à l’architecture Windows 7 plus grande.</span><span class="sxs-lookup"><span data-stu-id="cbe85-113">This architectural overview provides context for the Windows Touch API for Tablet and Touch Technologies and explains how it fits into the larger Windows 7 architecture.</span></span>

## <a name="messages-for-windows-touch-input-and-gestures"></a><span data-ttu-id="cbe85-114">Messages pour les entrées tactiles et les gestes Windows</span><span class="sxs-lookup"><span data-stu-id="cbe85-114">Messages for Windows Touch Input and Gestures</span></span>

<span data-ttu-id="cbe85-115">Les fonctionnalités de messagerie pour Windows Touch sont activées en écoutant et en interprétant les messages pendant l’exécution.</span><span class="sxs-lookup"><span data-stu-id="cbe85-115">Messaging features for Windows Touch are enabled by listening and interpreting messages during execution.</span></span> <span data-ttu-id="cbe85-116">L’illustration suivante montre comment les messages sont générés à partir du matériel et envoyés aux applications par Windows 7.</span><span class="sxs-lookup"><span data-stu-id="cbe85-116">The following illustration shows how messages are generated from hardware and sent to applications by Windows 7.</span></span>

![Illustration montrant comment Windows 7 envoie des messages à partir d’un matériel tactile multipoint vers une application](images/wm-multitouch-messaging.png)

<span data-ttu-id="cbe85-118">Dans la colonne la plus à gauche de l’illustration, le matériel tactile reçoit l’entrée d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cbe85-118">In the leftmost column of the illustration, touch-sensitive hardware receives input from a user.</span></span> <span data-ttu-id="cbe85-119">Un pilote communique ensuite entre le matériel et le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="cbe85-119">A driver then communicates between the hardware and the OS.</span></span> <span data-ttu-id="cbe85-120">Ensuite, le système d’exploitation génère un message [**de \_ mouvement**](wm-gesture.md) [**WM \_ Touch**](wm-touchdown.md) ou WM qui est ensuite envoyé au HWND d’une application.</span><span class="sxs-lookup"><span data-stu-id="cbe85-120">Next, the OS generates a [**WM\_TOUCH**](wm-touchdown.md) or [**WM\_GESTURE**](wm-gesture.md) message that is then sent to an application's HWND.</span></span> <span data-ttu-id="cbe85-121">L’application met ensuite à jour l’interface utilisateur en fonction des informations encapsulées dans le message.</span><span class="sxs-lookup"><span data-stu-id="cbe85-121">The application then updates the UI given the information encapsulated in the message.</span></span>

<span data-ttu-id="cbe85-122">Par défaut, les applications reçoivent des mouvements.</span><span class="sxs-lookup"><span data-stu-id="cbe85-122">Applications receive gestures by default.</span></span> <span data-ttu-id="cbe85-123">Sauf si une application s’inscrit pour les messages d’entrée tactile Windows avec la fonction [**RegisterTouchWindow**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow) , les notifications de mouvements (messages de [**\_ mouvement WM**](wm-gesture.md) ) sont créées par Windows et envoyées à cette fenêtre d’application.</span><span class="sxs-lookup"><span data-stu-id="cbe85-123">Unless an application registers for Windows Touch input messages with the [**RegisterTouchWindow**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow) function, notifications for gestures ([**WM\_GESTURE**](wm-gesture.md) messages) are created by Windows and sent to that application window.</span></span> <span data-ttu-id="cbe85-124">Si une fenêtre d’application s’inscrit pour recevoir des messages tactiles, les notifications d’entrée tactile Windows (messages [**WM \_ Touch**](wm-touchdown.md) ) sont envoyées à cette fenêtre d’application.</span><span class="sxs-lookup"><span data-stu-id="cbe85-124">If an application Window registers to receive touch messages, notifications for Windows Touch input ([**WM\_TOUCH**](wm-touchdown.md) messages) are sent to that application window.</span></span> <span data-ttu-id="cbe85-125">Les messages tactiles et de mouvement Windows sont gourmands en ce sens qu’une fois que le toucher est effectué ou qu’un mouvement commence dans une fenêtre d’application, tous les messages sont envoyés à cette application jusqu’à ce que le geste se termine ou que la touche tactile principale soit terminée.</span><span class="sxs-lookup"><span data-stu-id="cbe85-125">Windows Touch and gesture messages are greedy in the sense that after a touch is made or a gesture begins on an application Window, all messages are sent to that application until the gesture completes or the primary touch is completed.</span></span>

<span data-ttu-id="cbe85-126">Pour la prise en charge héritée, Windows interprète les messages de [**\_ mouvement WM**](wm-gesture.md) s’ils sont propagés, puis envoie ou publie les messages appropriés qui mappent au geste.</span><span class="sxs-lookup"><span data-stu-id="cbe85-126">For legacy support, Windows interprets [**WM\_GESTURE**](wm-gesture.md) messages if they are bubbled up and then will SEND or POST appropriate messages that map to the gesture.</span></span> <span data-ttu-id="cbe85-127">Pour éviter de rompre la prise en charge héritée, veillez à transférer \_ les messages de mouvement WM à l’aide de [DefWindowProc](/windows/win32/api/winuser/nf-winuser-defwindowproca).</span><span class="sxs-lookup"><span data-stu-id="cbe85-127">To avoid breaking legacy support, make sure that you forward WM\_GESTURE messages using [DefWindowProc](/windows/win32/api/winuser/nf-winuser-defwindowproca).</span></span> <span data-ttu-id="cbe85-128">Pour plus d’informations sur la prise en charge héritée, consultez la section [vue d’ensemble des gestes tactiles Windows](windows-touch-gestures-overview.md).</span><span class="sxs-lookup"><span data-stu-id="cbe85-128">More information on legacy support can be found in the section [Windows Touch Gestures Overview](windows-touch-gestures-overview.md).</span></span>

## <a name="manipulations-and-inertia"></a><span data-ttu-id="cbe85-129">Manipulations et inertie</span><span class="sxs-lookup"><span data-stu-id="cbe85-129">Manipulations and Inertia</span></span>

<span data-ttu-id="cbe85-130">Les programmeurs tactiles Windows doivent être en mesure d’interpréter les gestes de plusieurs sources d’une manière qui est explicite pour le mouvement qui a lieu.</span><span class="sxs-lookup"><span data-stu-id="cbe85-130">Windows Touch programmers must be able to interpret gestures from multiple sources in a manner that is meaningful for the gesture taking place.</span></span> <span data-ttu-id="cbe85-131">Microsoft fournit l’API de manipulation pour effectuer ces calculs.</span><span class="sxs-lookup"><span data-stu-id="cbe85-131">Microsoft provides the manipulation API to perform these calculations.</span></span> <span data-ttu-id="cbe85-132">Les manipulations sont essentiellement des mouvements avec des valeurs qui leur sont associées qui décrivent l’intégralité du mouvement.</span><span class="sxs-lookup"><span data-stu-id="cbe85-132">Manipulations are essentially gestures with values associated with them that describe the entire gesture.</span></span> <span data-ttu-id="cbe85-133">Une fois que vous avez connecté les données d’entrée au processeur de manipulation, vous pouvez récupérer les informations pertinentes pour l’action effectuée par l’utilisateur sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="cbe85-133">After you connect the input data to the manipulation processor, you can retrieve information pertinent to action that the user makes on the object.</span></span> <span data-ttu-id="cbe85-134">La figure suivante illustre une façon d’utiliser des manipulations.</span><span class="sxs-lookup"><span data-stu-id="cbe85-134">The following figure shows one way you can use manipulations.</span></span>

![Illustration montrant les messages tactiles Windows passés au processeur de manipulation d’un objet, qui gère les événements avec l' \- interface imanipulationevents](images/manipulation-arch.png)

<span data-ttu-id="cbe85-136">Dans le coin supérieur gauche de l’illustration, l’utilisateur a touché l’écran, ce qui crée des messages tactiles.</span><span class="sxs-lookup"><span data-stu-id="cbe85-136">In the top left of the illustration, the user has touched the screen, which creates touch messages.</span></span> <span data-ttu-id="cbe85-137">Ces messages contiennent une coordonnée x et une coordonnée y qui sont utilisées pour déterminer l’objet qui est actif.</span><span class="sxs-lookup"><span data-stu-id="cbe85-137">These messages contain an x-coordinate and a y-coordinate that are used to determine the object that is in focus.</span></span> <span data-ttu-id="cbe85-138">L’objet dans le focus contient un processeur de manipulation.</span><span class="sxs-lookup"><span data-stu-id="cbe85-138">The object in focus contains a manipulation processor.</span></span> <span data-ttu-id="cbe85-139">Ensuite, sur le message [**WM \_ Touch**](wm-touchdown.md) avec l’indicateur **TOUCHEVENTF \_ up** , l’objet du focus de l’utilisateur est sélectionné, le processeur de manipulation est référencé et le message est envoyé au processeur de manipulation.</span><span class="sxs-lookup"><span data-stu-id="cbe85-139">Next, on the [**WM\_TOUCH**](wm-touchdown.md) message with the **TOUCHEVENTF\_UP** flag, the object in the user's focus is selected, the manipulation processor is referenced, and the message is sent to the manipulation processor.</span></span> <span data-ttu-id="cbe85-140">Les messages **WM \_ Touch** suivants associés à ce contact sont envoyés au processeur de manipulation jusqu’à ce que le message **WM \_ Touch** avec l’indicateur **TOUCHEVENTF \_ up** soit reçu et que l’objet sélectionné soit déréférencé.</span><span class="sxs-lookup"><span data-stu-id="cbe85-140">Subsequent **WM\_TOUCH** messages associated with this contact are sent to the manipulation processor until the **WM\_TOUCH** message with the **TOUCHEVENTF\_UP** flag is received and the selected object is dereferenced.</span></span> <span data-ttu-id="cbe85-141">Dans la section en bas à droite de l’illustration, un récepteur d’événements de manipulation qui implémente l’interface [**\_ IManipulationEvents**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) est utilisé pour gérer les événements de manipulation, qui sont déclenchés pendant la création des messages tactiles.</span><span class="sxs-lookup"><span data-stu-id="cbe85-141">In the bottom right section of the illustration, a manipulation event sink that implements the [**\_IManipulationEvents**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) interface is used to handle the manipulation events, which are raised while the touch messages are being created.</span></span> <span data-ttu-id="cbe85-142">Le récepteur d’événements peut effectuer des mises à jour de l’interface en fonction des événements de manipulation lorsqu’ils se produisent.</span><span class="sxs-lookup"><span data-stu-id="cbe85-142">The event sink can perform updates to the interface based on the manipulation events while they occur.</span></span>

<span data-ttu-id="cbe85-143">Dans les applications tactiles Windows, il est courant d’incorporer une physique simple afin que les objets arrivent facilement à l’arrêt, au lieu de s’arrêter brusquement lorsqu’ils ne sont plus touchées.</span><span class="sxs-lookup"><span data-stu-id="cbe85-143">In Windows Touch applications, it's common to incorporate simple physics so that objects smoothly come to a stop, rather than abruptly stop when they are no longer being touched.</span></span> <span data-ttu-id="cbe85-144">Microsoft fournit l’API d’inertie pour effectuer les calculs pour ces simples physiques afin que votre application puisse se comporter de manière similaire à d’autres applications.</span><span class="sxs-lookup"><span data-stu-id="cbe85-144">Microsoft provides the Inertia API to perform the calculations for these simple physics so that your application can behave in a manner similar to other applications.</span></span> <span data-ttu-id="cbe85-145">Cela vous évite également d’avoir à créer des fonctionnalités physiques fiables.</span><span class="sxs-lookup"><span data-stu-id="cbe85-145">This also saves you the effort required to create robust physics functionality.</span></span> <span data-ttu-id="cbe85-146">L’illustration suivante montre comment vous pouvez utiliser l’inertie.</span><span class="sxs-lookup"><span data-stu-id="cbe85-146">The following figure shows how you can use inertia.</span></span>

![Illustration montrant des messages tactiles Windows passés à l’interface IInertiaProcessor d’un objet, qui déclenche des événements avec l' \- interface imanipulationevents](images/inertia-arch.png)

<span data-ttu-id="cbe85-148">Notez les similitudes entre l’inertie et la manipulation.</span><span class="sxs-lookup"><span data-stu-id="cbe85-148">Note the similarities between inertia and manipulation.</span></span> <span data-ttu-id="cbe85-149">La seule différence entre les deux est que, en cas d’inertie, les messages interprétés sont transmis à un processeur d’inertie plutôt qu’à un processeur de manipulation et le processeur d’inertie déclenche les événements.</span><span class="sxs-lookup"><span data-stu-id="cbe85-149">The only difference between the two is that in the case of inertia, interpreted messages are handed to an inertia processor rather than a manipulation processor and the inertia processor raises the events.</span></span> <span data-ttu-id="cbe85-150">Dans le coin supérieur gauche de l’illustration, sur le message [**WM \_ Touch**](wm-touchdown.md) avec l’indicateur **TOUCHEVENTF \_ up** , les messages tactiles sont utilisés pour identifier un objet qui contient un processeur d’inertie et un processeur de manipulation.</span><span class="sxs-lookup"><span data-stu-id="cbe85-150">In the top left of the illustration, on the [**WM\_TOUCH**](wm-touchdown.md) message with the **TOUCHEVENTF\_UP** flag, touch messages are used to identify an object in focus that contains an inertia processor and a manipulation processor.</span></span> <span data-ttu-id="cbe85-151">Les messages **WM \_ Touch** suivants sont envoyés au processeur de manipulation et le processeur de manipulation effectue des mises à jour de l’interface utilisateur de l’application.</span><span class="sxs-lookup"><span data-stu-id="cbe85-151">Subsequent **WM\_TOUCH** messages are sent to the manipulation processor and the manipulation processor performs updates to the application UI.</span></span> <span data-ttu-id="cbe85-152">Une fois la manipulation terminée, les valeurs de vélocité de la manipulation sont utilisées pour configurer un processeur d’inertie.</span><span class="sxs-lookup"><span data-stu-id="cbe85-152">After the manipulation completes, velocity values from the manipulation are used to set up an inertia processor.</span></span> <span data-ttu-id="cbe85-153">Comme illustré dans la colonne du milieu, la méthode [**Process**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-process) ou [**ProcessTime**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-processtime) est appelée sur l’interface [**IInertiaProcessor**](/windows/desktop/api/manipulations/nn-manipulations-iinertiaprocessor) à l’aide d’un minuteur ou d’une autre boucle dans un thread séparé jusqu’à ce que les appels indiquent que le traitement du processeur est terminé.</span><span class="sxs-lookup"><span data-stu-id="cbe85-153">As illustrated in the middle column, the [**Process**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-process) or [**ProcessTime**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-processtime) method is called on the [**IInertiaProcessor**](/windows/desktop/api/manipulations/nn-manipulations-iinertiaprocessor) interface using a timer or other loop in a separate thread until the calls indicate the processor is finished processing.</span></span> <span data-ttu-id="cbe85-154">Pendant que ces appels sont effectués, les événements de manipulation sont déclenchés, qui sont gérés par un récepteur d’événements de manipulation basé sur l’interface [**\_ IManipulationEvents**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) .</span><span class="sxs-lookup"><span data-stu-id="cbe85-154">While these calls are made, manipulation events are raised, which are handled by a manipulation event sink based on the [**\_IManipulationEvents**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) interface.</span></span> <span data-ttu-id="cbe85-155">Dans la section en bas à droite de l’illustration, ce récepteur d’événements effectue ensuite des mises à jour de l’interface utilisateur de l’application en fonction des événements de manipulation lorsqu’ils se produisent par le biais de gestionnaires d’événements dans le récepteur d’événements.</span><span class="sxs-lookup"><span data-stu-id="cbe85-155">At the bottom right section of the illustration, this event sink then performs updates to the application UI based on manipulation events when they occur through event handlers in the event sink.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cbe85-156">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="cbe85-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cbe85-157">Guide de programmation</span><span class="sxs-lookup"><span data-stu-id="cbe85-157">Programming Guide</span></span>](programming-guide.md)
</dt> </dl>

 

 