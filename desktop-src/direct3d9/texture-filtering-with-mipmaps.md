---
description: Un mipmap est une séquence de textures, chacune d’elles étant une représentation de résolution progressivement inférieure de la même image.
ms.assetid: b64abca9-0efb-4939-849d-e75a8d0dc10b
title: Filtrage de texture avec des mipmaps (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bdc109ae6de93a26b5d5e5b90e948761e92ee92c
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104552236"
---
# <a name="texture-filtering-with-mipmaps-direct3d-9"></a><span data-ttu-id="29e30-103">Filtrage de texture avec des mipmaps (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="29e30-103">Texture Filtering with Mipmaps (Direct3D 9)</span></span>

<span data-ttu-id="29e30-104">Un mipmap est une séquence de textures, chacune d’elles étant une représentation de résolution progressivement inférieure de la même image.</span><span class="sxs-lookup"><span data-stu-id="29e30-104">A mipmap is a sequence of textures, each of which is a progressively lower resolution representation of the same image.</span></span> <span data-ttu-id="29e30-105">La hauteur et la largeur de chaque image, ou niveau, dans le mipmap sont une puissance de deux plus petite que le niveau précédent.</span><span class="sxs-lookup"><span data-stu-id="29e30-105">The height and width of each image, or level, in the mipmap is a power of two smaller than the previous level.</span></span> <span data-ttu-id="29e30-106">Les des mipmaps n’ont pas besoin d’être carrés.</span><span class="sxs-lookup"><span data-stu-id="29e30-106">Mipmaps do not have to be square.</span></span>

<span data-ttu-id="29e30-107">Une image mipmap haute résolution est utilisée pour les objets qui sont proches de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="29e30-107">A high-resolution mipmap image is used for objects that are close to the user.</span></span> <span data-ttu-id="29e30-108">Les images de résolution inférieure sont utilisées lorsque l’objet apparaît plus loin.</span><span class="sxs-lookup"><span data-stu-id="29e30-108">Lower-resolution images are used as the object appears farther away.</span></span> <span data-ttu-id="29e30-109">Mappage MIP améliore la qualité des textures rendues au détriment de l’utilisation de davantage de mémoire.</span><span class="sxs-lookup"><span data-stu-id="29e30-109">Mipmapping improves the quality of rendered textures at the expense of using more memory.</span></span>

<span data-ttu-id="29e30-110">Direct3D représente des mipmaps sous la forme d’une chaîne de surfaces attachées.</span><span class="sxs-lookup"><span data-stu-id="29e30-110">Direct3D represents mipmaps as a chain of attached surfaces.</span></span> <span data-ttu-id="29e30-111">La texture de résolution la plus élevée se trouve au début de la chaîne et a le niveau suivant du mipmap en tant que pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="29e30-111">The highest resolution texture is at the head of the chain and has the next level of the mipmap as an attachment.</span></span> <span data-ttu-id="29e30-112">À son tour, ce niveau a une pièce jointe qui est le niveau suivant dans le mipmap, et ainsi de suite, jusqu’au niveau de résolution le plus bas du mipmap.</span><span class="sxs-lookup"><span data-stu-id="29e30-112">In turn, that level has an attachment that is the next level in the mipmap, and so on, down to the lowest resolution level of the mipmap.</span></span>

<span data-ttu-id="29e30-113">Les illustrations suivantes présentent un exemple de ces niveaux.</span><span class="sxs-lookup"><span data-stu-id="29e30-113">The following illustrations shows an example of these levels.</span></span> <span data-ttu-id="29e30-114">Les textures de la bitmap représentent un signe sur un conteneur dans un jeu 3D de première personne.</span><span class="sxs-lookup"><span data-stu-id="29e30-114">The bitmap textures represent a sign on a container in a 3D first-person game.</span></span> <span data-ttu-id="29e30-115">En cas de création en tant que mipmap, la texture de résolution la plus élevée est d’abord dans le jeu.</span><span class="sxs-lookup"><span data-stu-id="29e30-115">When created as a mipmap, the highest resolution texture is first in the set.</span></span> <span data-ttu-id="29e30-116">Chaque texture qui suit dans l’ensemble de mipmap est plus petite de hauteur et de largeur par une puissance de 2.</span><span class="sxs-lookup"><span data-stu-id="29e30-116">Each succeeding texture in the mipmap set is smaller in height and width by a power of 2.</span></span> <span data-ttu-id="29e30-117">Dans ce cas, le mipmap à résolution maximale est de 256 pixels par 256 pixels.</span><span class="sxs-lookup"><span data-stu-id="29e30-117">In this case, the maximum-resolution mipmap is 256 pixels by 256 pixels.</span></span> <span data-ttu-id="29e30-118">La texture suivante est 128 x 128.</span><span class="sxs-lookup"><span data-stu-id="29e30-118">The next, texture is 128x128.</span></span> <span data-ttu-id="29e30-119">La dernière texture de la chaîne est 64x64.</span><span class="sxs-lookup"><span data-stu-id="29e30-119">The last texture in the chain is 64x64.</span></span>

<span data-ttu-id="29e30-120">Ce signe a une distance maximale à partir de laquelle il est visible.</span><span class="sxs-lookup"><span data-stu-id="29e30-120">This sign has a maximum distance from which it is visible.</span></span> <span data-ttu-id="29e30-121">Si l’utilisateur commence loin du signe, le jeu affiche la texture la plus petite dans la chaîne mipmap, qui, dans ce cas, la texture 64x64.</span><span class="sxs-lookup"><span data-stu-id="29e30-121">If the user begins far away from the sign, the game displays the smallest texture in the mipmap chain, which in this case the 64x64 texture.</span></span>

![illustration d’une texture 64x64 d’un signe de danger](images/mip1.jpg)

<span data-ttu-id="29e30-123">À mesure que l’utilisateur déplace le point de vue plus près du signe, les textures de résolution plus élevée dans la chaîne mipmap sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="29e30-123">As the user moves the point of view closer to the sign, progressively higher-resolution textures in the mipmap chain are used.</span></span> <span data-ttu-id="29e30-124">La résolution de l’illustration suivante est 128 x 128.</span><span class="sxs-lookup"><span data-stu-id="29e30-124">The resolution in the following illustration is 128x128.</span></span>

![illustration d’une texture 128 x 128 d’un signe de danger](images/mip2.jpg)

<span data-ttu-id="29e30-126">La texture de résolution la plus élevée est utilisée lorsque le point de vue de l’utilisateur est à la distance minimale autorisée par rapport au signe, comme indiqué dans l’illustration suivante.</span><span class="sxs-lookup"><span data-stu-id="29e30-126">The highest resolution texture is used when the user's point of view is at the minimum allowable distance from the sign, as shown in the following illustration.</span></span>

![illustration d’une texture 256x256 d’un signe de danger](images/mip3.jpg)

<span data-ttu-id="29e30-128">Il s’agit d’un moyen plus efficace de simuler la perspective des textures.</span><span class="sxs-lookup"><span data-stu-id="29e30-128">This is a more efficient way of simulating perspective for textures.</span></span> <span data-ttu-id="29e30-129">Au lieu d’afficher une seule texture à de nombreuses résolutions, il est plus rapide d’utiliser plusieurs textures à des résolutions différentes.</span><span class="sxs-lookup"><span data-stu-id="29e30-129">Rather than render a single texture at many resolutions, it is faster to use multiple textures at varying resolutions.</span></span>

<span data-ttu-id="29e30-130">Direct3D peut évaluer quelle texture dans un ensemble de mipmap est la résolution la plus proche de la sortie souhaitée, et elle peut mapper les pixels dans son espace Texel.</span><span class="sxs-lookup"><span data-stu-id="29e30-130">Direct3D can assess which texture in a mipmap set is the closest resolution to the desired output, and it can map pixels into its texel space.</span></span> <span data-ttu-id="29e30-131">Si la résolution de l’image finale est comprise entre les résolutions des textures de l’ensemble de mipmap, Direct3D peut examiner les texels dans des mipmaps et fusionner leurs valeurs de couleur ensemble.</span><span class="sxs-lookup"><span data-stu-id="29e30-131">If the resolution of the final image is between the resolutions of the textures in the mipmap set, Direct3D can examine texels in both mipmaps and blend their color values together.</span></span>

<span data-ttu-id="29e30-132">Pour utiliser des mipmaps, votre application doit générer un ensemble de des mipmaps.</span><span class="sxs-lookup"><span data-stu-id="29e30-132">To use mipmaps, your application must build a set of mipmaps.</span></span> <span data-ttu-id="29e30-133">Les applications appliquent des mipmaps en sélectionnant le mipmap défini comme première texture dans le jeu de textures actuelles.</span><span class="sxs-lookup"><span data-stu-id="29e30-133">Applications apply mipmaps by selecting the mipmap set as the first texture in the set of current textures.</span></span> <span data-ttu-id="29e30-134">Pour plus d’informations, consultez [Blending texture (Direct3D 9)](texture-blending.md).</span><span class="sxs-lookup"><span data-stu-id="29e30-134">For more information, see [Texture Blending (Direct3D 9)](texture-blending.md).</span></span>

<span data-ttu-id="29e30-135">Ensuite, votre application doit définir la méthode de filtrage utilisée par Direct3D pour échantillonner les texels.</span><span class="sxs-lookup"><span data-stu-id="29e30-135">Next, your application must set the filtering method that Direct3D uses to sample texels.</span></span> <span data-ttu-id="29e30-136">La méthode la plus rapide de filtrage mipmap est d’avoir Direct3D Select the Texel le plus proche.</span><span class="sxs-lookup"><span data-stu-id="29e30-136">The fastest method of mipmap filtering is to have Direct3D select the nearest texel.</span></span> <span data-ttu-id="29e30-137">Utilisez la \_ valeur d’énumération de point D3DTEXF pour la sélectionner.</span><span class="sxs-lookup"><span data-stu-id="29e30-137">Use the D3DTEXF\_POINT enumerated value to select this.</span></span> <span data-ttu-id="29e30-138">Direct3D peut produire de meilleurs résultats de filtrage si votre application utilise la \_ valeur énumérée linéaire D3DTEXF.</span><span class="sxs-lookup"><span data-stu-id="29e30-138">Direct3D can produce better filtering results if your application uses the D3DTEXF\_LINEAR enumerated value.</span></span> <span data-ttu-id="29e30-139">Cela sélectionne le mipmap le plus proche, puis calcule une moyenne pondérée des texels entourant l’emplacement de la texture vers laquelle le pixel actuel est mappé.</span><span class="sxs-lookup"><span data-stu-id="29e30-139">This selects the nearest mipmap, and then computes a weighted average of the texels surrounding the location in the texture to which the current pixel maps.</span></span>

<span data-ttu-id="29e30-140">Les textures mipmap sont utilisées dans les scènes 3D pour réduire le temps nécessaire au rendu d’une scène.</span><span class="sxs-lookup"><span data-stu-id="29e30-140">Mipmap textures are used in 3D scenes to decrease the time required to render a scene.</span></span> <span data-ttu-id="29e30-141">Ils améliorent également le réalisme de la scène.</span><span class="sxs-lookup"><span data-stu-id="29e30-141">They also improve the scene's realism.</span></span> <span data-ttu-id="29e30-142">Toutefois, elles nécessitent souvent de grandes quantités de mémoire.</span><span class="sxs-lookup"><span data-stu-id="29e30-142">However, they often require large amounts of memory.</span></span>

## <a name="creating-a-set-of-mipmaps"></a><span data-ttu-id="29e30-143">Création d’un ensemble de des mipmaps</span><span class="sxs-lookup"><span data-stu-id="29e30-143">Creating a Set of Mipmaps</span></span>

<span data-ttu-id="29e30-144">L’exemple suivant montre comment votre application peut appeler la méthode [**IDirect3DDevice9 :: CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) pour générer une chaîne de cinq niveaux de mipmap : 256x256, 128 x 128, 64x64, 32x32 et 16x16.</span><span class="sxs-lookup"><span data-stu-id="29e30-144">The following example shows how your application can call the [**IDirect3DDevice9::CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) method to build a chain of five mipmap levels: 256x256, 128x128, 64x64, 32x32, and 16x16.</span></span>


```
// This code example assumes that m_d3dDevice is a
// valid pointer to a IDirect3DDevice9 interface

IDirect3DTexture9 * pMipMap;
m_pD3DDevice->CreateTexture(256, 256, 5, 0, D3DFMT_R8G8B8, 
    D3DPOOL_MANAGED, &pMipMap);
```



<span data-ttu-id="29e30-145">Les deux premiers paramètres acceptés par [**IDirect3DDevice9 :: CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) sont la taille et la largeur de la texture de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="29e30-145">The first two parameters that are accepted by [**IDirect3DDevice9::CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) are the size and width of the top-level texture.</span></span> <span data-ttu-id="29e30-146">Le troisième paramètre spécifie le nombre de niveaux dans la texture.</span><span class="sxs-lookup"><span data-stu-id="29e30-146">The third parameter specifies the number of levels in the texture.</span></span> <span data-ttu-id="29e30-147">Si vous définissez cette valeur sur zéro, Direct3D crée une chaîne de surfaces, chacune d’une puissance de deux plus petite que la précédente, jusqu’à la plus petite taille possible de 1x1.</span><span class="sxs-lookup"><span data-stu-id="29e30-147">If you set this to zero, Direct3D creates a chain of surfaces, each a power of two smaller than the previous one, down to the smallest possible size of 1x1.</span></span> <span data-ttu-id="29e30-148">Le quatrième paramètre spécifie l’utilisation de cette ressource. dans ce cas, 0 est spécifié pour indiquer qu’il n’y a pas d’utilisation spécifique pour la ressource.</span><span class="sxs-lookup"><span data-stu-id="29e30-148">The fourth parameter specifies the usage for this resource; in this case, 0 is specified to indicate no specific usage for the resource.</span></span> <span data-ttu-id="29e30-149">Le cinquième paramètre spécifie le format de surface pour la texture.</span><span class="sxs-lookup"><span data-stu-id="29e30-149">The fifth parameter specifies the surface format for the texture.</span></span> <span data-ttu-id="29e30-150">Utilisez une valeur du type énuméré [D3DFORMAT](d3dformat.md) pour ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="29e30-150">Use a value from the [D3DFORMAT](d3dformat.md) enumerated type for this parameter.</span></span> <span data-ttu-id="29e30-151">Le sixième paramètre spécifie un membre du type énuméré [**D3DPOOL**](./d3dpool.md) indiquant la classe de mémoire dans laquelle placer la ressource créée.</span><span class="sxs-lookup"><span data-stu-id="29e30-151">The sixth parameter specifies a member of the [**D3DPOOL**](./d3dpool.md) enumerated type indicating the memory class into which to place the created resource.</span></span> <span data-ttu-id="29e30-152">À moins que vous n’utilisiez des textures dynamiques, D3DPOOL \_ est recommandé.</span><span class="sxs-lookup"><span data-stu-id="29e30-152">Unless you are using dynamic textures, D3DPOOL\_MANAGED is recommended.</span></span> <span data-ttu-id="29e30-153">Le dernier paramètre prend l’adresse d’un pointeur vers une interface [**IDirect3DTexture9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dtexture9) .</span><span class="sxs-lookup"><span data-stu-id="29e30-153">The final parameter takes the address of a pointer to an [**IDirect3DTexture9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dtexture9) interface.</span></span>

> [!Note]  
> <span data-ttu-id="29e30-154">Chaque surface dans une chaîne mipmap a des dimensions qui représentent une moitié de la surface précédente dans la chaîne.</span><span class="sxs-lookup"><span data-stu-id="29e30-154">Each surface in a mipmap chain has dimensions that are one-half that of the previous surface in the chain.</span></span> <span data-ttu-id="29e30-155">Si le mipmap de niveau supérieur a des dimensions de 256 x 128, les dimensions du mipmap de deuxième niveau sont 128x64, le troisième niveau est 64x32, et ainsi de suite, jusqu’à 1x1.</span><span class="sxs-lookup"><span data-stu-id="29e30-155">If the top-level mipmap has dimensions of 256x128, the dimensions of the second-level mipmap are 128x64, the third-level are 64x32, and so on, down to 1x1.</span></span> <span data-ttu-id="29e30-156">Vous ne pouvez pas demander un certain nombre de niveaux de mipmap dans des niveaux qui provoqueraient une taille inférieure ou égale à 1 de la largeur ou de la hauteur d’un mipmap dans la chaîne.</span><span class="sxs-lookup"><span data-stu-id="29e30-156">You cannot request a number of mipmap levels in Levels that would cause either the width or height of any mipmap in the chain to be smaller than 1.</span></span> <span data-ttu-id="29e30-157">Dans le cas simple d’une surface mipmap de niveau supérieur 4x2, la valeur maximale autorisée pour Levels est trois.</span><span class="sxs-lookup"><span data-stu-id="29e30-157">In the simple case of a 4x2 top-level mipmap surface, the maximum value allowed for Levels is three.</span></span> <span data-ttu-id="29e30-158">Les dimensions de niveau supérieur sont 4x2, les dimensions de second niveau sont 2x1 et les dimensions du troisième niveau sont 1x1.</span><span class="sxs-lookup"><span data-stu-id="29e30-158">The top-level dimensions are 4x2, the second-level dimensions are 2x1, and the dimensions for the third level are 1x1.</span></span> <span data-ttu-id="29e30-159">Une valeur supérieure à 3 dans niveaux produit une valeur fractionnaire dans la hauteur du mipmap de deuxième niveau, et n’est donc pas autorisée.</span><span class="sxs-lookup"><span data-stu-id="29e30-159">A value larger than 3 in Levels results in a fractional value in the height of the second-level mipmap, and is therefore disallowed.</span></span>

 

## <a name="selecting-and-displaying-a-mipmap"></a><span data-ttu-id="29e30-160">Sélection et affichage d’un mipmap</span><span class="sxs-lookup"><span data-stu-id="29e30-160">Selecting and Displaying a Mipmap</span></span>

<span data-ttu-id="29e30-161">Appelez la méthode [**IDirect3DDevice9 :: SetTexture**](/windows/desktop/api) pour définir la texture mipmap définie comme première texture dans la liste des textures actuelles.</span><span class="sxs-lookup"><span data-stu-id="29e30-161">Call the [**IDirect3DDevice9::SetTexture**](/windows/desktop/api) method to set the mipmap texture set as the first texture in the list of current textures.</span></span> <span data-ttu-id="29e30-162">Pour plus d’informations, consultez [Blending texture (Direct3D 9)](texture-blending.md).</span><span class="sxs-lookup"><span data-stu-id="29e30-162">For more information, see [Texture Blending (Direct3D 9)](texture-blending.md).</span></span>

<span data-ttu-id="29e30-163">Une fois que votre application a sélectionné l’ensemble de textures mipmap, elle doit assigner des valeurs du type énuméré [**D3DTEXTUREFILTERTYPE**](./d3dtexturefiltertype.md) à l’état de l' \_ échantillonneur D3DSAMP MIPFILTER.</span><span class="sxs-lookup"><span data-stu-id="29e30-163">After your application selects the mipmap texture set, it must assign values from the [**D3DTEXTUREFILTERTYPE**](./d3dtexturefiltertype.md) enumerated type to the D3DSAMP\_MIPFILTER sampler state.</span></span> <span data-ttu-id="29e30-164">Direct3D effectue ensuite automatiquement le filtrage de texture mipmap.</span><span class="sxs-lookup"><span data-stu-id="29e30-164">Direct3D then automatically performs mipmap texture filtering.</span></span> <span data-ttu-id="29e30-165">L’activation du filtrage de texture mipmap est illustrée dans l’exemple de code suivant.</span><span class="sxs-lookup"><span data-stu-id="29e30-165">Enabling mipmap texture filtering is demonstrated in the following code example.</span></span>


```
m_pD3DDevice->SetTexture(0, pMipMap);
m_pD3DDevice->SetSamplerState(0, D3DSAMP_MIPFILTER, D3DTEXF_POINT);
```



<span data-ttu-id="29e30-166">Votre application peut également parcourir manuellement une chaîne de surfaces mipmap à l’aide de la méthode [**IDirect3DTexture9 :: GetSurfaceLevel**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-getsurfacelevel) et en spécifiant le niveau de mipmap à récupérer.</span><span class="sxs-lookup"><span data-stu-id="29e30-166">Your application can also manually traverse a chain of mipmap surfaces by using the [**IDirect3DTexture9::GetSurfaceLevel**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-getsurfacelevel) method and specifying the mipmap level to retrieve.</span></span> <span data-ttu-id="29e30-167">L’exemple suivant parcourt une chaîne mipmap des résolutions les plus élevées aux plus basses.</span><span class="sxs-lookup"><span data-stu-id="29e30-167">The following example traverses a mipmap chain from highest to lowest resolutions.</span></span>


```
IDirect3DSurface9 * pSurfaceLevel;
for (int iLevel = 0; iLevel < pMipMap->GetLevelCount(); iLevel++)
{
    pMipMap->GetSurfaceLevel(iLevel, &pSurfaceLevel);
    // Process this level
    pSurfaceLevel->Release();
}
```



<span data-ttu-id="29e30-168">Les applications doivent parcourir manuellement une chaîne mipmap pour charger des données bitmap dans chaque surface de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="29e30-168">Applications need to manually traverse a mipmap chain to load bitmap data into each surface in the chain.</span></span> <span data-ttu-id="29e30-169">Il s’agit généralement de la seule raison de traverser la chaîne.</span><span class="sxs-lookup"><span data-stu-id="29e30-169">This is typically the only reason to traverse the chain.</span></span> <span data-ttu-id="29e30-170">Une application peut récupérer le nombre de niveaux dans un mipmap en appelant [**IDirect3DBaseTexture9 :: GetLevelCount**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-getlevelcount).</span><span class="sxs-lookup"><span data-stu-id="29e30-170">An application can retrieve the number of levels in a mipmap by calling [**IDirect3DBaseTexture9::GetLevelCount**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-getlevelcount).</span></span>

## <a name="related-topics"></a><span data-ttu-id="29e30-171">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="29e30-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="29e30-172">Filtrage de texture</span><span class="sxs-lookup"><span data-stu-id="29e30-172">Texture Filtering</span></span>](texture-filtering.md)
</dt> </dl>

 

 
