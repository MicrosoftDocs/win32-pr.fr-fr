---
description: Les cartes d’environnement sphériques, ou cartes de sphère, sont des textures spéciales qui contiennent une image de la scène entourant un objet ou les effets d’éclairage autour de l’objet.
ms.assetid: b4a8defc-876f-4a23-a12e-e7423a1e8f89
title: Mappage d’environnement sphérique (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e9b0e7aaa123478ecc7cc327dca0b13a8aae3d0c
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "106529094"
---
# <a name="spherical-environment-mapping-direct3d-9"></a><span data-ttu-id="360a4-103">Mappage d’environnement sphérique (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="360a4-103">Spherical Environment Mapping (Direct3D 9)</span></span>

<span data-ttu-id="360a4-104">Les cartes d’environnement sphériques, ou cartes de sphère, sont des textures spéciales qui contiennent une image de la scène entourant un objet ou les effets d’éclairage autour de l’objet.</span><span class="sxs-lookup"><span data-stu-id="360a4-104">Spherical environment maps, or sphere maps, are special textures that contain an image of the scene surrounding an object, or the lighting effects around the object.</span></span> <span data-ttu-id="360a4-105">Contrairement aux cartes d’environnement cubiques, les cartes de sphère ne représentent pas directement les environs d’un objet.</span><span class="sxs-lookup"><span data-stu-id="360a4-105">Unlike cubic environment maps, sphere maps don't directly represent an object's surroundings.</span></span> <span data-ttu-id="360a4-106">La rubrique image théière dans le [mappage d’environnement (Direct3D 9)](environment-mapping.md) affiche les effets de réflexion que vous pouvez obtenir avec le mappage de sphère.</span><span class="sxs-lookup"><span data-stu-id="360a4-106">The teapot image in [Environment Mapping (Direct3D 9)](environment-mapping.md) topic shows the reflection effects you can achieve with sphere mapping.</span></span> <span data-ttu-id="360a4-107">Une carte de sphère est une représentation 2D de la vue complète de 360 de la scène entourant un objet, comme si elle était placée à l’aide d’un objectif de poisson, comme indiqué dans l’illustration suivante.</span><span class="sxs-lookup"><span data-stu-id="360a4-107">A sphere map is a 2D representation of the full 360-degree view of the scene surrounding of an object, as if taken through a fish-eye lens, as shown in the following illustration.</span></span>

![illustration d’une carte de sphère de l’intérieur d’une construction](images/spheremap.png)

## <a name="texture-coordinates-for-spherical-environment-maps"></a><span data-ttu-id="360a4-109">Coordonnées de texture pour les cartes d’environnement sphériques</span><span class="sxs-lookup"><span data-stu-id="360a4-109">Texture Coordinates for Spherical Environment Maps</span></span>

<span data-ttu-id="360a4-110">Les coordonnées de texture que vous spécifiez pour chaque vertex recevant un mappage d’environnement doivent traiter la texture comme une fonction de la distorsion réfléchissante créée par la courbure de la surface.</span><span class="sxs-lookup"><span data-stu-id="360a4-110">The texture coordinates that you specify for each vertex receiving an environment mapping should address the texture as a function of the reflective distortion created by the curvature of the surface.</span></span> <span data-ttu-id="360a4-111">Les applications doivent calculer ces coordonnées de texture pour chaque vertex pour obtenir l’effet souhaité.</span><span class="sxs-lookup"><span data-stu-id="360a4-111">Applications must compute these texture coordinates for each vertex to achieve the desired effect.</span></span> <span data-ttu-id="360a4-112">Une façon simple et efficace de générer des coordonnées de texture utilise le vertex normal comme entrée.</span><span class="sxs-lookup"><span data-stu-id="360a4-112">One simple and effective way to generate texture coordinates uses the vertex normal as input.</span></span> <span data-ttu-id="360a4-113">Bien que plusieurs méthodes existent, l’équation suivante est courante parmi les applications qui effectuent le mappage d’environnement avec les cartes de sphère.</span><span class="sxs-lookup"><span data-stu-id="360a4-113">Although several methods exist, the following equation is common among applications that perform environment mapping with sphere maps.</span></span>

![équation de coordonnées de texture Computing pour une carte de sphère](images/spheremap-formula.png)

<span data-ttu-id="360a4-115">Dans ces formules, vous et v sont les coordonnées de texture calculées, et N<sub>x</sub> et n<sub>y</sub> sont les composants x et y de la normale du vertex de l’espace de caméra.</span><span class="sxs-lookup"><span data-stu-id="360a4-115">In these formulas, u and v are the texture coordinates being computed, and N<sub>X</sub> and N<sub>Y</sub> are the x and y components of the camera-space vertex normal.</span></span> <span data-ttu-id="360a4-116">La formule est simple mais efficace.</span><span class="sxs-lookup"><span data-stu-id="360a4-116">The formula is simple but effective.</span></span> <span data-ttu-id="360a4-117">Si le normal a un composant x positif, le point normal est vers la droite, et la coordonnée u est ajustée pour traiter la texture de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="360a4-117">If the normal has a positive x component, the normal points to the right, and the u coordinate is adjusted to address the texture appropriately.</span></span> <span data-ttu-id="360a4-118">De même pour la coordonnée v : positif y indique que le point normal est normal.</span><span class="sxs-lookup"><span data-stu-id="360a4-118">Likewise for the v coordinate: positive y indicates that the normal points up.</span></span> <span data-ttu-id="360a4-119">L’inverse est vrai pour les valeurs négatives de chaque composant.</span><span class="sxs-lookup"><span data-stu-id="360a4-119">The opposite is true for negative values in each component.</span></span>

<span data-ttu-id="360a4-120">Si les points normaux se trouvent directement à l’appareil photo, les coordonnées résultantes ne doivent pas recevoir de distorsions.</span><span class="sxs-lookup"><span data-stu-id="360a4-120">If the normal points directly at the camera, the resulting coordinates should receive no distortion.</span></span> <span data-ttu-id="360a4-121">Le décalage + 0,5 vers les deux coordonnées place le point de distorsion zéro au centre de la carte de sphère, et la normale au sommet de (0, 0, z) résout ce point.</span><span class="sxs-lookup"><span data-stu-id="360a4-121">The +0.5 bias to both coordinates places the point of zero-distortion at the center of the sphere map, and a vertex normal of (0, 0, z) addresses this point.</span></span> <span data-ttu-id="360a4-122">Cette formule n’est pas prise en compte pour le composant z de la normale, mais les applications qui utilisent la formule peuvent optimiser les calculs en ignorant les vertex avec un normal qui a un élément z positif.</span><span class="sxs-lookup"><span data-stu-id="360a4-122">This formula doesn't account for the z component of the normal, but applications that use the formula can optimize computations by skipping vertices with a normal that has a positive z element.</span></span> <span data-ttu-id="360a4-123">Cela fonctionne pour les objets à ombrage constant, car, dans l’espace de l’appareil photo, si les points normaux s’éloignent de l’appareil photo (z positif), le sommet est éliminé lors du rendu de l’objet.</span><span class="sxs-lookup"><span data-stu-id="360a4-123">This works for flat-shaded objects because, in camera space, if the normal points away from the camera (positive z), the vertex is culled when the object is rendered.</span></span> <span data-ttu-id="360a4-124">Pour les objets ombrés Gouraud, un normal peut pointer à distance de l’appareil photo (x positif) et le triangle contenant le sommet peut encore être visible.</span><span class="sxs-lookup"><span data-stu-id="360a4-124">For Gouraud-shaded objects, a normal can point away from the camera (positive x), and the triangle containing the vertex can still be visible.</span></span> <span data-ttu-id="360a4-125">Si vous ne Calculez pas et v pour ce vertex, la face peut encore être utilisée, ce qui entraîne un comportement inattendu.</span><span class="sxs-lookup"><span data-stu-id="360a4-125">If you don't compute u and v for this vertex, the face might still be used, resulting in unexpected behavior.</span></span>

## <a name="applying-spherical-environment-maps"></a><span data-ttu-id="360a4-126">Application de cartes d’environnement sphériques</span><span class="sxs-lookup"><span data-stu-id="360a4-126">Applying Spherical Environment Maps</span></span>

<span data-ttu-id="360a4-127">Vous appliquez un mappage d’environnement aux objets de la même façon que pour toute autre texture, en affectant à la texture l’étape de texture appropriée à l’aide de la méthode [**IDirect3DDevice9 :: SetTexture**](/windows/desktop/api) .</span><span class="sxs-lookup"><span data-stu-id="360a4-127">You apply an environment map to objects in the same manner as for any other texture, by setting the texture to the appropriate texture stage with the [**IDirect3DDevice9::SetTexture**](/windows/desktop/api) method.</span></span> <span data-ttu-id="360a4-128">Définissez le premier paramètre sur l’index de l’étape de texture souhaitée, puis définissez le deuxième paramètre sur l’adresse de l’interface [**IDirect3DDevice9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3ddevice9) retournée lorsque vous avez créé la texture de la carte d’environnement.</span><span class="sxs-lookup"><span data-stu-id="360a4-128">Set the first parameter to the index for the desired texture stage, and set the second parameter to the address of the [**IDirect3DDevice9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3ddevice9) interface returned when you created the texture for the environment map.</span></span> <span data-ttu-id="360a4-129">Vous pouvez définir les opérations et les arguments de fusion alpha et de couleur si nécessaire pour obtenir les effets de fusion de texture souhaités.</span><span class="sxs-lookup"><span data-stu-id="360a4-129">You can set the color and alpha blending operations and arguments as needed to achieve the desired texture blending effects.</span></span>

## <a name="related-topics"></a><span data-ttu-id="360a4-130">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="360a4-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="360a4-131">Mappage d’environnement</span><span class="sxs-lookup"><span data-stu-id="360a4-131">Environment Mapping</span></span>](environment-mapping.md)
</dt> </dl>

 

 
