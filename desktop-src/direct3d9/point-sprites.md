---
description: La prise en charge des points sprites dans Direct3D 9 permet le rendu hautes performances des points (systèmes de particule). Les sprites point sont des généralisations de points génériques qui permettent le rendu de formes arbitraires comme défini par les textures.
ms.assetid: a9046c7e-779c-4f33-b8ff-f189da3dcfc5
title: Points sprites (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c988a104eb65b5e2d7e56ff2444e8d422c422df2
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104521708"
---
# <a name="point-sprites-direct3d-9"></a><span data-ttu-id="f1229-104">Points sprites (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="f1229-104">Point Sprites (Direct3D 9)</span></span>

<span data-ttu-id="f1229-105">La prise en charge des points sprites dans Direct3D 9 permet le rendu hautes performances des points (systèmes de particule).</span><span class="sxs-lookup"><span data-stu-id="f1229-105">Support for point sprites in Direct3D 9 enables the high-performance rendering of points (particle systems).</span></span> <span data-ttu-id="f1229-106">Les sprites point sont des généralisations de points génériques qui permettent le rendu de formes arbitraires comme défini par les textures.</span><span class="sxs-lookup"><span data-stu-id="f1229-106">Point sprites are generalizations of generic points that enable arbitrary shapes to be rendered as defined by textures.</span></span>

-   [<span data-ttu-id="f1229-107">Contrôles de rendu de primitive point</span><span class="sxs-lookup"><span data-stu-id="f1229-107">Point Primitive Rendering Controls</span></span>](#point-primitive-rendering-controls)
-   [<span data-ttu-id="f1229-108">Calculs de la taille des points</span><span class="sxs-lookup"><span data-stu-id="f1229-108">Point Size Computations</span></span>](#point-size-computations)
-   [<span data-ttu-id="f1229-109">Rendu de point</span><span class="sxs-lookup"><span data-stu-id="f1229-109">Point Rendering</span></span>](#point-rendering)

## <a name="point-primitive-rendering-controls"></a><span data-ttu-id="f1229-110">Contrôles de rendu de primitive point</span><span class="sxs-lookup"><span data-stu-id="f1229-110">Point Primitive Rendering Controls</span></span>

<span data-ttu-id="f1229-111">Direct3D 9 prend en charge des paramètres supplémentaires pour contrôler le rendu des sprites point (primitives point).</span><span class="sxs-lookup"><span data-stu-id="f1229-111">Direct3D 9 supports additional parameters to control the rendering of point sprites (point primitives).</span></span> <span data-ttu-id="f1229-112">Ces paramètres permettent aux points d’être de taille variable et de disposer d’une carte de texture complète appliquée.</span><span class="sxs-lookup"><span data-stu-id="f1229-112">These parameters enable points to be of variable size and have a full texture map applied.</span></span> <span data-ttu-id="f1229-113">La taille de chaque point est déterminée par une taille spécifiée par l’application et associée à une fonction basée sur les distances calculée par Direct3D.</span><span class="sxs-lookup"><span data-stu-id="f1229-113">The size of each point is determined by an application-specified size combined with a distance-based function computed by Direct3D.</span></span> <span data-ttu-id="f1229-114">L’application peut spécifier la taille du point en fonction du vertex ou en définissant D3DRS Desize \_ , qui s’applique aux points sans taille par vertex.</span><span class="sxs-lookup"><span data-stu-id="f1229-114">The application can specify point size either as per-vertex or by setting D3DRS\_POINTSIZE, which applies to points without a per-vertex size.</span></span> <span data-ttu-id="f1229-115">La taille en points est exprimée en unités d’espace de caméra, à l’exception du moment où l’application transmet des vertex de format de vertex flexible (prix de revient) après transformation.</span><span class="sxs-lookup"><span data-stu-id="f1229-115">The point size is expressed in camera space units, with the exception of when the application is passing post-transformed flexible vertex format (FVF) vertices.</span></span> <span data-ttu-id="f1229-116">Dans ce cas, la fonction basée sur la distance n’est pas appliquée et la taille du point est exprimée en unités de pixels sur la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="f1229-116">In this case, the distance-based function is not applied and the point size is expressed in units of pixels on the render target.</span></span>

<span data-ttu-id="f1229-117">Les coordonnées de texture calculées et utilisées lors du rendu des points dépendent du paramètre de D3DRS \_ POINTSPRITEENABLE.</span><span class="sxs-lookup"><span data-stu-id="f1229-117">The texture coordinates computed and used when rendering points depends on the setting of D3DRS\_POINTSPRITEENABLE.</span></span> <span data-ttu-id="f1229-118">Lorsque cette valeur est définie sur **true**, les coordonnées de texture sont définies de sorte que chaque point affiche la texture complète.</span><span class="sxs-lookup"><span data-stu-id="f1229-118">When this value is set to **TRUE**, the texture coordinates are set so that each point displays the full texture.</span></span> <span data-ttu-id="f1229-119">En général, cela n’est utile que lorsque les points sont beaucoup plus volumineux qu’un pixel.</span><span class="sxs-lookup"><span data-stu-id="f1229-119">In general, this is only useful when points are significantly larger than one pixel.</span></span> <span data-ttu-id="f1229-120">Lorsque D3DRS \_ POINTSPRITEENABLE est défini sur **false**, la coordonnée de texture vertex de chaque point est utilisée pour le point entier.</span><span class="sxs-lookup"><span data-stu-id="f1229-120">When D3DRS\_POINTSPRITEENABLE is set to **FALSE**, each point's vertex texture coordinate is used for the entire point.</span></span>

## <a name="point-size-computations"></a><span data-ttu-id="f1229-121">Calculs de la taille des points</span><span class="sxs-lookup"><span data-stu-id="f1229-121">Point Size Computations</span></span>

<span data-ttu-id="f1229-122">La taille du point est déterminée par D3DRS \_ POINTSCALEENABLE.</span><span class="sxs-lookup"><span data-stu-id="f1229-122">Point size is determined by D3DRS\_POINTSCALEENABLE.</span></span> <span data-ttu-id="f1229-123">Si cette valeur est définie sur **false**, la taille de point spécifiée par l’application est utilisée comme taille d’espace d’écran (après conversion).</span><span class="sxs-lookup"><span data-stu-id="f1229-123">If this value is set to **FALSE**, the application-specified point size is used as the screen-space (post-transformed) size.</span></span> <span data-ttu-id="f1229-124">Les vertex passés à Direct3D dans l’espace à l’écran n’ont pas de tailles de points calculées ; la taille de point spécifiée est interprétée comme la taille de l’espace à l’écran.</span><span class="sxs-lookup"><span data-stu-id="f1229-124">Vertices that are passed to Direct3D in screen space do not have point sizes computed; the specified point size is interpreted as screen-space size.</span></span>

<span data-ttu-id="f1229-125">Si D3DRS \_ POINTSCALEENABLE a la **valeur true**, Direct3D calcule la taille du point d’espace d’écran en fonction de la formule suivante.</span><span class="sxs-lookup"><span data-stu-id="f1229-125">If D3DRS\_POINTSCALEENABLE is **TRUE**, Direct3D computes the screen-space point size according to the following formula.</span></span> <span data-ttu-id="f1229-126">La taille de point spécifiée par l’application est exprimée en unités d’espace de caméra.</span><span class="sxs-lookup"><span data-stu-id="f1229-126">The application-specified point size is expressed in camera space units.</span></span>

<span data-ttu-id="f1229-127">S s = VH \* s <sub>i</sub> \* racine (1/(A + B \* D ₑ + C \* (D ₑ ²)))</span><span class="sxs-lookup"><span data-stu-id="f1229-127">S ₛ = Vₕ \* S <sub>i</sub> \* sqrt(1/(A + B \* D ₑ + C \*( D ₑ² )))</span></span>

<span data-ttu-id="f1229-128">Dans cette formule, la taille du point d’entrée, S <sub>i</sub>, est soit par vertex, soit la valeur de l’état de rendu D3DRS redimensionnement \_ .</span><span class="sxs-lookup"><span data-stu-id="f1229-128">In this formula, the input point size, S <sub>i</sub>, is either per-vertex or the value of the D3DRS\_POINTSIZE render state.</span></span> <span data-ttu-id="f1229-129">Les facteurs de mise à l’échelle du point, D3DRS \_ POINTSCALE \_ A, D3DRS \_ POINTSCALE \_ B et D3DRS \_ POINTSCALE \_ C, sont représentés par les points A, B et c. La hauteur de la fenêtre d’affichage, V h, est le membre Height de la structure [**D3DVIEWPORT9**](d3dviewport9.md) représentant la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1229-129">The point scale factors, D3DRS\_POINTSCALE\_A, D3DRS\_POINTSCALE\_B, and D3DRS\_POINTSCALE\_C, are represented by the points A, B, and C. The height of the viewport, V ₕ, is the [**D3DVIEWPORT9**](d3dviewport9.md) structure's Height member representing the viewport.</span></span> <span data-ttu-id="f1229-130">D ₑ, la distance entre l’œil et la position (l’œil à l’origine), est calculée en tenant la position de l’espace œil du point (X ₑ, Y ₑ, Z ₑ) et en effectuant l’opération suivante.</span><span class="sxs-lookup"><span data-stu-id="f1229-130">D ₑ, the distance from the eye to the position (the eye at the origin), is computed by taking the eye space position of the point (Xₑ, Yₑ, Zₑ) and performing the following operation.</span></span>

<span data-ttu-id="f1229-131">D ₑ = sqrt (X ₑ ² + Y ₑ ² + Z ₑ ²)</span><span class="sxs-lookup"><span data-stu-id="f1229-131">D ₑ = sqrt (Xₑ² + Y ₑ² + Z ₑ²)</span></span>

<span data-ttu-id="f1229-132">La taille maximale en points, PM ₐ ₓ, est déterminée en acceptant la valeur la plus petite du membre MaxPointSize de la structure [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) ou de l' \_ État de rendu max de l’D3DRS \_ .</span><span class="sxs-lookup"><span data-stu-id="f1229-132">The maximum point size, Pₘₐₓ, is determined by taking the smaller of either the [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) structure's MaxPointSize member or the D3DRS\_POINTSIZE\_MAX render state.</span></span> <span data-ttu-id="f1229-133">La taille en points minimale, P<sub>min</sub>, est déterminée par l’interrogation de la valeur de D3DRS \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="f1229-133">The minimum point size, P<sub>min</sub>, is determined by querying the value of D3DRS\_POINTSIZE\_MIN.</span></span> <span data-ttu-id="f1229-134">Par conséquent, la taille finale du point d’espace d’écran, S, est déterminée de la manière suivante.</span><span class="sxs-lookup"><span data-stu-id="f1229-134">Thus the final screen-space point size, S, is determined in the following manner.</span></span>

-   <span data-ttu-id="f1229-135">Si SS > PM ₐ ₓ, alors S = P m ₐ ₓ</span><span class="sxs-lookup"><span data-stu-id="f1229-135">If Sₛ > Pₘₐₓ, then S = P ₘₐₓ</span></span>
-   <span data-ttu-id="f1229-136">Si S < P<sub>min</sub>, alors s = p <sub>min</sub></span><span class="sxs-lookup"><span data-stu-id="f1229-136">if S < P<sub>min</sub>, then S = P <sub>min</sub></span></span>
-   <span data-ttu-id="f1229-137">Sinon, S = S s</span><span class="sxs-lookup"><span data-stu-id="f1229-137">Otherwise, S = S ₛ</span></span>

## <a name="point-rendering"></a><span data-ttu-id="f1229-138">Rendu de point</span><span class="sxs-lookup"><span data-stu-id="f1229-138">Point Rendering</span></span>

<span data-ttu-id="f1229-139">Un point d’espace d’écran, P = (X, Y, Z, W), de taille d’espace d’écran S est pixellisé en tant que quadrangulaires des quatre sommets suivants.</span><span class="sxs-lookup"><span data-stu-id="f1229-139">A screen-space point, P = ( X, Y, Z, W), of screen-space size S is rasterized as a quadrilateral of the following four vertices.</span></span>

<span data-ttu-id="f1229-140">((X + S/2, Y + S/2, Z, W), (X + S/2, Y-S/2, Z, W), (X-S/2, Y-S/2, Z, W), (X-S/2, Y + S/2, Z, W))</span><span class="sxs-lookup"><span data-stu-id="f1229-140">(( X + S/2, Y + S/2, Z, W), ( X + S/2, Y - S/2, Z, W), ( X - S/2, Y- S/2, Z, W), ( X - S/2, Y + S/2, Z, W))</span></span>

<span data-ttu-id="f1229-141">Les attributs de couleur du vertex sont dupliqués à chaque vertex ; par conséquent, chaque point est toujours rendu avec des couleurs constantes.</span><span class="sxs-lookup"><span data-stu-id="f1229-141">The vertex color attributes are duplicated at each vertex; thus each point is always rendered with constant colors.</span></span>

<span data-ttu-id="f1229-142">L’affectation d’index de texture est contrôlée par le paramètre d' \_ État de rendu D3DRS POINTSPRITEENABLE.</span><span class="sxs-lookup"><span data-stu-id="f1229-142">The assignment of texture indices is controlled by the D3DRS\_POINTSPRITEENABLE render state setting.</span></span> <span data-ttu-id="f1229-143">Si D3DRS \_ POINTSPRITEENABLE est défini sur **false**, les coordonnées de texture de vertex sont dupliquées à chaque vertex.</span><span class="sxs-lookup"><span data-stu-id="f1229-143">If D3DRS\_POINTSPRITEENABLE is set to **FALSE**, then the vertex texture coordinates are duplicated at each vertex.</span></span> <span data-ttu-id="f1229-144">Si D3DRS \_ POINTSPRITEENABLE est défini sur **true**, les coordonnées de texture aux quatre sommets sont définies sur les valeurs suivantes.</span><span class="sxs-lookup"><span data-stu-id="f1229-144">If D3DRS\_POINTSPRITEENABLE is set to **TRUE**, then the texture coordinates at the four vertices are set to the following values.</span></span>

<span data-ttu-id="f1229-145">(0. F, 0. F), (0. F, 1. F), (1. F, 0. F), (1. F, 1. F)</span><span class="sxs-lookup"><span data-stu-id="f1229-145">(0.F, 0.F), (0.F, 1.F), (1.F, 0.F), (1.F, 1.F)</span></span>

<span data-ttu-id="f1229-146">Cette situation est présentée dans le diagramme suivant.</span><span class="sxs-lookup"><span data-stu-id="f1229-146">This is shown in the following diagram.</span></span>

![diagramme d’un carré avec des sommets étiquetés pour les valeurs de coordonnée (u, v) et (x, y)](images/spritepoint.png)

<span data-ttu-id="f1229-148">Lorsque le découpage est activé, les points sont découpés de la manière suivante.</span><span class="sxs-lookup"><span data-stu-id="f1229-148">When clipping is enabled, points are clipped in the following manner.</span></span> <span data-ttu-id="f1229-149">Si le vertex dépasse la plage de valeurs de profondeur-MinZ et MaxZ de la structure [**D3DVIEWPORT9**](d3dviewport9.md) -dans laquelle une scène doit être rendue, le point existe en dehors de la vue frustum et n’est pas rendu.</span><span class="sxs-lookup"><span data-stu-id="f1229-149">If the vertex exceeds the range of depth values - MinZ and MaxZ of the [**D3DVIEWPORT9**](d3dviewport9.md) structure - into which a scene is to be rendered, the point exists outside of the view frustum and is not rendered.</span></span> <span data-ttu-id="f1229-150">Si le point, en tenant compte de la taille du point, est complètement à l’extérieur de la fenêtre d’affichage dans X et Y, le point n’est pas rendu ; les points restants sont rendus.</span><span class="sxs-lookup"><span data-stu-id="f1229-150">If the point, taking into account the point size, is completely outside the viewport in X and Y, then the point is not rendered; the remaining points are rendered.</span></span> <span data-ttu-id="f1229-151">Il est possible que la position du point se trouve en dehors de la fenêtre d’affichage dans X ou Y et soit toujours partiellement visible.</span><span class="sxs-lookup"><span data-stu-id="f1229-151">It is possible for the point position to be outside the viewport in X or Y and still be partially visible.</span></span>

<span data-ttu-id="f1229-152">Les points peuvent ou ne peuvent pas être correctement découpés en plans de clip définis par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f1229-152">Points may or may not be correctly clipped to user-defined clip planes.</span></span> <span data-ttu-id="f1229-153">Si D3DPMISCCAPS \_ CLIPPLANESCALEDPOINTS n’est pas défini dans le membre PrimitiveMiscCaps de la structure [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) , les points sont découpés en plans de séquence définis par l’utilisateur, basés uniquement sur la position du vertex, en ignorant la taille du point.</span><span class="sxs-lookup"><span data-stu-id="f1229-153">If D3DPMISCCAPS\_CLIPPLANESCALEDPOINTS is not set in the [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) structure's PrimitiveMiscCaps member, points are clipped to user-defined clip planes based only on the vertex position, ignoring the point size.</span></span> <span data-ttu-id="f1229-154">Dans ce cas, les points mis à l’échelle sont entièrement rendus lorsque la position du vertex est à l’intérieur des plans de coupe et sont ignorés lorsque la position du vertex est à l’extérieur d’un plan de découpage.</span><span class="sxs-lookup"><span data-stu-id="f1229-154">In this case, scaled points are fully rendered when the vertex position is inside the clip planes, and discarded when the vertex position is outside a clip plane.</span></span> <span data-ttu-id="f1229-155">Les applications peuvent empêcher des artefacts potentiels en ajoutant une géométrie de bordure aux plans de découpage qui est aussi grande que la taille maximale du point.</span><span class="sxs-lookup"><span data-stu-id="f1229-155">Applications can prevent potential artifacts by adding a border geometry to clip planes that is as large as the maximum point size.</span></span>

<span data-ttu-id="f1229-156">Si le \_ bit D3DPMISCCAPS CLIPPLANESCALEDPOINTS est défini, les points mis à l’échelle sont correctement découpés en plans de clip définis par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f1229-156">If the D3DPMISCCAPS\_CLIPPLANESCALEDPOINTS bit is set, then the scaled points are correctly clipped to user-defined clip planes.</span></span>

<span data-ttu-id="f1229-157">Le traitement du vertex matériel peut ou non prendre en charge la taille du point.</span><span class="sxs-lookup"><span data-stu-id="f1229-157">Hardware vertex processing may or may not support point size.</span></span> <span data-ttu-id="f1229-158">Par exemple, si un appareil est créé avec \_ le matériel D3DCREATE \_ VERTEXPROCESSING sur un appareil Hal (Hardware Abstraction Layer) ( \_ HAL D3DDEVTYPE) dont le membre MaxPointSize de la structure [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) est défini sur 1,0 ou 0,0, tous les points sont un pixel unique.</span><span class="sxs-lookup"><span data-stu-id="f1229-158">For example, if a device is created with D3DCREATE\_HARDWARE\_VERTEXPROCESSING on a hardware abstraction layer (HAL) device (D3DDEVTYPE\_HAL) that has the [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) structure's MaxPointSize member set to 1.0 or 0.0, then all points are a single pixel.</span></span> <span data-ttu-id="f1229-159">Pour restituer des sprites de point de pixel inférieurs à 1,0, vous devez utiliser des vertex (transformés et allumés) au prix de la Commission (D3DCREATE \_ Software \_ VERTEXPROCESSING), auquel cas le runtime Direct3D émule le rendu du point Sprite.</span><span class="sxs-lookup"><span data-stu-id="f1229-159">To render pixel point sprites less than 1.0, you must use either FVF TL (transformed and lit) vertices or software vertex processing (D3DCREATE\_SOFTWARE\_VERTEXPROCESSING), in which case the Direct3D run time emulates the point sprite rendering.</span></span>

<span data-ttu-id="f1229-160">Un périphérique matériel qui effectue le traitement des vertex et prend en charge les sprites de point-MaxPointSize définis sur une valeur supérieure à 1.0 f-est requis pour effectuer le calcul de la taille des sprites non transformés et est requis pour définir correctement les points de par vertex ou D3DRS \_ \_ pour les vertex TL.</span><span class="sxs-lookup"><span data-stu-id="f1229-160">A hardware device that does vertex processing and supports point sprites - MaxPointSize set to greater than 1.0f - is required to perform the size computation for nontransformed sprites and is required to properly set the per-vertex or D3DRS\_POINTSIZED3DRS\_POINTSIZE for TL vertices.</span></span>

<span data-ttu-id="f1229-161">Pour plus d’informations sur les règles de rendu des points, des lignes et des triangles, consultez [règles de pixellisation (Direct3D 9)](rasterization-rules.md).</span><span class="sxs-lookup"><span data-stu-id="f1229-161">For information about rendering rules for points, lines, and triangles, see [Rasterization Rules (Direct3D 9)](rasterization-rules.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="f1229-162">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f1229-162">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f1229-163">Pipeline de vertex</span><span class="sxs-lookup"><span data-stu-id="f1229-163">Vertex Pipeline</span></span>](vertex-pipeline.md)
</dt> </dl>

 

 



