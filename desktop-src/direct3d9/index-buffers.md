---
description: Les mémoires tampons d’index, représentées par l’interface IDirect3DIndexBuffer9, sont des mémoires tampons qui contiennent des données d’index.
ms.assetid: baa60cd1-a1f0-4dbe-b934-aeb1a5c6b784
title: Mémoires tampons d’index (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7151fae6deb72a0c569d269c80e5b13bf946f9d0
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "103845965"
---
# <a name="index-buffers-direct3d-9"></a><span data-ttu-id="c617b-103">Mémoires tampons d’index (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c617b-103">Index Buffers (Direct3D 9)</span></span>

<span data-ttu-id="c617b-104">Les mémoires tampons d’index, représentées par l’interface [**IDirect3DIndexBuffer9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dindexbuffer9) , sont des mémoires tampons qui contiennent des données d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-104">Index buffers, represented by the [**IDirect3DIndexBuffer9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dindexbuffer9) interface, are memory buffers that contain index data.</span></span> <span data-ttu-id="c617b-105">Les données d’index, ou indices, sont des décalages d’entiers dans les tampons de vertex et sont utilisés pour restituer des primitives à l’aide de la méthode [**IDirect3DDevice9 ::D rawindexedprimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive) .</span><span class="sxs-lookup"><span data-stu-id="c617b-105">Index data, or indices, are integer offsets into vertex buffers and are used to render primitives using the [**IDirect3DDevice9::DrawIndexedPrimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive) method.</span></span>

<span data-ttu-id="c617b-106">Une mémoire tampon de vertex contient des vertex ; par conséquent, vous pouvez dessiner une mémoire tampon de vertex avec ou sans primitives indexées.</span><span class="sxs-lookup"><span data-stu-id="c617b-106">A vertex buffer contains vertices; therefore, you can draw a vertex buffer either with or without indexed primitives.</span></span> <span data-ttu-id="c617b-107">Toutefois, étant donné qu’un tampon d’index contient des indices, vous ne pouvez pas utiliser un tampon d’index sans une mémoire tampon de vertex correspondante.</span><span class="sxs-lookup"><span data-stu-id="c617b-107">However, because an index buffer contains indices, you cannot use an index buffer without a corresponding vertex buffer.</span></span> <span data-ttu-id="c617b-108">(À titre d’exemple, [**IDirect3DDevice9 ::D rawindexedprimitiveup**](/windows/desktop/api) et [**IDirect3DDevice9 ::D rawprimitiveup**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawprimitiveup) sont les seules méthodes de dessin qui dessinent sans index ou une mémoire tampon de vertex.)</span><span class="sxs-lookup"><span data-stu-id="c617b-108">(As a side note, [**IDirect3DDevice9::DrawIndexedPrimitiveUP**](/windows/desktop/api) and [**IDirect3DDevice9::DrawPrimitiveUP**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawprimitiveup) are the only draw methods that draw without an index or a vertex buffer.)</span></span>

## <a name="index-buffer-description"></a><span data-ttu-id="c617b-109">Description de la mémoire tampon d’index</span><span class="sxs-lookup"><span data-stu-id="c617b-109">Index Buffer Description</span></span>

<span data-ttu-id="c617b-110">Une mémoire tampon d’index est décrite en termes de fonctionnalités, telles que son emplacement dans la mémoire, si elle prend en charge la lecture et l’écriture, et le type et le nombre d’index qu’elle peut contenir.</span><span class="sxs-lookup"><span data-stu-id="c617b-110">An index buffer is described in terms of its capabilities, such as where it exists in memory, whether it supports reading and writing, and the type and number of indices it can contain.</span></span> <span data-ttu-id="c617b-111">Ces caractéristiques sont conservées dans une structure [**D3DINDEXBUFFER \_ desc**](d3dindexbuffer-desc.md) .</span><span class="sxs-lookup"><span data-stu-id="c617b-111">These traits are held in a [**D3DINDEXBUFFER\_DESC**](d3dindexbuffer-desc.md) structure.</span></span>

<span data-ttu-id="c617b-112">Les descriptions de la mémoire tampon d’index indiquent à votre application comment une mémoire tampon existante a été créée.</span><span class="sxs-lookup"><span data-stu-id="c617b-112">Index buffer descriptions tell your application how an existing buffer was created.</span></span> <span data-ttu-id="c617b-113">Vous fournissez une structure de description vide pour que le système remplisse les fonctionnalités d’un tampon d’index créé précédemment.</span><span class="sxs-lookup"><span data-stu-id="c617b-113">You provide an empty description structure for the system to fill with the capabilities of a previously created index buffer.</span></span>

-   <span data-ttu-id="c617b-114">Le membre de format décrit le format de surface des données de la mémoire tampon d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-114">The Format member describes the surface format of the index buffer data.</span></span>
-   <span data-ttu-id="c617b-115">Le type identifie le type de ressource de la mémoire tampon d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-115">The Type identifies the resource type of the index buffer.</span></span>
-   <span data-ttu-id="c617b-116">Le membre de la structure d’utilisation contient des indicateurs de capacité généraux.</span><span class="sxs-lookup"><span data-stu-id="c617b-116">The Usage structure member contains general capability flags.</span></span> <span data-ttu-id="c617b-117">L' \_ indicateur D3DUSAGE SOFTWAREPROCESSING indique que le tampon d’index doit être utilisé avec le traitement du vertex logiciel.</span><span class="sxs-lookup"><span data-stu-id="c617b-117">The D3DUSAGE\_SOFTWAREPROCESSING flag indicates that the index buffer is to be used with software vertex processing.</span></span> <span data-ttu-id="c617b-118">La présence de l' \_ indicateur WRITEONLY D3DUSAGE dans usage indique que la mémoire tampon d’index est utilisée uniquement pour les opérations d’écriture.</span><span class="sxs-lookup"><span data-stu-id="c617b-118">The presence of the D3DUSAGE\_WRITEONLY flag in Usage indicates that the index buffer memory is used only for write operations.</span></span> <span data-ttu-id="c617b-119">Cela libère le pilote pour placer les données d’index dans le meilleur emplacement de mémoire pour permettre un traitement et un rendu rapides.</span><span class="sxs-lookup"><span data-stu-id="c617b-119">This frees the driver to place the index data in the best memory location to enable fast processing and rendering.</span></span> <span data-ttu-id="c617b-120">Si l' \_ indicateur WRITEONLY D3DUSAGE n’est pas utilisé, le pilote est moins susceptible de placer les données dans un emplacement qui est inefficace pour les opérations de lecture.</span><span class="sxs-lookup"><span data-stu-id="c617b-120">If the D3DUSAGE\_WRITEONLY flag is not used, the driver is less likely to put the data in a location that is inefficient for read operations.</span></span> <span data-ttu-id="c617b-121">Cela sacrifie la vitesse de traitement et de rendu.</span><span class="sxs-lookup"><span data-stu-id="c617b-121">This sacrifices some processing and rendering speed.</span></span> <span data-ttu-id="c617b-122">Si cet indicateur n’est pas spécifié, il est supposé que les applications effectuent des opérations de lecture et d’écriture sur les données de la mémoire tampon d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-122">If this flag is not specified, it is assumed that applications perform read and write operations on the data in the index buffer.</span></span>
-   <span data-ttu-id="c617b-123">Pool spécifie la classe de mémoire allouée pour le tampon d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-123">Pool specifies the memory class allocated for the index buffer.</span></span> <span data-ttu-id="c617b-124">L' \_ indicateur D3DPOOL SYSTEMMEM indique que le système a créé la mémoire tampon d’index dans la mémoire système.</span><span class="sxs-lookup"><span data-stu-id="c617b-124">The D3DPOOL\_SYSTEMMEM flag indicates that the system created the index buffer in system memory.</span></span>
-   <span data-ttu-id="c617b-125">Le membre de taille stocke la taille, en octets, des données de mémoire tampon de vertex.</span><span class="sxs-lookup"><span data-stu-id="c617b-125">The Size member stores the size, in bytes, of the vertex buffer data.</span></span>
-   <span data-ttu-id="c617b-126">Le dernier paramètre pSharedHandle n’est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="c617b-126">The last parameter pSharedHandle is not used.</span></span> <span data-ttu-id="c617b-127">Affectez-lui la valeur **null**.</span><span class="sxs-lookup"><span data-stu-id="c617b-127">Set it to **NULL**.</span></span>

## <a name="index-processing-requirements"></a><span data-ttu-id="c617b-128">Exigences relatives au traitement des index</span><span class="sxs-lookup"><span data-stu-id="c617b-128">Index Processing Requirements</span></span>

<span data-ttu-id="c617b-129">Les performances des opérations de traitement d’index dépendent en grande partie de l’emplacement de la mémoire tampon d’index dans la mémoire et du type de périphérique de rendu utilisé.</span><span class="sxs-lookup"><span data-stu-id="c617b-129">The performance of index processing operations depends heavily on where the index buffer exists in memory and what type of rendering device is being used.</span></span> <span data-ttu-id="c617b-130">Les applications contrôlent l’allocation de mémoire pour les mémoires tampons d’index lorsqu’elles sont créées.</span><span class="sxs-lookup"><span data-stu-id="c617b-130">Applications control the memory allocation for index buffers when they are created.</span></span> <span data-ttu-id="c617b-131">Lorsque l' \_ indicateur de mémoire D3DPOOL SYSTEMMEM est défini, la mémoire tampon d’index est créée dans la mémoire système.</span><span class="sxs-lookup"><span data-stu-id="c617b-131">When the D3DPOOL\_SYSTEMMEM memory flag is set, the index buffer is created in system memory.</span></span> <span data-ttu-id="c617b-132">Lorsque l' \_ indicateur de mémoire par défaut D3DPOOL est utilisé, le pilote de périphérique détermine l’emplacement de la mémoire tampon d’index la plus appropriée, souvent appelée mémoire optimale pour le pilote.</span><span class="sxs-lookup"><span data-stu-id="c617b-132">When the D3DPOOL\_DEFAULT memory flag is used, the device driver determines where the memory for the index buffer is best allocated, often referred to as driver-optimal memory.</span></span> <span data-ttu-id="c617b-133">La mémoire optimale pour le pilote peut être une mémoire vidéo locale, une mémoire vidéo non locale ou une mémoire système.</span><span class="sxs-lookup"><span data-stu-id="c617b-133">Driver-optimal memory can be local video memory, non-local video memory, or system memory.</span></span>

<span data-ttu-id="c617b-134">La définition de l' \_ indicateur de comportement D3DUSAGE SOFTWAREPROCESSING lors de l’appel de la méthode [**IDirect3DDevice9 :: CreateIndexBuffer**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createindexbuffer) spécifie que la mémoire tampon d’index doit être utilisée avec le traitement du vertex logiciel.</span><span class="sxs-lookup"><span data-stu-id="c617b-134">Setting the D3DUSAGE\_SOFTWAREPROCESSING behavior flag when calling the [**IDirect3DDevice9::CreateIndexBuffer**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createindexbuffer) method specifies that the index buffer is to be used with software vertex processing.</span></span> <span data-ttu-id="c617b-135">Cet indicateur est requis dans le traitement des vertex en mode mixte (D3DCREATE \_ Mixed \_ VERTEXPROCESSING) lorsque le traitement du vertex logiciel est utilisé.</span><span class="sxs-lookup"><span data-stu-id="c617b-135">This flag is required in mixed mode vertex processing (D3DCREATE\_MIXED\_VERTEXPROCESSING) when software vertex processing is used.</span></span>

<span data-ttu-id="c617b-136">L’application peut écrire directement des index dans un tampon d’index alloué dans la mémoire optimale du pilote.</span><span class="sxs-lookup"><span data-stu-id="c617b-136">The application can directly write indices to a index buffer allocated in driver-optimal memory.</span></span> <span data-ttu-id="c617b-137">Cette technique empêche ultérieurement une opération de copie redondante.</span><span class="sxs-lookup"><span data-stu-id="c617b-137">This technique prevents a redundant copy operation later.</span></span> <span data-ttu-id="c617b-138">Cette technique ne fonctionne pas correctement si votre application lit les données à partir d’un tampon d’index, car les opérations de lecture effectuées par l’hôte à partir de la mémoire optimale du pilote peuvent être très lentes.</span><span class="sxs-lookup"><span data-stu-id="c617b-138">This technique does not work well if your application reads data back from an index buffer, because read operations done by the host from driver-optimal memory can be very slow.</span></span> <span data-ttu-id="c617b-139">Par conséquent, si votre application doit lire au cours du traitement ou écrire des données dans la mémoire tampon de façon erratique, il est préférable de choisir un tampon d’index de mémoire système.</span><span class="sxs-lookup"><span data-stu-id="c617b-139">Therefore, if your application needs to read during processing or writes data to the buffer erratically, a system-memory index buffer is a better choice.</span></span>

> [!Note]  
> <span data-ttu-id="c617b-140">Utilisez toujours la \_ valeur par défaut D3DPOOL, sauf si vous ne souhaitez pas utiliser de mémoire vidéo ou utiliser de grandes quantités de RAM verrouillée en page lorsque le pilote met des tampons de vertex ou d’index dans la mémoire AGP.</span><span class="sxs-lookup"><span data-stu-id="c617b-140">Always use D3DPOOL\_DEFAULT, except when you don't want to use video memory or use large amounts of page-locked RAM when the driver is putting vertex or index buffers into AGP memory.</span></span>

 

## <a name="create-an-index-buffer"></a><span data-ttu-id="c617b-141">Créer un tampon d’index</span><span class="sxs-lookup"><span data-stu-id="c617b-141">Create an Index Buffer</span></span>

<span data-ttu-id="c617b-142">Créez un objet de mémoire tampon d’index en appelant la méthode [**IDirect3DDevice9 :: CreateIndexBuffer**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createindexbuffer) , qui accepte six paramètres.</span><span class="sxs-lookup"><span data-stu-id="c617b-142">Create an index buffer object by calling the [**IDirect3DDevice9::CreateIndexBuffer**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createindexbuffer) method, which accepts six parameters.</span></span>

-   <span data-ttu-id="c617b-143">Le premier paramètre spécifie la longueur de la mémoire tampon d’index, en octets.</span><span class="sxs-lookup"><span data-stu-id="c617b-143">The first parameter specifies the index buffer length, in bytes.</span></span>
-   <span data-ttu-id="c617b-144">Le deuxième paramètre est un ensemble de contrôles d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="c617b-144">The second parameter is a set of usage controls.</span></span> <span data-ttu-id="c617b-145">Entre autres choses, sa valeur détermine si les vertex référencés par les index peuvent contenir des informations de découpage.</span><span class="sxs-lookup"><span data-stu-id="c617b-145">Among other things, its value determines whether the vertices being referred to by the indices are capable of containing clipping information.</span></span> <span data-ttu-id="c617b-146">Pour améliorer les performances, spécifiez D3DUSAGE \_ DONOTCLIP lorsque le découpage n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="c617b-146">To improve performance, specify D3DUSAGE\_DONOTCLIP when clipping is not required.</span></span>

    <span data-ttu-id="c617b-147">L' \_ indicateur D3DUSAGE SOFTWAREPROCESSING peut être défini lorsque le traitement en mode mixte ou le traitement du vertex logiciel (D3DCREATE \_ Mixed \_ VERTEXPROCESSING/D3DCREATE \_ Software \_ VERTEXPROCESSING) est activé pour cet appareil.</span><span class="sxs-lookup"><span data-stu-id="c617b-147">The D3DUSAGE\_SOFTWAREPROCESSING flag can be set when mixed-mode or software vertex processing (D3DCREATE\_MIXED\_VERTEXPROCESSING / D3DCREATE\_SOFTWARE\_VERTEXPROCESSING) is enabled for that device.</span></span> <span data-ttu-id="c617b-148">D3DUSAGE \_ SOFTWAREPROCESSING doit être défini pour les mémoires tampons à utiliser avec le traitement du vertex logiciel en mode mixte, mais il ne doit pas être défini pour obtenir les meilleures performances possibles lors de l’utilisation du traitement de l’index matériel en mode mixte (D3DCREATE \_ matériel \_ VERTEXPROCESSING).</span><span class="sxs-lookup"><span data-stu-id="c617b-148">D3DUSAGE\_SOFTWAREPROCESSING must be set for buffers to be used with software vertex processing in mixed mode, but it should not be set for the best possible performance when using hardware index processing in mixed mode (D3DCREATE\_HARDWARE\_VERTEXPROCESSING).</span></span> <span data-ttu-id="c617b-149">Toutefois, la définition de D3DUSAGE \_ SOFTWAREPROCESSING est la seule option lorsqu’une seule mémoire tampon est utilisée avec le traitement du vertex matériel et logiciel.</span><span class="sxs-lookup"><span data-stu-id="c617b-149">However, setting D3DUSAGE\_SOFTWAREPROCESSING is the only option when a single buffer is used with both hardware and software vertex processing.</span></span> <span data-ttu-id="c617b-150">D3DUSAGE \_ SOFTWAREPROCESSING est autorisé pour les périphériques mixtes et logiciels.</span><span class="sxs-lookup"><span data-stu-id="c617b-150">D3DUSAGE\_SOFTWAREPROCESSING is allowed for mixed and software devices.</span></span>

    <span data-ttu-id="c617b-151">Il est possible de forcer des tampons de vertex et d’index dans la mémoire système en spécifiant D3DPOOL \_ SYSTEMMEM, même lorsque le traitement de l’index est effectué dans le matériel.</span><span class="sxs-lookup"><span data-stu-id="c617b-151">It is possible to force vertex and index buffers into system memory by specifying D3DPOOL\_SYSTEMMEM, even when the index processing is being done in hardware.</span></span> <span data-ttu-id="c617b-152">Il s’agit d’un moyen d’éviter une trop grande quantité de mémoire verrouillée en mode page lorsqu’un pilote met ces mémoires tampon dans la mémoire AGP.</span><span class="sxs-lookup"><span data-stu-id="c617b-152">This is a way to avoid overly large amounts of page-locked memory when a driver is putting these buffers into AGP memory.</span></span>

-   <span data-ttu-id="c617b-153">Le troisième paramètre est le membre D3DFMT \_ INDEX16 ou D3DFMT \_ INDEX32 du type énuméré [D3DFORMAT](d3dformat.md) qui spécifie la taille de chaque index.</span><span class="sxs-lookup"><span data-stu-id="c617b-153">The third parameter is either the D3DFMT\_INDEX16 or D3DFMT\_INDEX32 member of the [D3DFORMAT](d3dformat.md) enumerated type that specifies the size of each index.</span></span>

-   <span data-ttu-id="c617b-154">Le quatrième paramètre est un membre du type énuméré [**D3DPOOL**](./d3dpool.md) qui indique au système où placer en mémoire le nouveau tampon d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-154">The fourth parameter is a member of the [**D3DPOOL**](./d3dpool.md) enumerated type that tells the system where in memory to place the new index buffer.</span></span>

-   <span data-ttu-id="c617b-155">Le dernier paramètre que [**IDirect3DDevice9 :: CreateIndexBuffer**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createindexbuffer) accepte est l’adresse d’une variable qui est remplie avec un pointeur vers la nouvelle interface [**IDirect3DIndexBuffer9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dindexbuffer9) de l’objet de mémoire tampon de vertex, si l’appel a échoué.</span><span class="sxs-lookup"><span data-stu-id="c617b-155">The final parameter that [**IDirect3DDevice9::CreateIndexBuffer**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createindexbuffer) accepts is the address of a variable that is filled with a pointer to the new [**IDirect3DIndexBuffer9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dindexbuffer9) interface of the vertex buffer object, if the call succeeds.</span></span>

<span data-ttu-id="c617b-156">L’exemple de code C++ suivant montre à quoi peut ressembler la création d’un tampon d’index dans le code.</span><span class="sxs-lookup"><span data-stu-id="c617b-156">The following C++ code example shows what creating an index buffer might look like in code.</span></span>


```
/*
 * For the purposes of this example, the d3dDevice variable is the 
 * address of an IDirect3DDevice9 interface exposed by a 
 * Direct3DDevice object, g_IB is a variable of type 
 * LPDIRECT3DINDEXBUFFER9.
 */

if( FAILED( d3dDevice->CreateIndexBuffer( 16384 *sizeof(WORD),
           D3DUSAGE_WRITEONLY, D3DFMT_INDEX16, D3DPOOL_DEFAULT, 
           &g_IB, NULL ) ) )
    return E_FAIL;
```



## <a name="access-an-index-buffer"></a><span data-ttu-id="c617b-157">Accéder à un tampon d’index</span><span class="sxs-lookup"><span data-stu-id="c617b-157">Access an Index Buffer</span></span>

<span data-ttu-id="c617b-158">Les objets de mémoire tampon d’index permettent aux applications d’accéder directement à la mémoire allouée aux données d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-158">Index buffer objects enable applications to directly access the memory allocated for index data.</span></span> <span data-ttu-id="c617b-159">Vous pouvez récupérer un pointeur vers la mémoire tampon d’index en appelant la méthode [**IDirect3DIndexBuffer9 :: Lock**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dindexbuffer9-lock) , puis en accédant à la mémoire si nécessaire pour remplir la mémoire tampon avec les nouvelles données d’index ou pour lire les données qu’elle contient.</span><span class="sxs-lookup"><span data-stu-id="c617b-159">You can retrieve a pointer to index buffer memory by calling the [**IDirect3DIndexBuffer9::Lock**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dindexbuffer9-lock) method, and then accessing the memory as needed to fill the buffer with new index data or to read any data it contains.</span></span> <span data-ttu-id="c617b-160">La méthode Lock accepte quatre paramètres.</span><span class="sxs-lookup"><span data-stu-id="c617b-160">The Lock method accepts four parameters.</span></span> <span data-ttu-id="c617b-161">Le premier, *OffsetToLock*, est le décalage dans les données d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-161">The first, *OffsetToLock*, is the offset into the index data.</span></span> <span data-ttu-id="c617b-162">Le deuxième paramètre est la taille, exprimée en octets, des données de l’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-162">The second parameter is the size, measured in bytes, of the index data.</span></span> <span data-ttu-id="c617b-163">Le troisième paramètre accepté par la méthode **IDirect3DIndexBuffer9 :: Lock** , *ppbData*, est l’adresse d’un pointeur d’octet rempli d’un pointeur vers les données d’index, si l’appel est effectué.</span><span class="sxs-lookup"><span data-stu-id="c617b-163">The third parameter accepted by the **IDirect3DIndexBuffer9::Lock** method, *ppbData*, is the address of a BYTE pointer filled with a pointer to the index data, if the call succeeds.</span></span>

<span data-ttu-id="c617b-164">Le dernier paramètre, *Flags*, indique au système la manière dont la mémoire doit être verrouillée.</span><span class="sxs-lookup"><span data-stu-id="c617b-164">The last parameter, *Flags*, tells the system how the memory should be locked.</span></span> <span data-ttu-id="c617b-165">Vous pouvez l’utiliser pour indiquer comment l’application accède aux données dans la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="c617b-165">You can use it to indicate how the application accesses the data in the buffer.</span></span> <span data-ttu-id="c617b-166">Spécifiez les constantes pour le paramètre *Flags* en fonction de la façon dont votre application accède aux données d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-166">Specify constants for the *Flags* parameter according to the way the index data will be accessed by your application.</span></span> <span data-ttu-id="c617b-167">Cela permet au pilote de verrouiller la mémoire et de fournir des performances optimales en fonction du type d’accès demandé.</span><span class="sxs-lookup"><span data-stu-id="c617b-167">This allows the driver to lock the memory and provide the best performance given the requested access type.</span></span> <span data-ttu-id="c617b-168">Utilisez \_ l’indicateur D3DLOCK ReadOnly si votre application est en lecture seule à partir de la mémoire tampon d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-168">Use D3DLOCK\_READONLY flag if your application will read only from the index buffer memory.</span></span> <span data-ttu-id="c617b-169">L’inclusion de cet indicateur permet à Direct3D d’optimiser ses procédures internes pour améliorer l’efficacité, étant donné que l’accès à la mémoire est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c617b-169">Including this flag enables Direct3D to optimize its internal procedures to improve efficiency, given that access to the memory will be read-only.</span></span>

<span data-ttu-id="c617b-170">Après avoir rempli ou lu les données de l’index, appelez la méthode [**IDirect3DIndexBuffer9 :: Unlock**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dindexbuffer9-unlock) , comme indiqué dans l’exemple de code suivant.</span><span class="sxs-lookup"><span data-stu-id="c617b-170">After you fill or read the index data, call the [**IDirect3DIndexBuffer9::Unlock**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dindexbuffer9-unlock) method, as shown in the following code example.</span></span>


```
// This code example assumes the m_pIndexBuffer is a variable of type 
// LPDIRECT3DINDEXBUFFER9 and that g_Indices has been properly 
// initialized with indices.

// To fill the index buffer, you must lock the buffer to gain 
// access to the indices. This mechanism is required because index
// buffers may be in device memory.

VOID* pIndices;

if( FAILED( m_pIndexBuffer->Lock( 
      0,                 // Fill from start of the buffer
      sizeof(g_Indices), // Size of the data to load
      BYTE**)&pIndices,  // Returned index data
      0 ) ) )            // Send default flags to the lock
{
    SAFE_RELEASE(m_pIndexBuffer);
    return E_FAIL;
}

memcpy( pIndices, g_Indices, sizeof(g_Indices) );
m_pIndexBuffer->Unlock();
```



> [!Note]
>
> <span data-ttu-id="c617b-171">Si vous créez un tampon d’index avec l' \_ indicateur WRITEONLY D3DUSAGE, n’utilisez pas l' \_ indicateur de verrouillage ReadOnly D3DLOCK.</span><span class="sxs-lookup"><span data-stu-id="c617b-171">If you create an index buffer with the D3DUSAGE\_WRITEONLY flag, do not use the D3DLOCK\_READONLY locking flag.</span></span> <span data-ttu-id="c617b-172">Utilisez l' \_ indicateur D3DLOCK ReadOnly si votre application lit uniquement à partir de la mémoire tampon d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-172">Use the D3DLOCK\_READONLY flag if your application will read only from the index buffer memory.</span></span> <span data-ttu-id="c617b-173">L’inclusion de cet indicateur permet à Direct3D d’optimiser ses procédures internes pour améliorer l’efficacité, étant donné que l’accès à la mémoire est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c617b-173">Including this flag enables Direct3D to optimize its internal procedures to improve efficiency, given that access to the memory will be read-only.</span></span>
>
> <span data-ttu-id="c617b-174">Pour plus d’informations sur l’utilisation \_ de D3DLOCK ignore ou D3DLOCK \_ NOOVERWRITE pour le paramètre *Flags* de la méthode [**IDirect3DIndexBuffer9 :: Lock**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dindexbuffer9-lock) , consultez [optimisation des performances (Direct3D 9)](performance-optimizations.md).</span><span class="sxs-lookup"><span data-stu-id="c617b-174">For information about using D3DLOCK\_DISCARD or D3DLOCK\_NOOVERWRITE for the *Flags* parameter of the [**IDirect3DIndexBuffer9::Lock**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dindexbuffer9-lock) method, see [Performance Optimizations (Direct3D 9)](performance-optimizations.md).</span></span>

 

<span data-ttu-id="c617b-175">En C++, étant donné que vous accédez directement à la mémoire allouée pour le tampon d’index, assurez-vous que votre application accède correctement à la mémoire allouée.</span><span class="sxs-lookup"><span data-stu-id="c617b-175">In C++, because you directly access the memory allocated for the index buffer, make sure your application properly accesses the allocated memory.</span></span> <span data-ttu-id="c617b-176">Dans le cas contraire, vous risquez de rendre cette mémoire non valide.</span><span class="sxs-lookup"><span data-stu-id="c617b-176">Otherwise, you risk rendering that memory invalid.</span></span> <span data-ttu-id="c617b-177">Utilisez la valeur Stride du format d’index utilisé par votre application pour passer d’un index dans la mémoire tampon allouée à une autre.</span><span class="sxs-lookup"><span data-stu-id="c617b-177">Use the stride of the index format your application uses to move from one index in the allocated buffer to another.</span></span>

<span data-ttu-id="c617b-178">Récupérez les informations relatives à une mémoire tampon d’index en appelant la méthode [**IDirect3DIndexBuffer9 :: GetDesc**](/windows/desktop/api) .</span><span class="sxs-lookup"><span data-stu-id="c617b-178">Retrieve information about an index buffer by calling the [**IDirect3DIndexBuffer9::GetDesc**](/windows/desktop/api) method.</span></span> <span data-ttu-id="c617b-179">Cette méthode remplit les membres de la structure [**D3DINDEXBUFFER \_ desc**](d3dindexbuffer-desc.md) avec les informations relatives à la mémoire tampon d’index.</span><span class="sxs-lookup"><span data-stu-id="c617b-179">This method fills the members of the [**D3DINDEXBUFFER\_DESC**](d3dindexbuffer-desc.md) structure with information about the index buffer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c617b-180">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="c617b-180">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c617b-181">Ressources Direct3D</span><span class="sxs-lookup"><span data-stu-id="c617b-181">Direct3D Resources</span></span>](direct3d-resources.md)
</dt> <dt>

[<span data-ttu-id="c617b-182">Rendu à partir de mémoires tampons de vertex et d’index (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c617b-182">Rendering from Vertex and Index Buffers (Direct3D 9)</span></span>](rendering-from-vertex-and-index-buffers.md)
</dt> <dt>

[<span data-ttu-id="c617b-183">Mémoires tampons de vertex (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c617b-183">Vertex Buffers (Direct3D 9)</span></span>](vertex-buffers.md)
</dt> </dl>

 

 
