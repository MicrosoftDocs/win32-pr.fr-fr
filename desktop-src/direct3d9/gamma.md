---
description: Le contenu de la texture est souvent stocké au format sRGB.
ms.assetid: d076140d-3e91-412a-b099-9baa52f8d7d8
title: Gamma (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4cea4b3ba224452e1c3be8f96b7136f4e4f649c8
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "106542875"
---
# <a name="gamma-direct3d-9"></a><span data-ttu-id="39ef3-103">Gamma (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="39ef3-103">Gamma (Direct3D 9)</span></span>

<span data-ttu-id="39ef3-104">Le contenu de la texture est souvent stocké au format sRGB.</span><span class="sxs-lookup"><span data-stu-id="39ef3-104">Texture content is often stored in sRGB format.</span></span> <span data-ttu-id="39ef3-105">Traditionnellement, les pipelines de pixels supposaient que les couleurs soient linéaires afin que les opérations de fusion aient été effectuées dans l’espace linéaire.</span><span class="sxs-lookup"><span data-stu-id="39ef3-105">Traditionally, pixel pipelines assumed the colors to be linear so blending operations were performed in linear space.</span></span> <span data-ttu-id="39ef3-106">Toutefois, étant donné que le contenu sRVB est corrigé, les opérations de fusion dans l’espace linéaire produisent des résultats incorrects.</span><span class="sxs-lookup"><span data-stu-id="39ef3-106">However, since sRGB content is gamma corrected, blending operations in linear space will produce incorrect results.</span></span> <span data-ttu-id="39ef3-107">Les cartes vidéo peuvent désormais résoudre ce problème en annulant la correction gamma lors de la lecture de tout contenu sRVB, et en reconvertissant les données en pixels au format sRVB lors de l’écriture de pixels.</span><span class="sxs-lookup"><span data-stu-id="39ef3-107">Video cards can now fix this problem by undoing the gamma correction when they read any sRGB content, and convert pixel data back to the sRGB format when writing out pixels.</span></span> <span data-ttu-id="39ef3-108">Dans ce cas, toutes les opérations à l’intérieur du pipeline de pixels sont effectuées dans l’espace linéaire.</span><span class="sxs-lookup"><span data-stu-id="39ef3-108">In this case, all operations inside the pixel pipeline are performed in the linear space.</span></span>

## <a name="gamma-correction"></a><span data-ttu-id="39ef3-109">Correction gamma</span><span class="sxs-lookup"><span data-stu-id="39ef3-109">Gamma Correction</span></span>

<span data-ttu-id="39ef3-110">Direct3D 9 peut :</span><span class="sxs-lookup"><span data-stu-id="39ef3-110">Direct3D 9 can:</span></span>

-   <span data-ttu-id="39ef3-111">Indiquez si une texture est gamma 2,2 corrigé ou non (sRVB ou non).</span><span class="sxs-lookup"><span data-stu-id="39ef3-111">Indicate whether a texture is gamma 2.2 corrected or not (sRGB or not).</span></span> <span data-ttu-id="39ef3-112">Le pilote est converti en valeur gamma linéaire pour les opérations de fusion au moment de la SetTexture, ou l’échantillonneur le convertit en données linéaires au moment de la recherche.</span><span class="sxs-lookup"><span data-stu-id="39ef3-112">The driver will either convert to a linear gamma for blending operations at SetTexture time, or the sampler will convert it to linear data at lookup time.</span></span>
-   <span data-ttu-id="39ef3-113">Indiquez si le pipeline de pixels doit être corrigé de nouveau dans l’espace sRVB lors de l’écriture dans la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="39ef3-113">Indicate whether the pixel pipeline should gamma correct back to sRGB space when writing out to the render target.</span></span>

<span data-ttu-id="39ef3-114">Toutes les autres couleurs (couleur claire, couleur matérielle, couleur de vertex, etc.) sont supposées être dans l’espace linéaire.</span><span class="sxs-lookup"><span data-stu-id="39ef3-114">All other colors (clear color, material color, vertex color, etc.) are assumed to be in linear space.</span></span> <span data-ttu-id="39ef3-115">Les applications peuvent corriger la gamma des couleurs écrites dans la mémoire tampon de trame à l’aide d’instructions de nuanceur de pixels.</span><span class="sxs-lookup"><span data-stu-id="39ef3-115">Applications can gamma-correct the colors written into the frame buffer using pixel shader instructions.</span></span> <span data-ttu-id="39ef3-116">La linéarisation doit être appliquée uniquement aux canaux RVB et non au canal alpha.</span><span class="sxs-lookup"><span data-stu-id="39ef3-116">The linearization should be applied only to the RGB channels and not to the alpha channel.</span></span>

<span data-ttu-id="39ef3-117">Tous les formats de surface ne peuvent pas être linéarisés.</span><span class="sxs-lookup"><span data-stu-id="39ef3-117">Not all surface formats can be linearized.</span></span> <span data-ttu-id="39ef3-118">Seuls les formats qui passent [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) avec la \_ requête D3DUSAGE \_ SRGBREAD peuvent être linéarisés.</span><span class="sxs-lookup"><span data-stu-id="39ef3-118">Only the formats that pass [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) with D3DUSAGE\_QUERY\_SRGBREAD can be linearized.</span></span> <span data-ttu-id="39ef3-119">L’état de l’échantillonneur D3DSAMP \_ SRGBTEXTURE est ignoré pour le reste.</span><span class="sxs-lookup"><span data-stu-id="39ef3-119">The sampler state D3DSAMP\_SRGBTEXTURE is ignored for the rest.</span></span> <span data-ttu-id="39ef3-120">Seuls les formats de texture non signés sont supposés prendre en charge cette conversion.</span><span class="sxs-lookup"><span data-stu-id="39ef3-120">Only unsigned texture formats are expected to support this conversion.</span></span> <span data-ttu-id="39ef3-121">Les formats de texture non signés incluent uniquement les composants R, G, B et L.</span><span class="sxs-lookup"><span data-stu-id="39ef3-121">Unsigned texture formats include only R, G, B, and L components.</span></span> <span data-ttu-id="39ef3-122">Si le canal alpha est présent, il est ignoré.</span><span class="sxs-lookup"><span data-stu-id="39ef3-122">If the alpha channel is present, it is ignored.</span></span> <span data-ttu-id="39ef3-123">Si les formats mixtes prennent en charge la linéarisation sRVB, seuls les canaux non signés sont affectés.</span><span class="sxs-lookup"><span data-stu-id="39ef3-123">If mixed formats support sRGB linearization, only the unsigned channels are affected.</span></span> <span data-ttu-id="39ef3-124">Dans l’idéal, le matériel doit effectuer la linéarisation avant de filtrer, mais dans Direct3D 9, le matériel est autorisé à effectuer la linéarisation après le filtrage.</span><span class="sxs-lookup"><span data-stu-id="39ef3-124">Ideally, hardware should perform the linearization before filtering but in Direct3D 9, hardware is allowed to perform the linearization after filtering.</span></span>

<span data-ttu-id="39ef3-125">Tous les formats de surface ne peuvent pas être écrits dans un espace sRVB.</span><span class="sxs-lookup"><span data-stu-id="39ef3-125">Not all surface formats can be written in sRGB space.</span></span> <span data-ttu-id="39ef3-126">Seuls les formats qui passent le [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) avec l’indicateur d’utilisation D3DUSAGE de \_ requête \_ SRGBWRITE peuvent être linéarisés.</span><span class="sxs-lookup"><span data-stu-id="39ef3-126">Only the formats that pass the [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) with the usage flag D3DUSAGE\_QUERY\_SRGBWRITE can be linearized.</span></span> <span data-ttu-id="39ef3-127">L’état de rendu D3DRS \_ SRGBWRITEENABLE est ignoré pour le reste.</span><span class="sxs-lookup"><span data-stu-id="39ef3-127">The render state D3DRS\_SRGBWRITEENABLE is ignored for the rest.</span></span> <span data-ttu-id="39ef3-128">Huit bits par canal les formats RVB non signés sont censés exposer cette capacité.</span><span class="sxs-lookup"><span data-stu-id="39ef3-128">Eight bits per channel RGB unsigned formats are expected to expose this ability.</span></span>

<span data-ttu-id="39ef3-129">Dans l’idéal, le matériel doit effectuer les opérations de fusion de mémoire tampon de trame dans l’espace linéaire, mais le matériel est autorisé à l’exécuter après le nuanceur de pixels mais avant le mélangeur de mémoires tampons de trames.</span><span class="sxs-lookup"><span data-stu-id="39ef3-129">Ideally, hardware should perform the frame buffer blending operations in the linear space, but hardware is allowed to perform it after the pixel shader but before the frame buffer blender.</span></span> <span data-ttu-id="39ef3-130">Cela signifie que les opérations de fusion de mémoire tampon de trame qui ont lieu dans l’espace sRVB produiront des résultats incorrects.</span><span class="sxs-lookup"><span data-stu-id="39ef3-130">This means that the frame buffer blending operations that take place in sRGB space will produce incorrect results.</span></span> <span data-ttu-id="39ef3-131">D3DRS \_ SRGBWRITEENABLE est respecté tout en effectuant une suppression de la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="39ef3-131">D3DRS\_SRGBWRITEENABLE is honored while performing a clear of the render target.</span></span> <span data-ttu-id="39ef3-132">Pour le matériel qui prend en charge [plusieurs cibles de rendu (Direct3D 9)](multiple-render-targets.md) ou des [textures à plusieurs éléments (Direct3D 9)](multiple-element-textures.md), seule la première cible de rendu ou l’élément est écrit.</span><span class="sxs-lookup"><span data-stu-id="39ef3-132">For hardware that supports [Multiple Render Targets (Direct3D 9)](multiple-render-targets.md) or [Multiple-element Textures (Direct3D 9)](multiple-element-textures.md), only the first render target or element is written.</span></span>

### <a name="api-changes"></a><span data-ttu-id="39ef3-133">Modifications de l’API</span><span class="sxs-lookup"><span data-stu-id="39ef3-133">API Changes</span></span>


```
// New sampler state (DWORD)
// If this is nonzero, the texture is linearized on lookup.
D3DSAMP_SRGBTEXTURE       // Default FALSE

// New render state (DWORD)
D3DRS_SRGBWRITEENABLE     // Default FALSE

// New usage flags
D3DUSAGE_QUERY_SRGBWRITE
D3DUSAGE_QUERY_SRGBREAD
```



### <a name="windowed-swap-chains"></a><span data-ttu-id="39ef3-134">Chaînes de permutation avec fenêtres</span><span class="sxs-lookup"><span data-stu-id="39ef3-134">Windowed Swap Chains</span></span>

<span data-ttu-id="39ef3-135">Il est utile pour les applications de conserver les mémoires tampons d’arrière-plan de leurs chaînes de permutation dans un espace linéaire afin d’activer des opérations de fusion correctes.</span><span class="sxs-lookup"><span data-stu-id="39ef3-135">It is valuable for applications to keep the back buffers of their swap chains in linear space in order to enable correct blending operations.</span></span> <span data-ttu-id="39ef3-136">Étant donné que le bureau n’est généralement pas dans un espace linéaire, une correction gamma est nécessaire avant que le contenu de la mémoire tampon d’arrière-plan puisse être présenté.</span><span class="sxs-lookup"><span data-stu-id="39ef3-136">Since the desktop is typically not in linear space, a gamma correction is required before the contents of the back buffer can be presented.</span></span> <span data-ttu-id="39ef3-137">L’application peut appliquer cette correction en allouant une mémoire tampon supplémentaire et en effectuant sa propre copie de correction à partir de la mémoire tampon linéaire vers la mémoire tampon d’arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="39ef3-137">The application can effect this correction itself by allocating an additional buffer and performing its own correcting copy from the linear buffer to the back buffer.</span></span> <span data-ttu-id="39ef3-138">Cela nécessite une copie supplémentaire qui peut être évitée si le pilote effectue une correction gamma dans le cadre de la fusion de la présentation.</span><span class="sxs-lookup"><span data-stu-id="39ef3-138">This necessitates an extra copy which can be avoided if the driver performs gamma correction as part of the presentation blit.</span></span>

<span data-ttu-id="39ef3-139">Dans Direct3D 9, un nouvel indicateur, [D3DPRESENT \_ Linear \_ content](d3dpresent.md), est disponible [**pour permettre à la**](/windows/desktop/api) présentation de convertir implicitement l’espace linéaire en sRGB/gamma 2,2.</span><span class="sxs-lookup"><span data-stu-id="39ef3-139">In Direct3D 9 a new flag, [D3DPRESENT\_LINEAR\_CONTENT](d3dpresent.md), is available for [**Present**](/windows/desktop/api) that allows the presentation to implicitly convert from linear space to sRGB/gamma 2.2.</span></span> <span data-ttu-id="39ef3-140">Les applications doivent spécifier cet indicateur si le format de la mémoire tampon est une virgule flottante de 16 bits afin de faire correspondre le mode de fenêtrage présent au comportement gamma plein écran, à condition que la \_ Présentation D3DCAPS3 linéaire \_ à \_ sRVB \_ soit renvoyée pour les fonctionnalités d’appareil récupérées via [**GetDeviceCaps**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getdevicecaps).</span><span class="sxs-lookup"><span data-stu-id="39ef3-140">Applications should specify this flag if the backbuffer format is 16-bit floating point in order to match windowed mode present to full screen gamma behavior, provided D3DCAPS3\_LINEAR\_TO\_SRGB\_PRESENTATION is returned for device capabilities retrieved through [**GetDeviceCaps**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getdevicecaps).</span></span>

## <a name="related-topics"></a><span data-ttu-id="39ef3-141">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="39ef3-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="39ef3-142">Mémoire tampon de trame</span><span class="sxs-lookup"><span data-stu-id="39ef3-142">Frame Buffer</span></span>](frame-buffer.md)
</dt> </dl>

 

 
