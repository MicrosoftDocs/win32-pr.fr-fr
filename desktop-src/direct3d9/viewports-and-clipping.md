---
description: D’un point de vue conceptuel, une fenêtre d’affichage est un rectangle à deux dimensions (2D) dans lequel une scène 3D est projetée.
ms.assetid: eddadaa1-9181-47fa-8530-44aa46fea286
title: Viewports et découpage (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d57f64d17f7abf4e370406f984fa50037be6d44e
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104108395"
---
# <a name="viewports-and-clipping-direct3d-9"></a><span data-ttu-id="f1231-103">Viewports et découpage (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="f1231-103">Viewports and Clipping (Direct3D 9)</span></span>

<span data-ttu-id="f1231-104">D’un point de vue conceptuel, une fenêtre d’affichage est un rectangle à deux dimensions (2D) dans lequel une scène 3D est projetée.</span><span class="sxs-lookup"><span data-stu-id="f1231-104">Conceptually, a viewport is a two-dimensional (2D) rectangle into which a 3D scene is projected.</span></span> <span data-ttu-id="f1231-105">Dans Direct3D, le rectangle existe en tant que coordonnées dans une surface Direct3D que le système utilise comme cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="f1231-105">In Direct3D, the rectangle exists as coordinates within a Direct3D surface that the system uses as a rendering target.</span></span> <span data-ttu-id="f1231-106">La transformation de projection convertit les vertex dans le système de coordonnées utilisé pour la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1231-106">The projection transformation converts vertices into the coordinate system used for the viewport.</span></span> <span data-ttu-id="f1231-107">Une fenêtre d’affichage est également utilisée pour spécifier la plage de valeurs de profondeur sur une surface de cible de rendu dans laquelle une scène sera restituée (généralement 0,0 à 1,0).</span><span class="sxs-lookup"><span data-stu-id="f1231-107">A viewport is also used to specify the range of depth values on a render-target surface into which a scene will be rendered (usually 0.0 to 1.0).</span></span>

## <a name="the-viewing-frustum"></a><span data-ttu-id="f1231-108">Frustum d’affichage</span><span class="sxs-lookup"><span data-stu-id="f1231-108">The Viewing Frustum</span></span>

<span data-ttu-id="f1231-109">Un frustum de visualisation est un volume 3D dans une scène positionnée par rapport à l’appareil photo de la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1231-109">A viewing frustum is 3D volume in a scene positioned relative to the viewport's camera.</span></span> <span data-ttu-id="f1231-110">La forme du volume affecte la façon dont les modèles sont projetés à partir de l’espace de l’appareil photo sur l’écran.</span><span class="sxs-lookup"><span data-stu-id="f1231-110">The shape of the volume affects how models are projected from camera space onto the screen.</span></span> <span data-ttu-id="f1231-111">Le type de projection le plus courant, une projection en perspective, est chargé de faire en sorte que les objets proches de la caméra soient plus grands que les objets à distance.</span><span class="sxs-lookup"><span data-stu-id="f1231-111">The most common type of projection, a perspective projection, is responsible for making objects near the camera appear bigger than objects in the distance.</span></span> <span data-ttu-id="f1231-112">Pour l’affichage en perspective, les frustum d’affichage peuvent être visualisés sous forme de pyramide, avec la caméra positionnée sur le Conseil, comme indiqué dans l’illustration suivante.</span><span class="sxs-lookup"><span data-stu-id="f1231-112">For perspective viewing, the viewing frustum can be visualized as a pyramid, with the camera positioned at the tip as shown in the following illustration.</span></span> <span data-ttu-id="f1231-113">Cette pyramide est croisée par un plan de découpage avant et arrière.</span><span class="sxs-lookup"><span data-stu-id="f1231-113">This pyramid is intersected by a front and back clipping plane.</span></span> <span data-ttu-id="f1231-114">Le volume dans la pyramide entre les plans de découpage avant et arrière est le frustum d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1231-114">The volume within the pyramid between the front and back clipping planes is the viewing frustum.</span></span> <span data-ttu-id="f1231-115">Les objets sont visibles uniquement lorsqu’ils sont dans ce volume.</span><span class="sxs-lookup"><span data-stu-id="f1231-115">Objects are visible only when they are in this volume.</span></span>

![illustration d’un frustrum d’affichage avec un plan de découpage avant et arrière](images/frustum.png)

<span data-ttu-id="f1231-117">Si vous pensez que vous vous trouvez dans une pièce sombre et que vous regardez dans une fenêtre carrée, vous visualisez un frustum d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1231-117">If you imagine that you are standing in a dark room and looking through a square window, you are visualizing a viewing frustum.</span></span> <span data-ttu-id="f1231-118">Dans cette analogie, le plan de découpage proche est la fenêtre et le plan de découpage arrière est tout à fait interrompre votre vue, le Skyscraper sur la rue, les montagnes dans la distance, ou rien du tout.</span><span class="sxs-lookup"><span data-stu-id="f1231-118">In this analogy, the near clipping plane is the window, and the back clipping plane is whatever finally interrupts your view - the skyscraper across the street, the mountains in the distance, or nothing at all.</span></span> <span data-ttu-id="f1231-119">Vous pouvez voir tout ce qui se trouve à l’intérieur de la pyramide tronquée qui commence au niveau de la fenêtre et se termine avec n’importe quel élément qui interrompt votre affichage, et vous ne voyez rien d’autre.</span><span class="sxs-lookup"><span data-stu-id="f1231-119">You can see everything inside the truncated pyramid that starts at the window and ends with whatever interrupts your view, and you can see nothing else.</span></span>

<span data-ttu-id="f1231-120">Le frustum d’affichage est défini par l’angle de vue (champ de vision) et par les distances des plans de découpage avant et arrière, spécifiés en coordonnées z, comme indiqué dans le diagramme suivant.</span><span class="sxs-lookup"><span data-stu-id="f1231-120">The viewing frustum is defined by fov (field of view) and by the distances of the front and back clipping planes, specified in z-coordinates, as shown in the following diagram.</span></span>

![diagramme du frustum d’affichage](images/fovdiag.png)

<span data-ttu-id="f1231-122">Dans ce diagramme, la variable D correspond à la distance entre l’appareil photo et l’origine de l’espace qui a été défini dans la dernière partie du pipeline Geometry (transformation d’affichage).</span><span class="sxs-lookup"><span data-stu-id="f1231-122">In this diagram, the variable D is the distance from the camera to the origin of the space that was defined in the last part of the geometry pipeline - the viewing transformation.</span></span> <span data-ttu-id="f1231-123">Il s’agit de l’espace autour duquel vous organisez les limites de votre frustum d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1231-123">This is the space around which you arrange the limits of your viewing frustum.</span></span> <span data-ttu-id="f1231-124">Pour plus d’informations sur l’utilisation de cette variable D pour générer la matrice de projection, consultez [transformation de projection (Direct3D 9)](projection-transform.md) .</span><span class="sxs-lookup"><span data-stu-id="f1231-124">For information about how this D variable is used to build the projection matrix, see the [Projection Transform (Direct3D 9)](projection-transform.md)</span></span>

## <a name="viewport-rectangle"></a><span data-ttu-id="f1231-125">Rectangle de la fenêtre d’affichage</span><span class="sxs-lookup"><span data-stu-id="f1231-125">Viewport Rectangle</span></span>

<span data-ttu-id="f1231-126">Vous définissez le rectangle de la fenêtre d’affichage en C++ à l’aide de la structure [**D3DVIEWPORT9**](d3dviewport9.md) .</span><span class="sxs-lookup"><span data-stu-id="f1231-126">You define the viewport rectangle in C++ by using the [**D3DVIEWPORT9**](d3dviewport9.md) structure.</span></span> <span data-ttu-id="f1231-127">La structure D3DVIEWPORT9 est utilisée avec les méthodes de manipulation de fenêtre d’affichage suivantes exposées par l’interface IDirect3DDevice9.</span><span class="sxs-lookup"><span data-stu-id="f1231-127">The D3DVIEWPORT9 structure is used with the following viewport manipulation methods exposed by the IDirect3DDevice9 interface.</span></span>

-   [<span data-ttu-id="f1231-128">**IDirect3DDevice9::GetViewport**</span><span class="sxs-lookup"><span data-stu-id="f1231-128">**IDirect3DDevice9::GetViewport**</span></span>](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getviewport)
-   [<span data-ttu-id="f1231-129">**IDirect3DDevice9::SetViewport**</span><span class="sxs-lookup"><span data-stu-id="f1231-129">**IDirect3DDevice9::SetViewport**</span></span>](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setviewport)

<span data-ttu-id="f1231-130">La structure D3DVIEWPORT9 contient quatre membres : X, Y, largeur, hauteur, qui définissent la zone de la surface cible de rendu dans laquelle une scène sera rendue.</span><span class="sxs-lookup"><span data-stu-id="f1231-130">The D3DVIEWPORT9 structure contains four members - X, Y, Width, Height - that define the area of the render-target surface into which a scene will be rendered.</span></span> <span data-ttu-id="f1231-131">Ces valeurs correspondent au rectangle de destination ou au rectangle de la fenêtre d’affichage, comme indiqué dans le diagramme suivant.</span><span class="sxs-lookup"><span data-stu-id="f1231-131">These values correspond to the destination rectangle, or viewport rectangle, as shown in the following diagram.</span></span>

![diagramme du rectangle de la fenêtre d’affichage](images/destrect.png)

<span data-ttu-id="f1231-133">Les valeurs que vous spécifiez pour les membres X, Y, Width et Height sont des coordonnées d’écran par rapport à l’angle supérieur gauche de la surface de rendu-cible.</span><span class="sxs-lookup"><span data-stu-id="f1231-133">The values you specify for the X, Y, Width, Height members are screen coordinates relative to the upper-left corner of the render-target surface.</span></span> <span data-ttu-id="f1231-134">La structure définit deux membres supplémentaires (MinZ et MaxZ) qui indiquent les plages de profondeur dans lesquelles la scène sera restituée.</span><span class="sxs-lookup"><span data-stu-id="f1231-134">The structure defines two additional members (MinZ and MaxZ) that indicate the depth-ranges into which the scene will be rendered.</span></span>

<span data-ttu-id="f1231-135">Direct3D part du principe que le volume du découpage de la fenêtre d’affichage est compris entre-1,0 et 1,0 dans X, et de 1,0 à-1,0 dans Y. Ce sont les paramètres utilisés le plus souvent par les applications dans le passé.</span><span class="sxs-lookup"><span data-stu-id="f1231-135">Direct3D assumes that the viewport clipping volume ranges from -1.0 to 1.0 in X, and from 1.0 to -1.0 in Y. These were the settings used most often by applications in the past.</span></span> <span data-ttu-id="f1231-136">Vous pouvez ajuster les proportions de la fenêtre d’affichage avant le découpage à l’aide de la [transformation de projection](projection-transform.md).</span><span class="sxs-lookup"><span data-stu-id="f1231-136">You can adjust the viewport aspect ratio before clipping using the [projection transform](projection-transform.md).</span></span>

> [!Note]  
> <span data-ttu-id="f1231-137">MinZ et MaxZ indiquent les plages de profondeur dans lesquelles la scène sera rendue et ne sont pas utilisées pour le découpage.</span><span class="sxs-lookup"><span data-stu-id="f1231-137">MinZ and MaxZ indicate the depth-ranges into which the scene will be rendered and are not used for clipping.</span></span> <span data-ttu-id="f1231-138">La plupart des applications définissent ces membres sur 0,0 et 1,0 pour permettre au système de s’afficher sur la plage entière de valeurs de profondeur dans le tampon de profondeur.</span><span class="sxs-lookup"><span data-stu-id="f1231-138">Most applications will set these members to 0.0 and 1.0 to enable the system to render to the entire range of depth values in the depth buffer.</span></span> <span data-ttu-id="f1231-139">Dans certains cas, vous pouvez obtenir des effets spéciaux à l’aide d’autres plages de profondeur.</span><span class="sxs-lookup"><span data-stu-id="f1231-139">In some cases, you can achieve special effects by using other depth ranges.</span></span> <span data-ttu-id="f1231-140">Par exemple, pour afficher un affichage de tête dans un jeu, vous pouvez définir les deux valeurs sur 0,0 pour forcer le système à restituer les objets dans une scène au premier plan, ou vous pouvez les définir à 1,0 pour afficher un objet qui doit toujours être en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="f1231-140">For instance, to render a heads-up display in a game, you can set both values to 0.0 to force the system to render objects in a scene in the foreground, or you might set them both to 1.0 to render an object that should always be in the background.</span></span>

 

<span data-ttu-id="f1231-141">Les dimensions utilisées dans les membres X, Y, Width et Height de la structure [**D3DVIEWPORT9**](d3dviewport9.md) pour une fenêtre d’affichage définissent l’emplacement et les dimensions de la fenêtre d’affichage sur la surface de la cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="f1231-141">The dimensions used in the X, Y, Width, Height members of the [**D3DVIEWPORT9**](d3dviewport9.md) structure for a viewport define the location and dimensions of the viewport on the render-target surface.</span></span> <span data-ttu-id="f1231-142">Ces valeurs sont exprimées en coordonnées d’écran, par rapport à l’angle supérieur gauche de la surface.</span><span class="sxs-lookup"><span data-stu-id="f1231-142">These values are in screen coordinates, relative to the upper-left corner of the surface.</span></span>

<span data-ttu-id="f1231-143">Direct3D utilise l’emplacement et les dimensions de la fenêtre d’affichage pour mettre à l’échelle les vertex en fonction d’une scène rendue à l’emplacement approprié sur la surface cible.</span><span class="sxs-lookup"><span data-stu-id="f1231-143">Direct3D uses the viewport location and dimensions to scale the vertices to fit a rendered scene into the appropriate location on the target surface.</span></span> <span data-ttu-id="f1231-144">En interne, Direct3D insère ces valeurs dans la matrice suivante qui est appliquée à chaque vertex.</span><span class="sxs-lookup"><span data-stu-id="f1231-144">Internally, Direct3D inserts these values into the following matrix that is applied to each vertex.</span></span>

![équation de la matrice appliquée à chaque vertex](images/vpscale.png)

<span data-ttu-id="f1231-146">Cette matrice met à l’échelle les vertex en fonction des dimensions de la fenêtre d’affichage et de la plage de profondeur souhaitée, puis les convertit à l’emplacement approprié sur la surface cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="f1231-146">This matrix scales vertices according to the viewport dimensions and desired depth range and translates them to the appropriate location on the render-target surface.</span></span> <span data-ttu-id="f1231-147">La matrice retourne également la coordonnée y pour refléter l’origine d’un écran dans l’angle supérieur gauche avec l’incrémentation y, en descendant vers le bas.</span><span class="sxs-lookup"><span data-stu-id="f1231-147">The matrix also flips the y-coordinate to reflect a screen origin at the top-left corner with y increasing downward.</span></span> <span data-ttu-id="f1231-148">Une fois cette matrice appliquée, les vertex sont toujours homogènes, c’est-à-dire qu’ils existent toujours en tant que \[ coordonnées x, y, z et w, \] et ils doivent être convertis en coordonnées non homogènes avant d’être envoyés au rastériseur.</span><span class="sxs-lookup"><span data-stu-id="f1231-148">After this matrix is applied, vertices are still homogeneous - that is, they still exist as \[x,y,z,w\] vertices - and they must be converted to non-homogeneous coordinates before being sent to the rasterizer.</span></span>

> [!Note]  
> <span data-ttu-id="f1231-149">La matrice de mise à l’échelle de la fenêtre d’affichage incorpore les membres MinZ et MaxZ de la structure [**D3DVIEWPORT9**](d3dviewport9.md) pour mettre à l’échelle les sommets en fonction de la plage de profondeur \[ MinZ, MaxZ \] .</span><span class="sxs-lookup"><span data-stu-id="f1231-149">The viewport scaling matrix incorporates the MinZ and MaxZ members of the [**D3DVIEWPORT9**](d3dviewport9.md) structure to scale vertices to fit the depth range \[MinZ, MaxZ\].</span></span> <span data-ttu-id="f1231-150">Cela représente une sémantique différente des versions précédentes de DirectX, dans lesquelles ces membres étaient utilisés pour le découpage.</span><span class="sxs-lookup"><span data-stu-id="f1231-150">This represents different semantics from previous releases of DirectX, in which these members were used for clipping.</span></span>

 

> [!Note]  
> <span data-ttu-id="f1231-151">Les applications définissent généralement MinZ et MaxZ sur 0,0 et 1,0, respectivement, pour faire en sorte que le système soit rendu dans l’intégralité de la plage de profondeur.</span><span class="sxs-lookup"><span data-stu-id="f1231-151">Applications typically set MinZ and MaxZ to 0.0 and 1.0 respectively to cause the system to render to the entire depth range.</span></span> <span data-ttu-id="f1231-152">Toutefois, vous pouvez utiliser d’autres valeurs pour atteindre certains effets.</span><span class="sxs-lookup"><span data-stu-id="f1231-152">However, you can use other values to achieve certain affects.</span></span> <span data-ttu-id="f1231-153">Par exemple, vous pouvez définir les deux valeurs sur 0,0 pour forcer tous les objets au premier plan, ou définir à la fois sur 1,0 pour afficher tous les objets en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="f1231-153">For example, you might set both values to 0.0 to force all objects into the foreground, or set both to 1.0 to render all objects into the background.</span></span>

 

## <a name="clearing-a-viewport"></a><span data-ttu-id="f1231-154">Effacement d’une fenêtre d’affichage</span><span class="sxs-lookup"><span data-stu-id="f1231-154">Clearing a Viewport</span></span>

<span data-ttu-id="f1231-155">La désactivation de la fenêtre d’affichage permet de réinitialiser le contenu du rectangle de la fenêtre d’affichage sur la surface de rendu-cible.</span><span class="sxs-lookup"><span data-stu-id="f1231-155">Clearing the viewport resets the contents of the viewport rectangle on the render-target surface.</span></span> <span data-ttu-id="f1231-156">Il peut également effacer le rectangle dans les surfaces de la mémoire tampon de la profondeur et du stencil.</span><span class="sxs-lookup"><span data-stu-id="f1231-156">It can also clear the rectangle in the depth and stencil buffer surfaces.</span></span>

<span data-ttu-id="f1231-157">Utilisez [**IDirect3DDevice9 :: Clear**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-clear) pour effacer la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1231-157">Use [**IDirect3DDevice9::Clear**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-clear) to clear the viewport.</span></span> <span data-ttu-id="f1231-158">La méthode accepte un ou plusieurs rectangles qui définissent les zones de la surface qui sont effacées.</span><span class="sxs-lookup"><span data-stu-id="f1231-158">The method accepts one or more rectangles that define the areas on the surface being cleared.</span></span> <span data-ttu-id="f1231-159">Si vous affectez la valeur 1 au paramètre Count et le paramètre pRects à l’adresse d’un rectangle unique qui couvre l’intégralité de la zone de fenêtre d’affichage, la fenêtre d’affichage entière est effacée.</span><span class="sxs-lookup"><span data-stu-id="f1231-159">Setting the Count parameter to 1, and the pRects parameter to the address of a single rectangle that covers the entire viewport area will clear the entire viewport.</span></span> <span data-ttu-id="f1231-160">Une autre façon d’effacer l’intégralité de la fenêtre d’affichage consiste à affecter la valeur **null** au paramètre pRects et le paramètre count à la valeur 0.</span><span class="sxs-lookup"><span data-stu-id="f1231-160">Another way to clear the entire viewport is to set the pRects parameter to **NULL** and the Count parameter to 0.</span></span>

<span data-ttu-id="f1231-161">[**IDirect3DDevice9 :: Clear**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-clear) peut être utilisé pour effacer les bits de stencil dans une mémoire tampon de profondeur.</span><span class="sxs-lookup"><span data-stu-id="f1231-161">The [**IDirect3DDevice9::Clear**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-clear) can be used for clearing stencil bits within a depth buffer.</span></span> <span data-ttu-id="f1231-162">Il vous suffit de définir le paramètre Flags pour déterminer la façon dont **IDirect3DDevice9 :: Clear** fonctionne avec la cible de rendu et toute profondeur ou mémoire tampon de stencil associée.</span><span class="sxs-lookup"><span data-stu-id="f1231-162">Simply set the Flags parameter to determine how **IDirect3DDevice9::Clear** works with the render target and any associated depth or stencil buffers.</span></span> <span data-ttu-id="f1231-163">L' \_ indicateur de cible D3DCLEAR efface la fenêtre d’affichage à l’aide d’une couleur RVBA arbitraire que vous fournissez dans l’argument de couleur (il ne s’agit pas de la couleur matérielle).</span><span class="sxs-lookup"><span data-stu-id="f1231-163">The D3DCLEAR\_TARGET flag will clear the viewport using an arbitrary RGBA color that you provide in the Color argument (this is not the material color).</span></span> <span data-ttu-id="f1231-164">L' \_ indicateur D3DCLEAR ZBUFFER efface la mémoire tampon de profondeur à une profondeur arbitraire que vous spécifiez dans Z : 0,0 est la distance la plus proche, et 1,0 est la plus ancienne.</span><span class="sxs-lookup"><span data-stu-id="f1231-164">The D3DCLEAR\_ZBUFFER flag will clear the depth buffer to an arbitrary depth you specify in Z: 0.0 is the closest distance, and 1.0 is the farthest.</span></span> <span data-ttu-id="f1231-165">L' \_ indicateur de stencil D3DCLEAR réinitialise les bits du stencil à la valeur que vous fournissez dans l’argument de gabarit.</span><span class="sxs-lookup"><span data-stu-id="f1231-165">The D3DCLEAR\_STENCIL flag will reset the stencil bits to the value you provide in the Stencil argument.</span></span> <span data-ttu-id="f1231-166">Vous pouvez utiliser des entiers compris entre 0 et 2n-1, où n est le nombre de bits de la mémoire tampon du stencil.</span><span class="sxs-lookup"><span data-stu-id="f1231-166">You can use integers that range from 0 to 2n-1, where n is the stencil buffer bit depth.</span></span>

<span data-ttu-id="f1231-167">Dans certains cas, vous pouvez effectuer un rendu uniquement vers de petites parties de la cible de rendu et des surfaces de mémoire tampon de profondeur.</span><span class="sxs-lookup"><span data-stu-id="f1231-167">In some situations, you might be rendering only to small portions of the render target and depth buffer surfaces.</span></span> <span data-ttu-id="f1231-168">Les méthodes claires vous permettent également de supprimer plusieurs zones de vos surfaces en un seul appel.</span><span class="sxs-lookup"><span data-stu-id="f1231-168">The clear methods also enable you to clear multiple areas of your surfaces in a single call.</span></span> <span data-ttu-id="f1231-169">Pour ce faire, définissez le paramètre count sur le nombre de rectangles que vous souhaitez effacer et spécifiez l’adresse du premier rectangle dans un tableau de rectangles dans le paramètre pRects.</span><span class="sxs-lookup"><span data-stu-id="f1231-169">Do this by setting the Count parameter to the number of rectangles you want cleared, and specify the address of the first rectangle in an array of rectangles in the pRects parameter.</span></span>

## <a name="set-up-the-viewport-for-clipping"></a><span data-ttu-id="f1231-170">Configurer la fenêtre d’affichage pour le découpage</span><span class="sxs-lookup"><span data-stu-id="f1231-170">Set Up the Viewport for Clipping</span></span>

<span data-ttu-id="f1231-171">Les résultats de la matrice de projection déterminent le volume de découpage dans l’espace de projection comme suit :</span><span class="sxs-lookup"><span data-stu-id="f1231-171">The results of the projection matrix determine the clipping volume in projection space as:</span></span>

<span data-ttu-id="f1231-172">-w<sub>c</sub><= x<sub>c</sub><= w<sub>c</sub></span><span class="sxs-lookup"><span data-stu-id="f1231-172">-w<sub>c</sub><= x<sub>c</sub><= w<sub>c</sub></span></span>

<span data-ttu-id="f1231-173">-w<sub>c</sub><= y<sub>c</sub><= w<sub>c</sub></span><span class="sxs-lookup"><span data-stu-id="f1231-173">-w<sub>c</sub><= y<sub>c</sub><= w<sub>c</sub></span></span>

<span data-ttu-id="f1231-174">0 <= z<sub>c</sub><= w<sub>c</sub></span><span class="sxs-lookup"><span data-stu-id="f1231-174">0 <= z<sub>c</sub><= w<sub>c</sub></span></span>

<span data-ttu-id="f1231-175">Où : x, y, z et w représentent les coordonnées du vertex après l’application de la transformation de projection.</span><span class="sxs-lookup"><span data-stu-id="f1231-175">Where: x, y, z, and w represent the vertex coordinates after the projection transformation is applied.</span></span> <span data-ttu-id="f1231-176">Tous les vertex qui ont un composant x, y ou z-en dehors de ces plages sont découpés, si le découpage est activé (comportement par défaut).</span><span class="sxs-lookup"><span data-stu-id="f1231-176">Any vertices that have an x-, y-, or z-component outside these ranges are clipped, if clipping is enabled (the default behavior).</span></span>

<span data-ttu-id="f1231-177">À l’exception des mémoires tampons de vertex, les applications activent ou désactivent le découpage par le biais de l’état de rendu du [**\_ découpage D3DRS**](./d3drenderstatetype.md) .</span><span class="sxs-lookup"><span data-stu-id="f1231-177">With the exception of vertex buffers, applications enable or disable clipping by way of the [**D3DRS\_CLIPPING**](./d3drenderstatetype.md) render state.</span></span> <span data-ttu-id="f1231-178">Les informations de découpage pour les mémoires tampons de vertex sont générées au cours du traitement.</span><span class="sxs-lookup"><span data-stu-id="f1231-178">Clipping information for vertex buffers is generated during processing.</span></span> <span data-ttu-id="f1231-179">Pour plus d’informations, consultez [traitement des vertex de fonction fixe (Direct3D 9)](fixed-function-vertex-processing.md) et [traitement programmable de vertex (Direct3D 9)](programmable-vertex-processing.md).</span><span class="sxs-lookup"><span data-stu-id="f1231-179">For more information, see [Fixed Function Vertex Processing (Direct3D 9)](fixed-function-vertex-processing.md) and [Programmable Vertex Processing (Direct3D 9)](programmable-vertex-processing.md).</span></span>

<span data-ttu-id="f1231-180">Direct3D n’extrait pas les sommets transformés d’une primitive à partir d’une mémoire tampon de vertex, sauf s’il provient de [**IDirect3DDevice9 ::P rocessvertices**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices).</span><span class="sxs-lookup"><span data-stu-id="f1231-180">Direct3D does not clip transformed vertices of a primitive from a vertex buffer unless it comes from [**IDirect3DDevice9::ProcessVertices**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices).</span></span> <span data-ttu-id="f1231-181">Si vous effectuez vos propres transformations et que vous avez besoin de Direct3D pour effectuer le découpage, vous ne devez pas utiliser de mémoires tampons de vertex.</span><span class="sxs-lookup"><span data-stu-id="f1231-181">If you are doing your own transforms and need Direct3D to do the clipping, you should not use vertex buffers.</span></span> <span data-ttu-id="f1231-182">Dans ce cas, l’application parcourt les données pour la transformer.</span><span class="sxs-lookup"><span data-stu-id="f1231-182">In this case, the application traverses the data to transform it.</span></span> <span data-ttu-id="f1231-183">Direct3D parcourt les données une deuxième fois pour les découper, puis le pilote restitue les données, ce qui est inefficace.</span><span class="sxs-lookup"><span data-stu-id="f1231-183">Direct3D traverses the data a second time to clip it, and then the driver renders the data, which is inefficient.</span></span> <span data-ttu-id="f1231-184">Par conséquent, si l’application transforme les données, doit également découper les données.</span><span class="sxs-lookup"><span data-stu-id="f1231-184">So, if the application transforms the data, is should also clip the data.</span></span>

<span data-ttu-id="f1231-185">Lorsque l’appareil reçoit des sommets prétransformés et allumés (sommets T&L) qui doivent être découpés, pour effectuer l’opération de découpage, les vertex sont transformés dans l’espace de découpage à l’aide de l’espace homogène réciproque du vertex (RHW) et des informations de la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1231-185">When the device receives pre-transformed and lit vertices (T&L vertices) that need to be clipped, in order to perform the clipping operation the vertices are back-transformed to the clipping space using the vertex's reciprocal homogeneous w (RHW) and the viewport information.</span></span> <span data-ttu-id="f1231-186">Le découpage est ensuite effectué.</span><span class="sxs-lookup"><span data-stu-id="f1231-186">Clipping is then performed.</span></span> <span data-ttu-id="f1231-187">Tous les appareils ne sont pas en charge de l’exécution de cette transformation en arrière afin de découper les sommets T&L.</span><span class="sxs-lookup"><span data-stu-id="f1231-187">Not all devices are capable of performing this back-transform in order to clip T&L vertices.</span></span>

<span data-ttu-id="f1231-188">La \_ fonctionnalité de l’appareil D3DPMISCCAPS CLIPTLVERTS indique si l’appareil est capable de découper les vertex T&L.</span><span class="sxs-lookup"><span data-stu-id="f1231-188">The D3DPMISCCAPS\_CLIPTLVERTS device capability indicates whether the device is capable of clipping T&L vertices.</span></span> <span data-ttu-id="f1231-189">Si cette fonctionnalité n’est pas définie, l’application est chargée de découper les sommets T&L qu’elle envisage d’envoyer à l’appareil pour qu’elle soit rendue.</span><span class="sxs-lookup"><span data-stu-id="f1231-189">If this capability is not set, the application is responsible for clipping the T&L vertices that it intends to send down to the device to be rendered.</span></span> <span data-ttu-id="f1231-190">L’appareil est toujours en capacité de découper les vertex T&L dans le mode de traitement du vertex logiciel (que l’appareil soit créé dans le mode de traitement du vertex logiciel ou basculé vers le mode de traitement du vertex logiciel).</span><span class="sxs-lookup"><span data-stu-id="f1231-190">The device is always capable of clipping T&L vertices in the software vertex processing mode (regardless of whether the device is created in the software vertex processing mode, or switched to the software vertex processing mode).</span></span>

<span data-ttu-id="f1231-191">La seule exigence pour configurer les paramètres de la fenêtre d’affichage pour un appareil de rendu consiste à définir le volume de découpage de la fenêtre d’affichage.</span><span class="sxs-lookup"><span data-stu-id="f1231-191">The only requirement for configuring the viewport parameters for a rendering device is to set the viewport's clipping volume.</span></span> <span data-ttu-id="f1231-192">Pour ce faire, vous devez initialiser et définir des valeurs de découpage pour le volume de découpage et pour la surface de cible de rendu.</span><span class="sxs-lookup"><span data-stu-id="f1231-192">To do this, you initialize and set clipping values for the clipping volume and for the render-target surface.</span></span> <span data-ttu-id="f1231-193">Les fenêtres d’affichage sont généralement configurées pour être rendues dans la zone complète de la surface de la cible de rendu, mais ce n’est pas une exigence.</span><span class="sxs-lookup"><span data-stu-id="f1231-193">Viewports are commonly set up to render to the full area of the render-target surface, but this isn't a requirement.</span></span>

<span data-ttu-id="f1231-194">Vous pouvez utiliser les paramètres suivants pour les membres de la structure [**D3DVIEWPORT9**](d3dviewport9.md) pour y parvenir en C++.</span><span class="sxs-lookup"><span data-stu-id="f1231-194">You can use the following settings for the members of the [**D3DVIEWPORT9**](d3dviewport9.md) structure to achieve this in C++.</span></span>


```
D3DVIEWPORT9 viewData = { 0, 0, width, height, 0.0f, 1.0f };
```



<span data-ttu-id="f1231-195">Après avoir défini les valeurs dans la structure [**D3DVIEWPORT9**](d3dviewport9.md) , appliquez les paramètres de la fenêtre d’affichage à l’appareil en appelant sa méthode [**IDirect3DDevice9 :: SetViewport**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setviewport) .</span><span class="sxs-lookup"><span data-stu-id="f1231-195">After setting values in the [**D3DVIEWPORT9**](d3dviewport9.md) structure, apply the viewport parameters to the device by calling its [**IDirect3DDevice9::SetViewport**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setviewport) method.</span></span> <span data-ttu-id="f1231-196">L’exemple de code suivant illustre ce à quoi peut ressembler cet appel.</span><span class="sxs-lookup"><span data-stu-id="f1231-196">The following code example shows what this call might look like.</span></span>


```
HRESULT hr;

hr = pd3dDevice->SetViewport(&viewData);
if(FAILED(hr))
    return hr;
```



<span data-ttu-id="f1231-197">Si l’appel s’effectue correctement, les paramètres de la fenêtre d’affichage sont définis et prendront effet lors de l’appel de la méthode de rendu suivante.</span><span class="sxs-lookup"><span data-stu-id="f1231-197">If the call succeeds, the viewport parameters are set and will take effect the next time a rendering method is called.</span></span> <span data-ttu-id="f1231-198">Pour apporter des modifications aux paramètres de la fenêtre d’affichage, il vous suffit de mettre à jour les valeurs de la structure [**D3DVIEWPORT9**](d3dviewport9.md) et d’appeler à nouveau [**IDirect3DDevice9 :: SetViewport**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setviewport) .</span><span class="sxs-lookup"><span data-stu-id="f1231-198">To make changes to the viewport parameters, just update the values in the [**D3DVIEWPORT9**](d3dviewport9.md) structure and call [**IDirect3DDevice9::SetViewport**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setviewport) again.</span></span>

> [!Note]  
> <span data-ttu-id="f1231-199">Les membres de la structure [**D3DVIEWPORT9**](d3dviewport9.md) minz et MaxZ indiquent les plages de profondeur dans lesquelles la scène sera rendue et ne sont pas utilisées pour le découpage.</span><span class="sxs-lookup"><span data-stu-id="f1231-199">The [**D3DVIEWPORT9**](d3dviewport9.md) structure members MinZ and MaxZ indicate the depth-ranges into which the scene will be rendered and are not used for clipping.</span></span> <span data-ttu-id="f1231-200">La plupart des applications définissent ces membres sur 0,0 et 1,0 pour permettre au système de s’afficher dans l’intégralité de la plage de valeurs de profondeur dans le tampon de profondeur.</span><span class="sxs-lookup"><span data-stu-id="f1231-200">Most applications set these members to 0.0 and 1.0 to enable the system to render to the entire range of depth values in the depth buffer.</span></span> <span data-ttu-id="f1231-201">Dans certains cas, vous pouvez obtenir des effets spéciaux à l’aide d’autres plages de profondeur.</span><span class="sxs-lookup"><span data-stu-id="f1231-201">In some cases, you can achieve special effects by using other depth ranges.</span></span> <span data-ttu-id="f1231-202">Par exemple, pour afficher un affichage de tête dans un jeu, vous pouvez définir les deux valeurs sur 0,0 pour forcer le système à restituer les objets dans une scène au premier plan, ou vous pouvez les définir à 1,0 pour afficher un objet qui doit toujours être en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="f1231-202">For instance, to render a heads-up display in a game, you can set both values to 0.0 to force the system to render objects in a scene in the foreground, or you might set them both to 1.0 to render an object that should always be in the background.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="f1231-203">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="f1231-203">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f1231-204">Prise en main</span><span class="sxs-lookup"><span data-stu-id="f1231-204">Getting Started</span></span>](getting-started.md)
</dt> </dl>

 

 
