---
description: Les applications ne sont pas tenues d’utiliser le filtrage de texture.
ms.assetid: bba0e485-ac5a-4e43-9eb7-25cd0c90d316
title: Échantillonnage de Nearest-Point (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b11cf98ee917b124b35f3c30ff263365ec3c46e1
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104392588"
---
# <a name="nearest-point-sampling-direct3d-9"></a><span data-ttu-id="44352-103">Échantillonnage de Nearest-Point (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="44352-103">Nearest-Point Sampling (Direct3D 9)</span></span>

<span data-ttu-id="44352-104">Les applications ne sont pas tenues d’utiliser le filtrage de texture.</span><span class="sxs-lookup"><span data-stu-id="44352-104">Applications are not required to use texture filtering.</span></span> <span data-ttu-id="44352-105">Direct3D peut être défini de manière à ce qu’il calcule l’adresse Texel, qui ne correspond souvent pas à des entiers, et copie la couleur de l’Texel avec l’adresse entière la plus proche.</span><span class="sxs-lookup"><span data-stu-id="44352-105">Direct3D can be set so that it computes the texel address, which often does not evaluate to integers, and copies the color of the texel with the closest integer address.</span></span> <span data-ttu-id="44352-106">Ce processus est appelé échantillonnage à point le plus proche.</span><span class="sxs-lookup"><span data-stu-id="44352-106">This process is called nearest-point sampling.</span></span> <span data-ttu-id="44352-107">Il peut s’agir d’une méthode rapide et efficace pour traiter les textures si la taille de la texture est similaire à la taille de l’image de la primitive sur l’écran.</span><span class="sxs-lookup"><span data-stu-id="44352-107">This can be a fast and efficient way to process textures if the size of the texture is similar to the size of the primitive's image on the screen.</span></span> <span data-ttu-id="44352-108">Si ce n’est pas le cas, la texture doit être agrandie ou minimisés.</span><span class="sxs-lookup"><span data-stu-id="44352-108">If not, the texture must be magnified or minified.</span></span> <span data-ttu-id="44352-109">Le résultat peut être une image groupée, avec alias ou flou.</span><span class="sxs-lookup"><span data-stu-id="44352-109">The result can be a chunky, aliased, or blurred image.</span></span>

<span data-ttu-id="44352-110">Votre application C++ peut sélectionner l’échantillonnage à point le plus proche en appelant la méthode [**IDirect3DDevice9 :: SetSamplerState**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setsamplerstate) .</span><span class="sxs-lookup"><span data-stu-id="44352-110">Your C++ application can select nearest-point sampling by calling the [**IDirect3DDevice9::SetSamplerState**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setsamplerstate) method.</span></span> <span data-ttu-id="44352-111">Définissez la valeur du premier paramètre sur le numéro d’index entier (0-7) de la texture pour laquelle vous sélectionnez une méthode de filtrage de texture.</span><span class="sxs-lookup"><span data-stu-id="44352-111">Set the value of the first parameter to the integer index number (0-7) of the texture for which you are selecting a texture filtering method.</span></span> <span data-ttu-id="44352-112">Transmettez D3DSAMP \_ MAGFILTER, D3DSAMP \_ MINFILTER ou D3DSAMP \_ MIPFILTER pour le deuxième paramètre afin de définir le filtre d’agrandissement, de minimisation ou de mappage MIP.</span><span class="sxs-lookup"><span data-stu-id="44352-112">Pass D3DSAMP\_MAGFILTER, D3DSAMP\_MINFILTER, or D3DSAMP\_MIPFILTER for the second parameter to set the magnification, minification, or mipmapping filter.</span></span> <span data-ttu-id="44352-113">Transmettez \_ le point D3DTEXF dans le troisième paramètre.</span><span class="sxs-lookup"><span data-stu-id="44352-113">Pass D3DTEXF\_POINT in the third parameter.</span></span>

<span data-ttu-id="44352-114">Vous devez utiliser l’échantillonnage à point le plus proche avec précaution, car il peut parfois provoquer des artefacts graphiques lorsque la texture est échantillonnée à la limite entre deux texels.</span><span class="sxs-lookup"><span data-stu-id="44352-114">You should use nearest-point sampling carefully, because it can sometimes cause graphic artifacts when the texture is sampled at the boundary between two texels.</span></span> <span data-ttu-id="44352-115">Cette limite est la position le long de la texture (u ou v) à partir de laquelle le Texel échantillonné passe d’un Texel au suivant.</span><span class="sxs-lookup"><span data-stu-id="44352-115">This boundary is the position along the texture (u or v) at which the sampled texel transitions from one texel to the next.</span></span> <span data-ttu-id="44352-116">Lorsque l’échantillonnage de point est utilisé, le système choisit un exemple de Texel ou l’autre, et le résultat peut changer brusquement d’une Texel à la Texel suivante lorsque la limite est franchie.</span><span class="sxs-lookup"><span data-stu-id="44352-116">When point sampling is used, the system chooses one sample texel or the other, and the result can change abruptly from one texel to the next texel as the boundary is crossed.</span></span> <span data-ttu-id="44352-117">Cet effet peut apparaître sous la forme d’artefacts graphiques indésirables dans la texture affichée.</span><span class="sxs-lookup"><span data-stu-id="44352-117">This effect can appear as undesired graphic artifacts in the displayed texture.</span></span> <span data-ttu-id="44352-118">Lorsque le filtrage linéaire est utilisé, le Texel qui en résulte est calculé à partir des texels contigus et est lissé en douceur entre eux lorsque l’index de texture se déplace dans la limite.</span><span class="sxs-lookup"><span data-stu-id="44352-118">When linear filtering is used, the resulting texel is computed from both adjacent texels and smoothly blends between them as the texture index moves through the boundary.</span></span>

<span data-ttu-id="44352-119">Cet effet peut être observé lors du mappage d’une très petite texture sur un polygone de très grande taille : une opération souvent appelée grossissement.</span><span class="sxs-lookup"><span data-stu-id="44352-119">This effect can be seen when mapping a very small texture onto a very large polygon: an operation often called magnification.</span></span> <span data-ttu-id="44352-120">Par exemple, lorsque vous utilisez une texture qui ressemble à un damier, l’échantillonnage à point le plus proche se traduit par un damier plus large qui affiche des bords distincts.</span><span class="sxs-lookup"><span data-stu-id="44352-120">For example, when using a texture that looks like a checkerboard, nearest-point sampling results in a larger checkerboard that shows distinct edges.</span></span> <span data-ttu-id="44352-121">En revanche, le filtrage de texture linéaire génère une image où les couleurs des damiers varient harmonieusement sur le polygone.</span><span class="sxs-lookup"><span data-stu-id="44352-121">By contrast, linear texture filtering results in an image where the checkerboard colors vary smoothly across the polygon.</span></span>

<span data-ttu-id="44352-122">Dans la plupart des cas, les applications reçoivent les meilleurs résultats en évitant les échantillons les plus proches chaque fois que cela est possible.</span><span class="sxs-lookup"><span data-stu-id="44352-122">In most cases, applications receive the best results by avoiding nearest-point sample wherever possible.</span></span> <span data-ttu-id="44352-123">La majorité du matériel aujourd’hui étant optimisé pour le filtrage linéaire, votre application ne doit pas avoir de dégradation des performances.</span><span class="sxs-lookup"><span data-stu-id="44352-123">The majority of hardware today is optimized for linear filtering, so your application should not suffer degraded performance.</span></span> <span data-ttu-id="44352-124">Si l’effet souhaité requiert l’utilisation de l’échantillonnage à point le plus proche (par exemple, lors de l’utilisation de textures pour afficher des caractères de texte lisibles), votre application doit être extrêmement prudente pour éviter l’échantillonnage aux limites de Texel, ce qui peut entraîner des effets indésirables.</span><span class="sxs-lookup"><span data-stu-id="44352-124">If the effect you desire absolutely requires the use of the nearest-point sampling - such as when using textures to display readable text characters - then your application should be extremely careful to avoid sampling at the texel boundaries, which might result in undesired effects.</span></span> <span data-ttu-id="44352-125">L’illustration suivante montre à quoi ces artefacts peuvent ressembler.</span><span class="sxs-lookup"><span data-stu-id="44352-125">The following illustration shows what these artifacts can look like.</span></span>

![illustration d’une zone à six sections avec lignes horizontales non continues dans les deux carrés en haut à droite](images/ptrtfct.png)

<span data-ttu-id="44352-127">Notez que les deux carrés situés en haut à droite du groupe apparaissent différemment de leurs voisins, avec des décalages en diagonale.</span><span class="sxs-lookup"><span data-stu-id="44352-127">Notice that the two squares in the upper right of the group appear different than their neighbors, with diagonal offsets running through them.</span></span> <span data-ttu-id="44352-128">Pour éviter les artefacts graphiques comme ceux-ci, vous devez vous familiariser avec les règles d’échantillonnage de texture Direct3D pour le filtrage à point le plus proche.</span><span class="sxs-lookup"><span data-stu-id="44352-128">To avoid graphic artifacts like these, you must be familiar with Direct3D texture sampling rules for nearest-point filtering.</span></span> <span data-ttu-id="44352-129">Direct3D mappe une coordonnée de texture à virgule flottante allant de \[ 0,0 1,0 \] (0,0 à 1,0, inclusivement) à une valeur d’espace de Texel d’entier comprise entre \[ -0,5, n-0,5 \] , où n est le nombre de texels dans une dimension donnée sur la texture.</span><span class="sxs-lookup"><span data-stu-id="44352-129">Direct3D maps a floating-point texture coordinate ranging from \[0.0, 1.0\] (0.0 to 1.0, inclusive) to an integer texel space value ranging from \[ - 0.5, n - 0.5\], where n is the number of texels in a given dimension on the texture.</span></span> <span data-ttu-id="44352-130">L’index de texture résultant est arrondi à l’entier le plus proche.</span><span class="sxs-lookup"><span data-stu-id="44352-130">The resulting texture index is rounded to the nearest integer.</span></span> <span data-ttu-id="44352-131">Ce mappage peut introduire des imprécisions d’échantillonnage au niveau des limites de Texel.</span><span class="sxs-lookup"><span data-stu-id="44352-131">This mapping can introduce sampling inaccuracies at texel boundaries.</span></span>

<span data-ttu-id="44352-132">Pour obtenir un exemple simple, Imaginez une application qui restitue des polygones avec le mode d’adressage de texture de retour à la \_ ligne D3DTADDRESS.</span><span class="sxs-lookup"><span data-stu-id="44352-132">For a simple example, imagine an application that renders polygons with the D3DTADDRESS\_WRAP texture addressing mode.</span></span> <span data-ttu-id="44352-133">À l’aide du mappage utilisé par Direct3D, l’index de texture u est mappé comme indiqué dans le diagramme suivant pour une texture avec une largeur de 4 texels.</span><span class="sxs-lookup"><span data-stu-id="44352-133">Using the mapping employed by Direct3D, the u texture index maps as show in the following diagram for a texture with a width of 4 texels.</span></span>

![diagramme des coordonnées de texture 0,0 et 1,0 à la limite entre les texels](images/ptsmpprb.png)

<span data-ttu-id="44352-135">Notez que les coordonnées de texture, 0,0 et 1,0 pour cette illustration, sont exactement à la limite entre les texels.</span><span class="sxs-lookup"><span data-stu-id="44352-135">Notice that the texture coordinates, 0.0 and 1.0 for this illustration, are exactly at the boundary between texels.</span></span> <span data-ttu-id="44352-136">À l’aide de la méthode par laquelle Direct3D mappe les valeurs, les coordonnées de texture sont comprises entre \[ -0,5, 4-0,5 \] , où 4 représente la largeur de la texture.</span><span class="sxs-lookup"><span data-stu-id="44352-136">Using the method by which Direct3D maps values, the texture coordinates range from \[ - 0.5, 4 - 0.5\], where 4 is the width of the texture.</span></span> <span data-ttu-id="44352-137">Dans ce cas, le Texel échantillonné est le Texel 0 pour un index de texture de 1,0.</span><span class="sxs-lookup"><span data-stu-id="44352-137">For this case, the sampled texel is the 0 texel for a texture index of 1.0.</span></span> <span data-ttu-id="44352-138">Toutefois, si la coordonnée de texture était légèrement inférieure à 1,0, le Texel échantillonné est le Texel n plutôt que le Texel 0.</span><span class="sxs-lookup"><span data-stu-id="44352-138">However, if the texture coordinate was only slightly less than 1.0, the sampled texel would be the n texel instead of the 0 texel.</span></span>

<span data-ttu-id="44352-139">En effet, l’agrandissement d’une petite texture à l’aide des coordonnées de texture de 0,0 et 1,0 exactement avec le filtrage à point le plus proche sur un triangle aligné sur l’espace à l’écran se traduit par des pixels pour lesquels la carte de texture est échantillonnée à la limite entre les texels.</span><span class="sxs-lookup"><span data-stu-id="44352-139">The implication of this is that magnifying a small texture using texture coordinates of exactly 0.0 and 1.0 with nearest-point filtering on a screen-space aligned triangle results in pixels for which the texture map is sampled at the boundary between texels.</span></span> <span data-ttu-id="44352-140">Toutes les inexactitudes dans le calcul des coordonnées de texture, mais peu volumineuses, entraînent des artefacts le long des zones de l’image rendue qui correspondent aux bords de Texel de la carte de texture.</span><span class="sxs-lookup"><span data-stu-id="44352-140">Any inaccuracies in the computation of texture coordinates, however small, results in artifacts along the areas in the rendered image which correspond to the texel edges of the texture map.</span></span>

<span data-ttu-id="44352-141">L’exécution de ce mappage de coordonnées de texture à virgule flottante à des texels d’entiers avec une précision parfaite est difficile, fastidieuse en termes de temps de calcul et n’est généralement pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="44352-141">Performing this mapping of floating point texture coordinates to integer texels with perfect accuracy is difficult, computationally time-consuming, and generally not necessary.</span></span> <span data-ttu-id="44352-142">La plupart des implémentations matérielles utilisent une approche itérative pour le calcul des coordonnées de texture à chaque emplacement de pixel au sein d’un triangle.</span><span class="sxs-lookup"><span data-stu-id="44352-142">Most hardware implementations use an iterative approach for computing texture coordinates at each pixel location within a triangle.</span></span> <span data-ttu-id="44352-143">Les approches itératives ont tendance à masquer ces imprécisions, car les erreurs sont accumulées uniformément pendant l’itération.</span><span class="sxs-lookup"><span data-stu-id="44352-143">Iterative approaches tend to hide these inaccuracies because the errors are accumulated evenly during iteration.</span></span>

<span data-ttu-id="44352-144">Le rastériseur de référence Direct3D utilise une approche d’évaluation directe pour calculer les index de texture à chaque emplacement de pixel.</span><span class="sxs-lookup"><span data-stu-id="44352-144">The Direct3D reference rasterizer uses a direct-evaluation approach for computing texture indexes at each pixel location.</span></span> <span data-ttu-id="44352-145">L’évaluation directe diffère de l’approche itérative dans le cas où toute inexactitude dans l’opération présente une distribution d’erreurs plus aléatoire.</span><span class="sxs-lookup"><span data-stu-id="44352-145">Direct evaluation differs from the iterative approach in that any inaccuracy in the operation exhibits a more random error distribution.</span></span> <span data-ttu-id="44352-146">Cela est dû au fait que les erreurs d’échantillonnage qui se produisent au niveau des limites peuvent être plus perceptibles, car le rastériseur de référence n’effectue pas cette opération avec une précision parfaite.</span><span class="sxs-lookup"><span data-stu-id="44352-146">The result of this is that the sampling errors that occur at the boundaries can be more noticeable because the reference rasterizer does not perform this operation with perfect accuracy.</span></span>

<span data-ttu-id="44352-147">La meilleure approche consiste à utiliser le filtrage de point le plus proche uniquement lorsque cela est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="44352-147">The best approach is to use nearest-point filtering only when necessary.</span></span> <span data-ttu-id="44352-148">Quand vous devez l’utiliser, il est recommandé de décaler légèrement les coordonnées de texture à partir des positions de limite pour éviter les artefacts.</span><span class="sxs-lookup"><span data-stu-id="44352-148">When you must use it, it is recommended that you offset texture coordinates slightly from the boundary positions to avoid artifacts.</span></span>

## <a name="related-topics"></a><span data-ttu-id="44352-149">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="44352-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="44352-150">Filtrage de texture</span><span class="sxs-lookup"><span data-stu-id="44352-150">Texture Filtering</span></span>](texture-filtering.md)
</dt> </dl>

 

 
