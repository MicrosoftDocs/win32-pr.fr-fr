---
description: Cette documentation fait spécifiquement référence aux extensions Windows Vista pour DirectX Graphics.
ms.assetid: 3cc0b08c-e126-4f1b-b5d1-0d6c1ebeb0c5
title: Résumé des fonctionnalités (Direct3D 9 pour Windows Vista)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3d5cf2447297b7f24edf7d0200e640d5aef90bff
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "106536941"
---
# <a name="feature-summary-direct3d-9-for-windows-vista"></a><span data-ttu-id="c0aa5-103">Résumé des fonctionnalités (Direct3D 9 pour Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="c0aa5-103">Feature Summary (Direct3D 9 for Windows Vista)</span></span>

<span data-ttu-id="c0aa5-104">Cette documentation fait spécifiquement référence aux extensions Windows Vista pour DirectX Graphics.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-104">This documentation specifically refers to the Windows Vista extensions for DirectX graphics.</span></span> <span data-ttu-id="c0aa5-105">Pour développer la puissance de DirectX pour Windows Vista, vous devez installer le kit de développement logiciel (SDK) Windows Vista, ainsi que le kit de développement logiciel (SDK) DirectX.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-105">To develop the power of DirectX for Windows Vista, you must install the Windows Vista SDK as well as the DirectX SDK.</span></span> <span data-ttu-id="c0aa5-106">Les applications utilisant DirectX pour Windows Vista doivent utiliser un matériel qui utilise le pilote WDDM (modèle de pilote de périphérique Windows) au lieu de XPDM (modèle de pilote XP). les pilotes qui n’implémentent pas le WDDM ne peuvent pas instancier les interfaces Windows Vista DirectX Graphics.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-106">Applications using DirectX for Windows Vista must be using hardware that uses the WDDM driver (Windows Device Driver Model) as opposed to the XPDM (XP Driver Model); drivers that do not implement the WDDM cannot instantiate Windows Vista DirectX graphics interfaces.</span></span>

<span data-ttu-id="c0aa5-107">Découvrez les nouvelles fonctionnalités DirectX Graphics de Windows Vista dans l’une des sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-107">Discover the new DirectX graphics features in Windows Vista in one of these sections:</span></span>

-   [<span data-ttu-id="c0aa5-108">Changements de comportement des appareils</span><span class="sxs-lookup"><span data-stu-id="c0aa5-108">Device Behavior Changes</span></span>](#device-behavior-changes)
-   [<span data-ttu-id="c0aa5-109">Désactivation du traitement des vertex logiciels multithread</span><span class="sxs-lookup"><span data-stu-id="c0aa5-109">Disabling Multithreaded Software Vertex Processing</span></span>](#disabling-multithreaded-software-vertex-processing)
-   [<span data-ttu-id="c0aa5-110">Surfaces d’un bit</span><span class="sxs-lookup"><span data-stu-id="c0aa5-110">One Bit Surfaces</span></span>](#one-bit-surfaces)
-   [<span data-ttu-id="c0aa5-111">Lecture des mémoires tampons de profondeur/stencil</span><span class="sxs-lookup"><span data-stu-id="c0aa5-111">Reading Depth/Stencil Buffers</span></span>](#reading-depthstencil-buffers)
-   [<span data-ttu-id="c0aa5-112">Partager des ressources</span><span class="sxs-lookup"><span data-stu-id="c0aa5-112">Sharing Resources</span></span>](#sharing-resources)
-   [<span data-ttu-id="c0aa5-113">Conversion sRVB avant la fusion</span><span class="sxs-lookup"><span data-stu-id="c0aa5-113">sRGB Conversion Before Blending</span></span>](#srgb-conversion-before-blending)
-   [<span data-ttu-id="c0aa5-114">Améliorations apportées à StretchRect</span><span class="sxs-lookup"><span data-stu-id="c0aa5-114">StretchRect Improvements</span></span>](#stretchrect-improvements)
-   [<span data-ttu-id="c0aa5-115">Création de texture dans la mémoire système</span><span class="sxs-lookup"><span data-stu-id="c0aa5-115">Texture Creation in System Memory</span></span>](#texture-creation-in-system-memory)

## <a name="device-behavior-changes"></a><span data-ttu-id="c0aa5-116">Changements de comportement des appareils</span><span class="sxs-lookup"><span data-stu-id="c0aa5-116">Device Behavior Changes</span></span>

<span data-ttu-id="c0aa5-117">Les appareils ne sont à présent perdus que dans deux cas. Lorsque le matériel est réinitialisé parce qu’il est bloqué et lorsque le pilote de périphérique est arrêté.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-117">Devices are now only lost under two circumstances; when the hardware is reset because it is hanging, and when the device driver is stopped.</span></span> <span data-ttu-id="c0aa5-118">Lorsque le matériel se bloque, l’appareil peut être réinitialisé en appelant [**ResetEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-resetex).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-118">When hardware hangs, the device can be reset by calling [**ResetEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-resetex).</span></span> <span data-ttu-id="c0aa5-119">Si le matériel se bloque, la mémoire de texture est perdue.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-119">If hardware hangs, texture memory is lost.</span></span>

<span data-ttu-id="c0aa5-120">Après l’arrêt d’un pilote, l’objet IDirect9Ex doit être recréé pour reprendre le rendu.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-120">After a driver is stopped, the IDirect9Ex object must be recreated to resume rendering.</span></span>

<span data-ttu-id="c0aa5-121">Lorsque la zone de présentation est masquée par une autre fenêtre en mode fenêtre, ou lorsqu’une application en plein écran est réduite, [**PresentEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-presentex) retourne S \_ D3DPRESENTATIONOCCLUDED.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-121">When the presentation area is obscured by another window in windowed mode, or when a fullscreen application is minimized, [**PresentEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-presentex) will return S\_D3DPRESENTATIONOCCLUDED.</span></span> <span data-ttu-id="c0aa5-122">Les applications plein écran peuvent reprendre le rendu lorsqu’elles reçoivent un message de rappel [**WM \_ ACTIVATEAPP**](../winmsg/wm-activateapp.md) .</span><span class="sxs-lookup"><span data-stu-id="c0aa5-122">Full screen applications can resume rendering when they receive a [**WM\_ACTIVATEAPP**](../winmsg/wm-activateapp.md) callback message.</span></span>

<span data-ttu-id="c0aa5-123">Dans les versions précédentes de DirectX, quand une application rencontrait une modification de mode, la seule façon de récupérer était de réinitialiser l’appareil et de recréer toutes les ressources de mémoire vidéo et les chaînes de permutation.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-123">In previous versions of DirectX, when an application experienced a mode change, the only way to recover was to reset the device and re-create all video memory resources and swap chains.</span></span> <span data-ttu-id="c0aa5-124">Désormais, avec DirectX pour Windows Vista, l’appel de Reset après une modification de mode n’entraîne pas la perte des surfaces de mémoire de texture, des textures et des informations d’État, et ces ressources n’ont pas besoin d’être recréées.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-124">Now with DirectX for Windows Vista, calling Reset after a mode change does not cause texture memory surfaces, textures and state information to be lost and these resources do not need to be recreated.</span></span>

## <a name="disabling-multithreaded-software-vertex-processing"></a><span data-ttu-id="c0aa5-125">Désactivation du traitement des vertex logiciels multithread</span><span class="sxs-lookup"><span data-stu-id="c0aa5-125">Disabling Multithreaded Software Vertex Processing</span></span>

<span data-ttu-id="c0aa5-126">Un nouveau bit de majuscules (D3DCREATE \_ désactiver \_ PSGP \_ Threading) a été ajouté pour désactiver le multithreading pour le traitement des vertex logiciels (swvp).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-126">A new caps bit (D3DCREATE\_DISABLE\_PSGP\_THREADING) has been added that will disable multithreading for software vertex processing (swvp).</span></span> <span data-ttu-id="c0aa5-127">Utilisez cette macro pour générer un indicateur de comportement pour IDirect3D9 :: CreateDevice.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-127">Use this macro to generate a behavior flag for IDirect3D9::CreateDevice.</span></span>


```
#define D3DCREATE_DISABLE_PSGP_THREADING
```



## <a name="one-bit-surfaces"></a><span data-ttu-id="c0aa5-128">Surfaces d’un bit</span><span class="sxs-lookup"><span data-stu-id="c0aa5-128">One Bit Surfaces</span></span>

<span data-ttu-id="c0aa5-129">Il existe un nouveau type de format de surface binaire qui peut s’avérer particulièrement utile pour le traitement des glyphes de texte.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-129">There is a new one bit surface format type which can be especially useful for processing text glyphs.</span></span> <span data-ttu-id="c0aa5-130">Le nouveau format est appelé D3DFMT \_ a1.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-130">The new format is called D3DFMT\_A1.</span></span> <span data-ttu-id="c0aa5-131">Une surface à un bit est conçue pour être utilisée comme une texture par pixel ou pour la sortie de la cible de rendu générée par ComposeRects ou ColorFill.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-131">A one-bit surface is designed to be either used as a per-pixel texture, or the render target output generated by ComposeRects or ColorFill.</span></span> <span data-ttu-id="c0aa5-132">Il n’y a pas d’épaisseur distincte pour la largeur et la hauteur de la surface ; une implémentation doit prendre en charge une surface de taille unique qui est de 2 000 texels x 8 Ko.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-132">There are no separate caps for the surface width and height; an implementation must support a single size surface that is 2K texels x 8K texels.</span></span>

<span data-ttu-id="c0aa5-133">Une surface à un bit a un bit par Texel. par conséquent, une unité signifie que tous les composants (r, g, b, a) d’un pixel sont 1, et zéro signifie que tous les composants sont égaux à 0.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-133">A one-bit surface has one bit per texel; therefore, a one would mean that all components (r,g,b,a) of a pixel are 1, and zero would mean that all components are equal to 0.</span></span> <span data-ttu-id="c0aa5-134">Vous pouvez utiliser des surfaces d’un bit avec les API suivantes : ColorFill, UpdateSurface et UpdateTexture.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-134">You may use one-bit surfaces with the following APIs: ColorFill, UpdateSurface and UpdateTexture.</span></span>

<span data-ttu-id="c0aa5-135">Quand une surface à un bit est lue, le runtime peut effectuer l’un des exemples de point ou le filtrage de convolution.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-135">When a one-bit surface is read, the runtime can perform either point sample or convolution filtering.</span></span> <span data-ttu-id="c0aa5-136">Le filtre de convolution est réglable (voir [**SetConvolutionMonoKernel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-setconvolutionmonokernel)).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-136">The convolution filter is adjustable (see [**SetConvolutionMonoKernel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-setconvolutionmonokernel)).</span></span>

<span data-ttu-id="c0aa5-137">Il existe des restrictions pour les surfaces d’un bit :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-137">There are some restrictions for one-bit surfaces:</span></span>

-   <span data-ttu-id="c0aa5-138">MIP-mapping n’est pas pris en charge</span><span class="sxs-lookup"><span data-stu-id="c0aa5-138">Mip-mapping is not supported</span></span>
-   <span data-ttu-id="c0aa5-139">les données sRVB ne peuvent pas être lues ou écrites sur une surface à un bit.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-139">sRGB data cannot be read or written to a one-bit surface.</span></span>
-   <span data-ttu-id="c0aa5-140">Une surface à un bit ne peut pas être utilisée comme texture de vertex ou pour l’échantillonnage multiple.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-140">A one-bit surface cannot be used as a vertex texture or for multisampling.</span></span>

## <a name="reading-depthstencil-buffers"></a><span data-ttu-id="c0aa5-141">Lecture des mémoires tampons de profondeur/stencil</span><span class="sxs-lookup"><span data-stu-id="c0aa5-141">Reading Depth/Stencil Buffers</span></span>

<span data-ttu-id="c0aa5-142">Utilisez IDirect3DDevice9 :: UpdateSurface pour lire ou écrire des données de profondeur/stencil à partir des surfaces obtenues à partir de IDirect3DDevice9 :: CreateDepthStencilSurface ou IDirect3DDevice9 :: GetDepthStencilSurface.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-142">Use IDirect3DDevice9::UpdateSurface to read or write depth/stencil data from surfaces obtained from IDirect3DDevice9::CreateDepthStencilSurface or IDirect3DDevice9::GetDepthStencilSurface.</span></span>

<span data-ttu-id="c0aa5-143">Tout d’abord, créez une surface verrouillable, profondeur uniquement ou stencil uniquement à l’aide de IDirect3DDevice9 :: CreateOffscreenPlainSurface.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-143">First, create a lockable, depth only or stencil only surface using IDirect3DDevice9::CreateOffscreenPlainSurface.</span></span> <span data-ttu-id="c0aa5-144">Utilisez l'un des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-144">Use one of the following formats:</span></span>

-   <span data-ttu-id="c0aa5-145">D3DFMT \_ D16 \_ verrouillable</span><span class="sxs-lookup"><span data-stu-id="c0aa5-145">D3DFMT\_D16\_LOCKABLE</span></span>
-   <span data-ttu-id="c0aa5-146">D3DFMT \_ D32F \_ verrouillable</span><span class="sxs-lookup"><span data-stu-id="c0aa5-146">D3DFMT\_D32F\_LOCKABLE</span></span>
-   <span data-ttu-id="c0aa5-147">D3DFMT \_ d32 \_ verrouillable</span><span class="sxs-lookup"><span data-stu-id="c0aa5-147">D3DFMT\_D32\_LOCKABLE</span></span>
-   <span data-ttu-id="c0aa5-148">D3DFMT \_ S8 \_ verrouillable</span><span class="sxs-lookup"><span data-stu-id="c0aa5-148">D3DFMT\_S8\_LOCKABLE</span></span>

<span data-ttu-id="c0aa5-149">Ensuite, transférez les données entre la mémoire tampon du stencil/profondeur et la surface de gabarit ou de la profondeur du stencil qui vient d’être créée.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-149">Second, transfer data between the depth/stencil buffer and the newly-created lockable depth or stencil surface.</span></span> <span data-ttu-id="c0aa5-150">Le transfert est effectué à l’aide de IDirect3DDevice9 :: UpdateSurface.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-150">The transfer is performed using IDirect3DDevice9::UpdateSurface.</span></span>

<span data-ttu-id="c0aa5-151">UpdateSurface échoue quand les deux surfaces sont de format verrouillable ou non verrouillables.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-151">UpdateSurface will fail when both surfaces are a LOCKABLE format or both are non-lockable.</span></span>

<span data-ttu-id="c0aa5-152">Le transfert de données inexistantes génère une erreur (par exemple, le transfert d’une surface de profondeur non verrouillable uniquement vers une \_ surface D3DFMT S8 \_ verrouillable).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-152">Transferring non-existent data will result in an error (for example, transferring from a non-lockable depth-only surface to a D3DFMT\_S8\_LOCKABLE surface).</span></span>

<span data-ttu-id="c0aa5-153">Le reste des restrictions pour IDirect3DDevice9 :: UpdateSurface s’applique toujours.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-153">The rest of the restrictions for IDirect3DDevice9::UpdateSurface still apply.</span></span>

## <a name="sharing-resources"></a><span data-ttu-id="c0aa5-154">Partager des ressources</span><span class="sxs-lookup"><span data-stu-id="c0aa5-154">Sharing Resources</span></span>

<span data-ttu-id="c0aa5-155">Les ressources Direct3D peuvent désormais être partagées entre des appareils ou des processus.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-155">Direct3D resources can now be shared between devices or processes.</span></span> <span data-ttu-id="c0aa5-156">Cela s’applique à toutes les ressources Direct3D, y compris les textures, les mémoires tampons de vertex, les mémoires tampons d’index ou les surfaces (telles que les cibles de rendu, les mémoires tampons de stencil de profondeur ou les surfaces ordinaires hors écran).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-156">This applies to any Direct3D resource including textures, vertex buffers, index buffers, or surfaces (such as render targets, depth stencil buffers or off-screen plain surfaces).</span></span> <span data-ttu-id="c0aa5-157">Pour être partagé, vous devez désigner une ressource pour le partage au moment de la création et localiser la ressource dans le pool par défaut (D3DPOOL \_ par défaut).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-157">To be shared, you need to designate a resource for sharing at the time of creation, and locate the resource in the default pool (D3DPOOL\_DEFAULT).</span></span> <span data-ttu-id="c0aa5-158">Une fois qu’une ressource est créée pour le partage, elle peut être partagée entre plusieurs appareils au sein d’un processus ou partagée par plusieurs processus.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-158">Once a resource is created for sharing, it can be shared across devices within a process, or shared across processes.</span></span>

<span data-ttu-id="c0aa5-159">Pour activer les ressources partagées, les API de création de ressources ont un paramètre de handle supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-159">To enable shared resources, the resource creation APIs have an additional handle parameter.</span></span> <span data-ttu-id="c0aa5-160">Il s’agit d’un HANDLE qui pointe vers la ressource partagée.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-160">This is a HANDLE that points to the shared resource.</span></span> <span data-ttu-id="c0aa5-161">Dans les révisions précédentes de DirectX, cet argument fait partie de la signature de l’API, mais il a été inutilisé et doit avoir la valeur **null**.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-161">In previous revisions of DirectX, this argument has been part of the API signature, but has been unused and must be set to **NULL**.</span></span> <span data-ttu-id="c0aa5-162">À compter de Windows Vista, utilisez pSharedHandle de la façon suivante :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-162">Starting with Windows Vista, use pSharedHandle in the following ways:</span></span>

-   <span data-ttu-id="c0aa5-163">Définissez le pointeur (pSharedHandle) sur la **valeur null** pour ne pas partager une ressource.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-163">Set the pointer (pSharedHandle) to **NULL** to not share a resource.</span></span> <span data-ttu-id="c0aa5-164">C’est comme le comportement de DirectX avant Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-164">This is just like the behavior of DirectX prior to Windows Vista.</span></span>
-   <span data-ttu-id="c0aa5-165">Pour créer une ressource partagée, appelez une API de création de ressource (voir ci-dessous) avec un handle non initialisé (le pointeur lui-même n’est pas **null** (pSharedHandle ! = **null**), mais le pointeur pointe vers une valeur **null** ( \* pSharedHandle = = **null**)).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-165">To create a shared resource, call any resource creation API (see below) with an uninitialized handle (the pointer itself is not **NULL** (pSharedHandle != **NULL**), but the pointer points to a **NULL** value (\*pSharedHandle == **NULL**)).</span></span> <span data-ttu-id="c0aa5-166">L’API génère une ressource partagée et retourne un handle valide.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-166">The API will generate a shared resource and return a valid handle.</span></span>
-   <span data-ttu-id="c0aa5-167">Pour ouvrir et accéder à une ressource partagée créée précédemment à l’aide d’un handle de ressource partagée non NULL, définissez pSharedHandle sur l’adresse de ce handle.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-167">To open and access a previously created shared resource by using a nonNULL shared resource handle, set pSharedHandle to the address of that handle.</span></span> <span data-ttu-id="c0aa5-168">Une fois que vous avez ouvert la ressource partagée précédemment créée de cette manière, vous pouvez utiliser l’interface retournée dans l’API Direct3D 9 ou Direct3D 9Ex comme si l’interface était une ressource typique de ce type.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-168">After you open the previously created shared resource in this manner, you can use the returned interface in the Direct3D 9 or Direct3D 9Ex API as if the interface were a typical resource of that type.</span></span>

<span data-ttu-id="c0aa5-169">Les API de création de ressources incluent- [**CreateTexture**](/windows/desktop/api), [**CreateVolumeTexture**](/windows/desktop/api), [**CreateCubeTexture**](/windows/desktop/api), [**CreateRenderTarget**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createrendertarget), [**CreateVertexBuffer**](/windows/desktop/api), [**CreateIndexBuffer**](/windows/desktop/api), [**CreateDepthStencilSurface**](/windows/desktop/api), [**CreateOffscreenPlainSurface**](/windows/desktop/api), [**CreateDepthStencilSurfaceEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createdepthstencilsurfaceex), [**CreateOffscreenPlainSurfaceEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createoffscreenplainsurfaceex)et [**CreateRenderTargetEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createrendertargetex).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-169">Resource creation APIs include - [**CreateTexture**](/windows/desktop/api), [**CreateVolumeTexture**](/windows/desktop/api), [**CreateCubeTexture**](/windows/desktop/api), [**CreateRenderTarget**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createrendertarget), [**CreateVertexBuffer**](/windows/desktop/api), [**CreateIndexBuffer**](/windows/desktop/api), [**CreateDepthStencilSurface**](/windows/desktop/api), [**CreateOffscreenPlainSurface**](/windows/desktop/api), [**CreateDepthStencilSurfaceEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createdepthstencilsurfaceex), [**CreateOffscreenPlainSurfaceEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createoffscreenplainsurfaceex), and [**CreateRenderTargetEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createrendertargetex).</span></span>

<span data-ttu-id="c0aa5-170">Certaines restrictions s’appliquent à l’utilisation des ressources partagées.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-170">There are some restrictions for using shared resources.</span></span> <span data-ttu-id="c0aa5-171">Il s’agit, entre autres, des suivantes :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-171">These include:</span></span>

-   <span data-ttu-id="c0aa5-172">L’API que vous utilisez pour ouvrir une ressource partagée doit correspondre à l’API que vous avez utilisée pour créer la ressource partagée.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-172">The API that you use to open a shared resource must match the API that you used to create the shared resource.</span></span> <span data-ttu-id="c0aa5-173">Par exemple, si vous avez utilisé [**CreateTexture**](/windows/desktop/api) pour créer une ressource partagée, vous devez utiliser **CreateTexture** pour ouvrir cette ressource partagée ; Si vous avez utilisé [**CreateRenderTarget**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createrendertarget) pour créer une ressource partagée, vous devez utiliser **CreateRenderTarget** pour ouvrir cette ressource partagée, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-173">For example, if you used [**CreateTexture**](/windows/desktop/api) to create a shared resource, you must use **CreateTexture** to open that shared resource; if you used [**CreateRenderTarget**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createrendertarget) to create a shared resource, you must use **CreateRenderTarget** to open that shared resource;and so on.</span></span>
-   <span data-ttu-id="c0aa5-174">Lorsque vous ouvrez une ressource partagée, vous devez spécifier D3DPOOL \_ par défaut.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-174">When you open a shared resource, you must specify D3DPOOL\_DEFAULT.</span></span>
-   <span data-ttu-id="c0aa5-175">Les ressources verrouillables (par exemple, les textures avec D3DUSAGE \_ Dynamic, les mémoires tampons de vertex et les mémoires tampons d’index) peuvent présenter des performances médiocres lorsqu’elles sont partagées.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-175">Lockable resources (textures with D3DUSAGE\_DYNAMIC, vertex buffers and index buffers, for instance) can experience poor performance when shared.</span></span> <span data-ttu-id="c0aa5-176">Les rendertargets verrouillables ne peuvent pas être partagés sur un matériel.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-176">Lockable rendertargets will fail to be shared on some hardware.</span></span>
-   <span data-ttu-id="c0aa5-177">Les références à une ressource partagée inter-processus doivent avoir les mêmes dimensions que la ressource d’origine.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-177">References to a cross-process shared resource must have the same dimensions as the original resource.</span></span> <span data-ttu-id="c0aa5-178">Lors du passage d’un handle à travers le processus, incluez les informations de dimension afin que la référence puisse être créée de façon identique.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-178">When passing a handle across process, include the dimension information so that the reference can be created identically.</span></span>
-   <span data-ttu-id="c0aa5-179">Les surfaces interprocessus partagées ne fournissent aucun mécanisme de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-179">Shared cross-process surfaces provide no synchronization mechanism.</span></span> <span data-ttu-id="c0aa5-180">Les modifications de lecture/écriture sur une surface partagée peuvent ne pas refléter la vue d’un processus de référencement de la surface quand cela est attendu.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-180">Read/write changes to a shared surface may not reflect a referencing process's view of the surface when expected.</span></span> <span data-ttu-id="c0aa5-181">Pour assurer la synchronisation, utilisez des requêtes d’événements ou verrouillez la texture.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-181">To provide synchronization, use event queries or lock the texture.</span></span>
-   <span data-ttu-id="c0aa5-182">Seul le processus qui crée initialement une ressource partagée peut le verrouiller (tout processus qui ouvre une référence à cette ressource partagée ne peut pas le verrouiller).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-182">Only the process that initially creates a shared resource can lock it (any process that opens a reference to that shared resource cannot lock it).</span></span>
-   <span data-ttu-id="c0aa5-183">Si une ressource partagée est verrouillée, les autres processus ne sont pas validés pour savoir si la ressource est disponible.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-183">If a shared resource is locked, there is no validation for other processes to know if the resource is available.</span></span>

## <a name="srgb-conversion-before-blending"></a><span data-ttu-id="c0aa5-184">Conversion sRVB avant la fusion</span><span class="sxs-lookup"><span data-stu-id="c0aa5-184">sRGB Conversion Before Blending</span></span>

<span data-ttu-id="c0aa5-185">Vous pouvez maintenant vérifier si l’appareil peut convertir les données du pipeline en sRVB avant la fusion de la mémoire tampon de trame.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-185">You can now check to see if the device can convert pipeline data to sRGB before frame-buffer blending.</span></span> <span data-ttu-id="c0aa5-186">Cela implique que l’appareil convertit les valeurs de cible de rendu de sRVB.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-186">This implies that the device converts the render-target values from sRGB.</span></span> <span data-ttu-id="c0aa5-187">Pour voir si la conversion est prise en charge par le matériel, vérifiez cette limite :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-187">To see if conversion is supported by the hardware, check for this cap:</span></span>


```
D3DPMISCCAPS_POSTBLENDSRGBCONVERT
```



<span data-ttu-id="c0aa5-188">Cette limite identifie le matériel qui prend en charge la conversion en sRVB avant la fusion.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-188">This cap identifies hardware that supports conversion to sRGB before blending.</span></span> <span data-ttu-id="c0aa5-189">Cette fonctionnalité est importante pour le rendu de haute qualité à partir des mémoires tampons de trame FP16 dans le gestionnaire de fenêtrage (DWM, Desktop Window Manager).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-189">This capability is important for the high quality rendering from fp16 frame buffers in the desktop window manager (DWM).</span></span>

## <a name="stretchrect-improvements"></a><span data-ttu-id="c0aa5-190">Améliorations apportées à StretchRect</span><span class="sxs-lookup"><span data-stu-id="c0aa5-190">StretchRect Improvements</span></span>

<span data-ttu-id="c0aa5-191">Dans les versions précédentes de DirectX, StretchRect présente de nombreuses restrictions pour gérer différents pilotes (consultez IDirect3DDevice9 :: StretchRect).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-191">In previous versions of DirectX, StretchRect has many restrictions to accommodate different drivers (see IDirect3DDevice9::StretchRect).</span></span> <span data-ttu-id="c0aa5-192">Windows Vista est basé sur le modèle WDDM (Windows Device Driver Model).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-192">Windows Vista is built on the Windows Device Driver Model (WDDM).</span></span> <span data-ttu-id="c0aa5-193">Ce nouveau modèle de pilote est bien plus robuste et permet aux pilotes de gérer des cas particuliers dans le matériel.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-193">This new driver model is much more robust, and allows drivers to handle special cases in the hardware.</span></span>

<span data-ttu-id="c0aa5-194">En général, la seule restriction restante est que la cible de rendu doit avoir été créée avec l’utilisation de la cible de rendu (D3DUSAGE \_ RENDERTARGET).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-194">In general, the only remaining restriction is that the render target must have been created with render-target usage (D3DUSAGE\_RENDERTARGET).</span></span> <span data-ttu-id="c0aa5-195">Cette restriction est levée si vous effectuez une copie simple (où la source et la destination ont le même format, la même taille et il n’y a aucun sous-rectangle).</span><span class="sxs-lookup"><span data-stu-id="c0aa5-195">This restriction is lifted if you are doing a simple copy (where the source and dest are the same format, same size and there are no sub-rectangles).</span></span>

## <a name="texture-creation-in-system-memory"></a><span data-ttu-id="c0aa5-196">Création de texture dans la mémoire système</span><span class="sxs-lookup"><span data-stu-id="c0aa5-196">Texture Creation in System Memory</span></span>

<span data-ttu-id="c0aa5-197">Les applications qui ont besoin d’une plus grande souplesse sur l’utilisation, l’allocation et la suppression de la mémoire système peuvent maintenant créer des textures à partir d’un pointeur de mémoire système.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-197">Applications that need more flexibility over the use, allocation and deletion of the system memory can now create textures from a system memory pointer.</span></span> <span data-ttu-id="c0aa5-198">Par exemple, une application peut créer une texture Direct3D à partir d’un pointeur bitmap de mémoire système GDI.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-198">For example, an application could create a Direct3D texture from a GDI system-memory bitmap pointer.</span></span>

<span data-ttu-id="c0aa5-199">Vous devez effectuer deux opérations pour créer une telle texture :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-199">You need to do two things to create such a texture:</span></span>

-   <span data-ttu-id="c0aa5-200">Allouez suffisamment de mémoire système pour contenir la surface de texture.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-200">Allocate enough system memory to hold the texture surface.</span></span> <span data-ttu-id="c0aa5-201">Le nombre minimal d’octets est de largeur x hauteur x octets par pixel.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-201">The minimum number of bytes is width x height x bytes per pixel.</span></span>
-   <span data-ttu-id="c0aa5-202">Transmettez l’adresse d’un pointeur vers votre surface mémoire système pour le \* paramètre handle à IDirect3DDevice9 :: CreateTexture.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-202">Pass the address of a pointer to your system memory surface for the HANDLE\* parameter to IDirect3DDevice9::CreateTexture.</span></span>

<span data-ttu-id="c0aa5-203">Voici le prototype de fonction pour IDirect3DDevice9 :: CreateTexture :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-203">Here is the function prototype for IDirect3DDevice9::CreateTexture:</span></span>


```
STDMETHOD(CreateTexture)(THIS_ UINT Width, UINT Height, UINT Levels, 
    DWORD Usage, D3DFORMAT Format, D3DPOOL Pool, IDirect3DTexture9** ppTexture, 
    HANDLE* pSharedHandle)
```



<span data-ttu-id="c0aa5-204">Une texture de mémoire système a les restrictions suivantes :</span><span class="sxs-lookup"><span data-stu-id="c0aa5-204">A system-memory texture has the following restrictions:</span></span>

-   <span data-ttu-id="c0aa5-205">L’espacement de la texture doit être égal à la largeur de la texture multiplié par le nombre d’octets par pixel.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-205">The texture pitch must equal texture width times the number of bytes per pixel.</span></span>
-   <span data-ttu-id="c0aa5-206">Lorsque vous utilisez des formats compressés (formats DXT), l’application est chargée d’allouer la taille correcte.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-206">When using compressed formats (DXT formats), the application is responsible for allocating the correct size.</span></span>
-   <span data-ttu-id="c0aa5-207">Seules les textures avec un niveau mipmap unique sont prises en charge.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-207">Only textures with a single mipmap level are supported.</span></span>
-   <span data-ttu-id="c0aa5-208">La valeur passée à CreateTexture pour l’argument de pool doit être D3DPOOL \_ SYSTEMMEM.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-208">The value passed to CreateTexture for the Pool argument must be D3DPOOL\_SYSTEMMEM.</span></span>
-   <span data-ttu-id="c0aa5-209">Cette API encapsule la mémoire fournie dans une texture.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-209">This API wraps the supplied memory in a texture.</span></span> <span data-ttu-id="c0aa5-210">Ne libérez pas cette mémoire tant que vous ne l’avez pas fait.</span><span class="sxs-lookup"><span data-stu-id="c0aa5-210">Do not deallocate this memory until you are done with it.</span></span>

 

 
