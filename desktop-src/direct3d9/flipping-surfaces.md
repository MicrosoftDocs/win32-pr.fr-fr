---
description: Une application Direct3D affiche généralement une séquence animée en générant les frames de l’animation dans des mémoires tampons d’arrière-plan et en les présentant dans l’ordre.
ms.assetid: 4ca9a845-f433-4d4a-939e-4b9ab2983927
title: Retournement des surfaces (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1dafd263de0f907b33ff6f20ffcbb2cce69943da
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "103746868"
---
# <a name="flipping-surfaces-direct3d-9"></a><span data-ttu-id="601c8-103">Retournement des surfaces (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="601c8-103">Flipping Surfaces (Direct3D 9)</span></span>

<span data-ttu-id="601c8-104">Une application Direct3D affiche généralement une séquence animée en générant les frames de l’animation dans des mémoires tampons d’arrière-plan et en les présentant dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="601c8-104">A Direct3D application typically displays an animated sequence by generating the frames of the animation in back buffers and presenting them in sequence.</span></span> <span data-ttu-id="601c8-105">Les mémoires tampons d’arrière-plan sont organisées en chaînes d’échange.</span><span class="sxs-lookup"><span data-stu-id="601c8-105">Back buffers are organized into swap chains.</span></span> <span data-ttu-id="601c8-106">Une chaîne de permutation est une série de mémoires tampons qui sont retournées à l’écran l’une après l’autre.</span><span class="sxs-lookup"><span data-stu-id="601c8-106">A swap chain is a series of buffers that "flip" to the screen one after another.</span></span> <span data-ttu-id="601c8-107">Cela peut être utilisé pour restituer une scène en mémoire, puis retourner la scène à l’écran lorsque le rendu est terminé.</span><span class="sxs-lookup"><span data-stu-id="601c8-107">This can be used to render one scene in memory and then flip the scene to the screen when rendering is complete.</span></span> <span data-ttu-id="601c8-108">Cela évite le phénomène connu sous le nom de déchirement et permet une animation plus lisse.</span><span class="sxs-lookup"><span data-stu-id="601c8-108">This avoids the phenomenon known as tearing and allows for smoother animation.</span></span>

<span data-ttu-id="601c8-109">Chaque périphérique créé dans Direct3D a au moins une chaîne de permutation.</span><span class="sxs-lookup"><span data-stu-id="601c8-109">Each device created in Direct3D has at least one swap chain.</span></span> <span data-ttu-id="601c8-110">Lorsque vous initialisez le premier périphérique Direct3D, vous définissez le membre BackBufferCount des [**\_ paramètres D3DPRESENT**](d3dpresent-parameters.md), qui indique à Direct3D le nombre de mémoires tampons d’arrière-plan qui seront dans la chaîne de permutation.</span><span class="sxs-lookup"><span data-stu-id="601c8-110">When you initialize the first Direct3D device, you set the BackBufferCount member of [**D3DPRESENT\_PARAMETERS**](d3dpresent-parameters.md), which tells Direct3D the number of back buffers that will be in the swap chain.</span></span> <span data-ttu-id="601c8-111">L’appel à [**IDirect3D9 :: CreateDevice**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-createdevice) crée alors le périphérique Direct3D et la chaîne de permutation correspondante.</span><span class="sxs-lookup"><span data-stu-id="601c8-111">The call to [**IDirect3D9::CreateDevice**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-createdevice) then creates the Direct3D device and corresponding swap chain.</span></span>

<span data-ttu-id="601c8-112">Quand vous utilisez [**IDirect3DDevice9 ::P renvoyé**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-present) pour demander une opération de basculement de surface, les pointeurs vers la mémoire de surface pour la mémoire tampon d’arrière-plan et les mémoires tampons d’arrière-plan sont permutés.</span><span class="sxs-lookup"><span data-stu-id="601c8-112">When you use [**IDirect3DDevice9::Present**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-present) to request a surface flip operation, the pointers to surface memory for the front buffer and back buffers are swapped.</span></span> <span data-ttu-id="601c8-113">Le retournement est effectué en basculant les pointeurs que le périphérique d’affichage utilise pour référencer la mémoire, et non en copiant la mémoire de surface.</span><span class="sxs-lookup"><span data-stu-id="601c8-113">Flipping is performed by switching pointers that the display device uses for referencing memory, not by copying surface memory.</span></span> <span data-ttu-id="601c8-114">Lorsqu’une chaîne de basculement contient une mémoire tampon d’arrière-plan et plusieurs mémoires tampons d’arrière-plan, les pointeurs sont basculés dans un modèle circulaire, comme indiqué dans le diagramme suivant.</span><span class="sxs-lookup"><span data-stu-id="601c8-114">When a flipping chain contains a front buffer and more than one back buffer, the pointers are switched in a circular pattern, as shown in the following diagram.</span></span>

![diagramme d’une chaîne de basculement avec une mémoire tampon d’avant et deux mémoires tampons d’arrière-plan](images/trplflip.png)

<span data-ttu-id="601c8-116">Vous pouvez créer des chaînes de permutation supplémentaires pour un appareil en appelant [**IDirect3DDevice9 :: CreateAdditionalSwapChain**](/windows/desktop/api).</span><span class="sxs-lookup"><span data-stu-id="601c8-116">You can create addition swap chains for a device by calling [**IDirect3DDevice9::CreateAdditionalSwapChain**](/windows/desktop/api).</span></span> <span data-ttu-id="601c8-117">Une application peut créer une chaîne de permutation par vue et associer chaque chaîne de permutation à une fenêtre particulière.</span><span class="sxs-lookup"><span data-stu-id="601c8-117">An application can create one swap chain per view and associate each swap chain with a particular window.</span></span> <span data-ttu-id="601c8-118">L’application restitue des images dans les mémoires tampons d’arrière-plan de chaque chaîne de permutation, puis les présente individuellement.</span><span class="sxs-lookup"><span data-stu-id="601c8-118">The application renders images in the back buffers of each swap chain, and then presents them individually.</span></span> <span data-ttu-id="601c8-119">Les deux paramètres que **IDirect3DDevice9 :: CreateAdditionalSwapChain** prennent sont un pointeur vers une structure de [**\_ paramètres D3DPRESENT**](d3dpresent-parameters.md) et l’adresse d’un pointeur vers une interface [**IDirect3DSwapChain9**](/windows/desktop/api) .</span><span class="sxs-lookup"><span data-stu-id="601c8-119">The two parameters that **IDirect3DDevice9::CreateAdditionalSwapChain** takes are a pointer to a [**D3DPRESENT\_PARAMETERS**](d3dpresent-parameters.md) structure and the address of a pointer to an [**IDirect3DSwapChain9**](/windows/desktop/api) interface.</span></span> <span data-ttu-id="601c8-120">Vous pouvez ensuite utiliser [**IDirect3DSwapChain9 ::P renvoyé**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dswapchain9-present) pour afficher le contenu de la mémoire tampon d’arrière-plan suivante dans le tampon d’avant.</span><span class="sxs-lookup"><span data-stu-id="601c8-120">You can then use [**IDirect3DSwapChain9::Present**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dswapchain9-present) to display the contents of the next back buffer to the front buffer.</span></span> <span data-ttu-id="601c8-121">Notez qu’un appareil ne peut avoir qu’une seule chaîne d’échange plein écran.</span><span class="sxs-lookup"><span data-stu-id="601c8-121">Note that a device can only have one full-screen swap chain.</span></span>

<span data-ttu-id="601c8-122">Vous pouvez accéder à une mémoire tampon d’arrière-plan spécifique en appelant les méthodes [**IDirect3DDevice9 :: GetBackBuffer**](/windows/desktop/api) ou [**IDirect3DSwapChain9 :: GetBackBuffer**](/windows/desktop/api) , qui retournent un pointeur vers une interface [**IDirect3DSurface9**](/windows/desktop/api) qui représente la surface de mémoire tampon d’arrière-plan retournée.</span><span class="sxs-lookup"><span data-stu-id="601c8-122">You can gain access to a specific back buffer by calling the [**IDirect3DDevice9::GetBackBuffer**](/windows/desktop/api) or [**IDirect3DSwapChain9::GetBackBuffer**](/windows/desktop/api) methods, which return a pointer to an [**IDirect3DSurface9**](/windows/desktop/api) interface that represents the returned back buffer surface.</span></span> <span data-ttu-id="601c8-123">Notez que l’appel de cette méthode augmente le nombre de références internes sur l’interface [**IDirect3DDevice9**](/windows/desktop/api) . par conséquent, veillez à appeler [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) lorsque vous avez fini d’utiliser cette surface ou une fuite de mémoire se produit.</span><span class="sxs-lookup"><span data-stu-id="601c8-123">Note that calling this method increases the internal reference count on the [**IDirect3DDevice9**](/windows/desktop/api) interface so be sure to call [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) when you are done using this surface or you will have a memory leak.</span></span>

<span data-ttu-id="601c8-124">Rappelez-vous que Direct3D retourne des surfaces en échangeant des pointeurs de mémoire surface dans la chaîne de permutation, et non en échangeant les surfaces elles-mêmes.</span><span class="sxs-lookup"><span data-stu-id="601c8-124">Remember, Direct3D flips surfaces by swapping surface memory pointers within the swap chain, not by swapping the surfaces themselves.</span></span> <span data-ttu-id="601c8-125">Cela signifie que vous allez toujours afficher la mémoire tampon d’arrière-plan qui sera affichée ensuite.</span><span class="sxs-lookup"><span data-stu-id="601c8-125">This means that you will always render to the back buffer that will be displayed next.</span></span>

<span data-ttu-id="601c8-126">Il est important de noter la distinction entre une « opération de basculement », telle qu’elle est effectuée par un pilote de carte d’affichage, et une opération « présente » appliquée à une chaîne de permutation créée avec D3DSWAPEFFECT \_ Flip.</span><span class="sxs-lookup"><span data-stu-id="601c8-126">It is important to note the distinction between a "flipping operation," as performed by a display adapter driver, and a "Present" operation applied to a swap chain created with D3DSWAPEFFECT\_FLIP.</span></span>

<span data-ttu-id="601c8-127">Le terme « Flip » désigne une opération qui modifie la plage d’adresses de mémoire vidéo qu’un adaptateur d’affichage utilise pour générer son signal de sortie, provoquant ainsi l’affichage du contenu d’une mémoire tampon d’arrière-plan précédemment masquée.</span><span class="sxs-lookup"><span data-stu-id="601c8-127">The term "flip" conventionally denotes an operation that alters the range of video memory addresses that a display adapter uses to generate its output signal, thus causing the contents of a previously hidden back buffer to be displayed.</span></span> <span data-ttu-id="601c8-128">Dans Direct3D 9, le terme est souvent utilisé plus généralement pour décrire la présentation d’une mémoire tampon d’arrière-plan dans toute chaîne de permutation créée avec l' \_ effet de permutation D3DSWAPEFFECT.</span><span class="sxs-lookup"><span data-stu-id="601c8-128">In Direct3D 9, the term is often used more generally to describe the presentation of a back buffer in any swap chain created with the D3DSWAPEFFECT\_FLIP swap effect.</span></span>

<span data-ttu-id="601c8-129">Bien que ces opérations « présentes » soient presque invariablement implémentées par les opérations de basculement lorsque la chaîne de permutation est un plein écran, elles sont nécessairement implémentées par les opérations de copie lorsque la chaîne de permutation est affichée.</span><span class="sxs-lookup"><span data-stu-id="601c8-129">While such "Present" operations are almost invariably implemented by flip operations when the swap chain is a full-screen one, they are necessarily implemented by copy operations when the swap chain is windowed.</span></span> <span data-ttu-id="601c8-130">En outre, un pilote de carte d’affichage peut utiliser le retournement pour implémenter les opérations présentes sur les chaînes d’échange plein écran en fonction de la \_ copie D3DSWAPEFFECT Discard et D3DSWAPEFFECT \_ .</span><span class="sxs-lookup"><span data-stu-id="601c8-130">Furthermore, a display adapter driver may use flipping to implement Present operations against full-screen swap chains based on the D3DSWAPEFFECT\_DISCARD and D3DSWAPEFFECT\_COPY.</span></span>

<span data-ttu-id="601c8-131">La discussion ci-dessus s’applique au cas couramment utilisé d’une chaîne de permutation plein écran créée avec D3DSWAPEFFECT \_ Flip.</span><span class="sxs-lookup"><span data-stu-id="601c8-131">The discussion above applies to the commonly used case of a full-screen swap chain created with D3DSWAPEFFECT\_FLIP.</span></span>

<span data-ttu-id="601c8-132">Pour une description plus générale des différents effets de permutation pour les chaînes de permutation à l’écran et en mode fenêtre, consultez [**D3DSWAPEFFECT**](./d3dswapeffect.md).</span><span class="sxs-lookup"><span data-stu-id="601c8-132">For a more general discussion of the different swap effects for both windowed and full-screen swap chains, see [**D3DSWAPEFFECT**](./d3dswapeffect.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="601c8-133">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="601c8-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="601c8-134">Surfaces Direct3D</span><span class="sxs-lookup"><span data-stu-id="601c8-134">Direct3D Surfaces</span></span>](direct3d-surfaces.md)
</dt> </dl>

 

 
