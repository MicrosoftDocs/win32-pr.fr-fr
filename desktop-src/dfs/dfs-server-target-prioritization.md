---
title: Définition de la priorité cible du serveur DFS
description: La définition de priorités de serveur DFS est une fonctionnalité disponible dans Microsoft Windows Server 2003 avec Service Pack 1 (SP1) et les systèmes d’exploitation ultérieurs.
ms.assetid: 0aacebf7-49cc-4287-a5c4-0d25a416d227
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3e784a540a67f624ca5b8075009cd862c6063427
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104201116"
---
# <a name="dfs-server-target-prioritization"></a><span data-ttu-id="da410-103">Définition de la priorité cible du serveur DFS</span><span class="sxs-lookup"><span data-stu-id="da410-103">DFS Server Target Prioritization</span></span>

<span data-ttu-id="da410-104">La définition de priorités de serveur DFS est une fonctionnalité disponible dans Microsoft Windows Server 2003 avec Service Pack 1 (SP1) et les systèmes d’exploitation ultérieurs.</span><span class="sxs-lookup"><span data-stu-id="da410-104">DFS Server Target Prioritization is a feature available in Microsoft Windows Server 2003 with Service Pack 1 (SP1) and later operating systems.</span></span> <span data-ttu-id="da410-105">Cette fonctionnalité permet aux serveurs DFS de tirer parti des informations de coût de site Active Directory disponibles pour hiérarchiser les cibles dans les références des clients.</span><span class="sxs-lookup"><span data-stu-id="da410-105">This feature enables DFS servers to take advantage of available Active Directory site-cost information to prioritize the targets in client referrals.</span></span>

<span data-ttu-id="da410-106">Avant Windows Server 2003 avec SP1, les cibles étaient regroupées en deux ensembles : un groupe pour contenir toutes les cibles dans le même site que le client. et un autre groupe pour toutes les autres cibles.</span><span class="sxs-lookup"><span data-stu-id="da410-106">Before Windows Server 2003 with SP1, targets were grouped into two sets: one group for containing all targets in the same site as the client; and another group for all other targets.</span></span> <span data-ttu-id="da410-107">Ces cibles partageant le même site que le client sont appelées « dans le site » et si le coût des sites est activé, un coût spécifique est attribué à chaque site, avec des coûts de site inférieurs par rapport à ceux d’une valeur supérieure.</span><span class="sxs-lookup"><span data-stu-id="da410-107">Those targets sharing the same site as the client are called "in-site", and if site-costing is enabled, they are assigned a specific cost value relative to the site overall, with lower site costs preferred over higher ones.</span></span>

<span data-ttu-id="da410-108">Avec la disponibilité de ces données de coût de site, les cibles de serveur peuvent être classées par ordre de priorité pour des stratégies de basculement de serveur DFS plus efficaces.</span><span class="sxs-lookup"><span data-stu-id="da410-108">With the availability of this site-costing data, server targets can be prioritized for more effective DFS server failover strategies.</span></span> <span data-ttu-id="da410-109">Dans le passé, ce niveau granulaire de détails n’était pas disponible et les administrateurs devaient recourir à des moyens artificiels (tels que des sites factices dans Active Directory) pour prendre en charge des exigences encore plus simples, telles que la désignation de serveurs spécifiques en tant que serveur de « sauvegarde » ou « secondaire » dans le cas où un serveur DFS « principal » échoue.</span><span class="sxs-lookup"><span data-stu-id="da410-109">In the past, this granular level of detail was not available, and administrators had to resort to artificial means (such as dummy sites in AD) to support even simple requirements like the designation of specific servers as a "backup" or "secondary" server in the case where a "primary" DFS server fails.</span></span> <span data-ttu-id="da410-110">Désormais, avec les détails supplémentaires fournis par les stratégies de basculement de site, des stratégies de basculement à plusieurs niveaux sont possibles.</span><span class="sxs-lookup"><span data-stu-id="da410-110">Now, with the additional detail provided by site-costing, multi-level failover strategies are possible.</span></span>

<span data-ttu-id="da410-111">La discussion suivante suppose que le coût des sites est activé.</span><span class="sxs-lookup"><span data-stu-id="da410-111">The following discussion assumes that site-costing is enabled.</span></span>

## <a name="target-prioritization"></a><span data-ttu-id="da410-112">Priorité cible</span><span class="sxs-lookup"><span data-stu-id="da410-112">Target Prioritization</span></span>

<span data-ttu-id="da410-113">La priorité cible est un ordre spécifique du point de vue administratif, la classification et le classement des serveurs sur site en termes de préférences explicites en fonction du coût de leur site à partir d’un client DFS.</span><span class="sxs-lookup"><span data-stu-id="da410-113">Target priority is a specific ordering from an administrative perspective, classifying and ranking in-site servers in terms of explicit preference based on their site cost from a DFS client.</span></span> <span data-ttu-id="da410-114">La priorité globale est indépendante du coût du site.</span><span class="sxs-lookup"><span data-stu-id="da410-114">Global priority is independent of the site-cost.</span></span> <span data-ttu-id="da410-115">Notez que les classes de priorité globale n’indiquent pas nécessairement les cibles les plus optimales du point de vue d’un client DFS, mais reflètent plutôt l’importance, ou l’absence d’importance, des cibles spécifiques du point de vue d’un administrateur de site.</span><span class="sxs-lookup"><span data-stu-id="da410-115">Note that global priority classes do not necessarily indicate the most optimal targets from a DFS client's perspective, but instead reflect the importance, or lack of importance, of specific targets from a site administrator's perspective.</span></span>

<span data-ttu-id="da410-116">La priorité du serveur cible est divisée en deux catégories de valeurs : classe de priorité et rang de priorité.</span><span class="sxs-lookup"><span data-stu-id="da410-116">Server target priority is divided into two value categories: priority class and priority rank.</span></span> <span data-ttu-id="da410-117">Les classes de priorité sont divisées en deux niveaux : local et global.</span><span class="sxs-lookup"><span data-stu-id="da410-117">Priority classes are divided into two levels: local and global.</span></span> <span data-ttu-id="da410-118">Au sein de ces classes, il existe un classement approximatif des cibles en fonction du coût du site, regroupé comme élevé, normal et basse priorité.</span><span class="sxs-lookup"><span data-stu-id="da410-118">Within these classes there is a rough ordering of targets based on site cost, grouped as high, normal, and low priority.</span></span> <span data-ttu-id="da410-119">Le résultat est cinq classes de priorité, dans l’ordre de priorité la plus élevée à la plus basse, comme suit :</span><span class="sxs-lookup"><span data-stu-id="da410-119">The result is five priority classes, in order from highest to lowest priority as follows:</span></span>

- <span data-ttu-id="da410-120">Haute priorité globale</span><span class="sxs-lookup"><span data-stu-id="da410-120">Global high priority</span></span>
- <span data-ttu-id="da410-121">Site-haute priorité</span><span class="sxs-lookup"><span data-stu-id="da410-121">Site-cost high priority</span></span>
- <span data-ttu-id="da410-122">Site-coût normal priorité</span><span class="sxs-lookup"><span data-stu-id="da410-122">Site-cost normal priority</span></span>
- <span data-ttu-id="da410-123">Site-coût faible priorité</span><span class="sxs-lookup"><span data-stu-id="da410-123">Site-cost low priority</span></span>
- <span data-ttu-id="da410-124">Priorité basse globale</span><span class="sxs-lookup"><span data-stu-id="da410-124">Global low priority</span></span>

<span data-ttu-id="da410-125">Les classes de coût de site peuvent être considérées comme des sous-divisions de la « priorité normale globale ».</span><span class="sxs-lookup"><span data-stu-id="da410-125">The site-cost classes can be considered as subdivisions of "global normal priority".</span></span> <span data-ttu-id="da410-126">Le rang de priorité est un classement d’entiers simple basé sur les valeurs ordinales : 0, 1, 2 et à partir de, avec 0 étant la valeur la plus élevée et toutes les valeurs suivantes indiquant une diminution du rang.</span><span class="sxs-lookup"><span data-stu-id="da410-126">Priority rank is a simple integer ranking based on ordinal values: 0, 1, 2, and onward, with 0 being the highest value and all subsequent values indicating decreasing rank.</span></span>

<span data-ttu-id="da410-127">Les priorités globales haute et basse ne tiennent pas compte des valeurs de coût de site.</span><span class="sxs-lookup"><span data-stu-id="da410-127">The global high and low priorities do not consider site-cost values.</span></span> <span data-ttu-id="da410-128">Les cibles avec une priorité élevée globale reçoivent une préférence sur toutes les autres cibles, et les cibles avec une priorité basse globale reçoivent le moins de préférence.</span><span class="sxs-lookup"><span data-stu-id="da410-128">Targets with a global high priority receive preference over all other targets, and targets with a global low priority receive the least preference.</span></span>

<span data-ttu-id="da410-129">Dans le classement d’une référence, le processus complet présente les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="da410-129">In ordering a referral, the complete process has the following steps:</span></span>

1. <span data-ttu-id="da410-130">Les jeux de cibles globales haute et basse sont identifiés, ainsi que les cibles « globales » restantes.</span><span class="sxs-lookup"><span data-stu-id="da410-130">The sets of global high and low targets are identified, along with the remaining "global normal" targets.</span></span>
2. <span data-ttu-id="da410-131">Si l’option « INSITE » est définie, toutes les cibles situées en dehors du site du client sont supprimées.</span><span class="sxs-lookup"><span data-stu-id="da410-131">If the "INSITE" option is set, all targets outside of the client's site are removed.</span></span> <span data-ttu-id="da410-132">L’option « inactive » n’est pas appliquée aux ensembles globaux haute et basse priorité.</span><span class="sxs-lookup"><span data-stu-id="da410-132">The "INSITE" option is not applied to the global high and low priority sets.</span></span>
3. <span data-ttu-id="da410-133">Dans chacun de ces trois ensembles, les cibles sont triées à l’aide du mécanisme de coût de site Active Directory, à l’aide d’une évaluation de site locale ou complète.</span><span class="sxs-lookup"><span data-stu-id="da410-133">Within each of these three sets, the targets are ordered using the AD site-cost mechanism, using either local or full site costing.</span></span> <span data-ttu-id="da410-134">Le résultat est un ensemble de cibles de même coût de site.</span><span class="sxs-lookup"><span data-stu-id="da410-134">The result is sets of targets of equal site cost.</span></span>
4. <span data-ttu-id="da410-135">Dans les ensembles de cibles globales « normal » de même coût de site, les cibles sont affectées d’une classe de priorité à partir des classements de niveau élevé, normal et basse priorité du site.</span><span class="sxs-lookup"><span data-stu-id="da410-135">Within the sets of "global normal" targets of equal site cost, targets are assigned a priority class from the site-cost high, normal, and low priority rankings.</span></span>
5. <span data-ttu-id="da410-136">Dans les ensembles de cibles de la classe de priorité et de coût de site identiques, les cibles sont désormais classées par rang de priorité, 0 étant le rang le plus élevé.</span><span class="sxs-lookup"><span data-stu-id="da410-136">Within the sets of targets of equal site cost and priority class, targets are now ordered by priority rank, with 0 being the highest rank.</span></span>
6. <span data-ttu-id="da410-137">Dans les ensembles de cibles de même coût de site, classe de priorité et rang de priorité, les cibles sont mélangées de façon aléatoire pour l’équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="da410-137">Within the sets of targets of equal site cost, priority class, and priority rank, targets are randomly shuffled for load balancing.</span></span>

<span data-ttu-id="da410-138">Graphiquement, un ensemble de cibles est ordonné comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="da410-138">Graphically, a set of targets are ordered as seen below:</span></span>

- <span data-ttu-id="da410-139">cibles de classe de priorité élevée globale</span><span class="sxs-lookup"><span data-stu-id="da410-139">global high priority class targets</span></span> 
- <span data-ttu-id="da410-140">cibles de classe de niveau haute priorité site avec coût du site = 0</span><span class="sxs-lookup"><span data-stu-id="da410-140">site-cost high priority class targets with site cost = 0</span></span>
- <span data-ttu-id="da410-141">normal avec coût du site = 0</span><span class="sxs-lookup"><span data-stu-id="da410-141">normal with site cost = 0</span></span>
- <span data-ttu-id="da410-142">faible avec coût du site = 0</span><span class="sxs-lookup"><span data-stu-id="da410-142">low with site cost = 0</span></span>
- <span data-ttu-id="da410-143">cibles de classe de niveau haute priorité site avec coût du site = 1</span><span class="sxs-lookup"><span data-stu-id="da410-143">site-cost high priority class targets with site cost = 1</span></span>
- <span data-ttu-id="da410-144">normal avec coût du site = 1</span><span class="sxs-lookup"><span data-stu-id="da410-144">normal with site cost = 1</span></span>
- <span data-ttu-id="da410-145">faible avec coût du site = 1</span><span class="sxs-lookup"><span data-stu-id="da410-145">low with site cost = 1</span></span>
- <span data-ttu-id="da410-146">et ainsi de suite</span><span class="sxs-lookup"><span data-stu-id="da410-146">and so on</span></span>
- <span data-ttu-id="da410-147">cibles de classe de priorité basse globale</span><span class="sxs-lookup"><span data-stu-id="da410-147">global low priority class targets</span></span>

<span data-ttu-id="da410-148">Dans chacun de ces jeux, les cibles sont triées en fonction du rang de priorité.</span><span class="sxs-lookup"><span data-stu-id="da410-148">Within each of these sets, targets are sorted according to priority rank.</span></span> <span data-ttu-id="da410-149">Le rang le plus élevé est égal à zéro, avec chaque valeur entière suivante (1, 2, etc.) indiquant un rang de plus en plus faible.</span><span class="sxs-lookup"><span data-stu-id="da410-149">The highest rank is zero, with each subsequent integer value (1, 2, and so on) indicating an increasingly lower rank.</span></span>

<span data-ttu-id="da410-150">La priorité cible est définie sur une cible spécifique d’un lien (ou racine) dans un espace de noms DFS.</span><span class="sxs-lookup"><span data-stu-id="da410-150">Target priority is set on a specific target of a link (or root) in a DFS namespace.</span></span> <span data-ttu-id="da410-151">La priorité d’une cible pour un lien n’influe pas sur l’ordre des autres liens si ce même chemin cible est utilisé plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="da410-151">A target's priority for one link does not influence the ordering of other links if that same target path is used multiple times.</span></span> <span data-ttu-id="da410-152">Par exemple, si deux liens ont \\ \\ \\ un serveur Share1 en tant que cible, la priorité du \\ \\ serveur \\ Share1 est définie séparément pour les deux liens.</span><span class="sxs-lookup"><span data-stu-id="da410-152">For example, if two links have \\\\server\\share1 as a target, the priority of \\\\server\\share1 is set separately for both links.</span></span>

<span data-ttu-id="da410-153">La priorité par défaut pour tous les liens est le niveau de priorité site-coût normal avec le rang 0.</span><span class="sxs-lookup"><span data-stu-id="da410-153">The default priority for all links is the site-cost normal priority with a rank of 0.</span></span> <span data-ttu-id="da410-154">La priorité cible n’affecte pas l’ordre des références, sauf si elle est utilisée, et si tous les liens existants sont triés à mesure qu’ils sont reçus.</span><span class="sxs-lookup"><span data-stu-id="da410-154">Target priority does not affect the ordering of referrals unless it is used, and all existing links are ordered as they are received.</span></span>

<span data-ttu-id="da410-155">La réponse de référence d’un serveur DFS se compose de jeux de cibles classés comme indiqué ci-dessus, avec chaque ensemble de cibles non global contenant des cibles du même coût de site, de la classe de priorité et du rang de priorité.</span><span class="sxs-lookup"><span data-stu-id="da410-155">The referral response from a DFS server consists of target sets ordered as indicated above, with each non-global target set containing targets of the same site cost, priority class, and priority rank.</span></span> <span data-ttu-id="da410-156">Les cibles dans chaque ensemble sont triées de façon aléatoire.</span><span class="sxs-lookup"><span data-stu-id="da410-156">Targets within each set are ordered randomly.</span></span> <span data-ttu-id="da410-157">Les clients DFS qui reçoivent la référence commencent par la première cible du premier jeu et continuent d’accéder à la liste jusqu’à ce qu’une cible disponible pour une racine ou un lien DFS donné soit trouvée.</span><span class="sxs-lookup"><span data-stu-id="da410-157">DFS clients that receive the referral start with the first target of the first set, and continue through the list until an available target for a given DFS root or link is found.</span></span>

<span data-ttu-id="da410-158">Pour l’implémentation d’API spécifique de cette fonctionnalité, consultez les rubriques de référence suivantes :</span><span class="sxs-lookup"><span data-stu-id="da410-158">For the specific API implementation of this feature, please see the following reference topics:</span></span>

<span data-ttu-id="da410-159">[**DFS_INFO_6**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_6) 
 [**DFS_INFO_104**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_104) 
 [**DFS_INFO_106**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_106) 
 [**DFS_TARGET_PRIORITY**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_target_priority) 
 [**DFS_TARGET_PRIORITY_CLASS**](/windows/win32/api/lmdfs/ne-lmdfs-dfs_target_priority_class~r1)</span><span class="sxs-lookup"><span data-stu-id="da410-159">[**DFS_INFO_6**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_6)
[**DFS_INFO_104**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_104)
[**DFS_INFO_106**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_106)
[**DFS_TARGET_PRIORITY**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_target_priority)
[**DFS_TARGET_PRIORITY_CLASS**](/windows/win32/api/lmdfs/ne-lmdfs-dfs_target_priority_class~r1)</span></span>
