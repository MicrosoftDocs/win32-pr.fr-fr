---
description: 'En réponse à un événement d’identification, chaque enregistreur présent sur le système construit son propre document de métadonnées d’écriture à l’aide de IVssCreateWriterMetadata. Un événement d’identification est généralement généré par un demandeur appelant IVssBackupComponents :: GatherWriterMetadata.'
ms.assetid: bae9bbe7-ca55-47cb-b253-8092007cb181
title: Cycle de vie des documents de métadonnées de l’enregistreur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45be5748625d21f99abe3e77e0d6474a62210904
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106519303"
---
# <a name="writer-metadata-document-life-cycle"></a><span data-ttu-id="ffa0d-104">Cycle de vie des documents de métadonnées de l’enregistreur</span><span class="sxs-lookup"><span data-stu-id="ffa0d-104">Writer Metadata Document Life Cycle</span></span>

<span data-ttu-id="ffa0d-105">En réponse à un [*événement d’identification*](vssgloss-i.md), chaque enregistreur présent sur le système construit son propre document de métadonnées d’écriture à l’aide de [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata).</span><span class="sxs-lookup"><span data-stu-id="ffa0d-105">In response to an [*Identify event*](vssgloss-i.md), each writer present on the system constructs its own Writer Metadata Document using [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata).</span></span> <span data-ttu-id="ffa0d-106">Un *événement d’identification* est généralement généré par un demandeur appelant [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="ffa0d-106">An *Identify event* is typically generated by a requester calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span>

<span data-ttu-id="ffa0d-107">Lors de la création d’un document de métadonnées d’écriture, par le biais de l’interface [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) ou de l’initialisation de l’enregistreur ([**CVssWriter :: Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize)), un enregistreur doit spécifier explicitement les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="ffa0d-107">When creating a Writer Metadata Document, either through the [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) interface or through writer initialization ([**CVssWriter::Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize)), a writer must explicitly specify the following:</span></span>

-   [<span data-ttu-id="ffa0d-108">*Méthode de restauration*</span><span class="sxs-lookup"><span data-stu-id="ffa0d-108">*Restore method*</span></span>](vssgloss-r.md)
-   <span data-ttu-id="ffa0d-109">Nom de l’enregistreur</span><span class="sxs-lookup"><span data-stu-id="ffa0d-109">Writer name</span></span>
-   [<span data-ttu-id="ffa0d-110">*ID de classe de l’enregistreur*</span><span class="sxs-lookup"><span data-stu-id="ffa0d-110">*Writer class ID*</span></span>](vssgloss-w.md)
-   <span data-ttu-id="ffa0d-111">Utilisation des données ( [**voir \_ \_ type d’utilisation de VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_usage_type))</span><span class="sxs-lookup"><span data-stu-id="ffa0d-111">Data usage (see [**VSS\_USAGE\_TYPE**](/windows/desktop/api/VsWriter/ne-vswriter-vss_usage_type))</span></span>
-   <span data-ttu-id="ffa0d-112">Type de source de date (voir [**\_ \_ type de source VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_source_type))</span><span class="sxs-lookup"><span data-stu-id="ffa0d-112">Date source type (see [**VSS\_SOURCE\_TYPE**](/windows/desktop/api/VsWriter/ne-vswriter-vss_source_type))</span></span>

<span data-ttu-id="ffa0d-113">En outre, il peut également spécifier les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="ffa0d-113">In addition, it may also specify the following:</span></span>

-   <span data-ttu-id="ffa0d-114">Composants (qui peuvent éventuellement contenir des jeux de fichiers)</span><span class="sxs-lookup"><span data-stu-id="ffa0d-114">Components (which may or may not contain file sets)</span></span>
-   <span data-ttu-id="ffa0d-115">Ajouter d’autres mappages</span><span class="sxs-lookup"><span data-stu-id="ffa0d-115">Add alternate mappings</span></span>
-   <span data-ttu-id="ffa0d-116">Exclure les listes de fichiers</span><span class="sxs-lookup"><span data-stu-id="ffa0d-116">Exclude file lists</span></span>

<span data-ttu-id="ffa0d-117">Une vue d’ensemble de la création de documents de métadonnées d’enregistreur se trouve dans [actions d’écriture pendant l’initialisation](overview-of-backup-initialization.md)de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-117">An overview of Writer Metadata Document creation is found in [Writer Actions during Backup Initialization](overview-of-backup-initialization.md).</span></span>

<span data-ttu-id="ffa0d-118">Les demandeurs utilisent généralement l’une des deux méthodes pour obtenir l’accès aux métadonnées de l’enregistreur :</span><span class="sxs-lookup"><span data-stu-id="ffa0d-118">Requesters typically make use of one of two methods to obtain access to writer metadata:</span></span>

-   <span data-ttu-id="ffa0d-119">Pendant la plupart des opérations de sauvegarde, un demandeur utilise [**IVssBackupComponents :: GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) pour obtenir une instance de l’interface [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) afin d’autoriser l’accès aux métadonnées d’un writer en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-119">During most backup operations, a requester uses [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) to obtain an instance of the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface to allow access to the metadata of a currently executing writer.</span></span>
-   <span data-ttu-id="ffa0d-120">Pour les opérations de restauration ou les sauvegardes à l’aide de clichés instantanés importés (voir [importation de volumes de clichés instantanés transportables](importing-transportable-shadow-copied-volumes.md) pour plus d’informations sur l’importation des clichés instantanés), un demandeur récupère un document XML contenant les métadonnées et utilise [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) pour obtenir une interface [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) , qu’il utilise pour lire les métadonnées de restauration.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-120">For restore operations, or backups using imported shadow copies (see [Importing Transportable Shadow Copied Volumes](importing-transportable-shadow-copied-volumes.md) for more information on importing shadow copies), a requester retrieves an XML document containing the metadata and uses [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) to obtain an [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface, which it uses to read the restore metadata.</span></span>

<span data-ttu-id="ffa0d-121">Les documents de métadonnées d’écriture permettent au demandeur d’effectuer une sauvegarde pour en savoir plus sur les enregistreurs en cours d’exécution pendant la phase de découverte d’une sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-121">Writer Metadata Documents enable the requester performing a backup to learn about currently executing writers during the discovery phase of a backup.</span></span>

<span data-ttu-id="ffa0d-122">Pour les Writers choisis pour participer à une sauvegarde, un demandeur importe bien, mais pas toutes, les informations contenues dans le document des métadonnées de l’enregistreur dans son propre document sur les composants de sauvegarde pendant la phase de découverte d’une sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-122">For those writers chosen to participate in a backup, a requester imports much, but not all, of the information in the Writer Metadata Document into its own Backup Components Document during the discovery phase of a backup.</span></span>

<span data-ttu-id="ffa0d-123">Toutefois, seuls les documents de métadonnées de l’enregistreur et non le document composants de sauvegarde contiennent les spécifications de fichier et de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-123">However, only Writer Metadata Documents and not the Backup Components Document contain the file and path specifications.</span></span>

<span data-ttu-id="ffa0d-124">Pour plus d’informations sur la façon dont la phase de découverte d’une opération de sauvegarde est effectuée, consultez [vue d’ensemble de la phase de découverte de la sauvegarde](overview-of-the-backup-discovery-phase.md).</span><span class="sxs-lookup"><span data-stu-id="ffa0d-124">For more information on how the discovery phase of a backup operation is conducted, see [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md).</span></span>

<span data-ttu-id="ffa0d-125">En outre, seuls les composants [*inclus explicitement*](vssgloss-e.md) disposent de leurs informations stockées dans le document des composants de sauvegarde au cours d’une opération de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-125">In addition, only [*explicitly included*](vssgloss-e.md) components have their information stored in the Backup Components Document during a backup operation.</span></span> <span data-ttu-id="ffa0d-126">Les informations sur les composants [*inclus implicitement*](vssgloss-i.md) ne sont pas incluses dans le document des composants de sauvegarde au cours d’une opération de sauvegarde, et doivent être interpolées à l’aide d’informations sur les composants explicitement inclus et les documents de métadonnées de l’enregistreur disponibles.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-126">Information on [*implicitly included*](vssgloss-i.md) components is not included in the Backup Components Document during a backup operation, and must be interpolated using information about the explicitly included components and the available Writer Metadata Documents.</span></span>

<span data-ttu-id="ffa0d-127">Les composants inclus implicitement peuvent toujours être [*sélectionnables pour la restauration*](vssgloss-s.md) et doivent éventuellement être inclus explicitement dans le document des composants de sauvegarde au moment de la restauration.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-127">Implicitly included components may still be [*selectable for restore*](vssgloss-s.md) and may need to be explicitly included in the Backup Components Document at restore time.</span></span> <span data-ttu-id="ffa0d-128">Dans ce cas, tout comme l’ajout d’un composant pendant une opération de sauvegarde nécessitait l’accès au document de métadonnées de l’enregistreur writer’s du composant (puis récupéré à partir de l’enregistreur), un demandeur devra accéder à une copie des documents de métadonnées de l’enregistreur de ce writer, stockés au moment de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-128">In this case, just as adding a component during a backup operation required access to the component's writer's Writer Metadata Document (then retrieved from the writer), a requester will require access to a copy of that writer's Writer Metadata Documents stored at backup time.</span></span>

<span data-ttu-id="ffa0d-129">Par conséquent, la seule façon d’obtenir toutes les informations sur tous les fichiers et tous les composants impliqués dans une sauvegarde ou une restauration consiste à avoir chaque document de métadonnées de l’enregistreur pour chaque rédacteur qui participe à une sauvegarde stockée avec le document des composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ffa0d-129">Therefore, the only way to obtain all the information about all the files and components involved in a backup or restore is to have each Writer Metadata Document for each writer participating in a backup stored along with the Backup Components Document.</span></span> <span data-ttu-id="ffa0d-130">(Pour plus d’informations, consultez [vue d’ensemble de la restauration de fichiers réelle](overview-of-actual-file-restoration.md).)</span><span class="sxs-lookup"><span data-stu-id="ffa0d-130">(For more information, see [Overview of Actual File Restoration](overview-of-actual-file-restoration.md).)</span></span>

 

 



