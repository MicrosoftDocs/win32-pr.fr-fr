---
description: 'Après l’appel de IVssBackupComponents :: GatherWriterMetadata, un demandeur utilise l’instance de l’interface IVssAsync retournée à partir de cet appel pour déterminer quand tous les enregistreurs sur le système ont terminé de construire leurs documents de métadonnées d’écriture.'
ms.assetid: 04658d50-04f0-4189-8b88-ff152f1bf482
title: Vue d’ensemble de la phase de découverte de sauvegarde
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3d2d2a2d05220ecf3e25c77c18cc62b07726964f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106524605"
---
# <a name="overview-of-the-backup-discovery-phase"></a><span data-ttu-id="87d46-103">Vue d’ensemble de la phase de découverte de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="87d46-103">Overview of the Backup Discovery Phase</span></span>

<span data-ttu-id="87d46-104">Après l’appel de [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), un demandeur utilise l’instance de l’interface [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync) retournée à partir de cet appel pour déterminer quand tous les enregistreurs sur le système ont terminé de construire leurs documents de métadonnées d’écriture.</span><span class="sxs-lookup"><span data-stu-id="87d46-104">After calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), a requester uses the instance of the [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync) interface returned from this call to determine when all writers on the system have finished constructing their Writer Metadata Documents.</span></span> <span data-ttu-id="87d46-105">Pour plus d’informations, consultez [vue d’ensemble du traitement d’une sauvegarde sous VSS](overview-of-processing-a-backup-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="87d46-105">For more information, see [Overview of Processing a Backup Under VSS](overview-of-processing-a-backup-under-vss.md).</span></span>

<span data-ttu-id="87d46-106">À ce stade, le demandeur peut commencer une phase de découverte, examiner les métadonnées pour déterminer les applications en cours d’exécution et les volumes qui doivent faire l’objet de clichés instantanés pour obtenir une sauvegarde complète.</span><span class="sxs-lookup"><span data-stu-id="87d46-106">At this point, the requester can begin a discovery phase, examining metadata to determine what applications are running and which volumes must be shadow copied to get a complete backup.</span></span> <span data-ttu-id="87d46-107">Le tableau suivant présente la séquence des actions et des événements qui sont requis pour la phase de découverte de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="87d46-107">The following table shows the sequence of actions and events that are required for the backup discovery phase.</span></span>



| <span data-ttu-id="87d46-108">Action du demandeur</span><span class="sxs-lookup"><span data-stu-id="87d46-108">Requester action</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | <span data-ttu-id="87d46-109">Événement</span><span class="sxs-lookup"><span data-stu-id="87d46-109">Event</span></span> | <span data-ttu-id="87d46-110">Action d’écriture</span><span class="sxs-lookup"><span data-stu-id="87d46-110">Writer action</span></span>                                                                     |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------|-----------------------------------------------------------------------------------|
| <span data-ttu-id="87d46-111">Récupérez les documents de métadonnées de l’enregistreur (consultez [**IVssBackupComponents :: GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata), [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata)).</span><span class="sxs-lookup"><span data-stu-id="87d46-111">Retrieve Writer Metadata Documents (see [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata), [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata)).</span></span>                                                                                                                                                                                                                                                                                                                                                 | <span data-ttu-id="87d46-112">Aucun</span><span class="sxs-lookup"><span data-stu-id="87d46-112">None</span></span>  | <span data-ttu-id="87d46-113">Pendant cette période, les rédacteurs peuvent être en mesure de continuer à fonctionner normalement.</span><span class="sxs-lookup"><span data-stu-id="87d46-113">During this period, writers may be able to continue with their normal operations.</span></span> |
| <span data-ttu-id="87d46-114">Utilisez la liste des composants et leurs [*jeux de fichiers*](vssgloss-f.md), ainsi que les fichiers exclus, pour obtenir la liste des volumes et des fichiers impliqués dans la sauvegarde (voir [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent), [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc)).</span><span class="sxs-lookup"><span data-stu-id="87d46-114">Use the list of components and their [*file sets*](vssgloss-f.md), as well as excluded files, to obtain a list of volumes and files involved in the backup (see [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent), [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc)).</span></span>                                                                                                                                                                                                                                                                      | <span data-ttu-id="87d46-115">Aucune</span><span class="sxs-lookup"><span data-stu-id="87d46-115">None</span></span>  | <span data-ttu-id="87d46-116">Aucune</span><span class="sxs-lookup"><span data-stu-id="87d46-116">None</span></span>                                                                              |
| <span data-ttu-id="87d46-117">Choisissez les composants dans le document de métadonnées de l’enregistreur du writer à sauvegarder.</span><span class="sxs-lookup"><span data-stu-id="87d46-117">Choose which components in the writer's Writer Metadata Document to back up.</span></span> <span data-ttu-id="87d46-118">Appelez [**IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) pour chaque composant pour l’ajouter au document composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="87d46-118">Call [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) for each component to add it to the Backup Components Document.</span></span> <span data-ttu-id="87d46-119">(Voir [utilisation de la sélectivité pour la sauvegarde](working-with-selectability-for-backup.md) et [utilisation du document sur les composants de sauvegarde](working-with-the-backup-components-document.md).)</span><span class="sxs-lookup"><span data-stu-id="87d46-119">(See [Working with Selectability for Backup](working-with-selectability-for-backup.md) and [Working with the Backup Components Document](working-with-the-backup-components-document.md).)</span></span>                                                                                                                      | <span data-ttu-id="87d46-120">Aucune</span><span class="sxs-lookup"><span data-stu-id="87d46-120">None</span></span>  | <span data-ttu-id="87d46-121">Aucune</span><span class="sxs-lookup"><span data-stu-id="87d46-121">None</span></span>                                                                              |
| <span data-ttu-id="87d46-122">Initialiser le jeu de clichés instantanés, le contexte et vérifier les volumes pris en charge (consultez [**IVssBackupComponents :: StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset), [**IVssBackupComponents :: IsVolumeSupported**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-isvolumesupported)).</span><span class="sxs-lookup"><span data-stu-id="87d46-122">Initialize the shadow copy set, context and check for supported volumes (see [**IVssBackupComponents::StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset), [**IVssBackupComponents::IsVolumeSupported**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-isvolumesupported)).</span></span>                                                                                                                                                                                                                                                                                   | <span data-ttu-id="87d46-123">Aucune</span><span class="sxs-lookup"><span data-stu-id="87d46-123">None</span></span>  | <span data-ttu-id="87d46-124">Aucune</span><span class="sxs-lookup"><span data-stu-id="87d46-124">None</span></span>                                                                              |
| <span data-ttu-id="87d46-125">Si vous effectuez une sauvegarde sans composant, ajoutez les volumes cibles souhaités à partir du document de métadonnées de l’enregistreur au jeu de clichés instantanés en appelant [**IVssBackupComponents :: AddToSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset) pour chaque volume.</span><span class="sxs-lookup"><span data-stu-id="87d46-125">If performing a non-component backup, add the desired target volumes from the Writer Metadata Document to the shadow copy set by calling [**IVssBackupComponents::AddToSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset) for each volume.</span></span> <span data-ttu-id="87d46-126">Dans le cas contraire, pour les composants du document de métadonnées de l’enregistreur qui ont déjà été ajoutés au document des composants de sauvegarde (en appelant [**addComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent)), le demandeur doit également appeler **IVssBackupComponents :: AddToSnapshotSet** pour chaque volume affecté.</span><span class="sxs-lookup"><span data-stu-id="87d46-126">Otherwise, for the components in the Writer Metadata Document that were already added to the Backup Components Document (by calling [**AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent)), the requester must also call **IVssBackupComponents::AddToSnapshotSet** for each affected volume.</span></span> | <span data-ttu-id="87d46-127">Aucune</span><span class="sxs-lookup"><span data-stu-id="87d46-127">None</span></span>  | <span data-ttu-id="87d46-128">Aucune</span><span class="sxs-lookup"><span data-stu-id="87d46-128">None</span></span>                                                                              |



 

## <a name="writer-actions-during-the-discovery-phase"></a><span data-ttu-id="87d46-129">Actions d’écriture au cours de la phase de découverte</span><span class="sxs-lookup"><span data-stu-id="87d46-129">Writer Actions during the Discovery Phase</span></span>

<span data-ttu-id="87d46-130">Étant donné que la phase de découverte d’une sauvegarde se compose principalement d’un demandeur qui traite les informations récupérées à partir de documents de métadonnées d’écriture, il n’y a que peu d’exigences sur un writer.</span><span class="sxs-lookup"><span data-stu-id="87d46-130">Because the discovery phase of a backup consists primarily of a requester processing the information it has retrieved from Writer Metadata Documents, there are few if any requirements on a writer.</span></span>

<span data-ttu-id="87d46-131">En théorie, un enregistreur peut continuer à s’exécuter normalement à ce stade.</span><span class="sxs-lookup"><span data-stu-id="87d46-131">In theory, a writer could continue to run normally at this point.</span></span> <span data-ttu-id="87d46-132">Toutefois, il peut être souhaitable pour les rédacteurs de commencer les préparations pour les opérations de sauvegarde et de cliché instantané à venir.</span><span class="sxs-lookup"><span data-stu-id="87d46-132">However, it may be desirable for writers to begin preparations for the coming shadow copy and backup operations.</span></span>

## <a name="requester-actions-during-the-discovery-phase"></a><span data-ttu-id="87d46-133">Actions du demandeur pendant la phase de découverte</span><span class="sxs-lookup"><span data-stu-id="87d46-133">Requester Actions during the Discovery Phase</span></span>

<span data-ttu-id="87d46-134">Un demandeur utilise les objets [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) obtenus via [**IVssBackupComponents :: GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) pour itérer sur toutes les métadonnées des enregistreurs et sélectionner les Writers dont il envisage de sauvegarder les données.</span><span class="sxs-lookup"><span data-stu-id="87d46-134">A requester uses the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) objects obtained through [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) to iterate over all the writers' metadata and selecting those writers whose data it intends to back up.</span></span>

<span data-ttu-id="87d46-135">À ce stade, le demandeur doit générer une liste initiale des candidats de sauvegarde de chaque enregistreur en effectuant une itération sur les composants du writer à l’aide de [**IVssExamineWriterMetadata :: GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent).</span><span class="sxs-lookup"><span data-stu-id="87d46-135">At this point, the requester will need to generate an initial list of each writer's backup candidates by iterating over the writer's components using [**IVssExamineWriterMetadata::GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent).</span></span> <span data-ttu-id="87d46-136">Cela fournit au demandeur des objets [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) , à partir desquels vous pouvez obtenir les spécifications pour les fichiers à sauvegarder à l’aide de [**IVssWMComponent :: GetFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getfile), [**IVssWMComponent :: GetDatabaseFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabasefile)et [**IVssWMComponent :: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile).</span><span class="sxs-lookup"><span data-stu-id="87d46-136">This provides the requester with [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) objects, from which you can get the specifications for the files to be backed up using [**IVssWMComponent::GetFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getfile), [**IVssWMComponent::GetDatabaseFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabasefile), and [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile).</span></span>

<span data-ttu-id="87d46-137">Étant donné que l’objet [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) peut utiliser des caractères génériques pour stocker des informations d’emplacement de fichier, il peut être nécessaire d’utiliser des fonctions telles que [**FindFirstFile**](/windows/win32/api/fileapi/nf-fileapi-findfirstfilea), [**FindFirstFileEx**](/windows/win32/api/fileapi/nf-fileapi-findfirstfileexa)et [**FindNextFile**](/windows/win32/api/fileapi/nf-fileapi-findnextfilea).</span><span class="sxs-lookup"><span data-stu-id="87d46-137">Because the [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) object can use wildcard characters to hold file location information, it may be necessary to use functions such as [**FindFirstFile**](/windows/win32/api/fileapi/nf-fileapi-findfirstfilea), [**FindFirstFileEx**](/windows/win32/api/fileapi/nf-fileapi-findfirstfileexa), and [**FindNextFile**](/windows/win32/api/fileapi/nf-fileapi-findnextfilea).</span></span>

<span data-ttu-id="87d46-138">Tant que le cliché instantané n’est pas terminé, il est toujours possible pour les rédacteurs d’ajouter ou de supprimer des fichiers sur le disque au cours normal de leur travail. vous ne devez donc pas générer la liste réelle des fichiers à sauvegarder pour l’instant.</span><span class="sxs-lookup"><span data-stu-id="87d46-138">Until the shadow copy has been completed, it is still possible for writers to add or remove files from disk in the normal course of their work, so you should not generate the actual list of files to be backed up at this time.</span></span>

<span data-ttu-id="87d46-139">Au lieu de cela, vous trouverez la liste initiale des fichiers et volumes à sauvegarder à ce stade en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="87d46-139">Instead, the initial list of files and volumes to be backed up is found at this point by doing the following:</span></span>

1.  <span data-ttu-id="87d46-140">L’examen de tous les composants sélectionnables pour la sauvegarde et les composants non sélectionnables dans le document de métadonnées d’écriture de chaque enregistreur (à l’aide de [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata)) et leur organisation dans des [*jeux de composants*](vssgloss-c.md) utilisent le [*chemin logique*](vssgloss-l.md) (voir [utilisation de la sélectivité et des chemins logiques](working-with-selectability-and-logical-paths.md))</span><span class="sxs-lookup"><span data-stu-id="87d46-140">Examining all selectable for backup and nonselectable components in each writer's Writer Metadata Document (using [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata)) and organizing them into [*component sets*](vssgloss-c.md) use [*logical path*](vssgloss-l.md) (see [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md))</span></span>
2.  <span data-ttu-id="87d46-141">[*Inclusion explicite*](vssgloss-e.md) de tous les composants requis (non sélectionnables pour les composants de sauvegarde sans sélection pour les ancêtres de sauvegarde) dans le document des composants de sauvegarde à l’aide de [ **IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent)</span><span class="sxs-lookup"><span data-stu-id="87d46-141">[*Including explicitly*](vssgloss-e.md) all required components (nonselectable for backup components without selectable for backup ancestors) in the Backup Components Document using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent)</span></span>
3.  <span data-ttu-id="87d46-142">Choisir d’inclure explicitement sélectionnables facultatifs pour les composants de sauvegarde qui ne définissent pas un jeu de composants (à l’aide de [**IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent))</span><span class="sxs-lookup"><span data-stu-id="87d46-142">Choosing to explicitly include optional selectable for backup components that do not define a component set (using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent))</span></span>
4.  <span data-ttu-id="87d46-143">Sélection [*de jeux de composants*](vssgloss-c.md) pour la participation à une sauvegarde en ajoutant explicitement leur élément pouvant être défini pour la sauvegarde (à l’aide de [**IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent)), qui [*comprend implicitement*](vssgloss-i.md) les sous- [*composants*](vssgloss-s.md)de l’ensemble de composants.</span><span class="sxs-lookup"><span data-stu-id="87d46-143">Selecting [*component sets*](vssgloss-c.md) for participation in a backup by explicitly adding their defining selectable for backup component (using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent)), which [*implicitly includes*](vssgloss-i.md) the component set's [*subcomponents*](vssgloss-s.md).</span></span>
5.  <span data-ttu-id="87d46-144">À l’aide des informations du [*jeu de fichiers*](vssgloss-f.md) dans le document des métadonnées de l’enregistreur des enregistreurs sélectionnés et des fonctions de gestion du volume, un demandeur détermine les chemins d’accès des fichiers à sauvegarder et les volumes dont les clichés instantanés doivent être copiés.</span><span class="sxs-lookup"><span data-stu-id="87d46-144">Using [*file set*](vssgloss-f.md) information in the selected writers' Writer Metadata Document and volume management functions, a requester determines the paths of files to be backed up and the volumes that will need to be shadow copied</span></span>

<span data-ttu-id="87d46-145">Notez que seuls les composants inclus explicitement (à l’aide de [**IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent)) dans la sauvegarde et dans le document composants de sauvegarde auront des instances de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) ajoutées à ce document.</span><span class="sxs-lookup"><span data-stu-id="87d46-145">Note that only the components explicitly included (using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent)) in the backup and in the Backup Components Document will have instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface added to that document.</span></span> <span data-ttu-id="87d46-146">Ces instances sont utilisées pour examiner et modifier les paramètres des composants inclus explicitement et des sous-composants inclus implicitement (voir [sélectivité et utilisation des propriétés de composant](selectability-and-working-with-component-properties.md)).</span><span class="sxs-lookup"><span data-stu-id="87d46-146">These instances will be used to examine and modify component settings for both explicitly included components and any of their implicitly included subcomponents (see [Selectability and Working with Component Properties](selectability-and-working-with-component-properties.md)).</span></span>

<span data-ttu-id="87d46-147">Si un writer comprend l’un des composants d’un enregistreur, il doit ajouter tous ses composants requis.</span><span class="sxs-lookup"><span data-stu-id="87d46-147">If a writer includes any of a writer's components, it must add all of its required components.</span></span> <span data-ttu-id="87d46-148">Toutefois, un demandeur est également libre d’ignorer complètement tous les jeux de composants d’un enregistreur.</span><span class="sxs-lookup"><span data-stu-id="87d46-148">However, a requester is also free to entirely skip all of a writer's component sets.</span></span> <span data-ttu-id="87d46-149">Si aucun des composants d’un enregistreur n’est explicitement sélectionné, le Writer n’est pas sélectionné et VSS empêche ce writer de participer au reste de l’opération de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="87d46-149">If none of a writer's components are explicitly selected, the writer is not selected, and VSS inhibits that writer from participating in the rest of the backup operation.</span></span>

<span data-ttu-id="87d46-150">Le demandeur initie le jeu de clichés instantanés qui contiendra les volumes sélectionnés en appelant [**IVssBackupComponents :: StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset).</span><span class="sxs-lookup"><span data-stu-id="87d46-150">The requester initiates the shadow copy set that will contain the selected volumes by calling [**IVssBackupComponents::StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset).</span></span>

<span data-ttu-id="87d46-151">Si le volume peut participer à un cliché instantané (qui peut être vérifié avec [**IVssBackupComponents :: IsVolumeSupported**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-isvolumesupported)), le demandeur peut ajouter ce volume au jeu de clichés instantanés à l’aide de [**IVssBackupComponents :: AddToSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="87d46-151">If the volume can participate in a shadow copy (which can be checked with [**IVssBackupComponents::IsVolumeSupported**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-isvolumesupported)), the requester can add that volume to the shadow copy set using [**IVssBackupComponents::AddToSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset).</span></span>

<span data-ttu-id="87d46-152">Bien qu’il ne soit généralement pas utile, un demandeur peut parfois également choisir le [*fournisseur*](vssgloss-p.md) qui maintiendra le cliché instantané pour un volume donné (pour plus d’informations, consultez [sélection de fournisseurs](selecting-providers.md) ).</span><span class="sxs-lookup"><span data-stu-id="87d46-152">Although it is not generally useful, a requester can sometimes also choose which [*provider*](vssgloss-p.md) will maintain the shadow copy for a given volume (see [Selecting Providers](selecting-providers.md) for details).</span></span>

<span data-ttu-id="87d46-153">Une attention particulière doit être accordée au traitement d’un volume contenant des dossiers montés ou des points d’analyse.</span><span class="sxs-lookup"><span data-stu-id="87d46-153">Care should be given to the handling of a volume containing mounted folders or reparse points.</span></span> <span data-ttu-id="87d46-154">Un dossier monté ou un point d’analyse peut apparaître dans un cliché instantané et peut être sauvegardé.</span><span class="sxs-lookup"><span data-stu-id="87d46-154">A mounted folder or reparse point can appear in a shadow copy and can be backed up.</span></span> <span data-ttu-id="87d46-155">Toutefois, un dossier monté ou un point d’analyse ne peut pas être parcouru sur le volume des clichés instantanés (voir [utilisation des dossiers montés et des points d’analyse](working-with-reparse-and-mount-points.md)).</span><span class="sxs-lookup"><span data-stu-id="87d46-155">However, a mounted folder or reparse point cannot be traversed on the shadow copied volume (see [Working with Mounted Folders and Reparse Points](working-with-reparse-and-mount-points.md)).</span></span>

<span data-ttu-id="87d46-156">À ce stade de la sauvegarde, le document des composants de sauvegarde est initialisé et rempli.</span><span class="sxs-lookup"><span data-stu-id="87d46-156">At this point in the backup, the Backup Components Document is initialized and filled.</span></span> <span data-ttu-id="87d46-157">Dans les opérations futures, les rédacteurs et les demandeurs peuvent utiliser l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) pour communiquer entre eux.</span><span class="sxs-lookup"><span data-stu-id="87d46-157">In future operations, writers and requesters can use the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface to communicate with each other.</span></span>

<span data-ttu-id="87d46-158">Les enregistreurs ont accès à l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) lors du traitement des événements [*PrepareForBackup*](vssgloss-p.md), [*PostSnapshot*](vssgloss-p.md)et [*BackupComplete*](vssgloss-b.md) .</span><span class="sxs-lookup"><span data-stu-id="87d46-158">Writers are given access to the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface when handling the [*PrepareForBackup*](vssgloss-p.md), [*PostSnapshot*](vssgloss-p.md), and [*BackupComplete*](vssgloss-b.md) events.</span></span>

 

 
