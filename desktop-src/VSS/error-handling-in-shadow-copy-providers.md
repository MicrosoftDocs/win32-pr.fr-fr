---
description: 'VSS permet l’existence de nombreux clichés instantanés à la fois, mais il n’autorise qu’une seule création de jeu de clichés instantanés en cours entre l’appel à IVssBackupComponents :: StartSnapshotSet et le retour de l’appel à IVssBackupComponents ::D oSnapshotSet.'
ms.assetid: 26657fc2-180f-4ebb-820c-2159e7fe7584
title: Gestion des erreurs dans les fournisseurs de clichés instantanés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5f040526f63a0fe57fc5a49ac903e8b60b76646
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106539731"
---
# <a name="error-handling-in-shadow-copy-providers"></a><span data-ttu-id="43407-103">Gestion des erreurs dans les fournisseurs de clichés instantanés</span><span class="sxs-lookup"><span data-stu-id="43407-103">Error Handling in Shadow Copy Providers</span></span>

<span data-ttu-id="43407-104">VSS permet l’existence de nombreux clichés instantanés à la fois, mais il n’autorise qu’une seule création de jeu de clichés instantanés en cours entre l’appel à [**IVssBackupComponents :: StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) et le retour de l’appel à [**IVssBackupComponents ::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="43407-104">VSS allows many shadow copies to exist at once, but it only allows one shadow copy set creation to be in-progress between the call to [**IVssBackupComponents::StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) and the return from the call to [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span>

## <a name="no-partial-commit"></a><span data-ttu-id="43407-105">Aucune validation partielle</span><span class="sxs-lookup"><span data-stu-id="43407-105">No Partial Commit</span></span>

<span data-ttu-id="43407-106">Si un fournisseur échoue sur un volume ou un numéro d’unité logique du jeu de clichés instantanés, la création du jeu de clichés instantanés entier échoue.</span><span class="sxs-lookup"><span data-stu-id="43407-106">If any provider fails a shadow copy on any volume or LUN in the shadow copy set, then the creation of the entire shadow copy set fails.</span></span> <span data-ttu-id="43407-107">C'est la procédure normale.</span><span class="sxs-lookup"><span data-stu-id="43407-107">This is by design.</span></span> <span data-ttu-id="43407-108">Cette conception simplifie les problèmes de comportement associés à la sémantique de défaillance partielle et conserve un point dans le temps cohérent pour tous les clichés instantanés de l’ensemble.</span><span class="sxs-lookup"><span data-stu-id="43407-108">This design simplifies the behavioral issues associated with partial failure semantics and maintains a consistent point-in-time across all shadow copies in the set.</span></span>

## <a name="reporting-fault-conditions"></a><span data-ttu-id="43407-109">Signalement des conditions d’erreur</span><span class="sxs-lookup"><span data-stu-id="43407-109">Reporting Fault Conditions</span></span>

<span data-ttu-id="43407-110">Si une erreur de fournisseur ou une condition d’erreur se produit, le fournisseur doit consigner une erreur dans le journal des événements de l’application.</span><span class="sxs-lookup"><span data-stu-id="43407-110">If a provider error or fault condition occurs, the provider must log an error to the Application event log.</span></span> <span data-ttu-id="43407-111">Cela comprend, sans s’y limiter, les erreurs spécifiques au fournisseur lors de la création ou de l’importation d’un jeu de clichés instantanés, ou l’échec d’allocation de ressources pour le cliché instantané de copie sur écriture après la création.</span><span class="sxs-lookup"><span data-stu-id="43407-111">This includes, but is not limited to, any provider-specific errors when creating or importing a Shadow Copy Set, or resource allocation failure for copy-on-write shadow copy after creation.</span></span> <span data-ttu-id="43407-112">Cette journalisation ne doit pas avoir lieu au moment où les volumes dans le jeu de clichés instantanés sont dans un état figé.</span><span class="sxs-lookup"><span data-stu-id="43407-112">This logging must not take place during the time the volumes in the shadow copy set are in a frozen state.</span></span>

## <a name="valid-provider-return-values"></a><span data-ttu-id="43407-113">Valeurs de retour de fournisseur valides</span><span class="sxs-lookup"><span data-stu-id="43407-113">Valid Provider Return Values</span></span>

<span data-ttu-id="43407-114">Le tableau suivant répertorie les codes de retour valides pour les méthodes de fournisseur et leurs significations.</span><span class="sxs-lookup"><span data-stu-id="43407-114">The following table lists the valid return codes for provider methods and their meanings.</span></span>



| <span data-ttu-id="43407-115">Valeur</span><span class="sxs-lookup"><span data-stu-id="43407-115">Value</span></span>                                                                                                                                                                              | <span data-ttu-id="43407-116">Description</span><span class="sxs-lookup"><span data-stu-id="43407-116">Description</span></span>                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="43407-117"><span id="S_OK"></span><span id="s_ok"></span>\_OK</span><span class="sxs-lookup"><span data-stu-id="43407-117"><span id="S_OK"></span><span id="s_ok"></span>S\_OK</span></span><br/>                                                                                                                     | <span data-ttu-id="43407-118">La méthode a réussi.</span><span class="sxs-lookup"><span data-stu-id="43407-118">The method was successful.</span></span><br/>                                                                                                                                                                                                                  |
| <span data-ttu-id="43407-119"><span id="E_OUTOFMEMORY"></span><span id="e_outofmemory"></span>\_OUTOFMEMORY E</span><span class="sxs-lookup"><span data-stu-id="43407-119"><span id="E_OUTOFMEMORY"></span><span id="e_outofmemory"></span>E\_OUTOFMEMORY</span></span><br/>                                                                                          | <span data-ttu-id="43407-120">Le fournisseur ne dispose pas de suffisamment de mémoire ou d’autres ressources système.</span><span class="sxs-lookup"><span data-stu-id="43407-120">The provider is out of memory or other system resources.</span></span><br/>                                                                                                                                                                                    |
| <span data-ttu-id="43407-121"><span id="E_INVALIDARG"></span><span id="e_invalidarg"></span>E \_ INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="43407-121"><span id="E_INVALIDARG"></span><span id="e_invalidarg"></span>E\_INVALIDARG</span></span><br/>                                                                                             | <span data-ttu-id="43407-122">L’une des valeurs de paramètre n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="43407-122">One of the parameter values is not valid.</span></span><br/>                                                                                                                                                                                                   |
| <span data-ttu-id="43407-123"><span id="E_ACCESSDENIED"></span><span id="e_accessdenied"></span>\_ACCESSDENIED E</span><span class="sxs-lookup"><span data-stu-id="43407-123"><span id="E_ACCESSDENIED"></span><span id="e_accessdenied"></span>E\_ACCESSDENIED</span></span><br/>                                                                                       | <span data-ttu-id="43407-124">Un client non privilégié a tenté d’appeler le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="43407-124">A non-privileged client has tried to call into the provider.</span></span><br/>                                                                                                                                                                                |
| <span data-ttu-id="43407-125"><span id="VSS_E_BAD_STATE"></span><span id="vss_e_bad_state"></span>\_ \_ état incorrect de VSS E \_</span><span class="sxs-lookup"><span data-stu-id="43407-125"><span id="VSS_E_BAD_STATE"></span><span id="vss_e_bad_state"></span>VSS\_E\_BAD\_STATE</span></span><br/>                                                                                  | <span data-ttu-id="43407-126">Aucun fournisseur ne prend en charge l’opération demandée ou l’opération ne peut pas être effectuée sur l’objet, car l’objet n’est pas dans l’état correct.</span><span class="sxs-lookup"><span data-stu-id="43407-126">Either no provider supports the requested operation, or the operation cannot be performed on the object because the object is not in the correct state.</span></span><br/>                                                                                     |
| <span data-ttu-id="43407-127"><span id="VSS_E_OBJECT_NOT_FOUND"></span><span id="vss_e_object_not_found"></span>\_objet VSS \_ E \_ \_ introuvable</span><span class="sxs-lookup"><span data-stu-id="43407-127"><span id="VSS_E_OBJECT_NOT_FOUND"></span><span id="vss_e_object_not_found"></span>VSS\_E\_OBJECT\_NOT\_FOUND</span></span><br/>                                                            | <span data-ttu-id="43407-128">Un paramètre fait référence à un objet qui est introuvable (par exemple, un ID de cliché instantané, un ID de jeu de clichés instantanés ou un volume).</span><span class="sxs-lookup"><span data-stu-id="43407-128">A parameter refers to an object that was not found (such as a shadow copy ID, shadow copy set ID, or volume.)</span></span><br/>                                                                                                                               |
| <span data-ttu-id="43407-129"><span id="VSS_E_INSUFFICIENT_STORAGE"></span><span id="vss_e_insufficient_storage"></span>VSS \_ E \_ stockage insuffisant \_</span><span class="sxs-lookup"><span data-stu-id="43407-129"><span id="VSS_E_INSUFFICIENT_STORAGE"></span><span id="vss_e_insufficient_storage"></span>VSS\_E\_INSUFFICIENT\_STORAGE</span></span><br/>                                                 | <span data-ttu-id="43407-130">Le fournisseur ne peut pas effectuer l’opération, car l’espace disque est insuffisant.</span><span class="sxs-lookup"><span data-stu-id="43407-130">The provider cannot perform the operation because there is not enough disk space.</span></span><br/>                                                                                                                                                           |
| <span data-ttu-id="43407-131"><span id="VSS_E_VOLUME_NOT_SUPPORTED"></span><span id="vss_e_volume_not_supported"></span>\_volume E \_ VSS \_ non \_ pris en charge</span><span class="sxs-lookup"><span data-stu-id="43407-131"><span id="VSS_E_VOLUME_NOT_SUPPORTED"></span><span id="vss_e_volume_not_supported"></span>VSS\_E\_VOLUME\_NOT\_SUPPORTED</span></span><br/>                                                | <span data-ttu-id="43407-132">Aucun fournisseur sur cet ordinateur ne prend en charge l’opération demandée sur le volume.</span><span class="sxs-lookup"><span data-stu-id="43407-132">No provider on this computer supports the requested operation on the volume.</span></span><br/>                                                                                                                                                                |
| <span data-ttu-id="43407-133"><span id="VSS_E_VOLUME_NOT_SUPPORTED_BY_PROVIDER"></span><span id="vss_e_volume_not_supported_by_provider"></span>\_volume E \_ VSS \_ non \_ pris en charge \_ par le \_ fournisseur</span><span class="sxs-lookup"><span data-stu-id="43407-133"><span id="VSS_E_VOLUME_NOT_SUPPORTED_BY_PROVIDER"></span><span id="vss_e_volume_not_supported_by_provider"></span>VSS\_E\_VOLUME\_NOT\_SUPPORTED\_BY\_PROVIDER</span></span><br/>          | <span data-ttu-id="43407-134">Le fournisseur ne prend pas en charge le volume.</span><span class="sxs-lookup"><span data-stu-id="43407-134">The provider does not support the volume.</span></span><br/>                                                                                                                                                                                                   |
| <span data-ttu-id="43407-135"><span id="VSS_E_MAXIMUM_NUMBER_OF_SNAPSHOTS_REACHED"></span><span id="vss_e_maximum_number_of_snapshots_reached"></span>\_ \_ \_ nombre maximal \_ de \_ captures instantanées de \_ VSS E atteint</span><span class="sxs-lookup"><span data-stu-id="43407-135"><span id="VSS_E_MAXIMUM_NUMBER_OF_SNAPSHOTS_REACHED"></span><span id="vss_e_maximum_number_of_snapshots_reached"></span>VSS\_E\_MAXIMUM\_NUMBER\_OF\_SNAPSHOTS\_REACHED</span></span><br/> | <span data-ttu-id="43407-136">Le fournisseur a atteint le nombre maximal de clichés instantanés qu’il peut prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="43407-136">The provider has reached the maximum number of shadow copies that it can support.</span></span><br/>                                                                                                                                                           |
| <span data-ttu-id="43407-137"><span id="VSS_E_PROVIDER_VETO"></span><span id="vss_e_provider_veto"></span>\_veto du \_ fournisseur VSS E \_</span><span class="sxs-lookup"><span data-stu-id="43407-137"><span id="VSS_E_PROVIDER_VETO"></span><span id="vss_e_provider_veto"></span>VSS\_E\_PROVIDER\_VETO</span></span><br/>                                                                      | <span data-ttu-id="43407-138">Le fournisseur a rencontré une erreur d’exécution interne qui n’est pas mappée à une autre valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="43407-138">The provider has encountered an internal run-time error that does not map to another return value.</span></span> <span data-ttu-id="43407-139">Le fournisseur doit également écrire un événement dans le journal des événements de l’application pour fournir à l’utilisateur des informations sur la façon de résoudre ce problème.</span><span class="sxs-lookup"><span data-stu-id="43407-139">The provider must also write an event into the Application event log providing the user with information on how to resolve this problem.</span></span><br/> |
| <span data-ttu-id="43407-140"><span id="VSS_E_CANNOT_REVERT_DISKID"></span><span id="vss_e_cannot_revert_diskid"></span>VSS \_ E \_ ne peut pas \_ rétablir le \_ dépatinage</span><span class="sxs-lookup"><span data-stu-id="43407-140"><span id="VSS_E_CANNOT_REVERT_DISKID"></span><span id="vss_e_cannot_revert_diskid"></span>VSS\_E\_CANNOT\_REVERT\_DISKID</span></span><br/>                                                | <span data-ttu-id="43407-141">La signature MBR ou l’ID GPT d’un ou plusieurs disques n’a pas pu être défini sur la valeur demandée.</span><span class="sxs-lookup"><span data-stu-id="43407-141">The MBR signature or GPT ID for one or more disks could not be set to the requested value.</span></span> <span data-ttu-id="43407-142">Pour plus d’informations, consultez le journal des événements d’application.</span><span class="sxs-lookup"><span data-stu-id="43407-142">Check the Application event log for more information.</span></span><br/>                                                                                            |



 

<span data-ttu-id="43407-143">Le fournisseur ne doit pas tenter de retourner d’autres codes d’erreur.</span><span class="sxs-lookup"><span data-stu-id="43407-143">The provider should not attempt to return any other error codes.</span></span>

<span data-ttu-id="43407-144">Si le fournisseur retourne un code d’erreur qui n’est pas attendu (par exemple, a la **\_ valeur false**, **e \_ Fail**, **e \_ inattendue** ou **e \_ Abort**), VSS écrit un événement dans le journal des événements en mentionnant le fournisseur et la méthode qui a échoué, et convertit l’erreur en **\_ erreur VSS E \_ inattendue du \_ fournisseur \_** avant de retourner au demandeur.</span><span class="sxs-lookup"><span data-stu-id="43407-144">If the provider returns an error code that is not expected (for example **S\_FALSE**, **E\_FAIL**, **E\_UNEXPECTED**, or **E\_ABORT**), VSS writes an event into the event log mentioning the provider and failed method and translates the error to **VSS\_E\_UNEXPECTED\_PROVIDER\_ERROR** before returning to the requester.</span></span> <span data-ttu-id="43407-145">Cela n’est pas effectué pour les retours de [**IVssProviderCreateSnapshotSet :: AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) ou [**IVssProviderNotifications :: OnUnload**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidernotifications-onunload).</span><span class="sxs-lookup"><span data-stu-id="43407-145">This is not done for any returns from [**IVssProviderCreateSnapshotSet::AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) or [**IVssProviderNotifications::OnUnload**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidernotifications-onunload).</span></span>

 

 




