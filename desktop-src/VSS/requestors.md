---
description: Un demandeur est une application qui utilise l’API VSS (plus précisément l’interface IVssBackupComponents) pour demander les services de la Service VSS de créer et gérer des clichés instantanés et des jeux de clichés instantanés d’un ou de plusieurs volumes.
ms.assetid: e49920d0-5b66-4aa1-b3ca-641629df5f8a
title: Requesters
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b676b8cd287365b257e3b6ee85a7e47a70f88ef3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104202382"
---
# <a name="requesters"></a><span data-ttu-id="df4d1-103">Requesters</span><span class="sxs-lookup"><span data-stu-id="df4d1-103">Requesters</span></span>

<span data-ttu-id="df4d1-104">Un [*demandeur*](vssgloss-r.md) est une application qui utilise l’API VSS (plus précisément l’interface [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) ) pour demander les services de la service VSS de créer et gérer des clichés instantanés et des jeux de clichés instantanés d’un ou de plusieurs volumes.</span><span class="sxs-lookup"><span data-stu-id="df4d1-104">A [*requester*](vssgloss-r.md) is any application that uses the VSS API (specifically the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface) to request the services of the Volume Shadow Copy Service to create and manage shadow copies and shadow copy sets of one or more volumes.</span></span>

<span data-ttu-id="df4d1-105">L’exemple le plus courant d’un demandeur (et le seul qui est traité dans cette documentation) est une application de sauvegarde/restauration prenant en charge VSS, qui utilise des données copiées en miroir comme source stable pour ses opérations de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="df4d1-105">The most typical example of a requester (and the only one addressed in this documentation) is a VSS-aware backup/restore application, which uses shadow-copied data as a stable source for its backup operations.</span></span>

<span data-ttu-id="df4d1-106">En plus d’initier des clichés instantanés, les applications de demandeurs de sauvegarde/récupération communiquent avec les producteurs de données (rédacteurs) pour collecter des informations sur le système et pour signaler aux rédacteurs de préparer leurs données pour la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="df4d1-106">In addition to initiating shadow copies, backup/recover requester applications communicate with data producers (writers) to gather information on the system and to signal writers to prepare their data for backup.</span></span>

## <a name="requester-state"></a><span data-ttu-id="df4d1-107">État du demandeur</span><span class="sxs-lookup"><span data-stu-id="df4d1-107">Requester State</span></span>

<span data-ttu-id="df4d1-108">Un demandeur conserve ses informations d’État dans un objet de métadonnées XML appelé le document sur les composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="df4d1-108">A requester maintains its state information in an XML-based metadata object called the Backup Components Document.</span></span> <span data-ttu-id="df4d1-109">Les métadonnées du demandeur sont nécessaires, mais pas suffisantes pour permettre à un demandeur de sauvegarder, puis de restaurer un système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="df4d1-109">The requester metadata is necessary, but not sufficient to allow a requester to back up and then restore a file system.</span></span> <span data-ttu-id="df4d1-110">Les raisons sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="df4d1-110">The reasons for this are the following:</span></span>

-   <span data-ttu-id="df4d1-111">Au cours d’une opération de sauvegarde, seul un sous-ensemble de tous les composants impliqués dans la sauvegarde (non [*sélectionnables pour*](vssgloss-s.md) les composants de sauvegarde sans sélectionnable pour les ancêtres de sauvegarde et sélectionnables pour les composants de sauvegarde [*inclus explicitement*](vssgloss-e.md) dans la sauvegarde) a vu leurs informations ajoutées au document des composants de sauvegarde du demandeur.</span><span class="sxs-lookup"><span data-stu-id="df4d1-111">During a backup operation, only a subset of all the components involved in the backup—[*nonselectable for backup*](vssgloss-s.md) components without selectable for backup ancestors and selectable for backup components that have been [*included explicitly*](vssgloss-e.md) in the backup—have had their information added to the requester's Backup Components Document.</span></span>
-   <span data-ttu-id="df4d1-112">Les informations, même pour les composants ajoutés au document des composants de sauvegarde sont incomplètes, les spécifications de fichier et de chemin d’accès ne sont pas incluses.</span><span class="sxs-lookup"><span data-stu-id="df4d1-112">The information even for those components added to the Backup Components Document is incomplete—file and path specifications are not included.</span></span>
-   <span data-ttu-id="df4d1-113">Pendant les opérations de restauration, un composant [*inclus implicitement*](vssgloss-i.md) dans la sauvegarde peut être [*sélectionnable pour la restauration*](vssgloss-s.md) et peut donc être inclus explicitement dans la restauration.</span><span class="sxs-lookup"><span data-stu-id="df4d1-113">During restore operations, a component [*implicitly included*](vssgloss-i.md) in the backup may be [*selectable for restore*](vssgloss-s.md) and therefore can be explicitly included in the restore.</span></span> <span data-ttu-id="df4d1-114">Cela nécessite la mise à jour du document des composants de sauvegarde du demandeur avec les informations des copies stockées du document des métadonnées de l’enregistreur d’un writer.</span><span class="sxs-lookup"><span data-stu-id="df4d1-114">This will require the updating of the requester's Backup Components Document with information from stored copies of a writer's Writer Metadata Document.</span></span>

<span data-ttu-id="df4d1-115">Pour permettre la spécification complète d’une opération de sauvegarde ou de restauration, l’API VSS permet au demandeur d’interroger les métadonnées des enregistreurs en cours d’exécution (pendant les sauvegardes) ou d’examiner les métadonnées de l’enregistreur stocké (pendant les restaurations).</span><span class="sxs-lookup"><span data-stu-id="df4d1-115">To allow for full specification of a backup or restore operation, the VSS API allows the requester to query running writers' metadata (during backups) or examine stored writer metadata (during restores).</span></span> <span data-ttu-id="df4d1-116">En outre, un enregistreur peut modifier les informations sur les composants dans le document des composants de sauvegarde au cours d’une opération de sauvegarde ou de restauration.</span><span class="sxs-lookup"><span data-stu-id="df4d1-116">In addition, a writer can modify component information in the Backup Components Document in the course of a backup or restore operation.</span></span>

<span data-ttu-id="df4d1-117">À l’aide des informations sur les composants qui ont été sélectionnés pour la sauvegarde et la restauration et les règles relatives à la sélection des composants (pour plus d’informations, voir Configuration de l' [Organisation des composants](definition-of-components-by-writers.md) et [utilisation de la sélectivité et des chemins logiques](working-with-selectability-and-logical-paths.md)), un demandeur peut déterminer les fichiers dont il a besoin pour la sauvegarde ou la restauration, et où il peut trouver ces fichiers.</span><span class="sxs-lookup"><span data-stu-id="df4d1-117">Using the information about which components have been selected for backup and restore and the rules regarding component selection (for more information, see [Setting up Component Organization](definition-of-components-by-writers.md) and [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md)), a requester can determine which files of which writer it needs to back up or restore, and where it can find those files.</span></span>

<span data-ttu-id="df4d1-118">Dans le cadre d’une sauvegarde, les métadonnées du demandeur et de l’enregistreur doivent être stockées pour pouvoir être utilisées dans la restauration.</span><span class="sxs-lookup"><span data-stu-id="df4d1-118">As part of a backup, both requester and writer metadata must be stored so that it can be used in the restore.</span></span> <span data-ttu-id="df4d1-119">Inversement, les opérations de restauration requièrent la récupération des anciens composants de sauvegarde et des documents de métadonnées d’écriture pour obtenir des instructions complètes sur la restauration des fichiers.</span><span class="sxs-lookup"><span data-stu-id="df4d1-119">Conversely, restore operations require the retrieval of the old Backup Components and Writer Metadata Documents to obtain full instructions on restoring files.</span></span>

## <a name="requester-interprocess-communication"></a><span data-ttu-id="df4d1-120">Communication interprocessus du demandeur</span><span class="sxs-lookup"><span data-stu-id="df4d1-120">Requester Interprocess Communication</span></span>

<span data-ttu-id="df4d1-121">Le demandeur conserve le contrôle des opérations de sauvegarde et de restauration VSS en générant des événements COM via différents appels dans l’API du demandeur.</span><span class="sxs-lookup"><span data-stu-id="df4d1-121">The requester maintains control over VSS backup and restore operations by generating COM events through various calls in the requester API.</span></span> <span data-ttu-id="df4d1-122">Ces appels peuvent effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="df4d1-122">These calls can do the following:</span></span>

-   <span data-ttu-id="df4d1-123">Effectuer des demandes des fournisseurs, par exemple, [**IVssBackupComponents ::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) oblige le fournisseur à créer un cliché instantané du volume sélectionné.</span><span class="sxs-lookup"><span data-stu-id="df4d1-123">Make requests of the providers, for example, [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) causes the provider to create a shadow copy of the selected volume.</span></span>
-   <span data-ttu-id="df4d1-124">Déclenchez les enregistreurs pour retourner des informations, par exemple, [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) permet au demandeur d’obtenir le document de métadonnées d’écriture de chaque Writer.</span><span class="sxs-lookup"><span data-stu-id="df4d1-124">Trigger the writers to return information, for example, [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) enables the requester to obtain each writer's Writer Metadata Document.</span></span>
-   <span data-ttu-id="df4d1-125">Demandez aux rédacteurs de préparer ou de gérer les différentes phases du cliché instantané et des opérations de sauvegarde, par exemple, [**IVssBackupComponents ::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) signale les Writers à configurer pour le gel des e/s.</span><span class="sxs-lookup"><span data-stu-id="df4d1-125">Require writers to prepare for or handle various phases of the shadow copy and backup operations, for example, [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) signals writers to set up for the I/O freeze.</span></span>

<span data-ttu-id="df4d1-126">Un demandeur reçoit des informations des enregistreurs par le biais de documents de métadonnées de l’enregistreur en direct ou stocké et à l’aide de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , que l’enregistreur peut mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="df4d1-126">A requester receives information from the writers through live or stored Writer Metadata Documents and through the use of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, which the writer can update.</span></span>

## <a name="life-cycle-of-a-requester-during-backup"></a><span data-ttu-id="df4d1-127">Cycle de vie d’un demandeur pendant la sauvegarde</span><span class="sxs-lookup"><span data-stu-id="df4d1-127">Life Cycle of a Requester during Backup</span></span>

<span data-ttu-id="df4d1-128">Voici un résumé du cycle de vie du demandeur pour la sauvegarde :</span><span class="sxs-lookup"><span data-stu-id="df4d1-128">The following is a summary of the requester life cycle for backup:</span></span>

1.  <span data-ttu-id="df4d1-129">Instancier et initialiser des interfaces API VSS.</span><span class="sxs-lookup"><span data-stu-id="df4d1-129">Instantiate and initialize VSS API interfaces.</span></span>
2.  <span data-ttu-id="df4d1-130">Contacter les auteurs et récupérer leurs informations.</span><span class="sxs-lookup"><span data-stu-id="df4d1-130">Contact writers and retrieve their information.</span></span>
3.  <span data-ttu-id="df4d1-131">Choisissez les données à sauvegarder.</span><span class="sxs-lookup"><span data-stu-id="df4d1-131">Choose data to back up.</span></span>
4.  <span data-ttu-id="df4d1-132">Demandez un cliché instantané du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="df4d1-132">Request a shadow copy of the provider.</span></span>
5.  <span data-ttu-id="df4d1-133">Sauvegardez les données.</span><span class="sxs-lookup"><span data-stu-id="df4d1-133">Back up the data.</span></span>
6.  <span data-ttu-id="df4d1-134">Libérez l’interface et le cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="df4d1-134">Release the interface and the shadow copy.</span></span>

## <a name="life-cycle-of-a-requester-during-restore"></a><span data-ttu-id="df4d1-135">Cycle de vie d’un demandeur pendant la restauration</span><span class="sxs-lookup"><span data-stu-id="df4d1-135">Life Cycle of a Requester during Restore</span></span>

<span data-ttu-id="df4d1-136">Le cycle de vie de restauration ne nécessite pas de cliché instantané, mais nécessite toujours la coopération de l’enregistreur :</span><span class="sxs-lookup"><span data-stu-id="df4d1-136">The restore life cycle does not require a shadow copy, but still requires writer cooperation:</span></span>

1.  <span data-ttu-id="df4d1-137">Instanciez les interfaces API VSS.</span><span class="sxs-lookup"><span data-stu-id="df4d1-137">Instantiate VSS API interfaces.</span></span>
2.  <span data-ttu-id="df4d1-138">Initialisez le demandeur pour l’opération de restauration en chargeant un document de composants de sauvegarde stocké.</span><span class="sxs-lookup"><span data-stu-id="df4d1-138">Initialize the requester for the restore operation by loading a stored Backup Components Document.</span></span>
3.  <span data-ttu-id="df4d1-139">Récupérez les métadonnées de l’enregistreur stocké et les documents des composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="df4d1-139">Retrieve stored Writer Metadata and Backup Components Documents.</span></span>
4.  <span data-ttu-id="df4d1-140">Contactez les rédacteurs pour initialiser la coopération.</span><span class="sxs-lookup"><span data-stu-id="df4d1-140">Contact the writers to initialize cooperation.</span></span>
5.  <span data-ttu-id="df4d1-141">Recherchez les mises à jour de l’enregistreur dans le document sur les composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="df4d1-141">Check for writer updates to the Backup Components Document.</span></span>
6.  <span data-ttu-id="df4d1-142">Restaurer les données.</span><span class="sxs-lookup"><span data-stu-id="df4d1-142">Restore the data.</span></span>

 

 



