---
description: La sélectivité pour la restauration permet au demandeur de déterminer quand un composant peut être restauré individuellement.
ms.assetid: 684dc50f-5d7b-4c95-85dd-77c320d65fff
title: Utilisation de la sélectivité pour la restauration et les sous-composants
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d988f4c4e029c7dd8623ad22fcaee7662d33e82
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526260"
---
# <a name="working-with-selectability-for-restore-and-subcomponents"></a><span data-ttu-id="9e31d-103">Utilisation de la sélectivité pour la restauration et les sous-composants</span><span class="sxs-lookup"><span data-stu-id="9e31d-103">Working with Selectability For Restore and Subcomponents</span></span>

<span data-ttu-id="9e31d-104">La sélectivité pour la restauration permet au demandeur de déterminer quand un composant peut être restauré individuellement.</span><span class="sxs-lookup"><span data-stu-id="9e31d-104">Selectability for restore allows the requester to determine when a component can be individually restored.</span></span> <span data-ttu-id="9e31d-105">Un composant qui a été inclus pour la sauvegarde peut apparaître de l’une des deux manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="9e31d-105">A component that has been included for backup can appear in one of two ways:</span></span>

-   <span data-ttu-id="9e31d-106">Un composant a peut-être été [*explicitement inclus*](vssgloss-e.md) dans la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="9e31d-106">A component may have been [*explicitly included*](vssgloss-e.md) in the backup.</span></span> <span data-ttu-id="9e31d-107">Ces composants ont une instance [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) correspondante dans le document composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="9e31d-107">These components have a corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance in the Backup Components Document.</span></span> <span data-ttu-id="9e31d-108">Ces composants sont inclus dans une restauration à l’aide de [**IVssBackupComponents :: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="9e31d-108">These components are included in a restore using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>
-   <span data-ttu-id="9e31d-109">Un composant a peut-être été [*implicitement inclus*](vssgloss-i.md) dans la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="9e31d-109">A component may have been [*implicitly included*](vssgloss-i.md) in the backup.</span></span> <span data-ttu-id="9e31d-110">Ces composants n’ont pas d’instance [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) correspondante dans le document des composants de sauvegarde ; Toutefois, il y aura toujours une instance **IVssComponent** pour un composant ancêtre dans le document.</span><span class="sxs-lookup"><span data-stu-id="9e31d-110">These components do not have a corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance in the Backup Components Document; however, there will always be an **IVssComponent** instance for some ancestor component in the document.</span></span> <span data-ttu-id="9e31d-111">Ces composants sont inclus dans une restauration à l’aide de [**IVssBackupComponents :: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="9e31d-111">These components are included in a restore using [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>

<span data-ttu-id="9e31d-112">Tout composant qui a été explicitement inclus dans la sauvegarde peut toujours être sélectionné individuellement pour la restauration, quelle que soit sa valeur de sélectivité-for-Restore.</span><span class="sxs-lookup"><span data-stu-id="9e31d-112">Any component that has been explicitly included in the backup can always be individually selected for restore, regardless of its selectability-for-restore value.</span></span> <span data-ttu-id="9e31d-113">Le demandeur appelle [**IVssBackupComponents :: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), en passant l’ID d’enregistreur, le chemin d’accès logique et le nom du composant spécifique.</span><span class="sxs-lookup"><span data-stu-id="9e31d-113">The requester calls [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), passing in the writer ID, logical path, and name of the specific component.</span></span> <span data-ttu-id="9e31d-114">Les composants qui ont été implicitement inclus dans la sauvegarde sont restaurés lorsqu’un ancêtre explicitement inclus est restauré.</span><span class="sxs-lookup"><span data-stu-id="9e31d-114">Components that have been implicitly included in the backup will be restored when an explicitly included ancestor is restored.</span></span> <span data-ttu-id="9e31d-115">Les composants inclus implicitement peuvent être sélectionnés individuellement pour la restauration uniquement s’ils sont marqués comme sélectionnables pour la restauration.</span><span class="sxs-lookup"><span data-stu-id="9e31d-115">Implicitly included components can be individually selected for restore only if they are marked as selectable for restore.</span></span> <span data-ttu-id="9e31d-116">Le demandeur appelle d’abord **IVssBackupComponents :: SetSelectedForRestore** sur le composant ancêtre le plus proche inclus, puis il appelle [**IVssBackupComponents :: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) sur le composant ancêtre pour sélectionner le composant inclus implicitement pour la restauration.</span><span class="sxs-lookup"><span data-stu-id="9e31d-116">The requester first calls **IVssBackupComponents::SetSelectedForRestore** on the closest explicitly included ancestor component, and then calls [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) on the ancestor component to select the implicitly included component for restore.</span></span> <span data-ttu-id="9e31d-117">Une fois cette opération effectuée, seul le composant sélectionné implicitement sera restauré. tous les autres composants du jeu de composants ne seront pas restaurés.</span><span class="sxs-lookup"><span data-stu-id="9e31d-117">After this is done, only the implicitly selected component will be restored; all other components in the component set will not be restored.</span></span>

<span data-ttu-id="9e31d-118">Contrairement à la sélectivité pour la sauvegarde, qui doit toujours être définie explicitement lorsqu’un composant est ajouté avec [**IVssCreateWriterMetadata :: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), la sélectivité de RESTORE a une valeur par défaut false, qui peut être remplacée.</span><span class="sxs-lookup"><span data-stu-id="9e31d-118">Unlike selectability for backup, which must always be explicitly set when a component is added with [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), selectability for restore has a default value of false, which can be overridden.</span></span>

<span data-ttu-id="9e31d-119">Étant donné que les composants de niveau supérieur (composants avec un chemin logique vide) peuvent uniquement être inclus explicitement dans une sauvegarde, la sélectivité pour la restauration n’a aucune signification pour ces composants.</span><span class="sxs-lookup"><span data-stu-id="9e31d-119">Because top-level components (components with an empty logical path) can only be explicitly included in a backup, selectability for restore has no meaning for these components.</span></span>

 

 



