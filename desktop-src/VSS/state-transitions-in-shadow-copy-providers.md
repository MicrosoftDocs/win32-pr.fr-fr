---
description: 'Le modèle de transition d’état d’un fournisseur de clichés instantanés est simplifié par la sérialisation de la création de clichés instantanés à partir du moment où IVssBackupComponents :: StartSnapshotSet est appelé jusqu’à ce que l’appel à IVssBackupComponents ::D oSnapshotSet retourne.'
ms.assetid: 5dbf0fb3-53cb-4532-9a8f-bd955afe16c4
title: Transitions d’État dans les fournisseurs de clichés instantanés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d628d11419158f947225b2e4cabd7f93975f421
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106527883"
---
# <a name="state-transitions-in-shadow-copy-providers"></a><span data-ttu-id="85263-103">Transitions d’État dans les fournisseurs de clichés instantanés</span><span class="sxs-lookup"><span data-stu-id="85263-103">State Transitions in Shadow Copy Providers</span></span>

<span data-ttu-id="85263-104">Le modèle de transition d’état d’un fournisseur de clichés instantanés est simplifié par la sérialisation de la création de clichés instantanés à partir du moment où [**IVssBackupComponents :: StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) est appelé jusqu’à ce que l’appel à [**IVssBackupComponents ::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) retourne.</span><span class="sxs-lookup"><span data-stu-id="85263-104">The state transition model in a shadow copy provider is simplified by the serialization of shadow copy creation from the time that [**IVssBackupComponents::StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) is called until the call to [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) returns.</span></span> <span data-ttu-id="85263-105">Si un autre demandeur tente de créer un cliché instantané pendant cette période, l’appel à **StartSnapshotSet** échouera avec l’erreur **VSS \_ E \_ snapshot \_ Set \_ en \_ cours**, indiquant que le deuxième demandeur doit attendre et réessayer.</span><span class="sxs-lookup"><span data-stu-id="85263-105">If another requester tries to create a shadow copy during this time, the call to **StartSnapshotSet** will fail with error **VSS\_E\_SNAPSHOT\_SET\_IN\_PROGRESS**, indicating that the second requester should wait and try again.</span></span>

<span data-ttu-id="85263-106">VSS appellera [**IVssProviderCreateSnapshotSet :: AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) une fois que le demandeur a appelé [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), même si le cliché instantané échoue ou est abandonné avant ce point.</span><span class="sxs-lookup"><span data-stu-id="85263-106">VSS will only call [**IVssProviderCreateSnapshotSet::AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) after the requester has called [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), even if the shadow copy fails or is aborted before this point.</span></span> <span data-ttu-id="85263-107">Cela signifie qu’un fournisseur ne recevra pas d’appel à **AbortSnapshots** tant que [**IVssProviderCreateSnapshotSet :: EndPrepareSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-endpreparesnapshots) n’a pas été appelé.</span><span class="sxs-lookup"><span data-stu-id="85263-107">This means that a provider will not receive a call to **AbortSnapshots** until after [**IVssProviderCreateSnapshotSet::EndPrepareSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-endpreparesnapshots) has been called.</span></span> <span data-ttu-id="85263-108">Si un cliché instantané est abandonné ou échoue avant ce point, le fournisseur ne reçoit aucune indication tant qu’un nouveau cliché instantané n’a pas démarré.</span><span class="sxs-lookup"><span data-stu-id="85263-108">If a shadow copy is aborted or fails before this point, the provider is not given any indication until a new shadow copy is started.</span></span> <span data-ttu-id="85263-109">Pour cette raison, le fournisseur doit être prêt à gérer un appel hors séquence à [**IVssHardwareSnapshotProvider :: BeginPrepareSnapshot**](/windows/desktop/api/VsProv/nf-vsprov-ivsshardwaresnapshotprovider-beginpreparesnapshot) à tout moment.</span><span class="sxs-lookup"><span data-stu-id="85263-109">For this reason, the provider must be prepared to handle an out-of-sequence call to [**IVssHardwareSnapshotProvider::BeginPrepareSnapshot**](/windows/desktop/api/VsProv/nf-vsprov-ivsshardwaresnapshotprovider-beginpreparesnapshot) at any point.</span></span> <span data-ttu-id="85263-110">Cet appel hors séquence représente le début d’une nouvelle séquence de clichés instantanés et aura un nouvel ID de jeu de clichés instantanés.</span><span class="sxs-lookup"><span data-stu-id="85263-110">This out-of-sequence call represents the start of a new shadow copy sequence and will have a new shadow copy set ID.</span></span>

 

 



