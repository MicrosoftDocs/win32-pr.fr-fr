---
description: L’implémentation complète d’une sauvegarde nécessite la participation des enregistreurs du système.
ms.assetid: ea504f8e-26d9-499e-b3e9-03515b480a75
title: Prise en charge du schéma de sauvegarde de l’enregistreur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 593df12f552f206d5d0eedbf8d021b69ef955c6d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104201453"
---
# <a name="writer-backup-schema-support"></a><span data-ttu-id="ad363-103">Prise en charge du schéma de sauvegarde de l’enregistreur</span><span class="sxs-lookup"><span data-stu-id="ad363-103">Writer Backup Schema Support</span></span>

<span data-ttu-id="ad363-104">L’implémentation complète d’une sauvegarde nécessite la participation des enregistreurs du système.</span><span class="sxs-lookup"><span data-stu-id="ad363-104">To fully implement a backup requires participation of the system's writers.</span></span> <span data-ttu-id="ad363-105">Les différents types de sauvegardes prises en charge sont appelés schémas et sont indiqués par un masque de bits (ou une opération or au niveau du bit) des membres de l’énumération du [**\_ \_ schéma de sauvegarde VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) .</span><span class="sxs-lookup"><span data-stu-id="ad363-105">Different types of supported backups are referred to as schemas and are indicated by a bitmask (or bitwise OR) of members of the [**VSS\_BACKUP\_SCHEMA**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) enumeration.</span></span> <span data-ttu-id="ad363-106">Les schémas valides actuellement pris en charge sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="ad363-106">The currently supported valid schemas include the following:</span></span>

-   <span data-ttu-id="ad363-107">Schéma par défaut : complet (VSS \_ BS \_ non défini) : indique qu’un writer prend en charge une sauvegarde où tous les fichiers seront sauvegardés quelle que soit leur date de dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ad363-107">Default Schema: Full (VSS\_BS\_UNDEFINED)—indicates that a writer supports a backup where all files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="ad363-108">L’historique de sauvegarde de chaque fichier peut être mis à jour par le demandeur, et les enregistreurs qui prennent en charge la \_ \_ valeur d’énumération VSS BS timestamp stockent un horodatage mis à jour auprès du demandeur.</span><span class="sxs-lookup"><span data-stu-id="ad363-108">The backup history of each file can be updated by the requester, and writers supporting the VSS\_BS\_TIMESTAMPED enumeration value, it will store an updated time stamp with the requester.</span></span> <span data-ttu-id="ad363-109">Ce schéma de sauvegarde peut être utilisé comme base d’une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="ad363-109">This backup scheme can be used as the basis of an incremental or differential backup.</span></span>

    <span data-ttu-id="ad363-110">La restauration d’une sauvegarde complète nécessite une seule image de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ad363-110">Restoring a full backup requires only a single backup image.</span></span>

-   <span data-ttu-id="ad363-111">La sauvegarde de copie (VSS \_ BS \_ Copy), comme \_ le \_ schéma de sauvegarde complète VSS BS, indique qu’un writer prend en charge une sauvegarde où tous les fichiers seront sauvegardés quelle que soit leur date de dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ad363-111">Copy Backup (VSS\_BS\_COPY)—like the VSS\_BS\_FULL backup schema, indicates that a writer supports a backup where all files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="ad363-112">Toutefois, l’historique de sauvegarde de chaque fichier n’est pas mis à jour par le demandeur ou l’enregistreur, et ce type de sauvegarde ne peut pas être utilisé comme base d’une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="ad363-112">However, the backup history of each file will not be updated by either requester or writer, and this sort of backup cannot be used as the basis of an incremental or differential backup.</span></span>
-   <span data-ttu-id="ad363-113">Fichier journal (VSS \_ BS \_ log) : seuls les fichiers journaux d’un enregistreur doivent être sauvegardés.</span><span class="sxs-lookup"><span data-stu-id="ad363-113">Log File (VSS\_BS\_LOG)—only a writer's log files are to be backed up.</span></span> <span data-ttu-id="ad363-114">Pour ce faire, un enregistreur doit avoir ajouté au moins un fichier à au moins un composant à l’aide de la méthode [**IVssCreateWriterMetadata :: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) .</span><span class="sxs-lookup"><span data-stu-id="ad363-114">This requires a writer to have added at least one file to at least one component using the [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method.</span></span> <span data-ttu-id="ad363-115">Ce type de sauvegarde est spécifique à VSS.</span><span class="sxs-lookup"><span data-stu-id="ad363-115">This backup type is specific to VSS.</span></span>
-   <span data-ttu-id="ad363-116">Emplacements de restauration personnalisés ( \_ l' \_ enregistreur VSS BS \_ prend en charge \_ \_ la nouvelle cible) : indique la prise en charge de l’enregistreur pour un demandeur qui change, au moment de la restauration, où ses fichiers sont restaurés.</span><span class="sxs-lookup"><span data-stu-id="ad363-116">Custom Restore Locations (VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET)—indicates writer support for a requester changing, at restore time, where its files are restored.</span></span> <span data-ttu-id="ad363-117">Cela signifie qu’un writer a été codé pour vérifier ce réadressage (à l’aide de [**IVssComponent :: GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)) et qu’il dispose de la capacité nécessaire pour travailler avec des fichiers déplacés.</span><span class="sxs-lookup"><span data-stu-id="ad363-117">This means that a writer has been coded to check for such relocation (using [**IVssComponent::GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)), and has the capacity for working with relocated files.</span></span>
-   <span data-ttu-id="ad363-118">Restore with Move (VSS \_ BS \_ writer \_ prend en charge \_ Restore \_ with \_ Move) : indique que le writer prend en charge l’exécution de plusieurs instances d’écriture avec le même ID de classe et qu’il prend en charge le déplacement d’un composant vers une instance de writer différente au moment de la restauration.</span><span class="sxs-lookup"><span data-stu-id="ad363-118">Restore with Move (VSS\_BS\_WRITER\_SUPPORTS\_RESTORE\_WITH\_MOVE)—indicates that the writer supports running multiple writer instances with the same class ID, and it supports a requester moving a component to a different writer instance at restore time.</span></span> <span data-ttu-id="ad363-119">L’instance de writer est spécifiée à l’aide d’un nom d’instance d’enregistreur persistant qui a été passé comme paramètre *wszWriterInstanceName* à la méthode [**CVssWriter :: Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize) .</span><span class="sxs-lookup"><span data-stu-id="ad363-119">The writer instance is specified by using a persistent writer instance name that was passed as the *wszWriterInstanceName* parameter to the [**CVssWriter::Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize) method.</span></span> <span data-ttu-id="ad363-120">Un demandeur peut obtenir le nom de l’instance du writer à l’aide de [**IVssExamineWriterMetadataEx :: GetIdentityEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadataex-getidentityex) et déplacer les composants pendant la restauration à l’aide de [**IVssBackupComponentsEx :: SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex).</span><span class="sxs-lookup"><span data-stu-id="ad363-120">A requester can obtain the writer instance name using [**IVssExamineWriterMetadataEx::GetIdentityEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadataex-getidentityex) and move components during restore using [**IVssBackupComponentsEx::SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex).</span></span>

    <span data-ttu-id="ad363-121">**Windows Server 2003 et Windows XP :** Cette valeur n’est pas prise en charge tant que Windows Server 2003 avec Service Pack 1 (SP1) n’est pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="ad363-121">**Windows Server 2003 and Windows XP:** This value is not supported until Windows Server 2003 with Service Pack 1 (SP1).</span></span>

-   <span data-ttu-id="ad363-122">Incrémentielle (VSS \_ BS \_ incrémentielle) : indique que le writer utilise l’API VSS pour aider le demandeur, en veillant à ce que seuls les fichiers qui ont été modifiés ou ajoutés depuis la dernière sauvegarde complète ou incrémentielle soient copiés sur un support de stockage.</span><span class="sxs-lookup"><span data-stu-id="ad363-122">Incremental (VSS\_BS\_INCREMENTAL)—indicates that the writer uses the VSS API to help the requester, ensuring that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span>

    <span data-ttu-id="ad363-123">La restauration d’une sauvegarde incrémentielle nécessite l’image de sauvegarde d’origine et toutes les images de sauvegarde incrémentielles effectuées depuis la sauvegarde initiale.</span><span class="sxs-lookup"><span data-stu-id="ad363-123">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>

-   <span data-ttu-id="ad363-124">Differential (VSS \_ BS \_ Differential) : indique que le writer utilise l’API VSS pour permettre au demandeur de s’assurer que seuls les fichiers qui ont été modifiés ou ajoutés depuis la dernière sauvegarde complète doivent être copiés sur un support de stockage ; toutes les informations de sauvegarde intermédiaires sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="ad363-124">Differential (VSS\_BS\_DIFFERENTIAL)—indicates that the writer uses the VSS API to help the requester ensure that only files that have been changed or added since the last full backup are to be copied to a storage medium; all intermediate backup information is ignored.</span></span>

    <span data-ttu-id="ad363-125">La restauration d’une sauvegarde différentielle nécessite l’image de sauvegarde d’origine et l’image de sauvegarde différentielle la plus récente effectuée depuis la dernière sauvegarde complète.</span><span class="sxs-lookup"><span data-stu-id="ad363-125">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>

-   <span data-ttu-id="ad363-126">Incrémentielle/différentielle : prise en charge de l’horodatage (VSS \_ BS \_ horodaté) : indique qu’un enregistreur prend en charge l’utilisation du mécanisme d’horodatage VSS pour inclure des fichiers dans des opérations incrémentielles ou différentielles.</span><span class="sxs-lookup"><span data-stu-id="ad363-126">Incremental/Differential: Time Stamping Support (VSS\_BS\_TIMESTAMPED)—indicates that a writer supports using the VSS time-stamp mechanism to include files in incremental or differential operations.</span></span> <span data-ttu-id="ad363-127">Lors de la sauvegarde, l’enregistreur doit stocker le tampon [*de sauvegarde d’un jeu de fichiers*](vssgloss-f.md) avec la méthode [**IVssComponent :: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) , et à la restauration, le récupérer avec [**IVssComponent :: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="ad363-127">At backup, the writer must store a [*file set's*](vssgloss-f.md) backup stamp with the [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) method, and at restore retrieve it with [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span></span>
-   <span data-ttu-id="ad363-128">Incremental/Differential : heure de la dernière modification de la prise en charge (VSS \_ BS \_ dernière \_ modification) : indique que lors de l’implémentation de sauvegardes incrémentielles ou différentielles avec des fichiers différenciés, un enregistreur peut fournir des informations de date et d’heure de dernière modification de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="ad363-128">Incremental/Differential: Time of Last Modification Support (VSS\_BS\_LAST\_MODIFY)—indicates that when implementing incremental or differential backups with differenced files, a writer can provide last modification time information independently.</span></span> <span data-ttu-id="ad363-129">Ces informations peuvent être fournies à un demandeur par le biais de la méthode [**IVssComponent :: AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) .</span><span class="sxs-lookup"><span data-stu-id="ad363-129">This information can be provided to a requester via the [**IVssComponent::AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) method.</span></span>
-   <span data-ttu-id="ad363-130">Incremental/Differential : limitation de prise en charge (VSS \_ BS \_ exclusive \_ INCREMENTAL \_ Differential) : indique la prise en charge de l’enregistreur des schémas de sauvegarde différentielle ou incrémentielle, mais uniquement : par exemple, vous ne pouvez pas suivre une sauvegarde incrémentielle avec une sauvegarde différentielle.</span><span class="sxs-lookup"><span data-stu-id="ad363-130">Incremental/Differential: Support Limitation (VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL)—indicates writer support of both differential or increment backup schemas, but only exclusively: for example, you cannot follow an incremental backup with a differential backup.</span></span>
-   <span data-ttu-id="ad363-131">État du système indépendant (VSS \_ BS \_ Independent \_ System \_ State) : indique que le writer prend en charge la sauvegarde des données qui font partie de l’état du système, mais qui peuvent également être sauvegardées indépendamment de l’état du système.</span><span class="sxs-lookup"><span data-stu-id="ad363-131">Independent System State (VSS\_BS\_INDEPENDENT\_SYSTEM\_STATE)—indicates that the writer supports backing up data that is part of the system state, but that can also be backed up independently of the system state.</span></span>

    <span data-ttu-id="ad363-132">**Windows Server 2003 et Windows XP :** Cette valeur n’est pas prise en charge jusqu’à Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="ad363-132">**Windows Server 2003 and Windows XP:** This value is not supported until Windows Vista.</span></span>

-   <span data-ttu-id="ad363-133">Roll-Forward Restore (VSS \_ BS \_ restauration par progression \_ Restore) : indique que le writer prend en charge le paramètre d’un demandeur de restauration par progression à l’aide de [**IVssBackupComponentsEx2 :: SetRollForward**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrollforward).</span><span class="sxs-lookup"><span data-stu-id="ad363-133">Roll-Forward Restore (VSS\_BS\_ROLLFORWARD\_RESTORE)—indicates that the writer supports a requester setting a roll-forward restore point using [**IVssBackupComponentsEx2::SetRollForward**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrollforward).</span></span>

    <span data-ttu-id="ad363-134">**Windows Server 2003 et Windows XP :** Cette valeur n’est pas prise en charge jusqu’à Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="ad363-134">**Windows Server 2003 and Windows XP:** This value is not supported until Windows Vista.</span></span>

-   <span data-ttu-id="ad363-135">Restore Rename (renommer VSS \_ BS \_ \_ ) : indique que le writer prend en charge un demandeur de nom de restauration à l’aide de [**IVssBackupComponentsEx2 :: SetRestoreName**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrestorename).</span><span class="sxs-lookup"><span data-stu-id="ad363-135">Restore Rename (VSS\_BS\_RESTORE\_RENAME)—indicates that the writer supports a requester setting a restore name using [**IVssBackupComponentsEx2::SetRestoreName**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrestorename).</span></span>

    <span data-ttu-id="ad363-136">**Windows Server 2003 et Windows XP :** Cette valeur n’est pas prise en charge jusqu’à Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="ad363-136">**Windows Server 2003 and Windows XP:** This value is not supported until Windows Vista.</span></span>

-   <span data-ttu-id="ad363-137">Restauration faisant autorité (VSS \_ BS \_ faisant autorité \_ ) : indique que le writer prend en charge un paramètre de demandeur faisant autorité de la restauration à l’aide de [**IVssBackupComponentsEx2 :: SetAuthoritativeRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setauthoritativerestore).</span><span class="sxs-lookup"><span data-stu-id="ad363-137">Authoritative Restore (VSS\_BS\_AUTHORITATIVE\_RESTORE)—indicates that the writer supports a requester setting authoritative restore using [**IVssBackupComponentsEx2::SetAuthoritativeRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setauthoritativerestore).</span></span>

<span data-ttu-id="ad363-138">Les rédacteurs définissent leurs schémas à l’aide de la méthode [**IVssCreateWriterMetadata :: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) , et un demandeur obtient le schéma de chaque enregistreur en appelant [**IVssExamineWriterMetadata :: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="ad363-138">Writers set their schemas using the [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) method, and a requester obtains each writer's schema by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span>

 

 



