---
description: Un cliché instantané est une capture instantanée d’un volume qui duplique toutes les données qui sont conservées sur ce volume à un instant bien défini. VSS identifie chaque cliché instantané par un GUID persistant.
ms.assetid: 8ef2478a-c8bc-4517-9a14-e1d9226ec4cd
title: Clichés instantanés et jeux de clichés instantanés
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18709842b1fb0fbf6d6cce2557b51042dfb024ea
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106527420"
---
# <a name="shadow-copies-and-shadow-copy-sets"></a><span data-ttu-id="e8ef0-104">Clichés instantanés et jeux de clichés instantanés</span><span class="sxs-lookup"><span data-stu-id="e8ef0-104">Shadow Copies and Shadow Copy Sets</span></span>

<span data-ttu-id="e8ef0-105">Un cliché [*instantané*](vssgloss-s.md) est une capture instantanée d’un volume qui duplique toutes les données qui sont conservées sur ce volume à un instant bien défini.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-105">A [*shadow copy*](vssgloss-s.md) is a snapshot of a volume that duplicates all of the data that is held on that volume at one well-defined instant in time.</span></span> <span data-ttu-id="e8ef0-106">VSS identifie chaque cliché instantané par un GUID persistant.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-106">VSS identifies each shadow copy by a persistent GUID.</span></span>

<span data-ttu-id="e8ef0-107">Un jeu de clichés [*instantanés*](vssgloss-s.md) est une collection de clichés instantanés de différents volumes exécutés en même temps.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-107">A [*shadow copy set*](vssgloss-s.md) is a collection of shadow copies of various volumes all taken at the same time.</span></span> <span data-ttu-id="e8ef0-108">VSS identifie chaque jeu de clichés instantanés par un GUID persistant.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-108">VSS identifies each shadow copy set by a persistent GUID.</span></span>

<span data-ttu-id="e8ef0-109">La manière dont un fournisseur de matériel ou de logiciels particulier choisit d’implémenter des clichés instantanés est entièrement à sa discrétion.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-109">How a particular hardware or software vendor chooses to implement shadow copies is completely at its discretion.</span></span> <span data-ttu-id="e8ef0-110">Une fois qu’un cliché instantané est créé, deux images du volume cliché instantané sont effectivement disponibles sur le système : le volume d’origine, qui est accessible de manière conventionnelle. et les données copiées, accessibles via l’API VSS.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-110">Once a shadow copy is created, there are effectively two images of the shadow-copied volume available to the system: the original volume, which can be accessed conventionally; and the copied data, which can be accessed through the VSS API.</span></span>

<span data-ttu-id="e8ef0-111">Cela permet à deux ensembles d’activités d’avoir lieu en même temps :</span><span class="sxs-lookup"><span data-stu-id="e8ef0-111">This allows two sets of activities to take place at the same time:</span></span>

-   <span data-ttu-id="e8ef0-112">Les applications ordinaires sur le système peuvent rapidement continuer ou reprendre en utilisant le volume d’origine, en mettant à jour les données sur le disque.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-112">Ordinary applications on the system can quickly continue or resume using the original volume, updating data on the disk.</span></span>
-   <span data-ttu-id="e8ef0-113">Les applications qui utilisent l’API du demandeur VSS pour accéder au volume copié par cliché instantané peuvent effectuer des sauvegardes ou des opérations similaires.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-113">Applications that are using the VSS requester API to access the shadow-copied volume can perform backups or similar operations.</span></span>

<span data-ttu-id="e8ef0-114">Les clichés instantanés ne doivent pas être implémentés de la même façon pour chaque fichier, répertoire ou volume.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-114">Shadow copies need not be implemented in the same way for every file, directory, or volume.</span></span> <span data-ttu-id="e8ef0-115">Différentes implémentations du mécanisme de cliché instantané ([*fournisseurs*](vssgloss-p.md)) peuvent utiliser des approches différentes pour créer un cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-115">Different implementations of the shadow copy mechanism ([*providers*](vssgloss-p.md)) may use different approaches to creating a shadow copy.</span></span> <span data-ttu-id="e8ef0-116">Toutefois, pour toutes les applications qui utilisent l’API VSS, tous les clichés instantanés doivent être identiques.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-116">However, to all applications that are using the VSS API, all shadow copies should appear the same.</span></span>

<span data-ttu-id="e8ef0-117">Pour plus d’informations sur l’implémentation par défaut du fournisseur Windows, consultez [fournisseur système](providers.md).</span><span class="sxs-lookup"><span data-stu-id="e8ef0-117">For information on the default Windows provider implementation, see [System Provider](providers.md).</span></span>

## <a name="default-shadow-copy-state"></a><span data-ttu-id="e8ef0-118">État du cliché instantané par défaut</span><span class="sxs-lookup"><span data-stu-id="e8ef0-118">Default Shadow Copy State</span></span>

<span data-ttu-id="e8ef0-119">Même si le système de fichiers vide toutes les mémoires tampons d’e/s avant de créer un cliché instantané, cela ne garantit pas que les e/s incomplètes sont correctement gérées.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-119">Even though the file system flushes all I/O buffers prior to creating a shadow copy, this will not ensure that incomplete I/O is properly handled.</span></span>

<span data-ttu-id="e8ef0-120">Par conséquent, en supposant que le système ne dispose d’aucune application VSS, les données d’un cliché instantané sont dites dans un [*État de cohérence*](vssgloss-c.md)en cas d’incident.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-120">Therefore, assuming that the system has no VSS-enabled applications, the data in a shadow copy is said to be in a [*crash-consistent state*](vssgloss-c.md).</span></span> <span data-ttu-id="e8ef0-121">Un cliché instantané dans un état de cohérence en cas d’incident contient une image du disque qui est la même que celle qui existe à la suite d’un arrêt catastrophique du système.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-121">A shadow copy in a crash-consistent state contains an image of the disk that is the same as that which would exist following a catastrophic system shutdown.</span></span> <span data-ttu-id="e8ef0-122">Tous les fichiers qui étaient ouverts sont toujours présents sur le volume, mais il n’est pas garanti qu’ils soient exempts d’opérations d’e/s incomplètes ou d’une altération des données.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-122">All files that were open will still exist on the volume, but they are not guaranteed to be free of incomplete I/O operations or data corruption.</span></span>

<span data-ttu-id="e8ef0-123">Bien que l’état de cohérence des incidents ne traite pas entièrement tous les problèmes liés à la définition d’un jeu de sauvegarde stable (voir [problèmes de sauvegarde de volume courants](common-volume-backup-issues.md)), il présente plusieurs avantages par rapport au jeu de sauvegarde que les opérations de sauvegarde conventionnelles devraient utiliser :</span><span class="sxs-lookup"><span data-stu-id="e8ef0-123">While the crash-consistent state does not fully deal with all the issues associated with defining a stable backup set (see [Common Volume Backup Issues](common-volume-backup-issues.md)), it has several advantages over the backup set that conventional backup operations would have to use:</span></span>

-   <span data-ttu-id="e8ef0-124">Un volume contenu dans un cliché instantané, même dans un état cohérent en incident, contient toujours tous les fichiers.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-124">A volume contained in a shadow copy, even in a crash-consistent state, still contains all files.</span></span> <span data-ttu-id="e8ef0-125">Un jeu de sauvegarde créé sans cliché instantané ne contient pas tous les fichiers ouverts au moment de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-125">A backup set created without a shadow copy would not contain all files open at the time of the backup.</span></span> <span data-ttu-id="e8ef0-126">Les fichiers maintenus ouverts au moment de l’opération de sauvegarde sont exclus de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-126">Files held open at the time of the backup operation are excluded from the backup.</span></span>
-   <span data-ttu-id="e8ef0-127">Le cliché instantané du volume est créé à un instant donné et non en parcourant un système de fichiers actif, ce qui nécessite généralement plus de temps.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-127">The shadow copy of the volume is created at one instant in time, and not by traversing an active file system, which typically requires much more time.</span></span>

<span data-ttu-id="e8ef0-128">Les applications sur un système qui ne prennent pas en charge VSS (traitement de texte, éditeurs, etc.) auront probablement leurs fichiers dans un état de cohérence en cas d’incident.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-128">Applications on a system that are not VSS-aware—word processors, editors, and so on—will likely have their files left in a crash-consistent state.</span></span> <span data-ttu-id="e8ef0-129">Toutefois, les applications prenant en charge VSS (enregistreurs) peuvent coordonner leurs actions afin que l’état de leurs fichiers dans le cliché instantané soit bien défini et cohérent.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-129">However, VSS-aware applications (writers) can coordinate their actions so that the state of their files in the shadow copy is well defined and consistent.</span></span>

## <a name="shadow-copy-freeze-and-thaw"></a><span data-ttu-id="e8ef0-130">Figer et libérer le cliché instantané</span><span class="sxs-lookup"><span data-stu-id="e8ef0-130">Shadow Copy Freeze and Thaw</span></span>

<span data-ttu-id="e8ef0-131">La création de chaque opération de cliché instantané VSS est déplacée entre les événements [*Freeze*](vssgloss-f.md) et [*dégeler*](vssgloss-t.md) , utilisés par les enregistreurs pour mettre leurs fichiers dans un état stable avant le cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-131">The creation of every VSS shadow copy operation is bracketed by [*Freeze*](vssgloss-f.md) and [*Thaw*](vssgloss-t.md) events, which writers use to put their files in a stable state prior to shadow copy.</span></span>

<span data-ttu-id="e8ef0-132">Le fait d’avoir des événements Freeze et dégeler dans le cadre du modèle VSS signifie :</span><span class="sxs-lookup"><span data-stu-id="e8ef0-132">Having Freeze and Thaw events as part of the VSS model means:</span></span>

-   <span data-ttu-id="e8ef0-133">La gestion de l’événement Freeze signifie que ceux qui développent des enregistreurs doivent avoir un point clairement délimité dans le cycle de sauvegarde, où ils garantissent que toutes les opérations d’écriture sur le disque sont arrêtées et que les fichiers sont dans un état bien défini pour la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-133">Handling the Freeze event means that those who are developing writers must have a clearly delineated point in the backup cycle where they ensure that all write operations to the disk are stopped and that files are in a well-defined state for backup.</span></span>
-   <span data-ttu-id="e8ef0-134">La gestion de l’événement de libération fournit le mécanisme permettant aux rédacteurs de reprendre les écritures sur le disque et de nettoyer tous les fichiers temporaires ou autres informations d’état temporaire qui ont été créés en association avec le cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-134">Handling the Thaw event provides the mechanism for writers to resume writes to the disk and clean up any temporary files or other temporary state information that were created in association with the shadow copy.</span></span>
-   <span data-ttu-id="e8ef0-135">La fenêtre par défaut entre les événements Freeze et dégeler est abrégée (en général, 60 secondes). par conséquent, l’interruption réelle d’un service fourni par un writer peut être réduite.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-135">The default window between the Freeze and Thaw events is short (typically 60 seconds); therefore, actual interruption of any service that a writer provides can be minimized.</span></span>
-   <span data-ttu-id="e8ef0-136">La gestion d’autres événements (tels que PrepareForSnapshot) qui précèdent et suivent les événements Freeze et dégeler, fournit respectivement la flexibilité nécessaire pour permettre aux rédacteurs d’effectuer des opérations complexes afin de prendre en charge les clichés instantanés.</span><span class="sxs-lookup"><span data-stu-id="e8ef0-136">Handling of other events (such as PrepareForSnapshot) preceding and following the Freeze and Thaw events, respectively, provides the necessary flexibility to allow writers to complete complicated operations to support shadow copies.</span></span>

 

 



