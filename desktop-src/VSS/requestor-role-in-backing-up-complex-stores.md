---
description: Comme avec toutes les opérations importantes sous VSS, les sauvegardes incrémentielles et différentielles requièrent une coopération étroite entre les demandeurs et les rédacteurs.
ms.assetid: 00391a49-8c81-4518-88a2-741ad5ee4ac3
title: Rôle demandeur dans la sauvegarde de magasins complexes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 197351e76b6861ee9b9d1e0589ef028c911430ed
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104034342"
---
# <a name="requester-role-in-backing-up-complex-stores"></a><span data-ttu-id="0d8c4-103">Rôle demandeur dans la sauvegarde de magasins complexes</span><span class="sxs-lookup"><span data-stu-id="0d8c4-103">Requester Role in Backing Up Complex Stores</span></span>

<span data-ttu-id="0d8c4-104">Comme avec toutes les opérations importantes sous VSS, les sauvegardes [*incrémentielles*](vssgloss-i.md) et [*différentielles*](vssgloss-d.md) requièrent une coopération étroite entre les demandeurs et les rédacteurs.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-104">As with all important operations under VSS, [*incremental*](vssgloss-i.md) and [*differential*](vssgloss-d.md) backups require close cooperation between requesters and writers.</span></span>

## <a name="backup-type"></a><span data-ttu-id="0d8c4-105">Type de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="0d8c4-105">Backup Type</span></span>

<span data-ttu-id="0d8c4-106">L’infrastructure fournit une prise en charge spéciale de cinq types de sauvegardes.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-106">The infrastructure provides special support for five types of backup.</span></span> <span data-ttu-id="0d8c4-107">En voici le détail :</span><span class="sxs-lookup"><span data-stu-id="0d8c4-107">They are described as follows:</span></span>

-   <span data-ttu-id="0d8c4-108">Full (**VSS \_ BT \_ complet**).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-108">Full (**VSS\_BT\_FULL**).</span></span> <span data-ttu-id="0d8c4-109">Les fichiers seront sauvegardés quelle que soit leur date de dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-109">Files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="0d8c4-110">L’historique de sauvegarde de chaque fichier est mis à jour, et ce type de sauvegarde peut être utilisé comme base d’une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-110">The backup history of each file will be updated, and this type of backup can be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="0d8c4-111">Si des fichiers journaux sont présents, ils peuvent être tronqués à la suite de cette sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-111">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="0d8c4-112">La restauration d’une sauvegarde complète nécessite une seule image de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-112">Restoring a full backup requires only a single backup image.</span></span>

-   <span data-ttu-id="0d8c4-113">Différentielle (**\_ \_ différentielle BT VSS**).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-113">Differential (**VSS\_BT\_DIFFERENTIAL**).</span></span> <span data-ttu-id="0d8c4-114">L’API VSS est utilisée pour s’assurer que seuls les fichiers qui ont été modifiés ou ajoutés depuis la dernière sauvegarde complète doivent être copiés sur un support de stockage. toutes les informations de sauvegarde intermédiaires sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-114">The VSS API is used to ensure that only files that have been changed or added since the last full backup are to be copied to a storage medium; all intermediate backup information is ignored.</span></span> <span data-ttu-id="0d8c4-115">Cela peut inclure des fichiers entiers ou des plages spécifiques dans des fichiers.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-115">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="0d8c4-116">Une sauvegarde différentielle est associée à une sauvegarde complète et ne peut généralement pas être restaurée tant que la sauvegarde complète n’a pas été restaurée.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-116">A differential backup is associated with a full backup, and generally cannot be restored until the full backup has been restored.</span></span> <span data-ttu-id="0d8c4-117">Si des fichiers journaux sont présents, ils ne sont généralement pas tronqués à la suite de cette sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-117">If there are log files, they will usually not be truncated as a result of this backup.</span></span>

    <span data-ttu-id="0d8c4-118">La restauration d’une sauvegarde différentielle nécessite l’image de sauvegarde d’origine et l’image de sauvegarde différentielle la plus récente effectuée depuis la dernière sauvegarde complète.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-118">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>

-   <span data-ttu-id="0d8c4-119">Incrémentiel (**VSS \_ BT \_ incrémentiel**).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-119">Incremental (**VSS\_BT\_INCREMENTAL**).</span></span> <span data-ttu-id="0d8c4-120">L’API VSS est utilisée pour s’assurer que seuls les fichiers qui ont été modifiés ou ajoutés depuis la dernière sauvegarde complète ou incrémentielle doivent être copiés sur un support de stockage.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-120">The VSS API is used to ensure that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span> <span data-ttu-id="0d8c4-121">Cela peut inclure des fichiers entiers ou des plages spécifiques dans des fichiers.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-121">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="0d8c4-122">Certains enregistreurs n’autorisent pas le mélange des sauvegardes incrémentielles avec les sauvegardes différentielles.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-122">Some writers do not allow incremental backups to be mixed with differential backups.</span></span> <span data-ttu-id="0d8c4-123">Si des fichiers journaux sont présents, ils peuvent être tronqués à la suite de cette sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-123">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="0d8c4-124">La restauration d’une sauvegarde incrémentielle nécessite l’image de sauvegarde d’origine et toutes les images de sauvegarde incrémentielles effectuées depuis la sauvegarde initiale.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-124">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>

-   <span data-ttu-id="0d8c4-125">Sauvegarde de fichier journal (**\_ \_ Journal BT VSS**).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-125">Log Backup (**VSS\_BT\_LOG**).</span></span> <span data-ttu-id="0d8c4-126">Seuls les fichiers journaux d’un enregistreur (fichiers ajoutés à un composant avec la méthode [**IVssCreateWriterMetadata :: AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) et récupérés par un appel à [**IVssWMComponent :: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) sont sauvegardés.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-126">Only a writer's log files (files added to a component with the [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method, and retrieved by a call to [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) will be backed up.</span></span> <span data-ttu-id="0d8c4-127">Ce type de sauvegarde est spécifique à VSS.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-127">This backup type is specific to VSS.</span></span> <span data-ttu-id="0d8c4-128">Les sauvegardes de fichier journal ont tendance à être effectuées très souvent.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-128">Log backups tend to be taken quite frequently.</span></span> <span data-ttu-id="0d8c4-129">En règle générale, le fichier journal est tronqué à la suite de cette sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-129">Typically, the log file will be truncated as a result of this backup.</span></span>
-   <span data-ttu-id="0d8c4-130">Copie de sauvegarde **( \_ \_ copie de VSS BT**).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-130">Copy Backup (**VSS\_BT\_COPY**).</span></span> <span data-ttu-id="0d8c4-131">À l’instar du \_ \_ type de sauvegarde complète VSS BT, les fichiers sont sauvegardés quelle que soit leur date de dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-131">Like the VSS\_BT\_FULL backup type, files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="0d8c4-132">Toutefois, l’historique de sauvegarde de chaque fichier n’est pas mis à jour et ce type de sauvegarde ne peut pas être utilisé comme base d’une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-132">However, the backup history of each file will not be updated, and this sort of backup cannot be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="0d8c4-133">Les fichiers journaux ne doivent jamais être tronqués à la suite d’une sauvegarde de copie.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-133">Log files should never be truncated as a result of a copy backup.</span></span>

<dl> <dt>

<span data-ttu-id="0d8c4-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Prise en charge partielle des fichiers</span><span class="sxs-lookup"><span data-stu-id="0d8c4-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Partial File Support</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-135">Certains enregistreurs prennent en charge la restauration de fichiers par le biais du remplacement des parties des fichiers qu’ils gèrent.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-135">Some writers support file restoration through the overwriting of parts of the files they manage.</span></span> <span data-ttu-id="0d8c4-136">Un demandeur peut être conçu pour tirer parti de cela et, si tel est le cas, il indique cela en définissant les informations dans [**IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-136">A requester may be designed to take advantage of this, and if so it indicates this by setting the information in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span>

</dd> </dl>

<span data-ttu-id="0d8c4-137">Le demandeur spécifie le type de sauvegarde en cours d’exécution par le biais du paramètre *backupType* de [**IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-137">The requester specifies what type of backup is being performed through the *backupType* parameter of [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span> <span data-ttu-id="0d8c4-138">Différents rédacteurs prennent en charge différents types de sauvegardes.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-138">Different writers will support different types of backup.</span></span> <span data-ttu-id="0d8c4-139">Après l’appel de [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) , le demandeur peut déterminer les types de sauvegarde pris en charge par un writer donné en appelant [**IVssExamineWriterMetadata :: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-139">After [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) has been called, the requester can determine what types of backup a given writer supports by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="0d8c4-140">La valeur retournée est un masque de bits indiquant la prise en charge de différents types de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-140">The returned value is a bit mask indicating support for different backup types.</span></span> <span data-ttu-id="0d8c4-141">Service **VSS \_ BS \_ Differential** indique la prise en charge des sauvegardes différentielles, **VSS \_ BS \_ incrémentielle** pour les sauvegardes incrémentielles, le **\_ \_ Journal VSS BS** pour les sauvegardes de journaux et la **\_ \_ copie VSS BS** pour les sauvegardes de copie ; tous les enregistreurs doivent prendre en charge les sauvegardes complètes.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-141">**VSS\_BS\_DIFFERENTIAL** indicates support for differential backups, **VSS\_BS\_INCREMENTAL** for incremental backups, **VSS\_BS\_LOG** for log backups, and **VSS\_BS\_COPY** for copy backups; all writers must support full backups.</span></span> <span data-ttu-id="0d8c4-142">Si un enregistreur ne prend pas en charge la combinaison de sauvegardes incrémentielles avec des sauvegardes différentielles, l’indicateur **\_ \_ \_ \_ différentiel incrémentiel exclusif VSS BS** est également ajouté.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-142">If a writer does not support mixing incremental backups with differential backups, the **VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL** flag will be added as well.</span></span> <span data-ttu-id="0d8c4-143">Si le demandeur effectue une sauvegarde incrémentielle ou différentielle et qu’un writer donné ne prend pas en charge ce type de sauvegarde, une sauvegarde complète doit être effectuée sur ce writer.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-143">If the requester is performing an incremental or differential backup and a given writer does not support that backup type, a full backup should be performed on that writer.</span></span>

## <a name="backup-stamps"></a><span data-ttu-id="0d8c4-144">Tampons de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="0d8c4-144">Backup Stamps</span></span>

<span data-ttu-id="0d8c4-145">Les sauvegardes incrémentielles et différentielles sont toujours liées à une sauvegarde précédente.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-145">Incremental and differential backups are always tied to a previous backup.</span></span> <span data-ttu-id="0d8c4-146">Il existe deux façons de lier des sauvegardes.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-146">There are two ways to tie backups.</span></span> <span data-ttu-id="0d8c4-147">Pour les magasins de données simples, le demandeur peut effectuer le suivi de la corrélation entre les sauvegardes.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-147">For simple data stores, the requester can keep track of the correlation between backups.</span></span> <span data-ttu-id="0d8c4-148">Toutefois, pour les magasins de données plus complexes, l’enregistreur doit conserver son propre horodatage avec la sauvegarde. cet horodateur peut assurer le suivi de la position du journal, des informations de point de contrôle, etc.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-148">However, for more complex data stores, the writer will need to maintain its own timestamp with the backup; this timestamp may keep track of log position, checkpoint information, and so on.</span></span> <span data-ttu-id="0d8c4-149">Le demandeur peut déterminer si un writer donné doit stocker son propre horodateur en vérifiant le bit **VSS \_ BS \_ horodaté** dans la valeur retournée par [**IVssExamineWriterMetadata :: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-149">The requester can determine whether a given writer needs to store its own timestamp by checking for the **VSS\_BS\_TIMESTAMPED** bit in the value returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span>

<span data-ttu-id="0d8c4-150">Les enregistreurs qui stockent un horodateur dans une sauvegarde ajoutent l’horodateur lors du traitement de [**IVssBackupComponents ::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) ou lors du traitement de [**IVssBackupComponents ::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-150">Writers that store a timestamp in a backup will add the timestamp either while processing [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or while processing [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="0d8c4-151">Le demandeur peut obtenir cet horodateur en appelant [**IVssComponent :: GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-151">The requester can obtain this timestamp by calling [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span></span> <span data-ttu-id="0d8c4-152">Lorsque vous effectuez une sauvegarde incrémentielle ou différentielle, le demandeur doit lier la sauvegarde actuelle à une sauvegarde précédente.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-152">When performing an incremental or differential backup, the requester needs to tie the current backup to some previous backup.</span></span> <span data-ttu-id="0d8c4-153">Pour ce faire, vous obtenez l’horodateur de la sauvegarde précédente d’un composant spécifique et le transmettez à la fonction [**IVssBackupComponents :: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) ; Cela doit être fait pour chaque composant qui a été sauvegardé dans la sauvegarde précédente.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-153">This is done by obtaining the timestamp from the previous backup of a specific component and passing it into the [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) function; this needs to be done for each component that was backed up in the previous backup.</span></span>

## <a name="backing-up-files"></a><span data-ttu-id="0d8c4-154">Sauvegarde des fichiers</span><span class="sxs-lookup"><span data-stu-id="0d8c4-154">Backing Up Files</span></span>

### <a name="backing-up-files-reported-by-writer"></a><span data-ttu-id="0d8c4-155">Sauvegarde des fichiers signalés par le writer</span><span class="sxs-lookup"><span data-stu-id="0d8c4-155">Backing Up Files Reported by Writer</span></span>

<span data-ttu-id="0d8c4-156">Chaque spécification de fichier qu’un enregistreur ajoute à ses métadonnées pendant la phase GatherWriterMetadata contient un masque de type de sauvegarde qui spécifie le moment où le fichier doit être sauvegardé.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-156">Every file specification that a writer adds to its metadata during the GatherWriterMetadata phase contains a backup type mask that specifies when the file should be backed up.</span></span> <span data-ttu-id="0d8c4-157">Le demandeur détermine ce qu’est le masque en appelant [**IVssWMFiledesc :: GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-157">The requester determines what this mask is by calling [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask).</span></span> <span data-ttu-id="0d8c4-158">Les valeurs de ce masque sont utilisées pour déterminer pour quels types de sauvegarde la spécification de fichier doit être sauvegardée.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-158">The values in this mask are used to determine for which backup types the file specification needs to be backed up.</span></span> <span data-ttu-id="0d8c4-159">Le masque peut contenir une ou plusieurs des valeurs de bit suivantes :</span><span class="sxs-lookup"><span data-stu-id="0d8c4-159">The mask can contain one or more of the following bit values:</span></span>

<dl> <dt>

<span data-ttu-id="0d8c4-160"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**\_ \_ sauvegarde complète VSS \_ FSBT \_ requise**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-160"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-161">Requis pour les sauvegardes complètes.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-161">Required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="0d8c4-162"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**\_ \_ sauvegarde différentielle FSBT \_ VSS \_ requise**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-162"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-163">Requis pour les sauvegardes différentielles.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-163">Required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="0d8c4-164"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**\_sauvegarde VSS FSBT \_ \_ \_ requise**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-164"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**VSS\_FSBT\_INCREMENTAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-165">Requis pour les sauvegardes incrémentielles.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-165">Required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="0d8c4-166"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**\_sauvegarde du \_ Journal FSBT VSS \_ \_ requise**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-166"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**VSS\_FSBT\_LOG\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-167">Requis pour les sauvegardes de fichiers journaux.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-167">Required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="0d8c4-168"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**\_sauvegarde VSS FSBT \_ toutes les \_ sauvegardes \_ requises**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-168"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS\_FSBT\_ALL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-169">Obligatoire pour tous les types de sauvegardes ; Il s’agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-169">Required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="0d8c4-170">Cette spécification remplace la spécification de sélectivité du composant.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-170">This specification overrides the component's selectivity specification.</span></span> <span data-ttu-id="0d8c4-171">Par exemple, imaginez un composant dont les fichiers sont tous marqués avec la **\_ sauvegarde de \_ fichier journal VSS FSBT \_ \_ obligatoire** , mais pas avec la **\_ \_ sauvegarde complète VSS FSBT \_ \_ requise**.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-171">For example, consider a component whose files are all marked with **VSS\_FSBT\_LOG\_BACKUP\_REQUIRED** but not with **VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**.</span></span> <span data-ttu-id="0d8c4-172">Supposons que ce composant ne peut pas être sélectionné pour la sauvegarde (*bSelectable* a la valeur false lorsque [**IVssCreateWriterMetadata :: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) a été appelé).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-172">Suppose this component is not selectable for backup (*bSelectable* was false when [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) was called).</span></span> <span data-ttu-id="0d8c4-173">Dans le cas d’une sauvegarde de fichier journal, cela signifie que tous les fichiers de ce composant doivent toujours être sauvegardés.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-173">In the case of a log backup, this means that all the files in this component must always be backed up.</span></span> <span data-ttu-id="0d8c4-174">Toutefois, dans le cas d’une sauvegarde complète, aucun des fichiers ne doit être sauvegardé, bien que le fait que la sélectivité du composant indique qu’il doit être sauvegardé.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-174">However, in the case of a full backup, none of the files need to be backed up, despite the fact that the component's selectivity implies it should be backed up.</span></span>

### <a name="backup-by-last-modify-time"></a><span data-ttu-id="0d8c4-175">Sauvegarde par heure de la dernière modification</span><span class="sxs-lookup"><span data-stu-id="0d8c4-175">Backup by Last Modify Time</span></span>

<span data-ttu-id="0d8c4-176">Les informations de spécification de fichier spécifiées dans la phase [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) ne fournissent pas d’informations sur le demandeur sur ce qui a changé depuis la dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-176">The file specification information specified in the [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) phase does not give the requester information about what has changed since the last backup.</span></span> <span data-ttu-id="0d8c4-177">L’un des moyens pour un enregistreur d’indiquer des modifications au demandeur est d’utiliser le mécanisme de fichier différent.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-177">One way for a writer to indicate changes to the requester is by using the differenced file mechanism.</span></span> <span data-ttu-id="0d8c4-178">Un enregistreur peut spécifier que certains fichiers d’un composant doivent être sauvegardés uniquement s’ils ont été modifiés depuis un certain temps ; l’enregistreur peut spécifier ces fichiers dans [**IVssBackupComponents ::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) ou dans [**IVssBackupComponents ::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-178">A writer can specify that certain files in a component should be backed up only if they have been modified since a certain time; the writer may specify these files either in [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or in [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="0d8c4-179">Un demandeur peut déterminer ces fichiers en appelant [**IVssComponent :: GetDifferencedFilesCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount) et [**IVssComponent :: GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-179">A requester can determine these files by calling [**IVssComponent::GetDifferencedFilesCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount) and [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span></span> <span data-ttu-id="0d8c4-180">Si la spécification de fichier correspond à un jeu dans **IVssBackupComponents :: GatherWriterMetadata** (qui est actuellement valide en fonction du masque de type de sauvegarde), les informations de fichier différenciées remplacent les informations précédentes. autrement dit, les fichiers correspondant à cette spécification de fichier sont désormais sauvegardés uniquement s’ils ont été modifiés depuis l’heure spécifiée.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-180">If the file specification matches one set in **IVssBackupComponents::GatherWriterMetadata** (that is currently valid based on the backup type mask) the differenced file information overrides the previous information; that is, the files matching that file specification are now backed up only if they have been modified since the specified time.</span></span> <span data-ttu-id="0d8c4-181">L’heure de la dernière modification est communiquée à l’aide d’une structure [**fileTime**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) .</span><span class="sxs-lookup"><span data-stu-id="0d8c4-181">The last-modify time is communicated using a [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) structure.</span></span> <span data-ttu-id="0d8c4-182">Si la valeur de cette structure est égale à zéro, cela signifie que l’heure de la dernière modification doit être déterminée en fonction de l’enregistrement du demandeur de l’heure de la dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-182">If the value of this structure is zero, this implies that the last-modify time should be determined based on the requester's record of the time of last backup.</span></span>

### <a name="partial-file-backup"></a><span data-ttu-id="0d8c4-183">Sauvegarde de fichiers partielle</span><span class="sxs-lookup"><span data-stu-id="0d8c4-183">Partial File Backup</span></span>

<span data-ttu-id="0d8c4-184">Une autre façon pour un enregistreur d’indiquer des modifications au demandeur consiste à utiliser le mécanisme de fichier partiel.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-184">Another way for a writer to indicate changes to the requester is by using the partial file mechanism.</span></span> <span data-ttu-id="0d8c4-185">Un enregistreur peut spécifier des plages d’octets dans des fichiers de composants qui doivent être sauvegardés ; l’enregistreur peut spécifier ces plages de fichiers dans [**IVssBackupComponents ::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) ou dans [**IVssBackupComponents ::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-185">A writer can specify byte ranges within component files that need to be backed up; the writer can specify these file ranges either in [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or in [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="0d8c4-186">Un demandeur peut déterminer ces fichiers en appelant [**IVssComponent :: GetPartialFileCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount) et [**IVssComponent :: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-186">A requester can determine these files by calling [**IVssComponent::GetPartialFileCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount) and [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="0d8c4-187">**IVssComponent :: GetPartialFile** retourne un chemin d’accès et un nom de fichier pointant vers le fichier, et une chaîne de plages indiquant ce qui doit être sauvegardé dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-187">**IVssComponent::GetPartialFile** will return a path and a file name pointing to the file, and a ranges string indicating what needs to be backed up in the file.</span></span> <span data-ttu-id="0d8c4-188">Comme avec les fichiers différenciés, si le chemin d’accès et le nom de fichier correspondent à une spécification de fichier définie par le writer dans [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), les informations de fichier partiel remplacent le paramètre précédent.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-188">As with differenced files, if the path and file name matches a file specification set by the writer in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), the partial-file information overrides the previous setting.</span></span> <span data-ttu-id="0d8c4-189">La chaîne de plages peut avoir deux formats : elle peut soit spécifier les plages directement, soit spécifier un fichier contenant des informations sur les plages.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-189">The ranges string can have two formats: it can either specify the ranges directly, or it can specify a file containing ranges information.</span></span> <span data-ttu-id="0d8c4-190">Si vous spécifiez des plages directement, la syntaxe est une liste séparée par des virgules sous la forme offset1 : length1, offset2 : length2, où chaque décalage et longueur est un entier non signé 64 bits.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-190">If specifying ranges directly, the syntax is a comma-separated list of the form offset1:length1, offset2:length2, where each offset and length is a 64-bit unsigned integer.</span></span> <span data-ttu-id="0d8c4-191">Si vous spécifiez un fichier de plages, la chaîne de plages doit être définie sur file = *filename*, où *filename* est le chemin d’accès complet au fichier de plages.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-191">If specifying a ranges file, the ranges string should be set to File= *filename*, where *filename* is the full path to the ranges file.</span></span> <span data-ttu-id="0d8c4-192">Le fichier de plages lui-même est un fichier binaire qui est mis en forme en tant que liste d’entiers non signés 64 bits.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-192">The ranges file itself is a binary file that is formatted as a list of 64-bit unsigned integers.</span></span> <span data-ttu-id="0d8c4-193">Le premier entier indique le nombre de plages qui sont représentées dans le fichier.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-193">The first integer indicates how many ranges are represented in the file.</span></span> <span data-ttu-id="0d8c4-194">Chaque paire d’entiers suivante représente le décalage et la longueur d’une plage.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-194">Each subsequent pair of integers represents the offset and length of a range.</span></span> <span data-ttu-id="0d8c4-195">Le demandeur doit également s’occuper de sauvegarder et de restaurer ce fichier de plages.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-195">The requester must take care to back up and restore this ranges file as well.</span></span>

### <a name="file-specification-rules"></a><span data-ttu-id="0d8c4-196">Règles de spécification de fichier</span><span class="sxs-lookup"><span data-stu-id="0d8c4-196">File Specification Rules</span></span>

<span data-ttu-id="0d8c4-197">Les spécifications de fichier ajoutées par le biais du fichier de différences et des mécanismes de fichiers partiels modifient les spécifications de fichier définies dans [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) ou ajoutent des fichiers entièrement nouveaux.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-197">File specifications added through the differenced-file and the partial-file mechanisms will either modify file specifications set in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) or add completely new files.</span></span> <span data-ttu-id="0d8c4-198">Si vous modifiez les spécifications de fichiers définies dans **IVssBackupComponents :: GatherWriterMetadata** à l’aide du mécanisme de fichier partiel, un demandeur peut s’attendre à ce que la spécification de fichier corresponde exactement à l’une des spécifications de fichier définies dans le composant dans **IVssBackupComponents :: GatherWriterMetadata**.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-198">If modifying files specifications set in **IVssBackupComponents::GatherWriterMetadata** using the partial-file mechanism, then a requester can expect the file specification to exactly match one of the file specifications set in the component in **IVssBackupComponents::GatherWriterMetadata**.</span></span> <span data-ttu-id="0d8c4-199">La spécification de fichier ne chevauche pas partiellement une autre spécification de fichier et ne correspond à aucune spécification de fichier dans les composants de ce writer.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-199">The file specification will not partially overlap another file specification, and it will not match any file specifications in any other of that writer's components.</span></span> <span data-ttu-id="0d8c4-200">Les spécifications de fichiers ajoutées à l’aide du mécanisme de fichier partiel peuvent, toutefois, chevaucher partiellement une autre spécification de fichier.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-200">File specifications added using the partial-file mechanism can, however, partially overlap another file specification.</span></span> <span data-ttu-id="0d8c4-201">Lorsque la valeur est true, la spécification du fichier de différences ou du fichier partiel remplace la spécification définie dans **IVssBackupComponents :: GatherWriterMetadata**.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-201">When this is true, the differenced-file or partial-file specification overrides the specification set in **IVssBackupComponents::GatherWriterMetadata**.</span></span> <span data-ttu-id="0d8c4-202">Les spécifications de fichier générales peuvent avoir une valeur d’emplacement secondaire (retournée par [**IVssWMFiledesc :: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)) qui indique un autre emplacement à partir duquel obtenir le fichier au moment de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-202">General file specifications can have an alternate-location value (returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)) that indicates an alternate place to obtain the file from at backup time.</span></span> <span data-ttu-id="0d8c4-203">Si les spécifications de fichier définies à l’aide des mécanismes de fichier de différences ou de fichiers partiels correspondent à une spécification de fichiers existante qui a un autre emplacement, les données doivent être récupérées à partir de cet autre emplacement.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-203">If the file specifications set through the differenced-file or partial file mechanisms match an existing files specification that has an alternate location, the data should be picked up from this alternate location.</span></span> <span data-ttu-id="0d8c4-204">Si les spécifications de fichier définies à l’aide des mécanismes de fichier de différences ou de fichiers partiels ne correspondent pas à des spécifications existantes pour le composant, ces plages de fichiers doivent maintenant être ajoutées à la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-204">If the file specifications set through the differenced-file or partial-file mechanisms do not match any existing specifications for the component, then these file ranges should now be added to the backup.</span></span> <span data-ttu-id="0d8c4-205">Le demandeur peut s’attendre à ce que seuls les fichiers sur les volumes qui ont déjà été inclus dans le jeu de clichés instantanés soient ajoutés à l’aide de l’un de ces mécanismes.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-205">The requester can expect that only files on volumes that have already been included in the shadow copy set will be added using one of these mechanisms.</span></span>

### <a name="backup-without-a-shadow-copy"></a><span data-ttu-id="0d8c4-206">Sauvegarde sans cliché instantané</span><span class="sxs-lookup"><span data-stu-id="0d8c4-206">Backup without a Shadow Copy</span></span>

<span data-ttu-id="0d8c4-207">Certains types de fichiers n’ont peut-être pas besoin d’être sauvegardés sur un volume de clichés instantanés.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-207">Certain types of files may not need to be backed up off of a shadow copy volume.</span></span> <span data-ttu-id="0d8c4-208">Par exemple, cela est souvent vrai pour les fichiers journaux de base de données.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-208">For example, this will often be true of database log files.</span></span> <span data-ttu-id="0d8c4-209">Étant donné que les fichiers journaux augmentent de manière monotone, et qu’un enregistreur peut spécifier exactement les portions du fichier à sauvegarder à l’aide de fichiers partiels, il est souvent possible de sauvegarder la journalisation du volume d’origine.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-209">Since log files grow monotonically, and a writer can specify exactly what portions of the file to back up using partial files, it will often be possible to backup the log off the original volume.</span></span> <span data-ttu-id="0d8c4-210">En guise d’optimisation, un enregistreur peut marquer les fichiers qui nécessitent des clichés instantanés pour différents types de sauvegardes à l’aide du masque de type de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-210">As an optimization, a writer can mark which files require shadow copies for different backup types using the backup-type mask.</span></span> <span data-ttu-id="0d8c4-211">La valeur retournée par [**IVssWMFiledesc :: GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) peut contenir une ou plusieurs des valeurs de bit suivantes :</span><span class="sxs-lookup"><span data-stu-id="0d8c4-211">The value returned from [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) can contain one or more of the following bit values:</span></span>

<dl> <dt>

<span data-ttu-id="0d8c4-212"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**\_ \_ instantané complet VSS \_ FSBT \_ requis**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-212"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**VSS\_FSBT\_FULL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-213">Cliché instantané requis pour les sauvegardes complètes.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-213">Shadow copy required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="0d8c4-214"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**\_ \_ instantané différentiel FSBT \_ VSS \_ requis**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-214"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-215">Cliché instantané requis pour les sauvegardes différentielles.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-215">Shadow copy required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="0d8c4-216"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**\_instantané FSBT \_ incrémentiel VSS \_ \_ requis**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-216"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**VSS\_FSBT\_INCREMENTAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-217">Cliché instantané requis pour les sauvegardes incrémentielles.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-217">Shadow copy required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="0d8c4-218"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**\_instantané de \_ Journal FSBT VSS \_ \_ requis**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-218"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**VSS\_FSBT\_LOG\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-219">Cliché instantané requis pour les sauvegardes de fichiers journaux.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-219">Shadow copy required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="0d8c4-220"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**\_FSBT VSS \_ tous les \_ instantanés \_ requis**</span><span class="sxs-lookup"><span data-stu-id="0d8c4-220"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="0d8c4-221">Cliché instantané requis pour tous les types de sauvegardes ; Il s’agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-221">Shadow copy required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="0d8c4-222">Si un volume spécifique contient uniquement des composants qui ne nécessitent pas de cliché instantané pour cette sauvegarde, le demandeur peut ignorer l’étape de création d’un cliché instantané pour ce volume.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-222">If a specific volume contains only components that do not require a shadow copy for this backup, the requester can skip the step of creating a shadow copy for this volume.</span></span> <span data-ttu-id="0d8c4-223">Toutes les données de ce volume peuvent être copiées sur le support de sauvegarde directement à partir du volume d’origine.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-223">All the data on this volume can be copied to the backup media directly from the original volume.</span></span>

## <a name="restoring-files"></a><span data-ttu-id="0d8c4-224">Restauration de fichiers</span><span class="sxs-lookup"><span data-stu-id="0d8c4-224">Restoring Files</span></span>

### <a name="sequential-restores"></a><span data-ttu-id="0d8c4-225">Restaurations séquentielles</span><span class="sxs-lookup"><span data-stu-id="0d8c4-225">Sequential Restores</span></span>

<span data-ttu-id="0d8c4-226">Une fois que le demandeur a effectué une opération de restauration, il envoie l’événement PostRestore à tous les enregistreurs.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-226">After the requester is done performing a restore operation, it sends the PostRestore event to all writers.</span></span> <span data-ttu-id="0d8c4-227">En règle générale, les enregistreurs gèrent cet événement en effectuant des opérations de récupération ou autres opérations consécutives à la restauration.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-227">Generally, writers handle this event by performing recovery or other post-restore operations.</span></span> <span data-ttu-id="0d8c4-228">La restauration des sauvegardes incrémentielles, cependant, se produit généralement sous la forme d’une séquence d’opérations de restauration, une par sauvegarde incrémentielle.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-228">Restoration of incremental backups, however, usually happen as a sequence of restore operations, one per incremental backup.</span></span> <span data-ttu-id="0d8c4-229">Le demandeur doit informer le rédacteur qu’une telle restauration est en cours afin d’empêcher la récupération ou d’autres opérations indésirables jusqu’à ce que la restauration soit terminée.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-229">The requester needs to inform the writer that such a restoration is in progress in order to prevent recovery or other undesirable operations from happening until the restore is completely done.</span></span> <span data-ttu-id="0d8c4-230">Pour ce faire, appelez [**IVssBackupComponents :: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-230">This is done by calling [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span></span> <span data-ttu-id="0d8c4-231">Cette méthode est appelée par composant et indique au writer que d’autres restaurations sont destinées à ce composant.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-231">This method is called per component, and indicates to the writer that more restores are coming for that component.</span></span> <span data-ttu-id="0d8c4-232">Pour la restauration finale dans la séquence, l’indicateur de restaurations supplémentaires doit être défini sur false (valeur par défaut), ce qui indique qu’il s’agit de la dernière restauration dans la séquence pour ce composant.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-232">For the final restore in the sequence, the additional-restores flag should be set to false (its default value), which indicates that this is the last restore in the sequence for that component.</span></span>

### <a name="new-targets"></a><span data-ttu-id="0d8c4-233">Nouvelles cibles</span><span class="sxs-lookup"><span data-stu-id="0d8c4-233">New Targets</span></span>

<span data-ttu-id="0d8c4-234">S’il est pris en charge par l’enregistreur, le demandeur peut restaurer les fichiers de données dans un emplacement autre que l’emplacement d’origine de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-234">If supported by the writer, the requester can restore data files to a location other than the original backup-time location.</span></span> <span data-ttu-id="0d8c4-235">Le demandeur peut vérifier cette prise en charge en appelant [**IVssExamineWriterMetadata :: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-235">The requester can check for this support by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="0d8c4-236">L' **\_ enregistreur VSS \_ BS \_ prend en charge le \_ nouveau bit \_ cible** si ce comportement est pris en charge par l’enregistreur.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-236">The **VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET** bit will be set if the writer supports this behavior.</span></span> <span data-ttu-id="0d8c4-237">Le demandeur informe l’enregistreur du nouvel emplacement en appelant [**IVssBackupComponents :: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) pour chaque spécification de fichier déplacée.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-237">The requester informs the writer of the new location by calling [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) for each relocated file specification.</span></span> <span data-ttu-id="0d8c4-238">Le demandeur peut également décider de restaurer un fichier de plages spécifiques à un emplacement différent.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-238">The requester can also decide to restore a specific ranges file to a different location.</span></span> <span data-ttu-id="0d8c4-239">Le demandeur informe l’auteur de cette modification en appelant [**IVssBackupComponents :: SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-239">The requester informs the writer of this change by calling [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath).</span></span>

### <a name="directed-targets"></a><span data-ttu-id="0d8c4-240">Cibles dirigées</span><span class="sxs-lookup"><span data-stu-id="0d8c4-240">Directed Targets</span></span>

<span data-ttu-id="0d8c4-241">Pour les scénarios de restauration complexes, un enregistreur peut souhaiter mapper des plages d’un fichier sauvegardé sur différentes plages du même fichier ou d’un fichier différent.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-241">For complicated restore scenarios, a writer may want to map ranges of a backed-up file onto different ranges of the same or a different file.</span></span> <span data-ttu-id="0d8c4-242">Pour ce faire, vous pouvez utiliser le mécanisme cible dirigée.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-242">This can be done by using the directed target mechanism.</span></span> <span data-ttu-id="0d8c4-243">Le demandeur peut déterminer après la phase de [**Rerestauration IVssBackupComponents ::P**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) que ce mécanisme est utilisé pour un composant en appelant [**IVssComponent :: GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget) et en vérifiant qu’un retour de **VSS RT est \_ \_ dirigé**.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-243">The requester can determine after the [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) phase that this mechanism is being used for a component by calling [**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget) and checking for a return of **VSS\_RT\_DIRECTED**.</span></span> <span data-ttu-id="0d8c4-244">Le demandeur peut obtenir toutes ces restaurations redirigées en appelant [**IVssComponent :: GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) et [**IVssComponent :: GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-244">The requester can than obtain all of these redirected restores by calling [**IVssComponent::GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) and [**IVssComponent::GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget).</span></span> <span data-ttu-id="0d8c4-245">**IVssComponent :: GetDirectedTarget** retourne un chemin d’accès complet à un fichier source sur la sauvegarde et un chemin d’accès complet à un fichier de destination sur lequel sera restauré.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-245">**IVssComponent::GetDirectedTarget** will return a full path to a source file on the backup and a full path to a destination file that will be restored to.</span></span> <span data-ttu-id="0d8c4-246">Elle retourne également une liste de plages pour chacun de ces fichiers.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-246">It also returns a ranges list for each of these files.</span></span> <span data-ttu-id="0d8c4-247">Le demandeur est ensuite responsable de la restauration des plages spécifiées dans le fichier source vers les plages mappées dans le fichier de destination.</span><span class="sxs-lookup"><span data-stu-id="0d8c4-247">The requester is then responsible for restoring the specified ranges in the source file to the mapped ranges in the destination file.</span></span> <span data-ttu-id="0d8c4-248">Le format de la chaîne de plages est le même que dans [**IVssComponent :: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="0d8c4-248">The format of the ranges string is the same as in [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span>

-   [<span data-ttu-id="0d8c4-249">Rôle d’écriture dans VSS sauvegardes incrémentielles et différentielles</span><span class="sxs-lookup"><span data-stu-id="0d8c4-249">Writer Role in VSS Incremental and Differential Backups</span></span>](writer-role-in-vss-incremental-and-differential-backups.md)
-   [<span data-ttu-id="0d8c4-250">Rôle demandeur dans VSS sauvegardes incrémentielles et différentielles</span><span class="sxs-lookup"><span data-stu-id="0d8c4-250">Requester Role in VSS Incremental and Differential Backups</span></span>](requestor-role-in-vss-incremental-and-differential-backups.md)

 

 
