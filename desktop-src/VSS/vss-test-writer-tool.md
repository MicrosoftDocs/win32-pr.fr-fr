---
description: Le writer de test est un utilitaire que vous pouvez utiliser pour tester des applications VSS.
ms.assetid: 02434cb9-390c-4cf0-9941-b833ace55685
title: Outil enregistreur de test VSS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 61ffdbb513697a701866be5ceeb40168e8c28368
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106536116"
---
# <a name="vss-test-writer-tool"></a><span data-ttu-id="5e64a-103">Outil enregistreur de test VSS</span><span class="sxs-lookup"><span data-stu-id="5e64a-103">VSS Test Writer Tool</span></span>

<span data-ttu-id="5e64a-104">Le writer de test est un utilitaire que vous pouvez utiliser pour tester des applications VSS.</span><span class="sxs-lookup"><span data-stu-id="5e64a-104">The Test Writer is a utility that you can use to test VSS requester applications.</span></span> <span data-ttu-id="5e64a-105">Ce writer peut être configuré pour effectuer presque toutes les actions qu’un enregistreur VSS peut effectuer.</span><span class="sxs-lookup"><span data-stu-id="5e64a-105">This writer can be configured to perform almost all of the actions that a VSS writer can perform.</span></span> <span data-ttu-id="5e64a-106">En outre, l’enregistreur de test effectue des vérifications importantes pour s’assurer que le demandeur a correctement traité ces actions d’écriture.</span><span class="sxs-lookup"><span data-stu-id="5e64a-106">In addition, the Test Writer performs extensive checks to ensure that the requester has dealt with these writer actions correctly.</span></span>

<span data-ttu-id="5e64a-107">Chaque instance du writer est initialisée avec un fichier de configuration XML qui décrit exactement les composants sur lesquels le writer fera l’objet d’un rapport, ainsi que le comportement de l’enregistreur.</span><span class="sxs-lookup"><span data-stu-id="5e64a-107">Each instance of the writer is initialized with an XML configuration file that describes exactly what components the writer will report on, and how the writer behaves.</span></span> <span data-ttu-id="5e64a-108">Le writer peut être configuré pour signaler différents types de scénarios, y compris des scénarios plus complexes utilisant les interfaces incrémentielles et différentielles.</span><span class="sxs-lookup"><span data-stu-id="5e64a-108">The writer can be configured to report on various types of scenarios, including more complicated scenarios using the incremental and differential interfaces.</span></span> <span data-ttu-id="5e64a-109">Le rédacteur effectue des vérifications à différents moments pendant le processus pour s’assurer que le demandeur se comporte de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="5e64a-109">The writer will perform checks at various points during the process to ensure that the requester is behaving in a proper manner.</span></span> <span data-ttu-id="5e64a-110">Une fois la restauration terminée, l’enregistreur vérifie que tous les fichiers nécessaires ont été restaurés sans endommagement.</span><span class="sxs-lookup"><span data-stu-id="5e64a-110">After the restore is completed, the writer will check that all necessary files have been restored without corruption.</span></span> <span data-ttu-id="5e64a-111">Le writer peut également être configuré pour exécuter d’autres opérations, telles que des événements spécifiques en cas d’échec.</span><span class="sxs-lookup"><span data-stu-id="5e64a-111">The writer can also be configured to perform other operations such as failing specific events.</span></span>

> [!Note]  
> <span data-ttu-id="5e64a-112">Cet outil est inclus dans le kit de développement logiciel (SDK) Microsoft Windows pour Windows Vista et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="5e64a-112">This tool is included in the Microsoft Windows Software Development Kit (SDK) for Windows Vista and later.</span></span> <span data-ttu-id="5e64a-113">Vous pouvez télécharger le SDK Windows à partir de [https://msdn.microsoft.com/windowsvista](https://msdn.microsoft.com/windows/default.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5e64a-113">You can download the Windows SDK from [https://msdn.microsoft.com/windowsvista](https://msdn.microsoft.com/windows/default.aspx).</span></span>

 

<span data-ttu-id="5e64a-114">Dans l’installation SDK Windows, l’outil VssSampleProvider se trouve dans `%Program Files(x86)%\Windows Kits\8.1\bin\x64` (pour Windows 64 bits) et `%Program Files(x86)%\Windows Kits\8.1\bin\x86` .</span><span class="sxs-lookup"><span data-stu-id="5e64a-114">In the Windows SDK installation, the VssSampleProvider tool can be found in `%Program Files(x86)%\Windows Kits\8.1\bin\x64` (for 64-bit Windows) and `%Program Files(x86)%\Windows Kits\8.1\bin\x86`.</span></span>

## <a name="running-the-test-writer-tool"></a><span data-ttu-id="5e64a-115">Exécution de l’outil test Writer</span><span class="sxs-lookup"><span data-stu-id="5e64a-115">Running the Test Writer Tool</span></span>

<span data-ttu-id="5e64a-116">Pour démarrer le writer de test, tapez la commande suivante à l’invite de commandes :</span><span class="sxs-lookup"><span data-stu-id="5e64a-116">To start the Test Writer, type the following at the command prompt:</span></span>

<span data-ttu-id="5e64a-117"> *Fichier config* vswriter.exe</span><span class="sxs-lookup"><span data-stu-id="5e64a-117">**vswriter.exe** *config-file*</span></span>

<span data-ttu-id="5e64a-118">où *config-file* est le chemin d’accès à un fichier de configuration qui spécifie le comportement de ce writer.</span><span class="sxs-lookup"><span data-stu-id="5e64a-118">where *config-file* is the path to a configuration file that specifies the behavior of this writer.</span></span>

<span data-ttu-id="5e64a-119">Pour arrêter le writer de test, appuyez sur CTRL + C.</span><span class="sxs-lookup"><span data-stu-id="5e64a-119">To stop the Test Writer, press CTRL+C.</span></span>

<span data-ttu-id="5e64a-120">Plusieurs instances de l’enregistreur de test peuvent être exécutées en même temps.</span><span class="sxs-lookup"><span data-stu-id="5e64a-120">Multiple instances of the Test Writer can be run at the same time.</span></span> <span data-ttu-id="5e64a-121">Toutefois, chaque instance du writer signalera le même ID de classe de Writer (bien qu’un ID d’instance de writer différent), de sorte que les chemins d’accès logiques et les noms de composants doivent être uniques dans toutes les instances d’exécution simultanées du writer.</span><span class="sxs-lookup"><span data-stu-id="5e64a-121">However, each instance of the writer will report the same writer class ID (though a different writer instance ID), so logical paths and component names must be unique across all simultaneously running instances of the writer.</span></span>

<span data-ttu-id="5e64a-122">Pour vous assurer que le rédacteur peut vérifier correctement que le demandeur a respecté les spécifications d’exclusion de fichier, tous les fichiers qui ont été sauvegardés doivent être supprimés du volume d’origine avant d’essayer de les restaurer.</span><span class="sxs-lookup"><span data-stu-id="5e64a-122">To ensure that the writer can properly check that the requester has honored the exclude file specifications, all files that were backed up should be deleted from the original volume before attempting to restore them.</span></span> <span data-ttu-id="5e64a-123">Il est recommandé de stocker un modèle de chaque scénario de writer, afin que le scénario puisse être recréé facilement.</span><span class="sxs-lookup"><span data-stu-id="5e64a-123">It is recommended that a template of each writer scenario be stored, so the scenario can be easily recreated.</span></span>

## <a name="using-a-configuration-file"></a><span data-ttu-id="5e64a-124">Utilisation d'un fichier de configuration</span><span class="sxs-lookup"><span data-stu-id="5e64a-124">Using a Configuration File</span></span>

<span data-ttu-id="5e64a-125">L’exemple de fichier de configuration suivant, vswriter \_config.xml, se trouve dans `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` sur les plateformes x86 et `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` sur les plateformes x64.</span><span class="sxs-lookup"><span data-stu-id="5e64a-125">The following sample configuration file, vswriter\_config.xml, can be found in `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` on x86 platforms and `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` on x64 platforms.</span></span>

``` syntax
<TestWriter usage="USER_DATA">

    <RestoreMethod method="RESTORE_IF_CAN_BE_REPLACED"
                   writerRestore="always"
                   rebootRequired="no" />

    <ExcludeFile path="c:\writerData\notTheseFiles" 
                 filespec="excludeThisFile.txt" 
                 recursive="no"/>

    <Component componentType="filegroup"
               componentName="TestFiles">
        <ComponentFile path="c:\writerData\myFilesHere" 
                       filespec="*"
                       recursive="no" />
    </Component>

</TestWriter>
```

<span data-ttu-id="5e64a-126">L’élément racine dans ce fichier de configuration est nommé TestWriter.</span><span class="sxs-lookup"><span data-stu-id="5e64a-126">The root element in this configuration file is named TestWriter.</span></span> <span data-ttu-id="5e64a-127">Tous les autres éléments sont organisés sous l’élément TestWriter.</span><span class="sxs-lookup"><span data-stu-id="5e64a-127">All other elements are arranged under the TestWriter element.</span></span>

<span data-ttu-id="5e64a-128">L’un des attributs associés à TestWriter est l’attribut d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="5e64a-128">One of the attributes associated with TestWriter is the usage attribute.</span></span> <span data-ttu-id="5e64a-129">Cet attribut spécifie le type d’utilisation signalé par le biais de [**IVssExamineWriterMetadata :: GetIdentity**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getidentity).</span><span class="sxs-lookup"><span data-stu-id="5e64a-129">This attribute specifies the usage type reported through [**IVssExamineWriterMetadata::GetIdentity**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getidentity).</span></span> <span data-ttu-id="5e64a-130">L’une des valeurs possibles pour cet attribut est \_ données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5e64a-130">One of the possible values for this attribute is USER\_DATA.</span></span>

<span data-ttu-id="5e64a-131">Le premier élément enfant de l’élément racine doit toujours être un élément RestoreMethod.</span><span class="sxs-lookup"><span data-stu-id="5e64a-131">The first child element of the root element must always be a RestoreMethod element.</span></span> <span data-ttu-id="5e64a-132">Cet élément spécifie les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="5e64a-132">This element specifies the following:</span></span>

-   <span data-ttu-id="5e64a-133">La méthode Restore (dans ce cas, Restore \_ si \_ peut \_ être \_ remplacé)</span><span class="sxs-lookup"><span data-stu-id="5e64a-133">The restore method (in this case, RESTORE\_IF\_CAN\_BE\_REPLACED)</span></span>
-   <span data-ttu-id="5e64a-134">Si l’enregistreur requiert des événements de restauration (dans ce cas, toujours)</span><span class="sxs-lookup"><span data-stu-id="5e64a-134">Whether the writer requires restore events (in this case, always)</span></span>
-   <span data-ttu-id="5e64a-135">Si un redémarrage est nécessaire après la restauration de l’enregistreur (dans ce cas, non)</span><span class="sxs-lookup"><span data-stu-id="5e64a-135">Whether a reboot is required after the writer is restored (in this case, no)</span></span>

<span data-ttu-id="5e64a-136">Cet élément peut éventuellement spécifier un autre mappage d’emplacement.</span><span class="sxs-lookup"><span data-stu-id="5e64a-136">This element can optionally specify an alternate-location mapping.</span></span> <span data-ttu-id="5e64a-137">(Dans ce cas, aucun autre emplacement n’est spécifié.)</span><span class="sxs-lookup"><span data-stu-id="5e64a-137">(In this case, no alternate location is specified.)</span></span>

<span data-ttu-id="5e64a-138">Le deuxième élément enfant est un élément ExcludeFile.</span><span class="sxs-lookup"><span data-stu-id="5e64a-138">The second child element is an ExcludeFile element.</span></span> <span data-ttu-id="5e64a-139">Cet élément fait en sorte que le writer exclut un fichier ou un ensemble de fichiers de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5e64a-139">This element causes the writer to exclude a file or a set of files from backup.</span></span>

<span data-ttu-id="5e64a-140">Le troisième élément enfant est un élément de composant.</span><span class="sxs-lookup"><span data-stu-id="5e64a-140">The third child element is a Component element.</span></span> <span data-ttu-id="5e64a-141">Cet élément amène le writer à ajouter un composant à ses métadonnées.</span><span class="sxs-lookup"><span data-stu-id="5e64a-141">This element causes the writer to add a component to its metadata.</span></span> <span data-ttu-id="5e64a-142">Un élément composant contient des attributs permettant de décrire le composant et les éléments enfants pour décrire le contenu du composant, comme suit :</span><span class="sxs-lookup"><span data-stu-id="5e64a-142">A Component element contains attributes to describe the component and child elements to describe the content of the component, such as the following:</span></span>

-   <span data-ttu-id="5e64a-143">componentType pour indiquer s’il s’agit d’un groupe de fichiers ou d’une base de données</span><span class="sxs-lookup"><span data-stu-id="5e64a-143">componentType to indicate whether this is a filegroup or a database</span></span>
-   <span data-ttu-id="5e64a-144">logicalPath pour le chemin d’accès logique du composant</span><span class="sxs-lookup"><span data-stu-id="5e64a-144">logicalPath for the component logical path</span></span>
-   <span data-ttu-id="5e64a-145">componentName pour le nom du composant</span><span class="sxs-lookup"><span data-stu-id="5e64a-145">componentName for the name of the component</span></span>
-   <span data-ttu-id="5e64a-146">sélectionnable pour indiquer l’État sélectionnable pour la sauvegarde</span><span class="sxs-lookup"><span data-stu-id="5e64a-146">selectable to indicate selectable-for-backup status</span></span>

<span data-ttu-id="5e64a-147">L’élément Component a également un élément enfant nommé ComponentFile pour ajouter une spécification de fichier à ce composant.</span><span class="sxs-lookup"><span data-stu-id="5e64a-147">The Component element also has a child element named ComponentFile to add a file specification to this component.</span></span> <span data-ttu-id="5e64a-148">(Un élément de composant peut avoir un nombre arbitraire d’éléments ComponentFile qui peuvent être spécifiés pour chaque composant.) Cet élément ComponentFile a les attributs suivants :</span><span class="sxs-lookup"><span data-stu-id="5e64a-148">(A Component element can have an arbitrary number of ComponentFile elements that can be specified for each component.) This ComponentFile element has the following attributes:</span></span>

-   <span data-ttu-id="5e64a-149">path = "c : \\ writerData \\ myFilesHere"</span><span class="sxs-lookup"><span data-stu-id="5e64a-149">path="c:\\writerData\\myFilesHere"</span></span>
-   <span data-ttu-id="5e64a-150">spécification de spécification = " \* "</span><span class="sxs-lookup"><span data-stu-id="5e64a-150">filespec="\*"</span></span>
-   <span data-ttu-id="5e64a-151">récursif = « non »</span><span class="sxs-lookup"><span data-stu-id="5e64a-151">recursive="no"</span></span>

<span data-ttu-id="5e64a-152">Bien que le writer de test vérifie le comportement du demandeur, il ne vérifie pas que le fichier de configuration gère toujours la sémantique documentée pour un writer.</span><span class="sxs-lookup"><span data-stu-id="5e64a-152">Although the Test Writer verifies requester behavior, it does not verify that the configuration file always maintains the documented semantics for a writer.</span></span> <span data-ttu-id="5e64a-153">Il y a de nombreuses opérations qu’un enregistreur bien composé ne doit pas faire (par exemple, pour signaler le même fichier dans plusieurs composants) et c’est à l’auteur du fichier de configuration XML de conserver ces sémantiques.</span><span class="sxs-lookup"><span data-stu-id="5e64a-153">There are many operations that a well-behaved writer should not do (such as report the same file in multiple components), and it is up to the author of the XML configuration file to maintain these semantics.</span></span>

## <a name="configuring-writer-attributes"></a><span data-ttu-id="5e64a-154">Configuration des attributs du writer</span><span class="sxs-lookup"><span data-stu-id="5e64a-154">Configuring Writer Attributes</span></span>

<span data-ttu-id="5e64a-155">L’élément racine TestWriter contient des attributs qui déterminent différents comportements du writer.</span><span class="sxs-lookup"><span data-stu-id="5e64a-155">The TestWriter root element contains attributes that determine various behaviors of the writer.</span></span> <span data-ttu-id="5e64a-156">Voici quelques-uns des comportements qui peuvent être modifiés :</span><span class="sxs-lookup"><span data-stu-id="5e64a-156">Some of the behaviors that can be altered are the following:</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="5e64a-157">Attribut</span><span class="sxs-lookup"><span data-stu-id="5e64a-157">Attribute</span></span></th>
<th><span data-ttu-id="5e64a-158">Description</span><span class="sxs-lookup"><span data-stu-id="5e64a-158">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="5e64a-159"><span id="verbosity"></span><span id="VERBOSITY"></span>Commentaires</span><span class="sxs-lookup"><span data-stu-id="5e64a-159"><span id="verbosity"></span><span id="VERBOSITY"></span>verbosity</span></span><br/></td>
<td><span data-ttu-id="5e64a-160">Le rédacteur imprime l’État sur la console lorsqu’il reçoit des événements et les traite.</span><span class="sxs-lookup"><span data-stu-id="5e64a-160">The writer prints the status to the console as it receives events and processes them.</span></span> <span data-ttu-id="5e64a-161">Le niveau de détail affiché est spécifié par l’attribut de commentaires.</span><span class="sxs-lookup"><span data-stu-id="5e64a-161">The level of verbosity displayed is specified by the verbosity attribute.</span></span> <span data-ttu-id="5e64a-162">Vous avez le choix entre trois niveaux de commentaires :</span><span class="sxs-lookup"><span data-stu-id="5e64a-162">There are three verbosity levels to choose from:</span></span><br/> <dl> <span data-ttu-id="5e64a-163"><dt><span id="low"></span><span id="LOW"></span>entrée</dt> </span><span class="sxs-lookup"><span data-stu-id="5e64a-163"><dt><span id="low"></span><span id="LOW"></span>low</dt> </span></span><dd> <span data-ttu-id="5e64a-164">Seuls les échecs dans le writer ou un comportement incorrect du demandeur seront imprimés.</span><span class="sxs-lookup"><span data-stu-id="5e64a-164">Only failures in the writer or incorrect behavior from the requester will be printed.</span></span><br/> </dd> <span data-ttu-id="5e64a-165"><dt><span id="medium"></span><span id="MEDIUM"></span>médias</dt> </span><span class="sxs-lookup"><span data-stu-id="5e64a-165"><dt><span id="medium"></span><span id="MEDIUM"></span>medium</dt> </span></span><dd> <span data-ttu-id="5e64a-166">Tout ce qui a un niveau de détail faible est imprimé en plus des informations d’État supplémentaires, par exemple lors de la réception des événements.</span><span class="sxs-lookup"><span data-stu-id="5e64a-166">Everything at the low verbosity level is printed in addition to extra status information such as when events are received.</span></span> <span data-ttu-id="5e64a-167">C'est le niveau par défaut.</span><span class="sxs-lookup"><span data-stu-id="5e64a-167">This is the default level.</span></span><br/> </dd> <span data-ttu-id="5e64a-168"><dt><span id="high"></span><span id="HIGH"></span>rapide</dt> </span><span class="sxs-lookup"><span data-stu-id="5e64a-168"><dt><span id="high"></span><span id="HIGH"></span>high</dt> </span></span><dd> <span data-ttu-id="5e64a-169">Des informations d’État détaillées sur le fonctionnement de l’enregistreur sont signalées.</span><span class="sxs-lookup"><span data-stu-id="5e64a-169">Detailed status information about the operation of the writer is reported.</span></span><br/> </dd> </dl></td>
</tr>
<tr class="even">
<td><span data-ttu-id="5e64a-170"><span id="deleteFiles"></span><span id="deletefiles"></span><span id="DELETEFILES"></span>deleteFiles</span><span class="sxs-lookup"><span data-stu-id="5e64a-170"><span id="deleteFiles"></span><span id="deletefiles"></span><span id="DELETEFILES"></span>deleteFiles</span></span><br/></td>
<td><span data-ttu-id="5e64a-171">Pour effectuer une vérification supplémentaire, définissez cet attribut sur &quot; Oui &quot; pour obliger l’enregistreur à supprimer tous ses fichiers immédiatement après la création du cliché instantané de volume.</span><span class="sxs-lookup"><span data-stu-id="5e64a-171">To perform extra verification, set this attribute to &quot;yes&quot; to cause the writer to delete all of its files immediately after the volume shadow copy is created.</span></span> <span data-ttu-id="5e64a-172">Le demandeur doit ensuite copier les fichiers à partir du cliché instantané, car ils n’existent plus sur le volume d’origine.</span><span class="sxs-lookup"><span data-stu-id="5e64a-172">The requester must then copy the files from the shadow copy, because they no longer exist on the original volume.</span></span> <br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="5e64a-173">Dans le cas des enregistreurs de fractionnement, les fichiers sont supprimés de l’emplacement d’origine après le fractionnement, mais avant la création du cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="5e64a-173">In the case of spit writers, the files are deleted from the original location after the spit but before the shadow copy is created.</span></span> <span data-ttu-id="5e64a-174">Une fois le cliché instantané créé, les fichiers sont supprimés du répertoire de fractionnement.</span><span class="sxs-lookup"><span data-stu-id="5e64a-174">After the shadow copy is created, the files are deleted from the spit directory.</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="5e64a-175"><span id="deletePartialFiles"></span><span id="deletepartialfiles"></span><span id="DELETEPARTIALFILES"></span>deletePartialFiles</span><span class="sxs-lookup"><span data-stu-id="5e64a-175"><span id="deletePartialFiles"></span><span id="deletepartialfiles"></span><span id="DELETEPARTIALFILES"></span>deletePartialFiles</span></span><br/></td>
<td><span data-ttu-id="5e64a-176">Pour supprimer des fichiers partiels, affectez la valeur Oui à cet attribut &quot; &quot; .</span><span class="sxs-lookup"><span data-stu-id="5e64a-176">To delete partial files, set this attribute to &quot;yes&quot;.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="5e64a-177"><span id="deleteDifferencedFiles"></span><span id="deletedifferencedfiles"></span><span id="DELETEDIFFERENCEDFILES"></span>deleteDifferencedFiles</span><span class="sxs-lookup"><span data-stu-id="5e64a-177"><span id="deleteDifferencedFiles"></span><span id="deletedifferencedfiles"></span><span id="DELETEDIFFERENCEDFILES"></span>deleteDifferencedFiles</span></span><br/></td>
<td><span data-ttu-id="5e64a-178">Pour supprimer des fichiers différenciés, définissez cet attribut sur &quot; Oui &quot; .</span><span class="sxs-lookup"><span data-stu-id="5e64a-178">To delete differenced files, set this attribute to &quot;yes&quot;.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="5e64a-179"><span id="checkIncludes"></span><span id="checkincludes"></span><span id="CHECKINCLUDES"></span>checkIncludes</span><span class="sxs-lookup"><span data-stu-id="5e64a-179"><span id="checkIncludes"></span><span id="checkincludes"></span><span id="CHECKINCLUDES"></span>checkIncludes</span></span><br/></td>
<td><span data-ttu-id="5e64a-180">Définissez cet attribut sur &quot; Oui &quot; pour obliger l’enregistreur à vérifier que tous les fichiers qui ont été sauvegardés ont été restaurés à un emplacement approprié et que le fichier n’a pas été endommagé.</span><span class="sxs-lookup"><span data-stu-id="5e64a-180">Set this attribute to &quot;yes&quot; to cause the writer to check that every file that has been backed up has been restored to an appropriate location, and that the file has not been corrupted.</span></span> <span data-ttu-id="5e64a-181">Les fichiers partiels et les fichiers différenciés sont également gérés correctement.</span><span class="sxs-lookup"><span data-stu-id="5e64a-181">Partial files and differenced files are also correctly handled.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="5e64a-182"><span id="checkExcludes"></span><span id="checkexcludes"></span><span id="CHECKEXCLUDES"></span>checkExcludes</span><span class="sxs-lookup"><span data-stu-id="5e64a-182"><span id="checkExcludes"></span><span id="checkexcludes"></span><span id="CHECKEXCLUDES"></span>checkExcludes</span></span><br/></td>
<td><span data-ttu-id="5e64a-183">Définissez cet attribut sur &quot; Oui &quot; pour obliger l’enregistreur à vérifier que les fichiers correspondant à une spécification de fichier dans la liste d’exclusion ne sont pas restaurés.</span><span class="sxs-lookup"><span data-stu-id="5e64a-183">Set this attribute to &quot;yes&quot; to cause the writer to check that files matching a file specification in the exclude list are not restored.</span></span> <span data-ttu-id="5e64a-184">Pour que cela fonctionne correctement, les répertoires de restauration doivent être vidés avant la restauration.</span><span class="sxs-lookup"><span data-stu-id="5e64a-184">For this to function correctly, the restore directories must be emptied prior to restore.</span></span><br/></td>
</tr>
</tbody>
</table>



 

## <a name="specifying-alternate-location-mappings"></a><span data-ttu-id="5e64a-185">Spécification de mappages d’emplacements de substitution</span><span class="sxs-lookup"><span data-stu-id="5e64a-185">Specifying Alternate Location Mappings</span></span>

<span data-ttu-id="5e64a-186">Un autre mappage d’emplacement spécifie un emplacement vers lequel effectuer la restauration si la méthode de restauration est VSS \_ WRE \_ restaurer \_ à un \_ autre \_ emplacement ou si la restauration normale d’un composant échoue.</span><span class="sxs-lookup"><span data-stu-id="5e64a-186">An alternate location mapping specifies a location to restore to if the restore method is VSS\_WRE\_RESTORE\_TO\_ALTERNATE\_LOCATION or if normal restore of a component fails.</span></span> <span data-ttu-id="5e64a-187">Un enregistreur peut signaler ses mappages d’emplacements alternatifs au demandeur à l’aide de la méthode [**IVssExamineWriterMetadata :: GetAlternateLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getalternatelocationmapping) .</span><span class="sxs-lookup"><span data-stu-id="5e64a-187">A writer can report its alternate location mappings to the requester by using the [**IVssExamineWriterMetadata::GetAlternateLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getalternatelocationmapping) method.</span></span> <span data-ttu-id="5e64a-188">Vous pouvez ajouter d’autres mappages d’emplacement au fichier de configuration du writer de test en ajoutant des sous-éléments AlternateLocationMapping à l’élément RestoreMethod.</span><span class="sxs-lookup"><span data-stu-id="5e64a-188">You can add alternate location mappings to the Test Writer configuration file by adding AlternateLocationMapping subelements to the RestoreMethod element.</span></span>

<span data-ttu-id="5e64a-189">L’élément RestoreMethod suivant contient un sous-élément AlternateLocationMapping.</span><span class="sxs-lookup"><span data-stu-id="5e64a-189">The following RestoreMethod element contains a AlternateLocationMapping subelement.</span></span>

``` syntax
<RestoreMethod method="RESTORE_IF_CAN_REPLACE"
              writerRestore="always"
              rebootRequired="no">
    <AlternateLocationMapping path="c:\files"
                              filespec="*.txt"
                              recursive="no"
                              alternatePath="c:\altfiles"/>
</RestoreMethod>
```

<span data-ttu-id="5e64a-190">Cet exemple spécifie que le demandeur doit tout d’abord tenter de restaurer tous les fichiers correspondant à c : \\ Files \\ \* . txt dans le \\ répertoire c : files.</span><span class="sxs-lookup"><span data-stu-id="5e64a-190">This example specifies that the requester should first attempt to restore all of the files matching c:\\files\\\*.txt to the c:\\files directory.</span></span> <span data-ttu-id="5e64a-191">Si l’un de ces fichiers ne peut pas être remplacé, le demandeur doit restaurer tous les fichiers dans le répertoire c : altfiles à la \\ place.</span><span class="sxs-lookup"><span data-stu-id="5e64a-191">If one of these files cannot be replaced, the requester should restore all the files to the c:\\altfiles directory instead.</span></span> <span data-ttu-id="5e64a-192">Le demandeur doit enregistrer ce mappage de l’autre emplacement à l’aide de la méthode [**IVssBackupComponents :: AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping) .</span><span class="sxs-lookup"><span data-stu-id="5e64a-192">The requester should save this alternate location mapping by using the [**IVssBackupComponents::AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping) method.</span></span> <span data-ttu-id="5e64a-193">Si le writer de test est configuré pour vérifier si les fichiers ont été restaurés, il vérifie également si le demandeur a appelé **AddAlternativeLocationMapping**.</span><span class="sxs-lookup"><span data-stu-id="5e64a-193">If the Test Writer is configured to check whether files have been restored, it will also check whether the requester has called **AddAlternativeLocationMapping**.</span></span>

## <a name="specifying-files-to-be-excluded"></a><span data-ttu-id="5e64a-194">Spécification des fichiers à exclure</span><span class="sxs-lookup"><span data-stu-id="5e64a-194">Specifying Files to Be Excluded</span></span>

<span data-ttu-id="5e64a-195">Chaque enregistreur peut spécifier une liste de spécifications de fichiers qui spécifient les fichiers à exclure de la sauvegarde par le demandeur.</span><span class="sxs-lookup"><span data-stu-id="5e64a-195">Every writer can specify a list of file specifications that specify files for the requester to exclude from backup.</span></span> <span data-ttu-id="5e64a-196">Vous pouvez ajouter ces spécifications de fichier au fichier de configuration du writer de test en ajoutant des sous-éléments ExcludeFile à l’élément racine TestWriter.</span><span class="sxs-lookup"><span data-stu-id="5e64a-196">You can add these file specifications to the Test Writer configuration file by adding ExcludeFile subelements to the TestWriter root element.</span></span>

<span data-ttu-id="5e64a-197">Voici un exemple de sous-élément ExcludeFile qui exclut tous les fichiers dans le répertoire C : \\ Files qui correspondent à c : \\ temp \* . \* .</span><span class="sxs-lookup"><span data-stu-id="5e64a-197">Here is an example of an ExcludeFile subelement that excludes all files in the C:\\files directory that match C:\\temp\*.\*.</span></span>

``` syntax
    <ExcludeFile path="c:\files" 
                 filespec="temp*.*" 
                 recursive="no"/>
```

## <a name="backing-up-spit-writers"></a><span data-ttu-id="5e64a-198">Sauvegarde des enregistreurs de fractionnement</span><span class="sxs-lookup"><span data-stu-id="5e64a-198">Backing Up Spit Writers</span></span>

<span data-ttu-id="5e64a-199">De nombreux enregistreurs jouent le rôle de « rédacteurs de fractionnement ».</span><span class="sxs-lookup"><span data-stu-id="5e64a-199">Many writers act as "spit writers."</span></span> <span data-ttu-id="5e64a-200">Un enregistreur de fractionnement crée des fichiers intermédiaires, ou « fichiers de fractionnement », en fonction d’un jeu de fichiers d’origine, et place les fichiers de fractionnement dans un autre emplacement au moment de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5e64a-200">A spit writer creates intermediate files, or "spit files," based on an original set of files, and puts the spit files in an alternate location at backup time.</span></span> <span data-ttu-id="5e64a-201">Le writer utilise la méthode [**IVssWMFiledesc :: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) pour notifier au demandeur qu’il doit sauvegarder ces fichiers à partir de l’emplacement secondaire.</span><span class="sxs-lookup"><span data-stu-id="5e64a-201">The writer uses the [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) method to notify the requester that it should back these files up from the alternate location.</span></span> <span data-ttu-id="5e64a-202">Toutefois, ces fichiers doivent toujours être restaurés à l’emplacement actif des fichiers d’origine.</span><span class="sxs-lookup"><span data-stu-id="5e64a-202">However, these files should still be restored to the active location of the original files.</span></span> <span data-ttu-id="5e64a-203">L’enregistreur de test peut être configuré pour agir en tant qu’enregistreur de fractionnement pour une spécification de fichier particulière.</span><span class="sxs-lookup"><span data-stu-id="5e64a-203">The Test Writer can be configured to act as a spit writer for a particular file specification.</span></span>

<span data-ttu-id="5e64a-204">L’élément ComponentFile suivant contient un attribut alternatePath :</span><span class="sxs-lookup"><span data-stu-id="5e64a-204">The following ComponentFile element contains an alternatePath attribute:</span></span>

``` syntax
    <ComponentFile path="c:\files"
                   filespec="*.txt"
                   recursive="no"
                   alternatePath="c:\files\spit" />
```

<span data-ttu-id="5e64a-205">Cet exemple configure le writer de test pour copier tous les fichiers correspondant à c : \\ Files \\ \* . txt dans le \\ répertoire c : Files de \\ fractionnement juste avant la création du cliché instantané de volume.</span><span class="sxs-lookup"><span data-stu-id="5e64a-205">This example configures the Test Writer to copy all files matching c:\\files\\\*.txt to the c:\\files\\spit directory immediately before the volume shadow copy is created.</span></span> <span data-ttu-id="5e64a-206">Le demandeur doit sauvegarder les fichiers à partir du \\ Répertoire de fractionnement c : Files \\ .</span><span class="sxs-lookup"><span data-stu-id="5e64a-206">The requester must back up the files from the c:\\files\\spit directory.</span></span> <span data-ttu-id="5e64a-207">Si le writer de test est configuré pour supprimer des fichiers, il supprime les fichiers d’origine avant que le cliché instantané ne soit créé, de sorte qu’ils n’apparaissent pas dans le répertoire c : \\ Files du volume de clichés instantanés.</span><span class="sxs-lookup"><span data-stu-id="5e64a-207">If the Test Writer is configured to delete files, it deletes the original files before the shadow copy is created, so they do not appear in the c:\\files directory on the shadow copy volume.</span></span> <span data-ttu-id="5e64a-208">Dans ce cas, les fichiers figurant dans c : \\ files de \\ fractionnement sont supprimés après la création du cliché instantané. ils doivent donc être sauvegardés à partir du répertoire c : \\ Files \\ de fractionnement sur le volume des clichés instantanés.</span><span class="sxs-lookup"><span data-stu-id="5e64a-208">In this case, the files in c:\\files\\spit are deleted after the shadow copy is created, so they must be backed up from the c:\\files\\spit directory on the shadow copy volume.</span></span>

## <a name="reporting-component-dependencies"></a><span data-ttu-id="5e64a-209">Dépendances des composants de rapport</span><span class="sxs-lookup"><span data-stu-id="5e64a-209">Reporting Component Dependencies</span></span>

<span data-ttu-id="5e64a-210">Les enregistreurs peuvent spécifier une dépendance entre un composant local et un composant qui existe dans un autre writer.</span><span class="sxs-lookup"><span data-stu-id="5e64a-210">Writers can specify a dependency between a local component and a component that exists in another writer.</span></span> <span data-ttu-id="5e64a-211">Ces dépendances sont signalées au demandeur à l’aide de [**IVssWMComponent :: GetDependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span><span class="sxs-lookup"><span data-stu-id="5e64a-211">These dependencies are reported to the requester using [**IVssWMComponent::GetDependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span></span> <span data-ttu-id="5e64a-212">Le writer de test peut être configuré pour signaler ces dépendances en ajoutant un ou plusieurs sous-éléments de dépendance à l’élément de composant.</span><span class="sxs-lookup"><span data-stu-id="5e64a-212">The Test Writer can be configured to report these dependencies by adding one or more Dependency subelements to the Component element.</span></span>

<span data-ttu-id="5e64a-213">L’élément Component suivant contient un sous-élément Dependency :</span><span class="sxs-lookup"><span data-stu-id="5e64a-213">The following Component element contains a Dependency subelement:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
         <Dependency writerId="<GUID of target writer>"
                     logicalPath="ComponentPath"
                     componentName="Writer2Component" />
    </Component>
```

<span data-ttu-id="5e64a-214">La dépendance est spécifiée en tant qu’attributs de l’élément de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5e64a-214">The dependency is specified as attributes of the Dependency element.</span></span> <span data-ttu-id="5e64a-215">writerId est l’ID de classe du writer contenant la cible de la dépendance, logicalPath est le chemin logique du composant dans ce Writer et componentName est le nom du composant.</span><span class="sxs-lookup"><span data-stu-id="5e64a-215">writerId is the class id of the writer containing the target of the dependency, logicalPath is the logical path to the component in that writer, and componentName is the name of the component.</span></span> <span data-ttu-id="5e64a-216">Dans ce cas, si le demandeur sauvegarde « WriterComponent » dans le writer actuel, il doit également sauvegarder le composant « ComponentPath \\ Writer2Component » dans le writer cible.</span><span class="sxs-lookup"><span data-stu-id="5e64a-216">In this case, if the requester is backing up "WriterComponent" in the current writer, it should also back up the component "ComponentPath\\Writer2Component" in the target writer.</span></span>

> [!Note]  
> <span data-ttu-id="5e64a-217">Le writer de test n’effectue aucune vérification pour vérifier que les dépendances sont respectées.</span><span class="sxs-lookup"><span data-stu-id="5e64a-217">The Test Writer performs no checking to ensure dependencies are honored.</span></span>

 

## <a name="failing-events"></a><span data-ttu-id="5e64a-218">Événements ayant échoué</span><span class="sxs-lookup"><span data-stu-id="5e64a-218">Failing Events</span></span>

<span data-ttu-id="5e64a-219">L’enregistreur de test peut être configuré pour faire échouer les événements normaux reçus par un writer.</span><span class="sxs-lookup"><span data-stu-id="5e64a-219">The Test Writer can be configured to fail any of the normal events that a writer receives.</span></span> <span data-ttu-id="5e64a-220">Ces événements sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="5e64a-220">These events are as follows:</span></span>



| <span data-ttu-id="5e64a-221">Événement</span><span class="sxs-lookup"><span data-stu-id="5e64a-221">Event</span></span>                                                                                                                                    | <span data-ttu-id="5e64a-222">Description</span><span class="sxs-lookup"><span data-stu-id="5e64a-222">Description</span></span>                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5e64a-223"><span id="Identify"></span><span id="identify"></span><span id="IDENTIFY"></span>Repérer</span><span class="sxs-lookup"><span data-stu-id="5e64a-223"><span id="Identify"></span><span id="identify"></span><span id="IDENTIFY"></span>Identify</span></span><br/>                                     | <span data-ttu-id="5e64a-224">Reçu en réponse à un appel de [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) .</span><span class="sxs-lookup"><span data-stu-id="5e64a-224">Received as a response to a [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) call.</span></span> <span data-ttu-id="5e64a-225">En cas d’échec, l’enregistreur n’est pas signalé.</span><span class="sxs-lookup"><span data-stu-id="5e64a-225">Failure here will cause the writer to not be reported.</span></span><br/>                                                                 |
| <span data-ttu-id="5e64a-226"><span id="PrepareForBackup"></span><span id="prepareforbackup"></span><span id="PREPAREFORBACKUP"></span>PrepareForBackup</span><span class="sxs-lookup"><span data-stu-id="5e64a-226"><span id="PrepareForBackup"></span><span id="prepareforbackup"></span><span id="PREPAREFORBACKUP"></span>PrepareForBackup</span></span><br/>     | <span data-ttu-id="5e64a-227">Reçu en réponse au demandeur appelant [**IVssBackupComponents ::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup).</span><span class="sxs-lookup"><span data-stu-id="5e64a-227">Received as a response to the requester calling [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup).</span></span><br/>                                                                                                                 |
| <span data-ttu-id="5e64a-228"><span id="PrepareForSnapsot"></span><span id="prepareforsnapsot"></span><span id="PREPAREFORSNAPSOT"></span>PrepareForSnapsot</span><span class="sxs-lookup"><span data-stu-id="5e64a-228"><span id="PrepareForSnapsot"></span><span id="prepareforsnapsot"></span><span id="PREPAREFORSNAPSOT"></span>PrepareForSnapsot</span></span><br/> | <span data-ttu-id="5e64a-229">Reçu lorsque le demandeur appelle [**IVssBackupComponents ::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), mais avant la création du cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="5e64a-229">Received when the requester calls [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), but before the shadow copy is created.</span></span><br/>                                                                                              |
| <span data-ttu-id="5e64a-230"><span id="Freeze"></span><span id="freeze"></span><span id="FREEZE"></span>Antigel</span><span class="sxs-lookup"><span data-stu-id="5e64a-230"><span id="Freeze"></span><span id="freeze"></span><span id="FREEZE"></span>Freeze</span></span><br/>                                             | <span data-ttu-id="5e64a-231">Reçu immédiatement après [*PrepareForSnapshot*](vssgloss-p.md), mais avant la création du cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="5e64a-231">Received immediately after [*PrepareForSnapshot*](vssgloss-p.md), but still before the shadow copy is created.</span></span><br/>                                                                                                      |
| <span data-ttu-id="5e64a-232"><span id="Thaw"></span><span id="thaw"></span><span id="THAW"></span>Congelé</span><span class="sxs-lookup"><span data-stu-id="5e64a-232"><span id="Thaw"></span><span id="thaw"></span><span id="THAW"></span>Thaw</span></span><br/>                                                     | <span data-ttu-id="5e64a-233">Reçue à la fin de la création du cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="5e64a-233">Received after the shadow copy creation is finished.</span></span><br/>                                                                                                                                                                                                     |
| <span data-ttu-id="5e64a-234"><span id="PostSnapshot"></span><span id="postsnapshot"></span><span id="POSTSNAPSHOT"></span>PostSnapshot</span><span class="sxs-lookup"><span data-stu-id="5e64a-234"><span id="PostSnapshot"></span><span id="postsnapshot"></span><span id="POSTSNAPSHOT"></span>PostSnapshot</span></span><br/>                     | <span data-ttu-id="5e64a-235">Reçu après la libération du dégel, mais avant la fin de [**IVssBackupComponents ::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) .</span><span class="sxs-lookup"><span data-stu-id="5e64a-235">Received after Thaw completes, but before [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) completes.</span></span><br/>                                                                                                                   |
| <span data-ttu-id="5e64a-236"><span id="Abort"></span><span id="abort"></span><span id="ABORT"></span>Arrêté</span><span class="sxs-lookup"><span data-stu-id="5e64a-236"><span id="Abort"></span><span id="abort"></span><span id="ABORT"></span>Abort</span></span><br/>                                                 | <span data-ttu-id="5e64a-237">Reçu si trop de temps s’écoule entre le [*gel*](vssgloss-f.md) et le [*dégel*](vssgloss-t.md) ou si le demandeur appelle [**IVssBackupComponents :: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span><span class="sxs-lookup"><span data-stu-id="5e64a-237">Received if too much time elapses between [*Freeze*](vssgloss-f.md) and [*Thaw*](vssgloss-t.md) or if the requester calls [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span></span><br/> |
| <span data-ttu-id="5e64a-238"><span id="BackupComplete"></span><span id="backupcomplete"></span><span id="BACKUPCOMPLETE"></span>BackupComplete</span><span class="sxs-lookup"><span data-stu-id="5e64a-238"><span id="BackupComplete"></span><span id="backupcomplete"></span><span id="BACKUPCOMPLETE"></span>BackupComplete</span></span><br/>             | <span data-ttu-id="5e64a-239">Reçu lorsque le demandeur se termine.</span><span class="sxs-lookup"><span data-stu-id="5e64a-239">Received when the requester exits.</span></span> <span data-ttu-id="5e64a-240">Les défaillances ici ne seront jamais signalées.</span><span class="sxs-lookup"><span data-stu-id="5e64a-240">Failures here will never be reported.</span></span><br/>                                                                                                                                                                                 |
| <span data-ttu-id="5e64a-241"><span id="PreRestore"></span><span id="prerestore"></span><span id="PRERESTORE"></span>Prérestauration</span><span class="sxs-lookup"><span data-stu-id="5e64a-241"><span id="PreRestore"></span><span id="prerestore"></span><span id="PRERESTORE"></span>PreRestore</span></span><br/>                             | <span data-ttu-id="5e64a-242">Reçu lorsque le demandeur appelle [**IVssBackupComponents ::P Restore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span><span class="sxs-lookup"><span data-stu-id="5e64a-242">Received when the requester calls [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span></span><br/>                                                                                                                                           |
| <span data-ttu-id="5e64a-243"><span id="PostRestore"></span><span id="postrestore"></span><span id="POSTRESTORE"></span>PostRestore</span><span class="sxs-lookup"><span data-stu-id="5e64a-243"><span id="PostRestore"></span><span id="postrestore"></span><span id="POSTRESTORE"></span>PostRestore</span></span><br/>                         | <span data-ttu-id="5e64a-244">Reçu lorsque le demandeur appelle [**IVssBackupComponents ::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span><span class="sxs-lookup"><span data-stu-id="5e64a-244">Received when the requester calls [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span><br/>                                                                                                                                         |



 

<span data-ttu-id="5e64a-245">Ces échecs sont configurés en ajoutant un ou plusieurs sous-éléments FailEvent à l’élément racine TestWriter.</span><span class="sxs-lookup"><span data-stu-id="5e64a-245">These failures are configured by adding one or more FailEvent subelements to the TestWriter root element.</span></span> <span data-ttu-id="5e64a-246">Deux classes de défaillances peuvent être définies : renouvelable et non renouvelable.</span><span class="sxs-lookup"><span data-stu-id="5e64a-246">There are two classes of failures that can be set: retryable and non-retryable.</span></span> <span data-ttu-id="5e64a-247">Les erreurs pouvant être renouvelées sont des erreurs qui peuvent disparaître si l’intégralité du processus de sauvegarde est retentée, alors que des erreurs qui ne peuvent pas être renouvelées ne peuvent pas être supprimées.</span><span class="sxs-lookup"><span data-stu-id="5e64a-247">Retryable errors are errors that may go away if the entire backup process is retried, while non-retryable errors are unlikely to disappear.</span></span> <span data-ttu-id="5e64a-248">Le type d’échec de l’événement est choisi en fonction de l’attribut renouvelable.</span><span class="sxs-lookup"><span data-stu-id="5e64a-248">The failure type for the event is chosen based on the retryable attribute.</span></span>

<span data-ttu-id="5e64a-249">Voici un exemple d’échec non renouvelable de base :</span><span class="sxs-lookup"><span data-stu-id="5e64a-249">Here is an example of a basic non-retryable failure:</span></span>

``` syntax
    <FailEvent writerEvent="Freeze"
               retryable="no" />
```

<span data-ttu-id="5e64a-250">Cet exemple entraîne l’échec de l’enregistreur pendant l’événement [*Freeze*](vssgloss-f.md) .</span><span class="sxs-lookup"><span data-stu-id="5e64a-250">This example will cause the writer to fail during the [*Freeze*](vssgloss-f.md) event.</span></span> <span data-ttu-id="5e64a-251">[**IVssBackupComponents :: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) signale que l’échec de l’enregistreur VSS E WRITERERROR n’est pas \_ \_ \_ renouvelable.</span><span class="sxs-lookup"><span data-stu-id="5e64a-251">[**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) will report the writer failure to be VSS\_E\_WRITERERROR\_NONRETRYABLE.</span></span>

<span data-ttu-id="5e64a-252">Voici un exemple d’erreur de base renouvelable :</span><span class="sxs-lookup"><span data-stu-id="5e64a-252">Here is an example of a basic retryable error:</span></span>

``` syntax
    <FailEvent writerEvent="Freeze"
               retryable="yes"
               numFailures="2"/>
```

<span data-ttu-id="5e64a-253">Dans cet exemple, l’enregistreur échouera les deux premières fois qu’il recevra un événement [*Freeze*](vssgloss-f.md) .</span><span class="sxs-lookup"><span data-stu-id="5e64a-253">This example will cause the writer to fail the first two times it receives a [*Freeze*](vssgloss-f.md) event.</span></span> <span data-ttu-id="5e64a-254">Après les deux premières fois, l’enregistreur fonctionnera toujours.</span><span class="sxs-lookup"><span data-stu-id="5e64a-254">After the first two times, the writer will always succeed.</span></span> <span data-ttu-id="5e64a-255">L’échec de l’enregistreur rapporté par [**GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) sera un code d’erreur aléatoire renouvelable.</span><span class="sxs-lookup"><span data-stu-id="5e64a-255">The writer failure reported through [**GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) will be a random retryable error code.</span></span>

## <a name="declaring-supported-backup-types"></a><span data-ttu-id="5e64a-256">Déclaration des types de sauvegarde pris en charge</span><span class="sxs-lookup"><span data-stu-id="5e64a-256">Declaring Supported Backup Types</span></span>

<span data-ttu-id="5e64a-257">Les rédacteurs communiquent les types de sauvegarde pris en charge par l’appel de [**IVssExamineWriterMetadata :: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema)par le demandeur.</span><span class="sxs-lookup"><span data-stu-id="5e64a-257">Writers communicate what backup types are supported through the requester's calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="5e64a-258">L’élément racine TestWriter contient des attributs pour chaque type de sauvegarde pour indiquer la prise en charge.</span><span class="sxs-lookup"><span data-stu-id="5e64a-258">The TestWriter root element contains attributes for each backup type to indicate support.</span></span> <span data-ttu-id="5e64a-259">Ces attributs sont supportsCopy, supportsDifferential, supportsIncremental et supportsLog.</span><span class="sxs-lookup"><span data-stu-id="5e64a-259">These attributes are supportsCopy, supportsDifferential, supportsIncremental, and supportsLog.</span></span> <span data-ttu-id="5e64a-260">Pour indiquer la prise en charge d’un type de sauvegarde particulier, définissez l’attribut correspondant sur « Oui ».</span><span class="sxs-lookup"><span data-stu-id="5e64a-260">To indicate support for a particular backup type, set the corresponding attribute to "yes".</span></span>

<span data-ttu-id="5e64a-261">Si le demandeur définit le type de sauvegarde sur un type de sauvegarde qui n’est pas pris en charge par l’enregistreur, le rédacteur note ce fait pendant la [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), mais fonctionne normalement.</span><span class="sxs-lookup"><span data-stu-id="5e64a-261">If the requester sets the backup type to a backup type that is not supported by the writer, the writer will note this fact during [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), but otherwise work correctly.</span></span>

## <a name="indicating-the-file-backup-type"></a><span data-ttu-id="5e64a-262">Indication du type de sauvegarde de fichiers</span><span class="sxs-lookup"><span data-stu-id="5e64a-262">Indicating the File Backup Type</span></span>

<span data-ttu-id="5e64a-263">La méthode [**IVssWMFiledesc :: GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) renvoie un masque de réécriture au demandeur indiquant comment un fichier doit être sauvegardé.</span><span class="sxs-lookup"><span data-stu-id="5e64a-263">The [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) method returns a bitmask to the requester indicating how a file should be backed up.</span></span> <span data-ttu-id="5e64a-264">Cela indique si un fichier est obligatoire ou non requis au cours de types spécifiques de sauvegarde, et si un cliché instantané est nécessaire au cours de types spécifiques de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5e64a-264">This will indicate whether a file is required or not required during specific types of backup, and also whether a shadow copy is required during specific types of backup.</span></span> <span data-ttu-id="5e64a-265">Les types de sauvegarde dans ce masque de réécriture sont expliqués plus en détail dans le [rôle demandeur de document dans sauvegarde des magasins complexes](requestor-role-in-backing-up-complex-stores.md).</span><span class="sxs-lookup"><span data-stu-id="5e64a-265">The backup types in this bitmask are explained at greater length in the document [Requester Role in Backing Up Complex Stores](requestor-role-in-backing-up-complex-stores.md).</span></span>

<span data-ttu-id="5e64a-266">Dans le writer de test, les éléments de ce masque de réinitialisation sont spécifiés en définissant des attributs dans chaque élément ComponentFile.</span><span class="sxs-lookup"><span data-stu-id="5e64a-266">In the Test Writer, the elements of this bitmask are specified by setting attributes in each ComponentFile element.</span></span> <span data-ttu-id="5e64a-267">Les attributs fullBackupRequired, diffBackupRequired, incBackupRequired et logBackupRequired spécifient quand un fichier doit être sauvegardé.</span><span class="sxs-lookup"><span data-stu-id="5e64a-267">The fullBackupRequired, diffBackupRequired, incBackupRequired, and logBackupRequired attributes specify when a file needs to be backed up.</span></span> <span data-ttu-id="5e64a-268">Les attributs fullSnapshotRequired, diffSnapshotRequired, incSnapshotRequired et logSnapshotRequired spécifient à quel moment un fichier doit être sauvegardé à partir d’un cliché instantané d’un volume (et jamais à partir du volume d’origine).</span><span class="sxs-lookup"><span data-stu-id="5e64a-268">The fullSnapshotRequired, diffSnapshotRequired, incSnapshotRequired, and logSnapshotRequired attributes specify when a file must be backed up from a shadow copy of a volume (and never from the original volume).</span></span> <span data-ttu-id="5e64a-269">La valeur par défaut de toutes ces valeurs est « oui », indiquant qu’un fichier doit toujours être sauvegardé et doit être sauvegardé à partir d’un cliché instantané d’un volume.</span><span class="sxs-lookup"><span data-stu-id="5e64a-269">The default for all of these values is "yes", indicating that a file must always be backed up and must be backed up from a shadow copy of a volume.</span></span>

## <a name="adding-partial-files"></a><span data-ttu-id="5e64a-270">Ajout de fichiers partiels</span><span class="sxs-lookup"><span data-stu-id="5e64a-270">Adding Partial Files</span></span>

<span data-ttu-id="5e64a-271">Pendant le traitement de [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), un enregistreur a la possibilité d’ajouter des fichiers partiels à chaque composant.</span><span class="sxs-lookup"><span data-stu-id="5e64a-271">During the processing of [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), a writer has a chance to add partial files to each component.</span></span> <span data-ttu-id="5e64a-272">Ces fichiers partiels sont signalés à l’aide de [**IVssComponent :: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="5e64a-272">These partial files are reported using [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="5e64a-273">Le writer de test peut être configuré pour ajouter des fichiers partiels en spécifiant des sous-éléments PartialFile dans un élément de composant.</span><span class="sxs-lookup"><span data-stu-id="5e64a-273">The Test Writer can be configured to add partial files by specifying PartialFile subelements in a Component element.</span></span>

<span data-ttu-id="5e64a-274">Voici un exemple d’élément de composant qui a deux sous-éléments PartialFile :</span><span class="sxs-lookup"><span data-stu-id="5e64a-274">Here is an example of a Component element that has two PartialFile subelements:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
        <ComponentFile path="c:\files"
                       filespec="*.txt"
                       recursive="no"/>
        <PartialFile path="c:\files"
                     filespec="partial.txt"
                     ranges="0:5,100:20" />
        <PartialFile path="c:\files2"
                     filespec="partial.txt"
                     ranges="0:5,100:20" />
    </Component>
```

<span data-ttu-id="5e64a-275">Seuls les fichiers partiels qui correspondent partiellement à un ComponentFile existant (comme dans le premier fichier partiel de l’exemple) ou les nouveaux fichiers partiels qui se trouvent sur le même volume qu’un ComponentFile existant (comme dans le deuxième fichier partiel) doivent être spécifiés de cette façon.</span><span class="sxs-lookup"><span data-stu-id="5e64a-275">Only partial files that partially match an existing ComponentFile (as in the first partial file in the example) or new partial files that are on the same volume as an existing ComponentFile (as in the second partial file) should be specified this way.</span></span> <span data-ttu-id="5e64a-276">Pour ce composant, le demandeur doit sauvegarder entièrement tous les fichiers correspondant à c : \\ Files \\ \* . txt, à l’exception de partial.txt.</span><span class="sxs-lookup"><span data-stu-id="5e64a-276">For this component, the requester must fully back up all files matching c:\\files\\\*.txt except for partial.txt.</span></span> <span data-ttu-id="5e64a-277">Le demandeur doit ensuite sauvegarder les plages spécifiées (où une plage est un décalage suivi d’une longueur) pour les fichiers c : \\ files \\partial.txt et c : \\ files2 \\partial.txt.</span><span class="sxs-lookup"><span data-stu-id="5e64a-277">The requester must then back up the specified ranges (where a range is an offset followed by a length) for the files c:\\files\\partial.txt and c:\\files2\\partial.txt.</span></span>

<span data-ttu-id="5e64a-278">Si le writer est configuré pour vérifier les restaurations de fichiers, seules les plages sauvegardées du fichier partiel sont vérifiées au moment de la restauration.</span><span class="sxs-lookup"><span data-stu-id="5e64a-278">If the writer is configured to check file restores, only the backed-up ranges of the partial file will be checked at restore time.</span></span> <span data-ttu-id="5e64a-279">Les modifications apportées à d’autres parties du fichier seront invisibles.</span><span class="sxs-lookup"><span data-stu-id="5e64a-279">Modifications to other portions of the file will go unnoticed.</span></span> <span data-ttu-id="5e64a-280">Si l’attribut deletePartialFiles de l’élément racine TestWriter est défini, les fichiers partiels sont supprimés du volume d’origine immédiatement après la création du cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="5e64a-280">If the deletePartialFiles attribute of the TestWriter root element is set, the partial files are deleted from the original volume immediately after the shadow copy is created.</span></span>

## <a name="adding-differenced-files"></a><span data-ttu-id="5e64a-281">Ajout de fichiers différenciés</span><span class="sxs-lookup"><span data-stu-id="5e64a-281">Adding Differenced Files</span></span>

<span data-ttu-id="5e64a-282">Pendant le traitement de [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), un enregistreur peut ajouter des fichiers différenciés à chaque composant.</span><span class="sxs-lookup"><span data-stu-id="5e64a-282">During the processing of [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), a writer can add differenced files to each component.</span></span> <span data-ttu-id="5e64a-283">Ces fichiers différenciés sont signalés à l’aide de [**IVssComponent :: GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span><span class="sxs-lookup"><span data-stu-id="5e64a-283">These differenced files are reported using [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span></span> <span data-ttu-id="5e64a-284">Le writer de test peut être configuré pour ajouter des fichiers différenciés en spécifiant des sous-éléments DifferencedFile dans un élément de composant.</span><span class="sxs-lookup"><span data-stu-id="5e64a-284">The Test Writer can be configured to add differenced files by specifying DifferencedFile subelements in a Component element.</span></span>

<span data-ttu-id="5e64a-285">Voici un exemple d’élément de composant qui a deux sous-éléments DifferencedFile :</span><span class="sxs-lookup"><span data-stu-id="5e64a-285">Here is an example of a Component element that has two DifferencedFile subelements:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
        <ComponentFile path="c:\files"
                       filespec="*.txt"
                       recursive="no"/>
        <DifferencedFile path="c:\files"
                         filespec="*.txt"
                         year="2007"
                         month="1"
                         day="22"
                         hour="12"
                         minute="44"
                         second="17" />
        <DifferencedFile path="c:\files2"
                         filespec="*.txt"
                         year="2007"
                         month="1"
                         day="22"
                         hour="12"
                         minute="44"
                         second="17" />
    </Component>
```

<span data-ttu-id="5e64a-286">Contrairement aux fichiers partiels, les fichiers différenciés ne doivent jamais partiellement correspondre à une spécification ComponentFile.</span><span class="sxs-lookup"><span data-stu-id="5e64a-286">Unlike partial files, differenced files should never partially match a ComponentFile specification.</span></span> <span data-ttu-id="5e64a-287">La spécification de fichier dans un élément DifferencedFile doit correspondre exactement à un ComponentFile (comme dans le premier fichier différent dans l’exemple) ou elle ne doit pas être identique, mais se trouver sur un volume référencé dans un ComponentFile (comme dans le deuxième fichier différent).</span><span class="sxs-lookup"><span data-stu-id="5e64a-287">The file specification in a DifferencedFile element should either exactly match a ComponentFile (as in the first differenced file in the example) or it should not match it at all, but be on a volume that is referenced in a ComponentFile (as in the second differenced file).</span></span> <span data-ttu-id="5e64a-288">Les valeurs de date et d’heure doivent être relatives au fuseau horaire local, mais elles seront converties en heure GMT avant d’être signalées au demandeur.</span><span class="sxs-lookup"><span data-stu-id="5e64a-288">The date and time values should be relative to the local time zone, but they will be converted to GMT before being reported to the requester.</span></span> <span data-ttu-id="5e64a-289">Dans l’exemple, seuls les fichiers correspondant à c : \\ Files \\ \* . txt ou c : \\ files2 \\ \* . txt qui ont été modifiés depuis 1/22/2003:12:44:17 seront sauvegardés.</span><span class="sxs-lookup"><span data-stu-id="5e64a-289">In the example, only files matching c:\\files\\\*.txt or c:\\files2\\\*.txt that have been modified since 1/22/2003:12:44:17 will be backed up.</span></span>

<span data-ttu-id="5e64a-290">Si le writer de test est configuré pour vérifier les restaurations de fichiers, seuls les fichiers modifiés sont vérifiés pour la restauration.</span><span class="sxs-lookup"><span data-stu-id="5e64a-290">If the Test Writer is configured to check file restores, only the modified files will be checked for restore.</span></span> <span data-ttu-id="5e64a-291">Si l’attribut deleteDifferencedFiles de l’élément racine TestWriter est défini, les fichiers différenciés sont supprimés du volume d’origine immédiatement après la création du cliché instantané.</span><span class="sxs-lookup"><span data-stu-id="5e64a-291">If the deleteDifferencedFiles attribute of the TestWriter root element is set, the differenced files are deleted from the original volume immediately after the shadow copy is created.</span></span>

## <a name="new-targets"></a><span data-ttu-id="5e64a-292">Nouvelles cibles</span><span class="sxs-lookup"><span data-stu-id="5e64a-292">New Targets</span></span>

<span data-ttu-id="5e64a-293">Certains enregistreurs permettent au demandeur de l’informer qu’un nouvel emplacement a été choisi pour restaurer certains fichiers.</span><span class="sxs-lookup"><span data-stu-id="5e64a-293">Certain writers allow the requester to inform them that a new location has been chosen to restore certain files to.</span></span> <span data-ttu-id="5e64a-294">Le writer indique qu’il prend en charge ce mode dans le cadre du masque de masque retourné par [**IVssExamineWriterMetadata :: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="5e64a-294">The writer indicates that it supports this mode as part of the bitmask returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="5e64a-295">Par défaut, l’enregistreur de test prend toujours en charge les nouvelles cibles.</span><span class="sxs-lookup"><span data-stu-id="5e64a-295">By default, the Test Writer always supports new targets.</span></span> <span data-ttu-id="5e64a-296">Cette prise en charge peut être désactivée en affectant à l’attribut supportsNewTarget de l’élément racine TestWriter la valeur « no ».</span><span class="sxs-lookup"><span data-stu-id="5e64a-296">This support can be disabled by setting the supportsNewTarget attribute in the TestWriter root element to "no".</span></span>

<span data-ttu-id="5e64a-297">Si un writer prend en charge de nouvelles cibles, le demandeur peut informer l’enregistreur de nouvelles cibles en appelant [**IVssBackupComponents :: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget).</span><span class="sxs-lookup"><span data-stu-id="5e64a-297">If a writer supports new targets, the requester can inform the writer of new targets by calling [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget).</span></span> <span data-ttu-id="5e64a-298">Le rédacteur vérifie ensuite le nouvel emplacement cible pour vérifier la restauration plutôt que l’emplacement d’origine.</span><span class="sxs-lookup"><span data-stu-id="5e64a-298">The writer will then check the new target location to verify restore rather than the original location.</span></span>

## <a name="more-information"></a><span data-ttu-id="5e64a-299">Informations complémentaires</span><span class="sxs-lookup"><span data-stu-id="5e64a-299">More Information</span></span>

<span data-ttu-id="5e64a-300">Le writer de test prend en charge d’autres options de configuration qui ne sont pas décrites ici.</span><span class="sxs-lookup"><span data-stu-id="5e64a-300">The Test Writer supports more configuration options that are not described here.</span></span> <span data-ttu-id="5e64a-301">Le schéma complet de toutes les fonctionnalités de configuration du writer de test est spécifié dans swriter.xml dans `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` (pour windows 64 bits) et `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` (pour Windows 32 bits).</span><span class="sxs-lookup"><span data-stu-id="5e64a-301">The full schema for all of the configuration capabilities of the Test Writer is specified in swriter.xml in `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` (for 64-bit Windows) and `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` (for 32-bit Windows).</span></span> <span data-ttu-id="5e64a-302">Ce fichier contient un schéma XML qui décrit complètement tous les éléments et attributs qui composent un fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="5e64a-302">This file contains an XML schema that completely describes all of the elements and attributes that make up a configuration file.</span></span> <span data-ttu-id="5e64a-303">Chaque élément et chaque attribut de ce fichier sont commentés avec une description qui documente l’utilisation de l’attribut ou de l’élément.</span><span class="sxs-lookup"><span data-stu-id="5e64a-303">Each element and each attribute in this file is commented with a description that documents that element's or attribute's use.</span></span>

 

 




