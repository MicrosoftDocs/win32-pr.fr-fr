---
description: 'Au cours d’une opération de sauvegarde, le demandeur utilise IVssBackupComponents :: SetBackupState pour définir le type d’opération en cours.'
ms.assetid: 43dcdac7-ed8e-4150-83eb-585e0e92f13c
title: État de sauvegarde VSS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e9aa9250139aee9f48f9880fd4a657fa7c6c4991
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103751565"
---
# <a name="vss-backup-state"></a><span data-ttu-id="62fea-103">État de sauvegarde VSS</span><span class="sxs-lookup"><span data-stu-id="62fea-103">VSS Backup State</span></span>

<span data-ttu-id="62fea-104">Au cours d’une opération de sauvegarde, le demandeur utilise [**IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate) pour définir le type d’opération en cours.</span><span class="sxs-lookup"><span data-stu-id="62fea-104">During a backup operation, the requester uses [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate) to define the type of operation in progress.</span></span>

<span data-ttu-id="62fea-105">Ces informations ne sont pas incluses dans un formulaire de récupération facile dans le document sur les composants de sauvegarde, de sorte que les développeurs de demandeurs doivent stocker ces informations indépendamment sur un support de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="62fea-105">This information is not included in an easily retrievable form in the Backup Components Document, so requester developers should store this information independently on any backup media.</span></span>

<span data-ttu-id="62fea-106">L’état de sauvegarde contient les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="62fea-106">The backup state contains the following:</span></span>

<dl> <dt>

<span data-ttu-id="62fea-107"><span id="Backup_Type"></span><span id="backup_type"></span><span id="BACKUP_TYPE"></span>Type de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="62fea-107"><span id="Backup_Type"></span><span id="backup_type"></span><span id="BACKUP_TYPE"></span>Backup Type</span></span>
</dt> <dd>

<span data-ttu-id="62fea-108">Le type de sauvegarde spécifie les critères d’identification des fichiers à sauvegarder.</span><span class="sxs-lookup"><span data-stu-id="62fea-108">The backup type specifies criteria for identifying files to be backed up.</span></span> <span data-ttu-id="62fea-109">L’évaluation de ces critères doit être effectuée à l’aide de l’API VSS.</span><span class="sxs-lookup"><span data-stu-id="62fea-109">The evaluation of these criteria must be made using the VSS API.</span></span>

<span data-ttu-id="62fea-110">Lorsque vous choisissez le type de sauvegarde à poursuivre et les rédacteurs à utiliser, les demandeurs doivent examiner les genres (ou schémas, voir [prise en charge du schéma de sauvegarde](writer-backup-schema-support.md)de l’enregistreur) des opérations de sauvegarde prises en charge par chacun des Writers du système.</span><span class="sxs-lookup"><span data-stu-id="62fea-110">When deciding on the type of backup to pursue and which writers to work with, requesters should examine the kinds (or schemas—see [Writer Backup Schema Support](writer-backup-schema-support.md)) of backup operations that each of the system's writers supports.</span></span> <span data-ttu-id="62fea-111">Les sauvegardes sous VSS peuvent être des types suivants :</span><span class="sxs-lookup"><span data-stu-id="62fea-111">Backups under VSS can be the following types:</span></span>

-   <span data-ttu-id="62fea-112">Full (VSS \_ BT \_ complet) : les fichiers sont sauvegardés quelle que soit leur date de dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="62fea-112">Full (VSS\_BT\_FULL)—files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="62fea-113">L’historique de sauvegarde de chaque fichier est mis à jour, et ce type de sauvegarde peut être utilisé comme base d’une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="62fea-113">The backup history of each file will be updated, and this type of backup can be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="62fea-114">La restauration d’une sauvegarde complète nécessite une seule image de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="62fea-114">Restoring a full backup requires only a single backup image.</span></span>
-   <span data-ttu-id="62fea-115">Copie de sauvegarde (VSS \_ BT \_ Copy) : comme le \_ type de \_ sauvegarde complète VSS BT, les fichiers sont sauvegardés quelle que soit leur date de dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="62fea-115">Copy Backup (VSS\_BT\_COPY)—like the VSS\_BT\_FULL backup type, files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="62fea-116">Toutefois, l’historique de sauvegarde de chaque fichier n’est pas mis à jour et ce type de sauvegarde ne peut pas être utilisé comme base d’une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="62fea-116">However, the backup history of each file will not be updated, and this sort of backup cannot be used as the basis of an incremental or differential backup.</span></span>
-   <span data-ttu-id="62fea-117">Incrémentielle (VSS \_ BT \_ Incremental) : l’API VSS est utilisée pour s’assurer que seuls les fichiers qui ont été modifiés ou ajoutés depuis la dernière sauvegarde complète ou incrémentielle doivent être copiés sur un support de stockage.</span><span class="sxs-lookup"><span data-stu-id="62fea-117">Incremental (VSS\_BT\_INCREMENTAL)—the VSS API is used to ensure that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span> <span data-ttu-id="62fea-118">La restauration d’une sauvegarde incrémentielle nécessite l’image de sauvegarde d’origine et toutes les images de sauvegarde incrémentielles effectuées depuis la sauvegarde initiale.</span><span class="sxs-lookup"><span data-stu-id="62fea-118">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>
-   <span data-ttu-id="62fea-119">Differential (VSS \_ BT \_ Differential) : l’API VSS est utilisée pour s’assurer que seuls les fichiers qui ont été modifiés ou ajoutés depuis la dernière sauvegarde complète doivent être copiés sur un support de stockage ; toutes les informations de sauvegarde intermédiaires sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="62fea-119">Differential (VSS\_BT\_DIFFERENTIAL)—the VSS API is used to ensure that only files that have been changed or added since the last full backup are to be copied to a storage media; all intermediate backup information is ignored.</span></span> <span data-ttu-id="62fea-120">La restauration d’une sauvegarde différentielle nécessite l’image de sauvegarde d’origine et l’image de sauvegarde différentielle la plus récente effectuée depuis la dernière sauvegarde complète.</span><span class="sxs-lookup"><span data-stu-id="62fea-120">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>
-   <span data-ttu-id="62fea-121">Fichier journal ( \_ Journal BT VSS \_ ) : seuls les fichiers journaux d’un enregistreur (fichiers ajoutés à un composant avec la méthode [**IVssCreateWriterMetadata :: AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) et récupérés par un appel à [**IVssWMComponent :: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) sont sauvegardés.</span><span class="sxs-lookup"><span data-stu-id="62fea-121">Log File (VSS\_BT\_LOG)—only a writer's log files (files added to a component with the [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method, and retrieved by a call to [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) will be backed up.</span></span> <span data-ttu-id="62fea-122">Ce type de sauvegarde est spécifique à VSS.</span><span class="sxs-lookup"><span data-stu-id="62fea-122">This backup type is specific to VSS.</span></span>

<span data-ttu-id="62fea-123">Les demandeurs peuvent implémenter ces sauvegardes à l’aide d’informations et de méthodes en dehors de VSS.</span><span class="sxs-lookup"><span data-stu-id="62fea-123">It is possible for requesters to implement these backups using information and methods outside of VSS.</span></span> <span data-ttu-id="62fea-124">Ce n’est que lorsqu’un demandeur implémente une sauvegarde à l’aide de l’API VSS qu’il a l’un des types de sauvegardes listés.</span><span class="sxs-lookup"><span data-stu-id="62fea-124">Only when a requester implements a backup using the VSS API should it be said to have one of the listed backup types.</span></span> <span data-ttu-id="62fea-125">Par exemple, un demandeur participe à un \_ \_ type de sauvegarde de journal BT VSS uniquement s’il a utilisé les informations retournées par [**IVssWMComponent :: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile) pour identifier les fichiers journaux.</span><span class="sxs-lookup"><span data-stu-id="62fea-125">For instance, a requester participates in a VSS\_BT\_LOG type of backup only if it used the information returned by [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile) to identify log files.</span></span> <span data-ttu-id="62fea-126">De même, les types différentiels de la copie incrémentielle et VSS de VSS \_ BT \_ \_ \_ s’appliquent uniquement aux opérations incrémentielles ou différentielles, comme décrit dans [sauvegardes incrémentielles et différentielles](incremental-and-differential-backups.md).</span><span class="sxs-lookup"><span data-stu-id="62fea-126">Similarly, the VSS\_BT\_INCREMENTAL and VSS\_BT\_DIFFERENTIAL types apply only to incremental or differential operations, as described in [Incremental and Differential Backups](incremental-and-differential-backups.md).</span></span>

</dd> <dt>

<span data-ttu-id="62fea-127"><span id="Specification_about_Selectability"></span><span id="specification_about_selectability"></span><span id="SPECIFICATION_ABOUT_SELECTABILITY"></span>Spécification sur la sélectivité</span><span class="sxs-lookup"><span data-stu-id="62fea-127"><span id="Specification_about_Selectability"></span><span id="specification_about_selectability"></span><span id="SPECIFICATION_ABOUT_SELECTABILITY"></span>Specification about Selectability</span></span>
</dt> <dd>

<span data-ttu-id="62fea-128">Une sauvegarde VSS peut choisir de respecter les notions VSS de la sélectivité des composants : cette opération est appelée exécution en [*mode composant*](vssgloss-c.md), ou pour les ignorer.</span><span class="sxs-lookup"><span data-stu-id="62fea-128">A VSS backup may choose to respect VSS notions of component selectability—this is referred to as running in [*component mode*](vssgloss-c.md)—or to ignore them.</span></span>

<span data-ttu-id="62fea-129">Un exemple de non-exécution en mode composant consisterait à effectuer une sauvegarde de l’image système, où l’application de sauvegarde aurait besoin de la coopération de l’enregistreur pour garantir la stabilité des données, mais où la sélection des composants serait sans importance.</span><span class="sxs-lookup"><span data-stu-id="62fea-129">An example of not running in component mode would be performing a system image backup, where the backup application would need writer cooperation to ensure data stability but where selection of components would be irrelevant.</span></span>

</dd> <dt>

<span data-ttu-id="62fea-130"><span id="Saving_Bootable_State"></span><span id="saving_bootable_state"></span><span id="SAVING_BOOTABLE_STATE"></span>Enregistrement de l’état de démarrage</span><span class="sxs-lookup"><span data-stu-id="62fea-130"><span id="Saving_Bootable_State"></span><span id="saving_bootable_state"></span><span id="SAVING_BOOTABLE_STATE"></span>Saving Bootable State</span></span>
</dt> <dd>

<span data-ttu-id="62fea-131">VSS prend en charge l’enregistrement de l’état du système en cours d’exécution dans une configuration entièrement démarrable.</span><span class="sxs-lookup"><span data-stu-id="62fea-131">VSS supports saving the running system state in a fully bootable configuration.</span></span> <span data-ttu-id="62fea-132">Toutefois, cela n’est pas toujours nécessaire, et la préparation du writer pour enregistrer un état de démarrage peut parfois dégrader les performances en temps réel d’un système en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="62fea-132">However, this is not always necessary, and writer preparation to save a bootable state can sometimes degrade real-time performance of a running system.</span></span>

<span data-ttu-id="62fea-133">Par conséquent, les demandeurs indiquent si une sauvegarde doit inclure un État du système de démarrage en tant qu’argument de [**IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="62fea-133">Therefore, requesters indicate whether a backup will include a bootable system state as an argument to [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span> <span data-ttu-id="62fea-134">Les enregistreurs déterminent s’ils doivent prendre en charge l’enregistrement de l’état du système de démarrage en appelant [**CVssWriter :: IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup).</span><span class="sxs-lookup"><span data-stu-id="62fea-134">Writers determine whether they have to support saving the bootable system state by calling [**CVssWriter::IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup).</span></span>

<span data-ttu-id="62fea-135">Même si l’état du système de démarrage n’est pas sélectionné, les clichés instantanés des fichiers système sont créés et les fichiers peuvent être sauvegardés.</span><span class="sxs-lookup"><span data-stu-id="62fea-135">Even if bootable system state is not selected, shadow copies of the system files will be made and the files may be backed up.</span></span>

<span data-ttu-id="62fea-136">Toutefois, il est important de veiller à la restauration des fichiers système si la sauvegarde n’a pas enregistré l’état du système de démarrage (voir [sauvegarde et restauration de l’état du système dans Windows server 2003 R2 et Windows server 2003 SP1](backing-up-and-restoring-system-state-under-vss.md)).</span><span class="sxs-lookup"><span data-stu-id="62fea-136">However, great care should be exercised in restoring system files if the backup did not save the bootable system state (see [Backing Up and Restoring System State in Windows Server 2003 R2 and Windows Server 2003 SP1](backing-up-and-restoring-system-state-under-vss.md)).</span></span>

<span data-ttu-id="62fea-137">Il n’est pas possible de récupérer ces informations à partir d’un document de composants de sauvegarde récupérés, afin que les auteurs de demandeurs doivent stocker si le système a été sauvegardé avec un état système de démarrage.</span><span class="sxs-lookup"><span data-stu-id="62fea-137">It is not possible to recover this information from a retrieved Backup Components Document, so requester authors should store whether the system was backed up with a bootable system state or not.</span></span>

</dd> <dt>

<span data-ttu-id="62fea-138"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Prise en charge partielle des fichiers</span><span class="sxs-lookup"><span data-stu-id="62fea-138"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Partial File Support</span></span>
</dt> <dd>

<span data-ttu-id="62fea-139">Certains enregistreurs prennent en charge la restauration de fichiers par le biais du remplacement des parties des fichiers qu’ils gèrent.</span><span class="sxs-lookup"><span data-stu-id="62fea-139">Some writers support file restoration through the overwriting of parts of the files they manage.</span></span> <span data-ttu-id="62fea-140">Un demandeur peut être conçu pour tirer parti de cela et, si tel est le cas, il indique cela en définissant les informations dans [**IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="62fea-140">A requester may be designed to take advantage of this, and if so it indicates this by setting the information in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span>

</dd> </dl>

 

 



