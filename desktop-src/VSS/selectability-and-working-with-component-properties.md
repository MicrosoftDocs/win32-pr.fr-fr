---
description: L’utilisation de composants sélectionnés implicitement nécessite l’accès aux documents de métadonnées document et enregistreur de composants de sauvegarde.
ms.assetid: ede51931-be50-4286-818b-0e6122247bdd
title: Sélection et utilisation des propriétés de composant
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83d06683bafb02802d84f152f1ceb662eb7491f2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104115142"
---
# <a name="selectability-and-working-with-component-properties"></a><span data-ttu-id="5e217-103">Sélection et utilisation des propriétés de composant</span><span class="sxs-lookup"><span data-stu-id="5e217-103">Selectability and Working with Component Properties</span></span>

<span data-ttu-id="5e217-104">L’utilisation de composants sélectionnés implicitement nécessite l’accès aux documents de métadonnées document et enregistreur de composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5e217-104">Working with implicitly selected components requires access to both the Backup Components Document and Writer Metadata Documents.</span></span>

<span data-ttu-id="5e217-105">Il existe deux raisons à cela :</span><span class="sxs-lookup"><span data-stu-id="5e217-105">There are two reasons for this:</span></span>

-   <span data-ttu-id="5e217-106">Les données de composant stockées dans le document des composants de sauvegarde (représentées par l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) ) ne sont pas accessibles à des informations sur le jeu de fichiers du composant (spécification de fichier, chemin d’accès et indicateur de récurrence).</span><span class="sxs-lookup"><span data-stu-id="5e217-106">The component data stored in the Backup Components Document (represented by the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface) lacks access to component file set information—file specification, path, and recursion flag.</span></span> <span data-ttu-id="5e217-107">(Consultez [utilisation du document sur les composants de sauvegarde](working-with-the-backup-components-document.md).)</span><span class="sxs-lookup"><span data-stu-id="5e217-107">(See [Working with the Backup Components Document](working-with-the-backup-components-document.md).)</span></span>
-   <span data-ttu-id="5e217-108">Seuls les composants [*inclus explicitement*](vssgloss-e.md) dans le document composants de sauvegarde lors de la sauvegarde disposent de leurs informations directement stockées dans le document sur les composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5e217-108">Only components that are [*included explicitly*](vssgloss-e.md) in the Backup Components Document during backup have their information directly stored in the Backup Components Document.</span></span> <span data-ttu-id="5e217-109">Les demandeurs et les Writers doivent utiliser les informations disponibles par le biais de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , conjointement avec les informations de [*chemin d’accès logique*](vssgloss-l.md) et les documents de métadonnées d’écriture pour obtenir des informations et définir les propriétés des composants [*inclus implicitement*](vssgloss-i.md) .</span><span class="sxs-lookup"><span data-stu-id="5e217-109">Requesters and writers must use the information available through the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, in conjunction with [*logical path*](vssgloss-l.md) information and Writer Metadata Documents to obtain information about, and set properties of, [*implicitly included*](vssgloss-i.md) components.</span></span>

<span data-ttu-id="5e217-110">Le cas « MyWriter » présenté dans [chemin logique des composants](logical-pathing-of-components.md) peut être utilisé pour illustrer la sélectivité de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5e217-110">The "MyWriter" case discussed in [Logical Pathing of Components](logical-pathing-of-components.md) can be used to illustrate selectability for backup.</span></span>



| <span data-ttu-id="5e217-111">Nom du composant</span><span class="sxs-lookup"><span data-stu-id="5e217-111">Component name</span></span> | <span data-ttu-id="5e217-112">Chemin logique</span><span class="sxs-lookup"><span data-stu-id="5e217-112">Logical path</span></span>            | <span data-ttu-id="5e217-113">Sélectionnable pour la sauvegarde</span><span class="sxs-lookup"><span data-stu-id="5e217-113">Selectable for backup</span></span> | <span data-ttu-id="5e217-114">Sélectionnable pour la restauration</span><span class="sxs-lookup"><span data-stu-id="5e217-114">Selectable for restore</span></span> | <span data-ttu-id="5e217-115">Inclus explicitement</span><span class="sxs-lookup"><span data-stu-id="5e217-115">Explicitly included</span></span> |
|----------------|-------------------------|-----------------------|------------------------|---------------------|
| <span data-ttu-id="5e217-116">Exécut</span><span class="sxs-lookup"><span data-stu-id="5e217-116">"Executables"</span></span>  | <span data-ttu-id="5e217-117">""</span><span class="sxs-lookup"><span data-stu-id="5e217-117">""</span></span>                      | <span data-ttu-id="5e217-118">N</span><span class="sxs-lookup"><span data-stu-id="5e217-118">N</span></span>                     | <span data-ttu-id="5e217-119">N</span><span class="sxs-lookup"><span data-stu-id="5e217-119">N</span></span>                      | <span data-ttu-id="5e217-120">O</span><span class="sxs-lookup"><span data-stu-id="5e217-120">Y</span></span>                   |
| <span data-ttu-id="5e217-121">"ConfigFiles"</span><span class="sxs-lookup"><span data-stu-id="5e217-121">"ConfigFiles"</span></span>  | <span data-ttu-id="5e217-122">Exécut</span><span class="sxs-lookup"><span data-stu-id="5e217-122">"Executables"</span></span>           | <span data-ttu-id="5e217-123">N</span><span class="sxs-lookup"><span data-stu-id="5e217-123">N</span></span>                     | <span data-ttu-id="5e217-124">N</span><span class="sxs-lookup"><span data-stu-id="5e217-124">N</span></span>                      | <span data-ttu-id="5e217-125">O</span><span class="sxs-lookup"><span data-stu-id="5e217-125">Y</span></span>                   |
| <span data-ttu-id="5e217-126">"LicenseInfo"</span><span class="sxs-lookup"><span data-stu-id="5e217-126">"LicenseInfo"</span></span>  | <span data-ttu-id="5e217-127">""</span><span class="sxs-lookup"><span data-stu-id="5e217-127">""</span></span>                      | <span data-ttu-id="5e217-128">O</span><span class="sxs-lookup"><span data-stu-id="5e217-128">Y</span></span>                     | <span data-ttu-id="5e217-129">N</span><span class="sxs-lookup"><span data-stu-id="5e217-129">N</span></span>                      | <span data-ttu-id="5e217-130">O</span><span class="sxs-lookup"><span data-stu-id="5e217-130">Y</span></span>                   |
| <span data-ttu-id="5e217-131">« Security »</span><span class="sxs-lookup"><span data-stu-id="5e217-131">"Security"</span></span>     | <span data-ttu-id="5e217-132">""</span><span class="sxs-lookup"><span data-stu-id="5e217-132">""</span></span>                      | <span data-ttu-id="5e217-133">O</span><span class="sxs-lookup"><span data-stu-id="5e217-133">Y</span></span>                     | <span data-ttu-id="5e217-134">N</span><span class="sxs-lookup"><span data-stu-id="5e217-134">N</span></span>                      | <span data-ttu-id="5e217-135">O</span><span class="sxs-lookup"><span data-stu-id="5e217-135">Y</span></span>                   |
| <span data-ttu-id="5e217-136">UserInfo</span><span class="sxs-lookup"><span data-stu-id="5e217-136">"UserInfo"</span></span>     | <span data-ttu-id="5e217-137">« Security »</span><span class="sxs-lookup"><span data-stu-id="5e217-137">"Security"</span></span>              | <span data-ttu-id="5e217-138">N</span><span class="sxs-lookup"><span data-stu-id="5e217-138">N</span></span>                     | <span data-ttu-id="5e217-139">N</span><span class="sxs-lookup"><span data-stu-id="5e217-139">N</span></span>                      | <span data-ttu-id="5e217-140">N</span><span class="sxs-lookup"><span data-stu-id="5e217-140">N</span></span>                   |
| <span data-ttu-id="5e217-141">EUR.1</span><span class="sxs-lookup"><span data-stu-id="5e217-141">"Certificates"</span></span> | <span data-ttu-id="5e217-142">« Security »</span><span class="sxs-lookup"><span data-stu-id="5e217-142">"Security"</span></span>              | <span data-ttu-id="5e217-143">N</span><span class="sxs-lookup"><span data-stu-id="5e217-143">N</span></span>                     | <span data-ttu-id="5e217-144">N</span><span class="sxs-lookup"><span data-stu-id="5e217-144">N</span></span>                      | <span data-ttu-id="5e217-145">N</span><span class="sxs-lookup"><span data-stu-id="5e217-145">N</span></span>                   |
| <span data-ttu-id="5e217-146">"writerData"</span><span class="sxs-lookup"><span data-stu-id="5e217-146">"writerData"</span></span>   | <span data-ttu-id="5e217-147">""</span><span class="sxs-lookup"><span data-stu-id="5e217-147">""</span></span>                      | <span data-ttu-id="5e217-148">O</span><span class="sxs-lookup"><span data-stu-id="5e217-148">Y</span></span>                     | <span data-ttu-id="5e217-149">O</span><span class="sxs-lookup"><span data-stu-id="5e217-149">Y</span></span>                      | <span data-ttu-id="5e217-150">O</span><span class="sxs-lookup"><span data-stu-id="5e217-150">Y</span></span>                   |
| <span data-ttu-id="5e217-151">Jeu1</span><span class="sxs-lookup"><span data-stu-id="5e217-151">"Set1"</span></span>         | <span data-ttu-id="5e217-152">"writerData"</span><span class="sxs-lookup"><span data-stu-id="5e217-152">"writerData"</span></span>            | <span data-ttu-id="5e217-153">N</span><span class="sxs-lookup"><span data-stu-id="5e217-153">N</span></span>                     | <span data-ttu-id="5e217-154">O</span><span class="sxs-lookup"><span data-stu-id="5e217-154">Y</span></span>                      | <span data-ttu-id="5e217-155">N</span><span class="sxs-lookup"><span data-stu-id="5e217-155">N</span></span>                   |
| <span data-ttu-id="5e217-156">Janvier</span><span class="sxs-lookup"><span data-stu-id="5e217-156">"Jan"</span></span>          | <span data-ttu-id="5e217-157">« writerData \\ Set1 »</span><span class="sxs-lookup"><span data-stu-id="5e217-157">"writerData\\Set1"</span></span>      | <span data-ttu-id="5e217-158">N</span><span class="sxs-lookup"><span data-stu-id="5e217-158">N</span></span>                     | <span data-ttu-id="5e217-159">N</span><span class="sxs-lookup"><span data-stu-id="5e217-159">N</span></span>                      | <span data-ttu-id="5e217-160">N</span><span class="sxs-lookup"><span data-stu-id="5e217-160">N</span></span>                   |
| <span data-ttu-id="5e217-161">Decembre</span><span class="sxs-lookup"><span data-stu-id="5e217-161">"Dec"</span></span>          | <span data-ttu-id="5e217-162">« writerData \\ Set1 »</span><span class="sxs-lookup"><span data-stu-id="5e217-162">"writerData\\Set1"</span></span>      | <span data-ttu-id="5e217-163">N</span><span class="sxs-lookup"><span data-stu-id="5e217-163">N</span></span>                     | <span data-ttu-id="5e217-164">N</span><span class="sxs-lookup"><span data-stu-id="5e217-164">N</span></span>                      | <span data-ttu-id="5e217-165">N</span><span class="sxs-lookup"><span data-stu-id="5e217-165">N</span></span>                   |
| <span data-ttu-id="5e217-166">Set2</span><span class="sxs-lookup"><span data-stu-id="5e217-166">"Set2"</span></span>         | <span data-ttu-id="5e217-167">"writerData"</span><span class="sxs-lookup"><span data-stu-id="5e217-167">"writerData"</span></span>            | <span data-ttu-id="5e217-168">N</span><span class="sxs-lookup"><span data-stu-id="5e217-168">N</span></span>                     | <span data-ttu-id="5e217-169">O</span><span class="sxs-lookup"><span data-stu-id="5e217-169">Y</span></span>                      | <span data-ttu-id="5e217-170">N</span><span class="sxs-lookup"><span data-stu-id="5e217-170">N</span></span>                   |
| <span data-ttu-id="5e217-171">Janvier</span><span class="sxs-lookup"><span data-stu-id="5e217-171">"Jan"</span></span>          | <span data-ttu-id="5e217-172">« writerData \\ Set2 »</span><span class="sxs-lookup"><span data-stu-id="5e217-172">"writerData\\Set2"</span></span>      | <span data-ttu-id="5e217-173">N</span><span class="sxs-lookup"><span data-stu-id="5e217-173">N</span></span>                     | <span data-ttu-id="5e217-174">N</span><span class="sxs-lookup"><span data-stu-id="5e217-174">N</span></span>                      | <span data-ttu-id="5e217-175">N</span><span class="sxs-lookup"><span data-stu-id="5e217-175">N</span></span>                   |
| <span data-ttu-id="5e217-176">Decembre</span><span class="sxs-lookup"><span data-stu-id="5e217-176">"Dec"</span></span>          | <span data-ttu-id="5e217-177">« writerData \\ Set2 »</span><span class="sxs-lookup"><span data-stu-id="5e217-177">"writerData\\Set2"</span></span>      | <span data-ttu-id="5e217-178">N</span><span class="sxs-lookup"><span data-stu-id="5e217-178">N</span></span>                     | <span data-ttu-id="5e217-179">N</span><span class="sxs-lookup"><span data-stu-id="5e217-179">N</span></span>                      | <span data-ttu-id="5e217-180">N</span><span class="sxs-lookup"><span data-stu-id="5e217-180">N</span></span>                   |
| <span data-ttu-id="5e217-181">Demande</span><span class="sxs-lookup"><span data-stu-id="5e217-181">"Query"</span></span>        | <span data-ttu-id="5e217-182">« writerData \\ QueryLogs »</span><span class="sxs-lookup"><span data-stu-id="5e217-182">"writerData\\QueryLogs"</span></span> | <span data-ttu-id="5e217-183">N</span><span class="sxs-lookup"><span data-stu-id="5e217-183">N</span></span>                     | <span data-ttu-id="5e217-184">N</span><span class="sxs-lookup"><span data-stu-id="5e217-184">N</span></span>                      | <span data-ttu-id="5e217-185">N</span><span class="sxs-lookup"><span data-stu-id="5e217-185">N</span></span>                   |
| <span data-ttu-id="5e217-186">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="5e217-186">"Usage"</span></span>        | <span data-ttu-id="5e217-187">"writerData"</span><span class="sxs-lookup"><span data-stu-id="5e217-187">"writerData"</span></span>            | <span data-ttu-id="5e217-188">O</span><span class="sxs-lookup"><span data-stu-id="5e217-188">Y</span></span>                     | <span data-ttu-id="5e217-189">O</span><span class="sxs-lookup"><span data-stu-id="5e217-189">Y</span></span>                      | <span data-ttu-id="5e217-190">N</span><span class="sxs-lookup"><span data-stu-id="5e217-190">N</span></span>                   |
| <span data-ttu-id="5e217-191">Janvier</span><span class="sxs-lookup"><span data-stu-id="5e217-191">"Jan"</span></span>          | <span data-ttu-id="5e217-192">« utilisation de writerData \\ »</span><span class="sxs-lookup"><span data-stu-id="5e217-192">"writerData\\Usage"</span></span>     | <span data-ttu-id="5e217-193">N</span><span class="sxs-lookup"><span data-stu-id="5e217-193">N</span></span>                     | <span data-ttu-id="5e217-194">N</span><span class="sxs-lookup"><span data-stu-id="5e217-194">N</span></span>                      | <span data-ttu-id="5e217-195">N</span><span class="sxs-lookup"><span data-stu-id="5e217-195">N</span></span>                   |
| <span data-ttu-id="5e217-196">Decembre</span><span class="sxs-lookup"><span data-stu-id="5e217-196">"Dec"</span></span>          | <span data-ttu-id="5e217-197">« utilisation de writerData \\ »</span><span class="sxs-lookup"><span data-stu-id="5e217-197">"writerData\\Usage"</span></span>     | <span data-ttu-id="5e217-198">N</span><span class="sxs-lookup"><span data-stu-id="5e217-198">N</span></span>                     | <span data-ttu-id="5e217-199">N</span><span class="sxs-lookup"><span data-stu-id="5e217-199">N</span></span>                      | <span data-ttu-id="5e217-200">N</span><span class="sxs-lookup"><span data-stu-id="5e217-200">N</span></span>                   |



 

## <a name="implicitly-included-components-in-the-backup-set"></a><span data-ttu-id="5e217-201">Composants inclus implicitement dans le jeu de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="5e217-201">Implicitly Included Components in the Backup Set</span></span>

<span data-ttu-id="5e217-202">En examinant le document des métadonnées de l’enregistreur d’un enregistreur (voir [**IVssBackupComponents :: GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata)) pendant la sauvegarde, un demandeur doit stocker une liste de tous les composants, leurs [*chemins d’accès logiques*](vssgloss-l.md)et leurs informations sur le jeu de fichiers.</span><span class="sxs-lookup"><span data-stu-id="5e217-202">While examining a writer's Writer Metadata Document (see [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata)) during backup, a requester should be storing a list of all components, their [*logical paths*](vssgloss-l.md), and their file set information.</span></span>

<span data-ttu-id="5e217-203">Le jeu de fichiers et les informations sur les fichiers exclus seront nécessaires pour déterminer une liste de fichiers pour tout composant inclus (explicitement ou implicitement).</span><span class="sxs-lookup"><span data-stu-id="5e217-203">File set and excluded file information will be needed to determine a list of files for any (explicitly or implicitly) included component.</span></span>

<span data-ttu-id="5e217-204">Pour les composants de sauvegarde non sélectionnables pour les ancêtres de sauvegarde et sélectionnables pour les composants de sauvegarde qui ne définissent pas de [*jeu de composants*](vssgloss-c.md), seul le jeu de fichiers et les informations sur les fichiers exclus seront nécessaires pour identifier tous les candidats du composant pour la sauvegarde, car ces composants ne définissent pas les sous-composants.</span><span class="sxs-lookup"><span data-stu-id="5e217-204">For nonselectable for backup components with no selectable for backup ancestors and selectable for backup components that do not define a [*component set*](vssgloss-c.md), only file set and excluded file information will be needed to identify all the component's candidates for backup, because these components do not define subcomponents.</span></span>

<span data-ttu-id="5e217-205">Pour les composants sélectionnables explicitement pour les composants de sauvegarde qui définissent un jeu de composants, les jeux de fichiers et les informations sur les fichiers d’exclusion pour le composant de définition et tous les sous- [*composants*](vssgloss-s.md) doivent être utilisés pour sélectionner les fichiers à sauvegarder.</span><span class="sxs-lookup"><span data-stu-id="5e217-205">For explicitly included selectable for backup components that define a component set, the file sets and exclude file information both for the defining component and all [*subcomponents*](vssgloss-s.md) needs to be used to select files for backup.</span></span>

<span data-ttu-id="5e217-206">Cela signifie que les jeux de sauvegarde des composants « exécutables », « ConfigFiles » et « LicenseInfo » ne peuvent être trouvés qu’en examinant uniquement les métadonnées de l’enregistreur pour ces composants à l’aide de leurs instances de l’interface [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) .</span><span class="sxs-lookup"><span data-stu-id="5e217-206">This means that backup sets for the components "Executables", "ConfigFiles", and "LicenseInfo" can be found only by examining the writer metadata for just these components using their instances of the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface.</span></span>

<span data-ttu-id="5e217-207">Toutefois, si writerData est explicitement inclus dans la sauvegarde, vous devez examiner son instance de l’interface [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) et celles de « Set1 », « Jan » (avec le chemin d’accès logique « writerData \\ SET1 »),» Dec» (avec le chemin d’accès logique « writerData \\ SET1 »), « Set2 », « Jan » (avec le chemin d’accès logique « writerData \\ SET2 »), « Dec » (avec le chemin d’accès logique « writerData \\ SET2 »), « Query », « usage », « Jan » (avec le chemin d’accès logique « WriterData usage ») \\ et «DEC \\</span><span class="sxs-lookup"><span data-stu-id="5e217-207">However, if writerData is explicitly included in the backup, you must examine its instance of the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface and those for "Set1", "Jan" (with logical path "writerData\\Set1"), "Dec" (with logical path "writerData\\Set1"), "Set2", "Jan" (with logical path "writerData\\Set2"), "Dec" (with logical path "writerData\\Set2"), "Query", "Usage", "Jan" (with logical path "writerData\\Usage"), and "Dec" (with logical path "writerData\\Usage").</span></span>

<span data-ttu-id="5e217-208">Pour ce faire, un demandeur devra d’abord identifier que le composant « writerData » (chemin logique «») est sélectionnable.</span><span class="sxs-lookup"><span data-stu-id="5e217-208">To do this, a requester will have to first identify that the component "writerData" (logical path "") is selectable.</span></span> <span data-ttu-id="5e217-209">Il devra ensuite analyser tous les autres composants gérés par le writer pour déterminer si le premier élément de son chemin logique est « writerData ».</span><span class="sxs-lookup"><span data-stu-id="5e217-209">It will then have to scan all the other components managed by the writer to determine whether the first element in their logical path is "writerData".</span></span> <span data-ttu-id="5e217-210">Les composants dont le chemin logique est « writerData » sont identifiés comme des sous-composants de « writerData » et sont implicitement sélectionnés lorsqu’ils sont explicitement sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="5e217-210">Those components that have "writerData" as the leading members of their logical path are identified as being subcomponents of "writerData" and are implicitly selected when it is explicitly selected.</span></span>

<span data-ttu-id="5e217-211">En fait, une analyse similaire doit être effectuée pour déterminer qu’aucun composant n’a « LicenseInfo » comme membre de début de son chemin logique, ce qui signifie que « LicenseInfo » n’a aucun sous-composant.</span><span class="sxs-lookup"><span data-stu-id="5e217-211">In fact, a similar scan will need to be made to determine that no component has "LicenseInfo" as the leading member of its logical path, and thus that "LicenseInfo" has no subcomponents.</span></span>

<span data-ttu-id="5e217-212">En raison de la complexité de ce mécanisme dans VSS, de nombreux enregistreurs de demandeurs peuvent trouver utile de créer leurs propres structures pour stocker des informations sur les jeux de sauvegarde et les composants de manière explicite et implicite.</span><span class="sxs-lookup"><span data-stu-id="5e217-212">Because of the complexity of this mechanism in VSS, many requester writers may find it useful to create their own structures for storing component and backup set information for both explicitly and implicitly added components.</span></span>

## <a name="properties-of-implicitly-included-components"></a><span data-ttu-id="5e217-213">Propriétés des composants inclus implicitement</span><span class="sxs-lookup"><span data-stu-id="5e217-213">Properties of Implicitly Included Components</span></span>

<span data-ttu-id="5e217-214">Lors des opérations de restauration et de sauvegarde, les instances des interfaces [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) et [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) sont utilisées à la fois pour récupérer des informations sur les composants et pour définir ou modifier les propriétés d’un composant.</span><span class="sxs-lookup"><span data-stu-id="5e217-214">During restore and backup operations, instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) and [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interfaces are used both to retrieve information about components, and to set or change component properties.</span></span> <span data-ttu-id="5e217-215">Toutefois, seuls les composants explicitement inclus auront des instances de l’interface **IVssComponent** ou seront accessibles à l’interface **IVssBackupComponents** .</span><span class="sxs-lookup"><span data-stu-id="5e217-215">However, only components explicitly included will have instances of the **IVssComponent** interface or be accessible to the **IVssBackupComponents** interface.</span></span>

<span data-ttu-id="5e217-216">Certaines propriétés sont définies à l’échelle des composants dans l’étendue.</span><span class="sxs-lookup"><span data-stu-id="5e217-216">Some properties are component-set-wide in scope.</span></span> <span data-ttu-id="5e217-217">Ces propriétés sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="5e217-217">These properties include the following:</span></span>

-   <span data-ttu-id="5e217-218">État de la sauvegarde et de la restauration :</span><span class="sxs-lookup"><span data-stu-id="5e217-218">Backup and restore status:</span></span> <dl>

[<span data-ttu-id="5e217-219">**IVssBackupComponents::SetBackupSucceeded**</span><span class="sxs-lookup"><span data-stu-id="5e217-219">**IVssBackupComponents::SetBackupSucceeded**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)  
    [<span data-ttu-id="5e217-220">**IVssComponent::GetBackupSucceeded**</span><span class="sxs-lookup"><span data-stu-id="5e217-220">**IVssComponent::GetBackupSucceeded**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)  
    [<span data-ttu-id="5e217-221">**IVssBackupComponents::SetFileRestoreStatus**</span><span class="sxs-lookup"><span data-stu-id="5e217-221">**IVssBackupComponents::SetFileRestoreStatus**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)  
    [<span data-ttu-id="5e217-222">**IVssComponent::GetFileRestoreStatus**</span><span class="sxs-lookup"><span data-stu-id="5e217-222">**IVssComponent::GetFileRestoreStatus**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)  
    </dl>
-   <span data-ttu-id="5e217-223">Options de sauvegarde et de restauration :</span><span class="sxs-lookup"><span data-stu-id="5e217-223">Backup and restore options:</span></span> <dl>

[<span data-ttu-id="5e217-224">**IVssBackupComponents::SetBackupOptions**</span><span class="sxs-lookup"><span data-stu-id="5e217-224">**IVssBackupComponents::SetBackupOptions**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions)  
    [<span data-ttu-id="5e217-225">**IVssComponent::GetBackupOptions**</span><span class="sxs-lookup"><span data-stu-id="5e217-225">**IVssComponent::GetBackupOptions**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions)  
    [<span data-ttu-id="5e217-226">**IVssBackupComponents::SetRestoreOptions**</span><span class="sxs-lookup"><span data-stu-id="5e217-226">**IVssBackupComponents::SetRestoreOptions**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions)  
    [<span data-ttu-id="5e217-227">**IVssComponent::GetRestoreOptions**</span><span class="sxs-lookup"><span data-stu-id="5e217-227">**IVssComponent::GetRestoreOptions**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions)  
    </dl>
-   <span data-ttu-id="5e217-228">Messages d’échec :</span><span class="sxs-lookup"><span data-stu-id="5e217-228">Failure messages:</span></span> <dl>

[<span data-ttu-id="5e217-229">**IVssComponent::SetPostRestoreFailureMsg**</span><span class="sxs-lookup"><span data-stu-id="5e217-229">**IVssComponent::SetPostRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)  
    [<span data-ttu-id="5e217-230">**IVssComponent::SetPreRestoreFailureMsg**</span><span class="sxs-lookup"><span data-stu-id="5e217-230">**IVssComponent::SetPreRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg)  
    [<span data-ttu-id="5e217-231">**IVssComponent::SetPostRestoreFailureMsg**</span><span class="sxs-lookup"><span data-stu-id="5e217-231">**IVssComponent::SetPostRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)  
    [<span data-ttu-id="5e217-232">**IVssComponent::SetPreRestoreFailureMsg**</span><span class="sxs-lookup"><span data-stu-id="5e217-232">**IVssComponent::SetPreRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg)  
    </dl>
-   <span data-ttu-id="5e217-233">Cibles de restauration :</span><span class="sxs-lookup"><span data-stu-id="5e217-233">Restore targets:</span></span> <dl>

[<span data-ttu-id="5e217-234">**IVssComponent::SetRestoreTarget**</span><span class="sxs-lookup"><span data-stu-id="5e217-234">**IVssComponent::SetRestoreTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget)  
    [<span data-ttu-id="5e217-235">**IVssComponent::GetRestoreTarget**</span><span class="sxs-lookup"><span data-stu-id="5e217-235">**IVssComponent::GetRestoreTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget)  
    </dl>
-   <span data-ttu-id="5e217-236">Tampons de sauvegarde :</span><span class="sxs-lookup"><span data-stu-id="5e217-236">Backup stamps:</span></span> <dl>

[<span data-ttu-id="5e217-237">**IVssComponent::SetBackupStamp**</span><span class="sxs-lookup"><span data-stu-id="5e217-237">**IVssComponent::SetBackupStamp**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)  
    [<span data-ttu-id="5e217-238">**IVssComponent::GetBackupStamp**</span><span class="sxs-lookup"><span data-stu-id="5e217-238">**IVssComponent::GetBackupStamp**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)  
    </dl>
-   <span data-ttu-id="5e217-239">Métadonnées supplémentaires :</span><span class="sxs-lookup"><span data-stu-id="5e217-239">Additional metadata:</span></span> <dl>

[<span data-ttu-id="5e217-240">**IVssComponent::SetRestoreMetadata**</span><span class="sxs-lookup"><span data-stu-id="5e217-240">**IVssComponent::SetRestoreMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)  
    [<span data-ttu-id="5e217-241">**IVssComponent::GetRestoreMetadata**</span><span class="sxs-lookup"><span data-stu-id="5e217-241">**IVssComponent::GetRestoreMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)  
    [<span data-ttu-id="5e217-242">**IVssComponent::SetBackupMetadata**</span><span class="sxs-lookup"><span data-stu-id="5e217-242">**IVssComponent::SetBackupMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)  
    [<span data-ttu-id="5e217-243">**IVssComponent::GetBackupMetadata**</span><span class="sxs-lookup"><span data-stu-id="5e217-243">**IVssComponent::GetBackupMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)  
    </dl>

<span data-ttu-id="5e217-244">Par conséquent, vous utilisez l’instance de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) du membre de définition d’un jeu de composants ou utilisez le nom, le type et le chemin logique du membre de définition avec une méthode [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) pour définir ou récupérer les propriétés de tous les membres du jeu de composants.</span><span class="sxs-lookup"><span data-stu-id="5e217-244">Therefore, you use the instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface of a component set's defining member or use the defining member's name, type, and logical path with an [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) method to set or retrieve properties for all the component set's members.</span></span>

<span data-ttu-id="5e217-245">Pour cette raison, les jeux de composants sont traités comme des unités.</span><span class="sxs-lookup"><span data-stu-id="5e217-245">For this reason, component sets are treated as units.</span></span> <span data-ttu-id="5e217-246">Par exemple, la sauvegarde d’un jeu de composants est réussie uniquement si la sauvegarde de tous les jeux de fichiers de tous ses composants est réussie.</span><span class="sxs-lookup"><span data-stu-id="5e217-246">For instance, a backup of a component set is successful only if the backup of all of the file sets of all of its components is successful.</span></span>

<span data-ttu-id="5e217-247">Dans l’exemple précédent, supposons qu’un fichier du composant « Jan » (avec le chemin d’accès logique « writerData \\ SET2 ») soit membre du jeu de composants défini par « writerData ».</span><span class="sxs-lookup"><span data-stu-id="5e217-247">In the preceding example, suppose one file in the component "Jan" (with logical path "writerData\\Set2") is a member of the component set defined by "writerData".</span></span> <span data-ttu-id="5e217-248">Si l’un des fichiers de « Jan » n’a pas pu être sauvegardé, un demandeur utilise les informations de « writerData » (son nom « writerData », son chemin d’accès «» et son type de composant) comme arguments lors de la définition de [**IVssBackupComponents :: SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) avec la **valeur false** pour indiquer la défaillance du jeu de composants.</span><span class="sxs-lookup"><span data-stu-id="5e217-248">If one of "Jan"'s files failed to back up, a requester would use "writerData"'s information (its name "writerData", its path "", and its component type) as arguments when setting [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) with **false** to indicate the component set's failure.</span></span>

<span data-ttu-id="5e217-249">De même, l’état retourné par [**IVssComponent :: GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded) pour l’instance de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) « writerData » s’applique non seulement à « writerData », mais également à tous ses sous-composants.</span><span class="sxs-lookup"><span data-stu-id="5e217-249">Similarly, the state returned by [**IVssComponent::GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded) for "writerData"'s instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface applies not just to "writerData" but to all its subcomponents as well.</span></span>

<span data-ttu-id="5e217-250">En outre, si un enregistreur a choisi de modifier la cible de restauration à l’aide de [**IVssComponent :: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget) de l’instance de [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent)« writerData », cela modifierait la cible de restauration de tous les jeux de fichiers de tous les sous-composants de « writerData ».</span><span class="sxs-lookup"><span data-stu-id="5e217-250">In addition, if a writer chose to change the restore target using [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget) of "writerData"'s instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), that would change the restore target for all the file sets of all of "writerData"'s subcomponents.</span></span>

<span data-ttu-id="5e217-251">Les propriétés suivantes ne s’appliquent pas à l’ensemble du composant, mais à des fichiers ou jeux de fichiers particuliers :</span><span class="sxs-lookup"><span data-stu-id="5e217-251">The following properties apply not component-wide, but to particular files or file sets:</span></span>

-   <span data-ttu-id="5e217-252">Mappages d’emplacements secondaires :</span><span class="sxs-lookup"><span data-stu-id="5e217-252">Alternate location mappings:</span></span> <dl>

[<span data-ttu-id="5e217-253">**IVssBackupComponents::AddAlternativeLocationMapping**</span><span class="sxs-lookup"><span data-stu-id="5e217-253">**IVssBackupComponents::AddAlternativeLocationMapping**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping)  
    [<span data-ttu-id="5e217-254">**IVssComponent::GetAlternateLocationMapping**</span><span class="sxs-lookup"><span data-stu-id="5e217-254">**IVssComponent::GetAlternateLocationMapping**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping)  
    [<span data-ttu-id="5e217-255">**IVssComponent::GetAlternateLocationMappingCount**</span><span class="sxs-lookup"><span data-stu-id="5e217-255">**IVssComponent::GetAlternateLocationMappingCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount)  
    </dl>
-   <span data-ttu-id="5e217-256">Fichiers différenciés :</span><span class="sxs-lookup"><span data-stu-id="5e217-256">Differenced files:</span></span> <dl>

[<span data-ttu-id="5e217-257">**IVssComponent::AddDifferencedFilesByLastModifyTime**</span><span class="sxs-lookup"><span data-stu-id="5e217-257">**IVssComponent::AddDifferencedFilesByLastModifyTime**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime)  
    [<span data-ttu-id="5e217-258">**IVssComponent::GetDifferencedFile**</span><span class="sxs-lookup"><span data-stu-id="5e217-258">**IVssComponent::GetDifferencedFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile)  
    [<span data-ttu-id="5e217-259">**IVssComponent::GetDifferencedFilesCount**</span><span class="sxs-lookup"><span data-stu-id="5e217-259">**IVssComponent::GetDifferencedFilesCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount)  
    </dl>
-   <span data-ttu-id="5e217-260">Fichiers partiels :</span><span class="sxs-lookup"><span data-stu-id="5e217-260">Partial files:</span></span> <dl>

[<span data-ttu-id="5e217-261">**IVssComponent::AddPartialFile**</span><span class="sxs-lookup"><span data-stu-id="5e217-261">**IVssComponent::AddPartialFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile)  
    [<span data-ttu-id="5e217-262">**IVssComponent::GetPartialFile**</span><span class="sxs-lookup"><span data-stu-id="5e217-262">**IVssComponent::GetPartialFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)  
    [<span data-ttu-id="5e217-263">**IVssComponent::GetPartialFileCount**</span><span class="sxs-lookup"><span data-stu-id="5e217-263">**IVssComponent::GetPartialFileCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount)  
    </dl>
-   <span data-ttu-id="5e217-264">Cibles dirigées :</span><span class="sxs-lookup"><span data-stu-id="5e217-264">Directed targets:</span></span> <dl>

[<span data-ttu-id="5e217-265">**IVssComponent::AddDirectedTarget**</span><span class="sxs-lookup"><span data-stu-id="5e217-265">**IVssComponent::AddDirectedTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget)  
    [<span data-ttu-id="5e217-266">**IVssComponent::GetDirectedTarget**</span><span class="sxs-lookup"><span data-stu-id="5e217-266">**IVssComponent::GetDirectedTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget)  
    [<span data-ttu-id="5e217-267">**IVssComponent::GetDirectedTargetCount**</span><span class="sxs-lookup"><span data-stu-id="5e217-267">**IVssComponent::GetDirectedTargetCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount)  
    </dl>
-   <span data-ttu-id="5e217-268">Nouvelles cibles :</span><span class="sxs-lookup"><span data-stu-id="5e217-268">New targets:</span></span> <dl>

[<span data-ttu-id="5e217-269">**IVssBackupComponents::AddNewTarget**</span><span class="sxs-lookup"><span data-stu-id="5e217-269">**IVssBackupComponents::AddNewTarget**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget)  
    [<span data-ttu-id="5e217-270">**IVssComponent::GetNewTarget**</span><span class="sxs-lookup"><span data-stu-id="5e217-270">**IVssComponent::GetNewTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)  
    [<span data-ttu-id="5e217-271">**IVssComponent::GetNewTargetCount**</span><span class="sxs-lookup"><span data-stu-id="5e217-271">**IVssComponent::GetNewTargetCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount)  
    </dl>

<span data-ttu-id="5e217-272">Lorsqu’un demandeur accède à ces fonctionnalités pour un sous-composant à l’aide de l’interface [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) , il utilise les informations de composant pour le composant qui définit le jeu de composants, mais les informations sur le fichier ou le jeu de fichiers du sous-composant.</span><span class="sxs-lookup"><span data-stu-id="5e217-272">When a requester accesses these features for a subcomponent using the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface, it uses the component information for the component set's defining component, but the file or file set information for the subcomponent.</span></span>

<span data-ttu-id="5e217-273">De même, si la propriété est accessible via l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , l’instance correspondant au sous-composant de définition est utilisée, mais les arguments de fichier ou de jeu de fichiers sont extraits du sous-composant.</span><span class="sxs-lookup"><span data-stu-id="5e217-273">Likewise, if the property is accessible through the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, the instance corresponding to the defining subcomponent is used, but the file or file set arguments are taken from the subcomponent.</span></span>

<span data-ttu-id="5e217-274">Par exemple, supposons que le sous-composant « Jan » (avec le chemin d’accès logique « writerData \\ SET2 ») contenait un jeu de fichiers avec le chemin d’accès « c : \\ Fred », une spécification de fichier « \* . dat » et qu’un indicateur récursif de **true** puisse être restauré à un autre emplacement.</span><span class="sxs-lookup"><span data-stu-id="5e217-274">For instance, suppose the subcomponent "Jan" (with logical path "writerData\\Set2") had a file set with a path of "c:\\fred", a file specification of "\*.dat", and a recursive flag of **true** might have to be restored to an alternate location.</span></span>

<span data-ttu-id="5e217-275">Dans ce cas, un demandeur appelle [**IVssBackupComponents :: AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping), à l’aide des informations de « writerData » (type de composant, nom de composant « writeData » et un chemin d’accès logique « ») ainsi que des informations sur le jeu de fichiers «Jan » (chemin d’accès « c : \\ Fred », spécification de fichier « \* . dat » et récurrence égale **true**).</span><span class="sxs-lookup"><span data-stu-id="5e217-275">If this was the case, a requester would call [**IVssBackupComponents::AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping), using "writerData"'s information (component type, a component name of "writeData", and a logical path of "") along with "Jan"'s file set information (path "c:\\fred", file specification "\*.dat", and recursion equals **true**).</span></span>

<span data-ttu-id="5e217-276">Notez que dans ce cas, les informations du jeu de fichiers doivent correspondre exactement aux informations sur le jeu de fichiers utilisées par [**IVssCreateWriterMetadata :: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**IVssCreateWriterMetadata :: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles)ou [**IVssCreateWriterMetadata :: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) pour ajouter des fichiers à Jan.</span><span class="sxs-lookup"><span data-stu-id="5e217-276">Note that in this case the file set information must exactly match the file set information used by [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), or [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) to add files to Jan.</span></span>

<span data-ttu-id="5e217-277">De même, si un auteur souhaite ajouter une cible dirigée à un fichier avec le chemin d’accès « c : \\ Ethel » et le nom « Lucy. dat » gérés par « Jan » (avec le chemin d’accès logique « writerData \\ SET2 »), il utilise l’instance [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) correspondant à « writerData », mais les informations de fichier de « Jan ».</span><span class="sxs-lookup"><span data-stu-id="5e217-277">Similarly, if a writer wanted to add a directed target to a file with a path of "c:\\ethel" and name "lucy.dat" managed by "Jan" (with logical path "writerData\\Set2"), it would use the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance corresponding to "writerData", but "Jan"'s file information.</span></span>

## <a name="implicitly-included-components-in-the-restore-set"></a><span data-ttu-id="5e217-278">Composants inclus implicitement dans le jeu de restauration</span><span class="sxs-lookup"><span data-stu-id="5e217-278">Implicitly Included Components in the Restore Set</span></span>

<span data-ttu-id="5e217-279">Les composants qui étaient implicitement inclus dans une sauvegarde peuvent être inclus explicitement dans une restauration s’ils peuvent être sélectionnés pour la restauration.</span><span class="sxs-lookup"><span data-stu-id="5e217-279">Components that were implicitly included in a backup can be explicitly included in a restore if they are selectable for restore.</span></span> <span data-ttu-id="5e217-280">Comme indiqué dans [utilisation de la sélectivité pour la restauration et](working-with-selectability-for-restore-and-subcomponents.md)les sous-composants, ces composants sont ajoutés au document des composants de sauvegarde à l’aide de la méthode [**IVssBackupComponents :: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) .</span><span class="sxs-lookup"><span data-stu-id="5e217-280">As noted in [Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md), such components are added to the Backup Components Document using the [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) method.</span></span>

<span data-ttu-id="5e217-281">Toutefois, cela ne crée pas de nouvelle instance de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , pas plus que le composant directement accessible via l’interface [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="5e217-281">However, this does not create a new instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, nor is the component directly accessible through the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span>

<span data-ttu-id="5e217-282">Au lieu de cela, un composant explicitement inclus pour la restauration, mais inclus implicitement pour la sauvegarde, doit être accessible par le biais d’une instance de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) correspondant au composant qui a défini le jeu de composants dont il était membre lors de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5e217-282">Instead, a component explicitly included for restore, but implicitly included for backup, must be accessed through an instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface corresponding to the component that defined the component set of which it was a member upon backup.</span></span>

<span data-ttu-id="5e217-283">Par exemple, pour inclure explicitement pour Restore « Set1 », un sous-composant du composant sélectionnable pour la sauvegarde « writerData », vous obtenez des informations à son sujet en appelant la méthode [**IVssComponent :: GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent) de l’instance de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) « writerData ».</span><span class="sxs-lookup"><span data-stu-id="5e217-283">For example, to explicitly include for restore "Set1", a subcomponent of the selectable for backup component "writerData", you would obtain information about it by calling the [**IVssComponent::GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent) method of "writerData"'s instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

 

 



