---
description: Le document composants de sauvegarde est conservé par les instances de l’interface IVssBackupComponents.
ms.assetid: 8c7ebba8-58c4-4733-ba59-802abf902c5e
title: Contenu du document des composants de sauvegarde
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e12c88ebffa0037702e1f30dd818d4fd23fe4e2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103868770"
---
# <a name="backup-components-document-contents"></a><span data-ttu-id="b6251-103">Contenu du document des composants de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="b6251-103">Backup Components Document Contents</span></span>

<span data-ttu-id="b6251-104">Le document composants de sauvegarde est conservé par les instances de l’interface [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="b6251-104">The Backup Components Document is maintained by instances of the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span> <span data-ttu-id="b6251-105">Cette interface contient également de nombreuses méthodes de contrôle des opérations de sauvegarde, de manipulation des clichés instantanés et d’interrogation de l’état du système.</span><span class="sxs-lookup"><span data-stu-id="b6251-105">This interface also contains numerous methods for controlling backup operations, manipulating shadow copies, and querying the system state.</span></span> <span data-ttu-id="b6251-106">Toutefois, toutes les informations du document ne sont pas directement accessibles par le biais de cette interface.</span><span class="sxs-lookup"><span data-stu-id="b6251-106">However, not all of the document's information is directly accessible through this interface.</span></span>

<span data-ttu-id="b6251-107">Le document composants de sauvegarde se compose de plusieurs ensembles de données :</span><span class="sxs-lookup"><span data-stu-id="b6251-107">The Backup Components Document consists of several sets of data:</span></span>

-   <span data-ttu-id="b6251-108">Informations sur les composants qui ont été explicitement inclus dans une opération de sauvegarde ou de restauration</span><span class="sxs-lookup"><span data-stu-id="b6251-108">Information about which components were explicitly included in a backup or restore operation</span></span>
-   <span data-ttu-id="b6251-109">Représentation du composant stocké et des informations sur l’enregistreur</span><span class="sxs-lookup"><span data-stu-id="b6251-109">A representation of the stored component and writer information</span></span>
-   <span data-ttu-id="b6251-110">Informations d’État sur l’opération de sauvegarde/récupération</span><span class="sxs-lookup"><span data-stu-id="b6251-110">State information about the backup/recover operation</span></span>

<span data-ttu-id="b6251-111">Alors que les informations sur les composants sont disponibles pour le demandeur et l’enregistreur, seul l’enregistreur a accès aux informations d’État.</span><span class="sxs-lookup"><span data-stu-id="b6251-111">While the component information is available to both the requester and the writer, only the writer has access to the state information.</span></span>

## <a name="component-inclusion-information"></a><span data-ttu-id="b6251-112">Informations sur l’inclusion du composant</span><span class="sxs-lookup"><span data-stu-id="b6251-112">Component Inclusion Information</span></span>

<span data-ttu-id="b6251-113">Le document composants de sauvegarde contient une liste de ces composants explicitement inclus dans la sauvegarde et la restauration par le demandeur.</span><span class="sxs-lookup"><span data-stu-id="b6251-113">The Backup Components Document contains a list of those components explicitly included in backup and restore by the requester.</span></span> <span data-ttu-id="b6251-114">La liste contient les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b6251-114">The list contains the following:</span></span>

-   <span data-ttu-id="b6251-115">[*Composants sélectionnables*](vssgloss-s.md)explicitement inclus.</span><span class="sxs-lookup"><span data-stu-id="b6251-115">Explicitly included [*selectable components*](vssgloss-s.md).</span></span>

    <span data-ttu-id="b6251-116">L’inclusion de ces fichiers dans les opérations de sauvegarde est indiquée par [**IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) et dans les opérations de restauration par [**IVssBackupComponents :: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="b6251-116">The inclusion of these files in backup operations is indicated by [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) and in restore operations by [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>

-   <span data-ttu-id="b6251-117">Non sélectionnable pour les sous-composants de sauvegarde sans sélection pour l’ancêtre du composant de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b6251-117">Nonselectable for backup subcomponents without a selectable for backup component ancestor.</span></span>

    <span data-ttu-id="b6251-118">Tous ces composants doivent être inclus si des composants de l’enregistreur doivent être inclus dans l’opération.</span><span class="sxs-lookup"><span data-stu-id="b6251-118">All of these components must be included if any components of the writer are to be included in the operation.</span></span> <span data-ttu-id="b6251-119">L’inclusion de ces fichiers dans les opérations de sauvegarde est indiquée par [**IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) et dans les opérations de restauration par [**IVssBackupComponents :: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="b6251-119">The inclusion of these files in backup operations is indicated by [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) and in restore operations by [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>

-   <span data-ttu-id="b6251-120">Les composants ajoutés implicitement à la sauvegarde (sous-[*composants*](vssgloss-s.md)) [*sélectionnables pour la restauration*](vssgloss-s.md) et sont ajoutés explicitement à la restauration.</span><span class="sxs-lookup"><span data-stu-id="b6251-120">Components implicitly added to the backup ([*subcomponents*](vssgloss-s.md)) that are [*selectable for restore*](vssgloss-s.md) and are explicitly added to the restore.</span></span>

    <span data-ttu-id="b6251-121">Ces composants peuvent être sélectionnables ou non sélectionnables, mais ils ont un ancêtre sélectionnable qui a été utilisé pour les sélectionner implicitement pour la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b6251-121">These components may be either selectable or nonselectable, but have a selectable ancestor that was used to implicitly select them for backup.</span></span> <span data-ttu-id="b6251-122">Ils sont ajoutés au document composants de sauvegarde par [**IVssBackupComponents :: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="b6251-122">They are added to the Backup Components Document by [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>

<span data-ttu-id="b6251-123">Les identités des composants inclus implicitement dans la restauration ne sont pas stockées dans le document sur les composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b6251-123">The identities of components implicitly included in the restore are not stored in the Backup Components Document.</span></span>

<span data-ttu-id="b6251-124">VSS a accès aux informations sur l’inclusion de composants : les enregistreurs sans composants inclus explicitement dans une restauration ou une sauvegarde ne reçoivent aucun événement VSS après la génération des événements [*PrepareForBackup*](vssgloss-p.md) ou [*Restore*](vssgloss-p.md) .</span><span class="sxs-lookup"><span data-stu-id="b6251-124">VSS has access to information about component inclusion: writers with no components explicitly included in a restore or backup receive no VSS events following the generation of the [*PrepareForBackup*](vssgloss-p.md) or [*PreRestore*](vssgloss-p.md) events.</span></span>

<span data-ttu-id="b6251-125">Les enregistreurs ne peuvent pas directement interroger ces informations.</span><span class="sxs-lookup"><span data-stu-id="b6251-125">Writers cannot directly query this information.</span></span> <span data-ttu-id="b6251-126">Ce n’est pas une limitation significative, car par la conception, les enregistreurs VSS individuels ne doivent pas nécessiter d’informations détaillées sur l’état d’autres enregistreurs sur le système et, comme indiqué ci-dessus, ceux qui n’ont pas de composants inclus n’auront pas à participer à l’opération VSS.</span><span class="sxs-lookup"><span data-stu-id="b6251-126">This is not a significant limitation because by design, individual VSS writers should not require detailed information about the status of other writers on the system and, as noted above, those with no included components will not have to participate in the VSS operation.</span></span>

<span data-ttu-id="b6251-127">Un demandeur peut déterminer les composants qui ont été explicitement inclus dans une opération.</span><span class="sxs-lookup"><span data-stu-id="b6251-127">A requester can determine which components have been explicitly included in an operation.</span></span>

<span data-ttu-id="b6251-128">La méthode [**IVssBackupComponents :: GetWriterComponentsCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) retourne le nombre d’enregistreurs avec les informations de composant stockées dans le document des composants de sauvegarde (et non le nombre de composants dans le document).</span><span class="sxs-lookup"><span data-stu-id="b6251-128">The [**IVssBackupComponents::GetWriterComponentsCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) method returns the number of writers with component information stored in the Backup Components Document (and not the number of components in the document).</span></span>

<span data-ttu-id="b6251-129">Le demandeur indexe les informations du writer stocké à l’aide de [**IVssBackupComponents :: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), qui retourne des instances de l’interface [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) .</span><span class="sxs-lookup"><span data-stu-id="b6251-129">The requester indexes through the stored writer information using [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), which returns instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface.</span></span> <span data-ttu-id="b6251-130">L’interface **IVssWriterComponentsExt** permet au demandeur d’obtenir la [*classe de writer*](vssgloss-w.md) et l’instance de [*writer*](vssgloss-w.md) des Writers participants, ainsi que d’accéder aux informations sur les composants de ses composants stockés dans le document sur les composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b6251-130">The **IVssWriterComponentsExt** interface allows the requester to obtain the [*writer class*](vssgloss-w.md) and [*writer instance*](vssgloss-w.md) of participating writers, as well as to access information about those of its components stored in the Backup Components Document.</span></span>

## <a name="information-on-included-components"></a><span data-ttu-id="b6251-131">Informations sur les composants inclus</span><span class="sxs-lookup"><span data-stu-id="b6251-131">Information on Included Components</span></span>

<span data-ttu-id="b6251-132">La représentation du document des composants de sauvegarde des données du composant (qui n’inclut pas les informations de chemin d’accès et de spécification de fichier), accessible via des instances de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="b6251-132">The Backup Components Document's representation of the component data (which does not include path and file specification information), which is accessed through instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

<span data-ttu-id="b6251-133">Les demandeurs et les Writers obtiennent l’accès aux instances de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) de différentes façons.</span><span class="sxs-lookup"><span data-stu-id="b6251-133">Requesters and writers obtain access to instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface in different ways.</span></span>

<span data-ttu-id="b6251-134">Un demandeur examine les données de composant à l’aide d’un writer par writer à l’aide d’instances de l’interface [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) retournée par [**IVssBackupComponents :: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span><span class="sxs-lookup"><span data-stu-id="b6251-134">A requester examines component data on a writer by writer basis by using instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface returned by [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span></span>

<span data-ttu-id="b6251-135">En plus des informations d’identification du writer, l’interface [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) fournit un tableau d’instances de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) : une pour chacun des composants inclus inclus.</span><span class="sxs-lookup"><span data-stu-id="b6251-135">In addition to the writer identification information, the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface provides an array of instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface—one for each of the selected writers included components.</span></span>

<span data-ttu-id="b6251-136">Comme indiqué dans les [composants de sauvegarde cycle de vie des documents](backup-components-document-life-cycle.md), les enregistreurs peuvent accéder aux mêmes informations par le biais de l’interface [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) lors du traitement de l’événement PrepareForBackup, PrepareForSnapshot, PostSnapshot, BackupComplete, prerestauration ou postRestore.</span><span class="sxs-lookup"><span data-stu-id="b6251-136">As noted in [Backup Components Document Life Cycle](backup-components-document-life-cycle.md), the writers can gain access to the same information through the [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) interface when handling the PrepareForBackup, PrepareForSnapshot, PostSnapshot, BackupComplete, PreRestore, or PostRestore event.</span></span>

<span data-ttu-id="b6251-137">[**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) permet aux rédacteurs et aux demandeurs d’obtenir les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="b6251-137">[**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) allows both writer and requesters to get the following information:</span></span>

-   <span data-ttu-id="b6251-138">Le nom, le type et le [*chemin logique*](vssgloss-l.md) d’un composant ([**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponentname), [**GetComponentType**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponenttype), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath))</span><span class="sxs-lookup"><span data-stu-id="b6251-138">A component's name, type, and [*logical path*](vssgloss-l.md) ([**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponentname), [**GetComponentType**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponenttype), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath))</span></span>
-   <span data-ttu-id="b6251-139">Comment un composant doit être restauré comme indiqué par la [*cible de restauration*](vssgloss-r.md) ([**IVssComponent :: GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget))</span><span class="sxs-lookup"><span data-stu-id="b6251-139">How a component should be restored as indicated by the [*restore target*](vssgloss-r.md) ([**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget))</span></span>
-   <span data-ttu-id="b6251-140">Si un autre emplacement a été utilisé pour restaurer un fichier ([**GetAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping), [**GetAlternateLocationMappingCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount))</span><span class="sxs-lookup"><span data-stu-id="b6251-140">If an alternate location was used in restoring a file ([**GetAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping), [**GetAlternateLocationMappingCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount))</span></span>
-   <span data-ttu-id="b6251-141">Nouvelles informations sur la cible, le cas échéant ([**GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget), [**GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount))</span><span class="sxs-lookup"><span data-stu-id="b6251-141">New target information, if any ([**GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget), [**GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount))</span></span>
-   <span data-ttu-id="b6251-142">Messages d’erreur avant et après la restauration ([**GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg))</span><span class="sxs-lookup"><span data-stu-id="b6251-142">Pre-and post-restore error messages ([**GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg))</span></span>
-   <span data-ttu-id="b6251-143">Si un élément [*sélectionnable pour*](vssgloss-s.md) le composant de sauvegarde définissant un jeu de composants a été sélectionné pour la restauration ([**IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore))</span><span class="sxs-lookup"><span data-stu-id="b6251-143">If a [*selectable for backup*](vssgloss-s.md) component defining a component set has been selected for restore ([**IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore))</span></span>
-   <span data-ttu-id="b6251-144">Si une sauvegarde ou une restauration a réussi ([**GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded), [**GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus))</span><span class="sxs-lookup"><span data-stu-id="b6251-144">Whether a backup or restore succeeded ([**GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded), [**GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus))</span></span>
-   <span data-ttu-id="b6251-145">Toutes les options de sauvegarde ou de restauration spécifiques au writer qui ont pu être définies par [**IVssBackupComponents :: SetBackupOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions) ou [**IVssBackupComponents :: SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) ([**GetBackupOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions), [**GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span><span class="sxs-lookup"><span data-stu-id="b6251-145">Any writer-specific backup or restore options that may have been set by [**IVssBackupComponents::SetBackupOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions) or [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) ([**GetBackupOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions), [**GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span></span>
-   <span data-ttu-id="b6251-146">Toutes les métadonnées de sauvegarde ou de restauration de métadonnées spécifiques au writer ([**GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)), [**GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="b6251-146">Any writer-specific metadata backup or restore metadata ([**GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)), [**GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata))</span></span>
-   <span data-ttu-id="b6251-147">Informations de date et d’heure ([**GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp), [**GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp))</span><span class="sxs-lookup"><span data-stu-id="b6251-147">Time-stamp information ([**GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp), [**GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp))</span></span>
-   <span data-ttu-id="b6251-148">Informations sur les sous-composants de sauvegarde inclus explicitement dans une restauration ([**GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent), [**GetRestoreSubcomponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponentcount))</span><span class="sxs-lookup"><span data-stu-id="b6251-148">Information about backup subcomponents explicitly included in a restore ([**GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent), [**GetRestoreSubcomponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponentcount))</span></span>

<span data-ttu-id="b6251-149">Contrairement aux demandeurs, les enregistreurs peuvent modifier certaines informations dans le document des composants de sauvegarde via l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) :</span><span class="sxs-lookup"><span data-stu-id="b6251-149">Unlike requesters, writers can change certain information in the Backup Components Document via the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface:</span></span>

-   <span data-ttu-id="b6251-150">Comment un composant doit être restauré comme indiqué par la cible de restauration ([**IVssComponent :: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget))</span><span class="sxs-lookup"><span data-stu-id="b6251-150">How a component should be restored as indicated by the restore target ([**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget))</span></span>
-   <span data-ttu-id="b6251-151">Sauvegarde et restauration spécifiques aux rédacteurs ([**IVssComponent :: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata), [**IVssComponent :: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="b6251-151">Writer-specific backup and restore metadata ([**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata), [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span></span>
-   <span data-ttu-id="b6251-152">Informations de datage ([**SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp))</span><span class="sxs-lookup"><span data-stu-id="b6251-152">Time-stamp information ([**SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp))</span></span>
-   <span data-ttu-id="b6251-153">Messages d’erreur avant et après la restauration ([**SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), [**SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg))</span><span class="sxs-lookup"><span data-stu-id="b6251-153">Pre- and post-restore error messages ([**SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), [**SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg))</span></span>

## <a name="requester-state-information"></a><span data-ttu-id="b6251-154">Informations sur l’état du demandeur</span><span class="sxs-lookup"><span data-stu-id="b6251-154">Requester State Information</span></span>

<span data-ttu-id="b6251-155">Les demandeurs insèrent des informations sur l’état d’une opération de sauvegarde ou de restauration dans le document des composants de sauvegarde à l’aide de l’interface [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="b6251-155">Requesters insert information about the state of a backup or restore operation into the Backup Components Document using the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span> <span data-ttu-id="b6251-156">Les applications de Writer peuvent interroger ces informations par le biais de la classe [**CVssWriter**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) .</span><span class="sxs-lookup"><span data-stu-id="b6251-156">Writer applications are able to query for this information through the [**CVssWriter**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) class.</span></span>

<span data-ttu-id="b6251-157">Les informations d’État stockées dans le document sur les composants de sauvegarde incluent les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b6251-157">State information stored in the Backup Components Document includes the following:</span></span>

<span data-ttu-id="b6251-158">Informations générales sur la sauvegarde</span><span class="sxs-lookup"><span data-stu-id="b6251-158">General Information about the Backup</span></span>

-   <span data-ttu-id="b6251-159">Le type de sauvegarde globale (incrémentielle, différentielle ou complète)</span><span class="sxs-lookup"><span data-stu-id="b6251-159">The overall backup type (incremental, differential, or full)</span></span><dl> <dt>

<span data-ttu-id="b6251-160">Défini par les demandeurs à l’aide de [ **IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="b6251-160">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-161">Récupéré par les enregistreurs à l’aide de [ **CVssWriter :: GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype)</span><span class="sxs-lookup"><span data-stu-id="b6251-161">Retrieved by writers using [**CVssWriter::GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype)</span></span>
</dt> </dl>
-   Whether component operations are supported<dl> <dt>

<span data-ttu-id="b6251-162">Défini par les demandeurs à l’aide de [ **IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="b6251-162">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-163">Récupéré par les enregistreurs à l’aide de [ **CVssWriter :: AreComponentsSelected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-arecomponentsselected)</span><span class="sxs-lookup"><span data-stu-id="b6251-163">Retrieved by writers using [**CVssWriter::AreComponentsSelected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-arecomponentsselected)</span></span>
</dt> </dl>
-   Whether the bootable system state is backed up<dl> <dt>

<span data-ttu-id="b6251-164">Défini par les demandeurs à l’aide de [ **IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="b6251-164">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-165">Récupéré par les enregistreurs à l’aide de [ **CVssWriter :: IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup)</span><span class="sxs-lookup"><span data-stu-id="b6251-165">Retrieved by writers using [**CVssWriter::IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup)</span></span>
</dt> </dl>
-   Whether partial file operations are supported<dl> <dt>

<span data-ttu-id="b6251-166">Défini par les demandeurs à l’aide de [ **IVssBackupComponents :: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="b6251-166">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-167">Récupéré par les enregistreurs à l’aide de [ **CVssWriter :: IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled)</span><span class="sxs-lookup"><span data-stu-id="b6251-167">Retrieved by writers using [**CVssWriter::IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled)</span></span>
</dt> </dl>

<span data-ttu-id="b6251-168">Informations générales sur la restauration</span><span class="sxs-lookup"><span data-stu-id="b6251-168">General Information about the Restore</span></span>

-   <span data-ttu-id="b6251-169">Le type de restauration globale (que la restauration se fasse par copie ou importation)</span><span class="sxs-lookup"><span data-stu-id="b6251-169">The overall restore type (whether restore is by copy or import)</span></span><dl> <dt>

<span data-ttu-id="b6251-170">Défini par les demandeurs à l’aide de [ **IVssBackupComponents :: SetRestoreState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate)</span><span class="sxs-lookup"><span data-stu-id="b6251-170">Set by requesters using [**IVssBackupComponents::SetRestoreState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-171">Récupéré par les enregistreurs à l’aide de [ **CVssWriter :: GetRestoreType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype)</span><span class="sxs-lookup"><span data-stu-id="b6251-171">Retrieved by writers using [**CVssWriter::GetRestoreType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype)</span></span>
</dt> </dl>

<span data-ttu-id="b6251-172">Informations sur les fichiers de prise en charge</span><span class="sxs-lookup"><span data-stu-id="b6251-172">Information about Supporting Files</span></span>

-   <span data-ttu-id="b6251-173">Emplacement des fichiers de plages utilisés par un composant spécifique dans les opérations de fichiers partielles</span><span class="sxs-lookup"><span data-stu-id="b6251-173">The location of ranges files used by a specific component in partial file operations</span></span><dl> <dt>

<span data-ttu-id="b6251-174">Défini par les demandeurs à l’aide de [ **IVssBackupComponents :: SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath)</span><span class="sxs-lookup"><span data-stu-id="b6251-174">Set by requesters using [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-175">Récupéré par les rédacteurs (ou les demandeurs) à l’aide de [ **IVssComponent :: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)</span><span class="sxs-lookup"><span data-stu-id="b6251-175">Retrieved by writers (or requesters) using [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)</span></span>
</dt> </dl>

<span data-ttu-id="b6251-176">État des informations</span><span class="sxs-lookup"><span data-stu-id="b6251-176">Status of Information</span></span>

-   <span data-ttu-id="b6251-177">Indiquer si l’un des composants d’un enregistreur donné a été correctement sauvegardé</span><span class="sxs-lookup"><span data-stu-id="b6251-177">Indicate whether one of a given writer's components was successfully backed up</span></span><dl> <dt>

<span data-ttu-id="b6251-178">Défini par les demandeurs à l’aide de [ **IVssBackupComponents :: SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)</span><span class="sxs-lookup"><span data-stu-id="b6251-178">Set by requesters using [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-179">Récupéré par les rédacteurs et les demandeurs à l’aide de [ **IVssComponent :: GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)</span><span class="sxs-lookup"><span data-stu-id="b6251-179">Retrieved by writers and requesters using [**IVssComponent::GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)</span></span>
</dt> </dl>
-   Indicate whether one of a given writer's components was successfully restored<dl> <dt>

<span data-ttu-id="b6251-180">Défini par les demandeurs à l’aide de [ **IVssBackupComponents :: SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)</span><span class="sxs-lookup"><span data-stu-id="b6251-180">Set by requesters using [**IVssBackupComponents::SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-181">Récupéré par les rédacteurs et les demandeurs à l’aide de [ **IVssComponent :: GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)</span><span class="sxs-lookup"><span data-stu-id="b6251-181">Retrieved by writers and requester using [**IVssComponent::GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)</span></span>
</dt> </dl>

<span data-ttu-id="b6251-182">Informations Writer-Settable</span><span class="sxs-lookup"><span data-stu-id="b6251-182">Writer-Settable Information</span></span>

-   <span data-ttu-id="b6251-183">Spécification de sauvegarde supplémentaire pour l’un des composants d’un générateur donné</span><span class="sxs-lookup"><span data-stu-id="b6251-183">Additional backup specification for one of a given writer's components</span></span><dl> <dt>

<span data-ttu-id="b6251-184">Défini par les enregistreurs à l’aide de [ **IVssComponent :: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)</span><span class="sxs-lookup"><span data-stu-id="b6251-184">Set by writers using [**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-185">Récupéré par les rédacteurs et les demandeurs à l’aide de [ **IVssComponent :: GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)</span><span class="sxs-lookup"><span data-stu-id="b6251-185">Retrieved by writers and requesters using [**IVssComponent::GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)</span></span>
</dt> </dl>
-   Additional restore specification for one of a given writer's components<dl> <dt>

<span data-ttu-id="b6251-186">Défini par les enregistreurs à l’aide de [ **IVssComponent :: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)</span><span class="sxs-lookup"><span data-stu-id="b6251-186">Set by writers using [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-187">Récupéré par les rédacteurs et les demandeurs à l’aide de [ **IVssComponent :: GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)</span><span class="sxs-lookup"><span data-stu-id="b6251-187">Retrieved by writers and requesters using [**IVssComponent::GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)</span></span>
</dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the current backup of one of its component's backups<dl> <dt>

<span data-ttu-id="b6251-188">Défini par les enregistreurs à l’aide de [ **IVssComponent :: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="b6251-188">Set by writers using [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-189">Récupéré par les rédacteurs et les demandeurs à l’aide de [ **IVssComponent :: GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="b6251-189">Retrieved by writers and requesters using [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span></span>
<span data-ttu-id="b6251-190"></dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the last backup of one of its components' backups using a backup stamp initially set by <a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp">IVssComponent::SetBackupStamp</a></span><span class="sxs-lookup"><span data-stu-id="b6251-190"></dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the last backup of one of its components' backups using a backup stamp initially set by <a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp">IVssComponent::SetBackupStamp</a></span></span><dl> <dt>

<span data-ttu-id="b6251-191">Stocké et défini par les demandeurs pour un composant spécifique à l’aide de [ **IVssBackupComponents :: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="b6251-191">Stored and set by requesters for a specific component using [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-192">Récupéré par les rédacteurs et les demandeurs à l’aide de [ **IVssComponent :: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="b6251-192">Retrieved by writers and requesters using [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp)</span></span>
</dt> </dl>
-   Error messages for failure before and after restore operations<dl> <dt>

<span data-ttu-id="b6251-193">Défini par les enregistreurs à l’aide de [**IVssComponent :: SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg) ou [**IVssComponent :: SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)</span><span class="sxs-lookup"><span data-stu-id="b6251-193">Set by writers using [**IVssComponent::SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg) or [**IVssComponent::SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)</span></span>
</dt> <dt>

<span data-ttu-id="b6251-194">Récupéré par les rédacteurs et les demandeurs à l’aide de [**IVssComponent :: GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg) ou [**IVssComponent :: GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg)</span><span class="sxs-lookup"><span data-stu-id="b6251-194">Retrieved by writers and requesters using [**IVssComponent::GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg) or [**IVssComponent::GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg)</span></span>
</dt> </dl>

 

 
