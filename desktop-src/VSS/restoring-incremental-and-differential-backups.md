---
description: La restauration d’une sauvegarde incrémentielle ou différentielle sous VSS n’est pas très différente de celle d’une autre opération de restauration VSS.
ms.assetid: 67143f6f-0bb8-4740-9289-8bbfeb7caadf
title: Restauration des sauvegardes incrémentielles et différentielles
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 639919ea24f12fbc036116bd89b1630321cbae54
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104528702"
---
# <a name="restoring-incremental-and-differential-backups"></a><span data-ttu-id="5ca87-103">Restauration des sauvegardes incrémentielles et différentielles</span><span class="sxs-lookup"><span data-stu-id="5ca87-103">Restoring Incremental and Differential Backups</span></span>

<span data-ttu-id="5ca87-104">La restauration d’une sauvegarde incrémentielle ou différentielle sous VSS n’est pas très différente de celle d’une autre opération de restauration VSS.</span><span class="sxs-lookup"><span data-stu-id="5ca87-104">Restoring an incremental or differential backup under VSS is not significantly different from any other VSS restore operation.</span></span>

<span data-ttu-id="5ca87-105">Un enregistreur peut modifier les cibles de restauration ou demander le ciblage dirigé, et un demandeur doit gérer d’autres mappages d’emplacements et de nouvelles cibles, comme avec toute autre restauration.</span><span class="sxs-lookup"><span data-stu-id="5ca87-105">A writer can modify restore targets or request directed targeting, and a requester must handle alternate location mappings and new targets, just as with any other restore.</span></span> <span data-ttu-id="5ca87-106">Toutefois, il existe deux problèmes importants à prendre en compte lors de la gestion de la restauration d’une sauvegarde incrémentielle ou différentielle : des restaurations supplémentaires et des tampons de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5ca87-106">There are, however, two significant issues to be aware of in handling the restore of an incremental or differential backup: additional restores and backup stamps.</span></span>

## <a name="additional-restores"></a><span data-ttu-id="5ca87-107">Restaurations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="5ca87-107">Additional Restores</span></span>

<span data-ttu-id="5ca87-108">Le premier problème est celui des restaurations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="5ca87-108">The first issue is that of additional restores.</span></span> <span data-ttu-id="5ca87-109">Un opérateur de sauvegarde peut avoir besoin d’exécuter plusieurs opérations de restauration à l’aide d’un support de sauvegarde complet et incrémentiel suivant ou différentiel en tant que source.</span><span class="sxs-lookup"><span data-stu-id="5ca87-109">A backup operator may need to run several restore operations using an initial full and subsequent incremental or differential backup media as a source.</span></span>

<span data-ttu-id="5ca87-110">Certains Writers, généralement dans le cadre de leur gestion d’un événement [*postRestore*](vssgloss-p.md) à l’aide de [**CVssWriter :: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore), utilisent des fichiers restaurés pour effectuer des mises à jour de données actuellement sur le disque.</span><span class="sxs-lookup"><span data-stu-id="5ca87-110">Some writers, typically as part of their handling of a [*PostRestore*](vssgloss-p.md) event using [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore), use restored files to perform updates of data currently on disk.</span></span> <span data-ttu-id="5ca87-111">Pour certains de ces Writers, il est inefficace, ou dangereux, de mettre à jour de façon répétée les données sur disque à partir des fichiers restaurés.</span><span class="sxs-lookup"><span data-stu-id="5ca87-111">For some of these writers it is inefficient—or dangerous—to repeatedly update on-disk data from restored files.</span></span>

<span data-ttu-id="5ca87-112">Par conséquent, il est important que les applications de sauvegarde indiquent quand un jeu de composants ou de composants peut nécessiter des restaurations ultérieures en appelant [**IVssBackupComponents :: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span><span class="sxs-lookup"><span data-stu-id="5ca87-112">Therefore, it is important that backup applications indicate when a component or component set may require subsequent restores by calling [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span></span>

<span data-ttu-id="5ca87-113">Un writer appelle [**IVssComponent :: GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) pour déterminer si l’opérateur de sauvegarde a planifié plus de restaurations du composant ou du jeu de composants.</span><span class="sxs-lookup"><span data-stu-id="5ca87-113">A writer would call [**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) to determine whether the backup operator planned more restores of the component or component set.</span></span>

<span data-ttu-id="5ca87-114">Si le demandeur n’a pas appelé [**IVssBackupComponents :: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), [**IVssComponent :: GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) retourne la valeur false, et le writer peut effectuer tout traitement de postconnexion à la restauration.</span><span class="sxs-lookup"><span data-stu-id="5ca87-114">If the requester had not called [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), then [**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) returns false, and the writer can perform any post-restore processing it needs to.</span></span>

<span data-ttu-id="5ca87-115">Si [**IVssBackupComponents :: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores) a été appelé, [**IVssComponent :: GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) retourne la **valeur true** et qu’un enregistreur doit décider comment gérer les opérations après la restauration, par exemple, le writer peut choisir de ne pas mettre à jour ses données sur disque.</span><span class="sxs-lookup"><span data-stu-id="5ca87-115">If [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores) had been called, then [**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) returns **true**, and a writer should decide how to handle post-restore operations—for instance, the writer may choose not to update its on-disk data.</span></span>

## <a name="backup-stamps"></a><span data-ttu-id="5ca87-116">Tampons de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="5ca87-116">Backup Stamps</span></span>

<span data-ttu-id="5ca87-117">Dans le cadre de l’opération de sauvegarde complète précédente, un enregistreur peut avoir stocké un tampon de sauvegarde dans le document des composants de sauvegarde du demandeur.</span><span class="sxs-lookup"><span data-stu-id="5ca87-117">As part of the previous full backup operation, a writer may have stored a backup stamp in the requester's Backup Components Document.</span></span>

<span data-ttu-id="5ca87-118">Le tampon de sauvegarde est stocké sous forme de chaîne, et son format et ses informations ne sont pas intelligibles pour le demandeur.</span><span class="sxs-lookup"><span data-stu-id="5ca87-118">The backup stamp is stored as a string, and its format and information are not intelligible to the requester.</span></span> <span data-ttu-id="5ca87-119">Par conséquent, le demandeur ne peut pas utiliser directement les informations de tampon de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5ca87-119">Therefore, the requester cannot make direct use of the backup stamp information.</span></span>

<span data-ttu-id="5ca87-120">Au lieu de cela, sa tâche consiste à mettre ces informations à la disposition du writer, en appelant la méthode [**IVssBackupComponents :: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) avant la génération d’un événement [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) pour une sauvegarde incrémentielle.</span><span class="sxs-lookup"><span data-stu-id="5ca87-120">Instead, its task is to make that information available to the writer, by calling the [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) method prior to the generation of a [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) event for an incremental backup.</span></span>

<span data-ttu-id="5ca87-121">Le demandeur effectue cette fonction composant par composant.</span><span class="sxs-lookup"><span data-stu-id="5ca87-121">The requester does this on a component-by-component basis.</span></span> <span data-ttu-id="5ca87-122">Un demandeur examine les informations de tampon de sauvegarde du composant ou du jeu de composants stockés à l’aide de [**IVssComponent :: GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="5ca87-122">A requester examines stored component or component set backup stamp information using [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span></span>

<span data-ttu-id="5ca87-123">Si les informations de tampon de sauvegarde sont adaptées au type de restauration que le demandeur est en mesure d’effectuer, il est disponible en tant qu’horodatage de la dernière sauvegarde d’un composant avec la méthode [**IVssBackupComponents :: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) .</span><span class="sxs-lookup"><span data-stu-id="5ca87-123">If backup stamp information is appropriate to the type of restore the requester is undertaking, it makes it available as the time stamp of the last backup of a component with the [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) method.</span></span>

<span data-ttu-id="5ca87-124">Un enregistreur récupère les informations de tampon de sauvegarde à l’aide de [**IVssComponent :: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="5ca87-124">A writer recovers the backup stamp information using [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span></span> <span data-ttu-id="5ca87-125">Un enregistreur de cette classe a généré le tampon de sauvegarde initial, de sorte que l’enregistreur est en mesure de décoder ce tampon et d’utiliser les informations.</span><span class="sxs-lookup"><span data-stu-id="5ca87-125">A writer of this class generated the initial backup stamp, so the writer is able to decode this stamp and use the information.</span></span> <span data-ttu-id="5ca87-126">En fonction de cela, lors de la gestion d’un événement de [**prérestauration**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) , un enregistreur peut choisir de prendre des mesures telles que la modification des cibles de restauration ou la demande de ciblage dirigé.</span><span class="sxs-lookup"><span data-stu-id="5ca87-126">Based on this, while handling a [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event, a writer may choose to take actions such as changing restore targets or requesting directed targeting.</span></span>

 

 



