---
description: 'La participation d’un enregistreur à des sauvegardes incrémentielles et différentielles s’effectue généralement lors du traitement des événements identify (CVssWriter :: OnIdentify), PrepareForBackup (CVssWriter : OnPrepareBackup) et PostSnapshot (CVssWriter : OnPostSnapshot).'
ms.assetid: 85c4e003-b531-4283-83aa-dd5cc53f35b1
title: Rôle d’écriture dans VSS sauvegardes incrémentielles et différentielles
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f2cda57d907bed4572f0c0f71f9ee829bee18299
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526254"
---
# <a name="writer-role-in-vss-incremental-and-differential-backups"></a><span data-ttu-id="b281c-103">Rôle d’écriture dans VSS sauvegardes incrémentielles et différentielles</span><span class="sxs-lookup"><span data-stu-id="b281c-103">Writer Role in VSS Incremental and Differential Backups</span></span>

<span data-ttu-id="b281c-104">La participation d’un enregistreur à des sauvegardes incrémentielles et différentielles s’effectue généralement lors du traitement des événements [*identify*](vssgloss-i.md) ([**CVssWriter :: OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify)), [*PrepareForBackup*](vssgloss-p.md) ([**CVssWriter : OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup)) et *PostSnapshot* (CVssWriter [**: OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)).</span><span class="sxs-lookup"><span data-stu-id="b281c-104">A writer's participation in incremental and differential backups typically takes place while handling [*Identify*](vssgloss-i.md) ([**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify)), [*PrepareForBackup*](vssgloss-p.md) ([**CVssWriter:OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup)), and *PostSnapshot* ([**CVssWriter:OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)) events.</span></span> <span data-ttu-id="b281c-105">Le mode de participation d’un writer est formé par le fait qu’il prenne en charge les tampons de sauvegarde et les heures de dernière modification, et si le demandeur qui exécute la sauvegarde prend en charge les [*opérations de fichiers partielles*](vssgloss-p.md).</span><span class="sxs-lookup"><span data-stu-id="b281c-105">How a writer participates is shaped by whether it supports backup stamps and last modification times, and whether the requester running the backup supports [*partial file operations*](vssgloss-p.md).</span></span>

## <a name="handling-identify-events-during-incremental-and-differential-backups"></a><span data-ttu-id="b281c-106">Gestion des événements d’identification lors des sauvegardes incrémentielles et différentielles</span><span class="sxs-lookup"><span data-stu-id="b281c-106">Handling Identify Events during Incremental and Differential Backups</span></span>

<span data-ttu-id="b281c-107">Lors du traitement de l’événement d’identification, les rédacteurs établissent leur architecture de base pour l’opération de sauvegarde incrémentielle et différentielle par le biais des masques schéma de sauvegarde ([**\_ \_ schéma de sauvegarde VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema)) et spécification de fichier ([**\_ \_ \_ \_ type**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type)de sauvegarde de spécification de fichier VSS).</span><span class="sxs-lookup"><span data-stu-id="b281c-107">While handling the Identify event, writers establish their basic architecture for incremental and differential backup operation through the backup schema ([**VSS\_BACKUP\_SCHEMA**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema)) and file specification backup type ([**VSS\_FILE\_SPEC\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type)) masks.</span></span>

<span data-ttu-id="b281c-108">Un writer indique les opérations qu’il prend en charge dans son document de métadonnées d’écriture en créant un masque de bits des valeurs de [**\_ \_ schéma de sauvegarde VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) et en le passant à la méthode [**IVssCreateWriterMetadata :: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) .</span><span class="sxs-lookup"><span data-stu-id="b281c-108">A writer indicates which operations it supports in its Writer Metadata Document by creating a bit mask of [**VSS\_BACKUP\_SCHEMA**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) values and passing it to the [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) method.</span></span> <span data-ttu-id="b281c-109">Dans ce cas, un enregistreur peut indiquer s’il prend en charge les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b281c-109">With this, a writer can indicate whether it supports the following:</span></span>

-   <span data-ttu-id="b281c-110">Sauvegardes incrémentielles (**VSS \_ BS \_ incrémentielles**)</span><span class="sxs-lookup"><span data-stu-id="b281c-110">Incremental backups (**VSS\_BS\_INCREMENTAL**)</span></span>
-   <span data-ttu-id="b281c-111">Sauvegardes différentielles (**VSS \_ BS \_ différentiel**)</span><span class="sxs-lookup"><span data-stu-id="b281c-111">Differential backups (**VSS\_BS\_DIFFERENTIAL**)</span></span>
-   <span data-ttu-id="b281c-112">Les sauvegardes incrémentielles et différentielles ne peuvent pas être mélangées (**\_ différentielle VSS BS \_ exclusive \_ incrémentielle \_**)</span><span class="sxs-lookup"><span data-stu-id="b281c-112">Incremental and differential backups cannot be mixed (**VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL**)</span></span>
-   <span data-ttu-id="b281c-113">Sauvegardes incrémentielles et différentielles à l’aide de tampons de sauvegarde (**VSS \_ BS \_ horodaté**)</span><span class="sxs-lookup"><span data-stu-id="b281c-113">Incremental and differential backups using backup stamps (**VSS\_BS\_TIMESTAMPED**)</span></span>
-   <span data-ttu-id="b281c-114">Sauvegardes incrémentielles et différentielles sur la base des informations sur la dernière modification d’un fichier (**VSS \_ BS \_ dernière \_ modification**)</span><span class="sxs-lookup"><span data-stu-id="b281c-114">Incremental and differential backups on the basis of information about a file's last modification (**VSS\_BS\_LAST\_MODIFY**)</span></span>

<span data-ttu-id="b281c-115">Les enregistreurs utilisent le masque de type de sauvegarde spécification de fichier pour fournir des informations au niveau du jeu de fichiers aux demandeurs sur l’inclusion de fichiers dans une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="b281c-115">Writers use the file specification backup type mask to provide file set level information to requesters on how to include files in an incremental or differential backup.</span></span>

<span data-ttu-id="b281c-116">Un enregistreur peut définir le masque de type de sauvegarde d’une spécification de fichier d’un jeu de fichiers lorsqu’il ajoute le jeu de fichiers à un composant en créant un masque de bits des valeurs de [**\_ \_ \_ \_ type de sauvegarde spec de fichier VSS**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type) et en le passant à [**IVssCreateWriterMetadata :: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata :: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)ou [**IVssCreateWriterMetadata :: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup).</span><span class="sxs-lookup"><span data-stu-id="b281c-116">A writer can set a file set's file specification backup type mask when it adds the file set to a component by creating a bit mask of [**VSS\_FILE\_SPEC\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type) values and passing it to [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup).</span></span>

<span data-ttu-id="b281c-117">Trois valeurs « Backup required » de l’énumération du [**\_ \_ \_ \_ type de sauvegarde spec du fichier VSS**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type) affectent les sauvegardes différentielles et incrémentielles :</span><span class="sxs-lookup"><span data-stu-id="b281c-117">There are three "backup required" values of the [**VSS\_FILE\_SPEC\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type) enumeration that affect differential and incremental backups:</span></span>

-   <span data-ttu-id="b281c-118">**\_sauvegarde VSS FSBT \_ toutes les \_ sauvegardes \_ requises**</span><span class="sxs-lookup"><span data-stu-id="b281c-118">**VSS\_FSBT\_ALL\_BACKUP\_REQUIRED**</span></span>
-   <span data-ttu-id="b281c-119">**\_sauvegarde VSS FSBT \_ \_ \_ requise**</span><span class="sxs-lookup"><span data-stu-id="b281c-119">**VSS\_FSBT\_INCREMENTAL\_BACKUP\_REQUIRED**</span></span>
-   <span data-ttu-id="b281c-120">**\_ \_ sauvegarde différentielle FSBT \_ VSS \_ requise**</span><span class="sxs-lookup"><span data-stu-id="b281c-120">**VSS\_FSBT\_DIFFERENTIAL\_BACKUP\_REQUIRED**</span></span>

<span data-ttu-id="b281c-121">Il existe trois valeurs « cliché instantané requis » :</span><span class="sxs-lookup"><span data-stu-id="b281c-121">There are three "shadow copy required" values:</span></span>

-   <span data-ttu-id="b281c-122">**\_FSBT VSS \_ tous les \_ instantanés \_ requis**</span><span class="sxs-lookup"><span data-stu-id="b281c-122">**VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**</span></span>
-   <span data-ttu-id="b281c-123">**\_instantané FSBT \_ incrémentiel VSS \_ \_ requis**</span><span class="sxs-lookup"><span data-stu-id="b281c-123">**VSS\_FSBT\_INCREMENTAL\_SNAPSHOT\_REQUIRED**</span></span>
-   <span data-ttu-id="b281c-124">**\_ \_ instantané différentiel FSBT \_ VSS \_ requis**</span><span class="sxs-lookup"><span data-stu-id="b281c-124">**VSS\_FSBT\_DIFFERENTIAL\_SNAPSHOT\_REQUIRED**</span></span>

<span data-ttu-id="b281c-125">Jeux de fichiers marqués avec un type de sauvegarde de spécification de fichier « cliché instantané requis » indiquez si un demandeur doit copier des données à partir d’un cliché instantané lors de l’exécution d’opérations de sauvegarde incrémentielle, différentielle ou tout (qui incluent à la fois des opérations incrémentielles et différentielles).</span><span class="sxs-lookup"><span data-stu-id="b281c-125">File sets tagged with a file specification backup type of "shadow copy required" indicate whether a requester needs to copy data from a shadow copy when performing INCREMENTAL, DIFFERENTIAL, or ALL (which includes both incremental and differential operations) backup operations.</span></span>

<span data-ttu-id="b281c-126">L’indicateur « Backup required », appliqué aux opérations INCRÉMENTIELLEs, DIFFÉRENTIELles ou de sauvegarde, indique que le writer attend qu’une copie de la version actuelle du jeu de fichiers soit disponible après la restauration d’une opération de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b281c-126">The "backup required" flag, applied to INCREMENTAL, DIFFERENTIAL, or ALL backup operations, indicates that the writer expects a copy of the current version of the file set to be available following the restore of any backup operation.</span></span> <span data-ttu-id="b281c-127">En général, cela signifie que si un jeu de fichiers est marqué avec « Backup required », tous ses membres sont copiés sur le support de sauvegarde lors d’une sauvegarde incrémentielle ou différentielle, quel que soit le moment de la dernière sauvegarde ou modification.</span><span class="sxs-lookup"><span data-stu-id="b281c-127">Typically, this means that if a file set is tagged with "backup required," all its members will be copied to backup media during an incremental or differential backup, regardless of when their backup or modification last occurred.</span></span>

<span data-ttu-id="b281c-128">Par défaut, les jeux de fichiers sont ajoutés aux composants avec un type de sauvegarde de spécification de fichier **VSS \_ FSBT \_ toutes les \_ sauvegardes \_ nécessaires** \| **VSS \_ FSBT \_ tous les \_ instantanés \_ requis**.</span><span class="sxs-lookup"><span data-stu-id="b281c-128">By default, file sets are added to components with a file specification backup type of **VSS\_FSBT\_ALL\_BACKUP\_REQUIRED** \| **VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**.</span></span> <span data-ttu-id="b281c-129">Par conséquent, à moins qu’un développeur auteur ne décide de ne pas utiliser la valeur par défaut (en choisissant un autre type de sauvegarde de spécification de fichier, en utilisant des opérations de fichiers partielles ou en utilisant des fichiers différenciés), les fichiers de la plupart des jeux de fichiers sont généralement copiés dans leur intégralité sur le support de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b281c-129">Therefore, unless a writer developer decides not to use the default (by choosing another file specification backup type, using partial file operations, or using differenced files), the files in most file sets will typically be copied in their entirety to backup media.</span></span>

<span data-ttu-id="b281c-130">À ce stade, le document de métadonnées de l’enregistreur du writer est entièrement rempli avec la plupart des informations dont un demandeur aura besoin pour démarrer une sauvegarde différentielle ou incrémentielle.</span><span class="sxs-lookup"><span data-stu-id="b281c-130">At this point, the writer's Writer Metadata Document is fully populated with most of information a requester will need to start a differential or incremental backup.</span></span> <span data-ttu-id="b281c-131">La spécification de l’ajout d’informations sur le jeu de fichiers ou le niveau de fichier pour prendre en charge la sauvegarde sera gérée pendant l’événement [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) .</span><span class="sxs-lookup"><span data-stu-id="b281c-131">Addition specification of file set or file level information to support the backup will be handled during the [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) event.</span></span>

## <a name="handling-prepareforbackup-events-during-incremental-and-differential-backups"></a><span data-ttu-id="b281c-132">Gestion des événements PrepareForBackup lors des sauvegardes incrémentielles et différentielles</span><span class="sxs-lookup"><span data-stu-id="b281c-132">Handling PrepareForBackup Events during Incremental and Differential Backups</span></span>

<span data-ttu-id="b281c-133">Avant de poursuivre l’opération de sauvegarde réelle, les rédacteurs peuvent modifier la spécification d’une sauvegarde [*incrémentielle*](vssgloss-i.md) ou [*différentielle*](vssgloss-d.md) en modifiant le document des composants de sauvegarde du demandeur par le biais de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="b281c-133">Before the requester proceeds with the actual backup operation, writers can modify the specification of an [*incremental*](vssgloss-i.md) or [*differential*](vssgloss-d.md) backup by altering the requester's Backup Components Document through the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

<span data-ttu-id="b281c-134">Étant donné que les enregistreurs utilisent l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , ils effectuent généralement ces préparatifs tout en gérant l’événement [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) .</span><span class="sxs-lookup"><span data-stu-id="b281c-134">Because the writers use the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, they typically perform these preparations while handling the [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) event.</span></span>

<span data-ttu-id="b281c-135">Dans [**CVssWriter : OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup), les enregistreurs peuvent spécifier plus précisément la manière dont certains fichiers doivent être évalués pour la sauvegarde, spécifier les mécanismes à utiliser pour les sauvegarder et éventuellement définir des tampons de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b281c-135">In [**CVssWriter:OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup), writers can more precisely specify how some files are to be evaluated for backup, specify what mechanisms should be used in backing them up, and possibly set backup stamps.</span></span>

<dl> <dt>

<span data-ttu-id="b281c-136"><span id="Partial_Files"></span><span id="partial_files"></span><span id="PARTIAL_FILES"></span>Fichiers partiels</span><span class="sxs-lookup"><span data-stu-id="b281c-136"><span id="Partial_Files"></span><span id="partial_files"></span><span id="PARTIAL_FILES"></span>Partial Files</span></span>
</dt> <dd>

<span data-ttu-id="b281c-137">Si un demandeur les prend en charge, un enregistreur peut choisir d’implémenter une sauvegarde incrémentielle ou différentielle en utilisant des opérations de fichier partielles.</span><span class="sxs-lookup"><span data-stu-id="b281c-137">If a requester supports them, a writer can choose to have an incremental or differential backup implemented by using partial file operations.</span></span> <span data-ttu-id="b281c-138">(Les enregistreurs peuvent déterminer si un demandeur prend en charge les opérations de fichiers partielles en appelant [**CVssWriter :: IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled).)</span><span class="sxs-lookup"><span data-stu-id="b281c-138">(Writers can determine if a requester supports partial file operations by calling [**CVssWriter::IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled).)</span></span>

<span data-ttu-id="b281c-139">Les enregistreurs utilisent [**IVssComponent :: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) pour indiquer les portions des fichiers sélectionnés à sauvegarder pendant l’opération incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="b281c-139">Writers use [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) to indicate those portions of the selected files to be backed up during the incremental or differential operation.</span></span> <span data-ttu-id="b281c-140">Les demandeurs doivent respecter cette spécification et doivent toujours sauvegarder les sections spécifiées des fichiers.</span><span class="sxs-lookup"><span data-stu-id="b281c-140">Requesters must respect this specification, and must always back up the specified sections of the files.</span></span> <span data-ttu-id="b281c-141">(Pour plus d’informations sur les opérations de fichiers partielles, consultez [utilisation de fichiers partiels](working-with-partial-files.md) .)</span><span class="sxs-lookup"><span data-stu-id="b281c-141">(See [Working with Partial Files](working-with-partial-files.md) for more information on partial file operations.)</span></span>

<span data-ttu-id="b281c-142">À l’aide de [**IVssComponent :: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile), un enregistreur peut ajouter un fichier à la sauvegarde qui n’a pas été précédemment ajouté à l’un de ses jeux de composants (par [**IVssCreateWriterMetadata :: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata :: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)ou [**IVssCreateWriterMetadata :: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) en tant que fichier partiel.</span><span class="sxs-lookup"><span data-stu-id="b281c-142">Using [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile), a writer can add a file to the backup that was not previously added to one of its component sets (by [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) as a partial file.</span></span> <span data-ttu-id="b281c-143">Les nouveaux fichiers ajoutés à la sauvegarde de cette manière doivent se trouver sur un volume qui est déjà en cours de clichés instantanés pour cette sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b281c-143">Any new files added to the backup in this manner must be on a volume that already is being shadow copied for this backup.</span></span>

<span data-ttu-id="b281c-144">Si un fichier est impliqué dans des opérations de fichiers partielles, cela remplace n’importe quel type de sauvegarde de spécification de fichier, ce qui est ignoré.</span><span class="sxs-lookup"><span data-stu-id="b281c-144">If a file is involved with partial file operations, this supersedes any file specification backup type, which is ignored.</span></span>

</dd> <dt>

<span data-ttu-id="b281c-145"><span id="Differenced_Files"></span><span id="differenced_files"></span><span id="DIFFERENCED_FILES"></span>Fichiers différenciés</span><span class="sxs-lookup"><span data-stu-id="b281c-145"><span id="Differenced_Files"></span><span id="differenced_files"></span><span id="DIFFERENCED_FILES"></span>Differenced Files</span></span>
</dt> <dd>

<span data-ttu-id="b281c-146">Les writers qui prennent en charge un schéma de sauvegarde de dernière modification (**\_ \_ schéma VSS BS**) peuvent ajouter des [*fichiers différenciés*](vssgloss-d.md) à une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="b281c-146">Writers that support a last modified backup schema (**VSS\_BS\_SCHEMA**) can add [*differenced files*](vssgloss-d.md) to an incremental or differential backup.</span></span>

<span data-ttu-id="b281c-147">En spécifiant un fichier différent, un writer utilise [**IVssComponent :: AddDifferencedFileByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) et spécifie un chemin d’accès, un nom de fichier et un indicateur récursif ; Toutefois, ceux-ci ne doivent pas nécessairement correspondre à un jeu de fichiers inclus dans un composant.</span><span class="sxs-lookup"><span data-stu-id="b281c-147">In specifying a differenced file, a writer uses [**IVssComponent::AddDifferencedFileByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) and specifies a path, a file name, and a recursive flag—however, these do not have to match a file set included in any component.</span></span>

<span data-ttu-id="b281c-148">En fait, un enregistreur peut ajouter un fichier qui n’a pas été précédemment ajouté à l’un de ses jeux de composants (par [**IVssCreateWriterMetadata :: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata :: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)ou [**IVssCreateWriterMetadata :: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) à la sauvegarde sous la forme d’un fichier différent.</span><span class="sxs-lookup"><span data-stu-id="b281c-148">In fact, a writer can add a file not previously added to one of its component sets (by [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) to the backup as a differenced file.</span></span> <span data-ttu-id="b281c-149">Les nouveaux fichiers ajoutés à la sauvegarde de cette manière doivent se trouver sur un volume qui est déjà en cours de clichés instantanés pour cette sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b281c-149">Any new files added to the backup in this manner must be on a volume that already is being shadow copied for this backup.</span></span>

<span data-ttu-id="b281c-150">En règle générale, un enregistreur spécifie également l’heure de la dernière modification lors de l’ajout d’un fichier différent, en fonction du mécanisme d’historique propre à l’enregistreur.</span><span class="sxs-lookup"><span data-stu-id="b281c-150">Typically, a writer will also specify a time of last modification when adding a differenced file—based on the writer's own history mechanism.</span></span> <span data-ttu-id="b281c-151">L’heure de la dernière modification, si elle est spécifiée, doit toujours être utilisée par les demandeurs pour déterminer si un fichier doit être inclus dans une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="b281c-151">This last modification time, if specified, must always be used by requesters in determining if a file needs to be included in an incremental or differential backup.</span></span>

<span data-ttu-id="b281c-152">Un enregistreur peut choisir de ne pas spécifier l’heure de la dernière modification lors de l’ajout d’un fichier différent à un jeu de sauvegarde différentiel ou incrémentiel.</span><span class="sxs-lookup"><span data-stu-id="b281c-152">A writer may choose not to specify a last modification time when adding a differenced file to an incremental or differential backup set.</span></span> <span data-ttu-id="b281c-153">Si c’est le cas, les demandeurs sont libres d’utiliser leurs propres mécanismes (par exemple, les journaux de sauvegardes précédentes ou d’informations de système de fichiers) pour déterminer si le fichier différent doit être inclus dans une sauvegarde incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="b281c-153">If this is the case, requesters are free to use their own mechanisms—for instance, logs of previous backups or file system information—to determine whether the differenced file should be included in an incremental or differential backup.</span></span>

<span data-ttu-id="b281c-154">Le type de sauvegarde de spécification de fichier d’un fichier différent est ignoré.</span><span class="sxs-lookup"><span data-stu-id="b281c-154">The file specification backup type of any differenced file is ignored.</span></span>

</dd> <dt>

<span data-ttu-id="b281c-155"><span id="Backup_Stamps"></span><span id="backup_stamps"></span><span id="BACKUP_STAMPS"></span>Tampons de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="b281c-155"><span id="Backup_Stamps"></span><span id="backup_stamps"></span><span id="BACKUP_STAMPS"></span>Backup Stamps</span></span>
</dt> <dd>

<span data-ttu-id="b281c-156">Les enregistreurs qui prennent en charge les tampons de sauvegarde (**\_ \_ horodatage VSS BS**) ont leur propre format privé pour stocker des informations sur le moment où une sauvegarde s’est produite en dernier.</span><span class="sxs-lookup"><span data-stu-id="b281c-156">Writers that support backup stamps (**VSS\_BS\_TIMESTAMP**) have their own private format for storing information about when a backup last occurred.</span></span> <span data-ttu-id="b281c-157">Ces informations sont générées par le writer lors de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b281c-157">This information is generated by the writer during backup.</span></span>

<span data-ttu-id="b281c-158">Le tampon de sauvegarde est stocké dans le document des composants de sauvegarde sous forme de chaîne par la méthode [**IVssComponent :: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) .</span><span class="sxs-lookup"><span data-stu-id="b281c-158">The backup stamp is stored in the Backup Components Document as a string by the [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) method.</span></span> <span data-ttu-id="b281c-159">Le tampon de sauvegarde s’applique à tous les jeux de fichiers du composant (ou jeu de composants) correspondant à l’instance du [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent).</span><span class="sxs-lookup"><span data-stu-id="b281c-159">The backup stamp applies to all file sets in the component (or component set) corresponding to the instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent).</span></span>

<span data-ttu-id="b281c-160">Si un demandeur a accès au tampon de sauvegarde d’une sauvegarde précédente, il l’aura mis à la disposition du rédacteur en appelant [**IVssBackupComponents :: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="b281c-160">If a requester has access to the backup stamp of a previous backup, it will have made it available to the writer by calling [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp).</span></span>

<span data-ttu-id="b281c-161">Un enregistreur peut ensuite examiner cet horodatage à l’aide de [**IVssComponent :: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="b281c-161">A writer then can examine this time stamp using [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span></span>

<span data-ttu-id="b281c-162">Notez que le demandeur stocke simplement et retourne la chaîne contenant le tampon de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b281c-162">Note that the requester merely stores and returns the string containing the backup stamp.</span></span> <span data-ttu-id="b281c-163">Il ne sait rien sur le format de la chaîne ni sur son utilisation ; seul l’enregistreur a ces informations.</span><span class="sxs-lookup"><span data-stu-id="b281c-163">It does not know anything about the string's format or how to use it; only the writer has that information.</span></span>

<span data-ttu-id="b281c-164">Un enregistreur peut choisir de mettre à jour le tampon de sauvegarde actuel à l’aide de [**IVssComponent :: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) après avoir appelé [**IVssComponent :: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp), enregistrant ainsi dans son propre format la date de l’opération de sauvegarde incrémentielle ou différentielle actuelle.</span><span class="sxs-lookup"><span data-stu-id="b281c-164">A writer may choose to update the current backup stamp using [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) after it has called [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp), thus recording in its own format the date of the current incremental or differential backup operation.</span></span>

</dd> </dl>

 

 



