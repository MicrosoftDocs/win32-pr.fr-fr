---
description: Outre l’exécution d’une sauvegarde ou d’une restauration, et la surveillance des clichés instantanés, un demandeur doit gérer des informations sur les composants des rédacteurs avec lesquels il interagit.
ms.assetid: 641abfbe-fc72-4468-9ef6-69c452adb1b3
title: Utilisation de composants par le demandeur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83efdb9e80ac0331289c3b611978e66a58098de6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526307"
---
# <a name="use-of-components-by-the-requester"></a><span data-ttu-id="e8efb-103">Utilisation de composants par le demandeur</span><span class="sxs-lookup"><span data-stu-id="e8efb-103">Use of Components by the Requester</span></span>

<span data-ttu-id="e8efb-104">Outre l’exécution d’une sauvegarde ou d’une restauration, et la surveillance des clichés instantanés, un demandeur doit gérer des informations sur les composants des rédacteurs avec lesquels il interagit.</span><span class="sxs-lookup"><span data-stu-id="e8efb-104">In addition to performing a backup or restore, and supervising shadow copies, a requester must manage information about the components of the writers it interacts with.</span></span> <span data-ttu-id="e8efb-105">La sélection et le chemin logique des composants sont utilisés pour inclure ou exclure des données d’une sauvegarde, et pour déterminer les informations de composant qui sont incluses dans le document des composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-105">Component selectability and logical path are used to include or exclude data from a backup, and to decide what component information is included in the Backup Components Document.</span></span>

## <a name="requester-component-selection-during-backup"></a><span data-ttu-id="e8efb-106">Sélection du composant demandeur pendant la sauvegarde</span><span class="sxs-lookup"><span data-stu-id="e8efb-106">Requester Component Selection during Backup</span></span>

<span data-ttu-id="e8efb-107">Pendant les opérations de sauvegarde, un demandeur importe les données du composant de métadonnées du writer à l’aide des méthodes [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) et [**IVssBackupComponents :: GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (pour plus d’informations, consultez [vue d’ensemble de l’initialisation](overview-of-backup-initialization.md) de la sauvegarde).</span><span class="sxs-lookup"><span data-stu-id="e8efb-107">During backup operations, a requester imports writer metadata component data using the [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) and [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) methods (see [Overview of Backup Initialization](overview-of-backup-initialization.md) for more information).</span></span>

<span data-ttu-id="e8efb-108">Après avoir examiné les informations du writer avec l’interface [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) , un demandeur décide des Writers qu’il va sauvegarder et, dans une certaine mesure, des composants d’un enregistreur donné qu’il sauvegardera.</span><span class="sxs-lookup"><span data-stu-id="e8efb-108">After examining writer information with the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface, a requester decides which writers it will back up and, to a limited extent, which of a given writer's components it will back up.</span></span>

<span data-ttu-id="e8efb-109">Lors de la sauvegarde d’un rédacteur, un demandeur :</span><span class="sxs-lookup"><span data-stu-id="e8efb-109">When backing up a writer, a requester:</span></span>

-   <span data-ttu-id="e8efb-110">Doit [*inclure explicitement*](vssgloss-e.md) tous les composants de l’enregistreur non sélectionnables pour la sauvegarde sans sélectionnable pour les ancêtres de sauvegarde à l’aide de [**IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) pour ajouter le composant au document des composants de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="e8efb-110">Must [*explicitly include*](vssgloss-e.md) all of a writer's nonselectable for backup components without selectable for backup ancestors using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) to add the component to the Backup Components Document</span></span>
-   <span data-ttu-id="e8efb-111">Peut inclure explicitement l’un des composants sélectionnables du writer pour la sauvegarde à l’aide de [**IVssBackupComponents :: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) pour ajouter le composant au document des composants de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="e8efb-111">May explicitly include any of a writer's selectable for backup components using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) to add the component to the Backup Components Document</span></span>
-   <span data-ttu-id="e8efb-112">Si un composant sélectionnable pour la sauvegarde définit un [*jeu de composants*](vssgloss-c.md), son inclusion explicite [*comprend implicitement*](vssgloss-i.md) tous les membres du jeu de composants, qu’il soit sélectionnable ou non pour la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-112">If a selectable for backup component defines a [*component set*](vssgloss-c.md), its explicit inclusion [*implicitly includes*](vssgloss-i.md) all the component set's members—whether selectable for backup or not.</span></span> <span data-ttu-id="e8efb-113">Ces composants ne sont pas ajoutés au document composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-113">These components are not added to the Backup Components Document.</span></span>

<span data-ttu-id="e8efb-114">Lors de l’ajout d’un composant sélectionnable pour la sauvegarde ou de composants non sélectionnables pour la sauvegarde sans sélectionnable pour les ancêtres de sauvegarde dans le document des composants de sauvegarde, un demandeur spécifie les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="e8efb-114">In adding a selectable for backup component or a nonselectable for backup components without selectable for backup ancestors to its Backup Components Document, a requester specifies the following:</span></span>

-   <span data-ttu-id="e8efb-115">Instance du writer qui gère le composant</span><span class="sxs-lookup"><span data-stu-id="e8efb-115">The instance of the writer managing the component</span></span>
-   <span data-ttu-id="e8efb-116">Identificateur de classe du writer</span><span class="sxs-lookup"><span data-stu-id="e8efb-116">The writer's class identifier</span></span>
-   <span data-ttu-id="e8efb-117">[*Chemin d’accès logique*](vssgloss-l.md) du composant (qui peut être **null**)</span><span class="sxs-lookup"><span data-stu-id="e8efb-117">The [*logical path*](vssgloss-l.md) of the component (which may be **NULL**)</span></span>
-   <span data-ttu-id="e8efb-118">Nom du composant</span><span class="sxs-lookup"><span data-stu-id="e8efb-118">The component's name</span></span>

<span data-ttu-id="e8efb-119">Si un composant ne correspond pas à la spécification, une erreur est retournée.</span><span class="sxs-lookup"><span data-stu-id="e8efb-119">If a component does not match the specification, an error will be returned.</span></span>

<span data-ttu-id="e8efb-120">Si un tel composant existe, VSS crée une interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) pour le composant dans le document composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-120">If such a component exists, VSS creates an [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface for the component in the Backup Components Document.</span></span> <span data-ttu-id="e8efb-121">Ces informations sont accessibles et modifiables par le writer et le demandeur.</span><span class="sxs-lookup"><span data-stu-id="e8efb-121">This information will be accessible and modifiable by the writer and requester.</span></span> <span data-ttu-id="e8efb-122">Pour un composant sélectionnable qui définit un [*jeu de composants*](vssgloss-c.md), il décrit non seulement les propriétés du composant, mais également tous les sous-composants qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="e8efb-122">For a selectable component that defines a [*component set*](vssgloss-c.md), it describes not only properties of the component but also all the subcomponents it contains.</span></span>

<span data-ttu-id="e8efb-123">Les informations sur les composants ajoutés implicitement ne sont pas disponibles dans le document composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-123">Information about implicitly added components is not available in the Backup Components Document.</span></span> <span data-ttu-id="e8efb-124">En outre, aucune information de fichier n’est disponible dans le document sur les composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-124">In addition, no file information is available in the Backup Components Document.</span></span> <span data-ttu-id="e8efb-125">Pour obtenir ces informations, le demandeur devra examiner les documents de métadonnées de l’enregistreur (qui auront déjà été lus) dans le contexte des composants stockés sélectionnés dans le document composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-125">To obtain that information, the requester will have to examine the Writer Metadata Documents (which will have already been read) in the context of the selected stored components in the Backup Components Document.</span></span>

## <a name="requester-component-selection-during-restore"></a><span data-ttu-id="e8efb-126">Sélection du composant demandeur pendant la restauration</span><span class="sxs-lookup"><span data-stu-id="e8efb-126">Requester Component Selection during Restore</span></span>

<span data-ttu-id="e8efb-127">Pendant les opérations de restauration, un demandeur ne doit pas importer les informations sur les composants à partir des enregistreurs actuellement actifs sur le système via [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), car l’état des processus en cours d’exécution ne reflète pas nécessairement l’état des processus lorsqu’une sauvegarde a été effectuée.</span><span class="sxs-lookup"><span data-stu-id="e8efb-127">During restore operations, a requester should not import component information from the writers currently active on the system via [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), because the state of currently executing processes will not necessarily reflect the state of processes when a backup was made.</span></span>

<span data-ttu-id="e8efb-128">Elle doit toujours générer un [*événement d’identification*](vssgloss-i.md) via [**IVssBackupComponents :: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), à la fois pour créer un *événement d’identification* et pour déterminer quels Writers sont actuellement sur le système et leur état.</span><span class="sxs-lookup"><span data-stu-id="e8efb-128">It should still generate an [*Identify event*](vssgloss-i.md) via [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), both to create an *Identify event* and to determine which writers are currently on the system and their status.</span></span>

<span data-ttu-id="e8efb-129">Le demandeur récupère le document des composants de sauvegarde stocké pendant son initialisation ainsi que les documents de métadonnées de l’enregistreur stocké (pour plus d’informations, consultez [vue d’ensemble de l’initialisation de la restauration](overview-of-restore-initialization.md) ).</span><span class="sxs-lookup"><span data-stu-id="e8efb-129">The requester retrieves the stored Backup Components Document during its initialization as well as stored Writer Metadata Documents (see [Overview of Restore Initialization](overview-of-restore-initialization.md) for more information) .</span></span>

<span data-ttu-id="e8efb-130">L’inclusion de composants lors de la sauvegarde est en grande partie identique à celle de la restauration, à ceci près que vous devez envisager [*d’utiliser Selectable pour la restauration*](vssgloss-s.md) avec le [*chemin logique*](vssgloss-l.md), et non [*sélectionnable pour la sauvegarde*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="e8efb-130">Inclusion of components during backup is largely the same as that for restore, except that you must consider [*selectable for restore*](vssgloss-s.md) along with [*logical path*](vssgloss-l.md)—not [*selectable for backup*](vssgloss-s.md).</span></span>

<span data-ttu-id="e8efb-131">Toutefois, il existe quelques différences :</span><span class="sxs-lookup"><span data-stu-id="e8efb-131">There are, however, some differences:</span></span>

-   <span data-ttu-id="e8efb-132">Si un composant a déjà été [*explicitement inclus*](vssgloss-e.md) dans le document des composants de sauvegarde lors de la sauvegarde, s’il est inclus pour la restauration (explicitement ou implicitement), [**IVssBackupComponents :: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) est utilisé pour l’ajouter explicitement au document des composants de sauvegarde pour restauration.</span><span class="sxs-lookup"><span data-stu-id="e8efb-132">If a component has already been [*explicitly included*](vssgloss-e.md) to the Backup Components Document during backup, if it is included for restore (either explicitly or implicitly), [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) is used to explicitly add it to the Backup Components Document for restore.</span></span>
-   <span data-ttu-id="e8efb-133">Si un composant a été [*implicitement inclus*](vssgloss-i.md) dans la sauvegarde et qu’il ne peut pas être sélectionné pour la restauration sans sélectionnable pour les ancêtres de restauration, ce qui, dans le cas de la sauvegarde, implique la nécessité d’une inclusion explicite ; le composant n’est pas inclus explicitement (c’est-à-dire qu’il n’est pas ajouté au document des composants de sauvegarde à l’aide de [**IVssBackupComponents :: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore)).</span><span class="sxs-lookup"><span data-stu-id="e8efb-133">If a component was [*implicitly included*](vssgloss-i.md) to the backup, and is nonselectable for restore with no selectable for restore ancestors—which in the backup case would imply the need for explicit inclusion—the component is not explicitly included (that is, it is not added to the Backup Components Document using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore)).</span></span> <span data-ttu-id="e8efb-134">Ce composant doit être considéré comme étant implicitement sélectionné pour la restauration.</span><span class="sxs-lookup"><span data-stu-id="e8efb-134">Such a component should be considered implicitly selected for restore.</span></span>
-   <span data-ttu-id="e8efb-135">Parmi ces composants implicitement sélectionnés pour la sauvegarde (que ce composant soit sélectionnable ou non), seuls ceux qui peuvent être sélectionnés pour la restauration peuvent être ajoutés au document des composants de sauvegarde à l’aide de [**IVssBackupComponents :: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="e8efb-135">Of those components implicitly selected for backup (whether that component was selectable for backup or not), only those that are selectable for restore can be added to the Backup Components Document using [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>
-   <span data-ttu-id="e8efb-136">Sélectionnables pour les composants de restauration peut définir un [*jeu*](vssgloss-c.md) de composants pour la restauration, comme vous pouvez le faire pour les composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-136">Selectable for restore components may define a [*component set*](vssgloss-c.md) for restore—just as selectable for backup components do.</span></span> <span data-ttu-id="e8efb-137">Ce composant sélectionnable pour la restauration définit ensuite ce jeu de composants pour l’opération de restauration.</span><span class="sxs-lookup"><span data-stu-id="e8efb-137">This selectable for restore component then defines this component set for the restore operation.</span></span>

<span data-ttu-id="e8efb-138">Un enregistreur sans composants explicitement sélectionnés pour la restauration avant la génération d’un événement de [*prérestauration*](vssgloss-p.md) ne recevra aucun événement VSS.</span><span class="sxs-lookup"><span data-stu-id="e8efb-138">A writer with no components explicitly selected for restore prior to the generation of a [*PreRestore*](vssgloss-p.md) event will not receive any VSS events.</span></span>

<span data-ttu-id="e8efb-139">Les demandeurs et les enregistreurs peuvent accéder aux informations de composant stockées à l’aide de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="e8efb-139">Requesters and writers can access stored component information using the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span> <span data-ttu-id="e8efb-140">Par le biais de l’interface **IVssComponent** , les enregistreurs peuvent modifier certains paramètres de leurs composants explicitement inclus dans le document des composants de sauvegarde pour prendre en charge une restauration (telle que la [*cible de restauration*](vssgloss-r.md)).</span><span class="sxs-lookup"><span data-stu-id="e8efb-140">Through the **IVssComponent** interface, writers can modify some of the settings of those of its components explicitly included in the Backup Components Document to support a restore (such as the [*restore target*](vssgloss-r.md)).</span></span> <span data-ttu-id="e8efb-141">Si elle définit un jeu de composants, les modifications de l’enregistreur d’un composant explicitement inclus sont propagées à ses sous- [*composants*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="e8efb-141">If it defines a component set, writer modifications of an explicitly included component will propagate to its [*subcomponents*](vssgloss-s.md).</span></span> <span data-ttu-id="e8efb-142">En outre, l’interface fournit un mécanisme permettant de passer des informations sur la réussite et l’échec de la restauration entre l’enregistreur et le demandeur.</span><span class="sxs-lookup"><span data-stu-id="e8efb-142">In addition, the interface provides a mechanism for passing information about restore success and failure between writer and requester.</span></span>

<span data-ttu-id="e8efb-143">Comme pendant la sauvegarde, il y a des informations insuffisantes dans le document des composants de sauvegarde pour implémenter la restauration.</span><span class="sxs-lookup"><span data-stu-id="e8efb-143">As during backup, there is insufficient information in the Backup Components Document itself to implement the restore.</span></span> <span data-ttu-id="e8efb-144">Là encore, les documents de métadonnées de l’enregistreur sont requis pour fournir des informations sur les chemins d’accès réels des fichiers à restaurer et découvrir les composants non sélectionnables qui font partie du jeu de composants sélectionnables et doivent donc être restaurés.</span><span class="sxs-lookup"><span data-stu-id="e8efb-144">Again, the Writer Metadata Documents will be required to supply information about the actual paths of files to be restored and to discover what nonselectable components are part of the selectable components component set and therefore need to be restored.</span></span>

<span data-ttu-id="e8efb-145">Pour plus d’informations sur les types de sélectivité et leur utilisation, consultez Utilisation de la [sélectivité et des chemins d’accès logiques](working-with-selectability-and-logical-paths.md) .</span><span class="sxs-lookup"><span data-stu-id="e8efb-145">See [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md) for information about the types of selectability and their usage.</span></span>

## <a name="use-of-writer-component-document-information-by-the-requester"></a><span data-ttu-id="e8efb-146">Utilisation des informations de document du composant Writer par le demandeur</span><span class="sxs-lookup"><span data-stu-id="e8efb-146">Use of Writer Component Document Information by the Requester</span></span>

<span data-ttu-id="e8efb-147">Chaque composant est identifié de manière unique par l' [*ID de classe du writer*](vssgloss-w.md) de son Writer parent, son nom et son [*chemin d’accès logique*](vssgloss-l.md).</span><span class="sxs-lookup"><span data-stu-id="e8efb-147">Each component is uniquely identified by the [*Writer Class ID*](vssgloss-w.md) of its parent writer, its name, and its [*logical path*](vssgloss-l.md).</span></span>

<span data-ttu-id="e8efb-148">Le demandeur peut utiliser l’interface [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) retournée par la méthode [**IVssBackupComponents :: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents) pour obtenir des informations sur chaque composant stocké.</span><span class="sxs-lookup"><span data-stu-id="e8efb-148">The requester can use the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface returned by the [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents) method to obtain information about each stored component.</span></span>

<span data-ttu-id="e8efb-149">Le nom du composant et le chemin logique (entre autres éléments) sont accessibles via l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) retournée par [**IVssWriterComponentsExt :: GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent).</span><span class="sxs-lookup"><span data-stu-id="e8efb-149">The component's name and logical path (among other items) can be found via the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface returned by [**IVssWriterComponentsExt::GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent).</span></span>

> [!Note]  
> <span data-ttu-id="e8efb-150">Pendant la phase de restauration, le demandeur doit appeler [**IVssWriterComponentsExt :: GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent) ou [**IVssWriterComponentsExt :: GetComponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponentcount) uniquement après l’appel à [**IVssBackupComponents ::P Restore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) a retourné pour permettre au writer de mettre à jour le document des composants de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-150">During the restore phase, the requester should call [**IVssWriterComponentsExt::GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent) or [**IVssWriterComponentsExt::GetComponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponentcount) only after the call to [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) has returned, to allow time for the writer to update the Backup Components Document.</span></span> <span data-ttu-id="e8efb-151">La modification de la cible de restauration constitue un exemple de cette mise à jour.</span><span class="sxs-lookup"><span data-stu-id="e8efb-151">One example of such an update would be to change the restore target.</span></span>

 

<span data-ttu-id="e8efb-152">Vous trouverez des informations sur l’enregistreur parent de chaque composant sélectionnable stocké à l’aide de [**IVssWriterComponentsExt :: GetWriterInfo**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getwriterinfo).</span><span class="sxs-lookup"><span data-stu-id="e8efb-152">Information about each stored selectable component's parent writer can be found using [**IVssWriterComponentsExt::GetWriterInfo**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getwriterinfo).</span></span>

<span data-ttu-id="e8efb-153">Avec ces informations, les documents de métadonnées de l’enregistreur peuvent être interrogés et le document correspondant doit être identifié.</span><span class="sxs-lookup"><span data-stu-id="e8efb-153">With this information, the Writer Metadata Documents can be queried and the matching document identified.</span></span> <span data-ttu-id="e8efb-154">Ensuite, en utilisant le [*chemin logique*](vssgloss-l.md), le demandeur peut identifier les composants non sélectionnables dépendants pour chaque composant sélectionnable, c’est-à-dire identifier tous les membres du [*jeu de composants*](vssgloss-c.md)sélectionnables du composant.</span><span class="sxs-lookup"><span data-stu-id="e8efb-154">Then, by using the [*logical path*](vssgloss-l.md), the requester can identify the dependent nonselectable components for each selectable component—that is, identify all members of the selectable component's [*component set*](vssgloss-c.md).</span></span>

<span data-ttu-id="e8efb-155">À l’aide de l’interface [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) , le demandeur a désormais des informations complètes sur les composants, y compris la spécification du chemin d’accès (à partir de l’interface [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) ), pour les composants sélectionnables et non sélectionnables qu’il doit sauvegarder ou restaurer.</span><span class="sxs-lookup"><span data-stu-id="e8efb-155">Using the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface, the requester now has full component information—including path specification (from the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface)—for both selectable and nonselectable components it needs to back up or restore.</span></span>

<span data-ttu-id="e8efb-156">C’est l’une des raisons pour lesquelles un demandeur est essentiel d’enregistrer l’état de son propre document de composants de sauvegarde et les documents de métadonnées de l’enregistreur des rédacteurs qu’il sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e8efb-156">This is one reason why it is vital for a requester to save both the state of its own Backup Components Document and the Writer Metadata Documents of the writers it is backing up.</span></span>

<span data-ttu-id="e8efb-157">Pour plus d’informations, consultez [utilisation de la sélectivité et des chemins d’accès logiques](working-with-selectability-and-logical-paths.md) .</span><span class="sxs-lookup"><span data-stu-id="e8efb-157">See [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md) for more detailed information.</span></span>

 

 
