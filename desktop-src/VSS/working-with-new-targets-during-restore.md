---
description: Un demandeur peut avoir besoin de restaurer des fichiers à un emplacement indiqué par un autre nom que le chemin d’accès par défaut d’un jeu de fichiers ou le mappage d’un autre emplacement.
ms.assetid: ce11485c-da0e-4c16-962e-eeedc2da3de4
title: Utilisation de nouvelles cibles pendant la restauration
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 31f20a6e8c27c186648d0f662921160ab5c76988
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106516252"
---
# <a name="working-with-new-targets-during-restore"></a><span data-ttu-id="9e178-103">Utilisation de nouvelles cibles pendant la restauration</span><span class="sxs-lookup"><span data-stu-id="9e178-103">Working with New Targets during Restore</span></span>

<span data-ttu-id="9e178-104">Un demandeur peut avoir besoin de restaurer des fichiers à un emplacement indiqué par un autre nom que le chemin d’accès par défaut d’un jeu de fichiers ou le mappage d’un [*autre emplacement*](vssgloss-a.md).</span><span class="sxs-lookup"><span data-stu-id="9e178-104">A requester may need to restore files to a location indicated by something other than a file set's default path or its [*alternate location mapping*](vssgloss-a.md).</span></span> <span data-ttu-id="9e178-105">Cela peut se produire pour de nombreuses raisons : par exemple, aucune destination de restauration n’a été accessible, ou un utilisateur demandeur demande intentionnellement que les fichiers soient restaurés à un emplacement précédemment inconnu.</span><span class="sxs-lookup"><span data-stu-id="9e178-105">There are many reasons why this might happen—for example, neither restore destination was accessible, or a requester user intentionally requests that files be restored to some previously unknown location.</span></span> <span data-ttu-id="9e178-106">Dans ce cas, le demandeur utilise le nouveau mécanisme cible pour indiquer aux rédacteurs qu’il a restauré un fichier vers une autre zone sur le disque.</span><span class="sxs-lookup"><span data-stu-id="9e178-106">In this case, the requester uses the new target mechanism to indicate to writers that it has restored a file to a different area on disk.</span></span>

<span data-ttu-id="9e178-107">Tous les enregistreurs ne prennent pas en charge un demandeur qui modifie la destination de restauration d’un fichier.</span><span class="sxs-lookup"><span data-stu-id="9e178-107">Not all writers support a requester changing the restore destination of a file.</span></span> <span data-ttu-id="9e178-108">Un demandeur doit vérifier la prise en charge de l’enregistreur en vérifiant le masque de schéma de sauvegarde du writer (retourné par [**IVssExamineWriterMetadata :: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema)) et en vérifiant qu’il contient l' \_ enregistreur VSS BS qui \_ \_ prend en charge la \_ nouvelle \_ balise cible.</span><span class="sxs-lookup"><span data-stu-id="9e178-108">A requester needs to verify writer support by checking the writer's backup schema mask (returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema)) and verifying that it contains the VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET flag.</span></span>

<span data-ttu-id="9e178-109">Le demandeur indique une telle restauration par le biais de la méthode [**IVssBackupComponents :: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) .</span><span class="sxs-lookup"><span data-stu-id="9e178-109">The requester indicates such a restoration through the [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) method.</span></span> <span data-ttu-id="9e178-110">En plus de spécifier une spécification de fichier et une destination de restauration originale et nouvelle, le demandeur spécifie les informations sur les composants, à savoir un chemin d’accès logique et un nom de composant.</span><span class="sxs-lookup"><span data-stu-id="9e178-110">In addition to specifying a file specification and an original and a new restore destination, the requester specifies component information—a logical path and component name.</span></span>

<span data-ttu-id="9e178-111">Les informations sur le composant sont utilisées dépendent du fait que le composant qui gère le fichier ayant une nouvelle cible ajoutée a été [*explicitement inclus*](vssgloss-e.md) ou [*implicitement inclus*](vssgloss-i.md) dans la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="9e178-111">Which component's information is used depends on whether or not the component managing the file having a new target added was [*explicitly included*](vssgloss-e.md) or [*implicitly included*](vssgloss-i.md) in the backup.</span></span>

<span data-ttu-id="9e178-112">Si le composant de gestion a été explicitement inclus, ses informations sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="9e178-112">If the managing component was explicitly included, then its information is used.</span></span> <span data-ttu-id="9e178-113">Si le composant de gestion a été inclus implicitement, il s’agit d’un sous-composant dans un jeu de composants.</span><span class="sxs-lookup"><span data-stu-id="9e178-113">If the managing component was implicitly included, it is a subcomponent in a component set.</span></span> <span data-ttu-id="9e178-114">Dans ce cas, les informations du composant qui définissent le jeu de composants sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="9e178-114">In this case, the component set's defining component's information is used.</span></span>

<span data-ttu-id="9e178-115">Lors du traitement de l’événement [**postRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) , les enregistreurs doivent vérifier si l’un de ses fichiers a été restauré vers un nouvel emplacement.</span><span class="sxs-lookup"><span data-stu-id="9e178-115">While handling the [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) event, writers should check to see if any of its files were restored to a new location.</span></span> <span data-ttu-id="9e178-116">Pour ce faire, vous pouvez utiliser les méthodes [**IVssComponent :: GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) et [**IVssComponent :: GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget) .</span><span class="sxs-lookup"><span data-stu-id="9e178-116">This can be done by using the [**IVssComponent::GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) and [**IVssComponent::GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget) methods.</span></span>

<span data-ttu-id="9e178-117">L’instance de l’interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) utilisée varie selon que le composant de gestion du fichier a été explicitement ou implicitement ajouté à la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="9e178-117">The instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface that is used depends on whether the file's managing component was explicitly or implicitly added to the backup.</span></span>

 

 



