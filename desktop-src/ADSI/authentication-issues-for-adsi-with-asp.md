---
title: Problèmes d’authentification pour ADSI avec ASP
description: Selon la configuration de votre intranet, des problèmes d’authentification peuvent se produire lorsque le code ADSI est exécuté à partir d’une page ASP.
ms.assetid: 287e2e19-7da9-497b-bf46-595ff4755261
ms.tgt_platform: multiple
keywords:
- ADSI, pages ASP, problèmes d’authentification
- ADSI, authentification, problèmes ASP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423d1aa39006f89ca366423da9d135e00af45693
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730204"
---
# <a name="authentication-issues-for-adsi-with-asp"></a><span data-ttu-id="5c3b3-105">Problèmes d’authentification pour ADSI avec ASP</span><span class="sxs-lookup"><span data-stu-id="5c3b3-105">Authentication Issues for ADSI with ASP</span></span>

<span data-ttu-id="5c3b3-106">Selon la configuration de votre intranet, des problèmes d’authentification peuvent se produire lorsque le code ADSI est exécuté à partir d’une page ASP.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-106">Depending on the configuration of your intranet, authentication issues may occur when ADSI code is run from an ASP page.</span></span>

<span data-ttu-id="5c3b3-107">L’authentification pour accéder au contrôleur de domaine peut être fournie à l’aide de la délégation.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-107">Authentication to access the domain controller can be given using delegation.</span></span> <span data-ttu-id="5c3b3-108">La délégation permet à un service d’agir en tant qu’utilisateur, afin qu’il puisse accéder à une ressource réseau à l’aide des informations d’identification de cet utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-108">Delegation permits a service to act as the user, so it can access a network resource using that user credentials.</span></span> <span data-ttu-id="5c3b3-109">Si votre intranet suit cette configuration, vous devez configurer IIS pour qu’il utilise la délégation.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-109">If your intranet follows this configuration, you must set up IIS to use delegation.</span></span> <span data-ttu-id="5c3b3-110">Définissez le mécanisme d’authentification IIS comme anonyme ou NTLM.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-110">Set the IIS Authentication mechanism as Anonymous or NTLM.</span></span> <span data-ttu-id="5c3b3-111">Si vous choisissez anonyme, votre contexte de sécurité sera mappé au compte d' \_ ordinateur IUSR.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-111">If you choose anonymous, your security context will be mapped to IUSR\_MACHINE account.</span></span> <span data-ttu-id="5c3b3-112">Si vous sélectionnez NTLM, le contexte de sécurité sera modifié, en fonction de l’utilisateur qui se connecte à votre site Web.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-112">If you select NTLM, the security context will change, depending on which user logs on to your website.</span></span> <span data-ttu-id="5c3b3-113">Pour plus d’informations et pour obtenir des instructions sur la configuration du serveur IIS pour la délégation, consultez le [Kit de ressources Windows 2000](https://support.microsoft.com/kb/927229).</span><span class="sxs-lookup"><span data-stu-id="5c3b3-113">For more information and instructions for setting up the IIS server for delegation, see [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span></span>

<span data-ttu-id="5c3b3-114">Si vous utilisez un serveur IIS qui utilise le challenge/réponse NT ou un client de navigateur qui ne prend pas en charge Kerberos, l’authentification à double saut n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-114">If you are using a an IIS server that uses the NT challenge/response, or a browser client that does not support Kerberos, then double-hop authentication is not supported.</span></span> <span data-ttu-id="5c3b3-115">L’authentification à double saut signifie que les informations d’identification de l’utilisateur sont transmises du client du navigateur au serveur IIS, puis le serveur IIS transmet les informations d’identification au serveur principal.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-115">Double-hop authentication means that the user credentials are passed from the browser client to the IIS server, and then the IIS server passes the credentials to the backend server.</span></span> <span data-ttu-id="5c3b3-116">Dans ce cas, vous pouvez utiliser l’une des solutions suivantes pour autoriser l’accès à l’annuaire à partir de la page ASP :</span><span class="sxs-lookup"><span data-stu-id="5c3b3-116">In this situation, you can use one of the following solutions to allow access to the directory from the ASP page:</span></span>

-   <span data-ttu-id="5c3b3-117">Utilisez [**IADsOpenDSObject :: OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) ou [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) pour transmettre les informations d’identification à Active Directory.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-117">Use [**IADsOpenDSObject::OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) to pass credentials to Active Directory.</span></span> <span data-ttu-id="5c3b3-118">La page Web authentifie l’utilisateur connecté sur le serveur IIS.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-118">The webpage authenticates the connected user against the IIS server.</span></span> <span data-ttu-id="5c3b3-119">Lorsque l’utilisateur a été authentifié, la page Web peut utiliser OpenDSObject ou ADsOpenObject pour transmettre un nom d’utilisateur et un mot de passe au service d’annuaire pour obtenir l’authentification auprès du serveur principal.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-119">When the user has been authenticated, the webpage can use OpenDSObject or ADsOpenObject to pass a user name and password to the directory service to obtain authentication to the backend server.</span></span> <span data-ttu-id="5c3b3-120">La page Web peut ensuite accéder aux données à partir de l’annuaire.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-120">The webpage can then access data from the directory.</span></span>
-   <span data-ttu-id="5c3b3-121">Ajoutez votre code à un objet COM et placez cet objet dans une [application com+](../cossdk/com--application-overview.md) (précédemment appelée package MTS).</span><span class="sxs-lookup"><span data-stu-id="5c3b3-121">Add your code to a COM object and put this object into a [COM+ application](../cossdk/com--application-overview.md) (previously called an MTS package).</span></span> <span data-ttu-id="5c3b3-122">L’application COM+ peut ensuite être exécutée en tant que [compte d’utilisateur de domaine](/windows/desktop/AD/domain-user-accounts).</span><span class="sxs-lookup"><span data-stu-id="5c3b3-122">The COM+ application can then be run as a [domain user account](/windows/desktop/AD/domain-user-accounts).</span></span>
-   <span data-ttu-id="5c3b3-123">Utilisez plusieurs pages ASP, où une page authentifie le client et une autre page transmet les informations d’identification au répertoire à l’aide de l’authentification anonyme sur un compte d’utilisateur de domaine.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-123">Use multiple ASP pages, where one page authenticates the client and another page passes credentials to the directory using anonymous authentication on a domain user account.</span></span>

<span data-ttu-id="5c3b3-124">Ces méthodes impliquent l’authentification du client Web, puis la modification des informations d’identification lors du contact avec le répertoire, car l’authentification à double saut, avec les mêmes informations d’identification, n’est pas possible.</span><span class="sxs-lookup"><span data-stu-id="5c3b3-124">These methods involve authenticating the web client and then changing the credentials when contacting the directory because double-hop authentication, with the same credentials, is not possible.</span></span>

 

 