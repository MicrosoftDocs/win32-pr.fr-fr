---
title: Étendue de la requête
description: L’étendue d’une requête est déterminée par l’objet auquel vous vous liez.
ms.assetid: 7ece8599-8a4b-45a1-95f4-a4180052f245
ms.tgt_platform: multiple
keywords:
- étendue de l’ADSI de requête
- interroge ADSI, Scope
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dac51fc261cb418db0018acd996c248766896a25
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103671125"
---
# <a name="scope-of-query"></a><span data-ttu-id="1a566-105">Étendue de la requête</span><span class="sxs-lookup"><span data-stu-id="1a566-105">Scope of Query</span></span>

<span data-ttu-id="1a566-106">L’étendue d’une requête est déterminée par l’objet auquel vous vous liez.</span><span class="sxs-lookup"><span data-stu-id="1a566-106">The scope of a query is determined by the object to which you bind.</span></span> <span data-ttu-id="1a566-107">Si vous ne savez pas où se trouve l’objet au sein de l’entreprise, vous devez effectuer une recherche aussi étendue que possible.</span><span class="sxs-lookup"><span data-stu-id="1a566-107">If you are unsure where the object is located within the enterprise then you will need to do as wide a search as possible.</span></span> <span data-ttu-id="1a566-108">Toutefois, si vous savez que l’objet sera contenu dans un domaine spécifique, tel que le domaine auquel l’utilisateur est connecté ou au sein d’un groupe spécifique, tel que le groupe Managers, vous devez définir l’étendue de la recherche pour qu’elle reflète les circonstances.</span><span class="sxs-lookup"><span data-stu-id="1a566-108">However, if you know that the object will be contained within a specific domain, such as the domain that the user is connected to, or within a specific group, such as the Managers group, then you should set the scope of the search to reflect the circumstance.</span></span> <span data-ttu-id="1a566-109">Pour des performances optimales, vous devez essayer de cibler l’étendue pour rechercher le plus petit nombre d’objets possible.</span><span class="sxs-lookup"><span data-stu-id="1a566-109">For the best performance, you should try to target the scope to search the smallest number of objects possible.</span></span>

<span data-ttu-id="1a566-110">Lorsque vous n’êtes pas certain de l’emplacement d’un objet dans l’entreprise, vous pouvez établir une liaison avec le service de catalogue global.</span><span class="sxs-lookup"><span data-stu-id="1a566-110">When you are not sure where an object will be located in the enterprise, you can bind to the global catalog service.</span></span> <span data-ttu-id="1a566-111">Le service de catalogue global contient une liste de tous les objets de l’annuaire et un petit sous-ensemble des attributs de chaque objet.</span><span class="sxs-lookup"><span data-stu-id="1a566-111">The global catalog service contains a list of every object in the directory and a small subset of each object's attributes.</span></span> <span data-ttu-id="1a566-112">Une fois que vous avez trouvé l’objet dans le catalogue global, vous pouvez récupérer son nom unique à partir du catalogue global et l’utiliser pour établir une liaison à l’objet afin d’effectuer d’autres opérations.</span><span class="sxs-lookup"><span data-stu-id="1a566-112">After you find the object in the global catalog, you can retrieve its distinguished name from the global catalog and use it to bind to the object to perform other operations.</span></span>

<span data-ttu-id="1a566-113">Une fois que vous avez choisi l’objet à lier, vous pouvez restreindre davantage la requête à l’une des étendues suivantes : une requête de base, une requête à un niveau ou une recherche de sous-arborescence, comme indiqué dans l’illustration suivante.</span><span class="sxs-lookup"><span data-stu-id="1a566-113">After you decide which object to bind to, you can further restrict the query to one of the following scopes: a base query, a one-level query, or a subtree search, as shown in the following illustration.</span></span>

![objets à la racine d’une recherche pour une recherche de base, d’un niveau ou d’une sous-arborescence](images/netds6.png)

## <a name="base"></a><span data-ttu-id="1a566-115">Base</span><span class="sxs-lookup"><span data-stu-id="1a566-115">Base</span></span>

<span data-ttu-id="1a566-116">Une requête de base limite la recherche à l’objet de base uniquement.</span><span class="sxs-lookup"><span data-stu-id="1a566-116">A base query limits the search to only the base object.</span></span> <span data-ttu-id="1a566-117">Le nombre maximal d’objets retournés est toujours un.</span><span class="sxs-lookup"><span data-stu-id="1a566-117">The maximum number of objects returned is always one.</span></span> <span data-ttu-id="1a566-118">Cette recherche peut être utilisée pour vérifier l’existence d’un objet.</span><span class="sxs-lookup"><span data-stu-id="1a566-118">This search can be used to verify the existence of an object.</span></span> <span data-ttu-id="1a566-119">Par exemple, si vous avez un nom unique d’objet et que vous devez vérifier l’existence de l’objet en fonction du chemin d’accès, vous pouvez utiliser une recherche à un niveau.</span><span class="sxs-lookup"><span data-stu-id="1a566-119">For example, if you have an object's distinguished name and you must verify the object's existence based on the path, you can use a one-level search.</span></span> <span data-ttu-id="1a566-120">Si la recherche échoue, vous pouvez supposer que l’objet a peut-être été renommé ou déplacé vers un autre emplacement ou que des données incorrectes concernant l’objet ont été fournies.</span><span class="sxs-lookup"><span data-stu-id="1a566-120">If the search fails, you can assume that the object may have been renamed or moved to a different location, or that you were given incorrect data about the object.</span></span> <span data-ttu-id="1a566-121">N’oubliez pas que vous devez stocker le GUID à la place du nom unique si vous souhaitez revisiter un objet.</span><span class="sxs-lookup"><span data-stu-id="1a566-121">Be aware that you should store the GUID instead of the distinguished name if you want to revisit an object.</span></span> <span data-ttu-id="1a566-122">Cela permet à l’objet d’être renommé ou déplacé dans la hiérarchie de répertoires sans rompre le lien persistant.</span><span class="sxs-lookup"><span data-stu-id="1a566-122">This allows the object to be renamed or moved in the directory hierarchy without breaking the persisted link.</span></span>

## <a name="one-level"></a><span data-ttu-id="1a566-123">Dossier parent</span><span class="sxs-lookup"><span data-stu-id="1a566-123">One Level</span></span>

<span data-ttu-id="1a566-124">Une recherche à un niveau est limitée aux enfants immédiats d’un objet de base, mais exclut l’objet de base lui-même.</span><span class="sxs-lookup"><span data-stu-id="1a566-124">A one-level search is restricted to the immediate children of a base object, but excludes the base object itself.</span></span> <span data-ttu-id="1a566-125">Ce paramètre peut effectuer une recherche ciblée d’objets enfants immédiats d’un objet parent.</span><span class="sxs-lookup"><span data-stu-id="1a566-125">This setting can perform a targeted search for immediate child objects of a parent object.</span></span> <span data-ttu-id="1a566-126">Par exemple, si vous avez un objet parent appelé P1, et que ses enfants immédiats sont : C1, C2, C3, puis dans une recherche à un niveau, C1, C2 et C3 doivent être inclus lors de l’évaluation des critères, mais P1 ne fait pas partie de la recherche.</span><span class="sxs-lookup"><span data-stu-id="1a566-126">For example, if you have a parent object called P1, and its immediate children are: C1, C2, C3, then in a one-level search, C1, C2, and C3 should be included when evaluating the criteria, but P1 would not be part of the search.</span></span> <span data-ttu-id="1a566-127">Une recherche à un niveau peut être utilisée pour énumérer tous les enfants d’un objet.</span><span class="sxs-lookup"><span data-stu-id="1a566-127">A one-level search can be used to enumerate all children of an object.</span></span> <span data-ttu-id="1a566-128">En fait, dans certains fournisseurs ADSI, l’énumération [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) se traduit par une recherche à un niveau.</span><span class="sxs-lookup"><span data-stu-id="1a566-128">In fact, in some ADSI providers, [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) enumeration translates to a one-level search.</span></span>

## <a name="subtree"></a><span data-ttu-id="1a566-129">Sous-arborescence</span><span class="sxs-lookup"><span data-stu-id="1a566-129">Subtree</span></span>

<span data-ttu-id="1a566-130">Une recherche de sous-arborescence, également appelée recherche détaillée, comprend tous les objets sous l’objet de base, à l’exclusion de l’objet de base lui-même.</span><span class="sxs-lookup"><span data-stu-id="1a566-130">A subtree search, also known as a deep search, includes all the objects beneath the base object, excluding the base object itself.</span></span> <span data-ttu-id="1a566-131">Cette recherche peut générer des références à d’autres serveurs.</span><span class="sxs-lookup"><span data-stu-id="1a566-131">This search may generate referrals to other servers.</span></span> <span data-ttu-id="1a566-132">Cette recherche a la plus grande étendue et peut retourner un jeu de résultats volumineux.</span><span class="sxs-lookup"><span data-stu-id="1a566-132">This search has the greatest scope and may return a large result set.</span></span> <span data-ttu-id="1a566-133">Si possible, recherchez au moins un attribut indexé et définissez les paramètres de référence (pour plus d’informations, consultez [performances et gestion des jeux de résultats volumineux](performance-and-handling-large-result-sets.md)) en fonction de vos critères de recherche.</span><span class="sxs-lookup"><span data-stu-id="1a566-133">If possible, search on at least one indexed attribute and set the referrals settings (for more information, see [Performance and Handling Large Result Sets](performance-and-handling-large-result-sets.md)) to match your search requirements.</span></span> <span data-ttu-id="1a566-134">Il est également conseillé de faire en sorte que les résultats d’une recherche de sous-arborescence soient exécutés de façon asynchrone et paginé pour réduire la charge du serveur et l’efficacité du réseau.</span><span class="sxs-lookup"><span data-stu-id="1a566-134">It is also suggested that the results of a subtree search be performed asynchronously and paged to reduce the server overhead and network effectiveness.</span></span> <span data-ttu-id="1a566-135">Une recherche de sous-arborescence est normalement utilisée pour rechercher des objets pour une étendue donnée.</span><span class="sxs-lookup"><span data-stu-id="1a566-135">A subtree search is normally used to search objects for a given scope.</span></span> <span data-ttu-id="1a566-136">Par exemple, recherchez tous les utilisateurs dont les comptes expirent dans 30 jours ou moins.</span><span class="sxs-lookup"><span data-stu-id="1a566-136">For example, search for all users with accounts that will expire in 30 days or less.</span></span>

 

 




