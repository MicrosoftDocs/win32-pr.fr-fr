---
title: Utilisation des interfaces IADs
description: ADSI, chaque élément d’un service d’annuaire est représenté par un objet ADSI, qui est un objet COM (Component Object Model) qui prend en charge l’interface IUnknown COM standard, ainsi que les interfaces IDispatch et IADs.
ms.assetid: bdbf2012-6863-4611-8173-6a3cd9c4960f
ms.tgt_platform: multiple
keywords:
- IADs ADSI, utilisation
- ADSI ADSI, utilisation de, à l’aide des interfaces IADs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 878afa9350a45f18238bebb69df1a96eba52715e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104382872"
---
# <a name="using-the-iads-interfaces"></a><span data-ttu-id="013b6-105">Utilisation des interfaces IADs</span><span class="sxs-lookup"><span data-stu-id="013b6-105">Using the IADs Interfaces</span></span>

<span data-ttu-id="013b6-106">ADSI, chaque élément d’un service d’annuaire est représenté par un objet ADSI, qui est un objet COM (Component Object Model) qui prend en charge l’interface [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) com standard, ainsi que les interfaces [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) et [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="013b6-106">ADSI, each element of a directory service is represented by an ADSI object, which is a Component Object Model (COM) object that supports the standard COM [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface as well as the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) and [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interfaces.</span></span> <span data-ttu-id="013b6-107">**IADs** fournit les fonctions de maintenance de base pour les objets ADSI.</span><span class="sxs-lookup"><span data-stu-id="013b6-107">**IADs** supplies the basic maintenance functions for ADSI objects.</span></span>

<span data-ttu-id="013b6-108">Chaque objet ADSI doit prendre en charge cette interface, qui sert à :</span><span class="sxs-lookup"><span data-stu-id="013b6-108">Each ADSI object must support this interface, which serves to:</span></span>

-   <span data-ttu-id="013b6-109">Indiquez l’identification de l’objet par nom, classe ou ADsPath.</span><span class="sxs-lookup"><span data-stu-id="013b6-109">Provide object identification by name, class, or ADsPath.</span></span>
-   <span data-ttu-id="013b6-110">Identifiez le conteneur d’objets qui gère la création et la suppression d’objets.</span><span class="sxs-lookup"><span data-stu-id="013b6-110">Identify the object container that manages creating and deleting objects.</span></span>
-   <span data-ttu-id="013b6-111">Obtenez la définition du schéma de l’objet.</span><span class="sxs-lookup"><span data-stu-id="013b6-111">Obtain the object schema definition.</span></span>
-   <span data-ttu-id="013b6-112">Chargez les attributs d’objet dans le cache de propriétés et validez les modifications dans le magasin d’annuaires persistant.</span><span class="sxs-lookup"><span data-stu-id="013b6-112">Load the object attributes to the property cache and commit changes to the persistent directory store.</span></span>
-   <span data-ttu-id="013b6-113">Accédez aux valeurs d’attribut d’objet dans le cache de propriétés et modifiez-les.</span><span class="sxs-lookup"><span data-stu-id="013b6-113">Access and modify the object attribute values in the property cache.</span></span>

<span data-ttu-id="013b6-114">L’interface [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) est conçue pour garantir que les objets ADSI fournissent aux administrateurs réseau et aux fournisseurs de services d’annuaire une représentation efficace et cohérente de différents services d’annuaire sous-jacents.</span><span class="sxs-lookup"><span data-stu-id="013b6-114">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface is designed to ensure that ADSI objects provide network administrators and directory service providers with an efficient and consistent representation of various underlying directory services.</span></span>

![objet ADSI prenant en charge l’interface IADs](images/ds2iads.png)

<span data-ttu-id="013b6-116">La figure précédente montre un objet ADSI générique qui prend en charge les interfaces fondamentales [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject)et [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span><span class="sxs-lookup"><span data-stu-id="013b6-116">The preceding figure shows a generic ADSI object that support the fundamental interfaces [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject), and [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span> <span data-ttu-id="013b6-117">Un objet ADSI, tel que celui-ci, gère des données à partir du magasin de données du service d’annuaire sous-jacent via les interfaces qu’il prend en charge.</span><span class="sxs-lookup"><span data-stu-id="013b6-117">An ADSI object such as this manages data from the data store of the underlying directory service through the interfaces it supports.</span></span> <span data-ttu-id="013b6-118">Ces données sont connues comme les propriétés de l’objet, et les routines qui obtiennent et définissent ces propriétés sont appelées méthodes de propriété.</span><span class="sxs-lookup"><span data-stu-id="013b6-118">This data is known as the properties of the object, and the routines that obtain and set these properties are known as property methods.</span></span> <span data-ttu-id="013b6-119">Les propriétés en lecture seule ont une méthode de propriété qui obtient la valeur de la propriété.</span><span class="sxs-lookup"><span data-stu-id="013b6-119">Read-only properties have one property method that obtains the property value.</span></span> <span data-ttu-id="013b6-120">Les propriétés en lecture/écriture ont deux méthodes : méthode qui définit la valeur et une qui obtient la valeur.</span><span class="sxs-lookup"><span data-stu-id="013b6-120">Read/write properties have two methods; a method that sets the value and one that obtains the value.</span></span> <span data-ttu-id="013b6-121">Les propriétés sont implémentées sur chaque objet ADSI à l’aide d’un [cache de propriétés](the-adsi-attribute-cache.md).</span><span class="sxs-lookup"><span data-stu-id="013b6-121">Properties are implemented on each ADSI object using a [property cache](the-adsi-attribute-cache.md).</span></span> <span data-ttu-id="013b6-122">[**IADs :: obtient \_ ADsPath**](iads-property-methods.md) et **IADs ::p ut \_ ADsPath** sont des exemples de méthodes de propriété.</span><span class="sxs-lookup"><span data-stu-id="013b6-122">[**IADs::get\_ADsPath**](iads-property-methods.md) and **IADs::put\_ADsPath** are examples of property methods.</span></span> <span data-ttu-id="013b6-123">Les méthodes de propriété ne sont pas visibles pour Visual Basic et d’autres clients Automation qui activent des références directes à la propriété.</span><span class="sxs-lookup"><span data-stu-id="013b6-123">Property methods are not apparent to Visual Basic and other Automation clients that enable direct references to the property.</span></span> <span data-ttu-id="013b6-124">Par exemple, Visual Basic fait référence à **IADs :: ADsPath** directement à l’aide de la syntaxe **Object. ADsPath** .</span><span class="sxs-lookup"><span data-stu-id="013b6-124">For example, Visual Basic refers to **IADs::ADsPath** directly using the **Object.ADsPath** syntax.</span></span> <span data-ttu-id="013b6-125">Pour plus d’informations, consultez [méthodes de propriété d’interface](interface-property-methods.md).</span><span class="sxs-lookup"><span data-stu-id="013b6-125">For more information, see [Interface Property Methods](interface-property-methods.md).</span></span>

<span data-ttu-id="013b6-126">En outre, un objet ADSI interagit avec d’autres objets ADSI et directement à un espace de noms via des méthodes.</span><span class="sxs-lookup"><span data-stu-id="013b6-126">In addition, an ADSI object interacts with other ADSI objects and directly to a namespace through methods.</span></span> <span data-ttu-id="013b6-127">Les méthodes s’exécutent immédiatement.</span><span class="sxs-lookup"><span data-stu-id="013b6-127">Methods execute immediately.</span></span> <span data-ttu-id="013b6-128">Les exemples de méthodes sont les suivants [**: IADs :: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) et [**IADs :: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span><span class="sxs-lookup"><span data-stu-id="013b6-128">Examples of methods include [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) and [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span></span>

<span data-ttu-id="013b6-129">Les propriétés, les méthodes de propriété et les méthodes sont accessibles via des interfaces COM standard.</span><span class="sxs-lookup"><span data-stu-id="013b6-129">Properties, property methods, and methods are all accessed through standard COM interfaces.</span></span>

<span data-ttu-id="013b6-130">Un objet ADSI est identifié de manière unique par son ADsPath.</span><span class="sxs-lookup"><span data-stu-id="013b6-130">An ADSI object is uniquely identified by its ADsPath.</span></span> <span data-ttu-id="013b6-131">Par exemple, un ADsPath pour l’espace de noms LDAP est « LDAP://MyServer/DC=Fabrikam,DC=COM ».</span><span class="sxs-lookup"><span data-stu-id="013b6-131">For example, an ADsPath for the LDAP namespace is "LDAP://MyServer/DC=Fabrikam,DC=COM".</span></span> <span data-ttu-id="013b6-132">Pour plus d’informations sur ADsPaths, consultez [liaison ADSI](binding-to-an-adsi-object.md).</span><span class="sxs-lookup"><span data-stu-id="013b6-132">For more information about ADsPaths, see [ADSI Binding](binding-to-an-adsi-object.md).</span></span> <span data-ttu-id="013b6-133">Pour les programmeurs familiers avec les monikers COM, ce concept est similaire au nom complet du moniker COM.</span><span class="sxs-lookup"><span data-stu-id="013b6-133">For programmers familiar with COM monikers, this is conceptually similar to the COM moniker display name.</span></span>

<span data-ttu-id="013b6-134">Tout objet ADSI qui contient d’autres objets ADSI, appelé objet conteneur ADSI, prend également en charge l’interface [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) , qui fournit des méthodes et des propriétés qui gèrent la création, la suppression et l’énumération des objets ADSI contenus dans l’objet.</span><span class="sxs-lookup"><span data-stu-id="013b6-134">Any ADSI object that contains other ADSI objects, called an ADSI container object, also supports the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface, which provides methods and properties that manage the creation, deletion, and enumeration of ADSI objects contained by the object.</span></span> <span data-ttu-id="013b6-135">L’illustration suivante montre un objet conteneur ADSI.</span><span class="sxs-lookup"><span data-stu-id="013b6-135">The following figure shows an ADSI container object.</span></span>

![objet conteneur ADSI](images/dsiadsc.png)

<span data-ttu-id="013b6-137">La plupart des objets ADSI sont contenus dans d’autres objets.</span><span class="sxs-lookup"><span data-stu-id="013b6-137">Most ADSI objects are contained by other objects.</span></span> <span data-ttu-id="013b6-138">Le seul objet ADSI sans conteneur parent est l’objet des **espaces de noms** ADSI de niveau supérieur (« ADS : »).</span><span class="sxs-lookup"><span data-stu-id="013b6-138">The only ADSI object with no parent container is the top-level ADSI **Namespaces** object ("ADS:").</span></span>

<span data-ttu-id="013b6-139">La méthode [**IADs :: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) sur un objet conteneur stocke de manière permanente les propriétés mises en cache de l’objet conteneur ADSI dans le stockage, en plus des objets créés avec la méthode [**IADsContainer :: Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) .</span><span class="sxs-lookup"><span data-stu-id="013b6-139">The [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method on a container object persistently stores the cached properties of the ADSI container object to storage in addition to any objects created with the [**IADsContainer::Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method.</span></span> <span data-ttu-id="013b6-140">[**IADsContainer ::D supprim**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) n’affecte pas le cache de propriétés, mais supprime l’élément de répertoire d’espace de noms sous-jacent représenté par cet objet.</span><span class="sxs-lookup"><span data-stu-id="013b6-140">[**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) does not affect the property cache but deletes the underlying namespace directory element represented by this object.</span></span>

 

 